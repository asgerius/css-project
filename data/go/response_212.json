[{"tags": ["docker", "go"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 3, "creation_date": 1548891853, "post_id": 54451273, "comment_id": 95710955, "body": "<a href=\"https://github.com/moby/moby/tree/master/client\" rel=\"nofollow noreferrer\">github.com/moby/moby/tree/master/client</a>"}], "answers": [{"tags": [], "owner": {"reputation": 14132, "user_id": 4014291, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/taWvG.jpg?s=128&g=1", "display_name": "Samuel Toh", "link": "https://stackoverflow.com/users/4014291/samuel-toh"}, "is_accepted": true, "score": 1, "last_activity_date": 1548894908, "creation_date": 1548894908, "answer_id": 54451707, "question_id": 54451273, "link": "https://stackoverflow.com/questions/54451273/where-does-the-go-docker-sdk-gets-fetched-from/54451707#54451707", "title": "Where does the go docker sdk gets fetched from?", "body": "<p><strong>Q:</strong> Where does the go docker sdk gets fetched from?</p>\n\n<p><strong>A:</strong> As mentioned. <a href=\"https://github.com/moby/moby\" rel=\"nofollow noreferrer\">https://github.com/moby/moby</a></p>\n\n<p>I had trouble working out the answer like you do as well. But this is how I derived it in the end.</p>\n\n<p>Like what you you did. </p>\n\n<p>First, running <code>go get github.com/docker/docker/client</code>. This command <code>git cloned</code> a <code>docker/docker</code> project into my <code>$GOPATH/github.com</code> directory.</p>\n\n<p>Then I went to the project directory and did a <code>git remote get-url origin</code> to find out the original source it came from. </p>\n\n<p><strong>Output is</strong>: <a href=\"https://github.com/docker/docker\" rel=\"nofollow noreferrer\">https://github.com/docker/docker</a></p>\n\n<p>Putting this URL into the browser redirects me to the <em>github.com/moby/moby</em> project, I think they must have setup a <code>dns</code> to redirect people to that URL. </p>\n\n<p>I haven't lookup or read about how the <code>go get</code> command works but it seems like there is a little bit of smartness in there to tell it that <code>github.com/docker/docker</code> is the actual project's URL which <code>git clone</code> would perform against. Then the <code>/client</code> bit is just a submodule or a directory of the project that it is cloning from.</p>\n"}], "owner": {"reputation": 6973, "user_id": 1252307, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/538fa74aef355cfc62f8d292e215a24d?s=128&d=identicon&r=PG", "display_name": "kev", "link": "https://stackoverflow.com/users/1252307/kev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 54451707, "answer_count": 1, "score": 1, "last_activity_date": 1548894908, "creation_date": 1548891802, "question_id": 54451273, "link": "https://stackoverflow.com/questions/54451273/where-does-the-go-docker-sdk-gets-fetched-from", "title": "Where does the go docker sdk gets fetched from?", "body": "<p>I can execute:</p>\n\n<p><code>go get github.com/docker/docker/client</code></p>\n\n<p>(from <a href=\"https://docs.docker.com/develop/sdk/\" rel=\"nofollow noreferrer\">here</a>) and see the source in my <code>$GOPATH/src/github.com/docker/docker/client</code>. </p>\n\n<p>But there is no such repository <a href=\"https://github.com/docker/docker/client\" rel=\"nofollow noreferrer\">https://github.com/docker/docker/client</a>.</p>\n\n<p>Where does go actually get the source from? Can someone point me to the url?</p>\n"}, {"tags": ["go", "graphql", "graphql-go"], "comments": [{"owner": {"reputation": 4738, "user_id": 4723237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vNJVW.png?s=128&g=1", "display_name": "vbranden", "link": "https://stackoverflow.com/users/4723237/vbranden"}, "edited": false, "score": 0, "creation_date": 1560537214, "post_id": 54448994, "comment_id": 99783093, "body": "The field needs to be a defined type you create with NewObject"}], "answers": [{"tags": [], "owner": {"reputation": 36140, "user_id": 6463558, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/g22sX.jpg?s=128&g=1", "display_name": "slideshowp2", "link": "https://stackoverflow.com/users/6463558/slideshowp2"}, "is_accepted": false, "score": 0, "last_activity_date": 1585828451, "creation_date": 1585828451, "answer_id": 60990965, "question_id": 54448994, "link": "https://stackoverflow.com/questions/54448994/graphql-go-define-field-type-as-object/60990965#60990965", "title": "graphql-go define field type as object", "body": "<p>Here is an example using <code>github.com/graphql-go/graphql v0.7.9</code>:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"net/http\"\n\n    \"github.com/graphql-go/graphql\"\n)\n\ntype region struct {\n    ID   int    `json:\"id\"`\n    Name string `json:\"name\"`\n}\n\ntype user struct {\n    ID     string `json:\"id\"`\n    Name   string `json:\"name\"`\n    Region region `json:\"region\"`\n}\n\nvar aRegion = region{ID: 34, Name: \"San jose\"}\nvar aUser = user{ID: \"34\", Name: \"something\", Region: aRegion}\n\nvar regionType = graphql.NewObject(graphql.ObjectConfig{\n    Name: \"Region\",\n    Fields: graphql.Fields{\n        \"id\":   &amp;graphql.Field{Type: graphql.Int},\n        \"name\": &amp;graphql.Field{Type: graphql.String},\n    },\n})\n\nvar userType = graphql.NewObject(graphql.ObjectConfig{\n    Name: \"User\",\n    Fields: graphql.Fields{\n        \"id\":   &amp;graphql.Field{Type: graphql.String},\n        \"name\": &amp;graphql.Field{Type: graphql.String},\n        \"region\": &amp;graphql.Field{\n            Type: regionType,\n            Resolve: func(p graphql.ResolveParams) (interface{}, error) {\n                source, ok := p.Source.(user)\n                fmt.Printf(\"%#v\\n\", source)\n                fmt.Println(\"ok:\", ok)\n                return source.Region, nil\n            },\n        },\n    },\n})\n\nvar queryType = graphql.NewObject(graphql.ObjectConfig{\n    Name: \"Query\",\n    Fields: graphql.Fields{\n        \"user\": &amp;graphql.Field{\n            Type: userType,\n            Resolve: func(p graphql.ResolveParams) (interface{}, error) {\n                return aUser, nil\n            },\n        },\n    },\n})\n\nfunc executeQuery(query string, schema graphql.Schema) *graphql.Result {\n    result := graphql.Do(graphql.Params{\n        Schema:        schema,\n        RequestString: query,\n    })\n    if len(result.Errors) &gt; 0 {\n        fmt.Printf(\"wrong result, unexpected errors: %v\", result.Errors)\n    }\n    return result\n}\n\nfunc main() {\n    var schema, _ = graphql.NewSchema(graphql.SchemaConfig{\n        Query: queryType,\n    })\n    http.HandleFunc(\"/graphql\", func(w http.ResponseWriter, r *http.Request) {\n        result := executeQuery(r.URL.Query().Get(\"query\"), schema)\n        json.NewEncoder(w).Encode(result)\n    })\n    fmt.Println(\"Now server is running on port 8080\")\n    fmt.Println(\"Access the web app via browser at 'http://localhost:8080'\")\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>Send GraphQL request using <code>curl</code>:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>~ curl -g 'http://localhost:8080/graphql?query={user{id,name,region{id,name}}}'\n{\"data\":{\"user\":{\"id\":\"34\",\"name\":\"something\",\"region\":{\"id\":34,\"name\":\"San jose\"}}}}\n</code></pre>\n\n<p>Logs of server:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>~ go run main.go\nNow server is running on port 8080\nAccess the web app via browser at 'http://localhost:8080'\nmain.user{ID:\"34\", Name:\"something\", Region:main.region{ID:34, Name:\"San jose\"}}\nok: true\nmain.user{ID:\"34\", Name:\"something\", Region:main.region{ID:34, Name:\"San jose\"}}\nok: true\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4629500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1a34df225c9c140ef1405a759cc544e?s=128&d=identicon&r=PG&f=1", "display_name": "Ivanz", "link": "https://stackoverflow.com/users/4629500/ivanz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1585828451, "creation_date": 1548879970, "question_id": 54448994, "link": "https://stackoverflow.com/questions/54448994/graphql-go-define-field-type-as-object", "title": "graphql-go define field type as object", "body": "<p>Using graphql-go how do we handle nested objects as in given api returns the following in resolver</p>\n\n<p>{\nid:\"34\",\nname:\"something\",\nregion:{\n    id:34,\n    name: \"San jose\"\n   }\n}</p>\n\n<p>how do we implement for region:\n            \"region\": &amp;graphql.Field{\n                Type: graphql.??,\n            },</p>\n"}, {"tags": ["go", "google-cloud-platform", "google-cloud-functions"], "comments": [{"owner": {"reputation": 728, "user_id": 3348617, "user_type": "registered", "profile_image": "https://graph.facebook.com/1475953069/picture?type=large", "display_name": "zdebra", "link": "https://stackoverflow.com/users/3348617/zdebra"}, "edited": false, "score": 1, "creation_date": 1548876637, "post_id": 54447975, "comment_id": 95705220, "body": "Please, provide the code, the solutions you already tried. I can only copy and paste the documentation for your general question."}], "answers": [{"tags": [], "owner": {"reputation": 1510, "user_id": 6476791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55d5de71330e6307063fdb6dde80d7ca?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/6476791/adrian"}, "is_accepted": false, "score": 4, "last_activity_date": 1549052988, "last_edit_date": 1549052988, "creation_date": 1548912535, "answer_id": 54453878, "question_id": 54447975, "link": "https://stackoverflow.com/questions/54447975/how-can-i-programmatically-create-a-google-cloud-function-using-the-go-api-clien/54453878#54453878", "title": "How can I programmatically create a Google Cloud Function using the Go API client", "body": "<p>I have encountered a similar issue when using  google.golang.org/api/cloudfunctions/v1, \nthe first problem with 403 error I had, was due to using auth client\nwith presigned Generate Upload  URL, using bare http client helped</p>\n\n<pre><code>httpClient := http.DefaultClient\ndata, err := ioutil.ReadAll(reader)\nif err != nil {\n    return err\n}\nrequest, err := http.NewRequest(\"PUT\", uploadURL, bytes.NewReader(data))\nif err != nil {\n    return err\n}\nrequest.Header.Set(\"content-type\", \"application/zip\")\nrequest.Header.Set(\"x-goog-content-length-range\", \"0,104857600\")\nrequest.Header.Set(\"Content-Length\", fmt.Sprintf(\"%d\", len(data)))\nresponse, err := httpClient.Do(request)\nif err != nil {\n    return err\n}\n</code></pre>\n\n<p>Another issue I saw with 404 was when I was using location as region as opposed to the fully qualified name presented in the below snippet</p>\n\n<pre><code>var location =  'projects/${projectID}/locations/${region}'  \nprojectService := cloudfunctions.NewProjectsLocationsFunctionsService(ctxClient.service)\ncreateCall := projectService.Create(location, request.CloudFunction)\ncreateCall.Context(ctxClient.Context())\nreturn createCall.Do()\nh\n</code></pre>\n\n<p>You can also check golang cloud functions google.golang.org/api/cloudfunctions/v1  API usage in this project:</p>\n\n<p><a href=\"https://github.com/viant/endly/blob/master/system/cloud/gcp/cloudfunctions/service.go\" rel=\"nofollow noreferrer\">Cloud function service</a></p>\n"}], "owner": {"reputation": 79, "user_id": 10199528, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xBUYptAgVXg/AAAAAAAAAAI/AAAAAAAAFHo/WBOf_l4Ijwg/photo.jpg?sz=128", "display_name": "stewblr", "link": "https://stackoverflow.com/users/10199528/stewblr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1549052988, "creation_date": 1548875776, "question_id": 54447975, "link": "https://stackoverflow.com/questions/54447975/how-can-i-programmatically-create-a-google-cloud-function-using-the-go-api-clien", "title": "How can I programmatically create a Google Cloud Function using the Go API client", "body": "<p>There is a Go package for interacting with the Cloud Functions API (<a href=\"https://godoc.org/google.golang.org/api/cloudfunctions/v1\" rel=\"nofollow noreferrer\">google.golang.org/api/cloudfunctions/v1</a>) but I can't figure out how to use it to create new functions. I'm getting 404 and 403 errors when attempting to upload to the signed URL for the Cloud Storage bucket.</p>\n\n<p>Does anyone know how to use this package to deploy Cloud Functions?</p>\n"}, {"tags": ["http", "go", "mutex", "race-condition"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1548873032, "post_id": 54447134, "comment_id": 95703391, "body": "Have you run it with the race detector? Are you sure you&#39;re not running out of system resources, like memory?"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1548873222, "post_id": 54447134, "comment_id": 95703500, "body": "@JimB yeah i&#39;ve run all the tests with the race flag on, separately I split traffic to a dev box which ran the binary with race on. Though, it could be memory related. I see dips in usage memory right around the time these panics happen.. Though the usable memory isn&#39;t 0, its more like a 20% dip."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548874361, "post_id": 54447134, "comment_id": 95704101, "body": "This doesn&#39;t look like a race, and that goroutine stack doesn&#39;t help so much -- though <code>semacquire, 7 minutes</code> does look like a problem, it&#39;s just not the cause. You&#39;d have to look though the full stack trace if possible for goroutines blocked while holding that mutex. (SO isn&#39;t really the place for troubleshooting these things, I would take this over to the mailing list.)"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548874718, "post_id": 54447134, "comment_id": 95704288, "body": "@JimB, looking deeper I do believe it is memory related, this ticket safe to close. But given points have been distributed why don&#39;t you answer so that i can accept it. Thank you"}], "owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1548873407, "creation_date": 1548872619, "last_edit_date": 1548873407, "question_id": 54447134, "link": "https://stackoverflow.com/questions/54447134/possible-race-condition-with-http2-implementation", "title": "Possible race condition With http2 implementation", "body": "<p>I have a curious issue, which happens in production very infrequently.</p>\n\n<p>I have a gobal http client to reuse connections. </p>\n\n<pre><code>DefaultClient = &amp;http.Client{\n    Transport: &amp;http.Transport{\n        Proxy: http.ProxyFromEnvironment,\n        DialContext: (&amp;net.Dialer{\n            Timeout:   500 * time.Millisecond,\n            KeepAlive: 1 * time.Minute,\n        }).DialContext,\n        TLSHandshakeTimeout: 500 * time.Millisecond,\n        MaxIdleConns:        3000,\n        MaxIdleConnsPerHost: 3000,\n        IdleConnTimeout:     1 * time.Minute,\n    },\n    Timeout: 500 * time.Millisecond,\n}\n</code></pre>\n\n<p>Every so often a machine will become unresponsive because it is unable to recover from a panic, which seems to be related to mutex locking and unlocking within the Go standard http lib.</p>\n\n<pre><code>goroutine 47888935 [semacquire, 7 minutes]:\nsync.runtime_SemacquireMutex(0xc00040126c, 0x0)\n    /usr/local/go/src/runtime/sema.go:71 +0x3d\nsync.(*Mutex).Lock(0xc000401268)\n    /usr/local/go/src/sync/mutex.go:134 +0xff\nnet/http.(*http2clientConnPool).getClientConn(0xc000401260, 0xc028295f00, 0xc0281de820, 0x12, 0xc00027a400, 0xc0283266a8, 0x6aafa0, 0xc00027a410)\n    /usr/local/go/src/net/http/h2_bundle.go:760 +0x65\nnet/http.http2noDialClientConnPool.GetClientConn(0xc000401260, 0xc028295f00, 0xc0281de820, 0x12, 0xc0281de820, 0x12, 0x0)\n    /usr/local/go/src/net/http/h2_bundle.go:954 +0x4e\nnet/http.(*http2Transport).RoundTripOpt(0xc00027a410, 0xc028295f00, 0x0, 0x200000000000000, 0x4137ec, 0xb940aa)\n    /usr/local/go/src/net/http/h2_bundle.go:7031 +0x105\nnet/http.(*http2Transport).RoundTrip(0xc00027a410, 0xc028295f00, 0x1, 0xc028307800, 0x0)\n    /usr/local/go/src/net/http/h2_bundle.go:6999 +0x3a\nnet/http.http2noDialH2RoundTripper.RoundTrip(0xc00027a410, 0xc028295f00, 0xc0282cf800, 0x5, 0xc00059c2c8)\n    /usr/local/go/src/net/http/h2_bundle.go:1019 +0x39\nnet/http.(*Transport).roundTrip(0xc000177680, 0xc028295f00, 0xc028267a70, 0xc02801ff88, 0xc02801ff90)\n    /usr/local/go/src/net/http/transport.go:415 +0xd4c\nnet/http.(*Transport).RoundTrip(0xc000177680, 0xc028295f00, 0xc000177680, 0xbf0c9388b63791ca, 0x2122772ff0fc)\n    /usr/local/go/src/net/http/roundtrip.go:17 +0x35\nnet/http.send(0xc028295e00, 0xc99600, 0xc000177680, 0xbf0c9388b63791ca, 0x2122772ff0fc, 0x11d03a0, 0xc027ef3480, 0xbf0c9388b63791ca, 0xc028326cb8, 0x1)\n    /usr/local/go/src/net/http/client.go:250 +0x14b\nnet/http.(*Client).send(0xc000400360, 0xc028295e00, 0xbf0c9388b63791ca, 0x2122772ff0fc, 0x11d03a0, 0xc027ef3480, 0x0, 0x1, 0xc000518000)\n    /usr/local/go/src/net/http/client.go:174 +0xfa\nnet/http.(*Client).do(0xc000400360, 0xc028295e00, 0x0, 0x0, 0x0)\n    /usr/local/go/src/net/http/client.go:641 +0x2a8\nnet/http.(*Client).Do(0xc000400360, 0xc028295e00, 0x10, 0xb933f5, 0x4)\n    /usr/local/go/src/net/http/client.go:509 +0x35\n</code></pre>\n\n<p>It happens so infrequently in high traffic, production that it's hard to reproduce.</p>\n\n<p>Has anyone experienced this before or has any insights at the possible problem?  It seems tightly coupled with the http client.</p>\n"}, {"tags": ["go", "ubuntu-18.04", "beego", "gopath"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1548871449, "post_id": 54446551, "comment_id": 95702645, "body": "Can you edit your question to add the output of <code>go env</code>?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548872600, "post_id": 54446551, "comment_id": 95703184, "body": "May or may not be related, but don&#39;t set <code>PATH</code> variables in an rc file. Always use one of the profile files."}, {"owner": {"reputation": 509, "user_id": 2315094, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7dbc931c7f9da91b1aca5f461d25edb0?s=128&d=identicon&r=PG", "display_name": "user2315094", "link": "https://stackoverflow.com/users/2315094/user2315094"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1548921367, "post_id": 54446551, "comment_id": 95719585, "body": "@Adrian I added more info above"}, {"owner": {"reputation": 2612, "user_id": 2273578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/211dd1a8e9f61b248fba83b9924f4f13?s=128&d=identicon&r=PG", "display_name": "Mario P&#233;rez", "link": "https://stackoverflow.com/users/2273578/mario-p%c3%a9rez"}, "edited": false, "score": 0, "creation_date": 1554540686, "post_id": 54446551, "comment_id": 97796850, "body": "Try again with go 1.12?"}], "owner": {"reputation": 509, "user_id": 2315094, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7dbc931c7f9da91b1aca5f461d25edb0?s=128&d=identicon&r=PG", "display_name": "user2315094", "link": "https://stackoverflow.com/users/2315094/user2315094"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 345, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1548921335, "creation_date": 1548870411, "last_edit_date": 1548921335, "question_id": 54446551, "link": "https://stackoverflow.com/questions/54446551/beego-binary-is-installed-an-absurd-path-and-bee-new-command-doesnt-work", "title": "beego binary is installed an absurd path and &#39;bee new&#39; command doesn&#39;t work", "body": "<p>I installed almost 10 days ago golang in my Ubuntu 18.04.01 Server Edition:</p>\n\n<pre><code>go version\ngo version go1.10.4 linux/amd64\n</code></pre>\n\n<p>The GOPATH set in .bashrc is this:</p>\n\n<pre><code>export GOPATH=$HOME/go\nexport PATH=${PATH}:${GOPATH}/bin\n</code></pre>\n\n<p>and I've been using golang since then.\nToday I tried to install beego but happens something really strange:</p>\n\n<pre><code>go get -u github.com/astaxie/beego\ngo get -u github.com/beego/bee\n</code></pre>\n\n<p>The binary file is installed in a very long, and actually strange and absurd  path:</p>\n\n<pre><code>marco@pc01:~/go/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:\n/sbin:/bin:/usr/games:/usr/local/games:/snap/bin$ ls -lah\ntotal 16M\ndrwxrwxr-x 2 marco marco 4.0K Jan 30 17:14 .\ndrwxrwxr-x 3 marco marco 4.0K Jan 30 17:14 ..\n-rwxrwxr-x 1 marco marco  16M Jan 30 17:14 bee\n</code></pre>\n\n<p>While the src beego directory seems correctly installed:</p>\n\n<pre><code>/home/marco/go/src/github.com/beego/bee\n</code></pre>\n\n<p>What is strange, again, is that if try to execute this simple go code:</p>\n\n<pre><code>package main\n\nimport (\n        \"github.com/astaxie/beego\"\n)\n\ntype MainController struct {\n        beego.Controller\n}\n\nfunc (this *MainController) Get() {\n\n        this.Ctx.WriteString(\"hello world\")\n\n}\n\nfunc main() {\n\n        beego.Router(\"/\", &amp;MainController{})\n        beego.Run()\n\n}\n\ngo run helloBeego.go\n2019/01/30 17:37:06.139 [I]  http server Running on http://:8080\n</code></pre>\n\n<p>And in the web browser I actually get:</p>\n\n<pre><code>hello world \n</code></pre>\n\n<p>But when I try to create a bee project:</p>\n\n<pre><code>/go/src$ bee new my-first-beego-project\n\nCommand 'bee' not found, did you mean:\n\n  command 'be' from deb bugs-everywhere\n  command 'btee' from deb ruby-bcat\n  command 'beef' from deb beef\n  command 'bbe' from deb bbe\n  command 'ben' from deb ben\n  command 'beet' from deb beets\n  command 'beep' from deb beep\n  command 'see' from deb mime-support\n  command 'ree' from deb ree\n  command 'pee' from deb moreutils\n  command 'beer' from deb gerstensaft\n  command 'tee' from deb coreutils\n  command 'bel' from deb belier\n</code></pre>\n\n<p>I guess that the absurd path in which bee binary is put  and the fact that creation of bee project with 'bee new' command fails are related problems.\nHow to solve them?\nLooking forward to your kind help.\nMarco</p>\n\n<p>Added info, as rightly requested:</p>\n\n<pre><code>marco@pc01:~$ go env\nGOARCH=\"amd64\"\nGOBIN=\"\"\nGOCACHE=\"/home/marco/.cache/go-build\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/marco/go\"\nGORACE=\"\"\nGOROOT=\"/usr/lib/go-1.10\"\nGOTMPDIR=\"\"\nGOTOOLDIR=\"/usr/lib/go-1.10/pkg/tool/linux_amd64\"\nGCCGO=\"gccgo\"\nCC=\"gcc\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\nCGO_CFLAGS=\"-g -O2\"\nCGO_CPPFLAGS=\"\"\nCGO_CXXFLAGS=\"-g -O2\"\nCGO_FFLAGS=\"-g -O2\"\nCGO_LDFLAGS=\"-g -O2\"\nPKG_CONFIG=\"pkg-config\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0 -fdebug-prefix-\nmap=/tmp/go-build461259545=/tmp/go-build -gno-record-gcc-switches\"\nmarco@pc01:~$\n</code></pre>\n\n<p>Version of beego:</p>\n\n<pre><code>v1.6.2\n</code></pre>\n"}, {"tags": ["angularjs", "authentication", "go", "google-drive-api"], "answers": [{"comments": [{"owner": {"reputation": 106, "user_id": 7469302, "user_type": "registered", "profile_image": "https://graph.facebook.com/946445172159805/picture?type=large", "display_name": "Prasad Kavinda", "link": "https://stackoverflow.com/users/7469302/prasad-kavinda"}, "edited": false, "score": 0, "creation_date": 1548905815, "post_id": 54449548, "comment_id": 95714141, "body": "Thanks for the answer :) Actually <code>&lt;user-email&gt;_token.json</code> files will create for each user. Sorry I didn&#39;t mention in question. So in my app, users can add torrent magnets to download. And server will download it. Once the download finished It uploads to the users Gdrive. So the token has to be in server side right?"}, {"owner": {"reputation": 11, "user_id": 9918667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39340eb3363ab63c8590741eaa2e032b?s=128&d=identicon&r=PG&f=1", "display_name": "fberrez", "link": "https://stackoverflow.com/users/9918667/fberrez"}, "reply_to_user": {"reputation": 106, "user_id": 7469302, "user_type": "registered", "profile_image": "https://graph.facebook.com/946445172159805/picture?type=large", "display_name": "Prasad Kavinda", "link": "https://stackoverflow.com/users/7469302/prasad-kavinda"}, "edited": false, "score": 0, "creation_date": 1549024625, "post_id": 54449548, "comment_id": 95766186, "body": "In your case yes. But I still think that is not the best solution."}], "tags": [], "owner": {"reputation": 11, "user_id": 9918667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39340eb3363ab63c8590741eaa2e032b?s=128&d=identicon&r=PG&f=1", "display_name": "fberrez", "link": "https://stackoverflow.com/users/9918667/fberrez"}, "is_accepted": false, "score": 0, "last_activity_date": 1548882430, "creation_date": 1548882430, "answer_id": 54449548, "question_id": 54443985, "link": "https://stackoverflow.com/questions/54443985/authenticate-with-google-drive-api-in-angularjs/54449548#54449548", "title": "Authenticate with Google Drive API in AngularJS", "body": "<p>Your token does not have to be on the server side.</p>\n\n<p>Why? Because if you have many clients connected to your server, it would mean that all of these clients are sharing the same token and therefore have access to the Google Drive linked to this token. It does not make sense.</p>\n\n<p>The token has to be on the client side. You should save the token as a cookie, maybe by using <a href=\"https://jwt.io/\" rel=\"nofollow noreferrer\">JWT</a>, I let you read the documentation of JWT to know why it would be interesting to use it in your case or not.</p>\n\n<p>Then on your Angular, you have to say something like \"hey, this client has a cookie called \"my-google-drive-token\", let's check if that is a good one... Mmmmh, okay seems to be good, I display the Google Drive content\".</p>\n\n<p>Think about using good practices about security (using an encrypted token in your cookie, making the connection between the front and the back safe, <a href=\"https://support.google.com/googleapi/answer/6310037?hl=en\" rel=\"nofollow noreferrer\">keep your API key safe</a>...).</p>\n\n<p>Your backend is only a gateway between your front-end and the Google Drive API. </p>\n\n<p>Also, check the usefulness of your server. I think that in your case, a simple frontend connected to the Google API is enough.</p>\n"}], "owner": {"reputation": 106, "user_id": 7469302, "user_type": "registered", "profile_image": "https://graph.facebook.com/946445172159805/picture?type=large", "display_name": "Prasad Kavinda", "link": "https://stackoverflow.com/users/7469302/prasad-kavinda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548905288, "creation_date": 1548861983, "last_edit_date": 1548905288, "question_id": 54443985, "link": "https://stackoverflow.com/questions/54443985/authenticate-with-google-drive-api-in-angularjs", "title": "Authenticate with Google Drive API in AngularJS", "body": "<p>I created this web app completely in go-lang, which uses Google Drive API to authenticate users. Once user authenticated, it saves the token in a <code>&lt;user-email&gt;_token.json</code> file so the app can operate for 24 hours without the users involvement. It works fine. But now I want to separate the front-end from (Go-Lang)back-end and convert it to AngularJS.</p>\n\n<p>So I have this problem with authentication. Because I should keep the authentication in server-side. But  then how would Angular know that the user is authenticated or not? Because I cannot use sessions. </p>\n\n<p>Should I need to use JWT to this? If it is, then how should I do it? </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 14361, "user_id": 3612353, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/94f2502e42d2e474bfd81dba411fe66f?s=128&d=identicon&r=PG", "display_name": "cn007b", "link": "https://stackoverflow.com/users/3612353/cn007b"}, "edited": false, "score": 1, "creation_date": 1548862846, "post_id": 54443889, "comment_id": 95697770, "body": "In case of <code>error</code> you will receive real type, but in case of <code>no-error</code> the type is <code>nil</code>."}], "answers": [{"comments": [{"owner": {"reputation": 5323, "user_id": 4636721, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/6NGhx.jpg?s=128&g=1", "display_name": "Mary Perret", "link": "https://stackoverflow.com/users/4636721/mary-perret"}, "edited": false, "score": 0, "creation_date": 1548862613, "post_id": 54443962, "comment_id": 95697605, "body": "I see makes sense about why Printf cannot resolve any kind of type. Thanks!"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 5, "last_activity_date": 1548862264, "last_edit_date": 1548862264, "creation_date": 1548861909, "answer_id": 54443962, "question_id": 54443889, "link": "https://stackoverflow.com/questions/54443889/why-fmt-printlnt-n-e-where-e-is-an-error-variable-prints-out-nil-and/54443962#54443962", "title": "Why `fmt.Println(&quot;%T\\n&quot;, e)` where `e` is an error variable prints out &lt;nil&gt; and not its type?", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Errors\" rel=\"noreferrer\">Errors</a></p>\n  \n  <p>The predeclared type error is defined as</p>\n\n<pre><code>type error interface {\n  Error() string\n}\n</code></pre>\n  \n  <p>It is the conventional interface for representing an error condition,\n  with the nil value representing no error.</p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Interface_types\" rel=\"noreferrer\">Interface types</a></p>\n  \n  <p>An interface type specifies a method set called its interface. A\n  variable of interface type can store a value of any type with a method\n  set that is any superset of the interface. Such a type is said to\n  implement the interface. The value of an uninitialized variable of\n  interface type is nil.</p>\n  \n  <p><a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"noreferrer\">The zero value</a></p>\n  \n  <p>When storage is allocated for a variable, either through a declaration\n  or a call of new, or when a new value is created, either through a\n  composite literal or a call of make, and no explicit initialization is\n  provided, the variable or value is given a default value. Each element\n  of such a variable or value is set to the zero value for its type: nil\n  for interfaces.</p>\n</blockquote>\n\n<hr>\n\n<p>A zero-value <code>error</code> type, an interface, has no type.Its value is <code>nil</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 14361, "user_id": 3612353, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/94f2502e42d2e474bfd81dba411fe66f?s=128&d=identicon&r=PG", "display_name": "cn007b", "link": "https://stackoverflow.com/users/3612353/cn007b"}, "is_accepted": false, "score": 2, "last_activity_date": 1548862332, "creation_date": 1548862332, "answer_id": 54444100, "question_id": 54443889, "link": "https://stackoverflow.com/questions/54443889/why-fmt-printlnt-n-e-where-e-is-an-error-variable-prints-out-nil-and/54444100#54444100", "title": "Why `fmt.Println(&quot;%T\\n&quot;, e)` where `e` is an error variable prints out &lt;nil&gt; and not its type?", "body": "<blockquote>\n  <p><code>e</code> is an empty pointer</p>\n</blockquote>\n\n<p>Nope, <code>error</code> itself - interface, so you won't have type here.</p>\n"}], "owner": {"reputation": 5323, "user_id": 4636721, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/6NGhx.jpg?s=128&g=1", "display_name": "Mary Perret", "link": "https://stackoverflow.com/users/4636721/mary-perret"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 1, "accepted_answer_id": 54443962, "answer_count": 2, "score": 2, "last_activity_date": 1548862332, "creation_date": 1548861668, "question_id": 54443889, "link": "https://stackoverflow.com/questions/54443889/why-fmt-printlnt-n-e-where-e-is-an-error-variable-prints-out-nil-and", "title": "Why `fmt.Println(&quot;%T\\n&quot;, e)` where `e` is an error variable prints out &lt;nil&gt; and not its type?", "body": "<p>I was recently playing with the Go language and I bumped into something a bit weird to say the least, let's consider a very simple function:</p>\n\n<pre><code>func main() {\n    n, e := fmt.Println(`He said: \"Hello\"`)\n    fmt.Printf(\"%T\\n\", n)\n}\n</code></pre>\n\n<p>Which outputs what I was expecting:</p>\n\n<pre><code>He said: \"Hello\"\nint\n</code></pre>\n\n<p>Now if I want to display the type of <code>e</code>:</p>\n\n<pre><code>func main() {\n    n, e := fmt.Println(`He said: \"Hello\"`)\n    fmt.Printf(\"%T\\n\", e)\n}\n</code></pre>\n\n<p>and this time prints out:</p>\n\n<pre><code>He said: \"Hello\"\n&lt;nil&gt;\n</code></pre>\n\n<p>I get the part that there is no error so <code>e</code> is an empty pointer: <a href=\"https://stackoverflow.com/questions/35983118/what-does-nil-mean-in-golang\"><code>nil</code></a> but I would have not expected to be a ~~type~~ on its own.</p>\n\n<p>Why am I not getting the actual type? </p>\n\n<p>If so, is there a workaround? (not saying my use case is a realistic one but curious if there is any possibility)</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2624, "user_id": 3310285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaFcy.png?s=128&g=1", "display_name": "Alex Efimov", "link": "https://stackoverflow.com/users/3310285/alex-efimov"}, "edited": false, "score": 2, "creation_date": 1548863037, "post_id": 54443388, "comment_id": 95697868, "body": "<code>AuthFunc</code> should return <code>http.Handler</code> and not <code>HandlerFunc</code> type"}], "answers": [{"tags": [], "owner": {"reputation": 2859, "user_id": 6225565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iqBej.jpg?s=128&g=1", "display_name": "Shalauddin Ahamad Shuza", "link": "https://stackoverflow.com/users/6225565/shalauddin-ahamad-shuza"}, "is_accepted": true, "score": 3, "last_activity_date": 1548867606, "creation_date": 1548867606, "answer_id": 54445749, "question_id": 54443388, "link": "https://stackoverflow.com/questions/54443388/go-gorilla-mux-middlewarefunc-with-r-use-and-returning-errors/54445749#54445749", "title": "Go Gorilla Mux MiddlewareFunc with r.Use and returning errors", "body": "<p>According to the <a href=\"https://godoc.org/github.com/gorilla/mux#Router.Use\" rel=\"nofollow noreferrer\">mux.Use doc</a> its argument type is <a href=\"https://godoc.org/github.com/gorilla/mux#MiddlewareFunc\" rel=\"nofollow noreferrer\">MiddlewareFunc</a> which return type is <code>http.Handler</code> not error type. You have to define which return type is <code>http.HandlerFunc</code></p>\n\n<pre><code>type Middleware func(http.HandlerFunc) http.HandlerFunc\n\nfunc main() {\n    r := mux.NewRouter()\n\n    //  execute middleware from right to left of the chain\n    chain := Chain(SayHello, AuthFunc(), LoggingFunc())\n    r.HandleFunc(\"/\", chain)\n\n    println(\"server listening :  8000\")\n    http.ListenAndServe(\":8000\", r)\n}\n\n// Chain applies middlewares to a http.HandlerFunc\nfunc Chain(f http.HandlerFunc, middlewares ...Middleware) http.HandlerFunc {\n    for _, m := range middlewares {\n        f = m(f)\n    }\n    return f\n}\n\nfunc LoggingFunc() Middleware {\n    return func(next http.HandlerFunc) http.HandlerFunc {\n        return func(w http.ResponseWriter, r *http.Request) {\n            // Loggin middleware\n\n            defer func() {\n                if _, ok := recover().(error); ok {\n                    w.WriteHeader(http.StatusInternalServerError)\n                }\n            }()\n\n            // Call next middleware/handler in chain\n            next(w, r)\n        }\n    }\n}\n\nfunc AuthFunc() Middleware {\n    return func(next http.HandlerFunc) http.HandlerFunc {\n        return func(w http.ResponseWriter, r *http.Request) {\n\n            if r.Header.Get(\"JWT\") == \"\" {\n                fmt.Errorf(\"No JWT\")\n                return\n            }\n\n            next(w, r)\n        }\n    }\n\n}\n\nfunc SayHello(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintln(w, \"Hello client\")\n}\n</code></pre>\n\n<p>It will execute the <code>LogginFunc</code> then <code>AuthFunc</code> and then <code>SayHello</code> method which is your desire method after passing all those middlewares.</p>\n"}], "owner": {"reputation": 457, "user_id": 4489733, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/10714df646d369c5a41225156d051cac?s=128&d=identicon&r=PG&f=1", "display_name": "mbudge", "link": "https://stackoverflow.com/users/4489733/mbudge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1696, "favorite_count": 0, "accepted_answer_id": 54445749, "answer_count": 1, "score": 0, "last_activity_date": 1548867606, "creation_date": 1548860048, "question_id": 54443388, "link": "https://stackoverflow.com/questions/54443388/go-gorilla-mux-middlewarefunc-with-r-use-and-returning-errors", "title": "Go Gorilla Mux MiddlewareFunc with r.Use and returning errors", "body": "<p>How do you set up Gorilla Mux r.Use to return errors down the middleware chain? <a href=\"https://godoc.org/github.com/gorilla/mux#Router.Use\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/gorilla/mux#Router.Use</a></p>\n\n<p>Main.go</p>\n\n<pre><code>r := mux.NewRouter()\n\nr.Use(LoggingFunc)\nr.Use(AuthFunc)\n</code></pre>\n\n<p>Basic middleware</p>\n\n<p>Starts with logging middleware which can catch and handle errors from further down the chain</p>\n\n<pre><code>type HandlerFunc func(w http.ResponseWriter, r *http.Request) error\n\nfunc LoggingFunc(next HandlerFunc) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        // Logging middleware\n\n        defer func() {\n            if err, ok := recover().(error); ok {\n                w.WriteHeader(http.StatusInternalServerError)\n            }\n        }()\n\n        err := next(w, r)\n        if err != nil {\n            // log error\n        }\n    })\n}\n</code></pre>\n\n<p>The next middleware handles authentication and returns an error to the logging middleware.</p>\n\n<pre><code>func AuthFunc(next HandlerFunc) HandlerFunc {\n    return func(w http.ResponseWriter, r *http.Request) error {\n\n        if r.GET(\"JWT\") == \"\" {\n            return fmt.Errorf(\"No JWT\")\n        }\n\n        return next(w, r)\n    }\n}\n</code></pre>\n\n<p>I keep getting errors like</p>\n\n<pre><code>  cannot use AuthFunc (type func(handlers.HandlerFunc) http.Handler) as type mux.MiddlewareFunc in argument to r.Use\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", "go", "utf-8"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 8, "creation_date": 1548852729, "post_id": 54440998, "comment_id": 95691138, "body": "Your input byte sequence is not a valid UTF-8 byte sequence, yet you&#39;re attempting to treat it like that."}, {"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 6, "creation_date": 1548852986, "post_id": 54440998, "comment_id": 95691288, "body": "To expand on @icza&#39;s point: if you try to utf-8 decode something that isn&#39;t utf-8 input, then the output is undefined. It is perfectly reasonably to expect that two different frameworks will have different outcomes for an undefined scenario. Technically it is legal for a single framework to have a different outcome depending on the day of the week... it is, after all: <i>undefined</i>"}, {"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "edited": false, "score": 3, "creation_date": 1548853117, "post_id": 54440998, "comment_id": 95691361, "body": "Perhaps a more fruitful avenue to explore here is - <i>what are you trying to do?</i>: since that data isn&#39;t utf-8, clearly decoding it as utf-8 isn&#39;t a good option. Would displaying it as hex be useful to you?"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "edited": false, "score": 1, "creation_date": 1548853347, "post_id": 54440998, "comment_id": 95691471, "body": "@MarcGravell: &quot;if you try to utf-8 decode something that isn&#39;t utf-8 input, then the output is undefined.&quot; Rob Pike, a co-author of UTF-8 and Go, returns the Unicode replacement character for invalid UTF-8 in Go. The output is well-defined, although it may not be useful."}, {"owner": {"reputation": 97, "user_id": 8171348, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CowM9oWopyU/AAAAAAAAAAI/AAAAAAAAABQ/a4LfNd7efL4/photo.jpg?sz=128", "display_name": "Kunal", "link": "https://stackoverflow.com/users/8171348/kunal"}, "reply_to_user": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "edited": false, "score": 0, "creation_date": 1548853533, "post_id": 54440998, "comment_id": 95691602, "body": "@marc-gravell  these bytes gets produced by the Hmac Sha1 algorithm, both c# and go produce same hash bytes as above.  I have had this implementation working in c# where I convert those bytes to UTF8 string in one of my open source project. I am looking for the port to go."}, {"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "edited": false, "score": 6, "creation_date": 1548853977, "post_id": 54440998, "comment_id": 95691868, "body": "@Kunal the output of a hmac sha hash is <b>not utf-8</b>. So... everything I said still applies. Indeed: hashes are almost always expressed as hex"}, {"owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "edited": false, "score": 0, "creation_date": 1548898464, "post_id": 54440998, "comment_id": 95712634, "body": "@Kunal Might want to go back and modify that open source C# project then - it&#39;s clearly broken!"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1548855201, "last_edit_date": 1548855201, "creation_date": 1548853914, "answer_id": 54441438, "question_id": 54440998, "link": "https://stackoverflow.com/questions/54440998/cs-encoding-utf8-getstring-equivalent-in-go/54441438#54441438", "title": "C#&#39;s Encoding.UTF8.GetString equivalent in Go", "body": "<p>Clearly, whatever way you look at it, your <code>bytes</code> are not valid UTF-8.</p>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    bytes := []byte{144, 197, 217, 192, 204, 249, 181, 42, 92, 252, 243, 87, 170, 243, 169, 80, 175, 112, 192, 239}\n    fmt.Println(len(bytes))\n    fmt.Printf(\"%v\\n\", bytes)\n    fmt.Printf(\"% x\\n\", bytes)\n    fmt.Printf(\"%q\\n\", bytes)\n    fmt.Printf(\"%s\\n\", bytes)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/bHhkeGuZcCK\" rel=\"nofollow noreferrer\">https://play.golang.org/p/bHhkeGuZcCK</a></p>\n\n<p>Output:</p>\n\n<pre><code>20\n[144 197 217 192 204 249 181 42 92 252 243 87 170 243 169 80 175 112 192 239]\n90 c5 d9 c0 cc f9 b5 2a 5c fc f3 57 aa f3 a9 50 af 70 c0 ef\n\"\\x90\\xc5\\xd9\\xc0\\xcc\\xf9\\xb5*\\\\\\xfc\\xf3W\\xaa\\xf3\\xa9P\\xafp\\xc0\\xef\"\n\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd*\\\ufffd\ufffdW\ufffd\ufffd\ufffdP\ufffdp\ufffd\ufffd\n</code></pre>\n\n<p>References:</p>\n\n<p><a href=\"http://www.unicode.org/\" rel=\"nofollow noreferrer\">The Unicode Consortium</a></p>\n\n<p><a href=\"http://unicode.org/faq/utf_bom.html\" rel=\"nofollow noreferrer\">Unicode: UTF-8, UTF-16, UTF-32 &amp; BOM</a></p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/UTF-8\" rel=\"nofollow noreferrer\">UTF-8 - Wikipedia</a></p>\n\n<p><a href=\"https://blog.golang.org/strings\" rel=\"nofollow noreferrer\">The Go Blog: Strings, bytes, runes and characters in Go</a></p>\n\n<p><a href=\"https://golang.org/pkg/unicode/utf8/\" rel=\"nofollow noreferrer\">Go: Package utf8</a></p>\n"}], "owner": {"reputation": 97, "user_id": 8171348, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CowM9oWopyU/AAAAAAAAAAI/AAAAAAAAABQ/a4LfNd7efL4/photo.jpg?sz=128", "display_name": "Kunal", "link": "https://stackoverflow.com/users/8171348/kunal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 1, "closed_date": 1548860838, "answer_count": 1, "score": -6, "last_activity_date": 1548855201, "creation_date": 1548852455, "last_edit_date": 1548852564, "question_id": 54440998, "link": "https://stackoverflow.com/questions/54440998/cs-encoding-utf8-getstring-equivalent-in-go", "closed_reason": "Not suitable for this site", "title": "C#&#39;s Encoding.UTF8.GetString equivalent in Go", "body": "<p>Whats the equivalent of C#'s Encoding.UTF8.GetString in Go?</p>\n\n<p>As i already know that Go's default encoding is in UTF8 and string(somebytes) in Go would produce a UTF8 encoded string. </p>\n\n<p>C#: </p>\n\n<pre><code>public static void Main()\n{\n    byte[] bytes = new byte[] { 144, 197, 217, 192, 204, 249, 181, 42, 92, 252, 243, 87, 170, 243, 169, 80, 175, 112, 192, 239};\n    string str = Encoding.UTF8.GetString(bytes);\n\n    Console.WriteLine(str);\n }\n</code></pre>\n\n<p>Go: </p>\n\n<pre><code>func main() {\nbytes := []byte { 144, 197, 217, 192, 204, 249, 181, 42, 92, 252, 243, 87, 170, 243, 169, 80, 175, 112, 192, 239}\nstr := string(bytes)\nfmt.Println(str)\n}\n</code></pre>\n\n<p>C# code produces: </p>\n\n<pre><code>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd*\\\ufffd\ufffdW\ufffd\ufffdP\ufffdp\ufffd\ufffd\n</code></pre>\n\n<p>Go code produces: </p>\n\n<pre><code>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd*\\\ufffd\ufffdW\ufffd\ufffd\ufffdP\ufffdp\ufffd\ufffd\n</code></pre>\n\n<p>what I am missing here? </p>\n"}, {"tags": ["azure", "go", "azure-servicebus-queues"], "answers": [{"tags": [], "owner": {"reputation": 3575, "user_id": 111866, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e742e21c1b64a037eaa90aea1fdf7874?s=128&d=identicon&r=PG", "display_name": "Ross Light", "link": "https://stackoverflow.com/users/111866/ross-light"}, "is_accepted": false, "score": 1, "last_activity_date": 1548869414, "creation_date": 1548869414, "answer_id": 54446274, "question_id": 54439723, "link": "https://stackoverflow.com/questions/54439723/how-to-receive-messages-from-azure-queue-subscription-using-go/54446274#54446274", "title": "How to receive messages from azure queue subscription using go", "body": "<p>The Go Cloud Development Kit Pub/Sub API is still a work in progress (it's one of our newer APIs). As of 2019-01-30, there is a <a href=\"https://github.com/google/go-cloud/pull/1207\" rel=\"nofollow noreferrer\">pull request</a> out for review that adds support, so stay tuned!</p>\n"}], "owner": {"reputation": 31, "user_id": 10293406, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-R7Zv4cftCq8/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOKfIMrPGV5uGRZUx52pwGM3a4JzA/mo/photo.jpg?sz=128", "display_name": "Sujith P.D", "link": "https://stackoverflow.com/users/10293406/sujith-p-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1550583404, "creation_date": 1548848204, "last_edit_date": 1550583404, "question_id": 54439723, "link": "https://stackoverflow.com/questions/54439723/how-to-receive-messages-from-azure-queue-subscription-using-go", "title": "How to receive messages from azure queue subscription using go", "body": "<p>I trying to pull messages from azure service bus queue using Go.Queue topic name,subscription name,service name and shared access key value are the credentials.I'm not getting proper sample code for this.Please help me!!</p>\n"}, {"tags": ["docker", "google-app-engine", "go", "google-cloud-platform", "google-cloud-build"], "answers": [{"tags": [], "owner": {"reputation": 381, "user_id": 10615860, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vrzmw.png?s=128&g=1", "display_name": "guille", "link": "https://stackoverflow.com/users/10615860/guille"}, "is_accepted": false, "score": 0, "last_activity_date": 1548877707, "creation_date": 1548877707, "answer_id": 54448428, "question_id": 54438046, "link": "https://stackoverflow.com/questions/54438046/deploying-golang-appengine-on-google-cloud-build-spawns-infinite-builds/54448428#54448428", "title": "Deploying Golang AppEngine on Google Cloud Build spawns infinite builds", "body": "<p>i haven't been able to recreate the infinite builds but a couple things</p>\n\n<ul>\n<li><p>custom runtimes require a Dockerfile, have you tried running your service in the go runtime? </p>\n\n<ul>\n<li><p><a href=\"https://cloud.google.com/appengine/docs/flexible/custom-runtimes/build\" rel=\"nofollow noreferrer\">https://cloud.google.com/appengine/docs/flexible/custom-runtimes/build</a> </p></li>\n<li><p><a href=\"https://cloud.google.com/appengine/docs/go/\" rel=\"nofollow noreferrer\">https://cloud.google.com/appengine/docs/go/</a></p></li>\n<li><p><a href=\"https://cloud.google.com/appengine/docs/flexible/go/quickstart\" rel=\"nofollow noreferrer\">https://cloud.google.com/appengine/docs/flexible/go/quickstart</a></p></li>\n</ul></li>\n<li><p>is there a specific reason you are using volumes instead of just setting the project root in the env?</p>\n\n<ul>\n<li><a href=\"https://github.com/GoogleCloudPlatform/cloud-builders/blob/master/go/examples/hello_world/cloudbuild.yaml\" rel=\"nofollow noreferrer\">https://github.com/GoogleCloudPlatform/cloud-builders/blob/master/go/examples/hello_world/cloudbuild.yaml</a></li>\n<li><a href=\"https://github.com/GoogleCloudPlatform/cloud-builders/tree/master/go/examples\" rel=\"nofollow noreferrer\">https://github.com/GoogleCloudPlatform/cloud-builders/tree/master/go/examples</a></li>\n</ul></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 413, "user_id": 6039122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfac0207c5bc06a9542737ff0ec9e12?s=128&d=identicon&r=PG&f=1", "display_name": "alextru", "link": "https://stackoverflow.com/users/6039122/alextru"}, "edited": false, "score": 0, "creation_date": 1556870855, "post_id": 55866211, "comment_id": 98582113, "body": "@Prajjwal in case this answer was useful, could you accept it? Thanks!"}, {"owner": {"reputation": 942, "user_id": 555297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/042af2127e5a00db66519681e1de46e9?s=128&d=identicon&r=PG", "display_name": "Prajjwal", "link": "https://stackoverflow.com/users/555297/prajjwal"}, "edited": false, "score": 0, "creation_date": 1557256769, "post_id": 55866211, "comment_id": 98701893, "body": "Giving it every permission it asked for was the first thing I tried. This wasn&#39;t it."}], "tags": [], "owner": {"reputation": 1040, "user_id": 11135159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb3b536ae330b4e19e8359824aef583?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel Czuczwara", "link": "https://stackoverflow.com/users/11135159/pawel-czuczwara"}, "is_accepted": false, "score": 0, "last_activity_date": 1556276503, "creation_date": 1556276503, "answer_id": 55866211, "question_id": 54438046, "link": "https://stackoverflow.com/questions/54438046/deploying-golang-appengine-on-google-cloud-build-spawns-infinite-builds/55866211#55866211", "title": "Deploying Golang AppEngine on Google Cloud Build spawns infinite builds", "body": "<p>You do NOT have permissions to deploy app and enable Appenginge Flexible API.</p>\n\n<p>In the log, there is a warning:</p>\n\n<pre><code>WARNING: Unable to verify that the Appengine Flexible API \nis enabled for project [project-name]. \nYou may not have permission to list enabled services on this project.\nIf it is not enabled, this may cause problems in running your deployment.\nPlease ask the project owner to ensure that the Appengine Flexible API\nhas been enabled and that this account has permission to list enabled APIs.\n</code></pre>\n\n<p>Steps to streamline deployment of the AppEngine Flexible Apps:</p>\n\n<blockquote>\n  <ol>\n  <li>As a project owner: <a href=\"https://cloud.google.com/appengine/docs/flexible/go/granting-project-access#before_you_begin\" rel=\"nofollow noreferrer\">enable Appengine Flexible API + deploy app for the first time</a>, and:</li>\n  <li><a href=\"https://cloud.google.com/appengine/docs/standard/python/granting-project-access#deploying_using_iam_roles\" rel=\"nofollow noreferrer\">Grant permissions to deploy AppEngine app</a> for the user that you are using to perform that tasks.</li>\n  </ol>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 942, "user_id": 555297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/042af2127e5a00db66519681e1de46e9?s=128&d=identicon&r=PG", "display_name": "Prajjwal", "link": "https://stackoverflow.com/users/555297/prajjwal"}, "is_accepted": true, "score": 2, "last_activity_date": 1557257281, "creation_date": 1557257281, "answer_id": 56029308, "question_id": 54438046, "link": "https://stackoverflow.com/questions/54438046/deploying-golang-appengine-on-google-cloud-build-spawns-infinite-builds/56029308#56029308", "title": "Deploying Golang AppEngine on Google Cloud Build spawns infinite builds", "body": "<p>So this turned out to be an issue with how <code>Google Cloud Build</code> handles an encounter with the configuration file <code>cloudbuild.yaml</code>. It has to spawn a new build every time it sees one, regardless of whether it has already been seen.</p>\n\n<p>In my case, since the project was tiny, the <code>cloudbuild.yaml</code> and my go source were both at the root of the project. This lead to the following situation:</p>\n\n<ul>\n<li>The initial <code>git push</code> triggers a build, which reads <code>cloudbuild.yaml</code>.</li>\n<li>The build sees that there's a <code>cloudbuild.yaml</code> in the current working directory and spawns a new build for that.</li>\n</ul>\n\n<p>I suppose this is useful as you can have multiple build configs for various things in your projects, that will be built as and when encountered.</p>\n\n<p>Moving the go source to <code>src/</code> (away from the cloudbuild) fixed the issue.</p>\n\n<p><code>tl;dr</code> DON'T PUT YOUR <code>cloudbuild.yaml</code> IN THE WORKING DIRECTORY.</p>\n"}], "owner": {"reputation": 942, "user_id": 555297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/042af2127e5a00db66519681e1de46e9?s=128&d=identicon&r=PG", "display_name": "Prajjwal", "link": "https://stackoverflow.com/users/555297/prajjwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 391, "favorite_count": 2, "accepted_answer_id": 56029308, "answer_count": 3, "score": 5, "last_activity_date": 1557257281, "creation_date": 1548843105, "question_id": 54438046, "link": "https://stackoverflow.com/questions/54438046/deploying-golang-appengine-on-google-cloud-build-spawns-infinite-builds", "title": "Deploying Golang AppEngine on Google Cloud Build spawns infinite builds", "body": "<p>I'm trying to set up a Cloud Build pipeline to deploy a <code>golang</code> app to App Engine, but it appears to spawn infinite versions of itself and then times out.</p>\n\n<p>To start with, here's my configuration.</p>\n\n<pre><code>steps:\n- name: \"gcr.io/cloud-builders/go\"\n  args:\n    - get\n    - \"-u\"\n    - \"-d\"\n    - \"github.com/didip/tollbooth\"\n    - \"github.com/lib/pq\"\n    - \"github.com/stretchr/testify\"\n    - \"github.com/go-redis/redis\"\n    - \"cloud.google.com/go/pubsub\"\n  dir: \"/workspace\"\n  volumes:\n    - name: 'go'\n      path: '/gopath'\n  env:\n    - \"GOPATH=/gopath\"\n- name: \"gcr.io/cloud-builders/gcloud\"\n  args: [\"app\", \"deploy\", \"--stop-previous-version\"]\n  dir: \"/workspace\"\n  volumes:\n    - name: 'go'\n      path: '/gopath'\n  env:\n    - \"GOPATH=/gopath\"\n</code></pre>\n\n<p>Here's the relevant section of <code>app.yaml</code>:</p>\n\n<pre><code>service: \"myservice\"\nruntime: custom\nenv: flex\n</code></pre>\n\n<p>When I deploy to the branch I've configured it to watch, it starts the build just fine, and finishes step 0. Then it starts step 1, which is <code>gcloud app deploy</code>, which appears to recursively spawn yet another instance of the pipeline (see logs below). This continues until everything times out.</p>\n\n<p>Here's the beginning of the log (towards the end you'll see that it has recursively started step 0 inside step 1 again).</p>\n\n<pre><code>starting build \"e5ad47ed-5332-4bc7-b4ac-618e243f05a5\"\n\nFETCHSOURCE\nFetching storage object: gs://staging.myproject-event.appspot.com/asia.gcr.io/myproject-event/appengine/myservice.20190130t095428:latest#1548842070817530\nCopying gs://staging.myproject-event.appspot.com/asia.gcr.io/myproject-event/appengine/myservice.20190130t095428:latest#1548842070817530...\n/ [0 files][ 0.0 B/ 10.9 KiB] \n-\n- [1 files][ 10.9 KiB/ 10.9 KiB] \nOperation completed over 1 objects/10.9 KiB. \nBUILD\nStarting Step #0\nStep #0: Already have image (with digest): gcr.io/cloud-builders/go\nStep #0: Documentation at https://github.com/GoogleCloudPlatform/cloud-builders/blob/master/go/README.md\nStep #0: Running: go get -u -d github.com/didip/tollbooth github.com/lib/pq github.com/stretchr/testify github.com/go-redis/redis cloud.google.com/go/pubsub\nFinished Step #0\nStarting Step #1\nStep #1: Already have image (with digest): gcr.io/cloud-builders/gcloud\nStep #1: Services to deploy:\nStep #1: \nStep #1: descriptor: [/workspace/app.yaml]\nStep #1: source: [/workspace]\nStep #1: target project: [myproject-event]\nStep #1: target service: [myservice]\nStep #1: target version: [20190130t095546]\nStep #1: target url: [https://myservice-dot-myproject-event.appspot.com]\nStep #1: \nStep #1: \nStep #1: Do you want to continue (Y/n)? \nStep #1: WARNING: Unable to verify that the Appengine Flexible API is enabled for project [myproject-event]. You may not have permission to list enabled services on this project. If it is not enabled, this may cause problems in running your deployment. Please ask the project owner to ensure that the Appengine Flexible API has been enabled and that this account has permission to list enabled APIs.\nStep #1: Beginning deployment of service [myservice]...\nStep #1: Building and pushing image for service [myservice]\nStep #1: Started cloud build [b41069a6-2ef7-4eaf-8b49-de36bc620be2].\nStep #1: To see logs in the Cloud Console: https://console.cloud.google.com/gcr/builds/b41069a6-2ef7-4eaf-8b49-de36bc620be2?project=954549095871\nStep #1: ----------------------------- REMOTE BUILD OUTPUT ------------------------------\nStep #1: starting build \"b41069a6-2ef7-4eaf-8b49-de36bc620be2\"\nStep #1: \nStep #1: FETCHSOURCE\nStep #1: Fetching storage object: gs://staging.myproject-event.appspot.com/asia.gcr.io/myproject-event/appengine/myservice.20190130t095546:latest#1548842148386512\nStep #1: Copying gs://staging.myproject-event.appspot.com/asia.gcr.io/myproject-event/appengine/myservice.20190130t095546:latest#1548842148386512...\nStep #1: / [0 files][ 0.0 B/ 10.9 KiB] \n/ [0 files][ 10.9 KiB/ 10.9 KiB] \n-\n- [1 files][ 10.9 KiB/ 10.9 KiB] \nStep #1: Operation completed over 1 objects/10.9 KiB. \nStep #1: BUILD\nStep #1: Starting Step #0\nStep #1: Step #0: Already have image (with digest): gcr.io/cloud-builders/go\nStep #1: Step #0: Documentation at https://github.com/GoogleCloudPlatform/cloud-builders/blob/master/go/README.md\nStep #1: Step #0: Running: go get -u -d github.com/didip/tollbooth github.com/lib/pq github.com/stretchr/testify github.com/go-redis/redis cloud.google.com/go/pubsub\nStep #1: Finished Step #0\nStep #1: Starting Step #1\nStep #1: Step #1: Already have image (with digest): gcr.io/cloud-builders/gcloud\nStep #1: Step #1: Services to deploy:\n</code></pre>\n\n<p>This goes on until I manually kill the last build:</p>\n\n<pre><code>Step #1: Step #1: Step #1: Step #1: Step #1: Step #1: Copying gs://staging.solution360-event.appspot.com/asia.gcr.io/solution360-event/appengine/authproxy.20190130t100329:latest#1548842611410114...\nStep #1: Step #1: Step #1: Step #1: Step #1: Step #1: / [0 files][ 0.0 B/ 10.9 KiB] \n-\n- [1 files][ 10.9 KiB/ 10.9 KiB] \nStep #1: Step #1: Step #1: Step #1: Step #1: Step #1: Operation completed over 1 objects/10.9 KiB. \nStep #1: Step #1: Step #1: Step #1: Step #1: Step #1: BUILD\nStep #1: Step #1: Step #1: Step #1: Step #1: Step #1: Starting Step #0\nStep #1: Step #1: Step #1: Step #1: Step #1: Step #1: Step #0: Already have image (with digest): gcr.io/cloud-builders/go\nStep #1: Step #1: Step #1: Step #1: Step #1: Step #1: Step #0: Documentation at https://github.com/GoogleCloudPlatform/cloud-builders/blob/master/go/README.md\nStep #1: Step #1: Step #1: Step #1: Step #1: Step #1: Step #0: Running: go get -u -d github.com/didip/tollbooth github.com/lib/pq github.com/stretchr/testify github.com/go-redis/redis cloud.google.com/go/pubsub\n</code></pre>\n\n<p>What I've tried:</p>\n\n<ul>\n<li>Removing the \"--stop-previous-versions\" flag from the command.</li>\n<li>Mounting <code>gopath</code> in a different volume, in case that was causing gcloud to recursively descend into it.</li>\n<li>Running just step 1, same result.</li>\n</ul>\n\n<p>See attached screenshot of the actual builds spawning:\n<a href=\"https://i.stack.imgur.com/gnuo0.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/gnuo0.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["authentication", "go", "authorization", "jwt", "grpc"], "comments": [{"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 1, "creation_date": 1548843824, "post_id": 54437323, "comment_id": 95685893, "body": "maybe the architecture of <a href=\"https://github.com/go-kit/kit\" rel=\"nofollow noreferrer\">go-kit</a> can help you structure your service."}, {"owner": {"reputation": 6480, "user_id": 1267140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UOHte.jpg?s=128&g=1", "display_name": "Havelock", "link": "https://stackoverflow.com/users/1267140/havelock"}, "edited": false, "score": 1, "creation_date": 1548844034, "post_id": 54437323, "comment_id": 95686013, "body": "I&#39;ve seen something similar, where the boilerplate was put in a library, providing a wrapper function for the handler func. Then there was a policy system of a sort, that every endpoint defines the permission required, which permissions were mapped to a role (based on the identity claim from the JWT)."}, {"owner": {"reputation": 1317, "user_id": 7565450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qgWFA.jpg?s=128&g=1", "display_name": "Varcorb", "link": "https://stackoverflow.com/users/7565450/varcorb"}, "edited": false, "score": 0, "creation_date": 1548887921, "post_id": 54437323, "comment_id": 95709880, "body": "If you are protecting every call then yes use a <code>UnaryInterceptor</code>. I can provide an example if you need one that would work"}, {"owner": {"reputation": 2886, "user_id": 2219213, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/BW004.jpg?s=128&g=1", "display_name": "Sergii Getman", "link": "https://stackoverflow.com/users/2219213/sergii-getman"}, "reply_to_user": {"reputation": 1317, "user_id": 7565450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qgWFA.jpg?s=128&g=1", "display_name": "Varcorb", "link": "https://stackoverflow.com/users/7565450/varcorb"}, "edited": false, "score": 0, "creation_date": 1548933351, "post_id": 54437323, "comment_id": 95726502, "body": "@Varcorb if you can publish it would be nice"}, {"owner": {"reputation": 576, "user_id": 7371810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53dfe10f0150e2213e244ef1b93ccde?s=128&d=identicon&r=PG&f=1", "display_name": "menghanl", "link": "https://stackoverflow.com/users/7371810/menghanl"}, "edited": false, "score": 0, "creation_date": 1549317454, "post_id": 54437323, "comment_id": 95852276, "body": "There&#39;s an oauth example here that might help: <a href=\"https://github.com/grpc/grpc-go/tree/master/examples/features/authentication\" rel=\"nofollow noreferrer\">github.com/grpc/grpc-go/tree/master/examples/features/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2886, "user_id": 2219213, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/BW004.jpg?s=128&g=1", "display_name": "Sergii Getman", "link": "https://stackoverflow.com/users/2219213/sergii-getman"}, "edited": false, "score": 1, "creation_date": 1549371886, "post_id": 54485144, "comment_id": 95871658, "body": "Thanks, I do pretty much the same in my interceptor. But I am looking for a more advanced approach then just check is there <code>jwt</code> or not. I am looking for some kind of authorization: is that user allowed go to that method"}, {"owner": {"reputation": 2174, "user_id": 2712644, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qbg3j.jpg?s=128&g=1", "display_name": "domoarigato", "link": "https://stackoverflow.com/users/2712644/domoarigato"}, "reply_to_user": {"reputation": 2886, "user_id": 2219213, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/BW004.jpg?s=128&g=1", "display_name": "Sergii Getman", "link": "https://stackoverflow.com/users/2219213/sergii-getman"}, "edited": false, "score": 0, "creation_date": 1558433049, "post_id": 54485144, "comment_id": 99090539, "body": "@SergiiGetman - his answer ignores the <code>*grpc.UnaryServerInfo</code> which get&#39;s passed into the function, but it contains information which I think would be useful for your purposes.  for example, it has a .FullMethod property which would allow you perform different authorization logic per method."}], "tags": [], "owner": {"reputation": 1317, "user_id": 7565450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qgWFA.jpg?s=128&g=1", "display_name": "Varcorb", "link": "https://stackoverflow.com/users/7565450/varcorb"}, "is_accepted": false, "score": 2, "last_activity_date": 1549045731, "last_edit_date": 1549045731, "creation_date": 1549045385, "answer_id": 54485144, "question_id": 54437323, "link": "https://stackoverflow.com/questions/54437323/grpc-authorization-approach/54485144#54485144", "title": "gRPC authorization approach", "body": "<p>You can call a to a <code>UnaryInterceptor</code> like so if you want to verify the jwt on every request</p>\n\n<pre><code>// middleware for each rpc request. This function verifies the client has the correct \"jwt\".\nfunc authInterceptor(ctx context.Context, req interface{}, _ *grpc.UnaryServerInfo, handler grpc.UnaryHandler) (interface{}, error) {\n    meta, ok := metadata.FromIncomingContext(ctx)\n    if !ok {\n        return nil, status.Error(codes.Unauthenticated, \"INTERNAL_SERVER_ERROR\")\n    }\n    if len(meta[\"jwt\"]) != 1 {\n        return nil, status.Error(codes.Unauthenticated, \"INTERNAL_SERVER_ERROR\")\n    }\n\n    // if code here to verify jwt is correct. if not return nil and error by accessing meta[\"jwt\"][0]\n\n    return handler(ctx, req) // go to function.\n}\n</code></pre>\n\n<p>In your <code>context</code> from the client use the <a href=\"https://godoc.org/google.golang.org/grpc/metadata\" rel=\"nofollow noreferrer\">metadata</a> to pass the <code>jwt</code> string and verify. </p>\n\n<p>In Your main function remember to register it like so</p>\n\n<pre><code>// register server\nmyService := grpc.NewServer(\n    grpc.UnaryInterceptor(authInterceptor), // use auth interceptor middleware\n)\npb.RegisterTheServiceServer(myService, &amp;s)\nreflection.Register(myService)\n</code></pre>\n\n<p>Your client would need to call your server like this:</p>\n\n<pre><code>// create context with token and timeout\nctx, cancel := context.WithTimeout(metadata.NewOutgoingContext(context.Background(), metadata.New(map[string]string{\"jwt\": \"myjwtstring\"})), time.Second*1)\ndefer cancel()\n</code></pre>\n"}], "owner": {"reputation": 2886, "user_id": 2219213, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/BW004.jpg?s=128&g=1", "display_name": "Sergii Getman", "link": "https://stackoverflow.com/users/2219213/sergii-getman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4795, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1549045731, "creation_date": 1548840865, "question_id": 54437323, "link": "https://stackoverflow.com/questions/54437323/grpc-authorization-approach", "title": "gRPC authorization approach", "body": "<p>I work on go grpc service and implementing authorization. Literally, have to allow or forbid access to gprc methods base on JWT claims.</p>\n\n<p>I do JWT parsing on <code>grpc.UnaryServerInterceptor</code> level - extracting claims and populate context with value, unauthenticated if there is no jwt or it is incorrect.</p>\n\n<pre><code>func (s *Server) GetSomething(ctx context.Context, req *GetSomething Request) (*GetSomething Response, error) {\n    if hasAccessTo(ctx, req.ID) {\n        //some work here\n    }\n}\n\nfunc hasAccessTo(ctx context.Context, string id) {\n    value := ctx.Value(ctxKey).(MyStruct)\n    //some work here\n\n}\n</code></pre>\n\n<p>So I wonder if there is some common practice for authorization/authentication to avoid boilerplate code in each grpc server method?</p>\n"}, {"tags": ["go", "google-cloud-vision"], "comments": [{"owner": {"reputation": 1422, "user_id": 9673730, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sM6Gw.png?s=128&g=1", "display_name": "Mark.F", "link": "https://stackoverflow.com/users/9673730/mark-f"}, "edited": false, "score": 0, "creation_date": 1548840130, "post_id": 54437027, "comment_id": 95683606, "body": "You need to add more info.."}, {"owner": {"reputation": 1, "user_id": 10989233, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tGKyRGxHb3M/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPR0PQxgax7u9KIRRgqDQRb8cysmw/mo/photo.jpg?sz=128", "display_name": "John Doe", "link": "https://stackoverflow.com/users/10989233/john-doe"}, "reply_to_user": {"reputation": 1422, "user_id": 9673730, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sM6Gw.png?s=128&g=1", "display_name": "Mark.F", "link": "https://stackoverflow.com/users/9673730/mark-f"}, "edited": false, "score": 0, "creation_date": 1548852214, "post_id": 54437027, "comment_id": 95690844, "body": "Hi Mark, locally(App) when I run an image to detect text, The results are like &quot;Government of USA&quot;, when The same code deployed to google cloud, the result with the same is &quot;vernment of US4&quot;. I am using golang vision to make Text detection request"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10989233, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tGKyRGxHb3M/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPR0PQxgax7u9KIRRgqDQRb8cysmw/mo/photo.jpg?sz=128", "display_name": "John Doe", "link": "https://stackoverflow.com/users/10989233/john-doe"}, "edited": false, "score": 0, "creation_date": 1548867823, "post_id": 54438042, "comment_id": 95700817, "body": "Hi Andrei, locally(App) when I run an image to detect text, The results are like &quot;Government of USA&quot;, when The same code deployed to google cloud, the result with the same is &quot;vernment of US4&quot;. I am using golang vision/v1 package to make Text detection request"}, {"owner": {"reputation": 2417, "user_id": 4037220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JYTuqJ0lf0w/AAAAAAAAAAI/AAAAAAAAAEw/irO6eSzV15Q/photo.jpg?sz=128", "display_name": "Andrei Cusnir", "link": "https://stackoverflow.com/users/4037220/andrei-cusnir"}, "reply_to_user": {"reputation": 1, "user_id": 10989233, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tGKyRGxHb3M/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPR0PQxgax7u9KIRRgqDQRb8cysmw/mo/photo.jpg?sz=128", "display_name": "John Doe", "link": "https://stackoverflow.com/users/10989233/john-doe"}, "edited": false, "score": 0, "creation_date": 1548922512, "post_id": 54438042, "comment_id": 95720118, "body": "It seems that the library you are using has been <code>DEPRECATED</code>. Check the <a href=\"https://godoc.org/google.golang.org/api/vision/v1\" rel=\"nofollow noreferrer\">package vision</a> for more information. It is suggested to use the new package <code>cloud.google.com&#47;go&#47;vision&#47;apiv1</code> instead. It might be the reason you see different result in the Google Cloud."}], "tags": [], "owner": {"reputation": 2417, "user_id": 4037220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JYTuqJ0lf0w/AAAAAAAAAAI/AAAAAAAAAEw/irO6eSzV15Q/photo.jpg?sz=128", "display_name": "Andrei Cusnir", "link": "https://stackoverflow.com/users/4037220/andrei-cusnir"}, "is_accepted": false, "score": 1, "last_activity_date": 1548843098, "creation_date": 1548843098, "answer_id": 54438042, "question_id": 54437027, "link": "https://stackoverflow.com/questions/54437027/google-text-detection-api-is-giving-different-response-for-same-image-from-local/54438042#54438042", "title": "Google Text Detection API is giving different response for same image from local and cloud", "body": "<p>There could be an issue with the way you import the image or with the way you authenticated the access to the Vision API. Follow this tutorial provided by Google on <a href=\"https://codelabs.developers.google.com/codelabs/cloud-vision-api-python/index.html?index=..%2F..index#0\" rel=\"nofollow noreferrer\">Using the Vision API with Python</a> to get the idea of how to use the Google Cloud API and test your image there to see if there is any difference. </p>\n\n<p>Other than that, Mark. F is right, this question needs more explanation, so we could understand and replicate the issue.   </p>\n"}], "owner": {"reputation": 1, "user_id": 10989233, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tGKyRGxHb3M/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPR0PQxgax7u9KIRRgqDQRb8cysmw/mo/photo.jpg?sz=128", "display_name": "John Doe", "link": "https://stackoverflow.com/users/10989233/john-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548843098, "creation_date": 1548839748, "question_id": 54437027, "link": "https://stackoverflow.com/questions/54437027/google-text-detection-api-is-giving-different-response-for-same-image-from-local", "title": "Google Text Detection API is giving different response for same image from local and cloud", "body": "<p>I am using google text detection api, while running text detection from local machine I am getting good results while it runs through staging environment from cloud it gives bad responses, so the significant mismatch is coming in the results. Is it a GCV bug, please help me find the solution.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1548839979, "post_id": 54437026, "comment_id": 95683498, "body": "Shouldn&#39;t the desired output be <code>John Thank you.</code> ?"}, {"owner": {"reputation": 169, "user_id": 10949215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15d8162f22e0674a0766e6cc1fcf0983?s=128&d=identicon&r=PG&f=1", "display_name": "sam smith", "link": "https://stackoverflow.com/users/10949215/sam-smith"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1548840007, "post_id": 54437026, "comment_id": 95683514, "body": "@icza Shouldn&#39;t."}], "answers": [{"tags": [], "owner": {"reputation": 191, "user_id": 9870721, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Eitam Ring", "link": "https://stackoverflow.com/users/9870721/eitam-ring"}, "is_accepted": true, "score": 2, "last_activity_date": 1548840981, "last_edit_date": 1548840981, "creation_date": 1548840082, "answer_id": 54437128, "question_id": 54437026, "link": "https://stackoverflow.com/questions/54437026/what-is-the-best-way-to-clean-string-from-html-tags/54437128#54437128", "title": "What is the best way to clean string from html tags", "body": "<p>Best way to slice the string is to search for a specif string, \n(at your case <code>\"&lt;/b&gt;\"</code>) and separate him to a different string.</p>\n\n<p>Example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    html := \"&lt;b&gt;John&lt;/b&gt; Thank you.\"\n    fmt.Println(html)\n    thanks := strings.Split(html, \"&lt;/b&gt;\")[1]\n    fmt.Println(thanks)\n}\n</code></pre>\n\n<p>Result:  Thank you.</p>\n\n<p>Play ground link:<a href=\"https://play.golang.org/p/yOc3G0YeNTe\" rel=\"nofollow noreferrer\">https://play.golang.org/p/yOc3G0YeNTe</a></p>\n\n<p>Also please consider <code>TrimSpace</code> to prevent unnecessary spacing</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    html := \"&lt;b&gt;John&lt;/b&gt; Thank you.\"\n    fmt.Println(html)\n    thanks := strings.Split(html, \"&lt;/b&gt;\")[1]\n    fmt.Println(thanks)\n    cleanThanks := strings.TrimSpace(thanks)\n    fmt.Println(cleanThanks)\n}\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code> Thank you.\n\nThank you.\n</code></pre>\n\n<p>Play ground link:<a href=\"https://play.golang.org/p/S7BRM7jOvtL\" rel=\"nofollow noreferrer\">https://play.golang.org/p/S7BRM7jOvtL</a></p>\n\n<p><strong>Please note that you should verify the string contain <code>\"&lt;/b&gt;\"</code> if not you will get panic: runtime error: index out of range</strong></p>\n"}, {"comments": [{"owner": {"reputation": 191, "user_id": 9870721, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Eitam Ring", "link": "https://stackoverflow.com/users/9870721/eitam-ring"}, "edited": false, "score": 1, "creation_date": 1548842304, "post_id": 54437679, "comment_id": 95684918, "body": "I agree using Regular Expressions isn&#39;t recommended , Great note, but sometimes you cannot avoid it , just important to remember to verify the string before trying to slice him."}], "tags": [], "owner": {"reputation": 810, "user_id": 10989396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4caa8f53ec0ebff61132b4cb58539467?s=128&d=identicon&r=PG&f=1", "display_name": "hyperTrashPanda", "link": "https://stackoverflow.com/users/10989396/hypertrashpanda"}, "is_accepted": false, "score": 4, "last_activity_date": 1548841953, "creation_date": 1548841953, "answer_id": 54437679, "question_id": 54437026, "link": "https://stackoverflow.com/questions/54437026/what-is-the-best-way-to-clean-string-from-html-tags/54437679#54437679", "title": "What is the best way to clean string from html tags", "body": "<p>First of all, please resist using Regular Expressions. Bad things <a href=\"https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454\">can happen</a> .</p>\n\n<p>On a more serious note, if you <em>can't trust</em> the HTML content, I suggest using something like <a href=\"https://github.com/microcosm-cc/bluemonday\" rel=\"nofollow noreferrer\">bluemonday</a>, which is currently what you could be using in production.</p>\n\n<p>For a simpler approach, to get something working quickly you could use either another library such as <a href=\"https://github.com/grokify/html-strip-tags-go\" rel=\"nofollow noreferrer\">grokify/html-strip-tags-go</a> which will suit your needs, or as in Eitam's answer roll your own by splitting the strings.</p>\n\n<p>Best of luck!</p>\n"}], "owner": {"reputation": 169, "user_id": 10949215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15d8162f22e0674a0766e6cc1fcf0983?s=128&d=identicon&r=PG&f=1", "display_name": "sam smith", "link": "https://stackoverflow.com/users/10949215/sam-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 54437128, "answer_count": 2, "score": -2, "last_activity_date": 1548841953, "creation_date": 1548839747, "question_id": 54437026, "link": "https://stackoverflow.com/questions/54437026/what-is-the-best-way-to-clean-string-from-html-tags", "title": "What is the best way to clean string from html tags", "body": "<p>There is a string, for instance.\nWhat is the best way to clean the string from <code>html</code> content?</p>\n\n<pre><code>s := \"&lt;b&gt;John&lt;/b&gt; Thank you.\"\n</code></pre>\n\n<p>The result should be <code>Thank you.</code></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1548835072, "post_id": 54435454, "comment_id": 95680806, "body": "<code>database&#47;sql</code> is not an ORM, what you&#39;re trying achieve with <code>SELECT * FROM ...</code> and <code>rows.Scan(&amp;model)</code> is not possible. Google for &quot;golang orm&quot; to find the package that will help you, <code>database&#47;sql</code> is not the one."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1548850323, "post_id": 54435454, "comment_id": 95689802, "body": "This code is vulnerable to SQL injections. Don&#39;t execute the query without checking that <code>db_name</code> has one of the expected values."}], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 3, "last_activity_date": 1548834246, "creation_date": 1548834246, "answer_id": 54435538, "question_id": 54435454, "link": "https://stackoverflow.com/questions/54435454/how-to-make-function-that-takes-string-argument-and-depending-on-that-returns-d/54435538#54435538", "title": "How to make function that takes string argument, and depending on that returns different struct types?", "body": "<p>You can't do that.  But you have two options:</p>\n\n<ol>\n<li><p>Return an <code>interface{}</code>, as you are doing, then convert to a concrete type. This probably defeats your purpose.</p></li>\n<li><p>Pass in your destination as a pointer, and modify it in place.  So something like:</p>\n\n<pre><code>func GetArrayOfModelStructs(table_name string, dst interface{}) error {\n</code></pre>\n\n<p>Then have your function put the value in <code>dst</code>.  This does require that the value passed as <code>dst</code> is a pointer.  This is a very common pattern, seen in <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\"><code>json.Unmarshal()</code></a>, in <a href=\"https://golang.org/pkg/database/sql/#Rows.Scan\" rel=\"nofollow noreferrer\"><code>sql</code>'s <code>Rows.Scan</code></a>, and many other places in the standard library and elsewhere.</p></li>\n</ol>\n"}], "owner": {"reputation": 78, "user_id": 8950009, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-z-FJw8PQ8AU/AAAAAAAAAAI/AAAAAAAAADY/YwbcPWTdLPI/photo.jpg?sz=128", "display_name": "Gaziz Zhaiyk", "link": "https://stackoverflow.com/users/8950009/gaziz-zhaiyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 54435538, "answer_count": 1, "score": 0, "last_activity_date": 1548834246, "creation_date": 1548833869, "question_id": 54435454, "link": "https://stackoverflow.com/questions/54435454/how-to-make-function-that-takes-string-argument-and-depending-on-that-returns-d", "title": "How to make function that takes string argument, and depending on that returns different struct types?", "body": "<p>I want to create a function that takes string argument, and depending of string returns different types</p>\n\n<p>In my current project I am using Go version 1.11.4 for Rest API, PostgreSQL 11 for storing data.\nThe function is for avoiding the code redundancy, I just need one function for handling the requests, whithout this function I would be write more many request handlers.</p>\n\n<p>Functions is:</p>\n\n<pre><code>func GetArrayOfModelStructs(table_name string) interface{} {\n    if table_name == \"prefs_n_cities\" {\n        Prefs_n_cities_array := &amp;models.Prefs_n_cities_array{}\n        return Prefs_n_cities_array\n    } else if table_name == \"position_owner\" {\n        Position_owners := &amp;models.Position_owners{}\n        return Position_owners\n    } else if table_name == \"region\" {\n        Regions := &amp;models.Regions{}\n        return Regions\n    } else if table_name == \"district\" {\n        Districts := &amp;models.Districts{}\n        return Districts\n    } else if table_name == \"locality\" {\n        Localities := &amp;models.Localities{}\n        return Localities\n    } else if table_name == \"locality_type\" {\n        Locality_types := &amp;models.Locality_types{}\n        return Locality_types\n    } else if table_name == \"population\" {\n        Populations := &amp;models.Populations{}\n        return Populations\n    }\n    return nil\n}\n</code></pre>\n\n<pre><code>func GetModelStructs(table_name string) interface{} {\n    if table_name == \"prefs_n_cities\" {\n        return models.Prefs_n_cities{}\n    } else if table_name == \"position_owner\" {\n        return models.Position_owner{}\n    } else if table_name == \"region\" {\n        return models.Regions{}\n    } else if table_name == \"district\" {\n        return models.District{}\n    } else if table_name == \"locality\" {\n        return models.Locality{}\n    } else if table_name == \"locality_type\" {\n        return models.Locality_type{}\n    } else if table_name == \"population\" {\n        return models.Population{}\n    }\n    return nil\n}\n</code></pre>\n\n<p>My structs example like:</p>\n\n<pre><code>type Prefs_n_cities struct {\n    id          int32\n    Name        string\n    Description string\n    Region_id   int32\n}\n\ntype Prefs_n_cities_array struct {\n    Array []Prefs_n_cities\n}\n</code></pre>\n\n<p>And all of this I trying to use in another package for handling requests:</p>\n\n<pre><code>var GetData = func(res http.ResponseWriter, req *http.Request) {\n    // u.Logging(req, false)\n    db_name := req.URL.Query().Get(\"table_name\")\n\n    data := u.GetArrayOfModelStructs(db_name)\n\n    spew.Dump(data)\n\n    sqlString := `SELECT * FROM \"new_rollout_managment\".` + db_name\n\n    rows, err := database.DB.Query(sqlString)\n    if err != nil {\n        http.Error(res, err.Error(), 400)\n        return\n    }\n    defer rows.Close()\n\n    for rows.Next() {\n        model := u.GetModelStructs(db_name)\n        err = rows.Scan(&amp;model)\n        if err != nil {\n            http.Error(res, err.Error(), 400)\n            return\n        }\n        data.Array = append(data.Array, model)\n    }\n    err = rows.Err()\n    if err != nil {\n        http.Error(res, err.Error(), 400)\n        return\n    }\n\n    out, err := json.Marshal(models)\n    if err != nil {\n        http.Error(res, err.Error(), 500)\n        return\n    }\n\n    resp := u.Message(true, \"Array of dictionaries\")\n    resp[\"Dictionaries\"] = out\n\n    u.Respond(res, resp)\n}\n</code></pre>\n\n<p>My router is: </p>\n\n<pre><code>func Use(router *mux.Router) {\n\n    router.HandleFunc(\"/api/test/new\", controllers.TestFunc).Methods(\"POST\")\n    router.HandleFunc(\"/api/dictionaries/getdata\", controllers.GetData).Methods(\"GET\")\n}\n</code></pre>\n\n<p>But in the GetData handler I have an error:</p>\n\n<pre><code>data.Array undefined (type interface {} is interface with no methods)\n</code></pre>\n"}, {"tags": ["linux", "macos", "shell", "go"], "comments": [{"owner": {"reputation": 6996, "user_id": 2210442, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/D0uB0.jpg?s=128&g=1", "display_name": "TechChain", "link": "https://stackoverflow.com/users/2210442/techchain"}, "edited": false, "score": 0, "creation_date": 1548848895, "post_id": 54435099, "comment_id": 95688976, "body": "I ran into this issue because my go code was using Sqlite3. For a sqlite supported build to run CGO_ENABLED should not be zero. I did not find the solution to this problem but I created a separated build for Mac only &amp; that build is running successfully."}], "answers": [{"comments": [{"owner": {"reputation": 804, "user_id": 880963, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/edacc2ea1717765faf2ab392116b7182?s=128&d=identicon&r=PG", "display_name": "krish7919", "link": "https://stackoverflow.com/users/880963/krish7919"}, "edited": false, "score": 0, "creation_date": 1549311859, "post_id": 54449932, "comment_id": 95850030, "body": "Can you educate on what is the C cross compiler here for compiling binaries targeted for Mac from Alpine ?"}], "tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": false, "score": 0, "last_activity_date": 1548884240, "creation_date": 1548884240, "answer_id": 54449932, "question_id": 54435099, "link": "https://stackoverflow.com/questions/54435099/issue-while-creating-go-build-for-mac-from-linux/54449932#54449932", "title": "issue while creating go build for Mac from linux?", "body": "<p>If you're going to cross-compile for <code>darwin</code> on <code>linux</code> and you're using <code>CGO_ENABLED=1</code>, then you'll need a <code>C</code> cross compiler also.</p>\n\n<p><a href=\"https://github.com/golang/go/issues/22510#issuecomment-340938955\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/22510#issuecomment-340938955</a></p>\n"}], "owner": {"reputation": 6996, "user_id": 2210442, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/D0uB0.jpg?s=128&g=1", "display_name": "TechChain", "link": "https://stackoverflow.com/users/2210442/techchain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 665, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1548884240, "creation_date": 1548832403, "question_id": 54435099, "link": "https://stackoverflow.com/questions/54435099/issue-while-creating-go-build-for-mac-from-linux", "title": "issue while creating go build for Mac from linux?", "body": "<p>I am trying to create a build for Mac from linux machine. I am able to do this by below common without enabling CGO.</p>\n\n<pre><code>env GOOS=darwin GOARCH=amd64 go build\n</code></pre>\n\n<p>Using CGO enabled command </p>\n\n<pre><code>env CGO_ENABLED=1 GOOS=darwin GOARCH=amd64 go build\n</code></pre>\n\n<p>But if I enable CGO then it does not work and get below error</p>\n\n<pre><code># os/user\n/usr/local/go/src/os/user/getgrouplist_darwin.go: In function 'mygetgrouplist':\n/usr/local/go/src/os/user/getgrouplist_darwin.go:16:11: warning: implicit declaration of function 'getgrouplist' [-Wimplicit-function-declaration]\n  int rv = getgrouplist(user, (int) group, buf, ngroups);\n           ^\n# net\n/usr/local/go/src/net/cgo_bsd.go:15:72: could not determine kind of name for C.AI_MASK\n# ConfigTool/Go/vendor/github.com/mattn/go-sqlite3\n/tmp/go-build769992187/b129/_x011.o: In function `unixDlError':\nvendor/github.com/mattn/go-sqlite3/sqlite3-binding.c:38475: undefined reference to `dlerror'\n/tmp/go-build769992187/b129/_x011.o: In function `unixDlClose':\nvendor/github.com/mattn/go-sqlite3/sqlite3-binding.c:38506: undefined reference to `dlclose'\n/tmp/go-build769992187/b129/_x011.o: In function `unixDlSym':\nvendor/github.com/mattn/go-sqlite3/sqlite3-binding.c:38502: undefined reference to `dlsym'\n/tmp/go-build769992187/b129/_x011.o: In function `unixDlOpen':\nvendor/github.com/mattn/go-sqlite3/sqlite3-binding.c:38461: undefined reference to `dlopen'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1548830581, "post_id": 54434314, "comment_id": 95678647, "body": "Note that in Go it&#39;s not possible to declare methods on imported types, you can declare methods on a type only in the same package in which the type is declared. This <code>func (c echo.Context) GetUsers() error</code> will never even compile."}], "tags": [], "owner": {"reputation": 8470, "user_id": 538866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb67b45ca1dc2584f8e4d703d009177b?s=128&d=identicon&r=PG", "display_name": "Jonas G. Drange", "link": "https://stackoverflow.com/users/538866/jonas-g-drange"}, "is_accepted": true, "score": 3, "last_activity_date": 1548831930, "last_edit_date": 1548831930, "creation_date": 1548828706, "answer_id": 54434314, "question_id": 54434188, "link": "https://stackoverflow.com/questions/54434188/how-to-call-another-function-in-go/54434314#54434314", "title": "How to call another function in go?", "body": "<p>You can call it from <code>Insert</code> simply using <code>GetUsers</code>.</p>\n\n<pre><code>func Insert(c echo.Context) error{\n    models.Insert()\n    return GetUsers(c)\n}\n</code></pre>\n\n<hr>\n\n<p>The syntax you used, <code>c.GetUsers()</code> requires <code>GetUsers</code> to be a method declared with <code>Context</code> as its receiver type\u2014in the <code>echo</code> package\u2014a like so:</p>\n\n<pre><code>// package echo\nfunc (c Context) GetUsers() error {\n    \u2026\n}\n\n// package other\nfunc Insert(c echo.Context) error{\n    models.Insert()\n    return c.GetUsers()\n}\n</code></pre>\n\n<p>But I am going to assume this is not what you want, since a <code>Context</code> idiomatically should not contain users.</p>\n"}], "owner": {"reputation": 11, "user_id": 10988007, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DDu8KBVffao/AAAAAAAAAAI/AAAAAAAAACw/MiWm2VGAn4M/photo.jpg?sz=128", "display_name": "hugo iman", "link": "https://stackoverflow.com/users/10988007/hugo-iman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 54434314, "answer_count": 1, "score": -4, "last_activity_date": 1548831930, "creation_date": 1548828087, "question_id": 54434188, "link": "https://stackoverflow.com/questions/54434188/how-to-call-another-function-in-go", "title": "How to call another function in go?", "body": "<p>i want to call GetUsers from Insert function, but i don't know.</p>\n\n<pre><code>func GetUsers(c echo.Context) error{\n  result := models.GetUsers()\n  return c.Render(http.StatusOK, \"users.html\", result)\n}\n\nfunc Insert(c echo.Context) error{\n  models.Insert()\n  return c.GetUsers()\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 551, "user_id": 10554768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0874152f77551e2be38904d25e5822e?s=128&d=identicon&r=PG&f=1", "display_name": "robert", "link": "https://stackoverflow.com/users/10554768/robert"}, "edited": false, "score": 0, "creation_date": 1548821289, "post_id": 54433114, "comment_id": 95675952, "body": "There is no &quot;-&quot; behind uintptr, do you mean &quot;+&quot; or do you mean the &quot;-&quot; that shows up later (-int(unsafe.Size.....)"}, {"owner": {"reputation": 3, "user_id": 10988079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3512ddd2f2ea420c858d07f696acc44?s=128&d=identicon&r=PG&f=1", "display_name": "yingjun", "link": "https://stackoverflow.com/users/10988079/yingjun"}, "reply_to_user": {"reputation": 551, "user_id": 10554768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0874152f77551e2be38904d25e5822e?s=128&d=identicon&r=PG&f=1", "display_name": "robert", "link": "https://stackoverflow.com/users/10554768/robert"}, "edited": false, "score": 0, "creation_date": 1548827543, "post_id": 54433114, "comment_id": 95677537, "body": "@robert, thanks. I mean the &quot;-&quot; that shows up later (-int(unsafe.Size.....)"}], "answers": [{"tags": [], "owner": {"reputation": 2292, "user_id": 767903, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7ae9acb5bf16896b78a9708403da20ca?s=128&d=identicon&r=PG", "display_name": "Andrew W. Phillips", "link": "https://stackoverflow.com/users/767903/andrew-w-phillips"}, "is_accepted": true, "score": 0, "last_activity_date": 1548834562, "creation_date": 1548834562, "answer_id": 54435620, "question_id": 54433114, "link": "https://stackoverflow.com/questions/54433114/what-is-hchansize-means-in-chan-go/54435620#54435620", "title": "What is &quot;hchanSize&quot; means in chan.go", "body": "<p>The \"-\" is the minus sign. It performs the unary negation of the size of the hchanSize structure.  The whole expression is doing a bit of bit manipulation to round the size up to the next larger multiple of 8.</p>\n\n<p>I'm not sure why you want to know this but if you understand bits operations like &amp; and 2's-complement arithmetic you can work through it with different values. Eg try using 9 in place of unsafe.Sizeof(hchan) and see that it rounds up to 16.</p>\n"}], "owner": {"reputation": 3, "user_id": 10988079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3512ddd2f2ea420c858d07f696acc44?s=128&d=identicon&r=PG&f=1", "display_name": "yingjun", "link": "https://stackoverflow.com/users/10988079/yingjun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 54435620, "answer_count": 1, "score": 0, "last_activity_date": 1548834562, "creation_date": 1548820295, "question_id": 54433114, "link": "https://stackoverflow.com/questions/54433114/what-is-hchansize-means-in-chan-go", "title": "What is &quot;hchanSize&quot; means in chan.go", "body": "<p>I am reading the code about go runtime. In chan.go, \nI can't understand this.</p>\n\n<pre><code>const (\n    maxAlign  = 8\n    hchanSize = unsafe.Sizeof(hchan{}) + uintptr(-int(unsafe.Sizeof(hchan{}))&amp;(maxAlign-1))\n)\n</code></pre>\n\n<p>what is the \"-\"  behand the \"uintptr\" means?\nThanks.</p>\n"}, {"tags": ["mysql", "rest", "go", "http-post", "mux"], "comments": [{"owner": {"reputation": 1948, "user_id": 8690313, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-hQ93tpA6Lmk/AAAAAAAAAAI/AAAAAAAAB2I/7F3CoNnnhts/photo.jpg?sz=128", "display_name": "Prajval M", "link": "https://stackoverflow.com/users/8690313/prajval-m"}, "edited": false, "score": 0, "creation_date": 1549165964, "post_id": 54432854, "comment_id": 95804421, "body": "Basically you want to insert any data incoming data into a table without creating the structure ?"}, {"owner": {"reputation": 171, "user_id": 5259101, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1e8db9739f9d98012a2d0ba1801b4a99?s=128&d=identicon&r=PG&f=1", "display_name": "Shambhu", "link": "https://stackoverflow.com/users/5259101/shambhu"}, "reply_to_user": {"reputation": 1948, "user_id": 8690313, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-hQ93tpA6Lmk/AAAAAAAAAAI/AAAAAAAAB2I/7F3CoNnnhts/photo.jpg?sz=128", "display_name": "Prajval M", "link": "https://stackoverflow.com/users/8690313/prajval-m"}, "edited": false, "score": 0, "creation_date": 1549206536, "post_id": 54432854, "comment_id": 95812245, "body": "Exactly. The Json params come through request body and the table name through url params. The keys of JSON obj are the columns of table. Now I&#39;m not sure, how to insert these data in the table."}, {"owner": {"reputation": 1948, "user_id": 8690313, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-hQ93tpA6Lmk/AAAAAAAAAAI/AAAAAAAAB2I/7F3CoNnnhts/photo.jpg?sz=128", "display_name": "Prajval M", "link": "https://stackoverflow.com/users/8690313/prajval-m"}, "edited": false, "score": 0, "creation_date": 1549291272, "post_id": 54432854, "comment_id": 95839752, "body": "You can do it but it will not be secure"}, {"owner": {"reputation": 1948, "user_id": 8690313, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-hQ93tpA6Lmk/AAAAAAAAAAI/AAAAAAAAB2I/7F3CoNnnhts/photo.jpg?sz=128", "display_name": "Prajval M", "link": "https://stackoverflow.com/users/8690313/prajval-m"}, "edited": false, "score": 0, "creation_date": 1549291310, "post_id": 54432854, "comment_id": 95839776, "body": "It&#39;s always better to know the information before adding it into your database"}], "answers": [{"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1548833459, "post_id": 54432944, "comment_id": 95680053, "body": "There&#39;s no reason to use an ORM if all you need is query building. (In fact, there&#39;s no reason to use an ORM ever... but that&#39;s just my opinion)"}, {"owner": {"reputation": 171, "user_id": 5259101, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1e8db9739f9d98012a2d0ba1801b4a99?s=128&d=identicon&r=PG&f=1", "display_name": "Shambhu", "link": "https://stackoverflow.com/users/5259101/shambhu"}, "edited": false, "score": 0, "creation_date": 1548866499, "post_id": 54432944, "comment_id": 95700051, "body": "@Oswin But the ORM also has the mechanism of struct. I&#39;m looking for the solution of creating struct dynamically based on the <code>request.Body()</code>. If it can be done using ORM, then can you pls share any example to me. Thanks"}, {"owner": {"reputation": 171, "user_id": 5259101, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1e8db9739f9d98012a2d0ba1801b4a99?s=128&d=identicon&r=PG&f=1", "display_name": "Shambhu", "link": "https://stackoverflow.com/users/5259101/shambhu"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1548866587, "post_id": 54432944, "comment_id": 95700100, "body": "@Flimzy, If the ORM can&#39;t be used, then can you pls tell me, how can I achieve this?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1548872125, "post_id": 54432944, "comment_id": 95702978, "body": "I didn&#39;t say an ORM can&#39;t be used. I said an ORM isn&#39;t necessary."}, {"owner": {"reputation": 6967, "user_id": 7803650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WH7uu.png?s=128&g=1", "display_name": "Oswin Noetzelmann", "link": "https://stackoverflow.com/users/7803650/oswin-noetzelmann"}, "edited": false, "score": 0, "creation_date": 1548884838, "post_id": 54432944, "comment_id": 95708809, "body": "I added a description on how to create a generic function for what you want to do."}, {"owner": {"reputation": 6967, "user_id": 7803650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WH7uu.png?s=128&g=1", "display_name": "Oswin Noetzelmann", "link": "https://stackoverflow.com/users/7803650/oswin-noetzelmann"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1548885172, "post_id": 54432944, "comment_id": 95708921, "body": "@Flimzy: I usually prefer code generation or manual implementation over ORM, too, but I would guess it has it&#39;s place in the heart of many developers."}], "tags": [], "owner": {"reputation": 6967, "user_id": 7803650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WH7uu.png?s=128&g=1", "display_name": "Oswin Noetzelmann", "link": "https://stackoverflow.com/users/7803650/oswin-noetzelmann"}, "is_accepted": false, "score": 1, "last_activity_date": 1548884790, "last_edit_date": 1548884790, "creation_date": 1548818783, "answer_id": 54432944, "question_id": 54432854, "link": "https://stackoverflow.com/questions/54432854/how-do-i-write-a-common-method-in-golang-to-insert-record-in-any-of-the-mysql-ta/54432944#54432944", "title": "How do I write a common method in golang to insert record in any of the mysql tables", "body": "<p>Like in other languages, you can use an <a href=\"https://en.wikipedia.org/wiki/Object-relational_mapping\" rel=\"nofollow noreferrer\">ORM</a> library to do the DB translation for you, for example <a href=\"http://gorm.io/\" rel=\"nofollow noreferrer\">GORM</a>, or you can do the translation yourself. Since you already implemented saving the data manually, see this <a href=\"http://go-database-sql.org/retrieving.html\" rel=\"nofollow noreferrer\">article</a> for how to retrieve data manually.</p>\n\n<p>If you just want to write a generic method that generates/executes SQL queries by matching struct field names you can use the reflect package of go. You will have to identify the structs fields by using <code>reflect.TypeOf()</code> to get the Type of your passed variable and then iterate over the <code>StructField</code> that you can get by using the <code>Field()</code> method on the Type. The <code>StructField</code> will reveal the <code>Name</code> and <code>ValueOf()</code> will allow you to access the Value. Name and value can then be used to construct the query.\nFor getting a better understanding I recommend you read some articles on reflect. Like <a href=\"https://medium.com/capital-one-tech/learning-to-use-go-reflection-822a0aed74b7\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://blog.golang.org/laws-of-reflection\" rel=\"nofollow noreferrer\">this</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 343, "user_id": 8411263, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nLuEd7kVkpA/AAAAAAAAAAI/AAAAAAAAACI/XGfe0AyH8n8/photo.jpg?sz=128", "display_name": "Manouchehr Rasouli", "link": "https://stackoverflow.com/users/8411263/manouchehr-rasouli"}, "edited": false, "score": 0, "creation_date": 1581008696, "post_id": 60100045, "comment_id": 106295182, "body": "To add other types use <code>v.Field(i).Float()</code> or other supported types in reflection"}], "tags": [], "owner": {"reputation": 343, "user_id": 8411263, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nLuEd7kVkpA/AAAAAAAAAAI/AAAAAAAAACI/XGfe0AyH8n8/photo.jpg?sz=128", "display_name": "Manouchehr Rasouli", "link": "https://stackoverflow.com/users/8411263/manouchehr-rasouli"}, "is_accepted": false, "score": 0, "last_activity_date": 1581008346, "creation_date": 1581008346, "answer_id": 60100045, "question_id": 54432854, "link": "https://stackoverflow.com/questions/54432854/how-do-i-write-a-common-method-in-golang-to-insert-record-in-any-of-the-mysql-ta/60100045#60100045", "title": "How do I write a common method in golang to insert record in any of the mysql tables", "body": "<p>I think you can use package <code>Refleciton</code> in Golang\n,at first step you have to create a method that generates a query for any given type\nof struct, for example i write a method that generates an insert query for given\nstruct.</p>\n\n<p>I have thus two type</p>\n\n<pre><code>type FirstType struct {\n    FirstParam  string\n    SecondParam int\n}\n\ntype SecondType struct {\n    FirstParam  string\n    SecondParam string\n    ThirdParam  int\n}\n</code></pre>\n\n<p>My insert query generation method is as follow</p>\n\n<pre><code>func generateInsetMethod(input inrerface{}) (string, error) {\n    if reflect.ValueOf(q).Kind() == reflect.Struct {\n        query := fmt.Sprintf(\"insert into %s values(\", reflect.TypeOf(q).Name())\n        v := reflect.ValueOf(q)\n        for i := 0; i &lt; v.NumField(); i++ {\n            switch v.Field(i).Kind() {\n            case reflect.Int:\n                if i == 0 {\n                    query = fmt.Sprintf(\"%s%d\", query, v.Field(i).Int())\n                } else {\n                    query = fmt.Sprintf(\"%s, %d\", query, v.Field(i).Int())\n                }\n            case reflect.String:\n                if i == 0 {\n                    query = fmt.Sprintf(\"%s\\\"%s\\\"\", query, v.Field(i).String())\n                } else {\n                    query = fmt.Sprintf(\"%s, \\\"%s\\\"\", query, v.Field(i).String())\n                }\n            default:\n                fmt.Println(\"Unsupported type\")\n            }\n        }\n        query = fmt.Sprintf(\"%s)\", query)\n        return query, nil\n    }\n    return ``, QueryGenerationError{}\n}\n</code></pre>\n\n<p>know you can use this function to generate your insert queries and also you can generate other functions for <code>Update</code> and etch query that you wants</p>\n"}], "owner": {"reputation": 171, "user_id": 5259101, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1e8db9739f9d98012a2d0ba1801b4a99?s=128&d=identicon&r=PG&f=1", "display_name": "Shambhu", "link": "https://stackoverflow.com/users/5259101/shambhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1204, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1581008346, "creation_date": 1548817982, "last_edit_date": 1549165383, "question_id": 54432854, "link": "https://stackoverflow.com/questions/54432854/how-do-i-write-a-common-method-in-golang-to-insert-record-in-any-of-the-mysql-ta", "title": "How do I write a common method in golang to insert record in any of the mysql tables", "body": "<p>I'm creating a rest api in <code>golang</code> and making a <code>POST</code> request into a table.</p>\n\n<p>For this I've created a struct. Basically the vars in struct is same as the columns in table named <code>users</code>.</p>\n\n<p>and written a function to make a <code>POST</code> request. And the code is working fine, the params while making POST request is being inserted successfully in the table.</p>\n\n<pre><code>type User struct {\n    ID      int\n    Name    string\n    Lname   string\n    Country string\n}\n\n\nfunc insertUser(response http.ResponseWriter, request *http.Request)  \n{\n    var userDetails User\n    decoder := json.NewDecoder(request.Body)\n    err := decoder.Decode(&amp;userDetails)\n    defer request.Body.Close()\n    if err != nil {\n        returnErrorResponse(response,request, httpError)\n    } else {\n        httpError.Code = http.StatusBadRequest\n        if userDetails.Name == \"\" {\n             httpError.Message = \"first name can't be empty\"\n             returnErrorResponse(response, request, httpError)\n        } else if userDetails.Lname == \"\" {\n             httpError.Message = \"Last name can't be empty\"\n             returnErrorResponse(response, request, httpError)\n        } else {\n             isInserted := insertUserInDB(userDetails)\n             if isInserted {\n                  getAllUsers(response, request)\n             } else {\n                  returnErrorResponse(response, request, httpError)\n             }\n        }\n    }\n}\n</code></pre>\n\n<p>Here is <code>insertUserInDB(userDetails)</code> definition</p>\n\n<pre><code>func insertUserInDB(userDetails User) bool {\n  stmt, err := db.Prepare(\"insert into users set Name=?, Lname=?, \nCountry=?\")\n  if err != nil {\n      fmt.Print(\"helper_methods.go : 118\")\n    fmt.Println(err)\n    return false\n  }\n\n  _, queryError := stmt.Exec(tableName, userDetails.Name, \nuserDetails.Lname, userDetails.Country)\n  if queryError != nil {\n      fmt.Print(\"helper_methods.go : 125\")\n    fmt.Println(queryError)\n    return false\n  }\n  return true\n}\n</code></pre>\n\n<p>Is there any way to write a common function to insert record in any of the table in the DB?</p>\n\n<p>Can we create struct dynamically, or any other way?</p>\n\n<p>Please help me out here.</p>\n"}, {"tags": ["go", "sendgrid"], "comments": [{"owner": {"reputation": 2090, "user_id": 2797642, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7f18efc80d45cd819f45c9ee71c9d2a9?s=128&d=identicon&r=PG", "display_name": "Apin", "link": "https://stackoverflow.com/users/2797642/apin"}, "edited": false, "score": 0, "creation_date": 1548830260, "post_id": 54432728, "comment_id": 95678529, "body": "Please also post the output"}, {"owner": {"reputation": 2620, "user_id": 6489829, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a56125658a5592143ade081194b89d6f?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Gore", "link": "https://stackoverflow.com/users/6489829/jack-gore"}, "edited": false, "score": 0, "creation_date": 1552596444, "post_id": 54432728, "comment_id": 97082699, "body": "Did you try checking in the SendGrid activity logs?"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 2568233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f7b9961ecde6879a70ac91063bec717?s=128&d=identicon&r=PG&f=1", "display_name": "Darragh", "link": "https://stackoverflow.com/users/2568233/darragh"}, "is_accepted": false, "score": 0, "last_activity_date": 1548988891, "creation_date": 1548988891, "answer_id": 54472137, "question_id": 54432728, "link": "https://stackoverflow.com/questions/54432728/use-send-grid-in-golang/54472137#54472137", "title": "Use send grid in golang?", "body": "<p>I assume you have set up a SendGrid account, if not, I would start there as it has step by step instructions on how to generate a API key and test that your email has been sent by SendGrid.</p>\n\n<p>Your issue is on this line (the code above looks to be pulled directly from SendGrid's example unmodified)</p>\n\n<pre><code>from := mail.NewEmail(\"Example User\", \"test@example.com\")\n</code></pre>\n\n<p>The email address <em>must</em> be a valid email address that you control.</p>\n\n<p>See <a href=\"https://app.sendgrid.com/guide/integrate/langs/go\" rel=\"nofollow noreferrer\">https://app.sendgrid.com/guide/integrate/langs/go</a> for more details on how to get started. </p>\n\n<p>If the above doesn't work it may also need to be validated/verified by SendGrid (you would have received a verification email when you nominated an email address for sending emails under Marketing > Marketing Campaigns > Senders > Create New Sender in your SendGrid account) before you can send emails using that email address.</p>\n"}], "owner": {"reputation": 1, "user_id": 10045475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfe7f7a77f36ea7e74c1aa64b07798fe?s=128&d=identicon&r=PG&f=1", "display_name": "trungduc08", "link": "https://stackoverflow.com/users/10045475/trungduc08"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 668, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548988891, "creation_date": 1548816839, "question_id": 54432728, "link": "https://stackoverflow.com/questions/54432728/use-send-grid-in-golang", "title": "Use send grid in golang?", "body": "<p>I use sendgrid to send mail in golang. Although status code return 202, email don't send. Can someone help me?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n\n    sendgrid \"github.com/sendgrid/sendgrid-go\"\n    \"github.com/sendgrid/sendgrid-go/helpers/mail\"\n)\n\nfunc main() {\n    from := mail.NewEmail(\"Example User\", \"test@example.com\")\n    subject := \"Sending with SendGrid is Fun\"\n    to := mail.NewEmail(\"Example User\", \"trungduc08trungduc08@gmail.com\")\n    plainTextContent := \"and easy to do anywhere, even with Go\"\n    htmlContent := \"&lt;strong&gt;and easy to do anywhere, even with Go&lt;/strong&gt;\"\n    message := mail.NewSingleEmail(from, subject, to, plainTextContent, htmlContent)\n    client := sendgrid.NewSendClient(\"my api-key\")\n    response, err := client.Send(message)\n    if err != nil {\n        log.Println(\"err:\", err)\n    } else {\n        fmt.Println(\"statusCode: \", response.StatusCode)\n        fmt.Println(\"body: \", response.Body)\n        fmt.Println(\"headers: \", response.Headers)\n    }\n}\n</code></pre>\n"}, {"tags": ["docker", "go"], "comments": [{"owner": {"reputation": 2274, "user_id": 7567579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ab9644beeb1d324d1247b2951d28927?s=128&d=identicon&r=PG", "display_name": "Emin Laletovic", "link": "https://stackoverflow.com/users/7567579/emin-laletovic"}, "edited": false, "score": 0, "creation_date": 1548833585, "post_id": 54431216, "comment_id": 95680123, "body": "Could you please make sure that <code>api</code> executable got copied from <code>builder</code>?"}, {"owner": {"reputation": 12784, "user_id": 1401034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vBXk9.png?s=128&g=1", "display_name": "Ewan", "link": "https://stackoverflow.com/users/1401034/ewan"}, "reply_to_user": {"reputation": 2274, "user_id": 7567579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ab9644beeb1d324d1247b2951d28927?s=128&d=identicon&r=PG", "display_name": "Emin Laletovic", "link": "https://stackoverflow.com/users/7567579/emin-laletovic"}, "edited": false, "score": 0, "creation_date": 1548838012, "post_id": 54431216, "comment_id": 95682228, "body": "Can confirm by running a <code>RUN ls -la</code> in the second stage of the Dockerfile during the build and just the fact that it is running the <code>api</code>"}, {"owner": {"reputation": 10507, "user_id": 56686, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9nKtX.jpg?s=128&g=1", "display_name": "Mattias Wadman", "link": "https://stackoverflow.com/users/56686/mattias-wadman"}, "edited": false, "score": 0, "creation_date": 1548844091, "post_id": 54431216, "comment_id": 95686040, "body": "Maybe test by skipping scratch and just run api binary in the build container and see what happens. Might give some clue"}], "answers": [{"comments": [{"owner": {"reputation": 12784, "user_id": 1401034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vBXk9.png?s=128&g=1", "display_name": "Ewan", "link": "https://stackoverflow.com/users/1401034/ewan"}, "edited": false, "score": 0, "creation_date": 1548916032, "post_id": 54453413, "comment_id": 95717209, "body": "Spot on - thank you! I spent too long trying to work out what was different between my local and docker builds. Thanks again"}], "tags": [], "owner": {"reputation": 653, "user_id": 4760331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CO6sa.jpg?s=128&g=1", "display_name": "Jorden", "link": "https://stackoverflow.com/users/4760331/jorden"}, "is_accepted": true, "score": 1, "last_activity_date": 1548909722, "creation_date": 1548909722, "answer_id": 54453413, "question_id": 54431216, "link": "https://stackoverflow.com/questions/54431216/golang-docker-multi-stage-build-failing-to-run-exec-go-executable-file-not/54453413#54453413", "title": "Golang docker multi-stage build failing to run: exec: &quot;go&quot;: executable file not found in $PATH", "body": "<p>Your actual build line:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>RUN CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -installsuffix cgo -ldflags '-extldflags \"-static\"' -o api cmd/api/\n</code></pre>\n\n<p>is missing a relative path in front of <code>cmd</code>, making it instead be <code>./cmd/api</code> will result in a successful build/run. <code>cmd/api</code> is a real thing apparently, <a href=\"https://golang.org/cmd/api/\" rel=\"nofollow noreferrer\">https://golang.org/cmd/api/</a>, so it's not erring out, but also not doing what you are expecting it to do. If you type <code>go run cmd/api</code> in your terminal you should see a ton of output unrelated to your application.</p>\n"}], "owner": {"reputation": 12784, "user_id": 1401034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vBXk9.png?s=128&g=1", "display_name": "Ewan", "link": "https://stackoverflow.com/users/1401034/ewan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 820, "favorite_count": 1, "accepted_answer_id": 54453413, "answer_count": 1, "score": 2, "last_activity_date": 1548909722, "creation_date": 1548804717, "question_id": 54431216, "link": "https://stackoverflow.com/questions/54431216/golang-docker-multi-stage-build-failing-to-run-exec-go-executable-file-not", "title": "Golang docker multi-stage build failing to run: exec: &quot;go&quot;: executable file not found in $PATH", "body": "<p>When deploying a simple API with a Docker multi-stage build the following error is being thrown:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ docker build -t api:latest .\n[...]\n$ docker run -p 4880:4880 --rm --name=api api:latest\n2019/01/29 23:02:15 exec: \"go\": executable file not found in $PATH\n</code></pre>\n\n<p>As my application is not calling <code>go</code> from anywhere (or any <code>exec.Command</code>) I ran a <code>go mod vendor</code> so I could check the dependency source code and found the following:</p>\n\n<pre><code>vendor/github.com/lib/pq/oid/gen.go\n12:     \"os/exec\"\n64:     cmd := exec.Command(\"gofmt\")\n</code></pre>\n\n<p>Could this be the issue and if so how can I fix it? I am <em>sure</em> I have managed to deploy <code>github.com/lib/pq</code> in a multi-stage build before but I am currently stuck.</p>\n\n<p>Many thanks and Happy Hacking.</p>\n\n<p><strong>Dockerfile</strong></p>\n\n<pre><code>FROM golang:1-alpine AS builder\nENV GO111MODULE=on\nRUN apk --no-cache add ca-certificates git\nWORKDIR /app\n# Copy go module info first...\nCOPY go.mod .\nCOPY go.sum .\n# ...then download to cache dependencies between builds\nRUN go mod download\nCOPY . .\nRUN CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -installsuffix cgo -ldflags '-extldflags \"-static\"' -o api cmd/api/\n\nFROM scratch\nWORKDIR /app\nCOPY --from=builder /app/api /app/\nCOPY --from=builder /etc/ssl/certs/ca-certificates.crt /etc/ssl/certs/\nEXPOSE 8080\nENTRYPOINT [\"./api\"]\n</code></pre>\n"}, {"tags": ["amazon-web-services", "go", "aws-sdk-go"], "comments": [{"owner": {"reputation": 163, "user_id": 4843036, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f8ca9f59323593a91dff00d929cf660?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/4843036/victor"}, "edited": false, "score": 0, "creation_date": 1548820428, "post_id": 54431054, "comment_id": 95675768, "body": "Thank you Daniel and retgits both for the help."}], "answers": [{"comments": [{"owner": {"reputation": 163, "user_id": 4843036, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f8ca9f59323593a91dff00d929cf660?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/4843036/victor"}, "edited": false, "score": 0, "creation_date": 1548806540, "post_id": 54431198, "comment_id": 95672557, "body": "Yes, that essentially what the docs say. I&#39;m just confused as to if I have to explicitly query for a role on the instance and then somehow create credentials for it, or if I need to specify a role explicitly and no creds, or nothing at all.  I normally use the keys but that&#39;s not that secure correct?"}, {"owner": {"reputation": 311009, "user_id": 222908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d458bc475f0e0cc0a8d11325db2d9621?s=128&d=identicon&r=PG", "display_name": "Daniel Vassallo", "link": "https://stackoverflow.com/users/222908/daniel-vassallo"}, "reply_to_user": {"reputation": 163, "user_id": 4843036, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f8ca9f59323593a91dff00d929cf660?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/4843036/victor"}, "edited": false, "score": 1, "creation_date": 1548808098, "post_id": 54431198, "comment_id": 95673004, "body": "If you specify nothing, it should automatically use the EC2 instance role. You can only have 1 EC2 instance role, so there&#39;s no need to specify it."}], "tags": [], "owner": {"reputation": 311009, "user_id": 222908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d458bc475f0e0cc0a8d11325db2d9621?s=128&d=identicon&r=PG", "display_name": "Daniel Vassallo", "link": "https://stackoverflow.com/users/222908/daniel-vassallo"}, "is_accepted": true, "score": 2, "last_activity_date": 1548804893, "last_edit_date": 1548804893, "creation_date": 1548804583, "answer_id": 54431198, "question_id": 54431054, "link": "https://stackoverflow.com/questions/54431054/does-my-application-need-to-ask-for-a-role-on-ec2-instance-to-configure-the-sess/54431198#54431198", "title": "Does my application need to ask for a role on ec2 instance to configure the session or leave it empty?", "body": "<p>I have never used the go SDK, but the AWS SDKs I used automatically use the EC2 instance role if credentials are not found from any other source.</p>\n\n<p>Here's an AWS blog post explaining the approach AWS SDKs follow when fetching credentials: <a href=\"https://aws.amazon.com/blogs/security/a-new-and-standardized-way-to-manage-credentials-in-the-aws-sdks/\" rel=\"nofollow noreferrer\">https://aws.amazon.com/blogs/security/a-new-and-standardized-way-to-manage-credentials-in-the-aws-sdks/</a>. In particular, see this:</p>\n\n<blockquote>\n  <p>If you use code like this, the SDKs look for the credentials in this\n  order:</p>\n  \n  <ol>\n  <li>In environment variables. (Not the .NET SDK, as noted earlier.) </li>\n  <li>In the central credentials file (~/.aws/credentials or\n  %USERPROFILE%.awscredentials). </li>\n  <li>In an existing default, SDK-specific\n  configuration file, if one exists. This would be the case if you had\n  been using the SDK before these changes were made. </li>\n  <li>For the .NET SDK, in the SDK Store, if it exists. </li>\n  <li>If the code is running on an EC2\n  instance, via an IAM role for Amazon EC2. In that case, the code gets\n  temporary security credentials from the instance metadata service; the\n  credentials have the permissions derived from the role that is\n  associated with the instance.</li>\n  </ol>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 163, "user_id": 4843036, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f8ca9f59323593a91dff00d929cf660?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/4843036/victor"}, "edited": false, "score": 0, "creation_date": 1548806711, "post_id": 54431332, "comment_id": 95672598, "body": "Thanks for the sample. I normally use the keys to connect as well, but my requirements have changed and I&#39;m just confused as how to create a client and session without credentials and just a role. I&#39;m not sure if I need to create the session by specifying the role or just let the SDK decide."}, {"owner": {"reputation": 1047, "user_id": 10443472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/051b4da9def21dd0ff5e10f383a96c94?s=128&d=identicon&r=PG", "display_name": "retgits", "link": "https://stackoverflow.com/users/10443472/retgits"}, "reply_to_user": {"reputation": 163, "user_id": 4843036, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f8ca9f59323593a91dff00d929cf660?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/4843036/victor"}, "edited": false, "score": 1, "creation_date": 1548806905, "post_id": 54431332, "comment_id": 95672637, "body": "Ah okay, in that case I misunderstood, sorry! Does your code already run on AWS? In my Lambda&#39;s I use <code>awsSession = session.Must(session.NewSession(&amp;aws.Config{Region: aws.String(awsRegion),}))</code> and it will automatically assume the role that my Lambda got when I deployed it."}], "tags": [], "owner": {"reputation": 1047, "user_id": 10443472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/051b4da9def21dd0ff5e10f383a96c94?s=128&d=identicon&r=PG", "display_name": "retgits", "link": "https://stackoverflow.com/users/10443472/retgits"}, "is_accepted": false, "score": 0, "last_activity_date": 1548805432, "creation_date": 1548805432, "answer_id": 54431332, "question_id": 54431054, "link": "https://stackoverflow.com/questions/54431054/does-my-application-need-to-ask-for-a-role-on-ec2-instance-to-configure-the-sess/54431332#54431332", "title": "Does my application need to ask for a role on ec2 instance to configure the session or leave it empty?", "body": "<p>In my apps, when I need to connect to AWS resources, I tend to use an access key and secret key that have specific predefined IAM roles. Assuming I have those two, the code I use to create a session is:</p>\n\n<pre><code>awsCredentials := credentials.NewStaticCredentials(awsAccessKeyID, awsSecretAccessKey, \"\")\nawsSession = session.Must(session.NewSession(&amp;aws.Config{\n            Credentials: awsCredentials,\n            Region:      aws.String(awsRegion),\n        }))\n</code></pre>\n\n<p>When I use this, the two keys are usually specified as either environment variables (if I deploy to a docker container).</p>\n\n<p>A complete example: <a href=\"https://github.com/retgits/flogo-components/blob/master/activity/amazons3/activity.go\" rel=\"nofollow noreferrer\">https://github.com/retgits/flogo-components/blob/master/activity/amazons3/activity.go</a></p>\n"}], "owner": {"reputation": 163, "user_id": 4843036, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f8ca9f59323593a91dff00d929cf660?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/4843036/victor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "accepted_answer_id": 54431198, "answer_count": 2, "score": 1, "last_activity_date": 1548805432, "creation_date": 1548803711, "question_id": 54431054, "link": "https://stackoverflow.com/questions/54431054/does-my-application-need-to-ask-for-a-role-on-ec2-instance-to-configure-the-sess", "title": "Does my application need to ask for a role on ec2 instance to configure the session or leave it empty?", "body": "<p>I'm trying to use the aws-sdk-go in my application. It's running on EC2 instance. Now in the Configuring Credentials of the doc,<a href=\"https://docs.aws.amazon.com/sdk-for-go/api/\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/sdk-for-go/api/</a>, it says it will look in</p>\n\n<pre><code>*Environment Credentials - Set of environment variables that are useful when sub processes are created for specific roles.\n\n* Shared Credentials file (~/.aws/credentials) - This file stores your credentials based on a profile name and is useful for local development.\n\n*EC2 Instance Role Credentials - Use EC2 Instance Role to assign credentials to application running on an EC2 instance. This removes the need to manage credential files in production.`\n</code></pre>\n\n<p>Wouldn't the best order be the reverse order? But my main question is do I need to ask the instance if it has a role and then use that to set up the credentials if it has a role? This is where I'm not sure of what I need to do and how.</p>\n\n<p>I did try a simple test of creating a empty config with essentially only setting the region and running it on the instance with the role and it seems to have \"worked\" but in this case, I am not sure if I need to explicitly set the role or not.</p>\n\n<pre><code>awsSDK.Config{\n    Region:      awsSDK.String(a.region),\n    MaxRetries:  awsSDK.Int(maxRetries),\n    HTTPClient:  http.DefaultClient,\n}\n</code></pre>\n\n<p>I just want to confirm is this the proper way of doing it or not. My thinking is I need to do something like the following</p>\n\n<pre><code>   role = use sdk call to get role on machine\n   set awsSDK.Config { Credentials: credentials form of role,\n            ...\n       }\n\n   issue service command with returned client.\n</code></pre>\n\n<p>Any more docs/pointers would be great!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548802172, "post_id": 54430780, "comment_id": 95671439, "body": "you have slices of strings -- what is a &quot;splice&quot; of strings?"}, {"owner": {"reputation": 977, "user_id": 4184982, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/1447350563/picture?type=large", "display_name": "dylankbuckley", "link": "https://stackoverflow.com/users/4184982/dylankbuckley"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548802356, "post_id": 54430780, "comment_id": 95671491, "body": "@JimB sorry have edited"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1548802395, "post_id": 54430780, "comment_id": 95671499, "body": "Using an regexp is another way to do it, but it may or may not be better depending on the usage."}, {"owner": {"reputation": 2273, "user_id": 6020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f0a9f540105e654ef7d03edc36ad3a?s=128&d=identicon&r=PG", "display_name": "BJ Black", "link": "https://stackoverflow.com/users/6020403/bj-black"}, "edited": false, "score": 1, "creation_date": 1548803146, "post_id": 54430780, "comment_id": 95671718, "body": "There really isn&#39;t a better way of doing this, since (in the case of attempting alternation in a regex) you might have regex-special chars that would need escaping and anything you&#39;d try wouldn&#39;t be any faster anyway AND attempting this as e.g. a []byte compare instead of chars might capture the wrong thing in the case of oddball multichar non-ASCII strings.  So the regexp case is probably slower and equally complex thanks to escapes and having to generate the regexp and the []byte case could generate false positives.  For bigger cases, you could look at creating indices of terms, though."}, {"owner": {"reputation": 2292, "user_id": 767903, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7ae9acb5bf16896b78a9708403da20ca?s=128&d=identicon&r=PG", "display_name": "Andrew W. Phillips", "link": "https://stackoverflow.com/users/767903/andrew-w-phillips"}, "edited": false, "score": 0, "creation_date": 1548804421, "post_id": 54430780, "comment_id": 95672025, "body": "You may be able to speed things up depending on info you have not provided - eg. whether the strings or sub-strings change (often).  For example, join the strings to search into one long string (sep. by an unused char if there is one) or put the substrings in a trie.  Do you want the location of the first found sub-string or just know whether any one is found or not?"}, {"owner": {"reputation": 1914, "user_id": 9811969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/184e2e46b8d8b8c483c85589709b8563?s=128&d=identicon&r=PG&f=1", "display_name": "Nik", "link": "https://stackoverflow.com/users/9811969/nik"}, "edited": false, "score": 0, "creation_date": 1589640004, "post_id": 54430780, "comment_id": 109376000, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/47131996/go-how-to-check-if-a-string-contains-multiple-substrings\">Go: how to check if a string contains multiple substrings?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": false, "score": 0, "last_activity_date": 1548858363, "creation_date": 1548858363, "answer_id": 54442806, "question_id": 54430780, "link": "https://stackoverflow.com/questions/54430780/checking-if-a-string-contains-a-substring-contained-in-a-slice-in-go/54442806#54442806", "title": "Checking if a string contains a substring contained in a slice in Go", "body": "<p>Unless the size of data is very large and you're looking for algorithmic improvements over the O(N^2) solution you currently have, your code is fine.</p>\n\n<p>For very large data you could consider using some more sophisticated data structures. For example, Go has the <a href=\"https://golang.org/pkg/index/suffixarray\" rel=\"nofollow noreferrer\">https://golang.org/pkg/index/suffixarray</a> package that would let you take your slice of strings to check, preprocess it, and then perform substring lookups in logarithmic time.</p>\n"}], "owner": {"reputation": 977, "user_id": 4184982, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/1447350563/picture?type=large", "display_name": "dylankbuckley", "link": "https://stackoverflow.com/users/4184982/dylankbuckley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1832, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548858363, "creation_date": 1548802057, "last_edit_date": 1548802339, "question_id": 54430780, "link": "https://stackoverflow.com/questions/54430780/checking-if-a-string-contains-a-substring-contained-in-a-slice-in-go", "title": "Checking if a string contains a substring contained in a slice in Go", "body": "<p>I have an array of substrings and a slice of strings. I want to check if the string contains any of the substrings in the mySliceOfSubstrings slice.</p>\n\n<pre><code>mySliceOfSubstrings := []string{\"hello\", \"world\"}\nmySliceOfStringsToCheck := []string{\"hello mars\", \"hey mars\"}\n</code></pre>\n\n<p>Is there a better way of doing it the below way of putting a loop inside a loop?</p>\n\n<pre><code>for _, string := range mySliceOfStringsToCheck {\n\n     for _, substring := range mySliceOfSubstrings {\n          result := strings.Contains(string, substring)\n\n     }  \n\n}\n</code></pre>\n\n<p>What if I wanted to check the string against two different slice of substrings?</p>\n"}, {"tags": ["c", "go", "dlopen", "cgo", "dlsym"], "comments": [{"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "edited": false, "score": 3, "creation_date": 1548799263, "post_id": 54430063, "comment_id": 95670576, "body": "why would you expect them to be the same? I&#39;ll delete this unhelpful comment later if you want but i dont understand the assumption your making."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 5, "creation_date": 1548799290, "post_id": 54430063, "comment_id": 95670586, "body": "The dynamic linker does not necessarily load libraries and individual symbols at the same (virtual) address every time.  I don&#39;t presently see any reason to expect that the outputs of the two programs would be the same."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1548800371, "post_id": 54430063, "comment_id": 95670926, "body": "Do you even get the same results if you run either one program repeatedly?"}, {"owner": {"reputation": 1339, "user_id": 2141064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c56d69ec8f5e469a8c6ca22d60271e9b?s=128&d=identicon&r=PG", "display_name": "Lorinczy Zsigmond", "link": "https://stackoverflow.com/users/2141064/lorinczy-zsigmond"}, "edited": false, "score": 0, "creation_date": 1548927246, "post_id": 54430063, "comment_id": 95722830, "body": "Your <code>dlopen</code> might have loaded <i>another</i> libc.so.6 which you should avoid. There is a <code>RTLD_NOLOAD</code> option for this.Also there is the nightmare called symbol-versioning..."}], "answers": [{"comments": [{"owner": {"reputation": 169, "user_id": 270779, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/7fcce4eed5196a07162c16d77b9d2f00?s=128&d=identicon&r=PG", "display_name": "Coop", "link": "https://stackoverflow.com/users/270779/coop"}, "edited": false, "score": 1, "creation_date": 1548805867, "post_id": 54430291, "comment_id": 95672408, "body": "My understanding of ASLR is a bit rusty. I&#39;m trying to grok the article. Doesn&#39;t ASLR apply to multiple runs of the process and/or the relationship between symbols? In this case, when we have the same symbol being accessed by the same process, isn&#39;t it going to have the same address? Obviously not from your testing and my Go code. . . but it appears to sometimes hold."}], "tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 6, "last_activity_date": 1548799332, "creation_date": 1548799332, "answer_id": 54430291, "question_id": 54430063, "link": "https://stackoverflow.com/questions/54430063/why-does-dlsym-produce-different-results-in-cgo-than-in-c/54430291#54430291", "title": "Why does dlsym produce different results in cgo than in c?", "body": "<p>The symbols aren't loaded into fixed addresses in memory; they go wherever the loader decides to put them.  </p>\n\n<p>This is the output of me running your C program multiple times on my machine.</p>\n\n<pre><code>govind@Govind-PC:/mnt/c/Temp$ ./dlst\nReal: 0x7f4b5f3127d0 Current: 0x7f4b5f26ee30\ngovind@Govind-PC:/mnt/c/Temp$ ./dlst\nReal: 0x7f45727127d0 Current: 0x7f457266ee30\ngovind@Govind-PC:/mnt/c/Temp$ ./dlst\nReal: 0x7fc3373127d0 Current: 0x7fc33726ee30\ngovind@Govind-PC:/mnt/c/Temp$ ./dlst\nReal: 0x7f0e555127d0 Current: 0x7f0e5546ee30\ngovind@Govind-PC:/mnt/c/Temp$ ./dlst\nReal: 0x7f2fdd9127d0 Current: 0x7f2fdd86ee30\ngovind@Govind-PC:/mnt/c/Temp$ ./dlst\nReal: 0x7fec7db127d0 Current: 0x7fec7da6ee30\ngovind@Govind-PC:/mnt/c/Temp$ ./dlst\nReal: 0x7f07de1127d0 Current: 0x7f07de06ee30\ngovind@Govind-PC:/mnt/c/Temp$\n</code></pre>\n\n<p>See also:</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Address_space_layout_randomization\" rel=\"noreferrer\">Address Space Layout Randomization</a></p>\n"}, {"tags": [], "owner": {"reputation": 104, "user_id": 9384701, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vTWibx0fC3o/AAAAAAAAAAI/AAAAAAAAFX4/busRlfuEfAU/photo.jpg?sz=128", "display_name": "Axel Wagner", "link": "https://stackoverflow.com/users/9384701/axel-wagner"}, "is_accepted": true, "score": 6, "last_activity_date": 1548917389, "creation_date": 1548917389, "answer_id": 54454878, "question_id": 54430063, "link": "https://stackoverflow.com/questions/54430063/why-does-dlsym-produce-different-results-in-cgo-than-in-c/54454878#54454878", "title": "Why does dlsym produce different results in cgo than in c?", "body": "<p>The reason is that Go links against libpthread, but your C program doesn't. If I add <code>-lpthread</code> to the gcc arguments, it prints different pointers too. So, libpthread defines its own <code>accept</code> and overrides the libc one (which kind of makes sense).</p>\n\n<p>The way I figured that out is that I inserted a sleep into both programs and then rummaged through <code>/proc/$pid/maps</code> to see what the returned pointers reference. That showed that in Go's case, the \"current\" pointer resides in libpthread. The \"real\" pointer always references libc.</p>\n"}], "owner": {"reputation": 169, "user_id": 270779, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/7fcce4eed5196a07162c16d77b9d2f00?s=128&d=identicon&r=PG", "display_name": "Coop", "link": "https://stackoverflow.com/users/270779/coop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 501, "favorite_count": 0, "accepted_answer_id": 54454878, "answer_count": 2, "score": 2, "last_activity_date": 1548917389, "creation_date": 1548798319, "last_edit_date": 1548801273, "question_id": 54430063, "link": "https://stackoverflow.com/questions/54430063/why-does-dlsym-produce-different-results-in-cgo-than-in-c", "title": "Why does dlsym produce different results in cgo than in c?", "body": "<p>I have two implementations of the same behavior that I believe should produce the same results but are instead producing different results. When compiled in Go using <code>cgo</code>, I get a different symbol address resolution than when compiled in C. I would like to understand why.</p>\n\n<p>I reduced the problem to a couple of small examples, one in C and one in Go. I tested these in an Ubuntu 18 Docker container running on my Mac laptop. </p>\n\n<p>test.c: </p>\n\n<pre><code>// gcc test.c -D_GNU_SOURCE -ldl\n// Output: Real: 0x7fd05559d7d0 Current: 0x7fd05559d7d0\n\n#include &lt;dlfcn.h&gt;\n#include &lt;stdio.h&gt;\n\nint main() {\n    void * fd = dlopen(\"libc.so.6\", RTLD_LAZY);\n    void * real_sym = dlsym(fd, \"accept\");\n    void * curr_sym = dlsym(RTLD_NEXT, \"accept\");\n    printf(\"Real: %p Current: %p\\n\", real_sym, curr_sym);\n    return 0;\n}\n</code></pre>\n\n<p>test.go:</p>\n\n<pre><code>// go build test.go\n// Output: Real: 0x7f264583b7d0 Current: 0x7f2645b1b690\npackage main\n\n// #cgo CFLAGS: -D_GNU_SOURCE\n// #cgo LDFLAGS: -ldl\n// #include &lt;dlfcn.h&gt;\nimport \"C\"\nimport \"fmt\"\n\nfunc main() {\n    fp := C.dlopen(C.CString(\"libc.so.6\"), C.RTLD_LAZY)\n    real_sym := C.dlsym(fp, C.CString(\"accept\"))\n    curr_sym := C.dlsym(C.RTLD_NEXT, C.CString(\"accept\"))\n    fmt.Printf(\"Real: %p Current: %p\\n\", real_sym, curr_sym)\n}\n</code></pre>\n\n<p>I get the output of <code>Real: 0x7fd05559d7d0 Current: 0x7fd05559d7d0</code> when <code>test.c</code> gets compiled (<code>gcc test.c -D_GNU_SOURCE -ldl</code>). However, when I build <code>test.go</code> I see <code>Real: 0x7f264583b7d0 Current: 0x7f2645b1b690</code>. </p>\n\n<p>I assume that go is wrapping some symbols itself, but I would like to know exactly what's happening. Thanks!</p>\n\n<hr>\n\n<p>A couple of extra pieces after seeing some of the initial comments. I changed <code>test.c</code> as below and then ran in a loop (<code>while [ 1 ]; do   ./a.out; done</code>). It's consistently getting equal addresses for me (different each run, though).</p>\n\n<pre><code>// gcc test.c -D_GNU_SOURCE -ldl\n// Output: Real: 0x7fd05559d7d0 Current: 0x7fd05559d7d0\n\n#include &lt;dlfcn.h&gt;\n#include &lt;stdio.h&gt;\n\n    int main() {\n    void * fd = dlopen(\"libc.so.6\", RTLD_LAZY);\n    void * real_sym = dlsym(fd, \"accept\");\n    void * curr_sym = dlsym(RTLD_NEXT, \"accept\");\n    if(real_sym != curr_sym) {\n        printf(\"Real: %p Current: %p\\n\", real_sym, curr_sym);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I also tried a modification of the Go code to check if it had to do with how Go called out to C, but that still did not have the addresses match: </p>\n\n<pre><code>// go build dos.go\n// Output: Real: 0x7f264583b7d0 Current: 0x7f2645b1b690\npackage main\n\n// #cgo CFLAGS: -D_GNU_SOURCE\n// #cgo LDFLAGS: -ldl\n// #include &lt;dlfcn.h&gt;\n// #include &lt;stdio.h&gt;\n// int doit() {\n//     void * fd = dlopen(\"libc.so.6\", RTLD_LAZY);\n//     void * real_sym = dlsym(fd, \"accept\");\n//     void * curr_sym = dlsym(RTLD_NEXT, \"accept\");\n//     printf(\"Real: %p Current: %p\\n\", real_sym, curr_sym);\n//     return 0;\n// }\nimport \"C\"\n\nfunc main() {\n    C.doit()\n}\n</code></pre>\n\n<p>Another point is that I get the two addresses to match in both the C and Go code if I look for the <code>malloc</code> symbol instead of <code>accept</code>.</p>\n"}, {"tags": ["windows", "macos", "file", "go"], "comments": [{"owner": {"reputation": 4719, "user_id": 2958070, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FtkjC.jpg?s=128&g=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2958070/ben"}, "edited": false, "score": 1, "creation_date": 1548792903, "post_id": 54428869, "comment_id": 95667948, "body": "Can you use rsync instead of golang?"}, {"owner": {"reputation": 3467, "user_id": 3393308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3f30f7c191e8d556c70c951fe3d9af?s=128&d=identicon&r=PG", "display_name": "yorodm", "link": "https://stackoverflow.com/users/3393308/yorodm"}, "edited": false, "score": 3, "creation_date": 1548793261, "post_id": 54428869, "comment_id": 95668109, "body": "I know someone already told you this, but it&#39;s the OS. You can do a search about NTF + small files to confirm"}, {"owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "reply_to_user": {"reputation": 4719, "user_id": 2958070, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FtkjC.jpg?s=128&g=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2958070/ben"}, "edited": false, "score": 0, "creation_date": 1548793388, "post_id": 54428869, "comment_id": 95668163, "body": "@Ben - sorry what do you mean instead of golang ? can you provide example what to change ?"}, {"owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "reply_to_user": {"reputation": 3467, "user_id": 3393308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3f30f7c191e8d556c70c951fe3d9af?s=128&d=identicon&r=PG", "display_name": "yorodm", "link": "https://stackoverflow.com/users/3393308/yorodm"}, "edited": false, "score": 0, "creation_date": 1548793464, "post_id": 54428869, "comment_id": 95668190, "body": "@yorodm - someone told me what ? :)"}, {"owner": {"reputation": 3467, "user_id": 3393308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3f30f7c191e8d556c70c951fe3d9af?s=128&d=identicon&r=PG", "display_name": "yorodm", "link": "https://stackoverflow.com/users/3393308/yorodm"}, "edited": false, "score": 0, "creation_date": 1548793723, "post_id": 54428869, "comment_id": 95668268, "body": "There&#39;s usually some *nix fan in every time that blames Windows for every bad thing in the Universe, I assumed there was one in your team. Nevertheless, NTFS has some issues when dealing with small files and there are a lot of those in a <code>node_modules</code> folder. That&#39;s the root of all your performance issues."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1548795720, "post_id": 54428869, "comment_id": 95669103, "body": "have you considered to parallelize the job ?"}, {"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1548797911, "post_id": 54428869, "comment_id": 95670044, "body": "You should skip the node_modules folder. Just copy your files and then run <code>npm init</code>, that is much faster."}, {"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1548797994, "post_id": 54428869, "comment_id": 95670081, "body": "@mh-cbon a bad idea if your destination is not able to write prallel."}, {"owner": {"reputation": 4719, "user_id": 2958070, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FtkjC.jpg?s=128&g=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2958070/ben"}, "edited": false, "score": 0, "creation_date": 1548800912, "post_id": 54428869, "comment_id": 95671084, "body": "@NinaS there&#39;s a unix tool called <code>rsync</code> that copies files from one location to another, and on subsequent copies, it only copies the <i>changes</i> from the first location. Because of the nature of node_modules, you&#39;d likely only pay the small file cost on the first copy (I haven&#39;t tested this). Unfortunately, I couldn&#39;t find a maintained open-source windows version in my quick Googling."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "reply_to_user": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1548804670, "post_id": 54428869, "comment_id": 95672086, "body": "@apxp i don t understand your remark. he is copying file by file, why would it be unsafe ? tree traversal can be made twice to setup folders at first, then apply a second traversal to copy the files in //. what did you mean ?"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1548806042, "post_id": 54428869, "comment_id": 95672456, "body": "With Windows file acesses you should be concerned about the effects of Windows Defender Antivirus and other antimalware programs. Does turning them off make any difference?"}, {"owner": {"reputation": 6124, "user_id": 5627983, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/696f780ea286896dd41a92459152fbb3?s=128&d=identicon&r=PG&f=1", "display_name": "s952163", "link": "https://stackoverflow.com/users/5627983/s952163"}, "reply_to_user": {"reputation": 3467, "user_id": 3393308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3f30f7c191e8d556c70c951fe3d9af?s=128&d=identicon&r=PG", "display_name": "yorodm", "link": "https://stackoverflow.com/users/3393308/yorodm"}, "edited": false, "score": 0, "creation_date": 1548809352, "post_id": 54428869, "comment_id": 95673290, "body": "@yorodm why would it be the OS? have you tested the copying in another language like C++ or  .NET. I get very fast copy speeds in .NET, but not in golang. So maybe it&#39;s the way golang calls the windows API."}, {"owner": {"reputation": 194, "user_id": 1478294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b079763724f5d11cd9381594bb925d?s=128&d=identicon&r=PG", "display_name": "Dippo", "link": "https://stackoverflow.com/users/1478294/dippo"}, "edited": false, "score": 1, "creation_date": 1548809462, "post_id": 54428869, "comment_id": 95673317, "body": "I&#39;ve had the same issue, the solution was to create the file first, then do all the checks and then copy (write) the data."}, {"owner": {"reputation": 3467, "user_id": 3393308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3f30f7c191e8d556c70c951fe3d9af?s=128&d=identicon&r=PG", "display_name": "yorodm", "link": "https://stackoverflow.com/users/3393308/yorodm"}, "reply_to_user": {"reputation": 6124, "user_id": 5627983, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/696f780ea286896dd41a92459152fbb3?s=128&d=identicon&r=PG&f=1", "display_name": "s952163", "link": "https://stackoverflow.com/users/5627983/s952163"}, "edited": false, "score": 0, "creation_date": 1548811888, "post_id": 54428869, "comment_id": 95673929, "body": "@s952163 NTFS has performance issues with small files. <code>node_modules</code> has mostly small files. See <a href=\"https://stackoverflow.com/questions/27845026/opening-many-small-files-on-ntfs-is-way-too-slow\">here</a> and <a href=\"https://serverfault.com/questions/768755/sluggish-performance-on-ntfs-drive-with-large-number-of-files\">here</a>"}, {"owner": {"reputation": 810, "user_id": 10989396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4caa8f53ec0ebff61132b4cb58539467?s=128&d=identicon&r=PG&f=1", "display_name": "hyperTrashPanda", "link": "https://stackoverflow.com/users/10989396/hypertrashpanda"}, "edited": false, "score": 0, "creation_date": 1549021498, "post_id": 54428869, "comment_id": 95764468, "body": "As others have mentioned, it may indeed be the NFTS performance with small files. Did you try to zip and transfer all files as a sole unit? It should have performance comparable to the Mac one, otherwise some other networking issue could be the culprit."}, {"owner": {"reputation": 1704, "user_id": 2912740, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4730dc939ce11655d239d1f54a9cd399?s=128&d=identicon&r=PG&f=1", "display_name": "Edwinner", "link": "https://stackoverflow.com/users/2912740/edwinner"}, "reply_to_user": {"reputation": 194, "user_id": 1478294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b079763724f5d11cd9381594bb925d?s=128&d=identicon&r=PG", "display_name": "Dippo", "link": "https://stackoverflow.com/users/1478294/dippo"}, "edited": false, "score": 0, "creation_date": 1608762300, "post_id": 54428869, "comment_id": 115680516, "body": "@Dippo, were you writing into a zip file? I have this same problem right now, especially with a streaming response."}, {"owner": {"reputation": 194, "user_id": 1478294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b079763724f5d11cd9381594bb925d?s=128&d=identicon&r=PG", "display_name": "Dippo", "link": "https://stackoverflow.com/users/1478294/dippo"}, "reply_to_user": {"reputation": 1704, "user_id": 2912740, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4730dc939ce11655d239d1f54a9cd399?s=128&d=identicon&r=PG&f=1", "display_name": "Edwinner", "link": "https://stackoverflow.com/users/2912740/edwinner"}, "edited": false, "score": 0, "creation_date": 1609117734, "post_id": 54428869, "comment_id": 115751909, "body": "@Edwinner No, not a zip file."}], "owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 407, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1548793822, "creation_date": 1548792635, "last_edit_date": 1548793822, "question_id": 54428869, "link": "https://stackoverflow.com/questions/54428869/golang-copy-files-takes-too-much-time", "title": "golang copy files takes too much time", "body": "<p>I use the following code to copy files which works OK\nThe problem is that when we use this method to copy folder and items like node_js project with node_modules inside\nin <strong>windows</strong> this can take a long time about <strong>40 sec</strong> and in mac it takes <strong>2 sec</strong>.\nwhen doing trace (print the copied files) we saw that for example the <code>io.copy</code> took 5 sec to copy short readme file\nor json file , in each run it get s<strong>tuck on different files</strong> , small size files like json readme etch\nthis is <strong>not consistent</strong>, in <strong>different run</strong> it stuck on <strong>different files</strong> ( if you run on same project).</p>\n\n<p>we checked it on 3 different windows10  machine ( 1-3 years old) and 2 different macbook (3 years old)\non <strong>exact same project</strong>. What it can be ? </p>\n\n<pre><code>func walk(src string, baseDir string, archive *zip.Writer) error {\n   return filepath.Walk(src, func(path string, info os.FileInfo, err error) (e error) {\n      if err != nil {\n         return err\n      }\n\n      if info.IsDir() {\n         return\n      }\n\n      header, err := zip.FileInfoHeader(info)\n      if err != nil {\n         return err\n      }\n      if baseDir != \"\" {\n         header.Name = filepath.ToSlash(getRelativePath(path, baseDir))\n      }\n\n      header.Method = zip.Deflate\n      writer, err := archive.CreateHeader(header)\n      if err != nil {\n         return err\n      }\n\n      file, err := os.Open(path)\n      if err != nil {\n         return err\n      }\n      defer func() {\n         e = CloseFile(file, e)\n      }()\n\n      _, err = io.Copy(writer, file)\n      return err\n   })\n}\n</code></pre>\n\n<p>we are checking it almost 4 days and we didnt find any pattern :(</p>\n"}, {"tags": ["go", "types", "error-handling", "return-value", "multiple-return-values"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1548776567, "post_id": 54424559, "comment_id": 95659489, "body": "You should start with <a href=\"https://tour.golang.org/\" rel=\"nofollow noreferrer\">A Tour of Go</a>."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1548776979, "post_id": 54424559, "comment_id": 95659750, "body": "This is all just following the language spec. Just read it. If you are asking for \u201ewhy that way and not the way I expect it \u201c : that would be OT"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1548777292, "post_id": 54424559, "comment_id": 95659969, "body": "The language spec is written in a very formal style so it&#39;s not the easiest thing to read but it is wonderfully short. Languages like Java, C# and Ruby have specs five to ten times as long or more."}], "answers": [{"comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1548776990, "post_id": 54424716, "comment_id": 95659759, "body": "And Q3 is a slice literal, which doesn&#39;t support variadic &quot;parameters&quot; at all (because the values are not parameters)."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1548777099, "post_id": 54424716, "comment_id": 95659838, "body": "Indeed, added to the answer for clarity."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 4, "last_activity_date": 1548777083, "last_edit_date": 1548777083, "creation_date": 1548776739, "answer_id": 54424716, "question_id": 54424559, "link": "https://stackoverflow.com/questions/54424559/how-does-go-determine-the-context-in-which-multiple-values-can-be-used/54424716#54424716", "title": "How does Go determine the context in which multiple values can be used?", "body": "<p>This is why syntactic sugar is avoided by the Go designers; it leads to confusion when you expect more sugar than there is. You're seeing two types of syntactic sugar in Go here; exploding a slice to pass to a variadic function, and passing multiple return values to a function.</p>\n\n<p>Exploding a slice to a variadic function is documented here: <a href=\"https://golang.org/ref/spec#Passing_arguments_to_..._parameters\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Passing_arguments_to_..._parameters</a> and the key detail is:</p>\n\n<blockquote>\n  <p>If the final argument is assignable to a slice type []T, it may be passed unchanged as the value for a ...T parameter if the argument is followed by .... In this case no new slice is created.</p>\n</blockquote>\n\n<p><code>fmt.Println</code> is a function with a single, variadic parameter. That means you can either pass it individual items, or <em>a single item</em> which is a declared slice with the <code>...</code> explosion operator appended, in which case that slice will be passed unchanged. It can't be a slice literal, and it can't follow other parameters, in order to utilize this helper.</p>\n\n<p>The other is documented here: <a href=\"https://golang.org/ref/spec#Calls\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Calls</a> specifically:</p>\n\n<blockquote>\n  <p>As a special case, if the return values of a function or method g are equal in number and individually assignable to the parameters of another function or method f, then the call f(g(parameters_of_g)) will invoke f after binding the return values of g to the parameters of f in order. The call of f must contain no parameters other than the call of g, and g must have at least one return value. If f has a final ... parameter, it is assigned the return values of g that remain after assignment of regular parameters.</p>\n</blockquote>\n\n<p>Again, because <code>fmt.Println</code> has a single, variadic parameter, you can't mix and match passing specific values with using the above syntactic sugar for passing a multi-value return straight through to the parameters of another function.</p>\n\n<p>As Peter notes, \"And Q3 is a slice literal, which doesn't support variadic \"parameters\" at all (because the values are not parameters).\" The syntactic sugar above for passing multiple returns to a function doesn't apply to a slice literal simply because it is not a function at all.</p>\n"}], "owner": {"reputation": 598, "user_id": 9552116, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Coconut", "link": "https://stackoverflow.com/users/9552116/coconut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "accepted_answer_id": 54424716, "answer_count": 1, "score": 2, "last_activity_date": 1548777083, "creation_date": 1548776211, "question_id": 54424559, "link": "https://stackoverflow.com/questions/54424559/how-does-go-determine-the-context-in-which-multiple-values-can-be-used", "title": "How does Go determine the context in which multiple values can be used?", "body": "<pre><code>package main\n\nimport \"fmt\"\n\nfunc multipleRets() (int, int, int, int) {\n    return 11, 22, 33, 44\n}\n\nfunc main() {\n    // Q1\n    fmt.Println(multipleRets())    // This is fine.\n    fmt.Println(1, multipleRets()) // But this one errors.\n\n    // Q2\n    s1 := append([]int{}, []int{11, 22, 33, 44}...) // This is fine.\n    s2 := append([]int{}, multipleRets())           // But this one errors.\n\n    // Q3\n    lit1 := []int{11, 22, 33, 44} // This is fine.\n    lit2 := []int{multipleRets()} // But this one errors.\n\n    // Q4\n    fmt.Println(1, []int{11, 22, 33, 44})    // This is fine.\n    fmt.Println(1, []int{11, 22, 33, 44}...) // But this one errors.\n}\n</code></pre>\n\n<p>There are 4 errors in a source code above, all of which complaining that multiple elements cannot be put in a function/literal.</p>\n\n<p>But having the other examples in my mind, I can't really find a reason for those errors to be considered error.</p>\n\n<p>Shouldn't they be fine? What does it mean when Go gives an error like that saying \"multiple-value in single-value context\"?</p>\n\n<p>And the way those three pernicious dots work, how does that make sense? What exactly does <code>...</code> do?</p>\n"}, {"tags": ["if-statement", "go", "input"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 4, "creation_date": 1548774569, "post_id": 54423896, "comment_id": 95658172, "body": "Don&#39;t ignore errors! What is the actual value of <code>doDeposite</code>?"}, {"owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "edited": false, "score": 2, "creation_date": 1548774966, "post_id": 54423896, "comment_id": 95658484, "body": "What do you expect it to do? You forgot to trim depositeAmount at least."}, {"owner": {"reputation": 46, "user_id": 10545276, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IY8nk7WyXDc/AAAAAAAAAAI/AAAAAAAAA-4/IXXK3T-6508/photo.jpg?sz=128", "display_name": "Benny Mac", "link": "https://stackoverflow.com/users/10545276/benny-mac"}, "edited": false, "score": 0, "creation_date": 1548780037, "post_id": 54423896, "comment_id": 95661662, "body": "The lines with <code>+=</code> are likely wrong. I suspect you wanted <code>balance += da</code> / <code>balance += wa</code>."}], "answers": [{"comments": [{"owner": {"reputation": 46, "user_id": 10545276, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IY8nk7WyXDc/AAAAAAAAAAI/AAAAAAAAA-4/IXXK3T-6508/photo.jpg?sz=128", "display_name": "Benny Mac", "link": "https://stackoverflow.com/users/10545276/benny-mac"}, "edited": false, "score": 1, "creation_date": 1548780584, "post_id": 54424308, "comment_id": 95661992, "body": "Your code is still using <code>ReadString()</code> methods, whereas I suspect you meant to use <code>ReadLine()</code>. I&#39;d probably recommend using <code>bufio.Scanner()</code> type, anyway."}], "tags": [], "owner": {"reputation": 31, "user_id": 10907484, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hBlAYhRRG7M/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYdy3Q9Rf-LI2oRov1WHyOYI5hSVQ/mo/photo.jpg?sz=128", "display_name": "Sebastian Lusenti", "link": "https://stackoverflow.com/users/10907484/sebastian-lusenti"}, "is_accepted": false, "score": 3, "last_activity_date": 1549021121, "last_edit_date": 1592644375, "creation_date": 1548775430, "answer_id": 54424308, "question_id": 54423896, "link": "https://stackoverflow.com/questions/54423896/if-statement-always-being-skipped/54424308#54424308", "title": "if statement always being skipped", "body": "<p>try to use  ReadLine() method instead of ReadString()</p>\n<p>the doc say</p>\n<blockquote>\n<p>ReadLine tries to return a single line, <strong>not including</strong> the end-of-line bytes.</p>\n<p>ReadString reads until the first occurrence of delim in the input, returning a string containing the data up to and <strong>including</strong> the delimiter</p>\n</blockquote>\n<p>Here is the updated <code>deposit</code> code for reference:</p>\n<pre><code>[...]\n    fmt.Print(&quot;How much would you like to deposit? &quot;)\n    depositAmount, _, err := reader.ReadLine()\n    if err != nil {\n      fmt.Printf(&quot;ReadLine() error: '%s'&quot;, err)\n    }\n    da, err := strconv.Atoi(string(depositAmount))\n    if err != nil {\n      fmt.Printf(&quot;strconv error: '%s'&quot;, err)\n    }\n    balance += balance + da\n    fmt.Print(&quot;Your balance is &quot;, balance)\n[...]\n</code></pre>\n<p>Alternatively, you could trim based on which OS are you executing your code.</p>\n<pre><code>if runtime.GOOS == &quot;windows&quot; {\n  input = strings.TrimRight(input, &quot;\\r\\n&quot;)\n} else {\n  input = strings.TrimRight(input, &quot;\\n&quot;)\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9697920, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XdH_Q4OPrak/AAAAAAAAAAI/AAAAAAAADxc/248GpQ0QZ8c/photo.jpg?sz=128", "display_name": "Aliah Evans", "link": "https://stackoverflow.com/users/9697920/aliah-evans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549021121, "creation_date": 1548774155, "last_edit_date": 1548775403, "question_id": 54423896, "link": "https://stackoverflow.com/questions/54423896/if-statement-always-being-skipped", "title": "if statement always being skipped", "body": "<p>I'm trying to make a basic little banking program to get my bearing with Go. I run the program and when I type in my answer for either of the if statements, the program just moves on. Any solutions?</p>\n\n<p>here's my code:</p>\n\n<pre><code>package main\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"strconv\"\n    \"strings\"\n)\n\nfunc main() {\n    reader := bufio.NewReader(os.Stdin)\n    fmt.Print(\"Enter your name: \")\n    name, _ := reader.ReadString('\\n')\n    fmt.Print(\"Hello \", name)\n    balance := 0\n    fmt.Print(\"Do you want to deposite? (y/n) \")\n    doDeposite, _ := reader.ReadString('\\n')\n    if strings.TrimRight(doDeposite, \"\\n\") == \"y\" {\n        fmt.Print(\"How much would you like to deposite? \")\n        depositeAmount, _ := reader.ReadString('\\n')\n        da, _ := strconv.Atoi(depositeAmount)\n        balance += balance + da\n        fmt.Print(\"Your balance is \", balance)\n    } else {\n        fmt.Print(\"Would you like to withdraw?(y/n) \")\n        doWithdraw, _ := reader.ReadString('\\n')\n        if strings.TrimRight(doWithdraw, \"\\n\") == \"y\" {\n            fmt.Print(\"How much would you like to withdraw? \")\n            withdrawAmount, _ := reader.ReadString('\\n')\n            wa, _ := strconv.Atoi(withdrawAmount)\n            balance += balance + wa\n            fmt.Print(\"Your balance is \", balance)\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["xml", "parsing", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1548777021, "post_id": 54423402, "comment_id": 95659780, "body": "I&#39;m not sure if this can be done with just using tags, but it certainly can be done with a custom unmarshaler (<a href=\"https://play.golang.org/p/2IGeJEyP98z\" rel=\"nofollow noreferrer\">play.golang.org/p/2IGeJEyP98z</a>)."}], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 1, "last_activity_date": 1548806053, "creation_date": 1548806053, "answer_id": 54431417, "question_id": 54423402, "link": "https://stackoverflow.com/questions/54423402/how-to-parse-xml-with-nested-nodes-of-the-same-name/54431417#54431417", "title": "How to parse XML with nested nodes of the same name?", "body": "<p>You could implement a custom <a href=\"https://golang.org/pkg/encoding/xml/#Unmarshaler\" rel=\"nofollow noreferrer\"><code>xml.Unmarshaler</code></a> to get the results you want.</p>\n\n<pre><code>type Rate struct {\n    Currency string `xml:\"currency,attr\"`\n    Rate     string `xml:\"rate,attr\"`\n    Date     string `xml:\"time,attr\"`\n}\n\ntype Rates struct {\n    Rates RateList `xml:\"Cube&gt;Cube\"`\n}\n\ntype RateList []Rate\n\nfunc (ls *RateList) UnmarshalXML(d *xml.Decoder, start xml.StartElement) error {\n    date := start.Attr[0].Value\n\n    for {\n        tok, err := d.Token()\n        if err != nil {\n            if err == io.EOF {\n                return nil\n            }\n            return err\n        }\n\n        if se, ok := tok.(xml.StartElement); ok {\n            rate := Rate{Date: date}\n            if err := d.DecodeElement(&amp;rate, &amp;se); err != nil {\n                return err\n            }\n\n            *ls = append(*ls, rate)\n        }\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/2IGeJEyP98z\" rel=\"nofollow noreferrer\">Go Playground</a></p>\n"}, {"tags": [], "owner": {"reputation": 810, "user_id": 10989396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4caa8f53ec0ebff61132b4cb58539467?s=128&d=identicon&r=PG&f=1", "display_name": "hyperTrashPanda", "link": "https://stackoverflow.com/users/10989396/hypertrashpanda"}, "is_accepted": false, "score": 0, "last_activity_date": 1548843518, "creation_date": 1548843518, "answer_id": 54438197, "question_id": 54423402, "link": "https://stackoverflow.com/questions/54423402/how-to-parse-xml-with-nested-nodes-of-the-same-name/54438197#54438197", "title": "How to parse XML with nested nodes of the same name?", "body": "<p>I agree with mkopriva's answer, but cannot comment so I'm adding a reply.</p>\n\n<p>Make sure that you either trust the XML, or that you validate/sanitize it beforehand, with something like <a href=\"https://github.com/metaleap/go-xsd\" rel=\"nofollow noreferrer\">XSD</a>. This should be done for both security reasons, as well as to be able to look back and see if the data you \"Unmarshalled\" is correct, because when you're processing huge amounts of XML, some of it is bound to be broken.</p>\n"}], "owner": {"reputation": 932, "user_id": 279183, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/5df43f2d159d197c4ae9dbd8d9280b3c?s=128&d=identicon&r=PG&f=1", "display_name": "adredx", "link": "https://stackoverflow.com/users/279183/adredx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 54431417, "answer_count": 2, "score": 1, "last_activity_date": 1548843518, "creation_date": 1548772643, "last_edit_date": 1548773090, "question_id": 54423402, "link": "https://stackoverflow.com/questions/54423402/how-to-parse-xml-with-nested-nodes-of-the-same-name", "title": "How to parse XML with nested nodes of the same name?", "body": "<p>I'm new to Golang and parsing XML with nested nodes of the same name is too difficult to me. This is a XML pulled from a third party API:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;gesmes:Envelope xmlns:gesmes=\"http://www.gesmes.org/xml/2002-08-01\" xmlns=\"http://www.ecb.int/vocabulary/2002-08-01/eurofxref\"&gt;\n    &lt;gesmes:subject&gt;Reference rates&lt;/gesmes:subject&gt;\n    &lt;gesmes:Sender&gt;\n        &lt;gesmes:name&gt;European Central Bank&lt;/gesmes:name&gt;\n    &lt;/gesmes:Sender&gt;\n    &lt;Cube&gt;\n        &lt;Cube time=\"2019-01-28\"&gt;\n            &lt;Cube currency=\"USD\" rate=\"1.1418\"/&gt;\n            &lt;Cube currency=\"JPY\" rate=\"124.94\"/&gt;\n            &lt;Cube currency=\"BGN\" rate=\"1.9558\"/&gt;\n        &lt;/Cube&gt;\n        &lt;Cube time=\"2019-01-25\"&gt;\n            &lt;Cube currency=\"USD\" rate=\"1.1346\"/&gt;\n            &lt;Cube currency=\"JPY\" rate=\"124.72\"/&gt;\n            &lt;Cube currency=\"BGN\" rate=\"1.9558\"/&gt;\n        &lt;/Cube&gt;\n    &lt;/Cube&gt;\n&lt;/gesmes:Envelope&gt;\n</code></pre>\n\n<p>I need to parse it so I have an output like this:</p>\n\n<pre><code>&amp;{Rates:[{Currency:USD Rate:1.1418 Date:2019-01-28} {Currency:JPY Rate:124.94 Date:2019-01-28} {Currency:BGN Rate:1.9558 Date:2019-01-28} {Currency:USD Rate:1.1346 Date:2019-01-25} {Currency:JPY Rate:124.72 Date:2019-01-25} {Currency:BGN Rate:1.9558 Date:2019-01-25}]}\n</code></pre>\n\n<p>And here's my code:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n)\n\n\ntype Rate struct {\n    Currency  string `xml:\"currency,attr\"`\n    Rate      string `xml:\"rate,attr\"`\n    Date    string `xml:\"time,attr\"`\n}\n\ntype Rates struct {\n    Rates []Rate `xml:\"Cube&gt;Cube&gt;Cube\"`\n}\n\nfunc main() {\n    v := &amp;Rates{}\n    if err := xml.Unmarshal([]byte(src), v); err != nil {\n        panic(err)\n    }\n    fmt.Printf(\"%+v\\n\\n\", v)\n}\n\nconst src = `&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;gesmes:Envelope xmlns:gesmes=\"http://www.gesmes.org/xml/2002-08-01\" xmlns=\"http://www.ecb.int/vocabulary/2002-08-01/eurofxref\"&gt;\n    &lt;gesmes:subject&gt;Reference rates&lt;/gesmes:subject&gt;\n    &lt;gesmes:Sender&gt;\n        &lt;gesmes:name&gt;European Central Bank&lt;/gesmes:name&gt;\n    &lt;/gesmes:Sender&gt;\n    &lt;Cube&gt;\n        &lt;Cube time=\"2019-01-28\"&gt;\n            &lt;Cube currency=\"USD\" rate=\"1.1418\"/&gt;\n            &lt;Cube currency=\"JPY\" rate=\"124.94\"/&gt;\n            &lt;Cube currency=\"BGN\" rate=\"1.9558\"/&gt;\n        &lt;/Cube&gt;\n        &lt;Cube time=\"2019-01-25\"&gt;\n            &lt;Cube currency=\"USD\" rate=\"1.1346\"/&gt;\n            &lt;Cube currency=\"JPY\" rate=\"124.72\"/&gt;\n            &lt;Cube currency=\"BGN\" rate=\"1.9558\"/&gt;\n        &lt;/Cube&gt;\n    &lt;/Cube&gt;\n&lt;/gesmes:Envelope&gt;`\n</code></pre>\n\n<p>I'm out of ideas how to insert <code>time</code> attribute into Rates object. Any help would be appreciated.</p>\n\n<p>Here it is in golang <a href=\"https://play.golang.org/p/5NhJ3PUcjOs\" rel=\"nofollow noreferrer\">playground</a></p>\n"}, {"tags": ["perl", "go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1548771425, "post_id": 54422977, "comment_id": 95656008, "body": "Go has arrays, though you usually use slices. Go&#39;s hashes are called maps. There is no reason you can&#39;t create an array of maps or a map of arrays. Take the Go tour to get a handle on the basics: <a href=\"https://tour.golang.org\" rel=\"nofollow noreferrer\">tour.golang.org</a>"}, {"owner": {"reputation": 118, "user_id": 2542096, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w3iTP.png?s=128&g=1", "display_name": "jiri.hofman", "link": "https://stackoverflow.com/users/2542096/jiri-hofman"}, "edited": false, "score": 1, "creation_date": 1548772374, "post_id": 54422977, "comment_id": 95656602, "body": "Seems like similar question is <a href=\"https://stackoverflow.com/questions/43379772/making-array-of-hashes-in-golang\">already answered</a>"}, {"owner": {"reputation": 2799, "user_id": 1485311, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sNWZV.jpg?s=128&g=1", "display_name": "ChatterOne", "link": "https://stackoverflow.com/users/1485311/chatterone"}, "edited": false, "score": 1, "creation_date": 1548772415, "post_id": 54422977, "comment_id": 95656629, "body": "You can put a hash map into an array, just remember that Perl is one of the few languages (if not the only one) that supports auto-vivification. So, if you expect to have a dynamic hash that changes its structure and replicate that in golang, that&#39;s not going to work."}, {"owner": {"reputation": 35, "user_id": 4354065, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002060422067/picture?type=large", "display_name": "Raimonds Linde", "link": "https://stackoverflow.com/users/4354065/raimonds-linde"}, "edited": false, "score": 0, "creation_date": 1548832337, "post_id": 54422977, "comment_id": 95679492, "body": "Thanks everyone!  type host map[string]interface{}  and  var hosts []host  it is. I always search for all possible posts, but yesterday was kind of slow for me."}], "answers": [{"tags": [], "owner": {"reputation": 118, "user_id": 2542096, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w3iTP.png?s=128&g=1", "display_name": "jiri.hofman", "link": "https://stackoverflow.com/users/2542096/jiri-hofman"}, "is_accepted": false, "score": 1, "last_activity_date": 1548772718, "creation_date": 1548772718, "answer_id": 54423434, "question_id": 54422977, "link": "https://stackoverflow.com/questions/54422977/how-to-recreate-perls-array-of-hashes-in-golang/54423434#54423434", "title": "How to recreate perl&#39;s array of hashes in golang?", "body": "<pre><code>var array = []map[string]interface{}{\n    {\"address\": \"test.com\", \"hostgroups\": []string{\"zero\", \"one\", \"or many\"}, \"id\": 101},\n    {\"address\": \"test2.com\", \"hostgroups\": []string{\"zero\", \"one\", \"or many\"}, \"id\": 102},\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 4354065, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002060422067/picture?type=large", "display_name": "Raimonds Linde", "link": "https://stackoverflow.com/users/4354065/raimonds-linde"}, "is_accepted": false, "score": 0, "last_activity_date": 1548832667, "creation_date": 1548832667, "answer_id": 54435160, "question_id": 54422977, "link": "https://stackoverflow.com/questions/54422977/how-to-recreate-perls-array-of-hashes-in-golang/54435160#54435160", "title": "How to recreate perl&#39;s array of hashes in golang?", "body": "<p>This is the answer.</p>\n\n<pre><code>type host map[string]interface{}\n\nvar hosts []host\n\nh := host{\n    \"id\":         id,\n    \"file_id\":    \"etc/config/hosts.cfg\",\n    \"host_name\":  host_name,\n    \"alias\":      host_name,\n    \"address\":    host_name,\n    \"hostgroups\": hg,\n    \"template\":   \"generic-host\",\n}\n\nhosts = append(hosts, h)\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4354065, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002060422067/picture?type=large", "display_name": "Raimonds Linde", "link": "https://stackoverflow.com/users/4354065/raimonds-linde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1548832667, "creation_date": 1548771200, "question_id": 54422977, "link": "https://stackoverflow.com/questions/54422977/how-to-recreate-perls-array-of-hashes-in-golang", "title": "How to recreate perl&#39;s array of hashes in golang?", "body": "<p>In perl I can push $hashref into @array and have this data for next foreach and possible encode_json (HTTP POST).</p>\n\n<p>I can't figure out how to recreate the same login in golang?</p>\n\n<pre><code>$VAR1 = [\n      {\n        'address' =&gt; 'test.com',\n        'id' =&gt; 101,\n        'hostgroups' =&gt; [\n                          zero\n                          'one',\n                          'or many'\n                        ],\n        'host_name' =&gt; 'test.com',\n        'alias' =&gt; 'test.com',\n        'template' =&gt; 'generic',\n        'file_id' =&gt; 'etc/config'\n      },\n      {\n        'address' =&gt; 'test2.com',\n        'id' =&gt; 102,\n        'hostgroups' =&gt; [\n                          zero\n                          'one',\n                          'or many'\n                        ],\n        'host_name' =&gt; 'test2.com',\n        'alias' =&gt; 'test2.com',\n        'template' =&gt; 'generic',\n        'file_id' =&gt; 'etc/config'\n      },\n      (..)\n</code></pre>\n"}, {"tags": ["regex", "go", "pattern-matching"], "answers": [{"comments": [{"owner": {"reputation": 1068, "user_id": 1866480, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6568eb1ab2ac8054511dedd643e09643?s=128&d=identicon&r=PG", "display_name": "Nitzankin", "link": "https://stackoverflow.com/users/1866480/nitzankin"}, "edited": false, "score": 0, "creation_date": 1548777834, "post_id": 54424952, "comment_id": 95660308, "body": "Yes, I found that to be the case. Also explains that regex is not the tool for byte pattern matching."}, {"owner": {"reputation": 10507, "user_id": 56686, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9nKtX.jpg?s=128&g=1", "display_name": "Mattias Wadman", "link": "https://stackoverflow.com/users/56686/mattias-wadman"}, "reply_to_user": {"reputation": 1068, "user_id": 1866480, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6568eb1ab2ac8054511dedd643e09643?s=128&d=identicon&r=PG", "display_name": "Nitzankin", "link": "https://stackoverflow.com/users/1866480/nitzankin"}, "edited": false, "score": 0, "creation_date": 1548843504, "post_id": 54424952, "comment_id": 95685699, "body": "I know there are regexp/automata implementations that are byte oriented. But yeah maybe the standard regular expression syntax is not that suitable."}], "tags": [], "owner": {"reputation": 10507, "user_id": 56686, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9nKtX.jpg?s=128&g=1", "display_name": "Mattias Wadman", "link": "https://stackoverflow.com/users/56686/mattias-wadman"}, "is_accepted": true, "score": 3, "last_activity_date": 1548793358, "last_edit_date": 1548793358, "creation_date": 1548777488, "answer_id": 54424952, "question_id": 54422804, "link": "https://stackoverflow.com/questions/54422804/why-do-these-bit-wise-regex-expressions-match-differently-in-golang/54424952#54424952", "title": "Why do these bit-wise regex expressions match differently in golang?", "body": "<p>The <a href=\"https://golang.org/pkg/regexp/\" rel=\"nofollow noreferrer\">regexp</a> documentation states that:</p>\n\n<blockquote>\n  <p>All characters are UTF-8-encoded code points.</p>\n</blockquote>\n\n<p>So I think the character class ranges will be unicode code points ranges and not byte ranges. Also the matched text is treated as UTF-8 so i'm not sure what will happen at <code>data = []byte{... , 0xdd, ...}</code>. It might be decoded as a code point greater than <code>0xff</code>. So i'm not sure how well it will work to use the standard library regexp package to do binary matching.</p>\n\n<p>A side note <code>(?P&lt;Payload&gt;.+)</code> will not match all code points but <code>(?P&lt;Payload&gt;(?s).+)</code> will. <code>s</code> flag is:</p>\n\n<blockquote>\n  <p>let . match \\n (default false)</p>\n</blockquote>\n\n<p>Hope that helps</p>\n"}], "owner": {"reputation": 1068, "user_id": 1866480, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6568eb1ab2ac8054511dedd643e09643?s=128&d=identicon&r=PG", "display_name": "Nitzankin", "link": "https://stackoverflow.com/users/1866480/nitzankin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 329, "favorite_count": 0, "accepted_answer_id": 54424952, "answer_count": 1, "score": 1, "last_activity_date": 1548793358, "creation_date": 1548770580, "question_id": 54422804, "link": "https://stackoverflow.com/questions/54422804/why-do-these-bit-wise-regex-expressions-match-differently-in-golang", "title": "Why do these bit-wise regex expressions match differently in golang?", "body": "<p>Given this binary data and two regular expressions, why does golang match them differently?</p>\n\n<pre><code>var (\n    data = []byte{0x03, 0x00, 0x00, 0x88, 0x02, 0xf0, 0x80, 0x72, 0x03, 0x00, 0x79, 0x20, 0xdd, 0x39, 0x22, 0x4d, 0xcf, 0x6d, 0x17, 0x29, 0x02, 0xee, 0xe3, 0x7f, 0x5e, 0xca, 0x17, 0x62, 0xc8, 0x56, 0x24, 0x01, 0x1e, 0x9f, 0xa0, 0x96, 0xc6, 0x4f, 0xbb, 0xa2, 0x51, 0x7b, 0xbf, 0x33, 0x31, 0x00, 0x00, 0x05, 0x4c, 0x00, 0x00, 0x1a, 0x6a, 0x00, 0x00, 0x03, 0x8d, 0x34, 0x00, 0x00, 0x00, 0x00, 0x04, 0x14, 0x81, 0xe7, 0x86, 0xa7, 0x76, 0x51, 0x02, 0x9d, 0x18, 0x09, 0xff, 0xde, 0xde, 0x05, 0x51, 0x02, 0x9d, 0x18, 0x0a, 0x89, 0xee, 0xf8, 0x81, 0x53, 0x51, 0x02, 0x9d, 0x18, 0x0b, 0x82, 0xce, 0xef, 0xad, 0x63, 0x51, 0x02, 0x9d, 0x18, 0x0c, 0x00, 0x00, 0x04, 0xe8, 0x89, 0x69, 0x00, 0x12, 0x00, 0x00, 0x00, 0x00, 0x89, 0x6a, 0x00, 0x13, 0x00, 0x89, 0x6b, 0x00, 0x04, 0x00, 0x00, 0xb4, 0x62, 0x00, 0x00, 0x00, 0x00, 0x72, 0x03, 0x00, 0x00}\n\n    regexA = regexp.MustCompile(`\\x72\\x03(?P&lt;TLen&gt;[\\x00-\\xFF]{2})(?P&lt;Payload&gt;[\\x00-\\xFF]+)`)\n    regexB = regexp.MustCompile(`\\x72\\x03(?P&lt;TLen&gt;[\\x00-\\xFF]{2})(?P&lt;Payload&gt;.+)`)\n)\n</code></pre>\n\n<p>Shouldn't <code>regexA</code>'s <code>[\\x00-\\xFF]+</code> match as good as <code>regexB</code>'s <code>.+</code>?</p>\n\n<p>I'm testing using this:</p>\n\n<pre><code>func main() {\n    log.Printf(\"testing regexA\")\n    applyRegex(regexA)\n    log.Printf(\"testing regexB\")\n    applyRegex(regexB)\n}\n\nfunc applyRegex(r *regexp.Regexp) {\n\n    matches := r.FindAllSubmatch(data, -1)\n    groups := r.SubexpNames()\n\n    for mIdx, match := range matches {\n        findings := smap{}\n        for idx, submatch := range match {\n            findings[groups[idx]] = fmt.Sprintf(\"% x\", submatch)\n        }\n        log.Printf(\"match #%d: %+v\", mIdx, findings)\n    }\n}\n</code></pre>\n\n<p>And getting this output:</p>\n\n<pre><code>2009/11/10 23:00:00 testing regexA\n2009/11/10 23:00:00 match #0: map[:72 03 00 79 20 TLen:00 79 Payload:20]\n2009/11/10 23:00:00 testing regexB\n2009/11/10 23:00:00 match #0: map[:72 03 00 79 20 dd 39 22 4d cf 6d 17 29 02 ee e3 7f 5e ca 17 62 c8 56 24 01 1e 9f a0 96 c6 4f bb a2 51 7b bf 33 31 00 00 05 4c 00 00 1a 6a 00 00 03 8d 34 00 00 00 00 04 14 81 e7 86 a7 76 51 02 9d 18 09 ff de de 05 51 02 9d 18 TLen:00 79 Payload:20 dd 39 22 4d cf 6d 17 29 02 ee e3 7f 5e ca 17 62 c8 56 24 01 1e 9f a0 96 c6 4f bb a2 51 7b bf 33 31 00 00 05 4c 00 00 1a 6a 00 00 03 8d 34 00 00 00 00 04 14 81 e7 86 a7 76 51 02 9d 18 09 ff de de 05 51 02 9d 18]\n</code></pre>\n\n<p>Is parsing binary data using regex not an actual possibility?</p>\n\n<p>Playground link: <a href=\"https://play.golang.org/p/gHWqeyPuPNJ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/gHWqeyPuPNJ</a></p>\n"}, {"tags": ["firebase", "go", "firebase-cloud-messaging"], "comments": [{"owner": {"reputation": 5957, "user_id": 5898696, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/AskSA.jpg?s=128&g=1", "display_name": "J-Alex", "link": "https://stackoverflow.com/users/5898696/j-alex"}, "edited": false, "score": 0, "creation_date": 1548770975, "post_id": 54422754, "comment_id": 95655670, "body": "Show us your code."}, {"owner": {"reputation": 27, "user_id": 10984946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8607982def9bf7c3bb9cc8221891c66c?s=128&d=identicon&r=PG&f=1", "display_name": "censon", "link": "https://stackoverflow.com/users/10984946/censon"}, "reply_to_user": {"reputation": 5957, "user_id": 5898696, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/AskSA.jpg?s=128&g=1", "display_name": "J-Alex", "link": "https://stackoverflow.com/users/5898696/j-alex"}, "edited": false, "score": 0, "creation_date": 1548773991, "post_id": 54422754, "comment_id": 95657773, "body": "I&#39;ve added the message constructor and the responses. The only thing that ever changes on the Send() is the token within the message."}, {"owner": {"reputation": 2133, "user_id": 7436566, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VxBgdn2E0Qk/AAAAAAAAAAI/AAAAAAAAAIg/H8mCkOR8q_k/photo.jpg?sz=128", "display_name": "OhhhThatVarun", "link": "https://stackoverflow.com/users/7436566/ohhhthatvarun"}, "edited": false, "score": 0, "creation_date": 1570271060, "post_id": 54422754, "comment_id": 102865826, "body": "Dude your question solved my issue! :D"}, {"owner": {"reputation": 27, "user_id": 10984946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8607982def9bf7c3bb9cc8221891c66c?s=128&d=identicon&r=PG&f=1", "display_name": "censon", "link": "https://stackoverflow.com/users/10984946/censon"}, "edited": false, "score": 0, "creation_date": 1570360214, "post_id": 54422754, "comment_id": 102882329, "body": "That&#39;s great! What was the solution? I forgot to update this question with the answer I found, which was that <code>device group tokens</code> were no longer supported. They were a feature of the v1 API, but are no longer used now."}], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 10984946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8607982def9bf7c3bb9cc8221891c66c?s=128&d=identicon&r=PG&f=1", "display_name": "censon", "link": "https://stackoverflow.com/users/10984946/censon"}, "is_accepted": false, "score": 1, "last_activity_date": 1570360290, "creation_date": 1570360290, "answer_id": 58256672, "question_id": 54422754, "link": "https://stackoverflow.com/questions/54422754/firebase-push-notifications-only-showing-from-when-sending-to-device-group-tok/58256672#58256672", "title": "Firebase Push notifications only showing &quot;from&quot; when sending to device group token", "body": "<p>Device group tokens were no longer supported. They were a feature of the v1 API, but are no longer used now, which is why this was not working. The Firebase docs aren't great and it took some serious digging to find this out. </p>\n"}], "owner": {"reputation": 27, "user_id": 10984946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8607982def9bf7c3bb9cc8221891c66c?s=128&d=identicon&r=PG&f=1", "display_name": "censon", "link": "https://stackoverflow.com/users/10984946/censon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1570360290, "creation_date": 1548770387, "last_edit_date": 1548775975, "question_id": 54422754, "link": "https://stackoverflow.com/questions/54422754/firebase-push-notifications-only-showing-from-when-sending-to-device-group-tok", "title": "Firebase Push notifications only showing &quot;from&quot; when sending to device group token", "body": "<p>I'm developing a service for handling push notifications that integrates with Firebase cloud messaging. When I send a new message and specify a device token, it works fine. I get the notification title, body etc. However, when I specifiy a device group ID (which I get as a response when I register a new group with the device token), the device gets a notification, but it's blank - only showing the \"from\" field which is the sender ID. None of the notification title, body etc. show.</p>\n\n<p>Code for message construction</p>\n\n<pre><code>func FcmNewMessage(title, body, collapseKey, token string) *messaging.Message {\n    oneHour := time.Duration(1) * time.Hour\n    message := &amp;messaging.Message{\n        Notification: &amp;messaging.Notification{\n            Title: title,\n            Body:  body,\n        },\n        Android: &amp;messaging.AndroidConfig{\n            TTL:         &amp;oneHour,\n            CollapseKey: collapseKey,\n        },\n        APNS: &amp;messaging.APNSConfig{\n            Headers: map[string]string{\n                \"apns-collapse-id\": collapseKey,\n            },\n        },\n        Webpush: &amp;messaging.WebpushConfig{\n            Notification: &amp;messaging.WebpushNotification{\n                Icon: \"https://my-server/icon.png\",\n            },\n            Headers: map[string]string{\n                \"urgency\": \"high\",\n                \"topic\":   collapseKey,\n            },\n        },\n        Token: token,\n    }\n    return message\n}\n</code></pre>\n\n<p>As you can see above -  \"token\" argument can either be a device token or a device group notification key token. It's when the device group token is used that there is issues.</p>\n\n<p>Below are the client notifications:</p>\n\n<p>When using the device token:</p>\n\n<pre><code>{\n  \"from\": \"53xxxxxxxxxx\",\n  \"priority\": \"high\",\n  \"notification\": {\n    \"title\": \"test\",\n    \"body\": \"test\",\n    \"icon\": \"https://my-server/icon.png\"\n  },\n  \"collapse_key\": \"collapseMe\"\n}\n</code></pre>\n\n<p>When using device group token:</p>\n\n<pre><code>{\n  \"from\": \"53xxxxxxxxxx\"\n}\n</code></pre>\n\n<p>I should also mention that when a device group token is used, the response I get from FCM is:</p>\n\n<pre><code>projects/projectid-123/messages/\n</code></pre>\n\n<p>So there is no message ID at the end. Normally the response would be:</p>\n\n<pre><code>projects/projectid-123/messages/&lt;messageId&gt;\n</code></pre>\n"}, {"tags": ["go", "concurrency", "stdin", "keypress", "nonblocking"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1548770157, "post_id": 54422309, "comment_id": 95655135, "body": "You could just use <code>os.Stdin.Read()</code> to read bytes off the wire. Your code explicitly wraps it and goes around it in order to buffer up to the next time the user presses enter."}], "answers": [{"tags": [], "owner": {"reputation": 5906, "user_id": 198825, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/aba9dac582a7e4346b1895366200e2f2?s=128&d=identicon&r=PG", "display_name": "noamt", "link": "https://stackoverflow.com/users/198825/noamt"}, "is_accepted": false, "score": 1, "last_activity_date": 1548773622, "last_edit_date": 1548773622, "creation_date": 1548773026, "answer_id": 54423534, "question_id": 54422309, "link": "https://stackoverflow.com/questions/54422309/how-to-catch-keypress-without-enter-in-golang-loop/54423534#54423534", "title": "How to catch keypress without enter in Golang loop", "body": "<p>Because you're using <code>ReadString</code> which expects whichever parameter you give it, in your case - the <code>return</code> key.\nAccording to <a href=\"https://golang.org/pkg/bufio/#Reader.ReadString\" rel=\"nofollow noreferrer\">the docs</a>:</p>\n\n<blockquote>\n  <p>ReadString reads until the first occurrence of delim in the input,\n  returning a string containing the data up to and including the\n  delimiter.</p>\n</blockquote>\n\n<p>This means that the method won't return until you hit the <code>return</code> key.</p>\n\n<p>You can use the regular <a href=\"https://golang.org/pkg/bufio/#Reader.Read\" rel=\"nofollow noreferrer\">Read</a> method instead, to read the characters you need.\nSee also this <a href=\"https://stackoverflow.com/questions/12363030/read-from-initial-stdin-in-go\">Stackoverflow question</a> for reference.</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 1988581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175de5ee4c37905e75358880c30cce2b?s=128&d=identicon&r=PG", "display_name": "PePa", "link": "https://stackoverflow.com/users/1988581/pepa"}, "edited": false, "score": 0, "creation_date": 1618116762, "post_id": 54423725, "comment_id": 118502103, "body": "Depends on an external utility, won&#39;t work on Windows for sure. But thanks for the code."}], "tags": [], "owner": {"reputation": 38454, "user_id": 1650012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a21bc05bb7df4e5c3cb4933e4f3072eb?s=128&d=identicon&r=PG", "display_name": "kramer65", "link": "https://stackoverflow.com/users/1650012/kramer65"}, "is_accepted": true, "score": 2, "last_activity_date": 1548773606, "creation_date": 1548773606, "answer_id": 54423725, "question_id": 54422309, "link": "https://stackoverflow.com/questions/54422309/how-to-catch-keypress-without-enter-in-golang-loop/54423725#54423725", "title": "How to catch keypress without enter in Golang loop", "body": "<p>Ok, after reading about os.Stdin.Read() and finding <a href=\"https://stackoverflow.com/a/17278776/1650012\">this answer</a> I created the following code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"time\"\n    \"os/exec\"\n)\n\nfunc main() {\n    ch := make(chan string)\n    go func(ch chan string) {\n        // disable input buffering\n        exec.Command(\"stty\", \"-F\", \"/dev/tty\", \"cbreak\", \"min\", \"1\").Run()\n        // do not display entered characters on the screen\n        exec.Command(\"stty\", \"-F\", \"/dev/tty\", \"-echo\").Run()\n        var b []byte = make([]byte, 1)\n        for {\n            os.Stdin.Read(b)\n            ch &lt;- string(b)\n        }\n    }(ch)\n\n    for {\n        select {\n            case stdin, _ := &lt;-ch:\n                fmt.Println(\"Keys pressed:\", stdin)\n            default:\n                fmt.Println(\"Working..\")\n        }\n        time.Sleep(time.Millisecond * 100)\n    }\n}\n</code></pre>\n\n<p>This works like a charm so I'm just posting for any future readers.</p>\n\n<p>Regardless, I wish you a beautiful day!</p>\n"}], "owner": {"reputation": 38454, "user_id": 1650012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a21bc05bb7df4e5c3cb4933e4f3072eb?s=128&d=identicon&r=PG", "display_name": "kramer65", "link": "https://stackoverflow.com/users/1650012/kramer65"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1389, "favorite_count": 0, "accepted_answer_id": 54423725, "answer_count": 2, "score": 3, "last_activity_date": 1548791158, "creation_date": 1548768892, "last_edit_date": 1548791158, "question_id": 54422309, "link": "https://stackoverflow.com/questions/54422309/how-to-catch-keypress-without-enter-in-golang-loop", "title": "How to catch keypress without enter in Golang loop", "body": "<p>I've got a loop in which some things happen according to the state it runs in (manual/automatic/learning). I now want to be able to let the program switch between these states by pressing the accompanying letters on the keyboard (\"m\" for manual, \"a\" for automatic and \"l\" for learning).</p>\n\n<p>So to do this I need to be able to catch a keypress during the loop and change the variable status accordingly. I now have the following, which can catch a keypress followed by an enter:</p>\n\n<pre><code>ch := make(chan string)\ngo func(ch chan string) {\n    reader := bufio.NewReader(os.Stdin)\n    for {\n        s, _ := reader.ReadString('\\n')\n        ch &lt;- s\n    }\n}(ch)\n\nfor {\n    select {\n        case stdin, _ := &lt;-ch:\n            fmt.Println(\"Keys pressed:\", stdin)\n        default:\n            fmt.Println(\"Working..\")\n    }\n    time.Sleep(time.Second)\n}\n</code></pre>\n\n<p>But the fact that I need to hit the enter button is not acceptable.</p>\n\n<p>Does anybody know a non-blocking way to catch a keypress of a normal letter (not a SIGINT) without the need to hit enter afterwards?</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3", "aws-sdk"], "answers": [{"comments": [{"owner": {"reputation": 935, "user_id": 10391130, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CBVYnKKBv5w/AAAAAAAAAAI/AAAAAAAAAEc/bw1Ub6elbng/photo.jpg?sz=128", "display_name": "Madhuka Wickramapala", "link": "https://stackoverflow.com/users/10391130/madhuka-wickramapala"}, "edited": false, "score": 0, "creation_date": 1548829578, "post_id": 54420448, "comment_id": 95678281, "body": "Is there a maximum limit of Concurrency and PartSize"}], "tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": true, "score": 4, "last_activity_date": 1548762741, "creation_date": 1548762741, "answer_id": 54420448, "question_id": 54420152, "link": "https://stackoverflow.com/questions/54420152/aws-s3-parallel-download-using-golang/54420448#54420448", "title": "AWS S3 parallel download using golang", "body": "<p>Try altering your NewDownLoader() to this.  See <a href=\"https://docs.aws.amazon.com/sdk-for-go/api/service/s3/s3manager/#NewDownloader\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/sdk-for-go/api/service/s3/s3manager/#NewDownloader</a></p>\n\n<pre><code>// Create a downloader with the session and custom options\ndownloader := s3manager.NewDownloader(sess, func(d *s3manager.Downloader) {\n     d.PartSize = 64 * 1024 * 1024 // 64MB per part\n     d.Concurrency = 4\n})\n</code></pre>\n\n<p>List of Options that can be set with d. in the func can be found here\n<a href=\"https://docs.aws.amazon.com/sdk-for-go/api/service/s3/s3manager/#Downloader\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/sdk-for-go/api/service/s3/s3manager/#Downloader</a></p>\n"}], "owner": {"reputation": 935, "user_id": 10391130, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CBVYnKKBv5w/AAAAAAAAAAI/AAAAAAAAAEc/bw1Ub6elbng/photo.jpg?sz=128", "display_name": "Madhuka Wickramapala", "link": "https://stackoverflow.com/users/10391130/madhuka-wickramapala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1495, "favorite_count": 1, "accepted_answer_id": 54420448, "answer_count": 1, "score": 2, "last_activity_date": 1548762981, "creation_date": 1548761694, "question_id": 54420152, "link": "https://stackoverflow.com/questions/54420152/aws-s3-parallel-download-using-golang", "title": "AWS S3 parallel download using golang", "body": "<p>I am writing a function to download a large file (9GB) from AWS S3 bucket using aws-sdk for go. I need to optimize this and download the file quickly. </p>\n\n<pre><code>func DownloadFromS3Bucket(bucket, item, path string) {\n    os.Setenv(\"AWS_ACCESS_KEY_ID\", constants.AWS_ACCESS_KEY_ID)\n    os.Setenv(\"AWS_SECRET_ACCESS_KEY\", constants.AWS_SECRET_ACCESS_KEY)\n\n    file, err := os.Create(filepath.Join(path, item))\n    if err != nil {\n        fmt.Printf(\"Error in downloading from file: %v \\n\", err)\n        os.Exit(1)\n    }\n\n    defer file.Close()\n\n    sess, _ := session.NewSession(&amp;aws.Config{\n        Region: aws.String(constants.AWS_REGION)},\n    )\n\n    downloader := s3manager.NewDownloader(sess)\n\n    numBytes, err := downloader.Download(file,\n        &amp;s3.GetObjectInput{\n            Bucket: aws.String(bucket),\n            Key:    aws.String(item),\n        })\n    if err != nil {\n        fmt.Printf(\"Error in downloading from file: %v \\n\", err)\n        os.Exit(1)\n    }\n\n    fmt.Println(\"Download completed\", file.Name(), numBytes, \"bytes\")\n}\n</code></pre>\n\n<p>Can someone suggest a solution to extend this function.</p>\n"}, {"tags": ["shell", "go", "glide-golang"], "comments": [{"owner": {"reputation": 18287, "user_id": 1029453, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x570w.jpg?s=128&g=1", "display_name": "Richard Huxton", "link": "https://stackoverflow.com/users/1029453/richard-huxton"}, "edited": false, "score": 0, "creation_date": 1548766664, "post_id": 54418751, "comment_id": 95652863, "body": "Is <code>expect</code> what you are looking for? <a href=\"https://linux.die.net/man/1/expect\" rel=\"nofollow noreferrer\">linux.die.net/man/1/expect</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4163, "user_id": 1887603, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/536f300c4e76fbb4973e2db7bfed12cf?s=128&d=identicon&r=PG", "display_name": "onkar", "link": "https://stackoverflow.com/users/1887603/onkar"}, "is_accepted": true, "score": 0, "last_activity_date": 1548835638, "creation_date": 1548835638, "answer_id": 54435862, "question_id": 54418751, "link": "https://stackoverflow.com/questions/54418751/read-golang-command-line-argument-after-enter-is-pressed-from-shell-script/54435862#54435862", "title": "Read GoLang Command Line Argument After Enter is pressed from shell script", "body": "<p>Based on @RichardHuxton's post. This is the solution I am using</p>\n\n<pre><code>#!/usr/bin/expect -f\n\n\nset alias [lindex $argv 1]\n\nset input [lindex $argv 0]\n\nset timeout -1\n\nCOMMAND I AM USING \n\nexpect {\n\n    \"*CONFIRMATION MESSAGE 1\" { send -- $alias\\r }\n\n\n    exp_continue\n\n}\n\n\nexpect {\n\n    \"*CONFIRMATION MESSAGE 2\" { send -- $alias\\r }\n\n\n    exp_continue\n\n}\n\nexpect eof\n</code></pre>\n\n<p>Calling bot</p>\n\n<pre><code> ./bot param1 param2\n</code></pre>\n\n<p>Dependency of <a href=\"https://linux.die.net/man/1/expect\" rel=\"nofollow noreferrer\">Expect</a></p>\n"}], "owner": {"reputation": 4163, "user_id": 1887603, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/536f300c4e76fbb4973e2db7bfed12cf?s=128&d=identicon&r=PG", "display_name": "onkar", "link": "https://stackoverflow.com/users/1887603/onkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 54435862, "answer_count": 1, "score": 0, "last_activity_date": 1548835638, "creation_date": 1548757230, "question_id": 54418751, "link": "https://stackoverflow.com/questions/54418751/read-golang-command-line-argument-after-enter-is-pressed-from-shell-script", "title": "Read GoLang Command Line Argument After Enter is pressed from shell script", "body": "<p>So I am using a OSS written in <code>go</code> which I don't have any exposure to. I am trying to automate that script.</p>\n\n<p>SO this is how the script works\n<code>calling_go_code</code>\nMessage for confirmation of user\nGet user input\nexecute the code.</p>\n\n<p>I am trying to automate this script.</p>\n\n<p>So far this is what I have tried,\n<code>sh test.sh Param1</code></p>\n\n<p>When I am running the script like</p>\n\n<pre><code>echo \"hello\"\ncalling_go_code\n</code></pre>\n\n<p>The above code asks for some parameter as input\ntest.sh</p>\n\n<p><code>sh test.sh Param1</code></p>\n\n<pre><code>echo \"hello\"\ncalling_go_code -- $1\n</code></pre>\n"}, {"tags": ["go", "command-line-interface"], "comments": [{"owner": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 0, "creation_date": 1548757636, "post_id": 54418628, "comment_id": 95647428, "body": "try specifying password as part of your url as <code>user:password@domain:~&#47;</code>, for other commands try specifying them as parameters."}, {"owner": {"reputation": 31, "user_id": 10816664, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BAifnA7SYA0/AAAAAAAAAAI/AAAAAAAAAAc/ll-1jXQ7Puo/photo.jpg?sz=128", "display_name": "Sumit Jain", "link": "https://stackoverflow.com/users/10816664/sumit-jain"}, "reply_to_user": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 0, "creation_date": 1548848761, "post_id": 54418628, "comment_id": 95688880, "body": "Above command is just for example of interactive command. I have CLI that asks several questions such as <code>Enter Your Name</code> or <code>What is your IP</code>"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10816664, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BAifnA7SYA0/AAAAAAAAAAI/AAAAAAAAAAc/ll-1jXQ7Puo/photo.jpg?sz=128", "display_name": "Sumit Jain", "link": "https://stackoverflow.com/users/10816664/sumit-jain"}, "edited": false, "score": 0, "creation_date": 1548848655, "post_id": 54435626, "comment_id": 95688818, "body": "Above library allows me to create interactive commands but I don&#39;t want that. I want to execute a command that is interactive where I specify all the inputs in code that i&#39;ll require to execute the command."}], "tags": [], "owner": {"reputation": 11, "user_id": 10983683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1kNc7HEswvk/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNoHmisCzQuo6blAV9nnDlPDF_-iA/mo/photo.jpg?sz=128", "display_name": "yiwu he", "link": "https://stackoverflow.com/users/10983683/yiwu-he"}, "is_accepted": false, "score": 1, "last_activity_date": 1548834619, "creation_date": 1548834619, "answer_id": 54435626, "question_id": 54418628, "link": "https://stackoverflow.com/questions/54418628/how-to-execute-interactive-cli-command-in-golang/54435626#54435626", "title": "How to execute interactive CLI command in golang?", "body": "<blockquote>\n  <p><a href=\"https://github.com/manifoldco/promptui\" rel=\"nofollow noreferrer\">https://github.com/manifoldco/promptui</a>     </p>\n</blockquote>\n\n<p>This is a good enough choice to meet your requirements. I think it's not a good idea to reinvent the wheel.</p>\n"}, {"tags": [], "owner": {"reputation": 457, "user_id": 8864420, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ca9c3f8cb67c71704963f09c967f94a4?s=128&d=identicon&r=PG&f=1", "display_name": "solo", "link": "https://stackoverflow.com/users/8864420/solo"}, "is_accepted": false, "score": 0, "last_activity_date": 1548861819, "creation_date": 1548861819, "answer_id": 54443932, "question_id": 54418628, "link": "https://stackoverflow.com/questions/54418628/how-to-execute-interactive-cli-command-in-golang/54443932#54443932", "title": "How to execute interactive CLI command in golang?", "body": "<p>One way to go about this is to use command-line flags:</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n    \"math\"\n)\n\nfunc main() {\n    var (\n        name = flag.String(\"name\", \"John\", \"Enter your name.\")\n        ip   = flag.Int(\"ip\", 12345, \"What is your ip?\")\n    )\n    flag.Parse()\n    fmt.Println(\"name:\", *name)\n    fmt.Println(\"ip:\", *ip)\n}\n</code></pre>\n\n<p>Now you can run the program with <code>name</code> and <code>ip</code> flags:</p>\n\n<pre><code>go run main.go -name=\"some random name\" -ip=12345678910`\nsome random name\nip: 12345678910\n</code></pre>\n\n<p>This <a href=\"https://www.youtube.com/watch?v=eIWFnNz8mF4\" rel=\"nofollow noreferrer\">channel</a> is a good resource\u2014he used to work for the Go team and made tons of videos on developing command-line programs in the language. Good luck!</p>\n"}], "owner": {"reputation": 31, "user_id": 10816664, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BAifnA7SYA0/AAAAAAAAAAI/AAAAAAAAAAc/ll-1jXQ7Puo/photo.jpg?sz=128", "display_name": "Sumit Jain", "link": "https://stackoverflow.com/users/10816664/sumit-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3980, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1604929888, "creation_date": 1548756846, "last_edit_date": 1551002661, "question_id": 54418628, "link": "https://stackoverflow.com/questions/54418628/how-to-execute-interactive-cli-command-in-golang", "title": "How to execute interactive CLI command in golang?", "body": "<p>I'm trying to execute a command that asks for several inputs for example if you try to copy a file from local device to the remote device we use <code>scp test.txt user@domain:~/</code> then it asks us for the password. What I want is I want to write a go code where I provide the password in the code itself for example <code>pass:='Secret Password'</code>. Similarly, I have CLI command where it asks us for several things such as IP, name, etc so I need to write a code where I just declare all the values in the code itself and when I run the code it doesn't ask anything just take all the inputs from code and run CLI command in case of copying file to remote it should not ask me for password when I run my go binary it should directly copy my file to remote decide. </p>\n\n<pre><code>func main() {\n    cmd := exec.Command(\"scp\", \"text.txt\", \"user@domain:~/\")        \n    stdin, err := cmd.StdinPipe()\n    if err = cmd.Start(); err != nil {\n        log.Fatalf(\"failed to start command: %s\", err)\n    }\n    io.WriteString(stdin, \"password\\n\")\n    if err = cmd.Wait(); err != nil {\n    log.Fatalf(\"command failed: %s\", err)\n    }\n}\n</code></pre>\n\n<p>If I use this code it is stuck on user@domain's password:</p>\n\n<p>And no file is copied to the remote device.</p>\n"}, {"tags": ["bash", "macos", "shell", "go"], "answers": [{"tags": [], "owner": {"reputation": 2610, "user_id": 563158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b4b8b7fa59c8b18038b56613e342a82?s=128&d=identicon&r=PG", "display_name": "Nebril", "link": "https://stackoverflow.com/users/563158/nebril"}, "is_accepted": false, "score": 7, "last_activity_date": 1595425720, "last_edit_date": 1595425720, "creation_date": 1548756629, "answer_id": 54418561, "question_id": 54418080, "link": "https://stackoverflow.com/questions/54418080/creating-and-running-go-build-for-mac-only/54418561#54418561", "title": "creating and running go build for Mac only?", "body": "<p>Since your binary will target OSX, you need to set <code>GOOS</code> to <code>darwin</code>, so your command will be</p>\n<pre><code>env GOOS=darwin GOARCH=amd64 go build\n</code></pre>\n<p>Documentation on compiler env vars is here: <a href=\"https://golang.org/doc/install/source#environment\" rel=\"nofollow noreferrer\">https://golang.org/doc/install/source#environment</a></p>\n<p>To run the binary on mac you need to make sure that binary is executable:</p>\n<pre><code>chmod +x path-to-binary\n</code></pre>\n<p>and then run it in terminal:</p>\n<pre><code>path-to-binary\n</code></pre>\n"}], "owner": {"reputation": 6996, "user_id": 2210442, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/D0uB0.jpg?s=128&g=1", "display_name": "TechChain", "link": "https://stackoverflow.com/users/2210442/techchain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6844, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1595425720, "creation_date": 1548755121, "last_edit_date": 1548755448, "question_id": 54418080, "link": "https://stackoverflow.com/questions/54418080/creating-and-running-go-build-for-mac-only", "title": "creating and running go build for Mac only?", "body": "<p>I am into a situation in which I have to run Go build on Mac OS/OS X. Build will be generated from Linux operating system &amp; that build I have to run on Mac OS/OS X. </p>\n\n<p>I have tried to generate a cross-platform build for Mac using below command and build is generated.</p>\n\n<pre><code>env GOOS=linux GOARCH=amd64 go build\n</code></pre>\n\n<p>This generated a Go build but I move this build to Mac it shows .dms file extension. </p>\n\n<p>Now I have two questions </p>\n\n<ul>\n<li>Am I generating the right build for Mac? </li>\n<li>How do I run this?DMS file on Mac?</li>\n</ul>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1548754043, "post_id": 54417609, "comment_id": 95645133, "body": "What happens when you run the program? What did you expect to happen? What is the actual and expected output? Please take some time to read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1548790905, "post_id": 54417609, "comment_id": 95667126, "body": "@Someprogrammerdude &quot;try it and see&quot; is difficult at the best of times (see questions about <code>null</code> is SQL, integer division, ... for examples of reasoning from specific cases going wrong) and nearly impossible with concurrency issues. That&#39;s why we like to have language specs."}], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 0, "last_activity_date": 1548754232, "creation_date": 1548754232, "answer_id": 54417778, "question_id": 54417609, "link": "https://stackoverflow.com/questions/54417609/does-go-operator-need-mutex/54417778#54417778", "title": "does go ++ operator need mutex?", "body": "<blockquote>\n  <p>just add +1 value to the current value</p>\n</blockquote>\n\n<p>No, it's not \"just add\". It's</p>\n\n<ol>\n<li>Read current value</li>\n<li>Compute new value (based on what was read) and write it</li>\n</ol>\n\n<p>See how this can break with multiple concurrent actors?</p>\n\n<p>If you want atomic increments, check out <a href=\"https://golang.org/pkg/sync/atomic/\" rel=\"nofollow noreferrer\">sync/atomic</a>. Examples: <a href=\"https://gobyexample.com/atomic-counters\" rel=\"nofollow noreferrer\">https://gobyexample.com/atomic-counters</a></p>\n"}, {"tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": false, "score": 2, "last_activity_date": 1548754649, "creation_date": 1548754649, "answer_id": 54417902, "question_id": 54417609, "link": "https://stackoverflow.com/questions/54417609/does-go-operator-need-mutex/54417902#54417902", "title": "does go ++ operator need mutex?", "body": "<p>To \"just add 1 to the current value\" the computer needs to <em>read</em> the current value, add 1, and <em>write</em> the new value back. Clearly ordering does matter; the standard example is:</p>\n\n<pre><code>Thread A     Thread B\nRead: 5\n             Read: 5\n+1 = 6\n             +1 = 6\nWrite: 6\n             Write: 6\n</code></pre>\n\n<p>The value started at 5, two threads of execution each added one, and the result is 6 (when it should be 7), because B's read occurred before A's write.</p>\n\n<p>But there's a more important misconception at play here: many people think that in the case of a race, the code will either read the old value, or it will read the new value. <em>This is not guaranteed</em>. It might be what happens most of the time. It might be what happens all the time <em>on your computer</em>, with the current version of the compiler, etc. But <a href=\"https://software.intel.com/en-us/blogs/2013/01/06/benign-data-races-what-could-possibly-go-wrong\" rel=\"nofollow noreferrer\">actually it's possible</a> for code that accesses data in an unsafe/racy manner to produce <em>any</em> result, even complete garbage. There's no guarantee that the value you read from a variable corresponds to any value it has <em>ever</em> had, if you cause a race.</p>\n"}], "owner": {"reputation": 1, "user_id": 9902186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0a449e41e6023206dded034bf60c38?s=128&d=identicon&r=PG&f=1", "display_name": "joni", "link": "https://stackoverflow.com/users/9902186/joni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1548754649, "creation_date": 1548753766, "question_id": 54417609, "link": "https://stackoverflow.com/questions/54417609/does-go-operator-need-mutex", "title": "does go ++ operator need mutex?", "body": "<p>Does go ++ Operator need mutex?\nIt seems that when not using mutex i am losing some data , but by logic ++ just add +1 value to the current value , so even if the order is incorrect still a total of 1000 run should happen no?\nExample: </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n    var wg sync.WaitGroup\n    i := 0\n    for r := 0; r &lt; 1000; r++ {\n        wg.Add(1)\n        go func() {\n            i++\n            fmt.Println(i)\n            wg.Done()\n        }()\n    }\n    wg.Wait()\n    fmt.Printf(\"%d Done\", i)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1548753644, "post_id": 54417519, "comment_id": 95644939, "body": "Then simply have one &quot;instance&quot; of this variable, and refer to this single instance everywhere. What is the problem?"}, {"owner": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1548753939, "post_id": 54417519, "comment_id": 95645080, "body": "I started coding go 2 weeks ago :) I tried to define it in main.go and refer it in other package, but I can&#39;t import main module to access it"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1548754007, "post_id": 54417519, "comment_id": 95645113, "body": "package main is importable only in special cases, put your variable in a non-main package and import that one."}, {"owner": {"reputation": 47877, "user_id": 414062, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/xc7mu.jpg?s=128&g=1", "display_name": "Dominic", "link": "https://stackoverflow.com/users/414062/dominic"}, "edited": false, "score": 0, "creation_date": 1548754305, "post_id": 54417519, "comment_id": 95645270, "body": "Just a thought but is <code>os.Getenv(&quot;VOLUME_PATH&quot;)</code> really so long to write compared to importing a variable from another file?"}, {"owner": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "edited": false, "score": 0, "creation_date": 1548754819, "post_id": 54417519, "comment_id": 95645611, "body": "It would have been cleaner to have a VolumePath var, but I have no central package other than main, so, I guess I will do it like that..."}, {"owner": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "edited": false, "score": 0, "creation_date": 1548755335, "post_id": 54417519, "comment_id": 95645932, "body": "please put an answer with that, I think I will accept icza answer, but I will upvote yours, as this it what I will do"}], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "edited": false, "score": 0, "creation_date": 1548755063, "post_id": 54417735, "comment_id": 95645749, "body": "@JuliatzindelToro Yes, package <code>main</code> is special in many ways. Don&#39;t try to learn the language by drawing conclusions regarding to it."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1548754138, "creation_date": 1548754138, "answer_id": 54417735, "question_id": 54417519, "link": "https://stackoverflow.com/questions/54417519/set-a-variable-once-for-the-whole-golang-project/54417735#54417735", "title": "set a variable once for the whole golang project", "body": "<p>Simply use a single variable, and refer to that single instance from everywhere you need it.</p>\n\n<p>Note that you can't refer to identifiers defined in the <code>main</code> package from other packages. So if you have multiple packages, this variable must be in a non-<code>main</code> package. Put it in package <code>example</code>, have it start with an uppercase letter (so it is exported), and import the <code>example</code> package from other packages, and you can refer to it as <code>example.Volume_path</code>.</p>\n\n<p>Also note that the <code>Volume_path</code> name is not idiomatic in Go, you should name it rather <code>VolumePath</code>.</p>\n\n<p><code>example.go</code>:</p>\n\n<pre><code>package example\n\nvar VolumePath = os.Getenv(\"VOLUME_PATH\")\n</code></pre>\n\n<p>And in other packages:</p>\n\n<pre><code>import (\n    \"path/to/example\"\n    \"fmt\"\n)\n\nfunc something() {\n    fmt.Println(example.VolumePath)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 191, "user_id": 9870721, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Eitam Ring", "link": "https://stackoverflow.com/users/9870721/eitam-ring"}, "is_accepted": false, "score": 0, "last_activity_date": 1548754267, "creation_date": 1548754267, "answer_id": 54417786, "question_id": 54417519, "link": "https://stackoverflow.com/questions/54417519/set-a-variable-once-for-the-whole-golang-project/54417786#54417786", "title": "set a variable once for the whole golang project", "body": "<p>The prefer way to approach this is to set instance of the variable value in a package(Other than main) and use it all around the program ,</p>\n\n<p>Example:</p>\n\n<pre><code>var Volume string\n\nvar Volume = os.Getenv(\"VOLUME_PATH\")\n</code></pre>\n\n<p>Please remember the following rule in go:</p>\n\n<p>upper case initial letter: Name is visible to clients of package\notherwise: name (or _Name) is not visible to clients of package</p>\n\n<p>See <a href=\"http://golang-basic.blogspot.com/2014/05/basic-golang-why-and-what-part-4-naming.html\" rel=\"nofollow noreferrer\">Golang naming</a></p>\n"}], "owner": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1548754267, "creation_date": 1548753490, "question_id": 54417519, "link": "https://stackoverflow.com/questions/54417519/set-a-variable-once-for-the-whole-golang-project", "title": "set a variable once for the whole golang project", "body": "<p>I need to have a variable <code>volume_path</code> for my project.</p>\n\n<p>volume_path is set in .env file, so I have 2 definition for it:</p>\n\n<pre><code>.env\n.env.testing\n</code></pre>\n\n<p>In my code, I will set the var to: </p>\n\n<pre><code>var Volume_path = os.Getenv(\"VOLUME_PATH\")\n</code></pre>\n\n<p>I know how to do it to set this var in each file, but I would like to define it just once, and make it accesible for all the project, is it possible ?</p>\n"}, {"tags": ["go", "pipe"], "comments": [{"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 0, "creation_date": 1548752987, "post_id": 54417288, "comment_id": 95644563, "body": "Maybe you wanted <code>pipe:3</code> instead of trying to read from stdout."}, {"owner": {"reputation": 1986, "user_id": 4180276, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f34129a97d735e6e19247c911626cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "nadermx", "link": "https://stackoverflow.com/users/4180276/nadermx"}, "reply_to_user": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 0, "creation_date": 1548758584, "post_id": 54417288, "comment_id": 95648022, "body": "@hobbs I tried <code>pipe:2</code>, <code>pipe:3</code>, <code>pipe:4</code> to no avail given the ExtraFile saying <code>3+i</code>"}], "owner": {"reputation": 1986, "user_id": 4180276, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f34129a97d735e6e19247c911626cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "nadermx", "link": "https://stackoverflow.com/users/4180276/nadermx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1548753194, "creation_date": 1548752785, "last_edit_date": 1548753194, "question_id": 54417288, "link": "https://stackoverflow.com/questions/54417288/pipe1-bad-file-descriptor", "title": "pipe:1: Bad file descriptor", "body": "<p>I saw via golang you can only do one <code>Stdin</code> so I'm trying to have two piped inputs into a <code>cmd1.exec.Command()</code>, one via <code>Stdin</code> and the other via <code>ExtraFiles</code> but the <code>ExtraFiles</code> pipe is giving <code>pipe:1: Bad file descriptor</code> when <code>cmd1</code> tries to read it</p>\n\n<pre><code>cmd1 := exec.Command(\"command1\", \"-i\", \"pipe:0\", \"-i\", \"pipe:1\", \"more stuff\")\ncmd2 := exec.Command(\"command2\", \"-o\", \"-\")\ncmd3 := exec.Command(\"command3\", \"-o\", \"-\")\nstdin, stdinErr := cmd2.StdoutPipe()\nif stdinErr != nil {\n    return stdinErr\n}\ncmd2.Start()\ncmd1.Stdin = stdin\npipeR, pipeW, _ := os.Pipe()\ncmd1.ExtraFiles = []*os.File{pipeW}\nextrastdin, extrastdinErr := cmd3.StdoutPipe()\nif extrastdinErr != nil {\n    return extrastdinErr\n}\ncmd3.Start()\nfd3 := os.NewFile(3, \"/proc/self/fd/3\")\nbody, err := ioutil.ReadAll(extrastdin)\nif err != nil {\n    return err\n}\nfd3.Write(body)\ndefer pipeR.Close()\ndefer pipeW.Close()\ndefer fd3.Close()\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 9696948, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001828000943/picture?type=large", "display_name": "Mohammad Abdul Bari", "link": "https://stackoverflow.com/users/9696948/mohammad-abdul-bari"}, "edited": false, "score": 0, "creation_date": 1548754950, "post_id": 54416090, "comment_id": 95645680, "body": "I have this function for creating the struct, I&#39;m unable to use make for the inner struct &quot;*FailureData&quot;     <code>func NewDetectionResults() *DetectionResults {   \tresult := DetectionResults{make(map[git_repo.FilePath]*FailureData),                                                             make(map[git_repo.FilePath][]string)                                                    }   \treturn &amp;result   }</code>"}, {"owner": {"reputation": 483, "user_id": 10350764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f198c0e69cbca84b4a849cca0f37a60a?s=128&d=identicon&r=PG&f=1", "display_name": "fwhez", "link": "https://stackoverflow.com/users/10350764/fwhez"}, "reply_to_user": {"reputation": 7, "user_id": 9696948, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001828000943/picture?type=large", "display_name": "Mohammad Abdul Bari", "link": "https://stackoverflow.com/users/9696948/mohammad-abdul-bari"}, "edited": false, "score": 0, "creation_date": 1548917858, "post_id": 54416090, "comment_id": 95717993, "body": "@MohammadAbdulBari I&#39;ve refreshed the answer to show how to use the struct you define"}], "tags": [], "owner": {"reputation": 483, "user_id": 10350764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f198c0e69cbca84b4a849cca0f37a60a?s=128&d=identicon&r=PG&f=1", "display_name": "fwhez", "link": "https://stackoverflow.com/users/10350764/fwhez"}, "is_accepted": true, "score": 0, "last_activity_date": 1548917774, "last_edit_date": 1548917774, "creation_date": 1548747877, "answer_id": 54416090, "question_id": 54415973, "link": "https://stackoverflow.com/questions/54415973/go-error-panic-runtime-error-invalid-memory-address-or-nil-pointer-dereferenc/54416090#54416090", "title": "Go Error: panic: runtime error: invalid memory address or nil pointer dereference. Changing map inside a struct which is present in another struct,", "body": "<p>The code you write will not pop nil error while compiling.It only causes nil point error when you are using it in a wrong way.</p>\n\n<p><code>failuresInCommits map[string][]string</code> did you use it after <code>make()</code>?</p>\n\n<p><code>Failures map[git_repo.FilePath]*FailureData</code> did you use this after 'make()'?</p>\n\n<p>ok , now you focus on \n<code>ok := r.Failures[filePath].failuresInCommits</code>,did you make sure <code>r.Failures[filePath]</code> returns 'failuresIncommits, true',</p>\n\n<p>if not, then r.Failures[filePath] is nil, ok, you tell me what is <code>nil.failuresInCommits</code>.</p>\n\n<p>there is also a risk that you can only x.failureInCommits in this specific package. If you do the same in some other package, x.failureInCommits will be unaccessable becaues of the field lowwer case limited.</p>\n\n<p>How to make ?</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\ntype FilePath string\n\ntype FailureData struct {\n    failuresInCommits map[string][]string\n}\n\nfunc NewFailureData() FailureData {\n    return FailureData{\n        failuresInCommits: make(map[string][]string, 0),\n    }\n}\nfunc (fd *FailureData) Set(k string, v []string) {\n    fd.failuresInCommits[k] = v\n}\n\ntype DetectionResults struct {\n    Failures map[FilePath]*FailureData\n    //Have other things\n}\n\nfunc NewDetectionResults() *DetectionResults {\n    return &amp;DetectionResults{\n        Failures: make(map[FilePath]*FailureData, 0),\n    }\n}\nfunc (dr *DetectionResults) Set(fp FilePath, fd *FailureData) {\n    dr.Failures[fp] = fd\n}\n\nfunc main() {\n    fd := NewFailureData()\n    dr := NewDetectionResults()\n    comments := []string{\"push error\", \"commit error\", \"add error\"}\n\n    fd.Set(\"hash-18ef8abujce8fad0h8j\", comments)\n    dr.Set(\"/etc/go/gopath/src/github.com/xxx/xxx/main.go: 12\", &amp;fd)\n}\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 9696948, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001828000943/picture?type=large", "display_name": "Mohammad Abdul Bari", "link": "https://stackoverflow.com/users/9696948/mohammad-abdul-bari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "accepted_answer_id": 54416090, "answer_count": 1, "score": 0, "last_activity_date": 1548917774, "creation_date": 1548747355, "question_id": 54415973, "link": "https://stackoverflow.com/questions/54415973/go-error-panic-runtime-error-invalid-memory-address-or-nil-pointer-dereferenc", "title": "Go Error: panic: runtime error: invalid memory address or nil pointer dereference. Changing map inside a struct which is present in another struct,", "body": "<p>I have to structs lets say struct1 and struct2, struct2 contains a map with struct1, struct1 also contains a map, I want to change the map which is present in struct1.</p>\n\n<p>This is throwing a runtime error:\n<em>panic: runtime error: invalid memory address or nil pointer dereference</em></p>\n\n<pre><code>type FailureData struct {\n    failuresInCommits map[string][]string \n}\n\ntype DetectionResults struct {\n    Failures map[git_repo.FilePath]*FailureData\n        //Have other things\n}\n\nfunc (r *DetectionResults) Fail(filePath git_repo.FilePath, message \n           string, commits []string) {  \n        ok := r.Failures[filePath].failuresInCommits //error occurs here    \n        if r.Failures[filePath].failuresInCommits == nil {       \n            r.Failures[filePath].failuresInCommits = make(map[string][]string)\n        }\n        if len(ok) == 0 {\n            r.Failures[filePath].failuresInCommits[message] = commits\n        } else {\n            r.Failures[filePath].failuresInCommits[message] = \n               append(r.Failures[filePath].failuresInCommits[message], \n                      commits...)   \n        }\n}\n</code></pre>\n"}, {"tags": ["go", "gopath"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 3, "creation_date": 1548746696, "post_id": 54415733, "comment_id": 95641511, "body": "Have you tried <code>go get github.com&#47;user&#47;repo</code>?"}, {"owner": {"reputation": 1314, "user_id": 5464408, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-LOhxCzHXZNs/AAAAAAAAAAI/AAAAAAAAApo/Gar2GKviqB8/photo.jpg?sz=128", "display_name": "zero", "link": "https://stackoverflow.com/users/5464408/zero"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1548746732, "post_id": 54415733, "comment_id": 95641527, "body": "The issue was with the repo format, instead of <code>git@github&lt;user&#47;repo&gt;</code> i had to use <code>github.com&#47;&lt;user&gt;&#47;&lt;repo&gt;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3818, "user_id": 1247113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRMFj.png?s=128&g=1", "display_name": "rob74", "link": "https://stackoverflow.com/users/1247113/rob74"}, "is_accepted": true, "score": 13, "last_activity_date": 1548753243, "last_edit_date": 1548753243, "creation_date": 1548749433, "answer_id": 54416455, "question_id": 54415733, "link": "https://stackoverflow.com/questions/54415733/getting-gopath-error-go-cannot-use-pathversion-syntax-in-gopath-mode-in-ubun/54416455#54416455", "title": "Getting GOPATH error &quot;go: cannot use path@version syntax in GOPATH mode&quot; in Ubuntu 16.04", "body": "<p>As you already noticed, you should use <code>go get github.com/&lt;user&gt;/&lt;repo&gt;</code>. </p>\n\n<p>The error message you saw comes from a new feature implemented in <code>go get</code> to support <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"noreferrer\">Go modules</a> - you can now also specify the version of a dependency: <code>go get github.com/&lt;user&gt;/&lt;repo&gt;@&lt;version&gt;</code>, where <code>version</code> is a git tag using semver, e.g. <code>v1.0.2</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 3818, "user_id": 1247113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRMFj.png?s=128&g=1", "display_name": "rob74", "link": "https://stackoverflow.com/users/1247113/rob74"}, "edited": false, "score": 0, "creation_date": 1589114876, "post_id": 56249926, "comment_id": 109158606, "body": "I&#39;m not sure this actually solves the issue?! I mean, this env variable disables &quot;GOPATH mode&quot; (which is disabled by default anyway starting with Go v1.13), but <code>git@github&lt;user&#47;repo&gt;</code> still isn&#39;t &quot;path@version syntax&quot;, so it still wouldn&#39;t work?"}, {"owner": {"reputation": 101, "user_id": 6282614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40e79fd9ea1e251cf836afe64ab57fb8?s=128&d=identicon&r=PG&f=1", "display_name": "John G", "link": "https://stackoverflow.com/users/6282614/john-g"}, "edited": false, "score": 0, "creation_date": 1613063575, "post_id": 56249926, "comment_id": 116966716, "body": "Google must have enabled it by default in 1.14 or 1.15 because I get this error message with 1.15. I do see there is a pull request to fix this yet again in 1.16. This things changes way to frequently to keep up."}], "tags": [], "owner": {"reputation": 1430, "user_id": 2992786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/301a40dc7ef5dbfaaae552bdd9f6954a?s=128&d=identicon&r=PG", "display_name": "emaxi", "link": "https://stackoverflow.com/users/2992786/emaxi"}, "is_accepted": false, "score": 38, "last_activity_date": 1558507241, "last_edit_date": 1558507241, "creation_date": 1558503273, "answer_id": 56249926, "question_id": 54415733, "link": "https://stackoverflow.com/questions/54415733/getting-gopath-error-go-cannot-use-pathversion-syntax-in-gopath-mode-in-ubun/56249926#56249926", "title": "Getting GOPATH error &quot;go: cannot use path@version syntax in GOPATH mode&quot; in Ubuntu 16.04", "body": "<p>I had the same issue and solved setting specific env variable <code>export GO111MODULE=on</code> in my .zshrc(or .bashrc depending on which shell you use) and restart the shell in order to enable modules. You can find more details here: <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"noreferrer\">https://github.com/golang/go/wiki/Modules</a></p>\n"}, {"tags": [], "owner": {"reputation": 173, "user_id": 11114532, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_rUXXC6AGNY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMgl_dRzyPjwc4pUzgZSScjCYs9Ww/mo/photo.jpg?sz=128", "display_name": "cz.ycaptain", "link": "https://stackoverflow.com/users/11114532/cz-ycaptain"}, "is_accepted": false, "score": 17, "last_activity_date": 1573968708, "last_edit_date": 1573968708, "creation_date": 1563293364, "answer_id": 57061473, "question_id": 54415733, "link": "https://stackoverflow.com/questions/54415733/getting-gopath-error-go-cannot-use-pathversion-syntax-in-gopath-mode-in-ubun/57061473#57061473", "title": "Getting GOPATH error &quot;go: cannot use path@version syntax in GOPATH mode&quot; in Ubuntu 16.04", "body": "<p>I met this issue, too. After some search, the following works by using <code>go mod</code> instead of <code>go get</code>, which is a feature of <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"noreferrer\">Golang Modules</a>:</p>\n\n<pre><code>$ export GO111MODULE=on\n\n$ go mod init &lt;project name&gt;\n\n# go mod init HelloWorld\n# or\n# go mod init .\n\n$ go mod download repo@version\n\n# go mod download github.com/robfig/cron/v3@v3.0.0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 81, "user_id": 1399225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de501b1fdeb766e58cc4d1f23040a983?s=128&d=identicon&r=PG", "display_name": "Dr.Stein", "link": "https://stackoverflow.com/users/1399225/dr-stein"}, "is_accepted": false, "score": 3, "last_activity_date": 1576741971, "creation_date": 1576741971, "answer_id": 59405367, "question_id": 54415733, "link": "https://stackoverflow.com/questions/54415733/getting-gopath-error-go-cannot-use-pathversion-syntax-in-gopath-mode-in-ubun/59405367#59405367", "title": "Getting GOPATH error &quot;go: cannot use path@version syntax in GOPATH mode&quot; in Ubuntu 16.04", "body": "<p>If you get this error while you trying use modules, you should change dir to project before go get:</p>\n\n<pre><code>root@host:/# go get github.com/ibm-messaging/mq-golang/ibmmq@ff54c095001d81eed10615916a896512eb8d81ff\ngo: cannot use path@version syntax in GOPATH mode\nroot@host:/# cd myproject/\nroot@host:/myproject# ls go.mod \ngo.mod\nroot@host:/myproject# go get github.com/ibm-messaging/mq-golang/ibmmq@ff54c095001d81eed10615916a896512eb8d81ff\ngo: finding github.com ff54c095001d81eed10615916a896512eb8d81ff\ngo: finding github.com/ibm-messaging/mq-golang/ibmmq ff54c095001d81eed10615916a896512eb8d81ff\ngo: finding github.com/ibm-messaging/mq-golang ff54c095001d81eed10615916a896512eb8d81ff\ngo: finding github.com/ibm-messaging ff54c095001d81eed10615916a896512eb8d81ff\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3406, "user_id": 110186, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/AemXl.jpg?s=128&g=1", "display_name": "Feckmore", "link": "https://stackoverflow.com/users/110186/feckmore"}, "is_accepted": false, "score": 1, "last_activity_date": 1594828284, "creation_date": 1594828284, "answer_id": 62918824, "question_id": 54415733, "link": "https://stackoverflow.com/questions/54415733/getting-gopath-error-go-cannot-use-pathversion-syntax-in-gopath-mode-in-ubun/62918824#62918824", "title": "Getting GOPATH error &quot;go: cannot use path@version syntax in GOPATH mode&quot; in Ubuntu 16.04", "body": "<p>I got this error with Go v1.14 when running <code>$ go get github.com/&lt;user&gt;/&lt;repo&gt;@&lt;version&gt;</code> on an empty project before I had initialized my project with modules.</p>\n<p>To resolve, I created a <code>go.mod</code> file using:</p>\n<p><code>$ go mod init</code></p>\n<p>I was able to rerun the get command successfully, which downloaded the vendor's package, updated the <code>go.mod</code> file, and created a <code>go.sum</code> file.</p>\n"}, {"tags": [], "owner": {"reputation": 93, "user_id": 9381447, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7df1545f5bc11d912e51c68a87cb0840?s=128&d=identicon&r=PG&f=1", "display_name": "vickee", "link": "https://stackoverflow.com/users/9381447/vickee"}, "is_accepted": false, "score": 1, "last_activity_date": 1604138200, "creation_date": 1604138200, "answer_id": 64620478, "question_id": 54415733, "link": "https://stackoverflow.com/questions/54415733/getting-gopath-error-go-cannot-use-pathversion-syntax-in-gopath-mode-in-ubun/64620478#64620478", "title": "Getting GOPATH error &quot;go: cannot use path@version syntax in GOPATH mode&quot; in Ubuntu 16.04", "body": "<p>Ran into this issue when i tried running the command in a directory outside of the directory where go mod is initialized. In order to download a module with a specific version go requires go.mod file which can keep track of multiple version of a same module. However trying to download the module in anywhere else outside of a go module directory(where GOPATH will be referenced to store the download module) will fail as there is no option to keep track of different versions of the same module.</p>\n"}], "owner": {"reputation": 1314, "user_id": 5464408, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-LOhxCzHXZNs/AAAAAAAAAAI/AAAAAAAAApo/Gar2GKviqB8/photo.jpg?sz=128", "display_name": "zero", "link": "https://stackoverflow.com/users/5464408/zero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38658, "favorite_count": 5, "accepted_answer_id": 54416455, "answer_count": 6, "score": 46, "last_activity_date": 1604138200, "creation_date": 1548746327, "last_edit_date": 1557349319, "question_id": 54415733, "link": "https://stackoverflow.com/questions/54415733/getting-gopath-error-go-cannot-use-pathversion-syntax-in-gopath-mode-in-ubun", "title": "Getting GOPATH error &quot;go: cannot use path@version syntax in GOPATH mode&quot; in Ubuntu 16.04", "body": "<p>I'm unable to run <code>go get git@github&lt;user/repo&gt;</code> in my <code>$GOPATH</code> folder.\nGetting this error:</p>\n\n<blockquote>\n  <p>go: cannot use path@version syntax in GOPATH mode</p>\n</blockquote>\n\n<p>I just want to understand why <code>go get</code> isn't working even though <code>$GOPATH</code> is configured during the installation. Environment is ubuntu.  </p>\n\n<pre><code>~/$ echo $GOPATH\n/home/user/go\n</code></pre>\n"}, {"tags": ["go", "travis-ci"], "comments": [{"owner": {"reputation": 1047, "user_id": 10443472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/051b4da9def21dd0ff5e10f383a96c94?s=128&d=identicon&r=PG", "display_name": "retgits", "link": "https://stackoverflow.com/users/10443472/retgits"}, "edited": false, "score": 1, "creation_date": 1548876894, "post_id": 54415450, "comment_id": 95705386, "body": "Can I ask why you&#39;re using the <code>go_import_path</code> if you&#39;re also doing a <code>go get</code> for that specific dependency?"}, {"owner": {"reputation": 483, "user_id": 10350764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f198c0e69cbca84b4a849cca0f37a60a?s=128&d=identicon&r=PG&f=1", "display_name": "fwhez", "link": "https://stackoverflow.com/users/10350764/fwhez"}, "reply_to_user": {"reputation": 1047, "user_id": 10443472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/051b4da9def21dd0ff5e10f383a96c94?s=128&d=identicon&r=PG", "display_name": "retgits", "link": "https://stackoverflow.com/users/10443472/retgits"}, "edited": false, "score": 0, "creation_date": 1548918041, "post_id": 54415450, "comment_id": 95718083, "body": "@retgits i saw someone else do the same, and i just copied the style.I&#39;ve fix the problem. It happened because an import path in the project is referred locally in my gopath, the travis cloud cannot download it from my local macine. 3q all the way"}, {"owner": {"reputation": 1047, "user_id": 10443472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/051b4da9def21dd0ff5e10f383a96c94?s=128&d=identicon&r=PG", "display_name": "retgits", "link": "https://stackoverflow.com/users/10443472/retgits"}, "edited": false, "score": 0, "creation_date": 1548950103, "post_id": 54415450, "comment_id": 95736963, "body": "Awesome! If you\u2019ve fixed the problem, you can always add it here and accept your own answer so that others who might have the same issue can see your solution too."}], "answers": [{"tags": [], "owner": {"reputation": 483, "user_id": 10350764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f198c0e69cbca84b4a849cca0f37a60a?s=128&d=identicon&r=PG&f=1", "display_name": "fwhez", "link": "https://stackoverflow.com/users/10350764/fwhez"}, "is_accepted": true, "score": 0, "last_activity_date": 1548983347, "creation_date": 1548983347, "answer_id": 54471541, "question_id": 54415450, "link": "https://stackoverflow.com/questions/54415450/how-to-deploy-an-travis-auto-build-mine-failed-and-i-dont-know-how-to-fix/54471541#54471541", "title": "How to deploy an travis auto-build, mine failed and I don&#39;t know how to fix", "body": "<p><code>The problem unrecognized import path (import path does not begin with hostname)</code> problem happens when part of your code imports some packages the travis can not arrive.</p>\n\n<p>In my case, one of my code <code>import errorX</code>,and errorX is my local package,travis can not download from anywhere on the github.</p>\n\n<p>I fix it by  import \"github.com/fwhezfwhez/errorx\"</p>\n"}], "owner": {"reputation": 483, "user_id": 10350764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f198c0e69cbca84b4a849cca0f37a60a?s=128&d=identicon&r=PG&f=1", "display_name": "fwhez", "link": "https://stackoverflow.com/users/10350764/fwhez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 54471541, "answer_count": 1, "score": 0, "last_activity_date": 1548983347, "creation_date": 1548745066, "question_id": 54415450, "link": "https://stackoverflow.com/questions/54415450/how-to-deploy-an-travis-auto-build-mine-failed-and-i-dont-know-how-to-fix", "title": "How to deploy an travis auto-build, mine failed and I don&#39;t know how to fix", "body": "<p>I'm getting a trouble while build my travis file. pop an error\n<code>package errorX: unrecognized import path \"errorX\" (import path does not begin with hostname)</code>, and I can't tell which part causes it.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>language: go\ngo:\n  - 1.9.x\n  - 1.10.x\n  - 1.11.x\nenv:\n  - GOARCH=amd64\n  - GOARCH=386\nsudo: true\ngo_import_path: github.com/fwhezfwhez/errorx\nbefore_install:\n  - go get github.com/fwhezfwhez/errorx\n  - go get github.com/fwhezfwhez/go-queue\nscript:  \n  - go build example/main.go\nnotifications:\n  email: false\n\n</code></pre>\n\n<p>result</p>\n\n<pre><code>Worker information\nhostname: a4c1b320-2318-4217-a009-555a967eb050@1.production-2-worker-org-gce-94gz\nversion: v6.2.0 https://github.com/travis-ci/worker/tree/5e5476e01646095f48eec13196fdb3faf8f5cbf7\ninstance: travis-job-638b4bba-9fef-43d4-b294-ee56fd7486bf travis-ci-garnet-trusty-1512502259-986baf0 (via amqp)\nstartup: 9.418692015s\nsystem_info\nBuild system information\nBuild language: go\nBuild group: stable\nBuild dist: trusty\nBuild id: 485760232\nJob id: 485760235\nRuntime kernel version: 4.4.0-101-generic\ntravis-build version: f05bd1fd8\nBuild image provisioning date and time\nTue Dec  5 19:58:13 UTC 2017\nOperating System Details\nDistributor ID: Ubuntu\nDescription:    Ubuntu 14.04.5 LTS\nRelease:    14.04\nCodename:   trusty\nCookbooks Version\n7c2c6a6 https://github.com/travis-ci/travis-cookbooks/tree/7c2c6a6\ngit version\ngit version 2.15.1\nbash version\nGNU bash, version 4.3.11(1)-release (x86_64-pc-linux-gnu)\ngcc version\ngcc (Ubuntu 4.8.4-2ubuntu1~14.04.3) 4.8.4\nCopyright (C) 2013 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\ndocker version\nClient:\n Version:      17.09.0-ce\n API version:  1.32\n Go version:   go1.8.3\n Git commit:   afdb6d4\n Built:        Tue Sep 26 22:42:38 2017\n OS/Arch:      linux/amd64\nServer:\n Version:      17.09.0-ce\n API version:  1.32 (minimum version 1.12)\n Go version:   go1.8.3\n Git commit:   afdb6d4\n Built:        Tue Sep 26 22:41:20 2017\n OS/Arch:      linux/amd64\n Experimental: false\nclang version\nclang version 5.0.0 (tags/RELEASE_500/final)\nTarget: x86_64-unknown-linux-gnu\nThread model: posix\nInstalledDir: /usr/local/clang-5.0.0/bin\njq version\njq-1.5\nbats version\nBats 0.4.0\nshellcheck version\n0.4.6\nshfmt version\nv2.0.0\nccache version\nccache version 3.1.9\nCopyright (C) 2002-2007 Andrew Tridgell\nCopyright (C) 2009-2011 Joel Rosdahl\nThis program is free software; you can redistribute it and/or modify it under\nthe terms of the GNU General Public License as published by the Free Software\nFoundation; either version 3 of the License, or (at your option) any later\nversion.\ncmake version\ncmake version 3.9.2\nCMake suite maintained and supported by Kitware (kitware.com/cmake).\nheroku version\nheroku-cli/6.14.39-addc925 (linux-x64) node-v9.2.0\nimagemagick version\nVersion: ImageMagick 6.7.7-10 2017-07-31 Q16 http://www.imagemagick.org\nmd5deep version\n4.2\nmercurial version\nMercurial Distributed SCM (version 4.2.2)\n(see https://mercurial-scm.org for more information)\nCopyright (C) 2005-2017 Matt Mackall and others\nThis is free software; see the source for copying conditions. There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\nmysql version\nmysql  Ver 14.14 Distrib 5.6.33, for debian-linux-gnu (x86_64) using  EditLine wrapper\nopenssl version\nOpenSSL 1.0.1f 6 Jan 2014\npacker version\nPacker v1.0.2\nYour version of Packer is out of date! The latest version\nis 1.1.2. You can update by downloading from www.packer.io\npostgresql client version\npsql (PostgreSQL) 9.6.6\nragel version\nRagel State Machine Compiler version 6.8 Feb 2013\nCopyright (c) 2001-2009 by Adrian Thurston\nsubversion version\nsvn, version 1.8.8 (r1568071)\n   compiled Aug 10 2017, 17:20:39 on x86_64-pc-linux-gnu\nCopyright (C) 2013 The Apache Software Foundation.\nThis software consists of contributions made by many people;\nsee the NOTICE file for more information.\nSubversion is open source software, see http://subversion.apache.org/\nThe following repository access (RA) modules are available:\n* ra_svn : Module for accessing a repository using the svn network protocol.\n  - with Cyrus SASL authentication\n  - handles 'svn' scheme\n* ra_local : Module for accessing a repository on local disk.\n  - handles 'file' scheme\n* ra_serf : Module for accessing a repository via WebDAV protocol using serf.\n  - using serf 1.3.3\n  - handles 'http' scheme\n  - handles 'https' scheme\nsudo version\nSudo version 1.8.9p5\nConfigure options: --prefix=/usr -v --with-all-insults --with-pam --with-fqdn --with-logging=syslog --with-logfac=authpriv --with-env-editor --with-editor=/usr/bin/editor --with-timeout=15 --with-password-timeout=0 --with-passprompt=[sudo] password for %p:  --without-lecture --with-tty-tickets --disable-root-mailer --enable-admin-flag --with-sendmail=/usr/sbin/sendmail --with-timedir=/var/lib/sudo --mandir=/usr/share/man --libexecdir=/usr/lib/sudo --with-sssd --with-sssd-lib=/usr/lib/x86_64-linux-gnu --with-selinux\nSudoers policy plugin version 1.8.9p5\nSudoers file grammar version 43\nSudoers path: /etc/sudoers\nAuthentication methods: 'pam'\nSyslog facility if syslog is being used for logging: authpriv\nSyslog priority to use when user authenticates successfully: notice\nSyslog priority to use when user authenticates unsuccessfully: alert\nSend mail if the user is not in sudoers\nUse a separate timestamp for each user/tty combo\nLecture user the first time they run sudo\nRoot may run sudo\nAllow some information gathering to give useful error messages\nRequire fully-qualified hostnames in the sudoers file\nVisudo will honor the EDITOR environment variable\nSet the LOGNAME and USER environment variables\nLength at which to wrap log file lines (0 for no wrap): 80\nAuthentication timestamp timeout: 15.0 minutes\nPassword prompt timeout: 0.0 minutes\nNumber of tries to enter a password: 3\nUmask to use or 0777 to use user's: 022\nPath to mail program: /usr/sbin/sendmail\nFlags for mail program: -t\nAddress to send mail to: root\nSubject line for mail messages: *** SECURITY information for %h ***\nIncorrect password message: Sorry, try again.\nPath to authentication timestamp dir: /var/lib/sudo\nDefault password prompt: [sudo] password for %p: \nDefault user to run commands as: root\nValue to override user's $PATH with: /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin\nPath to the editor for use by visudo: /usr/bin/editor\nWhen to require a password for 'list' pseudocommand: any\nWhen to require a password for 'verify' pseudocommand: all\nFile descriptors &gt;= 3 will be closed before executing a command\nEnvironment variables to check for sanity:\n    TZ\n    TERM\n    LINGUAS\n    LC_*\n    LANGUAGE\n    LANG\n    COLORTERM\nEnvironment variables to remove:\n    RUBYOPT\n    RUBYLIB\n    PYTHONUSERBASE\n    PYTHONINSPECT\n    PYTHONPATH\n    PYTHONHOME\n    TMPPREFIX\n    ZDOTDIR\n    READNULLCMD\n    NULLCMD\n    FPATH\n    PERL5DB\n    PERL5OPT\n    PERL5LIB\n    PERLLIB\n    PERLIO_DEBUG \n    JAVA_TOOL_OPTIONS\n    SHELLOPTS\n    GLOBIGNORE\n    PS4\n    BASH_ENV\n    ENV\n    TERMCAP\n    TERMPATH\n    TERMINFO_DIRS\n    TERMINFO\n    _RLD*\n    LD_*\n    PATH_LOCALE\n    NLSPATH\n    HOSTALIASES\n    RES_OPTIONS\n    LOCALDOMAIN\n    CDPATH\n    IFS\nEnvironment variables to preserve:\n    JAVA_HOME\n    TRAVIS\n    CI\n    DEBIAN_FRONTEND\n    XAUTHORIZATION\n    XAUTHORITY\n    PS2\n    PS1\n    PATH\n    LS_COLORS\n    KRB5CCNAME\n    HOSTNAME\n    HOME\n    DISPLAY\n    COLORS\nLocale to use while parsing sudoers: C\nDirectory in which to store input/output logs: /var/log/sudo-io\nFile in which to store the input/output log: %{seq}\nAdd an entry to the utmp/utmpx file when allocating a pty\nPAM service name to use\nPAM service name to use for login shells\nCreate a new PAM session for the command to run in\nMaximum I/O log sequence number: 0\nLocal IP address and netmask pairs:\n    10.240.0.28/255.255.255.255\n    172.17.0.1/255.255.0.0\nSudoers I/O plugin version 1.8.9p5\ngzip version\ngzip 1.6\nCopyright (C) 2007, 2010, 2011 Free Software Foundation, Inc.\nCopyright (C) 1993 Jean-loup Gailly.\nThis is free software.  You may redistribute copies of it under the terms of\nthe GNU General Public License &lt;http://www.gnu.org/licenses/gpl.html&gt;.\nThere is NO WARRANTY, to the extent permitted by law.\nWritten by Jean-loup Gailly.\nzip version\nCopyright (c) 1990-2008 Info-ZIP - Type 'zip \"-L\"' for software license.\nThis is Zip 3.0 (July 5th 2008), by Info-ZIP.\nCurrently maintained by E. Gordon.  Please send bug reports to\nthe authors using the web page at www.info-zip.org; see README for details.\nLatest sources and executables are at ftp://ftp.info-zip.org/pub/infozip,\nas of above date; see http://www.info-zip.org/ for other sites.\nCompiled with gcc 4.8.2 for Unix (Linux ELF) on Oct 21 2013.\nZip special compilation options:\n    USE_EF_UT_TIME       (store Universal Time)\n    BZIP2_SUPPORT        (bzip2 library version 1.0.6, 6-Sept-2010)\n        bzip2 code and library copyright (c) Julian R Seward\n        (See the bzip2 license for terms of use)\n    SYMLINK_SUPPORT      (symbolic links supported)\n    LARGE_FILE_SUPPORT   (can read and write large files on file system)\n    ZIP64_SUPPORT        (use Zip64 to store large files in archives)\n    UNICODE_SUPPORT      (store and read UTF-8 Unicode paths)\n    STORE_UNIX_UIDs_GIDs (store UID/GID sizes/values using new extra field)\n    UIDGID_NOT_16BIT     (old Unix 16-bit UID/GID extra field not used)\n    [encryption, version 2.91 of 05 Jan 2007] (modified for Zip 3)\nEncryption notice:\n    The encryption code of this program is not copyrighted and is\n    put in the public domain.  It was originally written in Europe\n    and, to the best of our knowledge, can be freely distributed\n    in both source and object forms from any country, including\n    the USA under License Exception TSU of the U.S. Export\n    Administration Regulations (section 740.13(e)) of 6 June 2002.\nZip environment options:\n             ZIP:  [none]\n          ZIPOPT:  [none]\nvim version\nVIM - Vi IMproved 7.4 (2013 Aug 10, compiled Nov 24 2016 16:43:18)\nIncluded patches: 1-52\nExtra patches: 8.0.0056\nModified by pkg-vim-maintainers@lists.alioth.debian.org\nCompiled by buildd@\nHuge version without GUI.  Features included (+) or not (-):\n+acl             +farsi           +mouse_netterm   +syntax\n+arabic          +file_in_path    +mouse_sgr       +tag_binary\n+autocmd         +find_in_path    -mouse_sysmouse  +tag_old_static\n-balloon_eval    +float           +mouse_urxvt     -tag_any_white\n-browse          +folding         +mouse_xterm     -tcl\n++builtin_terms  -footer          +multi_byte      +terminfo\n+byte_offset     +fork()          +multi_lang      +termresponse\n+cindent         +gettext         -mzscheme        +textobjects\n-clientserver    -hangul_input    +netbeans_intg   +title\n-clipboard       +iconv           +path_extra      -toolbar\n+cmdline_compl   +insert_expand   -perl            +user_commands\n+cmdline_hist    +jumplist        +persistent_undo +vertsplit\n+cmdline_info    +keymap          +postscript      +virtualedit\n+comments        +langmap         +printer         +visual\n+conceal         +libcall         +profile         +visualextra\n+cryptv          +linebreak       +python          +viminfo\n+cscope          +lispindent      -python3         +vreplace\n+cursorbind      +listcmds        +quickfix        +wildignore\n+cursorshape     +localmap        +reltime         +wildmenu\n+dialog_con      -lua             +rightleft       +windows\n+diff            +menu            -ruby            +writebackup\n+digraphs        +mksession       +scrollbind      -X11\n-dnd             +modify_fname    +signs           -xfontset\n-ebcdic          +mouse           +smartindent     -xim\n+emacs_tags      -mouseshape      -sniff           -xsmp\n+eval            +mouse_dec       +startuptime     -xterm_clipboard\n+ex_extra        +mouse_gpm       +statusline      -xterm_save\n+extra_search    -mouse_jsbterm   -sun_workshop    -xpm\n   system vimrc file: \"$VIM/vimrc\"\n     user vimrc file: \"$HOME/.vimrc\"\n 2nd user vimrc file: \"~/.vim/vimrc\"\n      user exrc file: \"$HOME/.exrc\"\n  fall-back for $VIM: \"/usr/share/vim\"\nCompilation: gcc -c -I. -Iproto -DHAVE_CONFIG_H     -g -O2 -fstack-protector --param=ssp-buffer-size=4 -Wformat -Werror=format-security -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=1      \nLinking: gcc   -Wl,-Bsymbolic-functions -Wl,-z,relro -Wl,--as-needed -o vim        -lm -ltinfo -lnsl  -lselinux  -lacl -lattr -lgpm -ldl    -L/usr/lib/python2.7/config-x86_64-linux-gnu -lpython2.7 -lpthread -ldl -lutil -lm -Xlinker -export-dynamic -Wl,-O1 -Wl,-Bsymbolic-functions      \niptables version\niptables v1.4.21\ncurl version\ncurl 7.35.0 (x86_64-pc-linux-gnu) libcurl/7.35.0 OpenSSL/1.0.1f zlib/1.2.8 libidn/1.28 librtmp/2.3\nwget version\nGNU Wget 1.15 built on linux-gnu.\nrsync version\nrsync  version 3.1.0  protocol version 31\ngimme version\nv1.2.0\nnvm version\n0.33.6\nperlbrew version\n/home/travis/perl5/perlbrew/bin/perlbrew  - App::perlbrew/0.80\nphpenv version\nrbenv 1.1.1-25-g6aa70b6\nrvm version\nrvm 1.29.3 (latest) by Michal Papis, Piotr Kuczynski, Wayne E. Seguin [https://rvm.io]\ndefault ruby version\nruby 2.4.1p111 (2017-03-22 revision 58053) [x86_64-linux]\nCouchDB version\ncouchdb 1.6.1\nElasticSearch version\n5.5.0\nInstalled Firefox version\nfirefox 56.0.2\nMongoDB version\nMongoDB 3.4.10\n[1mPhantomJS version\n2.1.1\nPre-installed PostgreSQL versions\n9.2.24\n9.3.20\n9.4.15\n9.5.10\n9.6.6\nRabbitMQ Version\n3.6.14\nRedis version\nredis-server 4.0.6\nriak version\n2.2.3\nPre-installed Go versions\n1.7.4\nant version\nApache Ant(TM) version 1.9.3 compiled on April 8 2014\nmvn version\nApache Maven 3.5.2 (138edd61fd100ec658bfa2d307c43b76940a5d7d; 2017-10-18T07:58:13Z)\nMaven home: /usr/local/maven-3.5.2\nJava version: 1.8.0_151, vendor: Oracle Corporation\nJava home: /usr/lib/jvm/java-8-oracle/jre\nDefault locale: en_US, platform encoding: UTF-8\nOS name: \"linux\", version: \"4.4.0-98-generic\", arch: \"amd64\", family: \"unix\"\ngradle version\n------------------------------------------------------------\nGradle 4.0.1\n------------------------------------------------------------\nBuild time:   2017-07-07 14:02:41 UTC\nRevision:     38e5dc0f772daecca1d2681885d3d85414eb6826\nGroovy:       2.4.11\nAnt:          Apache Ant(TM) version 1.9.6 compiled on June 29 2015\nJVM:          1.8.0_151 (Oracle Corporation 25.151-b12)\nOS:           Linux 4.4.0-98-generic amd64\nlein version\nLeiningen 2.8.1 on Java 1.8.0_151 Java HotSpot(TM) 64-Bit Server VM\nPre-installed Node.js versions\nv4.8.6\nv6.12.0\nv6.12.1\nv8.9\nv8.9.1\nphpenv versions\n  system\n  5.6\n* 5.6.32 (set by /home/travis/.phpenv/version)\n  7.0\n  7.0.25\n  7.1\n  7.1.11\n  hhvm\n  hhvm-stable\ncomposer --version\nComposer version 1.5.2 2017-09-11 16:59:25\nPre-installed Ruby versions\nruby-2.2.7\nruby-2.3.4\nruby-2.4.1\nUpdating gimme\ngit.checkout\n0.69s$ git clone --depth=50 --branch=master https://github.com/fwhezfwhez/errorx.git fwhezfwhez/errorx\nCloning into 'fwhezfwhez/errorx'...\nremote: Enumerating objects: 74, done.\nremote: Counting objects: 100% (74/74), done.\nremote: Compressing objects: 100% (50/50), done.\nReceiving objects: 100% (172/172), 47.28 KiB | 2.06 MiB/s, done.\nremote: Total 172 (delta 41), reused 53 (delta 22), pack-reused 98\nResolving deltas: 100% (90/90), done.\n$ cd fwhezfwhez/errorx\n$ git checkout -qf ec0ba15dd5fef2db0c8b9989002a18d768e025de\nSetting environment variables from .travis.yml\n$ export GOARCH=amd64\n0.04s$ GIMME_OUTPUT=\"$(gimme 1.10.x | tee -a ${TRAVIS_HOME}/.bashrc)\" &amp;&amp; eval \"$GIMME_OUTPUT\"\ngo version go1.10.8 linux/amd64\n$ export GOPATH=${TRAVIS_HOME}/gopath\n$ export PATH=${TRAVIS_HOME}/gopath/bin:$PATH\n$ mkdir -p ${TRAVIS_HOME}/gopath/src/github.com/fwhezfwhez/errorx\n$ tar -Pczf ${TRAVIS_TMPDIR}/src_archive.tar.gz -C ${TRAVIS_BUILD_DIR} . &amp;&amp; tar -Pxzf ${TRAVIS_TMPDIR}/src_archive.tar.gz -C ${TRAVIS_HOME}/gopath/src/github.com/fwhezfwhez/errorx\n$ export TRAVIS_BUILD_DIR=${TRAVIS_HOME}/gopath/src/github.com/fwhezfwhez/errorx\n$ cd ${TRAVIS_HOME}/gopath/src/github.com/fwhezfwhez/errorx\n$ gimme version\nv1.5.3\n$ go version\ngo version go1.10.8 linux/amd64\ngo.env\n$ go env\nGOARCH=\"amd64\"\nGOBIN=\"\"\nGOCACHE=\"/home/travis/.cache/go-build\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/travis/gopath\"\nGORACE=\"\"\nGOROOT=\"/home/travis/.gimme/versions/go1.10.8.linux.amd64\"\nGOTMPDIR=\"\"\nGOTOOLDIR=\"/home/travis/.gimme/versions/go1.10.8.linux.amd64/pkg/tool/linux_amd64\"\nGCCGO=\"gccgo\"\nCC=\"gcc\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\nCGO_CFLAGS=\"-g -O2\"\nCGO_CPPFLAGS=\"\"\nCGO_CXXFLAGS=\"-g -O2\"\nCGO_FFLAGS=\"-g -O2\"\nCGO_LDFLAGS=\"-g -O2\"\nPKG_CONFIG=\"pkg-config\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build294018080=/tmp/go-build -gno-record-gcc-switches\"\nbefore_install.1\n0.14s$ go get github.com/fwhezfwhez/errorx\nbefore_install.2\n0.68s$ go get github.com/fwhezfwhez/go-queue\nUsing Go 1.5 Vendoring, not checking for Godeps\n3.13s$ go get -t -v ./...\npackage errorX: unrecognized import path \"errorX\" (import path does not begin with hostname)\nThe command \"eval go get -t -v ./... \" failed. Retrying, 2 of 3.\npackage errorX: unrecognized import path \"errorX\" (import path does not begin with hostname)\nThe command \"eval go get -t -v ./... \" failed. Retrying, 3 of 3.\npackage errorX: unrecognized import path \"errorX\" (import path does not begin with hostname)\nThe command \"eval go get -t -v ./... \" failed 3 times.\nThe command \"go get -t -v ./...\" failed and exited with 1 during .\nYour build has been stopped.\n</code></pre>\n"}, {"tags": ["go", "go-gin"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1548742659, "post_id": 54414043, "comment_id": 95639899, "body": "Make sure you have vendored both <code>gin</code> and <code>contrib&#47;static</code>. The error says that <code>Use</code> expects the handlerfunc type from <code>&quot;github.com&#47;supebirdgz&#47;amgmt&#47;vendor&#47;github.com&#47;gin-gonic&#47;gin&zwnj;&#8203;&quot;</code> (vendored package) but you are passing one from <code>&quot;github.com&#47;gin-gonic&#47;gin&quot;</code> (non vendored package). This suggest that you&#39;ve only vendored the <code>gin</code> package but not the <code>contrib&#47;static</code> one."}, {"owner": {"reputation": 73, "user_id": 10499507, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RmfCiR0CUIQ/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWZIqTg5NqPeMy65f-oXcF6UZF12A/mo/photo.jpg?sz=128", "display_name": "Zeng Vincent", "link": "https://stackoverflow.com/users/10499507/zeng-vincent"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1548744938, "post_id": 54414043, "comment_id": 95640740, "body": "@mkopriva thanks so much, I checked with &quot;govendor list&quot; and did find the non vendored package, it works after adding it."}], "answers": [{"tags": [], "owner": {"reputation": 483, "user_id": 10350764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f198c0e69cbca84b4a849cca0f37a60a?s=128&d=identicon&r=PG&f=1", "display_name": "fwhez", "link": "https://stackoverflow.com/users/10350764/fwhez"}, "is_accepted": false, "score": 1, "last_activity_date": 1548745310, "creation_date": 1548745310, "answer_id": 54415497, "question_id": 54414043, "link": "https://stackoverflow.com/questions/54414043/how-to-serve-statics-files-in-gin/54415497#54415497", "title": "How to serve statics files in Gin", "body": "<p>you forget to load file path like </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>  r := gin.Default()\n  r.LoadHTMLGlob(\"dist/*.html\")    // load the built dist path\n  r.LoadHTMLFiles(\"static/*/*\") //  load the static path\n  r.Static(\"/static\", \"./dist/static\")  // use the loaded source\n  r.StaticFile(\"/hello/\", \"dist/index.html\")  // use the loaded source\n\n  r.Run(\":8080\")\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 10499507, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RmfCiR0CUIQ/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWZIqTg5NqPeMy65f-oXcF6UZF12A/mo/photo.jpg?sz=128", "display_name": "Zeng Vincent", "link": "https://stackoverflow.com/users/10499507/zeng-vincent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4414, "favorite_count": 0, "closed_date": 1549969805, "answer_count": 1, "score": 1, "last_activity_date": 1597309247, "creation_date": 1548737552, "last_edit_date": 1597309247, "question_id": 54414043, "link": "https://stackoverflow.com/questions/54414043/how-to-serve-statics-files-in-gin", "closed_reason": "Duplicate", "title": "How to serve statics files in Gin", "body": "<p>by following the tutorial I try to connect the frontend (React) to backend API (Gin), but the <code>static.Serve</code> doesn't work, error prompted as below:</p>\n<pre><code>cannot use static.Serve(&quot;/&quot;, static.LocalFile(&quot;./views&quot;, true)) (type &quot;github.com/gin-gonic/gin&quot;.HandlerFunc) as type &quot;github.com/supebirdgz/amgmt/vendor/github.com/gin-gonic/gin&quot;.HandlerFunc in argument to router.Use\n</code></pre>\n<p>source:</p>\n<pre><code>import (\n    &quot;github.com/gin-gonic/gin&quot;\n    &quot;github.com/gin-gonic/contrib/static&quot;\n)\n\nfunc main()  {\n    router := gin.Default()\n    router.Use(static.Serve(&quot;/&quot;, static.LocalFile(&quot;./frontend&quot;, true)))\n    router.Run()\n}\n</code></pre>\n<p>Was something updated in Gin? I tried replacing static package with others, still the same.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 1, "creation_date": 1548750155, "post_id": 54413603, "comment_id": 95643102, "body": "var a = make(chan int) would also be the same"}], "tags": [], "owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "is_accepted": true, "score": 3, "last_activity_date": 1548734121, "creation_date": 1548734121, "answer_id": 54413603, "question_id": 54413564, "link": "https://stackoverflow.com/questions/54413564/whats-the-difference-between-var-a-chan-int-and-a-makechan-int/54413603#54413603", "title": "What&#39;s the difference between `var a chan int` and `a := make(chan int)`?", "body": "<p>Recall that <code>var name type</code> creates a variable named <code>name</code> of type <code>type</code> set to the <strong>default</strong> value for that type.  This means that <code>var a chan int</code> creates a channel such that <code>a == nil</code>.</p>\n\n<p><code>var a chan int = make(chan int)</code> and <code>a := make(chan int)</code> are, however, the same.</p>\n"}, {"comments": [{"owner": {"reputation": 1562, "user_id": 3123171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yI739.jpg?s=128&g=1", "display_name": "sadiq", "link": "https://stackoverflow.com/users/3123171/sadiq"}, "edited": false, "score": 1, "creation_date": 1564133516, "post_id": 54413614, "comment_id": 100938690, "body": "A simply in-depth answer, unbuffered and nil channel.  <code>var a chan int</code> and <code>a := make(chan int)</code> are not the exact same thing."}], "tags": [], "owner": {"reputation": 3224, "user_id": 6878708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567e055e3d71ce025d8560333e48dfb9?s=128&d=identicon&r=PG&f=1", "display_name": "nightfury1204", "link": "https://stackoverflow.com/users/6878708/nightfury1204"}, "is_accepted": false, "score": 7, "last_activity_date": 1559718616, "last_edit_date": 1559718616, "creation_date": 1548734255, "answer_id": 54413614, "question_id": 54413564, "link": "https://stackoverflow.com/questions/54413564/whats-the-difference-between-var-a-chan-int-and-a-makechan-int/54413614#54413614", "title": "What&#39;s the difference between `var a chan int` and `a := make(chan int)`?", "body": "<p><code>a := make(chan int)</code> creates unbuffered channel. That channel with zero buffer. You can send data through it.</p>\n\n<p><code>var a chan int</code> creates channel variable and sets it to default value which is <strong>nil</strong>. And a <strong>nil</strong> channel is always blocking, that's why your program is deadlocked. You can not send data in <strong>nil</strong> channel.</p>\n\n<p>If you print the values, you will see the difference.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var i chan int\n    fmt.Println(i)\n    a := make(chan int)\n    fmt.Println(a)\n}\n</code></pre>\n\n<p>Go playground link: <a href=\"https://play.golang.org/p/Bxr6qRfNqZd\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Bxr6qRfNqZd</a></p>\n"}, {"tags": [], "owner": {"reputation": 483, "user_id": 10350764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f198c0e69cbca84b4a849cca0f37a60a?s=128&d=identicon&r=PG&f=1", "display_name": "fwhez", "link": "https://stackoverflow.com/users/10350764/fwhez"}, "is_accepted": false, "score": 1, "last_activity_date": 1548745807, "creation_date": 1548745807, "answer_id": 54415613, "question_id": 54413564, "link": "https://stackoverflow.com/questions/54413564/whats-the-difference-between-var-a-chan-int-and-a-makechan-int/54415613#54415613", "title": "What&#39;s the difference between `var a chan int` and `a := make(chan int)`?", "body": "<p><code>var x chan int</code> is only a declare for 'x' , you only create a val in the stack without actual memory malloc in the heap.however,</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>var x chan int\nx = make(chan int, 0)\n</code></pre>\n\n<p>this way can actually malloc some memory in the heap for this x.</p>\n\n<p>By the way, whether a val built in the stack or the heap  is telled apart fuzzily in golang. For those reference types like map,slice,chan type, they all should <code>make()</code> before put to used, or it will panic as nil point error</p>\n"}], "owner": {"reputation": 3043, "user_id": 3480199, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f27d29e6c62b1cb98d185e81397f6ca3?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/3480199/zen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 839, "favorite_count": 1, "accepted_answer_id": 54413603, "answer_count": 3, "score": 2, "last_activity_date": 1559718616, "creation_date": 1548733814, "question_id": 54413564, "link": "https://stackoverflow.com/questions/54413564/whats-the-difference-between-var-a-chan-int-and-a-makechan-int", "title": "What&#39;s the difference between `var a chan int` and `a := make(chan int)`?", "body": "<p>Today I'm learning channels and goroutine of go. And I met some phenomenon which confuses me.</p>\n\n<p>My go file looks like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc testRoutine(number int, channel chan int) {\n    channel &lt;- number\n}\n\n\nfunc main() {\n//    var a chan int\n    a := make(chan int)\n    b := make(chan int)\n    go testRoutine(1, a)\n    go testRoutine(2, b)\n\n    c, d := &lt;-a, &lt;-b\n    fmt.Printf(\"%d %d\\n\", c, d)\n}\n</code></pre>\n\n<p>it works well when I used syntax <code>a := make(chan int)</code>.</p>\n\n<p>But when I changed <code>a := make(chan int)</code> to <code>var a chan int</code>, I got panic report:</p>\n\n<pre><code>fatal error: all goroutines are asleep - deadlock!\n\ngoroutine 1 [chan receive (nil chan)]:\nmain.main()\n    /Users/marioluisgarcia/Local/practice/go/cache/var_make_diff.go:19 +0xc7\n\ngoroutine 18 [chan send (nil chan)]:\nmain.testRoutine(0x1, 0x0)\n    /Users/marioluisgarcia/Local/practice/go/cache/var_make_diff.go:8 +0x3f\ncreated by main.main\n    /Users/marioluisgarcia/Local/practice/go/cache/var_make_diff.go:16 +0x7c\n\ngoroutine 19 [chan send]:\nmain.testRoutine(0x2, 0xc42008a060)\n    /Users/marioluisgarcia/Local/practice/go/cache/var_make_diff.go:8 +0x3f\ncreated by main.main\n    /Users/marioluisgarcia/Local/practice/go/cache/var_make_diff.go:17 +0xa7\n</code></pre>\n\n<p>So, is there any difference between <code>var a chan int</code> and <code>a := make(chan int)</code>, and why this panic phenomenon was triggered?</p>\n"}, {"tags": ["go", "middleware", "ab-testing", "go-gin"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10831385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69cc7c24cc0d3ea48426326107326e83?s=128&d=identicon&r=PG&f=1", "display_name": "Felix Septem", "link": "https://stackoverflow.com/users/10831385/felix-septem"}, "edited": false, "score": 0, "creation_date": 1548753114, "post_id": 54415711, "comment_id": 95644632, "body": "not simple random strategy, sometimes related with user&#39;s metadata"}], "tags": [], "owner": {"reputation": 483, "user_id": 10350764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f198c0e69cbca84b4a849cca0f37a60a?s=128&d=identicon&r=PG&f=1", "display_name": "fwhez", "link": "https://stackoverflow.com/users/10350764/fwhez"}, "is_accepted": false, "score": 0, "last_activity_date": 1548746229, "creation_date": 1548746229, "answer_id": 54415711, "question_id": 54413032, "link": "https://stackoverflow.com/questions/54413032/how-can-i-get-url-in-gin-middleware/54415711#54415711", "title": "How can I get url in Gin middleware?", "body": "<p>I suppose you want to add a new functional middleware and test it in A/B style.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func ServiceMiddleWare() gin.HandleFunc {\n    return func(c *gin.Context){\n        r := rand.New(rand.NewSource(time.Now().UnixNano()))\n        if r.Intn(100) &lt; 50 {\n           c.Next()\n           return\n        } \n\n        // service_logic\n        fmt.Println(\"add a new service\")\n        c.Next()\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4909015, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-unNSN2rWUNY/AAAAAAAAAAI/AAAAAAAAAEY/HUEwt3U8zeg/photo.jpg?sz=128", "display_name": "Kanibolockey Pavel", "link": "https://stackoverflow.com/users/4909015/kanibolockey-pavel"}, "is_accepted": false, "score": 0, "last_activity_date": 1608381242, "creation_date": 1608381242, "answer_id": 65369859, "question_id": 54413032, "link": "https://stackoverflow.com/questions/54413032/how-can-i-get-url-in-gin-middleware/65369859#65369859", "title": "How can I get url in Gin middleware?", "body": "<p>Use</p>\n<pre><code>c.FullPath()\n</code></pre>\n<p>for get current URL path</p>\n"}], "owner": {"reputation": 23, "user_id": 10831385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69cc7c24cc0d3ea48426326107326e83?s=128&d=identicon&r=PG&f=1", "display_name": "Felix Septem", "link": "https://stackoverflow.com/users/10831385/felix-septem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 832, "favorite_count": 1, "answer_count": 2, "score": -1, "last_activity_date": 1608381242, "creation_date": 1548729146, "last_edit_date": 1597431373, "question_id": 54413032, "link": "https://stackoverflow.com/questions/54413032/how-can-i-get-url-in-gin-middleware", "title": "How can I get url in Gin middleware?", "body": "<p>I want to do a A/B test in a Gin's middleware, I want to pass <code>url:usermeta</code> as a key-value to the A/B test service. How can I achieve this goal?Or any other grace way?</p>\n"}, {"tags": ["go", "pipe"], "answers": [{"comments": [{"owner": {"reputation": 1986, "user_id": 4180276, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f34129a97d735e6e19247c911626cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "nadermx", "link": "https://stackoverflow.com/users/4180276/nadermx"}, "edited": false, "score": 0, "creation_date": 1548736845, "post_id": 54412863, "comment_id": 95638284, "body": "So it compiles, but when I run it the cmd2 doesn&#39;t see the input"}, {"owner": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "reply_to_user": {"reputation": 1986, "user_id": 4180276, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f34129a97d735e6e19247c911626cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "nadermx", "link": "https://stackoverflow.com/users/4180276/nadermx"}, "edited": false, "score": 0, "creation_date": 1548737741, "post_id": 54412863, "comment_id": 95638494, "body": "That makes sense given the way that pipes work. Reads from <code>pipeR</code> return bytes written to <code>pipeW</code>. In other words, we ought to be writing something into <code>pipeW</code>"}, {"owner": {"reputation": 1986, "user_id": 4180276, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f34129a97d735e6e19247c911626cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "nadermx", "link": "https://stackoverflow.com/users/4180276/nadermx"}, "edited": false, "score": 0, "creation_date": 1548737856, "post_id": 54412863, "comment_id": 95638521, "body": "right, but that&#39;s where I get confused, i was trying to do that with <code>fd3.Write(cmdstdout)</code> in the original question"}, {"owner": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "reply_to_user": {"reputation": 1986, "user_id": 4180276, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f34129a97d735e6e19247c911626cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "nadermx", "link": "https://stackoverflow.com/users/4180276/nadermx"}, "edited": false, "score": 0, "creation_date": 1548738059, "post_id": 54412863, "comment_id": 95638573, "body": "I think that ought to work, except you gotta do the write before the read and then utilize the read to get the data."}, {"owner": {"reputation": 1986, "user_id": 4180276, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f34129a97d735e6e19247c911626cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "nadermx", "link": "https://stackoverflow.com/users/4180276/nadermx"}, "edited": false, "score": 0, "creation_date": 1548738896, "post_id": 54412863, "comment_id": 95638760, "body": "I went ahead and updated the question, trying to write before the read, as well ad better named variables, but it still does not find the stream"}, {"owner": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "reply_to_user": {"reputation": 1986, "user_id": 4180276, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f34129a97d735e6e19247c911626cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "nadermx", "link": "https://stackoverflow.com/users/4180276/nadermx"}, "edited": false, "score": 0, "creation_date": 1548739383, "post_id": 54412863, "comment_id": 95638888, "body": "could you update it one more time with the full source so I could see how <code>cmd2</code> is declared"}, {"owner": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "reply_to_user": {"reputation": 1986, "user_id": 4180276, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f34129a97d735e6e19247c911626cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "nadermx", "link": "https://stackoverflow.com/users/4180276/nadermx"}, "edited": false, "score": 0, "creation_date": 1548739623, "post_id": 54412863, "comment_id": 95638945, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/187464/discussion-between-daplho-and-nadermx\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "is_accepted": true, "score": 1, "last_activity_date": 1548727930, "last_edit_date": 1548727930, "creation_date": 1548727404, "answer_id": 54412863, "question_id": 54412764, "link": "https://stackoverflow.com/questions/54412764/cmd-extrafiles-fails-when-trying-to-pipe-to-it/54412863#54412863", "title": "cmd.ExtraFiles fails when trying to pipe to it", "body": "<p>The types don't quite line up here. Specifically,</p>\n\n<pre><code>cmd.StdoutPipe\n</code></pre>\n\n<p>returns an <code>io.ReadCloser</code></p>\n\n<p>whereas</p>\n\n<pre><code>pipeR.Read\n</code></pre>\n\n<p>is expecting an <code>[]byte</code> as input.</p>\n\n<p>I believe you are ultimately looking to utilize the <a href=\"https://golang.org/pkg/os/#File.Read\" rel=\"nofollow noreferrer\">Read</a> and <a href=\"https://golang.org/pkg/os/#File.Write\" rel=\"nofollow noreferrer\">Write</a> functions of the <a href=\"https://golang.org/pkg/os/\" rel=\"nofollow noreferrer\">os package</a> to accomplish your task as shown below:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n    \"os/exec\"\n)\n\nfunc main() {\n    cmd := exec.Command(\"command\", \"-o\", \"-\")\n    pipeR, pipeW, _ := os.Pipe()\n    cmd.ExtraFiles = []*os.File{\n        pipeW,\n    }\n    cmd.Start()\n    cmdstdout, err := cmd.StdoutPipe()\n    if err != nil {\n        log.Printf(\"pipeThruError: %v\\n\", err)\n        os.Exit(1)\n    }\n\n    buf := make([]byte, 100)\n    cmdstdout.Read(buf)\n\n    pipeR.Close()\n    pipeW.Close()\n    fd3 := os.NewFile(3, \"/proc/self/fd/3\")\n    fd3.Write(buf)\n    fd3.Close()\n</code></pre>\n\n<p>}</p>\n"}], "owner": {"reputation": 1986, "user_id": 4180276, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f34129a97d735e6e19247c911626cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "nadermx", "link": "https://stackoverflow.com/users/4180276/nadermx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 54412863, "answer_count": 1, "score": 1, "last_activity_date": 1548739755, "creation_date": 1548726475, "last_edit_date": 1548739755, "question_id": 54412764, "link": "https://stackoverflow.com/questions/54412764/cmd-extrafiles-fails-when-trying-to-pipe-to-it", "title": "cmd.ExtraFiles fails when trying to pipe to it", "body": "<p>I'm trying to have a pipe go to the <code>cmd.ExtraFiles</code> </p>\n\n<p>I currently have the error saying </p>\n\n<pre><code>cannot use cmdstdout (type io.ReadCloser) as type []byte in argument to pipeR.Read\ncannot use cmdstdout (type io.ReadCloser) as type []byte in argument to fd3.Write\n</code></pre>\n\n<p>This is the gocode I have thus far</p>\n\n<pre><code>cmd2 = exec.Command(\"-i\", \"pipe:0\", \"-i\", \"pipe:1\")\ncmd1 := exec.Command(\"command\", \"-o\", \"-\")\npipeR, pipeW, _ := os.Pipe()\ncmd2.ExtraFiles = []*os.File{\n    pipeW,\n}\ncmd1.Start()\ncmd1stdout, err := cmd1.StdoutPipe()\nif err != nil {\n    log.Printf(\"pipeThruError: %v\\n\", err)\n    return err\n}\nfd3 := os.NewFile(3, \"/proc/self/fd/3\")\nfd3.Write(cmd1stdout)\npipeR.Read(cmd1stdout)\npipeR.Close()\npipeW.Close()\nfd3.Close()\ncmd3 = exec.Command(\"command\", \"-o\", \"-\")\nstdin, stdinErr := cmd3.StdoutPipe()\nif stdinErr != nil {\n    log.Printf(\"pipeThruFStdinErr: %v\\n\", stdinErr)\n    return stdinErr\n}\ncmd3.Start()\ncmd2.Stdin = stdin\n</code></pre>\n\n<p>EDIT: Added full scope\nThe goal is to have cmd2 accept input via cmd3 by <code>Stdin</code>, and have cmd1 output piped via <code>ExtraFiles</code></p>\n"}, {"tags": ["go", "govendor"], "comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 1, "creation_date": 1548723200, "post_id": 54412380, "comment_id": 95635512, "body": "What prevents you from using one of <a href=\"https://github.com/golang/go/wiki/PackageManagementTools\" rel=\"nofollow noreferrer\">several, readily-available tools</a> for Vendoring?"}, {"owner": {"reputation": 1260, "user_id": 695459, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8766f0303f842207f52c2789896a7214?s=128&d=identicon&r=PG", "display_name": "mikijov", "link": "https://stackoverflow.com/users/695459/mikijov"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1548723443, "post_id": 54412380, "comment_id": 95635567, "body": "I can think of several ways of doing it, but I feel like I am working against the grain. Git submodule would work, go mod + godep would work... But this does not feel clean. I suppose I could use only godep, but should I even now that modules are in?"}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 1, "creation_date": 1548724472, "post_id": 54412380, "comment_id": 95635775, "body": "&quot;Clean&quot; is a bit too vague to formulate an answer against.  Can you provide a more precise metric?"}, {"owner": {"reputation": 1260, "user_id": 695459, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8766f0303f842207f52c2789896a7214?s=128&d=identicon&r=PG", "display_name": "mikijov", "link": "https://stackoverflow.com/users/695459/mikijov"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 1, "creation_date": 1548725869, "post_id": 54412380, "comment_id": 95636059, "body": "Go is opinionated on just about everything. I was hoping there was an official opinion on vendoring non-Go dependencies. Clean simply means that I want to do what the rest of the community is doing and not invent my own way."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1548770579, "post_id": 54412380, "comment_id": 95655403, "body": "There is no &quot;official opinion&quot; on the topic that I&#39;ve ever seen. Do whatever works best for your project. Personally, I wouldn&#39;t vendor them at all; vendoring is for importing Go libraries, and you&#39;re talking about non-Go code. If it&#39;s not involved in the compile phase, it&#39;s not a module, and shouldn&#39;t be treated as one. But that&#39;s just my opinion."}, {"owner": {"reputation": 1260, "user_id": 695459, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8766f0303f842207f52c2789896a7214?s=128&d=identicon&r=PG", "display_name": "mikijov", "link": "https://stackoverflow.com/users/695459/mikijov"}, "edited": false, "score": 0, "creation_date": 1548797242, "post_id": 54412380, "comment_id": 95669759, "body": "Well, I consider my DB schema part of my app... Any way thanks. It is useful to know that I did not miss the &quot;official opinion&quot;."}], "owner": {"reputation": 1260, "user_id": 695459, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8766f0303f842207f52c2789896a7214?s=128&d=identicon&r=PG", "display_name": "mikijov", "link": "https://stackoverflow.com/users/695459/mikijov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548722924, "creation_date": 1548722924, "question_id": 54412380, "link": "https://stackoverflow.com/questions/54412380/what-is-idiomatic-way-to-vendor-non-go-dependencies", "title": "What is idiomatic way to vendor non-go dependencies", "body": "<p>What is the idiomatic way to vendor or otherwise include non-go dependencies?</p>\n\n<p>I have a project which uses Postgres stored procedures for audit tracking. Those stored procedures are in a separate Git repo. In node projects, I would use <code>git submodule</code> to include it into my project. But in Go, vendoring is the standard. Go module and other vendoring tools are generally made for managing Go dependencies. </p>\n\n<p>So, back to the original question, what is the idiomatic way to import general non-Go dependencies?</p>\n"}, {"tags": ["linux", "go", "chown"], "comments": [{"owner": {"reputation": 379, "user_id": 4424548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b7e210fee0a6c4c2174bb67daeeb2a?s=128&d=identicon&r=PG&f=1", "display_name": "Erkin Djindjiev", "link": "https://stackoverflow.com/users/4424548/erkin-djindjiev"}, "edited": false, "score": 0, "creation_date": 1548724193, "post_id": 54411848, "comment_id": 95635709, "body": "As long as the user has privileges to perform the action against the directory, as long as you run the program as that user, this should work as expected. os.Chown should operate the same <code>chown</code> from the command line."}, {"owner": {"reputation": 793, "user_id": 90506, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a4bffdc2e88202aa1c2b74e165355199?s=128&d=identicon&r=PG", "display_name": "farhany", "link": "https://stackoverflow.com/users/90506/farhany"}, "reply_to_user": {"reputation": 379, "user_id": 4424548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b7e210fee0a6c4c2174bb67daeeb2a?s=128&d=identicon&r=PG&f=1", "display_name": "Erkin Djindjiev", "link": "https://stackoverflow.com/users/4424548/erkin-djindjiev"}, "edited": false, "score": 0, "creation_date": 1548734209, "post_id": 54411848, "comment_id": 95637699, "body": "@ErkinDjindjiev The problem is, the program is run as a local user while LDAP provides the various groups by which we control access based on user group membership. I see no other solution other than using sudoers to let it execute certain commands, like chown. I could possibly run as an LDAP user who would have membership in various groups so that it can change group ownership. Not sure if I could use setuid/setguid bits on a wrapper script. Worried about creating security holes."}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1548737670, "post_id": 54411848, "comment_id": 95638476, "body": "I think the short answer is no, there is no better option. You can drop privileges easily, but escalating them is hard, for a reason."}, {"owner": {"reputation": 793, "user_id": 90506, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a4bffdc2e88202aa1c2b74e165355199?s=128&d=identicon&r=PG", "display_name": "farhany", "link": "https://stackoverflow.com/users/90506/farhany"}, "reply_to_user": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1548781362, "post_id": 54411848, "comment_id": 95662456, "body": "@tripleee I understand and was trying to think of a way to not escalate privileges and still be able to chown based on membership. I&#39;ll try adding the local user to all the respective groups and that might work. I&#39;ll post later.   Speaking of privs, how does one drop them?"}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 1, "creation_date": 1548783135, "post_id": 54411848, "comment_id": 95663304, "body": "If you are root, you can <code>su</code> (or in Python <code>os.setuid()</code>) to any user you like. Another option might be to write a small <code>setuid</code> program which only performs the privileged operation after checking a number of conditions."}, {"owner": {"reputation": 793, "user_id": 90506, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a4bffdc2e88202aa1c2b74e165355199?s=128&d=identicon&r=PG", "display_name": "farhany", "link": "https://stackoverflow.com/users/90506/farhany"}, "reply_to_user": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1548800865, "post_id": 54411848, "comment_id": 95671069, "body": "@triplee that sounds good with an entry in sudoers to restrict to execution of said shell script that has been hardened down. Thanks for the suggestions."}], "owner": {"reputation": 793, "user_id": 90506, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a4bffdc2e88202aa1c2b74e165355199?s=128&d=identicon&r=PG", "display_name": "farhany", "link": "https://stackoverflow.com/users/90506/farhany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1548734398, "creation_date": 1548718639, "last_edit_date": 1548734398, "question_id": 54411848, "link": "https://stackoverflow.com/questions/54411848/running-os-chown-and-escalating-privileges", "title": "Running os.Chown, and escalating privileges", "body": "<p>I need to run an os.Chown() on a directory, but I have no idea how to do this safely. I have the user that the binary runs as in sudoers, but since this is an internal function, how would I escalate privileges? </p>\n\n<p>I don't want to shell to find or chown in Linux with a sudo, however, that would work. But is there a better option?</p>\n"}, {"tags": ["go", "google-cloud-platform", "google-cloud-functions", "go-modules"], "answers": [{"comments": [{"owner": {"reputation": 1713, "user_id": 4052858, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/710d5f65b404307fea9b5a1564c60549?s=128&d=identicon&r=PG&f=1", "display_name": "N.F.", "link": "https://stackoverflow.com/users/4052858/n-f"}, "edited": false, "score": 0, "creation_date": 1596447372, "post_id": 54427901, "comment_id": 111804095, "body": "<code>metadata.FromContext</code> will fail when using vendor according to <a href=\"https://github.com/googleapis/google-cloud-go/issues/1947\" rel=\"nofollow noreferrer\">this post</a>. Any solutions without vendoring?"}], "tags": [], "owner": {"reputation": 1388, "user_id": 9609198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dc96575acd1296cba81df24ffd919d4?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Bui-Palsulich", "link": "https://stackoverflow.com/users/9609198/tyler-bui-palsulich"}, "is_accepted": true, "score": 6, "last_activity_date": 1548788452, "last_edit_date": 1548788452, "creation_date": 1548788147, "answer_id": 54427901, "question_id": 54410963, "link": "https://stackoverflow.com/questions/54410963/error-when-trying-to-deploy-google-cloud-function-in-go-1-11-using-go-modules/54427901#54427901", "title": "Error when trying to deploy Google cloud function in Go 1.11 using go modules", "body": "<p>Modules are preferred by the builder over vendor. If there is a <code>go.mod</code>, modules will be used. When you upload your function, it only includes the directory with your function at the root, not any directories one level up. So, when there is a <code>go.mod</code> and you have a replace directive pointing one level up, it will not work.</p>\n\n<p>The solution is to vendor and not upload the <code>go.mod</code>/<code>go.sum</code> files. When using <code>gcloud</code>, you can create a <code>.gcloudignore</code> file to do this for you. See <a href=\"https://cloud.google.com/functions/docs/concepts/go-runtime#specifying_dependencies\" rel=\"noreferrer\">https://cloud.google.com/functions/docs/concepts/go-runtime#specifying_dependencies</a> for more detail.</p>\n\n<p>Disclaimer: I work at Google and on this product.</p>\n"}], "owner": {"reputation": 73, "user_id": 7573460, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-l8O4VWtYNcw/AAAAAAAAAAI/AAAAAAAADQA/vG_GiqO-aqQ/photo.jpg?sz=128", "display_name": "samir elsharkawy", "link": "https://stackoverflow.com/users/7573460/samir-elsharkawy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2086, "favorite_count": 0, "accepted_answer_id": 54427901, "answer_count": 1, "score": 7, "last_activity_date": 1561984566, "creation_date": 1548713060, "last_edit_date": 1548713369, "question_id": 54410963, "link": "https://stackoverflow.com/questions/54410963/error-when-trying-to-deploy-google-cloud-function-in-go-1-11-using-go-modules", "title": "Error when trying to deploy Google cloud function in Go 1.11 using go modules", "body": "<p>I am having issues trying to deploy a Google cloud function in Go 1.11 using Go modules. I have have the following code structure in my <code>GOPATH</code>:</p>\n\n<pre><code>\u2514\u2500\u2500 example\n    \u251c\u2500\u2500 models\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 go.mod\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 models.go\n    \u2514\u2500\u2500 load\n        \u251c\u2500\u2500 fn.go\n        \u251c\u2500\u2500 go.mod\n        \u251c\u2500\u2500 go.sum\n        \u2514\u2500\u2500 vendor\n            \u2514\u2500\u2500 ....\n</code></pre>\n\n<p>the load/go.mod looks like the following:</p>\n\n<pre><code>module github.com/example/load\n\nrequire (\n    github.com/example/models v0.0.0\n)\n\nreplace github.com/example/models =&gt; ../models\n</code></pre>\n\n<p>When I try to deploy the function using the command</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>gcloud functions deploy load-data --entry-point GCSNewFileTrigger --runtime go111 --trigger-resource new_data --trigger-event google.storage.object.finalize\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>Deploying function (may take a while - up to 2 minutes)...failed.                                                                                                                                                                     \nERROR: (gcloud.functions.deploy) OperationError: code=3, message=Build failed: go: parsing /models/go.mod: open /models/go.mod: no such file or directory\ngo: error loading module requirements\n</code></pre>\n\n<p>The commands <code>go mod vendor</code> and <code>go mod verify</code> run successfully locally and I can see my local package <code>models</code> in the vendor folder of <code>load</code></p>\n"}, {"tags": ["go", "heroku", "deployment", "asset-pipeline", "assets"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 1, "creation_date": 1548712554, "post_id": 54410715, "comment_id": 95632704, "body": "see something like <a href=\"https://github.com/gobuffalo/packr\" rel=\"nofollow noreferrer\">github.com/gobuffalo/packr</a> or go-bindata"}, {"owner": {"reputation": 907, "user_id": 10088259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/590a29bb9182f252bc6e7e5885f3423a?s=128&d=identicon&r=PG&f=1", "display_name": "Fred Hors", "link": "https://stackoverflow.com/users/10088259/fred-hors"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1548716135, "post_id": 54410715, "comment_id": 95633826, "body": "It&#39;s the same. Both need to do something before build. I don&#39;t want to commit anything generated."}], "answers": [{"comments": [{"owner": {"reputation": 907, "user_id": 10088259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/590a29bb9182f252bc6e7e5885f3423a?s=128&d=identicon&r=PG&f=1", "display_name": "Fred Hors", "link": "https://stackoverflow.com/users/10088259/fred-hors"}, "edited": false, "score": 0, "creation_date": 1548726293, "post_id": 54412666, "comment_id": 95636140, "body": "Thanks a lot Alex, but I prefer not to use Docker on Heroku because it decrease the performances by being a layer further in the middle of the daily req/resp."}], "tags": [], "owner": {"reputation": 154, "user_id": 3093816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TNTDF.jpg?s=128&g=1", "display_name": "Alex Sharov", "link": "https://stackoverflow.com/users/3093816/alex-sharov"}, "is_accepted": false, "score": 1, "last_activity_date": 1548725671, "creation_date": 1548725671, "answer_id": 54412666, "question_id": 54410715, "link": "https://stackoverflow.com/questions/54410715/heroku-golang-asset-compilation-should-happen-during-builds-but-how/54412666#54412666", "title": "Heroku, golang asset compilation should happen during builds. But how?", "body": "<p>Heroku supports Docker deploy <a href=\"https://devcenter.heroku.com/categories/deploying-with-docker\" rel=\"nofollow noreferrer\">https://devcenter.heroku.com/categories/deploying-with-docker</a></p>\n\n<p>It means that any transpilations you can do on \"Docker build\" step</p>\n"}], "owner": {"reputation": 907, "user_id": 10088259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/590a29bb9182f252bc6e7e5885f3423a?s=128&d=identicon&r=PG&f=1", "display_name": "Fred Hors", "link": "https://stackoverflow.com/users/10088259/fred-hors"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1548725671, "creation_date": 1548711850, "question_id": 54410715, "link": "https://stackoverflow.com/questions/54410715/heroku-golang-asset-compilation-should-happen-during-builds-but-how", "title": "Heroku, golang asset compilation should happen during builds. But how?", "body": "<p>I'm using Heroku and Golang.</p>\n\n<p>I have one or many <code>.scss</code> files and I use a golang library to generate a <code>.css</code> from them.</p>\n\n<p>What I don't understand is how to generate the <code>.css</code> file during Heroku build step.</p>\n\n<p>As stated here <a href=\"https://devcenter.heroku.com/articles/release-phase#design-considerations\" rel=\"nofollow noreferrer\">https://devcenter.heroku.com/articles/release-phase#design-considerations</a>:</p>\n\n<blockquote>\n  <p>Asset compilation should happen during builds considering the dyno filesystem is ephemeral.</p>\n</blockquote>\n\n<p>I don't want to commit my generated files.</p>\n\n<p>Am I wrong?</p>\n"}, {"tags": ["go", "sqlx"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 3, "creation_date": 1548709921, "post_id": 54410013, "comment_id": 95631654, "body": "Don&#39;t ignore the error returned by Select."}, {"owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1548710210, "post_id": 54410013, "comment_id": 95631772, "body": "@Peteri&#39;ve edited and no error ...."}, {"owner": {"reputation": 14274, "user_id": 579078, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/xC5kj.png?s=128&g=1", "display_name": "\u11bc\u11ba\u11bc", "link": "https://stackoverflow.com/users/579078/%e1%86%bc%e1%86%ba%e1%86%bc"}, "edited": false, "score": 0, "creation_date": 1548710727, "post_id": 54410013, "comment_id": 95631991, "body": "What is the name of the table? (Try without quoting it)"}, {"owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "reply_to_user": {"reputation": 14274, "user_id": 579078, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/xC5kj.png?s=128&g=1", "display_name": "\u11bc\u11ba\u11bc", "link": "https://stackoverflow.com/users/579078/%e1%86%bc%e1%86%ba%e1%86%bc"}, "edited": false, "score": 0, "creation_date": 1548710988, "post_id": 54410013, "comment_id": 95632092, "body": "@pete Geo_commune but nope it&#39;s not working"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1548719239, "post_id": 54410013, "comment_id": 95634621, "body": "Your table seems to have much more columns than your struct has fields, wouldn&#39;t that be a problem when using <code>SELECT * ...</code>? Did you try a listing the four columns that have corresponding fields in the Commune struct? <a href=\"https://github.com/jmoiron/sqlx/blob/master/sqlx_test.go#L275-L281\" rel=\"nofollow noreferrer\">This test</a> seems to suggest that <code>Select</code> should return an error if you&#39;re missing a &quot;destination&quot; field, and in the code you provided you&#39;re not checking that specific error, since the result of your <code>db.Select</code> call isn&#39;t assigned to anything."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1548752906, "post_id": 54410013, "comment_id": 95644522, "body": "You&#39;re still not checking the error returned from <code>db.Select</code>, why? And what&#39;s the purpose of <code>db.Query</code> in your code? Use only one, not both."}, {"owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "edited": false, "score": 1, "creation_date": 1548759411, "post_id": 54410013, "comment_id": 95648540, "body": "@mpkopriva you&#39;re right it&#39;s that thanks , i miss some fields in my struct and i didn&#39;t truly checked the error of select"}], "answers": [{"comments": [{"owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "edited": false, "score": 0, "creation_date": 1548750618, "post_id": 54415941, "comment_id": 95643313, "body": "i have a 2019/01/29 09:29:13 pq: relation &quot;public.geo_commune&quot; does not exist error because my table is Geo_commune"}], "tags": [], "owner": {"reputation": 483, "user_id": 10350764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f198c0e69cbca84b4a849cca0f37a60a?s=128&d=identicon&r=PG&f=1", "display_name": "fwhez", "link": "https://stackoverflow.com/users/10350764/fwhez"}, "is_accepted": false, "score": 1, "last_activity_date": 1548747209, "creation_date": 1548747209, "answer_id": 54415941, "question_id": 54410013, "link": "https://stackoverflow.com/questions/54410013/sqlx-return-empty-struct-even-if-it-exist/54415941#54415941", "title": "sqlx return empty struct even if it exist", "body": "<p>I'm confused with your description.\ndid it throw <code>pq: relation \"geo_commune\" does not exist</code>?\nif it did, your datasource is incorrect.\nif it didn't,  try <code>select * from public.Geo_commune</code></p>\n"}], "owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 584, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1548751947, "creation_date": 1548708230, "last_edit_date": 1548751947, "question_id": 54410013, "link": "https://stackoverflow.com/questions/54410013/sqlx-return-empty-struct-even-if-it-exist", "title": "sqlx return empty struct even if it exist", "body": "<p>Here is my code  :</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/jmoiron/sqlx\"\n    _ \"github.com/lib/pq\"\n    \"log\"\n    \"time\"\n)\n\ntype Commune struct {\n    Id int `db:\"id\"`\n    Created time.Time `db:\"created\"`\n    Modified time.Time `db:\"modified\"`\n    Name string `db:\"name\"`\n}\n\nfunc main() {\n    var err error\n    db, err = sqlx.Connect(\"postgres\", \"user=toto \n    dbname=tata password=titi sslmode=disable\")\n    commune := []Commune{}\n    db.Select(&amp;commune, `SELECT * FROM \"Geo_commune\"  WHERE id=1  ORDER BY name ASC`)\n    rows, err2 := db.Query(`SELECT * FROM \"Geo_commune\"  WHERE id=1  ORDER BY name ASC`)\n    fmt.Println(commune)\n    fmt.Println(rows)\n    if err != nil {\n    log.Fatalln(err)\n    }\n     if err2 != nil {\n    log.Fatalln(err2)\n    }\n\n   }\n</code></pre>\n\n<p>here is the data in the database :</p>\n\n<p><a href=\"https://i.stack.imgur.com/qikBy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qikBy.png\" alt=\"enter image description here\"></a></p>\n\n<p>edit : the table_name :</p>\n\n<p><a href=\"https://i.stack.imgur.com/rpz7O.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rpz7O.png\" alt=\"enter image description here\"></a></p>\n\n<p>and i've even tried with : </p>\n\n<pre><code>db.Select(&amp;commune, `SELECT * FROM \"Geo_commune\"  WHERE id=1  ORDER BY name ASC`)\n</code></pre>\n\n<p>but the return is always empty and i'am sure that the data exists and i don't have a connection error.</p>\n\n<p>Without the <code>\"Geo_commune\"</code> \n rows, err2 := db.Query(<code>SELECT * FROM Geo_commune  WHERE id=1  ORDER BY name ASC</code>)\ni have a : \n2019/01/28 22:17:16 pq: relation \"geo_commune\" does not exist</p>\n\n<p>Regards</p>\n\n<p>edit my new tests :</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/jmoiron/sqlx\"\n    \"log\"\n    \"time\"\n    _ \"github.com/lib/pq\"\n)\ntype Commune struct {\n    Id int `db:\"id\"`\n    Created time.Time `db:\"created\"`\n    Modified time.Time `db:\"modified\"`\n    Name string `db:\"name\"`\n\n}\nvar db *sqlx.DB\nfunc main() {\n    var err error\n    db, err = sqlx.Connect(\"postgres\", \"user=toto dbname=titi password=tata sslmode=disable\")\n    commune := []Commune{}\n\n    if err != nil {\n        log.Fatalln(err)\n    }\n    db.Select(&amp;commune, `SELECT * FROM \"Geo_commune\"  WHERE id=1  ORDER BY name ASC`)\n    rows, err2 := db.Query(`SELECT * FROM \"Geo_commune\"  WHERE id=1  ORDER BY name ASC`)\n    if err != nil {\n        log.Fatalln(err)\n    }\n    if err2 != nil {\n        log.Fatalln(err2)\n    }\n\n\n    db.Select(&amp;commune, `SELECT * FROM public.Geo_commune  WHERE id=1  ORDER BY name ASC`)\n    rows, err2 = db.Query(`SELECT * FROM public.Geo_commune  WHERE id=1  ORDER BY name ASC`)\n    fmt.Println(commune)\n    fmt.Println(rows)\n    if err != nil {\n        log.Fatalln(err)\n    }\n    if err2 != nil {\n        log.Fatalln(err2)\n    }\n\n\n\n    }\n</code></pre>\n\n<p>gives me : </p>\n\n<pre><code>[]\n&lt;nil&gt;\n2019/01/29 09:50:06 pq: relation \"public.geo_commune\" does not exist\n</code></pre>\n"}, {"tags": ["dictionary", "go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1548695814, "post_id": 54407098, "comment_id": 95625051, "body": "That depends on what you mean by &quot;raise an error&quot;; in Go, errors are return values. In the case of a map the only possible &quot;error&quot; is that the requested key doesn&#39;t exist, so it might as well just be a boolean. However, to know the true answer behind any design decision, you&#39;d need to ask the designer, not the community at large."}, {"owner": {"reputation": 291, "user_id": 6851693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2d54fb03cffc196b59cd8cbec52b12d?s=128&d=identicon&r=PG&f=1", "display_name": "ydhhat", "link": "https://stackoverflow.com/users/6851693/ydhhat"}, "edited": false, "score": 0, "creation_date": 1548696588, "post_id": 54407098, "comment_id": 95625466, "body": "Why someone downvote my question? Tell me the reasons so I can ask better questions."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1548698505, "post_id": 54407098, "comment_id": 95626392, "body": "I downvoted for the normal reason: &quot;The question does not show any research effort; it unclear or not useful.&quot;  Most significantly, it is unclear."}, {"owner": {"reputation": 291, "user_id": 6851693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2d54fb03cffc196b59cd8cbec52b12d?s=128&d=identicon&r=PG&f=1", "display_name": "ydhhat", "link": "https://stackoverflow.com/users/6851693/ydhhat"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1548700049, "post_id": 54407098, "comment_id": 95627096, "body": "@Flimzy, Could you give more details about unclear part? Is that about the question &quot;what is benefit of doing that?&quot;?  And a clearer question should be &quot;Could you give some situations, examples that the go&#39;s property is useful?&quot;?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548700307, "post_id": 54407098, "comment_id": 95627213, "body": "@ydhhat: go doesn&#39;t &quot;raise errors&quot;, error are just values. if you want to treat the <code>bool</code> value as an error you can. How would your program be any different if the second value was an <code>error</code>, besides being slightly more verbose?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1548701201, "post_id": 54407098, "comment_id": 95627590, "body": "&#171;Could you give some situations, examples that the go&#39;s property is useful?&#187; A maps can be thought of as keeping a related set of named <i>variables.</i> It&#39;s useful to have these variables obey the general Go rules of having all variables implicitly initialized to the so-called &quot;zero value&quot; appropriate for their type\u2014unless explicitly initialized. This means that if a map does not have a variable bound to a key &quot;foo&quot;, reading its value using that key yields the zero value of the appropriate type. You may then update that value and write it back."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1548701318, "post_id": 54407098, "comment_id": 95627626, "body": "Consider that <code>m := make(map[string]int); x := m[&quot;foo&quot;]; m[&quot;foo&quot;] = x + 1</code> is not really different from a supposedly more familiar <code>var v int; x := v; v = x + 1</code>. In both the examples, the second step acquires the zero value of <code>int</code> adds one to it and then and assigns it back to the variable used to read the zero value from in the first step. In the case of a map, that variable is first created."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 2, "creation_date": 1548701406, "post_id": 54407098, "comment_id": 95627661, "body": "Also do not forget that map access in Go may use two argument form: <code>v, ok := map[&quot;key&quot;]</code>, so you can use <code>if v, ok := map[&quot;key&quot;]; !ok { panic(&quot;boom&quot;) } ...</code> if you want. It&#39;s not more complicated than having maps panic on non-existing keys with the programmer having to trap them if they want different behaviour."}, {"owner": {"reputation": 291, "user_id": 6851693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2d54fb03cffc196b59cd8cbec52b12d?s=128&d=identicon&r=PG&f=1", "display_name": "ydhhat", "link": "https://stackoverflow.com/users/6851693/ydhhat"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548701559, "post_id": 54407098, "comment_id": 95627730, "body": "@JimB, saying &quot;go doesn&#39;t &quot;raise errors&quot;&quot; you mean go not handle errors as exceptions like in this article <a href=\"https://medium.com/@hussachai/error-handling-in-go-a-quick-opinionated-guide-9199dd7c7f76\" rel=\"nofollow noreferrer\">medium.com/@hussachai/&hellip;</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548702443, "post_id": 54407098, "comment_id": 95628124, "body": "@ydhhat: I mean that errors are just values, like any other, and you can choose to deal with them however you need. There is nothing special about error values, other than they indicate that they are important to check."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1548702595, "post_id": 54407098, "comment_id": 95628191, "body": "It&#39;s unclear because you&#39;re using terminology that makes no sense in the context of Go. Go never &quot;raises errors&quot;--it never raises <i>anything</i>, for that matter. So it&#39;s unclear what you mean, or which behavior you&#39;re expecting."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 1, "creation_date": 1548705137, "post_id": 54407098, "comment_id": 95629419, "body": "Would you rather go <i>&quot;raises an error&quot;</i> (which to me implies a runtime panic) when all you want to do is check whether or not a given key set in a map? Jesus.. that would make for some verbose, ugly code"}, {"owner": {"reputation": 291, "user_id": 6851693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2d54fb03cffc196b59cd8cbec52b12d?s=128&d=identicon&r=PG&f=1", "display_name": "ydhhat", "link": "https://stackoverflow.com/users/6851693/ydhhat"}, "edited": false, "score": 0, "creation_date": 1548707315, "post_id": 54407098, "comment_id": 95630466, "body": "I remove the &quot;raise an error&quot; part in my question."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1549275210, "post_id": 54407098, "comment_id": 95830912, "body": "@ydhhat: No, your title still asks about raising errors."}, {"owner": {"reputation": 291, "user_id": 6851693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2d54fb03cffc196b59cd8cbec52b12d?s=128&d=identicon&r=PG&f=1", "display_name": "ydhhat", "link": "https://stackoverflow.com/users/6851693/ydhhat"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1557496326, "post_id": 54407098, "comment_id": 98796105, "body": "@Flimzy I change <code>raising error</code> to <code>raising error (like Python)</code> in the title."}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "edited": false, "score": 0, "creation_date": 1590275238, "post_id": 54407098, "comment_id": 109621205, "body": "It&#39;s a perfectly good question, asked in good faith -- with some helpful answers as well."}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "edited": false, "score": 0, "creation_date": 1590275455, "post_id": 54407098, "comment_id": 109621250, "body": "<i>May</i> be OK to close this if you dup-link to <a href=\"https://stackoverflow.com/q/2050391/86967\">How to check if a map contains a key in Go?</a> -- although this question provides an opportunity to go a little deeper into Go design principles."}], "answers": [{"comments": [{"owner": {"reputation": 291, "user_id": 6851693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2d54fb03cffc196b59cd8cbec52b12d?s=128&d=identicon&r=PG&f=1", "display_name": "ydhhat", "link": "https://stackoverflow.com/users/6851693/ydhhat"}, "edited": false, "score": 0, "creation_date": 1548707326, "post_id": 54407151, "comment_id": 95630473, "body": "I remove the &quot;raise an error&quot; part in my question. Could you give more situations that the go&#39;s property is useful."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 291, "user_id": 6851693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2d54fb03cffc196b59cd8cbec52b12d?s=128&d=identicon&r=PG&f=1", "display_name": "ydhhat", "link": "https://stackoverflow.com/users/6851693/ydhhat"}, "edited": false, "score": 0, "creation_date": 1548709406, "post_id": 54407151, "comment_id": 95631425, "body": "@ydhhat: See my revised answer."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 3, "last_activity_date": 1548710800, "last_edit_date": 1548710800, "creation_date": 1548695853, "answer_id": 54407151, "question_id": 54407098, "link": "https://stackoverflow.com/questions/54407098/what-is-benefit-of-not-raising-error-like-python-when-key-is-not-in-map/54407151#54407151", "title": "What is benefit of not raising error (like Python) when key is not in map?", "body": "<p>Go does not raise errors. Go reports errors.</p>\n\n<hr>\n\n<p>A common use of a map element zero value:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    counts := map[string]int{}\n    fmt.Println(counts)\n\n    // Equivalent:\n    // counts[\"foo\"] = counts[\"foo\"] + 1\n    // counts[\"foo\"] += 1\n    // counts[\"foo\"]++\n\n    counts[\"foo\"]++\n    fmt.Println(counts)\n\n    counts[\"foo\"]++\n    fmt.Println(counts)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/nvHBrgV_lFU\" rel=\"nofollow noreferrer\">https://play.golang.org/p/nvHBrgV_lFU</a></p>\n\n<p>Output:</p>\n\n<pre><code>map[]\nmap[foo:1]\nmap[foo:2]\n</code></pre>\n\n<hr>\n\n<p>A common use of the comma, ok form map index expression:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    m := map[string]map[string]int{}\n    fmt.Println(m)\n\n    // panic: assignment to entry in nil map\n    // m[\"K1\"][\"K2\"]++\n\n    _, ok := m[\"K1\"]\n    if !ok {\n        m[\"K1\"] = map[string]int{}\n    }\n    m[\"K1\"][\"K2\"]++\n    fmt.Println(m)\n\n    m[\"K1\"][\"K2\"]++\n    fmt.Println(m)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/9byxSSIWBre\" rel=\"nofollow noreferrer\">https://play.golang.org/p/9byxSSIWBre</a></p>\n\n<p>Output:</p>\n\n<pre><code>map[]\nmap[K1:map[K2:1]]\nmap[K1:map[K2:2]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 5, "last_activity_date": 1548714354, "last_edit_date": 1548714354, "creation_date": 1548706870, "answer_id": 54409700, "question_id": 54407098, "link": "https://stackoverflow.com/questions/54407098/what-is-benefit-of-not-raising-error-like-python-when-key-is-not-in-map/54409700#54409700", "title": "What is benefit of not raising error (like Python) when key is not in map?", "body": "<p>There was a time before Go 1 when indexing a map with a non-existing key crashed the app. This was changed to return the zero value of the value type of the map. This was a design decision which allows the (limited) use of uninitialized language constructs to be used without extra checks, which simplifies code.</p>\n\n<p>For example you can <code>for range</code> over <code>nil</code> slices and <code>nil</code> maps, you can check their length etc. The result is the same of course: iterating over a <code>nil</code> slice or map will result in zero iterations, and the length of <code>nil</code> slices and maps is 0, but you do not need to use an <code>if</code> statement beforehand to tell if the value is non-<code>nil</code> (in order to tell if you can range over them or index them).</p>\n\n<p>PeterSO already showed a good example when the zero value for non-existing keys is useful: counters.</p>\n\n<p>Another famous example is a map being used as a set. If you choose the value type to be <code>bool</code>, you don't have to initialize values that are not in the set. Indexing the map tells if a value (the key) is in the set, and if it's not, the zero value of <code>bool</code> type being <code>false</code> will tell you that it's not in the set.</p>\n\n<p>For example:</p>\n\n<pre><code>fruits := map[string]bool{}\n\n// Add elements to the set:\nfruits[\"apple\"] = true\nfruits[\"banana\"] = true\n\n// Test if elements are in the map:\nfmt.Println(\"Is apple in the set?\", fruits[\"apple\"])\nfmt.Println(\"Is banana in the set?\", fruits[\"banana\"])\nfmt.Println(\"Is plum in the set?\", fruits[\"plum\"])\nfmt.Println(\"Is lemon in the set?\", fruits[\"lemon\"])\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/j6meIbR-dOj\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Is apple in the set? true\nIs banana in the set? true\nIs plum in the set? false\nIs lemon in the set? false\n</code></pre>\n"}], "owner": {"reputation": 291, "user_id": 6851693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2d54fb03cffc196b59cd8cbec52b12d?s=128&d=identicon&r=PG&f=1", "display_name": "ydhhat", "link": "https://stackoverflow.com/users/6851693/ydhhat"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 797, "favorite_count": 1, "closed_date": 1548713385, "accepted_answer_id": 54407151, "answer_count": 2, "score": 1, "last_activity_date": 1557297462, "creation_date": 1548695668, "last_edit_date": 1557297462, "question_id": 54407098, "link": "https://stackoverflow.com/questions/54407098/what-is-benefit-of-not-raising-error-like-python-when-key-is-not-in-map", "closed_reason": "Opinion-based", "title": "What is benefit of not raising error (like Python) when key is not in map?", "body": "<p>In Go, let <code>m</code> is map object that map <code>string</code> to <code>int</code>, suppose <code>\"foo\"</code> is not a key of <code>m</code>, then the statement</p>\n\n<pre><code>m[\"foo\"]\n</code></pre>\n\n<p>returns two value <code>0</code> and <code>false</code> which <code>false</code> implies <code>\"foo\"</code> is not a key of <code>m</code>.\nCould you give some situations, examples that the go's property is useful? </p>\n"}, {"tags": ["go", "struct", "interface", "go-interface"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1548695450, "post_id": 54407011, "comment_id": 95624853, "body": "No, you cannot check for runtime panics at compile time, or we wouldn&#39;t need runtime panics. Perhaps create a constructor for your <code>loopBack</code> type?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1548695671, "post_id": 54407011, "comment_id": 95624968, "body": "The <code>Write</code> method isn&#39;t undefined - it&#39;s defined by the embedded <code>Conn</code>. The problem is simply that the <code>Conn</code> is <code>nil</code>."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1548695697, "post_id": 54407011, "comment_id": 95624984, "body": "If the problem <i>were</i> that it was undefined, that <i>would</i> be caught at compile time."}], "answers": [{"comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 1, "creation_date": 1548705712, "post_id": 54407272, "comment_id": 95629695, "body": "That&#39;s a completely different thing, though... embedding an interface type is common, and useful. Just initialise the <code>Conn</code> field, job done."}, {"owner": {"reputation": 14274, "user_id": 579078, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/xC5kj.png?s=128&g=1", "display_name": "\u11bc\u11ba\u11bc", "link": "https://stackoverflow.com/users/579078/%e1%86%bc%e1%86%ba%e1%86%bc"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1548705971, "post_id": 54407272, "comment_id": 95629817, "body": "@EliasVanOotegem True, it depends on how one reads the question, whether it&#39;s &quot;How to make this code work&quot; or &quot;How to get a compile-time error that it won&#39;t work&quot;"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1548706281, "post_id": 54407272, "comment_id": 95629949, "body": "Given how the <code>net.Conn</code> interface is far bigger than <code>Read</code> and <code>Write</code> alone, I&#39;m taking it the OP wants a <code>net.Conn</code> with a buffer fields for whatever reason (maybe mocking?). Either way, that&#39;s up to the OP to specify, because when it comes to mocking, there&#39;s many better ways to go about it"}, {"owner": {"reputation": 14274, "user_id": 579078, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/xC5kj.png?s=128&g=1", "display_name": "\u11bc\u11ba\u11bc", "link": "https://stackoverflow.com/users/579078/%e1%86%bc%e1%86%ba%e1%86%bc"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1548706389, "post_id": 54407272, "comment_id": 95630006, "body": "He did ask  &quot;Exist some way to validate it at compile time?&quot;. But, it&#39;s hard to tell. Also because it&#39;s from a go4java talk, I assumed he wanted to express explicit <code>implements</code> in Go"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 2, "creation_date": 1548706586, "post_id": 54407272, "comment_id": 95630107, "body": "Yeah, I see how you interpreted the question now. I brushed that bit off as an X-Y problem (as in: OP thinks embedded interfaces somehow force compile-time checks on the struct in which he&#39;s embedding)"}], "tags": [], "owner": {"reputation": 14274, "user_id": 579078, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/xC5kj.png?s=128&g=1", "display_name": "\u11bc\u11ba\u11bc", "link": "https://stackoverflow.com/users/579078/%e1%86%bc%e1%86%ba%e1%86%bc"}, "is_accepted": false, "score": 0, "last_activity_date": 1548697028, "last_edit_date": 1548697028, "creation_date": 1548696367, "answer_id": 54407272, "question_id": 54407011, "link": "https://stackoverflow.com/questions/54407011/struct-embedding-of-interfaces-panic-runtime-error/54407272#54407272", "title": "Struct embedding of interfaces, panic: runtime error", "body": "<p>What you are doing is <em>not</em> the same as saying \"<code>loopBack implements net.Conn</code>\".<br>\nTo get compile-time error(s) about the missing method \u2013 and the mismatched <code>Read()</code>, too \u2013 declare <code>loop</code>'s type:<br>\n(And don't embed <a href=\"https://golang.org/pkg/net/#Conn\" rel=\"nofollow noreferrer\"><code>net.Conn</code></a> in <code>loopBack</code>)</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func main() {\n  var loop net.Conn = loopBack{}\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "is_accepted": false, "score": 0, "last_activity_date": 1548706204, "last_edit_date": 1548706204, "creation_date": 1548705652, "answer_id": 54409412, "question_id": 54407011, "link": "https://stackoverflow.com/questions/54407011/struct-embedding-of-interfaces-panic-runtime-error/54409412#54409412", "title": "Struct embedding of interfaces, panic: runtime error", "body": "<p>Golang doesn't require <em>exlicit</em> interface implementations. What you do here:</p>\n\n<pre><code>type loopBack struct {\n    net.Conn\n    buf bytes.Buffer\n}\n</code></pre>\n\n<p>Is the similar to:</p>\n\n<pre><code>type loopBack struct{\n    Conn net.Conn\n    buf bytes.Buffer\n}\n</code></pre>\n\n<p><code>net.Conn</code> being an interface type, the first field of your <code>loopBack</code> type can be anything that implements the <code>net.Conn</code> interface, which is of course more than <code>Read</code> and <code>Write</code> alone (<a href=\"https://golang.org/pkg/net/#Conn\" rel=\"nofollow noreferrer\">see here</a>).</p>\n\n<p>The advantage of embedding types is that the fields and receiver functions (name conflicts aside) can be accessed directly on the types that embeds them.</p>\n\n<p>With an embedded <code>net.Conn</code> field, you can indeed write:</p>\n\n<pre><code>loop.Write(nil)\n</code></pre>\n\n<p><strong>If</strong> the <code>Conn</code> field is initialised (otherwise, its value is <code>nil</code>). Changing the declaration to the second version, <code>loop.Write</code> won't work, you'll have to write:</p>\n\n<pre><code>loop.Conn.Write(nil)\n</code></pre>\n\n<p>Type embedding is very powerful, but there's a number of gotcha's when you first get started. Thankfully, there's an entire paragraph explaining embedding on the <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow noreferrer\">effective go doc</a></p>\n\n<p>Anyway, as stated, you are able to call functions, and access fields (if you're embedding a struct type instead of an interface). There is one thing, though: the field must be initialised correctly!</p>\n\n<p>And that's where you went wrong: You still have to <em>initialise</em> your <code>Conn</code> part of the <code>loopBack</code> variable, otherwise what you're doing is the same as:</p>\n\n<pre><code>net.Conn(nil).Write(nil)\n</code></pre>\n\n<p>Which, naturally, results in a panic (nil pointer dereference)...</p>\n\n<p>For example:</p>\n\n<pre><code>conn, err := net.Dial(\"tcp\", \"localhost:80\")\nif err != nil {\n    log.Fatalf(\"failed to dial localhost: %+v\", err)\n}\nloop := loopBack{\n    Conn: conn,\n}\nloop.Write(nil) // same as conn.Write(nil)\n</code></pre>\n\n<p>Failing to set the <code>net.Conn</code> embedded field is akin to doing something like this:</p>\n\n<pre><code>s := make([]*int, 10) // make slice of 10 pointers to int\nfmt.Println(len(s)) // outputs 10\n*s[0]++ // add 1 to first element PANICS\n</code></pre>\n\n<p>The 10 elements in the slice exist, but they've all been initialised to <code>nil</code></p>\n"}], "owner": {"reputation": 21022, "user_id": 348081, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fc6e3adc850c07248a46aaadc05fa59b?s=128&d=identicon&r=PG", "display_name": "JuanPablo", "link": "https://stackoverflow.com/users/348081/juanpablo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 255, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1548706204, "creation_date": 1548695324, "last_edit_date": 1548695464, "question_id": 54407011, "link": "https://stackoverflow.com/questions/54407011/struct-embedding-of-interfaces-panic-runtime-error", "title": "Struct embedding of interfaces, panic: runtime error", "body": "<p>I'm trying an example related to struct embedding of interfaces</p>\n\n<pre><code>// https://talks.golang.org/2014/go4java.slide#52\n// Struct embedding of interfaces\n// https://play.golang.org/p/SYiZ7M1OEhU\n\npackage main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"net\"\n)\n\n// net.Conn has Read and Write\n\ntype loopBack struct {\n    net.Conn\n    buf bytes.Buffer\n}\n\nfunc (c *loopBack) Read(b []byte) (int, error) {\n    fmt.Println(\"loopBack Read\")\n    return 0, nil \n}\n\nfunc main() {\n\n    loop := loopBack{}\n    loop.Read(nil)\n    loop.Write(nil)                                                                           \n}\n</code></pre>\n\n<p>and the <code>Write</code> method is undefined, so I get this runtime error</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n[signal SIGSEGV: segmentation violation code=0xffffffff addr=0x0 pc=0xe28ca]\n\ngoroutine 1 [running]:\nmain.main()\n    /tmp/sandbox812386031/main.go:28 +0x6a\n</code></pre>\n\n<p>Exist some way to validate it at compile time? </p>\n\nlink to code\n\n<p><a href=\"https://play.golang.org/p/SYiZ7M1OEhU\" rel=\"nofollow noreferrer\">https://play.golang.org/p/SYiZ7M1OEhU</a></p>\n"}, {"tags": ["go", "testing", "mocking"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1548694771, "post_id": 54406712, "comment_id": 95624460, "body": "Every time you read, you&#39;re creating a new buffer, which seems wrong - the read position pointer will be reset on every read."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1548695682, "post_id": 54406712, "comment_id": 95624975, "body": "Show the code for <code>mockFile</code> and <code>consulPropertiesFile</code>.  Assuming that <code>consulPropertiesFile</code> is  string, the mock file can probably be replaced with <code>ioutil.NopCloser(strings.NewReader(consulPropertiesFile))</code>."}], "answers": [{"tags": [], "owner": {"reputation": 439, "user_id": 1290778, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e9c090234ad04870da1952229d6b622c?s=128&d=identicon&r=PG", "display_name": "phanteh", "link": "https://stackoverflow.com/users/1290778/phanteh"}, "is_accepted": false, "score": 1, "last_activity_date": 1548698498, "creation_date": 1548698498, "answer_id": 54407789, "question_id": 54406712, "link": "https://stackoverflow.com/questions/54406712/mocking-bufio-scanner-input/54407789#54407789", "title": "Mocking bufio.Scanner input", "body": "<p>Thanks to @Adrian:</p>\n\n<p>I realised on my way home it was probably due to instantiating a new reader every time the method is called. Moving the reader instantiation out of my ReadFunc worked perfectly!</p>\n\n<p>And thanks to @Thundercat for the <code>strings.NewReader()</code> tip, updated code:</p>\n\n<pre><code>reader := ioutil.NopCloser(strings.NewReader(consulPropertiesFile))\n\nfile := &amp;mockFile{\n    ReadFunc: func(p []byte) (int, error) {\n        return reader.Read(p)\n    },\n    CloseFunc: func() error {\n        return nil\n    },\n}\n</code></pre>\n\n<p>For anyone who comes across this post looking for information on how to mock file system etc:</p>\n\n<p>An interface for opening and stat'ing files, plus concrete implementation using <code>os</code> package:</p>\n\n<pre><code>// FileSystem - interface to the filesystem\ntype FileSystem interface {\n    Open(name string) (File, error)\n    Stat(name string) (os.FileInfo, error)\n}\n\n// OsFS - filesystem backed by default os package\ntype OsFS struct {\n}\n\n// Open - open a file\nfunc (o *OsFS) Open(name string) (File, error) {\n    return os.Open(name)\n}\n\n// Stat - get file status\nfunc (o *OsFS) Stat(name string) (os.FileInfo, error) {\n    return os.Stat(name)\n}\n</code></pre>\n\n<p>File interface mentioned above:</p>\n\n<pre><code>// File - file interface\ntype File interface {\n    io.Closer\n    io.Reader\n    io.ReaderAt\n    io.Seeker\n    Stat() (os.FileInfo, error)\n}\n</code></pre>\n\n<p>Mock the file you want your filesystem to return (implement the methods that will be used by your code):</p>\n\n<pre><code>type mockFile struct {\n    CloseFunc  func() error\n    ReadFunc   func(p []byte) (int, error)\n    ReadAtFunc func(p []byte, off int64) (int, error)\n    SeekFunc   func(offset int64, whence int) (int64, error)\n    StatFunc   func() (os.FileInfo, error)\n}\n\nfunc (m *mockFile) Close() error {\n    return m.CloseFunc()\n}\n\nfunc (m *mockFile) Read(p []byte) (int, error) {\n    return m.ReadFunc(p)\n}\n\nfunc (m *mockFile) ReadAt(p []byte, off int64) (int, error) {\n    return m.ReadAtFunc(p, off)\n}\n\nfunc (m *mockFile) Seek(offset int64, whence int) (int64, error) {\n    return m.SeekFunc(offset, whence)\n}\n\nfunc (m *mockFile) Stat() (os.FileInfo, error) {\n    return m.StatFunc()\n}\n\n---\n\nreader := ioutil.NopCloser(strings.NewReader(\"some string, replace with bytes etc\"))\n\nfile := &amp;mockFile{\n    ReadFunc: func(p []byte) (int, error) {\n        return reader.Read(p)\n    },\n    CloseFunc: func() error {\n        return nil\n    },\n}\n</code></pre>\n\n<p>And return your mockFile via mockFileSystem:</p>\n\n<pre><code>fs := &amp;mockFileSystem{\n    OpenFunc: func(name string) (File, error) {\n        return file, nil\n    },\n}\n</code></pre>\n"}], "owner": {"reputation": 439, "user_id": 1290778, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e9c090234ad04870da1952229d6b622c?s=128&d=identicon&r=PG", "display_name": "phanteh", "link": "https://stackoverflow.com/users/1290778/phanteh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1548698498, "creation_date": 1548694258, "question_id": 54406712, "link": "https://stackoverflow.com/questions/54406712/mocking-bufio-scanner-input", "title": "Mocking bufio.Scanner input", "body": "<p>I've had a lot of success defining interfaces and substituting mocks during testing, but I've hit a problem with mocking <code>bufio.Scanner</code> input:</p>\n\n<pre><code>file := &amp;mockFile{\n    ReadFunc: func(p []byte) (int, error) {\n        reader := bufio.NewReader(bytes.NewReader([]byte(consulPropertiesFile)))\n        return reader.Read(p)\n    },\n    CloseFunc: func() error {\n        return nil\n    },\n}\n\nfs := &amp;mockFileSystem{\n    OpenFunc: func(name string) (File, error) {\n        return file, nil\n    },\n}\n\nproperties, err := readConsulPropertiesFile(fs)\n</code></pre>\n\n<p>While this seems to work, once the scanner has gotten to the end of my string, it just seems to return to the beginning, and reads too much (it seems to read more than a line this time around). It's like I need to manually return an EOF error at the appropriate time in my <code>ReadFunc</code>, but I'm not sure how to figure out when I should do that...</p>\n\n<p>Scanner code (lifted from <a href=\"https://stackoverflow.com/questions/40022861/parsing-values-from-property-file-in-golang\">here</a>):</p>\n\n<pre><code>f, err := file.Open(\"/run/secrets/consul-web4.properties\")\nif err != nil {\n    return nil, err\n}\ndefer f.Close()\n\nproperties := map[string]string{}\n\nscanner := bufio.NewScanner(f)\nfor scanner.Scan() {\n    line := scanner.Text()\n    if equal := strings.Index(line, \"=\"); equal &gt;= 0 {\n        if key := strings.TrimSpace(line[:equal]); len(key) &gt; 0 {\n            value := \"\"\n            if len(line) &gt; equal {\n                value = strings.TrimSpace(line[equal+1:])\n            }\n            properties[key] = value\n        }\n    }\n}\n</code></pre>\n\n<p>I've yet to refactor the above...</p>\n\n<p>I've tried the following variations on my test string:</p>\n\n<pre><code>const input = `key=value\nkey=value\nkey=value\n`\n</code></pre>\n\n<pre><code>const input = \"key=value\\nkey=value\\nkey=value\\n\"\n</code></pre>\n\n<p>And I've tried bufio.Reader &amp; io.Reader implementations.</p>\n\n<p>Any help / insight appreciated!</p>\n"}, {"tags": ["xml", "go"], "comments": [{"owner": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 1, "creation_date": 1548690179, "post_id": 54405462, "comment_id": 95621475, "body": "xml is meant static so you should design your xml layout around that"}, {"owner": {"reputation": 2406, "user_id": 604515, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5a59cce890ffc226eddf1ad65602fe8f?s=128&d=identicon&r=PG&f=1", "display_name": "Willem", "link": "https://stackoverflow.com/users/604515/willem"}, "reply_to_user": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1548690358, "post_id": 54405462, "comment_id": 95621588, "body": "I have to parse existing data, no control over that."}], "answers": [{"comments": [{"owner": {"reputation": 2406, "user_id": 604515, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5a59cce890ffc226eddf1ad65602fe8f?s=128&d=identicon&r=PG&f=1", "display_name": "Willem", "link": "https://stackoverflow.com/users/604515/willem"}, "edited": false, "score": 0, "creation_date": 1548705023, "post_id": 54405668, "comment_id": 95629366, "body": "Great example, much appreciated!"}], "tags": [], "owner": {"reputation": 14274, "user_id": 579078, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/xC5kj.png?s=128&g=1", "display_name": "\u11bc\u11ba\u11bc", "link": "https://stackoverflow.com/users/579078/%e1%86%bc%e1%86%ba%e1%86%bc"}, "is_accepted": true, "score": 1, "last_activity_date": 1548693178, "last_edit_date": 1548693178, "creation_date": 1548690705, "answer_id": 54405668, "question_id": 54405462, "link": "https://stackoverflow.com/questions/54405462/golang-xml-unmarshall-arbitrary-elements/54405668#54405668", "title": "Golang xml.Unmarshall arbitrary elements", "body": "<p>You could use <code>xml.Decoder</code> instead: \n<a href=\"https://play.golang.org/p/eA4tJsBz3fm\" rel=\"nofollow noreferrer\">Example, which severely lacks error handling</a>.</p>\n"}], "owner": {"reputation": 2406, "user_id": 604515, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5a59cce890ffc226eddf1ad65602fe8f?s=128&d=identicon&r=PG&f=1", "display_name": "Willem", "link": "https://stackoverflow.com/users/604515/willem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 54405668, "answer_count": 1, "score": 0, "last_activity_date": 1548693178, "creation_date": 1548690068, "question_id": 54405462, "link": "https://stackoverflow.com/questions/54405462/golang-xml-unmarshall-arbitrary-elements", "title": "Golang xml.Unmarshall arbitrary elements", "body": "<p>XML with arbitrary number of arbitrarily named elements:</p>\n\n<pre><code>&lt;modules&gt;\n&lt;elt1&gt;&lt;version&gt;1.2.3&lt;/version&gt;&lt;/elt1&gt;\n&lt;eltN&gt;&lt;version&gt;4.5.6&lt;/version&gt;&lt;/eltN&gt;\n&lt;/modules&gt;\n</code></pre>\n\n<p>How to parse this into a <code>map[string]string</code> for <code>elementname</code> to <code>version</code>? All Unmarshall examples that I found, assume static element names. </p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 834, "user_id": 1395722, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4fc4325896e0c19e7f276d5659cd0694?s=128&d=identicon&r=PG", "display_name": "a.l.", "link": "https://stackoverflow.com/users/1395722/a-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1548687250, "creation_date": 1548687250, "answer_id": 54404544, "question_id": 54403928, "link": "https://stackoverflow.com/questions/54403928/i-want-to-use-hijack-in-golang-while-get-invalid-response-on-client/54404544#54404544", "title": "I want to use hijack in golang, while get invalid response on client", "body": "<p>As the <code>Hijacker</code>'s documentation says</p>\n\n<blockquote>\n  <p>Hijack lets the caller take over the connection.              After a\n  call to Hijack the HTTP server library                will not do\n  anything else with the connection.<br>\n                                                                It becomes the caller's responsibility to manage              and close\n  the connection.<br>\n                                                                The returned net.Conn may have read or write deadlines        already set,\n  depending on the configuration of the            Server. It is the\n  caller's responsibility to set              or clear those deadlines\n  as needed.<br>\n                                                                The returned bufio.Reader may contain unprocessed buffered    data from\n  the client.<br>\n                                                                After a call to Hijack, the original Request.Body must not    be used. The\n  original Request's Context remains valid and     is not canceled until\n  the Request's ServeHTTP method          returns.</p>\n</blockquote>\n\n<p>You need to write to <code>c</code> rather than <code>buf</code>. And you need to write response status and <code>Content-Length</code> header.</p>\n\n<pre><code>http.HandleFunc(\"/\", func(writer http.ResponseWriter, request *http.Request) {\n    fmt.Println(\"start\")\n\n    writer.Header().Add(\"Content-Length\", \"5\")\n    writer.WriteHeader(200)\n    hj, ok := writer.(http.Hijacker)\n\n    fmt.Println(ok)\n\n    c, _, err := hj.Hijack()\n    if err != nil {\n        panic(err)\n    }\n    n, err := c.Write([]byte(\"hello\"))\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Println(\"n == \",n)\n\n    err = c.Close()\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Println(\"end\")\n})\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10368009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5f003aaf69993515dd3b2e6ed91e734?s=128&d=identicon&r=PG&f=1", "display_name": "zhanghao", "link": "https://stackoverflow.com/users/10368009/zhanghao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 289, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1548687250, "creation_date": 1548685214, "last_edit_date": 1548686036, "question_id": 54403928, "link": "https://stackoverflow.com/questions/54403928/i-want-to-use-hijack-in-golang-while-get-invalid-response-on-client", "title": "I want to use hijack in golang, while get invalid response on client", "body": "<p>I want to use hijack in golang, while recieve invalid response on client</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func hijack(w http.ResponseWriter, r *http.Request) {\n    fmt.Println(\"start\")\n\n    hj, ok := w.(http.Hijacker)\n\n    fmt.Println(ok)\n\n    c, buf, err := hj.Hijack()\n    if err != nil {\n        panic(err)\n    }\n    n, err := buf.Write([]byte(\"hello\"))\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Println(\"n == \",n)\n\n    err = buf.Flush()\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Println(\"end\")\n}\n</code></pre>\n\n<p>follow printed on server:</p>\n\n<pre><code>start\n\ntrue\n\nn ==  5\n\nend\n</code></pre>\n\n<p>but I got following error on the client</p>\n\n<blockquote>\n  <p>localhost sent an invalid response. ERR_INVALID_HTTP_RESPONSE</p>\n</blockquote>\n"}, {"tags": ["go", "channel", "goroutine", "channels"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 4, "creation_date": 1548684832, "post_id": 54403750, "comment_id": 95618079, "body": "If you keep running it (not in playground) you&#39;ll likely get different results each time. Concurrency is non-deterministic and any expectations you have about the order of non-locking operations is wrong. You have to think about program flow differently when looking at concurrent code; it is not a single, predictable flow, but multiple concurrent <i>independent</i> flows. It&#39;s only at the locking points (eg channel send/receive) where they impact one another."}, {"owner": {"reputation": 19, "user_id": 10979417, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7TWP7UcRQDs/AAAAAAAAAAI/AAAAAAAAABQ/eQ47F2FzyiA/photo.jpg?sz=128", "display_name": "Amol Gaikwad", "link": "https://stackoverflow.com/users/10979417/amol-gaikwad"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1548685890, "post_id": 54403750, "comment_id": 95618752, "body": "I have ran this code in VSCode but the output is same every time and the sequence doesn&#39;t change.  I know somewhat how concurrency works, but this program is always giving the exact same output in VSCode, why is that so???"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1548686330, "post_id": 54403750, "comment_id": 95619049, "body": "Because that&#39;s the way it runs it. The order here isn&#39;t completely guaranteed, but there&#39;s also not enough variation to get different output when running under the same conditions."}, {"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1548709413, "post_id": 54403750, "comment_id": 95631428, "body": "Which part of the output is confusing. And what value would you expect? I would recomend that you start with a shorter example."}, {"owner": {"reputation": 19, "user_id": 10979417, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7TWP7UcRQDs/AAAAAAAAAAI/AAAAAAAAABQ/eQ47F2FzyiA/photo.jpg?sz=128", "display_name": "Amol Gaikwad", "link": "https://stackoverflow.com/users/10979417/amol-gaikwad"}, "edited": false, "score": 0, "creation_date": 1548737774, "post_id": 54403750, "comment_id": 95638500, "body": "When I run a program containing goroutines, I know that in case of goroutines the output will always be in different order and no particular order is guaranteed, but i ran this program in <b>VSCode</b> it gives the same output every time i ran it, no matter how many times.  One more thing, why does the program print out the statement just after the call is given to the goroutine, .i.e why is it printing out <code>7 </code>, even though the  <code>go test (done)</code> func/goroutine is called, why doesn&#39;t it print out <code>2</code> as the func/goroutine is called and the control is with the <code>go test(done){}</code> function???"}], "answers": [{"comments": [{"owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "edited": false, "score": 0, "creation_date": 1598961667, "post_id": 54427916, "comment_id": 112620215, "body": "Just upvoted - and wanted to say, this is simply the best answer I have read on Goroutines channels!"}], "tags": [], "owner": {"reputation": 6841, "user_id": 3960399, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/c5OVT.jpg?s=128&g=1", "display_name": "Frank Bryce", "link": "https://stackoverflow.com/users/3960399/frank-bryce"}, "is_accepted": false, "score": 3, "last_activity_date": 1548788944, "last_edit_date": 1548788944, "creation_date": 1548788224, "answer_id": 54427916, "question_id": 54403750, "link": "https://stackoverflow.com/questions/54403750/the-behaviour-of-goroutines-with-channels/54427916#54427916", "title": "The Behaviour Of Goroutines with Channels", "body": "<p>Welcome to Stack Overflow.  I hope I can help you understand channels and goroutines a bit better.</p>\n\n<h1>Concept 1: <a href=\"https://tour.golang.org/concurrency/2\" rel=\"nofollow noreferrer\">Channels</a></h1>\n\n<p>Visualize a channel as a tube where data goes in one end and out the other.  The first data in is the first data that comes out the other side.  There are buffered channels and non-buffered channels but for your example you only need to understand the default channel, which is unbuffered.  Unbuffered channels only allow one value in the channel at a time.</p>\n\n<h3>Writing to an Unbuffered Channel</h3>\n\n<p>Code that looks like this writes data into one end of the channel.</p>\n\n<pre><code>ch &lt;- value\n</code></pre>\n\n<p>Now, this code actually <em>waits</em> to be done executing until something reads the value out of the channel.  An unbuffered channel only allows for one value at a time to be within it, and doesn't continue executing until it is read.  We'll see later how this affects the ordering of how your code is executed.</p>\n\n<h3>Reading from an Unbuffered Channel</h3>\n\n<p>To read from an unbuffered channel (visualize taking a value out of the channel), the code to do this looks like</p>\n\n<pre><code>[value :=] &lt;-ch\n</code></pre>\n\n<blockquote>\n  <p>when you read code documentation [things in] square brackets indicate that what's within them is optional.  Above, without the [value :=] you'll just take a value out of the channel and don't use it for anything.</p>\n</blockquote>\n\n<p>Now when there's a value in the channel, this code has two side effects.  One, it reads the value out of a channel in whatever routine we are in now, and proceeds with the value.  The <em>other</em> effect it has is to <strong>allow the goroutine which put the value into the channel to continue</strong>.  This is the critical bit that's necessary to understand your example program.</p>\n\n<p>In the event there is NO value in the channel yet, it will <strong>wait for a value to be written into the channel before continuing</strong>.  In other words, the thread blocks until the channel has a value to read.</p>\n\n<h1>Concept 2: <a href=\"https://tour.golang.org/concurrency/1\" rel=\"nofollow noreferrer\">Goroutines</a></h1>\n\n<p>A goroutine allows your code to continue executing two pieces of code <em>concurrently</em>.  This can be used to allow your code to execute faster, or attend to multiple problems at the same time (think of a server where multiple users are loading pages from it at the same time).</p>\n\n<p>Your question arises when you try to figure out the ordering that code is executed when you have multiple routines executing concurrently.  This is a good question and others have correctly stated that <em>it depends</em>.  When you spawn two goroutines, the ordering of which lines of code are executed is arbitrary.</p>\n\n<p>The code below with a goroutine may print <code>executing a()</code> or <code>end main()</code> first.  This is due to the fact that spawning a gorouting means there are two concurrent streams (threads) of execution happening at the same time.  In this case, one thread stays in <code>main()</code> and the other starts executing the first line in <code>a()</code>.  How the runtime decides to choose which to run first is arbitrary.</p>\n\n<pre><code>func main() {\n    fmt.Println(\"start main()\")\n    go a()\n    fmt.Println(\"end main()\")\n}\n\nfunc a() {\n    fmt.Println(\"executing a()\")\n}\n</code></pre>\n\n<h3>Goroutines + Channels</h3>\n\n<p>Now let's use a channel to control the ordering of what get's executed, when. \n The only difference now is we create a channel, pass it into the goroutine, and wait for it's value to be written before continuing in main.  From earlier, we discussed how the routine reading the value from a channel needs to wait until there's a value in the channel before continuing.  Since <code>executing a()</code> is always printed before the channel is written to, we will always wait to read the value put into the channel until <code>executing a()</code> has printed.  Since we read from the channel (which happens after the channel is written) before printing <code>end main()</code>, <code>executing a()</code> will always print before <code>end main()</code>. I made <a href=\"https://play.golang.org/p/rn_ZmDWJfQT\" rel=\"nofollow noreferrer\">this playground</a> so you can run it for yourself.</p>\n\n<pre><code>func main() {\n    fmt.Println(\"start main()\")\n    ch := make(chan int)\n    go a(ch)\n    &lt;-ch\n    fmt.Println(\"end main()\")\n}\n\nfunc a(ch chan int) {\n    fmt.Println(\"executing a()\")\n    ch &lt;- 0\n}\n</code></pre>\n\n<h1>Your Example</h1>\n\n<p>I think at this point you could figure out what happens when, and what might happen in a different order.  My own first attempt was wrong when I went through it in my head (see edit history).  You have to be careful!  I'll not give the right answer, upon editing, since I realized this may be a homework assignment.</p>\n\n<p><strong>EDIT:</strong> more semantics about <code>&lt;-done</code></p>\n\n<p>On my first go through, I forgot to mention that <code>fmt.Println(&lt;-done)</code> is conceptually the same as the following.</p>\n\n<pre><code>value := &lt;-done\nfmt.Println(value)\n</code></pre>\n\n<p>This is important because it helps you see that when the <code>main()</code> thread reads from the <code>done</code> channel, it doesn't print it at the same time.  These are two separate steps to the runtime.</p>\n\n<p>I hope this helps.  Let me know if you have questions.</p>\n"}], "owner": {"reputation": 19, "user_id": 10979417, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7TWP7UcRQDs/AAAAAAAAAAI/AAAAAAAAABQ/eQ47F2FzyiA/photo.jpg?sz=128", "display_name": "Amol Gaikwad", "link": "https://stackoverflow.com/users/10979417/amol-gaikwad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 677, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1548789039, "creation_date": 1548684608, "last_edit_date": 1548789039, "question_id": 54403750, "link": "https://stackoverflow.com/questions/54403750/the-behaviour-of-goroutines-with-channels", "title": "The Behaviour Of Goroutines with Channels", "body": "<p>The output of the code given bellow and is somewhat confusing, Please help me understand the behaviour of the channels and goroutines and how \ndoes the execution actually takes place.</p>\n\n<p>I have tried to understand the flow of the program but the statement after the \"call of goroutine\" gets executed, even though the goroutine is called,\nlater on the statements in goroutines are executed,</p>\n\n<p>on second \"call of goroutine\" the behaviour is different and the sequence of printing/flow of program changes.</p>\n\n<p>Following is the code:</p>\n\n<pre><code>    package main\n\n    import \"fmt\"\n\n    func main() {\n        fmt.Println(\"1\")\n        done := make(chan string)\n        go test(done)\n        fmt.Println(\"7\")\n        fmt.Println(&lt;-done)\n        fmt.Println(\"8\")\n        fmt.Println(&lt;-done)\n        fmt.Println(\"9\")\n        fmt.Println(&lt;-done)\n    }\n    func test(done chan string) {\n        fmt.Println(\"2\")\n        done &lt;- \"3\"\n        done &lt;- \"10\"\n        fmt.Println(\"4\")\n        done &lt;- \"5\"\n       fmt.Println(\"6\")\n    }\n</code></pre>\n\n<p>The result of the above code:</p>\n\n<pre><code>1\n7\n2\n3\n8\n10\n9\n4\n6\n5\n</code></pre>\n\n<p>Please help me understand why and how this result comes out.</p>\n"}, {"tags": ["go", "go-ethereum"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1548683550, "post_id": 54403243, "comment_id": 95617342, "body": "The error seems pretty clear - you&#39;re calling <code>NewSimulatedBackend</code> with one argument, it takes two arguments."}, {"owner": {"reputation": 11, "user_id": 10318878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e810b07ad7c48c345127ceb4ae243fd?s=128&d=identicon&r=PG&f=1", "display_name": "Savitri", "link": "https://stackoverflow.com/users/10318878/savitri"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1548739793, "post_id": 54403243, "comment_id": 95638984, "body": "Exactly it takes two arguments but i am not getting what is the second argument to pass"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1548770079, "post_id": 54403243, "comment_id": 95655092, "body": "You never stated what package you&#39;re actually using here, so it&#39;s pretty hard to guess, but regardless I would recommend reading its documentation."}], "answers": [{"tags": [], "owner": {"reputation": 1928, "user_id": 3280050, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0f86ec29ab3a8f7f841f471d582a933?s=128&d=identicon&r=PG", "display_name": "truongnm", "link": "https://stackoverflow.com/users/3280050/truongnm"}, "is_accepted": false, "score": 0, "last_activity_date": 1555580834, "creation_date": 1555580834, "answer_id": 55743408, "question_id": 54403243, "link": "https://stackoverflow.com/questions/54403243/how-to-deploy-ethereum-smart-contracts-in-go-sdk/55743408#55743408", "title": "How to deploy ethereum smart contracts in Go SDK", "body": "<p>The method signature for <code>NewSimulatedBackend</code> has changed. As is:</p>\n\n<p><a href=\"https://github.com/ethereum/go-ethereum/blob/master/accounts/abi/bind/backends/simulated.go#L68\" rel=\"nofollow noreferrer\">https://github.com/ethereum/go-ethereum/blob/master/accounts/abi/bind/backends/simulated.go#L68</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// NewSimulatedBackend creates a new binding backend using a simulated blockchain\n// for testing purposes.\nfunc NewSimulatedBackend(alloc core.GenesisAlloc, gasLimit uint64) *SimulatedBackend {\n    database := rawdb.NewMemoryDatabase()\n    genesis := core.Genesis{Config: params.AllEthashProtocolChanges, GasLimit: gasLimit, Alloc: alloc}\n    genesis.MustCommit(database)\n    blockchain, _ := core.NewBlockChain(database, nil, genesis.Config, ethash.NewFaker(), vm.Config{}, nil)\n\n    backend := &amp;SimulatedBackend{\n        database:   database,\n        blockchain: blockchain,\n        config:     genesis.Config,\n        events:     filters.NewEventSystem(new(event.TypeMux), &amp;filterBackend{database, blockchain}, false),\n    }\n    backend.rollback()\n    return backend\n}\n</code></pre>\n\n<p>You need also pass <code>gasLimit</code> along. Something like this:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>gasPrice, err := client.SuggestGasPrice(context.Background())\nif err != nil {\n    log.Fatal(err)\n}\n\nkey, _ := crypto.GenerateKey()\nauth := bind.NewKeyedTransactor(key)\n\nauth.GasLimit = uint64(300000) // in units\nauth.GasPrice = gasPrice\n\nalloc := make(core.GenesisAlloc)\nalloc[auth.From] = core.GenesisAccount{Balance: big.NewInt(1000000000)}\nblockchain := backends.NewSimulatedBackend(alloc, auth.GasLimit)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10318878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e810b07ad7c48c345127ceb4ae243fd?s=128&d=identicon&r=PG&f=1", "display_name": "Savitri", "link": "https://stackoverflow.com/users/10318878/savitri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1558361953, "creation_date": 1548682746, "last_edit_date": 1558361953, "question_id": 54403243, "link": "https://stackoverflow.com/questions/54403243/how-to-deploy-ethereum-smart-contracts-in-go-sdk", "title": "How to deploy ethereum smart contracts in Go SDK", "body": "<p>I am trying to deploy ethereum smart contracts in go sdk but i am getting some error as </p>\n\n<pre><code>./inbox_test.go:20:44: not enough arguments in call to backends.NewSimulatedBackend\n        have (core.GenesisAlloc)\n        want (core.GenesisAlloc, uint64)\n</code></pre>\n\n<p>I am following step by step guide to deploy smart contract in go and i am not able to do this</p>\n\n<pre><code>func TestDeployInbox(t *testing.T) {\n\n    //Setup simulated block chain\n    key, _ := crypto.GenerateKey()\n    auth := bind.NewKeyedTransactor(key)\n    alloc := make(core.GenesisAlloc)\n    alloc[auth.From] = core.GenesisAccount{Balance: big.NewInt(1000000000)}\n    blockchain := backends.NewSimulatedBackend(alloc)\n\n    //Deploy contract\n    address, _, _, err := DeployInbox(\n        auth,\n        blockchain,\n        \"Hello World\",\n    )\n    // commit all pending transactions\n    blockchain.Commit()\n\n    if err != nil {\n        t.Fatalf(\"Failed to deploy the Inbox contract: %v\", err)\n    }\n\n    if len(address.Bytes()) == 0 {\n        t.Error(\"Expected a valid deployment address. Received empty address byte array instead\")\n    }\n\n}\n</code></pre>\n\n<p>This code should deploy smart contract in go sdk</p>\n"}, {"tags": ["go", "type-alias"], "answers": [{"tags": [], "owner": {"reputation": 3818, "user_id": 1247113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRMFj.png?s=128&g=1", "display_name": "rob74", "link": "https://stackoverflow.com/users/1247113/rob74"}, "is_accepted": true, "score": 8, "last_activity_date": 1548682223, "last_edit_date": 1548682223, "creation_date": 1548681723, "answer_id": 54402958, "question_id": 54402650, "link": "https://stackoverflow.com/questions/54402650/type-alias-vs-type-definition-in-go/54402958#54402958", "title": "Type alias vs type definition in Go", "body": "<p>In this case I assume this was done by mistake - the first alternative defines a type \"anonymously\" and then assigns an alias to it, so the end result is the same in both cases, but still the second alternative is the only correct one.</p>\n\n<p>Type aliases are useful only in a few cases, e.g. as written <a href=\"https://yourbasic.org/golang/type-alias/\" rel=\"noreferrer\">here</a>, they can be useful for large-scale refactoring.</p>\n"}], "owner": {"reputation": 14274, "user_id": 579078, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/xC5kj.png?s=128&g=1", "display_name": "\u11bc\u11ba\u11bc", "link": "https://stackoverflow.com/users/579078/%e1%86%bc%e1%86%ba%e1%86%bc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2162, "favorite_count": 3, "accepted_answer_id": 54402958, "answer_count": 1, "score": 5, "last_activity_date": 1548682223, "creation_date": 1548680644, "question_id": 54402650, "link": "https://stackoverflow.com/questions/54402650/type-alias-vs-type-definition-in-go", "title": "Type alias vs type definition in Go", "body": "<p>I have stumbled upon this type alias in code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type LightSource = struct {\n  R, G, B, L float32\n  X, Y, Z, A float32\n  //...\n}\n</code></pre>\n\n<p>My <strong>question is</strong>: what would be the reason to use a type alias like that to define a <code>struct</code>, rather than doing this?</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type LightSource struct {\n  R, G, B, L float32\n  //...etc\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 815350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b3eba0eda442464cb4de44336a9744c?s=128&d=identicon&r=PG", "display_name": "alexaandru", "link": "https://stackoverflow.com/users/815350/alexaandru"}, "is_accepted": true, "score": 1, "last_activity_date": 1548714340, "last_edit_date": 1548714340, "creation_date": 1548712711, "answer_id": 54410886, "question_id": 54402061, "link": "https://stackoverflow.com/questions/54402061/echo-framework-bind-html-formdata/54410886#54410886", "title": "Echo Framework Bind() html FormData", "body": "<p>There are two problems:</p>\n\n<ol>\n<li>you did not specify the form input names correctly, the way you have them can never map to what you want in any language. In languages that support what you want, it would map tags to a struct of two fields (name and count) each consisting of an array. Not to an array of structs of name and count. Names should be like this <code>tags[][name]</code> in order to achieve what you want, see here for example: <a href=\"https://stackoverflow.com/questions/34313657/html-form-post-an-array-of-objects\">HTML Form: POST an array of objects</a></li>\n<li>even if you specified the name correctly as per the above, it would not work in  Echo anyway as it relies on <code>http.Request.Form</code> to parse the values, which is effectively <code>url.Values</code> which in turn is just a <code>map[string][]string</code>. As you can see, that cannot possibly capture the structure you want. Here is a relevant ticket: <a href=\"https://github.com/golang/go/issues/29703\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/29703</a></li>\n</ol>\n\n<hr>\n\n<p>Now, just because Echo does not support that out of the box, it doesn't mean you cannot do it. You can use a 3rd party library for binding that has the features you need, such as <a href=\"https://github.com/monoculum/formam\" rel=\"nofollow noreferrer\">https://github.com/monoculum/formam</a></p>\n\n<p>The following code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/url\"\n\n    \"github.com/monoculum/formam\"\n)\n\ntype User struct {\n    Email,\n    Password string\n    Tags []struct {\n        Tag   string\n        Count int\n    }\n}\n\nfunc main() {\n    formData := \"Email=joe@example.com&amp;Password=secret&amp;Tags[0].Tag=red&amp;\" + \n        \"Tags[0].Count=1&amp;Tags[1].Tag=blue\"\n    q, _ := url.ParseQuery(formData)\n    u := new(User)\n\n    dec := formam.NewDecoder(nil)\n    if err := dec.Decode(q, u); err != nil {\n        fmt.Println(err)\n        return\n    }\n\n    fmt.Println(u)\n}\n</code></pre>\n\n<p>results in what you need:</p>\n\n<pre><code>&amp;{joe@example.com secret [{red 1} {blue 0}]}\n</code></pre>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 732, "user_id": 1442435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01c2824c79133dd9014ed6c5652ebfe4?s=128&d=identicon&r=PG", "display_name": "eclaude", "link": "https://stackoverflow.com/users/1442435/eclaude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2092, "favorite_count": 1, "accepted_answer_id": 54410886, "answer_count": 1, "score": 1, "last_activity_date": 1548742654, "creation_date": 1548678546, "last_edit_date": 1548682600, "question_id": 54402061, "link": "https://stackoverflow.com/questions/54402061/echo-framework-bind-html-formdata", "title": "Echo Framework Bind() html FormData", "body": "<p>I have a Form html like :</p>\n\n<pre><code>&lt;input name=\"email\"type=\"email\" /&gt;\n&lt;input name=\"password\"type=\"password\" /&gt;\n&lt;input name=\"tags[name][]\"type=\"text\" /&gt;\n&lt;input name=\"tags[count][]\"type=\"number\" /&gt;\n&lt;input name=\"tags[name][]\"type=\"text\" /&gt;\n&lt;input name=\"tags[count][]\"type=\"number\" /&gt;\n&lt;input name=\"tags[name][]\"type=\"text\" /&gt;\n&lt;input name=\"tags[count][]\"type=\"number\" /&gt;\n&lt;input name=\"freeword[]\"type=\"text\" /&gt;\n&lt;input name=\"freeword[]\"type=\"text\" /&gt;\n</code></pre>\n\n<p>I want to <code>Bind()</code> this form with my <code>struct</code> like :</p>\n\n<pre><code>type UserFrom struct {\n  Email string `json:\"email\" form:\"email\" query:\"email\"`\n  Password string `json:\"password\" form:\"password\" query:\"password\"`\n  Tags []Tag\n  Free []string `json:\"freeword[]\" form:\"freeword[]\" query:\"freeword[]\"`\n}\ntype Tag struct {\n  Name string `json:\"tags[name][]\" form:\"tags[name][]\" query:\"tags[name][]\"`\n  Count string `json:\"tags[count][]\" form:\"tags[count][]\" query:\"tags[count][]\"`\n}\n</code></pre>\n\n<p>But if i print the result of <code>Bind()</code> after <code>POST</code> i have :</p>\n\n<pre><code>u := new(UserFrom)\nif err = c.Bind(u); err != nil {\n  return\n}\nlog.Println(u)\n</code></pre>\n\n<p>This bad Output :</p>\n\n<pre><code>&amp;{email@mail.tld pwdpwdpwd [] [word1 word2]}\n</code></pre>\n\n<p>The row <code>Tags []Tag</code> in <code>UserFrom</code> struct does not work</p>\n\n<p><em>If y try to change <code>Tags []Tag</code> to <code>Tags Tag</code> i have a good last entry</em></p>\n\n<pre><code>&amp;{email@mail.tld pwdpwdpwd {tag3 3} [word1 word2]}\n</code></pre>\n\n<p><strong>I want this output :</strong></p>\n\n<pre><code>&amp;{email@mail.tld pwdpwdpwd [{tag1 1} {tag2 2} {tag3 3}] [word1 word2]}\n</code></pre>\n\n<p>do you have an idea of the problem ?</p>\n\n<p><a href=\"https://echo.labstack.com/guide/request#bind-data\" rel=\"nofollow noreferrer\">Echo Doc to Bind()</a></p>\n"}, {"tags": ["http", "go", "https"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1548678748, "post_id": 54401790, "comment_id": 95614538, "body": "Have you tried the 2 methods listed at the start of the package documentation? <a href=\"https://golang.org/pkg/net/http/\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http</a>"}, {"owner": {"reputation": 78, "user_id": 4528653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sTMgu.jpg?s=128&g=1", "display_name": "Javier Benitez", "link": "https://stackoverflow.com/users/4528653/javier-benitez"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548679866, "post_id": 54401790, "comment_id": 95615197, "body": "@JimB yes, TLSNextProto option is not working for me. I was able to make the server work in HTTP/1.x using GODEBUG but client is not working yet"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1548683848, "post_id": 54401790, "comment_id": 95617535, "body": "Your client explicitly specifies a HTTP/2 transport even though that&#39;s not what you want."}], "answers": [{"comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1548698376, "post_id": 54402717, "comment_id": 95626344, "body": "<code>nil</code> is the zero value for slices, so these two code pieces produce the exact same value."}], "tags": [], "owner": {"reputation": 78, "user_id": 4528653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sTMgu.jpg?s=128&g=1", "display_name": "Javier Benitez", "link": "https://stackoverflow.com/users/4528653/javier-benitez"}, "is_accepted": true, "score": 0, "last_activity_date": 1548703324, "last_edit_date": 1548703324, "creation_date": 1548680862, "answer_id": 54402717, "question_id": 54401790, "link": "https://stackoverflow.com/questions/54401790/how-can-i-use-http-1-x-in-client-and-server/54402717#54402717", "title": "How can I use HTTP/1.x in client and server", "body": "<p>I found a simple solution.</p>\n\n<p>Change in the client</p>\n\n<pre><code>Transport: &amp;http2.Transport{\n    TLSClientConfig: &amp;tls.Config{\n        InsecureSkipVerify: true,\n    },\n},\n</code></pre>\n\n<p>by</p>\n\n<pre><code>Transport: &amp;http.Transport{\n        TLSNextProto: make(map[string]func(authority string, c *tls.Conn) http.RoundTripper),\n        TLSClientConfig: &amp;tls.Config{\n            InsecureSkipVerify: true,\n        },\n    },\n</code></pre>\n"}], "owner": {"reputation": 78, "user_id": 4528653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sTMgu.jpg?s=128&g=1", "display_name": "Javier Benitez", "link": "https://stackoverflow.com/users/4528653/javier-benitez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 54402717, "answer_count": 1, "score": -2, "last_activity_date": 1548703324, "creation_date": 1548677595, "question_id": 54401790, "link": "https://stackoverflow.com/questions/54401790/how-can-i-use-http-1-x-in-client-and-server", "title": "How can I use HTTP/1.x in client and server", "body": "<p>I have a basic client and server implementations working using HTTP/2. I want to test that the server works with HTTP/1 too.  </p>\n\n<p>Is there any way to change the protocol from HTTP/2 to HTTP/1.x?</p>\n\n<p>Client code:</p>\n\n<pre><code>func main() {\n  host = \"https://127.0.0.1:8080\"\n  client = http.Client{\n\n    // InsecureTLSDial is temporary and will likely be\n    // replaced by a different API later.\n    Transport: &amp;http2.Transport{\n        TLSClientConfig: &amp;tls.Config{\n            InsecureSkipVerify: true,\n        },\n    },\n  }\n\n  // further functionality\n}\n</code></pre>\n\n<p>Server code:</p>\n\n<pre><code>func main() {\n\n    var srv http.Server\n    srv.Addr = \":8080\"\n\n    // Set Routes\n    routes()\n\n    // Start server\n    srv.ListenAndServeTLS(\"certs/localhost.cert\", \"certs/localhost.key\")\n}\n</code></pre>\n"}, {"tags": ["go", "dependencies", "dep"], "comments": [{"owner": {"reputation": 2886, "user_id": 2219213, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/BW004.jpg?s=128&g=1", "display_name": "Sergii Getman", "link": "https://stackoverflow.com/users/2219213/sergii-getman"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548678866, "post_id": 54401542, "comment_id": 95614603, "body": "<code>go list</code> just list the name of the current project. but actually i need a list of external dependencies"}, {"owner": {"reputation": 1124, "user_id": 3805062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nIUyW.jpg?s=128&g=1", "display_name": "bayrinat", "link": "https://stackoverflow.com/users/3805062/bayrinat"}, "edited": false, "score": 1, "creation_date": 1548679522, "post_id": 54401542, "comment_id": 95614991, "body": "<code>dep</code> can&#39;t do it out of box. The easiest way is creating your own tool to parse Gopkg.lock. It shouldn&#39;t take more than half an hour."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1548685680, "post_id": 54401542, "comment_id": 95618611, "body": "Sorry, missed the <code>dep</code> part (though <code>go list</code> can list imports, or all dependencies, test imports, files etc). Since <code>cloud.google.com&#47;go</code> is a package just like any other, I would also just parse your lock file for the information you want."}, {"owner": {"reputation": 2886, "user_id": 2219213, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/BW004.jpg?s=128&g=1", "display_name": "Sergii Getman", "link": "https://stackoverflow.com/users/2219213/sergii-getman"}, "reply_to_user": {"reputation": 1124, "user_id": 3805062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nIUyW.jpg?s=128&g=1", "display_name": "bayrinat", "link": "https://stackoverflow.com/users/3805062/bayrinat"}, "edited": false, "score": 0, "creation_date": 1548755001, "post_id": 54401542, "comment_id": 95645712, "body": "@bayrinat thanks, went that way"}], "owner": {"reputation": 2886, "user_id": 2219213, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/BW004.jpg?s=128&g=1", "display_name": "Sergii Getman", "link": "https://stackoverflow.com/users/2219213/sergii-getman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548676756, "creation_date": 1548676756, "question_id": 54401542, "link": "https://stackoverflow.com/questions/54401542/go-dep-list-dependencies-links", "title": "Go dep list dependencies links", "body": "<p>Is it possible to list just links/names to go dependencies? \nFor example in <code>Gopkg.lock</code> I have:</p>\n\n<pre><code>[[projects]]\n  digest = \"x:xxxxxxx\"\n  name = \"cloud.google.com/go\"\n  packages = [\n    \"xxxxx\",\n    \"xxxxx/xxxxx\",\n  ]\n</code></pre>\n\n<p>I want just <code>name</code>: cloud.google.com/go be listed</p>\n"}, {"tags": ["go", "sleep", "channel"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 4, "creation_date": 1548675414, "post_id": 54401093, "comment_id": 95612780, "body": "The main goroutine does not wait for the sleep to end, it will print <code>..&#47;</code> immediately. If you don&#39;t see it, chances are you have <code>GOMAXPROCS</code> set to 1, and so it&#39;s subject to goroutine scheduling. Goroutines run concurrently, and they may run parallel (it&#39;s not the same)."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1548683887, "post_id": 54401093, "comment_id": 95617557, "body": "&quot;Why are goroutines not designed...&quot; you&#39;d have to ask the designers."}], "answers": [{"comments": [{"owner": {"reputation": 452, "user_id": 3934499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0005554c3b863a1bb17a6aca5a40acfa?s=128&d=identicon&r=PG&f=1", "display_name": "agyeya", "link": "https://stackoverflow.com/users/3934499/agyeya"}, "edited": false, "score": 0, "creation_date": 1548678491, "post_id": 54401218, "comment_id": 95614407, "body": "Alright, so this means that main thread and the goroutines can run in parallel. However, it seems like there is no default wait in a goroutine to wait on a channel to receive data."}, {"owner": {"reputation": 17097, "user_id": 672689, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IPnRU.png?s=128&g=1", "display_name": "Roee Gavirel", "link": "https://stackoverflow.com/users/672689/roee-gavirel"}, "reply_to_user": {"reputation": 452, "user_id": 3934499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0005554c3b863a1bb17a6aca5a40acfa?s=128&d=identicon&r=PG&f=1", "display_name": "agyeya", "link": "https://stackoverflow.com/users/3934499/agyeya"}, "edited": false, "score": 1, "creation_date": 1548678716, "post_id": 54401218, "comment_id": 95614521, "body": "No, there is no default wait in the GoRoutine. It&#39;s up to you to write/read to/from a channel both in the GoRoutine and in the main thread."}, {"owner": {"reputation": 17097, "user_id": 672689, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IPnRU.png?s=128&g=1", "display_name": "Roee Gavirel", "link": "https://stackoverflow.com/users/672689/roee-gavirel"}, "reply_to_user": {"reputation": 452, "user_id": 3934499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0005554c3b863a1bb17a6aca5a40acfa?s=128&d=identicon&r=PG&f=1", "display_name": "agyeya", "link": "https://stackoverflow.com/users/3934499/agyeya"}, "edited": false, "score": 0, "creation_date": 1548688956, "post_id": 54401218, "comment_id": 95620660, "body": "@agyeya - if it answerd your question, please approve."}], "tags": [], "owner": {"reputation": 17097, "user_id": 672689, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IPnRU.png?s=128&g=1", "display_name": "Roee Gavirel", "link": "https://stackoverflow.com/users/672689/roee-gavirel"}, "is_accepted": true, "score": 4, "last_activity_date": 1548676572, "last_edit_date": 1548676572, "creation_date": 1548675605, "answer_id": 54401218, "question_id": 54401093, "link": "https://stackoverflow.com/questions/54401093/wait-on-main-thread-with-sleep-in-goroutine/54401218#54401218", "title": "Wait on main thread with sleep in goroutine", "body": "<p>I think your main thread is waiting for something to come from the channel</p>\n\n<pre><code>func main() {\n    channel := make(chan int)\n    go func() {\n        time.Sleep(3*time.Second)\n        channel &lt;- 1 // Sending something to the channel to let the main thread continue\n        channel &lt;- 2\n    }()\n\n    for {\n        fmt.Println(\"../\");\n        &lt;-channel // Waiting for something to come from the channel\n    }\n}\n</code></pre>\n\n<p>regarding your specific questions:</p>\n\n<blockquote>\n  <p>If there is a wait in a goroutine, why is the main goroutine waiting\n  on it?</p>\n</blockquote>\n\n<p>It doesn't wait for it, it probably waiting on the channel.</p>\n\n<blockquote>\n  <p>I read that the main goroutine needs to have a wait time as the\n  control is passed back to it immediately after invoking goroutine.</p>\n</blockquote>\n\n<p>If your main wasn't waiting on the channel (or stack in an endless loop) it had finished and closed the application. GoRoutines closes with the main thread (like Java daemon threads)</p>\n\n<blockquote>\n  <p>Why are goroutines not designed like main thread and child threads in\n  java where they can run in parallel?</p>\n</blockquote>\n\n<p>They actually do (:</p>\n"}], "owner": {"reputation": 452, "user_id": 3934499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0005554c3b863a1bb17a6aca5a40acfa?s=128&d=identicon&r=PG&f=1", "display_name": "agyeya", "link": "https://stackoverflow.com/users/3934499/agyeya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 770, "favorite_count": 0, "accepted_answer_id": 54401218, "answer_count": 1, "score": -1, "last_activity_date": 1548676572, "creation_date": 1548675201, "question_id": 54401093, "link": "https://stackoverflow.com/questions/54401093/wait-on-main-thread-with-sleep-in-goroutine", "title": "Wait on main thread with sleep in goroutine", "body": "<p>Wrote this very basic code to understand channels.</p>\n\n<ol>\n<li><p>If there is a wait in a goroutine, why is the main goroutine waiting on it? I read that the main goroutine needs to have a wait time as the control is passed back to it immediately after invoking goroutine.</p></li>\n<li><p>Why are goroutines not designed like main thread and child threads in java where they can run in parallel?</p></li>\n</ol>\n\n<pre><code>func main() {\n    channel := make(chan int)\n    go func() {\n        time.Sleep(3*time.Second)\n    }()\n\n    for {\n        fmt.Println(\"../\");\n        &lt;-channel\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "prometheus"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10976867, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hDtokpdau7c/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQN9B07OtJUlzayxvj0PLoRHPRLVeA/mo/photo.jpg?sz=128", "display_name": "user10976867", "link": "https://stackoverflow.com/users/10976867/user10976867"}, "edited": false, "score": 0, "creation_date": 1548706819, "post_id": 54407882, "comment_id": 95630231, "body": "Peter, I added the main with the goroutine for a bigger picture. I believe it&#39;s a matter of organizing it, it just hasn&#39;t clicked with me yet."}], "tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": false, "score": 0, "last_activity_date": 1548698872, "creation_date": 1548698872, "answer_id": 54407882, "question_id": 54400025, "link": "https://stackoverflow.com/questions/54400025/prometheus-type-collector-how-to-feed-maps-with-my-own-data/54407882#54407882", "title": "Prometheus type Collector - how to feed maps with my own data", "body": "<blockquote>\n  <p>I think the skill I am missing here is how to call the function so that key:values from myMap go into func (c *ClusterManager) ReallyExpensiveAssessmentOfTheSystemState() ( oomCountByHost map[string]int, ramUsageByHost map[string]float64,){}</p>\n</blockquote>\n\n<p><code>ReallyExpensiveAssessmentOfTheSystemState</code> is called in the <code>Collect</code> method. Your map doesn't \"go into\" that method, it is returned by <code>ReallyExpensiveAssessmentOfTheSystemState</code>.</p>\n\n<p>Simply move the code from the goroutine into <code>ReallyExpensiveAssessmentOfTheSystemState</code>:</p>\n\n<pre><code>func (c *ClusterManager) ReallyExpensiveAssessmentOfTheSystemState() map[string]float64 {\n    myMap := make(map[string]float64)\n    myMap[\"device1\"] = 754\n    myMap[\"device2\"] = 765\n\n    return myMap\n}\n\nfunc (cc ClusterManagerCollector) Collect(ch chan&lt;- prometheus.Metric) {\n    values := cc.ClusterManager.ReallyExpensiveAssessmentOfTheSystemState()\n\n    for key, value := range values {\n        ch &lt;- prometheus.MustNewConstMetric(\n            valueDesc,\n            prometheus.CounterValue,\n            value,\n            key,\n        )\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10976867, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hDtokpdau7c/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQN9B07OtJUlzayxvj0PLoRHPRLVeA/mo/photo.jpg?sz=128", "display_name": "user10976867", "link": "https://stackoverflow.com/users/10976867/user10976867"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 519, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548706587, "creation_date": 1548671565, "last_edit_date": 1548706587, "question_id": 54400025, "link": "https://stackoverflow.com/questions/54400025/prometheus-type-collector-how-to-feed-maps-with-my-own-data", "title": "Prometheus type Collector - how to feed maps with my own data", "body": "<p>Disclaimer: I am new to Golang and haven't done much programming in any other language before.\nI still hope someone can point me in the right direction though.</p>\n\n<p>The goal is:\nAs per the 'Example' section under Prometheus Golang module (<a href=\"https://godoc.org/github.com/prometheus/client_golang/prometheus#Collector\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/prometheus/client_golang/prometheus#Collector</a>) and the part where it's mentioned \"// Just example fake data.\" to use my own real data of course.</p>\n\n<p>My data comes in JSON format from a RabbitMQ endpoint. I parse JSON and I can create my own maps with the right key:value that I need as part of a goroutine under the func main() scope.</p>\n\n<p>Suppose my map looks as follows:\n[\n\"device1\" : 754,\n\"device2\" : 765,\n]</p>\n\n<p>For the code, let's follow the original example.</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n    \"fmt\"\n\n    \"github.com/prometheus/client_golang/prometheus\"\n    \"github.com/prometheus/client_golang/prometheus/promhttp\"\n)\n\ntype ClusterManager struct {\n    Zone string\n    // Contains many more fields not listed in this example.\n}\n\nfunc (c *ClusterManager) ReallyExpensiveAssessmentOfTheSystemState() (\n    oomCountByHost map[string]int, ramUsageByHost map[string]float64,\n) {\n        // Just example fake data.\n        oomCountByHost = map[string]int{\n            \"foo.example.org\": 42,\n            \"bar.example.org\": 2001,\n        }\n        ramUsageByHost = map[string]float64{\n            \"foo.example.org\": 6.023e23,\n            \"bar.example.org\": 3.14,\n        }\n        return\n}\n\ntype ClusterManagerCollector struct {\n    ClusterManager *ClusterManager\n}\n\nvar (\n    oomCountDesc = prometheus.NewDesc(\n        \"clustermanager_oom_crashes_total\",\n        \"Number of OOM crashes.\",\n        []string{\"host\"}, nil,\n    )\n    ramUsageDesc = prometheus.NewDesc(\n        \"clustermanager_ram_usage_bytes\",\n        \"RAM usage as reported to the cluster manager.\",\n        []string{\"host\"}, nil,\n    )\n)\n\nfunc (cc ClusterManagerCollector) Describe(ch chan&lt;- *prometheus.Desc) {\n    prometheus.DescribeByCollect(cc, ch)\n}\n\nfunc (cc ClusterManagerCollector) Collect(ch chan&lt;- prometheus.Metric) {\n    oomCountByHost, ramUsageByHost := cc.ClusterManager.ReallyExpensiveAssessmentOfTheSystemState()\n    for host, oomCount := range oomCountByHost {\n        ch &lt;- prometheus.MustNewConstMetric(\n            oomCountDesc,\n            prometheus.CounterValue,\n            float64(oomCount),\n            host,\n        )\n    }\n    for host, ramUsage := range ramUsageByHost {\n        ch &lt;- prometheus.MustNewConstMetric(\n            ramUsageDesc,\n            prometheus.GaugeValue,\n            ramUsage,\n            host,\n        )\n    }\n}\n\nfunc NewClusterManager(zone string, reg prometheus.Registerer) *ClusterManager {\n    c := &amp;ClusterManager{\n        Zone: zone,\n    }\n    cc := ClusterManagerCollector{ClusterManager: c}\n    prometheus.WrapRegistererWith(prometheus.Labels{\"zone\": zone}, reg).MustRegister(cc)\n    return c\n}\n\nfunc main() {\n    conn, err := amqp.Dial(\"amqp://guest:guest@localhost:5672/\")\n    failOnError(err, \"Failed to connect to RabbitMQ\")\n    defer conn.Close()\n\n    ch, err := conn.Channel()\n    failOnError(err, \"Failed to open a channel\")\n    defer ch.Close()\n\n    q, err := ch.QueueDeclare(\"hello\", false, false, false, false, nil)\n    failOnError(err, \"Failed to declare a queue\")\n\n    msgs, err := ch.Consume(q.Name, \"\", true, false, false, false, nil)\n    failOnError(err, \"Failed to register a consumer\")\n\n    forever := make(chan bool)\n\n    go func() {\n        for d := range msgs {\n            var streams []byte\n            streams = d.Body\n\n            var metrics sStreamingMetrics\n            err := json.Unmarshal(streams, &amp;metrics)\n            if err != nil {\n                fmt.Println(err)\n            }\n\n            var category string\n            category = metrics.Resource.Category\n\n            if category == \"server\" {\n               myMap := make(map[string]float64)\n               MyMap [metrics.Resource.ResourceDataList[0].ResourceId] = metrics.Resource.ResourceDataList[0].MetricSampleList[0].ValueArray[0]\n             }\n    }()\n\n    reg := prometheus.NewPedanticRegistry()\n\n    NewClusterManager(\"zone\", reg)\n\n    reg.MustRegister(\n        prometheus.NewProcessCollector(prometheus.ProcessCollectorOpts{}),\n        prometheus.NewGoCollector(),\n    )\n\n    http.Handle(\"/metrics\", promhttp.HandlerFor(reg, promhttp.HandlerOpts{}))\n    log.Fatal(http.ListenAndServe(\":8080\", nil))\n    log.Printf(\" [*] Waiting for logs. To exit press CTRL+C\")\n    &lt;-forever\n}\n\n//relevant structs go here for parsing JSON\n</code></pre>\n\n<p>Added the goroutine and the main for a bigger picture.\nThere's concurency as I'll be receiving data from time to time.\nI think the skill I am missing here is how to call the function so that key:values from myMap go into\nfunc (c *ClusterManager) ReallyExpensiveAssessmentOfTheSystemState() (\n    oomCountByHost map[string]int, ramUsageByHost map[string]float64,){}</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 3818, "user_id": 1247113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRMFj.png?s=128&g=1", "display_name": "rob74", "link": "https://stackoverflow.com/users/1247113/rob74"}, "is_accepted": true, "score": 1, "last_activity_date": 1548672074, "last_edit_date": 1548672074, "creation_date": 1548671123, "answer_id": 54399910, "question_id": 54399444, "link": "https://stackoverflow.com/questions/54399444/getting-an-error-when-trying-to-check-path/54399910#54399910", "title": "Getting an error when trying to check path", "body": "<p>In Go strings enclosed by double quotes, a backslash starts an escape code, e.g. <code>\\n</code> or <code>\\u2318</code>. To avoid this, you have two options:</p>\n\n<ul>\n<li>use a double backslash (<code>\\\\</code>), e.g. <code>\"C:\\\\Users\"</code></li>\n<li>use backticks (<code>`</code>) instead of double quotes to define a \"raw string\", e.g. <code>`C:\\Users`</code></li>\n</ul>\n\n<p><a href=\"https://blog.golang.org/strings\" rel=\"nofollow noreferrer\">Further reading</a></p>\n"}, {"tags": [], "owner": {"reputation": 285, "user_id": 3256914, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5f673d6c8594575dc79e0bf2c5b7bd38?s=128&d=identicon&r=PG&f=1", "display_name": "Mcoder", "link": "https://stackoverflow.com/users/3256914/mcoder"}, "is_accepted": false, "score": 3, "last_activity_date": 1548921394, "last_edit_date": 1548921394, "creation_date": 1548834956, "answer_id": 54435700, "question_id": 54399444, "link": "https://stackoverflow.com/questions/54399444/getting-an-error-when-trying-to-check-path/54435700#54435700", "title": "Getting an error when trying to check path", "body": "<p>You can use <code>path</code> package to work with the urls('<code>path/filepath</code>' for the file paths) which also contributes in platform independency. So you can do following to create the path</p>\n\n<pre><code>givenPath = filepath.Join(DirectoryName, path)\n</code></pre>\n\n<p>There is also another way of doing this</p>\n\n<pre><code>path := strings.Join([]string{DirectoryName, path}, string(os.PathSeparator))\n</code></pre>\n"}], "owner": {"reputation": 614, "user_id": 6424168, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh6.googleusercontent.com/-Ma90L9K1ny8/AAAAAAAAAAI/AAAAAAAAABI/9ZMB4GR_z0M/photo.jpg?sz=128", "display_name": "Yur Gasparyan", "link": "https://stackoverflow.com/users/6424168/yur-gasparyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 54399910, "answer_count": 2, "score": 2, "last_activity_date": 1548921394, "creation_date": 1548669558, "last_edit_date": 1548672454, "question_id": 54399444, "link": "https://stackoverflow.com/questions/54399444/getting-an-error-when-trying-to-check-path", "title": "Getting an error when trying to check path", "body": "<p>I am trying to check <code>windows</code> dir in my golang app.\nHere is my code</p>\n\n<pre><code>func createWalletDirectory(path string) (err error) {\n    _, err = os.Stat(path)\n\n    if os.IsNotExist(err) {\n        return err\n    }\n\n    path = filepath.FromSlash(path)\n\n    path = path + string(os.PathSeparator) + DirectoryName\n\n    err = os.Mkdir(path, 0666)\n\n    return\n}\n</code></pre>\n\n<p>So on the first line of the function I am getting an error look like this</p>\n\n<blockquote>\n  <p>invalid character 'i' in string escape code</p>\n</blockquote>\n\n<p>Example path : <code>C:\\Users</code></p>\n\n<p>Note: The path I am getting from users via POST request\nSo I need to make a code which will check crossplatform paths.\nHow can I solve this error ?</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3", "aws-sdk", "awss3transfermanager"], "answers": [{"tags": [], "owner": {"reputation": 1124, "user_id": 3805062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nIUyW.jpg?s=128&g=1", "display_name": "bayrinat", "link": "https://stackoverflow.com/users/3805062/bayrinat"}, "is_accepted": true, "score": 7, "last_activity_date": 1548677394, "last_edit_date": 1548677394, "creation_date": 1548677092, "answer_id": 54401639, "question_id": 54399421, "link": "https://stackoverflow.com/questions/54399421/how-to-download-from-aws-s3-using-golang/54401639#54401639", "title": "How to download from AWS S3 using golang", "body": "<p>There are several ways to set credentials. For more details <a href=\"https://github.com/aws/aws-sdk-go/tree/v1.16.26/aws/credentials\" rel=\"noreferrer\">aws/credentials</a>.</p>\n\n<p>For example, you can specify it by setting environment variables:</p>\n\n<pre><code>AWS_ACCESS_KEY = &lt;your_access_key&gt;\nAWS_SECRET_KEY = &lt;your_secret_key&gt;\n</code></pre>\n\n<p>Then just use <code>credentials.NewEnvCredentials()</code> in your config instance:</p>\n\n<pre><code>sess, _ := session.NewSession(&amp;aws.Config{\n    Region:      aws.String(\"us-east-1\"),\n    Credentials: credentials.NewEnvCredentials(),\n})\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 672, "user_id": 2638505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4c3639e1f44f15afdb6de18a9e12740?s=128&d=identicon&r=PG", "display_name": "Effi Bar-She&#39;an", "link": "https://stackoverflow.com/users/2638505/effi-bar-shean"}, "is_accepted": false, "score": 1, "last_activity_date": 1595183073, "creation_date": 1595183073, "answer_id": 62984113, "question_id": 54399421, "link": "https://stackoverflow.com/questions/54399421/how-to-download-from-aws-s3-using-golang/62984113#62984113", "title": "How to download from AWS S3 using golang", "body": "<p>Just set <code>AWS_ACCESS_KEY</code> and <code>AWS_SECRET_KEY</code> environment variables (you do not need to call <code>credentials.NewEnvCredentials()</code> as part of <code>session.NewSession</code> - what you did is perfect):</p>\n<pre><code>func DownloadFromS3Bucket() {\n    \n    os.Setenv(&quot;AWS_ACCESS_KEY&quot;,&quot;my-key&quot;)\n    os.Setenv(&quot;AWS_SECRET_KEY&quot;,&quot;my-secret&quot;)\n\n    bucket := &quot;cellery-runtime-installation&quot;\n    item := &quot;hello-world.txt&quot;\n\n    file, err := os.Create(item)\n    if err != nil {\n        fmt.Println(err)\n    }\n    defer file.Close()\n\n    sess, _ := session.NewSession(&amp;aws.Config{Region: aws.String(&quot;us-east-1&quot;)})\n    downloader := s3manager.NewDownloader(sess)\n    numBytes, err := downloader.Download(file,\n        &amp;s3.GetObjectInput{\n            Bucket: aws.String(bucket),\n            Key:    aws.String(item),\n        })\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    fmt.Println(&quot;Downloaded&quot;, file.Name(), numBytes, &quot;bytes&quot;)\n}\n</code></pre>\n<p>This is the complete example from AWS Go SDK: <a href=\"https://github.com/awsdocs/aws-doc-sdk-examples/blob/master/go/example_code/s3/s3_download_object.go\" rel=\"nofollow noreferrer\">https://github.com/awsdocs/aws-doc-sdk-examples/blob/master/go/example_code/s3/s3_download_object.go</a></p>\n<p>I wrote a blog post on how to <em>test the S3 downloader</em>, and created a <em>testable S3 bucket scanner</em>, which list all bucket's files and temporary download each file, see: <a href=\"https://medium.com/@tufin/a-testable-go-aws-s3-scanner-e54de0c26197\" rel=\"nofollow noreferrer\">https://medium.com/@tufin/a-testable-go-aws-s3-scanner-e54de0c26197</a></p>\n<p>Here you can find the code: <a href=\"https://github.com/Tufin/blog/tree/master/s3-scanner\" rel=\"nofollow noreferrer\">https://github.com/Tufin/blog/tree/master/s3-scanner</a></p>\n"}], "owner": {"reputation": 935, "user_id": 10391130, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CBVYnKKBv5w/AAAAAAAAAAI/AAAAAAAAAEc/bw1Ub6elbng/photo.jpg?sz=128", "display_name": "Madhuka Wickramapala", "link": "https://stackoverflow.com/users/10391130/madhuka-wickramapala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7909, "favorite_count": 0, "accepted_answer_id": 54401639, "answer_count": 2, "score": 7, "last_activity_date": 1595183073, "creation_date": 1548669488, "last_edit_date": 1548674063, "question_id": 54399421, "link": "https://stackoverflow.com/questions/54399421/how-to-download-from-aws-s3-using-golang", "title": "How to download from AWS S3 using golang", "body": "<p>I am writing a go function to download a file from AWS S3 bucket. </p>\n\n<pre><code>func DownloadFromS3Bucket() {\n    bucket := \"cellery-runtime-installation\"\n    item := \"hello-world.txt\"\n\n    file, err := os.Create(item)\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    defer file.Close()\n\n    // Initialize a session in us-west-2 that the SDK will use to load\n    // credentials from the shared credentials file ~/.aws/credentials.\n    sess, _ := session.NewSession(&amp;aws.Config{\n        Region: aws.String(\"us-east-1\")},\n    )\n\n    downloader := s3manager.NewDownloader(sess)\n\n    numBytes, err := downloader.Download(file,\n        &amp;s3.GetObjectInput{\n            Bucket: aws.String(bucket),\n            Key:    aws.String(item),\n        })\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    fmt.Println(\"Downloaded\", file.Name(), numBytes, \"bytes\")\n}\n</code></pre>\n\n<p>However, I am getting an error message asking for credentials.</p>\n\n<blockquote>\n  <p>NoCredentialProviders: no valid providers in chain. Deprecated.   For\n  verbose messaging see aws.Config.CredentialsChainVerboseErrors</p>\n</blockquote>\n\n<p>The documentation does not specifically say how to set the credentials. (Access key ID,Secret access key)</p>\n\n<p>Any idea?</p>\n"}, {"tags": ["docker", "go"], "comments": [{"owner": {"reputation": 16065, "user_id": 1561148, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/zN5vT.jpg?s=128&g=1", "display_name": "tgogos", "link": "https://stackoverflow.com/users/1561148/tgogos"}, "edited": false, "score": 0, "creation_date": 1548670024, "post_id": 54399376, "comment_id": 95609848, "body": "Can you provide a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>?"}, {"owner": {"reputation": 642, "user_id": 3420149, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/qO8hL.jpg?s=128&g=1", "display_name": "AknKplnoglu", "link": "https://stackoverflow.com/users/3420149/aknkplnoglu"}, "edited": false, "score": 0, "creation_date": 1589644212, "post_id": 54399376, "comment_id": 109377713, "body": "Hi @Logan Shire, Did you find the solution ?"}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 4976835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KrOHZElHZDw/AAAAAAAAAAI/AAAAAAAAADo/ZovIF4RVbUQ/photo.jpg?sz=128", "display_name": "Viet Long Nguyen", "link": "https://stackoverflow.com/users/4976835/viet-long-nguyen"}, "is_accepted": false, "score": 0, "last_activity_date": 1548673457, "creation_date": 1548673457, "answer_id": 54400580, "question_id": 54399376, "link": "https://stackoverflow.com/questions/54399376/docker-logs-from-go-container-log-and-fmt-stop-after-init/54400580#54400580", "title": "Docker logs from go container (log and fmt) stop after init", "body": "<p>You may want to write your logs into the /dev/stdout\nor simply use </p>\n\n<pre><code>log.SetOutput(os.Stdout)\n</code></pre>\n\n<p>From <a href=\"https://golang.org/src/log/log.go\" rel=\"nofollow noreferrer\">log</a> package</p>\n"}], "owner": {"reputation": 4515, "user_id": 1710704, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a3b646c4f3b358bc74cfe636ca9655f7?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Shire", "link": "https://stackoverflow.com/users/1710704/logan-shire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 634, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1596925177, "creation_date": 1548669337, "question_id": 54399376, "link": "https://stackoverflow.com/questions/54399376/docker-logs-from-go-container-log-and-fmt-stop-after-init", "title": "Docker logs from go container (log and fmt) stop after init", "body": "<p>I'm working on an application which consists of a number of go containers. I manage them with docker compose. Recently I've been having trouble getting logs out of them. When I run \"docker logs [container-name]\", I only see logs that were created during init for packages in my application, and during main before the service starts listening. Subsequent calls to log.Println or fmt.Println do not appear in the output of \"docker logs\".\nDo you know what could be going on?</p>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 8470, "user_id": 538866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb67b45ca1dc2584f8e4d703d009177b?s=128&d=identicon&r=PG", "display_name": "Jonas G. Drange", "link": "https://stackoverflow.com/users/538866/jonas-g-drange"}, "edited": false, "score": 0, "creation_date": 1548669415, "post_id": 54399167, "comment_id": 95609479, "body": "What does the application print?"}, {"owner": {"reputation": 87, "user_id": 10765021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ced873201945cfa92e484c00e0459f4?s=128&d=identicon&r=PG&f=1", "display_name": "toti toto", "link": "https://stackoverflow.com/users/10765021/toti-toto"}, "reply_to_user": {"reputation": 8470, "user_id": 538866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb67b45ca1dc2584f8e4d703d009177b?s=128&d=identicon&r=PG", "display_name": "Jonas G. Drange", "link": "https://stackoverflow.com/users/538866/jonas-g-drange"}, "edited": false, "score": 0, "creation_date": 1548669498, "post_id": 54399167, "comment_id": 95609535, "body": "The response of the first request (success) and then the error mentioned above (http: invalid read on request body). added full output to the post."}, {"owner": {"reputation": 2764, "user_id": 3521116, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0feed05aa5a4174d4210276c06fbadc6?s=128&d=identicon&r=PG&f=1", "display_name": "warl0ck", "link": "https://stackoverflow.com/users/3521116/warl0ck"}, "edited": false, "score": 2, "creation_date": 1548671901, "post_id": 54399167, "comment_id": 95610932, "body": "The problem is you are re-using <code>req</code> variable whose body is already closed, try to make a new request in the for loop for each case"}, {"owner": {"reputation": 87, "user_id": 10765021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ced873201945cfa92e484c00e0459f4?s=128&d=identicon&r=PG&f=1", "display_name": "toti toto", "link": "https://stackoverflow.com/users/10765021/toti-toto"}, "edited": false, "score": 0, "creation_date": 1548672543, "post_id": 54399167, "comment_id": 95611254, "body": "Nice, thanks, how can I do that?"}], "owner": {"reputation": 87, "user_id": 10765021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ced873201945cfa92e484c00e0459f4?s=128&d=identicon&r=PG&f=1", "display_name": "toti toto", "link": "https://stackoverflow.com/users/10765021/toti-toto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 468, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1548673276, "creation_date": 1548668663, "last_edit_date": 1548671493, "question_id": 54399167, "link": "https://stackoverflow.com/questions/54399167/invalid-read-on-closed-body-while-using-client-do", "title": "invalid read on closed body while using Client.Do", "body": "<p>trying to send more than one of the same HTTP request generated by http.ReadRequest, I'm getting the following error:</p>\n\n<pre><code>Post http://192.168.x.x:8000/dir1: http: invalid Read on closed Body\npanic: runtime error: invalid memory address or nil pointer dereference\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x0 pc=0x5ec4cc]\n</code></pre>\n\n<p>My code takes a file, and puts it in a <code>bufio.NewReader</code>. It then uses <code>http.ReadRequest</code> on what it had read, which is a <code>HTTP POST</code> request. finally - it opens another file, \"wordlist.txt\", which contains directories - and iterates over the original HTTP URI each time with a different directory from the list.\nFor some reason - the second requests causes to program to error out (<code>http: invalid Read on closed Body</code>). Heres a working example (just change the paths to yours):</p>\n\n<p><strong>main.go</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"net/url\"\n    \"os\"\n)\n\nfunc main() {\n    //Read HTTP request from text file\n    rdr, err := os.Open(\"/opt/gohttp/tests/req2.txt\")\n    if err != nil {\n        log.Println(err)\n    }\n\n    //Parse to a web request to work with using ReadRequest\n    req, err := http.ReadRequest(bufio.NewReader(rdr))\n    if err != nil {\n        log.Println(err)\n    }\n\n    // fix for \"requestURI can't be sent in client requests\"\n    req.RequestURI = \"\"\n\n    //Open wordlist\n    file, err := os.Open(\"/opt/gohttp/tests/wordlist.txt\")\n    if err != nil {\n        log.Println(err)\n    }\n    defer file.Close()\n\n    //Scan wordlist line by line and append each to the directory\n    scanner := bufio.NewScanner(file)\n    for scanner.Scan() {\n        var i string = scanner.Text()\n        fmt.Println(i)\n        //this part appends the wordlist word to the request sent e.g. /dir1\n        u, err := url.Parse(\"http://\" + req.Host + \"/\" + i) //todo: https? other protocols?\n        if err != nil {\n            log.Println(\"scanner parse error: \", err)\n        }\n        req.URL = u\n\n        //Send the request\n        fmt.Println(\"Sending request..\" + \"\\n\")\n        client := &amp;http.Client{}\n        response, err := client.Do(req)\n        if err != nil {\n            log.Println(err) // invalid read on closed body error\n        }\n        fmt.Println(*response)\n    }\n    if err := scanner.Err(); err != nil {\n        log.Fatal(err)\n    }\n\n}\n</code></pre>\n\n<p><strong>example HTTP request file</strong></p>\n\n<pre><code>POST /hi HTTP/1.1\nHost: 192.168.x.x:8000\nContent-Length: 41\n\n{\"email\":\"aa\",\"password\":\"secret\"}\n</code></pre>\n\n<p><strong>example wordlist file</strong></p>\n\n<pre><code>0\n1\ndir1\ndir2\ndir3\n</code></pre>\n\n<p><strong>application output</strong></p>\n\n<pre><code>go run tests/main.go\n\n0\nSending request..\n\n{404 Not Found 404 HTTP/1.1 1 1...}\n\n1\nSending request..\n\n2019/01/28 04:27:52 Post http://192.168.x.x:8000/1: http: invalid Read on closed Body\npanic: runtime error: invalid memory address or nil pointer dereference\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x0 pc=0x5ec4cc]\n\ngoroutine 1 [running]:\nmain.main()\n    /opt/gohttp/tests/main.go:53 +0x35c\nexit status 2\n</code></pre>\n\n<p>Please note that the first HTTP request is sent successfuly, and only the second one returns the error above. How can I fix this?</p>\n"}, {"tags": ["mongodb", "go", "transactions"], "answers": [{"comments": [{"owner": {"reputation": 390, "user_id": 2481981, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6b557fbb677f7cc2fd8647f723195ffb?s=128&d=identicon&r=PG", "display_name": "Sreenath", "link": "https://stackoverflow.com/users/2481981/sreenath"}, "edited": false, "score": 0, "creation_date": 1548761118, "post_id": 54401731, "comment_id": 95649561, "body": "This helped me a lot. Thanks for the tutorials as well."}, {"owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "edited": false, "score": 0, "creation_date": 1549321772, "post_id": 54401731, "comment_id": 95853614, "body": "related to older question relating to transaction but for bulk-write : <a href=\"https://stackoverflow.com/questions/53621036/bulkwrite-does-not-support-multi-document-transaction-by-using-mongo-go-driver\" title=\"bulkwrite does not support multi document transaction by using mongo go driver\">stackoverflow.com/questions/53621036/&hellip;</a>"}, {"owner": {"reputation": 1122, "user_id": 4970650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/496526a825adf2e6587a19d3a6d391f7?s=128&d=identicon&r=PG", "display_name": "Cirelli94", "link": "https://stackoverflow.com/users/4970650/cirelli94"}, "edited": false, "score": 0, "creation_date": 1600156489, "post_id": 54401731, "comment_id": 112991327, "body": "what is the difference between a session and a transaction?"}, {"owner": {"reputation": 659, "user_id": 1155514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mjZMX.jpg?s=128&g=1", "display_name": "Muhammad Tariq", "link": "https://stackoverflow.com/users/1155514/muhammad-tariq"}, "reply_to_user": {"reputation": 1122, "user_id": 4970650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/496526a825adf2e6587a19d3a6d391f7?s=128&d=identicon&r=PG", "display_name": "Cirelli94", "link": "https://stackoverflow.com/users/4970650/cirelli94"}, "edited": false, "score": 1, "creation_date": 1612962499, "post_id": 54401731, "comment_id": 116928817, "body": "@Cirelli94 <a href=\"https://docs.mongodb.com/manual/core/transactions/#transactions-and-sessions\" rel=\"nofollow noreferrer\">docs.mongodb.com/manual/core/transactions/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1374, "user_id": 10849350, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8t7Pj.png?s=128&g=1", "display_name": "simagix", "link": "https://stackoverflow.com/users/10849350/simagix"}, "is_accepted": true, "score": 18, "last_activity_date": 1548678484, "last_edit_date": 1548678484, "creation_date": 1548677363, "answer_id": 54401731, "question_id": 54398579, "link": "https://stackoverflow.com/questions/54398579/example-for-transactions-in-mongodb-with-golang/54401731#54401731", "title": "Example for transactions in mongodb with GoLang", "body": "<p>It can be confusing.  Below is a simple example.</p>\n\n<pre><code>if session, err = client.StartSession(); err != nil {\n    t.Fatal(err)\n}\nif err = session.StartTransaction(); err != nil {\n    t.Fatal(err)\n}\nif err = mongo.WithSession(ctx, session, func(sc mongo.SessionContext) error {\n    if result, err = collection.UpdateOne(sc, bson.M{\"_id\": id}, update); err != nil {\n        t.Fatal(err)\n    }\n    if result.MatchedCount != 1 || result.ModifiedCount != 1 {\n        t.Fatal(\"replace failed, expected 1 but got\", result.MatchedCount)\n    }\n\n    if err = session.CommitTransaction(sc); err != nil {\n        t.Fatal(err)\n    }\n    return nil\n}); err != nil {\n    t.Fatal(err)\n}\nsession.EndSession(ctx)\n</code></pre>\n\n<p>You can view full <a href=\"https://github.com/simagix/mongo-go-examples/blob/master/examples/transaction_test.go\" rel=\"noreferrer\">examples here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 319, "user_id": 8523169, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4e53e241064585e19a15393083799869?s=128&d=identicon&r=PG&f=1", "display_name": "Aayush Taneja", "link": "https://stackoverflow.com/users/8523169/aayush-taneja"}, "edited": false, "score": 1, "creation_date": 1567099250, "post_id": 56389879, "comment_id": 101872057, "body": "Why are you only aborting the transaction when the second operation fails, why not also when the first operation throws an error? @berryberry"}, {"owner": {"reputation": 659, "user_id": 1155514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mjZMX.jpg?s=128&g=1", "display_name": "Muhammad Tariq", "link": "https://stackoverflow.com/users/1155514/muhammad-tariq"}, "reply_to_user": {"reputation": 319, "user_id": 8523169, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4e53e241064585e19a15393083799869?s=128&d=identicon&r=PG&f=1", "display_name": "Aayush Taneja", "link": "https://stackoverflow.com/users/8523169/aayush-taneja"}, "edited": false, "score": 0, "creation_date": 1613018494, "post_id": 56389879, "comment_id": 116948214, "body": "I agree with your point @AayushTaneja, but then we will have to use <code>if else</code> clause every time we interact with the database OR we just have to <code>CommitTransaction</code> in the last line? I think we just have to <code>CommitTransaction</code> in last line. Please correct me"}], "tags": [], "owner": {"reputation": 71, "user_id": 11376854, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VVWGZl1GAmU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rebjMJ6TU4W_MugfXizuGHFhLUoNg/mo/photo.jpg?sz=128", "display_name": "berryberry", "link": "https://stackoverflow.com/users/11376854/berryberry"}, "is_accepted": false, "score": 7, "last_activity_date": 1559284568, "creation_date": 1559284568, "answer_id": 56389879, "question_id": 54398579, "link": "https://stackoverflow.com/questions/54398579/example-for-transactions-in-mongodb-with-golang/56389879#56389879", "title": "Example for transactions in mongodb with GoLang", "body": "<p>This will help you</p>\n\n<pre><code>ctx := context.Background()\nclient, err := mongo.Connect(ctx, options.Client().ApplyURI(\"mongodb://localhost:27017\"))\nif err != nil {\n    panic(err)\n}\n\ndb := client.Database(\"testdb\")\ndefer db.Client().Disconnect(ctx)\ncol := db.Collection(\"testcol\")\n\n// transaction\nerr = db.Client().UseSession(ctx, func(sessionContext mongo.SessionContext) error {\n    err := sessionContext.StartTransaction()\n    if err != nil {\n        fmt.Println(err)\n        return err\n    }\n\n    _, err = col.InsertOne(sessionContext, bson.M{\"_id\": \"1\", \"name\": \"berry\"})\n    if err != nil {\n        fmt.Println(err)\n        return err\n    }\n\n    _, err = col.InsertOne(sessionContext, bson.M{\"_id\": \"2\", \"name\": \"gucci\"})\n    if err != nil {\n        sessionContext.AbortTransaction(sessionContext)\n        fmt.Println(err)\n        return err\n    } else {\n        sessionContext.CommitTransaction(sessionContext)\n    }\n    return nil\n})\n</code></pre>\n"}], "owner": {"reputation": 390, "user_id": 2481981, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6b557fbb677f7cc2fd8647f723195ffb?s=128&d=identicon&r=PG", "display_name": "Sreenath", "link": "https://stackoverflow.com/users/2481981/sreenath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7675, "favorite_count": 10, "accepted_answer_id": 54401731, "answer_count": 2, "score": 7, "last_activity_date": 1559284568, "creation_date": 1548666503, "question_id": 54398579, "link": "https://stackoverflow.com/questions/54398579/example-for-transactions-in-mongodb-with-golang", "title": "Example for transactions in mongodb with GoLang", "body": "<p>I need an example to implement transactions in MongoDB with GoLang.</p>\n\n<p>I'm using this golang driver for mongodb </p>\n\n<p><a href=\"https://github.com/mongodb/mongo-go-driver\" rel=\"noreferrer\">https://github.com/mongodb/mongo-go-driver</a></p>\n\n<p>There is no clear documentation for how to implement transactions.</p>\n\n<p>Can anyone help me?</p>\n"}, {"tags": ["go", "logging"], "answers": [{"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": false, "score": 3, "last_activity_date": 1548700349, "creation_date": 1548700349, "answer_id": 54408215, "question_id": 54395407, "link": "https://stackoverflow.com/questions/54395407/zap-logging-with-1-customized-config-and-2-lumberjack/54408215#54408215", "title": "zap logging with 1) customized config and 2) lumberjack", "body": "<p>You can add custom log destinations using the <code>zap.RegisterSink</code> function and the <code>Config.OutputPaths</code> field. RegisterSink maps URL schemes to Sink constructors, and <code>OutputPaths</code> configures log destinations (encoded as URLs).</p>\n\n<p>Conveniently, <code>*lumberjack.Logger</code> implements almost all of the <code>zap.Sink</code> interface already. Only the <code>Sync</code> method is missing, which can be easily added with a thin wrapper type.</p>\n\n<pre><code>package main\n\nimport (\n    \"net/url\"\n\n    \"go.uber.org/zap\"\n    lumberjack \"gopkg.in/natefinch/lumberjack.v2\"\n)\n\ntype lumberjackSink struct {\n    *lumberjack.Logger\n}\n\n// Sync implements zap.Sink. The remaining methods are implemented \n// by the embedded *lumberjack.Logger.\nfunc (lumberjackSink) Sync() error { return nil }\n\nfunc main() {\n    zap.RegisterSink(\"lumberjack\", func(u *url.URL) (zap.Sink, error) {\n        return lumberjackSink{\n            Logger: &amp;lumberjack.Logger{\n                Filename: u.Opaque,\n\n                // Use query parameters or hardcoded values for remaining\n                // fields.\n            },\n        }, nil\n    })\n\n    config := zap.NewProductionConfig()\n\n    // Add a URL with the \"lumberjack\" scheme.\n    config.OutputPaths = append(config.OutputPaths, \"lumberjack:foo.log\")\n\n    log, _ := config.Build()\n    log.Info(\"test\", zap.String(\"foo\", \"bar\"))\n}\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 1031058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f0a16af9a62c5c7b236daa3cafe284f?s=128&d=identicon&r=PG", "display_name": "Junhee Woo", "link": "https://stackoverflow.com/users/1031058/junhee-woo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1081, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1548700349, "creation_date": 1548648414, "question_id": 54395407, "link": "https://stackoverflow.com/questions/54395407/zap-logging-with-1-customized-config-and-2-lumberjack", "title": "zap logging with 1) customized config and 2) lumberjack", "body": "<p>I'm trying to build a customized zap logger with 1) customized <code>*zap.Config</code> and 2) <code>lumberjack</code>, but can't find proper example to apply both configurations.</p>\n\n<p>Since <code>config.Build</code> does not accept <code>WriteSync</code> as an input. Do you know how to achieve this? </p>\n\n<pre><code>func genBaseLoggerZap() Logger {\n    ex, err := os.Executable()\n    if err != nil {\n        Fatalf(\"Failed to get os.Executable, err: %v\", err)\n    }\n    zlManager.outputPath = path.Join(filepath.Dir(ex), zlManager.outputPath)\n        // Want to add sync here..\n    zapcore.AddSync(&amp;lumberjack.Logger{\n        Filename:   zlManager.outputPath + \"123\",\n        MaxSize:    500,\n        MaxBackups: 10,\n        MaxAge:     28,\n    })\n    return genLoggerZap(BaseLogger, genDefaultConfig())\n}\n\n// genLoggerZap creates a zapLogger with given ModuleID and Config.\nfunc genLoggerZap(mi ModuleID, cfg *zap.Config) Logger {\n    logger, err := cfg.Build()\n    if err != nil {\n        Fatalf(\"Failed to generate zap logger, err: %v\", err)\n    }\n    newLogger := &amp;zapLogger{mi, cfg, logger.Sugar()}\n    newLogger.register()\n    return newLogger\n}\n</code></pre>\n"}, {"tags": ["go"], "owner": {"reputation": 2063, "user_id": 3188445, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/456b429580f304e24b652ca52363b603?s=128&d=identicon&r=PG&f=1", "display_name": "user3188445", "link": "https://stackoverflow.com/users/3188445/user3188445"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1548694228, "creation_date": 1548640181, "last_edit_date": 1548694228, "question_id": 54394595, "link": "https://stackoverflow.com/questions/54394595/facilitating-git-merges-with-multi-package-go-modules", "title": "Facilitating git merges with multi-package go modules", "body": "<p>We have two versions of a go module hosted by different people.  Let's call them <code>example.org/devproject</code> and <code>company.com/project</code>.  Different programs obviously import the two projects by different import paths, as appropriate, depending on whether they want the version maintained by example.org or company.com.  Because the modules have numerous internal packages, the source files themselves contain references to their own module's name in many import statements.</p>\n\n<p>My question is how example.org can make it as easy as possible for company.com to pull from our git repository, because right now a straight git pull messes up the import statements.  Note that stack overflow has similar questions on this prior to go modules.  However, this question is specifically about projects with go.mod files using go 1.11 or later, so please do not refer me to non-module answers or suggest not using go modules yet, because that is a different question.</p>\n\n<p>I've tried the following that unfortunately do not work super well:</p>\n\n<ul>\n<li><p>Use some abstract module name like <code>module self</code> in the <code>go.mod</code> file and add <code>replace self =&gt; example.org/devproject</code>.  Then internal packages can just <code>import \"self/subpackage\"</code>, and only the one <code>replace</code> line needs to change between repositories.  However, that means all including projects need to use a <code>replace</code> directive, and we'd need to convince company.com to change all of their imports relative to \"self\", which isn't super likely.  More importantly, this totally breaks <code>go get</code> and is probably a bad idea.</p></li>\n<li><p>Use semi-automated scripts to maintain a git branch <code>pull-me</code> that is always exactly one commit ahead of <code>master</code> but has all the import paths and <code>go.mod</code> file fixed up for company.com.  This is what we currently do, but it's annoying because the scripts don't know how to parse go source code, so just blindly replace <code>example.org/devproject</code> with <code>company.com/project</code> everywhere, meaning there is no guarantee that just because <code>master</code> works <code>pull-me</code> will, too.  We somehow can't get <code>gomvpkg</code> working in a go module outside of a gopath (it will change package statements, but not the imports, which are the tricky part, and won't recurse into all the subpackages).</p></li>\n<li><p>Create a fake gopath, copy the master branch into it, use <code>gomvpkg</code> to move stuff, then copy the files back with a revised import path, then delete the fake gopath.  I can't 100% rule this out, but I gave up after <code>gomvpkg</code> just kept refusing to do the right thing and I got frustrated that something so conceptually simple was so difficult to make work in practice.</p></li>\n</ul>\n\n<p>Are there any other solutions we should be considering?  Are there any tools like <code>govmpkg</code> that understand go modules and will rewrite import paths without also trying to move stuff around in a gopath?</p>\n\n<p>As is probably clear, the dynamics here are that example.org is much more motivated to get stuff upstreamed than company.com is to pull from us, so ideally most of the hoop jumping would happen on the example.org side, and there would maybe be a one-time simple non-intrusive request to company.com to do something to make this work.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 4637118, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rPsLr.jpg?s=128&g=1", "display_name": "Ceus", "link": "https://stackoverflow.com/users/4637118/ceus"}, "is_accepted": false, "score": 0, "last_activity_date": 1596428930, "last_edit_date": 1596428930, "creation_date": 1548635068, "answer_id": 54394187, "question_id": 54393340, "link": "https://stackoverflow.com/questions/54393340/golang-struct-default-value-using-bson/54394187#54394187", "title": "golang struct default value using bson", "body": "<p>I was able to find another post</p>\n<blockquote>\n<p>One possible idea is to write separate constructor function</p>\n</blockquote>\n<pre><code>// Something is the structure we work with\ntype Something struct {\n     Text string \n     DefaultText string \n} \n\n// NewSomething create new instance of Something\nfunc NewSomething(text string) Something {\n   something := Something{}\n   something.Text = text\n   something.DefaultText = &quot;default text&quot;\n   return something\n}\n</code></pre>\n<blockquote>\n<p>Force a method to get the struct (the constructor way).</p>\n<p>A good design is to make your type unexported, but provide an exported\nconstructor function like NewMyType() in which you can properly\ninitialize your struct / type. Also return an interface type and not a\nconcrete type, and the interface should contain everything others want\nto do with your value. And your concrete type must implement that\ninterface of course.</p>\n<p>This can be done by simply make the type itself unexported. You can\nexport the function NewSomething and even the fields Text and\nDefaultText, but just don't export the struct type something</p>\n<p>Another way to customize it for you own module is by using a <a href=\"https://web.archive.org/web/20160818125551/https://joneisen.tumblr.com/post/53695478114/golang-and-default-values\" rel=\"nofollow noreferrer\">Config\nstruct to set default values</a> (Option 5 in the link) Not a good way\nthough.</p>\n</blockquote>\n<p><a href=\"https://stackoverflow.com/a/37521991\">Original Post</a></p>\n"}, {"tags": [], "owner": {"reputation": 444, "user_id": 7918749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r9BIg.jpg?s=128&g=1", "display_name": "Black_Dreams", "link": "https://stackoverflow.com/users/7918749/black-dreams"}, "is_accepted": false, "score": 0, "last_activity_date": 1548657295, "creation_date": 1548657295, "answer_id": 54396645, "question_id": 54393340, "link": "https://stackoverflow.com/questions/54393340/golang-struct-default-value-using-bson/54396645#54396645", "title": "golang struct default value using bson", "body": "<pre><code>// Campaign represents a email campaign\ntype Campaign struct {\n    ID             bson.ObjectId   `json:\"id\" bson:\"_id\"`\n    CampaignName   string          `json:\"campaign_name\" bson:\"campaign_name\"`\n    FromName       []string        `json:\"from_name\" bson:\"from_name\"`\n    FromEmail      string          `json:\"from_email\" bson:\"from_email\"`\n    ReplyEmail     string          `json:\"reply_email\" bson:\"reply_email\"`\n    Subject        []string        `json:\"subject\" bson:\"subject\"`\n    BodyText       string          `json:\"body_text\" bson:\"body_text\"`\n    BodyHTML       string          `json:\"body_html\" bson:\"body_html\"`\n    SMTPList       bson.ObjectId `json:\"smtp_list\" bson:\"smtp_list\"`\n    EmailList      bson.ObjectId `json:\"email_list\" bson:\"email_list\"`\n    DateCreated    time.Time       `json:\"date_created\" bson:\"date_created\"`\n    DateUpdated    time.Time       `json:\"date_updated\" bson:\"date_updated\"`\n    DateSendFinish time.Time       `json:\"date_send_finish\" bson:\"date_send_finish\"`\n    OwnerID        bson.ObjectId   `json:\"owner_id\" bson:\"owner_id\"`\n    Opens          int             `json:\"opens\" bson:\"opens\"`\n    Clicks         int             `json:\"clicks\" bson:\"clicks\"`\n    Status         string          `json:\"status\" bson:\"status\"`\n}\n</code></pre>\n\n<p>Simply You can do like this</p>\n\n<pre><code>campaign.Status = \"draft\"\n</code></pre>\n\n<p>or maybe if you want sometype of condition</p>\n\n<pre><code>if true {\ncampaign.Status = \"draft\"\n} else {\ncampaign.Status = \"sent\"\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 10973226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b9d3ae42483e2ebff117e9264f6f9fe?s=128&d=identicon&r=PG&f=1", "display_name": "Valy", "link": "https://stackoverflow.com/users/10973226/valy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2450, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1596428930, "creation_date": 1548626976, "question_id": 54393340, "link": "https://stackoverflow.com/questions/54393340/golang-struct-default-value-using-bson", "title": "golang struct default value using bson", "body": "<p>I looking return default value for new struct, without value, this is my current struct :</p>\n\n<pre><code>// Campaign represents a email campaign\ntype Campaign struct {\n    ID             bson.ObjectId   `json:\"id\" bson:\"_id\"`\n    CampaignName   string          `json:\"campaign_name\" bson:\"campaign_name\"`\n    FromName       []string        `json:\"from_name\" bson:\"from_name\"`\n    FromEmail      string          `json:\"from_email\" bson:\"from_email\"`\n    ReplyEmail     string          `json:\"reply_email\" bson:\"reply_email\"`\n    Subject        []string        `json:\"subject\" bson:\"subject\"`\n    BodyText       string          `json:\"body_text\" bson:\"body_text\"`\n    BodyHTML       string          `json:\"body_html\" bson:\"body_html\"`\n    SMTPList       bson.ObjectId `json:\"smtp_list\" bson:\"smtp_list\"`\n    EmailList      bson.ObjectId `json:\"email_list\" bson:\"email_list\"`\n    DateCreated    time.Time       `json:\"date_created\" bson:\"date_created\"`\n    DateUpdated    time.Time       `json:\"date_updated\" bson:\"date_updated\"`\n    DateSendFinish time.Time       `json:\"date_send_finish\" bson:\"date_send_finish\"`\n    OwnerID        bson.ObjectId   `json:\"owner_id\" bson:\"owner_id\"`\n    Opens          int             `json:\"opens\" bson:\"opens\"`\n    Clicks         int             `json:\"clicks\" bson:\"clicks\"`\n    Status         string          `json:\"status\" bson:\"status\"`\n}\n</code></pre>\n\n<p>I want to return Status = \"draft\"\nHow i can do this ?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "is_accepted": true, "score": 5, "last_activity_date": 1548665698, "last_edit_date": 1548665698, "creation_date": 1548627054, "answer_id": 54393352, "question_id": 54392948, "link": "https://stackoverflow.com/questions/54392948/first-path-segment-in-url-cannot-contain-colon/54393352#54393352", "title": ": first path segment in URL cannot contain colon", "body": "<p>The problem here is that <code>Location</code> has whitespace prefix and suffix so string is not valid URL. Unfortunately, error message does not help to see that. </p>\n\n<p><strong>How to detect:</strong></p>\n\n<p>I typically use %q <code>fmt</code> helper that wraps string into parentheses: </p>\n\n<pre><code>fmt.Printf(\"%q\", Location) \n</code></pre>\n\n<p>Will be printed as \"\\nhttps://www.washingtonpost.com/news-sitemaps/politics.xml\\n\"</p>\n\n<p><strong>How to fix:</strong></p>\n\n<p>add this line before using Location in code:</p>\n\n<pre><code>Location = strings.TrimSpace(Location)\n</code></pre>\n"}], "owner": {"reputation": 465, "user_id": 10908624, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-p2CK2T6EA2E/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZ0eyA5GJd_mDTMTRsg4hB-iscplQ/mo/photo.jpg?sz=128", "display_name": "temporarya", "link": "https://stackoverflow.com/users/10908624/temporarya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8967, "favorite_count": 0, "accepted_answer_id": 54393352, "answer_count": 1, "score": 4, "last_activity_date": 1548665698, "creation_date": 1548623779, "question_id": 54392948, "link": "https://stackoverflow.com/questions/54392948/first-path-segment-in-url-cannot-contain-colon", "title": ": first path segment in URL cannot contain colon", "body": "<p>Here's my code ( part of it ) :</p>\n\n<pre><code>type SitemapIndex struct {\n    // Locations []Location `xml:\"sitemap\"`\n    Locations []string `xml:\"sitemap&gt;loc\"`\n}\n\n~~~ SNIP ~~~\nfunc main(){\n    var s SitemapIndex\n    resp, _ := http.Get(\"https://www.washingtonpost.com/news-sitemaps/index.xml\")\n    bytes, _ := ioutil.ReadAll(resp.Body)\n    xml.Unmarshal(bytes, &amp;s)\n    for _, Location := range s.Locations {\n        fmt.Printf(\"%s\\n\", Location)\n        resp, err := http.Get(Location)\n        if err != nil {\n            log.Fatal(err)\n        } else {\n            bytes, _ := ioutil.ReadAll(resp.Body)\n            xml.Unmarshal(bytes, &amp;n)\n            for idx := range n.Titles {\n                newsMap[n.Titles[idx]] = NewsMap{n.Keywords[idx], n.Locations[idx]}\n            }\n        }\n        for idx, data := range newsMap {\n            fmt.Println(\"\\n\\n\\n\", idx)\n            fmt.Println(\"\\n\", data.Keyword)\n            fmt.Println(\"\\n\", data.Location)\n        }\n    }\n</code></pre>\n\n<p>Now, when I run this code I get this output :</p>\n\n<pre><code>\nhttps://www.washingtonpost.com/news-sitemaps/politics.xml\n\n2019/01/28 02:37:13 parse \nhttps://www.washingtonpost.com/news-sitemaps/politics.xml\n: first path segment in URL cannot contain colon\nexit status 1\n</code></pre>\n\n<p>I read a few posts and did some experiment myself, like I made another file with the following code </p>\n\n<pre><code>package main\n\nimport (\"fmt\"\n    \"net/url\")\n\nfunc main(){\n    fmt.Println(url.Parse(\"https://www.washingtonpost.com/news-sitemaps/politics.xml\"))\n}\n</code></pre>\n\n<p>And it didn't throw any error, so I understand the error is not with the url .</p>\n\n<p>Now, I just started learning <strong>Go</strong> using sentdex's tutorials , a few hours ago and so don't have much idea as of now. Here's the <a href=\"https://youtu.be/2umnbZxdu-s?list=PLQVvvaa0QuDeF3hP0wQoSxpkqgRcgxMqX&amp;t=485\" rel=\"nofollow noreferrer\">video link</a></p>\n\n<p>Thanks and regards.\nTemporarya</p>\n"}, {"tags": ["postgresql", "go", "go-gorm"], "answers": [{"comments": [{"owner": {"reputation": 791, "user_id": 3529908, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/684156fa87f3a84dc9f899a476e07e20?s=128&d=identicon&r=PG&f=1", "display_name": "C0ol_Cod3r", "link": "https://stackoverflow.com/users/3529908/c0ol-cod3r"}, "edited": false, "score": 0, "creation_date": 1548620463, "post_id": 54392318, "comment_id": 95596728, "body": "Many thanks that works! - I am a little confused, I am still returning a pointer to the DB, right? So how does setting it in a var change the way the pooling is working?"}, {"owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "reply_to_user": {"reputation": 791, "user_id": 3529908, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/684156fa87f3a84dc9f899a476e07e20?s=128&d=identicon&r=PG&f=1", "display_name": "C0ol_Cod3r", "link": "https://stackoverflow.com/users/3529908/c0ol-cod3r"}, "edited": false, "score": 2, "creation_date": 1548624612, "post_id": 54392318, "comment_id": 95597799, "body": "you are still returning a pointer, but now you are returning a pointer that always points to the same connection, before each call would return a pointer to a new connection"}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 3, "last_activity_date": 1548619077, "creation_date": 1548619077, "answer_id": 54392318, "question_id": 54392298, "link": "https://stackoverflow.com/questions/54392298/gorm-with-postgres-too-many-client-issue/54392318#54392318", "title": "Gorm With Postgres Too Many Client Issue", "body": "<p>You need to just create the one connection, and return the same instance:</p>\n\n<pre><code>type Database struct {\n    T *Template\n}\n\nvar db *gorm.DB\n\nfunc init() {\n    var err error\n    db, err = gorm.Open(\"postgres\", \"host=localhost port=5010 user=postgres dbname=postgres password=password sslmode=disable\")\n\n    if err != nil {\n         panic(err)\n    }\n}\n\nfunc (admin *Database) DB() *gorm.DB {       \n    return db\n}\n</code></pre>\n"}], "owner": {"reputation": 791, "user_id": 3529908, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/684156fa87f3a84dc9f899a476e07e20?s=128&d=identicon&r=PG&f=1", "display_name": "C0ol_Cod3r", "link": "https://stackoverflow.com/users/3529908/c0ol-cod3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 983, "favorite_count": 0, "accepted_answer_id": 54392318, "answer_count": 1, "score": 1, "last_activity_date": 1548619077, "creation_date": 1548618941, "question_id": 54392298, "link": "https://stackoverflow.com/questions/54392298/gorm-with-postgres-too-many-client-issue", "title": "Gorm With Postgres Too Many Client Issue", "body": "<p>I have my database connection in my admin package setup like this,   </p>\n\n<p>Template File:</p>\n\n<pre><code>type Template struct{}\n\nfunc NewAdmin() *Template {\n   return &amp;Template{}\n}\n</code></pre>\n\n<p>Database File:</p>\n\n<pre><code>type Database struct {\n   T *Template\n}\n\nfunc (admin *Database) DB() *gorm.DB {\n    db, err := gorm.Open(\"postgres\", \"host=localhost port=5010 user=postgres dbname=postgres password=password sslmode=disable\")\n\n    if err != nil {\n       panic(err)\n    }\n\n    return db\n}\n</code></pre>\n\n<p>Now I using that connection in my controllers package, like so</p>\n\n<p>Controller Teamplate</p>\n\n<pre><code>type Template struct {\n  Connection *admin.Database\n}\n</code></pre>\n\n<p>Profile File: </p>\n\n<pre><code>type ProfilesController struct {\n  T *Template\n}\n\nfunc (c *ProfilesController) ProfileList(ec echo.Context) error {\n\n  profile := []models.Profile{}\n\n  c.T.Connection.DB().Find(&amp;profile)\n\n  if len(profile) &lt;= 0 {\n\n      reply := map[string]string{\"Message\": \"No Profiles Found\", \"Code\": \"204\"}\n\n      return ec.JSON(http.StatusBadRequest, reply)\n  }\n\n  return ec.JSON(http.StatusOK, profile)\n}\n</code></pre>\n\n<p>Now this was all working fine but I have now move on to building the frontend to this api. I am getting <code>pq: sorry, too many clients already</code> after about 96 or so requests. </p>\n\n<p>So I run it though postman and got the same result. This is what I have done to correct the issue,</p>\n\n<pre><code>db := *c.T.Connection.DB()\n\ndb.Find(&amp;profile)\n\ndefer db.Close()\n</code></pre>\n\n<p>Now that seems to work, I push over 500 requests though with postman and it worked fine. I am guest its the <code>db.Close()</code> that is helping there. </p>\n\n<p>But I have read that the connection is a pool, so should the orginal code not work without needed a close on the connection? I thought that idle connections were released by the system over it was done with them? I have also read that due to it being a pool its not good to use <code>db.Close()</code>.</p>\n\n<p>So I am a little confused? Is what I done to fix the connection issue good? or is there a better way?</p>\n\n<p>Many thanks.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1025, "user_id": 7253829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qe9lZ.jpg?s=128&g=1", "display_name": "waymobetta", "link": "https://stackoverflow.com/users/7253829/waymobetta"}, "edited": false, "score": 0, "creation_date": 1548618505, "post_id": 54392180, "comment_id": 95596236, "body": "It might be help to know the full command you are running to build the go program"}, {"owner": {"reputation": 1655, "user_id": 8682074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1739167192766622/picture?type=large", "display_name": "John Balvin Arias", "link": "https://stackoverflow.com/users/8682074/john-balvin-arias"}, "reply_to_user": {"reputation": 1025, "user_id": 7253829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qe9lZ.jpg?s=128&g=1", "display_name": "waymobetta", "link": "https://stackoverflow.com/users/7253829/waymobetta"}, "edited": false, "score": 0, "creation_date": 1548618579, "post_id": 54392180, "comment_id": 95596254, "body": "full command: go build"}, {"owner": {"reputation": 1025, "user_id": 7253829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qe9lZ.jpg?s=128&g=1", "display_name": "waymobetta", "link": "https://stackoverflow.com/users/7253829/waymobetta"}, "edited": false, "score": 0, "creation_date": 1548618718, "post_id": 54392180, "comment_id": 95596296, "body": "Are you able to simply run the program?"}, {"owner": {"reputation": 1655, "user_id": 8682074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1739167192766622/picture?type=large", "display_name": "John Balvin Arias", "link": "https://stackoverflow.com/users/8682074/john-balvin-arias"}, "reply_to_user": {"reputation": 1025, "user_id": 7253829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qe9lZ.jpg?s=128&g=1", "display_name": "waymobetta", "link": "https://stackoverflow.com/users/7253829/waymobetta"}, "edited": false, "score": 0, "creation_date": 1548618846, "post_id": 54392180, "comment_id": 95596320, "body": "It does not build it, it shows an error after go build"}, {"owner": {"reputation": 1025, "user_id": 7253829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qe9lZ.jpg?s=128&g=1", "display_name": "waymobetta", "link": "https://stackoverflow.com/users/7253829/waymobetta"}, "edited": false, "score": 0, "creation_date": 1548618906, "post_id": 54392180, "comment_id": 95596337, "body": "Have you tried simply running the program? <code>go run .</code> within the directory root"}, {"owner": {"reputation": 1655, "user_id": 8682074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1739167192766622/picture?type=large", "display_name": "John Balvin Arias", "link": "https://stackoverflow.com/users/8682074/john-balvin-arias"}, "reply_to_user": {"reputation": 1025, "user_id": 7253829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qe9lZ.jpg?s=128&g=1", "display_name": "waymobetta", "link": "https://stackoverflow.com/users/7253829/waymobetta"}, "edited": false, "score": 0, "creation_date": 1548619076, "post_id": 54392180, "comment_id": 95596380, "body": "I just tried with command: go run me/backend and it shows the same error, I tried wih: go run . too"}, {"owner": {"reputation": 1025, "user_id": 7253829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qe9lZ.jpg?s=128&g=1", "display_name": "waymobetta", "link": "https://stackoverflow.com/users/7253829/waymobetta"}, "reply_to_user": {"reputation": 1655, "user_id": 8682074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1739167192766622/picture?type=large", "display_name": "John Balvin Arias", "link": "https://stackoverflow.com/users/8682074/john-balvin-arias"}, "edited": false, "score": 0, "creation_date": 1548619305, "post_id": 54392180, "comment_id": 95596444, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/187396/discussion-between-waymobetta-and-john-balvin-arias\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1655, "user_id": 8682074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1739167192766622/picture?type=large", "display_name": "John Balvin Arias", "link": "https://stackoverflow.com/users/8682074/john-balvin-arias"}, "is_accepted": true, "score": 0, "last_activity_date": 1548621122, "creation_date": 1548621122, "answer_id": 54392590, "question_id": 54392180, "link": "https://stackoverflow.com/questions/54392180/go-build-error-go-tool-no-such-tool-link/54392590#54392590", "title": "go build error: go tool: no such tool \u201clink\u201d", "body": "<p>It turns out I downloaded go for 32 bits, but my machine is 64 bits, so I just download go for 64 bits and it worked</p>\n"}], "owner": {"reputation": 1655, "user_id": 8682074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1739167192766622/picture?type=large", "display_name": "John Balvin Arias", "link": "https://stackoverflow.com/users/8682074/john-balvin-arias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 325, "favorite_count": 0, "accepted_answer_id": 54392590, "answer_count": 1, "score": 0, "last_activity_date": 1548621122, "creation_date": 1548618170, "last_edit_date": 1548619129, "question_id": 54392180, "link": "https://stackoverflow.com/questions/54392180/go-build-error-go-tool-no-such-tool-link", "title": "go build error: go tool: no such tool \u201clink\u201d", "body": "<p>After command:</p>\n\n<pre><code>  go build\n</code></pre>\n\n<p>It shows an error:</p>\n\n<pre><code> go tool: no such tool \"link\"\n</code></pre>\n\n<p>Details:\nmy system is windows 10 ->  64 bits</p>\n\n<pre><code>go version: 1.11.5 \ngo env -&gt; \nset GOARCH=386\nset GOBIN=\nset GOCACHE=c:\\users\\john\\AppData\\Local\\go-build\nset GOEXE=.exe\nset GOFLAGS=\nset GOHOSTARCH=386\nset GOHOSTOS=windows\nset GOOS=windows\nset GOPATH=E:\\codigo\nset GOPROXY=\nset GORACE=\nset GOROOT=C:\\Go\nset GOTMPDIR=\nset GOTOOLDIR=C:\\Go\\pkg\\tool\\windows_386\nset GCCGO=gccgo\nset GO386=sse2\nset CC=gcc\nset CXX=g++\nset CGO_ENABLED=1\nset GOMOD=\nset CGO_CPFLAGS=-g -02\nset CGO_CPPFLAGS=\nset CGO_CXXFLAGS=-g -02\nset CGO_FFLAGS=-g -02\nset CGO_LDFLAGS=-g -02\nset PKG_CONFIG=pkg-config\nset GOGCCFLAGS=-m32 -mtherads -fno-caret-diagnotics -Qunused-arguments -fmsessage-length=0 -fdebug-prefix-map=C:\\USers\\john\\ApddData\\Local\\temp\\go-build126731998=/tmp/go-build -gno-record-gcc-switches\n</code></pre>\n\n<p>I' not pretty sure what could be happening because this is the first time it happends to me, I just change my operating system(before was windows 7) and updated to windows 10 with all the recently updates.After that I install go and when I try to build my code, it shows the error</p>\n"}, {"tags": ["go", "go-gin"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1548605404, "post_id": 54390031, "comment_id": 95592192, "body": "I assume GetHeader reads an HTTP header and not the body, and the payload looks like the http request&#39;s json body. HTTP headers and HTTP body are not one and the same part of an HTTP request. (<a href=\"https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Request_message\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/&hellip;</a>)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4307777"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1548605514, "post_id": 54390031, "comment_id": 95592239, "body": "I&#39;m not sure you understood what I mean @mkopriva. I updated the code with only what is not working"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1548605770, "post_id": 54390031, "comment_id": 95592315, "body": "Right you are, I misunderstood. However, you&#39;re still using the wrong method to read the HTTP body. <a href=\"https://godoc.org/github.com/gin-gonic/gin#Context.Param\" rel=\"nofollow noreferrer\">Param</a> is for reading path parameters."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4307777"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1548605828, "post_id": 54390031, "comment_id": 95592338, "body": "So which one is it? I&#39;ve tried basically all of them to see if any worked but none did"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1548605942, "post_id": 54390031, "comment_id": 95592378, "body": "Given the payload&#39;s syntax I assume you&#39;re sending json in the request&#39;s body, to read that use binding <a href=\"https://github.com/gin-gonic/gin#model-binding-and-validation\" rel=\"nofollow noreferrer\">github.com/gin-gonic/gin#model-binding-and-validation</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4307777"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1548606032, "post_id": 54390031, "comment_id": 95592401, "body": "So there&#39;s no way to just read the string without binding it to a structure? I don&#39;t want to create a new structure just for this, it seems unnecessary"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1548606324, "post_id": 54390031, "comment_id": 95592494, "body": "You can always get the <a href=\"https://godoc.org/github.com/gin-gonic/gin#Context.Request\" rel=\"nofollow noreferrer\">http.Request</a> and read its body however you like."}, {"owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "edited": false, "score": 0, "creation_date": 1548665592, "post_id": 54390031, "comment_id": 95607469, "body": "You can read request body and unmarshall it as map[string]interface{}. Then get values from it. But it requires type casts and gets ugly quite quickly with nested data. So, if you only need name parameter, it might be ok. But if you also  need the Authorization header, then binding will be simpler and cleaner. See raw string parsing example here: <a href=\"https://play.golang.org/p/KwIJ01d_Nlb\" rel=\"nofollow noreferrer\">play.golang.org/p/KwIJ01d_Nlb</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8442698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45bebde9ee1ca26c91a4fcc9500b0474?s=128&d=identicon&r=PG&f=1", "display_name": "yawei li", "link": "https://stackoverflow.com/users/8442698/yawei-li"}, "is_accepted": false, "score": 0, "last_activity_date": 1592484575, "last_edit_date": 1592484575, "creation_date": 1592465754, "answer_id": 62444738, "question_id": 54390031, "link": "https://stackoverflow.com/questions/54390031/how-to-read-variables-from-post-payload-in-gin-gonic/62444738#62444738", "title": "How to read variables from POST payload in gin gonic?", "body": "\n\n<pre><code>data, _ := ioutil.ReadAll(c.Request.Body)\nfmt.Printf(\"ctx.Request.body: %v\", string(data))\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4307777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1471, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1592484575, "creation_date": 1548604688, "last_edit_date": 1548605502, "question_id": 54390031, "link": "https://stackoverflow.com/questions/54390031/how-to-read-variables-from-post-payload-in-gin-gonic", "title": "How to read variables from POST payload in gin gonic?", "body": "<p>On Chrome's Network tab the request payload looks like the following:</p>\n\n<pre><code>{\"req\":{\"headers\":{\"headers\":{\"Authorization\":\"Bearer **************\"}}},\"name\":\"john\"}\n</code></pre>\n\n<p>I removed the bearer authorization.</p>\n\n<pre><code>func name(c *gin.Context) {    \n    name := c.Param(\"name\")\n    fmt.Println(\"name\", name)\n}\n</code></pre>\n\n<p>I'm most definitly doing something wrong but I've searched and couldn't find the solution.\nHow do I retrieve something from there? If I use the rawData function I can see that the server got the response but I don't know how to actually put it in a variable that I can use</p>\n"}, {"tags": ["algorithm", "go", "optimization", "review"], "comments": [{"owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "edited": false, "score": 1, "creation_date": 1548601308, "post_id": 54389477, "comment_id": 95590883, "body": "What does &quot;count max words&quot; mean?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548604225, "post_id": 54389477, "comment_id": 95591792, "body": "What is the regex <code>&quot;[.||?||!]&quot;</code>? It looks like you just wanted <code>[.?!]</code>"}, {"owner": {"reputation": 11, "user_id": 4219594, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Gz7_8ZadJio/AAAAAAAAAAI/AAAAAAAADkI/lST1L4XLa20/photo.jpg?sz=128", "display_name": "ljubon", "link": "https://stackoverflow.com/users/4219594/ljubon"}, "reply_to_user": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "edited": false, "score": 0, "creation_date": 1548628530, "post_id": 54389477, "comment_id": 95598723, "body": "@EliBendersky - task is to count words sentence, it should return the highest number of words in one sentance. Input is string with N sentances ending with . or ? or !"}, {"owner": {"reputation": 11, "user_id": 4219594, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Gz7_8ZadJio/AAAAAAAAAAI/AAAAAAAADkI/lST1L4XLa20/photo.jpg?sz=128", "display_name": "ljubon", "link": "https://stackoverflow.com/users/4219594/ljubon"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548628598, "post_id": 54389477, "comment_id": 95598738, "body": "@JimB i found that in other similar task, basically translation is to match:  ! OR ? OR ."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548692886, "post_id": 54389477, "comment_id": 95623285, "body": "The OR operator is just <code>|</code>, but that&#39;s a character class which itself is a logical OR, so you don&#39;t need it"}], "answers": [{"comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1548698220, "post_id": 54391615, "comment_id": 95626257, "body": "Does not compile and has bugs."}], "tags": [], "owner": {"reputation": 446, "user_id": 2428640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97cdaaaa61e5541b98a01bbdfbdcff09?s=128&d=identicon&r=PG", "display_name": "Pascal de Kloe", "link": "https://stackoverflow.com/users/2428640/pascal-de-kloe"}, "is_accepted": false, "score": -1, "last_activity_date": 1548614506, "creation_date": 1548614506, "answer_id": 54391615, "question_id": 54389477, "link": "https://stackoverflow.com/questions/54389477/count-max-words-in-sentence-from-given-string-in-go/54391615#54391615", "title": "Count max words in sentence from given string in Go", "body": "<pre><code>func MaxWordsInSentences(s string) (result int) {\n    var offset, wordCount int\n    for i, r := range s {\n        switch r {\n        default:\n            if unicode.IsSpace(r) {\n                wordCount++\n            }\n\n        case '.', '?', '!':\n            if wordCount &gt; result {\n                result = wordCount\n            }\n\n            wordCount = 1\n        }\n    }\n\n    return\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 4219594, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Gz7_8ZadJio/AAAAAAAAAAI/AAAAAAAADkI/lST1L4XLa20/photo.jpg?sz=128", "display_name": "ljubon", "link": "https://stackoverflow.com/users/4219594/ljubon"}, "edited": false, "score": 0, "creation_date": 1548682350, "post_id": 54394105, "comment_id": 95616638, "body": "thnks for clarification! As i said, i&#39;m new in go and programming at all....so i wasn&#39;t thinking about unicode and solving in this way. Once again, thank you for sharing this with me..."}, {"owner": {"reputation": 446, "user_id": 2428640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97cdaaaa61e5541b98a01bbdfbdcff09?s=128&d=identicon&r=PG", "display_name": "Pascal de Kloe", "link": "https://stackoverflow.com/users/2428640/pascal-de-kloe"}, "edited": false, "score": 0, "creation_date": 1548691828, "post_id": 54394105, "comment_id": 95622585, "body": "&quot;Considder my simple algorithm&quot; which is actually <i>my</i> algorithm posted earlier. I guess you took the effort to downvote as well? LOL"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 446, "user_id": 2428640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97cdaaaa61e5541b98a01bbdfbdcff09?s=128&d=identicon&r=PG", "display_name": "Pascal de Kloe", "link": "https://stackoverflow.com/users/2428640/pascal-de-kloe"}, "edited": false, "score": 0, "creation_date": 1548692304, "post_id": 54394105, "comment_id": 95622907, "body": "@PascaldeKloe:  Your algorithm does not even compile and it has bugs. My algorithm certainly did not come from you."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 2, "last_activity_date": 1548765764, "last_edit_date": 1548765764, "creation_date": 1548634098, "answer_id": 54394105, "question_id": 54389477, "link": "https://stackoverflow.com/questions/54389477/count-max-words-in-sentence-from-given-string-in-go/54394105#54394105", "title": "Count max words in sentence from given string in Go", "body": "<p>On the trivial test case you provided, your algorithm appears to work. Your algorithm doesn't work very well on real text.</p>\n\n<hr>\n\n<p>Consider my simple algorithm:</p>\n\n<pre><code>func maxSentenceWords(s string) int {\n    maxWords, nWords := 0, 0\n    inWord := false\n    for _, r := range s {\n        switch r {\n        case '.', '?', '!':\n            inWord = false\n            if maxWords &lt; nWords {\n                maxWords = nWords\n            }\n            nWords = 0\n        default:\n            if unicode.IsSpace(r) {\n                inWord = false\n            } else if inWord == false {\n                inWord = true\n                nWords++\n            }\n        }\n        if maxWords &lt; nWords {\n            maxWords = nWords\n        }\n    }\n    return maxWords\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/OD8jNW1hyAa\" rel=\"nofollow noreferrer\">https://play.golang.org/p/OD8jNW1hyAa</a></p>\n\n<p>It passes your simple test. A short benchmark (Lorem Ipsum) runs very quickly and a long benchmark (Shakespeare) runs quickly</p>\n\n<pre><code>$ go test words_test.go -run=PeterSO -v -bench=PeterSO -benchmem -timeout=5m\n=== RUN   TestPeterSO\n--- PASS: TestPeterSO (0.00s)\nBenchmarkPeterSOL-4    300000        4027 ns/op    0 B/op    0 allocs/op\nBenchmarkPeterSOS-4        20    54084832 ns/op    0 B/op    0 allocs/op\n$ \n</code></pre>\n\n<hr>\n\n<p>Consider your complex algorithm:</p>\n\n<pre><code>func MaxWordsInSentences(S string) (result int) {\n    r, _ := regexp.Compile(\"[.||?||!]\")\n    count := strings.Count(S, \".\") + strings.Count(S, \"!\") + strings.Count(S, \"?\") // Total sentaces\n\n    for i := 0; i &lt; count; i++ {\n        sentence := r.Split(S, count)[i]\n        splitSentence := strings.Split(sentence, \" \")\n\n        var R []string\n        for _, str := range splitSentence {\n            if str != \"\" {\n                R = append(R, str)\n            }\n        }\n\n        if len(R) &gt; result {\n            result = len(R)\n        }\n    }\n\n    return\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/MCj-XxEid73\" rel=\"nofollow noreferrer\">https://play.golang.org/p/MCj-XxEid73</a></p>\n\n<p>It passes your simple test. A short benchmark (Lorem Ipsum) runs slowly and a long benchmark (Shakespeare) runs a very long time (killed after 5 minutes).</p>\n\n<pre><code>$ go test words_test.go -run=Ljubon -v -bench=Ljubon -benchmem -timeout=5m\n=== RUN   TestLjubon\n--- PASS: TestLjubon (0.00s)\nBenchmarkLjubonL-4    20000    78623 ns/op    6984 B/op   62 allocs/op\n*** Test killed with quit: ran too long (6m0s).\n$ \n</code></pre>\n\n<hr>\n\n<p><code>test words_test.go</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"regexp\"\n    \"strings\"\n    \"testing\"\n    \"unicode\"\n)\n\nvar sentences = \"One two three four five six seven eight. One two? One two three four five six seven eight nine? One two three! One two three four.\"\n\nvar loremipsum = `\nLorem ipsum dolor sit amet, consectetur adipiscing elit, \nsed do eiusmod tempor incididunt ut labore et dolore magna aliqua. \nUt enim ad minim veniam, \nquis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. \nDuis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. \nExcepteur sint occaecat cupidatat non proident, \nsunt in culpa qui officia deserunt mollit anim id est laborum.\n`\n\nvar shakespeare = func() string {\n    // The Complete Works of William Shakespeare by William Shakespeare\n    // http://www.gutenberg.org/files/100/100-0.txt\n    data, err := ioutil.ReadFile(`/home/peter/shakespeare.100-0.txt`)\n    if err != nil {\n        panic(err)\n    }\n    return string(data)\n}()\n\nfunc maxSentenceWords(s string) int {\n    maxWords, nWords := 0, 0\n    inWord := false\n    for _, r := range s {\n        switch r {\n        case '.', '?', '!':\n            inWord = false\n            if maxWords &lt; nWords {\n                maxWords = nWords\n            }\n            nWords = 0\n        default:\n            if unicode.IsSpace(r) {\n                inWord = false\n            } else if inWord == false {\n                inWord = true\n                nWords++\n            }\n        }\n        if maxWords &lt; nWords {\n            maxWords = nWords\n        }\n    }\n    return maxWords\n}\n\nfunc TestPeterSO(t *testing.T) {\n    want := 9\n    got := maxSentenceWords(sentences)\n    if got != want {\n        t.Errorf(\"want %d; got %d\", want, got)\n    }\n}\n\nfunc BenchmarkPeterSOL(b *testing.B) {\n    for N := 0; N &lt; b.N; N++ {\n        maxSentenceWords(loremipsum)\n    }\n}\n\nfunc BenchmarkPeterSOS(b *testing.B) {\n    for N := 0; N &lt; b.N; N++ {\n        maxSentenceWords(shakespeare)\n    }\n}\n\n// MaxWordsInSentences - return max words in one sentences\nfunc MaxWordsInSentences(S string) (result int) {\n    r, _ := regexp.Compile(\"[.||?||!]\")\n    count := strings.Count(S, \".\") + strings.Count(S, \"!\") + strings.Count(S, \"?\") // Total sentaces\n\n    for i := 0; i &lt; count; i++ {\n        sentence := r.Split(S, count)[i]\n        splitSentence := strings.Split(sentence, \" \")\n\n        var R []string\n        for _, str := range splitSentence {\n            if str != \"\" {\n                R = append(R, str)\n            }\n        }\n\n        if len(R) &gt; result {\n            result = len(R)\n        }\n    }\n\n    return\n}\n\nfunc TestLjubon(t *testing.T) {\n    want := 9\n    got := MaxWordsInSentences(sentences)\n    if got != want {\n        t.Errorf(\"want %d; got %d\", want, got)\n    }\n}\n\nfunc BenchmarkLjubonL(b *testing.B) {\n    for N := 0; N &lt; b.N; N++ {\n        MaxWordsInSentences(loremipsum)\n    }\n}\n\nfunc BenchmarkLjubonS(b *testing.B) {\n    for N := 0; N &lt; b.N; N++ {\n        MaxWordsInSentences(shakespeare)\n    }\n}\n\nfunc main() {\n    s := \"One two three four five six seven eight. One two? One two three four five six seven eight nine? One two three! One two three four.\"\n    max := maxSentenceWords(s) // 9\n    fmt.Println(max)\n    s = \"One two three! One two three four\"\n    max = maxSentenceWords(s) // 4\n    fmt.Println(max)\n    s = loremipsum\n    max = maxSentenceWords(s)\n    fmt.Println(max)\n}\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>I call it the law of the instrument, and it may be formulated as\n  follows: Give a small boy a hammer, and he will find that everything\n  he encounters needs pounding. </p>\n  \n  <p>Abraham Kaplan, The Conduct of Inquiry: Methodology for Behavioral\n  Science, 1964, page 28.</p>\n</blockquote>\n\n<hr>\n\n<p>Is the Go <code>regexp</code> package your hammer to pound any and all text?</p>\n"}], "owner": {"reputation": 11, "user_id": 4219594, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Gz7_8ZadJio/AAAAAAAAAAI/AAAAAAAADkI/lST1L4XLa20/photo.jpg?sz=128", "display_name": "ljubon", "link": "https://stackoverflow.com/users/4219594/ljubon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 593, "favorite_count": 1, "accepted_answer_id": 54394105, "answer_count": 2, "score": 0, "last_activity_date": 1548765764, "creation_date": 1548601039, "last_edit_date": 1548601558, "question_id": 54389477, "link": "https://stackoverflow.com/questions/54389477/count-max-words-in-sentence-from-given-string-in-go", "title": "Count max words in sentence from given string in Go", "body": "<p>i'm new in Go... and i'm looking for new ways to optimize and/or fix this algorithm to count max words in sentence from given string. Sentence is ending with '?' or '!' or '.' and function should return int >= 0.</p>\n\n<pre><code>// MaxWordsInSentences - return max words in one sentences\nfunc MaxWordsInSentences(S string) (result int) {\n\n\n    r, _ := regexp.Compile(\"[.||?||!]\")\n    count := strings.Count(S, \".\") + strings.Count(S, \"!\") + strings.Count(S, \"?\") // Total sentaces\n\n    for i := 0; i &lt; count; i++ {\n        sentence := r.Split(S, count)[i]\n        splitSentence := strings.Split(sentence, \" \")\n\n        var R []string\n        for _, str := range splitSentence {\n            if str != \"\" {\n                R = append(R, str)\n            }\n        }\n\n        if len(R) &gt; result {\n            result = len(R)\n        }\n    }\n\n    return\n\n}\n</code></pre>\n\n<p>Example</p>\n\n<p>Sentence => <code>\"One two three four five six seven eight. One two? One two three four five six seven eight nine? One two three! One two three four.\"</code></p>\n\n<p>Should return 9 as result</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 12512, "user_id": 679824, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ofTpa.jpg?s=128&g=1", "display_name": "Krishnan Mahadevan", "link": "https://stackoverflow.com/users/679824/krishnan-mahadevan"}, "edited": false, "score": 2, "creation_date": 1548595824, "post_id": 54388466, "comment_id": 95589251, "body": "thanks for helping out with this question. That solved the problem. Just to add a bit more context, in case anyone is facing this issue when running from within an IDE such as GoLang IDE, one needs to edit configuration and choose <code>Run kind</code> as <code>Package</code>."}, {"owner": {"reputation": 1240, "user_id": 6648326, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/zaG25.jpg?s=128&g=1", "display_name": "MasterJoe", "link": "https://stackoverflow.com/users/6648326/masterjoe"}, "reply_to_user": {"reputation": 12512, "user_id": 679824, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ofTpa.jpg?s=128&g=1", "display_name": "Krishnan Mahadevan", "link": "https://stackoverflow.com/users/679824/krishnan-mahadevan"}, "edited": false, "score": 0, "creation_date": 1581561660, "post_id": 54388466, "comment_id": 106479295, "body": "@KrishnanMahadevan - unrelated comment. could you please help me in this testng question ? <a href=\"https://stackoverflow.com/questions/60196503/how-to-debug-testng-tests-which-use-dataproviders\" title=\"how to debug testng tests which use dataproviders\">stackoverflow.com/questions/60196503/&hellip;</a> thank you."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 6, "last_activity_date": 1548595667, "last_edit_date": 1548595667, "creation_date": 1548594616, "answer_id": 54388466, "question_id": 54388407, "link": "https://stackoverflow.com/questions/54388407/command-line-arguments-handling-undefined-error-message/54388466#54388466", "title": "command-line-arguments : handling &quot;undefined&quot; error message", "body": "<p>To understand why, read the <code>go</code> command documentation:</p>\n\n<blockquote>\n  <p><a href=\"https://golang.org/cmd/go/\" rel=\"noreferrer\">Command go</a></p>\n  \n  <p><a href=\"https://golang.org/cmd/go/#hdr-Compile_and_run_Go_program\" rel=\"noreferrer\">Compile and run Go program</a></p>\n  \n  <p>Usage:</p>\n\n<pre><code>go run [build flags] [-exec xprog] package [arguments...]\n</code></pre>\n  \n  <p>Run compiles and runs the named main Go package. Typically the package\n  is specified as a list of .go source files, but it may also be an\n  import path, file system path, or pattern matching a single known\n  package, as in 'go run .' or 'go run my/cmd'.</p>\n  \n  <p><a href=\"https://golang.org/cmd/go/#hdr-Compile_packages_and_dependencies\" rel=\"noreferrer\">Compile packages and dependencies</a></p>\n  \n  <p>Usage:</p>\n\n<pre><code>go build [-o output] [-i] [build flags] [packages]\n</code></pre>\n  \n  <p>Build compiles the packages named by the import paths, along with\n  their dependencies, but it does not install the results.</p>\n  \n  <p>If the arguments to build are a list of .go files, build treats them\n  as a list of source files specifying a single package. </p>\n  \n  <p>For more about specifying packages, see 'go help packages'. For more\n  about where packages and binaries are installed, run 'go help gopath'.</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p><code>go run</code>: Typically the package is specified as a list of .go source files.</p>\n</blockquote>\n\n<p>For your <code>go run</code> example, list the files:</p>\n\n<pre><code>go run sample_main.go sample_one.go\n</code></pre>\n"}], "owner": {"reputation": 12512, "user_id": 679824, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ofTpa.jpg?s=128&g=1", "display_name": "Krishnan Mahadevan", "link": "https://stackoverflow.com/users/679824/krishnan-mahadevan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2783, "favorite_count": 1, "accepted_answer_id": 54388466, "answer_count": 1, "score": 5, "last_activity_date": 1584651803, "creation_date": 1548594208, "last_edit_date": 1584651803, "question_id": 54388407, "link": "https://stackoverflow.com/questions/54388407/command-line-arguments-handling-undefined-error-message", "title": "command-line-arguments : handling &quot;undefined&quot; error message", "body": "<p>Following is how the source files are organized</p>\n\n<pre><code>\u2718-1 ~/Go/src/github.com/krmahadevan/packages \n18:24 $ tree .\n.\n\u251c\u2500\u2500 sample_main.go\n\u2514\u2500\u2500 sample_one.go\n\n0 directories, 2 files\n</code></pre>\n\n<p>Here's how the source code looks like:</p>\n\n<p><strong>sample_one.go</strong></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nvar data map[string]string\n\nfunc init() {\n    data = make(map[string]string, 0)\n}\n</code></pre>\n\n<p><strong>sample_main.go</strong></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    data[\"foo\"] = \"bar\"\n    fmt.Println(data)\n}\n</code></pre>\n\n<p>Now when I attempt at running <strong>sample_main.go</strong> I get errors stating that <code>data</code> is undefined.</p>\n\n<pre><code>18:24 $ go run sample_main.go \n# command-line-arguments\n./sample_main.go:6:2: undefined: data\n./sample_main.go:7:14: undefined: data\n\u2718-2 ~/Go/src/github.com/krmahadevan/packages\n</code></pre>\n\n<p>But when I build the code into a binary and then execute it, it runs fine.</p>\n\n<pre><code>\u2714 ~/Go/src/github.com/krmahadevan/packages \n18:27 $ go build\n\u2714 ~/Go/src/github.com/krmahadevan/packages \n18:28 $ ./packages \nmap[foo:bar]\n\u2714 ~/Go/src/github.com/krmahadevan/packages\n</code></pre>\n\n<p>I would like to understand why is this behavior ?</p>\n\n<p>Environment:</p>\n\n<pre><code>18:31 $ go version\ngo version go1.11.4 darwin/amd64\n</code></pre>\n\n<p>The closest I found was this post : <a href=\"https://stackoverflow.com/questions/46381817/golang-command-line-arguments-undefined-variable\">Golang : command-line-arguments undefined: variable</a> </p>\n\n<p>But this post talks about scoped variables that are defined in <code>main</code>.</p>\n\n<p>But my problem statement involves variables defined in another go file and accessed in the <code>main</code> method.</p>\n"}, {"tags": ["c", "linux", "go", "raspberry-pi", "ioctl"], "comments": [{"owner": {"reputation": 8522, "user_id": 851737, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f981b37f5120cd32282071b4e9de12bb?s=128&d=identicon&r=PG", "display_name": "schlamar", "link": "https://stackoverflow.com/users/851737/schlamar"}, "edited": false, "score": 0, "creation_date": 1554819538, "post_id": 54388088, "comment_id": 97886590, "body": "Here is an IOCTL go example: <a href=\"https://github.com/stapelberg/hmgo/blob/master/internal/gpio/reset.go\" rel=\"nofollow noreferrer\">github.com/stapelberg/hmgo/blob/master/internal/gpio/reset.g&zwnj;&#8203;o</a>"}], "answers": [{"comments": [{"owner": {"reputation": 8522, "user_id": 851737, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f981b37f5120cd32282071b4e9de12bb?s=128&d=identicon&r=PG", "display_name": "schlamar", "link": "https://stackoverflow.com/users/851737/schlamar"}, "edited": false, "score": 0, "creation_date": 1554819523, "post_id": 54388379, "comment_id": 97886584, "body": "The <code>unsafe.Pointer</code> is exactly the solution for the problem you are describing?!"}], "tags": [], "owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "is_accepted": true, "score": 6, "last_activity_date": 1548594020, "creation_date": 1548594020, "answer_id": 54388379, "question_id": 54388088, "link": "https://stackoverflow.com/questions/54388088/how-to-ioctl-properly-from-golang/54388379#54388379", "title": "How to IOCTL properly from golang", "body": "<p>There are <strong>ioctl</strong>(2) wrappers in <a href=\"https://godoc.org/golang.org/x/sys/unix\" rel=\"noreferrer\"><code>\"golang.org/x/sys/unix\"</code></a>.  <a href=\"https://godoc.org/golang.org/x/sys/unix#IoctlSetInt\" rel=\"noreferrer\"><code>unix.IoctlSetInt</code></a> mechanically might meet your needs.</p>\n\n<p>It also looks like you're handing control over a small memory buffer to the kernel.  You need to be careful doing this: the Go garbage collector free memory objects that it doesn't think are in use, and even if something is in use, it can move it around.  The kernel won't know about this and will keep using the old pointer.  The <a href=\"https://golang.org/pkg/unsafe/#Pointer\" rel=\"noreferrer\"><code>unsafe.Pointer</code></a> documentation has a fair amount to say on this topic, even with regards to less exotic syscalls.  I'm not aware of anything that can \"lock\" a Go object in memory that would keep it from being moved or deallocated (nothing jumps out in the <code>runtime</code> package, for instance).</p>\n\n<p>You might consider writing a very small extension using <a href=\"https://golang.org/cmd/cgo/\" rel=\"noreferrer\">cgo</a> that <code>malloc()</code>ed an appropriate buffer and handed it off to the ioctl.  malloc'd memory isn't garbage-collected so it won't move or be freed from under you; some low-level tools might think this looks like a memory leak (it wouldn't be a bad idea to keep the old value of the pointer around to be able to free it later and dodge this).</p>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 11542197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0202df94370ef9d76e67b7f34e19d71c?s=128&d=identicon&r=PG&f=1", "display_name": "hartzell", "link": "https://stackoverflow.com/users/11542197/hartzell"}, "is_accepted": false, "score": 3, "last_activity_date": 1567188711, "last_edit_date": 1567188711, "creation_date": 1567188006, "answer_id": 57731350, "question_id": 54388088, "link": "https://stackoverflow.com/questions/54388088/how-to-ioctl-properly-from-golang/57731350#57731350", "title": "How to IOCTL properly from golang", "body": "<p>You might also be falling afoul of the detail that the <code>uintpr(unsafe.Pointer(...))</code> needs to happen <em>in the call</em> to <code>syscall.Syscall</code>.</p>\n\n<p>Here are the details, from <a href=\"https://golang.org/pkg/unsafe/#Pointer\" rel=\"nofollow noreferrer\">https://golang.org/pkg/unsafe/#Pointer</a></p>\n\n<blockquote>\n  <p>(4) Conversion of a Pointer to a uintptr when calling syscall.Syscall.</p>\n  \n  <p>The Syscall functions in package syscall pass their uintptr arguments directly to the operating system, which then may, depending on the details of the call, reinterpret some of them as pointers. That is, the system call implementation is implicitly converting certain arguments back from uintptr to pointer.</p>\n  \n  <p>If a pointer argument must be converted to uintptr for use as an argument, that conversion must appear in the call expression itself:</p>\n  \n  <pre class=\"lang-golang prettyprint-override\"><code>syscall.Syscall(SYS_READ, uintptr(fd), uintptr(unsafe.Pointer(p)), uintptr(n))\n</code></pre>\n  \n  <p>The compiler handles a Pointer converted to a uintptr in the argument list of a call to a function implemented in assembly by arranging that the referenced allocated object, if any, is retained and not moved until the call completes, even though from the types alone it would appear that the object is no longer needed during the call.</p>\n  \n  <p>For the compiler to recognize this pattern, the conversion must appear in the argument list:</p>\n  \n  <pre class=\"lang-golang prettyprint-override\"><code>// INVALID: uintptr cannot be stored in variable\n// before implicit conversion back to Pointer during system call.\nu := uintptr(unsafe.Pointer(p))\nsyscall.Syscall(SYS_READ, uintptr(fd), u, uintptr(n))\n</code></pre>\n</blockquote>\n\n<p>This use of <code>unsafe</code> is the trick that will let you \"lock\" the Go object that Dave Maze was looking for above.</p>\n"}], "owner": {"reputation": 587, "user_id": 2725838, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Nb6RH.jpg?s=128&g=1", "display_name": "Sigma", "link": "https://stackoverflow.com/users/2725838/sigma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3466, "favorite_count": 0, "accepted_answer_id": 54388379, "answer_count": 2, "score": 2, "last_activity_date": 1567188711, "creation_date": 1548591887, "question_id": 54388088, "link": "https://stackoverflow.com/questions/54388088/how-to-ioctl-properly-from-golang", "title": "How to IOCTL properly from golang", "body": "<p>I am trying to port bit of <a href=\"https://github.com/raspberrypi/userland/blob/master/host_applications/linux/apps/vcmailbox/vcmailbox.c\" rel=\"nofollow noreferrer\">raspberrypi's userspace</a> code from C to golang and I've run into a program involving <code>ioctl()</code>. </p>\n\n<p>I am having trouble specifically with following C code</p>\n\n<pre><code>#define MAJOR_NUM 100\n#define IOCTL_MBOX_PROPERTY _IOWR(MAJOR_NUM, 0, char *)\nstatic int mbox_property(int file_desc, void *buf){\n\n   int ret_val = ioctl(file_desc, IOCTL_MBOX_PROPERTY, buf);\n   return ret_val;\n}\n</code></pre>\n\n<p>and my go equivalent for this is</p>\n\n<pre><code>func mBoxProperty(f *os.File, buf [256]int64) {\n        err := Ioctl(f.Fd(), IOWR(100, 0, 8), uintptr(unsafe.Pointer(&amp;buf[0])))\n\n        if err != nil {\n                log.Fatalln(\"mBoxProperty() : \", err)\n        }\n\n}\n\nfunc Ioctl(fd, op, arg uintptr) error {\n        _, _, ep := syscall.Syscall(syscall.SYS_IOCTL, fd, op, arg)\n        if ep != 0 {\n                return syscall.Errno(ep)\n        }\n        return nil\n}\n\nfunc IOWR(t, nr, size uintptr) uintptr {\n        return IOC(IocRead|IocWrite, t, nr, size)\n}\nfunc IOC(dir, t, nr, size uintptr) uintptr {\n        return (dir &lt;&lt; IocDirshift) | (t &lt;&lt; IocTypeshift) | (nr &lt;&lt; IocNrshift) | (size &lt;&lt; IocSizeshift)\n}\n</code></pre>\n\n<p>but whenever I run this, I get <code>invalid argument</code> error, I think it might be due how I am calling the <code>IOCTL()</code> but I am not sure, how can I fix this?</p>\n"}, {"tags": ["go", "channel"], "answers": [{"comments": [{"owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "edited": false, "score": 0, "creation_date": 1548598204, "post_id": 54386847, "comment_id": 95589881, "body": "Can you explain for me behavior of first example ? I think in first example, when we write <code>case &lt;-time.After(1 * time.Second)</code>, it doesn&#39;t wait  for 2 seconds."}, {"owner": {"reputation": 996, "user_id": 4909445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ded7e867ff7001048e511974d4c19137?s=128&d=identicon&r=PG&f=1", "display_name": "Shettyh", "link": "https://stackoverflow.com/users/4909445/shettyh"}, "reply_to_user": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "edited": false, "score": 0, "creation_date": 1548598379, "post_id": 54386847, "comment_id": 95589930, "body": "@Tr\u1ea7nKimD\u1ef1 Yes select never waits when you have a <code>default</code> case. So it just checks for messages in all the cases if nothing is there it just executes default and exits. As in the first case, for timeout to happen it needs to wait for <code>2 secs</code> so it never gets executed"}, {"owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "edited": false, "score": 0, "creation_date": 1548599144, "post_id": 54386847, "comment_id": 95590167, "body": "Can you look at my second example (I just edited) that I copied from golang example. If <code>case &lt;-time.After(3 * time.Second)</code> will block for 3 seconds, why can it print &quot;result 2&quot; in that case ? Thanks."}, {"owner": {"reputation": 996, "user_id": 4909445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ded7e867ff7001048e511974d4c19137?s=128&d=identicon&r=PG&f=1", "display_name": "Shettyh", "link": "https://stackoverflow.com/users/4909445/shettyh"}, "reply_to_user": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "edited": false, "score": 0, "creation_date": 1548599478, "post_id": 54386847, "comment_id": 95590278, "body": "@Tr\u1ea7nKimD\u1ef1 whichever case got the signal first will be executed. If both cases got the signal at the same time then case will be executed pseudo-randomly, there is no order of execution. As <code>c2 &lt;- &quot;result 2&quot;</code> this will be done before timeout this case will get executed"}, {"owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "edited": false, "score": 0, "creation_date": 1548620049, "post_id": 54386847, "comment_id": 95596631, "body": "Thanks. I understood. Just one more question, so in a block with default, Golang doesn&#39;t allow to run &quot;waiting statement&quot; so Golang will bypass that statement. (so we must initialize outside) ?"}, {"owner": {"reputation": 996, "user_id": 4909445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ded7e867ff7001048e511974d4c19137?s=128&d=identicon&r=PG&f=1", "display_name": "Shettyh", "link": "https://stackoverflow.com/users/4909445/shettyh"}, "reply_to_user": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "edited": false, "score": 0, "creation_date": 1548637271, "post_id": 54386847, "comment_id": 95600323, "body": "Yes that&#39;s correct. With non-blocking select pattern you cant have explicit wait inside any case"}], "tags": [], "owner": {"reputation": 996, "user_id": 4909445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ded7e867ff7001048e511974d4c19137?s=128&d=identicon&r=PG&f=1", "display_name": "Shettyh", "link": "https://stackoverflow.com/users/4909445/shettyh"}, "is_accepted": true, "score": 3, "last_activity_date": 1548582535, "creation_date": 1548582535, "answer_id": 54386847, "question_id": 54386775, "link": "https://stackoverflow.com/questions/54386775/golang-channel-timeout-pattern-not-work-as-example/54386847#54386847", "title": "Golang channel: timeout pattern not work as example", "body": "<p>Basically the select statement wont wait if there is a default case, so in your case it just checks for <code>EventChannel</code> and goes to default case because it is not blocking and it wont wait for <code>2 seconds timeout</code>. In every iteration there is a <code>2 secs</code> timeout , so it never get executed.</p>\n\n<p>In the second case as the timer is outside the loop it wont reinitialize in each iteration so after <code>2 seconds</code> select statement will catch that signal and executes timeout.</p>\n\n<p>If you want to wait for <code>2 secs</code> in each iteration then you can do something like this</p>\n\n<pre><code>for {\n  select {\n  case ev := &lt;-c.EventChannel():\n      // do something here\n  default:\n      // do nothing as non-blocking channel pattern\n  }\n  time.Sleep(2 *time.Second)\n</code></pre>\n\n<p>}</p>\n"}], "owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "accepted_answer_id": 54386847, "answer_count": 1, "score": 0, "last_activity_date": 1548599085, "creation_date": 1548581797, "last_edit_date": 1548599085, "question_id": 54386775, "link": "https://stackoverflow.com/questions/54386775/golang-channel-timeout-pattern-not-work-as-example", "title": "Golang channel: timeout pattern not work as example", "body": "<p>I try to implement <a href=\"https://gobyexample.com/timeouts\" rel=\"nofollow noreferrer\">Timeout pattern</a> for my project. Here is an example code of above link:</p>\n\n<pre><code>c1 := make(chan string, 1)\ngo func() {\n    time.Sleep(2 * time.Second)\n    c1 &lt;- \"result 1\"\n}()\n\nselect {\ncase res := &lt;-c1:\n    fmt.Println(res)\ncase &lt;-time.After(1 * time.Second):\n    fmt.Println(\"timeout 1\")\n}\n</code></pre>\n\n<p>Another example is:</p>\n\n<pre><code>c2 := make(chan string, 1)\n    go func() {\n        time.Sleep(2 * time.Second)\n        c2 &lt;- \"result 2\"\n    }()\n    select {\n    case res := &lt;-c2:\n        fmt.Println(res)\n    case &lt;-time.After(3 * time.Second):\n        fmt.Println(\"timeout 2\")\n    }\n</code></pre>\n\n<p>I can run this example successfully. Then I try apply this to my project. Here is my project code:</p>\n\n<pre><code>for {\n    select {\n    case ev := &lt;-c.EventChannel():\n        // do something here\n    case &lt;-time.After(2 * time.Second):\n        // this condition never happend\n        return\n    default:\n       // do nothing as non-blocking channel pattern\n    }\n}\n</code></pre>\n\n<p>But I don't know why code never run into timeout case. When I move <code>time.After(2 * time.Second)</code> into separate statement, it works. Here is modified code:</p>\n\n<pre><code>timeout := time.After(2 * time.Second)\nfor {\n    select {\n    case ev := &lt;-c.EventChannel():\n        // do something here\n    case &lt;-timeout:\n        require.Equal(t, \"time out after 2s\", \"\")\n    default:\n        // do nothing as non-blocking channel pattern\n    }\n}\n</code></pre>\n\n<p>I don't know the differences between 2 cases. And why first example works. Please help me figure out.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "proxy", "reverse-proxy"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1548576846, "post_id": 54385164, "comment_id": 95584780, "body": "<a href=\"https://golang.org/pkg/net/http/#StripPrefix\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/#StripPrefix</a> Take a look at the example and replace the FileServers with your proxies. You can change the Host header by setting the <a href=\"https://golang.org/pkg/net/http/httputil/#ReverseProxy\" rel=\"nofollow noreferrer\">Director function</a> (set Request.Host to <code>&quot;target1&quot;</code> or <code>&quot;target2&quot;</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 1632, "user_id": 306819, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dd75cc276ca4b29e97f7dfcd6087faf0?s=128&d=identicon&r=PG", "display_name": "siddhusingh", "link": "https://stackoverflow.com/users/306819/siddhusingh"}, "edited": false, "score": 1, "creation_date": 1569692019, "post_id": 54433999, "comment_id": 102681632, "body": "can you show the code please, where multiple servers were proxied."}], "tags": [], "owner": {"reputation": 141, "user_id": 1377153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc2e421b9d281889f115fe429375430?s=128&d=identicon&r=PG", "display_name": "Chryses", "link": "https://stackoverflow.com/users/1377153/chryses"}, "is_accepted": true, "score": 2, "last_activity_date": 1548827121, "creation_date": 1548827121, "answer_id": 54433999, "question_id": 54385164, "link": "https://stackoverflow.com/questions/54385164/golang-reverse-proxy-multiple-target-urls-without-appending-subpaths/54433999#54433999", "title": "GoLang Reverse Proxy Multiple Target URLs Without Appending Subpaths", "body": "<p>I found that by providing a custom Director function instead of using the default one provided by NewSingleHostReverseProxy() (<a href=\"https://golang.org/src/net/http/httputil/reverseproxy.go\" rel=\"nofollow noreferrer\">https://golang.org/src/net/http/httputil/reverseproxy.go</a>) , I was able to implement the behavior I wanted. I did this by setting req.URL.Path to target.Path and not appending the original req.URL.Path. Other than that, the director function was very similar to that in reverseproxy.go.</p>\n"}], "owner": {"reputation": 141, "user_id": 1377153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc2e421b9d281889f115fe429375430?s=128&d=identicon&r=PG", "display_name": "Chryses", "link": "https://stackoverflow.com/users/1377153/chryses"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1295, "favorite_count": 0, "accepted_answer_id": 54433999, "answer_count": 1, "score": 1, "last_activity_date": 1548827121, "creation_date": 1548564538, "last_edit_date": 1548566054, "question_id": 54385164, "link": "https://stackoverflow.com/questions/54385164/golang-reverse-proxy-multiple-target-urls-without-appending-subpaths", "title": "GoLang Reverse Proxy Multiple Target URLs Without Appending Subpaths", "body": "<p>I am trying to write a reverse proxy in Golang using <code>net/httputil/ReverseProxy</code> that is able to forward requests to different target URLs without appending the proxy URL subpaths.</p>\n\n<p>For example: \nIf my proxy URL is PROXYURL, (not enough reputation to post more than 8 links, even fake example ones, so hence replacing link with PROXYURL),</p>\n\n<p>I would like <code>PROXYURL/app1</code> to forward requests to <code>TARGET1/directory</code> and I would like <code>PROXYURL/app2</code> to forward to <code>TARGET2/directory2</code></p>\n\n<p>Currently, I create the following ReverseProxy http handlers using <code>NewSingleHostReverseProxy()</code> and bind them to the desired subpaths (<code>/app1</code> and <code>/app2</code>).</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"net/http\"\n    \"net/http/httputil\"\n)\n\nfunc main() {\n    port := \"6666\"\n    proxy1 = httputil.NewSingleHostReverseProxy(\"http://target1.com/directory\")\n    proxy2 = httputil.NewSingleHostReverseProxy(\"http://target2.com/directory2\")\n\n    http.Handle(\"/app1\", proxy1)\n    http.Handle(\"/app2\", proxy2)\n    http.ListenAndServe(fmt.Sprintf(\":%s\", port), nil) \n}\n</code></pre>\n\n<p>However, whenever I run this and send a request to <code>PROXYURL/app1</code>, it proxies <code>TARGET1/directory/app1</code>. I understand that from the description of ReverseProxy, this is the intended behavior (appending the subpath of the proxy URL to the target). However, I was wondering if it is possible to map a proxy URL subpath (<code>/app1</code>) to another target URL without the subpath being appended to the target URL. </p>\n\n<p>In summary, I want </p>\n\n<p><a href=\"http://proxy.com/app1\" rel=\"nofollow noreferrer\">http://proxy.com/app1</a> -> <a href=\"http://target1.com/directory\" rel=\"nofollow noreferrer\">http://target1.com/directory</a></p>\n\n<p>and </p>\n\n<p><a href=\"http://proxy.com/app2\" rel=\"nofollow noreferrer\">http://proxy.com/app2</a> -> <a href=\"http://target2.com/directory2\" rel=\"nofollow noreferrer\">http://target2.com/directory2</a></p>\n\n<p>not (as is currently happening) </p>\n\n<p><a href=\"http://proxy.com/app1\" rel=\"nofollow noreferrer\">http://proxy.com/app1</a> -> <a href=\"http://target1.com/directory/app1\" rel=\"nofollow noreferrer\">http://target1.com/directory/app1</a></p>\n\n<p>and </p>\n\n<p><a href=\"http://proxy.com/app2\" rel=\"nofollow noreferrer\">http://proxy.com/app2</a> -> <a href=\"http://target2.com/directory2/app2\" rel=\"nofollow noreferrer\">http://target2.com/directory2/app2</a></p>\n"}, {"tags": ["ssl", "go", "ssl-certificate"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1548578565, "post_id": 54384128, "comment_id": 95585106, "body": "Both of these key types are a composite of multiple values. Two numbers (one of which is very big) for RSA, and an elliptical curve (which is itself defined by six or so numbers) and a point on that curve (two big numbers) for ECDSA. There is no natural hex representation for either of those. You have to turn the keys into byte slices first (<a href=\"https://golang.org/pkg/crypto/x509/#MarshalPKIXPublicKey\" rel=\"nofollow noreferrer\">x509.MarshalPKIXPublicKey</a>), which you can then hex encode, but that is unusual (PEM encoding is often used)."}, {"owner": {"reputation": 125, "user_id": 1306251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51a33e61874bf25461b46069cddbc359?s=128&d=identicon&r=PG", "display_name": "Sync", "link": "https://stackoverflow.com/users/1306251/sync"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1548580294, "post_id": 54384128, "comment_id": 95585433, "body": "I tried this too but the hex encode didn&#39;t match the one I could see inspecting the cert via the browser (for www.google.com). Would you mind providing a snippet for both the hex and pen conversion, starting from the Certificate.PublicKey structure?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1548611513, "post_id": 54384128, "comment_id": 95594035, "body": "You are probably looking at &quot;fingerprints&quot;, which are hashes of the whole certificate and signature, not just the public keys. See ramrunner&#39;s answer for how to compute them."}, {"owner": {"reputation": 125, "user_id": 1306251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51a33e61874bf25461b46069cddbc359?s=128&d=identicon&r=PG", "display_name": "Sync", "link": "https://stackoverflow.com/users/1306251/sync"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1548667300, "post_id": 54384128, "comment_id": 95608357, "body": "I&#39;d say I&#39;m actually interested in both. I&#39;d like to compare the fingerprints (I&#39;ll look at the answer ramrunner gave), but I&#39;d also like to print out the certificate. In my code I also tried using the MarshalPKIXPublicKey, but from there I&#39;m not sure how to print the public key in pem format."}], "answers": [{"comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1548577685, "post_id": 54384393, "comment_id": 95584919, "body": "The format string <code>&quot;% X&quot;</code> produces the format as asked in the question."}], "tags": [], "owner": {"reputation": 1267, "user_id": 1598790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a11ea12f06eefbb34068f4c1090e2e0b?s=128&d=identicon&r=PG", "display_name": "ramrunner", "link": "https://stackoverflow.com/users/1598790/ramrunner"}, "is_accepted": false, "score": 2, "last_activity_date": 1548596176, "last_edit_date": 1548596176, "creation_date": 1548553182, "answer_id": 54384393, "question_id": 54384128, "link": "https://stackoverflow.com/questions/54384128/how-to-show-the-public-key-for-a-website-certificate/54384393#54384393", "title": "How to show the public key for a website certificate", "body": "<p>it seems you are asking for the sha1 sum of the certificates involved.\nhere is a working example that asks for a host:port and prints the sums of the certificates involved</p>\n\n<pre><code>package main\n\nimport (\n        \"crypto/sha1\"\n        \"crypto/tls\"\n        \"fmt\"\n        \"log\"\n        \"os\"\n)\n\nfunc main() {\n        if len(os.Args) != 2 {\n                log.Panic(\"call with argument of host:port\")\n        }\n        log.SetFlags(log.Lshortfile)\n\n        conf := &amp;tls.Config{\n                //InsecureSkipVerify: true,\n        }\n        fmt.Printf(\"dialing:%s\\n\", os.Args[1])\n        conn, err := tls.Dial(\"tcp\", os.Args[1], conf)\n        if err != nil {\n                log.Println(err)\n                return\n        }\n        defer conn.Close()\n        for i, v := range conn.ConnectionState().PeerCertificates {\n                //edit: use %X for uppercase hex printing\n                fmt.Printf(\"cert %d sha1 fingerprint:%x \\n\", i, sha1.Sum(v.Raw))\n        }\n}\n</code></pre>\n\n<p>run as:</p>\n\n<pre><code>./golang-tls www.google.com:443\ndialing:www.google.com:443\ncert 0 sha1 fingerprint:34781c3be98cf958f514aecb1ae2e4e866effe34\ncert 1 sha1 fingerprint:eeacbd0cb452819577911e1e6203db262f84a318\n</code></pre>\n\n<p>for general notions on SSL i have found <a href=\"https://security.stackexchange.com/questions/20803/how-does-ssl-tls-work\">this stackexchange answer</a> to be extremely valuable.</p>\n"}], "owner": {"reputation": 125, "user_id": 1306251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51a33e61874bf25461b46069cddbc359?s=128&d=identicon&r=PG", "display_name": "Sync", "link": "https://stackoverflow.com/users/1306251/sync"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548601005, "creation_date": 1548549432, "last_edit_date": 1548601005, "question_id": 54384128, "link": "https://stackoverflow.com/questions/54384128/how-to-show-the-public-key-for-a-website-certificate", "title": "How to show the public key for a website certificate", "body": "<p>I've created a Go program to connect to a website and get the certificates it uses. I'm not sure how to get the correct representation of the public key.</p>\n\n<p>I can fetch the certificate and I can type check on Certificate.PublicKey. Once I understand it's rsa.PublicKey or ecdsa.PublicKey I'd need to print the hex representation of it.</p>\n\n<pre><code>switch cert.PublicKey.(type) {\ncase *rsa.PublicKey:\n    logrus.Error(\"this is RSA\")\n    // TODO: print hex representation of key\ncase *ecdsa.PublicKey:\n    logrus.Error(\"this is ECDSA\")\n    // TODO: print hex representation of key\ndefault:\n    fmt.Println(\"it's something else\")\n}\n</code></pre>\n\n<p>I'd expect it to print something like:</p>\n\n<pre><code>04 4B F9 47 1B A8 A8 CB A4 C6 C0 2D 45 DE 43 F3 BC F5 D2 98 F4 25 90 6F 13 0D 78 1A AC 05 B4 DF 7B F6 06 5C 80 97 9A 53 06 D0 DB 0E 15 AD 03 DE 14 09 D3 77 54 B1 4E 15 A8 AF E3 FD DC 9D AD E0 C5\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": true, "score": 1, "last_activity_date": 1548555791, "creation_date": 1548555791, "answer_id": 54384566, "question_id": 54384053, "link": "https://stackoverflow.com/questions/54384053/convert-type-string-to-type-bson-objectid/54384566#54384566", "title": "convert type *string to type bson.ObjectId", "body": "<p>According to the documentation, <code>bson.ObjectId</code> is defined as</p>\n\n<pre><code>type ObjectId string\n</code></pre>\n\n<p>Given that, you should be able to use</p>\n\n<pre><code>params.SmtpList = bson.ObjectId(*body.SmtpList)\n</code></pre>\n\n<p>That's a type conversion, which works because the underlying type of <code>ObjectId</code> is <code>string</code>.</p>\n\n<p>Note that you need to make sure that <code>body.SmtpList</code> isn't <code>nil</code> before doing this or your code will panic.</p>\n"}], "owner": {"reputation": 33, "user_id": 10973226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b9d3ae42483e2ebff117e9264f6f9fe?s=128&d=identicon&r=PG&f=1", "display_name": "Valy", "link": "https://stackoverflow.com/users/10973226/valy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 0, "accepted_answer_id": 54384566, "answer_count": 1, "score": 2, "last_activity_date": 1548555791, "creation_date": 1548548694, "question_id": 54384053, "link": "https://stackoverflow.com/questions/54384053/convert-type-string-to-type-bson-objectid", "title": "convert type *string to type bson.ObjectId", "body": "<p>i need to convert type string to bson.ObjectId,\nthis is my current code :</p>\n\n<pre><code>type CampaignUpdateBody struct {\n    CampaignName  *string    `json:\"campaign_name\" bson:\"campaign_name\"`\n    FromName     []string    `json:\"from_name\" bson:\"from_name\"`\n    FromEmail     *string    `json:\"from_email\" bson:\"from_email\"`\n    ReplyEmail    *string    `json:\"reply_email\" bson:\"reply_email\"`\n    Subject      []string    `json:\"subject\" bson:\"subject\"`\n    BodyText      *string    `json:\"body_text\" bson:\"body_text\"`\n    BodyHTML      *string    `json:\"body_html\" bson:\"body_html\"`\n    SmtpList      *string    `json:\"smtp_list_id\" bson:\"smtp_list\"`\n    EmailList     *string    `json:\"email_list_id\" bson:\"email_list\"`\n}\n\n// LetterTemplateUpdate updates some fields of the letter template.\nfunc (s *Service) CampaignUpdate(c *gin.Context) {\n    id := bson.ObjectIdHex(c.Param(\"id\"))\n    if !id.Valid() {\n        c.JSON(http.StatusBadRequest, gin.H{\"error\": \"id has wrong format\"})\n        return\n    }\n\n    var body CampaignUpdateBody\n    if err := c.BindJSON(&amp;body); err != nil {\n        c.JSON(http.StatusBadRequest, gin.H{\"error\": err.Error()})\n        return\n    }\n    token := c.MustGet(tokenKey).(*models.Token)\n\n    params := storage.CampaignUpdateParams{}\n    params.ID = id\n    //..........................\n    params.BodyText  = body.BodyText\n    params.BodyHTML  = body.BodyHTML\n    params.SmtpList  = body.SmtpList\n    params.EmailList = body.EmailList\n\n    stor := c.MustGet(storageKey).(storage.Storage)\n    if err := stor.CampaignUpdate(token.UserID, params); err != nil {\n        c.JSON(http.StatusInternalServerError, gin.H{\"error\": err.Error()})\n        return\n    }\n    c.JSON(http.StatusOK, gin.H{})\n}\n</code></pre>\n\n<p>and this is my current error : </p>\n\n<pre><code>..\\httpservice\\campaigns.go:134:19: cannot use body.SmtpList (type *string) as t\nype bson.ObjectId in assignment\n..\\httpservice\\campaigns.go:135:19: cannot use body.EmailList (type *string) as\ntype bson.ObjectId in assignment\n</code></pre>\n\n<p>i need convert body.SmtpList type as *string in bson.ObjectId , how i can do this ?</p>\n"}, {"tags": ["go", "google-cloud-firestore", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1548540317, "post_id": 54383208, "comment_id": 95579310, "body": "You need to <a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow noreferrer\">stringify it to json</a> and then send it to the <code>ResponseWriter</code>. (Or in a single step if you use the <a href=\"https://golang.org/pkg/encoding/json/#NewEncoder\" rel=\"nofollow noreferrer\"><code>Encoder</code></a>)"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1548540724, "post_id": 54383208, "comment_id": 95579407, "body": "You need to encode <code>tasks</code> to some data format and write that data to the response writer <code>w</code>.  What data format do you want to use?"}, {"owner": {"reputation": 21, "user_id": 10972938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b97c9b863f827fb65869558dcec91320?s=128&d=identicon&r=PG&f=1", "display_name": "M. Anderson", "link": "https://stackoverflow.com/users/10972938/m-anderson"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1548544639, "post_id": 54383208, "comment_id": 95580194, "body": "Thank you @tkausl and ThunderCat for your help, it is greatly appreciated! If only I knew all I had to do was encode... My issue would&#39;ve been resolved weeks ago, so thanks again!"}], "answers": [{"comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1548548447, "post_id": 54383688, "comment_id": 95580926, "body": "Killing the server because of an error fetching data from the datastore is not a good idea.  Log the error and return status 500."}], "tags": [], "owner": {"reputation": 21, "user_id": 10972938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b97c9b863f827fb65869558dcec91320?s=128&d=identicon&r=PG&f=1", "display_name": "M. Anderson", "link": "https://stackoverflow.com/users/10972938/m-anderson"}, "is_accepted": false, "score": 1, "last_activity_date": 1548544524, "creation_date": 1548544524, "answer_id": 54383688, "question_id": 54383208, "link": "https://stackoverflow.com/questions/54383208/passing-data-from-datastore-to-http-writer/54383688#54383688", "title": "Passing Data from Datastore to http.Writer", "body": "<p>I've removed the <code>return tasks, nil</code> as it appeared to be unnecessary, modified the <code>return, nil err</code> to <code>log.Fatalln(nil, err)</code> and also encoded <code>tasks</code> as instructed by @ThunderCat and @tkausl. My issue has been resolved, thank you.</p>\n\n<p>Here is my working code</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"context\"\n    \"net/http\"\n    \"encoding/json\"\n    \"cloud.google.com/go/datastore\"\n)\n\ntype Item struct {\n    Id      string  `datastore:\"id\"`\n    Name    string  `datastore:\"title\"`\n    View    int     `datastore:\"views\"`\n    Brand   string  `datastore:\"brand\"`\n    id  int64   // interger from \"Name/ID\" fild in datastore entities list\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", ListTasks)\n    http.ListenAndServe(\":8080\", nil)\n}\n\nfunc ListTasks(w http.ResponseWriter, r *http.Request) {\n\n    w.Header().Set(\"Content-Type\", \"application/json\")\n\n    ctx := context.Background()\n\n    client, err := datastore.NewClient(ctx, \"my-client\")\n    if err != nil {\n        log.Fatalln(err)\n    }\n\n    var tasks []*Item\n\n    query := datastore.NewQuery(\"my-query\")\n    keys, err := client.GetAll(ctx, query, &amp;tasks)\n    if err != nil {\n        log.Fatalln(nil, err)\n    }\n    for i, key := range keys {\n        tasks[i].id = key.ID\n    }\n\n    json.NewEncoder(w).Encode(tasks)\n//  return tasks, nil\n}\n</code></pre>\n\n<p>It now returns <code>[{\"Id\":\"24X660\",\"Name\":\"Fiesta\",\"View\":129,\"Brand\":\"Ford\"}]</code></p>\n\n<p>Also thank you to @static_cast for correcting my formatting errors.</p>\n"}], "owner": {"reputation": 21, "user_id": 10972938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b97c9b863f827fb65869558dcec91320?s=128&d=identicon&r=PG&f=1", "display_name": "M. Anderson", "link": "https://stackoverflow.com/users/10972938/m-anderson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1548544524, "creation_date": 1548540037, "last_edit_date": 1548542278, "question_id": 54383208, "link": "https://stackoverflow.com/questions/54383208/passing-data-from-datastore-to-http-writer", "title": "Passing Data from Datastore to http.Writer", "body": "<p>I was recently introduced to the wonders of the language known as <strong>go</strong>. I set myself a task of writing a RESTful API using GoLang and Google's Datastore. I am able to retrieve data from Datastore and Print it to the console using <code>fmt.Println</code> however the issue comes into play when I try to use the data from Datastore and pass it to the <strong>http.Handler</strong>.</p>\n\n<p>I was wondering if someone could inform me of where I am going wrong or even point me in the right direction. </p>\n\n<p>Here is what I have done so far</p>\n\n<pre><code> package main\n\n import (\n    \"log\"\n    \"fmt\"\n    \"context\"\n    \"net/http\"\n // \"encoding/json\"\n    \"cloud.google.com/go/datastore\"\n )\n\n type Item struct {\n      Id       string   `datastore:\"id\"`\n      Name     string   `datastore:\"title\"`\n      View     int      `datastore:\"views\"`\n      Brand    string   `datastore:\"brand\"`\n      id    int64   // interger from \"Name/ID\" fild in datastore entities list\n }\n\n func main() {\n     http.HandleFunc(\"/\", ListTasks)\n     http.ListenAndServe(\":8080\", nil)\n }\n\n //func ListTasks(w http.ResponseWriter, r *http.Request) ([]*Item, error)     {\nfunc ListTasks(w http.ResponseWriter, r *http.Request) {\n    ctx := context.Background()\n\n    client, err := datastore.NewClient(ctx, \"my-client\")\n    if err != nil {\n        log.Fatalln(err)\n    }\n\n    var tasks []*Item\n\n    query := datastore.NewQuery(\"my-query\")\n    keys, err := client.GetAll(ctx, query, &amp;tasks)\n    if err != nil {\n        return nil, err\n    }\n\n    for i, key := range keys {\n        tasks[i].id = key.ID\n    }\n\n    return tasks, nil\n}\n</code></pre>\n\n<p>I've also looked into http Wrappers, but I'm unaware if using a wrapper is 100% necessary or if I'm just adding more to my plate.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 8, "creation_date": 1548538431, "post_id": 54382978, "comment_id": 95578820, "body": "The functions run both before Println is called."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1548541664, "post_id": 54382978, "comment_id": 95579610, "body": "To clarify on tkausl&#39;s comment: when method is called, all arguments are evaluated, and only then call is made. Here this means calling both your <code>pow</code> funcs (and triggering their side-effects) and only <b>then</b> printing their results."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1548542694, "post_id": 54382978, "comment_id": 95579814, "body": "Evaluation order is specified <a href=\"https://golang.org/ref/spec#Order_of_evaluation\" rel=\"nofollow noreferrer\">here</a>."}], "answers": [{"tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": true, "score": 0, "last_activity_date": 1548557968, "creation_date": 1548557968, "answer_id": 54384705, "question_id": 54382978, "link": "https://stackoverflow.com/questions/54382978/why-do-i-get-such-output-from-this-simple-go-code/54384705#54384705", "title": "Why do I get such output from this simple Go code?", "body": "<p>In Go, as in the vast majority of modern programming languages, the arguments of a function call are evaluated before the function call itself. Consider the following function:</p>\n\n<pre><code>func add(i, j int) int {\n  return i + j\n}\n</code></pre>\n\n<p>And let's call it like this:</p>\n\n<pre><code>func a() int {\n  return 2\n}\n\nfunc b() int {\n  return 3\n}\n\n// ... somewhere in main()\nadd(a(), b())\n</code></pre>\n\n<p>You would expect that, by the time the code of <code>add</code> runs, the values of <code>i</code> and <code>j</code> are known, right? The call would then return <code>5</code> as expected. To enable this, the Go compiler arranges for the arguments of <code>add</code> - namely <code>a()</code> and <code>b()</code> to be run before <code>add</code> itself runs.</p>\n\n<hr>\n\n<p>The same happens in your code sample with <code>Println</code> and <code>pow</code>. The arguments to <code>Println</code> need to be evaluated before its body is run, and evaluating <code>pow</code> causes other things to be printed.</p>\n"}], "owner": {"reputation": 21, "user_id": 9986784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79207e6b71587aef1d8f8530d5be3238?s=128&d=identicon&r=PG&f=1", "display_name": "node0", "link": "https://stackoverflow.com/users/9986784/node0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 54384705, "answer_count": 1, "score": 1, "last_activity_date": 1548557968, "creation_date": 1548538349, "last_edit_date": 1548538462, "question_id": 54382978, "link": "https://stackoverflow.com/questions/54382978/why-do-i-get-such-output-from-this-simple-go-code", "title": "Why do I get such output from this simple Go code?", "body": "<p>I am new to Go and very confused with one of the sample codes in the tutorial. Here is the code and its output:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n)\n\nfunc pow(x, n, lim float64) float64 {\n    if v := math.Pow(x, n); v &lt; lim {\n        return v\n    } else {\n        fmt.Printf(\"%g &gt;= %g\\n\", v, lim)\n    }\n    return lim\n}\n\nfunc main() {\n    fmt.Println(pow(3, 3, 10), pow(4, 3, 20))\n}\n</code></pre>\n\n<p>When I run it, the output of this code is:</p>\n\n<pre><code>27 &gt;= 10\n64 &gt;= 20\n10 20\n</code></pre>\n\n<p>Which is quite strange to me! I expect this output:</p>\n\n<pre><code>27 &gt;= 10\n10\n64 &gt;= 20\n20\n</code></pre>\n\n<p>Can someone please help me to understand what is going on with Println in this code?</p>\n"}, {"tags": ["go", "file-upload", "server", "upload", "http-status-code-404"], "answers": [{"comments": [{"owner": {"reputation": 1569, "user_id": 7268968, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/10107185465206940/picture?type=large", "display_name": "Peter Weyand", "link": "https://stackoverflow.com/users/7268968/peter-weyand"}, "edited": false, "score": 0, "creation_date": 1548541004, "post_id": 54383271, "comment_id": 95579463, "body": "I think that may be actually OK on the filename part - at worst it should hit the endpt and then bounce after it tries to read the file, but I&#39;m not even getting that. Curl output with verbosity above."}], "tags": [], "owner": {"reputation": 8699, "user_id": 1726083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757452f7cd7ba2347c667ef9298ceadb?s=128&d=identicon&r=PG", "display_name": "Daniel Farrell", "link": "https://stackoverflow.com/users/1726083/daniel-farrell"}, "is_accepted": false, "score": 0, "last_activity_date": 1548540602, "creation_date": 1548540602, "answer_id": 54383271, "question_id": 54382921, "link": "https://stackoverflow.com/questions/54382921/golang-http-newrequest-always-returns-404-postman-ok/54383271#54383271", "title": "Golang http.NewRequest always returns 404 - Postman ok", "body": "<p>From the looks of it you're not making the same request.   Curl (thanks for including that) sets one form value while your go sets 2.  In your curl it's 'file' but in go,  'filename'.  I'm seeing that in the content-disposition line of output.   Curl with -v might also include more info about what it's sending f.   </p>\n"}, {"comments": [{"owner": {"reputation": 1569, "user_id": 7268968, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/10107185465206940/picture?type=large", "display_name": "Peter Weyand", "link": "https://stackoverflow.com/users/7268968/peter-weyand"}, "edited": false, "score": 0, "creation_date": 1548546148, "post_id": 54383835, "comment_id": 95580496, "body": "As we talked about the issue was I was shadowing my port :5000 in docker-compose. Internet points for you!"}, {"owner": {"reputation": 333, "user_id": 5685796, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3879ab371603d4d1e0c30e26e9e8a7d9?s=128&d=identicon&r=PG&f=1", "display_name": "Dentrax", "link": "https://stackoverflow.com/users/5685796/dentrax"}, "edited": false, "score": 0, "creation_date": 1605078443, "post_id": 54383835, "comment_id": 114539127, "body": "i fixed after hours of debugging, i just used uppercase characters on method string. i.e: <code>post</code> -&gt; <code>POST</code>"}], "tags": [], "owner": {"reputation": 151, "user_id": 4114655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/486113e993cbe167fec1a277dfacb447?s=128&d=identicon&r=PG", "display_name": "Tim H.", "link": "https://stackoverflow.com/users/4114655/tim-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1548546031, "creation_date": 1548546031, "answer_id": 54383835, "question_id": 54382921, "link": "https://stackoverflow.com/questions/54382921/golang-http-newrequest-always-returns-404-postman-ok/54383835#54383835", "title": "Golang http.NewRequest always returns 404 - Postman ok", "body": "<p>That 404 error string looks the same as the one generated by the Go standard library:</p>\n\n<ul>\n<li><a href=\"https://github.com/golang/go/blob/902fc114272978a40d2e65c2510a18e870077559/src/net/http/fs.go#L630\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/902fc114272978a40d2e65c2510a18e870077559/src/net/http/fs.go#L630</a></li>\n</ul>\n\n<p>Are you sure you're actually hitting the Flask application?</p>\n"}], "owner": {"reputation": 1569, "user_id": 7268968, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/10107185465206940/picture?type=large", "display_name": "Peter Weyand", "link": "https://stackoverflow.com/users/7268968/peter-weyand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1093, "favorite_count": 0, "accepted_answer_id": 54383835, "answer_count": 2, "score": 0, "last_activity_date": 1548546031, "creation_date": 1548537947, "last_edit_date": 1548542437, "question_id": 54382921, "link": "https://stackoverflow.com/questions/54382921/golang-http-newrequest-always-returns-404-postman-ok", "title": "Golang http.NewRequest always returns 404 - Postman ok", "body": "<p>I'm trying to write a post request function that sends a file to a client from a golang server. The code is cribbed a bit from here (<a href=\"https://stackoverflow.com/questions/20205796/golang-post-data-using-the-content-type-multipart-form-data\">golang POST data using the Content-Type multipart/form-data</a>). For whatever reason I always get \"404 page not found\", <em>even though</em> the same request when done through postman is hitting the endpt and returning successfully. This is bizarre behaviour and I'm not quite certain how to debug. (I've hard coded the URL to hit a locally running server for test purposes.)</p>\n\n<p>Here is my code: </p>\n\n<pre><code>func PostUpload(values map[string]io.Reader, URL string){\n    fmt.Println(\"inside PostUpload in outbound\")\n    client := &amp;http.Client{}\n    var err error\n\n    var b bytes.Buffer\n    w := multipart.NewWriter(&amp;b)\n    for key, r := range values {\n            var fw io.Writer\n            if x, ok := r.(io.Closer); ok {\n                    defer x.Close()\n            }\n            // Add an image file\n            if x, ok := r.(*os.File); ok {\n                    if fw, err = w.CreateFormFile(key, x.Name()); err != nil {\n                            return\n                    }\n            } else {\n                    // Add other fields\n                    if fw, err = w.CreateFormField(key); err != nil {\n                            return\n                    }\n            }\n            if _, err = io.Copy(fw, r); err != nil {\n                fmt.Println(\"there was an error\")\n                fmt.Println(err)\n            }\n        }\n    w.Close()\n\n    // Now that you have a form, you can submit it to your handler.\n        // req, err := http.NewRequest(\"POST\", URL, &amp;b)\n        req, err := http.NewRequest(\"POST\", \"http://127.0.0.1:5000/upload\", &amp;b)\n    if err != nil {\n                fmt.Println(\"there was an error on http.NewRequest in outbound post file upload\")\n                fmt.Println(err)\n    }\n    // Don't forget to set the content type, this will contain the boundary.\n        req.Header.Set(\"Content-Type\", w.FormDataContentType())\n\n\n        requestDump, err := httputil.DumpRequest(req, true)\n        if err != nil {\n            fmt.Println(err)\n        }\n        fmt.Println(string(requestDump))\n\n\n    // Submit the request\n    resp, err := client.Do(req)\n    if err != nil {\n                fmt.Println(\"there was an error on client do in outbound post file upload\")\n                fmt.Println(err)\n        }\n\n        resp_body, _ := ioutil.ReadAll(resp.Body)\n        var parsed map[string]interface{}\n        err = json.Unmarshal(resp_body, &amp;parsed)\n        if err!=nil{\n            if typeof(resp_body)==\"[]uint8\"{\n                fmt.Println(\"received []uint8, converting and displaying\")\n                fmt.Print(string(resp_body))\n            }else{\n                fmt.Println(\"inside unmarshal error\")\n                fmt.Println(err)\n            }\n        }\n\n    return\n}\n</code></pre>\n\n<p>And here is the output in console: </p>\n\n<pre><code>api      | 21:16:09 app         | inside PostUpload in outbound\napi      | 21:16:09 app         | POST /upload HTTP/1.1\napi      | Host: 127.0.0.1:5000\napi      | Content-Type: multipart/form-data; boundary=0ce8aee17e5d00524acd3875d8b4b41dba5f99d8a7796d56289e38f89c64\napi      |\napi      | --0ce8aee17e5d00524acd3875d8b4b41dba5f99d8a7796d56289e38f89c64\napi      | Content-Disposition: form-data; name=\"file\"; filename=\"/uploads/TIME^2019-01-26 21:16:09.413514444 +0000 UTCFILE^Any_Publishing.txt\"\napi      | Content-Type: application/octet-stream\napi      |\napi      | # \u00a9 2016 and later: Unicode, Inc. and others.\napi      | # License &amp; terms of use: http://www.unicode.org/copyright.html#License\napi      | #\napi      | # File: Any_Publishing.txt\napi      | # Generated from CLDR\napi      | #\napi      |\napi      | # Variables\napi      | $single = \\' ;\napi      | $space = ' ' ;\napi      | $double = \\\";\napi      | $back = \\` ;\napi      |\napi      | --0ce8aee17e5d00524acd3875d8b4b41dba5f99d8a7796d56289e38f89c64--\napi      |\napi      | 21:16:09 app         | received []uint8, converting and displaying\napi      | 404 page not found\n</code></pre>\n\n<p>Does anyone see what is going wrong?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Someone suggested commenting out the dump on req as it may consume req leaving it empty for the request. I tried that with the same results as above.</p>\n\n<p>Someone mentioned that they wanted to see the curl request of a successful upload so here it is: </p>\n\n<pre><code>patientplatypus:~/Downloads:15:48:28$curl -X POST -F \"file=@./catpic.jpg\" http://127.0.0.1:5000/upload\nfile uploaded successfully!\n</code></pre>\n\n<p>Full dump of curl with -v flag: </p>\n\n<pre><code>patientplatypus:~/Downloads:15:48:42$curl -v -X POST -F \"file=@./catpic.jpg\" http://127.0.0.1:5000/upload\nNote: Unnecessary use of -X or --request, POST is already inferred.\n*   Trying 127.0.0.1...\n* TCP_NODELAY set\n* Connected to 127.0.0.1 (127.0.0.1) port 5000 (#0)\n&gt; POST /upload HTTP/1.1\n&gt; Host: 127.0.0.1:5000\n&gt; User-Agent: curl/7.54.0\n&gt; Accept: */*\n&gt; Content-Length: 264915\n&gt; Expect: 100-continue\n&gt; Content-Type: multipart/form-data; boundary=------------------------48411aa948b523e2\n&gt;\n&lt; HTTP/1.1 100 Continue\n* HTTP 1.0, assume close after body\n&lt; HTTP/1.0 200 OK\n&lt; Content-Type: text/html; charset=utf-8\n&lt; Content-Length: 27\n&lt; Server: Werkzeug/0.14.1 Python/3.6.5\n&lt; Date: Sat, 26 Jan 2019 22:12:19 GMT\n&lt;\n* Closing connection 0\nfile uploaded successfully!\n</code></pre>\n\n<p>Someone mentioned that they wanted to see the server I was attempting to hit so here it is: <a href=\"https://github.com/patientplatypus/pythonServer\" rel=\"nofollow noreferrer\">https://github.com/patientplatypus/pythonServer</a></p>\n"}, {"tags": ["go", "constants"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1548530716, "post_id": 54381766, "comment_id": 95576895, "body": "The decision was that predeclared errors should be singletons, so that comparing different instances of errors would not be unexpectedly equal."}, {"owner": {"reputation": 4227, "user_id": 437506, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1f81d6e639fd42098d15302f098f0531?s=128&d=identicon&r=PG&f=1", "display_name": "Kedar Mhaswade", "link": "https://stackoverflow.com/users/437506/kedar-mhaswade"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1548537123, "post_id": 54381766, "comment_id": 95578508, "body": "SO is weird. I can&#39;t correct my previous comment (since, apparently, it is more than 2 hours old -- deleting that comment is not an option). Here&#39;s the <a href=\"https://dave.cheney.net/2016/04/07/constant-errors\" rel=\"nofollow noreferrer\">correct link</a> demonstrating that others make this observation too (<code>Could we change the definition of io.EOF to be a constant?</code>), @Flimzy."}, {"owner": {"reputation": 4227, "user_id": 437506, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1f81d6e639fd42098d15302f098f0531?s=128&d=identicon&r=PG&f=1", "display_name": "Kedar Mhaswade", "link": "https://stackoverflow.com/users/437506/kedar-mhaswade"}, "edited": false, "score": 0, "creation_date": 1548542632, "post_id": 54381766, "comment_id": 95579801, "body": "That&#39;s because then you&#39;ll have to delete your comment which would otherwise be rendered <i>dangling</i> (you should delete your comment and then I can delete my first comment). By the way, do you know the answer to my question?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1548578086, "post_id": 54381766, "comment_id": 95584998, "body": "Also this answer gives some insight: <a href=\"https://stackoverflow.com/questions/50333428/custom-errors-in-golang-and-pointer-receivers/50333850#50333850\">Custom errors in golang and pointer receivers</a> (constants can&#39;t be pointers)."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1548592588, "post_id": 54381766, "comment_id": 95588419, "body": "Dangling comments are not really a concern. Comments are always considered ephemeral."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1548592627, "post_id": 54381766, "comment_id": 95588429, "body": "I&#39;m still not sure why you say constants are &quot;unusual&quot;. Are you referring to the way Go handles untyped constants?"}, {"owner": {"reputation": 4227, "user_id": 437506, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1f81d6e639fd42098d15302f098f0531?s=128&d=identicon&r=PG&f=1", "display_name": "Kedar Mhaswade", "link": "https://stackoverflow.com/users/437506/kedar-mhaswade"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1548598244, "post_id": 54381766, "comment_id": 95589893, "body": "@icza thanks! From <a href=\"https://blog.golang.org/constants\" rel=\"nofollow noreferrer\">the Go Blog</a>: &quot;But in Go, a constant is just a simple, unchanging value, and from here on we&#39;re talking only about Go.&quot; -- My question: is it <i>not</i> possible to have this restriction (unchanging value) and still make <code>io.EOF</code> a constant (because it <i>feels</i> and <i>behaves</i> like one)?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548598707, "post_id": 54381766, "comment_id": 95590043, "body": "Of course it\u2019s possible, but the language wasn\u2019t designed that way. What real world benefit would this have for the added complication to the spec and implementation? Users can always write bad code and do bad things; someone reassigning <code>io.EOF</code> just isn\u2019t considered a significant issue."}, {"owner": {"reputation": 4227, "user_id": 437506, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1f81d6e639fd42098d15302f098f0531?s=128&d=identicon&r=PG&f=1", "display_name": "Kedar Mhaswade", "link": "https://stackoverflow.com/users/437506/kedar-mhaswade"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548599897, "post_id": 54381766, "comment_id": 95590420, "body": "@JimB, thanks. I agree, this question perhaps solicits answers from the language designers. The <a href=\"https://dave.cheney.net/2016/04/07/constant-errors\" rel=\"nofollow noreferrer\">link</a> provides some ideas about implementation without changing the spec at all. The pivotal question is: Should a <i>value</i> of a type other than basic types be allowed to be a constant?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548600213, "post_id": 54381766, "comment_id": 95590520, "body": "The example in that post demonstrates why they chose to implement <code>errors.New</code> the way they did, specifically so that different instances don\u2019t compare as equal."}], "owner": {"reputation": 4227, "user_id": 437506, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1f81d6e639fd42098d15302f098f0531?s=128&d=identicon&r=PG&f=1", "display_name": "Kedar Mhaswade", "link": "https://stackoverflow.com/users/437506/kedar-mhaswade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 196, "favorite_count": 2, "answer_count": 0, "score": 0, "last_activity_date": 1548615505, "creation_date": 1548529418, "last_edit_date": 1548542730, "question_id": 54381766, "link": "https://stackoverflow.com/questions/54381766/why-is-io-eof-not-a-constant", "title": "Why is io.EOF not a constant?", "body": "<p>I was rather surprised that <a href=\"https://github.com/golang/go/blob/master/src/io/io.go#L38\" rel=\"nofollow noreferrer\"><code>io.EOF</code></a> is <em>not</em> declared a constant, but an exported variable. Although not a big deal, this subjects it to unintended reassignment. Why not declare it a constant? Is this because <a href=\"https://blog.golang.org/constants\" rel=\"nofollow noreferrer\">constants in Go are rather unusual</a>? </p>\n"}, {"tags": ["macos", "go", "installation", "gopath"], "answers": [{"comments": [{"owner": {"reputation": 1441, "user_id": 5151441, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WvqLN.png?s=128&g=1", "display_name": "Jessica", "link": "https://stackoverflow.com/users/5151441/jessica"}, "edited": false, "score": 0, "creation_date": 1548525134, "post_id": 54381049, "comment_id": 95575375, "body": "Ah, I see it in this list. Do you know why this wasn&#39;t being returned when I entered go env gopath? Thanks!"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 1441, "user_id": 5151441, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WvqLN.png?s=128&g=1", "display_name": "Jessica", "link": "https://stackoverflow.com/users/5151441/jessica"}, "edited": false, "score": 0, "creation_date": 1548525196, "post_id": 54381049, "comment_id": 95575396, "body": "Run <code>go env GOPATH</code>."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 2, "last_activity_date": 1548525247, "last_edit_date": 1548525247, "creation_date": 1548525050, "answer_id": 54381049, "question_id": 54381001, "link": "https://stackoverflow.com/questions/54381001/gopath-not-being-automatically-set/54381049#54381049", "title": "GOPATH not being automatically set?", "body": "<p>Go will use a default for GOPATH. Run the <code>go env</code> command to see the value.</p>\n\n<p>Run the <code>go env GOPATH</code> command for just the GOPATH value. </p>\n"}, {"tags": [], "owner": {"reputation": 611, "user_id": 4281077, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3oOg40JdTy4/AAAAAAAAAAI/AAAAAAAAHNQ/jB3IczOZSFE/photo.jpg?sz=128", "display_name": "Karthik Nayak", "link": "https://stackoverflow.com/users/4281077/karthik-nayak"}, "is_accepted": false, "score": 1, "last_activity_date": 1548525086, "creation_date": 1548525086, "answer_id": 54381060, "question_id": 54381001, "link": "https://stackoverflow.com/questions/54381001/gopath-not-being-automatically-set/54381060#54381060", "title": "GOPATH not being automatically set?", "body": "<p>I think you want to run <code>go env GOPATH</code> instead of <code>go env gopath</code>. Notice the difference in capitalization. Just running <code>go env</code> would list all <code>go</code> variables. </p>\n"}], "owner": {"reputation": 1441, "user_id": 5151441, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WvqLN.png?s=128&g=1", "display_name": "Jessica", "link": "https://stackoverflow.com/users/5151441/jessica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 2, "accepted_answer_id": 54381049, "answer_count": 2, "score": 1, "last_activity_date": 1548525247, "creation_date": 1548524729, "question_id": 54381001, "link": "https://stackoverflow.com/questions/54381001/gopath-not-being-automatically-set", "title": "GOPATH not being automatically set?", "body": "<p>I'm installing Golang on my MacBook.</p>\n\n<p>According to multiple sources (<a href=\"https://stackoverflow.com/a/21506074/8516041\">example</a>), Golang 1.8 and onwards automatically sets GOPATH.</p>\n\n<p>If I run the command <code>go env gopath</code> in Terminal, nothing is returned. Does this mean the GOPATH variable is not set?</p>\n\n<p>I have attempted to set it manually with <code>export GOPATH=$HOME/go</code> (as per this <a href=\"https://github.com/golang/go/wiki/SettingGOPATH\" rel=\"nofollow noreferrer\">example</a>).</p>\n\n<p>Yet this still returns nothing.</p>\n\n<p>I have tried reinstalling Golang. This works on my Windows machine, just not MacOS.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1548519425, "post_id": 54380193, "comment_id": 95573791, "body": "Your example is not going to complete in the 500 nanoseconds before main exits."}, {"owner": {"reputation": 8007, "user_id": 5890784, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dec46088a284202a3be71897845a669d?s=128&d=identicon&r=PG&f=1", "display_name": "Hind Forsum", "link": "https://stackoverflow.com/users/5890784/hind-forsum"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548544845, "post_id": 54380193, "comment_id": 95580231, "body": "Thanks, time.Sleep(500 * time.Millisecond) solves my problem."}], "answers": [{"comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1548521316, "post_id": 54380444, "comment_id": 95574290, "body": "Still not good enough, in real life, your consumer usually doesn&#39;t know how many  values to read from a channel, and both routines write to stdout, which is a bottleneck. Upping the number of values from 100 to a higher number will result in you eventually needing to change the duration of the sleep time, again changing it depending on the machine you&#39;re running on. You&#39;ll probably end up sleeping too long on some machines, which is just a waste"}, {"owner": {"reputation": 7865, "user_id": 576932, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2084548226e1ab1a0814812cccb29bef?s=128&d=identicon&r=PG", "display_name": "ford", "link": "https://stackoverflow.com/users/576932/ford"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1548521907, "post_id": 54380444, "comment_id": 95574466, "body": "Oh absolutely, waiting an arbitrary amount of time is definitely not the right way to handle this in general. I figured OP would want to understand why their program behaved in the way it did, though, especially because this is a common trap for beginners."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1548521997, "post_id": 54380444, "comment_id": 95574497, "body": "There&#39;s nothing surprising about not seeing an error when you write <code>time.Sleep(1000)</code> BTW. the <code>1000</code> is an untyped constant. The expression in which you use this value will determine the type. It&#39;s well documented behaviour."}, {"owner": {"reputation": 7865, "user_id": 576932, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2084548226e1ab1a0814812cccb29bef?s=128&d=identicon&r=PG", "display_name": "ford", "link": "https://stackoverflow.com/users/576932/ford"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1548522763, "post_id": 54380444, "comment_id": 95574708, "body": "You and I might not get surprised by this behavior, but beginners clearly do as evidenced by the <i>question we are answering</i>."}], "tags": [], "owner": {"reputation": 7865, "user_id": 576932, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2084548226e1ab1a0814812cccb29bef?s=128&d=identicon&r=PG", "display_name": "ford", "link": "https://stackoverflow.com/users/576932/ford"}, "is_accepted": false, "score": 1, "last_activity_date": 1548521732, "last_edit_date": 1548521732, "creation_date": 1548520954, "answer_id": 54380444, "question_id": 54380193, "link": "https://stackoverflow.com/questions/54380193/go-channel-didnt-work-for-producer-consumer-sample/54380444#54380444", "title": "Go channel didn&#39;t work for producer/consumer sample", "body": "<p>As JimB hinted at, <code>time.Sleep</code> takes a <code>time.Duration</code>, not an integer. The <a href=\"https://godoc.org/time#Sleep\" rel=\"nofollow noreferrer\">godoc</a> shows an example of how to call this correctly. In your case, you probably want:</p>\n\n<pre><code>time.Sleep(500 * time.Millisecond)\n</code></pre>\n\n<p>The reason that your program is exiting quickly (but not giving you an error) is due to the (somewhat surprising) way that <code>time.Duration</code> is implemented. </p>\n\n<p><code>time.Duration</code> is simply a type alias for <code>int64</code>. Internally, it uses the value to represent the duration in nanoseconds. When you call <code>time.Sleep(500)</code>, the compiler will gladly interpret the numeric literal <code>500</code> as a <code>time.Duration</code>. Unfortunately, <em>that means 500 ns</em>.</p>\n\n<p><code>time.Millisecond</code> is a constant equal to the number of nanoseconds in a millisecond (1,000,000). The nice thing is that requiring you to do that multiplication explicitly makes it obvious to that caller what the units are on that argument. Unfortunately, <code>time.Sleep(500)</code> is perfectly valid go code but doesn't do what most beginners would expect.</p>\n"}, {"tags": [], "owner": {"reputation": 1569, "user_id": 2819689, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/07cce556c9a96b1ec9622df191fc651c?s=128&d=identicon&r=PG&f=1", "display_name": "MikiBelavista", "link": "https://stackoverflow.com/users/2819689/mikibelavista"}, "is_accepted": false, "score": 1, "last_activity_date": 1548520983, "creation_date": 1548520983, "answer_id": 54380448, "question_id": 54380193, "link": "https://stackoverflow.com/questions/54380193/go-channel-didnt-work-for-producer-consumer-sample/54380448#54380448", "title": "Go channel didn&#39;t work for producer/consumer sample", "body": "<p>I have changed slightly(expanded time.Sleep) your code. Works fine on my Linux x86_64</p>\n\n<pre><code>func Product(ch chan&lt;- int) {\n    for i := 0; i &lt; 10; i++ {\n        fmt.Println(\"Product:\", i)\n        ch &lt;- i\n    }\n}\nfunc Consumer(ch &lt;-chan int) {\n    for i := 0; i &lt; 10; i++ {\n        a := &lt;-ch\n        fmt.Println(\"Consmuer:\", a)\n    }\n}\nfunc main() {\n    ch := make(chan int, 1)\n    go Product(ch)\n    go Consumer(ch)\n    time.Sleep(10000)\n}\n</code></pre>\n\n<p>Output\ngo run s1.go </p>\n\n<pre><code>Product: 0\nProduct: 1\nProduct: 2\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1548521690, "post_id": 54380482, "comment_id": 95574409, "body": "&quot;The rule of thumb WRT channels is that channels are created and closed in the same routine. Meaning: you&#39;re creating the channel in the main routine, that&#39;s where it should be closed.&quot; Disagree in this case. If there&#39;s only one sender, channels should be closed by that sender, which isn&#39;t necessarily the creator. The introduction of the done channel offers no benefit but increases complexity."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1548521808, "post_id": 54380482, "comment_id": 95574442, "body": "@Peter: It&#39;s a rule of thumb, but a bit further down, I close a channel in a different routine, and actually state that it&#39;s acceptable in that case. It&#39;s not a hard-set rule, but when you create channels in the <code>main</code> routine, it&#39;s far more risky IMO. then closing a channel you create in a closure-routine"}], "tags": [], "owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "is_accepted": true, "score": 3, "last_activity_date": 1548521571, "last_edit_date": 1548521571, "creation_date": 1548521196, "answer_id": 54380482, "question_id": 54380193, "link": "https://stackoverflow.com/questions/54380193/go-channel-didnt-work-for-producer-consumer-sample/54380482#54380482", "title": "Go channel didn&#39;t work for producer/consumer sample", "body": "<p>This is a rather verbose answer, but to put it simply:</p>\n\n<ul>\n<li>Using <code>time.Sleep</code> to wait until <em>hopefully</em> other routines have completed their jobs is bad. </li>\n<li>The consumer and producer shouldn't know anything about each other, apart from the type they exchange over the channel. Your code relies on both consumer and producer knowing how many ints will be passed around. Not a realistic scenario</li>\n<li>Channels can be iterated over (think of them as a thread-safe, shared slice)</li>\n<li>channels should be closed</li>\n</ul>\n\n<p>At the bottom of this rather verbose answer where I attempt to explain some basic concepts and best practices (well, better practices), you'll find your code rewritten to work <em>and</em> display all the values <em>without</em> relying on <code>time.Sleep</code>. I've not tested that code, but should be fine</p>\n\n<hr>\n\n<p>Right, there's a couple of problems here. Just as a bullet-list:</p>\n\n<ol>\n<li>Your channel is buffered to 1, which is fine, but it's not necessary</li>\n<li>Your channel is never closed</li>\n<li>You're waiting 500ns, then exit regardless of the routines having completed, or even started processing for that matter.</li>\n<li>There's no centralised control on over the routines, once you've started them, you have 0 control. If you hit ctrl+c, you might want to cancel routines when writing code that'll handle important data. Check signal handling, and context for this</li>\n</ol>\n\n<h1>Channel buffer</h1>\n\n<p>Seeing as you already know how many values you're going to push onto your channel, why not simply create <code>ch := make(chan int, 100)</code>? That way your publisher can continue to push messages onto the channel, regardless of what the consumer does.</p>\n\n<p>You don't <em>need</em> to do this, but adding a sensible buffer to your channel, depending on what you're trying to do, is definitely worth checking out. At the moment, though, both routines are using <code>fmt.Println</code> &amp; co, which is going to be a bottleneck either way. Printing to STDOUT is thread-safe, and buffered. This means that each call to <code>fmt.Print*</code> is going to acquire a lock, to avoid text from both routines to be combined.</p>\n\n<h1>Closing the channel</h1>\n\n<p>You could simply push all the values onto your channel, and then close it. This is, however, bad form. The rule of thumb WRT channels is that channels are created and closed in the same routine. Meaning: you're creating the channel in the main routine, that's where it should be closed.</p>\n\n<p>You need a mechanism to sync up, or at least keep tabs on whether or not your routines have completed their job. That's done using the <code>sync</code> package, or through a second channel.</p>\n\n<pre><code>// using a done channel\nfunc produce(ch chan&lt;- int) &lt;-chan struct{} {\n    done := make(chan struct{})\n    go func() {\n        for i := 0; i &lt; 100; i++ {\n            ch &lt;- i\n        }\n        // all values have been published\n        // close done channel\n        close(done)\n    }()\n    return done\n}\n\nfunc main() {\n    ch := make(chan int, 1)\n    done := produce(ch)\n    go consume(ch)\n    &lt;-done // if producer has done its thing\n    close(ch) // we can close the channel\n}\n\nfunc consume(ch &lt;-chan int) {\n    // we can now simply loop over the channel until it's closed\n    for i := range ch {\n        fmt.Printf(\"Consumed %d\\n\", i)\n    }\n}\n</code></pre>\n\n<p>OK, but here you'll still need to wait for the <code>consume</code> routine to complete.</p>\n\n<p>You may have already noticed that the <code>done</code> channel technically isn't closed in the same routine that creates it either. Because the routine is defined as a closure, however, this is an acceptable compromise. Now let's see how we could use a waitgroup:</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc product(wg *sync.WaitGroup, ch chan&lt;- int) {\n    defer wg.Done() // signal we've done our job\n    for i := 0; i &lt; 100; i++ {\n        ch &lt;- i\n    }\n}\n\nfunc main() {\n    ch := make(chan int, 1)\n    wg := sync.WaitGroup{}\n    wg.Add(1) // I'm adding a routine to the channel\n    go produce(&amp;wg, ch)\n    wg.Wait() // will return once `produce` has finished\n    close(ch)\n}\n</code></pre>\n\n<p>OK, so this looks promising, I can have the routines tell me when they've finished their tasks. But if I add both consumer and producer to the waitgroup, I can't simply iterate over the channel. The channel will only ever get closed if both routines invoke <code>wg.Done()</code>, but if the consumer is stuck looping over a channel that'll never get closed, then I've created a deadlock.</p>\n\n<h1>Solution:</h1>\n\n<p>A hybrid would be the easiest solution at this point: Add the consumer to a waitgroup, and use the done channel in the producer to get:</p>\n\n<pre><code>func produce(ch chan&lt;- int) &lt;-chan struct{} {\n    done := make(chan struct{})\n    go func() {\n        for i := 0; i &lt; 100; i++ {\n            ch &lt;- i\n        }\n        close(done)\n    }()\n    return done\n}\n\nfunc consume(wg *sync.WaitGroup, ch &lt;-chan int) {\n    defer wg.Done()\n    for i := range ch {\n        fmt.Printf(\"Consumer: %d\\n\", i)\n    }\n}\n\nfunc main() {\n    ch := make(chan int, 1)\n    wg := sync.WaitGroup{}\n    done := produce(ch)\n    wg.Add(1)\n    go consume(&amp;wg, ch)\n    &lt;- done // produce done\n    close(ch)\n    wg.Wait()\n    // consumer done\n    fmt.Println(\"All done, exit\")\n}\n</code></pre>\n"}], "owner": {"reputation": 8007, "user_id": 5890784, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dec46088a284202a3be71897845a669d?s=128&d=identicon&r=PG&f=1", "display_name": "Hind Forsum", "link": "https://stackoverflow.com/users/5890784/hind-forsum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 54380482, "answer_count": 3, "score": 1, "last_activity_date": 1548539698, "creation_date": 1548519271, "last_edit_date": 1548539698, "question_id": 54380193, "link": "https://stackoverflow.com/questions/54380193/go-channel-didnt-work-for-producer-consumer-sample", "title": "Go channel didn&#39;t work for producer/consumer sample", "body": "<p>I've just installed Go on Mac, and here's the code</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc Product(ch chan&lt;- int) {\n    for i := 0; i &lt; 100; i++ {\n        fmt.Println(\"Product:\", i)\n        ch &lt;- i\n    }\n}\n\nfunc Consumer(ch &lt;-chan int) {\n    for i := 0; i &lt; 100; i++ {\n        a := &lt;-ch\n        fmt.Println(\"Consmuer:\", a)\n    }\n}\n\nfunc main() {\n    ch := make(chan int, 1)\n    go Product(ch)\n    go Consumer(ch)\n    time.Sleep(500)\n}\n</code></pre>\n\n<p>I \"go run producer_consumer.go\", there's no output on screen, and then it quits.</p>\n\n<p>Any problem with my program ? How to fix it ?</p>\n"}, {"tags": ["go", "revel"], "answers": [{"tags": [], "owner": {"reputation": 7865, "user_id": 576932, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2084548226e1ab1a0814812cccb29bef?s=128&d=identicon&r=PG", "display_name": "ford", "link": "https://stackoverflow.com/users/576932/ford"}, "is_accepted": false, "score": 0, "last_activity_date": 1548520450, "creation_date": 1548520450, "answer_id": 54380368, "question_id": 54380070, "link": "https://stackoverflow.com/questions/54380070/revel-flash-messages-are-not-displayed/54380368#54380368", "title": "revel flash messages are not displayed", "body": "<p>I'm not familiar with <code>revel</code>, but message \"flashing\" is typically used when you need some user communication to carry over through a redirect. The <a href=\"https://godoc.org/github.com/revel/revel#Flash\" rel=\"nofollow noreferrer\">godoc</a> seems to describe it as exactly for that use case as well.</p>\n\n<p>If you're rendering a template directly in this request handler, you probably shouldn't be using <code>c.Flash</code>. My guess of what is happening is that <code>revel</code> will only show the flash message <em>received</em> with the request. Calling <code>c.Flash.Error</code> sets the field in the cookie, which means it will be sent back to the caller, not to the template. On the <em>next</em> render, it will read from the cookie that the caller sends back to the server, which would include this flash message. Apparently, though, setting a new flash message replaces the old one, causing it to (yet again) send it to the caller not the template.</p>\n\n<p>The good news is that there's really only one way for your message to get on the page, and you can almost definitely shoehorn your message there: the template data! Instead of calling <code>c.Flash.Error</code>, send the message using the usual mechanisms. In this case, assuming your <code>flash.html</code> template contains something like:</p>\n\n<pre><code>{{ if .flash.error }}\n    &lt;div class=\"error\"&gt;{{ .flash.error }}&lt;/div&gt;\n{{ end }}\n</code></pre>\n\n<p>you should be able to pass that data by replacing the <code>c.Flash.Error(\"Message\")</code> line with:</p>\n\n<pre><code>c.ViewArgs[\"flash\"] = map[string]string{\"error\": \"Message\"}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "is_accepted": false, "score": 0, "last_activity_date": 1548522904, "creation_date": 1548522904, "answer_id": 54380731, "question_id": 54380070, "link": "https://stackoverflow.com/questions/54380070/revel-flash-messages-are-not-displayed/54380731#54380731", "title": "revel flash messages are not displayed", "body": "<p>This seems to be <a href=\"https://github.com/revel/revel/issues/1306\" rel=\"nofollow noreferrer\">a known issue/expected behaviour</a>. As the discussion on github seems to suggest, to use the flash message for errors, you either need to redirect:</p>\n\n<pre><code>c.Flash.Error(\"Message\")\nreturn c.Redirect(\"App/ShowError\")\n</code></pre>\n\n<p>Or using the <code>field</code> <a href=\"https://revel.github.io/manual/templates-go.html#field\" rel=\"nofollow noreferrer\">template function</a> if you need to add the error message next to a specific input element. </p>\n\n<p>Seeing as you're not rendering a form in your template, I'm guessing a redirect is what you need to add.</p>\n\n<hr>\n\n<p>Incidentally: revel is, by many, considered harmful. I'd urge you to not use a framework that attempts to force you to use go following a classical MVC structure. Nowadays, most web applications are single page apps using react on the client side, and an API based backend. It might make your life easier to go down this route, too?</p>\n"}], "owner": {"reputation": 5894, "user_id": 4746206, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/aeb5a68770c5420348fb112d7e082436?s=128&d=identicon&r=PG&f=1", "display_name": "Bob5421", "link": "https://stackoverflow.com/users/4746206/bob5421"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 216, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1548522904, "creation_date": 1548518328, "question_id": 54380070, "link": "https://stackoverflow.com/questions/54380070/revel-flash-messages-are-not-displayed", "title": "revel flash messages are not displayed", "body": "<p>I have created a revel web application with default skelton.</p>\n\n<p>I have created a new route/action/view:</p>\n\n<p>Controller action:</p>\n\n<pre><code>func (c Ctrl1) Action3() revel.Result {\n    variable1 := \"test1\"\n    variable2 := \"test2\"\n    c.Flash.Error(\"Message\")\n    return c.Render(variable1,variable2)\n}\n</code></pre>\n\n<p>Action3.html:</p>\n\n<pre><code>{{set . \"title\" \"Test\"}}\n{{template \"header.html\" .}}\n{{template \"flash.html\" .}}\nHello: {{.variable1}}\n{{template \"footer.html\" .}}\n</code></pre>\n\n<p>The first time i have runned my webapp, i saw the flash message.\nBut next times, if i refresh the page, it disapears !</p>\n\n<p>I have restarted revel</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "go-cobra", "viper-go", "go-flag"], "answers": [{"comments": [{"owner": {"reputation": 34200, "user_id": 995862, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d5efb6c1054808f7a79aaefbc64cce76?s=128&d=identicon&r=PG", "display_name": "Kurt Peek", "link": "https://stackoverflow.com/users/995862/kurt-peek"}, "edited": false, "score": 4, "creation_date": 1579200258, "post_id": 54381268, "comment_id": 105695867, "body": "As far as I can tell 2. is not possible, because the various <code>FlagSet</code> methods such as <code>Int64</code> take a value as an argument, e.g. <code>func (f *FlagSet) Int64(name string, value int64, usage string) *int64</code>. So you cannot set <code>value</code> to <code>nil</code>."}], "tags": [], "owner": {"reputation": 611, "user_id": 4281077, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3oOg40JdTy4/AAAAAAAAAAI/AAAAAAAAHNQ/jB3IczOZSFE/photo.jpg?sz=128", "display_name": "Karthik Nayak", "link": "https://stackoverflow.com/users/4281077/karthik-nayak"}, "is_accepted": false, "score": 1, "last_activity_date": 1548526313, "creation_date": 1548526313, "answer_id": 54381268, "question_id": 54379749, "link": "https://stackoverflow.com/questions/54379749/how-do-i-extract-only-flagsets-that-are-being-set-explicitly-in-the-cli/54381268#54381268", "title": "How do I extract only flagsets that are being set explicitly in the cli?", "body": "<p>Suppose your <code>User</code> struct looks like this:</p>\n\n<pre><code>type User struct {\n    ...\n    age     int\n    address string\n    ...\n}\n</code></pre>\n\n<p>Then by default initialization of the <code>User</code> struct will set <code>age =&gt; 0, address =&gt; 0</code>. So even if viper doesn't set defaults. Go internally will.</p>\n\n<p>What I suggest is:<br>\n1. Change how user struct is created</p>\n\n<pre><code>type User struct {\n    ...\n    age     *int\n    address *string\n    ...\n}\n</code></pre>\n\n<ol start=\"2\">\n<li>Set the defaults in cobra to <code>nil</code> for both those fields.<br>\nThis way you'd know that the default of Cobra is to not set the value. Whenever the value is set, it'll be a non <code>nil</code> value. Hope that helps! </li>\n</ol>\n"}], "owner": {"reputation": 993, "user_id": 4085562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZjfnY.png?s=128&g=1", "display_name": "dekauliya", "link": "https://stackoverflow.com/users/4085562/dekauliya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1091, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1548970759, "creation_date": 1548516207, "last_edit_date": 1548970759, "question_id": 54379749, "link": "https://stackoverflow.com/questions/54379749/how-do-i-extract-only-flagsets-that-are-being-set-explicitly-in-the-cli", "title": "How do I extract only flagsets that are being set explicitly in the cli?", "body": "<p>I am new to <a href=\"https://github.com/spf13/cobra\" rel=\"nofollow noreferrer\">cobra</a> and <a href=\"https://github.com/spf13/viper\" rel=\"nofollow noreferrer\">viper</a>. </p>\n\n<p>I wanted to know if there's a way to exclude flag values that aren't set by the user from cli. So my problem is, I have some optional flags in my cobra <code>cmd</code> that have default values. I wonder if there's a way to exclude these optional flags if they aren't set by the user from being processed? Or in another perspective, is there a way to extract flags that are changed by the user explicitly from cli from a <code>cmd</code> flagset?</p>\n\n<p>Here's an example to better illustrate my case:</p>\n\n<pre><code>var cmd = &amp;cobra.Command{\n    Use:   \"command [operations]\",\n    Short: \"Perform some commands\",\n    Run: func(cmd *cobra.Command, args []string) {\n        var user User\n        err := viper.Unmarshal(&amp;user)\n        fmt.Println(err)\n        fmt.Println(user)\n    },\n}\n\ncmd.PersistentFlags().String(\"name\", \"\", \"Your Name (Required)\")\ncmd.PersistentFlags().String(\"description\", \"\", \"Description\")\ncmd.PersistentFlags().String(\"address\", \"\", \"Address\")\ncmd.PersistentFlags().Int(\"age\", -1, \"Age\")\ncmd.MarkPersistentFlagRequired(\"name\")\nviper.BindPFlags(cmd.PersistentFlags()) \n</code></pre>\n\n<p>So suppose for age and address, I want them to be optional and not propagated when they're passed to struct. So this means, in the cli, the user is not required to submit the <code>age</code> and <code>address</code> flags and the default values for these optional flags are nil. However, Int &amp; String flags are strongly typed, so they require default values (eg: <code>\"\"</code> and <code>-1</code>). As a result, when I bind the command pflags to viper and user don't input age &amp; address values in the cli, viper will receive <code>\"\"</code> for address and <code>-1</code> for age. Using the above method, the default values will get propagated to the User struct. </p>\n\n<p>What I want is, to exclude flag values that aren't set by the user. Is there a way for me to exclude User struct from receiving flag values that aren't explicitly set by the user?</p>\n\n<p>My current solution to exclude the unset flags from being processed in the User struct is currently like this:</p>\n\n<ol>\n<li>Have an array of the command flags. Initialize an empty <code>map[string]interface{}</code> </li>\n<li>Iterate through the array, and check if the flag is set/changed via <code>flags.Changed(\"flag\")</code>. If flag is changed, then add it to map</li>\n<li>Convert map to json</li>\n<li><p>Unmarshal json object to struct</p>\n\n<pre><code>// inside the Run function of a cobra command\naMap := make(map[string]interface{})\nflags := cmd.Flags()\nfor _, flag := range cmdFlags {\n    if flags.Changed(flag) {\n        aMap[flag] = viper.Get(flag)\n    }\n}\njsonStr, _ := json.Marshal(aMap)\nvar user User\njson.Unmarshal(jsonStr, &amp;user)\nfmt.Println(user)\n</code></pre></li>\n</ol>\n\n<p>But I was wondering if there is a better alternative than my solution above. Preferably, I don't want to change anything in the <code>User</code> struct as it is imported from an external package.</p>\n\n<p>Thank you. Your help is greatly appreciated.</p>\n"}, {"tags": ["go", "stripe-payments", "godeps"], "answers": [{"comments": [{"owner": {"reputation": 345, "user_id": 1847148, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/66ab4f6d98da1b457df1c7ba446090ff?s=128&d=identicon&r=PG", "display_name": "b3lowster", "link": "https://stackoverflow.com/users/1847148/b3lowster"}, "edited": false, "score": 0, "creation_date": 1548527141, "post_id": 54381339, "comment_id": 95575916, "body": "I cannot change go version. What if remove old dependencies packages form videos.json manually? and try run godeps save ?"}, {"owner": {"reputation": 611, "user_id": 4281077, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3oOg40JdTy4/AAAAAAAAAAI/AAAAAAAAHNQ/jB3IczOZSFE/photo.jpg?sz=128", "display_name": "Karthik Nayak", "link": "https://stackoverflow.com/users/4281077/karthik-nayak"}, "reply_to_user": {"reputation": 345, "user_id": 1847148, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/66ab4f6d98da1b457df1c7ba446090ff?s=128&d=identicon&r=PG", "display_name": "b3lowster", "link": "https://stackoverflow.com/users/1847148/b3lowster"}, "edited": false, "score": 0, "creation_date": 1548528295, "post_id": 54381339, "comment_id": 95576266, "body": "could you add the json, so I can help you better? @b3lowster"}, {"owner": {"reputation": 345, "user_id": 1847148, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/66ab4f6d98da1b457df1c7ba446090ff?s=128&d=identicon&r=PG", "display_name": "b3lowster", "link": "https://stackoverflow.com/users/1847148/b3lowster"}, "edited": false, "score": 0, "creation_date": 1548528855, "post_id": 54381339, "comment_id": 95576419, "body": "Would be enough if I share JSON file but only with Stripe dependencies?"}, {"owner": {"reputation": 611, "user_id": 4281077, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3oOg40JdTy4/AAAAAAAAAAI/AAAAAAAAHNQ/jB3IczOZSFE/photo.jpg?sz=128", "display_name": "Karthik Nayak", "link": "https://stackoverflow.com/users/4281077/karthik-nayak"}, "reply_to_user": {"reputation": 345, "user_id": 1847148, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/66ab4f6d98da1b457df1c7ba446090ff?s=128&d=identicon&r=PG", "display_name": "b3lowster", "link": "https://stackoverflow.com/users/1847148/b3lowster"}, "edited": false, "score": 0, "creation_date": 1548529086, "post_id": 54381339, "comment_id": 95576477, "body": "@b3lowster Yeah that should be sufficient! <code>cat something.json | grep -i stripe</code>."}, {"owner": {"reputation": 345, "user_id": 1847148, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/66ab4f6d98da1b457df1c7ba446090ff?s=128&d=identicon&r=PG", "display_name": "b3lowster", "link": "https://stackoverflow.com/users/1847148/b3lowster"}, "edited": false, "score": 0, "creation_date": 1548529394, "post_id": 54381339, "comment_id": 95576562, "body": "cat Godeps/Godeps.json | grep -i stripe &quot;ImportPath&quot;: &quot;github.com/stripe/stripe-go&quot;, &quot;ImportPath&quot;: &quot;github.com/stripe/stripe-go/card&quot;, &quot;ImportPath&quot;: &quot;github.com/stripe/stripe-go/charge&quot;, &quot;ImportPath&quot;: &quot;github.com/stripe/stripe-go/customer&quot;, &quot;ImportPath&quot;: &quot;github.com/stripe/stripe-go/orderitem&quot;, &quot;ImportPath&quot;: &quot;github.com/stripe/stripe-go/token&quot;,"}, {"owner": {"reputation": 345, "user_id": 1847148, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/66ab4f6d98da1b457df1c7ba446090ff?s=128&d=identicon&r=PG", "display_name": "b3lowster", "link": "https://stackoverflow.com/users/1847148/b3lowster"}, "edited": false, "score": 0, "creation_date": 1548533198, "post_id": 54381339, "comment_id": 95577514, "body": "if i try to run : godep update github.com/stripe/.. I get: godep: not in manifest: github.com godep: no packages can be updated"}, {"owner": {"reputation": 345, "user_id": 1847148, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/66ab4f6d98da1b457df1c7ba446090ff?s=128&d=identicon&r=PG", "display_name": "b3lowster", "link": "https://stackoverflow.com/users/1847148/b3lowster"}, "edited": false, "score": 1, "creation_date": 1548533388, "post_id": 54381339, "comment_id": 95577567, "body": "It work for this command :) godep update github.com/stripe/...    Thanks a lot"}, {"owner": {"reputation": 611, "user_id": 4281077, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3oOg40JdTy4/AAAAAAAAAAI/AAAAAAAAHNQ/jB3IczOZSFE/photo.jpg?sz=128", "display_name": "Karthik Nayak", "link": "https://stackoverflow.com/users/4281077/karthik-nayak"}, "reply_to_user": {"reputation": 345, "user_id": 1847148, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/66ab4f6d98da1b457df1c7ba446090ff?s=128&d=identicon&r=PG", "display_name": "b3lowster", "link": "https://stackoverflow.com/users/1847148/b3lowster"}, "edited": false, "score": 0, "creation_date": 1548534735, "post_id": 54381339, "comment_id": 95577896, "body": "@b3lowster that&#39;s awesome! do accept my answer as the solution."}, {"owner": {"reputation": 345, "user_id": 1847148, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/66ab4f6d98da1b457df1c7ba446090ff?s=128&d=identicon&r=PG", "display_name": "b3lowster", "link": "https://stackoverflow.com/users/1847148/b3lowster"}, "edited": false, "score": 0, "creation_date": 1548540530, "post_id": 54381339, "comment_id": 95579362, "body": "What if I need to add one more submodel for instance github.com/stripe/stripe-go/payout what should I do? Project didn&#39;t have this module before"}, {"owner": {"reputation": 611, "user_id": 4281077, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3oOg40JdTy4/AAAAAAAAAAI/AAAAAAAAHNQ/jB3IczOZSFE/photo.jpg?sz=128", "display_name": "Karthik Nayak", "link": "https://stackoverflow.com/users/4281077/karthik-nayak"}, "reply_to_user": {"reputation": 345, "user_id": 1847148, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/66ab4f6d98da1b457df1c7ba446090ff?s=128&d=identicon&r=PG", "display_name": "b3lowster", "link": "https://stackoverflow.com/users/1847148/b3lowster"}, "edited": false, "score": 0, "creation_date": 1548540745, "post_id": 54381339, "comment_id": 95579412, "body": "@b3lowster <code>dep ensure &lt;pkg&gt;</code> should do it. Check here <a href=\"https://golang.github.io/dep/docs/daily-dep.html#using-dep-ensure\" rel=\"nofollow noreferrer\">golang.github.io/dep/docs/daily-dep.html#using-dep-ensure</a>. Basically when updating you&#39;ll face problems again, so the same solution would apply."}], "tags": [], "owner": {"reputation": 611, "user_id": 4281077, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3oOg40JdTy4/AAAAAAAAAAI/AAAAAAAAHNQ/jB3IczOZSFE/photo.jpg?sz=128", "display_name": "Karthik Nayak", "link": "https://stackoverflow.com/users/4281077/karthik-nayak"}, "is_accepted": true, "score": 1, "last_activity_date": 1548526780, "creation_date": 1548526780, "answer_id": 54381339, "question_id": 54379546, "link": "https://stackoverflow.com/questions/54379546/cannot-update-dependency-package-with-godeps/54381339#54381339", "title": "Cannot update dependency package with godeps", "body": "<p>I remember this issue, quoting from <a href=\"https://github.com/tools/godep/issues/164#issuecomment-101345584\" rel=\"nofollow noreferrer\">https://github.com/tools/godep/issues/164#issuecomment-101345584</a></p>\n\n<blockquote>\n  <p>This seems to be caused by this line here:\n  <a href=\"https://github.com/tools/godep/blob/master/update.go#L205\" rel=\"nofollow noreferrer\">https://github.com/tools/godep/blob/master/update.go#L205</a></p>\n  \n  <p>If packages A and B are under the same root, and I try to only update\n  B, the root will be marked for skipping update because A isn't being\n  updated. I'm not sure what the motivation for this feature is, it\n  seems that developers should be able to selectively update sub\n  packages as they desire.</p>\n  \n  <p>For what it's worth, I fixed my problem by globbing from the root in\n  my godep update command (e.g. godep update github.com/foo/bar/...\n  instead of github.com/foo/bar/pkg/B. A helpful error message would\n  have gone a long way</p>\n</blockquote>\n\n<p>While you're here, go 1.11 and above has inbuilt module support. Maybe look into shifting into that? <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"nofollow noreferrer\">https://github.com/golang/go/wiki/Modules</a></p>\n"}], "owner": {"reputation": 345, "user_id": 1847148, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/66ab4f6d98da1b457df1c7ba446090ff?s=128&d=identicon&r=PG", "display_name": "b3lowster", "link": "https://stackoverflow.com/users/1847148/b3lowster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 54381339, "answer_count": 1, "score": 0, "last_activity_date": 1548526780, "creation_date": 1548514592, "question_id": 54379546, "link": "https://stackoverflow.com/questions/54379546/cannot-update-dependency-package-with-godeps", "title": "Cannot update dependency package with godeps", "body": "<p>I need to update stripe-go library version.\nProject has 19.**\nNew version 52.**\nThere is a godeps dependency manager</p>\n\n<p>When I try to run</p>\n\n<blockquote>\n  <p>godep save github.com/stripe/stripe-go</p>\n</blockquote>\n\n<p>I get</p>\n\n<blockquote>\n  <p>godep: cannot save github.com/stripe/stripe-go/form at revision\n  f8b095462d541c43d981d28de52b7464b25f3ee1: already have\n  github.com/stripe/stripe-go at revision\n  87c04229ff0262e4e7dfc8af7dc97a471e955ba2.</p>\n  \n  <p>Run `godep update github.com/stripe/stripe-go' first.</p>\n</blockquote>\n\n<p>And when I run </p>\n\n<blockquote>\n  <p>godep update github.com/stripe/stripe-go</p>\n</blockquote>\n\n<p>I get</p>\n\n<blockquote>\n  <p>godep: no packages can be updated</p>\n</blockquote>\n\n<p>What do I do wrong?</p>\n"}, {"tags": ["json", "go"], "answers": [{"tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": true, "score": 3, "last_activity_date": 1548516182, "last_edit_date": 1548516182, "creation_date": 1548510773, "answer_id": 54379015, "question_id": 54378749, "link": "https://stackoverflow.com/questions/54378749/dynamically-creating-nested-maps-in-golang/54379015#54379015", "title": "Dynamically creating nested maps in golang", "body": "<p>In general, for cases like this you'll have to use the generic unmarshaling capability of <code>json.Unmarshal</code> into an <code>interface{}</code>. </p>\n\n<pre><code>b := []byte(`{ \"key1\": { \"key2\": { \"key3\": \"Found data\" } } } `)\nvar f interface{}\nif err := json.Unmarshal(b, &amp;f); err != nil {\n    panic(err)\n}\nfmt.Println(f)\n</code></pre>\n\n<p>And now you can use a bunch of type assertions to explore <code>f</code>, for example to find which keys it contains:</p>\n\n<pre><code>m := f.(map[string]interface{})\nfor k, v := range m {\n    if k == \"key3\" {\n        fmt.Println(\"found key3. maps to\", v)\n    }\n}\n</code></pre>\n\n<p>If you don't find key3 at this level, use recursion to check all the values - are <em>they</em> maps with key3 keys, and so on... Something like</p>\n\n<pre><code>func findNested(m map[string]interface{}, s string) (bool, interface{}) {\n    // Try to find key s at this level\n    for k, v := range m {\n        if k == s {\n            return true, v\n        }\n    }\n    // Not found on this level, so try to find it nested\n    for _, v := range m {\n        nm := v.(map[string]interface{})\n        found, val := findNested(nm, s)\n        if found {\n            return found, val\n        }\n    }\n    // Not found recursively\n    return false, nil\n}\n</code></pre>\n\n<p><em>Note: this function was quickly hacked together and probably mishandles a bunch of corner cases. It's here to demonstrate the key idea - use it as a basis for your specific needs</em></p>\n"}, {"tags": [], "owner": {"reputation": 599, "user_id": 7207673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CrIYf.png?s=128&g=1", "display_name": "Juan-Kabbali", "link": "https://stackoverflow.com/users/7207673/juan-kabbali"}, "is_accepted": false, "score": 0, "last_activity_date": 1614984639, "creation_date": 1614984639, "answer_id": 66500576, "question_id": 54378749, "link": "https://stackoverflow.com/questions/54378749/dynamically-creating-nested-maps-in-golang/66500576#66500576", "title": "Dynamically creating nested maps in golang", "body": "<p>Personally i love to use <a href=\"https://github.com/Jeffail/gabs\" rel=\"nofollow noreferrer\">gabs</a> module which allows to handle those kind of situation in a more human friendly way.</p>\n<hr />\n<p>For installing the module use:</p>\n<pre><code>go get github.com/Jeffail/gabs/v2\n</code></pre>\n<hr />\n<p>Handy usage examples</p>\n<pre class=\"lang-golang prettyprint-override\"><code>// jsonParsed var contains a set of functions to play arround\njsonParsed, _ := gabs.ParseJSON([]byte(`{\n    &quot;outter&quot;:{\n        &quot;inner&quot;:{\n            &quot;value1&quot;:10,\n            &quot;value2&quot;:22\n        },\n        &quot;alsoInner&quot;:{\n            &quot;value1&quot;:20,\n            &quot;array1&quot;:[\n                30, 40\n            ]\n        }\n    }\n}`))\n\n// for your case, it's useful Exists or ExistsP functions\nexists := jsonParsed.Exists(&quot;outter&quot;, &quot;inner&quot;, &quot;value1&quot;)\n// exists == true\n\nexists = jsonParsed.ExistsP(&quot;outter.inner.value3&quot;)\n// exists == false\n</code></pre>\n<p>As you need some of dynamic key search, you can use ChildrenMap function to iterate and validate the keys existence with the previous explained functions.</p>\n<pre class=\"lang-golang prettyprint-override\"><code>jsonParsed, err := gabs.ParseJSON([]byte(`{&quot;object&quot;:{&quot;first&quot;:1,&quot;second&quot;:2,&quot;third&quot;:3}}`))\nif err != nil {\n    panic(err)\n}\n\n// S is shorthand for Search\nfor key, child := range jsonParsed.S(&quot;object&quot;).ChildrenMap() {\n    fmt.Printf(&quot;key: %v, value: %v\\n&quot;, key, child.Data().(float64))\n    // here you can use Exists or ExistsP\n}\n// key: first, value: 1\n// key: second, value: 2\n// key: third, value: 3\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 10548774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4a7a21d3f381f8dfbefd009871b4b26?s=128&d=identicon&r=PG&f=1", "display_name": "dircrys", "link": "https://stackoverflow.com/users/10548774/dircrys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1127, "favorite_count": 0, "accepted_answer_id": 54379015, "answer_count": 2, "score": 1, "last_activity_date": 1614984639, "creation_date": 1548508771, "question_id": 54378749, "link": "https://stackoverflow.com/questions/54378749/dynamically-creating-nested-maps-in-golang", "title": "Dynamically creating nested maps in golang", "body": "<p>I'm trying to interpret JSONs in Golang. I'm searching for a specific attribute in an unknown JSON which I know the keys for but my JSON might be really nested. I do know how many 'layers' there are in my JSON.</p>\n\n<p>For example, if my JSON is:</p>\n\n<pre><code>nestedJson = { key1: { key2: { key3: \"Found data\" } } } \n</code></pre>\n\n<p>my keys are [\"key1\", \"key2\", \"key3\"] and there are 3 layers in this JSON so I can get the data back out by doing</p>\n\n<pre><code>var nestedJson = []map[string]map[string]map[string]interface{}\njson.Unmarshal([]byte(nestedJon), &amp;nestedJson)\ndata := nestedJson[\"key1][\"key2\"][\"key3\"]\n</code></pre>\n\n<p>What I want to be able to do is dynamically create that nestedJson object by specifying an integer value for the number of layers is should search through.</p>\n\n<p>Can anyone help with this? Please let me know if I haven't been clear enough!</p>\n"}, {"tags": ["go", "revel"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1548516599, "post_id": 54378637, "comment_id": 95573032, "body": "It&#39;s called embedding in go, i.e. <code>App</code> <i>embeds</i> <code>*revel.Controller</code>. A value of type <code>*T</code> is called a pointer to <code>T</code>. So in english that piece of code would translate into <i>&quot;App embeds a pointer to revel.Controller&quot;</i>. Before you try to learn a Go framework I would recommend you take the <a href=\"https://tour.golang.org/welcome/1\" rel=\"nofollow noreferrer\">Go Tour</a> to acquaint yourself with these basic Go concepts, otherwise your speed of learning that framework will be heavily impaired."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 1, "creation_date": 1548518292, "post_id": 54378637, "comment_id": 95573486, "body": "Golang has no classes, and no inheritance. Saying <code>App</code> is derived from <code>Controller</code> class is all shades of wrong. What you have there is called an embedded type, which means <code>App</code> is a struct that contains <code>Controller</code>, and allows for the exported <code>Controller</code> fields to be accessed directly (if no fields conflict). The asterisk means you need to initialise the <code>App</code> type with an embedded <i>pointer</i> to <code>Controller</code>.  <b>Note: Revel is by many considered harmful</b>"}, {"owner": {"reputation": 5894, "user_id": 4746206, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/aeb5a68770c5420348fb112d7e082436?s=128&d=identicon&r=PG&f=1", "display_name": "Bob5421", "link": "https://stackoverflow.com/users/4746206/bob5421"}, "edited": false, "score": 0, "creation_date": 1548518393, "post_id": 54378637, "comment_id": 95573505, "body": "Thanks for your answers. Why revel is considered harmul ? With which framework are you working ?"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 1, "creation_date": 1548535406, "post_id": 54378637, "comment_id": 95578056, "body": "@Bob5421: Revel is harmful because it&#39;s trying to be an MVC framework. Golang wasn&#39;t intended to be used like that. Golang, as a language, is designed for small services that don&#39;t serve up fully templated pages. The templating bit is more commonly used for code generation than it is to render websites. TL;DR: most of the time, golang isn&#39;t used with a framework, but rather with packages like gorilla/mux and some stuff from go-kit. Not a full stack framework"}], "owner": {"reputation": 5894, "user_id": 4746206, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/aeb5a68770c5420348fb112d7e082436?s=128&d=identicon&r=PG&f=1", "display_name": "Bob5421", "link": "https://stackoverflow.com/users/4746206/bob5421"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548507930, "creation_date": 1548507930, "question_id": 54378637, "link": "https://stackoverflow.com/questions/54378637/revel-controller-declaration-syntax", "title": "revel Controller declaration syntax", "body": "<p>I am new to golang revel framework.</p>\n\n<p>I have read revel tutorials and i see this lines at the top of each controller file:</p>\n\n<pre><code>type App struct {\n    *revel.Controller\n}\n</code></pre>\n\n<p>I suppose this mean my App class is derivated from Controller class.</p>\n\n<p>Warning: i know the object model is not the same comparing to C++. I do not really think the word \"derivated\" are corrects in go...</p>\n\n<p>My question is: What is the role of the asterix (*) before revel.Controller ?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "interface", "polymorphism"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1548506826, "post_id": 54377597, "comment_id": 95570504, "body": "Don&#39;t include screen shots of text. Copy and paste the text instead. If you must include an image, include it directly, rather than as a link."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1548508301, "post_id": 54377597, "comment_id": 95570865, "body": "Your <code>speak</code> requires a <code>[]Animal</code> but you try to call it with a <code>[]Cat</code>. This is wrong. It is like trying to call <code>speak</code> with a <code>[]map[float64]uint16</code>. The two types <code>[]Cat</code> and <code>[]Animal</code> have nothing in common. The fact that Cat implements Animal has <b>no</b> <b>importance</b> whatsoever on the relation between the types <code>[]Cat</code> and <code>[]Animal</code>. Stop trying to do inheritance based OOP in Go now and forever unless you want to hurt yourself: It <b>does</b> <b>not</b> <b>work</b>."}], "answers": [{"comments": [{"owner": {"reputation": 267, "user_id": 10971002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3206b8273979b26e16a39d7f3db015e?s=128&d=identicon&r=PG&f=1", "display_name": "kike", "link": "https://stackoverflow.com/users/10971002/kike"}, "edited": false, "score": 0, "creation_date": 1548500374, "post_id": 54377640, "comment_id": 95569073, "body": "I am worried about the performance of that solution, it has to make a lof of conversions for every element in the array. From a point of view of clean and readable code, I can use this solution, but I think that making a specific method for every element (array of cats and array of dogs) will be more performance, because we don&#39;t need to make this conversions for every element, but it will be a lot of redundant code, because we have the same method duplicated for different types, this is the limitation of the language? Or go for readability or go for performance? There is no combined solution?"}, {"owner": {"reputation": 154, "user_id": 3093816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TNTDF.jpg?s=128&g=1", "display_name": "Alex Sharov", "link": "https://stackoverflow.com/users/3093816/alex-sharov"}, "reply_to_user": {"reputation": 267, "user_id": 10971002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3206b8273979b26e16a39d7f3db015e?s=128&d=identicon&r=PG&f=1", "display_name": "kike", "link": "https://stackoverflow.com/users/10971002/kike"}, "edited": false, "score": 0, "creation_date": 1548501131, "post_id": 54377640, "comment_id": 95569238, "body": "Yes, this is limitation of language, but in real life it\u2019s very rare problem (you implementing example from OOP book, but in real life such code I saw very rare). Instead of \u201cworry about performance\u201d, just measure it - run benchmark with -benchmem and -benchcpu flags, you will see which lines are actually slow and which are fast."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "reply_to_user": {"reputation": 267, "user_id": 10971002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3206b8273979b26e16a39d7f3db015e?s=128&d=identicon&r=PG&f=1", "display_name": "kike", "link": "https://stackoverflow.com/users/10971002/kike"}, "edited": false, "score": 2, "creation_date": 1548508245, "post_id": 54377640, "comment_id": 95570849, "body": "@kike, &quot;I am worried about the performance of that solution&quot; That is precisely why Go doesn&#39;t do it for you. It doesn&#39;t want to hide <a href=\"https://golang.org/doc/faq#convert_slice_of_interface\" rel=\"nofollow noreferrer\">a potentially expensive conversion</a> from the programmer. Having to write the loop makes the cost clear as day."}], "tags": [], "owner": {"reputation": 154, "user_id": 3093816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TNTDF.jpg?s=128&g=1", "display_name": "Alex Sharov", "link": "https://stackoverflow.com/users/3093816/alex-sharov"}, "is_accepted": true, "score": 2, "last_activity_date": 1548510091, "last_edit_date": 1548510091, "creation_date": 1548499602, "answer_id": 54377640, "question_id": 54377597, "link": "https://stackoverflow.com/questions/54377597/how-to-make-a-function-that-receives-an-array-of-custom-interface/54377640#54377640", "title": "How to make a function that receives an array of custom interface", "body": "<p>Go can\u2019t type cast arrays. You need to create new array of target type manually, then use for loop to type cast each element of source array and put result to target array. </p>\n\n<p>Reason: go doesn\u2019t hide from you memory allocations, this is reason why you need to create new and feel it manually. </p>\n\n<p><a href=\"https://golang.org/doc/faq#convert_slice_of_interface\" rel=\"nofollow noreferrer\">https://golang.org/doc/faq#convert_slice_of_interface</a></p>\n"}, {"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 0, "last_activity_date": 1548521936, "creation_date": 1548521936, "answer_id": 54380582, "question_id": 54377597, "link": "https://stackoverflow.com/questions/54377597/how-to-make-a-function-that-receives-an-array-of-custom-interface/54380582#54380582", "title": "How to make a function that receives an array of custom interface", "body": "<p>A fixed version, on <a href=\"https://play.golang.org/p/t9-4KBfWUzH\" rel=\"nofollow noreferrer\">Play</a></p>\n\n<p>As others have mentioned, there is no automatic type coercion in Go.\nAnd []Cat is totally different than []Animal.</p>\n\n<p>All you really needed to do was create a slice of the type you will pass to the <code>speaks</code> method.<br>\nSo, change:</p>\n\n<pre><code>arrayCats := []Cat{cat1, cat2, cat3}\n</code></pre>\n\n<p>to</p>\n\n<pre><code>arrayCats := []Animal{cat1, cat2, cat3}\n</code></pre>\n\n<p>And it works fine.</p>\n\n<p>If you are used to languages like Java, they go about this in a really different way in that java treats all things as an <code>Object</code>.  So, when they added generics it was a simple compile time trick where the collection was really just a list of <code>Object</code> and the compiler inserts a cast at the extraction point.</p>\n\n<p>Things like <code>int</code> are not objects in java which is why you can't create a <code>List&lt;int&gt;</code>, because then the <code>List&lt;Object&gt;</code> casting trick wouldn't work.  Because <code>int</code> isn't a subclass of <code>Object</code>.</p>\n\n<p>In go, there's no common base type for things like struct, so there's no real way to do the cast trick that java does.</p>\n\n<p>As others have mentioned, there are also some specific features on how go manages memory that makes things like auto-conversion not work in a generic way (ie: a slice of int64 is a different memory footprint than a slice of int32, so not castable without allocation).</p>\n\n<p>the go team has stated they are looking in to adding generics in some form, which would potentially make things like this easier to write.   But that will come with a cost of invisible runtime or compile time complexity (or both).</p>\n\n<p>Today, since it is not automatic, you have to write the code to do the conversion. \n Which has the downside of you write more code.  And the upside of it being obvious what's happening in the system.</p>\n"}], "owner": {"reputation": 267, "user_id": 10971002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3206b8273979b26e16a39d7f3db015e?s=128&d=identicon&r=PG&f=1", "display_name": "kike", "link": "https://stackoverflow.com/users/10971002/kike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 0, "accepted_answer_id": 54377640, "answer_count": 2, "score": -1, "last_activity_date": 1548521936, "creation_date": 1548499197, "last_edit_date": 1548506759, "question_id": 54377597, "link": "https://stackoverflow.com/questions/54377597/how-to-make-a-function-that-receives-an-array-of-custom-interface", "title": "How to make a function that receives an array of custom interface", "body": "<p>I am getting deep into the Go architecture and I have problems with polymorphism. I simplified the problem and created new data for this example to be much more understandable my question.</p>\n\n<p>I have this structure:</p>\n\n<pre><code>type Animal interface {\n    speak() string\n}\n\ntype Cat struct {\n    Name string\n}\n\ntype Dog struct {\n    Race string\n}\n</code></pre>\n\n<p>And I want the structs to implement the interface, I proceed like that:</p>\n\n<pre><code>   func (c Cat) speak() string {\n    return \"Miaw!\"\n}\n\nfunc (d Dog) speak() string {\n    return \"Guau!\"\n}\n\nfunc speak(a Animal) string {\n    return a.speak()\n}\n\nfunc speaks(a []Animal) string {\n    str := \"\"\n    for i := 0; i &lt; len(a); i++ {\n        str += a[i].speak()\n    }\n    return str\n}\n</code></pre>\n\n<p>So what I have created is: \nThe method <code>speak</code> receives an <code>Animal</code> and executes the method speak of the structure given (<code>Animal</code>, which is <code>Cat</code> or <code>Dog</code>), and the method <code>speaks</code> receive an slice of <code>Animal</code> and executes the method speak of the structure given in every index of the slice (<code>Animal</code>, which is <code>Cat</code> or <code>Dog</code>).</p>\n\n<p>And for testing the methods, I implemented this function:</p>\n\n<pre><code>func test()  {\n    cat1 := Cat{\n        Name: \"Cat1\",\n    }\n\n    cat2 := Cat{\n        Name: \"Cat2\",\n    }\n\n    cat3 := Cat{\n        Name: \"Cat3\",\n    }\n\n    arrayCats := []Cat{cat1, cat2, cat3}\n    speak(cat1)\n    speak(cat3)\n    speak(cat2)\n    speaks(arrayCats) //This line gives an error to the Compiler\n}\n</code></pre>\n\n<p>I upload the error that the compiler gives to me:</p>\n\n<p><a href=\"https://i.stack.imgur.com/19z5O.png\" rel=\"nofollow noreferrer\">Error_compiler</a></p>\n\n<p>Can someone please explain to me why I can play with polimorfish in a functions that receives only one element and why not in the function that receives an slice of that element?</p>\n\n<p>I really need to find the solution to this problem to implement it in different parts of my application, and I have no idea how to solve the problem nor how to implement a practical and scalable solution (the slice in the real application will contain a hight number of elements).</p>\n\n<p>I found this answers related useful to understand more my problem, but still I don't get what is the problem or the solution:\n<a href=\"https://stackoverflow.com/questions/40823315/x-does-not-implement-y-method-has-a-pointer-receiver\">Answer1</a>\n<a href=\"https://stackoverflow.com/questions/40806029/in-go-how-do-i-pass-a-slice-of-interface-to-something-that-expects-slice-of-a-d\">Answer2</a><a href=\"https://stackoverflow.com/questions/43366452/slice-of-a-specific-interface-in-go\">Answer3</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 3, "creation_date": 1548485927, "post_id": 54376250, "comment_id": 95566581, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/28058278/how-do-i-reverse-a-slice-in-go\">How do I reverse a slice in go?</a>.   The sort.Reverse function reverses the sort order. The function does not reverse an array or slice. Explain why you want to use the sort package."}, {"owner": {"reputation": 1137, "user_id": 2660766, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qiIdj.png?s=128&g=1", "display_name": "maksadbek", "link": "https://stackoverflow.com/users/2660766/maksadbek"}, "edited": false, "score": 0, "creation_date": 1548486189, "post_id": 54376250, "comment_id": 95566619, "body": "What is your criteria to sort strings and what is your data ? Sort function for string slices uses only the first letter of words. Moreover, the example that you provided has a slice, not an array, see: <a href=\"https://gobyexample.com/arrays\" rel=\"nofollow noreferrer\">gobyexample.com/arrays</a>"}, {"owner": {"reputation": 2244, "user_id": 1797057, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/89339651e138f8c169f4f1dd0fe6261a?s=128&d=identicon&r=PG", "display_name": "Jackal", "link": "https://stackoverflow.com/users/1797057/jackal"}, "edited": false, "score": 0, "creation_date": 1548486301, "post_id": 54376250, "comment_id": 95566634, "body": "sort.Sort(sort.Reverse(sort.StringSlice(strArr))) //sorts the array in the reverse order. I just want to reverse the array or slice in go; Looks like we don&#39;t have a reverse method in go; some thing like this in javascript : strArr.reverse()"}, {"owner": {"reputation": 1137, "user_id": 2660766, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qiIdj.png?s=128&g=1", "display_name": "maksadbek", "link": "https://stackoverflow.com/users/2660766/maksadbek"}, "edited": false, "score": 0, "creation_date": 1548486401, "post_id": 54376250, "comment_id": 95566647, "body": "<a href=\"https://play.golang.com/p/yO2u0wcLnwN\" rel=\"nofollow noreferrer\">play.golang.com/p/yO2u0wcLnwN</a> take a look in the example, it does not reverse the slice as [&quot;three&quot;, &quot;two&quot;, &quot;one&quot;]."}, {"owner": {"reputation": 2244, "user_id": 1797057, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/89339651e138f8c169f4f1dd0fe6261a?s=128&d=identicon&r=PG", "display_name": "Jackal", "link": "https://stackoverflow.com/users/1797057/jackal"}, "reply_to_user": {"reputation": 1137, "user_id": 2660766, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qiIdj.png?s=128&g=1", "display_name": "maksadbek", "link": "https://stackoverflow.com/users/2660766/maksadbek"}, "edited": false, "score": 0, "creation_date": 1548486710, "post_id": 54376250, "comment_id": 95566690, "body": "@maksadbek  expected Result : [&quot;three&quot;, &quot;two, &quot;one&quot;]; The solution above is incorrect."}, {"owner": {"reputation": 1137, "user_id": 2660766, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qiIdj.png?s=128&g=1", "display_name": "maksadbek", "link": "https://stackoverflow.com/users/2660766/maksadbek"}, "edited": false, "score": 0, "creation_date": 1548487230, "post_id": 54376250, "comment_id": 95566774, "body": "@Jackal It is not a solution. It is showing that standard sort function does not fit your requirements. As I wrote above, the sort function sorts by the <b>first letter</b> of words, not the whole word. It does not distinguish the difference between &quot;three&quot; and &quot;two&quot;. You can use <a href=\"https://godoc.org/sort#Slice\" rel=\"nofollow noreferrer\">godoc.org/sort#Slice</a> with custom comparator function."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1548493021, "post_id": 54376250, "comment_id": 95567744, "body": "There is no function for that in the standard library, much less in the sort package. But it&#39;s simple enough to write it yourself: <a href=\"https://play.golang.org/p/wp062yG-Ab4\" rel=\"nofollow noreferrer\">play.golang.org/p/wp062yG-Ab4</a>"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": -2, "last_activity_date": 1548496497, "last_edit_date": 1548496497, "creation_date": 1548494943, "answer_id": 54377160, "question_id": 54376250, "link": "https://stackoverflow.com/questions/54376250/how-to-reverse-string-slice-using-sort-package-in-go/54377160#54377160", "title": "How to reverse string slice using sort package in Go?", "body": "<blockquote>\n  <p>Comment: Something like this in JavaScript : strArr.reverse(). \u2013 Jackal</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reverse\" rel=\"nofollow noreferrer\">JavaScript: Array.prototype.reverse()</a></p>\n  \n  <p>The reverse() method reverses an array in place. The first array\n  element becomes the last, and the last array element becomes the\n  first.</p>\n</blockquote>\n\n<hr>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc reverse(s []string) {\n    for i, j := 0, len(s)-1; i &lt; j; i, j = i+1, j-1 {\n        s[i], s[j] = s[j], s[i]\n    }\n}\n\nfunc main() {\n    strArr := []string{\"one\", \"two\", \"three\"}\n    fmt.Println(strArr)\n    reverse(strArr)\n    fmt.Println(strArr)\n    reverse(strArr)\n    fmt.Println(strArr)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/087uE00WROI\" rel=\"nofollow noreferrer\">https://play.golang.org/p/087uE00WROI</a></p>\n\n<p>Output:</p>\n\n<pre><code>[one two three]\n[three two one]\n[one two three]\n</code></pre>\n"}], "owner": {"reputation": 2244, "user_id": 1797057, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/89339651e138f8c169f4f1dd0fe6261a?s=128&d=identicon&r=PG", "display_name": "Jackal", "link": "https://stackoverflow.com/users/1797057/jackal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 786, "favorite_count": 1, "answer_count": 1, "score": -3, "last_activity_date": 1548496497, "creation_date": 1548484688, "last_edit_date": 1548494009, "question_id": 54376250, "link": "https://stackoverflow.com/questions/54376250/how-to-reverse-string-slice-using-sort-package-in-go", "title": "How to reverse string slice using sort package in Go?", "body": "<pre><code>strArr := []string{\"one\", \"two\", \"three\"}\n// expected Result : [\"three\", \"two, \"one\"]\n</code></pre>\n\n<p>I want to do this using the <a href=\"https://golang.org/pkg/sort/\" rel=\"nofollow noreferrer\">sort package</a></p>\n"}, {"tags": ["go", "dns"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548516921, "post_id": 54375257, "comment_id": 95573110, "body": "If you have performance issues, then you start by profiling. If I were to guess, the next step would be to have a pool of reusable buffers, rather than allocating new ones for every packet. Then maybe a fixed pool of handlers so you can buffer requests that you can&#39;t handle immediately. (also, don&#39;t ignore errors)"}], "answers": [{"tags": [], "owner": {"reputation": 446, "user_id": 2428640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97cdaaaa61e5541b98a01bbdfbdcff09?s=128&d=identicon&r=PG", "display_name": "Pascal de Kloe", "link": "https://stackoverflow.com/users/2428640/pascal-de-kloe"}, "is_accepted": false, "score": 0, "last_activity_date": 1548548176, "creation_date": 1548548176, "answer_id": 54384013, "question_id": 54375257, "link": "https://stackoverflow.com/questions/54375257/go-networking-best-practices-for-udp-server/54384013#54384013", "title": "Go networking best practices for UDP server", "body": "<p>Unfortunately Go's UDP support is suboptimal. The implementation allocates memory. What helps a bit is to run the loop in parallel. Increased buffer sizes on OS level limit package loss.</p>\n"}], "owner": {"reputation": 53, "user_id": 10647583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad9763120996efab32e1de3f36006228?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/10647583/francis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 829, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1548548176, "creation_date": 1548470616, "question_id": 54375257, "link": "https://stackoverflow.com/questions/54375257/go-networking-best-practices-for-udp-server", "title": "Go networking best practices for UDP server", "body": "<p>I'm writing a DNS server in Go to learn how DNS works and how to write a real, potentially useful program in Go.</p>\n\n<p>One of the reasons I chose Go was for its Go routines instead of threads.</p>\n\n<p>Currently, my DNS server doesn't really do much, it sends the same response for every query it receives.</p>\n\n<p>One thing that confuses me is that my DNS server, even with its Go routines and even though it's small and doesn't do much is 10x slower than BIND.</p>\n\n<p>I ran a program called <code>dnsblast</code> to send lots of DNS queries at once and these are my results:</p>\n\n<pre><code>BIND\nSending 10,000 queries = 39,000 pps\n\nMy server\nSending 10,000 queries = 3,000 pps\n</code></pre>\n\n<p>Also, as I increase the number of packets I send per second, the server responds to less and less of the queries.</p>\n\n<p>For example:\nWhen sending 1,000 queries, the server responds to 100%, but when sending 10,000 queries the server responds to just 66%.</p>\n\n<p>Is there anything to do with networking in Go that could be limiting the performance of my DNS server? Are there settings in Go I can configure?</p>\n\n<p>Currently, the main program looks like this:</p>\n\n<pre><code>func main() {\n\n    serv, err := net.ListenPacket(\"udp\", \":53\")\n\n    if err != nil {\n        panic(err)\n    }\n\n    defer serv.Close()\n\n    for {\n        tmp := make([]byte, 512)\n        num_bytes, addr, _ := serv.ReadFrom(tmp)\n        go handleQuery(serv, bytes.NewBuffer(tmp[:num_bytes]), addr)\n    }\n\n}\n</code></pre>\n\n<p>This seems to be a pretty standard way of creating a server in Go from what I've read online.</p>\n\n<ol>\n<li>Listen for packets</li>\n<li>Save packet data in a buffer</li>\n<li>Process each packet using a separate Go routine.</li>\n</ol>\n\n<p>Are there any best practices to improve my server's throughput or does the server look okay and it's just my partial DNS implementation is slow?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go", "circleci"], "answers": [{"comments": [{"owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "edited": false, "score": 0, "creation_date": 1548537002, "post_id": 54381107, "comment_id": 95578468, "body": "Thank you very much, 1+, now the issue is that the jobs running on the master, should I create another workflow for all the PR branches ? if there is any example it will be great"}, {"owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "edited": false, "score": 0, "creation_date": 1548538524, "post_id": 54381107, "comment_id": 95578839, "body": "I look at the docs and its a bit confusing. what i need that for each <code>PR</code> the <code>build job</code> will run and for merge to the master the <code>build and test-integration</code> will be executed"}, {"owner": {"reputation": 19007, "user_id": 444646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/996ae88559e4c401582326971c77c75a?s=128&d=identicon&r=PG", "display_name": "dnephin", "link": "https://stackoverflow.com/users/444646/dnephin"}, "reply_to_user": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "edited": false, "score": 0, "creation_date": 1548628999, "post_id": 54381107, "comment_id": 95598831, "body": "My example would do what you want. You don&#39;t need two workflows. You want a single workflow, where one of the jobs only runs on master.  If you want to use two workflows you need to add <code>build</code> to the list of jobs in the second one."}, {"owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "edited": false, "score": 0, "creation_date": 1548708443, "post_id": 54381107, "comment_id": 95631011, "body": "Thanks, im closing the question, it will be great if you can add example (update your answer)  of what you mean.... thanks a  lot"}], "tags": [], "owner": {"reputation": 19007, "user_id": 444646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/996ae88559e4c401582326971c77c75a?s=128&d=identicon&r=PG", "display_name": "dnephin", "link": "https://stackoverflow.com/users/444646/dnephin"}, "is_accepted": true, "score": 1, "last_activity_date": 1548525334, "creation_date": 1548525334, "answer_id": 54381107, "question_id": 54373567, "link": "https://stackoverflow.com/questions/54373567/runnig-tasks-only-when-merging-to-master/54381107#54381107", "title": "Runnig tasks only when merging to master", "body": "<p>Your configuration has a single job named <code>build</code> and no workflows. It sounds like what you want is to run a second job for integration tests, and to have the second job only run when the branch is master. To accomplish both of those you would use a workflow with two jobs. </p>\n\n<p>See <a href=\"https://circleci.com/docs/2.0/configuration-reference/#workflows\" rel=\"nofollow noreferrer\">https://circleci.com/docs/2.0/configuration-reference/#workflows</a></p>\n\n<p>An example of what that might look like:</p>\n\n<pre><code>jobs:\n  build:\n    docker:\n     - image: circleci/golang:1.11\n    ...\n\n  test-integration:\n    docker:\n      - image: other-image\n    ...\n\nworkflows:\n  version: 2\n  workflow-name:\n    jobs: \n      - build\n      - test-integration:\n          filters:\n            branches:\n              only: master\n</code></pre>\n"}], "owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 666, "favorite_count": 1, "accepted_answer_id": 54381107, "answer_count": 1, "score": 1, "last_activity_date": 1548595753, "creation_date": 1548454908, "last_edit_date": 1548595753, "question_id": 54373567, "link": "https://stackoverflow.com/questions/54373567/runnig-tasks-only-when-merging-to-master", "title": "Runnig tasks only when merging to master", "body": "<p>I use the following config which works as expected, it run the command on each PR or merge to the master, Now I want to make some integration test which I want to run <strong>only when merged to the master</strong>, all the PR should remain the same (and run the following config as before). the nuance here is that for the integration test I need <strong>other docker image and different run command to execute</strong> (which should execute only when merging to the master), is it possible to do it with CircleCI ?</p>\n\n<pre><code># Golang CircleCI 2.0 configuration file\nversion: 2\njobs:\n  build:\n    docker:\n      # specify the version\n      - image: circleci/golang:1.11\n    working_directory: /go/src/sbr\n    steps:\n      - checkout\n      - run: go version\n      - run: go env\n      - run: go get -v -t -d ./...\n      - run: go test -v ./...\n</code></pre>\n\n<p>I try to add another docker image under the existing one but I got error </p>\n\n<p><strong>update:</strong></p>\n\n<pre><code>version: 2\njobs:\n  build:\n    docker:\n      - image: circleci/golang:1.11\n    working_directory: /go/src/sbr\n    steps:\n      - checkout\n      - run: go version\n      - run: go env\n      - run: go get -v -t -d ./...\n      - run: go test -v ./...\n\n  test-integration:\n    docker:\n      - image: other-image\n\nworkflows:\n  version: 2\n  builds:\n    jobs:\n      - build\n\n  integration-test:\n    jobs:\n      - test-integration:\n          requires:\n            - build\n          filters:\n            branches:\n              only: master\n</code></pre>\n\n<p>The issue here that I got error when adding to the second workflow the <code>require</code> </p>\n\n<pre><code>  requires:\n    - build \n</code></pre>\n\n<p>I want that <strong>before</strong> the test <code>test-integration</code> it will also run the <code>build</code> job as per-requiste . what im doing wrong ? </p>\n\n<p><em>The error is:</em></p>\n\n<pre><code>requires job \\\"build\\\" but \\\"build\\\" is not part of this workflow.\n# At least one job in the workflow must have no dependencies.\n# The following jobs are unreachable: integration\n# \n# -------\n\n# Don't rerun this job. Rerunning will have no effect.\nfalse\n</code></pre>\n"}, {"tags": ["api", "go", "gmail"], "comments": [{"owner": {"reputation": 611, "user_id": 4281077, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3oOg40JdTy4/AAAAAAAAAAI/AAAAAAAAHNQ/jB3IczOZSFE/photo.jpg?sz=128", "display_name": "Karthik Nayak", "link": "https://stackoverflow.com/users/4281077/karthik-nayak"}, "edited": false, "score": 0, "creation_date": 1548458503, "post_id": 54373144, "comment_id": 95562572, "body": "I see a lot of <code>err</code> not being captured, could you capture them please?"}, {"owner": {"reputation": 11, "user_id": 10969525, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YNoYIONu7ag/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNn5jqBW2_MWQfEmnh5sIDIVfcIkQ/mo/photo.jpg?sz=128", "display_name": "Muhammad", "link": "https://stackoverflow.com/users/10969525/muhammad"}, "reply_to_user": {"reputation": 611, "user_id": 4281077, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3oOg40JdTy4/AAAAAAAAAAI/AAAAAAAAHNQ/jB3IczOZSFE/photo.jpg?sz=128", "display_name": "Karthik Nayak", "link": "https://stackoverflow.com/users/4281077/karthik-nayak"}, "edited": false, "score": 0, "creation_date": 1548692030, "post_id": 54373144, "comment_id": 95622719, "body": "@karthik-nayak i didn&#39;t capture errors for simplicity of code, in my real program i captured errors."}], "owner": {"reputation": 11, "user_id": 10969525, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YNoYIONu7ag/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNn5jqBW2_MWQfEmnh5sIDIVfcIkQ/mo/photo.jpg?sz=128", "display_name": "Muhammad", "link": "https://stackoverflow.com/users/10969525/muhammad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 308, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548476010, "creation_date": 1548452445, "last_edit_date": 1548476010, "question_id": 54373144, "link": "https://stackoverflow.com/questions/54373144/googleapi-error-400-bad-request-failedprecondition", "title": "googleapi: Error 400: Bad Request, failedPrecondition", "body": "<p>I'm trying to get message information from the Google API using a service account and a JWT.</p>\n\n<p>I've already enabled Domain wide delegation. I should probably mention that I'm not a GSuite admin, just a user who is trying to get messages from my own Inbox using a Go script.</p>\n\n<pre><code>func main() {\n    data, err := ioutil.ReadFile(\"JWT_Credentials.json\")\n\n    conf, err := google.JWTConfigFromJSON(data, gmail.GmailReadonlyScope)\n    client := conf.Client(oauth2.NoContext)\n\n    // Create a new gmail service using the client\n    gmailService, err := gmail.New(client)\n\n    fullMessage, err := gmailService.Users.Messages.Get(\"me\", message.Id).Format(\"metadata\").Do()\n    if err != nil {\n         log.Printf(\"Error: %v\", err)\n    }\n}\n</code></pre>\n\n<p>and my JWT credentials are as follows:</p>\n\n<pre><code>{\n    \"type\": \"service_account\",\n    \"project_id\": \"PROJECT_ID\",\n    \"private_key_id\": \"PRIVATE_KEY_ID\",\n    \"private_key\": \"-----BEGIN PRIVATE KEY-----\\PRIVATE_KEY\",\n    \"client_email\": \"SERVICE@PROJECT_ID.iam.gserviceaccount.com\",\n    \"client_id\": \"CLIENT_ID\",\n    \"auth_uri\": \"https://accounts.google.com/o/oauth2/auth\",\n    \"token_uri\": \"https://oauth2.googleapis.com/token\",\n    \"auth_provider_x509_cert_url\": \n    \"https://www.googleapis.com/oauth2/v1/certs\",\n    \"client_x509_cert_url\": \"CERT_URL\"\n}\n</code></pre>\n\n<p>I get the following error when the code runs:</p>\n\n<pre><code> googleapi: Error 400: Bad Request, failedPrecondition\n</code></pre>\n\n<p>If anybody has the solution to this problem or has encountered it in the past, please help me out!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 124, "user_id": 10453847, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YmiFkSNOI2U/AAAAAAAAAAI/AAAAAAAAAAA/27F0Sz6a-F8/photo.jpg?sz=128", "display_name": "Don Simon", "link": "https://stackoverflow.com/users/10453847/don-simon"}, "edited": false, "score": 4, "creation_date": 1548451373, "post_id": 54372880, "comment_id": 95560346, "body": "Compare the results of running \u201cenv\u201d from the command-line, with what you are getting when you run it under the go compiler.  Likely go is setting those variables as part of starting \u201cgo\u201d, and they don\u2019t exist once that instance of go exits."}, {"owner": {"reputation": 412, "user_id": 4698963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/96vU1.jpg?s=128&g=1", "display_name": "ethanchewy", "link": "https://stackoverflow.com/users/4698963/ethanchewy"}, "reply_to_user": {"reputation": 124, "user_id": 10453847, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YmiFkSNOI2U/AAAAAAAAAAI/AAAAAAAAAAA/27F0Sz6a-F8/photo.jpg?sz=128", "display_name": "Don Simon", "link": "https://stackoverflow.com/users/10453847/don-simon"}, "edited": false, "score": 0, "creation_date": 1548451469, "post_id": 54372880, "comment_id": 95560382, "body": "@DonSimon. You were right. Thank you!"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1548452320, "post_id": 54372880, "comment_id": 95560710, "body": "They&#39;re defaults."}], "answers": [{"tags": [], "owner": {"reputation": 2254, "user_id": 420096, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/988ae614387d311ba767cb053f77b915?s=128&d=identicon&r=PG", "display_name": "Sombriks", "link": "https://stackoverflow.com/users/420096/sombriks"}, "is_accepted": true, "score": 4, "last_activity_date": 1548451267, "creation_date": 1548451267, "answer_id": 54372922, "question_id": 54372880, "link": "https://stackoverflow.com/questions/54372880/although-gopath-is-set-echo-gopath-returns-nothing/54372922#54372922", "title": "Although GOPATH is set, echo $GOPATH returns nothing", "body": "<p>This is the <a href=\"https://rakyll.org/default-gopath/\" rel=\"nofollow noreferrer\">default value</a> for GOPATH.</p>\n\n<p>Since it's never set, go will use it's reasonable default.</p>\n\n<p>Main consquence of course is all your go projects sharing this $GOPATH.</p>\n"}, {"tags": [], "owner": {"reputation": 412, "user_id": 4698963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/96vU1.jpg?s=128&g=1", "display_name": "ethanchewy", "link": "https://stackoverflow.com/users/4698963/ethanchewy"}, "is_accepted": false, "score": 4, "last_activity_date": 1548451892, "creation_date": 1548451892, "answer_id": 54373058, "question_id": 54372880, "link": "https://stackoverflow.com/questions/54372880/although-gopath-is-set-echo-gopath-returns-nothing/54373058#54373058", "title": "Although GOPATH is set, echo $GOPATH returns nothing", "body": "<p>Thank you @DonSimon (<a href=\"https://stackoverflow.com/users/10453847/don-simon\">https://stackoverflow.com/users/10453847/don-simon</a>) for pointing me in the right direction.  </p>\n\n<p>So, while my go environment variables were set up correctly and <code>go env</code> returned the correct env. variables, it wasn't set in my bash shell. </p>\n\n<p>I just followed the instructions of setting the GOPATH automatically in my terminal: <a href=\"https://github.com/golang/go/wiki/SettingGOPATH#bash\" rel=\"nofollow noreferrer\">enter link description here</a></p>\n\n<p>Specifically, I did this since I don't have <code>.bash_profile</code>:</p>\n\n<ol>\n<li><code>vi ~/.bashrc</code></li>\n<li>Added the following line of code at the bottom of the code: <code>export GOPATH=$HOME/go\n</code></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 343, "user_id": 3428611, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/HGqvd.jpg?s=128&g=1", "display_name": "deeps", "link": "https://stackoverflow.com/users/3428611/deeps"}, "is_accepted": false, "score": 0, "last_activity_date": 1615089100, "creation_date": 1615089100, "answer_id": 66513027, "question_id": 54372880, "link": "https://stackoverflow.com/questions/54372880/although-gopath-is-set-echo-gopath-returns-nothing/66513027#66513027", "title": "Although GOPATH is set, echo $GOPATH returns nothing", "body": "<p>I think you can  add the GOPATH in <code>~/.profile</code> or <code>~/.bashrc</code></p>\n<ul>\n<li><p>When you start bash as an interactive shell (i.e., not to run a script), it reads <code>~/.bashrc</code></p>\n</li>\n<li><p>When invoked as a login shell, then it\nonly reads <code>~/.bash_profile</code> or <code>~/.profile</code>.\nTo understand more\ndifference between shells, read this <a href=\"https://superuser.com/questions/183870/difference-between-bashrc-and-bash-profile/183980#183980\">post</a></p>\n</li>\n</ul>\n<p>Attaching what I have in my ~/.profile here</p>\n<pre><code>export PATH=$PATH:/usr/local/go/bin\nexport PATH=$PATH:$HOME/go/bin\n</code></pre>\n"}], "owner": {"reputation": 412, "user_id": 4698963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/96vU1.jpg?s=128&g=1", "display_name": "ethanchewy", "link": "https://stackoverflow.com/users/4698963/ethanchewy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4106, "favorite_count": 3, "accepted_answer_id": 54372922, "answer_count": 3, "score": 3, "last_activity_date": 1615089100, "creation_date": 1548451037, "last_edit_date": 1548451309, "question_id": 54372880, "link": "https://stackoverflow.com/questions/54372880/although-gopath-is-set-echo-gopath-returns-nothing", "title": "Although GOPATH is set, echo $GOPATH returns nothing", "body": "<p>I have this weird issue. </p>\n\n<p>When I run <code>go env</code>, I get the following: </p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"\"\nGOCACHE=\"/home/ethanc/.cache/go-build\"\nGOEXE=\"\"\nGOFLAGS=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/ethanc/go\"\nGOPROXY=\"\"\nGORACE=\"\"\nGOROOT=\"/usr/local/go\"\nGOTMPDIR=\"\"\nGOTOOLDIR=\"/usr/local/go/pkg/tool/linux_amd64\"\nGCCGO=\"gccgo\"\nCC=\"gcc\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\nGOMOD=\"/home/ethanc/marketstore/go.mod\"\nCGO_CFLAGS=\"-g -O2\"\nCGO_CPPFLAGS=\"\"\nCGO_CXXFLAGS=\"-g -O2\"\nCGO_FFLAGS=\"-g -O2\"\nCGO_LDFLAGS=\"-g -O2\"\nPKG_CONFIG=\"pkg-config\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build154822748=/tmp/go-build -gno-record-gcc-switches\"\n</code></pre>\n\n<p>But when, I run <code>echo $GOPATH</code>, I get an empty new line. This happens for all other GO environment values as well when I try to echo them out:\n<a href=\"https://i.stack.imgur.com/6w4yz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6w4yz.png\" alt=\"Empty GOPATH result\"></a></p>\n\n<p>This doesn't make sense because when I try to print out other path variables like <code>echo $HOME</code>, I get the correct value:</p>\n\n<pre><code>/home/ethanc\n</code></pre>\n\n<p>Does anyone have any idea why when I echo my <code>GOPATH</code>, only a new line is returned?</p>\n"}]