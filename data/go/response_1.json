[{"tags": ["testing", "go"], "answers": [{"tags": [], "owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "is_accepted": false, "score": 1, "last_activity_date": 1421279890, "creation_date": 1421279890, "answer_id": 27954685, "question_id": 27954631, "link": "https://stackoverflow.com/questions/27954631/testing-net-http/27954685#27954685", "title": "Testing net/http?", "body": "<p><code>beacon_test.go</code> has also a function called <code>main()</code> rename it to <code>TestFirst</code> (or any other name you like as long as it starts with <code>Test</code>, note the uppercase <code>T</code> is important). There is no need for that. Just run <code>go test .</code> from inside the package you are working on (the one containing the *.go files). Post the full files if you need more help.</p>\n"}], "owner": {"reputation": 1633, "user_id": 224872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/e293a6322ac01bbf09d62a44fb95a8ff?s=128&d=identicon&r=PG", "display_name": "jelder", "link": "https://stackoverflow.com/users/224872/jelder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1421279890, "creation_date": 1421279584, "question_id": 27954631, "link": "https://stackoverflow.com/questions/27954631/testing-net-http", "title": "Testing net/http?", "body": "<p>I am a little confused about how to structure a go web app and its tests. I have read the <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow\">How to Write Go Code</a> but still don't get it. For example, I have a go project called \"beacon\" with a <code>beacon.go</code> file at the root. Adding a trivial <code>beacon_test.go</code> file (copied verbatim from <a href=\"http://golang.org/pkg/net/http/httptest/#example_Server\" rel=\"nofollow\">http://golang.org/pkg/net/http/httptest/#example_Server</a>) causes this error:</p>\n\n<pre><code>$ go test\n# github.com/jelder/beacon\n./beacon_test.go:11: main redeclared in this block\n    previous declaration at ./beacon.go:216\nFAIL    github.com/jelder/beacon [build failed]\n</code></pre>\n\n<p>Sure enough, line 11 is <code>func main()</code>. If I instead change the <code>package main</code> line in my <code>beacon_test.go</code> to <code>package hello</code>, I get this error instead:</p>\n\n<pre><code>can't load package: package github.com/jelder/beacon: found packages main (beacon.go) and hello (beacon_test.go) in /Users/jacob/src/github.com/jelder/beacon\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "is_accepted": true, "score": 2, "last_activity_date": 1421277809, "creation_date": 1421277809, "answer_id": 27954335, "question_id": 27954291, "link": "https://stackoverflow.com/questions/27954291/golang-including-local-files/27954335#27954335", "title": "Golang including local files", "body": "<p>You need to run using the two files <code>go run a.go b.go</code></p>\n"}], "owner": {"reputation": 4811, "user_id": 2874789, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/VKbXD.jpg?s=128&g=1", "display_name": "Christopher Shroba", "link": "https://stackoverflow.com/users/2874789/christopher-shroba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 27954335, "answer_count": 1, "score": -1, "last_activity_date": 1421277809, "creation_date": 1421277622, "question_id": 27954291, "link": "https://stackoverflow.com/questions/27954291/golang-including-local-files", "title": "Golang including local files", "body": "<p>I have the following two files:</p>\n\n<p>a.go:</p>\n\n<pre><code>package main\n\nfunc foo() {\n    return 42\n}\n</code></pre>\n\n<p>b.go:</p>\n\n<pre><code>package main\n\nfunc main() {\n    println(foo())\n}\n</code></pre>\n\n<p>From what I've learned, it seems as if two files in the same package (and the same directory) should be able to use each other's functions.  Yet, when I run <code>go run b.go</code>, I get the following:</p>\n\n<pre><code># command-line-arguments\n./b.go:4: undefined: foo\n</code></pre>\n\n<p>What's up?  Do I have to somehow import a.go in my b.go?</p>\n"}, {"tags": ["sql", "go"], "answers": [{"comments": [{"owner": {"reputation": 6730, "user_id": 297094, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/08a7e4ec1109264bc3d18a519d15146c?s=128&d=identicon&r=PG", "display_name": "Robert Zaremba", "link": "https://stackoverflow.com/users/297094/robert-zaremba"}, "edited": false, "score": 0, "creation_date": 1421313547, "post_id": 27949612, "comment_id": 44313853, "body": "I thought you can use prepared statement only once. Is it right?"}, {"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "reply_to_user": {"reputation": 6730, "user_id": 297094, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/08a7e4ec1109264bc3d18a519d15146c?s=128&d=identicon&r=PG", "display_name": "Robert Zaremba", "link": "https://stackoverflow.com/users/297094/robert-zaremba"}, "edited": false, "score": 0, "creation_date": 1421324298, "post_id": 27949612, "comment_id": 44319617, "body": "@Robert Zaremba You can use prepared statement many times even concurrently. You usually defer stmt.Close(). You want explicitly close stmt only in transactions, which is special behaviour."}, {"owner": {"reputation": 6730, "user_id": 297094, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/08a7e4ec1109264bc3d18a519d15146c?s=128&d=identicon&r=PG", "display_name": "Robert Zaremba", "link": "https://stackoverflow.com/users/297094/robert-zaremba"}, "edited": false, "score": 0, "creation_date": 1421326076, "post_id": 27949612, "comment_id": 44320643, "body": "I thought I need to <code>Close</code> statement after usage to release the connection. So, then statements work after <code>Close</code>? IIUC - I can declare few &quot;global&quot; statements and use them all the time; after each usage I should <code>Close</code> and then I can use them again (even concurrently?)."}, {"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "reply_to_user": {"reputation": 6730, "user_id": 297094, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/08a7e4ec1109264bc3d18a519d15146c?s=128&d=identicon&r=PG", "display_name": "Robert Zaremba", "link": "https://stackoverflow.com/users/297094/robert-zaremba"}, "edited": false, "score": 0, "creation_date": 1421331592, "post_id": 27949612, "comment_id": 44323673, "body": "You can&#39;t use closed stmt, this will return an error. You can use prepared stmt all the time and then close it when it not more needed. Closing stmt will free resources and return connection to connection pull. Tx is special case - stmt prepared in transaction belong to transaction and must be closed in Tx."}, {"owner": {"reputation": 6730, "user_id": 297094, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/08a7e4ec1109264bc3d18a519d15146c?s=128&d=identicon&r=PG", "display_name": "Robert Zaremba", "link": "https://stackoverflow.com/users/297094/robert-zaremba"}, "edited": false, "score": 0, "creation_date": 1421333741, "post_id": 27949612, "comment_id": 44325114, "body": "OK, so I shouldn&#39;t do <i>global</i> statements and use them for the program life time."}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 2, "last_activity_date": 1421258930, "creation_date": 1421258930, "answer_id": 27949612, "question_id": 27948469, "link": "https://stackoverflow.com/questions/27948469/why-use-prepared-statements-instead-of-query-exec-with-go-sql-package/27949612#27949612", "title": "Why use prepared statements instead of Query / Exec with go sql package?", "body": "<p>Prepared statement already bound to concrete connection to DB, contains low-level driver.Stmt and can be used concurrently by multiple go-routings. So it's quite handy to prepare and use, and things work faster.</p>\n"}, {"tags": [], "owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "is_accepted": false, "score": 2, "last_activity_date": 1421262526, "creation_date": 1421262526, "answer_id": 27950620, "question_id": 27948469, "link": "https://stackoverflow.com/questions/27948469/why-use-prepared-statements-instead-of-query-exec-with-go-sql-package/27950620#27950620", "title": "Why use prepared statements instead of Query / Exec with go sql package?", "body": "<p>I think the best answer comes from the wikipedia article on <a href=\"http://en.wikipedia.org/wiki/Prepared_statement\" rel=\"nofollow\">Prepared Statements</a>.</p>\n\n<p>Quoting: </p>\n\n<blockquote>\n  <p>The overhead of compiling and optimizing the statement is incurred\n  only once, although the statement is executed multiple times. Not all\n  optimization can be performed at the time the prepared statement is\n  compiled, for two reasons: the best plan may depend on the specific\n  values of the parameters, and the best plan may change as tables and\n  indexes change over time.`enter code here</p>\n  \n  <p>Prepared statements are resilient against SQL injection, because\n  parameter values, which are transmitted later using a different\n  protocol, need not be correctly escaped. If the original statement\n  template is not derived from external input, SQL injection cannot\n  occur.</p>\n</blockquote>\n"}], "owner": {"reputation": 6730, "user_id": 297094, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/08a7e4ec1109264bc3d18a519d15146c?s=128&d=identicon&r=PG", "display_name": "Robert Zaremba", "link": "https://stackoverflow.com/users/297094/robert-zaremba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 881, "favorite_count": 0, "accepted_answer_id": 27949612, "answer_count": 2, "score": 3, "last_activity_date": 1429324868, "creation_date": 1421255016, "last_edit_date": 1429324868, "question_id": 27948469, "link": "https://stackoverflow.com/questions/27948469/why-use-prepared-statements-instead-of-query-exec-with-go-sql-package", "title": "Why use prepared statements instead of Query / Exec with go sql package?", "body": "<p>In the go <a href=\"http://golang.org/pkg/database/sql/\" rel=\"nofollow\"><code>sql</code></a> package, I understand that each statement should be closed after execution.\nWhy would someone use prepared statements instead of just the raw <code>Query</code> or <code>Exec</code> methods?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1421296066, "last_edit_date": 1421296066, "creation_date": 1421252143, "answer_id": 27947542, "question_id": 27947325, "link": "https://stackoverflow.com/questions/27947325/terminate-the-second-goroutine/27947542#27947542", "title": "Terminate the second goroutine", "body": "<p>Use another channel to signal done:</p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n    \"time\"\n)\n\nfunc errName(ch chan error, done chan struct{}) {\n    for i := 0; i &lt; 10000; i++ {\n        select {\n        case &lt;-done:\n            fmt.Println(\"early return from name\")\n            return\n        default:\n        }\n    }\n    select {\n    case: ch &lt;- errors.New(\"Error name\")\n    default:\n    }\n}\n\nfunc errEmail(ch chan error, done chan struct{}) {\n    for i := 0; i &lt; 100; i++ {\n        select {\n        case &lt;-done:\n            fmt.Println(\"early return from email\")\n            return\n        default:\n        }\n    }\n    select {\n    case ch &lt;- errors.New(\"Error email\"):\n    default:\n    }\n}\n\nfunc main() {\n    ch := make(chan error, 1)\n    done := make(chan struct{})\n    go errName(ch, done)\n    go errEmail(ch, done)\n    fmt.Println(&lt;-ch)\n    close(done)\n    time.Sleep(1000000)\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/105UGjLwZx\" rel=\"nofollow\">playground example</a></p>\n\n<p>To prevent the losing goroutine from blocking forever on channel send, I created the error channel with capacity 1 and use a select when sending:</p>\n\n<pre><code>select {\ncase ch &lt;- errors.New(\"Error email\"):\ndefault:\n}\n</code></pre>\n\n<p>If you are working with more than one level of goroutine completion, then you should consider using <a href=\"http://godoc.org/golang.org/x/net/context#Context.Done\" rel=\"nofollow\">golang/x/net/context Context</a>. </p>\n"}, {"comments": [{"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1421265360, "post_id": 27951171, "comment_id": 44297767, "body": "I read about these article, but I do not know, how to use it. Thanks for example, I will try it."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1421320233, "post_id": 27951171, "comment_id": 44317399, "body": "I do not understand the select statement and statement &lt;-ctx.Done(). in the main function. What are they doing?"}, {"owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 0, "creation_date": 1421359775, "post_id": 27951171, "comment_id": 44340591, "body": "<code>select</code> is a fundamental operation.  Read a concurrency tutorial for more information.  For example: <a href=\"http://www.golang-book.com/10/index.htm\" rel=\"nofollow noreferrer\">golang-book.com/10/index.htm</a>.  You can also listen to a talk: <a href=\"https://www.youtube.com/watch?v=f6kdp27TYZs\" rel=\"nofollow noreferrer\">youtube.com/watch?v=f6kdp27TYZs</a>"}, {"owner": {"reputation": 4827, "user_id": 303726, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/5c9c83c99715bf38dd62c7ae20da3dd7?s=128&d=identicon&r=PG", "display_name": "Julio Guerra", "link": "https://stackoverflow.com/users/303726/julio-guerra"}, "edited": false, "score": 0, "creation_date": 1471441413, "post_id": 27951171, "comment_id": 65348415, "body": "This is cancelation by polling on the channel. There is no way to cancel/abort a goroutine &quot;immediately&quot;."}], "tags": [], "owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "is_accepted": true, "score": 3, "last_activity_date": 1421264847, "creation_date": 1421264847, "answer_id": 27951171, "question_id": 27947325, "link": "https://stackoverflow.com/questions/27947325/terminate-the-second-goroutine/27951171#27951171", "title": "Terminate the second goroutine", "body": "<p>A standard way to organize this behaviors is to use</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n\n    \"code.google.com/p/go.net/context\"\n)\n\nfunc errName(ctx context.Context, cancel context.CancelFunc) {\n    for i := 0; i &lt; 10000; i++ {\n        select {\n        case &lt;-ctx.Done():\n            return\n        default:\n        }\n    }\n    cancel()\n}\n\nfunc errEmail(ctx context.Context, cancel context.CancelFunc) {\n\n    for i := 0; i &lt; 100; i++ {\n        select {\n        case &lt;-ctx.Done():\n            return\n        default:\n        }\n    }\n    cancel()\n}\n\nfunc main() {\n\n    ctx := context.Background()\n\n    ctx, cancel := context.WithCancel(ctx)\n\n    go errName(ctx, cancel)\n    go errEmail(ctx, cancel)\n\n    &lt;-ctx.Done()\n\n    if ctx.Err() != nil {\n        fmt.Println(ctx.Err())\n    }\n\n    time.Sleep(1000000)\n\n}\n</code></pre>\n\n<p>You can read two good articles on the matter:</p>\n\n<ol>\n<li><a href=\"http://blog.golang.org/context\" rel=\"nofollow\">http://blog.golang.org/context</a></li>\n<li><a href=\"http://blog.golang.org/pipelines\" rel=\"nofollow\">http://blog.golang.org/pipelines</a></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 1, "last_activity_date": 1421274367, "creation_date": 1421274367, "answer_id": 27953598, "question_id": 27947325, "link": "https://stackoverflow.com/questions/27947325/terminate-the-second-goroutine/27953598#27953598", "title": "Terminate the second goroutine", "body": "<p><code>Done chan struct{}</code> mentioned (or its <code>context.Context</code> incarnation) is the idiomatic and THE TRUE way for behaviour. But the easy way to avoid panic in your snippet can be</p>\n\n<pre><code>import \"sync\"\n\nvar once sync.Once\n\nfunc errName(ch chan error) {\n    for i := 0; i &lt; 10000; i++ {\n\n    }\n    once.Do(func() {ch &lt;- errors.New(\"Error name\"); close(ch)}())\n}\nfunc errName(ch chan error) {\n    for i := 0; i &lt; 10000; i++ {\n\n    }\n    once.Do(func() {ch &lt;- errors.New(\"Error name\"); close(ch)}())\n }\n</code></pre>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 792, "favorite_count": 0, "accepted_answer_id": 27951171, "answer_count": 3, "score": 1, "last_activity_date": 1421296066, "creation_date": 1421251549, "question_id": 27947325, "link": "https://stackoverflow.com/questions/27947325/terminate-the-second-goroutine", "title": "Terminate the second goroutine", "body": "<p>I have the following code snippet.</p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n    \"time\"\n)\n\nfunc errName(ch chan error) {\n\n    for i := 0; i &lt; 10000; i++ {\n\n    }\n\n    ch &lt;- errors.New(\"Error name\")\n    close(ch)\n}\n\nfunc errEmail(ch chan error) {\n\n    for i := 0; i &lt; 100; i++ {\n\n    }\n    ch &lt;- errors.New(\"Error email\")\n    close(ch)\n}\n\nfunc main() {\n\n    ch := make(chan error)\n\n    go errName(ch)\n    go errEmail(ch)\n    fmt.Println(&lt;-ch)\n    //close(ch)\n\n    time.Sleep(1000000)\n\n}\n</code></pre>\n\n<p>As you can see, I let two functions run in the goroutine, errName and errEmail. I pass as parameter a channel with error type. If one of them finish first, it should send the error through the channel and close it. So the second, still running goroutine, have not to run anymore, because I've got the error already and I want to terminate the still running goroutine. This is what I trying to reach in my example above.</p>\n\n<p>When I run the programm, I've got error </p>\n\n<pre><code>panic: send on closed channel\n\ngoroutine 6 [running]:\nmain.errEmail(0xc0820101e0)\n        D:/gocode/src/samples/gorountine2.go:24 +0xfd\ncreated by main.main\n        D:/gocode/src/samples/gorountine2.go:33 +0x74\n\ngoroutine 1 [runnable]:\nmain.main()\n        D:/gocode/src/samples/gorountine2.go:34 +0xac\nexit status 2\n</code></pre>\n\n<p>I know, when I remove the close statement, it would not panic, but channel on the running goroutine is still waiting for error reference and that's mean, it wasted the memory for nothing(waiting).</p>\n\n<p>When one of them send an error to the channel, the second error I will do not care anymore, that is my target.</p>\n"}, {"tags": ["http", "go", "url-rewriting", "server", "url-routing"], "comments": [{"owner": {"reputation": 109, "user_id": 472639, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W64G0.jpg?s=128&g=1", "display_name": "Muktadir", "link": "https://stackoverflow.com/users/472639/muktadir"}, "edited": false, "score": 0, "creation_date": 1450043636, "post_id": 27945310, "comment_id": 56255274, "body": "Did you try http.Handle(&quot;/static/&quot;, http.FileServer(http.Dir(&quot;/&quot;)))?"}, {"owner": {"reputation": 1866, "user_id": 2449468, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/814a2fe06121017beb9d2c95426c7d36?s=128&d=identicon&r=PG", "display_name": "Sunny", "link": "https://stackoverflow.com/users/2449468/sunny"}, "edited": false, "score": 0, "creation_date": 1469915696, "post_id": 27945310, "comment_id": 64737177, "body": "<code>http.Handle(&quot;&#47;static&#47;&quot;, http.FileServer(http.Dir(&quot;&quot;)))</code> works."}], "answers": [{"comments": [{"owner": {"reputation": 3554, "user_id": 3233810, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1135890448/picture?type=large", "display_name": "daino3", "link": "https://stackoverflow.com/users/3233810/daino3"}, "edited": false, "score": 6, "creation_date": 1474304995, "post_id": 27946132, "comment_id": 66467025, "body": "For anyone reading this, make sure you have the trailing slash in <code>&#47;tmpfiles&#47;</code> or you&#39;re going to have a bad time."}, {"owner": {"reputation": 325, "user_id": 4073845, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000130486872/picture?type=large", "display_name": "Amazingandyyy", "link": "https://stackoverflow.com/users/4073845/amazingandyyy"}, "edited": false, "score": 2, "creation_date": 1507787900, "post_id": 27946132, "comment_id": 80351834, "body": "to clarify and spread the right common sense, the <code>&#47;tmpfile&#47;</code> in Handle is important, but not in StripPrefix, let&#39;s say <code>http.Handle(&quot;&#47;tmpfiles&#47;&quot;, http.StripPrefix(&quot;&#47;tmpfiles&quot;, http.FileServer(http.Dir(&quot;&#47;tmp&quot;))))</code> will also work"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 55, "last_activity_date": 1421615168, "last_edit_date": 1421615168, "creation_date": 1421248255, "answer_id": 27946132, "question_id": 27945310, "link": "https://stackoverflow.com/questions/27945310/why-do-i-need-to-use-http-stripprefix-to-access-my-static-files/27946132#27946132", "title": "Why do I need to use http.StripPrefix to access my static files?", "body": "<p><a href=\"http://golang.org/pkg/net/http/#StripPrefix\" rel=\"noreferrer\"><code>http.StripPrefix()</code></a> forwards the handling of the request to one you specify as its parameter, but before that it modifies the request URL by stripping off the specified prefix.</p>\n\n<p>So for example in your case if the browser (or an HTTP client) requests the resource:</p>\n\n<pre><code>/static/example.txt\n</code></pre>\n\n<p><code>StripPrefix</code> will cut the <code>/static/</code> and forward the modified request to the handler returned by <a href=\"http://golang.org/pkg/net/http/#FileServer\" rel=\"noreferrer\"><code>http.FileServer()</code></a> so it will see that the requested resource is</p>\n\n<pre><code>/example.txt\n</code></pre>\n\n<p>The <code>Handler</code> returned by <code>http.FileServer()</code> will look for and serve the content of a file <em>relative</em> to the folder (or rather <code>FileSystem</code>) specified as its parameter (you specified <code>\"static\"</code> to be the root of static files).</p>\n\n<p>Now since <code>\"example.txt\"</code> is in the <code>static</code> folder, you have to specify a relative path to that to get the corrent file path.</p>\n\n<h2>Another Example</h2>\n\n<p>This example can be found on the http package documentation page (<a href=\"http://golang.org/pkg/net/http/#example_StripPrefix\" rel=\"noreferrer\">here</a>):</p>\n\n<pre><code>// To serve a directory on disk (/tmp) under an alternate URL\n// path (/tmpfiles/), use StripPrefix to modify the request\n// URL's path before the FileServer sees it:\nhttp.Handle(\"/tmpfiles/\",\n        http.StripPrefix(\"/tmpfiles/\", http.FileServer(http.Dir(\"/tmp\"))))\n</code></pre>\n\n<p><strong>Explanation:</strong></p>\n\n<p><code>FileServer()</code> is told the root of static files is <code>\"/tmp\"</code>. We want the URL to start with <code>\"/tmpfiles/\"</code>. So if someone requests <code>\"/tempfiles/example.txt\"</code>, we want the server to send the file <code>\"/tmp/example.txt\"</code>.</p>\n\n<p>In order to achieve this, we have to strip <code>\"/tmpfiles\"</code> from the URL, and the remaining will be the relative path compared to the root folder <code>\"/tmp\"</code> which if we join gives:</p>\n\n<pre><code>/tmp/example.txt\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 4750890, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H9KO0.jpg?s=128&g=1", "display_name": "seafooler", "link": "https://stackoverflow.com/users/4750890/seafooler"}, "is_accepted": false, "score": 2, "last_activity_date": 1503783874, "last_edit_date": 1503783874, "creation_date": 1478003871, "answer_id": 40360240, "question_id": 27945310, "link": "https://stackoverflow.com/questions/27945310/why-do-i-need-to-use-http-stripprefix-to-access-my-static-files/40360240#40360240", "title": "Why do I need to use http.StripPrefix to access my static files?", "body": "<p>I'll answer the two questions one by one.</p>\n\n<p><strong>Answer 1 to Question 1:</strong>\nIf your code is written like below:</p>\n\n<pre><code>http.Handle(\"/static/\", http.FileServer(http.Dir(\"static\"))\n</code></pre>\n\n<p>your root folder is <code>%GOPATH%/src/project_name/static/</code>. When you access <code>localhost:8080/static</code>, the URL <code>/static</code> will be forwarded to the handler returned by <a href=\"https://golang.org/pkg/net/http/#FileServer\" rel=\"nofollow noreferrer\">http.FileServer()</a>. However, you have no directory or file named <code>static</code> in the root folder.</p>\n\n<p><strong>Answer 2 to Question 2</strong>: In general, you cannot access <code>/static</code> folder if you remove the <a href=\"https://golang.org/pkg/net/http/#StripPrefix\" rel=\"nofollow noreferrer\">http.StripPrefix()</a>. However, if you have a directory or file named <code>static</code>, you can access it (<em>exactly not the root directory you want</em>) with the URL <code>localhost:8080:/static</code>.</p>\n\n<p>By the way, you cannot access anything if your URL does not begin with <code>/static</code>, because the <code>http.ServeMux</code> will not redirect your request.</p>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 5443084, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MpZa5-RFQTk/AAAAAAAAAAI/AAAAAAAAqdM/AHcJ-wad0iY/photo.jpg?sz=128", "display_name": "Youngsoo Yi", "link": "https://stackoverflow.com/users/5443084/youngsoo-yi"}, "is_accepted": false, "score": 9, "last_activity_date": 1514404483, "creation_date": 1514404483, "answer_id": 47997908, "question_id": 27945310, "link": "https://stackoverflow.com/questions/27945310/why-do-i-need-to-use-http-stripprefix-to-access-my-static-files/47997908#47997908", "title": "Why do I need to use http.StripPrefix to access my static files?", "body": "<h3>Assume that</h3>\n\n<p>I have a file</p>\n\n<pre><code>/home/go/src/js/kor.js\n</code></pre>\n\n<p>Then, tell fileserve serves local directory</p>\n\n<pre><code>fs := http.FileServer(http.Dir(\"/home/go/src/js\"))\n</code></pre>\n\n<h3>Example 1 - root url to Filerserver root</h3>\n\n<p>Now file server takes <code>\"/\"</code> request as <code>\"/home/go/src/js\"+\"/\"</code></p>\n\n<pre><code>http.Handle(\"/\", fs)\n</code></pre>\n\n<p>Yes, <code>http://localhost/kor.js</code> request tells Fileserver, find <code>kor.js</code> in </p>\n\n<pre><code>\"/home/go/src/js\" +  \"/\"  + \"kor.js\".\n</code></pre>\n\n<p>we got <code>kor.js</code> file.</p>\n\n<h2>Example2 - custom url to Fileserver root</h2>\n\n<p>But, if we add additional resquest name.</p>\n\n<pre><code>http.Handle(\"/static/\", fs)\n</code></pre>\n\n<p>Now file server takes <code>\"/static/\"</code> request as <code>\"/home/go/src/js\"+\"/static/\"</code></p>\n\n<p>Yes, <code>http://localhost/static/kor.js</code> request tells Fileserver, find <code>kor.js</code> in </p>\n\n<pre><code>\"/home/go/src/js\" +  \"/static/\"  + \"kor.js\".\n</code></pre>\n\n<p>We got 404 error.</p>\n\n<h2>Example 3 - custom url to Fileserver root with</h2>\n\n<p>so, we modify request url before Fileserver takes it with  <code>http.StripPrefix(\"/tmpfiles/\", ...</code></p>\n\n<p>after <code>stripPrefix</code> Fileserver take <code>/</code> instead <code>/static/</code></p>\n\n<pre><code>\"/home/go/src/js\" +  \"/\"  + \"kor.js\".\n</code></pre>\n\n<p>got <code>kor.js</code></p>\n"}, {"tags": [], "owner": {"reputation": 3789, "user_id": 2284676, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/13e34de97b1df53aac80c039b6ffc977?s=128&d=identicon&r=PG&f=1", "display_name": "octohedron", "link": "https://stackoverflow.com/users/2284676/octohedron"}, "is_accepted": false, "score": 0, "last_activity_date": 1595630208, "last_edit_date": 1595630208, "creation_date": 1591136652, "answer_id": 62162327, "question_id": 27945310, "link": "https://stackoverflow.com/questions/27945310/why-do-i-need-to-use-http-stripprefix-to-access-my-static-files/62162327#62162327", "title": "Why do I need to use http.StripPrefix to access my static files?", "body": "<p>For anyone having issues with subdirectories, you need to add a <code>&quot;.&quot;</code> because it seems it treats the path as relative only if it's a folder in the root directory of the binary.</p>\n<p>For example</p>\n<pre><code>s.router.PathPrefix(&quot;/logos/&quot;).Handler(\n        http.StripPrefix(&quot;/logos/&quot;, http.FileServer(http.Dir(&quot;./uploads/logos/&quot;))))\n</code></pre>\n<p>Note the <code>&quot;.&quot;</code> before &quot;<code>/uploads</code>&quot;</p>\n"}], "owner": {"reputation": 8631, "user_id": 1121143, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cda9ff7487b553eb5af7e5ca39a78938?s=128&d=identicon&r=PG", "display_name": "Dante", "link": "https://stackoverflow.com/users/1121143/dante"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18545, "favorite_count": 18, "accepted_answer_id": 27946132, "answer_count": 4, "score": 39, "last_activity_date": 1595630208, "creation_date": 1421245819, "last_edit_date": 1496493598, "question_id": 27945310, "link": "https://stackoverflow.com/questions/27945310/why-do-i-need-to-use-http-stripprefix-to-access-my-static-files", "title": "Why do I need to use http.StripPrefix to access my static files?", "body": "<p>main.go</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n)\n\nfunc main() {\n    http.Handle(\"/static/\", http.StripPrefix(\"/static/\", http.FileServer(http.Dir(\"static\"))))\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>Directory structure:</p>\n\n<pre><code>%GOPATH%/src/project_name/main.go\n%GOPATH%/src/project_name/static/..files and folders ..\n</code></pre>\n\n<p>Even after reading the documentation I have trouble understanding what exactly <code>http.StripPrefix</code> does here. </p>\n\n<p>1) Why can't I access <code>localhost:8080/static</code> if I remove <code>http.StripPrefix</code>? </p>\n\n<p>2) What URL maps to <code>/static</code> folder if I remove that function?</p>\n"}, {"tags": ["postgresql", "go", "beego"], "comments": [{"owner": {"reputation": 1603, "user_id": 703636, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4982f461770c62eea10e1966ea6388d0?s=128&d=identicon&r=PG", "display_name": "Sekm", "link": "https://stackoverflow.com/users/703636/sekm"}, "edited": false, "score": 0, "creation_date": 1422431143, "post_id": 27943563, "comment_id": 44742457, "body": "Hi, did you find out what is going on with the testing? I have a similar problem where my app routes aren&#39;t being picked up. Edit: Figured out I needed to import my routes package in the test to pick them up... doh"}, {"owner": {"reputation": 666, "user_id": 1819852, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/da91c0f9296f7029e059362ea5809af6?s=128&d=identicon&r=PG", "display_name": "souravlahoti", "link": "https://stackoverflow.com/users/1819852/souravlahoti"}, "edited": false, "score": 0, "creation_date": 1480318432, "post_id": 27943563, "comment_id": 68895345, "body": "I am facing the same issue , it&#39;s trying to find the conf inside tests and not the project. Did u find ay resolution @Passionate Developer"}], "answers": [{"tags": [], "owner": {"reputation": 2696, "user_id": 646300, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0f43aae25eb18b8df023d1e0f5f8e696?s=128&d=identicon&r=PG", "display_name": "Edwardr", "link": "https://stackoverflow.com/users/646300/edwardr"}, "is_accepted": false, "score": 0, "last_activity_date": 1421241109, "creation_date": 1421241109, "answer_id": 27943783, "question_id": 27943563, "link": "https://stackoverflow.com/questions/27943563/how-to-make-api-test-files-with-beego/27943783#27943783", "title": "How to make API test files with Beego", "body": "<p>PG can't authenticate you probably because it can't find the password in the <code>app.conf</code> file, which it also can't find because it's looking in the wrong place.</p>\n\n<p>Try using an absolute path to your config rather than the convoluted method you have in your <code>init()</code> function.</p>\n"}], "owner": {"reputation": 8564, "user_id": 841090, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/CYTJH.jpg?s=128&g=1", "display_name": "Passionate Engineer", "link": "https://stackoverflow.com/users/841090/passionate-engineer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1699, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1421241109, "creation_date": 1421240454, "question_id": 27943563, "link": "https://stackoverflow.com/questions/27943563/how-to-make-api-test-files-with-beego", "title": "How to make API test files with Beego", "body": "<p>I have below test file:</p>\n\n<pre><code>package tests\n\nimport (\n    \"net/http\"\n    \"net/http/httptest\"\n    \"testing\"\n    \"runtime\"\n    \"path/filepath\"\n    _ \"hello/routers\"\n    _ \"github.com/lib/pq\"\n\n    \"github.com/astaxie/beego\"\n    . \"github.com/smartystreets/goconvey/convey\"\n)\n\nfunc init() {\n    _, file, _, _ := runtime.Caller(1)\n    apppath, _ := filepath.Abs(filepath.Dir(filepath.Join(file, \"..\" + string(filepath.Separator))))\n    beego.TestBeegoInit(apppath)\n}\n\n// TestGet is a sample to run an endpoint test\nfunc TestGet(t *testing.T) {\n    r, _ := http.NewRequest(\"GET\", \"/api/testing\", nil)\n    w := httptest.NewRecorder()\n    beego.BeeApp.Handlers.ServeHTTP(w, r)\n\n    beego.Trace(\"testing\", \"TestGet\", \"Code[%d]\\n%s\", w.Code, w.Body.String())\n\n    Convey(\"Subject: Test Station Endpoint\\n\", t, func() {\n            Convey(\"Status Code Should Be 200\", func() {\n                    So(w.Code, ShouldEqual, 200)\n            })\n            Convey(\"The Result Should Not Be Empty\", func() {\n                    So(w.Body.Len(), ShouldBeGreaterThan, 0)\n            })\n    })\n}\n</code></pre>\n\n<p>Then when I run <code>go test tests/*.go</code></p>\n\n<p>I get:</p>\n\n<pre><code>2015/01/14 23:55:19 [config.go:284] [W] open /home/IdeaProjects/go/src/hello/tests/conf/app.conf: no such file or directory \n[ORM]register db Ping `default`, pq: password authentication failed for user \"hello\"\nmust have one register DataBase alias named `default`\nFAIL    command-line-arguments  0.008s\n</code></pre>\n\n<p>I've bootstraped Beego with <code>bee api</code> then using pq Postgres Driver for PG database.</p>\n\n<p>Also I'm not sure why it's looking at <code>/hello/tests/conf/app.conf</code> path for <code>app.conf</code> file it should look for <code>/hello/conf/app.conf</code>.</p>\n\n<p>Is there a reason why this is happening?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 9, "last_activity_date": 1421239715, "creation_date": 1421239715, "answer_id": 27943344, "question_id": 27943245, "link": "https://stackoverflow.com/questions/27943245/c-in-go-string-int-c-int-returns-u000x/27943344#27943344", "title": "C in Go: string ( int ( C.int ) ) returns \\u000X", "body": "<p>In Go <code>string(int(x))</code> will produce a string containing the <strong>rune</strong> (aka Unicode point) x; <code>string(12)</code> is <strong>not</strong> a shortcut for <code>fmt.Sprintf(\"%d\", 12)</code> or <code>strconv.Itoa</code>.</p>\n"}], "owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 27943344, "answer_count": 1, "score": 0, "last_activity_date": 1421273745, "creation_date": 1421239413, "last_edit_date": 1421273745, "question_id": 27943245, "link": "https://stackoverflow.com/questions/27943245/c-in-go-string-int-c-int-returns-u000x", "title": "C in Go: string ( int ( C.int ) ) returns \\u000X", "body": "<p>I have an enum in C that I am sharing between projects.</p>\n\n<p>When I use <code>string ( int ( C.int ) )</code> </p>\n\n<p>I get \\u0002 for third in enum, I just need the number in plain \"2\"?</p>\n\n<p>Regards</p>\n"}, {"tags": ["web", "go", "frameworks", "revel"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1421239561, "post_id": 27942862, "comment_id": 44281890, "body": "Show output of <code>go env</code>. Do <b>not</b> set GOROOT."}, {"owner": {"reputation": 3411, "user_id": 848937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77e5e010bf91a33530b2eaeaaf3db5fc?s=128&d=identicon&r=PG", "display_name": "Nery Jr", "link": "https://stackoverflow.com/users/848937/nery-jr"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1421310723, "post_id": 27942862, "comment_id": 44312539, "body": "Having had it but did not work. I tried again and still returning the same error. You must set GOROOT as the go is not installed in the default directory (c:\\go). Reinstalled golang the default directory and still did not work, continues to generate the same error."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1421310929, "post_id": 27942862, "comment_id": 44312640, "body": "Install Go to its default, do not set GOROOT and post the output of <code>go env</code>. Something is wrong with your GOPATH."}, {"owner": {"reputation": 3411, "user_id": 848937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77e5e010bf91a33530b2eaeaaf3db5fc?s=128&d=identicon&r=PG", "display_name": "Nery Jr", "link": "https://stackoverflow.com/users/848937/nery-jr"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1421327574, "post_id": 27942862, "comment_id": 44321415, "body": "Thank Volker. It worked! If I install golang in a directory other than the default and set the variable GOROOT does not work. Thanks for your help!"}, {"owner": {"reputation": 3411, "user_id": 848937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77e5e010bf91a33530b2eaeaaf3db5fc?s=128&d=identicon&r=PG", "display_name": "Nery Jr", "link": "https://stackoverflow.com/users/848937/nery-jr"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1421447002, "post_id": 27942862, "comment_id": 44378141, "body": "Volker, you can answer the question with the tip you gave me, please. So I can vote for your response, a response that helped me. Thank U!"}], "owner": {"reputation": 3411, "user_id": 848937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77e5e010bf91a33530b2eaeaaf3db5fc?s=128&d=identicon&r=PG", "display_name": "Nery Jr", "link": "https://stackoverflow.com/users/848937/nery-jr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 971, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1560159295, "creation_date": 1421238160, "last_edit_date": 1560159295, "question_id": 27942862, "link": "https://stackoverflow.com/questions/27942862/go-lang-and-revel-web-framework-dont-work", "title": "Go lang and Revel web framework don&#39;t work", "body": "<p>I'm trying to use Revel web framework in WINDOWS 7 and am having trouble.\nSimply follow the steps in the [Quick Start] page [<a href=\"http://revel.github.io/]\" rel=\"nofollow noreferrer\">http://revel.github.io/]</a>:</p>\n\n<p>c:\\dev> go get github.com/revel/cmd/revel</p>\n\n<p>c:\\dev> revel run github.com/revel/revel/samples/chat</p>\n\n<p>My GOROOT and GOPATH configuration are:</p>\n\n<p>GOPATH =/Users/nery/DEV/go<br/></p>\n\n<p>GOROOT =/soft/go</p>\n\n<p>I have also tried</p>\n\n<p>GOPATH = c:\\Users\\nery\\DEV\\go</p>\n\n<p>GOROOT = c:\\soft\\go</p>\n\n<p>\u00a0 However in no response comes in Browser (Chrome) and the server is generated the following error output:</p>\n\n<pre><code>2015/01/14 10:07:56 harness.go:165: Listening on :9000                          \n2015/01/14 10:07:58 reflect.go:775: Unexpected! Code path is not in GOPATH: \\sof\nt\\go\\src/github.com\\revel\\revel\\samples\\chat/app                                \n2015/01/14 10:07:58 reflect.go:94: Skipping code path \\soft\\go\\src/github.com\\re\nvel\\revel\\samples\\chat/app                                                      \n2015/01/14 10:07:58 reflect.go:775: Unexpected! Code path is not in GOPATH: \\sof\nt\\go\\src\\github.com\\revel\\revel\\modules\\static/app                              \n2015/01/14 10:07:58 reflect.go:94: Skipping code path \\soft\\go\\src\\github.com\\re\nvel\\revel\\modules\\static/app                                                    \n2015/01/14 10:07:58 reflect.go:775: Unexpected! Code path is not in GOPATH: \\sof\nt\\go\\src\\github.com\\revel\\revel\\modules\\testrunner/app                          \n2015/01/14 10:07:58 reflect.go:94: Skipping code path \\soft\\go\\src\\github.com\\re\nvel\\revel\\modules\\testrunner/app                                                \n2015/01/14 10:07:58 reflect.go:775: Unexpected! Code path is not in GOPATH: \\sof\nt\\go\\src/github.com\\revel\\revel\\samples\\chat/tests                              \n2015/01/14 10:07:58 reflect.go:94: Skipping code path \\soft\\go\\src/github.com\\re\nvel\\revel\\samples\\chat/tests                                                    \n2015/01/14 10:07:58 server.go:1775: http: panic serving 127.0.0.1:50903: runtime\n error: invalid memory address or nil pointer dereference                       \ngoroutine 26 [running]:                                                         \nnet/http.func\u00b7011()                                                             \n        c:/go/src/net/http/server.go:1130 +0xc2                                 \ngithub.com/revel/revel/harness.(*SourceInfo).ControllerSpecs(0x0, 0x0, 0x0, 0x0)\n</code></pre>\n\n<p>.\n.\n.</p>\n\n<p>Does anyone have any tips that can help me?\nThanks.</p>\n"}, {"tags": ["string", "go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1421245684, "last_edit_date": 1495535121, "creation_date": 1421244993, "answer_id": 27945044, "question_id": 27942769, "link": "https://stackoverflow.com/questions/27942769/replace-strings-n-times-starting-from-the-end/27945044#27945044", "title": "replace strings n times, starting from the end", "body": "<p>There is no such standard function you seek for.</p>\n\n<h2>Alternative #1: with Reverse</h2>\n\n<p>Using a string-reverse function (taken from <a href=\"https://stackoverflow.com/questions/1752414/how-to-reverse-a-string-in-go\">here</a>):</p>\n\n<pre><code>func Rev(s string) string {\n    runes := []rune(s)\n    for i, j := 0, len(runes)-1; i &lt; j; i, j = i+1, j-1 {\n        runes[i], runes[j] = runes[j], runes[i]\n    }\n    return string(runes)\n}\n</code></pre>\n\n<p>Your solution is:</p>\n\n<pre><code>Rev(strings.Replace(Rev(s), Rev(old), Rev(new), n))\n</code></pre>\n\n<h2>Alternative #2: do-it-yourself</h2>\n\n<p>You can simply use a <code>for</code> and <a href=\"http://golang.org/pkg/strings/#LastIndex\" rel=\"nofollow noreferrer\"><code>strings.LastIndex()</code></a> to find replacable substrings and replace them.</p>\n"}], "owner": {"reputation": 8470, "user_id": 1245622, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/V7rHB.jpg?s=128&g=1", "display_name": "linqu", "link": "https://stackoverflow.com/users/1245622/linqu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 939, "favorite_count": 0, "accepted_answer_id": 27945044, "answer_count": 1, "score": 3, "last_activity_date": 1421245684, "creation_date": 1421237825, "last_edit_date": 1421241418, "question_id": 27942769, "link": "https://stackoverflow.com/questions/27942769/replace-strings-n-times-starting-from-the-end", "title": "replace strings n times, starting from the end", "body": "<p>It is my second day with golang, I'll probably ask a very basic question:</p>\n\n<p>I want to replace parts of a string, that is what <a href=\"http://golang.org/pkg/strings/#Replace\" rel=\"nofollow\">strings.Replace</a> is good for:</p>\n\n<pre><code>func Replace(s, old, new string, n int) string\n</code></pre>\n\n<p>The last parameter is the number of times <code>old</code> gets replaced by <code>new</code> - starting from the beginning of the string.</p>\n\n<p>Is there a similar standard function that starts from the end?</p>\n"}, {"tags": ["ssl", "go"], "answers": [{"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 3, "last_activity_date": 1421237224, "creation_date": 1421237224, "answer_id": 27942595, "question_id": 27940249, "link": "https://stackoverflow.com/questions/27940249/how-to-access-the-clients-certificate-in-go/27942595#27942595", "title": "How to access the client&#39;s certificate in Go?", "body": "<p>Seems <code>r *http.Request</code> has <code>TLS *tls.ConnectionState</code> field which in turn has <code>PeerCertificates []*x509.Certificate</code> field, so</p>\n\n<pre><code>fmt.Fprint(w, r.TLS.PeerCertificates)\n</code></pre>\n\n<p>probably can do</p>\n"}], "owner": {"reputation": 1471, "user_id": 3167480, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8f849e03b3f244508869bd277f3a013e?s=128&d=identicon&r=PG&f=1", "display_name": "chrisvdb", "link": "https://stackoverflow.com/users/3167480/chrisvdb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2560, "favorite_count": 2, "accepted_answer_id": 27942595, "answer_count": 1, "score": 2, "last_activity_date": 1421237224, "creation_date": 1421229834, "last_edit_date": 1421230770, "question_id": 27940249, "link": "https://stackoverflow.com/questions/27940249/how-to-access-the-clients-certificate-in-go", "title": "How to access the client&#39;s certificate in Go?", "body": "<p>Below is my code for an HTTPS server in Go. The server requires the client to provide an SSL certificate, but doesn't verify the certificate (by design).</p>\n\n<p>You can generate a private/public key pair as follows if you'd like to give it a try:</p>\n\n<pre><code>$ openssl genrsa -out private.pem 2048\n$ openssl req -new -x509 -key private.pem -out public.pem -days 365\n</code></pre>\n\n<p>Does anyone know how I can access the client certificate in the handler? Let's say I would like to report some properties about the certificate the client presented back to the client.</p>\n\n<p>Thanks,\nChris.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"crypto/tls\"\n    \"net/http\"\n)\n\nconst (\n    PORT       = \":8443\"\n    PRIV_KEY   = \"./private.pem\"\n    PUBLIC_KEY = \"./public.pem\"\n)\n\nfunc rootHandler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprint(w, \"Nobody should read this.\")\n}\n\nfunc main() {\n\n    server := &amp;http.Server{\n        TLSConfig: &amp;tls.Config{\n            ClientAuth: tls.RequireAnyClientCert,\n            MinVersion: tls.VersionTLS12,\n        },\n        Addr: \"127.0.0.1:8443\",\n    }\n\n    http.HandleFunc(\"/\", rootHandler)\n    err := server.ListenAndServeTLS(PUBLIC_KEY, PRIV_KEY)\n    if err != nil {\n        fmt.Printf(\"main(): %s\\n\", err)\n    }\n}\n</code></pre>\n"}, {"tags": ["templates", "go"], "answers": [{"comments": [{"owner": {"reputation": 6945, "user_id": 2288944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/7qryD.jpg?s=128&g=1", "display_name": "armnotstrong", "link": "https://stackoverflow.com/users/2288944/armnotstrong"}, "edited": false, "score": 0, "creation_date": 1421230822, "post_id": 27940213, "comment_id": 44277120, "body": "So that explains it.\u3000@icza I happened to realize that you have answered at least two of my questions now. Wish I could offer you a drink some day :-) thank you again. really helpful."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 6945, "user_id": 2288944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/7qryD.jpg?s=128&g=1", "display_name": "armnotstrong", "link": "https://stackoverflow.com/users/2288944/armnotstrong"}, "edited": false, "score": 0, "creation_date": 1421231062, "post_id": 27940213, "comment_id": 44277239, "body": "@armnotstrong Actually I&#39;ve answered already 4 of your questions."}, {"owner": {"reputation": 6945, "user_id": 2288944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/7qryD.jpg?s=128&g=1", "display_name": "armnotstrong", "link": "https://stackoverflow.com/users/2288944/armnotstrong"}, "edited": false, "score": 0, "creation_date": 1421231132, "post_id": 27940213, "comment_id": 44277279, "body": "It&#39;s really nice of you"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1421231629, "last_edit_date": 1421231629, "creation_date": 1421229710, "answer_id": 27940213, "question_id": 27939308, "link": "https://stackoverflow.com/questions/27939308/how-can-i-get-the-struct-field-of-a-map-elem-in-gos-html-template/27940213#27940213", "title": "How can I get the struct field of a map elem in Go&#39;s html/template?", "body": "<p>Note: you can try/check out your working modified code in the <a href=\"http://play.golang.org/p/mKTVCHB3Lv\" rel=\"nofollow\"><strong>Go Playground</strong></a>.</p>\n\n<hr>\n\n<p>If you want the <code>template</code> package to be able to access the fields, you have to export the fields. You can export a field by starting it with an uppercase letter:</p>\n\n<pre><code>type Task struct {\n   cmd string\n   args []string\n   Desc string\n}\n</code></pre>\n\n<p>Note that I only changed <code>Desc</code> here, you have to uppercase any other fields you want to refer to in the template.</p>\n\n<p>After this exporting, change all references to uppercase <code>Desc</code> of course:</p>\n\n<pre><code>var taskMap = map[string]Task{\n    \"find\": Task{\n        cmd: \"find\",\n        args: []string{\"/tmp/\"},\n        Desc: \"find files in /tmp dir\",\n    },\n    \"grep\": Task{\n        cmd: \"grep\",\n        args:[]string{\"foo\",\"/tmp/*\", \"-R\"},\n        Desc: \"grep files match having foo\",\n    },\n}\n</code></pre>\n\n<p>And also in the template:</p>\n\n<pre><code>&lt;html&gt;\n{{range $key, $value := .}}\n   &lt;li&gt;Task Name:        {{$key}}&lt;/li&gt;\n   &lt;li&gt;Task Value:       {{$value}}&lt;/li&gt;\n   &lt;li&gt;Task description: {{$value.Desc}}&lt;/li&gt;\n{{end}}\n&lt;/html&gt;\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>&lt;html&gt;\n\n&lt;li&gt;Task Name:        find&lt;/li&gt;\n&lt;li&gt;Task Value:       {find [/tmp/] find files in /tmp dir}&lt;/li&gt;\n&lt;li&gt;Task description: find files in /tmp dir&lt;/li&gt;\n\n&lt;li&gt;Task Name:        grep&lt;/li&gt;\n&lt;li&gt;Task Value:       {grep [foo /tmp/* -R] grep files match having foo}&lt;/li&gt;\n&lt;li&gt;Task description: grep files match having foo&lt;/li&gt;\n\n&lt;/html&gt;\n</code></pre>\n"}], "owner": {"reputation": 6945, "user_id": 2288944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/7qryD.jpg?s=128&g=1", "display_name": "armnotstrong", "link": "https://stackoverflow.com/users/2288944/armnotstrong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 393, "favorite_count": 0, "accepted_answer_id": 27940213, "answer_count": 1, "score": 4, "last_activity_date": 1421272423, "creation_date": 1421226956, "last_edit_date": 1421272423, "question_id": 27939308, "link": "https://stackoverflow.com/questions/27939308/how-can-i-get-the-struct-field-of-a-map-elem-in-gos-html-template", "title": "How can I get the struct field of a map elem in Go&#39;s html/template?", "body": "<p>I have a Struct <code>Task</code>:</p>\n\n<pre><code>type Task struct {\n   cmd string\n   args []string\n   desc string\n}\n</code></pre>\n\n<p>And I init a map which take the above <code>Task</code> struct as a value and a <code>string</code> as a key(the task name)</p>\n\n<pre><code>var taskMap = map[string]Task{\n    \"find\": Task{\n        cmd: \"find\",\n        args: []string{\"/tmp/\"},\n        desc: \"find files in /tmp dir\",\n    },\n    \"grep\": Task{\n        cmd: \"grep\",\n        args:[]string{\"foo\",\"/tmp/*\", \"-R\"},\n        desc: \"grep files match having foo\",\n    },\n}\n</code></pre>\n\n<p>and I want to parse a html page using <code>html/template</code> just using the above <code>taskMap</code>.</p>\n\n<pre><code>func listHandle(w http.ResponseWriter, r *http.Request){\n    t, _ := template.ParseFiles(\"index.tmpl\")\n    t.Execute(w, taskMap)\n}\n</code></pre>\n\n<p>Here is the <code>index.tmpl</code>:</p>\n\n<pre><code>&lt;html&gt;\n{{range $key, $value := .}}\n   &lt;li&gt;Task Name:        {{$key}}&lt;/li&gt;\n   &lt;li&gt;Task Value:       {{$value}}&lt;/li&gt;\n   &lt;li&gt;Task description: {{$value.desc}}&lt;/li&gt;\n{{end}}\n&lt;/html&gt;\n</code></pre>\n\n<p>I can get the <code>$key</code> and <code>value</code> printed successfully, but When It comes to the field of <code>Task</code> using <code>{{$value.desc}}</code> it wont work.</p>\n\n<p>How can I get the <code>desc</code> of each <code>task</code> in this case?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 47383, "user_id": 122536, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6fd51ed284bddf7eeab9de416359021e?s=128&d=identicon&r=PG", "display_name": "alexchenco", "link": "https://stackoverflow.com/users/122536/alexchenco"}, "edited": false, "score": 0, "creation_date": 1421229469, "post_id": 27939562, "comment_id": 44276402, "body": "How can I modify the code so the <code>*</code> makes a difference?"}, {"owner": {"reputation": 9024, "user_id": 670034, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f1c180c6f131125bb52a4a019099f929?s=128&d=identicon&r=PG", "display_name": "Beat Richartz", "link": "https://stackoverflow.com/users/670034/beat-richartz"}, "reply_to_user": {"reputation": 47383, "user_id": 122536, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6fd51ed284bddf7eeab9de416359021e?s=128&d=identicon&r=PG", "display_name": "alexchenco", "link": "https://stackoverflow.com/users/122536/alexchenco"}, "edited": false, "score": 0, "creation_date": 1421229944, "post_id": 27939562, "comment_id": 44276658, "body": "@alexchenco as soon as you assign something e.g. to <code>h.name</code> like so: <code>h.name = &#39;John&#39;</code> there will be a difference."}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1421231785, "post_id": 27939562, "comment_id": 44277666, "body": "@BeatRichartz that sounds incorrect (if I understand what you&#39;re getting at in that comment). The non-pointer will be promoted to a pointer when you call a method that is defined as a pointer receiver. For example: <a href=\"http://play.golang.org/p/Ze8uI5uxD9\" rel=\"nofollow noreferrer\">play.golang.org/p/Ze8uI5uxD9</a>. The promotion, according to the spec, is just that <code>value.Method()</code> is essentially converted to (&amp;value).Method()` when the method signature matches."}, {"owner": {"reputation": 9024, "user_id": 670034, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f1c180c6f131125bb52a4a019099f929?s=128&d=identicon&r=PG", "display_name": "Beat Richartz", "link": "https://stackoverflow.com/users/670034/beat-richartz"}, "reply_to_user": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1421233171, "post_id": 27939562, "comment_id": 44278463, "body": "@SimonWhitehead I&#39;m talking about the difference between defining a method on a pointer or on a copy: <a href=\"http://play.golang.org/p/3bmR-XWUQt\" rel=\"nofollow noreferrer\">play.golang.org/p/3bmR-XWUQt</a>. You&#39;re talking about <i>calling</i> the method on the pointer using dot-notation, in which instance yes, go does not make a fuss about whether you have a struct or a pointer to it."}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 1, "creation_date": 1421233813, "post_id": 27939562, "comment_id": 44278821, "body": "Right. But the &quot;there will be a difference&quot; won&#39;t actually show up for the OP (leading to more confusion) if they were to call a pointer receiver without a pointer - even if the method changes data within the struct. I just thought I would clarify so there was no confusion."}], "tags": [], "owner": {"reputation": 9024, "user_id": 670034, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f1c180c6f131125bb52a4a019099f929?s=128&d=identicon&r=PG", "display_name": "Beat Richartz", "link": "https://stackoverflow.com/users/670034/beat-richartz"}, "is_accepted": false, "score": 3, "last_activity_date": 1421227739, "creation_date": 1421227739, "answer_id": 27939562, "question_id": 27939232, "link": "https://stackoverflow.com/questions/27939232/what-different-does-the-pointer-symbol-makes-in-the-following-go-method/27939562#27939562", "title": "What different does the * (pointer symbol) makes in the following Go method?", "body": "<p>The difference it does make is that the method will be defined on a pointer to a <code>Human</code> struct and all the methods in the struct will subsequently operate on the value pointed to.</p>\n\n<p>If you were to loose the <code>*</code>, the method would operate on a copy of the struct you call the method on, so any write you'd do to the struct in the method would be useless for the code calling the method.</p>\n\n<p>Since the method body only executes a <code>fmt.Printf</code> and prints some values, it does not really make a big difference if the method is defined on the pointer or not.</p>\n\n<p>There are some cases where in the interest of concurrent-safety, you'd better not define methods on pointers, since this may lead to simultaneous access and writing of the underlying struct values.</p>\n"}, {"tags": [], "owner": {"reputation": 69101, "user_id": 783681, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/2sTvb.jpg?s=128&g=1", "display_name": "cuongle", "link": "https://stackoverflow.com/users/783681/cuongle"}, "is_accepted": true, "score": 1, "last_activity_date": 1422258714, "last_edit_date": 1422258714, "creation_date": 1421230230, "answer_id": 27940374, "question_id": 27939232, "link": "https://stackoverflow.com/questions/27939232/what-different-does-the-pointer-symbol-makes-in-the-following-go-method/27940374#27940374", "title": "What different does the * (pointer symbol) makes in the following Go method?", "body": "<p>There are two reasons to use a pointer receiver:</p>\n\n<ol>\n<li>First, to avoid copying the value on each method call, more efficient if the value type is a large struct).  </li>\n<li>Second, the method can modify the value that its receiver points to.</li>\n</ol>\n\n<p>So in your example, if you add one more dump method to change phone like this:</p>\n\n<pre><code>func (h Human) ChangePhone() {\n    h.phone = 'whatever'\n}\n</code></pre>\n\n<p>The phone does not change after you call this method, that's why point <code>*</code> comes into play.</p>\n"}], "owner": {"reputation": 47383, "user_id": 122536, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6fd51ed284bddf7eeab9de416359021e?s=128&d=identicon&r=PG", "display_name": "alexchenco", "link": "https://stackoverflow.com/users/122536/alexchenco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 27940374, "answer_count": 2, "score": 1, "last_activity_date": 1422258714, "creation_date": 1421226666, "question_id": 27939232, "link": "https://stackoverflow.com/questions/27939232/what-different-does-the-pointer-symbol-makes-in-the-following-go-method", "title": "What different does the * (pointer symbol) makes in the following Go method?", "body": "<p>I'm following this tutorial: <a href=\"https://github.com/astaxie/build-web-application-with-golang/blob/master/en/02.5.md\" rel=\"nofollow\">https://github.com/astaxie/build-web-application-with-golang/blob/master/en/02.5.md</a>.</p>\n\n<p>I still don't understand pointers very well so this past confuses me a bit: <code>func (h *Human) SayHi()</code>. I tried removing the <code>*</code> and the output turned out to be exactly the same. Why is the <code>*</code> necessary in this case? Could someone give me an example of a different output with the code below?</p>\n\n<pre><code>package main\nimport \"fmt\"\n\ntype Human struct {\n    name string\n    age int\n    phone string\n}\n\ntype Student struct {\n    Human // anonymous field\n    school string\n}\n\ntype Employee struct {\n    Human \n    company string\n}\n\n// define a method in Human\nfunc (h *Human) SayHi() {\n    fmt.Printf(\"Hi, I am %s you can call me on %s\\n\", h.name, h.phone)\n}\n\nfunc main() {\n    mark := Student{Human{\"Mark\", 25, \"222-222-YYYY\"}, \"MIT\"}\n    sam := Employee{Human{\"Sam\", 45, \"111-888-XXXX\"}, \"Golang Inc\"}\n\n    mark.SayHi()\n    sam.SayHi()\n}\n</code></pre>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 2, "creation_date": 1421222876, "post_id": 27938177, "comment_id": 44273025, "body": "I explained it at <a href=\"http://stackoverflow.com/a/18911267/6309\">stackoverflow.com/a/18911267/6309</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1421224070, "post_id": 27938177, "comment_id": 44273564, "body": "See <a href=\"http://golang.org/ref/spec#Slice_expressions\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Slice_expressions</a> especially &quot;Full slice expressions&quot;: The third index allows to limit the capacity of the subslice which is usefull if you want to append freely to the subslice without overwriting the original values (e.g. because the have been subsliced to an other slice)."}, {"owner": {"reputation": 1374, "user_id": 560561, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6c5947ff77ff642f370d78017cf04fc?s=128&d=identicon&r=PG", "display_name": "fzerorubigd", "link": "https://stackoverflow.com/users/560561/fzerorubigd"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1421224099, "post_id": 27938177, "comment_id": 44273583, "body": "@VonC is there anything in golang official documents?"}, {"owner": {"reputation": 1374, "user_id": 560561, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6c5947ff77ff642f370d78017cf04fc?s=128&d=identicon&r=PG", "display_name": "fzerorubigd", "link": "https://stackoverflow.com/users/560561/fzerorubigd"}, "edited": false, "score": 0, "creation_date": 1421224278, "post_id": 27938177, "comment_id": 44273664, "body": "So, what to do in this case? close the question? answer my own question?"}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 32, "last_activity_date": 1421224480, "last_edit_date": 1495541785, "creation_date": 1421224480, "answer_id": 27938683, "question_id": 27938177, "link": "https://stackoverflow.com/questions/27938177/golang-slice-slicing-a-slice-with-sliceabc/27938683#27938683", "title": "golang slice, slicing a slice with slice[a:b:c]", "body": "<p>The syntax has been introduced in Go 1.2, as I mentioned in \"<a href=\"https://stackoverflow.com/a/18911267/6309\">Re-slicing slices in Golang</a>\".<br>\nIt is documented in <a href=\"http://golang.org/ref/spec#Slice_expressions\" rel=\"noreferrer\">Full slice expressions</a>:</p>\n\n<pre><code>a[low : high : max]\n</code></pre>\n\n<blockquote>\n  <p>constructs a slice of the same type, and with the same length and elements as the simple slice expression <code>a[low : high]</code>.<br>\n  Additionally, it controls the resulting slice's capacity by setting it to <code>max - low</code>.<br>\n  Only the first index may be omitted; it defaults to 0. </p>\n  \n  <p>After slicing the array <code>a</code>:</p>\n</blockquote>\n\n<pre><code>a := [5]int{1, 2, 3, 4, 5}\nt := a[1:3:5]\n</code></pre>\n\n<blockquote>\n  <p>the slice t has type []int, length 2, capacity 4, and elements</p>\n</blockquote>\n\n<pre><code>t[0] == 2\nt[1] == 3\n</code></pre>\n\n<p>The <a href=\"https://docs.google.com/document/d/1GKKdiGYAghXRxC2BFrSEbHBZZgAGKQ-yXK-hRKBo0Kk/pub\" rel=\"noreferrer\">design document</a> for that feature had the following justification:</p>\n\n<blockquote>\n  <p>It would occasionally be useful, for example in custom <code>[]byte</code> allocation managers, to be able to hand a slice to a caller and know that the caller cannot edit values beyond a given subrange of the true array.</p>\n  \n  <p>The addition of <code>append</code> to the language made this somewhat more important, because <strong><code>append</code> lets programmers overwrite entries between <code>len</code> and <code>cap</code> without realizing it or even mentioning <code>cap</code></strong>.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 784, "user_id": 5280055, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZJPMINabE4M/AAAAAAAAAAI/AAAAAAAAHvU/y3n_gZhwvVE/photo.jpg?sz=128", "display_name": "Robert Ranjan", "link": "https://stackoverflow.com/users/5280055/robert-ranjan"}, "is_accepted": false, "score": 1, "last_activity_date": 1611443738, "last_edit_date": 1611443738, "creation_date": 1600379572, "answer_id": 63946613, "question_id": 27938177, "link": "https://stackoverflow.com/questions/27938177/golang-slice-slicing-a-slice-with-sliceabc/63946613#63946613", "title": "golang slice, slicing a slice with slice[a:b:c]", "body": "<p>In a slice expression <code>slice[a:b:c]</code> or <code>aSlice[1:3:5]</code></p>\n<pre><code>a:b or 1:3 -&gt; gives length\na:c or 1:5 -&gt; gives capacity\n</code></pre>\n<p>We can extract both <code>length</code> and <code>capacity</code> from a slice expression with 3 numbers/indices, without looking at the source slice/array.</p>\n<pre><code>expression| aSlice[low:high:max]  or aSlice[a:b:c]    or aSlice[1:3:7]\n------------------------------------------------------------------------\nLength    | len(aSlice[low:high]) or len(aSlice[a:b]) or len(aSlice[1:3])\nCapacity  | len(aSlice[low:max])  or len(aSlice[a:c]) or len(aSlice[1:7])\n------------------------------------------------------------------------\n</code></pre>\n<p>Read more here at <a href=\"https://golang.org/ref/spec#Slice_expressions\" rel=\"nofollow noreferrer\">Slice Expressions</a></p>\n<p><a href=\"https://play.golang.org/p/f_OMDuLXYAh\" rel=\"nofollow noreferrer\">Playground</a></p>\n"}, {"tags": [], "owner": {"reputation": 690, "user_id": 7298873, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/038j2.jpg?s=128&g=1", "display_name": "monkrus", "link": "https://stackoverflow.com/users/7298873/monkrus"}, "is_accepted": false, "score": 2, "last_activity_date": 1603896571, "creation_date": 1603896571, "answer_id": 64575350, "question_id": 27938177, "link": "https://stackoverflow.com/questions/27938177/golang-slice-slicing-a-slice-with-sliceabc/64575350#64575350", "title": "golang slice, slicing a slice with slice[a:b:c]", "body": "<p>It is explained well in <a href=\"https://tip.golang.org/doc/go1.2#three_index\" rel=\"nofollow noreferrer\">Go release notes</a>.\nPlease note a missing first index ([:0:0]) defaults to zero.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 2005150, "user_type": "registered", "profile_image": "https://graph.facebook.com/622648001/picture?type=large", "display_name": "Ozgur Kara", "link": "https://stackoverflow.com/users/2005150/ozgur-kara"}, "is_accepted": false, "score": 0, "last_activity_date": 1603897649, "creation_date": 1603897649, "answer_id": 64575693, "question_id": 27938177, "link": "https://stackoverflow.com/questions/27938177/golang-slice-slicing-a-slice-with-sliceabc/64575693#64575693", "title": "golang slice, slicing a slice with slice[a:b:c]", "body": "<p>Actually Go slice have a pointer and pointing to the array and it holds length and capacity of the array and we can show it like will be</p>\n<p>pointer:length:capacity</p>\n<p>and append is used for adding same new length.</p>\n<pre><code>    sl1 := make([]int, 6)\n    fmt.Println(sl1)\n\n    sl2 := append(sl1, 1)\n    fmt.Println(sl2)\n</code></pre>\n<pre><code>[0 0 0 0 0 0]\n[0 0 0 0 0 0 1]\n</code></pre>\n"}], "owner": {"reputation": 1374, "user_id": 560561, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6c5947ff77ff642f370d78017cf04fc?s=128&d=identicon&r=PG", "display_name": "fzerorubigd", "link": "https://stackoverflow.com/users/560561/fzerorubigd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13349, "favorite_count": 10, "accepted_answer_id": 27938683, "answer_count": 4, "score": 30, "last_activity_date": 1611443738, "creation_date": 1421222143, "last_edit_date": 1421224855, "question_id": 27938177, "link": "https://stackoverflow.com/questions/27938177/golang-slice-slicing-a-slice-with-sliceabc", "title": "golang slice, slicing a slice with slice[a:b:c]", "body": "<p>I read <a href=\"http://blog.golang.org/go-slices-usage-and-internals\" rel=\"noreferrer\">go slice usage and internals</a> and <a href=\"http://blog.golang.org/slices\" rel=\"noreferrer\">Slice</a> and <a href=\"https://golang.org/doc/effective_go.html#slices\" rel=\"noreferrer\">Effective go#slice</a> but there is nothing about slicing a slice with 3 number like this : <code>slice[a:b:c]</code></p>\n\n<p>For example this code : </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var s = []string{\"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\"}\n    fmt.Println(s[1:2:6], len(s[1:2:6]), cap(s[1:2:6]))\n    fmt.Println(s[1:2:5], len(s[1:2:5]), cap(s[1:2:5]))\n    fmt.Println(s[1:2], len(s[1:2]), cap(s[1:2]))\n\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/up387gsFs8\" rel=\"noreferrer\">go playground</a> result is this : </p>\n\n<pre><code>[b] 1 5\n[b] 1 4\n[b] 1 6\n</code></pre>\n\n<p>I can understand that the third one is something about capacity, but what is the exact meaning of this?<br>\nDo I miss something in documents?</p>\n"}, {"tags": ["go", "intellij-idea", "intellij-14"], "comments": [{"owner": {"reputation": 45698, "user_id": 513413, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e0b73975f75df2f25f8b7cc8ce834f0c?s=128&d=identicon&r=PG", "display_name": "Hesam", "link": "https://stackoverflow.com/users/513413/hesam"}, "edited": false, "score": 0, "creation_date": 1421220450, "post_id": 27936844, "comment_id": 44272084, "body": "I even removed lines that I added to env var. and installed .dmg format of GO SDK. although echo $GOPATH and $GOROOT are returning GOPATH and GOROOT but still intelliJ Idea is not able to add the SDK, although it is able to find the path automatically (without I browse to usr/local/go folder."}], "answers": [{"comments": [{"owner": {"reputation": 45698, "user_id": 513413, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e0b73975f75df2f25f8b7cc8ce834f0c?s=128&d=identicon&r=PG", "display_name": "Hesam", "link": "https://stackoverflow.com/users/513413/hesam"}, "edited": false, "score": 0, "creation_date": 1421216812, "post_id": 27936942, "comment_id": 44270748, "body": "Yup, I have those folders inside my SDK folder"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 45698, "user_id": 513413, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e0b73975f75df2f25f8b7cc8ce834f0c?s=128&d=identicon&r=PG", "display_name": "Hesam", "link": "https://stackoverflow.com/users/513413/hesam"}, "edited": false, "score": 0, "creation_date": 1421216954, "post_id": 27936942, "comment_id": 44270796, "body": "Did you launch IntelliJ from the bash session where GOROOT was exported?"}, {"owner": {"reputation": 45698, "user_id": 513413, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e0b73975f75df2f25f8b7cc8ce834f0c?s=128&d=identicon&r=PG", "display_name": "Hesam", "link": "https://stackoverflow.com/users/513413/hesam"}, "edited": false, "score": 0, "creation_date": 1421217423, "post_id": 27936942, "comment_id": 44270953, "body": "No, I run it from launchpad by simply double click :)"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1421217440, "last_edit_date": 1421217440, "creation_date": 1421216620, "answer_id": 27936942, "question_id": 27936844, "link": "https://stackoverflow.com/questions/27936844/why-intellij-idea-cannot-find-location-of-go-sdk/27936942#27936942", "title": "Why IntelliJ Idea cannot find location of GO SDK?", "body": "<p><code>~Desktop/go/sdk</code> doesn't seems a valid path (as it refers to the homedir of the '<code>Desktop</code>' user): <code>~/Desktop/go/sdk</code> should work better.</p>\n\n<p>As long as you see in that <code>~/Desktop/go/sdk</code> folders the subfolders '<code>api</code>', '<code>bin</code>', '<code>blog</code>', ..., that should be the right one for the GO SDK expected by the \"<a href=\"http://plugins.jetbrains.com/plugin/5047\" rel=\"nofollow noreferrer\">golang support plugin</a>\".</p>\n\n<p>Some issues exist with that plugin and IntelliJ 14: <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin/issues/1169\" rel=\"nofollow noreferrer\">issues 1169</a>, <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin/pull/1172\" rel=\"nofollow noreferrer\">PR 1172</a> (fixed for for 1.0.0-alpha).<br>\nThe other approach is to <a href=\"http://pivotallabs.com/setting-google-go-plugin-intellij-idea-13-os-x-10-8-5/\" rel=\"nofollow noreferrer\">recompile and install that plugin</a>.</p>\n\n<p>The end result of specifying the Go SDK path should look like:</p>\n\n<p><img src=\"https://i.stack.imgur.com/AS4Kw.png\" alt=\"http://pivotallabs.com/wordpress/wp-content/uploads/2013/12/Screen-Shot-2013-12-09-at-4.53.20-PM.png\"></p>\n"}, {"comments": [{"owner": {"reputation": 45698, "user_id": 513413, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e0b73975f75df2f25f8b7cc8ce834f0c?s=128&d=identicon&r=PG", "display_name": "Hesam", "link": "https://stackoverflow.com/users/513413/hesam"}, "edited": false, "score": 0, "creation_date": 1421227645, "post_id": 27939351, "comment_id": 44275312, "body": "Thanks, I was installed/uninstalled several times in different form to see what is the problem. 0.9.16 fixed my problem. Thanks."}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "reply_to_user": {"reputation": 75, "user_id": 2306092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89c0e44fb8c52821f8090e643af6d6a6?s=128&d=identicon&r=PG", "display_name": "Ravi Dalmia", "link": "https://stackoverflow.com/users/2306092/ravi-dalmia"}, "edited": false, "score": 0, "creation_date": 1424450004, "post_id": 27939351, "comment_id": 45567479, "body": "@RaviDalmia can you please open an issue on Github issue tracker for the plugin with some more details about the problem? We currently don&#39;t have any reports from our users that the plugin doesn&#39;t work with IDEA 14 or 14.1. Thank you."}, {"owner": {"reputation": 75, "user_id": 2306092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89c0e44fb8c52821f8090e643af6d6a6?s=128&d=identicon&r=PG", "display_name": "Ravi Dalmia", "link": "https://stackoverflow.com/users/2306092/ravi-dalmia"}, "edited": false, "score": 0, "creation_date": 1424696790, "post_id": 27939351, "comment_id": 45642202, "body": "@dlsniper I am using IntelliJ 14, and tried the 0.9.16 release, 1.0.0 release and the one which is listed on the IntelliJ plugin link, but they simply do not allow me to add the Go SDK."}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "reply_to_user": {"reputation": 75, "user_id": 2306092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89c0e44fb8c52821f8090e643af6d6a6?s=128&d=identicon&r=PG", "display_name": "Ravi Dalmia", "link": "https://stackoverflow.com/users/2306092/ravi-dalmia"}, "edited": false, "score": 0, "creation_date": 1424729913, "post_id": 27939351, "comment_id": 45661983, "body": "@RaviDalmia please open an issue on the issue tracker with details about your problem. Currently I&#39;m not aware of any go SDK installation method which would fail to be detected by the plugin. If you are installing the plugin from the zip file, please don&#39;t unzip it first, install the zip (it happens on MacOSX, please read the release notes)"}, {"owner": {"reputation": 75, "user_id": 2306092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89c0e44fb8c52821f8090e643af6d6a6?s=128&d=identicon&r=PG", "display_name": "Ravi Dalmia", "link": "https://stackoverflow.com/users/2306092/ravi-dalmia"}, "edited": false, "score": 1, "creation_date": 1424786928, "post_id": 27939351, "comment_id": 45685951, "body": "@dlsniper it seems that I was just extracting and trying to use the plugin. Upvoted for the clarification :) go seems to work now, just one side issue, there seems to be some issue around the output directory of the code, I will try and figure that out."}], "tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": true, "score": 10, "last_activity_date": 1505301754, "last_edit_date": 1505301754, "creation_date": 1421227099, "answer_id": 27939351, "question_id": 27936844, "link": "https://stackoverflow.com/questions/27936844/why-intellij-idea-cannot-find-location-of-go-sdk/27939351#27939351", "title": "Why IntelliJ Idea cannot find location of GO SDK?", "body": "<p>Please consider using one of the alpha releases for 0.9.16. I believe that alpha7 could be the more stable one rather than alpha9. You can get them from <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin/releases\" rel=\"nofollow noreferrer\">GitHub releases</a></p>\n\n<p>The v1.0.0-alpha0 branch is, as the name implies, an alpha release and it's in the early stages of development, that's why there's no release done yet for it as well.</p>\n\n<p>P.S. I'm one of the contributors to the plugin.</p>\n"}, {"comments": [{"owner": {"reputation": 1083, "user_id": 4839438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d4f894034e220a326ae0c3c44818034?s=128&d=identicon&r=PG", "display_name": "Michele Giuseppe Fadda", "link": "https://stackoverflow.com/users/4839438/michele-giuseppe-fadda"}, "edited": false, "score": 0, "creation_date": 1446710547, "post_id": 29905635, "comment_id": 54859326, "body": "this issue is overcome by more recent versions of the Go plugin, see answer by dlsniper."}], "tags": [], "owner": {"reputation": 1083, "user_id": 4839438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d4f894034e220a326ae0c3c44818034?s=128&d=identicon&r=PG", "display_name": "Michele Giuseppe Fadda", "link": "https://stackoverflow.com/users/4839438/michele-giuseppe-fadda"}, "is_accepted": false, "score": 2, "last_activity_date": 1430167589, "creation_date": 1430167589, "answer_id": 29905635, "question_id": 27936844, "link": "https://stackoverflow.com/questions/27936844/why-intellij-idea-cannot-find-location-of-go-sdk/29905635#29905635", "title": "Why IntelliJ Idea cannot find location of GO SDK?", "body": "<p>Does not allow to use SDK placed in /usr/local/go (perfectly valid and recent SDK) under Mac Yosemite.\nGoogle App Engine does not recognise last valid GAE GO SDK either.</p>\n"}], "owner": {"reputation": 45698, "user_id": 513413, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e0b73975f75df2f25f8b7cc8ce834f0c?s=128&d=identicon&r=PG", "display_name": "Hesam", "link": "https://stackoverflow.com/users/513413/hesam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18530, "favorite_count": 2, "accepted_answer_id": 27939351, "answer_count": 3, "score": 12, "last_activity_date": 1505301754, "creation_date": 1421216048, "last_edit_date": 1505301732, "question_id": 27936844, "link": "https://stackoverflow.com/questions/27936844/why-intellij-idea-cannot-find-location-of-go-sdk", "title": "Why IntelliJ Idea cannot find location of GO SDK?", "body": "<ol>\n<li>I downloaded <a href=\"https://golang.org/dl/\" rel=\"nofollow noreferrer\">go1.4.darwin-amd64-osx10.8.tar.gz</a> and extract it on my local directory.</li>\n<li>Based on what <a href=\"https://golang.org/doc/install\" rel=\"nofollow noreferrer\">Installing to a custom location</a> says I added GOROOT in env variable.</li>\n<li>Based on what <a href=\"https://golang.org/doc/install\" rel=\"nofollow noreferrer\">Test your installation</a> says I created a go file.</li>\n<li>I finally ran it and I got expected result as following screenshot.</li>\n</ol>\n\n<p><img src=\"https://i.stack.imgur.com/lHowX.png\" alt=\"enter image description here\"></p>\n\n<ul>\n<li>I actually have IntelliJ v.14 however, based on <a href=\"http://dennissuratna.com/setup-intellij-for-golang/\" rel=\"nofollow noreferrer\">this article</a> I installed <code>Go Language (golang.org)</code> version 0.9.15.3 in my IntelliJ Idea.</li>\n<li>I created a Go project and during creation it asked me to add GO SDK. I gave it <code>~/Desktop/go/sdk</code> however it wasn't able to recognise it. I got this error in Event Log:</li>\n</ul>\n\n<blockquote>\n  <p>14:03:02 IllegalArgumentException: Argument for @NotNull parameter\n  'virtualFile' of\n  com/intellij/openapi/projectRoots/impl/ProjectRootContainerImpl.addRoot\n  must not be null</p>\n</blockquote>\n\n<p>Any idea how IntelliJ Idea is able to recognize it would be appreciated. Thanks.</p>\n"}, {"tags": ["string", "go", "slice"], "answers": [{"tags": [], "owner": {"reputation": 1017, "user_id": 2601733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AFDjZ.jpg?s=128&g=1", "display_name": "Andy Xu", "link": "https://stackoverflow.com/users/2601733/andy-xu"}, "is_accepted": true, "score": 74, "last_activity_date": 1421211394, "creation_date": 1421211394, "answer_id": 27936125, "question_id": 27935795, "link": "https://stackoverflow.com/questions/27935795/why-cant-i-append-string-to-byte-slice-as-the-go-reference-specified/27936125#27936125", "title": "Why can&#39;t I append string to byte slice as the Go reference specified?", "body": "<p>You need to use \"...\" as suffix in order to append a slice to another slice.\nLike this: </p>\n\n<pre><code>package main\nimport \"fmt\"\n\nfunc main(){\n    a := []byte(\"hello\")\n    s := \"world\"\n    a = append(a, s...) // use \"...\" as suffice \n    fmt.Printf(\"%s\",a)\n}\n</code></pre>\n\n<p>You could try it here: <a href=\"http://play.golang.org/p/y_v5To1kiD\">http://play.golang.org/p/y_v5To1kiD</a></p>\n"}], "owner": {"reputation": 6945, "user_id": 2288944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/7qryD.jpg?s=128&g=1", "display_name": "armnotstrong", "link": "https://stackoverflow.com/users/2288944/armnotstrong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18266, "favorite_count": 6, "accepted_answer_id": 27936125, "answer_count": 1, "score": 25, "last_activity_date": 1421272426, "creation_date": 1421209132, "last_edit_date": 1421272426, "question_id": 27935795, "link": "https://stackoverflow.com/questions/27935795/why-cant-i-append-string-to-byte-slice-as-the-go-reference-specified", "title": "Why can&#39;t I append string to byte slice as the Go reference specified?", "body": "<p>Quote from the <a href=\"http://golang.org/pkg/builtin/#append\" rel=\"noreferrer\">reference of <code>append</code> of Go</a></p>\n\n<blockquote>\n  <p>As a special case, it is legal to append a string to a byte slice, like this:\n  <br><code>slice = append([]byte(\"hello \"), \"world\"...)</code></p>\n</blockquote>\n\n<p>But I find I can't do that as this snippet:</p>\n\n<pre><code>package main\nimport \"fmt\"\n\nfunc main(){\n    a := []byte(\"hello\")\n    s := \"world\"\n    a = append(a, s) //*Error*: can't use s(type string) as type byte in append \n    fmt.Printf(\"%s\",a)\n}\n</code></pre>\n\n<p>What have I done wrong?</p>\n"}, {"tags": ["selenium", "go", "selenium-webdriver"], "answers": [{"tags": [], "owner": {"reputation": 688, "user_id": 3983857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b9975f00a83a1f2620ffc04df9f9619?s=128&d=identicon&r=PG&f=1", "display_name": "John O.", "link": "https://stackoverflow.com/users/3983857/john-o"}, "is_accepted": true, "score": 2, "last_activity_date": 1421635768, "last_edit_date": 1421635768, "creation_date": 1421261025, "answer_id": 27950207, "question_id": 27934554, "link": "https://stackoverflow.com/questions/27934554/any-waitforjs-function-to-wait-for-some-javascript-code-returns-true/27950207#27950207", "title": "any waitForJs function to wait for some javascript code returns true", "body": "<p>I don't see any wait functions in the golang bindings to Selenium, so you'll most likely need to define your own. This is my first attempt at golang, so bear with me:</p>\n\n<pre><code>type elementCondition func(e WebElement) bool\n\n// Function returns once timeout has expired or the element condition is true\nfunc (e WebElement) WaitForCondition(fn elementCondition, int timeOut) {\n\n    // Loop if the element condition is not true\n    for i:= 0; !elementCondition(e) &amp;&amp; i &lt; timeOut; i++ {\n        time.sleep(1000)\n    }\n}\n</code></pre>\n\n<p>There are two options to define the <code>elementCondition</code>. Your method of using Javascript looks like it could work with the <code>ExecuteScript</code> function documented in <a href=\"https://github.com/fedesog/webdriver/blob/master/webdriver.go\" rel=\"nofollow\">webdriver.go</a></p>\n\n<blockquote>\n  <p>// Inject a snippet of JavaScript into the page for execution in the\n  context of the currently selected frame. The executed script is\n  assumed to be synchronous and the result of evaluating the script is\n  returned to the client.</p>\n</blockquote>\n\n<p>An alternative is to access the element properties through Selenium</p>\n\n<pre><code>func ButtonIsRed(WebElement e) (bool) {\n    return (e.GetCssProperty('color') == 'red')\n}\n</code></pre>\n\n<p>So your code would become</p>\n\n<pre><code>var session *webdriver.Session\n....\n// Locate the button with a css selector\nvar webElement := session.FindElement(CSS_Selector, '#redButton')\n// Wait for the button to be red\nwebElement.WaitForCondition(ButtonIsRed, 10)\n</code></pre>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 27950207, "answer_count": 1, "score": 0, "last_activity_date": 1421635768, "creation_date": 1421199736, "question_id": 27934554, "link": "https://stackoverflow.com/questions/27934554/any-waitforjs-function-to-wait-for-some-javascript-code-returns-true", "title": "any waitForJs function to wait for some javascript code returns true", "body": "<p>This is question about <a href=\"https://github.com/fedesog/webdriver\" rel=\"nofollow\">golang selenium webdriver</a>.</p>\n\n<p>Is there any function that returns only after some js code return true.</p>\n\n<pre><code>var session *webdriver.Session\n...\nsession.waitForJs(`$('#redButton').css('color')=='red'`)\n// next code should be executed only after `#redButton` becomes red\n</code></pre>\n\n<p>The problem is that method <code>session.waitForJs</code> do not exist.</p>\n"}, {"tags": ["go", "html-parsing", "goquery"], "comments": [{"owner": {"reputation": 2903, "user_id": 4257217, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/i1EYW.png?s=128&g=1", "display_name": "GreenRaccoon23", "link": "https://stackoverflow.com/users/4257217/greenraccoon23"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1429030337, "post_id": 27933866, "comment_id": 47408646, "body": "Oops. Thanks for the head&#39;s up!"}], "answers": [{"tags": [], "owner": {"reputation": 2903, "user_id": 4257217, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/i1EYW.png?s=128&g=1", "display_name": "GreenRaccoon23", "link": "https://stackoverflow.com/users/4257217/greenraccoon23"}, "is_accepted": true, "score": 10, "last_activity_date": 1481825140, "last_edit_date": 1481825140, "creation_date": 1421194796, "answer_id": 27933907, "question_id": 27933866, "link": "https://stackoverflow.com/questions/27933866/use-goquery-to-find-a-class-whose-value-contains-whitespace/27933907#27933907", "title": "Use goquery to find a class whose value contains whitespace", "body": "<p>It was a problem with my understanding of HTML. The whitespace inside <code>class=\"text title\"</code> shows that <code>class</code> has two values: <code>text</code> and <code>title</code>. In order to find multiple attributes of a class with <code>goquery</code>, I need to put them side by side (without whitespace) and prefix them with a <code>.</code>. Like this:</p>\n\n<pre><code>doc.Find(\".text.title\").Each(func(i int, s *goquery.Selection) {\n    class, _ := s.Attr(\"class\")\n    fmt.Println(class, s.Text())\n})\n</code></pre>\n\n<p>Or if I ever want to find <strong>only</strong> the classes with the value <code>title</code>, I would do this:</p>\n\n<pre><code>doc.Find(\".title\").Each(func(i int, s *goquery.Selection) {\n    class, _ := s.Attr(\"class\")\n    fmt.Println(class, s.Text())\n})\n</code></pre>\n"}], "owner": {"reputation": 2903, "user_id": 4257217, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/i1EYW.png?s=128&g=1", "display_name": "GreenRaccoon23", "link": "https://stackoverflow.com/users/4257217/greenraccoon23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6706, "favorite_count": 0, "accepted_answer_id": 27933907, "answer_count": 1, "score": 5, "last_activity_date": 1481825140, "creation_date": 1421194529, "last_edit_date": 1445405572, "question_id": 27933866, "link": "https://stackoverflow.com/questions/27933866/use-goquery-to-find-a-class-whose-value-contains-whitespace", "title": "Use goquery to find a class whose value contains whitespace", "body": "<p><em>Answered</em>. User <a href=\"https://stackoverflow.com/users/1094941/puerkitobio\">PuerkitoBio</a> helped me out with his <code>goquery</code> package, and I'm sure I won't be the only one wondering how to do this. <em>(I can mark this question as 'answered' in two days)</em></p>\n\n<p>When using <code>goquery</code> to find classes of html tags, I hit a problem when the class contains whitespace. Here's an example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/PuerkitoBio/goquery\"\n    \"strings\"\n)\n\nfunc main() {\n    html_code := strings.NewReader(`\n&lt;html&gt;\n    &lt;body&gt;\n        &lt;h1&gt;\n            &lt;span class=\"text title\"&gt;Go &lt;/span&gt;\n        &lt;/h1&gt;\n        &lt;p&gt;\n            &lt;span class=\"text\"&gt;totally &lt;/span&gt;\n            &lt;span class=\"post\"&gt;kicks &lt;/span&gt;\n        &lt;/p&gt;\n        &lt;p&gt;\n            &lt;span class=\"text\"&gt;hacks &lt;/span&gt;\n        &lt;/p&gt;\n    &lt;/body&gt;\n&lt;html&gt;\n    `)\n    doc, _ := goquery.NewDocumentFromReader(html_code)\n}\n</code></pre>\n\n<p>If I want to find the class <code>\"text title\"</code>, I thought I would do this:</p>\n\n<pre><code>doc.Find(\".text title\").Each(func(i int, s *goquery.Selection) {\n    class, _ := s.Attr(\"class\")\n    fmt.Println(class, s.Text())\n})\n</code></pre>\n\n<p>But this doesn't work. <em>(Answer is below.)</em></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 2, "creation_date": 1421194209, "post_id": 27933739, "comment_id": 44265268, "body": "Same as it means in C: short for <code>mode = mode | m</code>."}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1421194494, "post_id": 27933739, "comment_id": 44265355, "body": "It happens that I don&#39;t know C either. Am I supposed to learn C before Go?"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1421195142, "post_id": 27933739, "comment_id": 44265514, "body": "I wouldn&#39;t if I were starting out now. But there&#39;s 1000x more info--specifications, tutorials, tricks--about C on the web than there is for go at this point, and many of the basic ideas are similar (like almost all of the operators)."}], "answers": [{"comments": [{"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1421194603, "post_id": 27933786, "comment_id": 44265383, "body": "Interesting...most of them seem undocumented (except the comparison operators)."}], "tags": [], "owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "is_accepted": false, "score": 0, "last_activity_date": 1421194033, "creation_date": 1421194033, "answer_id": 27933786, "question_id": 27933739, "link": "https://stackoverflow.com/questions/27933739/what-operator-means-in-go/27933786#27933786", "title": "What &quot;|=&quot; operator means in Go?", "body": "<p>Is an inplace bitwise OR operator <a href=\"https://golang.org/ref/spec#Operators\" rel=\"nofollow\">https://golang.org/ref/spec#Operators</a>.</p>\n\n<p>There are many others:</p>\n\n<pre><code>+    &amp;     +=    &amp;=     &amp;&amp;    ==    !=        \n-    |     -=    |=     ||    &lt;     &lt;=        \n*    ^     *=    ^=     &lt;-    &gt;     &gt;=        \n/    &lt;&lt;    /=    &lt;&lt;=    ++    =     :=        \n%    &gt;&gt;    %=    &gt;&gt;=    --    !            \n&amp;^   &amp;^=\n</code></pre>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 582, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421194033, "creation_date": 1421193701, "question_id": 27933739, "link": "https://stackoverflow.com/questions/27933739/what-operator-means-in-go", "title": "What &quot;|=&quot; operator means in Go?", "body": "<p>I've found this operator <code>|=</code> and I'm wondering what it means</p>\n\n<pre><code>func getPageInfoMode(r *http.Request) (mode PageInfoMode) {\n    for _, k := range strings.Split(r.FormValue(\"m\"), \",\") {\n        if m, found := modeNames[strings.TrimSpace(k)]; found {\n            mode |= m\n        }\n    }\n    return\n}\n</code></pre>\n"}, {"tags": ["c++", "testing", "go", "swig"], "comments": [{"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 0, "creation_date": 1421204743, "post_id": 27932850, "comment_id": 44267748, "body": "You might have better luck getting a response if you include the exact command you ran and the resulting error in your question."}, {"owner": {"reputation": 799, "user_id": 1060971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e7f6112de0e8e86a6d3a5c19d3e5ac7?s=128&d=identicon&r=PG", "display_name": "vampirewalk", "link": "https://stackoverflow.com/users/1060971/vampirewalk"}, "edited": false, "score": 0, "creation_date": 1429579714, "post_id": 27932850, "comment_id": 47654609, "body": "I encounter the same problem."}], "owner": {"reputation": 3829, "user_id": 1146334, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cL3do.png?s=128&g=1", "display_name": "FuriousGeorge", "link": "https://stackoverflow.com/users/1146334/furiousgeorge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 227, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1421270658, "creation_date": 1421188957, "last_edit_date": 1421270658, "question_id": 27932850, "link": "https://stackoverflow.com/questions/27932850/unable-to-link-lib-when-running-go-test-with-swigcxx", "title": "Unable to link lib when running go test with .swigcxx", "body": "<p>I'm trying to link against a C++ file using SWIG but I've hit a stumbling block. </p>\n\n<p>I've got the following files:</p>\n\n<pre><code>foo.cpp\nfoo.h\nfooParser.cpp\nfooParser.h\nfoo.swigcxx\nfoo_test.go\n</code></pre>\n\n<p>I can run <code>go build</code> and <code>go install</code> just fine, but when I try to run <code>go test</code> I get a bunch of linker errors similar to</p>\n\n<pre><code>/tmp/go-build806262998/github.com/foo/_test/_obj_test/foo.cpp.o: In function `foo::FooParser::parseX()':./FooParser.cpp:138: undefined reference to `foo::Foo&lt;std::string&gt;::Foo(std::string const&amp;)'\n\n\ncollect2: error: ld returned 1 exit status\n/usr/local/go/pkg/tool/linux_amd64/6l: running g++ failed: unsuccessful exit status 0x100\n</code></pre>\n\n<p>foo.swigcxx</p>\n\n<pre><code>%module foo\n%{\n#include \"foo.h\"\n#include \"fooParser.h\"\n%}\n\n%include \"std_string.i\"\n\n%include \"foo.h\"\n%include \"fooParser.h\"\n\n%template(FooString) Foo&lt;std::string&gt;;\n</code></pre>\n\n<p>foo.h</p>\n\n<pre><code>#ifndef _H_Foo\n#define _H_Foo\n\n#include&lt;string&gt;\n\nnamespace foo {\n  template &lt;class T&gt;\n  class Foo\n  {\n  public:\n      Foo(const T &amp;initValue = T());\n  ...\n  };\n}\n</code></pre>\n\n<p>fooParser.h</p>\n\n<pre><code>#ifndef _H_FooParser\n#define _H_FooParser\n\n#include \"foo.h\"\n#include &lt;string&gt;\n\nclass FooParser \n{\n  public:\n  ...\n  Foo&lt;std::string&gt; *parse(const std::string &amp;x) throw (Error);\n  ...\n  private:\n     Foo&lt;std::string&gt; *parseX() throw(Error);\n  ...\n};\n</code></pre>\n\n<p>Why does it complain that it can't find <code>foo::Foo&lt;std::string&gt;::Foo(std::string const&amp;)</code> when I have <code>%template(FooString) Foo&lt;std::string&gt;;</code></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1421191685, "post_id": 27932752, "comment_id": 44264433, "body": "<code>range</code> does what you want, but don&#39;t forget the <code>val, ok</code> form of the receive operator too."}], "answers": [{"tags": [], "owner": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "is_accepted": true, "score": 24, "last_activity_date": 1421188744, "creation_date": 1421188744, "answer_id": 27932801, "question_id": 27932752, "link": "https://stackoverflow.com/questions/27932752/iterate-over-all-the-values-a-channel-sends-until-it-is-closed-in-go/27932801#27932801", "title": "Iterate over all the values a channel sends until it is closed in Go", "body": "<p>You can use the <code>range</code> over the channel. The loop will continue until the channel is closed as you want:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc pinger(c chan string) {\n    for i := 0; i &lt; 3; i++ {\n        c &lt;- \"ping\"\n    }\n    close(c)\n}\n\nfunc main() {\n    var c chan string = make(chan string)\n\n    go pinger(c)\n\n    for msg := range c {\n        fmt.Println(msg)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 7273, "user_id": 2641547, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/660520007/picture?type=large", "display_name": "Spearfisher", "link": "https://stackoverflow.com/users/2641547/spearfisher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9836, "favorite_count": 0, "accepted_answer_id": 27932801, "answer_count": 1, "score": 11, "last_activity_date": 1421188744, "creation_date": 1421188492, "question_id": 27932752, "link": "https://stackoverflow.com/questions/27932752/iterate-over-all-the-values-a-channel-sends-until-it-is-closed-in-go", "title": "Iterate over all the values a channel sends until it is closed in Go", "body": "<p>I am trying to understand how goroutines and channels work. I have a loop sending values to a channel and I'd like to iterate over all the values the channel sends until it is closed.</p>\n\n<p>I have written a simple example here:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc pinger(c chan string) {\n    for i := 0; i &lt; 3; i++ {\n        c &lt;- \"ping\"\n    }\n    close(c)\n}\n\nfunc main() {\n    var c chan string = make(chan string)\n\n    go pinger(c)\n\n    opened := true\n    var msg string\n\n    for opened {\n        msg, opened = &lt;-c\n        fmt.Println(msg)\n    }\n}\n</code></pre>\n\n<p>This gives the expected result but I'd like to know if there is a shorter way of doing this.</p>\n\n<p>Many thanks for your help</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 21722, "user_id": 357705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cb8f635bfd71c18b91e1b0ed5d2ee9?s=128&d=identicon&r=PG", "display_name": "jimt", "link": "https://stackoverflow.com/users/357705/jimt"}, "edited": false, "score": 1, "creation_date": 1421187659, "post_id": 27932451, "comment_id": 44262782, "body": "An interesting primer on lexical scanning in Go can be <a href=\"https://www.youtube.com/watch?v=HxaD_trXwRE\" rel=\"nofollow noreferrer\">viewed here</a>. While you probably can do with something simpler, it will show you where to start."}], "answers": [{"tags": [], "owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "is_accepted": false, "score": 0, "last_activity_date": 1421187805, "creation_date": 1421187805, "answer_id": 27932609, "question_id": 27932451, "link": "https://stackoverflow.com/questions/27932451/using-golang-how-to-read-a-file-contents-between-2-characters/27932609#27932609", "title": "Using Golang, how to read a file contents between 2 characters", "body": "<p>One way to do have a total control is to use <code>text/scanner</code> \nHere is an example of your case: \n<a href=\"http://play.golang.org/p/_9LddtB7R9\" rel=\"nofollow\">http://play.golang.org/p/_9LddtB7R9</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\nimport \"text/scanner\"\n\nvar dnsRecord = `example.com.    SOA     dns1.example.com. hostmaster.example.com. (\n            2001062501 ; serial\n            21600      ; refresh after 6 hours\n            3600       ; retry after 1 hour\n            604800     ; expire after 1 week\n            86400 )    ; minimum TTL of 1 day\n`\n\nfunc main() {\n\n    var s scanner.Scanner\n    s.Init(strings.NewReader(dnsRecord))\n    tok := s.Scan()\n    for tok != scanner.EOF {\n        // do something with tok\n        tok = s.Scan()\n        fmt.Println(s.TokenText())\n    }\n\n}\n</code></pre>\n\n<p>Otherwise you could use a Regex to match a specific line <a href=\"http://golang.org/pkg/regexp/\" rel=\"nofollow\">http://golang.org/pkg/regexp/</a></p>\n"}], "owner": {"reputation": 170, "user_id": 1698668, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/649cd8204d9fd827b2998908c93c7aec?s=128&d=identicon&r=PG", "display_name": "stevo81989", "link": "https://stackoverflow.com/users/1698668/stevo81989"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1421187805, "creation_date": 1421187150, "question_id": 27932451, "link": "https://stackoverflow.com/questions/27932451/using-golang-how-to-read-a-file-contents-between-2-characters", "title": "Using Golang, how to read a file contents between 2 characters", "body": "<p>So I really want to learn go, however its a much harder and confusing language than I thought it would be. My goal is to write a program that edits a dns file. The first step is to open a file and read it into memory. Ok, that was easily accomplished with ioutil.Readfile. So the next thing I need to do is to read only the SOA or read until you encounter a \")\". How on earth would I do this? Here is what the file looks like:</p>\n\n<pre><code>example.com.    SOA     dns1.example.com. hostmaster.example.com. (\n            2001062501 ; serial\n            21600      ; refresh after 6 hours\n            3600       ; retry after 1 hour\n            604800     ; expire after 1 week\n            86400 )    ; minimum TTL of 1 day\n</code></pre>\n\n<p>Ideally the program would start with the line that included \"SOA\" and end with \")\" and also recognize \";\". Where should I start with this? </p>\n"}, {"tags": ["unicode", "encoding", "character-encoding", "go", "unicode-string"], "comments": [{"owner": {"reputation": 2903, "user_id": 4257217, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/i1EYW.png?s=128&g=1", "display_name": "GreenRaccoon23", "link": "https://stackoverflow.com/users/4257217/greenraccoon23"}, "edited": false, "score": 0, "creation_date": 1429204709, "post_id": 27931884, "comment_id": 47500528, "body": "Sudden downvotes? I disagree; I think this is a useful question, especially since I spent a couple hours on Google trying to figure it out without success."}], "answers": [{"comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 6, "creation_date": 1421186030, "post_id": 27932086, "comment_id": 44261960, "body": "More simply: <a href=\"http://play.golang.org/p/wM4auw_R_5\" rel=\"nofollow noreferrer\">strings.Replace(&quot;this string&quot;, &quot; &quot;, &quot;\\u00a0&quot;, -1)</a>."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1421226182, "post_id": 27932086, "comment_id": 44274532, "body": "Didn&#39;t know about the special string([]rune) encoding/conversion! That&#39;s neat."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1429031463, "post_id": 27932086, "comment_id": 47409227, "body": "Or for any white space <code>strings.Map</code> which is effectively what you&#39;ve re-implemented here."}], "tags": [], "owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "is_accepted": true, "score": -1, "last_activity_date": 1421185551, "creation_date": 1421185551, "answer_id": 27932086, "question_id": 27931884, "link": "https://stackoverflow.com/questions/27931884/convert-normal-space-whitespace-to-non-breaking-space/27932086#27932086", "title": "Convert normal space/whitespace to non-breaking space?", "body": "<p>I think a basic way to do it is by creating a simple function:</p>\n\n<p><a href=\"http://play.golang.org/p/YT8Cf917il\" rel=\"nofollow\">http://play.golang.org/p/YT8Cf917il</a></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc ReplaceSpace(s string) string {\n    var result []rune\n    const badSpace = '\\u0020'\n    for _, r := range s {\n        if r == badSpace {\n            result = append(result, '\\u00A0')\n            continue\n        }\n        result = append(result, r)\n    }\n    return string(result)\n}\n\nfunc main() {\n    fmt.Println(ReplaceSpace(\"this string\"))\n}\n</code></pre>\n\n<p>If you need more advanced manipulations you could create something with </p>\n\n<pre><code>\"golang.org/x/text/transform\"\n\"golang.org/x/text/unicode/norm\"\n</code></pre>\n\n<p>Read <a href=\"http://blog.golang.org/normalization\" rel=\"nofollow\">http://blog.golang.org/normalization</a> for more information on how to use it</p>\n"}, {"tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": false, "score": 4, "last_activity_date": 1429031466, "creation_date": 1429031466, "answer_id": 29633446, "question_id": 27931884, "link": "https://stackoverflow.com/questions/27931884/convert-normal-space-whitespace-to-non-breaking-space/29633446#29633446", "title": "Convert normal space/whitespace to non-breaking space?", "body": "<p>Use the documentation to identify the standard <code>strings</code> package as a likely candidate, and then search it (or read through it all, you should know what's available in the standard library/packages of any language you use) to find <a href=\"https://golang.org/pkg/strings/#Map\" rel=\"nofollow\"><code>strings.Map</code></a>.</p>\n\n<p>Then the obvious short simple solution to convert <em>any</em> white space would be:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n    \"unicode\"\n)\n\nfunc main() {\n    const nbsp = '\\u00A0'\n    result := strings.Map(func(r rune) rune {\n        if unicode.IsSpace(r) {\n            return nbsp\n        }\n        return r\n    }, \"this string\")\n\n    fmt.Printf(\"%s \u2192 %[1]q\\n\", result)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/1kJD21kyin\" rel=\"nofollow\"><kbd>Playground</kbd></a></p>\n\n<p>As previously mentioned, if you really only want to replace <code>\" \"</code> then perhaps <code>strings.Replace</code>.</p>\n"}], "owner": {"reputation": 2903, "user_id": 4257217, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/i1EYW.png?s=128&g=1", "display_name": "GreenRaccoon23", "link": "https://stackoverflow.com/users/4257217/greenraccoon23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3096, "favorite_count": 0, "accepted_answer_id": 27932086, "answer_count": 2, "score": 4, "last_activity_date": 1578222025, "creation_date": 1421184652, "last_edit_date": 1578222025, "question_id": 27931884, "link": "https://stackoverflow.com/questions/27931884/convert-normal-space-whitespace-to-non-breaking-space", "title": "Convert normal space/whitespace to non-breaking space?", "body": "<p>This is a simple question, but I still can't figure out how to do it.</p>\n\n<p>Say I have this string:  </p>\n\n<pre><code>x := \"this string\"\n</code></pre>\n\n<p>The whitespace between 'this' and 'string' defaults to the <em>regular</em> unicode whitespace character <code>32/U+0020</code>. How would I convert it into the <em>non-breaking</em> unicode whitespace character <code>U+00A0</code> in Go?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 4, "last_activity_date": 1421181239, "creation_date": 1421181239, "answer_id": 27931006, "question_id": 27930737, "link": "https://stackoverflow.com/questions/27930737/import-c-is-unsupported-in-test-looking-for-alternatives/27931006#27931006", "title": "import &quot;C&quot; is unsupported in test - looking for alternatives", "body": "<p>You have to put the <code>cgo</code> code in a non-test file in your package. You can then wrap any \"C\" calls with private go functions for testing.</p>\n"}], "owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 504, "favorite_count": 1, "accepted_answer_id": 27931006, "answer_count": 1, "score": 3, "last_activity_date": 1421181239, "creation_date": 1421180219, "question_id": 27930737, "link": "https://stackoverflow.com/questions/27930737/import-c-is-unsupported-in-test-looking-for-alternatives", "title": "import &quot;C&quot; is unsupported in test - looking for alternatives", "body": "<p>I am using some shared c code in golang that I want to test. import \"C\" is not supported in \"go test\". Have you seen any alternatives?</p>\n"}, {"tags": ["go", "go-present"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1421179186, "post_id": 27928857, "comment_id": 44258141, "body": "Did you take a look at how package present runs code?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1421179681, "post_id": 27928857, "comment_id": 44258452, "body": "Use a shebang comment to specify the program to run the script."}, {"owner": {"reputation": 1365, "user_id": 2397446, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a17ea754d407238ea83415d1b6145f79?s=128&d=identicon&r=PG", "display_name": "Piyush Chauhan", "link": "https://stackoverflow.com/users/2397446/piyush-chauhan"}, "edited": false, "score": 0, "creation_date": 1421246099, "post_id": 27928857, "comment_id": 44285869, "body": "I tried using this, but I got this error: <code>2015&#47;01&#47;14 20:02:10 bad websocket origin: http:&#47;&#47;localhost:3999</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1365, "user_id": 2397446, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a17ea754d407238ea83415d1b6145f79?s=128&d=identicon&r=PG", "display_name": "Piyush Chauhan", "link": "https://stackoverflow.com/users/2397446/piyush-chauhan"}, "edited": false, "score": 0, "creation_date": 1421246037, "post_id": 27930887, "comment_id": 44285839, "body": "I tried using this, but I got this error: <code>2015&#47;01&#47;14 20:02:10 bad websocket origin: http:&#47;&#47;localhost:3999</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4122236"}, "reply_to_user": {"reputation": 1365, "user_id": 2397446, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a17ea754d407238ea83415d1b6145f79?s=128&d=identicon&r=PG", "display_name": "Piyush Chauhan", "link": "https://stackoverflow.com/users/2397446/piyush-chauhan"}, "edited": false, "score": 0, "creation_date": 1421253508, "post_id": 27930887, "comment_id": 44290822, "body": "@PiyushChauhan It works for me. Are you viewing the presentation at <a href=\"http://localhost:3999\" rel=\"nofollow noreferrer\">localhost:3999</a> or some other URL?"}, {"owner": {"reputation": 1365, "user_id": 2397446, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a17ea754d407238ea83415d1b6145f79?s=128&d=identicon&r=PG", "display_name": "Piyush Chauhan", "link": "https://stackoverflow.com/users/2397446/piyush-chauhan"}, "edited": false, "score": 0, "creation_date": 1421268719, "post_id": 27930887, "comment_id": 44299383, "body": "Yup got the error, I was accessing it on <code>http:&#47;&#47;localhost:3999</code> which is giving me bad websocket origin error. When I switched to <code>http:&#47;&#47;127.0.0.1:3999</code>, it&#39;s working fine. Can you think why it&#39;s happening, not able to connect to websocket on <code>http:&#47;&#47;localhost:3999</code> ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4122236"}, "reply_to_user": {"reputation": 1365, "user_id": 2397446, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a17ea754d407238ea83415d1b6145f79?s=128&d=identicon&r=PG", "display_name": "Piyush Chauhan", "link": "https://stackoverflow.com/users/2397446/piyush-chauhan"}, "edited": false, "score": 0, "creation_date": 1421271084, "post_id": 27930887, "comment_id": 44300717, "body": "@PiyushChauhan By default, the websocket package returns the above error if the request Host header is not equal to the request Origin header. I don&#39;t understand why, but somehow your browser is using two host names for the present server (127.0.0.1 and localhost). Maybe the browser resolves localhost to 127.0.0.1 for only one of the headers. Weird."}, {"owner": {"reputation": 73, "user_id": 5453768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182910af1114b296fcb0294222e22e77?s=128&d=identicon&r=PG&f=1", "display_name": "Mick", "link": "https://stackoverflow.com/users/5453768/mick"}, "edited": false, "score": 0, "creation_date": 1597847990, "post_id": 27930887, "comment_id": 112268048, "body": "is it possible to run node.js code, tried changing the the she bang, but no luck"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4122236"}, "is_accepted": true, "score": 3, "last_activity_date": 1421181140, "last_edit_date": 1421181140, "creation_date": 1421180812, "answer_id": 27930887, "question_id": 27928857, "link": "https://stackoverflow.com/questions/27928857/using-golang-present-package-to-run-ruby-or-python-code/27930887#27930887", "title": "Using golang present package to run ruby or python code", "body": "<p>Present uses a <a href=\"http://en.wikipedia.org/wiki/Shebang_%28Unix%29\" rel=\"nofollow\">shebang</a> comment to determine the program to run. Change your script to:</p>\n\n<pre><code>#! /usr/bin/ruby\nputs 'hello, world'\n</code></pre>\n"}], "owner": {"reputation": 1365, "user_id": 2397446, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a17ea754d407238ea83415d1b6145f79?s=128&d=identicon&r=PG", "display_name": "Piyush Chauhan", "link": "https://stackoverflow.com/users/2397446/piyush-chauhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 928, "favorite_count": 1, "accepted_answer_id": 27930887, "answer_count": 1, "score": 0, "last_activity_date": 1535677935, "creation_date": 1421173235, "last_edit_date": 1535677935, "question_id": 27928857, "link": "https://stackoverflow.com/questions/27928857/using-golang-present-package-to-run-ruby-or-python-code", "title": "Using golang present package to run ruby or python code", "body": "<p>I used Golang present package to build a presentation. I'm able to run Golang code using <code>.play &lt;file&gt;.go</code> in my given .slide file.</p>\n\n<p>I wonder if it's possible to run ruby or python code too using <code>.play &lt;file&gt;.rb</code> or <code>.play &lt;file&gt;.py</code> ?</p>\n\n<blockquote>\n  <p>I tried above method but it's giving me error when I click on <strong>Run</strong>\n  button in browser. Is it possible to run code for other languages ? If\n  Yes, how ? If No, Why not ?</p>\n</blockquote>\n\n<p><strong>check.rb</strong>:</p>\n\n<pre><code>puts 'hello, world'\n</code></pre>\n\n<p></p>\n\n<p><strong>Here is the code for my example.slide file:</strong></p>\n\n<pre><code>Checking the working of Ruby Code\nNothing much here!\n15:04 2 Jan 2006\nTags: Ruby, Golang\n\nPiyush Chauhan\n********************\n********************\n********************\n@piyushpsycho\n\n* Title of slide or section (must have asterisk)\n\nSome Text\n\n.play check.rb\n\n** Subsection\n\n- bullets\n- more bullets\n- a bullet with\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1540, "user_id": 1728142, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/82970b044b5a9289d4d6a22e9781edbc?s=128&d=identicon&r=PG", "display_name": "Davide Guerri", "link": "https://stackoverflow.com/users/1728142/davide-guerri"}, "edited": false, "score": 0, "creation_date": 1422438224, "post_id": 27928865, "comment_id": 44745964, "body": "After your &quot;edit&quot;, this answer now explains why we have that behaviour, thanks."}, {"owner": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "edited": false, "score": 0, "creation_date": 1495536944, "post_id": 27928865, "comment_id": 75284053, "body": "<i><b>Edit:</b> I fixed the link. The given link was not working. give links by pointing to a commit, not the master, it can change.</i>"}], "tags": [], "owner": {"reputation": 1903, "user_id": 1549474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2766dac2718e51b8c5f4f021c8e740c4?s=128&d=identicon&r=PG", "display_name": "tumdum", "link": "https://stackoverflow.com/users/1549474/tumdum"}, "is_accepted": true, "score": 14, "last_activity_date": 1495536930, "last_edit_date": 1495536930, "creation_date": 1421173265, "answer_id": 27928865, "question_id": 27928744, "link": "https://stackoverflow.com/questions/27928744/an-infinite-loop-produced-by-fmt-sprinte-inside-the-error-method/27928865#27928865", "title": "An infinite loop produced by fmt.Sprint(e) inside the Error method", "body": "<p>It seems it's explained <a href=\"https://github.com/golang/go/blob/2ed57a8cd86cec36b8370fb16d450e5a29a9375f/src/pkg/fmt/print.go#L639\" rel=\"noreferrer\">directly</a> is source of fmt package:</p>\n\n<pre><code>// Is it an error or Stringer?\n// The duplication in the bodies is necessary:\n// setting handled and deferring catchPanic\n// must happen before calling the method.\n</code></pre>\n\n<p>And than <a href=\"http://golang.org/src/fmt/print.go?s=6663:6699#L714\" rel=\"noreferrer\">Error()</a> or <a href=\"http://golang.org/src/fmt/print.go?s=6663:6699#L720\" rel=\"noreferrer\">String()</a> is called.</p>\n\n<p>What it means is that first <a href=\"http://golang.org/pkg/builtin/#error\" rel=\"noreferrer\">error.Error()</a> is called to produce string, which is than once again processed and is printed as string.</p>\n\n<p>Whether <code>error</code> has method <code>String</code> is irrelevant here. The question is why <code>NegativeSqrt</code> is printed with one method and not the other. Type <code>NegativeSqrt</code> implements both <code>fmt.Stringer</code> and <code>error</code> interfaces so it's up to the implementation of <code>fmt</code> package which of interfaces should be used to get <code>string</code> from <code>NegativeSqrt</code> (since <a href=\"http://golang.org/src/fmt/print.go?s=6663:6699#L237\" rel=\"noreferrer\">fmt.Sprint</a> takes its parameters by <code>interface{}</code>).</p>\n\n<p>To illustrate this consider this example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype NegativeSqrt float64\n\nfunc (e NegativeSqrt) Error() string {\n    return \"\"\n}\n\nfunc (e NegativeSqrt) String() string {\n    return \"\"\n}\n\nfunc check(val interface{}) {\n    switch val.(type) {\n    case fmt.Stringer:\n        fmt.Println(\"It's stringer\")\n    case error:\n        fmt.Println(\"It's error\")\n    }\n}\n\nfunc check2(val interface{}) {\n    switch val.(type) {\n    case error:\n        fmt.Println(\"It's error\")\n    case fmt.Stringer:\n        fmt.Println(\"It's stringer\")\n    }\n}\n\nfunc main() {\n    var v NegativeSqrt\n    check(v)\n    check2(v)\n}\n</code></pre>\n\n<p>Executing this gives:</p>\n\n<pre><code>% go run a.go\nIt's stringer\nIt's error\n</code></pre>\n\n<p>This is because in Go type switch behaves just like normal switch, so <a href=\"https://golang.org/doc/effective_go.html#switch\" rel=\"noreferrer\">order of cases matters</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 1540, "user_id": 1728142, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/82970b044b5a9289d4d6a22e9781edbc?s=128&d=identicon&r=PG", "display_name": "Davide Guerri", "link": "https://stackoverflow.com/users/1728142/davide-guerri"}, "edited": false, "score": 0, "creation_date": 1421184583, "post_id": 27928948, "comment_id": 44261205, "body": "Tomasz K\u0142ak&#39;s answer is also brilliant but this one explains why it is implemented this way."}, {"owner": {"reputation": 1903, "user_id": 1549474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2766dac2718e51b8c5f4f021c8e740c4?s=128&d=identicon&r=PG", "display_name": "tumdum", "link": "https://stackoverflow.com/users/1549474/tumdum"}, "edited": false, "score": 1, "creation_date": 1421345788, "post_id": 27928948, "comment_id": 44333108, "body": "I don&#39;t think that this question is on topic/correct."}], "tags": [], "owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "is_accepted": false, "score": 5, "last_activity_date": 1421173596, "creation_date": 1421173596, "answer_id": 27928948, "question_id": 27928744, "link": "https://stackoverflow.com/questions/27928744/an-infinite-loop-produced-by-fmt-sprinte-inside-the-error-method/27928948#27928948", "title": "An infinite loop produced by fmt.Sprint(e) inside the Error method", "body": "<p>Because the type is <code>error</code> and the interface of <code>error</code> is</p>\n\n<pre><code>  type error interface{\n     Error() string\n  }\n</code></pre>\n\n<p>every <code>error</code> must have an <code>Error() string</code> method but does not have to have a <code>String() string</code> method. That why is logic to check first the <code>Error()</code> method. </p>\n"}, {"tags": [], "owner": {"reputation": 2673, "user_id": 402534, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/UTUiF.jpg?s=128&g=1", "display_name": "fyodorananiev", "link": "https://stackoverflow.com/users/402534/fyodorananiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1466929741, "creation_date": 1466929741, "answer_id": 38036611, "question_id": 27928744, "link": "https://stackoverflow.com/questions/27928744/an-infinite-loop-produced-by-fmt-sprinte-inside-the-error-method/38036611#38036611", "title": "An infinite loop produced by fmt.Sprint(e) inside the Error method", "body": "<p>Let me expand tumdum's finding for better clarity.</p>\n\n<p>I'll jump from a call to call to show how we go into loop.</p>\n\n<p>We start from the exercise's </p>\n\n<pre><code>func (e NegativeSqrt) Error() string {\n  fmt.Printf(\".\")\n  return fmt.Sprint(e)\n}\n</code></pre>\n\n<p>Which delivers us to a line 237 of the <a href=\"https://golang.org/src/fmt/print.go\" rel=\"nofollow\">fmt/print.go</a>:</p>\n\n<pre><code>func Sprint(a ...interface{}) string\n</code></pre>\n\n<p>Inside the function, our next jump is on line 239:</p>\n\n<pre><code>p.doPrint(a, false, false)\n</code></pre>\n\n<p>We arrive to line 1261:</p>\n\n<pre><code>func (p *pp) doPrint(a []interface{}, addspace, addnewline bool) {\n</code></pre>\n\n<p>Inside that function, we'll jump, with our <code>error</code> argument, through line 1273:</p>\n\n<pre><code>prevString = p.printArg(arg, 'v', 0)\n</code></pre>\n\n<p>We arrive at a huge core monster function at line 738:</p>\n\n<pre><code>func (p *pp) printArg(arg interface{}, verb rune, depth int) (wasString bool) {\n</code></pre>\n\n<p>Inside that, you can see a large <code>switch case</code> switch. <code>error</code> goes in the <code>default</code> section as it is deemed to be a non-trivial type.</p>\n\n<p>Which delivers us to line 806 with the call to <code>handleMethods()</code>:</p>\n\n<pre><code>if handled := p.handleMethods(verb, depth); handled {\n</code></pre>\n\n<p>We arrive at  line 688:</p>\n\n<pre><code>func (p *pp) handleMethods(verb rune, depth int) (handled bool) {\n</code></pre>\n\n<p>Inside of that function, on line 724, call to <code>Error()</code> happens, which completes the loop:</p>\n\n<pre><code>p.printArg(v.Error(), verb, depth)\n</code></pre>\n"}], "owner": {"reputation": 1540, "user_id": 1728142, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/82970b044b5a9289d4d6a22e9781edbc?s=128&d=identicon&r=PG", "display_name": "Davide Guerri", "link": "https://stackoverflow.com/users/1728142/davide-guerri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2559, "favorite_count": 2, "accepted_answer_id": 27928865, "answer_count": 3, "score": 13, "last_activity_date": 1495536930, "creation_date": 1421172850, "last_edit_date": 1495535373, "question_id": 27928744, "link": "https://stackoverflow.com/questions/27928744/an-infinite-loop-produced-by-fmt-sprinte-inside-the-error-method", "title": "An infinite loop produced by fmt.Sprint(e) inside the Error method", "body": "<p>According to fortyforty's reply to <a href=\"https://stackoverflow.com/questions/27474907/error-infinite-loop\">this question</a>:</p>\n\n<blockquote>\n  <p><code>fmt.Sprint(e)</code> will call <code>e.Error()</code> to convert the value <code>e</code> to a\n  <code>string</code>. If the <code>Error()</code> method calls <code>fmt.Sprint(e)</code>, then the\n  program recurses until out of memory.</p>\n  \n  <p>You can break the recursion by converting the <code>e</code> to a value without a\n  <code>String</code> or <code>Error</code> method.</p>\n</blockquote>\n\n<p>This is still confusing to me. Why does fmt.Sprint(e) call e.Error() instead of String()? I tried using the Stringer interface, this is my code:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"math\"\n)\n\ntype NegativeSqrt float64\n\nfunc (e NegativeSqrt) Error() string {\n  fmt.Printf(\".\")\n  return fmt.Sprint(e)\n}\n\nfunc (e NegativeSqrt) String() string {\n  return fmt.Sprintf(\"%f\", e)\n}\n\nfunc Sqrt(x float64) (float64, error) {\n  if x &lt; 0 {\n    return 0, NegativeSqrt(x)\n  }\n  return math.Sqrt(x), nil\n}\n\nfunc main() {\n  fmt.Println(Sqrt(2))\n  fmt.Println(Sqrt(-2))\n}\n</code></pre>\n"}, {"tags": ["python", "json", "go"], "comments": [{"owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "edited": false, "score": 1, "creation_date": 1421173655, "post_id": 27927035, "comment_id": 44254943, "body": "duplicate keys in json is not valid json. isn&#39;t it?"}, {"owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 1, "creation_date": 1421173695, "post_id": 27927035, "comment_id": 44254967, "body": "The JSON decoder in Go allows for custom deserialization through the <code>Unmarshaler</code> interface.  You can use this interface in favor of the object hook mechanism in Python&#39;s <code>json</code> library.  <a href=\"http://golang.org/pkg/encoding/json/#Unmarshaler\" rel=\"nofollow noreferrer\">golang.org/pkg/encoding/json/#Unmarshaler</a>"}, {"owner": {"reputation": 359, "user_id": 552641, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/279c4f78d46e503ec487e1b50d728ae4?s=128&d=identicon&r=PG", "display_name": "Ken", "link": "https://stackoverflow.com/users/552641/ken"}, "reply_to_user": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "edited": false, "score": 0, "creation_date": 1421184230, "post_id": 27927035, "comment_id": 44261023, "body": "@fabrizioM correct, but invalid JSON does occasionally show up, from being manually generated or hand-edited. The Python JSON packages I used silently ignored duplicate keys; if you decoded this pseudo-json: a:1, b:2, a:3 it would give you b:2, a:3 as output - the last key value trumped earlier values. I would have preferred it errored on that instead of failing silently."}], "answers": [{"comments": [{"owner": {"reputation": 98, "user_id": 1656318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2714dccaaccf0f57f0e95a28904c321?s=128&d=identicon&r=PG", "display_name": "Joy Peterson", "link": "https://stackoverflow.com/users/1656318/joy-peterson"}, "edited": false, "score": 1, "creation_date": 1536278107, "post_id": 27993906, "comment_id": 91376482, "body": "It looks like the github repo for the JSON scanner no longer exists."}], "tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": false, "score": 1, "last_activity_date": 1421447854, "creation_date": 1421447854, "answer_id": 27993906, "question_id": 27927035, "link": "https://stackoverflow.com/questions/27927035/golang-detecting-duplicate-keys-in-json-input/27993906#27993906", "title": "Golang - detecting duplicate keys in JSON input", "body": "<p>What you need is a json library which works like a <code>bufio.Scanner</code> or SAX. One is implemented here: <a href=\"http://github.com/garyburd/json\" rel=\"nofollow\">github.com/garyburd/json</a>. It will generate events as it scans which you can use to discover duplicate keys.</p>\n\n<p>Here's an example of how to use it:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/garyburd/json\"\n    \"io\"\n    \"strings\"\n)\n\ntype Nothing struct{}\ntype Context struct {\n    Kind json.Kind\n    Keys map[string]Nothing\n}\n\nfunc Validate(rdr io.Reader) error {\n    scanner := json.NewScanner(rdr)\n    stack := []Context{}\n    for scanner.Scan() {\n        if scanner.Kind() == json.Object || scanner.Kind() == json.Array {\n            stack = append(stack, Context{\n                Kind: scanner.Kind(),\n                Keys: map[string]Nothing{},\n            })\n        } else if scanner.Kind() == json.End {\n            if len(stack) == 0 {\n                return fmt.Errorf(\"expected start object or array\")\n            }\n            stack = stack[:len(stack)-1]\n        } else if len(stack) &gt; 0 {\n            current := stack[len(stack)-1]\n            if current.Kind == json.Object {\n                key := string(scanner.Name())\n                _, exists := current.Keys[key]\n                if exists {\n                    return fmt.Errorf(\"found duplicate key: %v\", key)\n                }\n                current.Keys[key] = Nothing{}\n            }\n        }\n    }\n    return nil\n}\n\nfunc main() {\n    rdr := strings.NewReader(`\n        {\n            \"x\": 10,\n            \"y\": {\n                \"z\": 1,\n                \"z\": 2\n            },\n            \"z\": [1,2,3,4,5]\n        }\n    `)\n    err := Validate(rdr)\n    if err == nil {\n        fmt.Println(\"valid json!\")\n    } else {\n        fmt.Println(\"invalid json:\", err)\n    }\n}\n</code></pre>\n\n<p>As it walks through the JSON object it builds a stack of hash tables. (for nested objects / arrays) Any duplicate keys in one of those hash tables results in an error. If you need more detail you could easily add a <code>Name</code> property to the <code>Context</code> and walk the stack backwards to generate a json path. (like <code>a.b.c.d is a duplicate key</code>)</p>\n"}], "owner": {"reputation": 359, "user_id": 552641, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/279c4f78d46e503ec487e1b50d728ae4?s=128&d=identicon&r=PG", "display_name": "Ken", "link": "https://stackoverflow.com/users/552641/ken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1289, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1421447854, "creation_date": 1421167063, "question_id": 27927035, "link": "https://stackoverflow.com/questions/27927035/golang-detecting-duplicate-keys-in-json-input", "title": "Golang - detecting duplicate keys in JSON input", "body": "<p>I recently completed a project where I used the \"object hook\" in Python to detect whether a JSON key was a duplicate of another key. Normal JSON decoders seem to just give the last value encountered, but I would like to be able to detect and return an error. My new project (at new company) is to write this in golang, so wondering if there is a similar method to Python's object hook. I had also used a different object hook to get an \"ordered dict\" in Python; essentially a list form of the JSON input, with the ordering of the original JSON preserved. Haven't been tasked with that in golang yet, but I bet it's coming.... anyway, input on either of these JSON capabilities as relate to golang appreciated!</p>\n"}, {"tags": ["recursion", "go", "dereference", "panic"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1421161254, "post_id": 27924938, "comment_id": 44247033, "body": "Does it panic immediately, or after some time?"}, {"owner": {"reputation": 31, "user_id": 4449741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633d2db777e0bb5a0ea2628434814efd?s=128&d=identicon&r=PG&f=1", "display_name": "Misa Misa", "link": "https://stackoverflow.com/users/4449741/misa-misa"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1421163512, "post_id": 27924938, "comment_id": 44248571, "body": "After a lot of time, about 4 hours of execution. So it must be a really specific scenario."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4449741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633d2db777e0bb5a0ea2628434814efd?s=128&d=identicon&r=PG&f=1", "display_name": "Misa Misa", "link": "https://stackoverflow.com/users/4449741/misa-misa"}, "edited": false, "score": 0, "creation_date": 1421163851, "post_id": 27925261, "comment_id": 44248816, "body": "Well I feel relieved already having in mind that all of the answers (3) currently are suggesting the same thing. Thank you - I will try it and update."}], "tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": false, "score": 1, "last_activity_date": 1421161816, "creation_date": 1421161816, "answer_id": 27925261, "question_id": 27924938, "link": "https://stackoverflow.com/questions/27924938/with-recursive-functions-in-go-if-the-inner-function-returns-does-the-outer-fu/27925261#27925261", "title": "With recursive functions in Go, if the inner function returns, does the outer function continue execution normally?", "body": "<p>You need to return after your first registerDomain call or you will panic on ioutil.ReadAll when your call to registerDomain finishes </p>\n\n<pre><code>//building the request here \nresp, errr := client.Do(r)\nif errr != nil { \n    if n == 1 {\n        return false\n    }\n    return registerDomain(domainName, n-1)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 4449741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633d2db777e0bb5a0ea2628434814efd?s=128&d=identicon&r=PG&f=1", "display_name": "Misa Misa", "link": "https://stackoverflow.com/users/4449741/misa-misa"}, "edited": false, "score": 0, "creation_date": 1421163634, "post_id": 27925263, "comment_id": 44248661, "body": "Yes, this fits perfectly, I will try it and I will update after the execution if this was the solution or not. Thanks!"}], "tags": [], "owner": {"reputation": 1903, "user_id": 1549474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2766dac2718e51b8c5f4f021c8e740c4?s=128&d=identicon&r=PG", "display_name": "tumdum", "link": "https://stackoverflow.com/users/1549474/tumdum"}, "is_accepted": false, "score": 2, "last_activity_date": 1421161820, "creation_date": 1421161820, "answer_id": 27925263, "question_id": 27924938, "link": "https://stackoverflow.com/questions/27924938/with-recursive-functions-in-go-if-the-inner-function-returns-does-the-outer-fu/27925263#27925263", "title": "With recursive functions in Go, if the inner function returns, does the outer function continue execution normally?", "body": "<p>Change </p>\n\n<pre><code>registerDomain(domainName, n-1)\n</code></pre>\n\n<p>to </p>\n\n<pre><code>return registerDomain(domainName, n-1)\n</code></pre>\n\n<p>This way outer function will not continue executing and will not read from nil body.</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 4449741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633d2db777e0bb5a0ea2628434814efd?s=128&d=identicon&r=PG&f=1", "display_name": "Misa Misa", "link": "https://stackoverflow.com/users/4449741/misa-misa"}, "edited": false, "score": 0, "creation_date": 1421163728, "post_id": 27925276, "comment_id": 44248722, "body": "Thank you! I will try to add the return before the registerDomain recursive call and update this post if that was the problem, but I feel confident that this was it because it makes perfect sense."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1421161873, "creation_date": 1421161873, "answer_id": 27925276, "question_id": 27924938, "link": "https://stackoverflow.com/questions/27924938/with-recursive-functions-in-go-if-the-inner-function-returns-does-the-outer-fu/27925276#27925276", "title": "With recursive functions in Go, if the inner function returns, does the outer function continue execution normally?", "body": "<p>Inside the <code>registerDomain()</code> function there are 2 places where you call itself.</p>\n\n<p>If the <code>client.Do()</code> failes (<code>errr != nil</code>), you will call <code>registerDomain()</code> again. Sometime it will return, and when it does, your code execution will continue, trying to read from <code>resp.Body</code> but that most likely is <code>nil</code> because <code>errr != nil</code>.</p>\n\n<p>Here is how you should handle it:</p>\n\n<p>Whenever you make a recursive call, you should not let code continue when that call returns, but return the value it returned, something like this:</p>\n\n<pre><code>return registerDomain(domainName, n-1)\n</code></pre>\n\n<h2>Alternative</h2>\n\n<p>The problem you're trying to solve can be solved without recursion using a <code>for</code> statement. The <code>for</code> variant will even be clearer and more simple.</p>\n\n<p>Modify your <code>registerDomain()</code> function to return false at each point it calls itself, and use this loop to retry 5 times:</p>\n\n<pre><code>var result bool\nfor i := 0; i &lt; 5; i++ {\n    result = registerDomain(domainName) // You don't need to pass n anymore\n    if result {\n        break\n    }\n}\n\nif result {\n    fmt.Println(\"Domain registered successfully!\")\n} else {\n    fmt.Println(\"Failed to register domain!\")\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4449741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633d2db777e0bb5a0ea2628434814efd?s=128&d=identicon&r=PG&f=1", "display_name": "Misa Misa", "link": "https://stackoverflow.com/users/4449741/misa-misa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 361, "favorite_count": 0, "accepted_answer_id": 27925276, "answer_count": 3, "score": 2, "last_activity_date": 1421239297, "creation_date": 1421160925, "last_edit_date": 1421239297, "question_id": 27924938, "link": "https://stackoverflow.com/questions/27924938/with-recursive-functions-in-go-if-the-inner-function-returns-does-the-outer-fu", "title": "With recursive functions in Go, if the inner function returns, does the outer function continue execution normally?", "body": "<p>Okay, so I have this piece of code </p>\n\n<pre><code>func registerDomain(domainName string, n int) bool {\n    //building the request here \n    resp, errr := client.Do(r)\n    if errr != nil { \n        if n == 1 {\n            return false\n        }\n        registerDomain(domainName, n-1)\n    }\n\n    bodyBytes, err2 := ioutil.ReadAll(resp.Body)\n    if err2 == nil {\n        resp.Body.Close()\n        //handle bodyBytes\n        //if the response is how it should be return true, if it's not call the function again with n-1\n    } else { //if there is an error reading the response\n        resp.Body.Close()\n        if n == 1 {\n            return false\n        }\n        registerDomain(domainName, n-1)\n    }\n    return false //it should never reach this line\n}\n</code></pre>\n\n<p>Explanation: </p>\n\n<p>I call the function with an argument n (let's say 5) that represents the number of times the function will retry if something is not right. Every time something is wrong I make a recursive call with n-1 so when it reaches n=1 it gives up and returns false. This code works fine in practice, it does what it's supposed to do, sometimes when the response is not correct it calls itself recursively and it works the second (or 3rd, 4th..) time around. When the problem isn't fixed before n=1 it returns false.</p>\n\n<p>The problem: </p>\n\n<p>This is a part of a big code that is supposed to run for about 17 hours and it panics when it tries to read from the body sometimes on this line:</p>\n\n<pre><code>bodyBytes, err2 := ioutil.ReadAll(resp.Body)\n</code></pre>\n\n<p>it says panic: runtime error: invalid memory address or nil pointer dereference. Now I know that probably means that it's trying to read from a nonexistent resp.Body but the <a href=\"http://golang.org/pkg/net/http/#Client.Do\" rel=\"nofollow\">Go documentation</a> clearly states that <strong>When err is nil, resp always contains a non-nil resp.Body</strong>. </p>\n\n<p>So, in my head it's probably something with the recursive calls. The <em>only</em> thing that makes sense to me is this scenario: lets say that the errr is not nil (this means that the resp.Body doesn't exist), so it goes inside of the if errr != nil and because n!=1, it will call itself again with n=4. Let's say this time everything is as it should be and the second function returns true to the first one <strong>BUT</strong> the first one continues with execution and tries to read from the resp.Body which doesn't exist. That causes panic and here we are...</p>\n\n<p>So, what I need is someone that knows exactly how recursive functions work and if it's not that, can I somehow check the existence of resp.Body before I read form it, or something that will help.</p>\n\n<p>Thanks anyways! :)</p>\n\n<p><strong>UPDATE:</strong> You were all right, my code doesn't panic anymore and neither do I. Thank you very much! (I'm not sure if this is where the update goes) </p>\n"}, {"tags": ["go", "beego"], "comments": [{"owner": {"reputation": 1948, "user_id": 1924657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/gumlg.jpg?s=128&g=1", "display_name": "Bryce", "link": "https://stackoverflow.com/users/1924657/bryce"}, "edited": false, "score": 0, "creation_date": 1486542418, "post_id": 27922410, "comment_id": 71385012, "body": "Is this line <code>defer toolbox.StopTask()</code> called in the main function or init function. If it&#39;s not in the main function, delete this line and try."}], "answers": [{"comments": [{"owner": {"reputation": 8564, "user_id": 841090, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/CYTJH.jpg?s=128&g=1", "display_name": "Passionate Engineer", "link": "https://stackoverflow.com/users/841090/passionate-engineer"}, "edited": false, "score": 0, "creation_date": 1421189044, "post_id": 27928953, "comment_id": 44263397, "body": "I tried this in the task but now when I do bee run the app wouldn&#39;t run completely stopping in the middle. I&#39;m calling this task func from my main.go init function"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1421173616, "creation_date": 1421173616, "answer_id": 27928953, "question_id": 27922410, "link": "https://stackoverflow.com/questions/27922410/beego-admin-task-page-not-working/27928953#27928953", "title": "Beego Admin Task page not working", "body": "<p>It could be a synchronization issue (no wait/delay after the <code>AddTask</code>/<code>StartTask</code> steps).<br>\nTry and see if defining several Tasks the way they are defined in <a href=\"https://github.com/astaxie/beego/blob/a144769515b8ddfb69046b3ef9e29c38bab94f3b/toolbox/task_test.go\" rel=\"nofollow\"><code>toolbox/task_test.go</code></a> would work better:</p>\n\n<pre><code>func TestSpec(t *testing.T) {\n    wg := &amp;sync.WaitGroup{}\n    wg.Add(2)\n    tk1 := NewTask(\"tk1\", \"0 12 * * * *\", func() error { fmt.Println(\"tk1\"); return nil })\n    tk2 := NewTask(\"tk2\", \"0,10,20 * * * * *\", func() error { fmt.Println(\"tk2\"); wg.Done(); return nil })\n    tk3 := NewTask(\"tk3\", \"0 10 * * * *\", func() error { fmt.Println(\"tk3\"); wg.Done(); return nil })\n\n    AddTask(\"tk1\", tk1)\n    AddTask(\"tk2\", tk2)\n    AddTask(\"tk3\", tk3)\n    StartTask()\n    defer StopTask()\n\n    select {\n    case &lt;-time.After(200 * time.Second):\n        t.FailNow()\n    case &lt;-wait(wg):\n    }\n}\n\nfunc wait(wg *sync.WaitGroup) chan bool {\n    ch := make(chan bool)\n    go func() {\n        wg.Wait()\n        ch &lt;- true\n    }()\n    return ch\n}\n</code></pre>\n"}], "owner": {"reputation": 8564, "user_id": 841090, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/CYTJH.jpg?s=128&g=1", "display_name": "Passionate Engineer", "link": "https://stackoverflow.com/users/841090/passionate-engineer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 416, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1421173616, "creation_date": 1421152757, "question_id": 27922410, "link": "https://stackoverflow.com/questions/27922410/beego-admin-task-page-not-working", "title": "Beego Admin Task page not working", "body": "<p>In Beego admin Tasks page to make the Task Spec appear and Run button to work? Run button doesn't seem to work and just links to <code>http://localhost:8888/task?taskname=</code> without any task name.</p>\n\n<p>Is there a reason why? Below is my code for Task: </p>\n\n<pre><code>tk1 := toolbox.NewTask(\"task1\", \"0/10 * * * * * \", func() error {\n    fmt.Printf(\"task1 task ran at: %s\\n\", time.Now())\n    return nil\n})\n\ntoolbox.AddTask(\"task1\", tk1)\ntoolbox.StartTask()\ndefer toolbox.StopTask()\n</code></pre>\n"}, {"tags": ["variables", "go", "var"], "answers": [{"comments": [{"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 1, "creation_date": 1421144795, "post_id": 27919847, "comment_id": 44237313, "body": "Too quick and much more detailed than mine. Nice answer. +1"}, {"owner": {"reputation": 6945, "user_id": 2288944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/7qryD.jpg?s=128&g=1", "display_name": "armnotstrong", "link": "https://stackoverflow.com/users/2288944/armnotstrong"}, "edited": false, "score": 1, "creation_date": 1421145324, "post_id": 27919847, "comment_id": 44237618, "body": "Thanks for your answer, but why  they don&#39;t like us to using the <code>:=</code> format outside the function scope ? I can&#39;t find that could be harmful."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 6945, "user_id": 2288944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/7qryD.jpg?s=128&g=1", "display_name": "armnotstrong", "link": "https://stackoverflow.com/users/2288944/armnotstrong"}, "edited": false, "score": 3, "creation_date": 1421147492, "post_id": 27919847, "comment_id": 44238748, "body": "@armnotstrong At the file level everything (comments excluded) has to start with a keyword, e.g. <code>package</code>, <code>import</code>, <code>const</code>, <code>type</code> <code>var</code>, <code>func</code>."}, {"owner": {"reputation": 11270, "user_id": 590088, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ed3c16678b7536774b5eef75cee2e764?s=128&d=identicon&r=PG", "display_name": "eran otzap", "link": "https://stackoverflow.com/users/590088/eran-otzap"}, "edited": false, "score": 0, "creation_date": 1465193912, "post_id": 27919847, "comment_id": 62781079, "body": "<a href=\"https://golang.org/doc/effective_go.html\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html</a>.          _______.    What does the variable relationship part mean from the go docs ? ______  &quot;Grouping can also indicate relationships between items, such as the fact that a set of variables is protected by a mutex.&quot;  var (     countLock   sync.Mutex     inputCount  uint32     outputCount uint32     errorCount  uint32 )"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 56, "last_activity_date": 1542794067, "last_edit_date": 1542794067, "creation_date": 1421144609, "answer_id": 27919847, "question_id": 27919359, "link": "https://stackoverflow.com/questions/27919359/why-there-are-two-ways-of-declaring-variables-in-go-whats-the-difference-and-w/27919847#27919847", "title": "Why there are two ways of declaring variables in Go, what&#39;s the difference and which to use?", "body": "<p>The <a href=\"http://golang.org/ref/spec#Variable_declarations\" rel=\"noreferrer\">Variable declarations</a> make it clear that variables are declared. The <code>var</code> keyword is required, it is short and expresses what is done (at the file level everything excluding comments  has to start with a keyword, e.g. <code>package</code>, <code>import</code>, <code>const</code>, <code>type</code>, <code>var</code>, <code>func</code>). Like any other block, variable declarations can be grouped like this:</p>\n\n<pre><code>var (\n    count int\n    sum   float64\n)\n</code></pre>\n\n<p>You can't do that with <a href=\"http://golang.org/ref/spec#Short_variable_declarations\" rel=\"noreferrer\">Short variable declarations</a>. Also you can use Variable declarations without specifying the initial value in which case each variable will have the zero value of its type. The Short variable declaration does not allow this, you have to specify the initial value.</p>\n\n<p>One of Go's guiding design principle was to make the syntax clean. Many statements require or it is handy that they allow declaring local variables which will be only available in the body of the statement such as <code>for</code>, <code>if</code>, <code>switch</code> etc. To make the syntax cleaner and shorter, Short variable declaration is justified in these cases and it is unambigous what they do.</p>\n\n<pre><code>for idx, value := range array {\n    // Do something with index and value\n}\n\nif num := runtime.NumCPU(); num &gt; 1 {\n    fmt.Println(\"Multicore CPU, cores:\", num)\n}\n</code></pre>\n\n<p><strong>Another difference: Redeclaration</strong></p>\n\n<p>Quoting from the Language specification:</p>\n\n<blockquote>\n  <p>Unlike regular variable declarations, a short variable declaration may redeclare variables provided they were originally declared earlier in the same block with the same type, and at least one of the non-blank variables is new. As a consequence, redeclaration can only appear in a multi-variable short declaration. Redeclaration does not introduce a new variable; it just assigns a new value to the original.</p>\n</blockquote>\n\n<p>This one is also handy. Suppose you want to do proper error handling, you can reuse an <code>err</code> variable because most likely you only need it to check if there were any errors during the last function call:</p>\n\n<pre><code>var name = \"myfile.txt\"\n\nfi, err := os.Stat(name) // fi and err both first declared\nif err != nil {\n    log.Fatal(err)\n}\nfmt.Println(name, fi.Size(), \"bytes\")\n\ndata, err := ioutil.ReadFile(name) // data is new but err already exists\n                                   // so just a new value is assigned to err\nif err != nil {\n    log.Fatal(err)\n}\n\n// Do something with data\n</code></pre>\n"}], "owner": {"reputation": 6945, "user_id": 2288944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/7qryD.jpg?s=128&g=1", "display_name": "armnotstrong", "link": "https://stackoverflow.com/users/2288944/armnotstrong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15203, "favorite_count": 13, "accepted_answer_id": 27919847, "answer_count": 1, "score": 35, "last_activity_date": 1542794067, "creation_date": 1421143032, "last_edit_date": 1514706884, "question_id": 27919359, "link": "https://stackoverflow.com/questions/27919359/why-there-are-two-ways-of-declaring-variables-in-go-whats-the-difference-and-w", "title": "Why there are two ways of declaring variables in Go, what&#39;s the difference and which to use?", "body": "<p>According to the Go reference there are two ways of declaring a variable</p>\n\n<p><a href=\"http://golang.org/ref/spec#Variable_declarations\" rel=\"noreferrer\">Variable_declarations</a> (in the format of <code>var count = 0</code> or <code>var count int</code>)<br>\nand<br>\n<a href=\"http://golang.org/ref/spec#Variable_declarations\" rel=\"noreferrer\">Short_variable_declarations</a> (in the format of <code>count := 0</code>)</p>\n\n<p>I found it's very confusing to decide which one to use.</p>\n\n<p>The differences I know (till now) are that:</p>\n\n<ul>\n<li>I can only using a <code>count := 0</code> format when in the scope of a function.</li>\n<li><code>count := 0</code> can be <em>redeclared</em>  in a <em>multi-variable short declaration</em>.</li>\n</ul>\n\n<p>But they do behave the same <em>as far as I know</em>. And in the reference it also <a href=\"http://golang.org/ref/spec#Variable_declarations\" rel=\"noreferrer\">says</a>:</p>\n\n<blockquote>\n  <p>It (the <code>count:=0</code>way) is <strong>shorthand</strong> for a regular variable declaration with initializer expressions but no types</p>\n</blockquote>\n\n<p>My confusions are:</p>\n\n<ul>\n<li>If one is just the shorthand way of the other, why do they behave differently? </li>\n<li>In what concern does the author of Go make two ways of declaring a variable (why are they not merged into one way)? Just to confuse us?</li>\n<li>Is there any other aspect that I should keep my eyes open on when using them, in case I fall into a pit?</li>\n</ul>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "edited": false, "score": 0, "creation_date": 1421193485, "post_id": 27918263, "comment_id": 44265038, "body": "just use viper: github.com/spf13/viper"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "edited": false, "score": 1, "creation_date": 1429031995, "post_id": 27918263, "comment_id": 47409516, "body": "@fabrizioM that&#39;s <i>massive</i> overkill for a simple/trivial call to <code>os.Open</code>/<code>os.Create</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2211, "user_id": 3243814, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/538d7f03357c8012445b79c7ee129aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Etienne Bruines", "link": "https://stackoverflow.com/users/3243814/etienne-bruines"}, "is_accepted": false, "score": 0, "last_activity_date": 1421139921, "creation_date": 1421139921, "answer_id": 27918353, "question_id": 27918263, "link": "https://stackoverflow.com/questions/27918263/golang-how-can-filename-arguments-be-parsed/27918353#27918353", "title": "Golang: how can filename arguments be parsed?", "body": "<p>Taking aside that you don't want to see <code>.</code> as a file, there's not that much to worry about. </p>\n\n<p>In a trusted environment*, where the user can indeed point to <i>any</i> file, the <code>os</code> package will take care of it. No need to <code>filepath.Join</code> anything. </p>\n\n<ul>\n<li>If an absolute path is given, it will open it. (i.e.: starting with <code>/</code>)</li>\n<li>If not, then it will see it relative to the current working directory. (including <code>.</code> and <code>./</code>)</li>\n</ul>\n\n<hr>\n\n<p>(*) In a non-trusted environment (a web server for example), you will want to validate the path given for authorization. </p>\n"}, {"tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": false, "score": 1, "last_activity_date": 1421147256, "creation_date": 1421147256, "answer_id": 27920701, "question_id": 27918263, "link": "https://stackoverflow.com/questions/27918263/golang-how-can-filename-arguments-be-parsed/27920701#27920701", "title": "Golang: how can filename arguments be parsed?", "body": "<p>The operating system interprets paths for you. You don't need to do anything with path names. You can simply do something like this:</p>\n\n<pre><code>os.Open(\"./path/to/file\")\nos.Open(\"another/file\")\nos.Open(\"../some_file\")\n</code></pre>\n\n<p>et cetera</p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1421153294, "creation_date": 1421153294, "answer_id": 27922582, "question_id": 27918263, "link": "https://stackoverflow.com/questions/27918263/golang-how-can-filename-arguments-be-parsed/27922582#27922582", "title": "Golang: how can filename arguments be parsed?", "body": "<p>OS does hard work for you. However passed argument possible can correspond a directory. You should either check <code>os.FileInfo.IsDir</code>, or implement <code>path.filepath.WalkFunc()</code> taken by <code>path.filepath.Walk()</code> for batch operations. Latter is quite a common approach.</p>\n"}], "owner": {"reputation": 4811, "user_id": 2874789, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/VKbXD.jpg?s=128&g=1", "display_name": "Christopher Shroba", "link": "https://stackoverflow.com/users/2874789/christopher-shroba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 812, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1421153294, "creation_date": 1421139609, "question_id": 27918263, "link": "https://stackoverflow.com/questions/27918263/golang-how-can-filename-arguments-be-parsed", "title": "Golang: how can filename arguments be parsed?", "body": "<p>I am writing a command line utility in golang, which takes a file as an argument.  How can I accurately turn this argument into a useable file?  It seems there are many cases to handle:</p>\n\n<ul>\n<li>An absolute path has been given, and I should use it as is</li>\n<li>A relative path has been given, and I should path.Join() it with the current working directory</li>\n<li>\".\"'s and \"../\"'s are used in the path, and I believe I should still use path.Join() and Go will simplify the path?</li>\n</ul>\n\n<p>Does Go provide anything to handle this?  Should I just branch based on whether the first character is '/'?  That seems like a hacky solution, but perhaps it always works and so should be done?</p>\n"}, {"tags": ["go", "structure"], "answers": [{"comments": [{"owner": {"reputation": 3857, "user_id": 698329, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/u4NRK.jpg?s=128&g=1", "display_name": "eouti", "link": "https://stackoverflow.com/users/698329/eouti"}, "edited": false, "score": 0, "creation_date": 1421145744, "post_id": 27918316, "comment_id": 44237855, "body": "Ok thx for the idea. Nevertheless, syntax error i guess, it doesnt work. <code>cannot use house.hood (type *Hood) as type Hood in return argument</code>"}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "reply_to_user": {"reputation": 3857, "user_id": 698329, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/u4NRK.jpg?s=128&g=1", "display_name": "eouti", "link": "https://stackoverflow.com/users/698329/eouti"}, "edited": false, "score": 0, "creation_date": 1421147837, "post_id": 27918316, "comment_id": 44238955, "body": "@eouti Yes, it should be <code>return *house.hood</code>. See <a href=\"http://play.golang.org/p/bJO-VPweHf\" rel=\"nofollow noreferrer\">play.golang.org/p/bJO-VPweHf</a>"}, {"owner": {"reputation": 1180, "user_id": 2857193, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1PnWH.jpg?s=128&g=1", "display_name": "James Tan", "link": "https://stackoverflow.com/users/2857193/james-tan"}, "edited": false, "score": 0, "creation_date": 1488964035, "post_id": 27918316, "comment_id": 72459035, "body": "i found another way is to declare the variable within the sub folder, and pass in the parent object to the sub directory function that set the variable. example: <code>var app *buffalo.App func SetApp(t_app *buffalo.App) { \tapp = t_app } </code>"}], "tags": [], "owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "is_accepted": true, "score": 10, "last_activity_date": 1421149579, "last_edit_date": 1421149579, "creation_date": 1421139777, "answer_id": 27918316, "question_id": 27918208, "link": "https://stackoverflow.com/questions/27918208/go-get-parent-struct/27918316#27918316", "title": "Go - get parent struct", "body": "<p>You should retain a pointer to the hood.</p>\n\n<pre><code>type House struct {\n    hood   *Hood\n    name   string\n    people int16\n}\n</code></pre>\n\n<p>and when you append the house</p>\n\n<pre><code>func (h *Hood) addHouse(house House) []House {\n    house.hood = h\n    h.houses = append(h.houses, house)\n    return h.houses\n}\n</code></pre>\n\n<p>then you can easily change the <code>GetHood</code>, although a getter may not be required at that point.</p>\n\n<pre><code>func (house *House) GetHood() Hood {\n    return *house.hood\n}\n</code></pre>\n"}], "owner": {"reputation": 3857, "user_id": 698329, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/u4NRK.jpg?s=128&g=1", "display_name": "eouti", "link": "https://stackoverflow.com/users/698329/eouti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4353, "favorite_count": 0, "accepted_answer_id": 27918316, "answer_count": 1, "score": 3, "last_activity_date": 1421149579, "creation_date": 1421139455, "question_id": 27918208, "link": "https://stackoverflow.com/questions/27918208/go-get-parent-struct", "title": "Go - get parent struct", "body": "<p>I'd like to know how to retrieve the parent struct of an instance.<br>\nI have no idea how to implement this.    </p>\n\n<p>For instance:</p>\n\n<pre><code>type Hood struct {\n    name string\n    houses  []House\n}\n\ntype House struct {\n    name   string\n    people int16\n}\n\nfunc (h *Hood) addHouse(house House) []House {\n    h.houses = append(h.houses, house)\n    return h.houses\n}\n\nfunc (house *House) GetHood() Hood {\n    //Get hood where the house is situated\n    return ...?\n}\n</code></pre>\n\n<p>Cheers</p>\n"}, {"tags": ["winapi", "windows-8", "go", "print-spooler-api"], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 4448472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aff8ab9dde753825fbb8546bb792b3e1?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/4448472/paul"}, "is_accepted": true, "score": 5, "last_activity_date": 1421139262, "creation_date": 1421139262, "answer_id": 27918154, "question_id": 27917857, "link": "https://stackoverflow.com/questions/27917857/printing-via-winspool/27918154#27918154", "title": "Printing via Winspool", "body": "<p>You're using the datatype \"RAW\", it should be \"XPS_PASS\".</p>\n\n<p>Windows 8 (and Server 2012) uses XPS-based drivers so you can't use the RAW flag.</p>\n\n<p>Check out these articles:\n<a href=\"http://support.microsoft.com/kb/2779300\" rel=\"noreferrer\">http://support.microsoft.com/kb/2779300</a>\n<a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/ff686812%28v=vs.85%29.aspx\" rel=\"noreferrer\">http://msdn.microsoft.com/en-us/library/windows/desktop/ff686812%28v=vs.85%29.aspx</a></p>\n"}], "owner": {"reputation": 769, "user_id": 294916, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1a9637acaccba514bf6c2cecf80c3f16?s=128&d=identicon&r=PG", "display_name": "Leon", "link": "https://stackoverflow.com/users/294916/leon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 882, "favorite_count": 0, "accepted_answer_id": 27918154, "answer_count": 1, "score": 1, "last_activity_date": 1563016071, "creation_date": 1421138161, "last_edit_date": 1563016071, "question_id": 27917857, "link": "https://stackoverflow.com/questions/27917857/printing-via-winspool", "title": "Printing via Winspool", "body": "<p>I'm trying to set up a kind of print service for a website to communicate with and send printable documents to (pdf, html, excel). I decided on Go.</p>\n\n<p>I created the simple program below. On some PCs it works (Windows 7) on other ones (Windows 8) it doesn't work (right). When it doesn't work the job is visible in the print queue for less then a second and then disappears. The code doesn't output any errors. I can't find anything in the Windows event log.</p>\n\n<p>I also tried a RawPrinter example in c++ I could find online but that shows the same behavior.</p>\n\n<p>Does anyone know what I'm doing wrong? :(</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"code.google.com/p/brainman/printer\"\n)\n\n\nfunc main() {\n    defaultPrinterName, _ := printer.Default()\n    fmt.Println(defaultPrinterName)\n    p, err := printer.Open(defaultPrinterName)\n\n    if err != nil {\n        fmt.Println(\"Open failed: %v\", err)\n    }\n\n    defer p.Close()\n\n    err = p.StartDocument(\"my document\", \"RAW\")\n\n    if err != nil {\n        fmt.Println(\"StartDocument failed: %v\", err)\n    }\n\n    defer p.EndDocument()\n\n    err = p.StartPage()\n\n    if err != nil {\n        fmt.Println(\"StartPage failed: %v\", err)\n    }\n\n    str := \"testing 123\"\n    mySlice := []byte(str)\n\n    _, err = p.Write(mySlice)\n\n    if err != nil {\n        fmt.Println(\"Write failed: %v\", err)\n    }\n\n    err = p.EndPage()\n\n    if err != nil {\n        fmt.Println(\"EndPage failed: %v\", err)\n    }\n}\n</code></pre>\n"}, {"tags": ["http", "go", "synchronization"], "answers": [{"comments": [{"owner": {"reputation": 6945, "user_id": 2288944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/7qryD.jpg?s=128&g=1", "display_name": "armnotstrong", "link": "https://stackoverflow.com/users/2288944/armnotstrong"}, "edited": false, "score": 0, "creation_date": 1421138017, "post_id": 27917774, "comment_id": 44233732, "body": "Thank you, It works! but what is the difference between variable that is <i>declared</i> with <code>var</code> and the *instance*(would you agree me to call it that way?) made by <code>:=</code>? I found them very confusing with each other. when should I use which?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 6945, "user_id": 2288944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/7qryD.jpg?s=128&g=1", "display_name": "armnotstrong", "link": "https://stackoverflow.com/users/2288944/armnotstrong"}, "edited": false, "score": 0, "creation_date": 1421138163, "post_id": 27917774, "comment_id": 44233795, "body": "@armnotstrong The short variable declaration may appear only inside functions. I edit my answer to add links to the relevant sections of the Language specification which I recommend you to read."}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 0, "creation_date": 1421148734, "post_id": 27917774, "comment_id": 44239416, "body": "I think having a global variable, not protected by a mutex, that may be accessible by multiple goroutines may be a race condition. @secmask&#39;s suggestion of using <code>expvar.NewInt</code> gets around this. From <a href=\"http://golang.org/pkg/expvar/\" rel=\"nofollow noreferrer\">golang.org/pkg/expvar</a> : &quot;Operations to set or modify these public variables are atomic&quot;."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 1, "creation_date": 1421148923, "post_id": 27917774, "comment_id": 44239536, "body": "@Intermernet Yes, access to the <code>count</code> variable has to be synchronized. The questioner knows about this and it is mentioned in the question. His primary concern at this time was to get a valid program that compiles."}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 0, "creation_date": 1421149262, "post_id": 27917774, "comment_id": 44239732, "body": "True, I think that between both answers the OP will gain more knowledge than if just directed to use &quot;expvar&quot;. Having said this, the next problem the OP will come across is one of concurrency, and I think @secmask&#39;s answer addresses this. I&#39;ve upvoted both answers, and I think it&#39;s important for the OP to realize that both answers contain very useful info, and they&#39;re both technically correct. Race conditions are annoying and confusing, but Go provides many tools to avoid them."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1429593976, "last_edit_date": 1429593976, "creation_date": 1421137750, "answer_id": 27917774, "question_id": 27917750, "link": "https://stackoverflow.com/questions/27917750/how-to-define-a-global-counter-in-golang-http-server/27917774#27917774", "title": "How to define a global counter in golang http server", "body": "<p>Outside of functions you cannot use the short variable declaration <code>:=</code>. Outside of a function to define a global variable you have to use a <a href=\"http://golang.org/ref/spec#Variable_declarations\" rel=\"nofollow\">variable declaration</a> (with the <code>var</code> keyword):</p>\n\n<pre><code>var count int\n</code></pre>\n\n<p>It will automatically be initialized to <code>int</code>'s zero value which is <code>0</code>.</p>\n\n<p><strong>Links:</strong></p>\n\n<p>Relevant sections of the <a href=\"http://golang.org/ref/spec\" rel=\"nofollow\">Go Language Specification</a> which I recommend you to read:</p>\n\n<p><a href=\"http://golang.org/ref/spec#Variable_declarations\" rel=\"nofollow\">Variable declarations</a></p>\n\n<p><a href=\"http://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow\">Short variable declarations</a></p>\n\n<p><strong>Note:</strong></p>\n\n<p>Since handling of each request runs in its own goroutine, you need explicit synchronization to access the shared counter, or you have to use other synchronized means to do a proper counting.</p>\n"}, {"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1429032916, "post_id": 27917834, "comment_id": 47410029, "body": "Note, unless you need/want the extra features <code>expvar</code> gives you, this is a lot more heavy weight than something simple like using <a href=\"https://golang.org/pkg/sync/atomic/#AddInt64\" rel=\"nofollow noreferrer\"><code>atomic.AddInt64(&amp;cnt, 1)</code></a> (and of course <a href=\"https://golang.org/pkg/sync/atomic/#LoadInt64\" rel=\"nofollow noreferrer\"><code>atomic.LoadInt64(&amp;cnt)</code></a> to read it later)."}], "tags": [], "owner": {"reputation": 6339, "user_id": 304778, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/CD3Vg.jpg?s=128&g=1", "display_name": "secmask", "link": "https://stackoverflow.com/users/304778/secmask"}, "is_accepted": false, "score": 3, "last_activity_date": 1421138051, "creation_date": 1421138051, "answer_id": 27917834, "question_id": 27917750, "link": "https://stackoverflow.com/questions/27917750/how-to-define-a-global-counter-in-golang-http-server/27917834#27917834", "title": "How to define a global counter in golang http server", "body": "<p>You may want to use standard way in golang that in <code>expvar</code> package\nfor an example <a href=\"http://go-wise.blogspot.com/2011/10/expvar.html\" rel=\"nofollow\">http://go-wise.blogspot.com/2011/10/expvar.html</a></p>\n\n<pre><code>package main\n\nimport (\n    \"expvar\"\n    \"fmt\"\n    \"http\"\n    \"io\"\n)\n\n// Two metrics, these are exposed by \"magic\" :)\n// Number of calls to our server.\nvar numCalls = expvar.NewInt(\"num_calls\")\n// Last user.\nvar lastUser = expvar.NewString(\"last_user\")\n\nfunc HelloServer(w http.ResponseWriter, req *http.Request) {\n    user := req.FormValue(\"user\")\n\n    // Update metrics\n    numCalls.Add(1)\n    lastUser.Set(user)\n\n    msg := fmt.Sprintf(\"G'day %s\\n\", user)\n    io.WriteString(w, msg)\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", HelloServer)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6945, "user_id": 2288944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/7qryD.jpg?s=128&g=1", "display_name": "armnotstrong", "link": "https://stackoverflow.com/users/2288944/armnotstrong"}, "edited": false, "score": 1, "creation_date": 1421138730, "post_id": 27917959, "comment_id": 44234086, "body": "Thank you for remind me that, I know this snippet will cause a concurrence problem, I just ignore it for convince. :-)"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 6945, "user_id": 2288944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/7qryD.jpg?s=128&g=1", "display_name": "armnotstrong", "link": "https://stackoverflow.com/users/2288944/armnotstrong"}, "edited": false, "score": 2, "creation_date": 1429032345, "post_id": 27917959, "comment_id": 47409713, "body": "@armnotstrong <b>Never</b> ignore data races for &quot;convenience&quot; or under the assumption that errors will be minor (like off-by-one). When a data race occurs <i>all bets are off</i>, <a href=\"https://software.intel.com/en-us/blogs/2013/01/06/benign-data-races-what-could-possibly-go-wrong\" rel=\"nofollow noreferrer\"><i>anything</i> can happen</a>. Just don&#39;t do it (especially since it&#39;s absolutely trivial to just use <a href=\"https://golang.org/pkg/sync/atomic/#AddInt64\" rel=\"nofollow noreferrer\"><code>atomic.AddInt64(&amp;cnt, 1)</code></a> for this."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1429033210, "post_id": 27917959, "comment_id": 47410191, "body": "E.g. replace &quot;will skip one&quot; with &quot;is <i>completely undefined</i> and can do <a href=\"https://software.intel.com/en-us/blogs/2013/01/06/benign-data-races-what-could-possibly-go-wrong\" rel=\"nofollow noreferrer\">anything at all</a>&quot; in this answer."}], "tags": [], "owner": {"reputation": 2211, "user_id": 3243814, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/538d7f03357c8012445b79c7ee129aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Etienne Bruines", "link": "https://stackoverflow.com/users/3243814/etienne-bruines"}, "is_accepted": false, "score": 0, "last_activity_date": 1421138595, "creation_date": 1421138595, "answer_id": 27917959, "question_id": 27917750, "link": "https://stackoverflow.com/questions/27917750/how-to-define-a-global-counter-in-golang-http-server/27917959#27917959", "title": "How to define a global counter in golang http server", "body": "<p>Beware that you might want to consider using the <code>sync</code> package, because <code>counter = counter + 1</code> will skip one if it's called simultaneously. </p>\n"}, {"tags": [], "owner": {"reputation": 14205, "user_id": 968244, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/I9DXX.jpg?s=128&g=1", "display_name": "isapir", "link": "https://stackoverflow.com/users/968244/isapir"}, "is_accepted": false, "score": 2, "last_activity_date": 1563812926, "last_edit_date": 1563812926, "creation_date": 1563748089, "answer_id": 57137432, "question_id": 27917750, "link": "https://stackoverflow.com/questions/27917750/how-to-define-a-global-counter-in-golang-http-server/57137432#57137432", "title": "How to define a global counter in golang http server", "body": "<p>The counter must be incremented atomically or else you will have race conditions and miss some counts.</p>\n\n<p>Declare a global <code>int64</code> variable and access it using the <code>sync.atomic</code> methods:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"sync/atomic\"\n)\n\nvar requests int64 = 0\n\n// increments the number of requests and returns the new value\nfunc incRequests() int64 {\n    return atomic.AddInt64(&amp;requests, 1)\n}\n\n// returns the current value\nfunc getRequests() int64 {\n    return atomic.LoadInt64(&amp;requests)\n}\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n\n    incRequests()\n\n    // handle the request here ...\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    log.Fatal(http.ListenAndServe(\":8080\", nil))\n}\n</code></pre>\n"}], "owner": {"reputation": 6945, "user_id": 2288944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/7qryD.jpg?s=128&g=1", "display_name": "armnotstrong", "link": "https://stackoverflow.com/users/2288944/armnotstrong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3762, "favorite_count": 0, "accepted_answer_id": 27917774, "answer_count": 4, "score": 1, "last_activity_date": 1563812926, "creation_date": 1421137623, "last_edit_date": 1563748177, "question_id": 27917750, "link": "https://stackoverflow.com/questions/27917750/how-to-define-a-global-counter-in-golang-http-server", "title": "How to define a global counter in golang http server", "body": "<p>I am newbie to GoLang and \n want to define a global counter in go-lang to record how many queries are made to the http server.</p>\n\n<p>I think the simplest way is to define a 'global' variable that stored the current count, and increase it in every query (let's put the concurrence problem aside for convenient).</p>\n\n<p>Any way, here is my code I planned to achieve this so far:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\ncount := 0 // *Error* non-declaration statement outside function body\nfunc increment() error{\n    count = count + 1\n    return nil\n}\n\nfunc mainHandler(w http.ResponseWriter, r *http.Request){\n    increment()\n    fmt.Fprint(w,count)\n}\n\nfunc main(){\n    http.HandleFunc(\"/\", mainHandler)\n    http.ListenAndServe(\":8085\",nil)\n}\n</code></pre>\n\n<p>As you can see, var <code>count</code> could not be defined there, It's vary from Java servlet which I formerly using.</p>\n\n<p>So how can I achieve this?</p>\n"}, {"tags": ["list", "pointers", "go"], "answers": [{"comments": [{"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "edited": false, "score": 0, "creation_date": 1421134848, "post_id": 27916826, "comment_id": 44232453, "body": "I see the error. Thanks for notifying this. But my original problem is how to access the next pointer from Element structure. As you said next is not exported. But this variable is available in Element struct. <a href=\"http://golang.org/src/container/list/list.go?s=406:874#L5\" rel=\"nofollow noreferrer\">golang.org/src/container/list/list.go?s=406:874#L5</a> So is it not possible to access the pointer?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "edited": false, "score": 0, "creation_date": 1421134927, "post_id": 27916826, "comment_id": 44232489, "body": "@DineshAppavoo Yes, the <code>next</code> field is part of the <code>Element</code> struct but it is not exported which means it can only be accessed from the package it was defined in. You could go around this restriction with package <code>unsafe</code>, but that is not the proper way, fields that are not exported may change in future releases."}, {"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "edited": false, "score": 0, "creation_date": 1421135049, "post_id": 27916826, "comment_id": 44232547, "body": "I got it. Is it possible to delete the node in the list by giving access to only the node"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "edited": false, "score": 0, "creation_date": 1421135479, "post_id": 27916826, "comment_id": 44232713, "body": "@DineshAppavoo Unfortunately no. <code>Element</code> only provides access to previous and next elements and its value. You would need access to the <code>List</code> to call its <code>Remove()</code> method, and even that takes a value to be removed, not an <code>Element</code>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1421134650, "last_edit_date": 1421134650, "creation_date": 1421133707, "answer_id": 27916826, "question_id": 27916682, "link": "https://stackoverflow.com/questions/27916682/how-to-update-the-next-pointer-in-place-in-go-list/27916826#27916826", "title": "How to update the next pointer in place in go list?", "body": "<p>The (first) error you get is:</p>\n\n<pre><code>no new variables on left side of :=\n</code></pre>\n\n<p>Because <code>nextNode</code> already exists. The problem is with these 2 lines:</p>\n\n<pre><code>var nextNode *list.Element \nnextNode := node.next.(*list.Element)\n</code></pre>\n\n<p>In the first line you create the variable <code>nextNode</code>. In the second line you use the short assignment <code>:=</code> which creates a new variable (specified by the left side) and assigns to it the value on the right side. Just leave out the first line, you only need one of those:</p>\n\n<pre><code>nextNode := node.Next()\n</code></pre>\n\n<p>Moreover you cannot read or change the <code>next</code> pointer of a node because the <code>next</code> pointer is not exported in the <code>Element</code> struct (it starts with lowercased letter). So what you try to achieve cannot be done. But you have a function defined for this: <a href=\"http://golang.org/pkg/container/list/#List.Remove\" rel=\"nofollow\"><code>Remove(e *Element) interface{}</code></a></p>\n"}], "owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 27916826, "answer_count": 1, "score": 0, "last_activity_date": 1421134650, "creation_date": 1421133113, "question_id": 27916682, "link": "https://stackoverflow.com/questions/27916682/how-to-update-the-next-pointer-in-place-in-go-list", "title": "How to update the next pointer in place in go list?", "body": "<p>I have a node pointer from the list. I want update the value and next pointer with the next node in the list. This is nothing but deletion in place given access to only that pointer.</p>\n\n<p>For example 3 -> 5 -> 8 -> 9\nNode to be deleted : 5 (given access to only 5. Assuming previous node is not known)</p>\n\n<p>In this case the value and next pointer of node[8] can be copied to node[5]. I have the following code. It is not removing the element. If I try to access the next pointer using 'next' keyword it is throwing error.</p>\n\n<pre><code>package main\nimport (\n    \"container/list\"\n    \"fmt\"\n)\n\nfunc main() {\n\n    l := list.New()\n    l.PushFront(4)\n    l.PushFront(5)\n    e4 := l.PushFront(7)\n    l.PushFront(6)\n    l.PushBack(9)\n    res := deleteNode(e4)\n    fmt.Println(res)\n\n    for e:=l.Front(); e!=nil;e=e.Next() {\n        fmt.Println(e.Value)\n    }\n\n}\n//ERROR\nfunc deleteNode(node *list.Element) bool {\n\n    if node == nil || node.Next() == nil {\n        return false\n    }\n    var nextNode *list.Element \n    nextNode := node.next.(*list.Element)\n    node.Value = node.Next().Value.(int)\n    nextNode = nextNode.next.(*Element)\n    return true\n}\n</code></pre>\n\n<p>Could anyone help me with this?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4811, "user_id": 2874789, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/VKbXD.jpg?s=128&g=1", "display_name": "Christopher Shroba", "link": "https://stackoverflow.com/users/2874789/christopher-shroba"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1421137982, "post_id": 27916268, "comment_id": 44233722, "body": "Ah you&#39;re right, thanks!! Should I edit it, or would that be considered bad form since it would make your comment and the top answer appear wrong?"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1421139125, "last_edit_date": 1421139125, "creation_date": 1421132901, "answer_id": 27916626, "question_id": 27916268, "link": "https://stackoverflow.com/questions/27916268/golang-derefencing-function-return-value/27916626#27916626", "title": "Golang derefencing function return value", "body": "<p>The reason for this is because when you call <code>flag.Bool()</code>, it does not yet parse the command line arguments, it just defines a named flag and initializes it with the default value (which is <code>false</code> as you specified it).</p>\n\n<p>Command line arguments are only parsed when you call <code>flag.Parse()</code>. If you use <code>recursive bool</code>, in the <code>init()</code> function the default <code>false</code> will be assigned to it. The <code>flag</code> package does not know about your <code>recursive</code> variable, so later when you call <code>flag.Parse()</code>, its value will not/ cannot be changed.</p>\n\n<p><code>flag.Bool()</code> returns a pointer to a <code>bool</code> variable which the <code>flag</code> package knows about, and later when you call <code>flag.Parse()</code> the pointed <code>bool</code> variable will be properly updated, so when you print the pointed valued after <code>flag.Bool()</code>, it will be the updated value which will be set based on your command line arguments.</p>\n\n<h2>Alternative: Register your variable</h2>\n\n<p>So you <strong>must</strong> store and use the pointer returned by <code>flag.Bool()</code> else you will only see the default value. <strong>Or</strong> you can let the <code>flag</code> package know about your <code>recursive</code> variable: you can tell the <code>flag</code> package that you what it to store the result into <em>your</em> <code>recursive</code> variable by telling this with the <code>flag.BoolVar()</code> function:</p>\n\n<pre><code>flag.BoolVar(&amp;recursive, \"r\", false, \"Search recursively\")\n</code></pre>\n\n<p>Note that in this case there is no return value, becase you explicitly provided a pointer to a <code>bool</code> which you want the <code>flag</code> package to store the result to.</p>\n"}], "owner": {"reputation": 4811, "user_id": 2874789, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/VKbXD.jpg?s=128&g=1", "display_name": "Christopher Shroba", "link": "https://stackoverflow.com/users/2874789/christopher-shroba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 823, "favorite_count": 0, "accepted_answer_id": 27916626, "answer_count": 1, "score": 1, "last_activity_date": 1421139125, "creation_date": 1421131250, "last_edit_date": 1421139038, "question_id": 27916268, "link": "https://stackoverflow.com/questions/27916268/golang-derefencing-function-return-value", "title": "Golang derefencing function return value", "body": "<p>I'm messing with the flag library, and found that this code does not work:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"flag\"\n)\n\nvar recursive bool\n\nfunc init() {\n    recursive = *flag.Bool(\"r\", false, \"Search recursively\")\n}\nfunc main() {\n    flag.Parse()\n\n    fmt.Printf(\"Recursive: %t \\n\\n\", recursive)\n\n    flag.PrintDefaults()\n\n}\n</code></pre>\n\n<p>But this does (I commented the three lines I changed):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"flag\"\n)\n\nvar recursive *bool   //Changed to pointer type\n\nfunc init() {\n    recursive = flag.Bool(\"r\", false, \"Search recursively\") //Changed to not dereference function\n}\nfunc main() {\n    flag.Parse()\n\n    fmt.Printf(\"Recursive: %t \\n\\n\", *recursive)  //Changed to dereference variable\n\n    flag.PrintDefaults()\n\n}\n</code></pre>\n\n<p>Why does this behave like this?  Are functions not allowed to be dereferenced in Golang, or am I doing something else wrong?</p>\n"}, {"tags": ["opengl", "go", "sdl-2", "opengl-3", "glew"], "comments": [{"owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "edited": false, "score": 1, "creation_date": 1421114152, "post_id": 27913078, "comment_id": 44226896, "body": "I&#39;m not 100%, but I think this might be rendering it with you inside the cube, so you&#39;re not seeing the faces because the winding is wrong from that perspective."}, {"owner": {"reputation": 876, "user_id": 2305723, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/23e6e73c52938ec01c706097cf4e8943?s=128&d=identicon&r=PG", "display_name": "efel", "link": "https://stackoverflow.com/users/2305723/efel"}, "reply_to_user": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "edited": false, "score": 0, "creation_date": 1421122018, "post_id": 27913078, "comment_id": 44228579, "body": "I&#39;m not sure I understand. I&#39;m using pretty small values (1.0, 0 , etc).  The sdl2 link example cube seems to work fine, i&#39;m able to see everything in that example. The only change I made was to the shaders with much simpler shaders from the tutorial2 link"}, {"owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "edited": false, "score": 1, "creation_date": 1421124518, "post_id": 27913078, "comment_id": 44229136, "body": "Note that the shaders in the second tutorial you linked move the cube. You&#39;re rendering so the vertex elements are at 1.0 or -1.0, but you&#39;re at (0,0,0) -- you&#39;re inside the cube. In OpenGL faces are oriented based on clockwise-ness. Presumably, your vertices are oriented clockwise with respect to the OUTSIDE of the cube, so you don&#39;t see them because you&#39;re viewing the triangles from the &quot;back&quot;, where they&#39;re invisible."}, {"owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "edited": false, "score": 1, "creation_date": 1421124687, "post_id": 27913078, "comment_id": 44229168, "body": "Note that this example is basically mathgl tutorial 4 (these are mine, though they&#39;re adapted from a C tutorial), but with SDL instead of glfw."}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 1, "creation_date": 1421139949, "post_id": 27913078, "comment_id": 44234683, "body": "just a silly suggestion but what is the log output from shader compilation? are you sure your source text is including the enter codes when defined as you have now? if not then your <code>&#47;&#47;</code> rems are till end of source code ..."}, {"owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "edited": false, "score": 0, "creation_date": 1421145941, "post_id": 27913078, "comment_id": 44237989, "body": "Non-compiling shaders generally act as passthrough shaders with no vertex transformations and Gl-default-gray vertex coloring, so if that was the only problem he&#39;d likely see the cube, except gray instead of red."}, {"owner": {"reputation": 876, "user_id": 2305723, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/23e6e73c52938ec01c706097cf4e8943?s=128&d=identicon&r=PG", "display_name": "efel", "link": "https://stackoverflow.com/users/2305723/efel"}, "reply_to_user": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "edited": false, "score": 0, "creation_date": 1421151550, "post_id": 27913078, "comment_id": 44241002, "body": "Yea the shaders compile and link ok without error. I think @Jsor is correct about MVP - i&#39;m stuck &quot;inside&quot; the cube. I&#39;m going to update this post once I get this thing to compile again"}, {"owner": {"reputation": 876, "user_id": 2305723, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/23e6e73c52938ec01c706097cf4e8943?s=128&d=identicon&r=PG", "display_name": "efel", "link": "https://stackoverflow.com/users/2305723/efel"}, "edited": false, "score": 0, "creation_date": 1421290410, "post_id": 27913078, "comment_id": 44306901, "body": "So I still wasn&#39;t able to get things working I changed bunch of things for testing but no luck.  Posted new code above.  Can anyone provide some comments?"}], "answers": [{"tags": [], "owner": {"reputation": 876, "user_id": 2305723, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/23e6e73c52938ec01c706097cf4e8943?s=128&d=identicon&r=PG", "display_name": "efel", "link": "https://stackoverflow.com/users/2305723/efel"}, "is_accepted": true, "score": 1, "last_activity_date": 1422247910, "creation_date": 1422247910, "answer_id": 28144966, "question_id": 27913078, "link": "https://stackoverflow.com/questions/27913078/go-lang-opengl-simple-shape-blank-screen/28144966#28144966", "title": "Go Lang OpenGL simple shape - blank screen", "body": "<p>I finally figured out what my problem was in this code.</p>\n\n<p>The first thing I had to do was </p>\n\n<pre><code>positionAttrib := program.GetAttribLocation(\"vertexPosition_modelspace\")\n</code></pre>\n\n<p>for all the input variables going into the vertex shader. This was done after binding the VBO for each array.</p>\n\n<p>Next,</p>\n\n<p>If you notice my code above:</p>\n\n<pre><code>gl.BufferData(gl.ARRAY_BUFFER, len(triangle_vertices)*4, &amp;triangle_vertices, gl.STATIC_DRAW)\n</code></pre>\n\n<p>I simply replaced it with triangle_vertices array, and not the address:</p>\n\n<pre><code>gl.BufferData(gl.ARRAY_BUFFER, len(triangle_vertices)*4, triangle_vertices, gl.STATIC_DRAW)\n</code></pre>\n\n<p>Doing this seemed to fix it.</p>\n"}, {"tags": [], "owner": {"reputation": 751, "user_id": 3926156, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5lMum.png?s=128&g=1", "display_name": "alecdwm", "link": "https://stackoverflow.com/users/3926156/alecdwm"}, "is_accepted": false, "score": 0, "last_activity_date": 1446104677, "last_edit_date": 1495535298, "creation_date": 1446104677, "answer_id": 33408494, "question_id": 27913078, "link": "https://stackoverflow.com/questions/27913078/go-lang-opengl-simple-shape-blank-screen/33408494#33408494", "title": "Go Lang OpenGL simple shape - blank screen", "body": "<p>I would post this as a comment, but I do not yet have enough reputation.</p>\n\n<p>The solution already provided <em>nearly</em> solved my similar issue, however not quite.</p>\n\n<p>Where the provided solution was</p>\n\n<pre><code>gl.BufferData(gl.ARRAY_BUFFER, len(triangle_vertices)*4, triangle_vertices, gl.STATIC_DRAW)\n</code></pre>\n\n<p>The actual code which solved my issue is</p>\n\n<pre><code>gl.BufferData(gl.ARRAY_BUFFER, len(triangle_vertices)*4, gl.Ptr(triangle_vertices), gl.STATIC_DRAW)\n</code></pre>\n\n<p>I have also answered a similar question with this, but in more detail, which can be found here:\n<a href=\"https://stackoverflow.com/questions/11284055/opengl-vertex-buffer-doesnt-draw-anything-in-golang/33408359#33408359\">OpenGL Vertex Buffer doesn&#39;t draw anything in golang</a></p>\n"}], "owner": {"reputation": 876, "user_id": 2305723, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/23e6e73c52938ec01c706097cf4e8943?s=128&d=identicon&r=PG", "display_name": "efel", "link": "https://stackoverflow.com/users/2305723/efel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4495, "favorite_count": 1, "accepted_answer_id": 28144966, "answer_count": 2, "score": 2, "last_activity_date": 1446104677, "creation_date": 1421108558, "last_edit_date": 1421552217, "question_id": 27913078, "link": "https://stackoverflow.com/questions/27913078/go-lang-opengl-simple-shape-blank-screen", "title": "Go Lang OpenGL simple shape - blank screen", "body": "<p>I need some assistance into why this piece of code produces a blank green window.  I made this by combining examples from <a href=\"https://github.com/Jragonmiris/mathgl/blob/master/examples/opengl-tutorial/tutorial02/main.go\" rel=\"nofollow\">https://github.com/Jragonmiris/mathgl/blob/master/examples/opengl-tutorial/tutorial02/main.go</a> and <a href=\"https://github.com/veandco/go-sdl2/blob/master/examples/opengl3.go\" rel=\"nofollow\">https://github.com/veandco/go-sdl2/blob/master/examples/opengl3.go</a>.  I guess i'm not sure if this is a bug with the GoLang sdl/gl framework or an issue with my OpenGL understanding.  All this should draw is a cube.</p>\n\n<p>My code is:</p>\n\n<p>package main</p>\n\n<pre><code>import (\n    \"fmt\"\n    // gl \"github.com/chsc/gogl/gl33\"\n    \"github.com/veandco/go-sdl2/sdl\"\n    // \"math\"\n    \"github.com/Jragonmiris/mathgl\"\n    \"github.com/go-gl/gl\"\n    \"runtime\"\n    \"time\"\n)\n\n// var program gl.Program = 0\n// var buffer gl.Buffer = 0\n\nfunc MakeProgram(vert, frag string) gl.Program {\n\n    vertShader, fragShader := gl.CreateShader(gl.VERTEX_SHADER), gl.CreateShader(gl.FRAGMENT_SHADER)\n    vertShader.Source(vert)\n    fragShader.Source(frag)\n\n    vertShader.Compile()\n    fragShader.Compile()\n\n    prog := gl.CreateProgram()\n\n    prog.AttachShader(vertShader)\n    prog.AttachShader(fragShader)\n    prog.Link()\n    prog.Validate()\n    fmt.Println(prog.GetInfoLog())\n\n    return prog\n}\n\nfunc main() {\n    var window *sdl.Window\n    var context sdl.GLContext\n    var event sdl.Event\n    var running bool\n    var err error\n\n    runtime.LockOSThread()\n\n    if 0 != sdl.Init(sdl.INIT_EVERYTHING) {\n        panic(sdl.GetError())\n    }\n    window, err = sdl.CreateWindow(winTitle, sdl.WINDOWPOS_UNDEFINED,\n        sdl.WINDOWPOS_UNDEFINED,\n        winWidth, winHeight, sdl.WINDOW_OPENGL)\n    if err != nil {\n        panic(err)\n    }\n    if window == nil {\n        panic(sdl.GetError())\n    }\n    context = sdl.GL_CreateContext(window)\n    if context == nil {\n        panic(sdl.GetError())\n    }\n\n    if gl.Init() != 0 {\n        panic(\"gl error\")\n    }\n\n    gl.ClearColor(1.0, 1.0, 1.0, .5)\n    gl.Viewport(0, 0, winWidth, winHeight)\n\n    program := MakeProgram(vertexShaderSource, fragmentShaderSource)\n    defer program.Delete()\n\n    matrixID := program.GetUniformLocation(\"MVP\")\n    Projection := mathgl.Perspective(45.0, 4.0/3.0, 0.1, 100.0)\n    View := mathgl.LookAt(4.0, 3.0, 3.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0)\n    Model := mathgl.Ident4f()\n    MVP := Projection.Mul4(View).Mul4(Model) \n\n    gl.Enable(gl.DEPTH_TEST)\n    gl.DepthFunc(gl.LESS)\n    gl.Enable(gl.BLEND)\n    gl.BlendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA)\n\n    vertexArray := gl.GenVertexArray()\n    defer vertexArray.Delete()\n    vertexArray.Bind()\n\n    buffer := gl.GenBuffer()\n    defer buffer.Delete()\n    buffer.Bind(gl.ARRAY_BUFFER)\n    gl.BufferData(gl.ARRAY_BUFFER, len(triangle_vertices)*4, &amp;triangle_vertices, gl.STATIC_DRAW)\n\n    running = true\n    for running {\n        for event = sdl.PollEvent(); event != nil; event = sdl.PollEvent() {\n            switch t := event.(type) {\n            case *sdl.QuitEvent:\n                running = false\n            case *sdl.MouseMotionEvent:\n\n                fmt.Printf(string(t.Timestamp))\n            }\n        }\n\n        gl.Clear(gl.COLOR_BUFFER_BIT) // | gl.DEPTH_BUFFER_BIT)\n        program.Use()\n        matrixID.UniformMatrix4fv(false, MVP)\n        attribLoc := gl.AttribLocation(0)\n        attribLoc.EnableArray()\n        buffer.Bind(gl.ARRAY_BUFFER)\n        attribLoc.AttribPointer(3, gl.FLOAT, false, 0, nil)\n\n        gl.DrawArrays(gl.TRIANGLES, 0, 3)\n\n        attribLoc.DisableArray()\n\n        time.Sleep(50 * time.Millisecond)\n\n        sdl.GL_SwapWindow(window)\n    }\n\n    sdl.GL_DeleteContext(context)\n    window.Destroy()\n    sdl.Quit()\n}\n\n\n\nconst (\n    winTitle           = \"OpenGL Shader\"\n    winWidth           = 640\n    winHeight          = 480\n    vertexShaderSource = `\n#version 330 core\n\n// Input vertex data, different for all executions of this shader.\nlayout(location = 0) in vec3 vertexPosition_modelspace;\n// Values that stay constant for the whole mesh.\nuniform mat4 MVP;\nvoid main(){\n\n    gl_Position = MVP * vec4 (vertexPosition_modelspace,1.0);\n\n}\n`\n    fragmentShaderSource = `\n#version 330 core\n\n// Ouput data\nout vec3 color;\n\nvoid main()\n{\n\n    // Output color = red \n    color = vec3(1,0,0);\n\n}\n`\n)\n\nvar triangle_vertices = []float32{\n    -.5, -.5, -.5,\n    .5, -.5, -.5,\n    0.0, 0.5, -.5,\n}\n</code></pre>\n\n<p>So I'm still having trouble drawing a simple shape on the screen. I made a few changes such as simplifying my shape (a triangle).  I created coordinates so they would be more towards the -z axis so I would be able to see them but that has not worked.  I then set the MVP matrix (moving the camera back some) just to make sure.  My shaders are simple as I am only passing in a vec3 vertex position and mat4 MVP matrix so believe shaders are working correctly? Sorry for all the confusion, i think i maybe missing something here.</p>\n\n<p>Update:\nI also ran the version commands for opengl:</p>\n\n<pre><code>fmt.Println(gl.GetString(gl.VERSION))\nfmt.Println(gl.GetString(gl.VENDOR))\nfmt.Println(gl.GetString(gl.RENDERER))\n</code></pre>\n\n<p>for which the output was:</p>\n\n<p>4.5.0 NVIDIA 347.09\nNVIDIA Corporation\nGeForce GTX 650 Ti/PCIe/SSE2</p>\n\n<p>Not sure if this has any impact?</p>\n\n<p>Update:\nI have looked at some more examples and decided to try and add some sdl attributes but still no luck:</p>\n\n<pre><code>sdl.GL_SetAttribute(sdl.GL_DOUBLEBUFFER, 1)\nsdl.GL_SetAttribute(sdl.GL_RED_SIZE, 8)\nsdl.GL_SetAttribute(sdl.GL_GREEN_SIZE, 8)\nsdl.GL_SetAttribute(sdl.GL_BLUE_SIZE, 8)\nsdl.GL_SetAttribute(sdl.GL_ALPHA_SIZE, 8)\n</code></pre>\n\n<p>Update:</p>\n\n<p>I modified this post to just include more recent code to not scare people away from TLDR.</p>\n"}, {"tags": ["http", "go", "http-status-code-404"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 6, "last_activity_date": 1421106310, "creation_date": 1421106310, "answer_id": 27912727, "question_id": 27912409, "link": "https://stackoverflow.com/questions/27912409/custom-404-error-message-with-go/27912727#27912727", "title": "Custom 404 error message with Go", "body": "<p>Add this line to main:</p>\n\n<pre><code>http.HandleFunc(\"/\", NotFoundHandler)\n</code></pre>\n\n<p>The handler for \"/\" is the catchall handler.</p>\n\n<p>Also, you should modify the handler to return a 404 status:</p>\n\n<pre><code>func NotFoundHandler(w http.ResponseWriter, r *http.Request) {\n   w.WriteHeader(http.StatusNotFound)\n   fmt.Fprint(w, \"custom 404\")\n}\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 136935, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7d9f3e54e4a94df9ac7668411ffb24b3?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/136935/tyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1456, "favorite_count": 0, "accepted_answer_id": 27912727, "answer_count": 1, "score": 1, "last_activity_date": 1421107305, "creation_date": 1421104547, "last_edit_date": 1421107305, "question_id": 27912409, "link": "https://stackoverflow.com/questions/27912409/custom-404-error-message-with-go", "title": "Custom 404 error message with Go", "body": "<p>I have this code that will give my custom 404 error message if I go to /time/ but if I go to /times/ or just / or /whatever then I will get the default 404 error message. I want to show my custom 404 for all cases other than /time/</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"time\"\n        \"flag\"\n        \"os\"\n        \"net/http\"\n        )\n\nconst AppVersion = \"timeserver version: 3.0\"\n\nfunc timeserver(w http.ResponseWriter, r *http.Request) {\n    if r.URL.Path != \"/time/\" {\n        NotFoundHandler(w, r)\n        return\n    }\n\n    const layout = \"3:04:05 PM\"\n    t := time.Now().Local()\n    fmt.Fprint(w, \"&lt;html&gt;\\n\")\n    fmt.Fprint(w, \"&lt;head&gt;\\n\")\n    fmt.Fprint(w, \"&lt;style&gt;\\n\")\n    fmt.Fprint(w, \"p {font-size: xx-large}\\n\")\n    fmt.Fprint(w, \"span.time {color: red}\\n\")\n    fmt.Fprint(w, \"&lt;/style&gt;\\n\")\n    fmt.Fprint(w, \"&lt;/head&gt;\\n\")\n    fmt.Fprint(w, \"&lt;body&gt;\\n\")\n    //fmt.Fprint(w, \"The time is now \" + t.Format(layout))\n    fmt.Fprint(w, \"&lt;p&gt;The time is now &lt;span class=\\\"time\\\"&gt;\" + t.Format(layout) + \"&lt;/span&gt;.&lt;/p&gt;\\n\")\n    fmt.Fprint(w, \"&lt;/body&gt;\\n\")\n    fmt.Fprint(w, \"&lt;/html&gt;\\n\")\n}\n\nfunc NotFoundHandler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprint(w, \"custom 404\")\n}\n\nfunc main() {\n    version := flag.Bool(\"V\", false, \"prints current version\")\n    port := flag.String(\"port\", \"8080\", \"sets service port number\")\n\n    flag.Parse()\n    if *version {\n      fmt.Println(AppVersion)\n      os.Exit(0)\n    }\n\n    http.HandleFunc(\"/time/\", timeserver)\n    http.ListenAndServe(\"localhost:\" + *port, nil)\n}\n</code></pre>\n"}, {"tags": ["go", "gob", "go-interface"], "comments": [{"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1421110233, "post_id": 27911870, "comment_id": 44225977, "body": "If possible, I would go the route of generating the function."}], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1429034101, "post_id": 27918249, "comment_id": 47410675, "body": "Or, instead of inventing a <code>nil</code> error return (<code>gob.Register</code> has no return value) so you can cause initialization via a global variable assignment, it would likely be cleaner/simpler to just use <a href=\"https://golang.org/ref/spec#Package_initialization\" rel=\"nofollow noreferrer\"><code>init</code> function(s)</a> in the package/file that defines the type."}], "tags": [], "owner": {"reputation": 2211, "user_id": 3243814, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/538d7f03357c8012445b79c7ee129aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Etienne Bruines", "link": "https://stackoverflow.com/users/3243814/etienne-bruines"}, "is_accepted": false, "score": 0, "last_activity_date": 1421139552, "creation_date": 1421139552, "answer_id": 27918249, "question_id": 27911870, "link": "https://stackoverflow.com/questions/27911870/en-decode-struct-containing-many-interfaces-with-different-implementations-each/27918249#27918249", "title": "En/Decode struct containing many interfaces with different implementations each with gob", "body": "<p>The <a href=\"http://golang.org/pkg/encoding/gob/\" rel=\"nofollow\">documentation</a> says:</p>\n\n<pre><code>We must register the concrete type for the encoder and decoder (which would\nnormally be on a separate machine from the encoder). On each end, this tells the\nengine which concrete type is being sent that implements the interface.\n</code></pre>\n\n<p>So, at some point, you're going to want to call <code>gob.Register</code>, but you do want your code to be maintainable. This leaves (broadly) two options:</p>\n\n<ul>\n<li>Creating a function like you're doing now, calling each struct after one another. \n<ul>\n<li>Advantage: all your <code>Register</code>-calls in a list, so you'll easily spot if you miss one, and you surely won't register one twice.</li>\n<li>Disadvantage: you'll have to update it when using another implementation. You'll also have to call this function some time before encoding/decoding. </li>\n</ul></li>\n<li><p>Creating something like this:</p>\n\n<pre><code>func Register(i interface{}) error {\n    gob.Register(i)\n    return nil\n}\n</code></pre>\n\n<p>And then when writing a new implementation in your (let's say) <code>dummy</code> package, you can put this line below / above the interface declaration. </p>\n\n<pre><code>var regResult = reg.Register(myNewInterface{})\n</code></pre></li>\n</ul>\n\n<p>This will be called on startup (because it's global). </p>\n\n<ul>\n<li>Advantage: not having to update the <code>registerImplementations</code> method. </li>\n<li>Disadvantage: you'll have your registers all across your code (which can consist of a lot of files) - so you might miss one. </li>\n</ul>\n\n<hr>\n\n<p>As to which is better: I'll leave that up to you. </p>\n"}], "owner": {"reputation": 3087, "user_id": 867505, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/66ba51197ba0b7c15dd60eee30c41532?s=128&d=identicon&r=PG", "display_name": "panmari", "link": "https://stackoverflow.com/users/867505/panmari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421139552, "creation_date": 1421101928, "question_id": 27911870, "link": "https://stackoverflow.com/questions/27911870/en-decode-struct-containing-many-interfaces-with-different-implementations-each", "title": "En/Decode struct containing many interfaces with different implementations each with gob", "body": "<p>I have a quite complex struct that contains many interfaces with each different implementations. For en/decoding that struct in gob I seem to have to register every implementation that could be possibly used for every interface. So I end up with a method along these lines:</p>\n\n<pre><code>func registerImplementations() {\n    gob.Register(&amp;Type1{})\n    gob.Register(&amp;Type2{})\n    gob.Register(&amp;Type3{})\n    gob.Register(&amp;Type4{})\n    ....\n\n}\n</code></pre>\n\n<p>which I need to call before en/decoding. Is there an easier way to do this? Or should I look into possibilities for generating this method, since it's quite tedious to keep track of all possible implementations?</p>\n"}, {"tags": ["error-handling", "go"], "comments": [{"owner": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "edited": false, "score": 1, "creation_date": 1421115142, "post_id": 27907558, "comment_id": 44227113, "body": "Coincidentally, there was a blog post today discussing this: <a href=\"https://blog.golang.org/errors-are-values\" rel=\"nofollow noreferrer\">blog.golang.org/errors-are-values</a>"}], "answers": [{"tags": [], "owner": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "is_accepted": false, "score": 2, "last_activity_date": 1421084917, "creation_date": 1421084917, "answer_id": 27907882, "question_id": 27907558, "link": "https://stackoverflow.com/questions/27907558/handle-repetitive-error-cases-in-one-place/27907882#27907882", "title": "Handle repetitive error cases in one place", "body": "<p>You could create a simple type that stores a bunch of writes and executes them all at once, bailing as soon as an error is encountered.</p>\n\n<pre><code>type MyWriter struct {\n    W     io.Writer\n    O     binary.ByteOrder\n    items []interface{}\n}\n\nfunc (w *MyWriter) AddWrite(value interface{}) {\n    w.items = append(w.items, value)\n}\n\n// PerformWrite executes all writes that have been added via AddWrite.\n// It aborts as soon as an error is encountered and returns the error.\nfunc (w *MyWriter) PerformWrites() error {\n    for _, item := range w.items {\n        if err := binary.Write(w.W, w.O, item); err != nil {\n            return err\n        }\n    }\n    return nil\n}\n</code></pre>\n\n<p>With this in place, your <code>writeFrame</code> function might look something like this:</p>\n\n<pre><code>func Write(conn net.Conn) error {\n    w := MyWriter{W: conn, O: binary.BigEndian}\n    // queue up your writes (frame.type, frame.id, ...)\n    w.AddWrite(int32(1))\n    w.AddWrite(int32(2))\n    w.AddWrite(int64(3))\n\n    if err := w.PerformWrites(); err != nil {\n        // there was an error\n        return err\n    }\n    return nil\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "is_accepted": true, "score": 2, "last_activity_date": 1421085827, "creation_date": 1421085827, "answer_id": 27908115, "question_id": 27907558, "link": "https://stackoverflow.com/questions/27907558/handle-repetitive-error-cases-in-one-place/27908115#27908115", "title": "Handle repetitive error cases in one place", "body": "<p>You can use a <a href=\"http://golang.org/pkg/bufio/#Writer\" rel=\"nofollow\" title=\"bufio.Writer\">bufio.Writer</a> for this. If any error occurs future Write's will simply return the same error and be ignored.</p>\n\n<pre><code>func writeFrame(frame *Frame, conn net.Conn) error {\n    bo := binary.BigEndian\n\n    w := bufio.NewWriter(conn)\n\n    binary.Write(w, bo, frame.ype)\n    binary.Write(w, bo, frame.id)\n    binary.Write(w, bo, frame.seq)\n\n    binary.Write(w, bo, uint32(len(frame.arg1)))\n    binary.Write(w, bo, uint32(len(frame.arg2)))\n    binary.Write(w, bo, uint32(len(frame.arg3)))\n\n    var csum uint32\n    binary.Write(w, bo, csum)\n\n    w.Write(frame.arg1)\n    w.Write(frame.arg2)\n    w.Write(frame.arg3)\n\n    // Write outstanding data to conn and return an error if any occured\n    return w.Flush()\n}\n</code></pre>\n"}], "owner": {"reputation": 6881, "user_id": 1052922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4bf2f8cc6f4dc4dac32fdd12702134e6?s=128&d=identicon&r=PG", "display_name": "woodings", "link": "https://stackoverflow.com/users/1052922/woodings"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 27908115, "answer_count": 2, "score": 3, "last_activity_date": 1421085827, "creation_date": 1421083709, "last_edit_date": 1421084613, "question_id": 27907558, "link": "https://stackoverflow.com/questions/27907558/handle-repetitive-error-cases-in-one-place", "title": "Handle repetitive error cases in one place", "body": "<p>I'm writing a function which writes a struct of multiple fields to a TCP connection. Is there a way to handle errors in one place like catching exception in Java?</p>\n\n<p>My implementation looks like,</p>\n\n<pre><code>func writeFrame(frame *Frame, conn net.Conn) error {\n    bo := binary.BigEndian\n    if err := binary.Write(conn, bo, frame.ype); err != nil {\n        return err\n    }\n    if err := binary.Write(conn, bo, frame.id); err != nil {\n        return err\n    }\n    if err := binary.Write(conn, bo, frame.seq); err != nil {\n        return err\n    }\n\n    if err := binary.Write(conn, bo, uint32(len(frame.arg1))); err != nil {\n        return err\n    }\n    if err := binary.Write(conn, bo, uint32(len(frame.arg2))); err != nil {\n        return err\n    }\n    if err := binary.Write(conn, bo, uint32(len(frame.arg3))); err != nil {\n        return err\n    }\n\n    var csum uint32\n    if err := binary.Write(conn, bo, csum); err != nil {\n        return err\n    }\n\n    if _, err := conn.Write(frame.arg1); err != nil {\n        return err\n    }\n    if _, err := conn.Write(frame.arg2); err != nil {\n        return err\n    }\n    if _, err := conn.Write(frame.arg3); err != nil {\n        return err\n    }\n    return nil\n}\n</code></pre>\n"}, {"tags": ["go", "go-templates"], "answers": [{"comments": [{"owner": {"reputation": 45581, "user_id": 129190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/utfel.jpg?s=128&g=1", "display_name": "digitaldreamer", "link": "https://stackoverflow.com/users/129190/digitaldreamer"}, "edited": false, "score": 0, "creation_date": 1492131739, "post_id": 27907002, "comment_id": 73868182, "body": "Thank you for showing us <code>template.CSS</code>. It&#39;s hard to get straightforward solutions for this."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1421088297, "last_edit_date": 1421088297, "creation_date": 1421081754, "answer_id": 27907002, "question_id": 27906812, "link": "https://stackoverflow.com/questions/27906812/unescape-css-input-in-html/27907002#27907002", "title": "Unescape css input in HTML", "body": "<p>The Go HTML template package properly excapes CSS. Quoting from the <a href=\"http://golang.org/pkg/html/template/\" rel=\"nofollow\">documentation of the <code>template</code> package</a>:</p>\n\n<blockquote>\n  <p>The escaping is contextual, so actions can appear within JavaScript, CSS, and URI contexts.</p>\n</blockquote>\n\n<p><code>\"ZgotmplZ\"</code> is a special value, it is used as a replacement if the value you're trying to include is invalid or unsafe in the context.</p>\n\n<p>So the problem is the CSS value you're trying to include, it is not safe. Try something simple first and see if it works, like:</p>\n\n<pre><code>body {background-color: #000}\n</code></pre>\n\n<p>Found the discussion of <code>\"ZgotmplZ\"</code> in the documentation (at type <a href=\"http://golang.org/pkg/html/template/#ErrorCode\" rel=\"nofollow\"><code>ErrorCode</code></a>), quoting it:</p>\n\n<h2><code>\"ZgotmplZ\"</code> explanation:</h2>\n\n<p><strong>Example Template:</strong></p>\n\n<pre><code>&lt;img src=\"{{.X}}\"&gt;\nwhere {{.X}} evaluates to `javascript:...`\n</code></pre>\n\n<p><strong>Discussion:</strong></p>\n\n<pre><code>\"ZgotmplZ\" is a special value that indicates that unsafe content reached a\nCSS or URL context at runtime. The output of the example will be\n  &lt;img src=\"#ZgotmplZ\"&gt;\nIf the data comes from a trusted source, use content types to exempt it\nfrom filtering: URL(`javascript:...`).\n</code></pre>\n\n<h2>Solution</h2>\n\n<p>Since the code you try to insert is in the context of CSS code and not HTML, you can't/shouldn't use <code>template.HTML(data)</code>.</p>\n\n<p>There is a predefined type <a href=\"http://golang.org/pkg/html/template/#CSS\" rel=\"nofollow\"><code>CSS</code></a> for safe inclusion of CSS code coming from trusted source, e.g. CSS code you specify and is not coming from an HTML form filled by the user. Example:</p>\n\n<pre><code>var safeCss = template.CSS(`body {background-image: url(\"paper.gif\");}`)\n</code></pre>\n\n<p>And pass the <code>safeCss</code> value to your template parameter.</p>\n"}], "owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1104, "favorite_count": 0, "accepted_answer_id": 27907002, "answer_count": 1, "score": 2, "last_activity_date": 1493033344, "creation_date": 1421081149, "last_edit_date": 1493033344, "question_id": 27906812, "link": "https://stackoverflow.com/questions/27906812/unescape-css-input-in-html", "title": "Unescape css input in HTML", "body": "<p>How do I unescape html?</p>\n\n<p>I'm passing a css file into html like this</p>\n\n<pre><code>&lt;style&gt;{{.file}}&lt;/style&gt;\n</code></pre>\n\n<p>I get this</p>\n\n<pre><code>&lt;style&gt;ZgotmplZ&lt;/style&gt;\n</code></pre>\n\n<p>I've tried wrapping the field with template.HTML(data), didn't work.</p>\n"}, {"tags": ["go", "beego"], "comments": [{"owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "edited": false, "score": 4, "creation_date": 1421075953, "post_id": 27905131, "comment_id": 44209616, "body": "Are you aware that <code>valid := validation...</code> shadows the <code>var</code> declaration of <code>valid</code>?"}, {"owner": {"reputation": 8564, "user_id": 841090, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/CYTJH.jpg?s=128&g=1", "display_name": "Passionate Engineer", "link": "https://stackoverflow.com/users/841090/passionate-engineer"}, "reply_to_user": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "edited": false, "score": 0, "creation_date": 1421076493, "post_id": 27905131, "comment_id": 44209959, "body": "@topskip Yes I do. I just put it there to test but when I take that out, it duplicates and increments again"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1421088419, "last_edit_date": 1421088419, "creation_date": 1421086049, "answer_id": 27908162, "question_id": 27905131, "link": "https://stackoverflow.com/questions/27905131/error-validation-is-incremented-and-duplicated/27908162#27908162", "title": "Error validation is incremented and duplicated", "body": "<p>Since your <code>validationInit()</code> func returns a <code>validation.Validation</code> <em>value</em> and not a <em>pointer</em> to it, you cannot return the same global variable from multiple functions or from multiple invocations of the same function.</p>\n\n<p>If you really want this, you have to return a pointer to the global variable, else a copy of the value of the global variable will be returned.</p>\n\n<p>Example:</p>\n\n<pre><code>var valid validation.Validation\n\nfunc someFunc() *valid.Validation {\n    // You can access the global variable valid here, you can also modify it\n    return &amp;valid\n}\n</code></pre>\n\n<p>But this is most likely not what you want. This would not allow you to have 2 different <code>validation.Validation</code> values exist at the same time returned by your functions.</p>\n\n<p>I suggest you to leave out the global variable, and just create a new <code>validation.Validation</code> value each time it is needed and return that new value (either by value or a pointer to it).</p>\n"}], "owner": {"reputation": 8564, "user_id": 841090, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/CYTJH.jpg?s=128&g=1", "display_name": "Passionate Engineer", "link": "https://stackoverflow.com/users/841090/passionate-engineer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 27908162, "answer_count": 1, "score": 1, "last_activity_date": 1421088419, "creation_date": 1421075588, "question_id": 27905131, "link": "https://stackoverflow.com/questions/27905131/error-validation-is-incremented-and-duplicated", "title": "Error validation is incremented and duplicated", "body": "<p>Somehow my error validations are duplicated when I use valid global variable like below</p>\n\n<pre><code>var (\n    valid validation.Validation\n)\n\nfunc validationInit() validation.Validation {\n    valid := validation.Validation{}\n    return valid\n}\n</code></pre>\n\n<p>But when I move <code>valid := validation.Validation{}</code> to my model function it works fine without any duplicates like below:</p>\n\n<pre><code>func AddClub(name string) (id int64, error []*validation.ValidationError) {\n    club := Club{Name: name}\n    valid := validation.Validation{}\n</code></pre>\n\n<p>How am I able to not duplicate this valid across each function but reuse variable without results being incremented and duplicated?</p>\n"}, {"tags": ["memory", "dictionary", "go"], "comments": [{"owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "edited": false, "score": 6, "creation_date": 1421075820, "post_id": 27905109, "comment_id": 44209509, "body": "Don&#39;t worry about memory leaks in Go, unless you do something super special."}, {"owner": {"reputation": 171, "user_id": 4287539, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/5b30fe873e721b459f58dd45aa834057?s=128&d=identicon&r=PG", "display_name": "plusmid", "link": "https://stackoverflow.com/users/4287539/plusmid"}, "edited": false, "score": 1, "creation_date": 1421076277, "post_id": 27905109, "comment_id": 44209829, "body": "Perfectly fine. Go will handle this for you."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4122236"}, "edited": false, "score": 2, "creation_date": 1421081394, "post_id": 27905109, "comment_id": 44212966, "body": "See <a href=\"http://godoc.org/net/url#ParseQuery\" rel=\"nofollow noreferrer\">ParseQuery</a> for a function that does something similar to your example."}, {"owner": {"reputation": 717, "user_id": 4445806, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c5d013c30989c84e693d5f06458d4bde?s=128&d=identicon&r=PG&f=1", "display_name": "catric mia", "link": "https://stackoverflow.com/users/4445806/catric-mia"}, "edited": false, "score": 0, "creation_date": 1421116262, "post_id": 27905109, "comment_id": 44227347, "body": "Got it, Thank you all!"}], "answers": [{"tags": [], "owner": {"reputation": 5661, "user_id": 3179857, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/74a01200b8e1bc8b9b57ddd5633288bc?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/3179857/evan"}, "is_accepted": false, "score": 2, "last_activity_date": 1421079070, "creation_date": 1421079070, "answer_id": 27906216, "question_id": 27905109, "link": "https://stackoverflow.com/questions/27905109/do-i-need-to-release-or-free-the-map-out-of-the-function/27906216#27906216", "title": "Do I need to release or free the map out of the function?", "body": "<p>Go is garbage-collected so there is no possibility of a memory leak here.</p>\n"}], "owner": {"reputation": 717, "user_id": 4445806, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c5d013c30989c84e693d5f06458d4bde?s=128&d=identicon&r=PG&f=1", "display_name": "catric mia", "link": "https://stackoverflow.com/users/4445806/catric-mia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421079070, "creation_date": 1421075527, "last_edit_date": 1421075788, "question_id": 27905109, "link": "https://stackoverflow.com/questions/27905109/do-i-need-to-release-or-free-the-map-out-of-the-function", "title": "Do I need to release or free the map out of the function?", "body": "<p>I am new to golang, and I made a function which returns a map, but I do not know if it will cause a memory leak. the code like below</p>\n\n<pre><code>func ParseParams(data string) map[string]string {\n\n    params := strings.Split(data, \"&amp;\")\n\n    m := make(map[string]string)\n\n    for idx := range params {\n\n        vals := strings.Split(params[idx], \"=\")\n        m[vals[0]] = vals[1]\n    }\n\n    return m    \n}\n</code></pre>\n\n<p>So, I would like to know if it is necessary to release or free the map ? or do something to avoid the memory leak.  Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 171, "user_id": 4287539, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/5b30fe873e721b459f58dd45aa834057?s=128&d=identicon&r=PG", "display_name": "plusmid", "link": "https://stackoverflow.com/users/4287539/plusmid"}, "edited": false, "score": 0, "creation_date": 1421074931, "post_id": 27903565, "comment_id": 44208904, "body": "Remember to convert the JavaScript into a template.HTML() before passing it to the template so it does not get escaped."}, {"owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "reply_to_user": {"reputation": 171, "user_id": 4287539, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/5b30fe873e721b459f58dd45aa834057?s=128&d=identicon&r=PG", "display_name": "plusmid", "link": "https://stackoverflow.com/users/4287539/plusmid"}, "edited": false, "score": 0, "creation_date": 1421075310, "post_id": 27903565, "comment_id": 44209126, "body": "yup, even css is escaped.. I&#39;m trying to fix this &lt;style&gt;ZgotmplZ&lt;/style&gt;"}, {"owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "reply_to_user": {"reputation": 171, "user_id": 4287539, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/5b30fe873e721b459f58dd45aa834057?s=128&d=identicon&r=PG", "display_name": "plusmid", "link": "https://stackoverflow.com/users/4287539/plusmid"}, "edited": false, "score": 0, "creation_date": 1421075433, "post_id": 27903565, "comment_id": 44209220, "body": "converting the fields to template.HTML doesn&#39;t seem to help though"}, {"owner": {"reputation": 171, "user_id": 4287539, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/5b30fe873e721b459f58dd45aa834057?s=128&d=identicon&r=PG", "display_name": "plusmid", "link": "https://stackoverflow.com/users/4287539/plusmid"}, "edited": false, "score": 0, "creation_date": 1421075806, "post_id": 27903565, "comment_id": 44209499, "body": "Strange. Try to convert it into template.JS instead. Maybe that works."}, {"owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "reply_to_user": {"reputation": 171, "user_id": 4287539, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/5b30fe873e721b459f58dd45aa834057?s=128&d=identicon&r=PG", "display_name": "plusmid", "link": "https://stackoverflow.com/users/4287539/plusmid"}, "edited": false, "score": 0, "creation_date": 1421076036, "post_id": 27903565, "comment_id": 44209664, "body": "nope its CSS. no problems with JS escaping"}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 0, "creation_date": 1421077546, "post_id": 27903565, "comment_id": 44210569, "body": "If you are looking to use this like a file server check out github.com/elazarl/go-bindata-assetfs"}, {"owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "reply_to_user": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 0, "creation_date": 1421077651, "post_id": 27903565, "comment_id": 44210635, "body": "@jmaloney what are the other ways if I just use bindata alone?"}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 0, "creation_date": 1421077933, "post_id": 27903565, "comment_id": 44210819, "body": "@user3918985 you would have to setup a route for each file you wanted to serve. If you are just trying to serve files from your binary I would strongly recommend using <code>go-bindata-assetfs</code> since that is what it was designed to do."}, {"owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "edited": false, "score": 0, "creation_date": 1421200177, "post_id": 27903565, "comment_id": 44266707, "body": "got my answer here <a href=\"http://stackoverflow.com/questions/27906812/go-unescape-css-input-in-html/27907002#27907002\" title=\"go unescape css input in html\">stackoverflow.com/questions/27906812/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "edited": false, "score": 0, "creation_date": 1421078329, "post_id": 27905769, "comment_id": 44211099, "body": "seems to have lots of bugs. I can&#39;t even build it properly"}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "reply_to_user": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "edited": false, "score": 1, "creation_date": 1421078888, "post_id": 27905769, "comment_id": 44211448, "body": "@user3918985 what platform? Works for me on mac yosemite and debian. did <code>go get github.com&#47;elazarl&#47;go-bindata-assetfs&#47;...</code> work?"}, {"owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "edited": false, "score": 0, "creation_date": 1421079144, "post_id": 27905769, "comment_id": 44211619, "body": "yea I had these problems  ./bindata_assetfs.go:9: imported and not used: &quot;strings&quot; ./bindata_assetfs.go:12: imported and not used: &quot;io/ioutil&quot; ./bindata_assetfs.go:13: imported and not used: &quot;path&quot; ./bindata_assetfs.go:14: imported and not used: &quot;path/filepath&quot; ./bindata_assetfs.go:107: undefined: _bintree ./bindata_assetfs.go:108: undefined: Asset ./bindata_assetfs.go:108: undefined: AssetDir"}], "tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": false, "score": 0, "last_activity_date": 1421077731, "creation_date": 1421077731, "answer_id": 27905769, "question_id": 27903565, "link": "https://stackoverflow.com/questions/27903565/go-embed-js-files-with-bindata/27905769#27905769", "title": "Go: embed JS files with bindata", "body": "<p>Use <a href=\"https://github.com/elazarl/go-bindata-assetfs\" rel=\"nofollow\">https://github.com/elazarl/go-bindata-assetfs</a></p>\n\n<p>From the readme:</p>\n\n<pre><code>go-bindata-assetfs data/...\n</code></pre>\n\n<p>In your code setup a route with a file server</p>\n\n<pre><code>http.Handle(\"/\", http.FileServer(assetFS()))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "is_accepted": false, "score": 0, "last_activity_date": 1421200322, "last_edit_date": 1495542828, "creation_date": 1421200322, "answer_id": 27934623, "question_id": 27903565, "link": "https://stackoverflow.com/questions/27903565/go-embed-js-files-with-bindata/27934623#27934623", "title": "Go: embed JS files with bindata", "body": "<p>Got my answer here: <a href=\"https://stackoverflow.com/questions/27906812/go-unescape-css-input-in-html/27907002#27907002\">Unescape css input in HTML</a> </p>\n\n<pre><code>var safeCss = template.CSS(`body {background-image: url(\"paper.gif\");}`)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "edited": false, "score": 0, "creation_date": 1474917442, "post_id": 36575463, "comment_id": 66719237, "body": "how the assetFs function appears in our code i cant understand this it is undefined theres no such exported methd from bindata_assetfs.go"}, {"owner": {"reputation": 26894, "user_id": 19020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VpVEj.jpg?s=128&g=1", "display_name": "Dan Esparza", "link": "https://stackoverflow.com/users/19020/dan-esparza"}, "reply_to_user": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "edited": false, "score": 0, "creation_date": 1475065180, "post_id": 36575463, "comment_id": 66790805, "body": "Look at this source line in the package used to generate the assets: <a href=\"https://github.com/elazarl/go-bindata-assetfs/blob/master/go-bindata-assetfs/main.go#L76\" rel=\"nofollow noreferrer\">github.com/elazarl/go-bindata-assetfs/blob/master/&hellip;</a>"}], "tags": [], "owner": {"reputation": 26894, "user_id": 19020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VpVEj.jpg?s=128&g=1", "display_name": "Dan Esparza", "link": "https://stackoverflow.com/users/19020/dan-esparza"}, "is_accepted": false, "score": 2, "last_activity_date": 1460469381, "creation_date": 1460469381, "answer_id": 36575463, "question_id": 27903565, "link": "https://stackoverflow.com/questions/27903565/go-embed-js-files-with-bindata/36575463#36575463", "title": "Go: embed JS files with bindata", "body": "<p>Using <a href=\"https://github.com/elazarl/go-bindata-assetfs\" rel=\"nofollow\">https://github.com/elazarl/go-bindata-assetfs</a></p>\n\n<p>Assuming you have the following structure:</p>\n\n<pre><code>myprojectdirectory\n\u251c\u2500\u2500\u2500api\n\u251c\u2500\u2500\u2500cmd\n\u251c\u2500\u2500\u2500datastores\n\u2514\u2500\u2500\u2500ui\n    \u251c\u2500\u2500\u2500css\n    \u2514\u2500\u2500\u2500js\n</code></pre>\n\n<p>Where <code>ui</code> is the directory structure you'd like to wrap up and pack into your app...</p>\n\n<h1>Generate a source file</h1>\n\n<p>The <a href=\"https://github.com/elazarl/go-bindata-assetfs\" rel=\"nofollow\">go-bindata-assetfs</a> tool is pretty simple.  It will look at the directories you pass to it and generate a source file with variables that can contain the binary data in those files.  So make sure your static files are there, and then run the following command from <code>myprojectdirectory</code>:</p>\n\n<p><code>go-bindata-assetfs ./ui/...</code></p>\n\n<p>Now, by default, this will create a source file in the package <code>main</code>.  Sometimes, this is ok.  In my case, it isn't.  You can generate a file with a different package name if you'd like:</p>\n\n<p><code>go-bindata-assetfs.exe -pkg cmd ./ui/...</code> </p>\n\n<h1>Put the source file in the correct location</h1>\n\n<p>In this case, the generated file <code>bindata_assetfs.go</code> is created in the <strong>myprojectdirectory</strong> directory (which is incorrect).  In my case, I just manually move the file to the <strong>cmd</strong> directory.</p>\n\n<h1>Update your application code</h1>\n\n<p>In my app, I already had some code that served files from a directory:</p>\n\n<pre><code>import (\n    \"net/http\"\n    \"github.com/gorilla/mux\"\n)\n\n// Create a router and setup routes\nvar Router = mux.NewRouter()    \nRouter.PathPrefix(\"/ui\").Handler(http.StripPrefix(\"/ui\", http.FileServer(http.Dir(\"./ui\"))))\n\n// Start listening\nhttp.ListenAndServe(\"127.0.0.1:3000\", Router)\n</code></pre>\n\n<p>Make sure something like this works properly, first.  Then it's trivial to change the FileServer line to:</p>\n\n<pre><code>Router.PathPrefix(\"/ui\").Handler(http.StripPrefix(\"/ui\", http.FileServer(assetFS())))\n</code></pre>\n\n<h1>Compile the app</h1>\n\n<p>Now you have a generated source file with your static assets in them.  You can now safely remove the 'ui' subdirectory structure.  Compile with </p>\n\n<p><code>go install ./...</code></p>\n\n<p>And you should have a binary that serves your static assets properly.</p>\n"}], "owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1574, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1460469381, "creation_date": 1421070865, "last_edit_date": 1495542278, "question_id": 27903565, "link": "https://stackoverflow.com/questions/27903565/go-embed-js-files-with-bindata", "title": "Go: embed JS files with bindata", "body": "<p>This question is a follow up to an earlier question of mine. I've closed the question so I hope its okay that I ask a fresh but related question here. <a href=\"https://stackoverflow.com/questions/27889779/go-embed-static-files-in-binary\">Go: embed static files in binary</a></p>\n\n<p>How do I serve JS files with go-bindata? Do I pass it into html like this </p>\n\n<p>hi.html</p>\n\n<pre><code>&lt;script&gt;{{.Bindata}}&gt;&lt;/script&gt;\n</code></pre>\n\n<p>Doesn't seem to work even though I have no compile or JS errors.</p>\n"}, {"tags": ["types", "go", "typeof", "assertion"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 8, "creation_date": 1421063403, "post_id": 27900568, "comment_id": 44202027, "body": "This is completely impossible in Go. A type assertion asserts a compile-time-constant fixed static type only. You have to rework your solution."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 1598500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5b0920422435c02fabcaf93e594117?s=128&d=identicon&r=PG", "display_name": "Nano", "link": "https://stackoverflow.com/users/1598500/nano"}, "is_accepted": false, "score": 3, "last_activity_date": 1517342249, "last_edit_date": 1517342249, "creation_date": 1421148362, "answer_id": 27921054, "question_id": 27900568, "link": "https://stackoverflow.com/questions/27900568/golang-type-assertion-using-reflect-typeof/27921054#27921054", "title": "golang type assertion using reflect.Typeof()", "body": "<p>I think what you're looking for here is a type switch. \n<a href=\"https://tour.golang.org/methods/16\" rel=\"nofollow noreferrer\">https://tour.golang.org/methods/16</a></p>\n"}, {"tags": [], "owner": {"reputation": 109950, "user_id": 86989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd262de5d82a235eeb64f71e4058198?s=128&d=identicon&r=PG", "display_name": "newacct", "link": "https://stackoverflow.com/users/86989/newacct"}, "is_accepted": false, "score": 8, "last_activity_date": 1421750000, "creation_date": 1421750000, "answer_id": 28043106, "question_id": 27900568, "link": "https://stackoverflow.com/questions/27900568/golang-type-assertion-using-reflect-typeof/28043106#28043106", "title": "golang type assertion using reflect.Typeof()", "body": "<p>A type assertion, syntactically, takes a type in the parentheses, not an expression. So it is a syntax error.</p>\n\n<p>You seem to be trying to do a type assertion with a value computed at runtime. Does that make sense? Let's think about what a type assertion is.</p>\n\n<p>A type assertion consists of two things:</p>\n\n<ol>\n<li>At compile time: It causes the resulting expression to have the desired compile-time type. The expression <code>x.(T)</code> has compile-time type <code>T</code>. This allows you to do stuff the expression that you can do with type <code>T</code>, which you may not be able to do with the type of <code>x</code>.</li>\n<li>At runtime: It checks whether the value is not <code>nil</code> and is actually of the given type, and if not, it causes a panic.</li>\n</ol>\n\n<p>The first part obviously doesn't make sense for a type computed at runtime. The compile-time type of the resulting expression cannot depend on something that is not known at compile-time.</p>\n\n<p>The second one (runtime check) can be done with a type computed at runtime. Something like:</p>\n\n<pre><code>if reflect.TypeOf(x) != someTypeComputedAtRuntime {\n    panic(42)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3258, "user_id": 1085848, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/86a0ff3564f750b3ed49cfc8b57f1275?s=128&d=identicon&r=PG", "display_name": "TomSawyer", "link": "https://stackoverflow.com/users/1085848/tomsawyer"}, "edited": false, "score": 0, "creation_date": 1520954451, "post_id": 32355224, "comment_id": 85522931, "body": "But this is for determined types only, not custom type. What if i want to do type assertion for custom struct types?"}, {"owner": {"reputation": 1519, "user_id": 506016, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b2ef6443a54b6be94a1c522b67b661a?s=128&d=identicon&r=PG&f=1", "display_name": "MondayPaper", "link": "https://stackoverflow.com/users/506016/mondaypaper"}, "reply_to_user": {"reputation": 3258, "user_id": 1085848, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/86a0ff3564f750b3ed49cfc8b57f1275?s=128&d=identicon&r=PG", "display_name": "TomSawyer", "link": "https://stackoverflow.com/users/1085848/tomsawyer"}, "edited": false, "score": 0, "creation_date": 1521748302, "post_id": 32355224, "comment_id": 85876479, "body": "In my second example, you can reflect on any struct. The &quot;int&quot; is just an example of discovering attributes on the struct as it loops over each attribute."}, {"owner": {"reputation": 3258, "user_id": 1085848, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/86a0ff3564f750b3ed49cfc8b57f1275?s=128&d=identicon&r=PG", "display_name": "TomSawyer", "link": "https://stackoverflow.com/users/1085848/tomsawyer"}, "edited": false, "score": 0, "creation_date": 1521772904, "post_id": 32355224, "comment_id": 85885020, "body": "I mean we still have to iterate every type we have. There&#39;s no way to use type of <code>reflect.TypeOf</code> then use it for type casting or type casting by string x.(&quot;customtype&quot;)"}, {"owner": {"reputation": 1519, "user_id": 506016, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b2ef6443a54b6be94a1c522b67b661a?s=128&d=identicon&r=PG&f=1", "display_name": "MondayPaper", "link": "https://stackoverflow.com/users/506016/mondaypaper"}, "reply_to_user": {"reputation": 3258, "user_id": 1085848, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/86a0ff3564f750b3ed49cfc8b57f1275?s=128&d=identicon&r=PG", "display_name": "TomSawyer", "link": "https://stackoverflow.com/users/1085848/tomsawyer"}, "edited": false, "score": 0, "creation_date": 1522082429, "post_id": 32355224, "comment_id": 85996839, "body": "Nope, you&#39;d need generics for that :("}], "tags": [], "owner": {"reputation": 1519, "user_id": 506016, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b2ef6443a54b6be94a1c522b67b661a?s=128&d=identicon&r=PG&f=1", "display_name": "MondayPaper", "link": "https://stackoverflow.com/users/506016/mondaypaper"}, "is_accepted": false, "score": 9, "last_activity_date": 1508513175, "last_edit_date": 1508513175, "creation_date": 1441202291, "answer_id": 32355224, "question_id": 27900568, "link": "https://stackoverflow.com/questions/27900568/golang-type-assertion-using-reflect-typeof/32355224#32355224", "title": "golang type assertion using reflect.Typeof()", "body": "<p>If you need to switch on the type of the outer interface{} you wont need reflection.</p>\n\n<pre><code>switch x.(type){\n  case int: \n    dosomething()\n}\n</code></pre>\n\n<p>...but if you need to switch on the type of the attributes in an interface then you can do this:</p>\n\n<pre><code>s := reflect.ValueOf(x)\nfor i:=0; i&lt;s.NumValues; i++{\n  switch s.Field(i).Interface().(type){\n    case int: \n      dosomething()\n  }\n}\n</code></pre>\n\n<p>I haven't found a cleaner way, I'd love to know if it exists.</p>\n"}, {"comments": [{"owner": {"reputation": 3328, "user_id": 1825593, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t3gK8.jpg?s=128&g=1", "display_name": "prl900", "link": "https://stackoverflow.com/users/1825593/prl900"}, "edited": false, "score": 3, "creation_date": 1465479379, "post_id": 32355902, "comment_id": 62926465, "body": "ValueOf() returns a type reflect.Value not the actual underlying type of the interface..."}], "tags": [], "owner": {"reputation": 652, "user_id": 1331234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb926fc20fe9218a0cbc7a473e40c3b7?s=128&d=identicon&r=PG", "display_name": "Pedro Fillastre", "link": "https://stackoverflow.com/users/1331234/pedro-fillastre"}, "is_accepted": false, "score": -3, "last_activity_date": 1441204073, "creation_date": 1441204073, "answer_id": 32355902, "question_id": 27900568, "link": "https://stackoverflow.com/questions/27900568/golang-type-assertion-using-reflect-typeof/32355902#32355902", "title": "golang type assertion using reflect.Typeof()", "body": "<p>I think you can use ValueOf to solve this</p>\n\n<pre><code>item2 :=  reflect.ValueOf(i)\nfmt.Printf(\"Hello, item2 : %v\\n\", item2)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1181, "user_id": 25809, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/88Sju.jpg?s=128&g=1", "display_name": "rjarmstrong", "link": "https://stackoverflow.com/users/25809/rjarmstrong"}, "is_accepted": false, "score": 1, "last_activity_date": 1520803886, "last_edit_date": 1520803886, "creation_date": 1472125172, "answer_id": 39144290, "question_id": 27900568, "link": "https://stackoverflow.com/questions/27900568/golang-type-assertion-using-reflect-typeof/39144290#39144290", "title": "golang type assertion using reflect.Typeof()", "body": "<p>If you can handle the noise and implement an extra method which all the types implement e.g. 'Type() string', you can do something like this:</p>\n\n<pre><code>        ve := &amp;ValidationError{}\n        nf := &amp;NotFound{}\n\n        switch err.Type() {\n        case ve.Type() :\n            SendBadRequest(w, err)\n        case nf.Type() :\n            http.NotFound(w, r)\n        default:\n            SendInternalError(w, err)\n        }\n</code></pre>\n"}], "owner": {"reputation": 418, "user_id": 3167570, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e2157d1c50c03d213461ef08c0408e90?s=128&d=identicon&r=PG", "display_name": "dorajistyle", "link": "https://stackoverflow.com/users/3167570/dorajistyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22776, "favorite_count": 5, "answer_count": 5, "score": 17, "last_activity_date": 1525222221, "creation_date": 1421060760, "last_edit_date": 1503786223, "question_id": 27900568, "link": "https://stackoverflow.com/questions/27900568/golang-type-assertion-using-reflect-typeof", "title": "golang type assertion using reflect.Typeof()", "body": "<p>I've tried to identify a struct with string value(name).\n<code>reflect.TypeOf</code> returns <code>Type</code>.</p>\n\n<p>But type assertion needs a <code>type</code>.</p>\n\n<p>How can I casting <code>Type</code> to <code>type</code>?</p>\n\n<p>Or any suggestion to handle it?</p>\n\n<p><a href=\"http://play.golang.org/p/3PJG3YxIyf\" rel=\"noreferrer\">http://play.golang.org/p/3PJG3YxIyf</a></p>\n\n<pre><code>package main\n\nimport (\n\"fmt\"\n\"reflect\"\n)\ntype Article struct {\n    Id             int64       `json:\"id\"`\n    Title          string      `json:\"title\",sql:\"size:255\"`\n    Content        string      `json:\"content\"`\n}\n\n\nfunc IdentifyItemType(name string) interface{} {\n    var item interface{}\n    switch name {\n    default:\n        item = Article{}\n    }\n    return item\n}\n\nfunc main() {\n\n    i := IdentifyItemType(\"name\")\n    item := i.(Article)\n    fmt.Printf(\"Hello, item : %v\\n\", item)\n    item2 := i.(reflect.TypeOf(i))  // reflect.TypeOf(i) is not a type\n    fmt.Printf(\"Hello, item2 : %v\\n\", item2)\n\n}\n</code></pre>\n"}, {"tags": ["go", "beego"], "comments": [{"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1421057373, "post_id": 27899171, "comment_id": 44198804, "body": "Pass it in as a parameter? ... this question needs some substance. What is stopping you from passing it in as a parameter?"}, {"owner": {"reputation": 8564, "user_id": 841090, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/CYTJH.jpg?s=128&g=1", "display_name": "Passionate Engineer", "link": "https://stackoverflow.com/users/841090/passionate-engineer"}, "reply_to_user": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1421057679, "post_id": 27899171, "comment_id": 44198941, "body": "@SimonWhitehead I can do that so I specify extra param inside each model function but I&#39;m not sure if this is good solution as I need to Dependancy Inject for each model call"}, {"owner": {"reputation": 711, "user_id": 1232726, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/Bg5nq.jpg?s=128&g=1", "display_name": "filthy_wizard", "link": "https://stackoverflow.com/users/1232726/filthy-wizard"}, "edited": false, "score": 0, "creation_date": 1482157545, "post_id": 27899171, "comment_id": 69648016, "body": "where is this init() method? what file?"}], "answers": [{"comments": [{"owner": {"reputation": 711, "user_id": 1232726, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/Bg5nq.jpg?s=128&g=1", "display_name": "filthy_wizard", "link": "https://stackoverflow.com/users/1232726/filthy-wizard"}, "edited": false, "score": 0, "creation_date": 1482158745, "post_id": 27900325, "comment_id": 69648819, "body": "when would this be called? and can i access this variable from any controller?"}], "tags": [], "owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "is_accepted": true, "score": 1, "last_activity_date": 1421059965, "creation_date": 1421059965, "answer_id": 27900325, "question_id": 27899171, "link": "https://stackoverflow.com/questions/27899171/how-to-remove-duplicate-orm-instantiation-in-golang-beego/27900325#27900325", "title": "How to remove duplicate ORM instantiation in Golang Beego", "body": "<p>If you want to define a variable that is available for the entire package .. you need to declare it at the package level (if you're not going to be injecting it). That is, outside of any functions.</p>\n\n<p>You also cannot use the shorthand <code>:=</code> initialization for this - it must be explicit.</p>\n\n<p>Therefore it must be something like:</p>\n\n<pre><code>var o orm.Ormer\n\nfunc init() {\n    o = orm.NewOrm()\n}\n</code></pre>\n\n<p>Notice that it is declared outside of the function, and it doesn't use the shorthand initialization and assignment operator <code>:=</code>.</p>\n"}], "owner": {"reputation": 8564, "user_id": 841090, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/CYTJH.jpg?s=128&g=1", "display_name": "Passionate Engineer", "link": "https://stackoverflow.com/users/841090/passionate-engineer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 411, "favorite_count": 0, "accepted_answer_id": 27900325, "answer_count": 1, "score": 2, "last_activity_date": 1421059965, "creation_date": 1421056267, "last_edit_date": 1421057521, "question_id": 27899171, "link": "https://stackoverflow.com/questions/27899171/how-to-remove-duplicate-orm-instantiation-in-golang-beego", "title": "How to remove duplicate ORM instantiation in Golang Beego", "body": "<p>In Golang application model</p>\n\n<p>I have below:</p>\n\n<pre><code>func AddClub(name string) int64 {\n    o := orm.NewOrm()\n    club := Club{Name: name}\n\n    id, err := o.Insert(&amp;club)\n    if err != nil {\n        fmt.Printf(\"Id: %s, Error: %s\", id, err)\n    }\n\n    return id\n}\n</code></pre>\n\n<p>Then below:</p>\n\n<pre><code>func GetAllClubs() []*Club {\n    o := orm.NewOrm()\n\n    var clubs []*Club\n    num, err := o.QueryTable(\"clubs\").All(&amp;clubs)\n    if err != nil {\n        fmt.Printf(\"Returned Rows Num: %s, %s\", num, err)\n    }\n    return clubs\n}\n</code></pre>\n\n<p>I want to remove duplication of <code>o := orm.NewOrm()</code> instantiation. How do I do this?</p>\n\n<p>I tried to put it as part of <code>init()</code> func like below:</p>\n\n<pre><code>func init() {\n  o := orm.NewOrm()\n}\n</code></pre>\n\n<p>But I get undefined o error in console</p>\n"}, {"tags": ["json", "tcp", "proxy", "go", "stream"], "comments": [{"owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "edited": false, "score": 0, "creation_date": 1421040319, "post_id": 27895746, "comment_id": 44192350, "body": "What kind of protocol is running on the connection ? you should box each packet with different content in its own message at least something like [size][payload]."}, {"owner": {"reputation": 9369, "user_id": 71079, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3e302415f77b6c398abc0b16efc653f3?s=128&d=identicon&r=PG", "display_name": "Ralph Caraveo", "link": "https://stackoverflow.com/users/71079/ralph-caraveo"}, "reply_to_user": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "edited": false, "score": 0, "creation_date": 1421040510, "post_id": 27895746, "comment_id": 44192403, "body": "@fabrizioM - the text-based protocol is a proprietary newline delimited protocol. I thought about doing what you suggest but it seams unnecessary because json is self-delimiting and the text-based protocol is delimited by newlines...everything works if it weren&#39;t for the leftover data in the json.Decoder buffer."}, {"owner": {"reputation": 1903, "user_id": 1549474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2766dac2718e51b8c5f4f021c8e740c4?s=128&d=identicon&r=PG", "display_name": "tumdum", "link": "https://stackoverflow.com/users/1549474/tumdum"}, "edited": false, "score": 1, "creation_date": 1421041166, "post_id": 27895746, "comment_id": 44192591, "body": "Given <code>io.Reader</code> you can write your own struct implementing <code>io.Reader</code> which takes two things - <code>[]bytes</code> with prefix to be served and <code>io.Reader</code> to be used when prefix is all served."}, {"owner": {"reputation": 9369, "user_id": 71079, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3e302415f77b6c398abc0b16efc653f3?s=128&d=identicon&r=PG", "display_name": "Ralph Caraveo", "link": "https://stackoverflow.com/users/71079/ralph-caraveo"}, "reply_to_user": {"reputation": 1903, "user_id": 1549474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2766dac2718e51b8c5f4f021c8e740c4?s=128&d=identicon&r=PG", "display_name": "tumdum", "link": "https://stackoverflow.com/users/1549474/tumdum"}, "edited": false, "score": 0, "creation_date": 1421041389, "post_id": 27895746, "comment_id": 44192665, "body": "@TomaszK\u0142ak - yes, I&#39;ve been thinking of something along those lines...the other constraint I forgot to mention: The code dealing with the text protocol expects not an io.Reader but a net.Conn which I may not be able to change."}, {"owner": {"reputation": 1903, "user_id": 1549474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2766dac2718e51b8c5f4f021c8e740c4?s=128&d=identicon&r=PG", "display_name": "tumdum", "link": "https://stackoverflow.com/users/1549474/tumdum"}, "edited": false, "score": 1, "creation_date": 1421041530, "post_id": 27895746, "comment_id": 44192719, "body": "@ralph-caraveo <code>net.Conn</code> is also an <code>Interface</code>, so the same principle should apply."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "reply_to_user": {"reputation": 1903, "user_id": 1549474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2766dac2718e51b8c5f4f021c8e740c4?s=128&d=identicon&r=PG", "display_name": "tumdum", "link": "https://stackoverflow.com/users/1549474/tumdum"}, "edited": false, "score": 0, "creation_date": 1421042842, "post_id": 27895746, "comment_id": 44193098, "body": "@TomaszK\u0142ak, looks like answer material to me."}], "answers": [{"comments": [{"owner": {"reputation": 9369, "user_id": 71079, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3e302415f77b6c398abc0b16efc653f3?s=128&d=identicon&r=PG", "display_name": "Ralph Caraveo", "link": "https://stackoverflow.com/users/71079/ralph-caraveo"}, "edited": false, "score": 0, "creation_date": 1421127378, "post_id": 27903121, "comment_id": 44229863, "body": "I ended up with a solution that looks very similar to this.  While not super clean it gets the job done."}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 0, "last_activity_date": 1421076207, "last_edit_date": 1421076207, "creation_date": 1421069398, "answer_id": 27903121, "question_id": 27895746, "link": "https://stackoverflow.com/questions/27895746/how-can-i-use-json-decoder-to-decode-a-single-json-message-and-switch-the-connec/27903121#27903121", "title": "How can I use json.Decoder to decode a single json message and switch the connection to a different protocol going foward?", "body": "<p>You can try</p>\n\n<pre><code>type ConnWithBuffIncluded struct{ //Implement net.Conn so can be passed through pipeline\n    net.Conn\n    json.Decoder\n}\n\nfunc (x ConnWithBuffIncluded) Read(p []byte) (n int, err error){ //Will Read both sources\n    return io.MultiReader(x.Decoder.Buffered(), x.Conn).Read(p)\n}\n</code></pre>\n"}], "owner": {"reputation": 9369, "user_id": 71079, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3e302415f77b6c398abc0b16efc653f3?s=128&d=identicon&r=PG", "display_name": "Ralph Caraveo", "link": "https://stackoverflow.com/users/71079/ralph-caraveo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 27903121, "answer_count": 1, "score": 0, "last_activity_date": 1421076207, "creation_date": 1421039994, "last_edit_date": 1421041317, "question_id": 27895746, "link": "https://stackoverflow.com/questions/27895746/how-can-i-use-json-decoder-to-decode-a-single-json-message-and-switch-the-connec", "title": "How can I use json.Decoder to decode a single json message and switch the connection to a different protocol going foward?", "body": "<p>I am working on a TCP-based proxy that must first do a REQ/REPLY handshake in json on a given connection.  Because JSON is a self-delimiting protocol I reach for Go's json.Decoder to pull off this work which does the job nicely. </p>\n\n<p>Here are the steps I take:</p>\n\n<ol>\n<li>Dial a connection to a remote server</li>\n<li>Write a single json request to a remote server (REQ)</li>\n<li>Read a single json reply from the same remote server (completing the proxy handshake REPLY)</li>\n<li>Upon a valid json handshake, pass the client connection onto another part of the code which will (going forward) switch to a text based protocol from this point on.</li>\n</ol>\n\n<p>The problem is, when json.Decoder reads data into its internal buffer it can <em>potentially</em> read more data than it needs in which case the <a href=\"http://golang.org/pkg/encoding/json/#Decoder.Buffered\" rel=\"nofollow\">json.Decoder has a Buffered()</a> method which gives back an io.Reader with the remainder of the data.</p>\n\n<p>This data (available in the Buffered() method) is now the text-based protocol data which needs to get read from the connection after the json hand-shake did its work.  But if I pass the connection forward as is without considering the left over buffer, the connection gets into a locked state because it is waiting to read this data which never comes.  The code that deals with the text-based protocol <em>expects</em> a <a href=\"http://golang.org/pkg/net/#Conn\" rel=\"nofollow\">net.Conn</a> going forward and once I pass the connection forward (after the json handshake has been made) the code utilizing the connection understands how to speak the text-based protocol at this point on. So there should be a clear boundary of work.</p>\n\n<p>My question is what is the ideal way to solve this issue so I can still take advantage of the json.Decoder, but ensure that when I pass the connection to a different part of the code in my proxy I know the start of the data for the text-based protocol will still be readable.  I somehow need to take the remaining data in the json.Decoder's Buffered() method and put that back in front of the connection so it can be properly read going forward.</p>\n\n<p>Any insight is much appreciated.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 108, "user_id": 762957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa5c720e15c9c45e775343d317ac1260?s=128&d=identicon&r=PG", "display_name": "Daved", "link": "https://stackoverflow.com/users/762957/daved"}, "is_accepted": false, "score": 0, "last_activity_date": 1421038863, "creation_date": 1421038863, "answer_id": 27895570, "question_id": 27895439, "link": "https://stackoverflow.com/questions/27895439/how-can-i-call-a-function-from-a-controller-in-a-subdirectory-golang/27895570#27895570", "title": "How can I call a function from a controller in a subdirectory - Golang", "body": "<p>Go convention prevents this.  You must keep Index() within the main package.</p>\n\n<p>Once you have some code that can be separated out, you will then create a sub-directory (package) and import it into main.</p>\n\n<p><a href=\"https://golang.org/doc/effective_go.html\" rel=\"nofollow\">https://golang.org/doc/effective_go.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 9024, "user_id": 670034, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f1c180c6f131125bb52a4a019099f929?s=128&d=identicon&r=PG", "display_name": "Beat Richartz", "link": "https://stackoverflow.com/users/670034/beat-richartz"}, "is_accepted": false, "score": 0, "last_activity_date": 1421055575, "creation_date": 1421055575, "answer_id": 27898973, "question_id": 27895439, "link": "https://stackoverflow.com/questions/27895439/how-can-i-call-a-function-from-a-controller-in-a-subdirectory-golang/27898973#27898973", "title": "How can I call a function from a controller in a subdirectory - Golang", "body": "<p><a href=\"https://golang.org/doc/code.html#Organization\" rel=\"nofollow\">Go code organization rules</a> require one directory per package. Since your package <code>main</code> is split over the root directory and the <code>controllers</code> directory, your code organization won't work.</p>\n\n<p>You can either make <code>controllers</code> a package and then import it into <code>main</code>, which I'd only recommend if you are projecting for a large codebase, or simply relocate the controllers file to the root directory.</p>\n"}], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1286, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1421055575, "creation_date": 1421037986, "question_id": 27895439, "link": "https://stackoverflow.com/questions/27895439/how-can-i-call-a-function-from-a-controller-in-a-subdirectory-golang", "title": "How can I call a function from a controller in a subdirectory - Golang", "body": "<p>I am trying to make a web app, without using a Framework like Revel and just using the Gorilla toolkit,</p>\n\n<p>So far I have structured my app like this:</p>\n\n<pre><code>/App\n- Controllers\n   - Index.go\n- Views\n   - Index.html\n- Public\n   - css\n   - js\n   - img\n- main.go\n</code></pre>\n\n<p>My <code>main.go</code> looks like:</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/gorilla/mux\"\n    \"net/http\"\n)\n\nfunc main() {\n\n    r := mux.NewRouter()\n\n    r.HandleFunc(\"/\", Index)\n\n    http.Handle(\"/\", r)\n\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>And <code>Index.go</code> looks like </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc Index(res http.ResponseWriter, req *http.Request) {\n    fmt.Println(\"Here\")\n}\n</code></pre>\n\n<p>But when I <code>go run main.go</code> it says Index is undefined, I'm not sure how to call functions from another file in a subdirectory. Any information would be great thanks.</p>\n"}, {"tags": ["go", "gmail-api"], "comments": [{"owner": {"reputation": 977, "user_id": 4204155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b97cac237052e03909c015c998f96e1?s=128&d=identicon&r=PG&f=1", "display_name": "SGC", "link": "https://stackoverflow.com/users/4204155/sgc"}, "edited": false, "score": 1, "creation_date": 1421100673, "post_id": 27895290, "comment_id": 44222784, "body": "Question is similar to <a href=\"http://stackoverflow.com/questions/26841905/sending-email-multipart-signed-rfc-3156-via-gmail-apis\" title=\"sending email multipart signed rfc 3156 via gmail apis\">stackoverflow.com/questions/26841905/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 32008, "user_id": 322020, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/dce43cb8158a14c3fed02bea797becd7?s=128&d=identicon&r=PG", "display_name": "Nakilon", "link": "https://stackoverflow.com/users/322020/nakilon"}, "edited": false, "score": 1, "creation_date": 1474564670, "post_id": 27949360, "comment_id": 66593697, "body": "From your answer the <code>content-type: text&#47;html</code> was what helped me."}], "tags": [], "owner": {"reputation": 6387, "user_id": 3758997, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Pe0zH.jpg?s=128&g=1", "display_name": "Eric D", "link": "https://stackoverflow.com/users/3758997/eric-d"}, "is_accepted": false, "score": 1, "last_activity_date": 1421258040, "creation_date": 1421258040, "answer_id": 27949360, "question_id": 27895290, "link": "https://stackoverflow.com/questions/27895290/why-the-gmail-api-sends-html-emails-as-plain-text/27949360#27949360", "title": "Why the gmail API sends html emails as plain text?", "body": "<p>Hmm, are you sure it's not a bug in your program?  Can you print out the entire string and paste it here?</p>\n\n<p>I just used the Gmail API to send an email like:</p>\n\n<pre>\nTo: &lt;redacted&gt;\nSubject: test html email 2015-01-14 09:45:40\nContent-type: text/html\n\n&lt;html&gt;&lt;body&gt;&lt;b&gt;hello&lt;/b&gt;world&lt;/body&gt;&lt;/html&gt;\n</pre>\n\n<p>and it looked as expected by the recipient's end in Gmail. Well, actually looks like it got wrapped it in a multipart/alternative and added a text/plain part as well (good thing IMO):</p>\n\n<pre>\n&lt;random trace headers&gt;\nMIME-Version: 1.0\nFrom: &lt;redacted&gt;\nDate: Wed, 14 Jan 2015 09:46:41 -0800\nMessage-ID: \nSubject: test html email 2015-01-14 09:45:40\nTo: &lt;redacted&gt;\nContent-Type: multipart/alternative; boundary=089e0141a9a2875c38050ca05201\n\n--089e0141a9a2875c38050ca05201\nContent-Type: text/plain; charset=UTF-8\n\n*hello*world\n\n--089e0141a9a2875c38050ca05201\nContent-Type: text/html; charset=UTF-8\n\n&lt;html&gt;&lt;body&gt;&lt;b&gt;hello&lt;/b&gt;world&lt;/body&gt;&lt;/html&gt;\n--089e0141a9a2875c38050ca05201--\n</pre>\n\n<p>In any case, it's doing some parsing/sanitizing but <em>does</em> allow sending text/html email.</p>\n"}], "owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1560, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1421258040, "creation_date": 1421036693, "last_edit_date": 1421199417, "question_id": 27895290, "link": "https://stackoverflow.com/questions/27895290/why-the-gmail-api-sends-html-emails-as-plain-text", "title": "Why the gmail API sends html emails as plain text?", "body": "<p>I'm trying to send a html email using the gmail API but for some reasons it randomly sends the email as plain/text. It seems that Google alters the content type header I set. Is there any reason for that? The email content is exactly same all the time (as I test it). Is the API still experimental?\n Sometimes when it works it also adds <code>Content-Type: multipart/alternative;</code> (although I never set it).</p>\n\n<p>The encoding process looks as below. The code is Go but I guess it self explanatory and the process is language agnostic.</p>\n\n<pre><code>    header := make(map[string]string)\n    header[\"From\"] = em.From.String()\n    header[\"To\"] = em.To.String()\n//   header[\"Subject\"] = encodeRFC2047(em.Subject)\n    header[\"Subject\"] = em.Subject\n    header[\"MIME-Version\"] = \"1.0\"\n    header[\"Content-Type\"] = \"text/html; charset=\\\"utf-8\\\"\"\n//  header[\"Content-Transfer-Encoding\"] = \"base64\"\n    header[\"Content-Transfer-Encoding\"] = \"quoted-printable\"\n    var msg string\n    for k, v := range header {\n        msg += fmt.Sprintf(\"%s: %s\\r\\n\", k, v)\n    }\n\n    msg += \"\\r\\n\" + em.Message\n    gmsg := gmail.Message{\n        Raw: encodeWeb64String([]byte(msg)),\n    }\n    _, err = gmailService.Users.Messages.Send(\"me\", &amp;gmsg).Do()\n</code></pre>\n"}, {"tags": ["go", "beego"], "answers": [{"comments": [{"owner": {"reputation": 8564, "user_id": 841090, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/CYTJH.jpg?s=128&g=1", "display_name": "Passionate Engineer", "link": "https://stackoverflow.com/users/841090/passionate-engineer"}, "edited": false, "score": 0, "creation_date": 1421041485, "post_id": 27895672, "comment_id": 44192702, "body": "I just updated my question. I have RegisterDatabase under init function already"}, {"owner": {"reputation": 8564, "user_id": 841090, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/CYTJH.jpg?s=128&g=1", "display_name": "Passionate Engineer", "link": "https://stackoverflow.com/users/841090/passionate-engineer"}, "edited": false, "score": 0, "creation_date": 1421041701, "post_id": 27895672, "comment_id": 44192771, "body": "Interesting thing is that same thing works on dev environment but does not on prod with similar settings. DB credentials work fine"}, {"owner": {"reputation": 595, "user_id": 1107942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18f0f0f1c9e4088e7a36872dd95f13d8?s=128&d=identicon&r=PG", "display_name": "MrSaints", "link": "https://stackoverflow.com/users/1107942/mrsaints"}, "reply_to_user": {"reputation": 8564, "user_id": 841090, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/CYTJH.jpg?s=128&g=1", "display_name": "Passionate Engineer", "link": "https://stackoverflow.com/users/841090/passionate-engineer"}, "edited": false, "score": 0, "creation_date": 1421044525, "post_id": 27895672, "comment_id": 44193567, "body": "I&#39;m assuming there are no other errors besides what you&#39;ve reported. If it&#39;s possible, may I see how you are using the ORM? <code>RegisterDatabase</code> also returns an <code>error</code>, so you could try capturing that although that shouldn&#39;t be necessary (as it should already be handled). Besides that, are you using any environment specific config / conditions?"}, {"owner": {"reputation": 8564, "user_id": 841090, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/CYTJH.jpg?s=128&g=1", "display_name": "Passionate Engineer", "link": "https://stackoverflow.com/users/841090/passionate-engineer"}, "edited": false, "score": 0, "creation_date": 1421047002, "post_id": 27895672, "comment_id": 44194317, "body": "Never mind. It was due to PG SSL mode being enabled. I disabled it in the connection string and it worked fine."}, {"owner": {"reputation": 711, "user_id": 1232726, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/Bg5nq.jpg?s=128&g=1", "display_name": "filthy_wizard", "link": "https://stackoverflow.com/users/1232726/filthy-wizard"}, "edited": false, "score": 2, "creation_date": 1482165340, "post_id": 27895672, "comment_id": 69653067, "body": "same issue. db registered with &quot;default&#39; BUT NOT WORKING."}, {"owner": {"reputation": 1506, "user_id": 2831700, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5e40a909ecdd6e94a32e120c0044ac9d?s=128&d=identicon&r=PG", "display_name": "IvRRimUm", "link": "https://stackoverflow.com/users/2831700/ivrrimum"}, "edited": false, "score": 0, "creation_date": 1588184552, "post_id": 27895672, "comment_id": 108805772, "body": "Yeah, still not working for me. Here&#39;s my connecting config: <code>orm.RegisterDataBase(&quot;default&quot;, &quot;postgres&quot;, &quot;root:rootroot@localhost&#47;project_development?sslmode=disable&zwnj;&#8203;&quot;)</code>, This is the error i get: <code>register db Ping </code>default<code>, pq: SSL is not enabled on the server</code>"}, {"owner": {"reputation": 1506, "user_id": 2831700, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5e40a909ecdd6e94a32e120c0044ac9d?s=128&d=identicon&r=PG", "display_name": "IvRRimUm", "link": "https://stackoverflow.com/users/2831700/ivrrimum"}, "edited": false, "score": 0, "creation_date": 1588184679, "post_id": 27895672, "comment_id": 108805836, "body": "Figured it out, here&#39;s a working example: <code>orm.RegisterDataBase(&quot;default&quot;, &quot;postgres&quot;, &quot;postgres:&#47;&#47;root:rootroot@localhost&#47;project_development?sslm&zwnj;&#8203;ode=disable&quot;)</code>"}], "tags": [], "owner": {"reputation": 595, "user_id": 1107942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18f0f0f1c9e4088e7a36872dd95f13d8?s=128&d=identicon&r=PG", "display_name": "MrSaints", "link": "https://stackoverflow.com/users/1107942/mrsaints"}, "is_accepted": false, "score": 0, "last_activity_date": 1421039485, "creation_date": 1421039485, "answer_id": 27895672, "question_id": 27894796, "link": "https://stackoverflow.com/questions/27894796/beego-must-have-one-register-database-alias-named-default/27895672#27895672", "title": "Beego must have one register DataBase alias named `default`", "body": "<p>Can you provide a sample of your code?</p>\n\n<p>Based on the error message you have provided, you may not have registered a database with alias <code>default</code> using <code>orm.RegisterDataBase</code>. Here's an example which I have taken from the <a href=\"http://beego.me/docs/mvc/model/orm.md#registerdatabase\" rel=\"nofollow\">documentation</a>:</p>\n\n<pre><code>// param 1:        Database alias. ORM will use it to switch database.\n// param 2:        driverName\n// param 3:        connection string\norm.RegisterDataBase(\"default\", \"mysql\", \"root:root@/orm_test?charset=utf8\")\n</code></pre>\n\n<p>In beego, it is common to register the driver and the database in <code>init</code> of <code>main.go</code> <a href=\"http://beego.me/docs/mvc/model/orm.md#main.go\" rel=\"nofollow\">(example)</a>.</p>\n"}], "owner": {"reputation": 8564, "user_id": 841090, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/CYTJH.jpg?s=128&g=1", "display_name": "Passionate Engineer", "link": "https://stackoverflow.com/users/841090/passionate-engineer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 6432, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1421041471, "creation_date": 1421032496, "last_edit_date": 1421041471, "question_id": 27894796, "link": "https://stackoverflow.com/questions/27894796/beego-must-have-one-register-database-alias-named-default", "title": "Beego must have one register DataBase alias named `default`", "body": "<p>In the production server with Beego I get</p>\n\n<p>must have one register DataBase alias named <code>default</code></p>\n\n<p>I know the db connection credentials work in the server but whenever I do restful request I get this error and the Beego server crashes.</p>\n\n<p>Is there a reason why this is happening?</p>\n\n<p>Below is the code inside main.go init function:</p>\n\n<pre><code>orm.RegisterDriver(\"postgres\", orm.DR_Postgres)\n\norm.RegisterDataBase(\"default\", \"postgres\",\n    fmt.Sprintf(\"postgres://%s:%s@%s/%s?port=%i\",\n        pgUser, pgPass, pgHost, pgDb, pgPort))\n</code></pre>\n"}, {"tags": ["go", "revel"], "answers": [{"tags": [], "owner": {"reputation": 595, "user_id": 1107942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18f0f0f1c9e4088e7a36872dd95f13d8?s=128&d=identicon&r=PG", "display_name": "MrSaints", "link": "https://stackoverflow.com/users/1107942/mrsaints"}, "is_accepted": true, "score": 1, "last_activity_date": 1421030755, "last_edit_date": 1421030755, "creation_date": 1421029971, "answer_id": 27894552, "question_id": 27893339, "link": "https://stackoverflow.com/questions/27893339/how-do-i-set-a-persistent-global-template-variable-from-the-controller-using-rev/27894552#27894552", "title": "How do I set a persistent global template variable from the controller using Revel / Golang", "body": "<p>You are on the right track if you are using <code>c.RenderArgs</code> unless I have misunderstood your intentions.</p>\n\n<p>Here's an example (or rather, a walkthrough) of how you may use it (taken from Revel's <a href=\"http://revel.github.io/samples/booking.html\" rel=\"nofollow\">booking sample app</a>):</p>\n\n<ol>\n<li><p><a href=\"https://github.com/revel/revel/blob/df5d88dbece276012b4c7ab45a33a1047c1db108/samples/booking/app/controllers/init.go#L8\" rel=\"nofollow\">init.go:</a> Register an <a href=\"http://revel.github.io/manual/interceptors.html\" rel=\"nofollow\">interceptor</a> to add the user's information before an action is taken (<code>AddUser</code> will be fired before <code>Render</code>).</p></li>\n<li><p><a href=\"https://github.com/revel/revel/blob/master/samples/booking/app/controllers/app.go#L14\" rel=\"nofollow\">app.go:</a> Check if the user is connected and if so, store the user's data in the <code>RenderArgs</code> map like so:</p></li>\n</ol>\n\n<p><code>c.RenderArgs[\"user\"] = user</code></p>\n\n<ol start=\"3\">\n<li><p>Line 31 deals with the <a href=\"https://github.com/revel/revel/blob/master/samples/booking/app/models/user.go#L9\" rel=\"nofollow\">model</a>. </p></li>\n<li><p><a href=\"https://github.com/revel/revel/blob/df5d88dbece276012b4c7ab45a33a1047c1db108/samples/booking/app/views/header.html#L23\" rel=\"nofollow\">header.html:</a> Pass the username template variable in.</p></li>\n</ol>\n\n<p>I hope this helps.</p>\n\n<p>EDIT: I should probably add that the user's username is <a href=\"https://github.com/revel/revel/blob/master/samples/booking/app/controllers/app.go#L78\" rel=\"nofollow\">stored in a session</a> upon login. It's used to <a href=\"https://github.com/revel/revel/blob/master/samples/booking/app/controllers/app.go#L25\" rel=\"nofollow\">retrieve more information</a>.</p>\n"}], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 732, "favorite_count": 0, "accepted_answer_id": 27894552, "answer_count": 1, "score": 1, "last_activity_date": 1421030755, "creation_date": 1421019053, "last_edit_date": 1421026902, "question_id": 27893339, "link": "https://stackoverflow.com/questions/27893339/how-do-i-set-a-persistent-global-template-variable-from-the-controller-using-rev", "title": "How do I set a persistent global template variable from the controller using Revel / Golang", "body": "<p>I'm new to Golang and I'm switching over from Node.js server to a Golang server, I'm trying to rewrite an app I had previously written for Node.</p>\n\n<p>I want to set Template variables when a user is signed in, but I'm not sure how and yes, I've tried googling it.</p>\n\n<p>This is my register user controller:</p>\n\n<pre><code>func (c User) RegisterUser(user_email, user_password,\n    user_password_confirmation, user_first_name,\n    user_last_name string) revel.Result {\n\n    // Validate Email\n    c.Validation.Required(user_email).Message(\"Username is required\")\n    c.Validation.Email(user_email).Message(\"Email is not a valid email\")\n    c.Validation.MinSize(user_email, 5).Message(\"Email must be greater than 5 characters\")\n    // Validate Password\n    c.Validation.Required(user_password).Message(\"Password is required\")\n    c.Validation.MinSize(user_password, 5).Message(\"Password must be greater than 5 characters.\")\n    // Validate Password Confirmation\n    c.Validation.Required(user_password_confirmation).Message(\"Password Confirmation is required\")\n    c.Validation.MinSize(user_password_confirmation, 5).Message(\"Password must be greater than 5 characters.\")\n    c.Validation.Required(user_password == user_password_confirmation).Message(\"Your passwords do not match\")\n    // Validate First Name\n    c.Validation.Required(user_first_name).Message(\"First Name is required\")\n    c.Validation.MinSize(user_first_name, 3).Message(\"Your First Name must be greater than 3 characters\")\n    // Validate Last Name\n    c.Validation.Required(user_last_name).Message(\"Last Name is required\")\n    c.Validation.MinSize(user_last_name, 3).Message(\"Your Last Name must be greater than 3 characters\")\n\n    // If anything wasn't right, set flash and display errors to user\n    if c.Validation.HasErrors() {\n        c.Validation.Keep()\n        c.FlashParams()\n        return c.Redirect(User.Register)\n    }\n\n    // Hash The Users Password\n    password := []byte(user_password_confirmation)\n    hashedPassword, err := bcrypt.GenerateFromPassword(password, 10)\n    if err != nil {\n        c.Flash.Error(\"Invalid Username or Password Combination\")\n        return c.Redirect(User.Register)\n    }\n\n    // Connect to database\n    db, err := sql.Open(\"mysql\", \"root:******@/WebRTC\")\n    if err != nil {\n        c.Flash.Error(\"Unable to connect to database. Try again later!\")\n        return c.Redirect(User.Register)\n    }\n    defer db.Close()\n\n    // Ping the database, ensure there is a connection\n    err = db.Ping()\n    if err != nil {\n        c.Flash.Error(\"Unable to connect to database. Try again later!\")\n        return c.Redirect(User.Register)\n    }\n\n    // Prepare SQL Statement for Security\n    stmtIns, err := db.Prepare(\"INSERT INTO users (user_email, user_first_name, user_last_name, \" +\n        \"user_password_hash, user_created_at, user_created_ip, user_last_ip) VALUES (?, ?, ?, ?, ?, ?, ?)\")\n\n    if err != nil {\n        c.Flash.Error(\"Unable to Register you. Please try again later\")\n        return c.Redirect(User.Register)\n    }\n    defer stmtIns.Close()\n\n    // Insert Data into Database\n    _, err = stmtIns.Exec(user_email, user_first_name, user_last_name, hashedPassword,\n        time.Now().Local(), c.Request.RemoteAddr, c.Request.RemoteAddr)\n    if err != nil {\n        c.Flash.Error(\"Unable to register you. Please try again later\")\n        return c.Redirect(User.Register)\n    }\n\n    // Here I want to add the global template variable\n    return c.Redirect(User.Register)\n}\n</code></pre>\n\n<p>I've read about <code>c.RenderArgs</code> but it doesn't seem to do what I want it to. </p>\n\n<p>I want to be able to set the users' username, so that I can display it in the navbar so that they know they're logged in.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2484, "user_id": 3794472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZTwGs.jpg?s=128&g=1", "display_name": "Jeremiah Winsley", "link": "https://stackoverflow.com/users/3794472/jeremiah-winsley"}, "edited": false, "score": 1, "creation_date": 1421019040, "post_id": 27893304, "comment_id": 44187898, "body": "You&#39;re deferring <code>wg.Done()</code>, but you still have it at the end of the function. Try moving it to the beginning, before it has a chance to return from an error."}, {"owner": {"reputation": 171, "user_id": 4287539, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/5b30fe873e721b459f58dd45aa834057?s=128&d=identicon&r=PG", "display_name": "plusmid", "link": "https://stackoverflow.com/users/4287539/plusmid"}, "edited": false, "score": 7, "creation_date": 1421019241, "post_id": 27893304, "comment_id": 44187949, "body": "Pass a pointer to <code>wg</code> to the function rather than the struct itself."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 3, "last_activity_date": 1421019486, "creation_date": 1421019486, "answer_id": 27893389, "question_id": 27893304, "link": "https://stackoverflow.com/questions/27893304/golang-sync-waitgroup-never-completes/27893389#27893389", "title": "golang sync.WaitGroup never completes", "body": "<p>Arguments in Go are always passed by value. Use a pointer when an argument may be modified. Also, make sure that you always execute <code>wg.Done()</code>.For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"os\"\n    \"strings\"\n    \"sync\"\n)\n\nfunc main() {\n    links := parseLinks()\n\n    wg := new(sync.WaitGroup)\n\n    for _, url := range links {\n        if isExcelDocument(url) {\n            wg.Add(1)\n            go downloadFromURL(url, wg)\n        } else {\n            fmt.Printf(\"Skipping: %v \\n\", url)\n        }\n    }\n    wg.Wait()\n}\n\nfunc downloadFromURL(url string, wg *sync.WaitGroup) error {\n    defer wg.Done()\n    tokens := strings.Split(url, \"/\")\n    fileName := tokens[len(tokens)-1]\n    fmt.Printf(\"Downloading %v to %v \\n\", url, fileName)\n\n    content, err := os.Create(\"temp_docs/\" + fileName)\n    if err != nil {\n        fmt.Printf(\"Error while creating %v because of %v\", fileName, err)\n        return err\n    }\n\n    resp, err := http.Get(url)\n    if err != nil {\n        fmt.Printf(\"Could not fetch %v because %v\", url, err)\n        return err\n    }\n    defer resp.Body.Close()\n\n    _, err = io.Copy(content, resp.Body)\n    if err != nil {\n        fmt.Printf(\"Error while saving %v from %v\", fileName, url)\n        return err\n    }\n\n    fmt.Printf(\"Download complete for %v \\n\", fileName)\n\n    return nil\n}\n\nfunc isExcelDocument(url string) bool {\n    return strings.HasSuffix(url, \".xlsx\") || strings.HasSuffix(url, \".xls\")\n}\n\nfunc parseLinks() []string {\n    linksData, err := ioutil.ReadFile(\"links.txt\")\n    if err != nil {\n        fmt.Printf(\"Trouble reading file: %v\", err)\n    }\n\n    links := strings.Split(string(linksData), \", \")\n\n    return links\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2804, "user_id": 2326753, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tzfnK.png?s=128&g=1", "display_name": "C4d", "link": "https://stackoverflow.com/users/2326753/c4d"}, "edited": false, "score": 0, "creation_date": 1508831025, "post_id": 27893401, "comment_id": 80756363, "body": "Pointer boom. Solved my problem and learned something new. Thanks! :)"}], "tags": [], "owner": {"reputation": 5547, "user_id": 131658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66b0d64c07b143d59ee5327d0617a01d?s=128&d=identicon&r=PG", "display_name": "Bartosz", "link": "https://stackoverflow.com/users/131658/bartosz"}, "is_accepted": true, "score": 35, "last_activity_date": 1421019966, "last_edit_date": 1421019966, "creation_date": 1421019605, "answer_id": 27893401, "question_id": 27893304, "link": "https://stackoverflow.com/questions/27893304/golang-sync-waitgroup-never-completes/27893401#27893401", "title": "golang sync.WaitGroup never completes", "body": "<p>There are two problems with this code. First, you have to pass a pointer to the WaitGroup to <code>downloadFromURL()</code>, otherwise the object will be copied and <code>Done()</code> will not be visible in <code>main()</code>.</p>\n\n<p>See:</p>\n\n<pre><code>func main() {\n    ...\n    go downloadFromURL(url, &amp;wg)\n    ...\n}\n</code></pre>\n\n<p>Second, <code>defer wg.Done()</code> should be one of the first statements in <code>downloadFromURL()</code>, otherwise if you return from the function before that statement, it won't get \"registered\" and won't get called.</p>\n\n<pre><code>func downloadFromURL(url string, wg *sync.WaitGroup) error {\n    defer wg.Done()\n    ...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 929, "user_id": 8109026, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jomoj.jpg?s=128&g=1", "display_name": "Raed Shomali", "link": "https://stackoverflow.com/users/8109026/raed-shomali"}, "is_accepted": false, "score": 0, "last_activity_date": 1496886738, "creation_date": 1496886738, "answer_id": 44425413, "question_id": 27893304, "link": "https://stackoverflow.com/questions/27893304/golang-sync-waitgroup-never-completes/44425413#44425413", "title": "golang sync.WaitGroup never completes", "body": "<p>As @Bartosz mentioned, you will need to pass a reference to your <code>WaitGroup</code> object. He did a great job discussing the importance of <code>defer ws.Done()</code></p>\n\n<p>I like <code>WaitGroup</code>'s simplicity. However, I do not like that we need to pass the reference to the goroutine because that would mean that the concurrency logic would be mixed with your business logic.</p>\n\n<p>So I came up with this generic function to solve this problem for me:</p>\n\n<pre><code>// Parallelize parallelizes the function calls\nfunc Parallelize(functions ...func()) {\n    var waitGroup sync.WaitGroup\n    waitGroup.Add(len(functions))\n\n    defer waitGroup.Wait()\n\n    for _, function := range functions {\n        go func(copy func()) {\n            defer waitGroup.Done()\n            copy()\n        }(function)\n    }\n}\n</code></pre>\n\n<p>So your example could be solved this way:</p>\n\n<pre><code>func main() {\n    links := parseLinks()\n\n    functions := []func(){}\n    for _, url := range links {\n        if isExcelDocument(url) {\n            function := func(url string){\n                return func() { downloadFromURL(url) }\n            }(url)\n\n            functions = append(functions, function)\n        } else {\n            fmt.Printf(\"Skipping: %v \\n\", url)\n        }\n    }\n\n    Parallelize(functions...)\n}\n\nfunc downloadFromURL(url string) {\n    ...\n}\n</code></pre>\n\n<p>If you would like to use it, you can find it here <a href=\"https://github.com/shomali11/util\" rel=\"nofollow noreferrer\">https://github.com/shomali11/util</a></p>\n"}], "owner": {"reputation": 1140, "user_id": 1949363, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KOMTs.jpg?s=128&g=1", "display_name": "srt32", "link": "https://stackoverflow.com/users/1949363/srt32"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8329, "favorite_count": 7, "accepted_answer_id": 27893401, "answer_count": 3, "score": 9, "last_activity_date": 1496886738, "creation_date": 1421018785, "question_id": 27893304, "link": "https://stackoverflow.com/questions/27893304/golang-sync-waitgroup-never-completes", "title": "golang sync.WaitGroup never completes", "body": "<p>I have the below code that fetches a list of URL's and then conditionally downloads a file and saves it to the filesystem. The files are fetched concurrently and the main goroutine waits for all the files to be fetched. But, the program <strong>never exits</strong> (and there are no errors) after completing all the requests.</p>\n\n<p>What I think is happening is that somehow the amount of go routines in the <code>WaitGroup</code> is either incremented by too many to begin with (via <code>Add</code>) or not decremented by enough (a <code>Done</code> call is not happening).</p>\n\n<p>Is there something I am obviously doing wrong? How would I inspect how many go routines are presently in the <code>WaitGroup</code> so I can better debug what's happening?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"os\"\n    \"strings\"\n    \"sync\"\n)\n\nfunc main() {\n    links := parseLinks()\n\n    var wg sync.WaitGroup\n\n    for _, url := range links {\n        if isExcelDocument(url) {\n            wg.Add(1)\n            go downloadFromURL(url, wg)\n        } else {\n            fmt.Printf(\"Skipping: %v \\n\", url)\n        }\n    }\n    wg.Wait()\n}\n\nfunc downloadFromURL(url string, wg sync.WaitGroup) error {\n    tokens := strings.Split(url, \"/\")\n    fileName := tokens[len(tokens)-1]\n    fmt.Printf(\"Downloading %v to %v \\n\", url, fileName)\n\n    content, err := os.Create(\"temp_docs/\" + fileName)\n    if err != nil {\n        fmt.Printf(\"Error while creating %v because of %v\", fileName, err)\n        return err\n    }\n\n    resp, err := http.Get(url)\n    if err != nil {\n        fmt.Printf(\"Could not fetch %v because %v\", url, err)\n        return err\n    }\n    defer resp.Body.Close()\n\n    _, err = io.Copy(content, resp.Body)\n    if err != nil {\n        fmt.Printf(\"Error while saving %v from %v\", fileName, url)\n        return err\n    }\n\n    fmt.Printf(\"Download complete for %v \\n\", fileName)\n\n    defer wg.Done()\n    return nil\n}\n\nfunc isExcelDocument(url string) bool {\n    return strings.HasSuffix(url, \".xlsx\") || strings.HasSuffix(url, \".xls\")\n}\n\nfunc parseLinks() []string {\n    linksData, err := ioutil.ReadFile(\"links.txt\")\n    if err != nil {\n        fmt.Printf(\"Trouble reading file: %v\", err)\n    }\n\n    links := strings.Split(string(linksData), \", \")\n\n    return links\n}\n</code></pre>\n"}, {"tags": ["heroku", "go"], "comments": [{"owner": {"reputation": 666, "user_id": 1847644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JjElv.png?s=128&g=1", "display_name": "Daveloper87", "link": "https://stackoverflow.com/users/1847644/daveloper87"}, "edited": false, "score": 1, "creation_date": 1455836773, "post_id": 27891968, "comment_id": 58681090, "body": "Go version 1.6 answer here: <a href=\"http://stackoverflow.com/questions/26076898/go-app-on-heroku-with-local-packages/35494254#35494254\" title=\"go app on heroku with local packages\">stackoverflow.com/questions/26076898/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2677, "user_id": 1740154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/keyyz.jpg?s=128&g=1", "display_name": "twitchdotcom slash KANJICODER", "link": "https://stackoverflow.com/users/1740154/twitchdotcom-slash-kanjicoder"}, "edited": false, "score": 0, "creation_date": 1501117039, "post_id": 27892001, "comment_id": 77641228, "body": "Please fix the typo: &quot;$GOAPTH/bin&quot;"}], "tags": [], "owner": {"reputation": 186, "user_id": 4084427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93e57fa5b59ca191642d4abfc70fd019?s=128&d=identicon&r=PG&f=1", "display_name": "Bonnie", "link": "https://stackoverflow.com/users/4084427/bonnie"}, "is_accepted": false, "score": 2, "last_activity_date": 1503260784, "last_edit_date": 1503260784, "creation_date": 1421009747, "answer_id": 27892001, "question_id": 27891968, "link": "https://stackoverflow.com/questions/27891968/deploying-go-webapps-to-heroku-cant-find-package-issue/27892001#27892001", "title": "Deploying go webapps to heroku: can&#39;t find package issue", "body": "<p>Fixed the issue by adding my <code>$GOPATH/bin</code> dir to my path.</p>\n\n<p><code>export PATH=$PATH:$GOPATH/bin</code></p>\n\n<p>Curious as to why this was necessary, though.</p>\n"}], "owner": {"reputation": 186, "user_id": 4084427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93e57fa5b59ca191642d4abfc70fd019?s=128&d=identicon&r=PG&f=1", "display_name": "Bonnie", "link": "https://stackoverflow.com/users/4084427/bonnie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1430, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1503260784, "creation_date": 1421009581, "question_id": 27891968, "link": "https://stackoverflow.com/questions/27891968/deploying-go-webapps-to-heroku-cant-find-package-issue", "title": "Deploying go webapps to heroku: can&#39;t find package issue", "body": "<p>I'm following <a href=\"http://codegangsta.gitbooks.io/building-web-apps-with-go/content/deployment/README.html\" rel=\"nofollow\">this tutorial</a> and attempting to deploy a bare-bones Go web app to Heroku, but am having difficulties resolving an error:</p>\n\n<p><code>\nremote: -----&gt; Running: godep go install -tags heroku ./...\nremote: main.go:7:3: cannot find package \"github.com/russross/blackfriday\" in any of:\nremote:     /app/tmp/cache/go1.3.3/go/src/pkg/github.com/russross/blackfriday (from $GOROOT)\nremote:     /tmp/build_1a204a91c152b49fe234bde14529ad27/.heroku/g/src/bitbucket.gotest/Godeps/_workspace/src/github.com/russross/blackfriday (from $GOPATH)\nremote:     /tmp/build_1a204a91c152b49fe234bde14529ad27/.heroku/g/src/github.com/russross/blackfriday\nremote: godep: go exit status 1\nremote: \nremote:  !     Push rejected, failed to compile Go app\n</code></p>\n\n<p>I'm new to Go, so I assume I've screwed up my package structure, but running <code>$GOPATH/bin/godep go install</code> or <code>go install</code> works fine.</p>\n\n<p>Here's the (abbreviated) structure of my go directory:</p>\n\n<ul>\n<li>src\n<ul>\n<li>testapp</li>\n<li>main.go</li>\n<li>github.com\n-codegangsta</li>\n<li>russross</li>\n<li>blackfriday</li>\n</ul></li>\n</ul>\n\n<p>Thanks.</p>\n"}, {"tags": ["data-structures", "enums", "go", "logparser"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 2, "creation_date": 1421012326, "post_id": 27891913, "comment_id": 44185914, "body": "It&#39;s unclear what you&#39;re asking Please clarify your specific problem or add additional details to highlight exactly what you need. As it&#39;s currently written, it\u2019s hard to tell exactly what you&#39;re asking. For example, provide a sample of log file lines."}, {"owner": {"reputation": 14115, "user_id": 139137, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7c0fa8fb73fe4c951ea79b476007c77d?s=128&d=identicon&r=PG", "display_name": "victorhooi", "link": "https://stackoverflow.com/users/139137/victorhooi"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1421020788, "post_id": 27891913, "comment_id": 44188309, "body": "@peterSO Sure, I&#39;ve added headings, and tried to clarify the question a bit more - let me know if that&#39;s helpful."}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 0, "creation_date": 1421020844, "post_id": 27891913, "comment_id": 44188322, "body": "Regarding enums, you may want to define a type (<code>type LogLevel int</code>) and then use <code>iota</code> in your const definitions (<code>const (INFO LogLevel = iota</code> then, <code>DEBUG</code>, <code>ERROR</code> etc.) See <a href=\"http://play.golang.org/p/PjrjSVIvrS\" rel=\"nofollow noreferrer\">play.golang.org/p/PjrjSVIvrS</a> <a href=\"https://golang.org/ref/spec#Iota\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Iota</a>"}], "answers": [{"tags": [], "owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "is_accepted": true, "score": 0, "last_activity_date": 1421045239, "last_edit_date": 1421045239, "creation_date": 1421021433, "answer_id": 27893606, "question_id": 27891913, "link": "https://stackoverflow.com/questions/27891913/compact-data-structure-for-storing-parsed-log-lines-in-go-i-e-compact-data-str/27893606#27893606", "title": "Compact data structure for storing parsed log lines in Go (i.e. compact data structure for multiple enums in Go)", "body": "<p><strong><em>Do you see any issues with either of the two planned changes above? Are these a good starting point?</em></strong></p>\n\n<p>No problems with either. If the logs are definitely line-delimited you can just store the line number, but it may be more robust to store the byte-offset. The standard <code>io.Reader</code> interface returns the number of bytes read so you can use that to gain the offset.</p>\n\n<p><strong><em>Do you have any other tips/suggestions for optimising the memory consumption of how we store the loglines?</em></strong></p>\n\n<p>It depends on what you want to use them for, but once they've been tokenized (and you've got the data you want from the line), why hold onto the line in memory? It's already in the file, and you've now got an offset to look it up again quickly.</p>\n\n<p><strong><em>are there any equivalents to roaring bitmaps but for enumerations? Or any other clever way of storing this compactly?</em></strong></p>\n\n<p>I'd tend to just define each enum type as an int, and use <code>iota</code>. Something like:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\ntype LogLevel int\ntype LogComponent int\ntype Operation int\n\nconst (\n    Info LogLevel = iota\n    Warning\n    Debug\n    Error\n)\n\nconst (\n    Storage LogComponent = iota\n    Journal\n    Commands\n    Indexin\n)\n\nconst (\n    Query Operation = iota\n    Insert\n    Delete\n)\n\ntype LogLine struct {\n    DateTime      time.Time\n    QueryDuration time.Duration\n    ThreadName    string\n    ConNum        uint\n    Level         LogLevel\n    Comp          LogComponent\n    Op            Operation\n    Namespace     string\n}\n\nfunc main() {\n    l := &amp;LogLine{\n        time.Now(),\n        10 * time.Second,\n        \"query1\",\n        1000,\n        Info,\n        Journal,\n        Delete,\n        \"ns1\",\n    }\n    fmt.Printf(\"%v\\n\", l)\n}\n</code></pre>\n\n<p>Produces <code>&amp;{2009-11-10 23:00:00 +0000 UTC 10s query1 1000 0 1 2 ns1}</code>.</p>\n\n<p><a href=\"http://play.golang.org/p/n7QTz5mQin\" rel=\"nofollow\">Playground</a></p>\n\n<p>You could pack some of the struct fields, but then you need to define bit-ranges for each field and you lose some open-endedness. For example define LogLevel as the first 2 bits, Component as the next 2 bits etc.</p>\n\n<p><strong><em>I also thought of bloom filters, and maybe using those to store whether each logline was in a set (i.e. logging level warning, logging level error) - however, it can only be in one of those sets, so I don't know if that makes sense. Also, not sure how to handle the false positives.</em></strong></p>\n\n<p>For your current example, bloom filters may be overkill. It may be easier to have a []int for each enum, or some other master \"index\" that keeps track of line-number to (for example) log level relationships. As you said, each log line can only be in one set. In fact, depending on the number of enum fields, it may be easier to use the packed enums as an identifier for something like a <code>map[int][]int</code>. </p>\n\n<pre><code>Set := make(map[int][]int)\nSet[int(Delete) &lt;&lt; 4 + int(Journal) &lt;&lt; 2 + int(Debug)] = []int{7, 45, 900} // Line numbers in this set.\n</code></pre>\n\n<p>See <a href=\"http://play.golang.org/p/ckKlDcmODf\" rel=\"nofollow\">here</a> for a complete, although hackish example.</p>\n"}], "owner": {"reputation": 14115, "user_id": 139137, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7c0fa8fb73fe4c951ea79b476007c77d?s=128&d=identicon&r=PG", "display_name": "victorhooi", "link": "https://stackoverflow.com/users/139137/victorhooi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 0, "accepted_answer_id": 27893606, "answer_count": 1, "score": -1, "last_activity_date": 1421045239, "creation_date": 1421009288, "last_edit_date": 1421020752, "question_id": 27891913, "link": "https://stackoverflow.com/questions/27891913/compact-data-structure-for-storing-parsed-log-lines-in-go-i-e-compact-data-str", "title": "Compact data structure for storing parsed log lines in Go (i.e. compact data structure for multiple enums in Go)", "body": "<p>I'm working on a script that parses and graph information from a database logfile. Some examples loglines might be:</p>\n\n<pre><code>Tue Dec  2 03:21:09.543 [rsHealthPoll] DBClientCursor::init call() failed\nTue Dec  2 03:21:09.543 [rsHealthPoll] replset info example.com:27017 heartbeat failed, retrying\nThu Nov 20 00:05:13.189 [conn1264369] insert foobar.fs.chunks ninserted:1 keyUpdates:0 locks(micros) w:110298 110ms\nThu Nov 20 00:06:19.136 [conn1263135] update foobar.fs.chunks query: { files_id: ObjectId('54661657b23a225c1e4b00ac'), n: 0 } update: { $set: { data: BinData } } nscanned:1 nupdated:1 keyUpdates:0 locks(micros) w:675 137ms\nThu Nov 20 00:06:19.136 [conn1258266] update foobar.fs.chunks query: { files_id: ObjectId('54661657ae3a22741e0132df'), n: 0 } update: { $set: { data: BinData } } nscanned:1 nupdated:1 keyUpdates:0 locks(micros) w:687 186ms\nThu Nov 20 00:12:14.859 [conn1113639] getmore local.oplog.rs query: { ts: { $gte: Timestamp 1416453003000|74 } } cursorid:7965836327322142721 ntoreturn:0 keyUpdates:0 numYields: 15 locks(micros) r:351042 nreturned:3311 reslen:56307 188ms\n</code></pre>\n\n<p>Not every logline contains all fields, but some of the fields we parse out include:</p>\n\n<ul>\n<li>Datetime</li>\n<li>Query Duration</li>\n<li>Name of Thread</li>\n<li>Connection Number (e.g. 1234, 532434, 53433)</li>\n<li>Logging Level (e.g. Warning, Error, Info, Debug etc.)</li>\n<li>Logging Component (e.g. Storage, Journal, Commands, Indexin etc.)</li>\n<li>Type of operation (e.g. Query, Insert, Delete etc.)</li>\n<li>Namespace</li>\n</ul>\n\n<p>The total logfile can often be fairly large (several hundred MBs up to a coupe of GBs). Currently the script is in Python, and as well as the fields, it's also storing the original raw logline as well as a tokenised version - the resulting memory consumption though is actually several multiples of the original logfile size. Hence, memory consumption is one of the main things I'd like to improve.</p>\n\n<p>For fun/learning, I thought I might try re-doing this in Go, and looking at whether we could use a more compact data structure.</p>\n\n<p>Many of the fields are enumerations (enums) - for some of them the set of values is known in advance (e.g. logging leve, logging component). For others (e.g. name of thread, connection number, namespace), we'll work out the set at runtime as we parse the logfile.</p>\n\n<p><strong>Planned Changes</strong></p>\n\n<p>Firstly, many of these enums are stored as strings. So I'm guessing one improvement will be move to using something like an <code>uint8</code> to store it, and then either using consts (for the ones we know in advance), or having some kind of mapping table back to the original string (for the ones we work out.) Or are there any other reaosns I'd prefer consts versus some kind of mapping structure?</p>\n\n<p>Secondly, rather than storing the original logline as a string, we can probably store an offset back to the original file on disk.</p>\n\n<p><strong>Questions</strong></p>\n\n<ol>\n<li>Do you see any issues with either of the two planned changes above? Are these a good starting point?</li>\n<li>Do you have any other tips/suggestions for optimising the memory consumption of how we store the loglines?</li>\n<li>I know for bitmaps, there's things like Roaring Bitmaps (<a href=\"http://roaringbitmap.org/\" rel=\"nofollow\">http://roaringbitmap.org/</a>), which are compressed bitmaps which you can still access/modify normally whilst compressed. Apparently the overall term for things like this is succinct data structures.\nHowever, are there any equivalents to roaring bitmaps but for enumerations? Or any other clever way of storing this compactly?</li>\n<li>I also thought of bloom filters, and maybe using those to store whether each logline was in a set (i.e. logging level warning, logging level error) - however, it can only be in one of those sets, so I don't know if that makes sense. Also, not sure how to handle the false positives.</li>\n</ol>\n\n<p>Thoughts?</p>\n"}, {"tags": ["google-app-engine", "deployment", "go", "appcfg"], "answers": [{"tags": [], "owner": {"reputation": 1485, "user_id": 3560557, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ronco.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3560557/tom"}, "is_accepted": false, "score": 1, "last_activity_date": 1421060990, "creation_date": 1421060990, "answer_id": 27900626, "question_id": 27891216, "link": "https://stackoverflow.com/questions/27891216/parallel-module-deployment-using-app-engine-sdk/27900626#27900626", "title": "Parallel Module Deployment using App Engine SDK", "body": "<p>You can deploy to another \"version\" of your App Engine app, then when all modules are deployed, do a very fast version switch?</p>\n\n<p>Versions also allow for traffic splitting if you need/want that kind of thing.</p>\n"}], "owner": {"reputation": 151, "user_id": 2146855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ca5178ee371114b35b5b7f813b5d8db?s=128&d=identicon&r=PG", "display_name": "Jonathan Azoff", "link": "https://stackoverflow.com/users/2146855/jonathan-azoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1421060990, "creation_date": 1421004815, "question_id": 27891216, "link": "https://stackoverflow.com/questions/27891216/parallel-module-deployment-using-app-engine-sdk", "title": "Parallel Module Deployment using App Engine SDK", "body": "<p>TL;DR <strong>Is there a way to deploy App Engine modules in parallel?</strong></p>\n\n<p>I've built a go application using Google's <a href=\"https://cloud.google.com/appengine/downloads#Google_App_Engine_SDK_for_Go\" rel=\"nofollow\">App Engine SDK for Go</a>. This application defines multiple <a href=\"https://cloud.google.com/appengine/docs/go/modules/\" rel=\"nofollow\">modules</a>. These modules are self-contained, and do not require any sort of dependency across other modules. </p>\n\n<p>When I attempt to <a href=\"https://cloud.google.com/appengine/docs/go/tools/uploadinganapp#Go_Uploading_the_app\" rel=\"nofollow\">deploy the modules</a> to the Google Cloud, I can't help but notice that the modules are uploaded sequentially. This would be fine if deployment was relatively quick, but each module requires it's own redundant compilation of the Go binary. Hence, on top of the regular upload time, I have to wait for my app to compile [module count] x [compilation time] every time I want to deploy.</p>\n\n<p>The obvious (quick) solution is to deploy in parallel, so I created a simple bash script to deploy each module independently. The problem I immediately encountered with this \"solution\" was a HTTP 500 response from the App Engine API. The whole umbrella application, spanning across all the modules, seems to \"lock\" whenever any individual module is updated. This scenario creates a race condition, under which only the first module to trigger a deploy succeeds and the others fail.</p>\n\n<p>I fear that this is a holdover from the legacy languages in App Engine. Since every module uses the same Go binary, it doesn't really necessitate multiple compilations of the same code. Repeated compilation is redundant, and there is no way to circumvent the lock.</p>\n\n<p>One hypothetical solution, which I have only a vague understanding of, is to compile in parallel and deploy in series. I imagine that this approach would involve taking apart <a href=\"https://cloud.google.com/appengine/docs/appcfg\" rel=\"nofollow\">the configuration tool</a> and reworking it to execute in the aforementioned manner- though I can't say for sure (yet).</p>\n\n<p>Any help here would be much obliged. Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 1, "creation_date": 1420996968, "post_id": 27889779, "comment_id": 44180702, "body": "As in <a href=\"http://stackoverflow.com/a/27010732/6309\">stackoverflow.com/a/27010732/6309</a>?"}], "answers": [{"comments": [{"owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "edited": false, "score": 0, "creation_date": 1421069035, "post_id": 27891243, "comment_id": 44205167, "body": "thanks for that! what&#39;s about serving JS files? I tried to pass them in a struct form into the html template in tmpl.Execute. The JS error I got was this  GET <a href=\"http://localhost:8000/\" rel=\"nofollow noreferrer\">localhost:8000</a>*!%20jQuery%20v2.1.3%20%7c%20%28c%29%202005,%2&zwnj;&#8203;02014%2\u2026%7c[%5c%5cw-&zwnj;&#8203;]%7c[%5e%5c%5cx00-%5&zwnj;&#8203;c%5cxa0]%29+%22,N=M.&zwnj;&#8203;replace%28%22w%22,%2&zwnj;&#8203;2w"}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "reply_to_user": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "edited": false, "score": 0, "creation_date": 1421076320, "post_id": 27891243, "comment_id": 44209853, "body": "@user3918985 that looks like your JS file is getting escaped by the html template. If you just want to serve the contents of a file from your binary you do not need to use <code>html&#47;template</code> just serve the contents you get from the <code>Asset</code> function. In a <code>HandleFunc</code> you could just use the <code>w http.ResponseWriter</code> to write out the Asset data like <code>w.Write(data)</code>"}, {"owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "edited": false, "score": 0, "creation_date": 1421076559, "post_id": 27891243, "comment_id": 44209997, "body": "wow.. but I have to write each data individually? Or can I serve them in one directory? I&#39;m trying now."}, {"owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "edited": false, "score": 0, "creation_date": 1421076661, "post_id": 27891243, "comment_id": 44210048, "body": "hmm I get the entire file contents printed on the page.. Im trying to write css file"}, {"owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "edited": false, "score": 0, "creation_date": 1421076851, "post_id": 27891243, "comment_id": 44210173, "body": "I posted another question here: <a href=\"http://stackoverflow.com/questions/27903565/go-embed-js-files-with-bindata?noredirect=1#comment44209499_27903565\" title=\"go embed js files with bindata\">stackoverflow.com/questions/27903565/&hellip;</a>"}], "tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": true, "score": 5, "last_activity_date": 1421007482, "last_edit_date": 1421007482, "creation_date": 1421004995, "answer_id": 27891243, "question_id": 27889779, "link": "https://stackoverflow.com/questions/27889779/go-embed-static-files-in-binary/27891243#27891243", "title": "Go: embed static files in binary", "body": "<p>Given a directory structure like so:</p>\n\n<pre><code>example/\n    main.go\n    data/hi.html\n</code></pre>\n\n<p>example/main.go</p>\n\n<pre><code>package main\n\nimport (\n    \"html/template\"\n    \"log\"\n    \"net/http\"\n    \"os\"\n)\n\nvar tmpl *template.Template\n\nfunc init() {\n    data, err := Asset(\"data/hi.html\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    tmpl = template.Must(template.New(\"tmpl\").Parse(string(data)))\n}\n\nfunc main() {\n    // print to stdout\n    tmpl.Execute(os.Stdout, map[string]string{\"Name\": \"James\"})\n\n    http.HandleFunc(\"/\", func(w http.ResponseWriter, req *http.Request) {\n        tmpl.Execute(w, map[string]string{\"Name\": \"James\"})\n    })\n\n    log.Fatal(http.ListenAndServe(\":8000\", nil))\n}\n</code></pre>\n\n<p>example/data/hi.html</p>\n\n<pre><code>&lt;h1&gt;Hi, {{.Name}}&lt;/h1&gt;\n</code></pre>\n\n<p>run like so:</p>\n\n<pre><code>go-bindata data &amp;&amp; go build &amp;&amp; ./example\n</code></pre>\n\n<p>Console Output:</p>\n\n<pre><code>&lt;h1&gt;Hi, James&lt;/h1&gt;\n</code></pre>\n\n<p>HTTP output:</p>\n\n<h1>Hi, James</h1>\n"}, {"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 6, "last_activity_date": 1611367108, "last_edit_date": 1611367108, "creation_date": 1607104349, "answer_id": 65148366, "question_id": 27889779, "link": "https://stackoverflow.com/questions/27889779/go-embed-static-files-in-binary/65148366#65148366", "title": "Go: embed static files in binary", "body": "<p>5/6 years later, this should be easier with Go 1.16 (Q1 2021), which adds support for embedded files (<a href=\"https://github.com/golang/go/issues/41191\" rel=\"nofollow noreferrer\">issue/proposal 41191</a> )</p>\n<blockquote>\n<p>It will be permitted to use <code>//go:embed</code> naming a single file to initialize a plain <code>string</code> or <code>[]byte</code> variable:</p>\n</blockquote>\n<pre><code>//go:embed gopher.png\nvar gopherPNG []byte\n</code></pre>\n<p>The import is required to flag the file as containing <code>//go:embed</code> lines and needing processing.<br />\n<code>Goimports</code> (and <code>gopls</code> etc) can be taught this rule and automatically add the import in any file with a <code>//go:embed</code> as needed.</p>\n<p>That sparked a debate on <a href=\"https://github.com/golang/go/issues/42328\" rel=\"nofollow noreferrer\">issue 42328</a> about how to avoid surprising inclusion of &quot;hidden&quot; files when using <code>//go:embed</code></p>\n<p>This as resolved in <a href=\"https://go-review.googlesource.com/c/go/+/275092/\" rel=\"nofollow noreferrer\">CL 275092</a> and <a href=\"https://github.com/golang/go/commit/37588ffcb221c12c12882b591a16243ae2799fd1\" rel=\"nofollow noreferrer\">commit 37588ff</a></p>\n<blockquote>\n<p>Decision to exclude files matching <code>.*</code> and <code>_*</code> from embedded directory results when embedding an entire directory tree.</p>\n</blockquote>\n<p>See <a href=\"https://github.com/golang/go/blob/37588ffcb221c12c12882b591a16243ae2799fd1/src/embed/internal/embedtest/embed_test.go\" rel=\"nofollow noreferrer\"><code>src/embed/internal/embedtest/embed_test.go</code></a></p>\n<pre class=\"lang-golang prettyprint-override\"><code>    //go:embed testdata/k*.txt\n    var local embed.FS\n    testFiles(t, local, &quot;testdata/ken.txt&quot;, &quot;If a program is too slow, it must have a loop.\\n&quot;)\n\n    //go:embed testdata/k*.txt\n    var s string\n    testString(t, s, &quot;local variable s&quot;, &quot;If a program is too slow, it must have a loop.\\n&quot;)\n\n    //go:embed testdata/h*.txt\n    var b []byte\n    testString(t, string(b), &quot;local variable b&quot;, &quot;hello, world\\n&quot;)\n</code></pre>\n<p>Note: with <a href=\"https://go-review.googlesource.com/c/go/+/281492/\" rel=\"nofollow noreferrer\">CL 281492</a>, <code>cmd/go</code> passes <code>embedcfg</code> to <code>gccgo</code> if supported.</p>\n<hr />\n<p>See also (Jan. 2021) <a href=\"https://github.com/golang/go/issues/43854\" rel=\"nofollow noreferrer\">issue 43854</a> &quot;opt-in for <code>//go:embed</code> to <em>not</em> ignore files and empty dirs&quot;.</p>\n"}], "owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4459, "favorite_count": 2, "accepted_answer_id": 27891243, "answer_count": 2, "score": 5, "last_activity_date": 1611367108, "creation_date": 1420996292, "question_id": 27889779, "link": "https://stackoverflow.com/questions/27889779/go-embed-static-files-in-binary", "title": "Go: embed static files in binary", "body": "<p>This might be a very amateur question. I'm trying to embed static files into binary, ie. html. How do I  do that with <a href=\"https://github.com/jteeuwen/go-bindata\" rel=\"noreferrer\">https://github.com/jteeuwen/go-bindata</a>?</p>\n\n<p>So I can access an asset with this <a href=\"https://github.com/jteeuwen/go-bindata#accessing-an-asset\" rel=\"noreferrer\">https://github.com/jteeuwen/go-bindata#accessing-an-asset</a>, but what do I do with \"data\", and how to do I parse files, execute template, and serve them in the directory?</p>\n\n<p>I couldn't find any examples online, and will appreciate some help!</p>\n"}, {"tags": ["google-app-engine", "go", "docker", "fig"], "answers": [{"comments": [{"owner": {"reputation": 2157, "user_id": 2147006, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/NRvi4.png?s=128&g=1", "display_name": "Quentin Donnellan", "link": "https://stackoverflow.com/users/2147006/quentin-donnellan"}, "edited": false, "score": 0, "creation_date": 1421069143, "post_id": 27896303, "comment_id": 44205231, "body": "Oh dang, I must have totally missed that &quot;volumes&quot; served this purpose, this is hugely helpful, thanks (going to try it now...)"}, {"owner": {"reputation": 2157, "user_id": 2147006, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/NRvi4.png?s=128&g=1", "display_name": "Quentin Donnellan", "link": "https://stackoverflow.com/users/2147006/quentin-donnellan"}, "edited": false, "score": 0, "creation_date": 1421075936, "post_id": 27896303, "comment_id": 44209603, "body": "Blarg... no luck yet, I think I have some &quot;docker&quot; education issues to solve first before I get to the Go problems here (if there indeed are any). I&#39;m bookmarking this and will definitely accept once I can confirm my stupidity is not the blocker!"}], "tags": [], "owner": {"reputation": 2897, "user_id": 2037841, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/04f06e605ef5a9d0a2871d4f610a78b8?s=128&d=identicon&r=PG", "display_name": "Johannes Reuter", "link": "https://stackoverflow.com/users/2037841/johannes-reuter"}, "is_accepted": false, "score": 1, "last_activity_date": 1421043306, "creation_date": 1421043306, "answer_id": 27896303, "question_id": 27888496, "link": "https://stackoverflow.com/questions/27888496/re-build-go-app-engine-app-running-inside-docker-container/27896303#27896303", "title": "Re-build Go (App Engine) app running inside docker container?", "body": "<p>I think the problem here is that the files don't change inside the docker-container, only on the host-filesystem. Your source-directory is added in the Dockerfile (when the container-image is built). If you change the files later, the container is not automatically rebuilt.</p>\n\n<p>To solve this issue (for development-purposes) you could mount the source-directory from your host-system into the docker-container. with this trick, source-changes are automatically added to the container.</p>\n\n<p>To to this, add</p>\n\n<pre><code>volumes:\n  - .:/go/src\n</code></pre>\n"}], "owner": {"reputation": 2157, "user_id": 2147006, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/NRvi4.png?s=128&g=1", "display_name": "Quentin Donnellan", "link": "https://stackoverflow.com/users/2147006/quentin-donnellan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421043306, "creation_date": 1420988623, "question_id": 27888496, "link": "https://stackoverflow.com/questions/27888496/re-build-go-app-engine-app-running-inside-docker-container", "title": "Re-build Go (App Engine) app running inside docker container?", "body": "<p>Normally, when you run a Go app using Go-Appengine's <code>goapp serve</code> command, file changes are detected and initiate a re-build. </p>\n\n<pre><code>INFO     2015-01-11 ... Detected file changes: ...\n</code></pre>\n\n<p>I'm currently experimenting with running <a href=\"https://github.com/qdonnellan/figgo-appengine\" rel=\"nofollow\">Go-Appengine inside a docker container</a>, and while the server starts appropriately, file changes do not initiate a re-build. How do I make this happen?</p>\n\n<p>From my personal experience, Django projects running inside and outside docker containers behave the same way when file changes are detected. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1420988380, "post_id": 27888406, "comment_id": 44177760, "body": "What about go build then go install (no parameter)? Would you see your program compiled in <code>&#47;home&#47;jdevoo&#47;Downloads&#47;go&#47;bin</code>? Where is your main.go? Directly under <code>&#47;home&#47;jdevoo&#47;Downloads&#47;go&#47;src</code>?"}, {"owner": {"reputation": 46, "user_id": 1599428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/634646fc72639cf4c63ce95f2d2dbd37?s=128&d=identicon&r=PG", "display_name": "jdevoo", "link": "https://stackoverflow.com/users/1599428/jdevoo"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1420988753, "post_id": 27888406, "comment_id": 44177874, "body": "tried - no change. The file main.go is under <code>github.com&#47;eris-ltd&#47;decerver&#47;cmd&#47;decerver</code> - I see install generating the archives but not run the last linker step"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1420988826, "post_id": 27888406, "comment_id": 44177903, "body": "Where is your <code>main.go</code>? Directly under <code>&#47;home&#47;jdevoo&#47;Downloads&#47;go&#47;src</code>?"}, {"owner": {"reputation": 46, "user_id": 1599428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/634646fc72639cf4c63ce95f2d2dbd37?s=128&d=identicon&r=PG", "display_name": "jdevoo", "link": "https://stackoverflow.com/users/1599428/jdevoo"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1420988980, "post_id": 27888406, "comment_id": 44177957, "body": "my $GOPATH does not include multiple entries and I tried with a simple hello program which worked well and produced hello binary"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1420989049, "post_id": 27888406, "comment_id": 44177983, "body": "Can you try and move your main.go under a subfolder within <code>&#47;home&#47;jdevoo&#47;Downloads&#47;go&#47;src</code>? Or did you mean that your <code>GOPATH</code> hasn&#39;t even a <code>src</code> in it?"}], "answers": [{"comments": [{"owner": {"reputation": 46, "user_id": 1599428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/634646fc72639cf4c63ce95f2d2dbd37?s=128&d=identicon&r=PG", "display_name": "jdevoo", "link": "https://stackoverflow.com/users/1599428/jdevoo"}, "edited": false, "score": 0, "creation_date": 1420989565, "post_id": 27888577, "comment_id": 44178158, "body": "roger that. Workspace contains the 3 folders. The application was installed using <code>go get github.com&#47;eris-ltd&#47;decerver</code> followed by <code>cd $GOPATH&#47;src&#47;github.com&#47;eris-ltd&#47;decerver&#47;cmd&#47;decerver&#47;</code> then <code>go get -d .</code> and <code>go install</code> - this worked and had produced the original binary. All I tried to do is modify one file and re-generate the executable. That&#39;s why I am stuck - not sure what is wrong... super weird"}, {"owner": {"reputation": 46, "user_id": 1599428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/634646fc72639cf4c63ce95f2d2dbd37?s=128&d=identicon&r=PG", "display_name": "jdevoo", "link": "https://stackoverflow.com/users/1599428/jdevoo"}, "edited": false, "score": 0, "creation_date": 1420989623, "post_id": 27888577, "comment_id": 44178174, "body": "what else can prevent the linker from kicking in? Go is leaving me with the archive files... that&#39;s it"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 46, "user_id": 1599428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/634646fc72639cf4c63ce95f2d2dbd37?s=128&d=identicon&r=PG", "display_name": "jdevoo", "link": "https://stackoverflow.com/users/1599428/jdevoo"}, "edited": false, "score": 0, "creation_date": 1420990685, "post_id": 27888577, "comment_id": 44178552, "body": "Maybe that modified go file isn&#39;t used by main.go, and the build process doesn&#39;t rebuild the <code>decerver</code> command as a result?"}, {"owner": {"reputation": 46, "user_id": 1599428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/634646fc72639cf4c63ce95f2d2dbd37?s=128&d=identicon&r=PG", "display_name": "jdevoo", "link": "https://stackoverflow.com/users/1599428/jdevoo"}, "edited": false, "score": 0, "creation_date": 1420991757, "post_id": 27888577, "comment_id": 44178924, "body": "OK - I managed to get a new binary by accident. I issued <code>go get -x</code> from the directory containing main.go"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 0, "last_activity_date": 1420992090, "last_edit_date": 1420992090, "creation_date": 1420989107, "answer_id": 27888577, "question_id": 27888406, "link": "https://stackoverflow.com/questions/27888406/go-install-doesnt-create-bin-file/27888577#27888577", "title": "Go install doesn&#39;t create bin file", "body": "<p>It really depends on where exactly is your <code>main.go</code>.</p>\n\n<p>It should be in <code>$GOPATH/src/yourProject/main.go</code>, for a <code>go install</code> to generate a <code>$GOPATH/bin/yourProject</code>.<br>\nThat is what \"<a href=\"https://golang.org/doc/code.html#Command\" rel=\"nofollow\">Your first program</a>\" describes.</p>\n\n<p><code>$GOPATH</code> is <a href=\"https://golang.org/doc/code.html#Workspaces\" rel=\"nofollow\">your workspace</a>, and should always include <code>src</code>, <code>pkg</code> and <code>bin</code>.</p>\n\n<p>To get a binary specifically for that command:</p>\n\n<pre><code>cd $GOPATH/src/github.com/eris-ltd/decerver/cmd/decerver/\ngo get\n# or\ngo install\n</code></pre>\n\n<p>Note the <code>-x</code> option is supposed to \"print the command\" only.<br>\n<code>-a</code> would force rebuilding.</p>\n"}], "owner": {"reputation": 46, "user_id": 1599428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/634646fc72639cf4c63ce95f2d2dbd37?s=128&d=identicon&r=PG", "display_name": "jdevoo", "link": "https://stackoverflow.com/users/1599428/jdevoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2485, "favorite_count": 1, "accepted_answer_id": 27888577, "answer_count": 1, "score": 0, "last_activity_date": 1420992090, "creation_date": 1420988166, "last_edit_date": 1495534217, "question_id": 27888406, "link": "https://stackoverflow.com/questions/27888406/go-install-doesnt-create-bin-file", "title": "Go install doesn&#39;t create bin file", "body": "<p>Issue is similar to the one described <a href=\"https://stackoverflow.com/questions/26694271/go-install-doesnt-create-any-bin-file\">here</a> but the answer did not help me.</p>\n\n<p>I use Go 1.4 built from source.\nI have issued <code>$ go install -x -a</code> to force the rebuild of all packages (although I only made a change to a single go file). The project is well structured and contains a command in a file named main.go with <code>package main</code> and <code>func main()</code>\nI am running out of ideas but gained a better understanding of the build process...</p>\n\n<pre><code>$ go env\nGOARCH=\"386\"\nGOBIN=\"\"\nGOCHAR=\"8\"\nGOEXE=\"\"\nGOHOSTARCH=\"386\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/jdevoo/Downloads/go\"\nGORACE=\"\"\nGOROOT=\"/home/jdevoo/go\"\nGOTOOLDIR=\"/home/jdevoo/go/pkg/tool/linux_386\"\nCC=\"gcc\"\nGOGCCFLAGS=\"-fPIC -m32 -pthread -fmessage-length=0\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2484, "user_id": 3794472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZTwGs.jpg?s=128&g=1", "display_name": "Jeremiah Winsley", "link": "https://stackoverflow.com/users/3794472/jeremiah-winsley"}, "edited": false, "score": 1, "creation_date": 1420984163, "post_id": 27887706, "comment_id": 44176522, "body": "Doesn&#39;t appear to address this particular question, but may be helpful: <a href=\"http://stackoverflow.com/a/19334952/3794472\">stackoverflow.com/a/19334952/3794472</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 2, "last_activity_date": 1420989709, "creation_date": 1420989709, "answer_id": 27888674, "question_id": 27887706, "link": "https://stackoverflow.com/questions/27887706/golang-type-aliasing-type-sampletype-othertype-othertype/27888674#27888674", "title": "Golang type aliasing (type SampleType otherType !== otherType)?", "body": "<p>Doing</p>\n\n<pre><code>type Res response.Response\n</code></pre>\n\n<p>you define new type, which is not interchangeable with original</p>\n\n<p>to convert you should do</p>\n\n<pre><code>newResponse := Res(response.NewResponse(w))\n</code></pre>\n\n<p>when you do</p>\n\n<pre><code>type Res http.ResponseWriter\n</code></pre>\n\n<p>your type Res is an interface and http.ResponseWriter implement it, so can be used as arg in func where Res wanted</p>\n"}], "owner": {"reputation": 9295, "user_id": 1650757, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/0RwsN.jpg?s=128&g=1", "display_name": "Melbourne2991", "link": "https://stackoverflow.com/users/1650757/melbourne2991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1949, "favorite_count": 0, "accepted_answer_id": 27888674, "answer_count": 1, "score": 0, "last_activity_date": 1420989709, "creation_date": 1420983418, "last_edit_date": 1420983738, "question_id": 27887706, "link": "https://stackoverflow.com/questions/27887706/golang-type-aliasing-type-sampletype-othertype-othertype", "title": "Golang type aliasing (type SampleType otherType !== otherType)?", "body": "<p>I am building a simple router for which the code is below. </p>\n\n<p>I have a callback that takes type Res as a parameter. Initially I was under the impression that <code>type Res http.ResponseWriter</code> would simply mean that Res is an alias for http.ResponseWriter, as passing http.ResponseWriter into the callback with a Res param worked fine. </p>\n\n<p>I later decided I wanted to wrap my own functionality around the response provided to the callback, and so changed the <code>type Res http.ResponseWriter</code> to <code>type Res response.Response</code> - response being my own package (please look at what is commented out in the source below). After doing so I get <strong>\"Cannot use newResponse (type response.Response) as type Res in argument to urlCallback\"</strong> </p>\n\n<p>I looked at the http.ResponseWriter source code and noticed it is an interface whereas my response.Response is a struct, is this where the problem lies?</p>\n\n<p>Does setting a type as another type does not necessarily alias it? And if not, then why did passing in http.ResponseWriter for type Res work initially?</p>\n\n<pre><code>package Router\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"net/url\"\n    \"log\"\n    // \"./response\"\n)\n\n// type Res response.Response\ntype Res http.ResponseWriter\ntype Req *http.Request\n\ntype RouteMap map[string]func(Res, Req) \ntype MethodMap map[string]RouteMap\n\ntype Router struct {\n    Methods MethodMap\n}\n\nfunc (router *Router) Get(urlString string, callback func(Res, Req)) {\n    parsedUrl, err := url.Parse(urlString)\n\n    if(err != nil) {\n        panic(err)\n    }\n\n    router.Methods[\"GET\"][parsedUrl.Path] = callback\n}\n\nfunc (router *Router) initMaps() {\n    router.Methods = MethodMap{}\n    router.Methods[\"GET\"] = RouteMap{}\n}\n\nfunc (router Router) determineHandler(w http.ResponseWriter, r *http.Request) {\n    methodMap := router.Methods[r.Method]\n    urlCallback := methodMap[r.URL.Path]\n\n    // newResponse := response.NewResponse(w)\n\n    if(urlCallback != nil) {\n        // urlCallback(newResponse, r)\n        urlCallback(w, r)\n    }\n}\n\nfunc (router Router) Serve(host string, port string) {\n    fullHost := host + \":\" + port\n\n    fmt.Println(\"Router is now serving to:\" + fullHost)\n    http.HandleFunc(\"/\", router.determineHandler)\n\n    err := http.ListenAndServe(fullHost, nil)\n\n    if err == nil {\n        fmt.Println(\"Router is now serving to:\" + fullHost)\n    } else {\n        fmt.Println(\"An error occurred\")\n\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>The commented out code describes the issue im having/what im trying to do</p>\n"}, {"tags": ["regex", "go"], "answers": [{"comments": [{"owner": {"reputation": 6591, "user_id": 2185472, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/05ef4480505adfa05516719b865e22aa?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2185472/nick"}, "edited": false, "score": 0, "creation_date": 1420984950, "post_id": 27887361, "comment_id": 44176748, "body": "Thank you very much! +1 for your explanation on construct closure. Your code works well. I don&#39;t understand the  <code>if old != 1 {             return fmt.Sprintf(&quot;[%d] %s%d&quot;, old, match, old)         }</code> part. So I removed it, the code still works."}], "tags": [], "owner": {"reputation": 1903, "user_id": 1549474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2766dac2718e51b8c5f4f021c8e740c4?s=128&d=identicon&r=PG", "display_name": "tumdum", "link": "https://stackoverflow.com/users/1549474/tumdum"}, "is_accepted": true, "score": 0, "last_activity_date": 1420981745, "last_edit_date": 1420981745, "creation_date": 1420981327, "answer_id": 27887361, "question_id": 27887206, "link": "https://stackoverflow.com/questions/27887206/how-to-replace-occured-strings-with-a-counter-in-go-regexp/27887361#27887361", "title": "How to replace occured strings with a counter in Go regexp?", "body": "<p>You need to somehow share counter between successive calls to your function. One way to do this is to construct closure. You can do it this way:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n)\n\nfunc main() {\n    str := \"Let freedom ring from the mighty mountains of New York. Let freedom ring from the heightening Alleghenies of Pennsylvania. Let freedom ring from the snow-capped Rockies of Colorado. Let freedom ring from the curvaceous slopes of California.\"\n    counter := 1\n    repl := func(match string) string {\n        old := counter\n        counter++\n        if old != 1 {\n            return fmt.Sprintf(\"[%d] %s%d\", old, match, old)\n        }\n        return fmt.Sprintf(\"[%d] %s\", old, match)\n    }\n    re := regexp.MustCompile(\"Let freedom\")\n    str2 := re.ReplaceAllStringFunc(str, repl)\n    fmt.Println(str2)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1903, "user_id": 1549474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2766dac2718e51b8c5f4f021c8e740c4?s=128&d=identicon&r=PG", "display_name": "tumdum", "link": "https://stackoverflow.com/users/1549474/tumdum"}, "edited": false, "score": 0, "creation_date": 1420981605, "post_id": 27887365, "comment_id": 44175726, "body": "This will not compile."}, {"owner": {"reputation": 1903, "user_id": 1549474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2766dac2718e51b8c5f4f021c8e740c4?s=128&d=identicon&r=PG", "display_name": "tumdum", "link": "https://stackoverflow.com/users/1549474/tumdum"}, "edited": false, "score": 0, "creation_date": 1420981810, "post_id": 27887365, "comment_id": 44175789, "body": "If you are learning Go please first verify you answer before posting it. The reason for not compiling is that <code>&quot;[&quot;</code> is a string, <code>i</code> is int and there is no concatenation operator defined on those two types in Go."}, {"owner": {"reputation": 53706, "user_id": 3001736, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/j4wN2.jpg?s=128&g=1", "display_name": "Amit Joki", "link": "https://stackoverflow.com/users/3001736/amit-joki"}, "reply_to_user": {"reputation": 1903, "user_id": 1549474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2766dac2718e51b8c5f4f021c8e740c4?s=128&d=identicon&r=PG", "display_name": "tumdum", "link": "https://stackoverflow.com/users/1549474/tumdum"}, "edited": false, "score": 0, "creation_date": 1420982696, "post_id": 27887365, "comment_id": 44176074, "body": "@TomaszK\u0142ak if it&#39;s correct now, can you retract your vote. It will be fine if you didn&#39;t.. Just saying because now it&#39;s a correct answer but has a negative count."}], "tags": [], "owner": {"reputation": 53706, "user_id": 3001736, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/j4wN2.jpg?s=128&g=1", "display_name": "Amit Joki", "link": "https://stackoverflow.com/users/3001736/amit-joki"}, "is_accepted": false, "score": 2, "last_activity_date": 1420982069, "last_edit_date": 1420982069, "creation_date": 1420981343, "answer_id": 27887365, "question_id": 27887206, "link": "https://stackoverflow.com/questions/27887206/how-to-replace-occured-strings-with-a-counter-in-go-regexp/27887365#27887365", "title": "How to replace occured strings with a counter in Go regexp?", "body": "<p>You need something like this</p>\n\n<pre><code>r, i := regexp.MustCompile(\"Let freedom\"), 0\nr.ReplaceAllStringFunc(input, func(m string) string {\n   i += 1\n   if i == 1 {\n     return \"[1]\" + m \n   }\n   return fmt.Sprintf(\"[%d] %s%d\", i, m, i)\n})\n</code></pre>\n\n<p>Make sure you've imported required packages.. The above works by using <code>Let freedom</code> as the regex and then using some conditions to return what is intended.</p>\n"}], "owner": {"reputation": 6591, "user_id": 2185472, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/05ef4480505adfa05516719b865e22aa?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2185472/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 1, "accepted_answer_id": 27887361, "answer_count": 2, "score": 0, "last_activity_date": 1420982069, "creation_date": 1420980365, "question_id": 27887206, "link": "https://stackoverflow.com/questions/27887206/how-to-replace-occured-strings-with-a-counter-in-go-regexp", "title": "How to replace occured strings with a counter in Go regexp?", "body": "<p>For example, in this sentence, </p>\n\n<pre><code>Let freedom ring from the mighty mountains of New York. Let freedom ring from the heightening Alleghenies of Pennsylvania. Let freedom ring from the snow-capped Rockies of Colorado. Let freedom ring from the curvaceous slopes of California.\n</code></pre>\n\n<p>how to replace \"<strong>Let freedom</strong>\" with </p>\n\n<p>\"[1] Let freedom\", \n\"[2] Let freedom2\", and so on.</p>\n\n<p>I searched the Go regexp package, failed to find anything related increase counter. (Only find the <code>ReplaceAllStringFunc</code>, but I don't know how to use it.)</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 1, "creation_date": 1420965633, "post_id": 27885319, "comment_id": 44171921, "body": "Use single quotes <code>&#39;\\n&#39;</code> instead of double quotes <code>&quot;\\n&quot;</code> to denote a byte. Also your <code>Printf</code> should have a formatting string. See `<a href=\"http://play.golang.org/p/4DIjm6-N32\" rel=\"nofollow noreferrer\">play.golang.org/p/4DIjm6-N32</a>"}], "answers": [{"tags": [], "owner": {"reputation": 14609, "user_id": 667648, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/mTpbt.jpg?s=128&g=1", "display_name": "Dair", "link": "https://stackoverflow.com/users/667648/dair"}, "is_accepted": true, "score": 9, "last_activity_date": 1420965630, "creation_date": 1420965630, "answer_id": 27885352, "question_id": 27885319, "link": "https://stackoverflow.com/questions/27885319/text-processing-in-go-how-to-convert-string-to-byte/27885352#27885352", "title": "Text processing in Go - how to convert string to byte?", "body": "<p>Using <code>\"\\n\"</code> causes it to be treated as an array, use <code>'\\n'</code> to treat it as a single char.</p>\n"}, {"comments": [{"owner": {"reputation": 6591, "user_id": 2185472, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/05ef4480505adfa05516719b865e22aa?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2185472/nick"}, "edited": false, "score": 0, "creation_date": 1420985771, "post_id": 27886521, "comment_id": 44177025, "body": "Thank you for your explanation and remarks on Unicode consideration. I converted the byte to string using <code>s:=string(b)</code>, and solved the problem by using regular expression replacement."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 6591, "user_id": 2185472, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/05ef4480505adfa05516719b865e22aa?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2185472/nick"}, "edited": false, "score": 0, "creation_date": 1420989431, "post_id": 27886521, "comment_id": 44178117, "body": "@Nick You don&#39;t need to convert to <code>string</code>; just use <code>regexp.(*Regexp).ReplaceAllFunc()</code> instead of <code>regexp.(*Regexp).ReplaceAllStringFunc()</code>."}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": false, "score": 0, "last_activity_date": 1420975713, "creation_date": 1420975713, "answer_id": 27886521, "question_id": 27885319, "link": "https://stackoverflow.com/questions/27885319/text-processing-in-go-how-to-convert-string-to-byte/27886521#27886521", "title": "Text processing in Go - how to convert string to byte?", "body": "<p>A <code>string</code> cannot be converted into a <code>byte</code> in a meaningful way. Use one of the following approaches:</p>\n\n<ul>\n<li>If you have a string literal like <code>\"a\"</code>, consider using a <a href=\"http://golang.org/ref/spec#Rune_literals\" rel=\"nofollow\">rune literal</a> like <code>'a'</code> which can be converted into a <code>byte</code>.</li>\n<li>If you want to take a <code>byte</code> out of a <code>string</code>, use an <a href=\"http://golang.org/ref/spec#Index_expressions\" rel=\"nofollow\">index expression</a> like <code>myString[42]</code>.</li>\n<li>If you want to interpret the content of a <code>string</code> as a (decimal) number, use  <a href=\"http://golang.org/pkg/strconv/#Atoi\" rel=\"nofollow\"><code>strconv.Atoi()</code></a> or <a href=\"http://golang.org/pkg/strconv/#ParseInt\" rel=\"nofollow\"><code>strconv.ParseInt()</code></a>.</li>\n</ul>\n\n<p>Please notice that it is customary in Go to write programs that can deal with Unicode characters. Explaining how to do this would be too much for this answer, but there are tutorials out there which explain what kind of things to pay attention to.</p>\n"}], "owner": {"reputation": 6591, "user_id": 2185472, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/05ef4480505adfa05516719b865e22aa?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2185472/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4939, "favorite_count": 0, "accepted_answer_id": 27885352, "answer_count": 2, "score": 0, "last_activity_date": 1420986080, "creation_date": 1420965266, "last_edit_date": 1420986080, "question_id": 27885319, "link": "https://stackoverflow.com/questions/27885319/text-processing-in-go-how-to-convert-string-to-byte", "title": "Text processing in Go - how to convert string to byte?", "body": "<p>I'm writing a small pragram to number the paragraph:</p>\n\n<ol>\n<li>put paragraph number in front of each paragraph in the form of [1]..., [2]....</li>\n<li>Article title should be excluded.</li>\n</ol>\n\n<p>Here is my program:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n)\n\nvar s_end = [3]string{\".\", \"!\", \"?\"}\n\nfunc main() {\n    b, err := ioutil.ReadFile(\"i_have_a_dream.txt\")\n    if err != nil {\n        panic(err)\n    }\n\n    p_num, s_num := 1, 1\n\n    for _, char := range b {\n        fmt.Printf(\"[%s]\", p_num)\n        p_num += 1\n        if char == byte(\"\\n\") {\n            fmt.Printf(\"\\n[%s]\", p_num)\n            p_num += 1\n        } else {\n            fmt.Printf(char)\n        }\n    }\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/f4S3vQbglY\" rel=\"nofollow\">http://play.golang.org/p/f4S3vQbglY</a></p>\n\n<p>I got this error:</p>\n\n<pre><code>prog.go:21: cannot convert \"\\n\" to type byte\nprog.go:21: cannot convert \"\\n\" (type string) to type byte\nprog.go:21: invalid operation: char == \"\\n\" (mismatched types byte and string)\nprog.go:25: cannot use char (type byte) as type string in argument to fmt.Printf\n[process exited with non-zero status]\n</code></pre>\n\n<p>How to convert string to byte?</p>\n\n<p>What is the general practice to process text? Read in, parse it by byte, or by line?</p>\n\n<p><strong>Update</strong></p>\n\n<p>I solved the problem by converting the buffer byte to string, replacing strings by regular expression. (Thanks to @Tomasz K\u0142ak for the regexp help)</p>\n\n<p>I put the code here for reference.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"regexp\"\n)\n\n\nfunc main() {\n    b, err := ioutil.ReadFile(\"i_have_a_dream.txt\")\n    if err != nil {\n        panic(err)\n    }\n\n    s := string(b)\n    r := regexp.MustCompile(\"(\\r\\n)+\")\n    counter := 1\n\n    repl := func(match string) string {\n        p_num := counter\n        counter++\n        return fmt.Sprintf(\"%s [%d] \", match, p_num)\n    }\n\n    fmt.Println(r.ReplaceAllStringFunc(s, repl))\n}\n</code></pre>\n"}, {"tags": ["image", "go"], "comments": [{"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1420940017, "post_id": 27882500, "comment_id": 44167942, "body": "Can&#39;t you use same text layer as Src and also as mask to draw.Over?"}, {"owner": {"reputation": 1438, "user_id": 218226, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/acc5f791765003d2a1cf6b1b9fdea156?s=128&d=identicon&r=PG", "display_name": "prewett", "link": "https://stackoverflow.com/users/218226/prewett"}, "reply_to_user": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1420942284, "post_id": 27882500, "comment_id": 44168328, "body": "Hmm, that seems be what I need.  I thought the mask had to be only one channel, but I guess not."}], "owner": {"reputation": 1438, "user_id": 218226, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/acc5f791765003d2a1cf6b1b9fdea156?s=128&d=identicon&r=PG", "display_name": "prewett", "link": "https://stackoverflow.com/users/218226/prewett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 303, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1420934420, "creation_date": 1420934420, "question_id": 27882500, "link": "https://stackoverflow.com/questions/27882500/how-do-i-alpha-blend-two-images-in-go", "title": "How do I alpha blend two images in Go?", "body": "<p>I have two image.RGBA objects:  the background and the text layer.  The text layer will be anti-aliased, and may have text in different colors.  What I want is:</p>\n\n<pre><code>draw.Draw(bgLayer, bgLayer.Bounds(), textLayer, image.ZP, draw.OneMinusSrcAlpha)\n</code></pre>\n\n<p>Unfortunately, this is not an option.  draw.Src obviously just overwrites the pixel.  draw.Over is the same as draw.Src when the alpha channel is 255.  When it is &lt; 255, then the pixel acts as (0, 0, 0, alpha), so the color information disappears.  It looks like they want me to use a mask, which means I'd have to create another image, and do the math on all the pixels myself;  in that case, I might as well just write my own Draw function that does what I want.</p>\n\n<p>I assume I'm missing something obvious, but I haven't found it in either the documentation or on Google yet.</p>\n"}, {"tags": ["logging", "module", "go", "gcloud"], "owner": {"reputation": 551, "user_id": 1296559, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b830c4f4d495b0c943afb87827bb77c8?s=128&d=identicon&r=PG", "display_name": "Defcronyke", "link": "https://stackoverflow.com/users/1296559/defcronyke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 365, "favorite_count": 3, "answer_count": 0, "score": 2, "last_activity_date": 1420930801, "creation_date": 1420930801, "question_id": 27882068, "link": "https://stackoverflow.com/questions/27882068/managed-vm-modules-enable-mvm-logs-causes-crash", "title": "Managed VM Modules --enable-mvm-logs causes crash", "body": "<p>I would like to view logs for one of my Managed VM Modules in the Google Cloud Platform during development (before deploying), and I noticed this command should allow it:</p>\n\n<pre><code>gcloud preview app run --enable-mvm-logs &lt;module name&gt;\n</code></pre>\n\n<p>However, adding that switch to the usual run command causes the module to crash during load:</p>\n\n<pre><code>INFO: Go VM Deployment process failed: [Errno 104] Connection reset by peer\nERROR: Internal error while starting instance.\nTraceback (most recent call last):\n  File \"/home/bakeonandham/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/module.py\", line 1823, in _start_instance\n    if not inst.start():\n  File \"/home/bakeonandham/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/instance.py\", line 274, in start\n    self._runtime_proxy.start()\n  File \"/home/bakeonandham/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/vm_runtime_proxy_go.py\", line 130, in start\n    self._vm_runtime_proxy.start(dockerfile_dir=dst_deployment_dir)\n  File \"/home/bakeonandham/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/vm_runtime_proxy.py\", line 196, in start\n    self._module_configuration.major_version, runtime_config.instance_id)\n  File \"/home/bakeonandham/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/log_manager.py\", line 172, in add\n    _create_table(l)\n  File \"/home/bakeonandham/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/log_manager.py\", line 138, in _create_table\n    response = conn.getresponse()\n  File \"/usr/lib/python2.7/httplib.py\", line 1073, in getresponse\n    response.begin()\n  File \"/usr/lib/python2.7/httplib.py\", line 415, in begin\n    version, status, reason = self._read_status()\n  File \"/usr/lib/python2.7/httplib.py\", line 371, in _read_status\n    line = self.fp.readline(_MAXLINE + 1)\n  File \"/usr/lib/python2.7/socket.py\", line 476, in readline\n    data = self._sock.recv(self._rbufsize)\nerror: [Errno 104] Connection reset by peer\n</code></pre>\n\n<p>Without the switch, my app runs and deploys fine, and once deployed, the data i'm logging is available in the Dev console.</p>\n\n<p>I did find a way to view logs during development in the terminal where I launched the dev server from, though it's not ideal:</p>\n\n<p>If I use the --verbosity debug flag my output shows up, but only with loglevel debug even though my logged stuff are being logged as Errors. Any other verbosity level doesn't show the output at all.</p>\n\n<p>I am using the Go runtime by the way.</p>\n\n<p>So to summarize, the only way I can seem to view logs using the local dev server environment for Managed VM, is to launch using this command:</p>\n\n<pre><code>gcloud --verbosity debug preview app run &lt;module name&gt;\n</code></pre>\n\n<p>Even though I log with loglevel Error, if I set --verbosity error, the output never shows in the terminal or anywhere else.</p>\n\n<p>Has anyone been able to get the --enable-mvm-logs switch to work, or is it broken? Any ideas on a better way to view Managed VM log output?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 1, "creation_date": 1421054872, "post_id": 27880988, "comment_id": 44197508, "body": "To moderators incorrectly voting to close this question: this has nothing to do with &quot;opinion based&quot;: this is a very important question asking for the origin of a fundamental language design issue. Read my answer: there is no opinion there."}], "answers": [{"comments": [{"owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "edited": false, "score": 0, "creation_date": 1420923035, "post_id": 27881059, "comment_id": 44163742, "body": "But you&#39;re never supposed to use panic except for really exceptional situations, right? So if I need to handle an error, I just handle the <code>err</code>. If my program panics, I just want it to crash, or to print it to some log. If it took a vararg you could still just look at the first item in the slice, and your use-case would be covered, easily. Passing an error code and the struct that caused it seems like a good use of multiple arguments."}, {"owner": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "reply_to_user": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "edited": false, "score": 0, "creation_date": 1420923683, "post_id": 27881059, "comment_id": 44163938, "body": "@FilipHaglund I updated the answer with an example how panic is used internally for json decoding."}, {"owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "edited": false, "score": 0, "creation_date": 1420927892, "post_id": 27881059, "comment_id": 44165105, "body": "Yes, I&#39;ve read that. That&#39;s one use, but that isn&#39;t the general use for panic, or is it? Unwinding the stack would be done with <code>if err != nil</code> fairly quickly as well, right?"}], "tags": [], "owner": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "is_accepted": false, "score": 2, "last_activity_date": 1420923497, "last_edit_date": 1420923497, "creation_date": 1420922861, "answer_id": 27881059, "question_id": 27880988, "link": "https://stackoverflow.com/questions/27880988/why-does-go-panic-take-interface-instead-of-interface-as-argument/27881059#27881059", "title": "Why does Go panic() take interface{} instead of ...interface{} as argument?", "body": "<p>Because the value you pass to <code>panic</code> is a value you want to panic with and can be retrieved using <code>recover</code>. Having multiple panic values doesn't really make sense.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    defer func() {\n        if v := recover(); v != nil {\n            fmt.Println(v.(int))\n        }\n    }()\n    panic(3)\n}\n</code></pre>\n\n<p>Example on using recover values:</p>\n\n<blockquote>\n  <p>For a real-world example of panic and recover, see the json package\n  from the Go standard library. It decodes JSON-encoded data with a set\n  of recursive functions. When malformed JSON is encountered, the parser\n  calls panic to unwind the stack to the top-level function call, which\n  recovers from the panic and returns an appropriate error value (see\n  the 'error' and 'unmarshal' methods of the decodeState type in\n  decode.go).</p>\n</blockquote>\n\n<p>Source: <a href=\"http://blog.golang.org/defer-panic-and-recover\" rel=\"nofollow\">http://blog.golang.org/defer-panic-and-recover</a></p>\n"}, {"comments": [{"owner": {"reputation": 707, "user_id": 721861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784046b1b72d7969ae850ea7c8b46cba?s=128&d=identicon&r=PG", "display_name": "krait", "link": "https://stackoverflow.com/users/721861/krait"}, "edited": false, "score": 0, "creation_date": 1420948275, "post_id": 27881416, "comment_id": 44169292, "body": "Furthermore, if panic were variadic, as a convenience for something like <code>errors.New(fmt.Sprint(...args))</code> it would encourage use of panic, when in reality, use of panic as a control-flow mechanism is discouraged, and should rarely, if ever, cross package boundaries. When such panics do occur, they should be clearly documented in the package documentation for each function where they occur."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 4, "last_activity_date": 1420925986, "last_edit_date": 1592644375, "creation_date": 1420925481, "answer_id": 27881416, "question_id": 27880988, "link": "https://stackoverflow.com/questions/27880988/why-does-go-panic-take-interface-instead-of-interface-as-argument/27881416#27881416", "title": "Why does Go panic() take interface{} instead of ...interface{} as argument?", "body": "<p><code>panic</code> didn't take just one argument at first.<br />\nYou can trace back the one argument implementation back to 30th March 2010:<br />\n<a href=\"https://github.com/golang/go/commit/01eaf780a8d09ce0b41526fa2701cfbba80f2b8b\" rel=\"nofollow noreferrer\">commit 01eaf78</a> gc: add <code>panic</code> and <code>recover</code> (still unimplemented in runtime)</p>\n<blockquote>\n<p>main semantic change is to enforce single argument to panic.</p>\n</blockquote>\n<p>The spec is fixed in <a href=\"https://github.com/golang/go/commit/5bb29fb1160ed9c727a2b83aa9cf7c082ac5de26\" rel=\"nofollow noreferrer\">commit 5bb29fb</a>, and <a href=\"https://github.com/golang/go/commit/00f9f0c0560ce35b9d006eacbeeacf897d19a2bf\" rel=\"nofollow noreferrer\">commit 00f9f0c</a> illustrates how panic could took before multiple arguments:</p>\n<pre><code>src/pkg/bufio/bufio.go\n\nb, err := NewWriterSize(wr, defaultBufSize)\nif err != nil {\n    // cannot happen - defaultBufSize is valid size\n    - panic(&quot;bufio: NewWriter: &quot;, err.String())\n    + panic(err)\n}\n</code></pre>\n<hr />\n<p>That follows a <a href=\"https://groups.google.com/forum/#!search/golang$20single$20argument$20panic/golang-nuts/HOXNBQu5c-Q/Je0qo1hbxIsJ\" rel=\"nofollow noreferrer\">proposal from March 25th, 2010</a>:</p>\n<blockquote>\n<p>We don't want to encourage the conflation of errors and exceptions that occur in languages such as Java.</p>\n<p>Instead, this proposal uses a slight change to the definition of defer and a couple of runtime functions to provide a clean mechanism for handling truly exceptional conditions.</p>\n<p>During panicking, if a deferred function invocation calls recover, recover returns the value passed to panic and stops the panicking.<br />\nAt any other time, or inside functions called by the deferred call, recover returns nil.<br />\nAfter stopping the panicking, a deferred call can panic with a new argument, or the same one, to continue panicking.<br />\nAlternately, the deferred call might edit the return values for its outer function, perhaps returning an error.</p>\n</blockquote>\n<p>In those various scenario, dealing with one value to pass around seems easier than dealing with an variable number of arguments (especially when it comes to <a href=\"https://github.com/golang/go/commit/9b1507b05098b95639d6d4905534426193f75f15#diff-65826dc18b9f9dd9a72750dfc95f269eR986\" rel=\"nofollow noreferrer\">implement <code>recover</code> in C</a>).</p>\n"}], "owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 1, "accepted_answer_id": 27881416, "answer_count": 2, "score": 0, "last_activity_date": 1420925986, "creation_date": 1420922361, "question_id": 27880988, "link": "https://stackoverflow.com/questions/27880988/why-does-go-panic-take-interface-instead-of-interface-as-argument", "title": "Why does Go panic() take interface{} instead of ...interface{} as argument?", "body": "<p>I noticed <code>panic</code> takes <code>interface{}</code> as an argument, while <code>fmt.Print</code> and the likes take <code>...interface{}</code>. Wouldn't it be more convenient if <code>panic</code> took <code>...interface{}</code> as well?</p>\n\n<p>Why did the Go authors define <code>panic</code> as <code>func panic(v interface{})</code> rather than <code>func panic(v ...interface{})</code> (like they did with <code>fmt</code>)?</p>\n"}, {"tags": ["testing", "ssl", "go"], "comments": [{"owner": {"reputation": 707, "user_id": 721861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784046b1b72d7969ae850ea7c8b46cba?s=128&d=identicon&r=PG", "display_name": "krait", "link": "https://stackoverflow.com/users/721861/krait"}, "edited": false, "score": 0, "creation_date": 1420950004, "post_id": 27880930, "comment_id": 44169546, "body": "Do you really need to mock a TLS request? net/http has extensive tests, so testing against a local HTTPS-hosted test implementation is rather redundant. Testing against HTTP directly is semantically equivalent."}, {"owner": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "reply_to_user": {"reputation": 707, "user_id": 721861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784046b1b72d7969ae850ea7c8b46cba?s=128&d=identicon&r=PG", "display_name": "krait", "link": "https://stackoverflow.com/users/721861/krait"}, "edited": false, "score": 0, "creation_date": 1420980615, "post_id": 27880930, "comment_id": 44175426, "body": "No. In fact I&#39;m mocking against HTTP right now.  I just dont like the workaround I have to use to force HTTP. Something is automatically trying to use TLS because the request URL starts with https. I would love to disable this behavior just for my tests."}, {"owner": {"reputation": 707, "user_id": 721861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784046b1b72d7969ae850ea7c8b46cba?s=128&d=identicon&r=PG", "display_name": "krait", "link": "https://stackoverflow.com/users/721861/krait"}, "edited": false, "score": 1, "creation_date": 1421006499, "post_id": 27880930, "comment_id": 44183890, "body": "Okay, in that case you can create an implementation of an http.RoundTripper that does whatever you want (such as treats https:// as if it&#39;s an http url) -- you can even use a custom RoundTripper to just run a mock http.Handler directly, without having to go through httptest.Server. All you have to do then is <code>http.DefaultClient.Transport = CustomRoundTripper</code>."}, {"owner": {"reputation": 707, "user_id": 721861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784046b1b72d7969ae850ea7c8b46cba?s=128&d=identicon&r=PG", "display_name": "krait", "link": "https://stackoverflow.com/users/721861/krait"}, "edited": false, "score": 0, "creation_date": 1421006552, "post_id": 27880930, "comment_id": 44183899, "body": "Alternatively, you can use <a href=\"http://golang.org/pkg/net/http/httptest/#NewTLSServer\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/httptest/#NewTLSServer</a>"}, {"owner": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "reply_to_user": {"reputation": 707, "user_id": 721861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784046b1b72d7969ae850ea7c8b46cba?s=128&d=identicon&r=PG", "display_name": "krait", "link": "https://stackoverflow.com/users/721861/krait"}, "edited": false, "score": 0, "creation_date": 1421009224, "post_id": 27880930, "comment_id": 44184869, "body": "The custom <code>http.RoundTripper</code> works like a charm.  You should convert your comment to an answer so I can accept it."}, {"owner": {"reputation": 1059, "user_id": 2304441, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/n2dEA.jpg?s=128&g=1", "display_name": "benbot", "link": "https://stackoverflow.com/users/2304441/benbot"}, "edited": false, "score": 0, "creation_date": 1459706294, "post_id": 27880930, "comment_id": 60394683, "body": "Were you ever able to figure out why you were getting oversized records back with <code>NewTLSServer</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 707, "user_id": 721861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784046b1b72d7969ae850ea7c8b46cba?s=128&d=identicon&r=PG", "display_name": "krait", "link": "https://stackoverflow.com/users/721861/krait"}, "is_accepted": true, "score": 14, "last_activity_date": 1421033077, "creation_date": 1421033077, "answer_id": 27894872, "question_id": 27880930, "link": "https://stackoverflow.com/questions/27880930/mocking-https-responses-in-go/27894872#27894872", "title": "Mocking HTTPS responses in Go", "body": "<p>Most of the behavior in <code>net/http</code> can be mocked, extended, or altered. Although <a href=\"http://golang.org/pkg/net/http/#Client\" rel=\"noreferrer\"><code>http.Client</code></a> is a concrete type that implements HTTP client semantics, all of its fields are exported and may be customized.</p>\n\n<p>The <a href=\"http://golang.org/pkg/net/http/#Client\" rel=\"noreferrer\"><code>Client.Transport</code></a> field, in particular, may be replaced to make the Client do anything from using custom protocols (such as ftp:// or file://) to connecting directly to local handlers (without generating HTTP protocol bytes or sending anything over the network).</p>\n\n<p>The client functions, such as <a href=\"http://golang.org/pkg/net/http/#Get\" rel=\"noreferrer\"><code>http.Get</code></a>, all utilize the exported <code>http.DefaultClient</code> package variable (which you may modify), so code that utilizes these convenience functions does <em>not</em>, for example, have to be changed to call methods on a custom Client variable. Note that while it would be unreasonable to modify global behavior in a publicly-available library, it's very useful to do so in applications and tests (including library tests).</p>\n\n<p><a href=\"http://play.golang.org/p/afljO086iB\" rel=\"noreferrer\">http://play.golang.org/p/afljO086iB</a> contains a custom <code>http.RoundTripper</code> that rewrites the request URL so that it'll be routed to a locally hosted <code>httptest.Server</code>, and another example that directly passes the request to an <code>http.Handler</code>, along with a custom <code>http.ResponseWriter</code> implementation, in order to create an <code>http.Response</code>. The second approach isn't as diligent as the first (it doesn't fill out as many fields in the Response value) but is more efficient, and should be compatible enough to work with most handlers and client callers.</p>\n\n<p>The above-linked code is included below as well:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io\"\n    \"log\"\n    \"net/http\"\n    \"net/http/httptest\"\n    \"net/url\"\n    \"os\"\n    \"path\"\n    \"strings\"\n)\n\nfunc Handler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"hello %s\\n\", path.Base(r.URL.Path))\n}\n\nfunc main() {\n    s := httptest.NewServer(http.HandlerFunc(Handler))\n    u, err := url.Parse(s.URL)\n    if err != nil {\n        log.Fatalln(\"failed to parse httptest.Server URL:\", err)\n    }\n    http.DefaultClient.Transport = RewriteTransport{URL: u}\n    resp, err := http.Get(\"https://google.com/path-one\")\n    if err != nil {\n        log.Fatalln(\"failed to send first request:\", err)\n    }\n    fmt.Println(\"[First Response]\")\n    resp.Write(os.Stdout)\n\n    fmt.Print(\"\\n\", strings.Repeat(\"-\", 80), \"\\n\\n\")\n\n    http.DefaultClient.Transport = HandlerTransport{http.HandlerFunc(Handler)}\n    resp, err = http.Get(\"https://google.com/path-two\")\n    if err != nil {\n        log.Fatalln(\"failed to send second request:\", err)\n    }\n    fmt.Println(\"[Second Response]\")\n    resp.Write(os.Stdout)\n}\n\n// RewriteTransport is an http.RoundTripper that rewrites requests\n// using the provided URL's Scheme and Host, and its Path as a prefix.\n// The Opaque field is untouched.\n// If Transport is nil, http.DefaultTransport is used\ntype RewriteTransport struct {\n    Transport http.RoundTripper\n    URL       *url.URL\n}\n\nfunc (t RewriteTransport) RoundTrip(req *http.Request) (*http.Response, error) {\n    // note that url.URL.ResolveReference doesn't work here\n    // since t.u is an absolute url\n    req.URL.Scheme = t.URL.Scheme\n    req.URL.Host = t.URL.Host\n    req.URL.Path = path.Join(t.URL.Path, req.URL.Path)\n    rt := t.Transport\n    if rt == nil {\n        rt = http.DefaultTransport\n    }\n    return rt.RoundTrip(req)\n}\n\ntype HandlerTransport struct{ h http.Handler }\n\nfunc (t HandlerTransport) RoundTrip(req *http.Request) (*http.Response, error) {\n    r, w := io.Pipe()\n    resp := &amp;http.Response{\n        Proto:      \"HTTP/1.1\",\n        ProtoMajor: 1,\n        ProtoMinor: 1,\n        Header:     make(http.Header),\n        Body:       r,\n        Request:    req,\n    }\n    ready := make(chan struct{})\n    prw := &amp;pipeResponseWriter{r, w, resp, ready}\n    go func() {\n        defer w.Close()\n        t.h.ServeHTTP(prw, req)\n    }()\n    &lt;-ready\n    return resp, nil\n}\n\ntype pipeResponseWriter struct {\n    r     *io.PipeReader\n    w     *io.PipeWriter\n    resp  *http.Response\n    ready chan&lt;- struct{}\n}\n\nfunc (w *pipeResponseWriter) Header() http.Header {\n    return w.resp.Header\n}\n\nfunc (w *pipeResponseWriter) Write(p []byte) (int, error) {\n    if w.ready != nil {\n        w.WriteHeader(http.StatusOK)\n    }\n    return w.w.Write(p)\n}\n\nfunc (w *pipeResponseWriter) WriteHeader(status int) {\n    if w.ready == nil {\n        // already called\n        return\n    }\n    w.resp.StatusCode = status\n    w.resp.Status = fmt.Sprintf(\"%d %s\", status, http.StatusText(status))\n    close(w.ready)\n    w.ready = nil\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6856, "user_id": 25411, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/23654c71d18aab6eb0da8ca1d27377d0?s=128&d=identicon&r=PG", "display_name": "null", "link": "https://stackoverflow.com/users/25411/null"}, "is_accepted": false, "score": 2, "last_activity_date": 1470614560, "last_edit_date": 1470614560, "creation_date": 1470613925, "answer_id": 38819628, "question_id": 27880930, "link": "https://stackoverflow.com/questions/27880930/mocking-https-responses-in-go/38819628#38819628", "title": "Mocking HTTPS responses in Go", "body": "<p>The reason you're getting the error <code>http: TLS handshake error from 127.0.0.1:45678: tls: oversized record received with length 20037</code> is because https requires a domain name (not an IP Address). Domain names are SSL certificates are assigned to.</p>\n\n<p>Start the httptest server in TLS mode with your own certs</p>\n\n<pre><code>cert, err := tls.LoadX509KeyPair(\"cert.pem\", \"key.pem\")\nif err != nil {\n    log.Panic(\"bad server certs: \", err)\n}\ncerts := []tls.Certificate{cert}\n\nserver = httptest.NewUnstartedServer(router)\nserver.TLS = &amp;tls.Config{Certificates: certs}\nserver.StartTLS()\nserverPort = \":\" + strings.Split(server.URL, \":\")[2] // it's always https://127.0.0.1:&lt;port&gt;\nserver.URL = \"https://sub.domain.com\" + serverPort\n</code></pre>\n\n<p>To provide a valid SSL certificate for a connection are the options of:</p>\n\n<ol>\n<li>Not supplying a cert and key</li>\n<li>Supplying a self-signed cert and key</li>\n<li>Supplying a real valid cert and key</li>\n</ol>\n\n<h2>No Cert</h2>\n\n<p>If you don't supply your own cert, then an <code>example.com</code> cert is loaded as default. </p>\n\n<h2>Self-Signed Cert</h2>\n\n<p>To create a testing cert can use the included self-signed cert generator at <code>$GOROOT/src/crypto/tls/generate_cert.go --host \"*.domain.name\"</code></p>\n\n<p>You'll get <code>x509: certificate signed by unknown authority</code> warnings because it's self-signed so you'll need to have your client skip those warnings, by adding the following to your http.Transport field:</p>\n\n<pre><code> TLSClientConfig: &amp;tls.Config{InsecureSkipVerify: true}\n</code></pre>\n\n<h2>Valid Real Cert</h2>\n\n<p>Finally, if you're going to use a real cert, then save the valid cert and key where they can be loaded.</p>\n\n<hr>\n\n<p>The key here is to use <code>server.URL = https://sub.domain.com</code> to supply your own domain.</p>\n"}], "owner": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7440, "favorite_count": 4, "accepted_answer_id": 27894872, "answer_count": 2, "score": 6, "last_activity_date": 1470614560, "creation_date": 1420921937, "question_id": 27880930, "link": "https://stackoverflow.com/questions/27880930/mocking-https-responses-in-go", "title": "Mocking HTTPS responses in Go", "body": "<p>I'm trying to write tests for a package that makes requests to a web service.  I'm running into issues probably due to my lack of understanding of TLS.</p>\n\n<p>Currently my test looks something like this:</p>\n\n<pre><code>func TestSimple() {\n    server := httptest.NewServer(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        w.Header().Set(\"Content-Type\", \"application/json\")\n        w.WriteHeader(200)\n        fmt.Fprintf(w, `{ \"fake\" : \"json data here\" }`)\n    }))\n    transport := &amp;http.Transport{\n        Proxy: func(req *http.Request) (*url.URL, error) {\n            return url.Parse(server.URL)\n        },\n    }\n    // Client is the type in my package that makes requests\n    client := Client{\n        c: http.Client{Transport: transport},\n    }\n\n    client.DoRequest() // ...\n}\n</code></pre>\n\n<p>My package has a package variable (I'd like for it to be a constant..) for the base address of the web service to query.  It is an https URL.  The test server I created above is plain HTTP, no TLS.  </p>\n\n<p>By default, my test fails with the error \"tls: first record does not look like a TLS handshake.\"</p>\n\n<p>To get this to work, my tests change the package variable to a plain http URL instead of https before making the query.</p>\n\n<p>Is there any way around this?  Can I make the package variable a constant (https), and either set up a <code>http.Transport</code> that \"downgrades\" to unencrypted HTTP, or use <code>httptest.NewTLSServer()</code> instead?  </p>\n\n<p>(When I try to use <code>NewTLSServer()</code> I get \"http: TLS handshake error from 127.0.0.1:45678: tls: oversized record received with length 20037\")</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 62894, "user_id": 1114486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0513d720af96f4496f4b869fe9579a?s=128&d=identicon&r=PG", "display_name": "Didier Spezia", "link": "https://stackoverflow.com/users/1114486/didier-spezia"}, "is_accepted": true, "score": 0, "last_activity_date": 1420921173, "last_edit_date": 1420921173, "creation_date": 1420920808, "answer_id": 27880758, "question_id": 27878003, "link": "https://stackoverflow.com/questions/27878003/scanning-precise-number-of-characters/27880758#27880758", "title": "scanning precise number of characters", "body": "<p>I think it cannot be done with fmt.Sscanf.</p>\n\n<p>But what about using strconv instead?</p>\n\n<p>Here is an example:</p>\n\n<pre><code>package main\n\nimport (\n    \"strconv\"\n    \"fmt\"\n)\n\n// parse reads a uint8 from s on exactly size digits in base 16\nfunc parse( s string, size int ) (uint8, error) {\n    if len(s) != size {\n        return 0, strconv.ErrSyntax\n    }\n    n,err := strconv.ParseUint(s,16,8)\n    return uint8(n),err\n}\n\nfunc main() {\n    for _,x := range []string{ \"ff\", \"f\", \"\", \"f!\", \"12\", \"00\", \"fff\" } {\n        if v,e := parse(x,2); e == nil {\n            fmt.Println(\"ok:\",v)\n        } else {\n            fmt.Println(\"ko:\",e)\n        }\n    }   \n}\n</code></pre>\n\n<p>In playground: <a href=\"https://play.golang.org/p/PRkX0Wztz7\" rel=\"nofollow\">https://play.golang.org/p/PRkX0Wztz7</a></p>\n"}], "owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 27880758, "answer_count": 1, "score": 1, "last_activity_date": 1420921173, "creation_date": 1420904713, "last_edit_date": 1420905300, "question_id": 27878003, "link": "https://stackoverflow.com/questions/27878003/scanning-precise-number-of-characters", "title": "scanning precise number of characters", "body": "<p>The code below prints <code>15</code> because it scans at most 2 characters in the input. Is it possible to make it fail if it does not scan successfully exactly 2 characters?</p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n    \"log\"\n)\n\nfunc main() {\n    var v uint8\n    n, e := fmt.Sscanf(\"f!\", \"%02x\", &amp;v)\n    if e != nil {\n        log.Fatal(e)\n    }\n    if n != 1 {\n        log.Fatal(errors.New(\"error\"))\n    }\n    fmt.Println(v)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Wl3QyjS8YS\" rel=\"nofollow\">https://play.golang.org/p/Wl3QyjS8YS</a></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "edited": false, "score": 0, "creation_date": 1420900584, "post_id": 27877308, "comment_id": 44156118, "body": "I&#39;ve already set it as you suggested above, but it didn&#39;t work. Only when I remove -u it manages to install."}, {"owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "edited": false, "score": 0, "creation_date": 1420900786, "post_id": 27877308, "comment_id": 44156197, "body": "Ahh, my bad. I had assumed I needed -u to be able to run the command-line program, it works."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 0, "last_activity_date": 1420900785, "last_edit_date": 1495539816, "creation_date": 1420900378, "answer_id": 27877308, "question_id": 27877289, "link": "https://stackoverflow.com/questions/27877289/go-install-package-with-u-command/27877308#27877308", "title": "Go: Install package with -u command", "body": "<p>It depends on your OS, but make sure your <code>GOPATH</code> is set in your <code>.bashrc</code> (as <a href=\"https://stackoverflow.com/a/21012349/6309\">in this question</a>) or least set with</p>\n\n<pre><code>export GOPATH=/home/&lt;username&gt;/go\n</code></pre>\n\n<p>That way, other processes (like <code>go get</code>) will inherit that variable.</p>\n\n<p>On Windows, you would declare that variable in your user environment variables.</p>\n\n<p>To check what is already set (\"<a href=\"https://golang.org/pkg/cmd/go/#hdr-Print_Go_environment_information\" rel=\"nofollow noreferrer\">Print Go environment information</a>\"):</p>\n\n<pre><code>go env\n</code></pre>\n\n<hr>\n\n<p>If the variable is already set, but a go get -u still fails, then this could be similar to <a href=\"https://github.com/joefitzgerald/go-plus/issues/42#issuecomment-53274228\" rel=\"nofollow noreferrer\">issue 42</a>:</p>\n\n<blockquote>\n  <p>Your issue is that you have installed go to a location that requires privilege escalation to install to. </p>\n</blockquote>\n\n<p>Check also your <a href=\"https://github.com/joefitzgerald/go-plus/issues/42#issuecomment-53290423\" rel=\"nofollow noreferrer\"><code>GOROOT</code> and where go is installed</a>.</p>\n"}], "owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 785, "favorite_count": 1, "accepted_answer_id": 27877308, "answer_count": 1, "score": 0, "last_activity_date": 1420900785, "creation_date": 1420900239, "question_id": 27877289, "link": "https://stackoverflow.com/questions/27877289/go-install-package-with-u-command", "title": "Go: Install package with -u command", "body": "<p>I'm trying to install a Go package (<a href=\"https://github.com/jteeuwen/go-bindata#installation\" rel=\"nofollow\">https://github.com/jteeuwen/go-bindata#installation</a>) by running this command</p>\n\n<pre><code>go get -u github.com/jteeuwen/go-bindata/...\n</code></pre>\n\n<p>I get this error: </p>\n\n<pre><code>package github.com/jteeuwen/go-bindata/...: cannot download, $GOPATH not set. For more details see: go help gopath\n</code></pre>\n\n<p>My GOPATH is set in the ordinary way. I understand this is caused by the -u command... how do I resolve this?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 714, "user_id": 1366283, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/93f9b66f8fbbc083e0b3a788ab63ee52?s=128&d=identicon&r=PG", "display_name": "soroushjp", "link": "https://stackoverflow.com/users/1366283/soroushjp"}, "is_accepted": true, "score": 1, "last_activity_date": 1420900108, "creation_date": 1420900108, "answer_id": 27877269, "question_id": 27877268, "link": "https://stackoverflow.com/questions/27877268/what-are-the-zero-values-default-values-without-explicit-initialization-for-di/27877269#27877269", "title": "What are the zero values (default values without explicit initialization) for different Go types?", "body": "<ul>\n<li>Booleans: <em>false</em> </li>\n<li>Integers: 0 </li>\n<li>Floats: 0.0</li>\n<li>Strings: \"\"</li>\n<li>Pointers: nil</li>\n<li>Functions: nil</li>\n<li>Interfaces: nil</li>\n<li>Slices: nil</li>\n<li>Channels: nil</li>\n<li>Maps: nil</li>\n</ul>\n\n<p>This is done recursively, so arrays and structs (and arrays of structs etc.) will have their uninitialized values set to the zero values described above.</p>\n\n<p>This also applies when using <em>new</em> and <em>make</em> to allocate storage for variables.</p>\n\n<p>Source: <a href=\"http://golang.org/ref/spec#The_zero_value\" rel=\"nofollow\">http://golang.org/ref/spec#The_zero_value</a></p>\n"}], "owner": {"reputation": 714, "user_id": 1366283, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/93f9b66f8fbbc083e0b3a788ab63ee52?s=128&d=identicon&r=PG", "display_name": "soroushjp", "link": "https://stackoverflow.com/users/1366283/soroushjp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 27877269, "answer_count": 1, "score": -2, "last_activity_date": 1420900108, "creation_date": 1420900108, "question_id": 27877268, "link": "https://stackoverflow.com/questions/27877268/what-are-the-zero-values-default-values-without-explicit-initialization-for-di", "title": "What are the zero values (default values without explicit initialization) for different Go types?", "body": "<p>Go gives default values, or <em>zero values</em>, for variables that are declared without an explicit initialization. What are the different zero values for builtin types?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1420893562, "post_id": 27875601, "comment_id": 44154009, "body": "I would not use <code>append()</code> here; the length of the array is known and we can just allocate it."}, {"owner": {"reputation": 1903, "user_id": 1549474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2766dac2718e51b8c5f4f021c8e740c4?s=128&d=identicon&r=PG", "display_name": "tumdum", "link": "https://stackoverflow.com/users/1549474/tumdum"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1420894248, "post_id": 27875601, "comment_id": 44154194, "body": "Array size is know iff failed float parsing should &#39;abort&#39; loop... I really don&#39;t like that you have changed the meaning of my code with your edit :/"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1420895133, "post_id": 27875601, "comment_id": 44154424, "body": "Please undo my edit if you do not like it. It&#39;s okay."}, {"owner": {"reputation": 6591, "user_id": 2185472, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/05ef4480505adfa05516719b865e22aa?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2185472/nick"}, "edited": false, "score": 0, "creation_date": 1420936316, "post_id": 27875601, "comment_id": 44167181, "body": "Thank you very much. 1. <code>for</code> iterates over a slice is really simple yet useful. I guess this is the counterpart of <code>map</code> in a functional language. 2. <code>strconv.ParseFloat</code> not only convert the string to float, it also handles the separators - a mix use of comma and space, even irrelevant chars - <code>strconv</code> just done right. It&#39;s amazing! <code>Go</code> is simple and powerful."}], "tags": [], "owner": {"reputation": 1903, "user_id": 1549474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2766dac2718e51b8c5f4f021c8e740c4?s=128&d=identicon&r=PG", "display_name": "tumdum", "link": "https://stackoverflow.com/users/1549474/tumdum"}, "is_accepted": true, "score": 8, "last_activity_date": 1420894883, "last_edit_date": 1420894883, "creation_date": 1420888596, "answer_id": 27875601, "question_id": 27875479, "link": "https://stackoverflow.com/questions/27875479/how-to-convert-string-to-float64-in-golang/27875601#27875601", "title": "How to convert []string to []float64 in Golang?", "body": "<p>You need to convert string to float64 using <a href=\"http://golang.org/pkg/strconv/#ParseFloat\">strconv.ParseFloat</a> function:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"strconv\"\n)\n\nvar numbers []float64\nvar sum float64 = 0\n\nfunc main() {\n\n    if len(os.Args) &lt;= 1 {\n        return\n    }\n\n    for _, arg := range os.Args[1:] {\n        if n, err := strconv.ParseFloat(arg, 64); err == nil {\n            numbers = append(numbers, n)\n        }\n    }\n\n    fmt.Println(\"Numbers are: \", numbers)\n    for _, value := range numbers {\n        sum += value\n    }\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1672, "user_id": 2464397, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8l2kG.png?s=128&g=1", "display_name": "ThinkChaos", "link": "https://stackoverflow.com/users/2464397/thinkchaos"}, "is_accepted": false, "score": 2, "last_activity_date": 1420888799, "creation_date": 1420888799, "answer_id": 27875640, "question_id": 27875479, "link": "https://stackoverflow.com/questions/27875479/how-to-convert-string-to-float64-in-golang/27875640#27875640", "title": "How to convert []string to []float64 in Golang?", "body": "<p>It can't convert because <code>string</code> and <code>int</code> are not compatible.</p>\n\n<p>Instead of having the <code>numbers</code> slice, just iterate over <code>os.Args[1:]</code>, using <a href=\"http://golang.org/pkg/strconv/#ParseFloat\" rel=\"nofollow\">ParseFloat</a> from the <code>strconv</code> package.</p>\n\n<pre><code>fmt.Print(\"Numbers are: \")\nfor _, arg := range os.Args[1:] {\n    fmt.Print(arg, \" \")\n    value, err := strconv.ParseFloat(arg, 64)\n    if err != nil {\n        panic(err)\n    }\n    sum += value\n}\n</code></pre>\n"}], "owner": {"reputation": 6591, "user_id": 2185472, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/05ef4480505adfa05516719b865e22aa?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2185472/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7376, "favorite_count": 1, "accepted_answer_id": 27875601, "answer_count": 2, "score": 5, "last_activity_date": 1420894883, "creation_date": 1420887760, "question_id": 27875479, "link": "https://stackoverflow.com/questions/27875479/how-to-convert-string-to-float64-in-golang", "title": "How to convert []string to []float64 in Golang?", "body": "<p>I'm new to programming, and trying to write a simple average program in Go.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nvar numbers []float64\nvar sum float64 = 0\n\nfunc main() {\n\n    if len(os.Args) &gt; 1 {\n\n        numbers = os.Args[1:]\n\n    }\n\n    fmt.Println(\"Numbers are: \", numbers)\n    for _, value := range numbers {\n        sum += value\n    }\n\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/TWNltPO71N\" rel=\"noreferrer\">http://play.golang.org/p/TWNltPO71N</a></p>\n\n<p>when I build the program, I got this error:</p>\n\n<pre><code>prog.go:15: cannot use os.Args[1:] (type []string) as type []float64 in assignment\n[process exited with non-zero status]\n</code></pre>\n\n<p>So how to convert a slice of string to a slice of float numbers? Can I map a convert function to the slice? </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 9295, "user_id": 1650757, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/0RwsN.jpg?s=128&g=1", "display_name": "Melbourne2991", "link": "https://stackoverflow.com/users/1650757/melbourne2991"}, "edited": false, "score": 0, "creation_date": 1420884312, "post_id": 27873254, "comment_id": 44151611, "body": "that makes perfect sense and your answer worked a charm. Cheers!"}], "tags": [], "owner": {"reputation": 2484, "user_id": 3794472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZTwGs.jpg?s=128&g=1", "display_name": "Jeremiah Winsley", "link": "https://stackoverflow.com/users/3794472/jeremiah-winsley"}, "is_accepted": true, "score": 6, "last_activity_date": 1420868490, "creation_date": 1420868490, "answer_id": 27873254, "question_id": 27872735, "link": "https://stackoverflow.com/questions/27872735/function-in-map-is-nil/27873254#27873254", "title": "function in map is &lt;nil&gt;", "body": "<p>You are using <code>*URL.url</code> objects for map keys. Since two different objects won't be the same, you can't access the key for that path again. It's panicking because</p>\n\n<pre><code>urlCallback := methodMap[req.URL]\n</code></pre>\n\n<p>isn't an existing key, and so you're accessing a nil value. What you probably want to do in this case is use the <code>Path</code> property of the <code>URL.url</code> object. </p>\n\n<p>So you'd have:</p>\n\n<pre><code>type RouteMap map[string]func(Res, Req)\n</code></pre>\n\n<p>In <code>Get()</code>:</p>\n\n<pre><code>router.Methods[\"GET\"][parsedUrl.Path] = callback\n</code></pre>\n\n<p>For <code>determineRouter()</code>, you can do this:</p>\n\n<pre><code>urlCallback, exists := methodMap[req.URL.Path]\nif exists != false {\n    urlCallback(res, req)\n}\n</code></pre>\n\n<p>This adds a check to see if the key exists before it tries to call it.</p>\n"}], "owner": {"reputation": 9295, "user_id": 1650757, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/0RwsN.jpg?s=128&g=1", "display_name": "Melbourne2991", "link": "https://stackoverflow.com/users/1650757/melbourne2991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1042, "favorite_count": 1, "accepted_answer_id": 27873254, "answer_count": 1, "score": 0, "last_activity_date": 1573288050, "creation_date": 1420862351, "last_edit_date": 1573288050, "question_id": 27872735, "link": "https://stackoverflow.com/questions/27872735/function-in-map-is-nil", "title": "function in map is &lt;nil&gt;", "body": "<p>I am trying to build a simple router in Go, I have a get method on a struct that should be passing a callback to the Get route map with the url as the key, it seems that <code>fmt.Println(urlCallback)</code> is returning a nil value and causes a runtime panic if i tried to call it, coming from a javascript background I am only just coming to grips with pointers and the like and feel it may have something to do with this,if someone could tell me why the passed func is nil that would be great.</p>\n\n<p>Here is my \"Router\" package.</p>\n\n<pre><code>package Router\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"net/url\"\n    \"log\"\n)\n\ntype Res http.ResponseWriter\ntype Req *http.Request\n\ntype RouteMap map[*url.URL]func(Res, Req) \ntype MethodMap map[string]RouteMap\n\ntype Router struct {\n    Methods MethodMap\n}\n\nfunc (router *Router) Get(urlString string, callback func(Res, Req)) {\n    parsedUrl, err := url.Parse(urlString)\n\n    if(err != nil) {\n        panic(err)\n    }\n\n    fmt.Println(parsedUrl)\n\n    router.Methods[\"GET\"][parsedUrl] = callback\n}\n\nfunc (router *Router) initMaps() {\n    router.Methods = MethodMap{}\n    router.Methods[\"GET\"] = RouteMap{}\n}\n\nfunc (router Router) determineHandler(res http.ResponseWriter, req *http.Request) {\n    fmt.Println(req.URL)\n    fmt.Println(req.Method)\n\n    methodMap := router.Methods[req.Method]\n    urlCallback := methodMap[req.URL]\n\n    fmt.Println(methodMap)\n    fmt.Println(urlCallback)\n}\n\nfunc (router Router) Serve(host string, port string) {\n    fullHost := host + \":\" + port\n\n    fmt.Println(\"Router is now serving to:\" + fullHost)\n    http.HandleFunc(\"/\", router.determineHandler)\n\n    err := http.ListenAndServe(fullHost, nil)\n\n    if err == nil {\n        fmt.Println(\"Router is now serving to:\" + fullHost)\n    } else {\n        fmt.Println(\"An error occurred\")\n        log.Fatal(err)\n    }\n}\n\n\nfunc NewRouter() Router {\n    newRouter := Router{}\n    newRouter.initMaps()\n\n    return newRouter\n}\n</code></pre>\n\n<p>and my main.</p>\n\n<pre><code>package main\n\nimport (\n    \"./router\"\n    \"fmt\"\n)\n\nfunc main() {\n    router := Router.NewRouter()\n\n    router.Get(\"/test\", func(Router.Res, Router.Req) {\n        fmt.Println(\"In test woohooo!\")\n    })\n\n    router.Serve(\"localhost\", \"8888\")\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 2, "creation_date": 1420859703, "post_id": 27872431, "comment_id": 44147292, "body": "Try removing the <code>*</code> in <code>*url.Parse(urlString)</code>. See <a href=\"http://play.golang.org/p/xa8CcENI5g\" rel=\"nofollow noreferrer\">play.golang.org/p/xa8CcENI5g</a>"}, {"owner": {"reputation": 9295, "user_id": 1650757, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/0RwsN.jpg?s=128&g=1", "display_name": "Melbourne2991", "link": "https://stackoverflow.com/users/1650757/melbourne2991"}, "reply_to_user": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 0, "creation_date": 1420859984, "post_id": 27872431, "comment_id": 44147342, "body": "funny you say that, I actually just tried this before reading the comment. It did lose the error mentioned above, but now at runtime, when the function executes I am getting &quot;runtime error: invalid memory address or nil pointer dereference goroutine&quot;"}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 1, "creation_date": 1420860086, "post_id": 27872431, "comment_id": 44147358, "body": "That&#39;s going to be elsewhere in your code. It should give you a line number. Try adding the code around that to your question , or submitting a new question with that code."}, {"owner": {"reputation": 9295, "user_id": 1650757, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/0RwsN.jpg?s=128&g=1", "display_name": "Melbourne2991", "link": "https://stackoverflow.com/users/1650757/melbourne2991"}, "reply_to_user": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 0, "creation_date": 1420860460, "post_id": 27872431, "comment_id": 44147410, "body": "Apologies, you&#39;re right I&#39;ve narrowed it down to a different function. Feel free to leave the above as an answer and ill tick it."}], "answers": [{"tags": [], "owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "is_accepted": true, "score": 2, "last_activity_date": 1420860755, "creation_date": 1420860755, "answer_id": 27872604, "question_id": 27872431, "link": "https://stackoverflow.com/questions/27872431/multiple-value-url-parse-in-single-value-context-net-url/27872604#27872604", "title": "multiple-value url.Parse() in single-value context (net/url)", "body": "<p>Try removing the <code>*</code> in <code>*url.Parse(urlString)</code>. </p>\n\n<pre><code>func (router *Router) Get(urlString string, callback func(Res, Req)) {\n    parsedUrl, err := url.Parse(urlString)\n\n    router.Methods[\"GET\"][parsedUrl] = callback\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/xa8CcENI5g\" rel=\"nofollow\">Playground</a></p>\n\n<p>Also, as the <code>url.Parse()</code> function returns an error, your <code>Get()</code> function should do something with it (preferably return it, but otherwise log it, panic etc.)</p>\n"}], "owner": {"reputation": 9295, "user_id": 1650757, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/0RwsN.jpg?s=128&g=1", "display_name": "Melbourne2991", "link": "https://stackoverflow.com/users/1650757/melbourne2991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1463, "favorite_count": 0, "accepted_answer_id": 27872604, "answer_count": 1, "score": -1, "last_activity_date": 1420860755, "creation_date": 1420858811, "question_id": 27872431, "link": "https://stackoverflow.com/questions/27872431/multiple-value-url-parse-in-single-value-context-net-url", "title": "multiple-value url.Parse() in single-value context (net/url)", "body": "<p>I am trying to build a simple router in Go.</p>\n\n<p>As I understand it url.Parse returns both an error and the parsed url, despite including both these in the assignment I am still getting the error in the title of this question</p>\n\n<pre><code>func (router *Router) Get(urlString string, callback func(Res, Req)) {\n    parsedUrl, err := *url.Parse(urlString)\n\n    router.Methods[\"GET\"][parsedUrl] = callback\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427080708, "post_id": 27872365, "comment_id": 46617298, "body": "If you&#39;re worried about &quot;I have to check if [\u2026] this operation having side effects on other slices&quot; then you&#39;re doing it wrong."}, {"owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "edited": false, "score": 1, "creation_date": 1427115364, "post_id": 27872365, "comment_id": 46631205, "body": "I don&#39;t understand the downvotes. The question is a) perfectly valid b)  well prepared (input code, almost runnable, output) c) clearly formulated and d) There is a simple answer to the question. To those who downvote: plase write why the downvote. It would help the OP."}], "answers": [{"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 3, "last_activity_date": 1427074985, "last_edit_date": 1427074985, "creation_date": 1420871389, "answer_id": 27873513, "question_id": 27872365, "link": "https://stackoverflow.com/questions/27872365/why-golang-slices-internal-designed-like-this/27873513#27873513", "title": "Why golang slices internal designed like this?", "body": "<blockquote>\n  <p>But why golang designers choose not to change the underlying array of the origin slice to the underlying array of the new slice, so as to make both slices still have the same underlying array?</p>\n</blockquote>\n\n<p>Mainly, slices of the same array can appear absolutely anywhere in the program--completely different functions, packages, and so on. Given how slices are laid out in memory, Go would have to \"find\" all slices sharing the array to update them; it has no way to.</p>\n\n<p>The approach of some other array-list implementations (like Python lists) is that what you pass around is really a <em>pointer</em> to something like a Go slice, and if two variables hold \"the same list\", an append using one variable will also show up when you look at the other. That also has some efficiency cost--another pointer lookup to do <code>a[0]</code>. In those circumstances where you really need an append over here to act as an append over there, you can use pointers to slices. </p>\n\n<p>Pointers to slices give you aliasing if you want it but don't provide subslicing--to get <em>everything</em> you ask for, you'd need a different arrangement that I can't think of an example of from in the wild (offset, length, and pointer to <code>struct { capacity int; firstElem *type }</code>).</p>\n"}], "owner": {"reputation": 1336, "user_id": 3003085, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fbef2decbe27595279b81f6b5204b828?s=128&d=identicon&r=PG&f=1", "display_name": "Marvin", "link": "https://stackoverflow.com/users/3003085/marvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 746, "favorite_count": 0, "accepted_answer_id": 27873513, "answer_count": 1, "score": 3, "last_activity_date": 1427074985, "creation_date": 1420858066, "question_id": 27872365, "link": "https://stackoverflow.com/questions/27872365/why-golang-slices-internal-designed-like-this", "title": "Why golang slices internal designed like this?", "body": "<p>Code:</p>\n\n<pre><code>func main() {\n\n    a := []int{1, 2}\n    printSlice(\"a\", a)\n\n    b := a[0:1]\n    printSlice(\"b origin\", b)\n\n    b = append(b, 9)\n    printSlice(\"b after append b without growing capacity\", b)\n    printSlice(\"a after append b without growing capacity\", a)\n\n    b = append(b, 5, 7, 8)\n    printSlice(\"a after append b with grown capacity\", a)\n    printSlice(\"b after append b with grown capacity\", b)\n\n    b[0] = 1000\n    printSlice(\"b\", b)\n    printSlice(\"a\", a)      \n\n}\n\nfunc printSlice(s string, x []int) {\n    fmt.Printf(\"%s len=%d cap=%d %v\\n\",\n        s, len(x), cap(x), x)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>a len=2 cap=2 [1 2]\nb origin len=1 cap=2 [1]\nb after append b without growing capacity len=2 cap=2 [1 9]\na after append b without growing capacity len=2 cap=2 [1 9]\na after append b with grown capacity len=2 cap=2 [1 9]\nb after append b with grown capacity len=5 cap=6 [1 9 5 7 8]\nb len=5 cap=6 [1000 9 5 7 8]\na len=2 cap=2 [1 9]\n</code></pre>\n\n<p>The interesting thing is at the last two printed lines. I already know that a slice is just a window of underlying array. When reslicing it within is capacity, then the two slices share the same underlying array, but When I reslice it to grow beyond its capaccity, the two slices have distinct underlying array. But why golang designers choose not to change the underlying array of the origin slice to the underlying array of the new slice, so as to make both slices still have the same underlying array? In current state when I changed the value of some elements of newly resliced slice I have to check if I changed the underlying array to decide if this operation have side effects on other slices backed up by it(see the last two lines of Output). I think it's awkward. </p>\n"}, {"tags": ["go", "docker", "daemon", "ubuntu-14.04"], "comments": [{"owner": {"reputation": 8038, "user_id": 2862098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2489bd6fa9cdf4fee16418a572cc7f88?s=128&d=identicon&r=PG", "display_name": "Javier Cortejoso", "link": "https://stackoverflow.com/users/2862098/javier-cortejoso"}, "edited": false, "score": 2, "creation_date": 1420878208, "post_id": 27872283, "comment_id": 44150375, "body": "Could you post the output if you run docker daemon directly (not as a service? To run docker daemon: <code>sudo docker -d</code>"}, {"owner": {"reputation": 1926, "user_id": 1965994, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0a809780f2ca5a4c0d63404d5cfcc786?s=128&d=identicon&r=PG", "display_name": "g0c00l.g33k", "link": "https://stackoverflow.com/users/1965994/g0c00l-g33k"}, "reply_to_user": {"reputation": 8038, "user_id": 2862098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2489bd6fa9cdf4fee16418a572cc7f88?s=128&d=identicon&r=PG", "display_name": "Javier Cortejoso", "link": "https://stackoverflow.com/users/2862098/javier-cortejoso"}, "edited": false, "score": 0, "creation_date": 1421068071, "post_id": 27872283, "comment_id": 44204679, "body": "@jcortejoso have updated the question with output of <code>sudo docker -d</code>"}], "answers": [{"tags": [], "owner": {"reputation": 97745, "user_id": 884978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdb4f5f287976278b6e02f66e85c41dc?s=128&d=identicon&r=PG", "display_name": "creack", "link": "https://stackoverflow.com/users/884978/creack"}, "is_accepted": false, "score": 1, "last_activity_date": 1421079131, "creation_date": 1421079131, "answer_id": 27906235, "question_id": 27872283, "link": "https://stackoverflow.com/questions/27872283/docker-daemon-does-not-start-or-restart/27906235#27906235", "title": "Docker daemon does not start or restart", "body": "<p>You probably have a corrupted install.</p>\n\n<ul>\n<li>Uninstall docker</li>\n<li>Make sure you don't have a dockerinit (updatedb / locate dockerinit) -> delete it</li>\n<li>Reinstall docker</li>\n</ul>\n\n<p>This should do the trick.</p>\n\n<p>If not, try uninstalling docker again and try with binaries from <a href=\"https://docs.docker.com/installation/binaries/\" rel=\"nofollow\">https://docs.docker.com/installation/binaries/</a>.</p>\n"}], "owner": {"reputation": 1926, "user_id": 1965994, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0a809780f2ca5a4c0d63404d5cfcc786?s=128&d=identicon&r=PG", "display_name": "g0c00l.g33k", "link": "https://stackoverflow.com/users/1965994/g0c00l-g33k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5885, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1499455887, "creation_date": 1420857261, "last_edit_date": 1421078921, "question_id": 27872283, "link": "https://stackoverflow.com/questions/27872283/docker-daemon-does-not-start-or-restart", "title": "Docker daemon does not start or restart", "body": "<p>I am on ubuntu 14.04 and I also upgrade docker to recent version.</p>\n\n<p>Whenever I do a <code>sudo /etc/init.d/docker start</code> I get a successful pid as follows,</p>\n\n<p><code>docker start/running, process 16267</code></p>\n\n<p>When I view the PID details, I see nothing -</p>\n\n<pre><code>ps -p 16267\nPID TTY          TIME CMD\n</code></pre>\n\n<p>And when I try to do a <code>sudo docker version</code> I see the below -</p>\n\n<pre><code>Client API version: 1.16\nGo version (client): go1.2.1\nOS/Arch (client): linux/amd64\n2015/01/10 10:30:49 Cannot connect to the Docker daemon. Is 'docker -d' running on this host?\n</code></pre>\n\n<p>The output of <code>sudo docker -d</code> is as follows,</p>\n\n<pre><code>[2015-01-12T21:05:59.889680188+08:00] [info] docker daemon:  ; execdriver: native; graphdriver: \n[2015-01-12T21:05:59.889800519+08:00] [83736c52] +job serveapi(unix:///var/run/docker.sock)\n[2015-01-12T21:05:59.895688816+08:00] [info] Listening for HTTP on unix (/var/run/docker.sock)\n[2015-01-12T21:05:59.904409095+08:00] [83736c52] +job init_networkdriver()\n[2015-01-12T21:05:59.932947471+08:00] [83736c52] -job init_networkdriver() = OK (0)\n[2015-01-12T21:05:59.933137366+08:00] [fatal] log.go:64 Could not locate dockerinit: This usually means docker was built incorrectly. See http://docs.docker.com/contributing/devenvironment for official build instructions.\n</code></pre>\n\n<p>I am not sure what is going wrong. Has anyone overcome similar issues? I am not even sure when I should check for more logs on this. Any directions on this will be helpful.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["json", "api", "go", "partial", "put"], "comments": [{"owner": {"reputation": 536, "user_id": 3956589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39365ac79e46dc67ace5d93a627a068d?s=128&d=identicon&r=PG&f=1", "display_name": "whitespace", "link": "https://stackoverflow.com/users/3956589/whitespace"}, "edited": false, "score": 0, "creation_date": 1610264235, "post_id": 27871570, "comment_id": 116073593, "body": "you can prevent the name field being copied into struct by using json <code>&quot;-&quot;</code> tag, but that will also prevent you from using the same struct for response in case your response has <code>name</code> field. The question then is, where exactly do you wan to control this <code>struct</code>. If you want to do it at the level of the handler, you could send back a <code>bad request</code> response in case current name is not the same as that in the struct. If you simple want to prevent an update, you could remove it right before calling the update service."}], "answers": [{"comments": [{"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 2, "creation_date": 1420883273, "post_id": 27871738, "comment_id": 44151385, "body": "This is incorrect: the <code>Name</code> field is not &quot;name&quot; and Go does not let you have read-only fields. Also, Go does not normally need getters and setters for Json marshalling."}], "tags": [], "owner": {"reputation": 1048, "user_id": 4438850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cac784a074b86d771fe768274f6860c?s=128&d=identicon&r=PG", "display_name": "Tiago Romero Garcia", "link": "https://stackoverflow.com/users/4438850/tiago-romero-garcia"}, "is_accepted": false, "score": 0, "last_activity_date": 1420851790, "creation_date": 1420851790, "answer_id": 27871738, "question_id": 27871570, "link": "https://stackoverflow.com/questions/27871570/what-this-the-best-way-to-ignore-unwanted-fields-in-a-json-payload-from-a-put-pa/27871738#27871738", "title": "What this the best way to ignore unwanted fields in a JSON payload from a PUT/PATCH using Golang?", "body": "<p>I am not proficient on Golang but I believe a good strategy would be converting your <code>name</code> field to be a read-only field.</p>\n\n<p>For instance, in a strictly object-oriented language as Java/.NET/C++ you can just provide a Getter but not a Setter.</p>\n\n<p>Maybe there is some accessor configuration for Golang just like Ruby has....</p>\n\n<p>If it is read-only then it shouldn't bother with receiving a spare value, it should just ignore it. But again, not sure if Golang supports it.</p>\n"}, {"tags": [], "owner": {"reputation": 58971, "user_id": 8946, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8c6e2d5c384c074a893830b34f1c0a9a?s=128&d=identicon&r=PG", "display_name": "Lawrence Dol", "link": "https://stackoverflow.com/users/8946/lawrence-dol"}, "is_accepted": false, "score": 1, "last_activity_date": 1420853475, "last_edit_date": 1420853475, "creation_date": 1420852204, "answer_id": 27871784, "question_id": 27871570, "link": "https://stackoverflow.com/questions/27871570/what-this-the-best-way-to-ignore-unwanted-fields-in-a-json-payload-from-a-put-pa/27871784#27871784", "title": "What this the best way to ignore unwanted fields in a JSON payload from a PUT/PATCH using Golang?", "body": "<p>If the name cannot be written it is not valid to provide it for any update request. I would reject the request if the name was present. If I wanted to be more lenient, I might consider only rejecting the request if name is different from the current name. </p>\n\n<p>I would not silently ignore a name which was different from the current name.</p>\n"}, {"comments": [{"owner": {"reputation": 1993, "user_id": 2044035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IKkGD.png?s=128&g=1", "display_name": "Matheus Felipe", "link": "https://stackoverflow.com/users/2044035/matheus-felipe"}, "edited": false, "score": 0, "creation_date": 1420853063, "post_id": 27871788, "comment_id": 44146199, "body": "As I mentioned on the problem description I understand that this is a PATCH method, but we are not changing the logic from PUT so we won&#39;t affect people involved.  Your method of iterating over all fields is not really needed in my case since I could simple write <code>p.Name= &quot;&quot;</code> and force it to an empty value. But, if I <i>have</i> to do this, why even allow consumers to send <code>name</code> in the first place?"}], "tags": [], "owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "is_accepted": false, "score": 0, "last_activity_date": 1420852232, "creation_date": 1420852232, "answer_id": 27871788, "question_id": 27871570, "link": "https://stackoverflow.com/questions/27871570/what-this-the-best-way-to-ignore-unwanted-fields-in-a-json-payload-from-a-put-pa/27871788#27871788", "title": "What this the best way to ignore unwanted fields in a JSON payload from a PUT/PATCH using Golang?", "body": "<p>I think the clean way is to put this logic inside the PATCH handler. There should be some logic that would update only the fields that you want. Is easier if you unpack into a <code>map[string]string</code> and only iterate over the fields that you want to update. Additionally you could decode the json into a map, delete all the fields that you don't want to be updated, re-encode in json and then decode into your struct. </p>\n"}, {"comments": [{"owner": {"reputation": 1993, "user_id": 2044035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IKkGD.png?s=128&g=1", "display_name": "Matheus Felipe", "link": "https://stackoverflow.com/users/2044035/matheus-felipe"}, "edited": false, "score": 0, "creation_date": 1420852808, "post_id": 27871804, "comment_id": 44146153, "body": "What is the default behavior of <code>.permit()</code> in case I <i>DO</i> send <code>name</code>? Error message or silent ignore the field?"}, {"owner": {"reputation": 842, "user_id": 2023664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ae6af0eee3b5af7f2c329d11c76e31?s=128&d=identicon&r=PG", "display_name": "jlucasps", "link": "https://stackoverflow.com/users/2023664/jlucasps"}, "reply_to_user": {"reputation": 1993, "user_id": 2044035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IKkGD.png?s=128&g=1", "display_name": "Matheus Felipe", "link": "https://stackoverflow.com/users/2044035/matheus-felipe"}, "edited": false, "score": 0, "creation_date": 1421111542, "post_id": 27871804, "comment_id": 44226283, "body": "You can follow the strategy that best fit for you. In Rails, for example, there is no default whitelist, everything is blocked until you specify allowed fields. You can also always access field by field, but can&#39;t access the whole <code>params</code> object"}], "tags": [], "owner": {"reputation": 842, "user_id": 2023664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ae6af0eee3b5af7f2c329d11c76e31?s=128&d=identicon&r=PG", "display_name": "jlucasps", "link": "https://stackoverflow.com/users/2023664/jlucasps"}, "is_accepted": false, "score": 1, "last_activity_date": 1420852444, "creation_date": 1420852444, "answer_id": 27871804, "question_id": 27871570, "link": "https://stackoverflow.com/questions/27871570/what-this-the-best-way-to-ignore-unwanted-fields-in-a-json-payload-from-a-put-pa/27871804#27871804", "title": "What this the best way to ignore unwanted fields in a JSON payload from a PUT/PATCH using Golang?", "body": "<p>The first solution your brought is a good one. Some well known frameworks use to implement similar logic.</p>\n\n<p>As an example, latests Rails versions come with a built in solution to prevent users to add extra data in the request, causing the server to update wrong fields in database. It is a kind of whitelist implemented by <code>ActionController::Parameters</code> class.</p>\n\n<p>Let's suppose we have a controller class as bellow. For purpose of this explanation, it contains two <code>update</code> actions. But you won't see it in real code.</p>\n\n<pre><code>class PeopleController &lt; ActionController::Base\n\n  # 1st version - Unsafe, it will rise an exception. Don't do it\n  def update\n    person = current_account.people.find(params[:id])\n    person.update!(params[:person])\n    redirect_to person\n  end\n\n  # 2nd version - Updates only permitted parameters\n  def update\n    person = current_account.people.find(params[:id])\n    person.update!(person_params) # call to person_params method\n    redirect_to person\n  end\n\n\n  private\n\n  def person_params\n    params.require(:person).permit(:name, :age)\n  end\n\nend\n</code></pre>\n\n<p>Since the second version allows only permitted values, it'll block the user to change the payload and send a JSON containing a new password value:</p>\n\n<pre><code>{ name: \"acme\", age: 25, password: 'account-hacked' }\n</code></pre>\n\n<p>For more details, see Rails docs: <a href=\"http://edgeguides.rubyonrails.org/action_controller_overview.html\" rel=\"nofollow\">Action Controller Overview</a> and <a href=\"http://api.rubyonrails.org/classes/ActionController/Parameters.html\" rel=\"nofollow\">ActionController::Parameters</a></p>\n"}, {"tags": [], "owner": {"reputation": 4352, "user_id": 141031, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/93c441cf30945999f29e948b00886c63?s=128&d=identicon&r=PG", "display_name": "rkusa", "link": "https://stackoverflow.com/users/141031/rkusa"}, "is_accepted": false, "score": 1, "last_activity_date": 1463559400, "creation_date": 1463559400, "answer_id": 37293907, "question_id": 27871570, "link": "https://stackoverflow.com/questions/27871570/what-this-the-best-way-to-ignore-unwanted-fields-in-a-json-payload-from-a-put-pa/37293907#37293907", "title": "What this the best way to ignore unwanted fields in a JSON payload from a PUT/PATCH using Golang?", "body": "<p>This can be solved by decoding the JSON body into a <code>map[string]json.RawMessage</code> first. The <code>json.RawMessage</code> type is useful for delaying the actual decoding. Afterwards, a whitelist can be applied on the <code>map[string]json.RawMessage</code> map, ignoring unwanted properties and only decoding the <code>json.RawMessage</code>s of the properties we want to keep.</p>\n\n<p>The process of decoding the whitelisted JSON body into a struct can be automated using the <code>reflect</code> package; an example implementation can be found <a href=\"https://github.com/rkusa/http-json/blob/master/helper.go\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 1993, "user_id": 2044035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IKkGD.png?s=128&g=1", "display_name": "Matheus Felipe", "link": "https://stackoverflow.com/users/2044035/matheus-felipe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1766, "favorite_count": 2, "answer_count": 5, "score": 6, "last_activity_date": 1525750982, "creation_date": 1420850372, "last_edit_date": 1421085372, "question_id": 27871570, "link": "https://stackoverflow.com/questions/27871570/what-this-the-best-way-to-ignore-unwanted-fields-in-a-json-payload-from-a-put-pa", "title": "What this the best way to ignore unwanted fields in a JSON payload from a PUT/PATCH using Golang?", "body": "<p>I have a situation where people consuming our API will need to do a partial update in my resource. I understand that the HTTP clearly specifies that this is a PATCH operation, even though people on our side are used to send a PUT request for this and that's how the legacy code is built. </p>\n\n<p>For exemplification, imagine the simple following struct:</p>\n\n<pre><code>type Person struct {\n    Name string\n    Age int\n    Address string\n}\n</code></pre>\n\n<p>On a POST request, I will provide a payload with all three values (Name, Age, Address) and validate them accordingly on my Golang backend. Simple.</p>\n\n<p>On a PUT/PATCH request though, we know that, for instance, a <code>name</code> never changes. But say I would like to change the <code>age</code>, then I would simply send a JSON payload containing the new <code>age</code>:</p>\n\n<pre><code>PUT /person/1 {age:30}\n</code></pre>\n\n<p>Now to my real question: \nWhat is the best practice to prevent <code>name</code> from being used/updated intentionally or unintentionally modified in case a consumer of our API send a JSON payload containing the <code>name</code> field? </p>\n\n<p>Example:</p>\n\n<pre><code>PUT /person/1 {name:\"New Name\", age:35} \n</code></pre>\n\n<p>Possible solutions I thought of, but I don't actually like them, are:</p>\n\n<ol>\n<li><p>On my <code>validator</code> method, I would either forcibly remove the unwanted field <code>name</code> OR respond with an error message saying that <code>name</code> is not allowed.</p></li>\n<li><p>Create a DTO object/struct that would be pretty much an extension of my <code>Person</code> struct and then unmarshall my JSON payload into it, for instance</p>\n\n<p><code>type PersonPut struct {\n    Age int\n    Address string\n}</code></p></li>\n</ol>\n\n<p>In my opinion this would add needless extra code and logic to abstract the problem, however I don't see any other elegant solution.</p>\n\n<p>I honestly don't like those two approaches and I would like to know if you guys faced the same problem and how you solved it.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["http", "go", "bandwidth-throttling"], "answers": [{"comments": [{"owner": {"reputation": 2597, "user_id": 1715055, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0b29b29364de300edef57e8579ec8780?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1715055/john"}, "edited": false, "score": 0, "creation_date": 1420858879, "post_id": 27871599, "comment_id": 44147172, "body": "Looks great. What about checkin if a limit has been reached such as 5MB? Would I just use b:=make([]byte, 5000000); wrappedIn.Read(b);?"}, {"owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "reply_to_user": {"reputation": 2597, "user_id": 1715055, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0b29b29364de300edef57e8579ec8780?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1715055/john"}, "edited": false, "score": 1, "creation_date": 1420897700, "post_id": 27871599, "comment_id": 44155204, "body": "No you would wrap the <code>io.Reader</code> in an <a href=\"http://golang.org/pkg/io/#LimitedReader\" rel=\"nofollow noreferrer\">io.LimitedReader</a>."}, {"owner": {"reputation": 5380, "user_id": 146620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ba0c9119010302832e1d129b38228b?s=128&d=identicon&r=PG", "display_name": "Graham King", "link": "https://stackoverflow.com/users/146620/graham-king"}, "edited": false, "score": 2, "creation_date": 1510683916, "post_id": 27871599, "comment_id": 81536140, "body": "This limits the speed at which you read from the kernel&#39;s TCP buffer, not directly the speed at which you read from remote. The local TCP buffer will fill, the network will be idle while you read (slowly) from the buffer, then it will burst again to refill the buffer. For a large download you&#39;re averaging 10 bytes/sec from remote, but for a small download you&#39;re just consuming it slowly, with no difference in network activity. To limit net activity see <a href=\"https://unix.stackexchange.com/questions/28198/how-to-limit-network-bandwidth\" title=\"how to limit network bandwidth\">unix.stackexchange.com/questions/28198/&hellip;</a>"}], "tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": true, "score": 5, "last_activity_date": 1420850587, "creation_date": 1420850587, "answer_id": 27871599, "question_id": 27869858, "link": "https://stackoverflow.com/questions/27869858/limiting-bandwidth-of-http-get/27871599#27871599", "title": "Limiting bandwidth of http get", "body": "<p>There is an updated version of <a href=\"http://godoc.org/github.com/mxk/go-flowrate/flowrate#NewReader\" rel=\"noreferrer\">the package on github</a></p>\n\n<p>You use it by wrapping an <code>io.Reader</code></p>\n\n<p>Here is a complete example which will show the homepage of Google veeeery sloooowly.</p>\n\n<p>This wrapping an interface to make new functionality is very good Go style, and you'll see a lot of it in your journey into Go.</p>\n\n<pre><code>package main\n\nimport (\n    \"io\"\n    \"log\"\n    \"net/http\"\n    \"os\"\n\n    \"github.com/mxk/go-flowrate/flowrate\"\n)\n\nfunc main() {\n    resp, err := http.Get(\"http://google.com\")\n    if err != nil {\n        log.Fatalf(\"Get failed: %v\", err)\n    }\n    defer resp.Body.Close()\n\n    // Limit to 10 bytes per second\n    wrappedIn := flowrate.NewReader(resp.Body, 10)\n\n    // Copy to stdout\n    _, err = io.Copy(os.Stdout, wrappedIn)\n    if err != nil {\n        log.Fatalf(\"Copy failed: %v\", err)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 15, "last_activity_date": 1420908941, "creation_date": 1420908941, "answer_id": 27878678, "question_id": 27869858, "link": "https://stackoverflow.com/questions/27869858/limiting-bandwidth-of-http-get/27878678#27878678", "title": "Limiting bandwidth of http get", "body": "<p>Thirdparty packages have convenient wrappers. But if you interested in how things work under the hood - it's quite easy.</p>\n\n<pre><code>package main\n\nimport (\n    \"io\"\n    \"net/http\"\n    \"os\"\n    \"time\"\n)\n\nvar datachunk int64 = 500       //Bytes\nvar timelapse time.Duration = 1 //per seconds\n\nfunc main() {\n    responce, _ := http.Get(\"http://google.com\")\n    for range time.Tick(timelapse * time.Second) {\n        _, err :=io.CopyN(os.Stdout, responce.Body, datachunk)\n        if err!=nil {break}\n    }\n}\n</code></pre>\n\n<p>Nothing magic.</p>\n"}], "owner": {"reputation": 2597, "user_id": 1715055, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0b29b29364de300edef57e8579ec8780?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1715055/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3787, "favorite_count": 4, "accepted_answer_id": 27871599, "answer_count": 2, "score": 7, "last_activity_date": 1420908941, "creation_date": 1420840374, "question_id": 27869858, "link": "https://stackoverflow.com/questions/27869858/limiting-bandwidth-of-http-get", "title": "Limiting bandwidth of http get", "body": "<p>I'm a beginner to golang. </p>\n\n<p>Is there any way to limit golang's http.Get() bandwidth usage? I found this: <a href=\"http://godoc.org/code.google.com/p/mxk/go1/flowcontrol\">http://godoc.org/code.google.com/p/mxk/go1/flowcontrol</a>, but I'm not sure how to piece the two together. How would I get access to the http Reader?</p>\n"}, {"tags": ["function", "go", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": true, "score": 16, "last_activity_date": 1420835502, "creation_date": 1420835502, "answer_id": 27868751, "question_id": 27868369, "link": "https://stackoverflow.com/questions/27868369/what-happens-to-return-value-from-goroutine/27868751#27868751", "title": "What happens to return value from goroutine", "body": "<p>A quick bit of looking at the assembly output shows</p>\n\n<pre><code>$ go build -gcflags -S z.go\n</code></pre>\n\n<p>The <code>getNumber()</code> function does store its results to the stack</p>\n\n<pre><code>\"\".getNumber t=1 size=16 value=0 args=0x10 locals=0x0\n    0x0000 00000 (z.go:5)   TEXT    \"\".getNumber+0(SB),4,$0-16\n    0x0000 00000 (z.go:6)   MOVQ    \"\".i+8(FP),BX\n    0x0005 00005 (z.go:6)   MOVQ    BX,\"\".~r1+16(FP)\n    0x000a 00010 (z.go:6)   RET ,\n</code></pre>\n\n<p>So when it is called from a goroutine, it does store its results to the stack. However this is a new stack which is destroyed when the goroutine ends so there is no possibility of retrieving the return value.</p>\n\n<pre><code>\"\".main t=1 size=96 value=0 args=0x0 locals=0x18\n    0x0000 00000 (z.go:9)   TEXT    \"\".main+0(SB),$24-0\n    0x0000 00000 (z.go:9)   MOVQ    (TLS),CX\n    0x0009 00009 (z.go:9)   CMPQ    SP,16(CX)\n    0x000d 00013 (z.go:9)   JHI ,22\n    0x000f 00015 (z.go:9)   CALL    ,runtime.morestack_noctxt(SB)\n    0x0014 00020 (z.go:9)   JMP ,0\n    0x0016 00022 (z.go:9)   SUBQ    $24,SP\n    0x001a 00026 (z.go:10)  MOVQ    $0,AX\n    0x001c 00028 (z.go:10)  CMPQ    AX,$10\n    0x0020 00032 (z.go:10)  JGE $0,74\n    0x0022 00034 (z.go:11)  MOVQ    AX,\"\".i+16(SP)\n    0x0027 00039 (z.go:11)  MOVQ    AX,(SP)\n    0x002b 00043 (z.go:11)  MOVQ    $\"\".getNumber\u00b7f+0(SB),CX\n    0x0032 00050 (z.go:11)  PUSHQ   CX,\n    0x0033 00051 (z.go:11)  PUSHQ   $16,\n    0x0035 00053 (z.go:11)  PCDATA  $0,$0\n    0x0035 00053 (z.go:11)  CALL    ,runtime.newproc(SB)\n    0x003a 00058 (z.go:11)  POPQ    ,CX\n    0x003b 00059 (z.go:11)  POPQ    ,CX\n    0x003c 00060 (z.go:10)  MOVQ    \"\".i+16(SP),AX\n    0x0041 00065 (z.go:10)  INCQ    ,AX\n    0x0044 00068 (z.go:10)  NOP ,\n    0x0044 00068 (z.go:10)  CMPQ    AX,$10\n    0x0048 00072 (z.go:10)  JLT $0,34\n    0x004a 00074 (z.go:13)  MOVQ    $5,(SP)\n    0x0052 00082 (z.go:13)  PCDATA  $0,$0\n    0x0052 00082 (z.go:13)  CALL    ,time.Sleep(SB)\n    0x0057 00087 (z.go:14)  ADDQ    $24,SP\n    0x005b 00091 (z.go:14)  RET ,\n</code></pre>\n\n<p>However there is no way of retrieving these results.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 13, "last_activity_date": 1429593992, "last_edit_date": 1429593992, "creation_date": 1420844786, "answer_id": 27870734, "question_id": 27868369, "link": "https://stackoverflow.com/questions/27868369/what-happens-to-return-value-from-goroutine/27870734#27870734", "title": "What happens to return value from goroutine", "body": "<p>Quoting from the <a href=\"http://golang.org/ref/spec#Go_statements\" rel=\"noreferrer\"><strong>Go Language specification: Go statements</strong></a>:</p>\n\n<blockquote>\n  <p>If the function has any return values, they are discarded when the function completes.</p>\n</blockquote>\n\n<p>So it is allowed to execute functions with return values as goroutines - there is nothing wrong with it, and the specification clearly states that their return values are simply discarded, it will not cause any error but you won't get it in the usually way (as you would by directly calling the function).</p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1420895604, "creation_date": 1420895604, "answer_id": 27876599, "question_id": 27868369, "link": "https://stackoverflow.com/questions/27868369/what-happens-to-return-value-from-goroutine/27876599#27876599", "title": "What happens to return value from goroutine", "body": "<p>Values are discarded. And there is nothing special to <code>go</code> statement. You can also write</p>\n\n<pre><code>...\n_ = getNumber(i)\n...\n</code></pre>\n\n<p>or just</p>\n\n<pre><code>...\ngetNumber(i)\n...\n</code></pre>\n\n<p>even</p>\n"}, {"tags": [], "owner": {"reputation": 167, "user_id": 4144205, "user_type": "registered", "profile_image": "https://graph.facebook.com/746552377/picture?type=large", "display_name": "Shiv", "link": "https://stackoverflow.com/users/4144205/shiv"}, "is_accepted": false, "score": 0, "last_activity_date": 1431917633, "creation_date": 1431917633, "answer_id": 30294417, "question_id": 27868369, "link": "https://stackoverflow.com/questions/27868369/what-happens-to-return-value-from-goroutine/30294417#30294417", "title": "What happens to return value from goroutine", "body": "<p>Unlike most of the other programming languages, Go routine does not use stack for storing result and return address. It has a special memory allocation for that which destroys itself after execution is completed. you can see details about it in Rob Pike's(founder of golang)talk. visit this link for the youtube video: <a href=\"https://www.youtube.com/watch?v=f6kdp27TYZs&amp;index=4&amp;list=LLRA7nvHOCb4nuU7byESOYIg\" rel=\"nofollow\">https://www.youtube.com/watch?v=f6kdp27TYZs&amp;index=4&amp;list=LLRA7nvHOCb4nuU7byESOYIg</a></p>\n"}, {"tags": [], "owner": {"reputation": 14361, "user_id": 3612353, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/94f2502e42d2e474bfd81dba411fe66f?s=128&d=identicon&r=PG", "display_name": "cn007b", "link": "https://stackoverflow.com/users/3612353/cn007b"}, "is_accepted": false, "score": 0, "last_activity_date": 1549403619, "creation_date": 1549403619, "answer_id": 54543629, "question_id": 27868369, "link": "https://stackoverflow.com/questions/27868369/what-happens-to-return-value-from-goroutine/54543629#54543629", "title": "What happens to return value from goroutine", "body": "<p>FYI: if you try to assign function result to var, like this:</p>\n\n<pre><code>res := go printNumber(i)\n</code></pre>\n\n<p>you'll get <strong>syntax error</strong> like this:</p>\n\n<pre><code>prog.go:4:7: syntax error: unexpected go, expecting expression\n</code></pre>\n\n<p>you can check it out <a href=\"https://play.golang.org/p/tNMiUg_Jh0q\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 2466, "user_id": 844409, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2794079e054eefacace0906449800cf?s=128&d=identicon&r=PG", "display_name": "subhash kumar singh", "link": "https://stackoverflow.com/users/844409/subhash-kumar-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4639, "favorite_count": 1, "accepted_answer_id": 27868751, "answer_count": 5, "score": 10, "last_activity_date": 1549403619, "creation_date": 1420834012, "question_id": 27868369, "link": "https://stackoverflow.com/questions/27868369/what-happens-to-return-value-from-goroutine", "title": "What happens to return value from goroutine", "body": "<p>Could someone please give clarification values returned from the goroutine. Does the returned value from the goroutine is getting stored on stake.</p>\n\n<p>example :</p>\n\n<pre><code>// function getNumber returns the \"int i\" and we can't use this returned value\n// because this function is invoked as goroutine.\n// We know that, to communicate between main and goroutine one could\n// use the channel ( chan &lt;- i), but I am interested to know about\n// the use of return i in goroutine. Is it possible to get/ use this \n// returned value.\nfunc getNumber(i int) int {\n    return i   \n    }\n\nfunc main() {\n\n    for i:=0; i&lt;10; i++ {\n        go printNumber(i)\n        }\n    time.Sleep(5)\n    }\n</code></pre>\n\n<p>Should we try to avoid the return valued in go routine ? </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2859, "user_id": 3945932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1794745acd9e572c24558b78b48d597?s=128&d=identicon&r=PG", "display_name": "ptd", "link": "https://stackoverflow.com/users/3945932/ptd"}, "edited": false, "score": 1, "creation_date": 1420831685, "post_id": 27867732, "comment_id": 44137944, "body": "You have to run <code>go run main.go session.go</code>. The <code>go run</code> command needs all the files named."}, {"owner": {"reputation": 10253, "user_id": 1647484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/W7T7D.png?s=128&g=1", "display_name": "BrainLikeADullPencil", "link": "https://stackoverflow.com/users/1647484/brainlikeadullpencil"}, "reply_to_user": {"reputation": 2859, "user_id": 3945932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1794745acd9e572c24558b78b48d597?s=128&d=identicon&r=PG", "display_name": "ptd", "link": "https://stackoverflow.com/users/3945932/ptd"}, "edited": false, "score": 0, "creation_date": 1420831732, "post_id": 27867732, "comment_id": 44137968, "body": "ok, thanks, I actually ran go build and got it to work. I guess your answer is the solution if you don&#39;t build. If you write the answer, I will accept."}], "answers": [{"tags": [], "owner": {"reputation": 170, "user_id": 1596720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99fd986abc96ebc01af0322b7a3beaf9?s=128&d=identicon&r=PG", "display_name": "Iver", "link": "https://stackoverflow.com/users/1596720/iver"}, "is_accepted": true, "score": 1, "last_activity_date": 1420833711, "creation_date": 1420833711, "answer_id": 27868298, "question_id": 27867732, "link": "https://stackoverflow.com/questions/27867732/exported-methods-not-available-in-same-package/27868298#27868298", "title": "exported methods not available in same package", "body": "<p>As @ptd said, the command needs all the files named. </p>\n\n<p>I prefer use another package:</p>\n\n<pre><code>/ main.go\n  |_session/\n    |_session.go\n    |_validations.go\n    |_errors.go\n</code></pre>\n\n<p>So, you can organize your code and simplify your named files. </p>\n\n<p>e.g.:</p>\n\n<p><strong>file</strong>: main.go</p>\n\n<pre><code>package main\nimport \"session\"\n\nfunc main() {\n  var validator session.Validator\n  var session session.Session\n  ...\n  if session.IsValid() == false {\n     // return session.InvalidSession\n     fmt.Printf(\"ERROR: %v\", session.InvalidSession)\n  }\n}\n</code></pre>\n\n<p><strong>file</strong>: errors.go</p>\n\n<pre><code>import \"errors\"\n\nvar (\n   InvalidSession = errors.New(\"[Your error message]\"\n)\n</code></pre>\n\n<p>Then you can use:</p>\n\n<pre><code>go run main.go\n</code></pre>\n"}], "owner": {"reputation": 10253, "user_id": 1647484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/W7T7D.png?s=128&g=1", "display_name": "BrainLikeADullPencil", "link": "https://stackoverflow.com/users/1647484/brainlikeadullpencil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 27868298, "answer_count": 1, "score": -2, "last_activity_date": 1420833711, "creation_date": 1420831523, "question_id": 27867732, "link": "https://stackoverflow.com/questions/27867732/exported-methods-not-available-in-same-package", "title": "exported methods not available in same package", "body": "<p>I have a small go lang project which in the main.go file has a few handlers that refer to session related methods in a session.go file. Both have <code>package main</code> at the top of the file. The functions in the session.go file all begin with an uppercase letter (i.e. they are public/exported methods). Yet when I run the <code>main.go</code> file, it says the methods located in <code>session.go</code> and called from <code>main.go</code> are <code>undefined</code>. Why is that, how to fix it.</p>\n\n<p>I am running the project like <code>go run main.go</code></p>\n\n<p>main.go</p>\n\n<pre><code>func logout(w http.ResponseWriter, r *http.Request) {\nClearSession(w, r)\n ....\n}\n</code></pre>\n\n<p>session.go</p>\n\n<pre><code>func ClearSession(w http.ResponseWriter, r *http.Request) {\n\n}\n</code></pre>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 4670, "user_id": 731240, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BZhQx.jpg?s=128&g=1", "display_name": "dg99", "link": "https://stackoverflow.com/users/731240/dg99"}, "edited": false, "score": 0, "creation_date": 1420831826, "post_id": 27867648, "comment_id": 44138018, "body": "What have you tried so far?  Do you have a set of sample HTTP headers that you&#39;ve been using as test cases?"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1420832291, "last_edit_date": 1420832291, "creation_date": 1420831886, "answer_id": 27867828, "question_id": 27867648, "link": "https://stackoverflow.com/questions/27867648/http-header-names-in-go/27867828#27867828", "title": "HTTP header names in Go", "body": "<p>The keys in a header are in <a href=\"http://godoc.org/net/http#CanonicalHeaderKey\" rel=\"nofollow\">canonical format</a>.</p>\n\n<p>The <a href=\"http://godoc.org/net/http#Header\" rel=\"nofollow\">Header</a> methods canonicalize the the key for you.</p>\n\n<p>If the application accesses the header map directly, then the application is responsible for ensuring that the key is in canonical format.</p>\n\n<p>Some examples of header names in canonical format are:</p>\n\n<pre><code>Content-Length\nEtag\n</code></pre>\n\n<p>You can find all headers using range:</p>\n\n<pre><code>for name, values := range req.Header {\n     fmt.Printf(\"%s: %v\\n\", name, values)\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4399434, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-M_LJBxams-c/AAAAAAAAAAI/AAAAAAAAAC8/po9s1vtn3rw/photo.jpg?sz=128", "display_name": "Alexander Telpis", "link": "https://stackoverflow.com/users/4399434/alexander-telpis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1149, "favorite_count": 0, "accepted_answer_id": 27867828, "answer_count": 1, "score": -1, "last_activity_date": 1420851314, "creation_date": 1420831113, "last_edit_date": 1420851314, "question_id": 27867648, "link": "https://stackoverflow.com/questions/27867648/http-header-names-in-go", "title": "HTTP header names in Go", "body": "<p>I need to collect a bunch of http headers. The only way I found yet is *http.Request <code>.Header.Get(\"%header name%\")</code>\nIs there any name conventions for %header name% ? <br><strong>E.g.</strong> in PHP all keys are uppercased, words separated with underscore.</p>\n"}, {"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1420829481, "post_id": 27867148, "comment_id": 44136945, "body": "Please indent your code. Your code is very hard to read like this."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1420829391, "last_edit_date": 1495540245, "creation_date": 1420829391, "answer_id": 27867236, "question_id": 27867148, "link": "https://stackoverflow.com/questions/27867148/how-to-define-a-pointer-in-go-then-pass-this-pointer-in-to-a-func-to-change-its/27867236#27867236", "title": "How to define a pointer in go, then pass this pointer in to a func to change its value?", "body": "<p>You should use pass an &amp;int to <code>zeroptr</code>, as in <a href=\"https://play.golang.org/p/_Lq5eFW8R-\" rel=\"nofollow noreferrer\">this example</a>:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc zeroptr(ptr *int) {\n    *ptr = 0\n}\n\nfunc main() {\n\n    var ptr int\n    ptr = 1\n    fmt.Println(\"ptr is :\", ptr)\n    zeroptr(&amp;ptr)\n    fmt.Println(\"after calling zeroptr, the value of ptr is :\", ptr)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>ptr is : 1\nafter calling zeroptr, the value of ptr is : 0\n</code></pre>\n\n<p>You can see a similar example in \"<a href=\"https://stackoverflow.com/a/16389064/6309\">What's the point of having pointers in Go?</a>\", from the <a href=\"http://www.golang-book.com/8/index.htm\" rel=\"nofollow noreferrer\">golang book</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 0, "last_activity_date": 1420831206, "last_edit_date": 1420831206, "creation_date": 1420829463, "answer_id": 27867250, "question_id": 27867148, "link": "https://stackoverflow.com/questions/27867148/how-to-define-a-pointer-in-go-then-pass-this-pointer-in-to-a-func-to-change-its/27867250#27867250", "title": "How to define a pointer in go, then pass this pointer in to a func to change its value?", "body": "<p>What does your pointer point to? In order to manipulate the memory a pointer points to, you first need to point the pointer somewhere. Right now, your <code>ptr</code> is pointing to <code>nil</code> which is invalid. You could for instance do this:</p>\n\n<pre><code>func main() {\n    var foo int\n    var oneptr *int = &amp;foo\n    *oneptr = 1\n    fmt.Println(\"oneptr is :\", *oneptr)\n    zeroptr(oneptr)\n    fmt.Println(\"after calling zeroptr, the value of oneptr is :\", *ptr)\n}\n</code></pre>\n\n<p>For the future, please indent your code before submitting it here. You can do this with the <code>gofmt</code> program.</p>\n"}], "owner": {"reputation": 79, "user_id": 4437981, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/39c0d4ecf94327d12027be28e7dd66e4?s=128&d=identicon&r=PG&f=1", "display_name": "Xiujiao Gao", "link": "https://stackoverflow.com/users/4437981/xiujiao-gao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 1, "accepted_answer_id": 27867250, "answer_count": 2, "score": -5, "last_activity_date": 1420831206, "creation_date": 1420829000, "last_edit_date": 1420830526, "question_id": 27867148, "link": "https://stackoverflow.com/questions/27867148/how-to-define-a-pointer-in-go-then-pass-this-pointer-in-to-a-func-to-change-its", "title": "How to define a pointer in go, then pass this pointer in to a func to change its value?", "body": "<pre><code>import \"fmt\"\n\nfunc zeroptr(ptr *int) {\n    *ptr = 0\n}\n\nfunc main() {\n    oneptr * int\n    *ptr = 1\n    fmt.Println(\"ptr is :\", *ptr)\n    zeroptr(ptr)\n    fmt.Println(\"after calling zeroptr, the value of ptr is :\", *ptr)\n}\n</code></pre>\n\n<p>This does not work, I am looking for output as follows:</p>\n\n<p>ptr is :1</p>\n\n<p>after calling zeroptr, the value of ptr is : 0</p>\n"}, {"tags": ["go", "overhead", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "is_accepted": false, "score": 1, "last_activity_date": 1420827634, "creation_date": 1420827634, "answer_id": 27866763, "question_id": 27865277, "link": "https://stackoverflow.com/questions/27865277/which-is-one-better-code-for-goroutine-overhead/27866763#27866763", "title": "which is one better code for goroutine overhead", "body": "<p>Code 1 is better and probably faster. Code 2 will just read once. But I think both solutions are not the best. you should loop over the read and send back only the bytes readed.</p>\n\n<p>Something like : <a href=\"http://play.golang.org/p/zRPXOtdgWD\" rel=\"nofollow\">http://play.golang.org/p/zRPXOtdgWD</a> </p>\n"}], "owner": {"reputation": 1, "user_id": 4437559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f2f5d1e2caf01f235cdb008524eefde?s=128&d=identicon&r=PG&f=1", "display_name": "Doraemong", "link": "https://stackoverflow.com/users/4437559/doraemong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1420827634, "creation_date": 1420822064, "question_id": 27865277, "link": "https://stackoverflow.com/questions/27865277/which-is-one-better-code-for-goroutine-overhead", "title": "which is one better code for goroutine overhead", "body": "<p>I want to make Reader.Read concurrent with channel communication.\nso I made two ways to run it</p>\n\n<p>1:\n</p>\n\n<pre><code>type ReturnRead struct {\n    n   int\n    err error\n}\n\ntype ReadGoSt struct {\n    Returnc &lt;-chan ReturnRead\n    Nextc chan struct{}\n}\n\nfunc (st *ReadGoSt) Close() {\n    defer func() {\n        recover()\n    }()\n    close(st.Next)\n}\n\nfunc ReadGo(r io.Reader, b []byte) *ReadGoSt {\n    returnc := make(chan ReturnRead)\n    nextc := make(chan bool)\n\n    go func() {\n        for range nextc {\n            n, err := r.Read(b)\n            returnc &lt;- ReturnRead{n, err}\n            if err != nil {\n                return\n            }\n        }\n    }()\n\n    return &amp;ReadGoSt{returnc, nextc}\n}\n</code></pre>\n\n<p>2:\n</p>\n\n<pre><code>func ReadGo(r io.Reader, b []byte) &lt;-chan ReturnRead {\n    returnc := make(chan ReturnRead)\n    go func() {\n        n, err := r.Read(b)\n        returnc &lt;- ReturnRead{n, err}\n    }()\n    return returnc\n}\n</code></pre>\n\n<p>i think code 2 creates too many overhead</p>\n\n<p>which is the better code? 1? 2?</p>\n"}, {"tags": ["go", "gdb"], "comments": [{"owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "edited": false, "score": 0, "creation_date": 1420815484, "post_id": 27863273, "comment_id": 44128691, "body": "How do you build your program?"}, {"owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "reply_to_user": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "edited": false, "score": 0, "creation_date": 1420815537, "post_id": 27863273, "comment_id": 44128725, "body": "go build -gcflags &quot;-N -l&quot; server.go"}], "owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1420815269, "creation_date": 1420815269, "question_id": 27863273, "link": "https://stackoverflow.com/questions/27863273/debugging-go-with-gdb-log-println-stops-gdb", "title": "debugging go with gdb - log.Println stops gdb", "body": "<p>When I debug with gdb and hit a line with log.Println(\"WhatEver\")</p>\n\n<p>gdb is just on a new blank line. How do I get back to gdb?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["apache", "go", "apache-modules", "cgo"], "owner": {"reputation": 10777, "user_id": 1507139, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/efa15e463560953d4ee5943bd427846d?s=128&d=identicon&r=PG", "display_name": "eatonphil", "link": "https://stackoverflow.com/users/1507139/eatonphil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 164, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1421013335, "creation_date": 1420815074, "last_edit_date": 1421013335, "question_id": 27863214, "link": "https://stackoverflow.com/questions/27863214/golang-type-conversion-loop-apache-modules", "title": "golang type conversion loop - apache modules", "body": "<p>I'm trying to construct a Go interface to the Apache module system. I.e. I want to be able to call Go functions from my Apache module. This is my Go file:</p>\n\n<pre><code>package main\n\n// #cgo CFLAGS: -I/usr/include/apache2 -I/usr/include/apr-1.0\n// #include &lt;httpd.h&gt;\nimport \"C\"\n\n//export handler\nfunc handler(r *C.request_rec) int {\n    ap_set_content_type(r, \"text/html\");\n    ap_rprintf(r, \"Hello, world from Go\")\n    return OK;\n}\n</code></pre>\n\n<p>When I build it (<code>go build mod_frugal.go</code>) I get this error:</p>\n\n<pre><code># command-line-arguments\n./mod_frugal.go:8:17: type conversion loop at volatile *struct apr_bucket\n</code></pre>\n\n<p>Line 8 is the line that function \"handler\" begins. Any suggestions?</p>\n\n<p>Alternatively, when I build with cgo (<code>go tool cgo mod_frugal.go</code>) it doesn't see my include directives at all:</p>\n\n<pre><code>/home/vagrant/mod_frugal/src/mod_frugal.go:4:20: fatal error: httpd.h: No such file or directory\n// #include &lt;httpd.h&gt;\n                ^\ncompilation terminated.\n</code></pre>\n\n<p>When I added the \"C.\" prefix the two apache calls:</p>\n\n<pre><code>package main\n\n// #cgo CFLAGS: -I/usr/include/apache2 -I/usr/include/apr-1.0\n// #include \"mod_frugal.h\"\nimport \"C\"\n\n//export handler\nfunc handler(r *C.struct_request_rec) int {\n    C.ap_set_content_type(r, \"text/html\")\n    C.ap_rprintf(r, \"&lt;h1&gt;Hello, world from Go!&lt;/h1&gt;\")\n    return OK\n}\n</code></pre>\n\n<p>I get a new error:</p>\n\n<pre><code># _/home/vagrant/mod_frugal/src\n37: error: 'ap_set_content_type' undeclared (first use in this function)\n37: error: 'ap_rprintf' undeclared (first use in this function)\n</code></pre>\n\n<p>Maybe I need to be linking against libhttpd? I just can't find anything on the internet about linking against apache2 for builds including like libhttpd.</p>\n\n<p>EDIT:</p>\n\n<p>Feel free to follow the conversation <a href=\"https://groups.google.com/d/msg/golang-nuts/ru1_3cz7Hes/jRognWL4zCsJ\" rel=\"nofollow\">here</a>:</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 9594, "user_id": 448734, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/94ccfc629c6862b5950de3512742bcae?s=128&d=identicon&r=PG", "display_name": "Bryan", "link": "https://stackoverflow.com/users/448734/bryan"}, "edited": false, "score": 0, "creation_date": 1423643510, "post_id": 27860179, "comment_id": 45227435, "body": "I believe this has now been fixed in the main godef repository."}], "tags": [], "owner": {"reputation": 9594, "user_id": 448734, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/94ccfc629c6862b5950de3512742bcae?s=128&d=identicon&r=PG", "display_name": "Bryan", "link": "https://stackoverflow.com/users/448734/bryan"}, "is_accepted": true, "score": 3, "last_activity_date": 1420805088, "creation_date": 1420805088, "answer_id": 27860179, "question_id": 27860178, "link": "https://stackoverflow.com/questions/27860178/how-to-rebuild-godef-to-work-with-go-1-4/27860179#27860179", "title": "How to rebuild godef to work with Go 1.4", "body": "<p>I had to edit this file because a dependency has moved:</p>\n\n<pre><code>--- a/exp/cmd/godef/acme.go\n+++ b/exp/cmd/godef/acme.go\n@@ -1,7 +1,7 @@\n package main\n\n import (\n-   \"code.google.com/p/goplan9/plan9/acme\"\n+   \"9fans.net/go/acme\"\n    \"fmt\"\n    \"io\"\n    \"os\"\n</code></pre>\n\n<p>Then <code>go build</code> and <code>go install</code> and all working great once more.</p>\n"}, {"tags": [], "owner": {"reputation": 141, "user_id": 1613256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53269556900c9235cf6c1fcd6785566?s=128&d=identicon&r=PG", "display_name": "ddysher", "link": "https://stackoverflow.com/users/1613256/ddysher"}, "is_accepted": false, "score": 0, "last_activity_date": 1423622616, "creation_date": 1423622616, "answer_id": 28445704, "question_id": 27860178, "link": "https://stackoverflow.com/questions/27860178/how-to-rebuild-godef-to-work-with-go-1-4/28445704#28445704", "title": "How to rebuild godef to work with Go 1.4", "body": "<p>I've experienced the same issue, I edited godef.go though.</p>\n\n<pre><code>--- a/exp/cmd/godef/godef.go  2015-01-19 15:29:10.760304470 -0500\n+++ b/exp/cmd/godef/godef.go  2015-02-10 21:36:29.678102962 -0500\n@@ -47,7 +47,7 @@\n        }\n        r := runtime.GOROOT()\n        if r != \"\" {\n-               gopath = append(gopath, r+\"/src/pkg\")\n+               gopath = append(gopath, r+\"/src\")\n        }\n        types.GoPath = gopath\n}\n</code></pre>\n"}], "owner": {"reputation": 9594, "user_id": 448734, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/94ccfc629c6862b5950de3512742bcae?s=128&d=identicon&r=PG", "display_name": "Bryan", "link": "https://stackoverflow.com/users/448734/bryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 509, "favorite_count": 0, "accepted_answer_id": 27860179, "answer_count": 2, "score": 0, "last_activity_date": 1423622616, "creation_date": 1420805088, "question_id": 27860178, "link": "https://stackoverflow.com/questions/27860178/how-to-rebuild-godef-to-work-with-go-1-4", "title": "How to rebuild godef to work with Go 1.4", "body": "<p>After I upgraded to Go 1.4, <code>godef</code> is no longer finding many things in the standard libraries, for instance <code>Testing.Fatalf</code>.  </p>\n\n<p>When I try to <code>go get -u</code>, I get these errors:</p>\n\n<pre><code>package code.google.com/p/goplan9/plan9/acme\n    imports code.google.com/p/goplan9/plan9/acme\n    imports code.google.com/p/goplan9/plan9/acme: cannot find package \"code.google.com/p/goplan9/plan9/acme\" in any of:\n    /Users/bryan/local/go/src/code.google.com/p/goplan9/plan9/acme (from $GOROOT)\n    /Users/bryan/sweng/oms/src/code.google.com/p/goplan9/plan9/acme (from $GOPATH)\n</code></pre>\n"}, {"tags": ["go", "compression", "zlib"], "answers": [{"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": false, "score": 2, "last_activity_date": 1420787916, "last_edit_date": 1420787916, "creation_date": 1420771879, "answer_id": 27853130, "question_id": 27852940, "link": "https://stackoverflow.com/questions/27852940/how-can-i-use-zlib-in-golang-to-cooperate-with-zlib-in-c/27853130#27853130", "title": "How can I use zlib in golang to cooperate with zlib in c?", "body": "<p>As background, Go doesn't come with the zlib library, and <code>compress/zlib</code> is only has its name 'cause it works with zlib format data. Though the format's the same, the details of the compression algorithm aren't (leading, for example, to <a href=\"https://github.com/golang/go/issues/2726\" rel=\"nofollow\">worse speed and slightly worse compression</a> for the Go library). So output won't typically match, even at the same compression level and with the same wrapper.</p>\n\n<p>The answer from an author of zlib (Mark Adler) raises the essential point that different output doesn't mean the output can't be decompressed by zlib. I think that's your real answer here, but leaving the rest of this around because it has some non-overlapping information about what Go's doing/your options in Go.</p>\n\n<hr>\n\n<p>The <a href=\"http://github.com/youtube/vitess/\" rel=\"nofollow\">Vitess project</a> (YouTube's internal MySQL proxy) needed the speed of C zlib for their application, so they wrote an adapter, <a href=\"http://godoc.org/github.com/youtube/vitess/go/cgzip\" rel=\"nofollow\">cgzip</a>. You didn't say what format you wanted the output in; if the answer is not gzip, you'll have to fork and modify cgzip so it calls the right bits of zlib to produce what you need.</p>\n\n<p>The upside of using cgzip or similar is that it'll act like zlib because it's using zlib. The downside is that you'll no no longer have a pure-Go app, so you lose the trivial cross-compiles and gain an additional dependency on the environment your program's built and run in (though in zlib's case, the ubiquity and stable API mean it's much less of an issue to take it as a dep than some libraries).</p>\n"}, {"comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1420788669, "post_id": 27853778, "comment_id": 44114830, "body": "It&#39;s most awesome you answer so many zlib and compression q&#39;s here. The question text incorrectly suggested that asker was using zlib-the-library from Go (and the first rev of my answer did nothing to set that straight). So, bears noting that Go&#39;s compressed output is different because it&#39;s using its own compression code instead of zlib, and the details of its algorithm differ (<a href=\"https://github.com/golang/go/issues/2726\" rel=\"nofollow noreferrer\">related bug</a>). Suspect that your point that different compressed output doesn&#39;t mean it can&#39;t be decompressed w/zlib is what asker needed to know, though."}], "tags": [], "owner": {"reputation": 78348, "user_id": 1180620, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FXaAg.jpg?s=128&g=1", "display_name": "Mark Adler", "link": "https://stackoverflow.com/users/1180620/mark-adler"}, "is_accepted": false, "score": 4, "last_activity_date": 1420821436, "last_edit_date": 1420821436, "creation_date": 1420777324, "answer_id": 27853778, "question_id": 27852940, "link": "https://stackoverflow.com/questions/27852940/how-can-i-use-zlib-in-golang-to-cooperate-with-zlib-in-c/27853778#27853778", "title": "How can I use zlib in golang to cooperate with zlib in c?", "body": "<p>Just because the compressed data is different doesn't mean that it can't be decompressed.  zlib-compliant compressed data generated anywhere can be decompressed by a compliant zlib decoder anywhere else.  Did you try decompressing?</p>\n\n<p>As for the difference, @twotwotwo points out that compress/zlib in Go is <em>not</em> the original zlib library, but rather a different implementation written in Go.  So it would be expected to generate different output if it uses different algorithms to find matches and/or emit blocks.</p>\n"}], "owner": {"reputation": 1456, "user_id": 1784595, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/KoQV5.png?s=128&g=1", "display_name": "frank.lin", "link": "https://stackoverflow.com/users/1784595/frank-lin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 618, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1420821436, "creation_date": 1420770496, "question_id": 27852940, "link": "https://stackoverflow.com/questions/27852940/how-can-i-use-zlib-in-golang-to-cooperate-with-zlib-in-c", "title": "How can I use zlib in golang to cooperate with zlib in c?", "body": "<p>I found that, for the same string, the result of using zlib in golang is different with that in c. How can I compress in golang and decompress in c by zlib ? Which version does go use?</p>\n"}, {"tags": ["c++", "windows", "dll", "go"], "comments": [{"owner": {"reputation": 245, "user_id": 1726036, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cfa2a7ff38934c33507490fb62041d99?s=128&d=identicon&r=PG", "display_name": "Askable", "link": "https://stackoverflow.com/users/1726036/askable"}, "reply_to_user": {"reputation": 49960, "user_id": 32453, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bec38d63650c8912b6ba9b557fb953b9?s=128&d=identicon&r=PG", "display_name": "rogerdpack", "link": "https://stackoverflow.com/users/32453/rogerdpack"}, "edited": false, "score": 0, "creation_date": 1420835290, "post_id": 27849137, "comment_id": 44139766, "body": "That was a typo on my part when creating the question.  My code was correct (a single colon).  Now corrected in the question text."}, {"owner": {"reputation": 245, "user_id": 1726036, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cfa2a7ff38934c33507490fb62041d99?s=128&d=identicon&r=PG", "display_name": "Askable", "link": "https://stackoverflow.com/users/1726036/askable"}, "reply_to_user": {"reputation": 49960, "user_id": 32453, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bec38d63650c8912b6ba9b557fb953b9?s=128&d=identicon&r=PG", "display_name": "rogerdpack", "link": "https://stackoverflow.com/users/32453/rogerdpack"}, "edited": false, "score": 0, "creation_date": 1422660148, "post_id": 27849137, "comment_id": 44853173, "body": "This was the correct answer.  Why don&#39;t you put it in an answer and I&#39;ll give you credit.  Thx!"}], "answers": [{"tags": [], "owner": {"reputation": 49960, "user_id": 32453, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bec38d63650c8912b6ba9b557fb953b9?s=128&d=identicon&r=PG", "display_name": "rogerdpack", "link": "https://stackoverflow.com/users/32453/rogerdpack"}, "is_accepted": true, "score": 2, "last_activity_date": 1422662795, "last_edit_date": 1495535469, "creation_date": 1422662795, "answer_id": 28246652, "question_id": 27849137, "link": "https://stackoverflow.com/questions/27849137/golang-call-windows-dll-functions/28246652#28246652", "title": "Golang: call Windows DLL functions", "body": "<p>If you're trying to link against the dll you need/want \"-lMyModule\" in the LDFLAGS? <a href=\"https://stackoverflow.com/a/15853231/32453\">https://stackoverflow.com/a/15853231/32453</a> </p>\n"}], "owner": {"reputation": 245, "user_id": 1726036, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cfa2a7ff38934c33507490fb62041d99?s=128&d=identicon&r=PG", "display_name": "Askable", "link": "https://stackoverflow.com/users/1726036/askable"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4185, "favorite_count": 0, "accepted_answer_id": 28246652, "answer_count": 1, "score": 3, "last_activity_date": 1422662795, "creation_date": 1420749691, "last_edit_date": 1420835240, "question_id": 27849137, "link": "https://stackoverflow.com/questions/27849137/golang-call-windows-dll-functions", "title": "Golang: call Windows DLL functions", "body": "<p>I am writing a Go app that calls into a Windows DLL.  The DLL was written with MSVC and has extern \"C\" exports using __declspec(dllexport).</p>\n\n<p>The top of my Go app is as follows:</p>\n\n<pre><code>//#cgo CFLAGS: -IC:/Repos/Module/include\n//#cgo LDFLAGS: -L. C:/Repos/Module/go/bin/MyModule.dll\n//#include &lt;MyModule.h&gt;\nimport \"C\"\n</code></pre>\n\n<p>I'm calling functions from the module like so:</p>\n\n<pre><code>nRet := C.moduleImpl_len()\n</code></pre>\n\n<p>The problem is that when I try to run this app, I get the following error:</p>\n\n<pre><code>C:\\Users\\MINDO~1\\AppData\\Local\\Temp\\go-build836751819\\mod\\modimpl\\_obj\\modimpl.cgo2.o: In function `_cgo_e2aaf076ab69_Cfunc_moduleImpl_len':\nC:/Repos/Module/go/src/mod/modimpl/modimpl.go:90: undefined reference to `moduleImpl_len'\n</code></pre>\n\n<p>I looked at the DLL exported symbols with DUMPBIN and it showed exactly \"moduleImpl_len\" as the exported symbol.  This is also the symbol as defined in MyModule.h.</p>\n\n<p>Any suggestions on how I can get the symbols to link without having to go the syscall route?</p>\n"}, {"tags": ["python", "go"], "comments": [{"owner": {"reputation": 1683, "user_id": 1098041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3277172b7213117c165e42611c0749a?s=128&d=identicon&r=PG", "display_name": "F&#233;lix Cantournet", "link": "https://stackoverflow.com/users/1098041/f%c3%a9lix-cantournet"}, "edited": false, "score": 5, "creation_date": 1420747071, "post_id": 27848406, "comment_id": 44100760, "body": "I think the term you are looking for is python list <code>comprehension</code>"}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1420796906, "post_id": 27848406, "comment_id": 44118327, "body": "The second example doesn&#39;t work in python: abs takes 1 argument, not 2."}], "answers": [{"comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1420750674, "post_id": 27848524, "comment_id": 44102638, "body": "I tend to agree with Pike&#39;s readme--use <code>for</code>. Possibly forever but certainly for now, Go is an imperative language that favors straight-line code. The language probably isn&#39;t going to change to make other approaches easier, more or less regardless of how many folks wish it would. The point of the package was (after getting complaints) that you can do that kind of thing if you feel you truly <i>need</i> it with <code>reflect</code> and stuff, not that he thinks you should."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1420750813, "post_id": 27848524, "comment_id": 44102699, "body": "@twotwotwo yes, I suppose &#39;<code>for</code>&#39;, plus some &#39;<code>go generate</code>&#39; should be enough."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 8, "creation_date": 1420750904, "post_id": 27848524, "comment_id": 44102741, "body": "Note the prominent &quot;You should not use this package.&quot; at <a href=\"http://godoc.org/robpike.io/filter\" rel=\"nofollow noreferrer\">godoc.org/robpike.io/filter</a>"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 10, "last_activity_date": 1420754945, "last_edit_date": 1495540982, "creation_date": 1420747140, "answer_id": 27848524, "question_id": 27848406, "link": "https://stackoverflow.com/questions/27848406/equivalent-for-pythons-list-comprehension/27848524#27848524", "title": "Equivalent for Python&#39;s list comprehension", "body": "<p>Interestingly enough, <a href=\"https://github.com/robpike\" rel=\"noreferrer\">Rob Pike</a> just proposed (18 hours ago) the library <a href=\"https://github.com/robpike/filter\" rel=\"noreferrer\">filter</a> which does a bit what you want:</p>\n\n<p>See <a href=\"https://github.com/robpike/filter/blob/719f41397a0cd4c4b12b3176a49821de294efb75/apply.go#L27-L34\" rel=\"noreferrer\">for instance Choose()</a></p>\n\n<pre><code>// Choose takes a slice of type []T and a function of type func(T) bool. (If\n// the input conditions are not satisfied, Choose panics.) It returns a newly\n// allocated slice containing only those elements of the input slice that\n// satisfy the function.\n</code></pre>\n\n<p><a href=\"https://github.com/robpike/filter/blob/719f41397a0cd4c4b12b3176a49821de294efb75/apply_test.go#L67-L70\" rel=\"noreferrer\">Tested here</a>:</p>\n\n<pre><code>func TestChoose(t *testing.T) {\n    a := []int{1, 2, 3, 4, 5, 6, 7, 8, 9}\n    expect := []int{2, 4, 6, 8}\n    result := Choose(a, isEven)\n</code></pre>\n\n<p>As <a href=\"https://stackoverflow.com/users/2714852/twotwotwo\"><code>twotwotwo</code></a> points out <a href=\"https://stackoverflow.com/questions/27848406/golang-equivalent-for-pythons-list-comprehension#comment44102741_27848524\">in the comments</a>, the <a href=\"http://godoc.org/robpike.io/filter\" rel=\"noreferrer\">GoDoc for this library</a> states:</p>\n\n<blockquote>\n  <p>Package <code>filter</code> contains utility functions for filtering slices through the distributed application of a filter function.</p>\n  \n  <p>The package is an experiment to see how easy it is to write such things in Go. It is easy, but <strong><code>for</code> loops are just as easy and more efficient</strong>.</p>\n  \n  <p><strong>You should not use this package.</strong></p>\n</blockquote>\n\n<p>This caveat is reflected in the document \"<a href=\"https://docs.google.com/document/d/1vrAy9gMpMoS3uaVphB32uVXX4pi-HnNjkMEgyAHX4N4/mobilebasic?pli=1\" rel=\"noreferrer\"><strong>Summary of Go Generics Discussions</strong></a>\", section \"<a href=\"https://docs.google.com/document/d/1vrAy9gMpMoS3uaVphB32uVXX4pi-HnNjkMEgyAHX4N4/mobilebasic?pli=1#h.97ujgd64iyd\" rel=\"noreferrer\"><strong>Functional Code</strong></a>\":</p>\n\n<blockquote>\n  <p>These are the usual <a href=\"http://en.wikipedia.org/wiki/Higher-order_function\" rel=\"noreferrer\">higher-order functions</a> such as <code>map</code>, <code>reduce</code> (<code>fold</code>), <code>filter</code>, <code>zip</code> etc.</p>\n  \n  <p><strong>Cases</strong>:<br>\n  typesafe data transformations: <code>map</code>, <code>fold</code>, <code>zip</code></p>\n  \n  <p><strong>Pros for using generics</strong>:<br>\n  Concise way to express data transformations.</p>\n  \n  <p><strong>Cons for using generics</strong>:<br>\n  The fastest solution needs to take into account when and which order to apply those transformations, and how much data is generated at each step.<br>\n  It is harder to read for beginners.</p>\n  \n  <p><strong>Alternative solutions</strong>:</p>\n  \n  <p><strong>use <code>for</code> loops and usual language constructs</strong>.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1420751305, "post_id": 27848549, "comment_id": 44102982, "body": "Not in Go (just a normal library on GitHub) and the documentation advises you not to use it; it&#39;s just an experiment to show you can do it if you want to."}], "tags": [], "owner": {"reputation": 1683, "user_id": 1098041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3277172b7213117c165e42611c0749a?s=128&d=identicon&r=PG", "display_name": "F&#233;lix Cantournet", "link": "https://stackoverflow.com/users/1098041/f%c3%a9lix-cantournet"}, "is_accepted": false, "score": 2, "last_activity_date": 1420747220, "creation_date": 1420747220, "answer_id": 27848549, "question_id": 27848406, "link": "https://stackoverflow.com/questions/27848406/equivalent-for-pythons-list-comprehension/27848549#27848549", "title": "Equivalent for Python&#39;s list comprehension", "body": "<p>If what you are looking is indeed python list comprehension, there is no such syntactic equivalent in go AFAIK.</p>\n\n<p>The way to do it is to create a function that take a slice and a function (to test the condition) and return a new slice.</p>\n\n<p>EDIT:\nWell looks like there is already such a feature in Go. cf VonC</p>\n"}], "owner": {"reputation": 7273, "user_id": 2641547, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/660520007/picture?type=large", "display_name": "Spearfisher", "link": "https://stackoverflow.com/users/2641547/spearfisher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18371, "favorite_count": 3, "accepted_answer_id": 27848524, "answer_count": 2, "score": 26, "last_activity_date": 1569328759, "creation_date": 1420746682, "last_edit_date": 1569328759, "question_id": 27848406, "link": "https://stackoverflow.com/questions/27848406/equivalent-for-pythons-list-comprehension", "title": "Equivalent for Python&#39;s list comprehension", "body": "<p>I am playing with Go but I am having a very hard time doing things that are very simple in other languages.</p>\n\n<p>I'd like to reproduce a similar syntax:</p>\n\n<pre><code>array = [a for a in anotherArray  if (some condition)]\n</code></pre>\n\n<p>What is an elegant way to do it in Go? I'd really like to simplify my code especially when using function on array. For example:</p>\n\n<pre><code>min = min(abs(a[i], b[j]) for i in range(n)\n                          for j in range(i, n))\n</code></pre>\n\n<p>Many thanks</p>\n"}, {"tags": ["sockets", "tcp", "go", "network-programming"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1420747585, "post_id": 27847730, "comment_id": 44101038, "body": "what is your ulimit for open files (assuming POSIX here)?"}, {"owner": {"reputation": 2466, "user_id": 844409, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2794079e054eefacace0906449800cf?s=128&d=identicon&r=PG", "display_name": "subhash kumar singh", "link": "https://stackoverflow.com/users/844409/subhash-kumar-singh"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1420747667, "post_id": 27847730, "comment_id": 44101077, "body": "I am using mac machine."}, {"owner": {"reputation": 2466, "user_id": 844409, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2794079e054eefacace0906449800cf?s=128&d=identicon&r=PG", "display_name": "subhash kumar singh", "link": "https://stackoverflow.com/users/844409/subhash-kumar-singh"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1420747958, "post_id": 27847730, "comment_id": 44101243, "body": "@JimB I have added some detail."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1420748622, "post_id": 27847730, "comment_id": 44101581, "body": "You&#39;re trying to create 10000 connections, and your ulimit is 10000, so there&#39;s no room for the other FDs the process will need. If fixing that that doesn&#39;t work, instead of exiting stop the program to see how many connections are open."}, {"owner": {"reputation": 2466, "user_id": 844409, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2794079e054eefacace0906449800cf?s=128&d=identicon&r=PG", "display_name": "subhash kumar singh", "link": "https://stackoverflow.com/users/844409/subhash-kumar-singh"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1420749135, "post_id": 27847730, "comment_id": 44101844, "body": "@JimB the error is completely random form FDs, sometime it happen at 1200 connection and sometime it reaches to 5000 connection. But it never reached to the 10000 connection."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1420753454, "post_id": 27847730, "comment_id": 44104125, "body": "You&#39;re reaching the limit on open file descriptors, there&#39;s nothing random here. Just because a connection isn&#39;t established, doesn&#39;t mean it hasn&#39;t consumed a file descriptor. Instead of trying to Dial 10000 connection simultaneously, create them serially while starting the clients."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 3, "creation_date": 1420758451, "post_id": 27847730, "comment_id": 44106394, "body": "You cannot copy wait group values. Change the connect function to <code>func connect(address string, wg *sync.WaitGroup)</code> and the invocation to <code>go connect(&quot;:9100&quot;, &amp;wg)</code>. You will notice this issue once you get the fd issue solved."}, {"owner": {"reputation": 2466, "user_id": 844409, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2794079e054eefacace0906449800cf?s=128&d=identicon&r=PG", "display_name": "subhash kumar singh", "link": "https://stackoverflow.com/users/844409/subhash-kumar-singh"}, "edited": false, "score": 0, "creation_date": 1420782895, "post_id": 27847730, "comment_id": 44112815, "body": "thanks for the correction!!"}, {"owner": {"reputation": 8981, "user_id": 71444, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2101d75ccd71c5dfb984991a7ba53b9b?s=128&d=identicon&r=PG", "display_name": "harm", "link": "https://stackoverflow.com/users/71444/harm"}, "edited": false, "score": 0, "creation_date": 1420798417, "post_id": 27847730, "comment_id": 44119135, "body": "Another gotcha; you are calling <code>defer conn.Close()</code> in the client. When there is an error creating the connection you&#39;re code immediately exists never reaching the <code>defer</code>. This leads to dangling connections and thus file descriptors. You can check if this is a problem with <code>lsof|grep client</code>."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 8981, "user_id": 71444, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2101d75ccd71c5dfb984991a7ba53b9b?s=128&d=identicon&r=PG", "display_name": "harm", "link": "https://stackoverflow.com/users/71444/harm"}, "edited": false, "score": 3, "creation_date": 1420815523, "post_id": 27847730, "comment_id": 44128715, "body": "@harm When Dial returns err != nil, there is no connection to close. Also, exiting the process will close any fds."}, {"owner": {"reputation": 8981, "user_id": 71444, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2101d75ccd71c5dfb984991a7ba53b9b?s=128&d=identicon&r=PG", "display_name": "harm", "link": "https://stackoverflow.com/users/71444/harm"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1420827038, "post_id": 27847730, "comment_id": 44135682, "body": "@3of3 Right you are. I&#39;m confusing this issue with an other I had some time ago in which the program kept running on an error."}], "owner": {"reputation": 2466, "user_id": 844409, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2794079e054eefacace0906449800cf?s=128&d=identicon&r=PG", "display_name": "subhash kumar singh", "link": "https://stackoverflow.com/users/844409/subhash-kumar-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4264, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1420782930, "creation_date": 1420744126, "last_edit_date": 1490005101, "question_id": 27847730, "link": "https://stackoverflow.com/questions/27847730/dial-error-too-many-open-files", "title": "dial error : &#39;too many open files&#39;", "body": "<p>I am trying to write TCP client-server program, to find the maximum number of concurrent connection handled by server. So I create a simple server and initiated multiple tcp connection (using go routine).</p>\n\n<p>server.go</p>\n\n<pre><code>func main() {\n    ln, err := net.Listen(\"tcp\", \":9100\")\n    if err != nil {\n        fmt.Println(err.Error())\n    }\n    defer ln.Close()\n    fmt.Println(\"server has started\")\n\n    for {\n        conn, err := ln.Accept()\n        if err != nil {\n            fmt.Println(err.Error())\n        }\n        conn.Close()\n        fmt.Println(\"received one connection\")\n    }\n\n}\n</code></pre>\n\n<p>client.go</p>\n\n<pre><code>func connect(address string, wg *sync.WaitGroup) {\n    conn, err := net.Dial(\"tcp\", address)\n    if err != nil {\n        fmt.Println(err.Error())\n        os.Exit(-1)\n    }\n    defer conn.Close()\n\n    fmt.Println(\"connection is established\")\n    wg.Done()\n}\n\nfunc main() {\n    var wg sync.WaitGroup\n    for i := 0; i &lt; 10000; i++ {\n        wg.Add(1)\n        fmt.Printf(\"connection %d\", i)\n        fmt.Println()\n        go connect(\":9100\", &amp;wg)\n    }\n\n    wg.Wait()\n    fmt.Print(\"all the connection served\")\n}\n</code></pre>\n\n<p>I was expecting that server will become unresponsive because of TCP SYN attach but my client application got crashed after ~2000 connection request. Following is the error message :</p>\n\n<pre><code>dial tcp :9100: too many open files\nexit status 255\n</code></pre>\n\n<p>I need help for the following questions :</p>\n\n<ul>\n<li><p>What are the required changes in <code>client.go</code> to emulate the TCP connection flooding on my go server.</p></li>\n<li><p>How could I increase the number of open FD (mac OS), if there is limitation of maximum open FD for a precess.</p></li>\n<li><p>What is the default TCP queue size for the Listen() (in C programming language, queue size is specified in the <code>listen(fd, queue_size)</code>).</p></li>\n</ul>\n\n<p>Edit :</p>\n\n<ul>\n<li>I found some help (question #2) for <a href=\"https://superuser.com/questions/302754/increase-the-maximum-number-of-open-file-descriptors-in-snow-leopard\">increasing the number of open file descriptor</a>, but it is not working (no change in client error message).</li>\n</ul>\n\n<p>ulimit settings</p>\n\n<pre><code>$ ulimit -a\ncore file size          (blocks, -c) 0\ndata seg size           (kbytes, -d) unlimited\nfile size               (blocks, -f) unlimited\nmax locked memory       (kbytes, -l) unlimited\nmax memory size         (kbytes, -m) unlimited\nopen files                      (-n) 10000\npipe size            (512 bytes, -p) 1\nstack size              (kbytes, -s) 8192\ncpu time               (seconds, -t) unlimited\nmax user processes              (-u) 709\nvirtual memory          (kbytes, -v) unlimited\n</code></pre>\n"}, {"tags": ["json", "struct", "go"], "answers": [{"tags": [], "owner": {"reputation": 9694, "user_id": 797538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b50394e88b7b1ff30dbca04c06560e5a?s=128&d=identicon&r=PG", "display_name": "lnmx", "link": "https://stackoverflow.com/users/797538/lnmx"}, "is_accepted": false, "score": 1, "last_activity_date": 1420739074, "creation_date": 1420739074, "answer_id": 27846325, "question_id": 27845726, "link": "https://stackoverflow.com/questions/27845726/using-struct-with-json/27846325#27846325", "title": "Using []struct with Json", "body": "<p>This statement:</p>\n\n<pre><code>eventDataJSON := new(GITHUB_EVENT)\n</code></pre>\n\n<p>declares <code>eventDataJSON</code> as <code>*GITHUB_EVENT</code> (a pointer to a slice), and initializes it as a nil pointer.  After unmarshaling, you could access the first event by explicitly deref-ing the pointer before indexing:</p>\n\n<pre><code>(*eventDataJSON)[0].Id\n</code></pre>\n\n<p>However, the more conventional approach is to use <code>make</code>:</p>\n\n<pre><code>eventDataJSON := make(GITHUB_EVENT, 0)\n</code></pre>\n\n<p>which declares <code>eventDataJSON</code> as a <code>GITHUB_EVENT</code>, and initializes it as an empty slice.  (Remember that <code>make</code> is for special built-in types such as slices, maps, and channels).  </p>\n\n<p>You could pass a pointer to this slice to <code>json.Unmarshal</code>:</p>\n\n<pre><code>_ = json.Unmarshal([]byte(eventDataRAW), &amp;eventDataJSON)\n</code></pre>\n\n<p>...and then index the slice directly:</p>\n\n<pre><code>fmt.Println(eventDataJSON[0].Id)\n</code></pre>\n\n<p>Additionally, <code>json.Marshal</code> will take care of allocating the output value, so you could  declare <code>eventDataJSON</code> and skip any explicit initialization:</p>\n\n<pre><code>var eventDataJSON GITHUB_EVENT\n</code></pre>\n\n<p>Example: <a href=\"http://play.golang.org/p/zaELDgnpB2\" rel=\"nofollow\">http://play.golang.org/p/zaELDgnpB2</a></p>\n"}], "owner": {"reputation": 1, "user_id": 4433871, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--8WiD7BDYh0/AAAAAAAAAAI/AAAAAAAAABc/gnFyZbgJBCg/photo.jpg?sz=128", "display_name": "Daz44", "link": "https://stackoverflow.com/users/4433871/daz44"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1420739074, "creation_date": 1420736953, "question_id": 27845726, "link": "https://stackoverflow.com/questions/27845726/using-struct-with-json", "title": "Using []struct with Json", "body": "<p>I'm trying to parse JSON to a []struct, the JSON is retrieved from <a href=\"https://api.github.com/events\" rel=\"nofollow\">https://api.github.com/events</a>\nHowever when I try to access each struct within the array I get an error:</p>\n\n<pre><code>type GITHUB_EVENT does not support indexing\n</code></pre>\n\n<p>How am I able to access each struct within the array?</p>\n\n<pre><code>func httpGetEvents() {\n    eventDataRAW := httpPageGet(\"https://api.github.com/events\", true)\n    eventDataJSON := new(GITHUB_EVENT)\n\n    _ = json.Unmarshal([]byte(eventDataRAW), &amp;eventDataJSON)\n\n    fmt.Println(eventDataJSON[0].Id)\n}\n\n//--------------------------------------------------------------------------------------//\n\ntype GITHUB_EVENT []struct {\n    Id    string `json:\"id\"`\n    Type  string `json:\"type\"`\n    Actor struct {\n        Id         int    `json:\"id\"`\n        Login      string `json:\"login\"`\n        GravatarId string `json:\"gravatar_id\"`\n        Url        string `json:\"url\"`\n        AvatarUrl  string `json:\"avatar_url\"`\n    } `json:\"actor\"`\n    Repo struct {\n        Id   int    `json:\"id\"`\n        Name string `json:\"name\"`\n        Url  string `json:\"url\"`\n    } `json:\"repo\"`\n    Payload struct {\n        PushId       int    `json:\"push_id\"`\n        Size         int    `json:\"size\"`\n        DistinctSize int    `json:\"distinct_size\"`\n        Ref          string `json:\"ref\"`\n        Head         string `json:\"head\"`\n        Before       string `json:\"before\"`\n        Commits      []struct {\n            Sha    string `json:\"sha\"`\n            Author struct {\n                Email string `json:\"email\"`\n                Name  string `json:\"name\"`\n            } `json:\"author\"`\n            Message  string `json:\"message\"`\n            Distinct bool   `json:\"distinct\"`\n            Url      string `json:\"url\"`\n        } `json:\"commits\"`\n    } `json:\"payload\"`\n    Public    bool   `json:\"public\"`\n    CreatedAt string `json:\"created_at\"`\n}\n</code></pre>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 441, "user_id": 1136722, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/1fd4f1b0d25534671c37f66ebe1ae068?s=128&d=identicon&r=PG", "display_name": "ali", "link": "https://stackoverflow.com/users/1136722/ali"}, "edited": false, "score": 1, "creation_date": 1420744821, "post_id": 27846510, "comment_id": 44099461, "body": "While this works fine (also with app engine), not all http servers accept range. Is there a client-only method which is independent of server range support?"}, {"owner": {"reputation": 1903, "user_id": 1549474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2766dac2718e51b8c5f4f021c8e740c4?s=128&d=identicon&r=PG", "display_name": "tumdum", "link": "https://stackoverflow.com/users/1549474/tumdum"}, "reply_to_user": {"reputation": 441, "user_id": 1136722, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/1fd4f1b0d25534671c37f66ebe1ae068?s=128&d=identicon&r=PG", "display_name": "ali", "link": "https://stackoverflow.com/users/1136722/ali"}, "edited": false, "score": 0, "creation_date": 1420746206, "post_id": 27846510, "comment_id": 44100250, "body": "You can try implementing your own <a href=\"http://golang.org/pkg/net/http/#RoundTripper\" rel=\"nofollow noreferrer\">RoundTripper</a> and using it as Transport in Client."}, {"owner": {"reputation": 441, "user_id": 1136722, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/1fd4f1b0d25534671c37f66ebe1ae068?s=128&d=identicon&r=PG", "display_name": "ali", "link": "https://stackoverflow.com/users/1136722/ali"}, "edited": false, "score": 0, "creation_date": 1420809454, "post_id": 27846510, "comment_id": 44125120, "body": "The <code>RoundTripper</code> is implemented internally in app engine urlfetch, it does not seem to be extendable. While this is not a general solution, in my case, the servers support accepting range."}, {"owner": {"reputation": 1718, "user_id": 1872349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6fcd98026680336db34f494b89a06e?s=128&d=identicon&r=PG", "display_name": "Raphael C", "link": "https://stackoverflow.com/users/1872349/raphael-c"}, "reply_to_user": {"reputation": 441, "user_id": 1136722, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/1fd4f1b0d25534671c37f66ebe1ae068?s=128&d=identicon&r=PG", "display_name": "ali", "link": "https://stackoverflow.com/users/1136722/ali"}, "edited": false, "score": 0, "creation_date": 1549286160, "post_id": 27846510, "comment_id": 95836683, "body": "as @ali pointed out, you must first make sure the server accepts partial downloads by looking at the response in the header for <code>Accept-Ranges</code>. if you want to do the check before downloading the file, you can send a <code>HEAD</code> request to the same endpoint, and check for this header (and eventually that the server responds a 206 status indicating partial content)."}], "tags": [], "owner": {"reputation": 1903, "user_id": 1549474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2766dac2718e51b8c5f4f021c8e740c4?s=128&d=identicon&r=PG", "display_name": "tumdum", "link": "https://stackoverflow.com/users/1549474/tumdum"}, "is_accepted": true, "score": 8, "last_activity_date": 1420739700, "creation_date": 1420739700, "answer_id": 27846510, "question_id": 27844307, "link": "https://stackoverflow.com/questions/27844307/how-to-download-only-the-beginning-of-a-large-file-with-go-http-client-and-app/27846510#27846510", "title": "How to download only the beginning of a large file with go http.Client (and app engine urlfetch)", "body": "<p>Setting \"Range\" Request Header attribute to \"bytes=0-1023\" should work.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n)\n\nfunc main() {\n    req, _ := http.NewRequest(\"GET\", \"http://example.com\", nil)\n    req.Header.Add(\"Range\", \"bytes=0-1023\")\n    fmt.Println(req)\n    var client http.Client\n    resp, _ := client.Do(req)\n    fmt.Println(resp)\n    body, _ := ioutil.ReadAll(resp.Body)\n    fmt.Println(len(body))\n}\n</code></pre>\n\n<p>Same thing should work for http.Client provieded in app engine.</p>\n"}, {"comments": [{"owner": {"reputation": 441, "user_id": 1136722, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/1fd4f1b0d25534671c37f66ebe1ae068?s=128&d=identicon&r=PG", "display_name": "ali", "link": "https://stackoverflow.com/users/1136722/ali"}, "edited": false, "score": 1, "creation_date": 1420744634, "post_id": 27847526, "comment_id": 44099350, "body": "This only <i>reads</i> the first 1kb, but downloads the whole file. <code>client.Get(&quot;http:&#47;&#47;example.com&quot;)</code> has fully buffered <code>response.Body</code>, even before using any readers on it."}, {"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "reply_to_user": {"reputation": 441, "user_id": 1136722, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/1fd4f1b0d25534671c37f66ebe1ae068?s=128&d=identicon&r=PG", "display_name": "ali", "link": "https://stackoverflow.com/users/1136722/ali"}, "edited": false, "score": 0, "creation_date": 1420744833, "post_id": 27847526, "comment_id": 44099465, "body": "@ali No it doesn&#39;t download the whole file. At least on my machine."}, {"owner": {"reputation": 441, "user_id": 1136722, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/1fd4f1b0d25534671c37f66ebe1ae068?s=128&d=identicon&r=PG", "display_name": "ali", "link": "https://stackoverflow.com/users/1136722/ali"}, "edited": false, "score": 0, "creation_date": 1420745331, "post_id": 27847526, "comment_id": 44099739, "body": "Have you tried it with app engine? Unfortunately <a href=\"https://cloud.google.com/appengine/docs/go/urlfetch/\" rel=\"nofollow noreferrer\">appengine/urlfetch</a> buffers it all once <code>client.Get()</code> is called. This might be due to <code>urlfetch.Transport</code>."}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 2, "last_activity_date": 1420743401, "creation_date": 1420743401, "answer_id": 27847526, "question_id": 27844307, "link": "https://stackoverflow.com/questions/27844307/how-to-download-only-the-beginning-of-a-large-file-with-go-http-client-and-app/27847526#27847526", "title": "How to download only the beginning of a large file with go http.Client (and app engine urlfetch)", "body": "<p>There is also io.LimitReader() in io pkg, which can make limited reader</p>\n\n<pre><code>package main\n\nimport (\n    \"io\"\n    \"io/ioutil\"\n    \"net/http\"\n)\n\nfunc main() {\n    var client http.Client\n    responce, _:=client.Get(\"http://example.com\")\n    body:=responce.Body\n    chunk:=io.LimitReader(body, 1024)\n    stuff, _:=ioutil.ReadAll(chunk)\n    //Do what you want with stuff\n}\n</code></pre>\n"}], "owner": {"reputation": 441, "user_id": 1136722, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/1fd4f1b0d25534671c37f66ebe1ae068?s=128&d=identicon&r=PG", "display_name": "ali", "link": "https://stackoverflow.com/users/1136722/ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1952, "favorite_count": 0, "accepted_answer_id": 27846510, "answer_count": 2, "score": 2, "last_activity_date": 1420743401, "creation_date": 1420732743, "last_edit_date": 1420738609, "question_id": 27844307, "link": "https://stackoverflow.com/questions/27844307/how-to-download-only-the-beginning-of-a-large-file-with-go-http-client-and-app", "title": "How to download only the beginning of a large file with go http.Client (and app engine urlfetch)", "body": "<p>I'm trying to download only the first 1kb of large files using <code>http.Client</code> in go, but it seems like <code>response.Body</code> is always fully buffered. Is there a control over how much to buffer?</p>\n\n<p>If so, how can this be used with app engine urlfetch service?</p>\n\n<p>The following works fine with app engine urlfetch in python, and I'm trying to port this to go:</p>\n\n<pre><code>from urllib2 import urlopen\nreq = Request(url)\nurlopen(req).read(1024) # Read the first 1kb.\n</code></pre>\n"}, {"tags": ["google-app-engine", "go", "cron", "web-crawler"], "comments": [{"owner": {"reputation": 7107, "user_id": 2675154, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/81fd07359983790419b7ecf5a1098e6c?s=128&d=identicon&r=PG&f=1", "display_name": "honk", "link": "https://stackoverflow.com/users/2675154/honk"}, "edited": false, "score": 1, "creation_date": 1420732853, "post_id": 27843928, "comment_id": 44092402, "body": "Please don&#39;t ask for code examples. It&#39;s better if you include your relevant code directly into the question. Please take the <a href=\"http://stackoverflow.com/tour\">tour</a> and read <a href=\"http://stackoverflow.com/questions/how-to-ask\">How to Ask</a> to learn what we expect from questions."}, {"owner": {"reputation": 53, "user_id": 4404937, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-EO_Qkipeq90/AAAAAAAAAAI/AAAAAAAAMkA/WCV5cliknt0/photo.jpg?sz=128", "display_name": "Wolfgang Tober", "link": "https://stackoverflow.com/users/4404937/wolfgang-tober"}, "reply_to_user": {"reputation": 7107, "user_id": 2675154, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/81fd07359983790419b7ecf5a1098e6c?s=128&d=identicon&r=PG&f=1", "display_name": "honk", "link": "https://stackoverflow.com/users/2675154/honk"}, "edited": false, "score": 0, "creation_date": 1420803200, "post_id": 27843928, "comment_id": 44121695, "body": "Thanks you for the hint. I have updated the description."}], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 4404937, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-EO_Qkipeq90/AAAAAAAAAAI/AAAAAAAAMkA/WCV5cliknt0/photo.jpg?sz=128", "display_name": "Wolfgang Tober", "link": "https://stackoverflow.com/users/4404937/wolfgang-tober"}, "is_accepted": true, "score": 2, "last_activity_date": 1421260216, "creation_date": 1421260216, "answer_id": 27949991, "question_id": 27843928, "link": "https://stackoverflow.com/questions/27843928/execute-a-go-programm-webcrawler-as-a-cron-job-on-google-appengine/27949991#27949991", "title": "Execute a Go programm (webcrawler) as a cron job on Google appengine", "body": "<p>I have found a solution and now the cron job runs and writes comments in the Job Control.</p>\n\n<p>cron.yaml in myproject folder  </p>\n\n<pre><code>cron:\n- description: Ausfuehrung des tasks gcinfo\nurl: /gcinfo\nschedule: every 15 minutes from 05:30 to 23:00\ntimezone: Europe/Berlin\n</code></pre>\n\n<p>app.yaml in the subfolder gcinfo  </p>\n\n<pre><code>application: myproject\nmodule: gcinfo\nversion: 1\nruntime: go\napi_version: go1\n\nhandlers:\n- url: /gcinfo\n  script: _go_app \n</code></pre>\n\n<p>and the key changes in gcinfo.go (gcinfo subfolder)</p>\n\n<pre><code>package gcinfo\n\nimport (\n\"net/http\"\n...\n\"appengine\"\n\"appengine/urlfetch\"\n)\n\nfunc init() {\n http.HandleFunc(\"/gcinfo\", gcinfo)\n}\n...\n\nfunc gcinfo(w http.ResponseWriter, r *http.Request) {\nc := appengine.NewContext(r)\n...\n}\n</code></pre>\n\n<p>Only writing firebase engine does not work with the appengine. I'll have to do more research.</p>\n"}], "owner": {"reputation": 53, "user_id": 4404937, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-EO_Qkipeq90/AAAAAAAAAAI/AAAAAAAAMkA/WCV5cliknt0/photo.jpg?sz=128", "display_name": "Wolfgang Tober", "link": "https://stackoverflow.com/users/4404937/wolfgang-tober"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 673, "favorite_count": 0, "accepted_answer_id": 27949991, "answer_count": 1, "score": 0, "last_activity_date": 1421260216, "creation_date": 1420731640, "last_edit_date": 1420803059, "question_id": 27843928, "link": "https://stackoverflow.com/questions/27843928/execute-a-go-programm-webcrawler-as-a-cron-job-on-google-appengine", "title": "Execute a Go programm (webcrawler) as a cron job on Google appengine", "body": "<p>How can I run a single Go program namend \"gcinfo\" (webcrawler with output in firebase) as a cron in Google appengine?</p>\n\n<p>I was able to create a projekt-ID and upload the Go programm with the App SDK. The cron job was executed   as defined in the cron.yaml every 15 minutes. There was no error. But i find no output in the log and firebase ist not written. After lots of changes in the app.yaml, gcinfo.yaml and cron.yaml with no result or Errors like (Error code 204). I am now totally confused about the settings in the yaml-files.</p>\n\n<p>Can someone give or point me to a simple example of these settings? I want to run a single Go program as a cron in the app engine every 15 minutes.  </p>\n\n<p>My projekt structur is: </p>\n\n<ul>\n<li>myproject folder with app.yaml and cron.yaml</li>\n<li>myproject subfolder \"hello\" with hello.yaml and the simple hello.go example with \"hello world!\"</li>\n<li>myproject subfolder \"gcinfo\" with gcinfo.yaml and gcinfo.go (go webcrawler with firebase-output)\"</li>\n</ul>\n\n<p>app.yaml  </p>\n\n<pre><code>application: myproject\nversion: 1\nruntime: go\napi_version: go1\n\nhandlers:\n- url: /.*\n  script: _go_app\n</code></pre>\n\n<p>cron.yaml  </p>\n\n<pre><code>cron:\n- description: Ausfuehrung des tasks gcinfo\nurl: /gcinfo\nschedule: every 15 minutes from 05:30 to 23:00\ntimezone: Europe/Berlin\ntarget: gcinfo\n</code></pre>\n\n<p>gcinfo.yaml  </p>\n\n<pre><code>application: myproject\nmodule: gcinfo\n#version: 1\nruntime: go\napi_version: go1\n\nhandlers:\n- url: /gcinfo\\.*\nscript: gcinfo\\gcinfo.go\n</code></pre>\n\n<p>My gcinfo.go has the following structure  </p>\n\n<pre><code>package gcinfo\n\nimport (\n...\n)\n\n....\n\nfunc gcinfo() {\n....\n}\n</code></pre>\n\n<p>There are no errors with this configuration in the \"goapp deploy\" and the appengine reacts every 15 minutes for 6ms, but there is no output for the go programm gcinfo. I have already tryed to make gcinfo to main with same result.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "edited": false, "score": 0, "creation_date": 1429495864, "post_id": 27841092, "comment_id": 47609673, "body": "any comment why <code>-1</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 1, "last_activity_date": 1420726776, "creation_date": 1420726776, "answer_id": 27842294, "question_id": 27841092, "link": "https://stackoverflow.com/questions/27841092/when-and-where-to-check-if-channel-wont-get-any-more-data/27842294#27842294", "title": "When and where to check if channel won&#39;t get any more data?", "body": "<p>Checking the <code>len</code> of a channel is always a race, you can't use that for any sort of synchronization.</p>\n\n<p>The producer is always the side that closes a channel, because it's a fatal error to try and send on a closed channel. Don't use a defer here, just close the channel when you're done sending.</p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 4, "last_activity_date": 1420823538, "last_edit_date": 1420823538, "creation_date": 1420811705, "answer_id": 27862130, "question_id": 27841092, "link": "https://stackoverflow.com/questions/27841092/when-and-where-to-check-if-channel-wont-get-any-more-data/27862130#27862130", "title": "When and where to check if channel won&#39;t get any more data?", "body": "<p>Simplest way to wait until all goroutings are done is sync.WaitGroup in sync package</p>\n\n<pre><code>package main\nimport \"sync\"\nvar wg sync.WaitGroup\n//then you do\nfunc Crawl(res Result, fetcher Fetcher) { //what for you pass stor *Stor as arg? It just visible for all goroutings\n    defer wg.Done()\n...\n//why not to spawn new routing just inside Crowl?\n    for res := range urls {\n        wg.Add(1)\n        go Crawl(res,fetcher)\n    }\n...\n}\n...\n//And in main.main()\nfunc main() {\n    wg.Add(1) \n    Crawl(Result{\"http://golang.org/\", 4}, fetcher)\n    ...\n    wg.Wait() //Will block until all routings Done\n}\n</code></pre>\n\n<p>Complete solution will be:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\nvar wg sync.WaitGroup\nvar visited map[string]int = map[string]int{}\n\ntype Result struct {\n    Url string\n    Depth int\n}\n\ntype Fetcher interface {\n    // Fetch returns the body of URL and\n    // a slice of URLs found on that page.\n    Fetch(url string) (body string, urls []string, err error)\n}\n\n// Crawl uses fetcher to recursively crawl\n// pages starting with url, to a maximum of depth.\nfunc Crawl(res Result, fetcher Fetcher) {\n    defer wg.Done()\n    if res.Depth &lt;= 0 {\n        return\n    }\n    // TODO: Don't fetch the same URL twice.\n    url := res.Url\n    visited[url]++\n    if visited[url] &gt; 1 {\n        fmt.Println(\"skip:\",visited[url],url)\n        return\n    }\n    body, urls, err := fetcher.Fetch(url)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }   \n    fmt.Printf(\"found: %s %q\\n\", url, body)\n    for _, u := range urls {\n        wg.Add(1)\n        go Crawl( Result{u,res.Depth-1},fetcher)\n        //stor.Queue &lt;- Result{u,res.Depth-1}\n    }\n    return\n}\n\nfunc main() {\n    wg.Add(1) \n    Crawl(Result{\"http://golang.org/\", 4}, fetcher)\n    wg.Wait()\n}\n\n// fakeFetcher is Fetcher that returns canned results.\ntype fakeFetcher map[string]*fakeResult\n\ntype fakeResult struct {\n    body string\n    urls []string\n}\n\nfunc (f fakeFetcher) Fetch(url string) (string, []string, error) {\n    if res, ok := f[url]; ok {\n        return res.body, res.urls, nil\n    }\n    return \"\", nil, fmt.Errorf(\"not found: %s\", url)\n}\n\n// fetcher is a populated fakeFetcher.\nvar fetcher = fakeFetcher{\n    \"http://golang.org/\": &amp;fakeResult{\n        \"The Go Programming Language\",\n        []string{\n            \"http://golang.org/pkg/\",\n            \"http://golang.org/cmd/\",\n        },\n    },\n    \"http://golang.org/pkg/\": &amp;fakeResult{\n        \"Packages\",\n        []string{\n            \"http://golang.org/\",\n            \"http://golang.org/cmd/\",\n            \"http://golang.org/pkg/fmt/\",\n            \"http://golang.org/pkg/os/\",\n        },\n    },\n    \"http://golang.org/pkg/fmt/\": &amp;fakeResult{\n        \"Package fmt\",\n        []string{\n            \"http://golang.org/\",\n            \"http://golang.org/pkg/\",\n        },\n    },\n    \"http://golang.org/pkg/os/\": &amp;fakeResult{\n        \"Package os\",\n        []string{\n            \"http://golang.org/\",\n            \"http://golang.org/pkg/\",\n        },\n    },\n}\n</code></pre>\n"}], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 27862130, "answer_count": 2, "score": 0, "last_activity_date": 1420823538, "creation_date": 1420723093, "last_edit_date": 1420724502, "question_id": 27841092, "link": "https://stackoverflow.com/questions/27841092/when-and-where-to-check-if-channel-wont-get-any-more-data", "title": "When and where to check if channel won&#39;t get any more data?", "body": "<p>I'm trying to solve <a href=\"http://tour.golang.org/concurrency/9\" rel=\"nofollow\">Exercise: Web Crawler</a></p>\n\n<blockquote>\n  <p>In this exercise you'll use Go's concurrency features to parallelize a\n  web crawler.</p>\n  \n  <p>Modify the Crawl function to fetch URLs in parallel without fetching\n  the same URL twice.</p>\n</blockquote>\n\n<p>When should I check if all urls already been crawled? (or how could I know if there will be no more data queued?)</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Result struct {\n    Url string\n    Depth int\n}\n\ntype Stor struct {\n    Queue  chan Result\n    Visited map[string]int\n}    \n\nfunc NewStor() *Stor {\n    return &amp;Stor{\n        Queue:  make(chan Result,1000),\n        Visited: map[string]int{},\n    }\n}\n\ntype Fetcher interface {\n    // Fetch returns the body of URL and\n    // a slice of URLs found on that page.\n    Fetch(url string) (body string, urls []string, err error)\n}\n\n// Crawl uses fetcher to recursively crawl\n// pages starting with url, to a maximum of depth.\nfunc Crawl(res Result, fetcher Fetcher, stor *Stor) {\n    defer func() {          \n        /*\n        if len(stor.Queue) == 0 {\n            close(stor.Queue)\n        }   \n        */  // this is wrong, it makes the channel closes too early\n    }()\n    if res.Depth &lt;= 0 {\n        return\n    }\n    // TODO: Don't fetch the same URL twice.\n    url := res.Url\n    stor.Visited[url]++\n    if stor.Visited[url] &gt; 1 {\n        fmt.Println(\"skip:\",stor.Visited[url],url)\n        return\n    }\n    body, urls, err := fetcher.Fetch(url)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }   \n    fmt.Printf(\"found: %s %q\\n\", url, body)\n    for _, u := range urls {\n        stor.Queue &lt;- Result{u,res.Depth-1}\n    }\n    return\n}\n\nfunc main() {\n    stor := NewStor()   \n    Crawl(Result{\"http://golang.org/\", 4}, fetcher, stor)\n    for res := range stor.Queue {\n        // TODO: Fetch URLs in parallel.\n        go Crawl(res,fetcher,stor)\n    }\n}\n\n// fakeFetcher is Fetcher that returns canned results.\ntype fakeFetcher map[string]*fakeResult\n\ntype fakeResult struct {\n    body string\n    urls []string\n}\n\nfunc (f fakeFetcher) Fetch(url string) (string, []string, error) {\n    if res, ok := f[url]; ok {\n        return res.body, res.urls, nil\n    }\n    return \"\", nil, fmt.Errorf(\"not found: %s\", url)\n}\n\n// fetcher is a populated fakeFetcher.\nvar fetcher = fakeFetcher{\n    \"http://golang.org/\": &amp;fakeResult{\n        \"The Go Programming Language\",\n        []string{\n            \"http://golang.org/pkg/\",\n            \"http://golang.org/cmd/\",\n        },\n    },\n    \"http://golang.org/pkg/\": &amp;fakeResult{\n        \"Packages\",\n        []string{\n            \"http://golang.org/\",\n            \"http://golang.org/cmd/\",\n            \"http://golang.org/pkg/fmt/\",\n            \"http://golang.org/pkg/os/\",\n        },\n    },\n    \"http://golang.org/pkg/fmt/\": &amp;fakeResult{\n        \"Package fmt\",\n        []string{\n            \"http://golang.org/\",\n            \"http://golang.org/pkg/\",\n        },\n    },\n    \"http://golang.org/pkg/os/\": &amp;fakeResult{\n        \"Package os\",\n        []string{\n            \"http://golang.org/\",\n            \"http://golang.org/pkg/\",\n        },\n    },\n}\n</code></pre>\n\n<p>The output was a deadlock since the <code>stor.Queue</code> channel never closed.</p>\n"}, {"tags": ["linux", "go", "gccgo"], "comments": [{"owner": {"reputation": 1855, "user_id": 1558705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1563795271fe55bf0beab2d12cd69b0?s=128&d=identicon&r=PG", "display_name": "Dean Elbaz", "link": "https://stackoverflow.com/users/1558705/dean-elbaz"}, "edited": false, "score": 0, "creation_date": 1420730669, "post_id": 27841032, "comment_id": 44090788, "body": "can you tell us what version of gcc and go you are using?"}, {"owner": {"reputation": 1387, "user_id": 2301484, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/05301156f430e42f5e4022f46ebc2220?s=128&d=identicon&r=PG", "display_name": "Grayda", "link": "https://stackoverflow.com/users/2301484/grayda"}, "reply_to_user": {"reputation": 1855, "user_id": 1558705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1563795271fe55bf0beab2d12cd69b0?s=128&d=identicon&r=PG", "display_name": "Dean Elbaz", "link": "https://stackoverflow.com/users/1558705/dean-elbaz"}, "edited": false, "score": 0, "creation_date": 1420771220, "post_id": 27841032, "comment_id": 44110051, "body": "@DeanElbaz running <code>gccgo --version</code> reports that it&#39;s Ubuntu 4.9.1-0ubuntu1. running <code>gcc --version</code> reports that&#39;s Ubuntu 4.8.2-19ubuntu1.  I&#39;m wondering this has anything to do with it, as I had originally installed golang via apt-get before removing it and updating to the latest version. I&#39;m au fait with Linux, but these differing versions do my head in sometimes."}, {"owner": {"reputation": 1387, "user_id": 2301484, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/05301156f430e42f5e4022f46ebc2220?s=128&d=identicon&r=PG", "display_name": "Grayda", "link": "https://stackoverflow.com/users/2301484/grayda"}, "reply_to_user": {"reputation": 1855, "user_id": 1558705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1563795271fe55bf0beab2d12cd69b0?s=128&d=identicon&r=PG", "display_name": "Dean Elbaz", "link": "https://stackoverflow.com/users/1558705/dean-elbaz"}, "edited": false, "score": 0, "creation_date": 1420794453, "post_id": 27841032, "comment_id": 44117150, "body": "@DeanElbaz spent the last bunch of hours compiling gccgo (and gcc, and g++) from source and it&#39;s still doing the same thing. It&#39;s got to be a sub-process that doesn&#39;t know <code>-marm</code>, but I don&#39;t know which one."}], "answers": [{"tags": [], "owner": {"reputation": 1387, "user_id": 2301484, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/05301156f430e42f5e4022f46ebc2220?s=128&d=identicon&r=PG", "display_name": "Grayda", "link": "https://stackoverflow.com/users/2301484/grayda"}, "is_accepted": true, "score": 0, "last_activity_date": 1420802615, "creation_date": 1420802615, "answer_id": 27859492, "question_id": 27841032, "link": "https://stackoverflow.com/questions/27841032/golang-cross-compilation-gccgo-unrecognized-command-line-option-marm/27859492#27859492", "title": "Golang cross-compilation: gccgo - unrecognized command line option `-marm`", "body": "<p>So thanks to a clue by Dean, I've worked out the issue and solved it.</p>\n\n<p>The issue was caused by me installing Go via apt-get, then removing it (via apt-get), then installing Go from the golang website. There were still files left over from the first install, which were probably older versions and therefore didn't have support for the <code>-marm</code> flag.</p>\n\n<p>I was going to wipe my dev machine anyway, so I did, installed Ubuntu again, installed Go from the website (not via apt-get) and everything worked first time. If you don't want to wipe your machine, then just make sure to look around to see if there are version conflicts.</p>\n\n<p>I've been stung by this sort of thing before (when installing node.js via apt-get, realising it was many versions out of date, then removing, and installing node.js via source), so if anyone is reading this, <strong>be careful when installing software via apt-get, then upgrading, as you might have similar version issues like I did!</strong></p>\n"}], "owner": {"reputation": 1387, "user_id": 2301484, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/05301156f430e42f5e4022f46ebc2220?s=128&d=identicon&r=PG", "display_name": "Grayda", "link": "https://stackoverflow.com/users/2301484/grayda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2528, "favorite_count": 0, "accepted_answer_id": 27859492, "answer_count": 1, "score": 1, "last_activity_date": 1420802615, "creation_date": 1420722900, "last_edit_date": 1592644375, "question_id": 27841032, "link": "https://stackoverflow.com/questions/27841032/golang-cross-compilation-gccgo-unrecognized-command-line-option-marm", "title": "Golang cross-compilation: gccgo - unrecognized command line option `-marm`", "body": "<p>I'm trying to compile a Go app for linux/arm and keep running into problems on my Ubuntu machine. When I run <code>GOOS=linux GOARCH=arm go build</code> in my source directory, I get tons of erorrs that are variations of:</p>\n<blockquote>\n<p># github.com/huin/mqtt</p>\n<p>gccgo: error: unrecognized command line option `-marm`</p>\n</blockquote>\n<p>Running <code>gccgo --help</code> informs me that options starting with -g, -f -m (and others) will be passed on to any sub-processes started by gccgo, so I don't know which process it's sending -marm to.</p>\n<p>Any clues? Ubuntu 14.10 LTS, 64bit</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-elastic-beanstalk", "amazon-elb", "web-architecture"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1420720916, "post_id": 27839586, "comment_id": 44084266, "body": "The title of the question and the question ask different things completely. Do you want to benchmark or simplify your deployment?"}, {"owner": {"reputation": 284, "user_id": 1203498, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e9db696df75c50f6709fb07b11a0028b?s=128&d=identicon&r=PG", "display_name": "macguy", "link": "https://stackoverflow.com/users/1203498/macguy"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1420722681, "post_id": 27839586, "comment_id": 44085426, "body": "I want to benchmark and then improve (by simplifying deployment and any other means necessary)"}], "answers": [{"comments": [{"owner": {"reputation": 284, "user_id": 1203498, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e9db696df75c50f6709fb07b11a0028b?s=128&d=identicon&r=PG", "display_name": "macguy", "link": "https://stackoverflow.com/users/1203498/macguy"}, "edited": false, "score": 0, "creation_date": 1420725117, "post_id": 27841121, "comment_id": 44087106, "body": "Thank you for answering. It&#39;s a startup I&#39;m doing, and if it succeeds, scaling it will be my next step. I&#39;ll obviously need it to be fault-redundant, have high-availability, master-read replicas and whatsnot."}, {"owner": {"reputation": 284, "user_id": 1203498, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e9db696df75c50f6709fb07b11a0028b?s=128&d=identicon&r=PG", "display_name": "macguy", "link": "https://stackoverflow.com/users/1203498/macguy"}, "edited": false, "score": 0, "creation_date": 1420726047, "post_id": 27841121, "comment_id": 44087731, "body": "I&#39;ll admit, I went with the load balancer for the ssl (at first). I was thinking of maxing out on vertical scaling, and handling horizontal scaling when the time comes.  Concerning atomicity, I&#39;m not too sure how the application will perform.   As for managing the ssl certificate, I&#39;d rather go with the fastest option.   I developed the application in go, thinking if things go well, a chat component could be added.   It sounds like elasticbeanstalk might not be adequate. Wouldn&#39;t launching an EC2 instance, and manually installing go be best?"}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "reply_to_user": {"reputation": 284, "user_id": 1203498, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e9db696df75c50f6709fb07b11a0028b?s=128&d=identicon&r=PG", "display_name": "macguy", "link": "https://stackoverflow.com/users/1203498/macguy"}, "edited": false, "score": 0, "creation_date": 1420726098, "post_id": 27841121, "comment_id": 44087763, "body": "@macguy No problem, please note that my answer is basically a bunch of questions. These shouldn&#39;t be taken as criticisms, and there are  probably valid reasons for all of the components in your suggested setup. It is, however, worth asking the &quot;how can I simplify this?&quot; question all the time. Good luck on the startup!"}, {"owner": {"reputation": 284, "user_id": 1203498, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e9db696df75c50f6709fb07b11a0028b?s=128&d=identicon&r=PG", "display_name": "macguy", "link": "https://stackoverflow.com/users/1203498/macguy"}, "edited": false, "score": 0, "creation_date": 1420726271, "post_id": 27841121, "comment_id": 44087870, "body": "On the contrary, believe me when I say this: I&#39;m highly appreciative! I&#39;m asking all these questions because I&#39;m learning things as I go and I&#39;m really not convinced with my current infrastructure. I completely agree: not asking these questions will definitely lead to problems in the future."}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "reply_to_user": {"reputation": 284, "user_id": 1203498, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e9db696df75c50f6709fb07b11a0028b?s=128&d=identicon&r=PG", "display_name": "macguy", "link": "https://stackoverflow.com/users/1203498/macguy"}, "edited": false, "score": 0, "creation_date": 1420726282, "post_id": 27841121, "comment_id": 44087877, "body": "@macguy &quot;Wouldn&#39;t launching an EC2 instance, and manually installing go be best?&quot; Depends on how Amazon go with their container runtime stuff. I&#39;m playing with Google&#39;s stuff at the moment, and I think CoreOS and a few others are worth keeping an eye on... This space is moving fast :-)"}, {"owner": {"reputation": 284, "user_id": 1203498, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e9db696df75c50f6709fb07b11a0028b?s=128&d=identicon&r=PG", "display_name": "macguy", "link": "https://stackoverflow.com/users/1203498/macguy"}, "edited": false, "score": 0, "creation_date": 1420726356, "post_id": 27841121, "comment_id": 44087930, "body": "Yeah other platforms are worth looking into :)"}, {"owner": {"reputation": 284, "user_id": 1203498, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e9db696df75c50f6709fb07b11a0028b?s=128&d=identicon&r=PG", "display_name": "macguy", "link": "https://stackoverflow.com/users/1203498/macguy"}, "edited": false, "score": 0, "creation_date": 1420726559, "post_id": 27841121, "comment_id": 44088080, "body": "I gather there&#39;s no other way than trial and error (removing components 1 by 1) to find out the slowdown culprit?"}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "reply_to_user": {"reputation": 284, "user_id": 1203498, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e9db696df75c50f6709fb07b11a0028b?s=128&d=identicon&r=PG", "display_name": "macguy", "link": "https://stackoverflow.com/users/1203498/macguy"}, "edited": false, "score": 0, "creation_date": 1420726949, "post_id": 27841121, "comment_id": 44088330, "body": "@macguy That may work, but you&#39;re better off replacing the Go app with something really simple (A &quot;Hello world&quot; web server) and seeing if the performance drastically increases. If so, then look into RDS or application slowness. If not, it&#39;s something else. (elastic beanstalk, ELB, DNS etc). Work out the systems that could be causing the slowness, list them in order of operation, then divide and conquer :-)"}, {"owner": {"reputation": 284, "user_id": 1203498, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e9db696df75c50f6709fb07b11a0028b?s=128&d=identicon&r=PG", "display_name": "macguy", "link": "https://stackoverflow.com/users/1203498/macguy"}, "reply_to_user": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 0, "creation_date": 1420727095, "post_id": 27841121, "comment_id": 44088431, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/68416/discussion-between-macguy-and-intermernet\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "is_accepted": true, "score": 2, "last_activity_date": 1420725222, "last_edit_date": 1420725222, "creation_date": 1420723203, "answer_id": 27841121, "question_id": 27839586, "link": "https://stackoverflow.com/questions/27839586/i-am-running-a-rest-api-server-and-im-not-too-sure-about-the-infrastructure-al/27841121#27841121", "title": "I am running a REST API server and I&#39;m not too sure about the infrastructure. Also what can I do to benchmark and improve speed?", "body": "<p>The answer to your header question <strong><em>\"How do I benchmark (tried ping, traceroute, pingdom) and improve speed?\"</em></strong> is probably best answered by searching for \"website benchmarking\" or similar. There are <em>many</em> website benchmarking tools out there. (have a look at <a href=\"http://www.joedog.org/siege-home/\" rel=\"nofollow\">Siege</a>, <a href=\"http://httpd.apache.org/docs/2.2/programs/ab.html\" rel=\"nofollow\">ab</a>, <a href=\"https://github.com/tarekziade/boom\" rel=\"nofollow\">boom</a>, <a href=\"https://github.com/rakyll/boom\" rel=\"nofollow\">boom in Go</a>, or <a href=\"https://github.com/tsenart/vegeta\" rel=\"nofollow\">vegeta</a>. There are many more out there, but that should get you started.)</p>\n\n<p>The answer to <strong><em>\"It looks overly complicated, what is the best way to simplify?\"</em></strong> is:</p>\n\n<p>What do you need it to do?</p>\n\n<p>For a simple, static site, your setup is overly complex. For a distributed, fault redundant, high-availability site, it's nowhere near enough. You need to fit your infrastructure to your needs.</p>\n\n<p><strong><em>\"route53 api.domain cname pointing to a to self-signed ssl-enabled elb (having 1 elasticbeanstalk instance):\"</em></strong> Do you need the load balancer? Are you going to add more endpoints? Does the application support load balancing in this way? (will requests be treated atomically, are all requests unique etc.)</p>\n\n<p><strong><em>\"nginx forwards to docker instance:\"</em></strong> Do you want to manage the SSL certificate in the Go app, or the NginX config? The way you're running it now is probably the simplest for now, but once again, it depends on your needs.</p>\n\n<p><strong><em>\"Docker instance has nginx which serves static files, and reverse-proxies to golang (fastcgi to port 3000):\"</em></strong> This sounds overly complex (but, it depends on what you want). Can this replaced with nginx just serving a directory of static files on that path? Do you need fastCGI at all here?</p>\n\n<p><strong><em>\" Data is stored on Amazon RDS and is accessed using go-sql-driver:\"</em></strong> This is fine for AWS, once again, depending on your requirements (performance, compliance etc.)</p>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 284, "user_id": 1203498, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e9db696df75c50f6709fb07b11a0028b?s=128&d=identicon&r=PG", "display_name": "macguy", "link": "https://stackoverflow.com/users/1203498/macguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 27841121, "answer_count": 1, "score": 0, "last_activity_date": 1420725428, "creation_date": 1420718132, "last_edit_date": 1420725428, "question_id": 27839586, "link": "https://stackoverflow.com/questions/27839586/i-am-running-a-rest-api-server-and-im-not-too-sure-about-the-infrastructure-al", "title": "I am running a REST API server and I&#39;m not too sure about the infrastructure. Also what can I do to benchmark and improve speed?", "body": "<p>My infrastructure is: gandi domain, aws dns, route53 api.domain cname pointing to a to self-signed ssl-enabled elb (having 1 elasticbeanstalk instance). Elasticbeanstalk instance is docker-based. That means nginx forwards to docker instance. Docker instance has nginx which serves static files, and reverse-proxies to golang (fastcgi to port 3000). Data is stored on Amazon RDS and is accessed using go-sql-driver.</p>\n\n<p>It looks overly complicated, what is the best way to simplify?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "edited": false, "score": 2, "creation_date": 1420717106, "post_id": 27839140, "comment_id": 44082232, "body": "Read should read the data to a supplied buffer, not append to it."}, {"owner": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "edited": false, "score": 0, "creation_date": 1495626749, "post_id": 27839140, "comment_id": 75331459, "body": "answers: <a href=\"https://gist.github.com/inancgumus/d25d045b4cec43dcbb111e04980d396b\" rel=\"nofollow noreferrer\">gist.github.com/inancgumus/d25d045b4cec43dcbb111e04980d396b</a>"}, {"owner": {"reputation": 3662, "user_id": 179438, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9bd9a8a0dbba9f6aa56b78304f231f1a?s=128&d=identicon&r=PG", "display_name": "Alessandro De Simone", "link": "https://stackoverflow.com/users/179438/alessandro-de-simone"}, "edited": false, "score": 3, "creation_date": 1605108006, "post_id": 27839140, "comment_id": 114551586, "body": "Got the same issue, this Go exercise is very confusing."}], "answers": [{"comments": [{"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 9, "creation_date": 1420717420, "post_id": 27839295, "comment_id": 44082388, "body": "You could do it almost as your original implementation too, and just supply 1 byte at a time, i.e. <code>b[0] = &#39;A&#39;  return 1, nil</code>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 1, "creation_date": 1420718103, "post_id": 27839295, "comment_id": 44082777, "body": "@nos Using <code>b[0] = &#39;A&#39;</code> should come with a length check: <code>if len(b) &gt; 0 {b[0] = &#39;A&#39;}</code> which is implicit in case of using <code>for ... range</code>."}], "tags": [], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "is_accepted": true, "score": 44, "last_activity_date": 1423566681, "last_edit_date": 1423566681, "creation_date": 1420717273, "answer_id": 27839295, "question_id": 27839140, "link": "https://stackoverflow.com/questions/27839140/solution-for-http-tour-golang-org-methods-11/27839295#27839295", "title": "Solution for http://tour.golang.org/methods/11", "body": "<p>Ah I understand XD</p>\n\n<p>I think it would be better to say: \"rewrite all values in <code>[]byte</code> into <code>'A'</code>s\"</p>\n\n<pre><code>package main\n\nimport \"code.google.com/p/go-tour/reader\"\n\ntype MyReader struct{}\n\n// TODO: Add a Read([]byte) (int, error) method to MyReader.\nfunc (m MyReader) Read(b []byte) (i int, e error) {\n    for x := range b {\n        b[x] = 'A'\n    }\n    return len(b), nil\n}\n\nfunc main() {\n    reader.Validate(MyReader{})\n}\n</code></pre>\n"}], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8405, "favorite_count": 3, "accepted_answer_id": 27839295, "answer_count": 1, "score": 20, "last_activity_date": 1452809679, "creation_date": 1420716759, "question_id": 27839140, "link": "https://stackoverflow.com/questions/27839140/solution-for-http-tour-golang-org-methods-11", "title": "Solution for http://tour.golang.org/methods/11", "body": "<p><a href=\"http://tour.golang.org/methods/11\" rel=\"noreferrer\">Exercise: Readers</a></p>\n\n<p>Implement a Reader type that emits an infinite stream of the ASCII character 'A'.</p>\n\n<p>I don't understand the question, how to emit character 'A'? into which variable should I set that character?</p>\n\n<p>Here's what I tried:</p>\n\n<pre><code>package main\nimport \"code.google.com/p/go-tour/reader\"\ntype MyReader struct{}\n// TODO: Add a Read([]byte) (int, error) method to MyReader.\nfunc (m MyReader) Read(b []byte) (i int, e error) {\n    b = append(b,'A') // this is wrong..\n    return 1, nil // this is also wrong..\n}\nfunc main() {\n    reader.Validate(MyReader{}) // what did this function expect?\n}\n</code></pre>\n"}, {"tags": ["sql", "postgresql", "go"], "comments": [{"owner": {"reputation": 257364, "user_id": 398670, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/85f50c23bb5e9dfb061af5032bfe8e65?s=128&d=identicon&r=PG", "display_name": "Craig Ringer", "link": "https://stackoverflow.com/users/398670/craig-ringer"}, "edited": false, "score": 2, "creation_date": 1420721005, "post_id": 27835828, "comment_id": 44084323, "body": "The underlying PostgreSQL <code>COPY</code> command does not provide a way to return a resultset for generated columns. So no, there isn&#39;t, except for querying the table to match the inserted data and looking up any generated keys."}, {"owner": {"reputation": 520, "user_id": 992315, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/1fd1d5398d12bc8b08086c3da899b868?s=128&d=identicon&r=PG", "display_name": "zero-divisor", "link": "https://stackoverflow.com/users/992315/zero-divisor"}, "reply_to_user": {"reputation": 257364, "user_id": 398670, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/85f50c23bb5e9dfb061af5032bfe8e65?s=128&d=identicon&r=PG", "display_name": "Craig Ringer", "link": "https://stackoverflow.com/users/398670/craig-ringer"}, "edited": false, "score": 0, "creation_date": 1420723371, "post_id": 27835828, "comment_id": 44085894, "body": "@CraigRinger Yes, but as it is possible from a Postgres standpoint (using <code>INSERT INTO ... RETURNING id</code>), I thought there should be a way for realizing this with the <code>pq</code> package."}, {"owner": {"reputation": 257364, "user_id": 398670, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/85f50c23bb5e9dfb061af5032bfe8e65?s=128&d=identicon&r=PG", "display_name": "Craig Ringer", "link": "https://stackoverflow.com/users/398670/craig-ringer"}, "edited": false, "score": 0, "creation_date": 1420723616, "post_id": 27835828, "comment_id": 44086049, "body": "Yes, there is ... use <code>INSERT INTO ... RETURNING</code>, possibly with a multi-entry <code>VALUES</code> list. There is no equivalent for <code>COPY</code>, which is what the documentation for your <code>pq</code> package&#39;s bulk load method suggests it is using. I guess you&#39;d have to write another bulk-load variant function for <code>pq</code> that uses batched <code>INSERT INTO ... VALUES (...), (...), (...), ... RETURNING ...</code> queries instead. Or implement <code>COPY ... RETURNING ...</code> :p"}], "answers": [{"tags": [], "owner": {"reputation": 845, "user_id": 1953383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/234e060abc5bd5a0d2b7e46feea1262e?s=128&d=identicon&r=PG", "display_name": "twboc", "link": "https://stackoverflow.com/users/1953383/twboc"}, "is_accepted": false, "score": 0, "last_activity_date": 1474240287, "creation_date": 1474240287, "answer_id": 39563501, "question_id": 27835828, "link": "https://stackoverflow.com/questions/27835828/golang-pq-sql-driver-get-record-ids-after-bulk-import/39563501#39563501", "title": "Golang pq sql driver: get record ids after bulk import", "body": "<p>I assume that the id column that you are referring to in your COPY statement is based on a serial generation sequence as created by this type of statement:</p>\n\n<pre><code>CREATE SEQUENCE my_serial_name;\n</code></pre>\n\n<p>This means that you can query the current value of the id like this:</p>\n\n<pre><code>SELECT currval('my_serial_name');\n</code></pre>\n\n<p>Which will return the current value of the id counter.</p>\n\n<p>As answering any further doubts about this method:</p>\n\n<ul>\n<li>this statement is <strong>local to the thread and fully isolated</strong>,</li>\n<li>the above statement proves this method to be <strong>useful in a multi user environment and will produce correct value not modified by other insert queries</strong> performed on tables using this sequence</li>\n</ul>\n\n<p>For further reading please refer to urls stating that:</p>\n\n<blockquote>\n  <p>The sequence functions, listed in Table 9-42 (currval included),\n  provide simple, multiuser-safe methods for obtaining successive\n  sequence values from sequence objects.</p>\n</blockquote>\n\n<p><a href=\"https://www.postgresql.org/docs/9.3/static/functions-sequence.html\" rel=\"nofollow\">https://www.postgresql.org/docs/9.3/static/functions-sequence.html</a></p>\n\n<blockquote>\n  <p>Because nextval and setval calls are never rolled back, sequence\n  objects cannot be used if \"gapless\" assignment of sequence numbers is\n  needed. It is possible to build gapless assignment by using exclusive\n  locking of a table containing a counter; but this solution is much\n  more expensive than sequence objects, especially if many transactions\n  need sequence numbers concurrently.</p>\n</blockquote>\n\n<p><a href=\"https://www.postgresql.org/docs/9.5/static/sql-createsequence.html\" rel=\"nofollow\">https://www.postgresql.org/docs/9.5/static/sql-createsequence.html</a></p>\n\n<blockquote>\n  <p>To set the transaction isolation level of a transaction, use the\n  command SET TRANSACTION.</p>\n  \n  <p>Important: Some PostgreSQL data types and functions have special rules\n  regarding transactional behavior. In particular, changes made to a\n  sequence (and therefore the counter of a column declared using serial)\n  are immediately visible to all other transactions and are not rolled\n  back if the transaction that made the changes aborts. See Section 9.16\n  and Section 8.1.4.</p>\n</blockquote>\n\n<p><a href=\"https://www.postgresql.org/docs/9.5/static/transaction-iso.html\" rel=\"nofollow\">https://www.postgresql.org/docs/9.5/static/transaction-iso.html</a></p>\n\n<p>I hope that this answers your question. Postgresql is a great database and can become a very powerful tool when mastered in details. Good luck! :D</p>\n"}], "owner": {"reputation": 520, "user_id": 992315, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/1fd1d5398d12bc8b08086c3da899b868?s=128&d=identicon&r=PG", "display_name": "zero-divisor", "link": "https://stackoverflow.com/users/992315/zero-divisor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 863, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1474240287, "creation_date": 1420705850, "last_edit_date": 1420708254, "question_id": 27835828, "link": "https://stackoverflow.com/questions/27835828/golang-pq-sql-driver-get-record-ids-after-bulk-import", "title": "Golang pq sql driver: get record ids after bulk import", "body": "<p>Using the pq sql driver for golang, I'm the doing a bulk import as described <a href=\"http://godoc.org/github.com/lib/pq#hdr-Bulk_imports\" rel=\"nofollow\">in the pq docs</a>. Is there a way I can get the ids of the created records? </p>\n"}, {"tags": ["android", "windows", "go"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1420699090, "creation_date": 1420699090, "answer_id": 27834318, "question_id": 27832119, "link": "https://stackoverflow.com/questions/27832119/golang-for-android-on-windows/27834318#27834318", "title": "Golang for Android on Windows?", "body": "<p>No, the all process is tied to Linux (<code>FROM ubuntu:12.04</code> in the <a href=\"https://github.com/golang/mobile/blob/master/Dockerfile\" rel=\"nofollow\">Dockerfile</a>).</p>\n\n<p>That means you would need to have on Windows a Docker-compliant environment (<a href=\"https://github.com/boot2docker/windows-installer/releases\" rel=\"nofollow\">like a boot2docker</a>) in order to launch the </p>\n\n<pre><code>docker run -v $GOPATH/src:/src mobile /bin/bash -c 'cd /src/your/project &amp;&amp; ./make.bash'\n</code></pre>\n"}], "owner": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1420699090, "creation_date": 1420684830, "question_id": 27832119, "link": "https://stackoverflow.com/questions/27832119/golang-for-android-on-windows", "title": "Golang for Android on Windows?", "body": "<p>I haven't read anything explicitly stating that you can't use Windows but everything that does <a href=\"https://code.google.com/p/go/source/browse/README?repo=mobile\" rel=\"nofollow\">walk you through what to do</a> seems to involve running a .sh file. Has anybody had any luck compiling any kind of Go for Android, whether it be a library or a full native activity?</p>\n"}]