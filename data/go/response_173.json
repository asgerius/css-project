[{"tags": ["shell", "go", "process", "graphviz"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 6, "creation_date": 1525304579, "post_id": 50144988, "comment_id": 87308113, "body": "<code>&gt;</code> is a shell feature. In your case cannot you just read from the <code>cmd.StdoutPipe()</code>?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1525330418, "post_id": 50144988, "comment_id": 87315329, "body": "What is a dot script?"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1525334487, "post_id": 50144988, "comment_id": 87317478, "body": "@Flimzy <a href=\"https://en.wikipedia.org/wiki/DOT_(graph_description_language)\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/DOT_(graph_description_language)</a>"}, {"owner": {"reputation": 700, "user_id": 5668464, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/caaa9a33119f603eebf2ace9844c61c2?s=128&d=identicon&r=PG&f=1", "display_name": "ArafatK", "link": "https://stackoverflow.com/users/5668464/arafatk"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1525335216, "post_id": 50144988, "comment_id": 87317906, "body": "@zerkms I mean, I want to write the output to a png file directly?"}], "answers": [{"tags": [], "owner": {"reputation": 700, "user_id": 5668464, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/caaa9a33119f603eebf2ace9844c61c2?s=128&d=identicon&r=PG&f=1", "display_name": "ArafatK", "link": "https://stackoverflow.com/users/5668464/arafatk"}, "is_accepted": true, "score": 0, "last_activity_date": 1525338902, "creation_date": 1525338902, "answer_id": 50151253, "question_id": 50144988, "link": "https://stackoverflow.com/questions/50144988/how-to-run-a-graphviz-process-with-a-dot-script-from-a-go-program/50151253#50151253", "title": "How to run a graphviz process with a dot script from a Go program?", "body": "<p>As mentioned before by @zerkms you can use cmd.StdoutPipe() instead of \">\".<br>\nHowever there is a much simpler way to solve this problem </p>\n\n<pre><code>package main\n\nimport (\n   \"io/ioutil\"\n   \"os\"\n   \"os/exec\"\n)\n\nfunc main() {\npath, _ := exec.LookPath(\"dot\")\ncmd, _ := exec.Command(path, \"-Tpng\", \"/Users/arafat/Desktop/dev/go/src/github.com/Arafatk/dataviz/DotExamples/arraylist.dot\").Output()\nmode := int(0777)\n   ioutil.WriteFile(\"outfile.png\", cmd, os.FileMode(mode))\n}\n</code></pre>\n"}], "owner": {"reputation": 700, "user_id": 5668464, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/caaa9a33119f603eebf2ace9844c61c2?s=128&d=identicon&r=PG&f=1", "display_name": "ArafatK", "link": "https://stackoverflow.com/users/5668464/arafatk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 50151253, "answer_count": 1, "score": -2, "last_activity_date": 1525341972, "creation_date": 1525304446, "last_edit_date": 1525341972, "question_id": 50144988, "link": "https://stackoverflow.com/questions/50144988/how-to-run-a-graphviz-process-with-a-dot-script-from-a-go-program", "title": "How to run a graphviz process with a dot script from a Go program?", "body": "<p>I want to run a dot script that outputs to an image.<br>\nHow do I call it from Golang?    </p>\n\n<pre><code>package main\n\nimport (\n\"fmt\"\n\n\"os/exec\"\n)\n\nfunc main() {\npath, err := exec.LookPath(\"dot\")\ncmd := exec.Command(path, \"-Tpng\", \"/Users/arafat/Desktop/dev/go/src/github.com/Arafatk/dataviz/DotExamples/arraylist.dot\", \"&gt;\", \"/Users/arafat/Desktop/dev/go/src/github.com/Arafatk/dataviz/hello.png\")\nerr = cmd.Run()\n\nfmt.Println(path)\nif err != nil {\n    println(err.Error())\n    return\n}\n}\n</code></pre>\n\n<p>This is my code which gives exit code 3.    </p>\n\n<p>@zerkms<br>\nSorry, I can do that I am just confused because this code does not give any output except nil.          </p>\n\n<pre><code>path, _ := exec.LookPath(\"dot\")       \ncmd := exec.Command(path, \"-Tpng\", \"/Users/arafat/Desktop/dev/go/src/github.com/Arafatk/dataviz/DotExamples/arraylist.dot\")        \nout := cmd.Run()       \nfmt.Println(out)         \n</code></pre>\n\n<p>But this command line function works       </p>\n\n<pre><code>dot -Tpng  /Users/arafat/Desktop/dev/go/src/github.com/Arafatk/dataviz/DotExamples/arraylist.dot           \n</code></pre>\n\n<p>Can you tell me how to actually use the function above in Golang?</p>\n"}, {"tags": ["go", "checkout-payments"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1525330402, "post_id": 50144423, "comment_id": 87315322, "body": "What did you learn when you read the docs from checkout.com relating to that error message?"}, {"owner": {"reputation": 19, "user_id": 2170524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j4BVD.png?s=128&g=1", "display_name": "dzyanis", "link": "https://stackoverflow.com/users/2170524/dzyanis"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1525354993, "post_id": 50144423, "comment_id": 87330891, "body": "That was a question! Actually, there is no good explanation what exactly is wrong. However, I&#39;ve got a right answer! Thank you for you attention! @Flimzy"}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 1716965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0297bafaa385d7acefd138c5a8ac031?s=128&d=identicon&r=PG", "display_name": "n2oula", "link": "https://stackoverflow.com/users/1716965/n2oula"}, "is_accepted": true, "score": 1, "last_activity_date": 1525354489, "creation_date": 1525354489, "answer_id": 50156405, "question_id": 50144423, "link": "https://stackoverflow.com/questions/50144423/checkout-com-returns-error-invalid-payment-currency/50156405#50156405", "title": "Checkout.com returns error invalid payment currency", "body": "<p>To be able to test alternative payment methods these methods would need to be enabled on your Checkout.com Sandbox account. Only card payments are enabled by default.</p>\n\n<p>To do so you need to get in touch with Checkout.com's support team and they will do the required configuration on your account.</p>\n"}], "owner": {"reputation": 19, "user_id": 2170524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j4BVD.png?s=128&g=1", "display_name": "dzyanis", "link": "https://stackoverflow.com/users/2170524/dzyanis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 50156405, "answer_count": 1, "score": -1, "last_activity_date": 1525354489, "creation_date": 1525299866, "question_id": 50144423, "link": "https://stackoverflow.com/questions/50144423/checkout-com-returns-error-invalid-payment-currency", "title": "Checkout.com returns error invalid payment currency", "body": "<p>I'm working on the <a href=\"https://github.com/dzyanis/checkout-go-library\" rel=\"nofollow noreferrer\">Checkout.com API integration for golang</a>.\nI chose checkout.com for several alternative providers like Sofort and iDEAL. There are a good documentation for both of them:</p>\n\n<ul>\n<li><a href=\"https://docs.checkout.com/getting-started/merchant-api/alternative-payments/sofort\" rel=\"nofollow noreferrer\">Sofort</a></li>\n<li><a href=\"https://docs.checkout.com/getting-started/merchant-api/alternative-payments/ideal/complete-ideal-charge\" rel=\"nofollow noreferrer\">iDEAL</a></li>\n</ul>\n\n<p>but code from the example returns the same error</p>\n\n<pre><code>curl https://sandbox.checkout.com/api2/v2/tokens/payment \\\n-H \"Authorization: sk_test_...\" \\\n-H \"Content-Type: application/json\" \\\n-X POST \\\n-d '{\n\"email\" : \"test@email.com\",\n    \"value\": 1000,\n    \"currency\": \"EUR\",\n    \"chargeMode\": \"3\",\n    \"successUrl\": \"http://mycustomerurl.com/order?result=pass\",\n    \"failUrl\": \"http://mycustomerurl.com/order?result=fail\"\n}'\n</code></pre>\n\n<p>returns</p>\n\n<pre><code>{\"id\":\"pay_tok_7A0B43FF-C418-4C54-811D-704279BB5AAA\",\"liveMode\":false}\n</code></pre>\n\n<p>after this payment token is used for</p>\n\n<pre><code>curl https://sandbox.checkout.com/api2/v2/charges/localpayment \\\n-H \"Authorization: sk_test_...\" \\\n-H \"Content-Type: application/json\" \\\n-X POST \\\n-d '{\n    \"email\" : \"test@email.com\",\n    \"localPayment\" : {\n    \"lppId\" : \"lpp_14\",\n    \"userData\" : {}\n    },\n   \"paymentToken\" : \"pay_tok_7A0B43FF-C418-4C54-811D-704279BB5AAA\"\n}'\n</code></pre>\n\n<p>and here we are</p>\n\n<pre><code>{\"errorCode\":\"81001\",\"message\":\"Invalid payment currency\",\"eventId\":\"11e5a092-425e-4db9-910e-f26024a0e007\"}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1525297891, "post_id": 50144039, "comment_id": 87306402, "body": "<code>fmt</code> is a package, not an object, so there&#39;s no way to list it&#39;s contents. I think you&#39;re looking godoc?"}], "answers": [{"comments": [{"owner": {"reputation": 3356, "user_id": 4641680, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/wBb3t.jpg?s=128&g=1", "display_name": "Reza Saadati", "link": "https://stackoverflow.com/users/4641680/reza-saadati"}, "edited": false, "score": 0, "creation_date": 1525300525, "post_id": 50144153, "comment_id": 87307236, "body": "Great answer! Thank you!"}], "tags": [], "owner": {"reputation": 6198, "user_id": 2020002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t9iFY.jpg?s=128&g=1", "display_name": "Derek Pollard", "link": "https://stackoverflow.com/users/2020002/derek-pollard"}, "is_accepted": false, "score": 1, "last_activity_date": 1525300547, "last_edit_date": 1525300547, "creation_date": 1525298350, "answer_id": 50144153, "question_id": 50144039, "link": "https://stackoverflow.com/questions/50144039/return-all-contents-within-an-object/50144153#50144153", "title": "Return all contents within an object", "body": "<h3>GO <a href=\"https://golang.org/doc/faq#Is_Go_an_object-oriented_language\" rel=\"nofollow noreferrer\">OOP</a>, &amp; <a href=\"https://golang.org/doc/faq#inheritance\" rel=\"nofollow noreferrer\">inheritance</a></h3>\n\n<p>Go does not have objects, but we do have custom types and interfaces that we can attach attributes, functions and other types to. </p>\n\n<p>What specifically are you trying to do? If you're looking for a <code>var_dump</code>:</p>\n\n<h3>USING <a href=\"https://golang.org/pkg/fmt/#Println\" rel=\"nofollow noreferrer\"><code>fmt.Println</code></a></h3>\n\n<pre><code>someErr := fmt.Errorf(\"custom type error\")\nfmt.Println(someErr)\n</code></pre>\n\n<p><code>Println</code> formats using the default formats for its operands and writes to standard output.</p>\n\n<h3>USING <a href=\"https://golang.org/pkg/fmt/#Printf\" rel=\"nofollow noreferrer\"><code>fmt.Printf</code></a></h3>\n\n<pre><code>someErr := fmt.Errorf(\"custom type error\")\nfmt.Printf(\"This is an error:%v A num: %v A str\", someErr, 19, \"Stackoverflow\")\n</code></pre>\n\n<p><code>Printf</code> formats according to a format specifier and writes to standard output.</p>\n\n<h3>USING <a href=\"https://golang.org/pkg/fmt/#Sprintf\" rel=\"nofollow noreferrer\"><code>fmt.Sprintf</code></a></h3>\n\n<pre><code>someErr := fmt.Errorf(\"custom type error\")\n// someStr now contains the string formatted as shown below\nsomeStr := fmt.Sprintf(\"This is an error:%v A num: %v A str\", someErr, 19, \"Stackoverflow\")\n</code></pre>\n\n<p><code>Sprintf</code> formats according to a format specifier and returns the resulting string.</p>\n\n<p>Here is an example of my personal preference when outputting var data:\n<a href=\"https://play.golang.org/p/8dpeE-fray_J\" rel=\"nofollow noreferrer\">https://play.golang.org/p/8dpeE-fray_J</a></p>\n\n<p><strong>I hope this helps!</strong></p>\n"}, {"tags": [], "owner": {"reputation": 983, "user_id": 7059119, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209343272591927/picture?type=large", "display_name": "Aristofanio Garcia", "link": "https://stackoverflow.com/users/7059119/aristofanio-garcia"}, "is_accepted": false, "score": 1, "last_activity_date": 1525299105, "last_edit_date": 1525299105, "creation_date": 1525298671, "answer_id": 50144203, "question_id": 50144039, "link": "https://stackoverflow.com/questions/50144039/return-all-contents-within-an-object/50144203#50144203", "title": "Return all contents within an object", "body": "<p>In Go is possible does something similar, but don't work for all.</p>\n\n<pre><code>func main() {\n\n    //arrays\n    a := []int{1,2,3,4}\n    fmt.Printf(\"%v\\r\\n\", a)         //print [1 2 3 4]\n\n    //maps\n    b := map[string]int{\n          \"a\":1,\n          \"b\":2,\n    }\n    fmt.Printf(\"%v\\r\\n\", b)        //print map[a:1 b:2]\n\n    //structs\n    c := struct{\n          A int\n          B int\n    }{1,2}\n    d := struct{\n          C struct{\n              A int \n              B int\n          }\n          D int\n    }{c,2}\n    fmt.Printf(\"%v\\r\\n\", d)        //print {{1 2} 2}\n}\n</code></pre>\n\n<p>See in: <a href=\"https://play.golang.org/p/vzlCsOG497h\" rel=\"nofollow noreferrer\">https://play.golang.org/p/vzlCsOG497h</a></p>\n\n<p>If you pass <em>fmt</em> occurs error because it is a package. The error is:</p>\n\n<pre><code>Error: use of package fmt without selector\n</code></pre>\n\n<p>I hope this helps (too)!</p>\n"}, {"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": true, "score": 2, "last_activity_date": 1525300219, "last_edit_date": 1525300219, "creation_date": 1525299835, "answer_id": 50144420, "question_id": 50144039, "link": "https://stackoverflow.com/questions/50144039/return-all-contents-within-an-object/50144420#50144420", "title": "Return all contents within an object", "body": "<p>Try executing <code>go doc fmt</code> in a terminal to produce a description of the \"fmt\" package and a listing of the functions it exports, or referring to the <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\"><code>fmt</code> package documentation</a> at <a href=\"https://golang.org\" rel=\"nofollow noreferrer\">https://golang.org</a>. In go, as in most other static/compiled languages, users are expected to refer to <em>documentation</em> (or <em>docs</em>) which describe the programming language and its libraries. Contrast this to some <a href=\"https://en.wikipedia.org/wiki/Dynamic_programming_language\" rel=\"nofollow noreferrer\">dynamic/scripting languages</a>, which often make it easy to query any object to discover its usable properties.</p>\n\n<p>At runtime, you can get a helpful printout of any arbitrary <em>value</em> by using the <code>%#v</code> formatting verb to produce a go syntax representation of the value, e.g.</p>\n\n<pre><code>xs := []int{1, 2, 3}\nfmt.Printf(\"OK: xs=%#v\\n\", xs)\n// OK: xs=[]int{1, 2, 3}    \n</code></pre>\n\n<p>Note that the package \"fmt\" is not a <em>value</em> in the go language so it cannot be printed at runtime as such.</p>\n"}], "owner": {"reputation": 3356, "user_id": 4641680, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/wBb3t.jpg?s=128&g=1", "display_name": "Reza Saadati", "link": "https://stackoverflow.com/users/4641680/reza-saadati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 50144420, "answer_count": 3, "score": -1, "last_activity_date": 1525300547, "creation_date": 1525297724, "question_id": 50144039, "link": "https://stackoverflow.com/questions/50144039/return-all-contents-within-an-object", "title": "Return all contents within an object", "body": "<p>I am very new to Go, so I am sorry for that noob question.</p>\n\n<p>In JavaScript <code>console.log(window)</code> returns all objects inside of <code>window</code>. In PHP <code>var_dump(new DateTime())</code> returns all objects inside of <code>DateTime()</code>.</p>\n\n<p>Is there a function in Go that will return all objects from a given object? For example <code>Println</code> should be returned if <code>fmt</code> is given.</p>\n"}, {"tags": ["vba", "go", "datetime-format"], "comments": [{"owner": {"reputation": 6198, "user_id": 2020002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t9iFY.jpg?s=128&g=1", "display_name": "Derek Pollard", "link": "https://stackoverflow.com/users/2020002/derek-pollard"}, "edited": false, "score": 1, "creation_date": 1525297719, "post_id": 50143899, "comment_id": 87306329, "body": "For one, you&#39;re throwing away the errors (<code>_</code>) which should be checked"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9458032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6069dc8ef91e7be0b48186284a1bb6da?s=128&d=identicon&r=PG&f=1", "display_name": "Gofurther", "link": "https://stackoverflow.com/users/9458032/gofurther"}, "edited": false, "score": 1, "creation_date": 1525297891, "post_id": 50144014, "comment_id": 87306401, "body": "That was just what I needed. Thanks for the help. The time.RFC3339 was exactly right."}], "tags": [], "owner": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "is_accepted": true, "score": 0, "last_activity_date": 1525297596, "creation_date": 1525297596, "answer_id": 50144014, "question_id": 50143899, "link": "https://stackoverflow.com/questions/50143899/how-to-convert-between-unusual-time-formats-golang/50144014#50144014", "title": "How to convert between unusual time formats golang", "body": "<p>Go time formats are interesting, you always have to put your formats in terms of (per the docs) <a href=\"https://golang.org/pkg/time/#Parse\" rel=\"nofollow noreferrer\">https://golang.org/pkg/time/#Parse</a></p>\n\n<pre><code>01/02 03:04:05PM '06 -0700\n</code></pre>\n\n<p>I changed your formats a bit so you could see what is happening. I also would advise checking error returns. It also seems like <code>time.RFC3339</code> is a good shorthand for what you are looking for on the output side but I may be wrong.</p>\n\n<p><a href=\"https://play.golang.org/p/eYYdV_UE_Pa\" rel=\"nofollow noreferrer\">https://play.golang.org/p/eYYdV_UE_Pa</a></p>\n"}], "owner": {"reputation": 25, "user_id": 9458032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6069dc8ef91e7be0b48186284a1bb6da?s=128&d=identicon&r=PG&f=1", "display_name": "Gofurther", "link": "https://stackoverflow.com/users/9458032/gofurther"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 50144014, "answer_count": 1, "score": -2, "last_activity_date": 1525297596, "creation_date": 1525296998, "question_id": 50143899, "link": "https://stackoverflow.com/questions/50143899/how-to-convert-between-unusual-time-formats-golang", "title": "How to convert between unusual time formats golang", "body": "<p>I referenced this post: <a href=\"https://stackoverflow.com/questions/36807596/how-to-convert-date-format-in-golang\">How to convert date format in golang?</a> and have this code on the playground:</p>\n\n<p><a href=\"https://play.golang.org/p/oNFVlDz9JoF\" rel=\"nofollow noreferrer\">https://play.golang.org/p/oNFVlDz9JoF</a></p>\n\n<p>But I can't seem to get it to work. I've padded the month with a 0 and still no dice. The time I'm trying to convert is <strong>4/20/2018 9:08:34 AM</strong> and I want it in this format: <strong>2009-04-20T21:18:44Z</strong> </p>\n\n<pre><code>NewLastDate = CDate(LastModified) 'generates 4/20/2018 9:08:34 AM \n</code></pre>\n\n<p>That's from a VBA script. 'LastModified' is in this format: <strong>dddd.ttttt VB/VBA format</strong></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1525297027, "post_id": 50143866, "comment_id": 87306054, "body": "There is no covariance in Go: function signatures must match exactly."}, {"owner": {"reputation": 6198, "user_id": 2020002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t9iFY.jpg?s=128&g=1", "display_name": "Derek Pollard", "link": "https://stackoverflow.com/users/2020002/derek-pollard"}, "edited": false, "score": 0, "creation_date": 1525297118, "post_id": 50143866, "comment_id": 87306099, "body": "I suggest attaching the function to a <code>type</code>, it would be cleaner, and much more idiomatic"}], "answers": [{"tags": [], "owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "is_accepted": false, "score": 4, "last_activity_date": 1525297186, "creation_date": 1525297186, "answer_id": 50143931, "question_id": 50143866, "link": "https://stackoverflow.com/questions/50143866/assinging-functions-to-function-types-that-return-interface-values/50143931#50143931", "title": "assinging functions to function types that return interface values,", "body": "<p>As per the Go's <a href=\"https://golang.org/ref/spec#Assignability\" rel=\"nofollow noreferrer\">assignability rules</a> a function <code>f</code> is assignable to a variable <code>v</code> only if the variable's type <code>T</code> exactly matches the <code>f</code>'s signature.</p>\n\n<p>The ability to assign a more specific type in some other languages called \"covariance\", and Go's type system does not have it.</p>\n"}, {"tags": [], "owner": {"reputation": 983, "user_id": 7059119, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209343272591927/picture?type=large", "display_name": "Aristofanio Garcia", "link": "https://stackoverflow.com/users/7059119/aristofanio-garcia"}, "is_accepted": true, "score": 4, "last_activity_date": 1525298016, "last_edit_date": 1525298016, "creation_date": 1525297687, "answer_id": 50144031, "question_id": 50143866, "link": "https://stackoverflow.com/questions/50143866/assinging-functions-to-function-types-that-return-interface-values/50144031#50144031", "title": "assinging functions to function types that return interface values,", "body": "<p>This error occurs because of signature don't match.\nYou code shared is:</p>\n\n<pre><code>//shared code\n//---------------------------------------------\ntype Gettable interface {\n    Get() int64\n}\ntype MyFunction func(int64) (Gettable, error)\n</code></pre>\n\n<p>So you need replace MyStruct by Gettable.</p>\n\n<pre><code>//main/sub\n//---------------------------------------------\ntype MyStruct struct {\n    Val int64\n}\n\nfunc (v MyStruct) Get() int64 {\n    return v.Val\n}\n\n//this signature of TestFn2 is different of MyStruct\n//-[TestFn2] func (a int64) (MyStruct, error)\n//-[MyFunction] func(int64) (Gettable, error)\nfunc TestFn2(a int64) (Gettable, error) {//&lt;-- replace by Gettable here\n    return MyStruct{a}, nil\n}\n</code></pre>\n\n<p>Running your code:</p>\n\n<pre><code>//main.go\n//---------------------------------------------\n\nfunc main() {\n        var f MyFunction\n        f = TestFn2\n        a, _ := f(1)\n        fmt.Println(a)\n}   \n</code></pre>\n\n<p>Result is: </p>\n\n<pre><code>{1}\n</code></pre>\n\n<p>See in playground: <a href=\"https://play.golang.org/p/sRsXix8E_83\" rel=\"nofollow noreferrer\">https://play.golang.org/p/sRsXix8E_83</a></p>\n"}], "owner": {"reputation": 1342, "user_id": 1216838, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c29171dbea109a0147226a1962a4d3c8?s=128&d=identicon&r=PG", "display_name": "Pita", "link": "https://stackoverflow.com/users/1216838/pita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 50144031, "answer_count": 2, "score": 1, "last_activity_date": 1525298016, "creation_date": 1525296805, "question_id": 50143866, "link": "https://stackoverflow.com/questions/50143866/assinging-functions-to-function-types-that-return-interface-values", "title": "assinging functions to function types that return interface values,", "body": "<p>Im trying to define a couple of interface to refactor some code and I'm getting a problem where Go is not letting me assign functions to variables.\nThis is the set up</p>\n\n<p>main.go</p>\n\n<pre><code>    type Gettable interface {\n        Get() int64\n    }\n\n    type MyFunction func(int64) (Gettable, error)\n\n    func main() {\n\n        var f MyFunction\n        f = sub.TestFn2\n        a, _ := f(1)\n        fmt.Println(a)\n    }\n</code></pre>\n\n<p>main/sub </p>\n\n<pre><code>package sub\n\ntype MyStruct struct {\n    Val int64\n}\n\nfunc (v MyStruct) Get() int64 {\n    return v.Val\n}\n\nfunc TestFn2(a int64) (MyStruct, error) {\n    return MyStruct{a}, nil\n}\n</code></pre>\n\n<p>I'm trying to define a generic function type, and in the sub package create the concrete functions</p>\n\n<p>and ideally i want to store the functions in a map and call them with something like</p>\n\n<pre><code>FnMap[\"fnName\"]()\n</code></pre>\n\n<p>I'm not there yet,</p>\n\n<p>im getting an error saying</p>\n\n<pre><code>/topics.go:27:4: cannot use sub.TestFn2 (type func(int64) (sub.MyStruct, error)) as type MyFunction in assignment\n</code></pre>\n\n<p>but <code>MyStruct</code> clearly implements the interface <code>Gettable</code></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 3, "creation_date": 1525295458, "post_id": 50143585, "comment_id": 87305408, "body": "<code>SmallestNonzeroFloat64</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "is_accepted": true, "score": 3, "last_activity_date": 1525296556, "creation_date": 1525296556, "answer_id": 50143810, "question_id": 50143585, "link": "https://stackoverflow.com/questions/50143585/how-to-get-the-smallest-non-zero-float64/50143810#50143810", "title": "How to get the smallest non-zero float64?", "body": "<p>as @oliver-charlesworth says:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n)\n\nfunc main() {\n    fmt.Printf(\"%.12G\", math.SmallestNonzeroFloat64)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/kRuIhalODGa\" rel=\"nofollow noreferrer\">https://play.golang.org/p/kRuIhalODGa</a></p>\n\n<p>Output:</p>\n\n<pre><code>4.94065645841E-324\n</code></pre>\n"}], "owner": {"reputation": 699, "user_id": 1592560, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c938811f6f6afc6d9ae3f93cbe7b57b2?s=128&d=identicon&r=PG", "display_name": "Aman", "link": "https://stackoverflow.com/users/1592560/aman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 0, "accepted_answer_id": 50143810, "answer_count": 1, "score": -4, "last_activity_date": 1525296556, "creation_date": 1525295325, "question_id": 50143585, "link": "https://stackoverflow.com/questions/50143585/how-to-get-the-smallest-non-zero-float64", "title": "How to get the smallest non-zero float64?", "body": "<p>The math library doesn't seem to have a Min function for float64. How would I get the smallest non-zero float64? </p>\n"}, {"tags": ["go", "goland"], "answers": [{"comments": [{"owner": {"reputation": 3356, "user_id": 4641680, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/wBb3t.jpg?s=128&g=1", "display_name": "Reza Saadati", "link": "https://stackoverflow.com/users/4641680/reza-saadati"}, "edited": false, "score": 0, "creation_date": 1525293763, "post_id": 50142706, "comment_id": 87304658, "body": "Thank you for your answer. I have no idea why but it works again and it only takes 1 second. I didn&#39;t change anything on my computer. Probably there was something running in background."}], "tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": true, "score": 3, "last_activity_date": 1525291531, "creation_date": 1525291531, "answer_id": 50142706, "question_id": 50142398, "link": "https://stackoverflow.com/questions/50142398/output-of-run-takes-too-long/50142706#50142706", "title": "Output of Run takes too long", "body": "<p>First, make sure you have the latest Go version, Go 1.10.2 at the time of writing. This improves the compilation speed dramatically due to caches added by the Go tool.</p>\n\n<p>Second, since this doesn't seem to be a constant issue, do you actually have this problem only on running that specific program with no debugging session in between? Is your anti-virus/computer doing something else in background?</p>\n"}], "owner": {"reputation": 3356, "user_id": 4641680, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/wBb3t.jpg?s=128&g=1", "display_name": "Reza Saadati", "link": "https://stackoverflow.com/users/4641680/reza-saadati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 50142706, "answer_count": 1, "score": 0, "last_activity_date": 1525291531, "creation_date": 1525290243, "question_id": 50142398, "link": "https://stackoverflow.com/questions/50142398/output-of-run-takes-too-long", "title": "Output of Run takes too long", "body": "<p>If I click on \"Run go build index.go\", Goland takes 3 seconds until it returns the output. Each other time it takes about 20 seconds. It is not about the code, because the code is simple:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(\"Hello World\")\n}\n</code></pre>\n\n<p>If I run this file on terminal with <code>go run index.go</code>, it takes about 1 second. </p>\n\n<p>I have just installed Goland for the first time, so there are no older configs in it. How can I fix this issue?</p>\n"}, {"tags": ["php", "go", "json-rpc"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1525294598, "post_id": 50142270, "comment_id": 87305042, "body": "A 400 response means there was a bad request, and a <i>response</i>, so it&#39;s not about connecting or blocking. Have you looked at the actual requests from each client to see how they differ?"}, {"owner": {"reputation": 147, "user_id": 3402508, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/jePH5.jpg?s=128&g=1", "display_name": "itcoder", "link": "https://stackoverflow.com/users/3402508/itcoder"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1525295695, "post_id": 50142270, "comment_id": 87305511, "body": "@JimB good idea. But how I can do it differ, which way ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1525295764, "post_id": 50142270, "comment_id": 87305538, "body": "I&#39;m not sure I understand. These are fairly simple requests, you should be able to spot any differences visually by just looking at them."}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 3402508, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/jePH5.jpg?s=128&g=1", "display_name": "itcoder", "link": "https://stackoverflow.com/users/3402508/itcoder"}, "edited": false, "score": 0, "creation_date": 1525337880, "post_id": 50145213, "comment_id": 87319504, "body": "Thanks for help, but if I run php client first time with you new code on go server, I get error  {&quot;id&quot;:1,&quot;result&quot;:null,&quot;error&quot;:&quot;rpc: can&#39;t find service Arith.Multiply&quot;}   <a href=\"https://github.com/golang/go/blob/master/src/net/rpc/server.go#L614\" rel=\"nofollow noreferrer\">github.com/golang/go/blob/master/src/net/rpc/server.go#L614</a>  and second time:  &quot;time out error&quot;  go version go1.9.4 linux/amd64 and php 5.6"}], "tags": [], "owner": {"reputation": 983, "user_id": 7059119, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209343272591927/picture?type=large", "display_name": "Aristofanio Garcia", "link": "https://stackoverflow.com/users/7059119/aristofanio-garcia"}, "is_accepted": true, "score": 3, "last_activity_date": 1525348959, "last_edit_date": 1525348959, "creation_date": 1525306409, "answer_id": 50145213, "question_id": 50142270, "link": "https://stackoverflow.com/questions/50142270/go-php-json-rpc-communication/50145213#50145213", "title": "Go &amp; PHP json-rpc communication", "body": "<p>When you call <code>rpc.HandleHTTP()</code>, you are using gobs encode and decode. Read more about gobs in: <a href=\"https://blog.golang.org/gobs-of-data\" rel=\"nofollow noreferrer\">https://blog.golang.org/gobs-of-data</a> and <a href=\"https://golang.org/pkg/encoding/gob/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/encoding/gob/</a>.</p>\n\n<p>In file <a href=\"https://golang.org/src/net/rpc/server.go\" rel=\"nofollow noreferrer\">https://golang.org/src/net/rpc/server.go</a> you can read this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/HxWy5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HxWy5.png\" alt=\"enter image description here\"></a></p>\n\n<p>To use jsonrpc in Go, you must use the codec from package net/rpc/jsonrpc instead of net/rpc.</p>\n\n<blockquote>\n  <p>Package jsonrpc implements a JSON-RPC 1.0 ClientCodec and ServerCodec\n  for the rpc package. For JSON-RPC 2.0 support [...]</p>\n  \n  <p>(Ref. source: <a href=\"https://golang.org/pkg/net/rpc/jsonrpc/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/rpc/jsonrpc/</a>)</p>\n</blockquote>\n\n<p>So above following the code in main.go:</p>\n\n<pre><code>func main() {\n    //arith instance\n    arith := new(Arith)\n\n    //make listen in 127.0.0.1:4444\n    l, e := net.Listen(\"tcp\", \":4444\")\n    if e != nil {\n        log.Fatal(\"listen error:\", e)\n    }\n    defer l.Close()\n\n    //instance rpc server\n    rpcserver := rpc.NewServer()\n    rpcserver.Register(arith)\n    //updated for multiples requests\n    for {\n        //block until acceptation of client\n        c, e := l.Accept()\n        if e != nil {\n          log.Fatal(\"accept error:\", e)\n        }\n        //instance codec\n        jsoncodec := jsonrpc.NewServerCodec(c)\n        rpcserver.ServeCodec(jsoncodec)\n    }\n}\n</code></pre>\n\n<p>On exec <code>php client.php</code> the result was:</p>\n\n<p><a href=\"https://i.stack.imgur.com/lyZI6m.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lyZI6m.png\" alt=\"enter image description here\"></a></p>\n\n<p>Update: in php file:</p>\n\n<pre><code>&lt;?php\n//imports\nrequire 'vendor/autoload.php';\n//instance client\n$client = new JRClient\\Client('tcp', '127.0.0.1:4444');\n\n//sleep(5); &lt;&lt;-- remove\n\n//call method 'Arith.Multiply'\n$result = $client-&gt;call('Arith.Multiply', ['A' =&gt; 3, \"B\" =&gt; 4], 1000);\nif ($result['error']) {\n    echo $result['errorMsg'] . \"\\n\";\n} else {\n    var_dump($result['data']);\n}\n\n?&gt;\n</code></pre>\n\n<p>Hope this helps!!</p>\n"}], "owner": {"reputation": 147, "user_id": 3402508, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/jePH5.jpg?s=128&g=1", "display_name": "itcoder", "link": "https://stackoverflow.com/users/3402508/itcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 665, "favorite_count": 0, "accepted_answer_id": 50145213, "answer_count": 1, "score": 2, "last_activity_date": 1525348959, "creation_date": 1525289771, "question_id": 50142270, "link": "https://stackoverflow.com/questions/50142270/go-php-json-rpc-communication", "title": "Go &amp; PHP json-rpc communication", "body": "<p>I try communication JSON-RPC between php and go.</p>\n\n<p>Server GO from this example <a href=\"https://golang.org/pkg/net/rpc/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/rpc/</a></p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"net/rpc\"\n    \"net\"\n    \"log\"\n    \"net/http\"\n)\n\ntype Args struct {\n    A, B int\n}\n\ntype Quotient struct {\n    Quo, Rem int\n}\n\ntype Arith int\n\nfunc (t *Arith) Multiply(args *Args, reply *int) error {\n    *reply = args.A * args.B\n    return nil\n}\n\nfunc (t *Arith) Divide(args *Args, quo *Quotient) error {\n    if args.B == 0 {\n        return errors.New(\"divide by zero\")\n    }\n    quo.Quo = args.A / args.B\n    quo.Rem = args.A % args.B\n    return nil\n}\n\n\nfunc main() {\n    arith := new(Arith)\n    rpc.Register(arith)\n    rpc.HandleHTTP()\n    l, e := net.Listen(\"tcp\", \":4444\")\n    if e != nil {\n        log.Fatal(\"listen error:\", e)\n    }\n//  go http.Serve(l, nil)\n\n    err:= http.Serve(l, nil)\n    if err != nil {\n        log.Fatalf(\"Error serving: %s\", err)\n    }\n\n}\n</code></pre>\n\n<p>and php client from example this repository <a href=\"https://github.com/ptcx/jsonrpc-client\" rel=\"nofollow noreferrer\">https://github.com/ptcx/jsonrpc-client</a>:</p>\n\n<p>\n\n<pre><code>require 'vendor/autoload.php';\n\n$client = new JRClient\\Client('tcp', '127.0.0.1:4444');\nsleep(5);\n$result = $client-&gt;call('Arith.Multiply', ['A' =&gt; 3, \"B\" =&gt; 4], 1000);\nif ($result['error']) {\n    echo $result['errorMsg'] . \"\\n\";\n} else {\n    var_dump($result['data']);\n}\n</code></pre>\n\n<p>Bur final I have error: HTTP/1.1 400 Bad Request\nI tried also write <code>sleep(5)</code> after php connect but no result? Also  I tried change from <code>true</code> on <code>false</code> into function <code>stream_set_blocking($this-&gt;sockfp, false)</code> <a href=\"https://github.com/ptcx/jsonrpc-client/blob/master/src/Connection/TcpConnection.php#L69\" rel=\"nofollow noreferrer\">https://github.com/ptcx/jsonrpc-client/blob/master/src/Connection/TcpConnection.php#L69</a>   - no result. \nI treed write  GO client - it is worked without problem. </p>\n\n<p>Help me please with my php client </p>\n"}, {"tags": ["go", "packet-capture", "handshake", "wpa"], "owner": {"reputation": 45, "user_id": 9022502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6290f4fc3171c48ba7b85116af31bc8f?s=128&d=identicon&r=PG&f=1", "display_name": "user9022502", "link": "https://stackoverflow.com/users/9022502/user9022502"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1525458766, "creation_date": 1525288748, "last_edit_date": 1525458766, "question_id": 50142006, "link": "https://stackoverflow.com/questions/50142006/correct-way-to-determine-a-complete-handshake-of-eapol-frames", "title": "correct way to determine a complete handshake of EAPOL frames", "body": "<p>I am trying to capture completed handshake frames in an WPA2 EAPOL authentication. The source can be a pcap file or live capture. My idea is to </p>\n\n<ol>\n<li>identify message type of EAPOL (message 1, 2, 3 &amp; 4)</li>\n<li>compare Key Nonce (should be similar for message 1&amp;3 , 2&amp;4)</li>\n<li>verify source and destination for all 4 messages.\nif these conditions satisfy for the 4 sets of EAPOL frame then it is a complete handshake. (check timestamps in case of duplicate frames) </li>\n</ol>\n\n<p>But I have observed that in a complete handshake, many times the message# 4 carries a Nonce of zero value instead of Nonce of message# 2. </p>\n\n<p>What other fields should be considered while determining a complete handshake then? </p>\n"}, {"tags": ["go", "ssh", "glide-golang"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1525281247, "post_id": 50140041, "comment_id": 87298455, "body": "Which approach do you want help with? You&#39;ve offered three different solutions, all of which are legitimate."}, {"owner": {"reputation": 2192, "user_id": 1107595, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f43c090c500a639bdd28c090f573159?s=128&d=identicon&r=PG", "display_name": "BlueMagma", "link": "https://stackoverflow.com/users/1107595/bluemagma"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1525338496, "post_id": 50140041, "comment_id": 87319921, "body": "I want to avoid having to set it in glide.yaml, but the other two method are not working for me, I&#39;m assuming I did it incorrectly"}], "owner": {"reputation": 2192, "user_id": 1107595, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f43c090c500a639bdd28c090f573159?s=128&d=identicon&r=PG", "display_name": "BlueMagma", "link": "https://stackoverflow.com/users/1107595/bluemagma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 276, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1553440839, "creation_date": 1525280850, "last_edit_date": 1553440839, "question_id": 50140041, "link": "https://stackoverflow.com/questions/50140041/glide-with-private-repo-and-different-ssh-port", "title": "Glide with private repo and different ssh port", "body": "<p>I've got a private gitlab server configured for ssh on port 2222</p>\n\n<p>My golang project are using glide for dependency management, sometimes importing other project from the private server</p>\n\n<p>The URL of my projects looks something like this:</p>\n\n<pre><code>ssh://git@gitlab.myserver.com:2222/group/project.git\n</code></pre>\n\n<p>My import lines in go look something like this:</p>\n\n<pre><code>import gitlab.myserver.com/group/project/package\n</code></pre>\n\n<p>I know I can set the exact repo URL in glide.yaml, but I would like to configure the machine to use the correct address instead.</p>\n\n<p>I've read you can use command like this:</p>\n\n<pre><code>git config --global url.\"...\" insteadOf.\"..\"\n</code></pre>\n\n<p>I'm not sure how to use that though.\nI've also seen that you can configure ssh (~/.ssh/config) to redirect to the correct URL.</p>\n\n<p>I haven't manage to make it work yet. How can I do that?</p>\n"}, {"tags": ["go", "amazon-dynamodb"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1525278518, "post_id": 50139053, "comment_id": 87297089, "body": "Have you tried checking the error return from <code>database.Query</code>?"}, {"owner": {"reputation": 101, "user_id": 7473136, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7e0c6a6a7a8149c86db1cac1d2f0683b?s=128&d=identicon&r=PG", "display_name": "user93466", "link": "https://stackoverflow.com/users/7473136/user93466"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1525279347, "post_id": 50139053, "comment_id": 87297540, "body": "I have not, just did and found - ValidationException: Invalid FilterExpression: The expression can not be empty; (?)"}], "answers": [{"comments": [{"owner": {"reputation": 10025, "user_id": 4985580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea90ed1e325d0956cbcba499c43a0fd?s=128&d=identicon&r=PG&f=1", "display_name": "F_SO_K", "link": "https://stackoverflow.com/users/4985580/f-so-k"}, "edited": false, "score": 0, "creation_date": 1525335403, "post_id": 50142383, "comment_id": 87318005, "body": "Please accept your own answer so that others can see your question has been answered."}], "tags": [], "owner": {"reputation": 101, "user_id": 7473136, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7e0c6a6a7a8149c86db1cac1d2f0683b?s=128&d=identicon&r=PG", "display_name": "user93466", "link": "https://stackoverflow.com/users/7473136/user93466"}, "is_accepted": true, "score": 0, "last_activity_date": 1525290199, "creation_date": 1525290199, "answer_id": 50142383, "question_id": 50139053, "link": "https://stackoverflow.com/questions/50139053/dynamodb-results-are-not-found-but-are-there/50142383#50142383", "title": "DynamoDB results are not found but are there", "body": "<p>I added: <code>LogLevel: aws.LogLevel(aws.LogDebugWithHTTPBody)</code> to the <code>aws.Config</code> and the problem was that I was selecting wrong column and using query instead of scan (query can be used only for the primary key)</p>\n\n<p>Thank you @Adrian for the idea which led me to this.</p>\n"}], "owner": {"reputation": 101, "user_id": 7473136, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7e0c6a6a7a8149c86db1cac1d2f0683b?s=128&d=identicon&r=PG", "display_name": "user93466", "link": "https://stackoverflow.com/users/7473136/user93466"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 50142383, "answer_count": 1, "score": 0, "last_activity_date": 1525290199, "creation_date": 1525277404, "last_edit_date": 1525283582, "question_id": 50139053, "link": "https://stackoverflow.com/questions/50139053/dynamodb-results-are-not-found-but-are-there", "title": "DynamoDB results are not found but are there", "body": "<p>I am trying to get results based on 2 values,</p>\n\n<p>fetching:</p>\n\n<pre><code>identificatorFilter := expression.Name(\"identificator\").Equal(expression.Value(*netAuth.Identificator))\n    typeFilter := expression.Name(\"type\").Equal(expression.Value(netAuth.Type))\n    expr, err := expression.NewBuilder().WithFilter(identificatorFilter).WithFilter(typeFilter).Build()\n    if err != nil {\n        return response.SimpleResponse{\n            StatusCode: common.InternalServerError,\n        }, nil\n    }\n\n    // Read from DynamoDB\n    input := &amp;dynamodb.QueryInput{\n        ExpressionAttributeNames:  expr.Names(),\n        ExpressionAttributeValues: expr.Values(),\n        FilterExpression:          expr.Filter(),\n        ProjectionExpression:      expr.Projection(),\n        TableName:                 aws.String(account.Table),\n    }\n\n    result, _ := database.Query(input)\n</code></pre>\n\n<p>The results are 0.</p>\n\n<pre><code>type NetAuth struct {\n    Identificator *string `json:\"identificator\"`\n    Password      *string `json:\"password\"`\n    DeviceID      *string `json:\"deviceId\"`\n    Type          int     `json:\"type\"`\n}\n</code></pre>\n\n<p>My request:</p>\n\n<pre><code>{\n  \"identificator\": \"meh@asd.das\",\n  \"password\": \"DbmMGH4UU9REBB1dEBfTIOYu63S79BiG3ZVcd3zwHsxesX6vtB\",\n  \"deviceId\": \"deviceId\",\n  \"type\": 0\n}\n</code></pre>\n\n<p>My database contains:</p>\n\n<pre><code> {\n            \"created_at\": {\n                \"S\": \"2018-05-01T20:01:21.180441941Z\"\n            },\n            \"password\": {\n                \"S\": \"da6369cdef0c0464796a734162c6fc67e143a367a754c0236ee9913abb2b2083fc2a71cd16fa10a0232ad667416ed5460b04f367b597331ed26d349452d2aff8\"\n            },\n            \"id\": {\n                \"S\": \"36pmlEm4fbh7HWavLYgaPHXmQ1xv234qWE24TaHCFta65dZFmr\"\n            },\n            \"type\": {\n                \"N\": \"0\"\n            },\n            \"expiry_date\": {\n                \"NULL\": true\n            },\n            \"salt\": {\n                \"NULL\": true\n            },\n            \"updated_at\": {\n                \"S\": \"2018-05-01T20:01:21.180442027Z\"\n            },\n            \"level\": {\n                \"N\": \"0\"\n            },\n            \"qr_key\": {\n                \"NULL\": true\n            },\n            \"identificator\": {\n                \"S\": \"meh@asd.das\"\n            }\n        }\n</code></pre>\n\n<p>I tried removing typeFilter however it does not work.\nI tried somehow to show the \"query\" however I cannot find a way.</p>\n\n<p>I am coming from Rdbms so please excuse me if it's stupid mistake.</p>\n"}, {"tags": ["json", "api", "go", "beego"], "comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 1, "creation_date": 1525272354, "post_id": 50137420, "comment_id": 87293132, "body": "This will not match since <code>Referrals</code> is an array of objects not an object"}, {"owner": {"reputation": 2667, "user_id": 1508147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nueRO.jpg?s=128&g=1", "display_name": "Sathishkumar Rakkiasamy", "link": "https://stackoverflow.com/users/1508147/sathishkumar-rakkiasamy"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1525275790, "post_id": 50137420, "comment_id": 87295406, "body": "@Himanshu I have updated my struct. Let me know if you have any idea."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 1, "creation_date": 1525277605, "post_id": 50137420, "comment_id": 87296554, "body": "your question is not clear what you want actually &#39;a verification if your struct is matching or not&#39; because that I have already mentioned"}, {"owner": {"reputation": 2667, "user_id": 1508147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nueRO.jpg?s=128&g=1", "display_name": "Sathishkumar Rakkiasamy", "link": "https://stackoverflow.com/users/1508147/sathishkumar-rakkiasamy"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1525277694, "post_id": 50137420, "comment_id": 87296619, "body": "@Himanshu My question is how can I validate the above json data using beego?"}], "owner": {"reputation": 2667, "user_id": 1508147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nueRO.jpg?s=128&g=1", "display_name": "Sathishkumar Rakkiasamy", "link": "https://stackoverflow.com/users/1508147/sathishkumar-rakkiasamy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 504, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1525277765, "creation_date": 1525272255, "last_edit_date": 1525277765, "question_id": 50137420, "link": "https://stackoverflow.com/questions/50137420/validation-for-nested-json-object", "title": "Validation for Nested JSON object", "body": "<pre><code>{\n \"firstname\": \"sathish\",\n \"lastname\": \"kumar\",\n \"city\": {\n    \"id\": 12,\n    \"name\": \"coimbatore\"\n },\n \"referrals\": [\n    {\n        \"name\": \"vignesh\",\n        \"mobile\": \"1234567890\"\n    },\n    {\n        \"name\": \"melvin\",\n        \"mobile\": \"1234567890\"\n    }\n ]\n}\n</code></pre>\n\n<p>Above is my JSON request for creating new profile. I need to do validation for above JSON using Beego validation package</p>\n\n<pre><code>type ProfileForm struct {\n Firstname string `json:\"firstname\" valid:\"Required\"`\n Lastname  string `json:\"lastname\" valid:\"Required\"`\n City      struct {\n    ID   int    `json:\"id\" valid:\"Required\"`\n    Name string `json:\"name\" valid:\"Required\"`\n } `json:\"city\"`\n Referrals []struct {\n    Name   string `json:\"name\" valid:\"Required\"`\n    Mobile string `json:\"mobile\" valid:\"Required\"`\n } `json:\"referrals\"`\n}\n</code></pre>\n\n<p>I need to know the how can write the validation for JSON request using struct in Beego. Let me know are the any package or tutorial for this kind of requirement. </p>\n\n<p>In official beego documentation I didn't see anything matches my requirement. </p>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1525271620, "post_id": 50137191, "comment_id": 87292646, "body": "A for range loop over a channel exits when the channel closes, but you&#39;re closing the channel after the for loop;"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1525272173, "post_id": 50137191, "comment_id": 87293028, "body": "The above-noted range-before-close is indeed the issue. Also, rather than <code>(*wg).Done()</code> you should just be calling <code>wg.Done()</code>. It will handle dereferencing for you as needed."}, {"owner": {"reputation": 1, "user_id": 4443620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/351b432b36b8f821e5540a1fd534d240?s=128&d=identicon&r=PG&f=1", "display_name": "spugia", "link": "https://stackoverflow.com/users/4443620/spugia"}, "edited": false, "score": 0, "creation_date": 1525272481, "post_id": 50137191, "comment_id": 87293231, "body": "appreciate it! that solved the issue"}], "owner": {"reputation": 1, "user_id": 4443620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/351b432b36b8f821e5540a1fd534d240?s=128&d=identicon&r=PG&f=1", "display_name": "spugia", "link": "https://stackoverflow.com/users/4443620/spugia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "closed_date": 1525271727, "answer_count": 0, "score": 0, "last_activity_date": 1525271498, "creation_date": 1525271498, "question_id": 50137191, "link": "https://stackoverflow.com/questions/50137191/error-when-trying-to-collect-data-from-multiple-go-routines", "closed_reason": "Duplicate", "title": "Error when trying to collect data from multiple go routines", "body": "<p>I am trying to run multiple goroutines in parallel and then collect the results of those calculations once they have all completed. </p>\n\n<p>No matter what I try though, I get the following error:</p>\n\n<p>fatal error: all goroutines are asleep - deadlock!</p>\n\n<p>Here is the layout of my code:</p>\n\n<pre><code> func Function(inputs) {\n\n     var wg sync.WaitGroup\n     wg.Add(numBatch)\n\n     deltaChan := make(chan DeltaPair)\n\n     for b := 1 ; b &lt;= numBatch ; b++ {\n\n          ... some calculations\n\n          go BackPropagate(otherinputs, deltaChan, &amp;wg)\n     }\n\n     for delta := range deltaChan {\n\n           AddNeurons(&amp;nDeltas, &amp;delta.n)\n          AddSynapses(&amp;sDeltas, &amp;delta.s)\n     }\n\n     wg.Wait()\n\n     close(deltaChan)\n}\n\nfunc BackPropagate(otherinputs, deltaChan chan&lt;- DeltaPair, wg *sync.WaitGroup) {\n\n     defer (*wg).Done()\n\n     ... some calculations\n\n     deltaChan &lt;- DeltaPair{nDeltas, sDeltas}\n}\n</code></pre>\n"}, {"tags": ["swift", "string", "go", "utf-8"], "comments": [{"owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 0, "creation_date": 1525278143, "post_id": 50137048, "comment_id": 87296898, "body": "Note that <code>NSRange</code> is still another thing: It comes from <code>NSString</code> and counts UTF-16 code units."}, {"owner": {"reputation": 3001, "user_id": 671580, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ce9e871134885854d5c3e3ab5fa83c3b?s=128&d=identicon&r=PG", "display_name": "shelll", "link": "https://stackoverflow.com/users/671580/shelll"}, "reply_to_user": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 0, "creation_date": 1525286391, "post_id": 50137048, "comment_id": 87301056, "body": "@MartinR yes I know. I need <code>NSRange</code> so I can use it with <code>TTTAttributedLabel</code>. Apple gave us too many ranges and strings, combined with regexps it is a joy to use :( Thanks again."}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1525463771, "last_edit_date": 1525463771, "creation_date": 1525271958, "answer_id": 50137328, "question_id": 50137048, "link": "https://stackoverflow.com/questions/50137048/utf8-string-length-and-indices-in-go-vs-swift/50137328#50137328", "title": "UTF8 String length and indices in Go vs Swift", "body": "<p><a href=\"https://golang.org/ref/spec#Rune_literals\" rel=\"nofollow noreferrer\">A <code>rune</code> in Go identifies a specific UTF-8 code point</a>; that does not necessarily mean it maps 1:1 to visually distinct characters. Some characters may be made up of multiple runes/code points, therefor counting runes may not give you what you'd expect from a visual inspection of the string. I don't know what <code>\"some text\".count</code> actually counts in Swift so I can't offer any comparison there.</p>\n"}, {"comments": [{"owner": {"reputation": 3001, "user_id": 671580, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ce9e871134885854d5c3e3ab5fa83c3b?s=128&d=identicon&r=PG", "display_name": "shelll", "link": "https://stackoverflow.com/users/671580/shelll"}, "edited": false, "score": 0, "creation_date": 1525273155, "post_id": 50137478, "comment_id": 87293742, "body": "Thanks for the <code>unicodeScalars</code>! I created a Swift String extension based on your comment (which is now deleted). Now everything works expected. UTF is &quot;great&quot;..."}], "tags": [], "owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "is_accepted": true, "score": 7, "last_activity_date": 1525273168, "last_edit_date": 1525273168, "creation_date": 1525272441, "answer_id": 50137478, "question_id": 50137048, "link": "https://stackoverflow.com/questions/50137048/utf8-string-length-and-indices-in-go-vs-swift/50137478#50137478", "title": "UTF8 String length and indices in Go vs Swift", "body": "<p>In Swift a <code>Character</code> is an \u201cextended grapheme cluster,\u201d and each of \"\ud83d\ude02\", \"\ud83d\ude03\", \"\u270c\ufe0f\", \"\ud83e\udd14\", \"\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66\" counts as a single character. </p>\n\n<p>I have no experience with Go, but as I understand it from <a href=\"https://blog.golang.org/strings\" rel=\"noreferrer\">Strings, bytes, runes and characters in Go</a>,\na \u201crune\u201d is a Unicode code point, which essentially corresponds to a <code>UnicodeScalar</code> in Swift.</p>\n\n<p>In your example, the difference comes from \"\u270c\ufe0f\" which\ncounts as a single Swift character, but is built from two Unicode scalars:</p>\n\n<pre><code>print(\"\u270c\ufe0f\".count) // 1\nprint(\"\u270c\ufe0f\".unicodeScalars.count) // 2\n</code></pre>\n\n<p>Here is an example how you can compute the length and offsets in\nterms of Unicode scalars:</p>\n\n<pre><code>let s = \"Lorem \ud83d\ude02\ud83d\ude03\u270c\ufe0f\ud83e\udd14 ipsum\"\nprint(s.unicodeScalars.count) // 17\n\nif let idx = s.range(of: \"ipsum\") {\n    print(s.unicodeScalars.distance(from: s.startIndex, to: idx.lowerBound)) // 12\n}\n</code></pre>\n\n<p>As you can see, this gives the same numbers as in your example from Go.</p>\n"}], "owner": {"reputation": 3001, "user_id": 671580, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ce9e871134885854d5c3e3ab5fa83c3b?s=128&d=identicon&r=PG", "display_name": "shelll", "link": "https://stackoverflow.com/users/671580/shelll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 393, "favorite_count": 0, "accepted_answer_id": 50137478, "answer_count": 2, "score": 0, "last_activity_date": 1525463771, "creation_date": 1525271051, "last_edit_date": 1525273323, "question_id": 50137048, "link": "https://stackoverflow.com/questions/50137048/utf8-string-length-and-indices-in-go-vs-swift", "title": "UTF8 String length and indices in Go vs Swift", "body": "<p>I have apps in Go and Swift which process strings, such as finding substrings and their indices. At first it worked nicely even with multi-byte characters (e.g. emojis), using to Go's <code>utf8.RuneCountInString()</code> and Swift's native String.</p>\n\n<p>But there are some UTF8 characters that break the string length and indices for substrings, e.g. a string <code>\"Lorem \ud83d\ude02\ud83d\ude03\u270c\ufe0f\ud83e\udd14 ipsum\"</code>:</p>\n\n<p>Go's <code>utf8.RuneCountInString(\"Lorem \ud83d\ude02\ud83d\ude03\u270c\ufe0f\ud83e\udd14 ipsum\")</code> returns 17 and the start index of <code>ipsum</code> is 12.</p>\n\n<p>Swift's <code>\"Lorem \ud83d\ude02\ud83d\ude03\u270c\ufe0f\ud83e\udd14 ipsum\".count</code> returns 16 and the start index of <code>ipsum</code> is 11.</p>\n\n<p>Using Swift String's <code>utf8</code>, <code>utf16</code> or casting to <code>NSString</code> gives also different lengths and indices. There are also other emojis composed from multiple other emoji's like \ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66 which gives even funnier numbers.</p>\n\n<p>This is with Go 1.8 and Swift 4.1.</p>\n\n<p>Is there any way to get the same string lengths and substrings' indices with same values with Go and Swift?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I created a Swift String extension based on @MartinR's great answer:</p>\n\n<pre><code>extension String {\n    func runesRangeToNSRange(from: Int, to: Int) -&gt; NSRange {\n        let length = to - from\n        let start = unicodeScalars.index(unicodeScalars.startIndex, offsetBy: from)\n        let end = unicodeScalars.index(start, offsetBy: length)\n        let range = start..&lt;end\n\n        return NSRange(range, in: self)\n    }\n}\n</code></pre>\n"}, {"tags": ["json", "go", "marshalling"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1525270963, "post_id": 50136579, "comment_id": 87292168, "body": "use <code>omitempty</code> for the <code>Person</code>&#39;s fields. <a href=\"https://play.golang.org/p/o3jWdru_8bC\" rel=\"nofollow noreferrer\">play.golang.org/p/o3jWdru_8bC</a>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1525271864, "post_id": 50136579, "comment_id": 87292824, "body": "another way you could handle this is by using a <i>non-pointer</i> wrapper type that embeds your <code>Person</code> pointer type, like so: <a href=\"https://play.golang.org/p/EKQc7uf1_Vk\" rel=\"nofollow noreferrer\">play.golang.org/p/EKQc7uf1_Vk</a>"}, {"owner": {"reputation": 185, "user_id": 4243035, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/cn7mx.png?s=128&g=1", "display_name": "tama", "link": "https://stackoverflow.com/users/4243035/tama"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1525271964, "post_id": 50136579, "comment_id": 87292881, "body": "@mkopriva using <code>omitempty</code> for the <code>Person</code>&#39;s fields has worked and by far the simplest.  But it will affect my <code>Person</code>&#39;s fields encoding when I want to keep showing, for example, <code>Person.name</code> in the marshal result when it is empty"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1525272123, "post_id": 50136579, "comment_id": 87292997, "body": "You can use the alternative in my second comment or you&#39;ll have to implement the Marshaler interface on the Response type, I think that&#39;s pretty much all the options you&#39;re left with."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1525272502, "post_id": 50136579, "comment_id": 87293245, "body": "this one&#39;s a bit ugly but works without having to compromise your original structure. <a href=\"https://play.golang.org/p/1qkSCWZ225j\" rel=\"nofollow noreferrer\">play.golang.org/p/1qkSCWZ225j</a>"}, {"owner": {"reputation": 185, "user_id": 4243035, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/cn7mx.png?s=128&g=1", "display_name": "tama", "link": "https://stackoverflow.com/users/4243035/tama"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1525272776, "post_id": 50136579, "comment_id": 87293451, "body": "@mkopriva thanks for all the answer. I decided to use your second alternative. It&#39;s simple enough to implement. You can post your answer to this question so I could accept."}], "answers": [{"tags": [], "owner": {"reputation": 231, "user_id": 3578692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8abcd270aa5bfa384e94a2fdb89d509e?s=128&d=identicon&r=PG&f=1", "display_name": "Metatrix", "link": "https://stackoverflow.com/users/3578692/metatrix"}, "is_accepted": false, "score": 0, "last_activity_date": 1525271108, "last_edit_date": 1525271108, "creation_date": 1525270529, "answer_id": 50136852, "question_id": 50136579, "link": "https://stackoverflow.com/questions/50136579/how-to-show-empty-object-instead-of-empty-struct-or-nil-in-go-json-marshal/50136852#50136852", "title": "How to show empty object instead of empty struct or nil in Go json marshal", "body": "<p>In Go, an empty struct by definition assigns zero values to field elements. Eg:  for int 0, \"\" for string, etc.</p>\n\n<p>For your case, simply comparing to null would work out. Or, you could define an emptyPerson as:</p>\n\n<pre><code> var BAD_AGE = -1\n emptyPerson := &amp;Person{\"\", BAD_AGE} // BAD_AGE indicates no person\n if person[age] == BAD_AGE {\n    // handle case for emptyPerson}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 7, "last_activity_date": 1525273781, "creation_date": 1525273781, "answer_id": 50137942, "question_id": 50136579, "link": "https://stackoverflow.com/questions/50136579/how-to-show-empty-object-instead-of-empty-struct-or-nil-in-go-json-marshal/50137942#50137942", "title": "How to show empty object instead of empty struct or nil in Go json marshal", "body": "<p>Option <strong>A</strong>, use the <code>omitempty</code> tag option on all of the <code>Person</code>'s fields and make sure the response's field is allocated before marshaling.</p>\n\n<pre><code>type Person struct {\n    Name string `json:\"name,omitempty\"`\n    Age  int    `json:\"age,omitempty\"`\n}\n\n// ...\n\nresp.Person = new(Person)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/o3jWdru_8bC\" rel=\"noreferrer\">https://play.golang.org/p/o3jWdru_8bC</a></p>\n\n<hr>\n\n<p>Option <strong>B</strong>, use a <em>non-pointer</em> wrapper type that embeds the <code>Person</code> pointer type.</p>\n\n<pre><code>type PersonJSON struct {\n    *Person\n}\n\ntype Response struct {\n    Person      PersonJSON `json:\"person\"`\n    CreatedDate time.Time   `json:\"created_date\"`\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/EKQc7uf1_Vk\" rel=\"noreferrer\">https://play.golang.org/p/EKQc7uf1_Vk</a></p>\n\n<hr>\n\n<p>Option <strong>C</strong>, have the <code>Reponse</code> type implement the <code>json.Marshaler</code> interface.</p>\n\n<pre><code>func (r *Response) MarshalJSON() ([]byte, error) {\n    type tmp Response\n    resp := (*tmp)(r)\n\n    var data struct {\n        Wrapper struct {\n            *Person\n        } `json:\"person\"`\n        *tmp\n    }\n    data.Wrapper.Person = resp.Person\n    data.tmp = resp\n    return json.Marshal(data)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/1qkSCWZ225j\" rel=\"noreferrer\">https://play.golang.org/p/1qkSCWZ225j</a></p>\n\n<hr>\n\n<p>There may be other options...</p>\n"}], "owner": {"reputation": 185, "user_id": 4243035, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/cn7mx.png?s=128&g=1", "display_name": "tama", "link": "https://stackoverflow.com/users/4243035/tama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3307, "favorite_count": 1, "accepted_answer_id": 50137942, "answer_count": 2, "score": 4, "last_activity_date": 1525273781, "creation_date": 1525269827, "question_id": 50136579, "link": "https://stackoverflow.com/questions/50136579/how-to-show-empty-object-instead-of-empty-struct-or-nil-in-go-json-marshal", "title": "How to show empty object instead of empty struct or nil in Go json marshal", "body": "<p>I need to show json's empty object <code>{}</code> when do <code>json.Marshal()</code> for a struct pointer. I can only output either <code>null</code> value or empty struct value. </p>\n\n<p>If the <code>person</code> key is filled with <code>&amp;Person{}</code> or <code>new(Person)</code>, it will show empty struct like below:</p>\n\n<pre><code>{\n    \"data\": {\n        \"person\": {\n            \"name\": \"\",\n            \"age\": 0\n        },\n        \"created_date\": \"2009-11-10T23:00:00Z\"\n    }\n}\n</code></pre>\n\n<p>And if we don't initialize it at all, it will show <code>null</code>.</p>\n\n<pre><code>{\n    \"data\": {\n        \"person\": null,\n        \"created_date\": \"2009-11-10T23:00:00Z\"\n    }\n}\n</code></pre>\n\n<p>I want to show <code>\"person\": {}</code>. Is it possible?</p>\n\n<p>Go Playground for the complete code: <a href=\"https://play.golang.org/p/tT15G2ESPVc\" rel=\"nofollow noreferrer\">https://play.golang.org/p/tT15G2ESPVc</a></p>\n"}, {"tags": ["go", "visual-studio-code"], "answers": [{"tags": [], "owner": {"reputation": 52116, "user_id": 197788, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/851acbab08553d1f7aa3eecad17f6aa9?s=128&d=identicon&r=PG", "display_name": "Ken Bloom", "link": "https://stackoverflow.com/users/197788/ken-bloom"}, "is_accepted": true, "score": 5, "last_activity_date": 1525269022, "creation_date": 1525269022, "answer_id": 50136308, "question_id": 50136257, "link": "https://stackoverflow.com/questions/50136257/go-code-not-working/50136308#50136308", "title": "Go code not working", "body": "<p>The import block is supposed to be surrounded in parentheses, not braces.</p>\n\n<pre><code>import (\n    \"database/sql\"\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"github.com/gorilla/mux\"\n    _ \"github.com/lib/pq\"\n)\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 1535188, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f9e09c74bcb99a611b3a266e5f464a6c?s=128&d=identicon&r=PG", "display_name": "Kavish Dwivedi", "link": "https://stackoverflow.com/users/1535188/kavish-dwivedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 633, "favorite_count": 0, "accepted_answer_id": 50136308, "answer_count": 1, "score": 0, "last_activity_date": 1527279607, "creation_date": 1525268884, "last_edit_date": 1527279607, "question_id": 50136257, "link": "https://stackoverflow.com/questions/50136257/go-code-not-working", "title": "Go code not working", "body": "<p>I am trying out following sample snippet to run on my vscode editor</p>\n\n<p>below is a snippen which i think is problematic. Vscode does point to some error but maybe I am missing that.</p>\n\n<blockquote>\n  <p>app.go</p>\n</blockquote>\n\n<pre><code>package main\n\nimport {\n    \"database/sql\"\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"github.com/gorilla/mux\"\n    _ \"github.com/lib/pq\"\n}\n\ntype App struct {\n    Router *mux.Router\n    DB *sql.DB\n}\n//init and other functions here\n</code></pre>\n\n<blockquote>\n  <p>model.go</p>\n</blockquote>\n\n<pre><code>package main\n\ntype product struct {\n   ID    int     `json:\"id\"`\n   Name  string  `json:\"name\"`\n   Price float64 `json:\"price\"`\n}\n//some code below\n</code></pre>\n\n<p>When I try to run vscode debugger with above given settings, it gives me below errors:</p>\n\n<pre><code>can't load package: package .: \napp.go:3:8: expected 'STRING', found '{'\napp.go:4:2: expected ';', found 'STRING' \"database/sql\"\nexit status 1\nProcess exiting with code: 1\n</code></pre>\n\n<p>I am not able to debug as this is very vague to me and I have tried looking for it on other forums. Would be greatful if someone can help with what to do with the above error.</p>\n"}, {"tags": ["go", "error-handling"], "answers": [{"comments": [{"owner": {"reputation": 231, "user_id": 3578692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8abcd270aa5bfa384e94a2fdb89d509e?s=128&d=identicon&r=PG&f=1", "display_name": "Metatrix", "link": "https://stackoverflow.com/users/3578692/metatrix"}, "edited": false, "score": 0, "creation_date": 1525269828, "post_id": 50136380, "comment_id": 87291282, "body": "+1 for this way. There is another way to do it using panic/recover, but that feels hackish and non-Golang way to do it"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 231, "user_id": 3578692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8abcd270aa5bfa384e94a2fdb89d509e?s=128&d=identicon&r=PG&f=1", "display_name": "Metatrix", "link": "https://stackoverflow.com/users/3578692/metatrix"}, "edited": false, "score": 1, "creation_date": 1525274677, "post_id": 50136380, "comment_id": 87294714, "body": "@Metatrix: Yeah, don&#39;t do that. That would be some very non-idiomatic Go."}, {"owner": {"reputation": 2702, "user_id": 2923336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LmjCO.png?s=128&g=1", "display_name": "Francois", "link": "https://stackoverflow.com/users/2923336/francois"}, "edited": false, "score": 0, "creation_date": 1525318339, "post_id": 50136380, "comment_id": 87311168, "body": "Agree with that solution but I prefer <code>x.Err</code> instead of <code>x.Error</code>, usually reserve Error for error interface implementation."}, {"owner": {"reputation": 39041, "user_id": 27358, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fed1635f89478c88eda07e87de452bcf?s=128&d=identicon&r=PG", "display_name": "David Moles", "link": "https://stackoverflow.com/users/27358/david-moles"}, "edited": false, "score": 0, "creation_date": 1546633765, "post_id": 50136380, "comment_id": 94926749, "body": "This is OK for designing your own APIs, but it&#39;s not much help working with libraries that all return <code>(something, error)</code>."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 5, "last_activity_date": 1525269263, "creation_date": 1525269263, "answer_id": 50136380, "question_id": 50136113, "link": "https://stackoverflow.com/questions/50136113/go-error-checking-and-chaining/50136380#50136380", "title": "Go error checking and chaining", "body": "<p>Make your methods return only a single value, so they can be chained, and store the error value in that returned value, to check after.  Example:</p>\n\n<pre><code>type FieldElement struct {\n    Num   int\n    Prime int\n    Error error\n}\n\nfunc (el *FieldElement) Add(o FieldElement) *FieldElement {\n    if el.Error != nil {\n        // An error already happened, so do nothing\n        return el\n    }\n    if el.Prime != o.Prime {\n        el.Error = errors.New(\"cannot operate on two numbers in different Fields\")\n    } else {\n        el.Num = (el.Num + o.Num) &amp; el.Prime\n    }\n    return el\n}\n</code></pre>\n\n<p>Then use it like this:</p>\n\n<pre><code>    x.Add(...).Mul(...).Sub(...) // etc\n    if x.Error != nil {\n        // handle error here\n    }\n</code></pre>\n"}], "owner": {"reputation": 96, "user_id": 1949741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134de519f8988f03987a786ebff943b3?s=128&d=identicon&r=PG", "display_name": "404 not found", "link": "https://stackoverflow.com/users/1949741/404-not-found"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1525269263, "creation_date": 1525268460, "last_edit_date": 1525268849, "question_id": 50136113, "link": "https://stackoverflow.com/questions/50136113/go-error-checking-and-chaining", "title": "Go error checking and chaining", "body": "<pre><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n)\n\ntype FieldElement struct {\n    Num   int\n    Prime int\n}\n\nfunc (el *FieldElement) Add(o FieldElement) (FieldElement, error) {\n    if el.Prime != o.Prime {\n        return FieldElement{}, errors.New(\"cannot operate on two numbers in different Fields\")\n    }\n    return FieldElement{(el.Num + o.Num) % el.Prime, el.Prime}, nil\n}\n\n// Sub, Mul, Div and Pow also members of FieldElement returning (FieldElement, error)\n\nfunc main() {\n    a := FieldElement{13, 19}\n    b := FieldElement{9, 19}\n    fmt.Println(a.Add(b))\n}\n\ntype Point struct {\n    X        FieldElement\n    Y        FieldElement\n    A        FieldElement\n    B        FieldElement\n}\n</code></pre>\n\n<p>Now upon <code>Point</code> creation I want to check if a point is on the curve defined as <code>y^2 = x^3 + ax + b</code></p>\n\n<p>Each operation of FieldElement returns 2 values to satisfy the error checking.</p>\n\n<p>So I can not do </p>\n\n<pre><code>x.Pow(3).Add(a.Mul(x)).Add(b)\n</code></pre>\n\n<p>and end up with</p>\n\n<pre><code>pow3, e1 := x.Pow(three)\nmul, e2 := a.Mul(x)\nadd, e3 := pow3.Add(mul)\nrval, e4 := add.Add(b)\n// check that y^2 == rval \n</code></pre>\n\n<p>This makes the code hard to follow, what is the golang way to properly do this?</p>\n\n<p><a href=\"https://play.golang.org/p/fR4WdvYuiAF\" rel=\"nofollow noreferrer\">playground</a></p>\n"}, {"tags": ["mysql", "testing", "go"], "answers": [{"comments": [{"owner": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "edited": false, "score": 0, "creation_date": 1525260533, "post_id": 50133437, "comment_id": 87285049, "body": "Argh... the err not being defined caught me. <a href=\"https://github.com/unee-t/processInvitations/commit/74bce5e090299ffcea221eacc6ce2a05d139d29d\" rel=\"nofollow noreferrer\">github.com/unee-t/processInvitations/commit/&hellip;</a> Hate that about go. Thanks! Let me know if you any other feedback on my code."}, {"owner": {"reputation": 231, "user_id": 3578692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8abcd270aa5bfa384e94a2fdb89d509e?s=128&d=identicon&r=PG&f=1", "display_name": "Metatrix", "link": "https://stackoverflow.com/users/3578692/metatrix"}, "reply_to_user": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "edited": false, "score": 0, "creation_date": 1525267666, "post_id": 50133437, "comment_id": 87289625, "body": "You&#39;re welcome! I would recommend changing the name to - &quot;Global variable defined in one function does not keep definition in another&quot;. That way, several people having a similar issue would be able to quickly debug it. This problem would be relatively common in Go."}], "tags": [], "owner": {"reputation": 231, "user_id": 3578692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8abcd270aa5bfa384e94a2fdb89d509e?s=128&d=identicon&r=PG&f=1", "display_name": "Metatrix", "link": "https://stackoverflow.com/users/3578692/metatrix"}, "is_accepted": true, "score": 5, "last_activity_date": 1525260000, "creation_date": 1525260000, "answer_id": 50133437, "question_id": 50133266, "link": "https://stackoverflow.com/questions/50133266/global-variable-defined-in-one-function-does-not-keep-definition-in-another/50133437#50133437", "title": "Global variable defined in one function does not keep definition in another", "body": "<p>Your line <code>db, err := sql.Open(\"mysql\", os.Getenv(\"DSN\"))</code> creates a local variable db (local to function TestMain). Instead use:</p>\n\n<pre><code>err := nil\ndb, err = sql.Open(\"mysql\", os.Getenv(\"DSN\"))\n</code></pre>\n"}], "owner": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 50133437, "answer_count": 1, "score": 1, "last_activity_date": 1525314692, "creation_date": 1525259520, "last_edit_date": 1525314692, "question_id": 50133266, "link": "https://stackoverflow.com/questions/50133266/global-variable-defined-in-one-function-does-not-keep-definition-in-another", "title": "Global variable defined in one function does not keep definition in another", "body": "<p>After some reading, I think I need this <code>TestMain(m *testing.M)</code> construct to setup my database. However when it comes to running a test, db is always <strong>nil</strong>. How do I fix this?</p>\n\n<pre><code>var db *sql.DB\n\nfunc TestMain(m *testing.M) {\n\n        db, err := sql.Open(\"mysql\", os.Getenv(\"DSN\"))\n        if err != nil {\n                log.Fatal(\"error opening database\")\n        }\n\n        defer db.Close()\n        log.Printf(\"here testing with %v\", db)\n        code := m.Run()\n        log.Printf(\"finished test\")\n        os.Exit(code)\n\n}\n\nfunc Test_getRole(t *testing.T) {\n        if db == nil {\n                t.Fatalf(\"db is nil\")\n        }\n}\n</code></pre>\n\n<p>Output is:</p>\n\n<pre><code>2018/05/02 19:10:14 here testing with &amp;{{bugzilla:SECRET@tcp(example.com:3306)/bugzilla?multiStatements=true 0x7aba40} 0 {0 0} [] map[] 0 0 0xc42001e180 0xc4200740c0 false map[] map[] 0 0 0 &lt;nil&gt; 0x4e9850}\n--- FAIL: Test_getRole (0.00s)\n        main_test.go:32: db is nil\n</code></pre>\n\n<p><a href=\"https://github.com/unee-t/processInvitations/blob/testfail/main_test.go#L43\" rel=\"nofollow noreferrer\">https://github.com/unee-t/processInvitations/blob/testfail/main_test.go#L43</a> is a link to the full piece of code.</p>\n"}, {"tags": ["go", "reflection", "callback"], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 4, "last_activity_date": 1525258548, "creation_date": 1525258548, "answer_id": 50132940, "question_id": 50132870, "link": "https://stackoverflow.com/questions/50132870/how-to-retype-a-function-in-golang/50132940#50132940", "title": "How to retype a function in Golang?", "body": "<p>You should not be using reflection for this. You should make your handlers be of type <code>func()</code>, then just pass in an anonymous function (possibly a closure) that handles any necessary arguments directly.  Example:</p>\n\n<pre><code>atexit.Register(func() {\n    handler(b)\n})\n</code></pre>\n"}], "owner": {"reputation": 459, "user_id": 1869278, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/52e2f8c81b2630421249ce8fdb712724?s=128&d=identicon&r=PG", "display_name": "Kostrahb", "link": "https://stackoverflow.com/users/1869278/kostrahb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 50132940, "answer_count": 1, "score": 0, "last_activity_date": 1525258809, "creation_date": 1525258310, "last_edit_date": 1525258809, "question_id": 50132870, "link": "https://stackoverflow.com/questions/50132870/how-to-retype-a-function-in-golang", "title": "How to retype a function in Golang?", "body": "<p>In my current Golang project, I use buffering of logs before sending them to Elasticsearch within my log library. I want to introduce something like C <code>atexit()</code> function to flush all pending logs in case of an unexpected exit.</p>\n\n<p>I have found <a href=\"https://github.com/tebeka/atexit\" rel=\"nofollow noreferrer\">atexit</a> library but it was insufficient in my case because it does not allow passing of arguments to handler functions. I decided to write my version and ended up with roughly similar structure. I have module atexit:</p>\n\n<pre><code>package atexit\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"reflect\"\n)\n\nvar handlers []interface{}\nvar params []interface{}\n\nfunc runHandler(handler interface{}, p interface{}) {\n    defer func() {\n        if err := recover(); err != nil {\n            fmt.Fprintln(os.Stderr, \"error: atexit handler error:\", err)\n        }\n    }()\n\n    f := reflect.ValueOf(handler)\n    s := reflectSlice(p)\n    fmt.Printf(\"%#v\", s)\n    f.Call(s)\n}\n\nfunc reflectSlice(slice interface{}) []reflect.Value {\n    s := reflect.ValueOf(slice)\n    if s.Kind() != reflect.Slice {\n        panic(\"InterfaceSlice() given a non-slice type\")\n    }\n\n    ret := make([]reflect.Value, s.Len())\n\n    for i:=0; i&lt;s.Len(); i++ {\n        ret[i] = reflect.ValueOf(s.Index(i))\n    }\n\n    return ret\n}\n\nfunc runHandlers() {\n    for i, handler := range handlers {\n        runHandler(handler, params[i])\n    }\n}\n\nfunc Exit(code int) {\n    runHandlers()\n    os.Exit(code)\n}\n\nfunc Register(handler interface{}, p interface{}) {\n    f := reflect.TypeOf(handler)\n    if f.Kind() != reflect.Func {\n        panic(\"Register() given a non-function type\")\n    }\n    handlers = append(handlers, handler)\n    params = append(params, p)\n}\n</code></pre>\n\n<p>and I am calling it from the main program:</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"./atexit\"\n    \"encoding/json\"\n    \"reflect\"\n)\n\ntype Batch struct {\n    Index string        `json:\"index\"`\n    Type string     `json:\"_Type\"`\n    Content interface{} `json:\"Content\"`\n}\n\nfunc flush(b ...interface{}) {\n    for _, entry := range(b) {\n        fmt.Printf(\"%#v\\n\", entry)\n        fmt.Println(reflect.TypeOf(reflect.ValueOf(entry)))\n        fmt.Println(reflect.TypeOf(entry))\n        a, err  := json.Marshal(entry)\n        if err != nil {\n            fmt.Println(\"error!\")\n        }\n        fmt.Println(string(a))\n    }\n}\n\nfunc handler(v ...interface{}) {\n    fmt.Println(\"Exiting\")\n    for _, batch := range(v) {\n        fmt.Printf(\"%#v\\n\", batch)\n    }\n}\n\nfunc main() {\n    type ColorGroup struct {\n        ID     int\n        Name   string\n        Colors []string\n    }\n    group := ColorGroup{\n        ID:     1,\n        Name:   \"Reds\",\n        Colors: []string{\"Crimson\", \"Red\", \"Ruby\", \"Maroon\"},\n    }\n    fmt.Printf(\"%#v\\n\", group)\n    r, err := json.Marshal(group)\n    if err != nil {\n        fmt.Println(\"error:\", err)\n    }\n    fmt.Println(string(r))\n\n\n    b := []Batch{Batch{\"index\", \"type\", \"content1\"},Batch{\"index\", \"type\", \"content2\"}}\n    atexit.Register(handler, b)\n    atexit.Register(flush, []ColorGroup{group})\n    atexit.Exit(0)\n}\n</code></pre>\n\n<p>As you can see, by calling <code>reflect.ValueOf()</code> I get structure <code>reflect.Value</code> which is then passed to callback function. The problem seems to be that this structure does not contain metadata about json export or is not handled correctly with <code>json.Marshal()</code>, which then outputs empty json. Is there any way I can pass correct <code>[]interface{}</code> structure to the callback function or some similar mechanism which would do roughly what I'm trying to accomplish? Please note that I want a general callback mechanism which should be independent of the type passed to it. So far it seems to be impossible or at least very limited by <code>f.Call(s)</code>, which is called in <code>runHandler()</code> and takes reflect.Value as its parameter.</p>\n"}, {"tags": ["generics", "go", "casting", "type-conversion", "type-assertion"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1525258610, "post_id": 50132610, "comment_id": 87283785, "body": "What are you supposed to do for what? What are you trying to accomplish?"}, {"owner": {"reputation": 3258, "user_id": 1085848, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/86a0ff3564f750b3ed49cfc8b57f1275?s=128&d=identicon&r=PG", "display_name": "TomSawyer", "link": "https://stackoverflow.com/users/1085848/tomsawyer"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1525259174, "post_id": 50132610, "comment_id": 87284147, "body": "@Flimzy i don&#39;t want to list all integer types, and do it with one single line. like <code>return time.Unix(int64(t.(trueType)), 0).Format(f)</code>. You didn&#39;t see the trouble here? With a single function i have to switch/case atleast 8 times to do a simple task"}, {"owner": {"reputation": 3258, "user_id": 1085848, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/86a0ff3564f750b3ed49cfc8b57f1275?s=128&d=identicon&r=PG", "display_name": "TomSawyer", "link": "https://stackoverflow.com/users/1085848/tomsawyer"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1525259245, "post_id": 50132610, "comment_id": 87284180, "body": "@Flimzy <code>I have searched many days for solution convert interface{} to its true type without using type assertion but didn&#39;t work.</code> Didn&#39;t read this line?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1525259268, "post_id": 50132610, "comment_id": 87284196, "body": "I don&#39;t see the trouble, because I don&#39;t see what you&#39;re trying to accomplish. You&#39;re focusing on a specific solution, but haven&#39;t explained the problem yet.  What is the reason you need that switch statement? What is the <i>goal</i> you are trying to achieve?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1525259354, "post_id": 50132610, "comment_id": 87284251, "body": "I&#39;ve been using Go for database access with gorm and similar libraries for years, and never felt the need for a large switch statement like you have in your question. There&#39;s almost certainly a different way to approach your problem, but without knowing your goal, it&#39;s hard to say.  In other words, this looks like an XY problem."}, {"owner": {"reputation": 3258, "user_id": 1085848, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/86a0ff3564f750b3ed49cfc8b57f1275?s=128&d=identicon&r=PG", "display_name": "TomSawyer", "link": "https://stackoverflow.com/users/1085848/tomsawyer"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1525259464, "post_id": 50132610, "comment_id": 87284340, "body": "@Flimzy I simply want to avoid having error while convert all integer types to string without using switch/case. If you can provide other approach, please do it. I switched from other language to Go, and lacking of generics cause many trouble with me. This is the example."}, {"owner": {"reputation": 2651, "user_id": 3482664, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/O1Qex.png?s=128&g=1", "display_name": "Tom Wright", "link": "https://stackoverflow.com/users/3482664/tom-wright"}, "edited": false, "score": 0, "creation_date": 1525259824, "post_id": 50132610, "comment_id": 87284560, "body": "It looks to me like he may be writing the row results to a map rather than directly into a struct, and then doing the conversion himself later on. I&#39;ve done this before and started getting types like <code>[]uint8</code> instead of the ones I expected"}, {"owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "edited": false, "score": 0, "creation_date": 1525269588, "post_id": 50132610, "comment_id": 87291095, "body": "Your goal is to provide a formatting function that converts unix timestamps to formatted date strings. Is that correct?"}], "answers": [{"tags": [], "owner": {"reputation": 2651, "user_id": 3482664, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/O1Qex.png?s=128&g=1", "display_name": "Tom Wright", "link": "https://stackoverflow.com/users/3482664/tom-wright"}, "is_accepted": true, "score": 1, "last_activity_date": 1525259363, "creation_date": 1525259363, "answer_id": 50133209, "question_id": 50132610, "link": "https://stackoverflow.com/questions/50132610/solution-for-type-assertion-without-generics-with-golang/50133209#50133209", "title": "Solution for type assertion without generics with Golang?", "body": "<p>I've not used gorm, but I think that something like this could solve your problem:</p>\n\n<pre><code>func formatUnix(t interface{}, f string) (string, error) {\n    timestampStr := fmt.Sprint(t)\n    timestamp, err := strconv.ParseInt(timestampStr, 10, 64)\n    if err != nil {\n        return \"\", err\n    }\n    return time.Unix(timestamp, 0).Format(f), nil\n}\n</code></pre>\n\n<p>Rather than listing all potential types, it simply converts the <code>interface{}</code> to a <code>string</code> using <code>fmt.Sprint()</code> and then convert the <code>string</code> to <code>int64</code> using <code>strconv.ParseInt()</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 3258, "user_id": 1085848, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/86a0ff3564f750b3ed49cfc8b57f1275?s=128&d=identicon&r=PG", "display_name": "TomSawyer", "link": "https://stackoverflow.com/users/1085848/tomsawyer"}, "edited": false, "score": 0, "creation_date": 1525280169, "post_id": 50133341, "comment_id": 87297933, "body": "Gorm supports both pointer type and normal type, datetime field can be <code>int</code> or <code>*int</code>, so it means if the filed type is a pointer, template function can&#39;t convert it to string"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 3258, "user_id": 1085848, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/86a0ff3564f750b3ed49cfc8b57f1275?s=128&d=identicon&r=PG", "display_name": "TomSawyer", "link": "https://stackoverflow.com/users/1085848/tomsawyer"}, "edited": false, "score": 0, "creation_date": 1525280324, "post_id": 50133341, "comment_id": 87298023, "body": "I don&#39;t know what template functions you&#39;re talking about, but since this question doesn&#39;t deal with templates, a separate question is probably in order."}, {"owner": {"reputation": 3258, "user_id": 1085848, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/86a0ff3564f750b3ed49cfc8b57f1275?s=128&d=identicon&r=PG", "display_name": "TomSawyer", "link": "https://stackoverflow.com/users/1085848/tomsawyer"}, "edited": false, "score": 0, "creation_date": 1525315993, "post_id": 50133341, "comment_id": 87310566, "body": "It&#39;s a part of the question. You see i mentioned the pointer type in the question <code>*int</code>, and <code>Sprint(*i)</code> doesn&#39;t work with pointer type"}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 1, "last_activity_date": 1525259755, "creation_date": 1525259755, "answer_id": 50133341, "question_id": 50132610, "link": "https://stackoverflow.com/questions/50132610/solution-for-type-assertion-without-generics-with-golang/50133341#50133341", "title": "Solution for type assertion without generics with Golang?", "body": "<p>Based on your comments, it sounds like you're concerned with converting any numeric type to a string. This is easily done with <a href=\"https://golang.org/pkg/fmt/#Sprint\" rel=\"nofollow noreferrer\"><code>fmt.Sprint</code></a>:</p>\n\n<pre><code>stringValue := fmt.Sprint(i) // i is any type\n</code></pre>\n\n<p>But this has nothing to do with GORM.</p>\n\n<p>On the other hand, if your problem is that GORM is returning an unpredictable type, just change your select statement to always return a string.  For example, for MySQL, something like:</p>\n\n<pre><code>SELECT CAST(someNumberColumn AS VARCHAR) AS stringColumn\n</code></pre>\n\n<p>or</p>\n\n<pre><code>SELECT CAST(someNumberColumn AS INT) AS intColumn\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3258, "user_id": 1085848, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/86a0ff3564f750b3ed49cfc8b57f1275?s=128&d=identicon&r=PG", "display_name": "TomSawyer", "link": "https://stackoverflow.com/users/1085848/tomsawyer"}, "edited": false, "score": 0, "creation_date": 1525276968, "post_id": 50137171, "comment_id": 87296155, "body": "I didn&#39;t say this is the problem with gorm. It&#39;s golang problem, it doesn&#39;t support generics. This is why we have to use switch/case to type assert all types. Using <code>int64</code> causes the memory. Why i have to use <code>int64</code> with field has only 0,1,2 numbers. And this is for design pattern, we can&#39;t force other developers to use only <code>int64</code> in datetime field while <code>gorm</code> support every integer types it means anyone can use any type for any field they wanted, so the logic code have to handle all of it."}, {"owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "reply_to_user": {"reputation": 3258, "user_id": 1085848, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/86a0ff3564f750b3ed49cfc8b57f1275?s=128&d=identicon&r=PG", "display_name": "TomSawyer", "link": "https://stackoverflow.com/users/1085848/tomsawyer"}, "edited": false, "score": 0, "creation_date": 1525325957, "post_id": 50137171, "comment_id": 87313467, "body": "I did not suggest to use int64 for all number fields. Just use it for the timestamps. You can use int32 if you are concerned about memory, but it should be at least 32 bit for unix timestamps. Printing out any other number as a formatted date string does not really make sense, or am I missing something?   Because something is possible, does not mean that you should use it. Why would you use an arbitrary number of data types for the same type of data? It is a sensible convention to specify that all timestamps are saved in 32 bit. Then your func could accept <code>int32</code> instead of <code>interface{}</code>."}, {"owner": {"reputation": 3258, "user_id": 1085848, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/86a0ff3564f750b3ed49cfc8b57f1275?s=128&d=identicon&r=PG", "display_name": "TomSawyer", "link": "https://stackoverflow.com/users/1085848/tomsawyer"}, "edited": false, "score": 0, "creation_date": 1525340398, "post_id": 50137171, "comment_id": 87321178, "body": "There are millions of code logic. Like the example above: convert unixtimestamp (integer data fields) to formatted string. Since then gorm supports all type of integers. What will you do to solve this trouble? Like i sasid, sensible convention or common sense is based on perspective of each developer, not everyone have the same coding style and for doing good, we have to trap all the cases in code logic. Using <code>Sprint</code> actually a nice trick, but not a proper way to solve the trouble like having generics"}, {"owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "reply_to_user": {"reputation": 3258, "user_id": 1085848, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/86a0ff3564f750b3ed49cfc8b57f1275?s=128&d=identicon&r=PG", "display_name": "TomSawyer", "link": "https://stackoverflow.com/users/1085848/tomsawyer"}, "edited": false, "score": 0, "creation_date": 1525346590, "post_id": 50137171, "comment_id": 87325119, "body": "Sorry, I was only trying to help. I tried to answer your question to my knowledge and my understanding."}], "tags": [], "owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "is_accepted": false, "score": 0, "last_activity_date": 1525271427, "creation_date": 1525271427, "answer_id": 50137171, "question_id": 50132610, "link": "https://stackoverflow.com/questions/50132610/solution-for-type-assertion-without-generics-with-golang/50137171#50137171", "title": "Solution for type assertion without generics with Golang?", "body": "<p>I do not think that this is a problem with go or gorm. I am a bit baffled that you save your unix timestamps in many different formats. BTW, A unix timestamp is 32 bit, so there is no point in converting (and saving in the first place) any 8 bit ints.</p>\n\n<p>A solution would be to use a unified data type (int64) for all timestamps in your structs. After that your formatting func can accept <code>int64</code> instead of<code>interface{}</code>, without the need of any type assertions.</p>\n"}], "owner": {"reputation": 3258, "user_id": 1085848, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/86a0ff3564f750b3ed49cfc8b57f1275?s=128&d=identicon&r=PG", "display_name": "TomSawyer", "link": "https://stackoverflow.com/users/1085848/tomsawyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 434, "favorite_count": 0, "accepted_answer_id": 50133209, "answer_count": 3, "score": -1, "last_activity_date": 1525271427, "creation_date": 1525257432, "last_edit_date": 1525258596, "question_id": 50132610, "link": "https://stackoverflow.com/questions/50132610/solution-for-type-assertion-without-generics-with-golang", "title": "Solution for type assertion without generics with Golang?", "body": "<p>I'm using gorm, and it allows many data types like <code>int, uint, int8, uint8 ....</code></p>\n\n<p>Then I have a plugin in template like this:</p>\n\n<pre><code>f[\"UNIX2STR\"] = func(t interface{}, f string) string {\n        switch t.(type) {\n        case int:\n            return time.Unix(int64(t.(int)), 0).Format(f)\n        case uint:\n            return time.Unix(int64(t.(uint)), 0).Format(f)\n        case uint8:\n            return time.Unix(int64(t.(uint8)), 0).Format(f)\n        case *int:\n            return time.Unix(int64(*t.(*int)), 0).Format(f)\n        case *uint:\n            return time.Unix(int64(*t.(*uint)), 0).Format(f)\n        case *uint8:\n            return time.Unix(int64(*t.(*uint8)), 0).Format(f)\n        .....\n        default:\n            return \"\"\n        }\n        // return time.Unix(int64(t), 0).Format(f)\n    }\n</code></pre>\n\n<p>It converts all integer types to formatted string.\nSo what am I suppose to do? List all gorm supported int types and cast it to <code>int64</code>?</p>\n\n<p>I have searched many days for solution convert <code>interface{}</code> to its true type without using type assertion but didn't work.</p>\n"}, {"tags": ["go", "glide-golang"], "comments": [{"owner": {"reputation": 1362, "user_id": 18703, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/45b0ee94acfbcc06f333f2daf03d4c91?s=128&d=identicon&r=PG", "display_name": "Hace", "link": "https://stackoverflow.com/users/18703/hace"}, "edited": false, "score": 0, "creation_date": 1526971912, "post_id": 50131761, "comment_id": 87936001, "body": "Looking at the code, by default the users home folder is the cache directory. <a href=\"https://github.com/Masterminds/glide-report/blob/master/vendor/github.com/Masterminds/glide/path/path.go\" rel=\"nofollow noreferrer\">github.com/Masterminds/glide-report/blob/master/vendor/&hellip;</a> Anyway, having multiple projects using the same cache sounds efficient, not sure why you want to have separate caches per repository?"}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 4545203, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XoORkCSefi0/AAAAAAAAAAI/AAAAAAAAAYs/0hzixEM1gJ0/photo.jpg?sz=128", "display_name": "yijinliu", "link": "https://stackoverflow.com/users/4545203/yijinliu"}, "is_accepted": false, "score": 0, "last_activity_date": 1549915057, "creation_date": 1549915057, "answer_id": 54638148, "question_id": 50131761, "link": "https://stackoverflow.com/questions/50131761/specify-cache-directory-for-go-glide/54638148#54638148", "title": "Specify cache directory for Go-Glide", "body": "<p>I use GLIDE_HOME=XXX to change it.</p>\n"}], "owner": {"reputation": 923, "user_id": 2822921, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/a240cddfed87fa7da86cb9e4b1d6ef05?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwin", "link": "https://stackoverflow.com/users/2822921/ashwin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 543, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553440833, "creation_date": 1525254896, "last_edit_date": 1553440833, "question_id": 50131761, "link": "https://stackoverflow.com/questions/50131761/specify-cache-directory-for-go-glide", "title": "Specify cache directory for Go-Glide", "body": "<p>Is there a way to specify a cache directory in Glide command ?</p>\n\n<p><code>glide install --strip-vendor</code> </p>\n\n<p>Above command uses ~/.glide/cache directory as cache by default. </p>\n\n<p>Is there a way to specify custom directory to use for cache or is there a way to avoid considering cache directory itself.</p>\n\n<p>I do not want to use <code>glide cache-clear</code> command since multiple glide install command might be running in my environment. So this may affect working of another glide install command.</p>\n"}, {"tags": ["go", "aws-sdk-go"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 3515197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d3e97c34658c9a64e09a826633279ab?s=128&d=identicon&r=PG&f=1", "display_name": "user3515197", "link": "https://stackoverflow.com/users/3515197/user3515197"}, "edited": false, "score": 0, "creation_date": 1525253609, "post_id": 50131256, "comment_id": 87280423, "body": "The problem is that it does exist in the package and in the documentation? <a href=\"https://docs.aws.amazon.com/sdk-for-go/api/service/cognitoidentityprovider/#CognitoIdentityProvider.SignUp\" rel=\"nofollow noreferrer\">docs.aws.amazon.com/sdk-for-go/api/service/&hellip;</a>  and  <a href=\"https://github.com/aws/aws-sdk-go/blob/master/service/cognitoidentityprovider/api.go#L8791\" rel=\"nofollow noreferrer\">github.com/aws/aws-sdk-go/blob/master/service/&hellip;</a>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 41, "user_id": 3515197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d3e97c34658c9a64e09a826633279ab?s=128&d=identicon&r=PG&f=1", "display_name": "user3515197", "link": "https://stackoverflow.com/users/3515197/user3515197"}, "edited": false, "score": 1, "creation_date": 1525253737, "post_id": 50131256, "comment_id": 87280510, "body": "No, it doesn&#39;t exist in the documentation. That link you provided is to a method, not an exported function. That method can only be called on a defined <code>CognitoIdentityProvider</code> instance."}, {"owner": {"reputation": 41, "user_id": 3515197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d3e97c34658c9a64e09a826633279ab?s=128&d=identicon&r=PG&f=1", "display_name": "user3515197", "link": "https://stackoverflow.com/users/3515197/user3515197"}, "edited": false, "score": 1, "creation_date": 1525254369, "post_id": 50131256, "comment_id": 87280946, "body": "Thanks, I was missing this concept, got some working code now."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 2, "last_activity_date": 1525253942, "last_edit_date": 1525253942, "creation_date": 1525253305, "answer_id": 50131256, "question_id": 50130860, "link": "https://stackoverflow.com/questions/50130860/how-to-correctly-import-an-aws-sdk-go-service/50131256#50131256", "title": "How to correctly import an aws-sdk-go service?", "body": "<p>The error says it all. <code>cognitoidentityprovider.SignUp</code> isn't defined, because there is no symbol <code>SignUp</code> exported by the <code>cognitoidentityprovider</code> package.</p>\n\n<p>I'm not really sure what you want to do instead, since I'm not familiar with that SDK, but you're trying to call a function that doesn't exist.  I suggest re-examining the documentation or example you're following. You've probably made a simple mistake.</p>\n\n<p>You seem to be confused by the <a href=\"https://godoc.org/github.com/aws/aws-sdk-go/service/cognitoidentityprovider#CognitoIdentityProvider.SignUp\" rel=\"nofollow noreferrer\">CognitoIdentityProvider.SignUp</a> instance method. But as that's an instance method, and not an exported function, it requires an instance of a <code>CognitoIdentityProvider</code> first:</p>\n\n<pre><code>cip := cognitoidentityprovider.New( ... )\n_, err := cip.SignUp(input)\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 3515197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d3e97c34658c9a64e09a826633279ab?s=128&d=identicon&r=PG&f=1", "display_name": "user3515197", "link": "https://stackoverflow.com/users/3515197/user3515197"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 444, "favorite_count": 0, "accepted_answer_id": 50131256, "answer_count": 1, "score": -1, "last_activity_date": 1525253942, "creation_date": 1525251991, "question_id": 50130860, "link": "https://stackoverflow.com/questions/50130860/how-to-correctly-import-an-aws-sdk-go-service", "title": "How to correctly import an aws-sdk-go service?", "body": "<p>I am fairly new to the Go programming language and completely new to the Go SDK from AWS. I am trying to use a service but I have a strange problem where the types defined by the imported service are found, but the functions of the service are undefined.</p>\n\n<p>This question is not about using the particular service, but just how to correctly import it. My code:</p>\n\n<pre><code>package auth\n\nimport (\n    \"log\"\n\n    \"github.com/aws/aws-sdk-go/aws\"\n    \"github.com/aws/aws-sdk-go/service/cognitoidentityprovider\"\n)\n\nfunc SignUpTest() {\n\n    input := cognitoidentityprovider.SignUpInput{\n        Username: aws.String(\"example@mail.com\"),\n        Password: aws.String(\"test1234\"),\n    }\n\n    _, err := cognitoidentityprovider.SignUp(&amp;input)\n\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>I get the following error when running <code>go build</code>:</p>\n\n<pre><code>auth/signup.go:18:12: undefined: cognitoidentityprovider.SignUp\n</code></pre>\n\n<p>The autocomplete in my IDE also states that it can find the <code>cognitoidentityprovider.SingUpInput</code> struct, but it is unable to find the <code>cognitoidentityprovider.SignUp</code> function.</p>\n\n<p>I use Go 1.10.1 on WSL Ubuntu. I use DEP 0.4.1 for package management. I verified that the AWS SDK is available in the vendor folder and that the cognitoidentityprovider package is available (the <code>SignUp</code>) function is also there.</p>\n\n<p>What am I missing here?</p>\n"}, {"tags": ["go", "redis", "channels"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1525246626, "post_id": 50129226, "comment_id": 87276565, "body": "Can you come up with a standalone runnable code so that is becomes testable in the Playground?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1525248798, "post_id": 50129226, "comment_id": 87277663, "body": "The application does not receive the response from the PUBLISH command. The unconsumed responses eventually back on on the server.  Replace the Send/Flush with call to Do."}, {"owner": {"reputation": 105, "user_id": 9368823, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sam White", "link": "https://stackoverflow.com/users/9368823/sam-white"}, "edited": false, "score": 0, "creation_date": 1525248962, "post_id": 50129226, "comment_id": 87277736, "body": "The playground isn&#39;t really a suitable env for this as the process isn&#39;t meant to finish. This is a botched version with a return in it, but I think it&#39;s timing out while seeding the channel  <a href=\"https://play.golang.org/p/bN__alcggRa\" rel=\"nofollow noreferrer\">play.golang.org/p/bN__alcggRa</a> however in testing locally I&#39;m just seeding the queue as in the playground"}, {"owner": {"reputation": 105, "user_id": 9368823, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sam White", "link": "https://stackoverflow.com/users/9368823/sam-white"}, "edited": false, "score": 0, "creation_date": 1525255322, "post_id": 50129226, "comment_id": 87281615, "body": "ThunderCat makes a solid point - I&#39;ll test this when I&#39;m back home"}, {"owner": {"reputation": 105, "user_id": 9368823, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sam White", "link": "https://stackoverflow.com/users/9368823/sam-white"}, "edited": false, "score": 0, "creation_date": 1525265965, "post_id": 50129226, "comment_id": 87288453, "body": "Just nipped back and tested using Do() rather than send(), seems to be the same result - for reference the code is publicly available here <a href=\"https://gitlab.com/samisagit/go-im-server/blob/changed-redis-handler-buggy/src/main.go#L130\" rel=\"nofollow noreferrer\">gitlab.com/samisagit/go-im-server/blob/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 9368823, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sam White", "link": "https://stackoverflow.com/users/9368823/sam-white"}, "edited": false, "score": 0, "creation_date": 1525438969, "post_id": 50173377, "comment_id": 87368219, "body": "Thanks for your comment Zak, unfortunately the result is the same with and without this case, I originally had no default, then added it to see if it made a difference, but it still had the same issue - I&#39;ll update the code in the question to where it&#39;s at in git tonight"}], "tags": [], "owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "is_accepted": false, "score": 0, "last_activity_date": 1525431551, "creation_date": 1525431551, "answer_id": 50173377, "question_id": 50129226, "link": "https://stackoverflow.com/questions/50129226/golang-channels-getting-stuck/50173377#50173377", "title": "Golang channels getting stuck", "body": "<p>Based on this </p>\n\n<blockquote>\n  <p>I can see from other testing I'm running that this isn't just going\n  slowly and that the messages just aren't being taken from the channel.</p>\n</blockquote>\n\n<p>I think you have a live lock in <code>addRedisSender()</code></p>\n\n<p>The select statement will pseudo randomly select one of the cases, either the <code>killSwitch</code> case, or the <code>&lt;-messageChannel</code>. Except there's also another case, the <code>default</code>. This will always be true, meaning the <code>for {</code> loop will spin for ever consuming all the resources and causing a live lock as the go runtime tries to schedule more and more competing go routines.</p>\n\n<p>If you remove the <code>default: continue</code> case then the for loop will block on the select until there's a message to read, or a kill signal.</p>\n"}, {"tags": [], "owner": {"reputation": 105, "user_id": 9368823, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sam White", "link": "https://stackoverflow.com/users/9368823/sam-white"}, "is_accepted": true, "score": 0, "last_activity_date": 1532461959, "creation_date": 1532461959, "answer_id": 51506535, "question_id": 50129226, "link": "https://stackoverflow.com/questions/50129226/golang-channels-getting-stuck/51506535#51506535", "title": "Golang channels getting stuck", "body": "<p>For future ref this ended up being the first <code>for</code> loop in <code>RedisWriteHandler</code>. There are no blocking lines in the loop (e.g. a select) so the loop runs 'infinitely' and uses up a load of resources causing GC to bin it off. Thought I'd posted the answer here when I first found this, but evidently not.</p>\n"}], "owner": {"reputation": 105, "user_id": 9368823, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sam White", "link": "https://stackoverflow.com/users/9368823/sam-white"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1253, "favorite_count": 0, "accepted_answer_id": 51506535, "answer_count": 2, "score": 3, "last_activity_date": 1532461959, "creation_date": 1525246119, "last_edit_date": 1525516363, "question_id": 50129226, "link": "https://stackoverflow.com/questions/50129226/golang-channels-getting-stuck", "title": "Golang channels getting stuck", "body": "<p>I am working with go and redis to dispatch a queue (channel) of messages to subscribers. I am aiming to create an auto scaling solution that will spawn new go routines (within a certain limit) as the queue gets larger. I have the below code:</p>\n\n<pre><code>// Set up max queued messages\nvar maxMessages = float64(100000)\n\n// Set up max redis senders\nvar maxSender = float64(5)\n\n// Set up message channel\nvar messages = make(chan Message, int(maxMessages))\n\n// Set up messages per sender count\nvar senderRatio = maxSender / maxMessages\n\ntype Message struct {\n    ChatId  int    `json:\"chatId\"`\n    UserId  int    `json:\"userId\"`\n    Message string `json:\"message\"`\n    Date    int    `json:\"date\"`\n}\n\nfunc RedisWriteHandler(messageChannel chan Message) {\n    senderCount := 0\n    killswitch := make(chan string)\n    for {\n        length := float64(len(messageChannel))\n        neededSenders := int(math.Ceil(length * senderRatio))\n        if senderCount &lt; neededSenders || senderCount &lt; 1 {\n            log.Printf(\"Increasing sender count to %d, need %d\", senderCount+1, neededSenders)\n            go addRedisSender(messageChannel, killswitch)\n            senderCount++\n        } else if senderCount &gt; neededSenders &amp;&amp; senderCount &gt; 1 {\n            log.Printf(\"Decreasing sender count to %d, need %d\", senderCount-1, neededSenders)\n            killMessage := fmt.Sprintf(\"only need %d senders\", neededSenders)\n            killswitch &lt;- killMessage\n            senderCount--\n        }\n    }\n    log.Fatal(\"The redis handler unexpectedly went away\")\n}\n\nfunc addRedisSender(messageChannel chan Message, killswitch chan string) {\n    c, err := redis.Dial(\"tcp\", \"localhost:6379\")\n    if err != nil {\n        log.Println(err)\n        return\n    }\n    defer c.Close()\n    for {\n        select {\n        case msg := &lt;-messageChannel:\n            redisChannel := strconv.Itoa(msg.ChatId)\n            messageBlob, err := json.Marshal(msg)\n            if err != nil {\n                log.Println(err)\n            }\n            _, err = c.Do(\"PUBLISH\", redisChannel, messageBlob)\n            if err != nil {\n                log.Println(err)\n            }\n        case kill := &lt;-killswitch:\n            log.Printf(\"Sender killed: %s\", kill)\n            return\n        }\n    }\n    log.Println(\"Closing redis sender\")\n}\n</code></pre>\n\n<p>If I run this code using a channel with a large buffer size (say 100,000 messages) it adds 5 senders one at a time and starts working down the queue - so far so good. However at a seemingly random point - <em>around</em> 1500 messages in it hangs. No more logs at all (and I think I've got all the exit points covered). My expected output would be to have the senders increase to the maxSender value and decrease periodically throughout execution. An e.g of the logs I get with 100k messages is below</p>\n\n<pre>\n2018/05/02 08:21:25 Increasing sender count to 1, need 5\n2018/05/02 08:21:25 Increasing sender count to 2, need 5\n2018/05/02 08:21:25 Increasing sender count to 3, need 5\n2018/05/02 08:21:25 Increasing sender count to 4, need 5\n2018/05/02 08:21:25 Increasing sender count to 5, need 5\n</pre>\n\n<p>Then nothing.</p>\n\n<p>I can see from other testing I'm running that this isn't just going slowly and that the messages just aren't being taken from the channel. Can anyone shed any light on this?</p>\n\n<p>Thanks,</p>\n\n<p>Sam</p>\n\n<p><strong>Edit</strong></p>\n\n<p>I have been lurking around some other questions regarding go hanging for no apparent reason and the suggested action was to kill the parent process to get the stack trace of each child process. The below is the output.</p>\n\n<pre><code>kill -ABRT 9162\nSIGABRT: abort\nPC=0x65f199 m=0 sigcode=0\n\ngoroutine 6 [running]:\nmain.RedisWriteHandler(0xc42005a180)\n    /home/sam/repos/go/src/github.com/samisagit/go-im-server/src/main.go:116 +0x99 fp=0xc42004dfd8 sp=0xc42004dee8 pc=0x65f199\nruntime.goexit()\n    /usr/local/go/src/runtime/asm_amd64.s:2337 +0x1 fp=0xc42004dfe0 sp=0xc42004dfd8 pc=0x458f01\ncreated by main.main\n    /home/sam/repos/go/src/github.com/samisagit/go-im-server/src/main.go:236 +0x130\n\ngoroutine 1 [IO wait]:\ninternal/poll.runtime_pollWait(0x7f03114c5f70, 0x72, 0xffffffffffffffff)\n    /usr/local/go/src/runtime/netpoll.go:173 +0x57\ninternal/poll.(*pollDesc).wait(0xc422722098, 0x72, 0xc420038b00, 0x0, 0x0)\n    /usr/local/go/src/internal/poll/fd_poll_runtime.go:85 +0xae\ninternal/poll.(*pollDesc).waitRead(0xc422722098, 0xffffffffffffff00, 0x0, 0x0)\n    /usr/local/go/src/internal/poll/fd_poll_runtime.go:90 +0x3d\ninternal/poll.(*FD).Accept(0xc422722080, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0)\n    /usr/local/go/src/internal/poll/fd_unix.go:334 +0x1e2\nnet.(*netFD).accept(0xc422722080, 0x7f0311511000, 0x0, 0x7139b0)\n    /usr/local/go/src/net/fd_unix.go:238 +0x42\nnet.(*TCPListener).accept(0xc4200b2000, 0xc420038d80, 0x4122c8, 0x30)\n    /usr/local/go/src/net/tcpsock_posix.go:136 +0x2e\nnet.(*TCPListener).AcceptTCP(0xc4200b2000, 0xc422736120, 0xc422736120, 0x6a3b00)\n    /usr/local/go/src/net/tcpsock.go:234 +0x49\nnet/http.tcpKeepAliveListener.Accept(0xc4200b2000, 0xc42001c0d8, 0x6a3b00, 0x8813d0, 0x6f2aa0)\n    /usr/local/go/src/net/http/server.go:3120 +0x2f\nnet/http.(*Server).Serve(0xc42007a4e0, 0x8575c0, 0xc4200b2000, 0x0, 0x0)\n    /usr/local/go/src/net/http/server.go:2695 +0x1b2\nnet/http.(*Server).ListenAndServe(0xc42007a4e0, 0xc42007a4e0, 0xc420038f00)\n    /usr/local/go/src/net/http/server.go:2636 +0xa9\nnet/http.ListenAndServe(0x6ff124, 0x5, 0x0, 0x0, 0x0, 0x0)\n    /usr/local/go/src/net/http/server.go:2882 +0x7f\nmain.main()\n    /home/sam/repos/go/src/github.com/samisagit/go-im-server/src/main.go:239 +0x15b\n\ngoroutine 21 [runnable]:\ninternal/poll.runtime_pollWait(0x7f03114c5eb0, 0x72, 0x0)\n    /usr/local/go/src/runtime/netpoll.go:173 +0x57\ninternal/poll.(*pollDesc).wait(0xc422722198, 0x72, 0xffffffffffffff00, 0x854d00, 0x851550)\n    /usr/local/go/src/internal/poll/fd_poll_runtime.go:85 +0xae\ninternal/poll.(*pollDesc).waitRead(0xc422722198, 0xc4227ab000, 0x1000, 0x1000)\n    /usr/local/go/src/internal/poll/fd_poll_runtime.go:90 +0x3d\ninternal/poll.(*FD).Read(0xc422722180, 0xc4227ab000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n    /usr/local/go/src/internal/poll/fd_unix.go:125 +0x18a\nnet.(*netFD).Read(0xc422722180, 0xc4227ab000, 0x1000, 0x1000, 0x4815d4, 0x47fd05, 0x1)\n    /usr/local/go/src/net/fd_unix.go:202 +0x52\nnet.(*conn).Read(0xc4227a6000, 0xc4227ab000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n    /usr/local/go/src/net/net.go:176 +0x6d\nbufio.(*Reader).fill(0xc4227ae000)\n    /usr/local/go/src/bufio/bufio.go:97 +0x11a\nbufio.(*Reader).ReadSlice(0xc4227ae000, 0x7f03114c5e0a, 0x0, 0x459fd6, 0xc42276db60, 0x491d6d, 0xc422722180)\n    /usr/local/go/src/bufio/bufio.go:338 +0x2c\ngithub.com/gomodule/redigo/redis.(*conn).readLine(0xc4227b0000, 0x0, 0x8000000000000000, 0xc422722180, 0x0, 0x0)\n    /home/sam/repos/go/src/github.com/gomodule/redigo/redis/conn.go:431 +0x38\ngithub.com/gomodule/redigo/redis.(*conn).readReply(0xc4227b0000, 0x0, 0x0, 0x0, 0x0)\n    /home/sam/repos/go/src/github.com/gomodule/redigo/redis/conn.go:504 +0x40\ngithub.com/gomodule/redigo/redis.(*conn).DoWithTimeout(0xc4227b0000, 0x0, 0x6ff70a, 0x7, 0xc422800d40, 0x2, 0x2, 0x68f280, 0x696f01, 0xc422800d60, ...)\n    /home/sam/repos/go/src/github.com/gomodule/redigo/redis/conn.go:665 +0x164\ngithub.com/gomodule/redigo/redis.(*conn).Do(0xc4227b0000, 0x6ff70a, 0x7, 0xc422800d40, 0x2, 0x2, 0x0, 0xc4227ba9a0, 0x0, 0x0)\n    /home/sam/repos/go/src/github.com/gomodule/redigo/redis/conn.go:616 +0x73\nmain.addRedisSender(0xc42005a180, 0xc42001e240)\n    /home/sam/repos/go/src/github.com/samisagit/go-im-server/src/main.go:150 +0x569\ncreated by main.RedisWriteHandler\n    /home/sam/repos/go/src/github.com/samisagit/go-im-server/src/main.go:119 +0x381\n\ngoroutine 22 [IO wait]:\ninternal/poll.runtime_pollWait(0x7f03114c5c70, 0x72, 0x0)\n    /usr/local/go/src/runtime/netpoll.go:173 +0x57\ninternal/poll.(*pollDesc).wait(0xc422758098, 0x72, 0xffffffffffffff00, 0x854d00, 0x851550)\n    /usr/local/go/src/internal/poll/fd_poll_runtime.go:85 +0xae\ninternal/poll.(*pollDesc).waitRead(0xc422758098, 0xc422774000, 0x1000, 0x1000)\n    /usr/local/go/src/internal/poll/fd_poll_runtime.go:90 +0x3d\ninternal/poll.(*FD).Read(0xc422758080, 0xc422774000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n    /usr/local/go/src/internal/poll/fd_unix.go:125 +0x18a\nnet.(*netFD).Read(0xc422758080, 0xc422774000, 0x1000, 0x1000, 0x4815d4, 0x47fd05, 0x1)\n    /usr/local/go/src/net/fd_unix.go:202 +0x52\nnet.(*conn).Read(0xc42274c020, 0xc422774000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n    /usr/local/go/src/net/net.go:176 +0x6d\nbufio.(*Reader).fill(0xc422748120)\n    /usr/local/go/src/bufio/bufio.go:97 +0x11a\nbufio.(*Reader).ReadSlice(0xc422748120, 0x7f03114c5c0a, 0x0, 0x459fd6, 0xc420049b60, 0x491d6d, 0xc422758080)\n    /usr/local/go/src/bufio/bufio.go:338 +0x2c\ngithub.com/gomodule/redigo/redis.(*conn).readLine(0xc420084820, 0x0, 0x8000000000000000, 0xc422758080, 0x0, 0x0)\n    /home/sam/repos/go/src/github.com/gomodule/redigo/redis/conn.go:431 +0x38\ngithub.com/gomodule/redigo/redis.(*conn).readReply(0xc420084820, 0x0, 0x0, 0x0, 0x0)\n    /home/sam/repos/go/src/github.com/gomodule/redigo/redis/conn.go:504 +0x40\ngithub.com/gomodule/redigo/redis.(*conn).DoWithTimeout(0xc420084820, 0x0, 0x6ff70a, 0x7, 0xc422800dc0, 0x2, 0x2, 0x68f280, 0x696f01, 0xc422800de0, ...)\n    /home/sam/repos/go/src/github.com/gomodule/redigo/redis/conn.go:665 +0x164\ngithub.com/gomodule/redigo/redis.(*conn).Do(0xc420084820, 0x6ff70a, 0x7, 0xc422800dc0, 0x2, 0x2, 0x0, 0xc4227ba9b0, 0x0, 0x0)\n    /home/sam/repos/go/src/github.com/gomodule/redigo/redis/conn.go:616 +0x73\nmain.addRedisSender(0xc42005a180, 0xc42001e240)\n    /home/sam/repos/go/src/github.com/samisagit/go-im-server/src/main.go:150 +0x569\ncreated by main.RedisWriteHandler\n    /home/sam/repos/go/src/github.com/samisagit/go-im-server/src/main.go:119 +0x381\n\ngoroutine 23 [runnable]:\nsyscall.Syscall(0x0, 0x7, 0xc42277a000, 0x1000, 0x4, 0x1000, 0x0)\n    /usr/local/go/src/syscall/asm_linux_amd64.s:18 +0x5\nsyscall.read(0x7, 0xc42277a000, 0x1000, 0x1000, 0xc42276f900, 0x0, 0x0)\n    /usr/local/go/src/syscall/zsyscall_linux_amd64.go:756 +0x55\nsyscall.Read(0x7, 0xc42277a000, 0x1000, 0x1000, 0xcb, 0xc4228072b0, 0xcb)\n    /usr/local/go/src/syscall/syscall_unix.go:162 +0x49\ninternal/poll.(*FD).Read(0xc422722280, 0xc42277a000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n    /usr/local/go/src/internal/poll/fd_unix.go:121 +0x125\nnet.(*netFD).Read(0xc422722280, 0xc42277a000, 0x1000, 0x1000, 0x4815d4, 0x47fd05, 0x1)\n    /usr/local/go/src/net/fd_unix.go:202 +0x52\nnet.(*conn).Read(0xc42274c060, 0xc42277a000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n    /usr/local/go/src/net/net.go:176 +0x6d\nbufio.(*Reader).fill(0xc4227481e0)\n    /usr/local/go/src/bufio/bufio.go:97 +0x11a\nbufio.(*Reader).ReadSlice(0xc4227481e0, 0x7f03114c5d0a, 0x0, 0x459fd6, 0xc42276fb60, 0x491d6d, 0xc422722280)\n    /usr/local/go/src/bufio/bufio.go:338 +0x2c\ngithub.com/gomodule/redigo/redis.(*conn).readLine(0xc420084a00, 0x0, 0x8000000000000000, 0xc422722280, 0x0, 0x0)\n    /home/sam/repos/go/src/github.com/gomodule/redigo/redis/conn.go:431 +0x38\ngithub.com/gomodule/redigo/redis.(*conn).readReply(0xc420084a00, 0x0, 0x0, 0x0, 0x0)\n    /home/sam/repos/go/src/github.com/gomodule/redigo/redis/conn.go:504 +0x40\ngithub.com/gomodule/redigo/redis.(*conn).DoWithTimeout(0xc420084a00, 0x0, 0x6ff70a, 0x7, 0xc4227f1900, 0x2, 0x2, 0x68f280, 0x696f01, 0xc4227f1920, ...)\n    /home/sam/repos/go/src/github.com/gomodule/redigo/redis/conn.go:665 +0x164\ngithub.com/gomodule/redigo/redis.(*conn).Do(0xc420084a00, 0x6ff70a, 0x7, 0xc4227f1900, 0x2, 0x2, 0x0, 0xc4227318e0, 0x0, 0x0)\n    /home/sam/repos/go/src/github.com/gomodule/redigo/redis/conn.go:616 +0x73\nmain.addRedisSender(0xc42005a180, 0xc42001e240)\n    /home/sam/repos/go/src/github.com/samisagit/go-im-server/src/main.go:150 +0x569\ncreated by main.RedisWriteHandler\n    /home/sam/repos/go/src/github.com/samisagit/go-im-server/src/main.go:119 +0x381\n\ngoroutine 24 [running]:\n    goroutine running on other thread; stack unavailable\ncreated by main.RedisWriteHandler\n    /home/sam/repos/go/src/github.com/samisagit/go-im-server/src/main.go:119 +0x381\n\ngoroutine 25 [runnable]:\nsyscall.Syscall6(0x37, 0x9, 0x1, 0x4, 0xc42276b3dc, 0xc42276b3d8, 0x0, 0x0, 0x4, 0x0)\n    /usr/local/go/src/syscall/asm_linux_amd64.s:44 +0x5\nsyscall.getsockopt(0x9, 0x1, 0x4, 0xc42276b3dc, 0xc42276b3d8, 0xc422722400, 0x0)\n    /usr/local/go/src/syscall/zsyscall_linux_amd64.go:1605 +0x7c\nsyscall.GetsockoptInt(0x9, 0x1, 0x4, 0x1, 0x0, 0x0)\n    /usr/local/go/src/syscall/syscall_unix.go:245 +0x63\nnet.(*netFD).connect(0xc422722480, 0x857a00, 0xc42001c0d8, 0x0, 0x0, 0x853a80, 0xc422764100, 0x0, 0x0, 0x0, ...)\n    /usr/local/go/src/net/fd_unix.go:160 +0x2f7\nnet.(*netFD).dial(0xc422722480, 0x857a00, 0xc42001c0d8, 0x858c00, 0x0, 0x858c00, 0xc422736510, 0xc42276b610, 0x54d3fe)\n    /usr/local/go/src/net/sock_posix.go:142 +0xe9\nnet.socket(0x857a00, 0xc42001c0d8, 0x6fee50, 0x3, 0x2, 0x1, 0x0, 0x0, 0x858c00, 0x0, ...)\n    /usr/local/go/src/net/sock_posix.go:93 +0x1a5\nnet.internetSocket(0x857a00, 0xc42001c0d8, 0x6fee50, 0x3, 0x858c00, 0x0, 0x858c00, 0xc422736510, 0x1, 0x0, ...)\n    /usr/local/go/src/net/ipsock_posix.go:141 +0x129\nnet.doDialTCP(0x857a00, 0xc42001c0d8, 0x6fee50, 0x3, 0x0, 0xc422736510, 0xc42276b7e0, 0x0, 0xf2)\n    /usr/local/go/src/net/tcpsock_posix.go:62 +0xb9\nnet.dialTCP(0x857a00, 0xc42001c0d8, 0x6fee50, 0x3, 0x0, 0xc422736510, 0x44a6b8, 0xad3bb25ed8, 0x2e6f67bd)\n    /usr/local/go/src/net/tcpsock_posix.go:58 +0xe4\nnet.dialSingle(0x857a00, 0xc42001c0d8, 0xc422722400, 0x8559c0, 0xc422736510, 0x0, 0x0, 0x0, 0x0)\n    /usr/local/go/src/net/dial.go:547 +0x3e2\nnet.dialSerial(0x857a00, 0xc42001c0d8, 0xc422722400, 0xc420010c80, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0)\n    /usr/local/go/src/net/dial.go:515 +0x247\nnet.(*Dialer).DialContext(0xc422766240, 0x857a00, 0xc42001c0d8, 0x6fee50, 0x3, 0x701517, 0xe, 0x0, 0x0, 0x0, ...)\n    /usr/local/go/src/net/dial.go:397 +0x6ee\nnet.(*Dialer).Dial(0xc422766240, 0x6fee50, 0x3, 0x701517, 0xe, 0x10, 0x6b5de0, 0xc420082001, 0xc420010c40)\n    /usr/local/go/src/net/dial.go:320 +0x75\nnet.(*Dialer).Dial-fm(0x6fee50, 0x3, 0x701517, 0xe, 0x3, 0xc42273cc50, 0x42a568, 0xc42273cc18)\n    /home/sam/repos/go/src/github.com/gomodule/redigo/redis/conn.go:180 +0x52\ngithub.com/gomodule/redigo/redis.Dial(0x6fee50, 0x3, 0x701517, 0xe, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, ...)\n    /home/sam/repos/go/src/github.com/gomodule/redigo/redis/conn.go:183 +0x182\nmain.addRedisSender(0xc42005a180, 0xc42001e240)\n    /home/sam/repos/go/src/github.com/samisagit/go-im-server/src/main.go:133 +0x12e\ncreated by main.RedisWriteHandler\n    /home/sam/repos/go/src/github.com/samisagit/go-im-server/src/main.go:119 +0x381\n\nrax    0x5\nrbx    0xf3e31\nrcx    0x5\nrdx    0xc42005a180\nrdi    0x458f01\nrsi    0x3\nrbp    0xc42004dfc8\nrsp    0xc42004dee8\nr8     0x0\nr9     0x0\nr10    0x732f60\nr11    0x30\nr12    0x0\nr13    0xf1\nr14    0x11\nr15    0x0\nrip    0x65f199\nrflags 0x246\ncs     0x33\nfs     0x0\ngs     0x0\n</code></pre>\n\n<p>Go routine 22 is somewhat interesting as it's in [IO WAIT] where as the others are runnable. I've not dealt with these statuses before, is this where the issue lies?</p>\n\n<p><em>Most up to date code here</em>\n<a href=\"https://gitlab.com/samisagit/go-im-server/blob/changed-redis-handler-buggy/src/main.go\" rel=\"nofollow noreferrer\">https://gitlab.com/samisagit/go-im-server/blob/changed-redis-handler-buggy/src/main.go</a></p>\n\n<p><strong>Edit with root cause!</strong></p>\n\n<p>One of the guys at golang-nuts gGroup suggested this might be a GC issue, and he was right (Thanks Michael)! When running the code with the below</p>\n\n<pre><code>debug.SetGCPercent(-1)\n</code></pre>\n\n<p>it works as expected - this isn't a long term solution but it points to where the issue lies! If anyone has any clues as to why the GC is being so zealous with it's duties I'd be super appreciative!</p>\n"}, {"tags": ["jquery", "html", "ajax", "go"], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 9703809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9e630139bd3e5f4dd10fe2ff60540b?s=128&d=identicon&r=PG&f=1", "display_name": "gourav", "link": "https://stackoverflow.com/users/9703809/gourav"}, "edited": false, "score": 0, "creation_date": 1525244646, "post_id": 50128778, "comment_id": 87275495, "body": "it will giving me a error   <code>cannot use string(b) (type string) as type []byte in argument to w.Write .&#47;main.go:98:1: missing return at end of function .&#47;main.go:103:18: cannot use AllData (type func(http.ResponseWriter, *http.Request) Users) as type func(http.ResponseWriter, *http.Request) in argument to http.HandleFunc </code>"}, {"owner": {"reputation": 157, "user_id": 9703809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9e630139bd3e5f4dd10fe2ff60540b?s=128&d=identicon&r=PG&f=1", "display_name": "gourav", "link": "https://stackoverflow.com/users/9703809/gourav"}, "edited": false, "score": 0, "creation_date": 1525244801, "post_id": 50128778, "comment_id": 87275568, "body": "now it will giving the error of this <code>cannot use AllData (type func(http.ResponseWriter, *http.Request) Users) as type func(http.ResponseWriter, *http.Request) in argument to http.HandleFunc </code>"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 157, "user_id": 9703809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9e630139bd3e5f4dd10fe2ff60540b?s=128&d=identicon&r=PG&f=1", "display_name": "gourav", "link": "https://stackoverflow.com/users/9703809/gourav"}, "edited": false, "score": 0, "creation_date": 1525244905, "post_id": 50128778, "comment_id": 87275618, "body": "yes because your <code>AllData</code> is returning <code>users</code> thats an error . Please check edited code."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 157, "user_id": 9703809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9e630139bd3e5f4dd10fe2ff60540b?s=128&d=identicon&r=PG&f=1", "display_name": "gourav", "link": "https://stackoverflow.com/users/9703809/gourav"}, "edited": false, "score": 0, "creation_date": 1525245841, "post_id": 50128778, "comment_id": 87276121, "body": "yes you can. But I am getting late for some where you can drop your query. I will check it"}, {"owner": {"reputation": 157, "user_id": 9703809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9e630139bd3e5f4dd10fe2ff60540b?s=128&d=identicon&r=PG&f=1", "display_name": "gourav", "link": "https://stackoverflow.com/users/9703809/gourav"}, "edited": false, "score": 0, "creation_date": 1525245984, "post_id": 50128778, "comment_id": 87276211, "body": "Why should it giving the error of that i told you? The code you give is alright it works but can you explain it for me what is actually it is doing?"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 157, "user_id": 9703809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9e630139bd3e5f4dd10fe2ff60540b?s=128&d=identicon&r=PG&f=1", "display_name": "gourav", "link": "https://stackoverflow.com/users/9703809/gourav"}, "edited": false, "score": 0, "creation_date": 1525251289, "post_id": 50128778, "comment_id": 87279066, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/170203/discussion-between-himanshu-and-gourav\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": true, "score": 1, "last_activity_date": 1525244921, "last_edit_date": 1525244921, "creation_date": 1525244258, "answer_id": 50128778, "question_id": 50128474, "link": "https://stackoverflow.com/questions/50128474/how-ajax-will-get-the-data-from-the-golang-code/50128778#50128778", "title": "How ajax will GET the data from the golang code?", "body": "<p>Send the response header of <code>Data</code> function in json format and write the response of json which can be received in success of <code>$.ajax</code></p>\n\n<pre><code>func AllData(w http.ResponseWriter, r *http.Request) {\n    fmt.Println(\"method:\", r.Method)\n    if r.Method == \"GET\" {\n            // your code ....\n           b, err := json.MarshalIndent(result, \"\", \"  \")\n           if err != nil {\n               panic(err)\n           }\n           fmt.Printf(\"%s\\n\", b)\n           // set header to 'application/json'\n           w.Header().Set(\"Content-Type\", \"application/json\")\n           // write the response\n           w.Write(b)\n       }\n    }\n}\n</code></pre>\n\n<p>Also there is an error in your code where you are returning from handler func <code>AllData</code> either create a middleware if you wants to do some modification in result or remove the return part of handler <code>AllData</code></p>\n"}], "owner": {"reputation": 157, "user_id": 9703809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9e630139bd3e5f4dd10fe2ff60540b?s=128&d=identicon&r=PG&f=1", "display_name": "gourav", "link": "https://stackoverflow.com/users/9703809/gourav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4657, "favorite_count": 2, "accepted_answer_id": 50128778, "answer_count": 1, "score": 2, "last_activity_date": 1525244921, "creation_date": 1525243001, "last_edit_date": 1525244704, "question_id": 50128474, "link": "https://stackoverflow.com/questions/50128474/how-ajax-will-get-the-data-from-the-golang-code", "title": "How ajax will GET the data from the golang code?", "body": "<p>I have a golang API for saving and retrieving the data from the form. Saving the data filled in the HTML form is okay. Means it will save the data in  database of mongodb successfully but in case of retrieving the data it will retrieve the data on the basis of the email filled in the field of the html form is successful but it shows the data in the terminal of the ubuntu. Below is the code I'm trying for this:-</p>\n\n<p>Html form index.html file</p>\n\n<pre><code>&lt;form id=\"form1\" method=\"post\"&gt;\n    &lt;input id= \"firstname\" type=\"text\" name=\"FirstName\"  placeholder=\"Enter your firstname\"&gt;&lt;br&gt;&lt;br&gt;\n    &lt;input id= \"lastname\" type=\"text\" name=\"LastName\" placeholder=\"Enter your lastname\"&gt;&lt;br&gt;&lt;br&gt;\n    &lt;input id= \"email\" type=\"text\" name=\"Email\" placeholder=\"Enter your email\"&gt;&lt;br&gt;&lt;br&gt;\n    &lt;input id= \"mobile\" type=\"text\" name=\"Mobile\" placeholder=\"Enter your mobile\"&gt;&lt;br&gt;&lt;br&gt;\n    &lt;button id= \"button1\" class=\"button\" name=\"button\" type=\"button\" value=\"Submit\"&gt;Submit&lt;/button&gt;\n    &lt;button id= \"button2\" class=\"button\" name=\"button\" type=\"submit\" value=\"Search\"&gt;Search&lt;/button&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Ajax in index.html is :-</p>\n\n<pre><code>$(document).ready(function(){\n    //IT will save the data \n    $('#button1').on('click', function(e){\n        button=this.value;\n        console.log(button);\n        e.preventDefault();\n        if (button === \"Submit\") {\n            var FirstName =$(\"#firstname\").val(),\n            LastName =$(\"#lastname\").val(),\n            Email =$(\"#email\").val(),\n            Mobile =$(\"#mobile\").val();\n            console.log(FirstName);\n            $.ajax({\n                url:\"/login\",\n                type:\"POST\",\n                data: {'button':button, \"first\":FirstName, \"last\":LastName, \"email\":Email, \"mobile\":Mobile},\n                success: function(results) {\n                    console.log(results);\n                    $('#response').html(results);\n                }\n            });\n        }\n    });\n    // This will search and I want the result in the success\n    $('#button2').on('click', function(e){\n        button=this.value;\n        console.log(button);\n        e.preventDefault();\n        var Email =$(\"#email\").val();\n        $.ajax({\n            url:\"/get-data\",\n            type: \"GET\",\n            data:{'button':button,\"email\":Email},\n            success: function(results){\n                console.log(results)\n                $('#response').html(results);\n            }\n        });\n    });\n });\n</code></pre>\n\n<p>Main.go file </p>\n\n<pre><code>import (\n \"fmt\"\n \"gopkg.in/mgo.v2\"\n \"gopkg.in/mgo.v2/bson\"\n \"html/template\"\n \"log\"\n \"net/http\"\n \"encoding/json\"\n)\ntype USER struct {\n FirstName string `json:\"FirstName,omitempty\"`\n LastName  string `json:\"LastName,omitempty\"`\n Email     string `json:\"Email,omitempty\"`\n Mobile    string `json:\"Mobile,omitempty\"`\n}\nfunc login(w http.ResponseWriter, r *http.Request) {\n fmt.Println(\"method:\", r.Method)\n if r.Method == \"GET\" {\n    t, _ := template.ParseFiles(\"index.html\")\n    t.Execute(w, nil)\n } else {\n    r.ParseForm()\n    fmt.Println(r.Form)\n    if r.Form[\"button\"][0] == \"Submit\" {\n        fmt.Println(r.Form)\n        session, err := mgo.Dial(\"mongodb://127.0.0.1:27017/user\")\n        if err != nil {\n            panic(err)\n        }\n        defer session.Close()\n        session.SetMode(mgo.Monotonic, true)\n        c := session.DB(\"user\").C(\"profile\")\n        doc := USER{\n            FirstName: r.Form[\"first\"][0],\n            LastName:  r.Form[\"last\"][0],\n            Email:     r.Form[\"email\"][0],\n            Mobile:    r.Form[\"mobile\"][0],\n        }\n        err = c.Insert(doc)\n        if err != nil {\n            panic(err)\n        }\n        fmt.Println(\"FistName:\", r.Form[\"first\"][0])\n        fmt.Println(\"LastName:\", r.Form[\"last\"][0])\n        fmt.Println(\"Email:\", r.Form[\"email\"][0])\n        fmt.Println(\"Mobile:\", r.Form[\"mobile\"][0])\n    }\n }\n}\n\nfunc AllData(w http.ResponseWriter, r *http.Request){\n fmt.Println(\"method:\", r.Method)\n if r.Method == \"GET\" {\n    r.ParseForm()\n    fmt.Println(r.Form)\n     if r.Form[\"button\"][0] == \"Search\" {\n        fmt.Println(r.Form)\n        fmt.Println(r.Form[\"email\"][0])\n        session, err := mgo.Dial(\"mongodb://127.0.0.1:27017/user\")\n        if err != nil {\n            panic(err)\n        }\n        defer session.Close()\n        session.SetMode(mgo.Monotonic, true)\n        c := session.DB(\"user\").C(\"profile\")\n        result := Users{}\n        err = c.Find(bson.M{\"email\": r.Form[\"email\"][0]}).All(&amp;result)\n        fmt.Println(result)\n        b, err := json.MarshalIndent(result, \"\", \"  \")\n        if err != nil {\n            panic(err)\n        }\n        fmt.Printf(\"%s\\n\", b)\n    }\n }\n}\n\nfunc main() {\n  http.HandleFunc(\"/login\", login)\n  http.HandleFunc(\"/get-data\", AllData)\n  err := http.ListenAndServe(\":9090\", nil)\n  if err != nil {\n      log.Fatal(\"ListenAndServe: \", err)\n  }\n}\n</code></pre>\n\n<p>What should I do for receiving the data from golang to the ajax <code>GET</code> method request click on the button search and result will display in the success function of the ajax. Thank you in advance. </p>\n"}, {"tags": ["go", "sqlplus"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 1, "creation_date": 1525244835, "post_id": 50127154, "comment_id": 87275583, "body": "To run the command <code>sqlplus user&#47;pass@connect @scriptname</code> in go, try <code>exec.Command(&quot;sqlplus&quot;, &quot;user&#47;pass@connect&quot;, &quot;@scriptname&quot;)</code>"}, {"owner": {"reputation": 105, "user_id": 2629358, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/47bd319c82143439c7c9642e05ab8f0e?s=128&d=identicon&r=PG&f=1", "display_name": "Ujang Hardman", "link": "https://stackoverflow.com/users/2629358/ujang-hardman"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1525245113, "post_id": 50127154, "comment_id": 87275720, "body": "Thanks for your comment Mark, but I have solved my own question. It&#39;s just my poor understanding. I&#39;ve post the solution of this problem below"}], "answers": [{"tags": [], "owner": {"reputation": 105, "user_id": 2629358, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/47bd319c82143439c7c9642e05ab8f0e?s=128&d=identicon&r=PG&f=1", "display_name": "Ujang Hardman", "link": "https://stackoverflow.com/users/2629358/ujang-hardman"}, "is_accepted": true, "score": 1, "last_activity_date": 1525245340, "last_edit_date": 1525245340, "creation_date": 1525244957, "answer_id": 50128942, "question_id": 50127154, "link": "https://stackoverflow.com/questions/50127154/execute-sql-plus-command-in-golang/50128942#50128942", "title": "Execute SQL Plus Command in Golang", "body": "<p>Allright, nevermind, looks like it's just my poor understanding on how to use <code>os/exec</code>.</p>\n\n<p>So in case someone doesn't know how to use it, here how I solve my own problem.</p>\n\n<p>I change</p>\n\n<pre><code>cmd := exec.Command(\"sqlplus\", \"-s\", \"admin/123#@172.10.1.211:1521/orcl\", \"&lt; tb_data_20180502104923.sql\")\n</code></pre>\n\n<p>to</p>\n\n<pre><code>cmd := exec.Command(\"bash\", \"-c\", \"sqlplus -s admin/123#@172.10.1.211:1521/orcl &lt; tb_data_20180502104923.sql\")\n</code></pre>\n\n<p>The first parameter <code>bash</code> is the kind of Shell you want to use, </p>\n\n<p>the second parameter <code>-c</code> is the argument of <code>bash</code>, </p>\n\n<p>and the third parameter is the <code>command</code> which I want to execute.</p>\n\n<p>Well, correct me if I'm wrong.</p>\n"}], "owner": {"reputation": 105, "user_id": 2629358, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/47bd319c82143439c7c9642e05ab8f0e?s=128&d=identicon&r=PG&f=1", "display_name": "Ujang Hardman", "link": "https://stackoverflow.com/users/2629358/ujang-hardman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 565, "favorite_count": 1, "accepted_answer_id": 50128942, "answer_count": 1, "score": 0, "last_activity_date": 1525245340, "creation_date": 1525235142, "last_edit_date": 1525244802, "question_id": 50127154, "link": "https://stackoverflow.com/questions/50127154/execute-sql-plus-command-in-golang", "title": "Execute SQL Plus Command in Golang", "body": "<p>I need to run a .sql file in Golang with Sql Plus, which creates a table and a file named <code>tb_data_20180502104923</code>. I named the .sql script as <code>tb_data_20180502104923.sql</code> with contents as follows:</p>\n\n<pre><code>set headsep off\nset pagesize 0\nset trimspool on\nset trimout on\ncreate table tb_data_20180502104923\nas\nselect * from tb_data;\nspool tb_data_20180502104923.txt\nSELECT data_id||';'||data_content FROM tb_data_20180502104923;\nspool off\n</code></pre>\n\n<p>I have tried this with <code>os/exec</code> like this:</p>\n\n<pre><code>func main(){\n    cmd := exec.Command(\"sqlplus -s admin/123#@172.10.1.211:1521/orcl &lt; tb_data_20180502104923.sql\")\n\n    var out, stderr bytes.Buffer\n\n    cmd.Stdout = &amp;out\n    cmd.Stderr = &amp;stderr\n\n    err := cmd.Run()\n    if err != nil {\n        log.Fatalf(\"Error executing query. Command Output: %+v\\n: %+v, %v\", out.String(), stderr.String(), err)\n    }\n}\n</code></pre>\n\n<p>Which return me an error message:</p>\n\n<pre><code>2018/05/02 11:06:46 Error executing query. Command Output: \n: , fork/exec sqlplus -s admin/123#@172.10.1.1:1521/orcl &lt; tb_data_20180502104923.sql: no such file or directory\nexit status 1\n</code></pre>\n\n<p>And if I change the <code>cmd := exec.Command</code> statement to:</p>\n\n<pre><code>cmd := exec.Command(\"sqlplus\", \"-s\", \"admin/123#@172.10.1.211:1521/orcl\", \"&lt; tb_data_20180502104923.sql\")\n</code></pre>\n\n<p>It return me nothing, and both tabel &amp; file <code>tb_data_20180502104923</code> did not created.</p>\n\n<p>Where did I do it wrong, or is using Sql Plus not possible in Golang? And if it's not possible, is there any other way to do what I need?</p>\n"}, {"tags": ["templates", "go"], "comments": [{"owner": {"reputation": 1003, "user_id": 858944, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3eea165e5121368690c56a08a226a403?s=128&d=identicon&r=PG", "display_name": "awm", "link": "https://stackoverflow.com/users/858944/awm"}, "edited": false, "score": 0, "creation_date": 1525235610, "post_id": 50126899, "comment_id": 87272163, "body": "can&#39;t you do the logic in your go code instead of the template? can you show the execute function? The variable scope ends with <code>{{end}}</code> so you have to do it in the go code or change the template so the variables are within the same scope."}, {"owner": {"reputation": 55, "user_id": 7934131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5de52cd0bf0ef8d65ff9a3ddf5bc4fca?s=128&d=identicon&r=PG&f=1", "display_name": "Steve B", "link": "https://stackoverflow.com/users/7934131/steve-b"}, "reply_to_user": {"reputation": 1003, "user_id": 858944, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3eea165e5121368690c56a08a226a403?s=128&d=identicon&r=PG", "display_name": "awm", "link": "https://stackoverflow.com/users/858944/awm"}, "edited": false, "score": 0, "creation_date": 1525366218, "post_id": 50126899, "comment_id": 87338182, "body": "I actually thought about this as I went to bed. I wanted to have it on every page but wasn&#39;t sure what form the other data would take so I was trying to keep it all in template. That was stupid and, as I was going to bed, a lightbulb went off and I rewrote it with anonymous structs in my page handlers. It works much more cleanly now."}], "answers": [{"tags": [], "owner": {"reputation": 55, "user_id": 7934131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5de52cd0bf0ef8d65ff9a3ddf5bc4fca?s=128&d=identicon&r=PG&f=1", "display_name": "Steve B", "link": "https://stackoverflow.com/users/7934131/steve-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1525376478, "last_edit_date": 1525376478, "creation_date": 1525236744, "answer_id": 50127357, "question_id": 50126899, "link": "https://stackoverflow.com/questions/50126899/golang-http-template-variable/50127357#50127357", "title": "Golang http/template variable", "body": "<p>Do you ever find that the act of writing out your question clarifies the issue in your mind so you answer it yourself shortly after? That happened here when I realized I needed to figure out how to pass local variables between nested templates. For anyone seeing this hoping for help with the same issue, it's as simple as </p>\n\n<pre><code>{{template \"&lt;name&gt;\" $&lt;variable name&gt;}}\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 7934131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5de52cd0bf0ef8d65ff9a3ddf5bc4fca?s=128&d=identicon&r=PG&f=1", "display_name": "Steve B", "link": "https://stackoverflow.com/users/7934131/steve-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525376478, "creation_date": 1525233115, "question_id": 50126899, "link": "https://stackoverflow.com/questions/50126899/golang-http-template-variable", "title": "Golang http/template variable", "body": "<p>I have a variable in a template called $active and the idea is to check against it to make a navrbar button active or not. I have defined a header where the logic is taking place but I am trying to define $active on the html file being called by my Execute function. The issue is that the header is read first so any variables defined in the body files is too late to affect the logic. From the header:</p>\n\n<pre><code>{{ $a := mkSlice \"SiteTester\" \"/sitetester-add/\" }}\n{{ $b := mkSlice \"Index\" \"/\" }}\n{{ $nav := mkSlice $a $b }}\n                &lt;ul class=\"nav navbar-nav\"&gt;\n                    {{range $nav}}\n                    &lt;li{{if eq $active (index . 0) }} class=\"active\"{{end}}&gt;&lt;a href=\"{{index . 1}}\"&gt;{{index . 0}}&lt;/a&gt;&lt;/li&gt;\n                    {{end}}\n                &lt;/ul&gt;\n</code></pre>\n\n<p>I've even been trying to make a separate snippit just to handle the variable assignment:</p>\n\n<pre><code>{{define \"indexpreload\"}}\n{{$active := \"Index\"}}\n{{end}} \n</code></pre>\n\n<p>And call it first in the parsed .html:</p>\n\n<pre><code>    {{template \"indexpreload\" .}}    \n    {{template \"header\" .}}\n\n    &lt;h3 class=\"section-banner\"&gt;&lt;strong&gt;Welcome&lt;/strong&gt;&lt;/h3&gt;\n    &lt;hr class=\"divider\"&gt;\n    &lt;div class=\"form-group col-md-4 text-left\"&gt;&lt;/div&gt;\n    &lt;div class=\"form-group col-md-4 text-left\"&gt;\n        &lt;br&gt;&lt;br&gt;\n        &lt;p&gt;Content content content&lt;/p&gt;\n\n    &lt;/div&gt;\n\n    {{template \"footer\" .}}\n</code></pre>\n\n<p>I would appreciate any ideas of how to assign the variable before the header is run? I'd love to keep this login within the template so I don't have to worry about passing a variable from my program.</p>\n"}, {"tags": ["go", "memory-leaks", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "is_accepted": false, "score": 2, "last_activity_date": 1525238963, "creation_date": 1525238963, "answer_id": 50127650, "question_id": 50126750, "link": "https://stackoverflow.com/questions/50126750/panic-while-trying-to-avoid-goroutine-leak/50127650#50127650", "title": "Panic while trying to avoid goroutine leak", "body": "<p>Your error is clear enough--the channel <code>bufc</code> (which I assume you refer to as <code>errc</code>) is closed before <code>g</code> can send the value to it because the <code>select</code> statement receives only once from <code>bufc</code> and it's closed by defer.  Instead of deferring the closing of <code>bufc</code> you'd have to make some synchronization, possibly using a <code>sync.WaitGroup</code> to make sure all the values are sent before closing it, for example by just moving <code>close(bufc)</code> to after <code>wg.Wait()</code>:</p>\n\n<pre><code>go func() {\n        wg.Wait()\n        close(ch)\n        close(bufc)\n}()\n</code></pre>\n\n<p>In your case since <code>bufc</code> is buffered you don't have to close it because it's not blocking on the receiving end, but once you have more than two goroutines sending you'll still need to close it to signal properly.</p>\n"}, {"comments": [{"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1525367254, "post_id": 50128022, "comment_id": 87338676, "body": "You should mark either answer as correct for the sake of others."}, {"owner": {"reputation": 927, "user_id": 2419669, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/kuQAn.jpg?s=128&g=1", "display_name": "yangmillstheory", "link": "https://stackoverflow.com/users/2419669/yangmillstheory"}, "reply_to_user": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1525383189, "post_id": 50128022, "comment_id": 87346285, "body": "I can&#39;t do so until 6 hours from now."}], "tags": [], "owner": {"reputation": 927, "user_id": 2419669, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/kuQAn.jpg?s=128&g=1", "display_name": "yangmillstheory", "link": "https://stackoverflow.com/users/2419669/yangmillstheory"}, "is_accepted": false, "score": 0, "last_activity_date": 1525240858, "creation_date": 1525240858, "answer_id": 50128022, "question_id": 50126750, "link": "https://stackoverflow.com/questions/50126750/panic-while-trying-to-avoid-goroutine-leak/50128022#50128022", "title": "Panic while trying to avoid goroutine leak", "body": "<p>I ended up with the following implementation, which drains the buffered channel <code>bufc</code> and works correctly in all cases.</p>\n\n<pre><code>var (\n    err error\n    wg  sync.WaitGroup\n)\n\nch := make(chan bool)\nbufc := make(chan error, 2)\n\nwg.Add(2)\ngo f(bufc, &amp;wg)\ngo g(bufc, &amp;wg)\ngo func() {\n    wg.Wait()\n    close(ch)\n    close(bufc)\n}()\n\n&lt;-ch\nlog.Println(\"Goroutines are done\")\nfor err = range bufc {\n    log.Printf(\"Got an error: %v\", err)\n}\nlog.Println(\"Returning.\")\nreturn err\n</code></pre>\n"}], "owner": {"reputation": 927, "user_id": 2419669, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/kuQAn.jpg?s=128&g=1", "display_name": "yangmillstheory", "link": "https://stackoverflow.com/users/2419669/yangmillstheory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1525244691, "creation_date": 1525232034, "last_edit_date": 1525244691, "question_id": 50126750, "link": "https://stackoverflow.com/questions/50126750/panic-while-trying-to-avoid-goroutine-leak", "title": "Panic while trying to avoid goroutine leak", "body": "<p>I'm spawning some goroutines and want to hand them a channel to send back errors. In the parent goroutine, I <code>select</code> the first error and return that, or the <code>wg.Done()</code> condition, which is synchronized with closing a <code>done</code> channel. </p>\n\n<p>The closing of <code>errc</code> is deferred to avoid a goroutine leak; but it causes a race condition.</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"sync\"\n    \"time\"\n)\n\nfunc f(ch chan&lt;- bool, wg *sync.WaitGroup) {\n    defer wg.Done()\n\n    time.Sleep(1 * time.Second)\n    log.Println(\"f sending a value\")\n    ch &lt;- true\n    log.Println(\"f sent a value\")\n}\n\nfunc g(ch chan&lt;- bool, wg *sync.WaitGroup) {\n    defer wg.Done()\n\n    time.Sleep(2 * time.Second)\n    log.Println(\"g sending a value\")\n    ch &lt;- true\n    log.Println(\"g sent a value\")\n}\n\nfunc main() {\n    var wg sync.WaitGroup\n\n    ch := make(chan bool)\n    bufc := make(chan bool, 2)\n\n    defer func() {\n        log.Println(\"Closing bufc\")\n        close(bufc)\n        log.Println(\"Closed bufc\")\n        time.Sleep(5 * time.Second)\n    }()\n\n    wg.Add(2)\n    go f(bufc, &amp;wg)\n    go g(bufc, &amp;wg)\n    go func() {\n        wg.Wait()\n        close(ch)\n    }()\n\n    select {\n    case done, ok := &lt;-bufc:\n        log.Printf(\"bufc closed: %v %v\", done, ok)\n    case &lt;-ch:\n        log.Println(\"ch was closed\")\n    }\n}\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>\u2757 ~/c/scrap\n(i) go run test.go\n2018/05/01 20:28:03 f sending a value\n2018/05/01 20:28:03 f sent a value\n2018/05/01 20:28:03 bufc closed: true true\n2018/05/01 20:28:03 Closing bufc\n2018/05/01 20:28:03 Closed bufc\n2018/05/01 20:28:04 g sending a value\npanic: send on closed channel\n\ngoroutine 19 [running]:\nmain.g(0xc42009c000, 0xc42008a010)\n        /Users/yangmillstheory/code/scrap/test.go:23 +0xb2\ncreated by main.main\n        /Users/yangmillstheory/code/scrap/test.go:42 +0x11e\nexit status 2\n</code></pre>\n\n<p>Is there any way to do proper cleanup of the <code>errc</code> channel without causing a panic? Do I even need to close <code>errc</code>? Given that it's buffered, senders on that channel wouldn't block, so I would guess the answer is no?</p>\n"}, {"tags": ["go", "concurrency", "channel", "goroutine", "inotify"], "answers": [{"tags": [], "owner": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "is_accepted": true, "score": 0, "last_activity_date": 1525501709, "creation_date": 1525501709, "answer_id": 50186442, "question_id": 50126221, "link": "https://stackoverflow.com/questions/50126221/understanding-behavior-of-reading-from-channel/50186442#50186442", "title": "Understanding behavior of reading from channel", "body": "<p>After trying a few options, I settled up with a different <a href=\"https://github.com/rjeczalik/notify/\" rel=\"nofollow noreferrer\">notify</a> library. Apparently this library doesn't have option to individually close watcher based on path name, but can only do it by closing a channel. So I ended up creating a channel for every file that needs to be watched and a map to relate the file - to - channel, and when required, close the channel related to the file and re-open. The code snippet is </p>\n\n<pre><code>var fileMapChan map[string]chan notify.EventInfo\nfunc main() {\n\n\n    fileMapChan = make(map[string]chan notify.EventInfo)\n    commonNotificationChan := make(chan string, 2048)\n    for k := range parsedConf {\n        c := make(chan notify.EventInfo, 2048)\n        fileMapChan[k] = c\n    }\n    wg := new(sync.WaitGroup)\n    //Create new watcher for every file\n    for k, v := range fileMapChan {\n        wg.Add(2)\n        poller.SetNewNotifier(k, v)\n        go poller.ReadChanAndFilter(v, commonNotificationChan, wg)\n        go poller.FileStat(k, commonNotificationChan, wg)\n    }\n\n==============snip \u2702 snip=============\n\nfunc SetNewNotifier(filepath string, c chan notify.EventInfo) error{\n    log.Infoln(\"Setting new notifier to\", filepath)\n    if err := notify.Watch(filepath, c, notify.All); err != nil {\n        log.Errorln(err)\n        return err\n    }\n    return nil\n}\n\nfunc ReadChanAndFilter(r chan notify.EventInfo, w chan&lt;- string, wg *sync.WaitGroup) {\n    for i := range r {\n        log.Debugln(i.Event(), \"on\", i.Path())\n        if i.Event()&amp;notify.Rename == notify.Rename {\n            log.Infoln(i.Path(), \"renamed\")\n            w &lt;- i.Path()\n            close(r)\n            notify.Stop(r)\n            runtime.Goexit()\n        }\n\n    }\n    defer wg.Done()\n}\n</code></pre>\n\n<p>I don't know if this is going to be the best approach, but this is working for me. Whenever a file is moved, it will re-add the watcher.</p>\n\n<p>Thank you.</p>\n"}], "owner": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 50186442, "answer_count": 1, "score": 1, "last_activity_date": 1525501709, "creation_date": 1525226902, "last_edit_date": 1525244894, "question_id": 50126221, "link": "https://stackoverflow.com/questions/50126221/understanding-behavior-of-reading-from-channel", "title": "Understanding behavior of reading from channel", "body": "<p>I am trying to write a program that uses inotify to watch a file, and if the file is removed, remove the watcher and set new watcher. The code I have tried for the same is</p>\n\n<pre><code>func main() {\n    fsNotifyChan := make(chan fsnotify.Event)\n    inotify.CreateWatcher() // code included below\n    wg := new(sync.WaitGroup)\n    wg.Add(1)\n    go func() {\n        for i := range fsNotifyChan {\n            time.Sleep(time.Second * 5)\n            fmt.Println(i)\n            inotify.CreateWatcher()\n            inotify.SetNewWatcher(i.Name, fsNotifyChan)\n        }\n    }()\n\n    for k := range parsedConf{\n        go inotify.SetNewWatcher(k, fsNotifyChan)\n    }\n\n    wg.Wait()\n}\n</code></pre>\n\n<p>Where k is a map and the keys are paths to 2 files <code>/var/log/syslog</code> and <code>/var/log/auth.log</code> for example.</p>\n\n<p>The function that I use to create inotify watcher is</p>\n\n<pre><code>package inotify\nvar Watcher *fsnotify.Watcher\nvar err error\n\nfunc CreateWatcher () {\n    Watcher, err = fsnotify.NewWatcher()\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n\nfunc SetNewWatcher(filepath string, c chan fsnotify.Event) {\n    log.Infoln(\"Setting Watcher for \", filepath)\n\n    defer Watcher.Close()\n    wg := new(sync.WaitGroup)\n    wg.Add(1)\n    go func() {\n        for {\n            select {\n            case event := &lt;-Watcher.Events:\n                log.Debugln(\"event:\", event)\n                if event.Op&amp;fsnotify.Rename == fsnotify.Rename {\n                    log.Infoln(event)\n                    removeWatcher(filepath)\n                    c &lt;- event\n                    wg.Done()\n                    runtime.Goexit()\n                } else if event.Op&amp;fsnotify.Remove == fsnotify.Remove {\n                    log.Infoln(event)\n                    removeWatcher(filepath)\n                    c &lt;- event\n                    wg.Done()\n                    runtime.Goexit()\n\n                }\n            case err := &lt;-Watcher.Errors:\n                log.Errorln(\"error:\", err)\n                removeWatcher(filepath)\n                wg.Done()\n                runtime.Goexit()\n\n            }\n        }\n        wg.Done()\n    }()\n\n    err = Watcher.Add(filepath)\n    if err != nil {\n        log.Fatal(err)\n    }\n    wg.Wait()\n}\n\nfunc removeWatcher(filename string) {\n    err := Watcher.Remove(filename)\n    log.Debugln(\"Removed watcher for\", filename)\n    if err != nil {\n        log.Errorln(err)\n    }\n}\n</code></pre>\n\n<p>The problem I am seeing is when I start to run the program,</p>\n\n<p>First output:</p>\n\n<pre><code>iNotifier.go:18: INFO: Setting Watcher for  /var/log/auth.log\niNotifier.go:18: INFO: Setting Watcher for  /var/log/syslog\n</code></pre>\n\n<p>Then after a sudo command like <code>echo hi | sudo tee -a  /var/log/syslog</code>\nI can see</p>\n\n<pre><code>iNotifier.go:27: DEBUG: event: \"/var/log/auth.log\": WRITE\niNotifier.go:27: DEBUG: event: \"/var/log/auth.log\": WRITE\niNotifier.go:27: DEBUG: event: \"/var/log/syslog\": WRITE\n</code></pre>\n\n<p>which is perfectly fine now.</p>\n\n<p>Now if I try to move the syslog and put it back as </p>\n\n<pre><code>\u279c  bin sudo mv /var/log/syslog /var/log/syslog.bak\n\u279c  bin sudo mv /var/log/syslog.bak /var/log/syslog\n</code></pre>\n\n<p>or remove the file itself and touch a new one.</p>\n\n<p>The output looks like </p>\n\n<pre><code>iNotifier.go:27: DEBUG: event: \"/var/log/auth.log\": WRITE\niNotifier.go:27: DEBUG: event: \"/var/log/auth.log\": WRITE\niNotifier.go:27: DEBUG: event: \"/var/log/syslog\": RENAME\niNotifier.go:29: INFO: \"/var/log/syslog\": RENAME\niNotifier.go:63: DEBUG: Removed watcher for /var/log/syslog\niNotifier.go:43: ERROR: error: &lt;nil&gt;\niNotifier.go:63: DEBUG: Removed watcher for /var/log/auth.log\niNotifier.go:65: ERROR: bad file descriptor\n\"/var/log/syslog\": RENAME\niNotifier.go:18: INFO: Setting Watcher for  /var/log/syslog\n</code></pre>\n\n<p>of which <code>iNotifier.go:65: ERROR: bad file descriptor</code> could be caused because the file has been moved already, and then the goroutine will exit with <code>runtime.Goexit()</code></p>\n\n<p>Now if I do the same sudo command <code>echo hi | sudo tee -a  /var/log/syslog</code>,\nI can only see one inotify output from syslog file and not from the authlog file although things are written there.</p>\n\n<pre><code>iNotifier.go:27: DEBUG: event: \"/var/log/syslog\": WRITE\n</code></pre>\n\n<p>If I move the file again and move it back one more time, I stop getting any more notifications.</p>\n\n<pre><code>iNotifier.go:27: DEBUG: event: \"/var/log/syslog\": WRITE\niNotifier.go:27: DEBUG: event: \"/var/log/syslog\": RENAME\niNotifier.go:29: INFO: \"/var/log/syslog\": RENAME\niNotifier.go:63: DEBUG: Removed watcher for /var/log/syslog\n</code></pre>\n\n<p>and that's the last output. Any more file operations and I don't see any output. I know this could be a logical error on how I am using the way channels are supposed to be used. I am not explicitly closing the channel, and I am passing it again on further iterations. Can someone please help me understand what am I doing wrong here?</p>\n"}, {"tags": ["go", "package", "cycle"], "comments": [{"owner": {"reputation": 571, "user_id": 4672066, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/76f2602db81aefda840f27845b9160e3?s=128&d=identicon&r=PG&f=1", "display_name": "SimpleCoder", "link": "https://stackoverflow.com/users/4672066/simplecoder"}, "reply_to_user": {"reputation": 983, "user_id": 7059119, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209343272591927/picture?type=large", "display_name": "Aristofanio Garcia", "link": "https://stackoverflow.com/users/7059119/aristofanio-garcia"}, "edited": false, "score": 0, "creation_date": 1525225593, "post_id": 50125780, "comment_id": 87270159, "body": "@aristofanio-garcia, added the info"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1525233437, "post_id": 50125780, "comment_id": 87271732, "body": "Do not use local import. Dead simple. Read How to Write Go Code and <i>stick</i> <i>to</i> <i>it</i> <i>word</i> <i>for</i> _word. And stop renaming your import."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1525245014, "post_id": 50125780, "comment_id": 87275675, "body": "Please use <code>gofmt</code>. Your code is very hard to read--especially due to mixing import styles."}, {"owner": {"reputation": 571, "user_id": 4672066, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/76f2602db81aefda840f27845b9160e3?s=128&d=identicon&r=PG&f=1", "display_name": "SimpleCoder", "link": "https://stackoverflow.com/users/4672066/simplecoder"}, "edited": false, "score": 0, "creation_date": 1525325260, "post_id": 50125780, "comment_id": 87313213, "body": "I should have mentioned, p4runtime.pb.go is the code generated by the google protobuf compiler. This was generated for a .proto file I picked up from an opensourced project. I also found the issue in the .proto file. Basically, there are 3 .proto files.  1.proto -&gt; package a 2.proto, 3.proto -&gt; package b  1.proto imports 2.proto, and 3.proto imports 1.proto. This causes the loop. I&#39;ve filed a bug against that project to fix this loop.  Thanks folks."}], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 1, "last_activity_date": 1525245136, "creation_date": 1525245136, "answer_id": 50128983, "question_id": 50125780, "link": "https://stackoverflow.com/questions/50125780/import-cycle-not-allowed-with-go-install/50128983#50128983", "title": "&quot;import cycle not allowed&quot; with go install", "body": "<p>The error message pretty much says it all:</p>\n\n<p><code>rtagent</code> imports <code>p4</code> which in turn imports <code>p4</code> (itself).  This is not allowed.</p>\n\n<p>Your code makes this obvious, too:</p>\n\n<pre><code>package p4\n// &lt;snip&gt;\nimport p41 \"p4\"  // &lt;-- importing itself\n</code></pre>\n"}], "owner": {"reputation": 571, "user_id": 4672066, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/76f2602db81aefda840f27845b9160e3?s=128&d=identicon&r=PG&f=1", "display_name": "SimpleCoder", "link": "https://stackoverflow.com/users/4672066/simplecoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3576, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1525245136, "creation_date": 1525222637, "last_edit_date": 1525244952, "question_id": 50125780, "link": "https://stackoverflow.com/questions/50125780/import-cycle-not-allowed-with-go-install", "title": "&quot;import cycle not allowed&quot; with go install", "body": "<p>Folks- I'm not able to understand this:</p>\n\n<p>My code layout:</p>\n\n<p>src/rtagent/rtagent.go (has package main)</p>\n\n<p>src/simplerouter/simplerouter.go (has package simplerouter)</p>\n\n<p>src/p4/p4runtime.pb.go (has package p4)</p>\n\n<h2>rtagent.go:</h2>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"golang.org/x/net/context\"\n    \"google.golang.org/grpc\"\n    \"google.golang.org/grpc/reflection\"\n    \"io\"\n    \"log\"\n    \"net\"\n    \"p4\"\n    \"simplerouter\"\n    p4_config \"p4/config\"\n)\n</code></pre>\n\n<h2>simplerouter.go</h2>\n\n<pre><code>package simplerouter\nimport (\n    \"encoding/binary\"\n    \"errors\"\n    \"fmt\"\n    \"p4\"\n    \"p4InfoUtils\"\n    \"strings\"\n    \"unsafe\"\n)\n</code></pre>\n\n<h2>p4runtime.pb.go</h2>\n\n<pre><code>package p4\nimport proto \"github.com/golang/protobuf/proto\"\nimport fmt \"fmt\"\nimport math \"math\"\nimport google_protobuf \"github.com/golang/protobuf/ptypes/any\"\nimport google_rpc \"google.golang.org/genproto/googleapis/rpc/status\"\nimport p4_config \"p4/config\"\nimport p41 \"p4\"\nimport (\n    context \"golang.org/x/net/context\"\n    grpc \"google.golang.org/grpc\"\n)\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>go install rtagent\nimport cycle not allowed\npackage rtagent\n        imports p4\n        imports p4\n</code></pre>\n\n<p>Could someone please help?</p>\n"}, {"tags": ["go", "tar"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1525215892, "post_id": 50124923, "comment_id": 87268127, "body": "What specifically are you trying to avoid? There&#39;s not really much difference between taking the checksum of the tar stream, and recursively reading each file and directory listing. I mean the tar format is technically not needed, but you need <i>some</i> directory format to checksum, so tar might be as good as any."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1525245470, "post_id": 50124923, "comment_id": 87275921, "body": "I think it&#39;s necessary to know the reason and context for this checksum. A checksum of a directory is not an easily defined thing, since a directory isn&#39;t a &quot;thing&quot;, but rather a high-level concept, used by humans. In particular, do you need the checksum to be valid across different filesystems and/or operating systems? Should modification and access times, permissions, or other metadata be taken into consideration? Without knowing your use case, it&#39;s impossible to provide a meaningful answer."}, {"owner": {"reputation": 923, "user_id": 2525507, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/38075359ff02b2b8edec751cefb36c7a?s=128&d=identicon&r=PG", "display_name": "loonyuni", "link": "https://stackoverflow.com/users/2525507/loonyuni"}, "edited": false, "score": 0, "creation_date": 1525278650, "post_id": 50124923, "comment_id": 87297161, "body": "I see, my reasoning was mostly that the top level directory is quite large. I have decided to take a different approach specific to my overall problem, but thanks for enlightening me on the lack of difference between the two."}], "answers": [{"tags": [], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "is_accepted": false, "score": 3, "last_activity_date": 1525263861, "creation_date": 1525263861, "answer_id": 50134601, "question_id": 50124923, "link": "https://stackoverflow.com/questions/50124923/get-checksum-of-a-directory-in-golang/50134601#50134601", "title": "get checksum of a directory in golang", "body": "<p>Check the <a href=\"https://blog.golang.org/pipelines\" rel=\"nofollow noreferrer\">Parallel digestion</a> example from the <a href=\"https://blog.golang.org/pipelines\" rel=\"nofollow noreferrer\">https://blog.golang.org/pipelines</a>, starting from the <strong>Digesting a tree</strong> section, probably can give you some ideas.</p>\n\n<p>So you can go from:</p>\n\n<pre><code>// MD5All reads all the files in the file tree rooted at root and returns a map\n// from file path to the MD5 sum of the file's contents.  If the directory walk\n// fails or any read operation fails, MD5All returns an error.\nfunc MD5All(root string) (map[string][md5.Size]byte, error) {\n    m := make(map[string][md5.Size]byte)\n    err := filepath.Walk(root, func(path string, info os.FileInfo, err error) error {\n        if err != nil {\n            return err\n        }\n        if !info.Mode().IsRegular() {\n            return nil\n        }\n        data, err := ioutil.ReadFile(path)\n        if err != nil {\n            return err\n        }\n        m[path] = md5.Sum(data)\n        return nil\n    })\n    if err != nil {\n        return nil, err\n    }\n    return m, nil\n}\n</code></pre>\n\n<p>To the parallel version: <a href=\"https://blog.golang.org/pipelines/parallel.go\" rel=\"nofollow noreferrer\">https://blog.golang.org/pipelines/parallel.go</a></p>\n"}, {"tags": [], "owner": {"reputation": 3227, "user_id": 1923095, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/66893a32ed3f0cf5f0628c504b844701?s=128&d=identicon&r=PG", "display_name": "Zamicol", "link": "https://stackoverflow.com/users/1923095/zamicol"}, "is_accepted": false, "score": 0, "last_activity_date": 1601060154, "creation_date": 1601060154, "answer_id": 64069941, "question_id": 50124923, "link": "https://stackoverflow.com/questions/50124923/get-checksum-of-a-directory-in-golang/64069941#64069941", "title": "get checksum of a directory in golang", "body": "<p>For <code>go mod</code> Russ Cox wrote <a href=\"https://github.com/golang/mod/blob/ce943fd02449f621243c9ea6e64098e84752b92b/sumdb/dirhash/hash.go\" rel=\"nofollow noreferrer\">dirhash</a>.</p>\n<p>There's two approaches, one hashes the files in a directory, the other hashes a zip while ignoring non-deterministic information like file date.</p>\n<p>Extra metadata isn't necessarily meaningful for file contents and should probably be ignored.  I recommend investigating the zip method first if it is suitable for your needs.</p>\n"}], "owner": {"reputation": 923, "user_id": 2525507, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/38075359ff02b2b8edec751cefb36c7a?s=128&d=identicon&r=PG", "display_name": "loonyuni", "link": "https://stackoverflow.com/users/2525507/loonyuni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1616, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1601060154, "creation_date": 1525215149, "question_id": 50124923, "link": "https://stackoverflow.com/questions/50124923/get-checksum-of-a-directory-in-golang", "title": "get checksum of a directory in golang", "body": "<p>Is there a way to generate a checksum of an entire directory and its contents in golang?</p>\n\n<p>I know how that one can tar the directory and then grab the checksum of that, but I would like to avoid that if possible.</p>\n"}, {"tags": ["winapi", "go", "etw"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1525213711, "post_id": 50124486, "comment_id": 87267505, "body": "Note that that API function accepts <i>a pointer to a pointer;</i> that is, it accept the address of a memory location containing an address of the array. You&#39;re passing the address of the array instead."}, {"owner": {"reputation": 43, "user_id": 9727548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35fcc6b361276a114b72eb84bda85904?s=128&d=identicon&r=PG&f=1", "display_name": "EmFl", "link": "https://stackoverflow.com/users/9727548/emfl"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1525246413, "post_id": 50124486, "comment_id": 87276444, "body": "I tried this : GuidPropertiesArray:= make([]*TRACE_GUID_PROPERTIES, 50)     ptr := &amp;GuidPropertiesArray[0]     ret, _, _ := procEnumerateTraceGuids.Call(uintptr(unsafe.Pointer(&amp;ptr)), MaxProv, nbProviders)"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1525249870, "post_id": 50124486, "comment_id": 87278239, "body": "So you tried that, <i>and?\u2026</i> Still, my guess is that you 1) should allocate an array of structs (not pointers);2) take the address of its 1st element and place it to a variable; 3) take its address and pass to that function."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1525249998, "post_id": 50124486, "comment_id": 87278298, "body": "All-in-all, that&#39;s not how such problems are solved. You search for example usage of win32 API functions in C or C++ and then translate them to Go (of course if you&#39;re lazy to just carefully read the API doc page)."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1525252504, "post_id": 50124486, "comment_id": 87279736, "body": "BTW the example is right there in the function doc. The key to translating that C to Go is that C&#39;s <code>malloc</code> and <code>realloc</code> return an (untyped) pointer even though you typically allocate memory for an array of values whose type is not pointer."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 9727548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35fcc6b361276a114b72eb84bda85904?s=128&d=identicon&r=PG&f=1", "display_name": "EmFl", "link": "https://stackoverflow.com/users/9727548/emfl"}, "edited": false, "score": 0, "creation_date": 1525428954, "post_id": 50138388, "comment_id": 87362108, "body": "Thank you a LOT for this. I haven&#39;t had the time yet to compare but tested very quickly your solution and of course it worked :). Huge thanks for the time spent."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 43, "user_id": 9727548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35fcc6b361276a114b72eb84bda85904?s=128&d=identicon&r=PG&f=1", "display_name": "EmFl", "link": "https://stackoverflow.com/users/9727548/emfl"}, "edited": false, "score": 0, "creation_date": 1525445155, "post_id": 50138388, "comment_id": 87372386, "body": "BTW, inspecting <a href=\"https://github.com/golang/sys/blob/master/windows/\" rel=\"nofollow noreferrer\">this</a> hints at a couple of things: 1) there&#39;s no need to use <code>golang.org&#47;x&#47;sys&#47;windows</code>\u2014the stock <code>syscall</code> should have the same stuff by now; 2) that package seem to export the <code>ERROR_MODE_DATA</code> value alreasy, so no need to to that explicitly as I did. I&#39;d try these suggestions and see if they work out."}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 2, "last_activity_date": 1550912952, "last_edit_date": 1550912952, "creation_date": 1525275174, "answer_id": 50138388, "question_id": 50124486, "link": "https://stackoverflow.com/questions/50124486/reading-etw-providers-using-go/50138388#50138388", "title": "Reading ETW providers using go", "body": "<p>OK, I had a bit of free time and an access to a Windows XP box,\nso I've decided to dust off my Windows programming skills\nand wrote a working solution:</p>\n\n<pre><code>package main\n\nimport (\n    \"golang.org/x/sys/windows\"\n\n    \"log\"\n    \"syscall\"\n    \"unsafe\"\n)\n\nvar (\n    modAdvapi32             = windows.NewLazySystemDLL(\"advapi32\")\n    procEnumerateTraceGuids = modAdvapi32.NewProc(\"EnumerateTraceGuids\")\n)\n\ntype traceGuidProperties struct {\n    guid        syscall.GUID\n    guidType    uint32\n    loggerId    uint32\n    enableLevel uint32\n    enableFlags uint32\n    isEnable    uint32\n}\n\nfunc enumerateTraceGuids(ptr **traceGuidProperties, count uint32, out *uint32) error {\n    rc, _, _ := procEnumerateTraceGuids.Call(uintptr(unsafe.Pointer(ptr)),\n        uintptr(count), uintptr(unsafe.Pointer(out)))\n    if rc != 0 {\n        return syscall.Errno(rc)\n    }\n    return nil\n}\n\nfunc enumTraceGuids() ([]*traceGuidProperties, error) {\n    var errMoreData = syscall.Errno(234)\n\n    var (\n        dummyProps traceGuidProperties\n        dummyPtr   = &amp;dummyProps\n\n        count uint32\n    )\n\n    err := enumerateTraceGuids(&amp;dummyPtr, 0, &amp;count)\n    if err != errMoreData {\n        return nil, err\n    }\n\n    items := make([]*traceGuidProperties, count)\n    for i := range items {\n        items[i] = new(traceGuidProperties)\n    }\n\n    for {\n        err = enumerateTraceGuids(&amp;items[0], count, &amp;count)\n        if err == nil {\n            break\n        }\n        if err != errMoreData {\n            return nil, err\n        }\n        for i := 0; i &lt; int(count)-len(items); i++ {\n            items = append(items, new(traceGuidProperties))\n        }\n    }\n\n    return items[:count], nil\n}\n\nfunc main() {\n    log.SetFlags(0)\n\n    data, err := enumTraceGuids()\n    if err != nil {\n        log.Fatal(err)\n    }\n    log.Printf(\"len(data)=%d\\n\", len(data))\n    for i := range data {\n        log.Println(*(data[i]))\n    }\n}\n</code></pre>\n\n<p>The key points:</p>\n\n<ul>\n<li><p>I was wrong when I told you that\n\u00abyou \u2026 should allocate an array of structs (not pointers)\u00bb\u2014in fact\n<code>EnumerateTraceGuids</code> indeed expects an array of pointers.</p></li>\n<li><p>As hinted <a href=\"https://stackoverflow.com/a/9273324/720999\">here</a>,\nthere are two subtleties with how <code>EnumerateTraceGuids</code> works:</p>\n\n<ul>\n<li>Contrary to what its documentation states,\nit actually supports being called with its <code>PropertyArrayCount</code>\nparameter set to 0, in which case it's expected to return <code>ERROR_MORE_DATA</code>\nwhile having set <code>GuidCount</code> to the number of elements of the input\narray required for the (next) call to complete successfully.\nIOW, that way we know how many trace GUIDs the system currently\n\"knows about\".</li>\n<li>Still, even in this case, the function performs validity check\non the input array (see below).</li>\n</ul></li>\n<li><p>As it turns out, the function expects an array of pointers to\n<code>TRACE_GUID_PROPERTIES</code> blocks <em>allocated by you.</em></p>\n\n<p>In other words, if it says you it knows about 10 trace GUIDs,\nyou have to allocate 10 values of type <code>TRACE_GUID_PROPERTIES</code>,\nthen make an array of 10 pointers to those values and pass a pointer\nto the 1st element of that array to the function.</p></li>\n<li><p>Notice that there's an inherent race between changes occuring\nin the system (those traces added or removed for any number of reasons)\nand the calls to <code>EnumerateTraceGuids</code>.</p>\n\n<p>This means if the first call to this function told you it \"knows\"\nabout 10 trace GUIDs, on the next call it may turn out\nthere's already 20 trace GUIDs, or 5 GUIDs\n(or any other number of them FWIW).</p>\n\n<p>So we account for both of these possibilities in the following way:</p>\n\n<ol>\n<li><p>First we do a call with a pointer to a single (but valid)\n<code>TRACE_GUID_PROPERTIES</code> value, allocated statically \n(hence the function \"sees\" what looks like an array of a single element),\nwhile telling the function the input \"array\" has zero elements.</p>\n\n<p>We expect the function to fail with <code>ERROR_MORE_DATA</code>\nand put the actual number of trace GUIDs it \"knows\" about into the variable\nwe've supplied it a pointer to.</p></li>\n<li><p>We allocate that much <code>TRACE_GUID_PROPERTIES</code> memory blocks\nthe function indicated on the first call.\nFor this, we use the <code>new()</code> built-in function which behaves somewhat\nlike <code>malloc()</code> in the standard C library\u2014it allocates the memory for\na value of the specified type and returns a pointer to the allocated\nmemory block.</p></li>\n<li><p>We create an array of pointers to these allocated memory blocks\nand call <code>EnumerateTraceGuids</code> again.</p></li>\n<li><p>If it succeeds, we handle the possibility it returned less\nelements than we've allocated, and reslice our slice.</p></li>\n<li><p>If it fails with <code>ERROR_MORE_DATA</code>, we extend our slice with\nwhatever the number of elements is needed (allocating memory for their\n<code>TRACE_GUID_PROPERTIES</code> blocks first), and try calling the function again.</p></li>\n</ol></li>\n<li><p>The \"magic number\" 234 is the actual code for the <code>ERROR_MORE_DATA</code> value.</p></li>\n</ul>\n\n<p>Sorry for the initial confusion.</p>\n"}], "owner": {"reputation": 43, "user_id": 9727548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35fcc6b361276a114b72eb84bda85904?s=128&d=identicon&r=PG&f=1", "display_name": "EmFl", "link": "https://stackoverflow.com/users/9727548/emfl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 665, "favorite_count": 0, "accepted_answer_id": 50138388, "answer_count": 1, "score": 1, "last_activity_date": 1550912952, "creation_date": 1525212216, "last_edit_date": 1525275699, "question_id": 50124486, "link": "https://stackoverflow.com/questions/50124486/reading-etw-providers-using-go", "title": "Reading ETW providers using go", "body": "<p>I'm trying to access the EnumerateTraceGuids function from Advapi32.dll in go.\nI'm at the very early stage and still trying to decipher what is it that I must do. I have the following code that keeps giving me Error: 87, meaning ERROR_INVALID_PARAMETER.</p>\n\n<p>I've used this file as a starting point though it's only writing and not reading : \n<a href=\"https://github.com/moby/moby/blob/master/daemon/logger/etwlogs/etwlogs_windows.go\" rel=\"nofollow noreferrer\">https://github.com/moby/moby/blob/master/daemon/logger/etwlogs/etwlogs_windows.go</a></p>\n\n<p>Official documentation for the function I'm trying to call is here : \n<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa363713(v=vs.85).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/windows/desktop/aa363713(v=vs.85).aspx</a></p>\n\n<p>It requires GuidPropertiesArray [in, out] An array of pointers to TRACE_GUID_PROPERTIES structures. This structure is the following (<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa364143(v=vs.85).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/windows/desktop/aa364143(v=vs.85).aspx</a>)</p>\n\n<pre><code>typedef struct _TRACE_GUID_PROPERTIES {\n  GUID    Guid;\n  ULONG   GuidType;\n  ULONG   LoggerId;\n  ULONG   EnableLevel;\n  ULONG   EnableFlags;\n  BOOLEAN IsEnable;\n} TRACE_GUID_PROPERTIES, *PTRACE_GUID_PROPERTIES;\n</code></pre>\n\n<p>I have the following code to try and do this :</p>\n\n<pre><code>package main\nimport (\n    \"errors\"\n    \"fmt\"\n    \"syscall\"\n    \"unsafe\"\n    \"github.com/sirupsen/logrus\"\n    \"golang.org/x/sys/windows\"\n)\n\nconst (\n    win32CallSuccess = 0\n    MaxProv = 50\n    nbProviders = 50\n)\n\nvar (\n    modAdvapi32          = windows.NewLazySystemDLL(\"Advapi32.dll\")\n    procEnumerateTraceGuids = modAdvapi32.NewProc(\"EnumerateTraceGuids\")\n)\n\ntype ulong int32\n\ntype TRACE_GUID_PROPERTIES struct {\n    Guid syscall.GUID\n    GuidType ulong\n    LoggerId ulong\n    EnableLevel ulong\n    EnableFlags ulong\n    IsEnable bool\n}\n\nfunc callEnumerateTraceGuids() error {\n    GuidPropertiesArray:= make([]TRACE_GUID_PROPERTIES, 1)\n    ptr := &amp;GuidPropertiesArray[0]\n    ret, _, _ := procEnumerateTraceGuids.Call(uintptr(unsafe.Pointer(&amp;ptr)), MaxProv, nbProviders)\n    if ret != win32CallSuccess {\n        errorMessage := fmt.Sprintf(\"Failed to register ETW provider. Error: %d\", ret)\n        logrus.Error(errorMessage)\n        return errors.New(errorMessage)\n    }\n    return nil\n}\n\nfunc main() {\n    callEnumerateTraceGuids()\n}\n</code></pre>\n\n<p>At this point I'm not sure what is it that I must do. I've tried a lot of variation of initializing the array without success.\nHoping someone can point me in the right direction.\nThanks !</p>\n\n<p>Edit : Changed code based on comments but still getting the same error. </p>\n\n<p>PS : This is my first time posting to stackoverflow and I've already been told that I'm lazy less than 12 hours after posting my question (yay!) so not sure I'm asking this right...I am not too familiar with go and never called windows DLL from go before and since I keep hitting that ERROR_INVALID_PARAMETER I thought of reaching out to try and pass this first wall to be able to grasp some concepts at the same time. Hope this helps understands my request (ie. I come in peace).</p>\n"}, {"tags": ["go", "ibm-cloud-infrastructure"], "answers": [{"tags": [], "owner": {"reputation": 668, "user_id": 9426033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e497a5abd02ca5ab68b84c07a1d084cd?s=128&d=identicon&r=PG&f=1", "display_name": "F.Ojeda", "link": "https://stackoverflow.com/users/9426033/f-ojeda"}, "is_accepted": true, "score": 0, "last_activity_date": 1525289975, "creation_date": 1525289975, "answer_id": 50142325, "question_id": 50123606, "link": "https://stackoverflow.com/questions/50123606/receiving-error-when-attempting-to-verify-a-virtual-machine-order/50142325#50142325", "title": "Receiving error when attempting to verify a virtual machine order", "body": "<p>You just need to add the attribute \u00a8Device\u00a8 for each  Virtual_Guest_Block_Device object and the \u00a8 LocalDiskFlag \u00a8 attribute must be added once and not for each Virtual_Guest_Block_Device.</p>\n\n<p>The same that this example:</p>\n\n<pre><code>blockDevices := make([]datatypes.Virtual_Guest_Block_Device, 2)\n       blockDevices[0] = datatypes.Virtual_Guest_Block_Device{\n              Device: sl.String(\"0\"),\n              DiskImage: &amp;datatypes.Virtual_Disk_Image{\n                     Capacity: sl.Int(100),\n              },\n       }\n       blockDevices[1] = datatypes.Virtual_Guest_Block_Device{\n              Device: sl.String(\"2\"),\n              DiskImage: &amp;datatypes.Virtual_Disk_Image{\n                     Capacity: sl.Int(100),\n              },\n       }\n</code></pre>\n\n<p>After that you have to add the symbol \u00a8&amp;\u00a8 to the parameter  \u00a8 guest \u00a8 in the method\nVerifyOrder without this the code will not run. </p>\n\n<pre><code>result, err := productOrderInstance.VerifyOrder(&amp;guest)\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 3729938, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/10d93eb4a8858bdd81a5ad0286d82b41?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/3729938/dennis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 50142325, "answer_count": 1, "score": -2, "last_activity_date": 1525289975, "creation_date": 1525207649, "last_edit_date": 1525208309, "question_id": 50123606, "link": "https://stackoverflow.com/questions/50123606/receiving-error-when-attempting-to-verify-a-virtual-machine-order", "title": "Receiving error when attempting to verify a virtual machine order", "body": "<p>When I run the below code I get the error <code>SoftLayer_Exception_InvalidValue: Invalid value provided for 'blockDevices.device'. A device number must be provided for all block devices. (HTTP 200)</code></p>\n\n<p>What is wrong with the way I initialize the block devices?</p>\n\n<p>I see the fields, <code>Id</code> and <code>Uuid</code> for type <code>Virtual_Disk_Image</code>, but no number. From the descriptions it sounds like these values are set post-creation.\n<a href=\"https://github.com/softlayer/softlayer-go/blob/master/datatypes/virtual.go#L91\" rel=\"nofollow noreferrer\">https://github.com/softlayer/softlayer-go/blob/master/datatypes/virtual.go#L91</a></p>\n\n<pre><code>func verifyOrderTest(c Creds) (string, error) {\n    sess := session.New(*c.user, *c.key)\n    service := services.GetVirtualGuestService(sess)\n    guestTpl := getGuestTplTest()\n    guest, err := service.GenerateOrderTemplate(&amp;guestTpl)\n    if err != nil {\n        return \"\", err\n    }\n    productOrderInstance := services.GetProductOrderService(sess)\n    _, err = productOrderInstance.VerifyOrder(guest)\n    if err != nil {\n        return \"\", err\n    }\n    return \"success\", nil\n}\n\nfunc getGuestTplTest() (datatypes.Virtual_Guest) {\n    blockDevices := make([]datatypes.Virtual_Guest_Block_Device, 2)\n    blockDevices[0] = datatypes.Virtual_Guest_Block_Device{\n        DiskImage: &amp;datatypes.Virtual_Disk_Image{\n            Capacity: sl.Int(100),\n            LocalDiskFlag: sl.Bool(true),\n        },\n    }\n    blockDevices[1] = datatypes.Virtual_Guest_Block_Device{\n        DiskImage: &amp;datatypes.Virtual_Disk_Image{\n            Capacity: sl.Int(100),\n            LocalDiskFlag: sl.Bool(true),\n        },\n    }\n\n    guestTpl := datatypes.Virtual_Guest{\n        BandwidthAllocation: sl.Float(10),\n        BlockDevices: blockDevices,\n        Datacenter: &amp;datatypes.Location{Name: sl.String(\"dal13\")},\n        DedicatedAccountHostOnlyFlag: sl.Bool(true),\n        Domain: sl.String(\"website.com\"),\n        Hostname: sl.String(\"hostname\"),\n        OperatingSystemReferenceCode: sl.String(\"UBUNTU_16_64\"),\n        LocalDiskFlag: sl.Bool(true),\n        MaxMemory: sl.Int(32768),\n        StartCpus: sl.Int(16),\n    }\n    return guestTpl\n}\n</code></pre>\n"}, {"tags": ["arrays", "xml", "string", "go"], "comments": [{"owner": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "edited": false, "score": 0, "creation_date": 1525205458, "post_id": 50122863, "comment_id": 87264320, "body": "I suspect you are going to have some difficulty re-creating all the namespacing and other attributes back in the recreated xml. In other words, you could likely parse this properly and come up with &#39;TomHanks&#39; somewhere, but when you went to write it back as xml, you would lose some information in the document.  Is go the proper tool for this job? Would you be better off with something like <code>sed</code> or <code>perl</code> and treat it like a text replacement perhaps?"}, {"owner": {"reputation": 25, "user_id": 9458032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6069dc8ef91e7be0b48186284a1bb6da?s=128&d=identicon&r=PG&f=1", "display_name": "Gofurther", "link": "https://stackoverflow.com/users/9458032/gofurther"}, "reply_to_user": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "edited": false, "score": 0, "creation_date": 1525205631, "post_id": 50122863, "comment_id": 87264412, "body": "That&#39;s what I&#39;m starting to think... big headache here haha because I&#39;ve got a lot of go code behind this with opening files and what not. needs to run on a Windows platform so wasn&#39;t sure if bash would run as an executable in Windows."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9458032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6069dc8ef91e7be0b48186284a1bb6da?s=128&d=identicon&r=PG&f=1", "display_name": "Gofurther", "link": "https://stackoverflow.com/users/9458032/gofurther"}, "edited": false, "score": 0, "creation_date": 1525204738, "post_id": 50122981, "comment_id": 87263996, "body": "It&#39;s gotta be done on like 50,000 files unfortunately"}, {"owner": {"reputation": 25, "user_id": 7325229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21ced0dd21f15e2f06b77c43f873adc?s=128&d=identicon&r=PG&f=1", "display_name": "lextragon", "link": "https://stackoverflow.com/users/7325229/lextragon"}, "reply_to_user": {"reputation": 25, "user_id": 9458032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6069dc8ef91e7be0b48186284a1bb6da?s=128&d=identicon&r=PG&f=1", "display_name": "Gofurther", "link": "https://stackoverflow.com/users/9458032/gofurther"}, "edited": false, "score": 0, "creation_date": 1525204886, "post_id": 50122981, "comment_id": 87264049, "body": "Use a for loop ;)"}, {"owner": {"reputation": 25, "user_id": 9458032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6069dc8ef91e7be0b48186284a1bb6da?s=128&d=identicon&r=PG&f=1", "display_name": "Gofurther", "link": "https://stackoverflow.com/users/9458032/gofurther"}, "edited": false, "score": 0, "creation_date": 1525204954, "post_id": 50122981, "comment_id": 87264080, "body": "But how would I access that field?"}, {"owner": {"reputation": 25, "user_id": 7325229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21ced0dd21f15e2f06b77c43f873adc?s=128&d=identicon&r=PG&f=1", "display_name": "lextragon", "link": "https://stackoverflow.com/users/7325229/lextragon"}, "reply_to_user": {"reputation": 25, "user_id": 9458032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6069dc8ef91e7be0b48186284a1bb6da?s=128&d=identicon&r=PG&f=1", "display_name": "Gofurther", "link": "https://stackoverflow.com/users/9458032/gofurther"}, "edited": false, "score": 0, "creation_date": 1525205392, "post_id": 50122981, "comment_id": 87264274, "body": "Create a variable that gets element by tag name cp:lastModifiedBy and use it in the for loop. Then change that variable&#39;s value inside the for loop."}, {"owner": {"reputation": 25, "user_id": 9458032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6069dc8ef91e7be0b48186284a1bb6da?s=128&d=identicon&r=PG&f=1", "display_name": "Gofurther", "link": "https://stackoverflow.com/users/9458032/gofurther"}, "edited": false, "score": 0, "creation_date": 1525205970, "post_id": 50122981, "comment_id": 87264565, "body": "Yeah that&#39;d be nice. Not sure how to go about getting that tag name though. Doesn&#39;t seem to be anything inside Go&#39;s xml package. Do you have any idea? Much appreciated."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 25, "user_id": 9458032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6069dc8ef91e7be0b48186284a1bb6da?s=128&d=identicon&r=PG&f=1", "display_name": "Gofurther", "link": "https://stackoverflow.com/users/9458032/gofurther"}, "edited": false, "score": 0, "creation_date": 1525207299, "post_id": 50122981, "comment_id": 87265159, "body": "@Gofurther: I&#39;m not sure what you mean about not being anything in go&#39;s xml package. You can decode into structures, or iterate over the decoder one token at a time. The only issue might be that encoder doesn&#39;t supporting encoding back with the same namespace prefixes, and will have an <code>xmlns</code> attr for each tag."}], "tags": [], "owner": {"reputation": 25, "user_id": 7325229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21ced0dd21f15e2f06b77c43f873adc?s=128&d=identicon&r=PG&f=1", "display_name": "lextragon", "link": "https://stackoverflow.com/users/7325229/lextragon"}, "is_accepted": false, "score": -2, "last_activity_date": 1525204619, "creation_date": 1525204619, "answer_id": 50122981, "question_id": 50122863, "link": "https://stackoverflow.com/questions/50122863/modify-data-in-xml-files-using-golang/50122981#50122981", "title": "Modify data in xml files using Golang", "body": "<pre><code>&lt;cp:lastModifiedBy&gt;JerryGarcia&lt;/cp:lastModifiedBy&gt;&lt;cp:revision&gt;6&lt;/cp:revision&gt; \n</code></pre>\n\n<p>Delete TomHanks and write JerryGarcia</p>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 9458032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6069dc8ef91e7be0b48186284a1bb6da?s=128&d=identicon&r=PG&f=1", "display_name": "Gofurther", "link": "https://stackoverflow.com/users/9458032/gofurther"}, "edited": false, "score": 0, "creation_date": 1525207740, "post_id": 50123472, "comment_id": 87265329, "body": "Not able to get the cp:coreProperties because go doesn&#39;t like the colon between cp and coreProperties. I&#39;m trying to use string manipulation to get the data. Not sure if best method but I&#39;ll see what happens."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 25, "user_id": 9458032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6069dc8ef91e7be0b48186284a1bb6da?s=128&d=identicon&r=PG&f=1", "display_name": "Gofurther", "link": "https://stackoverflow.com/users/9458032/gofurther"}, "edited": false, "score": 1, "creation_date": 1525208632, "post_id": 50123472, "comment_id": 87265743, "body": "@Gofurther: you don&#39;t reference an element name with the colon, that&#39;s the separator between the namespace prefix and the actual name."}], "tags": [], "owner": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "is_accepted": false, "score": 0, "last_activity_date": 1525206971, "creation_date": 1525206971, "answer_id": 50123472, "question_id": 50122863, "link": "https://stackoverflow.com/questions/50122863/modify-data-in-xml-files-using-golang/50123472#50123472", "title": "Modify data in xml files using Golang", "body": "<p>maybe just this then (easiest thing that works) then after the replace do the xml parsing? Not sure if the TomHanks => Jerry Garcia thing is really always the same thing, or you have to parameterize this. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\n\nvar xmlRaw = `&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;\n&lt;cp:coreProperties \n xmlns:cp=\"http://schemas.openxmlformats.org/package/2006/metadata/core- \n properties\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" \n xmlns:dcterms=\"http://purl.org/dc/terms/\" \n xmlns:dcmitype=\"http://purl.org/dc/dcmitype/\" \n xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;&lt;dc:title&gt;&lt;/dc:title&gt; \n&lt;dc:subject&gt;&lt;/dc:subject&gt;&lt;dc:creator&gt;John Kerry&lt;/dc:creator&gt; \n&lt;cp:keywords&gt;&lt;/cp:keywords&gt;&lt;dc:description&gt;&lt;/dc:description&gt; \n&lt;cp:lastModifiedBy&gt;TomHanks&lt;/cp:lastModifiedBy&gt;&lt;cp:revision&gt;6&lt;/cp:revision&gt; \n&lt;dcterms:created xsi:type=\"dcterms:W3CDTF\"&gt;2018-02- \n20T18:08:00Z&lt;/dcterms:created&gt;&lt;dcterms:modified \nxsi:type=\"dcterms:W3CDTF\"&gt;2018-04-24T19:43:00Z&lt;/dcterms:modified&gt; \n&lt;/cp:coreProperties&gt;`\n\ntype decoder struct {\n\n}\n\nfunc main() {\n\n    fmt.Println(strings.Replace(xmlRaw, \"TomHanks\", \"Jerry Garcia\", 1))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/viTLElQxesM\" rel=\"nofollow noreferrer\">https://play.golang.org/p/viTLElQxesM</a></p>\n\n<p>this demonstrates the problem I was describing:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n)\n\nvar xmlRaw = []byte(`&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;\n&lt;cp:coreProperties \n xmlns:cp=\"http://schemas.openxmlformats.org/package/2006/metadata/core- \n properties\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" \n xmlns:dcterms=\"http://purl.org/dc/terms/\" \n xmlns:dcmitype=\"http://purl.org/dc/dcmitype/\" \n xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;&lt;dc:title&gt;&lt;/dc:title&gt; \n&lt;dc:subject&gt;&lt;/dc:subject&gt;&lt;dc:creator&gt;John Kerry&lt;/dc:creator&gt; \n&lt;cp:keywords&gt;&lt;/cp:keywords&gt;&lt;dc:description&gt;&lt;/dc:description&gt; \n&lt;cp:lastModifiedBy&gt;TomHanks&lt;/cp:lastModifiedBy&gt;&lt;cp:revision&gt;6&lt;/cp:revision&gt; \n&lt;dcterms:created xsi:type=\"dcterms:W3CDTF\"&gt;2018-02- \n20T18:08:00Z&lt;/dcterms:created&gt;&lt;dcterms:modified \nxsi:type=\"dcterms:W3CDTF\"&gt;2018-04-24T19:43:00Z&lt;/dcterms:modified&gt; \n&lt;/cp:coreProperties&gt;`)\n\ntype decoder struct {\n    Keywords       string `xml:\"keywords\"`\n    LastModifiedBy string `xml:\"lastModifiedBy\"`\n    //.. more xml\n}\n\nfunc main() {\n    d := decoder{}\n    if err := xml.Unmarshal(xmlRaw, &amp;d); err != nil {\n        panic(err)\n    }\n    fmt.Println(d.LastModifiedBy)\n    d.LastModifiedBy = \"Jerry Garcia\"\n    bytes, err := xml.Marshal(d)\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Println(string(bytes))\n\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/aYa01_3UE5e\" rel=\"nofollow noreferrer\">https://play.golang.org/p/aYa01_3UE5e</a></p>\n\n<p>Output: </p>\n\n<pre><code>TomHanks\n\n&lt;decoder&gt;&lt;keywords&gt;&lt;/keywords&gt;&lt;lastModifiedBy&gt;Jerry Garcia&lt;/lastModifiedBy&gt;&lt;/decoder&gt;\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9458032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6069dc8ef91e7be0b48186284a1bb6da?s=128&d=identicon&r=PG&f=1", "display_name": "Gofurther", "link": "https://stackoverflow.com/users/9458032/gofurther"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2060, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1525206971, "creation_date": 1525204144, "last_edit_date": 1525204780, "question_id": 50122863, "link": "https://stackoverflow.com/questions/50122863/modify-data-in-xml-files-using-golang", "title": "Modify data in xml files using Golang", "body": "<p>I  want to change the lastModifiedBy field from Tom Hanks to Jerry Garcia. I used this repo: <a href=\"https://github.com/clbanning/mxj/blob/master/xml.go\" rel=\"nofollow noreferrer\">https://github.com/clbanning/mxj/blob/master/xml.go</a> to parse the xml bytes into a map. However, some fields were left out. </p>\n\n<p>What's an easy way to change that field and only that field? There are hundreds of these files so I need to do it programmatically. </p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;\n&lt;cp:coreProperties \n xmlns:cp=\"http://schemas.openxmlformats.org/package/2006/metadata/core- \n properties\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" \n xmlns:dcterms=\"http://purl.org/dc/terms/\" \n xmlns:dcmitype=\"http://purl.org/dc/dcmitype/\" \n xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;&lt;dc:title&gt;&lt;/dc:title&gt; \n&lt;dc:subject&gt;&lt;/dc:subject&gt;&lt;dc:creator&gt;John Kerry&lt;/dc:creator&gt; \n&lt;cp:keywords&gt;&lt;/cp:keywords&gt;&lt;dc:description&gt;&lt;/dc:description&gt; \n&lt;cp:lastModifiedBy&gt;TomHanks&lt;/cp:lastModifiedBy&gt;&lt;cp:revision&gt;6&lt;/cp:revision&gt; \n&lt;dcterms:created xsi:type=\"dcterms:W3CDTF\"&gt;2018-02- \n20T18:08:00Z&lt;/dcterms:created&gt;&lt;dcterms:modified \nxsi:type=\"dcterms:W3CDTF\"&gt;2018-04-24T19:43:00Z&lt;/dcterms:modified&gt; \n&lt;/cp:coreProperties&gt;\n</code></pre>\n"}, {"tags": ["go", "makefile"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1525193953, "post_id": 50120427, "comment_id": 87258714, "body": "Not as part of the &#39;go test&#39; tool, but it&#39;s possible to do that with an external command."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1525203354, "post_id": 50120427, "comment_id": 87263412, "body": "You can create your own test runner using the testing package, and it has a coverage function that you can call. <a href=\"https://golang.org/pkg/testing/#Coverage\" rel=\"nofollow noreferrer\">golang.org/pkg/testing/#Coverage</a>"}], "answers": [{"comments": [{"owner": {"reputation": 699, "user_id": 1592560, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c938811f6f6afc6d9ae3f93cbe7b57b2?s=128&d=identicon&r=PG", "display_name": "Aman", "link": "https://stackoverflow.com/users/1592560/aman"}, "edited": false, "score": 2, "creation_date": 1525222462, "post_id": 50123125, "comment_id": 87269524, "body": "Awesome this works great on a package by package coverage basis. Is there way to get it to run tests all in packages so I don&#39;t have to copy TestMain() over to every package and set a coverage requirement on package basis."}, {"owner": {"reputation": 1245, "user_id": 986696, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7faEG.jpg?s=128&g=1", "display_name": "Alex Jansen", "link": "https://stackoverflow.com/users/986696/alex-jansen"}, "edited": false, "score": 0, "creation_date": 1576054560, "post_id": 50123125, "comment_id": 104770034, "body": "It seems backwards to have to write more Go code in order to support this.  Between <code>go test -cover</code> and <code>go tool cover</code> you&#39;d think there would be a simple way to get the total coverage percentage for a module from a shell."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 1245, "user_id": 986696, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7faEG.jpg?s=128&g=1", "display_name": "Alex Jansen", "link": "https://stackoverflow.com/users/986696/alex-jansen"}, "edited": false, "score": 3, "creation_date": 1576086761, "post_id": 50123125, "comment_id": 104787707, "body": "@AlexJansen sounds like a great pull request to me :)"}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 15, "last_activity_date": 1525212830, "last_edit_date": 1525212830, "creation_date": 1525205368, "answer_id": 50123125, "question_id": 50120427, "link": "https://stackoverflow.com/questions/50120427/fail-unit-tests-if-coverage-is-below-certain-percentage/50123125#50123125", "title": "fail unit tests if coverage is below certain percentage", "body": "<p>You can use <code>TestMain</code> in your test to do that. TestMain can act as a custom entry point to tests, and then you can invoke <code>testing.Coverage()</code> to get access to the coverage stats. </p>\n\n<p>So for example, if you want to fail at anything below 80%, you could add this to one of your package's test files:</p>\n\n<pre><code>func TestMain(m *testing.M) {\n    // call flag.Parse() here if TestMain uses flags\n    rc := m.Run()\n\n    // rc 0 means we've passed, \n    // and CoverMode will be non empty if run with -cover\n    if rc == 0 &amp;&amp; testing.CoverMode() != \"\" {\n        c := testing.Coverage()\n        if c &lt; 0.8 {\n            fmt.Println(\"Tests passed but coverage failed at\", c)\n            rc = -1\n        }\n    }\n    os.Exit(rc)\n}\n</code></pre>\n\n<p>Then <code>go test -cover</code> will call this entry point and you'll fail:</p>\n\n<pre><code>PASS\ncoverage: 63.0% of statements\nTests passed but coverage failed at 0.5862068965517241\nexit status 255\nFAIL    github.com/xxxx/xxx 0.026s\n</code></pre>\n\n<p>Notice that the number that <code>testing.Coverage()</code> returns is lower than what the test reports. I've looked at the code and the function calculates its coverage differently than the test's internal reporting. I'm not sure which is more \"correct\".</p>\n"}], "owner": {"reputation": 699, "user_id": 1592560, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c938811f6f6afc6d9ae3f93cbe7b57b2?s=128&d=identicon&r=PG", "display_name": "Aman", "link": "https://stackoverflow.com/users/1592560/aman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2465, "favorite_count": 4, "accepted_answer_id": 50123125, "answer_count": 1, "score": 8, "last_activity_date": 1525212830, "creation_date": 1525193174, "question_id": 50120427, "link": "https://stackoverflow.com/questions/50120427/fail-unit-tests-if-coverage-is-below-certain-percentage", "title": "fail unit tests if coverage is below certain percentage", "body": "<p>I make a makefile that executes <code>go test -cover</code>. Is it possible to fail the <code>make unit_tests</code> command if coverage is below X? How would I do that? </p>\n"}, {"tags": ["go", "hyperledger-fabric", "blockchain"], "answers": [{"tags": [], "owner": {"reputation": 75, "user_id": 2475128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be305db1ca83aa3c4ef9a0d815756cc3?s=128&d=identicon&r=PG", "display_name": "e.nikolov", "link": "https://stackoverflow.com/users/2475128/e-nikolov"}, "is_accepted": false, "score": 0, "last_activity_date": 1525196130, "creation_date": 1525196130, "answer_id": 50121097, "question_id": 50120406, "link": "https://stackoverflow.com/questions/50120406/how-to-organize-folder-structure-for-fabric-chaincode-using-library-or-utility-f/50121097#50121097", "title": "How to organize folder structure for fabric chaincode using library or utility functions?", "body": "<p>You could put all of your shared dependencies, including your own util package, in a separate repository and then vendor them via <a href=\"https://github.com/golang/dep\" rel=\"nofollow noreferrer\">dep</a>. They would still be replicated per chaincode, but it might be easier to manage them via dep ensure rather than having to manually copy them.</p>\n"}], "owner": {"reputation": 11, "user_id": 9715854, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Raj Shimpi", "link": "https://stackoverflow.com/users/9715854/raj-shimpi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1525340977, "creation_date": 1525193068, "last_edit_date": 1525340977, "question_id": 50120406, "link": "https://stackoverflow.com/questions/50120406/how-to-organize-folder-structure-for-fabric-chaincode-using-library-or-utility-f", "title": "How to organize folder structure for fabric chaincode using library or utility functions?", "body": "<p>Fabric chaincode requires separate folders for each chaincode for deployment.\nfor e.g., chaincode_1 will need to be in chaincode_1 folder with all the dependencies (vendor), util/library functions + chaincode_1.go and same for chaincode_2.</p>\n\n<p>My question is how to organize util/library folder if it has functions that i want to use it across chaincodes.  Fabric chaincode deployment does not allow it.. i think. And the util folder is replicated/redundant in each chaincode folder </p>\n"}, {"tags": ["javascript", "go"], "comments": [{"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1525187919, "post_id": 50118831, "comment_id": 87255499, "body": "What does the script in your HTML look like?"}, {"owner": {"reputation": 317, "user_id": 7221826, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a4abec0a80b101095bc8f9b8959a026f?s=128&d=identicon&r=PG&f=1", "display_name": "jj1111", "link": "https://stackoverflow.com/users/7221826/jj1111"}, "reply_to_user": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1525188352, "post_id": 50118831, "comment_id": 87255730, "body": "I just use script tags: &lt;script type=&quot;text/javascript&quot;&gt;$(function() {...})&lt;/script&gt; I&#39;m not trying to import the JS from this page because I&#39;ve tried that many times and can&#39;t get it to work"}], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 7221826, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a4abec0a80b101095bc8f9b8959a026f?s=128&d=identicon&r=PG&f=1", "display_name": "jj1111", "link": "https://stackoverflow.com/users/7221826/jj1111"}, "edited": false, "score": 0, "creation_date": 1525188298, "post_id": 50119159, "comment_id": 87255705, "body": "I&#39;ve tried this many times but I always get the error: Uncaught SyntaxError: Unexpected token &lt;. I&#39;ve tried changing the src path many ways and still cant get it to work."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 317, "user_id": 7221826, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a4abec0a80b101095bc8f9b8959a026f?s=128&d=identicon&r=PG&f=1", "display_name": "jj1111", "link": "https://stackoverflow.com/users/7221826/jj1111"}, "edited": false, "score": 0, "creation_date": 1525188442, "post_id": 50119159, "comment_id": 87255771, "body": "That error wasn&#39;t mentioned in the question... there&#39;s not enough code or context to go on to provide any more info than this. Can you update the question with enough detail to reproduce the issue?"}, {"owner": {"reputation": 317, "user_id": 7221826, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a4abec0a80b101095bc8f9b8959a026f?s=128&d=identicon&r=PG&f=1", "display_name": "jj1111", "link": "https://stackoverflow.com/users/7221826/jj1111"}, "edited": false, "score": 0, "creation_date": 1525188556, "post_id": 50119159, "comment_id": 87255824, "body": "well I ended up not trying to import the JS from the HTML, so I didn&#39;t get this error, and therefore didn&#39;t write about it. I figured I can&#39;t include JS like this because it&#39;s a golang template rendering through a servemux, but I can&#39;t say for sure. Either way, thanks for helping."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 317, "user_id": 7221826, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a4abec0a80b101095bc8f9b8959a026f?s=128&d=identicon&r=PG&f=1", "display_name": "jj1111", "link": "https://stackoverflow.com/users/7221826/jj1111"}, "edited": false, "score": 0, "creation_date": 1525188614, "post_id": 50119159, "comment_id": 87255857, "body": "This is the normal way to include an external JS file in an HTML page."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 317, "user_id": 7221826, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a4abec0a80b101095bc8f9b8959a026f?s=128&d=identicon&r=PG&f=1", "display_name": "jj1111", "link": "https://stackoverflow.com/users/7221826/jj1111"}, "edited": false, "score": 0, "creation_date": 1525188646, "post_id": 50119159, "comment_id": 87255877, "body": "Also your mention of serving <code>http.Handle(&quot;&#47;js&quot;, http.FileServer(http.Dir(&quot;static&#47;&quot;)))</code> implies that this is how you&#39;re including the JS in the page."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 317, "user_id": 7221826, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a4abec0a80b101095bc8f9b8959a026f?s=128&d=identicon&r=PG&f=1", "display_name": "jj1111", "link": "https://stackoverflow.com/users/7221826/jj1111"}, "edited": false, "score": 0, "creation_date": 1525188762, "post_id": 50119159, "comment_id": 87255950, "body": "Then <i>include that information in the question</i>, along with <i>enough detail to reproduce the issue</i>."}, {"owner": {"reputation": 317, "user_id": 7221826, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a4abec0a80b101095bc8f9b8959a026f?s=128&d=identicon&r=PG&f=1", "display_name": "jj1111", "link": "https://stackoverflow.com/users/7221826/jj1111"}, "edited": false, "score": 0, "creation_date": 1525189954, "post_id": 50119159, "comment_id": 87256585, "body": "is this better?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 317, "user_id": 7221826, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a4abec0a80b101095bc8f9b8959a026f?s=128&d=identicon&r=PG&f=1", "display_name": "jj1111", "link": "https://stackoverflow.com/users/7221826/jj1111"}, "edited": false, "score": 0, "creation_date": 1525190151, "post_id": 50119159, "comment_id": 87256692, "body": "The path in your <code>script</code> tag is wrong. You&#39;re using <code>static&#47;</code> which is the path <i>on disk</i>, but you&#39;re serving it at <code>js&#47;</code> according to your code. You&#39;re also missing the leading slash to make it an absolute path, which may or may not matter. Your example leading with &quot;I&#39;ve also tried reading the JS file&quot; produces a very strange result, but it&#39;s only a code snipped, not enough to reproduce the issue, so it&#39;s hard to say what&#39;s really happening."}, {"owner": {"reputation": 317, "user_id": 7221826, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a4abec0a80b101095bc8f9b8959a026f?s=128&d=identicon&r=PG&f=1", "display_name": "jj1111", "link": "https://stackoverflow.com/users/7221826/jj1111"}, "edited": false, "score": 0, "creation_date": 1525190627, "post_id": 50119159, "comment_id": 87256961, "body": "I&#39;ve shown my HTML code now, the go code showing /js was an example of what I tried, but not what I&#39;m doing now. In my HTML I&#39;m trying to import app.js inside of the static folder which appears to be typed correct but not working"}, {"owner": {"reputation": 317, "user_id": 7221826, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a4abec0a80b101095bc8f9b8959a026f?s=128&d=identicon&r=PG&f=1", "display_name": "jj1111", "link": "https://stackoverflow.com/users/7221826/jj1111"}, "edited": false, "score": 0, "creation_date": 1525190716, "post_id": 50119159, "comment_id": 87257017, "body": "Also it&#39;s hard to show all my code snippets here. I&#39;m not allowed to post my whole codebase."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1525190177, "last_edit_date": 1525190177, "creation_date": 1525188184, "answer_id": 50119159, "question_id": 50118831, "link": "https://stackoverflow.com/questions/50118831/golang-include-javascript-file-when-template-is-rendered/50119159#50119159", "title": "golang include javascript file when template is rendered", "body": "<p>You have to reference the script in your HTML:</p>\n\n<pre><code>&lt;html&gt;\n    &lt;head&gt;\n        &lt;script src=\"/js/app.js\"&gt;&lt;/script&gt;\n        ...\n    &lt;/head&gt;\n    &lt;body&gt;...&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Also note that in order to serve a whole directory, the path registered in the mux should have a trailing slash:</p>\n\n<pre><code>http.Handle(\"/js/\", http.FileServer(http.Dir(\"static/\")))\n</code></pre>\n"}], "owner": {"reputation": 317, "user_id": 7221826, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a4abec0a80b101095bc8f9b8959a026f?s=128&d=identicon&r=PG&f=1", "display_name": "jj1111", "link": "https://stackoverflow.com/users/7221826/jj1111"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 930, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1525190557, "creation_date": 1525186960, "last_edit_date": 1525190557, "question_id": 50118831, "link": "https://stackoverflow.com/questions/50118831/golang-include-javascript-file-when-template-is-rendered", "title": "golang include javascript file when template is rendered", "body": "<p>I've got 3 pages: index.hml, admin.html and host.html. I've got javascript on the pages inside script tags. I want to move all the javascript to one file, and have that available on each page.</p>\n\n<p>I've tried linking to the JS file from my html pages like:</p>\n\n<pre><code>&lt;script src=\"static/app.js\" type= \"text/javascript\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>but I keep getting the error: </p>\n\n<pre><code>Uncaught SyntaxError: Unexpected token &lt;\n</code></pre>\n\n<p>I've tried playing around with this src path, including moving the app.js file to the same level as the html file, and changing src to \"app.js\" but that still gives the same error message.</p>\n\n<p>This makes me think it's due to how the server is rendering the files (using a ServeMux).</p>\n\n<p>my code is:</p>\n\n<pre><code>func requestHandler(tpl *template.Template) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        tpl.Execute(w, r)\n    })\n}\n\nfunc main() {\n    flag.Parse()\n    user := template.Must(template.ParseFiles(\"index.html\"))\n    admin := template.Must(template.ParseFiles(\"admin.html\"))\n    host := template.Must(template.ParseFiles(\"host.html\"))\n    router := http.NewServeMux()\n    router.Handle(\"/\", requestHandler(user))\n    router.Handle(\"/admin\", requestHandler(admin))\n    router.Handle(\"/host\", requestHandler(host))\n    log.Fatal(http.ListenAndServe(\":8081\", router))\n}\n</code></pre>\n\n<p>I've searched SO and tried many things including:</p>\n\n<pre><code>http.Handle(\"/js\", http.FileServer(http.Dir(\"static/\")))\n</code></pre>\n\n<p>with a javascript file inside static/app.js however this just renders my index page with no JS loaded. I can't seem to get a JS file to load into the page.</p>\n\n<p>I've also tried reading the JS file, changing the content type and writing the JS file to the writer like so:</p>\n\n<pre><code>        data, err := ioutil.ReadFile(\"app.js\")\n    if err != nil {\n        fmt.Println(\"error: \", err)\n        return\n    }\n    w.Header().Add(\"Content Type\", \"application/javascript\")\n    w.Write(data)\n</code></pre>\n\n<p>however this just renders all the text to the page with the JS not running, and the text not being renderd as HTML. On the page I see:</p>\n\n<pre><code>alert(\"loaded\");&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Example&lt;/title&gt;\n</code></pre>\n\n<p>index.html header is:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Chat Example&lt;/title&gt;    \n&lt;/script&gt;\n&lt;script src=\"static/app.js\" type= \"text/javascript\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>I feel there's got to be an easier way to load the JS. This is attempt 2 with more explanation, code and examples of what I tried.</p>\n"}, {"tags": ["go", "process", "pipe", "ipc"], "comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1525190869, "post_id": 50118643, "comment_id": 87257086, "body": "It should be able to continue writing as soon as the <code>more</code> command reads more out of the pipe."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9725742, "user_type": "registered", "profile_image": "https://graph.facebook.com/1663925110350497/picture?type=large", "display_name": "Yujiro Takeda", "link": "https://stackoverflow.com/users/9725742/yujiro-takeda"}, "edited": false, "score": 0, "creation_date": 1525191782, "post_id": 50118778, "comment_id": 87257608, "body": "Thank you for your answer!  I understood why above code does not work well on Windows. And the reason  why works fine with goroutine is that it is read before pipe is full.  I tried writing 65536 bytes on Linux, then that program stopped, as you say!"}], "tags": [], "owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "is_accepted": true, "score": 7, "last_activity_date": 1525186737, "creation_date": 1525186737, "answer_id": 50118778, "question_id": 50118643, "link": "https://stackoverflow.com/questions/50118643/write-more-than-4k-bytes-to-exec-cmd-stdinpipe/50118778#50118778", "title": "Write more than 4K bytes to exec.Cmd.StdinPipe()", "body": "<p>Writing only blocks if no more space is in the pipe. While the size of the pipe in Windows might be 4k it is much larger in Linux. From <a href=\"http://man7.org/linux/man-pages/man7/pipe.7.html\" rel=\"noreferrer\">pipe(7)</a>:</p>\n\n<blockquote>\n  <p>... Since Linux\n         2.6.11, the pipe capacity is 16 pages (i.e., <strong>65,536 bytes</strong> in a system\n         with a page size of 4096 bytes)...</p>\n</blockquote>\n\n<p>Thus, you will probably get the same result on Linux as on Windows when writing into a pipe where nobody is reading but you need to write way more data into the pipe until you reach this situation.</p>\n"}, {"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1525203568, "post_id": 50120522, "comment_id": 87263506, "body": "Or rather than buffering it twice, you write it from within in a goroutine as shown in the documentation"}, {"owner": {"reputation": 15599, "user_id": 73831, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4813b578ef6e0ca5ba25a77f57fdb5f1?s=128&d=identicon&r=PG", "display_name": "Sudhir Jonathan", "link": "https://stackoverflow.com/users/73831/sudhir-jonathan"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1525242542, "post_id": 50120522, "comment_id": 87274484, "body": "Yeah, I&#39;ve used both methods. If you have a large number of writers, or if you&#39;re writing multiple times, it can be difficult to manage a goroutine per writer - writing in a goroutine can give rise to race conditions if you do that more than once quickly. At which point you need to move to a channel instead. Buffers are sometimes simpler."}], "tags": [], "owner": {"reputation": 15599, "user_id": 73831, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4813b578ef6e0ca5ba25a77f57fdb5f1?s=128&d=identicon&r=PG", "display_name": "Sudhir Jonathan", "link": "https://stackoverflow.com/users/73831/sudhir-jonathan"}, "is_accepted": false, "score": 0, "last_activity_date": 1525193609, "creation_date": 1525193609, "answer_id": 50120522, "question_id": 50118643, "link": "https://stackoverflow.com/questions/50118643/write-more-than-4k-bytes-to-exec-cmd-stdinpipe/50120522#50120522", "title": "Write more than 4K bytes to exec.Cmd.StdinPipe()", "body": "<p>This has already been answered, here's the workaround you'd probably want to use if you run into this issue - use the buffered writer instead, available in the <a href=\"https://golang.org/pkg/bufio\" rel=\"nofollow noreferrer\">bufio</a> package. This lets you wrap a writer with a larger buffer that you have full control over. </p>\n"}], "owner": {"reputation": 13, "user_id": 9725742, "user_type": "registered", "profile_image": "https://graph.facebook.com/1663925110350497/picture?type=large", "display_name": "Yujiro Takeda", "link": "https://stackoverflow.com/users/9725742/yujiro-takeda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 765, "favorite_count": 0, "accepted_answer_id": 50118778, "answer_count": 2, "score": 1, "last_activity_date": 1525193609, "creation_date": 1525186139, "last_edit_date": 1525192316, "question_id": 50118643, "link": "https://stackoverflow.com/questions/50118643/write-more-than-4k-bytes-to-exec-cmd-stdinpipe", "title": "Write more than 4K bytes to exec.Cmd.StdinPipe()", "body": "<h2>Problem</h2>\n\n<p>When writing data exceeding 4096 bytes to <code>Cmd.StdinPipe</code> in Go, program processing stops on Windows. This phenomenon does not occur when the same code running on Linux, or when writing process using goroutine.</p>\n\n<h2>Question</h2>\n\n<p>Processing will not proceed from <code>_, err = in.Write ([] byte {'0'})</code> (4097 bytes) in the code shown below. Why is this?</p>\n\n<p>Why does not it occur with goroutine or on Linux?</p>\n\n<p>*** Golang reference describes Cmd.StdinPipe using goroutine as <a href=\"https://golang.org/pkg/os/exec/#Cmd.StdinPipe\" rel=\"nofollow noreferrer\">an example</a>, and my problem has also been solved. This question arises from curiosity about Go.</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"io\"\n    \"log\"\n    \"os/exec\"\n)\n\nfunc main() {\n    cmd := exec.Command(\"more\")\n\n    pype, err := cmd.StdinPipe()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    bytes4k := generateBytes(1024 * 4) // Works on Linux, but not Windows.\n    // bytes4k := generateBytes(1024 * 64) // Don't works on Linux and Windows.\n    fmt.Println(\"bytes generated.\")\n\n    // go writeBytes(pype, bytes4k) // Works fine!\n    writeBytes(pype, bytes4k) // Can't write. Write is locked.\n\n    err = cmd.Run()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Println(\"finished.\")\n}\n\nfunc generateBytes(num int) []byte {\n    byte := bytes.NewBuffer(make([]byte, 0, num))\n    for i := 0; i &lt; num; i++ {\n        byte.WriteByte('0')\n    }\n    return byte.Bytes()\n}\n\nfunc writeBytes(in io.WriteCloser, bytes []byte) {\n    defer in.Close()\n\n    _, err := in.Write(bytes)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(\"written bytes to pipe.\")\n\n    _, err = in.Write([]byte{'0'}) // Why this code stops at 4097 bytes?\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(\"written 1 byte to pipe.\")\n}\n</code></pre>\n\n<h3>Verified versions</h3>\n\n<ul>\n<li>go version go1.10.1 windows/amd64</li>\n<li>go version go1.10.1 linux/amd64</li>\n</ul>\n"}, {"tags": ["elasticsearch", "go"], "comments": [{"owner": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "edited": false, "score": 1, "creation_date": 1525183720, "post_id": 50115928, "comment_id": 87253230, "body": "Can you get the elasticsearch document directly from the elasticsearch server with the script field in the request? (maybe using curl to hit the elasticsearch server directly) <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/2.3/modules-scripting.html\" rel=\"nofollow noreferrer\">Elasticsearch tends to frown on dynamic scripting lately.</a>"}, {"owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "edited": false, "score": 0, "creation_date": 1525193564, "post_id": 50115928, "comment_id": 87258503, "body": "What is line main.go:168 ?"}, {"owner": {"reputation": 3, "user_id": 9725270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7893b525e61b74e171a062f6ab137aa2?s=128&d=identicon&r=PG&f=1", "display_name": "N Ye", "link": "https://stackoverflow.com/users/9725270/n-ye"}, "edited": false, "score": 0, "creation_date": 1525246931, "post_id": 50115928, "comment_id": 87276700, "body": "Line 168 was: json.Unmarshal(*hit.Source, &amp;doc)"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9725270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7893b525e61b74e171a062f6ab137aa2?s=128&d=identicon&r=PG&f=1", "display_name": "N Ye", "link": "https://stackoverflow.com/users/9725270/n-ye"}, "edited": false, "score": 0, "creation_date": 1525245222, "post_id": 50128672, "comment_id": 87275789, "body": "I tried this and it got rid of the error. The response now looks like this:     {&quot;time&quot;:&quot;8&quot;,&quot;hits&quot;:&quot;2&quot;,&quot;documents&quot;:[]}  I assume the documents field is empty because if failure to unmarshall? I guess my struct is wrong?  Problem is I&#39;m not sure how the response will look like."}, {"owner": {"reputation": 1592, "user_id": 7251967, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-al-If026iHU/AAAAAAAAAAI/AAAAAAAAABE/9lsheyH-V9Q/photo.jpg?sz=128", "display_name": "negi Yogi", "link": "https://stackoverflow.com/users/7251967/negi-yogi"}, "reply_to_user": {"reputation": 3, "user_id": 9725270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7893b525e61b74e171a062f6ab137aa2?s=128&d=identicon&r=PG&f=1", "display_name": "N Ye", "link": "https://stackoverflow.com/users/9725270/n-ye"}, "edited": false, "score": 0, "creation_date": 1525253381, "post_id": 50128672, "comment_id": 87280291, "body": "can you post the elastic search response struct , and what is the type of hit.Source ?"}], "tags": [], "owner": {"reputation": 1592, "user_id": 7251967, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-al-If026iHU/AAAAAAAAAAI/AAAAAAAAABE/9lsheyH-V9Q/photo.jpg?sz=128", "display_name": "negi Yogi", "link": "https://stackoverflow.com/users/7251967/negi-yogi"}, "is_accepted": false, "score": 0, "last_activity_date": 1566286181, "last_edit_date": 1566286181, "creation_date": 1525243832, "answer_id": 50128672, "question_id": 50115928, "link": "https://stackoverflow.com/questions/50115928/using-elasticsearch-scriptfield-in-golang/50128672#50128672", "title": "Using Elasticsearch scriptfield in Golang", "body": "<p>Before doing unmarshal do nil check on hit.Source as I can see you are dereferencing hit.Source, try with this and let me know if it resolves the issue.</p>\n\n<pre><code>for _, hit := range result.Hits.Hits {\n        var doc DocumentResponse\n        if hit.Source !=nil{\n            err:=json.Unmarshal(*hit.Source, &amp;doc)\n            if err!=nil{\n                fmt.Printf(\"error unmarshal the doc ,error %+v\",err)\n                continue\n            }\n            docs = append(docs, doc)\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9725270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7893b525e61b74e171a062f6ab137aa2?s=128&d=identicon&r=PG&f=1", "display_name": "N Ye", "link": "https://stackoverflow.com/users/9725270/n-ye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 386, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1566286181, "creation_date": 1525175175, "last_edit_date": 1525179645, "question_id": 50115928, "link": "https://stackoverflow.com/questions/50115928/using-elasticsearch-scriptfield-in-golang", "title": "Using Elasticsearch scriptfield in Golang", "body": "<p>I'm trying to use a scriptfield to calculate the subtotal (hours * price) in the DocumentResponse struct. It works fine without the scriptfield.</p>\n\n<p>It's all based on this example <a href=\"https://outcrawl.com/go-elastic-search-service/\" rel=\"nofollow noreferrer\">https://outcrawl.com/go-elastic-search-service/</a></p>\n\n<p>Don't be surprised if it's a very simple mistake I'm completely new to coding.</p>\n\n<p>My guess is that something goes wrong when unmarshaling the response.</p>\n\n<p>These are the structs in question:</p>\n\n<pre><code>type DocumentResponse struct {\n    ID              string          `json:\"id\"`\n    CreatedAt       time.Time       `json:\"created_at\"`\n    Project         string          `json:\"project\"`\n    Hours           float64         `json:\"hours\"`\n    Date            string          `json:\"date\"`\n    Price           float64         `json:\"price\"`\n    Vat             float64         `json:\"vat\"`\n    Subtotal        float64         `json:\"subtotal\"`\n}                            \n\ntype SearchResponse struct {\n        Time      string             `json:\"time\"`\n        Hits      string             `json:\"hits\"`\n        Documents []DocumentResponse `json:\"documents\"`\n}\n</code></pre>\n\n<p>This is where I try to search and return the struct with the scriptfield included:</p>\n\n<pre><code>    boolQ := elastic.NewMatchAllQuery()\n\n    subtotal := elastic.NewScriptField(\"doc['subtotal'].value\", elastic.NewScript(\"doc['price'].value * doc['hours'].value\"))\n    src := elastic.NewSearchSource().Query(boolQ).ScriptFields(subtotal)\n\n    result, err := elasticClient.Search().\n            Index(elasticIndexName).\n            SearchSource(src).\n            From(skip).Size(take).\n            Do(c.Request.Context())\n    if err != nil {  \n            log.Println(err)\n            errorResponse(c, http.StatusInternalServerError, \"Something went wrong\")\n            return   \n    }\n    res := SearchResponse{\n            Time: fmt.Sprintf(\"%d\", result.TookInMillis),\n            Hits: fmt.Sprintf(\"%d\", result.Hits.TotalHits),\n    }\n    // Transform search results before returning them\n    docs := make([]DocumentResponse, 0)\n    for _, hit := range result.Hits.Hits {\n            var doc DocumentResponse\n            json.Unmarshal(*hit.Source, &amp;doc)\n            docs = append(docs, doc)\n    }\n    res.Documents = docs\n    c.JSON(http.StatusOK, res)\n}\n</code></pre>\n\n<p>Running something like this:</p>\n\n<pre><code>curl 'localhost:8080/search?start=2018-04-01&amp;end=2018-04-30&amp;project=bogus'\n</code></pre>\n\n<p>Does not return anything and generates an error:</p>\n\n<pre><code>2018/05/01 13:20:42 [Recovery] panic recovered:\nGET /search?start=2018-04-01&amp;end=2018-04-30&amp;project=bogus HTTP/1.1\nHost: localhost:8080\nAccept: */*\nUser-Agent: curl/7.59.0\nruntime error: invalid memory address or nil pointer dereference\n/usr/lib/go/src/runtime/panic.go:502 (0x42ac98)\ngopanic: reflectcall(nil, unsafe.Pointer(d.fn), deferArgs(d), \nuint32(d.siz), uint32(d.siz))\n/usr/lib/go/src/runtime/panic.go:63 (0x429d0d)\npanicmem: panic(memoryError)\n/usr/lib/go/src/runtime/signal_unix.go:388 (0x43fa49)\nsigpanic: panicmem()\n/home/niklas/go/src/git.enokinetwork.com/niklas/goest/main.go:168 \n(0x9bf56a)\nsearchEndpoint: json.Unmarshal(*hit.Source, &amp;doc)\n/home/niklas/go/src/github.com/gin-gonic/gin/context.go:110 (0x8ad492)\n(*Context).Next: c.handlers[c.index](c)\n/home/niklas/go/src/github.com/gin-gonic/gin/recovery.go:46 (0x8bd369)\nRecoveryWithWriter.func1: c.Next()\n/home/niklas/go/src/github.com/gin-gonic/gin/context.go:110 (0x8ad492)\n(*Context).Next: c.handlers[c.index](c)\n/home/niklas/go/src/github.com/gin-gonic/gin/logger.go:83 (0x8bc69b)\nLoggerWithWriter.func1: c.Next()\n/home/niklas/go/src/github.com/gin-gonic/gin/context.go:110 (0x8ad492)\n(*Context).Next: c.handlers[c.index](c)\n/home/niklas/go/src/github.com/gin-gonic/gin/gin.go:351 (0x8b4854)\n(*Engine).handleHTTPRequest: c.Next()\n/home/niklas/go/src/github.com/gin-gonic/gin/gin.go:318 (0x8b4092)\n(*Engine).ServeHTTP: engine.handleHTTPRequest(c)\n/usr/lib/go/src/net/http/server.go:2694 (0x67fc9b)\nserverHandler.ServeHTTP: handler.ServeHTTP(rw, req)\n/usr/lib/go/src/net/http/server.go:1830 (0x67be50)\n(*conn).serve: serverHandler{c.server}.ServeHTTP(w, w.req)\n/usr/lib/go/src/runtime/asm_amd64.s:2361 (0x456e70)\ngoexit: BYTE    $0x90   // NOP\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1525173822, "post_id": 50115229, "comment_id": 87248348, "body": "What is <code>mts</code>? You defined the function as taking an argument of type <code>mts</code> but in the template you don&#39;t pass it any value, why? Also to be able to call functions inside a template you first need to register those functions using the <code>FuncMap</code> provided by the template package you&#39;re using (html or text)."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1525173987, "post_id": 50115229, "comment_id": 87248408, "body": "... take a look at <a href=\"https://golang.org/pkg/text/template/#example_Template_func\" rel=\"nofollow noreferrer\">this example</a> of how to register and use functions within templates."}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1525174102, "post_id": 50115229, "comment_id": 87248452, "body": "@mkopriva - can you post it as answer what should I adopt...I need it as function"}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1525174376, "post_id": 50115229, "comment_id": 87248585, "body": "@mkopriva - and if I&#39;ve more then one function ? and what I see there is like key val"}], "answers": [{"tags": [], "owner": {"reputation": 3913, "user_id": 3710800, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b06275b7ae4d1d759875b312db2102f?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Barr&#233;", "link": "https://stackoverflow.com/users/3710800/guillaume-barr%c3%a9"}, "is_accepted": true, "score": 1, "last_activity_date": 1525331581, "last_edit_date": 1592644375, "creation_date": 1525331581, "answer_id": 50148970, "question_id": 50115229, "link": "https://stackoverflow.com/questions/50115229/using-function-instead-of-method-in-template/50148970#50148970", "title": "Using function instead of method in template", "body": "<p>As @mkopriva suggested in his first comment you just have to reference all your functions into a <code>template.FuncMap</code> where you establish the mapping from names to functions</p>\n<p>Then into the template you just need to call them passing them the <code>mts</code> as parameter.</p>\n<pre><code>package main\n\nimport (\n    &quot;log&quot;\n    &quot;os&quot;\n    &quot;text/template&quot;\n)\n\ntype mts struct {\n    Type1 string\n    Type2 string\n}\n\nfunc main() {\n    funcMap := template.FuncMap{\n        &quot;myFunc1&quot;: EchoType1,\n        &quot;myFunc2&quot;: EchoType2,\n    }\n\n    const templateText = `\nInput: {{printf &quot;%q&quot; .}}\nOutput1:{{myFunc1 .}}\nOutput2:{{myFunc2 .}}\n`\n\n    tmpl, err := template.New(&quot;myFuncTest&quot;).Funcs(funcMap).Parse(templateText)\n    if err != nil {\n        log.Fatalf(&quot;parsing: %s&quot;, err)\n    }\n\n    myMts := mts{Type1: &quot;myType1&quot;, Type2: &quot;myType2&quot;}\n    err = tmpl.Execute(os.Stdout, myMts)\n    if err != nil {\n        log.Fatalf(&quot;execution: %s&quot;, err)\n    }\n}\n\nfunc EchoType1(m mts) string {\n    return m.Type1\n}\n\nfunc EchoType2(m mts) string {\n    return m.Type2\n}\n</code></pre>\n<p>This will produce the following output :</p>\n<blockquote>\n<p>Input: {&quot;myType1&quot; &quot;myType2&quot;}</p>\n<p>Output1:myType1</p>\n<p>Output2:myType2</p>\n</blockquote>\n"}], "owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 1, "accepted_answer_id": 50148970, "answer_count": 1, "score": 0, "last_activity_date": 1525331581, "creation_date": 1525171927, "last_edit_date": 1525185191, "question_id": 50115229, "link": "https://stackoverflow.com/questions/50115229/using-function-instead-of-method-in-template", "title": "Using function instead of method in template", "body": "<p>I use the following code </p>\n\n<pre><code>var data struct {\n    File FZR\n    API  API\n}\n\n\nconst tmpl = `\n    {{- range .File.Modules}}\n     # in context of {{.Name}}\n\n        echo {{.EchoText}}\n    {{end}}`\n\nfunc  EchoText(m mts) string {\n    return m.Type\n}\n</code></pre>\n\n<p>and like this its not working, now I change it to</p>\n\n<pre><code>func (m mts) EchoText() string {\n    return m.Type\n} \n</code></pre>\n\n<p>it will work but I want to make it work with the first option, how can I do it ? \nI mean update the template ...</p>\n\n<p>update: as approva answer <a href=\"https://golang.org/pkg/text/template/#example_Template_func\" rel=\"nofollow noreferrer\">https://golang.org/pkg/text/template/#example_Template_func</a></p>\n\n<p>but there is only string, how can I register the <code>EchoText</code></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 17097, "user_id": 672689, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IPnRU.png?s=128&g=1", "display_name": "Roee Gavirel", "link": "https://stackoverflow.com/users/672689/roee-gavirel"}, "edited": false, "score": 0, "creation_date": 1525169777, "post_id": 50114749, "comment_id": 87246499, "body": "Can you provide the context of that function? More specifics the &quot;package&quot; and the &quot;imports&quot; from the top of that function file."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9528667"}, "reply_to_user": {"reputation": 17097, "user_id": 672689, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IPnRU.png?s=128&g=1", "display_name": "Roee Gavirel", "link": "https://stackoverflow.com/users/672689/roee-gavirel"}, "edited": false, "score": 1, "creation_date": 1525169914, "post_id": 50114749, "comment_id": 87246550, "body": "@RoeeGavirel - done please check"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1525171202, "post_id": 50114749, "comment_id": 87247124, "body": "If modules is defined in current package and it is not defined inside models. you cannot access it that&#39;s why the error"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9528667"}, "edited": false, "score": 0, "creation_date": 1525170385, "post_id": 50114821, "comment_id": 87246748, "body": "but I cannot add the type from this package, is there some workaround?"}, {"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 0, "creation_date": 1525171530, "post_id": 50114821, "comment_id": 87247277, "body": "@Jonneywolf None I know of."}], "tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": false, "score": 1, "last_activity_date": 1525170319, "last_edit_date": 1525170319, "creation_date": 1525169977, "answer_id": 50114821, "question_id": 50114749, "link": "https://stackoverflow.com/questions/50114749/golang-diff-type-of-functions-provide-unresolved-type/50114821#50114821", "title": "golang diff type of functions provide &quot;unresolved type\u201d", "body": "<p>You can only define method on a type within the same package. You cannot define method on type <code>Modules</code> outside package <code>models</code>.</p>\n\n<p>From <a href=\"https://golang.org/ref/spec#Method_declarations\" rel=\"nofollow noreferrer\">Go specification on Method declarations</a>:</p>\n\n<blockquote>\n  <p>The receiver is specified via an extra parameter section preceding the method name. That parameter section must declare a single non-variadic parameter, the receiver. Its type must be of the form T or *T (possibly using parentheses) where T is a type name. The type denoted by T is called the receiver base type; <strong>it must not be a pointer or interface type and it must be defined in the same package as the method</strong>. The method is said to be bound to the base type and the method name is visible only within selectors for type T or *T. </p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 0, "creation_date": 1525173403, "post_id": 50114981, "comment_id": 87248128, "body": "It is important to mention that the <code>TypeCommand</code> method will have access only to <b>exported</b> fields and methods of type <code>models.Modules</code>."}, {"owner": {"reputation": 415, "user_id": 9661066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DKIYpno_RaE/AAAAAAAAAAI/AAAAAAAAAAA/784Fv4xgNp8/photo.jpg?sz=128", "display_name": "GilesW", "link": "https://stackoverflow.com/users/9661066/gilesw"}, "reply_to_user": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 0, "creation_date": 1525173550, "post_id": 50114981, "comment_id": 87248208, "body": "@Grzegorz\u017bur - yes - I should have been clearer. I will edit the answer to reflect this. Thanks"}], "tags": [], "owner": {"reputation": 415, "user_id": 9661066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DKIYpno_RaE/AAAAAAAAAAI/AAAAAAAAAAA/784Fv4xgNp8/photo.jpg?sz=128", "display_name": "GilesW", "link": "https://stackoverflow.com/users/9661066/gilesw"}, "is_accepted": true, "score": 5, "last_activity_date": 1525173582, "last_edit_date": 1525173582, "creation_date": 1525170764, "answer_id": 50114981, "question_id": 50114749, "link": "https://stackoverflow.com/questions/50114749/golang-diff-type-of-functions-provide-unresolved-type/50114981#50114981", "title": "golang diff type of functions provide &quot;unresolved type\u201d", "body": "<p>You cannot add methods to types from outside the package in which they are defined. If you really feel it is necessary then the workaround is to define a new type which embeds the imported type and extend that. You will then have a type which includes all of the original methods as well as the new method:</p>\n\n<pre><code>import (\n   \"m5/cmd/models\"\n)\n\ntype myModule struct {\n    models.Modules\n}\n\nfunc (m myModule) TypeCommand() string {\n  // method code here\n}\n</code></pre>\n\n<p>With this example <code>myModule</code> will have all of the exported fields and methods of <code>model.Modules</code> plus the <code>TypeCommand()</code> method.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9528667"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 716, "favorite_count": 0, "accepted_answer_id": 50114981, "answer_count": 2, "score": 2, "last_activity_date": 1525173582, "creation_date": 1525169672, "last_edit_date": 1525170243, "question_id": 50114749, "link": "https://stackoverflow.com/questions/50114749/golang-diff-type-of-functions-provide-unresolved-type", "title": "golang diff type of functions provide &quot;unresolved type\u201d", "body": "<p>Im using function like following which works </p>\n\n<pre><code>import (\n   \"m5/cmd/models\"\n)\n\nfunc  TypeCommand(m Modules) string {\n\n\u2026\n\n}\n</code></pre>\n\n<p>Now I want to change </p>\n\n<pre><code>func (m models.Modules) TypeCommand() string {\n\n}\n</code></pre>\n\n<p>And now Im getting error \u201cunresolved type modules\u201d , why ? the first function is compiled ... </p>\n"}, {"tags": ["json", "go", "config"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1525157397, "post_id": 50112344, "comment_id": 87241990, "body": "If you know beforehand what the type is, e.g. you know that <code>config2.X.type</code> is <code>Y</code>, then you can just pre-allocate the correct type. If you don&#39;t know the type beforehand you can implement the <code>json.Unmarshaler</code> interface."}, {"owner": {"reputation": 873, "user_id": 4509355, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/31648f80ef66006febaecde7c76b7319?s=128&d=identicon&r=PG&f=1", "display_name": "Nishant Roy", "link": "https://stackoverflow.com/users/4509355/nishant-roy"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1525158635, "post_id": 50112344, "comment_id": 87242403, "body": "Don&#39;t know the type beforehand. You can&#39;t implement <code>Unmarshaler</code> on an interface, isn&#39;t it? Or are you saying to implement <code>Unmarshal</code> for <code>type Config</code> and custom assign ALL fields in the struct (there&#39;s more than just <code>interfaceInstance</code>)"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1525159342, "post_id": 50112344, "comment_id": 87242649, "body": "Yes, implement <code>Unmarshaler</code> for <code>Config</code> type, and yes, based on the value of the <code>&quot;type&quot;</code> key you&#39;ll have to pre-allocate however many <code>interfaceInstance</code> fields you have. If you use interface fields the <code>encoding&#47;json</code> decoder has no way of knowing what type you want there. If that&#39;s too inconvenient try rethinking the design of your config file or Config type."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1525159566, "post_id": 50112344, "comment_id": 87242727, "body": "... btw don&#39;t use field names starting with lowercase (<code>interfaceInstance</code>) if you want to encode/decode them. User defined symbols that start with a lowercase letter are unexported. Change it to <code>InterfaceInstance</code>"}], "answers": [{"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 0, "last_activity_date": 1538433551, "creation_date": 1538433551, "answer_id": 52599819, "question_id": 50112344, "link": "https://stackoverflow.com/questions/50112344/custom-config-loading-in-go/52599819#52599819", "title": "Custom config loading in Go", "body": "<p>One possible strategy would be to implement <code>json.Unmarshaler</code> for the <code>Config</code> type in such a way that you first unmarshal into a generic object and inspect the \"type\" attribute then, switching on the type string, unmarshal the same byte array into the known type and assign to the \"interfaceInstance\" member of the config.</p>\n\n<p>For example (<a href=\"https://play.golang.com/p/04jtRt4fyo7\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>// Note the slightly different JSON here...\nvar jsonstr = `{\n  \"config1\": {\n    \"type\": \"Z\",\n    \"Value\": \"value_1\"\n  },\n  \"config2\": {\n    \"type\": \"Y\",\n    \"Value\": \"value_2\"\n  }\n}`\n\nfunc main() {\n  config := map[string]Config{}\n  err := json.Unmarshal([]byte(jsonstr), &amp;config)\n  if err != nil {\n    panic(err)\n  }\n\n  fmt.Printf(\"OK: %#v\\n\", config)\n  // OK: map[string]main.Config{\n  //   \"config1\": main.Config{interfaceInstance:main.Z{Value:\"value_1\"}},\n  //   \"config2\": main.Config{interfaceInstance:main.Y{Value:\"value_2\"}},\n  // }\n}\n\nfunc (c *Config) UnmarshalJSON(bs []byte) error {\n  // Unmarshal into an object to inspect the type.\n  var obj map[string]interface{}\n  err := json.Unmarshal(bs, &amp;obj)\n  if err != nil {\n    return err\n  }\n\n  // Unmarshal again into the target type.\n  configType := obj[\"type\"].(string)\n  switch configType {\n  case \"Y\":\n    var y Y\n    if err = json.Unmarshal(bs, &amp;y); err == nil {\n      c.interfaceInstance = y\n    }\n  case \"Z\":\n    var z Z\n    if err = json.Unmarshal(bs, &amp;z); err == nil {\n      c.interfaceInstance = z\n    }\n  default:\n    return fmt.Errorf(\"unexpected type %q\", configType)\n  }\n  return err\n}\n</code></pre>\n"}], "owner": {"reputation": 873, "user_id": 4509355, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/31648f80ef66006febaecde7c76b7319?s=128&d=identicon&r=PG&f=1", "display_name": "Nishant Roy", "link": "https://stackoverflow.com/users/4509355/nishant-roy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1538433551, "creation_date": 1525156879, "question_id": 50112344, "link": "https://stackoverflow.com/questions/50112344/custom-config-loading-in-go", "title": "Custom config loading in Go", "body": "<p>I'm using JSON files to store/load my config. Let's say I have the following:</p>\n\n<pre><code>type X interface\n\n// implements interface X\ntype Y struct {\n    Value string\n}\n\n// implements interface X\ntype Z struct {\n    Value string\n}\n\ntype Config struct {\n    interfaceInstance X `json:\"X\"`\n}\n</code></pre>\n\n<p>Config file example:</p>\n\n<pre><code>{\n  \"config1\": {\n    \"X\": {\n      \"type\": \"Z\",\n      \"Value\": \"value_1\"\n    }\n  },\n\n\n  \"config2\": {\n    \"X\": {\n      \"type\": \"Y\",\n      \"Value\": \"value_2\"\n    }\n  }\n}\n</code></pre>\n\n<p>I want to be able to define config files something like this example, and be able to dynamically load the JSON as either struct <code>Y</code> or struct <code>Z</code>. Any suggestions on how to accomplish this? I'm using a simple <code>json.Decoder</code> to load the JSON as a struct.</p>\n\n<pre><code>decoder := json.NewDecoder(file)\nerr = decoder.Decode(&amp;config)\n</code></pre>\n"}, {"tags": ["go", "arm64"], "answers": [{"comments": [{"owner": {"reputation": 1917, "user_id": 6401895, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e169f96fa9c3c6a770dd828e3319263a?s=128&d=identicon&r=PG", "display_name": "Ivan Beldad", "link": "https://stackoverflow.com/users/6401895/ivan-beldad"}, "edited": false, "score": 0, "creation_date": 1525149037, "post_id": 50111052, "comment_id": 87239903, "body": "There is no problem at all with the release 1.9.5. Tested and working (without external libraries). Maybe that is the problem, but not go."}, {"owner": {"reputation": 1236, "user_id": 1176186, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/53a18d1ae5c3fe32415d91df159399bc?s=128&d=identicon&r=PG&f=1", "display_name": "thinkski", "link": "https://stackoverflow.com/users/1176186/thinkski"}, "reply_to_user": {"reputation": 1917, "user_id": 6401895, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e169f96fa9c3c6a770dd828e3319263a?s=128&d=identicon&r=PG", "display_name": "Ivan Beldad", "link": "https://stackoverflow.com/users/6401895/ivan-beldad"}, "edited": false, "score": 0, "creation_date": 1525150528, "post_id": 50111052, "comment_id": 87240201, "body": "Which architecture and device did you test on? The above code (even using <code>http.NewServeMux()</code> instead of gorilla) when compiled with <a href=\"https://dl.google.com/go/go1.10.1.linux-arm64.tar.gz\" rel=\"nofollow noreferrer\">dl.google.com/go/go1.10.1.linux-arm64.tar.gz</a>, works as expected, but when compiled with <a href=\"https://dl.google.com/go/go1.9.5.linux-arm64.tar.gz\" rel=\"nofollow noreferrer\">dl.google.com/go/go1.9.5.linux-arm64.tar.gz</a>, exhibits the corruption described above."}, {"owner": {"reputation": 1917, "user_id": 6401895, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e169f96fa9c3c6a770dd828e3319263a?s=128&d=identicon&r=PG", "display_name": "Ivan Beldad", "link": "https://stackoverflow.com/users/6401895/ivan-beldad"}, "edited": false, "score": 0, "creation_date": 1525153565, "post_id": 50111052, "comment_id": 87240894, "body": "Debian stretch, <a href=\"https://github.com/docker-library/golang/blob/97535d47a7c8312b25fc98418771f943c0bbdfb3/1.9/stretch/Dockerfile\" rel=\"nofollow noreferrer\">containerized</a>. Works with no problem."}, {"owner": {"reputation": 1236, "user_id": 1176186, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/53a18d1ae5c3fe32415d91df159399bc?s=128&d=identicon&r=PG&f=1", "display_name": "thinkski", "link": "https://stackoverflow.com/users/1176186/thinkski"}, "reply_to_user": {"reputation": 1917, "user_id": 6401895, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e169f96fa9c3c6a770dd828e3319263a?s=128&d=identicon&r=PG", "display_name": "Ivan Beldad", "link": "https://stackoverflow.com/users/6401895/ivan-beldad"}, "edited": false, "score": 0, "creation_date": 1525155162, "post_id": 50111052, "comment_id": 87241310, "body": "I mean architecture as in are you running on arm64 (not amd64)? I suspect this only affects arm64."}], "tags": [], "owner": {"reputation": 1236, "user_id": 1176186, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/53a18d1ae5c3fe32415d91df159399bc?s=128&d=identicon&r=PG&f=1", "display_name": "thinkski", "link": "https://stackoverflow.com/users/1176186/thinkski"}, "is_accepted": true, "score": -2, "last_activity_date": 1525145935, "creation_date": 1525145935, "answer_id": 50111052, "question_id": 50110651, "link": "https://stackoverflow.com/questions/50110651/go-server-returns-corrupt-image-on-arm64/50111052#50111052", "title": "Go server returns corrupt image on arm64", "body": "<p>Looks like it was an issue with the go1.9.5 release. Updated toolchain to go1.10.1 and the issue disappeared.</p>\n"}], "owner": {"reputation": 1236, "user_id": 1176186, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/53a18d1ae5c3fe32415d91df159399bc?s=128&d=identicon&r=PG&f=1", "display_name": "thinkski", "link": "https://stackoverflow.com/users/1176186/thinkski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 50111052, "answer_count": 1, "score": -1, "last_activity_date": 1525150753, "creation_date": 1525141630, "last_edit_date": 1525150753, "question_id": 50110651, "link": "https://stackoverflow.com/questions/50110651/go-server-returns-corrupt-image-on-arm64", "title": "Go server returns corrupt image on arm64", "body": "<p>I've written a simple HTTP image server:</p>\n\n<p>go/src/demo/demo.go:</p>\n\n<pre><code>package main\n\nimport (\n  \"net/http\"\n  \"github.com/gorilla/mux\"\n)\n\nfunc main() {\n  router := mux.NewRouter()\n  router.HandleFunc(\"/foobar\", func(w http.ResponseWriter, r *http.Request) {\n    http.ServeFile(w, r, \"/home/foobar/test.jpg\")\n  })\n\n  http.ListenAndServe(\":5000\", router)\n}\n</code></pre>\n\n<p>I compile it (PWD=$HOME/go/src/demo):</p>\n\n<pre><code>GOPATH=$PWD/../../ go build -o demo\n</code></pre>\n\n<p>And run:</p>\n\n<pre><code>./demo\n</code></pre>\n\n<p>Then in Chrome I open the URL. The image is corrupt -- reloading produces different corruption each time, once in a while it is fine. Larger images (~200KB) fail more often, smaller images (~20KB) fail less often.</p>\n\n<p>Additional details:</p>\n\n<p><code>go version</code> produces <code>go version go1.9.5 linux/arm64</code>.</p>\n\n<p>On my Macbook, this causes no issues -- only occurs on arm64 (looks like ResponseWriter does not implement flushing). I'm at a loss. Any ideas?</p>\n"}, {"tags": ["go", "types", "format"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1525136163, "post_id": 50110054, "comment_id": 87237468, "body": "Fractional binary like <code>110100.0</code> or the actual floating-point bits?"}, {"owner": {"reputation": 754, "user_id": 5875023, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yuu7yj0AUW8/AAAAAAAAAAI/AAAAAAAAABI/bEOwyZSpqyU/photo.jpg?sz=128", "display_name": "Simon", "link": "https://stackoverflow.com/users/5875023/simon"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1525136459, "post_id": 50110054, "comment_id": 87237527, "body": "@Ry I was looking for the floating-point representation, but it could be a good idea to show how to get the fractional binary too."}], "answers": [{"comments": [{"owner": {"reputation": 754, "user_id": 5875023, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yuu7yj0AUW8/AAAAAAAAAAI/AAAAAAAAABI/bEOwyZSpqyU/photo.jpg?sz=128", "display_name": "Simon", "link": "https://stackoverflow.com/users/5875023/simon"}, "edited": false, "score": 0, "creation_date": 1525136872, "post_id": 50110074, "comment_id": 87237612, "body": "Thank you! And for those who also need to get a float from the representation, the math package provides us with <code>math.Float32frombits</code> and <code>math.Float64frombits</code>."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 9, "last_activity_date": 1525135895, "creation_date": 1525135895, "answer_id": 50110074, "question_id": 50110054, "link": "https://stackoverflow.com/questions/50110054/how-to-print-the-binary-representation-of-a-float-in-go/50110074#50110074", "title": "How to print the binary representation of a float in Go?", "body": "<p>You can get the raw bits of a float with the <code>math</code> package using <a href=\"https://golang.org/pkg/math/#Float64bits\" rel=\"noreferrer\"><code>math.Float64bits</code></a> or <a href=\"https://golang.org/pkg/math/#Float32bits\" rel=\"noreferrer\"><code>math.Float32bits</code></a>. Combining this with the <code>%b</code> formatting verb will display the binary representation of the float.</p>\n\n<pre><code>fmt.Printf(\"%b\\n\", math.Float64bits(52.0))\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/oJKMqhsLdOA\" rel=\"noreferrer\">https://play.golang.org/p/oJKMqhsLdOA</a></p>\n"}], "owner": {"reputation": 754, "user_id": 5875023, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yuu7yj0AUW8/AAAAAAAAAAI/AAAAAAAAABI/bEOwyZSpqyU/photo.jpg?sz=128", "display_name": "Simon", "link": "https://stackoverflow.com/users/5875023/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1037, "favorite_count": 0, "accepted_answer_id": 50110074, "answer_count": 1, "score": 2, "last_activity_date": 1525135895, "creation_date": 1525135663, "question_id": 50110054, "link": "https://stackoverflow.com/questions/50110054/how-to-print-the-binary-representation-of-a-float-in-go", "title": "How to print the binary representation of a float in Go?", "body": "<p>The fmt package allows us to print a binary representation of integers with %b. How to get an equivalent result for floats instead of the scientific notation?</p>\n\n<pre><code>fmt.Printf(\"%b\", 52) // 110100\nfmt.Printf(\"%b\", 52.0) // 7318349394477056p-47\n</code></pre>\n"}, {"tags": ["go", "networking", "udp", "ip"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1525130877, "post_id": 50109485, "comment_id": 87236283, "body": "UDP doesn&#39;t have a TTL, that is part of the IP protocol. Have you tried to use lower level packages like <a href=\"https://godoc.org/golang.org/x/net/ipv4\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/net/ipv4</a> or <a href=\"https://github.com/google/gopacket\" rel=\"nofollow noreferrer\">github.com/google/gopacket</a>?"}, {"owner": {"reputation": 51, "user_id": 9700739, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brash Man", "link": "https://stackoverflow.com/users/9700739/brash-man"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1525135593, "post_id": 50109485, "comment_id": 87237384, "body": "Yes, I&#39;ve used both, I&#39;ve tried using a packetConn from ipv4 but the ip header is still stripped away before I receive a message.  I cannot figure out how to use the RawConn correctly, if you could show me how to use a RawConn to send/receive UDP messages that would be very helpful."}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 9550210, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-q4XLQO1ndG4/AAAAAAAAAAI/AAAAAAAAAIc/Ht-xe9wcfso/photo.jpg?sz=128", "display_name": "Skyyang Ren", "link": "https://stackoverflow.com/users/9550210/skyyang-ren"}, "is_accepted": false, "score": 1, "last_activity_date": 1587417928, "last_edit_date": 1587417928, "creation_date": 1587417627, "answer_id": 61332236, "question_id": 50109485, "link": "https://stackoverflow.com/questions/50109485/getting-incoming-ttl-in-go/61332236#61332236", "title": "Getting incoming TTL in GO", "body": "<p>Set TTL:</p>\n\n<pre><code>var conn *icmp.PacketConn\n\n// for IPv4\nconn.IPv4PacketConn().SetTTL(p.ttl) \nconn.IPv4PacketConn().SetControlMessage(ipv4.FlagTTL, true)\n\n// for IPv6\nconn.IPv6PacketConn().SetHopLimit(p.ttl) \nconn.IPv6PacketConn().SetControlMessage(ipv6.FlagHopLimit, true)\n</code></pre>\n\n<p>Recieve TTL:</p>\n\n<pre><code>    var ttl, n int\n    bytes := make([]byte, 512)\n    if IPv4 {\n        var cm *ipv4.ControlMessage\n        n, cm, _, err = conn.IPv4PacketConn().ReadFrom(bytes)\n        if cm != nil {\n            ttl = cm.TTL\n        }\n    } else {\n        var cm *ipv6.ControlMessage\n        n, cm, _, err = conn.IPv6PacketConn().ReadFrom(bytes)\n        if cm != nil {\n            ttl = cm.HopLimit\n        }\n    }\n\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 9700739, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brash Man", "link": "https://stackoverflow.com/users/9700739/brash-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 537, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1587417928, "creation_date": 1525130608, "last_edit_date": 1525196268, "question_id": 50109485, "link": "https://stackoverflow.com/questions/50109485/getting-incoming-ttl-in-go", "title": "Getting incoming TTL in GO", "body": "<p>I'm struggling with a small project I am working on.  I want to implement functionality in GO that allows me to set the IP header TTL on an outgoing UDP packet that I then send and view the received TTL on the other end.  I have a tried using a number of connections provided by the 'net' library and have so far had no success (I can set the TTL but I can't read it).  Can anyone suggest a way of sending and receiving UDP packets that provide access to the packet's TTL field?</p>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "edited": false, "score": 2, "creation_date": 1525121317, "post_id": 50107950, "comment_id": 87233265, "body": "you could probably use <code>json.Compact</code> to remove the extra whitespace"}, {"owner": {"reputation": 863, "user_id": 5849285, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UwK2I.jpg?s=128&g=1", "display_name": "Charles Shiller", "link": "https://stackoverflow.com/users/5849285/charles-shiller"}, "edited": false, "score": 1, "creation_date": 1525127076, "post_id": 50107950, "comment_id": 87235323, "body": "I thought the OP asked &quot;how to detect the duplicate attribute&quot;, not &quot;how to detect <b>if there is</b> the duplicate attribute&quot;"}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": false, "score": 1, "last_activity_date": 1525121068, "creation_date": 1525121068, "answer_id": 50107950, "question_id": 50107569, "link": "https://stackoverflow.com/questions/50107569/detect-duplicate-in-json-string-golang/50107950#50107950", "title": "detect duplicate in JSON String Golang", "body": "<p>One that would probably work well would be to simply decode, reencode, then check the length of the new json against the old json:</p>\n\n<p><a href=\"https://play.golang.org/p/50P-x1fxCzp\" rel=\"nofollow noreferrer\">https://play.golang.org/p/50P-x1fxCzp</a>   </p>\n\n<pre><code>package main\n\nimport (\n  \"encoding/json\"\n  \"fmt\"\n)\n\nfunc main() {\n  jsn := []byte(\"{\\\"a\\\": \\\"b\\\", \\\"a\\\":true,\\\"c\\\":[\\\"field_3 string 1\\\",\\\"field3 string2\\\"]}\")\n  var m map[string]interface{}\n  err := json.Unmarshal(jsn, &amp;m)\n  if err != nil {\n      panic(err)\n  }\n        l := len(jsn)\n        jsn, err = json.Marshal(m)\n  if err != nil {\n      panic(err)\n  }\n  if l != len(jsn) {\n      panic(fmt.Sprintf(\"%s: %d (%d)\", \"duplicate key\", l, len(jsn)))\n  }\n}\n</code></pre>\n\n<p>The right way to do it would be to re-implement the <code>json.Decode</code> function, and store a map of keys found, but the above should work (especially if you first stripped any spaces from the json using <code>jsn = bytes.Replace(jsn, []byte(\" \"), []byte(\"\"), -1)</code> to guard against false positives.</p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 8, "last_activity_date": 1525129567, "creation_date": 1525129567, "answer_id": 50109335, "question_id": 50107569, "link": "https://stackoverflow.com/questions/50107569/detect-duplicate-in-json-string-golang/50109335#50109335", "title": "detect duplicate in JSON String Golang", "body": "<p>Use the <a href=\"https://godoc.org/encoding/json#Decoder\" rel=\"noreferrer\">json.Decoder</a> to walk through the JSON. When an object is found, walk through keys and values checking for duplicate keys.</p>\n\n<pre><code>func check(d *json.Decoder, path []string) error {\n    // Get next token from JSON\n    t, err := d.Token()\n    if err != nil {\n        return err\n    }\n\n    delim, ok := t.(json.Delim)\n\n    // There's nothing to do for simple values (strings, numbers, bool, nil)\n    if !ok {\n        return nil\n    }\n\n    switch delim {\n    case '{':\n        keys := make(map[string]bool)\n        for d.More() {\n            // Get field key\n            t, err := d.Token()\n            if err != nil {\n                return err\n            }\n            key := t.(string)\n\n            // Check for duplicates\n            if keys[key] {\n                fmt.Printf(\"Duplicate %s\\n\", strings.Join(append(path, key), \"/\"))\n            }\n            keys[key] = true\n\n            // Check value\n            if err := check(d, append(path, key)); err != nil {\n                return err\n            }\n        }\n        // Consume trailing }\n        if _, err := d.Token(); err != nil {\n            return err\n        }\n\n    case '[':\n        i := 0\n        for d.More() {\n            if err := check(d, append(path, strconv.Itoa(i))); err != nil {\n                return err\n            }\n            i++\n        }\n        // Consume trailing ]\n        if _, err := d.Token(); err != nil {\n            return err\n        }\n\n    }\n    return nil\n}\n</code></pre>\n\n<p>Here's how to call it:</p>\n\n<pre><code>data := `{\"a\": \"b\", \"a\":true,\"c\":[\"field_3 string 1\",\"field3 string2\"], \"d\": {\"e\": 1, \"e\": 2}}`\nif err := check(json.NewDecoder(strings.NewReader(data)), nil); err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>Duplicate a\nDuplicate d/e\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/K0cb7hzc6P6\" rel=\"noreferrer\">Run it on the Playground</a></p>\n"}], "owner": {"reputation": 759, "user_id": 5112445, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1001121649919771/picture?type=large", "display_name": "Summer Ji", "link": "https://stackoverflow.com/users/5112445/summer-ji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1482, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1525129567, "creation_date": 1525119186, "last_edit_date": 1525120096, "question_id": 50107569, "link": "https://stackoverflow.com/questions/50107569/detect-duplicate-in-json-string-golang", "title": "detect duplicate in JSON String Golang", "body": "<p>I have JSON string like </p>\n\n<pre><code>\"{\\\"a\\\": \\\"b\\\", \\\"a\\\":true,\\\"c\\\":[\\\"field_3 string 1\\\",\\\"field3 string2\\\"]}\"\n</code></pre>\n\n<p>how to detect the duplicate attribute in this json string using Golang</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 4945, "user_id": 1561929, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/42466d208f3eb0adedc4cebdba1970f8?s=128&d=identicon&r=PG", "display_name": "Alex Harris", "link": "https://stackoverflow.com/users/1561929/alex-harris"}, "is_accepted": true, "score": 5, "last_activity_date": 1525119047, "creation_date": 1525119047, "answer_id": 50107535, "question_id": 50107493, "link": "https://stackoverflow.com/questions/50107493/golang-string-formatting-gives-unexpected-spacing/50107535#50107535", "title": "Golang string formatting gives unexpected spacing", "body": "<p><code>%2.f</code> is giving a default width of 2. You can try just <code>%f</code>.</p>\n\n<blockquote>\n  <p>Width is specified by an optional decimal number immediately preceding\n  the verb. If absent, the width is whatever is necessary to represent\n  the value. Precision is specified after the (optional) width by a\n  period followed by a decimal number. If no period is present, a\n  default precision is used. A period with no following number specifies\n  a precision of zero. Examples:</p>\n</blockquote>\n\n<pre><code>%f     default width, default precision\n%9f    width 9, default precision\n%.2f   default width, precision 2\n%9.2f  width 9, precision 2\n%9.f   width 9, precision 0\n</code></pre>\n\n<p>You can read the documentation <a href=\"https://golang.org/pkg/fmt/\" rel=\"noreferrer\">here.</a></p>\n"}], "owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 50107535, "answer_count": 1, "score": 0, "last_activity_date": 1525119047, "creation_date": 1525118841, "question_id": 50107493, "link": "https://stackoverflow.com/questions/50107493/golang-string-formatting-gives-unexpected-spacing", "title": "Golang string formatting gives unexpected spacing", "body": "<p>I have a line of code that looks like this:</p>\n\n<pre><code>fmt.Printf(\"Total Calories: %2.f (%2.f%%)\\n\", item.calorie.TotalCalories, item.calorie.TotalCalories/dailyCalorie*100)\n</code></pre>\n\n<p>It is supposed to output:</p>\n\n<pre><code>Total Calories: 150 (5%)\n</code></pre>\n\n<p>But instead I get a spacing between the start of the paranthesis and the number 5, like this:</p>\n\n<pre><code>Total Calories: 150 ( 5%)\n</code></pre>\n\n<p>I don't understand where I went wrong.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1525115360, "post_id": 50106666, "comment_id": 87230688, "body": "See <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"nofollow noreferrer\">&quot;Composite Literals&quot; in the specification</a>"}], "tags": [], "owner": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "is_accepted": true, "score": 4, "last_activity_date": 1525115069, "creation_date": 1525115069, "answer_id": 50106666, "question_id": 50106626, "link": "https://stackoverflow.com/questions/50106626/what-is-the-meaning-of-in-a-slice-variable-initializer-in-golang/50106666#50106666", "title": "What is the meaning of [...] in a (slice) variable initializer in golang?", "body": "<p>Ok, as I should have done, I put this in the playground, initialized the variable, then called <code>fmt.Printf(\"%T\", stateNames)</code>, and got <code>[25]string</code></p>\n\n<p><a href=\"https://play.golang.org/p/3k-WiI8Jh9K\" rel=\"nofollow noreferrer\">https://play.golang.org/p/3k-WiI8Jh9K</a></p>\n\n<p>Turns out, this defines an array, not a slice, and the array is initialized with the length automatically set to the number of items defined. Neat!</p>\n"}], "owner": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 50106666, "answer_count": 1, "score": 1, "last_activity_date": 1525115069, "creation_date": 1525114858, "question_id": 50106626, "link": "https://stackoverflow.com/questions/50106626/what-is-the-meaning-of-in-a-slice-variable-initializer-in-golang", "title": "What is the meaning of [...] in a (slice) variable initializer in golang?", "body": "<p>I was browsing the stdlib, specifically <a href=\"https://golang.org/src/html/template/context.go\" rel=\"nofollow noreferrer\">https://golang.org/src/html/template/context.go</a> and I came across this code, which is tasked with making string representations of a uint8 enum defined previously. </p>\n\n<pre><code>var stateNames = [...]string{\n    stateText:        \"stateText\",\n    stateTag:         \"stateTag\",\n//... many more elided \n    stateCSSBlockCmt: \"stateCSSBlockCmt\",\n    stateCSSLineCmt:  \"stateCSSLineCmt\",\n    stateError:       \"stateError\",\n  }\n</code></pre>\n\n<p>I was interested in the [...] syntax of the initializer. Is there something that means more than a simple <code>var stateNames = []string{}</code> in that syntax? </p>\n"}, {"tags": ["go", "visual-studio-code"], "comments": [{"owner": {"reputation": 745, "user_id": 6121503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3841cbbb3e44f35e7b0466a35cc887d?s=128&d=identicon&r=PG&f=1", "display_name": "rickjerrity", "link": "https://stackoverflow.com/users/6121503/rickjerrity"}, "edited": false, "score": 2, "creation_date": 1525112486, "post_id": 50106026, "comment_id": 87229405, "body": "Your package path or GOROOT/GOPATH environment variables look misconfigured. Look at the package that is trying to be loaded: <code>_&#47;d_&#47;Work&#47;src</code> and it is looking for that package inside of: <code>D:\\go\\src\\_\\d_\\Work\\src</code>. You should really be posting code snippets instead of images as well"}, {"owner": {"reputation": 21, "user_id": 6896932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94de2227f4f5b1b4ff2f62bc839d06ab?s=128&d=identicon&r=PG&f=1", "display_name": "DreamWalker_1989", "link": "https://stackoverflow.com/users/6896932/dreamwalker-1989"}, "reply_to_user": {"reputation": 745, "user_id": 6121503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3841cbbb3e44f35e7b0466a35cc887d?s=128&d=identicon&r=PG&f=1", "display_name": "rickjerrity", "link": "https://stackoverflow.com/users/6121503/rickjerrity"}, "edited": false, "score": 0, "creation_date": 1525113092, "post_id": 50106026, "comment_id": 87229680, "body": "@rickjerrity I checked my Go env ,  I haven&#39;t found the issue.Is there any mistake?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1525113364, "post_id": 50106026, "comment_id": 87229804, "body": "Is your <code>helloworld.go</code> in a proper package directory in GOPATH? (also, please stop pasting pictures of text)"}, {"owner": {"reputation": 21, "user_id": 6896932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94de2227f4f5b1b4ff2f62bc839d06ab?s=128&d=identicon&r=PG&f=1", "display_name": "DreamWalker_1989", "link": "https://stackoverflow.com/users/6896932/dreamwalker-1989"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1525113804, "post_id": 50106026, "comment_id": 87229985, "body": "@JimB  Yes, the helloworld.go is path $GOPATH/src/"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1525113853, "post_id": 50106026, "comment_id": 87230000, "body": "@DreamWalker_1989: that is not a valid location. Create a package directory in <code>src&#47;</code> and try there."}, {"owner": {"reputation": 21, "user_id": 6896932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94de2227f4f5b1b4ff2f62bc839d06ab?s=128&d=identicon&r=PG&f=1", "display_name": "DreamWalker_1989", "link": "https://stackoverflow.com/users/6896932/dreamwalker-1989"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1525114328, "post_id": 50106026, "comment_id": 87230230, "body": "@JimB Thanks.I have tried it.But the console still shows that go build xxx: build out &quot;xx\\\\go-code-check&quot; already exists and is not an object file.DO you know what&#39;s it means?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1525115261, "post_id": 50106026, "comment_id": 87230638, "body": "Something is trying to build the file <code>go-code-check</code>, which already exists (though I haven&#39;t seen that error in years, do possibly have multiple version of Go installed?). If it&#39;s a temp file, you can probably remove it. The fact that you have GOPATH set to <code>D:\\Work</code>, but the error thinks the package should be in <code>D:\\Work\\src\\_\\d_\\Work\\src</code> looks like a problem too."}, {"owner": {"reputation": 21, "user_id": 6896932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94de2227f4f5b1b4ff2f62bc839d06ab?s=128&d=identicon&r=PG&f=1", "display_name": "DreamWalker_1989", "link": "https://stackoverflow.com/users/6896932/dreamwalker-1989"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1525115725, "post_id": 50106026, "comment_id": 87230844, "body": "@JimB I have more than 100 error prompts to show that &quot; build out &quot;xx\\\\go-code-check&quot; already exists and is not an object file &quot;. I have tried to remove it, but it doesn&#39;t work.There was a 1.7 version of GO before, and I had uninstalled it then installed 1.10 version."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 6896932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94de2227f4f5b1b4ff2f62bc839d06ab?s=128&d=identicon&r=PG&f=1", "display_name": "DreamWalker_1989", "link": "https://stackoverflow.com/users/6896932/dreamwalker-1989"}, "is_accepted": false, "score": 1, "last_activity_date": 1525350135, "creation_date": 1525350135, "answer_id": 50155004, "question_id": 50106026, "link": "https://stackoverflow.com/questions/50106026/how-to-fix-the-error-when-used-golang-vscode/50155004#50155004", "title": "How to fix the error when used golang + vscode", "body": "<p>Finally, I found the solution.\nYou can open the user's settings.json file in the visual code , then</p>\n\n<pre><code>set \"go.buildOnSave\": true,\nset \"go.lintOnSave\": true,\nset \"go.vetOnsave\":false\n</code></pre>\n\n<p>I hope it can help you </p>\n"}], "owner": {"reputation": 21, "user_id": 6896932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94de2227f4f5b1b4ff2f62bc839d06ab?s=128&d=identicon&r=PG&f=1", "display_name": "DreamWalker_1989", "link": "https://stackoverflow.com/users/6896932/dreamwalker-1989"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 619, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1609335830, "creation_date": 1525112143, "last_edit_date": 1525112962, "question_id": 50106026, "link": "https://stackoverflow.com/questions/50106026/how-to-fix-the-error-when-used-golang-vscode", "title": "How to fix the error when used golang + vscode", "body": "<p>enter image description hereI wish to use the vscode to type golang,\nso I set both, then I added the go plugins in vscode,\nbut it shows these error, I don't know how to fix it.\nIs there any knows it?</p>\n\n<p><a href=\"https://i.stack.imgur.com/VOQQv.jpg\" rel=\"nofollow noreferrer\">Error</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/JN88x.png\" rel=\"nofollow noreferrer\">plugins</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/NCSRA.png\" rel=\"nofollow noreferrer\">setting.json</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/OhreL.png\" rel=\"nofollow noreferrer\">go env</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 14633, "user_id": 5069957, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/597577c2765adaa190e4524d3a3860fe?s=128&d=identicon&r=PG&f=1", "display_name": "edkeveked", "link": "https://stackoverflow.com/users/5069957/edkeveked"}, "edited": false, "score": 0, "creation_date": 1525107109, "post_id": 50104849, "comment_id": 87226956, "body": "Have you build your project before with <code>go build</code> ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1525107198, "post_id": 50104849, "comment_id": 87227005, "body": "Your main package source is not in a package source directory, and neither is your <code>math</code> package. Please read <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a> in full."}], "answers": [{"tags": [], "owner": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "is_accepted": true, "score": 4, "last_activity_date": 1525108123, "last_edit_date": 1525108123, "creation_date": 1525107788, "answer_id": 50105039, "question_id": 50104849, "link": "https://stackoverflow.com/questions/50104849/multiple-file-project-in-golang/50105039#50105039", "title": "Multiple file project in golang", "body": "<p>You're close. What you have:</p>\n\n<pre><code>bin/\npkg/\n  math.go\nsrc/\n  main.go\n</code></pre>\n\n<p>But this isn't what the <code>go</code> binary expects. Under the <code>src</code> folder should be a folder for each project:</p>\n\n<pre><code>src/\n  myproject/\n    math/\n      math.go\n    main.go\n</code></pre>\n\n<p>When you want a go file to be in a different package it should be in a folder of the same name as the new package. You'll need to update your math import. <code>import \"math\"</code> will import the standard library math file. Try <code>import \"myproject/math\"</code> in your main.go after making the tree structure above.</p>\n\n<p>You don't have to worry about the pkg or bin folder. You won't normally need to go out of your way to put anything in them.</p>\n"}], "owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1297, "favorite_count": 0, "accepted_answer_id": 50105039, "answer_count": 1, "score": 0, "last_activity_date": 1525108123, "creation_date": 1525106940, "last_edit_date": 1525107797, "question_id": 50104849, "link": "https://stackoverflow.com/questions/50104849/multiple-file-project-in-golang", "title": "Multiple file project in golang", "body": "<p>I have a project with 2 files : </p>\n\n<p><a href=\"https://i.stack.imgur.com/OrYUP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OrYUP.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is my main.go file : </p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"math\"\n\nfunc main() {\n    xs := []float64{1, 2, 3, 4}\n    avg := math.Average(xs)\n    fmt.Println(avg)\n}\n</code></pre>\n\n<p>and my math.go  :</p>\n\n<pre><code>package math\n\nfunc Average(xs []float64) float64 {\n    total := float64(0)\n    for _, x := range xs {\n        total += x\n    }\n    return total / float64(len(xs))\n}\n</code></pre>\n\n<p>But when i do :</p>\n\n<pre><code>&gt; bussiere@kusanagi [06:44:01 PM] [~/Workspace/bdrun/TestPack/src]\n&gt; -&gt; % go install .\n&gt; # _/home/bussiere/Workspace/bdrun/TestPack/src ./main.go:8:9: undefined: math.Average bussiere@kusanagi [06:47:12 PM]\n&gt; [~/Workspace/bdrun/TestPack/src]-&gt; % go run main.go\n&gt; # command-line-arguments ./main.go:8:9: undefined: math.Average\n</code></pre>\n\n<p>How comes ?</p>\n\n<p>Regards and thanks</p>\n"}, {"tags": ["csv", "http", "go", "fileserver"], "answers": [{"tags": [], "owner": {"reputation": 6967, "user_id": 7803650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WH7uu.png?s=128&g=1", "display_name": "Oswin Noetzelmann", "link": "https://stackoverflow.com/users/7803650/oswin-noetzelmann"}, "is_accepted": false, "score": 1, "last_activity_date": 1525130214, "last_edit_date": 1525130214, "creation_date": 1525108873, "answer_id": 50105303, "question_id": 50104529, "link": "https://stackoverflow.com/questions/50104529/download-csv-from-my-server/50105303#50105303", "title": "Download *.csv from my server", "body": "<p>Golang makes serving files easy. You can use the FileServer component in net/http (see below). You just need to make sure to save the file in the folder that you are serving (\"/static\" in the example below). So your code should use a dedicated path:</p>\n\n<p><code>file, err := os.Create(\"/home/username/static/result.csv\")</code></p>\n\n<p>And with the following <code>FileServer</code> handler added, your file would be available under <code>http://domain/static/result.csv</code>. </p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n)\n\nfunc main() {\n...\n    fs := http.FileServer(http.Dir(\"/home/username/static\"))\n    http.Handle(\"/static/\", http.StripPrefix(\"/static\", fs))\n    http.ListenAndServe(\":3000\", nil)\n...\n}\n</code></pre>\n\n<p>Note that all files under static will be served. For more information see the <a href=\"https://golang.org/pkg/net/http/#FileServer\" rel=\"nofollow noreferrer\">docs</a>.</p>\n\n<p>If you need help how to write the client side for a file download please refer to <a href=\"https://stackoverflow.com/a/31989444/7803650\">this stackoverflow question</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 14633, "user_id": 5069957, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/597577c2765adaa190e4524d3a3860fe?s=128&d=identicon&r=PG&f=1", "display_name": "edkeveked", "link": "https://stackoverflow.com/users/5069957/edkeveked"}, "is_accepted": true, "score": 4, "last_activity_date": 1525110897, "last_edit_date": 1525110897, "creation_date": 1525110176, "answer_id": 50105604, "question_id": 50104529, "link": "https://stackoverflow.com/questions/50104529/download-csv-from-my-server/50105604#50105604", "title": "Download *.csv from my server", "body": "<p>On your Go server</p>\n\n<pre><code>func main() {\n  r := mux.NewRouter()\n  r.HandleFunc(\"/\", indexHandler)\n  http.Handle(\"/\", r)\n  err := http.ListenAndServe(\":3000\", nil) // setting listening port\n  if err != nil {\n    log.Fatal(\"ListenAndServe: \", err)\n}\n\nfunc indexHandler(w http.ResponseWriter, r *http.Request) {\n    ...\n    Openfile, err := os.Open(Filename)\n    FileSize := strconv.FormatInt(FileStat.Size(), 10)\n    FileContentType := http.DetectContentType(FileHeader)\n    //Send the headers before sending the file\n    writer.Header().Set(\"Content-Disposition\", \"attachment; filename=\"+Filename)\n    writer.Header().Set(\"Content-Type\", FileContentType)\n    writer.Header().Set(\"Content-Length\", FileSize)\n\n    //Send the file\n   io.Copy(w, Openfile) \n  }\n</code></pre>\n\n<p>In your client</p>\n\n<p>Since the file to be downloaded will be sent by the server, one need to use a js function to post the form first to the server. Then after receiving the response of the server, the download will be triggered directly by the same function.</p>\n\n<p>html</p>\n\n<pre><code>&lt;form&gt;\n    Enter credentials:&lt;br&gt;\n    Login: &lt;input id=\"login\" type=\"text\" name=\"login\" &gt;\n    &lt;br&gt;\n    Password: &lt;input id=\"password\" type=\"password\" name=\"password\" &gt;\n    &lt;br&gt;\n    Search link:&lt;br&gt;\n    &lt;input id=\"link\" type=\"text\" name=\"link\" &gt;\n    &lt;br&gt;\n    &lt;input type=\"button\" onclick=\"downloadFile()\"&gt;\n &lt;/form&gt; \n</code></pre>\n\n<p>In a js file</p>\n\n<pre><code>function downloadFile() {\n      var data = { \n       login: document.querySelector('#login').value,\n       password: document.querySelector('#password').value,\n       link: document.querySelector('#link').value\n       }\n\n      xhttp = new XMLHttpRequest();\n      xhttp.onreadystatechange = function() {\n        var a;\n        if (xhttp.readyState === 4 &amp;&amp; xhttp.status === 200) {\n            a = document.createElement('a');\n            a.href = window.URL.createObjectURL(xhttp.response);\n            // Give to file the name you wish \n            a.download = \"test-file.xls\";\n            a.style.display = 'none';\n            document.body.appendChild(a);\n            a.click();\n        }\n    }\n    }\n\n    xhttp.open(\"POST\", urlserver);\n    xhttp.setRequestHeader(\"Content-Type\", \"application/json\");\n    // set responseType as blob for binary responses\n    xhttp.responseType = 'blob';\n    xhttp.send(JSON.stringify(data));\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 7342510, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/241488dd8bf655e8cca83efdf0772d0c?s=128&d=identicon&r=PG&f=1", "display_name": "WannaBeBetter", "link": "https://stackoverflow.com/users/7342510/wannabebetter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3178, "favorite_count": 0, "accepted_answer_id": 50105604, "answer_count": 2, "score": 3, "last_activity_date": 1525130214, "creation_date": 1525105513, "last_edit_date": 1525111153, "question_id": 50104529, "link": "https://stackoverflow.com/questions/50104529/download-csv-from-my-server", "title": "Download *.csv from my server", "body": "<p>I am new to Golang and now I'm writing small app which parse some page.\nI got index page:</p>\n\n<pre><code>&lt;form action=\"/\" method='POST'&gt;\n    Enter credentials:&lt;br&gt;\n    Login: &lt;input type=\"text\" name=\"login\" &gt;\n    &lt;br&gt;\n    Password: &lt;input type=\"password\" name=\"password\" &gt;\n    &lt;br&gt;\n    Search link:&lt;br&gt;\n    &lt;input type=\"text\" name=\"link\" &gt;\n    &lt;br&gt;\n    &lt;input type=\"submit\" value=\"Submit\"&gt;\n &lt;/form&gt; \n</code></pre>\n\n<p>So after clicking Submit button it goes to parse page (using tebeca/selenium pkg), and in the end writes data to result.csv like</p>\n\n<pre><code>func writeToCSV(users []linkedinUser) {\ndata := users\nenc := struct2csv.New()\nrows, err := enc.Marshal(data)\nif err != nil {\n    fmt.Printf(\"ERROR marshaling file, %s\", err)\n}\nfile, err := os.Create(\"result.csv\")\nif err != nil {\n    fmt.Printf(\"ERROR creating file, %s\", err)\n}\ndefer file.Close()\n\nwriter := csv.NewWriter(file)\ndefer writer.Flush()\n\nfor _, value := range rows {\n    err := writer.Write(value)\n    if err != nil {\n        fmt.Printf(\"ERROR writing file, %s\", err)\n    }\n}\n</code></pre>\n\n<p>And in the end I got result.csv file in /home/username/go/src/parser/parsertool/src/result.csv</p>\n\n<p>my main.go</p>\n\n<pre><code>func main() {\n    r := mux.NewRouter()\n\n    r.HandleFunc(\"/\", indexHandler)\n    http.Handle(\"/\", r)\n\n    err := http.ListenAndServe(\":3000\", nil) // setting listening port\n    if err != nil {\n        log.Fatal(\"ListenAndServe: \", err)\n    }\n\n\n    func indexHandler(w http.ResponseWriter, r *http.Request) {\n    t, _ := template.ParseFiles(\"./front/index.html\")\n    badLoginT, _ := template.ParseFiles(\"./front/error.html\")\n    r.ParseForm()\n    login := r.PostFormValue(\"login\")\n    password := r.PostFormValue(\"password\")\n    link := r.PostFormValue(\"link\")\n    if login != \"\" || password != \"\" {\n        userCred := logincredentials.SetCredentials(login, password)\n        if logincredentials.CheckCredentials(userCred) &amp;&amp; link != \"\" {\n            crawler.Crawl(link, login, password)\n        } else {\n            badLoginT.Execute(w, nil)\n        }\n    }\n\n    t.Execute(w, nil)\n}\n</code></pre>\n\n<p><strong>So the main question:</strong>\nis there a way to get a link to download result.csv to my hard drive?\nThe implementation isn`t important. May be in the end of <em>writeToCSV()</em> when result.csv is ready, window where you could choose where to save file will appear, or after getting result.csv, some link like \"Click to download\" will appear and after clicking you can see download window etc.</p>\n\n<p>I'm stuck and really don't have any idea how to implement downloading.\nI would be grateful for any help.</p>\n"}, {"tags": ["go", "search", "concurrency", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1525105394, "post_id": 50104445, "comment_id": 87226150, "body": "Unless you index the files ahead of time, you&#39;re constrained by your storage IO, in which case linear search is usually most efficient."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1525105648, "post_id": 50104445, "comment_id": 87226273, "body": "@JimB Unless you&#39;re on SSD in which case queue depth 8 is the sweet spot."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1525105961, "post_id": 50104445, "comment_id": 87226412, "body": "It might be helpful for you to read the code of ripgrep, which is written in Rust. It has some of the most efficient directory recursion and file search around."}, {"owner": {"reputation": 15341, "user_id": 2228325, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/Vn6At.png?s=128&g=1", "display_name": "TonyGW", "link": "https://stackoverflow.com/users/2228325/tonygw"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1525106517, "post_id": 50104445, "comment_id": 87226675, "body": "@ZanLynx <a href=\"https://github.com/BurntSushi/ripgrep\" rel=\"nofollow noreferrer\">this git repo</a>. thanks"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1525107097, "post_id": 50104445, "comment_id": 87226951, "body": "@ZanLynx: yeah, I guess &quot;usually&quot; doesn&#39;t cut it any longer ;)  I wasn&#39;t familiar with &quot;8&quot; being the common sweet spot, but as with anything performance related it should be tested, and this example should be trivial to change to an adjustable pool of workers to benchmark the concurrency levels."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1525107262, "post_id": 50104445, "comment_id": 87227032, "body": "@JimB Yeah this stuff changes all the time. Who knows, maybe in 2 years the sweet spot will be 256 or something."}, {"owner": {"reputation": 1036, "user_id": 750425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/COaxk.jpg?s=128&g=1", "display_name": "karora", "link": "https://stackoverflow.com/users/750425/karora"}, "edited": false, "score": 0, "creation_date": 1525112814, "post_id": 50104445, "comment_id": 87229554, "body": "Your target should be something along the lines of how long it takes &quot;find&quot; to find the files from the command line.  18 seconds seems incredibly slow for matching within 42k files.  Avoiding a recursive solution also seems like it could be a premature optimisation too (how much recursion is there really?). You might be better doing the match inline if it&#39;s a normal file and only recursing if it&#39;s a directory though."}, {"owner": {"reputation": 15341, "user_id": 2228325, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/Vn6At.png?s=128&g=1", "display_name": "TonyGW", "link": "https://stackoverflow.com/users/2228325/tonygw"}, "edited": false, "score": 0, "creation_date": 1525115103, "post_id": 50104445, "comment_id": 87230570, "body": "Besides the 42k go files, there are 10 - 15 times more other files under the search path I used."}], "owner": {"reputation": 15341, "user_id": 2228325, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/Vn6At.png?s=128&g=1", "display_name": "TonyGW", "link": "https://stackoverflow.com/users/2228325/tonygw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 2, "answer_count": 0, "score": 1, "last_activity_date": 1525165668, "creation_date": 1525105128, "last_edit_date": 1525165668, "question_id": 50104445, "link": "https://stackoverflow.com/questions/50104445/increase-search-efficiency-using-concurrency", "title": "Increase search efficiency using concurrency", "body": "<p>I have the two following methods for searching for files with a name pattern (e.g. <code>*.go</code> for finding all go files) under a search path (e.g. <code>/Users/username/Desktop</code>). The first method uses recursion + goroutine, and the second method uses a queue to prevent possible stack overflow problem. From my testing on my own computer <code>Desktop</code> that has 41,233 go files, the first method beats the second method by 4 seconds, which are 18 and 22 seconds, respectively. </p>\n\n<p>I was wondering if there is any better way/parallelism to make the search even more efficient, because I am integrating the search in a desktop app, and I don't want the user sitting there and wait for 30 seconds before seeing any search results.</p>\n\n<pre><code>type FileSearcher struct {\n    Contents []MyFile\n}\n\nfunc (fe *FileSearcher) FindFileRecursive(searchPath, namePattern string) (err error) {\n\n    // get absolute path\n    if searchPath, err = filepath.Abs(searchPath); err != nil {\n        return\n    }\n    curFileName := filepath.Base(searchPath)\n    if matched, err := filepath.Match(namePattern, curFileName); err == nil &amp;&amp; matched {\n        if foundFile, err := NewFileFromPath(searchPath); err == nil {\n            fe.Contents = append(fe.Contents, *foundFile) // found a match\n        }\n    } else {\n        return\n    }\n\n    if isDir, _ := utils.IsDirectory(searchPath); isDir {\n        if files, err := ioutil.ReadDir(searchPath); err == nil {\n            for _, f := range files {\n                fPath := filepath.Join(searchPath, f.Name())\n                go fe.FindFileRecursive(fPath, namePattern) // recursive in a goroutine here\n            }\n        }\n    }\n    return\n}\n\n// FindFile searches for files/directories matching namePattern under searchPath\nfunc (fe *FileSearcher) FindFile(searchPath, namePattern string) (err error) {\n\n    queue := make([]string, 0)\n    queue = append(queue, searchPath)\n\n    for len(queue) &gt; 0 {\n        path := queue[0]\n        curFileName := filepath.Base(path) // get the file/directory name at this path\n        queue = queue[1:]                  // pop off the head\n\n        if matched, err := filepath.Match(namePattern, curFileName); err == nil &amp;&amp; matched {\n            if foundFile, err := NewFileFromPath(path); err == nil {\n                fe.Contents = append(fe.Contents, *foundFile) // found a match\n            }\n        }\n\n        if isDir, _ := utils.IsDirectory(path); isDir {\n            if files, err := ioutil.ReadDir(path); err == nil {\n                for _, f := range files {\n                    fPath := filepath.Join(path, f.Name())\n                    queue = append(queue, fPath) // push the new dir path to queue\n                }\n            }\n        }\n    }\n    return\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1525098317, "post_id": 50102093, "comment_id": 87221912, "body": "Is this generated with <code>go-bindata</code>? If so, it might be useful to include that in the question. The file should start with <code>Code generated by go-bindata.</code> ans a list of the source files, which implies that you <i>don&#39;t</i> edit it, you use the same tool to regenerate a new version."}], "answers": [{"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 2, "last_activity_date": 1525099482, "creation_date": 1525099482, "answer_id": 50102895, "question_id": 50102093, "link": "https://stackoverflow.com/questions/50102093/how-to-convert-a-code-in-go-file-code/50102895#50102895", "title": "How to convert a code in .go file code?", "body": "<p>files.go is generated by <a href=\"https://github.com/jteeuwen/go-bindata\" rel=\"nofollow noreferrer\">go-bindata</a>, a tool for embedding assets in Go binaries. It is not meant to be edited manually, as stated clearly by the comment at the top of the file</p>\n\n<pre><code>// Code generated by go-bindata.\n// sources:\n// files/cloud-favicon.png\n// [...]\n// DO NOT EDIT!\n</code></pre>\n\n<p>The repository contains a <a href=\"https://blog.golang.org/generate\" rel=\"nofollow noreferrer\">go generate</a> command in <a href=\"https://github.com/jpillora/cloud-torrent/blob/master/static/static.go\" rel=\"nofollow noreferrer\">static/static.go</a>, so to compile the assets, simply run</p>\n\n<pre><code>go generate github.com/jpillora/cloud-torrent/static\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6909159, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xh4gF9oR4QU/AAAAAAAAAAI/AAAAAAAAEFg/LMWlSa-AwIU/photo.jpg?sz=128", "display_name": "Parveen Bhadoo", "link": "https://stackoverflow.com/users/6909159/parveen-bhadoo"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "closed_date": 1525105392, "accepted_answer_id": 50102895, "answer_count": 1, "score": -8, "last_activity_date": 1525099482, "creation_date": 1525096737, "last_edit_date": 1525096837, "question_id": 50102093, "link": "https://stackoverflow.com/questions/50102093/how-to-convert-a-code-in-go-file-code", "closed_reason": "Needs details or clarity", "title": "How to convert a code in .go file code?", "body": "<p>I want to change a code. I have the html code. I have the .go code. I want to edit the html and the same should be edited on the .go file, that means I want to edit the .go file.</p>\n\n<p>files are at <a href=\"https://github.com/jpillora/cloud-torrent/tree/master/static/files\" rel=\"nofollow noreferrer\">https://github.com/jpillora/cloud-torrent/tree/master/static/files</a>\n.go file for this folder is here at <a href=\"https://github.com/jpillora/cloud-torrent/blob/master/static/files.go\" rel=\"nofollow noreferrer\">https://github.com/jpillora/cloud-torrent/blob/master/static/files.go</a></p>\n\n<p>the file i was to edit is\n<a href=\"https://github.com/jpillora/cloud-torrent/blob/master/static/files/index.html\" rel=\"nofollow noreferrer\">https://github.com/jpillora/cloud-torrent/blob/master/static/files/index.html</a></p>\n\n<p>.go code for this is given as</p>\n\n<pre><code>var _filesIndexHtml = []byte(\"\\x1f\\x8b\\x08\\x00\\x00\\x00\\x00\\x00\\x00\\xff\\x9c\\x57\\x5f\\x6f\\xdb\\x38\\x12\\x7f\\xb6\\x3f\\xc5\\x84\\xe8\\xc1\\xc9\\x21\\xb2\\x92\\xc3\\x3d\\x39\\x92\\x0e\\xbd\\x34\\xe8\\x2e\\x36\\x45\\x81\\x24\\xdd\\x97\\xa2\\x58\\xd0\\xd2\\x58\\x62\\x43\\x91\\x2c\\x49\\x39\\xf1\\xba\\xfa\\xee\\x0b\\x52\\x7f\\x22\\xc7\\x76\\xe2\\xb4\\x0f\\x8d\\xc5\\x99\\xf9\\xfd\\x66\\x86\\xf3\\x47\\x8a\\x0a\\x5b\\x72\\x10\\x79\\x40\\x95\\x8a\\x09\\x55\\x8a\\x24\\xe3\\x71\\x54\\x20\\xcd\\x92\\xf1\\x28\\xb2\\xcc\\x72\\x74\\xd2\\x39\\x13\\x59\\x4c\\x8c\\xa5\\x16\\xa7\\xb7\\x96\\x5a\\x33\\xbd\\x73\\x22\\x92\\x5c\\x72\\x59\\x65\\x70\\x27\\xb5\\x46\\x61\\xa3\\xd0\\x1b\\x38\\xcb\\x12\\x2d\\x05\\x41\\x4b\\x8c\\xc9\\x92\\xe1\\x83\\x92\\xda\\x12\\x48\\xa5\\xb0\\x28\\x6c\\x4c\\x1e\\x58\\x66\\x8b\\x38\\xc3\\x25\\x4b\\x31\\xf0\\x0f\\xa7\\xc0\\x04\\xb3\\x8c\\xf2\\xc0\\xa4\\x94\\x63\\x7c\\x3e\\x3d\\x3b\\x85\\x92\\x3e\\xb2\\xb2\\x2a\\x87\\x47\\x95\\x41\\xed\\x9f\\xe9\\x9c\\x63\\x2c\\x24\\x71\\x64\\x9c\\x89\\x7b\\xd0\\xc8\\x9d\\x87\\x2b\\x8e\\xa6\\x40\\xb4\\x04\\xec\\x4a\\x61\\x4c\\x2c\\x3e\\xda\\x30\\x35\\x86\\x40\\xa1\\x71\\x11\\x93\\xd4\\x98\\xf0\\x9a\\x5a\\xe9\\xff\\x9b\\x3a\\xc1\\xaf\\x20\\x18\\x2c\\xa9\\xb0\\x2c\\x9d\\x96\\x4c\\xfc\\x32\\x08\\x55\\x6a\\x87\\x2d\\x4b\\xa5\\xe8\\xb5\\x5c\\x76\\x83\\x05\\x5d\\xba\\xc3\\xa9\\x12\\x79\\x07\\xc7\\x4a\\x9a\\x63\\xf8\\x18\\x34\\xca\\xa1\\x43\\xf0\\x9c\\xcf\\xd9\\x92\\xf1\\x68\\xf4\\x55\\xe4\\x41\\xca\\x25\\xbd\\xff\\x06\\xeb\\xf1\\x68\\x34\\xca\\x98\\x51\\x9c\\xae\\x66\\x20\\xa4\\xc0\\x8b\\xf1\\x68\\x54\\x8f\\x47\\x51\\xe8\\xcd\\x93\\x71\\x14\\x36\\x77\\x3f\\x8e\\xe6\\x32\\x5b\\x41\\xca\\xa9\\x31\\x5d\\x5d\\x8c\\xa2\\x8c\\x2d\\xa1\\x43\\xeb\\x64\\x29\\xcd\\x91\\x80\\x14\\x99\\x96\\x6a\\xc1\\x38\\xc6\\xa4\\x52\\x5c\\xd2\\xac\\xad\\x89\\xe3\\x77\\xb8\\x44\\x61\\x4f\\x08\\x28\\x4e\\x53\\x2c\\x24\\xcf\\x50\\xc7\\xe4\\x83\\x96\\x0a\\x6c\\xa3\\x02\\xce\\xcc\\x40\\x81\\x1a\\xbd\\xc3\\x1d\\x0d\\x5b\\xc4\\xe4\\x28\\x95\\x42\\x60\\x6a\\x31\\x23\\x3d\\x61\\x73\\x12\\x3c\\x50\\x2d\\x98\\xc8\\xa1\\x62\\xc0\\xc4\\x12\\xb5\\xc5\\x0c\\xdc\\x1f\\x96\\x52\\x0e\\x25\\x35\\xd6\\x45\\x02\\x29\\x0a\\x8b\\x1a\\x28\\x67\\xb9\\xc0\\x0c\\x0c\\xe6\\x25\\x0a\\xeb\\x79\\x1a\\xa2\\x16\\xb5\\x62\\xe0\\xb2\\xe6\\x6b\\x94\\x32\\x81\\xba\\x51\\x19\\x45\\xc5\\xf9\\x40\\xa5\\x27\\x72\\xd8\\xbd\\xce\\x68\\xbd\\x86\\x82\\x9a\\xcb\\xce\\x55\\xf8\\x1f\\x4c\\x3e\\x30\\xd3\\xbb\\x3e\\x81\\x19\\x4c\\x5a\\x29\\x13\\xf9\\x04\\xea\\xba\\xc1\\x0e\\x8b\\xf3\\x37\\xb0\\x44\\xac\\xd3\\xd1\\x98\\x01\\x67\\x79\\x61\\x7d\\x02\\x7c\\x11\\x24\\x51\\xc8\\x92\\x4d\\xd4\\x28\\xcc\\xd8\\xd2\\x27\\xb4\\xff\\x71\\x14\\x04\\x70\\xf7\\xfb\\xdd\\xf5\\x15\\xc4\\xbb\\xfe\\x41\\x10\\xf4\\x17\\xd0\\x52\\xd9\\xa6\\xcf\\x3d\\x5e\\xf1\\x9f\\x96\\x81\\xb6\\xf5\\x59\\x58\\xab\\xcc\\x2c\\x0c\\x73\\x66\\x8b\\x6a\\x3e\\x4d\\x65\\x19\\x7e\\x57\\x8c\\x73\\xa9\\x69\\xd8\\xd4\\x6e\\x7b\\xc5\\x04\\x2c\\xd5\\x39\\xda\\x98\\xfc\\x35\\xe7\\x54\\xdc\\x13\\x7f\\xbf\\x82\\xd9\\x98\\x70\\x99\\xcb\\xdf\\xe4\\x12\\x35\\xc4\\xb0\\xa0\\xdc\\x20\\xf1\\x1c\\x4e\\xa1\\x94\\x95\\x41\\x27\\xda\\xd4\\xb2\\xba\\x42\\xd2\\xcb\\x39\\xd2\\x25\\xee\\x82\\xd9\\xca\\xda\\x9c\\x57\\xd8\\x24\\xab\\x29\\x62\\x7f\\xb8\\xf6\\x7e\\xce\\x8e\\x7a\\xfb\\x53\\x68\\xa2\\x99\\x41\\x7f\\x54\\x37\\xd9\\x85\\xf5\\x1a\\xb6\\x46\\xe0\\xd3\\x5d\\xd2\\x36\\xe9\\x6d\\x96\\x86\\x49\\x74\\x56\\x95\\xe9\\x2a\\x8a\\x39\\x7a\\x53\\xc8\\x07\\x77\\x91\\x3f\\x2a\\x34\\x76\\x9a\\xca\\x4a\\x58\\x48\\xe0\\x8c\\x0c\\xca\\x20\\x65\\x3a\\xad\\x38\\xd5\\xe0\\xda\\xc9\\x5d\\xb4\\x46\\x85\\xd4\\x6e\\xdd\\x37\\x6b\\xc2\\x61\\xe9\\x7d\\x4c\\xde\\x69\\x29\\x1d\\x9c\\x58\\xb0\\x7c\\x8a\\x19\\xb3\\x10\\xc3\\xd1\\xd6\\xe1\\xc5\\x46\\x06\\x72\\x8d\\x28\\x66\\xb0\\xa5\\x55\\xb7\\x37\\xb1\\xc3\\x23\\x83\\xda\\xa5\\xba\\x49\\xa6\\x1f\\x1d\\x31\\x59\\x48\\x61\\x03\\xc3\\xfe\\xc6\\x19\\x9c\\xff\\x57\\x3d\\x5e\\xbc\\xec\\xa2\\x2c\\x05\\x7b\\xe6\\x60\\x7f\\xf4\\x82\\x7b\\xbd\\x4e\\xbd\\x33\\x53\\x25\\xcd\\x05\\xb6\\x19\\x6a\\x9c\\x3f\\xc8\\xb9\\x5d\\x39\\xdf\\x6c\\xaf\\xa1\\x43\\xd0\\x7a\\xd4\\xf7\\xf7\\x29\\x68\\xcc\\x66\\xf0\\x34\\xab\\xa0\\x7e\\xc2\\xdf\\xd3\\x85\\x1f\\xaf\\x3f\\xff\\xff\\xfd\\x35\\x5c\\xdd\\xdc\\x7c\\xbe\\x81\\x4f\\x57\\xb7\\xb7\\xef\\x3f\\x1e\\xd0\\x94\\xed\\x54\\x44\\xad\\x87\\xe1\\xa3\\xd6\\x52\\x43\\x89\\xc6\\xb8\\x59\\xdc\\xb0\\xf6\\x41\\xa5\\x5c\\x9a\\x8d\\xb2\\x1f\\x5c\\x02\\x6a\\xd7\\x2e\\xa2\\xe2\\x7c\\xe0\\xef\\xa0\\x6e\\xbb\\xf9\\x73\\xe5\\x08\\x7a\\xff\\x47\\x91\\x4a\\xd6\\x6b\\xd4\\xba\\xae\\xa3\\x50\\x0d\\x42\\x73\\xbf\\x8c\\x9b\\x71\\x52\\x0c\\x86\\xf5\\x82\\xe5\\x0d\\xb3\\x14\\x56\\x4b\\xce\\x5d\\x3b\\x5f\\xfa\\xe3\\xcb\\xfe\\xa4\\x9d\\x07\\x29\\xaf\\x32\\x04\\xa3\\xd3\\x98\\x4c\\x2c\\x96\\x8a\\x53\\x8b\\x61\\x5b\\x91\\xee\\x45\\x65\\xe2\\xdc\\x6c\\x19\\x92\\x1d\\x6c\\xae\\x3a\\xb6\\xb8\\x3e\\x97\\x82\\x1d\\xc6\\xe4\\x8b\\xeb\\x10\\x9e\\x76\\xaa\\x99\\x2d\\xae\\x76\\xe9\\x99\\xc3\\xf8\\x3a\\x98\\x83\\x38\\x33\\xf9\\x20\\xdc\\x20\\xd8\\x26\\xfd\\xd0\\x49\\x0e\\x63\\xed\\x81\\x76\\xd0\\x3a\\xde\\x85\\x94\\x16\\x75\\x5f\\x0b\\x6d\\x93\\x18\\x45\\x45\\x32\\x98\\xf3\\xed\\x70\\x3d\\x60\\x13\\x6c\\xcd\\xfe\\xa4\\x93\\xb8\\x99\\xf9\\x06\\xa0\\x57\\x56\\x4a\\xb2\\x21\\x76\\xd8\\xee\\x75\\xc0\\xb8\\x14\\x3e\\x1b\\xdc\\x7f\\xb6\\xc7\\x75\\x0d\\x01\\x44\\xa1\\x0f\\xed\\x29\\xca\\xae\\xc9\\x44\\x55\\xfe\\x81\\x2b\\x73\\xdc\\x58\\x7e\\x31\\xa8\\xcd\\x09\\x24\\x70\\x4e\\x92\\xf5\\x1a\\x76\\x0a\\xeb\\xda\\xbf\\x9f\\x9a\\xa7\\xc9\\xb0\\x0b\\x3f\\xd9\\x17\\xb1\\xe4\\x54\\xe4\\x53\\xa9\\xf3\\xed\\xd0\\x3e\\x4a\\x1f\\xcf\\xb3\\x38\\x6e\\x2a\\x61\\x59\\x39\\x58\\x41\\x3d\\xfc\\xa0\\x57\\x37\\xaf\\xb0\\x0b\\x6e\\x08\\x73\\xbb\\x32\\x16\\xcb\\xa9\\x41\\xdb\\xef\\x4c\\xaf\\xda\\x16\\x1e\\x3e\\x5a\\x4d\\x3b\\xc9\\x28\\x97\\x5a\\x56\\x96\\x09\\x34\\xcf\\xbd\\x69\\x61\\x72\\x79\\xd3\\x29\\xd4\\xf5\\x69\\x8b\\x17\\x0e\\x03\\x7f\\x09\\xbc\\xc4\\x72\\x2f\\xee\\x27\\x2c\\xa5\\x5e\\xc1\\x4f\\x98\\xaf\\xec\\xcb\\xe8\\x1d\\x5e\\xaa\\xaa\\x3d\\x68\\x4e\\xf2\\x13\\xb4\\xac\\x44\\x06\\x75\\xfd\\xaf\\x57\\x91\\x5a\\xbf\\x8e\\xcf\\xcf\\xce\\xfe\\xbd\\x03\\xae\\xf4\\xae\\x7d\\x31\\x98\\x85\\x7b\\xa5\\x77\\xd2\\x52\\x7e\\xf2\\x26\\xd6\\x8c\\x99\\xfb\\x97\\x68\\x9d\\x7c\\x1f\\xa9\\x93\\x1d\\x44\\xb9\\xb7\\x01\\x86\\xa0\\x5f\\x94\\xab\\x34\\x92\\x54\\xca\\xf9\\x43\\x73\\x79\\xbc\\x2d\\x75\\x0d\\xb0\\x5d\\x83\\x7e\\x3d\\x74\\x33\\xc5\\xcf\\xb5\\x54\\x33\\x65\\x9b\\xa9\\xf4\\xdd\\x84\\x4b\\x14\\x99\\xd4\\xe1\\x8f\\x0a\\xf5\\x2a\\x30\\x56\\x33\\x91\\x4f\\xbf\\x1b\\x3f\\x95\\xbc\\x62\\xb2\\xdf\\x86\\x8a\\xdc\\xed\\x6a\\xff\\x11\\x76\\xa0\\x49\\x29\\xdd\\xeb\\xff\\x81\\x16\\x5c\\x3e\\xee\\xd3\\xf2\\x11\\x3e\\x30\\x91\\xc9\\x87\\x29\\x55\\x0a\\x62\\xe8\\x1e\\x3a\\x9f\\x64\\x56\\x71\\x3c\\x9e\\x50\\xa5\\x26\\xa7\\xf0\\xf5\\xdb\\xc9\\x85\\x4f\\xc4\\x7e\\xba\\x66\\xcd\\x0d\\x06\\xfb\\xab\\x0e\\xba\\x75\\xf5\\x16\\xfd\\x6e\\xdd\\xbc\\xc5\\xa6\\x5f\\x16\\x6f\\x31\\xaa\\x2c\\xe3\\xe6\\x55\\xad\\xee\\x1b\\x3a\\x48\\x0b\\x4c\\xef\\xe7\\xfb\\x73\\xdd\\x5b\\xe8\\x6a\\xeb\\xd6\\xda\\x22\\x8b\\x42\\xf7\\xb9\\xea\\x3e\\x5b\\x43\\xb7\\xd4\\x92\\x7f\\x02\\x00\\x00\\xff\\xff\\x86\\x79\\x9c\\x7e\\xd7\\x10\\x00\\x00\")\n\nfunc filesIndexHtmlBytes() ([]byte, error) {\n    return bindataRead(\n        _filesIndexHtml,\n        \"files/index.html\",\n    )\n}\n\nfunc filesIndexHtml() (*asset, error) {\n    bytes, err := filesIndexHtmlBytes()\n    if err != nil {\n        return nil, err\n    }\n\ninfo := bindataFileInfo{name: \"files/index.html\", size: 4311, mode: os.FileMode(420), modTime: time.Unix(1524843465, 0)}\n    a := &amp;asset{bytes: bytes, info: info}\n    return a, nil\n}\n</code></pre>\n"}, {"tags": ["go", "concurrency", "goroutine"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 4, "creation_date": 1525096218, "post_id": 50101853, "comment_id": 87220640, "body": "You should be registering your handler normally (i.e. not in a Go routine), and add thread-safe checking in the handler to ensure the 3rd-party library is started. If started, pass the request on to the 3rd-party handler."}, {"owner": {"reputation": 10244, "user_id": 797194, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3728c41e604024f375043551a59b41df?s=128&d=identicon&r=PG", "display_name": "m90", "link": "https://stackoverflow.com/users/797194/m90"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1525096538, "post_id": 50101853, "comment_id": 87220827, "body": "That&#39;s what I would like to do, but trouble is that the library (<a href=\"https://github.com/go-telegram-bot-api/telegram-bot-api\" rel=\"nofollow noreferrer\">github.com/go-telegram-bot-api/telegram-bot-api</a>) will call <code>http.HandleFunc</code> (registering itself on the default mux), no matter what. Then again, looking at what it does under the hood, I should be able to re-implement it myself (skipping the <code>HandleFunc</code> call) and do as you suggested. Will try so."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1525098196, "post_id": 50101853, "comment_id": 87221836, "body": "To be honest, this is arguably an inherent race (ie. a language bug) in the ServeMux.  The route map is supposed to be mutex protected, and generally is, but shouldRedirect can be called from several paths within ServeMux.Handler() without being mutex protected."}, {"owner": {"reputation": 10244, "user_id": 797194, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3728c41e604024f375043551a59b41df?s=128&d=identicon&r=PG", "display_name": "m90", "link": "https://stackoverflow.com/users/797194/m90"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 3, "creation_date": 1525099317, "post_id": 50101853, "comment_id": 87222562, "body": "@Kaedys Looks like it has already been adressed in March 2018: <a href=\"https://github.com/golang/go/pull/23994\" rel=\"nofollow noreferrer\">github.com/golang/go/pull/23994</a>"}], "answers": [{"tags": [], "owner": {"reputation": 10244, "user_id": 797194, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3728c41e604024f375043551a59b41df?s=128&d=identicon&r=PG", "display_name": "m90", "link": "https://stackoverflow.com/users/797194/m90"}, "is_accepted": true, "score": 2, "last_activity_date": 1525115666, "last_edit_date": 1525115666, "creation_date": 1525100022, "answer_id": 50103075, "question_id": 50101853, "link": "https://stackoverflow.com/questions/50101853/how-can-i-prevent-a-data-race-when-adding-handlers-in-a-goroutine/50103075#50103075", "title": "How can I prevent a data race when adding handlers in a goroutine?", "body": "<p>This seems to be an issue in package http itself, that is resolved <a href=\"https://github.com/golang/go/pull/23994\" rel=\"nofollow noreferrer\">via this Pull Request</a>.</p>\n\n<p>As of April 2018 the patch is not included in <code>go1.10.1</code>, but it's supposed to ship with <code>go1.11</code></p>\n"}], "owner": {"reputation": 10244, "user_id": 797194, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3728c41e604024f375043551a59b41df?s=128&d=identicon&r=PG", "display_name": "m90", "link": "https://stackoverflow.com/users/797194/m90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "accepted_answer_id": 50103075, "answer_count": 1, "score": 3, "last_activity_date": 1525115666, "creation_date": 1525095896, "question_id": 50101853, "link": "https://stackoverflow.com/questions/50101853/how-can-i-prevent-a-data-race-when-adding-handlers-in-a-goroutine", "title": "How can I prevent a data race when adding handlers in a goroutine?", "body": "<p>In my HTTP application written in golang I have a few routes that rely on 3rd party services (and vendored code) to do some work before I am actually able to register the route. This might fail or need to be retried, but I still want the application to respond to other requests while this is process is potentially ongoing.</p>\n\n<p>This means I am registering handlers on <code>http.DefaultServeMux</code> in goroutines that I spawn from my <code>main</code> func. This works as expected, but I will find my tests complaining about data races now.</p>\n\n<p>A minimal case to repro looks like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n    go func() {\n        http.HandleFunc(\"/hello\", func(w http.ResponseWriter, r *http.Request) {\n            w.Write([]byte(\"hello\"))\n        })\n    }()\n    srv := http.Server{\n        Addr: \":3000\",\n    }\n    log.Fatal(srv.ListenAndServe())\n}\n</code></pre>\n\n<p>With a test like:</p>\n\n<pre><code>package main\n\nimport (\n    \"io/ioutil\"\n    \"net/http\"\n    \"os\"\n    \"testing\"\n    \"time\"\n)\n\nfunc TestMain(m *testing.M) {\n    go main()\n    time.Sleep(time.Second)\n    os.Exit(m.Run())\n}\n\nfunc TestHello(t *testing.T) {\n    t.Run(\"default\", func(t *testing.T) {\n        res, err := http.DefaultClient.Get(\"http://0.0.0.0:3000/hello\")\n        if err != nil {\n            t.Fatalf(\"Calling /hello returned %v\", err)\n        }\n        if res.StatusCode != http.StatusOK {\n            b, _ := ioutil.ReadAll(res.Body)\n            defer res.Body.Close()\n            t.Errorf(\"Expected /hello to return 200 response, got %v with body %v\", res.StatusCode, string(b))\n        }\n    })\n}\n</code></pre>\n\n<p>will show me the following output:</p>\n\n<pre><code>==================\nWARNING: DATA RACE\nRead at 0x000000a337d8 by goroutine 14:\n  net/http.(*ServeMux).shouldRedirect()\n      /usr/local/go/src/net/http/server.go:2239 +0x162\n  net/http.(*ServeMux).redirectToPathSlash()\n      /usr/local/go/src/net/http/server.go:2224 +0x64\n  net/http.(*ServeMux).Handler()\n      /usr/local/go/src/net/http/server.go:2293 +0x184\n  net/http.(*ServeMux).ServeHTTP()\n      /usr/local/go/src/net/http/server.go:2336 +0x6d\n  net/http.serverHandler.ServeHTTP()\n      /usr/local/go/src/net/http/server.go:2694 +0xb9\n  net/http.(*conn).serve()\n      /usr/local/go/src/net/http/server.go:1830 +0x7dc\n\nPrevious write at 0x000000a337d8 by goroutine 8:\n  net/http.(*ServeMux).Handle()\n      /usr/local/go/src/net/http/server.go:2357 +0x216\n  net/http.(*ServeMux).HandleFunc()\n      /usr/local/go/src/net/http/server.go:2368 +0x62\n  net/http.HandleFunc()\n      /usr/local/go/src/net/http/server.go:2380 +0x68\n  github.com/m90/test.main.func1()\n      /home/frederik/projects/go/src/github.com/m90/test/main.go:10 +0x4f\n\nGoroutine 14 (running) created at:\n  net/http.(*Server).Serve()\n      /usr/local/go/src/net/http/server.go:2795 +0x364\n  net/http.(*Server).ListenAndServe()\n      /usr/local/go/src/net/http/server.go:2711 +0xc4\n  github.com/m90/test.main()\n      /home/frederik/projects/go/src/github.com/m90/test/main.go:17 +0xb6\n\nGoroutine 8 (finished) created at:\n  github.com/m90/test.main()\n      /home/frederik/projects/go/src/github.com/m90/test/main.go:9 +0x46\n==================\n</code></pre>\n\n<p>From what I understand reading <a href=\"https://golang.org/src/net/http/server.go\" rel=\"nofollow noreferrer\">the code of package http</a> <code>net/http.(*ServeMux).Handler()</code> in the stacktrace does not lock the mutex that protects the handler map, as it expects this to be done by <code>net/http.(*ServeMux).handler()</code> which in my scenario does not get called.</p>\n\n<p>Am I doing something that is not supposed to be done? Is this an issue with the standard library? Am I doing something wrong in the way I attach the handlers in a goroutine?</p>\n"}, {"tags": ["mongodb", "docker", "go", "docker-compose"], "answers": [{"comments": [{"owner": {"reputation": 1030, "user_id": 451904, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/l2Raf.jpg?s=128&g=1", "display_name": "ChrisAdkin", "link": "https://stackoverflow.com/users/451904/chrisadkin"}, "edited": false, "score": 0, "creation_date": 1525086116, "post_id": 50098898, "comment_id": 87214700, "body": "Thanks Zak, I&#39;m now getting:  docker-compose up Starting mongo ... done Starting carsupermarket_api_1 ... done Attaching to mongo, carsupermarket_api_1 carsupermarket_api_1 exited with code 0  which makes me think that I need a Dockerfile for my client with the go run at the end, I suspect that my issue is now to do with the way my docker-compose.yml file is structured for the client."}, {"owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "reply_to_user": {"reputation": 1030, "user_id": 451904, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/l2Raf.jpg?s=128&g=1", "display_name": "ChrisAdkin", "link": "https://stackoverflow.com/users/451904/chrisadkin"}, "edited": false, "score": 0, "creation_date": 1525086598, "post_id": 50098898, "comment_id": 87214936, "body": "Usually exit code 0 means that the program exited successfully. Is that possible? That your go program is really just ending because it&#39;s finished?  Also.. can you run the go program outside of the container, on your host and point it to the mongodb container at address: <code>&quot;localhost:27017&quot;</code> to see if you get the same of different behaviour?"}, {"owner": {"reputation": 1030, "user_id": 451904, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/l2Raf.jpg?s=128&g=1", "display_name": "ChrisAdkin", "link": "https://stackoverflow.com/users/451904/chrisadkin"}, "edited": false, "score": 0, "creation_date": 1525087136, "post_id": 50098898, "comment_id": 87215215, "body": "The code works fine outside of a container, this makes me think I need to create an image for the GO client with go run as the very last command in the Dockerfile."}], "tags": [], "owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "is_accepted": true, "score": 4, "last_activity_date": 1525085107, "creation_date": 1525085107, "answer_id": 50098898, "question_id": 50098773, "link": "https://stackoverflow.com/questions/50098773/golang-client-docker-container-getting-unreachable-when-attempting-to-connect-to/50098898#50098898", "title": "GOLANG client docker container getting unreachable when attempting to connect to mongodb container", "body": "<p>I think that when you call <code>mgo.Dial(\"localhost:27017\")</code> the <code>localhost</code> part refers to the localhost within the golang container, and not the host the the containers are running on.</p>\n\n<p>Docker will resolved container names as host names, change the dial to <code>mgo.Dial(\"mongo:27017\")</code> and it should work.</p>\n\n<p>From the docker container networking bridge docs</p>\n\n<p>User-defined bridges provide automatic DNS resolution between containers.</p>\n\n<blockquote>\n  <p>Containers on the default bridge network can only access each other by\n  IP addresses, unless you use the --link option, which is considered\n  legacy. On a user-defined bridge network, containers can resolve each\n  other by name or alias.</p>\n</blockquote>\n\n<p><a href=\"https://docs.docker.com/network/bridge/\" rel=\"nofollow noreferrer\">https://docs.docker.com/network/bridge/</a></p>\n"}, {"comments": [{"owner": {"reputation": 694, "user_id": 458711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rcFiG.jpg?s=128&g=1", "display_name": "OpenBSDNinja", "link": "https://stackoverflow.com/users/458711/openbsdninja"}, "edited": false, "score": 0, "creation_date": 1525088843, "post_id": 50099889, "comment_id": 87216221, "body": "Try my docker-compose file with: <code>$ docker-compose down</code> then try again with: <code>$ docker-compose up</code>"}], "tags": [], "owner": {"reputation": 694, "user_id": 458711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rcFiG.jpg?s=128&g=1", "display_name": "OpenBSDNinja", "link": "https://stackoverflow.com/users/458711/openbsdninja"}, "is_accepted": false, "score": 0, "last_activity_date": 1525088801, "creation_date": 1525088801, "answer_id": 50099889, "question_id": 50098773, "link": "https://stackoverflow.com/questions/50098773/golang-client-docker-container-getting-unreachable-when-attempting-to-connect-to/50099889#50099889", "title": "GOLANG client docker container getting unreachable when attempting to connect to mongodb container", "body": "<pre><code>version: \"2\"\n\nservices:\n  api:\n    image: golang:latest\n    volumes:\n      - .:/go\n    # Work dir should be defined in dockerfile\n    #working_dir: /go\n    environment:\n      - GOPATH=/go\n    command:\n      go run /go/src/main.go\n    ports:\n      - \"8082:8000\"\n    depends_on: \n      - db \n\n  db:\n    build: .\n    container_name: 'mongo'\n    # You should define some volumes here if you want the data to persist.\n</code></pre>\n\n<p>You should be able to connect from the golang container to the mongo container using inter container communication using the hostname: 'mongo'</p>\n"}], "owner": {"reputation": 1030, "user_id": 451904, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/l2Raf.jpg?s=128&g=1", "display_name": "ChrisAdkin", "link": "https://stackoverflow.com/users/451904/chrisadkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1430, "favorite_count": 0, "accepted_answer_id": 50098898, "answer_count": 2, "score": 2, "last_activity_date": 1525088801, "creation_date": 1525084664, "last_edit_date": 1525088766, "question_id": 50098773, "link": "https://stackoverflow.com/questions/50098773/golang-client-docker-container-getting-unreachable-when-attempting-to-connect-to", "title": "GOLANG client docker container getting unreachable when attempting to connect to mongodb container", "body": "<p>I have a simple program written in golang which connect to a mongodb instance thus:</p>\n\n<pre><code>func main() {\n    session, err := mgo.Dial(\"localhost:27017\")    \n\n    if err != nil {\n        panic(err)\n    }\n\n    defer session.Close()\n    session.SetMode(mgo.Monotonic, true)\n    ensureIndex(session)\n}\n</code></pre>\n\n<p>I use docker compose to spin up two containers one to spin up my GOLANG API and the other to spin up mongo:</p>\n\n<pre><code>version: \"3.3\"\n\nservices:\n  api:\n    image: golang:latest\n    volumes:\n      - .:/go\n    working_dir: /go\n    environment:\n      - GOPATH=/go\n    command:\n      go run /go/src/main.go\n    ports:\n      - \"8082:8000\"\n    depends_on: \n      - db\n    networks:\n      - api-net    \n\n  db:\n    build: .\n    expose:\n      - '27017'\n    container_name: 'mongo'\n    ports:\n      - \"27017:27017\"\n    networks:\n      - api-net\n\nnetworks:\n  api-net:\n    driver: bridge\n</code></pre>\n\n<p>I use a Dockerfile in order to spin up mongo with a conf file that sets the instance to bind to all IPV4 and IPV6 networks:</p>\n\n<pre><code>FROM mongo:latest\n\nCOPY mongod.conf /etc/mongod.conf\nCMD mongod --config /etc/mongod.conf##\n</code></pre>\n\n<p>and this is the mongod.conf file:</p>\n\n<pre><code>systemLog:\n  destination: file\n  logAppend: true\n  path: /var/log/mongodb/mongod.log\n\n# network interfaces\nnet:\n  port: 27017\n  bindIp: 0.0.0.0\n</code></pre>\n\n<p>When I run docker-compose.up this is what I get:</p>\n\n<pre><code>Building db\nStep 1/3 : FROM mongo:latest\n ---&gt; a0f922b3f0a1\nStep 2/3 : COPY mongod.conf /etc/mongod.conf\n ---&gt; Using cache\n ---&gt; f270e718c11e\nStep 3/3 : CMD mongod --config /etc/mongod.conf\n ---&gt; Running in 89ffc2495a2a\nRemoving intermediate container 89ffc2495a2a\n ---&gt; fe2677d53122\n\nSuccessfully built fe2677d53122\nSuccessfully tagged carsupermarket_db:latest\nWARNING: Image for service db was built because it did not already exist. To rebuild this image you must use `docker-compose build` or `docker-compose up --build`.\nCreating mongo ... done\nCreating carsupermarket_api_1 ... done\nAttaching to mongo, carsupermarket_api_1\napi_1  | panic: no reachable servers\napi_1  |\napi_1  | goroutine 1 [running]:\napi_1  | main.main()\napi_1  |        /go/src/main.go:38 +0x291\napi_1  | exit status 2\n</code></pre>\n\n<p>I've trawled Google and stackoverflow and the only thing I could manage to find which is vaguely related to my issue is:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/38860308/mongod-bind-ip-using-docker-compose-version-2\">mongod --bind_ip using docker-compose version 2</a></p>\n\n<p>however, my docker-compose.yml file as it stands 'Should' on paper work.</p>\n\n<p>Can someone please point me in the correct direction as to why my GOLANG code cannot find my mongodb instance. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 20930, "user_id": 6881240, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dc1e27d7e9a3de2ca8e257cb7c72ff4a?s=128&d=identicon&r=PG&f=1", "display_name": "kabanus", "link": "https://stackoverflow.com/users/6881240/kabanus"}, "edited": false, "score": 0, "creation_date": 1525084328, "post_id": 50098624, "comment_id": 87213717, "body": "I searched and and found <a href=\"https://stackoverflow.com/questions/22085485/reflect-thinks-struct-value-is-also-a-ptr\" title=\"reflect thinks struct value is also a ptr\">stackoverflow.com/questions/22085485/&hellip;</a> and <a href=\"https://stackoverflow.com/questions/24537525/reflect-value-fieldbyname-causing-panic\" title=\"reflect value fieldbyname causing panic\">stackoverflow.com/questions/24537525/&hellip;</a> - it looks the same doesn&#39;t it?  Do those help you solve your problem"}, {"owner": {"reputation": 298, "user_id": 9456506, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "elham anari", "link": "https://stackoverflow.com/users/9456506/elham-anari"}, "reply_to_user": {"reputation": 20930, "user_id": 6881240, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dc1e27d7e9a3de2ca8e257cb7c72ff4a?s=128&d=identicon&r=PG&f=1", "display_name": "kabanus", "link": "https://stackoverflow.com/users/6881240/kabanus"}, "edited": false, "score": 0, "creation_date": 1525084582, "post_id": 50098624, "comment_id": 87213844, "body": "I check them but when i use Elem() , there is another error and  my per1 structure is correct .@kabanus"}], "answers": [{"comments": [{"owner": {"reputation": 298, "user_id": 9456506, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "elham anari", "link": "https://stackoverflow.com/users/9456506/elham-anari"}, "edited": false, "score": 1, "creation_date": 1525085175, "post_id": 50098755, "comment_id": 87214178, "body": "Yes,I must use Indirect().Thanks @Zak"}], "tags": [], "owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "is_accepted": true, "score": 15, "last_activity_date": 1525084607, "creation_date": 1525084607, "answer_id": 50098755, "question_id": 50098624, "link": "https://stackoverflow.com/questions/50098624/reflect-call-of-reflect-value-fieldbyname-on-ptr-value/50098755#50098755", "title": "reflect: call of reflect.Value.FieldByName on ptr Value", "body": "<p>As you've noted, <code>family</code> is <code>*Family</code>. And as the error says, you cannot call <code>.FieldByName(...)</code> on a <code>reflect.Value</code> where that value is a pointer.</p>\n\n<p>Instead you need to indirect the pointer, to get the value that it points to, and call <code>.FieldByName(...)</code> on that.</p>\n\n<pre><code>familyPtr := v.FieldByName(\"family\")\nv = reflect.Indirect(familyPtr).FieldByName(\"last\")\n</code></pre>\n\n<p>See docs on indirect: <a href=\"https://golang.org/pkg/reflect/#Indirect\" rel=\"noreferrer\">https://golang.org/pkg/reflect/#Indirect</a></p>\n"}], "owner": {"reputation": 298, "user_id": 9456506, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "elham anari", "link": "https://stackoverflow.com/users/9456506/elham-anari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12743, "favorite_count": 2, "accepted_answer_id": 50098755, "answer_count": 1, "score": 10, "last_activity_date": 1525087531, "creation_date": 1525084165, "last_edit_date": 1525087531, "question_id": 50098624, "link": "https://stackoverflow.com/questions/50098624/reflect-call-of-reflect-value-fieldbyname-on-ptr-value", "title": "reflect: call of reflect.Value.FieldByName on ptr Value", "body": "<p>I have a data structure like this demo.</p>\n\n<pre><code>type Family struct {\n   first string\n   last string\n}\ntype Person struct {\n   name string\n   family *Family\n}\n\nfunc main(){\n   per1 := Person{name:\"niki\",family:&amp;Familys{first:\"yam\",last:\"bari\"}}\n   Check(per1)\n}\n</code></pre>\n\n<p>and the code:</p>\n\n<pre><code>var validate *validator.Validate\nfunc Check(data interface{}) {\n    var v = reflect.ValueOf(data)\n\n    if v.Kind() == reflect.Struct {\n        fmt.Println(\"was a struct\")\n        v = v.FieldByName(\"family\").FieldByName(\"last\")\n        fmt.Println(v)\n    }\n}\n</code></pre>\n\n<p>when i do not use point for Family , it back \"bari\" and it is ok.But with point , there is this error .</p>\n\n<blockquote>\n  <p>reflect: call of reflect.Value.FieldByName on ptr Value</p>\n</blockquote>\n\n<p>I searched a lot but i can not find answer can help.</p>\n"}, {"tags": ["debugging", "go", "visual-studio-code", "downgrade"], "comments": [{"owner": {"reputation": 919, "user_id": 4053190, "user_type": "registered", "profile_image": "https://graph.facebook.com/615361894/picture?type=large", "display_name": "Harold Ship", "link": "https://stackoverflow.com/users/4053190/harold-ship"}, "edited": false, "score": 1, "creation_date": 1525076238, "post_id": 50096374, "comment_id": 87216720, "body": "Well, I just downloaded 1.9.5 darwin installer from <a href=\"https://golang.org/project/\" rel=\"nofollow noreferrer\">golang.org</a> and it uninstalled 1.10 and now the debugger works!"}], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 7, "last_activity_date": 1525076777, "creation_date": 1525076777, "answer_id": 50096640, "question_id": 50096374, "link": "https://stackoverflow.com/questions/50096374/how-do-i-downgrade-go-from-1-10-to-1-9/50096640#50096640", "title": "How do I downgrade Go from 1.10 to 1.9?", "body": "<p>The same way you upgrade. That is, remove the existing version, then install the new version. Although \"downgrade\" isn't explicitly stated on the official docs, it <a href=\"https://golang.org/doc/install#install\" rel=\"noreferrer\">does explain how to do it</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 75, "user_id": 2475128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be305db1ca83aa3c4ef9a0d815756cc3?s=128&d=identicon&r=PG", "display_name": "e.nikolov", "link": "https://stackoverflow.com/users/2475128/e-nikolov"}, "is_accepted": false, "score": -4, "last_activity_date": 1525082418, "creation_date": 1525082418, "answer_id": 50098141, "question_id": 50096374, "link": "https://stackoverflow.com/questions/50096374/how-do-i-downgrade-go-from-1-10-to-1-9/50098141#50098141", "title": "How do I downgrade Go from 1.10 to 1.9?", "body": "<p>I use my own <a href=\"https://github.com/e-nikolov/gvm\" rel=\"nofollow noreferrer\">fork</a> of <a href=\"https://github.com/moovweb/gvm\" rel=\"nofollow noreferrer\">gvm</a> to easily switch between go versions. The original gvm is fairly old and keeps a different gopath per go version which I found annoying and removed in my fork.</p>\n\n<p>So after setting up gvm, you can do </p>\n\n<pre><code>gvm install go1.9.5 -B\ngvm use go1.9.5 --default\n</code></pre>\n\n<p>The -B flag installs go from a binary release. If you don't add it, it will try to compile it from sources, which requires a bit more setup.</p>\n"}, {"tags": [], "owner": {"reputation": 307, "user_id": 1589496, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/LRSa8.jpg?s=128&g=1", "display_name": "Ciobanu Andrei", "link": "https://stackoverflow.com/users/1589496/ciobanu-andrei"}, "is_accepted": false, "score": 1, "last_activity_date": 1525156585, "creation_date": 1525156585, "answer_id": 50112298, "question_id": 50096374, "link": "https://stackoverflow.com/questions/50096374/how-do-i-downgrade-go-from-1-10-to-1-9/50112298#50112298", "title": "How do I downgrade Go from 1.10 to 1.9?", "body": "<p>I don't know if you need to downgrade Go in order to reenable the debugging. I had the same problem on a Mac(10.13) and the problem seems to be XCode.</p>\n\n<p><a href=\"https://github.com/derekparker/delve/issues/1015#issuecomment-377654359\" rel=\"nofollow noreferrer\">Here</a> I've found the solution for fixing the debugging problem.</p>\n\n<p>You should delete the current XCode Command Line Tools binary:</p>\n\n<pre><code>sudo rm -rf /Library/Developer/CommandLineTools\n</code></pre>\n\n<p>and install an older XCode Command Line Tools (for me it's working with 9.2) using one of the following links:</p>\n\n<ul>\n<li><a href=\"https://download.developer.apple.com/Developer_Tools/Command_Line_Tools_macOS_10.13_for_Xcode_9.2/Command_Line_Tools_macOS_10.13_for_Xcode_9.2.dmg\" rel=\"nofollow noreferrer\">XCode 9.2 for macOS 10.13</a></li>\n<li><a href=\"https://download.developer.apple.com/Developer_Tools/Command_Line_Tools_macOS_10.12_for_Xcode_9.2/Command_Line_Tools_macOS_10.12_for_Xcode_9.2.dmg\" rel=\"nofollow noreferrer\">XCode 9.2 for macOS 10.12</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 440, "user_id": 5308771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VowhL.jpg?s=128&g=1", "display_name": "Ashutosh Rai", "link": "https://stackoverflow.com/users/5308771/ashutosh-rai"}, "is_accepted": false, "score": 0, "last_activity_date": 1550763053, "creation_date": 1550763053, "answer_id": 54810711, "question_id": 50096374, "link": "https://stackoverflow.com/questions/50096374/how-do-i-downgrade-go-from-1-10-to-1-9/54810711#54810711", "title": "How do I downgrade Go from 1.10 to 1.9?", "body": "<p>Best way to upgrade or downgrade Go on Ubuntu is to download required version from <a href=\"https://golang.org/dl/\" rel=\"nofollow noreferrer\">here</a>. Here you could have all stable and releases, along with archived versions. </p>\n\n<p>after downloading you selected version you can follow further steps, i will suggest you to download tar.gz format for ubuntu machine:</p>\n\n<ol>\n<li>first of all fully remove the older version from your local by doing this</li>\n</ol>\n\n<p><code>sudo rm -rf /usr/local/go /usr/local/gocache</code> </p>\n\n<p>this will remove all the local go code base but wait something more we have to do to remove fully from local, i was missing this step and it took so much time until I understood what i am missing so here is the purge stuff to remove from list </p>\n\n<blockquote>\n<pre><code>sudo apt-get purge golang\n</code></pre>\n</blockquote>\n\n<p>or </p>\n\n<blockquote>\n<pre><code>sudo apt remove golang-go\n</code></pre>\n</blockquote>\n\n<ol start=\"2\">\n<li>Now install / extract your downloaded version of go inside /usr/local/go, by hitting terminal with this</li>\n</ol>\n\n<blockquote>\n  <p><code>tar -C /usr/local -xzf go1.10.8.linux-amd64.tar.gz</code></p>\n</blockquote>\n\n<ol start=\"3\">\n<li>after doing all above stuff , don't forget or check to <code>GOROOT</code> variable value you can check the value by <code>go env</code> if not set then <code>export PATH=$PATH:/usr/local/go</code></li>\n<li>Better to test a small go program to make sure. write this inside <code>/home/yourusername/go/test.php</code> if you haven't changed set <code>GOPATH</code> value:</li>\n</ol>\n\n<blockquote>\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(\"hello world\")\n}\n</code></pre>\n</blockquote>\n\n<ol start=\"5\">\n<li>run this by <code>go run test.go</code></li>\n</ol>\n\n<p>i hope it works for you!!</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6767688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3286afff8e0426bae69e2137b19d3c5?s=128&d=identicon&r=PG&f=1", "display_name": "Vijay kashyap s", "link": "https://stackoverflow.com/users/6767688/vijay-kashyap-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1602309328, "creation_date": 1602309328, "answer_id": 64290454, "question_id": 50096374, "link": "https://stackoverflow.com/questions/50096374/how-do-i-downgrade-go-from-1-10-to-1-9/64290454#64290454", "title": "How do I downgrade Go from 1.10 to 1.9?", "body": "<p>First remove go from the system</p>\n<ul>\n<li><code>sudo snap remove go</code></li>\n</ul>\n<p>Then install particular version of go</p>\n<ul>\n<li><code>sudo snap install --classic --channel=1.14/stable go</code></li>\n</ul>\n"}], "owner": {"reputation": 919, "user_id": 4053190, "user_type": "registered", "profile_image": "https://graph.facebook.com/615361894/picture?type=large", "display_name": "Harold Ship", "link": "https://stackoverflow.com/users/4053190/harold-ship"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15694, "favorite_count": 0, "accepted_answer_id": 50096640, "answer_count": 5, "score": 1, "last_activity_date": 1602309328, "creation_date": 1525075613, "question_id": 50096374, "link": "https://stackoverflow.com/questions/50096374/how-do-i-downgrade-go-from-1-10-to-1-9", "title": "How do I downgrade Go from 1.10 to 1.9?", "body": "<p>I have a problem with debugging in Go 1.10 in vscode using delve on Mac.\nI read <a href=\"https://youtrack.jetbrains.com/issue/GO-5446\" rel=\"nofollow noreferrer\">here</a> that the workaround is to downgrade to Go 1.9.\nSince I am new at Go, but have lots of stuff already installed, how do I do this cleanly?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 415, "user_id": 9661066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DKIYpno_RaE/AAAAAAAAAAI/AAAAAAAAAAA/784Fv4xgNp8/photo.jpg?sz=128", "display_name": "GilesW", "link": "https://stackoverflow.com/users/9661066/gilesw"}, "edited": false, "score": 0, "creation_date": 1525073841, "post_id": 50095899, "comment_id": 87208097, "body": "what is the -1 arg?"}, {"owner": {"reputation": 1074, "user_id": 3437114, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a082cfd8df451a12d665e42277f989d6?s=128&d=identicon&r=PG&f=1", "display_name": "Hansa", "link": "https://stackoverflow.com/users/3437114/hansa"}, "edited": false, "score": 0, "creation_date": 1525074405, "post_id": 50095899, "comment_id": 87208339, "body": "it tells how often the string shall be replaced, -1 says all occurrences,  but it&#39;s also stated in the docu @ain posted..."}], "tags": [], "owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "is_accepted": false, "score": 4, "last_activity_date": 1525073583, "creation_date": 1525073583, "answer_id": 50095899, "question_id": 50095788, "link": "https://stackoverflow.com/questions/50095788/string-conversion-from-one-formt-to-other-using-packages/50095899#50095899", "title": "String conversion from one formt to other using packages", "body": "<p>There is <a href=\"https://golang.org/pkg/strings/#Replace\" rel=\"nofollow noreferrer\">strings.Replace</a> function in standard library:</p>\n\n<pre><code>result1 := strings.Replace(data, \"-\", \":\", -1)\n</code></pre>\n"}], "owner": {"reputation": 70, "user_id": 9428861, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Saiprasanna Sastry", "link": "https://stackoverflow.com/users/9428861/saiprasanna-sastry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1597911660, "creation_date": 1525073106, "last_edit_date": 1597911660, "question_id": 50095788, "link": "https://stackoverflow.com/questions/50095788/string-conversion-from-one-formt-to-other-using-packages", "title": "String conversion from one formt to other using packages", "body": "<p>Say I have a string \"a-b-c-d \", if the string is separated by \"-\", I want to replace \"-\" by \":\" else I want the string to remain same. How do I do that in Go?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    data := \"01-12-13-14-15-16\"\n    //  mac :=\"11:11:11:11:11:11\"\n\n    // Split on comma.\n    result := strings.Split(data, \"-\")\n    result1 :=strings.Join(result,\":\")\n\n    //  result11 := strings.Split(mac, \"-\")\n    //result12 :=strings.Join(mac,\":\")\n\n    fmt.Print(result1)\n    //fmt.Print(result12)\n}\n</code></pre>\n"}, {"tags": ["go", "string-interpolation"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9455968"}, "edited": false, "score": 4, "creation_date": 1525072736, "post_id": 50095683, "comment_id": 87207515, "body": "I don&#39;t think  <code>Sprintf</code> ha a confusing name. It prints into a string :)"}, {"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 6, "creation_date": 1525072847, "post_id": 50095683, "comment_id": 87207560, "body": "Remember the days when &quot;printing&quot; meant putting something on paper? Me neither. But putting it into some memory location definitely feels less like printing to me than writing it to the terminal (which is usually what stdout is connected to)."}], "tags": [], "owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "is_accepted": true, "score": 13, "last_activity_date": 1525072688, "creation_date": 1525072688, "answer_id": 50095683, "question_id": 50095616, "link": "https://stackoverflow.com/questions/50095616/go-string-interpolation/50095683#50095683", "title": "Go string interpolation", "body": "<p><code>fmt.Sprintln</code> returns a <code>String</code>, but doesn't print anything. (The name was taken from the also confusingly named C function <code>sprintf</code>.)</p>\n\n<p>What you need is <a href=\"https://golang.org/pkg/fmt/#Printf\" rel=\"noreferrer\"><code>Printf</code></a>, but you have to add the newline yourself:</p>\n\n<pre><code>fmt.Printf(\"inc 1 equal %v\\n\", inc(1))\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9455968"}, "is_accepted": false, "score": 0, "last_activity_date": 1525072712, "creation_date": 1525072712, "answer_id": 50095693, "question_id": 50095616, "link": "https://stackoverflow.com/questions/50095616/go-string-interpolation/50095693#50095693", "title": "Go string interpolation", "body": "<p><a href=\"https://golang.org/pkg/fmt/#Sprintln\" rel=\"nofollow noreferrer\"><code>fmt.Sprintln</code></a> <em>returns</em> the expanded first argument.</p>\n"}, {"tags": [], "owner": {"reputation": 1917, "user_id": 6401895, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e169f96fa9c3c6a770dd828e3319263a?s=128&d=identicon&r=PG", "display_name": "Ivan Beldad", "link": "https://stackoverflow.com/users/6401895/ivan-beldad"}, "is_accepted": false, "score": 2, "last_activity_date": 1525072773, "creation_date": 1525072773, "answer_id": 50095711, "question_id": 50095616, "link": "https://stackoverflow.com/questions/50095616/go-string-interpolation/50095711#50095711", "title": "Go string interpolation", "body": "<blockquote>\n  <p>Sprintln formats using the default formats for its operands and returns the resulting string. Spaces are always added between operands and a newline is appended.</p>\n</blockquote>\n\n<p><code>Sprint</code> format a string and returns such a string, it does write nothing. What you're searching for is <code>Print</code></p>\n\n<p>Furthermore, the variant <code>ln</code> doesn't parse <code>%</code>, it only add the new line character at the end of the string.</p>\n\n<p>So, if you want to write to standard output using format, you should use this:</p>\n\n<pre><code>fmt.Printf(\"inc 1 equal %v\", inc(1))\n</code></pre>\n"}], "owner": {"reputation": 18463, "user_id": 3189923, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/5d3122866199817cdf56b96a788d406f?s=128&d=identicon&r=PG&f=1", "display_name": "elm", "link": "https://stackoverflow.com/users/3189923/elm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9634, "favorite_count": 0, "accepted_answer_id": 50095683, "answer_count": 3, "score": 4, "last_activity_date": 1525086550, "creation_date": 1525072420, "last_edit_date": 1525086550, "question_id": 50095616, "link": "https://stackoverflow.com/questions/50095616/go-string-interpolation", "title": "Go string interpolation", "body": "<p>Trying to interpolate an <code>int</code> value into a string using <code>%v</code> formatter as follows, yet nothing is printed,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc inc(i int) int {\n  return i + 1\n}\n\nfunc main() {\n  fmt.Sprintln(\"inc 1 equal %v\", inc(1))\n}\n</code></pre>\n\n<p>How to interpolate an <code>int</code> value ?</p>\n"}, {"tags": ["json", "go", "struct", "interface"], "comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1525070008, "post_id": 50094483, "comment_id": 87206249, "body": "A better way is to create a struct with embedded struct in each local package"}, {"owner": {"reputation": 415, "user_id": 9661066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DKIYpno_RaE/AAAAAAAAAAI/AAAAAAAAAAA/784Fv4xgNp8/photo.jpg?sz=128", "display_name": "GilesW", "link": "https://stackoverflow.com/users/9661066/gilesw"}, "edited": false, "score": 0, "creation_date": 1525073160, "post_id": 50094483, "comment_id": 87207718, "body": "Can you edit to explain better what you want to achieve? The struct conversion seems like not a big deal and you can simplify by just typecasting: balance = apiinterface.Balance(tmpBalance). Is the problem that you have to repeate the GetBalance() code in each library?"}, {"owner": {"reputation": 11, "user_id": 2407235, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VigHK.jpg?s=128&g=1", "display_name": "lixid", "link": "https://stackoverflow.com/users/2407235/lixid"}, "edited": false, "score": 0, "creation_date": 1525124076, "post_id": 50094483, "comment_id": 87234379, "body": "I would like a way to get rid of the Balance struct in each library and keep the global interface version of Balance. The two Balance structs in each library is a duplication of code and I would like to keep things clean and to keep things more uniform to the interface. I am just wondering if there is a different way I can unmarshal to a struct which doesn&#39;t necessarily have the same json structure."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 2407235, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VigHK.jpg?s=128&g=1", "display_name": "lixid", "link": "https://stackoverflow.com/users/2407235/lixid"}, "edited": false, "score": 0, "creation_date": 1525124138, "post_id": 50095364, "comment_id": 87234400, "body": "This would create a dependency loop because I would have to do an import of each library to the interface."}, {"owner": {"reputation": 11, "user_id": 2407235, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VigHK.jpg?s=128&g=1", "display_name": "lixid", "link": "https://stackoverflow.com/users/2407235/lixid"}, "edited": false, "score": 0, "creation_date": 1525212046, "post_id": 50095364, "comment_id": 87266999, "body": "cannot load package: import cycle not allowed.. but if I was to move the Balance1 and Balance2 structs over to the interface package similar to your example then I would need to create a balance struct for each library struct type which in turn is redundant in a similar way to what I am using now. It is a good suggestion though. Just not what I am looking for. I am trying to somehow use one struct  and adapt for each library in the interface package to minimize redundancy and maintenance for further library integrations."}], "tags": [], "owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "is_accepted": false, "score": 0, "last_activity_date": 1525071305, "creation_date": 1525071305, "answer_id": 50095364, "question_id": 50094483, "link": "https://stackoverflow.com/questions/50094483/1-interface-2-packages-same-struct-variable-names-but-different-json-naming-co/50095364#50095364", "title": "1 interface, 2 packages, same struct variable names but different json naming conventions", "body": "<p>you can try somthing like this:</p>\n\n<pre><code>type Balance struct {\n    *Balance1\n    *Balance2\n}\n</code></pre>\n\n<p>and then check them with nil, then cast the not nil one to your interface</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 2407235, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VigHK.jpg?s=128&g=1", "display_name": "lixid", "link": "https://stackoverflow.com/users/2407235/lixid"}, "edited": false, "score": 0, "creation_date": 1525212293, "post_id": 50110346, "comment_id": 87267107, "body": "This is a really good suggestion to allow further adaptation. I will try this tonight and see if I can get it to work in a more universal manner."}], "tags": [], "owner": {"reputation": 27119, "user_id": 8753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NLxHO.jpg?s=128&g=1", "display_name": "laz", "link": "https://stackoverflow.com/users/8753/laz"}, "is_accepted": true, "score": 0, "last_activity_date": 1525138622, "creation_date": 1525138622, "answer_id": 50110346, "question_id": 50094483, "link": "https://stackoverflow.com/questions/50094483/1-interface-2-packages-same-struct-variable-names-but-different-json-naming-co/50110346#50110346", "title": "1 interface, 2 packages, same struct variable names but different json naming conventions", "body": "<p>See if something like this does what you need:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype jsonResponse struct {\n    Success bool    `json:\"success\"`\n    Message string  `json:\"message\"`\n    Result  Balance `json:\"result\"`\n}\n\ntype Balance struct {\n    Available   float64\n    Unconfirmed float64\n}\n\nfunc (b *Balance) UnmarshalJSON(data []byte) error {\n    m := map[string]float64{}\n    if err := json.Unmarshal(data, &amp;m); err != nil {\n        return err\n    }\n\n    for k, v := range m {\n        if k == \"available\" || k == \"total\" {\n            b.Available = v\n        } else if k == \"unconfirmed\" || k == \"pending\" {\n            b.Unconfirmed = v\n        }\n    }\n\n    return nil\n}\n\nfunc main() {\n    tests := []string{\n        `{\"success\":true,\"message\":\"first\",\"result\":{\"available\":42.42,\"unconfirmed\":0.88}}`,\n        `{\"success\":true,\"message\":\"second\",\"result\":{\"total\":3.14,\"pending\":0.42}}`,\n    }\n\n    for _, t := range tests {\n        resp := jsonResponse{}\n        if err := json.Unmarshal([]byte(t), &amp;resp); err != nil {\n            panic(err)\n        }\n        fmt.Printf(\"%+v\\n\", resp)\n    }\n\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/ssxfeniN5s0\" rel=\"nofollow noreferrer\" title=\"playground example\">playground</a></p>\n"}], "owner": {"reputation": 11, "user_id": 2407235, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VigHK.jpg?s=128&g=1", "display_name": "lixid", "link": "https://stackoverflow.com/users/2407235/lixid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 50110346, "answer_count": 2, "score": 0, "last_activity_date": 1525138622, "creation_date": 1525066482, "last_edit_date": 1525071928, "question_id": 50094483, "link": "https://stackoverflow.com/questions/50094483/1-interface-2-packages-same-struct-variable-names-but-different-json-naming-co", "title": "1 interface, 2 packages, same struct variable names but different json naming conventions", "body": "<p>I am wondering if it is possible in the below scenario to be able to remove the two \"Balance\" structs in each package and just use the interface based \"Balance\" struct somehow for unmarshalling. The issue that I have is that the json structure that comes back from the individual api's for Balance is different so as of right now I am just converting the local Balance structs into the global interface based Balance struct and returning that. This method is not ideal especially for more complex but very similar functions that I have. I am sure there is a better way to do this but could not find anything similar. Thanks in advance. </p>\n\n<pre><code>//******************** API Inteface *****************************\n//API Interface path: /global/interfaces/apiinterface/apiinterface.go &amp;&amp; structs.go\n// /global/interfaces/apiinterface/apiinterface.go\ntype APIInterface interface {\n    //.... other interface func(s)\n    GetBalance(account string) (balance Balance, err error)\n}\n// /global/interfaces/apiinterface/structs.go\ntype Balance struct{\n    Available       float64\n    Unconfirmed     float64\n}\n\n\n//******************** Library 1 *****************************\n//Library 1 path: /library1/library1.go\n\ntype jsonResponse struct {\n    Success bool            `json:\"success\"`\n    Message string          `json:\"message\"`\n    Result  json.RawMessage `json:\"result\"`\n}\n//Library 1 Balance struct /library1/structs.go\ntype Balance struct {\n    Available       float64   `json:\"available\"` //json name difference &lt;----------\n    Unconfirmed     float64   `json:\"unconfirmed\"` //json name difference &lt;----------\n}\n//Library 1 GetBalance /library1/library1.go\nfunc (c *Library1) GetBalance(account string) (balance apiinterface.Balance, err error) {\n\n    r, err := c.client.do(\"getbalance\", []interface{}{account})\n    if err != nil {\n        return\n    }\n    var response jsonResponse\n    if err = json.Unmarshal(r, &amp;response); err != nil {\n        return\n    }\n    var tmpBalance Balance //library 1 Balance struct\n    err = json.Unmarshal(response.Result, &amp;tmpBalance)\n    if err != nil{\n        return\n    }\n    //convert to global apiinterface struct\n    balance = apiinterface.Balance{\n        Available:tmpBalance.Available,\n        Unconfirmed:tmpBalance.Unconfirmed,\n    }\n\n    return\n}\n\n//******************** Library 2 *****************************\n//Library 2 path: /library2/library2.go\n\ntype jsonResponse struct {\n    Success bool            `json:\"success\"`\n    Message string          `json:\"message\"`\n    Result  json.RawMessage `json:\"result\"`\n}\n//Library 2 Balance struct\ntype Balance struct {\n    Available       float64   `json:\"total\"` //json name difference &lt;----------\n    Unconfirmed     float64   `json:\"pending\"` //json name difference &lt;----------\n}\n//Library 2 GetBalance\nfunc (c *Library2) GetBalance(account string) (balance apiinterface.Balance, err error) {\n\n    r, err := c.client.do(\"getbalance\", []interface{}{account})\n    if err != nil {\n        return\n    }\n    var response jsonResponse\n    if err = json.Unmarshal(r, &amp;response); err != nil {\n        return\n    }\n    var tmpBalance Balance //library 2 Balance struct\n    err = json.Unmarshal(response.Result, &amp;tmpBalance)\n    if err != nil{\n        return\n    }\n    //convert to global apiinterface struct\n    balance = apiinterface.Balance{\n        Available:tmpBalance.Available,\n        Unconfirmed:tmpBalance.Unconfirmed,\n    }\n\n    return\n}\n</code></pre>\n"}, {"tags": ["variables", "go", "scope", "compiler-errors"], "comments": [{"owner": {"reputation": 983, "user_id": 7059119, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209343272591927/picture?type=large", "display_name": "Aristofanio Garcia", "link": "https://stackoverflow.com/users/7059119/aristofanio-garcia"}, "edited": false, "score": 0, "creation_date": 1525063224, "post_id": 50093849, "comment_id": 87204134, "body": "In go, if you declare variable then must be used."}, {"owner": {"reputation": 983, "user_id": 7059119, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209343272591927/picture?type=large", "display_name": "Aristofanio Garcia", "link": "https://stackoverflow.com/users/7059119/aristofanio-garcia"}, "edited": false, "score": 0, "creation_date": 1525063249, "post_id": 50093849, "comment_id": 87204138, "body": "See these options op1 and op2: <a href=\"https://play.golang.org/p/z3PlcAIrd4e\" rel=\"nofollow noreferrer\">play.golang.org/p/z3PlcAIrd4e</a>"}], "answers": [{"tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": true, "score": 8, "last_activity_date": 1525115344, "last_edit_date": 1525115344, "creation_date": 1525063255, "answer_id": 50094066, "question_id": 50093849, "link": "https://stackoverflow.com/questions/50093849/golang-undefined-err/50094066#50094066", "title": "Golang undefined: err", "body": "<p>You declare <code>err</code>:</p>\n\n<pre><code>var err error\n</code></pre>\n\n<p>and then you assign something to it:</p>\n\n<pre><code>numVar,err=strconv.ParseInt(numStr,10,64)\n</code></pre>\n\n<p>but then you don't look at <code>err</code> or access it. Just assigning something a value doesn't count as using it, you have to look at <code>err</code>:</p>\n\n<pre><code>numVar,err=strconv.ParseInt(numStr,10,64)\nif err != nil {\n  // Complain or something here\n}\n</code></pre>\n\n<p>If you really don't want to bother with the error, then say so by using the blank identifier:</p>\n\n<pre><code>numVar, _ = strconv.ParseInt(numStr, 10, 64)\n</code></pre>\n"}], "owner": {"reputation": 1175, "user_id": 7431823, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c2bc4ebc0f6c8d63fbe39f0b7c50d6e8?s=128&d=identicon&r=PG&f=1", "display_name": "TechEnthusiast", "link": "https://stackoverflow.com/users/7431823/techenthusiast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4224, "favorite_count": 2, "accepted_answer_id": 50094066, "answer_count": 1, "score": 1, "last_activity_date": 1525115344, "creation_date": 1525061554, "last_edit_date": 1525071945, "question_id": 50093849, "link": "https://stackoverflow.com/questions/50093849/golang-undefined-err", "title": "Golang undefined: err", "body": "<p>I am trying out the simple following conversion program.</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"strconv\"\n)\n\nfunc main(){\n  var numStr string=\"2213\"\n  var numVar int64\n  numVar,err=strconv.ParseInt(numStr,10,64)\n  fmt.Println(numVar)\n}\n</code></pre>\n\n<p>The above throws the following compilation error.</p>\n\n<pre><code>undefined: err\n</code></pre>\n\n<p>Then I tried to define the err, error variable. </p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"strconv\"\n)\n\nfunc main(){\n  var numStr string=\"2213\"\n  var numVar int64\n  var err error\n  numVar,err=strconv.ParseInt(numStr,10,64)\n  fmt.Println(numVar)\n}\n</code></pre>\n\n<p>But then the compiler throws the following error this time.</p>\n\n<pre><code>err declared and not used\n</code></pre>\n\n<p>I referred to the following stackoverflow question <a href=\"https://stackoverflow.com/questions/32628568/undefined-err-variable\">Undefined err variable</a> but did not get complete understanding of the behavior and hence asking the question here.</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 1917, "user_id": 6401895, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e169f96fa9c3c6a770dd828e3319263a?s=128&d=identicon&r=PG", "display_name": "Ivan Beldad", "link": "https://stackoverflow.com/users/6401895/ivan-beldad"}, "edited": false, "score": 0, "creation_date": 1525059343, "post_id": 50093391, "comment_id": 87203293, "body": "You&#39;re wanted output is really strange. Are you sure you wrote it right?"}, {"owner": {"reputation": 119, "user_id": 9206463, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nVBbGVWQQmM/AAAAAAAAAAI/AAAAAAAAAGs/dwqb1xlREfE/photo.jpg?sz=128", "display_name": "yosi madsu", "link": "https://stackoverflow.com/users/9206463/yosi-madsu"}, "reply_to_user": {"reputation": 1917, "user_id": 6401895, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e169f96fa9c3c6a770dd828e3319263a?s=128&d=identicon&r=PG", "display_name": "Ivan Beldad", "link": "https://stackoverflow.com/users/6401895/ivan-beldad"}, "edited": false, "score": 0, "creation_date": 1525059574, "post_id": 50093391, "comment_id": 87203341, "body": "Yes. It is form of <code>[[{full string match} {substring1} {substring2}]]</code>"}, {"owner": {"reputation": 983, "user_id": 7059119, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209343272591927/picture?type=large", "display_name": "Aristofanio Garcia", "link": "https://stackoverflow.com/users/7059119/aristofanio-garcia"}, "edited": false, "score": 0, "creation_date": 1525062798, "post_id": 50093391, "comment_id": 87204034, "body": "Please check if help you: <a href=\"https://play.golang.org/p/z7hzIQjvNID\" rel=\"nofollow noreferrer\">play.golang.org/p/z7hzIQjvNID</a>"}], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 9206463, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nVBbGVWQQmM/AAAAAAAAAAI/AAAAAAAAAGs/dwqb1xlREfE/photo.jpg?sz=128", "display_name": "yosi madsu", "link": "https://stackoverflow.com/users/9206463/yosi-madsu"}, "is_accepted": false, "score": -1, "last_activity_date": 1525059465, "creation_date": 1525059465, "answer_id": 50093602, "question_id": 50093391, "link": "https://stackoverflow.com/questions/50093391/findallstringsubmatch-in-long-string/50093602#50093602", "title": "FindAllStringSubmatch in long string", "body": "<p>This <a href=\"https://stackoverflow.com/questions/40586313/get-all-substrings-inside-parentheses-in-golang-regexp\">question</a> is different, but the answer is fit to my problem.</p>\n\n<p>I replace the <code>(.+)</code> with <code>([^\\&lt;]+)</code> so the final line</p>\n\n<pre><code> re := regexp.MustCompile(`ue='([0-9]+)'\\&gt;([^\\&lt;]+)\\&lt;`)\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 9206463, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nVBbGVWQQmM/AAAAAAAAAAI/AAAAAAAAAGs/dwqb1xlREfE/photo.jpg?sz=128", "display_name": "yosi madsu", "link": "https://stackoverflow.com/users/9206463/yosi-madsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1525071966, "creation_date": 1525056993, "last_edit_date": 1525071966, "question_id": 50093391, "link": "https://stackoverflow.com/questions/50093391/findallstringsubmatch-in-long-string", "title": "FindAllStringSubmatch in long string", "body": "<p>I have long search string (cutout):</p>\n\n<pre><code>s := `&lt;option value='1'&gt;Name A&lt;/option&gt;&lt;option value='2'&gt;Name B&lt;/option&gt;&lt;option value='3'&gt;Name C&lt;/option&gt;&lt;option value='4'&gt;Name D&lt;/option&gt;&lt;option value='5'&gt;Name E&lt;/option&gt;&lt;option value='6'&gt;Name F&lt;/option&gt;&lt;option value='7'&gt;Name G&lt;/option&gt;`\n</code></pre>\n\n<p>And I want to search for the value and the name:</p>\n\n<pre><code>re := regexp.MustCompile(`ue='([0-9]+)'\\&gt;(.+)\\&lt;/o`)\narr := re.FindAllStringSubmatch(s, -1)\n</code></pre>\n\n<p>Instead of returning the value I need, the function returns</p>\n\n<pre><code>[[ue='1'&gt;Name A&lt;/option&gt;&lt;option value='2'&gt;Name B&lt;/option&gt;&lt;option value='3'&gt;Name C&lt;/option&gt;&lt;option value='4'&gt;Name D&lt;/option&gt;&lt;option value='5'&gt;Name E&lt;/option&gt;&lt;option value='6'&gt;Name F&lt;/option&gt;&lt;option value='7'&gt;Name G&lt;/o 1 Name A&lt;/option&gt;&lt;option value='2'&gt;Name B&lt;/option&gt;&lt;option value='3'&gt;Name C&lt;/option&gt;&lt;option value='4'&gt;Name D&lt;/option&gt;&lt;option value='5'&gt;Name E&lt;/option&gt;&lt;option value='6'&gt;Name F&lt;/option&gt;&lt;option value='7'&gt;Name G]]\n</code></pre>\n\n<p>Please help so it returns more like</p>\n\n<pre><code>[[ue='1'&gt;Name A&lt;/o 1 Name A][ue='2'&gt;Name B&lt;/o 2 Name B][... etc\n</code></pre>\n\n<p>I checked the culprit is around (.+), but it always failed to return the expected one, its expanded to the end of the string.</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1525046917, "post_id": 50092462, "comment_id": 87201166, "body": "So what type should your final <code>DisplayName</code> be?"}, {"owner": {"reputation": 117184, "user_id": 9473764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aGMXl.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9473764/nick"}, "edited": false, "score": 0, "creation_date": 1525047629, "post_id": 50092462, "comment_id": 87201297, "body": "If you can&#39;t control the JSON you might need to Unmarshal into an interface: <a href=\"https://blog.golang.org/json-and-go\" rel=\"nofollow noreferrer\">blog.golang.org/json-and-go</a> (check out the section under decoding arbitrary data)"}, {"owner": {"reputation": 91, "user_id": 9193147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eb21d4158dcdec4c0c2b119ed0e820e?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/9193147/john-f"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1525048416, "post_id": 50092462, "comment_id": 87201454, "body": "@zerkms I will concatenate any DisplayName arrays to be a string joined with &#39;&amp;&#39; character"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1525072142, "post_id": 50092462, "comment_id": 87207243, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/29347092/how-to-parse-deserlize-a-dynamic-json-in-golang\">How to parse/deserlize a dynamic JSON in Golang</a>"}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 9193147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eb21d4158dcdec4c0c2b119ed0e820e?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/9193147/john-f"}, "edited": false, "score": 0, "creation_date": 1525051095, "post_id": 50092659, "comment_id": 87201918, "body": "Thanks @ThunderCat that did the trick. Very useful to know about json.Rawmessage"}, {"owner": {"reputation": 27119, "user_id": 8753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NLxHO.jpg?s=128&g=1", "display_name": "laz", "link": "https://stackoverflow.com/users/8753/laz"}, "edited": false, "score": 0, "creation_date": 1525135874, "post_id": 50092659, "comment_id": 87237429, "body": "You can make this more self-contained by having MyListItem provide an implementation of <code>UnmarshalJSON</code>: <a href=\"https://play.golang.org/p/vXFwQBhYQvR\" rel=\"nofollow noreferrer\">play.golang.org/p/vXFwQBhYQvR</a>"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 7, "last_activity_date": 1606958859, "last_edit_date": 1606958859, "creation_date": 1525048752, "answer_id": 50092659, "question_id": 50092462, "link": "https://stackoverflow.com/questions/50092462/how-to-unmarshal-an-inconsistent-json-field-that-can-be-a-string-or-an-array-o/50092659#50092659", "title": "How to Unmarshal an inconsistent JSON field that can be a string *or* an array of string?", "body": "<p>Use <a href=\"https://godoc.org/encoding/json#RawMessage\" rel=\"nofollow noreferrer\">json.RawMessage</a> to capture the varying field.</p>\n<p>Use the json &quot;-&quot; name to hide the <code>DisplayName</code> field from decoder. The application will fill this field after the top-level JSON is decoded.</p>\n<pre><code>type MyListItem struct {\n    Date           string          `json:&quot;date&quot;`\n    RawDisplayName json.RawMessage `json:&quot;display_name&quot;`\n    DisplayName    []string        `json:&quot;-&quot;`\n}\n</code></pre>\n<p>Unmarshal the top-level JSON:</p>\n<pre><code>var li MyListItem\nif err := json.Unmarshal(data, &amp;li); err != nil {\n    // handle error\n}\n</code></pre>\n<p>Unmarshal the display name depending on the type of the raw data:</p>\n<pre><code>if len(li.RawDisplayName) &gt; 0 {\n    switch li.RawDisplayName[0] {\n    case '&quot;':\n        if err := json.Unmarshal(li.RawDisplayName, &amp;li.DisplayName); err != nil {\n            // handle error\n        }\n    case '[':\n        var s []string\n        if err := json.Unmarshal(li.RawDisplayName, &amp;s); err != nil {\n            // handle error\n        }\n        // Join arrays with &quot;&amp;&quot; per OP's comment on the question.\n        li.DisplayName = strings.Join(s, &quot;&amp;&quot;)\n    }\n}\n</code></pre>\n<p><a href=\"https://play.golang.org/p/wuebjjMt3f3\" rel=\"nofollow noreferrer\">playground example</a></p>\n<p>Incorporate the above into a for loop to handle <code>MyListings</code>:</p>\n<pre><code>var listings MyListings\nif err := json.Unmarshal([]byte(data), &amp;listings); err != nil {\n    // handle error\n}\nfor i := range listings.CLItems {\n    li := &amp;listings.CLItems[i]\n    if len(li.RawDisplayName) &gt; 0 {\n        switch li.RawDisplayName[0] {\n        case '&quot;':\n            if err := json.Unmarshal(li.RawDisplayName, &amp;li.DisplayName); err != nil {\n                // handle error\n            }\n        case '[':\n            var s []string\n            if err := json.Unmarshal(li.RawDisplayName, &amp;s); err != nil {\n                // handle error\n            }\n            li.DisplayName = strings.Join(s, &quot;&amp;&quot;)\n        }\n    }\n}\n</code></pre>\n<p><a href=\"https://play.golang.org/p/zj_x65fw8qv\" rel=\"nofollow noreferrer\">playground example</a></p>\n<p>If there's more than one place in the data model where a value can be a string or []string, it can be helpful to encapsulate the logic in a type. Parse the JSON data in an implementation of the <a href=\"https://godoc.org/encoding/json#Unmarshaler\" rel=\"nofollow noreferrer\">json.Unmarshaler</a> interface.</p>\n<pre><code>type multiString string\n\nfunc (ms *multiString) UnmarshalJSON(data []byte) error {\n    if len(data) &gt; 0 {\n        switch data[0] {\n        case '&quot;':\n            var s string\n            if err := json.Unmarshal(data, &amp;s); err != nil {\n                return err\n            }\n            *ms = multiString(s)\n        case '[':\n            var s []string\n            if err := json.Unmarshal(data, &amp;s); err != nil {\n                return err\n            }\n            *ms = multiString(strings.Join(s, &quot;&amp;&quot;))\n        }\n    }\n    return nil\n}\n</code></pre>\n<p>Use it like this:</p>\n<pre><code>type MyListItem struct {\n    Date        string      `json:&quot;date&quot;`\n    DisplayName multiString `json:&quot;display_name&quot;`\n}\n\ntype MyListings struct {\n    CLItems []MyListItem `json:&quot;myitems&quot;`\n}\n\nvar listings MyListings\nif err := json.Unmarshal([]byte(data), &amp;listings); err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n<p><a href=\"https://play.golang.org/p/-nuVjhE3uKP\" rel=\"nofollow noreferrer\">Playground Example</a></p>\n<p>Here's the code to get the value as a slice of strings instead of as a single string with values joined by &amp;.</p>\n<pre><code>type multiString []string\n\nfunc (ms *multiString) UnmarshalJSON(data []byte) error {\n    if len(data) &gt; 0 {\n        switch data[0] {\n        case '&quot;':\n            var s string\n            if err := json.Unmarshal(data, &amp;s); err != nil {\n                return err\n            }\n            *ms = multiString{s}\n        case '[':\n            if err := json.Unmarshal(data, (*[]string)(ms)); err != nil {\n                return err\n            }\n        }\n    }\n    return nil\n}\n</code></pre>\n<p><a href=\"https://play.golang.org/p/5Fdgtz7lXAg\" rel=\"nofollow noreferrer\">Playground example</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 27119, "user_id": 8753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NLxHO.jpg?s=128&g=1", "display_name": "laz", "link": "https://stackoverflow.com/users/8753/laz"}, "is_accepted": false, "score": 5, "last_activity_date": 1525136901, "creation_date": 1525136901, "answer_id": 50110186, "question_id": 50092462, "link": "https://stackoverflow.com/questions/50092462/how-to-unmarshal-an-inconsistent-json-field-that-can-be-a-string-or-an-array-o/50110186#50110186", "title": "How to Unmarshal an inconsistent JSON field that can be a string *or* an array of string?", "body": "<p>As an alternative, this builds off of the answer from @ThunderCat but instead of using <code>json.RawMessage</code>, uses <code>interface{}</code> and a type switch:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n)\n\ntype MyListItem struct {\n    Date           string      `json:\"date\"`\n    DisplayName    string      `json:\"-\"`\n    RawDisplayName interface{} `json:\"display_name\"`\n}\n\nfunc (li *MyListItem) UnmarshalJSON(data []byte) error {\n    type localItem MyListItem\n    var loc localItem\n    if err := json.Unmarshal(data, &amp;loc); err != nil {\n        return err\n    }\n    *li = MyListItem(loc)\n    switch li.RawDisplayName.(type) {\n    case string:\n        li.DisplayName = li.RawDisplayName.(string)\n    case []interface{}:\n        vals := li.RawDisplayName.([]interface{})\n        if len(vals) &gt; 0 {\n            li.DisplayName, _ = vals[0].(string)\n            for _, v := range vals[1:] {\n                li.DisplayName += \"&amp;\" + v.(string)\n            }\n        }\n    }\n    return nil\n}\n\nfunc test(data string) {\n    var li MyListItem\n    if err := json.Unmarshal([]byte(data), &amp;li); err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(li.DisplayName)\n}\n\nfunc main() {\n    test(`\n{       \n    \"date\": \"30 Apr\",\n    \"display_name\": \"Mr Smith\"\n}`)\n\n    test(`\n{\n    \"date\": \"30 Apr\",\n    \"display_name\": [\"Mr Smith\", \"Mr Jones\"]\n}`)\n\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/39QPJTnhiRg\" rel=\"noreferrer\" title=\"playground example\">playground</a></p>\n"}], "owner": {"reputation": 91, "user_id": 9193147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eb21d4158dcdec4c0c2b119ed0e820e?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/9193147/john-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3736, "favorite_count": 0, "accepted_answer_id": 50092659, "answer_count": 2, "score": 5, "last_activity_date": 1606958859, "creation_date": 1525046525, "last_edit_date": 1525047115, "question_id": 50092462, "link": "https://stackoverflow.com/questions/50092462/how-to-unmarshal-an-inconsistent-json-field-that-can-be-a-string-or-an-array-o", "title": "How to Unmarshal an inconsistent JSON field that can be a string *or* an array of string?", "body": "<p>I am having trouble Unmarshalling some Json I don't have control over.\nThere is one field that 99% of the time is a string but occasionally is an array.</p>\n\n<pre><code>type MyListItem struct {\n    Date  string `json:\"date\"`\n    DisplayName       string `json:\"display_name\"`\n}\n\ntype MyListings struct {\n    CLItems []MyListItem `json:\"myitems\"`\n}\n\nvar mylist MyListings\nerr = json.Unmarshal(jsn, &amp;mylist)\nif err != nil {\n    fmt.Print(\"JSON:\\n%s\\n error:%v\\n\", string(jsn),err)\n    return\n}\n</code></pre>\n\n<p>Json is as follows:</p>\n\n<pre><code>{       \n    \"date\": \"30 Apr\",\n    \"display_name\": \"Mr Smith\"\n},\n{\n    \"date\": \"30 Apr\",\n    \"display_name\": [\"Mr Smith\", \"Mr Jones\"],\n}\n</code></pre>\n\n<p>error: json: cannot unmarshal array into Go struct field MyListItem.display_name of type string</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 13, "creation_date": 1525040533, "post_id": 50091861, "comment_id": 87199890, "body": "If opening a file fails, there is nothing to close"}], "answers": [{"tags": [], "owner": {"reputation": 415, "user_id": 9661066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DKIYpno_RaE/AAAAAAAAAAI/AAAAAAAAAAA/784Fv4xgNp8/photo.jpg?sz=128", "display_name": "GilesW", "link": "https://stackoverflow.com/users/9661066/gilesw"}, "is_accepted": false, "score": 1, "last_activity_date": 1525074806, "creation_date": 1525074806, "answer_id": 50096182, "question_id": 50091861, "link": "https://stackoverflow.com/questions/50091861/placement-of-defer-after-error-check/50096182#50096182", "title": "Placement of defer after error check", "body": "<p>If the file <code>Open</code> or <code>Create</code> fails then you don't have a valid <code>*File</code> to close. The problem wouldn't be a <code>nil</code> value for <code>*File</code> as <code>Close</code>() will check for <code>nil</code> and simply return immediately in that case - the problem might be if the <code>*File</code> value is non-nil but invalid. Since documentation for  <code>os.Open()</code> doesn't explicitly state that a failed call to <code>Open()</code> returns a nil value for <code>*File</code> you can't rely that all underlying implementations of it do in fact return a nil value or will always return a nil value..</p>\n"}], "owner": {"reputation": 927, "user_id": 2419669, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/kuQAn.jpg?s=128&g=1", "display_name": "yangmillstheory", "link": "https://stackoverflow.com/users/2419669/yangmillstheory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1525074806, "creation_date": 1525040462, "question_id": 50091861, "link": "https://stackoverflow.com/questions/50091861/placement-of-defer-after-error-check", "title": "Placement of defer after error check", "body": "<p>In Go, one often sees the following idiom:</p>\n\n<pre><code>func CopyFile(dstName, srcName string) (written int64, err error) {\n    src, err := os.Open(srcName)\n    if err != nil {\n        return\n    }\n    defer src.Close()\n\n    dst, err := os.Create(dstName)\n    if err != nil {\n        return\n    }\n    defer dst.Close()\n\n    return io.Copy(dst, src)\n}\n</code></pre>\n\n<p>Is there any reason why the <code>defer</code> statement comes after the error check? My guess is that this is done in order to avoid dereferencing <code>nil</code> values in case <code>err</code> was not <code>nil</code>.</p>\n"}, {"tags": ["amazon-web-services", "go", "raspberry-pi3", "raspbian", "amazon-ecs"], "comments": [{"owner": {"reputation": 26589, "user_id": 1032785, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/30816b3d787c2bd9d6f036318304f225?s=128&d=identicon&r=PG", "display_name": "jordanm", "link": "https://stackoverflow.com/users/1032785/jordanm"}, "edited": false, "score": 0, "creation_date": 1525029035, "post_id": 50089659, "comment_id": 87196734, "body": "Yes, instead of the manual cloning, you should have been able to just run <code>go get github.com&#47;aws&#47;amazon-ecs-cli</code>"}, {"owner": {"reputation": 10865, "user_id": 2933977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25308d33862d9b72e0b93160b1fd778c?s=128&d=identicon&r=PG", "display_name": "stdunbar", "link": "https://stackoverflow.com/users/2933977/stdunbar"}, "edited": false, "score": 0, "creation_date": 1525031618, "post_id": 50089659, "comment_id": 87197483, "body": "Do you need to use <code>ecs-cli</code>?  The <a href=\"https://aws.amazon.com/cli/\" rel=\"nofollow noreferrer\">AWS cli</a> only has a dependency on Python and is cross platform out of the box.  There are <a href=\"https://docs.aws.amazon.com/cli/latest/reference/ecs/index.html\" rel=\"nofollow noreferrer\">ECS</a> and <a href=\"https://docs.aws.amazon.com/cli/latest/reference/ecr/index.html\" rel=\"nofollow noreferrer\">ECR</a> commands that should replicate much of the same functionality."}, {"owner": {"reputation": 98, "user_id": 2624403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f42228ee7997b8f996b202da164a2a?s=128&d=identicon&r=PG", "display_name": "Otto M.", "link": "https://stackoverflow.com/users/2624403/otto-m"}, "reply_to_user": {"reputation": 26589, "user_id": 1032785, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/30816b3d787c2bd9d6f036318304f225?s=128&d=identicon&r=PG", "display_name": "jordanm", "link": "https://stackoverflow.com/users/1032785/jordanm"}, "edited": false, "score": 0, "creation_date": 1525077395, "post_id": 50089659, "comment_id": 87209733, "body": "Thank you @jordanm, this will help to avoid error when trying to compile  from wrong location."}, {"owner": {"reputation": 98, "user_id": 2624403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f42228ee7997b8f996b202da164a2a?s=128&d=identicon&r=PG", "display_name": "Otto M.", "link": "https://stackoverflow.com/users/2624403/otto-m"}, "reply_to_user": {"reputation": 10865, "user_id": 2933977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25308d33862d9b72e0b93160b1fd778c?s=128&d=identicon&r=PG", "display_name": "stdunbar", "link": "https://stackoverflow.com/users/2933977/stdunbar"}, "edited": false, "score": 0, "creation_date": 1525077535, "post_id": 50089659, "comment_id": 87209833, "body": "@stdunbar thank you for suggestion, what would be the pure AWS cli equivalent is question I&#39;m posting here: <a href=\"https://stackoverflow.com/questions/50096776/how-to-scale-down-up-containers-in-aws-ecs-cluster-by-command-line-should-i-use\" title=\"how to scale down up containers in aws ecs cluster by command line should i use\">stackoverflow.com/questions/50096776/&hellip;</a>"}], "owner": {"reputation": 98, "user_id": 2624403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f42228ee7997b8f996b202da164a2a?s=128&d=identicon&r=PG", "display_name": "Otto M.", "link": "https://stackoverflow.com/users/2624403/otto-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 443, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1525024708, "creation_date": 1525024708, "question_id": 50089659, "link": "https://stackoverflow.com/questions/50089659/how-to-run-aws-ecs-cli-on-raspbian-os-raspberry-pi-3-b", "title": "How to run AWS ecs-cli on Raspbian OS - Raspberry Pi 3 B+", "body": "<p>I'm running Raspbian OS on Raspberry Pi 3 B+ and I'm trying to use it together with AWS ecs-cli to control my ECS containers by scaling them down and up. I'm planing to use Lambda in future, but as of now I'm trying to keep low metrics on CloudWatch to stay on free tier and do not get charged(separate topic).</p>\n\n<p>I tried to install ecs-cli as per AWS guidance for Linux <a href=\"https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ECS_CLI_installation.html\" rel=\"nofollow noreferrer\">here</a> </p>\n\n<pre><code>$ sudo curl -o /usr/local/bin/ecs-cli https://s3.amazonaws.com/amazon-ecs-cli/ecs-cli-linux-amd64-latest\n$ sudo chmod +x /usr/local/bin/ecs-cli\n$ ecs-cli\n</code></pre>\n\n<p>Obviously because the binary is for x86-64 OS I've got an error:</p>\n\n<blockquote>\n  <p>-bash: /usr/local/bin/ecs-cli: cannot execute binary file: Exec format error</p>\n</blockquote>\n\n<p>Further check of the file suggests that ecs-cli is not compiled in architecture for raspbian:</p>\n\n<pre><code>$ file ecs-cli\necs-cli: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, stripped\n$ dpkg --print-architecture\narmhf\n</code></pre>\n\n<p>I tried google around to find armhf compilation of ecs-cli, unfortunately without luck. Any idea?</p>\n\n<p>I found source code of ecs-cli on <a href=\"https://github.com/aws/amazon-ecs-cli\" rel=\"nofollow noreferrer\">GitHub</a>, so I tried to clone it and compile. </p>\n\n<pre><code>$ pwd\n/home/pi\n$ git clone https://github.com/aws/amazon-ecs-cli.git\nCloning into 'amazon-ecs-cli'...\n..., done.\n$ cd amazon-ecs-cli\n$ make\n./scripts/build_binary.sh ./bin/local\n./scripts/build_binary.sh: line 28: go: command not found\n./scripts/build_binary.sh: line 32: go: command not found\nMakefile:30: recipe for target 'bin/local/ecs-cli' failed\nmake: *** [bin/local/ecs-cli] Error 127\n</code></pre>\n\n<p>Error suggests I'm missing Golang installation on my Raspbian OS.</p>\n\n<p>Install Golang 1.9 (or higher from <a href=\"https://golang.org/dl/\" rel=\"nofollow noreferrer\">here</a>) and Godep on Raspbian OS:</p>\n\n<pre><code>$ cd ~\n$ wget https://storage.googleapis.com/golang/go1.9.linux-armv6l.tar.gz\n$ sudo tar -C /usr/local -xzf go1.9.linux-armv6l.tar.gz\n$ export PATH=$PATH:/usr/local/go/bin\n$ go version\ngo version go1.9 linux/arm\n$ go get -u github.com/tools/godep\n$ export GOPATH=~/go\n$ export PATH=$GOPATH/bin:$PATH\n$ godep version\ngodep v80 (linux/arm/go1.9)\n#Add paths into profile file;\n$ echo \"export GOPATH=~/go\" &gt;&gt; $HOME/.profile\n$ echo \"export PATH=/usr/local/go/bin:\\$GOPATH/bin:\\$PATH\" &gt;&gt; $HOME/.profile\n</code></pre>\n\n<p>Compile ecs-cli</p>\n\n<pre><code>$ cd ~/amazon-ecs-cli\n$ make\n./scripts/build_binary.sh ./bin/local\necs-cli/main.go:29:2: cannot find package \"github.com/cihub/seelog\" in any of:\n    /usr/local/go/src/github.com/cihub/seelog (from $GOROOT)\n    /home/pi/go/src/github.com/cihub/seelog (from $GOPATH)\n...\n</code></pre>\n\n<p>Looks like GO expects everything to be cloned into /usr/local/go/src/github.com\n(Please note that make command might be CPU intensive, I recommend to stop any other CPU intensive processes to avoid freeze of Raspberry Pi)</p>\n\n<pre><code>$ mkdir -p /usr/local/go/src/github.com/aws/\n$ cd /usr/local/go/src/github.com/aws/\n$ git clone https://github.com/aws/amazon-ecs-cli.git\n..., done\n$ cd /usr/local/go/src/github.com/aws/amazon-ecs-cli\n$ make\n./scripts/build_binary.sh ./bin/local\nBuilt ecs-cli\n</code></pre>\n\n<p>Copy to target location and run it!</p>\n\n<pre><code>$ sudo cp /usr/local/go/src/github.com/aws/amazon-ecs-cli/bin/local/ecs-cli /usr/local/bin/\n$ sudo chmod +x /usr/local/bin/ecs-cli\n$ ecs-cli --version\necs-cli version 1.5.0 (*UNKNOWN)\n</code></pre>\n\n<p>I can now run ecs-cli on Raspbian OS. Hopefully this will help to anyone who will be searching for similar errors. But is there easier way?</p>\n"}, {"tags": ["go", "serial-port"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1525019132, "post_id": 50088669, "comment_id": 87193529, "body": "In what was is the data it prints malformed? Can you show an example? And what is the specific question? How to read the buffer size from the stty?"}, {"owner": {"reputation": 14957, "user_id": 734463, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/efw4Z.jpg?s=128&g=1", "display_name": "joedborg", "link": "https://stackoverflow.com/users/734463/joedborg"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1525030204, "post_id": 50088669, "comment_id": 87197084, "body": "Thinking about it, malformed seems to be the wrong word, it seem that the line delimitation isn&#39;t done"}, {"owner": {"reputation": 271, "user_id": 4059724, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/46t5i.jpg?s=128&g=1", "display_name": "hextet", "link": "https://stackoverflow.com/users/4059724/hextet"}, "edited": false, "score": 0, "creation_date": 1580357037, "post_id": 50088669, "comment_id": 106072945, "body": "I&#39;m also running into this issue, but unfortunately I can&#39;t seem to solve it. I get the awkward formatting like this with a variety of serial libraries I&#39;ve tried. Anyone happen to figure out a solution?"}], "answers": [{"comments": [{"owner": {"reputation": 397892, "user_id": 95592, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/utY5u.jpg?s=128&g=1", "display_name": "Matthew Rankin", "link": "https://stackoverflow.com/users/95592/matthew-rankin"}, "edited": false, "score": 0, "creation_date": 1578746447, "post_id": 50091168, "comment_id": 105544035, "body": "Why do you state that &quot;you&#39;ll find it difficult to use tricks like <code>bufio.ReadLine()</code>&quot;? Even though <code>*os.File</code> isn&#39;t exported, the <code>Port</code> struct meets the io.ReadWriter interface, so you can use <code>bufio.NewReader(port)</code>."}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "reply_to_user": {"reputation": 397892, "user_id": 95592, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/utY5u.jpg?s=128&g=1", "display_name": "Matthew Rankin", "link": "https://stackoverflow.com/users/95592/matthew-rankin"}, "edited": false, "score": 0, "creation_date": 1604908050, "post_id": 50091168, "comment_id": 114479547, "body": "@MatthewRankin You&#39;re right, it does. That makes things much easier. Not sure why I didn&#39;t notice that previously. I might have been accidentally looking at an old revision of the code or something."}], "tags": [], "owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "is_accepted": true, "score": 8, "last_activity_date": 1604908386, "last_edit_date": 1604908386, "creation_date": 1525035049, "answer_id": 50091168, "question_id": 50088669, "link": "https://stackoverflow.com/questions/50088669/golang-reading-from-serial/50091168#50091168", "title": "Golang reading from serial", "body": "<p>The struct you get back from <code>serial.OpenPort()</code> contains a pointer to an open <code>os.File</code> corresponding to the opened serial port connection. When you <code>Read()</code> from this, the library calls <code>Read()</code> on the underlying <code>os.File</code>.</p>\n<p>The <a href=\"https://golang.org/pkg/os/#File.Read\" rel=\"nofollow noreferrer\">documentation for this function call</a> is:</p>\n<blockquote>\n<p>Read reads up to len(b) bytes from the File. It returns the number of bytes read and any error encountered. At end of file, Read returns 0, io.EOF.</p>\n</blockquote>\n<p>This means you have to keep track of how much data was read. You also have to keep track of whether there were newlines, if this is important to you. Unfortunately, the underlying <code>*os.File</code> is not exported, so you'll find it difficult to use tricks like <code>bufio.ReadLine()</code>. It may be worth modifying the library and sending a pull request.</p>\n<hr />\n<p>As Matthew Rankin noted in a comment, <code>Port</code> implements <code>io.ReadWriter</code> so you can simply use <code>bufio</code> to read by lines.</p>\n<pre><code>    stream, err := serial.OpenPort(config)\n    if err != nil {\n            log.Fatal(err)\n    }\n\n    scanner := bufio.NewScanner(stream)\n    for scanner.Scan() {\n        fmt.Println(scanner.Text()) // Println will add back the final '\\n'\n    }\n    if err := scanner.Err(); err != nil {\n        log.Fatal(err)\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 841, "user_id": 1725108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32faff3a423d4e864661061e46570c9c?s=128&d=identicon&r=PG", "display_name": "Bjorn", "link": "https://stackoverflow.com/users/1725108/bjorn"}, "is_accepted": false, "score": 2, "last_activity_date": 1569009782, "creation_date": 1569009782, "answer_id": 58034521, "question_id": 50088669, "link": "https://stackoverflow.com/questions/50088669/golang-reading-from-serial/58034521#58034521", "title": "Golang reading from serial", "body": "<p>Change</p>\n\n<pre><code>fmt.Println(s)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>fmt.Print(s)\n</code></pre>\n\n<p>and you will probably get what you want.\nOr did I misunderstand the question?</p>\n"}, {"tags": [], "owner": {"reputation": 11257, "user_id": 10197418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/be8Y6.jpg?s=128&g=1", "display_name": "MrFuppes", "link": "https://stackoverflow.com/users/10197418/mrfuppes"}, "is_accepted": false, "score": 0, "last_activity_date": 1618235717, "creation_date": 1618235717, "answer_id": 67059709, "question_id": 50088669, "link": "https://stackoverflow.com/questions/50088669/golang-reading-from-serial/67059709#67059709", "title": "Golang reading from serial", "body": "<p>I recently built a serial port reader using <code>bufio.NewScanner</code> as Michael Hamptom describes in pt.2 of <a href=\"https://stackoverflow.com/a/50091168/10197418\">his answer</a>. Here are two additions I found useful:</p>\n<h3>line endings</h3>\n<p>You might receive data that is not newline-separated text. <code>bufio.Scanner</code> uses <a href=\"https://golang.org/src/bufio/scan.go?s=11967:12045#L340\" rel=\"nofollow noreferrer\">ScanLines</a> by default to split the received data into lines - but you can also write your own line splitter based on the default function's signature and set it for the scanner:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>scanner := bufio.NewScanner(stream) \nscanner.Split(ownLineSplitter) // set custom line splitter function\n</code></pre>\n<h3>reader shutdown</h3>\n<p>You might not receive a constant stream but only some packets of bytes from time to time. If no bytes arrive at the port, the scanner will block and you can't just kill it. You'll have to close the stream to do so, effectively raising an error. To not block any outer loops and handle errors appropriately, you can wrap the scanner in a goroutine that takes a context. If the context was cancelled, ignore the error, otherwise forward the error. In principle, this can look like</p>\n<pre class=\"lang-golang prettyprint-override\"><code>var errChan = make(chan error)\nvar dataChan = make(chan []byte)\nctx, cancelPortScanner := context.WithCancel(context.Background())\n\ngo func(ctx context.Context) {\n    scanner := bufio.NewScanner(stream)\n    for scanner.Scan() { // will terminate if connection is closed\n        dataChan &lt;- scanner.Bytes()\n    }\n    // if execution reaches this point, something went wrong or stream was closed\n    select {\n    case &lt;-ctx.Done():\n        return // tx was cancelled, just return without error\n    default:\n        errChan &lt;- scanner.Err() // ctx wasn't cancelled, forward error\n    }\n}(ctx)\n\n// handle data from dataChan, error from errChan\n</code></pre>\n<p>To stop the scanner, you would cancel the context and close the connection:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>cancelPortScanner()\nstream.Close()\n</code></pre>\n"}], "owner": {"reputation": 14957, "user_id": 734463, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/efw4Z.jpg?s=128&g=1", "display_name": "joedborg", "link": "https://stackoverflow.com/users/734463/joedborg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9535, "favorite_count": 1, "accepted_answer_id": 50091168, "answer_count": 3, "score": 5, "last_activity_date": 1618235717, "creation_date": 1525018186, "last_edit_date": 1525030313, "question_id": 50088669, "link": "https://stackoverflow.com/questions/50088669/golang-reading-from-serial", "title": "Golang reading from serial", "body": "<p>I'm trying to read from a serial port (a GPS device on a Raspberry Pi).</p>\n\n<p>Following the instructions from <a href=\"http://www.modmypi.com/blog/raspberry-pi-gps-hat-and-python\" rel=\"noreferrer\">http://www.modmypi.com/blog/raspberry-pi-gps-hat-and-python</a></p>\n\n<p>I can read from shell using</p>\n\n<pre><code>stty -F /dev/ttyAMA0 raw 9600 cs8 clocal -cstopb\ncat /dev/ttyAMA0\n</code></pre>\n\n<p>I get well formatted output</p>\n\n<pre><code>$GNGLL,5133.35213,N,00108.27278,W,160345.00,A,A*65\n$GNRMC,160346.00,A,5153.35209,N,00108.27286,W,0.237,,290418,,,A*75\n$GNVTG,,T,,M,0.237,N,0.439,K,A*35\n$GNGGA,160346.00,5153.35209,N,00108.27286,W,1,12,0.67,81.5,M,46.9,M,,*6C\n$GNGSA,A,3,29,25,31,20,26,23,21,16,05,27,,,1.11,0.67,0.89*10\n$GNGSA,A,3,68,73,83,74,84,75,85,67,,,,,1.11,0.67,0.89*1D\n$GPGSV,4,1,15,04,,,34,05,14,040,21,09,07,330,,16,45,298,34*40\n$GPGSV,4,2,15,20,14,127,18,21,59,154,30,23,07,295,26,25,13,123,22*74\n$GPGSV,4,3,15,26,76,281,40,27,15,255,20,29,40,068,19,31,34,199,33*7C\n$GPGSV,4,4,15,33,29,198,,36,23,141,,49,30,172,*4C\n$GLGSV,3,1,11,66,00,325,,67,13,011,20,68,09,062,16,73,12,156,21*60\n$GLGSV,3,2,11,74,62,177,20,75,53,312,36,76,08,328,,83,17,046,25*69\n$GLGSV,3,3,11,84,75,032,22,85,44,233,32,,,,35*62\n$GNGLL,5153.35209,N,00108.27286,W,160346.00,A,A*6C\n$GNRMC,160347.00,A,5153.35205,N,00108.27292,W,0.216,,290418,,,A*7E\n$GNVTG,,T,,M,0.216,N,0.401,K,A*3D\n$GNGGA,160347.00,5153.35205,N,00108.27292,W,1,12,0.67,81.7,M,46.9,M,,*66\n$GNGSA,A,3,29,25,31,20,26,23,21,16,05,27,,,1.11,0.67,0.89*10\n$GNGSA,A,3,68,73,83,74,84,75,85,67,,,,,1.11,0.67,0.89*1D\n$GPGSV,4,1,15,04,,,34,05,14,040,21,09,07,330,,16,45,298,34*40\n</code></pre>\n\n<p>(I've put some random data in)</p>\n\n<p>I'm trying to read this in Go.  Currently, I have</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"log\"\nimport \"github.com/tarm/serial\"\n\nfunc main() {\n        config := &amp;serial.Config{\n                Name: \"/dev/ttyAMA0\",\n                Baud: 9600,\n                ReadTimeout: 1,\n                Size: 8,\n        }\n\n        stream, err := serial.OpenPort(config)\n        if err != nil {\n                log.Fatal(err)\n        }\n\n        buf := make([]byte, 1024)\n\n        for {\n                n, err := stream.Read(buf)\n                if err != nil {\n                        log.Fatal(err)\n                }\n                s := string(buf[:n])\n                fmt.Println(s)\n        }\n}\n</code></pre>\n\n<p>But this prints malformed data.  I suspect that this is due to the buffer size or the value of <code>Size</code> in the <code>config</code> struct being wrong, but I'm not sure how to get those values from the <code>stty</code> settings.</p>\n\n<p>Looking back, I think the issue is that I'm getting a stream and I want to be able to iterate over lines of the stty, rather than chunks.  This is how the stream is outputted:</p>\n\n<pre><code>$GLGSV,3\n,1,09,69\n,10,017,\n,70,43,0\n69,,71,3\n2,135,27\n,76,23,2\n32,22*6F\n\n$GLGSV\n,3,2,09,\n77,35,30\n0,21,78,\n11,347,,\n85,31,08\n1,30,86,\n72,355,3\n6*6C\n$G\nLGSV,3,3\n,09,87,2\n4,285,30\n*59\n$GN\nGLL,5153\n.34919,N\n,00108.2\n7603,W,1\n92901.00\n,A,A*6A\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": true, "score": 5, "last_activity_date": 1525771140, "last_edit_date": 1525771140, "creation_date": 1525015745, "answer_id": 50088280, "question_id": 50088170, "link": "https://stackoverflow.com/questions/50088170/function-types-in-go/50088280#50088280", "title": "Function types in Go", "body": "<p>Function types are described in <a href=\"https://golang.org/ref/spec#Function_types\" rel=\"nofollow noreferrer\">Golang Spec</a> as:</p>\n\n<blockquote>\n  <p>A function type denotes the set of all functions with the same\n  parameter and result types.</p>\n</blockquote>\n\n<p>Here it is clearly mentioned that function with <code>same parameter and result types</code></p>\n\n<p>There are different functions definition that you are passing to your main program and the definitions that your function requires. If you look at below function carefully you have passed <code>t</code> as argument to <code>test1</code> which returns nothing but you are assign its value to <code>opt</code> that's why the error.</p>\n\n<blockquote>\n  <p>t(fname, lname) used as value</p>\n</blockquote>\n\n<p>For second error which says:</p>\n\n<blockquote>\n  <p>cannot use myfunc2 (type func(string, string) string) as type\n  func(string, string) in argument to test1</p>\n</blockquote>\n\n<p>Since because if you look at the type of function you are passing to <code>test1</code> as an argument and the type of argument that you have defined in <code>test1</code> are different.</p>\n\n<p>Please check below working code.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\n\nfunc myfn1(i string) {\n    fmt.Println(i)\n}\n\nfunc myfunc2(firstName string, lastName string) string{\n\nreturn \"Hello \"+ firstName + \" \" + lastName + \"!\"\n\n\n}\n\nfunc test(do func(string), val string){\ndo(val)\n}\n\n\nfunc test1(t func(string,string) string, fname string, lname string) string{\n\n  opt := t(fname,lname)\n  return opt\n}\n\n\nfunc main() {\n    test(myfn1, \"Aishu\")\n     greet := test1(myfunc2, \"Aishu\",\"S\")\n     fmt.Println(greet)\n\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/pwz04TucwZ3\" rel=\"nofollow noreferrer\">Playground</a> example</p>\n"}, {"comments": [{"owner": {"reputation": 6023, "user_id": 4236078, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/9959d878feda9f2bab4b43b554e09847?s=128&d=identicon&r=PG&f=1", "display_name": "ale64bit", "link": "https://stackoverflow.com/users/4236078/ale64bit"}, "edited": false, "score": 2, "creation_date": 1525016124, "post_id": 50088318, "comment_id": 87192426, "body": "nit: since the solution for both problems is the same (i.e. making <code>t</code> of type <code>func(string,string) string</code>, I wouldn&#39;t call them <i>unrelated</i>, right? :)"}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 4, "last_activity_date": 1525015929, "creation_date": 1525015929, "answer_id": 50088318, "question_id": 50088170, "link": "https://stackoverflow.com/questions/50088170/function-types-in-go/50088318#50088318", "title": "Function types in Go", "body": "<p>You have two unrelated problems.</p>\n\n<p>The first:</p>\n\n<blockquote>\n  <ol>\n  <li>t(fname, lname) used as value</li>\n  </ol>\n</blockquote>\n\n<p>Is that you're trying to assign the return value of <code>t(fname, lname)</code> to a variable, but <code>t()</code> doesn't return anything.</p>\n\n<p>The second:</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>cannot use myfunc2 (type func(string, string) string) as type func(string, string) in argument to test1</li>\n  </ol>\n</blockquote>\n\n<p>Is pretty self-explanatory. You're trying to pass a function that returns a string <code>func(string, string) string</code>, to a function that expects a function that returns nothing <code>func(string, string)</code>.</p>\n"}], "owner": {"reputation": 1091, "user_id": 3500874, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/Elnoc.jpg?s=128&g=1", "display_name": "Aishu", "link": "https://stackoverflow.com/users/3500874/aishu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 0, "accepted_answer_id": 50088280, "answer_count": 2, "score": 2, "last_activity_date": 1525771140, "creation_date": 1525015187, "last_edit_date": 1525019916, "question_id": 50088170, "link": "https://stackoverflow.com/questions/50088170/function-types-in-go", "title": "Function types in Go", "body": "<p>I'm trying to understand function types in Go, so I tried with the below code.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc myfn1(i string) {\n    fmt.Println(i)\n}\n\nfunc myfunc2(firstName string, lastName string) string {\n    return \"Hello \"+ firstName + \" \" + lastName + \"!\"\n}\n\nfunc test(do func(string), val string) {\n    do(val)\n}\n\nfunc test1(t func(string,string), fname string, lname string) string {\n  opt := t(fname, lname)\n  return opt\n}\n\nfunc main() {\n    test(myfn1, \"Aishu\")\n    greet := test1(myfunc2, \"Aishu\",\"S\")\n    fmt.Println(greet)\n}\n</code></pre>\n\n<p>And it throws below error.</p>\n\n<blockquote>\n  <ol>\n  <li>t(fname, lname) used as value</li>\n  <li>cannot use myfunc2 (type func(string, string) string) as type func(string, string) in argument to test1</li>\n  </ol>\n</blockquote>\n\n<p>I'm not sure what I'm doing wrong.</p>\n\n<p><a href=\"https://play.golang.org/p/9Dw3AxrfNq1\" rel=\"nofollow noreferrer\">Playground</a></p>\n"}, {"tags": ["docker", "go", "goland"], "answers": [{"comments": [{"owner": {"reputation": 2896, "user_id": 3361028, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b53a63319b061edb80dc910c10cfbfd1?s=128&d=identicon&r=PG&f=1", "display_name": "hY8vVpf3tyR57Xib", "link": "https://stackoverflow.com/users/3361028/hy8vvpf3tyr57xib"}, "edited": false, "score": 0, "creation_date": 1525175499, "post_id": 50087380, "comment_id": 87249079, "body": "Thanks for the help! Just wondering: why did jetbrains choose to not make this possible?"}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "reply_to_user": {"reputation": 2896, "user_id": 3361028, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b53a63319b061edb80dc910c10cfbfd1?s=128&d=identicon&r=PG&f=1", "display_name": "hY8vVpf3tyR57Xib", "link": "https://stackoverflow.com/users/3361028/hy8vvpf3tyr57xib"}, "edited": false, "score": 0, "creation_date": 1525283533, "post_id": 50087380, "comment_id": 87299691, "body": "Unfortunately, it&#39;s really not something we can fix. There&#39;s no way for us to access the files inside containers without doing something like an SSH bridge, or similar. And that&#39;s not exactly a good development experience nor it allows for using minimal docker containers."}, {"owner": {"reputation": 548, "user_id": 1396362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jp1lK.jpg?s=128&g=1", "display_name": "Kevin Wittek", "link": "https://stackoverflow.com/users/1396362/kevin-wittek"}, "edited": false, "score": 0, "creation_date": 1531909407, "post_id": 50087380, "comment_id": 89769907, "body": "@dlsniper There is awesome support for building inside a Docker container in PyCharm. Could you provide something along this lines? I assume in PyCharm it works with mounting the src directories."}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1531922863, "post_id": 50087380, "comment_id": 89779146, "body": "We are still exploring how to use Docker containers for development, see the ticket in my response. Personally, I don&#39;t understand why would anyone do actual development inside a Docker container, using git, various go tools, and doing commits from there. It goes against everything containers are supposed to be and it&#39;s using them as Virtual Machines rather than containers. That being said, my opinion doesn&#39;t matter in this case, and when we&#39;ll figure out how to support this case, we&#39;ll update the ticket. I hope this helps."}, {"owner": {"reputation": 3456, "user_id": 419097, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/99d9c8a12fbedd5a8b8309ade725dc36?s=128&d=identicon&r=PG", "display_name": "b01", "link": "https://stackoverflow.com/users/419097/b01"}, "edited": false, "score": 1, "creation_date": 1581855993, "post_id": 50087380, "comment_id": 106568701, "body": "This does not make sense. PHPStorm (another Jet Brains app) has an option to load PHP from a running docker container. It loads PHP from the container so you do not need PHP installed on your host machine. Then PHPStorm looks/infers to all the PHP lib in the running container. I&#39;m not sure how, maybe it maps a docker volume. GoLand could try what PHP Storms does."}], "tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": true, "score": 2, "last_activity_date": 1525036212, "last_edit_date": 1525036212, "creation_date": 1525010288, "answer_id": 50087380, "question_id": 50086882, "link": "https://stackoverflow.com/questions/50086882/configure-goroot-in-goland-when-using-docker/50087380#50087380", "title": "Configure GOROOT in Goland when using docker", "body": "<p>As of 2018.1.2, it's impossible to use GoLand to develop Go applications that have their source code inside containers. The source code of your application, its dependencies, and Go itself need to be installed on your machine.</p>\n\n<p>If anyone has any idea on how to improve the Docker based development support, suggestions are welcomed, see: <a href=\"https://youtrack.jetbrains.com/issue/GO-3322\" rel=\"nofollow noreferrer\">https://youtrack.jetbrains.com/issue/GO-3322</a></p>\n\n<p>As for why even bother adding support for Docker in the IDE? You can launch containers, you can use docker compose, and a host of other tools from the IDE. However, with the way containers work, there is no way for the IDE to get the source from the container and infer them.</p>\n\n<p>Furthermore, your container should not include the Go sources/workspace in the final container, so that it's optimized for size and deployment speed. You can use something like this to run, but be aware that additional work may be required.</p>\n\n<pre><code>FROM golang:1.9.3 as build-env\n\n# allows app_env to be set during build (defaults to empty string)\nARG app_env\n# sets an environment variable to app_env argument, this way the variable     will persist in the container for use in code\nENV APP_ENV $app_env\n\nCOPY ./ /go/src/github.com/Name/ProjectName/\n\nWORKDIR /go/src/github.com/Name/ProjectName/app\n\n# install all dependencies\nRUN go get ./...\n\n# build the binary\nRUN go build -o /my_app\n\n# final stage\nFROM scratch\n\nCOPY --from=build-env /my_app /\n\n# Put back once we have an application\nCMD [\"/my_app\"]\n\nEXPOSE 8080\n</code></pre>\n"}], "owner": {"reputation": 2896, "user_id": 3361028, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b53a63319b061edb80dc910c10cfbfd1?s=128&d=identicon&r=PG&f=1", "display_name": "hY8vVpf3tyR57Xib", "link": "https://stackoverflow.com/users/3361028/hy8vvpf3tyr57xib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2823, "favorite_count": 1, "accepted_answer_id": 50087380, "answer_count": 1, "score": 3, "last_activity_date": 1525036212, "creation_date": 1525007154, "question_id": 50086882, "link": "https://stackoverflow.com/questions/50086882/configure-goroot-in-goland-when-using-docker", "title": "Configure GOROOT in Goland when using docker", "body": "<p>I am building a Go project with Docker in the new GoLand IDE. Unfortunately, I am not able to cofigure my <code>GOROOT</code> correctly, making it not possible to use the GoLand futures to the max.</p>\n\n<p>I have the following dockerfile:</p>\n\n<pre><code>FROM golang:1.9.3\n\n# allows app_env to be set during build (defaults to empty string)\nARG app_env\n# sets an environment variable to app_env argument, this way the variable will persist in the container for use in code\nENV APP_ENV $app_env\n\n\nCOPY ./ /go/src/github.com/Name/ProjectName/\n\nWORKDIR /go/src/github.com/Name/ProjectName/app\n\n# install all dependencies\nRUN go get ./...\n\n# build the binary\nRUN go build\n\n# Put back once we have an application\nRUN app\n\nEXPOSE 8080\n</code></pre>\n\n<p>I now execute my project as follows: </p>\n\n<ol>\n<li><code>docker build -t project-name .</code></li>\n<li><code>docker run -it -v ~/project-dir:/go/src/github.com/Name/ProjectName/app</code></li>\n</ol>\n\n<p>This works, however, I cannot find how I can configure GoLand to use the path on my Docker image <code>usr/local/go/bin</code> for my GoRoot, is that even possible in GoLand? (If not, why even bother adding 'docker support'?) </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1525006353, "post_id": 50086711, "comment_id": 87189222, "body": "you stringify an already created json in your javascript remove that."}, {"owner": {"reputation": 91, "user_id": 3498330, "user_type": "registered", "profile_image": "https://graph.facebook.com/752457655/picture?type=large", "display_name": "nivklein", "link": "https://stackoverflow.com/users/3498330/nivklein"}, "edited": false, "score": 0, "creation_date": 1525006580, "post_id": 50086711, "comment_id": 87189273, "body": "take a look at a similar question: <a href=\"https://stackoverflow.com/questions/16846553/how-to-unmarshal-an-escaped-json-string-in-go\" title=\"how to unmarshal an escaped json string in go\">stackoverflow.com/questions/16846553/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1525007146, "creation_date": 1525007146, "answer_id": 50086880, "question_id": 50086711, "link": "https://stackoverflow.com/questions/50086711/unmarshaling-a-stringified-json/50086880#50086880", "title": "Unmarshaling a stringified json", "body": "<p>Use <a href=\"https://godoc.org/encoding/json#RawMessage\" rel=\"nofollow noreferrer\">json.RawMessage</a> to capture the varying field:</p>\n\n<pre><code>type atomRequest struct {\n    Stream  string                 `json:\"stream\"`\n    RawData json.RawMessage        `json:\"data\"`\n    Data    map[string]interface{} `json:\"-\"`\n}\n</code></pre>\n\n<p>Unmarshal the top-level JSON:</p>\n\n<pre><code>var req atomRequest\nif err := json.Unmarshal(data, &amp;req); err != nil {\n    // handle error\n}\n</code></pre>\n\n<p>If <code>data</code> is a string, unmarshal to remove the extra level of encoding:</p>\n\n<pre><code>if len(req.RawData) &gt; 0 &amp;&amp; req.RawData[0] == '\"' {\n    var s string\n    if err := json.Unmarshal(req.RawData, &amp;s); err != nil {\n        // handle error\n    }\n    req.RawData = json.RawMessage(s)\n}\n</code></pre>\n\n<p>Finally, unmarshal to the <code>map[string]interface{}</code>:</p>\n\n<pre><code>if err := json.Unmarshal(req.RawData, &amp;req.Data); err != nil {\n    // handle error\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/KyNycFse9O3\" rel=\"nofollow noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 727, "user_id": 1985162, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/548146a0387d6b4062ede923e39e431b?s=128&d=identicon&r=PG", "display_name": "OhadBasan", "link": "https://stackoverflow.com/users/1985162/ohadbasan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 1, "accepted_answer_id": 50086880, "answer_count": 1, "score": 2, "last_activity_date": 1525007146, "creation_date": 1525005927, "last_edit_date": 1525006440, "question_id": 50086711, "link": "https://stackoverflow.com/questions/50086711/unmarshaling-a-stringified-json", "title": "Unmarshaling a stringified json", "body": "<p>I am trying to unmarshal a json with a nested json.</p>\n\n<p>I am using this struct</p>\n\n<pre><code>type atomRequest struct {\n    Stream string                 `json:\"stream\"`\n    Data   map[string]interface{} `json:\"data\"`\n}\n</code></pre>\n\n<p>if the nested json is stringified, the Unmasrhaling fails and the value is nil</p>\n\n<p>if the byte array that i am marshalling is with a non escape \"data\"\nThe \"Data\" map is being populated correctly.</p>\n\n<p>if the nested json is stringified, I get an empty Data map.</p>\n\n<p>I am looking for a solution to unmarshal the nested data, whether its stringified or not.</p>\n\n<p>The example: this input works:</p>\n\n<pre><code>{\"stream\":\"foobar\",\"data\":{\"errorID\":112,\"timestamp\":1524737466}}\n</code></pre>\n\n<p>This input does not work:</p>\n\n<pre><code>{\n    \"stream\": \"foo\",\n    \"data\": \"{\\\"cd3\\\":\\\"514\\\",\\\"cd8\\\":\\\"none\\\"}\"\n}\n</code></pre>\n\n<p>can you help?</p>\n\n<p>thanks</p>\n"}, {"tags": ["go", "io", "std"], "answers": [{"comments": [{"owner": {"reputation": 7127, "user_id": 247002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1f494e0363428b11d080c35ec3d199ff?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/247002/mark"}, "edited": false, "score": 0, "creation_date": 1525007225, "post_id": 50086433, "comment_id": 87189482, "body": "Thanks! This sounds promising. I will give it a try."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 3, "last_activity_date": 1525087873, "last_edit_date": 1525087873, "creation_date": 1525003913, "answer_id": 50086433, "question_id": 50086253, "link": "https://stackoverflow.com/questions/50086253/capture-the-space-key-in-go-without-following-enter/50086433#50086433", "title": "Capture the space key in Go without following enter", "body": "<p>Without more information, it's hard to come up with a perfect example of what you're looking for.  However, the basic idea is that you need to switch your terminal into raw mode, where input is passed immediately to your application.  <a href=\"https://godoc.org/golang.org/x/crypto/ssh/terminal\" rel=\"nofollow noreferrer\"><code>x/crypto/ssh/terminal</code></a> is a popular library that provides this functionality:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n\n    \"golang.org/x/crypto/ssh/terminal\"\n)\n\nfunc main() {\n    oldState, err := terminal.MakeRaw(0)\n    if err != nil {\n        panic(err)\n    }\n    defer terminal.Restore(0, oldState)\n    for {\n        var oneChar [1]byte\n        _, err := os.Stdin.Read(oneChar[:])\n        const ETX = '\\x03' // ^C\n        const EOT = '\\x04' // ^D\n        if err != nil || oneChar[0] == ETX || oneChar[0] == EOT {\n            break\n        }\n        if oneChar[0] == ' ' {\n            fmt.Println(\"Space pressed!\\r\")\n            break\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 7127, "user_id": 247002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1f494e0363428b11d080c35ec3d199ff?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/247002/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 50086433, "answer_count": 1, "score": 2, "last_activity_date": 1525087873, "creation_date": 1525002534, "last_edit_date": 1525073944, "question_id": 50086253, "link": "https://stackoverflow.com/questions/50086253/capture-the-space-key-in-go-without-following-enter", "title": "Capture the space key in Go without following enter", "body": "<p>I am looking for a lightweight and in the best case pure go implementation to capture <kbd>space</kbd> without a following <kbd>enter</kbd>.</p>\n\n<p>I have seen some people using C as extern in Go or <a href=\"https://github.com/nsf/termbox\" rel=\"nofollow noreferrer\">termbox</a>. Is there really no other method of capturing every keyboard stroke? </p>\n\n<p>I have already thought about opening the device directly (in Linux) and trying to read from there.</p>\n\n<p>Any advice of how to do this would be great!</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 983, "user_id": 7059119, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209343272591927/picture?type=large", "display_name": "Aristofanio Garcia", "link": "https://stackoverflow.com/users/7059119/aristofanio-garcia"}, "edited": false, "score": 0, "creation_date": 1525000400, "post_id": 50085893, "comment_id": 87187479, "body": "Are you using standart, or flexible environment? See: <a href=\"https://cloud.google.com/appengine/docs/standard/java/sockets/#using_sockets_with_the_development_server\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/docs/standard/java/sockets/&hellip;</a>"}, {"owner": {"reputation": 983, "user_id": 7059119, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209343272591927/picture?type=large", "display_name": "Aristofanio Garcia", "link": "https://stackoverflow.com/users/7059119/aristofanio-garcia"}, "edited": false, "score": 0, "creation_date": 1525000643, "post_id": 50085893, "comment_id": 87187536, "body": "If you was using standart will not works! You need to deploy webapp like specification. Vide: <a href=\"https://cloud.google.com/appengine/docs/go/\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/docs/go</a>"}, {"owner": {"reputation": 393, "user_id": 3017869, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bdd06e12c2e59b5d2b9ec7328b51c190?s=128&d=identicon&r=PG&f=1", "display_name": "user3017869", "link": "https://stackoverflow.com/users/3017869/user3017869"}, "reply_to_user": {"reputation": 983, "user_id": 7059119, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209343272591927/picture?type=large", "display_name": "Aristofanio Garcia", "link": "https://stackoverflow.com/users/7059119/aristofanio-garcia"}, "edited": false, "score": 0, "creation_date": 1525001807, "post_id": 50085893, "comment_id": 87187835, "body": "@AristofanioGarcia thanks for the docs. Deploying a socket app is a completely different can of worms"}, {"owner": {"reputation": 5576, "user_id": 4986182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5oDOo.png?s=128&g=1", "display_name": "vitr", "link": "https://stackoverflow.com/users/4986182/vitr"}, "edited": false, "score": 0, "creation_date": 1525007320, "post_id": 50085893, "comment_id": 87189520, "body": "if it&#39;s a real server it MUST handle the requests, can you reveal the actual code?"}], "answers": [{"tags": [], "owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "is_accepted": true, "score": 1, "last_activity_date": 1525013089, "creation_date": 1525013089, "answer_id": 50087816, "question_id": 50085893, "link": "https://stackoverflow.com/questions/50085893/appengine-app-deployment-error-at-least-one-handler-must-be-provided/50087816#50087816", "title": "appengine app deployment - ERROR: At least one handler must be provided", "body": "<p>You can always add a skeleton web handler (which may simply return a 404) to keep the deployment utility happy.</p>\n\n<p>But be aware that the GAE standard environment sandbox is very restrictive for socket-based apps, see <a href=\"https://cloud.google.com/appengine/docs/standard/go/sockets/#limitations_and_restrictions_if_lang_is_java_java_7_runtime_only_endif\" rel=\"nofollow noreferrer\">Limitations and restrictions</a>:</p>\n\n<blockquote>\n  <p>Although App Engine supports sockets, there are certain limitations\n  and behaviors you need to be aware of when using sockets :</p>\n  \n  <ul>\n  <li>Sockets are available only for paid apps.</li>\n  <li>You cannot create a listen socket; you can only create outbound sockets.</li>\n  <li>FTP is not supported.</li>\n  <li>You can only use TCP or UDP; arbitrary protocols are not allowed.</li>\n  <li>You cannot bind to specific IP addresses or ports.</li>\n  <li><p>Port 25 (SMTP) is blocked; you can still use authenticated SMTP on the submission port 587.</p></li>\n  <li><p>Private, broadcast, multicast, and Google IP ranges (except those whitelisted below), are blocked:</p>\n  \n  <ul>\n  <li>Google Public DNS: <code>8.8.8.8</code>, <code>8.8.4.4</code>, <code>2001:4860:4860::8888</code>, <code>2001:4860:4860::8844</code> port 53</li>\n  <li>Gmail SMTPS: smtp.gmail.com port 465 and 587</li>\n  <li>Gmail POP3S: pop.gmail.com port 995</li>\n  <li><p>Gmail IMAPS: imap.gmail.com port 993</p>\n  \n  <p>Note: Google Compute Engine IP addresses are not considered to be in Google IP ranges. You can use sockets to connect Google App Engine\n  apps to Google Compute Engine instances.</p></li>\n  </ul></li>\n  <li><p>Socket descriptors are associated with the App Engine app that created them and are non-transferable (cannot be used by other apps).</p></li>\n  <li>Sockets may be reclaimed after 2 minutes of inactivity; any socket operation keeps the socket alive for a further 2 minutes.</li>\n  </ul>\n</blockquote>\n\n<p>If your app can't abide by these restrictions you need to look at other alternatives, which would include the flexible environment GAE or Compute Engine.</p>\n"}], "owner": {"reputation": 393, "user_id": 3017869, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bdd06e12c2e59b5d2b9ec7328b51c190?s=128&d=identicon&r=PG&f=1", "display_name": "user3017869", "link": "https://stackoverflow.com/users/3017869/user3017869"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1013, "favorite_count": 0, "accepted_answer_id": 50087816, "answer_count": 1, "score": 0, "last_activity_date": 1525013089, "creation_date": 1525000153, "question_id": 50085893, "link": "https://stackoverflow.com/questions/50085893/appengine-app-deployment-error-at-least-one-handler-must-be-provided", "title": "appengine app deployment - ERROR: At least one handler must be provided", "body": "<p>Getting started with appengine.</p>\n\n<p>My app has no front end.</p>\n\n<p>Its a tcp/udp socket server.</p>\n\n<p>When I try to deploy I get the error in the title.</p>\n\n<p>Handler for what? Its not a webapp.</p>\n\n<p>Is appengine the wrong google service for server apps?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 383, "user_id": 7477557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b433af7158235c950e9967f925776dc7?s=128&d=identicon&r=PG", "display_name": "xdrm-brackets", "link": "https://stackoverflow.com/users/7477557/xdrm-brackets"}, "edited": false, "score": 1, "creation_date": 1524999146, "post_id": 50085708, "comment_id": 87187158, "body": "Have you tried <code>len(*event.Identificator)</code> as <i>Identificator</i> is a pointer ?"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1524999520, "post_id": 50085708, "comment_id": 87187234, "body": "Read and post the entire error message: <code>invalid argument event.Identificator (type *string) for len</code>."}, {"owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "reply_to_user": {"reputation": 383, "user_id": 7477557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b433af7158235c950e9967f925776dc7?s=128&d=identicon&r=PG", "display_name": "xdrm-brackets", "link": "https://stackoverflow.com/users/7477557/xdrm-brackets"}, "edited": false, "score": 0, "creation_date": 1524999537, "post_id": 50085708, "comment_id": 87187243, "body": "@xdrm-brackets it will crash if the pointer is <code>nil</code>."}, {"owner": {"reputation": 383, "user_id": 7477557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b433af7158235c950e9967f925776dc7?s=128&d=identicon&r=PG", "display_name": "xdrm-brackets", "link": "https://stackoverflow.com/users/7477557/xdrm-brackets"}, "reply_to_user": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 0, "creation_date": 1524999626, "post_id": 50085708, "comment_id": 87187264, "body": "@bereal yes but you told us that you checked it first, that&#39;s a solution for after your check"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1525072438, "post_id": 50085708, "comment_id": 87207378, "body": "You forgot to include the code you&#39;re having problems with."}], "answers": [{"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1525072495, "post_id": 50085779, "comment_id": 87207401, "body": "nit: ASCII strings <i>are</i> Unicode-encoded. The proper distinction would be something like &quot;for non-ASCII Unicode-encoded strings&quot;."}, {"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 0, "creation_date": 1525072979, "post_id": 50085779, "comment_id": 87207623, "body": "More nit: there&#39;s no such thing as a &quot;Unicode-encoded&quot; string, because Unicode is not an encoding (it&#39;s more like a character set, which maps numbers to characters (or more technically correct, codepoints (which can but don&#39;t need to represent characters))). The most common Unicode <i>encoding</i> would be UTF-8."}], "tags": [], "owner": {"reputation": 5551, "user_id": 1201488, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cce2b982a2acdfb40f3c376489403f1e?s=128&d=identicon&r=PG", "display_name": "Ivan Velichko", "link": "https://stackoverflow.com/users/1201488/ivan-velichko"}, "is_accepted": true, "score": 2, "last_activity_date": 1525000079, "last_edit_date": 1525000079, "creation_date": 1524999291, "answer_id": 50085779, "question_id": 50085708, "link": "https://stackoverflow.com/questions/50085708/get-length-of-nullable-string/50085779#50085779", "title": "Get length of nullable string", "body": "<p>There is no simple <code>len(string)</code> concept in Go. You either need the number of bytes in the string representation or the number of characters (so called runes). For ASCII strings both values are the same while for unicode-encoded strings they are usually different.</p>\n\n<pre><code>import \"unicode/utf8\"\n\n// Firt check that the pointer to your string is not nil\nif nil != event.Identificator {\n    // For number of runes:\n    utf8.RuneCountInString(*event.Identificator)\n\n    // For number of bytes:\n    len(*event.Identificator)\n}\n</code></pre>\n\n<p>For more information you can check this answer <a href=\"https://stackoverflow.com/a/12668840/1201488\">https://stackoverflow.com/a/12668840/1201488</a>.</p>\n\n<p><strong>UPD</strong>: <code>event.Identificator</code> is a pointer to a string value in the <code>NetAuth</code> structure rather than a string value. So you need to dereference it first via <code>*event.Identificator</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1525001369, "post_id": 50085822, "comment_id": 87187734, "body": "The official Stack Overflow advice for links: &quot;<a href=\"https://stackoverflow.com/help/how-to-answer\">Provide context for links.</a> Links to external resources are encouraged, but please add context around the link so your fellow users will have some idea what it is and why it\u2019s there. Always quote the most relevant part of an important link, in case the target site is unreachable or goes permanently offline.&quot; Plus, you get more upvotes!"}], "tags": [], "owner": {"reputation": 983, "user_id": 7059119, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209343272591927/picture?type=large", "display_name": "Aristofanio Garcia", "link": "https://stackoverflow.com/users/7059119/aristofanio-garcia"}, "is_accepted": false, "score": 2, "last_activity_date": 1524999970, "last_edit_date": 1524999970, "creation_date": 1524999639, "answer_id": 50085822, "question_id": 50085708, "link": "https://stackoverflow.com/questions/50085708/get-length-of-nullable-string/50085822#50085822", "title": "Get length of nullable string", "body": "<p>You are using a pointer, so try this:</p>\n\n<pre><code>println(len(*vlr.Identificator))\n</code></pre>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    //\"fmt\"\n    \"encoding/json\"\n    \"strings\"\n    \"io\"\n)\n\ntype NetAuth struct {\n        Identificator *string `json:\"identificator\"`\n        Password      *string `json:\"password\"`\n        DeviceID      *string `json:\"deviceId\"`\n        Type          int  `json:\"type\"`\n}\n\nfunc jsondata() io.Reader {\n  return strings.NewReader(`{\"identificator\": \"0001\", \"password\": \"passkey\"}`)\n}\n\nfunc main() {\n    dec := json.NewDecoder(jsondata())\n    vlr := new(NetAuth)\n    dec.Decode(vlr)\n    println(*vlr.Identificator)\n    println(len(*vlr.Identificator))\n\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/duf0tEddBsR\" rel=\"nofollow noreferrer\">https://play.golang.org/p/duf0tEddBsR</a></p>\n\n<p>Output:</p>\n\n<pre><code>0001\n4\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 7473136, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7e0c6a6a7a8149c86db1cac1d2f0683b?s=128&d=identicon&r=PG", "display_name": "user93466", "link": "https://stackoverflow.com/users/7473136/user93466"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 636, "favorite_count": 1, "accepted_answer_id": 50085779, "answer_count": 2, "score": 0, "last_activity_date": 1525072422, "creation_date": 1524998681, "last_edit_date": 1525072422, "question_id": 50085708, "link": "https://stackoverflow.com/questions/50085708/get-length-of-nullable-string", "title": "Get length of nullable string", "body": "<p>I have the following structure:</p>\n\n<pre><code>type NetAuth struct {\n        Identificator *string `json:\"identificator\"`\n        Password      *string `json:\"password\"`\n        DeviceID      *string `json:\"deviceId\"`\n        Type          int  `json:\"type\"`\n}\n</code></pre>\n\n<p>I am trying to get the length of <em>Identificator</em> with  <code>len(event.Identificator)</code> however I get <em>Invalid argument for len</em></p>\n\n<p>Before calling len I check if it's nil. I am coming from Java/C#/PHP background and it's my first time writing in GO.</p>\n"}, {"tags": ["go", "go-templates"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1525006017, "post_id": 50085038, "comment_id": 87189117, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/10747054/special-case-treatment-for-the-last-element-of-a-range-in-google-gos-text-templ\" title=\"special case treatment for the last element of a range in google gos text templ\">stackoverflow.com/questions/10747054/&hellip;</a>, <a href=\"https://stackoverflow.com/questions/21305865/golang-separating-items-with-comma-in-template\" title=\"golang separating items with comma in template\">stackoverflow.com/questions/21305865/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "edited": false, "score": 1, "creation_date": 1524994484, "post_id": 50085162, "comment_id": 87186053, "body": "It makes me smile, but it works ^_^. I&#39;ve not detected the last items, ... but solved the problem. Thank you very much ^_^"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1525017972, "post_id": 50085162, "comment_id": 87193137, "body": "If you do not want the trailing dot in the case of an empty list, then use this variation on the answer <code>{{with .items}}{{range $i, $el := .}}{{if $i}},{{end}}{{$el}}{{end}}.{{end}}</code>"}], "tags": [], "owner": {"reputation": 5837, "user_id": 4445, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bc9f6e38b74914b7a1bd08694f42a58?s=128&d=identicon&r=PG", "display_name": "fhe", "link": "https://stackoverflow.com/users/4445/fhe"}, "is_accepted": true, "score": 8, "last_activity_date": 1524994277, "creation_date": 1524994277, "answer_id": 50085162, "question_id": 50085038, "link": "https://stackoverflow.com/questions/50085038/detect-last-item-inside-an-array-using-range-inside-go-templates/50085162#50085162", "title": "detect last item inside an array using range inside go-templates", "body": "<p>You can use </p>\n\n<pre><code>tpl := \"{{range $i, $el := .items}}{{if $i}},{{end}}{{$el}}{{end}}.\"\n</code></pre>\n\n<p>to achieve that. The trick is to emit the comma separator first, but not for the first item in the range.</p>\n"}, {"comments": [{"owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "edited": false, "score": 1, "creation_date": 1524995859, "post_id": 50085210, "comment_id": 87186358, "body": "Instead of You inspired me!! Instead of create a function I can pass directly the number of item of the array: &quot;{{range $i, $el := .items}}{{$el}}{{if eq $i $.last}}.{{else}},{{end}}{{end}}&quot;"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "edited": false, "score": 1, "creation_date": 1524996708, "post_id": 50085210, "comment_id": 87186598, "body": "@sensorario Yes, that&#39;s even simpler for a single case. Might be more hassle and work if you need it in many places."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 4, "last_activity_date": 1524997198, "last_edit_date": 1524997198, "creation_date": 1524994620, "answer_id": 50085210, "question_id": 50085038, "link": "https://stackoverflow.com/questions/50085038/detect-last-item-inside-an-array-using-range-inside-go-templates/50085210#50085210", "title": "detect last item inside an array using range inside go-templates", "body": "<p>In the simple example you posted, easiest is what \"fhe\" posted: you can easily check if the current index is the first, and output a comma after non-first elements. And finally output a trailing dot.</p>\n\n<p>If in a more complicated example you do need to detect the last \nitem, or it may be that the list you iterate over may be empty (and thus the trailing dot would be a mistake), you may register a custom function to tell if the current index is the last:</p>\n\n<pre><code>lister := template.Must(template.New(\"foo\").Funcs(template.FuncMap{\n    \"IsLast\": func(i, size int) bool { return i == size-1 },\n}).Parse(tpl))\n</code></pre>\n\n<p>And use the following template then:</p>\n\n<pre><code>tpl := \"{{range $i, $el := .items}}{{$el}}{{if IsLast $i (len $.items)}}.{{else}},{{end}}{{end}}\"\n</code></pre>\n\n<p>Then the output will be (try it on the <a href=\"https://play.golang.org/p/ExmBW6zJydu\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>1,4,2.\n</code></pre>\n\n<p>A variation of this could be to register a custom function which calculates the last index from the length (<code>lastIdx = length - 1</code>), and then inside the <code>{{range}}</code> you can do a simple comparison:</p>\n\n<pre><code>tpl := \"{{$lastIdx := LastIdx (len .items)}}{{range $i, $el := .items}}{{$el}}{{if eq $lastIdx $i}}.{{else}},{{end}}{{end}}\"\nlister := template.Must(template.New(\"foo\").Funcs(template.FuncMap{\n    \"LastIdx\": func(size int) int { return size - 1 },\n}).Parse(tpl))\n</code></pre>\n\n<p>Output will be the same. Try it on the <a href=\"https://play.golang.org/p/1HbV_dlO6vL\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2870, "favorite_count": 0, "accepted_answer_id": 50085162, "answer_count": 2, "score": 8, "last_activity_date": 1524997198, "creation_date": 1524993205, "last_edit_date": 1524993994, "question_id": 50085038, "link": "https://stackoverflow.com/questions/50085038/detect-last-item-inside-an-array-using-range-inside-go-templates", "title": "detect last item inside an array using range inside go-templates", "body": "<p>This program outputs simply</p>\n\n<blockquote>\n  <p>1,4,2,</p>\n</blockquote>\n\n<p>but I would like to print</p>\n\n<blockquote>\n  <p>1,4,2.</p>\n</blockquote>\n\n<p>As you can see the comma is printed after each items of an array.</p>\n\n<pre><code>package main\n\nimport \"os\"\nimport \"text/template\"\n\nfunc main() {\n    params := map[string]interface{}{\n        \"items\": [3]int{1, 4, 2},\n    }\n    tpl := \"{{range $i, $el := .items}}{{$el}},{{end}}\"\n    lister, _ := template.New(\"foo\").Parse(tpl)\n    lister.Execute(os.Stdout, params)\n}\n</code></pre>\n\n<p>Is there a way to change <code>{{range $i, $el := .items}}{{$el}},{{end}}</code> and be sure that last item will print \".\" instead of \",\"</p>\n"}, {"tags": ["go", "hash", "md5"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 2, "creation_date": 1524986367, "post_id": 50084201, "comment_id": 87184203, "body": "That&#39;s normal. That&#39;s what drawing from a uniform distribution is supposed to look like."}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 1, "creation_date": 1524987474, "post_id": 50084201, "comment_id": 87184425, "body": "Have you compared that to other MD5 implementations? AFAIK, it&#39;s a defined algorithm and implementations may differ, but not in their results! So, the &quot;go&quot;-part of your question is a red herring already."}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 1, "creation_date": 1524988275, "post_id": 50084201, "comment_id": 87184590, "body": "Also, you&#39;re throwing the outputs into 1+(2^32)/50000 buckets, not 50000. If you had thrown them into 50000 buckets, you would have seen even more outputs land in the same bucket."}, {"owner": {"reputation": 9097, "user_id": 132978, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5af2930e39246c8339fa7ad8e394e96e?s=128&d=identicon&r=PG", "display_name": "Aseem Kishore", "link": "https://stackoverflow.com/users/132978/aseem-kishore"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1525019859, "post_id": 50084201, "comment_id": 87193760, "body": "@user2357112: can you explain the buckets comment? I&#39;m dividing (with truncation) the space of all possible <code>1+(2^32)</code> values by 50000, so that <i>is</i> 50k buckets, no? That also seems correct given the answer below since only 38k of those buckets are populated."}, {"owner": {"reputation": 9097, "user_id": 132978, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5af2930e39246c8339fa7ad8e394e96e?s=128&d=identicon&r=PG", "display_name": "Aseem Kishore", "link": "https://stackoverflow.com/users/132978/aseem-kishore"}, "edited": false, "score": 0, "creation_date": 1525022518, "post_id": 50084201, "comment_id": 87194576, "body": "Ah, I realize now! I need to <code>%</code>, not <code>&#47;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1524988420, "post_id": 50084348, "comment_id": 87184628, "body": "It&#39;s actually more like taking 50000 random numbers between 0 and 85899, because the bucketing logic is wrong. That confused me for a bit - I was expecting closer to 31600 populated buckets."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1524998492, "post_id": 50084348, "comment_id": 87186994, "body": "If you&#39;re curious, the 2018 album has 682 slots. You can expect to buy about 4800 stickers to fill it if you don&#39;t trade (and don&#39;t order the last 50 from Panini): <a href=\"https://youtu.be/aKPkQCys86c\" rel=\"nofollow noreferrer\">youtu.be/aKPkQCys86c</a>"}, {"owner": {"reputation": 9097, "user_id": 132978, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5af2930e39246c8339fa7ad8e394e96e?s=128&d=identicon&r=PG", "display_name": "Aseem Kishore", "link": "https://stackoverflow.com/users/132978/aseem-kishore"}, "edited": false, "score": 0, "creation_date": 1525019755, "post_id": 50084348, "comment_id": 87193723, "body": "Makes sense! Thank you \u2014 this is very helpful. I&#39;m very curious to know how to calculate the expected &quot;clumping&quot; if you or anyone has any pointers there. :)"}], "tags": [], "owner": {"reputation": 4731, "user_id": 1737957, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/SiIu7.png?s=128&g=1", "display_name": "jwg", "link": "https://stackoverflow.com/users/1737957/jwg"}, "is_accepted": true, "score": 6, "last_activity_date": 1525080910, "last_edit_date": 1525080910, "creation_date": 1524987137, "answer_id": 50084348, "question_id": 50084201, "link": "https://stackoverflow.com/questions/50084201/why-does-golangs-md5-distribution-not-appear-to-be-uniform/50084348#50084348", "title": "Why does Golang&#39;s MD5 distribution not appear to be uniform?", "body": "<p>This is absolutely normal behavior, and doesn't show any bias or incorrectness of the MD5 implementation.</p>\n\n<p>What you are doing is (very close to) taking 50,000 random numbers between 0 and 49,999. When you do this, it's almost certain that many of the numbers will be repeated, and therefore that some numbers won't appear. It would in fact be very unlikely that the 50,000 numbers should all be different with absolutely no repetitions.</p>\n\n<p>You can test this with a six-sided dice - if you throw it 6 times, you're very unlikely to get all six numbers, and much more likely to see around 3, 4 or 5 of them, with one, two or three repetitions. It's also related to the so-called <a href=\"https://en.wikipedia.org/wiki/Birthday_problem\" rel=\"nofollow noreferrer\">birthday paradox</a>.</p>\n\n<p>Another example of this phenomenon is the 'Panini sticker question'. A Panini sticker album is a book with space for around 600 football stickers which commemorate the World Cup of soccer. Each one is numbered and different, and they feature randomly in packets. You have to get one of each number to complete the album. Suppose that you bought exactly the right number of stickers to fill the album. It would be extremely lucky if you were able to fill the album perfectly, without having any doubles or missing stickers. In fact you have to buy on average a large multiple of the number of stickers in order to get at least one of each (if you don't swap duplicates with other collectors).</p>\n\n<p>The number of different values 0-49,999 which appear and the number which show 'clumping' can be calculated mathematically. I'm not sure exactly how you measure clumping. But the value of 38K populated values will be quite stable from one trial to the next, even though the actual values you see will change.</p>\n\n<p>In fact, the expected number of populated values is (1 - 1/e)n, where n is the number of possible values, and e is the mathematical constant 2.718281828... The answer for n=50000 is 31606. You won't always get this value of course, but all results should be within a few hundred or so (spitballing here). You made a slight mistake in your program so I haven't been able to decipher the relevant calculation that gives you ~37000. </p>\n"}], "owner": {"reputation": 9097, "user_id": 132978, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5af2930e39246c8339fa7ad8e394e96e?s=128&d=identicon&r=PG", "display_name": "Aseem Kishore", "link": "https://stackoverflow.com/users/132978/aseem-kishore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 1, "accepted_answer_id": 50084348, "answer_count": 1, "score": 0, "last_activity_date": 1525080910, "creation_date": 1524985609, "last_edit_date": 1524986184, "question_id": 50084201, "link": "https://stackoverflow.com/questions/50084201/why-does-golangs-md5-distribution-not-appear-to-be-uniform", "title": "Why does Golang&#39;s MD5 distribution not appear to be uniform?", "body": "<p>I fully expect I have a bug somewhere or am misunderstanding something, but why does the following code not appear to exhibit uniform distribution?</p>\n\n<pre><code>func TestMD5(t *testing.T) {\n    n := 50000\n    counts := map[uint32]int{} // # of hashes per 1/nth shard\n\n    for i := 0; i &lt; n; i++ {\n        hash := md5.Sum(newUUID())\n        result := binary.BigEndian.Uint32(hash[:4])\n        counts[result/uint32(n)]++\n    }\n\n    dupeShards := 0\n    dupeEntries := 0\n    for _, count := range counts {\n        if count &gt; 1 {\n            dupeShards++\n            dupeEntries += count - 1\n        }\n    }\n    t.Logf(\"%d inputs hashed to the same %d shards as other inputs.\", dupeEntries, dupeShards)\n\n    if len(counts) &lt; n*95/100 {\n        t.Fatalf(\"%d populated shards not within 5%% of expected %d uniform distribution!\", len(counts), n)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/05mA0Dl9GBG\" rel=\"nofollow noreferrer\">https://play.golang.org/p/05mA0Dl9GBG</a></p>\n\n<p>\u2014</p>\n\n<p>Explanation of code:</p>\n\n<ul>\n<li>MD5 50k random UUIDs.</li>\n<li>For each MD5 sum, take the first 4 bytes and convert to a uint32.</li>\n<li>Divide the result by 50k (using truncated/floor division) to distribute the hashes into 50k evenly spaced shards.</li>\n</ul>\n\n<p>==> I'd expect the 50k MD5 sums to be ~evenly distributed across the 50k shards, but I consistently see only ~38k shards populated, with clumping in ~10k of the shards:</p>\n\n<pre><code>main.go:29: 12075 inputs hashed to the same 9921 shards as other inputs.\nmain.go:32: 37925 populated shards not within 5% of expected 50000 uniform distribution!\n</code></pre>\n\n<p>I can repro this with other hashes too (e.g. FNV), so I'm guessing I'm misunderstanding something. Thank you for the help!</p>\n"}, {"tags": ["google-app-engine", "go", "https"], "answers": [{"tags": [], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "is_accepted": false, "score": 0, "last_activity_date": 1524980627, "last_edit_date": 1524980627, "creation_date": 1524980244, "answer_id": 50083715, "question_id": 50083289, "link": "https://stackoverflow.com/questions/50083289/how-to-properly-enable-https-on-app-engine-flex-environment-and-go/50083715#50083715", "title": "How to properly enable HTTPS on App Engine flex environment and Go?", "body": "<p>You need to check your app using:</p>\n\n<pre><code>http://[YOUR_PROJECT_ID].appspot.com\n</code></pre>\n\n<p>Or if you nedd HTTPS:</p>\n\n<pre><code>https://[YOUR_PROJECT_ID].appspot.com\n</code></pre>\n\n<p>If you want your own certificate you will need to upload it and then be available to use: <a href=\"https://your-domain.tld\" rel=\"nofollow noreferrer\">https://your-domain.tld</a></p>\n\n<p>From the <a href=\"https://cloud.google.com/endpoints/docs/openapi/configure-endpoints\" rel=\"nofollow noreferrer\">docs</a>: </p>\n\n<ul>\n<li><p>For APIs that will be hosted on App Engine flexible environment, you must use the appspot.com domain, and the service name must be in the following format: \n<code>YOUR_PROJECT_ID.appspot.com</code></p>\n\n<p>When you deploy your API to App Engine, a DNS entry with a name in the format <code>YOUR_PROJECT_ID.appspot.com</code> is created automatically.</p></li>\n<li><p>For APIs that will be hosted on Compute Engine, Kubernetes Engine, or Kubernetes, you must use the cloud.goog domain, and the service name must be in the following format:\n<code>YOUR_API_NAME.endpoints.YOUR_PROJECT_ID.cloud.goog</code></p></li>\n</ul>\n\n<p>Or you could just put a CDN in front like Cloudflare which will do all the SSL termination for you and if required <a href=\"https://support.cloudflare.com/hc/en-us/articles/200170536-How-do-I-redirect-all-visitors-to-HTTPS-SSL-\" rel=\"nofollow noreferrer\">redirect all HTTP to HTTPS</a></p>\n"}, {"tags": [], "owner": {"reputation": 401, "user_id": 3324751, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/654dbe483626fc572507566155c2a389?s=128&d=identicon&r=PG&f=1", "display_name": "hagh", "link": "https://stackoverflow.com/users/3324751/hagh"}, "is_accepted": false, "score": 1, "last_activity_date": 1525074669, "creation_date": 1525074669, "answer_id": 50096142, "question_id": 50083289, "link": "https://stackoverflow.com/questions/50083289/how-to-properly-enable-https-on-app-engine-flex-environment-and-go/50096142#50096142", "title": "How to properly enable HTTPS on App Engine flex environment and Go?", "body": "<p>For the second set of my problems I realized I have mixed content on my page. My mixed content was a http link to a set of fonts. When I fixed the mixed content, i.e. changed http to https, both Chrome and Firefox security warnings disappeared. You may also find this page <a href=\"https://developers.google.com/web/updates/2016/10/avoid-not-secure-warn\" rel=\"nofollow noreferrer\">Avoiding the Not Secure Warning in Chrome</a> useful on this matter.</p>\n"}], "owner": {"reputation": 401, "user_id": 3324751, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/654dbe483626fc572507566155c2a389?s=128&d=identicon&r=PG&f=1", "display_name": "hagh", "link": "https://stackoverflow.com/users/3324751/hagh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 705, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1525074669, "creation_date": 1524974868, "last_edit_date": 1525071109, "question_id": 50083289, "link": "https://stackoverflow.com/questions/50083289/how-to-properly-enable-https-on-app-engine-flex-environment-and-go", "title": "How to properly enable HTTPS on App Engine flex environment and Go?", "body": "<p>I am trying to enable HTTPS on my Go App deployed to GAE flex environment. I have my custom domain successfully mapped, and am using Google-managed SSL certificates. I have app.yaml configured to redirect HTTP to HTTPS as follows:</p>\n\n<pre><code>handlers:\n- url: /.*\n  script: _go_app\n  secure: always\n</code></pre>\n\n<p>Now there are two problems that I haven't been able to resolve so far.</p>\n\n<p><strong>First</strong>, the above configuration is supposed to redirect HTTP traffic to HTTPS, but apparently it is not happening.</p>\n\n<p><strong>Second</strong>, when I add <code>https://</code> in the url box, I see three different behavior on Firefox, Chrome, and Edge. Edge identifies the website as secure, Firefox marks the website as secure connection, but says that it \"has blocked parts of this page that are not secure\", and surprisingly Chrome marks the website as Not secure (though it says certificate is valid!).</p>\n\n<p>With these symptoms I was wondering if I should take additional steps to make redirecting and SSL work for my website? Specifically, I would like to know with App Engine, and managed SSL enabled:</p>\n\n<ol>\n<li><p>Should I continue serving pages on HTTP using <code>http.ListenAndServe(..)</code>, or need to switch to <code>http.ListenAndServeTLS(..)</code>?</p></li>\n<li><p>In my Go app should I redirect HTTP to HTTPS? or the above setting is expected to work just fine?</p></li>\n</ol>\n\n<p>Thanks in advance for your help and advice.</p>\n\n<p>PS:\nTrying out with different suggestions, I added <code>Strict-Transport-Security: max-age=31536000; includeSubDomains</code> to handlers' response. Does not seem if this helped with redirection either.</p>\n\n<p><strong>EDIT/PARTIAL ANSWER:</strong></p>\n\n<p>According to this <a href=\"https://cloud.google.com/appengine/docs/flexible/go/upgrading\" rel=\"nofollow noreferrer\">documentation</a>, under <strong>Authentication changes</strong>, the <code>secure</code> and <code>login</code> handlers are deprecated. The documentation suggests using <code>Strict-Transport-Security</code> or <code>X-Forwarded-Proto</code> instead.</p>\n\n<p>I am using <code>Strict-Transport-Security</code> on the server side to enrich my response header:</p>\n\n<pre><code>func (h *STLHandler) ServeHTTP(w http.ResponseWriter, req *http.Request) {\n    w.Header().Add(\"Strict-Transport-Security\", \"max-age=63072000; includeSubDomains\")\n    h.nextHandler.ServeHTTP(w, req)\n}\n</code></pre>\n\n<p>I was wondering if I am using this header in the right place?</p>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 394, "user_id": 4794989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kl1aC.jpg?s=128&g=1", "display_name": "Alireza Bashiri", "link": "https://stackoverflow.com/users/4794989/alireza-bashiri"}, "is_accepted": true, "score": 2, "last_activity_date": 1524968202, "creation_date": 1524968202, "answer_id": 50082792, "question_id": 50082572, "link": "https://stackoverflow.com/questions/50082572/referencing-gorm-auto-generated-fields-in-go/50082792#50082792", "title": "Referencing GORM auto-generated fields in Go", "body": "<p><code>gorm.Model</code> is a struct including some basic fields, which including fields <code>ID</code>, <code>CreatedAt</code>, <code>UpdatedAt</code>, <code>DeletedAt</code>.</p>\n\n<p>Reference: <a href=\"http://gorm.io/docs/conventions.html#gorm-Model\" rel=\"nofollow noreferrer\">http://gorm.io/docs/conventions.html#gorm-Model</a></p>\n"}], "owner": {"reputation": 1125, "user_id": 5086986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tbFSD.jpg?s=128&g=1", "display_name": "jnelson", "link": "https://stackoverflow.com/users/5086986/jnelson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 598, "favorite_count": 0, "accepted_answer_id": 50082792, "answer_count": 1, "score": 0, "last_activity_date": 1524968202, "creation_date": 1524965333, "question_id": 50082572, "link": "https://stackoverflow.com/questions/50082572/referencing-gorm-auto-generated-fields-in-go", "title": "Referencing GORM auto-generated fields in Go", "body": "<p>I'm writing my first API, so bear with me. I am using Go, Postgres and GORM and a slew of other things I'm still picking up but I ran into an issue with GORM's AutoMigrate.</p>\n\n<p>Initially my User struct looked like this:</p>\n\n<pre><code>type User struct {\n    gorm.Model\n    Email    string `gorm:\"unique\" json:\"email\"`\n    Password string `json:\"password\"`\n}\n</code></pre>\n\n<p>And when I ran <code>db.AutoMigrate(&amp;User{})</code> It auto-generated an id field in my User table (along with several date fields), which I wanted. What I am hung up on is figuring out how to reference these fields in my app. I have modified my User struct to now look like this:</p>\n\n<pre><code>type User struct {\n    gorm.Model\n    ID       int    `gorm:\"primary_key\" json:\"id\"`\n    Email    string `gorm:\"unique\" json:\"email\"`\n    Password string `json:\"password\"`\n}\n</code></pre>\n\n<p>But instead of linking the two id fields, when I access the stored user object as shown:</p>\n\n<pre><code>user := model.User{}\nif err := db.First(&amp;user, model.User{Email: email}).Error; err != nil {\n    respondError(w, http.StatusNotFound, err.Error())\n    return nil\n}\n</code></pre>\n\n<p>there are now two distinct fields, the auto-generated and my own:</p>\n\n<pre><code>{\n\"ID\": 2,\n\"CreatedAt\": \"2018-04-28T21:14:20.828547-04:00\",\n\"UpdatedAt\": \"2018-04-28T21:14:20.828547-04:00\",\n\"DeletedAt\": null,\n\"id\": 0,\n\"email\": \"joeynelson@gmail.com\",\n\"password\": &lt;hash&gt;\n}\n</code></pre>\n\n<p>I realize the answer is likely right in front of my face, there must be a way to reference these auto-generated fields, right?</p>\n"}, {"tags": ["go", "model", "associations", "one-to-many", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 394, "user_id": 4794989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kl1aC.jpg?s=128&g=1", "display_name": "Alireza Bashiri", "link": "https://stackoverflow.com/users/4794989/alireza-bashiri"}, "is_accepted": true, "score": 3, "last_activity_date": 1524967669, "creation_date": 1524967669, "answer_id": 50082757, "question_id": 50082251, "link": "https://stackoverflow.com/questions/50082251/entity-association-to-itself-with-one-to-many-relationships/50082757#50082757", "title": "Entity association to itself with one-to-many relationships", "body": "<p>You must declare <code>Parent</code> as <code>*Category</code> (a pointer to <code>Category</code>) instead of <code>Category</code>.</p>\n\n<pre><code>type Category struct {\n Name string `json:\"name\"`\n Parent *Category `json:\"parent_category\"`\n ParentGroupID uint `json:\"parent_group_id\"`\n Children []Category `json:\"children_categories\"`\n}\n</code></pre>\n\n<p>How does compiler know what the size of <code>Parent</code> is. A pointer's size is known, but how big is something that contains itself? (And the inner struct contains itself as well, as does the inner inner struct, and so on.)</p>\n\n<p>Reference: <a href=\"https://stackoverflow.com/a/8261789/4794989\">https://stackoverflow.com/a/8261789/4794989</a></p>\n"}], "owner": {"reputation": 15341, "user_id": 2228325, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/Vn6At.png?s=128&g=1", "display_name": "TonyGW", "link": "https://stackoverflow.com/users/2228325/tonygw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "accepted_answer_id": 50082757, "answer_count": 1, "score": 0, "last_activity_date": 1525015134, "creation_date": 1524961322, "last_edit_date": 1525015134, "question_id": 50082251, "link": "https://stackoverflow.com/questions/50082251/entity-association-to-itself-with-one-to-many-relationships", "title": "Entity association to itself with one-to-many relationships", "body": "<p>I use GORM to build model associations in Golang and I have a struct named <strong>Category</strong>. A category can have many children categories and it may have a parent category:</p>\n\n<pre><code>type Category struct {\n Name string `json:\"name\"`\n Parent Category `json:\"parent_category\"`\n ParentGroupID uint `json:\"parent_group_id\"`\n Children []Category `json:\"children_categories\"`\n}\n</code></pre>\n\n<p>For this struct, I got an error for <strong>Invalid recursive type Category</strong>. I checked the GORM documentation but did not find anything helpful there. Any ideas how to model this kind of relation with GORM?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2045, "user_id": 2892621, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/BwStM.jpg?s=128&g=1", "display_name": "JDOaktown", "link": "https://stackoverflow.com/users/2892621/jdoaktown"}, "edited": false, "score": 1, "creation_date": 1524960748, "post_id": 50081925, "comment_id": 87180304, "body": "links are ok to use but not exclusively. Links can be unreliable. Please post your code directly into the question."}], "answers": [{"comments": [{"owner": {"reputation": 821, "user_id": 3314723, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/YHenk.png?s=128&g=1", "display_name": "cfernandezlinux", "link": "https://stackoverflow.com/users/3314723/cfernandezlinux"}, "edited": false, "score": 0, "creation_date": 1524961668, "post_id": 50082140, "comment_id": 87180480, "body": "they thanks ! I apreciate it, I am on the move now will review as soon I get back to my apt, my original link pointed to github for a reason.. everything is referenced on main.go  if you want to take a look there. will get back to you when Im home see if your solution works, about the style I was following the tips from vim-go. thanks again  PS: here is the github with the whole project  <a href=\"https://github.com/ReK2Fernandez/GoEnumerator/blob/master/portscan.go\" rel=\"nofollow noreferrer\">github.com/ReK2Fernandez/GoEnumerator/blob/master/portscan.g&zwnj;&#8203;o</a>"}, {"owner": {"reputation": 3183, "user_id": 216345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffc76b5c6c4607d55b0796da63d67f0?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/216345/thomas"}, "reply_to_user": {"reputation": 821, "user_id": 3314723, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/YHenk.png?s=128&g=1", "display_name": "cfernandezlinux", "link": "https://stackoverflow.com/users/3314723/cfernandezlinux"}, "edited": false, "score": 0, "creation_date": 1524966846, "post_id": 50082140, "comment_id": 87181236, "body": "No problem. I see the main file now. I would strongly urge you to reconsider the excessive use of globals. It doesn&#39;t seem necessary and you&#39;ve got functions in different files both shadowing and setting globals defined in other files. If you try to adapt me code, be careful."}, {"owner": {"reputation": 821, "user_id": 3314723, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/YHenk.png?s=128&g=1", "display_name": "cfernandezlinux", "link": "https://stackoverflow.com/users/3314723/cfernandezlinux"}, "edited": false, "score": 0, "creation_date": 1524985803, "post_id": 50082140, "comment_id": 87184085, "body": "thanks, yeah I will refactor everything as soon I get it working as I want. I implemented your code &quot;somehow&quot; lol  so is working as before with the changes but still not getting the upper ports.. max I get is  4444 etc never gets to the 50K something. <a href=\"https://github.com/ReK2Fernandez/GoEnumerator/blob/master/portscan.go\" rel=\"nofollow noreferrer\">github.com/ReK2Fernandez/GoEnumerator/blob/master/portscan.g&zwnj;&#8203;o</a>  changes are commited."}, {"owner": {"reputation": 3183, "user_id": 216345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffc76b5c6c4607d55b0796da63d67f0?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/216345/thomas"}, "reply_to_user": {"reputation": 821, "user_id": 3314723, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/YHenk.png?s=128&g=1", "display_name": "cfernandezlinux", "link": "https://stackoverflow.com/users/3314723/cfernandezlinux"}, "edited": false, "score": 0, "creation_date": 1525014341, "post_id": 50082140, "comment_id": 87191810, "body": "So I tested out your code and I suspect you&#39;re hitting the same issue I am. Your&#39;e exceeding your open file limit trying to open ~65000 connections at once. You should limit the number of goroutines actually connecting."}, {"owner": {"reputation": 3183, "user_id": 216345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffc76b5c6c4607d55b0796da63d67f0?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/216345/thomas"}, "reply_to_user": {"reputation": 821, "user_id": 3314723, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/YHenk.png?s=128&g=1", "display_name": "cfernandezlinux", "link": "https://stackoverflow.com/users/3314723/cfernandezlinux"}, "edited": false, "score": 0, "creation_date": 1525036782, "post_id": 50082140, "comment_id": 87199039, "body": "@cfernandezlinux I&#39;ve redone the answer. Please take my advice to heart. You have some serious design issues, almost entirely rooted in mutation of global state. In addition to that unbounded concurrency and failure to clean up resources after use also cause many problems. I would strongly suggest you read the documentation for the APIs you are using, especially when they involve system/os level resources."}, {"owner": {"reputation": 821, "user_id": 3314723, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/YHenk.png?s=128&g=1", "display_name": "cfernandezlinux", "link": "https://stackoverflow.com/users/3314723/cfernandezlinux"}, "edited": false, "score": 1, "creation_date": 1525047355, "post_id": 50082140, "comment_id": 87201235, "body": "hey thanks so much, really I love that you are not just giving me a solution but also style and software tips, as you can see I am not a software engineer..  I can code but I learn myself and come from the systems/network/hacking side of tech, so any tips and pointing me in the right direction is always much apreciated.. I think this is one of the best ever help I got when it comes to coding. as you can see in my code is mostly hacks and figuring things out on my own. so the fact that you are giving me such much good information is amazing. will test and refactor if portmap works. tx"}], "tags": [], "owner": {"reputation": 3183, "user_id": 216345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffc76b5c6c4607d55b0796da63d67f0?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/216345/thomas"}, "is_accepted": true, "score": 2, "last_activity_date": 1525036659, "last_edit_date": 1525036659, "creation_date": 1524960071, "answer_id": 50082140, "question_id": 50081925, "link": "https://stackoverflow.com/questions/50081925/go-channels-tcp-ip-portmap-not-returning-all-open-ports/50082140#50082140", "title": "Go channels, tcp/ip portmap not returning all open ports", "body": "<p>Your code has a few problems. In <code>grabBanner</code> you appear to be referencing <code>openPorts</code> but it is not defined anywhere. You're probably referencing a global variable and this append operation is not going to be thread safe. In addition to your thread safety issues you also are likely exhausting file descriptor limits. Perhaps you should limit the amount of concurrent work by doing something like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net\"\n    \"strconv\"\n    \"sync\"\n    \"time\"\n)\n\nfunc main() {\n    fmt.Println(portScan(\"127.0.0.1\", 1, 65535))\n}\n\n// startBanner spins up a handful of async workers\nfunc startBannerGrabbers(num int, target string, portsIn &lt;-chan int) &lt;-chan int {\n    portsOut := make(chan int)\n\n    var wg sync.WaitGroup\n\n    wg.Add(num)\n\n    for i := 0; i &lt; num; i++ {\n        go func() {\n            for p := range portsIn {\n                if grabBanner(target, p) {\n                    portsOut &lt;- p\n                }\n            }\n            wg.Done()\n        }()\n    }\n\n    go func() {\n        wg.Wait()\n        close(portsOut)\n    }()\n\n    return portsOut\n\n}\n\nfunc portScan(targetToScan string, portStart int, portEnd int) []int {\n    ports := make(chan int)\n\n    go func() {\n        for port := portStart; port &lt;= portEnd; port++ {\n            ports &lt;- port\n        }\n        close(ports)\n    }()\n\n    resultChan := startBannerGrabbers(16, targetToScan, ports)\n\n    var openPorts []int\n    for port := range resultChan {\n        openPorts = append(openPorts, port)\n    }\n\n    return openPorts\n}\n\nvar targetPorts = make(map[int]string)\n\nfunc grabBanner(ip string, port int) bool {\n    connection, err := net.DialTimeout(\n        \"tcp\",\n        ip+\":\"+strconv.Itoa(port),\n        time.Second*20)\n\n    if err != nil {\n        return false\n    }\n    defer connection.Close() // you should close this!\n\n    buffer := make([]byte, 4096)\n    connection.SetReadDeadline(time.Now().Add(time.Second * 5))\n    numBytesRead, err := connection.Read(buffer)\n\n    if err != nil {\n        return true\n    }\n\n    // here we add to map port and banner\n    // ******* MAPS ARE NOT SAFE FOR CONCURRENT WRITERS ******\n    // *******************  DO NOT DO THIS *******************\n    targetPorts[port] = string(buffer[0:numBytesRead])\n\n    return true\n}\n</code></pre>\n\n<p>Your usage of <code>var open bool</code> and constantly setting it, then returning it is both unnecessary and non-idiomatic. In addition, checking <code>if someBoolVar != false</code> is a non-idiomatic and verbose way of writing <code>if someBoolVar</code>.</p>\n\n<p>Additionally maps are not safe for concurrent access but your grabBanner function is writing to map from many go routines in a concurrent fashion. <em>Please stop mutating global state inside of functions</em>. Return values instead.</p>\n\n<p>Here's an updated explanation of what's going on. First we make a channel that we will push port numbers onto for our workers to process. Then we start a go-routine that will write ports in the range onto that channel as fast as it can. Once we've written every port available onto that channel we close the channel so that our readers will be able to exit.</p>\n\n<p>Then we call a method that starts a configurable number of <code>bannerGrabber</code> workers. We pass the ip address and the channel to read candidate port numbers off of. This function spawns <code>num</code> goroutines, each ranging over the <code>portsIn</code> channel that was passed, calls the <code>grab banner</code> function and then pushes the port onto the outbound channel if it was successful. Finally, we start one more go routine that waits on the <code>sync.WaitGroup</code> to finish so we can close the outgoing (result) channel once all of the workers are done.</p>\n\n<p>Back in the <code>portScan</code> function We receive the outbound channel as the return value from the <code>startBannerGrabbers</code> function. We then range over the result channel that was returned to us, append all the open ports to the list and then return the result.</p>\n\n<p>I also changed some stylistic things, such as down-casing your function argument names.</p>\n\n<p>At risk of sounding like a broken record I am going to emphasize the following again. <strong>Stop mutating global state</strong>. Instead of setting <code>targetPorts</code> you should accumulate these values in a concurrency-safe manner and return them to the caller for use. It appears your usage of globals in this case is ill-thought out a mixture of convenience and not having thought about how to solve the problem without globals.</p>\n"}], "owner": {"reputation": 821, "user_id": 3314723, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/YHenk.png?s=128&g=1", "display_name": "cfernandezlinux", "link": "https://stackoverflow.com/users/3314723/cfernandezlinux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 50082140, "answer_count": 1, "score": 1, "last_activity_date": 1525036659, "creation_date": 1524957627, "last_edit_date": 1524961400, "question_id": 50081925, "link": "https://stackoverflow.com/questions/50081925/go-channels-tcp-ip-portmap-not-returning-all-open-ports", "title": "Go channels, tcp/ip portmap not returning all open ports", "body": "<p>I have been learning Golang to move all my penetration testing tools to it. Since I like to write my own tools this is a perfect way to learn a new language. In this particular case I think something is wrong with the way I am using channels. I know for a fact that is not finishing the port mapping because the other tools I use that I wrote on ruby are finding all the open ports but my golang tool is not. Can someone please help me understand what I'm doing wrong? Are channels the right way to go about doing this?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net\"\n    \"strconv\"\n    \"time\"\n)\n\nfunc portScan(TargetToScan string, PortStart int, PortEnd int, openPorts []int) []int {\n    activeThreads := 0\n    doneChannel := make(chan bool)\n\n    for port := PortStart; port &lt;= PortEnd; port++ {\n        go grabBanner(TargetToScan, port, doneChannel)\n        activeThreads++\n    }\n\n    // Wait for all threads to finish\n    for activeThreads &gt; 0 {\n        &lt;-doneChannel\n        activeThreads--\n    }\n    return openPorts\n}\n\nfunc grabBanner(ip string, port int, doneChannel chan bool) {\n    connection, err := net.DialTimeout(\n        \"tcp\",\n        ip+\":\"+strconv.Itoa(port),\n        time.Second*10)\n    if err != nil {\n        doneChannel &lt;- true\n        return\n    }\n    // append open port to slice\n    openPorts = append(openPorts, port)\n\n    fmt.Printf(\"+ Port %d: Open\\n\", port)\n    // See if server offers anything to read\n    buffer := make([]byte, 4096)\n    connection.SetReadDeadline(time.Now().Add(time.Second * 5))\n    // Set timeout\n    numBytesRead, err := connection.Read(buffer)\n    if err != nil {\n        doneChannel &lt;- true\n        return\n    }\n    log.Printf(\"+ Banner of port %d\\n%s\\n\", port,\n        buffer[0:numBytesRead])\n    // here we add to map port and banner\n    targetPorts[port] = string(buffer[0:numBytesRead])\n\n    doneChannel &lt;- true\n    return\n}\n</code></pre>\n\n<p>Note: seems to find the first bunch ports but not the ones that are above a hight number example 8080  but it usually does get 80 and 443...\nSo I suspect something is timing out, or something odd is going on.</p>\n\n<p>There are lots of bad hacks of code, mostly because I'm learning and searching a lot in how to do things, so feel free to give tips and even changes/pull requests. thanks</p>\n"}, {"tags": ["go", "memory-leaks", "channel", "goroutine"], "comments": [{"owner": {"reputation": 3183, "user_id": 216345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffc76b5c6c4607d55b0796da63d67f0?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/216345/thomas"}, "edited": false, "score": 0, "creation_date": 1524956618, "post_id": 50081803, "comment_id": 87179663, "body": "You should check your error when you call <code>proxy.SOCKS5</code>"}, {"owner": {"reputation": 3183, "user_id": 216345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffc76b5c6c4607d55b0796da63d67f0?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/216345/thomas"}, "edited": false, "score": 1, "creation_date": 1524956859, "post_id": 50081803, "comment_id": 87179692, "body": "Also the docs say you should close the response from calling <code>Get</code>. Not sure if it&#39;s your problem at the moment but you might want to bind that variable and call its <code>Close</code> method."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1524961200, "post_id": 50081803, "comment_id": 87180397, "body": "I want to say something stronger than the previous comment. The application <b>must</b> close the response response body when Get returns successfully.  This is one cause of the issues you are seeing and possibly the only cause."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1524998726, "post_id": 50081803, "comment_id": 87187048, "body": "Close the response body and don&#39;t create a new client for each request (or more precisely, a new Transport). Each Transport maintains its own connection pool, and since you don&#39;t disable keep-alive, you end up with lots of idle connections that are never reused."}, {"owner": {"reputation": 43, "user_id": 9715839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eccd68c9aafc059372780cdb26c737ec?s=128&d=identicon&r=PG&f=1", "display_name": "H.Denison", "link": "https://stackoverflow.com/users/9715839/h-denison"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1525001108, "post_id": 50081803, "comment_id": 87187671, "body": "@Peter i changed code like this <code>httpClient := &amp;http.Client{Timeout: timeout, Transport: &amp;http.Transport{DisableKeepAlives: true, Dial: dialer.Dial}}</code> but it couldn&#39;t help. Or i&#39;m doing it wrong? Maybe you have an example?"}, {"owner": {"reputation": 503, "user_id": 3098902, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EQSV3.jpg?s=128&g=1", "display_name": "she7ata", "link": "https://stackoverflow.com/users/3098902/she7ata"}, "edited": false, "score": 0, "creation_date": 1525348927, "post_id": 50081803, "comment_id": 87326679, "body": "I think he means to move that line to else where, so it&#39;s created once and used by CheckProxySOCKS function as many times, without re-creating it each time."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 9715839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eccd68c9aafc059372780cdb26c737ec?s=128&d=identicon&r=PG&f=1", "display_name": "H.Denison", "link": "https://stackoverflow.com/users/9715839/h-denison"}, "edited": false, "score": 0, "creation_date": 1524998396, "post_id": 50083533, "comment_id": 87186974, "body": "i&#39;m refactored code as you suggest but nothing change"}, {"owner": {"reputation": 503, "user_id": 3098902, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EQSV3.jpg?s=128&g=1", "display_name": "she7ata", "link": "https://stackoverflow.com/users/3098902/she7ata"}, "reply_to_user": {"reputation": 43, "user_id": 9715839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eccd68c9aafc059372780cdb26c737ec?s=128&d=identicon&r=PG&f=1", "display_name": "H.Denison", "link": "https://stackoverflow.com/users/9715839/h-denison"}, "edited": false, "score": 0, "creation_date": 1525215110, "post_id": 50083533, "comment_id": 87267940, "body": "can you please move: `    res.Body.Close()` above the ioutil.ReadAll, it won&#39;t fix the memory leak, but just to be sure. Don&#39;t forget to add <code>defer</code> before it."}], "tags": [], "owner": {"reputation": 503, "user_id": 3098902, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EQSV3.jpg?s=128&g=1", "display_name": "she7ata", "link": "https://stackoverflow.com/users/3098902/she7ata"}, "is_accepted": false, "score": 1, "last_activity_date": 1524977936, "creation_date": 1524977936, "answer_id": 50083533, "question_id": 50081803, "link": "https://stackoverflow.com/questions/50081803/goroutines-memory-leak/50083533#50083533", "title": "Goroutines memory leak", "body": "<p>Your problem lies in not closing the response body, in this line:</p>\n\n<pre><code>_, err := httpClient.Get(\"https://api.ipify.org?format=json\")\n</code></pre>\n\n<p>get the response variable and close the body in defer, like this:</p>\n\n<pre><code>r, err := httpClient.Get(\"https://api.ipify.org?format=json\")\nif err != nil {\n    c &lt;- QR{Addr: prox, Res: false}\n    return\n}\ndefer r.Body.Close()\n\nc &lt;- QR{Addr: prox, Res: true}\n</code></pre>\n\n<p>in the docs <code>The client must close the response body when finished with it:</code> <a href=\"https://golang.org/pkg/net/http/\" rel=\"nofollow noreferrer\">here</a></p>\n"}, {"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 1, "last_activity_date": 1525093198, "last_edit_date": 1592644375, "creation_date": 1525092893, "answer_id": 50101013, "question_id": 50081803, "link": "https://stackoverflow.com/questions/50081803/goroutines-memory-leak/50101013#50101013", "title": "Goroutines memory leak", "body": "<p>You're not always closing the connection, and you're using a new Client <em>and</em> Transport every request. If you discard the transport, you discard any connections in the idle pool, leaking those resources.</p>\n<p>From the <a href=\"https://golang.org/pkg/net/http/#Transport\" rel=\"nofollow noreferrer\"><code>http.Transport</code> docs</a></p>\n<blockquote>\n<p>By default, Transport caches connections for future re-use. This may leave many open connections when accessing many hosts. This behavior can be managed using Transport's CloseIdleConnections method and the MaxIdleConnsPerHost and DisableKeepAlives fields.</p>\n<p>Transports should be reused instead of created as needed. Transports are safe for concurrent use by multiple goroutines.</p>\n</blockquote>\n<p>Always close the response body when there is no error, and always reuse the transport.</p>\n"}], "owner": {"reputation": 43, "user_id": 9715839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eccd68c9aafc059372780cdb26c737ec?s=128&d=identicon&r=PG&f=1", "display_name": "H.Denison", "link": "https://stackoverflow.com/users/9715839/h-denison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1290, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1525093198, "creation_date": 1524956278, "last_edit_date": 1524999100, "question_id": 50081803, "link": "https://stackoverflow.com/questions/50081803/goroutines-memory-leak", "title": "Goroutines memory leak", "body": "<p><strong>UPD:</strong> Refactored code, nothing change</p>\n\n<p>I'm have memory leak in this function but i don't know where.</p>\n\n<pre><code>func CheckProxySOCKS(prox string, c chan QR) (err error) {\n\n    //Sending request through proxy\n    dialer, _ := proxy.SOCKS5(\"tcp\", prox, nil, proxy.Direct)\n    timeout := time.Duration(5 * time.Second)\n    httpClient := &amp;http.Client{Timeout: timeout, Transport: &amp;http.Transport{Dial: dialer.Dial}}\n    res, err := httpClient.Get(\"https://api.ipify.org?format=json\")\n\n    if err != nil {\n\n        c &lt;- QR{Addr: prox, Res: false}\n        return\n    }\n\n    _, err = ioutil.ReadAll(res.Body)\n    res.Body.Close()\n    if err != nil {\n        return\n    }\n\n    c &lt;- QR{Addr: prox, Res: true}\n    return\n}\n</code></pre>\n\n<p>Here i called it</p>\n\n<pre><code>for _, proxy := range splitedProxies {\n    go code.CheckProxySOCKS(proxy, respChan)\n}\n\nfor range splitedProxies {\n    r := &lt;-respChan\n    if r.Res {\n        checkedProxiesArray = append(checkedProxiesArray, r.Addr)\n    }\n}\n</code></pre>\n\n<p>After 3-4 cycle i'v got more than 40k goroutines(i'v check it by <code>runtime.NumGoroutine()</code>). After start app used around 100mb after 4 cycle more than 1GB</p>\n\n<p><a href=\"https://github.com/trigun117/ProxyGrabber\" rel=\"nofollow noreferrer\">Github</a> repo with all code</p>\n"}, {"tags": ["go", "mocking", "retrypolicy", "retry-logic", "http-mock"], "comments": [{"owner": {"reputation": 3183, "user_id": 216345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffc76b5c6c4607d55b0796da63d67f0?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/216345/thomas"}, "edited": false, "score": 0, "creation_date": 1524951651, "post_id": 50081104, "comment_id": 87178562, "body": "Instead of Mocking the http requests you could define a minimal interface that returns the data you expect from the http call or an error. Then you can make a test implementation that fails a few times before succeeding."}, {"owner": {"reputation": 433, "user_id": 1813415, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ae0b3dd5cb7bbbcfc21b19c79807625c?s=128&d=identicon&r=PG", "display_name": "diwakarb", "link": "https://stackoverflow.com/users/1813415/diwakarb"}, "reply_to_user": {"reputation": 3183, "user_id": 216345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffc76b5c6c4607d55b0796da63d67f0?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/216345/thomas"}, "edited": false, "score": 0, "creation_date": 1524953603, "post_id": 50081104, "comment_id": 87179025, "body": "I have kept this as a last resort. Because, I might have to extend/use my current class with the said minimal interface and that will change the current structure of my code. Doesn&#39;t go have a mature mocking framework for these purposes ? Something like what mockito have in Java: <a href=\"https://static.javadoc.io/org.mockito/mockito-core/2.10.0/org/mockito/Mockito.html#stubbing_consecutive_calls\" rel=\"nofollow noreferrer\">static.javadoc.io/org.mockito/mockito-core/2.10.0/org/mockit&zwnj;&#8203;o/&hellip;</a>"}, {"owner": {"reputation": 3183, "user_id": 216345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffc76b5c6c4607d55b0796da63d67f0?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/216345/thomas"}, "edited": false, "score": 0, "creation_date": 1524954534, "post_id": 50081104, "comment_id": 87179289, "body": "I&#39;ve used the mock package from <a href=\"https://github.com/stretchr/testify\" rel=\"nofollow noreferrer\">github.com/stretchr/testify</a> and <a href=\"http://github.com/vektra/mockery\" rel=\"nofollow noreferrer\">github.com/vektra/mockery</a> to generate the mock code. Not sure if it has the feature you want. I found it cumbersome to work with. I think generally mocks are not considered a great practice in go and using a simple interface and test implementation are more idiomatic. YMMV of course."}, {"owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "edited": false, "score": 2, "creation_date": 1524957505, "post_id": 50081104, "comment_id": 87179795, "body": "&quot;But this one does not provide functionality to mock the response of first and second url separately. &quot; sure it does, you can pass a function with custom logic, as explained in advanced example on the page you linked."}, {"owner": {"reputation": 433, "user_id": 1813415, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ae0b3dd5cb7bbbcfc21b19c79807625c?s=128&d=identicon&r=PG", "display_name": "diwakarb", "link": "https://stackoverflow.com/users/1813415/diwakarb"}, "edited": false, "score": 0, "creation_date": 1524962222, "post_id": 50081104, "comment_id": 87180578, "body": "It looks like it&#39;ll work, I&#39;ll give it a try. Thanks for suggesting."}], "answers": [{"tags": [], "owner": {"reputation": 2476, "user_id": 5788720, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tkE-8jM--HE/AAAAAAAAAAI/AAAAAAAAAEw/g51C7_m9JWU/photo.jpg?sz=128", "display_name": "Iain Duncan", "link": "https://stackoverflow.com/users/5788720/iain-duncan"}, "is_accepted": false, "score": 1, "last_activity_date": 1525029650, "creation_date": 1525029650, "answer_id": 50090416, "question_id": 50081104, "link": "https://stackoverflow.com/questions/50081104/how-to-mock-second-try-of-http-call/50090416#50090416", "title": "How to mock second try of http call?", "body": "<p>This can easily be achieved using the test server that comes in the standard library's <a href=\"https://golang.org/pkg/net/http/httptest/#Server\" rel=\"nofollow noreferrer\">httptest package</a>.  With a slight modification to the example contained within it you can set up functions for each of the responses you want up front by doing this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n    \"net/http/httptest\"\n)\n\nfunc main() {\n    responseCounter := 0\n    responses := []func(w http.ResponseWriter, r *http.Request){\n        func(w http.ResponseWriter, r *http.Request) {\n            fmt.Fprintln(w, \"First response\")\n        },\n        func(w http.ResponseWriter, r *http.Request) {\n            fmt.Fprintln(w, \"Second response\")\n        },\n    }\n    ts := httptest.NewServer(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        responses[responseCounter](w, r)\n        responseCounter++\n    }))\n    defer ts.Close()\n\n    printBody(ts.URL)\n    printBody(ts.URL)\n}\n\nfunc printBody(url string) {\n    res, err := http.Get(url)\n    if err != nil {\n        log.Fatal(err)\n    }\n    resBody, err := ioutil.ReadAll(res.Body)\n    res.Body.Close()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Printf(\"%s\", resBody)\n}\n</code></pre>\n\n<p>Which outputs:</p>\n\n<pre><code>First response\nSecond response\n</code></pre>\n\n<p>Executable code here:</p>\n\n<p><a href=\"https://play.golang.org/p/YcPe5hOSxlZ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/YcPe5hOSxlZ</a></p>\n"}], "owner": {"reputation": 433, "user_id": 1813415, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ae0b3dd5cb7bbbcfc21b19c79807625c?s=128&d=identicon&r=PG", "display_name": "diwakarb", "link": "https://stackoverflow.com/users/1813415/diwakarb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1039, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525029650, "creation_date": 1524949796, "last_edit_date": 1525015083, "question_id": 50081104, "link": "https://stackoverflow.com/questions/50081104/how-to-mock-second-try-of-http-call", "title": "How to mock second try of http call?", "body": "<p>As part of my first project I am creating a tiny library to send an SMS to any user. I have added the logic of waiting and retrying if it doesn't receive a positive status on first go. It's a basic HTTP call to am SMS sending service. My algorithm looks like this (comments would explain the flow of the code):</p>\n\n<pre><code>for {\n    //send request\n    resp, err := HTTPClient.Do(req)\n    checkOK, checkSuccessUrl, checkErr := CheckSuccessStatus(resp, err)\n\n    //if successful don't continue\n    if !checkOK and checkErr != nil {\n        err = checkErr\n        return resp, SUCCESS, int8(RetryMax-remain+1), err\n    }\n\n    remain := remain - 1\n    if remain == 0 {\n        break\n    }\n\n    //calculate wait time\n    wait := Backoff(RetryWaitMin, RetryWaitMax, RetryMax-remain, resp)\n    //wait for time calculated in backoff above\n    time.Sleep(wait)\n\n    //check the status of last call, if unsuccessful then continue the loop\n\n    if checkSuccessUrl != \"\" {\n        req, err := GetNotificationStatusCheckRequest(checkSuccessUrl)\n        resp, err := HTTPClient.Do(req)\n        checkOK, _, checkErr = CheckSuccessStatusBeforeRetry(resp, err)\n        if !checkOK {\n\n            if checkErr != nil {\n                err = checkErr\n            }\n            return resp,SUCCESS, int8(RetryMax-remain), err\n        }\n    }\n}\n</code></pre>\n\n<p>Now I want to test this logic using any HTTP mock framework available. The best I've got is <a href=\"https://github.com/jarcoal/httpmock\" rel=\"nofollow noreferrer\">https://github.com/jarcoal/httpmock</a></p>\n\n<p>But this one does not provide functionality to mock the response of first and second URL separately. Hence I cannot test the success in second or third retry. I can either test success in first go or failure altogether. </p>\n\n<p>Is there a package out there which suits my needs of testing this particular feature? If no, How can I achieve this using current tools?</p>\n"}, {"tags": ["go", "go-templates"], "answers": [{"comments": [{"owner": {"reputation": 311, "user_id": 4190665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh5.googleusercontent.com/-LVEVHFubuEA/AAAAAAAAAAI/AAAAAAAAAEc/F5-gc-WR-n8/photo.jpg?sz=128", "display_name": "Casey Cao", "link": "https://stackoverflow.com/users/4190665/casey-cao"}, "edited": false, "score": 0, "creation_date": 1524950940, "post_id": 50081124, "comment_id": 87178401, "body": "Thanks, UserNames and Checks they have the same parents and both of them is array with same length. Actually I want to range them together, but don&#39;t know how. If I do {{$check := $.Checks}}  it will return me the string &quot;$check&quot;, not &quot;checked&quot; as I wanted. Do you know how to correct it?"}, {"owner": {"reputation": 17595, "user_id": 41455, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4788a6e08db703f60f249356c95d5775?s=128&d=identicon&r=PG", "display_name": "superfell", "link": "https://stackoverflow.com/users/41455/superfell"}, "reply_to_user": {"reputation": 311, "user_id": 4190665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh5.googleusercontent.com/-LVEVHFubuEA/AAAAAAAAAAI/AAAAAAAAAEc/F5-gc-WR-n8/photo.jpg?sz=128", "display_name": "Casey Cao", "link": "https://stackoverflow.com/users/4190665/casey-cao"}, "edited": false, "score": 0, "creation_date": 1524951021, "post_id": 50081124, "comment_id": 87178422, "body": "easiest would be to transform the 2 lists into a list of structs with 2 fields."}, {"owner": {"reputation": 311, "user_id": 4190665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh5.googleusercontent.com/-LVEVHFubuEA/AAAAAAAAAAI/AAAAAAAAAEc/F5-gc-WR-n8/photo.jpg?sz=128", "display_name": "Casey Cao", "link": "https://stackoverflow.com/users/4190665/casey-cao"}, "edited": false, "score": 0, "creation_date": 1524952947, "post_id": 50081124, "comment_id": 87178875, "body": "Could you please have a check in this case I already passed PageVars to html, how could I call it from html?"}], "tags": [], "owner": {"reputation": 17595, "user_id": 41455, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4788a6e08db703f60f249356c95d5775?s=128&d=identicon&r=PG", "display_name": "superfell", "link": "https://stackoverflow.com/users/41455/superfell"}, "is_accepted": false, "score": 2, "last_activity_date": 1524950040, "creation_date": 1524950040, "answer_id": 50081124, "question_id": 50080640, "link": "https://stackoverflow.com/questions/50080640/how-to-pass-multiple-variables-to-go-html-template/50081124#50081124", "title": "How to pass multiple variables to Go HTML template", "body": "<p>When you reference fields via <code>.</code> inside a range, its expecting that to be a field on the item being ranged, so in this case</p>\n\n<pre><code>{{range .UserNames}}\n{{$check := .Checks}}\n</code></pre>\n\n<p>Its looking for a Checks field on the current instance in the Usernames list. If checks is separate to that (as it appears in your PageVars), then you can use the <code>$</code> reference to the top level object, e.g.</p>\n\n<pre><code>{{range .UserNames}}\n{{$check := $.Checks}} \n</code></pre>\n\n<p>You didn't post the code executing the template, but make sure you're checking the error returned from it.</p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1524973006, "last_edit_date": 1524973006, "creation_date": 1524951111, "answer_id": 50081256, "question_id": 50080640, "link": "https://stackoverflow.com/questions/50080640/how-to-pass-multiple-variables-to-go-html-template/50081256#50081256", "title": "How to pass multiple variables to Go HTML template", "body": "<p>Range with an index variable, use that index to get the check:</p>\n\n<pre><code>{{range $i, $user := .UserNames}}\n{{$check := index $.Checks $i}}\n{{$user}}: &lt;input type=\"checkbox\" name=\"email\" value={{$user}} {{$check}}/&gt;&lt;br /&gt;\n{{end}}\n</code></pre>\n\n<p>Range sets the cursor <code>.</code> to successive values of the slice. Use <code>$</code> to reference the <code>Checks</code> field in the argument to the template.</p>\n\n<p><a href=\"https://play.golang.org/p/1ZtJ_bspDzu\" rel=\"nofollow noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 311, "user_id": 4190665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh5.googleusercontent.com/-LVEVHFubuEA/AAAAAAAAAAI/AAAAAAAAAEc/F5-gc-WR-n8/photo.jpg?sz=128", "display_name": "Casey Cao", "link": "https://stackoverflow.com/users/4190665/casey-cao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2232, "favorite_count": 1, "accepted_answer_id": 50081256, "answer_count": 2, "score": 1, "last_activity_date": 1524973006, "creation_date": 1524946360, "last_edit_date": 1524951451, "question_id": 50080640, "link": "https://stackoverflow.com/questions/50080640/how-to-pass-multiple-variables-to-go-html-template", "title": "How to pass multiple variables to Go HTML template", "body": "<p>I am new to golang. I would like to pass multiple variables to html.\nSo I have a type like:</p>\n\n<pre><code>type Variables struct { \n    UserNames    []string  \n    Checks       []string\n}\n</code></pre>\n\n<p>pagevarible with passed the correct values</p>\n\n<pre><code>var PageVars Variables\n    PageVars = Variables{\n        UserNames: ulist,\n        Checks: check,\n    }\n    log.Println(\"ulist\",ulist)\n    err = tpl.Execute(w, PageVars) //execute the template and pass it to index page\n    if err != nil { // if there is an error\n        log.Print(\"template executing error: \", err) //log it on terminal\n    }\n</code></pre>\n\n<p>And I want to pass both UserNames and Checks to html template, something like:</p>\n\n<pre><code>{{range .UserNames .Checks}}\n{{.UserNames}}: &lt;input type=\"checkbox\" name=\"email\" value={{. UserNames}} {{.Checks}}/&gt;&lt;br /&gt;\n{{end}}\n</code></pre>\n\n<p>But it didn't work out.\nCan anyone correct my syntax?\nThanks a lot.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1524940824, "post_id": 50079815, "comment_id": 87175698, "body": "use <code>go env</code> command in terminal and check for go root and go path variables."}, {"owner": {"reputation": 73, "user_id": 8344411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0GEz.jpg?s=128&g=1", "display_name": "Goktug Hatipoglu", "link": "https://stackoverflow.com/users/8344411/goktug-hatipoglu"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1524940875, "post_id": 50079815, "comment_id": 87175715, "body": "GOPATH is correct, but goroot is in &quot;/usr/local/go&quot;"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1524941058, "post_id": 50079815, "comment_id": 87175751, "body": "Please post your go path variable and your code for stringutil package"}, {"owner": {"reputation": 73, "user_id": 8344411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0GEz.jpg?s=128&g=1", "display_name": "Goktug Hatipoglu", "link": "https://stackoverflow.com/users/8344411/goktug-hatipoglu"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1524941552, "post_id": 50079815, "comment_id": 87175880, "body": "updated @Himanshu"}], "answers": [{"tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": true, "score": 9, "last_activity_date": 1524942133, "last_edit_date": 1524942133, "creation_date": 1524941672, "answer_id": 50080008, "question_id": 50079815, "link": "https://stackoverflow.com/questions/50079815/exported-functions-from-another-package/50080008#50080008", "title": "Exported functions from another package", "body": "<p><a href=\"https://tour.golang.org/basics/3\" rel=\"noreferrer\">Golang Tour</a> specify exported name as </p>\n\n<blockquote>\n  <p>A name is exported if it begins with a capital letter. And When\n  importing a package, you can refer only to its exported names. Any\n  \"unexported\" names are not accessible from outside the package.</p>\n</blockquote>\n\n<p>Change the name of <code>reverse</code> func to <code>Reverse</code> to make it exportable to main package. Like below</p>\n\n<pre><code>package stringutil\n\nfunc Reverse(s string) string {\n    r := []rune(s)\n    for i, j := 0, len(r)-1; i &lt; len(r)/2; i, j = i+1, j-1 {\n        r[i], r[j] = r[j], r[i]\n    }\n    return string(r)\n} \n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 8344411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0GEz.jpg?s=128&g=1", "display_name": "Goktug Hatipoglu", "link": "https://stackoverflow.com/users/8344411/goktug-hatipoglu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1905, "favorite_count": 1, "accepted_answer_id": 50080008, "answer_count": 1, "score": 3, "last_activity_date": 1530871356, "creation_date": 1524940234, "last_edit_date": 1530871356, "question_id": 50079815, "link": "https://stackoverflow.com/questions/50079815/exported-functions-from-another-package", "title": "Exported functions from another package", "body": "<p>I am following instructions in <a href=\"https://golang.org/doc/code.html#Workspaces\" rel=\"nofollow noreferrer\">https://golang.org/doc/code.html#Workspaces</a> link and I build my first Go program.</p>\n\n<p>So, I tried to make library with this instruction = <a href=\"https://golang.org/doc/code.html#Library\" rel=\"nofollow noreferrer\">https://golang.org/doc/code.html#Library</a></p>\n\n<p>and everything is perfect until building hello.go, its gives me this error.</p>\n\n<blockquote>\n  <p>/hello.go:10:13: undefined: stringutil.Reverse</p>\n</blockquote>\n\n<p>I've already rebuild my <code>reverse.go.</code></p>\n\n<p>Thats my code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/d35k/stringutil\"\n)\n\nfunc main() {\n    fmt.Printf(stringutil.Reverse(\"!oG ,olleH\"))\n}\n</code></pre>\n\n<p>that's my reverse.go (same as docs)</p>\n\n<pre><code>package stringutil\n\nfunc reverse(s string) string {\n    r := []rune(s)\n    for i, j := 0, len(r)-1; i &lt; len(r)/2; i, j = i+1, j-1 {\n        r[i], r[j] = r[j], r[i]\n    }\n    return string(r)\n}\n</code></pre>\n\n<p>and my gopath variable</p>\n\n<pre><code>export GOPATH=$HOME/GoLang\n</code></pre>\n\n<p>and my files ar in </p>\n\n<pre><code>GoLang/src/github.com/mygithubusername/\n</code></pre>\n"}, {"tags": ["google-chrome", "firefox", "go", "trace"], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 4528482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b24c77347bb6d1277eca8ada76cbc1d?s=128&d=identicon&r=PG&f=1", "display_name": "Tarek", "link": "https://stackoverflow.com/users/4528482/tarek"}, "is_accepted": true, "score": 1, "last_activity_date": 1598359826, "last_edit_date": 1598359826, "creation_date": 1525588927, "answer_id": 50196945, "question_id": 50079414, "link": "https://stackoverflow.com/questions/50079414/runtime-trace-viewer-on-browser/50196945#50196945", "title": "`runtime/trace` viewer on browser", "body": "<p>the problem was &quot;I install Go from your OS package manager&quot;</p>\n<p>after reinstalling Go following <a href=\"https://golang.org/doc/install\" rel=\"nofollow noreferrer\">official instructions</a> the problem solved</p>\n<p>you can find more in issue created with golang repo <a href=\"https://github.com/golang/go/issues/25151\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 9, "user_id": 4528482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b24c77347bb6d1277eca8ada76cbc1d?s=128&d=identicon&r=PG&f=1", "display_name": "Tarek", "link": "https://stackoverflow.com/users/4528482/tarek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 523, "favorite_count": 0, "accepted_answer_id": 50196945, "answer_count": 1, "score": -1, "last_activity_date": 1608632203, "creation_date": 1524937512, "last_edit_date": 1608632203, "question_id": 50079414, "link": "https://stackoverflow.com/questions/50079414/runtime-trace-viewer-on-browser", "title": "`runtime/trace` viewer on browser", "body": "<p>when i run <code>go tool trace m.trace</code>\nit opens this link <code>http://127.0.0.1:37721/trace</code></p>\n\n<p>on both chrome &amp; firefox i go an empty page </p>\n\n<p>in chrome Console i found \n<a href=\"https://i.stack.imgur.com/DJhMK.png\" rel=\"nofollow noreferrer\">this error</a></p>\n\n<blockquote>\n  <p>GET <a href=\"http://127.0.0.1:37721/trace_viewer_html\" rel=\"nofollow noreferrer\">http://127.0.0.1:37721/trace_viewer_html</a> 404 (Not Found)\n  Uncaught ReferenceError: tr is not defined</p>\n</blockquote>\n\n<p>i found this <a href=\"https://stackoverflow.com/questions/33510046/how-do-i-view-the-details-of-a-trace-produced-by-runtime-trace\">question</a> talk about issue in firefox and chrome version \ni use <strong>ubuntu16.04/chrome66.0/golang1.10</strong></p>\n\n<ol>\n<li>so what should i do to be able to view the trace</li>\n<li>is there is an online tool could i upload my m.trace file to browse online </li>\n</ol>\n"}, {"tags": ["select", "go", "closures", "channel", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 415, "user_id": 9661066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DKIYpno_RaE/AAAAAAAAAAI/AAAAAAAAAAA/784Fv4xgNp8/photo.jpg?sz=128", "display_name": "GilesW", "link": "https://stackoverflow.com/users/9661066/gilesw"}, "is_accepted": true, "score": 2, "last_activity_date": 1524936985, "creation_date": 1524936985, "answer_id": 50079329, "question_id": 50079216, "link": "https://stackoverflow.com/questions/50079216/understanding-select-from-channels-with-and-without-goroutine/50079329#50079329", "title": "Understanding select from channels with and without goroutine", "body": "<p>I am not familiar with fsnotify, but it looks like it won't send anything on the channels until <code>Watcher.Add()</code> is called to watch the file, but the <code>Watcher.Add()</code> occurs after the <code>select</code> in the second version. In this case select will block for ever as nothing can be signaled as <code>Watcher.Add()</code> has not been called. Hence there is deadlock.</p>\n"}], "owner": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 1, "accepted_answer_id": 50079329, "answer_count": 1, "score": 1, "last_activity_date": 1524937513, "creation_date": 1524936235, "last_edit_date": 1524937513, "question_id": 50079216, "link": "https://stackoverflow.com/questions/50079216/understanding-select-from-channels-with-and-without-goroutine", "title": "Understanding select from channels with and without goroutine", "body": "<p>Hello stackoverflow community,\nI am using <a href=\"http://github.com/fsnotify/fsnotify\" rel=\"nofollow noreferrer\">github.com/fsnotify/fsnotify</a> to set watchers to a file in Go. My function looks like</p>\n\n<pre><code>func SetWatcher(filename string) {\n    fmt.Println(\"Setting watcher to file \", filename)\n    Watcher, err = fsnotify.NewWatcher()\n    if err != nil {\n        fmt.Println(\"inotify errored. Other methods needs to be implemented.\")\n        panic(err)\n    }\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    done := make(chan bool)\n    go func() {\n        for {\n            select {\n            case event := &lt;-Watcher.Events:\n                if event.Op == fsnotify.Remove {\n                    fmt.Println(\"File removed, needs to kill the process.\")\n                } else if event.Op == fsnotify.Rename {\n                    fmt.Println(\"File renamed, need to restart seeking.\")\n                }\n\n            case err := &lt;-Watcher.Errors:\n                log.Println(\"error:\", err)\n            }\n        }\n    }()\n\n    err = Watcher.Add(filename)\n    if err != nil {\n        log.Fatal(err)\n    }\n    &lt;-done\n}\n</code></pre>\n\n<p>which works so far and I get outputs as </p>\n\n<pre><code>Setting watcher to file  /var/log/syslog\nFile renamed, need to restart seeking.\n</code></pre>\n\n<p>However, if I try to remove the closure running in the goroutine and run it as </p>\n\n<pre><code>func SetWatcher(filename string) {\n    fmt.Println(\"Setting watcher to file \", filename)\n    Watcher, err = fsnotify.NewWatcher()\n    if err != nil {\n        fmt.Println(\"inotify errored. Other methods needs to be implemented.\")\n        panic(err)\n    }\n    if err != nil {\n        log.Fatal(err)\n    }\n    //defer Watcher.Close()\n\n    //done := make(chan bool)\n    //go func() {\n    //  for {\n            select {\n            case event := &lt;-Watcher.Events:\n                if event.Op == fsnotify.Remove {\n                    fmt.Println(\"File removed, needs to kill the process.\")\n                } else if event.Op == fsnotify.Rename {\n                    fmt.Println(\"File renamed, need to restart seeking.\")\n                }\n\n            case err := &lt;-Watcher.Errors:\n                log.Println(\"error:\", err)\n            }\n        //}\n    //}()\n\n    err = Watcher.Add(filename)\n    if err != nil {\n        log.Fatal(err)\n    }\n    //&lt;-done\n}\n</code></pre>\n\n<p>the program never outputs anything. I ran it with <code>strace</code> and the program is seen stuck at</p>\n\n<pre><code>[pid  5773] pselect6(0, NULL, NULL, NULL, {tv_sec=0, tv_nsec=20000}, NULL &lt;unfinished ...&gt;\n[pid  5772] epoll_wait(4, [], 128, 0)   = 0\n[pid  5772] futex(0x598bf8, FUTEX_WAIT, 0, NULL &lt;unfinished ...&gt;\n[pid  5773] &lt;... pselect6 resumed&gt; )    = 0 (Timeout)\n[pid  5740] &lt;... pselect6 resumed&gt; )    = 0 (Timeout)\n[pid  5773] futex(0x598578, FUTEX_WAIT, 0, {tv_sec=60, tv_nsec=0} \n&lt;unfinished ...&gt;\n[pid  5740] futex(0xae1f58, FUTEX_WAIT, 0, {tv_sec=60, tv_nsec=0}\n</code></pre>\n\n<p>and not receiving from the channel and keeps on waiting.</p>\n\n<p>I've read that this could be caused because of non-buffered channel. So to validate that, I modified the library to use a buffered channel and the part of the function that generates the new watcher looks like</p>\n\n<pre><code>    w := &amp;Watcher{\n    fd:       fd,\n    poller:   poller,\n    watches:  make(map[string]*watch),\n    paths:    make(map[int]string),\n    Events:   make(chan Event, 10), // Made it buffered here\n    Errors:   make(chan error),\n    done:     make(chan struct{}),\n    doneResp: make(chan struct{}),\n}\n</code></pre>\n\n<p>But the behavior is the same. Can someone please help me understand why the reading from channel worked when it was in a goroutine, and didn't work without a goroutine?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["go", "docker-compose", "hyperledger-fabric", "hyperledger"], "answers": [{"tags": [], "owner": {"reputation": 38497, "user_id": 104014, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3d186f3c6ad2de59b356c1cfad9af404?s=128&d=identicon&r=PG", "display_name": "Artem Barger", "link": "https://stackoverflow.com/users/104014/artem-barger"}, "is_accepted": false, "score": 0, "last_activity_date": 1525075177, "creation_date": 1525075177, "answer_id": 50096284, "question_id": 50078437, "link": "https://stackoverflow.com/questions/50078437/error-building-chaincode-written-in-go/50096284#50096284", "title": "Error building chaincode written in go", "body": "<p>It's very hard to guess without seeing actual code which cause the compilation error, while it seems that you are not taking care of the second parameter which returned by <code>HistoryQueryIteratorInterface#Next()</code> API or even <code>ChaincodeStubInterface#GetHistoryForKey()</code>. Please see example of how to use those APIs correctly:</p>\n\n<pre><code>// GetPreviousValue reads previous value of given key\nfunc (pm *personManagement) GetPreviousValue(params []string, stub shim.ChaincodeStubInterface) peer.Response {\n    historyIer, err := stub.GetHistoryForKey(params[0])\n\n    if err != nil {\n        errMsg := fmt.Sprintf(\"[ERROR] cannot retrieve history of key &lt;%s&gt;, due to %s\", params[0], err)\n        fmt.Println(errMsg)\n        return shim.Error(errMsg)\n    }\n\n    if historyIer.HasNext() {\n        modification, err := historyIer.Next()\n        if err != nil {\n            errMsg := fmt.Sprintf(\"[ERROR] cannot read key record modification, key &lt;%s&gt;, due to %s\", params[0], err)\n            fmt.Println(errMsg)\n            return shim.Error(errMsg)\n        }\n        fmt.Println(\"Returning information about\", string(modification.Value))\n        return shim.Success(modification.Value)\n    }\n\n\n    fmt.Printf(\"No history found for key %s\\n\", params[0])\n    return shim.Success([]byte(fmt.Sprintf(\"No history for key %s\", params[0])))\n}\n</code></pre>\n\n<p><strong>NOTE</strong>: Please pay attention that <code>historyIer.Next()</code> returns history value and the error.</p>\n"}], "owner": {"reputation": 9, "user_id": 9714917, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211445157860258/picture?type=large", "display_name": "Mattia Delli Priscoli", "link": "https://stackoverflow.com/users/9714917/mattia-delli-priscoli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 304, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1525090906, "creation_date": 1524931354, "last_edit_date": 1525090906, "question_id": 50078437, "link": "https://stackoverflow.com/questions/50078437/error-building-chaincode-written-in-go", "title": "Error building chaincode written in go", "body": "<p>When I try to modify the example described in <a href=\"http://hyperledger-fabric.readthedocs.io/en/release-1.1/write_first_app.html\" rel=\"nofollow noreferrer\">this hyperledger example</a> I get some error when adding <a href=\"https://github.com/hyperledger/fabric/tree/master/protos/ledger/queryresult\" rel=\"nofollow noreferrer\">this external library</a> in order to get the History of the chaincode state.<br>\nWhy does that happen?</p>\n\n<p>I add the library with govendor, but when I run this command:</p>\n\n<pre><code>docker exec -e \"CORE_PEER_LOCALMSPID=Org1MSP\" -e \"CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp\" cli peer chaincode instantiate -o orderer.example.com:7050 -C mychannel -n $CC_NAME -l \"$LANGUAGE\" -v 1.0 -c $INIT_STR -P \"OR ('Org1MSP.member','Org2MSP.member')\"\n</code></pre>\n\n<p>I get this error:</p>\n\n<blockquote>\n  <p>Error: Error endorsing chaincode:<br>\n  rpc error: code = Unknown desc = error starting container: Failed to generate platform-specific docker build: Error returned from build: 2 \"# firstExample\n  chaincode/input/src/firstExample/firstStep.go:104:11: cannot assign *\"github.com/hyperledger/fabric/protos/ledger/queryresult\".KeyModification to kM (type *\"firstExample/vendor/github.com/hyperledger/fabric/protos/ledger/queryresult\".KeyModification) in multiple assignment\n  chaincode/input/src/firstExample/firstStep.go:146:11: cannot assign *\"github.com/hyperledger/fabric/protos/ledger/queryresult\".KeyModification to kM (type *\"firstExample/vendor/github.com/hyperledger/fabric/protos/ledger/queryresult\".KeyModification) in multiple assignment\n  chaincode/input/src/firstExample/firstStep.go:156:11: cannot assign *\"github.com/hyperledger/fabric/protos/ledger/queryresult\".KeyModification to kM (type *\"firstExample/vendor/github.com/hyperledger/fabric/protos/ledger/queryresult\".KeyModification) in multiple assignment</p>\n</blockquote>\n\n<p>I have some troubles with this. I'm sure that the library is imported because if I build the chaincode written in go with the command:</p>\n\n<pre><code>go build \n</code></pre>\n\n<p>I get no errors.<br>\nPlease help me!</p>\n"}, {"tags": ["validation", "go"], "comments": [{"owner": {"reputation": 394, "user_id": 4794989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kl1aC.jpg?s=128&g=1", "display_name": "Alireza Bashiri", "link": "https://stackoverflow.com/users/4794989/alireza-bashiri"}, "edited": false, "score": 0, "creation_date": 1524971640, "post_id": 50076365, "comment_id": 87181903, "body": "Don&#39;t reinvent the wheel just go with <a href=\"https://github.com/asaskevich/govalidator\" rel=\"nofollow noreferrer\">github.com/asaskevich/govalidator</a>"}], "answers": [{"comments": [{"owner": {"reputation": 298, "user_id": 9456506, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "elham anari", "link": "https://stackoverflow.com/users/9456506/elham-anari"}, "edited": false, "score": 0, "creation_date": 1524976570, "post_id": 50076816, "comment_id": 87182577, "body": "Thank you so much for the time you responded. @Aristofanio Garcia"}], "tags": [], "owner": {"reputation": 983, "user_id": 7059119, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209343272591927/picture?type=large", "display_name": "Aristofanio Garcia", "link": "https://stackoverflow.com/users/7059119/aristofanio-garcia"}, "is_accepted": true, "score": 3, "last_activity_date": 1524925436, "last_edit_date": 1524925436, "creation_date": 1524920475, "answer_id": 50076816, "question_id": 50076365, "link": "https://stackoverflow.com/questions/50076365/how-to-validate-slice-of-string/50076816#50076816", "title": "How to validate slice of string", "body": "<p>Package \"gopkg.in/go-playground/validator.v9\" is for structs and variables, look:</p>\n\n<blockquote>\n  <p>Package validator implements value validations for structs and\n  individual fields based on tags.</p>\n  \n  <p>It can also handle Cross-Field and Cross-Struct validation for nested\n  structs and has the ability to dive into arrays and maps of any type.</p>\n</blockquote>\n\n<p>So you can try this:</p>\n\n<pre><code>func validateVariable() {\n    mySlice := []string{\"111\", \"222\"}\n    //1 (to convert in error)\n    println(reflect.TypeOf(mySlice).Kind() == reflect.Slice)\n    //2,3,5\n    errs := validate.Var(mySlice, \"required,max=10,min=1,dive,max=12\")\n    if errs != nil {\n        fmt.Println(errs)\n        return\n    }\n    //4  (to convert in error)\n    println(reflect.TypeOf(mySlice).Elem().Kind() == reflect.String)\n}\n</code></pre>\n\n<p>With more details:</p>\n\n<pre><code>func validateVariable() {\n    mySlice := []string{\"111\", \"222\"}\n    //mySlice := []string{\"111\", \"222\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"}\n    //mySlice := []string{\"111\", \"222000000000000\", \"0000000000000\"}\n    //1\n    if reflect.TypeOf(mySlice).Kind() != reflect.Slice {\n        fmt.Println(\"Invalid in: Variable must be slice\")\n    }\n    //2\n    errs2 := validate.Var(mySlice, \"max=10\")\n    if errs2 != nil {\n        fmt.Println(\"Invalid in: Max len is 10. Original: \")\n        fmt.Println(errs2)\n        return\n    }\n    //3\n    errs3 := validate.Var(mySlice, \"required\")\n    if errs3 != nil {\n        fmt.Println(\"Invalid in: Slice should not be null. Original: \")\n        fmt.Println(errs3)\n        return\n    }\n    //4\n    if reflect.TypeOf(mySlice).Elem().Kind() != reflect.String {\n        fmt.Println(\"Invalid in: Element slice are string\")\n        return\n    }\n    //5\n    errs5 := validate.Var(mySlice, \"dive,max=12\") //applied in elements\n    if errs5 != nil {\n        fmt.Println(\"Invalid in: Max length of every element is 12. Original: \")\n        fmt.Println(errs5)\n        return\n    }\n}\n</code></pre>\n\n<p>Another way is custom func validation. In my test I was create the functions:</p>\n\n<pre><code>//IsSlice check if field kind is equal to slice\nfunc IsSlice(fl validator.FieldLevel) bool {\n    if fl.Top().Kind() == reflect.Slice {\n        return true\n    }\n    return false\n}\n\n//IsSlice check if field element kind is equal to string\nfunc IsStringElem(fl validator.FieldLevel) bool {\n    t := fl.Top().Type()\n    if t.Elem().Kind() == reflect.String {\n        return true\n    }\n    return false\n}\n</code></pre>\n\n<p>Registry these functions:</p>\n\n<pre><code>func main() {\n    validate = validator.New()\n    validate.RegisterValidation(\"isslice\", IsSlice)\n    validate.RegisterValidation(\"isstringelem\", IsStringElem)\n    validateVariable()\n}\n</code></pre>\n\n<p>The result is more elegant (in detail):</p>\n\n<pre><code>func validateVariable() {\n    mySlice := []string{\"111\", \"222\"}\n    //mySlice := []string{\"111\", \"222\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"}\n    //mySlice := []string{\"111\", \"222000000000000\", \"0000000000000\"}\n    //1 - using tag custimized\n    errs1 := validate.Var(mySlice, \"isslice\")\n    if errs1 != nil {\n        fmt.Println(\"Invalid in: Variable must be slice\")\n        fmt.Println(errs1)\n        return\n    }\n    //2\n    errs2 := validate.Var(mySlice, \"max=10\")\n    if errs2 != nil {\n        fmt.Println(\"Invalid in: Max len is 10. Original: \")\n        fmt.Println(errs2)\n        return\n    }\n    //3\n    errs3 := validate.Var(mySlice, \"required\")\n    if errs3 != nil {\n        fmt.Println(\"Invalid in: Slice should not be null. Original: \")\n        fmt.Println(errs3)\n        return\n    }\n    //4 - using tag customized\n    errs4 := validate.Var(mySlice, \"isstringelem\")\n    if errs4 != nil {\n        fmt.Println(\"Invalid in: Element slice are string\")\n        fmt.Println(errs4)\n        return\n    }\n    //5\n    errs5 := validate.Var(mySlice, \"dive,max=12\") //applied in elements\n    if errs5 != nil {\n        fmt.Println(\"Invalid in: Max length of every element is 12. Original: \")\n        fmt.Println(errs5)\n        return\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 298, "user_id": 9456506, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "elham anari", "link": "https://stackoverflow.com/users/9456506/elham-anari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3847, "favorite_count": 0, "accepted_answer_id": 50076816, "answer_count": 1, "score": 2, "last_activity_date": 1524925436, "creation_date": 1524917103, "last_edit_date": 1524925221, "question_id": 50076365, "link": "https://stackoverflow.com/questions/50076365/how-to-validate-slice-of-string", "title": "How to validate slice of string", "body": "<p>I used package \"gopkg.in/go-playground/validator.v9\" and I read this <a href=\"https://godoc.org/gopkg.in/go-playground/validator.v9\" rel=\"nofollow noreferrer\">doc</a> .\nI want to validate for a slice of string.</p>\n\n<blockquote>\n  <p>There are some points:  1 - Variable must be slice</p>\n  \n  <p>2 - Max len is 10</p>\n  \n  <p>3 - Slice should not be null</p>\n  \n  <p>4 - element slice are string</p>\n  \n  <p>5 - Max length of every element is 12</p>\n</blockquote>\n\n<p>This is code : </p>\n\n<pre><code>var validate *validator.Validate\n\nfunc main() {\n    validate = validator.New()\n    validateVariable()\n}\n\nfunc validateVariable() {\nmySlice := []string{\"111\",\"222\"}\nerrs := validate.Var(mySlice , \"required,max=10,min=1\")\nif errs != nil {\n    fmt.Println(errs) \n    return\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5296, "user_id": 418066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/38yuw.png?s=128&g=1", "display_name": "Biffen", "link": "https://stackoverflow.com/users/418066/biffen"}, "edited": false, "score": 5, "creation_date": 1524917066, "post_id": 50076339, "comment_id": 87168720, "body": "Why would you want those backslashes? Do you <i>want</i> invalid JSON?"}, {"owner": {"reputation": 3183, "user_id": 216345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffc76b5c6c4607d55b0796da63d67f0?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/216345/thomas"}, "edited": false, "score": 0, "creation_date": 1524936764, "post_id": 50076339, "comment_id": 87174566, "body": "Your output shouldn&#39;t have backslashes. You generally only need to worry about escaping when writing string literals. Why do you think you need backslashes?"}], "answers": [{"tags": [], "owner": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "is_accepted": true, "score": 0, "last_activity_date": 1524920794, "creation_date": 1524920794, "answer_id": 50076863, "question_id": 50076339, "link": "https://stackoverflow.com/questions/50076339/escaping-json-object-for-kafka-axon-payload-creation/50076863#50076863", "title": "Escaping json object for kafka axon payload creation", "body": "<p>change last line to <code>fmt.Printf(\"%q\", string(b))</code> - this causes the format to be 'escaped string'.</p>\n\n<p>(or if you want to store the escaped string, ```fmt.Sprintf``)</p>\n\n<p><a href=\"https://play.golang.org/p/uBq3mnys5gE\" rel=\"nofollow noreferrer\">https://play.golang.org/p/uBq3mnys5gE</a></p>\n"}], "owner": {"reputation": 339, "user_id": 4158062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75f10ce8266ac660f74455aee351c634?s=128&d=identicon&r=PG&f=1", "display_name": "Bhupinder Singh Narang", "link": "https://stackoverflow.com/users/4158062/bhupinder-singh-narang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 50076863, "answer_count": 1, "score": -4, "last_activity_date": 1592469612, "creation_date": 1524916853, "last_edit_date": 1592469612, "question_id": 50076339, "link": "https://stackoverflow.com/questions/50076339/escaping-json-object-for-kafka-axon-payload-creation", "title": "Escaping json object for kafka axon payload creation", "body": "<p>I have been trying to create payload which required json data in escaped format. I can serialize the object but not sure how can I double escaped the same?</p>\n\n<p>Should I just double marshal my object so it escape it?</p>\n\n<pre><code>Input: {\"new\":{\"Id\":\"1\",\"Class\":\"23\"}}\n\nExpected: {\\\"new\\\":{\\\"Id\\\":\\\"1\\\",\\\"Class\\\":\\\"23\\\"}} \n</code></pre>\n"}, {"tags": ["string", "go", "variable-assignment"], "answers": [{"tags": [], "owner": {"reputation": 76, "user_id": 7162360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ace8f9bfcc6090911024a2f001aee6b9?s=128&d=identicon&r=PG&f=1", "display_name": "shanyy", "link": "https://stackoverflow.com/users/7162360/shanyy"}, "is_accepted": false, "score": 1, "last_activity_date": 1524915170, "creation_date": 1524915170, "answer_id": 50076077, "question_id": 50075996, "link": "https://stackoverflow.com/questions/50075996/strange-behaviour-while-same-variable-as-input-and-output-of-function/50076077#50076077", "title": "strange behaviour while same variable as input and output of function", "body": "<p>do not use s in the for loop, := will add a new local var. just rename the s in for loot to s1. You can also declare a outside for loop and replace := with =</p>\n"}, {"tags": [], "owner": {"reputation": 6388, "user_id": 847552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc674fd2cf824532531bd2b193bdc920?s=128&d=identicon&r=PG", "display_name": "skovorodkin", "link": "https://stackoverflow.com/users/847552/skovorodkin"}, "is_accepted": false, "score": 5, "last_activity_date": 1524915579, "last_edit_date": 1592644375, "creation_date": 1524915238, "answer_id": 50076092, "question_id": 50075996, "link": "https://stackoverflow.com/questions/50075996/strange-behaviour-while-same-variable-as-input-and-output-of-function/50076092#50076092", "title": "strange behaviour while same variable as input and output of function", "body": "<p>On each iteration you declare new variables called <code>s</code> and <code>err</code>:</p>\n<pre><code>s, err := minusOne(s)\n</code></pre>\n<p>Their scope is only the current iteration, so the above line keeps using the same <code>s</code> variable declared outside of the loop. From <a href=\"https://golang.org/ref/spec#Declarations_and_scope\" rel=\"noreferrer\">Declarations and scope</a> part of The Go Specification:</p>\n<blockquote>\n<p>Go is lexically scoped using blocks:</p>\n<ol start=\"5\">\n<li>The scope of a constant or variable identifier declared inside a function begins at the end of the ConstSpec or VarSpec (ShortVarDecl for short variable declarations) and ends at the end of the innermost containing block.</li>\n</ol>\n</blockquote>\n<p>To fix it, you need to use assignment:</p>\n<pre><code>var err error\nfor {\n    // ...\n    s, err = minusOne(s)\n    // ...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1917, "user_id": 6401895, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e169f96fa9c3c6a770dd828e3319263a?s=128&d=identicon&r=PG", "display_name": "Ivan Beldad", "link": "https://stackoverflow.com/users/6401895/ivan-beldad"}, "is_accepted": false, "score": 3, "last_activity_date": 1524915302, "creation_date": 1524915302, "answer_id": 50076102, "question_id": 50075996, "link": "https://stackoverflow.com/questions/50075996/strange-behaviour-while-same-variable-as-input-and-output-of-function/50076102#50076102", "title": "strange behaviour while same variable as input and output of function", "body": "<p>You are using the short var declaration <code>:=</code>. You must take care with this.</p>\n\n<p>Inside the <code>for</code> loop you are creating two new variables, <code>err</code>, but also <code>s</code> (with a new scope inside the for loop). This wouldn't be a problem if you do in the same scope.</p>\n\n<p>You can simply extract the <code>err</code> to a pre-declared variable before like that:</p>\n\n<pre><code>var err error\ns, err = minusOne(s)\n</code></pre>\n"}], "owner": {"reputation": 363, "user_id": 3795990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d37d81a7ddc13e52d035d4b86281985?s=128&d=identicon&r=PG&f=1", "display_name": "zxdvd", "link": "https://stackoverflow.com/users/3795990/zxdvd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1524915579, "creation_date": 1524914605, "question_id": 50075996, "link": "https://stackoverflow.com/questions/50075996/strange-behaviour-while-same-variable-as-input-and-output-of-function", "title": "strange behaviour while same variable as input and output of function", "body": "<p>For the following code, It seems going into dead loop.\nAfter <code>s, err := minusOne(s)</code>, s is shorten according the log info.\nBut the before minus log shows that it never changed.</p>\n\n<pre><code>func minusOne(s string) (string, error) {\n    if len(s) &gt;= 0 {\n        return s[1:], nil\n    }\n    return \"\", nil\n}\n\nfunc TestStr(t *testing.T) {\n    s := \"hello world\"\n    for {\n        log.Println(\"before minus\", s)\n        s, err := minusOne(s)\n        log.Println(\"after minus\", s)\n        if err == nil &amp;&amp; len(s) == 0 {\n            break\n        }\n    }\n}\n</code></pre>\n\n<p>If I change it slightly like, it works like expected.</p>\n\n<pre><code>s1, err := minusOne(s)\ns = s1\n</code></pre>\n\n<p>Or if I remove the err returning in the minusOne function, and it also works.</p>\n\n<pre><code>s = minusOne(s)\n</code></pre>\n\n<p>I really can't understand it.\nAnyone can help with it?</p>\n"}, {"tags": [".htaccess", "go", "webserver"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 5, "creation_date": 1524911007, "post_id": 50075169, "comment_id": 87167124, "body": "The question fails a critical part: <i>what</i> do you need <code>.htaccess</code> <i>for?</i> That is, it&#39;s a classic case of <a href=\"https://meta.stackexchange.com/a/66378\">the XY Problem</a>: instead of explaining your problem, you fixate on one particular solution to it and ask about difficulties implementing it."}], "answers": [{"comments": [{"owner": {"reputation": 744, "user_id": 975495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db4aef03bfb0278ab2e421c244f6d326?s=128&d=identicon&r=PG", "display_name": "Scott Smith", "link": "https://stackoverflow.com/users/975495/scott-smith"}, "edited": false, "score": 0, "creation_date": 1558346590, "post_id": 50075249, "comment_id": 99057665, "body": "It is possible to support htaccess with non-Apache serers.  A golang implementation of the standard is here: <a href=\"https://github.com/abbot/go-http-auth\" rel=\"nofollow noreferrer\">github.com/abbot/go-http-auth</a>."}], "tags": [], "owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "is_accepted": true, "score": 0, "last_activity_date": 1524912302, "last_edit_date": 1524912302, "creation_date": 1524909632, "answer_id": 50075249, "question_id": 50075169, "link": "https://stackoverflow.com/questions/50075169/golang-htaccess-configure-without-nginx-or-apache/50075249#50075249", "title": "Golang htaccess configure without Nginx or Apache", "body": "<p>You don't need .htaccess as it's only meant for Apache:</p>\n\n<p><a href=\"http://httpd.apache.org/docs/2.2/howto/htaccess.html\" rel=\"nofollow noreferrer\">http://httpd.apache.org/docs/2.2/howto/htaccess.html</a></p>\n\n<p>If you use Apache, external services like Google Site Analyzer can't see .htaccess since it's not served by Apache. It's kept private.</p>\n\n<p>Everything Apache can do with .htaccess, Go can do with <a href=\"http://golang.org/pkg/net/http\" rel=\"nofollow noreferrer\">net/http</a> or with a 3rd package like <a href=\"http://www.gorillatoolkit.org/\" rel=\"nofollow noreferrer\">Gorilla</a> to help.</p>\n"}, {"tags": [], "owner": {"reputation": 744, "user_id": 975495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db4aef03bfb0278ab2e421c244f6d326?s=128&d=identicon&r=PG", "display_name": "Scott Smith", "link": "https://stackoverflow.com/users/975495/scott-smith"}, "is_accepted": false, "score": 0, "last_activity_date": 1558346531, "creation_date": 1558346531, "answer_id": 56218574, "question_id": 50075169, "link": "https://stackoverflow.com/questions/50075169/golang-htaccess-configure-without-nginx-or-apache/56218574#56218574", "title": "Golang htaccess configure without Nginx or Apache", "body": "<p>This project allows you to support the http auth standard with GO, zero apache code.</p>\n\n<p>You can even use a password file created with the Apache htpasswd (bad) or htdigest (good) commands:</p>\n\n<p><a href=\"https://github.com/abbot/go-http-auth\" rel=\"nofollow noreferrer\">https://github.com/abbot/go-http-auth</a></p>\n"}], "owner": {"reputation": 71, "user_id": 9699047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803630c30c8c916a86c9b2db119ea06a?s=128&d=identicon&r=PG&f=1", "display_name": "TalkingJson", "link": "https://stackoverflow.com/users/9699047/talkingjson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 775, "favorite_count": 0, "accepted_answer_id": 50075249, "answer_count": 2, "score": 0, "last_activity_date": 1558346531, "creation_date": 1524909066, "last_edit_date": 1524925325, "question_id": 50075169, "link": "https://stackoverflow.com/questions/50075169/golang-htaccess-configure-without-nginx-or-apache", "title": "Golang htaccess configure without Nginx or Apache", "body": "<p>I've created <a href=\"http://telegram-socks.tk/\" rel=\"nofollow noreferrer\">web app</a> and analyzed it with <a href=\"https://developers.google.com/speed/pagespeed/insights/\" rel=\"nofollow noreferrer\">Google site analyzer</a>.</p>\n\n<p>In most cases I need to configure <code>htaccess</code> file. As I understand this file can be used only on Nginx or Apache server, but I don't want to use any of these.</p>\n\n<p>I want to configure htaccess only with golang tools. Currently my app running on VPS server.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1524914752, "post_id": 50075134, "comment_id": 87168124, "body": "You are appending m to list over and over again without modifying m. Why do you expect the slice elements to be different afterward?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1524915443, "post_id": 50075134, "comment_id": 87168319, "body": "Oh, I see now. You seem to think that m is copied somehow. That is a) not true and b) wouldn&#39;t change anything because the map stores pointers. So copying the map would copy the pointers but they would still all point to the same values. But Scan changes the values pointed to, not the pointers; the addresses don&#39;t change. Long story short, <code>make</code> a new map for each row."}], "answers": [{"comments": [{"owner": {"reputation": 1378, "user_id": 3496776, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0b93e9de0f94f4c49617f50d5fd7e63f?s=128&d=identicon&r=PG&f=1", "display_name": "sibert", "link": "https://stackoverflow.com/users/3496776/sibert"}, "edited": false, "score": 0, "creation_date": 1524919484, "post_id": 50075562, "comment_id": 87169420, "body": "Thank you! It worked perfect. I am aware of sqlx, but did not fix the base64 to string conversion. Numeric did not show up correct. And using structs are the last resort, as I often not know the structs."}, {"owner": {"reputation": 1378, "user_id": 3496776, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0b93e9de0f94f4c49617f50d5fd7e63f?s=128&d=identicon&r=PG&f=1", "display_name": "sibert", "link": "https://stackoverflow.com/users/3496776/sibert"}, "edited": false, "score": 0, "creation_date": 1524920473, "post_id": 50075562, "comment_id": 87169725, "body": "It seem to be a problem though. This code could not handle NULL values. It crashes. How do I fix this?"}, {"owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "reply_to_user": {"reputation": 1378, "user_id": 3496776, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0b93e9de0f94f4c49617f50d5fd7e63f?s=128&d=identicon&r=PG&f=1", "display_name": "sibert", "link": "https://stackoverflow.com/users/3496776/sibert"}, "edited": false, "score": 0, "creation_date": 1524921065, "post_id": 50075562, "comment_id": 87169930, "body": "Try replacing <code>vals[i] = &amp;s</code> with <code>vals[i] = &amp;&amp;s</code>, but then it might only work with nullable columns, I&#39;m not sure."}, {"owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "reply_to_user": {"reputation": 1378, "user_id": 3496776, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0b93e9de0f94f4c49617f50d5fd7e63f?s=128&d=identicon&r=PG&f=1", "display_name": "sibert", "link": "https://stackoverflow.com/users/3496776/sibert"}, "edited": false, "score": 0, "creation_date": 1524921489, "post_id": 50075562, "comment_id": 87170058, "body": "My bad, try without &amp; at all, and change the line before to <code>var s **string</code>"}, {"owner": {"reputation": 1378, "user_id": 3496776, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0b93e9de0f94f4c49617f50d5fd7e63f?s=128&d=identicon&r=PG&f=1", "display_name": "sibert", "link": "https://stackoverflow.com/users/3496776/sibert"}, "edited": false, "score": 0, "creation_date": 1524921709, "post_id": 50075562, "comment_id": 87170147, "body": "@ moshe-revah Crashes on everything. Even not NULL"}, {"owner": {"reputation": 1378, "user_id": 3496776, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0b93e9de0f94f4c49617f50d5fd7e63f?s=128&d=identicon&r=PG&f=1", "display_name": "sibert", "link": "https://stackoverflow.com/users/3496776/sibert"}, "edited": false, "score": 0, "creation_date": 1524922243, "post_id": 50075562, "comment_id": 87170300, "body": "it seems that combination &quot;var s **string + vals[i] = &amp;s&quot; did the trick. I will investigate more."}, {"owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "reply_to_user": {"reputation": 1378, "user_id": 3496776, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0b93e9de0f94f4c49617f50d5fd7e63f?s=128&d=identicon&r=PG&f=1", "display_name": "sibert", "link": "https://stackoverflow.com/users/3496776/sibert"}, "edited": false, "score": 0, "creation_date": 1525811329, "post_id": 50075562, "comment_id": 87501207, "body": "@sibert Makes sense, now that I&#39;m not looking at it from my phone ;-) Good luck!"}], "tags": [], "owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "is_accepted": true, "score": 2, "last_activity_date": 1524913750, "last_edit_date": 1524913750, "creation_date": 1524911780, "answer_id": 50075562, "question_id": 50075134, "link": "https://stackoverflow.com/questions/50075134/how-to-append-last-sql-row-to-a-list-without-replacing-previous-rows-in-golang/50075562#50075562", "title": "How to append last sql row to a list without replacing previous rows in Golang", "body": "<p>I fixed it and explained with comments what you did wrong:</p>\n\n<pre><code>// 1. Query\nvar rows *sql.Rows\nrows, err = db.Query(query)\ncols, _ := rows.Columns()\n\n// 2. Iterate\nlist := make([]map[string]interface{}, 0)\nfor rows.Next() {\n    vals := make([]interface{}, len(cols))\n    for i, _ := range cols {\n        // Previously you assigned vals[i] a pointer to a column name cols[i].\n        // This meant that everytime you did rows.Scan(vals),\n        // rows.Scan would see pointers to cols and modify them\n        // Since cols are the same for all rows, they shouldn't be modified.\n\n        // Here we assign a pointer to an empty string to vals[i],\n        // so rows.Scan can fill it.\n        var s string\n        vals[i] = &amp;s\n\n        // This is effectively like saying:\n        // var string1, string2 string\n        // rows.Scan(&amp;string1, &amp;string2)\n        // Except the above only scans two string columns\n        // and we allow as many string columns as the query returned us \u2014 len(cols).\n    }\n\n    err = rows.Scan(vals...)\n\n    // Don't forget to check errors.\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // Make a new map before appending it.\n    // Remember maps aren't copied by value, so if we declared\n    // the map m outside of the rows.Next() loop, we would be appending\n    // and modifying the same map for each row, so all rows in list would look the same.\n    m := make(map[string]interface{})\n    for i, val := range vals {\n        m[cols[i]] = val\n    }\n    list = append(list, m)\n}\n\n// 3. Print.\nb, _ := json.MarshalIndent(list, \"\", \"\\t\")\nfmt.Printf(\"%s\\n\", b)\n</code></pre>\n\n<p>Don't worry, this was hard for me to understand when I was a beginner as well.</p>\n\n<p>Now, something fun:</p>\n\n<pre><code>var list []map[string]interface{}\nrows, err := db.Queryx(query)\nfor rows.Next() {\n    row := make(map[string]interface{})\n    err = rows.MapScan(row)\n    if err != nil {\n      log.Fatal(err)\n    }\n    list = append(list, row)\n}\n\nb, _ := json.MarshalIndent(list, \"\", \"\\t\")\nfmt.Printf(\"%s\\n\", b)\n</code></pre>\n\n<p>This does the same as the code above it, but with <a href=\"http://jmoiron.github.io/sqlx/\" rel=\"nofollow noreferrer\">sqlx</a>. A bit simpler, no?</p>\n\n<p>sqlx is an extension on top of <code>database/sql</code> with methods to scan rows directly to maps and structs, so you don't have to do that manually.</p>\n\n<p>I think your model looks nicer as a struct:</p>\n\n<pre><code>type Person struct {\n    ID int\n    Name string\n}\n\nvar people []Person\nrows, err := db.Queryx(query)\nfor rows.Next() {\n    var p Person\n    err = rows.StructScan(&amp;p)\n    if err != nil {\n        log.Fatal(err)\n    }\n    people = append(people, p)\n}\n</code></pre>\n\n<p>Don't you think?</p>\n"}], "owner": {"reputation": 1378, "user_id": 3496776, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0b93e9de0f94f4c49617f50d5fd7e63f?s=128&d=identicon&r=PG&f=1", "display_name": "sibert", "link": "https://stackoverflow.com/users/3496776/sibert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 862, "favorite_count": 2, "accepted_answer_id": 50075562, "answer_count": 1, "score": 1, "last_activity_date": 1524913750, "creation_date": 1524908807, "last_edit_date": 1592644375, "question_id": 50075134, "link": "https://stackoverflow.com/questions/50075134/how-to-append-last-sql-row-to-a-list-without-replacing-previous-rows-in-golang", "title": "How to append last sql row to a list without replacing previous rows in Golang", "body": "<p>This code delivers AFAIK correct JSON output [{},{}], but each row is appended and replaces all previous rows, so the result shows only copies of the last row.</p>\n<pre><code>var rows *sql.Rows\nrows, err = db.Query(query)\ncols, _ := rows.Columns()\ncolnames, _ := rows.Columns()\nvals := make([]interface{}, len(cols))\n\nfor i, _ := range cols {\n   vals[i] = &amp;cols[i]\n}\n\nm := make(map[string]interface{})\n \nfor i, val := range vals {\n  m[colnames[i]] = val\n}\n    \nlist := make([]map[string]interface{}, 0)\nfor rows.Next() {\nerr = rows.Scan(vals...)\n   list = append(list, m)\n}\njson, _ := json.Marshal(list)\nfmt.Fprintf(w,&quot;%s\\n&quot;, json)\n</code></pre>\n<p>This is what happens behind the scenes looping through the rows:</p>\n<blockquote>\n<p>loop 1: {\u201cID\u201d:\u201c1\u201d,\u201cNAME\u201d: &quot;John }</p>\n<p>loop 2: {\u201cID\u201d:\u201c2\u201d,\u201cNAME\u201d: \u201cJane Doe\u201d}{\u201cID\u201d:\u201c2\u201d,\u201cNAME\u201d: \u201cJane Doe\u201d}</p>\n<p>loop 3: {\u201cID\u201d:\u201c3\u201d,\u201cNAME\u201d: \u201cDonald Duck\u201d}{\u201cID\u201d:\u201c3\u201d,\u201cNAME\u201d: \u201cDonald Duck\u201d}{\u201cID\u201d:\u201c3\u201d,\u201cNAME\u201d: \u201cDonald Duck\u201d}</p>\n</blockquote>\n<p>The rows.Scan fetches the correct values, but it appends AND replaces all previous values.</p>\n<p>The final output is this</p>\n<blockquote>\n<p>[{\u201cID\u201d:\u201c3\u201d,\u201cNAME\u201d: \u201cDonald Duck\u201d},{\u201cID\u201d:\u201c3\u201d,\u201cNAME\u201d: \u201cDonald Duck\u201d},{\u201cID\u201d:\u201c3\u201d,\u201cNAME\u201d: \u201cDonald Duck\u201d}]</p>\n</blockquote>\n<p>But should be this:</p>\n<blockquote>\n<p>[{\u201cID\u201d:\u201c1\u201d,\u201cNAME\u201d: \u201cJohn Doe\u201d},{\u201cID\u201d:\u201c2\u201d,\u201cNAME\u201d: \u201cJane Doe\u201d},{\u201cID\u201d:\u201c3\u201d,\u201cNAME\u201d: \u201cDonald Duck\u201d}]</p>\n</blockquote>\n<p>What am I doing wrong?</p>\n<p>You may downvote this, but please explain why. I am still a newbie on Golang and want to learn.</p>\n"}, {"tags": ["go", "redis", "kubernetes", "google-kubernetes-engine"], "comments": [{"owner": {"reputation": 22353, "user_id": 225016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77d3c3ab5ddcf93a8ca1bfe1b481be1c?s=128&d=identicon&r=PG", "display_name": "mdaniel", "link": "https://stackoverflow.com/users/225016/mdaniel"}, "edited": false, "score": 0, "creation_date": 1524947915, "post_id": 50074370, "comment_id": 87177618, "body": "<i>but I can&#39;t retrieve any of the data</i> Please read <a href=\"https://stackoverflow.com/help/how-to-ask\">how to ask</a> and rephrase your question as &quot;when I tried $foo, it did $bar, with error $err, but I was expecting $baz&quot;"}, {"owner": {"reputation": 31, "user_id": 9268778, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-piAgLAwoE28/AAAAAAAAAAI/AAAAAAAAATc/pG5xBxUeUW4/photo.jpg?sz=128", "display_name": "MATT SHALLOW", "link": "https://stackoverflow.com/users/9268778/matt-shallow"}, "reply_to_user": {"reputation": 22353, "user_id": 225016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77d3c3ab5ddcf93a8ca1bfe1b481be1c?s=128&d=identicon&r=PG", "display_name": "mdaniel", "link": "https://stackoverflow.com/users/225016/mdaniel"}, "edited": false, "score": 0, "creation_date": 1524989322, "post_id": 50074370, "comment_id": 87184850, "body": "There are no errors. I just want to know how you can connect to the same redis service from other services in GKE. I explained that I created a new client with redis-go in my compute-service and can store and retrieve data to my redis-service. However, when I tried creating the same kind of client in a different service I can&#39;t retrieve any data that was set in the compute service. So that leads me to the actual question at the end of my OP, how can I connect to a single redis-service instance from multiple services."}, {"owner": {"reputation": 22353, "user_id": 225016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77d3c3ab5ddcf93a8ca1bfe1b481be1c?s=128&d=identicon&r=PG", "display_name": "mdaniel", "link": "https://stackoverflow.com/users/225016/mdaniel"}, "edited": false, "score": 0, "creation_date": 1525030463, "post_id": 50074370, "comment_id": 87197162, "body": "<i>I can&#39;t retrieve any data that was set in the compute service</i> again, I wish I knew how to explain in simpler words: how do you know you are not retrieving any data: some error, zero keys found, times out, ... other? if you <code>redis-cli MONITOR</code> from within one of the <code>redis</code> Pods, do you see other keys arriving -- that is, do you know for sure the other operation is actually correctly setting the keys to make them available for read?"}, {"owner": {"reputation": 22353, "user_id": 225016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77d3c3ab5ddcf93a8ca1bfe1b481be1c?s=128&d=identicon&r=PG", "display_name": "mdaniel", "link": "https://stackoverflow.com/users/225016/mdaniel"}, "edited": false, "score": 0, "creation_date": 1525030517, "post_id": 50074370, "comment_id": 87197179, "body": "And do you still have <code>replicas: 1</code> as shown in the descriptor? because redis does not cluster itself automatically: one must take explicit steps to cluster them, otherwise k8s will round-robin across connections to the <code>Service</code>, which would also do weird things"}, {"owner": {"reputation": 31, "user_id": 9268778, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-piAgLAwoE28/AAAAAAAAAAI/AAAAAAAAATc/pG5xBxUeUW4/photo.jpg?sz=128", "display_name": "MATT SHALLOW", "link": "https://stackoverflow.com/users/9268778/matt-shallow"}, "reply_to_user": {"reputation": 22353, "user_id": 225016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77d3c3ab5ddcf93a8ca1bfe1b481be1c?s=128&d=identicon&r=PG", "display_name": "mdaniel", "link": "https://stackoverflow.com/users/225016/mdaniel"}, "edited": false, "score": 0, "creation_date": 1525165937, "post_id": 50074370, "comment_id": 87244870, "body": "I am getting &quot;nil&quot; when I try read the data from a different service. I can write and read from a single service so I know those functions are working. My understanding of having a single replica is that there is one redis service not multiples. Meaning the data I am sending to my redis service should be retrievable from calls in other services. I could be very wrong here though so will see what the steps are for clustering. Thanks for the help."}, {"owner": {"reputation": 31, "user_id": 9268778, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-piAgLAwoE28/AAAAAAAAAAI/AAAAAAAAATc/pG5xBxUeUW4/photo.jpg?sz=128", "display_name": "MATT SHALLOW", "link": "https://stackoverflow.com/users/9268778/matt-shallow"}, "reply_to_user": {"reputation": 22353, "user_id": 225016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77d3c3ab5ddcf93a8ca1bfe1b481be1c?s=128&d=identicon&r=PG", "display_name": "mdaniel", "link": "https://stackoverflow.com/users/225016/mdaniel"}, "edited": false, "score": 0, "creation_date": 1525206552, "post_id": 50074370, "comment_id": 87264838, "body": "I decided to use an intermediary service to handle all requests from other services. Not ideal but at least it works."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 9268778, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-piAgLAwoE28/AAAAAAAAAAI/AAAAAAAAATc/pG5xBxUeUW4/photo.jpg?sz=128", "display_name": "MATT SHALLOW", "link": "https://stackoverflow.com/users/9268778/matt-shallow"}, "is_accepted": false, "score": 0, "last_activity_date": 1526208470, "creation_date": 1526208470, "answer_id": 50315282, "question_id": 50074370, "link": "https://stackoverflow.com/questions/50074370/connect-to-redis-service-from-different-service-using-kubernetes/50315282#50315282", "title": "Connect to Redis service from different service using kubernetes", "body": "<p>To fix this I set the image pull policy in my compute-service deployment yaml to always. I also changed its port to :8080 and upgraded my GCP from a trial. One of these or a combination fixed the issue.</p>\n"}], "owner": {"reputation": 31, "user_id": 9268778, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-piAgLAwoE28/AAAAAAAAAAI/AAAAAAAAATc/pG5xBxUeUW4/photo.jpg?sz=128", "display_name": "MATT SHALLOW", "link": "https://stackoverflow.com/users/9268778/matt-shallow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 310, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1526208470, "creation_date": 1524903112, "last_edit_date": 1524993146, "question_id": 50074370, "link": "https://stackoverflow.com/questions/50074370/connect-to-redis-service-from-different-service-using-kubernetes", "title": "Connect to Redis service from different service using kubernetes", "body": "<p>I have a Kubernetes Cluster on google cloud platform with a number of services deployed. I imported redis-go in my compute service and can create a new client here to store/retrieve data to my redis service. I want to be able to access this stored data from a different service also. I tried using redis-go and creating a new client with the same address to my redis service cluster but I can't retrieve any of the data. So basically I am wondering how I can connect to a single redis-service instance from multiple services. Here is an example of code I am using to Dial my redis-service and store/retrieve value. I can store and retrieve from each individual service but if I store from one service and try retrieve from another it does not work.</p>\n\n<pre><code>      conn, _ := redis.Dial(\"tcp\", \"redis:6379\")\n      defer conn.Close()\n\n\n      conn.Do(\"SET\", \"bbcTrump\", \"someValue\")\n    //someValue, _:= conn.Do(\"GET\", \"bbcTrump\")\n</code></pre>\n\n<p>In addition here is my redis-deployment.yaml and redis-service.yaml code. Maybe there is a problem here.</p>\n\n<p>Deployment:</p>\n\n<pre><code>apiVersion: extensions/v1beta1\nkind: Deployment\nmetadata:\n  annotations:\n    kompose.cmd: kompose convert -f docker-compose.yml\n    kompose.version: 1.10.0 (HEAD)\n  creationTimestamp: null\n  labels:\n    io.kompose.service: redis\n  name: redis\nspec:\n  replicas: 1\n  strategy: {}\n  template:\n    metadata:\n      creationTimestamp: null\n      labels:\n        io.kompose.service: redis\n    spec:\n      containers:\n      - image: redis\n        name: redis\n        ports:\n        - containerPort: 6379\n        resources: {}\n\n      restartPolicy: Always\nstatus: {}\n</code></pre>\n\n<p>Service:</p>\n\n<pre><code>apiVersion: v1\nkind: Service\nmetadata:\n  annotations:\n    kompose.cmd: kompose convert -f docker-compose.yml\n    kompose.version: 1.10.0 (HEAD)\n  creationTimestamp: null\n  labels:\n    io.kompose.service: redis\n  name: redis\nspec:\n  ports:\n   - port: 6379\n     targetPort: 6379\n  selector:\n    io.kompose.service: redis\nstatus:\n  loadBalancer: {}\n</code></pre>\n"}, {"tags": ["go", "manpage"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1524898630, "post_id": 50073798, "comment_id": 87163923, "body": "Man pages on Windows?"}, {"owner": {"reputation": 16010, "user_id": 1568658, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FPSGe.jpg?s=128&g=1", "display_name": "user218867", "link": "https://stackoverflow.com/users/1568658/user218867"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1524898678, "post_id": 50073798, "comment_id": 87163934, "body": "@Volker The question said <code>unix</code> based systems."}, {"owner": {"reputation": 2201, "user_id": 3359432, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5d48edbf794415b7f16c19c50d8cc524?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhin David", "link": "https://stackoverflow.com/users/3359432/nidhin-david"}, "edited": false, "score": 0, "creation_date": 1524898872, "post_id": 50073798, "comment_id": 87163982, "body": "As man page for <code>g++</code> exists why not one for <code>go</code>?"}, {"owner": {"reputation": 5963, "user_id": 857012, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/LmRqL.png?s=128&g=1", "display_name": "Brian Gordon", "link": "https://stackoverflow.com/users/857012/brian-gordon"}, "edited": false, "score": 0, "creation_date": 1589671087, "post_id": 50073798, "comment_id": 109387125, "body": "The <code>go help</code> text changes dynamically now for many commands depending on whether or not you&#39;re in a module package. It might be cumbersome to have two separate manpages for each command and always have to add a suffix or something in order to look up the one you want."}, {"owner": {"reputation": 3880, "user_id": 5328289, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0e0e88b500a567f9572d0f8fe4e99405?s=128&d=identicon&r=PG&f=1", "display_name": "M.E.", "link": "https://stackoverflow.com/users/5328289/m-e"}, "edited": false, "score": 0, "creation_date": 1609435942, "post_id": 50073798, "comment_id": 115844532, "body": "It is shocking to find that go has no man page. I did <code>man go</code> today in FreeBSD to check about the available options for build and I thought that there was something wrong with the man pages in my system."}], "answers": [{"comments": [{"owner": {"reputation": 16010, "user_id": 1568658, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FPSGe.jpg?s=128&g=1", "display_name": "user218867", "link": "https://stackoverflow.com/users/1568658/user218867"}, "edited": false, "score": 0, "creation_date": 1524899587, "post_id": 50073847, "comment_id": 87164143, "body": "I installed it, by <code>go get -u github.com&#47;christophberger&#47;goman</code>, and add the <code>main () {..}</code> part into <code>.bashrc</code>, but when execute command <code>goman</code> it says <code>No command &#39;goman&#39; found</code>."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 16010, "user_id": 1568658, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FPSGe.jpg?s=128&g=1", "display_name": "user218867", "link": "https://stackoverflow.com/users/1568658/user218867"}, "edited": false, "score": 0, "creation_date": 1524899638, "post_id": 50073847, "comment_id": 87164157, "body": "@EricWang Is your $GOPATH/bin part of your PATH? Do you see goman in $GOPATH/bin?"}, {"owner": {"reputation": 16010, "user_id": 1568658, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FPSGe.jpg?s=128&g=1", "display_name": "user218867", "link": "https://stackoverflow.com/users/1568658/user218867"}, "edited": false, "score": 0, "creation_date": 1524900176, "post_id": 50073847, "comment_id": 87164303, "body": "It&#39;s missing, I just added it, and now could found command <code>goman</code>, and seems need to get the source code of those binaries to get result from <code>goman xxx</code>?"}, {"owner": {"reputation": 16010, "user_id": 1568658, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FPSGe.jpg?s=128&g=1", "display_name": "user218867", "link": "https://stackoverflow.com/users/1568658/user218867"}, "edited": false, "score": 0, "creation_date": 1524900574, "post_id": 50073847, "comment_id": 87164396, "body": "And seems it simple print content of README file, e.g <code>goman goman</code>, and <code>goman go</code> can&#39;t find doc, since there is no README file for it. So, seems it&#39;s not a perfect alternate for the typical man page."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 16010, "user_id": 1568658, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FPSGe.jpg?s=128&g=1", "display_name": "user218867", "link": "https://stackoverflow.com/users/1568658/user218867"}, "edited": false, "score": 0, "creation_date": 1524900620, "post_id": 50073847, "comment_id": 87164405, "body": "@EricWang First: has goman been compiled and installed as a result of the go get -u? &quot;could found command goman&quot; means either it was not, or the PATH does not reference GOPATH/bin. Or you did not exported the new PATH."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 16010, "user_id": 1568658, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FPSGe.jpg?s=128&g=1", "display_name": "user218867", "link": "https://stackoverflow.com/users/1568658/user218867"}, "edited": false, "score": 0, "creation_date": 1524900654, "post_id": 50073847, "comment_id": 87164412, "body": "@EricWang That is what I meant with &quot;that is not for Go itself&quot;: not an ideal solution, just an idea to be adapted."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 16010, "user_id": 1568658, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FPSGe.jpg?s=128&g=1", "display_name": "user218867", "link": "https://stackoverflow.com/users/1568658/user218867"}, "edited": false, "score": 0, "creation_date": 1524900725, "post_id": 50073847, "comment_id": 87164434, "body": "@EricWang The sources in <a href=\"https://codereview.appspot.com/5700081/\" rel=\"nofollow noreferrer\">codereview.appspot.com/5700081</a> are more fit for Go commands themselves... but was never completed."}, {"owner": {"reputation": 16010, "user_id": 1568658, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FPSGe.jpg?s=128&g=1", "display_name": "user218867", "link": "https://stackoverflow.com/users/1568658/user218867"}, "edited": false, "score": 0, "creation_date": 1524902013, "post_id": 50073847, "comment_id": 87164756, "body": "I see, I found a solution for ubuntu, please check the answer I just added."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 7, "last_activity_date": 1524898914, "creation_date": 1524898914, "answer_id": 50073847, "question_id": 50073798, "link": "https://stackoverflow.com/questions/50073798/man-page-for-golang/50073847#50073847", "title": "Man page for golang?", "body": "<p>You have an alternative with <strong>goman</strong>, <a href=\"https://appliedgo.net/goman/\" rel=\"noreferrer\">presented here</a></p>\n\n<p>See the GitHub project <a href=\"https://github.com/christophberger/goman\" rel=\"noreferrer\">christophberger/goman</a>: that is not for Go itself, but could be adapted to generate the man page for Go.</p>\n\n<p>Otherwise... <a href=\"https://github.com/golang/go/issues/101\" rel=\"noreferrer\">go issue 101</a> is one of the oldest issues out there (2009), and still opened!<br>\nIt was supposed to be fixed by an official goman command (see <a href=\"https://codereview.appspot.com/5700081/\" rel=\"noreferrer\">CL 5700081</a>), but that never was completed.</p>\n"}, {"comments": [{"owner": {"reputation": 16010, "user_id": 1568658, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FPSGe.jpg?s=128&g=1", "display_name": "user218867", "link": "https://stackoverflow.com/users/1568658/user218867"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1524902386, "post_id": 50074216, "comment_id": 87164857, "body": "@VonC But, I am not sure does other unix based systems have similar solution, e.g Centos / Mac."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1524902427, "post_id": 50074216, "comment_id": 87164866, "body": "That I don&#39;t know."}], "tags": [], "owner": {"reputation": 16010, "user_id": 1568658, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FPSGe.jpg?s=128&g=1", "display_name": "user218867", "link": "https://stackoverflow.com/users/1568658/user218867"}, "is_accepted": false, "score": 2, "last_activity_date": 1524902537, "last_edit_date": 1524902537, "creation_date": 1524901947, "answer_id": 50074216, "question_id": 50073798, "link": "https://stackoverflow.com/questions/50073798/man-page-for-golang/50074216#50074216", "title": "Man page for golang?", "body": "<p>For Ubuntu, I found this solution: <a href=\"https://github.com/golang/go/wiki/Ubuntu\" rel=\"nofollow noreferrer\">https://github.com/golang/go/wiki/Ubuntu</a></p>\n\n<hr>\n\n<h2>Example - ubuntu 16.04 &amp; golang 1.10 <em>(2018-04)</em></h2>\n\n<pre><code>sudo add-apt-repository ppa:longsleep/golang-backports\nsudo apt-get update\nsudo apt-get install golang-go\n</code></pre>\n\n<p>Then man pages are available.</p>\n\n<p>e.g</p>\n\n<pre><code>man go\nman go-get    # man page for `go get` sub command,\nman gofmt\n</code></pre>\n\n<p>Tips:</p>\n\n<ul>\n<li>Newest version of golang might can't be installed via the method above <em>(it has some kind of delay I think)</em>.<br>\nMy solution is to install the newest/desired version of golang via download manually, and make sure in <code>$PATH</code>, the manually installed one is searched first.<br>\nSo that when use <code>which go</code>, it will found the manually installed binary, instead of the one installed via <code>apt-get</code>.<br>\nThus could get the man page, while still able to use any desired version of golang.</li>\n</ul>\n"}], "owner": {"reputation": 16010, "user_id": 1568658, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FPSGe.jpg?s=128&g=1", "display_name": "user218867", "link": "https://stackoverflow.com/users/1568658/user218867"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1435, "favorite_count": 1, "answer_count": 2, "score": 5, "last_activity_date": 1524902537, "creation_date": 1524898557, "question_id": 50073798, "link": "https://stackoverflow.com/questions/50073798/man-page-for-golang", "title": "Man page for golang?", "body": "<p>Though <code>go help</code> is useful, but still it's not as expressive as man pages.</p>\n\n<p>So, any way to get man page for go binaries on unix based systems?</p>\n\n<p>If not, why such a feature hasn't been done since golang is so popular nowadays?</p>\n"}, {"tags": ["go", "heroku"], "answers": [{"comments": [{"owner": {"reputation": 1169, "user_id": 879889, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/wLsC6.png?s=128&g=1", "display_name": "iamtoc", "link": "https://stackoverflow.com/users/879889/iamtoc"}, "edited": false, "score": 0, "creation_date": 1524898699, "post_id": 50073526, "comment_id": 87163939, "body": "This feels super close, however, &#39;config.Server.HTTPPort = port&#39; returns:  &quot;cannot use port (type string) as type int in assignment&quot;, presumably from the &#39;type Info struct&#39; in server.go (HTTPPort int <code>json:&quot;HTTPPort&quot;</code>). I tried config.Server.HTTPPort = int(port), and also tried changing the type from int to string within the struct and played around with all sorts of data type conversions, and still get a similar type error. hrm.."}, {"owner": {"reputation": 5576, "user_id": 4986182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5oDOo.png?s=128&g=1", "display_name": "vitr", "link": "https://stackoverflow.com/users/4986182/vitr"}, "reply_to_user": {"reputation": 1169, "user_id": 879889, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/wLsC6.png?s=128&g=1", "display_name": "iamtoc", "link": "https://stackoverflow.com/users/879889/iamtoc"}, "edited": false, "score": 1, "creation_date": 1524899291, "post_id": 50073526, "comment_id": 87164077, "body": "@iamtoc, I see, I&#39;ve update the code to use strconv.Atoi"}], "tags": [], "owner": {"reputation": 5576, "user_id": 4986182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5oDOo.png?s=128&g=1", "display_name": "vitr", "link": "https://stackoverflow.com/users/4986182/vitr"}, "is_accepted": true, "score": 3, "last_activity_date": 1524899213, "last_edit_date": 1524899213, "creation_date": 1524896297, "answer_id": 50073526, "question_id": 50073091, "link": "https://stackoverflow.com/questions/50073091/how-to-use-dynamic-port-when-port-is-hard-coded-in-json-file/50073526#50073526", "title": "How to use dynamic port when port is hard-coded in .json file?", "body": "<p>True, you cannot set the port on Heroku. You have to deal with their port. I'd recommend to modify <code>blueprint.go</code> right before you run the server</p>\n\n<pre><code>port := os.Getenv(\"PORT\")\n\nif port == \"\" {\n    log.Fatal(\"$PORT must be set\")\n}\n\nconfig.Server.HTTPPort, _ = strconv.Atoi(port)\n\n// Start the HTTP and HTTPS listeners\nserver.Run(\n    handler,       // HTTP handler\n    handler,       // HTTPS handler\n    config.Server, // Server settings\n)\n</code></pre>\n"}], "owner": {"reputation": 1169, "user_id": 879889, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/wLsC6.png?s=128&g=1", "display_name": "iamtoc", "link": "https://stackoverflow.com/users/879889/iamtoc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 1, "accepted_answer_id": 50073526, "answer_count": 1, "score": 3, "last_activity_date": 1524925402, "creation_date": 1524892255, "last_edit_date": 1524925402, "question_id": 50073091, "link": "https://stackoverflow.com/questions/50073091/how-to-use-dynamic-port-when-port-is-hard-coded-in-json-file", "title": "How to use dynamic port when port is hard-coded in .json file?", "body": "<p>In attempting to run blue-jay/blueprint from Heroku, I cannot bind to port 80 as specified in the .json file, because Heroku seems to dynamically set the ports.</p>\n\n<p>Using os.Getenv(\"PORT\") does not seem to be an option as the .json is a static file. </p>\n\n<p><strong>HTTPPort: <a href=\"https://github.com/blue-jay/blueprint/blob/master/env.json.example\" rel=\"nofollow noreferrer\">env.json</a></strong></p>\n\n<pre><code>\"Server\": {\n    \"Hostname\": \"\",\n    \"UseHTTP\": true,\n    \"UseHTTPS\": false,\n    \"RedirectToHTTPS\": false,\n    \"HTTPPort\": 80,\n    \"HTTPSPort\": 443,\n    \"CertFile\": \"tls/server.crt\",\n    \"KeyFile\": \"tls/server.key\"\n},\n</code></pre>\n\n<p><strong>Returned server error:</strong></p>\n\n<pre><code>server.go:56: listen tcp :80: bind: permission denied\n</code></pre>\n\n<p><strong>Sources:</strong></p>\n\n<p><a href=\"https://github.com/blue-jay/blueprint/blob/master/env.json.example\" rel=\"nofollow noreferrer\">https://github.com/blue-jay/blueprint/blob/master/env.json.example</a></p>\n\n<p><a href=\"https://github.com/blue-jay/blueprint\" rel=\"nofollow noreferrer\">https://github.com/blue-jay/blueprint</a>   </p>\n\n<p>What is an appropriate way to handle this? </p>\n"}, {"tags": ["docker", "go", "redis", "alpine"], "comments": [{"owner": {"reputation": 4957, "user_id": 3833773, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/554650175/picture?type=large", "display_name": "Yaron Idan", "link": "https://stackoverflow.com/users/3833773/yaron-idan"}, "edited": false, "score": 2, "creation_date": 1524893879, "post_id": 50073035, "comment_id": 87162994, "body": "I&#39;ve just tried building the container like you instructed and when executing <code>redis-cli</code> the command seems to run just fine. Perhaps try using the fully qualified path of the command - <code>&#47;usr&#47;bin&#47;redis-cli</code>"}, {"owner": {"reputation": 339, "user_id": 2886884, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/tPpcz.jpg?s=128&g=1", "display_name": "mrdoubtful", "link": "https://stackoverflow.com/users/2886884/mrdoubtful"}, "reply_to_user": {"reputation": 4957, "user_id": 3833773, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/554650175/picture?type=large", "display_name": "Yaron Idan", "link": "https://stackoverflow.com/users/3833773/yaron-idan"}, "edited": false, "score": 0, "creation_date": 1524894455, "post_id": 50073035, "comment_id": 87163081, "body": "Do you mind sharing a snippet of your code?"}, {"owner": {"reputation": 339, "user_id": 2886884, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/tPpcz.jpg?s=128&g=1", "display_name": "mrdoubtful", "link": "https://stackoverflow.com/users/2886884/mrdoubtful"}, "reply_to_user": {"reputation": 4957, "user_id": 3833773, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/554650175/picture?type=large", "display_name": "Yaron Idan", "link": "https://stackoverflow.com/users/3833773/yaron-idan"}, "edited": false, "score": 0, "creation_date": 1524896794, "post_id": 50073035, "comment_id": 87163543, "body": "Thanks i got it to work with <code>&#47;usr&#47;bin&#47;redis-cli</code>."}, {"owner": {"reputation": 4957, "user_id": 3833773, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/554650175/picture?type=large", "display_name": "Yaron Idan", "link": "https://stackoverflow.com/users/3833773/yaron-idan"}, "edited": false, "score": 0, "creation_date": 1524933387, "post_id": 50073035, "comment_id": 87173496, "body": "Cool, I&#39;m adding that as an answer and would appreciate it if you could mark it as answered for anyone else who will seek an answer to this question."}], "answers": [{"tags": [], "owner": {"reputation": 4957, "user_id": 3833773, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/554650175/picture?type=large", "display_name": "Yaron Idan", "link": "https://stackoverflow.com/users/3833773/yaron-idan"}, "is_accepted": true, "score": 11, "last_activity_date": 1524933428, "creation_date": 1524933428, "answer_id": 50078771, "question_id": 50073035, "link": "https://stackoverflow.com/questions/50073035/install-redis-on-alpine-based-image-in-docker/50078771#50078771", "title": "Install Redis on Alpine based image in docker", "body": "<p>Try using the fully qualified path of the command - <code>/usr/bin/redis-cli</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 7979, "user_id": 1405852, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/3e5bcbf8ad70b3f69249058b1d7b8bf9?s=128&d=identicon&r=PG", "display_name": "Blue Smith", "link": "https://stackoverflow.com/users/1405852/blue-smith"}, "edited": false, "score": 0, "creation_date": 1616607025, "post_id": 64042083, "comment_id": 118058044, "body": "Thank you very much!"}], "tags": [], "owner": {"reputation": 41, "user_id": 14332578, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/3327d16d259f227e7f89bb90915cc36e?s=128&d=identicon&r=PG", "display_name": "leraning", "link": "https://stackoverflow.com/users/14332578/leraning"}, "is_accepted": false, "score": 3, "last_activity_date": 1600939766, "last_edit_date": 1600939766, "creation_date": 1600934851, "answer_id": 64042083, "question_id": 50073035, "link": "https://stackoverflow.com/questions/50073035/install-redis-on-alpine-based-image-in-docker/64042083#64042083", "title": "Install Redis on Alpine based image in docker", "body": "<p>To install it , use command as</p>\n<pre><code>apk --update add redis \n</code></pre>\n"}], "owner": {"reputation": 339, "user_id": 2886884, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/tPpcz.jpg?s=128&g=1", "display_name": "mrdoubtful", "link": "https://stackoverflow.com/users/2886884/mrdoubtful"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13031, "favorite_count": 4, "accepted_answer_id": 50078771, "answer_count": 2, "score": 7, "last_activity_date": 1600939766, "creation_date": 1524891702, "question_id": 50073035, "link": "https://stackoverflow.com/questions/50073035/install-redis-on-alpine-based-image-in-docker", "title": "Install Redis on Alpine based image in docker", "body": "<p>I am trying to install Redis on the <code>golang:1.10.1-alpine3.7</code> image. I tried <code>RUN apk add --no-cache redis</code>, but when I tried to run the <code>redis-cli</code> command, I get an exit status 127, which means the given command in not found. I would like to know how I would be able to run the <code>redis-cli</code> command.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3183, "user_id": 216345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffc76b5c6c4607d55b0796da63d67f0?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/216345/thomas"}, "edited": false, "score": 0, "creation_date": 1524937266, "post_id": 50072834, "comment_id": 87174726, "body": "You should consider reading the section on unmarshalling in the viper docs. You should be able to unmarshal your whole config into structs without having to do a bunch of manual assignments. Just a reminder, the fields will need to be public (and potentially tagged) to make the unmarshal work."}, {"owner": {"reputation": 23, "user_id": 9138749, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ko7Nm9QwG1E/AAAAAAAAAAI/AAAAAAAAAFs/IYvxr_yVtZc/photo.jpg?sz=128", "display_name": "Bo\u0161tjan Bele", "link": "https://stackoverflow.com/users/9138749/bo%c5%a1tjan-bele"}, "reply_to_user": {"reputation": 3183, "user_id": 216345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffc76b5c6c4607d55b0796da63d67f0?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/216345/thomas"}, "edited": false, "score": 0, "creation_date": 1524937821, "post_id": 50072834, "comment_id": 87174890, "body": "Hi Thomas! Have done. Has measurements in the structure already and the simple part of the config was loaded ok... but haven&#39;t got the dynamic part  working (got no error). I read that some maps can not be unmarshaled. That&#39;s why I chose to build the structure manually."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9138749, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ko7Nm9QwG1E/AAAAAAAAAAI/AAAAAAAAAFs/IYvxr_yVtZc/photo.jpg?sz=128", "display_name": "Bo\u0161tjan Bele", "link": "https://stackoverflow.com/users/9138749/bo%c5%a1tjan-bele"}, "edited": false, "score": 0, "creation_date": 1525270830, "post_id": 50079955, "comment_id": 87292046, "body": "thank you... missed map[string]Company and therefor unmarshal didn&#39;t work. I feel a bit embarrased that I didn&#39;t see this beginners error :)"}], "tags": [], "owner": {"reputation": 3183, "user_id": 216345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffc76b5c6c4607d55b0796da63d67f0?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/216345/thomas"}, "is_accepted": true, "score": 0, "last_activity_date": 1524941790, "last_edit_date": 1524941790, "creation_date": 1524941352, "answer_id": 50079955, "question_id": 50072834, "link": "https://stackoverflow.com/questions/50072834/dynamic-group-names-with-viper/50079955#50079955", "title": "Dynamic group names with viper", "body": "<p>I started down the road of answering your initial question but it is so cumbersome and probably not what you actually want.</p>\n\n<p>Your code as you've pasted it has a bunch of errors in it so instead let me offer a simpler solution like I was talking about in my comment.</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n\n    \"github.com/spf13/viper\"\n)\n\ntype Config struct {\n    Database  Database           `mapstructure:\"database\"`\n    Customers map[string]Company `mapstructure:\"customers\"`\n}\n\ntype Database struct {\n    Host string `mapstructure:\"host\"`\n    Port uint16 `mapstructure:\"port\"`\n    User string `mapstructure:\"user\"`\n    Pass string `mapstructure:\"pass\"`\n    Db   string `mapstructure:\"db\"`\n}\n\ntype Company struct {\n    Address  string    `mapstructure:\"address\"`\n    Contacts []Contact `mapstructure:\"contacts\"`\n}\n\ntype Contact struct {\n    Name  string `mapstructure:\"name\"`\n    Email string `mapstructure:\"email\"`\n}\n\nfunc main() {\n    viper.SetConfigName(\"config\")\n    viper.AddConfigPath(\".\")\n    if err := viper.ReadInConfig(); err != nil {\n        log.Fatal(\"Unable to read config file\", err)\n    }\n    var conf Config\n    err := viper.Unmarshal(&amp;conf)\n    if err != nil {\n        panic(err)\n    }\n\n    log.Printf(\"%#v\", conf)\n}\n</code></pre>\n\n<p>If you run this code with your JSON config file (named <code>config</code>) it returns the following output:</p>\n\n<blockquote>\n  <p>2018/04/28 14:47:54\n  main.Config{Database:main.Database{Host:\"localhost\", Port:0xcea,\n  User:\"username\", Pass:\"mypassword\", Db:\"mydb\"},\n  Customers:map[string]main.Company{\"company_two\":main.Company{Address:\"Irish\n  Town Pl, Gibraltar GX11 1AA, Gibraltar\",\n  Contacts:[]main.Contact{main.Contact{Name:\"Lucky Luke\",\n  Email:\"lucky.luke@second-company.local\"}}},\n  \"company_one\":main.Company{Address:\"66 Great Queen St, London WC2B\n  5BX, UK\", Contacts:[]main.Contact{main.Contact{Name:\"Joe Doe\",\n  Email:\"joe.doe@company-one.local\"}, main.Contact{Name:\"Jane Doe\",\n  Email:\"jane.doe@company-one.local\"}}}}}</p>\n</blockquote>\n\n<p>And here it is reformatted as it would be written if you were creating this whole structure in code:</p>\n\n<pre><code> Config{\n    Database{\n        Host: \"localhost\",\n        Port: 0xcea,\n        User: \"username\",\n        Pass: \"mypassword\",\n        Db:   \"mydb\"},\n    Customers: map[string]Company{\n        \"company_two\": Company{Address: \"Irish Town Pl, Gibraltar GX11 1AA, Gibraltar\",\n            Contacts: []Contact{\n                Contact{Name: \"Lucky Luke\", Email: \"lucky.luke@second-company.local\"}}},\n        \"company_one\": Company{Address: \"66 Great Queen St, London WC2B 5BX, UK\",\n            Contacts: []Contact{\n                Contact{Name: \"Joe Doe\", Email: \"joe.doe@company-one.local\"},\n                Contact{Name: \"Jane Doe\", Email: \"jane.doe@company-one.local\"}}},\n    },\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9138749, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ko7Nm9QwG1E/AAAAAAAAAAI/AAAAAAAAAFs/IYvxr_yVtZc/photo.jpg?sz=128", "display_name": "Bo\u0161tjan Bele", "link": "https://stackoverflow.com/users/9138749/bo%c5%a1tjan-bele"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "accepted_answer_id": 50079955, "answer_count": 1, "score": 1, "last_activity_date": 1524941790, "creation_date": 1524889591, "last_edit_date": 1524899635, "question_id": 50072834, "link": "https://stackoverflow.com/questions/50072834/dynamic-group-names-with-viper", "title": "Dynamic group names with viper", "body": "<p>I'm trying to get some groups from the config, which names are not known (will get more later on).</p>\n\n<p>I'm new to golang and struggling a bit. I'm using Viper, because of its support for yaml, json and toml.</p>\n\n<p>json config:</p>\n\n<pre><code>{\n    \"database\": {\n        \"db\": \"mydb\",\n        \"host\": \"localhost\",\n        \"pass\": \"mypassword\",\n        \"port\": 3306,\n        \"user\": \"username\"\n    },\n    \"customers\": {\n        \"company_one\": {\n            \"address\": \"66 Great Queen St, London WC2B 5BX, UK\",\n            \"contacts\": [\n                {\n                    \"email\": \"joe.doe@company-one.local\",\n                    \"name\": \"Joe Doe\"\n                },\n                {\n                    \"email\": \"jane.doe@company-one.local\",\n                    \"name\": \"Jane Doe\"\n                }\n            ]\n        },\n        \"company_two\": {\n            \"address\": \"Irish Town Pl, Gibraltar GX11 1AA, Gibraltar\",\n            \"contacts\": [\n                {\n                    \"email\": \"lucky.luke@second-company.local\",\n                    \"name\": \"Lucky Luke\"\n                }\n            ]\n        }\n    }\n}\n</code></pre>\n\n<p>and the source:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"github.com/spf13/viper\"\n)\n\ntype Config struct {\n    database Database\n    customers Customer\n}\n\ntype Database struct {\n    host string\n    port uint16\n    user string\n    pass string\n    db string\n}\n\ntype Customer struct {\n    company Company\n}\n\ntype Company struct {\n    contacts Contact\n    address string\n}\n\ntype Contact struct {\n    name string\n    email string\n}\n\nfunc main() {\n    viper.SetConfigName(\"a\")\n    viper.AddConfigPath(\".\")\n    if err := viper.ReadInConfig(); err != nil {\n        log.Fatal(\"Unable to read config file\", err)\n    }\n    var conf Config\n    database := viper.GetStringMap(\"database\")\n    for key, i := range database {\n        switch key {\n        case \"host\":\n            conf.database.host = i.(string)\n        case \"port\":\n            conf.database.port = i.(uint16)\n        case \"user\":\n            conf.database.user = i.(string)\n        case \"pass\":\n            conf.database.pass = i.(string)\n        case \"db\":\n            conf.database.db = i.(string)\n        }\n    }\n    fmt.Printf(\"%v\\n\", conf)\n}\n</code></pre>\n\n<p>I have no idea how to cycle through the customers. </p>\n\n<p>I have tried this one already (converted from go-toml to viper), but it didn't work as expected:</p>\n\n<pre><code>var contMap = map[string]Contacts\n\ncust := config.Get(\"customers\")\n\nfor _, c := range cust.Keys() {\n    sub := cust.Get(c).([]interface{})\n    for _,d := range sub{\n        address := d.([]interface{})[0].(string)\n        hostMap[host] = Contacts{\n            email: email,\n            name: name,\n        }\n    }\n    log.Printf(\"Customers: %s contact: %q\", c, sub)\n}\n</code></pre>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 856, "user_id": 522005, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e410fd984af8198028c1c4495f7bf69?s=128&d=identicon&r=PG", "display_name": "Vahid Jafari", "link": "https://stackoverflow.com/users/522005/vahid-jafari"}, "edited": false, "score": 0, "creation_date": 1524920415, "post_id": 50073957, "comment_id": 87169703, "body": "Thnx. It Works.  Is it correct way for mocking MongoDB in Go? Another question is each time I call Copy method it return new object. Isn&#39;t this cause a problem?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 856, "user_id": 522005, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e410fd984af8198028c1c4495f7bf69?s=128&d=identicon&r=PG", "display_name": "Vahid Jafari", "link": "https://stackoverflow.com/users/522005/vahid-jafari"}, "edited": false, "score": 1, "creation_date": 1524921336, "post_id": 50073957, "comment_id": 87170007, "body": "This kind of mocking isn&#39;t necessarily the best solution, but it&#39;s a working, viable solution."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 856, "user_id": 522005, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e410fd984af8198028c1c4495f7bf69?s=128&d=identicon&r=PG", "display_name": "Vahid Jafari", "link": "https://stackoverflow.com/users/522005/vahid-jafari"}, "edited": false, "score": 1, "creation_date": 1524923152, "post_id": 50073957, "comment_id": 87170531, "body": "And calling <code>Copy()</code> does not cause trouble as long as you don&#39;t forget to close the copy with its <code>Close()</code> method when you&#39;re done with it. But you must close it!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1524901142, "last_edit_date": 1524901142, "creation_date": 1524899890, "answer_id": 50073957, "question_id": 50072677, "link": "https://stackoverflow.com/questions/50072677/how-to-add-clone-and-copy-functions-in-mocking-mongodb-in-go/50073957#50073957", "title": "How to add Clone and Copy functions in mocking MongoDB in Go?", "body": "<p><code>MongoSession.Copy()</code> and <code>MongoSession.Clone()</code> must return a value that implements <code>ISession</code>. Basically you create <code>MongoSession</code> type exactly for this: to implement <code>ISession</code>.</p>\n\n<p><a href=\"https://godoc.org/github.com/globalsign/mgo#Session\" rel=\"nofollow noreferrer\"><code>mgo.Session</code></a> does not implement your <code>ISession</code> interface (e.g. because its <a href=\"https://godoc.org/github.com/globalsign/mgo#Session.Clone\" rel=\"nofollow noreferrer\"><code>Session.Clone()</code></a> method has a return type of <code>*mgo.Session</code> and not <code>ISession</code>). You should create and return a new value of <code>MongoSession</code>, in which you can wrap the copied or cloned <code>*mgo.Session</code> value.</p>\n\n<p>Like this:</p>\n\n<pre><code>func (s MongoSession) Clone() ISession {\n    return MongoSession{dbSession: s.dbSession.Clone()}\n}\n\nfunc (s MongoSession) Copy() ISession {\n    return MongoSession{dbSession: s.dbSession.Copy()}\n}\n</code></pre>\n"}], "owner": {"reputation": 856, "user_id": 522005, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e410fd984af8198028c1c4495f7bf69?s=128&d=identicon&r=PG", "display_name": "Vahid Jafari", "link": "https://stackoverflow.com/users/522005/vahid-jafari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "accepted_answer_id": 50073957, "answer_count": 1, "score": 6, "last_activity_date": 1524901142, "creation_date": 1524887592, "last_edit_date": 1524900434, "question_id": 50072677, "link": "https://stackoverflow.com/questions/50072677/how-to-add-clone-and-copy-functions-in-mocking-mongodb-in-go", "title": "How to add Clone and Copy functions in mocking MongoDB in Go?", "body": "<p>I read this <a href=\"http://thylong.com/golang/2016/mocking-mongo-in-golang/\" rel=\"noreferrer\">article</a> and it has good guides for mocking MongoDB in Go. But there are some problems in <code>Clone()</code> and <code>Copy()</code> methods.\nI create this interfaces and structs:</p>\n\n<pre><code>type ISession interface {\n    DB(name string) IDatabase\n    Close()\n    Clone() ISession\n    Copy() ISession\n}\n\ntype IDatabase interface {\n    C(name string) ICollection\n}\n\ntype MongoSession struct {\n    dbSession *mgo.Session\n}\n\nfunc (s MongoSession) DB(name string) IDatabase {\n    return &amp;MongoDatabase{Database: s.dbSession.DB(name)}\n}\n\nfunc (s MongoSession) Clone() ISession {\n    //return session.clone\n    return s.dbSession.Clone()\n}\n\nfunc (s MongoSession) Copy() ISession {\n    return s.dbSession.Copy()\n}\n</code></pre>\n\n<p>But I got this error</p>\n\n<blockquote>\n  <p>cannot use s.dbSession.Clone() (type *mgo.Session) as type ISession in\n  return argument:  *mgo.Session does not implement ISession (wrong type\n  for Clone method)         have Clone() *mgo.Session       want Clone() ISession</p>\n  \n  <p>cannot use s.dbSession.Copy() (type *mgo.Session) as type ISession in\n  return argument:  *mgo.Session does not implement ISession (wrong type\n  for Clone method)         have Clone() *mgo.Session       want Clone() ISession</p>\n</blockquote>\n\n<p>How can I add <code>Clone()</code> and <code>Copy()</code> methods to interface?</p>\n"}, {"tags": ["go", "path", "package", "load", "directory"], "comments": [{"owner": {"reputation": 187, "user_id": 3758517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fLT1J.png?s=128&g=1", "display_name": "Jonathan Hecl", "link": "https://stackoverflow.com/users/3758517/jonathan-hecl"}, "reply_to_user": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1524884137, "post_id": 50071823, "comment_id": 87161536, "body": "Thank you Michael. Its works!  Its a OneDrive error, I cut de folder outside OneDrive, sync, and re-paste in, and its works! :D"}], "owner": {"reputation": 187, "user_id": 3758517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fLT1J.png?s=128&g=1", "display_name": "Jonathan Hecl", "link": "https://stackoverflow.com/users/3758517/jonathan-hecl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 155, "favorite_count": 0, "closed_date": 1524884149, "answer_count": 0, "score": 1, "last_activity_date": 1524925428, "creation_date": 1524876805, "last_edit_date": 1524925428, "question_id": 50071823, "link": "https://stackoverflow.com/questions/50071823/cant-load-package-package-cannot-find-package-in", "closed_reason": "Duplicate", "title": "can&#39;t load package: package .: cannot find package &quot;.&quot; in", "body": "<p>I have two folders projects with Golang projects. In the first all projects works, but in the other a have \"can't load package: package .: cannot find package \".\"\" in all projects.</p>\n\n<ol>\n<li>E:/Clouds/hubiC/GoLang/test/test.go</li>\n<li>E:/Clouds/OneDrive/CX/GoLang/test/test.go</li>\n</ol>\n\n<p>With the same code... </p>\n\n<pre><code>package main\n\nfunc main() {\n    println(\"Hi\")\n    return\n}\n</code></pre>\n\n<p>In the 1... all fine:</p>\n\n<blockquote>\n  <p>c:/go/bin/go.exe build -i [E:/Clouds/hubiC/GoLang/test]\n  Success: process exited with code 0.</p>\n</blockquote>\n\n<p>In the 2... :S</p>\n\n<blockquote>\n  <p>c:/go/bin/go.exe build -i [E:/Clouds/OneDrive/CX/GoLang/test] can't\n  load package: package .: cannot find package \".\" in:\n    E:\\Clouds\\OneDrive\\CX\\GoLang\\test Error: process exited with code 1.</p>\n</blockquote>\n\n<p>Why happend this? </p>\n\n<p>I am using</p>\n\n<blockquote>\n  <p>go version go1.10 windows/amd64</p>\n</blockquote>\n\n<p>Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 407, "user_id": 1516389, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/911397984d6f8c1deadf49ae7b9b10cf?s=128&d=identicon&r=PG", "display_name": "raka", "link": "https://stackoverflow.com/users/1516389/raka"}, "edited": false, "score": 0, "creation_date": 1538590297, "post_id": 50070572, "comment_id": 92199791, "body": "The question initially was &#39;How to modify arrays using pointers?&#39;. It was changed to &#39;How to modify slices using pointers?&#39; by users answering the question. My bulb went on as soon as I saw it. It is an &#39;array&#39;  only when a size is declared. For e.g. vertices := [2]Vertex{v1, v2}. Otherwise, they are all slices e.g: vertices := []Vertex{v1, v2}"}], "answers": [{"tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": false, "score": 7, "last_activity_date": 1524865386, "last_edit_date": 1524865386, "creation_date": 1524865018, "answer_id": 50070607, "question_id": 50070572, "link": "https://stackoverflow.com/questions/50070572/how-to-modify-slices-using-pointers/50070607#50070607", "title": "How to modify slices using pointers", "body": "<p>In your second example you are passing a pointer to a slice.  There is almost never a reason to do that as the slice is already a pointer to an array (along with a length and capacity).</p>\n\n<p><a href=\"https://i.stack.imgur.com/h2Ggm.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/h2Ggm.png\" alt=\"enter image description here\"></a>  <a href=\"https://i.stack.imgur.com/Cq2IY.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/Cq2IY.png\" alt=\"enter image description here\"></a></p>\n\n<p>Your pointer to a slice contains instances of Vertex, not *Vertex, so modifying them does not have any affect.  If you instead changed your method signature to </p>\n\n<pre><code>func modifyArray(vertices []*Vertex) \n</code></pre>\n\n<p>and passed a slice of pointers, then you could modify them like you expect.</p>\n\n<p>Here is a <a href=\"https://play.golang.org/p/NP_2uYDVQdl\" rel=\"noreferrer\">playground</a> showing you by example.  The corresponding code is below</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Vertex struct {\n    x int\n    y int\n}\n\nfunc modifyObject(v *Vertex) {\n    v.x = v.x * v.x\n    v.y = v.y * v.y\n}\n\nfunc modifyArray(vertices []*Vertex) {\n    for _, v := range vertices {\n        v.x = v.x * v.x\n        v.y = v.y * v.y\n    }\n}\n\nfunc main() {\n    v := Vertex{2, 3}\n    modifyObject(&amp;v)\n    fmt.Println(\"Vertex modified successfully:\", v)\n\n    v1 := Vertex{2, 3}\n    v2 := Vertex{20, 30}\n    vertices := []*Vertex{&amp;v1, &amp;v2}\n    modifyArray(vertices)\n    fmt.Printf(\"Vertices are modified: %v %v\", vertices[0], vertices[1])\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1524922887, "last_edit_date": 1524922887, "creation_date": 1524866870, "answer_id": 50070880, "question_id": 50070572, "link": "https://stackoverflow.com/questions/50070572/how-to-modify-slices-using-pointers/50070880#50070880", "title": "How to modify slices using pointers", "body": "<p>The function <code>modifyArray</code> modifies the local variable <code>v</code>, not the slice element. Assign to the slice element using an index expression:</p>\n\n<pre><code>func modifyArray(vertices *[]Vertex) {\n    for i, v := range *vertices {\n        (*vertices)[i].x = v.x * v.x\n        (*vertices)[i].y = v.y * v.y\n    }\n}\n</code></pre>\n\n<p>Because the slice contains a pointer to the backing array, there's no need to pass a pointer to the slice:</p>\n\n<pre><code>func modifyArray(vertices []Vertex) {\n    for i, v := range vertices {\n        vertices[i].x = v.x * v.x\n        vertices[i].y = v.y * v.y\n    }\n}\n</code></pre>\n\n<p>Call it like this:</p>\n\n<pre><code>modifyArray(vertices)  // do not take address of vertices\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/6W5Wwb2p9oV\" rel=\"nofollow noreferrer\">playground example</a></p>\n\n<p>You can use <code>modifyObject</code> by taking the address of the slice element:</p>\n\n<pre><code> func modifyArray(vertices []Vertex) {\n    for i := range vertices {\n        modifyObject(&amp;vertices[i])\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/RF3kXTMnLr5\" rel=\"nofollow noreferrer\">playground example</a></p>\n\n<p>Unlike other answers, this answer retains the memory layout in the question.</p>\n"}], "owner": {"reputation": 407, "user_id": 1516389, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/911397984d6f8c1deadf49ae7b9b10cf?s=128&d=identicon&r=PG", "display_name": "raka", "link": "https://stackoverflow.com/users/1516389/raka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 50070880, "answer_count": 2, "score": 1, "last_activity_date": 1524925418, "creation_date": 1524864734, "last_edit_date": 1524925418, "question_id": 50070572, "link": "https://stackoverflow.com/questions/50070572/how-to-modify-slices-using-pointers", "title": "How to modify slices using pointers", "body": "<p>Why isn't the slice being modified in the following code:</p>\n\n<pre><code>package pointers\n\nimport \"fmt\"\n\nfunc modifyObject(v *Vertex) {\n    v.x = v.x * v.x\n    v.y = v.y * v.y\n}\n\nfunc modifyArray(vertices *[]Vertex) {\n    for _, v := range *vertices {\n        v.x = v.x * v.x\n        v.y = v.y * v.y\n    }\n}\n\nfunc DemoPointersArray() {\n    v := Vertex{2, 3}\n    modifyObject(&amp;v)\n    fmt.Println(\"Vertex modified successfully:\", v)\n\n    v1 := Vertex{2, 3}\n    v2 := Vertex{20, 30}\n    vertices := []Vertex{v1, v2}\n    modifyArray(&amp;vertices)\n    fmt.Println(\"Vertices are NOT modified:\", vertices)\n}\n</code></pre>\n\n<p><em>Output:</em><br/>\nVertex modified successfully: {4 9}<br/>\nVertices are NOT modified: [{2 3} {20 30}]<br/></p>\n\n<p>How to modify them?</p>\n"}, {"tags": ["go", "plugins"], "answers": [{"comments": [{"owner": {"reputation": 452, "user_id": 3366355, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/8db57c6e8aadb203088ef7c450e1ff61?s=128&d=identicon&r=PG&f=1", "display_name": "martin", "link": "https://stackoverflow.com/users/3366355/martin"}, "edited": false, "score": 0, "creation_date": 1525404970, "post_id": 50071296, "comment_id": 87351236, "body": "yes, I&#39;ve gone through most of the tutorial topics and gave special attention to channels prior to this. Thanks for your answer btw."}], "tags": [], "owner": {"reputation": 415, "user_id": 9661066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DKIYpno_RaE/AAAAAAAAAAI/AAAAAAAAAAA/784Fv4xgNp8/photo.jpg?sz=128", "display_name": "GilesW", "link": "https://stackoverflow.com/users/9661066/gilesw"}, "is_accepted": false, "score": 2, "last_activity_date": 1524870446, "creation_date": 1524870446, "answer_id": 50071296, "question_id": 50070131, "link": "https://stackoverflow.com/questions/50070131/passing-channel-param-to-a-dynamic-loaded-func-in-golang/50071296#50071296", "title": "passing channel param to a dynamic loaded func in golang", "body": "<p>If you are still learning golang then plugins are definitely not the place to start. I believe plugin support is still experimental and doesn't work on all OS - in 1.10 I believe Darwin was added to previous Linux. </p>\n\n<p>A quick search reveals a pre-existing issue reported similar to yours -looks like it's in go 1.10:\n<a href=\"https://github.com/golang/go/issues/24351\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/24351</a></p>\n\n<p>You can maybe track through the repository and get a branch or version where this is fixed, but whilst your learning you aren't going to have any confidence in whether problems with this area of functionality are with your code or the plugin system. I recommend therefore sticking to learning go with core language features for now.</p>\n"}, {"comments": [{"owner": {"reputation": 452, "user_id": 3366355, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/8db57c6e8aadb203088ef7c450e1ff61?s=128&d=identicon&r=PG&f=1", "display_name": "martin", "link": "https://stackoverflow.com/users/3366355/martin"}, "edited": false, "score": 0, "creation_date": 1525173907, "post_id": 50076447, "comment_id": 87248384, "body": "Thanks Aristofanio, looks like it&#39;s working, I had to add &#39;package &quot;mydata&quot;&#39; to the dataunit.go"}], "tags": [], "owner": {"reputation": 983, "user_id": 7059119, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209343272591927/picture?type=large", "display_name": "Aristofanio Garcia", "link": "https://stackoverflow.com/users/7059119/aristofanio-garcia"}, "is_accepted": true, "score": 1, "last_activity_date": 1524918812, "last_edit_date": 1524918812, "creation_date": 1524917661, "answer_id": 50076447, "question_id": 50070131, "link": "https://stackoverflow.com/questions/50070131/passing-channel-param-to-a-dynamic-loaded-func-in-golang/50076447#50076447", "title": "passing channel param to a dynamic loaded func in golang", "body": "<p>In go is possible to pass channels of objects!!</p>\n\n<p>For example, if you to use <strong>&lt;-chan http.Header</strong> will works fine. The question is that the params must be shared between modules and application. So if you reallocate DataUnit for another package will work. </p>\n\n<p>My test was structured like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ma6GSm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ma6GSm.png\" alt=\"enter image description here\"></a></p>\n\n<p>My interface:</p>\n\n<pre><code>//in modmain.go\ntype Module interface {\n    RunMod(in &lt;-chan *mydata.DataUnit)\n}\n</code></pre>\n\n<p>My module:</p>\n\n<pre><code>//in modcounter.go\nfunc (m module) RunMod(in &lt;-chan *mydata.DataUnit) {\n    fmt.Println(\"Hello Universe \")\n    n := &lt;-in\n    fmt.Printf(\"%v\", n.S)\n}\n</code></pre>\n\n<p>My data:</p>\n\n<pre><code>//in dataunit.go\ntype DataUnit struct {\n    I int    //export field\n    S string //export field\n}\n</code></pre>\n\n<p>The result:\n<a href=\"https://i.stack.imgur.com/ILQdr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ILQdr.png\" alt=\"enter image description here\"></a></p>\n\n<p>P.S.: Docker with golang 1.10 was used for tests.</p>\n\n<pre><code>#in Dockerfile\nFROM golang:1.10\nCOPY . /go/\nRUN export GOPATH=$GOPATH:/go/\nRUN cd /go/src/mydata &amp;&amp; go build dataunit.go\nRUN cd /go/src/app &amp;&amp; go build modmain.go\nRUN cd /go/src/app &amp;&amp; go build -buildmode=plugin -o modcounter.so modcounter.go\nWORKDIR /go/src/app\nRUN ls -l\nCMD [\"/go/src/app/modmain\"]\n</code></pre>\n"}], "owner": {"reputation": 452, "user_id": 3366355, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/8db57c6e8aadb203088ef7c450e1ff61?s=128&d=identicon&r=PG&f=1", "display_name": "martin", "link": "https://stackoverflow.com/users/3366355/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 440, "favorite_count": 0, "accepted_answer_id": 50076447, "answer_count": 2, "score": 1, "last_activity_date": 1524918812, "creation_date": 1524862268, "question_id": 50070131, "link": "https://stackoverflow.com/questions/50070131/passing-channel-param-to-a-dynamic-loaded-func-in-golang", "title": "passing channel param to a dynamic loaded func in golang", "body": "<p>I'm new to golang and golang plugins. I'm having trouble passing a chan object to this functions. If I switch to int it works. Not sure what exactly I am missing. Thanks for any help.</p>\n\n<p><strong>dataunit.go</strong></p>\n\n<pre><code>package main\n\ntype DataUnit struct {\n   i int\n   s string\n}\n</code></pre>\n\n<p><strong>modcounter.go</strong></p>\n\n<pre><code>package main\nimport ( \n  \"fmt\"\n//  \"strconv\"\n)\ntype module string \n//func (m module) RunMod(i int) {\nfunc (m module) RunMod(in &lt;-chan *DataUnit) {\n    //fmt.Println(\"Hello Universe \" + strconv.Itoa(i))\n    fmt.Println(\"Hello Universe \")\n        n := &lt;-in\n        fmt.Printf(n.s)\n}\nvar Module module\n</code></pre>\n\n<p><strong>modmain.go</strong></p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"os\"\n  \"plugin\"\n)\n\n\ntype DataUnit struct {\n   i int\n   s string\n}\n\ntype Module interface {\n        //RunMod(i int)\n        RunMod(in &lt;-chan *DataUnit)\n}\n\n\nfunc main() {\n\n\n        out := make(chan *DataUnit, 2000)\n        plug, err := plugin.Open(\"./modcounter.so\")\n        if err != nil {\n                fmt.Printf(\"FATAL (plugin.Open): \" + err.Error())\n                os.Exit(1)\n        }\n\n        symModule, err := plug.Lookup(\"Module\")\n        if err != nil {\n           fmt.Printf(err.Error())\n           os.Exit(1)\n        }\n\n        var module Module\n        module, ok:= symModule.(Module)\n        if !ok {\n                fmt.Println(\"unexpected type from module symbol\")\n                os.Exit(1)\n        }\n\n        //module.RunMod(5)\n        module.RunMod(out)\n}\n</code></pre>\n\n<p><em>go build -buildmode=plugin -o modcounter.so modcounter.go dataunit.go</em> <br>\n<em>go build modmain.go dataunit.go</em> </p>\n\n<p>./modmain <br>\n<strong>unexpected type from module symbol</strong></p>\n"}, {"tags": ["go", "interface"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1524859275, "post_id": 50069493, "comment_id": 87155472, "body": "You can assign any type you want to <code>interface{}</code>. What exactly is the problem?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1524902558, "post_id": 50069493, "comment_id": 87164893, "body": "This might come handy to you: <a href=\"https://github.com/icza/dyno\" rel=\"nofollow noreferrer\">github.com/icza/dyno</a> (disclosure: I&#39;m the author)."}], "answers": [{"comments": [{"owner": {"reputation": 1213, "user_id": 2001856, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/13UBK.jpg?s=128&g=1", "display_name": "Miljan Rakita", "link": "https://stackoverflow.com/users/2001856/miljan-rakita"}, "edited": false, "score": 0, "creation_date": 1524863872, "post_id": 50070044, "comment_id": 87157385, "body": "Good one ! Thank you a lot, that is what i need."}], "tags": [], "owner": {"reputation": 1510, "user_id": 6476791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55d5de71330e6307063fdb6dde80d7ca?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/6476791/adrian"}, "is_accepted": true, "score": 1, "last_activity_date": 1524861863, "creation_date": 1524861863, "answer_id": 50070044, "question_id": 50069493, "link": "https://stackoverflow.com/questions/50069493/golang-set-new-value-to-object-with-type-mapstringinterface/50070044#50070044", "title": "golang set new value to object with type map[string]interface{}", "body": "<p>You can set string and value stay as string type   </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n)\n\nfunc main() {\n\n    var bdoc interface{}\n    aMap, ok := bdoc.(map[string]interface{})\n    if !ok {\n       log.Fatalf(\"Failed to cast %T\", bdoc)\n    }\n    //depending on JSON settting pk number may have json.Numbe or float64\n    fmt.Prinf(\"%v  %T\\n\", aMap[\"pk\"], aMap[\"pk\"])\n   aMap[\"pk\"] =\"1234\"\n    fmt.Prinf(\"%v  %T\\n\", aMap[\"pk\"], aMap[\"pk\"])\n\n}\n</code></pre>\n"}], "owner": {"reputation": 1213, "user_id": 2001856, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/13UBK.jpg?s=128&g=1", "display_name": "Miljan Rakita", "link": "https://stackoverflow.com/users/2001856/miljan-rakita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1890, "favorite_count": 0, "accepted_answer_id": 50070044, "answer_count": 1, "score": 0, "last_activity_date": 1524861863, "creation_date": 1524859167, "question_id": 50069493, "link": "https://stackoverflow.com/questions/50069493/golang-set-new-value-to-object-with-type-mapstringinterface", "title": "golang set new value to object with type map[string]interface{}", "body": "<p>I got json str which i parse like this.</p>\n\n<pre><code>var bdoc interface{}\nbson.UnmarshalJSON([]byte(gjson.Get(*str, \"user\").String()), &amp;bdoc)\n</code></pre>\n\n<p>my bdoc is of type map[string]interface{}. When i want to get key from my map i do it like this:</p>\n\n<pre><code>bdoc.(map[string]interface{})[\"pk\"]\n</code></pre>\n\n<p>But how can i set a new value for that \"pk\" key ? I want to convert that \nbdoc[\"pk\"] = \"1234567\". The new value will not be of type interface but of type string. </p>\n"}, {"tags": ["json", "go", "interface"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1524857567, "post_id": 50069110, "comment_id": 87154697, "body": "<a href=\"https://golang.org/pkg/strconv/#FormatInt\" rel=\"nofollow noreferrer\"><code>strconv.FormatInt</code></a>? Or are you trying to marshal or unmarshal directly as a string?"}, {"owner": {"reputation": 1213, "user_id": 2001856, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/13UBK.jpg?s=128&g=1", "display_name": "Miljan Rakita", "link": "https://stackoverflow.com/users/2001856/miljan-rakita"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1524857701, "post_id": 50069110, "comment_id": 87154766, "body": "@JimB My whole json is in *str. I unmarshall json and get map[string]interface{}."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1524857747, "post_id": 50069110, "comment_id": 87154785, "body": "It&#39;s unclear what you&#39;re asking. Please create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "edited": false, "score": 0, "creation_date": 1524857779, "post_id": 50069110, "comment_id": 87154798, "body": "Would you have strings in your json like &quot;0000012345&quot;?"}, {"owner": {"reputation": 1213, "user_id": 2001856, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/13UBK.jpg?s=128&g=1", "display_name": "Miljan Rakita", "link": "https://stackoverflow.com/users/2001856/miljan-rakita"}, "reply_to_user": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "edited": false, "score": 0, "creation_date": 1524857959, "post_id": 50069110, "comment_id": 87154887, "body": "@Slabgorb It might have like that"}], "answers": [{"comments": [{"owner": {"reputation": 1213, "user_id": 2001856, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/13UBK.jpg?s=128&g=1", "display_name": "Miljan Rakita", "link": "https://stackoverflow.com/users/2001856/miljan-rakita"}, "edited": false, "score": 0, "creation_date": 1524858629, "post_id": 50069374, "comment_id": 87155202, "body": "I dont know what the response will be like, that is why i dont use struct... That is the main problem"}, {"owner": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "reply_to_user": {"reputation": 1213, "user_id": 2001856, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/13UBK.jpg?s=128&g=1", "display_name": "Miljan Rakita", "link": "https://stackoverflow.com/users/2001856/miljan-rakita"}, "edited": false, "score": 0, "creation_date": 1524858759, "post_id": 50069374, "comment_id": 87155265, "body": "As long as the &#39;pk&#39; key is in the top level of the json, this will work regardless of the remaining structure of the json. In other words, you don&#39;t need to unmarshal EVERYTHING at once, you can just unmarshal what you are looking for."}, {"owner": {"reputation": 1213, "user_id": 2001856, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/13UBK.jpg?s=128&g=1", "display_name": "Miljan Rakita", "link": "https://stackoverflow.com/users/2001856/miljan-rakita"}, "edited": false, "score": 0, "creation_date": 1524859002, "post_id": 50069374, "comment_id": 87155354, "body": "i hope this will help you, my json looks like this: <a href=\"https://pastebin.com/JgM347zP\" rel=\"nofollow noreferrer\">pastebin.com/JgM347zP</a> here you can see that pk is of type int and i need to convert it to type string. That is what i am trying to achieve"}, {"owner": {"reputation": 1213, "user_id": 2001856, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/13UBK.jpg?s=128&g=1", "display_name": "Miljan Rakita", "link": "https://stackoverflow.com/users/2001856/miljan-rakita"}, "edited": false, "score": 0, "creation_date": 1524860697, "post_id": 50069374, "comment_id": 87156074, "body": "this will always have only pk. If i try this  fmt.Printf(&quot;%s&quot;, p.PK) output is: {000012345} And there is no rest of the json."}, {"owner": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "reply_to_user": {"reputation": 1213, "user_id": 2001856, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/13UBK.jpg?s=128&g=1", "display_name": "Miljan Rakita", "link": "https://stackoverflow.com/users/2001856/miljan-rakita"}, "edited": false, "score": 0, "creation_date": 1524862893, "post_id": 50069374, "comment_id": 87156994, "body": "Ok, edited answer, including your json. Likely someone else could come up with a more efficient way of working with the unstructured version. I was trying to avoid doing things like using reflect.    I would still recommend not having a <code>map[string]interface{}</code> running through your program, it just makes things very difficult. One thing to improve this a lot is by using the two-return casting to prevent random panics from bad casting."}], "tags": [], "owner": {"reputation": 706, "user_id": 167233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326007182b2b41b557a3f035ff318ce?s=128&d=identicon&r=PG", "display_name": "Slabgorb", "link": "https://stackoverflow.com/users/167233/slabgorb"}, "is_accepted": true, "score": 2, "last_activity_date": 1524862771, "last_edit_date": 1524862771, "creation_date": 1524858566, "answer_id": 50069374, "question_id": 50069110, "link": "https://stackoverflow.com/questions/50069110/golang-convert-json-value-from-int-to-string/50069374#50069374", "title": "Golang convert json value from int to string", "body": "<pre><code>package main\n\nimport (\n    \"encoding/json\"\n\n    \"fmt\"\n    \"strconv\"\n)\n\nvar jsonData = []byte(`\n{\n    \"user\": {\n        \"media_count\": 2043,\n        \"follower_count\": 663,\n        \"following_count\": 1300,\n        \"geo_media_count\": 0,\n        \"is_business\": false,\n        \"usertags_count\": 423,\n        \"has_chaining\": true,\n        \"is_favorite\": false,\n        \"has_highlight_reels\": true,\n        \"include_direct_blacklist_status\": true,\n        \"pk\": 145250410,\n        \"username\": \"karahray\",\n        \"full_name\": \"K Ray \\ud83d\\udd35\",\n        \"has_anonymous_profile_picture\": false,\n        \"is_private\": false,\n        \"is_verified\": false,\n        \"profile_pic_url\": \"\",\n        \"profile_pic_id\": \"1403809308517206571_145250410\",\n        \"biography\": \"Austinite, oncology dietitian, lover of food, coffee, beer, scenic jogs, traveling, Los Spurs, my Yorkies and LAUGHING! Fitness/food @LGFTatx!\",\n        \"external_url\": \"\",\n        \"hd_profile_pic_url_info\": {\n            \"height\": 1080,\n            \"url\": \"\",\n            \"width\": 1080\n        },\n        \"hd_profile_pic_versions\": [{\n            \"height\": 320,\n            \"url\": \"\",\n            \"width\": 320\n        }, {\n            \"height\": 640,\n            \"url\": \"\",\n            \"width\": 640\n        }], \n        \"reel_auto_archive\": \"on\",\n        \"school\": null,\n        \"has_unseen_besties_media\": false,\n        \"auto_expand_chaining\": false\n    },\n    \"status\": \"ok\"\n}`)\n\n\n// custom json unmarshal\ntype pk string\n\nfunc (p *pk) UnmarshalJSON(data []byte) error {\n    var tmp int\n    if err := json.Unmarshal(data, &amp;tmp); err != nil {\n        return err\n    }\n    *p = pk(strconv.Itoa(tmp))\n    return nil\n}\n\ntype jsonModel struct {\n    User struct {\n        PK pk `json:\"pk\"`\n    } `json:\"user\"`\n}\n\nfunc main() {\n    // using the custom json unmarshal\n    jm := &amp;jsonModel{}\n    if err := json.Unmarshal(jsonData, jm); err != nil {\n        panic(err)\n    }\n\n    // doing it as map[string]interface, then finding the key, \n    // then converting - you end up needing TONS of casting \n    everything := map[string]interface{}{}\n    if err := json.Unmarshal(jsonData, &amp;everything); err != nil {\n        panic(err)\n    }\n\n    var userPart interface{}\n    userPart, ok := everything[\"user\"]\n    if !ok {\n        panic(\"could not find user key\")\n    }\n    userPartMap := userPart.(map[string]interface{})\n    var pkInterface interface{}\n\n    if pkInterface, ok = userPartMap[\"pk\"]; !ok {\n        panic(\"could not find pk key\")\n    }\n\n    // note that json is going to 'guess' float64 here, so we \n    // need to do a lot of shenanigans.\n    pkString := strconv.FormatInt(int64(pkInterface.(float64)),10)\n\n    fmt.Printf(\"%s\\n\", jm.User.PK)\n    fmt.Printf(\"%s\\n\", pkString)\n\n\n}\n</code></pre>\n\n<p>Output:</p>\n\n<p>145250410 </p>\n\n<p>145250410</p>\n\n<p><a href=\"https://play.golang.org/p/OfHi0ybHJXE\" rel=\"nofollow noreferrer\">https://play.golang.org/p/OfHi0ybHJXE</a></p>\n"}], "owner": {"reputation": 1213, "user_id": 2001856, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/13UBK.jpg?s=128&g=1", "display_name": "Miljan Rakita", "link": "https://stackoverflow.com/users/2001856/miljan-rakita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2439, "favorite_count": 0, "accepted_answer_id": 50069374, "answer_count": 1, "score": 0, "last_activity_date": 1524862771, "creation_date": 1524857324, "question_id": 50069110, "link": "https://stackoverflow.com/questions/50069110/golang-convert-json-value-from-int-to-string", "title": "Golang convert json value from int to string", "body": "<p>I get json response. Which has key pk and it's value as int. I need to convert it as string, what is the easiest way? Here is the example</p>\n\n<p>\"pk\": 145250410 </p>\n\n<p>and i need it to be</p>\n\n<p>\"pk\": \"145250410\"</p>\n\n<p>I can not make model, and parse it bacause i don't always know what will my json be like, but i know it will always have pk, so this is how i parse it.</p>\n\n<pre><code>var bdoc interface{}\nbson.UnmarshalJSON([]byte(gjson.Get(*str, \"user\").String()), &amp;bdoc)\n</code></pre>\n\n<p>The only problem is that i get pk as int not as string.</p>\n"}]