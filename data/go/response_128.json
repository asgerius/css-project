[{"tags": ["go", "zeromq", "messaging"], "comments": [{"owner": {"reputation": 546, "user_id": 825105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee3243d5877221206602c559938ad66c?s=128&d=identicon&r=PG", "display_name": "colini", "link": "https://stackoverflow.com/users/825105/colini"}, "edited": false, "score": 1, "creation_date": 1498140529, "post_id": 44687426, "comment_id": 76386403, "body": "Instead of removing expired messages from the queue, why not add an &quot;expires-at&quot; property to the message before enqueuing it.  Workers could check this property each time they receive a message and just drop ones that have expired."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 6865003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19f6142d7f4e77bb112ce5eff5afa097?s=128&d=identicon&r=PG&f=1", "display_name": "Riyadh Rahman", "link": "https://stackoverflow.com/users/6865003/riyadh-rahman"}, "edited": false, "score": 2, "creation_date": 1498086397, "post_id": 44687510, "comment_id": 76359192, "body": "This option only keeps the last message, which will potentially drop messages that have not expired yet. In addition, it does not support multi part messages, which I am sending."}, {"owner": {"reputation": 1, "user_id": 3666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fc6c23061326c7e6a6f82a1663634b?s=128&d=identicon&r=PG", "display_name": "user3666197", "link": "https://stackoverflow.com/users/3666197/user3666197"}, "reply_to_user": {"reputation": 63, "user_id": 6865003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19f6142d7f4e77bb112ce5eff5afa097?s=128&d=identicon&r=PG&f=1", "display_name": "Riyadh Rahman", "link": "https://stackoverflow.com/users/6865003/riyadh-rahman"}, "edited": false, "score": 1, "creation_date": 1498122056, "post_id": 44687510, "comment_id": 76372701, "body": "Sure! These were exactly the reasons that made me to copy the API-specifications. And none of these facts is per-se a reason not to use this option, if other conditions are met ( packing payloads into BLOB-s is a common performance motivated practice )."}], "tags": [], "owner": {"reputation": 1, "user_id": 3666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fc6c23061326c7e6a6f82a1663634b?s=128&d=identicon&r=PG", "display_name": "user3666197", "link": "https://stackoverflow.com/users/3666197/user3666197"}, "is_accepted": false, "score": 0, "last_activity_date": 1498085984, "creation_date": 1498085984, "answer_id": 44687510, "question_id": 44687426, "link": "https://stackoverflow.com/questions/44687426/how-to-have-zeromq-to-timeout-messages-that-are-outbound-queued-but-havent-bee/44687510#44687510", "title": "How to have ZeroMQ to timeout messages that are outbound queued, but haven&#39;t been sent within a set time?", "body": "<p>In newer API-versions, there is an option to discard all \"old\" messages and always deliver just the \"newest\" one.</p>\n\n<p>If that meets your expectations, and if all peers meet API v.4.0+, you are done.</p>\n\n<blockquote>\n  <p><strong><code>ZMQ_CONFLATE</code>: Keep only last message</strong><br><br> \n  If set, a socket shall keep only one message in its inbound/outbound queue, this message being the last message received/the last message to be sent. Ignores <code>ZMQ_RCVHWM</code> and <code>ZMQ_SNDHWM</code> options. Does not support multi-part messages, in particular, only one part of it is kept in the socket internal queue.<br>\n  <strong><code>Option value type</code></strong> <code>int</code><br>\n  <strong><code>Option value unit</code></strong> <code>boolean</code><br>\n  <strong><code>Default value</code></strong> <code>0 (false)</code><br>\n  <strong><code>Applicable socket types</code></strong>   <code>ZMQ_PULL</code>, <code>ZMQ_PUSH</code>, <code>ZMQ_SUB</code>, <code>ZMQ_PUB</code>, <code>ZMQ_DEALER</code></p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 6143, "user_id": 2147218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JQVSl.jpg?s=128&g=1", "display_name": "bazza", "link": "https://stackoverflow.com/users/2147218/bazza"}, "is_accepted": false, "score": 1, "last_activity_date": 1498107898, "creation_date": 1498107898, "answer_id": 44690546, "question_id": 44687426, "link": "https://stackoverflow.com/questions/44687426/how-to-have-zeromq-to-timeout-messages-that-are-outbound-queued-but-havent-bee/44690546#44690546", "title": "How to have ZeroMQ to timeout messages that are outbound queued, but haven&#39;t been sent within a set time?", "body": "<p>What you're trying to do is use communication as an execution rendezvous. The sender wants to know something about when the receiver gets messages.</p>\n\n<p>ZMQ implements the Actor model. What you need is a modification of the Communicating Sequential Processes model (one where sends timeout). Basically you need to add control message flows to/from the workers, the idea being that the server asks the worker to receive a message and the server waits for the reply. The reply means that the worker is ready to receive a message right now, and that the server and worker have both rendezvoused at a send/receive in their program flows. If that reply fails to arrive within timeout seconds, then the server doesn't send the actual message. </p>\n\n<p>Or you could cheat by having everything going to the workers regardless, wrapped in a message that carries a \"sent at time X\" field, and have the worker decide to discard old messages.</p>\n"}, {"comments": [{"owner": {"reputation": 11647, "user_id": 507950, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0dabb66f0e0b88d90ccd9d0936e96f0e?s=128&d=identicon&r=PG", "display_name": "dodgy_coder", "link": "https://stackoverflow.com/users/507950/dodgy-coder"}, "edited": false, "score": 0, "creation_date": 1593055640, "post_id": 44960239, "comment_id": 110647157, "body": "For future readers of this, if you&#39;re storing a timestamp in the message content then you really need to ensure that system clocks are synced on both the sender and receiver locations. A safe way of doing this is to not use the system clocks, instead use an independent time source that is accessible at both sender and receiver locations, such as the database server time, which can be fetched quickly with a simple query."}], "tags": [], "owner": {"reputation": 63, "user_id": 6865003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19f6142d7f4e77bb112ce5eff5afa097?s=128&d=identicon&r=PG&f=1", "display_name": "Riyadh Rahman", "link": "https://stackoverflow.com/users/6865003/riyadh-rahman"}, "is_accepted": true, "score": 1, "last_activity_date": 1499382952, "creation_date": 1499382952, "answer_id": 44960239, "question_id": 44687426, "link": "https://stackoverflow.com/questions/44687426/how-to-have-zeromq-to-timeout-messages-that-are-outbound-queued-but-havent-bee/44960239#44960239", "title": "How to have ZeroMQ to timeout messages that are outbound queued, but haven&#39;t been sent within a set time?", "body": "<p>In the end, the solution was to add an expires-at property like @colini and @bazza mentioned, and to drop timed out messages from the queue after each heartbeat. However, doing so and satisfying all requirements of my application was proving to be more difficult than first glance, so I ended up using RabbitMQ, whose ttl-expires argument provided the desired functionality.</p>\n"}], "owner": {"reputation": 63, "user_id": 6865003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19f6142d7f4e77bb112ce5eff5afa097?s=128&d=identicon&r=PG&f=1", "display_name": "Riyadh Rahman", "link": "https://stackoverflow.com/users/6865003/riyadh-rahman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 879, "favorite_count": 1, "accepted_answer_id": 44960239, "answer_count": 3, "score": 5, "last_activity_date": 1499382952, "creation_date": 1498085396, "last_edit_date": 1498856398, "question_id": 44687426, "link": "https://stackoverflow.com/questions/44687426/how-to-have-zeromq-to-timeout-messages-that-are-outbound-queued-but-havent-bee", "title": "How to have ZeroMQ to timeout messages that are outbound queued, but haven&#39;t been sent within a set time?", "body": "<p>I have an application running on a server which takes requests from a phone app and then load balances the request across worker servers. I'm trying to add a timeout in the case that messages on the main server that have been in the outbound queue for the length of the timeout are removed from the queue. More specifically, the application on the main server is written in golang and implements the <a href=\"http://zguide.zeromq.org/php:chapter4#toc5\" rel=\"nofollow noreferrer\">Paranoid Pirate Pattern</a> of load balancing. The code I currently have is:</p>\n\n<pre><code>import (\n    \"fmt\"\n    zmq \"github.com/pebbe/zmq4\"\n    \"time\"\n)\n\nconst (\n    HEARTBEAT_LIVENESS = 3\n    HEARTBEAT_INTERVAL = 1500 * time.Millisecond\n\n    MESSAGE_READY     = \"\\001\"\n    MESSAGE_HEARTBEAT = \"\\002\"\n)\n\nvar (\n    client *zmq.Socket\n    backend *zmq.Socket\n    frontend *zmq.Socket\n    workerPoller *zmq.Poller\n    brokerPoller *zmq.Poller\n    workerQueue []Worker\n)\n\ntype Worker struct {\n    Id string\n    Expire time.Time\n}\n\ntype RequestWrapper {\n    RequestToSend Request\n\n}\n\nfunc NewWorker(id string) Worker {\n    return Worker{\n        Id: id,\n        Expire: time.Now().Add(HEARTBEAT_INTERVAL * HEARTBEAT_LIVENESS),\n    }\n}\n\nfunc AddReadyWorker(workers []Worker, worker Worker) []Worker {\n    fmt.Println(worker.Id, \" joined\")\n    for i, w := range workers {\n        if worker.Id == w.Id {\n            if i == 0 {\n                workers = workers[1:]\n            } else if i == len(workers)-1 {\n                workers = workers[:i]\n            } else {\n                workers = append(workers[:i], workers[i+1:]...)\n            }\n            break\n        }\n    }\n    return append(workers, worker)\n}\n\nfunc PurgeInactiveWorkers() {\n    now := time.Now()\n    for i, worker := range workerQueue {\n        if now.Before(worker.Expire) {\n            workerQueue = workerQueue[i:]\n            return\n        }\n    }\n\n    workerQueue = workerQueue[0:0]\n}\n\nfunc LoadBalance() {\n// Loop:\n    heartbeat := time.Tick(HEARTBEAT_INTERVAL)\n    for {\n        var sockets []zmq.Polled\n\n        // If you have available workers, poll on the both front and backend\n        // If not poll on backend with infinite timeout\n        if len(workerQueue) &gt; 0 {\n            sockets, _ = brokerPoller.Poll(HEARTBEAT_INTERVAL)\n        } else {\n            sockets, _ = workerPoller.Poll(HEARTBEAT_INTERVAL)\n        }\n\n        for _, socket := range sockets {\n            switch socket.Socket {\n                // backend is a router\n                case backend:\n                    workerId, _ := backend.Recv(0)\n                    workerQueue = AddReadyWorker(workerQueue, NewWorker(workerId))\n                    clientId, _ := backend.Recv(0)\n                    if clientId != MESSAGE_READY &amp;&amp; clientId != MESSAGE_HEARTBEAT {\n                        route, _ := backend.Recv(0)\n                        message, _ := backend.RecvBytes(0)\n\n                        fmt.Println(\"Received response\")\n                        RouteResponse(route, message)\n\n                        // frontend.Send(clientId, zmq.SNDMORE)\n                        // frontend.Send(\"\", zmq.SNDMORE)\n                        // frontend.SendBytes(message, 0)\n                    }\n                // frontend is a dealer\n                case frontend:\n                    clientId, _ := frontend.Recv(0)\n                    route, _ := frontend.Recv(0)\n                    message, _ := frontend.RecvBytes(0)\n\n                    backend.Send(workerQueue[0].Id, zmq.SNDMORE)\n                    backend.Send(clientId, zmq.SNDMORE)\n                    backend.Send(route, zmq.SNDMORE)\n                    backend.SendBytes(message, 0)\n\n                    workerQueue = workerQueue[1:]\n            }\n        }\n\n        select {\n            case &lt;-heartbeat:\n                for _, worker := range workerQueue {\n                    backend.Send(worker.Id, zmq.SNDMORE)\n                    backend.Send(MESSAGE_HEARTBEAT, 0)\n                }\n                break\n            default:\n        }\n\n        PurgeInactiveWorkers()\n    }\n}\n</code></pre>\n\n<p>If the backend sends a message, but it is not actually sent to a worker in some period of time, I want it to expire and not ever be sent. <strong>Is there a socket option that can accomplish this? If not, what would I have to do to accomplish this?</strong></p>\n\n<p>Two ways I think I can do this without socket options are:</p>\n\n<p>1) Have the backend wrap the message in a wrapper and send to a golang queue and not through zeromq. The wrapper contains the time that the message was \"sent\". The backend concurrently pulls from the front of the golang queue one at a time and checks if the message is expired. If so, don't send, if not, send the message. I could have the backend add the message to the golang queue first and then truly send it out after in the same block of code. That way, I don't need a lock.</p>\n\n<p>2) Send the wrapper message through zeromq to a retriever and the retriever checks if its expired and returns early. I don't like this because it seems like its bad for performance.</p>\n"}, {"tags": ["testing", "go", "compilation"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498075872, "post_id": 44685206, "comment_id": 76354990, "body": "What binary are you referring to? If you&#39;re not building a test binary, you&#39;re not compiling <code>*_test.go</code> files, so they&#39;re not just eliminated during linking, they&#39;re never compiled at all."}, {"owner": {"reputation": 2437, "user_id": 4102515, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31b3a2bfa392f631bc24a7c1dce899b9?s=128&d=identicon&r=PG", "display_name": "snorberhuis", "link": "https://stackoverflow.com/users/4102515/snorberhuis"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498079182, "post_id": 44685206, "comment_id": 76356608, "body": "I hopefully clarified the question"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498079263, "post_id": 44685206, "comment_id": 76356648, "body": "<code>*_test.go</code> files are only included by the <code>go test</code> command, in the named package. They are never even <i>seen</i> by the compiler otherwise."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498079398, "post_id": 44685206, "comment_id": 76356709, "body": "BTW, you can&#39;t compile a binary with <code>go build .&#47;...</code>, that is building all the packages included in the wildcard, then discarding all the compiled objects."}], "answers": [{"comments": [{"owner": {"reputation": 1260, "user_id": 695459, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8766f0303f842207f52c2789896a7214?s=128&d=identicon&r=PG", "display_name": "mikijov", "link": "https://stackoverflow.com/users/695459/mikijov"}, "edited": false, "score": 2, "creation_date": 1517172167, "post_id": 44685274, "comment_id": 83975207, "body": "Interesting edge case is when using helper functions for testing. These helpers can import additional packages. It might make significant difference to size of prod vs testing code when you have test only dependencies. I agree, Go should eliminate all dead code. But it would be nice to be explicit about this rather then rely on magic."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 8, "last_activity_date": 1498075223, "creation_date": 1498075223, "answer_id": 44685274, "question_id": 44685206, "link": "https://stackoverflow.com/questions/44685206/will-go-test-code-only-referenced-in-test-files-be-compiled-into-the-binary/44685274#44685274", "title": "Will go test code only referenced in test files be compiled into the binary?", "body": "<p>A go binary only includes code reachable from its <code>main()</code> entry point. For test binaries <code>main()</code> is the test runner.</p>\n\n<p>As to \"how much of a problem\" it is if it were included... none. It would increase the binary size and compilation time somewhat but otherwise have no impact - code that isn't executed, by definition, does nothing.</p>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 3014416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52a40aaf51ae7f0550504afa50860876?s=128&d=identicon&r=PG&f=1", "display_name": "user3014416", "link": "https://stackoverflow.com/users/3014416/user3014416"}, "is_accepted": false, "score": 3, "last_activity_date": 1574809177, "creation_date": 1574809177, "answer_id": 59060637, "question_id": 44685206, "link": "https://stackoverflow.com/questions/44685206/will-go-test-code-only-referenced-in-test-files-be-compiled-into-the-binary/59060637#59060637", "title": "Will go test code only referenced in test files be compiled into the binary?", "body": "<p>I believe that if you have an init() function in an otherwise unreachable file, it will still be linked into the executable.</p>\n\n<p>_test.go files would be still excluded.</p>\n\n<p>This bit us when we had some test helper code that was not in _test files. One had an init() function which ran on the executable startup.</p>\n"}], "owner": {"reputation": 2437, "user_id": 4102515, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31b3a2bfa392f631bc24a7c1dce899b9?s=128&d=identicon&r=PG", "display_name": "snorberhuis", "link": "https://stackoverflow.com/users/4102515/snorberhuis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2355, "favorite_count": 1, "accepted_answer_id": 44685274, "answer_count": 2, "score": 8, "last_activity_date": 1574809177, "creation_date": 1498074972, "last_edit_date": 1550373402, "question_id": 44685206, "link": "https://stackoverflow.com/questions/44685206/will-go-test-code-only-referenced-in-test-files-be-compiled-into-the-binary", "title": "Will go test code only referenced in test files be compiled into the binary?", "body": "<p>I am wondering what code will be compiled into the go binary if you compile a binary using <code>go build ./...</code> . This will compile a binary that has a cli program. For this cli program, I have test code and non test code. I currently have several flavours of test code:</p>\n\n<ul>\n<li><code>foo_test.go</code> in package <code>foo_test</code></li>\n<li><code>foo_internal_test.go</code> in package <code>foo</code></li>\n<li><code>testutil.go</code> in package <code>testutil</code> that provides test utility functions</li>\n</ul>\n\n<p>No test code is actually referenced in the non test code. The testutil functions are only imported in the test files. </p>\n\n<p>If the test code is infact compiled into the binary , how much of a problem is this?</p>\n"}, {"tags": ["go", "mux", "negroni"], "answers": [{"comments": [{"owner": {"reputation": 508, "user_id": 552391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b9cfd9892a765221fe557768987b42d?s=128&d=identicon&r=PG", "display_name": "Matias", "link": "https://stackoverflow.com/users/552391/matias"}, "edited": false, "score": 0, "creation_date": 1498077858, "post_id": 44685647, "comment_id": 76355939, "body": "That works, thanks. I wanted to use the middlewares available at Gorilla package handlers."}, {"owner": {"reputation": 508, "user_id": 552391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b9cfd9892a765221fe557768987b42d?s=128&d=identicon&r=PG", "display_name": "Matias", "link": "https://stackoverflow.com/users/552391/matias"}, "edited": false, "score": 0, "creation_date": 1498078366, "post_id": 44685647, "comment_id": 76356211, "body": "Then, I was able to use Gorilla handler doing:      <code>router.PathPrefix(&quot;&#47;admin&quot;).Handler(negroni.New(  \tnegroni.Wrap(handlers.CombinedLoggingHandler(os.Stdout, adminBase)),  \t))     </code>"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 508, "user_id": 552391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b9cfd9892a765221fe557768987b42d?s=128&d=identicon&r=PG", "display_name": "Matias", "link": "https://stackoverflow.com/users/552391/matias"}, "edited": false, "score": 0, "creation_date": 1498078494, "post_id": 44685647, "comment_id": 76356281, "body": "Yes you can use it, just to demonstrate sub router definition I didn&#39;t use it in the example. Sorry about that."}, {"owner": {"reputation": 748, "user_id": 5289157, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh3.googleusercontent.com/-KVN5tChB2OQ/AAAAAAAAAAI/AAAAAAAABRk/FEKK6XOtwnI/photo.jpg?sz=128", "display_name": "Greg Miller", "link": "https://stackoverflow.com/users/5289157/greg-miller"}, "edited": false, "score": 0, "creation_date": 1536777391, "post_id": 44685647, "comment_id": 91550769, "body": "Used the exact code on a subrouter as the base. Handler function doesn&#39;t get called."}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 2, "last_activity_date": 1498076673, "creation_date": 1498076673, "answer_id": 44685647, "question_id": 44684788, "link": "https://stackoverflow.com/questions/44684788/subroutes-middlewares-with-gorilla-mux-and-negroni/44685647#44685647", "title": "Subroutes middlewares with Gorilla MUX and Negroni", "body": "<p>Issue is the way you create an sub routes <code>/admin</code>. Complete reference code is here <a href=\"https://play.golang.org/p/zb_79oHJed\" rel=\"nofollow noreferrer\">https://play.golang.org/p/zb_79oHJed</a></p>\n\n<pre><code>// Admin\nadminBase := mux.NewRouter()\nrouter.PathPrefix(\"/admin\").Handler(negroni.New(\n    // This logger only applicable to /admin routes\n    negroni.HandlerFunc(justTestLogger),\n    // add your handlers here which is only appilcable to `/admin` routes\n    negroni.Wrap(adminBase),\n))\n\nadminRoutes := adminBase.PathPrefix(\"/admin\").Subrouter()\nadminRoutes.HandleFunc(\"/articles/new\", articleNewHandler).Methods(\"GET\")\n</code></pre>\n\n<p>Now, access these URLs. You will see logs only for <code>/admin</code> sub routes.</p>\n"}], "owner": {"reputation": 508, "user_id": 552391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b9cfd9892a765221fe557768987b42d?s=128&d=identicon&r=PG", "display_name": "Matias", "link": "https://stackoverflow.com/users/552391/matias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1929, "favorite_count": 1, "accepted_answer_id": 44685647, "answer_count": 1, "score": 0, "last_activity_date": 1498076673, "creation_date": 1498073509, "question_id": 44684788, "link": "https://stackoverflow.com/questions/44684788/subroutes-middlewares-with-gorilla-mux-and-negroni", "title": "Subroutes middlewares with Gorilla MUX and Negroni", "body": "<p>I'm trying to add a middleware only on some routes. I wrote this code:</p>\n\n<pre><code>func main() {\n  router := mux.NewRouter().StrictSlash(false)\n\n  admin_subrouter := router.PathPrefix(\"/admin\").Subrouter()\n\n  //handlers.CombinedLoggingHandler comes from gorilla/handlers\n  router.PathPrefix(\"/admin\").Handler(negroni.New(\n    negroni.Wrap(handlers.CombinedLoggingHandler(os.Stdout, admin_subrouter)),\n  ))\n\n  admin_subrouter.HandleFunc(\"/articles/new\", articles_new).Methods(\"GET\")\n  admin_subrouter.HandleFunc(\"/articles\", articles_index).Methods(\"GET\")\n  admin_subrouter.HandleFunc(\"/articles\", articles_create).Methods(\"POST\")\n\n  n := negroni.New()\n  n.UseHandler(router)\n  http.ListenAndServe(\":3000\", n)\n</code></pre>\n\n<p>}</p>\n\n<p>I expect to see request logs only for paths with prefix /admin. I do see a log line when I do \"GET /admin\", but not when I do \"GET /admin/articles/new\". I tried by brute force other combinations but I can't get it. What's wrong with my code? </p>\n\n<p>I saw other ways, like wrapping the HandlerFunc on each route definition, but I wanted to do it once for a prefix or a subrouter.</p>\n\n<p>The logging middleware I'm using there is for testing, maybe an Auth middleware makes more sense, but I just wanted to make it work.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["windows", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1498054413, "post_id": 44678216, "comment_id": 76341259, "body": "Why is <code>echo</code> in a goroutine?  You&#39;re calling <code>defer conn.Close()</code> in a loop, which doesn&#39;t do anything since you don&#39;t ever return. You&#39;re wrapping the conn with a new <code>bufio.Reader</code> every call, possibly losing buffered data. You&#39;re not checking any Write errors, nor are you closing the connection after a Read error."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1498057139, "post_id": 44678216, "comment_id": 76343592, "body": "first thought: ioutil.ReadAll again"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1498075523, "post_id": 44678216, "comment_id": 76354787, "body": "The actual error is because you&#39;re calling Read from an unbounded number of goroutines. The net package assumes there&#39;s no reason to ever have more than <code>1&lt;&lt;20</code> concurrent operations on a net.Conn."}, {"owner": {"reputation": 90, "user_id": 7459528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7877f3118b300a2fd1bf45544ffbcc60?s=128&d=identicon&r=PG&f=1", "display_name": "fcFn", "link": "https://stackoverflow.com/users/7459528/fcfn"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498121020, "post_id": 44678216, "comment_id": 76371917, "body": "@JimB, thanks for pointing out all the other errors in my code, as well as giving the reason for the fdMutex error (<code>echo</code> shouldn&#39;t be a goroutine, and in an endless loop with no exit to boot, if I understand correctly). I&#39;m still new to Go, that&#39;s why the code is so bad. If hope you won&#39;t mind if I update my answer with your last comment and mark it as accepted."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1498135435, "post_id": 44678217, "comment_id": 76382338, "body": "Your loop happens from the moment the client connects, not when it closes, and continues to start more goroutines until you run into a fatal error. Print out something at the start of every <code>echo</code> to see what&#39;s happening. Reading  a zero length slice isn&#39;t guaranteed to do anything, you need to handle the error where you are actually reading the data."}, {"owner": {"reputation": 90, "user_id": 7459528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7877f3118b300a2fd1bf45544ffbcc60?s=128&d=identicon&r=PG&f=1", "display_name": "fcFn", "link": "https://stackoverflow.com/users/7459528/fcfn"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498137742, "post_id": 44678217, "comment_id": 76384119, "body": "Yes, I understand that and I corrected my code accordingly. <code>echo</code> returns an error now, which breaks the loop in the <code>handleConnection</code> and closes the connection. (I&#39;m not sure if I should do anything with the code in the answer or the question, will it help anyone?)."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498138168, "post_id": 44678217, "comment_id": 76384465, "body": "OK, then I would just remove the misleading code from he answer."}], "tags": [], "owner": {"reputation": 90, "user_id": 7459528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7877f3118b300a2fd1bf45544ffbcc60?s=128&d=identicon&r=PG&f=1", "display_name": "fcFn", "link": "https://stackoverflow.com/users/7459528/fcfn"}, "is_accepted": true, "score": 1, "last_activity_date": 1498139156, "last_edit_date": 1498139156, "creation_date": 1498053447, "answer_id": 44678217, "question_id": 44678216, "link": "https://stackoverflow.com/questions/44678216/panic-net-inconsistent-fdmutex/44678217#44678217", "title": "panic: net: inconsistent fdMutex", "body": "<p>Thanks to @JimB, I understand the nature of the problem better. Here's what he said:</p>\n\n<blockquote>\n  <p>The actual error is because you're calling Read from an unbounded number of goroutines. The net package assumes there's no reason to ever have more than 1&lt;&lt;20 concurrent operations on a net.Conn. \u2013 JimB</p>\n</blockquote>\n\n<hr>\n\n<p>Some bad code was here, which wasn't quite a fix for the problem at hand. I removed it so it won't mislead anyone, as advised by JimB. </p>\n\n<p>What I learned from JimB:</p>\n\n<ol>\n<li>You shouldn't use goroutines unless it is necessary (<code>echo</code> function shouldn't be a goroutine, as reading is a blocking operation, and we can't really do anything with the connection until we understand what the client is sending to us, so no concurrency is needed; <code>handleConnection</code>, on the other hand, is run inside a goroutine because it's supposed to handle multiple connections simultaneously).</li>\n<li>Errors are precious things, handle them gracefully, do not ignore them.</li>\n</ol>\n"}], "owner": {"reputation": 90, "user_id": 7459528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7877f3118b300a2fd1bf45544ffbcc60?s=128&d=identicon&r=PG&f=1", "display_name": "fcFn", "link": "https://stackoverflow.com/users/7459528/fcfn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 44678217, "answer_count": 1, "score": 1, "last_activity_date": 1498139156, "creation_date": 1498053447, "question_id": 44678216, "link": "https://stackoverflow.com/questions/44678216/panic-net-inconsistent-fdmutex", "title": "panic: net: inconsistent fdMutex", "body": "<p>I'm trying to implement a simple echo server in Go (go1.8.3 windows/amd64) on Windows 10, but I have this weird panic happening some time after getting a connection from a client (connecting with ncat). I can send and receive messages, but it will crash after a while no matter what I do, and I don't know why.</p>\n\n<p>The code is</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"log\"\n    \"net\"\n)\n\nfunc echo(conn net.Conn, c chan int) {\n    c &lt;- 1\n    reader := bufio.NewReader(conn)\n    msg, err := reader.ReadBytes('\\n')\n    if err != nil {\n        log.Printf(\"error reading from the reader: %v\", err)\n        return\n    }\n    conn.Write(msg)\n}\n\nfunc handleConnection(conn net.Conn) {\n    log.Print(\"Got connection from: \", conn.RemoteAddr())\n    conn.Write([]byte(\"Hello, this is a Go echo server\\n\"))\n    c := make(chan int)\n    for {\n        go echo(conn, c)\n        &lt;-c\n    }\n}\n\nfunc main() {\n    listener, err := net.Listen(\"tcp\", \"127.0.0.1:3000\")\n    if err != nil {\n        log.Fatalf(\"couldn't create a tcp server: %v\", err)\n    }\n    for {\n        conn, err := listener.Accept()\n        defer conn.Close()\n        if err != nil {\n            log.Printf(\"couldn't create a connection: %v\", err)\n            return\n        }\n        go handleConnection(conn)\n    }\n}\n</code></pre>\n\n<p>The error is</p>\n\n<pre><code>panic: net: inconsistent fdMutex\n\ngoroutine 1048589 [running]:\nnet.(*fdMutex).rwlock(0xc0420741c0, 0x1, 0x0)\n    C:/Go/src/net/fd_mutex.go:145 +0x1ab\nnet.(*netFD).readLock(0xc0420741c0, 0x0, 0x0)\n    C:/Go/src/net/fd_mutex.go:218 +0x39\nnet.(*netFD).Read(0xc0420741c0, 0xc365329000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n    C:/Go/src/net/fd_windows.go:444 +0x5d\nnet.(*conn).Read(0xc04205e030, 0xc365329000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n    C:/Go/src/net/net.go:181 +0x77\nbufio.(*Reader).fill(0xc36532bf08)\n    C:/Go/src/bufio/bufio.go:97 +0x11e\nbufio.(*Reader).ReadSlice(0xc36532bf08, 0xc36532be0a, 0xc36532be00, 0x0,         0x100000000000000, 0x0, 0x1000)\n    C:/Go/src/bufio/bufio.go:338 +0xc2\nbufio.(*Reader).ReadBytes(0xc36532bf08, 0x100a, 0x1000, 0xc365329000,     0x1000, 0x1000, 0x0)\n    C:/Go/src/bufio/bufio.go:416 +0x6d\nmain.echo(0x574ce0, 0xc04205e030, 0xc042098d80)\n    C:/Users/fcfn/goecho/server.go:13 +0x10b\ncreated by main.handleConnection\n    C:/Users/fcfn/goecho/server.go:27 +0x271\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1498050071, "post_id": 44676895, "comment_id": 76337786, "body": "If you don&#39;t want to close the connection, don&#39;t return from the handler. The handler is what &quot;handles&quot; the connection."}, {"owner": {"reputation": 11213, "user_id": 103999, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/231742e13810156987b1e462314f8eb9?s=128&d=identicon&r=PG", "display_name": "Lee Armstrong", "link": "https://stackoverflow.com/users/103999/lee-armstrong"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498050148, "post_id": 44676895, "comment_id": 76337843, "body": "Right, so it&#39;s getting to the end of function and returning and so closing the connection.  What would be the best way to &quot;block&quot; the function and being able to write to w from another goroutine?"}, {"owner": {"reputation": 1290, "user_id": 2483507, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eIUqf.jpg?s=128&g=1", "display_name": "Joffutt4", "link": "https://stackoverflow.com/users/2483507/joffutt4"}, "edited": false, "score": 0, "creation_date": 1498050266, "post_id": 44676895, "comment_id": 76337941, "body": "you could try putting it into an infinite for loop that has select statements that way you can catch any errors that occur to close down any faulty connections"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1498050318, "post_id": 44676895, "comment_id": 76338001, "body": "The same way you block in any function. You need to coordinate with the other goroutine, pass it the ResponseWriter, then wait for it to complete. If you have goroutines running for this, you must already have some sort of pattern for dispatching and waiting for them."}, {"owner": {"reputation": 11213, "user_id": 103999, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/231742e13810156987b1e462314f8eb9?s=128&d=identicon&r=PG", "display_name": "Lee Armstrong", "link": "https://stackoverflow.com/users/103999/lee-armstrong"}, "edited": false, "score": 0, "creation_date": 1498050367, "post_id": 44676895, "comment_id": 76338066, "body": "Ok, that makes sense, and each new HTTP connection spins up a goroutine too?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1498050794, "post_id": 44676895, "comment_id": 76338408, "body": "Yes, each connection handler is in it&#39;s own goroutine; goroutines are how Go handles concurrency."}], "answers": [{"comments": [{"owner": {"reputation": 11213, "user_id": 103999, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/231742e13810156987b1e462314f8eb9?s=128&d=identicon&r=PG", "display_name": "Lee Armstrong", "link": "https://stackoverflow.com/users/103999/lee-armstrong"}, "edited": false, "score": 0, "creation_date": 1498072835, "post_id": 44683482, "comment_id": 76353280, "body": "Thanks. It&#39;s similar to what I ended up with in the end. What I am trying to work out is what happens if the client disconnects during the longOperation"}, {"owner": {"reputation": 887, "user_id": 8099995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WLnoV.png?s=128&g=1", "display_name": "berserkk", "link": "https://stackoverflow.com/users/8099995/berserkk"}, "reply_to_user": {"reputation": 11213, "user_id": 103999, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/231742e13810156987b1e462314f8eb9?s=128&d=identicon&r=PG", "display_name": "Lee Armstrong", "link": "https://stackoverflow.com/users/103999/lee-armstrong"}, "edited": false, "score": 1, "creation_date": 1498073313, "post_id": 44683482, "comment_id": 76353558, "body": "Check <code>CloseNotifier</code> <a href=\"https://golang.org/pkg/net/http/#CloseNotifier\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/#CloseNotifier</a> and <code>context</code> package <a href=\"https://blog.golang.org/context\" rel=\"nofollow noreferrer\">blog.golang.org/context</a>"}, {"owner": {"reputation": 887, "user_id": 8099995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WLnoV.png?s=128&g=1", "display_name": "berserkk", "link": "https://stackoverflow.com/users/8099995/berserkk"}, "reply_to_user": {"reputation": 11213, "user_id": 103999, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/231742e13810156987b1e462314f8eb9?s=128&d=identicon&r=PG", "display_name": "Lee Armstrong", "link": "https://stackoverflow.com/users/103999/lee-armstrong"}, "edited": false, "score": 1, "creation_date": 1498080004, "post_id": 44683482, "comment_id": 76356979, "body": "I&#39;ve updated my answer a little bit to make it more full."}, {"owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 1, "creation_date": 1498091164, "post_id": 44683482, "comment_id": 76360360, "body": "WebSockets is the modern alternative to long polling ... connection remains open so traffic may be sent from either client or server side on the opened websocket"}, {"owner": {"reputation": 11213, "user_id": 103999, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/231742e13810156987b1e462314f8eb9?s=128&d=identicon&r=PG", "display_name": "Lee Armstrong", "link": "https://stackoverflow.com/users/103999/lee-armstrong"}, "edited": false, "score": 0, "creation_date": 1498115547, "post_id": 44683482, "comment_id": 76368269, "body": "@berserkk nice, the use of context I hadn&#39;t considered but that tidies it up very nicely!"}], "tags": [], "owner": {"reputation": 887, "user_id": 8099995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WLnoV.png?s=128&g=1", "display_name": "berserkk", "link": "https://stackoverflow.com/users/8099995/berserkk"}, "is_accepted": true, "score": 7, "last_activity_date": 1539816237, "last_edit_date": 1539816237, "creation_date": 1498069229, "answer_id": 44683482, "question_id": 44676895, "link": "https://stackoverflow.com/questions/44676895/golang-http-server-wait-for-data-to-send-to-client/44683482#44683482", "title": "Golang HTTP server wait for data to send to client", "body": "<p>When you want to send HTTP response to client not immediately but after some event, it's called <a href=\"https://en.wikipedia.org/wiki/Push_technology#Long_polling\" rel=\"nofollow noreferrer\">long polling</a>.</p>\n\n<p>Here's simple example of long polling with request cancellation on client disconnect:</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"net/http\"\n    \"time\"\n)\n\nfunc longOperation(ctx context.Context, ch chan&lt;- string) {\n    // Simulate long operation.\n    // Change it to more than 10 seconds to get server timeout.\n    select {\n    case &lt;-time.After(time.Second * 3):\n        ch &lt;- \"Successful result.\"\n    case &lt;-ctx.Done():\n        close(ch)\n    }\n}\n\nfunc handler(w http.ResponseWriter, _ *http.Request) {\n    notifier, ok := w.(http.CloseNotifier)\n    if !ok {\n        panic(\"Expected http.ResponseWriter to be an http.CloseNotifier\")\n    }\n\n    ctx, cancel := context.WithCancel(context.Background())\n    ch := make(chan string)\n    go longOperation(ctx, ch)\n\n    select {\n    case result := &lt;-ch:\n        fmt.Fprint(w, result)\n        cancel()\n        return\n    case &lt;-time.After(time.Second * 10):\n        fmt.Fprint(w, \"Server is busy.\")\n    case &lt;-notifier.CloseNotify():\n        fmt.Println(\"Client has disconnected.\")\n    }\n    cancel()\n    &lt;-ch\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    http.ListenAndServe(\"localhost:8080\", nil)\n}\n</code></pre>\n\n<p>URLs:</p>\n\n<ol>\n<li><a href=\"https://stackoverflow.com/questions/20793568/golang-anonymous-struct-and-empty-struct\">Golang : anonymous struct and empty struct</a>.</li>\n<li><a href=\"https://stackoverflow.com/questions/26769626/send-a-chunked-http-response-from-a-go-server\">Send a chunked HTTP response from a Go server</a>.</li>\n<li><a href=\"https://blog.golang.org/context\" rel=\"nofollow noreferrer\">Go Concurrency Patterns: Context</a>.</li>\n</ol>\n\n<p>Gists:</p>\n\n<ol>\n<li><a href=\"https://gist.github.com/berserkk/d95bedf12a01b9fc3b5677f41ab9b548\" rel=\"nofollow noreferrer\">Golang long polling example</a>.</li>\n<li><a href=\"https://gist.github.com/berserkk/38e4ec28a57d3645a80be88cbffc5b84\" rel=\"nofollow noreferrer\">Golang long polling example with request cancellation</a>.</li>\n</ol>\n"}], "owner": {"reputation": 11213, "user_id": 103999, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/231742e13810156987b1e462314f8eb9?s=128&d=identicon&r=PG", "display_name": "Lee Armstrong", "link": "https://stackoverflow.com/users/103999/lee-armstrong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6327, "favorite_count": 2, "accepted_answer_id": 44683482, "answer_count": 1, "score": 4, "last_activity_date": 1539816237, "creation_date": 1498050007, "question_id": 44676895, "link": "https://stackoverflow.com/questions/44676895/golang-http-server-wait-for-data-to-send-to-client", "title": "Golang HTTP server wait for data to send to client", "body": "<p>I am creating a streaming API similar to the Twitter firehose/streaming API.</p>\n\n<p>As far as I can gather this is based on HTTP connections that are kept open and when the backend gets data it then writes to the chucked HTTP connection.  It seems that any code I write closes the HTTP connection as soon as anything connects.</p>\n\n<p>Is there a way to keep this open at all?</p>\n\n<pre><code>func startHTTP(pathPrefix string) {\n    log.Println(\"Starting HTTPS Server\")\n    http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n        // Wait here until a write happens to w\n        // Or we timeout, we can reset this timeout after each write\n    })\n\n    log.Print(\"HTTPS listening on :5556\")\n    log.Fatal(http.ListenAndServeTLS(\":5556\", pathPrefix+\".crt\", pathPrefix+\".key\", nil))\n}\n</code></pre>\n"}, {"tags": ["dictionary", "go", "struct", "type-conversion"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1498048715, "post_id": 44676050, "comment_id": 76336716, "body": "Why are you renaming types from other packages within your package? That&#39;s usually not something you want to do."}, {"owner": {"reputation": 435, "user_id": 2403526, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/yaicz.jpg?s=128&g=1", "display_name": "abrarisme", "link": "https://stackoverflow.com/users/2403526/abrarisme"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498049244, "post_id": 44676050, "comment_id": 76337100, "body": "I want to add additional methods to those types, and it seems that I can either use aliases or embedding. The alias within my package will not be exported."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1498049434, "post_id": 44676050, "comment_id": 76337257, "body": "Type &quot;aliases&quot; don&#39;t exist yet (coming in go1.9), and renaming a type creates an entirely new type with a new method set. You almost always want to use embedding to add to the method set."}, {"owner": {"reputation": 435, "user_id": 2403526, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/yaicz.jpg?s=128&g=1", "display_name": "abrarisme", "link": "https://stackoverflow.com/users/2403526/abrarisme"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498050387, "post_id": 44676050, "comment_id": 76338087, "body": "Yup in this case I do want a new type with a new method set. I saw this page earlier: <a href=\"https://stackoverflow.com/questions/28800672/how-to-add-new-methods-to-an-existing-type-in-go\" title=\"how to add new methods to an existing type in go\">stackoverflow.com/questions/28800672/&hellip;</a>  . But I think I&#39;m seeing that what I want to do isn&#39;t possible because of the static typing of Go (using reflect to convert interface to struct)"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1498051383, "post_id": 44676050, "comment_id": 76338873, "body": "I have to agree that there is some design flaw here, but I can&#39;t say what specifically without more context. It seems like you may have painted yourself into a corner architecturally. This looks like a potential <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>."}], "owner": {"reputation": 435, "user_id": 2403526, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/yaicz.jpg?s=128&g=1", "display_name": "abrarisme", "link": "https://stackoverflow.com/users/2403526/abrarisme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498047829, "creation_date": 1498047829, "question_id": 44676050, "link": "https://stackoverflow.com/questions/44676050/is-there-a-way-to-convert-structs-in-different-packages-in-go-using-maps-and-int", "title": "Is there a way to convert structs in different packages in Go using maps and interfaces?", "body": "<p>I want to convert some struct types between different packages and then operate on the structs that are in my package without using <code>if/else</code> or <code>switch</code> statements. Is that possible to do using just <code>maps</code> and <code>interfaces</code>? I have some ideas in place for how I can do this.</p>\n\n<h3>Package Other</h3>\n\n<pre><code>type Update interface{}\n\ntype FirstUpdate struct {\n    x int\n    y int\n}\n\ntype SecondUpdate struct {\n    z string\n}\n\n// these methods return different implementations of Update structs\nFirstRequestConverter(events []string, topic string) Update\nSecondRequestConverter(events []string, topic string) Update\n</code></pre>\n\n<h3>Package Mine</h3>\n\n<pre><code>type ConversionFunction func([]string, string) other.Update\n\ntype FirstUpdateConverted other.FirstUpdate\ntype SecondUpdateConverted other.SecondUpdate\n\ntype ServiceCaller interface {\n    // includes relevant methods\n}    \n\ntopicsMap := map[string]ConversionFunction{\n    \"first_topic\": other.FirstRequestConverter,\n    \"second_topic\": other.SecondRequestConverter,\n}\n\nconversionFunction = topicsMap[topic]\n// need to convert other package types to alias types\n...\nupdateConverted.callService()\n</code></pre>\n\n<p>Here, my map from <code>string</code> to <code>ConversionFunction</code> lets me pick the conversion function I want to use at runtime. And if both <code>FirstUpdateConverted</code> and <code>SecondUpdateConverted</code> implement the <code>ServiceCaller</code> interface, I can choose how the converted structure is handled at runtime too. </p>\n\n<p>In order to convert from <code>FirstUpdate</code> to <code>FirstUpdateConverted</code> (or any of the other alias types), however, I need to use a <code>switch</code> and convert manually. </p>\n\n<p>Is there another way to do the struct conversion step?</p>\n"}, {"tags": ["go", "redis", "redigo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1498049188, "post_id": 44675948, "comment_id": 76337059, "body": "You&#39;re probably flooding the system with connection attempts. You need to implement some sort of circuit breaker to back off while the server is down. Also 9000 max connections seems way too high (since a redis server can only service one request at a time), plus that mean you could be quickly exhausting ephemeral ports when the server stops responding."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1498049601, "post_id": 44675948, "comment_id": 76337401, "body": "Separate from the latency issue, you should <code>conn := state.GetRedisConn(); defer conn.Close()</code>.  The pool always returns a connection that connection must be closed."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1498942538, "creation_date": 1498942538, "answer_id": 44865332, "question_id": 44675948, "link": "https://stackoverflow.com/questions/44675948/redigo-fail-fast-when-redis-server-is-down/44865332#44865332", "title": "Redigo: Fail fast when redis server is down", "body": "<p>Rate limit dial attempts after a failure:</p>\n\n<pre><code>func main() {\n    var (\n       nextDial time.Time\n       mu sync.Mutex\n    )\n    state.redisPool = &amp;redis.Pool{\n        MaxIdle:     200,\n        MaxActive:   9000,\n        IdleTimeout: time.Minute,\n        Dial: func() (redis.Conn, error) {\n            mu.Lock()   // Dial can be called concurrently\n            defer mu.Unlock()\n            if time.Now().Before(nextDial) {\n               return nil, errors.New(\"waiting for dial\")\n            }\n            c, err := redis.Dial(\"tcp\", *redisAddress,\n                redis.DialConnectTimeout(1*time.Second),\n                redis.DialReadTimeout(100*time.Millisecond),\n                redis.DialWriteTimeout(100*time.Millisecond),\n            )\n            if err == nil {\n               nextDial = time.Time{}\n            } else {\n               nextDial = time.Now().Add(time.Second) // don't attempt dial for one second\n            }\n            return c, err\n        },\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7005726, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hKpvtXR2jMU/AAAAAAAAAAI/AAAAAAAALeI/6mWtHhwGoMY/photo.jpg?sz=128", "display_name": "Calvin Brizzi", "link": "https://stackoverflow.com/users/7005726/calvin-brizzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1092, "favorite_count": 1, "accepted_answer_id": 44865332, "answer_count": 1, "score": 1, "last_activity_date": 1499157888, "creation_date": 1498047584, "last_edit_date": 1499157888, "question_id": 44675948, "link": "https://stackoverflow.com/questions/44675948/redigo-fail-fast-when-redis-server-is-down", "title": "Redigo: Fail fast when redis server is down", "body": "<p>I'm struggling with getting go to fail fast when the redis server I'm connected to goes down, want to have a robust solution.</p>\n\n<p>I'm using <a href=\"https://github.com/garyburd/redigo\" rel=\"nofollow noreferrer\">redigo</a> and I'm setting up a connection pool like so:</p>\n\n<pre><code>// This has other stuff in it in the code, use it as a \n// central repository for things we want in memory\ntype State struct{\n    redisPool *redis.Pool\n}\n\nfunc (state *State) GetRedisConn() redis.Conn {\n    return state.redisPool.Get()\n}\n\nfunc main() {\n    state.redisPool = &amp;redis.Pool{\n        MaxIdle:     200,\n        MaxActive:   9000,\n        IdleTimeout: time.Minute,\n        Dial: func() (redis.Conn, error) {\n            return redis.Dial(\"tcp\", *redisAddress,\n                redis.DialConnectTimeout(1*time.Second),\n                redis.DialReadTimeout(100*time.Millisecond),\n                redis.DialWriteTimeout(100*time.Millisecond),\n            )\n        },\n    }\n}\n</code></pre>\n\n<p>And requesting new connections and using them like so:</p>\n\n<pre><code>t0 := time.Now()\n\nconn := state.GetRedisConn()\nif conn != nil &amp;&amp; conn.Err() == nil {\n    defer conn.Close()\n    // Do stuff\nelse {\n    log.Printf(\"no redis probably\")\n}\n\nlog.Println(time.Now().Sub(t0).Seconds())\n</code></pre>\n\n<p>While redis is up, this works great, things happen in milliseconds. The moment I take redis down my 75th percentile goes up to 7+ seconds, with my 99th percentile going up to 10s (I can see this on prometheus)</p>\n\n<p>What am I doing wrong? Why does this not timeout faster?\nI was under the impression that <code>redis.DialConnectTimeout(1*time.Second)</code> would cap the issue at 1 second, but it doesn't seem to be the case.</p>\n\n<p>EDIT: It turns out this was due to a mistake I was making in Prometheus, setting the buckets too big, so while redis was timing out fine after a second, my buckets had been set up with a 1s bucket and a 10s bucket, so my requests (which were just over 1s) ended up in the 10s bucket, skewing the results. I'm sure this discussion will be useful to someone at some point though.</p>\n"}, {"tags": ["if-statement", "go", "struct", "go-templates"], "comments": [{"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1498045600, "post_id": 44675087, "comment_id": 76334304, "body": "Try to log <code>a</code> in your <code>isset</code> function. Do you see what you are passing in? If not, there is a problem at the template level. Maybe try passing in both the struct and the key to access it on to check if isset, and modify your function accordingly to take in both arguments."}, {"owner": {"reputation": 2696, "user_id": 1564840, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7374a0927a35e40deae799aa83977a1e?s=128&d=identicon&r=PG", "display_name": "Pascut", "link": "https://stackoverflow.com/users/1564840/pascut"}, "reply_to_user": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1498045775, "post_id": 44675087, "comment_id": 76334434, "body": "if my struct contains the &quot;Email&quot; it will work and it will log it inside the isset function. If the struct don&#39;t contain &quot;Email&quot; (this is my case) it will just output the error from above, no logs from the issset function will be displayed."}, {"owner": {"reputation": 2696, "user_id": 1564840, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7374a0927a35e40deae799aa83977a1e?s=128&d=identicon&r=PG", "display_name": "Pascut", "link": "https://stackoverflow.com/users/1564840/pascut"}, "reply_to_user": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1498045888, "post_id": 44675087, "comment_id": 76334511, "body": "PHP has the isset($variable) function which returns true/false, what about GO? How can I check for a variable in the template to see if it is sent from the handler? For example, I want to display a menu only if the user is logged in."}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1498045918, "post_id": 44675087, "comment_id": 76334537, "body": "Try simply <code>{{ if .Email }}</code>, that should work for you."}, {"owner": {"reputation": 2696, "user_id": 1564840, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7374a0927a35e40deae799aa83977a1e?s=128&d=identicon&r=PG", "display_name": "Pascut", "link": "https://stackoverflow.com/users/1564840/pascut"}, "reply_to_user": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1498045923, "post_id": 44675087, "comment_id": 76334542, "body": "I also tried using: {{ if .Email}} do stuff {{ end }} but this also gives me the same error. I&#39;m not sending the &quot;Email&quot; to the template. Sholdn&#39;t the if return false instead of throwing an error?"}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1498045980, "post_id": 44675087, "comment_id": 76334598, "body": "What is <code>base.customData</code>?"}, {"owner": {"reputation": 2696, "user_id": 1564840, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7374a0927a35e40deae799aa83977a1e?s=128&d=identicon&r=PG", "display_name": "Pascut", "link": "https://stackoverflow.com/users/1564840/pascut"}, "reply_to_user": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1498046140, "post_id": 44675087, "comment_id": 76334710, "body": "base is the handler, &quot;base.go&quot; and customData is a struct that contains a map (&quot;Streets&quot;) and a string (&quot;Name&quot;). If I add a new string to the structure of &quot;customData&quot; called &quot;Email&quot; the {{ if isset .Email}} function and {{ if .Email }} will both work. So the problem occurs only when I don&#39;t send the data that I check on the template."}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 1, "creation_date": 1498046904, "post_id": 44675087, "comment_id": 76335295, "body": "Take a look <a href=\"https://discourse.gohugo.io/t/isset-how-to-check-variable-is-empty/1764\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 2696, "user_id": 1564840, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7374a0927a35e40deae799aa83977a1e?s=128&d=identicon&r=PG", "display_name": "Pascut", "link": "https://stackoverflow.com/users/1564840/pascut"}, "reply_to_user": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1498047325, "post_id": 44675087, "comment_id": 76335609, "body": "Very good example. I created my &quot;isset&quot; function based on what I saw on that page. I&#39;m not using gohugo (static site generator) so everything you see in there is custom code that won&#39;t work on simple/plain go templates. See my answer to the question. Now I don&#39;t need to use the &quot;isset&quot; function anymore."}], "answers": [{"tags": [], "owner": {"reputation": 2696, "user_id": 1564840, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7374a0927a35e40deae799aa83977a1e?s=128&d=identicon&r=PG", "display_name": "Pascut", "link": "https://stackoverflow.com/users/1564840/pascut"}, "is_accepted": false, "score": 0, "last_activity_date": 1498086636, "last_edit_date": 1498086636, "creation_date": 1498047184, "answer_id": 44675798, "question_id": 44675087, "link": "https://stackoverflow.com/questions/44675087/golang-template-variable-isset/44675798#44675798", "title": "Golang template variable isset", "body": "<p>If you don't send data containing a variable to the template but you use <code>{{ if .Variable }}</code> you will get the error: </p>\n\n<blockquote>\n  <p>executing \"templatename\" at &lt;.Variable>: can't evaluate field Variable in type handler.Data</p>\n</blockquote>\n\n<p>My solution was to send the \"Email\" variable as a boolean (false) in order to pass the <code>{{ if .Email }}</code> function check. But this is a short term solution that I don't like.</p>\n\n<p>I was inspired by: <a href=\"https://stackoverflow.com/a/31527618/1564840\">https://stackoverflow.com/a/31527618/1564840</a>. In that example they show different HTML for authenticated and non-authenticated users. You will see that in both cases they send the \"Logged\" variable. Try removing that variable from the struct and execute the function. You will receive the error that I mentioned above.</p>\n"}, {"comments": [{"owner": {"reputation": 183, "user_id": 9629292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e34a5f47f765fdb4fba2b5f29d9f093d?s=128&d=identicon&r=PG&f=1", "display_name": "allsap", "link": "https://stackoverflow.com/users/9629292/allsap"}, "edited": false, "score": 0, "creation_date": 1553265293, "post_id": 44676179, "comment_id": 97332353, "body": "The map approach doesn&#39;t work if the value of the entry in the map is &#39;false&#39; (i.e. it prints &quot;Email is NOT set.&quot; instead of &quot;Email is: false&quot;)"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 14, "last_activity_date": 1498065935, "last_edit_date": 1498065935, "creation_date": 1498048187, "answer_id": 44676179, "question_id": 44675087, "link": "https://stackoverflow.com/questions/44675087/golang-template-variable-isset/44676179#44676179", "title": "Golang template variable isset", "body": "<h2>The recommended way</h2>\n\n<p>First, the recommended way is <strong>not to rely on whether a struct field exists</strong>. Of course there might be optional parts of the template, but the condition to decide whether to render a part should rely on fields that exist in all cases.</p>\n\n<h2>The issue, and avoiding it using a map</h2>\n\n<p>If the type of the template data is a <code>struct</code> (or a pointer to a struct) and there is no field or method with the given name, the template engine returns an error for that.</p>\n\n<p>You could easily get rid of this error if you were to use a map, as maps can be indexed with keys they don't contain, and the result of that <a href=\"https://golang.org/ref/spec#Index_expressions\" rel=\"noreferrer\">index expression</a> is the <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"noreferrer\">zero value</a> of the value type (and not an error).</p>\n\n<p>To demonstrate, see this example:</p>\n\n<pre><code>s := `{{if .Email}}Email is: {{.Email}}{{else}}Email is NOT set.{{end}}`\n\nt := template.Must(template.New(\"\").Parse(s))\nexec := func(name string, param interface{}) {\n    fmt.Printf(\"\\n%s:\\n  \", name)\n    if err := t.Execute(os.Stdout, param); err != nil {\n        fmt.Println(\"Error:\", err)\n    }\n}\n\nexec(\"Filled map\", map[string]interface{}{\"Email\": \"as@as\"})\nexec(\"Empty map\", map[string]interface{}{})\n\nexec(\"Filled struct\", struct {\n    Email string\n}{Email: \"as@as.com\"})\nexec(\"Empty struct\", struct{}{})\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/_nT3IvT5GW\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Filled map:\n  Email is: as@as\nEmpty map:\n  Email is NOT set.\nFilled struct:\n  Email is: as@as.com\nEmpty struct:\n  Error: template: :1:5: executing \"\" at &lt;.Email&gt;: can't evaluate field Email in type struct {}\n</code></pre>\n\n<h2>Sticking to <code>struct</code> and providing \"isset\"</h2>\n\n<p>If you must or want to stick to a <code>struct</code>, this \"isset\" can be implemented and provided, I'll call it <code>avail()</code>.</p>\n\n<p>This implementation uses reflection, and in order to check if the field given by its name exists (is available), the (wrapper) data must also be passed to it:</p>\n\n<pre><code>func avail(name string, data interface{}) bool {\n    v := reflect.ValueOf(data)\n    if v.Kind() == reflect.Ptr {\n        v = v.Elem()\n    }\n    if v.Kind() != reflect.Struct {\n        return false\n    }\n    return v.FieldByName(name).IsValid()\n}\n</code></pre>\n\n<p>Example using it:</p>\n\n<pre><code>s := `{{if (avail \"Email\" .)}}Email is: {{.Email}}{{else}}Email is unavailable.{{end}}`\n\nt := template.Must(template.New(\"\").Funcs(template.FuncMap{\n    \"avail\": avail,\n}).Parse(s))\nexec := func(name string, param interface{}) {\n    fmt.Printf(\"\\n%s:\\n  \", name)\n    if err := t.Execute(os.Stdout, param); err != nil {\n        fmt.Println(\"Error:\", err)\n    }\n}\n\nexec(\"Filled struct\", struct {\n    Email string\n}{Email: \"as@as.com\"})\nexec(\"Empty struct\", struct{}{})\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/43hIY_Vfzf\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Filled struct:\n  Email is: as@as.com\nEmpty struct:\n  Email is unavailable.\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2887, "user_id": 3068541, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/787075573/picture?type=large", "display_name": "JackyJohnson", "link": "https://stackoverflow.com/users/3068541/jackyjohnson"}, "edited": false, "score": 1, "creation_date": 1587268215, "post_id": 58762909, "comment_id": 108442014, "body": "I don&#39;t see how this works.  Please explain?  AFAICT index will error on non-enumerables"}, {"owner": {"reputation": 149, "user_id": 2407615, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zVu7U.jpg?s=128&g=1", "display_name": "hyunchel", "link": "https://stackoverflow.com/users/2407615/hyunchel"}, "edited": false, "score": 0, "creation_date": 1612024922, "post_id": 58762909, "comment_id": 116640104, "body": "<code>index</code> function does not work with type <code>struct</code>."}], "tags": [], "owner": {"reputation": 359, "user_id": 1018024, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/26ed87d97ce437059db8e4edd3ead335?s=128&d=identicon&r=PG", "display_name": "james.cookie", "link": "https://stackoverflow.com/users/1018024/james-cookie"}, "is_accepted": false, "score": -1, "last_activity_date": 1573201559, "creation_date": 1573201559, "answer_id": 58762909, "question_id": 44675087, "link": "https://stackoverflow.com/questions/44675087/golang-template-variable-isset/58762909#58762909", "title": "Golang template variable isset", "body": "<p>The simple way of doing:</p>\n\n<pre><code>{{ if .Email }}\n</code></pre>\n\n<p>is to use index:</p>\n\n<pre><code>{{ if index . \"Email\" }}\n</code></pre>\n"}], "owner": {"reputation": 2696, "user_id": 1564840, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7374a0927a35e40deae799aa83977a1e?s=128&d=identicon&r=PG", "display_name": "Pascut", "link": "https://stackoverflow.com/users/1564840/pascut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19485, "favorite_count": 1, "accepted_answer_id": 44676179, "answer_count": 3, "score": 11, "last_activity_date": 1573201559, "creation_date": 1498045266, "last_edit_date": 1498049065, "question_id": 44675087, "link": "https://stackoverflow.com/questions/44675087/golang-template-variable-isset", "title": "Golang template variable isset", "body": "<p>I have created a function to check if a variable is defined:</p>\n\n<pre><code>fm[\"isset\"] = func(a interface{}) bool {\n        if a == nil || a == \"\" || a == 0 {\n            fmt.Println(\"is not set\")\n            return false\n        }\n        fmt.Println(\"is set\")\n        return false\n    }\n\ntmpl :=  template.Must(template.New(\"\").Funcs(fm).ParseFiles(\"templates/header.html\"))\n\nerr := tmpl.ExecuteTemplate(w, \"header\", templateData)\n</code></pre>\n\n<p>In the template I have:</p>\n\n<pre><code>{{ if isset .Email }}\n    email is set\n{{ end }}\n</code></pre>\n\n<p>This function works if the variable is contained by the <code>templateData</code> (which is a custom struct that contains a map and a string), but it gives me an error if the variable doesn't exist.</p>\n\n<p>The error is: </p>\n\n<pre><code>executing \"header\" at &lt;.Email&gt;: can't evaluate field Email in type base.customData\n</code></pre>\n\n<p>In my case \"base.go\" is the handler and \"customData\" is defined by: <code>type customData struct{..}</code>.</p>\n\n<p>I want to be able to reuse templates and to display some sections only if some variables are sent from the handler. Any idea how can I implement a variable <code>isset</code> check on the template side?</p>\n\n<p>I also tried using: <code>{{ if .Email}} do stuff {{ end }}</code> but this also gives me the same error.</p>\n\n<p>Any idea?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 20746, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "edited": false, "score": 2, "creation_date": 1498041738, "post_id": 44673830, "comment_id": 76331624, "body": "You forgot to specify the return type."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 5, "creation_date": 1498041740, "post_id": 44673830, "comment_id": 76331627, "body": "1) It&#39;s not a script. 2) Your errors tell you exactly what&#39;s wrong. Did you read them?"}, {"owner": {"reputation": 20746, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "edited": false, "score": 3, "creation_date": 1498041991, "post_id": 44673830, "comment_id": 76331803, "body": "Being snarky won&#39;t convince people to help you. That said, a simple Google search for &quot;go functions&quot; should give you the hint you need."}], "answers": [{"tags": [], "owner": {"reputation": 3158, "user_id": 7925197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M21lU.png?s=128&g=1", "display_name": "papey", "link": "https://stackoverflow.com/users/7925197/papey"}, "is_accepted": false, "score": 0, "last_activity_date": 1498043994, "creation_date": 1498043994, "answer_id": 44674661, "question_id": 44673830, "link": "https://stackoverflow.com/questions/44673830/whats-wrong-with-this-simple-script/44674661#44674661", "title": "What&#39;s wrong with this simple script?", "body": "<pre><code>package main\n\nimport \"fmt\"\n\nfunc zero(x int) int {\n    x = 0\n    return x\n}\n\nfunc main() {\n    x := 5\n    x = zero(x)\n    fmt.Println(x)\n} \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 658, "user_id": 3798618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d5b4dbaaf6b031759424bfa301df5bf?s=128&d=identicon&r=PG&f=1", "display_name": "user3798618", "link": "https://stackoverflow.com/users/3798618/user3798618"}, "is_accepted": true, "score": 1, "last_activity_date": 1498044156, "creation_date": 1498044156, "answer_id": 44674730, "question_id": 44673830, "link": "https://stackoverflow.com/questions/44673830/whats-wrong-with-this-simple-script/44674730#44674730", "title": "What&#39;s wrong with this simple script?", "body": "<p>int in func</p>\n\n<pre><code>package main\nimport \"fmt\"\n\nfunc zero(x int) int {\n    x = 0\n    return x\n}\nfunc main() {\n    x := 5\n    x = zero(x)\n    fmt.Println(x)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 389, "user_id": 3385070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pU0nE.jpg?s=128&g=1", "display_name": "tez", "link": "https://stackoverflow.com/users/3385070/tez"}, "is_accepted": false, "score": 0, "last_activity_date": 1498061054, "creation_date": 1498061054, "answer_id": 44681112, "question_id": 44673830, "link": "https://stackoverflow.com/questions/44673830/whats-wrong-with-this-simple-script/44681112#44681112", "title": "What&#39;s wrong with this simple script?", "body": "<p>I believe this is closer to the original idea...</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc zero(x *int) {\n    *x = 0\n    return\n}\n\nfunc main() {\n    x := 5\n    zero(&amp;x)\n    fmt.Println(x)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 310, "user_id": 2178075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4QBKQ.jpg?s=128&g=1", "display_name": "peiiion", "link": "https://stackoverflow.com/users/2178075/peiiion"}, "is_accepted": false, "score": 0, "last_activity_date": 1515079982, "creation_date": 1515079982, "answer_id": 48098525, "question_id": 44673830, "link": "https://stackoverflow.com/questions/44673830/whats-wrong-with-this-simple-script/48098525#48098525", "title": "What&#39;s wrong with this simple script?", "body": "<p><code>too many</code> means that your function is returning more values that the function signature specifies. </p>\n\n<p>In your case, your function signature <code>func zero(x *int)</code>, says that this function doesn't returns ANY params, and inside the function body, you're returning ONE value: <code>return x</code>. So <code>1</code> is <code>too many</code> for <code>0</code> expected. Exactly 1 more. </p>\n\n<p>Then <code>zero(x) used as value</code> is telling you that you're calling a function that doesn't return ANY value, and you're trying to assign the non-existent return value to a variable: <code>x = zero(x)</code>. </p>\n\n<p>That's why the compiler tells you about using <code>zero(x)</code> as a value</p>\n"}], "owner": {"reputation": 51, "user_id": 8188100, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e334930c972ee44f83c74823a0ecc65?s=128&d=identicon&r=PG&f=1", "display_name": "gomazafaka", "link": "https://stackoverflow.com/users/8188100/gomazafaka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 44674730, "answer_count": 4, "score": -6, "last_activity_date": 1515079982, "creation_date": 1498041648, "last_edit_date": 1504368722, "question_id": 44673830, "link": "https://stackoverflow.com/questions/44673830/whats-wrong-with-this-simple-script", "title": "What&#39;s wrong with this simple script?", "body": "<p>I study functions, wrote a simple script for the textbook, and there were 2 errors.</p>\n\n<pre><code>package main\nimport \"fmt\"\n\nfunc zero(x int) {\n    x = 0\n    return x\n}\nfunc main() {\n    x := 5\n    x = zero(x)\n    fmt.Println(x)\n}\n</code></pre>\n\n<blockquote>\n  <p>too many arguments to return (string return x)</p>\n</blockquote>\n\n<p>How is \"too many\"? It's only one!</p>\n\n<blockquote>\n  <p>zero(x) used as value (string x = zero(x))</p>\n</blockquote>\n\n<p>I don't understand what he says to me.</p>\n"}, {"tags": ["go", "rsa", "private-key", "pkcs#11"], "comments": [{"owner": {"reputation": 349, "user_id": 7190910, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TOy3-gflA_c/AAAAAAAAAAI/AAAAAAAAAAo/TUKvdFNljDo/photo.jpg?sz=128", "display_name": "Aravind", "link": "https://stackoverflow.com/users/7190910/aravind"}, "edited": false, "score": 1, "creation_date": 1498148574, "post_id": 44673695, "comment_id": 76392431, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/32981821/no-dek-info-header-in-block-when-attempting-to-read-encrypted-private-key\">&quot;No DEK-Info header in block&quot; when attempting to read encrypted private key</a>"}], "answers": [{"tags": [], "owner": {"reputation": 349, "user_id": 7190910, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TOy3-gflA_c/AAAAAAAAAAI/AAAAAAAAAAo/TUKvdFNljDo/photo.jpg?sz=128", "display_name": "Aravind", "link": "https://stackoverflow.com/users/7190910/aravind"}, "is_accepted": false, "score": 0, "last_activity_date": 1498166782, "last_edit_date": 1498166782, "creation_date": 1498062482, "answer_id": 44681542, "question_id": 44673695, "link": "https://stackoverflow.com/questions/44673695/load-encrypted-pkcs1-private-key-from-file/44681542#44681542", "title": "Load encrypted PKCS1 private key from file", "body": "<p>Go does not have package to decode PKCS files it seems</p>\n\n<p>Checkout this link for more details <a href=\"https://stackoverflow.com/questions/32981821/no-dek-info-header-in-block-when-attempting-to-read-encrypted-private-key\">PKCS</a></p>\n\n<p>I cant find a package to decode PKCS1 keys </p>\n\n<p>Use this package to decode the <a href=\"https://github.com/youmark/pkcs8/blob/master/pkcs8.go#L103\" rel=\"nofollow noreferrer\">PKCS8</a> files, there are some packages to decode PKCS8, PKCS10, PKCS12 but not for PKCS1</p>\n"}, {"tags": [], "owner": {"reputation": 2183, "user_id": 5257738, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1481932215459032/picture?type=large", "display_name": "Rustam Ibragimov", "link": "https://stackoverflow.com/users/5257738/rustam-ibragimov"}, "is_accepted": false, "score": 3, "last_activity_date": 1498154030, "creation_date": 1498154030, "answer_id": 44706329, "question_id": 44673695, "link": "https://stackoverflow.com/questions/44673695/load-encrypted-pkcs1-private-key-from-file/44706329#44706329", "title": "Load encrypted PKCS1 private key from file", "body": "<p>I made a mistake with my private key file and here is a working code </p>\n\n<pre><code>func GetPrivateKey(path string) (*rsa.PrivateKey, error) {\n    b, err := ioutil.ReadFile(path)\n    if err != nil {\n        return nil, err\n    }\n\n    block, _ := pem.Decode(b)\n    der, err := x509.DecryptPEMBlock(block, []byte(*PrivateKeyPassword))\n    if err != nil {\n        return nil, err\n    }\n\n    return x509.ParsePKCS1PrivateKey(der)\n}\n</code></pre>\n\n<p>P.S. Go does have a package to decrypt PKCS1 private keys, but does not have for PKCS8. </p>\n"}], "owner": {"reputation": 2183, "user_id": 5257738, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1481932215459032/picture?type=large", "display_name": "Rustam Ibragimov", "link": "https://stackoverflow.com/users/5257738/rustam-ibragimov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1988, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1498324205, "creation_date": 1498041287, "last_edit_date": 1498324205, "question_id": 44673695, "link": "https://stackoverflow.com/questions/44673695/load-encrypted-pkcs1-private-key-from-file", "title": "Load encrypted PKCS1 private key from file", "body": "<p>I have a PKCS1 private key in a file and I load it using </p>\n\n<pre><code>b, err := ioutil.ReadFile(path)\nif err != nil {\n    return nil, err\n}\n</code></pre>\n\n<p>Then, I try to convert it into private key object</p>\n\n<pre><code>block, _ := pem.Decode(b)\nder, err := x509.DecryptPEMBlock(block, []byte(\"qwerty\"))\nif err != nil {\n    return nil, err\n}\n\nbytes := pem.EncodeToMemory(&amp;pem.Block{Type: \"RSA PRIVATE KEY\", Bytes: der})\n\nreturn x509.ParsePKCS1PrivateKey(bytes)\n</code></pre>\n\n<p>But this code throws exception in <code>DecryptPEMBlock</code> </p>\n\n<pre><code>x509: no DEK-Info header in block\n</code></pre>\n\n<p>I didn't find any documentation about this in golang</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 31, "user_id": 8080863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5roeW.png?s=128&g=1", "display_name": "Nguy\u1ec5n D\u0169ng", "link": "https://stackoverflow.com/users/8080863/nguy%e1%bb%85n-d%c5%a9ng"}, "edited": false, "score": 0, "creation_date": 1498037912, "post_id": 44670855, "comment_id": 76328866, "body": "I just want find an utility function like array_intersect for golang php.net/manual/en/function.array-intersect.php"}, {"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 0, "creation_date": 1498093597, "post_id": 44670855, "comment_id": 76360869, "body": "There is no build-in method for doing it, but there is a library that provides <code>set.intersect</code>: <a href=\"https://github.com/deckarep/golang-set\" rel=\"nofollow noreferrer\">github.com/deckarep/golang-set</a>. However, if you look at the implementation, you will see that there is a for loop running under the hood."}, {"owner": {"reputation": 1342, "user_id": 1216838, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c29171dbea109a0147226a1962a4d3c8?s=128&d=identicon&r=PG", "display_name": "Pita", "link": "https://stackoverflow.com/users/1216838/pita"}, "edited": false, "score": 0, "creation_date": 1498510200, "post_id": 44670855, "comment_id": 76517944, "body": "in all likelyhood the php utility function uses a foreach loop in itself, if you do it often, write the function urself"}], "answers": [{"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1498035667, "post_id": 44671055, "comment_id": 76327192, "body": "You <i>could</i>.  You could use recursion, or some other convoluted method to not use a for loop. But outside of code golfing, you&#39;re right, the exercise is pointless."}, {"owner": {"reputation": 31, "user_id": 8080863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5roeW.png?s=128&g=1", "display_name": "Nguy\u1ec5n D\u0169ng", "link": "https://stackoverflow.com/users/8080863/nguy%e1%bb%85n-d%c5%a9ng"}, "edited": false, "score": 0, "creation_date": 1498037386, "post_id": 44671055, "comment_id": 76328467, "body": "I just want find an utility function like array_intersect  for golang <a href=\"http://php.net/manual/en/function.array-intersect.php\" rel=\"nofollow noreferrer\">php.net/manual/en/function.array-intersect.php</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1498038688, "post_id": 44671055, "comment_id": 76329427, "body": "There is no such utility function."}, {"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "reply_to_user": {"reputation": 31, "user_id": 8080863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5roeW.png?s=128&g=1", "display_name": "Nguy\u1ec5n D\u0169ng", "link": "https://stackoverflow.com/users/8080863/nguy%e1%bb%85n-d%c5%a9ng"}, "edited": false, "score": 1, "creation_date": 1498105062, "post_id": 44671055, "comment_id": 76363598, "body": "@Nguy\u1ec5nD\u0169ng PHP comes with a big bag of utility functions (many of which are of doubtful value). Go doesn&#39;t, and you&#39;re expected to either do that yourself or use some third-party package/library for it."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 3, "last_activity_date": 1498034698, "creation_date": 1498034698, "answer_id": 44671055, "question_id": 44670855, "link": "https://stackoverflow.com/questions/44670855/how-to-find-an-element-intersect-in-other-array/44671055#44671055", "title": "How to find an element intersect in other array", "body": "<blockquote>\n  <p>How to know array b have contain element in array a without using foreach?</p>\n</blockquote>\n\n<p>You can't. And you should not try as this is pointless restriction.</p>\n"}, {"tags": [], "owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "is_accepted": false, "score": 1, "last_activity_date": 1498037562, "last_edit_date": 1498037562, "creation_date": 1498035685, "answer_id": 44671462, "question_id": 44670855, "link": "https://stackoverflow.com/questions/44670855/how-to-find-an-element-intersect-in-other-array/44671462#44671462", "title": "How to find an element intersect in other array", "body": "<p>If the arrays are sorted (as they appear to be in your question) there is an algorithm that works better than going through each element.</p>\n\n<p>Pick the first element of <code>a</code>, call it <code>x</code>.\nBinary search <code>b</code> for the first element equal or greater than <code>x</code>. If they are equal, you found an element that is contained in both arrays, if not, make that your new <code>x</code>. Now search <code>a</code> for <code>x</code> in the same way. Repeat until you run out of elements in one of the arrays.</p>\n\n<p>This can be trivially extended to an arbitrary number of arrays (in fact, it's easier to write with an arbitrary number of arrays).</p>\n\n<p>Here's a quick and dirty implementation:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sort\"\n)\n\nfunc inter(arrs ...[]int) []int {\n    res := []int{}\n    x := arrs[0][0]\n    i := 1\n    for {\n        off := sort.SearchInts(arrs[i], x)\n        if off == len(arrs[i]) {\n            // we emptied one slice, we're done.\n            break\n        }\n        if arrs[i][off] == x {\n            i++\n            if i == len(arrs) {\n                // x was in all the slices\n                res = append(res, x)\n                x++ // search for the next possible x.\n                i = 0\n            }\n        } else {\n            x = arrs[i][off]\n            i = 0 // This can be done a bit more optimally.\n        }\n    }\n    return res\n}\n\nfunc main() {\n    a := []int{1, 2, 3, 4, 5, 7}\n    b := []int{5, 6, 7, 8, 9}\n\n    fmt.Println(inter(a, b))\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6703895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98a52c65e06b6f8474963119c5b1ff67?s=128&d=identicon&r=PG&f=1", "display_name": "Steven YANG", "link": "https://stackoverflow.com/users/6703895/steven-yang"}, "edited": false, "score": 0, "creation_date": 1498126423, "post_id": 44696413, "comment_id": 76375919, "body": "By using set.Intersect: github.com/deckarep/golang-set , the code is really simple."}, {"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 0, "creation_date": 1498145147, "post_id": 44696413, "comment_id": 76390088, "body": "I did not down vote, but at least 2 issues should be pointed out. 1) This solution is using a loop under the hood, 2) <code>array_intersect</code> normally keeps track of non-unique values, intersect of <code>[1,1,2,3]</code> and <code>[3,5,1,1]</code> should be <code>[1,1,3]</code>, while your solution will give <code>[1,3]</code>"}], "tags": [], "owner": {"reputation": 11, "user_id": 6703895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98a52c65e06b6f8474963119c5b1ff67?s=128&d=identicon&r=PG&f=1", "display_name": "Steven YANG", "link": "https://stackoverflow.com/users/6703895/steven-yang"}, "is_accepted": false, "score": 0, "last_activity_date": 1498126984, "last_edit_date": 1498126984, "creation_date": 1498126285, "answer_id": 44696413, "question_id": 44670855, "link": "https://stackoverflow.com/questions/44670855/how-to-find-an-element-intersect-in-other-array/44696413#44696413", "title": "How to find an element intersect in other array", "body": "<pre><code>package main\n\nimport (\n    set \"github.com/deckarep/golang-set\"\n)\n\nfunc array_intersect(a, b []interface{}) []interface{} {\n    return set.NewSetFromSlice(a).Intersect(set.NewSetFromSlice(b)).ToSlice()\n}\nfunc main() {\n    a := []interface{}{1, 2, 3, 4, 5, 7}\n    b := []interface{}{5, 6, 7, 8, 9}\n\n    println(array_intersect(a, b))\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6703895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98a52c65e06b6f8474963119c5b1ff67?s=128&d=identicon&r=PG&f=1", "display_name": "Steven YANG", "link": "https://stackoverflow.com/users/6703895/steven-yang"}, "is_accepted": false, "score": 0, "last_activity_date": 1498196732, "last_edit_date": 1498196732, "creation_date": 1498189588, "answer_id": 44712751, "question_id": 44670855, "link": "https://stackoverflow.com/questions/44670855/how-to-find-an-element-intersect-in-other-array/44712751#44712751", "title": "How to find an element intersect in other array", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sort\"\n)\n\nfunc array_intersect(a, b []int) []int {\n    ret := []int{}\n\n    lenA := len(a)\n    lenB := len(b)\n    if lenA == 0 || lenB == 0 {\n        return ret\n    }\n    sort.Ints(a)\n    sort.Ints(b)\n    var i, j int\n    for {\n        a = a[i:]\n        if i = sort.SearchInts(a, b[j]); i &gt;= len(a) {\n            break\n        }\n        if a[i] == b[j] {\n            ret = append(ret, a[i])\n        }\n        if j++; j &gt;= lenB {\n            break\n        }\n    }\n\n    return ret\n}\nfunc main() {\n    a := []int{5, 7, 1, 1, 2, 3, 4, 5, 7}\n    b := []int{1, 1, 5, 6, 7, 8, 9}\n    fmt.Printf(\"a=%v, b=%v\", a, b)\n    fmt.Printf(\"%v\\n\", array_intersect(a, b))\n    fmt.Printf(\"a=%v, b=%v\", a, b)\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8080863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5roeW.png?s=128&g=1", "display_name": "Nguy\u1ec5n D\u0169ng", "link": "https://stackoverflow.com/users/8080863/nguy%e1%bb%85n-d%c5%a9ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 682, "favorite_count": 0, "answer_count": 4, "score": -4, "last_activity_date": 1498196732, "creation_date": 1498034145, "question_id": 44670855, "link": "https://stackoverflow.com/questions/44670855/how-to-find-an-element-intersect-in-other-array", "title": "How to find an element intersect in other array", "body": "<p><br>\nI have an array like: <br></p>\n\n<pre><code>a:= [1,2,3,4,5]\nb:= [5,6,7,8,9]\n</code></pre>\n\n<p>How to know array b have contain element in array a without using foreach?</p>\n"}, {"tags": ["sql", "json", "go"], "comments": [{"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1498032890, "post_id": 44670212, "comment_id": 76325241, "body": "Refer to this <a href=\"https://stackoverflow.com/a/33072822\">SO post</a> handling nullable values on your own. Suggestion: you can give it try with this library <code>github.com&#47;guregu&#47;null</code>."}, {"owner": {"reputation": 133, "user_id": 8181815, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cf817e25694843bbee3b913731ff36fd?s=128&d=identicon&r=PG&f=1", "display_name": "kajaptz", "link": "https://stackoverflow.com/users/8181815/kajaptz"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 1, "creation_date": 1498058336, "post_id": 44670212, "comment_id": 76344556, "body": "What about SQL solution? I can see some pros to use <code>COALESCE()</code> values in queries. You can scan values directly to standard types and also define default values other than zeros."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1498069611, "post_id": 44670212, "comment_id": 76351295, "body": "In both cases you have to take some extra to handle null and assign default values wherever appropriate. If I look at it, it&#39;s design choice you have take. Where would you like to draw a line in &#39;separation the concerns&#39;.  Application code or Database Query?"}], "answers": [{"comments": [{"owner": {"reputation": 303, "user_id": 8008395, "user_type": "registered", "profile_image": "https://graph.facebook.com/1019408758194319/picture?type=large", "display_name": "Bohdan Kostko", "link": "https://stackoverflow.com/users/8008395/bohdan-kostko"}, "edited": false, "score": 0, "creation_date": 1498033893, "post_id": 44670704, "comment_id": 76325903, "body": "Also I found this issue in Golang repo. Apparently they didn&#39;t want to confuse people with include of JSON features into sql lib. You can find more info here: <a href=\"https://github.com/golang/go/issues/9719\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/9719</a>"}], "tags": [], "owner": {"reputation": 303, "user_id": 8008395, "user_type": "registered", "profile_image": "https://graph.facebook.com/1019408758194319/picture?type=large", "display_name": "Bohdan Kostko", "link": "https://stackoverflow.com/users/8008395/bohdan-kostko"}, "is_accepted": false, "score": 3, "last_activity_date": 1498035441, "last_edit_date": 1498035441, "creation_date": 1498033674, "answer_id": 44670704, "question_id": 44670212, "link": "https://stackoverflow.com/questions/44670212/scan-sql-null-values-in-golang/44670704#44670704", "title": "Scan SQL NULL values in golang", "body": "<p>As an option you can implement your custom data type that would match the <a href=\"https://golang.org/pkg/encoding/json/#Marshaler\" rel=\"nofollow noreferrer\">JSON Marshaler</a> interface. After that you would be able to marshal your struct using regular tags.</p>\n\n<p>Check the example:</p>\n\n<pre><code>type UserTitleType sql.NullString\n\nfunc (s UserTitleType) MarshalJSON() ([]byte, error) {\n    if s.Valid {\n        return json.Marshal(s.String)\n    }\n    return jsonNull, nil\n}\n\ntype User struct {\n    Id    int64         `json:\"id\"`\n    Title UserTitleType `json:\"title\"`\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 709, "user_id": 3016478, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/hTZcs.jpg?s=128&g=1", "display_name": "rsudip90", "link": "https://stackoverflow.com/users/3016478/rsudip90"}, "is_accepted": false, "score": 5, "last_activity_date": 1508057474, "last_edit_date": 1508057474, "creation_date": 1508056277, "answer_id": 46753197, "question_id": 44670212, "link": "https://stackoverflow.com/questions/44670212/scan-sql-null-values-in-golang/46753197#46753197", "title": "Scan SQL NULL values in golang", "body": "<p>You can use aliases for types provided by sql package such as (NullInt64, NullString etc...). There are two advantages of using that, one you can scan null values and can get in golang structure and second you can marshal that struct in JSON.</p>\n\n<p>Please, look at the sample code:</p>\n\n<pre><code>// NullInt64 is an alias for sql.NullInt64 data type\ntype NullInt64 sql.NullInt64\n\n// Scan implements the Scanner interface for NullInt64\nfunc (ni *NullInt64) Scan(value interface{}) error {\n    var i sql.NullInt64\n    if err := i.Scan(value); err != nil {\n        return err\n    }\n    // if nil the make Valid false\n    if reflect.TypeOf(value) == nil {\n        *ni = NullInt64{i.Int64, false}\n    } else {\n        *ni = NullInt64{i.Int64, true}\n    }\n    return nil\n}\n\n// MarshalJSON for NullInt64\nfunc (ni *NullInt64) MarshalJSON() ([]byte, error) {\n    if !ni.Valid {\n        return []byte(\"null\"), nil\n    }\n    return json.Marshal(ni.Int64)\n}\n</code></pre>\n\n<p>Please, have a look at this <a href=\"https://medium.com/aubergine-solutions/how-i-handled-null-possible-values-from-database-rows-in-golang-521fb0ee267\" rel=\"noreferrer\">article</a>, it would be very helpful about handling null values in golang and how to use it in JSON.</p>\n"}, {"tags": [], "owner": {"reputation": 397, "user_id": 4997793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5dkyN.jpg?s=128&g=1", "display_name": "Nima Ghoroubi", "link": "https://stackoverflow.com/users/4997793/nima-ghoroubi"}, "is_accepted": false, "score": 0, "last_activity_date": 1575784879, "creation_date": 1575784879, "answer_id": 59232860, "question_id": 44670212, "link": "https://stackoverflow.com/questions/44670212/scan-sql-null-values-in-golang/59232860#59232860", "title": "Scan SQL NULL values in golang", "body": "<pre><code>// Scan implements the Scanner interface.\nfunc (n *NullInt64) Scan(value interface{}) error {\n    var ok bool\n    if value == nil {\n        n.Int64, n.Valid = 0, false\n        return nil\n    }\n\n    n.Valid = true\n    n.Int64, ok = value.(int64)\n    if !ok {\n        return errors.New(\"convert error\")\n    }\n    return nil\n}\n\n// Value implements the driver Valuer interface.\nfunc (n NullInt64) Value() (driver.Value, error) {\n    if !n.Valid {\n        return nil, nil\n    }\n    return n.Int64, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 8181815, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cf817e25694843bbee3b913731ff36fd?s=128&d=identicon&r=PG&f=1", "display_name": "kajaptz", "link": "https://stackoverflow.com/users/8181815/kajaptz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12202, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1575784879, "creation_date": 1498032183, "last_edit_date": 1498058234, "question_id": 44670212, "link": "https://stackoverflow.com/questions/44670212/scan-sql-null-values-in-golang", "title": "Scan SQL NULL values in golang", "body": "<p>\u00a0Using standard database/sql <code>Row.Scan()</code> I have a problem with null values in the row. Without considering possible null values in a row, I can get scan errors like <code>&lt;nil&gt; -&gt; *string</code>. This is quite common using LEFT JOIN queries or weak defined tables missing NO NULL column constraints. </p>\n\n<p>There are <code>sql.NullXXX</code> types (e.g. sql.NullInt64)  which can be used to scan possible null value from a row, and then check if the value is <code>.Valid</code>. However, these types don\u2019t implement JSON marshalling, and those more logic and coding is required.</p>\n\n<p>To solve this, is it better approach to <code>COALESCE()</code> column values in SQL query or do some extra coding in golang code?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 2, "creation_date": 1498031377, "post_id": 44669550, "comment_id": 76324320, "body": "Yes you can. This is just an idea. If it&#39;s in same package, you can define package scope channel then do send and receive. If it&#39;s different package pass the channel as parameter to the Method you want to send/receive. Implement it as per your need."}, {"owner": {"reputation": 53, "user_id": 4762560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2f30317b76a2f4975acaf713d587fb?s=128&d=identicon&r=PG&f=1", "display_name": "Anggit Muhamad Ginanjar", "link": "https://stackoverflow.com/users/4762560/anggit-muhamad-ginanjar"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1498032677, "post_id": 44669550, "comment_id": 76325116, "body": "Thanks buddy, I&#39;ll try this.. :)"}], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 6, "last_activity_date": 1498035914, "creation_date": 1498035914, "answer_id": 44671550, "question_id": 44669550, "link": "https://stackoverflow.com/questions/44669550/send-and-receive-data-through-one-channel-on-different-go-package-file/44671550#44671550", "title": "Send and receive data through one channel on different Go package/file", "body": "<p>Channels are just variables in Go, like <code>int</code>, <code>[]byte</code> or <code>bool</code>.  If you can pass any variables between packages, you can obviously then pass channels between packages as well.  And once you've passed a channel from one package to another, you are of course free to use it there, just as you would any other variable.  That means you can send data in one package, and receive it in another.</p>\n\n<p>Ultimately channels wouldn't be very useful if they couldn't be shared between packages.</p>\n"}], "owner": {"reputation": 53, "user_id": 4762560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2f30317b76a2f4975acaf713d587fb?s=128&d=identicon&r=PG&f=1", "display_name": "Anggit Muhamad Ginanjar", "link": "https://stackoverflow.com/users/4762560/anggit-muhamad-ginanjar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1553, "favorite_count": 0, "accepted_answer_id": 44671550, "answer_count": 1, "score": 3, "last_activity_date": 1568880112, "creation_date": 1498030336, "last_edit_date": 1568880112, "question_id": 44669550, "link": "https://stackoverflow.com/questions/44669550/send-and-receive-data-through-one-channel-on-different-go-package-file", "title": "Send and receive data through one channel on different Go package/file", "body": "<pre><code>+----------------+                       +-----------------+\n| Channel foo    |                       | Channel foo     |\n| a.go           |                       | b.go            |\n+----------------+                       +-----------------+\n       |                                          |\n       |__________________________________________|\n        Send or receive data through 'foo' channel\n</code></pre>\n\n<p>Can I create two Go source code files and send or receive data through one channel such as described from image/illustration above? So, these files could communicate each other with sending data while source code is running.</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-ses"], "answers": [{"comments": [{"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 331, "user_id": 3667526, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e4bec977dedbb56adf217c7de8389c35?s=128&d=identicon&r=PG&f=1", "display_name": "a4DEVP", "link": "https://stackoverflow.com/users/3667526/a4devp"}, "edited": false, "score": 0, "creation_date": 1498198102, "post_id": 44670306, "comment_id": 76410690, "body": "<code>ses.RawMessage.Data</code> value is not a valid email with attachment. I have updated the answer with email example."}, {"owner": {"reputation": 173, "user_id": 1283701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/316b6e64778dceb91ce2413a30b4df54?s=128&d=identicon&r=PG", "display_name": "brunetto", "link": "https://stackoverflow.com/users/1283701/brunetto"}, "edited": false, "score": 0, "creation_date": 1508406618, "post_id": 44670306, "comment_id": 80601696, "body": "Maybe <code>msg.WriteTo(emailRaw)</code> should be  <code>msg.WriteTo(&amp;emailRaw)</code>"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 173, "user_id": 1283701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/316b6e64778dceb91ce2413a30b4df54?s=128&d=identicon&r=PG", "display_name": "brunetto", "link": "https://stackoverflow.com/users/1283701/brunetto"}, "edited": false, "score": 0, "creation_date": 1508426462, "post_id": 44670306, "comment_id": 80614289, "body": "@brunetto Thanks for catching typo issue. I have updated the code snippet."}, {"owner": {"reputation": 927, "user_id": 2419669, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/kuQAn.jpg?s=128&g=1", "display_name": "yangmillstheory", "link": "https://stackoverflow.com/users/2419669/yangmillstheory"}, "edited": false, "score": 0, "creation_date": 1525145118, "post_id": 44670306, "comment_id": 87239142, "body": "@jeevatkm that AWS example is actually incorrect; newlines shouldn&#39;t be escaped before converting the raw message to bytes (just verified this right now via calls to SES)."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 927, "user_id": 2419669, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/kuQAn.jpg?s=128&g=1", "display_name": "yangmillstheory", "link": "https://stackoverflow.com/users/2419669/yangmillstheory"}, "edited": false, "score": 0, "creation_date": 1526457521, "post_id": 44670306, "comment_id": 87746796, "body": "@yangmillstheory Sorry for the delayed response. In the above example new line is not handled explicitly. Could you please point out which line it is or you could help to update the above code snippet. thanks."}, {"owner": {"reputation": 3570, "user_id": 2831925, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9895ee2af1860eb0103e1cac199061c0?s=128&d=identicon&r=PG&f=1", "display_name": "Ajay", "link": "https://stackoverflow.com/users/2831925/ajay"}, "edited": false, "score": 0, "creation_date": 1574068286, "post_id": 44670306, "comment_id": 104084375, "body": "@jeevatkm Shared attachment is corrupted."}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 9, "last_activity_date": 1508426392, "last_edit_date": 1508426392, "creation_date": 1498032514, "answer_id": 44670306, "question_id": 44669384, "link": "https://stackoverflow.com/questions/44669384/how-to-implement-aws-ses-sendrawemail-with-attachment-in-golang/44670306#44670306", "title": "How to implement aws ses SendRawEmail with attachment in golang", "body": "<p>Refer to <a href=\"http://docs.aws.amazon.com/sdk-for-go/api/service/ses/#example_SES_SendRawEmail_shared00\" rel=\"noreferrer\">AWS example</a> for Sending RAW email with attachment.</p>\n\n<p>Implementation Suggestion: for an easy to compose email and get email as bytes and send it to SES as mentioned in the above reference example.</p>\n\n<p>Use library <code>gopkg.in/gomail.v2</code> to compose your email message with attachment and then call <a href=\"https://godoc.org/gopkg.in/gomail.v2#Message.WriteTo\" rel=\"noreferrer\">WriteTo</a> method.</p>\n\n<pre><code>var emailRaw bytes.Buffer\nemailMessage.WriteTo(&amp;emailRaw)\n\n// while create instance of RawMessage\nRawMessage: &amp;ses.RawMessage{\n    Data: emailRaw.Bytes(),\n}\n</code></pre>\n\n<p>Good luck!</p>\n\n<hr>\n\n<p><strong>EDIT:</strong> For the comment.</p>\n\n<p>Compose the email-</p>\n\n<pre><code>msg := gomail.NewMessage()\nmsg.SetHeader(\"From\", \"alex@example.com\")\nmsg.SetHeader(\"To\", \"bob@example.com\", \"cora@example.com\")\nmsg.SetHeader(\"Subject\", \"Hello!\")\nmsg.SetBody(\"text/html\", \"Hello &lt;b&gt;Bob&lt;/b&gt; and &lt;i&gt;Cora&lt;/i&gt;!\")\nmsg.Attach(\"/home/Alex/lolcat.jpg\")\n\nvar emailRaw bytes.Buffer\nmsg.WriteTo(&amp;emailRaw)\n\nmessage := ses.RawMessage{ Data: emailRaw.Bytes() }\n\n// Remaining is same as what you mentioned the question.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 929, "user_id": 6146337, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10207160730031528/picture?type=large", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/6146337/sebastian"}, "is_accepted": false, "score": 1, "last_activity_date": 1566491637, "creation_date": 1566491637, "answer_id": 57613687, "question_id": 44669384, "link": "https://stackoverflow.com/questions/44669384/how-to-implement-aws-ses-sendrawemail-with-attachment-in-golang/57613687#57613687", "title": "How to implement aws ses SendRawEmail with attachment in golang", "body": "<p>if you're trying to attach a file from bytes:</p>\n\n<pre><code>msg.Attach(\"report.pdf\", gomail.SetCopyFunc(func(w io.Writer) error {\n    _, err := w.Write(reportData)\n    return err\n}))\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 3667526, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e4bec977dedbb56adf217c7de8389c35?s=128&d=identicon&r=PG&f=1", "display_name": "a4DEVP", "link": "https://stackoverflow.com/users/3667526/a4devp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3905, "favorite_count": 1, "accepted_answer_id": 44670306, "answer_count": 2, "score": 5, "last_activity_date": 1566491637, "creation_date": 1498029895, "last_edit_date": 1498211745, "question_id": 44669384, "link": "https://stackoverflow.com/questions/44669384/how-to-implement-aws-ses-sendrawemail-with-attachment-in-golang", "title": "How to implement aws ses SendRawEmail with attachment in golang", "body": "<p>I need to implement Amazon ses SendRawEmail with attachment in golang,<br>\ni tried with the following code :</p>\n\n<pre><code>session, err := session.NewSession()\nsvc := ses.New(session, &amp;aws.Config{Region: aws.String(\"us-west-2\")})\n\nsource := aws.String(\"XXX &lt;xxx@xxx.com&gt;\")\ndestinations := []*string{aws.String(\"xxx &lt;xxx@xxx.com&gt;\")}\nmessage := ses.RawMessage{ Data: []byte(` From: xxx &lt;xxx@xxx.com&gt;\\\\nTo: xxx  &lt;xxx@xxx.com&gt;\\\\nSubject: Test email (contains an attachment)\\\\nMIME-Version: 1.0\\\\nContent-type: Multipart/Mixed; boundary=\\\"NextPart\\\"\\\\n\\\\n--NextPart\\\\nContent-Type: text/plain\\\\n\\\\nThis is the message body.\\\\n\\\\n--NextPart\\\\nContent-Type: text/plain;\\\\nContent-Disposition: attachment; filename=\\\"sample.txt\\\"\\\\n\\\\nThis is the text in the attachment.\\\\n\\\\n--NextPart--\" `)}\ninput := ses.SendRawEmailInput{Source: source, Destinations: destinations, RawMessage: &amp;message}\noutput, err := svc.SendRawEmail(&amp;input)\n</code></pre>\n\n<p>but in the mail I receive, it shows the content which I have given in the message, instead of the attachment. Not sure what exactly is wrong???</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1498028889, "post_id": 44667906, "comment_id": 76322728, "body": "Your code looks alright, how come you&#39;re getting wrong md5?  In your code  just <code>return</code> is good enough, you can remove variable name."}, {"owner": {"reputation": 359, "user_id": 5121690, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RFLwM.jpg?s=128&g=1", "display_name": "Sky.Li", "link": "https://stackoverflow.com/users/5121690/sky-li"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1498030102, "post_id": 44667906, "comment_id": 76323489, "body": "Hi @jeevatkm , if I change multipart.File to File, and remove file.Seek(0, 0), it will return the right md5.  So I am really confused if I use the method Seek correctly.   And you are right, the variable name can be left out in this function."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1498030385, "post_id": 44667906, "comment_id": 76323689, "body": "Actually you can remove <code>Seek</code> call too. if you&#39;re getting file from request passing it to this method it will be always zeroth position."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1498031007, "post_id": 44667906, "comment_id": 76324078, "body": "Is there any particular need for you to use type <code>multipart.File</code> instead of  <code>os.File</code> or <code>io.Reader</code> for <code>GetFileMd5</code> method?"}, {"owner": {"reputation": 359, "user_id": 5121690, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RFLwM.jpg?s=128&g=1", "display_name": "Sky.Li", "link": "https://stackoverflow.com/users/5121690/sky-li"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1498034349, "post_id": 44667906, "comment_id": 76326229, "body": "Because I am writing a web-server, this function get these file from http.Request.   Finally, I find the <code>io.Copy()</code> result is always change and different from file size. I find there is a thread function which is used for compressing the file, and they share the same file cursor in memory. I comment the thread, then this function can work well."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1498034677, "post_id": 44667906, "comment_id": 76326476, "body": "I think it&#39;s better to do saving the file to the disk and calculate the md5 from the file. If it&#39;s satisfy your requirement."}, {"owner": {"reputation": 359, "user_id": 5121690, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RFLwM.jpg?s=128&g=1", "display_name": "Sky.Li", "link": "https://stackoverflow.com/users/5121690/sky-li"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1498035947, "post_id": 44667906, "comment_id": 76327390, "body": "@jeevatkm The web-server do not save any files, the files will be uploaded to amazon s3.  So it maybe make things complex that saving the file from memory to the disk just to calculate the md5, and delete it at last.  Still appreciate for your suggestion, I will try to find a more comfortable way to do it."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1498036155, "post_id": 44667906, "comment_id": 76327567, "body": "Okay I understand, good luck."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1498037815, "post_id": 44667906, "comment_id": 76328786, "body": "@Flimzy I agree about hard to read. The question code snippet has defined variable in the out parameter. It that sense I made a comment. Thanks."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1498038621, "post_id": 44667906, "comment_id": 76329395, "body": "@jeevatkm I realize that, but even when defined in the out parameter, naked returns are discouraged except for extremely short functions (and even then, I eschew them)"}], "answers": [{"tags": [], "owner": {"reputation": 887, "user_id": 8099995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WLnoV.png?s=128&g=1", "display_name": "berserkk", "link": "https://stackoverflow.com/users/8099995/berserkk"}, "is_accepted": true, "score": 0, "last_activity_date": 1498081757, "creation_date": 1498081757, "answer_id": 44686822, "question_id": 44667906, "link": "https://stackoverflow.com/questions/44667906/how-to-get-md5-from-multipart-file/44686822#44686822", "title": "How to get md5 from multipart.File", "body": "<p>Your code looks ok, but check, how you receive and store files. If you store them in memory, then you shouldn't call <code>Seek</code> method.</p>\n\n<p>If you want to calculate hash of uploaded file and in the same time save it locally or upload to the cloud, then you can use <a href=\"https://golang.org/pkg/io/#MultiWriter\" rel=\"nofollow noreferrer\">MultiWriter</a>.</p>\n"}], "owner": {"reputation": 359, "user_id": 5121690, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RFLwM.jpg?s=128&g=1", "display_name": "Sky.Li", "link": "https://stackoverflow.com/users/5121690/sky-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1182, "favorite_count": 1, "accepted_answer_id": 44686822, "answer_count": 1, "score": 0, "last_activity_date": 1498081757, "creation_date": 1498024752, "last_edit_date": 1498036178, "question_id": 44667906, "link": "https://stackoverflow.com/questions/44667906/how-to-get-md5-from-multipart-file", "title": "How to get md5 from multipart.File", "body": "<p>In Go, what is the right way to get the md5 of *multipart.File?</p>\n\n<p>Here is my code which retuened the wrong md5:</p>\n\n<pre><code>// GetFileMd5 count file's md5\n// return md5 string\nfunc GetFileMd5(file multipart.File) (md5Str string) {\n    h := md5.New()\n    if _, err := file.Seek(0, 0); err != nil {\n        log.Error(\"Get file md5 error: %v\", err)\n    }\n    if _, err := io.Copy(h, file); err != nil {\n        log.Error(\"Get file md5 error: %v\", err)\n    }\n    md5Str = hex.EncodeToString(h.Sum(nil))\n    log.Debug(\"File md5 is: %s\", md5Str)\n    return md5Str\n}\n</code></pre>\n"}, {"tags": ["logging", "go"], "comments": [{"owner": {"reputation": 75, "user_id": 6112367, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c37890eefeff5cfc804d5c0e07f4e423?s=128&d=identicon&r=PG&f=1", "display_name": "Nil", "link": "https://stackoverflow.com/users/6112367/nil"}, "edited": false, "score": 0, "creation_date": 1498024202, "post_id": 44667733, "comment_id": 76320359, "body": "Maybe I don&#39;t need it, since handle will close on executable exit???"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1498026324, "post_id": 44667733, "comment_id": 76321309, "body": "Which logger package do you used? The standard <code>log</code> package does not export its <code>out</code> member."}, {"owner": {"reputation": 75, "user_id": 6112367, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c37890eefeff5cfc804d5c0e07f4e423?s=128&d=identicon&r=PG&f=1", "display_name": "Nil", "link": "https://stackoverflow.com/users/6112367/nil"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1498029343, "post_id": 44667733, "comment_id": 76323000, "body": "<a href=\"https://github.com/sirupsen/logrus\" rel=\"nofollow noreferrer\">github.com/sirupsen/logrus</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 4, "last_activity_date": 1498028499, "last_edit_date": 1498028499, "creation_date": 1498027634, "answer_id": 44668669, "question_id": 44667733, "link": "https://stackoverflow.com/questions/44667733/should-i-close-log-file-in-go/44668669#44668669", "title": "Should I close log file in Go?", "body": "<p>By default, <a href=\"https://golang.org/pkg/os/#File\" rel=\"nofollow noreferrer\"><code>os.File</code></a> will be finalized by the Garbage Collector (GC) when application exit. From <a href=\"https://golang.org/pkg/runtime/#SetFinalizer\" rel=\"nofollow noreferrer\"><code>SetFinalizer</code></a> documentation</p>\n\n<blockquote>\n  <p>The finalizer for obj is scheduled to run at some arbitrary time after obj becomes unreachable. There is no guarantee that finalizers will run before a program exits, so typically they are useful only for releasing non-memory resources associated with an object during a long-running program. For example, an os.File object could use a finalizer to close the associated operating system file descriptor when a program discards an os.File without calling Close, but it would be a mistake to depend on a finalizer to flush an in-memory I/O buffer such as a bufio.Writer, because the buffer would not be flushed at program exit.</p>\n</blockquote>\n\n<p>If you don't want to rely on GC, you can close it manually in the <code>main</code> function as follows:</p>\n\n<pre><code>func main() {\n    //Close log writer when exit\n    defer func(){\n        if file, ok := Logger.Out.(*os.File); ok {\n            file.Sync()\n            file.Close()\n        } else if handler, ok := Logger.Out.(io.Closer); ok {\n            handler.Close()\n        }\n    }()\n\n    //Your original codes\n    //...\n}\n</code></pre>\n\n<p>In the above code, we use <code>defer</code> statement to ensure the <em>handler</em> will be closed when the application exit. Since <code>Logger.Out</code> may be defined as <code>io.Writer</code>, we need to test whether the <code>Logger.Out</code> also implements <code>io.Closer</code>, and if yes, it will be closed. If <code>Logger.Out</code> is an <code>os.File</code>, we also call <code>Sync()</code> to ensure all the content is written to disk.</p>\n\n<p><strong>EDIT</strong><br>\nQuote documentation and add <code>file.Sync()</code> to ensure file content is written to disk. </p>\n"}], "owner": {"reputation": 75, "user_id": 6112367, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c37890eefeff5cfc804d5c0e07f4e423?s=128&d=identicon&r=PG&f=1", "display_name": "Nil", "link": "https://stackoverflow.com/users/6112367/nil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3174, "favorite_count": 2, "accepted_answer_id": 44668669, "answer_count": 1, "score": 3, "last_activity_date": 1498036512, "creation_date": 1498024005, "last_edit_date": 1498036512, "question_id": 44667733, "link": "https://stackoverflow.com/questions/44667733/should-i-close-log-file-in-go", "title": "Should I close log file in Go?", "body": "<p>I created a Global <code>Logger</code> in a utils package's <code>init()</code> method.</p>\n\n<p>```</p>\n\n<pre><code> package utils\n\n var Logger *log.Logger\n\n func init() {\n\n  logFile, _ := config.Configure.String(\"log_file\")\n  if len(logFile) == 0 {\n     appRoot, _ := os.Getwd()\n     logFile = filepath.Join(appRoot, \"app_runtime.log\")\n  }\n\n  f, err := os.OpenFile(logFile, os.O_WRONLY|os.O_CREATE|os.O_APPEND, 0666)\n  //Look HERE!!! \n\n  if err != nil {\n     panic(err)\n  }\n  Logger = log.New()\n\n  //Log as JSON\n  Logger.Formatter = &amp;log.JSONFormatter{}\n\n  //Output to stdout\n  //When production, use file\n  Logger.Out = f\n\n  // Only log the debug severity or above.\n  Logger.Level = log.DebugLevel\n}\n</code></pre>\n\n<p>```</p>\n\n<p>So, I can use it like this:</p>\n\n<p><code>utils.Logger.Info(\"This is debug info\")</code></p>\n\n<p>My question is: Should I close the log file? How?</p>\n"}, {"tags": ["go", "cryptography", "rsa"], "comments": [{"owner": {"reputation": 1792, "user_id": 1170681, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/dhiYi.png?s=128&g=1", "display_name": "Ayrx", "link": "https://stackoverflow.com/users/1170681/ayrx"}, "reply_to_user": {"reputation": 571, "user_id": 1467632, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/94f6340980f42aef425f77c67809042f?s=128&d=identicon&r=PG", "display_name": "tweaksp", "link": "https://stackoverflow.com/users/1467632/tweaksp"}, "edited": false, "score": 0, "creation_date": 1498055343, "post_id": 44665958, "comment_id": 76342015, "body": "@tweaksp #1 That link is to a SHA-1 attack. That has nothing to do with RSA. #2 Attacks related to use of small exponents don&#39;t work when you use a proper padding mode. #3 I have many reasons for wanting to do this including but not limited to interop with other systems and writing testing tools."}, {"owner": {"reputation": 571, "user_id": 1467632, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/94f6340980f42aef425f77c67809042f?s=128&d=identicon&r=PG", "display_name": "tweaksp", "link": "https://stackoverflow.com/users/1467632/tweaksp"}, "edited": false, "score": 0, "creation_date": 1498056737, "post_id": 44665958, "comment_id": 76343208, "body": "Oops, accidently copied the wrong link! Fixing :)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498056817, "post_id": 44665958, "comment_id": 76343296, "body": "Nope, the exponent is hardcoded in the generate function, and you can see the full public api documented here: <a href=\"https://golang.org/pkg/crypto/rsa/\" rel=\"nofollow noreferrer\">golang.org/pkg/crypto/rsa</a>. The <code>GenerateMultiPrimeKey</code> function is self-contained, which you could copy into your source and modify if you want."}, {"owner": {"reputation": 571, "user_id": 1467632, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/94f6340980f42aef425f77c67809042f?s=128&d=identicon&r=PG", "display_name": "tweaksp", "link": "https://stackoverflow.com/users/1467632/tweaksp"}, "edited": false, "score": 0, "creation_date": 1498056829, "post_id": 44665958, "comment_id": 76343311, "body": "Why do you want to do this? 65537 is generally a good choice ... many attacks on RSA exploit small exponents, e.g. e=3."}, {"owner": {"reputation": 99643, "user_id": 445517, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/57e2ba76e6290c4e9e19821a068bc8c1?s=128&d=identicon&r=PG", "display_name": "CodesInChaos", "link": "https://stackoverflow.com/users/445517/codesinchaos"}, "reply_to_user": {"reputation": 571, "user_id": 1467632, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/94f6340980f42aef425f77c67809042f?s=128&d=identicon&r=PG", "display_name": "tweaksp", "link": "https://stackoverflow.com/users/1467632/tweaksp"}, "edited": false, "score": 2, "creation_date": 1498118167, "post_id": 44665958, "comment_id": 76369938, "body": "@tweaksp There are no attacks against e=3 when you use proper padding. And when you use shitty padding, e=65537 doesn&#39;t completely prevent attacks, it only offers limited mitigation."}, {"owner": {"reputation": 571, "user_id": 1467632, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/94f6340980f42aef425f77c67809042f?s=128&d=identicon&r=PG", "display_name": "tweaksp", "link": "https://stackoverflow.com/users/1467632/tweaksp"}, "edited": false, "score": 0, "creation_date": 1498168172, "post_id": 44665958, "comment_id": 76402674, "body": "There&#39;s this attack on RSA-OAEP. It works if the coins have weak entropy: <a href=\"http://eprint.iacr.org/2005/189\" rel=\"nofollow noreferrer\">eprint.iacr.org/2005/189</a>. I realize though that under ideal conditions, there are no attacks on RSA-OAEP with e=3."}, {"owner": {"reputation": 75, "user_id": 14686422, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d1cc59d70a60f0fd154bbf9a2c3d4087?s=128&d=identicon&r=PG", "display_name": "Sam Ginrich", "link": "https://stackoverflow.com/users/14686422/sam-ginrich"}, "edited": false, "score": 0, "creation_date": 1617527710, "post_id": 44665958, "comment_id": 118325159, "body": "public exponent is one of a couple of parameters, which are hidden by default implementation. E.g. I prefer to have public exponent chosen by random; then I want to decide over the minimum bit length difference of p and q, which is a security factor, finally for very large key sizes, I want to control the accuracy of parameters being prime, i.e. the depth of the rabin-miller test.  Short: I write my own RSA service with own parameter classes."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 2575663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19a9ec586a3892c5a1aa5c37d0171879?s=128&d=identicon&r=PG", "display_name": "Wizr", "link": "https://stackoverflow.com/users/2575663/wizr"}, "edited": false, "score": 0, "creation_date": 1554881894, "post_id": 45293558, "comment_id": 97908983, "body": "Same question here, for some reason, I want it to be <b>17</b>, which happen to be one the <b>integers</b>, but we can&#39;t now (by using that function)."}, {"owner": {"reputation": 3705, "user_id": 8334991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v0H6m.jpg?s=128&g=1", "display_name": "Alexandre Fenyo", "link": "https://stackoverflow.com/users/8334991/alexandre-fenyo"}, "reply_to_user": {"reputation": 113, "user_id": 2575663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19a9ec586a3892c5a1aa5c37d0171879?s=128&d=identicon&r=PG", "display_name": "Wizr", "link": "https://stackoverflow.com/users/2575663/wizr"}, "edited": false, "score": 0, "creation_date": 1554900153, "post_id": 45293558, "comment_id": 97919645, "body": "Most of the time, the public exponent values are hard coded in the libraries. This is the case for this API in Go. This explains you can not use 17."}], "tags": [], "owner": {"reputation": 3705, "user_id": 8334991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v0H6m.jpg?s=128&g=1", "display_name": "Alexandre Fenyo", "link": "https://stackoverflow.com/users/8334991/alexandre-fenyo"}, "is_accepted": false, "score": 2, "last_activity_date": 1501432744, "last_edit_date": 1501432744, "creation_date": 1500954315, "answer_id": 45293558, "question_id": 44665958, "link": "https://stackoverflow.com/questions/44665958/generating-rsa-keys-with-a-specific-public-exponent/45293558#45293558", "title": "Generating RSA keys with a specific public exponent", "body": "<p>You will not find such an API in Go.</p>\n\n<p>This is because, for many reasons, 3 and 65537 match requirements needed for RSA to work and for RSA implementations to be fast.</p>\n\n<p>Here are the explanations for these two properties:</p>\n\n<ul>\n<li><p>First, for RSA to work, the public exponent must be coprime with the cardinal number of the set of integers, between 1 and the modulus, that are coprime with the modulus (see RSA algorithm to understand why). So, choosing a prime number is a good way to have a chance for this number to be coprime with the cardinal number of the set described above, this is why people choose prime numbers as public exponents, most of the time (and if it is not the case, they compute a new modulus instead of changing the public exponent). Since the cardinal number of the set described above is even, you can not choose 2 (if the modulus is the product of primes p and q, this set has (p-1)(q-1) elements, that is obviously an even number).</p></li>\n<li><p>Moreover, for fast computation, the number of bits set to 1 in the binary representation of the public exponent must be lower as possible. 2 is the only prime number with one bit set to 1 in its binary representation. Since it can not be chosen, you will choose a prime number that only has 2 bits set to one in its binary representation. Therefore, the arithmetic product of such a prime with any other number only needs one addition and a logical shift left.</p></li>\n</ul>\n\n<p><strong>The only known integers (up to now) that match these requirements are 3, 5, 17, 257 and 65537.</strong></p>\n"}], "owner": {"reputation": 1792, "user_id": 1170681, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/dhiYi.png?s=128&g=1", "display_name": "Ayrx", "link": "https://stackoverflow.com/users/1170681/ayrx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 945, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1501432744, "creation_date": 1498012581, "question_id": 44665958, "link": "https://stackoverflow.com/questions/44665958/generating-rsa-keys-with-a-specific-public-exponent", "title": "Generating RSA keys with a specific public exponent", "body": "<p>The <code>crypto/rsa</code> library has the below function to generate a new RSA private key. </p>\n\n<pre><code>func GenerateKey(random io.Reader, bits int) (*PrivateKey, error)\n</code></pre>\n\n<p>This appears to default to use <code>65537</code> as the public exponent value. Is there an API I can use to generate a RSA private key with a public exponent of my choice that does not have a dependency on OpenSSL or another C library?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 2, "last_activity_date": 1498019020, "creation_date": 1498019020, "answer_id": 44666860, "question_id": 44665834, "link": "https://stackoverflow.com/questions/44665834/scope-visibility-of-struct-members-while-passing-as-a-argument/44666860#44666860", "title": "Scope visibility of struct members while passing as a argument?", "body": "<p><em>Access permission</em> is checked when</p>\n\n<ol>\n<li>You're creating/declaring a variable. The compiler will check the visibility of <em>the name of the type identifier</em>.</li>\n<li>Using <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\"><code>reflect</code></a> package to modify a variable. </li>\n<li>Calling a constant, global variable, or a function. The visibility of constant/variable/function name will be checked.</li>\n</ol>\n\n<p>Once the variable is created/defined, and when you pass this variable as a function/method argument, the copy (If it is a value, the value is being copied. If it is a pointer, the address is being copied) will be passed to the function/method, and <strong>always accessible</strong> from the function body through the argument name and type. In <code>encoding/json</code> package, the <a href=\"https://golang.org/pkg/encoding/json/#Decoder.Decode\" rel=\"nofollow noreferrer\"><code>Decoder.Decode</code></a> method is defined as,</p>\n\n<pre><code>func (dec *Decoder) Decode(v interface{}) error\n</code></pre>\n\n<p>thus, anything you passed to the <code>Decoder.Decode</code> method, is always accessible from inside the method body through argument <code>v</code>. Note that the type of <code>v</code> is <code>interface{}</code> not <code>_Sample</code> struct. The visibility is checked when you defined the variable as</p>\n\n<pre><code>var sample _Sample\n</code></pre>\n\n<p>which was <em>OK</em> since it is done from within the same package. Even an anonymous struct (i.e. no type name identifier is defined for the struct)</p>\n\n<pre><code>aSample := struct {\n    first  string // this will not be filled because it starts with lower case letter\n    Second string // it is OK.\n}{}\n\n//...\nerr := decoder.Decode(&amp;aSample)\n</code></pre>\n\n<p>will works. Next, when the <code>decoder</code> fills the struct (through reflection), the visibility of struct members will be checked, and <code>_Sample.first</code> is not visible from inside the <code>json</code> package. </p>\n"}], "owner": {"reputation": 3, "user_id": 8191605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49fee5da60a3d22de4a915083dc8b52f?s=128&d=identicon&r=PG&f=1", "display_name": "baivoom", "link": "https://stackoverflow.com/users/8191605/baivoom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 44666860, "answer_count": 1, "score": -2, "last_activity_date": 1498019020, "creation_date": 1498011572, "last_edit_date": 1498012123, "question_id": 44665834, "link": "https://stackoverflow.com/questions/44665834/scope-visibility-of-struct-members-while-passing-as-a-argument", "title": "Scope visibility of struct members while passing as a argument?", "body": "<p>While calling json.Decoder.Decode by passing a struct, for instance</p>\n\n<pre><code>type _Sample struct {\n    first string // this will not be filled because it starts with lower case letter\n    Second string // it is OK. \n}\n\n...\nvar sample _Sample\nerr := decoder.Decode(&amp;sample)\n</code></pre>\n\n<p>According to the Language Specification that writes:</p>\n\n<blockquote>\n  <p>Exported identifiers \u00b6</p>\n  \n  <p>An identifier may be exported to permit access to it from another package. An identifier is exported if both:</p>\n  \n  <ul>\n  <li>the first character of the identifier's name is a Unicode upper case letter (Unicode class \"Lu\"); and</li>\n  <li>the identifier is declared in the package block or it is a field name or method name.</li>\n  </ul>\n  \n  <p>All other identifiers are not exported.</p>\n</blockquote>\n\n<p>The question is the struct <code>_Sample</code> is not exported, why it is visible by the package <code>json</code>?</p>\n"}, {"tags": ["json", "go", "encoding"], "comments": [{"owner": {"reputation": 2054, "user_id": 615120, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/xoAHa.jpg?s=128&g=1", "display_name": "rnk", "link": "https://stackoverflow.com/users/615120/rnk"}, "edited": false, "score": 0, "creation_date": 1498005493, "post_id": 44665057, "comment_id": 76315532, "body": "When I tried your code here <a href=\"https://play.golang.org/p/1NDMsUJtqW\" rel=\"nofollow noreferrer\">play.golang.org/p/1NDMsUJtqW</a> It works fine. <code>{&quot;A&quot;:1,&quot;B&quot;:&quot;bValue&quot;,&quot;GenericObj&quot;:{&quot;C&quot;:&quot;cVal&quot;}}</code>"}, {"owner": {"reputation": 293, "user_id": 5225081, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/88eacba7df7f23affd7a197753f2696b?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/5225081/j-doe"}, "reply_to_user": {"reputation": 2054, "user_id": 615120, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/xoAHa.jpg?s=128&g=1", "display_name": "rnk", "link": "https://stackoverflow.com/users/615120/rnk"}, "edited": false, "score": 0, "creation_date": 1498005649, "post_id": 44665057, "comment_id": 76315565, "body": "Oops - &quot;GenericObj&quot; should&#39;ve been a private variable &quot;genericObj&quot;. And in your playground output, it has the &quot;GenericObj&quot; json key wrapped around &quot;C&quot;:&quot;cVal&quot;, which I don&#39;t want."}, {"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 1, "creation_date": 1498005797, "post_id": 44665057, "comment_id": 76315593, "body": "For what it&#39;s worth, un-exported fields will not be marshaled in Go."}], "answers": [{"comments": [{"owner": {"reputation": 293, "user_id": 5225081, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/88eacba7df7f23affd7a197753f2696b?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/5225081/j-doe"}, "edited": false, "score": 0, "creation_date": 1498175693, "post_id": 44665101, "comment_id": 76404894, "body": "In the example given, wouldn&#39;t the output json always have an object called &quot;Header&quot; containing the RawMessage? Is there a way to change the json field name from &quot;Header&quot; to something else dynamically, based on how we construct it?"}, {"owner": {"reputation": 293, "user_id": 5225081, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/88eacba7df7f23affd7a197753f2696b?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/5225081/j-doe"}, "edited": false, "score": 0, "creation_date": 1498176748, "post_id": 44665101, "comment_id": 76405123, "body": "Essentially in my code I will get a map[string]interface that has been unmarshalled from an input json and I want to put this directly into my output JsonMessage struct without adding any top-level json field. Right now the way that is proposed will wrap the input json around another json field with the name of the JsonMessage field (i.e &quot;Header&quot;)"}, {"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "reply_to_user": {"reputation": 293, "user_id": 5225081, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/88eacba7df7f23affd7a197753f2696b?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/5225081/j-doe"}, "edited": false, "score": 1, "creation_date": 1498176899, "post_id": 44665101, "comment_id": 76405168, "body": "@J.Doe I don&#39;t believe there is a way to dynamically change the JSON field name, no. Unless you do some code generation it doesn&#39;t seem possible."}, {"owner": {"reputation": 293, "user_id": 5225081, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/88eacba7df7f23affd7a197753f2696b?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/5225081/j-doe"}, "edited": false, "score": 0, "creation_date": 1498234161, "post_id": 44665101, "comment_id": 76433911, "body": "As I thought. Thanks@"}, {"owner": {"reputation": 1342, "user_id": 1216838, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c29171dbea109a0147226a1962a4d3c8?s=128&d=identicon&r=PG", "display_name": "Pita", "link": "https://stackoverflow.com/users/1216838/pita"}, "edited": false, "score": 0, "creation_date": 1498510578, "post_id": 44665101, "comment_id": 76518122, "body": "If there is a limited set of JSON field names, you could always define all of them and check which one is set."}], "tags": [], "owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "is_accepted": false, "score": 8, "last_activity_date": 1612516717, "last_edit_date": 1612516717, "creation_date": 1498005610, "answer_id": 44665101, "question_id": 44665057, "link": "https://stackoverflow.com/questions/44665057/marshal-interface-into-json/44665101#44665101", "title": "Marshal interface{} into json", "body": "<p>This is precisely why <a href=\"https://golang.org/pkg/encoding/json/#RawMessage\" rel=\"nofollow noreferrer\"><code>json.RawMessage</code></a> exists.</p>\n<p>Here is an example straight from the Go docs:</p>\n<pre><code>package main\n\nimport (\n    &quot;encoding/json&quot;\n    &quot;fmt&quot;\n    &quot;os&quot;\n)\n\nfunc main() {\n    h := json.RawMessage(`{&quot;precomputed&quot;: true}`)\n\n    c := struct {\n        Header *json.RawMessage `json:&quot;header&quot;`\n        Body   string           `json:&quot;body&quot;`\n    }{Header: &amp;h, Body: &quot;Hello Gophers!&quot;}\n\n    b, err := json.MarshalIndent(&amp;c, &quot;&quot;, &quot;\\t&quot;)\n    if err != nil {\n        fmt.Println(&quot;error:&quot;, err)\n    }\n    os.Stdout.Write(b)\n\n}\n</code></pre>\n<p>Here is the output:</p>\n<pre class=\"lang-json prettyprint-override\"><code>{\n    &quot;header&quot;: {\n        &quot;precomputed&quot;: true\n    },\n    &quot;body&quot;: &quot;Hello Gophers!&quot;\n}\n</code></pre>\n<p>Go Playground: <a href=\"https://play.golang.org/p/skYJT1WyM1C\" rel=\"nofollow noreferrer\">https://play.golang.org/p/skYJT1WyM1C</a></p>\n<p>Of course you can marshal a value before time to get the raw bytes in your case.</p>\n"}], "owner": {"reputation": 293, "user_id": 5225081, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/88eacba7df7f23affd7a197753f2696b?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/5225081/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9588, "favorite_count": 1, "answer_count": 1, "score": 8, "last_activity_date": 1612516717, "creation_date": 1498005320, "last_edit_date": 1498036266, "question_id": 44665057, "link": "https://stackoverflow.com/questions/44665057/marshal-interface-into-json", "title": "Marshal interface{} into json", "body": "<p>I want to generate a json that's something like this:</p>\n\n<pre><code>{\n   \"A\": 1,\n   \"B\": \"bVal\",\n   \"C\": \"cVal\"\n}\n</code></pre>\n\n<p>But I want to keep my code generic enough that I can replace the key-pair \"C\" with any other type of json object that I want. I tried doing something like what I have below:  </p>\n\n<pre><code>    type JsonMessage struct {\n        A int `json:\"A\"`\n        B string `json:\"B,omitempty\"`\n        genericObj interface{} \n    }\n\n    type JsonObj struct {\n        C string `json:\"C\"`\n    }\n\n    func main() {\n        myJsonObj := JsonObj{C: \"cVal\"}\n        myJson := JsonMessage{A: 1, B: \"bValue\", genericObj: myJsonObj}\n\n        body, _ := json.Marshal(myJson)\n        fmt.Print(body)\n    }\n</code></pre>\n\n<p>But the output is just this:</p>\n\n<pre><code>{\n   \"A\": 1,\n   \"B\": \"bVal\"\n}\n</code></pre>\n\n<p>Is there a different way to approach this?</p>\n"}, {"tags": ["json", "http", "go", "go-chi"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 7636062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b462c3a7ef691579d6a666b0763780dc?s=128&d=identicon&r=PG&f=1", "display_name": "jaimelescornichons", "link": "https://stackoverflow.com/users/7636062/jaimelescornichons"}, "edited": false, "score": 0, "creation_date": 1497997639, "post_id": 44663794, "comment_id": 76313504, "body": "Indeed, I should have check the source code of <code>render.Bind</code>... that explains why the <code>Body</code> was empty, since it had already be read. Anyway, thanks for the solution !"}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 1, "last_activity_date": 1498036585, "last_edit_date": 1498036585, "creation_date": 1497996455, "answer_id": 44663794, "question_id": 44663496, "link": "https://stackoverflow.com/questions/44663496/chi-empty-http-request-body-in-render-bind/44663794#44663794", "title": "Chi empty http.Request.Body in render.Bind", "body": "<p><a href=\"https://github.com/pressly/chi/blob/master/render/render.go#L20\" rel=\"nofollow noreferrer\">render.Bind</a>'s purpose is to perform decode and execute <code>Bind(r)</code> to do post decode operations.</p>\n\n<p>For eg.:</p>\n\n<pre><code>type Test struct {\n   Name string `json:\"name\"`\n}\n\nfunc (p *Test) Bind(r *http.Request) error {\n   // At this point, Decode is already done by `chi`\n   p.Name = p.Name + \" after decode\"\n  return nil\n}\n</code></pre>\n\n<p>If you have to do only JSON decode no other actions needs to be done after decode with respect to decoded values. Just use:</p>\n\n<pre><code>// Use Directly JSON decoder of std pkg\nerr := json.NewDecoder(r.Body).Decode(&amp;p)\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>// Use wrapper method from chi DecodeJSON\nerr := render.DecodeJSON(r.Body, &amp;p)\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 7636062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b462c3a7ef691579d6a666b0763780dc?s=128&d=identicon&r=PG&f=1", "display_name": "jaimelescornichons", "link": "https://stackoverflow.com/users/7636062/jaimelescornichons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2872, "favorite_count": 0, "accepted_answer_id": 44663794, "answer_count": 1, "score": 1, "last_activity_date": 1534002027, "creation_date": 1497994858, "last_edit_date": 1534002027, "question_id": 44663496, "link": "https://stackoverflow.com/questions/44663496/chi-empty-http-request-body-in-render-bind", "title": "Chi empty http.Request.Body in render.Bind", "body": "<p>I am using <a href=\"http://github.com/pressly/chi\" rel=\"nofollow noreferrer\">github.com/pressly/chi</a> to build this simple program where I try to decode some JSON from the <code>http.Request.Body</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"net/http\"\n\n    \"github.com/pressly/chi\"\n    \"github.com/pressly/chi/render\"\n)\n\ntype Test struct {\n    Name string `json:\"name\"`\n}\n\nfunc (p *Test) Bind(r *http.Request) error {\n    err := json.NewDecoder(r.Body).Decode(p)\n    if err != nil {\n        return err\n    }\n    return nil\n}\n\nfunc main() {\n    r := chi.NewRouter()\n\n    r.Post(\"/products\", func(w http.ResponseWriter, r *http.Request) {\n        var p Test\n        // err := render.Bind(r, &amp;p)\n        err := json.NewDecoder(r.Body).Decode(&amp;p)\n\n        if err != nil {\n            panic(err)\n        }\n\n        fmt.Println(p)\n    })\n\n    http.ListenAndServe(\":8080\", r)\n}\n</code></pre>\n\n<p>When I don't use <code>render.Bind()</code> (from <code>\"github.com/pressly/chi/render\"</code>), it works as expected.</p>\n\n<p>However, when I uncomment the line <code>err := render.Bind(r, &amp;p)</code> and I comment the line <code>err := json.NewDecoder(r.Body).Decode(&amp;p)</code>, it panics with <code>EOF</code> :</p>\n\n<blockquote>\n  <p><code>2017/06/20 22:26:39 http: panic serving 127.0.0.1:39696: EOF</code></p>\n</blockquote>\n\n<p>and thus the <code>json.Decode()</code> fails.</p>\n\n<p>Am I doing something wrong or is the <code>http.Request.Body</code> is already read somewhere else before <code>render.Bind()</code> is called?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1497990647, "post_id": 44662456, "comment_id": 76310554, "body": "&quot;GET <a href=\"http://localhost:12345/app2.js\" rel=\"nofollow noreferrer\">localhost:12345/app2.js</a>&quot; isn&#39;t an error, it&#39;s an HTTP request. What is the actual error? 404 Not Found?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497990717, "post_id": 44662456, "comment_id": 76310596, "body": "Also you&#39;ve defined the route for your files on disk to be <code>&#47;files&#47;</code>, but you&#39;re not using that in your reference in the HTML; perhaps <code>src=&quot;app2.js&quot;</code> should be <code>src=&quot;files&#47;app2.js&quot;</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5906464"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497990742, "post_id": 44662456, "comment_id": 76310613, "body": "@Adrian There is nothing specific like 404 which caused more confusion"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497990772, "post_id": 44662456, "comment_id": 76310633, "body": "What&#39;s generating the error? Web browser?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5906464"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497990868, "post_id": 44662456, "comment_id": 76310702, "body": "@Adrain Web browser. The app2.js is in the current directory. I gave the complete path to the files but it still didn&#39;t work."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497990938, "post_id": 44662456, "comment_id": 76310746, "body": "It doesn&#39;t matter where it is on disk; your handler is setting the route as <code>&#47;files&#47;</code>, which means that&#39;s where you&#39;ll be able to load them from via HTTP. If you&#39;re using a web browser, you should be able to get the actual error from the developer tools; if your browser doesn&#39;t give you this, try a browser with better developer tools (e.g. Chrome/Chromium)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5906464"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497991079, "post_id": 44662456, "comment_id": 76310821, "body": "@Adrian I though this is the place where my server looks for app2.js (http.FileServer(http.Dir(&quot;.&quot;)))."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497991184, "post_id": 44662456, "comment_id": 76310882, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/147210/discussion-between-adrian-and-sarath-velamuri\">continue this discussion in chat</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5906464"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497991190, "post_id": 44662456, "comment_id": 76310887, "body": "@Adrian Yes it 404 not found. I created a new directory and placed this app2.js in that. It is still the same."}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497991301, "post_id": 44662611, "comment_id": 76310942, "body": "No, you can&#39;t. That&#39;s not what <code>StripPrefix</code> does."}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": false, "score": 0, "last_activity_date": 1497991674, "last_edit_date": 1497991674, "creation_date": 1497991229, "answer_id": 44662611, "question_id": 44662456, "link": "https://stackoverflow.com/questions/44662456/why-my-golang-template-is-not-picking-the-external-javascript-file/44662611#44662611", "title": "Why my golang template is not picking the external javascript file?", "body": "<p>Let's say you have directory structure:</p>\n\n<pre><code>&lt;src-dir&gt;\n   static\n   templates\n   ...\n</code></pre>\n\n<p>And you map handler you're using <code>http.StripPrefix</code></p>\n\n<pre><code>router.Handle(\"/static/\", http.StripPrefix(\"/static/\", http.FileServer(http.Dir(\"static\"))))\n</code></pre>\n\n<p>Update this line to-</p>\n\n<pre><code>&lt;script type=\"text/javascript\" src=\"/static/app2.js\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>Now you can access the file via <code>http://localhost:12345/static/app2.js</code></p>\n"}, {"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 5, "last_activity_date": 1546620233, "last_edit_date": 1546620233, "creation_date": 1497991344, "answer_id": 44662633, "question_id": 44662456, "link": "https://stackoverflow.com/questions/44662456/why-my-golang-template-is-not-picking-the-external-javascript-file/44662633#44662633", "title": "Why my golang template is not picking the external javascript file?", "body": "<p>This line: </p>\n\n<pre><code>router.Handle(\"/files/\", http.StripPrefix(\"/files/\", http.FileServer(http.Dir(\".\"))))\n</code></pre>\n\n<p>Means that requests coming in for URLs under \"/files/\" will be served from files on disk in the current directory, with the \"/files/\" prefix removed.\nSo if you want a file in the current directory named <code>app2.js</code>, then the URL must be <code>/files/app2.js</code>.</p>\n\n<p><code>router.Handle</code> defines what handler will handle a given path. In this case, that path is <code>/files/</code>. Because of the trailing slash, the same handler will be used for all URLs beginning with <code>/files/</code>.</p>\n\n<p><code>http.StripPrefix</code> is a handler <em>wrapper</em>. It takes the incoming request, strips off the given prefix (in this case, <code>/files/</code>), removes it from the URL path, and then passes the request on to the handler passed to <code>StripPrefix</code>.</p>\n\n<p><code>http.FileServer</code> serves files out of a <code>http.FileSystem</code>, in this case provided by <code>http.Dir</code>. <code>http.Dir</code> exposes the files in a directory, in this case the current working directory (<code>\".\"</code>).</p>\n\n<p>So, in total: requests beginning with <code>/files/</code>, will have the <code>/files/</code> part removed, then whatever is left, that file path will be looked for in the current working directory, and if it is found, it will be served. So, <code>/files/app2.js</code> will serve <code>./app2.js</code>. Your HTML must reference <code>/files/app2.js</code>, <strong>not</strong> <code>app.js</code>.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5906464"}, "edited": false, "score": 0, "creation_date": 1498063849, "post_id": 44681573, "comment_id": 76348095, "body": "I&#39;ve never written a backend code and having a hard time understanding how the routes, etc work. I&#39;m going through some blogs on how to secure the web application from most of the attacks. If you have any thing good in your mind, please suggest some."}], "tags": [], "owner": {"reputation": 806, "user_id": 2568541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f33bfa1f90a40be9312040bbdf3ff138?s=128&d=identicon&r=PG", "display_name": "jchrbrt", "link": "https://stackoverflow.com/users/2568541/jchrbrt"}, "is_accepted": false, "score": 0, "last_activity_date": 1498062549, "creation_date": 1498062549, "answer_id": 44681573, "question_id": 44662456, "link": "https://stackoverflow.com/questions/44662456/why-my-golang-template-is-not-picking-the-external-javascript-file/44681573#44681573", "title": "Why my golang template is not picking the external javascript file?", "body": "<p>Writing <code>http.FileServer(http.Dir(\".\"))</code> is generally a bad idea because it will expose not only your .js files but also you .go files, making you code visible via http requests. For example <a href=\"http://localhost:12345/main.go\" rel=\"nofollow noreferrer\">http://localhost:12345/main.go</a> will make the browser deliver your source code as text.</p>\n\n<p>The best practice should be to collect your static files (js, css, html...) in seperated directories, or just in one, like for example a \"resources\" package.</p>\n\n<p>Try then with </p>\n\n<pre><code>http.Handle(\"/files/\", http.StripPrefix(\"/files/\", http.FileServer(http.Dir(\"resources\"))))\n</code></pre>\n\n<p>This code will do the work and allow you to access all your files that are under <code>/resources</code> with the url prefix <code>/files</code>. For example:\n <code>http://localhost:12345/files/app2.js</code></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5906464"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1011, "favorite_count": 0, "accepted_answer_id": 44662633, "answer_count": 3, "score": 0, "last_activity_date": 1546620233, "creation_date": 1497990614, "last_edit_date": 1497990811, "question_id": 44662456, "link": "https://stackoverflow.com/questions/44662456/why-my-golang-template-is-not-picking-the-external-javascript-file", "title": "Why my golang template is not picking the external javascript file?", "body": "<p>I tried so many suggestions from stack overflow but none seems to work. I was not able to pick the external js file.</p>\n\n<p>My main function:</p>\n\n<pre><code>package main\n\nimport(\n    \"encoding/json\"\n    \"net/http\"\n    \"fmt\"\n    \"github.com/gorilla/mux\"\n    \"github.com/rs/cors\"\n    \"text/template\"\n)  \n\nfunc GetPeopleEndpoint(w http.ResponseWriter, req *http.Request) {\n    w.Header().Set(\"Content-Type\", \"text/html\")\n    t, _ := template.ParseFiles(\"index2.html\")\n    t.Execute(w, nil)\n}\n\nfunc main() {\n    router := mux.NewRouter()\n    people = append(people, Person{ID: \"1\", Firstname: \"Nic\", Lastname: \"Raboy\", Address: &amp;Address{City: \"Dublin\", State: \"CA\"}})\n    people = append(people, Person{ID: \"2\", Firstname: \"Maria\", Lastname: \"Raboy\"})\n\n    fmt.Println(people)\n\n    router.Handle(\"/files/\", http.StripPrefix(\"/files/\", http.FileServer(http.Dir(\".\"))))\n    router.HandleFunc(\"/people\", GetPeopleEndpoint)\n\n    c := cors.New(cors.Options{\n        AllowedOrigins: []string{\"http://localhost:3000\"},\n        AllowCredentials: true,\n    })\n\n    // Insert the middleware\n    handler := c.Handler(router)\n\n    //  handler := cors.Default().Handler(router)\n    http.ListenAndServe(\":12345\", handler)\n}\n</code></pre>\n\n<p>All my files are in the same directory. </p>\n\n<p>Here is my html: </p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"utf-8\"&gt;\n    &lt;title&gt;&lt;/title&gt;\n\n  &lt;/head&gt;\n  &lt;body&gt;\n    This is page2\n\n    &lt;div id='newdiv'&gt;\n\n    &lt;/div&gt;\n  &lt;/body&gt;\n\n  &lt;script type=\"text/javascript\" src=\"app2.js\"&gt;\n  &lt;/script&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>The error I'm getting is \"GET <a href=\"http://localhost:12345/app2.js\" rel=\"nofollow noreferrer\">http://localhost:12345/app2.js</a>\". I don't know where I'm doing the mistake.</p>\n"}, {"tags": ["debugging", "go", "command-line-interface"], "comments": [{"owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 1, "creation_date": 1497986952, "post_id": 44661495, "comment_id": 76308509, "body": "there is no REPL"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1497987404, "post_id": 44661495, "comment_id": 76308789, "body": "A CLI tool for what?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497987883, "post_id": 44661495, "comment_id": 76309047, "body": "Any time you run a Go application, it results in a native binary. Debugging, &quot;go run file.go&quot;, unit testing, they all produce binaries."}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497987672, "post_id": 44661562, "comment_id": 76308949, "body": "That doc is on how to <i>write</i> a CLI tool in Go."}], "tags": [], "owner": {"reputation": 2195, "user_id": 7443287, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CagRU.jpg?s=128&g=1", "display_name": "Mirza Sisic", "link": "https://stackoverflow.com/users/7443287/mirza-sisic"}, "is_accepted": false, "score": 0, "last_activity_date": 1497987069, "creation_date": 1497987069, "answer_id": 44661562, "question_id": 44661495, "link": "https://stackoverflow.com/questions/44661495/is-there-a-cli-command-line-interface-for-golang/44661562#44661562", "title": "Is there a CLI (Command Line Interface) for GoLang?", "body": "<p>Yes there is, you can check it out here\n<a href=\"https://thenewstack.io/cli-command-line-programming-with-go/\" rel=\"nofollow noreferrer\">https://thenewstack.io/cli-command-line-programming-with-go/</a></p>\n"}, {"tags": [], "owner": {"reputation": 191, "user_id": 4074586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30b8eaeb188788da55f046402d6e9277?s=128&d=identicon&r=PG&f=1", "display_name": "Diablojoe", "link": "https://stackoverflow.com/users/4074586/diablojoe"}, "is_accepted": false, "score": 2, "last_activity_date": 1497987230, "creation_date": 1497987230, "answer_id": 44661603, "question_id": 44661495, "link": "https://stackoverflow.com/questions/44661495/is-there-a-cli-command-line-interface-for-golang/44661603#44661603", "title": "Is there a CLI (Command Line Interface) for GoLang?", "body": "<p>Go does not have a CLI that must be used when invoking a application written in Go. There is a go command that is \"... a suite of programs to build and process Go source code\". You can find more information about this in the <a href=\"https://golang.org/doc/cmd\" rel=\"nofollow noreferrer\">command documentation</a> </p>\n"}], "owner": {"reputation": 1364, "user_id": 1532915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/861093c3dbb6328d6a33acec57e97454?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/1532915/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "closed_date": 1497987639, "answer_count": 2, "score": 1, "last_activity_date": 1497987230, "creation_date": 1497986830, "question_id": 44661495, "link": "https://stackoverflow.com/questions/44661495/is-there-a-cli-command-line-interface-for-golang", "closed_reason": "Duplicate", "title": "Is there a CLI (Command Line Interface) for GoLang?", "body": "<p>Totally new golang user here and I don't see a CLI tool but just wanted to make sure I wasn't overlooking it. It appears everything just compiles down to a binary that you can run, even when debugging?</p>\n"}, {"tags": ["performance", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1497979934, "post_id": 44659422, "comment_id": 76304299, "body": "I don&#39;t think the time taken to add a lot of empty values to a map which is never used is a common use case. You&#39;re basically just testing the machine code used to expand different types of maps. Overall memory usage <i>might</i> be more relevant for most programs if there is any difference at all. I personally like having a bool value so the <code>, ok</code> isn&#39;t needed to check for a key&#39;s existence."}, {"owner": {"reputation": 3784, "user_id": 6182569, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/595afc3cb368ac51e5643e7e71dfdb4d?s=128&d=identicon&r=PG", "display_name": "Mihailo", "link": "https://stackoverflow.com/users/6182569/mihailo"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497980133, "post_id": 44659422, "comment_id": 76304402, "body": "Theres a situation where this can come in useful but its not that relevant because the speed difference is not that big. Hmm interesting point (regarding bools). Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 3784, "user_id": 6182569, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/595afc3cb368ac51e5643e7e71dfdb4d?s=128&d=identicon&r=PG", "display_name": "Mihailo", "link": "https://stackoverflow.com/users/6182569/mihailo"}, "edited": false, "score": 0, "creation_date": 1497979957, "post_id": 44659479, "comment_id": 76304305, "body": "I agree its not the most relevant question for Real-Life Apps. But I found it interesting because I was expecting byte=0 to be the fastest. From time to time I like to fiddle around with the language. Thank you for your constructive answer :)"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1497985716, "post_id": 44659479, "comment_id": 76307819, "body": "<code>byte=0</code> requires 8 bits of storage <code>struct{}{}</code> requires 0.  Managing 8 bits x N occurrences will generally be less efficient than managing 0 bits x N occurrences."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1497987387, "post_id": 44659479, "comment_id": 76308776, "body": "@Flimzy: since a hashmap doesn&#39;t ever want to have full buckets (the const load factor in Go is 6.5), the overhead of buckets almost makes up for any difference between <code>bool</code> (which is packed directly into the bucket anyway) and <code>struct{}</code>. While there still is a small 5-6% difference in memory usage (at least there was last time I did the math, which was a few releases ago), you can&#39;t say that using N <code>struct{}</code> values in a map saves you <code>N</code> bytes."}, {"owner": {"reputation": 3784, "user_id": 6182569, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/595afc3cb368ac51e5643e7e71dfdb4d?s=128&d=identicon&r=PG", "display_name": "Mihailo", "link": "https://stackoverflow.com/users/6182569/mihailo"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1498021261, "post_id": 44659479, "comment_id": 76319284, "body": "@Jimb that&#39;s some interesting information, thank you for sharing. Is there any other type besides <code>struct{}</code> that uses 0 bits in go?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 3784, "user_id": 6182569, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/595afc3cb368ac51e5643e7e71dfdb4d?s=128&d=identicon&r=PG", "display_name": "Mihailo", "link": "https://stackoverflow.com/users/6182569/mihailo"}, "edited": false, "score": 1, "creation_date": 1498031501, "post_id": 44659479, "comment_id": 76324390, "body": "@Mihailo All array types that have 0 length, e.g. <code>[0]byte</code>, <code>[0]int</code> etc."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 4, "last_activity_date": 1497979575, "creation_date": 1497979575, "answer_id": 44659479, "question_id": 44659422, "link": "https://stackoverflow.com/questions/44659422/which-is-the-most-efficient-nil-value/44659479#44659479", "title": "Which is the most efficient nil value?", "body": "<p>Theoretically, <code>struct{}{}</code> should be the most efficient because it requires no memory. In practice, a) results may vary between Go versions, operating systems, and system architectures; and b) I can't think of any case where maximizing the execution-time efficiency of empty values is relevant.</p>\n"}], "owner": {"reputation": 3784, "user_id": 6182569, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/595afc3cb368ac51e5643e7e71dfdb4d?s=128&d=identicon&r=PG", "display_name": "Mihailo", "link": "https://stackoverflow.com/users/6182569/mihailo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 44659479, "answer_count": 1, "score": 0, "last_activity_date": 1497979575, "creation_date": 1497979356, "question_id": 44659422, "link": "https://stackoverflow.com/questions/44659422/which-is-the-most-efficient-nil-value", "title": "Which is the most efficient nil value?", "body": "<p>Hi while doing some exercises I've came across this question...<br>\nLets say you have a map with the capacity of 100,000.<br>\n<strong>Which value is the most efficient to fill the whole map in the least amount of time?</strong></p>\n\n<hr>\n\n<p>I've ran some benchmarks on my own trying out most of the types I could think of and the resulting top list is:</p>\n\n<pre><code>Benchmark_Struct-8           200           6010422 ns/op    (struct{}{})\nBenchmark_Byte-8             200           6167230 ns/op    (byte = 0)\nBenchmark_Int-8              200           6112927 ns/op    (int8 = 0)\nBenchmark_Bool-8             200           6117155 ns/op    (bool = false)\n</code></pre>\n\n<p>Example function:</p>\n\n<pre><code>func Struct() {\n    m := make(map[int]struct{}, 100000)\n    for i := 0; i &lt; 100000; i++ {\n        m[i] = struct{}{}\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>As you can see the fastest one <em>(most of the time)</em> is type <code>struct{}{}</code> - empty struct.</p>\n\n<ul>\n<li>But why is this the case in <strong>go</strong>? </li>\n<li>Is there a faster/lighter nil or non-nil value?</li>\n</ul>\n\n<p><br>\n<em>- Thank you for your time :)</em></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1497979170, "post_id": 44659343, "comment_id": 76303878, "body": "Are you doing this on the Go playground by any chance?"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 8188100, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e334930c972ee44f83c74823a0ecc65?s=128&d=identicon&r=PG&f=1", "display_name": "gomazafaka", "link": "https://stackoverflow.com/users/8188100/gomazafaka"}, "edited": false, "score": 0, "creation_date": 1497984165, "post_id": 44659426, "comment_id": 76306905, "body": "Thank you very much, it works! How does the function rand.Seed depend on the function randInt? Or is it somehow globally affecting the application and Intn?"}, {"owner": {"reputation": 1732, "user_id": 8121683, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1fnlik1dgxU/AAAAAAAAAAI/AAAAAAAAATk/MvX5UOgKBfg/photo.jpg?sz=128", "display_name": "Easton Bornemeier", "link": "https://stackoverflow.com/users/8121683/easton-bornemeier"}, "reply_to_user": {"reputation": 51, "user_id": 8188100, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e334930c972ee44f83c74823a0ecc65?s=128&d=identicon&r=PG&f=1", "display_name": "gomazafaka", "link": "https://stackoverflow.com/users/8188100/gomazafaka"}, "edited": false, "score": 0, "creation_date": 1497984568, "post_id": 44659426, "comment_id": 76307157, "body": "It is modifying the rand object. Think of it as a value stored within rand. By default, this is set to 1. We just changed it to the current time."}], "tags": [], "owner": {"reputation": 1732, "user_id": 8121683, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1fnlik1dgxU/AAAAAAAAAAI/AAAAAAAAATk/MvX5UOgKBfg/photo.jpg?sz=128", "display_name": "Easton Bornemeier", "link": "https://stackoverflow.com/users/8121683/easton-bornemeier"}, "is_accepted": true, "score": 2, "last_activity_date": 1498140990, "last_edit_date": 1498140990, "creation_date": 1497979372, "answer_id": 44659426, "question_id": 44659343, "link": "https://stackoverflow.com/questions/44659343/how-to-choose-a-random-number-from-the-range/44659426#44659426", "title": "How to choose a random number from the range?", "body": "<p>You need to \"Seed\" the random number generator. This is like the code that tells the pseudo random number generator how to generate your numbers. Now, you can't just give this any number, or you are going to generate the same set every time. Often a good practice is to seed with the current time.</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"time\"    #ADDED\n)\n\nfunc main() {\n    // Seed should be set once, better spot is func init()\n    rand.Seed(time.Now().UTC().UnixNano())   #ADDED\n    fmt.Println(randInt(1, 1000))\n}\n\nfunc randInt(min int, max int) int {\n    return min + rand.Intn(max-min)\n}\n</code></pre>\n\n<p>Now every time you call your <code>randInt()</code> function, it will use the time from when the seed function was called to generate the random number. </p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 8188100, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e334930c972ee44f83c74823a0ecc65?s=128&d=identicon&r=PG&f=1", "display_name": "gomazafaka", "link": "https://stackoverflow.com/users/8188100/gomazafaka"}, "edited": false, "score": 0, "creation_date": 1497984362, "post_id": 44659429, "comment_id": 76307026, "body": "Does this mean that Intn takes data from some internal program structures that must be set with the help of the Seed? It was incomprehensible to me from the documentation."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 51, "user_id": 8188100, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e334930c972ee44f83c74823a0ecc65?s=128&d=identicon&r=PG&f=1", "display_name": "gomazafaka", "link": "https://stackoverflow.com/users/8188100/gomazafaka"}, "edited": false, "score": 0, "creation_date": 1497984638, "post_id": 44659429, "comment_id": 76307208, "body": "All PRNGs operate basically the same way, permuting numbers to achieve a nearly-random result. They usually take the previous random number as the input to the next random number; that means that to generate the <i>first</i> random number, they need a starting point, and that&#39;s the &quot;seed&quot;. Starting with the same seed yields the same sequence of numbers."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 1, "last_activity_date": 1497979380, "creation_date": 1497979380, "answer_id": 44659429, "question_id": 44659343, "link": "https://stackoverflow.com/questions/44659343/how-to-choose-a-random-number-from-the-range/44659429#44659429", "title": "How to choose a random number from the range?", "body": "<p>Two points. First, as the documentation for <code>math/rand</code> states right at the top:</p>\n\n<blockquote>\n  <p>Use the Seed function to initialize the default Source if different behavior is required for each run.</p>\n</blockquote>\n\n<p>If you don't Seed it with something different each run (e.g. clock time), you'll get the same result every run, because the default seed is always 1.</p>\n\n<p>Second, if you're running this on the Playground, you'll get the same result every time regardless because it caches the results of executions. If the code is the same, the result will be the same.</p>\n"}], "owner": {"reputation": 51, "user_id": 8188100, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e334930c972ee44f83c74823a0ecc65?s=128&d=identicon&r=PG&f=1", "display_name": "gomazafaka", "link": "https://stackoverflow.com/users/8188100/gomazafaka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1914, "favorite_count": 1, "accepted_answer_id": 44659426, "answer_count": 2, "score": 0, "last_activity_date": 1498140990, "creation_date": 1497979093, "question_id": 44659343, "link": "https://stackoverflow.com/questions/44659343/how-to-choose-a-random-number-from-the-range", "title": "How to choose a random number from the range?", "body": "<p>I read the documentation for the function Intn <a href=\"https://golang.org/pkg/math/rand/#Intn\" rel=\"nofollow noreferrer\">https://golang.org/pkg/math/rand/#Intn</a> but I don't understand what they mean\nI know how random differs from pseudo-random. But how can I simulate a random in the range from 1 to 1000 for example?</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"math/rand\"\n)\n\nfunc main() {\n    fmt.Println(randInt(1, 1000))\n}\n\nfunc randInt(min int, max int) int {\n    return min + rand.Intn(max-min)\n}\n</code></pre>\n\n<p>The answer is always 879</p>\n\n<pre><code>func main() {\n    fmt.Print(rand.Intn(100))\n}\n</code></pre>\n\n<p>The answer is always 81</p>\n"}, {"tags": ["go", "operating-system", "semaphore", "synchronous", "sequential"], "answers": [{"comments": [{"owner": {"reputation": 1101, "user_id": 5261216, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cC2sAyNVGuk/AAAAAAAAAAI/AAAAAAAAAJo/2r_RFyBF1Xo/photo.jpg?sz=128", "display_name": "Sharath BJ", "link": "https://stackoverflow.com/users/5261216/sharath-bj"}, "edited": false, "score": 0, "creation_date": 1498021679, "post_id": 44659348, "comment_id": 76319420, "body": "thanks for the answer @Adrian . But what is the solution to the problem. So my problem statement is this .  I want to hit a third party API for some range of dates sequentially , and i should not do 10 API call at a time ,so i used a concurrency of 8 , so i wont do more than 10 calls . Now in this way ,i am able to call the API but not sequentially. sequential call is very important in my case . thanks"}, {"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "reply_to_user": {"reputation": 1101, "user_id": 5261216, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cC2sAyNVGuk/AAAAAAAAAAI/AAAAAAAAAJo/2r_RFyBF1Xo/photo.jpg?sz=128", "display_name": "Sharath BJ", "link": "https://stackoverflow.com/users/5261216/sharath-bj"}, "edited": false, "score": 0, "creation_date": 1498032336, "post_id": 44659348, "comment_id": 76324910, "body": "@SharathB.J I don&#39;t understand what you mean. If you want to call the API sequentially then you can&#39;t call it in parallel. The natural model has one thread hitting it sequentially. You&#39;re trying to exploit parallelism at the other end (e.g. you hit it with 10 sequential requests and then await the results) you either open 10 requests then wait on 10 results. You can parallelise that by creating 1 producer and a thread pool of consumers for the responses."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 1101, "user_id": 5261216, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cC2sAyNVGuk/AAAAAAAAAAI/AAAAAAAAAJo/2r_RFyBF1Xo/photo.jpg?sz=128", "display_name": "Sharath BJ", "link": "https://stackoverflow.com/users/5261216/sharath-bj"}, "edited": false, "score": 0, "creation_date": 1498044988, "post_id": 44659348, "comment_id": 76333860, "body": "@sharath the solution is don&#39;t make your requests concurrently."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 2, "last_activity_date": 1497979118, "creation_date": 1497979118, "answer_id": 44659348, "question_id": 44659210, "link": "https://stackoverflow.com/questions/44659210/concurrency-semaphore-sequential-execution/44659348#44659348", "title": "Concurrency semaphore sequential execution", "body": "<p>A semaphore or mutex controls synchronization, not order of operations. The order of concurrent operations, regardless of whether or not they're synchronized, is not controllable or predictable. If you need a controlled order of operations, you should not execute those operations concurrently.</p>\n"}], "owner": {"reputation": 1101, "user_id": 5261216, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cC2sAyNVGuk/AAAAAAAAAAI/AAAAAAAAAJo/2r_RFyBF1Xo/photo.jpg?sz=128", "display_name": "Sharath BJ", "link": "https://stackoverflow.com/users/5261216/sharath-bj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 540, "favorite_count": 0, "accepted_answer_id": 44659348, "answer_count": 1, "score": 1, "last_activity_date": 1497985774, "creation_date": 1497978532, "last_edit_date": 1497985774, "question_id": 44659210, "link": "https://stackoverflow.com/questions/44659210/concurrency-semaphore-sequential-execution", "title": "Concurrency semaphore sequential execution", "body": "<p>How can I execute a Go program in concurrency using semaphore sequentially?</p>\n\n<p>I have a small program which just prints reading from an array which contain numbers</p>\n\n<pre><code>package main\nimport \"fmt\"\nimport \"sync\"\n\ntype empty struct{}\n\n type semaphore chan empty\n\n // acquire n resources\n func (sem semaphore) P(n int) {\n e := empty{}\n for i := 0; i &lt; n; i++ {\n    sem &lt;- e\n }\n }\n // release n resources\n func (sem semaphore) V(n int) {\n    for i := 0; i &lt; n; i++ {\n        &lt;-sem\n     }\n }\n\n\nfunc main() {\nvar wg sync.WaitGroup\nsm := make(semaphore, 2)\nvar arr []int = []int{1,2,3,4,5,6,7,8,9}\n\nfor _,val := range arr{\nwg.Add(1)\ngo func(val int){\n    sm.P(1)\n    defer sm.V(1)\n    defer wg.Done()\n    fmt.Print(\" val:\",val)\n      }(val)\n}\nwg.Wait()\n}\n</code></pre>\n\n<p>Output:</p>\n\n<p>9 1 2 3 4 5 6 7 8</p>\n\n<p>But I want the output to be like this (as per the array declaration)</p>\n\n<p>1 2 3 4 5 6 7 8 9</p>\n"}, {"tags": ["go", "memory-leaks", "heap-memory"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 7, "creation_date": 1497976325, "post_id": 44658063, "comment_id": 76302300, "body": "According to <a href=\"https://github.com/golang/go/issues/14521\" rel=\"nofollow noreferrer\">this issue report</a>, this behavior is normal. If there is enough pressure on memory in the system from other processes, the OS should start to reclaim the memory from the Go process that Go has marked as unused."}], "owner": {"reputation": 11294, "user_id": 1239122, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/8cf239e31df87733c835e53851283548?s=128&d=identicon&r=PG", "display_name": "Gravy", "link": "https://stackoverflow.com/users/1239122/gravy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 411, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1497976926, "creation_date": 1497974914, "last_edit_date": 1497976926, "question_id": 44658063, "link": "https://stackoverflow.com/questions/44658063/actual-memory-used-by-web-server-memory-not-released-to-os", "title": "Actual memory used by web server. Memory not released to OS", "body": "<p>I push a bunch of requests through the web server, and according to Htop / activity monitor on my mac, Virt is 530G, Res is 247Mb.</p>\n\n<p>The memory doesn't seem to be being released to the OS. I tried adding the following for force memory to be returned to OS as a test to no avail:</p>\n\n<pre><code>func freeMem() {\n    tick := time.Tick(time.Second * 10)\n\n    for range tick {\n        debug.FreeOSMemory()\n    }\n}\n</code></pre>\n\n<p>and at the top of main, calling <code>go freeMem()</code>, but this seems to have no effect.</p>\n\n<p>So I tried checking garbage collector is working properly and visualising with dave cheney's gcvis <a href=\"https://github.com/davecheney/gcvis\" rel=\"nofollow noreferrer\">https://github.com/davecheney/gcvis</a>:</p>\n\n<p>Looks like gcvis shows things are working fine and dandy, but htop &amp; activity monitor seem to be v high memory usage. </p>\n\n<p>Do I have anything to worry about? One thing I did notice in gcvis, is that whilst <code>gc.heapinuse</code> goes down to acceptable levels, <code>scvg.released</code> and <code>scvg.sys</code> seem to remain high.</p>\n\n<p><a href=\"https://i.stack.imgur.com/RLoLu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RLoLu.png\" alt=\"gcvis output\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/XNU7f.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XNU7f.png\" alt=\"htop &amp; activity monitor\"></a></p>\n"}, {"tags": ["windows", "go", "google-home"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1497974379, "post_id": 44657835, "comment_id": 76301041, "body": "Maybe start with the official docs, like <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a>"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1497978463, "post_id": 44657835, "comment_id": 76303508, "body": "Duplicate by the same user, no less."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8188965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1102d2a51bbe60c756d6a1c6d161280?s=128&d=identicon&r=PG&f=1", "display_name": "user8188965", "link": "https://stackoverflow.com/users/8188965/user8188965"}, "edited": false, "score": 0, "creation_date": 1497974832, "post_id": 44657910, "comment_id": 76301356, "body": "the only thing is that I remember reading that GOPATH should not be set to the GO folder but a different directory... I will give this a try though I must have misunderstood."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1497976745, "post_id": 44657910, "comment_id": 76302545, "body": "It shouldn&#39;t be set to your Go <i>installation</i> directory (that should be your <code>GOROOT</code>, not your <code>GOPATH</code>)."}], "tags": [], "owner": {"reputation": 1765, "user_id": 1856885, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5tifK.gif?s=128&g=1", "display_name": "Harris", "link": "https://stackoverflow.com/users/1856885/harris"}, "is_accepted": false, "score": 1, "last_activity_date": 1497974513, "creation_date": 1497974513, "answer_id": 44657910, "question_id": 44657835, "link": "https://stackoverflow.com/questions/44657835/difficulty-running-go-file/44657910#44657910", "title": "Difficulty running Go file", "body": "<p>According to <a href=\"https://golang.org/cmd/go/#hdr-GOPATH_environment_variable\" rel=\"nofollow noreferrer\">the documentation</a>, the <code>GOPATH</code> variable should be set to the folder <em>containing</em> <code>bin</code>, <code>pkg</code>, and <code>src</code>.</p>\n\n<p>Here is the example directory layout they give:</p>\n\n<pre><code>GOPATH=/home/user/go\n\n/home/user/go/\n    src/\n        foo/\n            bar/               (go code in package bar)\n                x.go\n            quux/              (go code in package main)\n                y.go\n    bin/\n        quux                   (installed command)\n    pkg/\n        linux_amd64/\n            foo/\n                bar.a          (installed package object)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1084, "user_id": 7614848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zml9W.jpg?s=128&g=1", "display_name": "Piyush Patel", "link": "https://stackoverflow.com/users/7614848/piyush-patel"}, "is_accepted": false, "score": 1, "last_activity_date": 1497976361, "creation_date": 1497976361, "answer_id": 44658553, "question_id": 44657835, "link": "https://stackoverflow.com/questions/44657835/difficulty-running-go-file/44658553#44658553", "title": "Difficulty running Go file", "body": "<p><strong>each go program is a package and it should be in the \"src/package-name/main.go\"\nwhere as package-name is the directory name which is same as your package name</strong></p>\n\n<p>in your case\nit should be <strong>\"src/populationapi/main.go\"</strong></p>\n\n<p>or whatever package file name you choose</p>\n\n<p>then go to the package directory and run the command <strong>\"run main.go\"</strong></p>\n\n<p>in the tutorial they used \"ngrok\" utility you need to download and run that to make it work</p>\n"}], "owner": {"reputation": 11, "user_id": 8188965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1102d2a51bbe60c756d6a1c6d161280?s=128&d=identicon&r=PG&f=1", "display_name": "user8188965", "link": "https://stackoverflow.com/users/8188965/user8188965"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 418, "favorite_count": 0, "closed_date": 1498056945, "answer_count": 2, "score": -3, "last_activity_date": 1497976361, "creation_date": 1497974258, "last_edit_date": 1497974471, "question_id": 44657835, "link": "https://stackoverflow.com/questions/44657835/difficulty-running-go-file", "closed_reason": "Duplicate", "title": "Difficulty running Go file", "body": "<p>I am stuck on this tutorial. Nothing happens every time that I navigate to where my file is located and I try the \"go run populationapi.go\" step. I made a file populationapi.go in my workspace which I already set as the GOPATH variable. I have a windows computer. Which of the three folders should it be in (bin, pkg, or src)? Any ideas about what's going wrong?</p>\n\n<p><a href=\"https://www.programmableweb.com/news/how-to-get-started-google-actions/how-to/2017/01/31?page=4\" rel=\"nofollow noreferrer\">https://www.programmableweb.com/news/how-to-get-started-google-actions/how-to/2017/01/31?page=4</a></p>\n"}, {"tags": ["go", "intellij-idea", "goland"], "answers": [{"tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": true, "score": 2, "last_activity_date": 1497976626, "last_edit_date": 1497976626, "creation_date": 1497974511, "answer_id": 44657909, "question_id": 44657806, "link": "https://stackoverflow.com/questions/44657806/introduce-local-variable-in-gogland-ide/44657909#44657909", "title": "Introduce local variable in Gogland ide", "body": "<p>You need to use CTRL+ALT+V for Windows / Linux (or CMD+ALT+V on OS X) or invoke the Refactor | Extract | Variable and then select the function call from the list and the variables will be inserted for you.</p>\n"}], "owner": {"reputation": 497, "user_id": 4417705, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6Hyhp.jpg?s=128&g=1", "display_name": "Karthik Cherukuri", "link": "https://stackoverflow.com/users/4417705/karthik-cherukuri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 44657909, "answer_count": 1, "score": 0, "last_activity_date": 1497976626, "creation_date": 1497974183, "question_id": 44657806, "link": "https://stackoverflow.com/questions/44657806/introduce-local-variable-in-gogland-ide", "title": "Introduce local variable in Gogland ide", "body": "<p>How to introduce local variables in Gogland IDE in MacOS ??</p>\n\n<p>I'm having the below code and want introduce the local variables for all the return values returned through <code>ParseKnowHosts</code> function.</p>\n\n<pre><code>authorizedKeyBytes, error := ioutil.ReadFile(\"authorized_keys\")\nif error != nil {\n    log.Fatal(error)\n}\nssh.ParseKnownHosts(authorizedKeyBytes) // returns &lt;marker, hosts, key, pubKey, comment, rest&gt;\n</code></pre>\n\n<p>What key supposed to use for automatically assign local variables to all returned values like below instead typing manually ? (I tried ALT + Enter didnt worked, which is the one I use for IntelliJ)</p>\n\n<pre><code>marker, hosts, key, pubKey, comment, rest := ssh.ParseKnownHosts(authorizedKeyBytes)\n</code></pre>\n"}, {"tags": ["go", "concurrency", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 8102608, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Sd8NSJBVWe8/AAAAAAAAAAI/AAAAAAAAACg/isDKMh82TYI/photo.jpg?sz=128", "display_name": "Jun An", "link": "https://stackoverflow.com/users/8102608/jun-an"}, "edited": false, "score": 0, "creation_date": 1497972956, "post_id": 44657241, "comment_id": 76300091, "body": "I have tried many times, if this is determined by chance, I thought maybe it should appear at least once."}, {"owner": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "reply_to_user": {"reputation": 7, "user_id": 8102608, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Sd8NSJBVWe8/AAAAAAAAAAI/AAAAAAAAACg/isDKMh82TYI/photo.jpg?sz=128", "display_name": "Jun An", "link": "https://stackoverflow.com/users/8102608/jun-an"}, "edited": false, "score": 1, "creation_date": 1497973191, "post_id": 44657241, "comment_id": 76300264, "body": "@JunAn Try running the program with -race. The runtime will somewhat randomize the order in which goroutines are run when compiled with -race. Using -race I get different outputs most of the time."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 7, "user_id": 8102608, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Sd8NSJBVWe8/AAAAAAAAAAI/AAAAAAAAACg/isDKMh82TYI/photo.jpg?sz=128", "display_name": "Jun An", "link": "https://stackoverflow.com/users/8102608/jun-an"}, "edited": false, "score": 1, "creation_date": 1497974066, "post_id": 44657241, "comment_id": 76300828, "body": "@JunAn: the order is not defined, which means that by chance the current runtime implementation may still be influencing the order an a consistent way. If you&#39;re using the playground, you&#39;re just retrieving the same cached result every time. Simply don&#39;t rely on order where you don&#39;t create order."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1497974922, "post_id": 44657241, "comment_id": 76301422, "body": "In addition to the answer and comments above, adding <code>runtime.LockOSThread()</code> to the 2 printing goroutines and running it many times, I had a run where only the &quot;main exit&quot; was printed (and the program terminated before the other text could have been printed)."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1497978103, "post_id": 44657241, "comment_id": 76303318, "body": "For the record, on single-core systems, goroutine scheduling <i>is</i>, for the most part, deterministic.  There&#39;s a chance on entering a function for that goroutine to be rescheduled (to prevent thread saturation by a continually spinning routine), but otherwise the scheduler has consistent rules for when a goroutine swap can occur (on blocking channel operation, network calls, sleep, and a few others).  This behavior just isn&#39;t well-documented, nor is it defined in the spec, and thus the implementation can be changed without notice and without breaking the backwards compatibility guarantee."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 2, "last_activity_date": 1497972980, "last_edit_date": 1497972980, "creation_date": 1497972554, "answer_id": 44657241, "question_id": 44657084, "link": "https://stackoverflow.com/questions/44657084/why-main-goroutine-always-be-the-second-to-be-invoked/44657241#44657241", "title": "why main goroutine always be the second to be invoked", "body": "<p>Chance.</p>\n\n<p>There's nothing in the language spec that says your \"wait exit\" should execute either before or after \"main exit\".</p>\n\n<p>Chances are if you run the program enough times, sometimes \"main exit\" will run first.  But also maybe not. The results are not defined, and depend on the runtime state and implementation. As such results may even change between Go versions.</p>\n"}], "owner": {"reputation": 7, "user_id": 8102608, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Sd8NSJBVWe8/AAAAAAAAAAI/AAAAAAAAACg/isDKMh82TYI/photo.jpg?sz=128", "display_name": "Jun An", "link": "https://stackoverflow.com/users/8102608/jun-an"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1497972980, "creation_date": 1497972107, "last_edit_date": 1497972616, "question_id": 44657084, "link": "https://stackoverflow.com/questions/44657084/why-main-goroutine-always-be-the-second-to-be-invoked", "title": "why main goroutine always be the second to be invoked", "body": "<pre><code>package main\nimport (\n  \"sync\"\n  \"time\"\n  )\nfunc main() {\n  var wg sync.WaitGroup\n\n  wg.Add(1)\n\n  go func() {         //A\n    wg.Wait()\n    println(\"wait exit\")\n  }()\n\n  go func() {\n    time.Sleep(time.Second)\n    wg.Done()\n  }()\n\n  wg.Wait()\n  println(\"main exit\")\n}\n</code></pre>\n\n<hr>\n\n<p>result:</p>\n\n<pre><code>wait exit\nmain exit\n</code></pre>\n\n<p>Why don't main goroutine execute println(\"main exit\") first, and main thread dead and then discard A goroutine?\nIt keeps printing like the result shows </p>\n"}, {"tags": ["go", "redis"], "comments": [{"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 1, "creation_date": 1497971794, "post_id": 44656095, "comment_id": 76299264, "body": "you can perhaps use a redis lua script to 1: read the token and then intermediately 2. delete the token. If you cant read someone else got there before you."}], "answers": [{"tags": [], "owner": {"reputation": 1511, "user_id": 495504, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ee8d8278b0394be64c52abc8d7c4ca17?s=128&d=identicon&r=PG", "display_name": "Eric Pauley", "link": "https://stackoverflow.com/users/495504/eric-pauley"}, "is_accepted": true, "score": 3, "last_activity_date": 1618973837, "last_edit_date": 1618973837, "creation_date": 1497978275, "answer_id": 44659129, "question_id": 44656095, "link": "https://stackoverflow.com/questions/44656095/best-way-to-store-a-single-time-use-record-in-redis-using-golang/44659129#44659129", "title": "best way to store a single time use record in redis using golang", "body": "<p>This is a perfect use case for the <code>MULTI-EXEC</code> functionality:</p>\n<pre><code>MULTI\nGET key\nDELETE key\nEXEC\n</code></pre>\n<p>Or in go:</p>\n<pre><code>pipe := client.TxPipeline()\n\nget := pipe.Get(&quot;key&quot;)\npipe.Del(&quot;key&quot;)\n\n_, err := pipe.Exec()\nfmt.Println(get.Val(), err)\n</code></pre>\n<p>This will ensure that both commands execute in a transaction, so the key will either be retrieved and deleted or not retrieved at all.</p>\n"}], "owner": {"reputation": 179, "user_id": 743552, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a53032d16a9b7fa04ee49385acb07749?s=128&d=identicon&r=PG", "display_name": "Sunil Kumar Mohanty", "link": "https://stackoverflow.com/users/743552/sunil-kumar-mohanty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 44659129, "answer_count": 1, "score": 0, "last_activity_date": 1618973837, "creation_date": 1497969507, "question_id": 44656095, "link": "https://stackoverflow.com/questions/44656095/best-way-to-store-a-single-time-use-record-in-redis-using-golang", "title": "best way to store a single time use record in redis using golang", "body": "<p>I am using golang and go-redis package\nI would like to store a key-value pair in redis (e.g one time token). When this token is read, I generate a permanent token. But the one time token should be deleted once I have read the value. This is to avoid fast-replay attack. What is the best way to implement this. I have been thinking of mutex.</p>\n"}, {"tags": ["go", "webhooks", "google-home"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497967413, "post_id": 44655150, "comment_id": 76295810, "body": "Yes, the <code>$</code> indicates a command prompt. Luckily the go tools and ngrok are both available for Windows."}, {"owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "edited": false, "score": 0, "creation_date": 1497967783, "post_id": 44655150, "comment_id": 76296151, "body": "where is your go code file? I suppose that it&#39;s not under GOROOT, please, show output of <code>pwd</code> command from terminal."}, {"owner": {"reputation": 11, "user_id": 8188965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1102d2a51bbe60c756d6a1c6d161280?s=128&d=identicon&r=PG&f=1", "display_name": "user8188965", "link": "https://stackoverflow.com/users/8188965/user8188965"}, "edited": false, "score": 0, "creation_date": 1497968420, "post_id": 44655150, "comment_id": 76296651, "body": "my go file is located on my desktop. Is the issue the location of the file? The installer put Go distribution in c:\\Go."}, {"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1497988916, "post_id": 44655150, "comment_id": 76309644, "body": "don&#39;t know why this got so many downvotes.  people should comment as to why they downvoted."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8188965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1102d2a51bbe60c756d6a1c6d161280?s=128&d=identicon&r=PG&f=1", "display_name": "user8188965", "link": "https://stackoverflow.com/users/8188965/user8188965"}, "edited": false, "score": 0, "creation_date": 1497968476, "post_id": 44655596, "comment_id": 76296689, "body": "thanks! I tried installing Go earlier and I guess I must have made a mistake."}, {"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "reply_to_user": {"reputation": 11, "user_id": 8188965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1102d2a51bbe60c756d6a1c6d161280?s=128&d=identicon&r=PG&f=1", "display_name": "user8188965", "link": "https://stackoverflow.com/users/8188965/user8188965"}, "edited": false, "score": 0, "creation_date": 1497988873, "post_id": 44655596, "comment_id": 76309619, "body": "If you use the Windows package, it should have created the environment variables already.  You&#39;d have to close and reopen any CMD prompts to enable the m (or reboot).  If you downloaded just the zip, the Installation instructions in the line above would have the required PATH names that need to be added."}], "tags": [], "owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "is_accepted": true, "score": 0, "last_activity_date": 1497971132, "last_edit_date": 1497971132, "creation_date": 1497968259, "answer_id": 44655596, "question_id": 44655150, "link": "https://stackoverflow.com/questions/44655150/stuck-on-google-home-tutorial/44655596#44655596", "title": "Stuck on Google Home Tutorial", "body": "<p>The error means you do not have Go installed.</p>\n\n<p>You need to install <code>go</code>, also known as <a href=\"https://golang.org/doc/install\" rel=\"nofollow noreferrer\">Golang</a> to run that example code they provide on Step 4.</p>\n\n<p>Make sure to follow the installation instructions as well.</p>\n\n<p>It was just an example.  You can write the code in any language as well.</p>\n"}], "owner": {"reputation": 11, "user_id": 8188965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1102d2a51bbe60c756d6a1c6d161280?s=128&d=identicon&r=PG&f=1", "display_name": "user8188965", "link": "https://stackoverflow.com/users/8188965/user8188965"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "accepted_answer_id": 44655596, "answer_count": 1, "score": -2, "last_activity_date": 1497971132, "creation_date": 1497967082, "last_edit_date": 1497968407, "question_id": 44655150, "link": "https://stackoverflow.com/questions/44655150/stuck-on-google-home-tutorial", "title": "Stuck on Google Home Tutorial", "body": "<p>I am working on an intro to Actions on Google tutorial. I made it to page 4 and I am stuck on the \"Fulfillment Webhook and Deployment\" stage. I put the sample backend code into a Go file called populationai.go. I'm confused as to how to do the commands listed in the \"Using ngrok to locally run the Webhook\" section in Windows, as they are designed for a different operating system. Should I be doing these steps in the command prompt of Windows in the first place? Thanks.</p>\n\n<p><a href=\"https://www.programmableweb.com/news/how-to-get-started-google-actions/how-to/2017/01/31?page=4\" rel=\"nofollow noreferrer\">https://www.programmableweb.com/news/how-to-get-started-google-actions/how-to/2017/01/31?page=4</a></p>\n\n<p>Here are the steps I'm confused on:</p>\n\n<ol>\n<li><p>We start up the Go application, which exposes the API Server via go run populationapi.go</p>\n\n<pre><code>$ go run populationapi.go\n</code></pre></li>\n<li><p>We start ngrok to expose a secure public tunnel on port 9000 via the following command:</p>\n\n<pre><code>$ ngrok http 9000\n</code></pre></li>\n</ol>\n\n<p>Edit: every time I try the \"go run populationapi.go\" command it says</p>\n\n<p>'go' is not recognized as an internal or external command,\noperable program or batch file.</p>\n\n<p>Edit: my go file is located on my desktop. Is the issue the location of the file? The installer put Go distribution in c:\\Go.</p>\n"}, {"tags": ["mongodb", "go", "webserver", "mgo", "go-gin"], "comments": [{"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 1, "creation_date": 1497966375, "post_id": 44654020, "comment_id": 76294963, "body": "I think the line <code>panic(&quot;Key \\&quot;&quot; + key + &quot;\\&quot; does not exist&quot;)</code> holds the key to the problem."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5052828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6qPNE.jpg?s=128&g=1", "display_name": "007", "link": "https://stackoverflow.com/users/5052828/007"}, "edited": false, "score": 0, "creation_date": 1497975437, "post_id": 44655552, "comment_id": 76301697, "body": "please help me out i just changed the db to smartpoll, but still have errors"}, {"owner": {"reputation": 15, "user_id": 5052828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6qPNE.jpg?s=128&g=1", "display_name": "007", "link": "https://stackoverflow.com/users/5052828/007"}, "edited": false, "score": 0, "creation_date": 1497997061, "post_id": 44655552, "comment_id": 76313332, "body": "my request is 500"}, {"owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "reply_to_user": {"reputation": 15, "user_id": 5052828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6qPNE.jpg?s=128&g=1", "display_name": "007", "link": "https://stackoverflow.com/users/5052828/007"}, "edited": false, "score": 0, "creation_date": 1498025573, "post_id": 44655552, "comment_id": 76320991, "body": "It&#39;s your response(what server tell to you), I&#39;m asking about request(what you&#39;re sending to the server)"}, {"owner": {"reputation": 15, "user_id": 5052828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6qPNE.jpg?s=128&g=1", "display_name": "007", "link": "https://stackoverflow.com/users/5052828/007"}, "edited": false, "score": 0, "creation_date": 1498037165, "post_id": 44655552, "comment_id": 76328303, "body": "GET request to display the polls from the database"}, {"owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "reply_to_user": {"reputation": 15, "user_id": 5052828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6qPNE.jpg?s=128&g=1", "display_name": "007", "link": "https://stackoverflow.com/users/5052828/007"}, "edited": false, "score": 0, "creation_date": 1498037943, "post_id": 44655552, "comment_id": 76328884, "body": "@007 can you show exactly what/how you&#39;re requesting? what command or code do you execute?"}, {"owner": {"reputation": 15, "user_id": 5052828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6qPNE.jpg?s=128&g=1", "display_name": "007", "link": "https://stackoverflow.com/users/5052828/007"}, "edited": false, "score": 0, "creation_date": 1498039296, "post_id": 44655552, "comment_id": 76329901, "body": "localhost:5000/polls"}, {"owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "reply_to_user": {"reputation": 15, "user_id": 5052828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6qPNE.jpg?s=128&g=1", "display_name": "007", "link": "https://stackoverflow.com/users/5052828/007"}, "edited": false, "score": 0, "creation_date": 1498039438, "post_id": 44655552, "comment_id": 76330017, "body": "So you have 0 params in your request, but you&#39;re expecting param &quot;db&quot;, do something like <code>localhost:5000&#47;polls?db=&lt;your_database_name&gt;</code>"}, {"owner": {"reputation": 15, "user_id": 5052828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6qPNE.jpg?s=128&g=1", "display_name": "007", "link": "https://stackoverflow.com/users/5052828/007"}, "edited": false, "score": 0, "creation_date": 1498041564, "post_id": 44655552, "comment_id": 76331493, "body": "My code is on github gist pls help me review, thanks <a href=\"https://gist.github.com/kebeeyong/fbd1c3e2ee843d2617d2ef9ef4fdca85\" rel=\"nofollow noreferrer\">gist.github.com/kebeeyong/fbd1c3e2ee843d2617d2ef9ef4fdca85</a>"}, {"owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "reply_to_user": {"reputation": 15, "user_id": 5052828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6qPNE.jpg?s=128&g=1", "display_name": "007", "link": "https://stackoverflow.com/users/5052828/007"}, "edited": false, "score": 0, "creation_date": 1498042999, "post_id": 44655552, "comment_id": 76332489, "body": "@007 <code>localhost:5000&#47;polls?db=smartpoll</code> should work"}, {"owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "reply_to_user": {"reputation": 15, "user_id": 5052828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6qPNE.jpg?s=128&g=1", "display_name": "007", "link": "https://stackoverflow.com/users/5052828/007"}, "edited": false, "score": 0, "creation_date": 1498045648, "post_id": 44655552, "comment_id": 76334346, "body": "@007 please, show output for <code>show databases</code> in mongo shell"}, {"owner": {"reputation": 15, "user_id": 5052828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6qPNE.jpg?s=128&g=1", "display_name": "007", "link": "https://stackoverflow.com/users/5052828/007"}, "edited": false, "score": 0, "creation_date": 1498047483, "post_id": 44655552, "comment_id": 76335715, "body": "<code>&#47;* 0 *&#47; {     &quot;_id&quot; : ObjectId(&quot;58d9cf1cdf353f3d2f5951b4&quot;),     &quot;id&quot; : &quot;1&quot;,     &quot;firstname&quot; : &quot;Sam&quot;,     &quot;lastname&quot; : &quot;Smith&quot;,     &quot;poll&quot; : &quot;Who is the Richest Man in the World&quot; }</code>"}], "tags": [], "owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "is_accepted": false, "score": 0, "last_activity_date": 1497968142, "creation_date": 1497968142, "answer_id": 44655552, "question_id": 44654020, "link": "https://stackoverflow.com/questions/44654020/errors-getting-list-of-polls-from-mongodb-with-go-gin-and-mgo/44655552#44655552", "title": "Errors Getting list of polls from mongoDB with go-gin and mgo", "body": "<p>There is no variable named \"db\" in your request.</p>\n\n<p>When you're executing <code>c.MustGet(\"db\")</code> you're assure that there is a param with this name, but it isn't presented.</p>\n\n<p><a href=\"https://github.com/gin-gonic/gin/blob/master/context.go#L180\" rel=\"nofollow noreferrer\">Gin code which panics</a></p>\n\n<p>You need to pass \"db\" name in to your request. </p>\n\n<p>Better solution: if it's not present return HTTP error 400 Bad request.</p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 5052828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6qPNE.jpg?s=128&g=1", "display_name": "007", "link": "https://stackoverflow.com/users/5052828/007"}, "edited": false, "score": 0, "creation_date": 1498158683, "post_id": 44684143, "comment_id": 76397989, "body": "server errors gone but output of GET doesn&#39;t return Database contents, instead i get dis {&quot;_id&quot;:&quot;ID&quot;,&quot;firstname&quot;:&quot;Firstname&quot;,&quot;lastname&quot;:&quot;Lastname&quot;,&quot;p&zwnj;&#8203;oll&quot;:{}} as output of local:5000/polls"}, {"owner": {"reputation": 15, "user_id": 5052828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6qPNE.jpg?s=128&g=1", "display_name": "007", "link": "https://stackoverflow.com/users/5052828/007"}, "edited": false, "score": 0, "creation_date": 1498159204, "post_id": 44684143, "comment_id": 76398267, "body": "<a href=\"https://gist.github.com/kebeeyong/fbd1c3e2ee843d2617d2ef9ef4fdca85\" rel=\"nofollow noreferrer\">gist.github.com/kebeeyong/fbd1c3e2ee843d2617d2ef9ef4fdca85</a> my updated code on git gist with your sugestion. @Aravind"}, {"owner": {"reputation": 349, "user_id": 7190910, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TOy3-gflA_c/AAAAAAAAAAI/AAAAAAAAAAo/TUKvdFNljDo/photo.jpg?sz=128", "display_name": "Aravind", "link": "https://stackoverflow.com/users/7190910/aravind"}, "reply_to_user": {"reputation": 15, "user_id": 5052828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6qPNE.jpg?s=128&g=1", "display_name": "007", "link": "https://stackoverflow.com/users/5052828/007"}, "edited": false, "score": 0, "creation_date": 1498163676, "post_id": 44684143, "comment_id": 76400722, "body": "I have added the changes you have to do in the above answer itself check it out"}, {"owner": {"reputation": 15, "user_id": 5052828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6qPNE.jpg?s=128&g=1", "display_name": "007", "link": "https://stackoverflow.com/users/5052828/007"}, "edited": false, "score": 1, "creation_date": 1498192045, "post_id": 44684143, "comment_id": 76408498, "body": "Works Perfectly, Thank you very much friend"}, {"owner": {"reputation": 15, "user_id": 5052828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6qPNE.jpg?s=128&g=1", "display_name": "007", "link": "https://stackoverflow.com/users/5052828/007"}, "edited": false, "score": 0, "creation_date": 1499255594, "post_id": 44684143, "comment_id": 76826314, "body": "hi @Aravind i thank you for your help so far, i i&#39;m trying to get posts by id but i&#39;m having errors &quot;can&#39;t marshal string ....&quot; my code on git gist <a href=\"https://gist.github.com/kebeeyong/cd7ba6f9bccc100e89e00a4035677fff\" rel=\"nofollow noreferrer\">gist.github.com/kebeeyong/cd7ba6f9bccc100e89e00a4035677fff</a>   the func pollsByID"}], "tags": [], "owner": {"reputation": 349, "user_id": 7190910, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TOy3-gflA_c/AAAAAAAAAAI/AAAAAAAAAAo/TUKvdFNljDo/photo.jpg?sz=128", "display_name": "Aravind", "link": "https://stackoverflow.com/users/7190910/aravind"}, "is_accepted": true, "score": 1, "last_activity_date": 1498163632, "last_edit_date": 1498163632, "creation_date": 1498071370, "answer_id": 44684143, "question_id": 44654020, "link": "https://stackoverflow.com/questions/44654020/errors-getting-list-of-polls-from-mongodb-with-go-gin-and-mgo/44684143#44684143", "title": "Errors Getting list of polls from mongoDB with go-gin and mgo", "body": "<p>To get the database object (db) from the gin context (c) <code>c.MustGet(\"db\").(*mgo.Database)</code> you have to first set it using a gin middleware function</p>\n\n<pre><code>func ConnectMiddleware(c *gin.Context) {\n    c.Set(\"db\", Session.DB(Mongo.Database))\n    c.Next()\n}\n</code></pre>\n\n<p>and then use this middleware through the following code</p>\n\n<pre><code>router := gin.Default()\nrouter.Use(ConnectMiddleware)\nrouter.GET(\"/\", func(c *gin.Context) {\n    c.JSON(http.StatusOK, gin.H{\"message\": \"OK\"})\n\n})\nrouter.GET(\"/polls\", allPolls)\n</code></pre>\n\n<p>You are using a outdated version of gin library other things are fine in your code</p>\n\n<p>import the latest package form <code>github.com/gin-gonic/gin</code> </p>\n\n<p>Use this to get the data from the database</p>\n\n<pre><code>func allPolls(c *gin.Context) {\n    db := c.MustGet(\"db\").(*mgo.Database)\n    polls := []Poll{}\n    err := db.C(CollectionPoll).Find(nil).All(&amp;polls)\n    if err != nil {\n        c.Error(err)\n    }\n    result := gin.H{\"payload\": polls}\n    c.Writer.Header().Set(\"Content-Type\", \"application/json\")\n    c.JSON(200, result)\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5052828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6qPNE.jpg?s=128&g=1", "display_name": "007", "link": "https://stackoverflow.com/users/5052828/007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 480, "favorite_count": 0, "accepted_answer_id": 44684143, "answer_count": 2, "score": 1, "last_activity_date": 1498194011, "creation_date": 1497964228, "last_edit_date": 1498194011, "question_id": 44654020, "link": "https://stackoverflow.com/questions/44654020/errors-getting-list-of-polls-from-mongodb-with-go-gin-and-mgo", "title": "Errors Getting list of polls from mongoDB with go-gin and mgo", "body": "<p>Hi  trying to build a web service with go-gin and mgo on the Go language, i have a database with mongoDB but each time i try to GET polls from the database I get errors from the folowing errors from the Go webserver.</p>\n\n<pre><code>    2:00:16 PM web.1 |      gopanic: reflectcall(nil, unsafe.Pointer(d.fn), deferArgs(d), uint32(d.siz), uint32(d.siz))\n    2:00:16 PM web.1 |  /home/go/src/gopkg.in/gin-gonic/gin.v1/context.go:180 (0x4e1eb1)\n    2:00:16 PM web.1 |      (*Context).MustGet: panic(\"Key \\\"\" + key + \"\\\" does not exist\")\n    2:00:16 PM web.1 |  /home/go/src/smartpoll/main.go:139 (0x401655)\n    2:00:16 PM web.1 |      allPolls: db := c.MustGet(\"db\").(*mgo.Database)\n    2:00:16 PM web.1 |  /home/go/src/gopkg.in/gin-gonic/gin.v1/context.go:97 (0x4e187a)\n    2:00:16 PM web.1 |      (*Context).Next: c.handlers[c.index](c)\n    2:00:16 PM web.1 |  /home/go/src/gopkg.in/gin-gonic/gin.v1/recovery.go:45 (0x4f165a)\n    2:00:16 PM web.1 |      RecoveryWithWriter.func1: c.Next()\n    2:00:16 PM web.1 |  /home/go/src/gopkg.in/gin-gonic/gin.v1/context.go:97 (0x4e187a)\n    2:00:16 PM web.1 |      (*Context).Next: c.handlers[c.index](c)\n    2:00:16 PM web.1 |  /home/go/src/gopkg.in/gin-gonic/gin.v1/logger.go:72 (0x4f074f)\n    2:00:16 PM web.1 |      LoggerWithWriter.func1: c.Next()\n    2:00:16 PM web.1 |  /home/go/src/gopkg.in/gin-gonic/gin.v1/context.go:97 (0x4e187a)\n    2:00:16 PM web.1 |      (*Context).Next: c.handlers[c.index](c)\n    2:00:16 PM web.1 |  /home/go/src/gopkg.in/gin-gonic/gin.v1/gin.go:284 (0x4e7c0e)\n    2:00:16 PM web.1 |      (*Engine).handleHTTPRequest: context.Next()\n    2:00:16 PM web.1 |  /home/go/src/gopkg.in/gin-gonic/gin.v1/gin.go:265 (0x4e74f0)\n    2:00:16 PM web.1 |      (*Engine).ServeHTTP: engine.handleHTTPRequest(c)\n    2:00:16 PM web.1 |  /home/kebe/golang/go/src/net/http/server.go:2202 (0x4b249d)\n    2:00:16 PM web.1 |      serverHandler.ServeHTTP: handler.ServeHTTP(rw, req)\n    2:00:16 PM web.1 |  /home/kebe/golang/go/src/net/http/server.go:1579 (0x4aee07)\n    2:00:16 PM web.1 |      (*conn).serve: serverHandler{c.server}.ServeHTTP(w, w.req)\n    2:00:16 PM web.1 |  /home/kebe/golang/go/src/runtime/asm_amd64.s:2086 (0x45a081)\n    2:00:16 PM web.1 |      goexit: BYTE    $0x90   // NOP\n    2:00:16 PM web.1 |  \n    2:00:16 PM web.1 |  [GIN] 2017/06/20 - 14:00:16 | 500 |  753.521212ms | 127.0.0.1 |   GET     /polls\n</code></pre>\n\n<p>My Code is as follows</p>\n\n<pre><code>package main\n\nimport (\n\n    \"fmt\"\n    \"log\"\n    \"net/http\"  \n    \"os\"\n\n    \"gopkg.in/gin-gonic/gin.v1\"\n    \"gopkg.in/mgo.v2\"\n\n)\n\ntype Poll struct {\n    ID        string `json:\"id,omitempty\"`\n    Firstname string `json:\"firstname,omitempty\"`\n    Lastname  string `json:\"lastname,omitempty\"`\n    Poll      string `json:\"poll,omitempty\"`\n\n}\n\nvar (\n    // Session stores mongo session\n    Session *mgo.Session\n\n    // Mongo stores the mongodb connection string information\n    Mongo *mgo.DialInfo\n)\n\nconst (\n    // MongoDBUrl is the default mongodb url that will be used to connect to the\n    // database.\n    MongoDBUrl = \"mongodb://localhost:27017/smartpoll\"\n\n        // CollectionPoll holds the name of the articles collection\n    CollectionPoll = \"polls\"\n)\n\n// Connect connects to mongodb\nfunc Connect() {\n    uri := os.Getenv(\"MONGODB_URL\")\n\n    if len(uri) == 0 {\n        uri = MongoDBUrl\n    }\n\n    mongo, err := mgo.ParseURL(uri)\n    s, err := mgo.Dial(uri)\n    if err != nil {\n        fmt.Printf(\"Can't connect to mongo, go error %v\\n\", err)\n        panic(err.Error())\n    }\n    s.SetSafe(&amp;mgo.Safe{})\n    fmt.Println(\"Connected to\", uri)\n    Session = s\n    Mongo = mongo\n}\n\n\nfunc init() {\n    Connect()\n}\n\nfunc main() {\n    port := os.Getenv(\"PORT\")\n\n    if port == \"\" {\n        log.Fatal(\"$PORT must be set\")\n    }\n\n\n\n    router := gin.Default()\n\n    router.GET(\"/\", func (c *gin.Context) {\n        c.JSON(http.StatusOK, gin.H{\"message\": \"OK\"})\n\n    })\n    router.GET(\"/polls\", allPolls)\n    router.Run(\":\" + port)\n}\n\n\n\nfunc allPolls(c *gin.Context) {\n    db := c.MustGet(\"db\").(*mgo.Database)\n    polls := []Poll{}\n    poll := db.C(CollectionPoll).Find(&amp;polls)\n\n    c.JSON(http.StatusOK, gin.H{\n\n        \"_id\": \"ID\",\n        \"firstname\": \"Firstname\",\n        \"lastname\": \"Lastname\",\n        \"poll\": poll,\n        })\n}\n</code></pre>\n\n<p>My DB is as follows:</p>\n\n<pre><code>/* 0 */\n{\n    \"_id\" : ObjectId(\"58d9cf1cdf353f3d2f5951b4\"),\n    \"id\" : \"1\",\n    \"firstname\" : \"Sam\",\n    \"lastname\" : \"Smith\",\n    \"poll\" : \"Who is the Richest Man in the World\"\n}\n</code></pre>\n"}, {"tags": ["c", "go", "binary", "executable"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 2, "creation_date": 1497966480, "post_id": 44653960, "comment_id": 76295048, "body": "How did you get into the situation of having an executable binary that&#39;s not stored on disk? Just asking because I <i>think</i> there might be a better way to solve the original issue..."}, {"owner": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "edited": false, "score": 0, "creation_date": 1497966724, "post_id": 44653960, "comment_id": 76295243, "body": "this is just a hypothetical issue. I am planning to make an app that will need this sort of information basically i can pack some tools with my app  and run them as needed from the dashboard of my app  without writing them to the disc and when i am done no temp files will be on the disc all in memory @FelixPalmen"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1497966964, "post_id": 44653960, "comment_id": 76295448, "body": "I don&#39;t think you should do this. E.g. on a linux system, you would just create a package that installs these tools to <code>$(prefix)&#47;lib&#47;$(package)&#47;</code> or <code>$(prefix)&#47;libexec&#47;$(package)&#47;</code>. On windows, they would go somewhere inside your program directory."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1497967620, "post_id": 44653960, "comment_id": 76296008, "body": "&quot;pack some tools&quot;? As in precompiled programs? Forget it. It&#39;s not very hard to execute arbitrary pieces of code by changing memory protection on a region. It&#39;s a completely different beast to properly parse a program, correctly load it into memory at the right offsets, set up the stack correctly for execution. Half of the things you&#39;d need to implement here aren&#39;t even properly documented. Even if it was a statically linked PIE binary, it&#39;s still a lot of work. Your best bet is to make the &quot;apps&quot; part of your main program and call them as normal functions."}, {"owner": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "edited": false, "score": 0, "creation_date": 1497969168, "post_id": 44653960, "comment_id": 76297239, "body": "well the point is that i dont have access to source code of all the pieces so i thought it could be nice just run them inlined but what i understand from your comment it is easier to write them to tmp folder and let the os execute them as needed is simpler"}, {"owner": {"reputation": 4259, "user_id": 2516916, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/90d670e62ae35e180ad6e939443cab62?s=128&d=identicon&r=PG", "display_name": "Gillespie", "link": "https://stackoverflow.com/users/2516916/gillespie"}, "edited": false, "score": 0, "creation_date": 1497971890, "post_id": 44653960, "comment_id": 76299335, "body": "One solution could be to partition a RAMDisk and then read and write the executable to RAMDisk."}, {"owner": {"reputation": 887, "user_id": 8099995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WLnoV.png?s=128&g=1", "display_name": "berserkk", "link": "https://stackoverflow.com/users/8099995/berserkk"}, "edited": false, "score": 0, "creation_date": 1497983829, "post_id": 44653960, "comment_id": 76306692, "body": "This is possible duplicate of these questions: <a href=\"https://stackoverflow.com/questions/3553875/load-an-exe-file-and-run-it-from-memory\" title=\"load an exe file and run it from memory\">stackoverflow.com/questions/3553875/&hellip;</a> and <a href=\"https://stackoverflow.com/questions/305203/createprocess-from-memory-buffer\" title=\"createprocess from memory buffer\">stackoverflow.com/questions/305203/&hellip;</a>. Also, I don&#39;t understand, why you accepted answer, that not even nearly answers to your question."}], "answers": [{"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1497964875, "post_id": 44654062, "comment_id": 76293760, "body": "That only the easy part. What about relocation and loading of external components such as .so files?"}, {"owner": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "edited": false, "score": 0, "creation_date": 1497965181, "post_id": 44654062, "comment_id": 76294001, "body": "adding a small piece of code could be so nice me to understand. what i understand from the man page below <a href=\"https://ws1.sinaimg.cn/large/006tKfTcgy1fgrzfy90qtj31260qemyr.jpg\" rel=\"nofollow noreferrer\">ws1.sinaimg.cn/large/006tKfTcgy1fgrzfy90qtj31260qemyr.jpg</a>  I need to pass the address length and prot_exec but there is still a problem in order to get the memory address I need to use unsafe pointers and malloc it by myself since using go afaik there is no way to deal with the addresses manually and lets assume i have done that how can i actually execute the bytes thats the challenge how to jump there as you say @neroku"}, {"owner": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1497965247, "post_id": 44654062, "comment_id": 76294046, "body": "@MichaelWalz that&#39;s not really an issue if your binary is written in pure go since it is statically linked all it needs is itself"}, {"owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "reply_to_user": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "edited": false, "score": 1, "creation_date": 1497967246, "post_id": 44654062, "comment_id": 76295667, "body": "@nikoss you can start executing the code in C by means of a function pointer: by setting the pointer to the address where the code is located and performing the call"}], "tags": [], "owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "is_accepted": false, "score": 4, "last_activity_date": 1497964334, "creation_date": 1497964334, "answer_id": 44654062, "question_id": 44653960, "link": "https://stackoverflow.com/questions/44653960/how-can-i-execute-an-executable-from-memory/44654062#44654062", "title": "How can i execute an executable from memory?", "body": "<p>In C and assuming Linux, you can change the protection of a memory region by means of the <code>mprotect()</code> system call, so that it can be executed (i.e.: turn a <em>data region</em> into a <em>code region</em>). After that, you could execute that region of memory by <em>jumping</em> into it.</p>\n"}], "owner": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2255, "favorite_count": 2, "answer_count": 1, "score": 8, "last_activity_date": 1497964334, "creation_date": 1497964088, "question_id": 44653960, "link": "https://stackoverflow.com/questions/44653960/how-can-i-execute-an-executable-from-memory", "title": "How can i execute an executable from memory?", "body": "<p>Let's say I have included a binary into my program during compilation so, I keep it in a variable something like\n<code>var myExec =[]byte{'s','o','m','e',' ','b','y','t','e','s'}</code>\nSo my question is whether there is a way to execute this binary within my program without writing it back to the disc and calling exec or fork on it?\nI am writing my app in Golang so the method I am seeking for is to do it using Go or C (using CGO).</p>\n\n<p>Basically, I am seeking something like piping the bash script into bash just I don't know where can I pipe the bytes of a native executable to run it and writing it back to disk and then letting os to read it again seems a lot of extra work to be done</p>\n"}, {"tags": ["debugging", "go", "emacs"], "comments": [{"owner": {"reputation": 27385, "user_id": 729907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HeXcc.png?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/729907/drew"}, "edited": false, "score": 0, "creation_date": 1497966955, "post_id": 44652207, "comment_id": 76295436, "body": "Please complete this question so that it is pretty much standalone. Summarize the other question or whatever, to make this question intelligible on its own. As it stands now the question is itself unclear."}, {"owner": {"reputation": 23, "user_id": 3461506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460f19cc9c90e851ec4eea987c6ebfaa?s=128&d=identicon&r=PG&f=1", "display_name": "tomatopeel", "link": "https://stackoverflow.com/users/3461506/tomatopeel"}, "reply_to_user": {"reputation": 27385, "user_id": 729907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HeXcc.png?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/729907/drew"}, "edited": false, "score": 0, "creation_date": 1497968527, "post_id": 44652207, "comment_id": 76296738, "body": "@Drew fixed the question and figured out the answer and posted it, thanks for the feedback."}, {"owner": {"reputation": 27385, "user_id": 729907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HeXcc.png?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/729907/drew"}, "edited": false, "score": 0, "creation_date": 1497969933, "post_id": 44652207, "comment_id": 76297877, "body": "Thanks...................."}], "answers": [{"comments": [{"owner": {"reputation": 65926, "user_id": 324105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b1ad4e4bdf8feaef18504593914fe16?s=128&d=identicon&r=PG", "display_name": "phils", "link": "https://stackoverflow.com/users/324105/phils"}, "edited": false, "score": 0, "creation_date": 1498036937, "post_id": 44655676, "comment_id": 76328122, "body": "Indeed, any issue along the lines of &quot;the results of running a command from Emacs are different to running the same command outside Emacs&quot; is very likely to be related to environment variables."}], "tags": [], "owner": {"reputation": 23, "user_id": 3461506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460f19cc9c90e851ec4eea987c6ebfaa?s=128&d=identicon&r=PG&f=1", "display_name": "tomatopeel", "link": "https://stackoverflow.com/users/3461506/tomatopeel"}, "is_accepted": true, "score": 1, "last_activity_date": 1497968480, "creation_date": 1497968480, "answer_id": 44655676, "question_id": 44652207, "link": "https://stackoverflow.com/questions/44652207/elisp-calling-go-code-with-different-result/44655676#44655676", "title": "Elisp Calling Go Code with Different Result", "body": "<p>The issue was that Emacs was not aware of my <code>GOPATH</code> environment variable, this was resolved by adding this to <code>exec-path-from-shell-copy-envs</code> in my initialization files, like so:</p>\n\n<pre><code>(exec-path-from-shell-copy-envs '(\"PATH\" \"GOPATH\"))\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 3461506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460f19cc9c90e851ec4eea987c6ebfaa?s=128&d=identicon&r=PG&f=1", "display_name": "tomatopeel", "link": "https://stackoverflow.com/users/3461506/tomatopeel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 44655676, "answer_count": 1, "score": 0, "last_activity_date": 1497968480, "creation_date": 1497959185, "last_edit_date": 1497968332, "question_id": 44652207, "link": "https://stackoverflow.com/questions/44652207/elisp-calling-go-code-with-different-result", "title": "Elisp Calling Go Code with Different Result", "body": "<p><a href=\"https://github.com/dominikh/go-mode.el/issues/200\" rel=\"nofollow noreferrer\">This question is on the back of this GitHub issue</a>, when executing <code>godef-jump</code> on code on some named imports (but not all), it fails with the error that <code>godef: no declaration found for &lt;the gx.thing we're godef-jump'ing&gt;</code>.</p>\n\n<p>Basically I'm a bit stuck with where to go next in my debugging. I've changed the code in <code>go-mode.el</code> to use the <code>-debug</code> flag with <code>godef</code>, and the outputs are different, from CLI is successful like this:</p>\n\n<pre><code>$ godef -f main.go gx.GetPackageRoot\n/home/tomato/ipfs/src/github.com/whyrusleeping/gx/gxutil/pm.go:50:6\n</code></pre>\n\n<p>Whereas in Emacs it fails with the <code>godef: no declaration found for &lt;the gx.thing we're godef-jump'ing&gt;</code> error.</p>\n\n<p>With the debug flag enabled, CLI:</p>\n\n<pre><code>$ godef -debug -t -f /home/tomato/ipfs/src/github.com/whyrusleeping/gx/main.go -o 565\n2017/06/20 13:29:14 exprType tuple:false pkg: *ast.SelectorExpr gx.GetPackageRoot [\n2017/06/20 13:29:14 exprType tuple:false pkg: *ast.Ident gx [\n2017/06/20 13:29:14 exprType tuple:false pkg: *ast.ImportSpec gx \"github.com/whyrusleeping/gx/gxutil\" [\n2017/06/20 13:29:14 ] -&gt; 0x0, Type{package \"\" *ast.ImportSpec gx \"github.com/whyrusleeping/gx/gxutil\"}\n2017/06/20 13:29:14 ] -&gt; 0xc420276140, Type{package \"\" *ast.ImportSpec gx \"github.com/whyrusleeping/gx/gxutil\"}\n2017/06/20 13:29:14 member Type{package \"\" *ast.ImportSpec gx \"github.com/whyrusleeping/gx/gxutil\"} 'GetPackageRoot' {\n2017/06/20 13:29:14 } -&gt; &amp;{func GetPackageRoot 0xc4203ac3f0 &lt;nil&gt; &lt;nil&gt;}\n2017/06/20 13:29:14 exprType tuple:false pkg: *ast.Ident GetPackageRoot [\n2017/06/20 13:29:14 exprType tuple:false pkg: *ast.FuncType func() (string, error) [\n2017/06/20 13:29:14 ] -&gt; 0x0, Type{type \"\" *ast.FuncType func() (string, error)}\n2017/06/20 13:29:14 ] -&gt; 0xc420138140, Type{func \"\" *ast.FuncType func() (string, error)}\n2017/06/20 13:29:14 ] -&gt; 0xc420138140, Type{func \"github.com/whyrusleeping/gx/gxutil\" *ast.FuncType func() (string, error)}\n/home/tomato/ipfs/src/github.com/whyrusleeping/gx/gxutil/pm.go:50:6\nGetPackageRoot func() (string, error)\n</code></pre>\n\n<p>Emacs:</p>\n\n<pre><code>2017/06/20 13:31:18 exprType tuple:false pkg: *ast.SelectorExpr gx.GetPackageRoot [\n2017/06/20 13:31:18 exprType tuple:false pkg: *ast.Ident gx [\n2017/06/20 13:31:18 exprType tuple:false pkg: *ast.ImportSpec gx \"github.com/whyrusleeping/gx/gxutil\" [\n2017/06/20 13:31:18 ] -&gt; 0x0, Type{package \"\" *ast.ImportSpec gx \"github.com/whyrusleeping/gx/gxutil\"}\n2017/06/20 13:31:18 ] -&gt; 0xc4201fde50, Type{package \"\" *ast.ImportSpec gx \"github.com/whyrusleeping/gx/gxutil\"}\n2017/06/20 13:31:18 member Type{package \"\" *ast.ImportSpec gx \"github.com/whyrusleeping/gx/gxutil\"} 'GetPackageRoot' {\n2017/06/20 13:31:18 } -&gt; &lt;nil&gt;\n2017/06/20 13:31:18 ] -&gt; 0x0, Type{bad \"\" &lt;nil&gt; }\ngodef: no declaration found for gx.GetPackageRoot\n</code></pre>\n\n<p>I've used <code>strace</code> to confirm that the expected binary is being called with the expected flags.</p>\n\n<p>I guess the next thing I should do is find out where/how this <code>2017/06/20 13:29:14 member Type{package \"\" *ast.ImportSpec gx \"github.com/whyrusleeping/gx/gxutil\"} 'GetPackageRoot' {</code> line of output from the debugs is, since it is the next line of debug that differs, but maybe somebody has some better ideas or can already see what's going on here.</p>\n"}, {"tags": ["unit-testing", "go"], "comments": [{"owner": {"reputation": 139, "user_id": 2854211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YetLB.jpg?s=128&g=1", "display_name": "tivio", "link": "https://stackoverflow.com/users/2854211/tivio"}, "edited": false, "score": 1, "creation_date": 1497962192, "post_id": 44651266, "comment_id": 76291640, "body": "compare only the part of the string that doesn&#39;t contain the timestamp, if this is an option."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 1, "creation_date": 1497966273, "post_id": 44651266, "comment_id": 76294872, "body": "<a href=\"https://stackoverflow.com/questions/18970265/is-there-an-easy-way-to-stub-out-time-now-globally-in-golang-during-test\">This https://stackoverflow.com/questions/18970265/is-there-an-eas&zwnj;&#8203;y-way-to-stub-out-ti&zwnj;&#8203;me-now-globally-in-g&zwnj;&#8203;olang-during-test</a> may related to your question."}], "answers": [{"comments": [{"owner": {"reputation": 166, "user_id": 8087149, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2d87e6ae6e611403413dfa063800952e?s=128&d=identicon&r=PG&f=1", "display_name": "Gilrich", "link": "https://stackoverflow.com/users/8087149/gilrich"}, "edited": false, "score": 0, "creation_date": 1498025396, "post_id": 44654689, "comment_id": 76320923, "body": "This is exactly what I was looking for. Thank you. I didn&#39;t know that init() functions were possible."}], "tags": [], "owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "is_accepted": true, "score": 2, "last_activity_date": 1497965912, "creation_date": 1497965912, "answer_id": 44654689, "question_id": 44651266, "link": "https://stackoverflow.com/questions/44651266/comparing-current-time-in-unit-test/44654689#44654689", "title": "comparing current time in unit test", "body": "<p>You can stub functions like <code>time.Now()</code> in your <code>_test.go</code> files, via the <code>init()</code> function, this will give deterministic time values:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nvar timeNow = time.Now\n\nfunc main() {\n    fmt.Println(timeNow())\n}\n\nfunc init() {\n    // Uncomment and add to _test.go init()\n    // timeNow = func() time.Time {\n    //  t, _ := time.Parse(\"2006-01-02 15:04:05\", \"2017-01-20 01:02:03\")\n    //  return t\n    // }\n}\n</code></pre>\n\n<p>See: <a href=\"https://play.golang.org/p/hI6MrQGyDA\" rel=\"nofollow noreferrer\">https://play.golang.org/p/hI6MrQGyDA</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 15152008, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14Gjt6ps5CziJkjLjCIlMxeLFkFjxNTMVps6Mtthcsw=k-s128", "display_name": "Sagar Sonwane", "link": "https://stackoverflow.com/users/15152008/sagar-sonwane"}, "is_accepted": false, "score": 0, "last_activity_date": 1615538397, "creation_date": 1615538397, "answer_id": 66596670, "question_id": 44651266, "link": "https://stackoverflow.com/questions/44651266/comparing-current-time-in-unit-test/66596670#66596670", "title": "comparing current time in unit test", "body": "<p>we can stub time.Now() by using go package <strong>&quot;github.com/tkuchiki/faketime&quot;</strong>.</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;github.com/tkuchiki/faketime&quot;\n    &quot;time&quot;\n)\n\nfunc main() {\n    fmt.Println(&quot;Current Time Before Faking : &quot;, time.Now().UTC())\n\n    f := faketime.NewFaketime(2021, time.March, 01, 01, 01, 01, 0, time.UTC)\n    defer f.Undo()\n    f.Do()\n\n    fmt.Println(&quot;Current Time After Faking : &quot;, time.Now())\n\n}\n</code></pre>\n<p>Output from the above code is :</p>\n<pre><code>Current Time Before Faking :  2009-11-10 23:00:00 +0000 UTC\nCurrent Time After Faking :  2021-03-01 01:01:01 +0000 UTC\n</code></pre>\n<p>checkout the sample code : <a href=\"https://play.golang.org/p/9eaEtf7ZBAw\" rel=\"nofollow noreferrer\">go-playground sample</a></p>\n"}], "owner": {"reputation": 166, "user_id": 8087149, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2d87e6ae6e611403413dfa063800952e?s=128&d=identicon&r=PG&f=1", "display_name": "Gilrich", "link": "https://stackoverflow.com/users/8087149/gilrich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1661, "favorite_count": 0, "accepted_answer_id": 44654689, "answer_count": 2, "score": 3, "last_activity_date": 1615538397, "creation_date": 1497956592, "question_id": 44651266, "link": "https://stackoverflow.com/questions/44651266/comparing-current-time-in-unit-test", "title": "comparing current time in unit test", "body": "<p>I'm currently writing a unit test that compares to strings. The first string is generated using a function. The other one is hard coded and serves as reference. My problem is, that the function creating the first string injects the current time (time.Now()) with precision in seconds into the string. At the moment I do the same for the reference but this seems very ugly to me. My machine runs fast enough so that the test passes but I don't want to rely on that.</p>\n\n<p>What are general techniques to do such tests?</p>\n"}, {"tags": ["json", "go", "unmarshalling"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": false, "score": 1, "last_activity_date": 1497956600, "creation_date": 1497956600, "answer_id": 44651270, "question_id": 44650198, "link": "https://stackoverflow.com/questions/44650198/unmarshal-dynamic-json/44651270#44651270", "title": "Unmarshal Dynamic JSON", "body": "<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"encoding/json\"\n    \"errors\"\n    \"fmt\"\n)\n\ntype StreamMessage struct {\n    Data []*Data `json:\"data\"`\n    Ts   float64 `json:\"ts\"`\n}\n\ntype Data struct {\n    Type    string\n    XRate   *XRateData\n    Balance *BalanceData\n    Event   *EventData\n    Sync    *SyncData\n}\n\nfunc (d *Data) UnmarshalJSON(b []byte) error {\n    dec := json.NewDecoder(bytes.NewReader(b))\n    t, _ := dec.Token()\n    if delim, ok := t.(json.Delim); !ok || delim != '[' {\n        return errors.New(\"expecting data to be an array\")\n    }\n\n    if err := dec.Decode(&amp;d.Type); err != nil {\n        return err\n    }\n\n    var err error\n    switch d.Type {\n    case \"xrate\":\n        err = dec.Decode(&amp;d.XRate)\n    case \"sync\":\n        err = dec.Decode(&amp;d.Sync)\n    case \"balance\":\n        err = dec.Decode(&amp;d.Balance)\n    case \"event\":\n        err = dec.Decode(&amp;d.Event)\n    default:\n        return errors.New(\"unknown data type \" + d.Type)\n    }\n\n    if err != nil {\n        return err\n    }\n\n    t, _ = dec.Token()\n    if delim, ok := t.(json.Delim); !ok || delim != ']' {\n        return errors.New(\"expecting array to be two elements\")\n    }\n\n    return nil\n}\n\ntype XRateData struct {\n    Rate json.Number `json:\"rate\"`\n    CCY  string      `json:\"ccy\"`\n}\n\ntype BalanceData struct {\n    // TODO\n}\n\ntype EventData struct {\n    // TODO\n}\n\ntype SyncData struct {\n    Token string `json:\"Token\"`\n}\n\nvar streamSnapshot = []byte(\n\n    `{ \n   \"ts\": 1496244373.04,\n   \"data\":[\n      [\"xrate\", {\"rate\":1.2916,\"ccy\":\"USD\"}],\n      [\"balance\", \n         {\n            \"open_stake\":[\"GBP\", 0.0],\n            \"balance\":[\"GBP\", 0.0]\n         }\n      ],\n      [\"event\", \n         {\n            \"competition_id\":\"545\",\n            \"ir_status\":\"pre_event\",\n            \"start_time\":\"2017-09-10T17:00:00+00:00\",\n            \"competition_name\":\"USA NFL\",\n            \"event_id\":\"2017-09-10,21617,21635\",\n            \"home\":\"Buffalo Bills\",\n            \"away\":\"New York Jets\",\n            \"sport\":\"af\",\n            \"competition_country\":\"US\"\n         }\n      ],\n      [\"sync\", {\"Token\":\"eb1c57132d004f8d8fb967c076921fac\"}]\n   ]\n}`)\n\nfunc main() {\n    var sm StreamMessage\n    if err := json.Unmarshal(streamSnapshot, &amp;sm); err != nil {\n        panic(err)\n    }\n    fmt.Println(sm)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/ktABS6z40m\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ktABS6z40m</a></p>\n"}], "owner": {"reputation": 19, "user_id": 6996586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/324b851b04fe3ee36651a526f04afd90?s=128&d=identicon&r=PG", "display_name": "user4512219", "link": "https://stackoverflow.com/users/6996586/user4512219"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 533, "favorite_count": 0, "closed_date": 1498029957, "answer_count": 1, "score": 1, "last_activity_date": 1497956600, "creation_date": 1497953638, "last_edit_date": 1497954995, "question_id": 44650198, "link": "https://stackoverflow.com/questions/44650198/unmarshal-dynamic-json", "closed_reason": "Duplicate", "title": "Unmarshal Dynamic JSON", "body": "<p>I receive dynamic JSON from an API that follows this pattern:</p>\n\n<pre><code>{\n    \"ts\": timestamp,\n    \"data\": [\n        [ code1, payload1 ],\n        [ code2, payload2 ],\n        ...\n    ]\n}\n</code></pre>\n\n<p>For example the raw data will be:</p>\n\n<pre><code>    var streamSnapshot = []byte(\n\n`{ \n   \"ts\": 1496244373.04,\n   \"data\":[\n      [\"xrate\", {\"rate\":1.2916,\"ccy\":\"USD\"}],\n      [\"balance\", \n         {\n            \"open_stake\":[\"GBP\", 0.0],\n            \"balance\":[\"GBP\", 0.0]\n         }\n      ],\n      [\"event\", \n         {\n            \"competition_id\":\"545\",\n            \"ir_status\":\"pre_event\",\n            \"start_time\":\"2017-09-10T17:00:00+00:00\",\n            \"competition_name\":\"USA NFL\",\n            \"event_id\":\"2017-09-10,21617,21635\",\n            \"home\":\"Buffalo Bills\",\n            \"away\":\"New York Jets\",\n            \"sport\":\"af\",\n            \"competition_country\":\"US\"\n         }\n      ],\n      [\"sync\", {\"Token\":\"eb1c57132d004f8d8fb967c076921fac\"}]\n   ]\n}`)\n</code></pre>\n\n<p>Considering that we want to avoid unmarshalling to a struct like this:</p>\n\n<pre><code>type StreamMessage struct {\n    Data [][]interface{} `json:\"data\"`\n    Ts   float64         `json:\"ts\"`\n} \n</code></pre>\n\n<p>where we would have to cast the data back like:</p>\n\n<pre><code>    m := raw.(map[string]interface{})\n\n    switch messageType {\n    case XRATE:\n        xrate := XRate{\n            Message: Message{\n                Type:      XRATE,\n                TimeStamp: msg.Ts,\n            },\n            rate: m[\"rate\"].(float64),\n            ccy:  m[\"ccy\"].(string),\n        }  \n     ...\n</code></pre>\n\n<p>What would be the better way of unmarshalling this?</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1497971118, "post_id": 44648735, "comment_id": 76298793, "body": "The new Go 1.8 feature only works if the structures have the same field names and <i>types</i>.  Despite the fact that your Test2 and Test4 structures are identical by fields, they are two separate types, and thus the compiler disallows their assignment.  One might argue that structures should be deep-compared instead of a simple type comparison, but that&#39;s not how it&#39;s implemented currently.  You have three options: use the same struct type for the struct field in each, use an anonymous struct in each (<a href=\"https://play.golang.org/p/Hw7HANwqbZ\" rel=\"nofollow noreferrer\">play.golang.org/p/Hw7HANwqbZ</a>), or make a helper function to convert the two manually."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1497974122, "post_id": 44648735, "comment_id": 76300871, "body": "Reopened. @Kaedys wanna post that as an answer?"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1497978373, "post_id": 44648735, "comment_id": 76303469, "body": "Reposted as answer."}], "answers": [{"tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 3, "last_activity_date": 1497978266, "creation_date": 1497978266, "answer_id": 44659126, "question_id": 44648735, "link": "https://stackoverflow.com/questions/44648735/assigning-a-struct-having-one-of-its-fields-as-a-struct-to-another-struct-usin/44659126#44659126", "title": "Assigning a struct (Having one of its fields as a struct) to another struct using the feature introduced in Go 1.8", "body": "<p>The new Go 1.8 feature only works if the structures have the same field names and <em>types</em>. Despite the fact that your Test2 and Test4 structures are identical by fields, they are two separate types, and thus the compiler disallows their assignment. One might argue that structures should be deep-compared instead of a simple type comparison, but that's not how it's implemented currently. You have three options: use the same struct type for the struct field in each, use an anonymous struct in each (<a href=\"https://play.golang.org/p/Hw7HANwqbZ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Hw7HANwqbZ</a>), or make a helper function to convert the two manually.</p>\n\n<p>There's currently a proposal out to allow deeply-equivalent structures to be converted without a field-by-field helper method, but it is currently slated for Go 2.x: <a href=\"https://github.com/golang/go/issues/20621\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/20621</a></p>\n"}], "owner": {"reputation": 161, "user_id": 5422003, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-uZKXgUOxAS0/AAAAAAAAAAI/AAAAAAAAAAs/HGtdGe2S55c/photo.jpg?sz=128", "display_name": "Abhijith S", "link": "https://stackoverflow.com/users/5422003/abhijith-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 0, "accepted_answer_id": 44659126, "answer_count": 1, "score": 0, "last_activity_date": 1497978266, "creation_date": 1497949976, "last_edit_date": 1497957506, "question_id": 44648735, "link": "https://stackoverflow.com/questions/44648735/assigning-a-struct-having-one-of-its-fields-as-a-struct-to-another-struct-usin", "title": "Assigning a struct (Having one of its fields as a struct) to another struct using the feature introduced in Go 1.8", "body": "<p>I'm aware that since Go 1.8 it's possible to assign one struct to another struct type like this:</p>\n\n<p><code>func example() {\n    type T1 struct {\n        X int</code>json:\"foo\"<code>\n    }\n    type T2 struct {\n        X int</code>json:\"bar\"<code>\n    }\n    var v1 T1\n    var v2 T2\n    v1 = T1(v2) // now legal\n}</code></p>\n\n<p>However, if the struct internally has one of its fields as another struct, it doesn't work.</p>\n\n<p>Playground: <a href=\"https://play.golang.org/p/tSHdjBhhAJ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/tSHdjBhhAJ</a></p>\n\n<p>What is the best way to assign 2 structs in this case apart from manually assigning each field?</p>\n\n<p>This is not a duplicate of <a href=\"https://stackoverflow.com/questions/31981592/assign-struct-with-another-struct\">Assign struct with another struct</a> since here, you're assigning a struct to another struct of the same type. However what I want is assigning two different structs having the same field names.</p>\n"}, {"tags": ["assembly", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1497949154, "post_id": 44648409, "comment_id": 76281896, "body": "The functions are not exported so you cannot use them."}, {"owner": {"reputation": 23, "user_id": 8187425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/840d3262c397d11c4b6972941b7a1daf?s=128&d=identicon&r=PG&f=1", "display_name": "shortcryptoquestion", "link": "https://stackoverflow.com/users/8187425/shortcryptoquestion"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1497949493, "post_id": 44648409, "comment_id": 76282174, "body": "As the source code is available how can I make them accessible in my code? Go has no header files but the assembler file uses <code>#include &quot;textflag.h&quot;</code> for example."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 1, "creation_date": 1497950808, "post_id": 44648409, "comment_id": 76283166, "body": "Is there a reason you can&#39;t just use something like <code>aes.NewCipher(your_aes_key)</code> to create a new <code>cipher.Block</code> for use with the various functions in the <code>crypto&#47;cipher</code> package to encrypt/decrypt as necessary?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1497951042, "post_id": 44648409, "comment_id": 76283327, "body": "Use the high level functions, maybe even golang.org/x/crypto/nacl and stay away from the hairy details from crypto implementations."}, {"owner": {"reputation": 23, "user_id": 8187425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/840d3262c397d11c4b6972941b7a1daf?s=128&d=identicon&r=PG&f=1", "display_name": "shortcryptoquestion", "link": "https://stackoverflow.com/users/8187425/shortcryptoquestion"}, "edited": false, "score": 0, "creation_date": 1497952239, "post_id": 44648409, "comment_id": 76284313, "body": "Yes, in general it&#39;s bad practice to brew your own crypto soup. But I&#39;m trying to implement an algorithm that slightly differs from the original AES. Therefore I have some cases for that I need to have access to the lower level functions. <code>aes.NewCipher(your_aes_key)</code> should fit my needs but I want to run the encryption without the InitialRound and FinalRound of the AES algorithm."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1497953085, "post_id": 44648409, "comment_id": 76284967, "body": "Then copy the parts you need and put them in your own lib."}, {"owner": {"reputation": 23, "user_id": 8187425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/840d3262c397d11c4b6972941b7a1daf?s=128&d=identicon&r=PG&f=1", "display_name": "shortcryptoquestion", "link": "https://stackoverflow.com/users/8187425/shortcryptoquestion"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1497953226, "post_id": 44648409, "comment_id": 76285058, "body": "@RickyA but how can I copy the assembly code? I don&#39;t understand how can I connect it to my code. It looks like a c file as it has a header import!?"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1497954469, "post_id": 44648409, "comment_id": 76285907, "body": "copy the asm_amd64.s and the cipher_amd64.go files to your project. The .s file will compile automaticly. Then go dependency hunting (aka strip everything you don&#39;t need)"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 1, "creation_date": 1497954556, "post_id": 44648409, "comment_id": 76285964, "body": "<a href=\"https://goroutines.com/asm\" rel=\"nofollow noreferrer\">goroutines.com/asm</a> and <a href=\"https://golang.org/doc/asm\" rel=\"nofollow noreferrer\">golang.org/doc/asm</a>"}, {"owner": {"reputation": 23, "user_id": 8187425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/840d3262c397d11c4b6972941b7a1daf?s=128&d=identicon&r=PG&f=1", "display_name": "shortcryptoquestion", "link": "https://stackoverflow.com/users/8187425/shortcryptoquestion"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1497955319, "post_id": 44648409, "comment_id": 76286511, "body": "@RickyA thank you! That&#39;s the information I asked for."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1497955828, "post_id": 44648409, "comment_id": 76286858, "body": "Your welcome. I put it in a answer so you can accept it."}], "answers": [{"tags": [], "owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "is_accepted": true, "score": 0, "last_activity_date": 1497955634, "creation_date": 1497955634, "answer_id": 44650954, "question_id": 44648409, "link": "https://stackoverflow.com/questions/44648409/how-to-use-functions-defined-in-assembler-code-in-golang/44650954#44650954", "title": "How to use functions defined in assembler code in golang?", "body": "<ol>\n<li>Copy the <code>asm_amd64.s</code> contents over to your package</li>\n<li>Define the functions somewehere in that package</li>\n<li>Use those functions in the package</li>\n</ol>\n\n<p>Example (with the asm_amd64.s in the same package):</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc encryptBlockAsm(nr int, xk *uint32, dst, src *byte)\nfunc decryptBlockAsm(nr int, xk *uint32, dst, src *byte)\nfunc expandKeyAsm(nr int, key *byte, enc *uint32, dec *uint32)\n\nfunc main() {\n    var nr int\n    var xk uint32\n    var dst byte\n    var src byte\n\n    fmt.Printf(\"Before:\\t%v, %v, %v, %v\\n\", nr, xk, dst, src)\n\n    encryptBlockAsm(nr, &amp;xk, &amp;dst, &amp;src)\n\n    fmt.Printf(\"After:\\t%v, %v, %v, %v\\n\", nr, xk, dst, src)\n}\n</code></pre>\n\n<p>Yields:</p>\n\n<pre><code>Before: 0, 0, 0, 0\nAfter:  0, 0, 231, 173\n</code></pre>\n\n<p>I have no idea what the inputs should be but at least it demonstrates this does something :)</p>\n"}], "owner": {"reputation": 23, "user_id": 8187425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/840d3262c397d11c4b6972941b7a1daf?s=128&d=identicon&r=PG&f=1", "display_name": "shortcryptoquestion", "link": "https://stackoverflow.com/users/8187425/shortcryptoquestion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "accepted_answer_id": 44650954, "answer_count": 1, "score": 0, "last_activity_date": 1497955634, "creation_date": 1497949090, "last_edit_date": 1497949339, "question_id": 44648409, "link": "https://stackoverflow.com/questions/44648409/how-to-use-functions-defined-in-assembler-code-in-golang", "title": "How to use functions defined in assembler code in golang?", "body": "<p>In golangs AES crypto package <a href=\"https://golang.org/src/crypto/aes/cipher_amd64.go\" rel=\"nofollow noreferrer\">cipher_amd64.go</a> makes use of functions that are defined in assembler code (<a href=\"https://golang.org/src/crypto/aes/asm_amd64.s\" rel=\"nofollow noreferrer\">asm_amd64.s</a>). In the mentioned go file only the function headers are defined:</p>\n\n<pre><code>// defined in asm_amd64.s\nfunc encryptBlockAsm(nr int, xk *uint32, dst, src *byte)\nfunc decryptBlockAsm(nr int, xk *uint32, dst, src *byte)\nfunc expandKeyAsm(nr int, key *byte, enc *uint32, dec *uint32)\n</code></pre>\n\n<p>How can I use these functions in my own code? Just declaring the headers and importing \"crypto/aes\" as in the mentioned .go file does not work (<code>undefined: expandKeyAsm</code>).</p>\n\n<p>Thank you very much!</p>\n"}, {"tags": ["pointers", "go", "struct", "daemon", "channel"], "comments": [{"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1497947747, "post_id": 44647342, "comment_id": 76280800, "body": "Seems a bit off topic here, maybe try at <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}], "answers": [{"comments": [{"owner": {"reputation": 251, "user_id": 7923990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ad61ca14b98f6cde3a7109b252c544c?s=128&d=identicon&r=PG&f=1", "display_name": "icarbajo", "link": "https://stackoverflow.com/users/7923990/icarbajo"}, "edited": false, "score": 0, "creation_date": 1497948632, "post_id": 44647417, "comment_id": 76281446, "body": "This is I want to do, I thought I have to use the return of getopt.BoolLong to use it in select function... Thank you!"}], "tags": [], "owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "is_accepted": true, "score": 0, "last_activity_date": 1497947460, "last_edit_date": 1497947460, "creation_date": 1497946276, "answer_id": 44647417, "question_id": 44647342, "link": "https://stackoverflow.com/questions/44647342/receive-from-non-chan-type-bool/44647417#44647417", "title": "Receive from non-chan type *bool", "body": "<p>Those two lines in your main function shadow your global variable declaration:</p>\n\n<pre><code>optQuit := getopt.BoolLong(\"quit\", 0, \"Help\")\noptRun  := getopt.BoolLong(\"run\", 'r', \"Help\")\n</code></pre>\n\n<p>If you only use them, to get a nice usage, why not create a usage function\nyourself?</p>\n\n<p>If you insist on using <code>getopt</code> just to create a usage, do</p>\n\n<pre><code>_ = getopt.BoolLong(\"quit\", 0, \"Help\")\n_ = getopt.BoolLong(\"run\", 'r', \"Help\")\n</code></pre>\n\n<p>instead.</p>\n\n<p>You also need to call <code>getopt.Parse()</code> before using <code>*optHelp</code>.</p>\n\n<p>The resulting message</p>\n\n<pre><code>Usage: test [-hr] [--quit] [parameters ...]\n -h, --help  Help\n     --quit  Help\n -r, --run   Help\n</code></pre>\n\n<p>seems to be less than helpful. Why not just do</p>\n\n<pre><code>fmt.Printf(`\nUsage: test\n  This program will start a daemon service, which you can use like this ...\n`)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 251, "user_id": 7923990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ad61ca14b98f6cde3a7109b252c544c?s=128&d=identicon&r=PG&f=1", "display_name": "icarbajo", "link": "https://stackoverflow.com/users/7923990/icarbajo"}, "edited": false, "score": 0, "creation_date": 1497946800, "post_id": 44647488, "comment_id": 76280188, "body": "I understand your solution but I&#39;m using this package to get a help menu... This is the question, how I can adapt all?"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "reply_to_user": {"reputation": 251, "user_id": 7923990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ad61ca14b98f6cde3a7109b252c544c?s=128&d=identicon&r=PG&f=1", "display_name": "icarbajo", "link": "https://stackoverflow.com/users/7923990/icarbajo"}, "edited": false, "score": 0, "creation_date": 1497947039, "post_id": 44647488, "comment_id": 76280332, "body": "I am not sure what you are trying to do. Printing help for <code>optQuit</code>? Then just print a string as soon as somebody gives the param <code>h</code>. Dont misuse the package and kill your program."}], "tags": [], "owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "is_accepted": false, "score": 0, "last_activity_date": 1497946471, "creation_date": 1497946471, "answer_id": 44647488, "question_id": 44647342, "link": "https://stackoverflow.com/questions/44647342/receive-from-non-chan-type-bool/44647488#44647488", "title": "Receive from non-chan type *bool", "body": "<p>You define <code>optQuit = make(chan struct{})</code> globally and then shadow it in main: <code>optQuit := getopt.BoolLong(\"quit\", 0, \"Help\")</code>. </p>\n\n<p>So in main optQuit is a <code>bool</code>, not a <code>chan</code></p>\n\n<p>Remove those two lines in main:</p>\n\n<pre><code>optQuit := getopt.BoolLong(\"quit\", 0, \"Help\")\noptRun  := getopt.BoolLong(\"run\", 'r', \"Help\")\n</code></pre>\n"}], "owner": {"reputation": 251, "user_id": 7923990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ad61ca14b98f6cde3a7109b252c544c?s=128&d=identicon&r=PG&f=1", "display_name": "icarbajo", "link": "https://stackoverflow.com/users/7923990/icarbajo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 833, "favorite_count": 0, "accepted_answer_id": 44647417, "answer_count": 2, "score": -5, "last_activity_date": 1497947460, "creation_date": 1497946046, "last_edit_date": 1497946873, "question_id": 44647342, "link": "https://stackoverflow.com/questions/44647342/receive-from-non-chan-type-bool", "title": "Receive from non-chan type *bool", "body": "<p>I want to daemonize myapp but I have one big problem. The channels I'm using are of type <code>chan struct{}</code>.\nHowever, with the package getopt (flag package), my flags are of type *bool, so I don't know how can I modify myapp.</p>\n\n<p>It's not enough with channels type bool. I'm sure there are a concept that I don't understand. I attach you the code:</p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n    \"syscall\"\n    \"time\"\n\n    \"github.com/pborman/getopt/v2\"\n    \"github.com/sevlyar/go-daemon\"\n)\n\nvar (\n    done    = make(chan struct{})\n    optQuit = make(chan struct{})\n    optRun  = make(chan struct{})\n)\n\nfunc TermHandler(sig os.Signal) error {\n    optQuit &lt;- struct{}{}\n    if sig == syscall.SIGQUIT {\n        &lt;-done\n    }\n    return nil\n}\n\nfunc main() {\n    optHelp := getopt.BoolLong(\"help\", 'h', \"Help\")\n    optQuit := getopt.BoolLong(\"quit\", 0, \"Help\")\n    optRun  := getopt.BoolLong(\"run\", 'r', \"Help\")\n\n    if *optHelp {\n        getopt.Usage()\n        os.Exit(0)\n    }\n\n    // Create pid file\n    cntxt := &amp;daemon.Context{\n        PidFileName: \"/var/run/myapp.pid\",\n        PidFilePerm: 0644,\n        WorkDir:     \"./\",\n        Umask:       027,\n        Args:        []string{\"[Z]\"},\n    }\n\n    if len(daemon.ActiveFlags()) &gt; 0 {\n        d, _ := cntxt.Search()\n        daemon.SendCommands(d)\n        return\n    }\n    d, err := cntxt.Reborn()\n    if d != nil {\n        return\n    }\n    if err != nil {\n        os.Exit(1)\n    }\n    defer cntxt.Release()\n\n    // Define ticker\n    ticker := time.NewTicker(time.Second)\n    myapp := true\n\n    // Loop\n    for myapp {\n        select {\n\n        // Case sleep\n        case &lt;- ticker.C:\n            time.Sleep(time.Second)\n\n        // Case QUIT\n        case &lt;- optQuit:\n            done &lt;- struct{}{}\n            myapp = false\n            ticker.Stop()\n            os.Exit(0)\n\n        // Case RUN\n        case &lt;- optRun:\n            // Executes a goroutine...\n        }\n    }\n}\n</code></pre>\n\n<p>With <code>go install</code>, I can see this errors:</p>\n\n<pre><code>./main.go:72: invalid operation: &lt;-optQuit (receive from non-chan type *bool)\n./main.go:79: invalid operation: &lt;-optRun (receive from non-chan type *bool)\n</code></pre>\n\n<p>I don't know how I should modify the channels (done, optQuit of type struct{}), to resolve this...</p>\n\n<p>P.S.: I show you an example that I did. It runs as daemon and each minute, it executes the function Writer().\nAfter, if you type <code>zdaemon -z quit</code>, the app does a graceful shutdown. You can run it in your machines:</p>\n\n<p><a href=\"https://play.golang.org/p/RVq7M7usEj\" rel=\"nofollow noreferrer\">https://play.golang.org/p/RVq7M7usEj</a></p>\n"}, {"tags": ["python", "go", "timer"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1497955717, "post_id": 44647225, "comment_id": 76286782, "body": "I would imagine your question is downvoted because it&#39;s very poorly constructed. You haven&#39;t shown any effort at all to answer your own question. You should always show what your current code looks like. From your question, it seems you may not even <i>have</i> code, and are asking others to do your work for you."}], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1497946274, "post_id": 44647299, "comment_id": 76279853, "body": "You mean <code>TimeIt(doSomething, &quot;Doing something&quot;)</code> (without calling <code>doSomething</code>)?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1497946448, "post_id": 44647299, "comment_id": 76279963, "body": "yea, my Go is rusty, I&#39;ve been doing almost entirely C this past year..."}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 4, "last_activity_date": 1497946461, "last_edit_date": 1497946461, "creation_date": 1497945905, "answer_id": 44647299, "question_id": 44647225, "link": "https://stackoverflow.com/questions/44647225/use-golang-to-achieve-pythons-timer/44647299#44647299", "title": "Use golang to achieve python&#39;s timer", "body": "<p>You can write a function that accepts a function, runs it and prints the time:</p>\n\n<pre><code>import (\n  \"time\"\n  \"fmt\"\n)\n\nfunc TimeIt(f func(), description string) {\n   start := time.Now()\n   f()\n   fmt.Printf(\"Running %s took %v\\n\", description, time.Since(start))\n}\n</code></pre>\n\n<p>And then trigger it like so:</p>\n\n<pre><code>func main() {\n    TimeIt(doSomething, \"Doing something\")\n}\n</code></pre>\n\n<p>Or just sprinkle it on pieces of code as a closure:</p>\n\n<pre><code>TimeIt(func() {\n     do()\n     some()\n     stuff()\n   },\n   \"whatever\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 139, "user_id": 2854211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YetLB.jpg?s=128&g=1", "display_name": "tivio", "link": "https://stackoverflow.com/users/2854211/tivio"}, "is_accepted": false, "score": 3, "last_activity_date": 1497948917, "last_edit_date": 1497948917, "creation_date": 1497948334, "answer_id": 44648089, "question_id": 44647225, "link": "https://stackoverflow.com/questions/44647225/use-golang-to-achieve-pythons-timer/44648089#44648089", "title": "Use golang to achieve python&#39;s timer", "body": "<p>Another way to do this in go is to define a timer function and use the defer statement to call it when the function returns.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc timer(start time.Time, description string) {\n    fmt.Printf(\"%s took %s\\n\", description, time.Since(start))\n}\n\n\nfunc main() {\n    func() {\n        defer timer(time.Now(), \"scan all disks\")\n        // TODO: alot\n    }()\n    // OUTPUT: scan all disks took 0s\n}\n</code></pre>\n\n<p>You can measure the time of specific commands by wrapping them into an anonymous function (see above) or you measure the time of a function by simply putting the defer statement at its top, e.g.</p>\n\n<pre><code>func foo() {\n    defer timer(time.Now(), \"foo\")\n    // ...\n}\n// OUTPUT: foo took 0s\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 7004844, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/13debc3965e74232e3500042265051d3?s=128&d=identicon&r=PG&f=1", "display_name": "haroldT", "link": "https://stackoverflow.com/users/7004844/haroldt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "closed_date": 1497949112, "accepted_answer_id": 44647299, "answer_count": 2, "score": -3, "last_activity_date": 1497948917, "creation_date": 1497945691, "last_edit_date": 1497946807, "question_id": 44647225, "link": "https://stackoverflow.com/questions/44647225/use-golang-to-achieve-pythons-timer", "closed_reason": "Needs more focus", "title": "Use golang to achieve python&#39;s timer", "body": "<p><strong>Python:</strong></p>\n\n<pre><code>with Timer() as t :\n          // TODO a lot\n\nprint \"scan all disks,cost:%s secs\" % t.secs\n</code></pre>\n\n<p>Now,how to use <code>golang</code> to achieve this?</p>\n\n<p>I had google this but I can not find any answers I want.</p>\n\n<p>Why am I post my questions in here and then got downvote?</p>\n\n<p>Thank you your help!!!</p>\n"}, {"tags": ["generics", "go", "types", "interface"], "comments": [{"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 1, "creation_date": 1497944336, "post_id": 44646378, "comment_id": 76278576, "body": "You can use some code generator to create type safe container from template."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1497944514, "post_id": 44646378, "comment_id": 76278708, "body": "<code>I&#39;d need to re-implement every list method again</code> -&gt; true, but seriously how many do you really need? Are those worth giving up the compile speed. Go is optimized for compile speed, not for ease of use (although because of the limited &#39;feature&#39; set it paradoxically becomes easier to use)"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1497947763, "last_edit_date": 1497947763, "creation_date": 1497943975, "answer_id": 44646637, "question_id": 44646378, "link": "https://stackoverflow.com/questions/44646378/how-do-you-implement-a-container-for-different-types-in-go/44646637#44646637", "title": "How do you implement a container for different types in Go?", "body": "<p><a href=\"https://golang.org/doc/faq#generics\" rel=\"nofollow noreferrer\">Go doesn't have generic types</a>, so you're stuck with the options you listed. Sorry.</p>\n\n<blockquote>\n  <p>Meanwhile, Go's built-in maps and slices, plus the ability to use the empty interface to construct containers (with explicit unboxing) mean in many cases it is possible to write code that does what generics would enable, if less smoothly.</p>\n</blockquote>\n\n<p>If you know more about the elements you want to store in the container, you may use a more specialized interface type (instead of the empty interface <code>interface{}</code>), which</p>\n\n<ul>\n<li>could help you avoid using <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertions</a> (<strong>keep good performance</strong>)</li>\n<li>and still <strong>keep type safety</strong></li>\n<li>and it can be used for all types that (implicitly) implement your interface (<strong>code \"re-usability\"</strong>, no need to duplicate for multiple types).</li>\n</ul>\n\n<p>But that's about it. See an example of this here: <a href=\"https://stackoverflow.com/questions/39092925/why-are-interfaces-needed-in-golang/39100038#39100038\">Why are interfaces needed in Golang?</a></p>\n\n<p>Also just in case you missed it, the standard library already has a doubly linked list implementation in the <a href=\"https://golang.org/pkg/container/list/\" rel=\"nofollow noreferrer\"><code>container/list</code></a> package (which also uses <code>interface{}</code> type for the values).</p>\n"}, {"tags": [], "owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "is_accepted": false, "score": 1, "last_activity_date": 1497945719, "last_edit_date": 1497945719, "creation_date": 1497944367, "answer_id": 44646787, "question_id": 44646378, "link": "https://stackoverflow.com/questions/44646378/how-do-you-implement-a-container-for-different-types-in-go/44646787#44646787", "title": "How do you implement a container for different types in Go?", "body": "<p>As <code>icza</code> mentioned there isn't a straightforward way.</p>\n\n<p>You could try using <a href=\"https://blog.golang.org/generate\" rel=\"nofollow noreferrer\">code generation</a> to generate methods for new types.</p>\n"}, {"comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1497944669, "post_id": 44646860, "comment_id": 76278812, "body": "That is a very interesting point of view."}, {"owner": {"reputation": 12661, "user_id": 648955, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/DUiuD.jpg?s=128&g=1", "display_name": "leventov", "link": "https://stackoverflow.com/users/648955/leventov"}, "edited": false, "score": 0, "creation_date": 1497994659, "post_id": 44646860, "comment_id": 76312469, "body": "Java generics slower because of boxing and other reasons, this result couldnt support anything about go runtime"}], "tags": [], "owner": {"reputation": 19682, "user_id": 790070, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8SPP4.jpg?s=128&g=1", "display_name": "Timothy Jones", "link": "https://stackoverflow.com/users/790070/timothy-jones"}, "is_accepted": false, "score": 4, "last_activity_date": 1497944604, "creation_date": 1497944604, "answer_id": 44646860, "question_id": 44646378, "link": "https://stackoverflow.com/questions/44646378/how-do-you-implement-a-container-for-different-types-in-go/44646860#44646860", "title": "How do you implement a container for different types in Go?", "body": "<p>It's important to acknowledge that we expect generic types to be slower, not faster. The excellent <a href=\"http://fastutil.di.unimi.it/\" rel=\"nofollow noreferrer\">fastutil</a> library for Java outperforms the more flexible classes from the standard library by using concrete implementations. </p>\n\n<p>Russ Cox (one of Go's authors) <a href=\"https://research.swtch.com/generic\" rel=\"nofollow noreferrer\">summarises the situation</a> like this:</p>\n\n<blockquote>\n  <ul>\n  <li>(The C approach.) Leave them out.  \n  \n  <ul>\n  <li>This slows programmers.  </li>\n  </ul></li>\n  <li>(The C++ approach.) Compile-time specialization or macro expansion. \n  \n  <ul>\n  <li>This slows compilation. </li>\n  </ul></li>\n  <li>(The Java approach.) Box everything implicitly. \n  \n  <ul>\n  <li>This slows execution.</li>\n  </ul></li>\n  </ul>\n</blockquote>\n\n<p>You may be interested in <a href=\"https://docs.google.com/document/d/1vrAy9gMpMoS3uaVphB32uVXX4pi-HnNjkMEgyAHX4N4/edit\" rel=\"nofollow noreferrer\">this living document</a> which has a lot of the pros and cons outlined.</p>\n\n<p>As the other answer points out, Go does not support the design you're trying to achieve here. Personally, I'd just duplicate the code - it's not much, the tests are cheap, and most of the time you don't actually need the generic behaviour you want to implement.</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1111, "favorite_count": 0, "closed_date": 1497945738, "accepted_answer_id": 44646637, "answer_count": 3, "score": 2, "last_activity_date": 1497951688, "creation_date": 1497943227, "last_edit_date": 1497951688, "question_id": 44646378, "link": "https://stackoverflow.com/questions/44646378/how-do-you-implement-a-container-for-different-types-in-go", "closed_reason": "Duplicate", "title": "How do you implement a container for different types in Go?", "body": "<p>The following code implements a List of ints in Go:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype List struct {\n    Head int\n    Tail *List\n}\n\nfunc tail(list List) *List {\n    return list.Tail\n}\n\nfunc main() {\n    list := List{Head: 1, Tail: \n         &amp;List{Head: 2, Tail:\n         &amp;List{Head: 3, Tail:\n         nil}}}\n    fmt.Println(tail(list).Head)\n}\n</code></pre>\n\n<p>Problem is this only works for <code>int</code>. If I wanted a list of <code>strings</code>, <strong>I'd need to re-implement every list method (such as <code>tail</code>) again!</strong> That's obviously not practical, so, this can be solved by using an empty interface:</p>\n\n<pre><code>type List struct {\n  Head interface{} // Now works for any type!\n  Tail *List\n}\n</code></pre>\n\n<p>Problem is, 1. this seems to be much slower because of type casts, 2. it throws aways type safety, allowing one to type-check anything:</p>\n\n<pre><code>// This type-checks!\nfunc main() {\n    list := List{Head: 123456789 , Tail:\n         &amp;List{Head: \"covfefe\" , Tail:\n         &amp;List{Head: nil       , Tail:\n         &amp;List{Head: []int{1,2}, Tail:\n         nil}}}}\n    fmt.Println(tail(list).Head)\n</code></pre>\n\n<p>Obviously that program should <em>not</em> type-check in a statically typed language.</p>\n\n<p>How can I implement a List type which doesn't require me to re-implement all List methods for each contained type, but which keeps the expected type safety and performance?</p>\n"}, {"tags": ["json", "parsing", "datetime", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1497955888, "post_id": 44644412, "comment_id": 76286892, "body": "1) What have you tried? 2) We can&#39;t recommend libraries. It&#39;s strictly off-topic. 3) If you&#39;d google, or even spend 5 minutes reading Go docs, you&#39;d have your answer."}, {"owner": {"reputation": 1, "user_id": 8186406, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZqyrN.jpg?s=128&g=1", "display_name": "Uni", "link": "https://stackoverflow.com/users/8186406/uni"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1498019605, "post_id": 44644412, "comment_id": 76318793, "body": "Let me rephrase my question.  Do the standard Go packages include a means to parse this format, and if so, what is it?  I have searched this site and others for terms such as parse, golang, timestamp, ticks, epoch. It gets mentioned in the context of JavaScript, but not Go"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1498034759, "post_id": 44644412, "comment_id": 76326532, "body": "&quot;Do the standard Go packages include a means to parse this format&quot; Yes, they do. If you&#39;d read the docs for <a href=\"https://golang.org/pkg/time/\" rel=\"nofollow noreferrer\">time</a>, the most possibly obvious package to start with, you&#39;d know the answer."}, {"owner": {"reputation": 1, "user_id": 8186406, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZqyrN.jpg?s=128&g=1", "display_name": "Uni", "link": "https://stackoverflow.com/users/8186406/uni"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1499064882, "post_id": 44644412, "comment_id": 76736906, "body": "I gave up trying to find what @Flimzy thinks is obvious. If anyone wants to enlighten me, I&#39;d be grateful. In the meantime, I&#39;ve used a function similar to hobbs&#39; suggestion"}], "answers": [{"tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": false, "score": 0, "last_activity_date": 1497938058, "creation_date": 1497938058, "answer_id": 44644844, "question_id": 44644412, "link": "https://stackoverflow.com/questions/44644412/parse-time-stamp-in-go/44644844#44644844", "title": "Parse time stamp in Go", "body": "<p>Perhaps, but in case it's not, here's how you can do it yourself:</p>\n\n<pre><code>pattern := regexp.MustCompile(`\\A/Date\\((\\d+)([+-]\\d+)\\)/\\z`)\nm := pattern.FindStringSubmatch(res.ResponseTimestamp)\nif len(m) == 0 {\n    // Handle error: not a datetime in the expected format\n}\n\n// Get the milliseconds part\nms, err := strconv.Parseint(m[1], 10, 64)\n// Handle err (in the rare case of, say, an out of range error)\n\n// Use Go's time parser to parse the timezone part\ntForLoc, err := time.Parse(\"-0700\", m[2])\n// Handle err (invalid timezone spec)\n\n// Combine the milliseconds, the timezone, and the Unix epoch\nt := time.Date(1970, 1, 1, 0, 0, \n    int(ms/1000), int((ms%1000)*1e6, tForLoc.Location())\n\nreturn t\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8186406, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZqyrN.jpg?s=128&g=1", "display_name": "Uni", "link": "https://stackoverflow.com/users/8186406/uni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1498021726, "creation_date": 1497936010, "last_edit_date": 1498021726, "question_id": 44644412, "link": "https://stackoverflow.com/questions/44644412/parse-time-stamp-in-go", "title": "Parse time stamp in Go", "body": "<p>I'm calling a service based on the JSON SIRI API, which is returning timestamps in the format </p>\n\n<pre><code>\"ResponseTimestamp\": \"/Date(1497923363000+0930)/\"\n</code></pre>\n\n<p>which looks like milliseconds since the Unix epoch, plus the local time zone offset.</p>\n\n<p>Do the standard Go packages include a means to parse this format, and if so, what is it? </p>\n\n<p>I have searched this site and others for terms such as parse, golang, timestamp, ticks, epoch. It gets mentioned in the context of JavaScript, but not Go. I have looked in the Go source code for the packages, but haven't found any reference to this format.</p>\n\n<p>I can code my own function to do this, but I thought a parser for the format would be included with Go.</p>\n"}, {"tags": ["xml", "go"], "answers": [{"tags": [], "owner": {"reputation": 19682, "user_id": 790070, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8SPP4.jpg?s=128&g=1", "display_name": "Timothy Jones", "link": "https://stackoverflow.com/users/790070/timothy-jones"}, "is_accepted": true, "score": 1, "last_activity_date": 1497934665, "creation_date": 1497934665, "answer_id": 44644123, "question_id": 44643839, "link": "https://stackoverflow.com/questions/44643839/serialize-int-with-xml-node-name-in-go/44644123#44644123", "title": "Serialize int with xml node name in go", "body": "<p>Yes. As per the documentation for <a href=\"https://golang.org/pkg/encoding/xml/#Marshal\" rel=\"nofollow noreferrer\"><code>xml.Marshal</code></a>, you can use the tag <code>\",chardata\"</code>.</p>\n\n<pre><code>type number struct {\n    Number int64 `xml:\",chardata\"`\n}\n</code></pre>\n\n<p>This outputs <code>&lt;number&gt;2&lt;/number&gt;</code>, as seen at <a href=\"https://play.golang.org/p/Aoqfs04OTx\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Aoqfs04OTx</a></p>\n"}], "owner": {"reputation": 30708, "user_id": 1070291, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/e1BFx.png?s=128&g=1", "display_name": "Not loved", "link": "https://stackoverflow.com/users/1070291/not-loved"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 44644123, "answer_count": 1, "score": 1, "last_activity_date": 1497934665, "creation_date": 1497932886, "question_id": 44643839, "link": "https://stackoverflow.com/questions/44643839/serialize-int-with-xml-node-name-in-go", "title": "Serialize int with xml node name in go", "body": "<p>I'm just in the process of learning me some go, but im having trouble controlling XML serialization</p>\n\n<p>I want to serialize an int to <code>&lt;number&gt;1&lt;/number&gt;</code>, i have tried the following:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/xml\"\n)\ntype number struct {\n    Number int64\n}\n\nfunc main() {\n    out, _ := xml.Marshal(number{2})\n    fmt.Println(string(out))\n}\n</code></pre>\n\n<p>(<a href=\"https://play.golang.org/p/Ac-p1q3ytZ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Ac-p1q3ytZ</a>)</p>\n\n<p>but I get <code>&lt;number&gt;&lt;Number&gt;2&lt;/Number&gt;&lt;/number&gt;</code> which is double wrapped due to the struct its in. If I just serialize an int I get <code>&lt;int&gt;2&lt;/int&gt;</code> which is not named correctly.</p>\n\n<p>Is there a way to tell the serialize not to render the root node, or to put a property directly into the parent?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1497930953, "post_id": 44642587, "comment_id": 76272510, "body": "&quot;But it&#39;s doesn&#39;t work.&quot; is not a problem description. Please be more specific."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1497944879, "post_id": 44642587, "comment_id": 76278948, "body": "You have a permission problem?"}, {"owner": {"reputation": 31, "user_id": 8080863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5roeW.png?s=128&g=1", "display_name": "Nguy\u1ec5n D\u0169ng", "link": "https://stackoverflow.com/users/8080863/nguy%e1%bb%85n-d%c5%a9ng"}, "edited": false, "score": 0, "creation_date": 1497955594, "post_id": 44642587, "comment_id": 76286705, "body": "Now, I tried make a call to login service then get cookie then add it into header requests"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1497967619, "post_id": 44642587, "comment_id": 76296007, "body": "Your test, as written, will only work if the server is running. I don&#39;t know if you&#39;re starting it somewhere else in your tests, but this makes the tests unnecessarily heavy; instead of using a Client to make the requests, you can just pass your request and a <code>httptest.ResponseRecorder</code> directly to your HTTP handlers to test them."}, {"owner": {"reputation": 31, "user_id": 8080863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5roeW.png?s=128&g=1", "display_name": "Nguy\u1ec5n D\u0169ng", "link": "https://stackoverflow.com/users/8080863/nguy%e1%bb%85n-d%c5%a9ng"}, "edited": false, "score": 0, "creation_date": 1498007379, "post_id": 44642587, "comment_id": 76315927, "body": "Yep, you correct, my server not running, I only run my tests when my server is started. So, what the best way to make my server running when I started my tests?"}], "answers": [{"tags": [], "owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "is_accepted": false, "score": 0, "last_activity_date": 1498067191, "last_edit_date": 1498067191, "creation_date": 1498066753, "answer_id": 44682768, "question_id": 44642587, "link": "https://stackoverflow.com/questions/44642587/how-to-write-unit-test-for-go-web-api/44682768#44682768", "title": "How to write unit test for go Web api", "body": "<p>This is I test my servers...though I believe this to be more functional testing, which is more like what you seem to want to do above. I've added comments in the code so that you get an idea of what is going on. Of course you'd have to take this and modify it to your needs.</p>\n\n<pre><code>type payload struct {\n    WhateverElse interface{}\n    Error        error\n}\n\nfunc TestSite(t *testing.T) {\n    ctx := context.Background()\n    ctx, cancel := context.WithCancel(ctx)\n    defer cancel()\n    // I'm using the Bone router in this example but can be replaced with most routers\n    myRouter := bone.New()\n    myRouter.GetFunc(\"/foo/:bar\", routes.WipeCache)\n    myRouter.NotFoundFunc(routes.NotFound)\n    n := negroni.New()\n    n.UseHandler(wrappers.DefaultHeaders(myRouter))\n    // start an instance of the server on port 8080\n    // to run different tests in different functions, change the port\n    srv := &amp;http.Server{Addr: \":8080\", Handler: n}\n    on := make(chan struct{}, 1)\n    go func(on chan struct{}) {\n        on &lt;- struct{}{}\n        log.Fatal(srv.ListenAndServe())\n    }(on)\n    // shutdown the server when i'm done\n    srv.Shutdown(ctx)\n    // the channel on is not really needed, but I like to have it to make sure srv.ListenAndServe() has had enough time to warm up before I make a requests. So i block just a tiny bit.\n    &lt;-on\n\n    // create the client requests to test the server\n    client := &amp;http.Client{\n        Timeout: 1 * time.Second,\n    }\n\n    // Test logic\n    req, err := http.NewRequest(\"GET\", \"http://localhost:8080/foo/bar\", nil)\n    if err != nil {\n        t.Errorf(\"An error occurred. %v\", err)\n    }\n    resp, err := client.Do(req)\n    if err != nil {\n        t.Errorf(\"An error occurred. %v\", err)\n    }\n    defer resp.Body.Close()\n    ctx.Done()\n\n    if status := resp.StatusCode; status != http.StatusOK {\n        t.Errorf(\"Status code differs. Expected %d .\\n Got %d instead\", http.StatusOK, status)\n    }\n    var data payload\n    body, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        t.Errorf(\"An error occurred. %v\", err)\n    }\n    json.Unmarshal(body, &amp;data)\n\n    if data.Error != nil {\n        t.Errorf(\"An error occurred. %v\", err)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8080863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5roeW.png?s=128&g=1", "display_name": "Nguy\u1ec5n D\u0169ng", "link": "https://stackoverflow.com/users/8080863/nguy%e1%bb%85n-d%c5%a9ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1498067191, "creation_date": 1497923718, "last_edit_date": 1497944866, "question_id": 44642587, "link": "https://stackoverflow.com/questions/44642587/how-to-write-unit-test-for-go-web-api", "title": "How to write unit test for go Web api", "body": "<p>I am writing an unit test for golang web API.\nI have a API like <b>domain.com/api/user/current</b>.<br>\nThis API will return information user's logged in.\nI use <b>http.NewRequest</b> for make a request to this API. But it's doesn't work.<br></p>\n\n<p>So how to make a self call to this API with permission is logged?<br></p>\n\n<pre><code>func TestGetCurrentUserLogged(t *testing.T) {\n    assert := assert.New(t)\n\n    var url = \"http://example.com/user/current\";\n    req, _ := http.NewRequest(http.MethodGet, url, nil)\n    client := &amp;http.Client{}\n    //req.Header.Add(\"Cookie\", \"\")//\n    res, _ := client.Do(req)\n    if res.StatusCode == http.StatusBadGateway {\n        assert.True(false)\n    }\n\n    body, err := ioutil.ReadAll(res.Body)\n    defer res.Body.Close()\n    if err != nil {\n        t.Errorf(\"Error 1 API: %v\", err.Error())\n    }\n    var response map[string]interface{}\n    err = json.Unmarshal(body, &amp;response)\n    if err != nil {\n        t.Errorf(\"Error 2 API:%v\", err.Error())\n    }\n}\n</code></pre>\n"}, {"tags": ["javascript", "performance", "go"], "comments": [{"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 1, "creation_date": 1497924121, "post_id": 44642570, "comment_id": 76270949, "body": "What version of Go? Also what happens if you don&#39;t use an interface for a value.. You lose some speed by type casting Value to an int."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1497924169, "post_id": 44642570, "comment_id": 76270957, "body": "@reticentroot Go 1.8. Tested with <code>int</code> instead of an <code>interface</code>, still about <code>2x</code> slower than Node.js. (But how do I make it polymorphic without it?) - Is there an equivalent to the <code>-O2</code> flag?"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 1, "creation_date": 1497924492, "post_id": 44642570, "comment_id": 76271030, "body": "I think the real issue is the implementation and the way Go handles recursion <a href=\"https://medium.com/@felipedutratine/iterative-vs-recursive-vs-tail-recursive-in-golang-c196ca5fd489\" rel=\"nofollow noreferrer\">medium.com/@felipedutratine/&hellip;</a>"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1497924526, "post_id": 44642570, "comment_id": 76271036, "body": "@reticentroot It is on the question, I&#39;m using <code>go build file.go; time .&#47;file</code>."}, {"owner": {"reputation": 18829, "user_id": 24998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2c14a4f2931fa9336fdccdfe11318fef?s=128&d=identicon&r=PG", "display_name": "Jack", "link": "https://stackoverflow.com/users/24998/jack"}, "edited": false, "score": 1, "creation_date": 1497924640, "post_id": 44642570, "comment_id": 76271066, "body": "Recursion is slow in go: See: <a href=\"https://medium.com/@felipedutratine/iterative-vs-recursive-vs-tail-recursive-in-golang-c196ca5fd489\" rel=\"nofollow noreferrer\">medium.com/@felipedutratine/&hellip;</a>"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 1, "creation_date": 1497924891, "post_id": 44642570, "comment_id": 76271137, "body": "You might want to take a look at this tree implementation which takes advantage of some of Go&#39;s features.   You might see a speed gain by implementing it with channels <a href=\"https://golang.org/doc/play/tree.go\" rel=\"nofollow noreferrer\">golang.org/doc/play/tree.go</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1497931107, "post_id": 44642570, "comment_id": 76272542, "body": "<a href=\"https://blog.golang.org/profiling-go-programs\" rel=\"nofollow noreferrer\">blog.golang.org/profiling-go-programs</a>"}, {"owner": {"reputation": 19682, "user_id": 790070, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8SPP4.jpg?s=128&g=1", "display_name": "Timothy Jones", "link": "https://stackoverflow.com/users/790070/timothy-jones"}, "edited": false, "score": 0, "creation_date": 1497935237, "post_id": 44642570, "comment_id": 76273716, "body": "I think the major problem with this code is it&#39;s javascript written in Go."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 19682, "user_id": 790070, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8SPP4.jpg?s=128&g=1", "display_name": "Timothy Jones", "link": "https://stackoverflow.com/users/790070/timothy-jones"}, "edited": false, "score": 0, "creation_date": 1497935642, "post_id": 44642570, "comment_id": 76273862, "body": "@TimothyJones A simple recursion over a tree is now a JavaScript concept? I think you have things very reversed, the JS code here is adapted to fit Go&#39;s semantics. A more idiomatic JS implementation would be <a href=\"http://lpaste.net/356373\" rel=\"nofollow noreferrer\">3 lines of code</a> and is 5x faster than the Go one. Recursion and binary trees are absolutely universal concepts, I don&#39;t think that is up to debate. If a lang can&#39;t handle trees I have no hope for it."}, {"owner": {"reputation": 19682, "user_id": 790070, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8SPP4.jpg?s=128&g=1", "display_name": "Timothy Jones", "link": "https://stackoverflow.com/users/790070/timothy-jones"}, "edited": false, "score": 1, "creation_date": 1497935841, "post_id": 44642570, "comment_id": 76273936, "body": "I think the interpretation of the object model is the problem here. I&#39;m writing you up a more detailed answer."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 19682, "user_id": 790070, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8SPP4.jpg?s=128&g=1", "display_name": "Timothy Jones", "link": "https://stackoverflow.com/users/790070/timothy-jones"}, "edited": false, "score": 0, "creation_date": 1497935921, "post_id": 44642570, "comment_id": 76273966, "body": "@TimothyJones fair enough, I&#39;m curious to see what you got to show."}], "answers": [{"comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 1, "creation_date": 1497928102, "post_id": 44643110, "comment_id": 76271890, "body": "That&#39;s impressive! I didn&#39;t explore the realms of go routines yet. But notice there are 16777216 (i.e., <code>2^23</code>), not 23 leaf nodes on the tests I posted."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1497928482, "post_id": 44643110, "comment_id": 76271961, "body": "I didn&#39;t realize that.. lol, in that case some more work would have to go into the sum function.  For one i&#39;m using a buffered channel of ten... might be better to bump that up... though I think it would be best to keep track of the total number as the number of added to the tree.. So in the Tree struct, add Total next to Root.... so that that you aren&#39;t calculating everything at once."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1497929428, "post_id": 44643110, "comment_id": 76272126, "body": "@MaiaVictor I&#39;ve updated the post.. now Sum doesn&#39;t have to be calculated. It can be queried for.  So now the limiting factor is how fast nodes can be added."}], "tags": [], "owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "is_accepted": false, "score": 4, "last_activity_date": 1498079944, "last_edit_date": 1498079944, "creation_date": 1497927625, "answer_id": 44643110, "question_id": 44642570, "link": "https://stackoverflow.com/questions/44642570/why-this-simple-go-program-is-slower-than-its-node-js-counterpart/44643110#44643110", "title": "Why this simple Go program is slower than its Node.js counterpart?", "body": "<p>I thought that this might be beneficial. This is my implementation of a balanced binary tree, which uses recursion, go routines, and channels. It was meant to be used as a package, which is why i use Exported and Un-exported functions. The exported functions are what you should use/mod etc.. I wrote it a long time ago... there are plenty of things that could have been written better.. I added a Sum function just now however for you.\nI added 23 nodes and got the sum in 1/4 a second..</p>\n\n<p><strong>UPDATE</strong> I've added a new function called GetTreeTotal() if you look at the Tree struct i keep a Total field now. In the Add() function I update that field as the node is being added. Now sum() doesn't have to be calculated in mass, thats just part is the Tree's meta data now.. So in that sense. super fast.  Using similar logic, number of nodes on the tree can be kept as meta data as well.. Knowing that information, would speed up functions like TreeToArray() because one could then define the size of the slice before hand.  Less allocations.. etc</p>\n\n<p><strong>UPDATE2</strong> This question got me curious, I rewrote the code below and turned it into a package. <a href=\"https://github.com/marcsantiago/GoTree\" rel=\"nofollow noreferrer\">https://github.com/marcsantiago/GoTree</a> Iterative inserts are almost 3x faster (benchmarks included), though you really see this difference when the amount of inserts is really high.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"errors\"\n    \"fmt\"\n    \"math/rand\"\n    \"sync\"\n    \"time\"\n)\n\ntype node struct {\n    Left  *node\n    Right *node\n    Data  int\n}\n\n// Tree ...\ntype Tree struct {\n    Root  *node\n    Total int\n}\n\n// FindNode ...\nfunc (t *Tree) FindNode(data int) bool {\n    newNode := node{\n        Data: data,\n    }\n    if t.Root != nil {\n        if t.findNode(t.Root, newNode) != nil {\n            return true\n        }\n    }\n    return false\n}\n\nfunc (t *Tree) findNode(search *node, target node) *node {\n    var returnNode *node\n    if search == nil {\n        return returnNode\n    }\n    if search.Data == target.Data {\n        return search\n    }\n    returnNode = t.findNode(search.Left, target)\n    if returnNode == nil {\n        returnNode = t.findNode(search.Right, target)\n    }\n    return returnNode\n}\n\n// Add ...\nfunc (t *Tree) Add(data int) {\n    t.Total += data\n    if data &lt; 0 {\n        panic(errors.New(\"Only submit positive integers\"))\n    }\n    nodeToAdd := node{\n        Data: data,\n    }\n    if t.Root == nil {\n        t.Root = new(node)\n    }\n    if t.Root.Data == 0 {\n        t.Root = &amp;nodeToAdd\n        return\n    }\n\n    t.add(t.Root, nodeToAdd)\n    return\n}\n\nfunc (t *Tree) add(oldnode *node, newNode node) {\n    if newNode.Data &lt; oldnode.Data {\n        if oldnode.Left == nil {\n            // t.Total += newNode.Data\n            oldnode.Left = &amp;newNode\n        } else {\n            // t.Total += newNode.Data\n            t.add(oldnode.Left, newNode)\n        }\n    } else if newNode.Data &gt; oldnode.Data {\n        if oldnode.Right == nil {\n            // t.Total += newNode.Data\n            oldnode.Right = &amp;newNode\n        } else {\n            // t.Total += newNode.Data\n            t.add(oldnode.Right, newNode)\n        }\n    }\n    return\n}\n\n// InOrderTraversal ...\nfunc (t *Tree) InOrderTraversal() {\n    if t.Root != nil {\n        currentNode := t.Root\n        if currentNode.Left == nil &amp;&amp; currentNode.Right == nil {\n            fmt.Println(currentNode.Data)\n        } else {\n            t.inOrderTraversal(currentNode)\n        }\n    }\n    return\n}\n\nfunc (t *Tree) inOrderTraversal(n *node) {\n    if n.Left != nil {\n        t.inOrderTraversal(n.Left)\n    }\n    fmt.Println(n.Data)\n    if n.Right != nil {\n        t.inOrderTraversal(n.Right)\n    }\n    return\n}\n\n// Traversal ...\nfunc (t *Tree) Traversal() {\n    if t.Root != nil {\n        currentNode := t.Root\n        if currentNode.Left == nil &amp;&amp; currentNode.Right == nil {\n            fmt.Println(currentNode.Data)\n        } else {\n            t.traversal(currentNode)\n        }\n    }\n    return\n}\n\nfunc (t *Tree) traversal(n *node) {\n    fmt.Println(n.Data)\n    if n.Left != nil {\n        t.traversal(n.Left)\n    }\n\n    if n.Right != nil {\n        t.traversal(n.Right)\n    }\n    return\n}\n\n// Sum ...\nfunc (t *Tree) Sum() (total int) {\n    var wg sync.WaitGroup\n    c := make(chan int, 100)\n    if t.Root != nil {\n        currentNode := t.Root\n        if currentNode.Left == nil &amp;&amp; currentNode.Right == nil {\n            return 1\n        }\n        wg.Add(1)\n        t.sum(currentNode, c, &amp;wg)\n    }\n    go func() {\n        wg.Wait()\n        close(c)\n    }()\n    for n := range c {\n        total += n\n    }\n    return total\n}\n\nfunc (t *Tree) sum(n *node, counter chan int, wg *sync.WaitGroup) {\n    defer wg.Done()\n\n    if n.Left != nil {\n        wg.Add(1)\n        go t.sum(n.Left, counter, wg)\n    }\n\n    counter &lt;- n.Data\n\n    if n.Right != nil {\n        wg.Add(1)\n        go t.sum(n.Right, counter, wg)\n    }\n\n    return\n}\n\n// CountEdges ...\nfunc (t *Tree) CountEdges() (edges int) {\n    c := make(chan int, 10)\n    if t.Root != nil {\n        currentNode := t.Root\n        if currentNode.Left == nil &amp;&amp; currentNode.Right == nil {\n            return 1\n        }\n        t.countEdges(currentNode, c)\n    }\n\n    for {\n        n := &lt;-c\n        if n == 0 {\n            close(c)\n            break\n        }\n        edges++\n    }\n    return edges\n}\n\nfunc (t *Tree) countEdges(n *node, counter chan int) {\n    if n.Left != nil {\n        go t.countEdges(n.Left, counter)\n    }\n\n    if n.Left == nil &amp;&amp; n.Right == nil {\n        counter &lt;- 0\n    } else {\n        counter &lt;- 1\n    }\n\n    if n.Right != nil {\n        go t.countEdges(n.Right, counter)\n    }\n    return\n}\n\n// GenerateRandomTree ...\nfunc (t *Tree) GenerateRandomTree() {\n    u := time.Now()\n    source := rand.NewSource(u.Unix())\n    r := rand.New(source)\n    arr := r.Perm(1000)\n    for _, a := range arr {\n        t.Add(a)\n    }\n    return\n}\n\n// GetRootData ...\nfunc (t *Tree) GetRootData() int {\n    return t.Root.Data\n}\n\n// GetTreeTotal ...\nfunc (t *Tree) GetTreeTotal() int {\n    return t.Total\n}\n\n// TreeToArray ...\nfunc (t *Tree) TreeToArray() []int {\n    ch := make(chan int, 10)\n    arr := []int{}\n    if t.Root != nil {\n        currentNode := t.Root\n        if currentNode.Left == nil &amp;&amp; currentNode.Right == nil {\n            return []int{currentNode.Data}\n        }\n        t.traversalGetVals(currentNode, ch)\n    }\n\n    for {\n        n := &lt;-ch\n        if n == -1 {\n            close(ch)\n            break\n        }\n        arr = append(arr, n)\n    }\n    return arr\n}\n\nfunc (t *Tree) traversalGetVals(n *node, ch chan int) {\n    if n.Left != nil {\n        ch &lt;- n.Left.Data\n        go t.traversalGetVals(n.Left, ch)\n    }\n\n    if n.Right != nil {\n        ch &lt;- n.Right.Data\n        go t.traversalGetVals(n.Right, ch)\n    }\n    if n.Left == nil &amp;&amp; n.Right == nil {\n        ch &lt;- -1\n    }\n    return\n}\n\n// ShiftRoot ...\nfunc (t *Tree) ShiftRoot(newRoot int) {\n    arr := t.TreeToArray()\n    n := Tree{}\n    n.Add(newRoot)\n    for _, i := range arr {\n        n.Add(i)\n    }\n    *t = n\n}\n\n// PrintTree ...\nfunc (t *Tree) PrintTree() {\n    b, err := json.MarshalIndent(t, \"\", \" \")\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(string(b))\n}\n\nfunc main() {\n    // t := Tree{}\n    // t.GenerateRandomTree()\n    // t.PrintTree()\n    // fmt.Println(\"total:\", t.Sum())\n\n    t := Tree{}\n    t.Add(10)\n    t.Add(100)\n    t.Add(2)\n    t.Add(3)\n\n    fmt.Println(t.Sum()) // should be 115\n    fmt.Println(t.GetTreeTotal())\n\n    // t := Tree{}\n    // for i := 1; i &lt;= 23; i++ {\n    //  t.Add(i)\n    // }\n    // fmt.Println(\"total:\", t.Sum())\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19682, "user_id": 790070, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8SPP4.jpg?s=128&g=1", "display_name": "Timothy Jones", "link": "https://stackoverflow.com/users/790070/timothy-jones"}, "edited": false, "score": 1, "creation_date": 1497938320, "post_id": 44644832, "comment_id": 76274859, "body": "For those new to Go (who may be upset by this different way of looking at polymophism), Go has type composition and a number of other powerful concepts, like the <code>interface</code> system - but these concepts encourage a different way of constructing programs."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1497938611, "post_id": 44644832, "comment_id": 76274975, "body": "That is a great response, but leaves me without a sense of satisfaction. Even disabling polymorphism (which is <i>not</i> reasonable, IMO), it is still slower than Node.js, which is quite disappointing for a compiled language! I&#39;m also quite disappointed that the solution to polymorphism is basically a wildcard that says &quot;disable the typechecker at this location&quot;... that&#39;s not powerful, that&#39;s just bad. Polymorphism is a solved problem since ML! (Note: I didn&#39;t really use any OOP concept on the code at all, it is just plain data and recursion; if anything, that&#39;s a functional style.)"}, {"owner": {"reputation": 19682, "user_id": 790070, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8SPP4.jpg?s=128&g=1", "display_name": "Timothy Jones", "link": "https://stackoverflow.com/users/790070/timothy-jones"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 1, "creation_date": 1497941746, "post_id": 44644832, "comment_id": 76276812, "body": "Go doesn&#39;t encourage you to disable the type checker- I think it&#39;s the reverse. It encourages you to have concrete implementations that are not generic."}, {"owner": {"reputation": 19682, "user_id": 790070, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8SPP4.jpg?s=128&g=1", "display_name": "Timothy Jones", "link": "https://stackoverflow.com/users/790070/timothy-jones"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 1, "creation_date": 1497941939, "post_id": 44644832, "comment_id": 76276951, "body": "I&#39;m not arguing for disabling polymorphism, I&#39;m saying that Go doesn&#39;t encourage you to write code that is polymorphic <i>in the way you&#39;ve written above</i>. There are other ways to write the same code, but generally, Go doesn&#39;t let you do generic typing. I initially found this frustrating, but after using it for a while, I no longer miss it. It&#39;s just a different style."}, {"owner": {"reputation": 19682, "user_id": 790070, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8SPP4.jpg?s=128&g=1", "display_name": "Timothy Jones", "link": "https://stackoverflow.com/users/790070/timothy-jones"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1497942753, "post_id": 44644832, "comment_id": 76277504, "body": "See the edit for a more idiomatic Go tree, which causes a further speed improvement."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1497943502, "post_id": 44644832, "comment_id": 76278052, "body": "How it is &quot;just a different style&quot;? I&#39;m not talking about style, I&#39;m talking about a practical problem. Suppose I&#39;ve just implemented a container of some type (say, a List of ints). Then I want to reuse that container&#39;s methods (concat, reverse, etc.) for another type (say, string). How do I do that in Go? That&#39;s the problem polymorphism solves. You say there is a solution for that, but I see no solution yet. I&#39;ve posted a <a href=\"https://stackoverflow.com/questions/44646378/how-do-you-implement-a-container-in-go-without-losing-efficiency-and-type-safety\">separate question</a> for that."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1497943899, "post_id": 44644832, "comment_id": 76278281, "body": "Also, the <a href=\"http://lpaste.net/356373\" rel=\"nofollow noreferrer\">JS equivalent</a> of your last examples is still faster than Go by the same margin..."}, {"owner": {"reputation": 19682, "user_id": 790070, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8SPP4.jpg?s=128&g=1", "display_name": "Timothy Jones", "link": "https://stackoverflow.com/users/790070/timothy-jones"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1497944029, "post_id": 44644832, "comment_id": 76278367, "body": "Maybe it&#39;s just faster for this case. I don&#39;t know enough about node to know whether the test is fair. Either way, I don&#39;t think anyone is choosing node (or Go) for raw data structure performance."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1497944339, "post_id": 44644832, "comment_id": 76278577, "body": "If performance is not one of the selling points, then in what sense Go is better than Node.js? As I see, it is just JavaScript with added verbosity, same-level (or less) performance and a &quot;type-system&quot; that is so weak it gives no real safety, yet makes expressing something as necessary as lists impossible (without disabling the type system). I with I did, but I don&#39;t get the point. (I don&#39;t think this is the place for this, though, so, sorry. I asked a question and you answered it well, so I guess that&#39;s it...)"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 1, "creation_date": 1497973008, "post_id": 44644832, "comment_id": 76300123, "body": "You are saying go has a weak type system... from someone doing javascript.... hahaha."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1498078987, "post_id": 44644832, "comment_id": 76356531, "body": "@RickyA TypeScript and PureScript both solve the lack of types on JavaScript and they&#39;re better than Go&#39;s type system in every imaginable aspect."}], "tags": [], "owner": {"reputation": 19682, "user_id": 790070, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8SPP4.jpg?s=128&g=1", "display_name": "Timothy Jones", "link": "https://stackoverflow.com/users/790070/timothy-jones"}, "is_accepted": true, "score": 12, "last_activity_date": 1497943555, "last_edit_date": 1497943555, "creation_date": 1497938019, "answer_id": 44644832, "question_id": 44642570, "link": "https://stackoverflow.com/questions/44642570/why-this-simple-go-program-is-slower-than-its-node-js-counterpart/44644832#44644832", "title": "Why this simple Go program is slower than its Node.js counterpart?", "body": "<h2>Summary</h2>\n\n<p>This code is slower because of the type assertion, and reduntant data.</p>\n\n<p>Go doesn't encourage you to write type assertions in hot places:</p>\n\n<pre><code>tree.Value.(int) \n</code></pre>\n\n<p>Take out this type assertion (and accordingly change <code>Value</code> to an <code>int</code> type), and your code will perform about twice as fast (which should be around the speed of your node example). </p>\n\n<p>Take out the redundant data as well, and your code will perform about three times as fast. See the playground example at the end of the post. </p>\n\n<h2>Details</h2>\n\n<p>I think this is a mistake of design, rather than implementation. Reading your question, I think there is some confusion about how Go's type system works.</p>\n\n<p>Go's object model doesn't encourage you to do polymorphism using catch-all types (see the top half of <a href=\"https://stackoverflow.com/a/41592747/790070\">this excellent answer</a> for a discussion of Go's polymorphism). </p>\n\n<p>In a JavaScript world, each object is a specific type. In Go, a <code>struct</code> can be treated as a specific interface type if it fulfils the <code>interface</code>'s contract. Note that <code>structs</code> are not objects - what you called constructors are just <code>struct</code> initialisers. </p>\n\n<p>It is possible to write Go code that operates on <code>interface{}</code> as a placeholder for all types, but the language doesn't really encourage you to write code this way (as you pointed out in your question, it was a challenge to write clean code in the way you would write it in JavaScript).</p>\n\n<p>Because Go doesn't really have objects, trying to write code that feels very object-oriented in Go will be challenging (additionally, Go doesn't have standard inheritance or method overloading). For this reason, I don't think that your code is the kind of code that Go encourages the programmer to write. So, it's not a fair test.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/28024884/does-a-type-assertion-type-switch-have-bad-performance-is-slow-in-go\">Type assertion is slow</a>. (I'm not across the design of Go's internals, but certainly this indicates that the programmer is not expected to write a lot of type assertions). Because of this, it's not surprising that your code is not performant. I changed your code to:</p>\n\n<pre><code>type Tree struct {\n  IsLeaf bool\n  Left *Tree\n  Value int\n  Right *Tree\n} \n .....\nfunc sum(tree *Tree) int {\n  if (tree.IsLeaf) {\n    return tree.Value\n  } else {\n    return sum(tree.Left) + sum(tree.Right)\n  }\n}\n</code></pre>\n\n<p>And achieved a 2x speed up on my machine.</p>\n\n<p>There are probably other optimisations - you might be able to remove <code>IsLeaf</code>, and you don't need to store values at non-leaf nodes (or alternatively, you could distribute values throughout the tree, so never waste the <code>Value</code>). I don't know whether JavaScript optimises out these unnecessary <code>Value</code>s, but I don't believe Go does. </p>\n\n<p>So, I think your code is using much more memory than it needs, which won't help performance either.</p>\n\n<h2>Does it matter?</h2>\n\n<p>I'm not personally convinced by \"I wrote this program in X and Y, and found that Y was slower\", especially as it's hard to compare fairly across frameworks. There are so many other sources of variance - programmer knowledge, machine load, spin-up time, etc.</p>\n\n<p>To do a fair test you'd need to write code that's idiomatic in each language, but also use the same code. I don't think it's realistic to achieve both.</p>\n\n<p>If this code is your specific scenario, and performance is the primary goal, then this test might be helpful. But, otherwise I don't think it's a very meaningful comparison.</p>\n\n<p>At scale, I would expect other considerations to beat how fast you can create and traverse a tree. There are technical concerns like data throughput and performance under load, but also softer concerns like programmer time, and maintenance effort.</p>\n\n<p>The academic exercise is interesting, though. And writing code like this is a good way to find the edges of a framework.</p>\n\n<hr>\n\n<p>Edit: I tried making your code more Go-like, which has the added advantage of a 3x speedup over the original.:</p>\n\n<p><a href=\"https://play.golang.org/p/mWaO3WR6pw\" rel=\"noreferrer\">https://play.golang.org/p/mWaO3WR6pw</a></p>\n\n<p>The tree is a bit heavy for the playground, but you can copy and paste the code to run locally.</p>\n\n<p>There are more optimisations possible that I haven't tried, such as parallel construction of the tree.</p>\n\n<p>You may be able to extend this design to have the polymorphic behaviour that you want (by providing alternative <code>Leaf</code> implementations), but I'm not sure what <code>Sum()</code> means for non-number types. Not knowing how to define <code>Sum()</code> is a good example of the kind of thinking that leads to not deciding to include polymorphism through generics.</p>\n"}, {"comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1497985934, "post_id": 44660938, "comment_id": 76307947, "body": "The <code>sum</code> function here is not correct. Notice the datatype, you&#39;re supposed to only sum the leaf nodes. The only reason there is a <code>Value</code> on non-leaf nodes to begin with is that I couldn&#39;t find how to express an <b>union type</b> in Go, so I had to use a single struct and, thus, include <code>Value int</code> in branch nodes."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1497986294, "post_id": 44660938, "comment_id": 76308132, "body": "reverted, but that does not impact the speed."}], "tags": [], "owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "is_accepted": false, "score": 1, "last_activity_date": 1497986648, "last_edit_date": 1497986648, "creation_date": 1497984754, "answer_id": 44660938, "question_id": 44642570, "link": "https://stackoverflow.com/questions/44642570/why-this-simple-go-program-is-slower-than-its-node-js-counterpart/44660938#44660938", "title": "Why this simple Go program is slower than its Node.js counterpart?", "body": "<p>The problem is mainly in the fragmented memory allocation (via the recursive stack). This causes a lot of small allocations and subsequently the garbage collector has a hefty job. You can circumvent this by pre allocate an array that holds all nodes and keep a running index for assignment:</p>\n\n<p><code>bar.go</code></p>\n\n<pre><code>package bar\n\ntype Tree struct {\n    Left  *Tree\n    Value int\n    Right *Tree\n    IsLeaf bool\n}\n\nfunc build(level int, curridx *int, src *[]Tree) *Tree {\n    if level == 0 {\n        (*src)[*curridx] = Tree{Left: nil, Value: 1, Right: nil, IsLeaf:true}\n        *curridx++\n        return &amp;(*src)[*curridx-1]\n    } else {\n        (*src)[*curridx] = Tree{Left: build(level-1, curridx, src), Value: 1, Right: build(level-1, curridx, src)}\n        *curridx++\n        return &amp;(*src)[*curridx-1]\n    }\n}\n\nfunc sum(tree *Tree) int {\n    if (tree.IsLeaf) {\n        return tree.Value.(int)\n    } else {\n        return sum(tree.Left) + sum(tree.Right)\n    }\n}\n</code></pre>\n\n<p><code>bar_test.go</code></p>\n\n<pre><code>package bar\n\nimport \"testing\"\nimport \"math\"\n\nfunc TestMe(t *testing.T) {\n    for x := 0; x &lt; 10; x++ {\n        levels := 23\n        nrnodes := int(math.Pow(2.0, float64(levels+1))) //there are actually 24 levels\n        mapping := make([]Tree, nrnodes, nrnodes)\n        index := 0\n        t.Error(sum(build(levels, &amp;index, &amp;mapping)))\n    }\n}\n</code></pre>\n\n<p>This will speed things up to 0.5 sec per iteration.</p>\n\n<p>Note the build in profiling of this:</p>\n\n<p><code>go test -cpuprofile cpu.out</code>\nand\n<code>go tool pprof cpu.out</code> + <code>web</code></p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 560, "favorite_count": 2, "accepted_answer_id": 44644832, "answer_count": 3, "score": 7, "last_activity_date": 1498079944, "creation_date": 1497923599, "last_edit_date": 1497924316, "question_id": 44642570, "link": "https://stackoverflow.com/questions/44642570/why-this-simple-go-program-is-slower-than-its-node-js-counterpart", "title": "Why this simple Go program is slower than its Node.js counterpart?", "body": "<p>I'm attempting to use Go to implement a binary tree with values on the leaf, i.e., equivalent to:</p>\n\n<pre><code>data Tree a \n  = Node {left: Tree, right: Tree} \n  | Leaf {value: a}\n</code></pre>\n\n<p>I had two problems: 1, I couldn't figure a way to make a type with multiple constructors, so I had to fit all data in one. 2, I couldn't make it polymorphic, so I had to use <code>interface{}</code> (which I guess is an \"opt-out\" of the type-system?). This is the best I could make:</p>\n\n<pre><code>package main\n\nimport (\"fmt\")\n\ntype Tree struct {\n  IsLeaf bool\n  Left *Tree\n  Value interface{}\n  Right *Tree\n}\n\nfunc build(n int) *Tree {\n  if (n == 0) {\n    return &amp;Tree{IsLeaf: true, Left: nil, Value: 1, Right: nil}\n  } else {\n    return &amp;Tree{IsLeaf: false, Left: build(n - 1), Value: 0, Right: build(n - 1)}\n  }\n}\n\nfunc sum(tree *Tree) int {\n  if (tree.IsLeaf) {\n    return tree.Value.(int)\n  } else {\n    return sum(tree.Left) + sum(tree.Right)\n  }\n}\n\nfunc main() {\n  fmt.Println(sum(build(23)))\n}\n</code></pre>\n\n<p>It implements the type and tests it by summing over a huge generated tree. I've proceeded to make an equivalent implementation in JavaScript (including the redundant data on constructors, for fairness):</p>\n\n<pre><code>const build = n =&gt; {\n  if (n ===\u00a00) {\n    return {IsLeaf: true, Value: 1, Left: null, Right: null};\n  } else {\n    return {IsLeaf: false, Value: 0, Left: build(n - 1), Right: build(n - 1)};\n  }\n}\n\nconst sum = tree =&gt; {\n  if (tree.IsLeaf) {\n    return tree.Value;\n  } else {\n    return sum(tree.Left) + sum(tree.Right);\n  }\n}\n\nconsole.log(sum(build(23)));\n</code></pre>\n\n<p>I've compiled the Go code with <code>go build test.go</code> and ran it with <code>time ./test</code>. I've ran the Node.js code with <code>node test.js</code>. After several tests, the Go program ran in about <code>2.5</code>\u00a0seconds in average, versus <code>1.0</code> seconds of the Node.js one. </p>\n\n<p><strong>That makes Go <code>2.5x</code> slower than Node.js for this simple program, which can't be correct, given that Go is a statically-typed, compiled language with a mature compiler, whereas JavaScript is an untyped, interpreted one.</strong></p>\n\n<p>Why is my Go program so slow? Am I missing some compiler flag, or is the code problematic?</p>\n"}, {"tags": ["docker", "go", "grpc"], "comments": [{"owner": {"reputation": 19477, "user_id": 684908, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/18c7c8d0b7809e307991bfacc16470d0?s=128&d=identicon&r=PG", "display_name": "Andy Shinn", "link": "https://stackoverflow.com/users/684908/andy-shinn"}, "edited": false, "score": 2, "creation_date": 1497921466, "post_id": 44642241, "comment_id": 76270354, "body": "Where in the client code do you specify the server host to connect to? I don&#39;t see that..."}], "answers": [{"tags": [], "owner": {"reputation": 144207, "user_id": 596285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6975c494d3d9c404dd3d7af2edf3133?s=128&d=identicon&r=PG", "display_name": "BMitch", "link": "https://stackoverflow.com/users/596285/bmitch"}, "is_accepted": true, "score": 7, "last_activity_date": 1497922991, "last_edit_date": 1497922991, "creation_date": 1497922670, "answer_id": 44642449, "question_id": 44642241, "link": "https://stackoverflow.com/questions/44642241/use-grpc-to-communicate-between-containers/44642449#44642449", "title": "Use gRPC to communicate between containers", "body": "<p>You need to include the hostname in the dial function, otherwise it's looking at localhost which is unique to each container (docker creates a separate networking namespace for containers by default). Change the following:</p>\n\n<pre><code>backendPort := \"neo4bacon:50051\"\n</code></pre>\n\n<p>Edit: you also need to setup a network and connect the containers to that network because the default bridge does not include DNS discovery:</p>\n\n<pre><code>docker network create baconnet\ndocker run --rm -d --net baconnet --name neo4bacon neo4bacon\ndocker run --rm -d --net baconnet -p 8080:8080 --name bacon-api bacon-api\n</code></pre>\n"}], "owner": {"reputation": 863, "user_id": 2218023, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/JmNYB.jpg?s=128&g=1", "display_name": "Alessandro Resta", "link": "https://stackoverflow.com/users/2218023/alessandro-resta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6306, "favorite_count": 3, "accepted_answer_id": 44642449, "answer_count": 1, "score": 3, "last_activity_date": 1497922991, "creation_date": 1497921098, "question_id": 44642241, "link": "https://stackoverflow.com/questions/44642241/use-grpc-to-communicate-between-containers", "title": "Use gRPC to communicate between containers", "body": "<p>I'm implementing two services (server and client) running on two different containers and trying to use gRPC to communicate between them.</p>\n\n<p>If I deploy the server as a container and run the client <strong>not</strong> on a container, everything works just fine. But if I deploy the client on a different container I get <code>Error #01: could not retrieve restaurant's list: rpc error: code = Unavailable desc = grpc: the connection is unavailable</code> error. </p>\n\n<p>What steps am I missing to communicate two different containers using gRPC? </p>\n\n<p>PS: I would like to try without Kubernetes for now.</p>\n\n<p><strong>SERVER</strong></p>\n\n<pre><code>func Serve() {\n\n    log.Println(\"serving...\")\n\n    port := \":50051\"\n\n    lis, err := net.Listen(\"tcp\", port)\n    if err != nil {\n        log.Fatalf(\"failed to listen on port %s: %v\", port, err)\n    }\n\n    s := grpc.NewServer()\n    server := server{}\n    RegisterNeo4BaconServer(s, server)\n\n    if err := s.Serve(lis); err != nil {\n        log.Fatal(\"could not serve: \", err)\n    }\n}\n</code></pre>\n\n<p><strong>Makefile</strong></p>\n\n<pre><code>image: ## build docker image and push image to registry\n    @docker build -t neo4bacon -f resources/prod/Dockerfile .\n\nrun: ## deploy application container\n    @docker run --rm -d --name neo4bacon neo4bacon\n</code></pre>\n\n<p><strong>CLIENT</strong></p>\n\n<pre><code>func Get() (*api.RestaurantList, error) {\n    // Neo4bacon backend\n    backendPort := \":50051\"\n\n    conn, err := grpc.Dial(backendPort, grpc.WithInsecure())\n    if err != nil {\n        &amp;api.RestaurantList{}, fmt.Errorf(\"could not connect to backend %s: %s\", backendPort, err)\n    }\n    defer conn.Close()\n\n    client := api.NewNeo4BaconClient(conn)\n\n    restaurantList, err := client.List(context.Background(), &amp;api.Empty{})\n    if err != nil {\n        return &amp;api.RestaurantList{}, fmt.Errorf(\"could not retrieve restaurant's list: %s\", err)\n    }\n    return restaurantList, nil\n}\n</code></pre>\n\n<p><strong>Makefile</strong></p>\n\n<pre><code>image: ## build docker image and push image to registry     \n@docker build -t alesr/bacon-api -f resources/prod/Dockerfile .     \n\nrun: ## deploy docker container     \n@docker run --rm -d -p 8080:8080 --name bacon-api bacon-api\n</code></pre>\n"}, {"tags": ["json", "file", "go", "file-writing"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 7065713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5447d563dd473b0792db7f4cdd5fbb?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit Panikar", "link": "https://stackoverflow.com/users/7065713/rohit-panikar"}, "edited": false, "score": 0, "creation_date": 1497921165, "post_id": 44642209, "comment_id": 76270282, "body": "The only reason I defined my struct in my manner was so that I could iterate through it by saying: for index := range Identification. How could I iterate through your structure? The reason for iteration is to make sure I&#39;m not duplicating the user."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 75, "user_id": 7065713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5447d563dd473b0792db7f4cdd5fbb?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit Panikar", "link": "https://stackoverflow.com/users/7065713/rohit-panikar"}, "edited": false, "score": 0, "creation_date": 1497921232, "post_id": 44642209, "comment_id": 76270303, "body": "You can iterate <code>idents</code> value."}, {"owner": {"reputation": 75, "user_id": 7065713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5447d563dd473b0792db7f4cdd5fbb?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit Panikar", "link": "https://stackoverflow.com/users/7065713/rohit-panikar"}, "edited": false, "score": 0, "creation_date": 1497921335, "post_id": 44642209, "comment_id": 76270324, "body": "I&#39;m sorry, what do you mean by iterating through &quot;idents value&quot;?"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 75, "user_id": 7065713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5447d563dd473b0792db7f4cdd5fbb?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit Panikar", "link": "https://stackoverflow.com/users/7065713/rohit-panikar"}, "edited": false, "score": 0, "creation_date": 1497921407, "post_id": 44642209, "comment_id": 76270344, "body": "Refer to the play.golang link in the answer added iteration too."}, {"owner": {"reputation": 75, "user_id": 7065713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5447d563dd473b0792db7f4cdd5fbb?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit Panikar", "link": "https://stackoverflow.com/users/7065713/rohit-panikar"}, "edited": false, "score": 0, "creation_date": 1497921466, "post_id": 44642209, "comment_id": 76270355, "body": "Appreciate the help."}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 8, "last_activity_date": 1497921548, "last_edit_date": 1497921548, "creation_date": 1497920897, "answer_id": 44642209, "question_id": 44642132, "link": "https://stackoverflow.com/questions/44642132/appending-json-struct-to-json-file-golang/44642209#44642209", "title": "Appending JSON struct to JSON file Golang", "body": "<p>To achieve your output, define struct as follows-</p>\n\n<pre><code>type Identification struct {\n   ID    string\n   Phone int64\n   Email string\n}\n</code></pre>\n\n<p>And perform operation as follows-</p>\n\n<pre><code>// define slice of Identification\nvar idents []Identification\n\n// Unmarshall it\nerr := json.Unmarshal([]byte(jsonText), &amp;idents)\n\n// add further value into it\nidents = append(idents, Identification{ID: \"ID\", Phone: 15555555555, Email: \"Email\"})\n\n// now Marshal it\nresult, error := json.Marshal(idents)\n\n// now result has your targeted JSON structure\n</code></pre>\n\n<p>Sample program of above explanation <a href=\"https://play.golang.org/p/67dqOaCWHI\" rel=\"noreferrer\">https://play.golang.org/p/67dqOaCWHI</a></p>\n"}], "owner": {"reputation": 75, "user_id": 7065713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5447d563dd473b0792db7f4cdd5fbb?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit Panikar", "link": "https://stackoverflow.com/users/7065713/rohit-panikar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10973, "favorite_count": 0, "accepted_answer_id": 44642209, "answer_count": 1, "score": 5, "last_activity_date": 1497921548, "creation_date": 1497920288, "question_id": 44642132, "link": "https://stackoverflow.com/questions/44642132/appending-json-struct-to-json-file-golang", "title": "Appending JSON struct to JSON file Golang", "body": "<p>I have a JSON document of Users where they have an ID#, Phone#, and Email. Upon input of another ID, Phone, and Email, I want to take a new user's information and append it to the file. I have a structure that only contains an {ID: #, Phone: #, Email: #} and that's working fine. But my JSON file becomes as such:</p>\n\n<pre><code>[{\"ID\":\"ABCD\",\"Phone\":1234567890,\"Email\":\"johndoe@test.com\"}]\n[{\"ID\":\"EFGH\",\"Phone\":1234567890,\"Email\":\"johndoe@test.com\"}]\n[{\"ID\":\"IJKL\",\"Phone\":1234567890,\"Email\":\"johndoe@test.com\"}]\n[{\"ID\":\"MNOP\",\"Phone\":1234567890,\"Email\":\"johndoe@test.com\"}]\n[{\"ID\":\"QRST\",\"Phone\":1234567890,\"Email\":\"johndoe@test.com\"}]\n[{\"ID\":\"UVWX\",\"Phone\":1234567890,\"Email\":\"johndoe@test.com\"}]\n</code></pre>\n\n<p>So I'm able to append to the document, but it's a new JSON structure enclosed by brackets []. Below is my code. I omitted the actual hashed ID. </p>\n\n<pre><code>func ToIds(e string, p int64) {\n    hashed := GenId()\n    var jsonText = []byte(`[\n        {\"ID\": \"\", \"Phone\": 0, \"Email\": \"\"}\n    ]`)\n    var I Identification\n    err := json.Unmarshal([]byte(jsonText), &amp;I)\n    if err != nil {\n        fmt.Println(err)\n    }\n    I[0].ID = hashed\n    I[0].Phone = p\n    I[0].Email = e\n\n    result, error := json.Marshal(I)\n    if error != nil {\n        fmt.Println(error)\n    }\n\n    f, erro := os.OpenFile(\"FILE_PATH\", os.O_APPEND|os.O_WRONLY, 0666)\n    if erro != nil {\n        fmt.Println(erro)\n    }\n\n    n, err := io.WriteString(f, string(result))\n    if err != nil {\n        fmt.Println(n, err)\n    }\n\n}\n</code></pre>\n\n<p>This may be of use, here is my Identification struct. </p>\n\n<p><code>type Identification []struct {\n    ID    string\n    Phone int64<br>\n    Email string \n}</code></p>\n\n<p>Essentially, I want the outside brackets, and inside those brackets I want to append multiple users. Something like this: </p>\n\n<pre><code>    [\n    {\"id\":\"A\", \"phone\":17145555555, \"email\":\"tom@gmail.com\"},\n    {\"id\":\"B\",\"phone\":15555555555,\"email\":\"p@gmail.com\"},\n    {\"id\":\"C\",\"phone\":14155555555,\"email\":\"bradley@gmail.com\"},\n    {\"id\":\"D\",\"phone\":17135555555,\"email\":\"g@gmail.com\"},\n    {\"id\":\"E\",\"phone\":17125555555,\"email\":\"ann@gmail.com\"},\n    {\"id\":\"F\",\"phone\":17125555555,\"email\":\"sam@gmail.com\"},\n    {\"id\":\"G\",\"phone\":14055555555,\"email\":\"john@gmail.com\"},\n    {\"id\":\"H\",\"phone\":13105555555,\"email\":\"lisa@gmail.com\"}\n    ]\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 5, "last_activity_date": 1497923276, "last_edit_date": 1497923276, "creation_date": 1497922870, "answer_id": 44642481, "question_id": 44641989, "link": "https://stackoverflow.com/questions/44641989/reference-current-file-with-gogenerate/44642481#44642481", "title": "Reference current file with go:generate", "body": "<p>You can refer current file as follows:</p>\n\n<pre><code>//go:generate sometool $GOFILE\n</code></pre>\n\n<p><code>$GOFILE</code> get expanded to be name of the file processed by go generate.</p>\n"}], "owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "accepted_answer_id": 44642481, "answer_count": 1, "score": 2, "last_activity_date": 1497923276, "creation_date": 1497919232, "last_edit_date": 1497920994, "question_id": 44641989, "link": "https://stackoverflow.com/questions/44641989/reference-current-file-with-gogenerate", "title": "Reference current file with go:generate", "body": "<p>is there any way for <code>go:generate</code> to reference the current file?</p>\n\n<p>For example, I'd like to do something similar to</p>\n\n<p><code>//go:generate sometool $FILE</code></p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "gorilla"], "comments": [{"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 1, "creation_date": 1497919026, "post_id": 44641773, "comment_id": 76269808, "body": "Are you able to run the example without any issue? We don&#39;t know, what changes you have did to the example? Can you please create a code snippet on play.golang.org with reproducing your issue?"}, {"owner": {"reputation": 1082, "user_id": 751524, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/023e4f238b75274e7d16c1db67f62376?s=128&d=identicon&r=PG", "display_name": "utiq", "link": "https://stackoverflow.com/users/751524/utiq"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497933699, "post_id": 44641773, "comment_id": 76273256, "body": "Yes, I was able to run the example witouth any issue. Changes are in the commit history: <a href=\"https://github.com/utiq/go-in-5-minutes/commit/268f2d3adc8a90b643ff5dfed34205a92d25e6b4#diff-4c44d7542df3ff4221e5fcf36d8ef0b4\" rel=\"nofollow noreferrer\">github.com/utiq/go-in-5-minutes/commit/&hellip;</a>"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497983803, "post_id": 44641773, "comment_id": 76306669, "body": "Going through your commit, will get back"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1498069215, "post_id": 44641773, "comment_id": 76351056, "body": "Did you get a chance to verify the answer?"}, {"owner": {"reputation": 1082, "user_id": 751524, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/023e4f238b75274e7d16c1db67f62376?s=128&d=identicon&r=PG", "display_name": "utiq", "link": "https://stackoverflow.com/users/751524/utiq"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1498157147, "post_id": 44641773, "comment_id": 76397195, "body": "Hey @jeevatkm thank you so much for your answer. I couldn&#39;t check it out because I started working in another feature of the app since I was stuck in that part. I&#39;ll check it out tomorrow. In general, I think your change will fix the problem."}], "answers": [{"comments": [{"owner": {"reputation": 1082, "user_id": 751524, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/023e4f238b75274e7d16c1db67f62376?s=128&d=identicon&r=PG", "display_name": "utiq", "link": "https://stackoverflow.com/users/751524/utiq"}, "edited": false, "score": 0, "creation_date": 1498242316, "post_id": 44662067, "comment_id": 76438111, "body": "I made the change but I get this error when I try to connect: failed: Error during WebSocket handshake: Unexpected response code: 404 Something I&#39;m trying to do is to connect from an AngularJS app, so I call the websocket like this ws = new $WebSocket(&quot;ws://127.0.0.1:8085/ws&quot;);"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 1082, "user_id": 751524, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/023e4f238b75274e7d16c1db67f62376?s=128&d=identicon&r=PG", "display_name": "utiq", "link": "https://stackoverflow.com/users/751524/utiq"}, "edited": false, "score": 0, "creation_date": 1498243629, "post_id": 44662067, "comment_id": 76438789, "body": "I was able to execute locally with changes mentioned in the answer. Let me send you the PR of episode4 with working state then you can improve it as per your need."}, {"owner": {"reputation": 1082, "user_id": 751524, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/023e4f238b75274e7d16c1db67f62376?s=128&d=identicon&r=PG", "display_name": "utiq", "link": "https://stackoverflow.com/users/751524/utiq"}, "edited": false, "score": 1, "creation_date": 1498486826, "post_id": 44662067, "comment_id": 76504575, "body": "Awesome!, it was my mistake trying to implement it in a different script. Thanks @jeevatkm!!"}, {"owner": {"reputation": 1082, "user_id": 751524, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/023e4f238b75274e7d16c1db67f62376?s=128&d=identicon&r=PG", "display_name": "utiq", "link": "https://stackoverflow.com/users/751524/utiq"}, "edited": false, "score": 0, "creation_date": 1498488366, "post_id": 44662067, "comment_id": 76505702, "body": "do you have a clue of how to make this &quot;multi rooms&quot;?"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 1082, "user_id": 751524, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/023e4f238b75274e7d16c1db67f62376?s=128&d=identicon&r=PG", "display_name": "utiq", "link": "https://stackoverflow.com/users/751524/utiq"}, "edited": false, "score": 0, "creation_date": 1498493956, "post_id": 44662067, "comment_id": 76509325, "body": "Yes, let&#39;s do that conversation on Github or SO chat, but not in this Q&amp;A."}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 1, "last_activity_date": 1497990401, "last_edit_date": 1497990401, "creation_date": 1497989017, "answer_id": 44662067, "question_id": 44641773, "link": "https://stackoverflow.com/questions/44641773/gin-gonic-and-gorilla-websocket-does-not-propagate-message/44662067#44662067", "title": "gin-gonic and gorilla/websocket does not propagate message", "body": "<p>I had a look on your <a href=\"https://github.com/utiq/go-in-5-minutes/commit/268f2d3adc8a90b643ff5dfed34205a92d25e6b4#diff-4c44d7542df3ff4221e5fcf36d8ef0b4\" rel=\"nofollow noreferrer\">commit changes</a> of <code>episode4</code>. </p>\n\n<p><strong>My observations as follows:</strong></p>\n\n<ul>\n<li>You're creating <code>hub</code> instance on every incoming request at <a href=\"https://github.com/utiq/go-in-5-minutes/blob/master/episode4/connection.go#L52\" rel=\"nofollow noreferrer\">stream handler</a>. <code>hub</code> instance used to keeps track connections, etc. so you're losing it on every request.</li>\n<li>You have removed index/home handler (may be you wanted to convert to gin handler or something, I don't know).</li>\n</ul>\n\n<p>Now, let's bring <code>episode4</code> into action. Please do following changes (as always improve it as you like). I have tested your <code>episode4</code> with below changes, it's working fine.</p>\n\n<p>Make <code>/ws</code> handler work on <code>server.go</code>:</p>\n\n<pre><code>h := newHub()\nwsh := wsHandler{h: h}\nr.GET(\"/ws\", func(c *gin.Context) {\n    wsh.ServeHTTP(c.Writer, c.Request)\n})\n</code></pre>\n\n<p>Remove the stream handler on <code>connection.go</code>:</p>\n\n<pre><code>func stream(c *gin.Context) {\n    h := newHub()\n    wsHandler{h: h}.ServeHTTP(c.Writer, c.Request)\n}\n</code></pre>\n\n<p>Adding index HTML handler on <code>server.go</code>: (added it to test episode4 at my end)</p>\n\n<pre><code>r.SetHTMLTemplate(template.Must(template.ParseFiles(\"index.html\")))\nr.GET(\"/\", func(c *gin.Context) {\n    c.HTML(200, \"index.html\", nil)\n})\n</code></pre>\n"}], "owner": {"reputation": 1082, "user_id": 751524, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/023e4f238b75274e7d16c1db67f62376?s=128&d=identicon&r=PG", "display_name": "utiq", "link": "https://stackoverflow.com/users/751524/utiq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2466, "favorite_count": 0, "accepted_answer_id": 44662067, "answer_count": 1, "score": 0, "last_activity_date": 1497990401, "creation_date": 1497917631, "question_id": 44641773, "link": "https://stackoverflow.com/questions/44641773/gin-gonic-and-gorilla-websocket-does-not-propagate-message", "title": "gin-gonic and gorilla/websocket does not propagate message", "body": "<p>So I made a few changes to this example to make it work with gin-gonic\n<a href=\"https://github.com/utiq/go-in-5-minutes/tree/master/episode4\" rel=\"nofollow noreferrer\">https://github.com/utiq/go-in-5-minutes/tree/master/episode4</a></p>\n\n<p>The websocket handshake between many clients is succesful. The problem is that when a client sends a message, the message is not propagated to the rest of the clients.</p>\n"}, {"tags": ["arrays", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497917888, "post_id": 44641663, "comment_id": 76269494, "body": "You have a <code>*Set</code> pointer, so you can modify it. It would help to show how are you are managing to <i>not</i> modify it."}, {"owner": {"reputation": 7300, "user_id": 195644, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e1a2ac3e1eba0c0d26672b2a55948b77?s=128&d=identicon&r=PG", "display_name": "xaav", "link": "https://stackoverflow.com/users/195644/xaav"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497918537, "post_id": 44641663, "comment_id": 76269678, "body": "@JimB The append function does not work with pointers. A runnable example is posted."}], "answers": [{"comments": [{"owner": {"reputation": 7300, "user_id": 195644, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e1a2ac3e1eba0c0d26672b2a55948b77?s=128&d=identicon&r=PG", "display_name": "xaav", "link": "https://stackoverflow.com/users/195644/xaav"}, "edited": false, "score": 0, "creation_date": 1497918955, "post_id": 44641923, "comment_id": 76269788, "body": "Thank you for this answer, and please excuse my incompetence as I have not had much experience with c-style languages."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 7, "last_activity_date": 1497919038, "last_edit_date": 1497919038, "creation_date": 1497918750, "answer_id": 44641923, "question_id": 44641663, "link": "https://stackoverflow.com/questions/44641663/possible-to-add-an-append-method-to-a-slice/44641923#44641923", "title": "Possible to add an append method to a slice", "body": "<p>You're modifying the slice, but you never assign it back to the pointer. </p>\n\n<pre><code>func (ptr *Set) AppendElements(elements []*Element) {\n    set := *ptr\n    set = append(set, elements...)\n    *ptr = set\n}\n</code></pre>\n\n<p>Usually though, one would dereference the pointer directly in the <code>append</code> statement: </p>\n\n<pre><code>func (set *Set) AppendElements(elements []*Element) {\n    *set = append(*set, elements...)\n}\n</code></pre>\n"}], "owner": {"reputation": 7300, "user_id": 195644, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e1a2ac3e1eba0c0d26672b2a55948b77?s=128&d=identicon&r=PG", "display_name": "xaav", "link": "https://stackoverflow.com/users/195644/xaav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 796, "favorite_count": 1, "accepted_answer_id": 44641923, "answer_count": 1, "score": 2, "last_activity_date": 1497956345, "creation_date": 1497916766, "last_edit_date": 1497956345, "question_id": 44641663, "link": "https://stackoverflow.com/questions/44641663/possible-to-add-an-append-method-to-a-slice", "title": "Possible to add an append method to a slice", "body": "<p>I have something like the following type structure below:</p>\n\n<pre><code>type Set []*Element\n\nfunc (set *Set) AppendElements(elements []*Elements) {\n    // ?\n}\n</code></pre>\n\n<p>Obviously simply appending elements to a slice is not very useful. However, the actual function takes some value, does some business logic, and then appends the elements. However, I am facing the difficulty that modifications to the slice inside of the method to not actually change the value of the slice to outside callers, because the append method allocates a new slice that is not seen by the callers.</p>\n\n<p>Is there a way to append to the slice in a method or should the slice be wrapped in a struct or something else?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Element int\ntype Set []*Element\n\nfunc (ptr *Set) AppendElements(elements []*Element) {\n    set := *ptr\n    set = append(set, elements...)\n}\n\nfunc main() {\n    i := Element(1)\n    var set Set\n    set.AppendElements([]*Element{&amp;i})\n\n    for _, el := range set {\n        fmt.Println(el)\n    }\n}\n</code></pre>\n\n<p>More specifically, the above prints nothing.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 7, "last_activity_date": 1498053970, "last_edit_date": 1498053970, "creation_date": 1497918030, "answer_id": 44641834, "question_id": 44641643, "link": "https://stackoverflow.com/questions/44641643/why-does-address-of-an-array-print-in-go/44641834#44641834", "title": "why does &amp; (address) of an array print &quot;&amp;&quot; in go", "body": "<p>Default printing verb <code>fmt.Println</code> uses is <code>%v</code>. While printing it <a href=\"https://golang.org/src/fmt/print.go?s=7388:7437#L841\" rel=\"nofollow noreferrer\">differentiates</a> value vs pointer value, that's why you see <code>&amp;</code> in front of <code>cx</code>.</p>\n\n<pre><code>fmt.Println(cx)\n</code></pre>\n\n<p>Next, you specifically tell <code>fmt.Printf</code> to use the verb <code>%p</code>, refer to <a href=\"https://golang.org/pkg/fmt/#hdr-Printing\" rel=\"nofollow noreferrer\">printing</a> section and it prints <code>base 16 notation, with leading 0x</code>.</p>\n\n<pre><code>fmt.Printf(\"%p\\n\", cx)\n</code></pre>\n"}], "owner": {"reputation": 1769, "user_id": 3151330, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/osBeZ.jpg?s=128&g=1", "display_name": "manikawnth", "link": "https://stackoverflow.com/users/3151330/manikawnth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 643, "favorite_count": 1, "accepted_answer_id": 44641834, "answer_count": 1, "score": 3, "last_activity_date": 1498053970, "creation_date": 1497916601, "last_edit_date": 1498053803, "question_id": 44641643, "link": "https://stackoverflow.com/questions/44641643/why-does-address-of-an-array-print-in-go", "title": "why does &amp; (address) of an array print &quot;&amp;&quot; in go", "body": "<p>Here is the go code</p>\n\n<pre><code>package main \n\nfunc main() {\n\n    var ax [2]int\n    ax[0] = 22\n    ax[1] = 99\n\n    bx := ax\n    cx := &amp;ax\n\n    fmt.Println(ax)\n    fmt.Println(bx)\n    fmt.Println(cx)\n    fmt.Printf(\"%p\\n\", cx)\n\n}\n</code></pre>\n\n<p>When I execute it, it gives me the following output</p>\n\n<pre><code>PS C:\\personal\\gospace&gt; ./bin/test\n[22 99]\n[22 99]\n&amp;[22 99]\n0xc0420381d0\n</code></pre>\n\n<p><code>cx := &amp;ax</code> rightly interpreted cx as pointer. But when I print cx it prints <code>&amp;[22 99]</code> and when I print <code>&amp;ax[0]</code> or <code>%p</code> formatter for cx it rightly prints the address. Why is this behavior?</p>\n"}, {"tags": ["javascript", "jquery", "html", "go", "cors"], "comments": [{"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 1, "creation_date": 1497916755, "post_id": 44641615, "comment_id": 76269232, "body": "I don&#39;t see any CORS handling in above code snippets. Share your code snippet you have tried. Also refer this <a href=\"https://stackoverflow.com/questions/40985920/making-golang-gorilla-cors-handler-work\">SO post</a>, it would give you a start point."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5906464"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497917007, "post_id": 44641615, "comment_id": 76269288, "body": "@jeevatkm Do we need to have cors handler even when app is running locally?"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497917173, "post_id": 44641615, "comment_id": 76269327, "body": "I believe your question is <code>How to tackle Cors issue on local system?</code> and your description has <code>I wrote an actual app and there is cors issue in the production</code>. So if you&#39;re not using CORS then what is an issue? Am I missing any?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5906464"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497917484, "post_id": 44641615, "comment_id": 76269385, "body": "@jeevatkm <code>corsObj:=handlers.AllowedOrigins([]string{&quot;*&quot;})</code> I have added this to my main function. I don&#39;t know if that&#39;s the way to do it."}, {"owner": {"reputation": 936, "user_id": 2640540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1b97e00905a659dde58d29e3f6433d9?s=128&d=identicon&r=PG", "display_name": "david25272", "link": "https://stackoverflow.com/users/2640540/david25272"}, "edited": false, "score": 0, "creation_date": 1497917519, "post_id": 44641615, "comment_id": 76269394, "body": "&quot;there is cors issue&quot;.  What&#39;s the actual error?  It&#39;d help if you posted the errors from the browser console."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5906464"}, "reply_to_user": {"reputation": 936, "user_id": 2640540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1b97e00905a659dde58d29e3f6433d9?s=128&d=identicon&r=PG", "display_name": "david25272", "link": "https://stackoverflow.com/users/2640540/david25272"}, "edited": false, "score": 0, "creation_date": 1497917559, "post_id": 44641615, "comment_id": 76269409, "body": "@david25272 XMLHttpRequest cannot load <a href=\"http://localhost:12345/people\" rel=\"nofollow noreferrer\">localhost:12345/people</a>. Response to preflight request doesn&#39;t pass access control check: No &#39;Access-Control-Allow-Origin&#39; header is present on the requested resource. Origin &#39;<a href=\"http://localhost:3000\" rel=\"nofollow noreferrer\">localhost:3000</a>&#39; is therefore not allowed access. The response had HTTP status code 404."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497918393, "post_id": 44641615, "comment_id": 76269632, "body": "Did you read <a href=\"https://stackoverflow.com/questions/40985920/making-golang-gorilla-cors-handler-work\">SO Post</a> I mentioned in my first comment regarding CORS. It has all the information required for implementation."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5906464"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497918446, "post_id": 44641615, "comment_id": 76269651, "body": "@jeevatkm yes, I did. I added the cors handler, but it is still the same."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497918723, "post_id": 44641615, "comment_id": 76269731, "body": "Good you added it. Are you sending an appropriate HTTP headers while sending a request? Refer to this <a href=\"https://stackoverflow.com/a/40987420/1343356\">SO post</a>, testing via <code>curl</code> cmd."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5906464"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497922205, "post_id": 44641615, "comment_id": 76270509, "body": "@jeevatkm <code>curl -H &quot;Origin: http:&#47;&#47;localhost:3000&quot; -H &quot;Access-Control-Request-Method: GET&quot; -H &quot;Access-Control-Request-Headers: X-Requested-With&quot; -X OPTIONS --verbose http:&#47;&#47;localhost:12345&#47;people *   Trying ::1... * Connection failed * connect to ::1 port 12345 failed: Connection refused *   Trying 127.0.0.1... * Connection failed * connect to 127.0.0.1 port 12345 failed: Connection refused * Failed to connect to localhost port 12345: Connection refused * Closing connection 0 curl: (7) Failed to connect to localhost port 12345: Connection refused</code> I don&#39;t know what else to add."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497923075, "post_id": 44641615, "comment_id": 76270701, "body": "It seems your server is not running on <code>localhost:12345</code>. Also why you have two <code>http.ListenAndServe</code> in above code snippet? You just copy and paste without understanding what that line means."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5906464"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497925428, "post_id": 44641615, "comment_id": 76271268, "body": "@jeevatkm oops! I didn&#39;t notice that. <code>log.Fatal(http.ListenAndServe(&quot;:12345&quot;, handlers.CORS(originsOk, headersOk, methodsOk)(router)))</code> The issue still remains. As usual postman is doing fine."}, {"owner": {"reputation": 936, "user_id": 2640540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1b97e00905a659dde58d29e3f6433d9?s=128&d=identicon&r=PG", "display_name": "david25272", "link": "https://stackoverflow.com/users/2640540/david25272"}, "edited": false, "score": 0, "creation_date": 1497927187, "post_id": 44641615, "comment_id": 76271677, "body": "Try <code>originsOk := handlers.AllowedOrigins([]string{&quot;*&quot;})</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5906464"}, "reply_to_user": {"reputation": 936, "user_id": 2640540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1b97e00905a659dde58d29e3f6433d9?s=128&d=identicon&r=PG", "display_name": "david25272", "link": "https://stackoverflow.com/users/2640540/david25272"}, "edited": false, "score": 0, "creation_date": 1497927718, "post_id": 44641615, "comment_id": 76271794, "body": "@david25272 I tried but it didn&#39;t work. I found a work around. (<a href=\"https://github.com/rs/cors/blob/master/README.md\" rel=\"nofollow noreferrer\">github.com/rs/cors/blob/master/README.md</a>)"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5906464"}, "is_accepted": true, "score": 1, "last_activity_date": 1497928370, "creation_date": 1497928370, "answer_id": 44643234, "question_id": 44641615, "link": "https://stackoverflow.com/questions/44641615/how-to-tackle-cors-issue-on-local-system/44643234#44643234", "title": "How to tackle Cors issue on local system?", "body": "<p>Ok, The solution for above problem is at this link <a href=\"https://github.com/rs/cors/blob/master/README.md\" rel=\"nofollow noreferrer\">Go Cors Handler</a>. It does the trick. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5906464"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 44643234, "answer_count": 1, "score": 0, "last_activity_date": 1497930129, "creation_date": 1497916332, "last_edit_date": 1497930129, "question_id": 44641615, "link": "https://stackoverflow.com/questions/44641615/how-to-tackle-cors-issue-on-local-system", "title": "How to tackle Cors issue on local system?", "body": "<p>I'm working on very basic web app where the server is running on localhost:12345 and client runs on localhost:3000. I'm doing this because, I wrote an actual app and there is cors issue in the production. So I started to drill down to the basic and fix the issue. But I failed. My backend is in 'go'. Here is the 1st html:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"utf-8\"&gt;\n    &lt;title&gt;This is page1&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    Hi this is page1\n\n    &lt;a href=\"index2.html\" id='link'&gt;About this web app&lt;/a&gt;\n  &lt;/body&gt;\n\n\n\n&lt;/html&gt;\n</code></pre>\n\n<p>Here is the second html:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"utf-8\"&gt;\n    &lt;title&gt;&lt;/title&gt;\n    &lt;script type=\"text/javascript\" src='jquery.js'&gt;\n\n    &lt;/script&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    This is page2\n  &lt;/body&gt;\n  &lt;script type=\"text/javascript\"&gt;\n    $.ajax({\n      type: 'GET',\n      url: 'http://localhost:12345/people',\n      contentType: 'application/json',\n      success: function(response){\n        alert(response);\n      },\n      error: function(err){\n        alert(JSON.stringify(err));\n      }\n    })\n  &lt;/script&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>And finally the backend code:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"log\"\n    \"net/http\"\n    \"fmt\"\n    \"github.com/gorilla/mux\"\n    \"github.com/gorilla/handlers\"\n)\n\ntype Person struct {\n    ID        string   `json:\"id,omitempty\"`\n    Firstname string   `json:\"firstname,omitempty\"`\n    Lastname  string   `json:\"lastname,omitempty\"`\n    Address   *Address `json:\"address,omitempty\"`\n}\n\ntype Address struct {\n    City  string `json:\"city,omitempty\"`\n    State string `json:\"state,omitempty\"`\n}\n\nvar people []Person\n\nfunc GetPersonEndpoint(w http.ResponseWriter, req *http.Request) {\n    params := mux.Vars(req)\n    for _, item := range people {\n        if item.ID == params[\"id\"] {\n            json.NewEncoder(w).Encode(item)\n            return\n        }\n    }\n    json.NewEncoder(w).Encode(&amp;Person{})\n}\n\n\nfunc GetPeopleEndpoint(w http.ResponseWriter, req *http.Request) {\n    json.NewEncoder(w).Encode(people)\n}\n\nfunc CreatePersonEndpoint(w http.ResponseWriter, req *http.Request) {\n    params := mux.Vars(req)\n    var person Person\n    _ = json.NewDecoder(req.Body).Decode(&amp;person)\n    person.ID = params[\"id\"]\n    people = append(people, person)\n    json.NewEncoder(w).Encode(people)\n}\n\nfunc DeletePersonEndpoint(w http.ResponseWriter, req *http.Request) {\n    params := mux.Vars(req)\n    for index, item := range people {\n        if item.ID == params[\"id\"] {\n            people = append(people[:index], people[index+1:]...)\n            break\n        }\n    }\n    json.NewEncoder(w).Encode(people)\n}\n\nfunc main() {\n    router := mux.NewRouter()\n    people = append(people, Person{ID: \"1\", Firstname: \"Nic\", Lastname: \"Raboy\", Address: &amp;Address{City: \"Dublin\", State: \"CA\"}})\n    people = append(people, Person{ID: \"2\", Firstname: \"Maria\", Lastname: \"Raboy\"})\n    fmt.Println( people);\n    router.HandleFunc(\"/people\", GetPeopleEndpoint).Methods(\"GET\")\n    router.HandleFunc(\"/people/{id}\", GetPersonEndpoint).Methods(\"GET\")\n    router.HandleFunc(\"/people/{id}\", CreatePersonEndpoint).Methods(\"POST\")\n    router.HandleFunc(\"/people/{id}\", DeletePersonEndpoint).Methods(\"DELETE\")\n\n   headersOk := handlers.AllowedHeaders([]string{\"X-Requested-With\"})\noriginsOk := handlers.AllowedOrigins([]string{os.Getenv(\"ORIGIN_ALLOWED\")})\nmethodsOk := handlers.AllowedMethods([]string{\"GET\", \"HEAD\", \"POST\", \"PUT\", \"OPTIONS\"})\n\n// start server listen\n// with error handling\nlog.Fatal(http.ListenAndServe(\":\" + os.Getenv(\"PORT\"), handlers.CORS(originsOk, headersOk, methodsOk)(router)))\n}\n</code></pre>\n"}, {"tags": ["go", "google-bigquery"], "comments": [{"owner": {"reputation": 25696, "user_id": 6253347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1387a55798cae58a3a836dcbcd6e1951?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott Brossard", "link": "https://stackoverflow.com/users/6253347/elliott-brossard"}, "edited": false, "score": 0, "creation_date": 1497914228, "post_id": 44641199, "comment_id": 76268609, "body": "I know very little about Go, but does this help? You can see how <code>InferSchema</code> is implemented, which might get you started with defining a <code>DATETIME</code> column instead: <a href=\"https://github.com/GoogleCloudPlatform/google-cloud-go/blob/master/bigquery/schema.go\" rel=\"nofollow noreferrer\">github.com/GoogleCloudPlatform/google-cloud-go/blob/master/&hellip;</a>&zwnj;&#8203;."}], "answers": [{"tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 7, "last_activity_date": 1497914945, "creation_date": 1497914945, "answer_id": 44641440, "question_id": 44641199, "link": "https://stackoverflow.com/questions/44641199/how-to-create-a-datetime-field-in-bigquery-and-update-it-in-golang/44641440#44641440", "title": "How to create a DateTime field in bigquery and update it in golang?", "body": "<p>I have not used the bigquery, however I had a look at the <a href=\"https://godoc.org/cloud.google.com/go/bigquery#hdr-Schemas\" rel=\"noreferrer\">godoc</a> and <a href=\"https://github.com/GoogleCloudPlatform/google-cloud-go/blob/master/bigquery/schema.go#L202\" rel=\"noreferrer\">source code</a>.</p>\n\n<p>It seems, you have to use data type <code>civil.DateTime</code> <a href=\"https://github.com/GoogleCloudPlatform/google-cloud-go/blob/master/civil/civil.go#L196\" rel=\"noreferrer\">reference</a> in the struct.</p>\n\n<p><strong>For e.g:</strong> </p>\n\n<p>As per godoc and source code, following should create <a href=\"https://cloud.google.com/bigquery/docs/reference/standard-sql/data-types#datetime-type\" rel=\"noreferrer\">DateTime</a> field.</p>\n\n<pre><code>type data_pix struct {\n   Id      string\n   IdC     string\n   Stamp   civil.DateTime\n   Tag     []string\n}\n\nschema, err := bigquery.InferSchema(data_pix{})\n// now schema should represent DateTime Field\n</code></pre>\n\n<p>There is a <a href=\"https://github.com/GoogleCloudPlatform/google-cloud-go/blob/9aed268b14ec7c57a2aa86795c0e63e138084524/civil/civil.go#L204\" rel=\"noreferrer\">function</a> to get <code>civil.DateTime</code> from <code>time.Time</code>. I would suggest you have a look at this <a href=\"https://github.com/GoogleCloudPlatform/google-cloud-go/blob/master/civil/civil.go\" rel=\"noreferrer\">go sourcecode</a> to know more.</p>\n"}], "owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1953, "favorite_count": 0, "accepted_answer_id": 44641440, "answer_count": 1, "score": 2, "last_activity_date": 1497914945, "creation_date": 1497913210, "question_id": 44641199, "link": "https://stackoverflow.com/questions/44641199/how-to-create-a-datetime-field-in-bigquery-and-update-it-in-golang", "title": "How to create a DateTime field in bigquery and update it in golang?", "body": "<p>here is basically my creation script for bigquery in golang  :</p>\n\n<pre><code>type data_pix struct {\n    Id string\n    IdC string\n    Stamp   int64\n    Tag []string\n\n\n}\nfunc createTable(client *bigquery.Client, datasetID, tableID string) error {\n    ctx := context.Background()\n    // [START bigquery_create_table]\n    schema, err := bigquery.InferSchema(data_pix{})\n    if err != nil {\n        return err\n    }\n    table := client.Dataset(datasetID).Table(tableID)\n    if err := table.Create(ctx, schema); err != nil {\n        return err\n    }\n    // [END bigquery_create_table]\n    return nil\n}\n</code></pre>\n\n<p>for the moment i use mainly a timestamp in Int64.</p>\n\n<p>But i am looking for any example on how to add Datetime to my struct and btw add Datetime to my data</p>\n\n<p>Thanks and regards</p>\n"}, {"tags": ["sql", "postgresql", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1497907107, "post_id": 44640035, "comment_id": 76266188, "body": "This seems very much like an <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY Problem</a>. What are you actually trying to do?"}], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 1, "last_activity_date": 1497907073, "creation_date": 1497907073, "answer_id": 44640112, "question_id": 44640035, "link": "https://stackoverflow.com/questions/44640035/is-it-possible-to-get-the-sql-query-string-from-sql-rows-in-golang/44640112#44640112", "title": "Is it possible to get the SQL query string from sql.Rows in Golang?", "body": "<blockquote>\n  <p>Can I somehow get an SQL string from the rows instance?</p>\n</blockquote>\n\n<p>No.  This is easily answered by <a href=\"https://golang.org/pkg/database/sql/#Rows\" rel=\"nofollow noreferrer\">reading the documentation</a>. Rows has no exported fields, and has only the following methods:</p>\n\n<pre><code>type Rows\n    func (rs *Rows) Close() error\n    func (rs *Rows) ColumnTypes() ([]*ColumnType, error)\n    func (rs *Rows) Columns() ([]string, error)\n    func (rs *Rows) Err() error\n    func (rs *Rows) Next() bool\n    func (rs *Rows) NextResultSet() bool\n    func (rs *Rows) Scan(dest ...interface{}) error\n</code></pre>\n\n<p>I have to wonder why you would want this... you already know what query was used.</p>\n"}], "owner": {"reputation": 355, "user_id": 4423629, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/3fa874ac0511f471b34d491c0b45c1e8?s=128&d=identicon&r=PG&f=1", "display_name": "starwars25", "link": "https://stackoverflow.com/users/4423629/starwars25"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 300, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1497907073, "creation_date": 1497906737, "question_id": 44640035, "link": "https://stackoverflow.com/questions/44640035/is-it-possible-to-get-the-sql-query-string-from-sql-rows-in-golang", "title": "Is it possible to get the SQL query string from sql.Rows in Golang?", "body": "<p>I have the following code:</p>\n\n<pre><code>selectPart := \"id, user_id, date, time, minutes, details, created_at, updated_at, project_id\"\nsqlQuery := fmt.Sprintf(\"SELECT %s FROM time_entries WHERE user_id = $1 AND date &gt;= $2 and date &lt;= $3\", selectPart)\n\nvar rows *sql.Rows\nvar err error\n\nif project == nil {\n    rows, err = DB.Query(sqlQuery, user.ID, formatDate(from), formatDate(to))\n} else {\n    rows, err = DB.Query(sqlQuery + \" AND project_id = $4\", user.ID, formatDate(from), formatDate(to), project.ID)\n}\n</code></pre>\n\n<p>The resulting rows structure is empty. I suppose it is because the interpolation of data is wrong. I am using PostgreSQL. Can I somehow get an SQL string from the <code>rows</code> instance?</p>\n"}, {"tags": ["git", "go", "gogs"], "comments": [{"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 1, "creation_date": 1497956228, "post_id": 44639888, "comment_id": 76287133, "body": "I don&#39;t think each of the sub-directories need to be git submodules. I have created and used local go packages that were written adhoc without version control."}], "owner": {"reputation": 501, "user_id": 7380164, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SNraR.jpg?s=128&g=1", "display_name": "Sean Gregory", "link": "https://stackoverflow.com/users/7380164/sean-gregory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1497906052, "creation_date": 1497906052, "question_id": 44639888, "link": "https://stackoverflow.com/questions/44639888/go-local-imports-with-ci", "title": "Go local imports with CI", "body": "<p>I understand Go is pretty opinionated about local import paths.</p>\n\n<p>I have a CI/Git server set up with Gogs and Drone - lets call it <code>ci.company.corp</code>\nwhen requiring files locally I would write something like this:</p>\n\n<p><code>import 'ci.company.corp/seangregory/project/server/models'</code></p>\n\n<p>I'd like to use glide to manage packages, but I'll keep it simple for now.</p>\n\n<p>I can push this code to Gogs, and in turn \"go get ci.company.corp/seangregory/project\"  but when I try to build using drone in a docker container, it can't resolve the sub directories from the local imports.</p>\n\n<p>Are each of these sub-directories supposed to be a git submodule?  is it an issue with Gogs?  </p>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 1818, "user_id": 2171758, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/0pO0W.jpg?s=128&g=1", "display_name": "salient", "link": "https://stackoverflow.com/users/2171758/salient"}, "is_accepted": true, "score": 1, "last_activity_date": 1497901463, "creation_date": 1497901463, "answer_id": 44638706, "question_id": 44638610, "link": "https://stackoverflow.com/questions/44638610/inserting-custom-time-scanner-and-valuer-implemented-but-still-errs/44638706#44638706", "title": "Inserting custom time, Scanner and Valuer implemented \u2014 but still errs", "body": "<p>Found the solution, <code>Scanner</code> and <code>Valuer</code> should be implemented on the actual value and not a pointer to the <code>customTime</code></p>\n\n<pre><code>func (ct customTime) Scan(value interface{}) error {\n    ct.Time = value.(time.Time)\n    return nil\n}\n\nfunc (ct customTime) Value() (driver.Value, error) {\n    return ct.Time, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 1818, "user_id": 2171758, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/0pO0W.jpg?s=128&g=1", "display_name": "salient", "link": "https://stackoverflow.com/users/2171758/salient"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 477, "favorite_count": 0, "accepted_answer_id": 44638706, "answer_count": 1, "score": 1, "last_activity_date": 1497901600, "creation_date": 1497901143, "last_edit_date": 1497901600, "question_id": 44638610, "link": "https://stackoverflow.com/questions/44638610/inserting-custom-time-scanner-and-valuer-implemented-but-still-errs", "title": "Inserting custom time, Scanner and Valuer implemented \u2014 but still errs", "body": "<p>I have a custom time format that is the result of some custom unmarshalling:</p>\n\n<pre><code>type customTime struct {\n    time.Time\n}\n</code></pre>\n\n<p>I have implemented the <code>Scanner</code> and <code>Valuer</code> interface on this <code>customTime</code> like so:</p>\n\n<pre><code>func (ct *customTime) Scan(value interface{}) error {\n    ct.Time = value.(time.Time)\n    return nil\n}\n\nfunc (ct *customTime) Value() (driver.Value, error) {\n    return ct.Time, nil\n}\n</code></pre>\n\n<p>But it still errs when I try to do the insert:</p>\n\n<blockquote>\n  <p>sql: converting Exec argument $3 type: unsupported type main.customTime, a struct</p>\n</blockquote>\n\n<p>What am I missing?</p>\n"}, {"tags": ["go", "amazon-s3", "aws-sdk-go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497901440, "post_id": 44638608, "comment_id": 76263271, "body": "Have you tried it?"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1497903569, "post_id": 44638608, "comment_id": 76264438, "body": "What is the question exactly?"}, {"owner": {"reputation": 4263, "user_id": 148736, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98ce675339d7e7c8269349943d6a0823?s=128&d=identicon&r=PG", "display_name": "Andrew Arrow", "link": "https://stackoverflow.com/users/148736/andrew-arrow"}, "edited": false, "score": 0, "creation_date": 1497903834, "post_id": 44638608, "comment_id": 76264571, "body": "ah, <a href=\"https://github.com/aws/aws-sdk-go/issues/745\" rel=\"nofollow noreferrer\">github.com/aws/aws-sdk-go/issues/745</a> explains"}], "owner": {"reputation": 4263, "user_id": 148736, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98ce675339d7e7c8269349943d6a0823?s=128&d=identicon&r=PG", "display_name": "Andrew Arrow", "link": "https://stackoverflow.com/users/148736/andrew-arrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1497901140, "creation_date": 1497901140, "question_id": 44638608, "link": "https://stackoverflow.com/questions/44638608/can-i-use-s3manager-to-rename-a-large-file-or-small-file-on-s3", "title": "Can I use s3manager to rename a large file or small file on s3?", "body": "<p>This code works great when data is an <code>io.Reader</code>:</p>\n\n<p><code>\ns3manager.UploadInput{\n    Bucket: aws.String(\"MyBucket\"),\n    Key:    aws.String(\"file1.mov\"),\n    Body:   data,\n  }\n</code></p>\n\n<p>The s3 manager:</p>\n\n<p><a href=\"https://github.com/aws/aws-sdk-go/tree/master/service/s3/s3manager\" rel=\"nofollow noreferrer\">https://github.com/aws/aws-sdk-go/tree/master/service/s3/s3manager</a></p>\n\n<p>knows how to upload a 4MB file or a 14GB file with Multipart upload. i.e. the 4MB can NOT use multipart because it's too small.</p>\n\n<p>So s3manager is great for this. I don't have to worry about the size.</p>\n\n<p>But can I use s3manager also for renaming a file already on s3? The rename will do a new Multipart upload behind the scenes because the 14GB one is too big to copy without Multipart.</p>\n\n<p>(s3 has no rename feature, renames are copy then delete)</p>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 1, "creation_date": 1497898636, "post_id": 44637932, "comment_id": 76261884, "body": "Best guess is that you&#39;re still in the if block then. Have you checked the number of rows you&#39;re getting back?"}, {"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 2, "creation_date": 1497898695, "post_id": 44637932, "comment_id": 76261914, "body": "Check the error value returned by <code>db.Query</code>. It is often the case that functions/methods return a zero valued object (or a pointer to it) in case of an error. In fact this is considered good practice."}, {"owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "reply_to_user": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1497898862, "post_id": 44637932, "comment_id": 76262023, "body": "@william.taylor.09 dam you&#39;re right thanks"}], "answers": [{"tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": true, "score": 3, "last_activity_date": 1497900838, "creation_date": 1497900838, "answer_id": 44638530, "question_id": 44637932, "link": "https://stackoverflow.com/questions/44637932/else-condition-seems-not-working-in-go/44638530#44638530", "title": "Else condition seems not working in go", "body": "<p>You should get used to using '?' placeholders in your sql to allow for proper escaping and prevent any potential SQL injection attacks. </p>\n\n<p>You should always check the error in Go before using the returned value. </p>\n\n<pre><code>ip := \"192.168.0.1\"\nrows, err := db.Query(\"SELECT * FROM Ip_ipdata WHERE ipHost=?\", ip)\nif err != nil {\n    // handle error\n}\n// this will ensure that the DB connection gets put back into the pool\ndefer rows.Close()\n\nfor rows.Next() {\n    // scan here\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1511, "user_id": 495504, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ee8d8278b0394be64c52abc8d7c4ca17?s=128&d=identicon&r=PG", "display_name": "Eric Pauley", "link": "https://stackoverflow.com/users/495504/eric-pauley"}, "is_accepted": false, "score": 0, "last_activity_date": 1497901627, "creation_date": 1497901627, "answer_id": 44638751, "question_id": 44637932, "link": "https://stackoverflow.com/questions/44637932/else-condition-seems-not-working-in-go/44638751#44638751", "title": "Else condition seems not working in go", "body": "<p>The <code>Rows</code> returned by Query will not be <code>nil</code> in the case of no results, it will be empty. Try something like this:</p>\n\n<pre><code>func main() {\n    ...\n    fmt.Println(\"insert\")\n    checkErr(err)\n    defer rows.Close()\n    var found bool\n    for rows.Next() {\n        found = true\n        ...\n    }\n\n    if !found {\n        fmt.Println(\"insert2\")\n        ...\n    }\n    fmt.Println(\"end\")\n}\n</code></pre>\n\n<p>Note that like @jmaloney said, more robust error handling is a must as is closing your <code>Rows</code> pointer.</p>\n"}], "owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 44638530, "answer_count": 2, "score": 0, "last_activity_date": 1497922148, "creation_date": 1497898500, "last_edit_date": 1497922148, "question_id": 44637932, "link": "https://stackoverflow.com/questions/44637932/else-condition-seems-not-working-in-go", "title": "Else condition seems not working in go", "body": "<p>I have a MySQL database with one value in it, a string: \"192.168.0.1\"</p>\n\n<p>Here is my code:</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"fmt\"\n    _ \"github.com/go-sql-driver/mysql\"\n)\n\nfunc checkErr(err error) {\n    if err != nil {\n        panic(err)\n    }\n}\nfunc main() {\n    db, err := sql.Open(\"mysql\", \"be:me@tcp(127.0.0.1:3306)/ipdb?charset=utf8\")\n    checkErr(err)\n\n    ip := \"'192.168.0.1'\"\n    rows, err := db.Query(\"SELECT * FROM Ip_ipdata WHERE ipHost=\" + ip)\n    fmt.Println(\"insert\")\n    if rows != nil {\n        for rows.Next() {\n            var id int\n            var ip string\n            err = rows.Scan(&amp;id, &amp;ip)\n            checkErr(err)\n            fmt.Println(id)\n            fmt.Println(ip)\n        }\n\n    } else {\n        fmt.Println(\"insert2\")\n        stmt, err2 := db.Prepare(\"INSERT Ip_ipdata SET ipHost=2\")\n        checkErr(err2)\n\n        _, err3 := stmt.Exec(ip)\n        checkErr(err3)\n    }\n    fmt.Println(\"end\")\n}\n</code></pre>\n\n<p>When I put <code>\"'192.168.0.1'\"</code> in <code>ip</code> it works and shows as expected.</p>\n\n<p>But when I put <code>\"'192.168.0.2'\"</code> in <code>ip</code> the else statement isn't run and it just exits.</p>\n\n<p>It didn't print \"insert2\"</p>\n\n<p><a href=\"https://i.stack.imgur.com/Zpqkv.png\" rel=\"nofollow noreferrer\">screenshot 1</a>\n<a href=\"https://i.stack.imgur.com/X4qMN.png\" rel=\"nofollow noreferrer\">screenshot 2</a></p>\n"}, {"tags": ["linux", "ubuntu", "go", "arm", "qemu"], "comments": [{"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1497902542, "post_id": 44635983, "comment_id": 76263890, "body": "I think they say it will not work anymore...."}, {"owner": {"reputation": 558, "user_id": 5143652, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/36faf6826897032fcf9859357d05b6fb?s=128&d=identicon&r=PG&f=1", "display_name": "ErebosM", "link": "https://stackoverflow.com/users/5143652/erebosm"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1497905388, "post_id": 44635983, "comment_id": 76265368, "body": "@RickyA Okay. It is written something like that too in my link. But then my question is, if there is another possibility to customize my image? Is there another emulator?"}], "answers": [{"tags": [], "owner": {"reputation": 531, "user_id": 1844800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed5e8c3e48f6ae45238d3a1d943e3142?s=128&d=identicon&r=PG", "display_name": "alexst", "link": "https://stackoverflow.com/users/1844800/alexst"}, "is_accepted": true, "score": 2, "last_activity_date": 1498005946, "creation_date": 1498005946, "answer_id": 44665139, "question_id": 44635983, "link": "https://stackoverflow.com/questions/44635983/qemu-arm-user-emulation-error-when-using-go/44665139#44665139", "title": "Qemu-ARM user emulation. Error when using Go", "body": "<p>A workaround would be to use full system emulation in QEMU - just find an ARM kernel that boots in qemu-system-arm and instead of chrooting into the file system from the host, do it from within QEMU. </p>\n"}], "owner": {"reputation": 558, "user_id": 5143652, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/36faf6826897032fcf9859357d05b6fb?s=128&d=identicon&r=PG&f=1", "display_name": "ErebosM", "link": "https://stackoverflow.com/users/5143652/erebosm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "accepted_answer_id": 44665139, "answer_count": 1, "score": 1, "last_activity_date": 1498005946, "creation_date": 1497891065, "question_id": 44635983, "link": "https://stackoverflow.com/questions/44635983/qemu-arm-user-emulation-error-when-using-go", "title": "Qemu-ARM user emulation. Error when using Go", "body": "<p>I want to customize an image I created for an ARM device (Odroid C1+). Especially I want to checkout some git repositories and install their dependencies.</p>\n\n<p>But when installing go libraries, this bug is happening: <a href=\"https://github.com/golang/go/issues/13024\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/13024</a></p>\n\n<p>Is there a workaround? Or do you know another user emulator (or similar) to do this?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1497883870, "post_id": 44633596, "comment_id": 76252972, "body": "Besides <code>string</code> being a builtin type, don&#39;t rename imports unless you have to. There&#39;s no reason to try an use <code>str</code> instead of <code>strings</code>, when everyone else knows the package by the name <code>strings</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "is_accepted": true, "score": 3, "last_activity_date": 1497883679, "creation_date": 1497883679, "answer_id": 44633658, "question_id": 44633596, "link": "https://stackoverflow.com/questions/44633596/main-go9-use-of-package-str-without-selector/44633658#44633658", "title": "main.go:9: use of package str without selector", "body": "<p>\"string\" is a builtin. You don't need to do strings.string:</p>\n\n<p>Docs: <a href=\"https://golang.org/pkg/builtin/#string\" rel=\"nofollow noreferrer\">https://golang.org/pkg/builtin/#string</a></p>\n"}], "owner": {"reputation": 6798, "user_id": 3282434, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/bd87b9229901acfa4c6f754da6bf3655?s=128&d=identicon&r=PG&f=1", "display_name": "codyc4321", "link": "https://stackoverflow.com/users/3282434/codyc4321"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3984, "favorite_count": 0, "accepted_answer_id": 44633658, "answer_count": 1, "score": -2, "last_activity_date": 1503943861, "creation_date": 1497883506, "last_edit_date": 1503943861, "question_id": 44633596, "link": "https://stackoverflow.com/questions/44633596/main-go9-use-of-package-str-without-selector", "title": "main.go:9: use of package str without selector", "body": "<p>I have the following in the intepreter of Tour of Go:</p>\n\n<pre><code>package main\n\nimport (\n    \"golang.org/x/tour/wc\"\n    str \"strings\"\n)\n\nfunc WordCount(s string) map[string]int {\n    results := make(map[str]int)\n    words := str.Fields(s)\n    return map[string]int{\"x\": 1}\n}\n\n//func main() {\n//  wc.Test(WordCount)\n//}\n</code></pre>\n\n<p>This is based on <a href=\"https://tour.golang.org/moretypes/23\" rel=\"nofollow noreferrer\">https://tour.golang.org/moretypes/23</a></p>\n\n<p>My error is </p>\n\n<pre><code>tmp/sandbox169629521/main.go:9: use of package str without selector\n</code></pre>\n\n<p>Trying</p>\n\n<pre><code>results := make(map[str.string]int)\n</code></pre>\n\n<p>now fails with</p>\n\n<pre><code>tmp/sandbox424441423/main.go:9: cannot refer to unexported name strings.string\ntmp/sandbox424441423/main.go:9: undefined: strings.string\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1497883437, "post_id": 44633523, "comment_id": 76252638, "body": "You must add a <code>main()</code> function, that is the entry point of your program. You have to move your <code>fmt.Println()</code> into this <code>main()</code> function. Read <a href=\"https://golang.org/ref/spec#Program_execution\" rel=\"nofollow noreferrer\">Spec: Program execution</a>. If you&#39;re new to Go, first please take the <a href=\"https://tour.golang.org/welcome/1\" rel=\"nofollow noreferrer\">Go Tour</a>. You won&#39;t magically guess the Go syntax."}, {"owner": {"reputation": 6798, "user_id": 3282434, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/bd87b9229901acfa4c6f754da6bf3655?s=128&d=identicon&r=PG&f=1", "display_name": "codyc4321", "link": "https://stackoverflow.com/users/3282434/codyc4321"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1497883634, "post_id": 44633523, "comment_id": 76252797, "body": "I&#39;m in a tour of go, as was stated in the question. That worked, phrase as an answer if you want and I&#39;ll accept"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1497883683, "post_id": 44633523, "comment_id": 76252836, "body": "You&#39;re right, I missed that part of your question."}, {"owner": {"reputation": 6798, "user_id": 3282434, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/bd87b9229901acfa4c6f754da6bf3655?s=128&d=identicon&r=PG&f=1", "display_name": "codyc4321", "link": "https://stackoverflow.com/users/3282434/codyc4321"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1497883738, "post_id": 44633523, "comment_id": 76252875, "body": "Thank you icza, let&#39;s please not make the go community a hostile and arrogant group of &quot;wizards&quot; like python became before I left it.."}, {"owner": {"reputation": 6798, "user_id": 3282434, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/bd87b9229901acfa4c6f754da6bf3655?s=128&d=identicon&r=PG&f=1", "display_name": "codyc4321", "link": "https://stackoverflow.com/users/3282434/codyc4321"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1497883801, "post_id": 44633523, "comment_id": 76252921, "body": "Because when you wanna slow down and retire, and you can&#39;t find anyone to hire so you can get some rest, because nobody wants to deal with arrogant developers so they changed careers, now you&#39;ll know why..."}, {"owner": {"reputation": 6798, "user_id": 3282434, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/bd87b9229901acfa4c6f754da6bf3655?s=128&d=identicon&r=PG&f=1", "display_name": "codyc4321", "link": "https://stackoverflow.com/users/3282434/codyc4321"}, "edited": false, "score": 0, "creation_date": 1497883998, "post_id": 44633523, "comment_id": 76253052, "body": "Great, the go tools are worse than the python tools. Why would you not be able to print outside of a function is a better question? Who has ever seen a language you can&#39;t just print some text in normal execution?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1497884276, "post_id": 44633523, "comment_id": 76253279, "body": "@codyc4321: outside of a function <i>isn&#39;t</i> normal execution. Most (C-style) compiled languages are like this."}, {"owner": {"reputation": 6798, "user_id": 3282434, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/bd87b9229901acfa4c6f754da6bf3655?s=128&d=identicon&r=PG&f=1", "display_name": "codyc4321", "link": "https://stackoverflow.com/users/3282434/codyc4321"}, "edited": false, "score": 0, "creation_date": 1497884361, "post_id": 44633523, "comment_id": 76253329, "body": "Hmm, that&#39;s reasonable. I&#39;d still like mr. kien to explain what I should do to avoid offending him if I&#39;m already doing the tour of go and halfway done, don&#39;t mind doing it more times after this, and if he could please alert me to where he&#39;s working so I can avoid applying there would be awesome"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497885209, "post_id": 44633523, "comment_id": 76253942, "body": "@codyc4321: you can usually just ignore throw away comments like that, especially from (though I hate to say it) low-rep accounts. Just keep rolling through the documentation and tutorials, even more  than once, and it will all start to make sense."}, {"owner": {"reputation": 6798, "user_id": 3282434, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/bd87b9229901acfa4c6f754da6bf3655?s=128&d=identicon&r=PG&f=1", "display_name": "codyc4321", "link": "https://stackoverflow.com/users/3282434/codyc4321"}, "edited": false, "score": 0, "creation_date": 1497899210, "post_id": 44633523, "comment_id": 76262187, "body": "Thanks Jim. These guys are no ruder than your average python dev lol"}], "answers": [{"comments": [{"owner": {"reputation": 6798, "user_id": 3282434, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/bd87b9229901acfa4c6f754da6bf3655?s=128&d=identicon&r=PG&f=1", "display_name": "codyc4321", "link": "https://stackoverflow.com/users/3282434/codyc4321"}, "edited": false, "score": 0, "creation_date": 1497883840, "post_id": 44633607, "comment_id": 76252956, "body": "thank you for being polite. i&#39;ll accept when it lets me"}], "tags": [], "owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "is_accepted": true, "score": 4, "last_activity_date": 1497883542, "creation_date": 1497883542, "answer_id": 44633607, "question_id": 44633523, "link": "https://stackoverflow.com/questions/44633523/syntax-error-non-declaration-statement-outside-function-body-at-fmt-printlnwor/44633607#44633607", "title": "Syntax error: non-declaration statement outside function body at fmt.Println(words, length)", "body": "<p>Your issue isn't with the variable declarations, it's with the fmt.Println line. You must move this inside of a function:</p>\n\n<pre><code>func main() {\n    fmt.Println(words, length)\n}\n</code></pre>\n\n<p>GoPlay here:<br>\n<a href=\"https://play.golang.org/p/JhUnNEIxIY\" rel=\"nofollow noreferrer\">https://play.golang.org/p/JhUnNEIxIY</a></p>\n"}], "owner": {"reputation": 6798, "user_id": 3282434, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/bd87b9229901acfa4c6f754da6bf3655?s=128&d=identicon&r=PG&f=1", "display_name": "codyc4321", "link": "https://stackoverflow.com/users/3282434/codyc4321"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3771, "favorite_count": 0, "accepted_answer_id": 44633607, "answer_count": 1, "score": -1, "last_activity_date": 1503948559, "creation_date": 1497883280, "last_edit_date": 1503948559, "question_id": 44633523, "link": "https://stackoverflow.com/questions/44633523/syntax-error-non-declaration-statement-outside-function-body-at-fmt-printlnwor", "title": "Syntax error: non-declaration statement outside function body at fmt.Println(words, length)", "body": "<p>I have the following in the interpreter in the tour of go:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nvar someString = \"one    two   three four \"\n\nvar words = strings.Fields(someString)\n\nvar length = len(words)\n\nfmt.Println(words, length)\n</code></pre>\n\n<p>I get</p>\n\n<pre><code>tmp/sandbox216066597/main.go:11: syntax error: non-declaration statement outside function body\n</code></pre>\n\n<p>I recently corrected it by using <code>var</code> instead of <code>:=</code> short syntax outside of any functions, but the error is the same as before.</p>\n"}, {"tags": ["curl", "go", "kubernetes"], "comments": [{"owner": {"reputation": 10112, "user_id": 396567, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XKKMJ.jpg?s=128&g=1", "display_name": "Michael Hausenblas", "link": "https://stackoverflow.com/users/396567/michael-hausenblas"}, "edited": false, "score": 1, "creation_date": 1497891631, "post_id": 44631147, "comment_id": 76258005, "body": "Did you check out <a href=\"https://github.com/kubernetes/client-go/tree/master/examples/create-update-delete-deployment\" rel=\"nofollow noreferrer\">github.com/kubernetes/client-go/tree/master/examples/&hellip;</a> and <a href=\"https://github.com/appscode/kloader\" rel=\"nofollow noreferrer\">github.com/appscode/kloader</a> already?"}, {"owner": {"reputation": 360, "user_id": 3809480, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/994af2548db4151c47a51230385fc3ca?s=128&d=identicon&r=PG&f=1", "display_name": "Evya2005", "link": "https://stackoverflow.com/users/3809480/evya2005"}, "reply_to_user": {"reputation": 10112, "user_id": 396567, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XKKMJ.jpg?s=128&g=1", "display_name": "Michael Hausenblas", "link": "https://stackoverflow.com/users/396567/michael-hausenblas"}, "edited": false, "score": 0, "creation_date": 1497944577, "post_id": 44631147, "comment_id": 76278751, "body": "i didn&#39;t found the command i looking for"}, {"owner": {"reputation": 10112, "user_id": 396567, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XKKMJ.jpg?s=128&g=1", "display_name": "Michael Hausenblas", "link": "https://stackoverflow.com/users/396567/michael-hausenblas"}, "edited": false, "score": 0, "creation_date": 1497944930, "post_id": 44631147, "comment_id": 76278986, "body": "It&#39;s in the first link, please do put a little bit of effort into it ..."}, {"owner": {"reputation": 43932, "user_id": 64633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27081fdeb4fdc784fa1f14ec0fb2e1db?s=128&d=identicon&r=PG", "display_name": "Rod", "link": "https://stackoverflow.com/users/64633/rod"}, "edited": false, "score": 0, "creation_date": 1497957363, "post_id": 44631147, "comment_id": 76287995, "body": "To be more precise <a href=\"https://kubernetes.io/docs/concepts/workloads/controllers/deployment/\" rel=\"nofollow noreferrer\">kubernetes.io/docs/concepts/workloads/controllers/deployment</a> and look for <b>Updating a Deployment</b>"}, {"owner": {"reputation": 360, "user_id": 3809480, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/994af2548db4151c47a51230385fc3ca?s=128&d=identicon&r=PG&f=1", "display_name": "Evya2005", "link": "https://stackoverflow.com/users/3809480/evya2005"}, "reply_to_user": {"reputation": 10112, "user_id": 396567, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XKKMJ.jpg?s=128&g=1", "display_name": "Michael Hausenblas", "link": "https://stackoverflow.com/users/396567/michael-hausenblas"}, "edited": false, "score": 0, "creation_date": 1497968736, "post_id": 44631147, "comment_id": 76296885, "body": "@MichaelHausenblas I&#39;m new with kubernetes. I saw that the &#39;update&#39; function require param called in this case &#39;result&#39; that came from create as return value. I didn&#39;t understand if there is a way to just update (like refresh) the deployment without sending params, and more important - to make sure it&#39;s happens with rolling-update"}, {"owner": {"reputation": 360, "user_id": 3809480, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/994af2548db4151c47a51230385fc3ca?s=128&d=identicon&r=PG&f=1", "display_name": "Evya2005", "link": "https://stackoverflow.com/users/3809480/evya2005"}, "reply_to_user": {"reputation": 43932, "user_id": 64633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27081fdeb4fdc784fa1f14ec0fb2e1db?s=128&d=identicon&r=PG", "display_name": "Rod", "link": "https://stackoverflow.com/users/64633/rod"}, "edited": false, "score": 0, "creation_date": 1497968825, "post_id": 44631147, "comment_id": 76296952, "body": "@Rod This is the way to do it with kubectl. In my golang pod there is no kubectl installed."}, {"owner": {"reputation": 10112, "user_id": 396567, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XKKMJ.jpg?s=128&g=1", "display_name": "Michael Hausenblas", "link": "https://stackoverflow.com/users/396567/michael-hausenblas"}, "edited": false, "score": 1, "creation_date": 1497969810, "post_id": 44631147, "comment_id": 76297784, "body": "OIC @Evya2005 I assumed you&#39;re familiar with K8S. So yes, rolling update is the default so this will work as expected. Also, if you have an existing deployment, just skip the creation part and use <a href=\"https://github.com/kubernetes/client-go/blob/master/examples/create-update-delete-deployment/main.go#L133\" rel=\"nofollow noreferrer\">List</a> to fetch it."}, {"owner": {"reputation": 360, "user_id": 3809480, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/994af2548db4151c47a51230385fc3ca?s=128&d=identicon&r=PG&f=1", "display_name": "Evya2005", "link": "https://stackoverflow.com/users/3809480/evya2005"}, "reply_to_user": {"reputation": 10112, "user_id": 396567, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XKKMJ.jpg?s=128&g=1", "display_name": "Michael Hausenblas", "link": "https://stackoverflow.com/users/396567/michael-hausenblas"}, "edited": false, "score": 0, "creation_date": 1497971367, "post_id": 44631147, "comment_id": 76298941, "body": "@MichaelHausenblas Do u mean i can call List and then find my deployment in the list and send it to &#39;update&#39; as param? instead of &#39;result&#39; ?"}, {"owner": {"reputation": 10112, "user_id": 396567, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XKKMJ.jpg?s=128&g=1", "display_name": "Michael Hausenblas", "link": "https://stackoverflow.com/users/396567/michael-hausenblas"}, "edited": false, "score": 1, "creation_date": 1497971561, "post_id": 44631147, "comment_id": 76299081, "body": "Yes this is exactly what in mean."}], "owner": {"reputation": 360, "user_id": 3809480, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/994af2548db4151c47a51230385fc3ca?s=128&d=identicon&r=PG&f=1", "display_name": "Evya2005", "link": "https://stackoverflow.com/users/3809480/evya2005"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1497891310, "creation_date": 1497876766, "last_edit_date": 1497891310, "question_id": 44631147, "link": "https://stackoverflow.com/questions/44631147/kubernetes-perform-rolling-update-with-golang-plugin", "title": "Kubernetes - Perform rolling update with Golang plugin", "body": "<p>I have a <strong>docker</strong> in <strong>kubernetes</strong> that <strong>listen</strong> to <strong>configMap</strong> changes and trigger a <strong>golang</strong> function every change.  </p>\n\n<p>I want to perform <code>rolling-update</code> to <strong>deployment</strong> in this part and i didn't find any <strong>api</strong> that have this command.  </p>\n\n<p>Is there anyone who know an <strong>api</strong> with this command?<br>\nOr know a better way to get to the same result? </p>\n"}, {"tags": ["json", "go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 4609, "user_id": 1699956, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oBr6e.jpg?s=128&g=1", "display_name": "Mangat Rai Modi", "link": "https://stackoverflow.com/users/1699956/mangat-rai-modi"}, "edited": false, "score": 0, "creation_date": 1497873359, "post_id": 44629839, "comment_id": 76245313, "body": "Ouch, that solved. thanks. However still didn&#39;t understand completely. why order key is working in that case..."}, {"owner": {"reputation": 4609, "user_id": 1699956, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oBr6e.jpg?s=128&g=1", "display_name": "Mangat Rai Modi", "link": "https://stackoverflow.com/users/1699956/mangat-rai-modi"}, "edited": false, "score": 0, "creation_date": 1497873398, "post_id": 44629839, "comment_id": 76245337, "body": "ah understood, here order key name was same as schema"}, {"owner": {"reputation": 1338, "user_id": 2969090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44eb8fd2813c441b354f051042ea4e3?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/2969090/ravi"}, "edited": false, "score": 0, "creation_date": 1497882135, "post_id": 44629839, "comment_id": 76251703, "body": "Just to make this clearer, in case of the incorrectly specified struct (just the tag actually) with space in between json and attribute name, it totally ignores the tag spec since it contains a space after &quot;json:&quot;  (invalid) &amp; tries to map the field names directly. So it works only for &quot;Order&quot; and not &quot;Na me&quot; (even if we chang the Order tag to any junk value e.g change that line to: Order string <code>json: &quot;ABCD,omitempty&quot;</code> it&#39;ll still work)"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 6, "last_activity_date": 1497885583, "last_edit_date": 1497885583, "creation_date": 1497873087, "answer_id": 44629839, "question_id": 44629731, "link": "https://stackoverflow.com/questions/44629731/cant-unmarshall-json-with-key-names-having-spaces/44629839#44629839", "title": "Can&#39;t unmarshall JSON with key names having spaces", "body": "<p>Your <code>json</code> <a href=\"https://stackoverflow.com/questions/10858787/what-are-the-uses-for-tags-in-go/30889373#30889373\">tag specification</a> is incorrect, that's why the <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow noreferrer\"><code>encoding/json</code></a> library defaults to the field name which is <code>Name</code>. But since there is no JSON field with <code>\"Name\"</code> key, <code>Animal.Name</code> will remain its zero value (which is the empty string <code>\"\"</code>).</p>\n\n<p>Unmarshaling <code>Order</code> will still work, because the <code>json</code> package will use the field name if <code>json</code> tag specification is missing (tries with both lower and upper-case). Since the field name is identical to the JSON key, it works without extra JSON tag mapping.</p>\n\n<p>You can't have a space in the tag specification after the colon and before the quotation mark:</p>\n\n<pre><code>type Animal struct {\n    Name  string `json:\"Na me\"`\n    Order string `json:\"Order,omitempty\"`\n}\n</code></pre>\n\n<p>With this simple change, it works (try it on the <a href=\"https://play.golang.org/p/ij_EunyeJB\" rel=\"nofollow noreferrer\">Go Playground)</a>:</p>\n\n<pre><code>[{Name:Platypus Order:Monotremata} {Name:Quoll Order:Dasyuromorphia}]\n</code></pre>\n"}], "owner": {"reputation": 4609, "user_id": 1699956, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oBr6e.jpg?s=128&g=1", "display_name": "Mangat Rai Modi", "link": "https://stackoverflow.com/users/1699956/mangat-rai-modi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1909, "favorite_count": 0, "accepted_answer_id": 44629839, "answer_count": 1, "score": 1, "last_activity_date": 1497885583, "creation_date": 1497872832, "last_edit_date": 1497873370, "question_id": 44629731, "link": "https://stackoverflow.com/questions/44629731/cant-unmarshall-json-with-key-names-having-spaces", "title": "Can&#39;t unmarshall JSON with key names having spaces", "body": "<p>Some JSON data I am getting have spaces in the key names. I am using standard <code>encoding/json</code> library to unmarshal the data. However it is unable to understand the keys with spaces in the schema. For e.g. following code:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\nfunc main() {\n    var jsonBlob = []byte(`[\n        {\"Na me\": \"Platypus\", \"Order\": \"Monotremata\"},\n        {\"Na me\": \"Quoll\",    \"Order\": \"Dasyuromorphia\"}\n    ]`)\n    type Animal struct {\n        Name  string `json: \"Na me\"`\n        Order string `json: \"Order,omitempty\"`\n    }\n    var animals []Animal\n    err := json.Unmarshal(jsonBlob, &amp;animals)\n    if err != nil {\n        fmt.Println(\"error:\", err)\n    }\n    fmt.Printf(\"%+v\", animals)\n}\n</code></pre>\n\n<p>Gives the output as:</p>\n\n<pre><code>[{Name: Order:Monotremata} {Name: Order:Dasyuromorphia}]\n</code></pre>\n\n<p>So in the schema the library removes the space(from <strong>Na me</strong>) and try to find the key (<strong>Name</strong>), which is obviously not present. Any suggestion what can I do here?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ssl", "go", "grpc"], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 5511606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74f6ded64f3be372a26d22a97dfb97f4?s=128&d=identicon&r=PG&f=1", "display_name": "apolcyn", "link": "https://stackoverflow.com/users/5511606/apolcyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1498658469, "creation_date": 1498658469, "answer_id": 44804709, "question_id": 44627766, "link": "https://stackoverflow.com/questions/44627766/rubys-grpcv1-3-2-gem-ssl-tls-connection-issue-with-grpc-server-built-entirely/44804709#44804709", "title": "Ruby&#39;s grpc(v1.3.2) gem SSL/TLS connection issue with grpc server built entirely in golang", "body": "<blockquote>\n  <p>creds is supposed to be either ChannelCredentials object or a symbol</p>\n</blockquote>\n\n<p>Yes the second argument of a client stub constructor (the creds argument), should be either a <code>GRPC::Core::ChannelCredentials</code> object or <i>specifically</i> the <code>::this_channel_is_insecure</code> symbol (if the latter is passed, an insecure connection will be used).</p>\n\n<p>I'd note that the test that uses </p>\n\n<pre><code>def load_certs\n  data_dir = \"#{Rails.root}/certs\"\n  files = ['ca.pem', 'server.key', 'server.pem']\n  files.map { |f| File.open(File.join(data_dir, f)).read }\nend\n</code></pre>\n\n<p>might actually be misleading, since it only makes sense to construct channel credentials with the <i>client's</i> private key and certificate chain (that specific test I believe doesn't use the key and cert chain).</p>\n\n<p><strong>On the <code>GRPC::Core::ChannelCredentials</code> constructor:</strong></p>\n\n<p>There are three forms that can be used, (there's a comment above the constructor code in <a href=\"https://github.com/grpc/grpc/blob/master/src/ruby/ext/grpc/rb_channel_credentials.c#L128\" rel=\"nofollow noreferrer\">https://github.com/grpc/grpc/blob/master/src/ruby/ext/grpc/rb_channel_credentials.c#L128</a> that goes over them), but the options are:</p>\n\n<ul>\n<li><p><code>Credentials.new()</code></p></li>\n<li><p><code>Credentials.new(pem_root_certs)</code></p></li>\n<li><p><code>Credentials.new(pem_root_certs, pem_private_key, pem_cert_chain)</code></p></li>\n</ul>\n\n<p>In all cases, the roots file, private key, and cert chain parameters are pem encoded strings.</p>\n\n<p>Note that if no arguments are passed (<code>Credentials.new()</code> is used), then the server root certificates will be found as described in <a href=\"https://github.com/grpc/grpc/blob/master/include/grpc/grpc_security.h#L147\" rel=\"nofollow noreferrer\">this header comment</a> (see the description for the behavior when server root certs parameter is null). And the last constructor is only needed if you want the <i>client</i> to use a private key and cert chain.</p>\n"}, {"tags": [], "owner": {"reputation": 134, "user_id": 2184010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ri1NJ.png?s=128&g=1", "display_name": "webgen", "link": "https://stackoverflow.com/users/2184010/webgen"}, "is_accepted": false, "score": 0, "last_activity_date": 1518719276, "creation_date": 1518719276, "answer_id": 48814011, "question_id": 44627766, "link": "https://stackoverflow.com/questions/44627766/rubys-grpcv1-3-2-gem-ssl-tls-connection-issue-with-grpc-server-built-entirely/48814011#48814011", "title": "Ruby&#39;s grpc(v1.3.2) gem SSL/TLS connection issue with grpc server built entirely in golang", "body": "<p>I can confirm this works. </p>\n\n<pre><code>channel_creds = GRPC::Core::ChannelCredentials.new(File.read(\"/home/user/.lnd/tls.cert\"))\nstub = Lnrpc::Lightning::Stub.new(\"127.0.0.1:10009\", channel_creds)\nobj = Lnrpc::GetInfoRequest.new\npp stub.get_info(obj)\n</code></pre>\n"}], "owner": {"reputation": 1429, "user_id": 777617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96812835dc39a2acdfc78a950da16f51?s=128&d=identicon&r=PG", "display_name": "Cyclops", "link": "https://stackoverflow.com/users/777617/cyclops"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 978, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1518719276, "creation_date": 1497867095, "last_edit_date": 1497873471, "question_id": 44627766, "link": "https://stackoverflow.com/questions/44627766/rubys-grpcv1-3-2-gem-ssl-tls-connection-issue-with-grpc-server-built-entirely", "title": "Ruby&#39;s grpc(v1.3.2) gem SSL/TLS connection issue with grpc server built entirely in golang", "body": "<p>Recently, I was trying to use rubygem grpc version 1.3.2 as a clinet and connect to a grpc server which is built from golang. I went through the documentation at <a href=\"http://grpc.io/docs/guides/auth.html\" rel=\"nofollow noreferrer\">GRPC.IO</a> and used it in my code as it.</p>\n\n<pre><code>    irb(main):017:0&gt; GRPC::Core::Credentials.new(File.read(CA_FILE_PATH))\nNameError: uninitialized constant GRPC::Core::Credentials\n        from (irb):17\n        from /usr/local/share/gems/gems/railties-4.2.1/lib/rails/commands/console.rb:110:in `start'\n        from /usr/local/share/gems/gems/railties-4.2.1/lib/rails/commands/console.rb:9:in `start'\n        from /usr/local/share/gems/gems/railties-4.2.1/lib/rails/commands/commands_tasks.rb:68:in `console'\n        from /usr/local/share/gems/gems/railties-4.2.1/lib/rails/commands/commands_tasks.rb:39:in `run_command!'\n        from /usr/local/share/gems/gems/railties-4.2.1/lib/rails/commands.rb:17:in `&lt;top (required)&gt;'\n        from bin/rails:4:in `require'\n        from bin/rails:4:in `&lt;main&gt;'\n</code></pre>\n\n<p>However their documentation specifically says,</p>\n\n<pre><code>creds = GRPC::Core::Credentials.new(load_certs)  # load_certs typically loads a CA roots file\nstub = Helloworld::Greeter::Stub.new('myservice.example.com', creds)\n</code></pre>\n\n<p>Then I came across <strong>ChannelCredentials</strong> and the <em>creds</em> is supposed to be either <strong>ChannelCredentials</strong> object or a symbol(e.g. <em>:this_channel_is_insecure</em>). Hence, I gave it a try as well.</p>\n\n<p>I've taken the following function from the grpc gem's source code itself. This function was called in rspec test cases for loading the certs:</p>\n\n<pre><code>def load_certs\n      data_dir = \"#{Rails.root}/certs\"\n      files = ['ca.pem', 'server.key', 'server.pem']\n      files.map { |f| File.open(File.join(data_dir, f)).read }\nend\n</code></pre>\n\n<p>Then I gave it a try with,</p>\n\n<pre><code>channel_creds = GRPC::Core::ChannelCredentials.new(load_certs)\nstub = Helloworld::Greeter::Stub.new('myservice.example.com', channel_creds)\n</code></pre>\n\n<p>But the above failed with</p>\n\n<pre><code>E0619 09:59:10.410575570   14208 ssl_transport_security.c:601] Could not load any root certificate.\nE0619 09:59:10.410604954   14208 ssl_transport_security.c:1315] Cannot load server root certificates.\nE0619 09:59:10.410622519   14208 security_connector.c:837]   Handshaker factory creation failed with TSI_INVALID_ARGUMENT.\n</code></pre>\n\n<p>I also tried:</p>\n\n<pre><code>channel_creds = GRPC::Core::ChannelCredentials.new(File.read(CA_FILE_PATH))\nstub = Helloworld::Greeter::Stub.new('myservice.example.com', creds)\n</code></pre>\n\n<p>But all I got was error from the logs or rpc server:</p>\n\n<pre><code>2017/06/16 10:52:34 transport: http2Server.HandleStreams failed to receive the preface from client: EOF\n2017/06/16 10:53:35 transport: http2Server.HandleStreams failed to receive the preface from client: EOF\n2017/06/16 10:53:59 transport: http2Server.HandleStreams failed to receive the preface from client: EOF\n2017/06/16 10:55:06 transport: http2Server.HandleStreams failed to receive the preface from client: EOF\n</code></pre>\n\n<p>Has anyone successfully tried this Ruby client Golang server combination with SSL/TLS enabled?</p>\n"}, {"tags": ["http", "docker", "go"], "answers": [{"tags": [], "owner": {"reputation": 2054, "user_id": 615120, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/xoAHa.jpg?s=128&g=1", "display_name": "rnk", "link": "https://stackoverflow.com/users/615120/rnk"}, "is_accepted": true, "score": 2, "last_activity_date": 1497874785, "last_edit_date": 1497874785, "creation_date": 1497865391, "answer_id": 44627139, "question_id": 44626931, "link": "https://stackoverflow.com/questions/44626931/listenandserve-returns-net-dnserror-nodename-nor-servname-provided/44627139#44627139", "title": "ListenAndServe returns net.DNSError &quot;nodename nor servname provided&quot;", "body": "<p>From the <a href=\"https://golang.org/src/net/http/server.go\" rel=\"nofollow noreferrer\">documentation</a>, address value should be a string.</p>\n\n<pre><code>// ListenAndServe always returns a non-nil error.\nfunc ListenAndServe(addr string, handler Handler) error {\n    server := &amp;Server{Addr: addr, Handler: handler}\n    return server.ListenAndServe()\n}\n</code></pre>\n\n<p>Can you try?</p>\n\n<pre><code>external := http.Server{\n    Addr:    \":10001\",\n    Handler: stack,\n}\n</code></pre>\n"}], "owner": {"reputation": 750, "user_id": 2690165, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/f0fab7c7aace5c1103b6cc490206c8e0?s=128&d=identicon&r=PG&f=1", "display_name": "Lucian", "link": "https://stackoverflow.com/users/2690165/lucian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1114, "favorite_count": 0, "accepted_answer_id": 44627139, "answer_count": 1, "score": 1, "last_activity_date": 1497874785, "creation_date": 1497864798, "last_edit_date": 1497872690, "question_id": 44626931, "link": "https://stackoverflow.com/questions/44626931/listenandserve-returns-net-dnserror-nodename-nor-servname-provided", "title": "ListenAndServe returns net.DNSError &quot;nodename nor servname provided&quot;", "body": "<p><br>\nI am trying to write a go http server but I have an issue when I try to listen to incoming connections. <br>\nHW setup: MacOS Sierra 10.12.4, docker 17.03\n<br>I have a yml file that will open a . phpmyadmin and sql:</p>\n\n<pre><code>mysql:\n  extends:\n    service: mysql-5.7\n  ports:\n    - \"3306:3306\"\nphpmyadmin:\n  image: phpmyadmin/phpmyadmin:latest\n  links:\n  - \"mysql:db\"\n  ports:\n  - \"8080:80\"\n</code></pre>\n\n<p>This seems to work fine.\nAfter this I wrote a go file to connect and listen to connections:</p>\n\n<pre><code>stack := negroni.New()\nstack.Use(cors.New(cors.Options{\n    AllowedOrigins:   []string{\"*\"},\n    AllowedMethods:   []string{\"GET\", \"POST\", \"PUT\", \"DELETE\"},\n    AllowedHeaders:   []string{\"*\"},\n    AllowCredentials: true,\n}))\n\nexternal := &amp;http.Server{\n    Addr:    \"10001\",\n    Handler: stack,\n}\n\n// Start the server, listening for incomming connections.\ngo func() {\n    err = external.ListenAndServe()\n    if err != nil &amp;&amp; err != http.ErrServerClosed {\n        level.Error(logger).Log(\"msg\", \"error while listening\", \"err\", err)\n        os.Exit(1)\n    }\n}()\n</code></pre>\n\n<p>This will generate the error:</p>\n\n<blockquote>\n  <p>level=error time=2017-06-19T09:28:14.726843314Z app=\u201cFalbala\u201d env=local pid=1084 host=P5RO-PORT367.local msg=\"error while listening\" err=\"listen tcp: lookup tcp/10001\u201d: nodename nor servname provided, or not known\"</p>\n</blockquote>\n\n<p>Any ideas?<br>\nThank you</p>\n"}, {"tags": ["sockets", "go", "tcp"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1497861108, "post_id": 44625610, "comment_id": 76236982, "body": "The reader is reading slower than the sender is sending."}, {"owner": {"reputation": 99, "user_id": 3151716, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100002650180936/picture?type=large", "display_name": "Nishant", "link": "https://stackoverflow.com/users/3151716/nishant"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1497874161, "post_id": 44625610, "comment_id": 76245875, "body": "stuck for hours"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1497879711, "post_id": 44625610, "comment_id": 76249759, "body": "If the client is also a Go app, make sure you&#39;re reading the entire response body <i>and</i> calling <code>Body.Close</code> when you&#39;re done with the response. I generally <code>defer func() {io.Copy(ioutil.Discard, resp.Body); resp.Body.Close()}()</code> to make sure."}, {"owner": {"reputation": 99, "user_id": 3151716, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100002650180936/picture?type=large", "display_name": "Nishant", "link": "https://stackoverflow.com/users/3151716/nishant"}, "edited": false, "score": 0, "creation_date": 1497899977, "post_id": 44625610, "comment_id": 76262570, "body": "it&#39;s a tcp connection between internal services"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1497902485, "post_id": 44625610, "comment_id": 76263851, "body": "Do you use zookeeper for some kind of locking/synchronization mechanism? That is slow as hell..."}, {"owner": {"reputation": 99, "user_id": 3151716, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100002650180936/picture?type=large", "display_name": "Nishant", "link": "https://stackoverflow.com/users/3151716/nishant"}, "edited": false, "score": 0, "creation_date": 1497904937, "post_id": 44625610, "comment_id": 76265132, "body": "I use it for service discovery but nothing else"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1497919317, "post_id": 44625610, "comment_id": 76269877, "body": "If it&#39;s &#39;stuck for hours&#39; it is because the reader is reading slower than the sender is sending for hours."}, {"owner": {"reputation": 99, "user_id": 3151716, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100002650180936/picture?type=large", "display_name": "Nishant", "link": "https://stackoverflow.com/users/3151716/nishant"}, "edited": false, "score": 0, "creation_date": 1497937541, "post_id": 44625610, "comment_id": 76274527, "body": "doesn&#39;t make sense. Both are internal services. Those services are working fine even when this is stuck."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1497953755, "post_id": 44625610, "comment_id": 76285439, "body": "You know that how? How exactly can you tell that a writer isn&#39;t outrunning its reader?"}, {"owner": {"reputation": 99, "user_id": 3151716, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100002650180936/picture?type=large", "display_name": "Nishant", "link": "https://stackoverflow.com/users/3151716/nishant"}, "edited": false, "score": 1, "creation_date": 1498038843, "post_id": 44625610, "comment_id": 76329541, "body": "What do you mean by outrunning? It was stuck at that for hours. If it&#39;s just slow, it should move forward at some time."}], "owner": {"reputation": 99, "user_id": 3151716, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100002650180936/picture?type=large", "display_name": "Nishant", "link": "https://stackoverflow.com/users/3151716/nishant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 659, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1497860885, "creation_date": 1497860885, "question_id": 44625610, "link": "https://stackoverflow.com/questions/44625610/golang-socket-write-stuck-in-poll", "title": "Golang socket write stuck in poll", "body": "<p>Adding goroutine trace. One connection (top one) is stuck in netpoll inside write. This connection is between our own services, so don't expect it to be slow. The issue can be fixed by adding a write timeout but what could be causing it?</p>\n\n<pre><code>goroutine profile: total 32685\n\n1 @ 0x42fd33 0x42a7ee 0x429cb0 0x629fba 0x62a086 0x62d084 0x640964 0x5e6306 0x73b75b 0x73b0b2 0x744660 0x5f13ea 0x5fbc12 0x5f8dd0 0x5ffd9f 0x48dcea 0x5f729f 0x460ae1\n#   0x429cb0    net.runtime_pollWait+0x60                       /usr/local/go/src/runtime/netpoll.go:160\n#   0x629fba    net.(*pollDesc).Wait+0x3a                       /usr/local/go/src/net/fd_poll_runtime.go:73\n#   0x62a086    net.(*pollDesc).WaitWrite+0x36                      /usr/local/go/src/net/fd_poll_runtime.go:82\n#   0x62d084    net.(*netFD).Write+0x414                        /usr/local/go/src/net/fd_unix.go:336\n#   0x640964    net.(*conn).Write+0xe4                          /usr/local/go/src/net/net.go:184\n#   0x5e6306    github.com/moonfrog/heimdall/network.(*Messenger).WriteMessage+0x86 /home/rts/gopath/src/github.com/moonfrog/heimdall/network/messenger.go:40\n#   0x73b75b    github.com/moonfrog/heimdall/service.(*Service).sendPacket+0x55b    /home/rts/gopath/src/github.com/moonfrog/heimdall/service/service.go:91\n#   0x73b0b2    github.com/moonfrog/heimdall/service.(*Service).Send+0x442      /home/rts/gopath/src/github.com/moonfrog/heimdall/service/service.go:79\n#   0x744660    github.com/moonfrog/heimdall/service/manager.(*Sticky).Send+0x5e0   /home/rts/gopath/src/github.com/moonfrog/heimdall/service/manager/sticky.go:91\n#   0x5f13ea    github.com/moonfrog/heimdall/serviceController.(*Controller).Send+0x22a /home/rts/gopath/src/github.com/moonfrog/heimdall/serviceController/controller.go:169\n#   0x5fbc12    github.com/moonfrog/heimdall/client.(*Client).sendToService+0x482   /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:452\n#   0x5f8dd0    github.com/moonfrog/heimdall/client.(*Client).process+0xfd0     /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:256\n#   0x5ffd9f    github.com/moonfrog/heimdall/client.(*Client).stateMachine.func1+0x3f   /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:136\n#   0x48dcea    github.com/moonfrog/heimdall/common.Safe+0x3a               /home/rts/gopath/src/github.com/moonfrog/heimdall/common/utils.go:49\n#   0x5f729f    github.com/moonfrog/heimdall/client.(*Client).stateMachine+0x1df    /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:137\n\n1 @ 0x460ae1\n\n1148 @ 0x42fd33 0x42fdf4 0x43f877 0x43f506 0x6299cc 0x62b7d9 0x62ccdc 0x640964 0x5e6306 0x73b75b 0x73cb72 0x74475e 0x5f1ea3 0x491dac 0x491c99 0x5fa486 0x5f7467 0x460ae1\n#   0x43f506    net.runtime_Semacquire+0x26                         /usr/local/go/src/runtime/sema.go:52\n#   0x6299cc    net.(*fdMutex).RWLock+0x16c                         /usr/local/go/src/net/fd_mutex.go:143\n#   0x62b7d9    net.(*netFD).writeLock+0x39                         /usr/local/go/src/net/fd_unix.go:194\n#   0x62ccdc    net.(*netFD).Write+0x6c                             /usr/local/go/src/net/fd_unix.go:319\n#   0x640964    net.(*conn).Write+0xe4                              /usr/local/go/src/net/net.go:184\n#   0x5e6306    github.com/moonfrog/heimdall/network.(*Messenger).WriteMessage+0x86     /home/rts/gopath/src/github.com/moonfrog/heimdall/network/messenger.go:40\n#   0x73b75b    github.com/moonfrog/heimdall/service.(*Service).sendPacket+0x55b        /home/rts/gopath/src/github.com/moonfrog/heimdall/service/service.go:91\n#   0x73cb72    github.com/moonfrog/heimdall/service.(*Service).OnDisconnect+0xb2       /home/rts/gopath/src/github.com/moonfrog/heimdall/service/service.go:179\n#   0x74475e    github.com/moonfrog/heimdall/service/manager.(*Sticky).Disconnect+0x5e      /home/rts/gopath/src/github.com/moonfrog/heimdall/service/manager/sticky.go:97\n#   0x5f1ea3    github.com/moonfrog/heimdall/serviceController.(*Controller).OnDisconnect+0x393 /home/rts/gopath/src/github.com/moonfrog/heimdall/serviceController/controller.go:210\n#   0x491dac    github.com/moonfrog/heimdall/router.(*Router).onDisconnect+0x8c         /home/rts/gopath/src/github.com/moonfrog/heimdall/router/router.go:151\n#   0x491c99    github.com/moonfrog/heimdall/router.(*Router).UnregisterClient+0x309        /home/rts/gopath/src/github.com/moonfrog/heimdall/router/router.go:146\n#   0x5fa486    github.com/moonfrog/heimdall/client.(*Client).disconnect+0x206          /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:329\n#   0x5f7467    github.com/moonfrog/heimdall/client.(*Client).stateMachine+0x3a7        /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:150\n\n11385 @ 0x42fd33 0x43e9f7 0x43df52 0x5fc6df 0x49181f 0x5faae9 0x5f94bf 0x5f8cdb 0x5ffd9f 0x48dcea 0x5f729f 0x460ae1\n#   0x5fc6df    github.com/moonfrog/heimdall/client.(*Client).ForceDisconnect+0xdf  /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:502\n#   0x49181f    github.com/moonfrog/heimdall/router.(*Router).RegisterClient+0x7af  /home/rts/gopath/src/github.com/moonfrog/heimdall/router/router.go:114\n#   0x5faae9    github.com/moonfrog/heimdall/client.(*Client).join+0x5e9        /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:379\n#   0x5f94bf    github.com/moonfrog/heimdall/client.(*Client).handleRouterMsg+0x61f /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:265\n#   0x5f8cdb    github.com/moonfrog/heimdall/client.(*Client).process+0xedb     /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:254\n#   0x5ffd9f    github.com/moonfrog/heimdall/client.(*Client).stateMachine.func1+0x3f   /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:136\n#   0x48dcea    github.com/moonfrog/heimdall/common.Safe+0x3a               /home/rts/gopath/src/github.com/moonfrog/heimdall/common/utils.go:49\n#   0x5f729f    github.com/moonfrog/heimdall/client.(*Client).stateMachine+0x1df    /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:137\n\n1 @ 0x42fd33 0x42fdf4 0x43f877 0x43f4c6 0x4c6d64 0x6f9081 0x704b71 0x460ae1\n#   0x43f4c6    sync.runtime_Semacquire+0x26                /usr/local/go/src/runtime/sema.go:47\n#   0x4c6d64    sync.(*WaitGroup).Wait+0xb4             /usr/local/go/src/sync/waitgroup.go:127\n#   0x6f9081    github.com/samuel/go-zookeeper/zk.(*Conn).loop+0x8c1    /home/rts/gopath/src/github.com/samuel/go-zookeeper/zk/conn.go:436\n#   0x704b71    github.com/samuel/go-zookeeper/zk.Connect.func1+0x21    /home/rts/gopath/src/github.com/samuel/go-zookeeper/zk/conn.go:218\n\n11343 @ 0x42fd33 0x43e9f7 0x43df52 0x5f70ab 0x460ae1\n#   0x5f70ab    github.com/moonfrog/heimdall/client.(*Client).readPump+0x70b    /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:111\n\n4332 @ 0x42fd33 0x43e9f7 0x43df52 0x5f6d54 0x460ae1\n#   0x5f6d54    github.com/moonfrog/heimdall/client.(*Client).readPump+0x3b4    /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:104\n\n1438 @ 0x42fd33 0x42fdf4 0x43f877 0x43f506 0x6299cc 0x62b7d9 0x62ccdc 0x640964 0x5e6306 0x73b75b 0x73ca92 0x7447ee 0x5f1fd4 0x491897 0x5faae9 0x5f94bf 0x5f8cdb 0x5ffd9f 0x48dcea 0x5f729f 0x460ae1\n#   0x43f506    net.runtime_Semacquire+0x26                         /usr/local/go/src/runtime/sema.go:52\n#   0x6299cc    net.(*fdMutex).RWLock+0x16c                         /usr/local/go/src/net/fd_mutex.go:143\n#   0x62b7d9    net.(*netFD).writeLock+0x39                         /usr/local/go/src/net/fd_unix.go:194\n#   0x62ccdc    net.(*netFD).Write+0x6c                             /usr/local/go/src/net/fd_unix.go:319\n#   0x640964    net.(*conn).Write+0xe4                              /usr/local/go/src/net/net.go:184\n#   0x5e6306    github.com/moonfrog/heimdall/network.(*Messenger).WriteMessage+0x86     /home/rts/gopath/src/github.com/moonfrog/heimdall/network/messenger.go:40\n#   0x73b75b    github.com/moonfrog/heimdall/service.(*Service).sendPacket+0x55b        /home/rts/gopath/src/github.com/moonfrog/heimdall/service/service.go:91\n#   0x73ca92    github.com/moonfrog/heimdall/service.(*Service).OnReconnect+0xb2        /home/rts/gopath/src/github.com/moonfrog/heimdall/service/service.go:171\n#   0x7447ee    github.com/moonfrog/heimdall/service/manager.(*Sticky).Reconnect+0x5e       /home/rts/gopath/src/github.com/moonfrog/heimdall/service/manager/sticky.go:105\n#   0x5f1fd4    github.com/moonfrog/heimdall/serviceController.(*Controller).OnReconnect+0xd4   /home/rts/gopath/src/github.com/moonfrog/heimdall/serviceController/controller.go:218\n#   0x491897    github.com/moonfrog/heimdall/router.(*Router).RegisterClient+0x827      /home/rts/gopath/src/github.com/moonfrog/heimdall/router/router.go:116\n#   0x5faae9    github.com/moonfrog/heimdall/client.(*Client).join+0x5e9            /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:379\n#   0x5f94bf    github.com/moonfrog/heimdall/client.(*Client).handleRouterMsg+0x61f     /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:265\n#   0x5f8cdb    github.com/moonfrog/heimdall/client.(*Client).process+0xedb         /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:254\n#   0x5ffd9f    github.com/moonfrog/heimdall/client.(*Client).stateMachine.func1+0x3f       /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:136\n#   0x48dcea    github.com/moonfrog/heimdall/common.Safe+0x3a                   /home/rts/gopath/src/github.com/moonfrog/heimdall/common/utils.go:49\n#   0x5f729f    github.com/moonfrog/heimdall/client.(*Client).stateMachine+0x1df        /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:137\n\n18 @ 0x42fd33 0x43e9f7 0x43df52 0x73fbab 0x460ae1\n#   0x73fbab    github.com/moonfrog/heimdall/service.(*Service).startHB.func1+0x23b /home/rts/gopath/src/github.com/moonfrog/heimdall/service/service.go:241\n\n1 @ 0x42fd33 0x42fdf4 0x4061ef 0x405d0b 0x587454 0x460ae1\n#   0x587454    github.com/moonfrog/badger/lib/stats/serverside/golang.(*Client).startScheduler+0x94    /home/rts/gopath/src/github.com/moonfrog/badger/lib/stats/serverside/golang/client.go:182\n\n1 @ 0x42fd33 0x42a7ee 0x429cb0 0x629fba 0x62a026 0x62dcbc 0x64bbfd 0x54d121 0x54c2b9 0x54c106 0x54c808 0x5807ac 0x460ae1\n#   0x429cb0    net.runtime_pollWait+0x60                   /usr/local/go/src/runtime/netpoll.go:160\n#   0x629fba    net.(*pollDesc).Wait+0x3a                   /usr/local/go/src/net/fd_poll_runtime.go:73\n#   0x62a026    net.(*pollDesc).WaitRead+0x36                   /usr/local/go/src/net/fd_poll_runtime.go:78\n#   0x62dcbc    net.(*netFD).accept+0x27c                   /usr/local/go/src/net/fd_unix.go:426\n#   0x64bbfd    net.(*TCPListener).AcceptTCP+0x4d               /usr/local/go/src/net/tcpsock_posix.go:254\n#   0x54d121    net/http.tcpKeepAliveListener.Accept+0x41           /usr/local/go/src/net/http/server.go:2427\n#   0x54c2b9    net/http.(*Server).Serve+0x129                  /usr/local/go/src/net/http/server.go:2117\n#   0x54c106    net/http.(*Server).ListenAndServe+0x136             /usr/local/go/src/net/http/server.go:2098\n#   0x54c808    net/http.ListenAndServe+0x98                    /usr/local/go/src/net/http/server.go:2195\n#   0x5807ac    github.com/moonfrog/heimdall/debugger.(*Debugger).Start+0x55c   /home/rts/gopath/src/github.com/moonfrog/heimdall/debugger/debugger.go:89\n\n2361 @ 0x42fd33 0x42fdf4 0x43f877 0x43f4c6 0x4c65b8 0x5f2066 0x5f9d26 0x5f8cdb 0x5ffd9f 0x48dcea 0x5f729f 0x460ae1\n#   0x43f4c6    sync.runtime_Semacquire+0x26                            /usr/local/go/src/runtime/sema.go:47\n#   0x4c65b8    sync.(*RWMutex).RLock+0x58                          /usr/local/go/src/sync/rwmutex.go:37\n#   0x5f2066    github.com/moonfrog/heimdall/serviceController.(*Controller).OnConnect+0x46 /home/rts/gopath/src/github.com/moonfrog/heimdall/serviceController/controller.go:224\n#   0x5f9d26    github.com/moonfrog/heimdall/client.(*Client).handleRouterMsg+0xe86     /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:284\n#   0x5f8cdb    github.com/moonfrog/heimdall/client.(*Client).process+0xedb         /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:254\n#   0x5ffd9f    github.com/moonfrog/heimdall/client.(*Client).stateMachine.func1+0x3f       /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:136\n#   0x48dcea    github.com/moonfrog/heimdall/common.Safe+0x3a                   /home/rts/gopath/src/github.com/moonfrog/heimdall/common/utils.go:49\n#   0x5f729f    github.com/moonfrog/heimdall/client.(*Client).stateMachine+0x1df        /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:137\n\n387 @ 0x42fd33 0x42fdf4 0x43f877 0x43f506 0x6299cc 0x62b7d9 0x62ccdc 0x640964 0x5e6306 0x73b75b 0x73b0b2 0x744660 0x5f13ea 0x5fbc12 0x5f8dd0 0x5ffd9f 0x48dcea 0x5f729f 0x460ae1\n#   0x43f506    net.runtime_Semacquire+0x26                     /usr/local/go/src/runtime/sema.go:52\n#   0x6299cc    net.(*fdMutex).RWLock+0x16c                     /usr/local/go/src/net/fd_mutex.go:143\n#   0x62b7d9    net.(*netFD).writeLock+0x39                     /usr/local/go/src/net/fd_unix.go:194\n#   0x62ccdc    net.(*netFD).Write+0x6c                         /usr/local/go/src/net/fd_unix.go:319\n#   0x640964    net.(*conn).Write+0xe4                          /usr/local/go/src/net/net.go:184\n#   0x5e6306    github.com/moonfrog/heimdall/network.(*Messenger).WriteMessage+0x86 /home/rts/gopath/src/github.com/moonfrog/heimdall/network/messenger.go:40\n#   0x73b75b    github.com/moonfrog/heimdall/service.(*Service).sendPacket+0x55b    /home/rts/gopath/src/github.com/moonfrog/heimdall/service/service.go:91\n#   0x73b0b2    github.com/moonfrog/heimdall/service.(*Service).Send+0x442      /home/rts/gopath/src/github.com/moonfrog/heimdall/service/service.go:79\n#   0x744660    github.com/moonfrog/heimdall/service/manager.(*Sticky).Send+0x5e0   /home/rts/gopath/src/github.com/moonfrog/heimdall/service/manager/sticky.go:91\n#   0x5f13ea    github.com/moonfrog/heimdall/serviceController.(*Controller).Send+0x22a /home/rts/gopath/src/github.com/moonfrog/heimdall/serviceController/controller.go:169\n#   0x5fbc12    github.com/moonfrog/heimdall/client.(*Client).sendToService+0x482   /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:452\n#   0x5f8dd0    github.com/moonfrog/heimdall/client.(*Client).process+0xfd0     /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:256\n#   0x5ffd9f    github.com/moonfrog/heimdall/client.(*Client).stateMachine.func1+0x3f   /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:136\n#   0x48dcea    github.com/moonfrog/heimdall/common.Safe+0x3a               /home/rts/gopath/src/github.com/moonfrog/heimdall/common/utils.go:49\n#   0x5f729f    github.com/moonfrog/heimdall/client.(*Client).stateMachine+0x1df    /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:137\n\n1 @ 0x42fd33 0x42fdf4 0x43f877 0x43f4c6 0x4c67b1 0x5f3391 0x460ae1\n#   0x43f4c6    sync.runtime_Semacquire+0x26                            /usr/local/go/src/runtime/sema.go:47\n#   0x4c67b1    sync.(*RWMutex).Lock+0xa1                           /usr/local/go/src/sync/rwmutex.go:88\n#   0x5f3391    github.com/moonfrog/heimdall/serviceController.(*Controller).monitor+0xc1   /home/rts/gopath/src/github.com/moonfrog/heimdall/serviceController/controller.go:286\n\n1 @ 0x42fd33 0x42fdf4 0x43f877 0x43f506 0x6299cc 0x62b7d9 0x62ccdc 0x640964 0x5e6306 0x73b75b 0x73fb4c 0x460ae1\n#   0x43f506    net.runtime_Semacquire+0x26                     /usr/local/go/src/runtime/sema.go:52\n#   0x6299cc    net.(*fdMutex).RWLock+0x16c                     /usr/local/go/src/net/fd_mutex.go:143\n#   0x62b7d9    net.(*netFD).writeLock+0x39                     /usr/local/go/src/net/fd_unix.go:194\n#   0x62ccdc    net.(*netFD).Write+0x6c                         /usr/local/go/src/net/fd_unix.go:319\n#   0x640964    net.(*conn).Write+0xe4                          /usr/local/go/src/net/net.go:184\n#   0x5e6306    github.com/moonfrog/heimdall/network.(*Messenger).WriteMessage+0x86 /home/rts/gopath/src/github.com/moonfrog/heimdall/network/messenger.go:40\n#   0x73b75b    github.com/moonfrog/heimdall/service.(*Service).sendPacket+0x55b    /home/rts/gopath/src/github.com/moonfrog/heimdall/service/service.go:91\n#   0x73fb4c    github.com/moonfrog/heimdall/service.(*Service).startHB.func1+0x1dc /home/rts/gopath/src/github.com/moonfrog/heimdall/service/service.go:252\n\n1 @ 0x42fd33 0x43e9f7 0x43df52 0x4558a8 0x460ae1\n#   0x42fd33    runtime.gopark+0x163        /usr/local/go/src/runtime/proc.go:263\n#   0x43e9f7    runtime.selectgoImpl+0xa67  /usr/local/go/src/runtime/select.go:392\n#   0x43df52    runtime.selectgo+0x12       /usr/local/go/src/runtime/select.go:215\n#   0x4558a8    runtime.ensureSigM.func1+0x358  /usr/local/go/src/runtime/signal1_unix.go:279\n\n2 @ 0x42fd33 0x42a7ee 0x429cb0 0x629fba 0x62a026 0x62dcbc 0x64bbfd 0x5e6f16 0x460ae1\n#   0x429cb0    net.runtime_pollWait+0x60                       /usr/local/go/src/runtime/netpoll.go:160\n#   0x629fba    net.(*pollDesc).Wait+0x3a                       /usr/local/go/src/net/fd_poll_runtime.go:73\n#   0x62a026    net.(*pollDesc).WaitRead+0x36                       /usr/local/go/src/net/fd_poll_runtime.go:78\n#   0x62dcbc    net.(*netFD).accept+0x27c                       /usr/local/go/src/net/fd_unix.go:426\n#   0x64bbfd    net.(*TCPListener).AcceptTCP+0x4d                   /usr/local/go/src/net/tcpsock_posix.go:254\n#   0x5e6f16    github.com/moonfrog/heimdall/network.(*TCPServer).Start.func1+0x46  /home/rts/gopath/src/github.com/moonfrog/heimdall/network/tcpServer.go:22\n\n12 @ 0x42fd33 0x42fdf4 0x43f877 0x43f506 0x6299cc 0x62b7d9 0x62ccdc 0x640964 0x5e6306 0x73b75b 0x73b0b2 0x744660 0x5f13ea 0x73c308 0x73f5cf 0x48dcea 0x73f89c 0x460ae1\n#   0x43f506    net.runtime_Semacquire+0x26                     /usr/local/go/src/runtime/sema.go:52\n#   0x6299cc    net.(*fdMutex).RWLock+0x16c                     /usr/local/go/src/net/fd_mutex.go:143\n#   0x62b7d9    net.(*netFD).writeLock+0x39                     /usr/local/go/src/net/fd_unix.go:194\n#   0x62ccdc    net.(*netFD).Write+0x6c                         /usr/local/go/src/net/fd_unix.go:319\n#   0x640964    net.(*conn).Write+0xe4                          /usr/local/go/src/net/net.go:184\n#   0x5e6306    github.com/moonfrog/heimdall/network.(*Messenger).WriteMessage+0x86 /home/rts/gopath/src/github.com/moonfrog/heimdall/network/messenger.go:40\n#   0x73b75b    github.com/moonfrog/heimdall/service.(*Service).sendPacket+0x55b    /home/rts/gopath/src/github.com/moonfrog/heimdall/service/service.go:91\n#   0x73b0b2    github.com/moonfrog/heimdall/service.(*Service).Send+0x442      /home/rts/gopath/src/github.com/moonfrog/heimdall/service/service.go:79\n#   0x744660    github.com/moonfrog/heimdall/service/manager.(*Sticky).Send+0x5e0   /home/rts/gopath/src/github.com/moonfrog/heimdall/service/manager/sticky.go:91\n#   0x5f13ea    github.com/moonfrog/heimdall/serviceController.(*Controller).Send+0x22a /home/rts/gopath/src/github.com/moonfrog/heimdall/serviceController/controller.go:169\n#   0x73c308    github.com/moonfrog/heimdall/service.(*Service).process+0x8a8       /home/rts/gopath/src/github.com/moonfrog/heimdall/service/service.go:142\n#   0x73f5cf    github.com/moonfrog/heimdall/service.(*Service).readPump.func1.1+0x3f   /home/rts/gopath/src/github.com/moonfrog/heimdall/service/service.go:111\n#   0x48dcea    github.com/moonfrog/heimdall/common.Safe+0x3a               /home/rts/gopath/src/github.com/moonfrog/heimdall/common/utils.go:49\n#   0x73f89c    github.com/moonfrog/heimdall/service.(*Service).readPump.func1+0x2bc    /home/rts/gopath/src/github.com/moonfrog/heimdall/service/service.go:112\n\n102 @ 0x42fd33 0x42fdf4 0x43f877 0x43f506 0x6299cc 0x62b7d9 0x62ccdc 0x640964 0x5e6306 0x73b75b 0x73cb72 0x74475e 0x7457a6 0x5f23d9 0x5f9d26 0x5f8cdb 0x5ffd9f 0x48dcea 0x5f729f 0x460ae1\n#   0x43f506    net.runtime_Semacquire+0x26                         /usr/local/go/src/runtime/sema.go:52\n#   0x6299cc    net.(*fdMutex).RWLock+0x16c                         /usr/local/go/src/net/fd_mutex.go:143\n#   0x62b7d9    net.(*netFD).writeLock+0x39                         /usr/local/go/src/net/fd_unix.go:194\n#   0x62ccdc    net.(*netFD).Write+0x6c                             /usr/local/go/src/net/fd_unix.go:319\n#   0x640964    net.(*conn).Write+0xe4                              /usr/local/go/src/net/net.go:184\n#   0x5e6306    github.com/moonfrog/heimdall/network.(*Messenger).WriteMessage+0x86     /home/rts/gopath/src/github.com/moonfrog/heimdall/network/messenger.go:40\n#   0x73b75b    github.com/moonfrog/heimdall/service.(*Service).sendPacket+0x55b        /home/rts/gopath/src/github.com/moonfrog/heimdall/service/service.go:91\n#   0x73cb72    github.com/moonfrog/heimdall/service.(*Service).OnDisconnect+0xb2       /home/rts/gopath/src/github.com/moonfrog/heimdall/service/service.go:179\n#   0x74475e    github.com/moonfrog/heimdall/service/manager.(*Sticky).Disconnect+0x5e      /home/rts/gopath/src/github.com/moonfrog/heimdall/service/manager/sticky.go:97\n#   0x7457a6    github.com/moonfrog/heimdall/service/manager.(*Sticky).Connect+0x856        /home/rts/gopath/src/github.com/moonfrog/heimdall/service/manager/sticky.go:147\n#   0x5f23d9    github.com/moonfrog/heimdall/serviceController.(*Controller).OnConnect+0x3b9    /home/rts/gopath/src/github.com/moonfrog/heimdall/serviceController/controller.go:235\n#   0x5f9d26    github.com/moonfrog/heimdall/client.(*Client).handleRouterMsg+0xe86     /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:284\n#   0x5f8cdb    github.com/moonfrog/heimdall/client.(*Client).process+0xedb         /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:254\n#   0x5ffd9f    github.com/moonfrog/heimdall/client.(*Client).stateMachine.func1+0x3f       /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:136\n#   0x48dcea    github.com/moonfrog/heimdall/common.Safe+0x3a                   /home/rts/gopath/src/github.com/moonfrog/heimdall/common/utils.go:49\n#   0x5f729f    github.com/moonfrog/heimdall/client.(*Client).stateMachine+0x1df        /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:137\n\n13 @ 0x42fd33 0x42fdf4 0x43f877 0x43f506 0x6299cc 0x62b7d9 0x62ccdc 0x640964 0x5e6306 0x73b75b 0x73cb72 0x74475e 0x5f1ea3 0x491dac 0x491c99 0x5fa486 0x5fa25a 0x5f8cdb 0x5ffd9f 0x48dcea 0x5f729f 0x460ae1\n#   0x43f506    net.runtime_Semacquire+0x26                         /usr/local/go/src/runtime/sema.go:52\n#   0x6299cc    net.(*fdMutex).RWLock+0x16c                         /usr/local/go/src/net/fd_mutex.go:143\n#   0x62b7d9    net.(*netFD).writeLock+0x39                         /usr/local/go/src/net/fd_unix.go:194\n#   0x62ccdc    net.(*netFD).Write+0x6c                             /usr/local/go/src/net/fd_unix.go:319\n#   0x640964    net.(*conn).Write+0xe4                              /usr/local/go/src/net/net.go:184\n#   0x5e6306    github.com/moonfrog/heimdall/network.(*Messenger).WriteMessage+0x86     /home/rts/gopath/src/github.com/moonfrog/heimdall/network/messenger.go:40\n#   0x73b75b    github.com/moonfrog/heimdall/service.(*Service).sendPacket+0x55b        /home/rts/gopath/src/github.com/moonfrog/heimdall/service/service.go:91\n#   0x73cb72    github.com/moonfrog/heimdall/service.(*Service).OnDisconnect+0xb2       /home/rts/gopath/src/github.com/moonfrog/heimdall/service/service.go:179\n#   0x74475e    github.com/moonfrog/heimdall/service/manager.(*Sticky).Disconnect+0x5e      /home/rts/gopath/src/github.com/moonfrog/heimdall/service/manager/sticky.go:97\n#   0x5f1ea3    github.com/moonfrog/heimdall/serviceController.(*Controller).OnDisconnect+0x393 /home/rts/gopath/src/github.com/moonfrog/heimdall/serviceController/controller.go:210\n#   0x491dac    github.com/moonfrog/heimdall/router.(*Router).onDisconnect+0x8c         /home/rts/gopath/src/github.com/moonfrog/heimdall/router/router.go:151\n#   0x491c99    github.com/moonfrog/heimdall/router.(*Router).UnregisterClient+0x309        /home/rts/gopath/src/github.com/moonfrog/heimdall/router/router.go:146\n#   0x5fa486    github.com/moonfrog/heimdall/client.(*Client).disconnect+0x206          /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:329\n#   0x5fa25a    github.com/moonfrog/heimdall/client.(*Client).handleRouterMsg+0x13ba        /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:274\n#   0x5f8cdb    github.com/moonfrog/heimdall/client.(*Client).process+0xedb         /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:254\n#   0x5ffd9f    github.com/moonfrog/heimdall/client.(*Client).stateMachine.func1+0x3f       /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:136\n#   0x48dcea    github.com/moonfrog/heimdall/common.Safe+0x3a                   /home/rts/gopath/src/github.com/moonfrog/heimdall/common/utils.go:49\n#   0x5f729f    github.com/moonfrog/heimdall/client.(*Client).stateMachine+0x1df        /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:137\n\n7 @ 0x42fd33 0x42a7ee 0x429cb0 0x629fba 0x62a026 0x62be7a 0x640644 0x611d09 0x612b7a 0x612eb9 0x5e60f4 0x73f614 0x460ae1\n#   0x429cb0    net.runtime_pollWait+0x60                       /usr/local/go/src/runtime/netpoll.go:160\n#   0x629fba    net.(*pollDesc).Wait+0x3a                       /usr/local/go/src/net/fd_poll_runtime.go:73\n#   0x62a026    net.(*pollDesc).WaitRead+0x36                       /usr/local/go/src/net/fd_poll_runtime.go:78\n#   0x62be7a    net.(*netFD).Read+0x23a                         /usr/local/go/src/net/fd_unix.go:250\n#   0x640644    net.(*conn).Read+0xe4                           /usr/local/go/src/net/net.go:172\n#   0x611d09    bufio.(*Reader).fill+0x1e9                      /usr/local/go/src/bufio/bufio.go:97\n#   0x612b7a    bufio.(*Reader).ReadSlice+0x21a                     /usr/local/go/src/bufio/bufio.go:328\n#   0x612eb9    bufio.(*Reader).ReadBytes+0xa9                      /usr/local/go/src/bufio/bufio.go:406\n#   0x5e60f4    github.com/moonfrog/heimdall/network.(*Messenger).ReadMessage+0x54  /home/rts/gopath/src/github.com/moonfrog/heimdall/network/messenger.go:29\n#   0x73f614    github.com/moonfrog/heimdall/service.(*Service).readPump.func1+0x34 /home/rts/gopath/src/github.com/moonfrog/heimdall/service/service.go:102\n\n1 @ 0x42fd33 0x42fdf4 0x43f877 0x43f4c6 0x4c5704 0x4c6740 0x5f2d6a 0x5f5fcc 0x5f5dc4 0x5890f3 0x460ae1\n#   0x43f4c6    sync.runtime_Semacquire+0x26                                /usr/local/go/src/runtime/sema.go:47\n#   0x4c5704    sync.(*Mutex).Lock+0x1c4                                /usr/local/go/src/sync/mutex.go:83\n#   0x4c6740    sync.(*RWMutex).Lock+0x30                               /usr/local/go/src/sync/rwmutex.go:83\n#   0x5f2d6a    github.com/moonfrog/heimdall/serviceController.(*Controller).refreshServices+0x4a   /home/rts/gopath/src/github.com/moonfrog/heimdall/serviceController/controller.go:257\n#   0x5f5fcc    github.com/moonfrog/heimdall/serviceController.(*Controller).init.func1+0x1ec       /home/rts/gopath/src/github.com/moonfrog/heimdall/serviceController/controller.go:333\n#   0x5f5dc4    github.com/moonfrog/heimdall/serviceController.loadConfig.func2+0x84            /home/rts/gopath/src/github.com/moonfrog/heimdall/serviceController/configServices.go:84\n#   0x5890f3    github.com/moonfrog/badger/zootils.(*ZooKeeper).watchFunc+0x53              /home/rts/gopath/src/github.com/moonfrog/badger/zootils/zootils.go:62\n\n1 @ 0x42fd33 0x43e9f7 0x43df52 0x5fc579 0x491911 0x5faae9 0x5f94bf 0x5f8cdb 0x5ffd9f 0x48dcea 0x5f729f 0x460ae1\n#   0x5fc579    github.com/moonfrog/heimdall/client.(*Client).RejectConnection+0x369    /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:495\n#   0x491911    github.com/moonfrog/heimdall/router.(*Router).RegisterClient+0x8a1  /home/rts/gopath/src/github.com/moonfrog/heimdall/router/router.go:109\n#   0x5faae9    github.com/moonfrog/heimdall/client.(*Client).join+0x5e9        /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:379\n#   0x5f94bf    github.com/moonfrog/heimdall/client.(*Client).handleRouterMsg+0x61f /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:265\n#   0x5f8cdb    github.com/moonfrog/heimdall/client.(*Client).process+0xedb     /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:254\n#   0x5ffd9f    github.com/moonfrog/heimdall/client.(*Client).stateMachine.func1+0x3f   /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:136\n#   0x48dcea    github.com/moonfrog/heimdall/common.Safe+0x3a               /home/rts/gopath/src/github.com/moonfrog/heimdall/common/utils.go:49\n#   0x5f729f    github.com/moonfrog/heimdall/client.(*Client).stateMachine+0x1df    /home/rts/gopath/src/github.com/moonfrog/heimdall/client/client.go:137\n</code></pre>\n"}, {"tags": ["go", "twitter", "multipartform-data", "multipart", "form-fields"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1497821212, "post_id": 44619606, "comment_id": 76225179, "body": "what&#39;s the error that you&#39;re seeing ?"}, {"owner": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1497821897, "post_id": 44619606, "comment_id": 76225335, "body": "@CeriseLim&#243;n i sent one at a time just here  i wrote them together but ill try to close the writer and if i set the content type i get a bad request error let me try closing the writer"}, {"owner": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "reply_to_user": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1497822035, "post_id": 44619606, "comment_id": 76225372, "body": "@YandryPozo <code>{&quot;errors&quot;:[{&quot;code&quot;:38,&quot;message&quot;:&quot;media parameter is missing.&quot;}]}&amp;{400 Bad Request 400</code> this is the error i get"}], "answers": [{"comments": [{"owner": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "edited": false, "score": 0, "creation_date": 1497822372, "post_id": 44619735, "comment_id": 76225441, "body": "wow that works like a charm i typed by hand as multipart/form-data before with no success i guess the key vas <code>writer.FormContentType()</code> Thank you.  By any chance might you have any clue about setting the type of the file to image/png instead of application/octet-stream ? @jeevatkm"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "edited": false, "score": 0, "creation_date": 1497822862, "post_id": 44619735, "comment_id": 76225568, "body": "Yes, you can. I will add it to the answer."}, {"owner": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "edited": false, "score": 0, "creation_date": 1497823864, "post_id": 44619735, "comment_id": 76225807, "body": "i just figured it out from the source code of createFormFile thanks anyway for closing the writer"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "edited": false, "score": 0, "creation_date": 1497824017, "post_id": 44619735, "comment_id": 76225860, "body": "I just added it, anyway you know what to do."}, {"owner": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "edited": false, "score": 0, "creation_date": 1497824821, "post_id": 44619735, "comment_id": 76226054, "body": "but seems like Twitter still doesn&#39;t like it ![](<a href=\"https://ws1.sinaimg.cn/large/006tNc79gy1fgq3tnmyrkj30je05uglo.jpg\" rel=\"nofollow noreferrer\">ws1.sinaimg.cn/large/006tNc79gy1fgq3tnmyrkj30je05uglo.jp&zwnj;&#8203;g</a>) I get this error message anyway"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "edited": false, "score": 0, "creation_date": 1497825652, "post_id": 44619735, "comment_id": 76226208, "body": "Updated answer with further info about your code snippet. please have a look."}, {"owner": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "edited": false, "score": 0, "creation_date": 1497825957, "post_id": 44619735, "comment_id": 76226269, "body": "so do you have any idea then why twitter complains about the type ? @jeevatkm"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "edited": false, "score": 0, "creation_date": 1497826110, "post_id": 44619735, "comment_id": 76226310, "body": "I&#39;m on <a href=\"http://chat.stackoverflow.com/rooms/147013/discussion-between-nikoss-and-jeevatkm\">chat room</a>"}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 2, "last_activity_date": 1497825597, "last_edit_date": 1497825597, "creation_date": 1497821613, "answer_id": 44619735, "question_id": 44619606, "link": "https://stackoverflow.com/questions/44619606/multipart-file-field-is-unreadable/44619735#44619735", "title": "Multipart file field is unreadable", "body": "<p>Updates: Just referred <a href=\"https://dev.twitter.com/rest/reference/post/media/upload#Parameters\" rel=\"nofollow noreferrer\">Twitter API Upload parameter</a>. As per your code snippet you're using both fields <code>media</code> and <code>media_data</code>. You have to use only one -</p>\n\n<ul>\n<li>Upload using base64 -> field name is <code>media_data</code></li>\n<li>Upload using raw -> field name is <code>media</code></li>\n</ul>\n\n<p>And, you have to add <code>Content-Type</code> header.</p>\n\n<pre><code>req, err := http.NewRequest(\"POST\",\n    \"https://upload.twitter.com/1.1/media/upload.json\",\n    body)\nreq.Header.Set(\"Content-Type\", writer.FormDataContentType())\nif err := writer.Close(); err != nil {\n   log.Println(err)\n}\n// Now fire the http request\n</code></pre>\n\n<p><em>PS: While composing an answer, in 30 secs gap, @cerise-lim\u00f3n added comment, also close the multipart writer as mentioned by @cerise-lim\u00f3n.</em></p>\n\n<hr>\n\n<p><strong>Asked in the comment:</strong></p>\n\n<blockquote>\n  <p>Twitter accepts application/octet-stream, you may not need below approach.</p>\n</blockquote>\n\n<p>Adding multi-part with user supplied <code>Content-Type</code> instead of <code>application/octet-stream</code>. Basically you have to do same implementation as convenience wrapper with your content-type.</p>\n\n<pre><code>writer := multipart.NewWriter(body)\nh := make(textproto.MIMEHeader)\nh.Set(\"Content-Disposition\", fmt.Sprintf(`form-data; name=\"%s\"; filename=\"%s\"`,\n        escapeQuotes(fieldname), escapeQuotes(filename)))\nh.Set(\"Content-Type\", \"image/png\")\npart, err := writer.CreatePart(h)\n// use part same as before\n</code></pre>\n\n<p>Definition of <code>escapeQuotes</code> from multiple-part package.</p>\n\n<pre><code>var quoteEscaper = strings.NewReplacer(\"\\\\\", \"\\\\\\\\\", `\"`, \"\\\\\\\"\")\nfunc escapeQuotes(s string) string {\n    return quoteEscaper.Replace(s)\n}\n</code></pre>\n"}], "owner": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 503, "favorite_count": 0, "accepted_answer_id": 44619735, "answer_count": 1, "score": 1, "last_activity_date": 1497868855, "creation_date": 1497820561, "last_edit_date": 1497868855, "question_id": 44619606, "link": "https://stackoverflow.com/questions/44619606/multipart-file-field-is-unreadable", "title": "Multipart file field is unreadable", "body": "<p>I am trying to upload photos to Twitter. I created a multipart writer and creating a file field using that named media but when I send my request to Twitter it keeps responding missing media field.\nAm I missing something? \nHere is my code</p>\n\n<pre><code>    f, err := os.Open(\"/Users/nikos/Desktop/test.png\")\nerrored:\n    if nil != err {\n        fmt.Println(err)\n        return\n    }\n    var img = new(bytes.Buffer)\n    enc := base64.NewEncoder(base64.StdEncoding, img)\n    _, err = io.Copy(enc, f)\n    if nil != err {\n        goto errored\n    }\n    body := new(bytes.Buffer)//Multipart body\n    writer := multipart.NewWriter(body)\n    cl, err := twitter.OauthClient.MakeHttpClient(&amp;oauth.AccessToken{\n        Token:  \"xxx\",\n        Secret: \"yyy\",\n    })\n    err = writer.WriteField(\"media_data\", img.String())//base64 version of the image (i tried both binary and base64 versions neither will work)\n    if nil != err {\n        goto errored\n    }\n    part, err := writer.CreateFormFile(\"media\", \"test.png\")//actual binary file multiparted and it is named media.\n    if nil != err {\n        goto errored\n    }\n    _, err = io.Copy(part, f)\n    if nil != err {\n        goto errored\n    }\n    req, err := http.NewRequest(\"POST\",\n        \"https://upload.twitter.com/1.1/media/upload.json\",\n        body)\n    if nil != err {\n        goto errored\n    }\n    res, err := cl.Do(req)\n    if nil != err {\n        goto errored\n    }\n//and twitter responds that there is no field attached named media\n    _, err = io.Copy(os.Stdout, res.Body)\n    fmt.Println(res)\n    if nil != err {\n        goto errored\n    } \n</code></pre>\n"}, {"tags": ["php", "sql-server", "windows", "go", "sql-server-2014"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 1948265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f630d378d3b726c9a4b4f556754c897?s=128&d=identicon&r=PG", "display_name": "Angad Singh Thandi", "link": "https://stackoverflow.com/users/1948265/angad-singh-thandi"}, "edited": false, "score": 0, "creation_date": 1497816171, "post_id": 44618313, "comment_id": 76223928, "body": "Both 1433 &amp; 1434 ports are disabled for MSSQL on my machine.. but still PHP app works fine with MSSQL. So, I was hoping I will be able to achieve the same with Go. <b>denisenkom/go-msmsqldb</b> pkg worked after I enabled 1433 for TCP/IP.  Isn&#39;t there anyway that it would be possible without a port. I&#39;m not able to understand how my PHP app works. Any suggestions would be helpful. Thanks :)"}, {"owner": {"reputation": 31, "user_id": 1948265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f630d378d3b726c9a4b4f556754c897?s=128&d=identicon&r=PG", "display_name": "Angad Singh Thandi", "link": "https://stackoverflow.com/users/1948265/angad-singh-thandi"}, "edited": false, "score": 0, "creation_date": 1497816480, "post_id": 44618313, "comment_id": 76224010, "body": "This is my PHP connection, that works even without the ports being enabled.  <code>$this-&gt;db = new PDO(&#39;sqlsrv:Server=&#39; . DATABASE_SERVER                                  . &#39;;Database=&#39; . DATABASE_BNAME,                                  DATABASE_LOGIN_NAME,                                  DATABASE_PASSWORD                                 );</code>"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 31, "user_id": 1948265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f630d378d3b726c9a4b4f556754c897?s=128&d=identicon&r=PG", "display_name": "Angad Singh Thandi", "link": "https://stackoverflow.com/users/1948265/angad-singh-thandi"}, "edited": false, "score": 0, "creation_date": 1497816882, "post_id": 44618313, "comment_id": 76224111, "body": "Can you share connection string format use in go and value of <code>DATABASE_SERVER</code> and <code>DATABASE_BNAME</code>?"}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": false, "score": 0, "last_activity_date": 1497811388, "creation_date": 1497811388, "answer_id": 44618313, "question_id": 44617976, "link": "https://stackoverflow.com/questions/44617976/unable-to-connect-to-mssql-2014-with-golang-without-opening-static-port-on-mssq/44618313#44618313", "title": "Unable to connect to MSSQL 2014 with Golang (without opening static port on MSSQL)", "body": "<p>For a database port # always be there. Either default or user-defined. MSSQL default port # are 1433 for TCP/IP and 1434 for USD connection. <code>denisenkom/go-msmsqldb</code> driver already using default port # if you don't provide one. </p>\n\n<p><code>denisenkom/go-msmsqldb</code> driver supports three ways (ADO, ODBC, URL) of connection string format. Choose yours as documented here <a href=\"https://github.com/denisenkom/go-mssqldb#connection-parameters-and-dsn\" rel=\"nofollow noreferrer\">https://github.com/denisenkom/go-mssqldb#connection-parameters-and-dsn</a></p>\n"}], "owner": {"reputation": 31, "user_id": 1948265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f630d378d3b726c9a4b4f556754c897?s=128&d=identicon&r=PG", "display_name": "Angad Singh Thandi", "link": "https://stackoverflow.com/users/1948265/angad-singh-thandi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 302, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497811388, "creation_date": 1497808965, "question_id": 44617976, "link": "https://stackoverflow.com/questions/44617976/unable-to-connect-to-mssql-2014-with-golang-without-opening-static-port-on-mssq", "title": "Unable to connect to MSSQL 2014 with Golang (without opening static port on MSSQL)", "body": "<p>I'm trying to connect my Golang app to MSSQL 2014.</p>\n\n<p>I have been successful using - <a href=\"https://github.com/denisenkom/go-mssqldb\" rel=\"nofollow noreferrer\">https://github.com/denisenkom/go-mssqldb</a>\nFor this, I only had enable a static port on my MSSQL &amp; things were good, I was able to get data.</p>\n\n<p>But what I want to achieve is to connect to MSSQL without needing to open up a static port on MSSQL, as my PHP app already does this using PDO.</p>\n\n<p>I also tried using - <a href=\"https://github.com/minus5/gofreetds\" rel=\"nofollow noreferrer\">https://github.com/minus5/gofreetds</a>\nbut was unable to install FreeTDS on Windows. But even in that I was seeing somewhere to setup a port for MSSQL, so I stopped.</p>\n\n<p>Another golang pkg that I came across was - <a href=\"https://github.com/alexbrainman/odbc\" rel=\"nofollow noreferrer\">https://github.com/alexbrainman/odbc</a>\nBut due to lack of doc, I'm still stuck. Unit tests for this pkg fail, saying the user login failed. But the login creds are working fine.</p>\n\n<p>Has anyone been successful in achieving this.</p>\n"}, {"tags": ["go", "revel"], "comments": [{"owner": {"reputation": 2054, "user_id": 615120, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/xoAHa.jpg?s=128&g=1", "display_name": "rnk", "link": "https://stackoverflow.com/users/615120/rnk"}, "edited": false, "score": 0, "creation_date": 1497799029, "post_id": 44615211, "comment_id": 76219117, "body": "Yes. When I check the documentation, it says &quot;Revel will watch all directories under app/ and rebuild when it notices any changes.&quot; <a href=\"https://revel.github.io/manual/organization.html\" rel=\"nofollow noreferrer\">revel.github.io/manual/organization.html</a>"}, {"owner": {"reputation": 29, "user_id": 8076465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3f673428ed39bc4de30351f2a3d557e?s=128&d=identicon&r=PG&f=1", "display_name": "Zonda", "link": "https://stackoverflow.com/users/8076465/zonda"}, "reply_to_user": {"reputation": 2054, "user_id": 615120, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/xoAHa.jpg?s=128&g=1", "display_name": "rnk", "link": "https://stackoverflow.com/users/615120/rnk"}, "edited": false, "score": 0, "creation_date": 1497802550, "post_id": 44615211, "comment_id": 76220088, "body": "@mk, thank you for you answer ..."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8067560"}, "is_accepted": false, "score": 0, "last_activity_date": 1497833844, "last_edit_date": 1592644375, "creation_date": 1497833844, "answer_id": 44620938, "question_id": 44615211, "link": "https://stackoverflow.com/questions/44615211/must-a-revel-application-have-an-app-folder-to-organize-its-code/44620938#44620938", "title": "Must a Revel application have an app folder to organize its code?", "body": "<p>Taken from <a href=\"https://revel.github.io/manual/organization.html\" rel=\"nofollow noreferrer\">https://revel.github.io/manual/organization.html</a></p>\n<blockquote>\n<p>The app/ directory contains the source code and templates for your application.</p>\n<p>app/controllers/ - All controllers are required here</p>\n<p>app/views - All templates are required here</p>\n</blockquote>\n<p>So yes you must keep the /app directory</p>\n"}], "owner": {"reputation": 29, "user_id": 8076465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3f673428ed39bc4de30351f2a3d557e?s=128&d=identicon&r=PG&f=1", "display_name": "Zonda", "link": "https://stackoverflow.com/users/8076465/zonda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1497833844, "creation_date": 1497790585, "last_edit_date": 1497802470, "question_id": 44615211, "link": "https://stackoverflow.com/questions/44615211/must-a-revel-application-have-an-app-folder-to-organize-its-code", "title": "Must a Revel application have an app folder to organize its code?", "body": "<p>revel new revel-svr1 :</p>\n\n<p>revel-svr</p>\n\n<pre><code> ----app\n        -----controllers\n        -----views\n</code></pre>\n\n<p>i create revel application revel-svr1,   it creates app folder which contains controller and views etc...,    if i delete app folder, it shows:</p>\n\n<p>revel-svr</p>\n\n<pre><code> ----controllers\n ----views\n</code></pre>\n\n<p>it does not work,  Does app folder must exists\uff1f</p>\n"}, {"tags": ["javascript", "go", "cryptography", "rsa", "digital-signature"], "answers": [{"tags": [], "owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "is_accepted": true, "score": 6, "last_activity_date": 1497786271, "creation_date": 1497786271, "answer_id": 44614615, "question_id": 44614413, "link": "https://stackoverflow.com/questions/44614413/javascript-golang-rsa-encrypt-verify/44614615#44614615", "title": "javascript / golang RSA encrypt / verify", "body": "<p>From the <a href=\"https://github.com/rzcoder/node-rsa\" rel=\"noreferrer\">Node-RSA pages</a>:</p>\n\n<blockquote>\n  <p>signingScheme \u2014 scheme used for signing and verifying. Can be <code>'pkcs1'</code> or <code>'pss'</code> or 'scheme-hash' format string (eg <code>'pss-sha1'</code>). <strong>Default <code>'pkcs1-sha256'</code></strong>, or, if chosen pss: <code>'pss-sha1'</code>.</p>\n</blockquote>\n\n<p>So the NodeJS implementation uses PKCS#1 v1.5 padding with SHA-256 while Go uses PSS padding with SHA-256.</p>\n\n<p>You basically need to make sure that your signature algorithms and their parameters match. Note that you may also want to make sure that the hash function used for MGF1 (the mask generation function within PSS) matches if you go for PSS and the code keeps failing.</p>\n"}], "owner": {"reputation": 3278, "user_id": 6435651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b5799143f90155b74e518118a3d1b62?s=128&d=identicon&r=PG&f=1", "display_name": "Ivaylo Ivanov", "link": "https://stackoverflow.com/users/6435651/ivaylo-ivanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 969, "favorite_count": 2, "accepted_answer_id": 44614615, "answer_count": 1, "score": 3, "last_activity_date": 1497786271, "creation_date": 1497784644, "last_edit_date": 1497785979, "question_id": 44614413, "link": "https://stackoverflow.com/questions/44614413/javascript-golang-rsa-encrypt-verify", "title": "javascript / golang RSA encrypt / verify", "body": "<p>I have the following javascript on the client</p>\n\n<pre><code>var NodeRSA = require('node-rsa');\n\nvar ClientSide = new NodeRSA({ b: 512 });\nvar privateKey = `-----BEGIN RSA PRIVATE KEY-----\nMIIEogIBAAKCAQEAj1IEeouqDYiMX0rMiPAI64UntzNxE01+tB+k+aKesHzVXE5A\nGnyWHIFdrByfjR93CMh3y56xsL78VP1/Xp8iVmAnbiFN5kpmawJ1owhDvNIl8A+Q\nUiDzMg0z/yepzjp61Dg4CUFzGrmTfYO1aMWyWhR0ZKfy+HvVaGjpod2ioScU7Fkz\neO+fDR85quLFta7OXDwqD4NCPYeZTS5fgK1Nn72nrItoj5e36fzWvZntfvi4NHt7\nnqOj4VH5e5YJHvmLWHh5Swh+OVyIAwhxYSK5PSupicGG8ixVy75hkjzZ2vW5JdVW\nMPYbVUMpqjtE+i1zQTYNJ36hM/zznZR/drU7UwIDAQABAoIBAHvs02qTMWuaUqZj\nKxCNXWkpLfo/RNsH+zMM2b3xW34HswWps8wzRilHwxN7fIquVmMF1HAAvGyz98QV\nnfjXaP1/DxkvOwiR9JU6/zUFhGzU2XEGRCh/zUnOGNPcG/vynRq7sdhu+3R0WpAB\nPu9lYp55aVtPzcwGZ7VsYfhQiLsGnJ5GkBS7z4P3aG29By6fGnTwR83iQHtR5SvQ\nRb/xJxZjTM00OZ2ssAtw24Hu8QXTuOAHdy2B5E1tsF+hVHs4iB0OiLzW7m4GBkb/\n/og76ouB4G+j6IjG2E5TO0eAdslKn2w3dZRgqnVDF5CPtRdbAc83xOwSouuuqN26\nFPsLkwECgYEA4Jyf3j9UzW0znnOcul4MDvfKuMCzD/5wnc24aYBbie4Joi/jqDbc\n9J5jqyfgzdqwjxiwkEFJi7gBcclO1i1SoIfA6ooVoJeQlzdMpSytZVhzgE2aJO1E\nORP7kLimAHysjMJ27Fix1VRZltcZe0E9DErkw/hoPemAMvDvW2myyaECgYEAo1k7\niS4O9GSHUKvbEJWR5r+9Qvv4aObOaRFRDfq4/E9fZwujzKAvxwkGFXjxwpzxKJqN\npaVEL2cWY+S46f4B501xgnNknuf6po8ZEaXD5vy281xoU4YX1KFySbV8eXGmkyiO\nM2+vPGrsTGOIsKnQW8jmaxWTClbSdPoLWfwzqHMCgYAS/Kp2+xuMEgMfDd7d0j1q\ntn+ohoGchIG4lT9Vi8gxLLIbx7iS67BZ7Vm3ijNys13hetDSIPK6oN9eYwoLCOHH\nODKSoQGbBbTvU3ljLRerTYLWAblaDcSKnqnRXgqKV/+uFnI/IHBH/E1mduBsjuM+\nOsaD2mfVc/umUr+pFpJKgQKBgCeaTb3fhc6oxMnBMLZfnOT13Zvs3PgJ5UdB5IXg\nIJNDZxzjjI3i1FKMFIaGMQ7+39T5S5g6bkKT2rDTViWc6Lc8ZmW7Nkz0byeMkAZg\nSxOod26fG8gMPaDWl4/ZSVlkPX92GKvNyw152tpWU2CJezOVjI+vxlt+Wz3zFWd2\npsuTAoGAbdlzYFK+7e2ru8fdbVk9SBLn9cnPdDCx+wgJV7dB0zzSh1oqIrE766Mx\nc9wBIKWNqNEsFsFI4ejuMRdC4Hyc6ecCNea3nj3BHCS70V0p1MtFII6SpADDqBTW\n3ZnLfcN2MiFDBXVqNkCsMcqd8KVdzEqEy1JDplmW84OpfQu88ms=\n-----END RSA PRIVATE KEY-----`\nvar publicKey = `-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAj1IEeouqDYiMX0rMiPAI\n64UntzNxE01+tB+k+aKesHzVXE5AGnyWHIFdrByfjR93CMh3y56xsL78VP1/Xp8i\nVmAnbiFN5kpmawJ1owhDvNIl8A+QUiDzMg0z/yepzjp61Dg4CUFzGrmTfYO1aMWy\nWhR0ZKfy+HvVaGjpod2ioScU7FkzeO+fDR85quLFta7OXDwqD4NCPYeZTS5fgK1N\nn72nrItoj5e36fzWvZntfvi4NHt7nqOj4VH5e5YJHvmLWHh5Swh+OVyIAwhxYSK5\nPSupicGG8ixVy75hkjzZ2vW5JdVWMPYbVUMpqjtE+i1zQTYNJ36hM/zznZR/drU7\nUwIDAQAB\n-----END PUBLIC KEY-----`\n\nClientSide.importKey(privateKey, 'pkcs1');\nlet result = ClientSide.sign('test_message', 'base64')\n\nconsole.log(result)\n\nvar serverSide = new NodeRSA({ b: 512 });\nserverSide.importKey(publicKey, 'pkcs8-public');\nconsole.log(serverSide.verify('test_message', new Buffer(result, 'base64')))\n</code></pre>\n\n<p>And the output for it is</p>\n\n<pre><code>baU/46UJYUp6Xt6sYs306t1vQdUOBRg10YuJPKspwLYj3aJHMgeQXMSfvBKvS+PJ3CMSVMVVjvoweNRu7A6ZzCSyVub9+qv0u5/2vSdUqiLDSHP5Gj9CRxsWPTLnapS27CJh3ywhqfgkuOSt6RZYTXqqoraHMP2jmGjfdLQmJbPiWamOc20u7xeTHK8oRmpXV0Pi5w4+7E6CkyfF9EfpLmmGGYiKqOWriWhYFbqkp+OV7FY4WRN1KwtmcZcnlWZ/4wAzg9uDL+8ZGyWKq62JY6Ee8LO5u6FCG7lU3KqBdq4eFKYI3CM9wdrxoZ7kNUlq0tQGZQ++MihdZQOfwj1vSA==\n\ntrue\n</code></pre>\n\n<p>So with that code snippet I'm able to sign and verify the message.\nHowever, I'm not able to verify the signed message with the following Go snippet.</p>\n\n<pre><code>package main\n\nimport (\n  \"crypto\"\n  \"crypto/rsa\"\n  \"crypto/x509\"\n  \"encoding/base64\"\n  \"encoding/pem\"\n  \"errors\"\n  \"fmt\"\n  \"os\"\n)\n\nfunc main() {\n\n  toSign := \"test_message\"\n\n  signed, err := base64.StdEncoding.DecodeString(\"baU/46UJYUp6Xt6sYs306t1vQdUOBRg10YuJPKspwLYj3aJHMgeQXMSfvBKvS+PJ3CMSVMVVjvoweNRu7A6ZzCSyVub9+qv0u5/2vSdUqiLDSHP5Gj9CRxsWPTLnapS27CJh3ywhqfgkuOSt6RZYTXqqoraHMP2jmGjfdLQmJbPiWamOc20u7xeTHK8oRmpXV0Pi5w4+7E6CkyfF9EfpLmmGGYiKqOWriWhYFbqkp+OV7FY4WRN1KwtmcZcnlWZ/4wAzg9uDL+8ZGyWKq62JY6Ee8LO5u6FCG7lU3KqBdq4eFKYI3CM9wdrxoZ7kNUlq0tQGZQ++MihdZQOfwj1vSA==\")\n  if err != nil {\n    println(\"unable do decode\")\n    os.Exit(1)\n  }\n\n  parser, err := loadPublicKey()\n  if err != nil {\n    println(\"unable to load public key\")\n    os.Exit(1)\n  }\n\n  err = parser.Unsign([]byte(toSign), signed)\n  if err != nil {\n    println(\"unable to verify\")\n    os.Exit(1)\n  }\n\n}\n\nfunc loadPublicKey() (Unsigner, error) {\n\n  return parsePublicKey([]byte(`-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAj1IEeouqDYiMX0rMiPAI\n64UntzNxE01+tB+k+aKesHzVXE5AGnyWHIFdrByfjR93CMh3y56xsL78VP1/Xp8i\nVmAnbiFN5kpmawJ1owhDvNIl8A+QUiDzMg0z/yepzjp61Dg4CUFzGrmTfYO1aMWy\nWhR0ZKfy+HvVaGjpod2ioScU7FkzeO+fDR85quLFta7OXDwqD4NCPYeZTS5fgK1N\nn72nrItoj5e36fzWvZntfvi4NHt7nqOj4VH5e5YJHvmLWHh5Swh+OVyIAwhxYSK5\nPSupicGG8ixVy75hkjzZ2vW5JdVWMPYbVUMpqjtE+i1zQTYNJ36hM/zznZR/drU7\nUwIDAQAB\n-----END PUBLIC KEY-----`))\n}\n\nfunc parsePublicKey(pemBytes []byte) (Unsigner, error) {\n  block, _ := pem.Decode(pemBytes)\n  if block == nil {\n    return nil, errors.New(\"ssh: no key found\")\n  }\n\n  var rawkey interface{}\n  switch block.Type {\n  case \"PUBLIC KEY\":\n    rsa, err := x509.ParsePKIXPublicKey(block.Bytes)\n    if err != nil {\n      return nil, err\n    }\n    rawkey = rsa\n  default:\n    return nil, fmt.Errorf(\"ssh: unsupported key type %q\", block.Type)\n  }\n\n  return newUnsignerFromKey(rawkey)\n}\n\ntype Unsigner interface {\n  // Sign returns raw signature for the given data. This method\n  // will apply the hash specified for the keytype to the data.\n  Unsign(data []byte, sig []byte) error\n}\n\nfunc newUnsignerFromKey(k interface{}) (Unsigner, error) {\n  var sshKey Unsigner\n  switch t := k.(type) {\n  case *rsa.PublicKey:\n    sshKey = &amp;rsaPublicKey{t}\n  default:\n    return nil, fmt.Errorf(\"ssh: unsupported key type %T\", k)\n  }\n  return sshKey, nil\n}\n\ntype rsaPublicKey struct {\n  *rsa.PublicKey\n}\n\nfunc (r *rsaPublicKey) Unsign(message []byte, sig []byte) error {\n  var opts rsa.PSSOptions\n  opts.SaltLength = rsa.PSSSaltLengthAuto\n  PSSmessage := message\n  newhash := crypto.SHA256\n  pssh := newhash.New()\n  pssh.Write(PSSmessage)\n  hashed := pssh.Sum(nil)\n  return rsa.VerifyPSS(r.PublicKey, newhash, hashed, sig, &amp;opts)\n}\n</code></pre>\n\n<p>The snippet was found and a little bit modified from other answers, however I can't make it work.</p>\n"}, {"tags": ["go", "gzip", "reverse-proxy"], "answers": [{"tags": [], "owner": {"reputation": 887, "user_id": 8099995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WLnoV.png?s=128&g=1", "display_name": "berserkk", "link": "https://stackoverflow.com/users/8099995/berserkk"}, "is_accepted": true, "score": 3, "last_activity_date": 1497782345, "creation_date": 1497782345, "answer_id": 44614124, "question_id": 44613920, "link": "https://stackoverflow.com/questions/44613920/golang-http-response-gzip-writer-err-content-length-mismatch/44614124#44614124", "title": "Golang http.Response gzip writer ERR_CONTENT_LENGTH_MISMATCH", "body": "<p>You're not closing your <code>gz</code> writer. It's possible issue. <code>gzip.Writer</code> <a href=\"https://golang.org/pkg/compress/gzip/#NewWriter\" rel=\"nofollow noreferrer\">documentation</a> says:</p>\n\n<blockquote>\n  <p>It is the caller's responsibility to call Close on the WriteCloser when done. Writes may be buffered and not flushed until Close.</p>\n</blockquote>\n\n<p>So, try to add <code>gz.Close()</code> after you've completed writing data.</p>\n"}], "owner": {"reputation": 3, "user_id": 5403780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35cd49d85148368c5c6c5b0a2375962c?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Reggiori", "link": "https://stackoverflow.com/users/5403780/mario-reggiori"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 561, "favorite_count": 0, "accepted_answer_id": 44614124, "answer_count": 1, "score": 0, "last_activity_date": 1497804448, "creation_date": 1497780794, "last_edit_date": 1497804448, "question_id": 44613920, "link": "https://stackoverflow.com/questions/44613920/golang-http-response-gzip-writer-err-content-length-mismatch", "title": "Golang http.Response gzip writer ERR_CONTENT_LENGTH_MISMATCH", "body": "<p>I'm trying to gzip the proxied response from httputil.ReverseProxy -> ModifyResponse.\nSo I only have access to the http.Response object.</p>\n\n<pre><code>res.Body = ioutil.NopCloser(bytes.NewReader(minified))\nres.ContentLength = int64(len(minified))\nres.Header.Set(\"Content-Length\", strconv.Itoa(len(minified)))\nres.Header.Del(\"Content-Encoding\")\n</code></pre>\n\n<p>This works just fine. But when I gzip the content I'll get a content-length-mismatch error.</p>\n\n<pre><code>var buf bytes.Buffer\ngz := gzip.NewWriter(&amp;buf)\ngz.Write(minified)\n\nreadCloser := ioutil.NopCloser(&amp;buf)\nres.Body = readCloser\n\nres.ContentLength = int64(buf.Len())\nres.Header.Set(\"Content-Length\", strconv.Itoa(buf.Len()))\nres.Header.Set(\"Content-Encoding\", \"gzip\")\n</code></pre>\n\n<p>Can anyone tell what i'm doing wrong? The content-length is always 10 even when the input changes.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 46, "user_id": 8167759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t3Hka.png?s=128&g=1", "display_name": "JanB", "link": "https://stackoverflow.com/users/8167759/janb"}, "reply_to_user": {"reputation": 870, "user_id": 1824552, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8b564fbd72c8f888b18f0975d1d75d70?s=128&d=identicon&r=PG", "display_name": "hitochan", "link": "https://stackoverflow.com/users/1824552/hitochan"}, "edited": false, "score": 0, "creation_date": 1497780299, "post_id": 44613109, "comment_id": 76214055, "body": "No problem. I encountered <a href=\"https://github.com/gpmgo/gopm\" rel=\"nofollow noreferrer\">gopm</a> which is able to build binaries after pulling a certain version. But I didn&#39;t try it out by myself."}], "tags": [], "owner": {"reputation": 46, "user_id": 8167759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t3Hka.png?s=128&g=1", "display_name": "JanB", "link": "https://stackoverflow.com/users/8167759/janb"}, "is_accepted": true, "score": 2, "last_activity_date": 1497774454, "creation_date": 1497774454, "answer_id": 44613109, "question_id": 44612487, "link": "https://stackoverflow.com/questions/44612487/glide-get-and-go-get-install-different-versions/44613109#44613109", "title": "&quot;glide get&quot; and &quot;go get&quot; install different versions", "body": "<p>With glide you can specify a certain version of the package you want to install. This is done in the glide.yaml</p>\n\n<blockquote>\n  <p>TIP: The version is either VCS dependent and can be anything that can\n  be checked out or a semantic version constraint that can be parsed by\n  the github.com/ Masterminds/semver package. For example, with Git this\n  can be a branch, tag, or hash. This varies and depends on what's\n  supported in the VCS.</p>\n</blockquote>\n\n<pre><code>package: github.com/YOUR/PACKAGE\nimport:\n  - package: github.com/onsi/ginkgo/ginkgo\n    version: master\n    repo: git@github.com:onsi/ginkgo.git\n</code></pre>\n\n<p>This will download the latest master commit.</p>\n\n<p><a href=\"https://glide.readthedocs.io/en/latest/versions/\" rel=\"nofollow noreferrer\">Here</a> are further information about versioning with glide. </p>\n"}], "owner": {"reputation": 870, "user_id": 1824552, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8b564fbd72c8f888b18f0975d1d75d70?s=128&d=identicon&r=PG", "display_name": "hitochan", "link": "https://stackoverflow.com/users/1824552/hitochan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1690, "favorite_count": 0, "accepted_answer_id": 44613109, "answer_count": 1, "score": 0, "last_activity_date": 1497774454, "creation_date": 1497768844, "last_edit_date": 1497769400, "question_id": 44612487, "link": "https://stackoverflow.com/questions/44612487/glide-get-and-go-get-install-different-versions", "title": "&quot;glide get&quot; and &quot;go get&quot; install different versions", "body": "<p>I use <a href=\"http://onsi.github.io/ginkgo/\" rel=\"nofollow noreferrer\"><code>ginkgo</code></a> for the test tool, and <a href=\"https://github.com/Masterminds/glide\" rel=\"nofollow noreferrer\"><code>glide</code></a> for the package manager.</p>\n\n<p><code>ginkgo</code> requires that we install a binary to generate test files automatically. <code>glide</code>, to the best of my knowledge, does not support the installation of binaries. So, I ended up using <code>go get</code> to install the binary, along with its source files. </p>\n\n<p>A problem is that <code>glide</code> installs all the packages that it resolves by scanning the go files. This means that the source files of <code>ginkgo</code> are also installed. \nDuring the compilation, the packages in <code>vendor</code> directory is prioritized. So this causes the situation where binary from <code>$GOPATH/bin</code> is used, and source files from <code>vendor</code> directory are used.\nAnd it seems that <code>go get</code> fetches files from master branch, where as <code>glide</code> fetches the latest released version. So the test files that are generated by the binary is not compatible with the source files installed by glide. </p>\n\n<p>Is there any way to prevent glide from installing some specific packages?\nOr are there any other better ways?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 4, "last_activity_date": 1497761580, "last_edit_date": 1497761580, "creation_date": 1497760224, "answer_id": 44611754, "question_id": 44611696, "link": "https://stackoverflow.com/questions/44611696/gin-gonic-json-conversion-output-throws-empty-array/44611754#44611754", "title": "gin-gonic json conversion output throws empty array", "body": "<p>Issue is <code>InventoryItem</code> struct fields have to be exported -</p>\n\n<pre><code>type InventoryItem struct {\n   ID                 int    `json:\"id\"`\n   ProductID          string `json:\"product_id\"`\n   ProductCost        int    `json:\"product_cost\"`\n   ProductAvailabilty int    `json:\"product_availability\"`\n   ProductSubcat      string `json:\"product_subact\"`\n}\n</code></pre>\n\n<p>Read more about <a href=\"https://www.goinggo.net/2014/03/exportedunexported-identifiers-in-go.html\" rel=\"nofollow noreferrer\">exported and un-exported fields</a>.</p>\n"}], "owner": {"reputation": 495, "user_id": 1202120, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/bc5e48a744be5fa1a7be649d2f1ad176?s=128&d=identicon&r=PG", "display_name": "debianmaster", "link": "https://stackoverflow.com/users/1202120/debianmaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1059, "favorite_count": 0, "accepted_answer_id": 44611754, "answer_count": 1, "score": 3, "last_activity_date": 1497761580, "creation_date": 1497759278, "question_id": 44611696, "link": "https://stackoverflow.com/questions/44611696/gin-gonic-json-conversion-output-throws-empty-array", "title": "gin-gonic json conversion output throws empty array", "body": "<p>for the following golang program, i'm not able to get json output using gin-gonic library, if i do fmt.Print variable shows values, but when i convert to c.JSON (inventory) out  it shows empty array,   what is wrong with my code? </p>\n\n<pre><code>   package main\n\nimport (\n    \"database/sql\"\n    \"os\"\n\n    \"github.com/gin-gonic/gin\"\n    _ \"github.com/go-sql-driver/mysql\"\n)\n\nfunc index(c *gin.Context) {\n    hostname, err := os.Hostname()\n    checkErr(err)\n    c.String(200, \"v3 \"+hostname)\n}\n\nfunc healthz(c *gin.Context) {\n    c.String(200, \"OK\")\n}\n\ntype InventoryItem struct {\n    id                 int\n    productID          string\n    productCost        int\n    productAvailabilty int\n    productSubcat      string\n}\n\nfunc checkErr(err error) {\n    if err != nil {\n        panic(err)\n    }\n}\n\n/*******************  MAIN Function **************/\nfunc main() {\n    app := gin.Default()\n    app.GET(\"/\", index)\n    app.GET(\"/healthz\", healthz)\n    app.GET(\"/inventory\", fetch)\n    app.Run(\":8000\")\n}\n\n/******************* End MAIN Function **************/\n\nfunc fetch(c *gin.Context) {\n    var (\n        invt      InventoryItem\n        inventory []InventoryItem\n    )\n    connStr := os.Getenv(\"sql_user\") + \":\" + os.Getenv(\"sql_password\") + \"@tcp(\" + os.Getenv(\"sql_host\") + \":3306)/\" + os.Getenv(\"sql_db\")\n    db, err := sql.Open(\"mysql\", connStr)\n    checkErr(err)\n    defer db.Close()\n    rows, err := db.Query(\"SELECT id,product_id as productID,product_cost as productCost,product_availabilty as productAvailabilty,product_subcat as productSubcat FROM inventory;\")\n    for rows.Next() {\n        err = rows.Scan(&amp;invt.id, &amp;invt.productID, &amp;invt.productCost, &amp;invt.productAvailabilty, &amp;invt.productSubcat)\n        checkErr(err)\n        inventory = append(inventory, invt)\n    }\n\n    checkErr(err)\n    defer rows.Close()\n    //fmt.Print(inventory[0].productAvailabilty)\n    c.JSON(200, inventory)\n}\n</code></pre>\n"}, {"tags": ["go", "d"], "comments": [{"owner": {"reputation": 789, "user_id": 4747244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7c82174f6c124097421941e6b2584ff?s=128&d=identicon&r=PG", "display_name": "cym13", "link": "https://stackoverflow.com/users/4747244/cym13"}, "edited": false, "score": 1, "creation_date": 1497731058, "post_id": 44608929, "comment_id": 76204933, "body": "I don&#39;t see any obvious performance issue but it&#39;s hard to say because your example code isn&#39;t compilable so I can&#39;t profile it. Is there any way to transform that into a <a href=\"http://www.sscce.org/\" rel=\"nofollow noreferrer\">sscce.org</a> ? EDIT: forgot to say but please also include information about what compiler you used and in what setting, this can lead to huge differences."}, {"owner": {"reputation": 1602, "user_id": 3105524, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/5b169766a0453f1ace846e5d425c940b?s=128&d=identicon&r=PG", "display_name": "Kamyar", "link": "https://stackoverflow.com/users/3105524/kamyar"}, "reply_to_user": {"reputation": 789, "user_id": 4747244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7c82174f6c124097421941e6b2584ff?s=128&d=identicon&r=PG", "display_name": "cym13", "link": "https://stackoverflow.com/users/4747244/cym13"}, "edited": false, "score": 0, "creation_date": 1497731496, "post_id": 44608929, "comment_id": 76205028, "body": "I am using default D anf Go compiler! I mean latest version of dub and Google Go! The requirements is just 2 packages: \t&quot;dependencies&quot;: { \t    &quot;vibe-d&quot;: &quot;~&gt;0.7.30&quot;,         &quot;cbor-d&quot;: &quot;~&gt;0.5.4&quot;  \t},"}, {"owner": {"reputation": 472, "user_id": 2229666, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/lRaSU.png?s=128&g=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/2229666/john-smith"}, "edited": false, "score": 1, "creation_date": 1497731626, "post_id": 44608929, "comment_id": 76205058, "body": "what performance results are you getting and what did you expect?"}, {"owner": {"reputation": 1602, "user_id": 3105524, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/5b169766a0453f1ace846e5d425c940b?s=128&d=identicon&r=PG", "display_name": "Kamyar", "link": "https://stackoverflow.com/users/3105524/kamyar"}, "edited": false, "score": 0, "creation_date": 1497732094, "post_id": 44608929, "comment_id": 76205183, "body": "Using ab, Go has about 4200 req/s and D about 2800!"}, {"owner": {"reputation": 472, "user_id": 2229666, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/lRaSU.png?s=128&g=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/2229666/john-smith"}, "edited": false, "score": 4, "creation_date": 1497733280, "post_id": 44608929, "comment_id": 76205470, "body": "have you tried profiling it?"}, {"owner": {"reputation": 1602, "user_id": 3105524, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/5b169766a0453f1ace846e5d425c940b?s=128&d=identicon&r=PG", "display_name": "Kamyar", "link": "https://stackoverflow.com/users/3105524/kamyar"}, "reply_to_user": {"reputation": 472, "user_id": 2229666, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/lRaSU.png?s=128&g=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/2229666/john-smith"}, "edited": false, "score": 0, "creation_date": 1497733743, "post_id": 44608929, "comment_id": 76205583, "body": "@JohnSmith Not yet. But it is a tiny code! I think it is not needed!"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 4, "creation_date": 1497734820, "post_id": 44608929, "comment_id": 76205849, "body": "@Kamyar That&#39;s only the code <i>you</i> wrote. Each library function call calls more code which calls more code which calls more code... And then the amount of code has little to do with performance. One can write very slow code in very few lines."}], "answers": [{"tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 6, "last_activity_date": 1497734286, "creation_date": 1497734286, "answer_id": 44609465, "question_id": 44608929, "link": "https://stackoverflow.com/questions/44608929/why-my-d-code-is-not-performant-as-expected/44609465#44609465", "title": "Why my D code is not performant as expected?", "body": "<p>You're not just benchmarking Go vs D. You're also benchmarking your particular choice of non-standard Go and D libraries against each other: <code>cbor</code>, <code>vibe</code>, <code>iris</code>, etc. And you're benchmarking your particular implementation <a href=\"https://github.com/schwern/adventofcode.go/commit/60a05776c4c6ff7b9af9867ceaa88ee371955c2a\" rel=\"noreferrer\">which can easily vary by 1000x in performance</a>.</p>\n\n<p>With this many variables, the raw benchmark numbers are pretty meaningless for comparing the performance of two languages. It's possible any one of those 3rd party libraries are causing a performance problem. Really you're comparing just those two particular programs. This is the core problem of trying to compare anything but trivial programs across languages: there's too many variables.</p>\n\n<hr>\n\n<p>You can reduce the impact of some of these variables with <a href=\"https://en.wikipedia.org/wiki/Profiling_(computer_programming)\" rel=\"noreferrer\">performance profiling</a>; in Go this would be <code>go tool pprof</code>. This will tell you what functions and lines are being called how many times and taking how much resources. With that you can find bottlenecks, places in the code which are consuming a lot of resources, and focus optimization efforts there.</p>\n\n<p>As you do profile and optimization rounds for each version, you'll get closer to comparing real, optimized implementations. Or you'll have a better understanding of what each language and library does efficiently, and what they don't.</p>\n\n<hr>\n\n<p>The problem of comparing languages is heavily influenced by the particular problem and the particular programmer. X programmers invariably find X to be the best language not because X is the best language, but because X programmers are their best when writing in X and probably chose a problem they're comfortable with. Because of this, there are a number of projects to crowd source the best implementation for each language.</p>\n\n<p>The one which immediately comes to mind is <a href=\"http://benchmarksgame.alioth.debian.org/\" rel=\"noreferrer\">The Computer Language Benchmarks Game</a>. They do Go, but not D. Maybe you can add it?</p>\n"}], "owner": {"reputation": 1602, "user_id": 3105524, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/5b169766a0453f1ace846e5d425c940b?s=128&d=identicon&r=PG", "display_name": "Kamyar", "link": "https://stackoverflow.com/users/3105524/kamyar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 44609465, "answer_count": 1, "score": -4, "last_activity_date": 1497734286, "creation_date": 1497729941, "last_edit_date": 1497732135, "question_id": 44608929, "link": "https://stackoverflow.com/questions/44608929/why-my-d-code-is-not-performant-as-expected", "title": "Why my D code is not performant as expected?", "body": "<p>I am doing a benchmark test for my own fun! I have written a part of code in many programming languages and benchmark it using ab to see which is faster and how much. I know the method may not be so valid and can not be used as an evident to use some, but for my own information I am doing so. The other factor I want to know is how easy/difficult is writing the same sample in each language. I wrote the code in Python/Python(asyncio),Haskell,Go, Kotlin and D. I expcted the D port to be faster than Go (or at least equal in speed). But unfortunately my D code is much slower than Go. Here I put oth codes and please help me why the code is not fast as expected. Or am I wrong absolutely in my expectations?</p>\n\n<pre><code>import cbor;\nimport std.array : appender;\nimport std.format;\nimport std.json;\nimport vibe.vibe;\n\n\nstruct Location\n{\n    float latitude;\n    float longitude;\n    float altitude;\n    float bearing;\n}\nRedisClient redis;\n\n\nvoid main()\n{\n    auto settings = new HTTPServerSettings;\n    redis = connectRedis(\"localhost\", 6379);\n\n    settings.port = 8080;\n    settings.bindAddresses = [\"::1\", \"127.0.0.1\"];\n    listenHTTP(settings, &amp;hello);\n\n    logInfo(\"Please open http://127.0.0.1:8080/ in your browser.\");\n   runApplication();\n}\n\nvoid hello(HTTPServerRequest req, HTTPServerResponse res)\n{\n\nif (req.path == \"/locations\") {\n\n    immutable auto data = req.json;\n    immutable auto loc = deserializeJson!Location(data);\n    auto buffer = appender!(ubyte[])();\n    encodeCborAggregate!(Flag!\"WithFieldName\".yes)(buffer, loc);\n    auto db = redis.getDatabase(0);\n\n    db.set(\"Vehicle\", cast(string) buffer.data);\n    res.writeBody(\"Ok\"); \n    }\n}\n</code></pre>\n\n<p>And here is the Go</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/kataras/iris\"\n    \"github.com/kataras/iris/context\"\n)\n\nimport \"github.com/go-redis/redis\"\n\nimport (\n    \"bytes\"\n    \"github.com/2tvenom/cbor\"\n)\n\ntype Location struct {\n    Latitude  float32 `json:\"latitude\"`\n    Longitude float32 `json:\"longitude\"`\n    Altitude  float32 `json:\"altitude\"`\n    Bearing   float32 `json:\"bearing\"`\n}\n\nfunc main() {\n    app := iris.New()\n    client := redis.NewClient(&amp;redis.Options{Addr: \"localhost:6379\"})\n\n    app.Post(\"/locations\", func(ctx context.Context) {\n        var loc Location\n        ctx.ReadJSON(&amp;loc)\n        var buffTest bytes.Buffer\n        encoder := cbor.NewEncoder(&amp;buffTest)\n        encoder.Marshal(loc)\n        client.Set(\"vehicle\", buffTest.Bytes(), 0)\n        client.Close()\n        ctx.Writef(\"ok\")\n    })\n    app.Run(iris.Addr(\":8080\"), iris.WithCharset(\"UTF-8\"))\n}\n</code></pre>\n\n<p>Using ab, Go results in about 4200 req/sec, while D about 2800 req/sec!</p>\n"}, {"tags": ["json", "go"], "answers": [{"tags": [], "owner": {"reputation": 2054, "user_id": 615120, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/xoAHa.jpg?s=128&g=1", "display_name": "rnk", "link": "https://stackoverflow.com/users/615120/rnk"}, "is_accepted": true, "score": 1, "last_activity_date": 1497719813, "last_edit_date": 1497719813, "creation_date": 1497719106, "answer_id": 44607216, "question_id": 44606910, "link": "https://stackoverflow.com/questions/44606910/whats-the-best-way-to-retrieve-value-of-array-element-from-a-json-string/44607216#44607216", "title": "Whats the best way to retrieve value of array element from a JSON string", "body": "<p>You can do this <a href=\"https://play.golang.org/p/27eKFmBCHY\" rel=\"nofollow noreferrer\">https://play.golang.org/p/27eKFmBCHY</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n\n)\n\nfunc main() {\n    const input = `{\n        \"kind\": \"ServiceAccount\",\n        \"apiVersion\": \"v1\",\n        \"metadata\": {\n            \"name\": \"default\",\n            \"namespace\": \"mynamespace\",\n            \"selfLink\":      \"/api/v1/namespaces/mynamespace/serviceaccounts/default\",\n            \"uid\": \"483d1043-4d68-11e7-be08-3a3f3b149220\",\n            \"resourceVersion\": \"425039\",\n            \"creationTimestamp\": \"2017-06-09T23:06:34Z\"\n        },\n        \"secrets\": [\n            {\n                \"name\": \"default-token-k99mq\"\n            }\n         ]\n    }`\n    type NameStruct struct {\n        Name string `json:\"name\"`\n    }\n    type Secret struct {\n        Secrets []NameStruct `json:\"secrets\"`\n    }\n\n    secret := Secret{}\n    json.Unmarshal([]byte(input), &amp;secret)\n    fmt.Println(secret.Secrets[0].Name)\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 3598326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9c5d3fbfdbfc5b616e42917dd511059?s=128&d=identicon&r=PG&f=1", "display_name": "user3598326", "link": "https://stackoverflow.com/users/3598326/user3598326"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 44607216, "answer_count": 1, "score": -3, "last_activity_date": 1497779183, "creation_date": 1497717274, "last_edit_date": 1497779183, "question_id": 44606910, "link": "https://stackoverflow.com/questions/44606910/whats-the-best-way-to-retrieve-value-of-array-element-from-a-json-string", "title": "Whats the best way to retrieve value of array element from a JSON string", "body": "<p>Trying to retrieve value \"default-token-k99mq\" from below JSON in go program ...</p>\n\n<pre><code>const input = `{\n  \"kind\": \"ServiceAccount\",\n  \"apiVersion\": \"v1\",\n  \"metadata\": {\n    \"name\": \"default\",\n    \"namespace\": \"mynamespace\",\n    \"selfLink\":         \"/api/v1/namespaces/mynamespace/serviceaccounts/default\",\n    \"uid\": \"483d1043-4d68-11e7-be08-3a3f3b149220\",\n    \"resourceVersion\": \"425039\",\n    \"creationTimestamp\": \"2017-06-09T23:06:34Z\"\n  },\n  \"secrets\": [\n    {\n      \"name\": \"default-token-k99mq\"\n    }\n  ]\n}`\n</code></pre>\n\n<p>Need to get names from <code>secrets</code> array </p>\n"}, {"tags": ["go", "linker", "static-linking", "dynamic-linking"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497716520, "post_id": 44606374, "comment_id": 76200472, "body": "What do you mean with <i>dynamic executables</i>? Although the produced binary is statically linked, it may still depends on <i>core system library</i> e.g. <code>libc</code> in POSIX system, <code>kernel32.dll</code> in Windows, etc."}, {"owner": {"reputation": 695, "user_id": 3555136, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e6dcfdfbc04f0aa4a77dc44bda7063a7?s=128&d=identicon&r=PG&f=1", "display_name": "enitihas", "link": "https://stackoverflow.com/users/3555136/enitihas"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497717401, "post_id": 44606374, "comment_id": 76200783, "body": "I mean dynamically linked executables. I should have mentioned it clearly."}, {"owner": {"reputation": 695, "user_id": 3555136, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e6dcfdfbc04f0aa4a77dc44bda7063a7?s=128&d=identicon&r=PG&f=1", "display_name": "enitihas", "link": "https://stackoverflow.com/users/3555136/enitihas"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497717489, "post_id": 44606374, "comment_id": 76200811, "body": "Also, running ldd on most golang built binaries gives the output &#39;not a dynamic executable&#39;, so I think not even dependent on libc. But some projects have dynamically linked binaries."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497719922, "post_id": 44606374, "comment_id": 76201598, "body": "It depends on the package that is being used by the executable. For example when using <code>net&#47;http</code> as in <a href=\"https://golang.org/pkg/net/http/#example_Get\" rel=\"nofollow noreferrer\">Get example</a>, the produced binary depends on <code>pthread</code>, <code>libc</code>, etc..."}], "answers": [{"comments": [{"owner": {"reputation": 695, "user_id": 3555136, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e6dcfdfbc04f0aa4a77dc44bda7063a7?s=128&d=identicon&r=PG&f=1", "display_name": "enitihas", "link": "https://stackoverflow.com/users/3555136/enitihas"}, "edited": false, "score": 0, "creation_date": 1497715897, "post_id": 44606582, "comment_id": 76200282, "body": "I too initially thought so. However, I searched in one of the projects (gocode) for &#39;import &quot;C&quot; statements, but couldn&#39;t find any. But the gocde binary is dynamically linked."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 695, "user_id": 3555136, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e6dcfdfbc04f0aa4a77dc44bda7063a7?s=128&d=identicon&r=PG&f=1", "display_name": "enitihas", "link": "https://stackoverflow.com/users/3555136/enitihas"}, "edited": false, "score": 3, "creation_date": 1497720087, "post_id": 44606582, "comment_id": 76201627, "body": "@enitihas, just because a package doesn&#39;t use cgo, doesn&#39;t mean its dependencies don&#39;t. Even the std library may use cgo, like in the <code>net</code> package, <code>os&#47;user</code>, or <code>crypto&#47;tls</code>."}, {"owner": {"reputation": 695, "user_id": 3555136, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e6dcfdfbc04f0aa4a77dc44bda7063a7?s=128&d=identicon&r=PG&f=1", "display_name": "enitihas", "link": "https://stackoverflow.com/users/3555136/enitihas"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497720394, "post_id": 44606582, "comment_id": 76201721, "body": "@JimB Is it possible to create statically linked binaries with go even when using such packages from the stdlib?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 695, "user_id": 3555136, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e6dcfdfbc04f0aa4a77dc44bda7063a7?s=128&d=identicon&r=PG&f=1", "display_name": "enitihas", "link": "https://stackoverflow.com/users/3555136/enitihas"}, "edited": false, "score": 1, "creation_date": 1497726135, "post_id": 44606582, "comment_id": 76203545, "body": "@enitihas, yes, sometimes, on some OSes. In some cases you can statically link using cgo too. You have to show exactly what you&#39;re tying to do."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497732011, "post_id": 44606582, "comment_id": 76205169, "body": "Cross-compiling Linux binaries on Windows delivers static binaries, as does building with <code>CGO_ENABLED=0</code>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497744089, "post_id": 44606582, "comment_id": 76207726, "body": "@Adrian, while it takes some extra setup, you can cross-compile with cgo"}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 3, "last_activity_date": 1497715338, "creation_date": 1497715338, "answer_id": 44606582, "question_id": 44606374, "link": "https://stackoverflow.com/questions/44606374/in-what-cases-are-go-binaries-dynamically-linked/44606582#44606582", "title": "In what cases are go binaries dynamically linked?", "body": "<p>When using <a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow noreferrer\">cgo</a>, which is how Go links to C programs, which can of course use dynamically-linked libraries.</p>\n"}, {"tags": [], "owner": {"reputation": 622, "user_id": 5604249, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/7bed34ebe08c34a10addbea1bf85ff17?s=128&d=identicon&r=PG&f=1", "display_name": "Pharaoh", "link": "https://stackoverflow.com/users/5604249/pharaoh"}, "is_accepted": false, "score": 0, "last_activity_date": 1497873157, "creation_date": 1497873157, "answer_id": 44629863, "question_id": 44606374, "link": "https://stackoverflow.com/questions/44606374/in-what-cases-are-go-binaries-dynamically-linked/44629863#44629863", "title": "In what cases are go binaries dynamically linked?", "body": "<p>Go 1.8 has introduced something called Go Plugin which seems to be using dynamic linking.</p>\n\n<p><a href=\"https://golang.org/pkg/plugin/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/plugin/</a></p>\n"}], "owner": {"reputation": 695, "user_id": 3555136, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e6dcfdfbc04f0aa4a77dc44bda7063a7?s=128&d=identicon&r=PG&f=1", "display_name": "enitihas", "link": "https://stackoverflow.com/users/3555136/enitihas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2182, "favorite_count": 0, "accepted_answer_id": 44606582, "answer_count": 2, "score": 4, "last_activity_date": 1497873157, "creation_date": 1497714053, "question_id": 44606374, "link": "https://stackoverflow.com/questions/44606374/in-what-cases-are-go-binaries-dynamically-linked", "title": "In what cases are go binaries dynamically linked?", "body": "<p>One important feature of the Go programming language is that it produces statically linked binaries. However, when I ran 'ldd *' in my $GOPATH/bin, I found several dynamic executables. Is there a clear set of rules to understand under what circumstances does the go compiler produce dynamically linked binaries?</p>\n"}, {"tags": ["go", "cygwin", "build-error"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497705993, "post_id": 44605108, "comment_id": 76197296, "body": "Why are you trying to build a go program from cygwin? While there might be a way to make it work, its not a supported use-case, and Go is natively supported on windows."}, {"owner": {"reputation": 11, "user_id": 8175960, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MYbaWzbfdVY/AAAAAAAAAAI/AAAAAAAAAC0/CgLzHSy4k8s/photo.jpg?sz=128", "display_name": "Alonzo C", "link": "https://stackoverflow.com/users/8175960/alonzo-c"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497706062, "post_id": 44605108, "comment_id": 76197325, "body": "i need to use <code>make</code> and cygwin is my compiler of choice"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1497706551, "post_id": 44605108, "comment_id": 76197468, "body": "I&#39;m fairly certain that for cgo especially, you&#39;re going to need to use mingw."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497707141, "post_id": 44605108, "comment_id": 76197671, "body": "What is your <code>golang</code> version? According to <a href=\"https://github.com/golang/go/issues/8756\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/8756</a>, the issue should be fixed in <code>go1.8</code>. I&#39;m agree with JimB. Personally, I&#39;m using <a href=\"http://www.msys2.org\" rel=\"nofollow noreferrer\">http://www.msys2.org</a>. <code>Go</code> package and <code>MinGW</code> compiler are provided in the repository, and is uptodate."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 1, "creation_date": 1497715131, "post_id": 44605108, "comment_id": 76200063, "body": "Use MinGW. See: <a href=\"https://stackoverflow.com/questions/37497354/compile-cgo-lib-on-cygwin64-ld-cannot-find-lmingw32\">https://stackoverflow.com/questions/37497354/compile-cgo-lib&zwnj;&#8203;-on-cygwin64-ld-cann&zwnj;&#8203;ot-find-lmingw32</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2182, "user_id": 3230146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e16f58dd24d4f673ddda1e32ce21b79?s=128&d=identicon&r=PG&f=1", "display_name": "Joel", "link": "https://stackoverflow.com/users/3230146/joel"}, "edited": false, "score": 0, "creation_date": 1535401587, "post_id": 49643557, "comment_id": 91044006, "body": "This solved it for me! I tried a ton of different compiler installs and this one just worked. One note for future readers - I did have to delete and re <code>go get</code> the package I wanted to use so that it compiled with the new GCC install and worked with the resulting <code>go build</code>. Until I did this I still got errors. Thanks so much!"}], "tags": [], "owner": {"reputation": 31, "user_id": 4840579, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-K0Gm8K8RKps/AAAAAAAAAAI/AAAAAAAADsI/r5op7gbMDkM/photo.jpg?sz=128", "display_name": "pakoy3k", "link": "https://stackoverflow.com/users/4840579/pakoy3k"}, "is_accepted": false, "score": 3, "last_activity_date": 1522820347, "creation_date": 1522820347, "answer_id": 49643557, "question_id": 44605108, "link": "https://stackoverflow.com/questions/44605108/any-ideas-how-to-solve-this-cygwin-go-build-error/49643557#49643557", "title": "Any Ideas how to solve this cygwin Go build error", "body": "<p>We had to remove cygwin and install this compiler <a href=\"http://tdm-gcc.tdragon.net/download\" rel=\"nofollow noreferrer\">http://tdm-gcc.tdragon.net/download</a> , and we had no problems.</p>\n\n<p>Remember to remove the cygwin gcc compiler from your PATH</p>\n\n<p>I hope it'll help you.</p>\n"}], "owner": {"reputation": 11, "user_id": 8175960, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MYbaWzbfdVY/AAAAAAAAAAI/AAAAAAAAAC0/CgLzHSy4k8s/photo.jpg?sz=128", "display_name": "Alonzo C", "link": "https://stackoverflow.com/users/8175960/alonzo-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1305, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1522820347, "creation_date": 1497705581, "last_edit_date": 1497713702, "question_id": 44605108, "link": "https://stackoverflow.com/questions/44605108/any-ideas-how-to-solve-this-cygwin-go-build-error", "title": "Any Ideas how to solve this cygwin Go build error", "body": "<p>I am building a go program for windows with cygwin. I cannot find a solution to this problem any where. any help would be useful.</p>\n\n<pre><code>C:\\Go\\pkg\\tool\\windows_amd64\\link.exe: running gcc failed: exit status 1\n/usr/lib/w32api/libntdll.a(dmsqs01966.o):(.text+0x0): multiple definition of `pow'\n/usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../lib/libm.a(t-d000990.o):fake:(.text+0x0): first defined here\n/usr/lib/w32api/libntdll.a(dmsqs01956.o):(.text+0x0): multiple definition of `log'\n/usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../lib/libm.a(t-d000824.o):fake:(.text+0x0): first defined here\n/usr/lib/w32api/libntdll.a(dmsqs01934.o):(.text+0x0): multiple definition of `ceil'\n/usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../lib/libm.a(t-d000253.o):fake:(.text+0x0): first defined here\nC:\\cygwin64\\tmp\\go-link-845985599/000001.o: In function `x_cgo_sys_thread_create':\nC:/workdir/go/src/runtime/cgo/gcc_libinit_windows.c:12: undefined reference to `__imp___iob_func'\nC:/workdir/go/src/runtime/cgo/gcc_libinit_windows.c:12:(.text+0x6): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `__imp___iob_func'\nC:\\cygwin64\\tmp\\go-link-845985599/000001.o: In function `x_cgo_thread_start':\nC:/workdir/go/src/runtime/cgo/gcc_util.c:43: undefined reference to `__imp___iob_func'\nC:/workdir/go/src/runtime/cgo/gcc_util.c:43:(.text+0xdc): relocation truncated \n</code></pre>\n\n<p>EDIT 1:\nSomeone sugested using 1.8 but another error msg</p>\n\n<pre><code>C:\\Go\\pkg\\tool\\windows_amd64\\link.exe: running gcc failed: exit status 1\nC:\\cygwin64\\tmp\\go-link-485496143\\000001.o: In function `_cgo_preinit_init':\nC:/workdir/go/src/runtime/cgo/gcc_libinit_windows.c:28: undefined reference to `__imp___iob_func'\nC:/workdir/go/src/runtime/cgo/gcc_libinit_windows.c:28:(.text+0x6a): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `__imp___iob_func'\nC:\\cygwin64\\tmp\\go-link-485496143\\000001.o: In function `x_cgo_sys_thread_create':\nC:/workdir/go/src/runtime/cgo/gcc_libinit_windows.c:56: undefined reference to `__imp__beginthread'\nC:/workdir/go/src/runtime/cgo/gcc_libinit_windows.c:56:(.text+0x10c): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `__imp__beginthread'\nC:/workdir/go/src/runtime/cgo/gcc_libinit_windows.c:58: undefined reference to `__imp__errno'\nC:/workdir/go/src/runtime/cgo/gcc_libinit_windows.c:58:(.text+0x11e): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `__imp__errno'\nC:/workdir/go/src/runtime/cgo/gcc_libinit_windows.c:58: undefined reference to `__imp___iob_func'\nC:/workdir/go/src/runtime/cgo/gcc_libinit_windows.c:58:(.text+0x126): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `__imp___iob_func'\nC:\\cygwin64\\tmp\\go-link-485496143\\000001.o: In function `x_cgo_notify_runtime_init_done':\nC:/workdir/go/src/runtime/cgo/gcc_libinit_windows.c:99: undefined reference to `__imp___iob_func'\nC:/workdir/go/src/runtime/cgo/gcc_libinit_windows.c:99:(.text+0x255): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `__imp___iob_func'\nC:\\cygwin64\\tmp\\go-link-485496143\\000001.o: In function `x_cgo_thread_start':\nC:/workdir/go/src/runtime/cgo/gcc_util.c:18: undefined reference to `__imp___iob_func'\nC:/workdir/go/src/runtime/cgo/gcc_util.c:18:(.text+0x32c): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `__imp___iob_func'\nC:\\cygwin64\\tmp\\go-link-485496143\\000001.o: In function `_cgo_sys_thread_start':\nC:/workdir/go/src/runtime/cgo/gcc_windows_amd64.c:32: undefined reference to `__imp__beginthread'\nC:/workdir/go/src/runtime/cgo/gcc_windows_amd64.c:32:(.text+0x403): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `__imp__beginthread'\nC:/workdir/go/src/runtime/cgo/gcc_windows_amd64.c:34: undefined reference to `__imp__errno'\nC:/workdir/go/src/runtime/cgo/gcc_windows_amd64.c:34:(.text+0x415): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `__imp__errno'\nC:/workdir/go/src/runtime/cgo/gcc_windows_amd64.c:34: undefined reference to `__imp___iob_func'\nC:/workdir/go/src/runtime/cgo/gcc_windows_amd64.c:34:(.text+0x41d): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `__imp___iob_func'\n/usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../lib/libmingwex.a(lib64_libmingwex_a-ftruncate.o):ftruncate.c:(.text+0x1): undefined reference to `_chsize'\n/usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../lib/libmingwex.a(lib64_libmingwex_a-ftruncate.o):ftruncate.c:(.text+0x1): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `_chsize'\n/usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../lib/libmingwex.a(lib64_libmingwex_a-_fstat.o):_fstat.c:(.text+0xf): undefined reference to `_fstat64'\n/usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../lib/libmingwex.a(lib64_libmingwex_a-_fstat.o):_fstat.c:(.text+0xf): additional relocation overflows omitted from the output\n/usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../lib/libmingwex.a(lib64_libmingwex_a-log.o):log.c:(.text+0x83): undefined reference to `_errno'\n/usr/lib/gcc/x86_64-pc-\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 313, "user_id": 2929925, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/ead5d98179d08112d9008e507384878b?s=128&d=identicon&r=PG&f=1", "display_name": "rahul", "link": "https://stackoverflow.com/users/2929925/rahul"}, "reply_to_user": {"reputation": 60839, "user_id": 301857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4KmT.jpg?s=128&g=1", "display_name": "Grant Winney", "link": "https://stackoverflow.com/users/301857/grant-winney"}, "edited": false, "score": 0, "creation_date": 1497703899, "post_id": 44604800, "comment_id": 76196665, "body": "i get thi errro parsing time &quot;Jan 2020&quot; as &quot;2006-01-02T15:04:05Z07:00&quot;: cannot parse &quot;Jan 2020&quot; as &quot;2006&quot; 0001-01-01 00:00:00 +0000 UTC"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1497713774, "post_id": 44604800, "comment_id": 76199694, "body": "Where&#39;s your code?"}], "answers": [{"tags": [], "owner": {"reputation": 1162, "user_id": 1653085, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8irj8.jpg?s=128&g=1", "display_name": "Vitaly Velikodny", "link": "https://stackoverflow.com/users/1653085/vitaly-velikodny"}, "is_accepted": true, "score": 2, "last_activity_date": 1524796056, "last_edit_date": 1524796056, "creation_date": 1497710994, "answer_id": 44605969, "question_id": 44604800, "link": "https://stackoverflow.com/questions/44604800/convert-string-date-month-year-to-time-time/44605969#44605969", "title": "Convert string date (Month, Year) to time.Time", "body": "<p>You need to have a layout string that specifies how to parse your string. For example:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"time\"\n    \"fmt\"\n)\n\nfunc main() {\n    time, err := time.Parse(\"Jan 2006\", \"Feb 2020\")\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(time)\n}\n</code></pre>\n\n<p>You may find more about the standard layouts <a href=\"https://golang.org/src/time/format.go\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 313, "user_id": 2929925, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/ead5d98179d08112d9008e507384878b?s=128&d=identicon&r=PG&f=1", "display_name": "rahul", "link": "https://stackoverflow.com/users/2929925/rahul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2708, "favorite_count": 0, "accepted_answer_id": 44605969, "answer_count": 1, "score": -3, "last_activity_date": 1524796056, "creation_date": 1497703492, "last_edit_date": 1497713797, "question_id": 44604800, "link": "https://stackoverflow.com/questions/44604800/convert-string-date-month-year-to-time-time", "title": "Convert string date (Month, Year) to time.Time", "body": "<p>I have a string which is :</p>\n\n<pre><code>str := \"Jan 2020\"\n</code></pre>\n\n<p>I need to convert this to time.time format in go.How can i do this please ? </p>\n"}, {"tags": ["go", "locking"], "answers": [{"tags": [], "owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "is_accepted": true, "score": 0, "last_activity_date": 1497822303, "last_edit_date": 1497822303, "creation_date": 1497778895, "answer_id": 44613689, "question_id": 44604261, "link": "https://stackoverflow.com/questions/44604261/when-we-will-use-not-re-entrance-lock/44613689#44613689", "title": "when we will use not re-entrance lock", "body": "<p>Here's an example of <b>bad</b> code just to illustrate the issue:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\ntype SafeCounter struct {\n    lock      sync.Mutex\n    count     int\n    enabled   bool\n    NextValue func(int) int\n}\n\nconst maxCount = 10\n\nfunc (c *SafeCounter) Count() int {\n    return c.count\n}\n\nfunc (c *SafeCounter) Increment() {\n    c.lock.Lock()\n    if c.enabled {\n        c.count = c.NextValue(c.count)\n    }\n    c.lock.Unlock()\n}\n\nfunc (c *SafeCounter) SetEnabled(enabled bool) {\n    c.lock.Lock()\n    c.enabled = enabled\n    if !enabled {\n        c.count = 0\n    }\n    c.lock.Unlock()\n}\n\nfunc main() {\n    var counter SafeCounter\n    counter.SetEnabled(true)\n    counter.NextValue = func(value int) int {\n        if counter.Count() &gt; maxCount {\n            // Safe counter doesn't expect this here!\n            // The program will panic in SetEnabled\n            counter.SetEnabled(false)\n        }\n        return value + 1\n    }\n    for i := 0; i &lt; 100; i++ {\n        doAction()\n        counter.Increment()\n    }\n    fmt.Println(counter.Count())\n}\n\nfunc doAction() {\n    // some action\n}\n</code></pre>\n\n<p>Both <code>Increment</code> and <code>SetEnabled</code> acquire locks because they can't allow the values of <code>enabled</code> and <code>count</code> to change while they're in the middle of something. However, if the lock was re-entrant (recursive), then it would be allowed (since both calls run on the same goroutine).</p>\n"}], "owner": {"reputation": 1887, "user_id": 6514989, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7cc849ff19574490024b6e12ef33c82b?s=128&d=identicon&r=PG&f=1", "display_name": "nail fei", "link": "https://stackoverflow.com/users/6514989/nail-fei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 44613689, "answer_count": 1, "score": -1, "last_activity_date": 1497822303, "creation_date": 1497700193, "last_edit_date": 1497715788, "question_id": 44604261, "link": "https://stackoverflow.com/questions/44604261/when-we-will-use-not-re-entrance-lock", "title": "when we will use not re-entrance lock", "body": "<p>As a beginner of golang, I find the <strong>mutex</strong> of golang is <strong>not re-entranceLock</strong> from the book <code>The Go Programming Language</code>. And they explain the reason as:</p>\n\n<blockquote>\n  <p>There is a good reason Go\u2019s mutexes are not re-entrant. The purpose of a mutex is to ensure that certain invariants of the shared variables are maintained at critical points during program execution. One of the invariants is \"no goroutine is accessing the shared variables,\" but there may be additional invariants specific to the data structures that the mutex guards. When a goroutine acquires a mutex lock, it may assume that the invariants hold. While it holds the\n  lock, it may update the shared variables so that the invariants are temporarily violated.\n  However, when it releases the lock, it must guarantee that order has been restored and the invariants hold once again. Although a re-entrant mutex would ensure that no other goroutines are accessing the shared variables, it cannot protect the additional invariants of those variables.</p>\n</blockquote>\n\n<p>it seemed the explain is detail enough, unfortunately I can't get it. I still don't know when we should use <strong>not re-entranceLock</strong>, and if not what bad surprise will I receive? I will appreciate if anyone can give me an example. </p>\n"}, {"tags": ["go", "editor", "atom-editor", "go-to-definition"], "answers": [{"comments": [{"owner": {"reputation": 1362, "user_id": 5699570, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-fRpOyxCifSQ/AAAAAAAAAAI/AAAAAAAAAWA/NtmKw1pR05c/photo.jpg?sz=128", "display_name": "kien bui", "link": "https://stackoverflow.com/users/5699570/kien-bui"}, "edited": false, "score": 0, "creation_date": 1497923538, "post_id": 44603925, "comment_id": 76270819, "body": "But I see it is very slow."}, {"owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "reply_to_user": {"reputation": 1362, "user_id": 5699570, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-fRpOyxCifSQ/AAAAAAAAAAI/AAAAAAAAAWA/NtmKw1pR05c/photo.jpg?sz=128", "display_name": "kien bui", "link": "https://stackoverflow.com/users/5699570/kien-bui"}, "edited": false, "score": 0, "creation_date": 1497938324, "post_id": 44603925, "comment_id": 76274860, "body": "@kienbui afair it still doesn&#39;t support caching, so each <code>find usage</code> rescans tree, you might be interested in <a href=\"https://www.jetbrains.com/go/\" rel=\"nofollow noreferrer\">Intellij Gogland</a>, as all Intellij products it supports indexing, but I might be wrong"}], "tags": [], "owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "is_accepted": true, "score": 2, "last_activity_date": 1497698021, "creation_date": 1497698021, "answer_id": 44603925, "question_id": 44602985, "link": "https://stackoverflow.com/questions/44602985/list-function-callers-in-atom/44603925#44603925", "title": "List function callers in Atom", "body": "<p>You might be interested in <a href=\"https://atom.io/packages/go-plus\" rel=\"nofollow noreferrer\">go-plus</a> package.</p>\n\n<p>It has desired feature: <code>Find usages of an identifier using guru</code></p>\n\n<p>guru: a tool for answering questions about Go source code.</p>\n"}], "owner": {"reputation": 1362, "user_id": 5699570, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-fRpOyxCifSQ/AAAAAAAAAAI/AAAAAAAAAWA/NtmKw1pR05c/photo.jpg?sz=128", "display_name": "kien bui", "link": "https://stackoverflow.com/users/5699570/kien-bui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 725, "favorite_count": 1, "accepted_answer_id": 44603925, "answer_count": 1, "score": 2, "last_activity_date": 1497715410, "creation_date": 1497692115, "last_edit_date": 1497715410, "question_id": 44602985, "link": "https://stackoverflow.com/questions/44602985/list-function-callers-in-atom", "title": "List function callers in Atom", "body": "<p>I write Go code in Atom. I see a feature is go/jump to Definition function. But I want to view/show a list of callers to this function.</p>\n"}, {"tags": ["go", "covariance"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1497691803, "post_id": 44602741, "comment_id": 76193191, "body": "<a href=\"https://golang.org/ref/spec#Assignability\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Assignability</a> So that assignment simply does not fit the language standard assignability rules."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1497691865, "post_id": 44602741, "comment_id": 76193211, "body": "why: Because that&#39;s how type conversion works. And no, there is no better solution."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1497692401, "post_id": 44602741, "comment_id": 76193359, "body": "See <a href=\"https://golang.org/doc/faq#convert_slice_of_interface\" rel=\"nofollow noreferrer\">golang.org/doc/faq#convert_slice_of_interface</a>. Rule of thumb: Check Effective Go, the FAQ, the Tour of Go and the Language Spec. The answer will be there."}], "answers": [{"comments": [{"owner": {"reputation": 2480, "user_id": 383515, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2a049e5543453fcd9c9c75e2aceebe9c?s=128&d=identicon&r=PG", "display_name": "el_shayan", "link": "https://stackoverflow.com/users/383515/el-shayan"}, "edited": false, "score": 0, "creation_date": 1497691360, "post_id": 44602846, "comment_id": 76193060, "body": "Thanks but please see my edit in which I clarify the type of the question I&#39;m asking"}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 0, "last_activity_date": 1497691182, "creation_date": 1497691182, "answer_id": 44602846, "question_id": 44602741, "link": "https://stackoverflow.com/questions/44602741/why-cant-i-substitute-a-slice-of-one-type-for-another-in-go/44602846#44602846", "title": "Why can&#39;t I substitute a slice of one type for another in Go?", "body": "<p>You must convert arrays of interfaces in a loop:</p>\n\n<pre><code>var woofers []woofer\nfor _, w := range dogs {\n    woofers = append(woofers, w)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "is_accepted": false, "score": 2, "last_activity_date": 1497707640, "creation_date": 1497707640, "answer_id": 44605435, "question_id": 44602741, "link": "https://stackoverflow.com/questions/44602741/why-cant-i-substitute-a-slice-of-one-type-for-another-in-go/44605435#44605435", "title": "Why can&#39;t I substitute a slice of one type for another in Go?", "body": "<p>From <a href=\"https://golang.org/ref/spec#Type_identity\" rel=\"nofollow noreferrer\">Go reference</a></p>\n\n<blockquote>\n  <p>Two slice types are identical if they have identical element types.</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>Two interface types are identical if they have the same set of methods with the same names and identical function types(...).</p>\n</blockquote>\n\n<p>So <code>woofRunner</code> isn't identical to <code>woofer</code> and this leads us that <code>[]woofRunner</code> isn't identical to <code>[]woofer</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 2480, "user_id": 383515, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2a049e5543453fcd9c9c75e2aceebe9c?s=128&d=identicon&r=PG", "display_name": "el_shayan", "link": "https://stackoverflow.com/users/383515/el-shayan"}, "edited": false, "score": 0, "creation_date": 1497723617, "post_id": 44606795, "comment_id": 76202741, "body": "Wonderful answer. Thanks!"}], "tags": [], "owner": {"reputation": 14380, "user_id": 31818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3487ce6ed9ec277bac79a838537b46a8?s=128&d=identicon&r=PG", "display_name": "seh", "link": "https://stackoverflow.com/users/31818/seh"}, "is_accepted": true, "score": 4, "last_activity_date": 1497724837, "last_edit_date": 1497724837, "creation_date": 1497716633, "answer_id": 44606795, "question_id": 44602741, "link": "https://stackoverflow.com/questions/44602741/why-cant-i-substitute-a-slice-of-one-type-for-another-in-go/44606795#44606795", "title": "Why can&#39;t I substitute a slice of one type for another in Go?", "body": "<p>In addition to Go's refusal to convert slices along these variance relationships addressed in other answers here, it's useful to think through <em>why</em> Go refuses to do so, even when the in-memory representation would be the same between the two types.</p>\n\n<p>In your example, supplying a slice of <code>woofRunners</code>s as a parameter of type <code>[]woofer</code> is asking for <a href=\"https://en.wikipedia.org/wiki/Covariance_and_contravariance_(computer_science)#Arrays\" rel=\"nofollow noreferrer\"><em>covariant</em> treatment</a> of the slice's element type. When <strong>reading</strong> from the slice, indeed, since a <code>woofRunner</code> <em>is a</em> <code>woofer</code>, you know that every element present in a <code>[]woofRunner</code> will satisfy a reader looking for <code>[]woofer</code>. </p>\n\n<p>However, in Go, a slice is a reference type. When passing a slice as an argument to a function, the slice is copied, but the copy used in the invoked function body continues to refer to the same backing array (absent reallocation necessary before <code>append</code>ing beyond its capacity). The mutable view of an array\u2014more generally, inserting an item into a collection\u2014requires <em>contravariant</em> treatment of the element type. That is, when it comes to demanding a function parameter with the intention of <strong>inserting into</strong> or <strong>overwriting</strong> an element of type <code>woofRunner</code>, it's acceptable to supply a <code>[]woofer</code>.</p>\n\n<p>The question is whether the function is demanding the slice parameter for</p>\n\n<ul>\n<li>reading from it (for reading <code>woofer</code>s, a <code>[]woofRunner</code> is just as good as a <code>[]woofer</code>),</li>\n<li>writing to it (for writing <code>woofRunner</code>s, a <code>[]woofer</code> is just as good as a <code>[]woofRunner</code>),</li>\n<li>or both (neither is an acceptable substitute for the other).</li>\n</ul>\n\n<p>Consider what would happen if Go did accept slice parameters in covariant fashion, and someone came along and changed <code>allWoof</code> as follows:</p>\n\n<pre><code>// Another type satisfying `woofRunner`:\ntype wolf struct{}\nfunc (*wolf) run()  {}\nfunc (*wolf) woof() {}\n\nfunc allWoof(ws []woofer) {\n  if len(ws) &gt; 0 {\n    ws[0] = &amp;wolf{}\n  }\n}\n\ndogs := []*dog{&amp;dog{}, &amp;dog{}}\nallWoof(dogs)  // Doesn't compile, but what if it did?\n</code></pre>\n\n<p>Even if Go was willing to treat a <code>[]*dog</code> as a <code>[]woofer</code>, we would wind up with a <code>*wolf</code> in our array of <code>*dog</code> here. Some languages defend against such an accident with run-time type checks on the attempted array insertion or overwrite, but because Go precludes us from even making it this far, it doesn't need these additional checks.</p>\n"}], "owner": {"reputation": 2480, "user_id": 383515, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2a049e5543453fcd9c9c75e2aceebe9c?s=128&d=identicon&r=PG", "display_name": "el_shayan", "link": "https://stackoverflow.com/users/383515/el-shayan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 762, "favorite_count": 0, "accepted_answer_id": 44606795, "answer_count": 3, "score": 0, "last_activity_date": 1497724837, "creation_date": 1497690446, "last_edit_date": 1497721572, "question_id": 44602741, "link": "https://stackoverflow.com/questions/44602741/why-cant-i-substitute-a-slice-of-one-type-for-another-in-go", "title": "Why can&#39;t I substitute a slice of one type for another in Go?", "body": "<p>I'm trying to understand Go's type conversion rules. Say we have these interfaces:</p>\n\n<pre><code>type woofer interface {\n  woof()\n}\n\ntype runner interface {\n  run()\n}\n\ntype woofRunner interface {\n  woofer\n  runner\n}\n</code></pre>\n\n<p>and to satisfy the interfaces we have a <code>dog</code> type:</p>\n\n<pre><code>type dog struct{}\n\nfunc (*dog) run()  {}\nfunc (*dog) woof() {}\n</code></pre>\n\n<p>These two functions are using the interfaces:</p>\n\n<pre><code>func allWoof(ws []woofer) {}\n\nfunc oneWoof(w woofer) {}\n</code></pre>\n\n<p>To use these methods I can write the following:</p>\n\n<pre><code>dogs := make([]woofRunner, 10)\noneWoof(dogs[0])\nallWoof(dogs)\n</code></pre>\n\n<p>The first function <code>oneWoof()</code> works as expected; a <code>*dog</code> implements all <code>oneWoof</code> needs, which is a <code>woof</code> function. </p>\n\n<p>However for the second function <code>allWoof</code>, Go won't compile the attempted invocation, reporting the following:</p>\n\n<blockquote>\n  <p>cannot use dogs (type []woofRunner) as type []woofer in argument to allWoof</p>\n</blockquote>\n\n<p>Using a type conversion is also impossible; writing <code>[]woofer(dogs)</code> fails as well:</p>\n\n<blockquote>\n  <p>cannot convert dogs (type []woofRunner) to type []woofer</p>\n</blockquote>\n\n<p>Every member of <code>[]woofRunner</code> has all the necessary functions to satisfy a <code>[]woofer</code>, so why is this conversion prohibited?</p>\n\n<p>(I'm not sure if this is the same case explained in the Go <a href=\"https://golang.org/doc/faq#convert_slice_of_interface\" rel=\"nofollow noreferrer\">FAQ</a> and in various questions on Stack Overflow in which people ask about converting type <code>T</code> to <code>interface{}</code>. Every pointer in the slice/array is pointing to a type that is directly convertible to another type. Using these pointers should be possible for the same reason that passing <code>dog[0]</code> to 'oneWoof` is possible.)</p>\n\n<p><strong>Note 1</strong>: I know one solution is to loop over and and convert the items one by one. My question here is why that's necessary and whether there is a better solution.</p>\n\n<p><strong>Note 2</strong>: Regarding the rules of <a href=\"https://golang.org/ref/spec#Assignability\" rel=\"nofollow noreferrer\">Assignability</a>:</p>\n\n<blockquote>\n  <p>A value x is assignable to a variable of type T [when] T is an interface type and x implements T.</p>\n</blockquote>\n\n<p>Can't we say if the type of the slice/array is assignable to another type, then arrays of those types are also assignable?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 971, "user_id": 1140971, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d930c386a13cd2a6e007eacc709ea16a?s=128&d=identicon&r=PG", "display_name": "mlidal", "link": "https://stackoverflow.com/users/1140971/mlidal"}, "edited": false, "score": 0, "creation_date": 1497689566, "post_id": 44602568, "comment_id": 76192579, "body": "see <a href=\"https://stackoverflow.com/a/13247979/1140971\">stackoverflow.com/a/13247979/1140971</a>"}, {"owner": {"reputation": 887, "user_id": 8099995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WLnoV.png?s=128&g=1", "display_name": "berserkk", "link": "https://stackoverflow.com/users/8099995/berserkk"}, "edited": false, "score": 3, "creation_date": 1497690770, "post_id": 44602568, "comment_id": 76192886, "body": "<a href=\"https://play.golang.org/p/eZFdOkRM17\" rel=\"nofollow noreferrer\">play.golang.org/p/eZFdOkRM17</a>"}, {"owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "edited": false, "score": 0, "creation_date": 1497690802, "post_id": 44602568, "comment_id": 76192895, "body": "wow, exactly!!!!"}], "answers": [{"comments": [{"owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "edited": false, "score": 0, "creation_date": 1497693374, "post_id": 44602970, "comment_id": 76193628, "body": "Very very helpful response. Thank you sir!"}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 4, "last_activity_date": 1497692035, "creation_date": 1497692035, "answer_id": 44602970, "question_id": 44602568, "link": "https://stackoverflow.com/questions/44602568/is-there-a-go-equivalent-of-phps-tostring-method/44602970#44602970", "title": "Is there a Go equivalent of PHP&#39;s __toString method?", "body": "<p>I think you're looking for the <a href=\"https://golang.org/pkg/fmt/#Stringer\" rel=\"nofollow noreferrer\">Stringer</a> interface.</p>\n\n<pre><code>type Stringer interface {\n    String() string\n}\n</code></pre>\n\n<p>Any type that implements this interface will be automatically stringified using it by many different libraries, obviously including the <code>fmt</code> package, and will indeed work in your example of <code>fmt.Println</code>.</p>\n"}], "owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 1, "accepted_answer_id": 44602970, "answer_count": 1, "score": 1, "last_activity_date": 1497692035, "creation_date": 1497689361, "last_edit_date": 1497691927, "question_id": 44602568, "link": "https://stackoverflow.com/questions/44602568/is-there-a-go-equivalent-of-phps-tostring-method", "title": "Is there a Go equivalent of PHP&#39;s __toString method?", "body": "<p>In php exists a <code>__toString()</code> method that allow to make a taylored representation of an object. For example:</p>\n\n<pre><code>final class Foo\n{\n    public function __toString()\n    {\n        return \"custom representation\";\n    }\n}\n\n$foo = new Foo();\necho $foo; // this will output \"custom representation\"\n</code></pre>\n\n<p>In Go it is possible to create a struct:</p>\n\n<pre><code>type Person struct {\n    surname string\n    name    string\n}\n\nsensorario := Person{\n    \"Senso\",\n    \"Rario\",\n}\n\nfmt.Println(sensorario) // this will output \"{Senso Rario}\"\n</code></pre>\n\n<p>It is possible to add a toString method to the struct?</p>\n\n<hr>\n\n<p>EDIT:</p>\n\n<p>I've found this solution:</p>\n\n<pre><code>func (p *Person) toString() string {\n    return p.surname + \" \" + p.name\n}\n\nfmt.Println(simone.toString())\n</code></pre>\n\n<p>But what I am looking for, is the way to replace</p>\n\n<pre><code>fmt.Println(simone.toString())\n</code></pre>\n\n<p>with</p>\n\n<pre><code>fmt.Println(simone)\n</code></pre>\n"}, {"tags": ["go", "crystal-lang"], "comments": [{"owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "edited": false, "score": 0, "creation_date": 1497685196, "post_id": 44601987, "comment_id": 76191613, "body": "What is the directory where you&#39;re executing <code>crystal init app fizzbuzz</code> ? use <code>pwd</code> command in the terminal, please."}, {"owner": {"reputation": 21, "user_id": 7697744, "user_type": "registered", "profile_image": "https://graph.facebook.com/829183940541740/picture?type=large", "display_name": "Redy", "link": "https://stackoverflow.com/users/7697744/redy"}, "reply_to_user": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "edited": false, "score": 0, "creation_date": 1497686142, "post_id": 44601987, "comment_id": 76191827, "body": "pwd --&gt; /usr/local/bin"}, {"owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "edited": false, "score": 3, "creation_date": 1497686803, "post_id": 44601987, "comment_id": 76191989, "body": "It&#39;s quite strange that it creates file not in the current directory, it should create project by default in the same directory where command is executed.  you can specify directory with a param <code>crystal init app fizzbuzz &#47;usr&#47;local&#47;bin&#47;crystal</code>"}, {"owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "edited": false, "score": 0, "creation_date": 1497686856, "post_id": 44601987, "comment_id": 76192006, "body": "by the way <code>crystal init app fizzbuzz</code> will create project with the standard directory structure., not just one file."}], "owner": {"reputation": 21, "user_id": 7697744, "user_type": "registered", "profile_image": "https://graph.facebook.com/829183940541740/picture?type=large", "display_name": "Redy", "link": "https://stackoverflow.com/users/7697744/redy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1497686025, "creation_date": 1497684836, "last_edit_date": 1497686025, "question_id": 44601987, "link": "https://stackoverflow.com/questions/44601987/crystal-app-initialized-in-gopath-directory", "title": "Crystal App Initialized in $GOPATH Directory", "body": "<p>I have both Go and Crystal installed on macOS.</p>\n\n<p>GOPATH Directory: <b>export PATH=$PATH:/usr/local/go/bin</b></p>\n\n<p>Crystal Location: <b>/usr/local/bin/crystal</b></p>\n\n<p>When I initialize a crystal app with <b>crystal init app fizzbuzz </b> (example) in the terminal, the fizzbuzz.cr is located in <b> /usr/local/go/bin/fizzbuzz</b>.</p>\n\n<p>How can I ensure it initializes in <b>/usr/local/bin/crystal</b> instead?</p>\n"}, {"tags": ["go", "prometheus"], "answers": [{"tags": [], "owner": {"reputation": 1099, "user_id": 2213795, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/5409f467d86d77fab3f97eecac7ca4c7?s=128&d=identicon&r=PG", "display_name": "Digant C Kasundra", "link": "https://stackoverflow.com/users/2213795/digant-c-kasundra"}, "is_accepted": false, "score": 1, "last_activity_date": 1498365322, "creation_date": 1498365322, "answer_id": 44743220, "question_id": 44601971, "link": "https://stackoverflow.com/questions/44601971/prometheus-alertmanager-order-of-handling/44743220#44743220", "title": "Prometheus alertmanager order of handling", "body": "<p>I'm new as well so I can only go off of my understand, which is that in your scenario, the 2nd receiver will receive the alert because <code>continue</code> is <code>false</code> by default.</p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 8026626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa746c65276b2ee73471b8dd27aef652?s=128&d=identicon&r=PG&f=1", "display_name": "WombledMaize", "link": "https://stackoverflow.com/users/8026626/wombledmaize"}, "is_accepted": true, "score": 2, "last_activity_date": 1499434954, "creation_date": 1499434954, "answer_id": 44972334, "question_id": 44601971, "link": "https://stackoverflow.com/questions/44601971/prometheus-alertmanager-order-of-handling/44972334#44972334", "title": "Prometheus alertmanager order of handling", "body": "<p>I found an solution with some help of the developers at GitHub. </p>\n\n<p>You may see the processing of the config in the following way, similar to an if statement with AND and OR declarations. </p>\n\n<p>Alertmanager applies the config to a up-down, left-right principle. Where the up-down is similar to the OR statement you will use in a regular if statement. </p>\n\n<p>When you're going from left to right, you could compare it with the AND statement in if commands.</p>\n\n<p>Further you should keep in mind that when the first statement matches, and there are no 'AND' parts declared, alertmanager pushes the alert to the receiver without looking further for any other match. So in the example above, if prometheus fires an alert with the following labels {severity: \"warning\", application: \"barfoo\"}, the alert is sent to hipchat-teamX.</p>\n\n<p>Note the following, the label value of application matches the route for hipchat-teamY. So why it isn't sent to that route? The answer is not that diffucult, it's because the first one matches, and there are no subroutes declared, so it will stop looking for any other match. </p>\n\n<p>However, if the alertmanager has config like the code below, the alert will be sent to the receiver 'hipchat-teamY'.</p>\n\n<pre><code>routes:\n\nmatch:\n  severity:\"warning\"\nreceiver: \"hipchat-teamX\"\n\n  routes:\n  match_re:\n    application:\"(barfoo.*)\"\n  receiver: \"hipchat-teamY\"\n\nmatch_re:\n  application:\"(foo|bar)\"\nreceiver: \"hipchat-teamX\"\n\nmatch_re:\n  application:\"(barfoo.*)\"\nreceiver: \"hipchat-teamY\"\n</code></pre>\n\n<p>To make it a bit more advanced, asume prometheus sends a new alert with the following labels {severity: \"critical\", application: \"barfoo\"}. With the following config, the alert is routed to hipchat-teamX.</p>\n\n<p>And with the labels {severity: \"critical\", application: \"foo\"}, the alert is sent to hipchat-teamY.</p>\n\n<pre><code>routes:\n\nmatch:\n  severity:\"warning\"\nreceiver: \"hipchat-teamX\"\n\n  routes:\n  match_re:\n    application:\"(barfoo.*)\"\n  receiver: \"hipchat-teamY\"\n\n  match_re:\n    application:\"(foo|bar)\"\n  receiver: \"hipchat-teamX\"\n\nmatch:\n  severity:\"critical\"\nreceiver: \"hipchat-teamY\"\n\n  routes: \n  match_re:\n    application:\"(barfoo.*)\"\n  receiver: \"hipchat-teamX\"\n\n  match_re:\n    application:\"(foo|bar)\"\n  receiver: \"hipchat-teamY\"\n</code></pre>\n\n<p>I hope this explanation will help others who are experiencing the same issue or question.</p>\n"}], "owner": {"reputation": 61, "user_id": 8026626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa746c65276b2ee73471b8dd27aef652?s=128&d=identicon&r=PG&f=1", "display_name": "WombledMaize", "link": "https://stackoverflow.com/users/8026626/wombledmaize"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3650, "favorite_count": 0, "accepted_answer_id": 44972334, "answer_count": 2, "score": 4, "last_activity_date": 1499434954, "creation_date": 1497684696, "last_edit_date": 1498381889, "question_id": 44601971, "link": "https://stackoverflow.com/questions/44601971/prometheus-alertmanager-order-of-handling", "title": "Prometheus alertmanager order of handling", "body": "<p>I'm currently redesigning an existing alert configuration of alert manager. There's only a small issue, I don't understand alert manager fully. </p>\n\n<p>Assume I have the following configuration;</p>\n\n<pre><code>routes:\n\nmatch:\n  severity:\"warning\"\nreceiver: \"hipchat-teamX\"\n\nmatch_re:\n  application:\"(foo|bar)\"\nreceiver: \"hipchat-teamX\"\n\nmatch_re:\n  application:\"(barfoo.*)\"\nreceiver: \"hipchat-teamY\"\n</code></pre>\n\n<p>Then an alert is firing from Prometheus with the following values, application:\"barfooOne\"\nseverity:\"warning\"</p>\n\n<p>To which receiver will the alert send? And why? </p>\n\n<p>Does alert manager handle an up down structure? </p>\n\n<p>And when do you decide to declare a new child of the route (routes)?</p>\n"}, {"tags": ["multithreading", "go", "parallel-processing", "slice"], "comments": [{"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 1, "creation_date": 1497682124, "post_id": 44601563, "comment_id": 76190955, "body": "Please list the errors you are getting along with the a <a href=\"https://stackoverflow.com/help/how-to-ask\">minimal, complete verifiable example</a> to explain your problem."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 0, "creation_date": 1497682374, "post_id": 44601563, "comment_id": 76191025, "body": "You can use buffered channel <code>jobs := make(chan string, 100)</code> instead of blocked channel <code>jobs := make(chan string)</code>. Also update the <code>defer</code> for waitgroup as mentioned by @abhink."}, {"owner": {"reputation": 1, "user_id": 5511663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e3da8ce3ff3367c4d421de04cf6c43a?s=128&d=identicon&r=PG&f=1", "display_name": "Alkha", "link": "https://stackoverflow.com/users/5511663/alkha"}, "reply_to_user": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 0, "creation_date": 1497682940, "post_id": 44601563, "comment_id": 76191157, "body": "@abhink oh ok,, sorry. i will update my question."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5511663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e3da8ce3ff3367c4d421de04cf6c43a?s=128&d=identicon&r=PG&f=1", "display_name": "Alkha", "link": "https://stackoverflow.com/users/5511663/alkha"}, "edited": false, "score": 0, "creation_date": 1497683619, "post_id": 44601651, "comment_id": 76191287, "body": "Hi @abhink, I tried to put it on my code but i have another problem. the the process stopped after x thread.      $ go run test.go <a href=\"http://localhost/\" rel=\"nofollow noreferrer\">localhost</a> word.txt 10     <a href=\"http://localhost/2\" rel=\"nofollow noreferrer\">localhost/2</a> - 404     <a href=\"http://localhost/7\" rel=\"nofollow noreferrer\">localhost/7</a> - 404     <a href=\"http://localhost/3\" rel=\"nofollow noreferrer\">localhost/3</a> - 404     <a href=\"http://localhost/4\" rel=\"nofollow noreferrer\">localhost/4</a> - 404     <a href=\"http://localhost/5\" rel=\"nofollow noreferrer\">localhost/5</a> - 404     <a href=\"http://localhost/6\" rel=\"nofollow noreferrer\">localhost/6</a> - 404     <a href=\"http://localhost/\" rel=\"nofollow noreferrer\">localhost</a> - 200     <a href=\"http://localhost/8\" rel=\"nofollow noreferrer\">localhost/8</a> - 404     <a href=\"http://localhost/9\" rel=\"nofollow noreferrer\">localhost/9</a> - 404     Timer: 3.734229ms"}, {"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "reply_to_user": {"reputation": 1, "user_id": 5511663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e3da8ce3ff3367c4d421de04cf6c43a?s=128&d=identicon&r=PG&f=1", "display_name": "Alkha", "link": "https://stackoverflow.com/users/5511663/alkha"}, "edited": false, "score": 0, "creation_date": 1497684256, "post_id": 44601651, "comment_id": 76191431, "body": "Try closing he <code>jobs</code> channel."}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 1, "last_activity_date": 1497684231, "last_edit_date": 1497684231, "creation_date": 1497681965, "answer_id": 44601651, "question_id": 44601563, "link": "https://stackoverflow.com/questions/44601563/parallelism-from-slices/44601651#44601651", "title": "Parallelism From Slices", "body": "<p>You are not using the waitgroup correctly. The <code>defer</code>'s in <code>main</code>'s for loop are never called since <code>main</code> never returns and as a result, <code>wg.Wait()</code> call never unblocks.</p>\n\n<p>Put <code>defer</code> calls in the goroutine sending the message:</p>\n\n<pre><code>// ...\nfor i := 0; i &lt; thread; i++ {\n    wg.Add(1)\n\n    for _, word := range wordlist {\n        go func(word string) {\n            defer wg.Done()\n            jobs &lt;- word\n        }(word)\n    }\n}\n// ...\n</code></pre>\n\n<p>Also close the <code>jobs</code> channel:</p>\n\n<pre><code>// ...\nwg.Wait()\nclose(jobs)\n// ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "is_accepted": false, "score": 0, "last_activity_date": 1497685028, "creation_date": 1497685028, "answer_id": 44602011, "question_id": 44601563, "link": "https://stackoverflow.com/questions/44601563/parallelism-from-slices/44602011#44602011", "title": "Parallelism From Slices", "body": "<p>You should create new goroutine per new job, not per new job added</p>\n\n<p>Here you're creating a log of goroutines to push only 1 word to channel. This is an overkill for such a simple operation.</p>\n\n<pre><code>    for _, word := range wordlist {\n        go func(word string) {\n            jobs &lt;- word\n        }(word)\n    }\n</code></pre>\n\n<p>But job with fetching url is more heavier, but start only 1 goroutine for this.</p>\n\n<pre><code>go func() {\n    for job := range jobs {\n        code := visit(target + job)\n        fmt.Println(target + job + \" - \" + strconv.Itoa(code))\n    }\n}()\n</code></pre>\n\n<p>As @abhink has mentioned you're not using <code>WaitGroup</code> correctly. Do <code>wg.Add(1)</code> before creating each goroutine and do <code>wg.Done()</code> at the end of each goroutine. And of course <code>wg.Wait()</code> to wait all running goroutines to finish. Example:</p>\n\n<pre><code>var wg sync.WaitGroup\n\nwg.Add(1)   \ngo func(param){\n    defer wg.Done()\n    //...\n}(url)\n\n//...\n\nwg.Wait()\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5511663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e3da8ce3ff3367c4d421de04cf6c43a?s=128&d=identicon&r=PG&f=1", "display_name": "Alkha", "link": "https://stackoverflow.com/users/5511663/alkha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1497715494, "creation_date": 1497681214, "last_edit_date": 1497715494, "question_id": 44601563, "link": "https://stackoverflow.com/questions/44601563/parallelism-from-slices", "title": "Parallelism From Slices", "body": "<p>I want to make it run parallel based on number of thread. But the result was not as i expected. I dont know how to make it efficient and fast.</p>\n\n<p>I ended up with this code.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"os\"\n    \"runtime\"\n    \"strconv\"\n    \"strings\"\n    \"sync\"\n    \"time\"\n)\n\nfunc main() {\n    start := time.Now()\n    target := os.Args[1]\n    thread, _ := strconv.Atoi(os.Args[3])\n    file, err := ioutil.ReadFile(os.Args[2])\n    if err != nil {\n        fmt.Println(\"Error: Please double check if the file \" + os.Args[2] + \" is exist!\")\n        os.Exit(0)\n    }\n    wordlist := strings.Split(string(file), \"\\n\")\n\n    var wg sync.WaitGroup\n    runtime.GOMAXPROCS(runtime.NumCPU())\n    jobs := make(chan string)\n    for i := 0; i &lt; thread; i++ {\n        wg.Add(1)\n        defer wg.Done()\n        for _, word := range wordlist {\n            go func(word string) {\n                jobs &lt;- word\n            }(word)\n        }\n    }\n\n    go func() {\n        for job := range jobs {\n            code := visit(target + job)\n            fmt.Println(target + job + \" - \" + strconv.Itoa(code))\n        }\n    }()\n    wg.Wait()\n\n    elapsed := time.Since(start)\n    fmt.Printf(\"Timer: %s\\n\", elapsed)\n}\n\nfunc visit(url string) int {\n    data, err := http.Get(url)\n    if err != nil {\n        panic(err)\n    }\n    return data.StatusCode\n}\n</code></pre>\n\n<p>Any help would be appreciated. Thank you.</p>\n\n<p><strong>Update</strong>\nThis is my current results :</p>\n\n<pre><code>$ go run test.go http://localhost/ word.txt 2\nhttp://localhost/1 - 404\nhttp://localhost/1 - 404\nhttp://localhost/7 - 404\nhttp://localhost/8 - 404\nhttp://localhost/9 - 404\nhttp://localhost/0 - 404\nhttp://localhost/ - 200\nhttp://localhost/3 - 404\nhttp://localhost/2 - 404\nhttp://localhost/4 - 404\nhttp://localhost/6 - 404\nhttp://localhost/2 - 404\nhttp://localhost/3 - 404\nhttp://localhost/4 - 404\nhttp://localhost/5 - 404\nhttp://localhost/9 - 404\nhttp://localhost/7 - 404\nhttp://localhost/8 - 404\nhttp://localhost/0 - 404\nhttp://localhost/5 - 404\nhttp://localhost/ - 200\nhttp://localhost/6 - 404\n</code></pre>\n"}, {"tags": ["go", "go-gin"], "comments": [{"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 1, "creation_date": 1497671873, "post_id": 44600570, "comment_id": 76189106, "body": "Does <code>session.Get(&quot;email&quot;)</code> returns <code>interface{}</code> type? If yes then do type assertion for email parameter like this <code>e._GetUserId(email.(string))</code>."}, {"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497671931, "post_id": 44600570, "comment_id": 76189113, "body": "@jeevatkm If that&#39;s the issue, wouldn&#39;t the error message say &quot;cannot convert ... to type <b>string</b>&quot;?"}, {"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1497671968, "post_id": 44600570, "comment_id": 76189119, "body": "I don&#39;t think the error message matches up with this code... nowhere that I can see is something called <code>email</code> used where an <code>Env</code> should be."}, {"owner": {"reputation": 2054, "user_id": 615120, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/xoAHa.jpg?s=128&g=1", "display_name": "rnk", "link": "https://stackoverflow.com/users/615120/rnk"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 1, "creation_date": 1497671982, "post_id": 44600570, "comment_id": 76189123, "body": "@jeevatkm Wow that works! But when I check it with reflect.Typeof(session.Get(&quot;email&quot;)). It says string value. Why it takes as interface{} in the function argument?"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497672599, "post_id": 44600570, "comment_id": 76189212, "body": "@rnk You&#39;re welcome. <code>reflect.Typeof</code> method accepts any type that&#39;s why parameter is <code>interface{}</code> returns the actual type of the value.  I will post an answer so you can accept it."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1497672632, "post_id": 44600570, "comment_id": 76189215, "body": "@smarx you&#39;re correct, error doesn&#39;t match with code. I went through provided code and took assumption based on the code and asked a clarification."}], "answers": [{"tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 6, "last_activity_date": 1497672807, "creation_date": 1497672807, "answer_id": 44600685, "question_id": 44600570, "link": "https://stackoverflow.com/questions/44600570/need-type-assertion-on-functions/44600685#44600685", "title": "Need type assertion on functions", "body": "<p>Drafting answer based on conversation from my comments.</p>\n\n<p>Method <code>session.Get(\"email\")</code> returns <code>interface{}</code> type.</p>\n\n<p>And method <code>e._GetUserId()</code> accepts string parameter, so you need to do type assertion as <code>string</code> like -</p>\n\n<pre><code>e._GetUserId(email.(string))\n</code></pre>\n"}], "owner": {"reputation": 2054, "user_id": 615120, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/xoAHa.jpg?s=128&g=1", "display_name": "rnk", "link": "https://stackoverflow.com/users/615120/rnk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5119, "favorite_count": 0, "accepted_answer_id": 44600685, "answer_count": 1, "score": 2, "last_activity_date": 1497672807, "creation_date": 1497671439, "question_id": 44600570, "link": "https://stackoverflow.com/questions/44600570/need-type-assertion-on-functions", "title": "Need type assertion on functions", "body": "<p>I'm trying to learn type assertion and conversion. It's kinda complicated for me.</p>\n\n<p>I have this example: (I'm using gin framework)</p>\n\n<pre><code>type Env struct {\n    db *sql.DB\n}\n\nfunc main() {\n    r := gin.Default()\n\n    // Initiate session management (cookie-based)\n    store := sessions.NewCookieStore([]byte(\"secret\"))\n    r.Use(sessions.Sessions(\"mysession\", store))\n\n    db, _ := sql.Open(\"sqlite3\", \"./libreread.db\")\n    defer db.Close()\n\n    env := &amp;Env{db: db}\n    r.GET(\"/\", env.GetHomePage)\n}\n\nfunc (e *Env) _GetUserId(email string) int64 {\n    rows, err := e.db.Query(\"SELECT `id` FROM `user` WHERE `email` = ?\", email)\n    CheckError(err)\n\n    var userId int64\n    if rows.Next() {\n        err := rows.Scan(&amp;userId)\n        CheckError(err)\n    }\n    rows.Close()\n\n    return userId\n}\n\nfunc (e *Env) GetHomePage(c *gin.Context) {\n\n    session := sessions.Default(c)\n    email := session.Get(\"email\")\n\n    if email != nil {\n        name := c.Param(\"bookname\")\n        userId := e._GetUserId(email) // I'm stuck here.\n}\n</code></pre>\n\n<p>So, in the above code.. I'm setting db Env type and passing it to router functions. From there, I need to call another function. How to do that?</p>\n\n<p>When I call e._GetUserId(email), it says</p>\n\n<pre><code>cannot convert email (type interface {}) to type Env: need type assertion\n</code></pre>\n\n<p>How to solve this problem?. Do I need to use inferface{} instead of struct for Env type?</p>\n"}, {"tags": ["shell", "unix", "go", "logging"], "comments": [{"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 2, "creation_date": 1497657057, "post_id": 44599345, "comment_id": 76186924, "body": "If golang program writes an error info into <code>os.Stderr</code> then you can capture it in shell script."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 1, "creation_date": 1497663449, "post_id": 44599345, "comment_id": 76188034, "body": "If you don&#39;t redirect the output to <code>&#47;dev&#47;null</code> when calling <code>nohup</code>, a <code>nohup.out</code> file will be created in the working directory. This file stores the script output. Otherwise, see <a href=\"https://askubuntu.com/questions/676664/where-can-i-get-nohup-out-if-script-starts-at-startup\">https://askubuntu.com/questions/676664/where-can-i-get-nohup&zwnj;&#8203;-out-if-script-start&zwnj;&#8203;s-at-startup</a>."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497664039, "post_id": 44599345, "comment_id": 76188102, "body": "Probably I misunderstood your question. Please provide more detail, or show us the shell script in question and how exactly did you execute <code>nohup</code>?."}, {"owner": {"reputation": 11, "user_id": 8094036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30b22d87a9b8dea87c89cf9d26230242?s=128&d=identicon&r=PG&f=1", "display_name": "Cassidy", "link": "https://stackoverflow.com/users/8094036/cassidy"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497825922, "post_id": 44599345, "comment_id": 76226261, "body": "@jeevatkm Currently Im using log to write messages to a log file. Is there a way to write to os.Stderr using log? Thank you."}, {"owner": {"reputation": 11, "user_id": 8094036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30b22d87a9b8dea87c89cf9d26230242?s=128&d=identicon&r=PG&f=1", "display_name": "Cassidy", "link": "https://stackoverflow.com/users/8094036/cassidy"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497826260, "post_id": 44599345, "comment_id": 76226352, "body": "@putu Apologies for the confusion. I meant to write without nohup."}, {"owner": {"reputation": 11, "user_id": 8094036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30b22d87a9b8dea87c89cf9d26230242?s=128&d=identicon&r=PG&f=1", "display_name": "Cassidy", "link": "https://stackoverflow.com/users/8094036/cassidy"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497826698, "post_id": 44599345, "comment_id": 76226455, "body": "@putu Here is how Im calling :- #! /bin/bash  moveToS3() {   move -i abd-123 -f filename exit $?  }  move  ----------------- I want to echo the error messages instead of direct exit."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497851703, "post_id": 44599345, "comment_id": 76231886, "body": "@Cassidy Yes, if you&#39;re Go std logger, by default log messages goes to <code>os.Stderr</code>."}, {"owner": {"reputation": 410, "user_id": 997132, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6prH5.jpg?s=128&g=1", "display_name": "William", "link": "https://stackoverflow.com/users/997132/william"}, "edited": false, "score": 0, "creation_date": 1527089353, "post_id": 44599345, "comment_id": 87997330, "body": "Can you confirm that calling the go executable from the command line works and prints or logs an error message before attempting to run it in a bash script? Can you link us to your source code used to produce the move executable? Further, you showed an -i and a -f flag. What does the -i flag do?"}], "owner": {"reputation": 11, "user_id": 8094036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30b22d87a9b8dea87c89cf9d26230242?s=128&d=identicon&r=PG&f=1", "display_name": "Cassidy", "link": "https://stackoverflow.com/users/8094036/cassidy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527086905, "creation_date": 1497656505, "last_edit_date": 1527086905, "question_id": 44599345, "link": "https://stackoverflow.com/questions/44599345/getting-back-error-messages-from-golang-executable-into-shell-script", "title": "Getting back error messages from Golang executable into shell script", "body": "<p>I am new to programming. </p>\n\n<p>I have a golang package for moving files to s3. I'm calling it from a unix shell script (without\n nohup). Is there a way to send error messages from go code to shell script?</p>\n"}, {"tags": ["go", "error-handling", "operating-system"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497645745, "post_id": 44597543, "comment_id": 76183681, "body": "Just like the docs say, a non-zero exit returns an <code>*exec.ExitError</code>. Have you tried this, and what problem are you having?"}], "answers": [{"tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": false, "score": 1, "last_activity_date": 1497646046, "creation_date": 1497646046, "answer_id": 44597759, "question_id": 44597543, "link": "https://stackoverflow.com/questions/44597543/golang-kill-an-os-process-with-exec-exiterror/44597759#44597759", "title": "Golang: Kill an os.Process with exec.ExitError", "body": "<p><code>Kill()</code> is the same as calling <code>kill -9</code> on the process, it sends a <code>SIGKILL</code>, which cannot be caught.  As with all non-zero exit codes, <code>Wait()</code> will then return an <code>ExitError</code>.</p>\n\n<p>You also have the option of using <code>Process.Signal()</code>, which alloww you to specify any signal you want (for example, <code>SIGINT</code> or <code>SIGTERM</code> instead).  Unfortunately, it doesn't look like the os.ExitError type allows you to retrieve the exit code itself as anything except the exit status string.  However, you can still use the presence or absence of that error type as indication of non-zero or zero exit status.</p>\n"}], "owner": {"reputation": 293, "user_id": 5225081, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/88eacba7df7f23affd7a197753f2696b?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/5225081/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1014, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1497646046, "creation_date": 1497645130, "question_id": 44597543, "link": "https://stackoverflow.com/questions/44597543/golang-kill-an-os-process-with-exec-exiterror", "title": "Golang: Kill an os.Process with exec.ExitError", "body": "<p>If I have a os.Exec object called \"myCmd\" and I call myCmd.Process.Kill(), what is the return code behavior of the process? Will it return a exec.ExitError? I want to forcefully kill the os.Exec process (i.eo kill -9), have it return a exec.ExitError or something that my goroutine can distinguish for a normal cmd exit with return code 0. </p>\n\n<p>What I have so far:</p>\n\n<pre><code>myCmd.Start()\n\nvar cmdWatcher = func(childCmd os.Cmd) {\n\n    err := childCmd.Wait()\n    if exitErr, k := err.(*exec.ExitError); k {\n        fmt.Print(\"ExitError detected\")\n    }\n    return \n}\n\ngo cmdWatcher(myCmd)\n\nmyCmd.Process.Kill()\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "edited": false, "score": 0, "creation_date": 1497644865, "post_id": 44597248, "comment_id": 76183255, "body": "Do you mean with something like a <code>log</code>?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1497645015, "post_id": 44597248, "comment_id": 76183319, "body": "Do you want to know when the listener has been created? what problem are you trying to solve? You can pass a listener directly to the server if you want with <a href=\"https://golang.org/pkg/net/http/#Server.Serve\" rel=\"nofollow noreferrer\"><code>Server.Serve</code></a>."}, {"owner": {"reputation": 7266, "user_id": 136928, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3b45a5cf8cd1ab3fabb3de8a80fbc1a7?s=128&d=identicon&r=PG", "display_name": "sjlee", "link": "https://stackoverflow.com/users/136928/sjlee"}, "edited": false, "score": 0, "creation_date": 1497645319, "post_id": 44597248, "comment_id": 76183498, "body": "I&#39;d like to be able to take certain action such as &quot;this http server is open for business&quot;. For example, one can imagine a scenario where you want to register this server to a registry so it becomes part of some service discovery once the server is up and actually accepting connections. Then clients could discover this instance and start sending traffic.  I doubt the listener creation is an answer, because it merely creates the listener instance but it isn&#39;t actually accepting connections at that point, right?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497646118, "post_id": 44597248, "comment_id": 76183836, "body": "@sjlee: well, once the listener is created the OS will accept connections into the syn queue, so they&#39;re not going to be rejected. Service discovery usually relies on other systems like health/port checks, so registering a service as it comes up isn&#39;t an issue."}, {"owner": {"reputation": 7266, "user_id": 136928, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3b45a5cf8cd1ab3fabb3de8a80fbc1a7?s=128&d=identicon&r=PG", "display_name": "sjlee", "link": "https://stackoverflow.com/users/136928/sjlee"}, "edited": false, "score": 1, "creation_date": 1497648156, "post_id": 44597248, "comment_id": 76184638, "body": "OK that&#39;s a fair point. Thanks for that. In general, I&#39;m still intrigued that there isn&#39;t a channel or a func that can be provided to be notified when the server comes up. It strikes me as a pretty useful functionality."}], "answers": [{"comments": [{"owner": {"reputation": 7266, "user_id": 136928, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3b45a5cf8cd1ab3fabb3de8a80fbc1a7?s=128&d=identicon&r=PG", "display_name": "sjlee", "link": "https://stackoverflow.com/users/136928/sjlee"}, "edited": false, "score": 1, "creation_date": 1497656034, "post_id": 44598343, "comment_id": 76186763, "body": "I&#39;ll accept the answer. Thanks! One note is that the listener route is more involved, especially for ListenAndServeTLS(). It appears you kind of end up replicating some http/Server code to have the same behavior. See <a href=\"https://github.com/golang/go/issues/14374\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/14374</a> and <a href=\"https://github.com/golang/go/commit/b5f0aff49503e31002b33198e06708e263c445a7\" rel=\"nofollow noreferrer\">github.com/golang/go/commit/&hellip;</a>."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 7, "last_activity_date": 1497654355, "last_edit_date": 1497654355, "creation_date": 1497648920, "answer_id": 44598343, "question_id": 44597248, "link": "https://stackoverflow.com/questions/44597248/get-notified-when-http-server-starts-listening/44598343#44598343", "title": "get notified when http.Server starts listening", "body": "<p>ListenAndServe is a helper function that opens a listening socket and then serves connections on that socket. Write the code directly in your application to signal when the socket is open:</p>\n\n<pre><code>l, err := net.Listen(\"tcp\", \":8080\")\nif err != nil {\n    // handle error\n}\n\n// Signal that server is open for business. \n\nif err := http.Serve(l, rootHandler); err != nil {\n    // handle error\n}\n</code></pre>\n\n<p>If the signalling step does not block, then http.Serve will easily consume any backlog on the listening socket.</p>\n\n<p>Related question: <a href=\"https://stackoverflow.com/a/32742904/5728991\">https://stackoverflow.com/a/32742904/5728991</a></p>\n"}], "owner": {"reputation": 7266, "user_id": 136928, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3b45a5cf8cd1ab3fabb3de8a80fbc1a7?s=128&d=identicon&r=PG", "display_name": "sjlee", "link": "https://stackoverflow.com/users/136928/sjlee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 695, "favorite_count": 0, "accepted_answer_id": 44598343, "answer_count": 1, "score": 5, "last_activity_date": 1497654355, "creation_date": 1497643906, "question_id": 44597248, "link": "https://stackoverflow.com/questions/44597248/get-notified-when-http-server-starts-listening", "title": "get notified when http.Server starts listening", "body": "<p>When I look at the net/http server interface, I don't see an obvious way to get notified and react when the http.Server comes up and <strong>starts</strong> listening:</p>\n\n<pre><code>ListenAndServe(\":8080\", nil)\n</code></pre>\n\n<p>The function doesn't return until the server actually shuts down. I also looked at the Server type, but there doesn't appear to be anything that lets me tap into that timing. Some function or a channel would have been great but I don't see any.</p>\n\n<p>Is there any way that will let me detect that event, or am I left to just sleeping \"enough\" to fake it?</p>\n"}, {"tags": ["json", "go", "struct", "marshalling"], "comments": [{"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497641141, "post_id": 44596373, "comment_id": 76181375, "body": "Yesterday you posted question about XML unmarshall issue of your RPC XML. I have analyzed and answered your question. You didn&#39;t accepted the answer, simply you replied &quot;Thanks, that&#39;s stupid of me&quot; and deleted the SO question. I suggest not to do that going forward, it is not good for the community."}, {"owner": {"reputation": 21, "user_id": 3391219, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/18e7648eafbc9037f6dd377930a9d61d?s=128&d=identicon&r=PG&f=1", "display_name": "Bazinga", "link": "https://stackoverflow.com/users/3391219/bazinga"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497641251, "post_id": 44596373, "comment_id": 76181436, "body": "@jeevatkm : that was definitely an unconscious error from my end. Its back now. Apologies!"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497641514, "post_id": 44596373, "comment_id": 76181577, "body": "Thanks, no issues. I just thought to bring it your attention. BTW I hope that answer solved your issue. Please accept the answer in SO."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497641541, "post_id": 44596373, "comment_id": 76181591, "body": "Is the quoted file <code>int2.go</code>? Which line is 156? The compiler error is telling you what&#39;s wrong, but without any context there&#39;s no way for anyone else to help you."}, {"owner": {"reputation": 21, "user_id": 3391219, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/18e7648eafbc9037f6dd377930a9d61d?s=128&d=identicon&r=PG&f=1", "display_name": "Bazinga", "link": "https://stackoverflow.com/users/3391219/bazinga"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497641760, "post_id": 44596373, "comment_id": 76181716, "body": "@Adrian updated!"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 3391219, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/18e7648eafbc9037f6dd377930a9d61d?s=128&d=identicon&r=PG&f=1", "display_name": "Bazinga", "link": "https://stackoverflow.com/users/3391219/bazinga"}, "edited": false, "score": 0, "creation_date": 1497642084, "post_id": 44596771, "comment_id": 76181884, "body": "That fixed the error, but the output is like this:  {A : [ {X: 1, Y:2 } ] } , {A : [ {X: 1, Y:2 } ] }, {A : [ {X: 1, Y:2 } ] }  I am trying to produce something like:  {A: {{X:1 ,Y: 2}, {X:2 ,Y: 2}, {X: 2,Y: 2}}}"}, {"owner": {"reputation": 21, "user_id": 3391219, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/18e7648eafbc9037f6dd377930a9d61d?s=128&d=identicon&r=PG&f=1", "display_name": "Bazinga", "link": "https://stackoverflow.com/users/3391219/bazinga"}, "edited": false, "score": 0, "creation_date": 1497642480, "post_id": 44596771, "comment_id": 76182077, "body": "should it be var bj []B ?"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 21, "user_id": 3391219, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/18e7648eafbc9037f6dd377930a9d61d?s=128&d=identicon&r=PG&f=1", "display_name": "Bazinga", "link": "https://stackoverflow.com/users/3391219/bazinga"}, "edited": false, "score": 0, "creation_date": 1497643700, "post_id": 44596771, "comment_id": 76182679, "body": "You&#39;re welcome, added golang play link for reference."}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 1, "last_activity_date": 1497643660, "last_edit_date": 1497643660, "creation_date": 1497641810, "answer_id": 44596771, "question_id": 44596373, "link": "https://stackoverflow.com/questions/44596373/golang-multiple-structs-marshall-issue-json-format/44596771#44596771", "title": "Golang: Multiple structs marshall issue: json format", "body": "<p>It seems you have problem at this line-</p>\n\n<pre><code>t := A{B_j: []B{X: name.text, Y: name.type }}\n</code></pre>\n\n<p>You're not creating a slice properly. Try following-</p>\n\n<pre><code>t := A{B_j: []B{{X: name.text, Y: name.type}}}\n</code></pre>\n\n<hr>\n\n<p>Let's do it better way-</p>\n\n<pre><code>var bj []B\nfor _, name := range t.name{\n  bj = append(bj, B{X: name.text,Y: name.type})\n}\n\nt := A{B_j: bj}\ns, _ := json.MarshalIndent(t,\"\", \" \")      \nos.Stdout.Write(s)\n</code></pre>\n\n<p>Sample program with static values <a href=\"https://play.golang.org/p/a2ZDV8lgWP\" rel=\"nofollow noreferrer\">https://play.golang.org/p/a2ZDV8lgWP</a></p>\n\n<p>Note: <code>type</code> is language keyword, do not use it as variable name.</p>\n"}], "owner": {"reputation": 21, "user_id": 3391219, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/18e7648eafbc9037f6dd377930a9d61d?s=128&d=identicon&r=PG&f=1", "display_name": "Bazinga", "link": "https://stackoverflow.com/users/3391219/bazinga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 499, "favorite_count": 0, "accepted_answer_id": 44596771, "answer_count": 1, "score": 0, "last_activity_date": 1497643778, "creation_date": 1497640150, "last_edit_date": 1497643778, "question_id": 44596373, "link": "https://stackoverflow.com/questions/44596373/golang-multiple-structs-marshall-issue-json-format", "title": "Golang: Multiple structs marshall issue: json format", "body": "<p>For the following code, I get the error:</p>\n\n<pre><code>type A struct{\n    B_j []B `json:\"A\"` \n}\ntype B struct\n{\n    X string\n    Y string\n\n}\n\nfunc main() {\n    xmlFile, _ := os.Open(\"test.xml\")\n\n    b, _ := ioutil.ReadAll(xmlFile)\n\n    var t root\n    err2 := xml.Unmarshal(b, &amp;rpc)\n    if err2 != nil {\n        fmt.Printf(\"error: %v\", err2)\n        return\n    }\n\n    for _, name := range t.name{\n        t := A{B_j : []B{X : name.text, Y: name.type }} // line:#25\n\n        s, _ := json.MarshalIndent(t,\"\", \" \")\n\n    os.Stdout.Write(s)\n        }\n}\n</code></pre>\n\n<hr>\n\n<pre><code># command-line-arguments\n./int2.go:25: undefined: X\n./int2.go:25: cannot use name.Text (type string) as type B in array or slice literal\n./int2.go:25: undefined: Y\n./int2.go:25: cannot use name.type (type string) as type B in array or slice literal\n</code></pre>\n\n<p>In my output, I am trying to achieve something like this:</p>\n\n<pre><code>{A: {{X:1 ,Y: 2}, {X:2 ,Y: 2}, {X: 2,Y: 2}}}\n</code></pre>\n\n<p>Struct calling another struct to get the pattern above.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1497637352, "post_id": 44595669, "comment_id": 76179387, "body": "With strings - no, but perhaps using stringB as a regex pattern?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1497637875, "post_id": 44595669, "comment_id": 76179671, "body": "No, but as always if you need to type it more than once you can put it in your own function."}, {"owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "edited": false, "score": 0, "creation_date": 1497637921, "post_id": 44595669, "comment_id": 76179695, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/24836044/case-insensitive-string-search-in-golang\">Case insensitive string search in golang</a>"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1497643451, "post_id": 44595669, "comment_id": 76182552, "body": "I would worry more about performance than elegance of the code, if you look at <code>strings.EqualsFold</code> you&#39;ll see that it doesn&#39;t just fold the strings and compare, which will allocate memory, it tries to do a case insensitive comparison in place."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2494770"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1497645137, "post_id": 44595669, "comment_id": 76183384, "body": "@Not_a_Golfer <code>string.EqualsFold</code> tests for equality, I need to test for substring"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1497730494, "post_id": 44595669, "comment_id": 76204780, "body": "@sreya I know, I just meant that it avoids copying strings and allocating memory, and what you are proposing does not."}], "answers": [{"comments": [{"owner": {"reputation": 774, "user_id": 6393636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a13a6bc94b135d28bb51aaa361c24a51?s=128&d=identicon&r=PG", "display_name": "Melardev", "link": "https://stackoverflow.com/users/6393636/melardev"}, "edited": false, "score": 1, "creation_date": 1595496974, "post_id": 44601360, "comment_id": 111497348, "body": "Great, but this is exactly what this article explains as not very performant, and he is right,  creating a copy each time is not a good idea. <a href=\"https://www.digitalocean.com/community/questions/how-to-efficiently-compare-strings-in-go\" rel=\"nofollow noreferrer\">digitalocean.com/community/questions/&hellip;</a>"}], "tags": [], "owner": {"reputation": 337, "user_id": 1920214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f138092492c317d91304aa0af579caf6?s=128&d=identicon&r=PG", "display_name": "payneio", "link": "https://stackoverflow.com/users/1920214/payneio"}, "is_accepted": false, "score": 7, "last_activity_date": 1592134531, "last_edit_date": 1592134531, "creation_date": 1497679448, "answer_id": 44601360, "question_id": 44595669, "link": "https://stackoverflow.com/questions/44595669/does-go-have-a-case-insensitive-string-contains-function/44601360#44601360", "title": "Does Go have a case-insensitive string contains() function?", "body": "<p>If it's just the wordiness that you dislike, then how about making your code formatting cleaner, e.g.:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    strings.Contains(\n        strings.ToLower(stringA),\n        strings.ToLower(stringB),\n    )\n</code></pre>\n\n<p>Or hiding it in a function in your own <code>utils</code> (or whatever) package:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    package utils\n\n    import \"strings\"\n\n    func ContainsI(a string, b string) bool {\n        return strings.Contains(\n            strings.ToLower(a),\n            strings.ToLower(b),\n        )\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 0, "last_activity_date": 1597182269, "creation_date": 1597182269, "answer_id": 63366795, "question_id": 44595669, "link": "https://stackoverflow.com/questions/44595669/does-go-have-a-case-insensitive-string-contains-function/63366795#63366795", "title": "Does Go have a case-insensitive string contains() function?", "body": "<p>Another option:</p>\n<pre><code>package main\nimport &quot;regexp&quot;\nfunc main() {\n   o := regexp.MustCompile(&quot;(?i)we&quot;)\n   b := o.MatchString(&quot;Wednesday&quot;)\n   println(b)\n}\n</code></pre>\n<p><a href=\"https://golang.org/pkg/regexp/syntax\" rel=\"nofollow noreferrer\">https://golang.org/pkg/regexp/syntax</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2494770"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6150, "favorite_count": 0, "answer_count": 2, "score": 12, "last_activity_date": 1597182269, "creation_date": 1497637206, "question_id": 44595669, "link": "https://stackoverflow.com/questions/44595669/does-go-have-a-case-insensitive-string-contains-function", "title": "Does Go have a case-insensitive string contains() function?", "body": "<p>I'd like to be able to determine whether stringB is a case-insensitive substring of stringA. Looking through Go's <code>strings</code> pkg, the closest I can get is <code>strings.Contains(strings.ToLower(stringA), strings.ToLower(stringB)</code>. Is there a less wordy alternative that I'm not seeing?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1497633977, "post_id": 44594682, "comment_id": 76177559, "body": "To expand, interfaces are <i>essentially</i> just struct which have no data fields, only methods, or at least you can think of them that way.  They can hold any type with implements the interface&#39;s methods, and the only thing you can do with that type is call those methods.  Calling those methods, however, is no different from calling methods on a struct."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 2, "last_activity_date": 1497633193, "creation_date": 1497633193, "answer_id": 44594682, "question_id": 44594659, "link": "https://stackoverflow.com/questions/44594659/what-is-the-difference-in-calling-an-interface-methods-and-struct-methods-in-ser/44594682#44594682", "title": "What is the difference in calling an interface methods and struct methods in serveHTTP handler?", "body": "<p>There's no difference. The interface is the type of your variable/field/parameter; the value is still (most likely) a struct. This is the same as in Java, where you can specify that a method argument is of an interface type, but you must still pass in a concretion. Calling methods on the interface-typed argument is the same as calling the method on a concrete type.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5906464"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 44594682, "answer_count": 1, "score": 1, "last_activity_date": 1497633193, "creation_date": 1497633093, "question_id": 44594659, "link": "https://stackoverflow.com/questions/44594659/what-is-the-difference-in-calling-an-interface-methods-and-struct-methods-in-ser", "title": "What is the difference in calling an interface methods and struct methods in serveHTTP handler?", "body": "<p>I'm moving from Java to go. In 'go', I got confused when using a Handler.</p>\n\n<p>For eg: <code>ServeHTTP(w http.ResponseWriter, req *http.Request)</code></p>\n\n<p>Here ResponseWriter is an interface and Request is a struct. We are using w as an object to call the methods in ResponseWriter interface. The same goes with req object. I know that a struct can implement an interface. Here I'm showing an example and where I'm getting confused. <a href=\"https://play.golang.org/p/aCtPXRbGer\" rel=\"nofollow noreferrer\">Go Playground Link</a></p>\n"}, {"tags": ["json", "go", "unmarshalling"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1497631815, "post_id": 44594289, "comment_id": 76176362, "body": "Pet is embedded, but it is not anonymous - it&#39;s named Pet."}], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 2, "creation_date": 1497634155, "post_id": 44594347, "comment_id": 76177655, "body": "Ideally, if you can control the program generating the JSON, just use the array annotation exclusively.  If the owner only has one pet, then the array only has a single entry, but it&#39;s still an array.  No reason to have two separate structures to convey the same information when they are not actually logically distinct situations."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1497634271, "post_id": 44594347, "comment_id": 76177719, "body": "Agreed. My assumption was that the incoming data was outside their control."}, {"owner": {"reputation": 1818, "user_id": 2171758, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/0pO0W.jpg?s=128&g=1", "display_name": "salient", "link": "https://stackoverflow.com/users/2171758/salient"}, "edited": false, "score": 0, "creation_date": 1497637458, "post_id": 44594347, "comment_id": 76179441, "body": "Agree fully, I was looking for a more general pattern to handle denormalized data that needs to be normalized before it goes into a database. The above pattern is elegant"}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 2, "last_activity_date": 1497631951, "creation_date": 1497631951, "answer_id": 44594347, "question_id": 44594289, "link": "https://stackoverflow.com/questions/44594289/unmarshall-both-flat-and-nested-jsons-in-golang/44594347#44594347", "title": "Unmarshall both flat and nested jsons in golang", "body": "<p>You're looking at two separate data structures, so to unmarshal them with a single <code>struct</code> type, you'd need to account for both:</p>\n\n<pre><code>type Owner struct {\n    Name string\n    Pet\n    Pets []Pet `json:\"Pet\"`\n}\n</code></pre>\n\n<p>Then, if you want the slice to be authoritative, after you unmarshall, move the embedded to the slice:</p>\n\n<pre><code>// owner := unmarshall blah blah\nif owner.Pet != Pet{} {\n    owner.Pets = append(owner.Pets, owner.Pet)\n}\n</code></pre>\n"}], "owner": {"reputation": 1818, "user_id": 2171758, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/0pO0W.jpg?s=128&g=1", "display_name": "salient", "link": "https://stackoverflow.com/users/2171758/salient"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 44594347, "answer_count": 1, "score": 1, "last_activity_date": 1497631951, "creation_date": 1497631770, "last_edit_date": 1497631826, "question_id": 44594289, "link": "https://stackoverflow.com/questions/44594289/unmarshall-both-flat-and-nested-jsons-in-golang", "title": "Unmarshall both flat and nested jsons in golang", "body": "<p>Say I want to be able to handle both nested and unnested <code>json</code>s of the following form, as in this example:</p>\n\n<pre><code>source_json_1 := `{\"owner\": \"John\", \"nickname\": \"Rose\", \"species\": \"Dog\"}`\nsource_json_2 := `{\"owner\": \"Doe\", \"Pet\": [{\"nickname\": \"Rose\", \"species\": \"Dog\"},\n                                          {\"nickname\": \"Max\", \"species\": \"Cat\"}]}`\n</code></pre>\n\n<p>If I define <code>Pet</code> as an embedded struct I can easily unmarshal it with:</p>\n\n<pre><code>type Owner struct {\n    Name string\n    Pet\n}\n\ntype Pet struct {\n    NickName    string\n    Species     string\n}\n</code></pre>\n\n<p>Resulting in John's pet getting adequately marshalled.</p>\n\n<pre><code>{John {Rose Dog}}\n{Doe { }}\n</code></pre>\n\n<p>But since <code>Pet</code> can actually also be a slice of <code>Pet</code>s, Doe's <code>Pet</code>s are not correctly unmarshalled. If instead go with</p>\n\n<pre><code>type Owner struct {\n    Name string\n    Pet  []Pet\n}\n</code></pre>\n\n<p>Then Doe gets marshalled just fine.</p>\n\n<pre><code>{John []}\n{Doe [{Rose Dog} {Max Cat}]}\n</code></pre>\n\n<p>How can I catch both cases?</p>\n\n<p>I'd prefer to marshall it into a slice of <code>Pet</code>s in the end, no matter what.</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"tags": [], "owner": {"reputation": 153, "user_id": 757928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b5316a773c4e4fa9dc57545e4b240f1?s=128&d=identicon&r=PG", "display_name": "Munk", "link": "https://stackoverflow.com/users/757928/munk"}, "is_accepted": false, "score": 1, "last_activity_date": 1497659241, "creation_date": 1497659241, "answer_id": 44599621, "question_id": 44592333, "link": "https://stackoverflow.com/questions/44592333/why-is-goapp-test-is-looking-for-files-in-tmp/44599621#44599621", "title": "Why is goapp test is looking for files in /tmp?", "body": "<p>You might want to read up on how go run/test works. The program basically builds into a temporary location and then runs, so that might be why it's complaining about your goroot. </p>\n\n<p>This question could possibly help you: <a href=\"https://stackoverflow.com/questions/23847003/golang-tests-and-working-directory\">Golang: tests and working directory</a></p>\n"}, {"comments": [{"owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "edited": false, "score": 0, "creation_date": 1498056249, "post_id": 44637860, "comment_id": 76342801, "body": "I&#39;ve already reinstalled from scratch on 2 separate computers. I get the same error."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "edited": false, "score": 0, "creation_date": 1498057145, "post_id": 44637860, "comment_id": 76343599, "body": "@BryanWheelock OK. I suppose the first part of the answer I reference does not help either?"}, {"owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "edited": false, "score": 0, "creation_date": 1498159732, "post_id": 44637860, "comment_id": 76398568, "body": "I had deleted GO and PATH as well.  I sent something to Google and the problem is a bug in the SDK code. I&#39;m not sure when the update will be."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "edited": false, "score": 0, "creation_date": 1498160811, "post_id": 44637860, "comment_id": 76399186, "body": "@BryanWheelock OK. What is the URL of your bug?"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 1, "last_activity_date": 1497898204, "last_edit_date": 1592644375, "creation_date": 1497898204, "answer_id": 44637860, "question_id": 44592333, "link": "https://stackoverflow.com/questions/44592333/why-is-goapp-test-is-looking-for-files-in-tmp/44637860#44637860", "title": "Why is goapp test is looking for files in /tmp?", "body": "<p>You can try and follow the <a href=\"https://stackoverflow.com/a/43641355/6309\">recommendation of this answer</a>:</p>\n<blockquote>\n<p>If your install is messed up beyond reason (happened to me once), just remove the cloud SDK and any references to it in your <code>$PATH</code>. Also completely uninstall the regular Go installation.</p>\n<p>Then start from scratch. <a href=\"https://cloud.google.com/appengine/docs/standard/go/download\" rel=\"nofollow noreferrer\">Install Go, unpack google-cloud-sdk</a>, run installer (add to <code>$PATH</code> if needed), <code>gcloud components install app-engine-go</code>.<br />\nVoila.</p>\n</blockquote>\n<p>As mentioned in that same answer, you don't set <code>GOROOT</code> anywhere, <a href=\"https://dave.cheney.net/2013/06/14/you-dont-need-to-set-goroot-really\" rel=\"nofollow noreferrer\">it is set for you</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "is_accepted": false, "score": 0, "last_activity_date": 1498125624, "creation_date": 1498125624, "answer_id": 44696156, "question_id": 44592333, "link": "https://stackoverflow.com/questions/44592333/why-is-goapp-test-is-looking-for-files-in-tmp/44696156#44696156", "title": "Why is goapp test is looking for files in /tmp?", "body": "<p>I believe you are calling wrong goapp. You should be calling one that is directly in google_appengine folder as follows:</p>\n\n<pre><code>/Users/bryan/google-cloud-sdk/platform/google_appengine/goapp test\n</code></pre>\n\n<p>If you don't have goapp in google_appengine for some reason, I'll be quite surprised, but then following should work too. (Still the above is the correct way of calling it. goapp resolves appengine's goroot as a relative path from it's own location, so it's important where goapp itself is located.)</p>\n\n<pre><code>GOROOT=/Users/bryan/google-cloud-sdk/platform/google_appengine/goroot /Users/bryan/google-cloud-sdk/platform/google_appengine/goapp test\n</code></pre>\n"}], "owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 287, "favorite_count": 1, "accepted_answer_id": 44637860, "answer_count": 3, "score": 7, "last_activity_date": 1498125624, "creation_date": 1497624964, "last_edit_date": 1497883814, "question_id": 44592333, "link": "https://stackoverflow.com/questions/44592333/why-is-goapp-test-is-looking-for-files-in-tmp", "title": "Why is goapp test is looking for files in /tmp?", "body": "<p>I'm trying to get tests working on my local dev machine Cloud SDK version is: 159.0.0</p>\n\n<p>Everything I've read says that I should no change GOROOT so I'm not sure how to fix this.</p>\n\n<p>$ /Users/bryan/google-cloud-sdk/platform/google_appengine/goroot/bin/goapp test</p>\n\n<pre><code>go: cannot find GOROOT directory: /tmp/go_sdk887571938/appengine/go_appengine/goroot\n</code></pre>\n\n<p>bryan@Bryans-MacBook Thu Jun 15 10:22:37 ~/go/src/skincarereview</p>\n\n<p>$ go env</p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"darwin\"\nGOOS=\"darwin\"\nGOPATH=\"/Users/bryan/go/\"\nGORACE=\"\"\nGOROOT=\"/usr/local/go\"\nGOTOOLDIR=\"/usr/local/go/pkg/tool/darwin_amd64\"\nGO15VENDOREXPERIMENT=\"1\"\nCC=\"clang\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fno-common\"\nCXX=\"clang++\"\nCGO_ENABLED=\"1\"\n</code></pre>\n\n<p>bryan@Bryans-MacBook Thu Jun 15 10:22:57 ~/go/src/skincarereview</p>\n\n<p>$ ls ~/google-cloud-sdk</p>\n\n<pre><code>total 408\ndrwxr-xr-x  30 bryan  staff    1020 Jun 14 20:31 .install\n-rw-r--r--   1 bryan  staff     980 Jun 14 20:30 LICENSE\n-rw-r--r--   1 bryan  staff     673 Jun 14 20:30 README\n-rw-r--r--   1 bryan  staff  162673 Jun 14 20:30 RELEASE_NOTES\n-rw-r--r--   1 bryan  staff       8 Jun 14 20:30 VERSION\ndrwxr-xr-x  10 bryan  staff     340 Jun 14 20:30 bin\n-rw-r--r--   1 bryan  staff    2734 Jun 14 20:30 completion.bash.inc\n-rw-r--r--   1 bryan  staff    2083 Jun 14 20:30 completion.zsh.inc\ndrwxr-xr-x   3 bryan  staff     102 Jun 14 20:30 help\n-rwxr-xr-x   1 bryan  staff    1581 Jun 14 20:30 install.bat\n-rwxr-xr-x   1 bryan  staff    3471 Jun 14 20:30 install.sh\ndrwxr-xr-x  10 bryan  staff     340 Jun 14 20:30 lib\n-rw-r--r--   1 bryan  staff     308 Jun 14 20:30 path.bash.inc\n-rw-r--r--   1 bryan  staff    1210 Jun 14 20:30 path.fish.inc\n-rw-r--r--   1 bryan  staff      31 Jun 14 20:30 path.zsh.inc\ndrwxr-xr-x   6 bryan  staff     204 Jun 14 20:30 platform\n-rw-r--r--   1 bryan  staff      40 Jun 14 20:30 properties\n</code></pre>\n\n<p>bryan@Bryans-MacBook Thu Jun 15 10:24:22 ~/go/src/skincarereview  </p>\n\n<p>$ find / -name goroot 2>/dev/null</p>\n\n<pre><code>/Users/bryan/google-cloud-sdk/platform/google_appengine/goroot\n</code></pre>\n\n<p>bryan@Bryans-MacBook Thu Jun 15 10:28:43 ~/go/src/skincarereview   </p>\n\n<p>$ echo $PATH</p>\n\n<pre><code>/Users/bryan/google-cloud-sdk/bin:/Users/bryan/go/src/:/Users/bryan/google-cloud-sdk/platform/google_appengine/goroot/bin/:/Users/bryan/google-cloud-sdk/bin/:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/go/bin\n</code></pre>\n\n<p>Looking at main.go line 155, where I think the error is being thrown, I don't see where \"goroot\" is being set .</p>\n\n<pre><code>if fi, err := os.Stat(goroot); err != nil || !fi.IsDir() {\n    fmt.Fprintf(os.Stderr, \"go: cannot find GOROOT directory: %v\\n\", goroot)\n    os.Exit(2)\n}\n</code></pre>\n"}, {"tags": ["go", "directory", "markdown", "hugo"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497626645, "post_id": 44592332, "comment_id": 76173468, "body": "I&#39;m voting to close this question as off-topic because this is not a programming question, it&#39;s a question for the <a href=\"https://discuss.gohugo.io/\" rel=\"nofollow noreferrer\">hugo community</a>."}], "answers": [{"tags": [], "owner": {"reputation": 3415, "user_id": 5287638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AzeH8.png?s=128&g=1", "display_name": "Jack Taylor", "link": "https://stackoverflow.com/users/5287638/jack-taylor"}, "is_accepted": false, "score": 0, "last_activity_date": 1497653670, "creation_date": 1497653670, "answer_id": 44599025, "question_id": 44592332, "link": "https://stackoverflow.com/questions/44592332/is-it-possible-using-hugo-website-framework-to-change-the-content-directory-wher/44599025#44599025", "title": "Is it possible using HUGO website framework to change the content directory where you store, for example, markdown files?", "body": "<p>Yes - you can use the <code>contentDir</code> option in your <a href=\"https://gohugo.io/overview/configuration/\" rel=\"nofollow noreferrer\">config file</a>, or pass the <code>-c</code> or <code>--contentDir</code> <a href=\"https://gohugo.io/commands/hugo/\" rel=\"nofollow noreferrer\">flags</a> to Hugo on the command line.</p>\n"}], "owner": {"reputation": 25, "user_id": 8172391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd21f399726c984e3256b27fe37c8d7?s=128&d=identicon&r=PG&f=1", "display_name": "VahnIronSky", "link": "https://stackoverflow.com/users/8172391/vahnironsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1497653670, "creation_date": 1497624964, "question_id": 44592332, "link": "https://stackoverflow.com/questions/44592332/is-it-possible-using-hugo-website-framework-to-change-the-content-directory-wher", "title": "Is it possible using HUGO website framework to change the content directory where you store, for example, markdown files?", "body": "<p>My purpose is to have an empty hugo application, so, using scripts, I can store list of directories with md files or only md files in an external directory, one level above.</p>\n"}, {"tags": ["go", "visual-studio-code", "revel"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497618707, "post_id": 44589854, "comment_id": 76167842, "body": "Any args you need to pass go in <code>args</code>, yes. There&#39;s <a href=\"https://code.visualstudio.com/docs/editor/debugging#_launchjson-attributes\" rel=\"nofollow noreferrer\">documentation available</a>."}, {"owner": {"reputation": 1254, "user_id": 2870438, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3c587da2b868b56e3afb188bff722e8f?s=128&d=identicon&r=PG&f=1", "display_name": "Eloy Fern&#225;ndez Franco", "link": "https://stackoverflow.com/users/2870438/eloy-fern%c3%a1ndez-franco"}, "edited": false, "score": 0, "creation_date": 1497619793, "post_id": 44589854, "comment_id": 76168549, "body": "Hi Zapico... maybe you need to point the path of <code>program</code> to go/bin/revel.d/your-app-folder/the-executable"}, {"owner": {"reputation": 1254, "user_id": 2870438, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3c587da2b868b56e3afb188bff722e8f?s=128&d=identicon&r=PG&f=1", "display_name": "Eloy Fern&#225;ndez Franco", "link": "https://stackoverflow.com/users/2870438/eloy-fern%c3%a1ndez-franco"}, "edited": false, "score": 0, "creation_date": 1497620736, "post_id": 44589854, "comment_id": 76169212, "body": "Hi again... I am thinking about the compilation... revel is a framework that auto-reloads the executable file when you run it again, if you had changed something in the code (not on the deps)... but in this case I don&#180;t know how could it work. Try and tell us."}], "answers": [{"comments": [{"owner": {"reputation": 2256, "user_id": 694693, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/kSGHN.jpg?s=128&g=1", "display_name": "zapico", "link": "https://stackoverflow.com/users/694693/zapico"}, "edited": false, "score": 0, "creation_date": 1497645401, "post_id": 44594408, "comment_id": 76183533, "body": "Thanks for your help!!!  My dev env is mac so it&#39;s not exactly the same but it seems its &quot;almost there&quot;. Now I&#39;m getting this error: <code>could not launch process: dial tcp :64821: getsockopt: connection refused Process exiting with code: 1</code>"}, {"owner": {"reputation": 2256, "user_id": 694693, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/kSGHN.jpg?s=128&g=1", "display_name": "zapico", "link": "https://stackoverflow.com/users/694693/zapico"}, "edited": false, "score": 0, "creation_date": 1497645915, "post_id": 44594408, "comment_id": 76183766, "body": "It seems its about my delve installation, I&#39;ll check it later. And this answer should be in Revel doc!!! ;)"}, {"owner": {"reputation": 2256, "user_id": 694693, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/kSGHN.jpg?s=128&g=1", "display_name": "zapico", "link": "https://stackoverflow.com/users/694693/zapico"}, "edited": false, "score": 0, "creation_date": 1497708649, "post_id": 44594408, "comment_id": 76198164, "body": "Thanks for your help @putu, I&#39;m facing different problems now  <code>[&quot;-importPath&quot;, &quot;myapp&quot;, &quot;-srcPath&quot;, &quot;${workspaceRoot}&#47;..&quot;,  &quot;-runMode&quot;, &quot;dev&quot;]</code>"}, {"owner": {"reputation": 2256, "user_id": 694693, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/kSGHN.jpg?s=128&g=1", "display_name": "zapico", "link": "https://stackoverflow.com/users/694693/zapico"}, "edited": false, "score": 0, "creation_date": 1497708812, "post_id": 44594408, "comment_id": 76198224, "body": "If I remove &quot;-runMode&quot; and &quot;dev&quot; from args, it runs, but it seems like it&#39;s not loading correctly some files (but it&#39;s debugging anyway, THANKS a lot), I think I have a problem with environments in revel or something..."}, {"owner": {"reputation": 723, "user_id": 2423216, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bwCkf.png?s=128&g=1", "display_name": "Alvaro Denis Acosta", "link": "https://stackoverflow.com/users/2423216/alvaro-denis-acosta"}, "edited": false, "score": 0, "creation_date": 1504458379, "post_id": 44594408, "comment_id": 79011095, "body": "Hello, I am able to show variable values in a floating windows, for a simple example like this(<a href=\"https://twitter.com/i/moments/880234757807898629\" rel=\"nofollow noreferrer\">twitter.com/i/moments/880234757807898629</a>), but not for a revel application, I can debug the revel app but not inspect the variables. Any suggestion?"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "reply_to_user": {"reputation": 723, "user_id": 2423216, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bwCkf.png?s=128&g=1", "display_name": "Alvaro Denis Acosta", "link": "https://stackoverflow.com/users/2423216/alvaro-denis-acosta"}, "edited": false, "score": 0, "creation_date": 1504703257, "post_id": 44594408, "comment_id": 79113173, "body": "@AlvaroDenisAcosta Perhaps the debugger (and) vscode integration still have some issues. Once I&#39;ve succeeded to display variable as shown in <a href=\"https://imgur.com/a/2dL8g\" rel=\"nofollow noreferrer\">https://imgur.com/a/2dL8g</a>, but later it won&#39;t works."}], "tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 6, "last_activity_date": 1497661657, "last_edit_date": 1497661657, "creation_date": 1497632164, "answer_id": 44594408, "question_id": 44589854, "link": "https://stackoverflow.com/questions/44589854/is-it-possible-to-debug-go-revel-framework-from-visual-studio-code/44594408#44594408", "title": "Is it possible to debug go revel framework from Visual Studio Code?", "body": "<p>Yes it's possible. </p>\n\n<ol>\n<li>Suppose that the <code>GOPATH</code> is <code>C:\\Work\\golang</code></li>\n<li>Revel project name is <code>myapp</code>, thus the location of the project (workspace) will be <code>C:\\Work\\golang\\src\\myapp</code>. </li>\n<li>Make some changes to the controllers etc...</li>\n<li>Run the application with <code>revel run myapp</code>, then press <code>CTRL+C</code> to exit. This step is necessary to generate corresponding go files. The generated file, i.e. the <code>main</code> package will be available under <code>${workspaceRoot}/app/tmp/main.go</code> </li>\n<li><p>Configure <code>launch.json</code> as follows:</p>\n\n<pre><code>{\n    \"version\": \"0.2.0\",\n    \"configurations\": [\n        {\n            \"name\": \"Launch\",\n            \"type\": \"go\",\n            \"request\": \"launch\",\n            \"mode\": \"debug\",\n            \"remotePath\": \"\",\n            \"port\": 2345,\n            \"host\": \"127.0.0.1\",\n            \"env\": {},\n            \"showLog\": true,\n            \"program\": \"${workspaceRoot}/app/tmp/\",\n            \"args\": [\"-importPath\", \"myapp\", \"-srcPath\", \"c:\\\\work\\\\golang\\\\src\",  \"-runMode\", \"dev\"]\n        }\n    ]\n}\n</code></pre></li>\n<li><p>The important parts are <code>program</code> and <code>args</code> parameters, while the other parameters are unmodified. </p></li>\n<li><p>Set <code>breakpoint</code> and start the <code>delve</code> debugger...</p></li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/CW1XT.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/CW1XT.jpg\" alt=\"Debug revel application\"></a></p>\n\n<h2>EDIT:</h2>\n\n<ol>\n<li>Setting <code>args</code> parameter to <code>[\"-importPath\", \"myapp\", \"-srcPath\", \"${workspaceRoot}/..\",  \"-runMode\", \"dev\"]</code> also work, and I think this should work in other platforms (Mac, Linux) too. </li>\n<li>The error message is related to <code>delve</code> issue. See <a href=\"https://github.com/Microsoft/vscode-go/issues/986\" rel=\"noreferrer\">https://github.com/Microsoft/vscode-go/issues/986</a></li>\n</ol>\n"}], "owner": {"reputation": 2256, "user_id": 694693, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/kSGHN.jpg?s=128&g=1", "display_name": "zapico", "link": "https://stackoverflow.com/users/694693/zapico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1266, "favorite_count": 0, "accepted_answer_id": 44594408, "answer_count": 1, "score": 4, "last_activity_date": 1497661657, "creation_date": 1497617939, "question_id": 44589854, "link": "https://stackoverflow.com/questions/44589854/is-it-possible-to-debug-go-revel-framework-from-visual-studio-code", "title": "Is it possible to debug go revel framework from Visual Studio Code?", "body": "<p>I'm trying to debug a revel app with visual studio but I can't get it to work.</p>\n\n<p>I've seen this question <a href=\"https://stackoverflow.com/questions/41171432/how-to-debug-revel-frameworkgolang-application-in-visual-studio-codevscode\">how to debug revel framework(golang) application in visual studio code(vscode)</a> but no answers yet...</p>\n\n<p>I've tried with this config:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"false\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>{\r\n  \"version\": \"0.2.0\",\r\n  \"configurations\": [\r\n    {\r\n      \"name\": \"Launch\",\r\n      \"type\": \"go\",\r\n      \"request\": \"launch\",\r\n      \"mode\": \"debug\",\r\n      \"remotePath\": \"\",\r\n      \"port\": 2345,\r\n      \"host\": \"127.0.0.1\",\r\n      \"program\": \"~/code/go/bin/revel\",\r\n      \"env\": {},\r\n      \"args\": [],\r\n      \"showLog\": true\r\n    }\r\n  ]\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>But I'm getting this error:\n<code>Failed to continue: \"The program attribute must point to valid directory, .go file or executable.\"</code></p>\n\n<p>I think it must be the rebel binary the one to be run here, but I don't know how to pass the app path, should it go in \"args\"?</p>\n"}, {"tags": ["go", "go-gorm"], "comments": [{"owner": {"reputation": 179, "user_id": 5802278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a94f4299dfac69693bd99b9d9fa66f59?s=128&d=identicon&r=PG", "display_name": "Ralph Juhnke", "link": "https://stackoverflow.com/users/5802278/ralph-juhnke"}, "edited": false, "score": 1, "creation_date": 1498321598, "post_id": 44589060, "comment_id": 76458474, "body": "for sake of completeness: You can use <code>db.SingularTable(true)</code> to use singular tablenames globally."}], "answers": [{"comments": [{"owner": {"reputation": 6488, "user_id": 772295, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bu8Dd.png?s=128&g=1", "display_name": "superarts.org", "link": "https://stackoverflow.com/users/772295/superarts-org"}, "edited": false, "score": 0, "creation_date": 1540842386, "post_id": 44589458, "comment_id": 93005033, "body": "Just realized that OP was using <code>user</code> instead of <code>User</code>."}], "tags": [], "owner": {"reputation": 1124, "user_id": 3805062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nIUyW.jpg?s=128&g=1", "display_name": "bayrinat", "link": "https://stackoverflow.com/users/3805062/bayrinat"}, "is_accepted": false, "score": 27, "last_activity_date": 1615587102, "last_edit_date": 1615587102, "creation_date": 1497616668, "answer_id": 44589458, "question_id": 44589060, "link": "https://stackoverflow.com/questions/44589060/to-set-singular-name-for-a-table-in-gorm/44589458#44589458", "title": "to set singular name for a table in gorm", "body": "<p>Set method <code>TableName</code> for your struct.</p>\n<pre><code>func (user) TableName() string {\n    return &quot;user&quot;\n}\n</code></pre>\n<p>Link: <a href=\"https://gorm.io/docs/models.html#conventions\" rel=\"nofollow noreferrer\">https://gorm.io/docs/models.html#conventions</a></p>\n"}, {"tags": [], "owner": {"reputation": 711, "user_id": 3793624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33afc5fb488eac5527fde9482d0ba359?s=128&d=identicon&r=PG&f=1", "display_name": "Sivalingam", "link": "https://stackoverflow.com/users/3793624/sivalingam"}, "is_accepted": false, "score": 13, "last_activity_date": 1609005425, "last_edit_date": 1609005425, "creation_date": 1524865558, "answer_id": 50070687, "question_id": 44589060, "link": "https://stackoverflow.com/questions/44589060/to-set-singular-name-for-a-table-in-gorm/50070687#50070687", "title": "to set singular name for a table in gorm", "body": "<p>Gorm has a in-built method for that that will be set in global level so all tables will be singular.</p>\n<p>For gorm v1, you could do:</p>\n<pre><code>db.SingularTable(true)\n</code></pre>\n<p>For v2, it's a little more verbose:</p>\n<pre><code>db, err := gorm.Open(postgres.Open(connStr), &amp;gorm.Config{\n    NamingStrategy: schema.NamingStrategy{\n        SingularTable: true,\n    },\n})\n</code></pre>\n"}], "owner": {"reputation": 340, "user_id": 6464746, "user_type": "registered", "accept_rate": 22, "profile_image": "https://lh6.googleusercontent.com/-75L-hYPbdcQ/AAAAAAAAAAI/AAAAAAAAAKo/siHtIEA6B0g/photo.jpg?sz=128", "display_name": "Yash Goel", "link": "https://stackoverflow.com/users/6464746/yash-goel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12972, "favorite_count": 1, "answer_count": 2, "score": 19, "last_activity_date": 1615587102, "creation_date": 1497615396, "question_id": 44589060, "link": "https://stackoverflow.com/questions/44589060/to-set-singular-name-for-a-table-in-gorm", "title": "to set singular name for a table in gorm", "body": "<pre><code>type user struct {\n    ID       int\n    Username string `gorm:\"size:255\"`\n    Name     string `gorm:\"size:255\"`\n}\n</code></pre>\n\n<p>I want to create a table 'user' using this model. But the table name automatically set to 'users'. I know it is gorm's default behaviour. But I want the table name to be 'user'. </p>\n"}, {"tags": ["arrays", "memory", "go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 2415, "user_id": 7156008, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/QzIXM.jpg?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/7156008/george"}, "edited": false, "score": 0, "creation_date": 1497620573, "post_id": 44589101, "comment_id": 76169098, "body": "So the answer to my initial question woudl be &quot;no&quot; ? I mean, is there a flag that I can check somewhere or another mechanism to see if another array was allocated ?"}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "reply_to_user": {"reputation": 2415, "user_id": 7156008, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/QzIXM.jpg?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/7156008/george"}, "edited": false, "score": 0, "creation_date": 1497620849, "post_id": 44589101, "comment_id": 76169312, "body": "According to the specification you can check if capacity of the slice is smaller than its length before the append. I don&#39;t really see how you could do it after the append though (unless you use reflect or unsafe, then there are ways). I wouldn&#39;t bother though. Decide what behavior you want and either always copy or don&#39;t copy."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1497630161, "post_id": 44589101, "comment_id": 76175490, "body": "Art is correct, the only way to be sure, outside of using reflect or unsafe, is to check, <i>before</i> the append, if <code>cap(a) &gt;= len(a) + len(addition)</code>.  If that is true, append will not reallocate, and if it is false, it will reallocate.  However, if you have behavior that <i>depends</i> on one or the other behavior, you&#39;re <i>far</i> better served either using a pointer to a slice or doing the allocation yourself and using <code>copy()</code> (which is all append does anyway)."}], "tags": [], "owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "is_accepted": true, "score": 3, "last_activity_date": 1497615535, "creation_date": 1497615535, "answer_id": 44589101, "question_id": 44588826, "link": "https://stackoverflow.com/questions/44588826/is-a-slices-behavior-well-defined-after-append-has-been-called-on-it/44589101#44589101", "title": "Is a slice&#39;s behavior well defined after append has been called on it?", "body": "<p>The language specification says:</p>\n\n<blockquote>\n  <p>If the capacity of s is not large enough to fit the additional values, append allocates a new, sufficiently large underlying array that fits both the existing slice elements and the additional values. Otherwise, append re-uses the underlying array.</p>\n</blockquote>\n\n<p>If you want the slice to point to a different underlying array you need to always make a copy.</p>\n"}], "owner": {"reputation": 2415, "user_id": 7156008, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/QzIXM.jpg?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/7156008/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 44589101, "answer_count": 1, "score": 0, "last_activity_date": 1497615535, "creation_date": 1497614627, "question_id": 44588826, "link": "https://stackoverflow.com/questions/44588826/is-a-slices-behavior-well-defined-after-append-has-been-called-on-it", "title": "Is a slice&#39;s behavior well defined after append has been called on it?", "body": "<p>Take for example the following code:</p>\n\n<p><a href=\"https://play.golang.org/p/vjux0TYz0D\" rel=\"nofollow noreferrer\">https://play.golang.org/p/vjux0TYz0D</a></p>\n\n<p>It seems that, depending on the type held by the slice, append will sometimes \"copy\" the initial slice (the one append is called upon) and other times it will leave it pointing to the same underlying array.</p>\n\n<p>Is this behavior defined, assuming the code:</p>\n\n<pre><code>a := []type{value1}\nb := append(a, value2)\n</code></pre>\n\n<p>Is there any way of knowing if after the second operation a and b are pointing to the same memory ? Can I modify a or b in such a way that I am 100% sure the other is not modified ? Can the 'a' point to a completely different memory location after append ? Should 'a' just be considered garbage with undefined behavior after append is called on it ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1497618889, "post_id": 44588674, "comment_id": 76167956, "body": "Have you tried it? That would be the easiest and quickest way to find out. Just try it."}], "answers": [{"tags": [], "owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "is_accepted": true, "score": 3, "last_activity_date": 1497614774, "creation_date": 1497614774, "answer_id": 44588877, "question_id": 44588674, "link": "https://stackoverflow.com/questions/44588674/passing-request-on-net-http-to-function-golang/44588877#44588877", "title": "Passing *Request on &quot;net/http&quot; to function Golang", "body": "<p>Yes, you can 'cause <code>request</code> is a regular variable.\nIt's passed by pointer, so if you will change <code>request</code> in <code>getName</code> it will change in <code>Say</code> too.</p>\n\n<pre><code>package main\n\nimport \"net/http\"\n\nfunc main() {\n    http.HandleFunc(\"saySomething\", Say)\n}\n\nfunc Say(responseW http.ResponseWriter, request *http.Request) {\n    name := getName(request) // passing request value to another function\n    println(name)\n}\n\nfunc getName(request *http.Request) string {\n    request.ParseForm()\n    return request.Form.Get(\"name\")\n}\n</code></pre>\n\n<p>See Golang tour <a href=\"https://tour.golang.org/moretypes/1\" rel=\"nofollow noreferrer\">https://tour.golang.org/moretypes/1</a></p>\n"}], "owner": {"reputation": 545, "user_id": 3763112, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/bea14956d83fe906ba4bafcea761250d?s=128&d=identicon&r=PG&f=1", "display_name": "Angger", "link": "https://stackoverflow.com/users/3763112/angger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1361, "favorite_count": 0, "accepted_answer_id": 44588877, "answer_count": 1, "score": -2, "last_activity_date": 1497614774, "creation_date": 1497614138, "question_id": 44588674, "link": "https://stackoverflow.com/questions/44588674/passing-request-on-net-http-to-function-golang", "title": "Passing *Request on &quot;net/http&quot; to function Golang", "body": "<p>Is it possible to pass Request value to another function?</p>\n\n<pre><code>import \"net/http\"\n\nfunc main() {\n   http.HandleFunc(\"saySomething\", Say)\n}\n\nfunc Say(responseW http.ResponseWriter, request *http.Request) {\n   name := getName(request) // passing request value to another function\n}\n\nfunc getName(request someType) string {\n   request.ParseForm()\n   return request.Form.Get(\"name\")\n}\n</code></pre>\n"}, {"tags": ["for-loop", "go", "slice"], "answers": [{"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": true, "score": 2, "last_activity_date": 1497607701, "last_edit_date": 1497607701, "creation_date": 1497607394, "answer_id": 44586468, "question_id": 44586280, "link": "https://stackoverflow.com/questions/44586280/golang-got-empty-slice-after-initialize/44586468#44586468", "title": "golang got empty slice after initialize", "body": "<p>You are creating a new <code>Queue</code> instead of accessing the one in the <code>Config</code> structure, and this new value prevents modification to the <code>Queue</code> in <code>Config.Queues</code>. Try direct assignment:</p>\n\n<pre><code>// ...\n\nt.Config.Queues[j].Connections = make([]*redis.Client, queue.Concurrent)\n\n// ...\n</code></pre>\n\n<p>Or if you want to use an auxillary variable, change <code>Config.Queues</code> type to <code>[]*Queue</code>:</p>\n\n<pre><code>type Config struct {\n  Queues    []*Queue\n  RedisAddr string\n  RedisDB   int\n}\n\n// ...\n\nconfig := Config{\n  RedisAddr: \"10.1.1.59:6379\",\n  RedisDB:   8,\n  Queues: []*Queue{\n    &amp;Queue{Name: \"default\", Concurrent: 1},\n    &amp;Queue{Name: \"mail\", Concurrent: 2},\n  },\n}\n</code></pre>\n\n<p>Now your original code should work.</p>\n"}], "owner": {"reputation": 1, "user_id": 5088696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d91f056ae41efdc1dffc2801022b373?s=128&d=identicon&r=PG&f=1", "display_name": "Jack_Zhou", "link": "https://stackoverflow.com/users/5088696/jack-zhou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 44586468, "answer_count": 1, "score": 0, "last_activity_date": 1497607701, "creation_date": 1497606925, "question_id": 44586280, "link": "https://stackoverflow.com/questions/44586280/golang-got-empty-slice-after-initialize", "title": "golang got empty slice after initialize", "body": "<p>I have 3 struct: Queue,Config,Tasker</p>\n\n<pre><code>type Queue struct {\n  Name        string\n  Concurrent  int\n  Connections []*redis.Client\n}\n\ntype Config struct {\n  Queues    []Queue\n  RedisAddr string\n  RedisDB   int\n}\n\ntype Tasker struct {\n  Config Config\n}\n</code></pre>\n\n<p>The problem happend in this method, I initialize queue.Connections in for-loop, but I got zero length of queue.Connections outside the for-loop</p>\n\n<pre><code>func (t *Tasker) StartListening() {\n  for j := 0; j &lt; len(t.Config.Queues); j++ {\n    queue := t.Config.Queues[j]\n    queue.Connections = make([]*redis.Client, queue.Concurrent)\n    fmt.Println(len(queue.Connections)) //here print correct length, 1 for default queue, 2 for mail queue\n  }\n  fmt.Println(len(t.Config.Queues[0].Connections)) //but why here print 0?\n}\n</code></pre>\n\n<p>This is my test code</p>\n\n<pre><code>func main() {\n  config := Config{\n    RedisAddr: \"10.1.1.59:6379\",\n    RedisDB:   8,\n    Queues: []Queue{\n      Queue{Name: \"default\", Concurrent: 1},\n      Queue{Name: \"mail\", Concurrent: 2},\n    },\n  }\n  daemon := Tasker{Config: config}\n  daemon.StartListening()\n\n}\n</code></pre>\n\n<p>why <code>fmt.Println(len(t.Config.Queues[0].Connections))</code> is 0 outside the for-loop?</p>\n"}]