[{"tags": ["windows", "go", "environment-variables"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1553757428, "post_id": 55386793, "comment_id": 97504786, "body": "For POSIX shells you can use <a href=\"https://golang.org/pkg/os/#ExpandEnv\" rel=\"nofollow noreferrer\">os.ExpandEnv</a>, but it doesn&#39;t seem to support the <code>%VAR%</code> style variables you&#39;re using. It would be trivial to implement your own version, though."}], "answers": [{"tags": [], "owner": {"reputation": 153, "user_id": 3051040, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/50791649b689432db71eb363eaecc9db?s=128&d=identicon&r=PG&f=1", "display_name": "user3051040", "link": "https://stackoverflow.com/users/3051040/user3051040"}, "is_accepted": false, "score": 0, "last_activity_date": 1553722727, "creation_date": 1553722727, "answer_id": 55386871, "question_id": 55386793, "link": "https://stackoverflow.com/questions/55386793/how-to-resolve-user-environment-variables-in-filepath/55386871#55386871", "title": "How to resolve user environment variables in filepath", "body": "<pre class=\"lang-golang prettyprint-override\"><code>userprofile := os.Getenv(\"USERPROFILE\")\nos.Open(userprofile+\"\\\\myfile.txt\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 2137898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BPNKy.png?s=128&g=1", "display_name": "Gary Leeson", "link": "https://stackoverflow.com/users/2137898/gary-leeson"}, "is_accepted": false, "score": -1, "last_activity_date": 1553722773, "creation_date": 1553722773, "answer_id": 55386884, "question_id": 55386793, "link": "https://stackoverflow.com/questions/55386793/how-to-resolve-user-environment-variables-in-filepath/55386884#55386884", "title": "How to resolve user environment variables in filepath", "body": "<p>Have a look at <a href=\"http://www.golangprograms.com/how-to-set-get-and-list-environment-variables.html\" rel=\"nofollow noreferrer\">http://www.golangprograms.com/how-to-set-get-and-list-environment-variables.html</a></p>\n\n<p>You can read the 'userprofile' environment value and and build the path before passing it to os.Open</p>\n"}, {"tags": [], "owner": {"reputation": 1047, "user_id": 10443472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/051b4da9def21dd0ff5e10f383a96c94?s=128&d=identicon&r=PG", "display_name": "retgits", "link": "https://stackoverflow.com/users/10443472/retgits"}, "is_accepted": true, "score": 6, "last_activity_date": 1553727641, "creation_date": 1553727641, "answer_id": 55387759, "question_id": 55386793, "link": "https://stackoverflow.com/questions/55386793/how-to-resolve-user-environment-variables-in-filepath/55387759#55387759", "title": "How to resolve user environment variables in filepath", "body": "<p>To get a file handle, and make your program a little portable too, try</p>\n\n<pre><code>userprofile := os.Getenv(\"USERPROFILE\")\nf, err := os.Open(path.Join(userprofile, \"myfile.txt\"))\n</code></pre>\n\n<p>The <code>os.Getenv()</code> will read the environment variable and <code>path.Join()</code> will take care of properly constructing the path (so no need to do <code>\\\\</code>).</p>\n\n<p>Instead of <code>os.Getenv()</code> you might also want to look at <a href=\"https://golang.org/pkg/os/#LookupEnv\" rel=\"noreferrer\"><code>os.LookupEnv()</code></a>. This will tell you if the environment variable you're looking for is empty or simply not existing. A good example of how you can use that to set default values can be found in <a href=\"https://stackoverflow.com/questions/40326540/how-to-assign-default-value-if-env-var-is-empty\">this</a> answer on SO.</p>\n"}, {"tags": [], "owner": {"reputation": 331, "user_id": 6672339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V3iXK.jpg?s=128&g=1", "display_name": "stu-b-doo", "link": "https://stackoverflow.com/users/6672339/stu-b-doo"}, "is_accepted": false, "score": 0, "last_activity_date": 1575156706, "creation_date": 1575156706, "answer_id": 59121230, "question_id": 55386793, "link": "https://stackoverflow.com/questions/55386793/how-to-resolve-user-environment-variables-in-filepath/59121230#59121230", "title": "How to resolve user environment variables in filepath", "body": "<p>Just written a package to do this. Feedback welcome</p>\n\n<p><a href=\"https://gitlab.com/stu-b-doo/windowspathenv/\" rel=\"nofollow noreferrer\">https://gitlab.com/stu-b-doo/windowspathenv/</a></p>\n\n<pre><code>fmt.Println(windowspathenv.Resolve(\"%USERPROFILE%/Documents\"))\n\n// C:\\Users\\YourName\\Documents\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 3051040, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/50791649b689432db71eb363eaecc9db?s=128&d=identicon&r=PG&f=1", "display_name": "user3051040", "link": "https://stackoverflow.com/users/3051040/user3051040"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 579, "favorite_count": 0, "accepted_answer_id": 55387759, "answer_count": 4, "score": 2, "last_activity_date": 1575156706, "creation_date": 1553722415, "question_id": 55386793, "link": "https://stackoverflow.com/questions/55386793/how-to-resolve-user-environment-variables-in-filepath", "title": "How to resolve user environment variables in filepath", "body": "<p>Golang on windows. Trying to use </p>\n\n<pre><code>os.Open(\"%userprofile%\\\\myfile.txt\")\n</code></pre>\n\n<p>Getting <code>file path not found</code> and golang is not resolving <code>%userprofile%</code> to my <code>C:\\users\\myusername</code> folder.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 4, "last_activity_date": 1553722760, "last_edit_date": 1553722760, "creation_date": 1553721717, "answer_id": 55386648, "question_id": 55386549, "link": "https://stackoverflow.com/questions/55386549/understanding-variables-with-initializers/55386648#55386648", "title": "Understanding variables with initializers", "body": "<p>Clearly, <code>i = 100000</code> and <code>j = 5</code>.</p>\n\n<pre><code>var i, j int = 100000, 5\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>var i int = 100000\nvar j int = 5\n</code></pre>\n\n<p>Simply match the items in the variable list with the corresponding items in the initializer list.</p>\n\n<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Variable_declarations\" rel=\"nofollow noreferrer\">Variable declarations</a></p>\n  \n  <p>If a list of expressions is given, the variables are initialized with\n  the expressions following the rules for assignments.</p>\n</blockquote>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nvar i, j int = 100000, 5\n\nfunc main() {\n    fmt.Println(i, j)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/w821v9Tl1zx\" rel=\"nofollow noreferrer\">https://play.golang.org/p/w821v9Tl1zx</a></p>\n\n<p>Output:</p>\n\n<pre><code>100000 5\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1025, "user_id": 7253829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qe9lZ.jpg?s=128&g=1", "display_name": "waymobetta", "link": "https://stackoverflow.com/users/7253829/waymobetta"}, "is_accepted": true, "score": 4, "last_activity_date": 1553721874, "creation_date": 1553721874, "answer_id": 55386672, "question_id": 55386549, "link": "https://stackoverflow.com/questions/55386549/understanding-variables-with-initializers/55386672#55386672", "title": "Understanding variables with initializers", "body": "<p>When initializing multiple variables they are initialized in the order in which they are passed.</p>\n\n<p>So if you are declaring first <code>i</code> then <code>j</code>, then the values <code>100000</code> then <code>5</code> are assigned in the same order.</p>\n\n<p>When you print <code>j</code> you will get <code>5</code> because it is the second variable and corresponds to the second value.</p>\n\n<p>This also applies to the same way that multiple variable returns work in go, example below, or working example <a href=\"https://play.golang.org/p/4Co60FF0xwX\" rel=\"nofollow noreferrer\">here</a> in the playground.</p>\n\n<pre><code>func doStuff() (string, int) {\n    red, five := \"red\", 5\n    return red, five\n}\n</code></pre>\n\n<p>See <a href=\"https://gobyexample.com/variables\" rel=\"nofollow noreferrer\">this</a> helpful resource for more information on working with variables, and <a href=\"https://tour.golang.org/basics/6\" rel=\"nofollow noreferrer\">this</a> from the Tour of Go on working with multiple variable returns.</p>\n"}], "owner": {"reputation": 45, "user_id": 3980109, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ef85b40fd6d30e374561420ff53cb861?s=128&d=identicon&r=PG&f=1", "display_name": "swingBoris", "link": "https://stackoverflow.com/users/3980109/swingboris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 1, "accepted_answer_id": 55386672, "answer_count": 2, "score": -5, "last_activity_date": 1553728064, "creation_date": 1553721248, "last_edit_date": 1553728064, "question_id": 55386549, "link": "https://stackoverflow.com/questions/55386549/understanding-variables-with-initializers", "title": "Understanding variables with initializers", "body": "<p>I am learning the basics of go (golang).</p>\n\n<p>I can't seem to wrap my head around how variables with initializers work.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\nvar i, j int = 100000, 5\n\nfunc main() {\n    fmt.Println(j)\n}\n</code></pre>\n\n<p>When i print out j i get 5 instead of 100000, why is that?</p>\n"}, {"tags": ["amazon-web-services", "rest", "api", "go", "aws-sdk-go"], "comments": [{"owner": {"reputation": 15, "user_id": 10868873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36656276f7e8edd7556b827bb3fc8d29?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/10868873/kevin"}, "edited": false, "score": 0, "creation_date": 1553721355, "post_id": 55386272, "comment_id": 97495037, "body": "Also I am not allowed to use API gateway or lambda...."}, {"owner": {"reputation": 8750, "user_id": 1771556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XPkeq.jpg?s=128&g=1", "display_name": "Vadim Ashikhman", "link": "https://stackoverflow.com/users/1771556/vadim-ashikhman"}, "edited": false, "score": 0, "creation_date": 1553791361, "post_id": 55386272, "comment_id": 97526169, "body": "What output you got and what is the expected one? Do you have a problem creating html page with the button?"}], "answers": [{"tags": [], "owner": {"reputation": 15, "user_id": 10868873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36656276f7e8edd7556b827bb3fc8d29?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/10868873/kevin"}, "is_accepted": false, "score": 0, "last_activity_date": 1553886292, "creation_date": 1553886292, "answer_id": 55424039, "question_id": 55386272, "link": "https://stackoverflow.com/questions/55386272/how-to-use-aws-go-sdk-with-restful-api/55424039#55424039", "title": "How to use AWS GO SDK with RESTful API?", "body": "<p>I ended up solving the problem...I just didn't understand the syntaxes of golang and aws sdk.  But I was able to spin an ami using a button.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n\n    \"github.com/aws/aws-sdk-go/aws\"\n    \"github.com/aws/aws-sdk-go/aws/session\"\n    \"github.com/aws/aws-sdk-go/service/ec2\"\n    \"github.com/gorilla/mux\"\n)\n\nfunc createInstance(w http.ResponseWriter, r *http.Request) {\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    sess, err := session.NewSession(&amp;aws.Config{\n        Region: aws.String(\"us-west-1\")},\n    )\n\n    // Create EC2 service client\n    svc := ec2.New(sess)\n\n    // Specify the details of the instance that you want to create.\n    runResult, err := svc.RunInstances(&amp;ec2.RunInstancesInput{\n        // An Amazon Linux AMI ID for t2.micro instances in the us-west-2 region\n        ImageId:      aws.String(\"ami-xxxxxx\"),\n        InstanceType: aws.String(\"t2.micro\"),\n        MinCount:     aws.Int64(1),\n        MaxCount:     aws.Int64(1),\n    })\n\n    if err != nil {\n        fmt.Println(\"Could not create instance\", err)\n        return\n    }\n\n    fmt.Println(\"Created instance\", *runResult.Instances[0].InstanceId)\n\n    // Add tags to the created instance\n    _, errtag := svc.CreateTags(&amp;ec2.CreateTagsInput{\n        Resources: []*string{runResult.Instances[0].InstanceId},\n        Tags: []*ec2.Tag{\n            {\n                Key:   aws.String(\"Name\"),\n                Value: aws.String(\"test\"),\n            },\n        },\n    })\n    if errtag != nil {\n        log.Println(\"Could not create tags for instance\", runResult.Instances[0].InstanceId, errtag)\n        return\n    }\n}\n\nfunc main() {\n\n    r := mux.NewRouter() //init the router\n\n    fmt.Println(\"Successfully tagged instance\")\n\n\n    r.HandleFunc(\"/api/instance\", createInstance).Methods(\"GET\")\n    log.Fatal(http.ListenAndServe(\":8500\", r))\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10868873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36656276f7e8edd7556b827bb3fc8d29?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/10868873/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 474, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553886292, "creation_date": 1553720022, "last_edit_date": 1553741131, "question_id": 55386272, "link": "https://stackoverflow.com/questions/55386272/how-to-use-aws-go-sdk-with-restful-api", "title": "How to use AWS GO SDK with RESTful API?", "body": "<p>I am new to using AWS SDKs and building APIs.  However, I am trying to find a way to build an application where if I click a button on the web browser, I want it to trigger an amazon sdk Go function to build an AMI.  How can I go about this?</p>\n\n<p>I went through <a href=\"https://www.codementor.io/codehakase/building-a-restful-api-with-golang-a6yivzqdo\" rel=\"nofollow noreferrer\">this tutorial on RESTful API with Go</a>.  However, I am getting confused on how the the Amazon SDK GO functions will be working with the APIs. So I have something like the code below.  I just don't know if I am doing this correctly in terms of the high level.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"github.com/aws/aws-sdk-go/aws\"\n    \"github.com/aws/aws-sdk-go/aws/session\"\n    \"github.com/aws/aws-sdk-go/service/ec2\"\n    \"github.com/gorilla/mux\"\n    \"net/http\"\n)\n\nfunc (c *EC2) CreateLaunchTemplate(input *CreateLaunchTemplateInput) (*CreateLaunchTemplateOutput, error) {\n    // w.Header().Set(\"Content-Type\", \"application/json\")\n    svc := ec2.New(session.New())\n    input := &amp;ec2.CreateLaunchTemplateInput{\n        LaunchTemplateData: &amp;ec2.RequestLaunchTemplateData{\n            ImageId:      aws.String(\"ami-0cc142296677e2132\"),\n            InstanceType: aws.String(\"t2.micro\"),\n            NetworkInterfaces: []*ec2.LaunchTemplateInstanceNetworkInterfaceSpecificationRequest{\n                {\n                    AssociatePublicIpAddress: aws.Bool(true),\n                    DeviceIndex:              aws.Int64(0),\n                    Ipv6AddressCount:         aws.Int64(1),\n                    SubnetId:                 aws.String(\"subnet-03a04de08c5c6cb8e\"),\n                },\n            },\n            TagSpecifications: []*ec2.LaunchTemplateTagSpecificationRequest{\n                {\n                    ResourceType: aws.String(\"instance\"),\n                    Tags: []*ec2.Tag{\n                        {\n                            Key:   aws.String(\"Name\"),\n                            Value: aws.String(\"webserver\"),\n                        },\n                    },\n                },\n            },\n        },\n        LaunchTemplateName: aws.String(\"my-template\"),\n        VersionDescription: aws.String(\"WebVersion1\"),\n    }\n\n    result, err := svc.CreateLaunchTemplate(input)\n    if err != nil {\n        if aerr, ok := err.(awserr.Error); ok {\n            switch aerr.Code() {\n            default:\n                fmt.Println(aerr.Error())\n            }\n        } else {\n            // Print the error, cast err to awserr.Error to get the Code and\n            // Message from an error.\n            fmt.Println(err.Error())\n        }\n        return\n    }\n}\n\nfunc main() {\n    // Init Router\n    r := mux.NewRouter()\n\n    // Route Handlers / Endpoints\n    r.HandleFunc(\"/api/create_ami\", CreateLaunchTemplate).Methods(\"GET\")\n    log.Fatal(http.ListenAndServe(\":8000\", r))\n}\n</code></pre>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 7, "creation_date": 1553718505, "post_id": 55385894, "comment_id": 97493689, "body": "Never re-use a <code>http.Request</code> for multiple requests."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1553718813, "post_id": 55385894, "comment_id": 97493814, "body": "You&#39;re also not consuming or closing the response body."}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1553719223, "post_id": 55385894, "comment_id": 97494009, "body": "@Adrian out of curiosity, why shouldn&#39;t one reuse http requests?"}, {"owner": {"reputation": 421, "user_id": 5279759, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/de3fd7e849f1161ad666e44f6a001c84?s=128&d=identicon&r=PG&f=1", "display_name": "Fominykh Maxim", "link": "https://stackoverflow.com/users/5279759/fominykh-maxim"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1553719234, "post_id": 55385894, "comment_id": 97494016, "body": "@Adrian So, how can I achieve my goal not reusing http.Request? I need to get session id from header and than resend request with same body"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1553724178, "post_id": 55385894, "comment_id": 97496201, "body": "@MadWombat: you can reuse requests, but you must ensure that there are no outstanding calls with the same request: <code>Callers should not mutate or reuse the request until the Response&#39;s Body has been closed</code>."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1553775959, "post_id": 55385894, "comment_id": 97515237, "body": "@MadWombat it requires some care to do without causing yourself difficult-to-troubleshoot issues, and the cost of creating a new <code>Request</code> is relatively small."}], "answers": [{"tags": [], "owner": {"reputation": 1059, "user_id": 1982418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbe9fddd5823aa8ae6a41ec889f0f581?s=128&d=identicon&r=PG&f=1", "display_name": "sh.seo", "link": "https://stackoverflow.com/users/1982418/sh-seo"}, "is_accepted": false, "score": 0, "last_activity_date": 1553737660, "creation_date": 1553737660, "answer_id": 55389004, "question_id": 55385894, "link": "https://stackoverflow.com/questions/55385894/http-contentlength-99-with-body-length-0/55389004#55389004", "title": "http: ContentLength=99 with Body length 0", "body": "<p>Create a request and use it.</p>\n\n<pre><code>func do(r *http.Request) (response *http.Response, err error) {\n    r.Header.Set(SessionHeader, client.SessionId)\n    response, err = client.Do(r)\n    if err != nil {\n        return nil, err\n    }\n\n    if response.StatusCode == http.StatusConflict {\n        // Get SessionId\n        client.SessionId = response.Header.Get(SessionHeader)\n\n        // Create Request\n        req, err := http.NewRequest(\"GET\", \"http://example.com\", nil)   \n        req.Header.Set(\"SessionHeader\", client.SessionId)\n\n        response, err := client.Do(req)\n        if err != nil {\n            return nil, err\n        }\n        return\n    } else if response.StatusCode != http.StatusOK {\n        return nil, errors.New(\"status Not OK\")\n    }\n    return\n}\n</code></pre>\n"}], "owner": {"reputation": 421, "user_id": 5279759, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/de3fd7e849f1161ad666e44f6a001c84?s=128&d=identicon&r=PG&f=1", "display_name": "Fominykh Maxim", "link": "https://stackoverflow.com/users/5279759/fominykh-maxim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1270, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553737660, "creation_date": 1553718441, "question_id": 55385894, "link": "https://stackoverflow.com/questions/55385894/http-contentlength-99-with-body-length-0", "title": "http: ContentLength=99 with Body length 0", "body": "<p>I have this function to execute http request</p>\n\n<pre><code>func do(r *http.Request) (response *http.Response, e error) {\n    r.Header.Set(SessionHeader, client.SessionId)\n    response, e = client.Do(r)\n    if e != nil {\n        return nil, e\n    }\n    if response.StatusCode == http.StatusConflict {\n        client.SessionId = response.Header.Get(SessionHeader)\n        r.Header.Set(SessionHeader, client.SessionId)\n        response, e = client.Do(r)\n        if e != nil {\n            return nil, e\n        }\n        return\n    } else if response.StatusCode != http.StatusOK {\n        return nil, errors.New(\"status Not OK\")\n    }\n    return\n}\n</code></pre>\n\n<p>So I make a request, than if my session id is not valid, I set header from response and try again. The issue is that the Body got flushed when I do this and this error pops up: </p>\n\n<pre><code>Post http://localhost/api: http: ContentLength=99 with Body length 0\n</code></pre>\n\n<p>How can I workaround this problem?</p>\n"}, {"tags": ["go", "types", "compare"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 4, "creation_date": 1553716965, "post_id": 55385539, "comment_id": 97493001, "body": "First convert them back to <code>uint8</code> and then compare those uints."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 4, "creation_date": 1553718420, "post_id": 55385539, "comment_id": 97493667, "body": "Though this does raise the question of why these are different types; the point of creating primitive-based types is usually to distinguish them, meaning that comparing a <code>SomeID</code> to a <code>OtherID</code> shouldn&#39;t yield any meaningful result; like comparing a <code>time.Month</code> to a <code>time.Weekday</code>, which are both <code>int</code> but have different <i>meaning</i> and are therefore incomparable."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 1, "creation_date": 1553718597, "post_id": 55385539, "comment_id": 97493731, "body": "exactly - and usually one adds methods to a distinct type which ultimately define its unique characteristics."}, {"owner": {"reputation": 404, "user_id": 3762311, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/906179ac60029462255824c67b063bea?s=128&d=identicon&r=PG&f=1", "display_name": "octavio", "link": "https://stackoverflow.com/users/3762311/octavio"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1553770987, "post_id": 55385539, "comment_id": 97512161, "body": "@Adrian I agree, however this was part of an assignment so the problem is rather fabricated."}], "answers": [{"tags": [], "owner": {"reputation": 404, "user_id": 3762311, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/906179ac60029462255824c67b063bea?s=128&d=identicon&r=PG&f=1", "display_name": "octavio", "link": "https://stackoverflow.com/users/3762311/octavio"}, "is_accepted": true, "score": 3, "last_activity_date": 1553717615, "creation_date": 1553717615, "answer_id": 55385712, "question_id": 55385539, "link": "https://stackoverflow.com/questions/55385539/compare-two-values-of-different-type-but-identical-underlying-type/55385712#55385712", "title": "compare two values of different type (but identical underlying type)", "body": "<p>As mentioned by mkopriva, type-conversion is needed to compare the values.</p>\n\n<p><a href=\"https://tour.golang.org/basics/13\" rel=\"nofollow noreferrer\">https://tour.golang.org/basics/13</a></p>\n\n<pre><code>func areEqual(sid SomeID, oid OtherID) bool {\n   return uint8(sid) == uint8(oid)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 1, "last_activity_date": 1553778664, "creation_date": 1553778664, "answer_id": 55398499, "question_id": 55385539, "link": "https://stackoverflow.com/questions/55385539/compare-two-values-of-different-type-but-identical-underlying-type/55398499#55398499", "title": "compare two values of different type (but identical underlying type)", "body": "<p>You can be less accurate, you don't need to remember underlying type</p>\n\n<pre><code>func areEqual(sid SomeID, oid OtherID) bool {\n   return sid == SomeID(oid)\n}\n</code></pre>\n\n<p>And you can be more generic</p>\n\n<pre><code>func areEqual(x, y interface{}) (bool, error) {\n    xv := reflect.ValueOf(x)\n    yv := reflect.ValueOf(y)\n    if yv.Type().ConvertibleTo(xv.Type()) {\n        return xv.Interface() == yv.Convert(xv.Type()).Interface(), nil\n    } else {\n        return false, errors.New(\"Types are mismatched\")\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/L6kWlJjV-Ql\" rel=\"nofollow noreferrer\">Playground</a></p>\n"}], "owner": {"reputation": 404, "user_id": 3762311, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/906179ac60029462255824c67b063bea?s=128&d=identicon&r=PG&f=1", "display_name": "octavio", "link": "https://stackoverflow.com/users/3762311/octavio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 55385712, "answer_count": 2, "score": 0, "last_activity_date": 1553778664, "creation_date": 1553716825, "question_id": 55385539, "link": "https://stackoverflow.com/questions/55385539/compare-two-values-of-different-type-but-identical-underlying-type", "title": "compare two values of different type (but identical underlying type)", "body": "<p>How do I compare the values of two variables that have different types but the same underlying type.</p>\n\n<pre><code>type   SomeID    uint8\ntype   OtherID   uint8\n\nfunc areEqual(sid SomeID, oid OtherID) bool {\n   // error: mismatched types\n   return sid == oid\n}\n</code></pre>\n"}, {"tags": ["docker", "go", "dockerfile", "go-modules"], "comments": [{"owner": {"reputation": 1255, "user_id": 4982148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X52Wq.jpg?s=128&g=1", "display_name": "atakanyenel", "link": "https://stackoverflow.com/users/4982148/atakanyenel"}, "edited": false, "score": 0, "creation_date": 1553714667, "post_id": 55384975, "comment_id": 97491901, "body": "Take a look at multistage build from Docker. Another approach is build your dependencies in a different container, publish it , and use it as a base container for your application building container."}, {"owner": {"reputation": 1239, "user_id": 856769, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/691ecfb55a585a28ed57916b7cd1bd46?s=128&d=identicon&r=PG", "display_name": "nfirvine", "link": "https://stackoverflow.com/users/856769/nfirvine"}, "reply_to_user": {"reputation": 1255, "user_id": 4982148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X52Wq.jpg?s=128&g=1", "display_name": "atakanyenel", "link": "https://stackoverflow.com/users/4982148/atakanyenel"}, "edited": false, "score": 0, "creation_date": 1553715277, "post_id": 55384975, "comment_id": 97492165, "body": "@atayenel I&#39;m using multistage builds, just don&#39;t think they&#39;re relevant?"}, {"owner": {"reputation": 1239, "user_id": 856769, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/691ecfb55a585a28ed57916b7cd1bd46?s=128&d=identicon&r=PG", "display_name": "nfirvine", "link": "https://stackoverflow.com/users/856769/nfirvine"}, "reply_to_user": {"reputation": 1255, "user_id": 4982148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X52Wq.jpg?s=128&g=1", "display_name": "atakanyenel", "link": "https://stackoverflow.com/users/4982148/atakanyenel"}, "edited": false, "score": 0, "creation_date": 1553715383, "post_id": 55384975, "comment_id": 97492229, "body": "@atayenel And I&#39;m not sure how base images help. Are you saying I could have a base image that has an old build with perhaps up to date dependencies? Building that base image has the same problem"}, {"owner": {"reputation": 1255, "user_id": 4982148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X52Wq.jpg?s=128&g=1", "display_name": "atakanyenel", "link": "https://stackoverflow.com/users/4982148/atakanyenel"}, "edited": false, "score": 0, "creation_date": 1553715497, "post_id": 55384975, "comment_id": 97492300, "body": "Yes, but you are not updating your deps too much( your words) , you just build it once and next iterations will use it until you update your deps again"}, {"owner": {"reputation": 21384, "user_id": 402053, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3d73332968c0bf62e1ece7299deb8b37?s=128&d=identicon&r=PG", "display_name": "JBaruch", "link": "https://stackoverflow.com/users/402053/jbaruch"}, "edited": false, "score": 0, "creation_date": 1553792893, "post_id": 55384975, "comment_id": 97527060, "body": "keep an eye open on the process of modularizing K8S. Once that&#39;s done, using a local module repository (like Athens or Artifactory) and a central module repository (like GoCenter) wil do magic to your build times."}, {"owner": {"reputation": 123770, "user_id": 2830850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48b39b77bf324de9aeefd6c5bfc10c6?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Lalwani", "link": "https://stackoverflow.com/users/2830850/tarun-lalwani"}, "reply_to_user": {"reputation": 4057, "user_id": 1914440, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/96950854138967a35884c26aeb048f3d?s=128&d=identicon&r=PG", "display_name": "fons", "link": "https://stackoverflow.com/users/1914440/fons"}, "edited": false, "score": 0, "creation_date": 1561186533, "post_id": 55384975, "comment_id": 99989057, "body": "@fons, why not use another builder docker image which is run to process the build. So instead of using <code>docker build</code>, you use <code>docker run</code> to create a build inside docker image. This gives you a chance to save the build cache back to the host and re-use those folders during the next build"}], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1553716458, "post_id": 55385246, "comment_id": 97492759, "body": "May be a bit less of a hack would be to override <code>GOCACHE</code> before building the deps in such a way so that they end up being a part of your Docker build context, then copy them over, and then override this env. var accordingly in the image. Please see <a href=\"https://golang.org/doc/go1.11#gocache\" rel=\"nofollow noreferrer\">this</a> and follow the links. Note that the <code>-x</code> command-line option to the <code>go {build|install}</code> commands makes them chatty about what they are doing (and where they look for files etc)."}, {"owner": {"reputation": 1239, "user_id": 856769, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/691ecfb55a585a28ed57916b7cd1bd46?s=128&d=identicon&r=PG", "display_name": "nfirvine", "link": "https://stackoverflow.com/users/856769/nfirvine"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1553719184, "post_id": 55385246, "comment_id": 97493983, "body": "@kostix that&#39;s not a bad idea. I&#39;m running on a Mac though. I assume <code>GOCACHE</code> isn&#39;t platform independent?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1553790182, "post_id": 55385246, "comment_id": 97525489, "body": "It&#39;s dependent in the sense the location of the user&#39;s home directory is. But note that the <code>go</code> tool has a built-in default for this variable (whih can be known by running <code>go env</code> or <code>go env GOCACHE</code>), and this default can be overridden by the environment variable with the same name. (It actually works for any variable known by <code>go env</code>)."}, {"owner": {"reputation": 1239, "user_id": 856769, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/691ecfb55a585a28ed57916b7cd1bd46?s=128&d=identicon&r=PG", "display_name": "nfirvine", "link": "https://stackoverflow.com/users/856769/nfirvine"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1554149230, "post_id": 55385246, "comment_id": 97637897, "body": "I mean platform-dependent as in &quot;packages compiled in the cache for darwin won&#39;t work on Linux&quot;. Surely those aren&#39;t portable between OSes."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1554205329, "post_id": 55385246, "comment_id": 97658294, "body": "I beleive &quot;it&#39;s not true either way&quot; ;-) The reason is that the compiled packages are not merely lumped in a common place but are rather separated there by the <code>GOOS</code> and <code>GOARCH</code> under which they were built. It means two things: 1) packages compiled natively on Mac OS won&#39;t &quot;spoil&quot; the cache mounted on Linux as the compiler told to build native code <i>there</i> simply won&#39;t make use of those cached packages; 2) Packages <i>cross-compiled</i> on MacOS X, can be used in the image."}, {"owner": {"reputation": 4057, "user_id": 1914440, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/96950854138967a35884c26aeb048f3d?s=128&d=identicon&r=PG", "display_name": "fons", "link": "https://stackoverflow.com/users/1914440/fons"}, "edited": false, "score": 0, "creation_date": 1561537645, "post_id": 55385246, "comment_id": 100092510, "body": "Another problem with this solution is that the go compiler and git are required to be installed in the host OS"}], "tags": [], "owner": {"reputation": 1239, "user_id": 856769, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/691ecfb55a585a28ed57916b7cd1bd46?s=128&d=identicon&r=PG", "display_name": "nfirvine", "link": "https://stackoverflow.com/users/856769/nfirvine"}, "is_accepted": false, "score": 2, "last_activity_date": 1553715896, "last_edit_date": 1553715896, "creation_date": 1553715575, "answer_id": 55385246, "question_id": 55384975, "link": "https://stackoverflow.com/questions/55384975/build-go-dependencies-in-separate-docker-layer/55385246#55385246", "title": "Build go dependencies in separate Docker layer", "body": "<p>I've got a nasty hack that seems to work:</p>\n\n<pre><code>FROM golang:1.12\n\nWORKDIR /src\n\nCOPY go.mod go.sum ./\nCOPY vendor/ ./vendor\nRUN go build -mod=vendor $(cat deps|grep -v mypackage | grep -v internal)\n\nCOPY . .\nRUN go build -mod=vendor\n...\n</code></pre>\n\n<pre><code>go list -f '{{join .Deps \"\\n\"}}'  &gt; deps\ndocker build .\n</code></pre>\n"}], "owner": {"reputation": 1239, "user_id": 856769, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/691ecfb55a585a28ed57916b7cd1bd46?s=128&d=identicon&r=PG", "display_name": "nfirvine", "link": "https://stackoverflow.com/users/856769/nfirvine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 817, "favorite_count": 4, "answer_count": 1, "score": 7, "last_activity_date": 1561132457, "creation_date": 1553714424, "last_edit_date": 1553732771, "question_id": 55384975, "link": "https://stackoverflow.com/questions/55384975/build-go-dependencies-in-separate-docker-layer", "title": "Build go dependencies in separate Docker layer", "body": "<p>I'm trying to speed up Docker builds of my Go app. Right now, it's spending maybe 60s just building dependencies (it's a k8s controller, so there are a lot).</p>\n\n<p>One very important constraint: my project depends on private GitHub repos. I do <code>go mod vendor</code> outside <code>docker build</code>, where I have creds for the repos set up.</p>\n\n<p>My Dockerfile right now is roughly:</p>\n\n<pre><code>FROM golang:1.12\n\nWORKDIR /src\n\nCOPY . .\nRUN go build -mod=vendor\n...\n</code></pre>\n\n<p>Even without having to download the deps, that build takes a while because it rebuilds several hundred packages every <code>docker build</code>.</p>\n\n<p>What I'd like to do is something like:</p>\n\n<pre><code>FROM golang:1.12\n\nWORKDIR /src\n\n# these shouldn't change very often\nCOPY go.mod go.sum vendor ./\nRUN go build -mod=vendor &lt;all dependency packages&gt;\n\nCOPY . .\nRUN go build -mod=vendor\n...\n</code></pre>\n\n<p>I tried parsing <code>go.mod</code>, but of course that lists modules, not packages. I tried <code>go list</code> but never managed to get a working incantation.</p>\n"}, {"tags": ["go", "go-present"], "answers": [{"comments": [{"owner": {"reputation": 590, "user_id": 6212718, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38f617dbb24ae7c83790fb981650f6d4?s=128&d=identicon&r=PG&f=1", "display_name": "FredMaster", "link": "https://stackoverflow.com/users/6212718/fredmaster"}, "edited": false, "score": 0, "creation_date": 1554891229, "post_id": 55403292, "comment_id": 97914522, "body": "Thanks for your answer. However, I am a bit lost. Is there a css file that I could modify. Or what do you mean with &quot;modify library files directly&quot;."}], "tags": [], "owner": {"reputation": 8750, "user_id": 1771556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XPkeq.jpg?s=128&g=1", "display_name": "Vadim Ashikhman", "link": "https://stackoverflow.com/users/1771556/vadim-ashikhman"}, "is_accepted": true, "score": 2, "last_activity_date": 1553792817, "creation_date": 1553792817, "answer_id": 55403292, "question_id": 55384207, "link": "https://stackoverflow.com/questions/55384207/how-do-i-customize-go-present-template/55403292#55403292", "title": "How do I customize go-present template?", "body": "<p>I found that the only way to change presentation styles is to modify library files directly.</p>\n\n<p>If you use <code>vgo</code>:</p>\n\n<pre><code>$GOPATH/pkg/mod/golang.org/x/tools@&lt;version&gt;/cmd/present\n</code></pre>\n\n<p>Otherwise:</p>\n\n<pre><code>$GOPATH/src/golang.org/x/tools/cmd/present\n</code></pre>\n\n<p>Of cause first you need to download <code>present</code> package: <code>go get golang.org/x/tools/cmd/present</code></p>\n"}, {"tags": [], "owner": {"reputation": 105, "user_id": 1183146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bcbddfe8cd54a7b758f492b600baa2?s=128&d=identicon&r=PG", "display_name": "wlbr", "link": "https://stackoverflow.com/users/1183146/wlbr"}, "is_accepted": false, "score": 2, "last_activity_date": 1580688105, "creation_date": 1580688105, "answer_id": 60031750, "question_id": 55384207, "link": "https://stackoverflow.com/questions/55384207/how-do-i-customize-go-present-template/60031750#60031750", "title": "How do I customize go-present template?", "body": "<p>Let's assume you have a directory <code>myslides</code> with some .slide files in it. </p>\n\n<ol>\n<li>Create a subfolder <code>theme</code> in <code>myslides</code>.</li>\n<li>Copy the folders <code>template</code> and <code>static</code> from  $GOPATH/src/golang.org/x/tools/cmd/present to that new <code>theme</code> directory</li>\n<li>Start <code>present</code> with a new parameter -base: <code>present -base theme</code></li>\n</ol>\n\n<p>Modify the styles and template files. Most small things are in <code>styles.css</code>. </p>\n\n<p>If you change the template files, then you need to stop and restart <code>present</code>. If your are changing the styles only, then a reload in the browser will do (take care to disable the cache.)</p>\n"}], "owner": {"reputation": 590, "user_id": 6212718, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38f617dbb24ae7c83790fb981650f6d4?s=128&d=identicon&r=PG&f=1", "display_name": "FredMaster", "link": "https://stackoverflow.com/users/6212718/fredmaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 55403292, "answer_count": 2, "score": 1, "last_activity_date": 1580688105, "creation_date": 1553711243, "last_edit_date": 1553719172, "question_id": 55384207, "link": "https://stackoverflow.com/questions/55384207/how-do-i-customize-go-present-template", "title": "How do I customize go-present template?", "body": "<p>I am new to Go and just stumbled upon Go's <code>present</code> package which I imported via <code>go get golang.org/x/tools/present</code>.</p>\n\n<p>Is there any way to customize the look of the presentation? E.g. via adjusting the default css file? </p>\n\n<p>If so where are the files used for the style? I cannot find the package anywhere in my Go path... </p>\n"}, {"tags": ["javascript", "html", "go"], "comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1553713770, "post_id": 55383686, "comment_id": 97491501, "body": "You need to post your go-code snippet.  Not being familiar with this pkg, I would suspect one marshals form data into a struct - since forms have many fields - and marshaling into a single string will not work."}, {"owner": {"reputation": 153, "user_id": 3051040, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/50791649b689432db71eb363eaecc9db?s=128&d=identicon&r=PG&f=1", "display_name": "user3051040", "link": "https://stackoverflow.com/users/3051040/user3051040"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 1, "creation_date": 1553716238, "post_id": 55383686, "comment_id": 97492653, "body": "@colminator just updated, you should be able to copy/paste, <code>go build</code> and get the exact error. Make sure you&#39;ve got Chrome installed."}, {"owner": {"reputation": 1255, "user_id": 4982148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X52Wq.jpg?s=128&g=1", "display_name": "atakanyenel", "link": "https://stackoverflow.com/users/4982148/atakanyenel"}, "edited": false, "score": 2, "creation_date": 1553716399, "post_id": 55383686, "comment_id": 97492738, "body": "should html be something like <code>MACADD.value</code> ?"}, {"owner": {"reputation": 153, "user_id": 3051040, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/50791649b689432db71eb363eaecc9db?s=128&d=identicon&r=PG&f=1", "display_name": "user3051040", "link": "https://stackoverflow.com/users/3051040/user3051040"}, "reply_to_user": {"reputation": 1255, "user_id": 4982148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X52Wq.jpg?s=128&g=1", "display_name": "atakanyenel", "link": "https://stackoverflow.com/users/4982148/atakanyenel"}, "edited": false, "score": 0, "creation_date": 1553717129, "post_id": 55383686, "comment_id": 97493082, "body": "@atayenel GENIUS. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 3051040, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/50791649b689432db71eb363eaecc9db?s=128&d=identicon&r=PG&f=1", "display_name": "user3051040", "link": "https://stackoverflow.com/users/3051040/user3051040"}, "edited": false, "score": 1, "creation_date": 1553717209, "post_id": 55385590, "comment_id": 97493123, "body": "I just changed <code>JSBINDFUNC(MACADD)</code> to <code>JSBINDFUNC(MACADD.value)</code> per @atayenel. This works."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "reply_to_user": {"reputation": 153, "user_id": 3051040, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/50791649b689432db71eb363eaecc9db?s=128&d=identicon&r=PG&f=1", "display_name": "user3051040", "link": "https://stackoverflow.com/users/3051040/user3051040"}, "edited": false, "score": 1, "creation_date": 1553717281, "post_id": 55385590, "comment_id": 97493156, "body": "I justed edited the answer to reflect @atayenel shorter suggestion"}, {"owner": {"reputation": 1255, "user_id": 4982148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X52Wq.jpg?s=128&g=1", "display_name": "atakanyenel", "link": "https://stackoverflow.com/users/4982148/atakanyenel"}, "edited": false, "score": 2, "creation_date": 1553717372, "post_id": 55385590, "comment_id": 97493194, "body": "I like lorca. I&#39;m glad it was html problem and not a lorca problem :)"}], "tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": true, "score": 3, "last_activity_date": 1553717444, "last_edit_date": 1553717444, "creation_date": 1553717066, "answer_id": 55385590, "question_id": 55383686, "link": "https://stackoverflow.com/questions/55383686/json-cannot-unmarshal-object-into-go-value-of-type-string/55385590#55385590", "title": "JSON cannot unmarshal object into GO value of type string", "body": "<p>The issue is with your javascript. Update your onclick attribute like so:</p>\n\n<pre><code>&lt;input type=\"submit\" value=\"Submit\" onclick=\"JSBINDFUNC(MACADD.value)\"&gt;\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 3051040, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/50791649b689432db71eb363eaecc9db?s=128&d=identicon&r=PG&f=1", "display_name": "user3051040", "link": "https://stackoverflow.com/users/3051040/user3051040"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1561, "favorite_count": 0, "accepted_answer_id": 55385590, "answer_count": 1, "score": 2, "last_activity_date": 1553717444, "creation_date": 1553709256, "last_edit_date": 1553716191, "question_id": 55383686, "link": "https://stackoverflow.com/questions/55383686/json-cannot-unmarshal-object-into-go-value-of-type-string", "title": "JSON cannot unmarshal object into GO value of type string", "body": "<p>Writing Golang app using <code>github.com/zserge/lorca</code> package.\nThis binds golang funcs to Javascript.\nI have HTML with text input and submit button which should pass the text input as an arg into the Javascript binding. It looks as follows:</p>\n\n<pre><code>&lt;input type=\"text\" name=\"MACADD\" style=\"height:20px; width:210px\"&gt;\n&lt;input type=\"submit\" value=\"submit\" onclick=\"JSBINDFUNC(MACADD)\"&gt;\n</code></pre>\n\n<p>The <code>JSBINDFUNC</code> takes golang type <code>string</code> for input. \nWhen I hit submit, it should be passing the text entered for <code>MACADD</code> as an arg into the <code>JSBINDFUNC</code> func. </p>\n\n<p>However, I'm coming back with the err </p>\n\n<pre><code>exception\":{\"type\":\"string\",\"value\":\"json: cannot unmarshal object into Go value of type string\"}\n</code></pre>\n\n<p>Needing this <code>object</code> to become golang <code>string</code>.</p>\n\n<p>More complete snip:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/url\"\n\n    \"github.com/zserge/lorca\"\n)\n\nfunc main() {\n    ui, err := lorca.New(\"data:text/html,\"+url.PathEscape(`\n        &lt;html&gt;\n                &lt;form action=\"/action_page.php\"&gt;\n                    MAC Address:&lt;br&gt;\n                    &lt;input type=\"text\" name=\"MACADD\" style=\"height:20px; width:210px\"&gt;\n                    &lt;input type=\"submit\" value=\"Submit\" onclick=\"JSBINDFUNC(MACADD)\"&gt;\n                &lt;/form&gt; \n            &lt;/body&gt;\n        &lt;/html&gt;\n        `), \"\", 480, 320)\n    if err != nil {\n        log.Fatal(err)\n    }\n    //ui.Bind implemented @ https://github.com/zserge/lorca/blob/master/ui.go#L110\n    ui.Bind(\"JSBINDFUNC\", func(MAC string) {\n        fmt.Println(MAC)\n        return\n    })\n    defer ui.Close()\n    &lt;-ui.Done()\n}\n\n</code></pre>\n"}, {"tags": ["docker", "go", "kubernetes"], "answers": [{"tags": [], "owner": {"reputation": 1914, "user_id": 9811969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/184e2e46b8d8b8c483c85589709b8563?s=128&d=identicon&r=PG&f=1", "display_name": "Nik", "link": "https://stackoverflow.com/users/9811969/nik"}, "is_accepted": true, "score": 3, "last_activity_date": 1553707997, "creation_date": 1553707997, "answer_id": 55383345, "question_id": 55383082, "link": "https://stackoverflow.com/questions/55383082/go-vs-java-garbage-collector-for-micro-services/55383345#55383345", "title": "go vs java garbage collector for micro-services", "body": "<p>10ms in Go GC is outdated. </p>\n\n<p><a href=\"https://i.stack.imgur.com/165gA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/165gA.png\" alt=\"enter image description here\"></a>Last time GC was improved in Go 1.10 (Feb 2018)</p>\n\n<p>Regarding STW:</p>\n\n<blockquote>\n  <p>We now have an objective of 500 microseconds stop the world pause per GC cycle. Perhaps a little sandbagging here.</p>\n</blockquote>\n\n<p>See <a href=\"https://blog.golang.org/ismmkeynote\" rel=\"nofollow noreferrer\">https://blog.golang.org/ismmkeynote</a></p>\n"}], "owner": {"reputation": 4234, "user_id": 612258, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/kvtkZ.png?s=128&g=1", "display_name": "Illusionist", "link": "https://stackoverflow.com/users/612258/illusionist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2165, "favorite_count": 0, "closed_date": 1553786487, "accepted_answer_id": 55383345, "answer_count": 1, "score": 0, "last_activity_date": 1553707997, "creation_date": 1553707105, "question_id": 55383082, "link": "https://stackoverflow.com/questions/55383082/go-vs-java-garbage-collector-for-micro-services", "closed_reason": "Duplicate", "title": "go vs java garbage collector for micro-services", "body": "<p>I was told that Go's garbage collector does not cause interruptions in the program unlike Java's garbage collector which can cause a program to pause. This makes Go's much superior for latency sensitive micro-services.</p>\n\n<p>I tried understanding this but not being an expert, I did not. I found some stuff like -\nsub 10ms latency <a href=\"https://groups.google.com/forum/?fromgroups#!topic/golang-dev/Ab1sFeoZg_8\" rel=\"nofollow noreferrer\">https://groups.google.com/forum/?fromgroups#!topic/golang-dev/Ab1sFeoZg_8</a></p>\n\n<p>In general, are there reasons where Go is a superior choice for designing micro-services running on docker/kubernetes compared to Java (I know that until Java 9,  Java only understood memory and cpu resources at a host level. which meant that it made assumptions about sizing thread pools and memory allocations and Docker wouldn't always provide these resources).  </p>\n"}, {"tags": ["go", "kubernetes"], "comments": [{"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1553708924, "post_id": 55382345, "comment_id": 97489030, "body": "Not sure what you are asking, you code seems to be working just fine. If you want to get a specific service, you could use the <code>metav1.ListOptions</code> to add some selection criteria."}, {"owner": {"reputation": 115, "user_id": 839264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fa5cb1591bb67887ec340ba005ee0d0?s=128&d=identicon&r=PG", "display_name": "user839264", "link": "https://stackoverflow.com/users/839264/user839264"}, "reply_to_user": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1553710563, "post_id": 55382345, "comment_id": 97489908, "body": "Can&#39;t this be done without BuildConfigFromFlags() and NewForConfig(). AFAIK, these will involve the configuration to be loaded parsed (not sure if i m correct). If there is more efficient way, please let me know. My quest was that."}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1553717448, "post_id": 55382345, "comment_id": 97493224, "body": "No, this is how the API works. You load your cluster configuration from your kube config, you initialize a client using the config and then you call API methods to get the information you need. It is similar in other languages as well, it is not just Go"}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1553717672, "post_id": 55382345, "comment_id": 97493322, "body": "This is exactly what kubectl does every time you run it. It reads your configuration, authenticates with the cluster and then executes the APIs"}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1553717717, "post_id": 55382345, "comment_id": 97493350, "body": "If you are going to call the APIs many times in the same program, yes, you should initialize the client once and then pass a reference to it whenever you need to call something."}, {"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1553732989, "post_id": 55382345, "comment_id": 97498691, "body": "Can you just directly use the <a href=\"https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/\" rel=\"nofollow noreferrer\">DNS name</a> <code>SVC.NS.svc.cluster.local</code>?"}], "owner": {"reputation": 115, "user_id": 839264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fa5cb1591bb67887ec340ba005ee0d0?s=128&d=identicon&r=PG", "display_name": "user839264", "link": "https://stackoverflow.com/users/839264/user839264"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553704699, "creation_date": 1553704699, "question_id": 55382345, "link": "https://stackoverflow.com/questions/55382345/extract-a-services-clusterip-using-go-in-kubernetes", "title": "Extract a service&#39;s clusterIP using go in kubernetes", "body": "<p>Suppose there is a service with name \"SVC\", running in namespace NS in kubernetes cluster. I need to extract its IP (i.e clusterIP)</p>\n\n<p>I could write some code (below), which works, but I think this approach should not be taken. As this code will be called frequently, loading config every time is a waste. How should I  better do it:</p>\n\n<pre><code>namespace := \"NS\"\nserviceName := \"SVC\"\nclusterIP := \"\"\n\nkubeconfig := filepath.Join(\n     os.Getenv(\"HOME\"), \".kube\", \"config\",\n)\n\nconfig, err := clientcmd.BuildConfigFromFlags(\"\", kubeconfig)\nif err != nil {\n    fmt.Println(\"BuildConfigFromFlags Failed\")\n    return string(\"\"), err\n}\n\nclientset, err := kubernetes.NewForConfig(config)\nif err != nil {\n    fmt.Println(\"NewForConfig Failed\")\n    return string(\"\"), err\n}\n\nsvcList, err :=  clientset.CoreV1().Services(namespace).List(metav1.ListOptions{\n    FieldSelector: \"metadata.name=\" + serviceName,\n    })\n\n//fmt.Printf(\"kubecofig: %s\\n\",kubeconfig)\n//fmt.Printf(\"config: %#v\", config)\n//fmt.Printf(\"nameSpaceList: %#v\", svcList)\nfor _, svc := range svcList.Items {\n    clusterIP = svc.Spec.ClusterIP\n    break\n}\n\nfmt.Printf(\"Service IP: %s\", clusterIP)\n</code></pre>\n\n<p>Is there a way I can write concise code like this and get my desired result. If there is a way to use  \"&amp;corev1.service\"  , can anybody please tell me how?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1553704394, "post_id": 55382177, "comment_id": 97486547, "body": "If the error says <i>&quot;interface {} is []interface {}, not map[string]interface {}&quot;</i> then maybe try to type-assert a <code>[]interface {}</code> value and not a map, e.g. <code>bid.([]interface{})[0]</code>."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1553704505, "post_id": 55382177, "comment_id": 97486610, "body": "See related questions <a href=\"https://stackoverflow.com/questions/48952116/get-value-of-struct-with-interfaces/48952864#48952864\">1</a>, <a href=\"https://stackoverflow.com/questions/42892984/how-to-unmarshal-the-pair-values-in-an-nested-array-by-json-for-golang\">2</a>, <a href=\"https://stackoverflow.com/questions/50297289/unmarshaling-json-into-a-type\">3</a>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1553704544, "post_id": 55382177, "comment_id": 97486634, "body": "There&#39;s a dozen other questions containing this exact error: <a href=\"https://stackoverflow.com/search?q=%5Bgo%5D+%22type+interface+%7B%7D+does+not+support+indexing%22\">stackoverflow.com/&hellip;</a> (and many dozens more with relevant answers)"}], "answers": [{"tags": [], "owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "is_accepted": false, "score": 3, "last_activity_date": 1553705506, "creation_date": 1553705506, "answer_id": 55382579, "question_id": 55382177, "link": "https://stackoverflow.com/questions/55382177/type-interface-does-not-support-indexing/55382579#55382579", "title": "type interface {} does not support indexing", "body": "<p>You need <strong>type assertion</strong>  <code>bid, ok := data[\"bids\"].([]interface{})</code><br>\nSee: <a href=\"https://stackoverflow.com/questions/38816843/explain-type-assertions-in-go\">Explain Type Assertions in Go</a></p>\n\n<p>Try this:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n    url := \"https://api.binance.com/api/v1/depth?symbol=RENBTC\"\n    a, err := http.Get(url)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    buf, err := ioutil.ReadAll(a.Body)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    var data map[string]interface{}\n    err = json.Unmarshal([]byte(buf), &amp;data)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    bid, ok := data[\"bids\"].([]interface{})\n    if !ok {\n        log.Fatal(\"not ok\")\n    }\n\n    s, ok := bid[0].([]interface{})\n    if !ok {\n        log.Fatal(\"not ok\")\n    }\n    fmt.Println(s)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[0.00000603 5122.00000000]\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11142463, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XZV28VkILmc/AAAAAAAAAAI/AAAAAAAAAA0/tlwSOx0W2O0/photo.jpg?sz=128", "display_name": "DevDongwon", "link": "https://stackoverflow.com/users/11142463/devdongwon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1925, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1553706015, "creation_date": 1553704193, "last_edit_date": 1553706015, "question_id": 55382177, "link": "https://stackoverflow.com/questions/55382177/type-interface-does-not-support-indexing", "title": "type interface {} does not support indexing", "body": "<p>I want to get values from <code>bid</code>.\nI've already tried <code>data.(map[string]interface{})</code> but It did not work.</p>\n\n<p>when I tried, It says: </p>\n\n<blockquote>\n  <p>\"interface conversion: interface {} is []interface {}, not map[string]interface {}\"</p>\n</blockquote>\n\n<p>Please help me...</p>\n\n<p>This is my code.</p>\n\n<pre><code>    url := \"https://api.binance.com/api/v1/depth?symbol=RENBTC\"\n    a, _ := http.Get(url)\n    e, _ := ioutil.ReadAll(a.Body)\n\n    var data map[string]interface{}\n\n    _ = json.Unmarshal([]byte(e), &amp;data)\n    bid := data[\"bids\"]\n    fmt.Println(bid[0])\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/C8cOU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/C8cOU.png\" alt=\"tooltip\"></a></p>\n"}, {"tags": ["go", "protocol-buffers", "grpc", "grpc-go"], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 1202542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/819ad7bd45ce8d3b5ada13285d1650e7?s=128&d=identicon&r=PG", "display_name": "Danny", "link": "https://stackoverflow.com/users/1202542/danny"}, "edited": false, "score": 0, "creation_date": 1553716112, "post_id": 55385294, "comment_id": 97492593, "body": "I did want to use those methods but I can&#39;t find examples on how to properly use them. So just for my knowledge for go as well what do I need to do to set that value?"}, {"owner": {"reputation": 680, "user_id": 7274408, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jp2HB.png?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/7274408/brad"}, "reply_to_user": {"reputation": 59, "user_id": 1202542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/819ad7bd45ce8d3b5ada13285d1650e7?s=128&d=identicon&r=PG", "display_name": "Danny", "link": "https://stackoverflow.com/users/1202542/danny"}, "edited": false, "score": 0, "creation_date": 1553716570, "post_id": 55385294, "comment_id": 97492809, "body": "If you do not want to get the nil pointer dereference anymore you can start by setting the slice type to []pb.GameHistory_Game (is it GameHistory_Game or GameHistory tho?)"}, {"owner": {"reputation": 680, "user_id": 7274408, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jp2HB.png?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/7274408/brad"}, "reply_to_user": {"reputation": 59, "user_id": 1202542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/819ad7bd45ce8d3b5ada13285d1650e7?s=128&d=identicon&r=PG", "display_name": "Danny", "link": "https://stackoverflow.com/users/1202542/danny"}, "edited": false, "score": 0, "creation_date": 1553716825, "post_id": 55385294, "comment_id": 97492919, "body": "for <code>Marshal</code> you need an object of the type generated by compiling your protobufs in go code (with protoc), the method returns a byte slice which stores the message. And for <code>Unmarshal</code> you need the byte slice which stores the protbuf message and an object of the the type generated by compiling your protobufs in go code (with protoc), eg. err := proto.Unmarshal(protoMessageBytes, objectToStoreDecodedDataInto)"}, {"owner": {"reputation": 680, "user_id": 7274408, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jp2HB.png?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/7274408/brad"}, "reply_to_user": {"reputation": 59, "user_id": 1202542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/819ad7bd45ce8d3b5ada13285d1650e7?s=128&d=identicon&r=PG", "display_name": "Danny", "link": "https://stackoverflow.com/users/1202542/danny"}, "edited": false, "score": 0, "creation_date": 1553717699, "post_id": 55385294, "comment_id": 97493335, "body": "you can also do this to keep <code>games</code> as type slice of pointers and do this instead <code>games[i]=&amp;pb.GameHistory{GameID: gameHistory.Games[i].GameID}</code>. I think this is what you want"}, {"owner": {"reputation": 59, "user_id": 1202542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/819ad7bd45ce8d3b5ada13285d1650e7?s=128&d=identicon&r=PG", "display_name": "Danny", "link": "https://stackoverflow.com/users/1202542/danny"}, "edited": false, "score": 0, "creation_date": 1553718485, "post_id": 55385294, "comment_id": 97493681, "body": "Well GameHistory_Game is the object generated with proto and the GameHistory has a struct Game that matches that. The problem is my data is coming to a go struct first then it is going to the proto generated struct. I looked at converting my Go struct to a byte array slice first but wasn&#39;t sure that was the correct approach."}, {"owner": {"reputation": 59, "user_id": 1202542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/819ad7bd45ce8d3b5ada13285d1650e7?s=128&d=identicon&r=PG", "display_name": "Danny", "link": "https://stackoverflow.com/users/1202542/danny"}, "edited": false, "score": 0, "creation_date": 1553719118, "post_id": 55385294, "comment_id": 97493948, "body": "Yep the last comment with <code>games[i]=&amp;pb.GameHistory{GameID: gameHistory.Games[i].GameID}</code> was what I needed thanks. I would love to get the marshal to work though so I&#39;ll look into that. Thanks much"}], "tags": [], "owner": {"reputation": 680, "user_id": 7274408, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jp2HB.png?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/7274408/brad"}, "is_accepted": true, "score": 3, "last_activity_date": 1553717891, "last_edit_date": 1553717891, "creation_date": 1553715755, "answer_id": 55385294, "question_id": 55381710, "link": "https://stackoverflow.com/questions/55381710/converting-internal-go-struct-array-to-protobuf-generated-pointer-array/55385294#55385294", "title": "Converting internal go struct array to protobuf generated pointer array", "body": "<p>Your <code>games</code> slice is initialized with nil values, as it's of type <code>[]*pb.GameHistory_Game</code> (slice of pointers to pb.GameGistory_Game - init value for pointer is nil). You want to access the <code>GameID</code> property of those elements. You should create them instead :</p>\n\n<pre><code>for i := range matchHistory.Matches {\n    games[i]=&amp;pb.GameHistory{GameID: gameHistory.Games[i].GameID}\n}\n</code></pre>\n\n<p>Also, I recommend taking a look over the go protobuf documentation, as you have the <a href=\"https://godoc.org/github.com/golang/protobuf/proto#Marshal\" rel=\"nofollow noreferrer\"><code>Marshal</code></a> and <a href=\"https://godoc.org/github.com/golang/protobuf/proto#Unmarshal\" rel=\"nofollow noreferrer\"><code>Unmarshal</code></a> methods there for decoding and encoding protobuf messages.</p>\n"}], "owner": {"reputation": 59, "user_id": 1202542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/819ad7bd45ce8d3b5ada13285d1650e7?s=128&d=identicon&r=PG", "display_name": "Danny", "link": "https://stackoverflow.com/users/1202542/danny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1971, "favorite_count": 0, "accepted_answer_id": 55385294, "answer_count": 1, "score": 1, "last_activity_date": 1555271058, "creation_date": 1553702735, "last_edit_date": 1555271058, "question_id": 55381710, "link": "https://stackoverflow.com/questions/55381710/converting-internal-go-struct-array-to-protobuf-generated-pointer-array", "title": "Converting internal go struct array to protobuf generated pointer array", "body": "<p>I'm trying to convert an internal type to the protobuf generated type and I can't get the array to convert. I'm new to go so I don't know all the methods that could help. But this is my attempt. When run this code I get</p>\n\n<blockquote>\n  <p>panic: runtime error: invalid memory address or nil pointer dereference\n  [signal SIGSEGV: segmentation violation code=0x1 addr=0x8 pc=0x86c724]</p>\n</blockquote>\n\n<p>along with a lot other byte data. I'm wondering what the best way to convert internal structs to the protobufs is. I think I'm having the most trouble with the protobuf generated code being pointers.</p>\n\n<p>Proto Definitions</p>\n\n<pre><code>message GameHistory {\n  message Game {\n    int64 gameId = 1;\n  }\n\n  repeated Game matches = 1;\n  string username = 2;\n}\n\nmessage GetRequest {\n  string username = 1;\n}\n\nmessage GetGameResponse {\n  GameHistory gameHistory = 1;\n}\n</code></pre>\n\n<p>Go Code</p>\n\n<pre><code>// GameHistory model\ntype GameHistory struct {\n  Game []struct {\n    GameID     int64  `json:\"gameId\"`\n  } `json:\"games\"`\n  UserName   string `json:\"username\"`\n}\n\nfunc constructGameHistoryResponse(gameHistory models.GameHistory) *pb.GetGameResponse {\n\n  games := make([]*pb.GameHistory_Game, len(gameHistory.Games))\n  for i := range matchHistory.Matches {\n    games[i].GameID = gameHistory.Games[i].GameID\n  }\n\n  res := &amp;pb.GetGameResponse{\n    GameHistory: &amp;pb.GameHistory{\n      Games:    games,\n    },\n  }\n}\n</code></pre>\n"}, {"tags": ["go", "gofmt"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1553700242, "post_id": 55380466, "comment_id": 97483852, "body": "The goal of <code>gofmt</code> is to standardize code style across all Go code; making it customizable would be in direct opposition to its goal."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 2, "creation_date": 1553700665, "post_id": 55380466, "comment_id": 97484152, "body": "&#171;Gofmt&#39;s style is no one&#39;s favorite, yet gofmt is everyone&#39;s favorite.&#187; From <a href=\"https://go-proverbs.github.io/\" rel=\"nofollow noreferrer\">there</a>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1553718686, "post_id": 55380466, "comment_id": 97493768, "body": "Yeah, <code>go</code> questions answered in the docs will generaly end up downvoted. Regarding your example, per godoc, the proper place for documentation is on the line preceding the declaration."}], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 5, "last_activity_date": 1553699646, "creation_date": 1553699646, "answer_id": 55380636, "question_id": 55380466, "link": "https://stackoverflow.com/questions/55380466/can-gofmt-accommodate-local-coding-standard-preferences/55380636#55380636", "title": "Can gofmt accommodate local coding standard preferences?", "body": "<blockquote>\n  <p>Can Go accommodate local coding standard preferences?</p>\n</blockquote>\n\n<p>No. You guessed correctly.</p>\n\n<p>(The whole reason for a standard is to have one, instead of one per person/organization.)</p>\n"}], "owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 55380636, "answer_count": 1, "score": -2, "last_activity_date": 1553700599, "creation_date": 1553699172, "last_edit_date": 1553700599, "question_id": 55380466, "link": "https://stackoverflow.com/questions/55380466/can-gofmt-accommodate-local-coding-standard-preferences", "title": "Can gofmt accommodate local coding standard preferences?", "body": "<p>I love the role that <code>gofmt</code> has in Go programming. We would rather, though, that the following:</p>\n\n<pre><code>func somefunc(\n    a *sometype, // Explanation of a\n    b int, // Explanation of b\n    longName float64, // Explanation of longName\n) {\n...\n</code></pre>\n\n<p>be able to be formatted like:</p>\n\n<pre><code>func somefunc(\n    a        *sometype, // Explanation of a\n    b        int,       // Explanation of b\n    longName float64,   // Explanation of longName\n) {\n...\n</code></pre>\n\n<p>similar to how structs are formatted, and keeping with our coding standards for other languages. Is there any provision for accommodating local preferences like these, or is this \"not the way we do things around here\"? I couldn't find any access to the patterns that <code>gofmt</code> uses, so my guess is \"no\".</p>\n"}, {"tags": ["go", "open-source"], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 3, "last_activity_date": 1553696548, "creation_date": 1553696548, "answer_id": 55379563, "question_id": 55379517, "link": "https://stackoverflow.com/questions/55379517/where-and-how-to-record-project-maintainers/55379563#55379563", "title": "Where and how to record project maintainers", "body": "<p>No. Go packages do not track the developer(s) or contributor(s) in any prescribed way.</p>\n\n<p>Of course you can always add them to a README, wiki, code comments, or other human-consumable information as you see fit.</p>\n"}], "owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1553697640, "creation_date": 1553696432, "last_edit_date": 1553697640, "question_id": 55379517, "link": "https://stackoverflow.com/questions/55379517/where-and-how-to-record-project-maintainers", "title": "Where and how to record project maintainers", "body": "<p>As developer, I want to know if there are best practices to put project maintainers inside a Go project. </p>\n\n<p>In php projects this can be done updating <code>composer.json</code> file with content similar to:</p>\n\n<pre><code>{\n    \"authors\": [\n        {\n            \"name\": \"Name Surname\",\n            \"email\": \"foo@bar.man\",\n            \"role\": \"Developer\"\n        }\n    ]\n}\n</code></pre>\n\n<p>Is there a standard Go alternative?</p>\n"}, {"tags": ["go", "import", "dockerfile"], "comments": [{"owner": {"reputation": 3315, "user_id": 1664109, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/JAlH9.jpg?s=128&g=1", "display_name": "RockOnGom", "link": "https://stackoverflow.com/users/1664109/rockongom"}, "edited": false, "score": 1, "creation_date": 1553694670, "post_id": 55378657, "comment_id": 97479886, "body": "Are you sure that you are copying host gopath into the image gopath directory?"}, {"owner": {"reputation": 29, "user_id": 11143335, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QTr1k0uQ2cE/AAAAAAAAAAI/AAAAAAAAJo8/MfGTdDcaruw/photo.jpg?sz=128", "display_name": "Prashant Patel", "link": "https://stackoverflow.com/users/11143335/prashant-patel"}, "reply_to_user": {"reputation": 3315, "user_id": 1664109, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/JAlH9.jpg?s=128&g=1", "display_name": "RockOnGom", "link": "https://stackoverflow.com/users/1664109/rockongom"}, "edited": false, "score": 0, "creation_date": 1553698199, "post_id": 55378657, "comment_id": 97482354, "body": "The code does get copied as go get tires to get io.sure from internet."}], "answers": [{"tags": [], "owner": {"reputation": 792, "user_id": 4330521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a5ac7663c2dc4b56e5e4f8723c3ca6b?s=128&d=identicon&r=PG", "display_name": "monofone", "link": "https://stackoverflow.com/users/4330521/monofone"}, "is_accepted": false, "score": 2, "last_activity_date": 1553694969, "creation_date": 1553694969, "answer_id": 55378990, "question_id": 55378657, "link": "https://stackoverflow.com/questions/55378657/how-to-import-package-if-the-code-is-not-hosted-on-internet/55378990#55378990", "title": "How to import package if the code is not hosted on internet", "body": "<p>The content of your <code>$GOPATH</code> differs between cli and Dockerimage in that your packages are not in the right place.</p>\n\n<p>You need to <code>RUN mkdir -p $GOPATH/src/io.sure</code> and <code>COPY ./party $GOPATH/src/io.sure/</code> to achieve the same layout in the Dockerimage like on the cli.</p>\n\n<p>You probably need to adapt the Paths but I hope you get the idea</p>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 11143335, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QTr1k0uQ2cE/AAAAAAAAAAI/AAAAAAAAJo8/MfGTdDcaruw/photo.jpg?sz=128", "display_name": "Prashant Patel", "link": "https://stackoverflow.com/users/11143335/prashant-patel"}, "is_accepted": false, "score": 0, "last_activity_date": 1556607924, "creation_date": 1556607924, "answer_id": 55915559, "question_id": 55378657, "link": "https://stackoverflow.com/questions/55378657/how-to-import-package-if-the-code-is-not-hosted-on-internet/55915559#55915559", "title": "How to import package if the code is not hosted on internet", "body": "<p>found the solution. modified Dockerfile. All dependencies are managed with Godep  </p>\n\n<p>changed workdir to /go/src/github.com/kubesure/party  </p>\n\n<p>added RUN echo \"[url \\\"git@github.com:\\\"]\\n\\tinsteadOf = <a href=\"https://github.com/\" rel=\"nofollow noreferrer\">https://github.com/</a>\" >>  </p>\n\n<hr>\n\n<pre><code>RUN echo \"[url \\\"git@github.com:\\\"]\\n\\tinsteadOf = https://github.com/\" &gt;&gt; /root/.gitconfig\nRUN apk update &amp;&amp; apk add --no-cache git\nWORKDIR /go/src/github.com/kubesure/party\nCOPY . .\nRUN CGO_ENABLED=0 go install\n\nFROM scratch\nWORKDIR /opt\nCOPY --from=builder /go/bin/party .\nEXPOSE 50051\nCMD [\"/opt/party\"]\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 11143335, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QTr1k0uQ2cE/AAAAAAAAAAI/AAAAAAAAJo8/MfGTdDcaruw/photo.jpg?sz=128", "display_name": "Prashant Patel", "link": "https://stackoverflow.com/users/11143335/prashant-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 373, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1556607924, "creation_date": 1553694005, "last_edit_date": 1556607694, "question_id": 55378657, "link": "https://stackoverflow.com/questions/55378657/how-to-import-package-if-the-code-is-not-hosted-on-internet", "title": "How to import package if the code is not hosted on internet", "body": "<p>I have a package structure </p>\n\n<pre><code>$GOPATH/src/io.sure/api/proto/vi/party.pb.go\n        .../io.sure/party/party.go\n        ../io.sure/Dockerfile\n</code></pre>\n\n<p>import of party.go are</p>\n\n<pre><code>import (  \n    \"context\"\n    \"google.golang.org/grpc\"\n    \"io.sure/api/proto/v1\"\n    \"log\"\n    \"net\"\n)\n\n</code></pre>\n\n<pre><code>FROM golang:1.12.1-alpine AS builder   \nRUN apk update &amp;&amp; apk add --no-cache git   \nWORKDIR /go/src/app  \nCOPY ./party/ .  \nCOPY ./api/ .  \nRUN go get -d -v  \nRUN CGO_ENABLED=0 go install\n\nFROM scratch  \nWORKDIR /opt  \nCOPY --from=builder /go/bin/app .  \nENTRYPOINT [\"/opt/app\"] \n\n</code></pre>\n\n<p>The code compiles and runs from a command line. But when I build a docker image, go get tries to download io.sure/api/proto/v1 even when i have a copied the api folder in the docker image. How can i stop/skip downloading the package, as I do not have the code on github or any other public repo. </p>\n\n<p>Is vendoring a right thing to do, since its my own package which may not be exported or exported to outside world.</p>\n\n<p>I tried go modules but i am facing issues and still want to work with GOPATH.</p>\n\n<hr>\n\n<p>ried both the combinations but still the same error. code does get copied in image gopath.</p>\n\n<p>FROM golang:1.12.1-alpine AS builder\nRUN apk update &amp;&amp; apk add --no-cache git\nWORKDIR $GOPATH/src/io.sure\nCOPY ./party/ .\nCOPY ./api/ .\nRUN go get -d -v\nRUN CGO_ENABLED=0 go install</p>\n\n<p>FROM scratch\nWORKDIR /opt\nCOPY --from=builder /go/bin/app .\nENTRYPOINT [\"/opt/app\"]</p>\n\n<p>FROM golang:1.12.1-alpine AS builder\nRUN apk update &amp;&amp; apk add --no-cache git\nWORKDIR $GOPATH/src\nRUN mkdir -p $GOPATH/src/io.sure\nCOPY ./party/ .\nCOPY ./api/ .\nRUN go get -d -v\nRUN CGO_ENABLED=0 go install</p>\n\n<p>FROM scratch\nWORKDIR /opt\nCOPY --from=builder /go/bin/app .\nENTRYPOINT [\"/opt/app\"]\nFetching <a href=\"https://io.sure/api/proto/v1/party?go-get=1\" rel=\"nofollow noreferrer\">https://io.sure/api/proto/v1/party?go-get=1</a> https fetch failed: Get <a href=\"https://io.sure/api/proto/v1/party?go-get=1\" rel=\"nofollow noreferrer\">https://io.sure/api/proto/v1/party?go-get=1</a>: dial tcp: lookup io.sure on xxx.xx.0.2:53: no such host package io.sure/api/proto/v1/party: unrecognized import path \"io.sure/api/proto/v1/party\" (https fetch: Get <a href=\"https://io.sure/api/proto/v1/party?go-get=1\" rel=\"nofollow noreferrer\">https://io.sure/api/proto/v1/party?go-get=1</a>: dial tcp: lookup io.sure on xxx.31.0.2:53: no such host)</p>\n"}, {"tags": ["go", "abstract-syntax-tree", "static-analysis"], "comments": [{"owner": {"reputation": 333, "user_id": 1147580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4db449008a79953ec67e3120b1bc2239?s=128&d=identicon&r=PG", "display_name": "yazgazan", "link": "https://stackoverflow.com/users/1147580/yazgazan"}, "edited": false, "score": 0, "creation_date": 1553697780, "post_id": 55377694, "comment_id": 97482042, "body": "Did you try to use the &quot;ast&quot;.File.Imports along with &quot;go/importer&quot;.Default() ?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1553700293, "post_id": 55377694, "comment_id": 97483882, "body": "You can do this using the AST alone if you are looking for calls like <code>pkgname.FuncName()</code>.  You will need to resolve the identifiers (using NewPackage?).  From there, you can dig into SelectorExpr.X to find the package.  Otherwise, use go/types."}], "answers": [{"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": false, "score": 4, "last_activity_date": 1553699274, "creation_date": 1553699274, "answer_id": 55380494, "question_id": 55377694, "link": "https://stackoverflow.com/questions/55377694/how-to-find-full-package-import-from-callexpr/55380494#55380494", "title": "How to find full package import from CallExpr", "body": "<p>To get fully qualified names, the code has to be type checked with the go/types package.</p>\n\n<p><a href=\"https://github.com/golang/example/tree/master/gotypes#introduction\" rel=\"nofollow noreferrer\">The go/types article by Alan Donovan</a> goes into great detail on how to use the type checker properly, but here is the gist of it. I left a few type assertions in the Visit method for brevity. In production code you shouldn't assume specific node types.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"go/ast\"\n    \"go/importer\"\n    \"go/parser\"\n    \"go/token\"\n    \"go/types\"\n    \"log\"\n)\n\n// code to parse. It includes two variants of calling a package function.\nvar code = `package main\n\nimport (\n    foo \"io/ioutil\"\n    . \"io/ioutil\"\n)\n\nfunc main() {\n    foo.ReadFile(\"\")\n    ReadFile(\"\")\n}\n`\n\nfunc main() {\n    fset := &amp;token.FileSet{}\n    f, err := parser.ParseFile(fset, \"\", code, 0)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n\n    // info.Uses allows to lookup import paths for identifiers.\n    info := &amp;types.Info{\n        Uses: make(map[*ast.Ident]types.Object),\n    }\n\n    // Type check the parsed code using the default importer.\n    // Use golang.org/x/tools/go/loader to check a program\n    // consisting of multiple packages.\n    conf := types.Config{Importer: importer.Default()}\n\n    pkg, err := conf.Check(\"main\", fset, []*ast.File{f}, info)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // Do something with ast, info, and possibly pkg\n    var _ = pkg\n\n    ast.Walk(v{info}, f)\n}\n\ntype v struct {\n    info *types.Info\n}\n\nfunc (v v) Visit(node ast.Node) (w ast.Visitor) {\n    switch node := node.(type) {\n    case *ast.CallExpr:\n        // Get some kind of *ast.Ident for the CallExpr that represents the\n        // package. Then we can look it up in v.info. Where exactly it sits in\n        // the ast depends on the form of the function call.\n\n        switch node := node.Fun.(type) {\n        case *ast.SelectorExpr: // foo.ReadFile\n            pkgID := node.X.(*ast.Ident)\n            fmt.Println(v.info.Uses[pkgID].(*types.PkgName).Imported().Path())\n\n        case *ast.Ident:        // ReadFile\n            pkgID := node\n            fmt.Println(v.info.Uses[pkgID].Pkg().Path())\n        }\n    }\n\n    return v\n}\n\n// Output:\n// io/ioutil\n// io/ioutil\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11266371, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-B08ofuWKLKQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rehU0ufgSCHSEeQRuOzIo4jN7wlBA/mo/photo.jpg?sz=128", "display_name": "Reebok", "link": "https://stackoverflow.com/users/11266371/reebok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 649, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553699274, "creation_date": 1553691152, "question_id": 55377694, "link": "https://stackoverflow.com/questions/55377694/how-to-find-full-package-import-from-callexpr", "title": "How to find full package import from CallExpr", "body": "<p>The following method extracts all public method calls from the AST of a file. I need to find out the full package from the CallExpr, for example: ast.Inspect() is imported from \"go/ast\". I want to match the list of pkgsInclude strings with the imported package name:</p>\n\n<pre><code>func functionCalls(path string, node *ast.File, pkgsInclude []string) int {\n    fCalls := 0\n    ast.Inspect(node, func(n ast.Node) bool {\n        switch fCall := n.(type) {\n        case *ast.CallExpr:\n            if fun, ok := fCall.Fun.(*ast.SelectorExpr); ok {\n                if fun.Sel.IsExported() {\n                    fCalls += 1\n                }\n            }\n        }\n        return true\n    })\n    return fCalls\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1033, "user_id": 151631, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mxQxM.jpg?s=128&g=1", "display_name": "Lars", "link": "https://stackoverflow.com/users/151631/lars"}, "edited": false, "score": 1, "creation_date": 1553696423, "post_id": 55377567, "comment_id": 97481115, "body": "a different thing came to my mind while reading your question: The Datasource you are using is under CC License with a no-derivative restriction as visible on the footer of the page. You should ask the content holder of the data if you can use the data if your derivate is publicly available."}, {"owner": {"reputation": 956, "user_id": 1991104, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/85ff661bd29eee484f424b9a36007732?s=128&d=identicon&r=PG", "display_name": "Walter Schrabmair", "link": "https://stackoverflow.com/users/1991104/walter-schrabmair"}, "reply_to_user": {"reputation": 1033, "user_id": 151631, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mxQxM.jpg?s=128&g=1", "display_name": "Lars", "link": "https://stackoverflow.com/users/151631/lars"}, "edited": false, "score": 0, "creation_date": 1553698451, "post_id": 55377567, "comment_id": 97482551, "body": "@Lars thanks, but I need it only for inhouse - my derivate should not be used public"}], "owner": {"reputation": 956, "user_id": 1991104, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/85ff661bd29eee484f424b9a36007732?s=128&d=identicon&r=PG", "display_name": "Walter Schrabmair", "link": "https://stackoverflow.com/users/1991104/walter-schrabmair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553721636, "creation_date": 1553690807, "last_edit_date": 1553721636, "question_id": 55377567, "link": "https://stackoverflow.com/questions/55377567/what-is-the-equivalent-of-jquerys-n-th-child-method", "title": "What is the equivalent of jQuery&#39;s n-th child method?", "body": "<p>I try to program a first google go program. I got this working part:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"regexp\"\n\n    \"github.com/PuerkitoBio/goquery\"\n    \"github.com/gocolly/colly\"\n)\n\nfunc TrimSpaceNewlineInString(s string) string {\n    re := regexp.MustCompile(` +\\n+ +\\t+`)\n    return re.ReplaceAllString(s, \"\")\n}\n\nfunc main() {\n    args := os.Args[1:]\n    c := colly.NewCollector()\n    c.OnHTML(\"tr\",\n        func(e *colly.HTMLElement) {\n            ch := e.DOM.Children()\n            spalte1 := ch.Eq(0)\n            spalte2 := ch.Eq(1)\n\n            spalte1.Each(\n                func(_ int, s *goquery.Selection) {\n                    fmt.Print(TrimSpaceNewlineInString(s.Text()), \":\", TrimSpaceNewlineInString(spalte2.Text()))\n\n                })\n        })\n    c.Visit(\"https://deweysearchde.pansoft.de/webdeweysearch/executeSearch.html\" +\n        \"?lastScheduleRecord=669.1-669.7&amp;lastTableRecord=&amp;query=\" + args[0] + \"&amp;_showShortNotations=off&amp;catalogs=DNB&amp;_catalogs=off&amp;catalogs=GBV&amp;_catalogs=off&amp;catalogs=HeBIS&amp;_catalogs=off&amp;catalogs=SUB&amp;_catalogs=off&amp;catalogs=SWB&amp;_catalogs=off&amp;catalogs=FUB&amp;_catalogs=off\")\n}\n</code></pre>\n\n<p>But I only what to get the 2nd column, if this is in the range form [0-9.-] and if so than I would need the following 3rd column with the DDC Classification of this DOM HTMLElement talbe.\nI would like to retrieve following </p>\n\n<pre><code>            600;Technik\n            660;Chemische Verfahrenstechnik\n            669;Metallurgie\n            669.1-669.7;Metallurgie einzelner Metalle und deren Legierungen\n            669.1;Eisenmetalle\n</code></pre>\n\n<p>Can anyone here help me and tell me how it could be done with colly <a href=\"https://godoc.org/github.com/gocolly/colly#HTMLElement\" rel=\"nofollow noreferrer\">Colly doc for go</a>, which is similar to jQuery?</p>\n\n<p>PS: I have tried this way - with children. But the output looks like this. I do not know why.</p>\n\n<pre><code>    Notation:Thema\u00a0:\n\n\n                        Haupttafeln\n                    600:\n\n                                    Technik\n\n            660:\n\n                                    Chemische Verfahrenstechnik\n\n            661:\n\n                                    Industriechemikalien\n\n            661.2-661.6:\n\n                                    S\u00e4uren, Basen, Salze\n\n            661.5:\n\n                                    Ammoniumsalze\n\n\n            Notation:Thema\u00a0:HilfstafelnT1--0:Hilfstafel 1. Standardschl\u00fcsselT2--0:Hilfstafel\u00a02. Geo ... \n</code></pre>\n"}, {"tags": ["go", "concurrency", "goroutine"], "comments": [{"owner": {"reputation": 2553, "user_id": 5198756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6xLRL.png?s=128&g=1", "display_name": "ifnotak", "link": "https://stackoverflow.com/users/5198756/ifnotak"}, "edited": false, "score": 2, "creation_date": 1553690305, "post_id": 55377282, "comment_id": 97476809, "body": "What have you tried so far? Do you already have something?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 4, "creation_date": 1553690637, "post_id": 55377282, "comment_id": 97477026, "body": "Just make a <code>map[Key]chan State</code>."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1553690719, "post_id": 55377282, "comment_id": 97477083, "body": "The pattern you&#39;re trying to implement is called fan-out (usually coupled with fan-in). I suggest searching for this. There are different specific ways to implement it with goroutines. There is no single &quot;right answer&quot;."}, {"owner": {"reputation": 1887, "user_id": 6514989, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7cc849ff19574490024b6e12ef33c82b?s=128&d=identicon&r=PG&f=1", "display_name": "nail fei", "link": "https://stackoverflow.com/users/6514989/nail-fei"}, "edited": false, "score": 0, "creation_date": 1553693715, "post_id": 55377282, "comment_id": 97479184, "body": "a possible solution, give lock for every key, map[key]sync.Mutex"}], "answers": [{"tags": [], "owner": {"reputation": 620, "user_id": 6838838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/063168f6e5477ad7990330b95331d798?s=128&d=identicon&r=PG&f=1", "display_name": "Girdhar Sojitra", "link": "https://stackoverflow.com/users/6838838/girdhar-sojitra"}, "is_accepted": false, "score": 1, "last_activity_date": 1554467594, "creation_date": 1554467594, "answer_id": 55535487, "question_id": 55377282, "link": "https://stackoverflow.com/questions/55377282/send-message-to-specific-go-routine-based-on-key/55535487#55535487", "title": "Send message to specific go routine based on key", "body": "<p>I am using map[Key]chan State Map to store mapping for Key to Channel.Creating Go Routine for each Key.</p>\n\n<pre><code>var keymap sync.Map\nfunc handle_webservice(req WebReq) {\n    val, ok := keymap.Load(req.Key)\n    if ok {\n        val1, _ := val.(chan Event)\n        val1 &lt;- Event{Data: req}\n    } else {\n        ch := make(chan Event, 5)\n        go Worker(ch)\n        keymap.Store(req.Key, ch)\n        ch &lt;- Event{Source: WEBSERVICE, Data: req}\n    }\n\nfunc sendToWorker(event Event) {\n    val, ok := keymap.Load(event.Key)\n    if ok {\n        val1, _ := val.(chan Event)\n        select {\n        case val1 &lt;- event:\n        default:\n\n        }\n    } \n}\n</code></pre>\n"}], "owner": {"reputation": 620, "user_id": 6838838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/063168f6e5477ad7990330b95331d798?s=128&d=identicon&r=PG&f=1", "display_name": "Girdhar Sojitra", "link": "https://stackoverflow.com/users/6838838/girdhar-sojitra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1554467594, "creation_date": 1553689917, "last_edit_date": 1553755226, "question_id": 55377282, "link": "https://stackoverflow.com/questions/55377282/send-message-to-specific-go-routine-based-on-key", "title": "Send message to specific go routine based on key", "body": "<p>I would like to implement the following:</p>\n\n<ul>\n<li>Multiple worker goroutines running, each executing some business logic.</li>\n<li>Different Http handlers distributes work to these workers.</li>\n<li>Input (via a channel) to each goroutine will be some data (State) which will have one Key in it.</li>\n<li>Multiple data with same key is also possible.</li>\n</ul>\n\n<p>Our requirement is that processing for a specific Key has to be serialised. e.g. goroutine 1 is processing data related to <code>Key:1234</code> then other goroutines should not process other data for the same key before goroutine 1 does its job.</p>\n\n<p>Can anybody suggest best approach to do that?</p>\n"}, {"tags": ["docker", "go"], "comments": [{"owner": {"reputation": 1914, "user_id": 9811969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/184e2e46b8d8b8c483c85589709b8563?s=128&d=identicon&r=PG&f=1", "display_name": "Nik", "link": "https://stackoverflow.com/users/9811969/nik"}, "edited": false, "score": 0, "creation_date": 1553685322, "post_id": 55375540, "comment_id": 97473721, "body": "Have you tried <code>RUN go get github.com&#47;gorilla&#47;mux</code>?"}, {"owner": {"reputation": 925, "user_id": 5866297, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1a0a80aed2650a949dd7f3b322a525ef?s=128&d=identicon&r=PG&f=1", "display_name": "Coding_Rabbit", "link": "https://stackoverflow.com/users/5866297/coding-rabbit"}, "reply_to_user": {"reputation": 1914, "user_id": 9811969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/184e2e46b8d8b8c483c85589709b8563?s=128&d=identicon&r=PG&f=1", "display_name": "Nik", "link": "https://stackoverflow.com/users/9811969/nik"}, "edited": false, "score": 0, "creation_date": 1553691754, "post_id": 55375540, "comment_id": 97477815, "body": "@Nik, Thanks, I have tried but it still doesn&#39;t work."}], "owner": {"reputation": 925, "user_id": 5866297, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1a0a80aed2650a949dd7f3b322a525ef?s=128&d=identicon&r=PG&f=1", "display_name": "Coding_Rabbit", "link": "https://stackoverflow.com/users/5866297/coding-rabbit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "closed_date": 1553685234, "answer_count": 0, "score": 0, "last_activity_date": 1553691837, "creation_date": 1553684279, "last_edit_date": 1553691837, "question_id": 55375540, "link": "https://stackoverflow.com/questions/55375540/unable-to-go-get-dependency-packages-when-building-docker-file", "closed_reason": "Duplicate", "title": "Unable to go get dependency packages when building docker file", "body": "<p>I'm following the <a href=\"https://hackernoon.com/how-to-develop-go-grpc-microservices-and-deploy-in-kubernates-5eace0425bf8\" rel=\"nofollow noreferrer\">tutorial</a> learning about the implementation and deployment of micro-service in Go. When I try to rebuild the docker image based on the Dockfile and go file, I always get error messages listed as below. The Dockerfile and go file are attached, may I ask what could be the possible reasons causing this error? I have already tried the solution offered by <a href=\"https://stackoverflow.com/questions/47177850/could-not-resolve-host-in-docker\">Could not reserve host in docker</a>, but there is no <code>--dns</code> flag in <code>docker build</code>.</p>\n\n<p>Dockerfile:</p>\n\n<pre><code>FROM golang:latest\n\nCOPY . /go/src/add\nWORKDIR /go/src/add\nRUN go get -d -v ./...\nRUN go install -v ./...\nENTRYPOINT go run main.go\nEXPOSE 3000\n</code></pre>\n\n<p>Go file:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/shuza/kubernetes-go-grpc/pd\"\n    \"golang.org/x/net/context\"\n    \"google.golang.org/grpc\"\n    \"google.golang.org/grpc/reflection\"\n    \"log\"\n    \"net\"\n)\n\ntype server struct{}\n\nfunc main() {\n    lis, err := net.Listen(\"tcp\", \":3000\")\n    if err != nil {\n        log.Fatalf(\"Failed to listen:  %v\", err)\n    }\n\n    s := grpc.NewServer()\n    pb.RegisterAddServiceServer(s, &amp;server{})\n    reflection.Register(s)\n    if err := s.Serve(lis); err != nil {\n        log.Fatalf(\"Failed to serve: %v\", err)\n    }\n}\n\nfunc (s *server) Compute(cxt context.Context, r *pb.AddRequest) (*pb.AddResponse, error) {\n    result := &amp;pb.AddResponse{}\n    result.Result = r.A + r.B\n\n    logMessage := fmt.Sprintf(\"A: %d   B: %d     sum: %d\", r.A, r.B, result.Result)\n    log.Println(logMessage)\n\n    return result, nil\n}\n</code></pre>\n\n<p>Error Message:</p>\n\n<pre><code># cd .; git clone https://github.com/gorilla/mux /go/src/github.com/gorilla/mux\nCloning into '/go/src/github.com/gorilla/mux'...\nfatal: unable to access 'https://github.com/gorilla/mux/': Could not resolve host: github.com\npackage github.com/gorilla/mux: exit status 128\n# cd .; git clone https://github.com/shuza/kubernetes-go-grpc /go/src/github.com/shuza/kubernetes-go-grpc\nCloning into '/go/src/github.com/shuza/kubernetes-go-grpc'...\nfatal: unable to access 'https://github.com/shuza/kubernetes-go-grpc/': Could not resolve host: github.com\npackage github.com/shuza/kubernetes-go-grpc/pd: exit status 128\npackage golang.org/x/net/context: unrecognized import path \"golang.org/x/net/context\" (https fetch: Get https://golang.org/x/net/context?go-get=1: dial tcp: i/o timeout)\npackage google.golang.org/grpc: unrecognized import path \"google.golang.org/grpc\" (https fetch: Get https://google.golang.org/grpc?go-get=1: dial tcp: i/o timeout)\n</code></pre>\n"}, {"tags": ["database", "go", "error-handling"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1553685697, "post_id": 55372748, "comment_id": 97473949, "body": "There is no &quot;best practice&quot; here. Only opinion. Do what makes sense for your application."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1553692760, "post_id": 55372748, "comment_id": 97478551, "body": "&quot;can simply return nil as the value instead of returning an error&quot;? Yes, syntactically, if your return type is a pointer type, <code>nil</code> is a valid value for that type. As to whether you <i>should</i>, that&#39;s purely opinion-based."}], "answers": [{"tags": [], "owner": {"reputation": 2553, "user_id": 5198756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6xLRL.png?s=128&g=1", "display_name": "ifnotak", "link": "https://stackoverflow.com/users/5198756/ifnotak"}, "is_accepted": true, "score": 1, "last_activity_date": 1553676523, "last_edit_date": 1553676523, "creation_date": 1553676165, "answer_id": 55372932, "question_id": 55372748, "link": "https://stackoverflow.com/questions/55372748/proper-error-handling-when-no-entity-is-found/55372932#55372932", "title": "Proper error handling when no entity is found", "body": "<p>If you are using <code>gorm</code>, there is a function specifically for that; namely, </p>\n\n<pre><code>// IsRecordNotFoundError returns true if error contains a RecordNotFound error\nfunc IsRecordNotFoundError(err error) bool {}\n</code></pre>\n\n<p>You can use it as following:</p>\n\n<pre><code>err = db.Find(object).Error\nif err != nil {\n    if gorm.IsRecordNotFoundError(err) {\n        // handle object not found\n    } else {\n        return err\n    }\n}\n</code></pre>\n\n<p>and for your question:</p>\n\n<blockquote>\n  <p>I'm wondering you can simply return nil as the value instead of returning an error</p>\n</blockquote>\n\n<p>It really depends on your design; so if you want to separate your database layer, then you should still inform the user about this error using your own exported error type and let them handle it as they wish.</p>\n"}, {"tags": [], "owner": {"reputation": 301, "user_id": 1636320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f33f92d2d79e17cbe82dc485437ab9?s=128&d=identicon&r=PG", "display_name": "morteza khadem", "link": "https://stackoverflow.com/users/1636320/morteza-khadem"}, "is_accepted": false, "score": 0, "last_activity_date": 1553696139, "creation_date": 1553696139, "answer_id": 55379421, "question_id": 55372748, "link": "https://stackoverflow.com/questions/55372748/proper-error-handling-when-no-entity-is-found/55379421#55379421", "title": "Proper error handling when no entity is found", "body": "<p>you can use this code:</p>\n\n<pre><code>  user:=&amp;User{}\n  if db.First(&amp;user, \"username=?\", mobile).RecordNotFound() {\n     return nil\n  }\n  return user\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7308287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/effa0974ea7e8e68b7cee751578f0671?s=128&d=identicon&r=PG&f=1", "display_name": "Mohi_k", "link": "https://stackoverflow.com/users/7308287/mohi-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 920, "favorite_count": 0, "accepted_answer_id": 55372932, "answer_count": 2, "score": 0, "last_activity_date": 1553696139, "creation_date": 1553675526, "last_edit_date": 1553677098, "question_id": 55372748, "link": "https://stackoverflow.com/questions/55372748/proper-error-handling-when-no-entity-is-found", "title": "Proper error handling when no entity is found", "body": "<p>I'm writing a Go application which has a database package. Now in database package there are a couple of methods which you can call for getting an entity based on some fields.</p>\n\n<p>I was wondering what is the best practice for error handling in Go when no entity is found. Should I return errors in my own database package or return nil as the value?</p>\n\n<p>I know google's datastore returns error when no entity is found.</p>\n\n<p>Right now I'm using <code>gorm</code> and it also returns error when no entity is found.</p>\n\n<p>I'm wondering you can simply return <code>nil</code> as the value instead of returning an error. Am I missing a point?</p>\n"}, {"tags": ["go", "http.client"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1553676484, "post_id": 55372652, "comment_id": 97468255, "body": "The &quot;hook&quot; is the Transport field. You can easily write your own RoundTripper that wraps http.DefaultTransport, for instance."}, {"owner": {"reputation": 71, "user_id": 5778988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3ea48686ac8a7f7daf156bd3b1dfb9a?s=128&d=identicon&r=PG&f=1", "display_name": "AndyChow", "link": "https://stackoverflow.com/users/5778988/andychow"}, "reply_to_user": {"reputation": 2553, "user_id": 5198756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6xLRL.png?s=128&g=1", "display_name": "ifnotak", "link": "https://stackoverflow.com/users/5198756/ifnotak"}, "edited": false, "score": 0, "creation_date": 1553678224, "post_id": 55372652, "comment_id": 97469379, "body": "@Abdullah No, it&#39;s not. I cannot hack building custom request, cos it&#39;s out of my control. It might be an option to hack http.client."}, {"owner": {"reputation": 71, "user_id": 5778988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3ea48686ac8a7f7daf156bd3b1dfb9a?s=128&d=identicon&r=PG&f=1", "display_name": "AndyChow", "link": "https://stackoverflow.com/users/5778988/andychow"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1553679768, "post_id": 55372652, "comment_id": 97470292, "body": "@Peter According to the official doc, it&#39;s not safe. <a href=\"https://golang.org/pkg/net/http/#RoundTripper\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/#RoundTripper</a>  . quote: RoundTrip should not modify the request, except for consuming and closing the Request&#39;s Body. RoundTrip may read fields of the request in a separate goroutine."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1553682321, "post_id": 55372652, "comment_id": 97471834, "body": "Good point, I forgot about that. At my workplace we wrap the whole client, actually. The Do method is all you need to send requets, so you can declare your own one-method interface which lends itself nicely to composition. You can take a look at <a href=\"https://godoc.org/github.com/classmarkets/cmhttp#WithHeader\" rel=\"nofollow noreferrer\">our package</a> for inspiration."}, {"owner": {"reputation": 71, "user_id": 5778988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3ea48686ac8a7f7daf156bd3b1dfb9a?s=128&d=identicon&r=PG&f=1", "display_name": "AndyChow", "link": "https://stackoverflow.com/users/5778988/andychow"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1554714018, "post_id": 55372652, "comment_id": 97838374, "body": "Thanks a lot. Maybe I should forget about the manual as long as it works in my scene."}], "answers": [{"tags": [], "owner": {"reputation": 2702, "user_id": 2923336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LmjCO.png?s=128&g=1", "display_name": "Francois", "link": "https://stackoverflow.com/users/2923336/francois"}, "is_accepted": false, "score": 0, "last_activity_date": 1553675856, "creation_date": 1553675856, "answer_id": 55372843, "question_id": 55372652, "link": "https://stackoverflow.com/questions/55372652/how-can-i-add-extra-headers-to-http-request-for-tracing-issues/55372843#55372843", "title": "How can I add extra headers to http.Request for tracing issues", "body": "<p>You should use headers. </p>\n\n<p>You can do:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>r.Header.Add(\"trace-id\", \"yourid\")\n</code></pre>\n\n<p>You can also use open source package such as the opentracing one, which follows open tracing conventions and has method to add and read tracing information from requests: <a href=\"https://github.com/opentracing/opentracing-go\" rel=\"nofollow noreferrer\">https://github.com/opentracing/opentracing-go</a></p>\n"}], "owner": {"reputation": 71, "user_id": 5778988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3ea48686ac8a7f7daf156bd3b1dfb9a?s=128&d=identicon&r=PG&f=1", "display_name": "AndyChow", "link": "https://stackoverflow.com/users/5778988/andychow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 552, "favorite_count": 0, "closed_date": 1553681025, "answer_count": 1, "score": -1, "last_activity_date": 1554714253, "creation_date": 1553675090, "last_edit_date": 1554714253, "question_id": 55372652, "link": "https://stackoverflow.com/questions/55372652/how-can-i-add-extra-headers-to-http-request-for-tracing-issues", "closed_reason": "Duplicate", "title": "How can I add extra headers to http.Request for tracing issues", "body": "<p>In golang, it seems no hook methods exist for <code>http.client</code>, so I'm wondering how can I add extra headers like <code>trace-id: xxx</code> in framework.</p>\n\n<p>Ideal code is like below:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// this func add a hook method to http-client to rewrite header\nclient := buildWithRewriteHeaderHook()\n//customRequest has no `trace-id`\nclient.Do(customRequest)\n// remote server get trace-id from http headers\n...\n\n</code></pre>\n\n<p>PS: I know how to add headers to a request by 'req.setHeader()', and in my opinion it's not a duplicate question to this one.  <a href=\"https://stackoverflow.com/questions/12864302/how-to-set-headers-in-http-get-request\">How to set headers in http get request?</a></p>\n"}, {"tags": ["go", "memory", "concurrency"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 8, "creation_date": 1553675218, "post_id": 55372640, "comment_id": 97467635, "body": "The behavior is undefined. Don&#39;t try to find logic in it. Read: <a href=\"https://software.intel.com/en-us/blogs/2013/01/06/benign-data-races-what-could-possibly-go-wrong\" rel=\"nofollow noreferrer\">Benign Data Races: What Could Possibly Go Wrong?</a> And if not enogh: <a href=\"https://blog.stalkr.net/2015/04/golang-data-races-to-break-memory-safety.html\" rel=\"nofollow noreferrer\">Golang data races to break memory safety</a>"}], "answers": [{"tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": true, "score": 4, "last_activity_date": 1553680081, "last_edit_date": 1553680081, "creation_date": 1553675777, "answer_id": 55372824, "question_id": 55372640, "link": "https://stackoverflow.com/questions/55372640/trying-to-understand-golang-chan-cause-crash-or-do-something-else/55372824#55372824", "title": "trying to understand golang chan cause crash or do something else", "body": "<p>A string in Go is a <a href=\"https://blog.golang.org/strings\" rel=\"nofollow noreferrer\">read only slice of bytes</a>. <a href=\"https://blog.golang.org/slices\" rel=\"nofollow noreferrer\">Slice</a> consists of length an pointer. Let's assume that we first set length to a large value and then change the pointer. The other go routine may first read new length and old pointer. Then it tries to read over the end of the previous string. It either read some garbage or is stopped by operating system and crashes.</p>\n\n<p>The order of operations does not matter really, if you set pointer firsts it may point to memory area too short for the current length.</p>\n"}], "owner": {"reputation": 864, "user_id": 281782, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/TK2uJ.jpg?s=128&g=1", "display_name": "Geln Yang", "link": "https://stackoverflow.com/users/281782/geln-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 1, "accepted_answer_id": 55372824, "answer_count": 1, "score": 2, "last_activity_date": 1553680081, "creation_date": 1553675029, "question_id": 55372640, "link": "https://stackoverflow.com/questions/55372640/trying-to-understand-golang-chan-cause-crash-or-do-something-else", "title": "trying to understand golang chan cause crash or do something else", "body": "<p>The following is a example from <a href=\"https://golang.org/ref/mem\" rel=\"nofollow noreferrer\">https://golang.org/ref/mem</a>:</p>\n\n<pre><code>var c = make(chan int)\nvar a string\n\nfunc f() {\n    a = \"hello, world\"\n    &lt;-c\n}\nfunc main() {\n    go f()\n    c &lt;- 0\n    print(a)\n}\n</code></pre>\n\n<blockquote>\n  <p>is also guaranteed to print \"hello, world\". The write to a happens before the receive on c, which happens before the corresponding send on c completes, which happens before the print.</p>\n  \n  <p>If the channel were buffered (e.g., c = make(chan int, 1)) then the program would not be guaranteed to print \"hello, world\". (It might print the empty string, crash, or do something else.)</p>\n</blockquote>\n\n<p>I understand that <code>It might print the empty string</code>, but not for <code>crash</code> or <code>do something else</code>, when will <code>crash</code> happen? And when will it <code>do something else</code> ?</p>\n"}, {"tags": ["json", "api", "go", "controller", "beego"], "answers": [{"comments": [{"owner": {"reputation": 598, "user_id": 9629581, "user_type": "registered", "profile_image": "https://graph.facebook.com/1204435359699826/picture?type=large", "display_name": "Bilguun", "link": "https://stackoverflow.com/users/9629581/bilguun"}, "edited": false, "score": 0, "creation_date": 1553678627, "post_id": 55373568, "comment_id": 97469605, "body": "<code>cannot use err (type error) as type string in argument to re.FindStringSubmatch</code>"}, {"owner": {"reputation": 598, "user_id": 9629581, "user_type": "registered", "profile_image": "https://graph.facebook.com/1204435359699826/picture?type=large", "display_name": "Bilguun", "link": "https://stackoverflow.com/users/9629581/bilguun"}, "edited": false, "score": 0, "creation_date": 1553678640, "post_id": 55373568, "comment_id": 97469615, "body": "<code>data.Message undefined (type ErrorStruct has no field or method Message)</code>"}, {"owner": {"reputation": 1006, "user_id": 4666785, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/YXCzR.png?s=128&g=1", "display_name": "elcomendante", "link": "https://stackoverflow.com/users/4666785/elcomendante"}, "reply_to_user": {"reputation": 598, "user_id": 9629581, "user_type": "registered", "profile_image": "https://graph.facebook.com/1204435359699826/picture?type=large", "display_name": "Bilguun", "link": "https://stackoverflow.com/users/9629581/bilguun"}, "edited": false, "score": 1, "creation_date": 1553678889, "post_id": 55373568, "comment_id": 97469747, "body": "use <code>err.Error()</code>"}, {"owner": {"reputation": 1006, "user_id": 4666785, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/YXCzR.png?s=128&g=1", "display_name": "elcomendante", "link": "https://stackoverflow.com/users/4666785/elcomendante"}, "reply_to_user": {"reputation": 598, "user_id": 9629581, "user_type": "registered", "profile_image": "https://graph.facebook.com/1204435359699826/picture?type=large", "display_name": "Bilguun", "link": "https://stackoverflow.com/users/9629581/bilguun"}, "edited": false, "score": 1, "creation_date": 1553678962, "post_id": 55373568, "comment_id": 97469787, "body": "<code>type error interface {     Error() string }</code> you can get string out of error by following error intrface"}, {"owner": {"reputation": 1006, "user_id": 4666785, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/YXCzR.png?s=128&g=1", "display_name": "elcomendante", "link": "https://stackoverflow.com/users/4666785/elcomendante"}, "reply_to_user": {"reputation": 598, "user_id": 9629581, "user_type": "registered", "profile_image": "https://graph.facebook.com/1204435359699826/picture?type=large", "display_name": "Bilguun", "link": "https://stackoverflow.com/users/9629581/bilguun"}, "edited": false, "score": 0, "creation_date": 1553679054, "post_id": 55373568, "comment_id": 97469840, "body": "i edited code <code>re.FindStringSubmatch(err.Error())   </code>"}, {"owner": {"reputation": 598, "user_id": 9629581, "user_type": "registered", "profile_image": "https://graph.facebook.com/1204435359699826/picture?type=large", "display_name": "Bilguun", "link": "https://stackoverflow.com/users/9629581/bilguun"}, "edited": false, "score": 0, "creation_date": 1553679200, "post_id": 55373568, "comment_id": 97469938, "body": "<code>data.Message undefined (type ErrorStruct has no field or method Message)</code>"}], "tags": [], "owner": {"reputation": 1006, "user_id": 4666785, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/YXCzR.png?s=128&g=1", "display_name": "elcomendante", "link": "https://stackoverflow.com/users/4666785/elcomendante"}, "is_accepted": false, "score": 1, "last_activity_date": 1553686278, "last_edit_date": 1553686278, "creation_date": 1553678296, "answer_id": 55373568, "question_id": 55372166, "link": "https://stackoverflow.com/questions/55372166/how-to-read-error-from-http-response-body/55373568#55373568", "title": "How to read error from HTTP response body", "body": "<pre><code>type ErrorStruct struct {\n    ConflictingRequest struct {\n        Message string `json:\"message\"`\n        Code    int    `json:\"code\"`\n    } `json:\"conflictingRequest\"`\n}\n\ngo func() {\n    _, err := compute.CreateKeypair(raw[\"keyPairName\"].(string))\n    if err != nil {\n        re := regexp.MustCompile(\"\\\\{(.*?)\\\\}\")\n        match := re.FindStringSubmatch(err.Error())\n        data := ErrorStruct{}\n        json.Unmarshal([]byte(match[1]), data)\n        log.Printf(\"Message: %s\", data.Message)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 598, "user_id": 9629581, "user_type": "registered", "profile_image": "https://graph.facebook.com/1204435359699826/picture?type=large", "display_name": "Bilguun", "link": "https://stackoverflow.com/users/9629581/bilguun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553686278, "creation_date": 1553672980, "last_edit_date": 1553682062, "question_id": 55372166, "link": "https://stackoverflow.com/questions/55372166/how-to-read-error-from-http-response-body", "title": "How to read error from HTTP response body", "body": "<p>This is how error looks like, I just need <code>\"Body\"</code> when I try <code>fmt.Println(err)</code></p>\n\n<p><strong>Console</strong></p>\n\n<pre><code>Expected HTTP response code [200] when accessing [POST http://controller:8774/v2.1/os-keypairs], but got 409 instead\n{\"conflictingRequest\": {\"message\": \"Key pair 'Darkhaa test hi' already exists.\", \"code\": 409}}\n</code></pre>\n\n<p><strong>Controller</strong></p>\n\n<pre><code>createKeyPair, err := compute.CreateKeypair(raw[\"keyPairName\"].(string))\n\nif err != nil {\n    fmt.Println(err)\n    lists[\"retType\"] = -1\n    lists[\"retDesc\"] = err\n} else {\n    lists[\"retType\"] = 0\n    lists[\"retDesc\"] = \"\"\n    lists[\"retData\"] = createKeyPair\n}\n\ni.Data[\"json\"] = lists\n</code></pre>\n"}, {"tags": ["go", "encryption", "rsa"], "comments": [{"owner": {"reputation": 602, "user_id": 6863654, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VaBUN.png?s=128&g=1", "display_name": "beiping96", "link": "https://stackoverflow.com/users/6863654/beiping96"}, "edited": false, "score": 2, "creation_date": 1553672680, "post_id": 55372050, "comment_id": 97466408, "body": "try format iv by <code>fmt.Sprintf(&quot;%x&quot;, iv)</code>"}, {"owner": {"reputation": 444, "user_id": 7918749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r9BIg.jpg?s=128&g=1", "display_name": "Black_Dreams", "link": "https://stackoverflow.com/users/7918749/black-dreams"}, "reply_to_user": {"reputation": 602, "user_id": 6863654, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VaBUN.png?s=128&g=1", "display_name": "beiping96", "link": "https://stackoverflow.com/users/6863654/beiping96"}, "edited": false, "score": 0, "creation_date": 1553672872, "post_id": 55372050, "comment_id": 97466499, "body": "Thanks for your response it seems to good in that way."}], "answers": [{"tags": [], "owner": {"reputation": 443, "user_id": 9868239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ac98d5afdef29cd59333db141336d2a?s=128&d=identicon&r=PG", "display_name": "Hamidreza Kalantari", "link": "https://stackoverflow.com/users/9868239/hamidreza-kalantari"}, "is_accepted": true, "score": 1, "last_activity_date": 1553673102, "creation_date": 1553673102, "answer_id": 55372199, "question_id": 55372050, "link": "https://stackoverflow.com/questions/55372050/generate-the-different-iv-for-every-time-in-rsa-encryption/55372199#55372199", "title": "Generate the Different IV for every Time in RSA encryption", "body": "<p>If you want to make it human readable, you've got couple options:</p>\n\n<ul>\n<li><p>base64</p>\n\n<p>base64.StdEncoding.EncodeToString(iv)</p></li>\n<li><p>Hex</p>\n\n<p>hex.EncodeToString(iv)</p></li>\n</ul>\n\n<p>and so on.</p>\n"}], "owner": {"reputation": 444, "user_id": 7918749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r9BIg.jpg?s=128&g=1", "display_name": "Black_Dreams", "link": "https://stackoverflow.com/users/7918749/black-dreams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 55372199, "answer_count": 1, "score": 1, "last_activity_date": 1553682070, "creation_date": 1553672503, "last_edit_date": 1553682070, "question_id": 55372050, "link": "https://stackoverflow.com/questions/55372050/generate-the-different-iv-for-every-time-in-rsa-encryption", "title": "Generate the Different IV for every Time in RSA encryption", "body": "<p>The generated IV is correct or not every time it will give me some random output\nor is their any other way to do this.</p>\n\n<pre><code>ciphertext := make([]byte, aes.BlockSize+len(plaintext))\n    iv := ciphertext[:aes.BlockSize]\n    iv = key[:aes.BlockSize]\n    if _, err := io.ReadFull(rand.Reader, iv); err != nil {\n        panic(err)\n    }\n    log.Println(\"IV Simple String:\", string(iv))\n\n</code></pre>\n\n<p>Give some random result like</p>\n\n<pre><code>\ufffd\ufffd=\ufffd      49k\ufffd\u0181\ufffd\u02b2\ufffd\ufffd\n</code></pre>\n\n<p>Can't even understand this !!!</p>\n"}, {"tags": ["sql", "json", "postgresql", "go"], "comments": [{"owner": {"reputation": 602, "user_id": 6863654, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VaBUN.png?s=128&g=1", "display_name": "beiping96", "link": "https://stackoverflow.com/users/6863654/beiping96"}, "edited": false, "score": 0, "creation_date": 1553672561, "post_id": 55371885, "comment_id": 97466348, "body": "change <code>&quot;name&quot;: &quot;$1&quot;</code> to <code>&quot;name&quot;: ?</code>"}, {"owner": {"reputation": 352, "user_id": 9530473, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Joseph Vargas", "link": "https://stackoverflow.com/users/9530473/joseph-vargas"}, "reply_to_user": {"reputation": 602, "user_id": 6863654, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VaBUN.png?s=128&g=1", "display_name": "beiping96", "link": "https://stackoverflow.com/users/6863654/beiping96"}, "edited": false, "score": 0, "creation_date": 1553672856, "post_id": 55371885, "comment_id": 97466489, "body": "@beiping96 I&#39;ve already tried that. When I do, I get an error &quot;pq: invalid input syntax for type json&quot;."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1553674063, "post_id": 55371885, "comment_id": 97467066, "body": "@JosephVargas It doesn&#39;t effect the answer, but be sure you&#39;re using jsonb for the Postgres column. The performance is much better."}, {"owner": {"reputation": 352, "user_id": 9530473, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Joseph Vargas", "link": "https://stackoverflow.com/users/9530473/joseph-vargas"}, "edited": false, "score": 1, "creation_date": 1553674392, "post_id": 55371885, "comment_id": 97467224, "body": "@Shcwern Thanks!  Already using jsonb but appreciate the tip!"}], "answers": [{"tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 1, "last_activity_date": 1553673721, "creation_date": 1553673721, "answer_id": 55372320, "question_id": 55371885, "link": "https://stackoverflow.com/questions/55371885/raw-parameterized-strings-for-postgres-json-insert/55372320#55372320", "title": "Raw parameterized strings for postgres json insert", "body": "<p>The problem is the <code>$1</code> is inside a quoted string, so it's just treated as part of a literal SQL value. You're inserting literally <code>{\"name\": \"$1\"}</code>.</p>\n\n<p>You can't insert part of a value that way. Instead you have to construct the value in Go and insert the whole value.</p>\n\n<pre><code>func (l *Lesson) Insert() error {\n    query := `\n        INSERT INTO lessons (lesson)\n        VALUES ($1)\n        RETURNING id;\n    `\n    // Demonstration only, don't produce JSON like this.\n    value := fmt.Sprintf(\"{\\\"name\\\": \\\"%s\\\"}\", l.Name)\n    err := db.QueryRow(query, value).Scan(&amp;l.ID)\n    return err\n}\n</code></pre>\n"}], "owner": {"reputation": 352, "user_id": 9530473, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Joseph Vargas", "link": "https://stackoverflow.com/users/9530473/joseph-vargas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 482, "favorite_count": 0, "accepted_answer_id": 55372320, "answer_count": 1, "score": 1, "last_activity_date": 1553682080, "creation_date": 1553671814, "last_edit_date": 1592644375, "question_id": 55371885, "link": "https://stackoverflow.com/questions/55371885/raw-parameterized-strings-for-postgres-json-insert", "title": "Raw parameterized strings for postgres json insert", "body": "<p>According to <a href=\"https://www.calhoun.io/inserting-records-into-a-postgresql-database-with-gos-database-sql-package/\" rel=\"nofollow noreferrer\">this link</a> I should use raw `` strings to execute queries to a SQL database with Golang to avoid SQL injections.  For my use case I am trying to use Postgres' json type for one of my data objects.</p>\n<p>My structs are as follows ~</p>\n<pre><code>type LessonDB struct {  // for DB data retrieval\n    ID     int    `db:&quot;id&quot;`\n    Lesson string `db:&quot;lesson&quot;`\n}\n\ntype Lesson struct {  // for general data operations\n    ID    int    `json:&quot;id&quot;`\n    Name  string `json:&quot;name&quot;`\n    Pages []Page `json:&quot;pages,omitempty&quot;`\n}\n</code></pre>\n<p>My query is executed as follows ~</p>\n<pre><code>func (l *Lesson) Insert() error {\n    query := `\n        INSERT INTO lessons (lesson)\n        VALUES ('{\n            &quot;name&quot;: &quot;$1&quot;\n        }')\n        RETURNING id;\n    `\n    err := db.QueryRow(query, l.Name).Scan(&amp;l.ID)\n    return err\n}\n</code></pre>\n<p>PostMan returns an error saying ~ &quot; pq: got 1 parameters but the statement requires 0 &quot;</p>\n<p>While troubleshooting with fmt.PrintLn(query, l.Name) it appears as though the raw strings parameter isn't working and the &quot;name&quot; field still evaluates to &quot;$1&quot;</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 602, "user_id": 6863654, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VaBUN.png?s=128&g=1", "display_name": "beiping96", "link": "https://stackoverflow.com/users/6863654/beiping96"}, "edited": false, "score": 1, "creation_date": 1553672790, "post_id": 55371508, "comment_id": 97466454, "body": "just delete <code>G:\\GOPATH\\pkg\\mod\\github.com\\ethereum\\go-ethereum@v1.8.23</code> folder"}, {"owner": {"reputation": 719, "user_id": 6159371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IkhNG.jpg?s=128&g=1", "display_name": "pingze", "link": "https://stackoverflow.com/users/6159371/pingze"}, "reply_to_user": {"reputation": 602, "user_id": 6863654, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VaBUN.png?s=128&g=1", "display_name": "beiping96", "link": "https://stackoverflow.com/users/6863654/beiping96"}, "edited": false, "score": 0, "creation_date": 1553680218, "post_id": 55371508, "comment_id": 97470557, "body": "@beiping96 It will reinstall it automatically when run go build"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1553681172, "post_id": 55371508, "comment_id": 97471164, "body": "You should ask the go-etherum designers. Adding a go.mod is not going to work. Checkout the version you need an populate your GOPATH with the relevant packages in the right version."}, {"owner": {"reputation": 719, "user_id": 6159371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IkhNG.jpg?s=128&g=1", "display_name": "pingze", "link": "https://stackoverflow.com/users/6159371/pingze"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1553685484, "post_id": 55371508, "comment_id": 97473831, "body": "@Volker That is not a go-etherum problem. Let me abstract it: When using go mod, clone the repo out of GOPATH. The repo imports some package in itself. When run go build, it install a new repication in GOPATH, but not using that I cloned."}], "answers": [{"tags": [], "owner": {"reputation": 1059, "user_id": 1982418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbe9fddd5823aa8ae6a41ec889f0f581?s=128&d=identicon&r=PG&f=1", "display_name": "sh.seo", "link": "https://stackoverflow.com/users/1982418/sh-seo"}, "is_accepted": false, "score": -2, "last_activity_date": 1553736452, "creation_date": 1553736452, "answer_id": 55388871, "question_id": 55371508, "link": "https://stackoverflow.com/questions/55371508/how-to-solve-ambiguous-import-when-using-go-mod/55388871#55388871", "title": "How to solve &#39;ambiguous import&#39; when using go mod?", "body": "<p>If you want to geth, do this. I did this.</p>\n\n<pre><code>cd $GOPATH/src\ngit clone https://github.com/ethereum/go-ethereum.git\ncd $GOPATH/src/github.com/ethereum/go-ethereum\ngit checkout tags/v1.0.0 -b v1.0.0\ngo install github.com/ethereum/go-ethereum/cmd/geth\nls $GOPATH/bin/geth\n</code></pre>\n"}], "owner": {"reputation": 719, "user_id": 6159371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IkhNG.jpg?s=128&g=1", "display_name": "pingze", "link": "https://stackoverflow.com/users/6159371/pingze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4519, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1553736452, "creation_date": 1553670208, "last_edit_date": 1553670909, "question_id": 55371508, "link": "https://stackoverflow.com/questions/55371508/how-to-solve-ambiguous-import-when-using-go-mod", "title": "How to solve &#39;ambiguous import&#39; when using go mod?", "body": "<p>I'm trying to run go-ethereum@v1.0.0 on my windows machine.</p>\n\n<p>What I do:</p>\n\n<pre><code>cd G:\\go\ngit clone https://github.com/ethereum/go-ethereum.git\ncd go-ethereum/cmd/geth\ngit checkout tags/v1.0.0 -b v1.0.0\ngo mod init github.com/ethereum/go-ethereum/cmd/geth\ngo run .\n</code></pre>\n\n<p>I hope go mod can help me install all modules, but meet an error:</p>\n\n<pre><code>package github.com/ethereum/go-ethereum/cmd/geth: unknown import path \"github.com/ethereum/go-ethereum/cmd/geth\": ambiguous import: found github.com/ethereum/go-ethereum/cmd/geth in multiple modules:\n        github.com/ethereum/go-ethereum/cmd/geth (G:\\go\\go-ethereum\\cmd\\geth)\n        github.com/ethereum/go-ethereum v1.8.23 (G:\\GOPATH\\pkg\\mod\\github.com\\ethereum\\go-ethereum@v1.8.23\\cmd\\geth)\n</code></pre>\n\n<p>I think that's because the cmd/geth exists in $GOPATH and $PWD both. How can I solve this can run successfully?</p>\n\n<p>PS: I hope it use $PWD so that I can change it.</p>\n"}, {"tags": ["java", "go", "aes", "encryption-symmetric"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1553667194, "post_id": 55370699, "comment_id": 97464200, "body": "Java&#39;s getBytes is not deterministic but depends on the default charset."}, {"owner": {"reputation": 19, "user_id": 5432129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/113749d1021bd5498f270cbcb891e57b?s=128&d=identicon&r=PG&f=1", "display_name": "Dogushan KAYA", "link": "https://stackoverflow.com/users/5432129/dogushan-kaya"}, "edited": false, "score": 0, "creation_date": 1553671137, "post_id": 55370699, "comment_id": 97465735, "body": "AES use random initial vector for encryption. Every call generates random initial vector and this cause different encrypted text."}, {"owner": {"reputation": 13, "user_id": 10110504, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kL0CAwRk_Xw/AAAAAAAAAAI/AAAAAAAAClc/biJ5mU7JBq0/photo.jpg?sz=128", "display_name": "Prashant Gupta", "link": "https://stackoverflow.com/users/10110504/prashant-gupta"}, "reply_to_user": {"reputation": 19, "user_id": 5432129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/113749d1021bd5498f270cbcb891e57b?s=128&d=identicon&r=PG&f=1", "display_name": "Dogushan KAYA", "link": "https://stackoverflow.com/users/5432129/dogushan-kaya"}, "edited": false, "score": 0, "creation_date": 1553677035, "post_id": 55370699, "comment_id": 97468617, "body": "@DogushanKAYA : The code which I pasted here, generating the same encrypted text."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10110504, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kL0CAwRk_Xw/AAAAAAAAAAI/AAAAAAAAClc/biJ5mU7JBq0/photo.jpg?sz=128", "display_name": "Prashant Gupta", "link": "https://stackoverflow.com/users/10110504/prashant-gupta"}, "edited": false, "score": 0, "creation_date": 1553677147, "post_id": 55371966, "comment_id": 97468692, "body": "Here I want to know what is the default mode which my java code is using and how to replicate the same in golang."}, {"owner": {"reputation": 443, "user_id": 9868239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ac98d5afdef29cd59333db141336d2a?s=128&d=identicon&r=PG", "display_name": "Hamidreza Kalantari", "link": "https://stackoverflow.com/users/9868239/hamidreza-kalantari"}, "reply_to_user": {"reputation": 13, "user_id": 10110504, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kL0CAwRk_Xw/AAAAAAAAAAI/AAAAAAAAClc/biJ5mU7JBq0/photo.jpg?sz=128", "display_name": "Prashant Gupta", "link": "https://stackoverflow.com/users/10110504/prashant-gupta"}, "edited": false, "score": 0, "creation_date": 1553677518, "post_id": 55371966, "comment_id": 97468909, "body": "@PrashantGupta relying on default mode is risky. You should set it explicitly. As I said, you can use GCM in golang and java but if you don&#39;t want to use bouncy castle, you can use CBC mode in both languages."}], "tags": [], "owner": {"reputation": 443, "user_id": 9868239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ac98d5afdef29cd59333db141336d2a?s=128&d=identicon&r=PG", "display_name": "Hamidreza Kalantari", "link": "https://stackoverflow.com/users/9868239/hamidreza-kalantari"}, "is_accepted": true, "score": 2, "last_activity_date": 1553672144, "creation_date": 1553672144, "answer_id": 55371966, "question_id": 55370699, "link": "https://stackoverflow.com/questions/55370699/getting-different-result-cyphertext-while-using-aes-in-java-and-golang/55371966#55371966", "title": "Getting different result (cyphertext) while using AES in Java and golang", "body": "<p>In the go code, you are using AES in GCM mode with 12 bytes of zero as IV, but in java code you are using default mode of AES which is not the same in different java versions.</p>\n\n<p>By using GCM mode(Provided in BouncyCastle) and setting the same IV(12 bytes of zero) I got same output:</p>\n\n<pre><code>package EncryptionTest;\n\nimport org.bouncycastle.jce.provider.BouncyCastleProvider;\n\nimport java.security.Key;\nimport java.security.Security;\nimport java.util.Base64;\n\nimport javax.crypto.Cipher;\nimport javax.crypto.spec.IvParameterSpec;\nimport javax.crypto.spec.SecretKeySpec;\n\npublic class EncryptionDecryptionAES {\n\n    static Cipher cipher;\n\n    public static void main(String[] args) throws Exception {\n        Security.addProvider(new BouncyCastleProvider());\n\n\n        Key secretKey;\n        secretKey = (Key)new SecretKeySpec(\"0123456789012345\".getBytes(), \"AES\");\n\n        cipher = Cipher.getInstance(\"AES/GCM/NoPadding\", \"BC\");\n\n        String plainText = \"AES Symmetric Encryption Decryption\";\n        System.out.println(\"Plain Text Before Encryption: \" + plainText);\n        String encryptedText = encrypt(plainText, secretKey);\n        System.out.println(\"Encrypted Text After Encryption: \" + encryptedText);\n        String decryptedText = decrypt(encryptedText, secretKey);\n        System.out.println(\"Decrypted Text After Decryption: \" + decryptedText);\n    }\n\n    public static String encrypt(String plainText, Key secretKey) throws Exception {\n        byte[] plainTextByte = plainText.getBytes();\n\n\n        byte[] iv = new byte[12];\n        IvParameterSpec ivParameterSpec = new IvParameterSpec(iv);\n        cipher.init(Cipher.ENCRYPT_MODE, secretKey, ivParameterSpec);\n\n        byte[] encryptedByte = cipher.doFinal(plainTextByte);\n        Base64.Encoder encoder = Base64.getEncoder();\n        String encryptedText = encoder.encodeToString(encryptedByte);\n        return encryptedText;\n    }\n\n    public static String decrypt(String encryptedText, Key secretKey) throws Exception {\n        Base64.Decoder decoder = Base64.getDecoder();\n        byte[] encryptedTextByte = decoder.decode(encryptedText);\n\n        byte[] iv = new byte[12];\n        IvParameterSpec ivParameterSpec = new IvParameterSpec(iv);\n        cipher.init(Cipher.DECRYPT_MODE, secretKey, ivParameterSpec);\n\n        byte[] decryptedByte = cipher.doFinal(encryptedTextByte);\n        String decryptedText = new String(decryptedByte);\n        return decryptedText;\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Plain Text Before Encryption: AES Symmetric Encryption Decryption\nEncrypted Text After Encryption: 7UMh49c5Wqb2BzlttKBEnq5g4fxMK9oJs1EUDIgWzVwlY28k+qd/oFG9SJckBsaX6DHp\nDecrypted Text After Decryption: AES Symmetric Encryption Decryption\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10110504, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kL0CAwRk_Xw/AAAAAAAAAAI/AAAAAAAAClc/biJ5mU7JBq0/photo.jpg?sz=128", "display_name": "Prashant Gupta", "link": "https://stackoverflow.com/users/10110504/prashant-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 802, "favorite_count": 0, "accepted_answer_id": 55371966, "answer_count": 1, "score": 0, "last_activity_date": 1553672144, "creation_date": 1553666380, "question_id": 55370699, "link": "https://stackoverflow.com/questions/55370699/getting-different-result-cyphertext-while-using-aes-in-java-and-golang", "title": "Getting different result (cyphertext) while using AES in Java and golang", "body": "<p>I am trying to replicate the java code for AES encryption into Golang.\nHowever I am not getting the same output in golang</p>\n\n<p>I tried below code:</p>\n\n<p><strong>Java Code:</strong></p>\n\n<pre><code>package EncryptionTest;\n\nimport java.security.Key;\nimport java.util.Base64;\n\nimport javax.crypto.Cipher;\nimport javax.crypto.spec.SecretKeySpec;\n\npublic class EncryptionDecryptionAES {\n\n    static Cipher cipher;\n\n    public static void main(String[] args) throws Exception {\n        Key secretKey;\n        secretKey = (Key)new SecretKeySpec(\"0123456789012345\".getBytes(), \"AES\");\n        cipher = Cipher.getInstance(\"AES\");\n        String plainText = \"AES Symmetric Encryption Decryption\";\n        System.out.println(\"Plain Text Before Encryption: \" + plainText);\n        String encryptedText = encrypt(plainText, secretKey);\n        System.out.println(\"Encrypted Text After Encryption: \" + encryptedText);\n        String decryptedText = decrypt(encryptedText, secretKey);\n        System.out.println(\"Decrypted Text After Decryption: \" + decryptedText);\n    }\n\n    public static String encrypt(String plainText, Key secretKey) throws Exception {\n        byte[] plainTextByte = plainText.getBytes();\n        cipher.init(Cipher.ENCRYPT_MODE, secretKey);\n        byte[] encryptedByte = cipher.doFinal(plainTextByte);\n        Base64.Encoder encoder = Base64.getEncoder();\n        String encryptedText = encoder.encodeToString(encryptedByte);\n        return encryptedText;\n    }\n\n    public static String decrypt(String encryptedText, Key secretKey) throws Exception {\n        Base64.Decoder decoder = Base64.getDecoder();\n        byte[] encryptedTextByte = decoder.decode(encryptedText);\n        cipher.init(Cipher.DECRYPT_MODE, secretKey);\n        byte[] decryptedByte = cipher.doFinal(encryptedTextByte);\n        String decryptedText = new String(decryptedByte);\n        return decryptedText;\n    }\n}\n</code></pre>\n\n<p><strong>Java code output:</strong>\n<em>Plain Text Before Encryption: AES Symmetric Encryption Decryption\nEncrypted Text After Encryption: vSmrgH3qU+qEq+3ui0YvwCa6PDBcMyhgOlbh3+zzM+cON6feLk2u1iPW7lITD3vn\nDecrypted Text After Decryption: AES Symmetric Encryption Decryption</em></p>\n\n<p><strong>Golang Code:</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/aes\"\n    \"crypto/cipher\"\n    \"encoding/base64\"\n    \"fmt\"\n)\n\nconst NONCESIZE = 12\n\nfunc main() {\n    key := []byte(\"0123456789012345\")\n    plaintext := []byte(\"AES Symmetric Encryption Decryption\")\n    block, err := aes.NewCipher(key)\n    if err != nil {\n        panic(err.Error())\n    }\n    nonce := make([]byte, NONCESIZE)\n    aesgcm, err := cipher.NewGCM(block)\n    if err != nil {\n        panic(err.Error())\n    }\n    ciphertext := aesgcm.Seal(nil, nonce, plaintext, nil)\n    fmt.Println(\"Encrypted Text is : \", base64.StdEncoding.EncodeToString(ciphertext))\n\n}\n</code></pre>\n\n<p><strong>Golang Code output:</strong>\n<em>Encrypted Text is :  7UMh49c5Wqb2BzlttKBEnq5g4fxMK9oJs1EUDIgWzVwlY28k+qd/oFG9SJckBsaX6DHp</em></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1553693086, "post_id": 55370082, "comment_id": 97478787, "body": "Go packages can be hosted anywhere, in various different types of repositories, which are under no obligation or expectation to record or publish any metrics on how often they&#39;re checked out or by whom."}], "answers": [{"tags": [], "owner": {"reputation": 840, "user_id": 8367411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jXRPZ.jpg?s=128&g=1", "display_name": "Narendar Reddy M", "link": "https://stackoverflow.com/users/8367411/narendar-reddy-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1553663641, "creation_date": 1553663641, "answer_id": 55370215, "question_id": 55370082, "link": "https://stackoverflow.com/questions/55370082/how-to-get-stats-on-go-packages/55370215#55370215", "title": "How to get stats on go packages?", "body": "<p>You Can't do this.\nAs those are developed as part of Go language. Like npm packages you are not downloading it.</p>\n"}, {"tags": [], "owner": {"reputation": 2702, "user_id": 2923336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LmjCO.png?s=128&g=1", "display_name": "Francois", "link": "https://stackoverflow.com/users/2923336/francois"}, "is_accepted": false, "score": 0, "last_activity_date": 1553663693, "creation_date": 1553663693, "answer_id": 55370220, "question_id": 55370082, "link": "https://stackoverflow.com/questions/55370082/how-to-get-stats-on-go-packages/55370220#55370220", "title": "How to get stats on go packages?", "body": "<p>Go doesn't have a centralized package registry such as npm or pip. </p>\n\n<p>Also, go dependency management is still not \"unified\", some use <code>dep</code> some <code>glide</code> or <code>go mod</code>. All of these rely on version control software such as git.    </p>\n\n<p>If your package is on Github, you could check the Insights > Traffic tab and see unique cloners for example.</p>\n\n<p>Another solution might be to implement a proxy to your git server to track clones.</p>\n"}, {"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1553665778, "creation_date": 1553665778, "answer_id": 55370584, "question_id": 55370082, "link": "https://stackoverflow.com/questions/55370082/how-to-get-stats-on-go-packages/55370584#55370584", "title": "How to get stats on go packages?", "body": "<p>That may happen once the Go Notary service described in \"<a href=\"https://blog.golang.org/modules2019\" rel=\"nofollow noreferrer\">Go Modules in 2019</a>\" is in place:</p>\n\n<blockquote>\n  <p>For publicly-available modules, we intend to run a service we call a notary that follows the module index log, downloads new modules, and cryptographically signs statements of the form \u201cmodule M at version V has file tree hash H.\u201d The notary service will publish all these notarized hashes in a queryable, <a href=\"https://www.certificate-transparency.org/\" rel=\"nofollow noreferrer\">Certificate Transparency</a>-style <a href=\"http://static.usenix.org/event/sec09/tech/full_papers/crosby.pdf\" rel=\"nofollow noreferrer\">tamper-proof log</a>, so that anyone can verify that the notary is behaving correctly.<br>\n  This log will serve as a public, global <code>go.sum</code> file that go get can use to authenticate modules when adding or updating dependencies.</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/ezki6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ezki6.png\" alt=\"https://blog.golang.org/modules2019/code.png\"></a></p>\n\n<blockquote>\n  <p>We are aiming to have the go command check notarized hashes for publicly-available modules not already in go.sum starting in Go 1.13. </p>\n</blockquote>\n\n<p>If statistics were to be produced, the Go notary would be a reliable source (for public packages)</p>\n"}, {"tags": [], "owner": {"reputation": 166, "user_id": 11904651, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WUMVN-fvfNk/AAAAAAAAAAI/AAAAAAAAAOY/j_7iNZcBCGU/photo.jpg?sz=128", "display_name": "Ankush Chadha", "link": "https://stackoverflow.com/users/11904651/ankush-chadha"}, "is_accepted": false, "score": 0, "last_activity_date": 1575580584, "creation_date": 1575580584, "answer_id": 59203393, "question_id": 55370082, "link": "https://stackoverflow.com/questions/55370082/how-to-get-stats-on-go-packages/59203393#59203393", "title": "How to get stats on go packages?", "body": "<p>try gocenter.io, it includes download stats for all modules available. Example - logrus was downloaded 544k+ times - <a href=\"https://search.gocenter.io/github.com~2Fsirupsen~2Flogrus/info?version=v1.4.3-0.20191026113918-67a7fdcf741f\" rel=\"nofollow noreferrer\">https://search.gocenter.io/github.com~2Fsirupsen~2Flogrus/info?version=v1.4.3-0.20191026113918-67a7fdcf741f</a></p>\n"}], "owner": {"reputation": 118, "user_id": 4109892, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Xv2cxDp0-BQ/AAAAAAAAAAI/AAAAAAAAABg/nb_kyLVnfP4/photo.jpg?sz=128", "display_name": "Vinayak Agrawal", "link": "https://stackoverflow.com/users/4109892/vinayak-agrawal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 527, "favorite_count": 1, "closed_date": 1575581174, "answer_count": 4, "score": 0, "last_activity_date": 1575580584, "creation_date": 1553662727, "last_edit_date": 1553665805, "question_id": 55370082, "link": "https://stackoverflow.com/questions/55370082/how-to-get-stats-on-go-packages", "closed_reason": "Not suitable for this site", "title": "How to get stats on go packages?", "body": "<p>I am trying to track and understand the download stats for various go packages to evaluate the download patter over time for the go driver published and released by my team. \nSomething similar to npm-stats\n<a href=\"https://npm-stat.com/\" rel=\"nofollow noreferrer\">https://npm-stat.com/</a></p>\n\n<p>I see similar stats available for <code>pip-python</code> and <code>npm</code>. \n<a href=\"https://npm-stat.com/\" rel=\"nofollow noreferrer\">https://npm-stat.com/</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1553662814, "post_id": 55370019, "comment_id": 97462903, "body": "Conversion to string <b>cannot</b> be done with string(now). Take the Tour of Go. Use fmt.Sprintf to convert numbers to strings or use time.Time.Format."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1553693112, "post_id": 55370019, "comment_id": 97478802, "body": "Most basic questions are answered within the <a href=\"https://tour.golang.org\" rel=\"nofollow noreferrer\">Tour of Go</a> which only takes a few minutes to finish."}], "answers": [{"tags": [], "owner": {"reputation": 440, "user_id": 6047557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f95e6e714cdc9f1c7d1df1d9398cad0e?s=128&d=identicon&r=PG&f=1", "display_name": "perennial_noob", "link": "https://stackoverflow.com/users/6047557/perennial-noob"}, "is_accepted": false, "score": 0, "last_activity_date": 1553663449, "last_edit_date": 1553663449, "creation_date": 1553662887, "answer_id": 55370110, "question_id": 55370019, "link": "https://stackoverflow.com/questions/55370019/why-cant-i-convert-epoch-time-to-a-string/55370110#55370110", "title": "Why can&#39;t I convert epoch time to a string?", "body": "<p>You are doing a lot of calculations which are not needed if you use <code>time</code>'s functions as exemplified here - <a href=\"https://gobyexample.com/time-formatting-parsing\" rel=\"nofollow noreferrer\">https://gobyexample.com/time-formatting-parsing</a></p>\n\n<p>Also. if all you need to do is to print an integer, you don't have to convert it to a string but simply use a format specifier like:</p>\n\n<pre><code>func main() {\n    now := time.Now().UnixNano() / int64(time.Millisecond)\n    //now is an int64 as you may have observed\n    fmt.Printf(\"%d\", now)\n    //or even fmt.Println(now)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1059, "user_id": 1982418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbe9fddd5823aa8ae6a41ec889f0f581?s=128&d=identicon&r=PG&f=1", "display_name": "sh.seo", "link": "https://stackoverflow.com/users/1982418/sh-seo"}, "is_accepted": false, "score": 0, "last_activity_date": 1553663188, "creation_date": 1553663188, "answer_id": 55370151, "question_id": 55370019, "link": "https://stackoverflow.com/questions/55370019/why-cant-i-convert-epoch-time-to-a-string/55370151#55370151", "title": "Why can&#39;t I convert epoch time to a string?", "body": "<p>main.go </p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"time\"\n\nfunc main() {\n    nanos := time.Now().UnixNano()\n    fmt.Println(time.Unix(0, nanos))\n\n    millis := nanos / 1000000\n    fmt.Println(millis)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2697, "user_id": 4650581, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hmKpWSd9B4U/AAAAAAAAAAI/AAAAAAAAAK4/xL06IHBoIyo/photo.jpg?sz=128", "display_name": "Misagh", "link": "https://stackoverflow.com/users/4650581/misagh"}, "is_accepted": false, "score": 0, "last_activity_date": 1600516255, "creation_date": 1600516255, "answer_id": 63968457, "question_id": 55370019, "link": "https://stackoverflow.com/questions/55370019/why-cant-i-convert-epoch-time-to-a-string/63968457#63968457", "title": "Why can&#39;t I convert epoch time to a string?", "body": "<p>Take a look at <a href=\"https://golang.org/pkg/strconv/\" rel=\"nofollow noreferrer\">strconv</a>.</p>\n<blockquote>\n<p>Package strconv implements conversions to and from string\nrepresentations of basic data types.</p>\n</blockquote>\n<p>In your case, for converting an <a href=\"https://golang.org/pkg/builtin/#int64\" rel=\"nofollow noreferrer\">int64</a> number to a <a href=\"https://golang.org/pkg/builtin/#string\" rel=\"nofollow noreferrer\">string</a>, you may need to use <a href=\"https://golang.org/pkg/strconv/#FormatInt\" rel=\"nofollow noreferrer\">FormatInt</a> as below:</p>\n<blockquote>\n<p><em>func FormatInt(i int64, base int) string</em></p>\n<p>FormatInt returns the string representation of i in the given base,\nfor 2 &lt;= base &lt;= 36. The result uses the lower-case letters 'a' to 'z'\nfor digit values &gt;= 10.</p>\n</blockquote>\n<pre><code>convertedString := strconv.FormatInt(YOUR_NUMBER, 10)\n</code></pre>\n<hr />\n<p>And Here is an example of <a href=\"https://gobyexample.com/epoch\" rel=\"nofollow noreferrer\">Epoch (https://gobyexample.com/epoch),</a> using the <a href=\"https://golang.org/pkg/time/\" rel=\"nofollow noreferrer\">time</a> package:</p>\n<pre><code>func main() {\n\n    now := time.Now()\n    secs := now.Unix()\n    nanos := now.UnixNano()\n    fmt.Println(now)\n\n    millis := nanos / 1000000\n    fmt.Println(secs)\n    fmt.Println(millis)\n    fmt.Println(nanos)\n\n    fmt.Println(time.Unix(secs, 0))\n    fmt.Println(time.Unix(0, nanos))\n}\n</code></pre>\n<p>output:</p>\n<pre><code>$ go run epoch.go \n2012-10-31 16:13:58.292387 +0000 UTC\n1351700038\n1351700038292\n1351700038292387000\n2012-10-31 16:13:58 +0000 UTC\n2012-10-31 16:13:58.292387 +0000 UTC\n</code></pre>\n"}], "owner": {"reputation": 655, "user_id": 7876925, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/fdac30f58f392c89bf381896b097d0b9?s=128&d=identicon&r=PG&f=1", "display_name": "Mary", "link": "https://stackoverflow.com/users/7876925/mary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 3, "score": -3, "last_activity_date": 1600516255, "creation_date": 1553662344, "last_edit_date": 1553671496, "question_id": 55370019, "link": "https://stackoverflow.com/questions/55370019/why-cant-i-convert-epoch-time-to-a-string", "title": "Why can&#39;t I convert epoch time to a string?", "body": "<p>I have the following program:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    now := time.Now().UnixNano() / int64(time.Millisecond)\n    nowString := string(now)\n    fmt.Println(nowString)\n}\n</code></pre>\n\n<p>I'm expecting the epoch time to be printed as a string. Instead I get:</p>\n\n<pre><code>\ufffd\n</code></pre>\n\n<p>How do I fix this error?</p>\n"}, {"tags": ["go", "winapi", "networking"], "comments": [{"owner": {"reputation": 1391, "user_id": 240750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7aec284f4746da267863b4f3363a30f?s=128&d=identicon&r=PG", "display_name": "Cytown", "link": "https://stackoverflow.com/users/240750/cytown"}, "edited": false, "score": 0, "creation_date": 1553675755, "post_id": 55369964, "comment_id": 97467879, "body": "check this answer: <a href=\"https://stackoverflow.com/questions/39592607/get-ssid-other-network-information-in-golang\" title=\"get ssid other network information in golang\">stackoverflow.com/questions/39592607/&hellip;</a>"}, {"owner": {"reputation": 302, "user_id": 3856170, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/664c9879e1edc98551398dee37f3276f?s=128&d=identicon&r=PG&f=1", "display_name": "VikasPushkar", "link": "https://stackoverflow.com/users/3856170/vikaspushkar"}, "reply_to_user": {"reputation": 1391, "user_id": 240750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7aec284f4746da267863b4f3363a30f?s=128&d=identicon&r=PG", "display_name": "Cytown", "link": "https://stackoverflow.com/users/240750/cytown"}, "edited": false, "score": 0, "creation_date": 1553681670, "post_id": 55369964, "comment_id": 97471465, "body": "Thanks, should work for Wifi only on MAC and Linux but i need a solution for Wifi,LAN, Cellular on MAC,Windows."}], "answers": [{"comments": [{"owner": {"reputation": 302, "user_id": 3856170, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/664c9879e1edc98551398dee37f3276f?s=128&d=identicon&r=PG&f=1", "display_name": "VikasPushkar", "link": "https://stackoverflow.com/users/3856170/vikaspushkar"}, "edited": false, "score": 0, "creation_date": 1554957329, "post_id": 55377706, "comment_id": 97941790, "body": "Is there any similar way on OSx as well? i found netlink socket can help on linux but not on OSx."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 302, "user_id": 3856170, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/664c9879e1edc98551398dee37f3276f?s=128&d=identicon&r=PG&f=1", "display_name": "VikasPushkar", "link": "https://stackoverflow.com/users/3856170/vikaspushkar"}, "edited": false, "score": 2, "creation_date": 1554982210, "post_id": 55377706, "comment_id": 97954046, "body": "I have zero experience with this platform. Quick googling turns up <a href=\"https://stackoverflow.com/questions/1083701/\">this</a> which refers to <a href=\"https://github.com/tonymillion/Reachability\" rel=\"nofollow noreferrer\">that</a>, in which the README discusses how to combine that with the stock <code>NSNotifications</code> to get notified. So I&#39;d start there."}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 2, "last_activity_date": 1553691178, "creation_date": 1553691178, "answer_id": 55377706, "question_id": 55369964, "link": "https://stackoverflow.com/questions/55369964/detect-network-connection-availability-changes/55377706#55377706", "title": "Detect network connection availability changes", "body": "<p>I doubt there would be such a solution.</p>\n\n<p>Every project which tries to provide some platform-agnostic solution to an inherently OS-tied problem inevitably hides the platform-specific details behind a common API.\nLook at <a href=\"https://github.com/fsnotify/fsnotify\" rel=\"nofollow noreferrer\">https://github.com/fsnotify/fsnotify</a> for a good example.</p>\n\n<p>So, I'd take that route and would have put up a package which would have two platform-specific \"backends\" which would be compiled conditionally using build tags.</p>\n\n<p>To get notified about network-related events under Windows,\nyou should probably start <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/Netlistmgr/nn-netlistmgr-inetworkevents\" rel=\"nofollow noreferrer\">here</a>.\nUnfortunately, this stuff is COM-oriented, but you could use <a href=\"https://github.com/go-ole/go-ole\" rel=\"nofollow noreferrer\">https://github.com/go-ole/go-ole</a> to help with that.</p>\n\n<p>You might also ask a non-Go-specific question tagged <code>winapi</code> to ask about what would be the best way to hook into the kernel to get notified about the availability of the networks.</p>\n"}, {"tags": [], "owner": {"reputation": 302, "user_id": 3856170, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/664c9879e1edc98551398dee37f3276f?s=128&d=identicon&r=PG&f=1", "display_name": "VikasPushkar", "link": "https://stackoverflow.com/users/3856170/vikaspushkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1560850382, "creation_date": 1560850382, "answer_id": 56646004, "question_id": 55369964, "link": "https://stackoverflow.com/questions/55369964/detect-network-connection-availability-changes/56646004#56646004", "title": "Detect network connection availability changes", "body": "<p>There is no platform agnostic solution that exists, however platforms like OSx,Linux,Windiws has ways to get network events with their platform specific limitations.</p>\n\n<p><strong>OSx</strong>:   Raw socket SOCK_RAW of AF_ROUTE type can be used to detect any network events that occurs in user machine. there are various types of network event that can be detected.\n<a href=\"https://stackoverflow.com/questions/36347807/how-to-monitor-ip-address-change-using-rtnetlink-socket-in-go-language\">This thread talk about an example on BSD for network event</a></p>\n\n<p><strong>Windows</strong> : Windows has its APIs given as part of iphlpapi library. APIs like NotifyAddrChange, NotifyRouteChange allows you to have almost all network events( apart from metric change etc.) <a href=\"https://gist.github.com/LiamHaworth/72f96c28fc90936904ba70ae5299218f\" rel=\"nofollow noreferrer\">this git repo</a> has a working example NotifyAddrChange, which gives back and event whenever a interface goes down or comes up.</p>\n\n<p><strong>Linux</strong> : In Linux netlink sockets allows a user space application to receive network events using netlink sockets.</p>\n"}], "owner": {"reputation": 302, "user_id": 3856170, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/664c9879e1edc98551398dee37f3276f?s=128&d=identicon&r=PG&f=1", "display_name": "VikasPushkar", "link": "https://stackoverflow.com/users/3856170/vikaspushkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 711, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1560850382, "creation_date": 1553662011, "last_edit_date": 1553691194, "question_id": 55369964, "link": "https://stackoverflow.com/questions/55369964/detect-network-connection-availability-changes", "title": "Detect network connection availability changes", "body": "<p>I am writing a Go application for Mac and Windows, which will perform some action whenever there is a network change( Client move from <code>Wi-fi 1</code> to <code>Wi-fi 2</code> or to 3G to LAN). I am aware of a solution for Application running on mac in swift language but I am looking for a platform-agnostic solution here.</p>\n\n<p>So far I have tried checking for an event on an interface but I am not sure if that is sufficient.</p>\n\n<p>I expect that on a network change (moving from Wifi-1 to Wifi-2 or 3G or LAN) my Go app should be able to know to take some action.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1553675523, "post_id": 55370012, "comment_id": 97467775, "body": "You really don&#39;t need a command to read a file. Use <a href=\"https://golang.org/pkg/io/ioutil/#ReadFile\" rel=\"nofollow noreferrer\">ioutil.ReadFile</a>, for instance."}], "tags": [], "owner": {"reputation": 139, "user_id": 6217600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b4595e1f5c15da4a225bdd167ba0976?s=128&d=identicon&r=PG&f=1", "display_name": "jerry", "link": "https://stackoverflow.com/users/6217600/jerry"}, "is_accepted": false, "score": 1, "last_activity_date": 1553662315, "creation_date": 1553662315, "answer_id": 55370012, "question_id": 55369754, "link": "https://stackoverflow.com/questions/55369754/how-to-get-timezone-database-name/55370012#55370012", "title": "How to get timezone database name", "body": "<p>finally I go with the code below</p>\n\n<p>timezone, err := exec.Command(\"cat\", \"/etc/timezone\").CombinedOutput()</p>\n"}], "owner": {"reputation": 139, "user_id": 6217600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b4595e1f5c15da4a225bdd167ba0976?s=128&d=identicon&r=PG&f=1", "display_name": "jerry", "link": "https://stackoverflow.com/users/6217600/jerry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "closed_date": 1553677946, "answer_count": 1, "score": 0, "last_activity_date": 1574154325, "creation_date": 1553660370, "last_edit_date": 1574154325, "question_id": 55369754, "link": "https://stackoverflow.com/questions/55369754/how-to-get-timezone-database-name", "closed_reason": "Needs details or clarity", "title": "How to get timezone database name", "body": "<p>I am trying to get the tz database name with Go running on Debian, such as \"US/Arizona\" but didn't find a way.  I can get timezone abbreviation but it is not what I want.</p>\n\n<p>I searched online and didn't find any clue.</p>\n\n<p>Any idea, folks?</p>\n"}, {"tags": ["windows", "go", "winapi"], "comments": [{"owner": {"reputation": 7, "user_id": 10075854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99509475fbcf7335f936070f5b37f0f2?s=128&d=identicon&r=PG", "display_name": "user10075854", "link": "https://stackoverflow.com/users/10075854/user10075854"}, "edited": false, "score": 0, "creation_date": 1553656703, "post_id": 55369254, "comment_id": 97461646, "body": "The code is written in go."}, {"owner": {"reputation": 13237, "user_id": 611545, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YXVOl.jpg?s=128&g=1", "display_name": "Ross Bush", "link": "https://stackoverflow.com/users/611545/ross-bush"}, "edited": false, "score": 0, "creation_date": 1553657221, "post_id": 55369254, "comment_id": 97461742, "body": "Is this helpful --&gt; <a href=\"https://docs.microsoft.com/en-us/windows/desktop/CIMWin32Prov/setdnsserversearchorder-method-in-class-win32-networkadapterconfiguration\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/windows/desktop/CIMWin32Prov/&hellip;</a>"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1553678115, "post_id": 55369254, "comment_id": 97469312, "body": "Which code? I do not see any."}], "answers": [{"tags": [], "owner": {"reputation": 6168, "user_id": 10611792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r727s.jpg?s=128&g=1", "display_name": "Drake Wu", "link": "https://stackoverflow.com/users/10611792/drake-wu"}, "is_accepted": false, "score": -1, "last_activity_date": 1553675186, "last_edit_date": 1553675186, "creation_date": 1553669004, "answer_id": 55371267, "question_id": 55369254, "link": "https://stackoverflow.com/questions/55369254/changes-to-the-registry-do-not-take-effect/55371267#55371267", "title": "Changes to the registry do not take effect", "body": "<p>Yes, you can. However, <code>DhcpNotifyConfigChange</code> is a unexposed interface located in dhcpcsvc.dll. And its parameters:</p>\n\n<pre><code>BOOL DhcpNotifyConfigChange(\nLPWSTR lpwszServerName,     // local machine should be NULL\nLPWSTR lpwszAdapterName,    // Adapt name\nBOOL bNewIpAddress,     // TRUE indicates changing ip\nDWORD dwIpIndex,        // which IP addr, if only 1, it's 0\nDWORD dwIpAddress,  // IP addr\nDWORD dwSubNetMask,     // mask\nint nDhcpAction ); // DHCP, 0 for not change, 1 for enable, 2 for disable DHCP\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 10075854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99509475fbcf7335f936070f5b37f0f2?s=128&d=identicon&r=PG", "display_name": "user10075854", "link": "https://stackoverflow.com/users/10075854/user10075854"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1553675186, "creation_date": 1553656610, "question_id": 55369254, "link": "https://stackoverflow.com/questions/55369254/changes-to-the-registry-do-not-take-effect", "title": "Changes to the registry do not take effect", "body": "<p>How to make the Settings take effect as soon as possible after setting the registry nic dns information on Windows 7 ?\nCan I use the function DhcpNotifyConfigChange? How do I set the parameters?</p>\n"}, {"tags": ["go", "channels"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1553654377, "post_id": 55368820, "comment_id": 97461144, "body": "Show what you tried so far."}, {"owner": {"reputation": 25, "user_id": 10892699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33f25c3ec0f4a109b5cdca4ff9940efc?s=128&d=identicon&r=PG&f=1", "display_name": "gusfring", "link": "https://stackoverflow.com/users/10892699/gusfring"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1553654531, "post_id": 55368820, "comment_id": 97461165, "body": "I wrote exactly what I did correctly (creating the channels) and where I&#39;m stuck (writing a function that will pass information from channel to channel by order and will increment the passed value by one."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1553654653, "post_id": 55368820, "comment_id": 97461193, "body": "Don&#39;t make us guess what code you wrote from your prose.  Show the code."}, {"owner": {"reputation": 25, "user_id": 10892699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33f25c3ec0f4a109b5cdca4ff9940efc?s=128&d=identicon&r=PG&f=1", "display_name": "gusfring", "link": "https://stackoverflow.com/users/10892699/gusfring"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1553654977, "post_id": 55368820, "comment_id": 97461257, "body": "Uploaded. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 3, "creation_date": 1553656761, "post_id": 55369163, "comment_id": 97461658, "body": "Add a description explaining why these solutions work: they create a goroutine that receives a value, increments the value and sends it to the next channel."}], "tags": [], "owner": {"reputation": 579, "user_id": 11206879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bS2D6.png?s=128&g=1", "display_name": "Pan Ke", "link": "https://stackoverflow.com/users/11206879/pan-ke"}, "is_accepted": false, "score": 1, "last_activity_date": 1553656297, "last_edit_date": 1553656297, "creation_date": 1553655836, "answer_id": 55369163, "question_id": 55368820, "link": "https://stackoverflow.com/questions/55368820/passing-info-from-channel-to-channel-while-altering-it-in-go/55369163#55369163", "title": "Passing info from channel to channel while altering it in go", "body": "<p><a href=\"https://play.golang.org/p/ku-Dretm8EA\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ku-Dretm8EA</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc add1(in chan int) (chan int)  {\n    i := &lt;-in\n    out := make(chan int, 1)\n    out &lt;- (i+1)\n    return out\n}\n\nfunc main() {\n    ch := make(chan int, 1)\n    ch &lt;- 1\n    for i := 0; i &lt; 100000; i++ {\n        ch = add1(ch)\n    }\n    fmt.Println(&lt;-ch)\n}\n\n</code></pre>\n\n<p>another solution: <a href=\"https://play.golang.org/p/uWVxSG0xgqU\" rel=\"nofollow noreferrer\">https://play.golang.org/p/uWVxSG0xgqU</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc add1(in, out chan int)  {\n    i := &lt;-in\n    out &lt;- (i+1)\n}\n\nfunc main() {\n    start := make(chan int)\n    var in = start\n    var ch chan int\n    for i := 0; i &lt; 100000; i++ {\n        ch = make(chan int)\n        go add1(in, ch)\n        in = ch\n    }\n    start &lt;- 1\n    fmt.Println(&lt;-ch)\n}\n\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10892699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33f25c3ec0f4a109b5cdca4ff9940efc?s=128&d=identicon&r=PG&f=1", "display_name": "gusfring", "link": "https://stackoverflow.com/users/10892699/gusfring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553660982, "creation_date": 1553653226, "last_edit_date": 1553660982, "question_id": 55368820, "link": "https://stackoverflow.com/questions/55368820/passing-info-from-channel-to-channel-while-altering-it-in-go", "title": "Passing info from channel to channel while altering it in go", "body": "<p>I'm new to the go programming language.\nI just learned about channels from their website, and tried to create\nThe following program:\n1) I want to create 100,000 channels.\n2) when the first channel receives a msg (value) he adds 1 to it\n and pass it on to the next channel (by order).\n3) when we'll get to the last channel it Will print 100,001.</p>\n\n<p>I have created the channels with a loop, but I find it difficult to find\nhow to pass and alter the data in a \"domino\" fashion like I described.\nAny solution or reference would be appreciated.\nThanks!</p>\n\n<p>Here is my code:</p>\n\n<pre><code>package main\n\nfunc addOneAndPass(c1 chan int, c2 chan int)  {\n    c := make(chan int)\n    c &lt;- 1\n    val := &lt;- c\n}\n\nfunc main() {\n    const n = 100000\n    var channels [n]chan int\n    for i := 0; i &lt; n; i++ {\n        channels[i] = make(chan int)\n    }\n\n}\n</code></pre>\n"}, {"tags": ["go", "nats.io", "nats-streaming-server"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1553651308, "post_id": 55368487, "comment_id": 97460571, "body": "Or you could upload it to some shared storage and only send a key to it."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 6083578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc70b3357b640223074b07295ec02c30?s=128&d=identicon&r=PG&f=1", "display_name": "MrSir", "link": "https://stackoverflow.com/users/6083578/mrsir"}, "edited": false, "score": 2, "creation_date": 1554205426, "post_id": 55406149, "comment_id": 97658362, "body": "You can change the message size for nats while configuring the server."}], "tags": [], "owner": {"reputation": 8750, "user_id": 1771556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XPkeq.jpg?s=128&g=1", "display_name": "Vadim Ashikhman", "link": "https://stackoverflow.com/users/1771556/vadim-ashikhman"}, "is_accepted": false, "score": 3, "last_activity_date": 1553804053, "creation_date": 1553804053, "answer_id": 55406149, "question_id": 55368487, "link": "https://stackoverflow.com/questions/55368487/send-a-message-larger-than-1mb-using-nats-streaming/55406149#55406149", "title": "send a message larger than 1MB using nats-streaming?", "body": "<p>According to NATS FAQ you cannot send a message which size exceeds 1M (<a href=\"https://nats.io/documentation/faq/#msgsize\" rel=\"nofollow noreferrer\">https://nats.io/documentation/faq/#msgsize</a>):</p>\n\n<blockquote>\n  <p>NATS does have a message size limitation that is enforced by the server and communicated to the client during connection setup. Currently, the limit is 1MB.</p>\n</blockquote>\n\n<p>Messaging systems are not supposed to be used for file transfer. Use a distributed storage service to hold files and pass file ID in the message.</p>\n"}, {"tags": [], "owner": {"reputation": 12640, "user_id": 1112963, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/L8CVX.jpg?s=128&g=1", "display_name": "Zon", "link": "https://stackoverflow.com/users/1112963/zon"}, "is_accepted": false, "score": 2, "last_activity_date": 1576588187, "last_edit_date": 1576588187, "creation_date": 1576558611, "answer_id": 59367820, "question_id": 55368487, "link": "https://stackoverflow.com/questions/55368487/send-a-message-larger-than-1mb-using-nats-streaming/59367820#59367820", "title": "send a message larger than 1MB using nats-streaming?", "body": "<p>You can start Nats with a configuration file to define messages max size:</p>\n\n<pre><code>$ nats-server --config /path/to/nats.config\n</code></pre>\n\n<p>Configuration file example:</p>\n\n<pre><code># Override message size limit (bytes):\nmax_payload: 100000000\n</code></pre>\n\n<p>See available options at <a href=\"https://docs.nats.io/nats-server/configuration#configuration-properties\" rel=\"nofollow noreferrer\">https://docs.nats.io/nats-server/configuration#configuration-properties</a></p>\n"}], "owner": {"reputation": 33, "user_id": 6083578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc70b3357b640223074b07295ec02c30?s=128&d=identicon&r=PG&f=1", "display_name": "MrSir", "link": "https://stackoverflow.com/users/6083578/mrsir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3390, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1576588187, "creation_date": 1553650171, "last_edit_date": 1576568564, "question_id": 55368487, "link": "https://stackoverflow.com/questions/55368487/send-a-message-larger-than-1mb-using-nats-streaming", "title": "send a message larger than 1MB using nats-streaming?", "body": "<p>I am trying to send a file using the nats messaging service. The size of the files may vary. Is there a way to send more than 1MB of data in a message body, or possible break and join the message body?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": false, "score": 6, "last_activity_date": 1553648600, "creation_date": 1553648600, "answer_id": 55368318, "question_id": 55368288, "link": "https://stackoverflow.com/questions/55368288/cant-explain-why-55-is-converted-to-7/55368318#55368318", "title": "Cant explain why &quot;55&quot; is converted to &quot;7&quot;", "body": "<p>When you call <code>s, err := strconv.Atoi(\"55\")</code> you turn <code>s</code> into an integer. When you do <code>string(s)</code> afterwards, you're asking for a string that contains the character represented by that integer.</p>\n\n<p>That character happens to be <code>'7'</code>. Try <code>v := \"65\"</code> and you'll get <code>'A'</code>, etc.</p>\n"}, {"tags": [], "owner": {"reputation": 57639, "user_id": 104200, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/99c032d6037064046ac48634e362b2fa?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/104200/tim"}, "is_accepted": true, "score": 9, "last_activity_date": 1553648610, "creation_date": 1553648610, "answer_id": 55368320, "question_id": 55368288, "link": "https://stackoverflow.com/questions/55368288/cant-explain-why-55-is-converted-to-7/55368320#55368320", "title": "Cant explain why &quot;55&quot; is converted to &quot;7&quot;", "body": "<p><code>s</code> is an integer with the value 55, which is the ASCII (and UTF-8) encoding of the character <code>\"7\"</code>. That's what's printed from the last statement.</p>\n"}], "owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 55368320, "answer_count": 2, "score": 0, "last_activity_date": 1553648882, "creation_date": 1553648389, "question_id": 55368288, "link": "https://stackoverflow.com/questions/55368288/cant-explain-why-55-is-converted-to-7", "title": "Cant explain why &quot;55&quot; is converted to &quot;7&quot;", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n)\n\nfunc main() {\n    v := \"55\"\n    if s, err := strconv.Atoi(v); err == nil {\n        fmt.Println(string(v)) // 55\n        fmt.Println(s)         // 55\n        fmt.Println(string(s)) // 7\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/8V1npFiC9iH\" rel=\"nofollow noreferrer\">https://play.golang.org/p/8V1npFiC9iH</a></p>\n"}, {"tags": ["mysql", "sql", "go"], "answers": [{"tags": [], "owner": {"reputation": 1391, "user_id": 240750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7aec284f4746da267863b4f3363a30f?s=128&d=identicon&r=PG", "display_name": "Cytown", "link": "https://stackoverflow.com/users/240750/cytown"}, "is_accepted": false, "score": 1, "last_activity_date": 1553677666, "creation_date": 1553677666, "answer_id": 55373365, "question_id": 55368105, "link": "https://stackoverflow.com/questions/55368105/dynamic-sql-select-query-in-golang/55373365#55373365", "title": "Dynamic SQL select query in Golang", "body": "<p>You must first fetch the result columns count and then don't exceed the size.</p>\n\n<p>If you meant the query fields, you need dynamic create the query string, the params size must be the same.</p>\n"}, {"tags": [], "owner": {"reputation": 3315, "user_id": 1664109, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/JAlH9.jpg?s=128&g=1", "display_name": "RockOnGom", "link": "https://stackoverflow.com/users/1664109/rockongom"}, "is_accepted": false, "score": 1, "last_activity_date": 1553697091, "creation_date": 1553697091, "answer_id": 55379747, "question_id": 55368105, "link": "https://stackoverflow.com/questions/55368105/dynamic-sql-select-query-in-golang/55379747#55379747", "title": "Dynamic SQL select query in Golang", "body": "<p>I would create a query statement with the dynamic fields(use placeholder for avoiding sql injection):</p>\n\n<pre><code>rows := db.QueryRow(\"SELECT {{YOUR_FIELDS}} from table_tbl\")\n</code></pre>\n\n<p>Create variable carrier with the same size of columns</p>\n\n<pre><code>vals := make([]interface{}, len(rows.Columns()))\n</code></pre>\n\n<p>Use sql.RawBytes for field's type if you don't need type checking or can't know their types, otherwise use the same type of field.</p>\n\n<pre><code>for i, _ := range cols {\n    vals[i] = new(sql.RawBytes)\n    //check column name, if it is id, and you know it is integer\n    //vals[i] = new(int)\n}\n</code></pre>\n\n<p>Iterate rows and scan</p>\n\n<pre><code>for rows.Next() {\n    err = rows.Scan(vals...)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3255, "user_id": 2113612, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/blGG2.png?s=128&g=1", "display_name": "jakob", "link": "https://stackoverflow.com/users/2113612/jakob"}, "is_accepted": true, "score": 3, "last_activity_date": 1553791721, "creation_date": 1553791721, "answer_id": 55402952, "question_id": 55368105, "link": "https://stackoverflow.com/questions/55368105/dynamic-sql-select-query-in-golang/55402952#55402952", "title": "Dynamic SQL select query in Golang", "body": "<p>From what I know (also not much experienced in Go) if you don't assign a real type to value then <code>Scan</code> will return <code>[]byte</code> and when it is marshalled it returns base64 encoded string.</p>\n\n<p>So you have to assign a type to your columns and if you want proper json then assign keys to values.</p>\n\n<p>In your example it can be done something like this:</p>\n\n<pre><code>cols := []string{\"id\", \"first_name\", \"last_name\"}\nvals := make([]interface{}, len(cols))\nresult := make(map[string]interface{}, len(cols))\n\nfor i, key := range cols {\n    switch key {\n    case \"id\", \"status\":\n        vals[i] = new(int)\n    default:\n        vals[i] = new(string)\n    }\n\n    result[key] = vals[i]\n}\n\nb, _ := json.Marshal(result)\nfmt.Println(string(b))\n</code></pre>\n\n<p>So, instead of looping over <code>cols</code> and creating new interface for each column, now we are creating key/value pairs and assigning type based on column name.</p>\n\n<p>Also, if you have nullable columns in table, and you probably have, then you'll get error because <code>nil</code> can't go into <code>string</code>. So I suggest this package <code>gopkg.in/guregu/null.v3</code> and then assign type like <code>null.String</code>. That way you'll get back <code>null</code> as a value.</p>\n\n<p>For example:</p>\n\n<pre><code>for i, key := range cols {\n    switch key {\n    case \"id\", \"status\":\n        vals[i] = new(int)\n    case \"updated_at\", \"created_at\":\n        vals[i] = new(null.Time)\n    default:\n        vals[i] = new(null.String)\n    }\n\n    result[key] = vals[i]\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 1698821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c075e6bad0b3e8777dfb12662d86fe1?s=128&d=identicon&r=PG", "display_name": "user1698821", "link": "https://stackoverflow.com/users/1698821/user1698821"}, "is_accepted": false, "score": 1, "last_activity_date": 1591909035, "creation_date": 1591909035, "answer_id": 62333455, "question_id": 55368105, "link": "https://stackoverflow.com/questions/55368105/dynamic-sql-select-query-in-golang/62333455#62333455", "title": "Dynamic SQL select query in Golang", "body": "<p>Here is an option that a found to return dynamic resultset, you will need a interface{} array but you have to assign to a new(interface{}) to get a pointer that can be write by Scan method</p>\n\n<pre><code>//...\ntypes, _ := rows.ColumnTypes()  \nfor rows.Next() {\n row := make([]interface{}, len(types))\n for i := range types {\n    row[i] = new(interface{})\n }\n rows.Scan(row...)\n}\n</code></pre>\n"}], "owner": {"reputation": 247, "user_id": 6307930, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/hLzvd.png?s=128&g=1", "display_name": "Space Peasant", "link": "https://stackoverflow.com/users/6307930/space-peasant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5471, "favorite_count": 0, "accepted_answer_id": 55402952, "answer_count": 4, "score": 3, "last_activity_date": 1591909035, "creation_date": 1553646622, "last_edit_date": 1555074865, "question_id": 55368105, "link": "https://stackoverflow.com/questions/55368105/dynamic-sql-select-query-in-golang", "title": "Dynamic SQL select query in Golang", "body": "<p>I am trying to build API, with database/sql and mysql driver, that will read data based on URL parameters.<br>\nSomething like this</p>\n\n<pre><code>myapi.com/users?columns=id,first_name,last_name,country&amp;sort=desc&amp;sortColumn=last_name&amp;limit=10&amp;offset=20\n</code></pre>\n\n<p>I know how to get all columns or just specific columns when it is defined in struct. But I want to know is it possible to get columns from url and instead of predefined struct save it to map and than just scan those columns.<br>\nI have working code that will get data from above endpoint only if number of columns is same as in struct. If I remove <code>country</code> for example I get error that <code>Scan</code> expects 4 params but 3 are given.</p>\n\n<p>I don't need specific code, just some directions since I am learning Go and my background is PHP where this is easier to do.</p>\n\n<p><strong>Update</strong></p>\n\n<p>Thanks to answers I have partly working solution.<br>\nHere is code:</p>\n\n<pre><code>cols := []string{\"id\", \"first_name\", \"last_name\"}\nvals := make([]interface{}, len(cols))\nw := map[string]interface{}{\"id\": 105}\n\nvar whereVal []interface{}\nvar whereCol []string\n\nfor k, v := range w {\n    whereVal = append(whereVal, v)\n    whereCol = append(whereCol, fmt.Sprintf(\"%s = ?\", k))\n}\n\nfor i := range cols {\n    vals[i] = new(interface{})\n}\nerr := db.QueryRow(\"SELECT \"+strings.Join(cols, \",\")+\" FROM users WHERE \"+strings.Join(whereCol, \" AND \"), whereVal...).Scan(vals...)\n\nif err != nil {\n    fmt.Println(err)\n}\n\nb, _ := json.Marshal(vals)\nfmt.Println(string(b))\n</code></pre>\n\n<p>This should query <code>SELECT id, first_name, last_name FROM users WHERE id = 105;</code></p>\n\n<p>But how do I get data out to proper json object? Now it prints out strings encoded in base64 like this.</p>\n\n<pre><code>[105,\"Sm9obm55\",\"QnJhdm8=\"]\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 2936, "user_id": 39791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/661c7cc5565e5bc21fb0fc22c0354fef?s=128&d=identicon&r=PG", "display_name": "Joe McMahon", "link": "https://stackoverflow.com/users/39791/joe-mcmahon"}, "is_accepted": true, "score": 4, "last_activity_date": 1553647992, "creation_date": 1553647992, "answer_id": 55368232, "question_id": 55367876, "link": "https://stackoverflow.com/questions/55367876/how-to-store-the-identifications-for-goroutines-so-that-i-can-stop-them-later/55368232#55368232", "title": "How to store the identifications for goroutines so that I can stop them later", "body": "<p>The short answer is \"you can't\". Goroutines are not like Unix processes or threads; there's no PID or thread ID. </p>\n\n<p>You terminate a goroutine by writing a message to a channel shared between the main routine and the goroutine telling it you want it to go away instead of forcibly terminating it yourself. </p>\n\n<p>I won't reproduce the entire article from <a href=\"https://blog.golang.org/pipelines\" rel=\"nofollow noreferrer\">https://blog.golang.org/pipelines</a>; \nyou would be better off reading it there. High points:</p>\n\n<ul>\n<li>You make it possible to cancel a goroutine by sharing a channel with it (most often named <code>done</code>). The actual type of what you send on this channel is unimportant.</li>\n<li>When you want to send a \"everyone shut down\" message, you close the <code>done</code> channel. This causes any read on the channel to immediately succeed with a zero-valued instance of the channel's type, effectively broadcasting a \"stop\" to every goroutine reading the channel.</li>\n<li>The goroutines have at their core a select loop, which checks for input available on any input channel and on the <code>done</code> channel. Once the channel is closed, the <code>done</code> channel has input ready, and the goroutine cleans up and exits.</li>\n</ul>\n\n<p>The <code>context</code> type wraps this up and a number of other niceties; reading the <a href=\"https://blog.golang.org/context\" rel=\"nofollow noreferrer\">https://blog.golang.org/context</a> article will give you more details on using contexts to control goroutines.</p>\n\n<hr>\n"}], "owner": {"reputation": 956, "user_id": 1404195, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cc8d8fe40a513ac9369bf01b82e324ab?s=128&d=identicon&r=PG", "display_name": "The_Lost_Avatar", "link": "https://stackoverflow.com/users/1404195/the-lost-avatar"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "closed_date": 1553761563, "accepted_answer_id": 55368232, "answer_count": 1, "score": -4, "last_activity_date": 1553761613, "creation_date": 1553644721, "last_edit_date": 1553645484, "question_id": 55367876, "link": "https://stackoverflow.com/questions/55367876/how-to-store-the-identifications-for-goroutines-so-that-i-can-stop-them-later", "closed_reason": "Duplicate", "title": "How to store the identifications for goroutines so that I can stop them later", "body": "<p>I am trying to create multiple goroutines and keep them running concurrently. Then when a request comes in I want to identify one of them them and stop only that particular goroutine while the rest contiue</p>\n\n<h1>    File 1</h1>\n\n<pre><code>mm := remote_method.NewPlayerCreator()\n\nmm.NewPlayer(\"Leo\", \"Messi\")\n\n// Lets just assume that the method call starts a bot which starts playing football\n\nmm.NewPlayer(\"Cristiano\", \"Ronaldo\")\n\nmm.StopPlayer(\"Leo\", \"Messi\")\n</code></pre>\n\n<h1>    File 2</h1>\n\n<pre><code>package remote_method\n\ntype PlayerCreator struct {\n        playerNameChannelNumberMap (map[Player](chan int))\n}\n\ntype Player struct {\n        firstName, lastName string\n}\n\nfunc NewPlayerCreator() DeclaredType {\n        var nameChannelMap (map[Player](chan int))\n        m := PlayerCreator{nameChannelMap}\n        return m\n}\n\nfunc (mm NewPlayerCreator) NewPlayer(firstName string, lastName string) {\n     // Update the playerNameChannelNumberMap to add this new Player in the map\n     // Since maps are basically called by reference, the map withe the file 1 should be updated or should it ?\n     // Call to a goroutine that would create a new player and the player keeps on running in an infinite loop\n     // I can add the goroutine code in this method and not create a new method for the goroutine, if it makes more sense like this\n}\n\nfunc (mm NewPlayerCreator) StopPlayer(firstName string, lastName string) {\n     // Find the player channel in the map and send a done signal on receiving which it exits\n     // Remove the player entry from the map\n}\n</code></pre>\n\n<p>What are the best known practices for doing such a thing ?\nTIA</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 48983, "user_id": 314028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/408552a8101c1b9d466dcc5f104b1619?s=128&d=identicon&r=PG", "display_name": "Chris Taylor", "link": "https://stackoverflow.com/users/314028/chris-taylor"}, "edited": false, "score": 2, "creation_date": 1553644829, "post_id": 55367797, "comment_id": 97459310, "body": "One option might be <code>var factoryFn factory = func(v int) IFoo { return CreateFoo(v) }</code>. Then you could remove the explicit type and go with <code>var factoryFn = func(v int) IFoo { return CreateFoo(v) }</code>"}, {"owner": {"reputation": 1920, "user_id": 283325, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/96213e96b32f839dc6e218bfee2c4713?s=128&d=identicon&r=PG", "display_name": "Bryan", "link": "https://stackoverflow.com/users/283325/bryan"}, "reply_to_user": {"reputation": 48983, "user_id": 314028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/408552a8101c1b9d466dcc5f104b1619?s=128&d=identicon&r=PG", "display_name": "Chris Taylor", "link": "https://stackoverflow.com/users/314028/chris-taylor"}, "edited": false, "score": 0, "creation_date": 1553645159, "post_id": 55367797, "comment_id": 97459396, "body": "Boy I feel silly. That&#39;s a great/easy way to get around the restriction. Thanks! I am a little afraid that I&#39;m misunderstanding something important about the relation between &quot;Struct Pointers&quot; and &quot;Interfaces&quot; though, so I&#39;d still like to know why I can&#39;t do that assignment."}, {"owner": {"reputation": 48983, "user_id": 314028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/408552a8101c1b9d466dcc5f104b1619?s=128&d=identicon&r=PG", "display_name": "Chris Taylor", "link": "https://stackoverflow.com/users/314028/chris-taylor"}, "edited": false, "score": 1, "creation_date": 1553645524, "post_id": 55367797, "comment_id": 97459459, "body": "I was busy typing a more detailed explanation as an answer when your comment came in. You might want to read up on covariance and contravariance, which would help you understand why the function types are not interchangeable."}], "answers": [{"tags": [], "owner": {"reputation": 48983, "user_id": 314028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/408552a8101c1b9d466dcc5f104b1619?s=128&d=identicon&r=PG", "display_name": "Chris Taylor", "link": "https://stackoverflow.com/users/314028/chris-taylor"}, "is_accepted": true, "score": 2, "last_activity_date": 1553645432, "creation_date": 1553645432, "answer_id": 55367947, "question_id": 55367797, "link": "https://stackoverflow.com/questions/55367797/function-that-returns-a-struct-pointer-as-function-that-returns-an-interface/55367947#55367947", "title": "Function that returns a struct pointer as function that returns an interface", "body": "<p>The function type returning IFoo is a different type to the function returning *Foo even though Foo meets the requirements for IFoo, Go does not support covariance on the return type.</p>\n\n<p>You would need to wrap the function </p>\n\n<pre><code>var factoryFn = func(v int) IFoo { return CreateFoo(v) }\n</code></pre>\n"}], "owner": {"reputation": 1920, "user_id": 283325, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/96213e96b32f839dc6e218bfee2c4713?s=128&d=identicon&r=PG", "display_name": "Bryan", "link": "https://stackoverflow.com/users/283325/bryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 55367947, "answer_count": 1, "score": 1, "last_activity_date": 1553671999, "creation_date": 1553644190, "last_edit_date": 1553671999, "question_id": 55367797, "link": "https://stackoverflow.com/questions/55367797/function-that-returns-a-struct-pointer-as-function-that-returns-an-interface", "title": "Function that returns a struct pointer as function that returns an interface", "body": "<p>I have a package exporting a function that returns a struct pointer that I can't control. I'd like to wrap that function to provide a dependency seam so that I can do some unit testing. The idea is that I want a fake rather than what the external package is giving me. </p>\n\n<p>An example looks like:</p>\n\n<pre><code>/////////////////////////////////////\n// External Package I can't control.\n/////////////////////////////////////\npackage ex\ntype Foo struct {\n    v int\n}\n\nfunc (f *Foo) GetV() int {\n    return f.v\n}\n\nfunc CreateFoo(v int) *Foo {\n    return &amp;Foo{v: v}\n}\n\n////////////////////////////////////\n// Local Package I'm testing.\n////////////////////////////////////\ntype IFoo interface {\n    GetV() int\n}\n\ntype factory = func(v int) IFoo\nvar factoryFn factory = ex.CreateFoo\n</code></pre>\n\n<p>This results in the error:\n<code>cannot use CreateFoo (type func(int) *Foo) as type func(int) IFoo in assignment</code></p>\n\n<p>Since I think that <code>*Foo</code> is an <code>IFoo</code>, why not? What am I missing? Is there a way to achieve what I'm trying to do, giving myself a hook like that?</p>\n\n<p>Playground link to example: <a href=\"https://play.golang.org/p/FDckAQGNRgA\" rel=\"nofollow noreferrer\">https://play.golang.org/p/FDckAQGNRgA</a></p>\n"}, {"tags": ["go", "cpu"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 7, "creation_date": 1553640403, "post_id": 55367231, "comment_id": 97458118, "body": "You have a default case in your select, meaning that the for loop will spin if there is nothing to read from <code>al.al.chanFetchRequest</code>."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1553641145, "post_id": 55367231, "comment_id": 97458349, "body": "Also looking at how <code>al.lastUpdated</code>, <code>scp.fetching</code> and <code>go al.fetchData()</code> there is also a chance you have data race in this code as well."}, {"owner": {"reputation": 835, "user_id": 1105727, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/Ys5Bh.jpg?s=128&g=1", "display_name": "Charles Bryant", "link": "https://stackoverflow.com/users/1105727/charles-bryant"}, "edited": false, "score": 0, "creation_date": 1553642755, "post_id": 55367231, "comment_id": 97458796, "body": "Yes thanks for spotting that, I will add some get and set methods with a mutex"}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1553695601, "post_id": 55367465, "comment_id": 97480557, "body": "A select with a single case has no purpose. Just read from the channel."}, {"owner": {"reputation": 1128, "user_id": 11246894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55f8e8c47996c0510c64dbacab90104?s=128&d=identicon&r=PG&f=1", "display_name": "AJR", "link": "https://stackoverflow.com/users/11246894/ajr"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1553843217, "post_id": 55367465, "comment_id": 97543685, "body": "@Adrian thanks - you are right which is exactly what I said in my 2nd answer (below). However, it could be useful if you think you will add other cases later."}], "tags": [], "owner": {"reputation": 1128, "user_id": 11246894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55f8e8c47996c0510c64dbacab90104?s=128&d=identicon&r=PG&f=1", "display_name": "AJR", "link": "https://stackoverflow.com/users/11246894/ajr"}, "is_accepted": false, "score": 0, "last_activity_date": 1553642084, "last_edit_date": 1553642084, "creation_date": 1553641651, "answer_id": 55367465, "question_id": 55367231, "link": "https://stackoverflow.com/questions/55367231/golang-for-select-loop-consumes-100-of-cpu/55367465#55367465", "title": "Golang for select loop consumes 100% of cpu", "body": "<p>I think you just post to al.chanFetchRequest when there is new data so I think you have to keep reading from this channel all the time.  Adding a ticker to the select might cause you to fetch the data even if it has not changed or (worse) before it has even loaded. Why not, in the normal case, take the time whenever you fetch the data then the next time make sure you have waited enough time before fetching again.  Something like this:</p>\n\n<pre><code>        var nextFetch time.Time\n        for {\n            select {\n            case &lt;-al.chanFetchRequest:\n                if al.fetched == false {\n                    al.fetchData()\n                    nextFetch = time.Now().Add(1 * time.Minute)\n                } else if time.Now().After(nextFetch) {\n                    al.fetchData()\n                    nextFetch = time.Now().Add(1 * time.Minute)\n                }\n                al.chanFetchResponse &lt;- struct{}{}\n            }\n        }\n</code></pre>\n"}], "owner": {"reputation": 835, "user_id": 1105727, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/Ys5Bh.jpg?s=128&g=1", "display_name": "Charles Bryant", "link": "https://stackoverflow.com/users/1105727/charles-bryant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1038, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553642616, "creation_date": 1553640223, "last_edit_date": 1553641758, "question_id": 55367231, "link": "https://stackoverflow.com/questions/55367231/golang-for-select-loop-consumes-100-of-cpu", "title": "Golang for select loop consumes 100% of cpu", "body": "<p>I have a resource that needs to be loaded before any access is allowed to it. It also needs to be updated every minute.</p>\n\n<p>The channels are of length 1 struct{}, so the loop will be blocked if the resource has not been loaded.</p>\n\n<p>This code below started to use 100% of my cpu, I tried adding</p>\n\n<pre><code>time.Sleep(10 * time.Millisecond)\n</code></pre>\n\n<p>Which made the application cpu consumption drop to 1%</p>\n\n<p>I am thinking a ticker would be a better option for the timed collection.</p>\n\n<p>Any ideas why it would consume 100% cpu or any better ideas for implemention?</p>\n\n<pre><code>func (al *AsyncLoop) Run() {\n    go func() {\n        for {\n            select {\n            case &lt;-al.chanFetchRequest:\n                if al.fetched == false {\n                    al.fetchData()\n                } else if al.lastUpdated.Add(1*time.Minute).Unix() &lt; time.Now().Unix() &amp;&amp; al.fetching == false {\n                    go al.fetchData()\n                }\n                al.chanFetchResponse &lt;- struct{}{}\n                continue\n            default:\n                continue\n            }\n        }\n    }()\n}\n</code></pre>\n"}, {"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1553640433, "post_id": 55367210, "comment_id": 97458134, "body": "Neither creating a variable, nor dereferencing create copies. Copy happens on assignment. <code>= &amp;*x2</code> <i>copies</i> (assigns) the pointer value to your new variable."}, {"owner": {"reputation": 991, "user_id": 536233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2NPYj.jpg?s=128&g=1", "display_name": "sirion", "link": "https://stackoverflow.com/users/536233/sirion"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1553640884, "post_id": 55367210, "comment_id": 97458274, "body": "So basically, by creating a variable I allocate memory and assigning then fills that memory by copying the data. In my second example the data is never copied because there is no memory allocated where the data could go in between de-referencing and getting the pointer. Did I understand that correctly?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1553641167, "post_id": 55367210, "comment_id": 97458355, "body": "I guess you could put it that way, but I don&#39;t think you need to complicate it so. The simple concept &quot;assignment == copy&quot; works for everything. The odd expression <code>&amp;*x2</code> doesn&#39;t assign anything, therefor doesn&#39;t copy anything."}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1553695781, "post_id": 55369827, "comment_id": 97480675, "body": "Gesturing vaguely at a 100-page document covering every aspect of the language doesn&#39;t answer the question. Directing them to the relevant headings would offer more value to the asker and to future developers landing on this question from searches. Also quoting the relevant sections would make this an actual answer; a link with no details does not."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 0, "last_activity_date": 1553660934, "creation_date": 1553660934, "answer_id": 55369827, "question_id": 55367210, "link": "https://stackoverflow.com/questions/55367210/creating-a-variable-creates-a-copy-dereferencing-does-not-why/55369827#55369827", "title": "Creating a variable creates a copy, dereferencing does not. Why?", "body": "<blockquote>\n  <p>Is there a a part of the go documentation that describes this behavior?</p>\n</blockquote>\n\n<p>Yes, the language spec. See <a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec</a></p>\n"}], "owner": {"reputation": 991, "user_id": 536233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2NPYj.jpg?s=128&g=1", "display_name": "sirion", "link": "https://stackoverflow.com/users/536233/sirion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1553660934, "creation_date": 1553640081, "question_id": 55367210, "link": "https://stackoverflow.com/questions/55367210/creating-a-variable-creates-a-copy-dereferencing-does-not-why", "title": "Creating a variable creates a copy, dereferencing does not. Why?", "body": "<p>Why does putting a value into a variable create a copy but de-referencing does not?</p>\n\n<p>Is it a simple optimization of the compiler that knows that it can just use the address of the original structure, while creating a variable always allocates new memory?</p>\n\n<p>Example 1:</p>\n\n<pre><code>x1 := &amp;struct{ x int }{x: 0}\ny1 := *x1\nz1 := &amp;y1\nz1.x++\n\nfmt.Printf(\"--- 1:\\n%#v\\n%#v\\n\", x1, z1)\n</code></pre>\n\n<p>Example 2:</p>\n\n<pre><code>x2 := &amp;struct{ x int }{x: 0}\nz2 := &amp;*x2\nz2.x++\n\nfmt.Printf(\"--- 2:\\n%#v\\n%#v\\n\", x2, z2)\n</code></pre>\n\n<p>Run here: <a href=\"https://play.golang.org/p/myugNmjrQFj\" rel=\"nofollow noreferrer\">https://play.golang.org/p/myugNmjrQFj</a></p>\n\n<p>Is there a a part of the go documentation that describes this behavior?</p>\n"}, {"tags": ["rest", "go", "mux"], "answers": [{"comments": [{"owner": {"reputation": 455, "user_id": 3543477, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/8878da151e113c7a7bcaccd7952a6b51?s=128&d=identicon&r=PG&f=1", "display_name": "user3543477", "link": "https://stackoverflow.com/users/3543477/user3543477"}, "edited": false, "score": 0, "creation_date": 1553727778, "post_id": 55367164, "comment_id": 97497353, "body": "Thanks @zerkms for pointing out my mistake. The suggested change worked."}, {"owner": {"reputation": 61150, "user_id": 441757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/921df025d1d7c99fad4553ac83bd8bdf?s=128&d=identicon&r=PG", "display_name": "sideshowbarker", "link": "https://stackoverflow.com/users/441757/sideshowbarker"}, "edited": false, "score": 0, "creation_date": 1553844145, "post_id": 55367164, "comment_id": 97544060, "body": "@zerkms About your MDN question, I updated the spec URL to refer to the <a href=\"https://tc39.github.io/ecma262\" rel=\"nofollow noreferrer\">tc39.github.io/ecma262</a> location instead of the now-outdated <a href=\"https://www.ecma-international.org/ecma-262/9.0/\" rel=\"nofollow noreferrer\">ecma-international.org/ecma-262/9.0</a> (ES2018) location. Current MDN policy is to always use the <code>{{SpecName(&#39;ESDraft&#39;, \u2026)}}</code> macro for references to the ES spec (rather than using <code>{{SpecName(&#39;ES2018&#39;, \u2026)}}</code> or any older ES spec versions). If you want to discuss that policy, the #mdn channel on irc.mozilla.org is a good place. Or <a href=\"https://discourse.mozilla.org/c/mdn\" rel=\"nofollow noreferrer\">discourse.mozilla.org/c/mdn</a>"}], "tags": [], "owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "is_accepted": true, "score": 2, "last_activity_date": 1553639794, "creation_date": 1553639794, "answer_id": 55367164, "question_id": 55367137, "link": "https://stackoverflow.com/questions/55367137/call-object-method-in-rest-router-method-in-golang/55367164#55367164", "title": "Call object method in REST router method in GoLang", "body": "<p>You're redeclaring the <code>host</code> variable locally (this is also called \"shadowing\")</p>\n\n<pre><code>host := new(objects.HostOS)\n</code></pre>\n\n<p>instead you should use an assignment operator</p>\n\n<pre><code>host = new(objects.HostOS)\n</code></pre>\n"}], "owner": {"reputation": 455, "user_id": 3543477, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/8878da151e113c7a7bcaccd7952a6b51?s=128&d=identicon&r=PG&f=1", "display_name": "user3543477", "link": "https://stackoverflow.com/users/3543477/user3543477"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 55367164, "answer_count": 1, "score": 0, "last_activity_date": 1553639794, "creation_date": 1553639641, "question_id": 55367137, "link": "https://stackoverflow.com/questions/55367137/call-object-method-in-rest-router-method-in-golang", "title": "Call object method in REST router method in GoLang", "body": "<p>I have just started development of a REST api with GoLang. I have a class with some methods in the backend. The rest api should call one of the methods of the class and return the json response. I am having problem calling the object method or passing the object by reference. My cods looks like this. </p>\n\n<pre><code>package main\n\nimport (\n    \"time\"\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"github.com/gorilla/mux\"\n    \"./objects\")\n\n/*Global Variables*/\nvar host objects.HostOS  // I have declared this to see if I can have a global variable and later on assign the actual object to that and call that object in the GetStats router method below. \n\nfunc main() {\n    fmt.Println(\"Hello World\")\n\n    hostConfig := objects.HostConfig{CPUConfig: cpuConfig, MemoryKB: 4096, OSMemoryKB: 1024, OSCompute: 100}\n\n    host := new(objects.HostOS)\n    host.Init(hostConfig)\n\n    host.Boot()\n    time.Sleep(3 * time.Second)\n    process := new(objects.Process)\n    process.Init(objects.ProcessConfig{MinThreadCount: 2, MaxThreadCount: 8, ParentOSInstance: host})\n    process.Start()\n\n    router := mux.NewRouter().StrictSlash(true)\n\n    router.HandleFunc(\"/\", Index)\n    router.HandleFunc(\"/get_os_stats\", GetOSStats)\n\n    log.Fatal(http.ListenAndServe(\":8080\", router))\n    //host.GetStatsJson()\n}\n\n\nfunc Index(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintln(w, \"Welcome!\")\n}\n\nfunc GetOSStats(w http.ResponseWriter, r *http.Request) {\n    // js, err := host.GetStatsJson()   // This is what I would like to do\n    // Ideally I would get the Marshalled json and err and return them. \n    // The object method works fine as I have tested it, I am however unable to call the object method here. \n\n    fmt.Println(\"getting json stats\")\n    host.GetStatsJson()  //This is were I get the server panic issue and the code breaks\n    //I would like to access the method of the 'host' object defined in the main() method. \n    fmt.Fprintln(w, \"GetOSStats!\")\n}\n</code></pre>\n\n<p>I would like to call the method of the object defined in the main() function inside the GetOSStats() method and then return the json output. </p>\n\n<p>When I declare a global variable and then later on assign it in the main function, the GetOSStats() function is still accessing a nil struct. </p>\n\n<p>When I declare the host obj in the main function and try to access it in the GetOSStats() funtion, it throws exception. </p>\n\n<p>I think I have to pass the host obj by reference to the GetOSStats() function while calling it in the main but I am not sure about how to do that. I have tried looking up the documentations and the examples but I couldnot find anything that could help me. </p>\n\n<p>Thanks in advance, </p>\n"}, {"tags": ["eclipse", "go"], "comments": [{"owner": {"reputation": 338, "user_id": 7214113, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/dc80fcd4d444597ac53672deb22a58d7?s=128&d=identicon&r=PG&f=1", "display_name": "Nefarious", "link": "https://stackoverflow.com/users/7214113/nefarious"}, "edited": false, "score": 0, "creation_date": 1553634018, "post_id": 55365099, "comment_id": 97455776, "body": "There was an answer and comments before, where did they go?"}, {"owner": {"reputation": 6124, "user_id": 5627983, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/696f780ea286896dd41a92459152fbb3?s=128&d=identicon&r=PG&f=1", "display_name": "s952163", "link": "https://stackoverflow.com/users/5627983/s952163"}, "edited": false, "score": 0, "creation_date": 1553641530, "post_id": 55365099, "comment_id": 97458476, "body": "Use Goland: <a href=\"https://www.jetbrains.com/go/\" rel=\"nofollow noreferrer\">jetbrains.com/go</a>"}], "owner": {"reputation": 338, "user_id": 7214113, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/dc80fcd4d444597ac53672deb22a58d7?s=128&d=identicon&r=PG&f=1", "display_name": "Nefarious", "link": "https://stackoverflow.com/users/7214113/nefarious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553632621, "creation_date": 1553629263, "last_edit_date": 1553632621, "question_id": 55365099, "link": "https://stackoverflow.com/questions/55365099/cant-build-go-application-in-goclipse", "title": "Can&#39;t build Go application in GoClipse", "body": "<p>I have a simple Go program, a basic hello world copied from a tutorial somewhere. I am using Eclipse with the GoClipse functionality added.  If I right click on the folder the application is in, and run it as a Go application it works.  If I go to the command prompt and type either <code>go run</code> or <code>go build</code> it works, either for the specific file with the main program or the outside directory.</p>\n\n<p>However if I try to build the project I get the error:</p>\n\n<pre><code># golang.org/x/tools/cmd/splitdwarf\nruntime.main_main\u00c2\u00b7f: function main is undeclared in the main package\n</code></pre>\n\n<p>My program is:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() { fmt.Println(\"Hello World\")  }\n</code></pre>\n\n<p>The directory structure is:</p>\n\n<pre><code>$GOPATH/src/foo/bar.go\n</code></pre>\n\n<p><code>GOPATH</code> is <code>C:\\goSpace</code> and <code>GOROOT</code> is `C:\\Go</p>\n"}, {"tags": ["mongodb", "go", "mongo-go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1553622024, "post_id": 55363074, "comment_id": 97450369, "body": "Questions seeking help with troubleshooting must include the code in question. Please update your question to include your code."}], "answers": [{"tags": [], "owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "is_accepted": true, "score": 2, "last_activity_date": 1553661540, "creation_date": 1553661540, "answer_id": 55369915, "question_id": 55363074, "link": "https://stackoverflow.com/questions/55363074/how-to-import-gos-mongo-driver-bson/55369915#55369915", "title": "How to import go&#39;s mongo-driver bson", "body": "<p>Those are the <code>bson</code> interfaces from older versions (before Beta version). You can construct the update operation as below example: </p>\n\n<pre><code>filter := bson.D{{\"_id\", \"foo\"}}\nupdate := bson.D{{\"$set\", bson.D{{\"pi\", 3.14159}}}}\nresult, err := collection.UpdateOne(\n    context.Background(),\n    filter,\n    update,\n)\n</code></pre>\n\n<p>The snippet above is based on <a href=\"https://github.com/mongodb/mongo-go-driver/releases/tag/v1.0.0\" rel=\"nofollow noreferrer\">MongoDB Go driver v1.0.0</a></p>\n\n<p>For more example on how to use the driver please see: </p>\n\n<ul>\n<li><a href=\"https://www.mongodb.com/blog/post/mongodb-go-driver-tutorial\" rel=\"nofollow noreferrer\">MongoDB Go Driver Tutorial</a></li>\n<li><a href=\"https://godoc.org/go.mongodb.org/mongo-driver/mongo\" rel=\"nofollow noreferrer\">godoc.org/go.mongodb.org/mongo-driver/mongo</a></li>\n<li><a href=\"https://godoc.org/go.mongodb.org/mongo-driver/bson\" rel=\"nofollow noreferrer\">godoc.org/go.mongodb.org/mongo-driver/bson</a></li>\n</ul>\n"}], "owner": {"reputation": 404, "user_id": 5716089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tqyYO.png?s=128&g=1", "display_name": "Kelly Flet", "link": "https://stackoverflow.com/users/5716089/kelly-flet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1126, "favorite_count": 0, "accepted_answer_id": 55369915, "answer_count": 1, "score": 0, "last_activity_date": 1553661540, "creation_date": 1553621490, "last_edit_date": 1553624927, "question_id": 55363074, "link": "https://stackoverflow.com/questions/55363074/how-to-import-gos-mongo-driver-bson", "title": "How to import go&#39;s mongo-driver bson", "body": "<p>I installed the mongo go driver with <code>go get go.mongodb.org/mongo-driver/...</code>, but whenever I try to use <code>bson.EC</code> or <code>bson.NewDocument</code> as seen <a href=\"https://github.com/compose-grandtour/golang/blob/master/example-mongodb-go-driver/example-mongodb.go\" rel=\"nofollow noreferrer\">here</a>, I get errors: <code>undefined: bson.NewDocument</code> and <code>undefined: bson.EC</code>. What am I missing here?</p>\n\n<pre><code>import (\n    \"go.mongodb.org/mongo-driver/bson\"\n)\n\nfunc main() {\n    // database and collection connection \n    // ...\n\n    filter := bson.NewDocument(bson.EC.String(\"_id\", \"foo\"))\n    update := bson.NewDocument(\n        bson.EC.SubDocumentFromElements(\n            \"$set\",\n            bson.EC.Double(\"pi\", 3.14159),\n        ),\n    )\n}\n</code></pre>\n"}, {"tags": ["go", "methods", "go-interface"], "answers": [{"tags": [], "owner": {"reputation": 215, "user_id": 8279368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce829f7874aea73b01b58c60b7a34eeb?s=128&d=identicon&r=PG&f=1", "display_name": "Johey", "link": "https://stackoverflow.com/users/8279368/johey"}, "is_accepted": false, "score": 0, "last_activity_date": 1553619733, "last_edit_date": 1553619733, "creation_date": 1553619416, "answer_id": 55362481, "question_id": 55362410, "link": "https://stackoverflow.com/questions/55362410/can-interface-type-and-value-be-a-type-that-does-not-implement-the-interface-and/55362481#55362481", "title": "Can interface type and value be a type that does not implement the interface and its value?", "body": "<p>Go has some shortcuts. For example: </p>\n\n<pre><code>a.Method()\na.Field\n</code></pre>\n\n<p>is the same as</p>\n\n<pre><code>(*a).Method()\n(*a).Field\n</code></pre>\n\n<p>is similar to the concept here <a href=\"https://tour.golang.org/moretypes/4\" rel=\"nofollow noreferrer\">https://tour.golang.org/moretypes/4</a></p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1553619591, "last_edit_date": 1592644375, "creation_date": 1553619591, "answer_id": 55362531, "question_id": 55362410, "link": "https://stackoverflow.com/questions/55362410/can-interface-type-and-value-be-a-type-that-does-not-implement-the-interface-and/55362531#55362531", "title": "Can interface type and value be a type that does not implement the interface and its value?", "body": "<p><a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow noreferrer\">Spec: Method sets:</a></p>\n<blockquote>\n<p>The method set of the corresponding <a href=\"https://golang.org/ref/spec#Pointer_types\" rel=\"nofollow noreferrer\">pointer type</a> <code>*T</code> is the set of all methods declared with receiver <code>*T</code> or <code>T</code> (that is, it also contains the method set of <code>T</code>).</p>\n<p>[...] The method set of a type determines the interfaces that the type <a href=\"https://golang.org/ref/spec#Interface_types\" rel=\"nofollow noreferrer\">implements</a> and the methods that can be <a href=\"https://golang.org/ref/spec#Calls\" rel=\"nofollow noreferrer\">called</a> using a receiver of that type.</p>\n</blockquote>\n<p>So all methods you declare with value receiver will also belong to the method set of the corresponding pointer type, and thus all interfaces a non-pointer type implements will also be implemented by the pointer type too (and possibly more).</p>\n"}], "owner": {"reputation": 301, "user_id": 5574376, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/69b347672382c9da9507b2566ecd58f9?s=128&d=identicon&r=PG&f=1", "display_name": "user5574376", "link": "https://stackoverflow.com/users/5574376/user5574376"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1553683490, "creation_date": 1553619167, "last_edit_date": 1553683490, "question_id": 55362410, "link": "https://stackoverflow.com/questions/55362410/can-interface-type-and-value-be-a-type-that-does-not-implement-the-interface-and", "title": "Can interface type and value be a type that does not implement the interface and its value?", "body": "<p>Here is the link to the code and description I was looking at: <a href=\"https://tour.golang.org/methods/11\" rel=\"nofollow noreferrer\">https://tour.golang.org/methods/11</a></p>\n\n<p>I change method M of type *T to T, that is changing from a pointer receiver to a value receiver as below.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n)\n\ntype I interface {\n    M()\n}\n\ntype T struct {\n    S string\n}\n\nfunc (t T) M() {\n    fmt.Println(t.S)\n}\n\ntype F float64\n\nfunc (f F) M() {\n    fmt.Println(f)\n}\n\nfunc main() {\n    var i I\n\n    i = &amp;T{\"Hello\"}\n    describe(i)\n    i.M()\n\n    i = F(math.Pi)\n    describe(i)\n    i.M()\n}\n\nfunc describe(i I) {\n    fmt.Printf(\"(%v, %T)\\n\", i, i)\n}\n</code></pre>\n\n<p>However, the change above gave me the same result as it was still a pointer receiver. </p>\n\n<pre><code>(&amp;{Hello}, *main.T)\nHello\n(3.141592653589793, main.F)\n3.141592653589793\n</code></pre>\n\n<p>I am not sure I got this concept right. From my understanding since interface variable i got assign a pointer to an instance of struct T, the type of that interface variable should be a pointer to struct T, and since pointer to struct T does not implement method M, it will cause a panic.</p>\n"}, {"tags": ["go", "grpc", "grpc-go"], "comments": [{"owner": {"reputation": 10980, "user_id": 200445, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/322dfbdffdbb24e5595f3585e1b5c140?s=128&d=identicon&r=PG", "display_name": "Vasiliy Faronov", "link": "https://stackoverflow.com/users/200445/vasiliy-faronov"}, "edited": false, "score": 1, "creation_date": 1553783786, "post_id": 55362342, "comment_id": 97521029, "body": "Strange, works for me. Can you reduce this to a complete reproducible example?"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 12042779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f24e9eb82c2f5308e3a798a9cc622e53?s=128&d=identicon&r=PG&f=1", "display_name": "Sudhanshu Ambastha", "link": "https://stackoverflow.com/users/12042779/sudhanshu-ambastha"}, "is_accepted": false, "score": 3, "last_activity_date": 1572096090, "creation_date": 1572096090, "answer_id": 58571162, "question_id": 55362342, "link": "https://stackoverflow.com/questions/55362342/grpc-received-message-larger-than-max-8653851-vs-4194304/58571162#58571162", "title": "grpc: received message larger than max (8653851 vs. 4194304)", "body": "<p>Please try updating <a href=\"https://godoc.org/google.golang.org/grpc#MaxCallSendMsgSize\" rel=\"nofollow noreferrer\">grpc.MaxCallSendMsgSize(s int)</a> on your client to enable your client send larger message.\nThis worked for me.</p>\n"}, {"tags": [], "owner": {"reputation": 1900, "user_id": 744298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5b57a2e31a8167f66f1a2fa64a01c26?s=128&d=identicon&r=PG", "display_name": "jchavannes", "link": "https://stackoverflow.com/users/744298/jchavannes"}, "is_accepted": false, "score": 0, "last_activity_date": 1594020579, "creation_date": 1594020579, "answer_id": 62751203, "question_id": 55362342, "link": "https://stackoverflow.com/questions/55362342/grpc-received-message-larger-than-max-8653851-vs-4194304/62751203#62751203", "title": "grpc: received message larger than max (8653851 vs. 4194304)", "body": "<p>Call options can be passed with each request.</p>\n<p>For example, if your package is called <code>queue</code> and your method is called <code>GetItems</code>, then you would pass in the <code>MaxCallRecvMsgSize</code> option when calling <code>GetItems</code>.</p>\n<p>Protobuf:</p>\n<pre class=\"lang-proto prettyprint-override\"><code>package queue;\n\nservice Queue {\n    rpc GetItems (Request) returns (Items) {\n    }\n}\n</code></pre>\n<p>Go:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>conn, err := grpc.Dial(address, opts...)\nc := queue.NewQueueClient(s.Conn)\nmaxSizeOption := grpc.MaxCallRecvMsgSize(32*10e6)\nitems, err := c.GetItems(ctx, &amp;queue.Request{}, maxSizeOption)\n</code></pre>\n"}], "owner": {"reputation": 1720, "user_id": 6205738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a08adf9353636c19dc5a4e45df11d8e?s=128&d=identicon&r=PG&f=1", "display_name": "Saty", "link": "https://stackoverflow.com/users/6205738/saty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7902, "favorite_count": 2, "answer_count": 2, "score": 9, "last_activity_date": 1594020579, "creation_date": 1553618946, "last_edit_date": 1569498067, "question_id": 55362342, "link": "https://stackoverflow.com/questions/55362342/grpc-received-message-larger-than-max-8653851-vs-4194304", "title": "grpc: received message larger than max (8653851 vs. 4194304)", "body": "<p><strong>The problem</strong>: </p>\n\n<p>I am getting this error while receiving message in grpc: </p>\n\n<p><code>rpc error: code = ResourceExhausted desc = grpc: received message larger than max (8653851 vs. 4194304)</code></p>\n\n<p><strong>What I tried:</strong></p>\n\n<p>I gave the option to increase the size of the message to be received but it still gave the same error which means this setting of maximum size didn't work: </p>\n\n<pre><code>size := 1024 * 1024 * 12\nopts = append(opts, grpc.WithDefaultCallOptions(grpc.MaxCallRecvMsgSize(size)))\nconn, err := grpc.Dial(address, opts...)\n</code></pre>\n\n<p><strong>Comments:</strong></p>\n\n<p>The default limit is <code>1024 * 1024 * 4 = 4194304</code> which is shown in the error message. I was expecting this limit to increase to <code>1024 * 1024 * 12 = 12582912</code> but clearly it didn't.</p>\n"}, {"tags": ["go", "select", "unix-socket"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 4, "creation_date": 1553618682, "post_id": 55362196, "comment_id": 97448458, "body": "Start a goroutine to read from each connection."}, {"owner": {"reputation": 16645, "user_id": 402322, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/GWEWt.gif?s=128&g=1", "display_name": "ceving", "link": "https://stackoverflow.com/users/402322/ceving"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1553619136, "post_id": 55362196, "comment_id": 97448759, "body": "@CeriseLim&#243;n I need the input from the two connections in one function. Like an adder: read <code>a</code> from connection 1, <code>b</code> from connection 2 and return <code>a+b</code>. The function should not care, which value arrives first, but should wait until both values have been read."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1553632473, "post_id": 55362196, "comment_id": 97455154, "body": "Then you not even need a select, just read from both, e.g. from two goroutines and combine via one channel and to receives."}], "answers": [{"comments": [{"owner": {"reputation": 16645, "user_id": 402322, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/GWEWt.gif?s=128&g=1", "display_name": "ceving", "link": "https://stackoverflow.com/users/402322/ceving"}, "edited": false, "score": 2, "creation_date": 1553672781, "post_id": 55363455, "comment_id": 97466451, "body": "I see, <code>select</code> is syntax in Go. I was looking for a function."}], "tags": [], "owner": {"reputation": 828, "user_id": 5670592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eb76a6b989b0ee1948060b15e2688b5?s=128&d=identicon&r=PG&f=1", "display_name": "Andonaeus", "link": "https://stackoverflow.com/users/5670592/andonaeus"}, "is_accepted": true, "score": 1, "last_activity_date": 1553622788, "creation_date": 1553622788, "answer_id": 55363455, "question_id": 55362196, "link": "https://stackoverflow.com/questions/55362196/how-to-select-in-go/55363455#55363455", "title": "How to select in Go?", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Message struct {\n    Payload int\n}\n\nfunc main() {\n    var inA *Message\n    var inB *Message\n\n    rxA := make(chan *Message)\n    rxB := make(chan *Message)\n\n    go func(txA chan *Message){\n      txA &lt;- &amp;Message{Payload: 1} \n    }(rxA)\n\n    go func(txB chan *Message){\n      txB &lt;- &amp;Message{Payload: 2} \n    }(rxB)\n\n    for {\n        select {\n            case inA = &lt;- rxA:\n            case inB = &lt;- rxB:\n        }\n        if inA != nil &amp;&amp; inB != nil {\n            fmt.Println(inA.Payload + inB.Payload)\n            break\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 16645, "user_id": 402322, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/GWEWt.gif?s=128&g=1", "display_name": "ceving", "link": "https://stackoverflow.com/users/402322/ceving"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 55363455, "answer_count": 1, "score": -2, "last_activity_date": 1553622788, "creation_date": 1553618428, "question_id": 55362196, "link": "https://stackoverflow.com/questions/55362196/how-to-select-in-go", "title": "How to select in Go?", "body": "<p>In Unix <a href=\"https://en.wikipedia.org/wiki/Select_(Unix)\" rel=\"nofollow noreferrer\"><code>select</code></a> is used to wait for more than one input source. Select waits until one input source becomes ready.</p>\n\n<p>How to do this in Go?</p>\n\n<p>I found a <a href=\"https://godoc.org/golang.org/x/sys/unix#Select\" rel=\"nofollow noreferrer\">Select</a> in Go but this seams to be a thin wrapper around the Unix function, because it works on file descriptors.</p>\n\n<p>How to wait for more than one connection, in particular <a href=\"https://golang.org/pkg/net/#UnixConn\" rel=\"nofollow noreferrer\">UnixConn</a> connections used for Unix Domain Sockets?</p>\n"}, {"tags": ["docker", "go", "flock"], "comments": [{"owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1553618753, "post_id": 55361769, "comment_id": 97448506, "body": "I would avoid sharing /tmp from host into container instead pick a unique non-system dir like /mydir"}, {"owner": {"reputation": 2024, "user_id": 1731473, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e63f9df521795ecff55b8b769931686f?s=128&d=identicon&r=PG", "display_name": "Soullivaneuh", "link": "https://stackoverflow.com/users/1731473/soullivaneuh"}, "reply_to_user": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1553675757, "post_id": 55361769, "comment_id": 97467883, "body": "Yes, <code>&#47;tmp</code> was to test it quickly, but the issue will be the same."}, {"owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1553691692, "post_id": 55361769, "comment_id": 97477768, "body": "you may want to look at a tool called  supervisord which is how to launch an application ... added benefit is when the application crashes supervisord can auto launch it again ... see details at  <a href=\"https://stackoverflow.com/tags/supervisord/info\">stackoverflow.com/tags/supervisord/info</a>   ... nice aspect is it requires no changes to your application code ... I use it inside all my docker containers"}, {"owner": {"reputation": 655, "user_id": 795827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3fca55cadb8f5d17544b18679e4aaaa0?s=128&d=identicon&r=PG", "display_name": "Xiaokun", "link": "https://stackoverflow.com/users/795827/xiaokun"}, "edited": false, "score": 0, "creation_date": 1595404157, "post_id": 55361769, "comment_id": 111458785, "body": "same problem in java <code>FileLock</code>, not words in Docker. Do you find a soluation?"}], "answers": [{"comments": [{"owner": {"reputation": 2024, "user_id": 1731473, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e63f9df521795ecff55b8b769931686f?s=128&d=identicon&r=PG", "display_name": "Soullivaneuh", "link": "https://stackoverflow.com/users/1731473/soullivaneuh"}, "edited": false, "score": 1, "creation_date": 1553678966, "post_id": 55362641, "comment_id": 97469791, "body": "Thanks for your answer. The flocker repository is archived, not maintained anymore? Yes, learning Kubernetes is on my plans, but for now I just have to run a very tiny go library with Docker. I&#39;ll take a look of your documentation, but it looks like I have to find an another solution than flock for me needs..."}, {"owner": {"reputation": 9108, "user_id": 2148953, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/FeyHn.png?s=128&g=1", "display_name": "aran", "link": "https://stackoverflow.com/users/2148953/aran"}, "edited": false, "score": 0, "creation_date": 1608758926, "post_id": 55362641, "comment_id": 115679576, "body": "are you really paco alcacer? : O"}, {"owner": {"reputation": 182, "user_id": 1926952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n262r.jpg?s=128&g=1", "display_name": "paco alcacer", "link": "https://stackoverflow.com/users/1926952/paco-alcacer"}, "reply_to_user": {"reputation": 9108, "user_id": 2148953, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/FeyHn.png?s=128&g=1", "display_name": "aran", "link": "https://stackoverflow.com/users/2148953/aran"}, "edited": false, "score": 0, "creation_date": 1609151369, "post_id": 55362641, "comment_id": 115758998, "body": "@aran OfCourse Not. I&#39;m a Valencia fan since 2007 so I use Paco as my English name. Welcome to <a href=\"https://pacoxu.wordpress.com/\" rel=\"nofollow noreferrer\">pacoxu.wordpress.com</a> \ud83d\ude04"}], "tags": [], "owner": {"reputation": 182, "user_id": 1926952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n262r.jpg?s=128&g=1", "display_name": "paco alcacer", "link": "https://stackoverflow.com/users/1926952/paco-alcacer"}, "is_accepted": false, "score": 1, "last_activity_date": 1553619935, "creation_date": 1553619935, "answer_id": 55362641, "question_id": 55361769, "link": "https://stackoverflow.com/questions/55361769/docker-and-file-locking/55362641#55362641", "title": "Docker and file locking", "body": "<p>I suppose that you want to use  docker volume or you may need some other volume plugins <a href=\"https://docs.docker.com/engine/extend/legacy_plugins/#volume-plugins\" rel=\"nofollow noreferrer\">https://docs.docker.com/engine/extend/legacy_plugins/#volume-plugins</a>.</p>\n\n<p>According to this article, Docker Volume File permission and locking \n<a href=\"https://forums.docker.com/t/docker-volume-file-permission-and-locking/24335\" rel=\"nofollow noreferrer\">https://forums.docker.com/t/docker-volume-file-permission-and-locking/24335</a>\ndocker volume only provides a way to define a volume to use by multi containers or use by a container after restarting.</p>\n\n<p>In docker volume plugins, flocker may meet your requirements.\nFlocker is an open-source Container Data Volume Manager for your Dockerized applications.\n<a href=\"https://github.com/ScatterHQ/flocker\" rel=\"nofollow noreferrer\">https://github.com/ScatterHQ/flocker</a></p>\n\n<p>BTW, if you are using kubernetes, you may need to learn more about persistent volume, persistent volume claim, storage class.</p>\n"}, {"comments": [{"owner": {"reputation": 6344, "user_id": 1084684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/32b10232489646c1940c202e91f475b9?s=128&d=identicon&r=PG", "display_name": "dstromberg", "link": "https://stackoverflow.com/users/1084684/dstromberg"}, "edited": false, "score": 0, "creation_date": 1563995346, "post_id": 57189715, "comment_id": 100889299, "body": "BTW, you could try strace&#39;ing your Go program, to see what system calls it is using."}, {"owner": {"reputation": 135, "user_id": 8387308, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4904d40aeff3671dbce7574b565c9ada?s=128&d=identicon&r=PG&f=1", "display_name": "mshikher", "link": "https://stackoverflow.com/users/8387308/mshikher"}, "edited": false, "score": 0, "creation_date": 1614470974, "post_id": 57189715, "comment_id": 117396309, "body": "Did it work with the Go language? @Soullivaneuh"}], "tags": [], "owner": {"reputation": 6344, "user_id": 1084684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/32b10232489646c1940c202e91f475b9?s=128&d=identicon&r=PG", "display_name": "dstromberg", "link": "https://stackoverflow.com/users/1084684/dstromberg"}, "is_accepted": false, "score": 5, "last_activity_date": 1563995320, "creation_date": 1563995320, "answer_id": 57189715, "question_id": 55361769, "link": "https://stackoverflow.com/questions/55361769/docker-and-file-locking/57189715#57189715", "title": "Docker and file locking", "body": "<p>This morning I wrote a little Python test program that just writes one million consecutive integers to a file, with flock() locking, obtaining and releasing the lock once for each number appended.  I started up 5 containers, each running that test program, and each writing to the same file in a docker volume.</p>\n\n<p>With the locking enabled, the numbers were all written without interfering with each other, and there were exactly 5 million integers in the file.  They weren't consecutive when written this way, but that's expected and consistent with flock() working.</p>\n\n<p>Without locking, many of the numbers were written in a manner that indicates the numbers were running afoul of the multitasking sans locking.  There were only 3,167,546 numbers in the file and there were 13,357 blank lines.  That adds up to the 3,180,903 lines in the file - substantially different than the desired 5,000,000.</p>\n\n<p>While a program cannot definitively prove that there will never be problems just by testing many times, to me that's a pretty convincing argument that Linux flock() works across containers.</p>\n\n<p>Also, it just kinda makes sense that flock would work across containers; containers are pretty much just a shared kernel, distinct pid, distinct file (other than volumes) and distinct IP port space.</p>\n\n<p>I ran my test on a Linux Mint 19.1 system with Linux kernel 4.15.0-20-generic, Docker 19.03.0 - build aeac949 and CPython 3.6.8.</p>\n\n<p>Go is a cool language, but why flock() didn't appear to be working across volumes in your Go program I do not know.</p>\n\n<p>HTH.</p>\n"}], "owner": {"reputation": 2024, "user_id": 1731473, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e63f9df521795ecff55b8b769931686f?s=128&d=identicon&r=PG", "display_name": "Soullivaneuh", "link": "https://stackoverflow.com/users/1731473/soullivaneuh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5070, "favorite_count": 2, "answer_count": 2, "score": 7, "last_activity_date": 1563995320, "creation_date": 1553617068, "question_id": 55361769, "link": "https://stackoverflow.com/questions/55361769/docker-and-file-locking", "title": "Docker and file locking", "body": "<p>I wrote a simple go application and added a flock system to prevent being running twice at the same time:</p>\n\n<pre><code>import \"github.com/nightlyone/lockfile\"\n\nlock, err := lockfile.New(filepath.Join(os.TempDir(), \"pagerduty-read-api.lock\"))\nif err != nil {\n    panic(err)\n}\n\nif err = lock.TryLock(); err != nil {\n    fmt.Println(\"Already running.\")\n    return\n}\n\ndefer lock.Unlock()\n</code></pre>\n\n<p>It works well on my host. On docker, I tried to run it with volume sharing of <code>tmp</code>:</p>\n\n<pre><code>docker run --rm -it -v /tmp:/tmp my-go-binary\n</code></pre>\n\n<p>But it does not work. I suppose it's because the flock system is not ported on volume sharing.</p>\n\n<p>My question: Does Docker have option to make flock working between running instance? If not, what are my other options to have the same behavior?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go", "hyperledger-sawtooth"], "answers": [{"comments": [{"owner": {"reputation": 2037, "user_id": 9812548, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VS24T.jpg?s=128&g=1", "display_name": "Dan Anderson", "link": "https://stackoverflow.com/users/9812548/dan-anderson"}, "edited": false, "score": 0, "creation_date": 1554498988, "post_id": 55390116, "comment_id": 97790041, "body": "So the problem was you had a local copy of openssl installed, instead of one installed from a package. You should have mentioned that."}], "tags": [], "owner": {"reputation": 3767, "user_id": 5431173, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/5cc099bed59473fb573fe169561bc244?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay Sood", "link": "https://stackoverflow.com/users/5431173/akshay-sood"}, "is_accepted": true, "score": 1, "last_activity_date": 1553746827, "creation_date": 1553746827, "answer_id": 55390116, "question_id": 55361615, "link": "https://stackoverflow.com/questions/55361615/go-build-error-while-building-sawtooth-transaction-processor-on-macos/55390116#55390116", "title": "go build error while building sawtooth transaction processor on macos", "body": "<p>Executing below two commands fixed the issue:</p>\n\n<pre><code>ln -s /usr/local/opt/openssl/lib/libcrypto.1.0.0.dylib /usr/local/lib\nln -s /usr/local/opt/openssl/lib/libcrypto.a /usr/local/lib\n</code></pre>\n"}], "owner": {"reputation": 3767, "user_id": 5431173, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/5cc099bed59473fb573fe169561bc244?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay Sood", "link": "https://stackoverflow.com/users/5431173/akshay-sood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 55390116, "answer_count": 1, "score": 1, "last_activity_date": 1553746827, "creation_date": 1553616587, "last_edit_date": 1553619648, "question_id": 55361615, "link": "https://stackoverflow.com/questions/55361615/go-build-error-while-building-sawtooth-transaction-processor-on-macos", "title": "go build error while building sawtooth transaction processor on macos", "body": "<p>I am trying to build sawtooth transaction processor on macos. The transaction processor is written in golang. When I do <code>go build</code> it throws the following error:</p>\n\n<pre><code>go build\n# github.com/hyperledger/sawtooth-sdk-go/signing\nld: library not found for -lcrypto\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n\n<p>Please note <code>openssl</code> is already installed</p>\n\n<p>any suggestion/comment would be really helpful.</p>\n"}, {"tags": ["html", "go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 3, "creation_date": 1553616480, "post_id": 55361534, "comment_id": 97447075, "body": "You should be examining the returned errors rather than discarding them. You would see that <code>.Arts</code> is an invalid field, but should rather be <code>.Articles</code>."}, {"owner": {"reputation": 231, "user_id": 3893717, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/34a807488b728b3eb226d9b6380be372?s=128&d=identicon&r=PG&f=1", "display_name": "Don E", "link": "https://stackoverflow.com/users/3893717/don-e"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1553617415, "post_id": 55361534, "comment_id": 97447663, "body": "silly me. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 2760, "user_id": 3593896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yJpxY.jpg?s=128&g=1", "display_name": "Webber", "link": "https://stackoverflow.com/users/3593896/webber"}, "is_accepted": false, "score": -1, "last_activity_date": 1553616657, "creation_date": 1553616657, "answer_id": 55361634, "question_id": 55361534, "link": "https://stackoverflow.com/questions/55361534/how-to-iterate-through-a-splice-in-go-golang-for-a-html-page/55361634#55361634", "title": "How to iterate through a splice in go/golang for a HTML page?", "body": "<p>From the code you provided, the array is empty and as the documentation reads:</p>\n\n<blockquote>\n  <p>If the value of the pipeline has length zero, nothing is output;</p>\n</blockquote>\n\n<p>Your HTML looks fine.</p>\n\n<p>You're also never passing the array:</p>\n\n<p>try:</p>\n\n<pre><code>newsPage := NewsPage{\n    Arts: Arts\n}\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>newsPage := NewsPage{\n    Articles: Arts\n}\n</code></pre>\n"}], "owner": {"reputation": 231, "user_id": 3893717, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/34a807488b728b3eb226d9b6380be372?s=128&d=identicon&r=PG&f=1", "display_name": "Don E", "link": "https://stackoverflow.com/users/3893717/don-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553617136, "creation_date": 1553616331, "last_edit_date": 1553617136, "question_id": 55361534, "link": "https://stackoverflow.com/questions/55361534/how-to-iterate-through-a-splice-in-go-golang-for-a-html-page", "title": "How to iterate through a splice in go/golang for a HTML page?", "body": "<p>I've looked through online examples and other splice examples, but haven't succeeded. </p>\n\n<p>Here's my HTML</p>\n\n<pre><code>&lt;table style=\"width:100%\"&gt;\n  &lt;tr&gt;\n    &lt;th&gt;Source&lt;/th&gt;\n    &lt;th&gt;Title&lt;/th&gt;\n    &lt;th&gt;Author&lt;/th&gt;\n    &lt;th&gt;URL&lt;/th&gt;\n  &lt;/tr&gt;\n  {{range .Arts}}\n    &lt;tr&gt;\n      &lt;td&gt;{{ .Source }}&lt;/td&gt;\n      &lt;td&gt;{{ .Title }}&lt;/td&gt;\n      &lt;td&gt;{{ .Author }}&lt;/td&gt;\n      &lt;td&gt;{{ .URL }}&lt;/td&gt;\n    &lt;/tr&gt;\n  {{end}}  \n&lt;/table&gt;\n</code></pre>\n\n<p>GO:</p>\n\n<pre><code>Source string\n    Author string\n    Title  string\n    URL    string\n}\n\ntype NewsPage struct {\n    Header   string\n    News     string\n    Articles []Article\n}\n\nvar Arts []Article\n\nfunc newsDisplayHandler(w http.ResponseWriter, r *http.Request) {\n    //  temp := template.Must(template.ParseFiles(\"layout.html\"))\n    newsPage := NewsPage{\n        Header:   \"This is your Mostly Fake news update for \" + time.Now().Format(\"Mon 2006-01-2\"),\n        News:     \"Here's your daily dose of mostly Fake News\",\n        Articles: Arts}\n    parse, _ := template.ParseFiles(\"newsPage.html\")\n    parse.Execute(w, newsPage)\n    //  temp.Execute(w, newsPage)\n}\n</code></pre>\n\n<p>What am I missing? The rest of my code works and is not the issue here. My issues is that I am not able to loop through my slice to add it to the HTML table. I wont know the number of Articles at run time, as I'm getting the info from an API. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1553613802, "post_id": 55360658, "comment_id": 97445320, "body": "Use <code>map[string]*Model</code>, then range over the map and use the key to set the ObjectName."}], "answers": [{"comments": [{"owner": {"reputation": 4486, "user_id": 1841212, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/369bf24a2357cb876ffb1360eca96ee9?s=128&d=identicon&r=PG", "display_name": "VisualBean", "link": "https://stackoverflow.com/users/1841212/visualbean"}, "edited": false, "score": 0, "creation_date": 1553614858, "post_id": 55360950, "comment_id": 97446027, "body": "This answers half the question, which is awesome! im am 100% further now. But what about the property &quot;ObjectName&quot;? or do I just assign it after the fact?"}, {"owner": {"reputation": 579, "user_id": 11206879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bS2D6.png?s=128&g=1", "display_name": "Pan Ke", "link": "https://stackoverflow.com/users/11206879/pan-ke"}, "reply_to_user": {"reputation": 4486, "user_id": 1841212, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/369bf24a2357cb876ffb1360eca96ee9?s=128&d=identicon&r=PG", "display_name": "VisualBean", "link": "https://stackoverflow.com/users/1841212/visualbean"}, "edited": false, "score": 0, "creation_date": 1553615085, "post_id": 55360950, "comment_id": 97446177, "body": "@VisualBean, I updated the answer. Yes, you just assign it"}], "tags": [], "owner": {"reputation": 579, "user_id": 11206879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bS2D6.png?s=128&g=1", "display_name": "Pan Ke", "link": "https://stackoverflow.com/users/11206879/pan-ke"}, "is_accepted": true, "score": 2, "last_activity_date": 1553615057, "last_edit_date": 1553615057, "creation_date": 1553614400, "answer_id": 55360950, "question_id": 55360658, "link": "https://stackoverflow.com/questions/55360658/unmarshall-anonymous-json-field-to-named-field/55360950#55360950", "title": "unmarshall anonymous json field to &quot;named&quot; field", "body": "<p>can use map[string]Model to encode. <a href=\"https://play.golang.org/p/QWXQZFjBgRB\" rel=\"nofollow noreferrer\">https://play.golang.org/p/QWXQZFjBgRB</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n)\n\ntype Model struct {\n    ObjectName string\n    KnownArray []KnownType `json:\"knownArray\"`\n    OtherKnownArray []string `json:\"otherKnownArray\"`\n}\n\ntype KnownType struct {\n    Property string `json:\"property\"`\n    Otherproperty bool   `json:\"otherproperty\"`\n}\n\nfunc main() {\n        jsonstring := `{\n            \"unknown\": {\n                \"knownArray\": [\n                        {\"property\": \"somevalue\", \"otherproperty\": false}\n                ],\n                \"otherKnownArray\": [\"\"]\n            }\n    }`\n    a := make(map[string]Model)\n    json.Unmarshal([]byte(jsonstring), &amp;a)\n    var m Model\n    for k, v := range(a) {\n        m = v\n        m.ObjectName = k\n        break\n    }\n    fmt.Println(m.ObjectName, m.KnownArray, m.OtherKnownArray)\n}\n</code></pre>\n"}], "owner": {"reputation": 4486, "user_id": 1841212, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/369bf24a2357cb876ffb1360eca96ee9?s=128&d=identicon&r=PG", "display_name": "VisualBean", "link": "https://stackoverflow.com/users/1841212/visualbean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 55360950, "answer_count": 1, "score": 0, "last_activity_date": 1553615057, "creation_date": 1553613546, "last_edit_date": 1553614815, "question_id": 55360658, "link": "https://stackoverflow.com/questions/55360658/unmarshall-anonymous-json-field-to-named-field", "title": "unmarshall anonymous json field to &quot;named&quot; field", "body": "<p>Say I have the following json</p>\n\n<pre><code>{\n    \"unknown\": {\n        \"knownArray\": [\n            {\"property\": \"somevalue\", \"otherproperty\": false}\n        ],\n        \"otherKnownArray\": [\"\"]\n    }\n}\n</code></pre>\n\n<p>And I have the following structs to represent this data</p>\n\n<pre><code>type Model struct {\n    ObjectName string\n    KnownArray []KnownType `json:\"knownArray\"`\n    OtherKnownArray []string `json:\"otherKnownArray\"`\n}\n\ntype KnownType struct {\n    Property string `json:\"property1\"`\n    Otherproperty bool   `json:\"otherproperty\"`\n}\n</code></pre>\n\n<p>doing</p>\n\n<pre><code>var model Model\n\njson.Unmarshal(content, &amp;model)\n</code></pre>\n\n<p>Does not deserialize any of the json unfortunately.</p>\n\n<p><strong>How do I deserialize to my Model correctly?</strong><br>\n<strong>How do I deserialize the json so that ObjectName = \"unknown\"?</strong></p>\n\n<p>Im not quite understanding the internals of encoding/json when it comes to anonymous json fields.</p>\n\n<p>Ive also tried wrapping Model in a third \"outer\" Model, but still does not work with the anonymous json field.</p>\n"}, {"tags": ["go", "go-gorm"], "owner": {"reputation": 289, "user_id": 2243894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0917c890a69d86b245600c2309623f37?s=128&d=identicon&r=PG", "display_name": "Chris G", "link": "https://stackoverflow.com/users/2243894/chris-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 237, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1553613454, "creation_date": 1553613454, "question_id": 55360627, "link": "https://stackoverflow.com/questions/55360627/filtering-a-query-with-a-has-many-relationship-with-gorm", "title": "Filtering a query with a has_many relationship with GORM?", "body": "<p>Having an issue with a super simple Gorm query on a simple many_to_many relationship, I have 3 tables in a MYSQL DB modelled like so:</p>\n\n<pre><code>type Product struct {\n    ID          uint         `gorm:\"unique\"  json:\"id\"`\n    Name        string       `gorm:\"name\"  json:\"name\"`\n    Ingredients []Ingredient `gorm:\"many2many:product_ingredients;\"  json:\"ingredients\"`\n}\n\ntype Ingredient struct {\n    ID   uint   `gorm:\"unique\" json:\"id\"`\n    Name string `gorm:\"name\" json:\"name\"`\n}\n</code></pre>\n\n<p>(And a joining table)</p>\n\n<p>I want a query which fetches all products where the ingredient is included in a certain product:</p>\n\n<p>I can get general queries with all data doing this:</p>\n\n<pre><code>db.Debug().Preload(\"Ingredients\").Limit(limit).Offset(offset).Find(&amp;products)\n</code></pre>\n\n<p>But trying to do something like this</p>\n\n<pre><code>db.Debug().Preload(\"Ingredients\").Limit(limit).Offset(offset).Where(Ingredient{Name: \"Chicken\"}).Find(&amp;products)\n</code></pre>\n\n<p>Gives me\nError 1054: Unknown column 'ingredients.name' in 'where clause'</p>\n\n<p>I'm expecting to only return products that have chicken as an ingredient.</p>\n\n<p>Anyone able to help?</p>\n\n<p>This should be fairly simple but I can't find any use cases like this and the docs are quite confusing.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3467, "user_id": 3393308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3f30f7c191e8d556c70c951fe3d9af?s=128&d=identicon&r=PG", "display_name": "yorodm", "link": "https://stackoverflow.com/users/3393308/yorodm"}, "edited": false, "score": 0, "creation_date": 1553621754, "post_id": 55360579, "comment_id": 97450217, "body": "You can use <code>GetModuleFileNameA </code> to get the path of a loaded module, find the module handler with <code>GetModuleHandleA</code>"}, {"owner": {"reputation": 1967, "user_id": 1390507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53335e2b507fd457757eee3a39323159?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1390507/alex"}, "edited": false, "score": 0, "creation_date": 1553762352, "post_id": 55360579, "comment_id": 97506938, "body": "Searching for DLLs is similar to searching for an executable. Therefore you should be able to use <a href=\"https://golang.org/pkg/os/exec/#LookPath\" rel=\"nofollow noreferrer\">golang.org/pkg/os/exec/#LookPath</a> to find DLLs."}, {"owner": {"reputation": 1219, "user_id": 783726, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0d68f895b1ae840dd1e3df3bba1a5bcb?s=128&d=identicon&r=PG", "display_name": "Russell Seymour", "link": "https://stackoverflow.com/users/783726/russell-seymour"}, "reply_to_user": {"reputation": 3467, "user_id": 3393308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3f30f7c191e8d556c70c951fe3d9af?s=128&d=identicon&r=PG", "display_name": "yorodm", "link": "https://stackoverflow.com/users/3393308/yorodm"}, "edited": false, "score": 0, "creation_date": 1553791130, "post_id": 55360579, "comment_id": 97526018, "body": "@yorodm Thanks very much for your suggestion, it looks very much like what I want :-). Do you have examples of how to use these functions? I think I have found them but they seem to be internal within <code>syscall</code> and I cannot access them, of course I may well be barking up the wrong tree here. Thanks again."}], "answers": [{"comments": [{"owner": {"reputation": 1219, "user_id": 783726, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0d68f895b1ae840dd1e3df3bba1a5bcb?s=128&d=identicon&r=PG", "display_name": "Russell Seymour", "link": "https://stackoverflow.com/users/783726/russell-seymour"}, "edited": false, "score": 0, "creation_date": 1553862782, "post_id": 55404891, "comment_id": 97553970, "body": "Thanks so much for this. Am playing with it now - will get back to you when I have something working."}], "tags": [], "owner": {"reputation": 3467, "user_id": 3393308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3f30f7c191e8d556c70c951fe3d9af?s=128&d=identicon&r=PG", "display_name": "yorodm", "link": "https://stackoverflow.com/users/3393308/yorodm"}, "is_accepted": false, "score": 0, "last_activity_date": 1553798976, "creation_date": 1553798976, "answer_id": 55404891, "question_id": 55360579, "link": "https://stackoverflow.com/questions/55360579/is-it-possible-to-find-the-path-to-a-loaded-dll-on-windows-in-go/55404891#55404891", "title": "Is it possible to find the path to a loaded DLL on Windows in GO?", "body": "<p>I have no access to a Windows machine running Go right now, but it <strong>should</strong> be something along this lines. Notice the <strong>lack of proper resource/error management</strong> in the code.</p>\n\n<p>Please tests it and share your results so I can amend/edit my answer.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>var (\nkernel32, _        = syscall.LoadLibrary(\"kernel32.dll\")\ngetModuleHandle, _ = syscall.GetProcAddress(kernel32, \"GetModuleHandleW\")\ngetModuleFilename, _ = syscall.GetProcAddress(kernel32, \"GetModuleFileNameA\")\n)\n\nfunc StringToCharPtr(str string) *uint8 {\n    chars := append([]byte(str), 0) // null terminated\n    return &amp;chars[0]\n}\n\nfunc GetDllFileName() (filename byte[]) {\n    var nargs uintptr = 1\n    var handle uintprt\n    modulename = StringToPtrChar(\"user32.dll\")\n\n    if ret, _, callErr := syscall.Syscall(uintptr(getModuleHandle), nargs, modulename, 0, 0); callErr != 0 {\n        panic(\"Call GetModuleHandle\")\n    } else {\n     handle = ret\n    }\n    name = make(byte[],50) // I'm making this number out of the blue\n    nargs = 3\n    if ret, _, callErr := syscall.Syscall(uintptr(getModuleFilename), nargs, handle, &amp;name[0], 50); callErr != 0 {\n        panic(\"Call GetModuleFileName\")\n    }\n    else{\n      filename = name\n    }\n    return\n}\n</code></pre>\n"}], "owner": {"reputation": 1219, "user_id": 783726, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0d68f895b1ae840dd1e3df3bba1a5bcb?s=128&d=identicon&r=PG", "display_name": "Russell Seymour", "link": "https://stackoverflow.com/users/783726/russell-seymour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 315, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1553798976, "creation_date": 1553613338, "question_id": 55360579, "link": "https://stackoverflow.com/questions/55360579/is-it-possible-to-find-the-path-to-a-loaded-dll-on-windows-in-go", "title": "Is it possible to find the path to a loaded DLL on Windows in GO?", "body": "<p>I have the following GO code:</p>\n\n<pre><code>package main\n\nimport (\n    \"syscall\"\n)\n\nfunc main() {\n    var mod, _ = syscall.LoadLibrary(\"user32.dll\")\n}\n</code></pre>\n\n<p>Which successfully loads the <code>user32.dll</code> file. (This is a modified version of an example I found online).</p>\n\n<p>However I do not know where on the filesystem this DLL exists. I have been searching for a way for Go to be able to tell me that through the <code>syscall</code> libs, but have not found a way to do it.</p>\n\n<p>Does anyone know of a way to get the path to the DLL that was loaded?</p>\n"}, {"tags": ["go", "sqlite"], "answers": [{"comments": [{"owner": {"reputation": 910, "user_id": 426853, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b7fbf02bd4eb6fa180937d44a6afdcd0?s=128&d=identicon&r=PG", "display_name": "Mike Ellis", "link": "https://stackoverflow.com/users/426853/mike-ellis"}, "edited": false, "score": 0, "creation_date": 1553618598, "post_id": 55361655, "comment_id": 97448415, "body": "That almost works but not quite. Just before spotting your answer I (finally!) got it working with no inner quotes at all, <code>fmt.Sprintf(&quot;.backup %s&quot;, bakpath)</code>. I&#39;m going to accept your answer since you took the trouble to post it and your reasoning is correct..  I&#39;m not sure if the inner single quotes would be necessary if the filepath contained spaces but they definitely cause a problem for my case. If you agree, please change your example accordingly. Thanks!"}, {"owner": {"reputation": 1860, "user_id": 731539, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c2bfdb69d8f93cb19009331cde9971eb?s=128&d=identicon&r=PG", "display_name": "Julian", "link": "https://stackoverflow.com/users/731539/julian"}, "reply_to_user": {"reputation": 910, "user_id": 426853, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b7fbf02bd4eb6fa180937d44a6afdcd0?s=128&d=identicon&r=PG", "display_name": "Mike Ellis", "link": "https://stackoverflow.com/users/426853/mike-ellis"}, "edited": false, "score": 0, "creation_date": 1553631478, "post_id": 55361655, "comment_id": 97454718, "body": "It should also work with the single quotes around the filename, see <a href=\"https://gist.github.com/julianbrost/57251afb708cd851fdbca58740353db9\" rel=\"nofollow noreferrer\">gist.github.com/julianbrost/57251afb708cd851fdbca58740353db9</a>"}], "tags": [], "owner": {"reputation": 1860, "user_id": 731539, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c2bfdb69d8f93cb19009331cde9971eb?s=128&d=identicon&r=PG", "display_name": "Julian", "link": "https://stackoverflow.com/users/731539/julian"}, "is_accepted": true, "score": 1, "last_activity_date": 1553616697, "creation_date": 1553616697, "answer_id": 55361655, "question_id": 55360397, "link": "https://stackoverflow.com/questions/55360397/running-sqlite3-backup-with-exec-command/55361655#55361655", "title": "Running sqlite3 .backup with exec.Command", "body": "<p>You don't need the additional quotes at all, so this should do:</p>\n\n<pre><code>exec.Command(\"sqlite3\", dbpath, fmt.Sprintf(\".backup '%s'\", bakpath))\n</code></pre>\n\n<p>The quotes are parsed by the shell so that <code>.backup 'somefile'</code> gets passed to <code>sqlite3</code> as a single argument. When using <code>exec.Command</code>, there is no shell involved, that's also the reason why you are passing the command splitted into multiple parameters.</p>\n"}], "owner": {"reputation": 910, "user_id": 426853, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b7fbf02bd4eb6fa180937d44a6afdcd0?s=128&d=identicon&r=PG", "display_name": "Mike Ellis", "link": "https://stackoverflow.com/users/426853/mike-ellis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 55361655, "answer_count": 1, "score": -1, "last_activity_date": 1553616697, "creation_date": 1553612751, "question_id": 55360397, "link": "https://stackoverflow.com/questions/55360397/running-sqlite3-backup-with-exec-command", "title": "Running sqlite3 .backup with exec.Command", "body": "<p>I'm attempting to back up a db from Go using the sqlite3 <code>.backup</code> command in the manner give by this SO answer <a href=\"https://stackoverflow.com/a/25684912/426853\">https://stackoverflow.com/a/25684912/426853</a>. </p>\n\n<p>The following always works from the command line:</p>\n\n<p><code>sqlite3 /home/pi/pgclogs/smartlog.db \".backup '/home/pi/pgcdata/smartlog.db.bak'\"</code></p>\n\n<p>I've coded it in Go as follows:</p>\n\n<pre><code>func DbBackup() (err error) {\n    dbpath := \"/home/pi/pgclogs/smartlog.db\"\n    bakpath := \"/home/pi/pgcdata/smartlog.db.bak\"\n    cmd := exec.Command(\"sqlite3\", dbpath, fmt.Sprintf(\"\\\".backup '%s'\\\"\", bakpath))\n    out, err := cmd.CombinedOutput()\n    if err != nil {\n        return fmt.Errorf(\"dbBackup failed : %s : %v\", string(out), err)\n    }\n    return\n} \n</code></pre>\n\n<p>and I have a test file that invokes it like this:</p>\n\n<pre><code>func TestDbBackup(t *testing.T) {\n    var err error\n    err = DbBackup()\n    if err != nil {\n        t.Errorf(\"backup failed : %v\", err)\n    }\n} \n</code></pre>\n\n<p>The test reports a syntax error from sqlite3.</p>\n\n<pre><code>--- FAIL: TestDbBackup (0.01s)\n    db_backup_test.go:22: backup failed : dbBackup failed : Error: near \"\".backup '/home/pi/pgcdata/smartlog.db.bak'\"\": syntax error\n         : exit status 1\n</code></pre>\n\n<p>I suspect the problem is the way <code>cmd.CombinedOutput</code> is passing the arguments to the shell and that the problem is in the quoting in the <code>fmt.Sprintf</code> call. I've tried changing it to</p>\n\n<pre><code>fmt.Sprintf(`\".backup '%s'\"`, bakpath)\n</code></pre>\n\n<p>but the result is the same. I also tried putting <code>echo</code> in front of the command, i.e <code>exec.Command(\"echo\", \"sqlite3\", dbpath, ...</code> and printing the output.  The output looks absolutely correct</p>\n\n<pre><code>sqlite3 /home/pi/pgclogs/smartlog.db \".backup '/home/pi/pgcdata/smartlog.db.bak'\"\n</code></pre>\n\n<p>and it runs correctly when pasted to the command line. I'm sure I'm overlooking something simple, but I've spent over an hour and am still not seeing it.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1767, "user_id": 1073170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c13e7782e36e3cf978a02ee761c7e70e?s=128&d=identicon&r=PG", "display_name": "Jory Geerts", "link": "https://stackoverflow.com/users/1073170/jory-geerts"}, "edited": false, "score": 1, "creation_date": 1553613768, "post_id": 55360198, "comment_id": 97445289, "body": "In your code, you first assign an int value to <code>l</code>; then two lines later you try to read it as if it is an array/slice. Should the <code>if</code> really be <code>if line[k]-line[m] == 0 || line[k]-line[m] == 1 {</code> ?"}, {"owner": {"reputation": 123, "user_id": 11261002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab42d135c9fcd15a8c1a2047b3ddc6e0?s=128&d=identicon&r=PG&f=1", "display_name": "strawberrylatte", "link": "https://stackoverflow.com/users/11261002/strawberrylatte"}, "reply_to_user": {"reputation": 1767, "user_id": 1073170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c13e7782e36e3cf978a02ee761c7e70e?s=128&d=identicon&r=PG", "display_name": "Jory Geerts", "link": "https://stackoverflow.com/users/1073170/jory-geerts"}, "edited": false, "score": 0, "creation_date": 1553659036, "post_id": 55360198, "comment_id": 97462086, "body": "i actually wanted the if function to read the int values, but i don&#39;t know how, i did the if line that you suggested but i got this as the output,   panic: runtime error: index out of range"}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 11261002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab42d135c9fcd15a8c1a2047b3ddc6e0?s=128&d=identicon&r=PG&f=1", "display_name": "strawberrylatte", "link": "https://stackoverflow.com/users/11261002/strawberrylatte"}, "edited": false, "score": 0, "creation_date": 1553653668, "post_id": 55367135, "comment_id": 97461020, "body": "running letters means for feed,it is from running letters of def, while trusts is from running letters of stu"}, {"owner": {"reputation": 123, "user_id": 11261002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab42d135c9fcd15a8c1a2047b3ddc6e0?s=128&d=identicon&r=PG&f=1", "display_name": "strawberrylatte", "link": "https://stackoverflow.com/users/11261002/strawberrylatte"}, "edited": false, "score": 0, "creation_date": 1553662581, "post_id": 55367135, "comment_id": 97462858, "body": "while bdc is running letters of bcd, which means abcdef is also a running letter"}], "tags": [], "owner": {"reputation": 1, "user_id": 11262845, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KpJ6i.jpg?s=128&g=1", "display_name": "seomis ", "link": "https://stackoverflow.com/users/11262845/seomis"}, "is_accepted": false, "score": 0, "last_activity_date": 1553639634, "creation_date": 1553639634, "answer_id": 55367135, "question_id": 55360198, "link": "https://stackoverflow.com/questions/55360198/how-to-get-the-differences-of-values-that-are-in-one-slice/55367135#55367135", "title": "how to get the differences of values that are in one slice?", "body": "<p>Not sure if i understood exactly what want (bdc does not seem to be a running word) but here goes my interpretation:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"strings\"\n)\n\nfunc running(word string) bool {\n\n    evaluator := int(word[0])\n\n    for _, v := range word {\n        if int(v) != evaluator-1 &amp;&amp; int(v) != evaluator+1 &amp;&amp; int(v) != evaluator {\n            return false\n        }\n        evaluator = int(v)\n    }\n    return true\n}\n\nfunc runningWords(line string) (result []string) {\n    words := strings.Split(line, \" \")\n    for _, aword := range words {\n        if running(aword) {\n            result = append(result, aword)\n        }\n    }\n    return\n}\n\nfunc main() {\n    fmt.Println(runningWords(\"algo atum feed bcd abcdef\"))\n}\n</code></pre>\n\n<p>and a playground link <a href=\"https://play.golang.org/p/A44Xed6Naa6\" rel=\"nofollow noreferrer\">https://play.golang.org/p/A44Xed6Naa6</a></p>\n\n<p>Notes about your code:</p>\n\n<ol>\n<li><p>or is ||</p></li>\n<li><p>i think you want to access the rune of line. l is an integer so l[k] or l[m] wont compile. i think you wanted r[k] or l[m]</p></li>\n<li><p>if it is a long text you need to consider newlines, special characters, punctuation and several other issues.</p></li>\n</ol>\n\n<p>Best of luck  </p>\n"}], "owner": {"reputation": 123, "user_id": 11261002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab42d135c9fcd15a8c1a2047b3ddc6e0?s=128&d=identicon&r=PG&f=1", "display_name": "strawberrylatte", "link": "https://stackoverflow.com/users/11261002/strawberrylatte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1553639634, "creation_date": 1553612224, "question_id": 55360198, "link": "https://stackoverflow.com/questions/55360198/how-to-get-the-differences-of-values-that-are-in-one-slice", "title": "how to get the differences of values that are in one slice?", "body": "<p>Instead of a slice, i have to retrieve words from a file and i have to only output words whereby the letters are of running letters like feed, and bcd</p>\n\n<p>So i came up with this func, whereby r []rune is the int representative of the alphabets and line is the words from the file. This function supposedly minus the value in position k and the value in position m, and if the output is either 0 or 1, it will return bool. But i can't get this  if l[k]-l[m]=0 | l[k]-l[m]=1{ to work </p>\n\n<pre><code>func differenceofint(r []rune, line string) bool{\n        for i, j := range r{\n        k := int(i) //position\n        l := int(j) //the int representative\n        m:=int (i+1)\n        fmt.Println(k, l,m)\n        if l[k]-l[m]=0 | l[k]-l[m]=1{\n           return true\n        }\n    }\nreturn false\n}\n</code></pre>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1553612116, "post_id": 55360091, "comment_id": 97444112, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/42629541/go-lang-sort-a-2d-array\">Go lang sort a 2D Array</a>"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1553612615, "post_id": 55360091, "comment_id": 97444480, "body": "@JimB there is an interesting edge case here since the element being sorted may be empty, so the sort.Slice function is more interesting than the referenced duplicate answers."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1553613072, "post_id": 55360091, "comment_id": 97444806, "body": "@colminator: I&#39;m not sure how interesting that is, as it should be obvious whether you need to check the bounds or not. This is really just a form of the regularly posted &quot;how to sort X by Y&quot;, and we don&#39;t need separate answers for every possible combination of types and fields for X and Y. At some point you need to be able to apply the documentation. (that said, if you feel it deserves an answer, go ahead and vote to reopen ;))"}], "answers": [{"tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": true, "score": 1, "last_activity_date": 1553614112, "creation_date": 1553614112, "answer_id": 55360849, "question_id": 55360091, "link": "https://stackoverflow.com/questions/55360091/golang-sort-slices-of-slice-by-first-element/55360849#55360849", "title": "golang sort slices of slice by first element", "body": "<p>The question does not state what should be done with empty slices, so treating them like an empty word in a conventional word-sort, would put them first, so this would handle that edge case:</p>\n\n<pre><code>import \"sort\"\n\nsort.Slice(s, func(i, j int) bool {\n    // edge cases\n    if len(s[i]) == 0 &amp;&amp; len(s[j]) == 0 {\n        return false // two empty slices - so one is not less than other i.e. false\n    }\n    if len(s[i]) == 0 || len(s[j]) == 0 {\n        return len(s[i]) == 0 // empty slice listed \"first\" (change to != 0 to put them last)\n    }\n\n    // both slices len() &gt; 0, so can test this now:\n    return s[i][0] &lt; s[j][0]\n})\n</code></pre>\n\n<p>Playground <a href=\"https://play.golang.org/p/BQgpTPmkCGX\" rel=\"nofollow noreferrer\">version</a>.</p>\n"}], "owner": {"reputation": 19, "user_id": 11249693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/151cda69d0889a2d39b0f8619f8705a2?s=128&d=identicon&r=PG&f=1", "display_name": "user5593444", "link": "https://stackoverflow.com/users/11249693/user5593444"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1130, "favorite_count": 0, "accepted_answer_id": 55360849, "answer_count": 1, "score": 0, "last_activity_date": 1553614112, "creation_date": 1553611889, "question_id": 55360091, "link": "https://stackoverflow.com/questions/55360091/golang-sort-slices-of-slice-by-first-element", "title": "golang sort slices of slice by first element", "body": "<p>i'm trying to do sorting for my slice child's (inside a slice), my slice is created from</p>\n\n<pre><code>var s [][]int64\ns = append(s, []int64{2, 60, 55, 5})\ns = append(s, []int64{4, 45, 35, 10})\ns = append(s, []int64{1, 200, 160, 40})\nfmt.Println(s) # [[2 60 55 5] [4 45 35 10] [1 200 160 40]]\n</code></pre>\n\n<p>how to sort it's value by first element to become :</p>\n\n<pre><code>[[1 200 160 40] [2 60 55 5] [4 45 35 10]]\n</code></pre>\n"}, {"tags": ["go", "struct", "xml-rpc", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 2702, "user_id": 2923336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LmjCO.png?s=128&g=1", "display_name": "Francois", "link": "https://stackoverflow.com/users/2923336/francois"}, "is_accepted": true, "score": 1, "last_activity_date": 1553610464, "last_edit_date": 1553610464, "creation_date": 1553609857, "answer_id": 55359358, "question_id": 55359133, "link": "https://stackoverflow.com/questions/55359133/how-to-pass-structure-to-xml-rpc-as-an-argument/55359358#55359358", "title": "How to pass structure to xml-rpc as an argument", "body": "<p>Your fields in Data are unexported, which leads to a panic when trying to access the value using reflect package. That's because the xmlrpc package tries to access the value of these unexported properties. </p>\n\n<p>Change your <code>Data</code>struct to export its property:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Data struct {\n  SerialNumber   string\n  ProductionDate string\n}\n</code></pre>\n\n<p>In go, when a type, variable, struct fields, function or methods starts by lowercase, it's considered unexposed to other packages. To expose it you need to start their name by an uppercase letter. Also, the naming convention in go is CamelCase. </p>\n"}], "owner": {"reputation": 5, "user_id": 6174802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c421f27df6156bcc1fb6eac9e94fac1e?s=128&d=identicon&r=PG&f=1", "display_name": "Linas Opulskis", "link": "https://stackoverflow.com/users/6174802/linas-opulskis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "accepted_answer_id": 55359358, "answer_count": 1, "score": 0, "last_activity_date": 1553610464, "creation_date": 1553609129, "question_id": 55359133, "link": "https://stackoverflow.com/questions/55359133/how-to-pass-structure-to-xml-rpc-as-an-argument", "title": "How to pass structure to xml-rpc as an argument", "body": "<p>I am kinda new to go and have been trying to use XML-RPC methods from my go API, to do that I have selected <a href=\"https://github.com/mattn/go-xmlrpc\" rel=\"nofollow noreferrer\">https://github.com/mattn/go-xmlrpc</a> and everything works fine until I had to pass structure as a parameter. In the example that I got the structure is either python dictionary with format of \n{string : string} or empty dictionary. If I give the structure with values that I used in the example on python I would get panic serving.</p>\n\n<p>I have tried to create maps or empty structs but it would say that the given parameters are wrong (the error is caused by xml-rpc). If I would try to make it to json and parse it back using encoding/json decoder it would say that I am using wrong structure.</p>\n\n<pre><code>type Data struct {\n serial_number   string\n production_date string\n}\n\nfunc myFunc(){\n data := Data{serial_number: \"MB1034RK7856\", production_date: \"\"}\n equipmentId, er2 := xmlrpc.Call(url,\"addEquipment\",19,\n \"testId\", \"mac\",\"10.21.16.160\", 0, data, 0)\n\n if er2 != nil {\n  log.Fatal(er2)\n }\n}\n</code></pre>\n\n<p>The \"results\" that I am getting now : </p>\n\n<pre><code>2019/03/26 15:31:20 http: panic serving [::1]:14885: reflect.Value.Interface: cannot return value obtained from unexported field or method\ngoroutine 66 [running]:\nnet/http.(*conn).serve.func1(0xc00025a000)\n        C:/Go/src/net/http/server.go:1746 +0xd7\npanic(0x8a6d00, 0x9efd20)\n        C:/Go/src/runtime/panic.go:513 +0x1c7\nreflect.valueInterface(0x8a6d00, 0xc001008060, 0xb8, 0x1, 0xc0010061b0, 0x2a)\n        C:/Go/src/reflect/value.go:989 +0x1c5\nreflect.Value.Interface(0x8a6d00, 0xc001008060, 0xb8, 0xc000239428, 0x1)\n        C:/Go/src/reflect/value.go:978 +0x4b\ngithub.com/mattn/go-xmlrpc.toXml(0x8f1740, 0xc001008060, 0x1, 0xe, 0x0)\n        C:/Users/oplin/go/src/github.com/mattn/go-xmlrpc/xmlrpc.go:282     +0x100d\ngithub.com/mattn/go-xmlrpc.makeRequest(0x95f701, 0xc, 0xc000239950, 0x7, 0x7, 0xc00016c380)\n        C:/Users/oplin/go/src/github.com/mattn/go-xmlrpc/xmlrpc.go:314 +0x1b0\ngithub.com/mattn/go-xmlrpc.call(0xd23a00, 0x9761ca, 0x3e, 0x95f701, 0xc, 0xc00021f950, 0x7, 0x7, 0x0, 0x0, ...)\n        C:/Users/oplin/go/src/github.com/mattn/go-xmlrpc/xmlrpc.go:322 +0x91\ngithub.com/mattn/go-xmlrpc.Call(0x9761ca, 0x3e, 0x95f701, 0xc, 0xc00021f950, 0x7, 0x7, 0x935ce0, 0xc00016c380, 0x0, ...)\n     C:/Users/oplin/go/src/github.com/mattn/go-xmlrpc/xmlrpc.go:368 +0x8d\nbitbucket.org/epuzzle/puzzle-backend/web.IDontWantToLiveAnymore(0x1b682c0, 0xc0001f2010, 0xc00011a300)\n        C:/Users/oplin/go/src/bitbucket.org/epuzzle/puzzle-backend /web/registration.go:208 +0x1a1\nnet/http.HandlerFunc.ServeHTTP(0x988fb0, 0x1b682c0, 0xc0001f2010, 0xc00011a300)\n        C:/Go/src/net/http/server.go:1964 +0x4b\ngithub.com/gorilla/mux.(*Router).ServeHTTP(0xc0001d0540, 0x1b682c0, 0xc0001f2010, 0xc00011a100)\n        C:/Users/oplin/go/src/github.com/gorilla/mux/mux.go:212 +0xd7\ngithub.com/codegangsta/negroni.Wrap.func1(0x1b682c0, 0xc0001f2010, 0xc00011a100, 0xc001008040)\n        C:/Users/oplin/go/src/github.com/codegangsta/negroni/negroni.go:46 +0x54\ngithub.com/codegangsta/negroni.HandlerFunc.ServeHTTP(0xc00028d340, 0x1b682c0, 0xc0001f2010, 0xc00011a100, 0xc001008040)\n        C:/Users/oplin/go/src/github.com/codegangsta/negroni/negroni.go:29 +0x55\ngithub.com/codegangsta/negroni.middleware.ServeHTTP(0x9f23a0, 0xc00028d340, 0xc00028d3a0, 0x1b682c0, 0xc0001f2010, 0xc00011a100)\n        C:/Users/oplin/go/src/github.com/codegangsta/negroni/negroni.go:38 +0xa3\ngithub.com/codegangsta/negroni.middleware.ServeHTTP-fm(0x1b682c0, 0xc0001f2010, 0xc00011a100)\n        C:/Users/oplin/go/src/github.com/codegangsta/negroni/negroni.go:38 +0x67\nbitbucket.org/epuzzle/puzzle-backend/lib.Logger(0x1b682c0, 0xc0001f2010, 0xc00011a100, 0xc001008020)\n        C:/Users/oplin/go/src/bitbucket.org/epuzzle/puzzle-backend /lib/middleware.go:13 +0x8f\ngithub.com/codegangsta/negroni.HandlerFunc.ServeHTTP(0x988f00, 0x1b682c0, 0xc0001f2010, 0xc00011a100, 0xc001008020)\n        C:/Users/oplin/go/src/github.com/codegangsta/negroni/negroni.go:29 +0x55\ngithub.com/codegangsta/negroni.middleware.ServeHTTP(0x9f23a0, 0x988f00, 0xc00028d380, 0x1b682c0, 0xc0001f2010, 0xc00011a100)\n        C:/Users/oplin/go/src/github.com/codegangsta/negroni/negroni.go:38 +0xa3\ngithub.com/codegangsta/negroni.(*Negroni).ServeHTTP(0xc0002c6690, 0x9f5540, 0xc0003142a0, 0xc00011a100)\n        C:/Users/oplin/go/src/github.com/codegangsta/negroni/negroni.go:98 +0xf5\nnet/http.serverHandler.ServeHTTP(0xc0001c4750, 0x9f5540, 0xc0003142a0, 0xc00011a100)\n        C:/Go/src/net/http/server.go:2741 +0xb2\nnet/http.(*conn).serve(0xc00025a000, 0x9f5b80, 0xc0002dc300)\n        C:/Go/src/net/http/server.go:1847 +0x64d\ncreated by net/http.(*Server).Serve\n        C:/Go/src/net/http/server.go:2851 +0x2fc\n</code></pre>\n"}, {"tags": ["oracle", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 4, "creation_date": 1553606946, "post_id": 55358159, "comment_id": 97440469, "body": "First you should provide the definitions for <code>Exe</code> and <code>Prep</code> as these are <b>non-standard</b> methods. A link to the package where you got them from would be nice as well."}, {"owner": {"reputation": 21, "user_id": 11256722, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4Y0B9a5CBAk/AAAAAAAAAAI/AAAAAAAAAG8/kBYkvSSifdU/photo.jpg?sz=128", "display_name": "Nneha Sachan", "link": "https://stackoverflow.com/users/11256722/nneha-sachan"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1553661193, "post_id": 55358159, "comment_id": 97462532, "body": "<a href=\"https://godoc.org/gopkg.in/rana/ora.v4#NewEnvSrvSes\" rel=\"nofollow noreferrer\">godoc.org/gopkg.in/rana/ora.v4#NewEnvSrvSes</a>"}, {"owner": {"reputation": 6003, "user_id": 4799035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tuyZM.jpg?s=128&g=1", "display_name": "Christopher Jones", "link": "https://stackoverflow.com/users/4799035/christopher-jones"}, "edited": false, "score": 0, "creation_date": 1558918204, "post_id": 55358159, "comment_id": 99245629, "body": "@NnehaSachan take a look at <a href=\"https://github.com/go-goracle/goracle\" rel=\"nofollow noreferrer\">github.com/go-goracle/goracle</a> which is the replacement for rana/ora"}], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 0, "last_activity_date": 1553664767, "creation_date": 1553664767, "answer_id": 55370400, "question_id": 55358159, "link": "https://stackoverflow.com/questions/55358159/returning-values-with-insert-query-using-oracle/55370400#55370400", "title": "Returning values with INSERT query using Oracle", "body": "<p>In a call to a variadic function you cannot pass additional arguments after <code>...</code> so you need to append the id pointers to the actualvalue slice as well.</p>\n\n<pre><code>var actualvalue []interface{}\nvar id uint64 \nvar id2 uint64 \n\nactualvalue = append(actualvalue, 1) \nactualvalue = append(actualvalue, 2) \nactualvalue = append(actualvalue, 3)\nactualvalue = append(actualvalue, &amp;id)\nactualvalue = append(actualvalue, &amp;id2)\n\nquery = \"insert into table (a,b,c) values (:a,:b,:c) returning primarykey, secondarykey into :primarykey,:secondarykey\"\n\nstmtIns, err := dbConnImbl.Prep(query) \nif err != nil { fmt.Println(\"Second Method Error 22====&gt;&gt; \",err) } \n\nrowsAffected, err := stmtIns.Exe(actualvalue...)\nif err != nil { fmt.Println(\"Error Cluses \" , err) }\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11256722, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4Y0B9a5CBAk/AAAAAAAAAAI/AAAAAAAAAG8/kBYkvSSifdU/photo.jpg?sz=128", "display_name": "Nneha Sachan", "link": "https://stackoverflow.com/users/11256722/nneha-sachan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1553664767, "creation_date": 1553606279, "last_edit_date": 1553607979, "question_id": 55358159, "link": "https://stackoverflow.com/questions/55358159/returning-values-with-insert-query-using-oracle", "title": "Returning values with INSERT query using Oracle", "body": "<p>How do I pass bind params values in EXE statement?</p>\n\n<p>Eg -</p>\n\n<pre><code>actualvalue = append(actualvalue, 1) \nactualvalue = append(actualvalue, 2) \nactualvalue = append(actualvalue, 3)\n\nquery = \u201cinsert into table (a,b,c) values (:a,:b,:c) returning primarykey, secondarykey into :primarykey,:secondarykey\u201d \n\nstmtIns, err := dbConnImbl.Prep(query) \nif err != nil { fmt.Println(\"Second Method Error 22====&gt;&gt; \",err) } \nvar id uint64 \nvar id2 uint64 \nrowsAffected, err := stmtIns.Exe(actualvalue\u2026, &amp;id,&amp;id2)//.Scan(&amp;id,&amp;id2) \nif err != nil { fmt.Println(\"Error Cluses \" , err) }\n</code></pre>\n\n<p>the highlighted line is not working.</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 2702, "user_id": 2923336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LmjCO.png?s=128&g=1", "display_name": "Francois", "link": "https://stackoverflow.com/users/2923336/francois"}, "edited": false, "score": 0, "creation_date": 1553604963, "post_id": 55356916, "comment_id": 97439029, "body": "Which mongo package are you using?"}, {"owner": {"reputation": 63, "user_id": 11154131, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Df9Cd5m8YbU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf3t3aLeqiZQsvHjhZOsFrB-0dzvg/mo/photo.jpg?sz=128", "display_name": "Abraham", "link": "https://stackoverflow.com/users/11154131/abraham"}, "reply_to_user": {"reputation": 2702, "user_id": 2923336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LmjCO.png?s=128&g=1", "display_name": "Francois", "link": "https://stackoverflow.com/users/2923336/francois"}, "edited": false, "score": 0, "creation_date": 1553605272, "post_id": 55356916, "comment_id": 97439269, "body": "these are my imports in my go code.   &quot;gopkg.in/mgo.v2&quot; and &quot;gopkg.in/mgo.v2/bson&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1553605012, "creation_date": 1553605012, "answer_id": 55357758, "question_id": 55356916, "link": "https://stackoverflow.com/questions/55356916/how-to-write-go-bson-m-from-mongodb-query/55357758#55357758", "title": "How to write go bson.M from MongoDb query", "body": "<p><a href=\"https://godoc.org/github.com/globalsign/mgo#Query.Distinct\" rel=\"nofollow noreferrer\"><code>Query.Distinct()</code></a> unmarshals the list of distinct <strong>values</strong>, not complete documents (the equivalent MongoDB query also returns values, not documents).</p>\n\n<p>So simply unmarshal the distinct IPs into a value of type <code>[]string</code> (and also never forget about handling errors):</p>\n\n<pre><code>var ips []string\n\nerr := db.C(COLLECTION).Find(bson.M{\n    \"nfType\":           \"AMF\",\n    \"amfInfo.amfSetId\": \"3fa85f64-5717-4562-b3fc-2c963f66af33\",\n}).Distinct(\"ipv4Addresses\", &amp;ips)\nif err != nil {\n    // handle error\n}\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 11154131, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Df9Cd5m8YbU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf3t3aLeqiZQsvHjhZOsFrB-0dzvg/mo/photo.jpg?sz=128", "display_name": "Abraham", "link": "https://stackoverflow.com/users/11154131/abraham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 632, "favorite_count": 0, "accepted_answer_id": 55357758, "answer_count": 1, "score": 1, "last_activity_date": 1553605019, "creation_date": 1553602494, "last_edit_date": 1553605019, "question_id": 55356916, "link": "https://stackoverflow.com/questions/55356916/how-to-write-go-bson-m-from-mongodb-query", "title": "How to write go bson.M from MongoDb query", "body": "<p>I am using mongodb as database. I'm able to query the database from the command line using the command</p>\n\n<p><code>db.nfinstances.distinct(\"ipv4Addresses\",{\"nfType\":\"AMF\", \"amfInfo.amfSetId\": \"3fa85f64-5717-4562-b3fc-2c963f66af33\"})</code></p>\n\n<p>and this give me the ip address [x.x.x.x] output that I want. </p>\n\n<p>However, if I query using the golang query</p>\n\n<pre><code>var SliceIP []NfInstance\n\ndb.C(COLLECTION).Find(bson.M{\n                      \"nfType\": \"AMF\",\n                      \"amfInfo.amfSetId\": \"3fa85f64-5717-4562-b3fc-2c963f66af33\"}\n                      ).Distinct(\"ipv4Addresses\", &amp;SliceIP)\n</code></pre>\n\n<p>I'm getting an empty array instead of the the IP address string in an array. In the database i have the json document as</p>\n\n<pre><code>{\n    \"nfinstanceID\": \"3fa85f64-5717-4562-b3fc-2c963f66af33\",\n    \"nfType\": [\n        \"AMF\"\n    ],\n    \"nfStatus\": [\n        \"REGISTERED\"\n    ],\n    \"sNssais\": [\n        {\n            \"sst\": 1,\n            \"sd\": \"sd1\"\n        }\n    ],\n    \"nsiList\": [\n        \"string\"\n    ],\n    \"ipv4Addresses\": [\n        \"198.51.100.300\"\n    ],\n    \"allowedNssais\": [\n        {\n            \"sst\": 1,\n            \"sd\": \"sd1\"\n        }\n    ],\n    \"amfInfo\": {\n        \"amfSetId\": \"3fa85f64-5717-4562-b3fc-2c963f66af33\",\n        \"taiList\": [\n            {\n                \"plmnId\": {\n                    \"mcc\": \"244\",\n                    \"mnc\": \"38\"\n                },\n                \"tac\": \"string\"\n            }\n        ],\n        \"n2InterfaceAmfInfo\": {\n            \"ipv4EndpointAddress\": [\n                \"198.51.100.105\"\n            ]\n        }\n    }\n}\n</code></pre>\n\n<p>Mongodb command line query look like this</p>\n\n<pre><code>&gt; db.nfinstances.distinct(\"ipv4Addresses\",{\"nfType\":\"AMF\", \"amfInfo.amfSetId\": \"3fa85f64-5717-4562-b3fc-2c963f66af33\"})\n\nmongodb Output:\n\n[ \"198.51.100.300\" ]\n</code></pre>\n\n<p>The same output I am expecting using the bson.M</p>\n\n<p>Can anyone help find the problem?</p>\n"}, {"tags": ["mongodb", "go", "indexing", "text-search"], "answers": [{"comments": [{"owner": {"reputation": 312, "user_id": 11189140, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EpmYCr3Lg5Y/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfMaxaOmwFJEeFJYsV-ut6Nemx2jA/mo/photo.jpg?sz=128", "display_name": "Anirudh Simha", "link": "https://stackoverflow.com/users/11189140/anirudh-simha"}, "edited": false, "score": 0, "creation_date": 1553768298, "post_id": 55358402, "comment_id": 97510493, "body": "Please close your question by clicking the checkmark to the left of the answer that helped you most"}], "tags": [], "owner": {"reputation": 312, "user_id": 11189140, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EpmYCr3Lg5Y/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfMaxaOmwFJEeFJYsV-ut6Nemx2jA/mo/photo.jpg?sz=128", "display_name": "Anirudh Simha", "link": "https://stackoverflow.com/users/11189140/anirudh-simha"}, "is_accepted": true, "score": 0, "last_activity_date": 1553610669, "last_edit_date": 1553610669, "creation_date": 1553606987, "answer_id": 55358402, "question_id": 55355789, "link": "https://stackoverflow.com/questions/55355789/mongo-go-driver-indexnotfound-text-index-required-for-text-query/55358402#55358402", "title": "mongo-go-driver (IndexNotFound) text index required for $text query", "body": "<p>You need to have a <a href=\"https://docs.mongodb.com/manual/core/index-text/\" rel=\"nofollow noreferrer\"><strong><code>text</code></strong> index</a> on atleast 1 field for the query to work.\nTry creating a text index on any field and try again</p>\n"}], "owner": {"reputation": 578, "user_id": 7823423, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kkX4Xjrf1fA/AAAAAAAAAAI/AAAAAAAAAEw/cDaurOcupnw/photo.jpg?sz=128", "display_name": "Sabyasachi Patra", "link": "https://stackoverflow.com/users/7823423/sabyasachi-patra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 807, "favorite_count": 0, "accepted_answer_id": 55358402, "answer_count": 1, "score": 0, "last_activity_date": 1553610669, "creation_date": 1553598880, "question_id": 55355789, "link": "https://stackoverflow.com/questions/55355789/mongo-go-driver-indexnotfound-text-index-required-for-text-query", "title": "mongo-go-driver (IndexNotFound) text index required for $text query", "body": "<p>I'm using mongo-go-driver and trying to use text search</p>\n\n<p>I'm creating index like this </p>\n\n<pre><code>    opts := options.CreateIndexes().SetMaxTime(10 * time.Second)\n    db.Collection(\"my_collection\").Indexes().CreateMany(\n        context.Background(),\n        []mongo.IndexModel{\n            {\n                Keys: bsonx.Doc{{\"title\", bsonx.Int32(-1)}},\n            },\n            {\n                Keys: bsonx.Doc{{\"info.tags\", bsonx.Int32(-1)}},\n            },\n        },\n        opts,\n    )\n</code></pre>\n\n<p>...and while querying I'm doing this </p>\n\n<pre><code>    collection := db.Collection(\"my_collection\")\n\n    cur, err := collection.Find(context.Background(), bson.M{ \"$text\": bson.M{ \"$search\": query }})\n</code></pre>\n\n<p>I get this when I call the query</p>\n\n<pre><code> (IndexNotFound) text index required for $text query\n  exit status 1\n</code></pre>\n"}, {"tags": ["go", "memory-leaks"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1553606097, "last_edit_date": 1553606097, "creation_date": 1553601825, "answer_id": 55356720, "question_id": 55355577, "link": "https://stackoverflow.com/questions/55355577/memory-leak-in-solution-for-exercise-equivalent-binary-trees/55356720#55356720", "title": "memory leak in solution for Exercise: Equivalent Binary Trees?", "body": "<p>When multiple goroutines are targeted with a cancellation signal, most often it is done by closing a channel, and not sending a value on the channel. Receiving from a closed channel can proceed immediately, no matter how many goroutines do that. A value sent on a channel can be received at most once, so it is not suitable to signal multiple goroutines with a value. <a href=\"https://golang.org/ref/spec#Receive_operator\" rel=\"nofollow noreferrer\">Spec: Receive operator:</a></p>\n\n<blockquote>\n  <p>A receive operation on a <a href=\"https://golang.org/ref/spec#Close\" rel=\"nofollow noreferrer\">closed</a> channel can always proceed immediately, yielding the element type's <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"nofollow noreferrer\">zero value</a> after any previously sent values have been received.</p>\n</blockquote>\n\n<p>Now, if you close the <code>quit</code> channel, that does not guarantee your function will return immediately.</p>\n\n<p>First, you recurse down to the left child without checking <code>quit</code>, which call will do the same (until a <code>nil</code> left child is reached).</p>\n\n<p>Second, if a value can be sent on <code>ch</code>, then both cases are ready and thus <code>select</code> chooses one of them randomly, which may or may not be the <code>quit</code> case. For details, see <a href=\"https://stackoverflow.com/questions/47645808/golang-how-the-select-worked-when-multiple-channel-involved/47648910#47648910\">How does select work when multiple channels are involved?</a></p>\n\n<p>If you want to avoid these, you should add a non-blocking <code>quit</code> check as the first thing in your function:</p>\n\n<pre><code>func walkImpl(t *tree.Tree, ch, quit chan int) {\n    select {\n    case &lt;-quit:\n        return\n    default: // This empty default makes it a non-blocking check\n    }\n\n    if t == nil {\n        return\n    }\n    walkImpl(t.Left, ch, quit)\n    select {\n    case ch &lt;- t.Value:\n        // Value successfully sent.\n    case &lt;-quit:\n        return\n    }\n    walkImpl(t.Right, ch, quit)\n}\n</code></pre>\n\n<p>Now one could ask if we still need the <code>quit</code> case in the second <code>select</code> since we've already checked it first thing in <code>walkImpl()</code>. The answer is that you should keep that too, because if sending on <code>ch</code> would block (e.g. the consumer would be shut down when <code>quit</code> is closed), that send operation could block forever. This way (when <code>quit</code> is closed) it is guaranteed that the function returns.</p>\n"}], "owner": {"reputation": 33, "user_id": 11259910, "user_type": "registered", "profile_image": "https://graph.facebook.com/830681900607473/picture?type=large", "display_name": "Yu Liu", "link": "https://stackoverflow.com/users/11259910/yu-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 55356720, "answer_count": 1, "score": 3, "last_activity_date": 1553606097, "creation_date": 1553598223, "last_edit_date": 1553598356, "question_id": 55355577, "link": "https://stackoverflow.com/questions/55355577/memory-leak-in-solution-for-exercise-equivalent-binary-trees", "title": "memory leak in solution for Exercise: Equivalent Binary Trees?", "body": "<p>(<a href=\"https://github.com/golang/tour/blob/master/solutions/binarytrees_quit.go\" rel=\"nofollow noreferrer\">https://github.com/golang/tour/blob/master/solutions/binarytrees_quit.go</a>) for Exercise: Equivalent Binary Trees\nSupposed we have two simple equivalent binary trees \"1 3 5\" and \"2 3 5\". When two goroutines \"Walk\" walks at leaf \"1\" and \"2\" concurrently, </p>\n\n<pre><code>if v1 != v2 {\n    return false\n}\n</code></pre>\n\n<p>this condition in function Same will be true and</p>\n\n<p><code>close(quit)</code></p>\n\n<p>will run.</p>\n\n<pre><code>func walkImpl(t *tree.Tree, ch, quit chan int) {\n    if t == nil {\n        return\n    }\n    walkImpl(t.Left, ch, quit)\n    select {\n    case ch &lt;- t.Value:\n        // Value successfully sent.\n    case &lt;-quit:\n        return\n    }\n    walkImpl(t.Right, ch, quit)\n}\n</code></pre>\n\n<p>Channel \"quit\" will receive message and the second case of select statement will execute. And then it will go back to the upper level function \"walkImpl\" and keep on running the last line <code>walkImpl(t.Right, ch, quit)</code>. So is there goroutine leak under the circumstance, cause channel \"quit\" is already read out, which can't be read again in the upper level? Function \"Walk\" also can't go back to \"close\" handler.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1242, "user_id": 672958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b76268f3a255915fa380139dac950652?s=128&d=identicon&r=PG", "display_name": "andy.xyz", "link": "https://stackoverflow.com/users/672958/andy-xyz"}, "edited": false, "score": 0, "creation_date": 1556710628, "post_id": 55355428, "comment_id": 98523808, "body": "We have identified an issue where some Windows computers will default to a graphics card that OpenGL support does not seem to be complete for. Is it possible that you have multiple graphics hardware as well (common in mid-high spec laptops)?"}], "answers": [{"tags": [], "owner": {"reputation": 1242, "user_id": 672958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b76268f3a255915fa380139dac950652?s=128&d=identicon&r=PG", "display_name": "andy.xyz", "link": "https://stackoverflow.com/users/672958/andy-xyz"}, "is_accepted": false, "score": 0, "last_activity_date": 1553640684, "creation_date": 1553640684, "answer_id": 55367312, "question_id": 55355428, "link": "https://stackoverflow.com/questions/55355428/golang-gui-fyne-io-help-set-up/55367312#55367312", "title": "Golang GUI fyne-io help set up?", "body": "<p>Issue 1 looked like a temporary issue in your DNS lookup - the IDE resolved it shortly after.\nIssue 2 well done on finding the solution.\nIssue 3 you\u2019d be best placed raising a bug on the GitHub tracker[1] - with details of your windows version and hardware so that it can be worked on with you.</p>\n\n<p>1: <a href=\"https://github.com/fyne-io/fyne/issues\" rel=\"nofollow noreferrer\">https://github.com/fyne-io/fyne/issues</a></p>\n"}, {"comments": [{"owner": {"reputation": 1242, "user_id": 672958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b76268f3a255915fa380139dac950652?s=128&d=identicon&r=PG", "display_name": "andy.xyz", "link": "https://stackoverflow.com/users/672958/andy-xyz"}, "edited": false, "score": 0, "creation_date": 1556710544, "post_id": 55600540, "comment_id": 98523774, "body": "This helpful answer includes commands that are specific for Linux but the question is relating to Windows."}], "tags": [], "owner": {"reputation": 1563, "user_id": 1619003, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wKhdR.png?s=128&g=1", "display_name": "GraphicalDot", "link": "https://stackoverflow.com/users/1619003/graphicaldot"}, "is_accepted": false, "score": 0, "last_activity_date": 1554840350, "creation_date": 1554840350, "answer_id": 55600540, "question_id": 55355428, "link": "https://stackoverflow.com/questions/55355428/golang-gui-fyne-io-help-set-up/55600540#55600540", "title": "Golang GUI fyne-io help set up?", "body": "<p>From fyne documentation </p>\n\n<pre><code>By default Fyne uses the gl golang bindings which means you need a working OpenGL configuration. Debian/Ubuntu based systems may also need to install the libgl1-mesa-dev and xorg-dev packages.\n</code></pre>\n\n<p>What Is OpenGL?\nOpenGL is a Graphics rendering API which is operating system independent, window system independent and has high-quality color images composed of geometric and image primitives.</p>\n\n<pre><code>OpenGL APIs can use following \u2026\n\nGl\n    OpenGL API implementation (http://www.opengl.org)\nGlu\n    OpenGL Utility\nGlut \u2013 GLUT (OpenGL Utility Toolkit) \u2013 Glut is portable windowing API and it is not officially part of OpenGL.\n    OpenGL Utility Toolkit (http://www.opengl.org/resources/libraries/glut/)\nFLTK\n    FlashLight ToolKit (http://www.fltk.org/)\nGLEW\u2026\n</code></pre>\n\n<p>Run the following commands to install OpenGL.</p>\n\n<pre><code>sudo apt-get update\nsudo apt-get install libglu1-mesa-dev freeglut3-dev mesa-common-dev\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1242, "user_id": 672958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b76268f3a255915fa380139dac950652?s=128&d=identicon&r=PG", "display_name": "andy.xyz", "link": "https://stackoverflow.com/users/672958/andy-xyz"}, "is_accepted": false, "score": 0, "last_activity_date": 1566895219, "creation_date": 1566895219, "answer_id": 57670766, "question_id": 55355428, "link": "https://stackoverflow.com/questions/55355428/golang-gui-fyne-io-help-set-up/57670766#57670766", "title": "Golang GUI fyne-io help set up?", "body": "<p>It is possible that your graphics driver is out of date. Some others have reported that by updating your drivers this issue has resolved itself.</p>\n"}], "owner": {"reputation": 1, "user_id": 11148783, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lKX147qZ32g/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMn9syT9XE5t6XZfRxX-VEoVNflUQ/mo/photo.jpg?sz=128", "display_name": "Tagir Veliev", "link": "https://stackoverflow.com/users/11148783/tagir-veliev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1056, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1566895219, "creation_date": 1553597786, "question_id": 55355428, "link": "https://stackoverflow.com/questions/55355428/golang-gui-fyne-io-help-set-up", "title": "Golang GUI fyne-io help set up?", "body": "<p>I just can not configure the GUI <a href=\"https://github.com/fyne-io/fyne\" rel=\"nofollow noreferrer\">fyne-io</a>. <code>go get fyne.io/fyne</code> gave an error </p>\n\n<blockquote>\n  <p>package fyne.io/fyne: unrecognized import path \"fyne.io/fyne\" (https fetch: Get <a href=\"https://fyne.io/fyne?go-\" rel=\"nofollow noreferrer\">https://fyne.io/fyne?go-</a>\n  get=1: dial tcp: lookup fyne.io: no such host)</p>\n</blockquote>\n\n<p>It\u2019s good that IDE from JetBrains installed it from import </p>\n\n<p><code>import (\n    \"fyne.io/fyne/widget\"\n    \"fyne.io/fyne/app\"\n)</code></p>\n\n<p>Then at <strong>go run</strong> there was an error </p>\n\n<blockquote>\n  <p>exec: \u201cgcc\u201d: executable file not found in %PATH%</p>\n</blockquote>\n\n<p>Installation <a href=\"http://tdm-gcc.tdragon.net/download\" rel=\"nofollow noreferrer\">TDM-GCC</a> helped solve the problem</p>\n\n<p>And then I can not move. </p>\n\n<pre><code>package main\n\nimport (\n    \"fyne.io/fyne/widget\"\n    \"fyne.io/fyne/app\"\n)\n\nfunc main() {\n    app := app.New()\n\n    w := app.NewWindow(\"Hello\")\n    w.SetContent(widget.NewVBox(\n        widget.NewLabel(\"Hello Fyne!\"),\n        widget.NewButton(\"Quit\", func() {\n            app.Quit()\n        }),\n    ))\n\n    w.ShowAndRun()\n}\n</code></pre>\n\n<p>After go run error</p>\n\n<blockquote>\n  <p>2019/03/26 13:51:11 Fyne error:  failed to initialise OpenGL</p>\n  \n  <p>2019/03/26 13:51:12   Cause: glClientWaitSync</p>\n  \n  <p>2019/03/26 13:51:12   At: C:/gopath/src/fyne.io/fyne/driver/gl/window.go:834</p>\n  \n  <p>panic: runtime error: invalid memory address or nil pointer dereference</p>\n  \n  <p>[signal 0xc0000005 code=0x0 addr=0x10 pc=0x589c9d]</p>\n</blockquote>\n\n<p><a href=\"https://github.com/go-gl/gl\" rel=\"nofollow noreferrer\">gl</a> installed</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1553596660, "post_id": 55354997, "comment_id": 97433791, "body": "Change the slice fields to <code>[]*Species</code>."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1553597330, "post_id": 55354997, "comment_id": 97434221, "body": "Or update the element in ecos.community after appending."}, {"owner": {"reputation": 159, "user_id": 3573024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d560ff0aeb4ce52219a166547fdb09?s=128&d=identicon&r=PG&f=1", "display_name": "mgagnon", "link": "https://stackoverflow.com/users/3573024/mgagnon"}, "edited": false, "score": 0, "creation_date": 1553598287, "post_id": 55354997, "comment_id": 97434850, "body": "I would just use the index when looping on community (for i := range ecos.community). To don\u2019t repeat the &#39;i&#39;, do: \u201cspecies := &amp;ecos.community[i]\u201d on the 1st line in the loop, so the rest of your loop stay the same, but will modify community."}], "answers": [{"tags": [], "owner": {"reputation": 579, "user_id": 11206879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bS2D6.png?s=128&g=1", "display_name": "Pan Ke", "link": "https://stackoverflow.com/users/11206879/pan-ke"}, "is_accepted": false, "score": 1, "last_activity_date": 1553596985, "creation_date": 1553596985, "answer_id": 55355176, "question_id": 55354997, "link": "https://stackoverflow.com/questions/55354997/append-to-struct-slice-in-golang/55355176#55355176", "title": "Append to struct slice in golang", "body": "<p>Try slice of pointer, like this:</p>\n\n<pre><code>// Species struct\ntype Species struct {\n    xPos            int32\n    yPos            int32\n    isAlive         bool\n    willChangeState bool\n    rect            sdl.Rect\n    neighbours      []*Species\n}\n\ntype Ecosystem struct {\n    community []*Species\n}\n</code></pre>\n"}], "owner": {"reputation": 977, "user_id": 4776662, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/833075c33bfbe17d99743362b9da4468?s=128&d=identicon&r=PG&f=1", "display_name": "Bobesh", "link": "https://stackoverflow.com/users/4776662/bobesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1553596985, "creation_date": 1553596457, "question_id": 55354997, "link": "https://stackoverflow.com/questions/55354997/append-to-struct-slice-in-golang", "title": "Append to struct slice in golang", "body": "<p>I tried hard to find example as mine, but although bunch of questions are very similar, I wasnt able to understand what I am doing wrong.</p>\n\n<p>I am very new to golang, and I am trying to implement game of life.</p>\n\n<p>here is part of my code</p>\n\n<pre><code>// Species struct\ntype Species struct {\n    xPos            int32\n    yPos            int32\n    isAlive         bool\n    willChangeState bool\n    rect            sdl.Rect\n    neighbours      []Species\n}\n\ntype Ecosystem struct {\n    community []Species\n}\n\nfunc (ecos *Ecosystem) addSpecies(sp Species) {\n    ecos.community = append(ecos.community, sp)\n}\n\nfunc (s *Species) addNeigbour(neigbour Species) {\n    s.neighbours = append(s.neighbours, neigbour)\n} \n</code></pre>\n\n<p>I want to distribute neighbours as in this function</p>\n\n<pre><code>func (ecos *Ecosystem) distributeNeighbours() {\n    for _, species := range ecos.community {\n        for _, potentionalNeighbour := range ecos.community {\n            if math.Abs(float64(species.xPos-potentionalNeighbour.xPos)) &lt;= speciesSize &amp;&amp; math.Abs(float64(species.yPos-potentionalNeighbour.yPos)) &lt;= speciesSize {\n                if species.xPos == potentionalNeighbour.xPos &amp;&amp; species.yPos == potentionalNeighbour.yPos {\n                    continue\n                }\n                species.addNeigbour(potentionalNeighbour)\n            }\n        }\n        fmt.Println(len(species.neighbours)) // works here\n    }\n    for _, s := range ecos.community {\n        fmt.Println(len(s.neighbours)) //prints 0\n    }\n}\n</code></pre>\n\n<p>So I guess I have to manage it with pointers - some issue like species in first loop is copy of that species in community, so original species does not gain any neigbours. But I dont know how to fix it.</p>\n"}, {"tags": ["go", "tcp", "connection", "client-server", "connection-timeout"], "comments": [{"owner": {"reputation": 536, "user_id": 3956589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39365ac79e46dc67ace5d93a627a068d?s=128&d=identicon&r=PG&f=1", "display_name": "whitespace", "link": "https://stackoverflow.com/users/3956589/whitespace"}, "edited": false, "score": 0, "creation_date": 1553590781, "post_id": 55352842, "comment_id": 97430184, "body": "your code for client, creates one connection to server and then without waiting for anything proceeds to make the next connection. Is this what you want from the code? if so, then high number of tcp connections could be a result of that."}, {"owner": {"reputation": 1370, "user_id": 7824245, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-0l2xVxKv9gc/AAAAAAAAAAI/AAAAAAAAABo/GSjROchHomI/photo.jpg?sz=128", "display_name": "Floating Sunfish", "link": "https://stackoverflow.com/users/7824245/floating-sunfish"}, "reply_to_user": {"reputation": 536, "user_id": 3956589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39365ac79e46dc67ace5d93a627a068d?s=128&d=identicon&r=PG&f=1", "display_name": "whitespace", "link": "https://stackoverflow.com/users/3956589/whitespace"}, "edited": false, "score": 0, "creation_date": 1553590911, "post_id": 55352842, "comment_id": 97430255, "body": "@whitespace Sorry for the confusion. I have updated the description above. The Client waits for a response from the server and prints it to the screen before closing the connection and trying again."}, {"owner": {"reputation": 2702, "user_id": 2923336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LmjCO.png?s=128&g=1", "display_name": "Francois", "link": "https://stackoverflow.com/users/2923336/francois"}, "edited": false, "score": 0, "creation_date": 1553591189, "post_id": 55352842, "comment_id": 97430397, "body": "Looking at your code on the client, the connection does not get closed. The defer executes when the function returns, not when an iteration of the foor loop ends. Also, you don&#39;t need to open new connections all the time. You can keep a single one."}, {"owner": {"reputation": 1370, "user_id": 7824245, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-0l2xVxKv9gc/AAAAAAAAAAI/AAAAAAAAABo/GSjROchHomI/photo.jpg?sz=128", "display_name": "Floating Sunfish", "link": "https://stackoverflow.com/users/7824245/floating-sunfish"}, "reply_to_user": {"reputation": 2702, "user_id": 2923336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LmjCO.png?s=128&g=1", "display_name": "Francois", "link": "https://stackoverflow.com/users/2923336/francois"}, "edited": false, "score": 0, "creation_date": 1553591553, "post_id": 55352842, "comment_id": 97430586, "body": "@Fran&#231;oisP. Yeah, I am in the process of fixing my bad <code>defer</code>. Also, what do you mean I can keep a single connection for my client? Shouldn&#39;t it be that Clients do a fire-and-forget sort of thing? (I&#39;m trying to simulate requests from the UI which end as soon as they get what they want)"}, {"owner": {"reputation": 2702, "user_id": 2923336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LmjCO.png?s=128&g=1", "display_name": "Francois", "link": "https://stackoverflow.com/users/2923336/francois"}, "edited": false, "score": 0, "creation_date": 1553591681, "post_id": 55352842, "comment_id": 97430653, "body": "Establishing a connection has an overhead. You could just keep a single connection open and build a protocol on top, to handle sort of request/response mechanism this is usually what you do."}, {"owner": {"reputation": 1370, "user_id": 7824245, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-0l2xVxKv9gc/AAAAAAAAAAI/AAAAAAAAABo/GSjROchHomI/photo.jpg?sz=128", "display_name": "Floating Sunfish", "link": "https://stackoverflow.com/users/7824245/floating-sunfish"}, "reply_to_user": {"reputation": 2702, "user_id": 2923336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LmjCO.png?s=128&g=1", "display_name": "Francois", "link": "https://stackoverflow.com/users/2923336/francois"}, "edited": false, "score": 0, "creation_date": 1553591764, "post_id": 55352842, "comment_id": 97430694, "body": "@Fran&#231;oisP. Ah, so each client should only have 1 connection, which will get closed anyway once the clients themselves are closed? Has that always been the norm?"}, {"owner": {"reputation": 2702, "user_id": 2923336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LmjCO.png?s=128&g=1", "display_name": "Francois", "link": "https://stackoverflow.com/users/2923336/francois"}, "edited": false, "score": 0, "creation_date": 1553591824, "post_id": 55352842, "comment_id": 97430729, "body": "One, or a pool of connections if you have high load. But opening and closing connections all the time is not efficient."}, {"owner": {"reputation": 1370, "user_id": 7824245, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-0l2xVxKv9gc/AAAAAAAAAAI/AAAAAAAAABo/GSjROchHomI/photo.jpg?sz=128", "display_name": "Floating Sunfish", "link": "https://stackoverflow.com/users/7824245/floating-sunfish"}, "reply_to_user": {"reputation": 2702, "user_id": 2923336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LmjCO.png?s=128&g=1", "display_name": "Francois", "link": "https://stackoverflow.com/users/2923336/francois"}, "edited": false, "score": 0, "creation_date": 1553591959, "post_id": 55352842, "comment_id": 97430797, "body": "@Fran&#231;oisP. I see, I&#39;ll look into that. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 1370, "user_id": 7824245, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-0l2xVxKv9gc/AAAAAAAAAAI/AAAAAAAAABo/GSjROchHomI/photo.jpg?sz=128", "display_name": "Floating Sunfish", "link": "https://stackoverflow.com/users/7824245/floating-sunfish"}, "edited": false, "score": 0, "creation_date": 1553592455, "post_id": 55353497, "comment_id": 97431084, "body": "Hi! I updated my description above. I like the idea of only having 1 connection, but my problem with this is that I am calling <code>serverConnection.CloseWrite()</code> to signal to the server that I am now done sending my message. The problem is that I can&#39;t seem to reuse a connection once <code>CloseWrite()</code> has been called on it. Any advice on this situation?"}, {"owner": {"reputation": 2702, "user_id": 2923336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LmjCO.png?s=128&g=1", "display_name": "Francois", "link": "https://stackoverflow.com/users/2923336/francois"}, "reply_to_user": {"reputation": 1370, "user_id": 7824245, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-0l2xVxKv9gc/AAAAAAAAAAI/AAAAAAAAABo/GSjROchHomI/photo.jpg?sz=128", "display_name": "Floating Sunfish", "link": "https://stackoverflow.com/users/7824245/floating-sunfish"}, "edited": false, "score": 0, "creation_date": 1553592672, "post_id": 55353497, "comment_id": 97431229, "body": "Just use <code>Write</code>, <code>CloseWrite</code> shuts down the writing side of the Unix domain connection. You cannot write anymore after <code>CloseWrite</code>."}, {"owner": {"reputation": 536, "user_id": 3956589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39365ac79e46dc67ace5d93a627a068d?s=128&d=identicon&r=PG&f=1", "display_name": "whitespace", "link": "https://stackoverflow.com/users/3956589/whitespace"}, "edited": false, "score": 0, "creation_date": 1553592951, "post_id": 55353497, "comment_id": 97431386, "body": "<code>SetDeadline</code> could be done outside the loop, since there is only one <code>serverConnection</code> here."}, {"owner": {"reputation": 1370, "user_id": 7824245, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-0l2xVxKv9gc/AAAAAAAAAAI/AAAAAAAAABo/GSjROchHomI/photo.jpg?sz=128", "display_name": "Floating Sunfish", "link": "https://stackoverflow.com/users/7824245/floating-sunfish"}, "edited": false, "score": 0, "creation_date": 1553593038, "post_id": 55353497, "comment_id": 97431453, "body": "@Fran&#231;oisP. It seems I can&#39;t call only <code>Write</code> because the Server is using this to read Client messages: <code>clientMsgBytes, err := ioutil.ReadAll(connection)</code>. This seems to rely on <code>CloseWrite()</code> being called (it expects an <code>EOF</code> before stopping). Any advice on this? I can modify both the Client and Server codes."}, {"owner": {"reputation": 2702, "user_id": 2923336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LmjCO.png?s=128&g=1", "display_name": "Francois", "link": "https://stackoverflow.com/users/2923336/francois"}, "edited": false, "score": 0, "creation_date": 1553593333, "post_id": 55353497, "comment_id": 97431638, "body": "You can&#39;t change the server code? The best would be to use a bufio.Reader or bufio.Scanner on the server side, and just read till the next &#39;\\n&#39; for example. <a href=\"https://golang.org/pkg/bufio/#Scanner\" rel=\"nofollow noreferrer\">golang.org/pkg/bufio/#Scanner</a>  ioutil.ReadAll is a bad idea. In the end, HTTP might be even more performant than what you are doing, because HTTP does keep connections alive."}, {"owner": {"reputation": 1370, "user_id": 7824245, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-0l2xVxKv9gc/AAAAAAAAAAI/AAAAAAAAABo/GSjROchHomI/photo.jpg?sz=128", "display_name": "Floating Sunfish", "link": "https://stackoverflow.com/users/7824245/floating-sunfish"}, "edited": false, "score": 0, "creation_date": 1553593482, "post_id": 55353497, "comment_id": 97431733, "body": "@Fran&#231;oisP. I can modify both Client and Server code, so I can probably implement any solution. Also, the project direction is to use TCP instead of HTTP. That one detail is out of my control."}, {"owner": {"reputation": 2702, "user_id": 2923336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LmjCO.png?s=128&g=1", "display_name": "Francois", "link": "https://stackoverflow.com/users/2923336/francois"}, "edited": false, "score": 0, "creation_date": 1553597891, "post_id": 55353497, "comment_id": 97434593, "body": "I understand completely that you want to use TCP. I&#39;m just saying that if don&#39;t keep connections alive you will have something slower than a HTTP server that keeps connections alive :)"}], "tags": [], "owner": {"reputation": 2702, "user_id": 2923336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LmjCO.png?s=128&g=1", "display_name": "Francois", "link": "https://stackoverflow.com/users/2923336/francois"}, "is_accepted": true, "score": 1, "last_activity_date": 1553592401, "last_edit_date": 1553592401, "creation_date": 1553591915, "answer_id": 55353497, "question_id": 55352842, "link": "https://stackoverflow.com/questions/55352842/unusually-high-amount-of-tcp-connection-timeout-errors/55353497#55353497", "title": "Unusually High Amount of TCP Connection Timeout Errors", "body": "<p>It seems this piece of code does not act as you think it does. The defer statement on the connection close will only happen when the function returns, not when an iteration ends. So as far as I can see here, you are creating a lot of connections on the client side, it could be the problem. </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>serverAddress, err := net.ResolveTCPAddr(\"tcp\", kubernetes_ip+\":\"+kubernetes_port)\nif err != nil {     \n    fmt.Println(err)\n    return\n}\n\n// Never stop asking for commands from the user.\nfor {\n    // Connect to the server.\n    serverConnection, err := net.DialTCP(\"tcp\", nil, serverAddress)\n    if err != nil {         \n        fmt.Println(err)\n        continue\n    }\n\n    defer serverConnection.Close()\n\n    // Added to prevent connection timeout errors, but doesn't seem to be helping\n    // because said errors happen within just 1 or 2 minutes.\n    err = serverConnection.SetDeadline(time.Now().Add(10 * time.Minute))\n    if err != nil {         \n        fmt.Println(err)\n        continue\n    }\n\n    // Ask for a command from the user and send to the server...\n\n    // Wait for a response from the server and print...\n}\n</code></pre>\n\n<p>I suggest to write it this way: </p>\n\n<pre><code>func start() {\n    serverAddress, err := net.ResolveTCPAddr(\"tcp\", kubernetes_ip+\":\"+kubernetes_port)\n    if err != nil {     \n        fmt.Println(err)\n        return\n    }\n    for {\n        if err := listen(serverAddress); err != nil {\n            fmt.Println(err)\n        }\n    }\n}\n\nfunc listen(serverAddress string) error {\n     // Connect to the server.\n     serverConnection, err := net.DialTCP(\"tcp\", nil, serverAddress)\n     if err != nil {         \n         fmt.Println(err)\n         continue\n     }\n\n    defer serverConnection.Close()\n\n    // Never stop asking for commands from the user.\n    for {\n        // Added to prevent connection timeout errors, but doesn't seem to be helping\n        // because said errors happen within just 1 or 2 minutes.\n        err = serverConnection.SetDeadline(time.Now().Add(10 * time.Minute))\n        if err != nil {         \n           fmt.Println(err)\n           return err\n        }\n\n        // Ask for a command from the user and send to the server...\n\n        // Wait for a response from the server and print...\n    }\n}\n</code></pre>\n\n<p>Also, you should keep a single connection open, or a pool of connections, instead of opening and closing the connection right away. Then when you send a message you get a connection from the pool (or the single connection), and you write the message and wait for the response, then you release the connection to the pool. </p>\n\n<p>Something like that: </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>res, err := c.Send([]byte(`my message`))\nif err != nil {\n    // handle err\n}\n\n// the implementation of send\nfunc (c *Client) Send(msg []byte) ([]byte, error) {\n    conn, err := c.pool.Get() // returns a connection from the pool or starts a new one\n    if err != nil {\n        return nil, err\n    }\n    // send your message and wait for response\n    // ...\n    return response, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 1370, "user_id": 7824245, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-0l2xVxKv9gc/AAAAAAAAAAI/AAAAAAAAABo/GSjROchHomI/photo.jpg?sz=128", "display_name": "Floating Sunfish", "link": "https://stackoverflow.com/users/7824245/floating-sunfish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 0, "accepted_answer_id": 55353497, "answer_count": 1, "score": 0, "last_activity_date": 1553593444, "creation_date": 1553589419, "last_edit_date": 1553593444, "question_id": 55352842, "link": "https://stackoverflow.com/questions/55352842/unusually-high-amount-of-tcp-connection-timeout-errors", "title": "Unusually High Amount of TCP Connection Timeout Errors", "body": "<p>I am using a Go TCP Client to connect to our Go TCP Server.</p>\n\n<p>I am able to connect to the Server and run commands properly, but every so often there will be an unusually high amount of consecutive TCP connection errors reported by my TCP Client when trying to either connect to our TCP Server or sending a message once connected:</p>\n\n<pre><code>dial tcp kubernetes_node_ip:exposed_kubernetes_port:\nconnectex: A connection attempt failed because the connected party did not properly\nrespond after a period of time, or established connection failed because connected\nhost has failed to respond.\n\nread tcp unfamiliar_ip:unfamiliar_port-&gt;kubernetes_node_ip:exposed_kubernetes_port\nwsarecv: A connection attempt failed because the connected party did not properly\nrespond after a period of time, or established connection failed because connected\nhost has failed to respond.\n</code></pre>\n\n<p>I say \"unusually high\" because I assume that the number of times these errors occur should be very minimal (about 5 or less within the hour). Note that I am not dismissing the possibility of this being caused by connection instabilities, as I have also noticed that it is possible to run several commands in rapid succession without any errors.</p>\n\n<p>However, I am still going to post my code in case I am doing something wrong.</p>\n\n<p>Below is the code that my TCP Client uses to connect to our server:</p>\n\n<pre><code>serverAddress, err := net.ResolveTCPAddr(\"tcp\", kubernetes_ip+\":\"+kubernetes_port)\nif err != nil {     \n    fmt.Println(err)\n    return\n}\n\n// Never stop asking for commands from the user.\nfor {\n    // Connect to the server.\n    serverConnection, err := net.DialTCP(\"tcp\", nil, serverAddress)\n    if err != nil {         \n        fmt.Println(err)\n        continue\n    }\n\n    defer serverConnection.Close()\n\n    // Added to prevent connection timeout errors, but doesn't seem to be helping\n    // because said errors happen within just 1 or 2 minutes.\n    err = serverConnection.SetDeadline(time.Now().Add(10 * time.Minute))\n    if err != nil {         \n        fmt.Println(err)\n        continue\n    }\n\n    // Ask for a command from the user and convert to JSON bytes...\n\n    // Send message to server.\n    _, err = serverConnection.Write(clientMsgBytes)\n    if err != nil {\n        err = merry.Wrap(err)\n        fmt.Println(merry.Details(err))\n        continue\n    }\n\n    err = serverConnection.CloseWrite()\n    if err != nil {\n        err = merry.Wrap(err)\n        fmt.Println(merry.Details(err))\n        continue\n    }\n\n    // Wait for a response from the server and print...\n}\n</code></pre>\n\n<p>Below is the code that our TCP Server uses to accept client requests:</p>\n\n<pre><code>// We only supply the port so the IP can be dynamically assigned:\nserverAddress, err := net.ResolveTCPAddr(\"tcp\", \":\"+server_port)\nif err != nil {     \n    return err\n}\n\ntcpListener, err := net.ListenTCP(\"tcp\", serverAddress)\nif err != nil {     \n    return err\n}\n\ndefer tcpListener.Close()\n\n// Never stop listening for client requests.\nfor {\n    clientConnection, err := tcpListener.AcceptTCP()\n    if err != nil {         \n        fmt.Println(err)\n        continue\n    }\n\n    go func() {\n        // Add client connection to Job Queue.\n        // Note that `clientConnections` is a buffered channel with a size of 1500.\n        // Since I am the only user connecting to our server right now, I do not think\n        // this is a channel blocking issue.\n        clientConnections &lt;- clientConnection\n    }()\n}\n</code></pre>\n\n<p>Below is the code that our TCP Server uses to process client requests:</p>\n\n<pre><code>defer clientConnection.Close()\n\n// Added to prevent connection timeout errors, but doesn't seem to be helping\n// because said errors happen within just 1 or 2 minutes.\nerr := clientConnection.SetDeadline(time.Now().Add(10 * time.Minute))\nif err != nil {     \n    return err\n}\n\n// Read full TCP message.\n// Does not stop until an EOF is reported by `CloseWrite()`\nclientMsgBytes, err := ioutil.ReadAll(clientConnection)\nif err != nil {\n    err = merry.Wrap(err)\n    return nil, err\n}\n\n// Process the message bytes...\n</code></pre>\n\n<p>My questions are:</p>\n\n<ol>\n<li><p>Am I doing something wrong in the above code, or is the above decent enough for basic TCP Client-Server operations?</p></li>\n<li><p>Is it okay that both the TCP Client and TCP Server have code that defers closing their one connection?</p></li>\n<li><p>I seem to recall that calling <code>defer</code> inside a loop does nothing. How do I properly close Client connections before starting new ones?</p></li>\n</ol>\n\n<p>Some extra information:</p>\n\n<ul>\n<li>Said errors are not logged by the TCP Server, so aside from\nconnection instabilities, this might also be a\nKubernetes/Docker-related issue.</li>\n</ul>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 364, "user_id": 6173660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb2361f859a0ed3e7915135a5379426?s=128&d=identicon&r=PG&f=1", "display_name": "iam thadiyan", "link": "https://stackoverflow.com/users/6173660/iam-thadiyan"}, "edited": false, "score": 1, "creation_date": 1553675206, "post_id": 55353239, "comment_id": 97467628, "body": "Thank you for your reply. I think I am missing something. When I execute the above from <code>$GOPATH&#47;src&#47;</code>, I am getting the following error: <code>can&#39;t load package: package myApp&#47;vendor&#47;github.com&#47;DATA-DOG&#47;cmd&#47;godog: cannot find package &quot;myApp&#47;vendor&#47;github.com&#47;DATA-DOG&#47;cmd&#47;godog&quot; in any of:         &#47;home&#47;ubuntu&#47;go&#47;src&#47;myApp&#47;vendor&#47;github.com&#47;DATA-DOG&#47;cmd&#47;god&zwnj;&#8203;og (from $GOROOT)         &#47;home&#47;ubuntu&#47;.go&#47;src&#47;myApp&#47;vendor&#47;github.com&#47;DATA-DOG&#47;cmd&#47;go&zwnj;&#8203;dog (from $GOPATH)</code>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 364, "user_id": 6173660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb2361f859a0ed3e7915135a5379426?s=128&d=identicon&r=PG&f=1", "display_name": "iam thadiyan", "link": "https://stackoverflow.com/users/6173660/iam-thadiyan"}, "edited": false, "score": 0, "creation_date": 1553675381, "post_id": 55353239, "comment_id": 97467713, "body": "Use the package name you want to install. If path is not <code>myApp</code>, obviously use what you have."}, {"owner": {"reputation": 364, "user_id": 6173660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb2361f859a0ed3e7915135a5379426?s=128&d=identicon&r=PG&f=1", "display_name": "iam thadiyan", "link": "https://stackoverflow.com/users/6173660/iam-thadiyan"}, "edited": false, "score": 0, "creation_date": 1553675768, "post_id": 55353239, "comment_id": 97467889, "body": "When I used <code>go install myApp&#47;vendor&#47;github.com&#47;DATA-DOG&#47;godog</code>, it created <code>godog.a</code> inside <code>$GOPATH&#47;pkg&#47;</code> not the executable. I am very sorry to sound this stupid. Can you please spell it out for me what I am missing?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 364, "user_id": 6173660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb2361f859a0ed3e7915135a5379426?s=128&d=identicon&r=PG&f=1", "display_name": "iam thadiyan", "link": "https://stackoverflow.com/users/6173660/iam-thadiyan"}, "edited": false, "score": 0, "creation_date": 1553675983, "post_id": 55353239, "comment_id": 97467985, "body": "You have to provide a <code>main</code> package, non-main packages are not installed into executables. I edited my answer as I left out a folder from the path, it should be: <code>myApp&#47;vendor&#47;github.com&#47;DATA-DOG&#47;godog&#47;cmd&#47;godog</code>"}, {"owner": {"reputation": 364, "user_id": 6173660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb2361f859a0ed3e7915135a5379426?s=128&d=identicon&r=PG&f=1", "display_name": "iam thadiyan", "link": "https://stackoverflow.com/users/6173660/iam-thadiyan"}, "edited": false, "score": 0, "creation_date": 1554272807, "post_id": 55353239, "comment_id": 97684809, "body": "I am still facing the issue as I mentioned earlier. One thing to note is, as I mentioned, since <code>go get</code> is able to create a binary but <code>go install</code> is not."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 364, "user_id": 6173660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb2361f859a0ed3e7915135a5379426?s=128&d=identicon&r=PG&f=1", "display_name": "iam thadiyan", "link": "https://stackoverflow.com/users/6173660/iam-thadiyan"}, "edited": false, "score": 1, "creation_date": 1554274457, "post_id": 55353239, "comment_id": 97685540, "body": "Please check where the <code>main</code> package is in your vendored <code>DATA-DOG</code> folder, and tell me."}, {"owner": {"reputation": 364, "user_id": 6173660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb2361f859a0ed3e7915135a5379426?s=128&d=identicon&r=PG&f=1", "display_name": "iam thadiyan", "link": "https://stackoverflow.com/users/6173660/iam-thadiyan"}, "edited": false, "score": 0, "creation_date": 1554303980, "post_id": 55353239, "comment_id": 97703802, "body": "Thank you for asking that question! I finally figured out what was causing the issue. The culprit is <code>dep</code>. Here is what I found. I used <code>dep</code> to vendor dependencies. When it did <code>godog</code>, it didn&#39;t download the file <code>main.go</code> inside <code>cmd&#47;godog</code> from github. I have no idea why it did that. When I manually copied the file in to <code>vendor</code> folder, it installed the executable! I am accepting your answer. But do you know why this is so?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 364, "user_id": 6173660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb2361f859a0ed3e7915135a5379426?s=128&d=identicon&r=PG&f=1", "display_name": "iam thadiyan", "link": "https://stackoverflow.com/users/6173660/iam-thadiyan"}, "edited": false, "score": 1, "creation_date": 1554304070, "post_id": 55353239, "comment_id": 97703858, "body": "@iamthadiyan I would guess because none of your packges refer to this <code>cmd&#47;godog</code> folder / package, so <code>dep</code> decided it is not needed."}, {"owner": {"reputation": 364, "user_id": 6173660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb2361f859a0ed3e7915135a5379426?s=128&d=identicon&r=PG&f=1", "display_name": "iam thadiyan", "link": "https://stackoverflow.com/users/6173660/iam-thadiyan"}, "edited": false, "score": 0, "creation_date": 1554304394, "post_id": 55353239, "comment_id": 97704057, "body": "oh I see! Let me see if anything can be done about that."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1553675958, "last_edit_date": 1553675958, "creation_date": 1553590955, "answer_id": 55353239, "question_id": 55352664, "link": "https://stackoverflow.com/questions/55352664/go-install-not-creating-binary-of-a-package-while-go-get-is-able-to/55353239#55353239", "title": "go install not creating binary of a package while go get is able to", "body": "<p><code>go install</code> does not automatically install apps in <code>vendor</code> folders, but you may specify a vendored path explicitly if you wish so. So simply run:</p>\n\n<pre><code>go install myApp/vendor/github.com/DATA-DOG/godog/cmd/godog\n</code></pre>\n"}], "owner": {"reputation": 364, "user_id": 6173660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb2361f859a0ed3e7915135a5379426?s=128&d=identicon&r=PG&f=1", "display_name": "iam thadiyan", "link": "https://stackoverflow.com/users/6173660/iam-thadiyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1149, "favorite_count": 0, "accepted_answer_id": 55353239, "answer_count": 1, "score": 3, "last_activity_date": 1553675958, "creation_date": 1553588632, "question_id": 55352664, "link": "https://stackoverflow.com/questions/55352664/go-install-not-creating-binary-of-a-package-while-go-get-is-able-to", "title": "go install not creating binary of a package while go get is able to", "body": "<p>I am on go version go1.11.2 linux/amd64. When the package <a href=\"https://github.com/DATA-DOG/godog/\" rel=\"nofollow noreferrer\">godog</a> is installed using <code>go get github.com/DATA-DOG/godog/</code>, <code>godog</code> executable is created inside $GOPATH/bin/. All fine till now.</p>\n\n<p>I am creating an application <code>myApp</code> that resides at $GOPATH/src/ in which under the folder vendor, godog package is added. When I try to create a binary out of vendor-ed package, an archive file is created inside <code>$GOPATH/pkg/linux_amd64/myApp/vendor/github.com/DATA-DOG/</code> as <code>godog.a</code></p>\n\n<p>How can I create a binary in this scenario? I do not want to do <code>go get</code> again just for the binary.</p>\n"}, {"tags": ["mongodb", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1553589618, "post_id": 55352362, "comment_id": 97429645, "body": "<code>filter := bson.M{{&quot;_id&quot;: &quot;abcd&quot;}}</code> doesn&#39;t compile, so I don&#39;t know what you&#39;re asking. Maybe you mean <code>filter := []bson.M{{&quot;_id&quot;: &quot;abcd&quot;}}</code>? That&#39;s a slice, a slice of &quot;filters&quot;, most often used when specifying stages of a MongoDB aggregation."}, {"owner": {"reputation": 1374, "user_id": 10849350, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8t7Pj.png?s=128&g=1", "display_name": "simagix", "link": "https://stackoverflow.com/users/10849350/simagix"}, "edited": false, "score": 0, "creation_date": 1553643175, "post_id": 55352362, "comment_id": 97458908, "body": "@RiefSapthana. I think you meant <code>filter := bson.D{{&quot;_id&quot;: &quot;abcd&quot;}}</code>.  Use <code>bson.D{{}}</code> when order matters, for example, multiple fields in the query filter.  Either one <code>bson.D</code> or <code>bson.M</code> as filters, mongo engine is intelligent enough to give you the same result."}, {"owner": {"reputation": 731, "user_id": 5865411, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/z2dJz.png?s=128&g=1", "display_name": "dev-x", "link": "https://stackoverflow.com/users/5865411/dev-x"}, "reply_to_user": {"reputation": 1374, "user_id": 10849350, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8t7Pj.png?s=128&g=1", "display_name": "simagix", "link": "https://stackoverflow.com/users/10849350/simagix"}, "edited": false, "score": 0, "creation_date": 1553661673, "post_id": 55352362, "comment_id": 97462641, "body": "Thank you @simagix @icza, what is the double braces <code>bson.D{{}}</code> mean? Does <code>bson.M</code> have <code>bson.M{{}}</code> form?"}, {"owner": {"reputation": 731, "user_id": 5865411, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/z2dJz.png?s=128&g=1", "display_name": "dev-x", "link": "https://stackoverflow.com/users/5865411/dev-x"}, "edited": false, "score": 0, "creation_date": 1553662076, "post_id": 55352362, "comment_id": 97462738, "body": "I got example like this <code>filter := bson.M{&quot;_id&quot;: id}</code> and this <code>filter := bson.D{{&quot;name&quot;, &quot;Ash&quot;}}</code> so why <code>bson.D</code> use double braces <code>{{}}</code>? What does it mean?"}], "answers": [{"tags": [], "owner": {"reputation": 1374, "user_id": 10849350, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8t7Pj.png?s=128&g=1", "display_name": "simagix", "link": "https://stackoverflow.com/users/10849350/simagix"}, "is_accepted": true, "score": 6, "last_activity_date": 1553693851, "creation_date": 1553693851, "answer_id": 55378594, "question_id": 55352362, "link": "https://stackoverflow.com/questions/55352362/filter-in-golang-mongodb/55378594#55378594", "title": "Filter in golang mongodb", "body": "<p>Refer to the source code, <a href=\"https://github.com/mongodb/mongo-go-driver/blob/master/bson/primitive/primitive.go\" rel=\"noreferrer\">https://github.com/mongodb/mongo-go-driver/blob/master/bson/primitive/primitive.go</a></p>\n\n<p><code>bson.D</code>, internally is <code>primitive.D</code>, which is <code>[]primitive.E</code>, which is a <code>struct</code>.  <code>bson.M</code>, internally is <code>primitive.M</code>, which is <code>map[string]interface{}</code>.  You put in key/value in <code>bson.M</code> but use document (struct) in <code>bson.D</code>.</p>\n\n<p>It is better to explain it using 2 parameters, e.g. search for <code>a = 1 and b = 2</code>.  You syntax will be: <code>bson.M{\"a\": 1, \"b\": 2}</code> or <code>bson.D{{\"a\": 1}, {\"b\": 2}}</code></p>\n"}, {"tags": [], "owner": {"reputation": 77, "user_id": 11373635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ece282de80af0de21c62cd81752535b?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin007", "link": "https://stackoverflow.com/users/11373635/kevin007"}, "is_accepted": false, "score": 2, "last_activity_date": 1581319261, "creation_date": 1581319261, "answer_id": 60145735, "question_id": 55352362, "link": "https://stackoverflow.com/questions/55352362/filter-in-golang-mongodb/60145735#60145735", "title": "Filter in golang mongodb", "body": "<pre><code>//Filter Part\nif filter != nil {\n    if len(filter.Status) &gt; 0 {\n        query = append(query, bson.M{\"status\": bson.M{\"$in\": filter.Status}})\n\n    }\n}\nd.Shared.BsonToJSONPrint(query)\n//Getting Total count\ntotalCount, err := col.Find(func() bson.M {\n    if query != nil {\n        if len(query) &gt; 0 {\n            return bson.M{\"$and\": query}\n        }\n    }\n    return bson.M{}\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 77, "user_id": 11373635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ece282de80af0de21c62cd81752535b?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin007", "link": "https://stackoverflow.com/users/11373635/kevin007"}, "is_accepted": false, "score": 2, "last_activity_date": 1583826425, "creation_date": 1583826425, "answer_id": 60613350, "question_id": 55352362, "link": "https://stackoverflow.com/questions/55352362/filter-in-golang-mongodb/60613350#60613350", "title": "Filter in golang mongodb", "body": "<pre><code>\n    var user []models.User\n\n    var findQuery []bson.M\n\n    coll := db.C(constants.USERTABLE)\n\n    if name != nil {\n        if len(name) &gt; 0 {\n            query = append(query, bson.M{\"name\": bson.M{\"$in\": name}})\n\n        }\n    }\n\n    if status != nil {\n        if len(status) &gt; 0 {\n            query = append(query, bson.M{\"status\": bson.M{\"$in\": status}})\n\n        }\n    }\n\n    findQuery = append(findQuery, bson.M{\"$match\": func() bson.M {\n        if query != nil {\n            if len(query) &gt; 0 {\n                return bson.M{\"$and\": query}\n            }\n        }\n        return bson.M{}\n    }()})\n\n    shared.BsonToJSONPrint(query)\n\n    err = coll.Pipe(findQuery).All(&amp;user)\n    if err != nil {\n        return nil, err\n    }\n    return user, nil\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 9090970, "user_type": "registered", "profile_image": "https://graph.facebook.com/1539408826140458/picture?type=large", "display_name": "Morse", "link": "https://stackoverflow.com/users/9090970/morse"}, "is_accepted": false, "score": 1, "last_activity_date": 1588945370, "creation_date": 1588945370, "answer_id": 61680548, "question_id": 55352362, "link": "https://stackoverflow.com/questions/55352362/filter-in-golang-mongodb/61680548#61680548", "title": "Filter in golang mongodb", "body": "<p>The client decodes the result to a <code>bson.D</code> document by default, this is represented as an array, which is not the document shape we want.</p>\n\n<p>To overwrite this behaviour you have to decode to a <code>bson.M</code>, which is a simple <code>map</code> and has the same shape of the document in database</p>\n\n<pre><code>res := collection.FindOne(ctx, p.Where)\n\nif res.Err() == mongo.ErrNoDocuments {\n    return nil, nil\n}\nif res.Err() != nil {\n        return nil, res.Err()\n}\nvar document bson.M = make(bson.M) // important\nerr = res.Decode(document)\n</code></pre>\n"}], "owner": {"reputation": 731, "user_id": 5865411, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/z2dJz.png?s=128&g=1", "display_name": "dev-x", "link": "https://stackoverflow.com/users/5865411/dev-x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10172, "favorite_count": 1, "accepted_answer_id": 55378594, "answer_count": 4, "score": 3, "last_activity_date": 1588945370, "creation_date": 1553587456, "question_id": 55352362, "link": "https://stackoverflow.com/questions/55352362/filter-in-golang-mongodb", "title": "Filter in golang mongodb", "body": "<p>Currently I learn to create restful api with golang and mongodb. Actually I am beginner in both. I use <a href=\"https://godoc.org/go.mongodb.org/mongo-driver\" rel=\"nofollow noreferrer\">mongodb-go-driver</a> and I learn to use filter when we want to use <code>find()</code> function. But I have some that I don't understand. What is the different between <code>filter := bson.M{\"_id\": \"abcd\"}</code> and <code>filter := bson.M{{\"_id\": \"abcd\"}}</code>? Thank you</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1059, "user_id": 1982418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbe9fddd5823aa8ae6a41ec889f0f581?s=128&d=identicon&r=PG&f=1", "display_name": "sh.seo", "link": "https://stackoverflow.com/users/1982418/sh-seo"}, "is_accepted": false, "score": 1, "last_activity_date": 1553584598, "creation_date": 1553584598, "answer_id": 55351639, "question_id": 55351497, "link": "https://stackoverflow.com/questions/55351497/how-do-i-convert-nested-json-into-go-code/55351639#55351639", "title": "How do I convert nested JSON into Go code?", "body": "<p>example is ..</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n)\n\nvar addr = flag.String(\"addr\", \"www.deribit.com\", \"http service address\")\n\ntype Arguments struct {\n    Instrument []string `json:\"instrument\"`\n    Event      []string `json:\"event\"`\n}\n\ntype AutoGenerated struct {\n    ID       int       `json:\"id\"`\n    Action   string    `json:\"action\"`\n    Argument Arguments `json:\"arguments\"`\n}\n\nfunc main() {\n\n    json := &amp;AutoGenerated{\n        ID:     42,\n        Action: \"/api/v1/public/getorderbook\",\n        Argument: Arguments{\n            Instrument: []string{\"BTC-19DEC14\"},\n            Event:      []string{\"order_book\", \"trade\", \"user_order\"},\n        },\n    }\n\n    fmt.Println(json)\n}\n</code></pre>\n"}], "owner": {"reputation": 655, "user_id": 7876925, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/fdac30f58f392c89bf381896b097d0b9?s=128&d=identicon&r=PG&f=1", "display_name": "Mary", "link": "https://stackoverflow.com/users/7876925/mary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "closed_date": 1553589453, "answer_count": 1, "score": -1, "last_activity_date": 1553591390, "creation_date": 1553583958, "last_edit_date": 1553591390, "question_id": 55351497, "link": "https://stackoverflow.com/questions/55351497/how-do-i-convert-nested-json-into-go-code", "closed_reason": "Duplicate", "title": "How do I convert nested JSON into Go code?", "body": "<p>I have used:</p>\n\n<p><a href=\"https://mholt.github.io/json-to-go/\" rel=\"nofollow noreferrer\">https://mholt.github.io/json-to-go/</a></p>\n\n<p>to convert</p>\n\n<pre><code>{\n    \"id\": 5533,\n    \"action\": \"/api/v1/private/subscribe\",  \n    \"arguments\": {\n        \"instrument\": [\"BTC-19DEC14\"],\n       \"event\": [\"order_book\", \"trade\", \"user_order\"]\n    }\n}\n</code></pre>\n\n<p>into</p>\n\n<pre><code>type AutoGenerated struct {\n    ID        int    `json:\"id\"`\n    Action    string `json:\"action\"`\n    Arguments struct {\n        Instrument []string `json:\"instrument\"`\n        Event      []string `json:\"event\"`\n    } `json:\"arguments\"`\n}\n</code></pre>\n\n<p>I have then tried to use this in Go code as follows:</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"os\"\n)\n\nvar addr = flag.String(\"addr\", \"www.deribit.com\", \"http service address\")\n\nfunc main() {\n\n    type AutoGenerated struct {\n        ID        int    `json:\"id\"`\n        Action    string `json:\"action\"`\n        Arguments struct {\n            Instrument []string `json:\"instrument\"`\n            Event      []string `json:\"event\"`\n        } `json:\"arguments\"`\n    }\n\n    json := &amp;AutoGenerated{\n        ID:     42,\n        Action: \"/api/v1/public/getorderbook\",\n        Arguments: struct {\n            Instrument: [\"BTC-19DEC14\"],\n            Event:       [\"order_book\", \"trade\", \"user_order\"],\n        },\n    }\n\n}\n</code></pre>\n\n<p>I'm getting an error with <code>Arguments</code> ie my struct within a struct.</p>\n\n<p>How do I convert my JSON to a variable that I can use within go?</p>\n"}, {"tags": ["go", "testing", "bazel"], "answers": [{"tags": [], "owner": {"reputation": 1304, "user_id": 20330, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4120b1b63ddb87d5e4cf631144c149e0?s=128&d=identicon&r=PG", "display_name": "Rodrigo Queiro", "link": "https://stackoverflow.com/users/20330/rodrigo-queiro"}, "is_accepted": true, "score": 1, "last_activity_date": 1553587580, "creation_date": 1553587580, "answer_id": 55352387, "question_id": 55350788, "link": "https://stackoverflow.com/questions/55350788/different-file-permission-error-in-go-test-and-bazel-test/55352387#55352387", "title": "Different file permission error in &quot;go test&quot; and &quot;bazel test&quot;", "body": "<p>You can disable the sandbox by using <code>bazel --spawn_strategy=standalone test //...</code>. I suspect this will work around the problem.</p>\n\n<p>However, you may want to consider whether writing to <code>/</code> is the behavior that you want to test. If you need to run code on a different operating system or inside a Docker container, you'll get different behavior in this case, so you could think about testing a more predictable code path, or mocking out the file access layer to isolate your tests from it.</p>\n"}], "owner": {"reputation": 1620, "user_id": 1305362, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/Wo49Y.jpg?s=128&g=1", "display_name": "Zebra Propulsion Lab", "link": "https://stackoverflow.com/users/1305362/zebra-propulsion-lab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 55352387, "answer_count": 1, "score": -1, "last_activity_date": 1553587580, "creation_date": 1553580502, "question_id": 55350788, "link": "https://stackoverflow.com/questions/55350788/different-file-permission-error-in-go-test-and-bazel-test", "title": "Different file permission error in &quot;go test&quot; and &quot;bazel test&quot;", "body": "<p>If a test wants to assert the file permission error, for example, writing to the root of file system, \"go test\" returns an <code>syscall.EACCES</code> error, while \"bazel test\" returns an <code>syscall.EPERM</code>. How to make the test passes in both \"bazel test\" and \"go test\"?</p>\n\n<p>An example can be found <a href=\"https://github.com/linzhp/bazel_examples/tree/master/permission\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2702, "user_id": 2923336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LmjCO.png?s=128&g=1", "display_name": "Francois", "link": "https://stackoverflow.com/users/2923336/francois"}, "edited": false, "score": 6, "creation_date": 1553579743, "post_id": 55350556, "comment_id": 97425262, "body": "You cannot import a main package. A goapp can only have a single main package. What are you trying to achieve?"}, {"owner": {"reputation": 51, "user_id": 7584660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e091105ff3374357463c48aa65380f5?s=128&d=identicon&r=PG&f=1", "display_name": "oguz zeyveli", "link": "https://stackoverflow.com/users/7584660/oguz-zeyveli"}, "reply_to_user": {"reputation": 2702, "user_id": 2923336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LmjCO.png?s=128&g=1", "display_name": "Francois", "link": "https://stackoverflow.com/users/2923336/francois"}, "edited": false, "score": 0, "creation_date": 1553580423, "post_id": 55350556, "comment_id": 97425485, "body": "I am sorry my mistake. edited"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 7584660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e091105ff3374357463c48aa65380f5?s=128&d=identicon&r=PG&f=1", "display_name": "oguz zeyveli", "link": "https://stackoverflow.com/users/7584660/oguz-zeyveli"}, "edited": false, "score": 0, "creation_date": 1554291822, "post_id": 55350912, "comment_id": 97695730, "body": "Thank you that is worked"}], "tags": [], "owner": {"reputation": 627, "user_id": 2931316, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tOHqU.jpg?s=128&g=1", "display_name": "M Ashraful A", "link": "https://stackoverflow.com/users/2931316/m-ashraful-a"}, "is_accepted": false, "score": 2, "last_activity_date": 1553581231, "creation_date": 1553581231, "answer_id": 55350912, "question_id": 55350556, "link": "https://stackoverflow.com/questions/55350556/how-to-import-main-folder-from-another-folder/55350912#55350912", "title": "How to import main folder from another folder", "body": "<p>If you want to share vars across packages then create a separate package where you declare exported variables by the first character in caps.</p>\n\n<p>app/mypack/vars.go</p>\n\n<pre><code>package mypack\n\nvar MyVar string\n</code></pre>\n\n<p>then import in main and other packages like\n    package main</p>\n\n<pre><code>import (\n    \"fmt\"\n    mypack \"app/mypack\" \n)\n\nfunc main(){\n    mypack.MyVar = \"Hello, playground\"\n}\n</code></pre>\n\n<p>same way import in app/folder/call.go and use</p>\n"}, {"tags": [], "owner": {"reputation": 1587, "user_id": 8399980, "user_type": "registered", "profile_image": "https://graph.facebook.com/1494042510683240/picture?type=large", "display_name": "Andrey Berenda", "link": "https://stackoverflow.com/users/8399980/andrey-berenda"}, "is_accepted": false, "score": 2, "last_activity_date": 1553591816, "creation_date": 1553591816, "answer_id": 55353464, "question_id": 55350556, "link": "https://stackoverflow.com/questions/55350556/how-to-import-main-folder-from-another-folder/55353464#55353464", "title": "How to import main folder from another folder", "body": "<p>Main means that this package uses everything in your project(if not just remove it from your project and everything will be ok). And so you cannot import main because of cycle import. So you should create separate package and use it in main and in other packages if you want.</p>\n"}], "owner": {"reputation": 51, "user_id": 7584660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e091105ff3374357463c48aa65380f5?s=128&d=identicon&r=PG&f=1", "display_name": "oguz zeyveli", "link": "https://stackoverflow.com/users/7584660/oguz-zeyveli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "closed_date": 1553610670, "answer_count": 2, "score": -4, "last_activity_date": 1553592468, "creation_date": 1553579177, "last_edit_date": 1553592468, "question_id": 55350556, "link": "https://stackoverflow.com/questions/55350556/how-to-import-main-folder-from-another-folder", "closed_reason": "Duplicate", "title": "How to import main folder from another folder", "body": "<p>app/main.go</p>\n\n<pre><code>package main\n\nimport (\n   \"fmt\"\n)\nvar varInMain string\n\nfunc exm() {\n    varInMain = \"Hello, playground\"\n\n    fmt.Println(varInMain)\n}\n</code></pre>\n\n<p>app/folder/call.go</p>\n\n<pre><code>package folder\n\nimport (\n    \"fmt\"\n    Main \"../\" -&gt; ERR// or \"app\" -&gt; ERR\n)\n\nfunc main() {\n\n    fmt.Println(Main.varInMain)\n}\n</code></pre>\n\n<p>I can not call main.go variable or func. from folder/call.go.\nHow can i do it? //And thats must be local package</p>\n"}, {"tags": ["go", "etcd"], "answers": [{"tags": [], "owner": {"reputation": 2702, "user_id": 2923336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LmjCO.png?s=128&g=1", "display_name": "Francois", "link": "https://stackoverflow.com/users/2923336/francois"}, "is_accepted": true, "score": 1, "last_activity_date": 1553612169, "creation_date": 1553612169, "answer_id": 55360179, "question_id": 55350494, "link": "https://stackoverflow.com/questions/55350494/api-to-find-a-key-in-a-etcd-cluster/55360179#55360179", "title": "API to find a key in a etcd cluster", "body": "<p>If you use the go client v3 KV client here: <a href=\"https://godoc.org/go.etcd.io/etcd/clientv3#KV\" rel=\"nofollow noreferrer\">https://godoc.org/go.etcd.io/etcd/clientv3#KV</a></p>\n\n<p>It returns the following type:\n<a href=\"https://godoc.org/go.etcd.io/etcd/etcdserver/etcdserverpb#RangeResponse\" rel=\"nofollow noreferrer\">https://godoc.org/go.etcd.io/etcd/etcdserver/etcdserverpb#RangeResponse</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type RangeResponse struct {\n    Header *ResponseHeader `protobuf:\"bytes,1,opt,name=header\" json:\"header,omitempty\"`\n    // kvs is the list of key-value pairs matched by the range request.\n    // kvs is empty when count is requested.\n    Kvs []*mvccpb.KeyValue `protobuf:\"bytes,2,rep,name=kvs\" json:\"kvs,omitempty\"`\n    // more indicates if there are more keys to return in the requested range.\n    More bool `protobuf:\"varint,3,opt,name=more,proto3\" json:\"more,omitempty\"`\n    // count is set to the number of keys within the range when requested.\n    Count int64 `protobuf:\"varint,4,opt,name=count,proto3\" json:\"count,omitempty\"`\n}\n</code></pre>\n\n<p>So as you see, there is a <code>Count</code> property and a <code>Kvs</code> property, if you want to check that your response contains keys you can just check that <code>Count &gt; 0</code> or <code>len(res.Kvs) &gt; 0</code></p>\n"}], "owner": {"reputation": 2203, "user_id": 773079, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f494bf18ea8fc96190a398ecee6deedc?s=128&d=identicon&r=PG", "display_name": "Pensu", "link": "https://stackoverflow.com/users/773079/pensu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 437, "favorite_count": 0, "accepted_answer_id": 55360179, "answer_count": 1, "score": 0, "last_activity_date": 1553612218, "creation_date": 1553578754, "last_edit_date": 1553612218, "question_id": 55350494, "link": "https://stackoverflow.com/questions/55350494/api-to-find-a-key-in-a-etcd-cluster", "title": "API to find a key in a etcd cluster", "body": "<p>I am trying to write a code where I need to find if a key exists in etcd or not. I tried this:</p>\n\n<pre><code>_, err = kapi.Get(context.Background(), key, nil)\n        if err != nil {\n          return err      \n        } else { ...\n\n</code></pre>\n\n<p>But even if the key is not in the cluster, the error is always <code>nil</code>. </p>\n\n<p>Any idea what am I doing wrong here? Or is there any other API call to make?</p>\n"}, {"tags": ["image", "file", "go", "io"], "comments": [{"owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "edited": false, "score": 0, "creation_date": 1553578925, "post_id": 55350451, "comment_id": 97425018, "body": "What is your OS?"}, {"owner": {"reputation": 69, "user_id": 6397491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aa5d80896dfcf9e7e98de6ae9c14571?s=128&d=identicon&r=PG&f=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/6397491/ash"}, "reply_to_user": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "edited": false, "score": 0, "creation_date": 1553579515, "post_id": 55350451, "comment_id": 97425189, "body": "@A.R I&#39;m on Ubuntu"}, {"owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "edited": false, "score": 0, "creation_date": 1553579538, "post_id": 55350451, "comment_id": 97425198, "body": "Try my code and let me know if it works for you too"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 6397491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aa5d80896dfcf9e7e98de6ae9c14571?s=128&d=identicon&r=PG&f=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/6397491/ash"}, "edited": false, "score": 0, "creation_date": 1553580090, "post_id": 55350540, "comment_id": 97425368, "body": "This works, I get the following output: f0VMRgIBAQ f0VMRgIBAQ f0VMRgIBAQ f0VMRgIBAQ f0VMRgIBAQ f0VMRgIBAQ f0VMRgIBAQ f0VMRgIBAQ f0VMRgIBAQ f0VMRgIBAQ  real\t0m0.320s user\t0m0.369s sys\t0m0.074s"}, {"owner": {"reputation": 69, "user_id": 6397491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aa5d80896dfcf9e7e98de6ae9c14571?s=128&d=identicon&r=PG&f=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/6397491/ash"}, "edited": false, "score": 0, "creation_date": 1553580163, "post_id": 55350540, "comment_id": 97425393, "body": "It&#39;s hard to format but the output is the exact same as yours, except the times are different"}, {"owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "reply_to_user": {"reputation": 69, "user_id": 6397491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aa5d80896dfcf9e7e98de6ae9c14571?s=128&d=identicon&r=PG&f=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/6397491/ash"}, "edited": false, "score": 1, "creation_date": 1553580584, "post_id": 55350540, "comment_id": 97425541, "body": "&#39;ioutil.ReadFile&#39; uses <code>f, err := os.Open(filename)</code> then <code>f.Stat()</code> my recommendation for now is to read binary file byte by byte by yourself to find out the source of delay in reading file : use <a href=\"https://stackoverflow.com/a/14571779/8208215\">this</a>"}, {"owner": {"reputation": 69, "user_id": 6397491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aa5d80896dfcf9e7e98de6ae9c14571?s=128&d=identicon&r=PG&f=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/6397491/ash"}, "edited": false, "score": 0, "creation_date": 1553581531, "post_id": 55350540, "comment_id": 97425826, "body": "Okay I&#39;ll try it out"}, {"owner": {"reputation": 69, "user_id": 6397491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aa5d80896dfcf9e7e98de6ae9c14571?s=128&d=identicon&r=PG&f=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/6397491/ash"}, "edited": false, "score": 0, "creation_date": 1553831796, "post_id": 55350540, "comment_id": 97540594, "body": "I was able to fix the problem I was having (see my answer), looks like the issue is related to running the function above at regular intervals inside of a single goroutine"}, {"owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "reply_to_user": {"reputation": 69, "user_id": 6397491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aa5d80896dfcf9e7e98de6ae9c14571?s=128&d=identicon&r=PG&f=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/6397491/ash"}, "edited": false, "score": 0, "creation_date": 1553841828, "post_id": 55350540, "comment_id": 97543156, "body": "@Ash Hi, Again. Happy you solved it. for the sake of experience you better find out why. and you didn&#39;t post enough of  your old code so we could help. your question has not enough information to find that bug. and still your answer not makes sense that, what was that bug and how you solved it. it is better you make minimum code that creates that bug and then find that problem, you may edit your post and add to the end of it as a new <code>Edit: ...</code>."}], "tags": [], "owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "is_accepted": false, "score": 2, "last_activity_date": 1553579390, "last_edit_date": 1553579390, "creation_date": 1553579070, "answer_id": 55350540, "question_id": 55350451, "link": "https://stackoverflow.com/questions/55350451/why-is-ioutil-readfile-hanging-after-being-called-in-a-for-loop/55350540#55350540", "title": "Why is ioutil.ReadFile() hanging after being called in a for loop?", "body": "<p>Debug your code.  </p>\n\n<hr>\n\n<p>Try this and let me know if this works for you too:<br>\nThis works like a charm for me on Linux:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/base64\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"os\"\n)\n\nfunc main() {\n    for i := 0; i &lt; 10; i++ {\n        fmt.Println(getBase64Screenshot()[:10])\n    }\n}\nfunc getBase64Screenshot() string {\n    buf, err := ioutil.ReadFile(os.Args[0])\n    if err != nil {\n        log.Fatal(err)\n    }\n    encoded := base64.StdEncoding.EncodeToString(buf)\n    return encoded\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>time go run main.go\nf0VMRgIBAQ\nf0VMRgIBAQ\nf0VMRgIBAQ\nf0VMRgIBAQ\nf0VMRgIBAQ\nf0VMRgIBAQ\nf0VMRgIBAQ\nf0VMRgIBAQ\nf0VMRgIBAQ\nf0VMRgIBAQ\n\nreal    0m0.340s\nuser    0m0.369s\nsys     0m0.128s\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 2, "last_activity_date": 1553579300, "creation_date": 1553579300, "answer_id": 55350574, "question_id": 55350451, "link": "https://stackoverflow.com/questions/55350451/why-is-ioutil-readfile-hanging-after-being-called-in-a-for-loop/55350574#55350574", "title": "Why is ioutil.ReadFile() hanging after being called in a for loop?", "body": "<p>One way to debug the issue is to send a SIGABRT to your running program (when hanging) in order to <a href=\"https://golang.org/pkg/os/signal/#hdr-Default_behavior_of_signals_in_Go_programs\" rel=\"nofollow noreferrer\">causes the program to exit with a stack dump</a>.</p>\n\n<pre><code>kill -ABRT &lt;pid&gt;\n# or CTRL+Pause on Windows.\n</code></pre>\n\n<p>Then you will see <em>where</em> the program is hang, and if it is actually related to your function or not.</p>\n"}, {"comments": [{"owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "edited": false, "score": 0, "creation_date": 1553841973, "post_id": 55410271, "comment_id": 97543219, "body": "How did you solve that bug? do you changed <code>getBase64Screenshot</code> function? In this form this is not an answer. you need to point that what was the source of bug, to make sense."}], "tags": [], "owner": {"reputation": 69, "user_id": 6397491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aa5d80896dfcf9e7e98de6ae9c14571?s=128&d=identicon&r=PG&f=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/6397491/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1553831682, "creation_date": 1553831682, "answer_id": 55410271, "question_id": 55350451, "link": "https://stackoverflow.com/questions/55350451/why-is-ioutil-readfile-hanging-after-being-called-in-a-for-loop/55410271#55410271", "title": "Why is ioutil.ReadFile() hanging after being called in a for loop?", "body": "<p>Hey guys I was able to fix the issue.</p>\n\n<p>You see, initially the function <code>getBase64Screenshot()</code> that I wrote above was being called every 10 seconds inside of a <code>goroutine</code>.</p>\n\n<p>To fix the issue I refactored my code to eliminate the <code>goroutine</code> and instead call <code>getBase64Screenshot()</code> inside of an infinite loop:</p>\n\n<pre><code>for {\n        getBase64Screenshot()\n        time.Sleep(timedelayMilliseconds * time.Millisecond)\n    }\n</code></pre>\n\n<p>I've tested the above code by running it for over 30 minutes with very large screenshots (>1MB in size), and it has <strong>never crashed or stalled</strong>.</p>\n\n<p>Though I've fixed the issue I encountered, I haven't been able to figure out what exactly caused it in the first place. I welcome any theories as to why my original code above stalled.</p>\n"}], "owner": {"reputation": 69, "user_id": 6397491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aa5d80896dfcf9e7e98de6ae9c14571?s=128&d=identicon&r=PG&f=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/6397491/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1553831682, "creation_date": 1553578481, "question_id": 55350451, "link": "https://stackoverflow.com/questions/55350451/why-is-ioutil-readfile-hanging-after-being-called-in-a-for-loop", "title": "Why is ioutil.ReadFile() hanging after being called in a for loop?", "body": "<p>I wrote a function that converts an image to a base64 string:</p>\n\n<pre><code>func getBase64Screenshot() string {\n    // Image name\n    imageName := \"Screenshots/screenshot.png\"\n\n    imageFileBytes, err := ioutil.ReadFile(imageName)\n    handleError(err)\n\n    // Converts file to base64 string\n    encoded := base64.StdEncoding.EncodeToString(imageFileBytes)\n\n    return encoded\n}\n</code></pre>\n\n<p>The above function is called in a <code>for loop</code>, however after some iterations of the for loop, the program just hangs at the line <code>imageFileBytes, err := ioutil.ReadFile(imageName)</code> (it doesn't throw an error, it just stops running and stalls).</p>\n\n<p>I ran some experiments and found that if I used a smaller image, it would make it through ~5 iterations of the <code>for loop</code> before stalling, however if I screenshot my entire screen it would only make it through the first iteration of the <code>for loop</code> before stalling.</p>\n\n<p>My question is this: <strong>What is causing the program to hang, and is there anything I can do to prevent it from hanging?</strong></p>\n\n<p>Thanks!</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-dynamodb", "aws-sdk-go"], "comments": [{"owner": {"reputation": 579, "user_id": 11206879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bS2D6.png?s=128&g=1", "display_name": "Pan Ke", "link": "https://stackoverflow.com/users/11206879/pan-ke"}, "edited": false, "score": 0, "creation_date": 1553579121, "post_id": 55350191, "comment_id": 97425080, "body": "what&#39;s zero value of <code>param1Condition</code> and <code>param2Condition</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 1185, "user_id": 1520421, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/5a4e98bb784ee939598e7b93705f3eaf?s=128&d=identicon&r=PG", "display_name": "Dattatray", "link": "https://stackoverflow.com/users/1520421/dattatray"}, "edited": false, "score": 0, "creation_date": 1554357817, "post_id": 55355055, "comment_id": 97722975, "body": "In my case I have multiple conditions, 6. The end user may specify any number of conditions ( 0 to 6). So some conditions may not have any values.   Is there any way, we can still add a condition which doesn&#39;t have any value?"}], "tags": [], "owner": {"reputation": 579, "user_id": 11206879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bS2D6.png?s=128&g=1", "display_name": "Pan Ke", "link": "https://stackoverflow.com/users/11206879/pan-ke"}, "is_accepted": false, "score": 0, "last_activity_date": 1553596621, "creation_date": 1553596621, "answer_id": 55355055, "question_id": 55350191, "link": "https://stackoverflow.com/questions/55350191/dynamodb-multiple-filter-conditions-gives-error-buildtree-error-unset-parame/55355055#55355055", "title": "DynamoDB multiple filter conditions, gives error - buildTree error: unset parameter: ConditionBuilder", "body": "<p><code>ConditionBuilder</code> has <code>mode</code> field</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type ConditionBuilder struct {\n    operandList   []OperandBuilder\n    conditionList []ConditionBuilder\n    mode          conditionMode\n}\n</code></pre>\n\n<p>The zero value of <code>mode</code> is <code>unsetCond</code>. When build condition, <code>unsetCond</code> raises the error.</p>\n\n<p><a href=\"https://github.com/aws/aws-sdk-go/blob/7798c2e0edc02ba058f7672d32f4ebf6603b5fc6/service/dynamodb/expression/condition.go#L1415\" rel=\"nofollow noreferrer\">https://github.com/aws/aws-sdk-go/blob/7798c2e0edc02ba058f7672d32f4ebf6603b5fc6/service/dynamodb/expression/condition.go#L1415</a> </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>case unsetCond:\n        return exprNode{}, newUnsetParameterError(\"buildTree\", \"ConditionBuilder\")\n</code></pre>\n\n<p>In your code, if <code>queryParam != \u201cparam1\u201d</code> and <code>queryParam != \u201cparam2\u201d</code>, the <code>param1Condition</code> and <code>param2Condition</code> is zero value of ConditionBuilder, which fails on build.</p>\n"}], "owner": {"reputation": 1185, "user_id": 1520421, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/5a4e98bb784ee939598e7b93705f3eaf?s=128&d=identicon&r=PG", "display_name": "Dattatray", "link": "https://stackoverflow.com/users/1520421/dattatray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 939, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553596621, "creation_date": 1553576793, "last_edit_date": 1553592515, "question_id": 55350191, "link": "https://stackoverflow.com/questions/55350191/dynamodb-multiple-filter-conditions-gives-error-buildtree-error-unset-parame", "title": "DynamoDB multiple filter conditions, gives error - buildTree error: unset parameter: ConditionBuilder", "body": "<p>I am building REST APIs, using Lambda and DynamoDB in GO.</p>\n\n<p>I need to query the data based on multiple filters.</p>\n\n<p>The number of filters can be varying based on the number of query parameters user has provided, while calling the REST API.</p>\n\n<p>As per the below post, I had developed the code to add multiple conditions.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/53073212/aws-sdk-for-go-dynamodb-add-multiple-conditions-to-filterexpression\">AWS SDK for Go - DynamoDb - Add multiple conditions to FilterExpression</a></p>\n\n<p>But when I invoke the function, I get below error, in the logs.- </p>\n\n<blockquote>\n  <p>buildTree error: unset parameter: ConditionBuilder</p>\n</blockquote>\n\n<p>The Filter expression is not applied and the scan returns all the results.</p>\n\n<p>Here is the code snippet.</p>\n\n<pre><code>for queryParam, queryParamValue := range searchParams {\n        fmt.Println(\"queryParam:\", queryParam, \"=&gt;\", \"queryParamValue:\", queryParamValue)\n        if queryParam == \u201cparam1\u201d {\n            param1Condition = expression.Name(\u201cparam1\u201d).Equal(expression.Value(queryParamValue))\n        }\n\n        if queryParam == \u201cparam2\u201d {\n            param2Condition = expression.Name(\u201cparam2\u201d).Equal(expression.Value(queryParamValue))\n        }   \n    }\n\n\nsampleExpr, errSample := expression.NewBuilder().\n        WithCondition(param1Condition.Or(param2Condition)).\n        Build()\n    if errSample != nil {\n        fmt.Println(\"Error in building Sample Expr \", errSample)\n    } else {\n        fmt.Println(\"sampleExpr \", sampleExpr)\n    }\n\n    input := &amp;dynamodb.ScanInput{\n        ExpressionAttributeNames:  sampleExpr.Names(),\n        ExpressionAttributeValues: sampleExpr.Values(),\n        FilterExpression:          sampleExpr.Filter(),\n        TableName:                 aws.String(deviceInfotable),\n    }\n</code></pre>\n\n<p>But if I create the expression in different way, it works.</p>\n\n<pre><code>filt := expression.Name(\"param1\").Equal(expression.Value(\"valu1\")).Or(expression.Name(\"param2\").Equal(expression.Value(\"value2\")))\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1152, "user_id": 1603399, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/95QCa.jpg?s=128&g=1", "display_name": "dimiguel", "link": "https://stackoverflow.com/users/1603399/dimiguel"}, "is_accepted": false, "score": 0, "last_activity_date": 1553578431, "creation_date": 1553578431, "answer_id": 55350442, "question_id": 55350173, "link": "https://stackoverflow.com/questions/55350173/calling-the-same-function-on-two-different-structs/55350442#55350442", "title": "Calling the same function on two different structs", "body": "<p>Wow, I think I'm in love with Go. I can actually just do this by creating my own interface.</p>\n\n<pre><code>type Saver interface {\n  Prepare(query string) (*sql.Stmt, error)\n}\n\nfunc Save(db *sql.DB) error {\n  return GenericSave(db)\n}\n\nfunc TxSave(tx *sql.Tx) error {\n  return GenericSave(tx)\n}\n\nfunc GenericSave(saver Saver) error {\n  stmt := saver.Prepare(query)\n  // Do rest with saver\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1152, "user_id": 1603399, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/95QCa.jpg?s=128&g=1", "display_name": "dimiguel", "link": "https://stackoverflow.com/users/1603399/dimiguel"}, "edited": false, "score": 0, "creation_date": 1553578622, "post_id": 55350457, "comment_id": 97424929, "body": "I actually came up with the same exact response right before you! I&#39;ll accept this as the correct answer since it has much more detail."}, {"owner": {"reputation": 2702, "user_id": 2923336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LmjCO.png?s=128&g=1", "display_name": "Francois", "link": "https://stackoverflow.com/users/2923336/francois"}, "reply_to_user": {"reputation": 1152, "user_id": 1603399, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/95QCa.jpg?s=128&g=1", "display_name": "dimiguel", "link": "https://stackoverflow.com/users/1603399/dimiguel"}, "edited": false, "score": 1, "creation_date": 1553578718, "post_id": 55350457, "comment_id": 97424960, "body": "Good you found out. Implicit interface implementation in Go is an extremely useful feature!"}], "tags": [], "owner": {"reputation": 2702, "user_id": 2923336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LmjCO.png?s=128&g=1", "display_name": "Francois", "link": "https://stackoverflow.com/users/2923336/francois"}, "is_accepted": true, "score": 2, "last_activity_date": 1553578544, "creation_date": 1553578544, "answer_id": 55350457, "question_id": 55350173, "link": "https://stackoverflow.com/questions/55350173/calling-the-same-function-on-two-different-structs/55350457#55350457", "title": "Calling the same function on two different structs", "body": "<p>Create an interface such as: </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type SQLRunner interface{\n    Prepare(query string) (*sql.Stmt, error)\n    PrepareContext(ctx context.Context, query string) (*sql.Stmt, error)\n    Query(query string, args ...interface{}) (*Rows, error)\n    QueryContext(ctx context.Context, query string, args ...interface{}) (*sql.Rows, error)\n    // add as many method shared by both sql.Tx qnd sql.DB\n    // ...\n} \n</code></pre>\n\n<p>And then create a single method taking that interface: </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func Save(s SQLRunner) error {\n    s.Prepare()\n}\n</code></pre>\n\n<p>In go interface implementation is implicit, so you just have to pass *sql.Tx or *sql.DB to the save function:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>Save(tx)\nSave(db)\n</code></pre>\n\n<p>Here a good blog post about interfaces in go:<a href=\"http://jordanorelli.com/post/32665860244/how-to-use-interfaces-in-go\" rel=\"nofollow noreferrer\">http://jordanorelli.com/post/32665860244/how-to-use-interfaces-in-go</a></p>\n"}], "owner": {"reputation": 1152, "user_id": 1603399, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/95QCa.jpg?s=128&g=1", "display_name": "dimiguel", "link": "https://stackoverflow.com/users/1603399/dimiguel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "accepted_answer_id": 55350457, "answer_count": 2, "score": 0, "last_activity_date": 1553578544, "creation_date": 1553576696, "last_edit_date": 1553578492, "question_id": 55350173, "link": "https://stackoverflow.com/questions/55350173/calling-the-same-function-on-two-different-structs", "title": "Calling the same function on two different structs", "body": "<p>I've got two functions that accept different pointers pointing to different structs, but the structs have the same underlying function.</p>\n\n<pre><code>func Save(db *sql.DB) error {\n  db.Prepare(query)\n}\n\nfunc TxSave(tx *sql.Tx) error {\n  tx.Prepare(query)\n}\n</code></pre>\n\n<p>I don't want to have to make changes in both functions when I need to extend this function in the future. How do I adhere to DRYness in golang with this scenario?</p>\n"}, {"tags": ["go", "redis", "redigo"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1553576508, "post_id": 55350106, "comment_id": 97424400, "body": "What is the evidence that the program leaks memory?  How many connections are in the pool at the time the leak is observed?"}, {"owner": {"reputation": 171, "user_id": 6552119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2de2baa3f2cd1e0c54f1ecea45444511?s=128&d=identicon&r=PG&f=1", "display_name": "Utkarsh", "link": "https://stackoverflow.com/users/6552119/utkarsh"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1553576768, "post_id": 55350106, "comment_id": 97424468, "body": "I did top on the program. The memory usage goes on increasing which doesn&#39;t happen without the Do.  Almost 10,000 active connections. The code is making around 20,000 SET requests per second."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1553577018, "post_id": 55350106, "comment_id": 97424525, "body": "A count of 10,000 active connections is huge!  You should pipeline over a smaller number of connections. Does the memory stop growing after the application creates all of those connections?"}, {"owner": {"reputation": 171, "user_id": 6552119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2de2baa3f2cd1e0c54f1ecea45444511?s=128&d=identicon&r=PG&f=1", "display_name": "Utkarsh", "link": "https://stackoverflow.com/users/6552119/utkarsh"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1553577089, "post_id": 55350106, "comment_id": 97424536, "body": "No, I don&#39;t think so. It reached 32GB after which the process crashed."}, {"owner": {"reputation": 536, "user_id": 3956589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39365ac79e46dc67ace5d93a627a068d?s=128&d=identicon&r=PG&f=1", "display_name": "whitespace", "link": "https://stackoverflow.com/users/3956589/whitespace"}, "edited": false, "score": 1, "creation_date": 1553597866, "post_id": 55350106, "comment_id": 97434582, "body": "is <code>SET</code> being called inside a <code>go func</code>? or the <code>main</code> goroutine."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 3, "creation_date": 1553603602, "post_id": 55350106, "comment_id": 97438074, "body": "Please provide an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.   The idle timeout and max idle values use values not shown in the question.  Show how SET is called."}, {"owner": {"reputation": 377, "user_id": 5953626, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-dDwLTM1rSaQ/AAAAAAAAAAI/AAAAAAAAEkM/XVdkrI4-qxk/photo.jpg?sz=128", "display_name": "Nannan AV", "link": "https://stackoverflow.com/users/5953626/nannan-av"}, "edited": false, "score": 0, "creation_date": 1553605342, "post_id": 55350106, "comment_id": 97439334, "body": "Which redis package are you using? This doesn&#39;t look like go-redis, the one I&#39;m using!!"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 377, "user_id": 5953626, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-dDwLTM1rSaQ/AAAAAAAAAAI/AAAAAAAAEkM/XVdkrI4-qxk/photo.jpg?sz=128", "display_name": "Nannan AV", "link": "https://stackoverflow.com/users/5953626/nannan-av"}, "edited": false, "score": 0, "creation_date": 1553618615, "post_id": 55350106, "comment_id": 97448428, "body": "@NannanAV The question uses Redigo per the tag on the question."}], "owner": {"reputation": 171, "user_id": 6552119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2de2baa3f2cd1e0c54f1ecea45444511?s=128&d=identicon&r=PG&f=1", "display_name": "Utkarsh", "link": "https://stackoverflow.com/users/6552119/utkarsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 519, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1553578486, "creation_date": 1553576290, "last_edit_date": 1553578486, "question_id": 55350106, "link": "https://stackoverflow.com/questions/55350106/how-to-fix-memory-leak-when-using-connection-pool", "title": "How to fix memory leak when using connection pool?", "body": "<p>I am using redigo with connection pool. \nBelow is my code for setting up connection pool and the wrapper for SET call to Redis</p>\n\n<pre><code>//Create a pool of client connections to Redis\nfunc newPool(MaxIdleConns int, Timeout int) *redis.Pool {\n    return &amp;redis.Pool{\n        // Maximum number of idle connections in the pool.\n        MaxIdle: MaxIdleConns*10,\n        // Close connections after remaining idle for this duration\n        IdleTimeout: time.Duration(Timeout) * time.Second,\n        // Maximum number of connections allocated by the pool at a given time.\n        MaxActive: 500,\n        // If Wait is true and the pool is at the MaxActive limit, then Get() waits\n        // for a connection to be returned to the pool before returning.\n        Wait: true,\n        // Dial is an application supplied function for creating and\n        // configuring a connection.\n        Dial: func() (redis.Conn, error) {\n            // c, err := redis.DialTimeout(\"tcp\", \":6379\", 10*time.Second, 10*time.Second, 10*time.Second)\n            c, err := redis.Dial(\"tcp\", \":6379\")\n            if err != nil {\n                fmt.Println(\"Redis Pool Dial error: \", err)\n            }\n            return c, err\n        },\n    }\n}\n\n//SET Wrapper\nfunc SET(p *redis.Pool, key string, value []byte) error {\n    c := p.Get()\n    defer c.Close()\n    _, err := c.Do(\"SET\", key, value)\n    return err\n}\n</code></pre>\n\n<p>The above code leaks memory.\nI am closing the connection properly in <code>defer c.Close()</code>.\nSurprisingly if I comment out <code>_, err := c.Do(\"SET\", key, value)</code> as in I don't do any <code>c.Do()</code> then the program doesn't leak memory.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1778, "user_id": 2880747, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9vDLF.jpg?s=128&g=1", "display_name": "WilomGfx", "link": "https://stackoverflow.com/users/2880747/wilomgfx"}, "edited": false, "score": 3, "creation_date": 1553564725, "post_id": 55348703, "comment_id": 97422108, "body": "well <code>MethodCall</code> is not a member of your <code>DeclaredType</code> struct"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1553610898, "post_id": 55348703, "comment_id": 97443231, "body": "Take a look at the <a href=\"https://tour.golang.org/methods/1\" rel=\"nofollow noreferrer\">Tour of Go</a>, method declarations are explained well."}], "answers": [{"tags": [], "owner": {"reputation": 1059, "user_id": 1982418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbe9fddd5823aa8ae6a41ec889f0f581?s=128&d=identicon&r=PG&f=1", "display_name": "sh.seo", "link": "https://stackoverflow.com/users/1982418/sh-seo"}, "is_accepted": true, "score": 7, "last_activity_date": 1553566049, "creation_date": 1553566049, "answer_id": 55348856, "question_id": 55348703, "link": "https://stackoverflow.com/questions/55348703/method-that-is-present-being-shown-as-undefined-golang/55348856#55348856", "title": "Method that is present being shown as undefined golang", "body": "<p>Register MethodCall() as a receiver in DeclaredType.</p>\n\n<p><strong>remote_method.go</strong></p>\n\n<pre><code>package remote_method\n\nimport (\n.....\n)\n\ntype DeclaredType struct {\n        randomMap (map[string][](chan int))\n}\n\nfunc NewObject() DeclaredType {\n        var randomMap (map[string][](chan int))\n        m := DeclaredType{randomMap}\n        return m\n}\n\nfunc (d DeclaredType) MethodCall(m DeclaredType, param1 string, param2 string, param3 string, param4 string) {\n     // Code to be run\n}\n</code></pre>\n"}], "owner": {"reputation": 956, "user_id": 1404195, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cc8d8fe40a513ac9369bf01b82e324ab?s=128&d=identicon&r=PG", "display_name": "The_Lost_Avatar", "link": "https://stackoverflow.com/users/1404195/the-lost-avatar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 55348856, "answer_count": 1, "score": 0, "last_activity_date": 1553566049, "creation_date": 1553564564, "question_id": 55348703, "link": "https://stackoverflow.com/questions/55348703/method-that-is-present-being-shown-as-undefined-golang", "title": "Method that is present being shown as undefined golang", "body": "<p>I am trying to call a method from a different directory but getting an error saying that the method is not present. I have the method present with the first letter Uppercase.</p>\n\n<p>I have the following directory structure</p>\n\n<pre><code>[laptop@laptop src]$ tree\n.\n\u251c\u2500\u2500 hello\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 hello.go\n\u251c\u2500\u2500 remote_method\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 remoteMethod.go\n</code></pre>\n\n<p>My main is in hello.go and tries to call a function from the remote_method package </p>\n\n<pre><code>package main\nimport \n (\n        \"remote_method\"\n )\n\nfunc main() {\n     mm := remote_method.NewObject()\n     mm.MethodCall()\n}\n</code></pre>\n\n<p>The remoteMethod.go has the following contents</p>\n\n<pre><code>package remote_method\n\nimport (\n.....\n)\n\ntype DeclaredType struct {\n        randomMap (map[string][](chan int))\n}\n\nfunc NewObject() DeclaredType {\n        var randomMap (map[string][](chan int))\n        m := DeclaredType{randomMap}\n        return m\n}\n\nfunc MethodCall(m DeclaredType, param1 string, param2 string, param3 string, param4 string) {\n     // Code to be run\n}\n</code></pre>\n\n<p>I get the error </p>\n\n<pre><code>mm.MethodCall undefined (type remote_method.DeclaredType has no field or method MethodCall)\n</code></pre>\n\n<p>Can someone help me in finding why the method is not visible or any possible ways I could find that. \nTIA</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 172, "user_id": 1762347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tz9hX.png?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/1762347/rob"}, "edited": false, "score": 0, "creation_date": 1553567669, "post_id": 55348502, "comment_id": 97422669, "body": "@zerkms No problem! If you have time, I have other edit suggestions that need review as well."}], "tags": [], "owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "is_accepted": true, "score": 5, "last_activity_date": 1553563830, "last_edit_date": 1553563830, "creation_date": 1553562657, "answer_id": 55348502, "question_id": 55348462, "link": "https://stackoverflow.com/questions/55348462/gotest-cannot-use-int-literal-type-int-as-type-args-in-field-value/55348502#55348502", "title": "Gotest - cannot use []int literal (type []int) as type args in field value", "body": "<p>It's because the second field of your anonymous structure is <code>args</code>, not <code>[]nums</code></p>\n\n<p>You should initialize it as with an explicitly typed <code>args</code> value.</p>\n\n<pre><code>{\"test\", args{nums: []int{3, 4}}, 7},\n</code></pre>\n\n<p>Or, if you prefer the field-less struct literals:</p>\n\n<pre><code>{\"test\", args{[]int{3, 4}}, 7},\n</code></pre>\n"}], "owner": {"reputation": 1569, "user_id": 8784015, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2733173f5b643bbf93278b76f39747f5?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/8784015/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1000, "favorite_count": 0, "accepted_answer_id": 55348502, "answer_count": 1, "score": 0, "last_activity_date": 1553563830, "creation_date": 1553562308, "question_id": 55348462, "link": "https://stackoverflow.com/questions/55348462/gotest-cannot-use-int-literal-type-int-as-type-args-in-field-value", "title": "Gotest - cannot use []int literal (type []int) as type args in field value", "body": "<p>I am trying to test a basic sum function with a table test. Here is the function:</p>\n\n<pre><code>func Sum(nums []int) int {\n    sum := 0\n    for _, n := range nums {\n        sum += n\n    }\n    return sum\n}\n</code></pre>\n\n<p>I do know that the error is with the table args, but I don't understand why Golang will not accept the tests. It would be great to have some clarity. See test below and error:</p>\n\n<pre><code>import (\n    \"testing\"\n)\n\nfunc TestSum(t *testing.T) {\n\n    type args struct {\n        nums []int\n    }\n    tests := []struct {\n        name string\n        args args\n        want int\n    }{\n        {\"test\", []int{3, 4}, 7},\n        {\"test\", []int{3, 3}, 6},\n\n    }\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n            if got := Sum(tt.args.nums); got != tt.want {\n                t.Errorf(\"Sum() = %v, want %v\", got, tt.want)\n            }\n        })\n    }\n}\n</code></pre>\n\n<p><code>cannot use []int literal (type []int) as type args in field value</code></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 602, "user_id": 6863654, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VaBUN.png?s=128&g=1", "display_name": "beiping96", "link": "https://stackoverflow.com/users/6863654/beiping96"}, "edited": false, "score": 0, "creation_date": 1553563992, "post_id": 55348458, "comment_id": 97421970, "body": "Could you show your $GOPATH ?"}, {"owner": {"reputation": 48983, "user_id": 314028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/408552a8101c1b9d466dcc5f104b1619?s=128&d=identicon&r=PG", "display_name": "Chris Taylor", "link": "https://stackoverflow.com/users/314028/chris-taylor"}, "edited": false, "score": 3, "creation_date": 1553567936, "post_id": 55348458, "comment_id": 97422712, "body": "What are you <code>GOOS</code> and <code>GOARCH</code> environment variables set to? route.go is only applicable for darwin, dragonfly, FreeBSD, NetBSD and OpenBSD."}, {"owner": {"reputation": 139, "user_id": 6217600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b4595e1f5c15da4a225bdd167ba0976?s=128&d=identicon&r=PG&f=1", "display_name": "jerry", "link": "https://stackoverflow.com/users/6217600/jerry"}, "edited": false, "score": 0, "creation_date": 1553641117, "post_id": 55348458, "comment_id": 97458341, "body": "Thanks Chris, my GOARCH is arm. that&#39;s the reason"}], "answers": [{"tags": [], "owner": {"reputation": 277, "user_id": 2348261, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/fadb7972b6a99994a3b85f90bcfc8ea4?s=128&d=identicon&r=PG&f=1", "display_name": "RK26", "link": "https://stackoverflow.com/users/2348261/rk26"}, "is_accepted": false, "score": 2, "last_activity_date": 1602480785, "creation_date": 1602480785, "answer_id": 64312193, "question_id": 55348458, "link": "https://stackoverflow.com/questions/55348458/build-constraints-exclude-all-go-files-in/64312193#64312193", "title": "build constraints exclude all Go files in", "body": "<p>try to remove folder x in go/src/golang.org/</p>\n"}, {"tags": [], "owner": {"reputation": 33451, "user_id": 3011380, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/oN76M.jpg?s=128&g=1", "display_name": "zangw", "link": "https://stackoverflow.com/users/3011380/zangw"}, "is_accepted": false, "score": 0, "last_activity_date": 1617969165, "creation_date": 1617969165, "answer_id": 67020638, "question_id": 55348458, "link": "https://stackoverflow.com/questions/55348458/build-constraints-exclude-all-go-files-in/67020638#67020638", "title": "build constraints exclude all Go files in", "body": "<p>We met the same error under <code>Goland</code>, and it could be solved in <a href=\"https://www.jetbrains.com/help/go/configuring-build-constraints-and-vendoring.html#build-constraints\" rel=\"nofollow noreferrer\">this way</a></p>\n<p>If you want to set <code>GOOS = linux</code> under Mac, just add this line in the header of file <code>// +build linux,amd64,go1.15,!cgo</code> which means we declare that this file is for the target system that has the following requirements: Linux, the AMD64 architecture, the 1.15 Go version, and no CGO support.</p>\n"}], "owner": {"reputation": 139, "user_id": 6217600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b4595e1f5c15da4a225bdd167ba0976?s=128&d=identicon&r=PG&f=1", "display_name": "jerry", "link": "https://stackoverflow.com/users/6217600/jerry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12418, "favorite_count": 1, "answer_count": 2, "score": 9, "last_activity_date": 1617969165, "creation_date": 1553562278, "last_edit_date": 1553566593, "question_id": 55348458, "link": "https://stackoverflow.com/questions/55348458/build-constraints-exclude-all-go-files-in", "title": "build constraints exclude all Go files in", "body": "<p>when import     \"golang.org/x/net/route\"</p>\n\n<p>it tells \n\"build constraints exclude all Go files in go/src/golang.org/x/net/routego\"</p>\n\n<p>I am using VSCode editor on Windows/Linux</p>\n\n<p>I searched online and didn't see a solution to the similar problem</p>\n\n<pre><code>package main\n\nimport (\n    \"golang.org/x/net/route\"\n)\n\n{\n    rib, _ := route.FetchRIB(0, route.RIBTypeRoute, 0)\n    messages, err := route.ParseRIB(route.RIBTypeRoute, rib)\n}\n</code></pre>\n"}, {"tags": ["json", "go", "encoding", "stream"], "comments": [{"owner": {"reputation": 579, "user_id": 11206879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bS2D6.png?s=128&g=1", "display_name": "Pan Ke", "link": "https://stackoverflow.com/users/11206879/pan-ke"}, "edited": false, "score": 0, "creation_date": 1553556023, "post_id": 55347669, "comment_id": 97432805, "body": "<a href=\"https://golang.org/pkg/encoding/json/#Encoder\" rel=\"nofollow noreferrer\">golang.org/pkg/encoding/json/#Encoder</a> will help <a href=\"https://blog.golang.org/json-and-go\" rel=\"nofollow noreferrer\">blog.golang.org/json-and-go</a> <code>Streaming Encoders and Decoders</code>"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1553592594, "last_edit_date": 1553592594, "creation_date": 1553555807, "answer_id": 55347739, "question_id": 55347669, "link": "https://stackoverflow.com/questions/55347669/how-to-stream-object-to-gzipped-json/55347739#55347739", "title": "how to stream object to gzipped json?", "body": "<p>Yes, you may use <a href=\"https://golang.org/pkg/encoding/json/#Encoder\" rel=\"nofollow noreferrer\"><code>json.Encoder</code></a> to stream the JSON output, and similarly <a href=\"https://golang.org/pkg/encoding/json/#Dencoder\" rel=\"nofollow noreferrer\"><code>json.Decoder</code></a> to decode a streamed JSON input. They take any <a href=\"https://golang.org/pkg/io/#Writer\" rel=\"nofollow noreferrer\"><code>io.Writer</code></a> and <a href=\"https://golang.org/pkg/io/#Reader\" rel=\"nofollow noreferrer\"><code>io.Reader</code></a> to write the JSON result to / read from, including <a href=\"https://golang.org/pkg/compress/gzip/#Writer\" rel=\"nofollow noreferrer\"><code>gzip.Writer</code></a> and <a href=\"https://golang.org/pkg/compress/gzip/#Reader\" rel=\"nofollow noreferrer\"><code>gzip.Reader</code></a>.</p>\n\n<p>For example:</p>\n\n<pre><code>var body bytes.Buffer\nw := gzip.NewWriter(&amp;body)\n\nenc := json.NewEncoder(w)\n\npayload := map[string]interface{}{\n    \"one\": 1, \"two\": 2,\n}\nif err := enc.Encode(payload); err != nil {\n    panic(err)\n}\nif err := w.Close(); err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>To verify that it works, this is how we can decode it:</p>\n\n<pre><code>r, err := gzip.NewReader(&amp;body)\nif err != nil {\n    panic(err)\n}\ndec := json.NewDecoder(r)\npayload = nil\nif err := dec.Decode(&amp;payload); err != nil {\n    panic(err)\n}\n\nfmt.Println(\"Decoded:\", payload)\n</code></pre>\n\n<p>Which will output (try it on the <a href=\"https://play.golang.org/p/Mp0-UKwnLPX\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Decoded: map[one:1 two:2]\n</code></pre>\n"}], "owner": {"reputation": 36041, "user_id": 14316, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f1eb8b540db13afbb3426637641534aa?s=128&d=identicon&r=PG", "display_name": "pdeva", "link": "https://stackoverflow.com/users/14316/pdeva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "accepted_answer_id": 55347739, "answer_count": 1, "score": 6, "last_activity_date": 1553592594, "creation_date": 1553555325, "last_edit_date": 1553556117, "question_id": 55347669, "link": "https://stackoverflow.com/questions/55347669/how-to-stream-object-to-gzipped-json", "title": "how to stream object to gzipped json?", "body": "<p>Currently the way to convert an object to json and gzip it is:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>jsonBytes, _ := json.Marshal(payload)\n//gzip json\nvar body bytes.Buffer\ng := gzip.NewWriter(&amp;body)\ng.Write(jsonBytes)\ng.Close()\n\n</code></pre>\n\n<p>This results in an intermediate large byte buffer <code>jsonBytes</code>, whose only purpose is to be then converted into gzipped buffer.</p>\n\n<p>Is there any way to <em>stream</em> the marshalling of the <code>payload</code> object so it comes out gzipped in the first place?</p>\n"}, {"tags": ["go", "cors", "go-gin"], "comments": [{"owner": {"reputation": 1059, "user_id": 1982418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbe9fddd5823aa8ae6a41ec889f0f581?s=128&d=identicon&r=PG&f=1", "display_name": "sh.seo", "link": "https://stackoverflow.com/users/1982418/sh-seo"}, "edited": false, "score": 0, "creation_date": 1553561366, "post_id": 55347167, "comment_id": 97421413, "body": "Can I add the main code? There is not enough information."}, {"owner": {"reputation": 602, "user_id": 6863654, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VaBUN.png?s=128&g=1", "display_name": "beiping96", "link": "https://stackoverflow.com/users/6863654/beiping96"}, "edited": false, "score": 0, "creation_date": 1553564131, "post_id": 55347167, "comment_id": 97421997, "body": "Add your main code and HTTP request curl args will be helpful."}], "answers": [{"comments": [{"owner": {"reputation": 2831, "user_id": 8054330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4H0EN.jpg?s=128&g=1", "display_name": "Markus Kollers", "link": "https://stackoverflow.com/users/8054330/markus-kollers"}, "edited": false, "score": 0, "creation_date": 1553635492, "post_id": 55350389, "comment_id": 97456383, "body": "Sound logic but doesn&#39;t work :( I moved it in front of <code>gin.new()</code>, but still got 404 responses"}], "tags": [], "owner": {"reputation": 2702, "user_id": 2923336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LmjCO.png?s=128&g=1", "display_name": "Francois", "link": "https://stackoverflow.com/users/2923336/francois"}, "is_accepted": false, "score": 2, "last_activity_date": 1553578110, "creation_date": 1553578110, "answer_id": 55350389, "question_id": 55347167, "link": "https://stackoverflow.com/questions/55347167/gin-contrib-cors-returns-404/55350389#55350389", "title": "gin-contrib/cors returns 404", "body": "<p>You need to add your cors middleware to your engine before you create your group. Because gin copies all the middlewares added to the engine to the group when you create the group. So if you add it afterwards to the engine, it won't be part of the group. </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>engine := gin.New()\n\n// Set cors and db middleware\nengine.Use(cors.New(cors.Config{\n    AllowOrigins:     []string{\"*\"},\n    AllowMethods:     []string{\"*\"},\n    AllowHeaders:     []string{\"*\"},\n    AllowCredentials: true,     \n    MaxAge: 12 * time.Hour,\n}))\n\ngroup := engine.Group(\"/api/v1\")\n\n// Recovery middleware recovers from any panics and writes a 500 if there was one.\ngroup.Use(gin.Recovery())\n\n// Register routes\ngroup.POST(\"/customers\", ctrl.SendRequest)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 627, "user_id": 2931316, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tOHqU.jpg?s=128&g=1", "display_name": "M Ashraful A", "link": "https://stackoverflow.com/users/2931316/m-ashraful-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1553581941, "creation_date": 1553581941, "answer_id": 55351054, "question_id": 55347167, "link": "https://stackoverflow.com/questions/55347167/gin-contrib-cors-returns-404/55351054#55351054", "title": "gin-contrib/cors returns 404", "body": "<p>Maybe you can try adding cors without <code>gin-contrib/cors</code> middleware. \nI tried <code>gin-contrib/cors</code> faced the same issue then added the cors header manually</p>\n\n<pre><code>router := gin.New()\nrouter.Use(func(context *gin.Context) {\n    context.Writer.Header().Add(\"Access-Control-Allow-Origin\", \"*\")\n    context.Writer.Header().Add(\"Access-Control-Max-Age\", \"10000\")\n    context.Writer.Header().Add(\"Access-Control-Allow-Methods\", \"GET,HEAD,POST,PUT,PATCH,DELETE,OPTIONS\")\n    context.Writer.Header().Add(\"Access-Control-Allow-Headers\", \"Authorization,Content-Type,Accept\")\n    context.Next()\n})\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 79, "user_id": 6123346, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207504006011775/picture?type=large", "display_name": "Bhima Werkudara", "link": "https://stackoverflow.com/users/6123346/bhima-werkudara"}, "is_accepted": false, "score": 2, "last_activity_date": 1559069314, "creation_date": 1559069314, "answer_id": 56348408, "question_id": 55347167, "link": "https://stackoverflow.com/questions/55347167/gin-contrib-cors-returns-404/56348408#56348408", "title": "gin-contrib/cors returns 404", "body": "<pre><code>engine := gin.New()\n\nengine.Use(func(c *gin.Context) {\n    c.Writer.Header().Set(\"Access-Control-Allow-Origin\", \"*\")\n    c.Writer.Header().Set(\"Access-Control-Allow-Credentials\", \"true\")\n    c.Writer.Header().Set(\"Access-Control-Allow-Headers\", \"Content-Type, Content-Length, Accept-Encoding, X-CSRF-Token, Authorization, accept, origin, Cache-Control, X-Requested-With\")\n    c.Writer.Header().Set(\"Access-Control-Allow-Methods\", \"POST, OPTIONS, GET, PUT, DELETE\")\n\n    if c.Request.Method == \"OPTIONS\" {\n        c.AbortWithStatus(204)\n        return\n    }\n\n    c.Next()\n})\n\n</code></pre>\n\n<p>make sure you add CORS middleware before you adding group</p>\n"}, {"tags": [], "owner": {"reputation": 119, "user_id": 4044870, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/55c9b8a092b9ff7680756573e069a8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Taylor", "link": "https://stackoverflow.com/users/4044870/paul-taylor"}, "is_accepted": false, "score": 2, "last_activity_date": 1598229715, "creation_date": 1598229715, "answer_id": 63553350, "question_id": 55347167, "link": "https://stackoverflow.com/questions/55347167/gin-contrib-cors-returns-404/63553350#63553350", "title": "gin-contrib/cors returns 404", "body": "<p>I had EXACTLY the same problem, but positioning the 'group' was not the issue.</p>\n<p>here is my code with the problem code commented out and replaced with manual cors....</p>\n<pre><code>// router.Use(cors.New(cors.Config{\n//  // AllowAllOrigins: true,\n//  AllowOrigins:     []string{&quot;*&quot;},\n//  AllowMethods:     []string{&quot;GET&quot;, &quot;POST&quot;, &quot;PUT&quot;, &quot;PATCH&quot;, &quot;DELETE&quot;, &quot;OPTIONS&quot;},\n//  AllowHeaders:     []string{&quot;Origin&quot;, &quot;Accept&quot;, &quot;Content-Type&quot;, &quot;Content-Length&quot;, &quot;Accept-Encoding&quot;, &quot;X-CSRF-Token&quot;, &quot;Authorization&quot;, &quot;ResponseType&quot;},\n//  ExposeHeaders:    []string{&quot;Content-Length&quot;},\n//  AllowCredentials: true,\n//  MaxAge:           12 * time.Hour,\n// }))\n\nrouter.Use(func(c *gin.Context) {\n    c.Writer.Header().Set(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;)\n    c.Writer.Header().Set(&quot;Access-Control-Allow-Credentials&quot;, &quot;true&quot;)\n    c.Writer.Header().Set(&quot;Access-Control-Allow-Headers&quot;, &quot;Content-Type, Content-Length, Accept-Encoding, X-CSRF-Token, Authorization, ResponseType, accept, origin, Cache-Control, X-Requested-With&quot;)\n    c.Writer.Header().Set(&quot;Access-Control-Allow-Methods&quot;, &quot;POST, OPTIONS, GET, PUT, DELETE&quot;)\n\n    if c.Request.Method == &quot;OPTIONS&quot; {\n        c.AbortWithStatus(204)\n        return\n    }\n    c.Next()\n})\n\n</code></pre>\n"}], "owner": {"reputation": 2831, "user_id": 8054330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4H0EN.jpg?s=128&g=1", "display_name": "Markus Kollers", "link": "https://stackoverflow.com/users/8054330/markus-kollers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1297, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1598229715, "creation_date": 1553551971, "last_edit_date": 1597438442, "question_id": 55347167, "link": "https://stackoverflow.com/questions/55347167/gin-contrib-cors-returns-404", "title": "gin-contrib/cors returns 404", "body": "<p>I've got a golang REST API, which implements <code>gin-contrib/cors</code>. But when I call a POST request the preflight request (OPTIONS) returns a 404 result.</p>\n<p>Here's a snippet of the implementation:</p>\n<pre><code>engine := gin.New()\ngroup := engine.Group(&quot;/api/v1&quot;)\n\n// Recovery middleware recovers from any panics and writes a 500 if there was one.\ngroup.Use(gin.Recovery())\n\n// Set cors and db middleware\nengine.Use(cors.New(cors.Config{\n    AllowOrigins:     []string{&quot;*&quot;},\n    AllowMethods:     []string{&quot;*&quot;},\n    AllowHeaders:     []string{&quot;*&quot;},\n    AllowCredentials: true,     \n    MaxAge: 12 * time.Hour,\n}))\n\n// Register routes\ngroup.POST(&quot;/customers&quot;, ctrl.SendRequest)\n</code></pre>\n"}, {"tags": ["go", "ibm-cloud", "ibm-cloud-infrastructure"], "answers": [{"tags": [], "owner": {"reputation": 668, "user_id": 9426033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e497a5abd02ca5ab68b84c07a1d084cd?s=128&d=identicon&r=PG&f=1", "display_name": "F.Ojeda", "link": "https://stackoverflow.com/users/9426033/f-ojeda"}, "is_accepted": false, "score": 0, "last_activity_date": 1553555808, "creation_date": 1553555808, "answer_id": 55347740, "question_id": 55347163, "link": "https://stackoverflow.com/questions/55347163/how-to-allocate-fixed-ip-address-during-create-softlayer-vsi/55347740#55347740", "title": "How to allocate fixed ip address during create softlayer vsi", "body": "<p>Unfortunately you won't be able to configure the ip address while creating the VSI. The provisioning process looks for an available ip address in the subnet an it is assigned to the VSI.</p>\n\n<p>For more information see the following link:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/47308281/static-ip-address-allocation-for-public-virtual-server\">static ip address allocation for public virtual server</a></p>\n"}], "owner": {"reputation": 154, "user_id": 919396, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/7127e6c97fa53e31b0764d1f8b69eaf3?s=128&d=identicon&r=PG", "display_name": "Anupam Somani", "link": "https://stackoverflow.com/users/919396/anupam-somani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553555808, "creation_date": 1553551925, "question_id": 55347163, "link": "https://stackoverflow.com/questions/55347163/how-to-allocate-fixed-ip-address-during-create-softlayer-vsi", "title": "How to allocate fixed ip address during create softlayer vsi", "body": "<p>How to configure a Fixed ip address while creating a virtual server instead of assigning the dynamic IP address. I used the below code but its not working for me. please suggest a best way to configure the fixed ip address.</p>\n\n<p>code :</p>\n\n<pre><code>    sess := session.New(username, apikey)\n\n// Get the Virtual_Guest service\nservice := services.GetVirtualGuestService(sess)\n\n// Create a Virtual_Guest struct as a template\nvGuestTemplate := datatypes.Virtual_Guest{\n    // Set Creation values - use helpers from the sl package to set pointer values.\n    // Unset (nil) values are not sent\n    Hostname:                     sl.String(\"test-vim-02\"),\n    Domain:                       sl.String(\"test-ibm.com\"),\n    MaxMemory:                    sl.Int(4096),\n    StartCpus:                    sl.Int(4),\n    Datacenter:                   &amp;datatypes.Location{Name: sl.String(\"sjc04\")},\n    OperatingSystemReferenceCode: sl.String(\"UBUNTU_LATEST\"),\n    LocalDiskFlag:                sl.Bool(true),\n    PrivateNetworkOnlyFlag:       sl.Bool(true),\n    PrimaryBackendIpAddress:      sl.String(\"10.82.111.48\"),\n    PrimaryBackendNetworkComponent: &amp;datatypes.Virtual_Guest_Network_Component{\n        NetworkVlan: &amp;datatypes.Network_Vlan{\n            Id: sl.Int(24L),\n        },\n        PrimarySubnet: &amp;datatypes.Network_Subnet{\n            Id: sl.Int(19L),\n        },\n        MaxSpeed: sl.Int(1000),\n    },\n}\n\n// Tell the API to create the virtual guest\nnewGuest, err := service.CreateObject(&amp;vGuestTemplate)\n// optional error checking...\nif err != nil {\n    log.Fatal(err)\n}\n\n// Print the ID of the new guest.  Don't forget to dereference\nfmt.Printf(\"New guest %d created\", *newGuest.Id)\n</code></pre>\n"}, {"tags": ["go", "io"], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 4, "last_activity_date": 1553550123, "creation_date": 1553550123, "answer_id": 55346853, "question_id": 55346712, "link": "https://stackoverflow.com/questions/55346712/readstring-vs-readline/55346853#55346853", "title": "readString vs readLine", "body": "<blockquote>\n  <p>the way their code is written, they are still writing an entire line to their buffer</p>\n</blockquote>\n\n<p>Their code, yes. <em>Your</em> code might not need the whole line to be in memory at the same time. For example, your program is filtering a log file by request id, which is in the beginning of the line. It doesn't need to read the whole line which may be a few megabytes or more, only to reject it due to wrong request id. But with <code>ReadString</code> you don't have the luxury of choice.</p>\n"}, {"tags": [], "owner": {"reputation": 665, "user_id": 6312602, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-J2fMlfN4Ghc/AAAAAAAAAAI/AAAAAAAAACc/IIPzG0rPYuA/photo.jpg?sz=128", "display_name": "Jesse Amano", "link": "https://stackoverflow.com/users/6312602/jesse-amano"}, "is_accepted": false, "score": 2, "last_activity_date": 1553550651, "creation_date": 1553550651, "answer_id": 55346939, "question_id": 55346712, "link": "https://stackoverflow.com/questions/55346712/readstring-vs-readline/55346939#55346939", "title": "readString vs readLine", "body": "<p>I 'gree with Sergio. Also, have a look at <a href=\"https://golang.org/src/bufio/bufio.go?s=10112:10179#L374\" rel=\"nofollow noreferrer\">the current implementation</a> in the standard library. <code>ReadLine</code> calls <code>ReadSlice('\\n')</code> once, then runs through a few branches to make sure the appropriate sentinel values or errors are returned with the converted data. On the other hand, <code>ReadBytes</code> and <code>ReadString</code> both loop over repeated calls to <code>ReadSlice(delim)</code>, so it follows that they would necessarily be copying <em>at least</em> as much data into memory as <code>ReadLine</code>, and potentially much more <a href=\"https://golang.org/pkg/bufio/#Reader.ReadLine\" rel=\"nofollow noreferrer\">if the delimiter wasn't found</a> in the first call.</p>\n"}], "owner": {"reputation": 217, "user_id": 3531263, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9f88a5e80ece29301278dc328446cfd9?s=128&d=identicon&r=PG&f=1", "display_name": "Roosh", "link": "https://stackoverflow.com/users/3531263/roosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 0, "accepted_answer_id": 55346853, "answer_count": 2, "score": 0, "last_activity_date": 1553550651, "creation_date": 1553549518, "question_id": 55346712, "link": "https://stackoverflow.com/questions/55346712/readstring-vs-readline", "title": "readString vs readLine", "body": "<p>I am writing an application to read from a list of files, line by line and do some processing. I want to use as little RAM as I can. \nI came across this question <a href=\"https://stackoverflow.com/a/41741702/3531263\">https://stackoverflow.com/a/41741702/3531263</a></p>\n\n<p>Where the poster is saying readString uses more RAM than readLine and they have posted some code. \nWhat I don't understand is how one uses more RAM? Because ultimately, the way their code is written, they are still writing an entire line to their buffer. So would that not mean if they had just used readString, it would have been the same thing?</p>\n"}, {"tags": ["linux", "go", "terminal"], "comments": [{"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1553548535, "post_id": 55346323, "comment_id": 97417789, "body": "Looks like your program expects a fully functional terminal, but you are running it without a getty. I don&#39;t know enough about terminal emulation in linux, but I think you are missing a layer in there."}], "answers": [{"tags": [], "owner": {"reputation": 1024, "user_id": 506114, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/9f7e70182b11d67be153af13227d286e?s=128&d=identicon&r=PG", "display_name": "Walter", "link": "https://stackoverflow.com/users/506114/walter"}, "is_accepted": false, "score": 0, "last_activity_date": 1553565553, "creation_date": 1553565553, "answer_id": 55348806, "question_id": 55346323, "link": "https://stackoverflow.com/questions/55346323/unable-to-run-tview-application-configured-in-etc-inittab/55348806#55348806", "title": "unable to run tview application configured in /etc/inittab", "body": "<p>This works, but may be a bad idea.</p>\n\n<pre><code>c1:2345:respawn:/usr/sbin/systatus &lt;/dev/tty1\n</code></pre>\n\n<p>In any case, I need to disable the default ctrl+c handler so that this remains running.</p>\n"}], "owner": {"reputation": 1024, "user_id": 506114, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/9f7e70182b11d67be153af13227d286e?s=128&d=identicon&r=PG", "display_name": "Walter", "link": "https://stackoverflow.com/users/506114/walter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1553565553, "creation_date": 1553547544, "question_id": 55346323, "link": "https://stackoverflow.com/questions/55346323/unable-to-run-tview-application-configured-in-etc-inittab", "title": "unable to run tview application configured in /etc/inittab", "body": "<p>I am attempting to run an application using tview to show some telemetry.  The application runs fine when invoked from the cmdline as normal.  When I update my inittab to run the application:</p>\n\n<pre><code>c1:2345:respawn:/usr/sbin/systatus 38400 tty1 linux\n</code></pre>\n\n<p>That is when I see cannot open /dev/tty, No such device or address, a reference a line number where I am calling tview.Application.Run.  The file / device does exist.</p>\n\n<p>Any ideas as to how I might get around this?</p>\n\n<p>I am referencing this:\n<a href=\"https://stackoverflow.com/questions/21845871/golang-termbox-panic-open-dev-tty-no-such-device-or-address\">GoLang - termbox: panic: open /dev/tty: no such device or address</a></p>\n\n<p>even though I'm NOT using using termbox, the problem is the same.  Is it a fair assumption that anything I launch under /etc/inittab is non-interactive?  Is there anyway to disable the interactive part in termbox?  I don't see any public functions to do such a thing.</p>\n"}, {"tags": ["go", "google-admin-sdk", "google-directory-api"], "comments": [{"owner": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "edited": false, "score": 0, "creation_date": 1553566856, "post_id": 55345991, "comment_id": 97422507, "body": "Have you effectively followed these instructions particularly (a) the delegation step; (b) the &quot;note&quot;? When you write that you&#39;ve used the service account in Java, is that for a very similar purpose? i.e. does it work in Java but not Go? <a href=\"https://developers.google.com/admin-sdk/directory/v1/guides/delegation\" rel=\"nofollow noreferrer\">developers.google.com/admin-sdk/directory/v1/guides/delegati&zwnj;&#8203;on</a>"}, {"owner": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "edited": false, "score": 0, "creation_date": 1553574991, "post_id": 55345991, "comment_id": 97424075, "body": "I tried it but it&#39;s challenging for me to gain access to a G Suite domain. I think the Google Golang sample is incorrect. Please try <code>config.Email=&quot;[[Service Account Email]]</code> and <code>config.Subject=[[User-being-delegated Email Address]]</code>"}, {"owner": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "edited": false, "score": 0, "creation_date": 1553625441, "post_id": 55345991, "comment_id": 97452086, "body": "I&#39;m going to &quot;Ask a friend&quot; because I&#39;m unable to get this to work although I get 401s (Unauthorized). Will report back here with my experts&#39; guidance."}, {"owner": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "edited": false, "score": 0, "creation_date": 1553647637, "post_id": 55345991, "comment_id": 97459880, "body": "I have been unable to get this to work in Golang. I wrote an equivalent version in Python and it works. Continuing to investigate. <a href=\"https://gist.github.com/DazWilkin/dca8c3db8879765632d4c4be8d662074\" rel=\"nofollow noreferrer\">gist.github.com/DazWilkin/dca8c3db8879765632d4c4be8d662074</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11256403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6f49a7fbdf4583a50e0a945b2048b9?s=128&d=identicon&r=PG&f=1", "display_name": "ad34", "link": "https://stackoverflow.com/users/11256403/ad34"}, "is_accepted": false, "score": 0, "last_activity_date": 1553638672, "creation_date": 1553638672, "answer_id": 55366982, "question_id": 55345991, "link": "https://stackoverflow.com/questions/55345991/getting-400-invalid-grant-on-google-admin-sdk-api-with-golang-any-suggestions/55366982#55366982", "title": "Getting 400 invalid_grant on google admin sdk api with golang. Any suggestions?", "body": "<p>I got this working.  It seems like it may be a combination of things.  DazWilkin, yes I get the 401 unauthorized error when I switch around how I pass in my service account.  I made the following changes.</p>\n\n<ol>\n<li>Used Subject instead of Email in the configuration.</li>\n<li>Only used the  AdminDirectoryUserScope scope, instead of the AdminDirectoryUserReadonlyScope scope (or the combination of both).</li>\n<li>Included the Domain in the request.  I get a 400 Bad Request without it.</li>\n<li>I verified that Directory APIs were on from this link: <a href=\"https://developers.google.com/admin-sdk/directory/v1/quickstart/go\" rel=\"nofollow noreferrer\">https://developers.google.com/admin-sdk/directory/v1/quickstart/go</a> .  When I clicked on this link, it said that apis were already working.  I am using the same json credentials here that I am using in some production scripts written in other languages.  Meaning, I thought that this was already in place.  So I don't think I needed to do this step, but I will include it in case it is useful for others.</li>\n</ol>\n\n<p>Here is what my script looks like now:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n\n    \"golang.org/x/net/context\"\n    \"golang.org/x/oauth2/google\"\n    directory \"google.golang.org/api/admin/directory/v1\"\n)\n\nfunc main() {\n    serviceAccountFile := \"/credentials.json\"\n\n    serviceAccountJSON, err := ioutil.ReadFile(serviceAccountFile)\n    if err != nil {\n        log.Fatalf(\"Could not read service account credentials file, %s =&gt; {%s}\", serviceAccountFile, err)\n    }\n\n    // I want to use these options, but these cause a 401 unauthorized error\n    //  config, err := google.JWTConfigFromJSON(serviceAccountJSON,\n    //      directory.AdminDirectoryUserScope,\n    //      directory.AdminDirectoryUserReadonlyScope,\n    //  )\n    config, err := google.JWTConfigFromJSON(serviceAccountJSON,\n        directory.AdminDirectoryUserScope,\n    )\n\n    // Add the service account.\n    //config.Email = \"serviceaccount@domain.com\" // Don't use Email, use Subject.\n    config.Subject = \"serviceaccount@domain.com\"\n\n    srv, err := directory.New(config.Client(context.Background()))\n\n    if err != nil {\n        log.Fatalf(\"Could not create directory service client =&gt; {%s}\", err)\n    }\n\n    // Get the results.\n    usersReport, err := srv.Users.List().Domain(\"domain.com\").MaxResults(100).Do()\n    if err != nil {\n        log.Fatalf(\"Unable to retrieve users in domain: %v\", err)\n    }\n\n    // Report results.\n    if len(usersReport.Users) == 0 {\n        fmt.Print(\"No users found.\\n\")\n    } else {\n        fmt.Print(\"Users:\\n\")\n        for _, u := range usersReport.Users {\n            fmt.Printf(\"%s (%s)\\n\", u.PrimaryEmail, u.Name.FullName)\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1553653834, "last_edit_date": 1553653834, "creation_date": 1553653399, "answer_id": 55368845, "question_id": 55345991, "link": "https://stackoverflow.com/questions/55345991/getting-400-invalid-grant-on-google-admin-sdk-api-with-golang-any-suggestions/55368845#55368845", "title": "Getting 400 invalid_grant on google admin sdk api with golang. Any suggestions?", "body": "<p>Fixed!</p>\n\n<p>Thanks to Sal.</p>\n\n<p>Here's a working Golang example:</p>\n\n<p><a href=\"https://gist.github.com/DazWilkin/afb0413a25272dc7d855ebec5fcadcb6\" rel=\"nofollow noreferrer\">https://gist.github.com/DazWilkin/afb0413a25272dc7d855ebec5fcadcb6</a></p>\n\n<p><strong>NB</strong></p>\n\n<ul>\n<li>Line 24 --<code>config.Subject</code></li>\n<li>Line 31 --You'll need to include the CustomerId (<code>IDPID</code>) using this <a href=\"https://stackoverflow.com/a/35877597/609290\">link</a></li>\n</ul>\n\n<p>Here's a working Python example:</p>\n\n<p><a href=\"https://gist.github.com/DazWilkin/dca8c3db8879765632d4c4be8d662074\" rel=\"nofollow noreferrer\">https://gist.github.com/DazWilkin/dca8c3db8879765632d4c4be8d662074</a></p>\n"}], "owner": {"reputation": 1, "user_id": 11256403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6f49a7fbdf4583a50e0a945b2048b9?s=128&d=identicon&r=PG&f=1", "display_name": "ad34", "link": "https://stackoverflow.com/users/11256403/ad34"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 493, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1553653834, "creation_date": 1553545984, "question_id": 55345991, "link": "https://stackoverflow.com/questions/55345991/getting-400-invalid-grant-on-google-admin-sdk-api-with-golang-any-suggestions", "title": "Getting 400 invalid_grant on google admin sdk api with golang. Any suggestions?", "body": "<p>I am trying to work out a golang script that uses my service account to manage my google domain.  I get an error when I try to do a simple user list: 400 invalid_grant.  It appears that I am using my service account correctly(?), and my service account is a super admin.  I am using credentials in java code; so I know that it is valid.  Any thoughts?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n\n    \"golang.org/x/net/context\"\n    \"golang.org/x/oauth2/google\"\n    directory \"google.golang.org/api/admin/directory/v1\"\n)\n\nfunc main() {\n    serviceAccountFile := \"/credentials.json\"\n    serviceAccountJSON, err := ioutil.ReadFile(serviceAccountFile)\n    if err != nil {\n        log.Fatalf(\"Could not read service account credentials file, %s =&gt; {%s}\", serviceAccountFile, err)\n    }\n\n    config, err := google.JWTConfigFromJSON(serviceAccountJSON,\n        directory.AdminDirectoryUserScope,\n        directory.AdminDirectoryUserReadonlyScope,\n    )\n\n    // Add the service account.\n    config.Email = \"serviceaccount@domain.com\"\n\n    srv, err := directory.New(config.Client(context.Background()))\n    if err != nil {\n        log.Fatalf(\"Could not create directory service client =&gt; {%s}\", err)\n    }\n\n    // The next step fails with:\n    //2019/03/25 10:38:43 Unable to retrieve users in domain: Get https://www.googleapis.com/admin/directory/v1/users?alt=json&amp;maxResults=10&amp;orderBy=email&amp;prettyPrint=false: oauth2: cannot fetch token: 400 Bad Request\n    //Response: {\n    //  \"error\": \"invalid_grant\",\n    //  \"error_description\": \"Robot is missing a project number.\"\n    //}\n    //exit status 1\n    usersReport, err := srv.Users.List().MaxResults(10).OrderBy(\"email\").Do()\n    if err != nil {\n        log.Fatalf(\"Unable to retrieve users in domain: %v\", err)\n    }\n\n    if len(usersReport.Users) == 0 {\n        fmt.Print(\"No users found.\\n\")\n    } else {\n        fmt.Print(\"Users:\\n\")\n        for _, u := range usersReport.Users {\n            fmt.Printf(\"%s (%s)\\n\", u.PrimaryEmail, u.Name.FullName)\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "mobile", "websocket", "architecture"], "comments": [{"owner": {"reputation": 680, "user_id": 7274408, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jp2HB.png?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/7274408/brad"}, "edited": false, "score": 0, "creation_date": 1553545498, "post_id": 55345756, "comment_id": 97416601, "body": "this is a good example to start with, if you&#39;re think about building a chat system over websockets. <a href=\"https://github.com/gorilla/websocket/tree/master/examples/chat\" rel=\"nofollow noreferrer\">github.com/gorilla/websocket/tree/master/examples/chat</a>"}], "owner": {"reputation": 511, "user_id": 410974, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/be1b111f63597b1b2bb8ed319a0cb272?s=128&d=identicon&r=PG", "display_name": "nickneedsaname", "link": "https://stackoverflow.com/users/410974/nickneedsaname"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1553544988, "creation_date": 1553544988, "question_id": 55345756, "link": "https://stackoverflow.com/questions/55345756/websockets-one-handler-to-rule-them-all-best-case-w-backups", "title": "Websockets: One handler to rule them all? Best case w/ backups?", "body": "<p>I'm working on making an iOS app that does a few things, some of which would benefit from real-time data streams (like chat)</p>\n\n<p>For right now I have a few handlers on my server, one of them gets all the threads a user has access to, another can get messages (offset, all, time-ranged, etc.) for a thread.  When a user sends a message to a thread, I get all the listeners for the thread and send them a push notification.  This works, but I was reading through the APNS docs and it says \"dont do more than 3/hr\" and I'm definitely doing more than 3/hr.  </p>\n\n<p>So I'm thinking I move to websockets.  I know how to synchronize pub/subs across machines via redis so I'm not worried about that, I'm more stuck on the following:</p>\n\n<p>If I start to bring websockets into the project, should I just pump all the information App &lt;-> Server through the websocket?  Create a thread -> Don't POST, just send a message along the socket.  Get a message -> Don't poll or send notification, just send a message along the socket.  Literally anything -> Don't make a request, just send a message along the socket.</p>\n\n<p>Right now I'm leaning towards loading initial state and bulk data via normal HTTP URLs (eg: Create a thread, load the last 20 messages for thread XYZ), but for data that needs to be pushed and received in real time (eg: Chat Message send/recv) do that via a websocket.</p>\n"}, {"tags": ["go", "kubernetes-helm"], "comments": [{"owner": {"reputation": 665, "user_id": 6312602, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-J2fMlfN4Ghc/AAAAAAAAAAI/AAAAAAAAACc/IIPzG0rPYuA/photo.jpg?sz=128", "display_name": "Jesse Amano", "link": "https://stackoverflow.com/users/6312602/jesse-amano"}, "edited": false, "score": 0, "creation_date": 1553544625, "post_id": 55345358, "comment_id": 97416212, "body": "<a href=\"https://github.com/search?l=&amp;o=desc&amp;q=yaml+language%3AGo&amp;s=stars&amp;type=Repositories\" rel=\"nofollow noreferrer\">Search GitHub</a> for packages/libraries that use your language to interact with the format you&#39;re interested in."}, {"owner": {"reputation": 665, "user_id": 6312602, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-J2fMlfN4Ghc/AAAAAAAAAAI/AAAAAAAAACc/IIPzG0rPYuA/photo.jpg?sz=128", "display_name": "Jesse Amano", "link": "https://stackoverflow.com/users/6312602/jesse-amano"}, "edited": false, "score": 0, "creation_date": 1553544772, "post_id": 55345358, "comment_id": 97416277, "body": "Also, Go templating follows the same rules as other Go packages: it can&#39;t see struct fields that don&#39;t start with a rune Unicode defines as upper-case. You would need to name your field <code>Config</code> instead of <code>config</code> to be able to use it in a template."}, {"owner": {"reputation": 265, "user_id": 700552, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5312791b4c4b1b4e21de0c4ce3003acd?s=128&d=identicon&r=PG", "display_name": "Luiz Aoqui", "link": "https://stackoverflow.com/users/700552/luiz-aoqui"}, "reply_to_user": {"reputation": 665, "user_id": 6312602, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-J2fMlfN4Ghc/AAAAAAAAAAI/AAAAAAAAACc/IIPzG0rPYuA/photo.jpg?sz=128", "display_name": "Jesse Amano", "link": "https://stackoverflow.com/users/6312602/jesse-amano"}, "edited": false, "score": 0, "creation_date": 1553574509, "post_id": 55345358, "comment_id": 97423974, "body": "Thanks for the tips @JesseAmano. I read a bunch of Helm charts, but didn&#39;t see anything similar to what I am looking for. Regarding the case of <code>config</code> vs <code>Config</code>, it might be helm specific, but the variable is part of an outer variable called <code>Value</code>, so there is no problem there."}], "answers": [{"tags": [], "owner": {"reputation": 265, "user_id": 700552, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5312791b4c4b1b4e21de0c4ce3003acd?s=128&d=identicon&r=PG", "display_name": "Luiz Aoqui", "link": "https://stackoverflow.com/users/700552/luiz-aoqui"}, "is_accepted": true, "score": 4, "last_activity_date": 1553574851, "creation_date": 1553574851, "answer_id": 55349907, "question_id": 55345358, "link": "https://stackoverflow.com/questions/55345358/convert-yaml-string-to-dict-in-helm-template/55349907#55349907", "title": "Convert YAML string to dict in Helm template", "body": "<p>In the end I was able to do something like this:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>{{ $lines := splitList \"\\n\" .Values.config -}}\n{{- range $lines }}\n{{- if not (. | trim | empty) -}}\n{{- $kv := . | splitn \":\" 2 -}}\n{{ printf \"MY_APP_%s: %s\" $kv._0 ($kv._1 | trim | quote) | indent 2 }}\n{{ end -}}\n{{- end -}}\n</code></pre>\n\n<p>I had a hard time getting the <code>{{-</code> vs <code>{{</code> right, and <code>helm install --debug --dry-run .</code> help a lot in this part.</p>\n\n<p>It's kind of messy, so I would be very interested in seeing if anyone has a better solution.</p>\n"}, {"tags": [], "owner": {"reputation": 49, "user_id": 8902893, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qm7fP.jpg?s=128&g=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/8902893/vlad"}, "is_accepted": false, "score": 0, "last_activity_date": 1589997552, "last_edit_date": 1589997552, "creation_date": 1589997097, "answer_id": 61919638, "question_id": 55345358, "link": "https://stackoverflow.com/questions/55345358/convert-yaml-string-to-dict-in-helm-template/61919638#61919638", "title": "Convert YAML string to dict in Helm template", "body": "<p>If You need to work with more tricky YAML (map in a map) You can use this:</p>\n\n<h3>List Handler (list to comma separated string)</h3>\n\n<pre><code>{{- define \"helm-toolkit.utils.joinListWithComma\" -}}\n{{- $local := dict \"first\" true -}}\n{{- range $k, $v := . -}}{{- if not $local.first -}}, {{ end -}}{{ $v -}}{{- $_ := set $local \"first\" false -}}{{- end -}}\n{{- end -}}\n</code></pre>\n\n<h3>Convert Yaml dict to the properties-like look</h3>\n\n<pre><code>{{- define \"utils.yaml2properties\" }}\n{{- $yaml := . -}}\n{{- range $key, $value := $yaml }}\n  {{- if kindIs \"map\" $value -}}\n{{ $top:=$key }}\n  {{- range $key, $value := $value }}\n    {{- if kindIs \"map\" $value }}\n    {{- $newTop := printf \"%s.%s\" $top $key }}\n{{- include \"utils.yaml2properties\" (dict $newTop $value) }}\n    {{- else if kindIs \"slice\" $value }}\n{{ $top }}.{{ $key }}={{ include \"helm-toolkit.utils.joinListWithComma\" $value }}\n    {{- else }}\n{{ $top }}.{{ $key }}={{ $value }}\n    {{- end }}\n  {{- end }}\n  {{- else if kindIs \"slice\" $value }}\n{{ $key }}={{ include \"helm-toolkit.utils.joinListWithComma\" $value }}\n  {{- else }}\n{{ $key }}={{ $value }}\n  {{- end }}\n{{- end }}\n{{- end }}\n</code></pre>\n\n<h3>Use (example from K8s configMap)</h3>\n\n<pre><code>{{- define \"config.yaml\" }}\nvault.pki:\n  enabled: {{.Values.vault.pki.enabled}}\n  role: idverify\n  common-name: idverify\n  role:\n    map:\n      list:\n        - one\n        - two\n{{- end }}\n\ndata:\n  bootstrap.properties: |\n{{ (include \"utils.yaml2properties\" (include \"config.yaml\" . | fromYaml )) | indent 4 }}\n\n\n</code></pre>\n"}], "owner": {"reputation": 265, "user_id": 700552, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5312791b4c4b1b4e21de0c4ce3003acd?s=128&d=identicon&r=PG", "display_name": "Luiz Aoqui", "link": "https://stackoverflow.com/users/700552/luiz-aoqui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3290, "favorite_count": 0, "accepted_answer_id": 55349907, "answer_count": 2, "score": 1, "last_activity_date": 1589997552, "creation_date": 1553543212, "question_id": 55345358, "link": "https://stackoverflow.com/questions/55345358/convert-yaml-string-to-dict-in-helm-template", "title": "Convert YAML string to dict in Helm template", "body": "<p>I am creating a chart for a project that has a binary that when executed generates a configuration file in YAML format that looks like this:</p>\n\n<pre><code>---\nPARAM_1: value1\nPARAM_2: value2\n</code></pre>\n\n<p>My chart needs to read this file and and load all of its values into environment variables in a container, so I created a variable <code>config</code> in my <code>values.yaml</code> file and when the chart is installed I am passing the file content using <code>--set-file</code>:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>helm install &lt;CHART&gt; --set-file config=/path/to/yaml/config/file\n</code></pre>\n\n<p>Next I create a <code>ConfigMap</code> withe the value of <code>.Values.config</code>:</p>\n\n<pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\n  ...\ndata:\n  {{ .Values.config }}\n</code></pre>\n\n<p>The problem I am having is that I need to do two things with values of <code>config</code>:</p>\n\n<ul>\n<li>prefix all keys with a predefined value (so in the example above I would <code>MY_APP_PARAM_1</code> as key)</li>\n<li>make sure the values are all string, otherwise the <code>ConfigMap</code> will fail</li>\n</ul>\n\n<p>How can I parse the value of <code>.Values.config</code> in my template as a <code>dict</code> so that I can use a <code>range</code> loop do these changes?</p>\n"}, {"tags": ["docker", "go", "dockerfile"], "comments": [{"owner": {"reputation": 1914, "user_id": 9811969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/184e2e46b8d8b8c483c85589709b8563?s=128&d=identicon&r=PG&f=1", "display_name": "Nik", "link": "https://stackoverflow.com/users/9811969/nik"}, "edited": false, "score": 0, "creation_date": 1553546183, "post_id": 55343787, "comment_id": 97416865, "body": "Does this command <code>go install .&#47;accounting&#47;server</code> work for you when you run it locally?"}, {"owner": {"reputation": 220, "user_id": 10176454, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZmxR2.png?s=128&g=1", "display_name": "zergon321", "link": "https://stackoverflow.com/users/10176454/zergon321"}, "reply_to_user": {"reputation": 1914, "user_id": 9811969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/184e2e46b8d8b8c483c85589709b8563?s=128&d=identicon&r=PG&f=1", "display_name": "Nik", "link": "https://stackoverflow.com/users/9811969/nik"}, "edited": false, "score": 0, "creation_date": 1553548820, "post_id": 55343787, "comment_id": 97417912, "body": "@Nik yes, it does."}, {"owner": {"reputation": 1655, "user_id": 1201013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/764c0373fe244be19db5167edd1a206d?s=128&d=identicon&r=PG", "display_name": "saurcery", "link": "https://stackoverflow.com/users/1201013/saurcery"}, "edited": false, "score": 0, "creation_date": 1553549992, "post_id": 55343787, "comment_id": 97418353, "body": "Probably you want to replace ADD with COPY command in Dockerfile &amp; also doublc check if there is any .dockerignore file preventing from copying server package."}], "answers": [{"tags": [], "owner": {"reputation": 220, "user_id": 10176454, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZmxR2.png?s=128&g=1", "display_name": "zergon321", "link": "https://stackoverflow.com/users/10176454/zergon321"}, "is_accepted": true, "score": 0, "last_activity_date": 1553962578, "last_edit_date": 1553962578, "creation_date": 1553961911, "answer_id": 55433285, "question_id": 55343787, "link": "https://stackoverflow.com/questions/55343787/cannot-create-an-image-for-golang-app-using-docker/55433285#55433285", "title": "Cannot create an image for Golang app using Docker", "body": "<p>I've found a solution. Everything went wrong because I used this command from the root directory of the project:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ docker build -t accounting_server ./accounting\n</code></pre>\n\n<p>And <code>multiService/accounting</code> was my building directory, so file hierarchy in the image looked like that:</p>\n\n<pre><code>/go/src/grpcProjects/multiService\n/go/src/grpcProjects/multiService/server\n/go/src/grpcProjects/multiService/server/service\n/go/src/grpcProjects/multiService/server/service/accounting.go\n/go/src/grpcProjects/multiService/server/main.go\n/go/src/grpcProjects/multiService/proto\n/go/src/grpcProjects/multiService/proto/accounting.proto\n/go/src/grpcProjects/multiService/proto/accounting.pb.go\n/go/src/grpcProjects/multiService/Dockerfile\n</code></pre>\n\n<p><strong>Docker</strong> just copied the contents of local <code>/multiService/accounting</code> to <code>/multiService</code> directory of the image. So I had to change <strong>Dockerfile</strong> a bit:</p>\n\n<pre><code>FROM golang:1.10.4\n\nADD . /go/src/grpcProjects/multiService\n\nRUN go get github.com/golang/protobuf/proto\nRUN go get golang.org/x/net/context\nRUN go get google.golang.org/grpc\nRUN go install grpcProjects/multiService/accounting/server\n\nENTRYPOINT [ \"/go/bin/server\" ]\n\nEXPOSE 8080\n</code></pre>\n\n<p>And I built my container with the next command:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ docker build -t accounting_server -f ./accounting/Dockerfile .\n</code></pre>\n\n<p>Still from the root directory so everything was copied to the image properly.</p>\n\n<p>Thanks to everyone who replied!</p>\n"}], "owner": {"reputation": 220, "user_id": 10176454, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZmxR2.png?s=128&g=1", "display_name": "zergon321", "link": "https://stackoverflow.com/users/10176454/zergon321"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 55433285, "answer_count": 1, "score": 0, "last_activity_date": 1553962578, "creation_date": 1553536165, "question_id": 55343787, "link": "https://stackoverflow.com/questions/55343787/cannot-create-an-image-for-golang-app-using-docker", "title": "Cannot create an image for Golang app using Docker", "body": "<p>I try to create an image for my Golang application, but Docker just writes:</p>\n\n<pre><code>Step 7/9 : RUN go install ./accounting/server\n ---&gt; Running in f998ba6a5efb\ncan't load package: package grpcProjects/multiService/accounting/server: cannot find package \"grpcProjects/multiService/accounting/server\" in any of:\n        /usr/local/go/src/grpcProjects/multiService/accounting/server (from $GOROOT)\n        /go/src/grpcProjects/multiService/accounting/server (from $GOPATH)\n</code></pre>\n\n<p>My Dockerfile:</p>\n\n<pre><code>FROM golang:1.10.4\n\nADD . /go/src/grpcProjects/multiService\n\nWORKDIR /go/src/grpcProjects/multiService\n\nRUN go get github.com/golang/protobuf/proto\nRUN go get golang.org/x/net/context\nRUN go get google.golang.org/grpc\nRUN go install ./accounting/server\n\nENTRYPOINT [ \"/go/bin/server\" ]\n\nEXPOSE 8080\n</code></pre>\n\n<p>Project structure:</p>\n\n<p><a href=\"https://i.stack.imgur.com/U9Eei.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/U9Eei.png\" alt=\"enter image description here\"></a></p>\n\n<p>How to solve this problem?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1553533200, "post_id": 55342888, "comment_id": 97410745, "body": "You&#39;re using a constant mathematical calculation, if it <i>didn&#39;t</i> return the same value every time, that would be a HUGE problem - the same as if <code>1 + 1</code> didn&#39;t always evaluate to <code>2</code>. If you want a random probabilistic chance, you&#39;ll need to use an RNG, e.g. <a href=\"https://golang.org/pkg/math/rand/\" rel=\"nofollow noreferrer\"><code>math&#47;rand</code></a>."}], "answers": [{"comments": [{"owner": {"reputation": 875, "user_id": 1118461, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WFNAP.png?s=128&g=1", "display_name": "Zed_Blade", "link": "https://stackoverflow.com/users/1118461/zed-blade"}, "edited": false, "score": 1, "creation_date": 1553533740, "post_id": 55342940, "comment_id": 97411002, "body": "Ah there&#39;s my error.. I used <code>1&#47;1000000</code> rather than <code>1.0&#47;1000000</code>"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 3, "last_activity_date": 1553533743, "last_edit_date": 1553533743, "creation_date": 1553533205, "answer_id": 55342940, "question_id": 55342888, "link": "https://stackoverflow.com/questions/55342888/golang-1-in-a-million-probability/55342940#55342940", "title": "Golang 1 in a million probability", "body": "<blockquote>\n  <p>the expression <code>math.Pow(1-(1/1000000),1000000)</code> however this keeps\n  returning me <code>1</code> constantly, which doesn't seem correct.</p>\n</blockquote>\n\n<hr>\n\n<p><code>1/1000000</code> is zero. Integer division truncates towards zero.</p>\n\n<p>Use floating-point, 1.0 not 1:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n)\n\nfunc main() {\n    p := math.Pow(1-(1/1000000), 1000000)\n    fmt.Println(p)\n    p = math.Pow(1-(1.0/1000000), 1000000)\n    fmt.Println(p)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/ZhUAe6imaNv\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ZhUAe6imaNv</a></p>\n\n<p>Output:</p>\n\n<pre><code>1\n0.36787925722078507\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "is_accepted": true, "score": 4, "last_activity_date": 1553534705, "last_edit_date": 1553534705, "creation_date": 1553534255, "answer_id": 55343252, "question_id": 55342888, "link": "https://stackoverflow.com/questions/55342888/golang-1-in-a-million-probability/55343252#55343252", "title": "Golang 1 in a million probability", "body": "<p>Go standard library has a <code>rand</code> package and it has <code>Intn()</code> function that will give you a pseudo-random number in the range of [0 , n). So to fire an event with probability of 1/1000000 you could do something like </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n)\n\nfunc main() {\n    n := rand.Intn(1000000)\n    if n == 154397 {\n        fmt.Println(\"I am a lucky bastard!\")\n    } else {\n        fmt.Println(\"I am not\")\n    }\n}\n</code></pre>\n\n<p>Needless to say that 154397 could be replaced with any other integer in range. <a href=\"https://play.golang.org/p/YIyIzeX4UP7\" rel=\"nofollow noreferrer\">Link to playground</a></p>\n"}], "owner": {"reputation": 875, "user_id": 1118461, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WFNAP.png?s=128&g=1", "display_name": "Zed_Blade", "link": "https://stackoverflow.com/users/1118461/zed-blade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 1, "accepted_answer_id": 55343252, "answer_count": 2, "score": -1, "last_activity_date": 1553534705, "creation_date": 1553533036, "question_id": 55342888, "link": "https://stackoverflow.com/questions/55342888/golang-1-in-a-million-probability", "title": "Golang 1 in a million probability", "body": "<p>I'm learning some Go and I'm doing some interview exercises. I have one exercice where one is asked to perform some operation randomly with a 1 in a million probability.</p>\n\n<p>Let's say that I want to <code>return true</code> once in a million.</p>\n\n<p>If my math is still right (and Google too), I would calculate this with the expression <code>math.Pow(1-(1/1000000),1000000)</code> however this keeps returning me <code>1</code> constantly, which doesn't seem correct.</p>\n\n<p>Given this description, how could I ensure that I'd return <code>true</code> only once in a million? This sounds trivial but I'm really struggling with it.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1553532325, "post_id": 55342100, "comment_id": 97410264, "body": "always do error checking"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1553540730, "post_id": 55342100, "comment_id": 97414364, "body": "side-note: avoid the use of <code>new</code> in cases like this. It obscures the fact that you&#39;re creating a pointer variable, and it doens&#39;t allow for you to initialise fields in a single statement. use <code>p := AnsInstance{}</code> or <code>p := &amp;AnsInstance{}</code> instead"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 3069488, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d3fee760e2eb6232a160c54d6359b990?s=128&d=identicon&r=PG&f=1", "display_name": "user3069488", "link": "https://stackoverflow.com/users/3069488/user3069488"}, "edited": false, "score": 0, "creation_date": 1553530895, "post_id": 55342213, "comment_id": 97409371, "body": "I updated post with additionall information Isnt &quot;new&quot; creating all struct fields?"}, {"owner": {"reputation": 1059, "user_id": 1982418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbe9fddd5823aa8ae6a41ec889f0f581?s=128&d=identicon&r=PG&f=1", "display_name": "sh.seo", "link": "https://stackoverflow.com/users/1982418/sh-seo"}, "reply_to_user": {"reputation": 65, "user_id": 3069488, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d3fee760e2eb6232a160c54d6359b990?s=128&d=identicon&r=PG&f=1", "display_name": "user3069488", "link": "https://stackoverflow.com/users/3069488/user3069488"}, "edited": false, "score": 0, "creation_date": 1553531655, "post_id": 55342213, "comment_id": 97409868, "body": "If you do not understand, check the value in this way. comment update."}, {"owner": {"reputation": 65, "user_id": 3069488, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d3fee760e2eb6232a160c54d6359b990?s=128&d=identicon&r=PG&f=1", "display_name": "user3069488", "link": "https://stackoverflow.com/users/3069488/user3069488"}, "edited": false, "score": 0, "creation_date": 1553531958, "post_id": 55342213, "comment_id": 97410067, "body": "When i added pointer to empty variable in NewAnsInstance method it helped but below solution i think is better for me - to not use pointer in struct definition."}], "tags": [], "owner": {"reputation": 1059, "user_id": 1982418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbe9fddd5823aa8ae6a41ec889f0f581?s=128&d=identicon&r=PG&f=1", "display_name": "sh.seo", "link": "https://stackoverflow.com/users/1982418/sh-seo"}, "is_accepted": false, "score": 2, "last_activity_date": 1553531649, "last_edit_date": 1553531649, "creation_date": 1553530831, "answer_id": 55342213, "question_id": 55342100, "link": "https://stackoverflow.com/questions/55342100/how-to-execute-method-for-struct-which-is-field-for-other-struct/55342213#55342213", "title": "How to execute method for struct which is field for other struct", "body": "<p>maybe is hostsFile' nil??</p>\n\n<pre><code>func main() {\n    ansInstance := NewAnsInstance(\"name\", \"url\", \"path\")\n\n    // add code and check hostsFile\n    fmt.Printf(\"%+v\\n\", ansInstance)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 3069488, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d3fee760e2eb6232a160c54d6359b990?s=128&d=identicon&r=PG&f=1", "display_name": "user3069488", "link": "https://stackoverflow.com/users/3069488/user3069488"}, "edited": false, "score": 0, "creation_date": 1553531837, "post_id": 55342354, "comment_id": 97409992, "body": "That was it i removed pointer type from AnsInstance struct and it is working. Thank You."}], "tags": [], "owner": {"reputation": 123, "user_id": 3458295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/826e33c9b1bca10ce2a77d597f0e5a81?s=128&d=identicon&r=PG&f=1", "display_name": "ragrawal", "link": "https://stackoverflow.com/users/3458295/ragrawal"}, "is_accepted": true, "score": 1, "last_activity_date": 1553531283, "creation_date": 1553531283, "answer_id": 55342354, "question_id": 55342100, "link": "https://stackoverflow.com/questions/55342100/how-to-execute-method-for-struct-which-is-field-for-other-struct/55342354#55342354", "title": "How to execute method for struct which is field for other struct", "body": "<p>Since hostsFile *HostsFile is of type pointer, the default/zero value while creating an instance of the struct will be nil. So calling methods on nil will panic.</p>\n"}], "owner": {"reputation": 65, "user_id": 3069488, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d3fee760e2eb6232a160c54d6359b990?s=128&d=identicon&r=PG&f=1", "display_name": "user3069488", "link": "https://stackoverflow.com/users/3069488/user3069488"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 55342354, "answer_count": 2, "score": 0, "last_activity_date": 1553539333, "creation_date": 1553530430, "last_edit_date": 1553539333, "question_id": 55342100, "link": "https://stackoverflow.com/questions/55342100/how-to-execute-method-for-struct-which-is-field-for-other-struct", "title": "How to execute method for struct which is field for other struct", "body": "<p>I created such 2 structs:</p>\n\n<pre><code>type HostsFile struct {\n    path    string\n    masters string\n    nodes   string\n}\n\ntype AnsInstance struct {\n    name      string\n    url       string\n    yamlPath  string\n    user      string\n    pass      string\n    branch    string\n    hostsFile *HostsFile\n}\n</code></pre>\n\n<p><code>HostsFile</code> struct have such methods:</p>\n\n<pre><code>func (p *HostsFile) SetMasters(masters string) {\n    p.masters = masters\n}\n\nfunc (p *HostsFile) SetNodes(nodes string) {\n    p.nodes = nodes\n}\n</code></pre>\n\n<p>and <code>AnsInstance</code> has such one which is using methods from <code>HostFile</code> struct:</p>\n\n<pre><code>func (p *AnsInstance) PrepInstExec(masters string, nodes string) {\n    p.hostsFile.SetMasters(masters)\n    p.hostsFile.SetNodes(nodes)\n    p.hostsFile.GenerateHostsFile()\n}\n</code></pre>\n\n<p>When im executing <code>PrepInstExec</code> in such way:</p>\n\n<pre><code>ansInstance.PrepInstExec(\"lalala,fafafaf\", \"bakuka,matata\")\n</code></pre>\n\n<p>Im getting error:</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x18 pc=0x4ccba3]\n\ngoroutine 1 [running]:\ncard-installer/ansexec.(*HostsFile).SetMasters(...)\n        /home/holo/go/src/card-installer/ansexec/ansexec.go:19\ncard-installer/ansexec.(*AnsInstance).PrepInstExec(0xc0000c5e90, 0x6d1a2c, 0xe, 0x6d15b9, 0xd)\n        /home/holo/go/src/card-installer/ansexec/ansexec.go:145 +0x53\nmain.main()\n        /home/holo/go/src/card-installer/main.go:101 +0x84e\nexit status 2\n</code></pre>\n\n<p>What am i doing wrong? Is there posibility to exec methods of one struct which is embedded to other?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I am creating new <code>AnsInstance</code> in such way:</p>\n\n<pre><code>func NewAnsInstance(name string, url string, path string) *AnsInstance {\n    p := new(AnsInstance)\n    p.name = name\n    p.url = url\n    p.yamlPath = path\n    p.branch = \"master\"\n    return p\n}\n</code></pre>\n"}, {"tags": ["go", "stream", "p2p", "libp2p"], "answers": [{"tags": [], "owner": {"reputation": 2702, "user_id": 2923336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LmjCO.png?s=128&g=1", "display_name": "Francois", "link": "https://stackoverflow.com/users/2923336/francois"}, "is_accepted": true, "score": 0, "last_activity_date": 1553532168, "creation_date": 1553532168, "answer_id": 55342627, "question_id": 55340599, "link": "https://stackoverflow.com/questions/55340599/how-to-handle-buffered-read-write-streams-to-peers-in-golang-using-libp2p/55342627#55342627", "title": "How to handle buffered Read-Write Stream(s) to peers in golang using libp2p?", "body": "<p>This is what <code>readData</code> does from your tuto: </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func readData(rw *bufio.ReadWriter) {\n    for {\n        str, err := rw.ReadString('\\n')\n        if err != nil {\n            fmt.Println(\"Error reading from buffer\")\n            panic(err)\n        }\n\n        if str == \"\" {\n            return\n        }\n        if str != \"\\n\" {\n            // Green console colour:    \\x1b[32m\n            // Reset console colour:    \\x1b[0m\n            fmt.Printf(\"\\x1b[32m%s\\x1b[0m&gt; \", str)\n        }\n\n    }\n}\n</code></pre>\n\n<p>It basically reads the stream until it finds a <code>\\n</code>, which is a new line character and prints it to stdout.</p>\n\n<p>The <code>writeData</code>:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func writeData(rw *bufio.ReadWriter) {\n    stdReader := bufio.NewReader(os.Stdin)\n\n    for {\n        fmt.Print(\"&gt; \")\n        sendData, err := stdReader.ReadString('\\n')\n        if err != nil {\n            fmt.Println(\"Error reading from stdin\")\n            panic(err)\n        }\n\n        _, err = rw.WriteString(fmt.Sprintf(\"%s\\n\", sendData))\n        if err != nil {\n            fmt.Println(\"Error writing to buffer\")\n            panic(err)\n        }\n        err = rw.Flush()\n        if err != nil {\n            fmt.Println(\"Error flushing buffer\")\n            panic(err)\n        }\n    }\n}\n</code></pre>\n\n<p>It reads data from stdin, so you can type messages, and writes this to the <code>rw</code> and flushes it. This kind of enables a sort of tty chat.\nIf it works correctly you should be able to start at least two peers and communicate through stdin. </p>\n\n<p>You shouldn't recreate new <code>rw</code> for new content. You can reuse the existing one until you close it. From the tuto's code, a new <code>rw</code> is created for each new peer. </p>\n\n<hr>\n\n<p>Now a tcp stream does not work as an http request with a request and a response corresponding to that request. So if you want to send something, and get the response to that specific question, you could send a message of this format: </p>\n\n<pre><code>[8 bytes unique ID][content of the message]\\n\n</code></pre>\n\n<p>And when you receive it, you parse it, prepare the response and send it with the same format, so that you can match messages, creating a sort of request/response communication.</p>\n\n<p>You can do something like that:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func sendMsg(rw *bufio.ReadWriter, id int64, content []byte) error {\n        // allocate our slice of bytes with the correct size 4 + size of the message + 1\n        msg := make([]byte, 4 + len(content) + 1)\n\n        // write id \n        binary.LittleEndian.PutUint64(msg, uint64(id))\n\n        // add content to msg\n        copy(msg[13:], content)\n\n        // add new line at the end\n        msg[len(msg)-1] = '\\n'\n\n        // write msg to stream\n        _, err = rw.Write(msg)\n        if err != nil {\n            fmt.Println(\"Error writing to buffer\")\n            return err\n        }\n        err = rw.Flush()\n        if err != nil {\n            fmt.Println(\"Error flushing buffer\")\n            return err\n        }\n        return nil\n}\n\nfunc readMsg(rw *bufio.ReadWriter) {\n    for {\n        // read bytes until new line\n        msg, err := rw.ReadBytes('\\n')\n        if err != nil {\n            fmt.Println(\"Error reading from buffer\")\n            continue\n        }\n\n        // get the id\n        id := int64(binary.LittleEndian.Uint64(msg[0:8]))\n\n        // get the content, last index is len(msg)-1 to remove the new line char\n        content := string(msg[8:len(msg)-1])\n\n        if content != \"\" {\n            // we print [message ID] content\n            fmt.Printf(\"[%d] %s\", id, content)\n        }\n\n        // here you could parse your message\n        // and prepare a response\n        response, err := prepareResponse(content)\n        if err != nil {\n            fmt.Println(\"Err while preparing response: \", err)\n            continue\n        }\n\n        if err := s.sendMsg(rw, id, response); err != nil {\n            fmt.Println(\"Err while sending response: \", err)\n            continue\n        }\n    }\n}\n</code></pre>\n\n<p>Hope this helps. </p>\n"}], "owner": {"reputation": 35, "user_id": 11202238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49afff65f28b187b51c6b02e905adfea?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/11202238/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 647, "favorite_count": 0, "accepted_answer_id": 55342627, "answer_count": 1, "score": 1, "last_activity_date": 1553532168, "creation_date": 1553525650, "question_id": 55340599, "link": "https://stackoverflow.com/questions/55340599/how-to-handle-buffered-read-write-streams-to-peers-in-golang-using-libp2p", "title": "How to handle buffered Read-Write Stream(s) to peers in golang using libp2p?", "body": "<p>I am following this tutorial:</p>\n\n<p><a href=\"https://github.com/libp2p/go-libp2p-examples/tree/master/chat-with-mdns\" rel=\"nofollow noreferrer\">https://github.com/libp2p/go-libp2p-examples/tree/master/chat-with-mdns</a></p>\n\n<p>In a short form, it:</p>\n\n<ol>\n<li>configures a p2p host</li>\n<li>sets a default handler function for incoming connections\n(3. not necessary) </li>\n<li>and opens a stream to the connecting peers:</li>\n</ol>\n\n<p><code>stream, err := host.NewStream(ctx, peer.ID, protocol.ID(cfg.ProtocolID))</code></p>\n\n<p>Afterwards, there is a buffer stream/read-write variable created:</p>\n\n<p><code>rw := bufio.NewReadWriter(bufio.NewReader(stream), bufio.NewWriter(stream))</code></p>\n\n<p>Now this stream is used to send and receive data between the peers. This is done using two goroutine functions that have rw as an input: </p>\n\n<p><code>go writeData(rw)</code>\n<code>go readData(rw)</code></p>\n\n<p>My problems are:</p>\n\n<ol>\n<li><p>I want to send data to my peers and need feedback from them:\ne.g. in rw there is a question and they need to answer yes/no. How can I transfer back this answer and process it (enable some interaction)?</p></li>\n<li><p>The data I want to send in rw is not always the same. Sometimes it's a string containing only a name, sometimes it's a string containing a whole block etc. How can I distinguish? </p></li>\n</ol>\n\n<p>I thought about those solutions. But I am new to golang, so maybe you have a better one:</p>\n\n<ul>\n<li><p>do I need a new stream for every different content:\n<code>stream, err := host.NewStream(ctx, peer.ID, protocol.ID(cfg.ProtocolID))</code></p></li>\n<li><p>do I need to open more buffered rw varibales for every different content:\n<code>rw := bufio.NewReadWriter(bufio.NewReader(stream), bufio.NewWriter(stream))</code></p></li>\n<li><p>are there any other solutions?</p></li>\n</ul>\n\n<p>Thank you for any help to solve this!!</p>\n"}, {"tags": ["go", "chain-of-responsibility"], "answers": [{"tags": [], "owner": {"reputation": 579, "user_id": 11206879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bS2D6.png?s=128&g=1", "display_name": "Pan Ke", "link": "https://stackoverflow.com/users/11206879/pan-ke"}, "is_accepted": false, "score": 1, "last_activity_date": 1553523912, "creation_date": 1553523912, "answer_id": 55340049, "question_id": 55339431, "link": "https://stackoverflow.com/questions/55339431/chain-of-responsibility-how-to-call-certain-handler-when-current-is-failed/55340049#55340049", "title": "Chain of responsibility - how to call certain handler when current is failed", "body": "<p>I think you can do this</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type AskEmail struct {\n    next Handler\n}\n\nfunc (h *AskEmail) Request(flag bool) {\n    fmt.Println(\"AskEmail.Request()\")\n    if flag {\n        h.next.Request(flag)\n    }\n}\n\ntype ValidateEmail struct {\n    next Handler\n    prev Handler\n}\n\nfunc (h *ValidateEmail) Request(flag bool) {\n    fmt.Println(\"ValidateEmail.Request()\")\n    if !valid {\n       h.prev.Request(flag)\n    }\n}\n\naskEmail := &amp;AskEmail{}\nvalidateEmail := &amp;ValidateEmail{prev: askEmail}\naskEmail.next = validateEmail\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1767, "user_id": 1073170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c13e7782e36e3cf978a02ee761c7e70e?s=128&d=identicon&r=PG", "display_name": "Jory Geerts", "link": "https://stackoverflow.com/users/1073170/jory-geerts"}, "is_accepted": false, "score": 1, "last_activity_date": 1553616888, "creation_date": 1553616888, "answer_id": 55361709, "question_id": 55339431, "link": "https://stackoverflow.com/questions/55339431/chain-of-responsibility-how-to-call-certain-handler-when-current-is-failed/55361709#55361709", "title": "Chain of responsibility - how to call certain handler when current is failed", "body": "<blockquote>\n  <p>imagine situation, when user entered invalid email. How can I re-call <code>AskEmail</code> handler (or call other handler at all)?</p>\n</blockquote>\n\n<p>In my opinion, the <code>AskEmail</code> \"link\" in the chain shouldn't call <code>next</code> unless it got back a valid e-mail address. Each \"link\" should only call <code>next</code> if its own responsibility has been handled - if you look at both <a href=\"https://en.wikipedia.org/wiki/Chain-of-responsibility_pattern#UML_class_and_sequence_diagram\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Chain-of-responsibility_pattern#UML_class_and_sequence_diagram</a> and <a href=\"https://refactoring.guru/design-patterns/chain-of-responsibility\" rel=\"nofollow noreferrer\">https://refactoring.guru/design-patterns/chain-of-responsibility</a> you will see control only travels in one direction.</p>\n\n<p>The example at <a href=\"https://github.com/yksz/go-design-patterns/blob/master/behavior/chain_of_responsibility.go\" rel=\"nofollow noreferrer\">https://github.com/yksz/go-design-patterns/blob/master/behavior/chain_of_responsibility.go</a> is a bit simplistic</p>\n\n<p>If you follow this idea, your code will become something like this:</p>\n\n<pre><code>func main() {\n    // Build a chain of steps to take\n    c := AskEmail{\n        next: AskName{\n            next: Print{},\n        },\n    }\n\n    //  Run the chain with an empty \"Person\"\n    c.Run(&amp;Person{})\n}\n\n// Person holds the data that is relevant to your application. It should have a name that makes sense for your domain\ntype Person struct {\n    Email string\n    Name string\n}\n\n// PersonInfoChainLink is a link in the chain of command\ntype PersonInfoChainLink interface {\n    Run(p *Person) (error)\n}\n\n// AskEmail can ask for an e-mail address\ntype AskEmail struct {\n    next PersonInfoChainLink\n}\n\nfunc (a AskEmail) Run(p *Person) (error) {\n\n    // Ask for e-mail addresses until the user gives a valid one\n    var err error\n    var email string\n    for {\n        email, err = askString(`What is your e-mail address?`)\n        if err != nil {\n            return err\n        }\n\n        if strings.Contains(email, `@`) {\n            break\n        }\n\n        fmt.Printf(\"Invalid e-mail address %s!\", email)\n\n    }\n    p.Email = email\n\n    return a.next.Run(p)\n}\n\n// AskName can ask for the name of a person\ntype AskName struct {\n    next PersonInfoChainLink\n}\n\nfunc (a AskName) Run(p *Person) (error) {\n    name, err := askString(`What is your name?`)\n    if err != nil {\n        return err\n    }\n    p.Name = name\n    return a.next.Run(p)\n}\n\n// Print can print the information about a person\ntype Print struct {\n\n}\n\nfunc (Print) Run(p *Person) (error) {\n    log.Printf(`Email %s at %s!`, p.Name, p.Email)\n    return nil\n}\n\nfunc askString(question string) (string, error) {\n    reader := bufio.NewReader(os.Stdin)\n    fmt.Print(question + ` `)\n    return reader.ReadString('\\n')\n}\n</code></pre>\n"}], "owner": {"reputation": 1818, "user_id": 9506712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zueWr.jpg?s=128&g=1", "display_name": "Tarasovych", "link": "https://stackoverflow.com/users/9506712/tarasovych"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1553616888, "creation_date": 1553522075, "question_id": 55339431, "link": "https://stackoverflow.com/questions/55339431/chain-of-responsibility-how-to-call-certain-handler-when-current-is-failed", "title": "Chain of responsibility - how to call certain handler when current is failed", "body": "<p>I'm going to use <a href=\"https://github.com/yksz/go-design-patterns/blob/master/behavior/chain_of_responsibility.go\" rel=\"nofollow noreferrer\">Chain of responsibility pattern</a> for simple CLI dialog:</p>\n\n<pre><code>type Handler interface {\n    Request(flag bool)\n}\n\ntype AskName struct {\n    next Handler\n}\n\nfunc (h *AskName) Request(flag bool) {\n    fmt.Println(\"AskName.Request()\")\n    if flag {\n        h.next.Request(flag)\n    }\n}\n\ntype AskAge struct {\n    next Handler\n}\n\nfunc (h *AskAge) Request(flag bool) {\n    fmt.Println(\"AskAge.Request()\")\n    if flag {\n        h.next.Request(flag)\n    }\n}\n\ntype AskEmail struct {\n    next Handler\n}\n\nfunc (h *AskEmail) Request(flag bool) {\n    fmt.Println(\"AskEmail.Request()\")\n}\n\nfunc main() {\n    handlerA := &amp;AskName{&amp;AskAge{new(AskEmail)}}\n    handlerA.Request(true)\n}\n</code></pre>\n\n<p><strong>Question:</strong> imagine situation, when user entered invalid email. How can I re-call <code>AskEmail</code> handler (or call other handler at all)?</p>\n\n<p>For example, if I split logic like this:</p>\n\n<pre><code>type AskEmail struct {\n    next Handler\n}\n\nfunc (h *AskEmail) Request(flag bool) {\n    fmt.Println(\"AskEmail.Request()\")\n    if flag {\n        h.next.Request(flag)\n    }\n}\n\ntype ValidateEmail struct {\n    next Handler\n}\n\nfunc (h *ValidateEmail) Request(flag bool) {\n    fmt.Println(\"ValidateEmail.Request()\")\n}\n</code></pre>\n\n<p>how can I call <code>AskEmail</code> from <code>ValidateEmail</code> if <code>ValidateEmail</code> fails?</p>\n"}, {"tags": ["json", "go", "struct", "embedding"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1553517654, "post_id": 55337900, "comment_id": 97401172, "body": "MarshalJSON is declared on a pointer to <code>BigInt</code> that&#39;s why it&#39;s not called automatically when you pass a <i>value</i> to json.Marshal, you can fix this by passing a pointer to <code>json.Marshal</code>. <a href=\"https://play.golang.org/p/HQV4eJVwmeE\" rel=\"nofollow noreferrer\">play.golang.org/p/HQV4eJVwmeE</a>"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 6, "last_activity_date": 1553537600, "last_edit_date": 1553537600, "creation_date": 1553517717, "answer_id": 55338067, "question_id": 55337900, "link": "https://stackoverflow.com/questions/55337900/marshaljson-a-type-with-an-embedded-type-ends-up-as-instead-of-the-value/55338067#55338067", "title": "MarshalJSON a type with an embedded type ends up as {} instead of the value", "body": "<p><a href=\"https://golang.org/pkg/math/big/#Int\" rel=\"nofollow noreferrer\"><code>big.Int</code></a> implements a custom JSON marshaler (<a href=\"https://golang.org/pkg/encoding/json/#Marshaler\" rel=\"nofollow noreferrer\"><code>json.Marshaler</code></a>), see <a href=\"https://golang.org/pkg/math/big/#Int.MarshalJSON\" rel=\"nofollow noreferrer\"><code>Int.MarshalJSON()</code></a>. But this method has pointer receiver, so it is only used / called, if you have a pointer value: <code>*big.Int</code>.</p>\n\n<p>And you embed a non-pointer value, so this custom marshaler is not called, and since <code>big.Int</code> is a struct with unexported fields, you will see an empty JSON object in the output: <code>{}</code>.</p>\n\n<p>To make it work, you should use a pointer to your type, e.g.:</p>\n\n<pre><code>Amount      *utils.BigInt `json:\"amount,omitempty\"`\nFee         *utils.BigInt `json:\"fee,omitempty\"`\n</code></pre>\n\n<p>Example using it:</p>\n\n<pre><code>s := SpendTx{\n    SenderID:    \"alice\",\n    RecipientID: \"bob\",\n    Amount:      &amp;utils.BigInt{},\n    Fee:         &amp;utils.BigInt{},\n}\ndata, err := s.JSON()\nfmt.Println(string(data), err)\n</code></pre>\n\n<p>Then output will be for example (try it on the <a href=\"https://play.golang.org/p/4OoQDP-wAAG\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>{\"sender_id\":\"alice\",\"recipient_id\":\"bob\",\"amount\":0,\"fee\":0} &lt;nil&gt;\n</code></pre>\n\n<p>Another option is to use the non-pointer <code>utils.BigInt</code>, but then <code>utils.BigInt</code> should embed a pointer type:</p>\n\n<pre><code>type BigInt struct {\n    *big.Int\n}\n\ntype SpendTx struct {\n    Amount      utils.BigInt `json:\"amount,omitempty\"`\n    Fee         utils.BigInt `json:\"fee,omitempty\"`\n}\n</code></pre>\n\n<p>And then using it:</p>\n\n<pre><code>s := SpendTx{\n    SenderID:    \"alice\",\n    RecipientID: \"bob\",\n    Amount:      utils.BigInt{new(big.Int)},\n    Fee:         utils.BigInt{new(big.Int)},\n}\ndata, err := s.JSON()\nfmt.Println(string(data), err)\n</code></pre>\n\n<p>And output will be again (try it on the <a href=\"https://play.golang.org/p/6aSBA6oHB8t\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>{\"sender_id\":\"alice\",\"recipient_id\":\"bob\",\"amount\":0,\"fee\":0} &lt;nil&gt;\n</code></pre>\n"}], "owner": {"reputation": 382, "user_id": 3328311, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/437d1a24f69a7108e6abd9fa71c98b70?s=128&d=identicon&r=PG&f=1", "display_name": "randomshinichi", "link": "https://stackoverflow.com/users/3328311/randomshinichi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 55338067, "answer_count": 1, "score": 1, "last_activity_date": 1553537600, "creation_date": 1553517237, "last_edit_date": 1553517939, "question_id": 55337900, "link": "https://stackoverflow.com/questions/55337900/marshaljson-a-type-with-an-embedded-type-ends-up-as-instead-of-the-value", "title": "MarshalJSON a type with an embedded type ends up as {} instead of the value", "body": "<p>To interact with swagger, I needed to make a custom <code>BigInt</code> struct which does nothing more than wrap around go's <code>big.Int</code>.</p>\n\n<pre><code>type BigInt struct {\n    big.Int\n}\n\n...\ntype SpendTx struct {\n    SenderID    string       `json:\"sender_id,omitempty\"`\n    RecipientID string       `json:\"recipient_id,omitempty\"`\n    Amount      utils.BigInt `json:\"amount,omitempty\"`\n    Fee         utils.BigInt `json:\"fee,omitempty\"`\n    Payload     string       `json:\"payload,omitempty\"`\n    TTL         uint64       `json:\"ttl,omitempty\"`\n    Nonce       uint64       `json:\"nonce,omitempty\"`\n}\n\nfunc (t SpendTx) JSON() (output []byte, err error) {\n    return json.Marshal(t)\n}\n\n</code></pre>\n\n<p>I'd expect <code>SpendTx.JSON()</code> to eventually call <code>big.Int.MarshalJSON()</code>, which would return <code>0</code>. Instead, I got this output:</p>\n\n<p><code>{\"sender_id\":\"alice\",\"recipient_id\":\"bob\",\"amount\":{},\"fee\":{},\"payload\":\"Hello World\",\"ttl\":10,\"nonce\":1}</code></p>\n\n<p>But what I really want is this:</p>\n\n<p><code>{\"sender_id\":\"alice\",\"recipient_id\":\"bob\",\"amount\":10,\"fee\":10,\"payload\":\"Hello World\",\"ttl\":10,\"nonce\":1}</code></p>\n\n<p>And I had to add this bit of code to <code>BigInt</code> to do it:</p>\n\n<pre><code>func (b BigInt) MarshalJSON() ([]byte, error) {\n    return b.Int.MarshalJSON()\n}\n</code></pre>\n\n<p>But according to <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow noreferrer\">Effective Go's section on embedding structs</a>, this shouldn't be necessary at all. Why is <code>big.Int</code> appearing as as <code>{}</code>?</p>\n"}, {"tags": ["go", "constants", "slice"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1553519371, "post_id": 55337703, "comment_id": 97402205, "body": "A byte is at most two digits in hex; the maximum byte value is <code>0xFF</code> (in any language - this is not Go-specific). If your values are greater than <code>0xFF</code> (which all of your values are), you will either have to use smaller values, or use a type bigger than <code>byte</code>."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1553516800, "creation_date": 1553516800, "answer_id": 55337761, "question_id": 55337703, "link": "https://stackoverflow.com/questions/55337703/how-to-fix-constant-x-oveflows-byte-error-in-go/55337761#55337761", "title": "How to fix &#39;constant x oveflows byte&#39; error in go?", "body": "<p>In Go, <code>byte</code> is an alias for <code>uint8</code>, which is the set of all unsigned 8-bit integers (<code>0..255</code>, both inclusive), see <a href=\"https://golang.org/ref/spec#Numeric_types\" rel=\"nofollow noreferrer\">Spec: Numeric types</a>. Which means a value of <code>0x10A = 266</code> cannot be stored in a value of type <code>byte</code>.</p>\n\n<p>If you need to store those constants, use a different type, e.g. <code>uint16</code>:</p>\n\n<pre><code>const (\n    Starttrame1 = 0x10A\n    Starttrame2 = 0x10B\n    Starttrame3 = 0X10C\n    Starttrame4 = 0X10D\n    Starttrame5 = 0X10E\n    Starttrame6 = 0x10F\n)\n\nvar data = [...]uint16{\n    Starttrame1, Starttrame2, Starttrame3, Starttrame4, Starttrame5, Starttrame6,\n}\n</code></pre>\n\n<p>Try it on the <a href=\"https://play.golang.org/p/FCCONve5m8L\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 51, "user_id": 10967256, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WmoAclaLd1A/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQN4T3K3MHcbtcjgIEJ2k5oGKGdS0Q/mo/photo.jpg?sz=128", "display_name": "Deniz Tohumcu", "link": "https://stackoverflow.com/users/10967256/deniz-tohumcu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "accepted_answer_id": 55337761, "answer_count": 1, "score": 0, "last_activity_date": 1553522220, "creation_date": 1553516585, "last_edit_date": 1553522220, "question_id": 55337703, "link": "https://stackoverflow.com/questions/55337703/how-to-fix-constant-x-oveflows-byte-error-in-go", "title": "How to fix &#39;constant x oveflows byte&#39; error in go?", "body": "<p>Hello I am trying to make a byte slice with constants but I get the <code>constant x overflows byte</code> error.\nHere are my constants:</p>\n\n<pre><code>const(\n     Starttrame1 = 0x10A\n     Starttrame2 = 0x10B\n     Starttrame3 = 0X10C\n     Starttrame4 = 0X10D\n     Starttrame5 = 0X10E\n     Starttrame6 = 0x10F\n)\n</code></pre>\n\n<p>and here is how I declare my slice:</p>\n\n<pre><code>var startValues = [6]byte{Starttrame1,Starttrame2,Startrame3,Starttrame4,Starttrame5,Starttrame6}\n</code></pre>\n\n<p>Everytime I build I get the <code>constant 266 overflows byte</code>. How should I declare my constants in order to fix this?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1865, "user_id": 2670926, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/525181988/picture?type=large", "display_name": "Helge Talvik S&#246;derstr&#246;m", "link": "https://stackoverflow.com/users/2670926/helge-talvik-s%c3%b6derstr%c3%b6m"}, "edited": false, "score": 0, "creation_date": 1553597532, "post_id": 55339578, "comment_id": 97434363, "body": "Hey, apxp! Thanks for your reply. Yeah, I&#39;m aware of that, but in that case, the namespace will be missing if you marshal an object into XML, as per <a href=\"https://play.golang.org/p/lJP-410mNCA\" rel=\"nofollow noreferrer\">this Playground</a>. So if I use that implementation, it stops working in the other direction instead."}, {"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "reply_to_user": {"reputation": 1865, "user_id": 2670926, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/525181988/picture?type=large", "display_name": "Helge Talvik S&#246;derstr&#246;m", "link": "https://stackoverflow.com/users/2670926/helge-talvik-s%c3%b6derstr%c3%b6m"}, "edited": false, "score": 0, "creation_date": 1553696093, "post_id": 55339578, "comment_id": 97480886, "body": "You are right. But that package is just a simple implementation of a XML parser. I think the namespace does not work correct for generating XML. For complex XML definitions I use text templates. I know that this is not perfect, but it is the fastest way to code complex XML generators. AND BIG PLUS ist is very easy to read."}], "tags": [], "owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "is_accepted": false, "score": 1, "last_activity_date": 1553522505, "creation_date": 1553522505, "answer_id": 55339578, "question_id": 55337517, "link": "https://stackoverflow.com/questions/55337517/golang-xml-unmarshal-ignores-namespace/55339578#55339578", "title": "Golang XML: unmarshal ignores namespace", "body": "<p>The documentation of the XML package does not write enough about the namespaces. The parsing is very simple. There is a small support for the namespaces. It can parse the XML, but when you create XML ist does not support the namespace thing enough.</p>\n\n<p>Your struct works, when you remove the namespace information inside the <code>XMLName</code> definition:</p>\n\n<pre><code>type myStruct struct {\n    XMLName xml.Name `xml:\"Envelope\"`\n    SoapEnv string   `xml:\"xmlns:soapenv,attr\"`\n    Header  struct{} `xml:\"soapenv:Header\"`\n    Body    struct {\n        MyData string `xml:\"my-data\"`\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/UppXwx0X0i9\" rel=\"nofollow noreferrer\">https://play.golang.org/p/UppXwx0X0i9</a></p>\n"}], "owner": {"reputation": 1865, "user_id": 2670926, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/525181988/picture?type=large", "display_name": "Helge Talvik S&#246;derstr&#246;m", "link": "https://stackoverflow.com/users/2670926/helge-talvik-s%c3%b6derstr%c3%b6m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 498, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553522505, "creation_date": 1553515864, "question_id": 55337517, "link": "https://stackoverflow.com/questions/55337517/golang-xml-unmarshal-ignores-namespace", "title": "Golang XML: unmarshal ignores namespace", "body": "<p>I'm implementing a service in our Go system that reads data from an external SOAP service. Now that I'm writing tests for it, I run into this issue:</p>\n\n<pre><code>unable to unmarshal request body for testing: expected element type &lt;soapenv:Envelope&gt; but have &lt;Envelope&gt;\n</code></pre>\n\n<p>If I dump my data, I have this:</p>\n\n<pre><code>&lt;soapenv:Envelope xmlns:soapenv=\"http://www.w3.org/2003/05/soap-envelope\" xmlns:v2 [...]\n</code></pre>\n\n<p>So I do have the correct namespace in the XML. For the record, this is the struct into which I'm trying to unmarshal the data:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type collectRequestXML struct {\n    XMLName xml.Name `xml:\"soapenv:Envelope\"`\n    SoapEnv string   `xml:\"xmlns:soapenv,attr\"`\n    XMLNs   string   `xml:\"xmlns:v2,attr\"`\n    Header  struct{} `xml:\"soapenv:Header\"`\n    Body    struct {\n        [...]\n    }\n}\n</code></pre>\n\n<p>What can I do to make the unmarshal fail?</p>\n\n<p>See <a href=\"https://play.golang.org/p/0ee2RpL2c7P\" rel=\"nofollow noreferrer\">this Playground item for reference</a>.</p>\n"}, {"tags": ["java", "go", "gomobile"], "comments": [{"owner": {"reputation": 1211, "user_id": 10674888, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OMeKW.jpg?s=128&g=1", "display_name": "MS90", "link": "https://stackoverflow.com/users/10674888/ms90"}, "edited": false, "score": 2, "creation_date": 1553515523, "post_id": 55337323, "comment_id": 97399932, "body": "What is the actual question? Elaborate, terminate go thread from where and using what? @Roman"}, {"owner": {"reputation": 11, "user_id": 5008218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57bfe43c72a4772d5a030b2e32bce07?s=128&d=identicon&r=PG", "display_name": "Roman", "link": "https://stackoverflow.com/users/5008218/roman"}, "reply_to_user": {"reputation": 1211, "user_id": 10674888, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OMeKW.jpg?s=128&g=1", "display_name": "MS90", "link": "https://stackoverflow.com/users/10674888/ms90"}, "edited": false, "score": 0, "creation_date": 1553515610, "post_id": 55337323, "comment_id": 97399994, "body": "Question is: What i have to do in java code to kill <code>GoRefQueue Finalizer Thread</code>?"}, {"owner": {"reputation": 9010, "user_id": 2588800, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/847da843d41921363502159c8b7e5549?s=128&d=identicon&r=PG", "display_name": "Svetlin Zarev", "link": "https://stackoverflow.com/users/2588800/svetlin-zarev"}, "edited": false, "score": 0, "creation_date": 1553517819, "post_id": 55337323, "comment_id": 97401268, "body": "please update the question instead of asking in the comments"}], "owner": {"reputation": 11, "user_id": 5008218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57bfe43c72a4772d5a030b2e32bce07?s=128&d=identicon&r=PG", "display_name": "Roman", "link": "https://stackoverflow.com/users/5008218/roman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1553517873, "creation_date": 1553515171, "last_edit_date": 1553517873, "question_id": 55337323, "link": "https://stackoverflow.com/questions/55337323/what-i-have-to-do-in-java-code-to-kill-gorefqueue-finalizer-thread", "title": "What i have to do in java code to kill GoRefQueue Finalizer Thread?", "body": "<p>I have some code, that compiled to <code>aar</code> file via <code>gomobile bind -target=android</code></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package counter\n\nvar Count = 0\n\nfunc Increment() {\n    Count++\n}\n</code></pre>\n\n<p>In Java this code looks like <code>abstact</code> class with <code>getCount</code> and <code>increment</code> methods.</p>\n\n<p>I want to know, how to kill thread created by Go bindings?</p>\n\n<p>I seeing threads via <code>adb shell</code> and <code>ps -T -p [pid]</code> command. Go thread called <code>GoRefQueue Finalizer Thread</code></p>\n"}, {"tags": ["go", "dependencies", "dependency-management"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1553514023, "post_id": 55336907, "comment_id": 97399091, "body": "The ignore list seems the right approach. Please show how you did that."}, {"owner": {"reputation": 638, "user_id": 443309, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5db40f9afca164945a51690b269737b8?s=128&d=identicon&r=PG&f=1", "display_name": "gkns", "link": "https://stackoverflow.com/users/443309/gkns"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1553514566, "post_id": 55336907, "comment_id": 97399368, "body": "Thank you! I think I missed the wildcard notation at the end. Posting it as answer."}], "answers": [{"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1553514718, "post_id": 55337145, "comment_id": 97399442, "body": "That can probably be shortened to &quot;gitlab.com/internal.com/*&quot;"}, {"owner": {"reputation": 5658, "user_id": 1162217, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/7E5sp.jpg?s=128&g=1", "display_name": "Lukas Lukac", "link": "https://stackoverflow.com/users/1162217/lukas-lukac"}, "edited": false, "score": 0, "creation_date": 1582631906, "post_id": 55337145, "comment_id": 106836746, "body": "not if you have other gitlab internal projects such as  &quot;gitlab.internal.com/vapi2/whatver*&quot; or   &quot;gitlab.internal.com/vapi/goccc*&quot; and u don&#39;t want to ignore them"}], "tags": [], "owner": {"reputation": 638, "user_id": 443309, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5db40f9afca164945a51690b269737b8?s=128&d=identicon&r=PG&f=1", "display_name": "gkns", "link": "https://stackoverflow.com/users/443309/gkns"}, "is_accepted": true, "score": 0, "last_activity_date": 1553514572, "creation_date": 1553514572, "answer_id": 55337145, "question_id": 55336907, "link": "https://stackoverflow.com/questions/55336907/how-to-exclude-internal-dependencies-from-vendor-folder-when-using-dep-for-golan/55337145#55337145", "title": "How to exclude internal dependencies from vendor folder when using dep for golang", "body": "<pre><code>ignored = [\n  \"gitlab.internal.com/vapi/goabc*\",\n  \"gitlab.internal.com/vapi/goxyz*\"\n]\n</code></pre>\n\n<p>Did the trick, earlier I hadn't placed the wildcard and other package imports forced the dep to download the project anyway.</p>\n"}], "owner": {"reputation": 638, "user_id": 443309, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5db40f9afca164945a51690b269737b8?s=128&d=identicon&r=PG&f=1", "display_name": "gkns", "link": "https://stackoverflow.com/users/443309/gkns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 607, "favorite_count": 0, "accepted_answer_id": 55337145, "answer_count": 1, "score": -1, "last_activity_date": 1553514572, "creation_date": 1553513735, "question_id": 55336907, "link": "https://stackoverflow.com/questions/55336907/how-to-exclude-internal-dependencies-from-vendor-folder-when-using-dep-for-golan", "title": "How to exclude internal dependencies from vendor folder when using dep for golang", "body": "<p>I have a project that depends on two other projects in the internal git repo. Which is already present in GOPATH.\nThe problem I am facing is that, <code>dep-init -gopath</code> will still copy those projects under vendor/ directory.</p>\n\n<p>Consequently the GoLand IDE I am using is confused where from the dependency is to be resolved. (I want it to resolve from GOPATH and not Vendor directory) If I delete the vendor/ directory, the program will run.</p>\n\n<p>My Gopkg.toml file looks like:</p>\n\n<pre><code>[[constraint]]\n  branch = \"master\"\n  name = \"github.com/sirupsen/logrus\"\n\n[[constraint]]\n  branch = \"master\"\n  name = \"github.com/stretchr/testify\"\n\n[[constraint]]\n  branch = \"master\"\n  name = \"gitlab.internal.com/vapi/goabc\"\n\n[[constraint]]\n  branch = \"master\"\n  name = \"gitlab.internal.com/vapi/goxyz\"\n\n[prune]\n  go-tests = true\n  unused-packages = true\n</code></pre>\n\n<p>Where\n<code>\"gitlab.internal.com/vapi/goabc\"</code> and <code>\"gitlab.internal.com/vapi/goxyz\"</code>\nare the internal projects that this project depends on.</p>\n\n<p>I tried adding the dependencies to ignored list [<a href=\"https://golang.github.io/dep/docs/Gopkg.toml.html#ignored]\" rel=\"nofollow noreferrer\">https://golang.github.io/dep/docs/Gopkg.toml.html#ignored]</a></p>\n\n<p>But goxyz and goabc are still downloaded to vendor/\nHow can I get rid of them from the vendor directory?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 4, "creation_date": 1553511252, "post_id": 55336073, "comment_id": 97397407, "body": "You have the order wrong, calling doingSomething before initializing a single summary. <code>&amp;Something{}</code> evaluates to a pointer to <code>Something</code> however its map field is <code>nil</code> not to say anything about that map&#39;s elements. <a href=\"https://play.golang.org/p/kbkNaIdikH9\" rel=\"nofollow noreferrer\">play.golang.org/p/kbkNaIdikH9</a>"}], "answers": [{"tags": [], "owner": {"reputation": 478, "user_id": 1456549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KP9PS.jpg?s=128&g=1", "display_name": "Munai Das Udasin", "link": "https://stackoverflow.com/users/1456549/munai-das-udasin"}, "is_accepted": true, "score": 0, "last_activity_date": 1553513789, "creation_date": 1553513789, "answer_id": 55336920, "question_id": 55336073, "link": "https://stackoverflow.com/questions/55336073/updating-mapstringstruct-variable-in-a-struct/55336920#55336920", "title": "Updating map[string]*struct variable in a struct", "body": "<pre><code>func main() {\n\n\n\n\n    s := &amp;Something{}\n    // Intialize map.\n    s.SummaryLevelWise = map[string]*Summary{}\n    //s.SummaryLevelWise[\"1\"].Pass, s.SummaryLevelWise[\"1\"].Fail, s.SummaryLevelWise[\"1\"].Warn, s.SummaryLevelWise[\"1\"].Info, s.SummaryLevelWise[\"1\"].Skip = 0,0,0,0,0\n    s.SummaryLevelWise[\"1\"] = &amp;Summary{0,0,0,0,0}\n    s.doingSomething()\n\n\n}\n</code></pre>\n\n<p>maps are nil-able. Hence need to initialize them.</p>\n"}], "owner": {"reputation": 478, "user_id": 1456549, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KP9PS.jpg?s=128&g=1", "display_name": "Munai Das Udasin", "link": "https://stackoverflow.com/users/1456549/munai-das-udasin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 55336920, "answer_count": 1, "score": -1, "last_activity_date": 1553513789, "creation_date": 1553510895, "question_id": 55336073, "link": "https://stackoverflow.com/questions/55336073/updating-mapstringstruct-variable-in-a-struct", "title": "Updating map[string]*struct variable in a struct", "body": "<pre><code>package main\n\nimport \"fmt\"\n\ntype State string\n\nconst (\n    // PASS check passed.\n    PASS State = \"PASS\"\n    // FAIL check failed.\n    FAIL = \"FAIL\"\n    // WARN could not carry out check.\n    WARN = \"WARN\"\n    // INFO informational message\n    INFO = \"INFO\"\n    // SKIP for tests skipped\n    SKIP = \"SKIP\"\n)\n\n// SummaryLevelWise is a summary of results of control checks run CIS Levelwise\ntype Something struct{\n    SummaryLevelWise map[string]*Summary\n}\n\n// Summary is a summary of the results of control checks run.\ntype Summary struct {\n    Pass int `json:\"total_pass\"`\n    Fail int `json:\"total_fail\"`\n    Warn int `json:\"total_warn\"`\n    Info int `json:\"total_info\"`\n    Skip int `json:\"total_skip\"`\n}\n\n\nfunc main() {\n\n    s := &amp;Something{}\n    s.doingSomething()\n    // This is one way I tried to update the map[string]*struct variable\n    s.SummaryLevelWise[\"1\"].Pass, s.SummaryLevelWise[\"1\"].Fail, s.SummaryLevelWise[\"1\"].Warn, s.SummaryLevelWise[\"1\"].Info, s.SummaryLevelWise[\"1\"].Skip = 0,0,0,0,0\n\n   // Another way that didn't work\n   // s.SummaryLevelWise[\"1\"] = &amp;Summary{0,0,0,0,0}\n\n}\n\n\nfunc summarizeLevel(summary *Summary) {\n    switch PASS{\n    case PASS:\n        summary.Pass++\n    case FAIL:\n        summary.Fail++\n    case WARN:\n        summary.Warn++\n    case INFO:\n        summary.Info++\n    case SKIP:\n        summary.Skip++\n    }\n}\n\n\nfunc(something *Something ) doingSomething(){\n\n    level1 := \"1\"\n\n    for i:=0; i&lt;10; i++ {\n        summarizeLevel(something.SummaryLevelWise[level1])\n    }\n    fmt.Println(something)\n}\n</code></pre>\n\n<p>The error that I get is </p>\n\n<blockquote>\n  <p>panic: runtime error: invalid memory address or nil pointer\n  dereference [signal SIGSEGV: segmentation violation code=0x1 addr=0x0\n  pc=0x1091ac4]</p>\n  \n  <p>goroutine 1 [running]: main.summarizeLevel(...)\n          /Users/i345678/go/src/github.concur.com/test/test/main.go:68 main.(*Something).doingSomething(0xc00000c028)\n          /Users/i345678/go/src/github.concur.com/test/test/main.go:89 +0x64 main.main()\n          /Users/i345678/go/src/github.concur.com/test/test/main.go:58 +0x44 exit status 2</p>\n</blockquote>\n\n<p>The values of the level string is \"1\" and \"2\". </p>\n"}, {"tags": ["xml", "go", "unmarshalling", "cdata"], "comments": [{"owner": {"reputation": 2553, "user_id": 5198756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6xLRL.png?s=128&g=1", "display_name": "ifnotak", "link": "https://stackoverflow.com/users/5198756/ifnotak"}, "edited": false, "score": 0, "creation_date": 1553509787, "post_id": 55335635, "comment_id": 97396559, "body": "Use the tag <code>xml:&quot;,cdata&quot;</code>."}, {"owner": {"reputation": 2553, "user_id": 5198756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6xLRL.png?s=128&g=1", "display_name": "ifnotak", "link": "https://stackoverflow.com/users/5198756/ifnotak"}, "edited": false, "score": 0, "creation_date": 1553509821, "post_id": 55335635, "comment_id": 97396576, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/14191596/how-to-create-a-cdata-node-of-xml-with-go\">How to create a CDATA node of xml with go?</a>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1553510349, "post_id": 55335635, "comment_id": 97396883, "body": "@SignatureD <code>CDatas</code> must be a <code>string</code> or <code>[]byte</code> and then use the <code>cdata</code> tag option as mentioned by Abdullah&#39;s comment. <a href=\"https://play.golang.org/p/uzNWL3mveQg\" rel=\"nofollow noreferrer\">play.golang.org/p/uzNWL3mveQg</a>"}, {"owner": {"reputation": 31, "user_id": 6042481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59b5b218d4ddb2fb11a700eb06e81a29?s=128&d=identicon&r=PG&f=1", "display_name": "Signature D", "link": "https://stackoverflow.com/users/6042481/signature-d"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1553517865, "post_id": 55335635, "comment_id": 97401306, "body": "@mkopriva thanks for your answer. But what if I want to unmarshal the xml into another struct like ``` type Children struct {       GenericItems []string <code>xml:&quot;...&quot;</code> } ```  the generic item can be the content of CDATA or the url of image or just the plain text. As these elements are put in an array called GenericItems, so we can keep their order in the result struct."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1553518030, "post_id": 55335635, "comment_id": 97401385, "body": "You can have your type implement the <code>encoding.TextUnmarshaler</code> interface, then your type will be called once with all the content that was present in the separate CDATA sections, which means you&#39;ll have to parse that yourself and then put it into the slice."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1553518293, "post_id": 55335635, "comment_id": 97401545, "body": "... here&#39;s an example: <a href=\"https://play.golang.org/p/iC83C2B4ORu\" rel=\"nofollow noreferrer\">play.golang.org/p/iC83C2B4ORu</a>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1553518672, "post_id": 55335635, "comment_id": 97401808, "body": "... for decoding everything into a single list, not only cdata but also plain elements you&#39;ll have to implement the <code>xml.Unmarshaler</code> interface, it&#39;s a bit more involved compared to <code>TextUnmarshaler</code> but it&#39;s certainly doable, you can look for example code on github: <a href=\"https://github.com/search?q=language%3Ago+unmarshalxml&amp;type=Code\" rel=\"nofollow noreferrer\">github.com/search?q=language%3Ago+unmarshalxml&amp;type=Code</a>"}, {"owner": {"reputation": 31, "user_id": 6042481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59b5b218d4ddb2fb11a700eb06e81a29?s=128&d=identicon&r=PG&f=1", "display_name": "Signature D", "link": "https://stackoverflow.com/users/6042481/signature-d"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1553519995, "post_id": 55335635, "comment_id": 97402594, "body": "@mkopriva I tried to implement the xml.Unmarshaler: <a href=\"https://play.golang.org/p/oDvEsltjyP6\" rel=\"nofollow noreferrer\">play.golang.org/p/oDvEsltjyP6</a>, but it seems the function just skip the cdata content. The first element I got in the unmarshaler is the Image element"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1553520242, "post_id": 55335635, "comment_id": 97402772, "body": "This is because UnmarshalXML will always start with a valid xml element, so you need to implement it for the enclosing type and then loop over the decoder&#39;s tokens. I&#39;ll whip up an incomplete example, one sec."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1553520727, "post_id": 55335635, "comment_id": 97403105, "body": "... here: <a href=\"https://play.golang.org/p/twDRMmExyjS\" rel=\"nofollow noreferrer\">play.golang.org/p/twDRMmExyjS</a>"}, {"owner": {"reputation": 31, "user_id": 6042481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59b5b218d4ddb2fb11a700eb06e81a29?s=128&d=identicon&r=PG&f=1", "display_name": "Signature D", "link": "https://stackoverflow.com/users/6042481/signature-d"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1553769398, "post_id": 55335635, "comment_id": 97511165, "body": "@mkopriva Thanks a lot ! I tried your sample today and find it works well except one problem. If there is head/tail spaces in the CDATA string, these spaces will be deleted because of the TrimSpace(), but if we don&#39;t call trimspace(), there should be a lot of unexpected &#39;\\n&#39; in the result array. <a href=\"https://play.golang.org/p/C27j2JEaGtS\" rel=\"nofollow noreferrer\">play.golang.org/p/C27j2JEaGtS</a>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1553769650, "post_id": 55335635, "comment_id": 97511325, "body": "Use <a href=\"https://golang.org/pkg/strings/#Trim\" rel=\"nofollow noreferrer\">golang.org/pkg/strings/#Trim</a> instead and provide a cutset of only those whitespace characters that you want to get rid of. e.g. <code>&quot;\\n\\r&quot;</code>."}, {"owner": {"reputation": 31, "user_id": 6042481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59b5b218d4ddb2fb11a700eb06e81a29?s=128&d=identicon&r=PG&f=1", "display_name": "Signature D", "link": "https://stackoverflow.com/users/6042481/signature-d"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1553831477, "post_id": 55335635, "comment_id": 97540541, "body": "@mkopriva emm.. actually I need to ignore all the text outside the CDATA tag, but it seems I can&#39;t know that the current CHARDATA is inside or outside the CDATA tag from current code flow"}], "answers": [{"tags": [], "owner": {"reputation": 1143, "user_id": 370213, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/PH4vL.jpg?s=128&g=1", "display_name": "zhengchun", "link": "https://stackoverflow.com/users/370213/zhengchun"}, "is_accepted": false, "score": 0, "last_activity_date": 1553695211, "creation_date": 1553695211, "answer_id": 55379079, "question_id": 55335635, "link": "https://stackoverflow.com/questions/55335635/unmarshal-xml-tag-that-contains-mixed-contentse-g-cdata-other-tags/55379079#55379079", "title": "Unmarshal XML tag that contains mixed contents(e.g. CDATA, other tags)", "body": "<p>This solution is not so good, because <a href=\"https://github.com/antchfx/xmlquery\" rel=\"nofollow noreferrer\">xmlquery</a> mades <code>CDATA</code> element as TEXT node type, but I considered it is easy and simple, it using <code>XPath</code> query. </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n\n    \"github.com/antchfx/xmlquery\"\n)\n\nfunc main() {\n    s := `&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;Element&gt;\n&lt;![CDATA[hello]]&gt;\n&lt;image&gt;some_url_here&lt;/image&gt;\n&lt;![CDATA[world]]&gt;\n&lt;/Element&gt;\n`\n    doc, err := xmlquery.Parse(strings.NewReader(s))\n    if err != nil {\n        panic(err)\n    }\n    elem := xmlquery.FindOne(doc, \"//Element\")\n    for n := elem.FirstChild; n != nil; n = n.NextSibling {\n        if n.Data == \"image\" {\n            fmt.Printf(\"image: %s\\n\", n.InnerText())\n        } else if n.Type == xmlquery.TextNode {\n            if len(strings.TrimSpace(n.InnerText())) == 0 {\n                // skip it because its' empty node\n            } else {\n                fmt.Printf(\"cdata: %s\\n\", n.InnerText())\n            }\n        }\n    }\n    // or using query expression\n    image := xmlquery.FindOne(doc, \"//image\")\n    fmt.Printf(\"image: %s\\n\", image.InnerText())\n}\n\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6042481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59b5b218d4ddb2fb11a700eb06e81a29?s=128&d=identicon&r=PG&f=1", "display_name": "Signature D", "link": "https://stackoverflow.com/users/6042481/signature-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1553695211, "creation_date": 1553509403, "last_edit_date": 1553509889, "question_id": 55335635, "link": "https://stackoverflow.com/questions/55335635/unmarshal-xml-tag-that-contains-mixed-contentse-g-cdata-other-tags", "title": "Unmarshal XML tag that contains mixed contents(e.g. CDATA, other tags)", "body": "<p>Try to unmarshal a xml file like:</p>\n\n<pre><code>&lt;Element&gt;\n    &lt;![CDATA[hello]]&gt;\n    &lt;image&gt;some_url_here&lt;/image&gt;\n    &lt;![CDATA[world]]&gt;\n    mixed content here\n&lt;/Element&gt;\n</code></pre>\n\n<p>there are different types of data inside the Element tag, how can I unmashal this xml into a struct like: </p>\n\n<pre><code>type XMLElement struct {\n    XMLName xml.Name `xml:\"Element\"`\n    CDatas []string `....`\n    Image string `...`\n    PlainText string `...`\n}\n</code></pre>\n\n<p>or any other struct this xml could be unmarshalled in.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1553520374, "post_id": 55335296, "comment_id": 97402874, "body": "JSON doesn&#39;t allow for an object&#39;s key to be an object: <a href=\"https://json.org/\" rel=\"nofollow noreferrer\">json.org</a>"}], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 8, "last_activity_date": 1553509000, "creation_date": 1553509000, "answer_id": 55335509, "question_id": 55335296, "link": "https://stackoverflow.com/questions/55335296/problem-with-marshal-unmarshal-when-key-of-map-is-a-struct/55335509#55335509", "title": "Problem with Marshal/unMarshal when key of map is a struct", "body": "<p>From the <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"noreferrer\">docs</a>:</p>\n\n<blockquote>\n  <p>The map's key type must either be a string, an integer type, or\n  implement encoding.TextMarshaler.</p>\n</blockquote>\n\n<pre><code>func (s Student) MarshalText() (text []byte, err error) {\n    type noMethod Student\n    return json.Marshal(noMethod(s))\n}\n\nfunc (s *Student) UnmarshalText(text []byte) error {\n    type noMethod Student\n    return json.Unmarshal(text, (*noMethod)(s))\n}\n</code></pre>\n\n<p>As an example I'm using <code>encoding/json</code> to turn a Student value into a json object key, however that is not required and you can choose your own format.</p>\n\n<p><a href=\"https://play.golang.org/p/4BgZn4Y37Ww\" rel=\"noreferrer\">https://play.golang.org/p/4BgZn4Y37Ww</a></p>\n"}], "owner": {"reputation": 17, "user_id": 11253940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/247569eccb561be3d777c4ae37389683?s=128&d=identicon&r=PG&f=1", "display_name": "Cassie", "link": "https://stackoverflow.com/users/11253940/cassie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 764, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553509000, "creation_date": 1553508231, "question_id": 55335296, "link": "https://stackoverflow.com/questions/55335296/problem-with-marshal-unmarshal-when-key-of-map-is-a-struct", "title": "Problem with Marshal/unMarshal when key of map is a struct", "body": "<p>I defined a struct named Student and a map named score.\nData structure is shown below:</p>\n\n<pre><code>type Student struct {\n    CountryID int\n    RegionID  int\n    Name      string\n}\n\nstu := Student{111, 222, \"Tom\"}\nscore := make(map[Student]int64)\nscore[stu] = 100\n</code></pre>\n\n<p>i am using json.Marshal to marshal score into json, but i cannot use json.Unmarshal to unmarshal this json. Below is my code. i am using function GetMarshableObject to translate struct Student into string which is marshable. \nCould anyone tell me how to deal with this json to unmarshal it back to map score. </p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"os\"\n    \"reflect\"\n)\n\ntype Student struct {\n    CountryID int\n    RegionID  int\n    Name      string\n}\n\nfunc GetMarshableObject(src interface{}) interface{} {\n    t := reflect.TypeOf(src)\n    v := reflect.ValueOf(src)\n    kind := t.Kind()\n    var result reflect.Value\n    switch kind {\n    case reflect.Map:\n        //Find the map layer count\n        layer := 0\n        cur := t.Elem()\n        for reflect.Map == cur.Kind() {\n            layer++\n            cur = cur.Elem()\n        }\n        result = reflect.MakeMap(reflect.MapOf(reflect.TypeOf(\"a\"), cur))\n        for layer &gt; 0 {\n            result = reflect.MakeMap(reflect.MapOf(reflect.TypeOf(\"a\"), result.Type()))\n            layer--\n        }\n        keys := v.MapKeys()\n        for _, k := range keys {\n            value := reflect.ValueOf(GetMarshableObject(v.MapIndex(k).Interface()))\n            if value.Type() != result.Type().Elem() {\n                result = reflect.MakeMap(reflect.MapOf(reflect.TypeOf(\"a\"), value.Type()))\n            }\n            result.SetMapIndex(reflect.ValueOf(fmt.Sprintf(\"%v\", k)), reflect.ValueOf(GetMarshableObject(v.MapIndex(k).Interface())))\n        }\n    default:\n        result = v\n    }\n    return result.Interface()\n}\n\nfunc main() {\n    stu := Student{111, 222, \"Tom\"}\n    score := make(map[Student]int64)\n    score[stu] = 100\n\n    b, err := json.Marshal(GetMarshableObject(score))\n    if err != nil {\n        fmt.Println(\"error:\", err)\n    }\n    os.Stdout.Write(b) //{\"{111 222 Tom}\":100}\n\n    scoreBak := make(map[Student]int64)\n    if err = json.Unmarshal(b, &amp;scoreBak); nil != err {\n        fmt.Println(\"error: %v\", err) // get error here: cannot unmarshal object into Go value of type map[main.Student]int64\n    }\n}\n\n</code></pre>\n"}, {"tags": ["json", "api", "go", "beego"], "owner": {"reputation": 598, "user_id": 9629581, "user_type": "registered", "profile_image": "https://graph.facebook.com/1204435359699826/picture?type=large", "display_name": "Bilguun", "link": "https://stackoverflow.com/users/9629581/bilguun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1557302387, "creation_date": 1553506469, "last_edit_date": 1557302387, "question_id": 55334809, "link": "https://stackoverflow.com/questions/55334809/slice-by-value-of-array", "title": "Slice by value of array", "body": "<p>How to slice array by id</p>\n\n<pre><code>{\n  \"id\": 1\n  \"status\": \"available\" \n  \"snapshot_id\" : 1\n  ...\n},\n{\n   \"id\": 2\n   \"status\" \"non available\"\n   \"snapshot_id\" : 0\n   ...\n}\n</code></pre>\n\n<p>I didn't take it from Database or something. Need to slice by value like this but <strong>doesn't come from DB</strong></p>\n\n<pre><code>o.QueryTable(\"Ticket\").Filter(\"Status\", \"Pending\").All(&amp;newticket)\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1553502930, "post_id": 55333727, "comment_id": 97392859, "body": "I don&#39;t know what you are trying to achieve. But it happens because this middlewares run like it would be three nested <code>for</code> loops. Where each of them need to finnish before parent can execute again."}], "answers": [{"tags": [], "owner": {"reputation": 2702, "user_id": 2923336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LmjCO.png?s=128&g=1", "display_name": "Francois", "link": "https://stackoverflow.com/users/2923336/francois"}, "is_accepted": true, "score": 4, "last_activity_date": 1553513021, "last_edit_date": 1553513021, "creation_date": 1553503299, "answer_id": 55333958, "question_id": 55333727, "link": "https://stackoverflow.com/questions/55333727/middleware-execution-flow/55333958#55333958", "title": "Middleware execution flow", "body": "<p>Let make the stack a tree, it's easier to understand: </p>\n\n<pre><code>middlewareOne()\n    middlewareTwo()\n        finalHandler()\n            return finalHandler\n        return middlewareTwo\n\n    middlewareTwo again()\n        finalHandler()\n             return finalHandler()\n        return middlewareTwo again\n\n    return middleware one\n\nmiddlewareOne again()\n...\n</code></pre>\n\n<p>In order for <code>middleware one</code> to complete and move to <code>middleware one again</code> it needs the <code>middleware two</code> to return, as <code>middleware two</code> includes <code>middleware two again</code>, it needs to run <code>middleware two</code> again before completing.</p>\n"}], "owner": {"reputation": 5432, "user_id": 4723732, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77fa71fdc548472c228be40043c1bc1f?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Rublev", "link": "https://stackoverflow.com/users/4723732/richard-rublev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 1, "accepted_answer_id": 55333958, "answer_count": 1, "score": 1, "last_activity_date": 1553513021, "creation_date": 1553502261, "last_edit_date": 1553505544, "question_id": 55333727, "link": "https://stackoverflow.com/questions/55333727/middleware-execution-flow", "title": "Middleware execution flow", "body": "<p>I cannot grasp the execution flow of this code:</p>\n\n<pre><code>func middlewareOne(next http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        log.Println(\"Executing middlewareOne\")\n        next.ServeHTTP(w, r)\n        log.Println(\"Executing middlewareOne again\")\n        next.ServeHTTP(w, r)\n        log.Println(\"Executing middlewareOne yupiii\")\n    })\n}\n\nfunc middlewareTwo(next http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        log.Println(\"Executing middlewareTwo\")\n        next.ServeHTTP(w, r)\n        log.Println(\"Executing middlewareTwo again\")\n        next.ServeHTTP(w, r)\n    })\n}\n\nfunc final(w http.ResponseWriter, r *http.Request) {\n    log.Println(\"Executing finalHandler\")\n    w.Write([]byte(\"OK\"))\n}\n\nfunc main() {\n    finalHandler := http.HandlerFunc(final)\n    http.Handle(\"/\", middlewareOne(middlewareTwo(finalHandler)))\n    http.ListenAndServe(\":3000\", nil)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>2019/03/25 09:16:32 Executing middlewareOne\n2019/03/25 09:16:32 Executing middlewareTwo\n2019/03/25 09:16:32 Executing finalHandler\n2019/03/25 09:16:32 Executing middlewareTwo again\n2019/03/25 09:16:32 Executing finalHandler\n2019/03/25 09:16:32 Executing middlewareOne again\n2019/03/25 09:16:32 Executing middlewareTwo\n2019/03/25 09:16:32 Executing finalHandler\n2019/03/25 09:16:32 Executing middlewareTwo again\n2019/03/25 09:16:32 Executing finalHandler\n2019/03/25 09:16:32 Executing middlewareOne yupiii\n</code></pre>\n\n<p>Why does it print <code>middlewareTwo again</code> before <code>middlewareOne again</code>?</p>\n"}, {"tags": ["go", "channel"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1553502320, "post_id": 55333707, "comment_id": 97392591, "body": "You could use <code>interface {}</code>  as a type"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1553521150, "post_id": 55333707, "comment_id": 97403354, "body": "&quot;the Response type is defined in my main package&quot; - this is a design flaw. The <code>main</code> package should do as little as possible, and it <i>definitely</i> shouldn&#39;t define types, for exactly the reason you&#39;re seeing here."}, {"owner": {"reputation": 1128, "user_id": 11246894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55f8e8c47996c0510c64dbacab90104?s=128&d=identicon&r=PG&f=1", "display_name": "AJR", "link": "https://stackoverflow.com/users/11246894/ajr"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1553640216, "post_id": 55333707, "comment_id": 97458067, "body": "Thanks @Adrian for reading and understanding (and not down-voting what is a reasonable question I think :). I agree absolutely with your comment, but this project started as one main package and grew. I have been trying to separate parts of it into internal packages (as in this question) I will heed your advice and try to work out how to move the types into separate packages."}], "answers": [{"comments": [{"owner": {"reputation": 1128, "user_id": 11246894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55f8e8c47996c0510c64dbacab90104?s=128&d=identicon&r=PG&f=1", "display_name": "AJR", "link": "https://stackoverflow.com/users/11246894/ajr"}, "edited": false, "score": 0, "creation_date": 1553639581, "post_id": 55334124, "comment_id": 97457857, "body": "Thanks.  You are right it should be easy enough to have one chan variable and pass around a pointer to it. It just seems a bit redundant as I think a channel variable is essentially just a pointer to the real channel.  I agree the best thing is to create a new type but it makes little sense to declare it in my Login package and I can&#39;t declare it in the main package (circular ref), so I guess I need to put it in a new package that I import into main and Login packages."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 0, "last_activity_date": 1553503956, "creation_date": 1553503956, "answer_id": 55334124, "question_id": 55333707, "link": "https://stackoverflow.com/questions/55333707/how-to-obtain-a-channel-handle-without-an-associated-type/55334124#55334124", "title": "How to obtain a channel &quot;handle&quot; without an associated type", "body": "<blockquote>\n  <p>On the other hand I can't use a pointer to the channel variable (*chan&lt;- Response) as the handle as the channel is stored in several places so the channel variable will have different addresses.</p>\n</blockquote>\n\n<p>But this is the only (halfway acceptable solution): Do not pass around a <code>chan Response</code> but a <code>*(chan Response)</code> (adding directions to your likings). Everything else is crap. Best thing to do is hiding this chan Response in a type.</p>\n"}], "owner": {"reputation": 1128, "user_id": 11246894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55f8e8c47996c0510c64dbacab90104?s=128&d=identicon&r=PG&f=1", "display_name": "AJR", "link": "https://stackoverflow.com/users/11246894/ajr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1553503956, "creation_date": 1553502191, "last_edit_date": 1553502500, "question_id": 55333707, "link": "https://stackoverflow.com/questions/55333707/how-to-obtain-a-channel-handle-without-an-associated-type", "title": "How to obtain a channel &quot;handle&quot; without an associated type", "body": "<p>I have a backend (Go server) which services multiple frontends (web pages) and all requests/responses are handled via channels of specific types. Eg, each frontend is associated (on the backend) with a channel where responses are sent (type = chan&lt;- Response).</p>\n\n<p>I have recently implemented a login system where each frontend is associated with a user ID. To keep track of users I have a map:</p>\n\n<pre><code>logins map[chan&lt;- Response]LoginData\n</code></pre>\n\n<p>Using this I can quickly look up things related to a frontend, such as permissions.  This all works fine.</p>\n\n<p>However, to keep things safer and more modular I have moved all the Login stuff to a separate package.  This all works except for one gotcha - the logins map is keyed by the type \"chan&lt;- Response\", but the Response type is defined in my main package and I don't want to expose it to the Login package. (I don't think I could anyway as it would create a circular reference.)</p>\n\n<p>I only want to use the \"chan&lt;- Response\" as a handle type in the Login package - I don't need to write to that channel from there. I tried converting the channel to an unsafe.Pointer but that is not allowed by the compiler.  On the other hand I can't use a pointer to the channel variable  (*chan&lt;- Response) as the handle as the channel is stored in several places so the channel variable will have different addresses.</p>\n\n<p>I also tried casting to a different type of chan such as chan int and chan interface{} but the compiler does not like that. There does not seem to be any way to convert a channel into a \"generic\" channel.</p>\n\n<p>I really just want the address of the channel's internal data - like you get when you fmt.Printf a channel with %v.  The best I can come up with is to use a string like this:</p>\n\n<pre><code>var c chan&lt;- Response = ...\nvar userID = \"steve\"\nloginKey = fmt.Sprint(c)\nLogin.Add(loginKey, userID)\n</code></pre>\n\n<p>I'm not sure this is valid but seems to work, but it seems to me there should be a better way.</p>\n"}]