[{"tags": ["go"], "comments": [{"owner": {"reputation": 3378, "user_id": 2069150, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/filKc.jpg?s=128&g=1", "display_name": "Arch D. Robison", "link": "https://stackoverflow.com/users/2069150/arch-d-robison"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1429137911, "post_id": 29662003, "comment_id": 47463980, "body": "But how would I state that  map should use that method?  Worse yet, in my real code, the field a is a slice of int, and as far as I know, there is no built-in equality operations for silces."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1429137981, "post_id": 29662003, "comment_id": 47464000, "body": "Yeah in the FAQ <a href=\"https://golang.org/doc/faq\" rel=\"nofollow noreferrer\">golang.org/doc/faq</a> there is a question for &#39;why don&#39;t maps allow slices as keys&#39; and the answer is there is no built in equality operator. I proposed what I think is the most reasonable solution in my answer."}], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 7, "last_activity_date": 1560260655, "last_edit_date": 1560260655, "creation_date": 1429137906, "answer_id": 29662242, "question_id": 29662003, "link": "https://stackoverflow.com/questions/29662003/go-map-with-user-defined-key-with-user-defined-equality/29662242#29662242", "title": "Go map with user-defined key with user-defined equality?", "body": "<p>This is not possible in Go. There is no operator overloading or 'Equality' method you can override (due to not inheriting from a common base class like in .NET which your example reminds me of). This answer has more information on equality comparisons if you're interested; <a href=\"https://stackoverflow.com/questions/20309751/is-it-possible-to-define-equality-for-named-types-structs\">Is it possible to define equality for named types/structs?</a></p>\n\n<p>As mentioned in the comments if you want to make something like this work I would recommend using a property on the object as a key. You can define equality based on how you set the value of that property (like it could be a checksum of the objects bytes or something if you're looking for memberwise equality).</p>\n"}, {"comments": [{"owner": {"reputation": 3378, "user_id": 2069150, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/filKc.jpg?s=128&g=1", "display_name": "Arch D. Robison", "link": "https://stackoverflow.com/users/2069150/arch-d-robison"}, "edited": false, "score": 0, "creation_date": 1429196300, "post_id": 29663169, "comment_id": 47494417, "body": "Thanks.  In my real code I have slices as the keys.  I guess I&#39;ll have to use a very high quality hash  to 128-bit values, or &quot;hash&quot; them to strings."}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "reply_to_user": {"reputation": 3378, "user_id": 2069150, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/filKc.jpg?s=128&g=1", "display_name": "Arch D. Robison", "link": "https://stackoverflow.com/users/2069150/arch-d-robison"}, "edited": false, "score": 0, "creation_date": 1429196546, "post_id": 29663169, "comment_id": 47494624, "body": "@ArchD.Robison: sure, the builtin <a href=\"http://golang.org/pkg/crypto/md5/\" rel=\"nofollow noreferrer\"><code>crypto&#47;md5</code> package</a> might be helpful for that, or even a simple string representation of the slice via <a href=\"http://golang.org/pkg/fmt/#Sprintf\" rel=\"nofollow noreferrer\"><code>fmt.Sprintf(&quot;%v&quot;,slc)</code></a>."}], "tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 18, "last_activity_date": 1429193329, "last_edit_date": 1429193329, "creation_date": 1429143144, "answer_id": 29663169, "question_id": 29662003, "link": "https://stackoverflow.com/questions/29662003/go-map-with-user-defined-key-with-user-defined-equality/29663169#29663169", "title": "Go map with user-defined key with user-defined equality?", "body": "<p>Go has <a href=\"http://golang.org/ref/spec#Comparison_operators\" rel=\"noreferrer\">strict comparable semantics for values used as map keys</a>.  As such, you cannot define your own hash code and equality functions for map keys as you can in many other languages.</p>\n\n<p>However, consider the following workaround.  Instead of using the struct instances directly as a keys, use a derived attribute of the struct which is intrinsically usable as a key and has the equality semantics you desire.  Often it is simple to derive an integer or string value as a hash code which serves as the identity for an instance.</p>\n\n<p>For example:</p>\n\n<pre><code>type Key struct {\n  a *int\n}\n\nfunc (k *Key) HashKey() int {\n  return *(*k).a\n}\n\nk1, k2 := Key{intPtr(1)}, Key{intPtr(2)}\nm := map[int]string{}\nm[k1.HashKey()] = \"one\"\nm[k2.HashKey()] = \"two\"\n// m = map[int]string{1:\"one\", 2:\"two\"}\nm[k1.HashKey()] // =&gt; \"one\"\n</code></pre>\n\n<p>Of course, immutability is a critical concern with this approach.  In the example above, if you modify the field <code>a</code> then the instance can no longer be used as a hash key because its identity has changed.</p>\n"}], "owner": {"reputation": 3378, "user_id": 2069150, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/filKc.jpg?s=128&g=1", "display_name": "Arch D. Robison", "link": "https://stackoverflow.com/users/2069150/arch-d-robison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11358, "favorite_count": 0, "answer_count": 2, "score": 19, "last_activity_date": 1560260655, "creation_date": 1429136707, "question_id": 29662003, "link": "https://stackoverflow.com/questions/29662003/go-map-with-user-defined-key-with-user-defined-equality", "title": "Go map with user-defined key with user-defined equality?", "body": "<p>Suppose I have a struct type in Go that I want to use as a key in a map, but I <em>don't</em> want to use Go's builtin equality operation.  What's the best way to build such a map?</p>\n\n<p>For a concrete example, here is my key type and equality operation:</p>\n\n<pre><code>type Key struct {\n    a *int\n}\n\nfunc Equal(x Key, y Key) bool {\n    return *x.a == *y.a\n}\n</code></pre>\n\n<p>How can I build a map that uses <code>Equal</code> for key comparison?</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 1611, "user_id": 877856, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/ytALd.jpg?s=128&g=1", "display_name": "tj-recess", "link": "https://stackoverflow.com/users/877856/tj-recess"}, "edited": false, "score": 0, "creation_date": 1429137477, "post_id": 29661317, "comment_id": 47463826, "body": "Is this index impacting the performance of your app? Why do you want to reduce the size?"}, {"owner": {"reputation": 901, "user_id": 550292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f007116df8b3b452c8a2fc45e816eb69?s=128&d=identicon&r=PG", "display_name": "Anschel Schaffer-Cohen", "link": "https://stackoverflow.com/users/550292/anschel-schaffer-cohen"}, "reply_to_user": {"reputation": 1611, "user_id": 877856, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/ytALd.jpg?s=128&g=1", "display_name": "tj-recess", "link": "https://stackoverflow.com/users/877856/tj-recess"}, "edited": false, "score": 0, "creation_date": 1429137750, "post_id": 29661317, "comment_id": 47463915, "body": "@tj-recess Data storage is the main expense for my app, and this index is 20-40% of my data storage. So getting rid of it would save me a meaningful amount of money."}], "answers": [{"comments": [{"owner": {"reputation": 901, "user_id": 550292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f007116df8b3b452c8a2fc45e816eb69?s=128&d=identicon&r=PG", "display_name": "Anschel Schaffer-Cohen", "link": "https://stackoverflow.com/users/550292/anschel-schaffer-cohen"}, "edited": false, "score": 0, "creation_date": 1429137960, "post_id": 29661524, "comment_id": 47463994, "body": "So in this model the app itself would manually mark which entities it wants to be in the index?"}, {"owner": {"reputation": 38473, "user_id": 821657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qDRGg.png?s=128&g=1", "display_name": "Andrei Volgin", "link": "https://stackoverflow.com/users/821657/andrei-volgin"}, "reply_to_user": {"reputation": 901, "user_id": 550292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f007116df8b3b452c8a2fc45e816eb69?s=128&d=identicon&r=PG", "display_name": "Anschel Schaffer-Cohen", "link": "https://stackoverflow.com/users/550292/anschel-schaffer-cohen"}, "edited": false, "score": 0, "creation_date": 1429140191, "post_id": 29661524, "comment_id": 47464786, "body": "Yes, you can do that."}], "tags": [], "owner": {"reputation": 38473, "user_id": 821657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qDRGg.png?s=128&g=1", "display_name": "Andrei Volgin", "link": "https://stackoverflow.com/users/821657/andrei-volgin"}, "is_accepted": false, "score": 1, "last_activity_date": 1429134448, "creation_date": 1429134448, "answer_id": 29661524, "question_id": 29661317, "link": "https://stackoverflow.com/questions/29661317/create-a-limited-datastore-index/29661524#29661524", "title": "Create a limited datastore index", "body": "<p>It is possible to have two entities of the same kind to have the same property, but one entity having this property indexed and the other unindexed.</p>\n\n<p>The low-level Datastore API in Java runtime allows an app to decide whether to index or not each property for each individual entity. I don't know if an equivalent exists in other runtimes. If not, you can use two different property names to indicate an indexed date and unindexed date.</p>\n\n<p>So technically, yes, you can keep only a small number of entities in the index. Note, however, that you will have to re-save an entity with a property unindexed in order to remove it from that index. Re-saving all entities will incur additional costs, so this solution probably makes sense if you re-save an entity anyway for any other reason.</p>\n"}], "owner": {"reputation": 901, "user_id": 550292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f007116df8b3b452c8a2fc45e816eb69?s=128&d=identicon&r=PG", "display_name": "Anschel Schaffer-Cohen", "link": "https://stackoverflow.com/users/550292/anschel-schaffer-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475277280, "creation_date": 1429133528, "last_edit_date": 1475277280, "question_id": 29661317, "link": "https://stackoverflow.com/questions/29661317/create-a-limited-datastore-index", "title": "Create a limited datastore index", "body": "<p>I have a query in my GAE app that looks like this:</p>\n\n<pre><code>datastore.NewQuery(\"item\").Ancestor(fk).Order(\"-PubDate\").Limit(10).Run(c)\n</code></pre>\n\n<p>In order for this to work I need an index of items ordered by PubDate; the autogenerated one looks like:</p>\n\n<pre><code>- kind: item\n  ancestor: yes\n  properties:\n  - name: PubDate\n    direction: desc\n</code></pre>\n\n<p>This index is pretty big (about 4 GB) but most of it will never be touched because of that Limit() call. Is it possible to have the index only remember 10 results for each ancestor?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 9071, "user_id": 1003632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/80a7f76fb4682911dc2f56d7cf491454?s=128&d=identicon&r=PG", "display_name": "tommyd456", "link": "https://stackoverflow.com/users/1003632/tommyd456"}, "edited": false, "score": 0, "creation_date": 1429130704, "post_id": 29660498, "comment_id": 47460528, "body": "Why is there a <code>.git&#47;</code> directory above the hello directory in the directory structure?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 9071, "user_id": 1003632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/80a7f76fb4682911dc2f56d7cf491454?s=128&d=identicon&r=PG", "display_name": "tommyd456", "link": "https://stackoverflow.com/users/1003632/tommyd456"}, "edited": false, "score": 0, "creation_date": 1429130743, "post_id": 29660498, "comment_id": 47460547, "body": "@tommyd456 I was editing my answer to address precisely that."}, {"owner": {"reputation": 9071, "user_id": 1003632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/80a7f76fb4682911dc2f56d7cf491454?s=128&d=identicon&r=PG", "display_name": "tommyd456", "link": "https://stackoverflow.com/users/1003632/tommyd456"}, "edited": false, "score": 0, "creation_date": 1429130827, "post_id": 29660498, "comment_id": 47460589, "body": "oh right - that&#39;s the bit that confused me and why I didn&#39;t find it clear. Thanks for that."}, {"owner": {"reputation": 1227, "user_id": 418772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812e307892de3240c2b50a3e66295f84?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/418772/rob"}, "edited": false, "score": 0, "creation_date": 1429131001, "post_id": 29660498, "comment_id": 47460683, "body": "What is the recommendation to not have random versions all jumbled together?  If I compile my code at a particular commit, then it should have references to the other modules at the commits that they were compiled at."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 1227, "user_id": 418772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812e307892de3240c2b50a3e66295f84?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/418772/rob"}, "edited": false, "score": 0, "creation_date": 1429131098, "post_id": 29660498, "comment_id": 47460731, "body": "@Rob There is a big debate about that: <a href=\"https://groups.google.com/forum/m/#!topic/golang-dev/nMWoEAG55v8\" rel=\"nofollow noreferrer\">groups.google.com/forum/m/#!topic/golang-dev/nMWoEAG55v8</a>. Vendoring seems to be the main solution."}, {"owner": {"reputation": 1227, "user_id": 418772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812e307892de3240c2b50a3e66295f84?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/418772/rob"}, "edited": false, "score": 0, "creation_date": 1429131361, "post_id": 29660498, "comment_id": 47460901, "body": "Note that this problem is bigger than golang as well.  If you have a large project split into hundreds of git repos (we do), then you ultimately need to be able to wrap git to checkout/branch/rebase-with-conflicts/merge/push groups of repos in a pseudo-transactional way.  Having a way to handle references to large binaries is part of the the solution, but you need to be able to checkout the code that corresponds to exactly what created a historical build."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 1227, "user_id": 418772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812e307892de3240c2b50a3e66295f84?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/418772/rob"}, "edited": false, "score": 0, "creation_date": 1429131636, "post_id": 29660498, "comment_id": 47461073, "body": "@Rob for git repos in general, that would be using submodules (<a href=\"http://stackoverflow.com/a/1979194/6309\">stackoverflow.com/a/1979194/6309</a>)"}, {"owner": {"reputation": 1227, "user_id": 418772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812e307892de3240c2b50a3e66295f84?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/418772/rob"}, "edited": false, "score": 0, "creation_date": 1429136767, "post_id": 29660498, "comment_id": 47463571, "body": "In some cases, yes.  But it&#39;s not quite that simple.  Git submodules handles source repo to source repo dependencies.  When you have hundreds of repos that would take days to compile from source (we do), you generally have source to <i>build</i> dependencies (where builds reference a repo commit, or an immutable artifact like a jar file)."}, {"owner": {"reputation": 1227, "user_id": 418772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812e307892de3240c2b50a3e66295f84?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/418772/rob"}, "edited": false, "score": 0, "creation_date": 1429137134, "post_id": 29660498, "comment_id": 47463719, "body": "ie: a product CD was built from 200 git repos, some are conflicting versions of same repo even.  you want to check out 4 or 5 of them to edit and make a product CD to test it.  it&#39;s a dependency graph where commits reference built versions of other repo&#39;s commits.  the builds are named after the commits they were built from so you can view and edit the source that created them."}, {"owner": {"reputation": 1227, "user_id": 418772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812e307892de3240c2b50a3e66295f84?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/418772/rob"}, "edited": false, "score": 0, "creation_date": 1429137364, "post_id": 29660498, "comment_id": 47463787, "body": "submodules are also orthogonal to uniformly creating/rebasing/switching/pushing a bug branch as one item... as if they are just conceptually part of a multi-gigabyte git repo."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 6, "last_activity_date": 1429130726, "last_edit_date": 1429130726, "creation_date": 1429130486, "answer_id": 29660498, "question_id": 29660362, "link": "https://stackoverflow.com/questions/29660362/where-to-initialise-git-in-go-project/29660498#29660498", "title": "Where to initialise git in Go project", "body": "<p><a href=\"https://golang.org/doc/code.html#Command\" rel=\"noreferrer\">The example</a> is clear:</p>\n\n<pre><code>$ cd $GOPATH/src/github.com/user/hello\n$ git init\n</code></pre>\n\n<p>You do initialize the repo within your project 'hello'.<br>\nThat way:</p>\n\n<ul>\n<li><p>you can push it to your GitHub repo (that you need to create first on GitHub, empty):</p>\n\n<pre><code>git remote add origin https://&lt;user&gt;@github.com/&lt;user&gt;/hello\ngit push -u origin master\n</code></pre></li>\n<li><p>your go project is \"go gettable\"</p>\n\n<pre><code>go get github.com/&lt;user&gt;/hello\n# that would clone and compile the project in `$GOPATH/src/github.com/&lt;user&gt;/hello`.\n</code></pre></li>\n</ul>\n\n<hr>\n\n<p>The <code>.git</code> you see <em>outside</em> <code>hello</code> (<a href=\"https://golang.org/doc/code.html#Workspaces\" rel=\"noreferrer\">on the same page</a>) is for <em>another</em> project:</p>\n\n<pre><code>src/\n    github.com/golang/example/\n        .git/                      # Git repository metadata\n    hello/\n        hello.go               # command source\n</code></pre>\n\n<p>Here, the project is '<code>example</code>' and include several packages, including the <code>hello</code> one.</p>\n"}, {"comments": [{"owner": {"reputation": 9071, "user_id": 1003632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/80a7f76fb4682911dc2f56d7cf491454?s=128&d=identicon&r=PG", "display_name": "tommyd456", "link": "https://stackoverflow.com/users/1003632/tommyd456"}, "edited": false, "score": 0, "creation_date": 1429131064, "post_id": 29660620, "comment_id": 47460718, "body": "I see - and typically that <code>hello.go</code> file would be <code>main.go</code> right when moving into &quot;real&quot; projects?"}, {"owner": {"reputation": 15599, "user_id": 73831, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4813b578ef6e0ca5ba25a77f57fdb5f1?s=128&d=identicon&r=PG", "display_name": "Sudhir Jonathan", "link": "https://stackoverflow.com/users/73831/sudhir-jonathan"}, "reply_to_user": {"reputation": 9071, "user_id": 1003632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/80a7f76fb4682911dc2f56d7cf491454?s=128&d=identicon&r=PG", "display_name": "tommyd456", "link": "https://stackoverflow.com/users/1003632/tommyd456"}, "edited": false, "score": 0, "creation_date": 1429131127, "post_id": 29660620, "comment_id": 47460748, "body": "If hello it a library, it would probably stay as <code>hello.go</code>. If your project is meant to be an executable, <code>main.go</code> is going to be necessary. But either way the package name is more important."}], "tags": [], "owner": {"reputation": 15599, "user_id": 73831, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4813b578ef6e0ca5ba25a77f57fdb5f1?s=128&d=identicon&r=PG", "display_name": "Sudhir Jonathan", "link": "https://stackoverflow.com/users/73831/sudhir-jonathan"}, "is_accepted": false, "score": 0, "last_activity_date": 1429130943, "creation_date": 1429130943, "answer_id": 29660620, "question_id": 29660362, "link": "https://stackoverflow.com/questions/29660362/where-to-initialise-git-in-go-project/29660620#29660620", "title": "Where to initialise git in Go project", "body": "<p>You'd want to initialize it at the same level as it would have been if you'd run <code>go get github.com/user/hello</code> - i.e. in the <code>hello</code> directory.</p>\n\n<p>Basically, if you initialize git, push your repo up an <code>go get</code> again, nothing should change. </p>\n"}], "owner": {"reputation": 9071, "user_id": 1003632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/80a7f76fb4682911dc2f56d7cf491454?s=128&d=identicon&r=PG", "display_name": "tommyd456", "link": "https://stackoverflow.com/users/1003632/tommyd456"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1373, "favorite_count": 1, "accepted_answer_id": 29660498, "answer_count": 2, "score": 4, "last_activity_date": 1429130943, "creation_date": 1429130075, "question_id": 29660362, "link": "https://stackoverflow.com/questions/29660362/where-to-initialise-git-in-go-project", "title": "Where to initialise git in Go project", "body": "<p>As a complete beginner to Go I'm not sure where to <code>init</code> Git.</p>\n\n<p>The docs here <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow\">https://golang.org/doc/code.html</a> appear to suggest outside the <strong>hello</strong> directory early on and then later tell me to run <code>git init</code> inside the <strong>hello</strong> directory.</p>\n\n<p>Any advice on this would be useful.</p>\n"}, {"tags": ["unix", "go", "docker"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1429129596, "post_id": 29660108, "comment_id": 47459916, "body": "how are you running the container where you <i>can&#39;t</i> pass the arguments you want?"}], "answers": [{"tags": [], "owner": {"reputation": 1267, "user_id": 1598790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a11ea12f06eefbb34068f4c1090e2e0b?s=128&d=identicon&r=PG", "display_name": "ramrunner", "link": "https://stackoverflow.com/users/1598790/ramrunner"}, "is_accepted": false, "score": 2, "last_activity_date": 1429216087, "last_edit_date": 1429216087, "creation_date": 1429136178, "answer_id": 29661891, "question_id": 29660108, "link": "https://stackoverflow.com/questions/29660108/how-can-i-pass-command-line-options-to-my-dockerized-golang-program/29661891#29661891", "title": "How can I pass command line options to my dockerized GoLang program?", "body": "<p>Right now you are only getting your source in the running container and then it exits.\nYou need to actually RUN your program with the desired arguments once you build it or RUN a shell from which you will call your program.\ni hope this Dockerfile that i'm providing will help as a guide.</p>\n\n<p>i have locally a bashrc that exports GOPATH GOBIN and PATH or you can \nuse the ENV statements in the dockerfile. i also usually have checked out\na working copy of my program where i'm building the image and i copy that in the container. This setup is just to give you ideas to solve future problems.</p>\n\n<pre><code>export GOPATH=\"/root/go\"\nexport GOBIN=\"/root/go/bin\"\nexport PATH=\"/root/go/bin:$PATH\"\n</code></pre>\n\n<p>then my Dockerfile is</p>\n\n<pre><code>FROM ubuntu:14.04\nMAINTAINER foo, bar@baz.org\nCOPY bashrc /root/.bashrc\nCOPY MYPROGRAM /root/go/src/MYPROGRAM\nENV GOBIN /root/go/bin\nENV GOPATH /root/go\nENV PATH /root/go/bin:$PATH\nENV HOME /root\nWORKDIR /root\nRUN \\\n  apt-get update &amp;&amp; \\\n  apt-get install -y golang git &amp;&amp; \\\n  mkdir -p /root/go/src &amp;&amp; \\\n  mkdir -p /root/go/bin &amp;&amp; \\\n  go get DEPENDENCIES\n\nRUN go install /root/go/src/MYPROGRAM/program.go\nENTRYPOINT [\"program\"]\n</code></pre>\n\n<p>now that the entry point of the container is your program you can </p>\n\n<pre><code>docker run img args-to-your-prog\n</code></pre>\n\n<p>you can also add the args to the ENTRYPOINT statement like</p>\n\n<pre><code>ENTRYPOINT[\"program\", \"arg1\", ...]\n</code></pre>\n\n<p>or you can use bash as an entry point and get your program as an argument</p>\n\n<pre><code>docker run img program arg1 ...\n</code></pre>\n\n<p>ENTRYPOINT is the program being executed and if it is set CMD will be \nthe args passed to it. CMD is the default argument to the container. if \nENTRYPOINT is not set them CMD will be the command executed directly.</p>\n"}, {"comments": [{"owner": {"reputation": 796, "user_id": 4793737, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/TrTs9.jpg?s=128&g=1", "display_name": "Donovan", "link": "https://stackoverflow.com/users/4793737/donovan"}, "edited": false, "score": 0, "creation_date": 1429170338, "post_id": 29661970, "comment_id": 47475290, "body": "If I do that I can&#39;t link it to another Redis container. I want my app to connect to a Redis container on the default port. How can I do that?"}], "tags": [], "owner": {"reputation": 506, "user_id": 2187902, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b5d72ff9ff2b357042b7827562e3c13b?s=128&d=identicon&r=PG", "display_name": "SGer", "link": "https://stackoverflow.com/users/2187902/sger"}, "is_accepted": false, "score": 0, "last_activity_date": 1429136566, "creation_date": 1429136566, "answer_id": 29661970, "question_id": 29660108, "link": "https://stackoverflow.com/questions/29660108/how-can-i-pass-command-line-options-to-my-dockerized-golang-program/29661970#29661970", "title": "How can I pass command line options to my dockerized GoLang program?", "body": "<p>Adding the following line should work:\n<code>ENTRYPOINT [\"go\", \"run\", \"yourapp\"]</code>, see <a href=\"http://docs.docker.com/reference/builder/#entrypoint\" rel=\"nofollow\">Docker Doc</a> and <a href=\"https://gobyexample.com/command-line-arguments\" rel=\"nofollow\">Go commandline example</a>.</p>\n\n<p>Then you just put the arguments for your go program at the end of the docker run call, e.g. <code>docker run mygoapp arg1 arg2</code>. The arguments should then be passed to your go program.</p>\n"}, {"tags": [], "owner": {"reputation": 1333, "user_id": 1664082, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nPM2x.jpg?s=128&g=1", "display_name": "btburton42", "link": "https://stackoverflow.com/users/1664082/btburton42"}, "is_accepted": false, "score": 1, "last_activity_date": 1492643562, "creation_date": 1492643562, "answer_id": 43507573, "question_id": 29660108, "link": "https://stackoverflow.com/questions/29660108/how-can-i-pass-command-line-options-to-my-dockerized-golang-program/43507573#43507573", "title": "How can I pass command line options to my dockerized GoLang program?", "body": "<p>As long as your app compiles to a single binary per Go convention you should be able to use this simple two liner below, passing any subsequent flags as array-like parameters in the <code>ENTRYPOINT</code> instruction.</p>\n\n<pre><code>FROM golang:onbuild\nENTRYPOINT [\"/go/bin/app\", \"-name=foo\", \"-title=bar\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4860, "user_id": 349423, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/182de69716d93b94b94284af2316542a?s=128&d=identicon&r=PG", "display_name": "sorens", "link": "https://stackoverflow.com/users/349423/sorens"}, "is_accepted": false, "score": -1, "last_activity_date": 1591313531, "last_edit_date": 1591313531, "creation_date": 1564721667, "answer_id": 57320138, "question_id": 29660108, "link": "https://stackoverflow.com/questions/29660108/how-can-i-pass-command-line-options-to-my-dockerized-golang-program/57320138#57320138", "title": "How can I pass command line options to my dockerized GoLang program?", "body": "<p>Here is a simplified version of the recipe I use:</p>\n\n<pre><code>[sorens | ~/src/go/hello&gt; ls -al\ntotal 16\ndrwxr-xr-x   4 sorens  staff  128 Aug  1 21:46 .\ndrwxr-xr-x  11 sorens  staff  352 Jun 25 13:21 ..\n-rw-r--r--@  1 sorens  staff  118 Aug  1 21:43 Dockerfile\n-rw-r--r--   1 sorens  staff  153 Aug  1 15:42 hello.go\n</code></pre>\n\n<p>Dockerfile:</p>\n\n<pre><code>FROM golang:1.12.7\nWORKDIR /go/src/hello\nCOPY . .\nRUN go get -d -v ./...\nRUN go install -v ./...\nENTRYPOINT [\"hello\"]\n</code></pre>\n\n<p>hello.go</p>\n\n<pre><code>package main\n\nimport \"os\"\nimport \"fmt\"\n\nfunc main() {\n    name := \"world\"\n    if (len(os.Args) &gt; 1) {\n        name = os.Args[1]\n    }\n    fmt.Printf(\"hello, %s\\n\", name)\n}\n</code></pre>\n\n<p>Compile and run the code locally to see that it works:</p>\n\n<pre><code>[sorens | ~/src/go/hello&gt; go build hello.go\n[sorens | ~/src/go/hello&gt; ./hello\nhello, world\n[sorens | ~/src/go/hello&gt; ./hello there\nhello, there\n</code></pre>\n\n<p>Now, build it in Docker:</p>\n\n<pre><code>[sorens | ~/src/go/hello&gt; docker build -t hw .\nSending build context to Docker daemon  2.128MB\nStep 1/6 : FROM golang:1.12.7\n1.12.7: Pulling from library/golang\n5ae19949497e: Pull complete \ned3d96a2798e: Pull complete \nf12136850781: Pull complete \n1a9ad5d5550b: Pull complete \nefbd5496b163: Pull complete \nc01c378f53ca: Pull complete \nc7aef280980d: Pull complete \nDigest: sha256:f5486a917b57f8b14be4345604bc4654147416a327d6d63271a0c52c907001c4\nStatus: Downloaded newer image for golang:1.12.7\n ---&gt; be63d15101cb\nStep 2/6 : WORKDIR /go/src/hello\n ---&gt; Running in 4f362ab0be79\nRemoving intermediate container 4f362ab0be79\n ---&gt; 47a247a9b603\nStep 3/6 : COPY . .\n ---&gt; b1e53c8f9166\nStep 4/6 : RUN go get -d -v ./...\n ---&gt; Running in 309331f04485\nRemoving intermediate container 309331f04485\n ---&gt; 088f49d8ee5f\nStep 5/6 : RUN go install -v ./...\n ---&gt; Running in 83e5937ece78\nhello\nRemoving intermediate container 83e5937ece78\n ---&gt; 8cd1d6ffefa8\nStep 6/6 : ENTRYPOINT [\"hello\"]\n ---&gt; Running in dae06fb3343e\nRemoving intermediate container dae06fb3343e\n ---&gt; c04a6307cdc8\nSuccessfully built c04a6307cdc8\nSuccessfully tagged hw:latest\n</code></pre>\n\n<p>And run it:</p>\n\n<pre><code>[sorens | ~/src/go/hello&gt; docker run hw\nhello, world\n[sorens | ~/src/go/hello&gt; docker run hw there\nhello, there\n</code></pre>\n\n<p><code>docker run hw</code> does not pass any arguments to the docker container and therefore hello.go prints <code>hello, world</code>. However, when you add <code>there</code> to the end of the docker command, that is passed to the docker container and to the entrypoint hello.go which then branches and displays <code>hello, there</code> instead.</p>\n\n<p>I posted it on github: <a href=\"https://github.com/sorens/cli-golang-via-docker\" rel=\"nofollow noreferrer\">https://github.com/sorens/cli-golang-via-docker</a></p>\n"}], "owner": {"reputation": 796, "user_id": 4793737, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/TrTs9.jpg?s=128&g=1", "display_name": "Donovan", "link": "https://stackoverflow.com/users/4793737/donovan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4737, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1591313531, "creation_date": 1429129181, "last_edit_date": 1429145931, "question_id": 29660108, "link": "https://stackoverflow.com/questions/29660108/how-can-i-pass-command-line-options-to-my-dockerized-golang-program", "title": "How can I pass command line options to my dockerized GoLang program?", "body": "<p>I have a simple dockerized golang program and I want to be able to send command line options to it when I run the container.</p>\n\n<p>My Dockerfile looks like this:</p>\n\n<pre><code>FROM golang:onbuild\nRUN go get [MY PROGRAM]\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 9071, "user_id": 1003632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/80a7f76fb4682911dc2f56d7cf491454?s=128&d=identicon&r=PG", "display_name": "tommyd456", "link": "https://stackoverflow.com/users/1003632/tommyd456"}, "edited": false, "score": 0, "creation_date": 1429127807, "post_id": 29659664, "comment_id": 47458885, "body": "Oh right - I don&#39;t think the example directory structure makes this clear but thanks"}], "tags": [], "owner": {"reputation": 1523, "user_id": 3791794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/378946c1efd33604a905ef2fd60839a1?s=128&d=identicon&r=PG&f=1", "display_name": "Simba", "link": "https://stackoverflow.com/users/3791794/simba"}, "is_accepted": true, "score": 4, "last_activity_date": 1429127743, "creation_date": 1429127743, "answer_id": 29659664, "question_id": 29659626, "link": "https://stackoverflow.com/questions/29659626/setting-package-path-in-go/29659664#29659664", "title": "Setting package path in Go", "body": "<p>This is actually the intended behavior,</p>\n\n<p>You can even call <code>go get</code> on a github repo and it will create this same directory structure</p>\n"}, {"tags": [], "owner": {"reputation": 1505, "user_id": 93767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/482a7936cd83ef263090c6d4dbc22179?s=128&d=identicon&r=PG", "display_name": "Radim", "link": "https://stackoverflow.com/users/93767/radim"}, "is_accepted": false, "score": 6, "last_activity_date": 1429128182, "creation_date": 1429128182, "answer_id": 29659794, "question_id": 29659626, "link": "https://stackoverflow.com/questions/29659626/setting-package-path-in-go/29659794#29659794", "title": "Setting package path in Go", "body": "<p>The behavior is correct. The packages names in Go provide unique global name space. </p>\n\n<p><code>github.com/user/repo</code> therefore identifies a package, which is easily <code>go get</code> -able (download and install the package) and also provides much needed separation. You can also create packages without a hostname (in this case github.com) but effectively preventing users from using <code>go get</code> and resorting to manual management.</p>\n\n<p>Having a username in GitHub case allows you to use forks of other libraries and maintain the separation. The full package name is then used for importing</p>\n\n<pre><code>import \"github.com/user/repo\"\n</code></pre>\n"}], "owner": {"reputation": 9071, "user_id": 1003632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/80a7f76fb4682911dc2f56d7cf491454?s=128&d=identicon&r=PG", "display_name": "tommyd456", "link": "https://stackoverflow.com/users/1003632/tommyd456"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1259, "favorite_count": 0, "accepted_answer_id": 29659664, "answer_count": 2, "score": 1, "last_activity_date": 1429128182, "creation_date": 1429127654, "question_id": 29659626, "link": "https://stackoverflow.com/questions/29659626/setting-package-path-in-go", "title": "Setting package path in Go", "body": "<p>Getting started with Go and going through the docs here: <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow\">https://golang.org/doc/code.html</a></p>\n\n<p>The part entitled <strong>Package paths</strong> recommends using my Github account as a base path. However, with the forward slashes in the GH url, when I run <code>mkdir -p $GOPATH/src/github.com/user</code> it creates a sub-folder. So the example of <code>github.com/user</code> creates:</p>\n\n<pre><code>src/\n    github.com/\n        user/\n</code></pre>\n\n<p>but I don't think this is what's intended.</p>\n\n<p>What can I do here?</p>\n"}, {"tags": ["go", "io", "output", "standard-library"], "comments": [{"owner": {"reputation": 3498, "user_id": 528578, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Qgscj.png?s=128&g=1", "display_name": "Jerry Saravia", "link": "https://stackoverflow.com/users/528578/jerry-saravia"}, "edited": false, "score": 0, "creation_date": 1429131593, "post_id": 29658892, "comment_id": 47461043, "body": "very interesting question."}], "answers": [{"comments": [{"owner": {"reputation": 3498, "user_id": 528578, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Qgscj.png?s=128&g=1", "display_name": "Jerry Saravia", "link": "https://stackoverflow.com/users/528578/jerry-saravia"}, "edited": false, "score": 0, "creation_date": 1429131972, "post_id": 29659115, "comment_id": 47461264, "body": "I might agree outright but it&#39;s interesting to note that in the language spec, an int might be either 32 or 64 bits, depending on the implementation/architecture. Without looking at other packages that use the <code>WriterTo</code> and <code>Writer</code> interfaces my guess is the authors might&#39;ve intuited that the <code>WriterTo</code>/<code>ReaderFrom</code> interfaces had more potential for having to deal with larger amounts of data."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 3498, "user_id": 528578, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Qgscj.png?s=128&g=1", "display_name": "Jerry Saravia", "link": "https://stackoverflow.com/users/528578/jerry-saravia"}, "edited": false, "score": 0, "creation_date": 1429132311, "post_id": 29659115, "comment_id": 47461478, "body": "@JerrySaravia: that&#39;s the point, WriterTo and ReaderFrom <i>can</i> handle larger amounts of data. They&#39;re not limited to using a single slice for the operation. There&#39;s nothing to guess about."}, {"owner": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "edited": false, "score": 0, "creation_date": 1429132837, "post_id": 29659115, "comment_id": 47461759, "body": "That&#39;s a good point. I guess <code>WriterTo</code> could be copying a file that is larger than 2GB or something like that. But then why not just use <code>int64</code> everywhere for consistency?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "edited": false, "score": 2, "creation_date": 1429134479, "post_id": 29659115, "comment_id": 47462637, "body": "@Matt: because it&#39;s <i>more</i> consistent to return an <code>int</code> everywhere where it&#39;s the appropriate data type, rather than convert everything to <code>int64</code> for the fewer cases where that&#39;s possible on some system. The value from Read and Write is in terms of the length of a slice, and is often used to index into slices. There would be a lot more conversion to do the other way."}, {"owner": {"reputation": 3498, "user_id": 528578, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Qgscj.png?s=128&g=1", "display_name": "Jerry Saravia", "link": "https://stackoverflow.com/users/528578/jerry-saravia"}, "edited": false, "score": 0, "creation_date": 1429147757, "post_id": 29659115, "comment_id": 47466938, "body": "@JimB Are slices limited in size? I thought their only limit was the size of the available memory."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 3498, "user_id": 528578, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Qgscj.png?s=128&g=1", "display_name": "Jerry Saravia", "link": "https://stackoverflow.com/users/528578/jerry-saravia"}, "edited": false, "score": 0, "creation_date": 1429192679, "post_id": 29659115, "comment_id": 47491468, "body": "@JerrySaravia: all that means is the length and capacity of slices are limited by the size of <code>int</code>. On 386 or amd64p32 you can allocate the entire 32bit address space, but a slice can only have a capacity of MaxInt32."}, {"owner": {"reputation": 3498, "user_id": 528578, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Qgscj.png?s=128&g=1", "display_name": "Jerry Saravia", "link": "https://stackoverflow.com/users/528578/jerry-saravia"}, "edited": false, "score": 0, "creation_date": 1429208027, "post_id": 29659115, "comment_id": 47502578, "body": "@JimB Thanks, that makes things clearer to me. Thanks. On 64 bit implementations of, int the two end up being equivalent. But on 32 bit implementations the WriterTo is specific and says, &quot;expect that we might right more than a 32 bit int&#39;s worth of data.&quot;"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 6, "last_activity_date": 1429126692, "last_edit_date": 1429126692, "creation_date": 1429126114, "answer_id": 29659115, "question_id": 29658892, "link": "https://stackoverflow.com/questions/29658892/why-does-io-writertos-writeto-method-return-an-int64-rather-than-an-int/29659115#29659115", "title": "Why does io.WriterTo&#39;s WriteTo method return an int64 rather than an int?", "body": "<p>It's possible that <code>WriteTo</code> copies more than int32 bytes of data. </p>\n\n<p>With the <code>io.Reader</code>and <code>io.Writer</code> interfaces, the amount of data is limited by the size of the given slice, which has a length limited by <code>int</code> for the current architecture.</p>\n"}, {"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1429200929, "post_id": 29666087, "comment_id": 47498007, "body": "A more trivial example would be any random type that implemented <code>WriteTo</code> for something that could have a &gt;31 bit representation (e.g. a type representing/holding a 2.01 GB video; or a silly <code>type Zeros int64</code> type that is defined as writing out that many zeros)."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 5, "last_activity_date": 1429212708, "last_edit_date": 1429212708, "creation_date": 1429162385, "answer_id": 29666087, "question_id": 29658892, "link": "https://stackoverflow.com/questions/29658892/why-does-io-writertos-writeto-method-return-an-int64-rather-than-an-int/29666087#29666087", "title": "Why does io.WriterTo&#39;s WriteTo method return an int64 rather than an int?", "body": "<p>The signature of the <a href=\"http://golang.org/pkg/io/#Writer\" rel=\"nofollow\"><code>Writer.Write()</code></a> method:</p>\n\n<pre><code>Write(p []byte) (n int, err error)\n</code></pre>\n\n<p>It writes the contents of a <em>slice</em>. Quoting from the <a href=\"https://golang.org/ref/spec#Slice_types\" rel=\"nofollow\">spec: Slice types</a>:</p>\n\n<blockquote>\n  <p>A slice is a descriptor for a contiguous segment of an <em>underlying array</em>...</p>\n</blockquote>\n\n<p>As we all know, the slice has an underlying array. Quoting again from the <a href=\"https://golang.org/ref/spec#Array_types\" rel=\"nofollow\">Spec: Array types</a>:</p>\n\n<blockquote>\n  <p>The length is part of the array's type; it must evaluate to a non-negative constant representable by a value of type <code>int</code>. </p>\n</blockquote>\n\n<p>So the maximum length of an array is limited by the maximum value of the <code>int</code> type (which is <code>2147483647</code> in case of 32 bit and <code>9223372036854775807</code> in case of 64 bit architectures).</p>\n\n<p>So back to the <code>Writer.Write()</code> method: since it writes the content of the passed slice, it is <strong>guaranteed</strong> that the number of written bytes will <strong>not</strong> be more that what fits into an <code>int</code>.</p>\n\n<p>Now <a href=\"http://golang.org/pkg/io/#WriterTo\" rel=\"nofollow\"><code>WriteTo.WriteTo()</code></a> method:</p>\n\n<pre><code>WriteTo(w Writer) (n int64, err error)\n</code></pre>\n\n<p>A slice or array is nowhere mentioned. You have <strong>no guarantees</strong> that the result will fit into an <code>int</code>, so the <code>int64</code> is more than justified.</p>\n\n<p><strong>Example: <code>BigBuffer</code></strong></p>\n\n<p>Imagine a <code>BigBuffer</code> implementation which temporarily writes data into an array or slice. The implementation may manage multiple arrays so that if one is full (e.g. reached max int), continues in another one. Now if this <code>BigBuffer</code> implements the <code>WriteTo</code> interface and you call this method to write the content into an <code>os.File</code>, the result will be more than max <code>int</code>.</p>\n"}], "owner": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 714, "favorite_count": 0, "accepted_answer_id": 29659115, "answer_count": 2, "score": 6, "last_activity_date": 1429212708, "creation_date": 1429125400, "question_id": 29658892, "link": "https://stackoverflow.com/questions/29658892/why-does-io-writertos-writeto-method-return-an-int64-rather-than-an-int", "title": "Why does io.WriterTo&#39;s WriteTo method return an int64 rather than an int?", "body": "<p>Most of the output methods in <a href=\"http://golang.org/pkg/io/\">Go's <code>io</code> package</a> return <code>(int, error)</code>, for example <code>io.Writer</code>'s <code>Write([]byte)</code> method and the <code>io.WriteString(io.Writer, string)</code> function. However, a few of the output methods, such as <code>io.WriterTo</code>'s <code>WriteTo</code> method, return <code>(int64, error)</code> instead. This makes it inconvenient to implement <code>WriteTo</code> in terms of <code>Write</code> or <code>WriteString</code> without storing an intermediate value and type converting it from <code>int</code> to <code>int64</code>. What is the reason for this discrepancy?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1429125496, "post_id": 29658757, "comment_id": 47457444, "body": "On a side note, you should never return specific error types, only the error interface (for precisely this reason)."}], "answers": [{"tags": [], "owner": {"reputation": 19482, "user_id": 1048862, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a0f604322f5a3e0b11aad4c3529f83b5?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/1048862/matt"}, "is_accepted": true, "score": 3, "last_activity_date": 1429125118, "creation_date": 1429125118, "answer_id": 29658805, "question_id": 29658757, "link": "https://stackoverflow.com/questions/29658757/cannot-use-err-type-error-as-type-goreq-error-in-return-argument/29658805#29658805", "title": "cannot use err (type error) as type goreq.Error in return argument", "body": "<p><code>Do()</code> <a href=\"https://github.com/franela/goreq/blob/00f9aa6e4d9101db444f5d4232ee969645f91323/goreq.go#L243\" rel=\"nofollow\">returns type error, not <code>goreq.Error</code></a>. Change your second return type to <code>error</code> instead of <code>goreq.Error</code>.</p>\n"}], "owner": {"reputation": 1997, "user_id": 140477, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/IjFb7.png?s=128&g=1", "display_name": "Kennedy", "link": "https://stackoverflow.com/users/140477/kennedy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1292, "favorite_count": 0, "accepted_answer_id": 29658805, "answer_count": 1, "score": 2, "last_activity_date": 1429125118, "creation_date": 1429124974, "question_id": 29658757, "link": "https://stackoverflow.com/questions/29658757/cannot-use-err-type-error-as-type-goreq-error-in-return-argument", "title": "cannot use err (type error) as type goreq.Error in return argument", "body": "<p>I am trying to return two values (result and error) from a method but I get this</p>\n\n<pre><code>cannot use err (type error) as type goreq.Error in return argument\n</code></pre>\n\n<p>my code</p>\n\n<pre><code>package components\n\nimport (\n    goreq \"github.com/franela/goreq\"\n    \"time\"\n)\n\nvar UserAgent string = \"...\"\n\nfunc Get(url string) (*goreq.Response, goreq.Error) {\n    goreq.SetConnectTimeout(15 * time.Second)\n    res, err := goreq.Request{\n        Uri: url,\n        UserAgent: UserAgent,\n        Timeout: 5 * time.Second,\n    }.Do()\n\n    return res, err\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1429130884, "post_id": 29658629, "comment_id": 47460620, "body": "Since you specifically mention &quot;print&quot;, also be aware of <a href=\"https://godoc.org/fmt#hdr-Printing\" rel=\"nofollow noreferrer\"><code>fmt.Printf</code>&#39;s &quot;%T&quot;</a> verb."}], "answers": [{"comments": [{"owner": {"reputation": 24613, "user_id": 555222, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dcd4c7151c0b298d4fb46001df735f6b?s=128&d=identicon&r=PG", "display_name": "clarkk", "link": "https://stackoverflow.com/users/555222/clarkk"}, "edited": false, "score": 0, "creation_date": 1429125538, "post_id": 29658704, "comment_id": 47457468, "body": "I got another problem.. The <code>User{}</code> is from another package.. When using <code>reflect.Type()</code> return <code>*crud.User</code>..  <code>reflect.Type().Name()</code> is empty"}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "reply_to_user": {"reputation": 24613, "user_id": 555222, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dcd4c7151c0b298d4fb46001df735f6b?s=128&d=identicon&r=PG", "display_name": "clarkk", "link": "https://stackoverflow.com/users/555222/clarkk"}, "edited": false, "score": 0, "creation_date": 1429130049, "post_id": 29658704, "comment_id": 47460158, "body": "@clarkk: you could <a href=\"https://play.golang.org/p/lwXrHM_HbB\" rel=\"nofollow noreferrer\">try something like this</a>."}, {"owner": {"reputation": 24613, "user_id": 555222, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dcd4c7151c0b298d4fb46001df735f6b?s=128&d=identicon&r=PG", "display_name": "clarkk", "link": "https://stackoverflow.com/users/555222/clarkk"}, "edited": false, "score": 0, "creation_date": 1429130481, "post_id": 29658704, "comment_id": 47460419, "body": "Thanks.. it works! but why the <code>for</code> loop in <code>get_struct</code>? :)"}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "reply_to_user": {"reputation": 24613, "user_id": 555222, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dcd4c7151c0b298d4fb46001df735f6b?s=128&d=identicon&r=PG", "display_name": "clarkk", "link": "https://stackoverflow.com/users/555222/clarkk"}, "edited": false, "score": 0, "creation_date": 1429131274, "post_id": 29658704, "comment_id": 47460835, "body": "@clarkk:  In case you have a situation the type is <code>***crud.User</code>. The <code>for</code> loop will reduce it down to <code>User</code>."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 1, "last_activity_date": 1429125253, "last_edit_date": 1429125253, "creation_date": 1429124793, "answer_id": 29658704, "question_id": 29658629, "link": "https://stackoverflow.com/questions/29658629/get-name-from-struct-passed-to-function/29658704#29658704", "title": "get name from struct passed to function", "body": "<p>The <a href=\"https://godoc.org/reflect\" rel=\"nofollow\"><code>reflect</code></a> package provides this; you simply create a new <code>reflect.Value</code> from the variable and inspect its type:</p>\n\n<pre><code>func get_struct(value interface{}){\n    var name string\n    ref := reflect.ValueOf(value)\n    if ref.IsValid() {\n        name = ref.Type().Name()\n    } else {\n        name = \"nil\"\n    }\n    fmt.Println(name)\n}\n</code></pre>\n\n<p>Note: you may not get the output you want if a pointer is passed. You may want to consider using <a href=\"https://golang.org/pkg/reflect/#Type\" rel=\"nofollow\"><code>Type.String()</code></a> over <a href=\"https://golang.org/pkg/reflect/#Type\" rel=\"nofollow\"><code>Type.Name()</code></a>.</p>\n\n<p><a href=\"https://play.golang.org/p/Msg3ybZSaj\" rel=\"nofollow\">Playground</a></p>\n"}], "owner": {"reputation": 24613, "user_id": 555222, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dcd4c7151c0b298d4fb46001df735f6b?s=128&d=identicon&r=PG", "display_name": "clarkk", "link": "https://stackoverflow.com/users/555222/clarkk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 29658704, "answer_count": 1, "score": 0, "last_activity_date": 1429128469, "creation_date": 1429124510, "last_edit_date": 1429128469, "question_id": 29658629, "link": "https://stackoverflow.com/questions/29658629/get-name-from-struct-passed-to-function", "title": "get name from struct passed to function", "body": "<p>How to get the name of an struct/interface?</p>\n\n<h1>pkg</h1>\n\n<pre><code>package crud\n\ntype User struct {\n    ID          uint\n    Name        string\n    Email       string\n}\n</code></pre>\n\n<h1>main</h1>\n\n<pre><code>package main\n\nimport \"./crud\"\n\nfunc get_struct(value interface{}){\n    // print \"User\"\n}\n\nfunc main(){\n    get_struct(&amp;crud.User{})\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5488, "user_id": 1078890, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Dqula.jpg?s=128&g=1", "display_name": "IamNaN", "link": "https://stackoverflow.com/users/1078890/iamnan"}, "edited": false, "score": 1, "creation_date": 1429121666, "post_id": 29657421, "comment_id": 47455096, "body": "See <a href=\"http://stackoverflow.com/questions/10858787/what-are-the-uses-for-tags-in-go\">this</a> post for a general explanation. Leo Correa&#39;s answer gives the specific meaning for this particular tag"}], "answers": [{"tags": [], "owner": {"reputation": 16564, "user_id": 1261399, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/679444399bbf92e3a5d3f16347809f3f?s=128&d=identicon&r=PG", "display_name": "Leo Correa", "link": "https://stackoverflow.com/users/1261399/leo-correa"}, "is_accepted": true, "score": 1, "last_activity_date": 1429121017, "creation_date": 1429121017, "answer_id": 29657534, "question_id": 29657421, "link": "https://stackoverflow.com/questions/29657421/extra-value-in-field-in-struct-golang/29657534#29657534", "title": "extra value in field in struct golang", "body": "<p>It's a tag used by the <code>gorm</code> package to let the package know that the field will be used as a primary key</p>\n\n<p>See <a href=\"https://github.com/jinzhu/gorm/blob/b9a39be9c5e77bb0bfebd516114a8a4d605c645a/model_struct.go#L135-L139\" rel=\"nofollow\">https://github.com/jinzhu/gorm/blob/b9a39be9c5e77bb0bfebd516114a8a4d605c645a/model_struct.go#L135-L139</a></p>\n\n<pre><code>gormSettings := parseTagSetting(field.Tag.Get(\"gorm\"))\nif _, ok := gormSettings[\"PRIMARY_KEY\"]; ok {\n    field.IsPrimaryKey = true\n    modelStruct.PrimaryFields = append(modelStruct.PrimaryFields, field)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 0, "last_activity_date": 1429121127, "creation_date": 1429121127, "answer_id": 29657578, "question_id": 29657421, "link": "https://stackoverflow.com/questions/29657421/extra-value-in-field-in-struct-golang/29657578#29657578", "title": "extra value in field in struct golang", "body": "<p>Those are what I call 'annotations' they're used by various packages (in this case <code>gorm</code>) to provide more information about how to handle the type. Most commonly you see them on data transfer objects (like json and xml), both packages require them in most use cases.</p>\n\n<p>In this case you're telling <code>gorm</code> this field is a primary key. From a cursory glance at that packages docs it is for relational modeling (like setting up types to map to an rmdb or something of that nature) so it makes sense here to see things like nullable, pk or fk.</p>\n"}], "owner": {"reputation": 24613, "user_id": 555222, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dcd4c7151c0b298d4fb46001df735f6b?s=128&d=identicon&r=PG", "display_name": "clarkk", "link": "https://stackoverflow.com/users/555222/clarkk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "accepted_answer_id": 29657534, "answer_count": 2, "score": 0, "last_activity_date": 1429121127, "creation_date": 1429120647, "question_id": 29657421, "link": "https://stackoverflow.com/questions/29657421/extra-value-in-field-in-struct-golang", "title": "extra value in field in struct golang", "body": "<p>What does this \"extra\" field <code>gorm:\"primary_key\"</code> do when creating a struct?</p>\n\n<pre><code>type Model struct {\n    ID        uint `gorm:\"primary_key\"`\n    CreatedAt time.Time\n    UpdatedAt time.Time\n    DeletedAt *time.Time\n}\n</code></pre>\n"}, {"tags": ["struct", "go"], "answers": [{"tags": [], "owner": {"reputation": 5488, "user_id": 1078890, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Dqula.jpg?s=128&g=1", "display_name": "IamNaN", "link": "https://stackoverflow.com/users/1078890/iamnan"}, "is_accepted": true, "score": 3, "last_activity_date": 1429123820, "last_edit_date": 1429123820, "creation_date": 1429122211, "answer_id": 29657905, "question_id": 29657109, "link": "https://stackoverflow.com/questions/29657109/why-passing-struct-to-function-with-literal-struct-parameter-from-current-packag/29657905#29657905", "title": "Why passing struct to function with literal struct parameter from current package differs from the same for function from another package?", "body": "<p>You need to export your struct field:</p>\n\n<pre><code>type Struct struct {\n    Field string\n}\n</code></pre>\n\n<p>and then also change the call to use the exported field:</p>\n\n<pre><code>func Fn(arg struct{Field string}) {\n    fmt.Println(arg)\n}\n</code></pre>\n\n<p>From the <a href=\"https://golang.org/ref/spec\" rel=\"nofollow\">language spec</a> (specifically the last sentence):</p>\n\n<blockquote>\n  <p>For struct literals the following rules apply:</p>\n  \n  <ul>\n  <li>A key must be a field name declared in the LiteralType.</li>\n  <li>An element list that does not contain any keys must list an element for each struct field in the order in which the fields are declared.</li>\n  <li>If any element has a key, every element must have a key.</li>\n  <li>An element list that contains keys does not need to have an element for each struct field. Omitted fields get the zero value for that\n  field.</li>\n  <li>A literal may omit the element list; such a literal evaluates to the zero value for its type.</li>\n  <li>It is an error to specify an element for a non-exported field of a struct belonging to a different package.</li>\n  </ul>\n</blockquote>\n"}], "owner": {"reputation": 8915, "user_id": 1818608, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2c7fd43d0ea66acaf6eadc8062693a50?s=128&d=identicon&r=PG", "display_name": "Gill Bates", "link": "https://stackoverflow.com/users/1818608/gill-bates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1148, "favorite_count": 0, "accepted_answer_id": 29657905, "answer_count": 1, "score": 1, "last_activity_date": 1429123820, "creation_date": 1429119682, "question_id": 29657109, "link": "https://stackoverflow.com/questions/29657109/why-passing-struct-to-function-with-literal-struct-parameter-from-current-packag", "title": "Why passing struct to function with literal struct parameter from current package differs from the same for function from another package?", "body": "<p>This works perferctly:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Struct struct {\n    field string\n}\nfunc Fn(arg struct{field string}) {\n    fmt.Println(arg)\n}\n\nfunc main() {\n    Fn(Struct{\"john\"})\n}\n</code></pre>\n\n<p>But this gives <code>./main.go:12: cannot use Struct literal (type Struct) as type struct { field string } in argument to sub.Fn</code>:  </p>\n\n<p><em>main.go</em></p>\n\n<pre><code>package main\n\nimport \"go_tests/sub\"\n\ntype Struct struct {\n    field string\n}\n\nfunc main() {\n    sub.Fn(Struct{\"john\"})\n}\n</code></pre>\n\n<p><em>sub/sub.go</em></p>\n\n<pre><code>package sub\n\nimport \"fmt\"\n\nfunc Fn(arg struct{field string}) {\n    fmt.Println(arg)\n}\n</code></pre>\n\n<p>Only change in function call is that <code>Fn(Struct{\"john\"})</code> was replaced with <code>sub.Fn(Struct{\"john\"})</code>. </p>\n\n<p>Why moving function to another package affects types logic? Links to the docs will be appreciated.</p>\n"}, {"tags": ["java", "go"], "comments": [{"owner": {"reputation": 30744, "user_id": 1768232, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/P6XgG.png?s=128&g=1", "display_name": "durron597", "link": "https://stackoverflow.com/users/1768232/durron597"}, "edited": false, "score": 3, "creation_date": 1429115171, "post_id": 29655531, "comment_id": 47451084, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/1252190/how-to-wait-for-a-set-of-threads-to-complete\">How to wait for a set of threads to complete?</a>"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 2, "creation_date": 1429124188, "post_id": 29655531, "comment_id": 47456640, "body": "I don&#39;t know Java but, for the case where you <code>wg.Add(n)</code> before starting all <i>n</i> tasks, <a href=\"https://docs.oracle.com/javase/7/docs/api/java/util/concurrent/CountDownLatch.html\" rel=\"nofollow noreferrer\">CountDownLatch</a> looks like a fit, using <code>countDown()</code> for <code>wg.Done()</code> and <code>await()</code> for <code>wg.Wait()</code>."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 2, "creation_date": 1429124390, "post_id": 29655531, "comment_id": 47456772, "body": "The accepted answer on the linked question could work too, since threads are objects in Java. But they&#39;re slightly different: with CountDownLatch a thread can do other work after it finishes the task (so you could use it handing tasks to a pool of long-lived threads), with <code>thread.join()</code> it can&#39;t. Since the tasks differ a little I&#39;m not voting to close as dupe."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1429127064, "post_id": 29655531, "comment_id": 47458442, "body": "I&#39;m using CountdownLatch for most cases I&#39;d use a WaitGroup in Go."}], "answers": [{"comments": [{"owner": {"reputation": 1451, "user_id": 2930836, "user_type": "registered", "accept_rate": 39, "profile_image": "https://lh4.googleusercontent.com/-hOD6KYRyIY4/AAAAAAAAAAI/AAAAAAAAfv0/9V13VHORoHk/photo.jpg?sz=128", "display_name": "igonejack", "link": "https://stackoverflow.com/users/2930836/igonejack"}, "edited": false, "score": 0, "creation_date": 1556127498, "post_id": 29676898, "comment_id": 98335813, "body": "Why would wg.wait() == acquire(Integer.MAX_VALUE), wg.Wait() in go would block current go routine until all Add has been Done."}], "tags": [], "owner": {"reputation": 44321, "user_id": 318174, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/916b39039a8269e3c45b5ce2b98675a9?s=128&d=identicon&r=PG", "display_name": "Adam Gent", "link": "https://stackoverflow.com/users/318174/adam-gent"}, "is_accepted": false, "score": 0, "last_activity_date": 1429192472, "creation_date": 1429192472, "answer_id": 29676898, "question_id": 29655531, "link": "https://stackoverflow.com/questions/29655531/what-is-the-java-equivalent-of-golangs-waitgroup/29676898#29676898", "title": "What is the Java equivalent of Golang&#39;s WaitGroup", "body": "<p>After looking at the golang doc and confirming that Semaphore won't break with an enormous amount of permits I think a <code>Semaphore</code> set to <code>Integer.MAX_VALUE</code> is the closest to a golang <code>WaitGroup</code>.</p>\n\n<p>The <code>thread.join</code> is probably more similar to how you would use WaitGroup with goroutines since it deals with the cleanup of the threads however an isolated <code>WaitGroup</code> just like a <code>Semaphore</code> is agnostic of what increments it.</p>\n\n<p>CountdownLatch doesn't work because you need to know a priori how many threads you want to run and you cannot increment a CountdownLatch.</p>\n\n<p>Assuming the semaphore is set to <code>Integer.MAX_VALUE</code>:</p>\n\n<p><code>wg.Add(n)</code> == <code>semaphore.acquire(n)</code></p>\n\n<p><code>wg.Done()</code> == <code>semaphore.release()</code></p>\n\n<p>and in your thread where you want everything to stop:</p>\n\n<p><code>wg.Wait()</code> == <code>semaphore.acquire(Integer.MAX_VALUE)</code></p>\n\n<p>However I'm not sure all the semantics carryover so I'm not going to mark this correct for now.</p>\n"}, {"tags": [], "owner": {"reputation": 847, "user_id": 82928, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bace01b8bbaf96073d0caf8780197f07?s=128&d=identicon&r=PG", "display_name": "user82928", "link": "https://stackoverflow.com/users/82928/user82928"}, "is_accepted": false, "score": 2, "last_activity_date": 1432595772, "creation_date": 1432595772, "answer_id": 30447188, "question_id": 29655531, "link": "https://stackoverflow.com/questions/29655531/what-is-the-java-equivalent-of-golangs-waitgroup/30447188#30447188", "title": "What is the Java equivalent of Golang&#39;s WaitGroup", "body": "<pre><code>public class WaitGroup {\n\n    private int jobs = 0;\n\n    public synchronized void add(int i) {\n        jobs += i;\n    }\n\n    public synchronized void done() {\n        if (--jobs == 0) {\n            notifyAll();\n        }\n    }\n\n    public synchronized void await() throws InterruptedException {\n        while (jobs &gt; 0) {\n            wait();\n        }\n    }\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": false, "score": 4, "last_activity_date": 1432603776, "creation_date": 1432603776, "answer_id": 30448080, "question_id": 29655531, "link": "https://stackoverflow.com/questions/29655531/what-is-the-java-equivalent-of-golangs-waitgroup/30448080#30448080", "title": "What is the Java equivalent of Golang&#39;s WaitGroup", "body": "<p><code>WaitGroup</code> has <code>Add(delta)</code> method that can be called after a <code>WaitGroup</code> has been created. <code>CountDownLatch</code> doesn't support this, number of tasks needs to be specified in advance. JDK7 <code>Phaser</code> can be used instead in this case:</p>\n\n<pre><code>phaser.register = wg.Add(1)\nphaser.arrive = wg.Done\nphaser.await = wg.Wait\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 545, "user_id": 4946380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5xy1u.png?s=128&g=1", "display_name": "Mithical", "link": "https://stackoverflow.com/users/4946380/mithical"}, "edited": false, "score": 5, "creation_date": 1533548557, "post_id": 51704624, "comment_id": 90370221, "body": "Please remember that we have a <b><a href=\"https://stackoverflow.com/help/be-nice\">Be Nice</a></b> policy on Stack Overflow; this includes not using profanity or obscenities in your posts. In the future, please keep all posts profanity-free. In the meantime, this post has been edited to keep it in line with the policies. Thanks for understanding."}], "tags": [], "owner": {"reputation": 1, "user_id": 5176063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51879e2bfc848be15cc5e4b95b7b95a0?s=128&d=identicon&r=PG&f=1", "display_name": "user5176063", "link": "https://stackoverflow.com/users/5176063/user5176063"}, "is_accepted": false, "score": -2, "last_activity_date": 1533550331, "last_edit_date": 1533550331, "creation_date": 1533548256, "answer_id": 51704624, "question_id": 29655531, "link": "https://stackoverflow.com/questions/29655531/what-is-the-java-equivalent-of-golangs-waitgroup/51704624#51704624", "title": "What is the Java equivalent of Golang&#39;s WaitGroup", "body": "<p>No, there is no 'CountDownLatch' in Go.</p>\n\n<p><code>sync.WaitGroup</code> may have the 'wait task finish' feature, but this API's <code>Add()</code> doesn't happens-befor <code>Done()</code>.</p>\n"}], "owner": {"reputation": 44321, "user_id": 318174, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/916b39039a8269e3c45b5ce2b98675a9?s=128&d=identicon&r=PG", "display_name": "Adam Gent", "link": "https://stackoverflow.com/users/318174/adam-gent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3389, "favorite_count": 1, "answer_count": 4, "score": 6, "last_activity_date": 1533550331, "creation_date": 1429114624, "last_edit_date": 1429192690, "question_id": 29655531, "link": "https://stackoverflow.com/questions/29655531/what-is-the-java-equivalent-of-golangs-waitgroup", "title": "What is the Java equivalent of Golang&#39;s WaitGroup", "body": "<p>Golang has something called a <code>WaitGroup</code> which is sort of like in Java a <code>CompletionService</code> or a <code>CountDownLatch</code> or a <code>Semaphore</code> or some combination of the latter.</p>\n\n<p>I'm not entirely sure how you would implement a WaitGroup in Java. I would imagine a custom CompletionService with some sort of Poison message would be the route to go (since queues can't say when they are done) but perhaps there is a better concurrent data structure/lock?</p>\n\n<p>EDIT I posted a possible solution below using <code>Semaphore</code> that I think is more analogous than using <code>thread.join</code>.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 5488, "user_id": 1078890, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Dqula.jpg?s=128&g=1", "display_name": "IamNaN", "link": "https://stackoverflow.com/users/1078890/iamnan"}, "is_accepted": true, "score": 1, "last_activity_date": 1429115796, "creation_date": 1429115796, "answer_id": 29655919, "question_id": 29655299, "link": "https://stackoverflow.com/questions/29655299/store-a-generic-function/29655919#29655919", "title": "Store a generic function", "body": "<p>You have a type mismatch in that your struct member expects an func(param ...interface) and you are trying to pass it a func(map[string]command)</p>\n\n<p>See <a href=\"https://golang.org/ref/spec#Interface_types\" rel=\"nofollow\">here</a> for the explanation on how interface types work.</p>\n\n<p>If you change your code as below and give the struct member simply type interface{} it can take any type including a function which I think is what you want.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype command struct {\n    help    string\n    handler interface{}\n}\n\nfunc showHelp(commands map[string]command) {\n    fmt.Println(\"Help:\")\n    for c, h := range commands {\n        fmt.Println(c, \"-&gt;\", h.help)\n    }\n}\n\nfunc main() {\n    // Map to store commands\n    commands := make(map[string]command)\n\n    // Adding help command\n    commands[\"help\"] = command{\"show this information\", showHelp}\n    showHelp(commands)\n}\n</code></pre>\n\n<p>Try in on the <a href=\"https://play.golang.org/p/_Q97AsRAZM\" rel=\"nofollow\">Go Playground</a></p>\n"}, {"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 0, "last_activity_date": 1429116051, "creation_date": 1429116051, "answer_id": 29655999, "question_id": 29655299, "link": "https://stackoverflow.com/questions/29655299/store-a-generic-function/29655999#29655999", "title": "Store a generic function", "body": "<p>I think you're looking for something like this;</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\n\ntype command struct {                                                            \n    help string                                                                  \n    handler func()                                        \n}   \n\n\nfunc main() {\n    c := command{}\n    c.handler = func () { \n    fmt.Println(\"Hello, playground\")\n    }\n    c.handler()\n}\n</code></pre>\n\n<p>At least this is how I would do it. Put a field of type func on your struct then in whatever place is convenient use a closure to assign a method to it.</p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1429120846, "creation_date": 1429120846, "answer_id": 29657488, "question_id": 29655299, "link": "https://stackoverflow.com/questions/29655299/store-a-generic-function/29657488#29657488", "title": "Store a generic function", "body": "<p>You will need type assertion in your handlers - cost of generics. Your  design as is, non-idiomatic but can work just as proof_of_concept.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype command struct {\n    help    string\n    handler func(params ...interface{})\n}\n\nfunc showHelp(commands ...interface{}) {\n    fmt.Println(\"Help:\")\n    for c, h := range commands[0].(map[string]command) { //type assertion here\n        fmt.Println(c, \"-&gt;\", h.help)\n    }\n}\n\nfunc main() {\n    // Map to store commands\n    commands := make(map[string]command)\n\n    // Adding help command\n    commands[\"help\"] = command{\"show this information\", showHelp}\n    commands[\"help\"].handler(commands)\n}\n</code></pre>\n\n<p>Works <a href=\"https://play.golang.org/p/c67TVcorL1\" rel=\"nofollow\">https://play.golang.org/p/c67TVcorL1</a></p>\n"}], "owner": {"reputation": 63, "user_id": 1648736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dd1798357f510c897237f0f0e906c68?s=128&d=identicon&r=PG", "display_name": "carlosduelo", "link": "https://stackoverflow.com/users/1648736/carlosduelo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 29655919, "answer_count": 3, "score": 1, "last_activity_date": 1429120846, "creation_date": 1429113969, "question_id": 29655299, "link": "https://stackoverflow.com/questions/29655299/store-a-generic-function", "title": "Store a generic function", "body": "<p>I would like to do something like this, but apparently it is not possible in this way, I think that there is something I miss.</p>\n\n<pre><code>type command struct {                                                            \n    help string                                                                  \n    handler func (params ...interface{})                                         \n}                                                                                \n\nfunc showHelp( commands map[string]command ) {                                   \n    fmt.Println( \"Help:\" )                                                       \n    for c, h := range commands {                                                 \n        fmt.Println( c,\"-&gt;\" ,h.help )                                            \n    }                                                                            \n}                                                                                \n\nfunc main() {                                                                \n    // Map to store commands                                                     \n    commands := make( map[string]command )                                       \n\n    // Adding help command                                                       \n    commands[\"help\"] = command{ \"show this information\", showHelp }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1429112392, "post_id": 29654328, "comment_id": 47449047, "body": "using <code>GoSched</code> doesn&#39;t guarantee the other goroutine will run to completion. You generally shouldn&#39;t use that in your code."}, {"owner": {"reputation": 2611, "user_id": 872918, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b89d3f5413870b28a39767f0289c32b?s=128&d=identicon&r=PG", "display_name": "snap", "link": "https://stackoverflow.com/users/872918/snap"}, "edited": false, "score": 2, "creation_date": 1429129080, "post_id": 29654328, "comment_id": 47459614, "body": "This question is a duplicate with <a href=\"http://stackoverflow.com/questions/15771232/why-is-time-sleep-required-to-run-certain-goroutines/15771560\" title=\"why is time sleep required to run certain goroutines\">stackoverflow.com/questions/15771232/&hellip;</a> and <a href=\"http://stackoverflow.com/questions/24425987/why-is-my-goroutine-not-executed/24426137\" title=\"why is my goroutine not executed\">stackoverflow.com/questions/24425987/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 1, "last_activity_date": 1429112133, "creation_date": 1429112133, "answer_id": 29654552, "question_id": 29654328, "link": "https://stackoverflow.com/questions/29654328/go-lang-why-go-routine-function-never-being-called/29654552#29654552", "title": "go lang, why go routine function never being called", "body": "<p>You're not allowing the goroutine to run before <code>main()</code> exits.</p>\n\n<p>Even though the second call to <code>say</code> blocks (briefly), there's no guarantee that the first goroutine can run. You need to wait for both to return, which is often done with a WaitGroup</p>\n\n<pre><code>var wg sync.WaitGroup\n\nfunc say(s string) {\n    defer wg.Done()\n    for i := 0; i &lt; 5; i++ {\n        //runtime.Gosched()\n        fmt.Println(s)\n    }\n}\n\nfunc main() {\n    wg.Add(1)\n    go say(\"world\") // create a new goroutine\n\n    wg.Add(1)\n    say(\"hello\") // current goroutine\n    wg.Wait()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 2, "last_activity_date": 1429119762, "creation_date": 1429119762, "answer_id": 29657138, "question_id": 29654328, "link": "https://stackoverflow.com/questions/29654328/go-lang-why-go-routine-function-never-being-called/29657138#29657138", "title": "go lang, why go routine function never being called", "body": "<p>You're just experiencing a timing issue because you're not 'coordinating' your go routines. The common way to handle this is with a wait guard. The other option I see from time to time using channels and a blocking select. A wait guard implementation would look something like this;</p>\n\n<pre><code>func main() {\n    wg := sync.WaitGroup{}\n    wg.Add(1)\n    go say(\"world\") // create a new goroutine\n\n    wg.Add(1)\n    say(\"hello\") // current goroutine\n    wg.Wait()\n}\n</code></pre>\n\n<p>While the channel option (not actually interesting or useful in this example) is something more like this;</p>\n\n<pre><code> func main() {\n    done := make(chan bool)\n    go say(\"world\", done) // create a new goroutine\n\n    say(\"hello\", done) // current goroutine\n\n    select {\n        case fin := &lt;- done:\n           //on finished\n           return\n    }\n}\n\nfunc say(s string, chan bool) {\nfor i := 0; i &lt; 5; i++ {\n    fmt.Println(s)\n   }\n   done &lt;- true\n}\n</code></pre>\n\n<p>With the example above though, the first call to say completing would allow the program to finish executing. To ensure both finish you'd have to pass different channels to each and have blocking reads on both. This is more a pattern I would use when your go routines are doing real work and you want to bring data to aggregate data from them or need more complex coordination (like spawning new goroutines based on the results of previous ones ect).</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 2191031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf8a3153e48f8cc4e647af6f62451958?s=128&d=identicon&r=PG", "display_name": "xnslong", "link": "https://stackoverflow.com/users/2191031/xnslong"}, "is_accepted": false, "score": 0, "last_activity_date": 1562506392, "creation_date": 1562506392, "answer_id": 56922619, "question_id": 29654328, "link": "https://stackoverflow.com/questions/29654328/go-lang-why-go-routine-function-never-being-called/56922619#56922619", "title": "go lang, why go routine function never being called", "body": "<p>It's because the main goroutine exits too early. When the main goroutine exits, the process will exit, so there is no chance for other goroutines to run. If you wish the goroutines to run, keep the main routine alive long enough.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"runtime\"\n)\n\nfunc say(s string) {\n    for i := 0; i &lt; 5; i++ {\n        fmt.Println(s)\n    }\n}\n\nfunc main() {\n    go say(\"world\") // create a new goroutine\n    runtime.Gosched()\n\n    say(\"hello\") // current goroutine\n    time.Sleep(1 * time.Second) // this line\n}\n</code></pre>\n"}], "owner": {"reputation": 6557, "user_id": 2495795, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/13606de0b736d7191e2cf2bfea1d4fda?s=128&d=identicon&r=PG", "display_name": "BufBills", "link": "https://stackoverflow.com/users/2495795/bufbills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1044, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1565123843, "creation_date": 1429111596, "last_edit_date": 1565123843, "question_id": 29654328, "link": "https://stackoverflow.com/questions/29654328/go-lang-why-go-routine-function-never-being-called", "title": "go lang, why go routine function never being called", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    //\"runtime\"\n)\n\nfunc say(s string) {\n    for i := 0; i &lt; 5; i++ {\n        //runtime.Gosched()\n        fmt.Println(s)\n    }\n}\n\nfunc main() {\n    go say(\"world\") // create a new goroutine\n    say(\"hello\") // current goroutine\n}\n</code></pre>\n\n<p>Why result is:</p>\n\n<blockquote>\n  <p>hello<br>\n  hello<br>\n  hello<br>\n  hello<br>\n  hello</p>\n</blockquote>\n\n<p>Why is there no <code>world</code>?</p>\n\n<p>Answer: (edited:)\nIf I do this, it is good now:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"runtime\"\n)\n\nfunc say(s string) {\n    for i := 0; i &lt; 5; i++ {\n        //runtime.Gosched()\n        fmt.Println(s)\n    }\n}\n\nfunc main() {\n    go say(\"world\") // create a new goroutine\n    runtime.Gosched()\n\n    say(\"hello\") // current goroutine\n}\n</code></pre>\n"}, {"tags": ["if-statement", "error-handling", "go", "assert"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1429111724, "post_id": 29654175, "comment_id": 47448519, "body": "The go spec doesn&#39;t enforce any dead code removal. A particular implementation is free to do so as aggressively as it sees fit."}, {"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1429111987, "post_id": 29654175, "comment_id": 47448723, "body": "@JimB  <a href=\"http://golang.org/ref/spec#Constant_expressions\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Constant_expressions</a> evaluated at compile time?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 1, "creation_date": 1429112200, "post_id": 29654175, "comment_id": 47448899, "body": "@Uvelichitel: yes, but that has nothing to do with dead code removal. The compiler is still free to leave the if block in the compiled object."}, {"owner": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1429112282, "post_id": 29654175, "comment_id": 47448969, "body": "@JimB: It does have something to do with it. What exactly is the difference between a constant expression and dead code? Dead code is only a bit more generalized to not only include expressions, but also statements."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1429113827, "post_id": 29654175, "comment_id": 47450206, "body": "For what it&#39;s worth, when I&#39;ve done benchmarks, predictable branches often had much less effect than I expected, even in inner loops. I&#39;d consider leaving the checks in at runtime unless you see problems because, e.g., the test itself is slow."}], "answers": [{"comments": [{"owner": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "edited": false, "score": 1, "creation_date": 1429125431, "post_id": 29654409, "comment_id": 47457398, "body": "I never realized <code>objdump</code> had an <code>-S</code> option, thanks! (and thanks for the actual answer, too...)"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 7, "last_activity_date": 1429113365, "last_edit_date": 1429113365, "creation_date": 1429111802, "answer_id": 29654409, "question_id": 29654175, "link": "https://stackoverflow.com/questions/29654175/does-go-optimize-out-unreachable-if-statements/29654409#29654409", "title": "Does Go optimize out unreachable if-statements?", "body": "<p>As noted by the people in the comments to your question, it's implementation-specific.</p>\n\n<p>gc does remove it. You can build your program with <code>-gcflags '-S'</code> and see that the <code>ASSERT</code> part is not in the binary.</p>\n\n<p>E.g. compile the following code with <code>-gcflags '-S'</code>, and you'll see that the code on lines 8 and 9 is included, but change <code>Assert</code> to be false, and they won't be there in the asm listing.</p>\n\n<pre><code>package main\n\nconst Assert = true\n\nvar cond = true\n\nfunc main() {\n    if Assert &amp;&amp; !cond {\n        panic(\"failed\")\n    }\n}\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>As for gccgo, it removes this code at <code>-O1</code> and above. You can see it by compiling the same code with</p>\n\n<pre><code>go build -compiler gccgo -gccgoflags '-O1' main.go\n</code></pre>\n\n<p>and then doing</p>\n\n<pre><code>objdump -S main\n</code></pre>\n\n<p>to see the annotated assembly.</p>\n"}], "owner": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 352, "favorite_count": 0, "accepted_answer_id": 29654409, "answer_count": 1, "score": 5, "last_activity_date": 1429113365, "creation_date": 1429111205, "question_id": 29654175, "link": "https://stackoverflow.com/questions/29654175/does-go-optimize-out-unreachable-if-statements", "title": "Does Go optimize out unreachable if-statements?", "body": "<p>Go has a very unfortunate lack of built-in assertions. I want to implement them this way:</p>\n\n<pre><code>const ASSERT = true\n\nfunc SomeFunction() {\n        if ASSERT &amp;&amp; !some_condition_that_should_always_be_true() {\n                panic(\"Error message or object.\")\n        }\n}\n</code></pre>\n\n<p>My question is will the if-statement be optimized out if I define <code>const ASSERT = false</code>?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 6, "last_activity_date": 1429109669, "last_edit_date": 1429109669, "creation_date": 1429107585, "answer_id": 29652808, "question_id": 29652530, "link": "https://stackoverflow.com/questions/29652530/testing-m-recover-in-golang/29652808#29652808", "title": "testing.M recover in golang", "body": "<p>It's because the tests are run in separate goroutines.</p>\n\n<p>It's like if your fist example sent off a goroutine, which can't be recovered. </p>\n\n<pre><code>func TestSomeTest(t *testing.T) {\n    defer func() {\n        r := recover()\n        fmt.Println(\"recovery\")\n        fmt.Println(r)\n    }()\n\n    go func() {\n        // won't recover\n        panic(\"panic here\")\n    }()\n    time.Sleep(time.Second)\n}\n</code></pre>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 621, "favorite_count": 0, "accepted_answer_id": 29652808, "answer_count": 1, "score": 5, "last_activity_date": 1429109669, "creation_date": 1429106926, "question_id": 29652530, "link": "https://stackoverflow.com/questions/29652530/testing-m-recover-in-golang", "title": "testing.M recover in golang", "body": "<p>This recovery works:</p>\n\n<pre><code>func TestSomeTest(t *testing.T) {\n    defer func() {\n        r := recover()\n        fmt.Println(\"recovery\")\n        fmt.Println(r)\n    }()\n    panic(\"panic here\")\n}\n</code></pre>\n\n<p>But this does not:</p>\n\n<pre><code>func TestSomeTest(t *testing.T) {\n    panic(\"panic here\")\n}\n\nfunc TestMain(m *testing.M) {\n    defer func() {\n        r := recover()\n        fmt.Println(\"recovery\")\n        fmt.Println(r)\n    }()\n    ret := m.Run()\n    os.Exit(ret)\n}\n</code></pre>\n\n<p>Why? \nI expect that <code>panic here</code> will be recovered by code in <code>func TestMain(m *testing.M)</code>. Why not? I just have <code>panic</code> without any <code>recovery</code> in this case.</p>\n\n<p>Full code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"testing\"\n)\n\nfunc TestSomeTest(t *testing.T) {\n    // defer func() {\n    //  r := recover()\n    //  fmt.Println(\"recovery\")\n    //  fmt.Println(r)\n    // }()\n    panic(\"panic here\")\n}\n\nfunc TestMain(m *testing.M) {\n    defer func() {\n        r := recover()\n        fmt.Println(\"recovery\")\n        fmt.Println(r)\n    }()\n    ret := m.Run()\n    os.Exit(ret)\n}\n</code></pre>\n\n<p>To run this code I used <code>go test</code> command.</p>\n"}, {"tags": ["session", "go", "revel"], "answers": [{"tags": [], "owner": {"reputation": 1036, "user_id": 1737204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2851ca9622b504c85b92fc3e93d87b1f?s=128&d=identicon&r=PG", "display_name": "wldsvc", "link": "https://stackoverflow.com/users/1737204/wldsvc"}, "is_accepted": false, "score": 0, "last_activity_date": 1429178950, "creation_date": 1429178950, "answer_id": 29671547, "question_id": 29644345, "link": "https://stackoverflow.com/questions/29644345/how-to-delete-a-value-from-session-with-revel/29671547#29671547", "title": "how to delete a value from session with revel", "body": "<p>The Session value is valid only while processing a client request. i.e. between the time you get the request and the time you respond to that request. Its contents are kept in a cookie on the client side and you'll get a new Session every time the client connects to your server. Thus if you keep it for later use (like the name of your AfterFunc suggests, triggered by a timer?), anything you do with it will be lost on the next client connection.</p>\n\n<p>In order to achieve what you want to do, you'll need to add a \"lastSeen\" timestamp to the Session. When a request comes in, check Session[\"lastSeen\"], and if it's older than 1 minute, then you can discard CSecurityCode from it.</p>\n"}], "owner": {"reputation": 1241, "user_id": 1233410, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/876e9c31e7af3c04eaab42ac466674f1?s=128&d=identicon&r=PG", "display_name": "sope", "link": "https://stackoverflow.com/users/1233410/sope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 330, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1435921591, "creation_date": 1429083694, "last_edit_date": 1435921591, "question_id": 29644345, "link": "https://stackoverflow.com/questions/29644345/how-to-delete-a-value-from-session-with-revel", "title": "how to delete a value from session with revel", "body": "<p>Is there a way to delete the value from session witch revel the go web framework?</p>\n\n<p>I have a function for validate captcha for user input, and I set the value of captcha in session, and delete the captcha from session if there nothing to do for client after 1 minute. The code is like:</p>\n\n<pre><code>time.AfterFunc(time.Minute, func() {\n    delete(this.Session, CSecurityCode)\n})\n</code></pre>\n\n<p>But I can still get the old value of captcha , why, and how to fix this?</p>\n\n<p>Anybody who can help me?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1429080405, "post_id": 29642985, "comment_id": 47427616, "body": "Plain ol&#39; <code>go test</code> should do it if you have a sane <code>GOPATH</code> set. Normally only <code>go run</code> takes *.go file names, the others like <code>go install</code>, <code>go build</code>, etc (normally) take package name(s) as arguments. Oh, and relative import paths are generally avoided. Read <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How To Write Go Code</a>."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 3, "last_activity_date": 1429082338, "last_edit_date": 1429082338, "creation_date": 1429081367, "answer_id": 29643631, "question_id": 29642985, "link": "https://stackoverflow.com/questions/29642985/how-to-create-and-use-my-own-golang-package-locally-to-get-this-test-to-run/29643631#29643631", "title": "How to create and use my own golang package locally to get this test to run?", "body": "<blockquote>\n  <p><a href=\"http://golang.org/cmd/go/\" rel=\"nofollow\">Command go</a></p>\n  \n  <p><a href=\"http://golang.org/cmd/go/#hdr-Test_packages\" rel=\"nofollow\">Test packages</a></p>\n  \n  <p>Usage:</p>\n\n<pre><code>go test [-c] [-i] [build and test flags] [packages] [flags for test binary]\n</code></pre>\n</blockquote>\n\n<p>For example,</p>\n\n<p><strong>leap/leap.go</strong></p>\n\n<pre><code>package leap\n\nfunc IsLeap(year int) bool {\n    return true\n}\n</code></pre>\n\n<p><strong>leap/leap_test.go</strong></p>\n\n<pre><code>package leap\n\nimport (\n    \"testing\"\n)\n\nvar testCases = []struct {\n    year        int\n    expected    bool\n    description string\n}{\n    {1996, true, \"a vanilla leap year\"},\n    {1997, false, \"a normal year\"},\n    {1900, false, \"a century\"},\n    {2400, true, \"an exceptional century\"},\n}\n\nfunc TestLeapYears(t *testing.T) {\n    for _, test := range testCases {\n        observed := IsLeap(test.year)\n        if observed != test.expected {\n            t.Fatalf(\"%v is %s\", test.year, test.description)\n        }\n    }\n}\n</code></pre>\n\n<p>If <code>$GOPATH</code> is set to include the <code>leap</code> package directory:</p>\n\n<pre><code>$ go test leap\n--- FAIL: TestLeapYears (0.00s)\n    leap_test.go:22: 1997 is a normal year\nFAIL\nFAIL    leap    0.003s\n$\n</code></pre>\n\n<p>Or, if you <code>cd</code> to the <code>leap</code> package directory:</p>\n\n<pre><code>$ go test\n--- FAIL: TestLeapYears (0.00s)\n    leap_test.go:22: 1997 is a normal year\nFAIL\nexit status 1\nFAIL    so/leap 0.003s\n$ \n</code></pre>\n"}], "owner": {"reputation": 4504, "user_id": 3681199, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/70b2072de3d0d43e1af48fd2d416157f?s=128&d=identicon&r=PG&f=1", "display_name": "Nona", "link": "https://stackoverflow.com/users/3681199/nona"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1507, "favorite_count": 2, "accepted_answer_id": 29643631, "answer_count": 1, "score": 1, "last_activity_date": 1429082338, "creation_date": 1429079167, "question_id": 29642985, "link": "https://stackoverflow.com/questions/29642985/how-to-create-and-use-my-own-golang-package-locally-to-get-this-test-to-run", "title": "How to create and use my own golang package locally to get this test to run?", "body": "<p>I'm new to golang working through coding exercises and I have all the following files in a directory called leap.  I'm using gvm to run the golang executable (version 1.4), using a command such as \"go test leap_test.go\".  </p>\n\n<p>When I do <em>go test leap_test.go</em> I get the following results:</p>\n\n<pre><code># command-line-arguments\nleap_test.go:5:2: open /home/user/go/leap/leap: no such file or directory\nFAIL    command-line-arguments [setup failed]\n</code></pre>\n\n<ol>\n<li>How do I include the IsLeap() function so that the tests run correctly.</li>\n<li>Why is cases_test.go even included?  It seems like leap_test.go is all you'd need for tests.</li>\n</ol>\n\n<p><strong>cases_test.go</strong></p>\n\n<pre><code>package leap\n\n// Source: exercism/x-common\n// Commit: 945d08e Merge pull request #50 from soniakeys/master\n\nvar testCases = []struct {\n    year        int\n    expected    bool\n    description string\n}{\n    {1996, true, \"leap year\"},\n    {1997, false, \"non-leap year\"},\n    {1998, false, \"non-leap even year\"},\n    {1900, false, \"century\"},\n    {2400, true, \"fourth century\"},\n    {2000, true, \"Y2K\"},\n}\n</code></pre>\n\n<p><strong>leap_test.go</strong></p>\n\n<pre><code>package leap\n\nimport (\n    \"testing\"\n    \"./leap\"\n)\n\nvar testCases = []struct {\n    year        int\n    expected    bool\n    description string\n}{\n    {1996, true, \"a vanilla leap year\"},\n    {1997, false, \"a normal year\"},\n    {1900, false, \"a century\"},\n    {2400, true, \"an exceptional century\"},\n}\n\n    func TestLeapYears(t *testing.T) {\n        for _, test := range testCases {\n            observed := IsLeap(test.year)\n            if observed != test.expected {\n                t.Fatalf(\"%v is %s\", test.year, test.description)\n            }\n        }\n    }\n</code></pre>\n\n<p><strong>leap.go</strong></p>\n\n<pre><code>package leap\n\nimport(\n    \"fmt\"\n)\n\nfunc IsLeap(year int) bool {\n  return true\n}\n</code></pre>\n"}, {"tags": ["go", "channel"], "answers": [{"tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": true, "score": 9, "last_activity_date": 1429049172, "creation_date": 1429049172, "answer_id": 29638187, "question_id": 29638068, "link": "https://stackoverflow.com/questions/29638068/golang-unable-to-have-value-pushed-into-global-channel-when-handling-http-req/29638187#29638187", "title": "Golang, unable to have value pushed into &#39;global&#39; channel when handling HTTP requests", "body": "<p>Your channel is not initialised and, per specification, send on a nil channel blocks forever. This is because <code>http.ListenAndServe</code> is a blocking operation, so neither <code>requestChannel = make(chan Request)</code> nor your <code>go func()</code> is being called.</p>\n\n<p>Moving <code>http.ListenAndServe</code> to the end of the <code>main</code> block should fix the problem.</p>\n"}], "owner": {"reputation": 729, "user_id": 2737876, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4ed49a00e66b2cbd39e55212cb2d70f2?s=128&d=identicon&r=PG&f=1", "display_name": "user2737876", "link": "https://stackoverflow.com/users/2737876/user2737876"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5985, "favorite_count": 0, "accepted_answer_id": 29638187, "answer_count": 1, "score": 4, "last_activity_date": 1429049172, "creation_date": 1429048525, "question_id": 29638068, "link": "https://stackoverflow.com/questions/29638068/golang-unable-to-have-value-pushed-into-global-channel-when-handling-http-req", "title": "Golang, unable to have value pushed into &#39;global&#39; channel when handling HTTP requests", "body": "<p>Currently I am working on an application that can take anywhere from a few seconds to 1 hour + to process. Because of this using a channel to block requests while others are processing seems like a good fit. The following is an example of what Im trying to accomplish, however I am having an issue as it seems like my program is stalling when trying to add data into said channel (see below).</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n\n    \"github.com/gorilla/mux\"\n)\n\ntype Request struct {\n    Id string\n}\n\nfunc ConstructRequest(id string) Request {\n    return Request{Id: id}\n}\n\nvar requestChannel chan Request // &lt;- Create var for channel\n\nfunc init() {\n    r := mux.NewRouter()\n    r.HandleFunc(\"/request/{id:[0-9]+}\", ProcessRequest).Methods(\"GET\")\n    http.Handle(\"/\", r)\n}\n\nfunc main() {\n    // start server\n    http.ListenAndServe(\":4000\", nil)\n\n    requestChannel = make(chan Request) // &lt;- Make channel and assign to var\n\n    go func() {\n        for {\n            request, ok := &lt;-requestChannel\n\n            if !ok{\n                return\n            }\n\n            fmt.Println(request.Id)\n        }\n    }()\n\n}\n\nfunc ProcessRequest(w http.ResponseWriter, r *http.Request) {\n    params := mux.Vars(r)\n\n    newRequest := api.ConstructRequest(params[\"id\"])\n\n    requestChannel &lt;- newRequest // &lt;- it is stopping here, not adding the value to the channel\n\n    w.Write([]byte(\"Received request\"))\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 24613, "user_id": 555222, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dcd4c7151c0b298d4fb46001df735f6b?s=128&d=identicon&r=PG", "display_name": "clarkk", "link": "https://stackoverflow.com/users/555222/clarkk"}, "edited": false, "score": 0, "creation_date": 1429048737, "post_id": 29638010, "comment_id": 47418498, "body": "@clarkk yeah mb, didn&#39;t mean to post that just yet. It&#39;s updated."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 24613, "user_id": 555222, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dcd4c7151c0b298d4fb46001df735f6b?s=128&d=identicon&r=PG", "display_name": "clarkk", "link": "https://stackoverflow.com/users/555222/clarkk"}, "edited": false, "score": 3, "creation_date": 1429048886, "post_id": 29638010, "comment_id": 47418550, "body": "@clarkk BTW, given it&#39;s a little tricky/annoying to use such a nested map (you need to <code>make(map[string]string)</code> or equiv. each outer map value) also consider if you can instead use <code>type key struct {key1, key2 string}; map[key]string</code> for your purposes."}, {"owner": {"reputation": 6155, "user_id": 4378314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7935867003690df779b06563293f6293?s=128&d=identicon&r=PG", "display_name": "MarsAndBack", "link": "https://stackoverflow.com/users/4378314/marsandback"}, "edited": false, "score": 0, "creation_date": 1522534302, "post_id": 29638010, "comment_id": 86193413, "body": "I&#39;m trying to avoid making a struct for my case, because it&#39;s one-time usage on a single route; not used throughout the app. I&#39;d rather not clutter my structs with something like this."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 12, "last_activity_date": 1429048913, "last_edit_date": 1429048913, "creation_date": 1429048203, "answer_id": 29638010, "question_id": 29637995, "link": "https://stackoverflow.com/questions/29637995/declare-recursive-multidimensional-map/29638010#29638010", "title": "Declare recursive/multidimensional map", "body": "<p>You're looking for <code>map[string]map[string]string</code>. The problem with your example is it's missing the type of the value in the inner map. Here's an example of how to init such a structure;</p>\n\n<pre><code>m := map[string]map[string]string{\n        \"a\": map[string]string{\n            \"1\":\"A\",\n            \"2\": \"B\",\n        },\n        \"b\": map[string]string{\n            \"1\": \"C\",\n            \"2\": \"D\",\n        },\n    }\n</code></pre>\n\n<p>Or following your example;</p>\n\n<pre><code>func main() {\n        m := map[string]map[string]string{}\n        m[\"var1\"] = map[string]string{}\n        m[\"var1\"][\"var2\"] = \"something\"\n        fmt.Println(m[\"var1\"][\"var2\"])\n}\n</code></pre>\n\n<p>That prints something.</p>\n"}], "owner": {"reputation": 24613, "user_id": 555222, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dcd4c7151c0b298d4fb46001df735f6b?s=128&d=identicon&r=PG", "display_name": "clarkk", "link": "https://stackoverflow.com/users/555222/clarkk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8993, "favorite_count": 0, "accepted_answer_id": 29638010, "answer_count": 1, "score": 6, "last_activity_date": 1429048913, "creation_date": 1429048139, "last_edit_date": 1429048313, "question_id": 29637995, "link": "https://stackoverflow.com/questions/29637995/declare-recursive-multidimensional-map", "title": "Declare recursive/multidimensional map", "body": "<pre><code>type Table struct {\n    input map[string]map[string]\n}\n</code></pre>\n\n<p>How to declare a multidimensional or recursive map?</p>\n\n<pre><code>input[\"var1\"][\"var2\"] = \"something\"\n</code></pre>\n\n<h1>update</h1>\n\n<pre><code>type Table struct {\n    input map[map[string]]\n}\n</code></pre>\n\n<p>returns error</p>\n\n<pre><code> syntax error: unexpected ]\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1429048627, "post_id": 29637988, "comment_id": 47418455, "body": "Also see <a href=\"http://stackoverflow.com/questions/14938960/what-does-a-function-without-body-mean\">What does a function without body mean?</a>"}, {"owner": {"reputation": 343, "user_id": 1017818, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c78380a9664ac9a937aabe07ede850e8?s=128&d=identicon&r=PG", "display_name": "srock", "link": "https://stackoverflow.com/users/1017818/srock"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1429049045, "post_id": 29637988, "comment_id": 47418618, "body": "Thanks for pointing to those 2 questions, it did help @Dave C. So does it mean that once golang is bootstrapped (in 1.5, is it possible to replace ASM with Go) these empty functions will be replaced with actual implementation? I have don&#39;t have much clue about compilers. I&#39;m sorry if this comment doesn&#39;t make sense."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1429049203, "post_id": 29637988, "comment_id": 47418667, "body": "I expect/guess all the assembler will remain. If it wasn&#39;t time critical or otherwise easier/necessary to have it in assembler it likely would already have been Go (or C, which as you say has all become Go for 1.5)."}, {"owner": {"reputation": 343, "user_id": 1017818, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c78380a9664ac9a937aabe07ede850e8?s=128&d=identicon&r=PG", "display_name": "srock", "link": "https://stackoverflow.com/users/1017818/srock"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1429049508, "post_id": 29637988, "comment_id": 47418777, "body": "Makes sense. Thank you!"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1429049640, "post_id": 29637988, "comment_id": 47418824, "body": "Assembly still needs to be written using architecture specific machine instructions. Regardless of what the &quot;assembler&quot; is written in, you won&#39;t be able to replace the actual logic of the assembly code with Go. Look at the <code>*$GOOS_$GOARCH.s</code> files in the runtime source."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1429048803, "post_id": 29638052, "comment_id": 47418526, "body": "The problem with the answer was because there&#39;s no need to speculate, it&#39;s written right in the <a href=\"http://golang.org/ref/spec#Function_declarations\" rel=\"nofollow noreferrer\">documentation</a>"}, {"owner": {"reputation": 30089, "user_id": 22147, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/x74x2.png?s=128&g=1", "display_name": "Rhythmic Fistman", "link": "https://stackoverflow.com/users/22147/rhythmic-fistman"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1429049238, "post_id": 29638052, "comment_id": 47418681, "body": "Fair enough. However Sleep is an interesting example of such a function because it can&#39;t be written in go."}], "tags": [], "owner": {"reputation": 30089, "user_id": 22147, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/x74x2.png?s=128&g=1", "display_name": "Rhythmic Fistman", "link": "https://stackoverflow.com/users/22147/rhythmic-fistman"}, "is_accepted": false, "score": 2, "last_activity_date": 1429048436, "creation_date": 1429048436, "answer_id": 29638052, "question_id": 29637988, "link": "https://stackoverflow.com/questions/29637988/empty-function-in-golang/29638052#29638052", "title": "Empty function in golang", "body": "<p>Considering what <code>Sleep()</code> does (it deschedules a golang thread for a given amount of time), you can't express that it in go, so it's probably implemented as some kind of compiler instrinsic.</p>\n\n<p>Whoa, lots of downvotes here. It looks like <code>Sleep</code> is in fact <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/8_Fv5Rb1_K8\" rel=\"nofollow\">implemented in assembly</a>.</p>\n"}], "owner": {"reputation": 343, "user_id": 1017818, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c78380a9664ac9a937aabe07ede850e8?s=128&d=identicon&r=PG", "display_name": "srock", "link": "https://stackoverflow.com/users/1017818/srock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3243, "favorite_count": 1, "closed_date": 1429049525, "answer_count": 1, "score": 1, "last_activity_date": 1429050028, "creation_date": 1429048117, "last_edit_date": 1429050028, "question_id": 29637988, "link": "https://stackoverflow.com/questions/29637988/empty-function-in-golang", "closed_reason": "Duplicate", "title": "Empty function in golang", "body": "<p>Was looking at the source code go source code, below is a snippet from sleep.go (package time):</p>\n\n<pre><code>package time\n\n// Sleep pauses the current goroutine for at least the duration d.\n// A negative or zero duration causes Sleep to return immediately.\nfunc Sleep(d Duration) \n// runtimeNano returns the current value of the runtime clock in nanoseconds.\nfunc runtimeNano() int64\n</code></pre>\n\n<p>How is it possible that func Sleep(d Duration) doesn't have any implementation? Where can I find the exact implementation of Sleep function?</p>\n\n<p>Edit: The answer can be found in the 2 links provided by @DaveC. However please read the comments below to see the explanation about why empty function can't be replaced with Go even after bootstrapping Go (1.5)</p>\n"}, {"tags": ["go", "websocket", "json-rpc"], "answers": [{"tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": false, "score": 0, "last_activity_date": 1429075100, "creation_date": 1429075100, "answer_id": 29642106, "question_id": 29635412, "link": "https://stackoverflow.com/questions/29635412/getting-websocket-connection-information-in-json-rpc-method/29642106#29642106", "title": "Getting websocket connection information in JSON-RPC method", "body": "<p>This will be challenging because it violates the abstraction that RPC provides. Here's a strategy suggestion:</p>\n\n<p>Google uses a context object for lots of their APIs: <a href=\"https://blog.golang.org/context\" rel=\"nofollow\">https://blog.golang.org/context</a>. Part of that interface is a Value method for arbitrary data:</p>\n\n<pre><code>Value(key interface{}) interface{}\n</code></pre>\n\n<p>That will give you something like thread-local storage, which is often used for this purpose in other programming languages.</p>\n\n<p>So how do you add a context object to the request? One way would be to create a new, custom <code>ServerCodec</code>:</p>\n\n<pre><code>type ServerCodec interface {\n    ReadRequestHeader(*Request) error\n    ReadRequestBody(interface{}) error\n    // WriteResponse must be safe for concurrent use by multiple goroutines.\n    WriteResponse(*Response, interface{}) error\n\n    Close() error\n}\n</code></pre>\n\n<p>Your implementation can mostly mirror <code>jsonrpc</code>'s:</p>\n\n<pre><code>var params [1]interface{}\nparams[0] = x\nreturn json.Unmarshal(*c.req.Params, &amp;params)\n</code></pre>\n\n<p>But before returning, you can use a bit of reflection and look for a field in <code>params</code> with name/type <code>Context</code> and then fill it. Something like:</p>\n\n<pre><code>ctx := createContextSomehow()\nv := reflect.ValueOf(x)\nif v.Kind() == reflect.Ptr {\n    v = v.Elem()\n    if v.Kind() == reflect.Struct {\n        ctxv := v.FieldByName(\"Context\")\n        ctxv.Set(ctx)\n    }\n}\n</code></pre>\n\n<p>Then change your request:</p>\n\n<pre><code>type Args struct {\n    A int\n    B int\n}\n</code></pre>\n\n<p>Change it to:</p>\n\n<pre><code>type Args struct {\n    A int\n    B int\n    Context context.Context\n}\n</code></pre>\n\n<p>Kinda clumsy but I think you could make that work.</p>\n"}], "owner": {"reputation": 662, "user_id": 4467308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/926e3460baba919e642f52ffda802cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Sinatra", "link": "https://stackoverflow.com/users/4467308/sinatra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 558, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429075100, "creation_date": 1429038174, "last_edit_date": 1429040961, "question_id": 29635412, "link": "https://stackoverflow.com/questions/29635412/getting-websocket-connection-information-in-json-rpc-method", "title": "Getting websocket connection information in JSON-RPC method", "body": "<p>I am using JSON-RPC over Websocket. And, in an RPC method (say, Multiply in the example below), I need to know which connection called this method. The part below that says \"// Need Websocket connection information here\". How do I do so?</p>\n\n<pre><code>package main\n\nimport (\n    \"code.google.com/p/go.net/websocket\"\n    \"net/http\"\n    \"net/rpc\"\n    \"net/rpc/jsonrpc\"\n)\n\ntype Args struct {\n    A int\n    B int\n}\n\ntype Arith int\n\nfunc (t *Arith) Multiply(args *Args, reply *int) error {\n    *reply = args.A * args.B\n    // Need Websocket connection information here\n    return nil\n}\n\nfunc main() {\n    rpc.Register(new(Arith))\n    http.Handle(\"/conn\", websocket.Handler(serve))\n    http.ListenAndServe(\"localhost:7000\", nil)\n}\n\nfunc serve(ws *websocket.Conn) {\n    jsonrpc.ServeConn(ws)\n}\n</code></pre>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1429036098, "post_id": 29634649, "comment_id": 47411772, "body": "The print statements in producer do get printed, and the msgs channel is closed immediately after the for loop exits. I don&#39;t understand what you&#39;re asking."}, {"owner": {"reputation": 343, "user_id": 1017818, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c78380a9664ac9a937aabe07ede850e8?s=128&d=identicon&r=PG", "display_name": "srock", "link": "https://stackoverflow.com/users/1017818/srock"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1429036282, "post_id": 29634649, "comment_id": 47411883, "body": "Then why is it that in the output, the print statements - &quot;Before closing channel&quot; &amp; &quot;Before passing true to done&quot; is printed after &quot;Consumer:  8&quot; i.e. after all the msgs are consumed?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1429036752, "post_id": 29634649, "comment_id": 47412160, "body": "Sending and receiving on an unbuffered channel is synchronous. The docs will probably help: <a href=\"http://golang.org/doc/effective_go.html#channels\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html#channels</a>"}], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1429039284, "post_id": 29635080, "comment_id": 47413660, "body": "You can also see this by editing the original to have something like <code>var msgs = make(chan int, 99)</code>; a buffered channel with more than enough room. In that case main will likely exit before the consumer can consume anything/everything (the exact ordering is undefined)."}, {"owner": {"reputation": 343, "user_id": 1017818, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c78380a9664ac9a937aabe07ede850e8?s=128&d=identicon&r=PG", "display_name": "srock", "link": "https://stackoverflow.com/users/1017818/srock"}, "edited": false, "score": 0, "creation_date": 1429043474, "post_id": 29635080, "comment_id": 47415868, "body": "Perfect makes sense now. Thanks for the detailed explanation, @JimB."}, {"owner": {"reputation": 343, "user_id": 1017818, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c78380a9664ac9a937aabe07ede850e8?s=128&d=identicon&r=PG", "display_name": "srock", "link": "https://stackoverflow.com/users/1017818/srock"}, "edited": false, "score": 0, "creation_date": 1429043683, "post_id": 29635080, "comment_id": 47415961, "body": "I tired making the msgs channel as buffered. Added few print statements inside the consume(). I saw that every time I ran the code, &quot;fmt.Println(&quot;After calling DONE&quot;)&quot; was printed and even after that I could see print statements from inside the consume() function getting printed. Is it not correct that, whenever &quot;&lt;-done&quot; receives the message in this case bool, it doesn&#39;t wait for any goroutine to complete? So why is it that in this case even though &lt;-done was received and &quot;After calling DONE&quot; was printed I could still see consume() goroutine continuing?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 343, "user_id": 1017818, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c78380a9664ac9a937aabe07ede850e8?s=128&d=identicon&r=PG", "display_name": "srock", "link": "https://stackoverflow.com/users/1017818/srock"}, "edited": false, "score": 0, "creation_date": 1429046850, "post_id": 29635080, "comment_id": 47417590, "body": "@srock: The consumer is free to run up until main returns, so it&#39;s not impossible for it to print out some lines between <code>&lt;-done</code> and the runtime shutting down."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 8, "last_activity_date": 1429037069, "creation_date": 1429037069, "answer_id": 29635080, "question_id": 29634649, "link": "https://stackoverflow.com/questions/29634649/producer-consumer-in-golang/29635080#29635080", "title": "producer consumer in golang", "body": "<p>The <code>msgs</code> channel is unbuffered. This means that for send to complete, there has to be a corresponding receive operation that can also complete. This provides a synchronization point between goroutines.</p>\n\n<p>It's easy to see if you just add a few more print statements to your example</p>\n\n<p><a href=\"http://play.golang.org/p/diYQGN-iwE\" rel=\"noreferrer\">http://play.golang.org/p/diYQGN-iwE</a></p>\n\n<pre><code>func produce() {\n    for i := 0; i &lt; 4; i++ {\n        fmt.Println(\"sending\")\n        msgs &lt;- i\n        fmt.Println(\"sent\")\n    }\n    fmt.Println(\"Before closing channel\")\n    close(msgs)\n    fmt.Println(\"Before passing true to done\")\n    done &lt;- true\n}\n\nfunc consume() {\n    for msg := range msgs {\n        fmt.Println(\"Consumer: \", msg)\n        time.Sleep(100 * time.Millisecond)\n\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>sending\nConsumer:  0\nsent\nsending\nConsumer:  1\nsent\nsending\nConsumer:  2\nsent\nsending\nConsumer:  3\nsent\nBefore closing channel\nBefore passing true to done\nAfter calling DONE\n</code></pre>\n"}], "owner": {"reputation": 343, "user_id": 1017818, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c78380a9664ac9a937aabe07ede850e8?s=128&d=identicon&r=PG", "display_name": "srock", "link": "https://stackoverflow.com/users/1017818/srock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6419, "favorite_count": 1, "accepted_answer_id": 29635080, "answer_count": 1, "score": 5, "last_activity_date": 1429037069, "creation_date": 1429035537, "last_edit_date": 1429036158, "question_id": 29634649, "link": "https://stackoverflow.com/questions/29634649/producer-consumer-in-golang", "title": "producer consumer in golang", "body": "<p>Tried running the below code(producer &amp; consumer) to understand goroutines and channel in golang (removed package and imports from the code snippet below):</p>\n\n<pre><code>var done = make(chan bool)\nvar msgs = make(chan int)\n\nfunc produce() {\n    for i := 0; i &lt; 10; i++ {\n            msgs &lt;- i\n    }\n    fmt.Println(\"Before closing channel\")\n    close(msgs)\n    fmt.Println(\"Before passing true to done\")\n    done &lt;- true\n}\n\nfunc consume() {\n    for {\n            msg := &lt;-msgs\n            time.Sleep(100 * time.Millisecond)\n            fmt.Println(\"Consumer: \", msg)\n    }\n}\n\nfunc main() {\n    go produce()\n    go consume()\n    &lt;-done\n    fmt.Println(\"After calling DONE\")\n}\n</code></pre>\n\n<p>source code from: <a href=\"http://www.golangpatterns.info/concurrency/producer-consumer\" rel=\"noreferrer\">http://www.golangpatterns.info/concurrency/producer-consumer</a></p>\n\n<p>Below is the output when I run the code</p>\n\n<pre><code>Consumer:  0\nConsumer:  1\nConsumer:  2\nConsumer:  3\nConsumer:  4\nConsumer:  5\nConsumer:  6\nConsumer:  7\nConsumer:  8\nBefore closing channel\nBefore passing true to done\nAfter calling DONE\n</code></pre>\n\n<p>Based on my understanding with goroutines and channel:\nWhen we call produce() and consume() from main() using the go keyword, go runtime kicks of 2 goroutines(sort of threads in java world but not actual OS threads) and the main() goroutine comes and halts at \"&lt;-done\".\nNow inside produce() - the loop goes from 0 to 9 and inside the loop the msgs channel receives the int (0 to 9) 1 at a time which is being consumed in parallel by the consume(); however produce has no clue about it and it just keep looping for 0 to 9. </p>\n\n<p>Question: Assuming my above understanding is correct. Once, the for loop is done why is the next printLine inside produce() not getting printed and also why is the msgs channel not getting closed? Why is the goroutine halting inside the produce() until the consumer consumes all the msgs?</p>\n"}, {"tags": ["json", "go", "postgresql-9.4"], "answers": [{"tags": [], "owner": {"reputation": 1168, "user_id": 1976507, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/P0cX2.jpg?s=128&g=1", "display_name": "rafroehlich2", "link": "https://stackoverflow.com/users/1976507/rafroehlich2"}, "is_accepted": false, "score": 0, "last_activity_date": 1429034094, "creation_date": 1429034094, "answer_id": 29634209, "question_id": 29634071, "link": "https://stackoverflow.com/questions/29634071/go-language-and-postgresql-9-4/29634209#29634209", "title": "Go language and PostgreSQL 9.4", "body": "<p>I use <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow\">jmoiron/sqlx</a>. For any not common datatypes you can implement the <code>valuer</code> and <code>scanner</code> interfaces. I have done this for geography points with Postgis using this package.</p>\n"}, {"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 3, "creation_date": 1429035112, "post_id": 29634449, "comment_id": 47411229, "body": "Please don&#39;t ignore errors in &quot;example&quot; code (it&#39;s almost by definition incorrect code). You know some fool will blindly cut-n-paste it and get into the habit of doing it that way and later make some other SO answerer&#39;s life difficult by asking a question filled with code ignoring the errors that would have told them what their problem was. &lt;/rant&gt;"}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1429035458, "post_id": 29634449, "comment_id": 47411424, "body": "@DaveC: sure, that&#39;s legit, but I&#39;m honestly torn on the subject.  I typically try to post as little code as possible to clearly demonstrate my intent (instead of drowning it in details) so things like error handling and cleanup are often omitted.  Is it my responsibility to make sure the cut-n-pasting fool doesn&#39;t blow his own foot off?"}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1429036028, "post_id": 29634449, "comment_id": 47411725, "body": "@DaveC: I&#39;ve posted a meta question because I think you&#39;re point is valid <a href=\"http://meta.stackoverflow.com/questions/290223/should-i-demonstrate-best-practices-in-example-code-or-opt-for-conciseness\" title=\"should i demonstrate best practices in example code or opt for conciseness\">meta.stackoverflow.com/questions/290223/&hellip;</a>"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1429036039, "post_id": 29634449, "comment_id": 47411735, "body": "Indeed, handling all possible cases in a simple answer can get distractingly verbose quite quickly. I wouldn&#39;t complain except that I see far too many SO questions that can&#39;t be answered without knowing the ignored errors; they&#39;re getting their examples from somewhere. Personally I at least put in a panic or a <code>&#47;&#47; check error!!</code> comment; (it&#39;s even more hidden for things like <code>rows.Scan</code>)."}, {"owner": {"reputation": 3446, "user_id": 2061590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSoY0.jpg?s=128&g=1", "display_name": "Dmitri Goldring", "link": "https://stackoverflow.com/users/2061590/dmitri-goldring"}, "edited": false, "score": 0, "creation_date": 1429128981, "post_id": 29634449, "comment_id": 47459550, "body": "Please note that the basic JSON data type was added in 9.2. Postgresql 9.4 adds the jsonb data type which supports a superset of operators."}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "reply_to_user": {"reputation": 3446, "user_id": 2061590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSoY0.jpg?s=128&g=1", "display_name": "Dmitri Goldring", "link": "https://stackoverflow.com/users/2061590/dmitri-goldring"}, "edited": false, "score": 0, "creation_date": 1429129732, "post_id": 29634449, "comment_id": 47459991, "body": "@DmitriGoldring: cool, thanks for the info - I updated my answer to mention it."}], "tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 2, "last_activity_date": 1429129708, "last_edit_date": 1429129708, "creation_date": 1429034873, "answer_id": 29634449, "question_id": 29634071, "link": "https://stackoverflow.com/questions/29634071/go-language-and-postgresql-9-4/29634449#29634449", "title": "Go language and PostgreSQL 9.4", "body": "<p>Yes, the <a href=\"https://github.com/lib/pq\" rel=\"nofollow\">go <code>pq</code> library</a> should support PostgreSQL v9.4 and it has basic support for JSON types as strings (which seem to have been <a href=\"http://www.postgresql.org/docs/9.2/static/datatype-json.html\" rel=\"nofollow\">added in v9.2</a>).</p>\n\n<pre><code>// CREATE TABLE foo (id SERIAL PRIMARY KEY, stuff json);\n// INSERT INTO foo (stuff) VALUES ('{\"x\":123}');\n\ntype Foo struct {\n  Id    int,\n  Stuff string,\n}\n\nrows, err := db.Query(\"SELECT * FROM foo LIMIT 1\") // TODO: handle error\ndefer rows.Close()\nfor rows.Next() {\n  foo := Foo{}\n  err = rows.Scan(&amp;foo.Id, &amp;foo.Stuff) // TODO: handle error\n  # main.Foo{Id:1, Stuff:\"{\\\"x\\\":123}\"}\n}\n</code></pre>\n\n<p>You can either post-process the JSON string or create a custom type with a custom \"Scan\" method:</p>\n\n<pre><code>type Foo struct {\n  Id    int,\n  Stuff MyStuff,\n}\n\nfunc (e *MyStuff) Scan(value interface{}) error {\n  // Value should be a []byte of the JSON string.\n  // Do whatever you want with it here...\n}\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 4638860, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/768212f16481aed42b312f00cbc281e1?s=128&d=identicon&r=PG&f=1", "display_name": "Ganesh", "link": "https://stackoverflow.com/users/4638860/ganesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1429129708, "creation_date": 1429033583, "question_id": 29634071, "link": "https://stackoverflow.com/questions/29634071/go-language-and-postgresql-9-4", "title": "Go language and PostgreSQL 9.4", "body": "<p>Is there a PostgreSQL library for Go Language that supports PostgreSQL version 9.4.\nPostgreSQL 9.4 has support for JSON datatype and was wondering if it can be used with Go Language?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1429025272, "post_id": 29630699, "comment_id": 47405351, "body": "<b>Never</b> use the two variable version of a <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertion</a> and ignore the second variable (e.g. the line you have that is similar to <code>x, _ := something.(float64)</code>). If you really expect/know the type then just use the single variable version and let Go panic if the type isn&#39;t what you expect/know. If you don&#39;t then check the boolean second variable. A test should assume the function might return anything and check."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1429025444, "post_id": 29630699, "comment_id": 47405474, "body": "You&#39;re testing <code>Intersect</code> so actually test it&#39;s return values. I.e. don&#39;t ignore it&#39;s <code>error</code> return but test/check/verify it. (e.g. if the the function returns the correct answer but with non-nil error then it&#39;s wrong and your test should fail it)."}], "answers": [{"tags": [], "owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "is_accepted": true, "score": 6, "last_activity_date": 1429023582, "creation_date": 1429023582, "answer_id": 29630746, "question_id": 29630699, "link": "https://stackoverflow.com/questions/29630699/multiple-value-in-single-value-context/29630746#29630746", "title": "Multiple-value in single-value context", "body": "<p>It's because of the type assertion, which takes only a single value.</p>\n\n<p>Do this instead:</p>\n\n<pre><code>gotInterval, _ := c.iv1.Intersect(c.iv2)\ngot := gotInterval.(floatInterval)\n</code></pre>\n"}], "owner": {"reputation": 789, "user_id": 1775362, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c816b0bc3962db508ee8741701a3aa30?s=128&d=identicon&r=PG", "display_name": "DenverCoder21", "link": "https://stackoverflow.com/users/1775362/denvercoder21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2485, "favorite_count": 0, "accepted_answer_id": 29630746, "answer_count": 1, "score": 2, "last_activity_date": 1429023582, "creation_date": 1429023443, "question_id": 29630699, "link": "https://stackoverflow.com/questions/29630699/multiple-value-in-single-value-context", "title": "Multiple-value in single-value context", "body": "<p>I'm currently trying out Go and am stuck with the aforementioned error message. Have a look at the interface, its implementation for float64 and the test.</p>\n\n<p>Interface:</p>\n\n<pre><code>package interval\n\nimport (\n    \"errors\"\n    \"fmt\"\n    \"math\"\n)\n\ntype Interval interface {\n    Intersect(Y Interval) (Interval, error) // Intersection of X and Y, error 'nil' when empty\n}\n\ntype floatInterval struct {\n    a, b float64\n}\n\nfunc (fi floatInterval) Intersect(Y Interval) (Interval, error) {\n    tmp := Y.(floatInterval)\n\n    a_new, b_new := math.Max(fi.a, tmp.a), math.Min(fi.b, tmp.b)\n\n    result := floatInterval{a_new, b_new}\n    if result.Length() == 0 {\n        return result, errors.New(\"Empty interval\")\n    } else {\n        return result, nil\n    }\n}\n</code></pre>\n\n<p>Test:</p>\n\n<pre><code>func intersect_test(t *testing.T, c testTuple) {\n    got, _ := c.iv1.Intersect(c.iv2).(floatInterval)\n    if (c.intersectWant.a != got.a) || (c.intersectWant.b != got.b) {\n        t.Errorf(\"Expected: [%f, %f] \\t Got: [%f, %f]\", c.intersectWant.a, c.intersectWant.b, got.a, got.b)\n    }\n}\n</code></pre>\n\n<p>The error occurs in the second line of the test function. I am aware that intersect returns two values: The interval and an error value. But since I am assigning both with <code>got, _ := c.iv1.Intersect(c.iv2).(floatInterval)</code> I thought I'm on the safe side. I also tried <code>got, err := ...</code> by the way. Is that due to the type conversion I'm doing with <code>.(floatInterval)</code> ?</p>\n"}, {"tags": ["go", "youtube-data-api", "google-api-go-client"], "answers": [{"comments": [{"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "edited": false, "score": 0, "creation_date": 1429024318, "post_id": 29630761, "comment_id": 47404706, "body": "I guessed about that, how to solve it? how to search by 2 different keys during runtime"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "edited": false, "score": 0, "creation_date": 1429024840, "post_id": 29630761, "comment_id": 47405065, "body": "@efr Why do you use <code>flag</code> package there in the first place? From the YouTube example, it seems like you just need to pass <code>str</code> directly to <code>Q</code>."}, {"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "edited": false, "score": 0, "creation_date": 1429059118, "post_id": 29630761, "comment_id": 47421467, "body": "from the link above: <code>query      = flag.String(&quot;query&quot;, &quot;Google&quot;, &quot;Search term&quot;)</code> - glag is used to set search key. How should I pass <code>str</code> directly to <code>Q</code>?"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "edited": false, "score": 3, "creation_date": 1429098383, "post_id": 29630761, "comment_id": 47438470, "body": "@efr Please read the <a href=\"http://golang.org/pkg/flag/\" rel=\"nofollow noreferrer\"><code>flag</code> package documentation</a> and what it&#39;s used for. In your case, you should just omit the <code>flag</code> part and call <code>Q(str)</code> instead of <code>Q(*query)</code>."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 2, "last_activity_date": 1429023629, "creation_date": 1429023629, "answer_id": 29630761, "question_id": 29630598, "link": "https://stackoverflow.com/questions/29630598/flag-redefined-panic-searching-by-key-in-youtube-data-api-3/29630761#29630761", "title": "flag redefined - panic searching by key in YouTube data API 3", "body": "<p>The panic message tells you exactly what's wrong. Your command line flags should be defined only once. If you try to redefine them during runtime, it panics.</p>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2351, "favorite_count": 0, "accepted_answer_id": 29630761, "answer_count": 1, "score": 0, "last_activity_date": 1575369403, "creation_date": 1429023152, "last_edit_date": 1575369403, "question_id": 29630598, "link": "https://stackoverflow.com/questions/29630598/flag-redefined-panic-searching-by-key-in-youtube-data-api-3", "title": "flag redefined - panic searching by key in YouTube data API 3", "body": "<p>I am trying to search YouTube video by key like in <a href=\"https://developers.google.com/youtube/v3/code_samples/go#search_by_keyword\" rel=\"nofollow noreferrer\">the golang example</a>. I modified that code a little to let it search by different keys several times.</p>\n\n<p>When I search once it is ok. </p>\n\n<pre><code>func main() {\n    result1, err1 := SearchYoutubeByKey(\"hello\")\n\n    if err1 != nil {\n        panic(err1)\n    }\n    fmt.Println(result1)\n\n    // result2, err2 := SearchYoutubeByKey(\"world\")\n    // if err2 != nil {\n    //  panic(err2)\n    // }\n    // fmt.Println(result2)\n}\n</code></pre>\n\n<p>But if I search twice ...</p>\n\n<pre><code>func main() {\n    result1, err1 := SearchYoutubeByKey(\"hello\")\n\n    if err1 != nil {\n        panic(err1)\n    }\n    fmt.Println(result1)\n\n    result2, err2 := SearchYoutubeByKey(\"world\")\n    if err2 != nil {\n        panic(err2)\n    }\n    fmt.Println(result2)\n}\n</code></pre>\n\n<p>... then it panics with error message ...</p>\n\n<pre><code>flag redefined: query\n</code></pre>\n\n<p>... on line ...</p>\n\n<pre><code>query := flag.String(\"query\", str, \"Search term\")\n</code></pre>\n\n<p>Full code:</p>\n\n<pre><code>package main\n\nimport (\n    \"code.google.com/p/google-api-go-client/googleapi/transport\"\n    \"code.google.com/p/google-api-go-client/youtube/v3\"\n    \"flag\"\n    \"fmt\"\n    \"net/http\"\n)\n\nvar (\n    maxResults = flag.Int64(\"max-results\", 25, \"Max YouTube results\")\n    service    *youtube.Service\n    response   *youtube.SearchListResponse\n)\n\nconst developerKey = \"youtube developer key\"\n\ntype YoutubeSearchResult struct {\n    Title, YoutubeId string\n}\n\nfunc SearchYoutubeByKey(str string) (result []*YoutubeSearchResult, err error) {\n    query := flag.String(\"query\", str, \"Search term\")\n    flag.Parse()\n\n    client := &amp;http.Client{\n        Transport: &amp;transport.APIKey{Key: developerKey},\n    }\n\n    service, err = youtube.New(client)\n    if err != nil {\n        return\n    }\n\n    // Make the API call to YouTube.\n    call := service.Search.List(\"id,snippet\").\n        Q(*query).\n        MaxResults(*maxResults)\n    response, err = call.Do()\n    if err != nil {\n        return\n    }\n\n    // Iterate through each item and add it to the correct list.\n    for _, item := range response.Items {\n        switch item.Id.Kind {\n        case \"youtube#video\":\n            result = append(result, &amp;YoutubeSearchResult{Title: item.Snippet.Title, YoutubeId: item.Id.VideoId})\n        }\n    }\n    return\n}\n\nfunc main() {\n\n\n    result1, err1 := SearchYoutubeByKey(\"hello\")\n\n    if err1 != nil {\n        panic(err1)\n    }\n    fmt.Println(result1)\n\n    result2, err2 := SearchYoutubeByKey(\"world\")\n    if err2 != nil {\n        panic(err2)\n    }\n    fmt.Println(result2)\n}\n</code></pre>\n\n<p>So it is impossible to use this code on a website. Only the first user will be able to search first time, the others will fail.</p>\n\n<p>I cannot change flag during runtime but how to search by 2 different keys in one program? </p>\n\n<h1>Update</h1>\n\n<p>working solution:</p>\n\n<pre><code>package main\n\nimport (\n    \"code.google.com/p/google-api-go-client/googleapi/transport\"\n    \"code.google.com/p/google-api-go-client/youtube/v3\"\n    \"flag\"\n    \"fmt\"\n    \"net/http\"\n)\n\nvar (\n    maxResults = flag.Int64(\"max-results\", 25, \"Max YouTube results\")\n    service    *youtube.Service\n    response   *youtube.SearchListResponse\n    query      = flag.String(\"query\", \"str\", \"Search term\")\n)\n\nconst developerKey = \"youtube api key\"\n\ntype YoutubeSearchResult struct {\n    Title, YoutubeId string\n}\n\nfunc SearchYoutubeByKey(str string) (result []*YoutubeSearchResult, err error) {\n    flag.Parse()\n\n    client := &amp;http.Client{\n        Transport: &amp;transport.APIKey{Key: developerKey},\n    }\n\n    service, err = youtube.New(client)\n    if err != nil {\n        return\n    }\n\n    // Make the API call to YouTube.\n    call := service.Search.List(\"id,snippet\").\n        Q(str).\n        MaxResults(*maxResults)\n    response, err = call.Do()\n    if err != nil {\n        return\n    }\n\n    // Iterate through each item and add it to the correct list.\n    for _, item := range response.Items {\n        switch item.Id.Kind {\n        case \"youtube#video\":\n            result = append(result, &amp;YoutubeSearchResult{Title: item.Snippet.Title, YoutubeId: item.Id.VideoId})\n        }\n    }\n    return\n}\n\nfunc main() {\n    result1, err1 := SearchYoutubeByKey(\"hello\")\n\n    if err1 != nil {\n        panic(err1)\n    }\n    fmt.Println(result1)\n\n    result2, err2 := SearchYoutubeByKey(\"world\")\n    if err2 != nil {\n        panic(err2)\n    }\n    fmt.Println(result2)\n}\n</code></pre>\n"}, {"tags": ["go", "libgit2"], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 155289, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Suw2g.jpg?s=128&g=1", "display_name": "hdanniel", "link": "https://stackoverflow.com/users/155289/hdanniel"}, "edited": false, "score": 0, "creation_date": 1429309021, "post_id": 29634810, "comment_id": 47556230, "body": "Thanks. I can update the working director but not the index. I think that I&#39;m on the right track."}], "tags": [], "owner": {"reputation": 5037, "user_id": 1370215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/023e1295851b018af03706f391b76931?s=128&d=identicon&r=PG", "display_name": "Carlos Mart&#237;n Nieto", "link": "https://stackoverflow.com/users/1370215/carlos-mart%c3%adn-nieto"}, "is_accepted": true, "score": 1, "last_activity_date": 1429036072, "creation_date": 1429036072, "answer_id": 29634810, "question_id": 29629911, "link": "https://stackoverflow.com/questions/29629911/doing-git-fetch-git-merge-from-remote-with-git2go/29634810#29634810", "title": "Doing git fetch &amp;&amp; git merge from remote with git2go", "body": "<p>You are asking to connect to the remote twice (<code>err = remote.Connect(git.ConnectDirectionFetch)</code> and <code>err = remote.ConnectFetch()</code>), but you're not asking it for anything. Instead of trying to connect twice, use the all-in-one fetch method</p>\n\n<pre><code>remote.Fetch(nil, nil, nil)\n</code></pre>\n\n<p>to connect, download and update the remote-tracking branches. Then you can check whether there was an update and merge or do whatever you need.</p>\n"}], "owner": {"reputation": 123, "user_id": 155289, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Suw2g.jpg?s=128&g=1", "display_name": "hdanniel", "link": "https://stackoverflow.com/users/155289/hdanniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 692, "favorite_count": 0, "accepted_answer_id": 29634810, "answer_count": 1, "score": 2, "last_activity_date": 1429036072, "creation_date": 1429021399, "question_id": 29629911, "link": "https://stackoverflow.com/questions/29629911/doing-git-fetch-git-merge-from-remote-with-git2go", "title": "Doing git fetch &amp;&amp; git merge from remote with git2go", "body": "<p>I'm using libgit2/git2go v0.22 and trying to implement something similar to a \"git pull\" from a remote repository. In this case <strong>The working directory doesn't write anything: no changes, no commits, no push.</strong> It will only pull data from the remote.</p>\n\n<p>Using git2go I can clone the remote repository, load/lookup a remote origin, fetch the remote, list remote headers, etc. It seems that the only step not working is the merge.\nMy code looks like this (i'm ommiting the error handling):</p>\n\n<pre><code>repo, err:= git.OpenRepository(sitesConfig.Sites[SiteName].Path)\nremote, err:= repo.LookupRemote(\"origin\")\nerr = remote.SetCallbacks(&amp;rcbs)\nerr = remote.Connect(git.ConnectDirectionFetch)\nerr = remote.ConnectFetch()\n\nremote_master, err := repo.LookupReference(\"refs/remotes/origin/master\")\nmergeRemoteHead, err := repo.AnnotatedCommitFromRef(remote_master)\nmergeHeads := make([]*git.AnnotatedCommit, 1)\nmergeHeads[0] = mergeRemoteHead\nerr = repo.Merge(mergeHeads, nil, nil)\nrepo.StateCleanup()\n</code></pre>\n\n<p>No errors appear when running this code, but the working directory is not updated. Using \"git pull\" and \"git fetch &amp;&amp; git marge origin/master\" on the same directory worked fine.</p>\n\n<p>Is something missing? A final commit? </p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1429019749, "post_id": 29629274, "comment_id": 47401330, "body": "Please link to the specific library or API you are using - &quot;datastore&quot; is a somewhat generic term."}, {"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 0, "creation_date": 1429019802, "post_id": 29629274, "comment_id": 47401378, "body": "Are you using Google App Engine Datastore? Please tag your question accordingly. Also, do you use DB or NDB to access it?"}, {"owner": {"reputation": 4687, "user_id": 1221132, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a5046ae2fcac22bc44c6663a121f0cc8?s=128&d=identicon&r=PG", "display_name": "theva", "link": "https://stackoverflow.com/users/1221132/theva"}, "edited": false, "score": 0, "creation_date": 1429019833, "post_id": 29629274, "comment_id": 47401403, "body": "<a href=\"https://cloud.google.com/appengine/docs/go/datastore/\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/docs/go/datastore</a> I am using Google appengine"}, {"owner": {"reputation": 4687, "user_id": 1221132, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a5046ae2fcac22bc44c6663a121f0cc8?s=128&d=identicon&r=PG", "display_name": "theva", "link": "https://stackoverflow.com/users/1221132/theva"}, "edited": false, "score": 0, "creation_date": 1429019944, "post_id": 29629274, "comment_id": 47401487, "body": "I don&#39;t really know if I am using DB or NDB, what is the default?"}, {"owner": {"reputation": 32193, "user_id": 2908724, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1xBJR.png?s=128&g=1", "display_name": "bishop", "link": "https://stackoverflow.com/users/2908724/bishop"}, "edited": false, "score": 0, "creation_date": 1429020336, "post_id": 29629274, "comment_id": 47401776, "body": "In the specific case of GAE Datastore, I&#39;d recommend <a href=\"http://stackoverflow.com/questions/993059/is-there-a-way-to-do-aggregate-functions-on-google-app-engine\">tracking the max manually</a>.  I suggest this because, presumably, you&#39;re using GAED for scalability and should design accordingly."}, {"owner": {"reputation": 38473, "user_id": 821657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qDRGg.png?s=128&g=1", "display_name": "Andrei Volgin", "link": "https://stackoverflow.com/users/821657/andrei-volgin"}, "edited": false, "score": 0, "creation_date": 1429022081, "post_id": 29629274, "comment_id": 47403051, "body": "Tracking manually is the opposite of scalability, especially since the max value can be retrieved so easily at a minimum cost."}], "answers": [{"comments": [{"owner": {"reputation": 38473, "user_id": 821657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qDRGg.png?s=128&g=1", "display_name": "Andrei Volgin", "link": "https://stackoverflow.com/users/821657/andrei-volgin"}, "edited": false, "score": 1, "creation_date": 1429021948, "post_id": 29629398, "comment_id": 47402953, "body": "Just to be thorough, the field has to be indexed for this to work."}], "tags": [], "owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "is_accepted": true, "score": 4, "last_activity_date": 1429020063, "creation_date": 1429020063, "answer_id": 29629398, "question_id": 29629274, "link": "https://stackoverflow.com/questions/29629274/how-do-i-find-a-max-value-in-datastore/29629398#29629398", "title": "How do I find a max value in datastore?", "body": "<p>There's no direct <code>max</code> function, but you can do a <code>your_query.Order('-the_field').Limit(1)</code>. Minus is for descending sorting.</p>\n\n<p>This will sort the entries by <code>the_field</code> and give you the top result, which has the maximum value.</p>\n\n<p>Note that if you have several entries that share the maximum value, you'll receive only one of them. This is easy to amend with a larger <code>Limit</code>.</p>\n"}], "owner": {"reputation": 4687, "user_id": 1221132, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a5046ae2fcac22bc44c6663a121f0cc8?s=128&d=identicon&r=PG", "display_name": "theva", "link": "https://stackoverflow.com/users/1221132/theva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1158, "favorite_count": 0, "accepted_answer_id": 29629398, "answer_count": 1, "score": 2, "last_activity_date": 1482861807, "creation_date": 1429019677, "last_edit_date": 1482861807, "question_id": 29629274, "link": "https://stackoverflow.com/questions/29629274/how-do-i-find-a-max-value-in-datastore", "title": "How do I find a max value in datastore?", "body": "<p>I am using go and datastore and I want to have a query where I get the max value from the datastore. I can't find anything about max values in the docs. How can I accomplish that?</p>\n\n<p>I am using Google App Engine <a href=\"https://cloud.google.com/appengine/docs/go/datastore/\" rel=\"nofollow\">https://cloud.google.com/appengine/docs/go/datastore/</a></p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "is_accepted": true, "score": 15, "last_activity_date": 1429013351, "creation_date": 1429013351, "answer_id": 29626924, "question_id": 29626542, "link": "https://stackoverflow.com/questions/29626542/how-can-i-use-division-in-a-golang-template/29626924#29626924", "title": "How can I use division in a golang template?", "body": "<p>The package <code>text/template</code> (and subsequently <code>html/template</code>) can provide the functionality by defining division as a function using <a href=\"http://golang.org/pkg/text/template/#Template.Funcs\" rel=\"noreferrer\"><code>Template.Funcs</code></a>:</p>\n\n<pre><code>func (t *Template) Funcs(funcMap FuncMap) *Template\n</code></pre>\n\n<p>In your case, a <code>FuncMap</code> with a divide function could look something like this:</p>\n\n<pre><code>fm := template.FuncMap{\"divide\": func(a, b int) int {\n    return a / b\n}}\n</code></pre>\n\n<p>Full example (but without me trying to understand what you mean with <code>if a/2</code>):</p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n    \"text/template\"\n)\n\nfunc main() {\n    fm := template.FuncMap{\"divide\": func(a, b int) int {\n        return a / b\n    }}\n\n    tmplTxt := `{{divide . 2}}`\n\n    // Create a template, add the function map, and parse the text.\n    tmpl, err := template.New(\"foo\").Funcs(fm).Parse(tmplTxt)\n    if err != nil {\n        panic(err)\n    }\n\n    // Run the template to verify the output.\n    err = tmpl.Execute(os.Stdout, 10)\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<blockquote>\n  <p>5</p>\n</blockquote>\n\n<p><strong>Playground:</strong> <a href=\"http://play.golang.org/p/VOhTYbdj6P\" rel=\"noreferrer\">http://play.golang.org/p/VOhTYbdj6P</a></p>\n"}], "owner": {"reputation": 61, "user_id": 4787128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0a3db4d9fe3bc0edcc928acc7bccf6a?s=128&d=identicon&r=PG&f=1", "display_name": "cclsazob", "link": "https://stackoverflow.com/users/4787128/cclsazob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2929, "favorite_count": 1, "accepted_answer_id": 29626924, "answer_count": 1, "score": 5, "last_activity_date": 1429020524, "creation_date": 1429012230, "last_edit_date": 1429020524, "question_id": 29626542, "link": "https://stackoverflow.com/questions/29626542/how-can-i-use-division-in-a-golang-template", "title": "How can I use division in a golang template?", "body": "<p>How can I use division in a golang template. I need to divide <code>Id</code> by 2.</p>\n\n<p>For example</p>\n\n<pre><code>{{if .Id/2}}\nHEY, I CAN DO IT!\n{{else}}\nWHY???\n{{end}}\n</code></pre>\n"}, {"tags": ["go", "oauth-2.0", "google-oauth"], "answers": [{"tags": [], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "is_accepted": true, "score": 4, "last_activity_date": 1428997380, "last_edit_date": 1428997380, "creation_date": 1428996824, "answer_id": 29621608, "question_id": 29620344, "link": "https://stackoverflow.com/questions/29620344/how-to-get-google-e-mail-using-oauth2-in-golang-correctly/29621608#29621608", "title": "How to get google e-mail using OAuth2 in Golang correctly", "body": "<p>My bad, I should read the <code>response.Body</code> first, for example:</p>\n\n<pre><code>response, err = client.Get(`https://accounts.google.com/.well-known/openid-configuration`)\nbody, err := ioutil.ReadAll(response.Body)\nresponse.Body.Close()\n</code></pre>\n\n<p>According to <a href=\"https://developers.google.com/identity/protocols/OpenIDConnect#validatinganidtoken\" rel=\"nofollow\">this</a> document, we should fetch from that URL first, then fetch from <code>userinfo_endpoint</code> from the result above to retrieve the e-mail, for example:</p>\n\n<pre><code>// json := json_to_map(body)\n// get json[`userinfo_endpoint`]\n// response, err = client.Get(json[`userinfo_endpoint`])\n// body, err := ioutil.ReadAll(response.Body)\n// response.Body.Close()\n// json = json_to_map(body)\n// json[`email`]\n</code></pre>\n\n<p>For the second question, the <code>oauth2.Config</code> struct is reusable.</p>\n"}], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1308, "favorite_count": 2, "accepted_answer_id": 29621608, "answer_count": 1, "score": 3, "last_activity_date": 1428997380, "creation_date": 1428992125, "last_edit_date": 1428996378, "question_id": 29620344, "link": "https://stackoverflow.com/questions/29620344/how-to-get-google-e-mail-using-oauth2-in-golang-correctly", "title": "How to get google e-mail using OAuth2 in Golang correctly", "body": "<p>I've already tried to authenticate using OAuth sucessfully with <code>golang.com/x/oauth2</code> library.</p>\n\n<pre><code>// provider variable is oauth2.Config\n// scope is: https://www.googleapis.com/auth/userinfo.email\nurl := provider.AuthCodeURL(``) // redirect URL\n</code></pre>\n\n<p>after getting redirected back from the client, I send the <code>auth_code</code> successfully</p>\n\n<pre><code>auth_code := ctx.Request.URL.RawQuery // code=XXXX\nif len(auth_code) &gt; 5 {\n    auth_code = auth_code[5:] // XXXX\n}\ntok, err := provider.Exchange(oauth2.NoContext, auth_code)\nif err == nil {\n    client := provider.Client(oauth2.NoContext, tok)\n    email_url := `https://www.googleapis.com/auth/userinfo.email`\n    //Log.Describe(client)\n    response, err := client.Get(email_url) \n    if err == nil {\n        ctx.Render(`login_oauth`, response)\n        //handled = true\n    }\n}\n//Log.Describe(err)\n</code></pre>\n\n<p>I found nothing that tells the e-mail part on the <code>response</code> (the <code>Body</code> is empty):</p>\n\n<pre><code>{\n    \"Status\": \"200 OK\",\n    \"StatusCode\": 200,\n    \"Proto\": \"HTTP/1.1\",\n    \"ProtoMajor\": 1,\n    \"ProtoMinor\": 1,\n    \"Header\": {\n        \"Alternate-Protocol\": [\n            \"443:quic,p=0.5\"\n        ],\n        \"Cache-Control\": [\n            \"private, max-age=0\"\n        ],\n        \"Content-Type\": [\n            \"text/plain\"\n        ],\n        \"Date\": [\n            \"Tue, 14 Apr 2015 05:52:17 GMT\"\n        ],\n        \"Expires\": [\n            \"Tue, 14 Apr 2015 05:52:17 GMT\"\n        ],\n        \"Server\": [\n            \"GSE\"\n        ],\n        \"X-Content-Type-Options\": [\n            \"nosniff\"\n        ],\n        \"X-Frame-Options\": [\n            \"SAMEORIGIN\"\n        ],\n        \"X-Xss-Protection\": [\n            \"1; mode=block\"\n        ]\n    },\n    \"Body\": {}, // empty!!!\n    \"ContentLength\": -1,\n    \"TransferEncoding\": [\n        \"chunked\"\n    ],\n    \"Close\": false,\n    \"Trailer\": null,\n    \"Request\": {\n        \"Method\": \"GET\",\n        \"URL\": {\n            \"Scheme\": \"https\",\n            \"Opaque\": \"\",\n            \"User\": null,\n            \"Host\": \"www.googleapis.com\",\n            \"Path\": \"/auth/userinfo.email\",\n            \"RawQuery\": \"\",\n            \"Fragment\": \"\"\n        },\n        \"Proto\": \"HTTP/1.1\",\n        \"ProtoMajor\": 1,\n        \"ProtoMinor\": 1,\n        \"Header\": {\n            \"Authorization\": [\n                \"Bearer ya29.VQFRHDe21t7g2cUhN8sUwjpRRi10XldgLe0RFhMe2ZxgyRo7q90HoKES5WmcucwKqtjZdq_KvYjKiQ\"\n            ]\n        },\n        \"Body\": null,\n        \"ContentLength\": 0,\n        \"TransferEncoding\": null,\n        \"Close\": false,\n        \"Host\": \"www.googleapis.com\",\n        \"Form\": null,\n        \"PostForm\": null,\n        \"MultipartForm\": null,\n        \"Trailer\": null,\n        \"RemoteAddr\": \"\",\n        \"RequestURI\": \"\",\n        \"TLS\": null\n    },\n    \"TLS\": {\n         // really long output\n    }\n}\n</code></pre>\n\n<p><strong>First question</strong>, how to get the e-mail correctly? without using Google+ API.</p>\n\n<p><strong>edit #2</strong> I've tried using another <code>scope</code> for <code>oauth2.Config</code>:</p>\n\n<pre><code>https://www.googleapis.com/auth/plus.profile.emails.read\nhttps://www.googleapis.com/auth/plus.login\nhttps://www.googleapis.com/auth/plus.me\n</code></pre>\n\n<p>and try to retrieve the e-mail using newer API:</p>\n\n<pre><code>https://www.googleapis.com/plus/v1/people/me\n</code></pre>\n\n<p>but it gives <code>403 Forbidden</code></p>\n\n<p><strong>edit #3</strong> I've tried using another scope:</p>\n\n<pre><code>openid\nprofile\nemail\n</code></pre>\n\n<p>and try to retrieve the e-mail using this URL:</p>\n\n<pre><code>https://www.googleapis.com/oauth2/v3/userinfo\n</code></pre>\n\n<p>but it still give empty <code>Body</code> as before.</p>\n\n<p><strong>Second question</strong>, can I reuse the <code>oauth2.Config</code> (<code>provider</code>) variable for another user? or should I create a copies for each user?</p>\n"}, {"tags": ["sql", "model-view-controller", "go"], "answers": [{"tags": [], "owner": {"reputation": 3762, "user_id": 982198, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/rlCQj.png?s=128&g=1", "display_name": "ddarellis", "link": "https://stackoverflow.com/users/982198/ddarellis"}, "is_accepted": false, "score": 3, "last_activity_date": 1428990189, "creation_date": 1428990189, "answer_id": 29619942, "question_id": 29619787, "link": "https://stackoverflow.com/questions/29619787/where-should-my-sql-code-go-in-mvc/29619942#29619942", "title": "Where should my SQL code go in MVC", "body": "<p>In model-view-controller pattern... </p>\n\n<p>Model is for entities all your classes represent real world objects.</p>\n\n<p>View is the forms and all the graphic things user can see and interact with.</p>\n\n<p>Controller is for controller classes, is all the logic of the program, for the sql code as you said you can implement a <a href=\"http://www.tutorialspoint.com/design_pattern/data_access_object_pattern.htm\" rel=\"nofollow\">dao pattern</a> and have all the sql code in the controller package and the database class in the entities package(i leave it in the Controller class).</p>\n"}, {"comments": [{"owner": {"reputation": 9325, "user_id": 4931, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f4182656449e54bde861a02d6ef44ecd?s=128&d=identicon&r=PG", "display_name": "Michael Deardeuff", "link": "https://stackoverflow.com/users/4931/michael-deardeuff"}, "edited": false, "score": 0, "creation_date": 1429210751, "post_id": 29622591, "comment_id": 47504214, "body": "No, the DBMS is just another <b>view</b> of the model. The &quot;database is the model&quot; idea was popularized by <b>database wrappers</b> like Hibernate and Rails&#39; ActiveRecord."}], "tags": [], "owner": {"reputation": 3559, "user_id": 2149414, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/itddd.png?s=128&g=1", "display_name": "sitilge", "link": "https://stackoverflow.com/users/2149414/sitilge"}, "is_accepted": false, "score": 0, "last_activity_date": 1429000247, "creation_date": 1429000247, "answer_id": 29622591, "question_id": 29619787, "link": "https://stackoverflow.com/questions/29619787/where-should-my-sql-code-go-in-mvc/29622591#29622591", "title": "Where should my SQL code go in MVC", "body": "<blockquote>\n  <p>I assume that the form structure is part of the model, so I have some function that goes with the form that after a user submits the form, the data gets put into the database, so my function would look something like this</p>\n</blockquote>\n\n<p>Another use of Model in MVC application architecture is to store reusable code. So, yes, you can store the form in Model (for example, if you reuse it multiple in views) but this makes less sense than storing form in a View and reuse it later on.</p>\n\n<p>The execution backtrace would be something like</p>\n\n<ol>\n<li>Controller processes the request - personally, I do the business logic here and also (if necessary) invoke ...</li>\n<li>Model that handles all the data retrieval from DBMS, validation, etc. and returns processed data to Controller and ...</li>\n<li>The View is then displayed with the respective parameters (user data, template, validator result, etc.).</li>\n<li>User fills in the form and submits the input to Controller and ...</li>\n<li>GOTO 1. point</li>\n</ol>\n"}], "owner": {"reputation": 607, "user_id": 2704875, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/d01a9368d31ce231b4de371504c2f878?s=128&d=identicon&r=PG&f=1", "display_name": "freetoplay", "link": "https://stackoverflow.com/users/2704875/freetoplay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1372, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1429000247, "creation_date": 1428989416, "question_id": 29619787, "link": "https://stackoverflow.com/questions/29619787/where-should-my-sql-code-go-in-mvc", "title": "Where should my SQL code go in MVC", "body": "<p>I'm just starting to learn the MVC design pattern, and I was wondering where should my SQL code go.</p>\n\n<p>For example, lets say I have a register form structure that looks like this</p>\n\n<pre><code>type Form struct {\n Username string\n Password string\n}\n</code></pre>\n\n<p>I assume that the form structure is part of the model, so I have some function that goes with the form that after a user submits the form, the data gets put into the database, so my function would look something like this</p>\n\n<pre><code>func (f *Form) registerUser() {\n   // SQL code goes here\n}\n</code></pre>\n\n<p>Is this the best way of doing it? I have been searching around for open source Golang web apps that utilizes the MVC pattern, but I have not be able to find one which I completely understand. </p>\n"}, {"tags": ["sql", "postgresql", "go"], "comments": [{"owner": {"reputation": 257364, "user_id": 398670, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/85f50c23bb5e9dfb061af5032bfe8e65?s=128&d=identicon&r=PG", "display_name": "Craig Ringer", "link": "https://stackoverflow.com/users/398670/craig-ringer"}, "edited": false, "score": 2, "creation_date": 1428995065, "post_id": 29619422, "comment_id": 47386193, "body": "So the short version is &quot;can I do AND queries in PostgreSQL text-search query strings instead of the default OR search&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 8760, "user_id": 195727, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/06237052745686cba3fcb34d056d3cad?s=128&d=identicon&r=PG", "display_name": "Dzung Nguyen", "link": "https://stackoverflow.com/users/195727/dzung-nguyen"}, "edited": false, "score": 0, "creation_date": 1430300139, "post_id": 29912980, "comment_id": 48000429, "body": "thanks for pointing out. I have implemented with the similar idea :)"}, {"owner": {"reputation": 522, "user_id": 1391008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e03f3a6314e7ed2bd34b7200d48742d2?s=128&d=identicon&r=PG", "display_name": "Moch Lutfi", "link": "https://stackoverflow.com/users/1391008/moch-lutfi"}, "reply_to_user": {"reputation": 8760, "user_id": 195727, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/06237052745686cba3fcb34d056d3cad?s=128&d=identicon&r=PG", "display_name": "Dzung Nguyen", "link": "https://stackoverflow.com/users/195727/dzung-nguyen"}, "edited": false, "score": 0, "creation_date": 1430300714, "post_id": 29912980, "comment_id": 48000885, "body": "@nXqd Please mark as answered if this answer solve your problem."}, {"owner": {"reputation": 8760, "user_id": 195727, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/06237052745686cba3fcb34d056d3cad?s=128&d=identicon&r=PG", "display_name": "Dzung Nguyen", "link": "https://stackoverflow.com/users/195727/dzung-nguyen"}, "edited": false, "score": 0, "creation_date": 1430308859, "post_id": 29912980, "comment_id": 48006879, "body": "yes will do. But I will leave it for now, just in case someone have better idea :)"}], "tags": [], "owner": {"reputation": 522, "user_id": 1391008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e03f3a6314e7ed2bd34b7200d48742d2?s=128&d=identicon&r=PG", "display_name": "Moch Lutfi", "link": "https://stackoverflow.com/users/1391008/moch-lutfi"}, "is_accepted": false, "score": 2, "last_activity_date": 1430206101, "creation_date": 1430206101, "answer_id": 29912980, "question_id": 29619422, "link": "https://stackoverflow.com/questions/29619422/parameterize-sql-query-in-go/29912980#29912980", "title": "Parameterize sql query in go", "body": "<p>Here the tricky solution, hope this can help you. this query example using  syntax query for github.com/lib/pq</p>\n\n<pre><code>baseQuery := `\n        SELECT *\n        FROM\n            tableName\n        WHERE\n            (name ILIKE $1)`\n\nparams := []interface{}{\"%\" + nameLike + \"%\"}\n\n// you can add optional criteria using this way\nif condition==true {\n        baseQuery += fmt.Sprintf(` AND student_no=$%d`, len(params)+1)\n        params = append(params, studentNo)\n}\n\nfilterQuery := baseQuery + ` ORDER BY contract_no ASC`\n\nif totalLimit != 0 {\n    filterQuery += fmt.Sprintf(` LIMIT $%d OFFSET $%d`, len(params)+1, len(params)+2)\n    params = append(params, totalLimit, totalSkip)\n}\n\nrows, err := db.Query(filterQuery, params...)\n</code></pre>\n"}], "owner": {"reputation": 8760, "user_id": 195727, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/06237052745686cba3fcb34d056d3cad?s=128&d=identicon&r=PG", "display_name": "Dzung Nguyen", "link": "https://stackoverflow.com/users/195727/dzung-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 851, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1430206101, "creation_date": 1428987359, "question_id": 29619422, "link": "https://stackoverflow.com/questions/29619422/parameterize-sql-query-in-go", "title": "Parameterize sql query in go", "body": "<p>I have a simple query like the one below.</p>\n\n<pre><code>select json_agg(row_to_json(t)) from (select *                                                       \n               from jobs, companies, locations                                                                                                                                                                                                                                 \n               where jobs.company_id = companies.id and jobs.location_id = locations.id                                                                                                                                                                                        \n               $extra                                                                                                                                                                                                                                                          \n               and to_tsvector(jobs.name || ' ' || companies.name || ' ' || locations.name) @@ to_tsquery($1)                                                                                                                                                                  \n               and to_tsvector(locations.name) @@ to_tsquery($2)                                                                                                                                                                                                               \n               limit $3) t\n</code></pre>\n\n<p>But it has some problems regarding additional query. The <code>$1</code> and <code>$2</code> parameters is optional based on the query user requests. But still, at least in this case <code>to_tsquery</code> (postgresql) doesn't support any \"match all\" query like '*' so we must have the whole additional query <code>and to_tsvector(locations.name) @@ to_tsquery($2)</code> with proper parameter or not at all.</p>\n\n<p>This makes building query based on parameter tiresome work since we have to copy same query and add additional query all the time, and it's easily add up. I have a solution in mind to use <code>strings.Replace</code> to add up additional queries, but still we need to escape the parameter if needed. Is there any other solution can get this done in a clean way ?</p>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 781, "user_id": 2375505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/322780ece5ae3e7a2604592c45368c08?s=128&d=identicon&r=PG", "display_name": "rpkamp", "link": "https://stackoverflow.com/users/2375505/rpkamp"}, "edited": false, "score": 3, "creation_date": 1429006401, "post_id": 29618647, "comment_id": 47392752, "body": "of course in a production system you would actually capture the error from <code>json.Marshal</code> and do something with it :)"}, {"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "reply_to_user": {"reputation": 781, "user_id": 2375505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/322780ece5ae3e7a2604592c45368c08?s=128&d=identicon&r=PG", "display_name": "rpkamp", "link": "https://stackoverflow.com/users/2375505/rpkamp"}, "edited": false, "score": 0, "creation_date": 1429009339, "post_id": 29618647, "comment_id": 47394504, "body": "@ScallioXTX No, that&#39;s not needed here. <code>json.Marshal</code> never fails when passed a string slice."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 1, "creation_date": 1429023951, "post_id": 29618647, "comment_id": 47404452, "body": "@rightfold, so you know <i>exactly</i> what the current and <i>all future</i> implementations of JSON marshalling will do for all possible inputs (e.g. unicode, invalid UTF-8, out of memory/buffer, etc, etc)?? It&#39;s far easier and better habit to check the <code>error</code> return whenever it is provided. If you <i>think</i> it will never fail then maybe use panic (but in this case of course the <code>os.Exec</code> can fail so the surrounding function will need to return errors anyway). Suggesting that errors can be ignored is foolhardy."}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1429024808, "post_id": 29618647, "comment_id": 47405046, "body": "lol, this is a great comment thread &quot;checking errors vs not&quot; =P"}], "tags": [], "owner": {"reputation": 6945, "user_id": 2288944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/7qryD.jpg?s=128&g=1", "display_name": "armnotstrong", "link": "https://stackoverflow.com/users/2288944/armnotstrong"}, "is_accepted": false, "score": 1, "last_activity_date": 1429009271, "last_edit_date": 1429009271, "creation_date": 1428982021, "answer_id": 29618647, "question_id": 29618428, "link": "https://stackoverflow.com/questions/29618428/create-a-json-or-slice-array-in-go/29618647#29618647", "title": "Create a JSON or slice array in Go", "body": "<p>You can do that with package <code>encoding/json</code>:</p>\n\n<pre><code>outputSlice := strings.Split(unixCommandsstring,\"\\n\")\njs,_ := json.Marshal(outputSlice)\nfmt.Print(string(js))\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 4459142, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ooM1Ra_ttvI/AAAAAAAAAAI/AAAAAAAAAU4/GVUI94dk7fw/photo.jpg?sz=128", "display_name": "Tim", "link": "https://stackoverflow.com/users/4459142/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1429009271, "creation_date": 1428980394, "last_edit_date": 1428982361, "question_id": 29618428, "link": "https://stackoverflow.com/questions/29618428/create-a-json-or-slice-array-in-go", "title": "Create a JSON or slice array in Go", "body": "<p>I am not sure how to do this or word this. I have a variable that returns a string something like this:</p>\n\n<pre><code>unixCommands := exec.Command(\"ls\", \"/bin\")\nunixCommandsout, err := unixCommands.Output()\nunixCommandsstring := string(unixCommandsout)\nfmt.Printf(unixCommandsstring)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>unicode_start\nunicode_stop\nunlink\nusleep\nvi\nview\nypdomainname\nzcat\n</code></pre>\n\n<p>I'm looking for creating a JSON array or whatever is easiest to get to this final output:</p>\n\n<pre><code>[\"unicode_start\", \"unicode_stop\", \"unlink\", \"usleep\", \"vi\", \"view\", \"ypdomainname\", \"zcat\"]\n</code></pre>\n"}, {"tags": ["sockets", "go", "websocket", "socket.io"], "comments": [{"owner": {"reputation": 574451, "user_id": 816620, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/Xu7hp.jpg?s=128&g=1", "display_name": "jfriend00", "link": "https://stackoverflow.com/users/816620/jfriend00"}, "edited": false, "score": 0, "creation_date": 1428982013, "post_id": 29618018, "comment_id": 47381932, "body": "I wonder if you could run the new version on a different port so you&#39;d have both versions running, each on their own port.  New clients would use the new version on the new port."}, {"owner": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "edited": false, "score": 1, "creation_date": 1429018620, "post_id": 29618018, "comment_id": 47400482, "body": "To me, the cleanest solution would be to detect the version header in a middleware func, and then pass the r, w to the appropriate handler. You could use internal packages to contain the apiv1 and apiv2 logic, include those in your main goroutine, and have the endpoint logic there."}, {"owner": {"reputation": 592, "user_id": 1139431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/58ff635fdb01279fa3618204d76b46fc?s=128&d=identicon&r=PG", "display_name": "sheac", "link": "https://stackoverflow.com/users/1139431/sheac"}, "reply_to_user": {"reputation": 574451, "user_id": 816620, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/Xu7hp.jpg?s=128&g=1", "display_name": "jfriend00", "link": "https://stackoverflow.com/users/816620/jfriend00"}, "edited": false, "score": 0, "creation_date": 1429025729, "post_id": 29618018, "comment_id": 47405692, "body": "@jfriend00 That might be tricky, since websockets require dedicated ports as far as I know."}, {"owner": {"reputation": 592, "user_id": 1139431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/58ff635fdb01279fa3618204d76b46fc?s=128&d=identicon&r=PG", "display_name": "sheac", "link": "https://stackoverflow.com/users/1139431/sheac"}, "reply_to_user": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "edited": false, "score": 0, "creation_date": 1429025735, "post_id": 29618018, "comment_id": 47405696, "body": "@Momer I like your thinking. Thanks for putting it in terms of Go&#39;s net/http r/w for better understanding."}, {"owner": {"reputation": 574451, "user_id": 816620, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/Xu7hp.jpg?s=128&g=1", "display_name": "jfriend00", "link": "https://stackoverflow.com/users/816620/jfriend00"}, "edited": false, "score": 0, "creation_date": 1429049103, "post_id": 29618018, "comment_id": 47418635, "body": "webSockets can run on any port.  The normal implementation is that they share port 80 with http.  This works because a webSocket connection starts with an http request that is then &quot;upgraded&quot; to the webSocket protocol if both sides agree.  You could certainly have two versions of socket.io running and listening on different ports.  You&#39;d probably have to rename one of the modules (or load them from different locations) and perhaps do something with NPM so it doesn&#39;t get confused about versioning and upgrades.  But, once loaded I see no reason why this couldn&#39;t work."}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 2275704, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/KO249.jpg?s=128&g=1", "display_name": "Vijay Britto", "link": "https://stackoverflow.com/users/2275704/vijay-britto"}, "is_accepted": false, "score": 0, "last_activity_date": 1429037282, "creation_date": 1429037282, "answer_id": 29635128, "question_id": 29618018, "link": "https://stackoverflow.com/questions/29618018/letting-socket-io-client-version-lag-behind-server-version/29635128#29635128", "title": "Letting socket.io client version lag behind server version", "body": "<p>I don't really have an immediate solution for this, but I have some kind of   advice. I guess you could use it to save a lot of time.  </p>\n\n<ul>\n<li>first of all Im working in a startup which uses socketIo for almost<br>\neverything</li>\n<li>We knew that this problem would happen so our initial design was to<br>\nmake everything pluggable which means that we can swap out socketio for<br>\nsockjs and it will still work.</li>\n<li>The way its done is by defining the common set of APIs which rarely change<br>\nin a system. We call it <em>managers</em>. The managers can just expose the API   which the rest of the devs need to use without messing up anything. It speeds up a lot.  </li>\n<li>The manager implementation changes in the background but still the APIs   are the same, so the engineers working on the core can confidently make   changes.  </li>\n<li>Seems like you have a tight dependency in your code. Or may be not. I'm not so sure. Try following this principle if you haven't.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 574451, "user_id": 816620, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/Xu7hp.jpg?s=128&g=1", "display_name": "jfriend00", "link": "https://stackoverflow.com/users/816620/jfriend00"}, "is_accepted": false, "score": 2, "last_activity_date": 1429053505, "last_edit_date": 1429053505, "creation_date": 1429051630, "answer_id": 29638680, "question_id": 29618018, "link": "https://stackoverflow.com/questions/29618018/letting-socket-io-client-version-lag-behind-server-version/29638680#29638680", "title": "Letting socket.io client version lag behind server version", "body": "<p>It appears that you could run two separate versions of socket.io on the server.  Since the two versions don't have unique module filenames you would probably need to load one version from a different path.  And, then obviously when loading the modules and initializing them you'd assign them to differently named variables.  For example:</p>\n\n<pre><code>var io_old = require('old/socket.io');\nvar io = require('socket.io);\n</code></pre>\n\n<p>Once you have the two versions loaded on the server, I think there are two different approaches for how they could be run.</p>\n\n<p>1)  <strong>Use a different port for each version.</strong>  The older version would use the default port 80 (no configuration change required for that) which is shared with the node.js web server.  The newer version would be run on a different port (say port 3000).  You would then initialize each version of socket.io to its own port.  Your newer version clients would then connect to the the port the newer version was running on.</p>\n\n<p>For the old socket.io server running on port 80, you would use whatever initialization you already have which probably hooks into your existing http server.</p>\n\n<p>For the new socket.io server running on some other port, you would initialize it separately like this:</p>\n\n<pre><code>var io_old = require('old/socket.io')(server);\nvar io = require('socket.io')(3000);\n</code></pre>\n\n<p>Then, in the new version client, you would specify port 3000 when connecting.</p>\n\n<pre><code>var socket = io(\"http://yourdomain.com:3000\");\n</code></pre>\n\n<p>2)  <strong>Use a different HTTP request path for each version.</strong>  By default, each socket.io connection starts with an HTTP request that looks like this: <code>http://yourdomain.com/socket.io?EIO=xx&amp;transport=xxx?t=xxx</code>.  But, the <code>/socket.io</code> portion of that request is configurable and two separate versions of socket.io could each be using a different path name.  On the server, the <code>.listen()</code> method that starts socket.io listening takes an optional options object which can be configured with a custom path as in <code>path: \"/socket.io-v2\"</code>.  And similarly, the <code>.connect()</code> method in the client also accepts that options object.  It's kind of hard to find <a href=\"https://github.com/Automattic/engine.io\" rel=\"nofollow\">the documentation</a> for this option because it's actually an engine.io option (which socket.io uses), but socket.io passes the options through to engine.io.</p>\n\n<p>I have not tried either of these myself, but I've studied how socket.io connections are initiated from client and server and it looks like the underlying engine supports this capability and I can see no reason why it should not work.</p>\n\n<p>Here's how you'd change the path on the server:</p>\n\n<pre><code>var io = require('socket.io')(server, {path: \"/socket.io.v1\"});\n</code></pre>\n\n<p>Then, in the client code for the new version, you'd connect like this:</p>\n\n<pre><code>var socket = io({path: \"/socket.io.v1\"});\n</code></pre>\n\n<p>This would then result in the initial connection request being made to an HTTP URL like this:</p>\n\n<p><code>http://yourdomain.com/socket.io.v1?EIO=xx&amp;transport=xxx?t=xxx</code></p>\n\n<p>Which would be handled by a different request handler on your HTTP server, thus separating the two version.</p>\n\n<hr>\n\n<p>FYI, it is also possible that the <code>EIO=3</code> query parameter in the socket.io connection URL is actually an engine.io version number and that can also be used to discern client version and \"do the right thing\" based on that value.  I have not found any documentation on how that works and could not even find where that query parameter was looked at in the engine.io or socket.io source code so that would take more investigation as a another possibility.</p>\n"}, {"tags": [], "owner": {"reputation": 592, "user_id": 1139431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/58ff635fdb01279fa3618204d76b46fc?s=128&d=identicon&r=PG", "display_name": "sheac", "link": "https://stackoverflow.com/users/1139431/sheac"}, "is_accepted": true, "score": 0, "last_activity_date": 1429568212, "creation_date": 1429568212, "answer_id": 29759411, "question_id": 29618018, "link": "https://stackoverflow.com/questions/29618018/letting-socket-io-client-version-lag-behind-server-version/29759411#29759411", "title": "Letting socket.io client version lag behind server version", "body": "<p>We're going to go the route of keeping both the 0.9.x version and the current version as separate libraries on the server. Eventually, when the pool of clients has more-or-less all updated, we'll just pull the plug on the 0.9.x version.</p>\n\n<p>The way we'll manage the two versions is by wrapping the socket.io services in a package that will determine which wrapped socket.io version to pass the request off to. This determination will depend on features of the request, such as custom headers (that can be added to the newer clients) as well as query parameters and other headers utilized exclusively by one version or the other.</p>\n\n<p>Since we're using Go, there's so far no universally agreed upon way to manage dependencies, let alone a way that can respect version differences. Assuming the back-compat branch of the repo wasn't broken (which it is), we'd have two options. The first would be to fork the repo and make the back-compat version the master. We'd then import it as if it had nothing to do with the other one. The second option would be to use <a href=\"http://labix.org/gopkg.in\" rel=\"nofollow\">gopkg.in</a> to pretend the separate branches were separate repos.</p>\n\n<p>In either event, we could import the two branches/repos like so</p>\n\n<pre><code>import (\n    socketioV0 \"github.com/path/to/older/version\"\n    socketioV1 \"github.com/path/to/current/version\"\n)\n</code></pre>\n\n<p>And then refer to them in the code using their import names <code>socketioV0</code> and <code>socketioV1</code>.</p>\n"}], "owner": {"reputation": 592, "user_id": 1139431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/58ff635fdb01279fa3618204d76b46fc?s=128&d=identicon&r=PG", "display_name": "sheac", "link": "https://stackoverflow.com/users/1139431/sheac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 519, "favorite_count": 0, "accepted_answer_id": 29759411, "answer_count": 3, "score": 2, "last_activity_date": 1429568212, "creation_date": 1428977104, "question_id": 29618018, "link": "https://stackoverflow.com/questions/29618018/letting-socket-io-client-version-lag-behind-server-version", "title": "Letting socket.io client version lag behind server version", "body": "<h3>Situation</h3>\n\n<p>We're using socket.io for mobile-server communications. Since we can't force-upgrade users' devices, if we want to upgrade to version 1 (non-back-compatible), we have to handle both versions on the server for a while.</p>\n\n<h3>Question</h3>\n\n<p>What are the options?</p>\n\n<p>My current favourite is to wrap both the old version and the new version in a multiplexer. It detects the version of the incoming request based on headers and query parameters and thereby knows which functions to invoke.</p>\n\n<p>Another (shittier) option is to wrap the new version in a module that can translate the old version of the protocol into the new version (and back again) when necessary. This suffers from a serious drawback. It would be time-consuming and uncertain work to ensure I've properly determined and handled all the tiny differences. Some differences might take some serious massaging. </p>\n\n<p>(In case you're curious or it's helpful to know, we're doing this in Go.)</p>\n"}, {"tags": ["concurrency", "go", "synchronization", "worker"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1428965967, "post_id": 29616241, "comment_id": 47378025, "body": "Short version: you&#39;ve got the idea, but a <code>sync.WaitGroup</code> is an easier way to handle the bookkeeping you&#39;re doing with the <code>working</code> channel."}, {"owner": {"reputation": 2134, "user_id": 1527244, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/82b81a8c0375cf62e749e2b48fc553e6?s=128&d=identicon&r=PG", "display_name": "Danyel", "link": "https://stackoverflow.com/users/1527244/danyel"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1428966273, "post_id": 29616241, "comment_id": 47378106, "body": "Well, I actually thought to have read somewhere that adding to a waitgroup after main thread waits is a bad idea. Upon reading the docs, i think I misread..."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1428967110, "post_id": 29616241, "comment_id": 47378325, "body": "Roger that. Posted a <code>sync.WaitGroup</code> sample in an answer (and a link to code where I had to do this) for anyone that might stumble on this."}, {"owner": {"reputation": 2134, "user_id": 1527244, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/82b81a8c0375cf62e749e2b48fc553e6?s=128&d=identicon&r=PG", "display_name": "Danyel", "link": "https://stackoverflow.com/users/1527244/danyel"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1428970809, "post_id": 29616241, "comment_id": 47379202, "body": "The requirements are more specific: The total amount of workers may not exceed <code>WORKER_COUNT</code> (option would be to let <code>WORKER_COUNT - 1</code> workers work + main-routine.  Also, imagine every job is gone (no jobs left), and the very last job that is currently being processed yields another 100 jobs, would your solution work for that? Meaning: Would the <code>WORKER_COUNT</code> workers be working on the 100 jobs to come or would it be reduced to 1 worker for that job?"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1428970890, "post_id": 29616241, "comment_id": 47379220, "body": "Yes, new version handles all that, check below--it starts exactly four workers, and when one worker can&#39;t offload a subtask to another, it does it immediately (i.e., synchronously)."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1428971046, "post_id": 29616241, "comment_id": 47379254, "body": "(In particular, &quot;The nonblocking <code>select</code>...&quot; sentence may explain what I&#39;m on about--I edited to add it, and it may not have been there when you were looking before.)"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1428971309, "post_id": 29616241, "comment_id": 47379324, "body": "&quot;Would the WORKER_COUNT workers be working on the 100 jobs to come or would it be reduced to 1 worker for that job?&quot; You&#39;d have the full set of workers. <code>jobs</code> remains open (so workers keep listening) until the last job <i>finishes</i>. So if the last job enqueues 100 more before it finishes, they&#39;ll be distributed to all workers."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1428971952, "post_id": 29616241, "comment_id": 47379478, "body": "(If it helps follow what&#39;s happening, you can always hack up the sample code with a simulated task and/or println&#39;s.)"}], "answers": [{"comments": [{"owner": {"reputation": 2134, "user_id": 1527244, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/82b81a8c0375cf62e749e2b48fc553e6?s=128&d=identicon&r=PG", "display_name": "Danyel", "link": "https://stackoverflow.com/users/1527244/danyel"}, "edited": false, "score": 1, "creation_date": 1428973886, "post_id": 29616624, "comment_id": 47379955, "body": "Thanks! This is exactly what I was looking for. After pondering about your solution, I included it into mine. I was actually kind of &quot;lucky&quot; that the queue I was using was a wrapper I wrote myself so I could just integrate a WaitGroup in said queue. Any &quot;worker&quot; that pops stuff from the queue is responsible to call &quot;Done()&quot; and whenever sth gets added to the queue the queue increments wg by 1. This solution is so much better. Here is what my code looks like now. Many many thanks! <a href=\"https://gist.github.com/muja/073ac7e3eb9de5c00611\" rel=\"nofollow noreferrer\">gist.github.com/muja/073ac7e3eb9de5c00611</a>"}], "tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 2, "last_activity_date": 1572636324, "last_edit_date": 1572636324, "creation_date": 1428967067, "answer_id": 29616624, "question_id": 29616241, "link": "https://stackoverflow.com/questions/29616241/worker-pool-for-a-potentially-recursive-task-i-e-each-job-can-queue-other-job/29616624#29616624", "title": "Worker pool for a potentially recursive task (i.e., each job can queue other jobs)", "body": "<p>You can <a href=\"http://play.golang.org/p/yHOg7Fy5IM\" rel=\"nofollow noreferrer\">use a sync.WaitGroup</a> (see <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"nofollow noreferrer\">docs</a>) to control the lifetime of the workers, and use a non-blocking send so workers can't deadlock when they try to queue up more jobs:</p>\n\n<pre><code>package main\n\nimport \"sync\"\n\nconst workers = 4\n\ntype job struct{}\n\nfunc (j *job) do(enqueue func(job)) {\n    // do the job, calling enqueue() for subtasks as needed\n}\n\nfunc main() {\n    jobs, wg := make(chan job), new(sync.WaitGroup)\n    var enqueue func(job)\n\n    // workers\n    for i := 0; i &lt; workers; i++ {\n        go func() {\n            for j := range jobs {\n                j.do(enqueue)\n                wg.Done()\n            }\n        }()\n    }\n\n    // how to queue a job\n    enqueue = func(j job) {\n        wg.Add(1)\n        select {\n        case jobs &lt;- j: // another worker took it\n        default: // no free worker; do the job now\n            j.do(enqueue)\n            wg.Done()\n        }\n    }\n\n    todo := make([]job, 1000)\n    for _, j := range todo {\n        enqueue(j)\n    }\n    wg.Wait()\n    close(jobs)\n}\n</code></pre>\n\n<p>The difficulty with trying to avoid deadlocks with a buffered channel is that you have to allocate a big enough channel up front to definitely hold all pending tasks without blocking. Problematic unless, say, you have a small and known number of URLs to crawl.</p>\n\n<p>When you fall back to doing ordinary recursion in the current thread, you don't have that static buffer-size limit. Of course, there are still limits: you'd probably run out of RAM if too much work were pending, and theoretically you could exhaust the stack with deep recursion (but that's hard!). So you'd need to track pending tasks some more sophisticated way if you were, say, crawling the Web at large.</p>\n\n<p>Finally, as a more complete example, I'm not super proud of this code, but I happened to write a <a href=\"https://github.com/twotwotwo/radixsort.test/blob/master/parallel.go#L28\" rel=\"nofollow noreferrer\">function to kick off a parallel sort</a> that's recursive in the same way your URL fetching is.</p>\n"}], "owner": {"reputation": 2134, "user_id": 1527244, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/82b81a8c0375cf62e749e2b48fc553e6?s=128&d=identicon&r=PG", "display_name": "Danyel", "link": "https://stackoverflow.com/users/1527244/danyel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "accepted_answer_id": 29616624, "answer_count": 1, "score": 1, "last_activity_date": 1572636324, "creation_date": 1428964674, "last_edit_date": 1428975077, "question_id": 29616241, "link": "https://stackoverflow.com/questions/29616241/worker-pool-for-a-potentially-recursive-task-i-e-each-job-can-queue-other-job", "title": "Worker pool for a potentially recursive task (i.e., each job can queue other jobs)", "body": "<p>I'm writing an application that the user can start with a number of \"jobs\" (URLs actually). At the beginning (main routine), I add these URLs to a queue, then start x goroutines that work on these URLs.</p>\n\n<p>In special cases, the resource a URL points to may contain even more URLs which have to be added to the queue. The 3 workers are waiting for new jobs to come in and process them. The problem is: once EVERY worker is waiting for a job (and none is producing any), the workers should stop altogether. So either all of them work or no one works.</p>\n\n<p>My current implementation looks something like this and I don't think it's elegant. Unfortunately I couldn't think of a better way that wouldn't include race conditions and I'm not entirely sure if this implementation actually works as intended:</p>\n\n<pre><code>var queue // from somewhere\nconst WORKER_COUNT = 3\nvar done chan struct{}\n\nfunc work(working chan int) {\n  absent := make(chan struct{}, 1)\n  // if x&gt;1 jobs in sequence are popped, send to \"absent\" channel only 1 struct.\n  // This implementation also assumes that the select statement will be evaluated \"in-order\" (channel 2 only if channel 1 yields nothing) - is this actually correct? EDIT: It is, according to the specs.\n  one := false\n  for {\n    select {\n    case u, ok := &lt;-queue.Pop():\n      if !ok {\n        close(absent)\n        return\n      }\n      if !one {\n        // I have started working (delta + 1)\n        working &lt;- 1\n        absent &lt;- struct{}{}\n        one = true\n      }\n      // do work with u (which may lead to queue.Push(urls...))\n    case &lt;-absent: // no jobs at the moment. consume absent =&gt; wait\n      one = false\n      working &lt;- -1\n    }\n  }\n}\n\nfunc Start() {\n  working := make(chan int)\n  for i := 0; i &lt; WORKER_COUNT; i++ {\n    go work(working)\n  }\n  // the amount of actually working workers...\n  sum := 0\n  for {\n    delta := &lt;-working\n    sum += delta\n    if sum == 0 {\n      queue.Close() // close channel -&gt; kill workers.\n      done &lt;- struct{}{}\n      return\n    }\n  }\n}\n</code></pre>\n\n<p>Is there a better way to tackle this problem?</p>\n"}, {"tags": ["parsing", "command-line", "parameters", "go"], "answers": [{"tags": [], "owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "is_accepted": true, "score": 5, "last_activity_date": 1428959937, "creation_date": 1428959937, "answer_id": 29615295, "question_id": 29615232, "link": "https://stackoverflow.com/questions/29615232/passing-flag-variable-to-go-program-causing-strange-output/29615295#29615295", "title": "Passing flag variable to go program causing strange output", "body": "<p>It's a bash command line (or whatever the mac uses). <code>&amp;</code> and <code>?</code> are shell metacharacters that you MUST escape. The shell has absolutely no idea what a URL is, nor should it ever have to.</p>\n\n<pre><code>go 'http://....'\n   ^-----------^\n</code></pre>\n\n<p>Adding quotes will prevent the shell from parsing the metacharacters. The alternative is to manually escape each and ever metachar yourself:</p>\n\n<pre><code>go http://example.com/script.php\\?foo=bar\\&amp;baz=qux\n                                ^--------^\n</code></pre>\n\n<p>which quickly gets tedious, and error prone.</p>\n"}], "owner": {"reputation": 18900, "user_id": 1575153, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/aec7ad434476dfbfff719f7191c916c9?s=128&d=identicon&r=PG&f=1", "display_name": "sergserg", "link": "https://stackoverflow.com/users/1575153/sergserg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 29615295, "answer_count": 1, "score": -1, "last_activity_date": 1428959937, "creation_date": 1428959660, "question_id": 29615232, "link": "https://stackoverflow.com/questions/29615232/passing-flag-variable-to-go-program-causing-strange-output", "title": "Passing flag variable to go program causing strange output", "body": "<pre><code>sergiotapia at Macbook-Air in ~/Work/go/src/github.com/sergiotapia/gophers on master [!]\n$ go build &amp;&amp; go install &amp;&amp; gophers -github_url=https://github.com/search?utf8=%E2%9C%93&amp;q=location%3A%22San+Fransisco%22+location%3ACA+followers%3A%3E100&amp;type=Users&amp;ref=advsearch&amp;l=\n[1] 51873\n[2] 51874\n[3] 51875\n[4] 51877\n[2]   Done                    q=location%3A%22San+Fransisco%22+location%3ACA+followers%3A%3E100\n[3]   Done                    type=Users\n[4]+  Done                    ref=advsearch\n</code></pre>\n\n<hr>\n\n<p>I'm trying to use the long github url as a parameter in my code for <a href=\"https://github.com/sergiotapia/gophers\" rel=\"nofollow\">Gophers</a>. It works fine for all other url types such as organisations or stargazers. However when I try to use the search results page I get the strange output above.</p>\n\n<p><a href=\"https://github.com/search?utf8=%E2%9C%93&amp;q=location%3A%22San+Fransisco%22+location%3ACA+followers%3A%3E100&amp;type=Users&amp;ref=advsearch&amp;l=\" rel=\"nofollow\">https://github.com/search?utf8=%E2%9C%93&amp;q=location%3A%22San+Fransisco%22+location%3ACA+followers%3A%3E100&amp;type=Users&amp;ref=advsearch&amp;l=</a></p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"log\"\n    \"strings\"\n\n    \"github.com/PuerkitoBio/goquery\"\n)\n\ntype user struct {\n    name     string\n    email    string\n    url      string\n    username string\n}\n\nfunc main() {\n    url := flag.String(\"github_url\", \"\", \"github url you want to scrape\")\n    flag.Parse()\n    githubURL := *url\n    doc, err := goquery.NewDocument(githubURL)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    if strings.Contains(githubURL, \"/orgs/\") {\n        scrapeOrganization(doc, githubURL)\n    } else if strings.Contains(githubURL, \"/search?\") {\n        scrapeSearch(doc, githubURL)\n    } else if strings.Contains(githubURL, \"/stargazers\") {\n        scrapeStarGazers(doc, githubURL)\n    } else {\n        scrapeProfile(doc)\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "go-html-template"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1428960236, "post_id": 29615224, "comment_id": 47375957, "body": "Might consider adding some other tags. Your question is specific to the templating solution you&#39;re using. I know Go well but know nothing about this subject."}, {"owner": {"reputation": 197, "user_id": 1295863, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7d891db1c3cffd1c11b393d6d6816f97?s=128&d=identicon&r=PG", "display_name": "THUNDERGROOVE", "link": "https://stackoverflow.com/users/1295863/thundergroove"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1428960601, "post_id": 29615224, "comment_id": 47376122, "body": "I&#39;m using the built-in html/template package.  I couldn&#39;t exactly find an established tag related to it so I didn&#39;t bother e: Found one"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1428960857, "post_id": 29615224, "comment_id": 47376245, "body": "Yeah, I found the package easily enough. Thanks for editing, it will be helpful in the future. Go is lacking in SO adoption but also the questions are pretty much all in the general &#39;go&#39; bucket where as in say .NET there are tags for all the common libraries."}, {"owner": {"reputation": 197, "user_id": 1295863, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7d891db1c3cffd1c11b393d6d6816f97?s=128&d=identicon&r=PG", "display_name": "THUNDERGROOVE", "link": "https://stackoverflow.com/users/1295863/thundergroove"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1428960996, "post_id": 29615224, "comment_id": 47376304, "body": "Yeah that&#39;s much in part with how much Golang manages to pack into their standard libraries.  If I can&#39;t find anything I may just have to add a *db.User field into my posts and just fill it before rendering the page.  Not very elegant but it would work."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1428963488, "post_id": 29615224, "comment_id": 47377319, "body": "How are you passing the values to the template? Via a map? Can you post that code too? e.g. <code>template.Execute(...)</code>"}, {"owner": {"reputation": 197, "user_id": 1295863, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7d891db1c3cffd1c11b393d6d6816f97?s=128&d=identicon&r=PG", "display_name": "THUNDERGROOVE", "link": "https://stackoverflow.com/users/1295863/thundergroove"}, "edited": false, "score": 0, "creation_date": 1428965032, "post_id": 29615224, "comment_id": 47377768, "body": "For now, I&#39;m just adding the db.User pointer to each post before rendering the template.  It&#39;s not pretty but it works for now.  If anyone can still figure out the question I would love it."}], "answers": [{"tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": true, "score": 3, "last_activity_date": 1429106781, "last_edit_date": 1495541276, "creation_date": 1429106781, "answer_id": 29652483, "question_id": 29615224, "link": "https://stackoverflow.com/questions/29615224/golang-template-global-dot-within-a-template-thats-given-a-value-from-range/29652483#29652483", "title": "Golang template global dot within a template that&#39;s given a value from range", "body": "<p>Invoking a template creates a new scope:</p>\n\n<blockquote>\n  <p>A template invocation does not inherit variables from the point of its invocation.</p>\n</blockquote>\n\n<p>So you have three options: </p>\n\n<ol>\n<li>Add a reference to the parent in the post (as you said you're doing in your last comment)</li>\n<li><p>Create a function (<code>isAdmin</code>) that references the variable through closure:</p>\n\n<pre><code>template.New(\"test\").Funcs(map[string]interface{}{\n    \"isAdmin\": func() bool {\n        return true // you can get it here\n    },\n}).Parse(src)\n</code></pre>\n\n<p>The downside of this approach is you have to parse the template every time.</p></li>\n<li><p>Create a new function which can construct a post that has a reference to the parent without having to modify the original data. For example:</p>\n\n<pre><code>template.New(\"test\").Funcs(map[string]interface{}{\n    \"pair\": func(x, y interface{}) interface{} {\n        return struct { First, Second interface{} } { x, y }\n    },\n}).Parse(src)\n</code></pre>\n\n<p>And you could use it like this:</p>\n\n<pre><code>{{range .Posts }}\n    {{template \"post\" pair $ . }}\n{{end}}\n</code></pre>\n\n<p>Another option is to make a <code>dict</code> function: <a href=\"https://stackoverflow.com/questions/18276173/calling-a-template-with-several-pipeline-parameters/18276968#18276968\">Calling a template with several pipeline parameters</a></p></li>\n</ol>\n"}], "owner": {"reputation": 197, "user_id": 1295863, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7d891db1c3cffd1c11b393d6d6816f97?s=128&d=identicon&r=PG", "display_name": "THUNDERGROOVE", "link": "https://stackoverflow.com/users/1295863/thundergroove"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4106, "favorite_count": 0, "accepted_answer_id": 29652483, "answer_count": 1, "score": 3, "last_activity_date": 1429106781, "creation_date": 1428959642, "last_edit_date": 1428964172, "question_id": 29615224, "link": "https://stackoverflow.com/questions/29615224/golang-template-global-dot-within-a-template-thats-given-a-value-from-range", "title": "Golang template global dot within a template that&#39;s given a value from range", "body": "<p>My setup:</p>\n\n<p>base.tmpl</p>\n\n<pre><code>{{define \"base\"}} ...basic hmtl boilerplate ...{{end}}\n{{define \"post\"}}\n    {{.ID}} {{.Username}} etc... \n    {{if $.User.Admin}}\n        &lt;...admin controls...&gt;\n    {{end}}\n{{end}}\n</code></pre>\n\n<p>index.tmpl</p>\n\n<pre><code>{{template \"base\" . }}\n{{define \"content\"}}\n    Stuff......\n    {{range .Posts }}\n        {{template \"post\" . }}\n    {{end}}\n{{end}}\n</code></pre>\n\n<p>But I get </p>\n\n<blockquote>\n  <p>$.User.Admin is not a field of db.Post</p>\n</blockquote>\n\n<p>How can I get the values from the \"global\" dot value within a template that isn't given it?  $. clearly doesn't work.</p>\n\n<p>I was just having the post within the range, but I added a new page to view individual posts and would like to not update each area that posts are displayed individually.</p>\n\n<p>Update:  Templates are executed like so</p>\n\n<pre><code>func Index(rw http.ResponseWriter, req *http.Request) {\n    g := GetGlobal(rw, req) // Gets logged in user info, adds branch/version info etc\n    ... Get posts from the DB ...\n    if err := Templates[\"index.tmpl\"].Execute(rw, g); err != nil {\n        Log.Println(\"Error executing template\", err.Error())\n    }\n}\n</code></pre>\n\n<p>The Global struct looks like:</p>\n\n<pre><code>type Global struct {\n    User     db.User\n    Users    []db.User\n    EditUser db.User\n    Session  *sessions.Session\n    Error    error\n    Posts    []db.Post\n    Post     db.Post\n\n    DoRecaptcha bool\n    Host        string\n    Version     string\n    Branch      string\n}\n</code></pre>\n\n<p>Templates are loaded like so:</p>\n\n<pre><code>Templates[filename] = template.Must(template.ParseFiles(\"templates/\"+filename, \"templates/base.tmpl\"))\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2384, "user_id": 102315, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c8b935f2e5d916f361ffe33fe94a3d10?s=128&d=identicon&r=PG", "display_name": "Alper", "link": "https://stackoverflow.com/users/102315/alper"}, "edited": false, "score": 0, "creation_date": 1542405759, "post_id": 29615222, "comment_id": 93570874, "body": "That is an incredibly lame exercise then. No hint that you would need to import a never before seen library <code>strconv</code>."}], "tags": [], "owner": {"reputation": 5808, "user_id": 659590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gacpu.jpg?s=128&g=1", "display_name": "Zikes", "link": "https://stackoverflow.com/users/659590/zikes"}, "is_accepted": true, "score": 6, "last_activity_date": 1428959619, "creation_date": 1428959619, "answer_id": 29615222, "question_id": 29614943, "link": "https://stackoverflow.com/questions/29614943/stringer-implementation-without-using-sprintf/29615222#29615222", "title": "Stringer implementation without using Sprintf", "body": "<p>What's happening there is that you're passing the byte e.g. 127 directly into string and expecting it to represent that byte as the integer 127 before converting it into a string.  Instead what it's doing is interpreting it as a character with the byte value 127.</p>\n\n<p>Instead you should convert that byte value into an integer, then use the <code>strconv</code> library to format it as a string.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n)\n\ntype IPAddr [4]byte\n\nfunc (addr IPAddr) String() string {\n    return strconv.Itoa(int(addr[0])) + \".\" + strconv.Itoa(int(addr[1])) + \".\" + strconv.Itoa(int(addr[2])) + \".\" + strconv.Itoa(int(addr[3]))\n}\n\nfunc main() {\n    addrs := map[string]IPAddr{\n        \"loopback\":  {127, 0, 0, 1},\n        \"googleDNS\": {8, 8, 8, 8},\n    }\n    for n, a := range addrs {\n        fmt.Printf(\"%v: %v\\n\", n, a)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>loopback: 127.0.0.1\ngoogleDNS: 8.8.8.8\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6313, "user_id": 328115, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9a029d2d948f128443f996fa12b3d3a1?s=128&d=identicon&r=PG", "display_name": "dolmen", "link": "https://stackoverflow.com/users/328115/dolmen"}, "is_accepted": false, "score": 0, "last_activity_date": 1492008373, "creation_date": 1492008373, "answer_id": 43372866, "question_id": 29614943, "link": "https://stackoverflow.com/questions/29614943/stringer-implementation-without-using-sprintf/43372866#43372866", "title": "Stringer implementation without using Sprintf", "body": "<p>A more efficient implementation with less temporary memory allocations:</p>\n\n<pre><code>func (addr IPAddr) String() string {\n    buf := make([]byte, 0, 3+1+3+1+3+1+3)\n    return string(\n        strconv.AppendInt(\n            append(\n                strconv.AppendInt(\n                    append(\n                        strconv.AppendInt(\n                            append(\n                                strconv.AppendInt(buf,\n                                    int64(addr[0]), 10), '.'),\n                            int64(addr[1]), 10), '.'),\n                    int64(addr[2]), 10), '.'),\n            int64(addr[3]), 10))\n}\n</code></pre>\n"}], "owner": {"reputation": 10797, "user_id": 269106, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/vQlAg.jpg?s=128&g=1", "display_name": "AlexBrand", "link": "https://stackoverflow.com/users/269106/alexbrand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 29615222, "answer_count": 2, "score": 1, "last_activity_date": 1492008373, "creation_date": 1428958542, "question_id": 29614943, "link": "https://stackoverflow.com/questions/29614943/stringer-implementation-without-using-sprintf", "title": "Stringer implementation without using Sprintf", "body": "<p>I am working through the golang tour and I am stuck in one of the exercises. I am not sure why the following does not work for a String() function:</p>\n\n<pre><code>type IPAddr [4]byte\n\nfunc (addr IPAddr) String() string {\n    return string(addr[0]) + \".\" + string(addr[1]) + \".\" + string(addr[2]) + \".\" + string(addr[3])\n}\n\nfunc main() {\n    addrs := map[string]IPAddr{\n        \"loopback\":  {127, 0, 0, 1},\n        \"googleDNS\": {8, 8, 8, 8},\n    }\n    for n, a := range addrs {\n        fmt.Printf(\"%v: %v\\n\", n, a)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>loopback: ...\ngoogleDNS: ...\n</code></pre>\n\n<p>Granted that using <code>fmt.Sprintf()</code> would be a nicer solution, but I'm not sure I understand why that function doesn't work.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 0, "creation_date": 1428953500, "post_id": 29613004, "comment_id": 47372516, "body": "Why do you need to use multiple error statement in a for range loop? Normally an error is an unique event and need be handled accordingly. If you wish to access as an array value then you need to check for different condition like <code>switch</code> or <code>if</code> statement."}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1428989289, "post_id": 29613004, "comment_id": 47383759, "body": "Did you look at the language reference before asking the question? You&#39;re getting down-voted because your question is not demonstrating that you&#39;ve made any research effort."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1428953074, "creation_date": 1428953074, "answer_id": 29613422, "question_id": 29613004, "link": "https://stackoverflow.com/questions/29613004/use-multiple-expression-in-for-loop/29613422#29613422", "title": "Use multiple expression in for loop", "body": "<p>Per the <a href=\"http://golang.org/ref/spec#For_statements\" rel=\"nofollow\">documentation</a>:</p>\n\n<pre><code>ForStmt = \"for\" [ Condition | ForClause | RangeClause ] Block .\nCondition = Expression .\n</code></pre>\n\n<p>You can either have a Condition, <em>or</em> a ForClause, <em>or</em> a RangeClause. You cannot combine them.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 29613422, "answer_count": 1, "score": -2, "last_activity_date": 1428953074, "creation_date": 1428951619, "question_id": 29613004, "link": "https://stackoverflow.com/questions/29613004/use-multiple-expression-in-for-loop", "title": "Use multiple expression in for loop", "body": "<p>It is possible to use multiple expression in go loop like:</p>\n\n<pre><code>for _, err := range errs; err != nil  {\n\n    }\n</code></pre>\n\n<p>Or I have to do like:</p>\n\n<pre><code>for _, err := range errs {\n        if err != nil {\n         statement\n        }\n    }\n</code></pre>\n"}, {"tags": ["javascript", "ajax", "google-app-engine", "file-upload", "go"], "comments": [{"owner": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "edited": false, "score": 0, "creation_date": 1428946698, "post_id": 29609086, "comment_id": 47368617, "body": "Have you considered setting the <code>Content-Type</code> on the XHR request a la <a href=\"https://code.google.com/p/go-socketio/source/browse/socket.io-client/lib/transports/xhr.js?r=b1f66e4a7d434854d9051cac4009c57c72ff89bd#159\" rel=\"nofollow noreferrer\">code.google.com/p/go-socketio/source/browse/socket.io-client&zwnj;&#8203;/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": false, "score": -1, "last_activity_date": 1429193307, "creation_date": 1429193307, "answer_id": 29677252, "question_id": 29609086, "link": "https://stackoverflow.com/questions/29609086/go-gae-file-upload-to-blobstore-using-ajax/29677252#29677252", "title": "Go GAE file upload to blobstore using AJAX", "body": "<p>Blobstore is deprecated: <a href=\"https://cloud.google.com/appengine/docs/go/blobstore/reference\" rel=\"nofollow\">https://cloud.google.com/appengine/docs/go/blobstore/reference</a>. Here's how you can upload files to GCS:</p>\n\n<pre><code>import (\n    // these are the appengine imports\n    \"golang.org/x/oauth2\"\n    \"golang.org/x/oauth2/google\"\n    \"google.golang.org/appengine\"\n    \"google.golang.org/appengine/datastore\"\n    \"google.golang.org/appengine/file\"\n    \"google.golang.org/appengine/urlfetch\"\n    \"google.golang.org/cloud\"\n    \"google.golang.org/cloud/storage\"\n)\n\nfunc serveFilesUpload(res http.ResponseWriter, req *http.Request) {\n    ctx := appengine.NewContext(req)\n\n    // every app engine app comes with a default bucket\n    bucket, err := file.DefaultBucketName(ctx)\n    if err != nil {\n        panic(err)\n    }\n\n    // we can't use the regular http client because we need\n    // oauth headers added, and also need to use urlfetch\n    // for app engine\n    hc := &amp;http.Client{\n        Transport: &amp;oauth2.Transport{\n            Source: google.AppEngineTokenSource(ctx, storage.ScopeFullControl),\n            Base:   &amp;urlfetch.Transport{Context: ctx},\n        },\n    }\n\n    // I'm just giving files random names\n    id := uuid.NewRandom().String()\n\n    // this get's the file out of the multipart form\n    ff, _, err := req.FormFile(\"file\")\n    if err != nil {\n        panic(err)\n    }\n    defer ff.Close()\n\n    cctx := cloud.NewContext(appengine.AppID(ctx), hc)\n    wc := storage.NewWriter(cctx, bucket, id)\n    io.Copy(wc, ff)\n    // normally you'd just defer the .Close, but in this case\n    // we care about the error it returns\n    err = wc.Close()\n    if err != nil {\n        panic(err)\n    }\n\n    json.NewEncoder(res).Encode(id)\n}\n</code></pre>\n\n<p>A complete example is available here: <a href=\"https://github.com/calebdoxsey/tutorials/tree/master/appengine/cms\" rel=\"nofollow\">https://github.com/calebdoxsey/tutorials/tree/master/appengine/cms</a>.</p>\n"}], "owner": {"reputation": 187, "user_id": 3995228, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3704db62cc1e1967db3ef022eea118f2?s=128&d=identicon&r=PG&f=1", "display_name": "\u017diga Pata\u010dko Koderman", "link": "https://stackoverflow.com/users/3995228/%c5%bdiga-pata%c4%8dko-koderman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 359, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429193307, "creation_date": 1428938533, "question_id": 29609086, "link": "https://stackoverflow.com/questions/29609086/go-gae-file-upload-to-blobstore-using-ajax", "title": "Go GAE file upload to blobstore using AJAX", "body": "<p>I am currently working on a project written in Go for Google App Engine. I have problem with uploading file/image to blobstore without having to reload the site.</p>\n\n<p>So this is the html form:</p>\n\n<pre><code>&lt;form id=\"file-form\" action=\"{{.UploadUrl}}\" method=\"POST\" enctype=\"multipart/form-data\"&gt;\n    &lt;fieldset style=\"width: 100%;\" data-uk-margin&gt;\n        &lt;div class=\"uk-form-row\"&gt;\n            &lt;div id=\"fields\"&gt;&lt;/div&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"uk-form-row\" style=\"padding-top: 5px; padding-bottom: 5px;\"&gt;\n            &lt;textarea id=\"textArea\" cols=\"\" rows=\"10\" name=\"description\" placeholder=\"Description\"&gt;&lt;/textarea&gt;\n        &lt;/div&gt;                      \n        &lt;div class=\"uk-form-row\" style=\"padding-top: 5px; padding-bottom: 5px;\"&gt;\n            &lt;p&gt;Upload File: &lt;/p&gt; &lt;input id=\"file-select\" type=\"file\" name=\"file-select\" accept=\"image/png\"&gt;\n        &lt;/div&gt;                              \n        &lt;div class=\"uk-form-row\" style=\"opacity: 1.0;\"&gt;\n            &lt;div class=\"uk-flex uk-flex-center\" id=\"buttonDiv\"&gt;\n               &lt;button type=\"submit\" id=\"submitButton\" class=\"uk-button uk-button-primary\"&gt;Upload&lt;/button&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/fieldset&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>And javascript code to upload the image:</p>\n\n<pre><code>var form = document.getElementById(\"file-form\");\n            var fileSelect = document.getElementById(\"file-select\");\n            var uploadButton = document.getElementById(\"submitButton\");\n            var description = document.getElementById(\"textArea\");\n\n            form.onsubmit = function(event) {\n                event.preventDefault();\n\n                uploadButton.innerHTML = \"Uploading...\";\n\n                if (fileSelect.files.length == 0) {\n                    alert(\"No images selected\");\n                    uploadButton.innerHTML = \"Upload\";\n                    return;\n                }\n\n                var file = fileSelect.files[0];\n                console.log(file.name);\n                var formData = new FormData();\n                formData.append(\"file\", file);\n                formData.append(\"description\", description.value);\n\n                var xhr = new XMLHttpRequest();\n                xhr.open('POST', \"/api/files/fileUpload\", true);\n\n                xhr.onload = function() {\n                    if (xhr.status === 200) {\n                        uploadButton.innerHTML = \"Upload\"\n                    } else {\n                        alert(\"An error occurred!\");\n                    }\n                }\n                xhr.send(formData);\n            }\n</code></pre>\n\n<p>Go method to receive file:</p>\n\n<pre><code>c := appengine.NewContext(r)\n    u := user.Current(c)\n\n    if u == nil {\n        url, err := user.LoginURL(c, r.URL.String())\n        if err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n            return\n        }\n        w.Header().Set(\"Location\", url)\n        w.WriteHeader(http.StatusFound)\n        return\n    }\n\n    logoutUrl, e := user.LogoutURL(c, \"/redirect\")\n    if e != nil {\n        panic(e)\n    }\n    email := u.Email\n\n    uploadURL, error := blobstore.UploadURL(c, \"/api/files/fileUpload\", nil)\n    if error != nil {\n        panic(error)\n    }\n\n    data := WebpageData{LogoutUrl: logoutUrl, UserName: email, UploadUrl: uploadURL}\n\n    template := template.Must(template.New(\"template\").Parse(fileValue(\"./console/page/newForm.html\")))\n\n    err := template.Execute(w, data)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n    }\n</code></pre>\n\n<p>And finally the errors that bother me:\n1. from js console in browser:</p>\n\n<pre><code>Failed to load resource: the server responded with a status of 500 (Internal Server Error)\n</code></pre>\n\n<ol start=\"2\">\n<li><p>from go console/log:</p>\n\n<p>2015/04/13 15:10:15 http: panic serving 127.0.0.1:49543: mime: no media type\ngoroutine 16 [running]:\nnet/http.func\u00b7011()\n    /private/var/folders/00/0v42r000h01000cxqpysvccm003chb/T/appengine/go_appengine/goroot/src/net/http/server.go:1130 +0xbb\napi.check(0xb0db00, 0xc20800a970)\n    api/api.go:40 +0x50\napi.fileUploadHandler(0xb136e0, 0xc208045540, 0xc2080f1d40)\n    api/files.go:19 +0x8a\nnet/http.HandlerFunc.ServeHTTP(0x5a2088, 0xb136e0, 0xc208045540, 0xc2080f1d40)\n    /private/var/folders/00/0v42r000h01000cxqpysvccm003chb/T/appengine/go_appengine/goroot/src/net/http/server.go:1265 +0x41\nnet/http.(*ServeMux).ServeHTTP(0xc20803a690, 0xb136e0, 0xc208045540, 0xc2080f1d40)\n    /private/var/folders/00/0v42r000h01000cxqpysvccm003chb/T/appengine/go_appengine/goroot/src/net/http/server.go:1541 +0x17d\nappengine_internal.handleFilteredHTTP(0xb136e0, 0xc208045540, 0xc2080f1d40)\n    /private/var/folders/00/0v42r000h01000cxqpysvccm003chb/T/appengine/go_appengine/goroot/src/appengine_internal/api_dev.go:98 +0x413\nnet/http.HandlerFunc.ServeHTTP(0x5a20f8, 0xb136e0, 0xc208045540, 0xc2080f1d40)\n    /private/var/folders/00/0v42r000h01000cxqpysvccm003chb/T/appengine/go_appengine/goroot/src/net/http/server.go:1265 +0x41\nnet/http.serverHandler.ServeHTTP(0xc208042120, 0xb136e0, 0xc208045540, 0xc2080f1d40)\n    /private/var/folders/00/0v42r000h01000cxqpysvccm003chb/T/appengine/go_appengine/goroot/src/net/http/server.go:1703 +0x19a\nnet/http.(*conn).serve(0xc2080454a0)\n    /private/var/folders/00/0v42r000h01000cxqpysvccm003chb/T/appengine/go_appengine/goroot/src/net/http/server.go:1204 +0xb57\ncreated by net/http.(*Server).Serve\n    /private/var/folders/00/0v42r000h01000cxqpysvccm003chb/T/appengine/go_appengine/goroot/src/net/http/server.go:1751 +0x35e</p></li>\n</ol>\n\n<p>Any ideas how to tackle this problem. \nThanks in advance :)</p>\n"}, {"tags": ["mongodb", "http", "session", "go", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 828, "user_id": 2373256, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/62e4cda3985703bb89fc3d9aefad5b3c?s=128&d=identicon&r=PG", "display_name": "pikanezi", "link": "https://stackoverflow.com/users/2373256/pikanezi"}, "is_accepted": true, "score": 1, "last_activity_date": 1430690931, "last_edit_date": 1430690931, "creation_date": 1428937580, "answer_id": 29608724, "question_id": 29607533, "link": "https://stackoverflow.com/questions/29607533/mgo-connection-leak-after-multiple-session-copy/29608724#29608724", "title": "mgo connection leak after multiple session.Copy()", "body": "<p>I'm kind of upset and relieved at the same time, but I found my answer right after I posted my question...</p>\n\n<p>After checking on the mgo sessions, I can see that Dial set, by default a maxPoolSize of 4096... After trying to reduce the pool size it solved my problem.</p>\n"}], "owner": {"reputation": 828, "user_id": 2373256, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/62e4cda3985703bb89fc3d9aefad5b3c?s=128&d=identicon&r=PG", "display_name": "pikanezi", "link": "https://stackoverflow.com/users/2373256/pikanezi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 595, "favorite_count": 0, "accepted_answer_id": 29608724, "answer_count": 1, "score": 1, "last_activity_date": 1430690931, "creation_date": 1428934437, "question_id": 29607533, "link": "https://stackoverflow.com/questions/29607533/mgo-connection-leak-after-multiple-session-copy", "title": "mgo connection leak after multiple session.Copy()", "body": "<p>I'm writing a REST API in Go using MongoDB as a database and mgo as a driver.\nFor the router, I'm using a custome one: <a href=\"https://github.com/gocarina/pi\" rel=\"nofollow\">pi</a>.</p>\n\n<p>At the program start up, I create a master mgo.Session and then, for each request handled, I copy the master session and closes it when I'm done.</p>\n\n<p>But, when multiple requests are handled concurrently, I observe that MongoDB connection are still open even though I closed every mgo.Session copied.</p>\n\n<p>Here is a sample of the output of <a href=\"http://en.wikipedia.org/wiki/Lsof\" rel=\"nofollow\">lsof</a> command:</p>\n\n<pre><code>milano-ru 18790 neel_v  118u  IPv4 34115804      0t0     TCP localhost:44238-&gt;localhost:27017 (ESTABLISHED)\nmilano-ru 18790 neel_v  119u  IPv4 34115812      0t0     TCP localhost:44241-&gt;localhost:27017 (ESTABLISHED)\nmilano-ru 18790 neel_v  120u  IPv4 34115813      0t0     TCP localhost:44242-&gt;localhost:27017 (ESTABLISHED)\nmilano-ru 18790 neel_v  121u  IPv4 34115814      0t0     TCP localhost:44243-&gt;localhost:27017 (ESTABLISHED)\nmilano-ru 18790 neel_v  122u  IPv4 34115815      0t0     TCP localhost:44244-&gt;localhost:27017 (ESTABLISHED)\n</code></pre>\n\n<p>So, after a couple of hours my application is running, it stops working since it cannot opens another MongoDB connection because a limit is reached (1024).</p>\n\n<p>I've read about increasing <a href=\"http://docs.mongodb.org/manual/reference/ulimit/\" rel=\"nofollow\">ulimit</a> of MongoDB, but is it really a solution?</p>\n"}, {"tags": ["go", "cgo"], "answers": [{"comments": [{"owner": {"reputation": 4181, "user_id": 3337677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2a3cb5dc363dbc123686e074c4c3181e?s=128&d=identicon&r=PG&f=1", "display_name": "packetie", "link": "https://stackoverflow.com/users/3337677/packetie"}, "edited": false, "score": 0, "creation_date": 1428932898, "post_id": 29606465, "comment_id": 47359471, "body": "Thanks for the quick reply. When I ran it, got error <code>.&#47;main.go:33: undefined reference to `testc&#39;</code>"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 4181, "user_id": 3337677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2a3cb5dc363dbc123686e074c4c3181e?s=128&d=identicon&r=PG&f=1", "display_name": "packetie", "link": "https://stackoverflow.com/users/3337677/packetie"}, "edited": false, "score": 0, "creation_date": 1428933738, "post_id": 29606465, "comment_id": 47360032, "body": "@codingFun how did you run it? I ran it with <code>go build -o dummy &amp;&amp; .&#47;dummy</code>"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 4181, "user_id": 3337677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2a3cb5dc363dbc123686e074c4c3181e?s=128&d=identicon&r=PG&f=1", "display_name": "packetie", "link": "https://stackoverflow.com/users/3337677/packetie"}, "edited": false, "score": 0, "creation_date": 1428933897, "post_id": 29606465, "comment_id": 47360136, "body": "<code>go build</code> invokes <code>cgo</code> behind the scenes, generating wrapper files etc etc. you can run cgo directly on the code to see what it does."}, {"owner": {"reputation": 4181, "user_id": 3337677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2a3cb5dc363dbc123686e074c4c3181e?s=128&d=identicon&r=PG&f=1", "display_name": "packetie", "link": "https://stackoverflow.com/users/3337677/packetie"}, "edited": false, "score": 1, "creation_date": 1428938990, "post_id": 29606465, "comment_id": 47364023, "body": "Thanks @Not_a_Golfer, I ran it as &quot;go run main.go&quot; and got the error with loader/ld.   Ran it your way (using go build..), it works great.  Thanks again. I have accepted your answer and upvoted it!"}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 1, "last_activity_date": 1428931510, "creation_date": 1428931510, "answer_id": 29606465, "question_id": 29606241, "link": "https://stackoverflow.com/questions/29606241/error-on-calling-go-function-from-c/29606465#29606465", "title": "error on calling go function from c", "body": "<p>You don't need to declare <code>dummy</code> in your C file. Here's how I split your code to make it work. I put the C function exporting in an <code>.h</code> file, and the body itself in a <code>.c</code> file, and included only the h file in the go code.</p>\n\n<p><strong>dummy.h</strong>:</p>\n\n<pre><code>void testc();\n</code></pre>\n\n<p><strong>dummy.c</strong>:</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n\n\nvoid testc(){\n    dummy();\n}\n</code></pre>\n\n<p><strong>main.go</strong>:</p>\n\n<pre><code>package main\n\n// #cgo CFLAGS: -Wno-error=implicit-function-declaration\n// #include &lt;stdlib.h&gt;\n// #include \"dummy.h\"\nimport \"C\"\n\nimport \"fmt\"\n\n//export dummy\nfunc dummy() int {\n    fmt.Println(\"hi you\")\n    return 0\n}\n\nfunc main() {\n    C.testc()\n}\n</code></pre>\n"}], "owner": {"reputation": 4181, "user_id": 3337677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2a3cb5dc363dbc123686e074c4c3181e?s=128&d=identicon&r=PG&f=1", "display_name": "packetie", "link": "https://stackoverflow.com/users/3337677/packetie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1164, "favorite_count": 0, "accepted_answer_id": 29606465, "answer_count": 1, "score": 0, "last_activity_date": 1428931510, "creation_date": 1428930917, "question_id": 29606241, "link": "https://stackoverflow.com/questions/29606241/error-on-calling-go-function-from-c", "title": "error on calling go function from c", "body": "<p>New to go here.  Tried to call go function from C but suffered some compiling issues</p>\n\n<p>Here is the go script</p>\n\n<pre><code>package main\n// #cgo CFLAGS: -Wno-error=implicit-function-declaration\n// #include &lt;stdlib.h&gt; \n// #include \"wrapper.c\"\nimport \"C\"\n//import \"unsafe\"\nimport \"fmt\"\n//import \"time\"\n\n//export dummy\nfunc dummy() int {\n    fmt.Println(\"hi you\");\n    return 0\n}\n\nfunc main() {\n    C.testc()\n}\n</code></pre>\n\n<p>Here is the wrapper</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n\nextern int dummy();\n\nvoid testc(){\n    dummy();\n}\n</code></pre>\n\n<p>When running it, got error</p>\n\n<pre><code>xyz@xyz-HP:~/learn/go$ go run reader.go \n# command-line-arguments\nIn file included from $WORK/command-line-arguments/_obj/_cgo_export.c:2:0:\nreader.go:30:14: error: conflicting types for \u2018dummy\u2019\nIn file included from reader.go:3:0,\n                 from $WORK/command-line-arguments/_obj/_cgo_export.c:2:\n./wrapper.c:6:12: note: previous declaration of \u2018dummy\u2019 was here\n/tmp/go-build528677551/command-line-arguments/_obj/_cgo_export.c:8:7: error: conflicting types for \u2018dummy\u2019\nIn file included from reader.go:3:0,\n                 from $WORK/command-line-arguments/_obj/_cgo_export.c:2:\n./wrapper.c:6:12: note: previous declaration of \u2018dummy\u2019 was here\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1428930320, "post_id": 29605632, "comment_id": 47357680, "body": "What line is causing the panic?"}, {"owner": {"reputation": 515, "user_id": 927588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/117c87ac418e42aa9145f86c3ab93b8c?s=128&d=identicon&r=PG", "display_name": "Sasan Rose", "link": "https://stackoverflow.com/users/927588/sasan-rose"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1428930946, "post_id": 29605632, "comment_id": 47358099, "body": "@JimB I updated my question"}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 0, "creation_date": 1428931193, "post_id": 29605632, "comment_id": 47358244, "body": "Try checking the error from <code>homeTmpl.Execute(w, r)</code>. <a href=\"http://golang.org/pkg/html/template/#Template.Execute\" rel=\"nofollow noreferrer\">golang.org/pkg/html/template/#Template.Execute</a> , <a href=\"http://play.golang.org/p/xpXFkaD-LB\" rel=\"nofollow noreferrer\">play.golang.org/p/xpXFkaD-LB</a> (Does not run, for illustrative purposes only)"}, {"owner": {"reputation": 515, "user_id": 927588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/117c87ac418e42aa9145f86c3ab93b8c?s=128&d=identicon&r=PG", "display_name": "Sasan Rose", "link": "https://stackoverflow.com/users/927588/sasan-rose"}, "edited": false, "score": 0, "creation_date": 1428931584, "post_id": 29605632, "comment_id": 47358522, "body": "I did still got the panic"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1428932869, "post_id": 29605632, "comment_id": 47359454, "body": "What are you doing at routes.go:11? (or what is in routes.go if you&#39;re not showing us)"}, {"owner": {"reputation": 515, "user_id": 927588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/117c87ac418e42aa9145f86c3ab93b8c?s=128&d=identicon&r=PG", "display_name": "Sasan Rose", "link": "https://stackoverflow.com/users/927588/sasan-rose"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1428934477, "post_id": 29605632, "comment_id": 47360560, "body": "@JimB It is the same file that I posted"}, {"owner": {"reputation": 13632, "user_id": 1071383, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f4bf0fbd4cc6de6159d78f9f9fb3aa6?s=128&d=identicon&r=PG", "display_name": "jabclab", "link": "https://stackoverflow.com/users/1071383/jabclab"}, "edited": false, "score": 0, "creation_date": 1428938841, "post_id": 29605632, "comment_id": 47363906, "body": "The panic suggests <code>sherrifTmpl</code> is <code>nil</code>. What happens if you do the <code>template.New(&quot;test&quot;).Delims(&quot;{[{&quot;, &quot;}]}&quot;)</code> within <code>serveHome</code>?"}, {"owner": {"reputation": 515, "user_id": 927588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/117c87ac418e42aa9145f86c3ab93b8c?s=128&d=identicon&r=PG", "display_name": "Sasan Rose", "link": "https://stackoverflow.com/users/927588/sasan-rose"}, "reply_to_user": {"reputation": 13632, "user_id": 1071383, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f4bf0fbd4cc6de6159d78f9f9fb3aa6?s=128&d=identicon&r=PG", "display_name": "jabclab", "link": "https://stackoverflow.com/users/1071383/jabclab"}, "edited": false, "score": 0, "creation_date": 1428944639, "post_id": 29605632, "comment_id": 47367481, "body": "@jabclab Still the same"}], "answers": [{"comments": [{"owner": {"reputation": 515, "user_id": 927588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/117c87ac418e42aa9145f86c3ab93b8c?s=128&d=identicon&r=PG", "display_name": "Sasan Rose", "link": "https://stackoverflow.com/users/927588/sasan-rose"}, "edited": false, "score": 2, "creation_date": 1428945050, "post_id": 29611051, "comment_id": 47367715, "body": "I still have a long way to fully understand this package"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 515, "user_id": 927588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/117c87ac418e42aa9145f86c3ab93b8c?s=128&d=identicon&r=PG", "display_name": "Sasan Rose", "link": "https://stackoverflow.com/users/927588/sasan-rose"}, "edited": false, "score": 0, "creation_date": 1428946445, "post_id": 29611051, "comment_id": 47368471, "body": "@SasanRose: it&#39;s a hard package to grok sometimes. Plus that nil pointer panic you were getting is a bug that&#39;s fixed in the latest version. (Your code still wouldn&#39;t have worked, but there at least wouldn&#39;t be a panic)"}, {"owner": {"reputation": 1073, "user_id": 2232573, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/207cb35beb3a38a12e8ec83fd12511f0?s=128&d=identicon&r=PG", "display_name": "nurp", "link": "https://stackoverflow.com/users/2232573/nurp"}, "edited": false, "score": 0, "creation_date": 1452220674, "post_id": 29611051, "comment_id": 57083036, "body": "Your code removed the error from my project but the page is totally empty. the template&#39;s content is erased. I use go appengine and the latest version says go1.4.2. Does it mean that the bug is there for appengine users?"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 8, "last_activity_date": 1428946761, "last_edit_date": 1428946761, "creation_date": 1428944806, "answer_id": 29611051, "question_id": 29605632, "link": "https://stackoverflow.com/questions/29605632/template-execute-invalid-memory-address-or-nil-pointer-dereference/29611051#29611051", "title": "template.Execute(): invalid memory address or nil pointer dereference", "body": "<p>A template may actually contain more than one \"template\" to execute. Here you actually have 2 templates; a nil template named \"test\" with custom delimiters, and a parsed template named \"index.html\". </p>\n\n<p>You can either name the first the same name as your index template</p>\n\n<pre><code>var sherrifTmpl = template.New(\"index.html\").Delims(\"{[{\", \"}]}\")\n</code></pre>\n\n<p>or you can call the template by name with <code>ExecuteTemplate</code></p>\n\n<pre><code>template.Must(sherrifTmpl.ParseFiles(\"index.html\")).ExecuteTemplate(w, \"index.html\", r)\n</code></pre>\n\n<p>The <code>html/template</code> package still shouldn't panic in this case. This is a bug that will be fixed in go1.5 (currently fixed in git master).</p>\n"}], "owner": {"reputation": 515, "user_id": 927588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/117c87ac418e42aa9145f86c3ab93b8c?s=128&d=identicon&r=PG", "display_name": "Sasan Rose", "link": "https://stackoverflow.com/users/927588/sasan-rose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3983, "favorite_count": 0, "accepted_answer_id": 29611051, "answer_count": 1, "score": 5, "last_activity_date": 1428946761, "creation_date": 1428928941, "last_edit_date": 1428930921, "question_id": 29605632, "link": "https://stackoverflow.com/questions/29605632/template-execute-invalid-memory-address-or-nil-pointer-dereference", "title": "template.Execute(): invalid memory address or nil pointer dereference", "body": "<p>I am trying to use Go html/template with custom delimiters.</p>\n\n<p>However, I can Parse and Execute my \"index.html\" file, whenever I am trying to change my templates Delimiters I face the following error:</p>\n\n<pre><code>runtime error: invalid memory address or nil pointer dereference goroutine\n</code></pre>\n\n<p>Here is my code:</p>\n\n<pre><code>package main\n\nimport (\n        \"html/template\"\n        \"net/http\"\n)\n\nvar sherrifTmpl = template.New(\"test\").Delims(\"{[{\", \"}]}\")\n\nfunc serveHome(w http.ResponseWriter, r *http.Request) {\n        template.Must(sherrifTmpl.ParseFiles(\"index.html\")).Execute(w, r)\n}\n</code></pre>\n\n<p>If I try any of the followings:</p>\n\n<pre><code>package main\n\nimport (\n        \"html/template\"\n        \"net/http\"\n)\n\nfunc serveHome(w http.ResponseWriter, r *http.Request) {\n        template.Must(template.ParseFiles(\"index.html\")).Execute(w, r)\n}\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>package main\n\nimport (\n        \"html/template\"\n        \"net/http\"\n)\n\nvar sherrifTmpl = template.New(\"test\").Delims(\"{[{\", \"}]}\")\n\nfunc serveHome(w http.ResponseWriter, r *http.Request) {\n        template.Must(sherrifTmpl.ParseFiles(\"{[{.Host}]}\")).Execute(w, r)\n}\n</code></pre>\n\n<p>Everything works. I even tried to catch ParseFiles error. But still no luck:</p>\n\n<pre><code>package main\n\nimport (\n        \"html/template\"\n        \"net/http\"\n)\n\nvar sherrifTmpl = template.New(\"test\").Delims(\"{[{\", \"}]}\")\n\nfunc serveHome(w http.ResponseWriter, r *http.Request) {\n        homeTmpl, err := sherrifTmpl.ParseFiles(\"index.html\")\n        if err != nil {\n            panic(err)\n        }\n        homeTmpl.Execute(w, r)\n}\n</code></pre>\n\n<p>I can't see where I am doing wrong. I would be grateful if any of you could help me on this issue.</p>\n\n<p><strong>Update 1:</strong></p>\n\n<p>Here is the panic:</p>\n\n<pre><code>2015/04/13 17:43:35 http: panic serving 127.0.0.1:56634: runtime error: invalid memory address or nil pointer dereference\ngoroutine 5 [running]:\nnet/http.func\u00b7011()\n    /usr/local/go/src/net/http/server.go:1130 +0xbb\nhtml/template.(*Template).escape(0xc20803ad80, 0x0, 0x0)\n    /usr/local/go/src/html/template/template.go:59 +0xe4\nhtml/template.(*Template).Execute(0xc20803ad80, 0x7f550e16f420, 0xc20805cd20, 0x7280c0, 0xc208032ea0, 0x0, 0x0)\n    /usr/local/go/src/html/template/template.go:75 +0x3d\nmain.serveHome(0x7f550e16f328, 0xc20805cd20, 0xc208032ea0)\n    /home/sasan/Works/Karina/Mobazi/Mon-Panel/routes.go:11 +0x136\nnet/http.HandlerFunc.ServeHTTP(0x7eb738, 0x7f550e16f328, 0xc20805cd20, 0xc208032ea0)\n    /usr/local/go/src/net/http/server.go:1265 +0x41\nnet/http.(*ServeMux).ServeHTTP(0xc20803a6c0, 0x7f550e16f328, 0xc20805cd20, 0xc208032ea0)\n    /usr/local/go/src/net/http/server.go:1541 +0x17d\nnet/http.serverHandler.ServeHTTP(0xc20805a0c0, 0x7f550e16f328, 0xc20805cd20, 0xc208032ea0)\n    /usr/local/go/src/net/http/server.go:1703 +0x19a\nnet/http.(*conn).serve(0xc20805cc80)\n    /usr/local/go/src/net/http/server.go:1204 +0xb57\ncreated by net/http.(*Server).Serve\n    /usr/local/go/src/net/http/server.go:1751 +0x35e\n</code></pre>\n"}, {"tags": ["http", "go"], "answers": [{"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 24613, "user_id": 555222, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dcd4c7151c0b298d4fb46001df735f6b?s=128&d=identicon&r=PG", "display_name": "clarkk", "link": "https://stackoverflow.com/users/555222/clarkk"}, "edited": false, "score": 0, "creation_date": 1428923265, "post_id": 29603712, "comment_id": 47353280, "body": "@clarkk the example above should show that you should use <code>f</code> directly, not  <code>io.Writer(f)</code>, when <code>calling handlers.LoggingHandler()</code>"}, {"owner": {"reputation": 24613, "user_id": 555222, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dcd4c7151c0b298d4fb46001df735f6b?s=128&d=identicon&r=PG", "display_name": "clarkk", "link": "https://stackoverflow.com/users/555222/clarkk"}, "edited": false, "score": 0, "creation_date": 1428923623, "post_id": 29603712, "comment_id": 47353473, "body": "the filesize of serverlog.log is 144 byte but its empty when opening it.. (windows &gt; notepad)"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 24613, "user_id": 555222, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dcd4c7151c0b298d4fb46001df735f6b?s=128&d=identicon&r=PG", "display_name": "clarkk", "link": "https://stackoverflow.com/users/555222/clarkk"}, "edited": false, "score": 0, "creation_date": 1428923652, "post_id": 29603712, "comment_id": 47353492, "body": "@clarkk did you use <code>return handlers.LoggingHandler(f, r)</code>?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 24613, "user_id": 555222, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dcd4c7151c0b298d4fb46001df735f6b?s=128&d=identicon&r=PG", "display_name": "clarkk", "link": "https://stackoverflow.com/users/555222/clarkk"}, "edited": false, "score": 0, "creation_date": 1428923666, "post_id": 29603712, "comment_id": 47353500, "body": "@clarkk and can you try with notepad++ instead of notepad?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 24613, "user_id": 555222, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dcd4c7151c0b298d4fb46001df735f6b?s=128&d=identicon&r=PG", "display_name": "clarkk", "link": "https://stackoverflow.com/users/555222/clarkk"}, "edited": false, "score": 0, "creation_date": 1428923842, "post_id": 29603712, "comment_id": 47353604, "body": "@clarkk did you use a code similar to <code>http.Handle(&quot;&#47;&quot;, handlers.LoggingHandler(f, finalHandler))   http.ListenAndServe(&quot;:9000&quot;, nil)</code>?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 24613, "user_id": 555222, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dcd4c7151c0b298d4fb46001df735f6b?s=128&d=identicon&r=PG", "display_name": "clarkk", "link": "https://stackoverflow.com/users/555222/clarkk"}, "edited": false, "score": 0, "creation_date": 1428924052, "post_id": 29603712, "comment_id": 47353717, "body": "@clarkk try using the code above: <code>http.Handle(&quot;&#47;&quot;, handlers.LoggingHandler(f, finalHandler)) http.ListenAndServe(&quot;:9000&quot;, nil)</code>"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 4, "last_activity_date": 1428923391, "last_edit_date": 1428923391, "creation_date": 1428922813, "answer_id": 29603712, "question_id": 29603488, "link": "https://stackoverflow.com/questions/29603488/gorilla-handlers-write-to-file/29603712#29603712", "title": "gorilla handlers write to file", "body": "<p>Try starting from a working example, as described in \"<a href=\"http://www.alexedwards.net/blog/making-and-using-middleware\" rel=\"nofollow\">Making and Using HTTP Middleware</a>\":</p>\n\n<pre><code>package main\n\nimport (\n  \"github.com/gorilla/handlers\"\n  \"net/http\"\n  \"os\"\n)\n\nfunc main() {\n  finalHandler := http.HandlerFunc(final)\n\n  logFile, err := os.OpenFile(\"server.log\", os.O_WRONLY|os.O_CREATE|os.O_APPEND, 0666)\n  if err != nil {\n    panic(err)\n  }\n\n  http.Handle(\"/\", handlers.LoggingHandler(logFile, finalHandler))\n  http.ListenAndServe(\":3000\", nil)\n}\n\nfunc final(w http.ResponseWriter, r *http.Request) {\n  w.Write([]byte(\"OK\"))\n}\n</code></pre>\n\n<p>The <code>handlers.LoggingHandler()</code> uses the file directly, not <code>io.Writer(f)</code>.</p>\n\n<p>In your case:</p>\n\n<pre><code>return handlers.LoggingHandler(f, r)\n</code></pre>\n"}], "owner": {"reputation": 24613, "user_id": 555222, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dcd4c7151c0b298d4fb46001df735f6b?s=128&d=identicon&r=PG", "display_name": "clarkk", "link": "https://stackoverflow.com/users/555222/clarkk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 917, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1428923920, "creation_date": 1428922129, "last_edit_date": 1428923920, "question_id": 29603488, "link": "https://stackoverflow.com/questions/29603488/gorilla-handlers-write-to-file", "title": "gorilla handlers write to file", "body": "<pre><code>import (\n    \"github.com/gorilla/handlers\"\n)\n\nfunc main(){\n    ...\n\n    err := http.ListenAndServe(\":9000\", access_log(r))\n    if err != nil {\n        log.Fatal(\"HTTP server: \", err)\n    }\n}\n\nfunc access_log(r http.Handler) http.Handler {\n    f, err := os.OpenFile(\"log/access.log\", os.O_CREATE | os.O_WRONLY | os.O_APPEND, 0666)\n    if err != nil {\n        log.Panic(\"Access log: \", err)\n    }\n\n    return handlers.LoggingHandler(io.Writer(f), r)\n}\n</code></pre>\n\n<p>The file is created but nothing is written to the file on each request</p>\n\n<h1>update</h1>\n\n<p>This works when the output is written to <code>os.Stdout</code></p>\n\n<pre><code>func access_log(r http.Handler) http.Handler {\n    /*f, err := os.OpenFile(\"log/access.log\", os.O_CREATE | os.O_WRONLY | os.O_APPEND, 0666)\n    if err != nil {\n        log.Panic(\"Access log: \", err)\n    }\n\n    return handlers.LoggingHandler(io.Writer(f), r)*/\n\n    return handlers.LoggingHandler(os.Stdout, r)\n}\n</code></pre>\n\n<h1>update II</h1>\n\n<pre><code>func main(){\n    runtime.GOMAXPROCS(runtime.NumCPU())\n\n    r := mux.NewRouter()\n\n    www := r.Host(\"secure.domain.com\").Subrouter()\n    www.HandleFunc(\"/\", Handler_www)\n\n    api := r.Host(\"api.domain.com\").Subrouter()\n    api.HandleFunc(\"/\", Handler_api)\n\n    err := http.ListenAndServe(\":9000\", access_log(r))\n    if err != nil {\n        log.Fatal(\"HTTP server: \", err)\n    }\n}\n\nfunc access_log(r http.Handler) http.Handler {\n    f, err := os.OpenFile(\"log/access.log\", os.O_CREATE | os.O_WRONLY | os.O_APPEND, 0666)\n    if err != nil {\n        log.Panic(\"Access log: \", err)\n    }\n\n    return handlers.LoggingHandler(f, r)\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 24613, "user_id": 555222, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dcd4c7151c0b298d4fb46001df735f6b?s=128&d=identicon&r=PG", "display_name": "clarkk", "link": "https://stackoverflow.com/users/555222/clarkk"}, "edited": false, "score": 0, "creation_date": 1428920954, "post_id": 29603076, "comment_id": 47351980, "body": "@clarkk you  can&#39;t currently as defined: see my edited answer."}, {"owner": {"reputation": 24613, "user_id": 555222, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dcd4c7151c0b298d4fb46001df735f6b?s=128&d=identicon&r=PG", "display_name": "clarkk", "link": "https://stackoverflow.com/users/555222/clarkk"}, "edited": false, "score": 0, "creation_date": 1428921040, "post_id": 29603076, "comment_id": 47352028, "body": "I have defined the <code>r</code> argument.. have updated my question and error"}, {"owner": {"reputation": 24613, "user_id": 555222, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dcd4c7151c0b298d4fb46001df735f6b?s=128&d=identicon&r=PG", "display_name": "clarkk", "link": "https://stackoverflow.com/users/555222/clarkk"}, "edited": false, "score": 0, "creation_date": 1428921385, "post_id": 29603076, "comment_id": 47352215, "body": "you don&#39;t need to define type of function arguments? have added the return type.. Now there are no errors.. But nothing is logged to the file.. The file is created though"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 24613, "user_id": 555222, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dcd4c7151c0b298d4fb46001df735f6b?s=128&d=identicon&r=PG", "display_name": "clarkk", "link": "https://stackoverflow.com/users/555222/clarkk"}, "edited": false, "score": 0, "creation_date": 1428921453, "post_id": 29603076, "comment_id": 47352257, "body": "@clarkk Yes, I have answered the original question. Why nothing is logged would be a separate question."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 1, "last_activity_date": 1428921051, "last_edit_date": 1428921051, "creation_date": 1428920737, "answer_id": 29603076, "question_id": 29602990, "link": "https://stackoverflow.com/questions/29602990/syntax-error-function-return-value/29603076#29603076", "title": "syntax error function return value", "body": "<p><code>func access_log(r)</code> does not define the type for the parameter r.</p>\n\n<p>Once you define it, the compilation should be able to proceed.</p>\n\n<pre><code>./main.go:83: too many arguments to return\n</code></pre>\n\n<p>The function as define as no return value, hence the error.</p>\n\n<p>If you add the return type of <a href=\"http://www.gorillatoolkit.org/pkg/handlers#LoggingHandler\" rel=\"nofollow\">handlers#LoggingHandler</a>, that would be  <code>http.Handler</code>.</p>\n\n<pre><code>func access_log(r) http.Handler {\n   ...\n   // Then you can return:\n   return handlers.LoggingHandler(io.Writer(f), r)\n}\n</code></pre>\n"}], "owner": {"reputation": 24613, "user_id": 555222, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dcd4c7151c0b298d4fb46001df735f6b?s=128&d=identicon&r=PG", "display_name": "clarkk", "link": "https://stackoverflow.com/users/555222/clarkk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 356, "favorite_count": 1, "accepted_answer_id": 29603076, "answer_count": 1, "score": 2, "last_activity_date": 1428921051, "creation_date": 1428920434, "last_edit_date": 1428920864, "question_id": 29602990, "link": "https://stackoverflow.com/questions/29602990/syntax-error-function-return-value", "title": "syntax error function return value", "body": "<pre><code>func main(){\n    ...\n\n    err := http.ListenAndServe(\":9000\", access_log(r))\n    if err != nil {\n        log.Fatal(\"HTTP server: \", err)\n    }\n}\n\nfunc access_log(r http.Handler) {\n    f, err := os.OpenFile(\"log/access.log\", os.O_CREATE | os.O_WRONLY | os.O_APPEND, 0666)\n    if err != nil {\n        log.Panic(\"Access log: \", err)\n    }\n\n    return handlers.LoggingHandler(io.Writer(f), r)\n}\n</code></pre>\n\n<h1>error</h1>\n\n<pre><code># command-line-arguments\n./main.go:71: access_log(r) used as value\n./main.go:83: too many arguments to return\n</code></pre>\n"}, {"tags": ["http", "go"], "answers": [{"comments": [{"owner": {"reputation": 24613, "user_id": 555222, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dcd4c7151c0b298d4fb46001df735f6b?s=128&d=identicon&r=PG", "display_name": "clarkk", "link": "https://stackoverflow.com/users/555222/clarkk"}, "edited": false, "score": 1, "creation_date": 1428916200, "post_id": 29601622, "comment_id": 47349248, "body": "This works, but now I get this error <code>server: crypto&#47;tls: private key does not match public key</code>"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 24613, "user_id": 555222, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dcd4c7151c0b298d4fb46001df735f6b?s=128&d=identicon&r=PG", "display_name": "clarkk", "link": "https://stackoverflow.com/users/555222/clarkk"}, "edited": false, "score": 0, "creation_date": 1428917373, "post_id": 29601622, "comment_id": 47349905, "body": "@clarkk I see the error emitted from here: <a href=\"https://github.com/golang/go/blob/master/src/crypto/tls/tls.go#L219-L249\" rel=\"nofollow noreferrer\">github.com/golang/go/blob/master/src/crypto/tls/&hellip;</a>. Make sure the format used for the certificate and the key are the same (pem)."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 24613, "user_id": 555222, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dcd4c7151c0b298d4fb46001df735f6b?s=128&d=identicon&r=PG", "display_name": "clarkk", "link": "https://stackoverflow.com/users/555222/clarkk"}, "edited": false, "score": 0, "creation_date": 1428917574, "post_id": 29601622, "comment_id": 47350027, "body": "@clarkk please don&#39;t change the question: I have answered the <i>original</i> question."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 2, "last_activity_date": 1428916111, "creation_date": 1428916111, "answer_id": 29601622, "question_id": 29601576, "link": "https://stackoverflow.com/questions/29601576/golang-and-listenandservetls-return-error/29601622#29601622", "title": "golang and ListenAndServeTLS return error", "body": "<p>Try and add <code>()</code> after the closing <code>}</code>.</p>\n\n<p>That way, you would actually call the <code>func()</code>.</p>\n\n<pre><code>go func(){\n    cert := \"/var/ini/ssl/secure.domain.com/intermediate.crt\"\n    prv_key := \"/var/ini/ssl/secure.domain.com/private.key\"\n    err := http.ListenAndServeTLS(\":9443\", cert, prv_key, r)\n    if err != nil {\n        log.Fatal(\"HTTPS server: \", err)\n    }\n}()\n</code></pre>\n"}], "owner": {"reputation": 24613, "user_id": 555222, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dcd4c7151c0b298d4fb46001df735f6b?s=128&d=identicon&r=PG", "display_name": "clarkk", "link": "https://stackoverflow.com/users/555222/clarkk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 949, "favorite_count": 1, "accepted_answer_id": 29601622, "answer_count": 1, "score": -3, "last_activity_date": 1428918008, "creation_date": 1428915955, "last_edit_date": 1428918008, "question_id": 29601576, "link": "https://stackoverflow.com/questions/29601576/golang-and-listenandservetls-return-error", "title": "golang and ListenAndServeTLS return error", "body": "<pre><code>func main(){\n    runtime.GOMAXPROCS(runtime.NumCPU())\n\n    r := mux.NewRouter()\n\n    www := r.Host(\"secure.domain.com\").Subrouter()\n    www.HandleFunc(\"/\", Handler_www)\n\n    api := r.Host(\"api.domain.com\").Subrouter()\n    api.HandleFunc(\"/\", Handler_api)\n\n    go func(){\n        cert := \"/var/ini/ssl/secure.domain.com/intermediate.crt\"\n        prv_key := \"/var/ini/ssl/secure.domain.com/private.key\"\n        err := http.ListenAndServeTLS(\":9443\", cert, prv_key, r)\n        if err != nil {\n            log.Fatal(\"HTTPS server: \", err)\n        }\n    }\n\n    err := http.ListenAndServe(\":9000\", r)\n    if err != nil {\n        log.Fatal(\"HTTP server: \", err)\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "go", "build", "release"], "answers": [{"tags": [], "owner": {"reputation": 3818, "user_id": 1247113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRMFj.png?s=128&g=1", "display_name": "rob74", "link": "https://stackoverflow.com/users/1247113/rob74"}, "is_accepted": false, "score": 14, "last_activity_date": 1442485705, "last_edit_date": 1442485705, "creation_date": 1428909151, "answer_id": 29599712, "question_id": 29599209, "link": "https://stackoverflow.com/questions/29599209/how-to-build-a-release-version-binary-in-go/29599712#29599712", "title": "How to build a release version binary in Go?", "body": "<p>You can instruct the linker to strip debug symbols by using</p>\n\n<pre><code>go install -ldflags '-s'\n</code></pre>\n\n<p>I just tried it on a fairly large executable (one of the <a href=\"https://github.com/google/gxui\" rel=\"noreferrer\">GXUI</a> samples), and this reduced it from ~16M to ~10M. As always, your mileage may vary... </p>\n\n<p><a href=\"https://golang.org/cmd/link/\" rel=\"noreferrer\">Here</a> is a full list of all linker options.</p>\n"}, {"comments": [{"owner": {"reputation": 3631, "user_id": 108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aee4fda29066f6c6a6eced6910190dfb?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/108/greg"}, "edited": false, "score": 1, "creation_date": 1428911094, "post_id": 29600086, "comment_id": 47346621, "body": "There&#39;s some documentation on this here - <a href=\"https://golang.org/doc/gdb#Introduction\" rel=\"nofollow noreferrer\">golang.org/doc/gdb#Introduction</a>."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 3, "creation_date": 1428911780, "post_id": 29600086, "comment_id": 47346975, "body": "You&#39;re right, but I think there&#39;s a good reason it&#39;s not typical to strip symbols--if you get a report of a panic out in the wild, for example, it&#39;d be great to have the symbols there for an informative stacktrace."}, {"owner": {"reputation": 3818, "user_id": 1247113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRMFj.png?s=128&g=1", "display_name": "rob74", "link": "https://stackoverflow.com/users/1247113/rob74"}, "edited": false, "score": 3, "creation_date": 1428913200, "post_id": 29600086, "comment_id": 47347651, "body": "I think &quot;-s&quot; (omit symbol table and debug info) already includes &quot;-w&quot; (omit DWARF symbol table), so there should be no need to specify both. With the executable I tried this on, &quot;-s -w&quot; gives exactly the same size as &quot;-s&quot; alone."}, {"owner": {"reputation": 362, "user_id": 2544044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55e4021f92a8fe5f2a4620ef45bfebc6?s=128&d=identicon&r=PG", "display_name": "Chris B.", "link": "https://stackoverflow.com/users/2544044/chris-b"}, "edited": false, "score": 1, "creation_date": 1493129109, "post_id": 29600086, "comment_id": 74274681, "body": "It would appear that -s doesn&#39;t affect GOOS=darwin"}, {"owner": {"reputation": 163, "user_id": 4329213, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VGEIUpgLKFY/AAAAAAAAAAI/AAAAAAAAAQw/xOVKAWCiArM/photo.jpg?sz=128", "display_name": "Burak B&#252;y&#252;katl\u0131", "link": "https://stackoverflow.com/users/4329213/burak-b%c3%bcy%c3%bckatl%c4%b1"}, "edited": false, "score": 1, "creation_date": 1501493368, "post_id": 29600086, "comment_id": 77784579, "body": "Only startup-time changes."}, {"owner": {"reputation": 5340, "user_id": 1059446, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2993872284fcac27003cf02b201ea0c3?s=128&d=identicon&r=PG", "display_name": "Aleksandr Kravets", "link": "https://stackoverflow.com/users/1059446/aleksandr-kravets"}, "edited": false, "score": 2, "creation_date": 1527061923, "post_id": 29600086, "comment_id": 87978444, "body": "Just made some experiments on my Mac. Results: -s does not imply -w, binary size with/without -s is the same. -w reduces binary from 12 to 8MB. ALSO: there&#39;s NO difference in stack-traces between &quot;go build&quot; and &quot;-s -w&quot; builds. Of course it&#39;s just for my software, probably there are   corner cases."}], "tags": [], "owner": {"reputation": 1269, "user_id": 4053083, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-R0sxVSnED-s/AAAAAAAAAAI/AAAAAAAAABM/xBA0R1-CVjw/photo.jpg=k-s128", "display_name": "hiwjd0", "link": "https://stackoverflow.com/users/4053083/hiwjd0"}, "is_accepted": true, "score": 84, "last_activity_date": 1428911421, "last_edit_date": 1428911421, "creation_date": 1428910589, "answer_id": 29600086, "question_id": 29599209, "link": "https://stackoverflow.com/questions/29599209/how-to-build-a-release-version-binary-in-go/29600086#29600086", "title": "How to build a release version binary in Go?", "body": "<p>In Go, it isn't typical to have a debug version or a release version.  </p>\n\n<p>By default, <code>go build</code> combines symbol and debug info with binary files. However, you can remove the symbol and debug info with <code>go build -ldflags \"-s -w\"</code>.</p>\n"}], "owner": {"reputation": 717, "user_id": 4445806, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c5d013c30989c84e693d5f06458d4bde?s=128&d=identicon&r=PG&f=1", "display_name": "catric mia", "link": "https://stackoverflow.com/users/4445806/catric-mia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35343, "favorite_count": 13, "accepted_answer_id": 29600086, "answer_count": 2, "score": 53, "last_activity_date": 1442485705, "creation_date": 1428907154, "last_edit_date": 1429279972, "question_id": 29599209, "link": "https://stackoverflow.com/questions/29599209/how-to-build-a-release-version-binary-in-go", "title": "How to build a release version binary in Go?", "body": "<p>In C, we can build a debug version or a release version of the binary files (the object files and the executable). How can we do this in Go? </p>\n"}, {"tags": ["stored-procedures", "go", "oracle11g", "oci8"], "comments": [{"owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "edited": false, "score": 0, "creation_date": 1428916297, "post_id": 29598148, "comment_id": 47349308, "body": "Where is the line <code>ORA-06512: at &quot;BLOW.USER_MGT&quot;, line 20</code> ?"}, {"owner": {"reputation": 293, "user_id": 1597934, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b79cd14f520191a6c0e10d5837dfa2a4?s=128&d=identicon&r=PG", "display_name": "BlowMan", "link": "https://stackoverflow.com/users/1597934/blowman"}, "reply_to_user": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "edited": false, "score": 0, "creation_date": 1428917803, "post_id": 29598148, "comment_id": 47350163, "body": "Line 20(<code>WHERE u_mail= u_mail_in;</code>)"}, {"owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "edited": false, "score": 1, "creation_date": 1428936901, "post_id": 29598148, "comment_id": 47362464, "body": "Ah, i figure out. go&#39;s database/driver can&#39;t pass the variable retStatus directly. So oci8 driver can&#39;t recognize how the buffer size is required."}, {"owner": {"reputation": 293, "user_id": 1597934, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b79cd14f520191a6c0e10d5837dfa2a4?s=128&d=identicon&r=PG", "display_name": "BlowMan", "link": "https://stackoverflow.com/users/1597934/blowman"}, "reply_to_user": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "edited": false, "score": 0, "creation_date": 1428938338, "post_id": 29598148, "comment_id": 47363518, "body": "Is there a way to properly provide the 3rd variable collect the OUT value from the procedure?"}, {"owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "edited": false, "score": 0, "creation_date": 1428940721, "post_id": 29598148, "comment_id": 47365115, "body": "to do it, it must provide a new driver that is not handled as database/sql package."}], "owner": {"reputation": 293, "user_id": 1597934, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b79cd14f520191a6c0e10d5837dfa2a4?s=128&d=identicon&r=PG", "display_name": "BlowMan", "link": "https://stackoverflow.com/users/1597934/blowman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1586, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459293027, "creation_date": 1428901315, "question_id": 29598148, "link": "https://stackoverflow.com/questions/29598148/golang-oci8-stored-procedure-query-produces-error", "title": "Golang oci8 Stored Procedure query produces error", "body": "<p>I want to query using golang oci8, and this is my setup in oracle xe;</p>\n\n<pre><code>CREATE OR REPLACE PACKAGE user_mgt\nIS\nPROCEDURE login(u_mail_in IN VARCHAR2,\n              u_pwd_in IN VARCHAR2,\n              retval OUT VARCHAR2)  ;\nEND user_mgt;\nCREATE OR REPLACE PACKAGE   BODY user_mgt\n   is\n        PROCEDURE login(u_mail_in IN VARCHAR2,\n        u_pwd_in IN VARCHAR2,\n        retval OUT VARCHAR2)\n        AS\n             l_count NUMBER     ;\n        BEGIN\n            SELECT Count(*)\n            INTO  l_count\n            FROM USERTABLE\n            WHERE u_mail= u_mail_in;\n\n            IF l_count=1 then\n             SELECT u_pwd\n             INTO   retval\n             FROM usertable\n             WHERE u_mail= u_mail_in;\n            ELSE\n                  retval:='NotFound';\n            END IF    ;\n\n        END   login;\n    END user_mgt\n</code></pre>\n\n<p>My test below has no error and returns the expected result;</p>\n\n<pre><code>DECLARE\nem VARCHAR2(50);\npwd VARCHAR2(200);\nretval VARCHAR2(200);\nBEGIN\nem:='blow';\npwd:='pwd';\n   user_mgt.login(em,pwd,retval);\n   Dbms_Output.put_line(retval);\nEND;\n</code></pre>\n\n<p>Now when i try to query in my golang setup i get an error;\npackage main</p>\n\n<pre><code>import (\n    \"database/sql\"\n    \"fmt\"\n    _ \"github.com/mattn/go-oci8\"\n)\nfunc main() {\n    db, err := sql.Open(\"oci8\", \"user/password@XE\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    defer db.Close()\n    loginStmt,err:=db.Prepare(\"begin user_mgt.login(:1,:2,:3);end;\")\n        defer loginStmt.Close()\n    mail:=\"ofoe\"\n    pwd:=\"testing\"\n    var retVal string\n    var retStatus string\n    er:=loginStmt.QueryRow(mail,pwd,retVal).Scan(&amp;retStatus)\n    if er!=nil{\n        panic(er)\n    }\n    fmt.Println(\"retval\")\n    fmt.Println(retStatus)\n}\n</code></pre>\n\n<p>I will appreciate any help, am really stuck, the error i get is;</p>\n\n<pre><code>panic: ORA-06502: PL/SQL: numeric or value error: character string buffer too sm\nall\nORA-06512: at \"BLOW.USER_MGT\", line 20\nORA-06512: at line 1\ngoroutine 1 [running]:\nmain.main()\n        C:/Users/pc/Documents/goPlayground/src/blow.com/oracle_test/main.go:27 +\n0x3ab\n\ngoroutine 17 [syscall, locked to thread]:\nruntime.goexit()\n        c:/go/src/runtime/asm_386.s:2287 +0x1\n\ngoroutine 5 [runnable]:\ndatabase/sql.(*DB).connectionOpener(0x12252460)\n        c:/go/src/database/sql/sql.go:589 +0x43\ncreated by database/sql.Open\n        c:/go/src/database/sql/sql.go:452 +0x256\nexit status 2\n</code></pre>\n"}, {"tags": ["go", "struct", "embedding"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 4, "last_activity_date": 1475402943, "last_edit_date": 1475402943, "creation_date": 1428902013, "answer_id": 29598248, "question_id": 29598131, "link": "https://stackoverflow.com/questions/29598131/using-a-struct-member-as-a-member-in-another-struct/29598248#29598248", "title": "Using a struct member as a member in another struct", "body": "<p>When you define a struct field, you have to specify <a href=\"http://golang.org/ref/spec#Struct_types\" rel=\"nofollow\">its name and its type</a> like you did with struct <code>A.a</code>. But in struct <code>B</code>:</p>\n\n<pre><code>b *A.a\n</code></pre>\n\n<p><code>*A.a</code> is not a type.</p>\n\n<p>You can't embed a field of a <code>struct</code> in another struct. Note that however you can embed <em>complete</em> structs in another by omitting the <em>name</em> part like this:</p>\n\n<pre><code>type (\n    A struct {\n        a string\n    }\n\n    B struct {\n        A\n    }\n)\n</code></pre>\n\n<p>The result is that all the fields and methods of type <code>A</code> will also be member of struct <code>B</code>. If you need the embedded struct <code>A</code> of <code>B</code>, you can access it by referring to it as the type name:</p>\n\n<pre><code>var b B\nfmt.Println(b.A)\n</code></pre>\n\n<p>Another thing you can do is have a field in <code>B</code> which is a pointer and it points to the field of an <em>existing value</em> of type <code>A</code>:</p>\n\n<pre><code>B struct {\n    ap *string\n}\n\na := A{a:\"test\"}\nb := B{ap:&amp;a.a} // B.ap will point to a.a\n\nfmt.Println(*b.ap) // Prints \"test\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 0, "last_activity_date": 1428948410, "last_edit_date": 1428948410, "creation_date": 1428948096, "answer_id": 29612005, "question_id": 29598131, "link": "https://stackoverflow.com/questions/29598131/using-a-struct-member-as-a-member-in-another-struct/29612005#29612005", "title": "Using a struct member as a member in another struct", "body": "<p>The problem is that you're using <code>*A.a</code> as the type specifier for field <code>b</code>. The only thing you're missing is that you should have <code>b string</code> or <code>b *string</code> there (if you want a string field in struct B at least). </p>\n\n<p>Now if your goal is to do something more like 'inheriting' the field then you should <em>embed</em> <code>A</code> in <code>B</code> which will give <code>B</code> a property called <code>a</code>. That would look like this;</p>\n\n<pre><code>type B struct {\n      A\n}\n</code></pre>\n\n<p>This is the most similar construct to inheritance Go offers. If you were to embed here you would be able to do something like; </p>\n\n<pre><code>var instanceOfB = &amp;B{}\nfmt.Println(instanceOfB.a)\n</code></pre>\n\n<p>Which is functionally equivalent of having B inherit from A (in this case, the two things are not the same though and behavior is different in many. I just think it's helpful to compare/contrast to inheritance). At this point you can access an property or method on <code>A</code> directly from an instance of <code>B</code>. It's best to avoid name collisions though they won't cause a compiler error. If you do have naming collisions between embedded types or the embeddor and an embedded type the decision of which method/property to use is made at runtime and I'm not sure what the resolution rules are but I think you can find them in the language spec.</p>\n\n<p>Now my last idea... If your goal is to reference the <code>a</code> property in an instance of <code>A</code> from some instance of <code>B</code>, you just want to include a sting pointer in <code>B</code> and set it to <code>&amp;A.a</code> in your constructor a static initializer when you instantiate <code>B</code>. However this is probably a bad practice as it defies the concept of encapsulation and is just very obviously error prone.</p>\n"}], "owner": {"reputation": 407, "user_id": 1116320, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/57109f0ba9d6d7a3ad945a6d5c3c019e?s=128&d=identicon&r=PG", "display_name": "HaseebR7", "link": "https://stackoverflow.com/users/1116320/haseebr7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1475403018, "creation_date": 1428901232, "last_edit_date": 1475403018, "question_id": 29598131, "link": "https://stackoverflow.com/questions/29598131/using-a-struct-member-as-a-member-in-another-struct", "title": "Using a struct member as a member in another struct", "body": "<pre><code>type (\n    A struct {\n        a string\n    }\n\n    B struct {\n        b *A.a\n    }\n)\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>A.a undefined (type A has no method a)\n</code></pre>\n\n<p>Am I missing something here? Or is it not allowed in Go?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 7, "last_activity_date": 1428888966, "last_edit_date": 1428888966, "creation_date": 1428887809, "answer_id": 29596562, "question_id": 29596518, "link": "https://stackoverflow.com/questions/29596518/confusion-about-go-syntax/29596562#29596562", "title": "Confusion about Go syntax", "body": "<blockquote>\n  <p><a href=\"http://golang.org/ref/spec\" rel=\"noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"http://golang.org/ref/spec#Type_assertions\" rel=\"noreferrer\">Type assertions</a></p>\n  \n  <p>For an expression x of interface type and a type T, the primary\n  expression</p>\n  \n  <p><code>x.(T)</code></p>\n  \n  <p>asserts that x is not nil and that the value stored in x is of type T.\n  The notation x.(T) is called a type assertion. </p>\n  \n  <p>A type assertion used in an assignment or initialization of the\n  special form</p>\n\n<pre><code>v, ok = x.(T)\nv, ok := x.(T)\nvar v, ok = x.(T)\n</code></pre>\n  \n  <p>yields an additional untyped boolean value. The value of ok is true if\n  the assertion holds. Otherwise it is false and the value of v is the\n  zero value for type T.</p>\n</blockquote>\n\n<p>If <code>c</code> of type <code>Conn</code>, an interface type, contains a value of type <code>*TCPConn</code> then <code>ok</code> is true and <code>tc</code> is set to the value of type <code>*TCPConn</code> stored in <code>c</code>. <code>c</code> could also contain <code>nil</code>, <code>*UDPConn</code>, <code>*UnixConn</code>, et cetera. In which case, <code>tc</code> will be <code>nil</code> and <code>ok</code> will be false.</p>\n\n<pre><code>if tc, ok := c.(*TCPConn); ok {\n    tc.SetKeepAlive(true)\n    tc.SetKeepAlivePeriod(d.KeepAlive)\n    testHookSetKeepAlive()\n}\n</code></pre>\n"}], "owner": {"reputation": 5164, "user_id": 1461269, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f5507a725df760d1a9b0dd88505f8bd1?s=128&d=identicon&r=PG", "display_name": "arjabbar", "link": "https://stackoverflow.com/users/1461269/arjabbar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 1, "accepted_answer_id": 29596562, "answer_count": 1, "score": 2, "last_activity_date": 1428888966, "creation_date": 1428887370, "last_edit_date": 1428888847, "question_id": 29596518, "link": "https://stackoverflow.com/questions/29596518/confusion-about-go-syntax", "title": "Confusion about Go syntax", "body": "<p>I seen this in the <code>net</code> package source code on golang.org.</p>\n\n<pre><code>c, err := dial(network, ra.toAddr(), dialer, d.deadline())\nif d.KeepAlive &gt; 0 &amp;&amp; err == nil {\n    if tc, ok := c.(*TCPConn); ok {\n        tc.SetKeepAlive(true)\n        tc.SetKeepAlivePeriod(d.KeepAlive)\n        testHookSetKeepAlive()\n    }\n}\nreturn c, err\n</code></pre>\n\n<p>What is <code>c.(*TCPConn)</code> doing exactly in this case? I thought initially it was some kind of type casting, but it returns 2 values to <code>tc</code> and <code>ok</code>.</p>\n\n<p>This is confusing to me. Can someone explain what this code is doing please?</p>\n\n<p><a href=\"https://golang.org/src/net/dial.go\" rel=\"nofollow\">source code here</a> line 171.</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1428885243, "post_id": 29596071, "comment_id": 47339367, "body": "Normally you put &quot;secret codes&quot; in environment variables?? The same environment space that on many/most OSes is readable by any process??"}, {"owner": {"reputation": 3356, "user_id": 136584, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2d7e537698337ca29412fb615b07f702?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/136584/jason"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1428888296, "post_id": 29596071, "comment_id": 47339987, "body": "Don&#39;t just post snark @DaveC, post your solution. We want to learn and upvote. If your solution is &quot;don&#39;t do this and instead do ...&quot; then thats great! This question could help us find the right question to be asking based on your answer."}], "answers": [{"tags": [], "owner": {"reputation": 4544, "user_id": 1337127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88c5c900e5e61ec5d73e63fbb1f8242d?s=128&d=identicon&r=PG", "display_name": "Mark Doyle", "link": "https://stackoverflow.com/users/1337127/mark-doyle"}, "is_accepted": true, "score": 2, "last_activity_date": 1428913722, "creation_date": 1428913722, "answer_id": 29600950, "question_id": 29596071, "link": "https://stackoverflow.com/questions/29596071/how-to-set-application-wide-settings-for-go-apps-in-google-app-engine/29600950#29600950", "title": "How to set application wide settings for Go apps in Google App Engine?", "body": "<p>Some approaches that may suit depending on your needs:</p>\n\n<ul>\n<li>Config file</li>\n<li>Datastore</li>\n</ul>\n\n<p><strong>Config file</strong>\nAdd a config file to your project and load the settings from there on app initialization. <a href=\"https://github.com/astaxie/beegae/blob/master/config.go\" rel=\"nofollow\">Beegae</a> is an example of that approach.  Depending on your security needs you might choose to exclude the file from git, create/update it during your deployment process or even consider multiple config files for different cases.</p>\n\n<p><strong>Datastore</strong>\nStore the settings in the datastore and load them on application initialization.  This may be useful if settings need to be changed without redeploying the application each time, or multiple applications share the same datastore and some look-up logic for settings makes sense.</p>\n"}], "owner": {"reputation": 3356, "user_id": 136584, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2d7e537698337ca29412fb615b07f702?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/136584/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "accepted_answer_id": 29600950, "answer_count": 1, "score": 2, "last_activity_date": 1428913722, "creation_date": 1428883221, "last_edit_date": 1428888363, "question_id": 29596071, "link": "https://stackoverflow.com/questions/29596071/how-to-set-application-wide-settings-for-go-apps-in-google-app-engine", "title": "How to set application wide settings for Go apps in Google App Engine?", "body": "<p>The Google App engine for Go does not accept environment variables via the <code>app.yaml</code> file. How do you setup application wide settings without using the environment?</p>\n\n<hr>\n\n<p>In my specific case I have a watcher type webhook app (<a href=\"https://github.com/jjasonclark/pulltabs\" rel=\"nofollow\">https://github.com/jjasonclark/pulltabs</a>) that needs to handle HMAC decryption. So I need to have a secret code for this to work.  I would like to deploy many copies with different secret settings, aka not hard coded. Normally this would be an environment variable settings.</p>\n"}, {"tags": ["http", "cookies", "go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 2, "creation_date": 1428876836, "post_id": 29595154, "comment_id": 47337348, "body": "Just as an aside: the <code>RawExpires</code>, <code>Raw</code>, and <code>Unparsed</code> fields of <code>Cookie</code> are not used when setting cookies."}], "answers": [{"comments": [{"owner": {"reputation": 973, "user_id": 582881, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/895329ca6aa08abd005fdd4fb5ef0a75?s=128&d=identicon&r=PG", "display_name": "spe", "link": "https://stackoverflow.com/users/582881/spe"}, "edited": false, "score": 0, "creation_date": 1428877129, "post_id": 29595232, "comment_id": 47337446, "body": "Documentations says: SetCookie adds a Set-Cookie header to the provided ResponseWriter&#39;s headers. <a href=\"http://golang.org/pkg/net/http/\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http</a>"}, {"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "reply_to_user": {"reputation": 973, "user_id": 582881, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/895329ca6aa08abd005fdd4fb5ef0a75?s=128&d=identicon&r=PG", "display_name": "spe", "link": "https://stackoverflow.com/users/582881/spe"}, "edited": false, "score": 1, "creation_date": 1428877177, "post_id": 29595232, "comment_id": 47337466, "body": "@spe I don&#39;t see how that&#39;s relevant. You&#39;re using <code>Cookie</code>, which reads a cookie from a request. <code>SetCookie</code> sets a cookie for a response."}, {"owner": {"reputation": 973, "user_id": 582881, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/895329ca6aa08abd005fdd4fb5ef0a75?s=128&d=identicon&r=PG", "display_name": "spe", "link": "https://stackoverflow.com/users/582881/spe"}, "edited": false, "score": 0, "creation_date": 1428877361, "post_id": 29595232, "comment_id": 47337513, "body": "I see. So, is it is not possible to get cookie expiration time on server side, right?"}, {"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "reply_to_user": {"reputation": 973, "user_id": 582881, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/895329ca6aa08abd005fdd4fb5ef0a75?s=128&d=identicon&r=PG", "display_name": "spe", "link": "https://stackoverflow.com/users/582881/spe"}, "edited": false, "score": 1, "creation_date": 1428877424, "post_id": 29595232, "comment_id": 47337525, "body": "No. The data is unavailable so you can&#39;t get it."}], "tags": [], "owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "is_accepted": true, "score": 14, "last_activity_date": 1428877563, "last_edit_date": 1428877563, "creation_date": 1428876702, "answer_id": 29595232, "question_id": 29595154, "link": "https://stackoverflow.com/questions/29595154/cant-get-cookie-expiration-time-in-golang/29595232#29595232", "title": "Can&#39;t get cookie expiration time in golang", "body": "<p>That's how HTTP works; the expires attribute is only sent with the Set-Cookie response header, not with the Cookie request header. The Cookie request header contains only the names and values of the cookies, not any other metadata.</p>\n"}, {"tags": [], "owner": {"reputation": 449, "user_id": 9024502, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6acRO.jpg?s=128&g=1", "display_name": "Nitzan Cohen", "link": "https://stackoverflow.com/users/9024502/nitzan-cohen"}, "is_accepted": false, "score": -1, "last_activity_date": 1541677504, "creation_date": 1541677504, "answer_id": 53207087, "question_id": 29595154, "link": "https://stackoverflow.com/questions/29595154/cant-get-cookie-expiration-time-in-golang/53207087#53207087", "title": "Can&#39;t get cookie expiration time in golang", "body": "<p>If you want to query the expiry, you should address it as a different cookie.</p>\n"}], "owner": {"reputation": 973, "user_id": 582881, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/895329ca6aa08abd005fdd4fb5ef0a75?s=128&d=identicon&r=PG", "display_name": "spe", "link": "https://stackoverflow.com/users/582881/spe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3786, "favorite_count": 1, "accepted_answer_id": 29595232, "answer_count": 2, "score": 9, "last_activity_date": 1541677504, "creation_date": 1428876117, "last_edit_date": 1428876488, "question_id": 29595154, "link": "https://stackoverflow.com/questions/29595154/cant-get-cookie-expiration-time-in-golang", "title": "Can&#39;t get cookie expiration time in golang", "body": "<p>I'm setting a new cookie</p>\n\n<pre><code>func f1(w http.ResponseWriter, r *http.Request) {\n...\nexpire := time.Now().AddDate(0, 1, 0)\ncookie := http.Cookie{\"token\", token, \"/\", \"domain\", expire, expire.Format(time.UnixDate), 86400, true, true, \"token=\" + token, []string{\"token=\" + token}}\nhttp.SetCookie(w, &amp;cookie)\n</code></pre>\n\n<p>Then i'm trying to get it</p>\n\n<pre><code>func f2(w http.ResponseWriter, r *http.Request) {\n...\ncookie, err := r.Cookie(\"token\")\nfmt.Println(cookie.Value)\nfmt.Println(cookie.Expires)\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>valid_token_string\n0001-01-01 00:00:00 +0000 UTC\n</code></pre>\n\n<p>Value is the same i set, but Expires is empty.\nWhy?</p>\n"}, {"tags": ["datetime", "time", "go", "datetimeoffset"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 3, "last_activity_date": 1428866916, "creation_date": 1428866916, "answer_id": 29593689, "question_id": 29593174, "link": "https://stackoverflow.com/questions/29593174/in-go-given-a-location-name-how-can-we-determine-the-current-time-in-that-loca/29593689#29593689", "title": "In Go, given a location name, how can we determine the current time in that location?", "body": "<p>Fix the bug in your program. For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"time\"\n\nfunc main() {\n    loc, _ := time.LoadLocation(\"America/Los_Angeles\")\n    t := time.Date(2015, 04, 12, 19, 23, 0, 0, loc)\n    t2 := time.Date(2015, 03, 1, 19, 23, 0, 0, loc)\n    _, offset := t.Zone()\n    _, offset2 := t2.Zone()\n    fmt.Printf(\"t1: %v  offset: %d\\n\", t, offset)\n    fmt.Printf(\"t2: %v  offset: %d\\n\", t2, offset2)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>t1: 2015-04-12 19:23:00 -0700 PDT  offset: -25200\nt2: 2015-03-01 19:23:00 -0800 PST  offset: -28800\n</code></pre>\n"}], "owner": {"reputation": 2856, "user_id": 29075, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/30f399dc1f2cbad5f087de16d27baa5a?s=128&d=identicon&r=PG", "display_name": "miguelv", "link": "https://stackoverflow.com/users/29075/miguelv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 1, "closed_date": 1428949470, "accepted_answer_id": 29593689, "answer_count": 1, "score": -3, "last_activity_date": 1428866916, "creation_date": 1428864172, "question_id": 29593174, "link": "https://stackoverflow.com/questions/29593174/in-go-given-a-location-name-how-can-we-determine-the-current-time-in-that-loca", "closed_reason": "Not suitable for this site", "title": "In Go, given a location name, how can we determine the current time in that location?", "body": "<p>We can't use the offset returned by Zone():</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"time\"\n\nfunc main() {\n    loc, _ := time.LoadLocation(\"America/Los_Angeles\")\n    t := time.Date(2015,04,12,19,23,0,0,loc)\n    t2 := time.Date(2015,03,1,19,23,0,0,loc)\n    _, offset := t.Zone()\n    _, offset2 := t.Zone()\n    fmt.Printf(\"t1: %v  offset: %d\\n\", t, offset)\n    fmt.Printf(\"t2: %v  offset: %d\\n\", t2, offset2)\n}\n</code></pre>\n\n<p>This returns:</p>\n\n<pre><code>t1: 2015-04-12 19:23:00 -0700 PDT  offset: -25200\nt2: 2015-03-01 19:23:00 -0800 PST  offset: -25200\n</code></pre>\n\n<p>The offset does not reflect daylight savings. \nIs parsing manually the offset after formatting a time instance the only option (-0700 and -0800)?</p>\n\n<p>We can retrieve the current time with time.Now(), but using .In() simply changes the location without adjusting the hours and minutes.</p>\n"}, {"tags": ["regex", "go", "regex-group"], "comments": [{"owner": {"reputation": 132964, "user_id": 171318, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ePRKy.jpg?s=128&g=1", "display_name": "hek2mgl", "link": "https://stackoverflow.com/users/171318/hek2mgl"}, "edited": false, "score": 1, "creation_date": 1428858298, "post_id": 29592050, "comment_id": 47331110, "body": "Which regex engine are you using?"}, {"owner": {"reputation": 78861, "user_id": 561309, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/6d833d9f0ffa2265a01359ccecd26d54?s=128&d=identicon&r=PG&f=1", "display_name": "laurent", "link": "https://stackoverflow.com/users/561309/laurent"}, "reply_to_user": {"reputation": 132964, "user_id": 171318, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ePRKy.jpg?s=128&g=1", "display_name": "hek2mgl", "link": "https://stackoverflow.com/users/171318/hek2mgl"}, "edited": false, "score": 0, "creation_date": 1428858555, "post_id": 29592050, "comment_id": 47331211, "body": "Golang regexp - <a href=\"http://golang.org/pkg/regexp\" rel=\"nofollow noreferrer\">golang.org/pkg/regexp</a>"}, {"owner": {"reputation": 78861, "user_id": 561309, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/6d833d9f0ffa2265a01359ccecd26d54?s=128&d=identicon&r=PG&f=1", "display_name": "laurent", "link": "https://stackoverflow.com/users/561309/laurent"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1428944878, "post_id": 29592050, "comment_id": 47367610, "body": "@DaveC , any question can be answered by reading such or such book or documentation. But if you don&#39;t know what you are looking for to begin with (in this case the keyword, as I&#39;ve just learnt, was &quot;non-capturing group&quot;), then you are still stuck."}], "answers": [{"tags": [], "owner": {"reputation": 6898, "user_id": 2012487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9631fa1981d36a3b5f71426c821a8064?s=128&d=identicon&r=PG", "display_name": "Aguardientico", "link": "https://stackoverflow.com/users/2012487/aguardientico"}, "is_accepted": false, "score": 2, "last_activity_date": 1428858185, "creation_date": 1428858185, "answer_id": 29592079, "question_id": 29592050, "link": "https://stackoverflow.com/questions/29592050/how-to-express-match-a-word-or-another-without-creating-a-group/29592079#29592079", "title": "How to express &quot;match a word or another&quot; without creating a group?", "body": "<p>You can use <code>?:</code> to prevent group creation so please give a try to:</p>\n\n<p><code>{{location(?: dec| other|)</code></p>\n"}, {"comments": [{"owner": {"reputation": 362892, "user_id": 256196, "user_type": "moderator", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d84b558fd67be10d5a718fb94231909d?s=128&d=identicon&r=PG", "display_name": "Bohemian", "link": "https://stackoverflow.com/users/256196/bohemian"}, "reply_to_user": {"reputation": 65435, "user_id": 2206004, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCB1e.png?s=128&g=1", "display_name": "hwnd", "link": "https://stackoverflow.com/users/2206004/hwnd"}, "edited": false, "score": 1, "creation_date": 1428858656, "post_id": 29592090, "comment_id": 47331252, "body": "@hwnd depends where you&#39;re running it. In most (all?) app languages, no. On Linux command line, yes."}], "tags": [], "owner": {"reputation": 362892, "user_id": 256196, "user_type": "moderator", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d84b558fd67be10d5a718fb94231909d?s=128&d=identicon&r=PG", "display_name": "Bohemian", "link": "https://stackoverflow.com/users/256196/bohemian"}, "is_accepted": true, "score": 4, "last_activity_date": 1428858372, "last_edit_date": 1428858372, "creation_date": 1428858231, "answer_id": 29592090, "question_id": 29592050, "link": "https://stackoverflow.com/questions/29592050/how-to-express-match-a-word-or-another-without-creating-a-group/29592090#29592090", "title": "How to express &quot;match a word or another&quot; without creating a group?", "body": "<p>You need a group, but you can make it a non-capturing group by adding <code>?:</code> after the opening bracket:</p>\n\n<pre><code>(?: dec| other|)\n</code></pre>\n\n<p>Non-capturing means the group exists just for the expression; no back references are possible and group numbering is unaffected.</p>\n"}], "owner": {"reputation": 78861, "user_id": 561309, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/6d833d9f0ffa2265a01359ccecd26d54?s=128&d=identicon&r=PG&f=1", "display_name": "laurent", "link": "https://stackoverflow.com/users/561309/laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 29592090, "answer_count": 2, "score": 1, "last_activity_date": 1428858583, "creation_date": 1428858051, "last_edit_date": 1428858583, "question_id": 29592050, "link": "https://stackoverflow.com/questions/29592050/how-to-express-match-a-word-or-another-without-creating-a-group", "title": "How to express &quot;match a word or another&quot; without creating a group?", "body": "<p>I'm trying to match this kind of strings with a regular expression:</p>\n\n<pre><code>{{location|\n{{location dec|\n{{location other|\n</code></pre>\n\n<p>so I came up with this regular expression:</p>\n\n<pre><code>{{location( dec| other|)\n</code></pre>\n\n<p>which works fine, however it's creating a group at <code>( dec|)</code>, which I don't need. Is there any way to do the same thing but without creating a group?</p>\n"}, {"tags": ["go", "mandrill"], "answers": [{"tags": [], "owner": {"reputation": 67, "user_id": 2652329, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd8e5e6271f53ad83222a6785028dc10?s=128&d=identicon&r=PG", "display_name": "Ernie", "link": "https://stackoverflow.com/users/2652329/ernie"}, "is_accepted": false, "score": 1, "last_activity_date": 1428855467, "creation_date": 1428855467, "answer_id": 29591611, "question_id": 29588125, "link": "https://stackoverflow.com/questions/29588125/mandrill-api-with-handlebars-each-loop-not-working/29591611#29591611", "title": "Mandrill API with Handlebars &quot;each-loop&quot; not working", "body": "<p>After testing with Mandrill's sample code <a href=\"http://blog.mandrill.com/handlebars-for-templates-and-dynamic-content.html\" rel=\"nofollow\">here</a> I found the key \"title\" just doesn't work. Dunno the reason (a reserved keyword of Mandrill?) but replace it with \"title1\", \"titleX\" or something else it can be rendered correctly.</p>\n\n<pre><code>{\n    \"name\": \"posts\",\n    \"content\": [\n        {\n           \"title\": \"blah blah\"  // \"title1\" or something else works\n        },\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 1795615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/562597cc0a4da66baeb3dd199b6205f3?s=128&d=identicon&r=PG", "display_name": "OptimusPrime", "link": "https://stackoverflow.com/users/1795615/optimusprime"}, "is_accepted": false, "score": 1, "last_activity_date": 1437744329, "creation_date": 1437744329, "answer_id": 31611755, "question_id": 29588125, "link": "https://stackoverflow.com/questions/29588125/mandrill-api-with-handlebars-each-loop-not-working/31611755#31611755", "title": "Mandrill API with Handlebars &quot;each-loop&quot; not working", "body": "<p>while using handlebars as the merge language 'title' is the reserved helpername which is used in handlebars which makes your text in title case. If you do only {{title}} by default it considers as title the empty text. try giving it {{title title}} which should work or changing the key name to something else ( if you dont want your title in title case ) </p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 1957253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7901b1225a9d7e52e6c468ca2bfedd4d?s=128&d=identicon&r=PG", "display_name": "Gagan Lamba", "link": "https://stackoverflow.com/users/1957253/gagan-lamba"}, "is_accepted": false, "score": 1, "last_activity_date": 1438345885, "creation_date": 1438345885, "answer_id": 31746293, "question_id": 29588125, "link": "https://stackoverflow.com/questions/29588125/mandrill-api-with-handlebars-each-loop-not-working/31746293#31746293", "title": "Mandrill API with Handlebars &quot;each-loop&quot; not working", "body": "<p><a href=\"https://mandrill.zendesk.com/hc/en-us/articles/205582537-Using-Handlebars-for-dynamic-content\" rel=\"nofollow\">https://mandrill.zendesk.com/hc/en-us/articles/205582537-Using-Handlebars-for-dynamic-content</a>\nUse this link to use handle bars in your code its so easy with global variables.</p>\n"}, {"tags": [], "owner": {"reputation": 4828, "user_id": 2760030, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2bc406a8db5e2033d30f72a9c9ebce38?s=128&d=identicon&r=PG&f=1", "display_name": "fuzzybabybunny", "link": "https://stackoverflow.com/users/2760030/fuzzybabybunny"}, "is_accepted": false, "score": 3, "last_activity_date": 1457437173, "creation_date": 1457437173, "answer_id": 35866364, "question_id": 29588125, "link": "https://stackoverflow.com/questions/29588125/mandrill-api-with-handlebars-each-loop-not-working/35866364#35866364", "title": "Mandrill API with Handlebars &quot;each-loop&quot; not working", "body": "<p>Mandrill decided to create custom handlebars helpers with some horrible, HORRIBLE names:</p>\n\n<p><a href=\"https://mandrill.zendesk.com/hc/en-us/articles/205582537-Using-Handlebars-for-Dynamic-Content#inline-helpers-available-in-mandrill\" rel=\"nofollow\">https://mandrill.zendesk.com/hc/en-us/articles/205582537-Using-Handlebars-for-Dynamic-Content#inline-helpers-available-in-mandrill</a></p>\n\n<p><code>title</code> and <code>url</code> will definitely give you grief if your objects happen to have keys named <code>title</code> and <code>url</code>as well. Why they didn't name their helpers something like <code>toTitleCase</code> and <code>encodeUrl</code> is beyond me.</p>\n\n<p>As far as arrays and <code>#each</code> is concerned, you can work around it by using <code>{{this.title}}</code> instead of <code>{{title}}</code>.</p>\n"}], "owner": {"reputation": 67, "user_id": 2652329, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd8e5e6271f53ad83222a6785028dc10?s=128&d=identicon&r=PG", "display_name": "Ernie", "link": "https://stackoverflow.com/users/2652329/ernie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4374, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1457437173, "creation_date": 1428832394, "last_edit_date": 1428851722, "question_id": 29588125, "link": "https://stackoverflow.com/questions/29588125/mandrill-api-with-handlebars-each-loop-not-working", "title": "Mandrill API with Handlebars &quot;each-loop&quot; not working", "body": "<p>Met problem when using Mandrill API to send transactional newsletters. I chose Handlebars for the template parameters. The user name was shown correctly, but data in the list (post titles) were empty. Please help indicate if anything I did wrong. Thank you!</p>\n\n<p>The template is as below, sent to the endpoint <code>/messages/send.json</code> :</p>\n\n<pre><code>func genHTMLTemplate() string {\n    return \"code generated template&lt;br&gt;\" +\n        \"Hi {{name}}, &lt;br&gt;\" + \n        \"{{#each posts}}&lt;div&gt;\" +\n        \"TITLE {{title}}, THIS {{this}}&lt;br&gt;\" +\n        \"&lt;/div&gt;{{/each}}\"\n}\n</code></pre>\n\n<p>The API log in my Settings panel in mandrillapp.com shows the parameters:</p>\n\n<pre><code>{\n\"key\": \"xxxxxxxxxx\",\n\"message\": {\n        :\n    \"merge_language\": \"handlebars\",\n    \"global_merge_vars\": null,\n    \"merge_vars\": [\n        {\n            \"rcpt\": \"xxxxxx@gmail.com\",\n            \"vars\": [\n                {\n                    \"name\": \"posts\",\n                    \"content\": [\n                        {\n                            \"title\": \"title A\"\n                        },\n                        {\n                            \"title\": \"title B\"\n                        },\n                    ]\n                },\n                {\n                    \"name\": \"name\",\n                    \"content\": \"John Doe\"\n                }\n            ]\n        }\n    ],\n      :\n    },\n    :\n}\n</code></pre>\n\n<p>And below is the email received. \"title A\" and \"title B\" are expected after \"TITLE\".</p>\n\n<pre><code>code generated template\nHi John Doe,\nTITLE, THIS Array\nTITLE, THIS Array\n</code></pre>\n"}, {"tags": ["mysql", "go", "google-cloud-sql"], "comments": [{"owner": {"reputation": 6960, "user_id": 79849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5f986018993d9f078927fe29ee912cf2?s=128&d=identicon&r=PG", "display_name": "cflewis", "link": "https://stackoverflow.com/users/79849/cflewis"}, "edited": false, "score": 0, "creation_date": 1428835991, "post_id": 29587973, "comment_id": 47324489, "body": "What happens if you add the tcp protocol in the DSN?  e.g. User:pass@tcp(123.123.123.123:3306)/dbname ? What happens if you don&#39;t specify the dbname?"}, {"owner": {"reputation": 16814, "user_id": 3849456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AonOf.jpg?s=128&g=1", "display_name": "Anzel", "link": "https://stackoverflow.com/users/3849456/anzel"}, "edited": false, "score": 0, "creation_date": 1428836952, "post_id": 29587973, "comment_id": 47324735, "body": "Don&#39;t you need <code>cloudsql:instance-name*...</code> to expose the access of database? Read <a href=\"https://cloud.google.com/appengine/docs/go/cloud-sql/reference\" rel=\"nofollow noreferrer\">this</a> and it may be useful."}, {"owner": {"reputation": 1265, "user_id": 2215912, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f014888a1bf93036790f22dcabf77b6b?s=128&d=identicon&r=PG", "display_name": "avellable", "link": "https://stackoverflow.com/users/2215912/avellable"}, "reply_to_user": {"reputation": 16814, "user_id": 3849456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AonOf.jpg?s=128&g=1", "display_name": "Anzel", "link": "https://stackoverflow.com/users/3849456/anzel"}, "edited": false, "score": 0, "creation_date": 1428849173, "post_id": 29587973, "comment_id": 47328115, "body": "@Anzel I tried doing that too. It won&#39;t work on dev i.e. my local. It works when I upload it to app engine."}, {"owner": {"reputation": 1265, "user_id": 2215912, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f014888a1bf93036790f22dcabf77b6b?s=128&d=identicon&r=PG", "display_name": "avellable", "link": "https://stackoverflow.com/users/2215912/avellable"}, "reply_to_user": {"reputation": 6960, "user_id": 79849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5f986018993d9f078927fe29ee912cf2?s=128&d=identicon&r=PG", "display_name": "cflewis", "link": "https://stackoverflow.com/users/79849/cflewis"}, "edited": false, "score": 0, "creation_date": 1428849295, "post_id": 29587973, "comment_id": 47328158, "body": "@cflewis with protocol it says bad connection."}, {"owner": {"reputation": 16814, "user_id": 3849456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AonOf.jpg?s=128&g=1", "display_name": "Anzel", "link": "https://stackoverflow.com/users/3849456/anzel"}, "edited": false, "score": 0, "creation_date": 1428849407, "post_id": 29587973, "comment_id": 47328207, "body": "@user2215912, I remember on cloudsql you may need to whitelist your IPs (so you need to include your local dev IP), otherwise the connection will be refused."}, {"owner": {"reputation": 1265, "user_id": 2215912, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f014888a1bf93036790f22dcabf77b6b?s=128&d=identicon&r=PG", "display_name": "avellable", "link": "https://stackoverflow.com/users/2215912/avellable"}, "reply_to_user": {"reputation": 16814, "user_id": 3849456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AonOf.jpg?s=128&g=1", "display_name": "Anzel", "link": "https://stackoverflow.com/users/3849456/anzel"}, "edited": false, "score": 0, "creation_date": 1428849526, "post_id": 29587973, "comment_id": 47328253, "body": "@Anzel I did that too"}, {"owner": {"reputation": 16814, "user_id": 3849456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AonOf.jpg?s=128&g=1", "display_name": "Anzel", "link": "https://stackoverflow.com/users/3849456/anzel"}, "edited": false, "score": 0, "creation_date": 1428850233, "post_id": 29587973, "comment_id": 47328470, "body": "@user2215912, I am also new to Go so I&#39;m afraid I cannot help you further as I have cloudsql experience with Python but not with Go."}, {"owner": {"reputation": 16814, "user_id": 3849456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AonOf.jpg?s=128&g=1", "display_name": "Anzel", "link": "https://stackoverflow.com/users/3849456/anzel"}, "edited": false, "score": 0, "creation_date": 1428850288, "post_id": 29587973, "comment_id": 47328490, "body": "You may be interested in this <a href=\"http://stackoverflow.com/questions/21368363/how-to-connect-to-google-cloud-sql-with-go-sql-driver-mysql-on-app-engine\">SO</a>, if you haven&#39;t read it already"}], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 1, "last_activity_date": 1433804766, "creation_date": 1433804766, "answer_id": 30720510, "question_id": 29587973, "link": "https://stackoverflow.com/questions/29587973/bad-http-response-from-google-cloudsql/30720510#30720510", "title": "bad HTTP response from Google CloudSQL", "body": "<p>I don't think your error has anything to do with the SQL driver. If you read the message it is arising from the http packages server code, not from anything having to do with your SQL connection/reading/writing ect. Looking at your code and comparing it to basic examples I'm fairly sure your error is due to lack of this line in main; <code>http.ListenAndServe(\":8080\", nil)</code></p>\n\n<p>Basically, change your main to</p>\n\n<pre><code>func main() {\n    http.HandleFunc(\"/\", handler)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>And that error will probably go away. Disclaimer; that doesn't mean your program will magically work, only that it will <em>never</em> work without it.</p>\n"}], "owner": {"reputation": 1265, "user_id": 2215912, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f014888a1bf93036790f22dcabf77b6b?s=128&d=identicon&r=PG", "display_name": "avellable", "link": "https://stackoverflow.com/users/2215912/avellable"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1433804766, "creation_date": 1428831183, "question_id": 29587973, "link": "https://stackoverflow.com/questions/29587973/bad-http-response-from-google-cloudsql", "title": "bad HTTP response from Google CloudSQL", "body": "<p>I'm trying hand at Google Cloud SQL using go-sql-driver. I'm stuck here I don't know whats wrong here. This error is totally unknown for me.</p>\n\n<pre><code>package hello\n\nimport (\n  \"fmt\"\n  \"net/http\"\n  \"database/sql\"\n  _ \"github.com/go-sql-driver/mysql\"\n)\n\nfunc init() {\n  http.HandleFunc(\"/\", handler)\n}\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n\n  const dbUserName = \"userName\"\n  const dbPassword = \"password\"\n  const dbIP = \"123.123.231.123\"\n\n  db, err := sql.Open(\"mysql\",  dbUserName+\":\"+dbPassword+\"@\"+dbIP+\":3306/user\")\n\n\n  if err != nil {\n    panic(err.Error()) \n  }\n\n\n  // Query the name \n  rows, err := db.Query(\"SELECT * FROM user\")\n  if err != nil {\n    panic(err.Error()) \n  }\n\n  fmt.Println(rows)\n\n  defer db.Close()\n}\n</code></pre>\n\n<p>ERROR: </p>\n\n<pre><code> the runtime process gave a bad HTTP response: ''\n\n 2015/04/12 09:23:36 http: panic serving 127.0.0.1:50091: Default addr  for network '173.194.106.126:3306' unknown\n goroutine 6 [running]:\n net/http.func\u00c2\u00b7011()\n /private/var/folders/00/0v42r000h01000cxqpysvccm003chb/T/appengine/go_appengine/goroot/src/net/http/server.go:1130 +0xbb\n main37089.handler(0x5ad1e0, 0xc208044280, 0xc2080331e0)\n</code></pre>\n\n<p>Any ideas. Looking at source of go-sql-driver source maybe I should set a default address?</p>\n"}, {"tags": ["sql", "go", "sqlx"], "answers": [{"comments": [{"owner": {"reputation": 3480, "user_id": 164137, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/95614a2721a6f2bec5eeabc0de04fa4f?s=128&d=identicon&r=PG", "display_name": "Amos Shapira", "link": "https://stackoverflow.com/users/164137/amos-shapira"}, "edited": false, "score": 0, "creation_date": 1428826413, "post_id": 29586823, "comment_id": 47322316, "body": "Yep, I thought about this option too. It also has the advantage of not testing the prepared statement being initialized every time the method is called. But it also separates the initialisation from the use and looks a bit quirky. I&#39;d rather try to find something more elegant if possible."}, {"owner": {"reputation": 3480, "user_id": 164137, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/95614a2721a6f2bec5eeabc0de04fa4f?s=128&d=identicon&r=PG", "display_name": "Amos Shapira", "link": "https://stackoverflow.com/users/164137/amos-shapira"}, "edited": false, "score": 0, "creation_date": 1428869209, "post_id": 29586823, "comment_id": 47334872, "body": "Thanks. I&#39;ll have to study this (I&#39;m a Go noob) and see how well it works for me."}], "tags": [], "owner": {"reputation": 5488, "user_id": 1078890, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Dqula.jpg?s=128&g=1", "display_name": "IamNaN", "link": "https://stackoverflow.com/users/1078890/iamnan"}, "is_accepted": false, "score": 2, "last_activity_date": 1428854548, "last_edit_date": 1428854548, "creation_date": 1428821457, "answer_id": 29586823, "question_id": 29586578, "link": "https://stackoverflow.com/questions/29586578/whats-the-recommended-way-to-initialize-and-keep-prepared-statements-in-go/29586823#29586823", "title": "What&#39;s the recommended way to initialize and keep prepared statements in Go?", "body": "<p>One way I have dealt with this is to initializes all the prepared statements I want to \"keep alive\" (i.e. those that are frequently used) in the main function and save them into a map which I then pass as an argument to the functions that need access to the prepared statements.</p>\n\n<p>This doesn't meet your requirement of being only accessible from the functions that actually use them, but it does avoid globals and prevents having to re-prepare them when they are needed.</p>\n\n<p>Using closures you could do something like this:</p>\n\n<pre><code>func main() {\n\n    // initialize your database etc.\n    getData, stmt := initGetData(db) // db is *sql.DB, initGetData is the function below\n    defer stmt.Close()\n    myResult := getData()\n}\n\nfunc initGetData(db *sql.DB) ((func() string), *sql.Stmt) {\n    stmt, err := db.Prepare(\"SELECT something FROM some_table\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    return func() string {\n        var result string\n        err := stmt.QueryRow().Scan(&amp;result)\n        if err != nil {\n            log.Fatal(err)\n        }\n        return result\n    }, stmt\n}\n</code></pre>\n\n<p>Doing it like this you have the prepared statement with your function that makes the query. But the statement is prepared only when the initGetData() function is called which returns the closure. The closure runs the query and has access to the prepared statement that was created when myQuery was called.</p>\n\n<p>You then simply use getData() every time you need to run the query. This would meet your requirements.</p>\n"}], "owner": {"reputation": 3480, "user_id": 164137, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/95614a2721a6f2bec5eeabc0de04fa4f?s=128&d=identicon&r=PG", "display_name": "Amos Shapira", "link": "https://stackoverflow.com/users/164137/amos-shapira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 685, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1428854548, "creation_date": 1428819359, "question_id": 29586578, "link": "https://stackoverflow.com/questions/29586578/whats-the-recommended-way-to-initialize-and-keep-prepared-statements-in-go", "title": "What&#39;s the recommended way to initialize and keep prepared statements in Go?", "body": "<p>I'm writing my first Go project using <a href=\"https://godoc.org/github.com/jmoiron/sqlx\" rel=\"noreferrer\">sqlx</a> and want to use Prepared statements.</p>\n\n<p>I'm not sure what's the recommended practice to initialise and keep the Prepared statement variables in a nice manageable way.</p>\n\n<p>I want them to be accessible only from the part of the code which actually has to use them, so far each statement is used by a single function, so global variables are not a good option (besides generally being frowned upon).</p>\n\n<p>In C/C++ I would probably use a function static variable and initialise it the first time that the function is entered. This way the information about the statement content and the call which uses it are close to each other.</p>\n\n<p>But from what I know so far there is no \"method static variables\" in Go, so what's the alternative?</p>\n\n<p>I found references to Closures, which are anonymous functions, but is this the best way to achieve this? Am I aiming for the right thing from perspective of \"prepared statements best practices\"?</p>\n"}, {"tags": ["windows", "image", "go"], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 2339146, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/G6Qcx.jpg?s=128&g=1", "display_name": "n.r", "link": "https://stackoverflow.com/users/2339146/n-r"}, "edited": false, "score": 1, "creation_date": 1477719727, "post_id": 29593766, "comment_id": 67889636, "body": "After a lot of googling, this seems to be the only easy way."}, {"owner": {"reputation": 313, "user_id": 8626433, "user_type": "registered", "profile_image": "https://graph.facebook.com/1276251982503903/picture?type=large", "display_name": "Damitha Dayananda", "link": "https://stackoverflow.com/users/8626433/damitha-dayananda"}, "edited": false, "score": 1, "creation_date": 1590772731, "post_id": 29593766, "comment_id": 109817765, "body": "Now gl library is no longer maintaining, so don&#39;t use this code anymore"}], "tags": [], "owner": {"reputation": 101, "user_id": 4766802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3868ed7724b918d2630b3cc1d475ed5?s=128&d=identicon&r=PG", "display_name": "francisc", "link": "https://stackoverflow.com/users/4766802/francisc"}, "is_accepted": false, "score": 10, "last_activity_date": 1428867425, "creation_date": 1428867425, "answer_id": 29593766, "question_id": 29585727, "link": "https://stackoverflow.com/questions/29585727/how-to-display-an-image-on-windows-with-go/29593766#29593766", "title": "How to display an image on Windows with Go?", "body": "<p>There is an image viewer sample in the package <a href=\"https://github.com/google/gxui\" rel=\"noreferrer\">gxui</a>, it shows an image selected from command line frags. The result can be seen <a href=\"http://i.imgur.com/BmRr6DX.png\" rel=\"noreferrer\">here</a>. It is likely one of the simpler approaches to present this gui using go.</p>\n\n<p>Beware that gxui is experiental and future updates might break your code.</p>\n\n<p>For your request, the code would be the following. It yields a window showing your image, a full blue image.</p>\n\n<pre><code>package main\n\nimport (\n    \"image\"\n    \"image/color\"\n    \"image/draw\"\n\n    \"github.com/google/gxui\"\n    \"github.com/google/gxui/drivers/gl\"\n    \"github.com/google/gxui/themes/dark\"\n)\n\nfunc appMain(driver gxui.Driver) {\n    width, height := 640, 480\n    m := image.NewRGBA(image.Rect(0, 0, width, height))\n    blue := color.RGBA{0, 0, 255, 255}\n    draw.Draw(m, m.Bounds(), &amp;image.Uniform{blue}, image.ZP, draw.Src)\n\n    // The themes create the content. Currently only a dark theme is offered for GUI elements.\n    theme := dark.CreateTheme(driver)\n    img := theme.CreateImage()\n    window := theme.CreateWindow(width, height, \"Image viewer\")\n    texture := driver.CreateTexture(m, 1.0)\n    img.SetTexture(texture)\n    window.AddChild(img)\n    window.OnClose(driver.Terminate)\n}\n\nfunc main() {\n    gl.StartDriver(appMain)\n}\n</code></pre>\n\n<p>I confirm this works on Windows and Linux. It likely works on MacOSX.</p>\n\n<p>You might want to look into a more stable package if this is for production. For example go-qml or go-qt5 as mentioned by ComputerFellow</p>\n"}], "owner": {"reputation": 3378, "user_id": 2069150, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/filKc.jpg?s=128&g=1", "display_name": "Arch D. Robison", "link": "https://stackoverflow.com/users/2069150/arch-d-robison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7364, "favorite_count": 4, "answer_count": 1, "score": 9, "last_activity_date": 1428875275, "creation_date": 1428810374, "last_edit_date": 1428875275, "question_id": 29585727, "link": "https://stackoverflow.com/questions/29585727/how-to-display-an-image-on-windows-with-go", "title": "How to display an image on Windows with Go?", "body": "<p>What's the easiest way for a Go program to display an image on Windows?  I have this fragment based on a tutorial:</p>\n\n<pre><code>package main\n\nimport (\n    \"image\" \n    \"image/color\" \n    \"image/draw\" \n)\n\nfunc main() {\n    m := image.NewRGBA(image.Rect(0, 0, 640, 480))\n    blue := color.RGBA{0, 0, 255, 255}\n    draw.Draw(m, m.Bounds(), &amp;image.Uniform{blue}, image.ZP, draw.Src)\n}\n</code></pre>\n\n<p>But how to I display the object m?  I'd like to pop up a window and display the image there, not write it out to a file first.</p>\n"}, {"tags": ["loops", "go"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1428875367, "post_id": 29585423, "comment_id": 47336956, "body": "You shouldn&#39;t care too much about how many variables you use. Any other way to implement this loop is going to use a counter anyway."}], "answers": [{"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": false, "score": 8, "last_activity_date": 1459963311, "last_edit_date": 1459963311, "creation_date": 1428807340, "answer_id": 29585472, "question_id": 29585423, "link": "https://stackoverflow.com/questions/29585423/loop-without-allocation-in-go/29585472#29585472", "title": "Loop without allocation in Go", "body": "<p>Nothing in that code requires <code>i</code> to be allocated on the heap. It's likely either on the stack, freed when it goes out of scope, or in a register, and in either case not creating garbage. (If you're curious about how this is possible, the technique is called <a href=\"https://en.wikipedia.org/wiki/Escape_analysis\" rel=\"nofollow\">escape analysis</a>.)\nYou can see it in <a href=\"http://play.golang.org/p/UnA10lM2oP\" rel=\"nofollow\">how TotalAlloc doesn't increase in this sample program</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"runtime\"\n)\n\nfunc loop() {\n    for i := 0; i &lt; 500; i++ {\n    }\n}\n\nfunc main() {\n    m1, m2 := new(runtime.MemStats), new(runtime.MemStats)\n    runtime.ReadMemStats(m1)\n    loop()\n    runtime.ReadMemStats(m2)\n    fmt.Println(\"TotalAlloc delta was\", m2.TotalAlloc - m1.TotalAlloc)\n}\n</code></pre>\n\n<p>A counter's necessary to make sure you do 500 iterations of a loop one way or the other, so even if you found some way to make the counter implied (<code>r := make([]struct{}, 500); for range r {...}</code>, say), there'd be no variable name but still be a counter under the covers.</p>\n"}, {"comments": [{"owner": {"reputation": 2211, "user_id": 3243814, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/538d7f03357c8012445b79c7ee129aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Etienne Bruines", "link": "https://stackoverflow.com/users/3243814/etienne-bruines"}, "edited": false, "score": 4, "creation_date": 1428939150, "post_id": 29595050, "comment_id": 47364122, "body": "Or, since Go 1.4 <code>for range make([]struct{}, 500) { }</code>"}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": false, "score": 2, "last_activity_date": 1428875473, "creation_date": 1428875473, "answer_id": 29595050, "question_id": 29585423, "link": "https://stackoverflow.com/questions/29585423/loop-without-allocation-in-go/29595050#29595050", "title": "Loop without allocation in Go", "body": "<p>If you hate counters, you can use this:</p>\n\n<pre><code>for _ = range make([]struct{}, 500) {\n    PlayRandomGame()\n}\n</code></pre>\n\n<p>But the variant with a counter is more idiomatic.</p>\n"}], "owner": {"reputation": 48731, "user_id": 329700, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/41910a452554b187d044c00c576866b1?s=128&d=identicon&r=PG", "display_name": "Kevin Burke", "link": "https://stackoverflow.com/users/329700/kevin-burke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1459963311, "creation_date": 1428806836, "question_id": 29585423, "link": "https://stackoverflow.com/questions/29585423/loop-without-allocation-in-go", "title": "Loop without allocation in Go", "body": "<p>In Go, if I want to do something 500 times, but I don't need to use the index, is there a way to loop without allocating an integer?</p>\n\n<p>Like:</p>\n\n<pre><code>for i := 0; i &lt; 500; i++ {\n    PlayRandomGame()\n}\n</code></pre>\n\n<p>I don't need or want to allocate <code>i</code> there.</p>\n"}, {"tags": ["arrays", "pointers", "go"], "answers": [{"tags": [], "owner": {"reputation": 43554, "user_id": 727643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIm6q.jpg?s=128&g=1", "display_name": "Stephen Weinberg", "link": "https://stackoverflow.com/users/727643/stephen-weinberg"}, "is_accepted": true, "score": 6, "last_activity_date": 1428809723, "last_edit_date": 1428809723, "creation_date": 1428806213, "answer_id": 29585356, "question_id": 29585242, "link": "https://stackoverflow.com/questions/29585242/unsafe-pointers-in-go-function-call-end-kills-array/29585356#29585356", "title": "unsafe Pointers in Go: function call end kills array", "body": "<p>First of all, unsafe is usually a bad idea. So is reflection, but unsafe is at least an order of magnitude worse.</p>\n\n<p>Here is your example using pure reflection (<a href=\"http://play.golang.org/p/jTJ6Mhg8q9\" rel=\"nofollow\">http://play.golang.org/p/jTJ6Mhg8q9</a>):</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"reflect\"\n)\n\nfunc main() {\n    var x []string\n    log.Printf(\"before: %v, %p\", x, x)\n    manipulate(&amp;x)\n    log.Printf(\"after: %v, %p\", x, x)\n}\n\nfunc manipulate(target interface{}) {\n    t := reflect.Indirect(reflect.ValueOf(target))\n    t.Set(reflect.Append(t, reflect.ValueOf(\"Hello\"), reflect.ValueOf(\"World\")))\n}\n</code></pre>\n\n<hr>\n\n<p>So, why didn't your unsafe way work? Unsafe is extremely tricky and at times requires understanding the internals. First, some misconceptions you have:</p>\n\n<ol>\n<li><p>You are using arrays: you are not, you are using slices. Slices are a view of an array. They contain within them a pointer to the data, a length, and a capacity. They are stucts internally and not pure pointers.</p></li>\n<li><p>Pointer returns the pointer only if it is a pointer: it can actually return a value for many types like a slice. \nFrom <a href=\"http://golang.org/pkg/reflect/#Value.Pointer\" rel=\"nofollow\">http://golang.org/pkg/reflect/#Value.Pointer</a>:</p>\n\n<blockquote>\n  <p>If v's Kind is Slice, the returned pointer is to the first element of the slice. If the slice is nil the returned value is 0. If the slice is empty but non-nil the return value is non-zero.</p>\n</blockquote></li>\n<li><p>Arrays are pointers: in Go, arrays are actually values. That means they are copied when passed to other functions or assigned. It also means the .Pointer method wouldn't work.</p></li>\n</ol>\n\n<p>You are assigning a pointer to an array to a slice type. By luck, the implementation of slices used internally has the data pointer first so you are actually setting the internal array pointer used by the slice. I must stress that is is effectively pure accident. Even still, you are not setting the length and capacity of the slice so it still prints zero elements.</p>\n\n<p>Unsafe lets you do things at such a low level that the actual results aren't really defined. It is best to stay away from it unless you really know what you are doing. Even then, be aware that things can can change and what works today may not work in the next version of Go or another implementation.</p>\n"}], "owner": {"reputation": 2134, "user_id": 1527244, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/82b81a8c0375cf62e749e2b48fc553e6?s=128&d=identicon&r=PG", "display_name": "Danyel", "link": "https://stackoverflow.com/users/1527244/danyel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 29585356, "answer_count": 1, "score": -1, "last_activity_date": 1428809723, "creation_date": 1428805213, "last_edit_date": 1428805571, "question_id": 29585242, "link": "https://stackoverflow.com/questions/29585242/unsafe-pointers-in-go-function-call-end-kills-array", "title": "unsafe Pointers in Go: function call end kills array", "body": "<p>I'm writing a library and I want to return an array (or write to an array) of an unspecific type to the caller. The type can vary, depending on who calls - I can, however, create as many objects of said type from within my function. One way would be that the caller creates an array and the callee fills that - however, there is no way of telling how long this array is going to be. (Is there a way that the callee makes the caller's array bigger? Remember, the callee only sees <code>x interface{}</code>...)</p>\n\n<p>The other way which I chose because I don't see how above is possible, is that the caller gives me the pointer of his specific type and I redirect it to the array of objects which I created.</p>\n\n<p>Below is my solution. My question: why is the array empty after the function call? They are pointing to the same array after my operation, they should be the same. Am I overlooking something? I thought about GC, but it couldn't be that fast, could it?</p>\n\n<p><a href=\"http://play.golang.org/p/oVoPx5Nf84\" rel=\"nofollow\">http://play.golang.org/p/oVoPx5Nf84</a></p>\n\n<pre><code>package main\n\nimport \"unsafe\"\nimport \"reflect\"\nimport \"log\"\n\nfunc main() {\n    var x []string\n    log.Printf(\"before: %v, %p\", x, x)\n    manipulate(&amp;x)\n    log.Printf(\"after: %v, %p\", x, x)\n}\n\nfunc manipulate(target interface{}) {\n    new := make([]string, 0, 10)\n    new = append(new, \"Hello\", \"World\")\n    log.Printf(\"new: %v, %p\", new, new)\n    p := unsafe.Pointer(reflect.ValueOf(target).Pointer())\n    ptr := unsafe.Pointer(reflect.ValueOf(new).Pointer())\n    *(*unsafe.Pointer)(p) = ptr\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "edited": false, "score": 0, "creation_date": 1428802332, "post_id": 29584800, "comment_id": 47318169, "body": "This question has nothing to do with workspaces organization. Also, your example is different from one the you sent in the links."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 0, "last_activity_date": 1428800572, "creation_date": 1428800572, "answer_id": 29584800, "question_id": 29584650, "link": "https://stackoverflow.com/questions/29584650/package-naming-error-exporting-variable/29584800#29584800", "title": "Package naming: error exporting variable", "body": "<blockquote>\n  <p><a href=\"http://golang.org/doc/code.html\" rel=\"nofollow\">How to Write Go Code</a></p>\n  \n  <p><a href=\"http://golang.org/doc/code.html#Workspaces\" rel=\"nofollow\">Workspaces</a></p>\n  \n  <p>The go tool is designed to work with open source code maintained in\n  public repositories. Although you don't need to publish your code, the\n  model for how the environment is set up works the same whether you do\n  or not.</p>\n  \n  <p>Go code must be kept inside a workspace. A workspace is a directory\n  hierarchy with three directories at its root:</p>\n  \n  <ul>\n  <li>src contains Go source files organized into packages (one package per directory),</li>\n  <li>pkg contains package objects, and</li>\n  <li>bin contains executable commands. </li>\n  </ul>\n  \n  <p>The go tool builds source packages and installs the resulting binaries\n  to the pkg and bin directories.</p>\n  \n  <p>The src subdirectory typically contains multiple version control\n  repositories (such as for Git or Mercurial) that track the development\n  of one or more source packages.</p>\n  \n  <p>To give you an idea of how a workspace looks in practice, here's an\n  example:</p>\n\n<pre><code>bin/\n    hello                          # command executable\n    outyet                         # command executable\npkg/\n    linux_amd64/\n        github.com/golang/example/\n            stringutil.a           # package object\nsrc/\n    github.com/golang/example/\n        .git/                      # Git repository metadata\n  hello/\n      hello.go               # command source\n  outyet/\n      main.go                # command source\n      main_test.go           # test source\n  stringutil/\n      reverse.go             # package source\n      reverse_test.go        # test source\n</code></pre>\n  \n  <p>This workspace contains one repository (example) comprising two\n  commands (hello and outyet) and one library (stringutil).</p>\n  \n  <p>A typical workspace would contain many source repositories containing\n  many packages and commands. Most Go programmers keep all their Go\n  source code and dependencies in a single workspace.</p>\n</blockquote>\n\n<p>For the Go tools, all the Go source files for a Go package should be in the same directory.</p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 789792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a654ca76172d975a7ddc9a31b7ada4c?s=128&d=identicon&r=PG", "display_name": "cfchris", "link": "https://stackoverflow.com/users/789792/cfchris"}, "is_accepted": false, "score": 0, "last_activity_date": 1428811256, "creation_date": 1428811256, "answer_id": 29585806, "question_id": 29584650, "link": "https://stackoverflow.com/questions/29584650/package-naming-error-exporting-variable/29585806#29585806", "title": "Package naming: error exporting variable", "body": "<p>It is intentional. Packages in Go are imported using a directory path. So, \"animal\" and \"animal/dog\" are two different packages <em>even if you give them the same package name</em>.</p>\n\n<p>To demonstrate this, I wrote the following example set of files:</p>\n\n<pre><code>~/go/src/test/\n\u251c\u2500\u2500 animal\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 animal.go\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 dog\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 dog.go\n\u2514\u2500\u2500 test.go\n</code></pre>\n\n<p>animal/animal.go</p>\n\n<pre><code>package animal\n\ntype Species string\n</code></pre>\n\n<p>animal/dog/dog.go</p>\n\n<pre><code>package animal\n\n// In package \"animal\" importing a package \"animal\"\nimport \"test/animal\"\n\ntype Dog struct {\n    Species animal.Species\n    Breed   string\n}\n</code></pre>\n\n<p>test.go</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"test/animal/dog\"\n)\n\nfunc main() {\n    d := animal.Dog{}\n    fmt.Printf(\"%#v\", d)\n}\n</code></pre>\n\n<p>Notice that dog.go imports the \"test/animal\" package and references it as \"animal\".</p>\n\n<p>Furthermore notice that test.go imports \"test/animal/dog\" to get access to the \"Dog\" struct type. If it imports, \"test/animal\", the error (undefined: animal.Dog) is generated.</p>\n"}], "owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 2, "answer_count": 2, "score": -3, "last_activity_date": 1428811256, "creation_date": 1428799028, "question_id": 29584650, "link": "https://stackoverflow.com/questions/29584650/package-naming-error-exporting-variable", "title": "Package naming: error exporting variable", "body": "<p>I have a directory structure like this:</p>\n\n<pre><code>Animal/\n  dog/\n    chiwawa.go\n  rabbit.go\n</code></pre>\n\n<p>Both <code>chiwawa.go</code> and <code>rabbit.go</code> are packaged named: \"package animal\" at the top of the file. However when I try to use a variable <code>var Food = apple</code> from <code>chiwawa.go</code> in <code>rabbit.go</code>, I get error - <code>undefined: Food</code>. </p>\n\n<p>I don't have any problems when I place <code>chiwawa.go</code> directly under <code>Animal</code> without the <code>dog</code> directory.</p>\n\n<p>Is this intentional in Go? Can I work around this while retaining the package names and directory structure?</p>\n"}, {"tags": ["concurrency", "go", "parallel-processing"], "comments": [{"owner": {"reputation": 4244, "user_id": 230631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6123a5b692227ba088360863f392bf?s=128&d=identicon&r=PG", "display_name": "Jonatan Hedborg", "link": "https://stackoverflow.com/users/230631/jonatan-hedborg"}, "edited": false, "score": 0, "creation_date": 1428794435, "post_id": 29584052, "comment_id": 47316565, "body": "Maybe it&#39;s assumed that the first gopher will sometimes have to wait for the cart to return in order to start filling it, and adding another gopher will ensure there is always a cart in the first slot. It&#39;s not a very programmer-centric example in my opinion, so maybe it&#39;s best too not think to much about it ;)"}, {"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "reply_to_user": {"reputation": 4244, "user_id": 230631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6123a5b692227ba088360863f392bf?s=128&d=identicon&r=PG", "display_name": "Jonatan Hedborg", "link": "https://stackoverflow.com/users/230631/jonatan-hedborg"}, "edited": false, "score": 0, "creation_date": 1428795261, "post_id": 29584052, "comment_id": 47316761, "body": "@JonatanHedborg There is still only one cart. An empty cart being available at <i>all</i> times would not be possible even if there were two carts."}], "answers": [{"tags": [], "owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "is_accepted": false, "score": 1, "last_activity_date": 1428794813, "last_edit_date": 1428794813, "creation_date": 1428794508, "answer_id": 29584192, "question_id": 29584052, "link": "https://stackoverflow.com/questions/29584052/understanding-rob-pikes-book-incineration-example/29584192#29584192", "title": "Understanding Rob Pike&#39;s book incineration example", "body": "<p>The assumption is that the gopher carrying the <em>loaded</em> cart has to perform some kind of cleanup or communication after removing the books from the cart. Now he can do that <strong>while</strong> the other gopher carries the <em>empty</em> cart back. Therefore, the loading gopher doesn't have to wait as long for the cart to come back.</p>\n"}, {"comments": [{"owner": {"reputation": 5825, "user_id": 631051, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/88a9701bb32b465a3b8357a2aa092815?s=128&d=identicon&r=PG", "display_name": "Ellen Spertus", "link": "https://stackoverflow.com/users/631051/ellen-spertus"}, "edited": false, "score": 0, "creation_date": 1428952422, "post_id": 29586678, "comment_id": 47371865, "body": "Thank you, but I don&#39;t see how specialization would apply to threads (what the gophers represent)."}, {"owner": {"reputation": 9325, "user_id": 4931, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f4182656449e54bde861a02d6ef44ecd?s=128&d=identicon&r=PG", "display_name": "Michael Deardeuff", "link": "https://stackoverflow.com/users/4931/michael-deardeuff"}, "reply_to_user": {"reputation": 5825, "user_id": 631051, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/88a9701bb32b465a3b8357a2aa092815?s=128&d=identicon&r=PG", "display_name": "Ellen Spertus", "link": "https://stackoverflow.com/users/631051/ellen-spertus"}, "edited": false, "score": 0, "creation_date": 1429246137, "post_id": 29586678, "comment_id": 47517659, "body": "@espertus: code cache locality. Smaller (specialized) code is cached near the CPU that is running it"}, {"owner": {"reputation": 5825, "user_id": 631051, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/88a9701bb32b465a3b8357a2aa092815?s=128&d=identicon&r=PG", "display_name": "Ellen Spertus", "link": "https://stackoverflow.com/users/631051/ellen-spertus"}, "reply_to_user": {"reputation": 9325, "user_id": 4931, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f4182656449e54bde861a02d6ef44ecd?s=128&d=identicon&r=PG", "display_name": "Michael Deardeuff", "link": "https://stackoverflow.com/users/4931/michael-deardeuff"}, "edited": false, "score": 0, "creation_date": 1429287131, "post_id": 29586678, "comment_id": 47544270, "body": "@MichaelDeardeuff It could work the other way, with multiple threads running on a single processor knocking each other&#39;]"}, {"owner": {"reputation": 5825, "user_id": 631051, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/88a9701bb32b465a3b8357a2aa092815?s=128&d=identicon&r=PG", "display_name": "Ellen Spertus", "link": "https://stackoverflow.com/users/631051/ellen-spertus"}, "reply_to_user": {"reputation": 9325, "user_id": 4931, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f4182656449e54bde861a02d6ef44ecd?s=128&d=identicon&r=PG", "display_name": "Michael Deardeuff", "link": "https://stackoverflow.com/users/4931/michael-deardeuff"}, "edited": false, "score": 0, "creation_date": 1429287207, "post_id": 29586678, "comment_id": 47544317, "body": "@MichaelDeardeuff It could work either way, with multiple threads using the same cache knocking each other out.  In any case, I don&#39;t think it&#39;s what Rob Pike was referring to, since he made no mention of cache effects anywhere in the talk."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1428820178, "creation_date": 1428820178, "answer_id": 29586678, "question_id": 29584052, "link": "https://stackoverflow.com/questions/29584052/understanding-rob-pikes-book-incineration-example/29586678#29586678", "title": "Understanding Rob Pike&#39;s book incineration example", "body": "<p>Consider a round trip for a cart load.</p>\n\n<p>In the first case we have:</p>\n\n<ul>\n<li>One moving the filled cart to the incinerator (and later returning the empty cart).</li>\n</ul>\n\n<p>That is:</p>\n\n<ul>\n<li><p>Gopher 1: Move the filled cart to the incinerator.</p></li>\n<li><p>Gopher 1: Move the empty cart back to the pile.</p></li>\n</ul>\n\n<p>In the second case we have:</p>\n\n<ul>\n<li><p>One moving the filled cart to the incinerator.</p></li>\n<li><p>One moving the empty cart back to the pile.</p></li>\n</ul>\n\n<p>That is:</p>\n\n<ul>\n<li><p>Gopher 1: Move the filled cart to the incinerator.</p></li>\n<li><p>Gopher 1: Walk back to the pile with no cart.</p></li>\n<li><p>Gopher 2: Move the empty cart back to the pile.</p></li>\n<li><p>Gopher 2: Walk back to the incinerator with no cart.</p></li>\n</ul>\n\n<p>Although we have extra work, it may run faster for several reasons, for example, division of labor.</p>\n\n<blockquote>\n  <p>Of the Division of Labour</p>\n  \n  <p>To take an example, therefore, from a very trifling manufacture, but\n  one in which the division of labour has been very often taken notice\n  of, the trade of a pin-maker: a workman not educated to this business\n  (which the division of labour has rendered a distinct trade), nor\n  acquainted with the use of the machinery employed in it (to the\n  invention of which the same division of labour has probably given\n  occasion), could scarce, perhaps, with his utmost industry, make one\n  pin in a day, and certainly could not make twenty. But in the way in\n  which this business is now carried on, not only the whole work is a\n  peculiar trade, but it is divided into a number of branches, of which\n  the greater part are likewise peculiar trades. One man draws out the\n  wire; another straights it; a third cuts it; a fourth points it; a\n  fifth grinds it at the top for receiving the head; to make the head\n  requires two or three distinct operations; to put it on is a peculiar\n  business; to whiten the pins is another; it is even a trade by itself\n  to put them into the paper; and the important business of making a pin\n  is, in this manner, divided into about eighteen distinct operations,\n  which, in some manufactories, are all performed by distinct hands,\n  though in others the same man will sometimes perform two or three of\n  them. I have seen a small manufactory of this kind, where ten men only\n  were employed, and where some of them consequently performed two or\n  three distinct operations. But though they were very poor, and\n  therefore but indifferently accommodated with the necessary machinery,\n  they could, when they exerted themselves, make among them about twelve\n  pounds of pins in a day. There are in a pound upwards of four thousand\n  pins of a middling size. Those ten persons, therefore, could make\n  among them upwards of forty-eight thousand pins in a day. Each person,\n  therefore, making a tenth part of forty-eight thousand pins, might be\n  considered as making four thousand eight hundred pins in a day. But if\n  they had all wrought separately and independently, and without any of\n  them having been educated to this peculiar business, they certainly\n  could not each of them have made twenty, perhaps not one pin in a day;\n  that is, certainly, not the two hundred and fortieth, perhaps not the\n  four thousand eight hundredth, part of what they are at present\n  capable of performing, in consequence of a proper division and\n  combination of their different operations. </p>\n  \n  <p><a href=\"http://www.gutenberg.org/files/3300/3300-h/3300-h.htm\" rel=\"nofollow\">An Inquiry into the Nature and Causes of the Wealth of Nations, Adam\n  Smith, 1776.</a></p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 141, "user_id": 1179235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6d2260b48585822552597dfb4b0d233?s=128&d=identicon&r=PG", "display_name": "IaD", "link": "https://stackoverflow.com/users/1179235/iad"}, "is_accepted": true, "score": 3, "last_activity_date": 1428956972, "creation_date": 1428956972, "answer_id": 29614496, "question_id": 29584052, "link": "https://stackoverflow.com/questions/29584052/understanding-rob-pikes-book-incineration-example/29614496#29614496", "title": "Understanding Rob Pike&#39;s book incineration example", "body": "<p>The trick is that there isn't just one cart, there are multiple carts. One being filled, one being moved to the incinerator, on being emptied into the incinerator, and one being moved back from the incinerator. This means that each gopher should (as long as things are working reasonably and the completion time of each task is relatively similar) always be busy.</p>\n"}], "owner": {"reputation": 5825, "user_id": 631051, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/88a9701bb32b465a3b8357a2aa092815?s=128&d=identicon&r=PG", "display_name": "Ellen Spertus", "link": "https://stackoverflow.com/users/631051/ellen-spertus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 1, "accepted_answer_id": 29614496, "answer_count": 3, "score": 3, "last_activity_date": 1428964570, "creation_date": 1428793386, "question_id": 29584052, "link": "https://stackoverflow.com/questions/29584052/understanding-rob-pikes-book-incineration-example", "title": "Understanding Rob Pike&#39;s book incineration example", "body": "<p>In Rob Pike's talk 2012 talk, <a href=\"https://blog.heroku.com/archives/2013/2/24/concurrency_is_not_parallelism\" rel=\"nofollow noreferrer\">Concurrency is not Parallelism (it's better)</a>, he has a running examples of a group of gophers working together to incinerate a pile of books.</p>\n\n<p>On slide 15 (<a href=\"http://www.youtube.com/watch?v=cN_DpYBzKso&amp;t=6m58s\" rel=\"nofollow noreferrer\">video 6:58</a>), there are three gophers at work: </p>\n\n<ol>\n<li>One loading books from a pile into a cart.</li>\n<li>One moving the filled cart to the incinerator (and later returning the empty cart).</li>\n<li>One moving the books from the cart into the incinerator.</li>\n</ol>\n\n<p><img src=\"https://i.stack.imgur.com/GAj2g.png\" alt=\"3 gophers working together to burn books\"></p>\n\n<p>On <a href=\"http://concur.rspace.googlecode.com/hg/talk/concur.html#slide-16\" rel=\"nofollow noreferrer\">slide 16</a>, four gophers are working together on the same problem:</p>\n\n<ol>\n<li>One loading books from a pile into a cart (as before).</li>\n<li>One moving the filled cart to the incinerator.</li>\n<li>One moving the books from the cart into the incinerator (as before).</li>\n<li>One moving the empty cart back to the pile.</li>\n</ol>\n\n<p><img src=\"https://i.stack.imgur.com/QjsGt.png\" alt=\"4 gophers working together to burn books\">\nPike says that this performs more work but will run faster.  Why?  It seems like the same amount of work, shared by more gophers.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1327717"}, "edited": false, "score": 0, "creation_date": 1428848306, "post_id": 29583841, "comment_id": 47327843, "body": "1. Whenever someone uses interface{} to get JSON data, a kitten dies. Use RawMessage <a href=\"http://golang.org/pkg/encoding/json/#RawMessage\" rel=\"nofollow noreferrer\">golang.org/pkg/encoding/json/#RawMessage</a> . 2. for i := range json_map {             for _, ip := range json_map[i][&quot;ipv4s&quot;] {                 fmt.Printf(ip)             }         } --&gt; madness, two loops to get one element from one map. Incredible. :))"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 3217218, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/aa06eff055c48a68b0933ae543068ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3217218/mike"}, "edited": false, "score": 0, "creation_date": 1428793199, "post_id": 29583900, "comment_id": 47316228, "body": "Great answer, thanks. I&#39;ll take a look at effective go. One issue, i&#39;m getting this <code>invalid operation: json_map[i][&quot;ipv4s&quot;] (type in terface {} does not support indexing)</code>. I had a read over at <a href=\"http://stackoverflow.com/questions/24377907/golang-issue-with-accessing-nested-json-array-after-unmarshalling\" title=\"golang issue with accessing nested json array after unmarshalling\">stackoverflow.com/questions/24377907/&hellip;</a> yet I was unable to comprehend the answer."}, {"owner": {"reputation": 1564, "user_id": 2152200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ba0b08f62368852ce8d8466d4a4e87b0?s=128&d=identicon&r=PG", "display_name": "Ayonix", "link": "https://stackoverflow.com/users/2152200/ayonix"}, "reply_to_user": {"reputation": 63, "user_id": 3217218, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/aa06eff055c48a68b0933ae543068ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3217218/mike"}, "edited": false, "score": 0, "creation_date": 1428793328, "post_id": 29583900, "comment_id": 47316249, "body": "Can&#39;t answer that if I don&#39;t know what struct the underlying map is."}, {"owner": {"reputation": 63, "user_id": 3217218, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/aa06eff055c48a68b0933ae543068ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3217218/mike"}, "edited": false, "score": 0, "creation_date": 1428793396, "post_id": 29583900, "comment_id": 47316273, "body": "How would I be able to find that out myself?"}, {"owner": {"reputation": 1564, "user_id": 2152200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ba0b08f62368852ce8d8466d4a4e87b0?s=128&d=identicon&r=PG", "display_name": "Ayonix", "link": "https://stackoverflow.com/users/2152200/ayonix"}, "reply_to_user": {"reputation": 63, "user_id": 3217218, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/aa06eff055c48a68b0933ae543068ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3217218/mike"}, "edited": false, "score": 0, "creation_date": 1428793440, "post_id": 29583900, "comment_id": 47316282, "body": "Well, where is the map with asn, time, ipv4s,... from and how do you insert that into go to iterate over?"}, {"owner": {"reputation": 63, "user_id": 3217218, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/aa06eff055c48a68b0933ae543068ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3217218/mike"}, "edited": false, "score": 0, "creation_date": 1428793640, "post_id": 29583900, "comment_id": 47316327, "body": "<a href=\"https://www.enjen.net/asn-blocklist/index.php?asn=10&amp;type=json_split&amp;api=1\" rel=\"nofollow noreferrer\">enjen.net/asn-blocklist/&hellip;</a> I retrieve it via a http.get. I&#39;ve updated the post with complete source code."}, {"owner": {"reputation": 1564, "user_id": 2152200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ba0b08f62368852ce8d8466d4a4e87b0?s=128&d=identicon&r=PG", "display_name": "Ayonix", "link": "https://stackoverflow.com/users/2152200/ayonix"}, "reply_to_user": {"reputation": 63, "user_id": 3217218, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/aa06eff055c48a68b0933ae543068ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3217218/mike"}, "edited": false, "score": 0, "creation_date": 1428793991, "post_id": 29583900, "comment_id": 47316432, "body": "The cleanest solution is to decode it into a struct you define (if you know what the response should look like) instead of decoding it into  <code>map[string]interface{}</code>. See <a href=\"http://blog.golang.org/json-and-go\" rel=\"nofollow noreferrer\">blog.golang.org/json-and-go</a> for example. They declare a type Message and decode the response to such a struct. Then you coud iterate over the slice, as opposed to interface{}"}, {"owner": {"reputation": 63, "user_id": 3217218, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/aa06eff055c48a68b0933ae543068ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3217218/mike"}, "edited": false, "score": 0, "creation_date": 1428794416, "post_id": 29583900, "comment_id": 47316562, "body": "Would you be able to provide me with an example through my source?"}], "tags": [], "owner": {"reputation": 1564, "user_id": 2152200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ba0b08f62368852ce8d8466d4a4e87b0?s=128&d=identicon&r=PG", "display_name": "Ayonix", "link": "https://stackoverflow.com/users/2152200/ayonix"}, "is_accepted": true, "score": 3, "last_activity_date": 1428792074, "creation_date": 1428792074, "answer_id": 29583900, "question_id": 29583841, "link": "https://stackoverflow.com/questions/29583841/golang-for-loop-of-certain-part-of-map/29583900#29583900", "title": "Golang for loop of certain part of map", "body": "<p><a href=\"https://golang.org/doc/effective_go.html#for\" rel=\"nofollow\">Effective Go</a> is a good source once you have completed the tutorial for go.\nThere it is also described how one iterates over a slice:</p>\n\n<pre><code>for key, value := range json_map {\n    // ...\n}\n</code></pre>\n\n<p>Or if you don't need the key:</p>\n\n<pre><code>for _, value := range json_map {\n    // ...\n}\n</code></pre>\n\n<p>You might have to nest two loops, if it is a slice of maps: </p>\n\n<pre><code>for i := range json_map {\n    for _, ip := range json_map[i][\"ipv4s\"] {\n      // ...\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 3217218, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/aa06eff055c48a68b0933ae543068ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3217218/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 860, "favorite_count": 0, "accepted_answer_id": 29583900, "answer_count": 1, "score": -4, "last_activity_date": 1428793659, "creation_date": 1428791614, "last_edit_date": 1428793659, "question_id": 29583841, "link": "https://stackoverflow.com/questions/29583841/golang-for-loop-of-certain-part-of-map", "title": "Golang for loop of certain part of map", "body": "<p>Attempting to create a for loop for each part of a map.</p>\n\n<pre><code>map[\nasn:AS10 \ntime:1.428790768e+09 \nipv4s:[\n      68.114.75.0/24 \n      216.215.56.0/22 \n      216.215.60.0/22] \nipv6s:[\n      2607:f3f8::/32\n]]\n</code></pre>\n\n<p>The above is the map, I'd like to try create a for loop for each value in <code>ipv4s</code>.</p>\n\n<p>I've attempted, but I'm clearly not doing it correctly as it's merely based off my php knowledge.:</p>\n\n<pre><code>for json_map[\"ipv4s\"]{\n   //whatever       \n}\n</code></pre>\n\n<p>PHP version if anyone needs an example rather then me attempting to explain:</p>\n\n<pre><code>foreach($obj-&gt;ipv4s as $value) {\n     echo $value; // return an ip\n}\n</code></pre>\n\n<p>Update</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"os\"\n    \"encoding/json\"\n    )\n\nfunc main() {\n\n    response, err := http.Get(\"https://www.enjen.net/asn-blocklist/index.php?asn=\" + os.Args[1] + \"&amp;type=json_split&amp;api=1\")\n\n    if err != nil {\n        fmt.Printf(\"%s\", err)\n        os.Exit(1)\n    } else {\n        defer response.Body.Close()\n        dec := json.NewDecoder(response.Body)\n        if dec == nil {\n            panic(\"Failed to start decoding JSON data\")\n        }\n\n        json_map := make(map[string]interface{})\n        err = dec.Decode(&amp;json_map)\n        if err != nil {\n            panic(err)\n        }\n\n        fmt.Printf(\"%v\\n\", json_map)\n\n        for i := range json_map {\n            for _, ip := range json_map[i][\"ipv4s\"] {\n                fmt.Printf(ip)\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "json-rpc"], "comments": [{"owner": {"reputation": 245145, "user_id": 1348195, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6dca2295546af21e1cde8e68f2d49bd?s=128&d=identicon&r=PG", "display_name": "Benjamin Gruenbaum", "link": "https://stackoverflow.com/users/1348195/benjamin-gruenbaum"}, "edited": false, "score": 1, "creation_date": 1428787500, "post_id": 29583179, "comment_id": 47314578, "body": "Are you willing to suffer the overhead of RPC even when calling it from the server itself? If you are you can just open a local connection to <code>localhost</code> and use it as a client would."}, {"owner": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "edited": false, "score": 0, "creation_date": 1428850872, "post_id": 29583179, "comment_id": 47328704, "body": "Alternatively, if those shared methods are the same, put them together in a package, and have both your RPC server and your other application install/use that package."}], "answers": [{"tags": [], "owner": {"reputation": 322, "user_id": 3581778, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/98948b56841bc5ded022c5c1f9288da2?s=128&d=identicon&r=PG", "display_name": "Manawasp", "link": "https://stackoverflow.com/users/3581778/manawasp"}, "is_accepted": false, "score": 0, "last_activity_date": 1428896958, "creation_date": 1428896958, "answer_id": 29597566, "question_id": 29583179, "link": "https://stackoverflow.com/questions/29583179/calling-a-registered-rpc-method-on-same-server-in-golang/29597566#29597566", "title": "Calling a registered RPC method on same server in Golang", "body": "<p>Difficult to answer, if we don't know how you build your code with some exemple it will be easier.</p>\n\n<p>Two choices.\nCreate client with goroutine, set your connection to the server and call the method. This method is bad, wtf.</p>\n\n<p>Second :</p>\n\n<pre><code>type CalcServ struct {\n  LastAnswer\n}\n\ntype CalcReq struct {\n   X int\n   Y int\n}\n\ntype CalcResp struct {\n   Z int\n}\n\nfunc (serv *CalcServ) Add(req *CalcReq, resp *CalcResp) error {\n  serv.LastAnswer = req.X + req.Y\n  serv.Show(req, resp)\n  return nil\n}\n\nfunc (serv *CalcServ) Show(req *CalcReq, resp *CalcResp) error {\n  resp.Z = serv.LastAnswer\n  return nil\n}\n</code></pre>\n\n<p>My exemple is not a good implementation, but it's just to show the idea to you.\nThere are Two RPC method, <code>Add</code> and <code>Show</code>, and <code>Add</code> call <code>Show</code></p>\n"}, {"tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": false, "score": 0, "last_activity_date": 1429246834, "creation_date": 1429246834, "answer_id": 29690691, "question_id": 29583179, "link": "https://stackoverflow.com/questions/29583179/calling-a-registered-rpc-method-on-same-server-in-golang/29690691#29690691", "title": "Calling a registered RPC method on same server in Golang", "body": "<p>I had to do this myself.  This is a contrived example showing what I did in my case:</p>\n\n<p>This is the RPC function...</p>\n\n<pre><code>func (server *Server) RemoteGoroutineCount(request GoroutineCountsRequest, response *GoroutineCountsResponse) error {\n    response.Count = runtime.NumGoroutine()\n    return nil\n}\n</code></pre>\n\n<p>Now, if I want to call that locally, I can just do</p>\n\n<pre><code>req := GoroutineCountsRequest{}\nres := &amp;GorouteCountsResponse{}\ns := &amp;Server{}\nerr := s.RemoteGoroutineCount(req, res)\n// handle error\n// Now res has your filled in response\nres.NumGoroutines\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 3545351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5668f03bcc996ec18d4c9d96f2ee59d?s=128&d=identicon&r=PG&f=1", "display_name": "user3545351", "link": "https://stackoverflow.com/users/3545351/user3545351"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1151, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1429246834, "creation_date": 1428787178, "question_id": 29583179, "link": "https://stackoverflow.com/questions/29583179/calling-a-registered-rpc-method-on-same-server-in-golang", "title": "Calling a registered RPC method on same server in Golang", "body": "<p>I have some methods registered to a type in server program for RPC in Golang. I want to use those methods from clients as well as the server itself. e.g. I have an addition method registered as RPC method which I want to invoke from clients. But I want to call the same method in the same server program for some other function too. Is there a way to do this?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 245145, "user_id": 1348195, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6dca2295546af21e1cde8e68f2d49bd?s=128&d=identicon&r=PG", "display_name": "Benjamin Gruenbaum", "link": "https://stackoverflow.com/users/1348195/benjamin-gruenbaum"}, "edited": false, "score": 1, "creation_date": 1428786551, "post_id": 29583024, "comment_id": 47314345, "body": "You can read a byte at once and then use a <a href=\"http://en.wikipedia.org/wiki/Mask_%28computing%29\" rel=\"nofollow noreferrer\">bitmask</a> to extract specific fields."}], "answers": [{"tags": [], "owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "is_accepted": true, "score": 12, "last_activity_date": 1428789660, "last_edit_date": 1428789660, "creation_date": 1428787179, "answer_id": 29583180, "question_id": 29583024, "link": "https://stackoverflow.com/questions/29583024/reading-8-bits-from-a-reader-in-golang/29583180#29583180", "title": "Reading &lt; 8 bits from a reader in Golang", "body": "<p><code>io.Reader</code> can only read bytes, not bits. What you can do is read the bytes and extract the bits yourself:</p>\n\n<pre><code>var (\n    byte0 byte = 0xAF\n    byte5 byte = 0x89\n)\n\nversion := byte0 &gt;&gt; 4\nheaderLength := byte0 &amp; 0x0F\nflags := byte5 &gt;&gt; 5\n</code></pre>\n\n<p>Of course, another approach is to write a <code>BitReader</code> type, which could of course be more efficient but you get the idea: <a href=\"http://play.golang.org/p/Wyr_K9YAro\" rel=\"noreferrer\">http://play.golang.org/p/Wyr_K9YAro</a> :)</p>\n"}], "owner": {"reputation": 932, "user_id": 1955931, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/GvXEF.png?s=128&g=1", "display_name": "Jan Berktold", "link": "https://stackoverflow.com/users/1955931/jan-berktold"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2226, "favorite_count": 1, "accepted_answer_id": 29583180, "answer_count": 1, "score": 9, "last_activity_date": 1428789660, "creation_date": 1428786324, "question_id": 29583024, "link": "https://stackoverflow.com/questions/29583024/reading-8-bits-from-a-reader-in-golang", "title": "Reading &lt; 8 bits from a reader in Golang", "body": "<p>While handling raw IP packages in Golang I've came across a problem which I cannot seem to find a solution for:</p>\n\n<p>The <a href=\"https://tools.ietf.org/html/rfc791\" rel=\"noreferrer\">IPv4 specification</a> contains fields which are smaller than 8 bits. For example the Version or the Header Length (4 bits each) or the Flags (3 bits). </p>\n\n<p>How do I read those values from an io.Reader and handle them using Golang afterwards? I've been using the <a href=\"http://golang.org/pkg/encoding/binary/#Read\" rel=\"noreferrer\">binary.Read</a> method so far, however since the smallest integer type in Golang is an int8, that is not possible in this case.</p>\n"}, {"tags": ["csv", "go"], "answers": [{"tags": [], "owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "is_accepted": true, "score": 1, "last_activity_date": 1428786105, "creation_date": 1428786105, "answer_id": 29582988, "question_id": 29582957, "link": "https://stackoverflow.com/questions/29582957/why-is-this-giving-me-an-undefined-error/29582988#29582988", "title": "Why is this giving me an undefined error?", "body": "<p>Use <code>:=</code>, not <code>=</code>, to create new variables:</p>\n\n<pre><code>csvfile, err := os.Open(source)\n</code></pre>\n"}], "owner": {"reputation": 2431, "user_id": 232337, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3b17ed9811882a5db9f185cde695cf8d?s=128&d=identicon&r=PG&f=1", "display_name": "RockyMountainHigh", "link": "https://stackoverflow.com/users/232337/rockymountainhigh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 29582988, "answer_count": 1, "score": -3, "last_activity_date": 1428786105, "creation_date": 1428785898, "question_id": 29582957, "link": "https://stackoverflow.com/questions/29582957/why-is-this-giving-me-an-undefined-error", "title": "Why is this giving me an undefined error?", "body": "<p>I am writing a simple csv file parser in go and cannot find out why I get \"undefined: csvfile\" and \"undefined: err\" with the following code. From all of the examples it appears to be correct.</p>\n\n<pre><code>var source string\nflag.StringVar(&amp;source, \"file\", \"test.csv\", \"the file to parse\")\nflag.Parse()\ncsvfile, err = os.Open(source)\n</code></pre>\n"}, {"tags": ["performance", "optimization", "assembly", "go"], "comments": [{"owner": {"reputation": 6093, "user_id": 2189500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/109f747845a9ce762a1fff72eb8cf6f3?s=128&d=identicon&r=PG", "display_name": "David Wohlferd", "link": "https://stackoverflow.com/users/2189500/david-wohlferd"}, "edited": false, "score": 0, "creation_date": 1428799253, "post_id": 29582377, "comment_id": 47317533, "body": "Are you sure Go isn&#39;t just optimizing away the loop in BenchmarkEmpty()?  If it does, comparing BenchmarkEmpty with BenchmarkNop isn&#39;t much of a comparison."}, {"owner": {"reputation": 1563, "user_id": 1311571, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b39a1d543cc5e64adfcebc9301850df2?s=128&d=identicon&r=PG", "display_name": "Peter Schneider", "link": "https://stackoverflow.com/users/1311571/peter-schneider"}, "reply_to_user": {"reputation": 6093, "user_id": 2189500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/109f747845a9ce762a1fff72eb8cf6f3?s=128&d=identicon&r=PG", "display_name": "David Wohlferd", "link": "https://stackoverflow.com/users/2189500/david-wohlferd"}, "edited": false, "score": 0, "creation_date": 1428914259, "post_id": 29582377, "comment_id": 47348221, "body": "Yes, I&#39;m sure. I&#39;ve taken a look into the disassembly and the loop is still there. A generic implementation of doNop (<code>func doNopGeneric(){}</code>) is optimized away btw."}], "answers": [{"comments": [{"owner": {"reputation": 1563, "user_id": 1311571, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b39a1d543cc5e64adfcebc9301850df2?s=128&d=identicon&r=PG", "display_name": "Peter Schneider", "link": "https://stackoverflow.com/users/1311571/peter-schneider"}, "edited": false, "score": 0, "creation_date": 1429380190, "post_id": 29705631, "comment_id": 47576274, "body": "I was hoping to inline some primitive functions in ASM and still building my algorithm in go. But a negative answer is still an answer ;)"}], "tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": true, "score": 1, "last_activity_date": 1429291138, "creation_date": 1429291138, "answer_id": 29705631, "question_id": 29582377, "link": "https://stackoverflow.com/questions/29582377/overhead-of-asm-function-call-in-go/29705631#29705631", "title": "Overhead of ASM-function-call in go", "body": "<p>Assembly functions are not inlined. Here are 3 things you could try:</p>\n\n<ol>\n<li><p>Move your loop into assembly. For example with this function:</p>\n\n<pre><code>func Sum(xs []int64) int64\n</code></pre>\n\n<p>You can do this:</p>\n\n<pre><code>#include \"textflag.h\"\n\nTEXT \u00b7Sum(SB),NOSPLIT,$0-24\n    MOVQ  xs+0(FP),DI\n    MOVQ  xs+8(FP),SI\n    MOVQ  $0,CX\n    MOVQ  $0,AX\n\nL1: CMPQ  AX,SI           // i &lt; len(xs)\n    JGE   Z1\n    LEAQ  (DI)(AX*8),BX   // BX = &amp;xs[i]\n    MOVQ  (BX),BX         // BX = *BX\n    ADDQ  BX,CX           // CX += BX\n    INCQ  AX              // i++\n    JMP   L1\n\nZ1: MOVQ  CX,ret+24(FP)\n    RET\n</code></pre>\n\n<p>If you look in the standard libraries you will see examples of this.</p></li>\n<li><p>Write some of your code in c, leverage the support it has for intrinsics or inline assembly, and use cgo to call it from go.</p></li>\n<li><p>Use gccgo to do the same thing as #2, except you can do it directly:</p>\n\n<pre><code>//extern open\nfunc c_open(name *byte, mode int, perm int) int\n</code></pre>\n\n<p><a href=\"https://golang.org/doc/install/gccgo#Function_names\" rel=\"nofollow\">https://golang.org/doc/install/gccgo#Function_names</a></p></li>\n</ol>\n"}], "owner": {"reputation": 1563, "user_id": 1311571, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b39a1d543cc5e64adfcebc9301850df2?s=128&d=identicon&r=PG", "display_name": "Peter Schneider", "link": "https://stackoverflow.com/users/1311571/peter-schneider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 648, "favorite_count": 1, "accepted_answer_id": 29705631, "answer_count": 1, "score": 1, "last_activity_date": 1429291138, "creation_date": 1428782244, "question_id": 29582377, "link": "https://stackoverflow.com/questions/29582377/overhead-of-asm-function-call-in-go", "title": "Overhead of ASM-function-call in go", "body": "<p>I currently play around with go, it's assembly, performance of floating point operations (<code>float32</code>) and optimizations in the nano-seconds-scale. I was a bit confused by the overhead of a simple function call:</p>\n\n<pre><code>func BenchmarkEmpty(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n    }\n}\nfunc BenchmarkNop(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        doNop()\n    }\n}\n</code></pre>\n\n<p>The implementation of doNop:</p>\n\n<pre><code>TEXT \u00b7doNop(SB),0,$0-0\n    RET\n</code></pre>\n\n<p>The result (<code>go test -bench .</code>):</p>\n\n<pre><code>BenchmarkEmpty        2000000000               0.30 ns/op\nBenchmarkNop  2000000000               1.73 ns/op\n</code></pre>\n\n<p>Im not used to assembly and/ or the internals of go. It is possible fo the go compiler/ linker to inline a function defined in assembly? Can I give the linker a hint somehow? For some simple functions like 'add two R3-vectors' this eats up all possible performance gain.</p>\n\n<p>(go 1.4.2, amd64)</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 2, "creation_date": 1428775245, "post_id": 29581165, "comment_id": 47310727, "body": "Can&#39;t you just round the float before converting it into a string? If not, just slice the string up to the index of <code>.</code>."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1428784680, "post_id": 29581165, "comment_id": 47313842, "body": "E.g. <code>s1 := fmt.Sprintf(&quot;%.0f&quot;, math.Pi); s2 := fmt.Sprintf(&quot;%.3f&quot; math.Pi)</code> gives &quot;3&quot; and &quot;3.142&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 443, "user_id": 5627731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a27dfadd7cef96687ba1bd8aaedcc19?s=128&d=identicon&r=PG", "display_name": "tris timb", "link": "https://stackoverflow.com/users/5627731/tris-timb"}, "edited": false, "score": 0, "creation_date": 1607700479, "post_id": 29581246, "comment_id": 115362681, "body": "If you know you only need the first part you can do <code>prefix := strings.Split(&quot;30.060671&quot;, &quot;.&quot;)[0]</code>."}], "tags": [], "owner": {"reputation": 5488, "user_id": 1078890, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Dqula.jpg?s=128&g=1", "display_name": "IamNaN", "link": "https://stackoverflow.com/users/1078890/iamnan"}, "is_accepted": false, "score": 23, "last_activity_date": 1428775438, "creation_date": 1428775438, "answer_id": 29581246, "question_id": 29581165, "link": "https://stackoverflow.com/questions/29581165/trimright-everything-after-delimiter-in-golang/29581246#29581246", "title": "TrimRight everything after delimiter in golang", "body": "<p>One way to do it would be to use strings.Split on the period:</p>\n\n<pre><code>parts := strings.Split(\"30.060671\", \".\")\nfmt.Println(parts[0])\n</code></pre>\n\n<p>Another option is to convert to an int first and then to a string:</p>\n\n<pre><code>a := 30.060671\nb := int(a)    \nfmt.Println(b)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 301, "user_id": 4019613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba804e8001f4770f20fdcbd12a011c20?s=128&d=identicon&r=PG", "display_name": "adaml", "link": "https://stackoverflow.com/users/4019613/adaml"}, "edited": false, "score": 1, "creation_date": 1511982649, "post_id": 29581738, "comment_id": 82077767, "body": "I like this answer! To complete the answer to the question in the topic, use <code>strings.LastIndex(s, &quot;.&quot;)</code> to get the last index of the delimiter."}], "tags": [], "owner": {"reputation": 16814, "user_id": 3849456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AonOf.jpg?s=128&g=1", "display_name": "Anzel", "link": "https://stackoverflow.com/users/3849456/anzel"}, "is_accepted": false, "score": 9, "last_activity_date": 1428779243, "last_edit_date": 1428779243, "creation_date": 1428778199, "answer_id": 29581738, "question_id": 29581165, "link": "https://stackoverflow.com/questions/29581165/trimright-everything-after-delimiter-in-golang/29581738#29581738", "title": "TrimRight everything after delimiter in golang", "body": "<p>As per @p\u0430\u0439\u0442\u0444\u043e\u043b\u0434 suggested in comment, you should have rounded the <strong>float</strong> before converting to <strong>string</strong>.  </p>\n\n<p>Anyway, here is my attempt using <strong>strings.Index</strong> to trim the remaining from <code>.</code>:</p>\n\n<pre><code>func trimStringFromDot(s string) string {\n    if idx := strings.Index(s, \".\"); idx != -1 {\n        return s[:idx]\n    }\n    return s\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/gWM_6M9t_D\" rel=\"noreferrer\">Playground</a></p>\n\n<p>Also, to answer why <strong>TrimRight</strong> and <strong>TrimSuffix</strong> not working as expected is because <code>.</code> is not a trailing string/unicode:</p>\n\n<blockquote>\n  <p>TrimRight returns a slice of the string s, with all trailing Unicode\n  code points contained in cutset removed.</p>\n  \n  <p>TrimSuffix returns s without the provided trailing suffix string. If s\n  doesn't end with suffix, s is returned unchanged.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 392, "user_id": 2757014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf67790fb92ee2322af057fed9a1617?s=128&d=identicon&r=PG", "display_name": "Lery", "link": "https://stackoverflow.com/users/2757014/lery"}, "edited": false, "score": 2, "creation_date": 1493128815, "post_id": 33028384, "comment_id": 74274443, "body": "Be careful: what if your string does not contain the delimiter? Then Split would not have size 2 or more... Anyhow, good unit tests should catch the problem, but still."}], "tags": [], "owner": {"reputation": 2619, "user_id": 2249725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06905a0d11a7662cbadd4daffe029452?s=128&d=identicon&r=PG", "display_name": "mvndaai", "link": "https://stackoverflow.com/users/2249725/mvndaai"}, "is_accepted": false, "score": 2, "last_activity_date": 1444353076, "creation_date": 1444353076, "answer_id": 33028384, "question_id": 29581165, "link": "https://stackoverflow.com/questions/29581165/trimright-everything-after-delimiter-in-golang/33028384#33028384", "title": "TrimRight everything after delimiter in golang", "body": "<p>Here is how to get either side of a delimiter.</p>\n\n<pre><code>string := \"Symver.0.1.0\"\ndelimiter := \".\"\n\nleftOfDelimiter := strings.Split(string, delimiter)[0]\nrightOfDelimiter := strings.Join(strings.Split(string, delimiter)[1:], delimiter)\n\nfmt.Println(\"Left of Delimiter: \", leftOfDelimiter)\nfmt.Println(\"Right of Delimiter: \", rightOfDelimiter)   \n\n//Left of Delimiter:  Symver\n//Right of Delimiter:  0.1.0\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/HBi4G5tBL9\" rel=\"nofollow\">https://play.golang.org/p/HBi4G5tBL9</a></p>\n"}, {"tags": [], "owner": {"reputation": 493, "user_id": 1525079, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4ad6a9e8944ef2aedf0f9dd0436c47af?s=128&d=identicon&r=PG", "display_name": "anirudh.vyas", "link": "https://stackoverflow.com/users/1525079/anirudh-vyas"}, "is_accepted": false, "score": -1, "last_activity_date": 1480549467, "last_edit_date": 1480549467, "creation_date": 1480549120, "answer_id": 40900231, "question_id": 29581165, "link": "https://stackoverflow.com/questions/29581165/trimright-everything-after-delimiter-in-golang/40900231#40900231", "title": "TrimRight everything after delimiter in golang", "body": "<pre><code>fmt.Println(fmt.Sprintf(\"%.0f\", 30.060671))\n</code></pre>\n\n<p>That oughtta do it easy. (BTW: Just to add, one of the commenters originally stated or alluded to a similar solution).\nHowever must you only use string, this should do -</p>\n\n<pre><code>   fmt.Println(fmt.Sprintf(\"%.0f\", 30.060671))\n    value := \"30.060671\"\n    f := func(c rune) bool {\n        return c == ',' || c == ':' || c == '.'\n        }\n     fields := strings.FieldsFunc(value, f)[0]\n    fmt.Printf(\"%v\", fields)\n</code></pre>\n\n<p>You have choice of delimiters there. I don't know if this is elegant but hey.</p>\n"}], "owner": {"reputation": 155, "user_id": 4767161, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-68M_N7xjTOE/AAAAAAAAAAI/AAAAAAAAAEI/9IO3vdg7kwI/photo.jpg?sz=128", "display_name": "Tim Ski", "link": "https://stackoverflow.com/users/4767161/tim-ski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22909, "favorite_count": 1, "answer_count": 4, "score": 10, "last_activity_date": 1480549467, "creation_date": 1428775023, "question_id": 29581165, "link": "https://stackoverflow.com/questions/29581165/trimright-everything-after-delimiter-in-golang", "title": "TrimRight everything after delimiter in golang", "body": "<p>I have a float64 I converted into a string: <code>30.060671</code></p>\n\n<p>I'm trying to trim/remove/chomp everything after <code>30</code></p>\n\n<p>Some of the things I've tried:</p>\n\n<pre><code>fmt.Println(strings.TrimRight(\"30.060671\", \".([0-9])\"))\nfmt.Println(strings.TrimRight(\"30.060671\", \".\"))\nfmt.Println(strings.TrimSuffix(\"30.060671\", \".\"))\n</code></pre>\n"}, {"tags": ["sorting", "go"], "answers": [{"tags": [], "owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "is_accepted": true, "score": 5, "last_activity_date": 1428774604, "last_edit_date": 1428774604, "creation_date": 1428774244, "answer_id": 29581026, "question_id": 29580955, "link": "https://stackoverflow.com/questions/29580955/how-do-i-sort-a-slice-by-values-of-a-map/29581026#29581026", "title": "How do I sort a slice by values of a map", "body": "<p>Implement the <a href=\"https://golang.org/pkg/sort/#Interface\"><code>sort.Interface</code></a> interface for a type that stores the data and the weights:</p>\n\n<pre><code>import \"sort\"\n\ntype WeightedStringSlice struct {\n    Strings []string\n    Weights map[string]int\n}\n\nfunc (s *WeightedStringSlice) Len() int {\n    return len(s.Strings)\n}\n\nfunc (s *WeightedStringSlice) Less(i, j int) bool {\n    return s.Weights[s.Strings[i]] &lt; s.Weights[s.Strings[j]]\n}\n\nfunc (s *WeightedStringSlice) Swap(i, j int) {\n    s.Strings[i], s.Strings[j] = s.Strings[j], s.Strings[i]\n}\n</code></pre>\n\n<p>Then call <a href=\"https://golang.org/pkg/sort/#Sort\"><code>sort.Sort</code></a> on it:</p>\n\n<pre><code>data := WeightedStringSlice{\n    Strings: []string{\"dog\", \"cat\", \"bird\"},\n    Weights: map[string]int{\"dog\": 2, \"cat\": 3, \"bird\": 1},\n}\nsort.Sort(&amp;data)\nfmt.Printf(\"%v\\n\", data.Strings)\n</code></pre>\n\n<p><kbd><a href=\"https://play.golang.org/p/es3tynV6yw\"><strong>Live Demo</strong></a></kbd></p>\n"}], "owner": {"reputation": 121, "user_id": 3088113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfd790cbf255759b2ecc483d210b2c01?s=128&d=identicon&r=PG&f=1", "display_name": "js837", "link": "https://stackoverflow.com/users/3088113/js837"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 29581026, "answer_count": 1, "score": 3, "last_activity_date": 1428774604, "creation_date": 1428773905, "question_id": 29580955, "link": "https://stackoverflow.com/questions/29580955/how-do-i-sort-a-slice-by-values-of-a-map", "title": "How do I sort a slice by values of a map", "body": "<p>Seems a basic question, but can't find a simple answer.</p>\n\n<p>I have a slice:</p>\n\n<pre><code>[]string{\"dog\", \"cat\", \"bird\"}\n</code></pre>\n\n<p>What's the best way to sort it by looking up the sorting values in a map:</p>\n\n<pre><code>map[string]int{\"dog\": 2, \"cat\":3, \"bird\": 1}\n</code></pre>\n\n<p>So that the slice is ordered as below:</p>\n\n<pre><code>[]string{\"bird\", \"dog\", \"cat\"}\n</code></pre>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 7017, "user_id": 2018812, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/69c00f983bf2d1256d91ef5b459b913c?s=128&d=identicon&r=PG&f=1", "display_name": "Yogesh", "link": "https://stackoverflow.com/users/2018812/yogesh"}, "edited": false, "score": 0, "creation_date": 1428769294, "post_id": 29579123, "comment_id": 47308648, "body": "I think In your documents date save in <code>unix time stamp</code>  check this <a href=\"http://stackoverflow.com/questions/11996693/golang-mgo-how-can-i-ask-mongodb-to-use-current-time-in-a-field\" title=\"golang mgo how can i ask mongodb to use current time in a field\">stackoverflow.com/questions/11996693/&hellip;</a>"}, {"owner": {"reputation": 10253, "user_id": 1647484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/W7T7D.png?s=128&g=1", "display_name": "BrainLikeADullPencil", "link": "https://stackoverflow.com/users/1647484/brainlikeadullpencil"}, "reply_to_user": {"reputation": 7017, "user_id": 2018812, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/69c00f983bf2d1256d91ef5b459b913c?s=128&d=identicon&r=PG&f=1", "display_name": "Yogesh", "link": "https://stackoverflow.com/users/2018812/yogesh"}, "edited": false, "score": 0, "creation_date": 1428771046, "post_id": 29579123, "comment_id": 47309285, "body": "I&#39;m sorry, I don&#39;t fully get your point. Before saving the record, I decode it to a field like this <code>Date int64 </code>json:&quot;date&quot; bson: &quot;date&quot;`` What would you recommend I do?"}, {"owner": {"reputation": 10253, "user_id": 1647484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/W7T7D.png?s=128&g=1", "display_name": "BrainLikeADullPencil", "link": "https://stackoverflow.com/users/1647484/brainlikeadullpencil"}, "reply_to_user": {"reputation": 7017, "user_id": 2018812, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/69c00f983bf2d1256d91ef5b459b913c?s=128&d=identicon&r=PG&f=1", "display_name": "Yogesh", "link": "https://stackoverflow.com/users/2018812/yogesh"}, "edited": false, "score": 0, "creation_date": 1428771582, "post_id": 29579123, "comment_id": 47309485, "body": "Should I create another field on the struct with a different type and convert the unix time stamp to another type to use for storage. If so, what and how?"}], "answers": [{"tags": [], "owner": {"reputation": 146, "user_id": 3939561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65547558d4906b041dcc64ee9b100cef?s=128&d=identicon&r=PG&f=1", "display_name": "Greg R", "link": "https://stackoverflow.com/users/3939561/greg-r"}, "is_accepted": true, "score": 1, "last_activity_date": 1428774075, "last_edit_date": 1428774075, "creation_date": 1428771723, "answer_id": 29580582, "question_id": 29579123, "link": "https://stackoverflow.com/questions/29579123/query-by-date-in-mongodb/29580582#29580582", "title": "query by date in mongodb", "body": "<p><code>r.FormValue</code> returns a string, but you need an int64. Use <a href=\"http://godoc.org/strconv#ParseInt\" rel=\"nofollow\">strconv.ParseInt</a>. Then your query should work.</p>\n\n<pre><code>date, err := strconv.ParseInt(r.FormValue(\"date\"), 10, 64)\n// handle err\nerr = Items.Find(bson.M{\"date\":date}).One(&amp;result)\n</code></pre>\n"}], "owner": {"reputation": 10253, "user_id": 1647484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/W7T7D.png?s=128&g=1", "display_name": "BrainLikeADullPencil", "link": "https://stackoverflow.com/users/1647484/brainlikeadullpencil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1546, "favorite_count": 0, "accepted_answer_id": 29580582, "answer_count": 1, "score": 0, "last_activity_date": 1428774075, "creation_date": 1428763336, "last_edit_date": 1428771357, "question_id": 29579123, "link": "https://stackoverflow.com/questions/29579123/query-by-date-in-mongodb", "title": "query by date in mongodb", "body": "<p>I'm able to insert an entry into MongoDB using the golang driver  <code>gopkg.in/mgo.vs</code> and <code>gopkg.in/mgo.vs/bson</code> but I'm not able to pull it out.  In the mongo shell, if I do </p>\n\n<pre><code>db.Items.find({ date : 1428762411980 })\n</code></pre>\n\n<p>it shows me the entry that I just inserted with the Go code. However, if I try to do the following to fetch it in Go, it's telling me that the record isn't found</p>\n\n<pre><code>    func fetch(w http.ResponseWriter, r *http.Request){\n         var result SomeStruct\n         date := r.FormValue(\"date\")\n         err := Items.Find(bson.M{\"date\":date}).One(&amp;result)\n         ...code omitted...\n\n    }\n\n   func Items() *mgo.Collection {\n       return DB().C(\"Items\")\n    }\n\n   func DB() *mgo.Database {\n      return DBSession().DB(\"mydb\")\n    }\n</code></pre>\n\n<p>One thing I noticed was that, in the shell, the date is stored as a <code>NumberLong</code></p>\n\n<pre><code> \"date\" : NumberLong(\"1428762411980\")\n</code></pre>\n\n<p>I'm wondering if I have to do something with the date value that I receive from the form in the <code>fetch</code> function before using it to query the database?</p>\n\n<p>Update</p>\n\n<p>Before saving the data to the db, it comes in as a json string like this</p>\n\n<pre><code>\"date\":1428762411980\n</code></pre>\n\n<p>I then decode it into a struct</p>\n\n<pre><code>type blah struct{\n    Id bson.ObjectId `json:\"id\" bson:\"_id\"`\n    Date int64 `json:\"date\" bson: \"date\"`\n</code></pre>\n\n<p>And it gets saved like this (as shown in the shell)</p>\n\n<pre><code> \"date\" : NumberLong(\"1428762411980\")\n</code></pre>\n"}, {"tags": ["go", "udp"], "comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 2, "creation_date": 1428753764, "post_id": 29577551, "comment_id": 47303619, "body": "Can you check the error send back by ReadFromUDP, in case it gives you a clue?"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1428754244, "post_id": 29577551, "comment_id": 47303730, "body": "are you sure there&#39;s data to read?  is the publisher on the same host?  go, by default, disables loopback for mcast.  You have to do some syscalls to see packets send from your own address."}, {"owner": {"reputation": 31, "user_id": 3741158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/011616892bc352d1ba2487497b5ddbdd?s=128&d=identicon&r=PG&f=1", "display_name": "user3741158", "link": "https://stackoverflow.com/users/3741158/user3741158"}, "edited": false, "score": 0, "creation_date": 1428755388, "post_id": 29577551, "comment_id": 47304048, "body": "There are no errors coming from ReadFromUDP. But I see now that I may have been a little quick in blaming UDP for the error. In the 6th line in the code where I print the message (motatt means received) it prints &quot;Motatt&quot;, and freezes before it prints the message. So the error may be in the casting and not in the UDP."}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1428755669, "post_id": 29577551, "comment_id": 47304125, "body": "probably you should grab the size instead of ignoring and maybe print string(received[:size]), but a bunch of nulls wouldnt cause it to freeze... random binary data in the packet may cause your terminal to go weird... maybe run your app and pipe to hexdump or something"}, {"owner": {"reputation": 31, "user_id": 3741158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/011616892bc352d1ba2487497b5ddbdd?s=128&d=identicon&r=PG&f=1", "display_name": "user3741158", "link": "https://stackoverflow.com/users/3741158/user3741158"}, "edited": false, "score": 0, "creation_date": 1428757100, "post_id": 29577551, "comment_id": 47304547, "body": "It might be the terminal going weird, but it do seem to have something to do with the size of the receive buffer. When I decrease the size from 1024 to 100 it runs for a longer time, but freezes eventually. Thanks for your help! I think I can fix this with some trial and error."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1428772991, "post_id": 29577551, "comment_id": 47309968, "body": "Did you try not calling <code>go receiveMessage</code> and just printing?"}, {"owner": {"reputation": 31, "user_id": 3741158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/011616892bc352d1ba2487497b5ddbdd?s=128&d=identicon&r=PG&f=1", "display_name": "user3741158", "link": "https://stackoverflow.com/users/3741158/user3741158"}, "edited": false, "score": 0, "creation_date": 1428921873, "post_id": 29577551, "comment_id": 47352487, "body": "Yes, I&#39;ve tried that as well. It works for a little while, then stops working. It seems the problem was a bit bigger than I imagined, so I haven&#39;t found a solution yet. Tried using json, but the problem is still the same."}], "owner": {"reputation": 31, "user_id": 3741158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/011616892bc352d1ba2487497b5ddbdd?s=128&d=identicon&r=PG&f=1", "display_name": "user3741158", "link": "https://stackoverflow.com/users/3741158/user3741158"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574856790, "creation_date": 1428753189, "last_edit_date": 1574856790, "question_id": 29577551, "link": "https://stackoverflow.com/questions/29577551/go-udp-message-receiving-freezes", "title": "Go UDP message-receiving freezes", "body": "<p>I am trying to write a program that communicates over UDP using Go. </p>\n\n<p>It's supposed to have a master/slave architecture, and therefore I want the master to send an \"alive\"-signal ten times a second. Since I also want the master to listen for messages from the slaves, I start a goroutine with the receive function. </p>\n\n<p>In testing I only use one computer, so that the only thing it receives is it's own alive-signal. Yet, after receiving about 20 messages the program freezes. </p>\n\n<p>I've tried running the program only sending messages, and it doesn't freeze. Here is the receive function:</p>\n\n<pre><code>func receive(conn *net.UDPConn){\n  //Receive message from network\n  received := make([]byte,1024)\n  for ; true ; {\n    _, _, _ = conn.ReadFromUDP(received)\n    println(\"Motatt: \", string(received))\n    go receiveMessage(string(received))\n  }\n}\n</code></pre>\n\n<p>The function receiveMessage() is simply a function that reads the message it has received.</p>\n\n<p>What I am wondering is if there is a setting or something in GO that causes the freeze? As far as I understand it cannot be a deadline error since there are messages to receive.</p>\n"}, {"tags": ["concurrency", "go", "mutex", "goroutine"], "comments": [{"owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "edited": false, "score": 1, "creation_date": 1428749479, "post_id": 29576950, "comment_id": 47302391, "body": "Could you please supply a minimal code snippet that compiles? Also, try <a href=\"https://blog.golang.org/go-fmt-your-code\" rel=\"nofollow noreferrer\">blog.golang.org/go-fmt-your-code</a>"}, {"owner": {"reputation": 423, "user_id": 4352619, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/OvTNb.png?s=128&g=1", "display_name": "Pikapops", "link": "https://stackoverflow.com/users/4352619/pikapops"}, "reply_to_user": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "edited": false, "score": 0, "creation_date": 1428750374, "post_id": 29576950, "comment_id": 47302636, "body": "It&#39;s a bit of mess because I&#39;m working on it but <a href=\"https://play.golang.org/p/M0iR3G6oUu\" rel=\"nofollow noreferrer\">play.golang.org/p/M0iR3G6oUu</a>"}, {"owner": {"reputation": 3647, "user_id": 371191, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e1caa49eebfe37ffe3ef64e19364b0b3?s=128&d=identicon&r=PG", "display_name": "Silly Freak", "link": "https://stackoverflow.com/users/371191/silly-freak"}, "edited": false, "score": 0, "creation_date": 1428752526, "post_id": 29576950, "comment_id": 47303258, "body": "that doesn&#39;t seem minimal, and a question&#39;s &quot;meat&quot; must be in the question itself anyway"}, {"owner": {"reputation": 7031, "user_id": 28855, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8a62c5134a4ff7b618582d8dd267d2b5?s=128&d=identicon&r=PG", "display_name": "Jaime Soriano", "link": "https://stackoverflow.com/users/28855/jaime-soriano"}, "edited": false, "score": 0, "creation_date": 1428752605, "post_id": 29576950, "comment_id": 47303281, "body": "I&#39;m not sure of understanding what you&#39;re trying to do, but maybe instead of using this <code>Finished</code> variable you should put in mutual exclusion the full operation, i.e: <code>Lock</code> the mutex when you set <code>Finished = true</code> , and Unlock it when the operation finish. For what I see, you&#39;re only putting in mutual exclusion the modifications of <code>Finished</code> variable."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 4, "last_activity_date": 1428755392, "creation_date": 1428755392, "answer_id": 29577889, "question_id": 29576950, "link": "https://stackoverflow.com/questions/29576950/problems-with-mutex-locking-in-go/29577889#29577889", "title": "Problems with Mutex Locking in Go", "body": "<blockquote>\n  <p><a href=\"http://golang.org/ref/spec\" rel=\"nofollow\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"http://golang.org/ref/spec#Go_statements\" rel=\"nofollow\">Go statements</a></p>\n  \n  <p>A \"go\" statement starts the execution of a function call as an\n  independent concurrent thread of control, or goroutine, within the\n  same address space. </p>\n  \n  <p>The function value and parameters are evaluated as usual in the\n  calling goroutine, but unlike with a regular call, program execution\n  does not wait for the invoked function to complete. Instead, the\n  function begins executing independently in a new goroutine. When the\n  function terminates, its goroutine also terminates.</p>\n</blockquote>\n\n<p>Your program does not appear to have proper mechanisms to wait until your goroutines complete: \"program execution does not wait for the invoked function to complete.\" To demonstrate this, I inserted a crude wait mechanism at the end of your program <code>main</code> function:</p>\n\n<pre><code>// wait for a while to give goroutines a chance to complete\ntime.Sleep(5 * time.Second)\n</code></pre>\n\n<p>Program: <a href=\"https://play.golang.org/p/ODdEihip4m\" rel=\"nofollow\">https://play.golang.org/p/ODdEihip4m</a></p>\n\n<p>Output:</p>\n\n<pre><code>Toggling Shield\nOpening the shields This is uninteruptable. Please wait...\nMove!!\n\nOn 10/10\nOn 10/9\nOn 10/8\nOn 10/7\nOn 10/6\n\nProgram exited.\n</code></pre>\n"}], "owner": {"reputation": 423, "user_id": 4352619, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/OvTNb.png?s=128&g=1", "display_name": "Pikapops", "link": "https://stackoverflow.com/users/4352619/pikapops"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1186, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1428755392, "creation_date": 1428748950, "last_edit_date": 1428752890, "question_id": 29576950, "link": "https://stackoverflow.com/questions/29576950/problems-with-mutex-locking-in-go", "title": "Problems with Mutex Locking in Go", "body": "<p>Everything works great apart from the mutex. After I lock and unlock, it won't do anything. Is there something obvious I'm missing?</p>\n\n<p>On top of this, after unlocking, I want to run a function inside this function. I've tried just calling it as a regular function (timer()) and even (go timer()).     </p>\n\n<pre><code>func shield(state *State){\n    for s := range state.ToggleShield { //run if data on channel\n        if s == true { //if data on channel is true\n            fmt.Println(\"Opening the shields This is uninteruptable. Please wait...\")\n\n            state.VariableMutex.Lock()\n            state.Finished = false //disable other commands\n            state.VariableMutex.Unlock()\n\n            fmt.Println(\"Move!!\")\n            ticker := time.Tick(time.Second)\n            for i := 10; i &gt;= 0; i-- {\n                &lt;-ticker\n                fmt.Printf(\"\\rOn 10/%d\", i)\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["bash", "go", "sudo", "bootstrapper"], "answers": [{"tags": [], "owner": {"reputation": 717, "user_id": 1754290, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/WG1Wc.jpg?s=128&g=1", "display_name": "MikeKlemin", "link": "https://stackoverflow.com/users/1754290/mikeklemin"}, "is_accepted": false, "score": 0, "last_activity_date": 1428775740, "creation_date": 1428775740, "answer_id": 29581303, "question_id": 29576770, "link": "https://stackoverflow.com/questions/29576770/go-lang-installation-issues-with-make-bash-ubuntu-windows/29581303#29581303", "title": "Go lang installation issues with ./make.bash ubuntu-&gt;windows", "body": "<p>I think it somehow connected to Debian/Ubuntu thing. I seen such issues but related to 0.9. version. </p>\n\n<p>I have installed go from source into ~/go and then everything went quite OK, now I can compile to windows from ubuntu with help <a href=\"http://dave.cheney.net/2012/09/08/an-introduction-to-cross-compilation-with-go\" rel=\"nofollow\">Introduction to cross compilation with go</a> and <a href=\"https://github.com/visualfc/liteide\" rel=\"nofollow\">LiteIDE</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 717, "user_id": 1754290, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/WG1Wc.jpg?s=128&g=1", "display_name": "MikeKlemin", "link": "https://stackoverflow.com/users/1754290/mikeklemin"}, "edited": false, "score": 0, "creation_date": 1428777524, "post_id": 29581570, "comment_id": 47311513, "body": "Thank you! I had same thoughts, that may be I need to set up EXPORTS in /root/.bashrc ... But then I decided to try to get it install from source, and it worked... I can not verify now your suggestion, but I nearly sure you are right."}], "tags": [], "owner": {"reputation": 7031, "user_id": 28855, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8a62c5134a4ff7b618582d8dd267d2b5?s=128&d=identicon&r=PG", "display_name": "Jaime Soriano", "link": "https://stackoverflow.com/users/28855/jaime-soriano"}, "is_accepted": false, "score": 1, "last_activity_date": 1428777192, "creation_date": 1428777192, "answer_id": 29581570, "question_id": 29576770, "link": "https://stackoverflow.com/questions/29576770/go-lang-installation-issues-with-make-bash-ubuntu-windows/29581570#29581570", "title": "Go lang installation issues with ./make.bash ubuntu-&gt;windows", "body": "<p><code>sudo</code> can clean environment variables, to check if that is the case here, run <code>sudo $(which go) env</code> and check if the output is what you expect. If not, you can keep the enviroment of your user by using the <code>-E</code> flag: <code>sudo -E ./make.bash</code>.</p>\n"}], "owner": {"reputation": 717, "user_id": 1754290, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/WG1Wc.jpg?s=128&g=1", "display_name": "MikeKlemin", "link": "https://stackoverflow.com/users/1754290/mikeklemin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1441152874, "creation_date": 1428747801, "last_edit_date": 1441152874, "question_id": 29576770, "link": "https://stackoverflow.com/questions/29576770/go-lang-installation-issues-with-make-bash-ubuntu-windows", "title": "Go lang installation issues with ./make.bash ubuntu-&gt;windows", "body": "<p>I have tried to search and found a lot of topics which are related to my problem, but none of them I could follow to success. \nI can <code>go run</code> and <code>go get</code> with no issues, but I need to compile into windows and there I have problems please see bellow</p>\n\n<pre><code>mikhail@mikhail-desktop:/usr/lib/go/src$ sudo ./make.bash \n# Building C bootstrap tool.\ncmd/dist\ngo tool dist: $GOROOT is not set correctly or not exported\n    GOROOT=/usr/share/go\n    /usr/share/go/include/u.h does not exist\nmikhail@mikhail-desktop:/usr/lib/go/src$ go env\nGOARCH=\"amd64\"\nGOBIN=\"\"\nGOCHAR=\"6\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/mikhail/Documents/FL/0go\"\nGORACE=\"\"\nGOROOT=\"/usr/lib/go\"\nGOTOOLDIR=\"/usr/lib/go/pkg/tool/linux_amd64\"\nTERM=\"dumb\"\nCC=\"gcc\"\nGOGCCFLAGS=\"-g -O2 -fPIC -m64 -pthread\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\nmikhail@mikhail-desktop:/usr/lib/go/src$ \n</code></pre>\n\n<p>By some reasons it thinks the GOROOT is <code>/usr/share/go</code> while it actually <code>/usr/lib/go</code></p>\n"}, {"tags": ["go", "docker"], "answers": [{"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 3847, "user_id": 251840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e3bf4bcc6dfbe7c13231f914334db925?s=128&d=identicon&r=PG", "display_name": "jwesonga", "link": "https://stackoverflow.com/users/251840/jwesonga"}, "edited": false, "score": 0, "creation_date": 1428749883, "post_id": 29576600, "comment_id": 47302503, "body": "@jwesonga can you check the version of pip used in your docker container?"}, {"owner": {"reputation": 3847, "user_id": 251840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e3bf4bcc6dfbe7c13231f914334db925?s=128&d=identicon&r=PG", "display_name": "jwesonga", "link": "https://stackoverflow.com/users/251840/jwesonga"}, "edited": false, "score": 0, "creation_date": 1428751086, "post_id": 29576600, "comment_id": 47302827, "body": "How do I check that within the docker container? Just as an aside I&#39;m on OSX"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 3847, "user_id": 251840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e3bf4bcc6dfbe7c13231f914334db925?s=128&d=identicon&r=PG", "display_name": "jwesonga", "link": "https://stackoverflow.com/users/251840/jwesonga"}, "edited": false, "score": 0, "creation_date": 1428751773, "post_id": 29576600, "comment_id": 47303028, "body": "@jwesonga <a href=\"http://stackoverflow.com/a/27708039/6309\">stackoverflow.com/a/27708039/6309</a>: <code>docker exec &lt;container_id&gt; pip -V</code>"}, {"owner": {"reputation": 3847, "user_id": 251840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e3bf4bcc6dfbe7c13231f914334db925?s=128&d=identicon&r=PG", "display_name": "jwesonga", "link": "https://stackoverflow.com/users/251840/jwesonga"}, "edited": false, "score": 0, "creation_date": 1428753729, "post_id": 29576600, "comment_id": 47303608, "body": "@VoncC since the container isn&#39;t actually running (related to the error above) I can&#39;t get the container ID, or may be I&#39;m doing it wrong. I tried: &quot;docker ps&quot; and got: FATA[0032] An error occurred trying to connect: Get <a href=\"https://192.168.59.104:2376/v1.17/containers/json\" rel=\"nofollow noreferrer\">192.168.59.104:2376/v1.17/containers/json</a>: dial tcp 192.168.59.104:2376: i/o timeout"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 3847, "user_id": 251840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e3bf4bcc6dfbe7c13231f914334db925?s=128&d=identicon&r=PG", "display_name": "jwesonga", "link": "https://stackoverflow.com/users/251840/jwesonga"}, "edited": false, "score": 0, "creation_date": 1428760814, "post_id": 29576600, "comment_id": 47305731, "body": "@jwesonga are you behind a proxy?"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 4, "last_activity_date": 1428746830, "creation_date": 1428746830, "answer_id": 29576600, "question_id": 29576087, "link": "https://stackoverflow.com/questions/29576087/golang-preview-of-managed-vm-app-returns-error/29576600#29576600", "title": "Golang: Preview of managed VM app returns error", "body": "<p>The main issue is:</p>\n\n<pre><code>File \"/Users/jwesonga/google-cloud-sdk/platform/google_appengine\n       /lib/requests/requests/adapters.py\", line 384, in send\n    raise Timeout(e, request=request)\nrequests.exceptions.Timeout:   \n(&lt;requests.packages.urllib3.connection.VerifiedHTTPSConnection object \nat 0x10631c7d0&gt;, 'Connection to 192.168.59.104 timed out. \n(connect timeout=60)')\nERROR: (gcloud.preview.app.run) DevAppSever failed with error code [1]\n</code></pre>\n\n<p>Which is often the case when you have a proxy, and is discussed in <a href=\"https://github.com/pypa/pip/issues/1805\" rel=\"nofollow\">pip issue 1805</a></p>\n\n<p>It is supposed to be fixed in pip1.6, but just in case, you can try the <a href=\"https://github.com/pypa/pip/issues/1805#issuecomment-47827439\" rel=\"nofollow\">workaround of  alexandrem</a></p>\n\n<pre><code>/opt/venvs/ironic/lib/python2.6/site-packages/pip/_vendor/requests\n/adapters.patch.py /opt/venvs/ironic/lib/python2.6/site-packages\n/pip/_vendor/requests/adapters.py\n209c209\nif True or not proxy in self.proxy_manager:\n   ^^^^\n</code></pre>\n\n<blockquote>\n  <p>basically I just add a True to the condition on line 209 of the adapter.py to always create a ProxyManager instance, thus skipping the pool manager logic.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 3847, "user_id": 251840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e3bf4bcc6dfbe7c13231f914334db925?s=128&d=identicon&r=PG", "display_name": "jwesonga", "link": "https://stackoverflow.com/users/251840/jwesonga"}, "edited": false, "score": 0, "creation_date": 1429161180, "post_id": 29659558, "comment_id": 47470595, "body": "I ran &quot;sudo docker -d&quot; and got &quot;This is a client-only binary - running the Docker daemon is not supported&quot;"}, {"owner": {"reputation": 3847, "user_id": 251840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e3bf4bcc6dfbe7c13231f914334db925?s=128&d=identicon&r=PG", "display_name": "jwesonga", "link": "https://stackoverflow.com/users/251840/jwesonga"}, "edited": false, "score": 0, "creation_date": 1429163459, "post_id": 29659558, "comment_id": 47471450, "body": "Found out what the &quot;problem&quot; is, for some weird reason I have to run &quot;eval &quot;$(boot2docker shellinit)&quot; in the terminal before running &quot;gcloud preview app run &lt;path&gt;&quot; If I open a new terminal I have to repeat the process again. I didn&#39;t think this was the case since I added the environment variables to my ~/.bash_profile, is this the intended behavior?"}, {"owner": {"reputation": 468, "user_id": 4220804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72fe63cbd6411959d9d7d1eaa7f7f765?s=128&d=identicon&r=PG&f=1", "display_name": "Shobhit", "link": "https://stackoverflow.com/users/4220804/shobhit"}, "reply_to_user": {"reputation": 3847, "user_id": 251840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e3bf4bcc6dfbe7c13231f914334db925?s=128&d=identicon&r=PG", "display_name": "jwesonga", "link": "https://stackoverflow.com/users/251840/jwesonga"}, "edited": false, "score": 0, "creation_date": 1429190242, "post_id": 29659558, "comment_id": 47489414, "body": "@jwesonga: you can also try echo export DOCKER_HOST=tcp://ip:port &gt;&gt; ~/.bashrc &amp;&amp; source ~/.bashrc, and then run source .bash_profile and see if it works."}], "tags": [], "owner": {"reputation": 468, "user_id": 4220804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72fe63cbd6411959d9d7d1eaa7f7f765?s=128&d=identicon&r=PG&f=1", "display_name": "Shobhit", "link": "https://stackoverflow.com/users/4220804/shobhit"}, "is_accepted": false, "score": 0, "last_activity_date": 1429127455, "creation_date": 1429127455, "answer_id": 29659558, "question_id": 29576087, "link": "https://stackoverflow.com/questions/29576087/golang-preview-of-managed-vm-app-returns-error/29659558#29659558", "title": "Golang: Preview of managed VM app returns error", "body": "<p>The gcloud command enable the ah_host process and also created the docker image of your app and passes it to the Docker daemon, in your case it seems that your docker daemon is not responding to the request. So to make sure,perform \"sudo docker -d\"  to check if the Docker daemon is running on your machine or not.\nAlso check that, the path of the certificate you set correctly and value of the TLS_VERIFY is TRUE.</p>\n\n<p>Go through the documentation [1] for the installation of Docker on MacOS</p>\n\n<p>[1] <a href=\"https://docs.docker.com/installation/mac/\" rel=\"nofollow\">https://docs.docker.com/installation/mac/</a></p>\n"}], "owner": {"reputation": 3847, "user_id": 251840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e3bf4bcc6dfbe7c13231f914334db925?s=128&d=identicon&r=PG", "display_name": "jwesonga", "link": "https://stackoverflow.com/users/251840/jwesonga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 1, "answer_count": 2, "score": 12, "last_activity_date": 1429127455, "creation_date": 1428743360, "question_id": 29576087, "link": "https://stackoverflow.com/questions/29576087/golang-preview-of-managed-vm-app-returns-error", "title": "Golang: Preview of managed VM app returns error", "body": "<p>I'm trying to preview a Go docker (App Engine ManagedVM) app using the  gcloud preview app run  command.</p>\n\n<p>But I keep getting this error:</p>\n\n<pre><code>Traceback (most recent call last):\n  File \"/Users/jwesonga/google-cloud-sdk/platform/google_appengine/dev_appserver.py\", line 83, in &lt;module&gt;\n    _run_file(__file__, globals())\n  File \"/Users/jwesonga/google-cloud-sdk/platform/google_appengine/dev_appserver.py\", line 79, in _run_file\n    execfile(_PATHS.script_file(script_name), globals_)\n  File \"/Users/jwesonga/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/devappserver2.py\", line 985, in &lt;module&gt;\n    main()\n  File \"/Users/jwesonga/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/devappserver2.py\", line 978, in main\n    dev_server.start(options)\n  File \"/Users/jwesonga/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/devappserver2.py\", line 774, in start\n    self._dispatcher.start(options.api_host, apis.port, request_data)\n  File \"/Users/jwesonga/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/dispatcher.py\", line 182, in start\n    _module, port = self._create_module(module_configuration, port)\n  File \"/Users/jwesonga/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/dispatcher.py\", line 262, in _create_module\n    threadsafe_override=threadsafe_override)\n  File \"/Users/jwesonga/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/module.py\", line 1463, in __init__\n    super(ManualScalingModule, self).__init__(**kwargs)\n  File \"/Users/jwesonga/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/module.py\", line 514, in __init__\n    self._module_configuration)\n  File \"/Users/jwesonga/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/module.py\", line 237, in _create_instance_factory\n    module_configuration=module_configuration)\n  File \"/Users/jwesonga/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/vm_runtime_factory.py\", line 78, in __init__\n    timeout=self.DOCKER_D_REQUEST_TIMEOUT_SECS)\n  File \"/Users/jwesonga/google-cloud-sdk/platform/google_appengine/google/appengine/tools/docker/containers.py\", line 740, in NewDockerClient\n    client.ping()\n  File \"/Users/jwesonga/google-cloud-sdk/./lib/docker/docker/client.py\", line 711, in ping\n    return self._result(self._get(self._url('/_ping')))\n  File \"/Users/jwesonga/google-cloud-sdk/./lib/docker/docker/client.py\", line 76, in _get\n    return self.get(url, **self._set_request_timeout(kwargs))\n  File \"/Users/jwesonga/google-cloud-sdk/platform/google_appengine/lib/requests/requests/sessions.py\", line 468, in get\n    return self.request('GET', url, **kwargs)\n  File \"/Users/jwesonga/google-cloud-sdk/platform/google_appengine/lib/requests/requests/sessions.py\", line 456, in request\n    resp = self.send(prep, **send_kwargs)\n  File \"/Users/jwesonga/google-cloud-sdk/platform/google_appengine/lib/requests/requests/sessions.py\", line 559, in send\n    r = adapter.send(request, **kwargs)\n  File \"/Users/jwesonga/google-cloud-sdk/platform/google_appengine/lib/requests/requests/adapters.py\", line 384, in send\n    raise Timeout(e, request=request)\nrequests.exceptions.Timeout: (&lt;requests.packages.urllib3.connection.VerifiedHTTPSConnection object at 0x10631c7d0&gt;, 'Connection to 192.168.59.104 timed out. (connect timeout=60)')\nERROR: (gcloud.preview.app.run) DevAppSever failed with error code [1]\n</code></pre>\n\n<p>I've confirmed that docker is up and running using <strong>boot2docker status</strong> which returns <strong>running</strong> This was working before but after a machine reboot, nothing seems to work. Any ideas?</p>\n"}, {"tags": ["go", "routing", "mux", "gorilla"], "answers": [{"tags": [], "owner": {"reputation": 511, "user_id": 4776541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f8866d18763d3a2e131f55c46747459?s=128&d=identicon&r=PG&f=1", "display_name": "Kortemy", "link": "https://stackoverflow.com/users/4776541/kortemy"}, "is_accepted": true, "score": 25, "last_activity_date": 1428756792, "creation_date": 1428756792, "answer_id": 29578083, "question_id": 29575972, "link": "https://stackoverflow.com/questions/29575972/nesting-subrouters-in-gorilla-mux/29578083#29578083", "title": "Nesting subrouters in Gorilla Mux", "body": "<p>I figured it out, so I'll just post it here in case someone is as stupid as I was. :D</p>\n\n<p>When creating path-based subrouter, you have to obtain it with <code>PathPrefix</code> instead of <code>Path</code>.</p>\n\n<pre><code>r.PathPrefix(\"/api\").Subrouter()\n</code></pre>\n\n<p>Use <code>r.Path(\"/api\")</code> only when attaching handlers to that endpoint.</p>\n"}, {"tags": [], "owner": {"reputation": 793, "user_id": 90506, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a4bffdc2e88202aa1c2b74e165355199?s=128&d=identicon&r=PG", "display_name": "farhany", "link": "https://stackoverflow.com/users/90506/farhany"}, "is_accepted": false, "score": 0, "last_activity_date": 1585611621, "creation_date": 1585611621, "answer_id": 60941265, "question_id": 29575972, "link": "https://stackoverflow.com/questions/29575972/nesting-subrouters-in-gorilla-mux/60941265#60941265", "title": "Nesting subrouters in Gorilla Mux", "body": "<p>If you need to Separate out the UI and API routers, you can simply do what the OP suggested:</p>\n\n<pre><code>appRouter := r.PathPrefix(\"/\").Subrouter()\nappRouter.Use(myAppRouter)\napiRouter := r.PathPrefix(\"/api\").Subrouter()\napiRouter.Use(myAPIRouter)\n</code></pre>\n\n<p>Many thanks for the OP for providing the answer. Hopefully having it all in one place for my use case will help someone.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14153748, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-z1P-hkr1DkU/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucluYXzpqucL-txuMuqWjdpdzlQ2Hg/photo.jpg?sz=128", "display_name": "mikhailb", "link": "https://stackoverflow.com/users/14153748/mikhailb"}, "is_accepted": false, "score": 0, "last_activity_date": 1611326430, "creation_date": 1611326430, "answer_id": 65847233, "question_id": 29575972, "link": "https://stackoverflow.com/questions/29575972/nesting-subrouters-in-gorilla-mux/65847233#65847233", "title": "Nesting subrouters in Gorilla Mux", "body": "<p>For those who are struggling to split between auth and noauth routes, the following works fine for me:</p>\n<pre><code>r := mux.NewRouter()\n\nnoAuthRouter := r.MatcherFunc(func(r *http.Request, rm *mux.RouteMatch) bool {\n    return r.Header.Get(&quot;Authorization&quot;) == &quot;&quot;\n}).Subrouter()\n\nauthRouter := r.MatcherFunc(func(r *http.Request, rm *mux.RouteMatch) bool {\n    return true\n}).Subrouter()\n</code></pre>\n<p>Then you can apply middleware for authRouter only</p>\n"}], "owner": {"reputation": 511, "user_id": 4776541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f8866d18763d3a2e131f55c46747459?s=128&d=identicon&r=PG&f=1", "display_name": "Kortemy", "link": "https://stackoverflow.com/users/4776541/kortemy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6495, "favorite_count": 6, "accepted_answer_id": 29578083, "answer_count": 3, "score": 15, "last_activity_date": 1611326430, "creation_date": 1428742428, "last_edit_date": 1494138285, "question_id": 29575972, "link": "https://stackoverflow.com/questions/29575972/nesting-subrouters-in-gorilla-mux", "title": "Nesting subrouters in Gorilla Mux", "body": "<p>I've been using <a href=\"https://github.com/gorilla/mux\" rel=\"noreferrer\"><code>gorilla/mux</code></a> for my routing needs. But I noticed one problem, when I nest multiple Subrouters it doesn't work.</p>\n\n<p>Here is the example:</p>\n\n<pre><code>func main() {\n    r := mux.NewRouter().StrictSlash(true)\n    api := r.Path(\"/api\").Subrouter()\n    u := api.Path(\"/user\").Subrouter()\n    u.Methods(\"GET\").HandleFunc(UserHandler)\n    http.ListenAndServe(\":8080\", r)\n}\n</code></pre>\n\n<p>I wanted to use this approach so I can delegate populating the router to some other package, for example <code>user.Populate(api)</code></p>\n\n<p>However this doesn't seem to work. It works only if I use single Subrouter in the chain.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 14145, "user_id": 1255956, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a6a3498ebb173fb2373fded6f46d65fd?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1255956/chris"}, "edited": false, "score": 0, "creation_date": 1428806642, "post_id": 29585197, "comment_id": 47318973, "body": "I was afraid that was the answer. Is there any way to pass it something other than *http.Request? Or a fake *http.Request of some type? Im trying to NOT use a request handler if at all possible. Thank you."}, {"owner": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "reply_to_user": {"reputation": 14145, "user_id": 1255956, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a6a3498ebb173fb2373fded6f46d65fd?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1255956/chris"}, "edited": false, "score": 0, "creation_date": 1428854234, "post_id": 29585197, "comment_id": 47329798, "body": "I&#39;m not sure what your goal is, but app engine won&#39;t run any code at all without a request starting your instance first, so even if you could do this, there would be no way to have the code execute. What exactly is the requirement you&#39;re trying to solve?"}, {"owner": {"reputation": 14145, "user_id": 1255956, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a6a3498ebb173fb2373fded6f46d65fd?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1255956/chris"}, "edited": false, "score": 0, "creation_date": 1428863372, "post_id": 29585197, "comment_id": 47332791, "body": "Ohhhhhhhh +1. i didnt know that, but it answers my question! Thanks so much for following back up"}], "tags": [], "owner": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "is_accepted": true, "score": 2, "last_activity_date": 1428804634, "creation_date": 1428804634, "answer_id": 29585197, "question_id": 29574207, "link": "https://stackoverflow.com/questions/29574207/go-gae-newcontext/29585197#29585197", "title": "Go Gae NewContext", "body": "<p>You need an appengine.Context to interact with external services, including email and urlfetch. You will have to pass the Context instance into your <code>confirm</code> function. </p>\n"}], "owner": {"reputation": 14145, "user_id": 1255956, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a6a3498ebb173fb2373fded6f46d65fd?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1255956/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 29585197, "answer_count": 1, "score": 1, "last_activity_date": 1428804634, "creation_date": 1428727359, "last_edit_date": 1428783820, "question_id": 29574207, "link": "https://stackoverflow.com/questions/29574207/go-gae-newcontext", "title": "Go Gae NewContext", "body": "<p>I'm using Go on GAE. One of my tasks is sending an email. I am using <a href=\"https://cloud.google.com/appengine/docs/go/mail/#Go_Sending_mail_in_Go\" rel=\"nofollow\">this</a> documentation successfully to test.</p>\n\n<p>However, what if I do not want a request handler:</p>\n\n<pre><code>func confirm(w http.ResponseWriter, r *http.Request) {\n        c := appengine.NewContext(r)\n                    ...\n</code></pre>\n\n<p>But rather, send the email through a local func:</p>\n\n<pre><code>func confirm() {\n...\n</code></pre>\n\n<p>Is there any way in Go to do this with GAE? I <em>think</em> what Im looking for is a way to call:</p>\n\n<pre><code>c := appengine.NewContext(r)\n</code></pre>\n\n<p>But without a request handler, or bypass it in any way possible (which Im reading is probably not possible)</p>\n\n<p>I am thinking a work around could be making an <a href=\"http://golang.org/pkg/net/http/\" rel=\"nofollow\">http request</a> from my application to my application - but wow is that ugly!</p>\n\n<pre><code>resp, err := http.Get(\"http://localhost:8080/sendMail?to=...\")\n</code></pre>\n\n<p>NOTE: After attempting this -- ugly work around I get:\nhttp.DefaultTransport and http.DefaultClient are not available in App Engine. See <a href=\"https://cloud.google.com/appengine/docs/go/urlfetch/\" rel=\"nofollow\">https://cloud.google.com/appengine/docs/go/urlfetch/</a></p>\n\n<p>So this workaround is in fact NOT a work around in that <code>urlfetch</code> which is how GAE uses http.GET once again... requires <code>c := appengine.NewContext(r)</code></p>\n"}, {"tags": ["go", "deadlock", "channel", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 4456585, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tYFONOxMPpk/AAAAAAAAAAI/AAAAAAAABGg/aApD3Zf6h4w/photo.jpg?sz=128", "display_name": "Sacheendra Talluri", "link": "https://stackoverflow.com/users/4456585/sacheendra-talluri"}, "edited": false, "score": 0, "creation_date": 1428835294, "post_id": 29573528, "comment_id": 47324328, "body": "I needed to close the channels and reduce the number of responses to wait for after some of the person goroutines have finished executing. Thank you for the help."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 2, "last_activity_date": 1428721093, "last_edit_date": 1428721093, "creation_date": 1428720726, "answer_id": 29573528, "question_id": 29573148, "link": "https://stackoverflow.com/questions/29573148/deadlock-in-housie-program-producer-consumer-pattern/29573528#29573528", "title": "Deadlock in Housie Program. Producer-Consumer Pattern", "body": "<p>Few problems:</p>\n\n<ol>\n<li><p>You're using a nil channel, so it just blocks forever, for some reason it's not panicing.</p></li>\n<li><p>Also, your second inner loop will block indefinitely because it's waiting to read but nothing is being sent.</p></li>\n<li><p>After your <code>Person</code>'s loop ends, <code>called_number &lt;- num</code> will block forever.</p></li>\n</ol>\n\n<p>//edit\nKinda-working-code : <a href=\"http://play.golang.org/p/3At5nuJTuk\" rel=\"nofollow\">http://play.golang.org/p/3At5nuJTuk</a></p>\n\n<p>But the logic is flawed, you will have to rethink it.</p>\n"}], "owner": {"reputation": 59, "user_id": 4456585, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tYFONOxMPpk/AAAAAAAAAAI/AAAAAAAABGg/aApD3Zf6h4w/photo.jpg?sz=128", "display_name": "Sacheendra Talluri", "link": "https://stackoverflow.com/users/4456585/sacheendra-talluri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 29573528, "answer_count": 1, "score": 2, "last_activity_date": 1483433495, "creation_date": 1428717156, "last_edit_date": 1483433495, "question_id": 29573148, "link": "https://stackoverflow.com/questions/29573148/deadlock-in-housie-program-producer-consumer-pattern", "title": "Deadlock in Housie Program. Producer-Consumer Pattern", "body": "<p>I am trying to implement a housie game where a goroutine produces numbers, 3 other goroutines check if these are in their tokens and inform the producer if all their numbers were produced. I have implemented it in golang in the following way. This results in a deadlock. Any idea why this is happening? This is a \"homework problem\", I am just implementing it in go to learn go better. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n)\n\ntype PersonID int\n\nfunc contains(s []int, e int) bool {\n    for _, a := range s {\n        if a == e {\n            return true\n        }\n    }\n    return false\n}\n\nfunc Person(called_number chan int, claim_prize chan PersonID, received chan bool, coupon []int, person_id PersonID) {\n    numFound := 0\n    for i := 0; i &lt; len(coupon); i++ {\n        current_number := &lt;-called_number\n        found := contains(coupon, current_number)\n        if found {\n            numFound++\n        }\n        if numFound == len(coupon) {\n            claim_prize &lt;- person_id\n        } else {\n            received &lt;- true\n        }\n    }\n}\n\nfunc main() {\n    var called_number chan int\n    var claim_prize chan PersonID\n    var received chan bool\n\n    tokens := make([][]int, 3)\n    for i := 0; i &lt; 3; i++ {\n        tokens[i] = make([]int, 12)\n        for j := 0; j &lt; 12; j++ {\n            num := rand.Intn(100) + 1\n            found := contains(tokens[i], num)\n            for found {\n                num = rand.Intn(100) + 1\n                found = contains(tokens[i], num)\n            }\n            tokens[i][j] = num\n        }\n    }\n\n    go Person(called_number, claim_prize, received, tokens[0], 0)\n    go Person(called_number, claim_prize, received, tokens[1], 1)\n    go Person(called_number, claim_prize, received, tokens[2], 2)\n\n    claimants := make([]PersonID, 0)\n    prev_called := make(map[int]bool)\n    for i := 0; i &lt; 100; i++ {\n        if len(claimants) == 3 {\n            break\n        }\n        num := rand.Intn(100) + 1\n        _, ok := prev_called[num]\n        for ok {\n            num = rand.Intn(100) + 1\n            _, ok = prev_called[num]\n        }\n        prev_called[num] = true\n        called_number &lt;- num\n        for j := 0; j &lt; 3; j++ {\n            select {\n            case _ = &lt;-received:\n                continue\n            case pid := &lt;-claim_prize:\n                claimants = append(claimants, pid)\n            }\n        }\n    }\n\n    fmt.Println(claimants)\n}\n</code></pre>\n\n<p>EDIT:\nThe exact problem is that that the producer needs to send the number to each of the consumers. When a consumer receives all the numbers in it's token, it can claim the prize. Based on what @OneOfOne said, I have made some changes to the program. The changes are that now there is a separate channels for each of the consumers and I am closing it after it claims a prize. Below is the new program, it still deadlocks. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n)\n\nfunc contains(s []int, e int) bool {\n    for _, a := range s {\n        if a == e {\n            return true\n        }\n    }\n    return false\n}\n\nfunc Person(called_number chan int, claim_prize chan int, received chan bool, coupon []int, person_id int) {\n    numFound := 0\n    for current_number := range called_number {\n        if contains(coupon, current_number) {\n            numFound++\n        }\n        if numFound == len(coupon) {\n            fmt.Println(person_id)\n            claim_prize &lt;- person_id\n        } else {\n            received &lt;- true\n        }\n    }\n}\n\nfunc main() {\n    var (\n        called_number1 = make(chan int, 1)\n        called_number2 = make(chan int, 1)\n        called_number3 = make(chan int, 1)\n        claim_prize    = make(chan int, 1)\n        received       = make(chan bool, 1)\n    )\n\n    tokens := make([][]int, 3)\n    for i := 0; i &lt; 3; i++ {\n        tokens[i] = make([]int, 12)\n        for j := 0; j &lt; 12; j++ {\n            num := rand.Intn(100) + 1\n            found := contains(tokens[i], num)\n            for found {\n                num = rand.Intn(100) + 1\n                found = contains(tokens[i], num)\n            }\n            tokens[i][j] = num\n        }\n    }\n\n    go Person(called_number1, claim_prize, received, tokens[0], 0)\n    go Person(called_number2, claim_prize, received, tokens[1], 1)\n    go Person(called_number3, claim_prize, received, tokens[2], 2)\n\n    claimants := make([]int, 0)\n    prev_called := make(map[int]bool)\n    for i := 0; i &lt; 100; i++ {\n        if len(claimants) == 3 {\n            break\n        }\n        num := rand.Intn(100) + 1\n        _, ok := prev_called[num]\n        for ok {\n            num = rand.Intn(100) + 1\n            _, ok = prev_called[num]\n        }\n        prev_called[num] = true\n        if !contains(claimants, 0) {\n            called_number1 &lt;- num\n        }\n        if !contains(claimants, 1) {\n            called_number2 &lt;- num\n        }\n        if !contains(claimants, 2) {\n            called_number3 &lt;- num\n        }\n        for j := 0; j &lt; 3; j++ {\n            select {\n            case _ = &lt;-received:\n                continue\n            case pid := &lt;-claim_prize:\n                if pid == 0 { close(called_number1) }\n                if pid == 1 { close(called_number2) }\n                if pid == 2 { close(called_number3) }\n                claimants = append(claimants, pid)\n            }\n        }\n    }\n    fmt.Println(claimants)\n}\n</code></pre>\n\n<p>EDIT2: This still deadlocked because I was not reducing the number of channels to wait for even after the goroutines were completed. Did that and everything works. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 4, "creation_date": 1428697724, "post_id": 29569947, "comment_id": 47289737, "body": "What are you actually trying to accomplish? &#39;making it work&#39; is too ambiguous for me to determine what you want the result to be."}, {"owner": {"reputation": 5911, "user_id": 1870054, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/QJydN.jpg?s=128&g=1", "display_name": "wener", "link": "https://stackoverflow.com/users/1870054/wener"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1428723796, "post_id": 29569947, "comment_id": 47296630, "body": "@evanmcdonnal I update the question,sorry about that I am make it  unclear"}], "answers": [{"comments": [{"owner": {"reputation": 5911, "user_id": 1870054, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/QJydN.jpg?s=128&g=1", "display_name": "wener", "link": "https://stackoverflow.com/users/1870054/wener"}, "edited": false, "score": 0, "creation_date": 1428723628, "post_id": 29570226, "comment_id": 47296602, "body": "What is I have CA CB CC, the func A() of them are same, do I have to copy and past them all ?"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 5911, "user_id": 1870054, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/QJydN.jpg?s=128&g=1", "display_name": "wener", "link": "https://stackoverflow.com/users/1870054/wener"}, "edited": false, "score": 0, "creation_date": 1428745239, "post_id": 29570226, "comment_id": 47301110, "body": "@wener What is <code>A()</code> defined on?"}, {"owner": {"reputation": 5911, "user_id": 1870054, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/QJydN.jpg?s=128&g=1", "display_name": "wener", "link": "https://stackoverflow.com/users/1870054/wener"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1428746160, "post_id": 29570226, "comment_id": 47301378, "body": "@FUZxxl A() in the super B() in the sub, A() will call B()"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 5911, "user_id": 1870054, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/QJydN.jpg?s=128&g=1", "display_name": "wener", "link": "https://stackoverflow.com/users/1870054/wener"}, "edited": false, "score": 0, "creation_date": 1428746352, "post_id": 29570226, "comment_id": 47301440, "body": "@wener Maybe I should ask this in a different way; which type&#39;s attributes and methods does <code>A()</code> access?"}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 1, "last_activity_date": 1428698490, "last_edit_date": 1428698490, "creation_date": 1428698126, "answer_id": 29570226, "question_id": 29569947, "link": "https://stackoverflow.com/questions/29569947/how-to-make-this-go-abstract-type-work/29570226#29570226", "title": "How to make this Go abstract type work?", "body": "<p>No, at least not as you have it designed here. I'm not entirely sure what you're trying to accomplish but this is a very very poor use of embedding. The reason it doesn't work is because the <code>CA</code> type relies on the embedded <code>AbsA</code> type for method <code>A()</code> which then calls a 'method b' but the only actual implementation of <code>B()</code> has CA as the receiving type so once you've calling into the embedded types implementation of <code>A()</code> it can't call back up to the embedding types implementation of <code>B()</code>.</p>\n\n<p>You're treating embedding as if it's a two way street but in reality the embedding type knows all the methods on it's embed and the embed knows nothing about the embeddor. In my personal opinion, this should generate a compiler error. Perhaps in a future release it will (if I can tell at compile time that you will get a run-time error 100% of the time the compiler should able to too, right?).</p>\n\n<p>As it is now you either need to implement <code>B()</code> with a receiver of type <code>Absa</code> or add another implementation of <code>A()</code> with a receiver of type <code>CA</code>. I'm not really sure what you're trying to accomplish so I can't say what the best course of action is. Note that if I were relating this to traditional OOP inheritance I would describe your code as attempting to access properties of a child class from within a parent class, clearly it's not possible. <code>Absa</code> will never be able to call up to an implementation of <code>B()</code> defined for the type embedding it. Just like trying to use a method defined on an inheriting type from the parent would never work or make sense only in most of the OOP languages you would get a compile time error.</p>\n"}, {"comments": [{"owner": {"reputation": 5911, "user_id": 1870054, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/QJydN.jpg?s=128&g=1", "display_name": "wener", "link": "https://stackoverflow.com/users/1870054/wener"}, "edited": false, "score": 0, "creation_date": 1428721796, "post_id": 29570229, "comment_id": 47296326, "body": "Tanks,I want to make a abstract super class, as you can see, the AbsA only implement func A, A only implement B()"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 5911, "user_id": 1870054, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/QJydN.jpg?s=128&g=1", "display_name": "wener", "link": "https://stackoverflow.com/users/1870054/wener"}, "edited": false, "score": 1, "creation_date": 1428746671, "post_id": 29570229, "comment_id": 47301524, "body": "@wener you can&#39;t. Go doesn&#39;t have classes or inheritance. Don&#39;t try to write Java in Go."}, {"owner": {"reputation": 5911, "user_id": 1870054, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/QJydN.jpg?s=128&g=1", "display_name": "wener", "link": "https://stackoverflow.com/users/1870054/wener"}, "edited": false, "score": 0, "creation_date": 1429150365, "post_id": 29570229, "comment_id": 47467637, "body": "\ud83d\ude02,I am a javaer,trying to think in golang."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 3, "last_activity_date": 1428699966, "last_edit_date": 1428699966, "creation_date": 1428698139, "answer_id": 29570229, "question_id": 29569947, "link": "https://stackoverflow.com/questions/29569947/how-to-make-this-go-abstract-type-work/29570229#29570229", "title": "How to make this Go abstract type work?", "body": "<p>I don't know what you're trying to accomplish, but if you're defining structs with embedded interfaces, you need to initialize them.</p>\n\n<p><a href=\"http://play.golang.org/p/C32yWfNDRp\" rel=\"nofollow\">http://play.golang.org/p/C32yWfNDRp</a></p>\n\n<pre><code>var a IA\na = CA{\n    AbsA: AbsA{\n        IA: CA{},\n    },\n}\na.A()\n</code></pre>\n\n<p>If you're expecting OOP inheritance behavior, Go doesn't provide that. Embedding is only a form of automatic delegation. </p>\n"}], "owner": {"reputation": 5911, "user_id": 1870054, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/QJydN.jpg?s=128&g=1", "display_name": "wener", "link": "https://stackoverflow.com/users/1870054/wener"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1428723408, "creation_date": 1428696842, "last_edit_date": 1428723408, "question_id": 29569947, "link": "https://stackoverflow.com/questions/29569947/how-to-make-this-go-abstract-type-work", "title": "How to make this Go abstract type work?", "body": "<pre><code>package main\n\nimport \"fmt\"\n\ntype IA interface {\n    A()\n    B()\n}\n\ntype AbsA struct {\n    IA\n}\n\ntype CA struct {\n    AbsA\n}\n\nfunc (a CA) B() {\n    fmt.Println(\"Show B\")\n}\n\nfunc (a AbsA) A() {\n    fmt.Println(\"Show A\")\n    a.B()\n}\n\nfunc t7() {\n    var a IA\n    a = CA{}\n    a.A()\n}\n\nfunc main() {\n    t7()\n}\n</code></pre>\n\n<p>Running this will get a nil pointer panic, because when <code>AbsA</code> calls <code>B()</code>, it will use the embedded <code>IA</code>, but <code>IA</code> is an interface.</p>\n\n<p>Is there any way to make this work?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I try to make a abstract super class, AbsA only implement part of interface, but it need to use other functions,A is a subclass of AbsA, only implement the rest part of interface.</p>\n\n<p>But this looks bad, is there any other way to do this ? actually , I just want to do something like this</p>\n\n<pre><code>func (a IA)A(){\n    fmt.Println(\"Show A\")\n    a.B()\n}\n</code></pre>\n\n<p>but go can not use a interface as a receiver.</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore", "datastore"], "answers": [{"tags": [], "owner": {"reputation": 38473, "user_id": 821657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qDRGg.png?s=128&g=1", "display_name": "Andrei Volgin", "link": "https://stackoverflow.com/users/821657/andrei-volgin"}, "is_accepted": false, "score": 0, "last_activity_date": 1428688875, "creation_date": 1428688875, "answer_id": 29567926, "question_id": 29567819, "link": "https://stackoverflow.com/questions/29567819/can-i-use-allocateids-as-string-datastore/29567926#29567926", "title": "Can I use AllocateIDs as &quot;string&quot; ? datastore", "body": "<p>You can avoid any possibility of a collision by prefixing an id with any string that you know you never use for your keys. For example:</p>\n\n<pre><code>String key = \"id\" + entity.getKey().getId();\n</code></pre>\n\n<p>And all of this is necessary only if you ever use a sequence of integers for your string keys.</p>\n"}, {"tags": [], "owner": {"reputation": 19881, "user_id": 83406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504ab37e64c5693d2c9d7a6d260d7b71?s=128&d=identicon&r=PG", "display_name": "Jason Hall", "link": "https://stackoverflow.com/users/83406/jason-hall"}, "is_accepted": false, "score": 0, "last_activity_date": 1428692791, "creation_date": 1428692791, "answer_id": 29568961, "question_id": 29567819, "link": "https://stackoverflow.com/questions/29567819/can-i-use-allocateids-as-string-datastore/29568961#29568961", "title": "Can I use AllocateIDs as &quot;string&quot; ? datastore", "body": "<p>The way to get the datastore to generate string keys for you is to use <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#NewIncompleteKey\" rel=\"nofollow\"><code>NewIncompleteKey</code></a>.</p>\n\n<pre><code>ikey := datastore.NewIncompleteKey(ctx, \"Thing\", nil)\nkey, _ := datastore.Put(ctx, ikey, nil) // TODO: check the error\nfmt.Println(key.Encode()) // randomly-generated string key\n</code></pre>\n\n<p>Then to get it back from the string key...</p>\n\n<pre><code>ks := req.FormValue(\"key\") // e.g., from an HTTP request parameter\nkey, _ := datastore.DecodeKey(ks) // TODO: check the error\nvar t Thing\n_ = datastore.Get(ctx, key, &amp;t) // TODO: check the error\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1462794890, "last_edit_date": 1592644375, "creation_date": 1428716499, "answer_id": 29573089, "question_id": 29567819, "link": "https://stackoverflow.com/questions/29567819/can-i-use-allocateids-as-string-datastore/29573089#29573089", "title": "Can I use AllocateIDs as &quot;string&quot; ? datastore", "body": "<h3>Let's clear some things first:</h3>\n<p>The <a href=\"https://cloud.google.com/appengine/docs/go/datastore/entities#Go_Kinds_and_identifiers\" rel=\"nofollow noreferrer\"><em>identifier</em></a> part of an entity's key can either be</p>\n<ul>\n<li>a <em>key name</em> string</li>\n<li>or an integer <em>numeric ID</em></li>\n</ul>\n<p>But not both. So when you save an entity, its key either has a <code>string</code> id called <em>name</em> OR (exclusive OR) an <code>int64</code> id called <em>intID</em>.</p>\n<p>The 2 optional identifier fields are distinct: if you have an entity with <code>name=&quot;1234&quot;</code> it is different from that of with <code>intID=1234</code>.</p>\n<p>When you save a new entity without explicitly specifying a <code>name</code> or <code>intID</code>, the datastore will assign a new unique <code>intID</code> identifier to it. The datastore will never assign a <code>string</code> <code>name</code> by itself. You can only have entities with <code>string</code> <code>name</code> identifiers if you specify a <code>string</code> <code>name</code> yourself.</p>\n<p>The datastore knows about the automatically generated <code>intID</code>s it generates itself, and will never generate the same <code>intID</code> twice (<em>well behavior</em>). However when saving a new entity if you specify an <code>intID</code> yourself, you have to take care about it being unique. This would require to first check if the <code>intID</code> you whish to use is not yet in use (e.g. by querying it first to see if no entity has that <code>intID</code> yet) but even this would not be 100% guarantee that by the time you end up actually saving an entity with this will still be unused. The <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#AllocateIDs\" rel=\"nofollow noreferrer\"><code>AllocateIDs()</code></a> function can be used to obtain a continuous range of <code>intID</code>s which the datastore will not use to generate <code>intID</code>s by itself later on, so you are free to use the allocated range of <code>intID</code>s safely. This also means that if there are concurrent requests also trying to save new entities (either in the same instance or in other instances), they will also never end up using these <code>intID</code>s if identifier generation is left to the datastore.</p>\n<h3>Back to you question</h3>\n<p>Do you really need manual identifier assignment? In most of the cases this is only used/required if you already have a unique property of the entity which cannot be the same for 2 different entities (for example entity is <code>Person</code> which has a property <code>IdentityCardId</code> which is already unique to each person).</p>\n<p>If you have such a unique property, you may use that which itself by nature ensures uniqueness. If you have no such property, then you should not use manual identifier assignment in the first place, you can just use/rely on automatic <code>intID</code> assignment of the datastore.</p>\n<p>Note that you can have mixed identifiers of different entities of the same kind (e.g. you can have a <code>Person</code> with <code>intID</code> and another <code>Person</code> with <code>name</code>).</p>\n<p>As noted above, <code>intID</code>s and <code>name</code>s are distinct. So <code>AllocateIDs()</code> does not take entities with <code>name</code> identifiers into account just because the <code>name</code> contains a valid number. From the datastore you don't get help to &quot;allocate&quot; a <code>name</code> identifier (analog to the <code>AllocateIDs()</code> to allocate <code>intID</code>s), so it must be application logic to ensure the assigned <code>name</code> is unique else you will end up &quot;overwriting&quot;/replacing an existing entity.</p>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 671, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1471905935, "creation_date": 1428688524, "last_edit_date": 1471905935, "question_id": 29567819, "link": "https://stackoverflow.com/questions/29567819/can-i-use-allocateids-as-string-datastore", "title": "Can I use AllocateIDs as &quot;string&quot; ? datastore", "body": "<p>I need to assign a unique identifier to each entity in datastore. I've found <a href=\"https://godoc.org/google.golang.org/appengine/datastore#AllocateIDs\" rel=\"nofollow\">AllocateIDs</a> but the issue is that it generates integers and I use strings for the keys. Is it safe to convert the integer to a string or there is a risk of collision (i.e. datastore to return me the same integer that I'm currently using as a string key). ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6686, "user_id": 520857, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/EE9Th.png?s=128&g=1", "display_name": "Populus", "link": "https://stackoverflow.com/users/520857/populus"}, "edited": false, "score": 0, "creation_date": 1428685586, "post_id": 29566961, "comment_id": 47283447, "body": "Inputs, outputs please :)"}, {"owner": {"reputation": 951, "user_id": 631593, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f0ab0bf648041c211675b2bd06313c6?s=128&d=identicon&r=PG", "display_name": "Varun", "link": "https://stackoverflow.com/users/631593/varun"}, "reply_to_user": {"reputation": 6686, "user_id": 520857, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/EE9Th.png?s=128&g=1", "display_name": "Populus", "link": "https://stackoverflow.com/users/520857/populus"}, "edited": false, "score": 0, "creation_date": 1428685757, "post_id": 29566961, "comment_id": 47283542, "body": "added playground link with code.."}, {"owner": {"reputation": 951, "user_id": 631593, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f0ab0bf648041c211675b2bd06313c6?s=128&d=identicon&r=PG", "display_name": "Varun", "link": "https://stackoverflow.com/users/631593/varun"}, "reply_to_user": {"reputation": 6686, "user_id": 520857, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/EE9Th.png?s=128&g=1", "display_name": "Populus", "link": "https://stackoverflow.com/users/520857/populus"}, "edited": false, "score": 0, "creation_date": 1428685806, "post_id": 29566961, "comment_id": 47283576, "body": "my output should be 35-8152-1."}, {"owner": {"reputation": 6686, "user_id": 520857, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/EE9Th.png?s=128&g=1", "display_name": "Populus", "link": "https://stackoverflow.com/users/520857/populus"}, "edited": false, "score": 0, "creation_date": 1428686589, "post_id": 29566961, "comment_id": 47283959, "body": "Looks fine to me: <a href=\"http://play.golang.org/p/xTmTEcmwEy\" rel=\"nofollow noreferrer\">play.golang.org/p/xTmTEcmwEy</a>"}], "answers": [{"comments": [{"owner": {"reputation": 951, "user_id": 631593, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f0ab0bf648041c211675b2bd06313c6?s=128&d=identicon&r=PG", "display_name": "Varun", "link": "https://stackoverflow.com/users/631593/varun"}, "edited": false, "score": 0, "creation_date": 1428688336, "post_id": 29567439, "comment_id": 47284935, "body": "Thanks peterSO, so what I was missing is the mask, right?"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 951, "user_id": 631593, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f0ab0bf648041c211675b2bd06313c6?s=128&d=identicon&r=PG", "display_name": "Varun", "link": "https://stackoverflow.com/users/631593/varun"}, "edited": false, "score": 0, "creation_date": 1428688591, "post_id": 29567439, "comment_id": 47285083, "body": "@Varun: Yes. Once you have shifted the used bits to the rightmost positions you need to mask off any unused bits on the left."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 3, "last_activity_date": 1428694603, "last_edit_date": 1428694603, "creation_date": 1428687249, "answer_id": 29567439, "question_id": 29566961, "link": "https://stackoverflow.com/questions/29566961/getting-bits-out-of-a-32bit-unsigned-integer-using-bitshift-in-go-lang/29567439#29567439", "title": "getting bits out of a 32bit unsigned integer using bitshift in go lang", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc decode(bits uint32) (uint16, uint16, uint16) {\n    // first 15bits, then 2 bits and then last 15 bits.\n    const mask2 = ^uint32(0) &gt;&gt; (32 - 2)\n    const mask15 = ^uint32(0) &gt;&gt; (32 - 15)\n    b1 := uint16(bits &gt;&gt; (32 - 15))\n    b2 := uint16(bits &gt;&gt; (32 - 15 - 2) &amp; mask2)\n    b3 := uint16(bits &amp; mask15)\n    return b1, b2, b3\n}\n\nfunc main() {\n    b := uint32(4628440)\n    b1, b2, b3 := decode(b)\n    fmt.Printf(\"%032b %015b %02b %015b\\n\", b, b1, b2, b3)\n    fmt.Printf(\"%d %d-%d-%d\\n\", b, b1, b2, b3)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>00000000010001101001111111011000 000000000100011 01 001111111011000\n4628440 35-1-8152\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": false, "score": 1, "last_activity_date": 1428714441, "creation_date": 1428714441, "answer_id": 29572869, "question_id": 29566961, "link": "https://stackoverflow.com/questions/29566961/getting-bits-out-of-a-32bit-unsigned-integer-using-bitshift-in-go-lang/29572869#29572869", "title": "getting bits out of a 32bit unsigned integer using bitshift in go lang", "body": "<p>A helper function to extract a range of bits makes this easy to understand (and test).</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\n// extractUint16 extracts n bits of a from the given offset.\nfunc extractUint16(a uint32, offset, n uint) uint16 {\n    return uint16((a &gt;&gt; offset) &amp; (1&lt;&lt;n - 1))\n}\n\nfunc main() {\n    input := uint32(4628440)\n    a := extractUint16(input, 17, 15)\n    b := extractUint16(input, 15, 2)\n    c := extractUint16(input, 0, 15)\n    fmt.Println(a, b, c)\n}\n</code></pre>\n"}], "owner": {"reputation": 951, "user_id": 631593, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f0ab0bf648041c211675b2bd06313c6?s=128&d=identicon&r=PG", "display_name": "Varun", "link": "https://stackoverflow.com/users/631593/varun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 825, "favorite_count": 1, "accepted_answer_id": 29567439, "answer_count": 2, "score": 2, "last_activity_date": 1428714441, "creation_date": 1428685475, "last_edit_date": 1428685729, "question_id": 29566961, "link": "https://stackoverflow.com/questions/29566961/getting-bits-out-of-a-32bit-unsigned-integer-using-bitshift-in-go-lang", "title": "getting bits out of a 32bit unsigned integer using bitshift in go lang", "body": "<p>I have a 32bit unsigned integer and I want to divide it in 3 uint16 values. I want first 15bits, then 2 bits and then last 15 bits.</p>\n\n<p>I am trying something like -</p>\n\n<pre><code>val &gt;&gt; 17\nval &gt;&gt; 2\nval &gt;&gt; 15\n</code></pre>\n\n<p>apart from first value, other 2 are not right and I know that but now able to figure out how to fix that?</p>\n\n<p><a href=\"http://play.golang.org/p/En31b1kxsw\" rel=\"nofollow\">Go play ground</a></p>\n"}, {"tags": ["string", "performance", "go", "switch-statement"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 3, "creation_date": 1428686196, "post_id": 29566229, "comment_id": 47283768, "body": "<a href=\"https://github.com/golang/go/issues/10000\" rel=\"nofollow noreferrer\">cmd/gc: optimize switch statements with string literal cases #10000</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5488, "user_id": 1078890, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Dqula.jpg?s=128&g=1", "display_name": "IamNaN", "link": "https://stackoverflow.com/users/1078890/iamnan"}, "is_accepted": false, "score": 15, "last_activity_date": 1563538766, "last_edit_date": 1563538766, "creation_date": 1428685419, "answer_id": 29566955, "question_id": 29566229, "link": "https://stackoverflow.com/questions/29566229/go-switch-string-efficiency/29566955#29566955", "title": "Go switch string efficiency", "body": "<p>You;d have to benchmark it in order to tell the actual difference for your case. It depends on the compiler and the optimizations it does and thus on platform and architecture.</p>\n\n<p>But see this <a href=\"https://groups.google.com/d/msg/golang-nuts/IURR4Z2SY7M/R7ORD_yDix4J\" rel=\"nofollow noreferrer\">link from the Go mailing list</a> for some detail on implementation of the switch statement:</p>\n\n<blockquote>\n  <p>what is implemented is as follows.</p>\n  \n  <ol>\n  <li>in order, all non-constant cases are compiled and tested as if-elses.</li>\n  <li>groups of larger than 3 constant cases are binary divided and conquered.</li>\n  <li>3 or fewer cases are compared linearly.</li>\n  </ol>\n</blockquote>\n\n<p>So based on that there should be little if any difference. And the switch statement certainly looks cleaner. And it's the <a href=\"https://golang.org/doc/effective_go.html#switch\" rel=\"nofollow noreferrer\">recommend way</a> to write longer if-else statements:</p>\n\n<blockquote>\n  <p>It's therefore possible\u2014and idiomatic\u2014to write an if-else-if-else\n  chain as a switch.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": false, "score": 2, "last_activity_date": 1563543573, "creation_date": 1563543573, "answer_id": 57113729, "question_id": 29566229, "link": "https://stackoverflow.com/questions/29566229/go-switch-string-efficiency/57113729#57113729", "title": "Go switch string efficiency", "body": "<p>In Go, a constant expression <code>switch</code> with 4 or more cases is implemented as a <a href=\"https://github.com/golang/go/blob/8ee9bca2729ead81da6bf5a18b87767ff396d1b7/src/cmd/compile/internal/gc/swt.go#L375\" rel=\"nofollow noreferrer\">binary search</a>.</p>\n\n<p>The cases are sorted at compile time and then binary-searched.</p>\n\n<p>In <a href=\"https://github.com/golang/go/issues/10000#issuecomment-82634364\" rel=\"nofollow noreferrer\">this small benchmark</a> we can see that a <code>switch</code> with just <strong>5 cases</strong> is on average <strong>1.5 times faster</strong> than a corresponding <em>if-then-else</em> sequence. In general we can assume O(logN) vs. O(N) difference in performance.</p>\n\n<p>3 of fewer cases are compared linearly, so expect the same performance as that of <em>if-then-else</em>.</p>\n"}], "owner": {"reputation": 131, "user_id": 4774481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8a3fc27cb40c9ac3a7c0c3e8c70bab0?s=128&d=identicon&r=PG&f=1", "display_name": "ash", "link": "https://stackoverflow.com/users/4774481/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8282, "favorite_count": 2, "answer_count": 2, "score": 9, "last_activity_date": 1563543573, "creation_date": 1428682913, "last_edit_date": 1459895637, "question_id": 29566229, "link": "https://stackoverflow.com/questions/29566229/go-switch-string-efficiency", "title": "Go switch string efficiency", "body": "<p>Hello is Go switch string just convenient form, but not fastest possible implementation?</p>\n\n<pre><code>switch s{\ncase \"alpha\": doalpha()\ncase \"betta\": dobetta()\ncase \"gamma\": dogamma()\ndefault: dodefault()\n</code></pre>\n\n<p>Is this equal to:</p>\n\n<pre><code>if s==\"alpha\"{\n  doalpha()\n} else if s == \"betta\" {\n  dobetta()\n} else if s == \"gamma\" {\n  dogamma()\n} else {\ndodefault()\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "edited": false, "score": 3, "creation_date": 1428678047, "post_id": 29564560, "comment_id": 47278982, "body": "Read the <a href=\"https://golang.org/ref/spec#Select_statements\" rel=\"nofollow noreferrer\">spec</a>"}, {"owner": {"reputation": 13, "user_id": 4753532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ylhFHNc64MI/AAAAAAAAAAI/AAAAAAAACk0/0zrbsKGPTu8/photo.jpg?sz=128", "display_name": "Vincent Wang", "link": "https://stackoverflow.com/users/4753532/vincent-wang"}, "reply_to_user": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "edited": false, "score": 0, "creation_date": 1428754345, "post_id": 29564560, "comment_id": 47303756, "body": "stackoverflow does not want me to delete the question..."}], "answers": [{"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1428680962, "creation_date": 1428680962, "answer_id": 29565672, "question_id": 29564560, "link": "https://stackoverflow.com/questions/29564560/golang-select-trigger/29565672#29565672", "title": "Golang select trigger", "body": "<p>In this case it <em>looks</em> like some \"wait-and-trigger\" scenario. One can send in unbuffered channel only when receiver side of pipe can receive. Unbuffered channels are like rendezvous. So <code>c &lt;- x</code> can't proceed before <code>fmt.Println(&lt;-c)</code> done with print and ready for receiving new value.\nIn case of many possible choices case is chosen via a uniform pseudo-random selection. So the criteria to judge is just a probability. If many goroutings want to send or receive from a channel, then perhaps it would be triggered rather then rare case.</p>\n"}], "owner": {"reputation": 13, "user_id": 4753532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ylhFHNc64MI/AAAAAAAAAAI/AAAAAAAACk0/0zrbsKGPTu8/photo.jpg?sz=128", "display_name": "Vincent Wang", "link": "https://stackoverflow.com/users/4753532/vincent-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 623, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428681579, "creation_date": 1428677612, "question_id": 29564560, "link": "https://stackoverflow.com/questions/29564560/golang-select-trigger", "title": "Golang select trigger", "body": "<p>I am working on the GoLang Tutorial \n<a href=\"https://tour.golang.org/concurrency/5\" rel=\"nofollow\" title=\"Link to the select example\">Select.go</a></p>\n\n<pre><code>func fibonacci(c, quit chan int) {\n    x, y := 0, 1\n    for {\n        select {\n        case c &lt;- x:\n            x, y = y, x+y\n        case &lt;-quit:\n            fmt.Println(\"quit\")\n            return\n        }\n    }\n}\n\nfunc main() {\n    c := make(chan int)\n    quit := make(chan int)\n    go func() {\n        for i := 0; i &lt; 10; i++ {\n            fmt.Println(&lt;-c)\n        }\n        quit &lt;- 0\n    }()\n    fibonacci(c, quit)\n}\n</code></pre>\n\n<p>For the 2nd case statement, I understand that it will be triggered when something comes through the <em>quit</em> channel.\nBut I don't understand why the 1st case statement will be also triggered. It is just plainly pushing into pipe. It does not look like some \"wait-and-trigger\" scenario.\nMore broadly, what are the criteria to judge if the case statement is triggered?</p>\n"}, {"tags": ["xml", "go"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 3217218, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/aa06eff055c48a68b0933ae543068ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3217218/mike"}, "edited": false, "score": 1, "creation_date": 1428690459, "post_id": 29565821, "comment_id": 47286075, "body": "Worked perfectly after some tweaking. And no, <code>text&#47;xml</code> is correct, <code>application&#47;xml</code> does not work."}, {"owner": {"reputation": 16814, "user_id": 3849456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AonOf.jpg?s=128&g=1", "display_name": "Anzel", "link": "https://stackoverflow.com/users/3849456/anzel"}, "reply_to_user": {"reputation": 63, "user_id": 3217218, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/aa06eff055c48a68b0933ae543068ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3217218/mike"}, "edited": false, "score": 0, "creation_date": 1428690598, "post_id": 29565821, "comment_id": 47286157, "body": "@Sladey, I&#39;m glad it helps. Yes the above is just basic demonstration. Your case may be much more complex like <code>basicAuth</code> or <code>Cookies</code> etc :)"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1428693847, "post_id": 29565821, "comment_id": 47287783, "body": "Do not use <code>#</code> for any example code when Go commenting is done via <code>&#47;&#47;</code> (or <code>&#47;* \u2026 *&#47;</code>)"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1428693942, "post_id": 29565821, "comment_id": 47287829, "body": "No need to say <code>io.Reader(bytes.NewBufferString(\u2026))</code>, it&#39;s already an <code>io.Reader</code>!"}], "tags": [], "owner": {"reputation": 16814, "user_id": 3849456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AonOf.jpg?s=128&g=1", "display_name": "Anzel", "link": "https://stackoverflow.com/users/3849456/anzel"}, "is_accepted": true, "score": 6, "last_activity_date": 1428694421, "last_edit_date": 1428694421, "creation_date": 1428681465, "answer_id": 29565821, "question_id": 29564032, "link": "https://stackoverflow.com/questions/29564032/xml-http-post-in-go/29565821#29565821", "title": "XML HTTP Post in Go", "body": "<p>I am also new to Go, but I'd take a brave trial and try to answer this.</p>\n\n<p>You can use <code>http.Client</code> with <code>http.NewRequest</code>, then set the request header before sending the <strong>POST</strong>, working sample like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc main() {\n    // or you can use []byte(`...`) and convert to Buffer later on\n    body := \"&lt;request&gt; &lt;parameters&gt; &lt;email&gt;test@test.com&lt;/email&gt; &lt;password&gt;test&lt;/password&gt; &lt;/parameters&gt; &lt;/request&gt;\"\n\n    client := &amp;http.Client{}\n    // build a new request, but not doing the POST yet\n    req, err := http.NewRequest(\"POST\", \"http://localhost:8080/\", bytes.NewBuffer([]byte(body)))\n    if err != nil {\n        fmt.Println(err)\n    }\n    // you can then set the Header here\n    // I think the content-type should be \"application/xml\" like json...\n    req.Header.Add(\"Content-Type\", \"application/xml; charset=utf-8\")\n    // now POST it\n    resp, err := client.Do(req)\n    if err != nil {\n        fmt.Println(err)\n    }\n    fmt.Println(resp)\n}\n</code></pre>\n\n<p>Response from Client (dummy server so bad response of course):</p>\n\n<pre><code>&gt;&gt;&gt; go run xmlpost.go\nPost http://localhost:8080/: dial tcp 127.0.0.1:8080: connection refused\n&lt;nil&gt;\n</code></pre>\n\n<p>Server Response:</p>\n\n<pre><code>&gt;&gt;&gt; ncat -l 8080\nPOST / HTTP/1.1\nHost: localhost:8080\nUser-Agent: Go 1.1 package http\nContent-Length: 102\nContent-Type: application/xml; charset=utf-8\nAccept-Encoding: gzip\n\n&lt;request&gt; &lt;parameters&gt; &lt;email&gt;test@test.com&lt;/email&gt; &lt;password&gt;test&lt;/password&gt; &lt;/parameters&gt; &lt;/request&gt;\n</code></pre>\n\n<h3>update:</h3>\n\n<p>Thanks for @DaveC pointing out the unnecessary io.Reader(...), and apologized for using <strong>#</strong> for comment, I'm too used to Python and it came natural when adding comment in SO. Now fixed.</p>\n"}, {"comments": [{"owner": {"reputation": 16814, "user_id": 3849456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AonOf.jpg?s=128&g=1", "display_name": "Anzel", "link": "https://stackoverflow.com/users/3849456/anzel"}, "edited": false, "score": 0, "creation_date": 1428694573, "post_id": 29569374, "comment_id": 47288136, "body": "definitely the better answer"}], "tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": false, "score": 11, "last_activity_date": 1428694616, "last_edit_date": 1428694616, "creation_date": 1428694391, "answer_id": 29569374, "question_id": 29564032, "link": "https://stackoverflow.com/questions/29564032/xml-http-post-in-go/29569374#29569374", "title": "XML HTTP Post in Go", "body": "<p>No need to make your own request or manually set the content type, it can all be done with a single simple <code>http.Post</code> call:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n    \"strings\"\n)\n\nfunc main() {\n    const myurl = \"http://127.0.0.1:8080\"\n    const xmlbody = `\n&lt;request&gt;\n    &lt;parameters&gt;\n        &lt;email&gt;test@test.com&lt;/email&gt;\n        &lt;password&gt;test&lt;/password&gt;\n    &lt;/parameters&gt;\n&lt;/request&gt;`\n\n    resp, err := http.Post(myurl, \"text/xml\", strings.NewReader(xmlbody))\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer resp.Body.Close()\n\n    // Do something with resp.Body\n}\n</code></pre>\n\n<p>Whatever you use for the <code>bodyType</code> argument goes into the content type header.\nThe server will see:</p>\n\n<pre><code>POST / HTTP/1.1\nHost: 127.0.0.1:8080\nUser-Agent: Go 1.1 package http\nContent-Length: 127\nContent-Type: text/xml\nAccept-Encoding: gzip\n\n\n&lt;request&gt;\n    &lt;parameters&gt;\n        &lt;email&gt;test@test.com&lt;/email&gt;\n        &lt;password&gt;test&lt;/password&gt;\n    &lt;/parameters&gt;\n&lt;/request&gt;\n</code></pre>\n\n<p>(The extra blank line is because I chose to start the string literal on a new line).</p>\n"}], "owner": {"reputation": 63, "user_id": 3217218, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/aa06eff055c48a68b0933ae543068ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3217218/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10419, "favorite_count": 0, "accepted_answer_id": 29565821, "answer_count": 2, "score": 3, "last_activity_date": 1428694616, "creation_date": 1428676118, "question_id": 29564032, "link": "https://stackoverflow.com/questions/29564032/xml-http-post-in-go", "title": "XML HTTP Post in Go", "body": "<p>I'm attempting to create a post request that uses xml.</p>\n\n<p>I know I need to use:</p>\n\n<pre><code>http.Post(\"myurl\", \"text/xml\", body)\n</code></pre>\n\n<p>But the thing I can't figure out is how to set the actual XML data to be sent.</p>\n\n<pre><code>&lt;request&gt;\n    &lt;parameters&gt;\n        &lt;email&gt;test@test.com&lt;/email&gt;\n        &lt;password&gt;test&lt;/password&gt;\n    &lt;/parameters&gt;\n&lt;/request&gt;\n</code></pre>\n\n<p>And setting a header to have <code>Content-Type: text/xml</code></p>\n"}, {"tags": ["java", "go", "classpath"], "answers": [{"tags": [], "owner": {"reputation": 866, "user_id": 183039, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/79f2bbf71fa3d95d6cf779066e805357?s=128&d=identicon&r=PG", "display_name": "Anvar", "link": "https://stackoverflow.com/users/183039/anvar"}, "is_accepted": false, "score": 1, "last_activity_date": 1428679948, "creation_date": 1428679948, "answer_id": 29565316, "question_id": 29563992, "link": "https://stackoverflow.com/questions/29563992/starting-a-java-process-in-go/29565316#29565316", "title": "Starting a Java-process in Go", "body": "<p>Disregard this question please, the error was an extra space in the args array:</p>\n\n<pre><code>args := []string{\n  \"-Xmx64m\",\n  \"-Dmy.property=value \", //&lt;--trailing space\n  ...\n}\n</code></pre>\n\n<p>The extra space stops further parsing from continuing leading to a missing classpath.</p>\n"}], "owner": {"reputation": 866, "user_id": 183039, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/79f2bbf71fa3d95d6cf779066e805357?s=128&d=identicon&r=PG", "display_name": "Anvar", "link": "https://stackoverflow.com/users/183039/anvar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1428679948, "creation_date": 1428676014, "question_id": 29563992, "link": "https://stackoverflow.com/questions/29563992/starting-a-java-process-in-go", "title": "Starting a Java-process in Go", "body": "<p>I am trying to start a Java-process using  Go but am unable to get Java to recognise the classpath. The code looks somewhat like:</p>\n\n<pre><code>args := []string{\n  \"-Xmx64m\",\n  \"-Dmy.property=value,\n  \"-cp\",\n  \"lib/jar1.jar:lib/jar2.jar\",\n  \"com.things.MyClass\",\n}\nc := exec.Command(javaBinary, args...)\n</code></pre>\n\n<p>Unfortunately when executing this I get the dreaded <code>Error: Could not find or load main class</code> from the JVM. However if I take the output from <code>c.Args</code> and run it directly in a terminal it seems to work just fine, which to me indicates that I am somehow launching the process incorrectly.</p>\n\n<p>Is there a better way of doing this?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 3217218, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/aa06eff055c48a68b0933ae543068ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3217218/mike"}, "edited": false, "score": 1, "creation_date": 1428662883, "post_id": 29559462, "comment_id": 47268881, "body": "I was hoping there was a built in method by bufio, but I guess i&#39;ll just use that instead. The only issue is, I wanna display the amount of lines before I run a the for loops contents."}, {"owner": {"reputation": 5488, "user_id": 1078890, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Dqula.jpg?s=128&g=1", "display_name": "IamNaN", "link": "https://stackoverflow.com/users/1078890/iamnan"}, "reply_to_user": {"reputation": 63, "user_id": 3217218, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/aa06eff055c48a68b0933ae543068ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3217218/mike"}, "edited": false, "score": 1, "creation_date": 1428663160, "post_id": 29559462, "comment_id": 47269039, "body": "See <a href=\"http://stackoverflow.com/a/24563853/1078890\">this</a> answer, that might help with that."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 63, "user_id": 3217218, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/aa06eff055c48a68b0933ae543068ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3217218/mike"}, "edited": false, "score": 4, "creation_date": 1428663997, "post_id": 29559462, "comment_id": 47269553, "body": "@Sladey In order to find out how many lines a file has, you have to read through the entire thing. This is something you can&#39;t change."}, {"owner": {"reputation": 1855, "user_id": 69708, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/13f3d823333d9fe6c4a080aa15971a2e?s=128&d=identicon&r=PG", "display_name": "markhor", "link": "https://stackoverflow.com/users/69708/markhor"}, "edited": false, "score": 0, "creation_date": 1495871932, "post_id": 29559462, "comment_id": 75440304, "body": "This does not handle files with very long lines. You will get bufio.Scanner: token too long"}], "tags": [], "owner": {"reputation": 5488, "user_id": 1078890, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Dqula.jpg?s=128&g=1", "display_name": "IamNaN", "link": "https://stackoverflow.com/users/1078890/iamnan"}, "is_accepted": true, "score": 4, "last_activity_date": 1428662780, "creation_date": 1428662780, "answer_id": 29559462, "question_id": 29559358, "link": "https://stackoverflow.com/questions/29559358/count-lines-via-bufio/29559462#29559462", "title": "Count lines via bufio", "body": "<p>You could do something like this:</p>\n\n<pre><code>counter := 0\nfor scanner.Scan() {\n    line := scanner.Text()\n    counter++\n    // do something with your line\n}\nfmt.Printf(\"Lines read: %d\", counter)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1428692447, "post_id": 29561027, "comment_id": 47287082, "body": "Don&#39;t use <code>panic</code>+<code>os.Exit</code> for non-programming errors (and then hide the actual reason for the error!). You could have just done <code>log.Fatal(err)</code>."}], "tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": false, "score": -1, "last_activity_date": 1428667655, "creation_date": 1428667655, "answer_id": 29561027, "question_id": 29559358, "link": "https://stackoverflow.com/questions/29559358/count-lines-via-bufio/29561027#29561027", "title": "Count lines via bufio", "body": "<p>Here is my approach to do the task:</p>\n\n<pre><code>inputFile, err := os.Open(\"input.txt\")\n\nif err != nil {\n    panic(\"Error happend during opening the file. Please check if file exists!\")\n    os.Exit(1)\n}\n\ndefer inputFile.Close()\n\ninputReader := bufio.NewReader(inputFile)\n\nscanner := bufio.NewScanner(inputReader)\n// Count the words.\ncount := 0\nfor scanner.Scan() {\n    line := scanner.Text()\n    fmt.Printf(\"%v\\n\", line)\n    count++\n}\nif err := scanner.Err(); err != nil {\n    fmt.Fprintln(os.Stderr, \"reading input:\", err)\n}\nfmt.Printf(\"%d\\n\", count)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1428692613, "post_id": 29561151, "comment_id": 47287156, "body": "Of course, you could simplify the end of <code>lineCount</code> to just <code>return lc, s.Err()</code>."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1428694305, "last_edit_date": 1428694305, "creation_date": 1428667996, "answer_id": 29561151, "question_id": 29559358, "link": "https://stackoverflow.com/questions/29559358/count-lines-via-bufio/29561151#29561151", "title": "Count lines via bufio", "body": "<p>Keep it simple and fast. No need for buffering, <code>scanner</code> already does that. Don't do unnecessary <code>string</code> conversions. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc lineCount(filename string) (int64, error) {\n    lc := int64(0)\n    f, err := os.Open(filename)\n    if err != nil {\n        return 0, err\n    }\n    defer f.Close()\n    s := bufio.NewScanner(f)\n    for s.Scan() {\n        lc++\n    }\n    return lc, s.Err()\n}\n\nfunc main() {\n    filename := `testfile`\n    lc, err := lineCount(filename)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    fmt.Println(filename+\" line count:\", lc)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1855, "user_id": 69708, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/13f3d823333d9fe6c4a080aa15971a2e?s=128&d=identicon&r=PG", "display_name": "markhor", "link": "https://stackoverflow.com/users/69708/markhor"}, "is_accepted": false, "score": 1, "last_activity_date": 1495875810, "last_edit_date": 1495875810, "creation_date": 1495874677, "answer_id": 44214797, "question_id": 29559358, "link": "https://stackoverflow.com/questions/29559358/count-lines-via-bufio/44214797#44214797", "title": "Count lines via bufio", "body": "<p>As I commented, the accepted answer fails at long lines. The default limit is <code>bufio.MaxScanTokenSize</code> which is 64KiB. So if your line is longer than 65536 chars, it will silently fail. You've got two options.</p>\n\n<ol>\n<li>Call <code>scanner.Buffer()</code> and supply the sufficient <code>max</code> parameter. <code>buffer</code> may be small by default because <code>Scanner</code> is smart enough to allocate new ones. Can be a problem if you don't know the total size beforehand, like with vanilla <code>Reader</code> interface, and you've got <strong>huge</strong> lines - the memory consumption will grow correspondingly as <code>Scanner</code> records all the line.</li>\n<li>Recreate <code>scanner</code> in the outer loop, this will ensure that you advance further:</li>\n</ol>\n\n\n\n<pre><code>var scanner *bufio.Scanner\ncounter := 0\nfor scanner == nil || scanner.Err() == bufio.ErrTooLong {\n    scanner = bufio.NewScanner(reader)\n    for scanner.Scan() {\n        counter++\n    }\n}\n</code></pre>\n\n<p>The problem with (2) is that you keep allocating and deallocating buffers instead of reusing them. So let's fuse (1) and (2):</p>\n\n<pre><code>var scanner *bufio.Scanner\nbuffer := make([]byte, bufio.MaxScanTokenSize)\ncounter := 0\nfor scanner == nil || scanner.Err() == bufio.ErrTooLong {\n    scanner = bufio.NewScanner(reader)\n    scanner.Buffer(buffer, 0)\n    for scanner.Scan() {\n        counter++\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 3217218, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/aa06eff055c48a68b0933ae543068ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3217218/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3151, "favorite_count": 1, "accepted_answer_id": 29559462, "answer_count": 4, "score": 1, "last_activity_date": 1535999929, "creation_date": 1428662397, "question_id": 29559358, "link": "https://stackoverflow.com/questions/29559358/count-lines-via-bufio", "title": "Count lines via bufio", "body": "<p>I'm utilizing bufio to do a for loop for each line in a text file. I have no idea how to count the amount of lines though.</p>\n\n<pre><code>scanner := bufio.NewScanner(bufio.NewReader(file))\n</code></pre>\n\n<p>The above is what I use to scan my file.</p>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 1803, "user_id": 3531912, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/Qh3Y8.png?s=128&g=1", "display_name": "Alessandro Suglia", "link": "https://stackoverflow.com/users/3531912/alessandro-suglia"}, "edited": false, "score": 0, "creation_date": 1428660948, "post_id": 29558653, "comment_id": 47267749, "body": "I think that it depends from your DBMS configuration."}], "answers": [{"tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": false, "score": 8, "last_activity_date": 1428666382, "last_edit_date": 1428666382, "creation_date": 1428662470, "answer_id": 29559380, "question_id": 29558653, "link": "https://stackoverflow.com/questions/29558653/how-long-should-a-mysql-connection-live-in-golang/29559380#29559380", "title": "How long should a mysql connection live in golang", "body": "<p>There is no authoritative answer, as it depends on the driver you're using. If you're using either:</p>\n\n<ul>\n<li>The popular mySQL driver - <a href=\"https://github.com/go-sql-driver/mysql\" rel=\"noreferrer\">https://github.com/go-sql-driver/mysql</a></li>\n<li>or the popular postgres driver- <a href=\"https://github.com/lib/pq\" rel=\"noreferrer\">https://github.com/lib/pq</a></li>\n</ul>\n\n<p>... then you shouldn't close your <code>sql.DB</code> at all. The <code>sql.DB</code> in those cases represents a <strong>connection pool</strong>, and using it in your handlers/requests/functions means you are just using a connection from that pool (if available).</p>\n\n<p>e.g.</p>\n\n<pre><code>var db *sql.DB\n\nfunc setup() error {\n    var err error\n    db, err = sql.Open(...)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // Other setup-related activities\n}\n\nfunc main()\n    err := setup()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // No need to call `defer db.Close()` here\n    http.ListenAndServe(...)\n}\n\nfunc SomeHandler(w http.ResponseWriter, r *http.Request) {\n    u := User{}\n    res, err := db.GetThings(&amp;u)\n    // No need to close this here - it's just a connection dynamically pulled\n    // from our sql.DB connection pool in most cases\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5488, "user_id": 1078890, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Dqula.jpg?s=128&g=1", "display_name": "IamNaN", "link": "https://stackoverflow.com/users/1078890/iamnan"}, "is_accepted": false, "score": 15, "last_activity_date": 1428662476, "creation_date": 1428662476, "answer_id": 29559383, "question_id": 29558653, "link": "https://stackoverflow.com/questions/29558653/how-long-should-a-mysql-connection-live-in-golang/29559383#29559383", "title": "How long should a mysql connection live in golang", "body": "<p>Further down in the same document it reads:</p>\n\n<blockquote>\n  <p>Instead, create one sql.DB object for each distinct datastore you need to access, and keep it until the program is done accessing that datastore. Pass it around as needed, or make it available somehow globally, but keep it open. And don\u2019t Open() and Close() from a short-lived function. Instead, pass the sql.DB into that short-lived function as an argument.</p>\n  \n  <p>If you don\u2019t treat the sql.DB as a long-lived object, you could\n  experience problems such as poor reuse and sharing of connections,\n  running out of available network resources, or sporadic failures due\n  to a lot of TCP connections remaining in TIME_WAIT status. Such\n  problems are signs that you\u2019re not using database/sql as it was\n  designed.</p>\n</blockquote>\n\n<p>Opening and closing database connections is a costly operation so you want to avoid that as much as possible. you definitely don't want to close the connection after each request (unless there's only a few a day and even then you can keep it open as long as the app runs)</p>\n\n<p>The database/sql package uses <a href=\"http://go-database-sql.org/connection-pool.html\" rel=\"noreferrer\">connection pooling</a> under the hood, so you don't have to worry about managing multiple connections.</p>\n"}], "owner": {"reputation": 1325, "user_id": 2422037, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5bf62e7d61fe2c3e9bc981a68ee5ac3e?s=128&d=identicon&r=PG", "display_name": "clinyong", "link": "https://stackoverflow.com/users/2422037/clinyong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4013, "favorite_count": 2, "answer_count": 2, "score": 7, "last_activity_date": 1428666382, "creation_date": 1428660327, "question_id": 29558653, "link": "https://stackoverflow.com/questions/29558653/how-long-should-a-mysql-connection-live-in-golang", "title": "How long should a mysql connection live in golang", "body": "<p>I am using mysql with golang and reading this <a href=\"http://go-database-sql.org/accessing.html\" rel=\"noreferrer\">doc</a>. It says</p>\n\n<blockquote>\n  <p>Although it\u2019s idiomatic to Close() the database when you\u2019re finished with it, the sql.DB object is designed to be long-lived. Don\u2019t Open() and Close() databases frequently. </p>\n</blockquote>\n\n<p>I don't know how long should the connnection be. For now, I open the connection each http request if necessary. Is it too frequently?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "edited": false, "score": 0, "creation_date": 1428659972, "post_id": 29558463, "comment_id": 47267171, "body": "I run go install within the src directory. How should I do it then?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user57508"}, "edited": false, "score": 1, "creation_date": 1428661917, "post_id": 29558463, "comment_id": 47268321, "body": "Please see <a href=\"http://meta.stackexchange.com/questions/19190/should-questions-include-tags-in-their-titles\">&quot;Should questions include \u201ctags\u201d in their titles?&quot;</a>, where the consensus is &quot;no, they should not&quot;!"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1428673657, "post_id": 29558463, "comment_id": 47275841, "body": "What is <code>os.Cwd()</code> showing? (print it to console at the top of main)"}, {"owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "edited": false, "score": 0, "creation_date": 1428673865, "post_id": 29558463, "comment_id": 47275994, "body": "/Users/John/Projects/Website"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1428709457, "post_id": 29558463, "comment_id": 47293915, "body": "given that cwd, there&#39;s no way the path is right since you are at least missing &quot;src&quot; and maybe more depending on where your example tree is sitting"}], "answers": [{"tags": [], "owner": {"reputation": 4652, "user_id": 1157106, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f00d78cb61e090aee853b09ed015462c?s=128&d=identicon&r=PG", "display_name": "tanaydin", "link": "https://stackoverflow.com/users/1157106/tanaydin"}, "is_accepted": false, "score": 0, "last_activity_date": 1428659941, "last_edit_date": 1428659941, "creation_date": 1428659886, "answer_id": 29558517, "question_id": 29558463, "link": "https://stackoverflow.com/questions/29558463/error-serving-js-files/29558517#29558517", "title": "error serving JS files", "body": "<p>js folder is not under static. it should be like</p>\n\n<pre><code>static/\n      js/\n        site.js\n</code></pre>\n"}], "owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428668999, "creation_date": 1428659724, "last_edit_date": 1428668999, "question_id": 29558463, "link": "https://stackoverflow.com/questions/29558463/error-serving-js-files", "title": "error serving JS files", "body": "<p>I have this directory structure</p>\n\n<pre><code>src/\n  github.com/\n    john/\n      site/\n        main.go\n        templates/\n          index.html\n        static/\n          js/\n            site.js\n          css/\n</code></pre>\n\n<p>In my main.go:</p>\n\n<pre><code>func main() {\n  http.Handle(\"/templates/\", http.StripPrefix(\"/templates/\", http.FileServer(http.Dir(filepath.Join(cwd, \"/github.com/john/site/templates/\"))))\n  http.Handle(\"/static/\", http.StripPrefix(\"/static/\", http.FileServer(http.Dir(filepath.Join(cwd, \"/github.com/john/site/static/\"))))\n</code></pre>\n\n<p>In index.html</p>\n\n<pre><code>&lt;script src=\"/static/js/site.js\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>The HTML loads properly. However, no such js file was found. Why is that so?</p>\n\n<p>I run go install within the <code>src</code> directory. Also, when I try to access localhost:3000/templates/index.html, the file is not found either.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1428693508, "post_id": 29554369, "comment_id": 47287606, "body": "<code>go install</code> <a href=\"http://golang.org/s/oracle-user-manual\" rel=\"nofollow noreferrer\"><code>golang.org&#47;x&#47;tools&#47;cmd&#47;oracle</code></a>."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1428648445, "last_edit_date": 1428648445, "creation_date": 1428646559, "answer_id": 29554594, "question_id": 29554369, "link": "https://stackoverflow.com/questions/29554369/finding-functions-that-return-a-specific-type/29554594#29554594", "title": "Finding functions that return a specific type", "body": "<p>Maybe not the best way but take a look at the search field at the top of the official <a href=\"http://golang.org\" rel=\"nofollow\">golang.org</a> website. If you search for <code>\"Writer\"</code>:</p>\n\n<p><a href=\"http://golang.org/search?q=Writer\" rel=\"nofollow\"><strong>http://golang.org/search?q=Writer</strong></a></p>\n\n<p>You get many results, grouped by categories like</p>\n\n<ul>\n<li><a href=\"http://golang.org/search?q=Writer#Types\" rel=\"nofollow\">Types</a></li>\n<li><a href=\"http://golang.org/search?q=Writer#Global\" rel=\"nofollow\">Package-level declarations</a></li>\n<li><a href=\"http://golang.org/search?q=Writer#Local\" rel=\"nofollow\">Local declarations and uses</a></li>\n<li><a href=\"http://golang.org/search?q=Writer#Textual\" rel=\"nofollow\">and Textual occurrences</a></li>\n</ul>\n\n<p>Also note that <a href=\"http://golang.org/pkg/io/#Writer\" rel=\"nofollow\"><code>io.Writer</code></a> is an interface, and we all know how Go handles interfaces: when implementing an interface, there is no declaration of intent, a type implicitly implements an interface if the methods defined by the interface are declared. This means that you won't be able to find many examples where an <code>io.Writer</code> is created and returned because a type might be named entirely different and still be an <code>io.Writer</code>.</p>\n\n<p>Things get a little easier if you look for a non-interface type for example <a href=\"http://golang.org/search?q=bytes.Buffer\" rel=\"nofollow\"><code>bytes.Buffer</code></a>.</p>\n\n<p>Also in the documentation of the declaring package of the type the <code>Index</code> section groups functions and methods of the package <em>by type</em> so you will find functions and methods of the <em>same</em> package that return the type you're looking for right under its entry/link in the <code>Index</code> section.</p>\n\n<p>Also note that you can check the dependencies of packages at <a href=\"http://godoc.org\" rel=\"nofollow\"><strong>godoc.org</strong></a>. For example you can see what packages import the <code>io</code> package which may be a good starting point to look for further examples (this would be exhausting in case of package <code>io</code> because it is so general that at the moment <a href=\"http://godoc.org/io?importers\" rel=\"nofollow\">23410 packages import it</a>).</p>\n"}, {"comments": [{"owner": {"reputation": 5488, "user_id": 1078890, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Dqula.jpg?s=128&g=1", "display_name": "IamNaN", "link": "https://stackoverflow.com/users/1078890/iamnan"}, "edited": false, "score": 0, "creation_date": 1428741408, "post_id": 29560446, "comment_id": 47300068, "body": "yes, agreed. I didn&#39;t get the question right the first time. The edit is basically what I meant to begin with. Just tried the implements cmd and it&#39;s perfect for this! Thanks!"}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 2, "last_activity_date": 1428675588, "last_edit_date": 1428675588, "creation_date": 1428665782, "answer_id": 29560446, "question_id": 29554369, "link": "https://stackoverflow.com/questions/29554369/finding-functions-that-return-a-specific-type/29560446#29560446", "title": "Finding functions that return a specific type", "body": "<p>In my days coding I'm personally rare in need to find functions returning <code>Int16</code> and <code>error</code>(func can return few values in Go, you know)</p>\n\n<p>For second part of your question there exists wonderful cmd <code>implements</code> written by Dominik Honnef <code>go get honnef.co/go/implements</code>\nAfter discover type that satisfy your conditions you can assume constructor for type (something like <code>func NewTheType() TheType</code>) would be just after TheType declaration in source code and docs. It's a proven Go practice.</p>\n"}], "owner": {"reputation": 5488, "user_id": 1078890, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Dqula.jpg?s=128&g=1", "display_name": "IamNaN", "link": "https://stackoverflow.com/users/1078890/iamnan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 1, "accepted_answer_id": 29560446, "answer_count": 2, "score": 2, "last_activity_date": 1428675588, "creation_date": 1428645556, "last_edit_date": 1428657769, "question_id": 29554369, "link": "https://stackoverflow.com/questions/29554369/finding-functions-that-return-a-specific-type", "title": "Finding functions that return a specific type", "body": "<p>Perhaps this is a silly question, but is there a way to find all functions (in the standard library or GOPATH) that return a specific type?</p>\n\n<p>For example there are many functions that take io.Writer as an argument. Now I want to know how to create an io.Writer and there are many ways to do so. But how can I find all the ways easily without guessing at packages and looking through all the methods to find those that return an io.Writer (or whatever other type I'm after)?</p>\n\n<p><strong>Edit:</strong> I should extend my question to also find types that implement a specific interface. Sticking with the io.Writer example (which admittedly was a bad example for the original question) it would be good to have a way to find any types that implement the Writer interface, since those types would be valid  arguments for a function that takes takes an io.Writer and thus answer the original question when the type is an interface.</p>\n"}, {"tags": ["javascript", "google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 4747451, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/nY1py.jpg?s=128&g=1", "display_name": "SimplicityGuy", "link": "https://stackoverflow.com/users/4747451/simplicityguy"}, "edited": false, "score": 0, "creation_date": 1428640677, "post_id": 29553476, "comment_id": 47257934, "body": "I think that&#39;s inaccurate: <a href=\"https://developers.google.com/api-client-library/python/guide/aaa_apikeys\" rel=\"nofollow noreferrer\">developers.google.com/api-client-library/python/guide/&hellip;</a> also, I&#39;m talking about my own API hosted on App Engine... Not Google&#39;s APIs per se."}, {"owner": {"reputation": 95, "user_id": 4747451, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/nY1py.jpg?s=128&g=1", "display_name": "SimplicityGuy", "link": "https://stackoverflow.com/users/4747451/simplicityguy"}, "edited": false, "score": 0, "creation_date": 1428640982, "post_id": 29553476, "comment_id": 47258014, "body": "Hmmm... This may be the closest to what I need minus the OAuth authorization: <a href=\"https://cloud.google.com/appengine/docs/python/appidentity/\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/docs/python/appidentity</a>"}, {"owner": {"reputation": 1274, "user_id": 3926538, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jNFNA.jpg?s=128&g=1", "display_name": "Upio", "link": "https://stackoverflow.com/users/3926538/upio"}, "reply_to_user": {"reputation": 95, "user_id": 4747451, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/nY1py.jpg?s=128&g=1", "display_name": "SimplicityGuy", "link": "https://stackoverflow.com/users/4747451/simplicityguy"}, "edited": false, "score": 0, "creation_date": 1428641007, "post_id": 29553476, "comment_id": 47258020, "body": "Did you see the example Google has <a href=\"https://developers.google.com/api-client-library/python/start/get_started#webapp\" rel=\"nofollow noreferrer\">developers.google.com/api-client-library/python/start/&hellip;</a> ? If i&#39;m misunderstanding your question, can you clarify exactly what you&#39;re trying to do?"}, {"owner": {"reputation": 95, "user_id": 4747451, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/nY1py.jpg?s=128&g=1", "display_name": "SimplicityGuy", "link": "https://stackoverflow.com/users/4747451/simplicityguy"}, "edited": false, "score": 0, "creation_date": 1428641135, "post_id": 29553476, "comment_id": 47258060, "body": "Yes, however that calls Google&#39;s API, and does explain anything about how the API key is sent over the wire... Whether it&#39;s in the header or as a param... And then no example on the API side on how to verify that the key matches what was specified in the developer console in the referrer field."}, {"owner": {"reputation": 1274, "user_id": 3926538, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jNFNA.jpg?s=128&g=1", "display_name": "Upio", "link": "https://stackoverflow.com/users/3926538/upio"}, "reply_to_user": {"reputation": 95, "user_id": 4747451, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/nY1py.jpg?s=128&g=1", "display_name": "SimplicityGuy", "link": "https://stackoverflow.com/users/4747451/simplicityguy"}, "edited": false, "score": 0, "creation_date": 1428641304, "post_id": 29553476, "comment_id": 47258111, "body": "So let me understand this. You have an app on GAE which exposes a RESTful API and you want to allow authenticated javascript clients the ability to call this API?"}, {"owner": {"reputation": 95, "user_id": 4747451, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/nY1py.jpg?s=128&g=1", "display_name": "SimplicityGuy", "link": "https://stackoverflow.com/users/4747451/simplicityguy"}, "edited": false, "score": 0, "creation_date": 1428641514, "post_id": 29553476, "comment_id": 47258169, "body": "I only want my JavaScript app from my domain to use the API exposed via GAE endpoints. Basically I have an API key set up already, but what does GAE offer in terms of validating that the usage of said key matches the restrictions I put on it? Clearly I need to check the existence of the key and those restrictions before my API does anything..."}, {"owner": {"reputation": 95, "user_id": 4747451, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/nY1py.jpg?s=128&g=1", "display_name": "SimplicityGuy", "link": "https://stackoverflow.com/users/4747451/simplicityguy"}, "edited": false, "score": 0, "creation_date": 1428641627, "post_id": 29553476, "comment_id": 47258212, "body": "From my perspective, GAE should expose a validate_api_key method. But if it doesn&#39;t I need to write that method, checking for the presence of the key and ensuring that the referrer or remote ip is my website, rejecting all other requests."}, {"owner": {"reputation": 1274, "user_id": 3926538, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jNFNA.jpg?s=128&g=1", "display_name": "Upio", "link": "https://stackoverflow.com/users/3926538/upio"}, "reply_to_user": {"reputation": 95, "user_id": 4747451, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/nY1py.jpg?s=128&g=1", "display_name": "SimplicityGuy", "link": "https://stackoverflow.com/users/4747451/simplicityguy"}, "edited": false, "score": 0, "creation_date": 1428642395, "post_id": 29553476, "comment_id": 47258412, "body": "OK so it looks like it passed as query parameter key=&lt;token&gt;. I think this is what you want, it talks about securing it to just your site etc <a href=\"https://developers.google.com/console/help/new/#generatingdevkeys\" rel=\"nofollow noreferrer\">developers.google.com/console/help/new/#generatingdevkeys</a> If it&#39;s not what you want then i&#39;m sorry, i can&#39;t help :("}, {"owner": {"reputation": 95, "user_id": 4747451, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/nY1py.jpg?s=128&g=1", "display_name": "SimplicityGuy", "link": "https://stackoverflow.com/users/4747451/simplicityguy"}, "edited": false, "score": 0, "creation_date": 1428680531, "post_id": 29553476, "comment_id": 47280579, "body": "Yeah, I saw that, but there&#39;s no example of usage of the key from the JS client or how to check the key in the endpoint. I guess I&#39;m just going to have to play with this until I figure it out. Thanks for the suggestions though."}], "tags": [], "owner": {"reputation": 1274, "user_id": 3926538, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jNFNA.jpg?s=128&g=1", "display_name": "Upio", "link": "https://stackoverflow.com/users/3926538/upio"}, "is_accepted": false, "score": 0, "last_activity_date": 1428640569, "creation_date": 1428640569, "answer_id": 29553476, "question_id": 29553345, "link": "https://stackoverflow.com/questions/29553345/examples-of-api-key-usage-and-checking/29553476#29553476", "title": "Examples of API key usage and checking?", "body": "<p>To talk to googles APIs you need an OAuth2 token. The scenario you're asking about (and more) is detailed here:</p>\n\n<p><a href=\"https://developers.google.com/identity/protocols/OAuth2\" rel=\"nofollow\">https://developers.google.com/identity/protocols/OAuth2</a></p>\n\n<p>Edit: the specific client side use case is documented here <a href=\"https://developers.google.com/identity/protocols/OAuth2UserAgent\" rel=\"nofollow\">https://developers.google.com/identity/protocols/OAuth2UserAgent</a></p>\n"}], "owner": {"reputation": 95, "user_id": 4747451, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/nY1py.jpg?s=128&g=1", "display_name": "SimplicityGuy", "link": "https://stackoverflow.com/users/4747451/simplicityguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428640569, "creation_date": 1428639842, "question_id": 29553345, "link": "https://stackoverflow.com/questions/29553345/examples-of-api-key-usage-and-checking", "title": "Examples of API key usage and checking?", "body": "<p>In the Google Developers Console, one can read an API key for public access to their own API. When creating this API key you can specify what referrers are to be used with what keys.</p>\n\n<p>I've looked around, and haven't found examples of how to pass this API key from a web client call in JavaScript nor have I been able to find how the API can check for the existence of this key and that it matches the referrer expectations as set in the Developer Console.</p>\n\n<p>Does anyone have examples on this?</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "answers": [{"comments": [{"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1428634259, "post_id": 29552055, "comment_id": 47256318, "body": "Can this be used with KeysOnly() ? For some reasons I get no result / iteration or error which is quite strange"}, {"owner": {"reputation": 6412, "user_id": 272372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLzr8.png?s=128&g=1", "display_name": "Hanuman", "link": "https://stackoverflow.com/users/272372/hanuman"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1428635190, "post_id": 29552055, "comment_id": 47256540, "body": "If should work, maybe there&#39;s something off in your logic, you&#39;re stating in the question that you want to use the username as ancestor, if it&#39;s the root entity you should just query directly, if not then something else is the ancestor."}], "tags": [], "owner": {"reputation": 6412, "user_id": 272372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLzr8.png?s=128&g=1", "display_name": "Hanuman", "link": "https://stackoverflow.com/users/272372/hanuman"}, "is_accepted": true, "score": 0, "last_activity_date": 1428630672, "last_edit_date": 1592644375, "creation_date": 1428630672, "answer_id": 29552055, "question_id": 29551986, "link": "https://stackoverflow.com/questions/29551986/whats-the-key-reserved-property-equivalent-for-the-go-api-datastore/29552055#29552055", "title": "What&#39;s the KEY_RESERVED_PROPERTY equivalent for the Go API ? datastore", "body": "<p>If you <a href=\"https://cloud.google.com/appengine/docs/java/javadoc/com/google/appengine/api/datastore/Entity#KEY_RESERVED_PROPERTY\" rel=\"nofollow noreferrer\">look at the docs</a>, <code>KEY_RESERVED_PROPERTY</code> is nothing but a property to refer to the key:</p>\n<blockquote>\n<p>A reserved property name used to refer to the key of the entity. This string can be used for filtering and sorting by the entity key itself.</p>\n</blockquote>\n<p>So this is nothing magical, you could do the same thing in Go with the <code>__key__</code> property, as stated <a href=\"https://cloud.google.com/appengine/docs/go/datastore/queries#Go_Key_filters\" rel=\"nofollow noreferrer\">in the docs</a>:</p>\n<blockquote>\n<h3>Key filters</h3>\n<p>To filter on the value of an entity's key, use the special property <code>__key__</code>:</p>\n<p><code>q := datastore.NewQuery(&quot;Person&quot;).Filter(&quot;__key__ &gt;&quot;, lastSeenKey)</code></p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1428687745, "post_id": 29555261, "comment_id": 47284583, "body": "Yeah but that means there is extra bandwidth for the actual value. In my case I don&#39;t need the value."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 0, "last_activity_date": 1428649185, "creation_date": 1428649185, "answer_id": 29555261, "question_id": 29551986, "link": "https://stackoverflow.com/questions/29551986/whats-the-key-reserved-property-equivalent-for-the-go-api-datastore/29555261#29555261", "title": "What&#39;s the KEY_RESERVED_PROPERTY equivalent for the Go API ? datastore", "body": "<blockquote>\n  <p>I need to check the existence of a key (i.e. an username).</p>\n</blockquote>\n\n<p>You can also do that by attempting to load the entity by key using the <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#Get\" rel=\"nofollow\"><code>datastore.Get()</code></a> function. A return value of <code>ErrNoSuchEntity</code> means no entity exists with the specified key:</p>\n\n<pre><code>if err := datastore.Get(c, key, dst); err == datastore.ErrNoSuchEntity {\n    // Key doesn't exist\n}\n</code></pre>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 29552055, "answer_count": 2, "score": 1, "last_activity_date": 1475291163, "creation_date": 1428630129, "last_edit_date": 1495540099, "question_id": 29551986, "link": "https://stackoverflow.com/questions/29551986/whats-the-key-reserved-property-equivalent-for-the-go-api-datastore", "title": "What&#39;s the KEY_RESERVED_PROPERTY equivalent for the Go API ? datastore", "body": "<p>I need to check the existence of a key (i.e. an username). <a href=\"https://stackoverflow.com/a/10176185/3257971\">It seems</a> that KEY_RESERVED_PROPERTY is a special key available for the java api that you can use to achieve the best performance and strong consistency so I'm wondering if there is any equivalent in Go. </p>\n\n<p>Currently I'm considering using a query with the username as ancestor + KeysOnly().</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 3, "creation_date": 1428621951, "post_id": 29550587, "comment_id": 47253005, "body": "Post some code + errors (if any) + connection log output (i.e. from lighttpd, if you&#39;re proxying through it)"}, {"owner": {"reputation": 76487, "user_id": 34218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f657c6adf1e623cd6f8818408ecd8f75?s=128&d=identicon&r=PG", "display_name": "Jason Coco", "link": "https://stackoverflow.com/users/34218/jason-coco"}, "edited": false, "score": 0, "creation_date": 1428701951, "post_id": 29550587, "comment_id": 47291540, "body": "Is the remote linux machine filtering? Is there some other firewall in between?"}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 893209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db75f82791eaebbe2f153c5f390895f6?s=128&d=identicon&r=PG", "display_name": "povey", "link": "https://stackoverflow.com/users/893209/povey"}, "is_accepted": false, "score": 0, "last_activity_date": 1428785249, "creation_date": 1428785249, "answer_id": 29582859, "question_id": 29550587, "link": "https://stackoverflow.com/questions/29550587/connecting-to-remote-golang-server/29582859#29582859", "title": "Connecting to remote golang server", "body": "<p>I was apparently using ports that weren't supported.  I ended up running as root (sudo) and binding to port 80, since I knew it was serving http traffic appropriately.</p>\n"}], "owner": {"reputation": 23, "user_id": 893209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db75f82791eaebbe2f153c5f390895f6?s=128&d=identicon&r=PG", "display_name": "povey", "link": "https://stackoverflow.com/users/893209/povey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1407, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428785249, "creation_date": 1428620906, "last_edit_date": 1428714970, "question_id": 29550587, "link": "https://stackoverflow.com/questions/29550587/connecting-to-remote-golang-server", "title": "Connecting to remote golang server", "body": "<p>I've been trying for what feels like days to remotely connect to a sockjs-go (<a href=\"https://github.com/igm/sockjs-go\" rel=\"nofollow\">https://github.com/igm/sockjs-go</a>) server application I've written.  I'm developing locally on Windows, and everything works fine.  When I try running on a remote linux server (after building on the linux box, obviously), I am never able to connect to the sockjs server.</p>\n\n<ul>\n<li><p>I've tried running the example echoserver web example from the sockjs-go repository on the remote machine, and I cannot connect to it either.</p></li>\n<li><p>I made sure to change the sockjs client IP from my local machine to the remote machine.</p></li>\n<li><p>I have the right public IP address and can view a static web page served by lighttpd.</p></li>\n</ul>\n\n<p>I've tried searching on google for anything golang-specific, but have found nothing.  Any suggestions would be great.</p>\n\n<p><strong>update</strong></p>\n\n<p>I am using the echo test code verbatim given here:  <a href=\"https://github.com/igm/sockjs-go/tree/v2/examples/webecho\" rel=\"nofollow\">https://github.com/igm/sockjs-go/tree/v2/examples/webecho</a></p>\n\n<p>As far as I can tell, the linux server isn't filtering.  Port 8080 is closed before running webecho, and is open after starting webecho.</p>\n\n<p>I have also tried <a href=\"https://coderwall.com/p/wohavg/creating-a-simple-tcp-server-in-go\" rel=\"nofollow\">https://coderwall.com/p/wohavg/creating-a-simple-tcp-server-in-go</a> , which I can connect to locally but not remotely.  Any ideas why I cannot connect to go programs remotely, but other programs have no problems connecting?</p>\n"}, {"tags": ["testing", "go", "mocking", "martini"], "answers": [{"comments": [{"owner": {"reputation": 243, "user_id": 4639689, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IeGRx.jpg?s=128&g=1", "display_name": "premunk", "link": "https://stackoverflow.com/users/4639689/premunk"}, "edited": false, "score": 1, "creation_date": 1428621834, "post_id": 29550428, "comment_id": 47252954, "body": "Thank you very much! This is what I was looking for. I will have more questions once i decide to implement it. Can I still bother you in this thread, if I do get stuck?"}, {"owner": {"reputation": 7031, "user_id": 28855, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8a62c5134a4ff7b618582d8dd267d2b5?s=128&d=identicon&r=PG", "display_name": "Jaime Soriano", "link": "https://stackoverflow.com/users/28855/jaime-soriano"}, "reply_to_user": {"reputation": 243, "user_id": 4639689, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IeGRx.jpg?s=128&g=1", "display_name": "premunk", "link": "https://stackoverflow.com/users/4639689/premunk"}, "edited": false, "score": 1, "creation_date": 1428646568, "post_id": 29550428, "comment_id": 47259933, "body": "Of course, no problem, it&#39;s no bother at all, I&#39;m also starting with Go :)"}], "tags": [], "owner": {"reputation": 7031, "user_id": 28855, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8a62c5134a4ff7b618582d8dd267d2b5?s=128&d=identicon&r=PG", "display_name": "Jaime Soriano", "link": "https://stackoverflow.com/users/28855/jaime-soriano"}, "is_accepted": true, "score": 2, "last_activity_date": 1428620467, "last_edit_date": 1428620467, "creation_date": 1428619894, "answer_id": 29550428, "question_id": 29547231, "link": "https://stackoverflow.com/questions/29547231/golang-with-martini-mock-testing-example/29550428#29550428", "title": "Golang with Martini: Mock testing example", "body": "<p>For doing dependency injection, the thing to test needs to have some way to receive its dependencies. In your code the connection to mongodb is done in the initialization of the thing to test itself, what doesn't allow to inject something that looks like a mongo connection, while being a mock.</p>\n\n<p>There are many ways of achieving it, but one of the simplest and most direct ways to do dependency injection, is to make the thing to test to receive the dependency when it's created, this way its context is the place where the specific implementation of the dependency is configured. Take a look to <a href=\"https://gist.github.com/jsoriano/ba32a23dd03c1aa6c0bc\" rel=\"nofollow\">this example</a>:</p>\n\n<pre><code>type DataStore interface {\n    Get(k string) string\n    Set(k, v string)\n}\n\ntype MyInstance struct {\n    *martini.Martini\n}\n\nfunc NewAppInstance(d DataStore) *MyInstance {\n    ...\n}\n\nfunc main() {\n   d := NewRedisDataStore(\"127.0.0.1\", 6379)\n   NewAppInstance(d).Run()\n}\n</code></pre>\n\n<p>The instance needs an implementation of a <code>Datastore</code> to work, it doesn't have to know anything about its internals, the only thing that matters is that it implements the interface, with both methods, <code>Get</code> and <code>Set</code>. Indeed, as a general rule in unit testing, you only want to test your code, not your dependencies. In this example, it uses Redis in \"production\", but, in testing:</p>\n\n<pre><code>type MockedDataStore struct {\n    mock.Mock\n}\n\nfunc (m *MockedDataStore) Get(k string) string {\n    args := m.Called(k)\n    return args.String(0)\n}\n\nfunc (m *MockedDataStore) Set(k, v string) {\n    m.Called(k, v)\n}\n</code></pre>\n\n<p>It's just something without any functionality beyond letting the framework check that it has been called. In the test itself you have to configure the expectations with things like:</p>\n\n<pre><code>d := new(MockedDataStore)\n...\nd.On(\"Set\", \"foo\", \"42\").Return().Once()\n...\nd.On(\"Get\", \"foo\").Return(\"42\").Once()\n</code></pre>\n\n<p>And, of course, initialize the instance with the mocked thing, and test it:</p>\n\n<pre><code>d := new(MockedDataStore)\ninstance := NewAppInstance(d)\nd.On(\"Get\", \"foo\").Return(\"42\").Once()\nrequest, _ = http.NewRequest(\"GET\", \"/get/foo\", nil)\nresponse = httptest.NewRecorder()\ninstance.ServeHTTP(response, request)\nd.AssertExpectations(t)\n</code></pre>\n\n<p>So, as a summary, being more specific with the answers to your questions:</p>\n\n<ol>\n<li><p>You need to make your instance to be able to be initialized with its dependencies, e.g. creating a method that receives the dependencies and returns the instance. Then mock the dependencies and from test use the mocks instead of the \"real\" ones.</p></li>\n<li><p>Use the method <code>ServeHTTP</code> that <code>martini</code> provides to generate responses to HTTP requests, and <code>httptest.NewRecorder()</code> to simulate the reception of the response. Of course, if your application have more complex functionality that is used apart of the HTTP interface, you can also test it as normal methods.</p></li>\n</ol>\n"}], "owner": {"reputation": 243, "user_id": 4639689, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IeGRx.jpg?s=128&g=1", "display_name": "premunk", "link": "https://stackoverflow.com/users/4639689/premunk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2429, "favorite_count": 1, "accepted_answer_id": 29550428, "answer_count": 1, "score": 1, "last_activity_date": 1428620467, "creation_date": 1428607602, "last_edit_date": 1428608588, "question_id": 29547231, "link": "https://stackoverflow.com/questions/29547231/golang-with-martini-mock-testing-example", "title": "Golang with Martini: Mock testing example", "body": "<p>I have put together a piece of code which does a GET on my route. I would like to test this using mocking. I am a Go and  a test noob, so any tips are greatly appreciated. </p>\n\n<p>My Generate Routes.go generates the routes for the current URL.\nSnippet:</p>\n\n<pre><code>func (h *StateRoute) GenerateRoutes (router *martini.Router) *martini.Router {\n    r := *router\n\n    /**\n     * Get all states\n     * \n     */\n    r.Get(\"/state\",  func( enc app.Encoder,\n            db abstract.MongoDB,\n            reqContext abstract.RequestContext,\n            res http.ResponseWriter,\n            req *http.Request) (int, string) {\n\n        states := []models.State{}\n\n        searchQuery := bson.M{}\n\n        var q *mgo.Query = db.GetDB().C(\"states\").Find(searchQuery)\n        query, currentPage, limit, total := abstract.Paginate(req, q)\n        query.All(&amp;states)\n\n        str, err := enc.EncodeWithPagination(currentPage, limit, total, states)\n\n        return http.StatusOK, app.WrapResponse(str, err)\n    })\n}\n</code></pre>\n\n<p>And this is being called in my server.go as such:</p>\n\n<pre><code>var configuration = app.LoadConfiguration(os.Getenv(\"MYENV\"))\n\n// Our Martini API Instance\nvar apiInstance *martini.Martini\n\nfunc init() {\n\n    apiInstance = martini.New()\n    // Setup middleware\n    apiInstance.Use(martini.Recovery())\n    apiInstance.Use(martini.Logger())\n\n    // Add the request context middleware to support contexual data availability\n    reqContext := &amp;app.LRSContext{ }\n    reqContext.SetConfiguration(configuration)\n\n    producer := app.ConfigProducer(reqContext)\n    reqContext.SetProducer(producer)\n\n    apiInstance.MapTo(reqContext, (*abstract.RequestContext)(nil))\n\n    // Hook in the OAuth2 Authorization object, to be processed before all requests\n    apiInstance.Use(app.VerifyAuthorization)\n\n    // Connect to the DB and Inject the DB connection into Martini\n    apiInstance.Use(app.MongoDBConnect(reqContext))\n\n    // Add the ResponseEncoder to allow JSON encoding of our responses\n    apiInstance.Use(app.ResponseEncoder)\n\n    // Add Route handlers\n    r := martini.NewRouter()\n\n    stateRouter := routes.StateRoute{}\n\n    stateRouter.GenerateRoutes(&amp;r)\n\n    // Add the built router as the martini action\n    apiInstance.Action(r.Handle)\n}\n</code></pre>\n\n<p>My doubts:</p>\n\n<ol>\n<li><p>How does the mocking work here, considering I am trying to inject the dependency? </p></li>\n<li><p>Where should I start the testing from i.e. should I mock up r.Get in the Generate Routes? Right now, I've done this but since I'm using Martini which handles all the routing and requests, I'm quote lost if what I've done is right?</p></li>\n</ol>\n\n<p>state_test.go:</p>\n\n<pre><code>type mockedStateRoute struct {\n    // How can I mock the stateRoute struct?\n    mock.Mock\n}\ntype mockedEncoder struct {\n    mock.Mock\n}\ntype mockedMongoDB struct {\n    mock.Mock\n}\ntype mockedReqContext struct{\n    mock.Mock\n}\ntype mockedRespWriter struct{\n    mock.Mock\n}\ntype mockedReq struct{\n    mock.Mock\n}\n\nfunc (m *mockedStateRoute) testGetStatesRoute(m1 mockedEncoder,\n                    m2 mockedMongoDB, m3 mockedReqContext,\n                    m4 mockedReqContext, m5 mockedRespWriter,\n                    m6 mockedReq) (string) {\n                        args := m.Called(m1,m2,m3,m4,m5,m6)\n                        fmt.Print(\"You just called /states/GET\")\n                        // 1 is just a test value I want to return\n                    return 1, args.Error(1)\n}\n\nfunc TestSomething (t *testing.T) {\n    testObj := new(mockedStateRoute)\n\n    testObj.On(\"testGetStatesRoute\", 123).Return(true,nil)\n\n    // My target function that does something with mockedStateRoute\n    // How can I call the GET function in GenerateRoutes(). Or should I, since martini is handling all my requests\n}\n</code></pre>\n\n<p>Links I've referred to:</p>\n\n<ol>\n<li><a href=\"https://github.com/stretchr/testify#mock-package\" rel=\"nofollow\">/stretchr/testify/mock doc</a></li>\n<li><a href=\"https://github.com/stretchr/testify#mock-package\" rel=\"nofollow\">examples of 1.</a></li>\n</ol>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 25272, "user_id": 1695163, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/85ffb58dc3ed0067128804ef843245a6?s=128&d=identicon&r=PG", "display_name": "ddavison", "link": "https://stackoverflow.com/users/1695163/ddavison"}, "edited": false, "score": 4, "creation_date": 1428608982, "post_id": 29547480, "comment_id": 47246770, "body": "answers with just links typically are not good answers.. you should pull the data necessary to answer the question, then source the material."}], "tags": [], "owner": {"reputation": 4271, "user_id": 2416049, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae3e41bd94866b970a7f2c5e8a16594c?s=128&d=identicon&r=PG", "display_name": "jtmarmon", "link": "https://stackoverflow.com/users/2416049/jtmarmon"}, "is_accepted": false, "score": -3, "last_activity_date": 1428608402, "creation_date": 1428608402, "answer_id": 29547480, "question_id": 29545784, "link": "https://stackoverflow.com/questions/29545784/mongodb-admin-commands-with-mgo-driver/29547480#29547480", "title": "MongoDB admin commands with mgo driver", "body": "<p><a href=\"http://godoc.org/labix.org/v2/mgo#GetStats\" rel=\"nofollow\">get stats</a></p>\n\n<p><a href=\"https://github.com/deftlabs/presentations/blob/master/golang-ny-meetup-mar-12-2013/src/meetup/hello_mgo.go#L32\" rel=\"nofollow\">manually running server status commands</a></p>\n"}, {"comments": [{"owner": {"reputation": 770, "user_id": 2538721, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/99b6d8acf0cca332dc2bf8cc55e5c945?s=128&d=identicon&r=PG", "display_name": "kylemclaren", "link": "https://stackoverflow.com/users/2538721/kylemclaren"}, "edited": false, "score": 1, "creation_date": 1428679133, "post_id": 29560747, "comment_id": 47279724, "body": "Dude @Adam, you are awesome. This is exactly what I was asking and more. Thanks you!"}, {"owner": {"reputation": 198, "user_id": 139975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea6756aa3e3e2c4a9d8cd0ebbd51b6cf?s=128&d=identicon&r=PG", "display_name": "Janaka", "link": "https://stackoverflow.com/users/139975/janaka"}, "edited": false, "score": 1, "creation_date": 1448841063, "post_id": 29560747, "comment_id": 55734893, "body": "Thanks @adam. Completely answered my question :)"}, {"owner": {"reputation": 899, "user_id": 2427997, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/HWukn.png?s=128&g=1", "display_name": "Sergey11g", "link": "https://stackoverflow.com/users/2427997/sergey11g"}, "edited": false, "score": 0, "creation_date": 1549984804, "post_id": 29560747, "comment_id": 96098191, "body": "The <i>else</i>s are redundant."}], "tags": [], "owner": {"reputation": 19893, "user_id": 1148648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54f4316cfc862757731f29c2cd1524cf?s=128&d=identicon&r=PG", "display_name": "Adam Comerford", "link": "https://stackoverflow.com/users/1148648/adam-comerford"}, "is_accepted": true, "score": 15, "last_activity_date": 1428666674, "creation_date": 1428666674, "answer_id": 29560747, "question_id": 29545784, "link": "https://stackoverflow.com/questions/29545784/mongodb-admin-commands-with-mgo-driver/29560747#29560747", "title": "MongoDB admin commands with mgo driver", "body": "<p>This is certainly possible, but first you need to bear in mind that the \"commands\" you have listed are actually shell helpers.  You will need to get the real commands that they represent to run them via <code>mgo</code> <a href=\"https://github.com/go-mgo/mgo/blob/v2/session.go#L1771\">Session.Run</a>.</p>\n\n<p>There are a couple of ways to do that, the first is to just run <code>db.listCommands()</code> in the shell and find the appropriate one.  The second way to do this is to run the helper you wish to emulate without parentheses.  For example:</p>\n\n<pre><code>&gt; rs.status\nfunction () { return db._adminCommand(\"replSetGetStatus\"); }\n</code></pre>\n\n<p>As you can see, what the helper actually does is run the <code>replSetGetStatus</code> command against the <code>admin</code> database.  Similarly you will find that <code>db.stats()</code> actually runs the <code>dbstats</code> command.  The <code>db.serverStatus()</code> helper is the only one of the three you listed that you can pretty much run as-is.</p>\n\n<p>Here's a very simple example of running all three - I show two forms of the call, one that just passes a string and the more general option that passes in the full command document - I ran this on a test <code>mongod</code> without auth, so you would have to add that piece yourself to test on an auth-enabled instance:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"gopkg.in/mgo.v2\"\n    \"gopkg.in/mgo.v2/bson\"\n)\n\nfunc main() {\n    session, err := mgo.Dial(\"localhost\")\n    if err != nil {\n        panic(err)\n    }\n    defer session.Close()\n\n    // Optional. Switch the session to a monotonic behavior.\n    session.SetMode(mgo.Monotonic, true)\n    result := bson.M{}\n    if err := session.DB(\"admin\").Run(bson.D{{\"serverStatus\", 1}}, &amp;result); err != nil {\n        panic(err)\n    } else {\n        fmt.Println(result)\n    }\n    if err := session.DB(\"test\").Run(\"dbstats\", &amp;result); err != nil {\n        panic(err)\n    } else {\n        fmt.Println(result)\n    }\n    if err := session.DB(\"admin\").Run(\"replSetGetStatus\", &amp;result); err != nil {\n        panic(err)\n    } else {\n        fmt.Println(result)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 770, "user_id": 2538721, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/99b6d8acf0cca332dc2bf8cc55e5c945?s=128&d=identicon&r=PG", "display_name": "kylemclaren", "link": "https://stackoverflow.com/users/2538721/kylemclaren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3451, "favorite_count": 1, "accepted_answer_id": 29560747, "answer_count": 2, "score": 7, "last_activity_date": 1428679229, "creation_date": 1428602637, "last_edit_date": 1428679229, "question_id": 29545784, "link": "https://stackoverflow.com/questions/29545784/mongodb-admin-commands-with-mgo-driver", "title": "MongoDB admin commands with mgo driver", "body": "<p>Is it possible, given admin creds, to run mongo shell commands such as <code>db.stats()</code>, <code>rs.status()</code> and <code>db.serverStatus()</code> external to the mongo shell via the official Go driver for MongoDB (mgo)?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 4, "last_activity_date": 1428600181, "creation_date": 1428600181, "answer_id": 29545033, "question_id": 29544765, "link": "https://stackoverflow.com/questions/29544765/replace-pointer-value-a-b-in-golang-for-interface/29545033#29545033", "title": "replace pointer value *a = *b in golang for interface", "body": "<p>It doesn't matter if they have the same interface, <code>*s1</code> and <code>*s2</code> are different types, and can't be assigned to one another.</p>\n\n<p>If you want to be able to swap the same type through the interface, you can add a type assertion to the method</p>\n\n<pre><code>func (s *s1) replace(swap i) {\n    switch t := swap.(type) {\n    case *s1:\n        *s = *t\n    default:\n        panic(\"not the same type\")\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3216, "user_id": 1273978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dd2212a18f9aba8d63b14c552027a12?s=128&d=identicon&r=PG", "display_name": "metakeule", "link": "https://stackoverflow.com/users/1273978/metakeule"}, "is_accepted": false, "score": 0, "last_activity_date": 1428676977, "creation_date": 1428676977, "answer_id": 29564317, "question_id": 29544765, "link": "https://stackoverflow.com/questions/29544765/replace-pointer-value-a-b-in-golang-for-interface/29564317#29564317", "title": "replace pointer value *a = *b in golang for interface", "body": "<p>You can swap the underlying values of interfaces via pointers to interfaces, if you want:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Doer interface {\n    Do()\n}\n\ntype doInt int\n\nfunc (i doInt) Do() {\n    fmt.Printf(\"int: %v\\n\", i)\n}\n\ntype doFloat float64\n\nfunc (f doFloat) Do() {\n    fmt.Printf(\"float: %v\\n\", f)\n}\n\nfunc swap(to, from *Doer) {\n    *to = *from\n}\n\nfunc main() {\n    var d1 Doer = doInt(1)\n    var d2 Doer = doFloat(1.1)\n\n    var d *Doer\n\n    d = &amp;d1\n\n    (*d).Do()\n    swap(d, &amp;d2)\n    (*d).Do()\n}\n</code></pre>\n\n<p>But it is much easier to simply assign to the interface like this:</p>\n\n<pre><code>func main() {\n    var d Doer = doInt(1)\n    d.Do()  \n    d = doFloat(1.1) // swapped!\n    d.Do()\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4770257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50a314b1bdb4fce59b0e91ce29b84af?s=128&d=identicon&r=PG&f=1", "display_name": "hyphenatic", "link": "https://stackoverflow.com/users/4770257/hyphenatic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2624, "favorite_count": 0, "accepted_answer_id": 29545033, "answer_count": 2, "score": 3, "last_activity_date": 1428676977, "creation_date": 1428599249, "question_id": 29544765, "link": "https://stackoverflow.com/questions/29544765/replace-pointer-value-a-b-in-golang-for-interface", "title": "replace pointer value *a = *b in golang for interface", "body": "<p>It's possible to replace pointer value using *a = *b for two variables of same type</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n)\n\ntype s1 struct {\n    id int\n}\n\nfunc (s *s1) replace(s2 *s1) {\n    *s = *s2\n}\n\nfunc test(s *s1, s2 *s1) {\n    s.replace(s2)\n}\n\nfunc main() {\n    s := &amp;s1{1}\n    s2 := &amp;s1{2}\n    log.Println(s, s2)\n    test(s, s2)\n    log.Println(s, s2)\n}\n</code></pre>\n\n<p>The result is</p>\n\n<pre><code>2015/04/09 16:57:00 &amp;{1} &amp;{2}\n2015/04/09 16:57:00 &amp;{2} &amp;{2}\n</code></pre>\n\n<p>Is it possible to achieve the same for two variables of different type but same interface? </p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n)\n\ntype i interface {\n    replace(s2 i)\n}\n\ntype s1 struct {\n    id int\n}\n\nfunc (s *s1) replace(s2 i) {\n    *s = *s2\n}\n\ntype s2 struct {\n    id float64\n}\n\nfunc (s *s2) replace(s2 i) {\n    *s = *s2\n}\n\nfunc test(s i, s2 i) {\n    s.replace(s2)\n}\n\nfunc main() {\n    s := &amp;s1{1}\n    s2 := &amp;s2{2.0}\n    log.Println(s, s2)\n    test(s, s2)\n    log.Println(s, s2)\n}\n</code></pre>\n\n<p>This does not compile</p>\n\n<pre><code>./test.go:16: invalid indirect of s2 (type i)\n./test.go:24: invalid indirect of s2 (type i)\n</code></pre>\n"}, {"tags": ["c", "logging", "go", "synchronization", "cgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1428598664, "post_id": 29544150, "comment_id": 47240632, "body": "What precisely is your question? You&#39;ve written a lot about the drawbacks of what you&#39;re trying to do, but you haven&#39;t asked anything."}, {"owner": {"reputation": 9586, "user_id": 1000282, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/371832f83b79a41443fa50d3793b0cfd?s=128&d=identicon&r=PG", "display_name": "pepper_chico", "link": "https://stackoverflow.com/users/1000282/pepper-chico"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1428598820, "post_id": 29544150, "comment_id": 47240714, "body": "@JimB I may ask an exact question and get an correct answer for it, but it may not be what I was really looking for. General guidance in this scope, which I think is small, is one better answer."}, {"owner": {"reputation": 9586, "user_id": 1000282, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/371832f83b79a41443fa50d3793b0cfd?s=128&d=identicon&r=PG", "display_name": "pepper_chico", "link": "https://stackoverflow.com/users/1000282/pepper-chico"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1428599099, "post_id": 29544150, "comment_id": 47240863, "body": "@JimB this is the picture of the process of reasoning in my mind now. An experienced developer at the topic should know what&#39;s my need by looking at it. I believe the &quot;picture&quot; provides more information than me asking wrong questions."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1428599346, "post_id": 29544150, "comment_id": 47241002, "body": "Well, &quot;general guidance&quot; is off topic for SO, but it seems you have a good grasp of what you&#39;re trying to do. My opinion would be to log separately (go and cgo might as well be logically separate processes), and forgo synchronization between the two. If needed, a context id of some sort could be passed between the two and logged, so that log order could be resolved after the fact."}, {"owner": {"reputation": 9586, "user_id": 1000282, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/371832f83b79a41443fa50d3793b0cfd?s=128&d=identicon&r=PG", "display_name": "pepper_chico", "link": "https://stackoverflow.com/users/1000282/pepper-chico"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1428599560, "post_id": 29544150, "comment_id": 47241117, "body": "@JimB ah indeed, that&#39;s true, as I was too tied to logging to stdout, it just occurred to me too, right before you asked, that I may just forget about synchronizing and segregate go and cgo logging, I will be obligated to use other stuff than stdout but... Only thing is that it won&#39;t follow the same patterns and options. tks."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1428599647, "post_id": 29544150, "comment_id": 47241162, "body": "no problem. (also, if you do want discussion and/or opinions, the mailing list or IRC are probably more appropriate venues <a href=\"https://golang.org/help/\" rel=\"nofollow noreferrer\">golang.org/help</a>)"}], "owner": {"reputation": 9586, "user_id": 1000282, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/371832f83b79a41443fa50d3793b0cfd?s=128&d=identicon&r=PG", "display_name": "pepper_chico", "link": "https://stackoverflow.com/users/1000282/pepper-chico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 342, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1428597757, "creation_date": 1428597317, "last_edit_date": 1428597757, "question_id": 29544150, "link": "https://stackoverflow.com/questions/29544150/cgo-and-logging", "title": "CGO and Logging", "body": "<p>I'm about to adopt an enhaced logging library in a Go codebase, I've reduced my scope to <a href=\"https://github.com/mgutz/logxi\" rel=\"nofollow\">logxi</a> and <a href=\"https://github.com/inconshreveable/log15\" rel=\"nofollow\">log15</a>. Even though they seem quite new, I like the <a href=\"https://brandur.org/logfmt\" rel=\"nofollow\">logfmt</a> enforcement offered by them, although each has its advantages and disadvantages. Anyway, even bringing the simpler standard logging facility to the question, an issue remains.</p>\n\n<p>I'm mixing Go and C++ a lot (through C bridges and CGO). I'm facing the issue of whether I should make Go callbacks for logging from C++ or logging straight from C++, which would make me miss the library pattern adopted in Go. In any case, let's say I'm talking about logging to stdout, I'm still unsure how to proceed with a best option about having synchronized output, since it's both Go and C land and I'll have some threads looping in C while some goroutines running on its own. By adopting the callbacks this may not be an issue, but it may be expensive... Also wrapping a logging facility for C is problematic since they generally provide a variadic API in Go.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 5, "last_activity_date": 1428597912, "creation_date": 1428597912, "answer_id": 29544329, "question_id": 29544146, "link": "https://stackoverflow.com/questions/29544146/go-unmarshaling-yaml-into-struct/29544329#29544329", "title": "Go Unmarshaling YAML into struct", "body": "<p>Your struct's fields are unexported. <a href=\"http://golang.org/ref/spec#Exported_identifiers\" rel=\"noreferrer\">Export</a> them and it'll work.</p>\n\n<pre><code>type Config struct {\n    FooBar string `yaml:\"foo_bar\"`\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 40221, "user_id": 7311767, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/13Fpq.png?s=128&g=1", "display_name": "Stephen Rauch", "link": "https://stackoverflow.com/users/7311767/stephen-rauch"}, "edited": false, "score": 0, "creation_date": 1530665840, "post_id": 51164420, "comment_id": 89312255, "body": "This appears to my untrained eye to be the same as the accepted answer.  Can you please explain how it differs?"}, {"owner": {"reputation": 313, "user_id": 4257977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23c7ed74a4fd0102185c19697de5cc7a?s=128&d=identicon&r=PG&f=1", "display_name": "xichen", "link": "https://stackoverflow.com/users/4257977/xichen"}, "reply_to_user": {"reputation": 40221, "user_id": 7311767, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/13Fpq.png?s=128&g=1", "display_name": "Stephen Rauch", "link": "https://stackoverflow.com/users/7311767/stephen-rauch"}, "edited": false, "score": 0, "creation_date": 1531257937, "post_id": 51164420, "comment_id": 89526408, "body": "I guess this is because the &#39;reflect&#39; in the lower level required the variable be visible."}], "tags": [], "owner": {"reputation": 313, "user_id": 4257977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23c7ed74a4fd0102185c19697de5cc7a?s=128&d=identicon&r=PG&f=1", "display_name": "xichen", "link": "https://stackoverflow.com/users/4257977/xichen"}, "is_accepted": false, "score": 1, "last_activity_date": 1530664678, "creation_date": 1530664678, "answer_id": 51164420, "question_id": 29544146, "link": "https://stackoverflow.com/questions/29544146/go-unmarshaling-yaml-into-struct/51164420#51164420", "title": "Go Unmarshaling YAML into struct", "body": "<p>The capital matters:</p>\n\n<p>foo_bar --> Foo_bar</p>\n"}], "owner": {"reputation": 72977, "user_id": 95944, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/SprKq.jpg?s=128&g=1", "display_name": "Richard Knop", "link": "https://stackoverflow.com/users/95944/richard-knop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1723, "favorite_count": 0, "accepted_answer_id": 29544329, "answer_count": 2, "score": 4, "last_activity_date": 1530664678, "creation_date": 1428597311, "question_id": 29544146, "link": "https://stackoverflow.com/questions/29544146/go-unmarshaling-yaml-into-struct", "title": "Go Unmarshaling YAML into struct", "body": "<p>I am trying to parse a YAML data into a string:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"gopkg.in/yaml.v2\"\n)\n\ntype Config struct {\n    foo_bar string\n}\n\nfunc FailOnError(err error, msg string) {\n    if err != nil {\n        log.Fatalf(\"%s: %s\", msg, err)\n        panic(fmt.Sprintf(\"%s: %s\", msg, err))\n    }\n}\n\nfunc ParseYAMLConfig(data []byte) *Config {\n    config := Config{}\n\n    err := yaml.Unmarshal(data, &amp;config)\n    if err != nil {\n        FailOnError(err, \"Failed to unmarshal the config\")\n    }\n\n    return &amp;config\n}\n\nvar configYAMLData = `\n---\nfoo_bar: \"https://foo.bar\"\n`\n\nfunc main() {\n    config := ParseYAMLConfig([]byte(configYAMLData))\n    fmt.Printf(\"%v\", config)\n}\n</code></pre>\n\n<p>For some reason, config is an empty struct &amp;{} though.</p>\n"}, {"tags": ["go", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 4065, "user_id": 354222, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1e2881af9cfcb757041a5702c05ece26?s=128&d=identicon&r=PG", "display_name": "MushinNoShin", "link": "https://stackoverflow.com/users/354222/mushinnoshin"}, "edited": false, "score": 0, "creation_date": 1428594837, "post_id": 29543275, "comment_id": 47238252, "body": "Doh! for some reason googling didn&#39;t pop up the docs and I never thought to look.  Thanks.  Bookmarking so I don&#39;t ask stupid obvious questions again."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 4065, "user_id": 354222, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1e2881af9cfcb757041a5702c05ece26?s=128&d=identicon&r=PG", "display_name": "MushinNoShin", "link": "https://stackoverflow.com/users/354222/mushinnoshin"}, "edited": false, "score": 0, "creation_date": 1428594866, "post_id": 29543275, "comment_id": 47238274, "body": "@MushinNoShin: or you could simply printf the value"}, {"owner": {"reputation": 332764, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "reply_to_user": {"reputation": 4065, "user_id": 354222, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1e2881af9cfcb757041a5702c05ece26?s=128&d=identicon&r=PG", "display_name": "MushinNoShin", "link": "https://stackoverflow.com/users/354222/mushinnoshin"}, "edited": false, "score": 2, "creation_date": 1428594933, "post_id": 29543275, "comment_id": 47238330, "body": "@MushinNoShin At least now this should turn in in Google for other users ;)"}, {"owner": {"reputation": 4065, "user_id": 354222, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1e2881af9cfcb757041a5702c05ece26?s=128&d=identicon&r=PG", "display_name": "MushinNoShin", "link": "https://stackoverflow.com/users/354222/mushinnoshin"}, "edited": false, "score": 0, "creation_date": 1428595068, "post_id": 29543275, "comment_id": 47238436, "body": "@dystroy and hopefully they&#39;ll see just how clear, readable and accessible the docs are :D"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 95903, "user_id": 314291, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e155276fa30aebfcbd9280d07fd1ddf8?s=128&d=identicon&r=PG", "display_name": "StuartLC", "link": "https://stackoverflow.com/users/314291/stuartlc"}, "edited": false, "score": 0, "creation_date": 1428595477, "post_id": 29543275, "comment_id": 47238723, "body": "@StuartLC: I see it now ;) dystroy just beat him to the answer on his own question."}], "tags": [], "owner": {"reputation": 332764, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "is_accepted": true, "score": 8, "last_activity_date": 1428594771, "creation_date": 1428594771, "answer_id": 29543275, "question_id": 29543255, "link": "https://stackoverflow.com/questions/29543255/zero-value-for-funcs/29543275#29543275", "title": "Zero value for funcs", "body": "<p>From <a href=\"http://golang.org/ref/spec#Function_types\">the documentation</a> :</p>\n\n<blockquote>\n  <p>The value of an uninitialized variable of function type is nil.</p>\n</blockquote>\n"}], "owner": {"reputation": 4065, "user_id": 354222, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1e2881af9cfcb757041a5702c05ece26?s=128&d=identicon&r=PG", "display_name": "MushinNoShin", "link": "https://stackoverflow.com/users/354222/mushinnoshin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 29543275, "answer_count": 1, "score": -3, "last_activity_date": 1428594786, "creation_date": 1428594718, "question_id": 29543255, "link": "https://stackoverflow.com/questions/29543255/zero-value-for-funcs", "title": "Zero value for funcs", "body": "<p>Given a struct:</p>\n\n<pre><code>type foo struct {\n  bar func(int) int\n}\n</code></pre>\n\n<p>when I <code>var x foo</code></p>\n\n<p>what is the initial value of <code>x.bar</code> ?</p>\n"}, {"tags": ["logging", "go"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1428585907, "post_id": 29538668, "comment_id": 47231513, "body": "Why not just use a global logger variable in each package and create/set them in the main package?"}, {"owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "edited": false, "score": 1, "creation_date": 1428590070, "post_id": 29538668, "comment_id": 47234682, "body": "Maybe you can try out <a href=\"https://github.com/golang/glog\" rel=\"nofollow noreferrer\">github.com/golang/glog</a> . While it doesn&#39;t have Debug, it has Info, Warning, Error and Fatal. It also allows verbosity level logging. Hmm, but it doesn&#39;t allow setting writer either. Oh well! Worth a comment"}], "answers": [{"tags": [], "owner": {"reputation": 624, "user_id": 1887309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ba562230112c5953454a7b7ec7acb6?s=128&d=identicon&r=PG", "display_name": "Cedmundo", "link": "https://stackoverflow.com/users/1887309/cedmundo"}, "is_accepted": true, "score": 7, "last_activity_date": 1428591069, "creation_date": 1428591069, "answer_id": 29541867, "question_id": 29538668, "link": "https://stackoverflow.com/questions/29538668/logging-globally-across-packages/29541867#29541867", "title": "Logging globally (across packages)", "body": "<p>The proper way is what you think is the ideal way. Just create a package (preferably following Go's conventions <a href=\"https://golang.org/doc/code.html\" rel=\"noreferrer\">https://golang.org/doc/code.html</a>) and make your Log global: </p>\n\n<pre><code>package mylog\n\n// Define your custom logger type.\ntype logger struct { /* Whatever you want */ }\n\n// Optionally make it a interface.\ntype Logger interface { /* Your functions */ }\n\n// And just go global.\nvar defaultLogger *Logger\n\nfunc init(){\n   defaultLogger = new(logger)\n}\n\nfunc Debug(params ...string){\n   // Have some fun.\n}\n\n// ...\n</code></pre>\n\n<p>Also I would recommend to describe in documentation that your project uses that logging feature.</p>\n"}, {"comments": [{"owner": {"reputation": 781, "user_id": 2375505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/322780ece5ae3e7a2604592c45368c08?s=128&d=identicon&r=PG", "display_name": "rpkamp", "link": "https://stackoverflow.com/users/2375505/rpkamp"}, "edited": false, "score": 3, "creation_date": 1428674279, "post_id": 29556974, "comment_id": 47276335, "body": "Why did you copy the whole logger and not just embed <code>Logger</code> in a new struct of your own, that would then also implement <code>Error</code>, <code>Info</code> etc? It seems a bit overkill to copy it all..."}, {"owner": {"reputation": 5488, "user_id": 1078890, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Dqula.jpg?s=128&g=1", "display_name": "IamNaN", "link": "https://stackoverflow.com/users/1078890/iamnan"}, "reply_to_user": {"reputation": 781, "user_id": 2375505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/322780ece5ae3e7a2604592c45368c08?s=128&d=identicon&r=PG", "display_name": "rpkamp", "link": "https://stackoverflow.com/users/2375505/rpkamp"}, "edited": false, "score": 0, "creation_date": 1428739548, "post_id": 29556974, "comment_id": 47299638, "body": "@ScallioXT - Because I wanted a global logger. If I make my own type and embed the standard logger I would then have to wrap all the functions (those that aren&#39;t methods) of the log package to be able to access them globally. And that would be a lot more work then doing what I did above, but I don&#39;t see how else I&#39;d do that. Perhaps I&#39;m missing something. If so please point me in the right direction."}, {"owner": {"reputation": 781, "user_id": 2375505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/322780ece5ae3e7a2604592c45368c08?s=128&d=identicon&r=PG", "display_name": "rpkamp", "link": "https://stackoverflow.com/users/2375505/rpkamp"}, "edited": false, "score": 1, "creation_date": 1428864387, "post_id": 29556974, "comment_id": 47333150, "body": "I thought it would be easier to just embed <code>log.Logger</code>, but I just tried it and you get into trouble that the fields of <code>log.Logger</code> are not exported so you can&#39;t refer to them. To solve that you&#39;d have to jump though a lot of hoops and it&#39;s indeed not worth it. Just copying it all over like you&#39;re doing now seems the best solution as far as I can see."}], "tags": [], "owner": {"reputation": 5488, "user_id": 1078890, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Dqula.jpg?s=128&g=1", "display_name": "IamNaN", "link": "https://stackoverflow.com/users/1078890/iamnan"}, "is_accepted": false, "score": 5, "last_activity_date": 1428655248, "creation_date": 1428655248, "answer_id": 29556974, "question_id": 29538668, "link": "https://stackoverflow.com/questions/29538668/logging-globally-across-packages/29556974#29556974", "title": "Logging globally (across packages)", "body": "<p>@CedmundoMartinez answer rattled my head enough to come up with the (extremely simple and rather obvious, now that I can use my rear view mirrors) answer.</p>\n\n<p>I'm posting my answer here for anyone who is interested in a similar solution.</p>\n\n<p>What I did was to make a copy of the standard log package (src/log/log.go) and extend it. It couldn't be easier to get a global logger that already does everything the standard logger does plus anything else you want it to do! In this case support leveled logging.</p>\n\n<p>The only modifications I had to make:</p>\n\n<pre><code>type Logger struct {\n    mu     sync.Mutex // ensures atomic writes; protects the following fields\n    prefix string     // prefix to write at beginning of each line\n    flag   int        // properties\n    out    io.Writer  // destination for output\n    buf    []byte     // for accumulating text to write\n    level  int        // One of DEBUG, ERROR, INFO\n}\n</code></pre>\n\n<p>Only the last line was added. The log package sets a global variable <strong>std</strong> which can then be used to access the struct fields from any function in the package.</p>\n\n<p>Next I added constants for the different log levels:</p>\n\n<pre><code>const (\n    DEBUG = 1 &lt;&lt; iota\n    INFO\n    ERROR\n)\n</code></pre>\n\n<p>Next I added my functions:</p>\n\n<p>(Note: ct is package <a href=\"https://github.com/seago/go-colortext\" rel=\"noreferrer\">https://github.com/seago/go-colortext</a> which allows to color console text on windows. So the errors here all print in red)</p>\n\n<pre><code>func Error(v ...interface{}) {\n    if std.level &lt;= ERROR {\n        ct.ChangeColor(ct.Red, true, ct.None, false)\n        s := fmt.Sprintf(\"ERROR: %v\", v...)\n        std.Output(2, s)\n        ct.ResetColor()\n    }\n}\n\nfunc Info(format string, v ...interface{}) {\n    if std.level &lt;= INFO {\n        s := fmt.Sprintf(\"INFO: \"+format, v...)\n        std.Output(2, s)\n    }\n}\n\nfunc Debug(v ...interface{}) {\n    if std.level &lt;= DEBUG {\n        s := fmt.Sprintf(\"DEBUG: %v\", v...)\n        std.Output(2, s)\n    }\n}\n\nfunc SetLogLevel(lvl int) {\n    std.level = lvl\n}\n</code></pre>\n\n<p>And that's it! With that I can now use it by simply importing the modified package instead of the standard log package and log away:</p>\n\n<pre><code>import (\n    \"errors\"\n    \"tryme/log\" \n)\n\nfunc main() {\n    log.SetLogLevel(log.INFO)\n    log.Info(\"This is a test Info\")\n    err := errors.New(\"This is a test error!!!\")\n    log.Error(err)\n    log.Debug(\"Testing debugging\") // won't be printed with log.INFO\n}\n</code></pre>\n\n<p>This is of course just a demo and can easily be extended further with more log levels, output formatting etc. </p>\n\n<p>You can use all the functions the standard log package provides like SetOutput to write to a file or a MultiWriter to write to file and console etc.</p>\n"}, {"tags": [], "owner": {"reputation": 1275, "user_id": 3044418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af7f92727ba68dfe3edd434be8ecb309?s=128&d=identicon&r=PG&f=1", "display_name": "Anfernee", "link": "https://stackoverflow.com/users/3044418/anfernee"}, "is_accepted": false, "score": 1, "last_activity_date": 1458648917, "creation_date": 1458648917, "answer_id": 36154148, "question_id": 29538668, "link": "https://stackoverflow.com/questions/29538668/logging-globally-across-packages/36154148#36154148", "title": "Logging globally (across packages)", "body": "<p>To add, if you want to do logging over multiple Go applications, you can use RPC and create a logging service. This would be an application sits on its own, providing services to other applications. <a href=\"https://golang.org/pkg/net/rpc/\" rel=\"nofollow\">Golang has its own package for it</a></p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 9444064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GWGbk.jpg?s=128&g=1", "display_name": "ctreminiom", "link": "https://stackoverflow.com/users/9444064/ctreminiom"}, "is_accepted": false, "score": 3, "last_activity_date": 1557042553, "creation_date": 1557042553, "answer_id": 55989885, "question_id": 29538668, "link": "https://stackoverflow.com/questions/29538668/logging-globally-across-packages/55989885#55989885", "title": "Logging globally (across packages)", "body": "<p>I'm posting the solution worked for me!. I just created my own package, and I used the  <strong>init</strong> function.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package logging\n\nimport (\n    \"io\"\n    logging \"log\"\n    \"os\"\n\n    \"github.com/Sirupsen/logrus\"\n)\n\nvar (\n    log *logrus.Logger\n)\n\nfunc init() {\n    f, err := os.OpenFile(\"logs/application.log\", os.O_RDWR|os.O_CREATE|os.O_APPEND, 0666)\n\n    if err != nil {\n        logging.Fatalf(\"error opening file: %v\", err)\n    }\n\n    log = logrus.New()\n\n    //log.Formatter = &amp;logrus.JSONFormatter{}\n\n    log.SetReportCaller(true)\n\n    mw := io.MultiWriter(os.Stdout, f)\n    log.SetOutput(mw)\n}\n\n// Info ...\nfunc Info(format string, v ...interface{}) {\n    log.Infof(format, v...)\n}\n\n// Warn ...\nfunc Warn(format string, v ...interface{}) {\n    log.Warnf(format, v...)\n}\n\n// Error ...\nfunc Error(format string, v ...interface{}) {\n    log.Errorf(format, v...)\n}\n\nvar (\n\n    // ConfigError ...\n    ConfigError = \"%v type=config.error\"\n\n    // HTTPError ...\n    HTTPError = \"%v type=http.error\"\n\n    // HTTPWarn ...\n    HTTPWarn = \"%v type=http.warn\"\n\n    // HTTPInfo ...\n    HTTPInfo = \"%v type=http.info\"\n)\n</code></pre>\n\n<p>And on any package, just import my package and I execute the (Info, Warn, Error) function</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n\n    log \"logging\"\n)\n\nfunc main() {\n    log.Error(log.ConfigError, \"Testing the error\")\n}\n</code></pre>\n\n<p>The log entry will be saved rendered on the screen and it will be saved on a file.</p>\n"}], "owner": {"reputation": 5488, "user_id": 1078890, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Dqula.jpg?s=128&g=1", "display_name": "IamNaN", "link": "https://stackoverflow.com/users/1078890/iamnan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9453, "favorite_count": 3, "accepted_answer_id": 29541867, "answer_count": 4, "score": 11, "last_activity_date": 1557042553, "creation_date": 1428582948, "last_edit_date": 1495541443, "question_id": 29538668, "link": "https://stackoverflow.com/questions/29538668/logging-globally-across-packages", "title": "Logging globally (across packages)", "body": "<p>I have spent a lot of time now searching and reading posts on the subject but have note yet managed to fully get my question answered - or perhaps I just need more clarification on existing answers.</p>\n\n<p>I have read <a href=\"https://stackoverflow.com/questions/18361750/correct-approach-to-global-logging-in-golang\">this</a> post which has the same title as mine, but it's about logging across go routines rather than packages.</p>\n\n<p>What I'm trying to solve is logging across the main app and any packages it uses. I need a logger that can log to multiple locations (which can be done with io.MultiWriter) and can do things like log.Error() and log.Debug()</p>\n\n<p>I know there are packages that do this and I know how to implement those things myself.</p>\n\n<p>What I can't get my head around is how to properly use it with my packages.</p>\n\n<p>One way is of course to create the logger in main and then pass it around to all functions that need logging. But it seems awkward.</p>\n\n<p>My ideal solution would be to have a logger like the built in global logger from the log package, but with the added functionality as above.</p>\n\n<p>I mostly want this for optional debug logging within packages, so I can turn this on in a production version if needed.</p>\n\n<p>What is the proper way to do this?</p>\n"}, {"tags": ["concurrency", "go", "web-crawler", "channel"], "comments": [{"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1428584519, "post_id": 29538470, "comment_id": 47230502, "body": "Removed my comments - I would say refactor it for waitgroups as explained in the answer below - for now."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1428595093, "post_id": 29538470, "comment_id": 47238451, "body": "The problem is that you can&#39;t decrement <code>currentJobs</code> anytime you receive from a worker! My answer on the linked question mentions ways to do it correctly (via a separate &quot;I&#39;ve finished a request&quot; channel, or via a <i>special</i> value on the <code>fromWorkers</code> channel where the suggestions)."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1428595427, "post_id": 29538470, "comment_id": 47238690, "body": "BTW, as mentioned elsewhere here, and on my previous answer, a wait group could be used as well. But in this case it&#39;s effectively just doing simple counting and <i>if</i> you can easily/trivially get the relevant information to a single place (the <code>queue</code> function) it can just count itself without the overhead of a wait group. Wait groups are useful when you need to make the <code>Add</code>, <code>Done</code>, and <code>Wait</code> calls from two or three different goroutines."}, {"owner": {"reputation": 2449, "user_id": 2397318, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/e98da1c8bd5fc26c80a02d99a8fe35f7?s=128&d=identicon&r=PG", "display_name": "meto", "link": "https://stackoverflow.com/users/2397318/meto"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1428667097, "post_id": 29538470, "comment_id": 47271482, "body": "Thanks @DaveC, I see the problem now. So you are saying I should use a <code>chan</code> to receive the signal from a routine that the Job is done (regardless of the fact that more stuff is sent to <code>queue</code>)? Should that be an array of <code>chan</code> (one for each worker)?"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1428686595, "post_id": 29538470, "comment_id": 47283963, "body": "At this point you should be able to identify a solution that fits your specific use case and that you understand well. Possibly that means having the web page fetcher examine the page and <a href=\"https://tour.golang.org/concurrency/9\" rel=\"nofollow noreferrer\">assemble all the &quot;child&quot; links and send them out as a single slice</a> so you only have a single channel send from each worker; then you <i>could</i> use that as a signal the worker is done. Possibly you could wait groups, possibly you could use something else."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1428691443, "post_id": 29538470, "comment_id": 47286546, "body": "E.g. <a href=\"https://gist.github.com/dchapes/1cfb9f304c607e9b185e\" rel=\"nofollow noreferrer\">here is an example full solution</a> to the previously linked <a href=\"https://tour.golang.org/concurrency/9\" rel=\"nofollow noreferrer\">Go Tour excercise</a>."}], "answers": [{"comments": [{"owner": {"reputation": 2449, "user_id": 2397318, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/e98da1c8bd5fc26c80a02d99a8fe35f7?s=128&d=identicon&r=PG", "display_name": "meto", "link": "https://stackoverflow.com/users/2397318/meto"}, "edited": false, "score": 0, "creation_date": 1428586363, "post_id": 29538820, "comment_id": 47231846, "body": "Thanks, this was my first approach. But I still want to use a <code>chan</code> to wait for the code to finish"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 2449, "user_id": 2397318, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/e98da1c8bd5fc26c80a02d99a8fe35f7?s=128&d=identicon&r=PG", "display_name": "meto", "link": "https://stackoverflow.com/users/2397318/meto"}, "edited": false, "score": 0, "creation_date": 1428590501, "post_id": 29538820, "comment_id": 47234984, "body": "@meto, you still need to refactor anyway. Checking for <code>currentJobs == 0</code> is a race, since that condition could be true at anytime during processing."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1428595216, "post_id": 29538820, "comment_id": 47238542, "body": "@JimB, it&#39;s not a race, that variable is only visible and referenced as a local variable. If you refer to my answer on the linked question I mentioned ways of correctly decrementing that are not used in this question. (The idea was to avoid overhead of a wait group)."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1428595835, "post_id": 29538820, "comment_id": 47238949, "body": "@DaveC, sorry, &quot;race&quot; may not have been a good word. It&#39;s a logic problem, a race in a sense, between the sends and receives. There&#39;s no guarantee you&#39;ll get &gt;=1 send for every receive in the select (concurrently actionable select cases are taken at random)"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1428596179, "post_id": 29538820, "comment_id": 47239160, "body": "When done right (not as in this question) it&#39;s not a &quot;logic problem&quot; and is perfectly fine and just as good as a wait group or any other solution. It&#39;s basically taking a wait group that happens to have the <code>Add</code> and <code>Done</code> calls only ever done within a single instance of a single function and turing them into <code>counter++</code> and <code>counter--</code> instead."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1327717"}, "is_accepted": false, "score": 4, "last_activity_date": 1428585013, "last_edit_date": 1428585013, "creation_date": 1428583371, "answer_id": 29538820, "question_id": 29538470, "link": "https://stackoverflow.com/questions/29538470/how-to-use-a-dedicated-channel-to-signal-the-end-of-a-crawl-job-in-go/29538820#29538820", "title": "How to use a dedicated channel to signal the end of a crawl job in go", "body": "<p>Use sync.WaitGroup to wait for all the go routines to end.</p>\n\n<p><a href=\"http://golang.org/pkg/sync/#WaitGroup\" rel=\"nofollow\">http://golang.org/pkg/sync/#WaitGroup</a></p>\n\n<p><a href=\"http://blog.golang.org/pipelines\" rel=\"nofollow\">http://blog.golang.org/pipelines</a></p>\n\n<p>I made a small example here: <a href=\"http://play.golang.org/p/P30LdV0Gfe\" rel=\"nofollow\">http://play.golang.org/p/P30LdV0Gfe</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n    var wg sync.WaitGroup\n    routinesNo := 10\n    wg.Add(routinesNo)\n    for i := 0; i &lt; routinesNo; i++ {\n        go func(n int) {\n            fmt.Printf(\"%d \", n)\n            wg.Done()\n        }(i)\n    }\n    wg.Wait()\n    fmt.Println(\"\\nThe end!\")\n}\n</code></pre>\n"}], "owner": {"reputation": 2449, "user_id": 2397318, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/e98da1c8bd5fc26c80a02d99a8fe35f7?s=128&d=identicon&r=PG", "display_name": "meto", "link": "https://stackoverflow.com/users/2397318/meto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428590367, "creation_date": 1428582387, "last_edit_date": 1495540623, "question_id": 29538470, "link": "https://stackoverflow.com/questions/29538470/how-to-use-a-dedicated-channel-to-signal-the-end-of-a-crawl-job-in-go", "title": "How to use a dedicated channel to signal the end of a crawl job in go", "body": "<p>This is a follow up from <a href=\"https://stackoverflow.com/questions/29491795/webcrawler-in-go\">my previous question</a>.</p>\n\n<p>I am trying to build a prototype for a webcrawler and I want to use a <code>chan</code> to block the execution until all the jobs are done, just as in</p>\n\n<pre><code>func main() {\n    go func() {\n        do_stuff()\n        stop &lt;- true\n   }\n    fmt.Println(&lt;-stop)\n}\n</code></pre>\n\n<p>There is a <code>queue</code> function that dispatch the jobs to the workers. When all jobs are finished, the function will also the channel and send a signal. </p>\n\n<pre><code>type Job int\n\n//simulating a worker that processes a html page and returns some more links\nfunc worker(in chan Job, out chan Job, num int) {\n    for element := range in {\n        if element%2 == 0 {\n            out &lt;- 100*element + 5\n            out &lt;- 100*element + 3\n            out &lt;- 100*element + 1\n        }\n    }\n}\n\nfunc queue(toWorkers chan&lt;- Job, fromWorkers &lt;-chan Job, init Job, stop chan bool) {\n    var list []Job\n    var currentJobs int\n    currentJobs = 0\n    list = append(list, init)\n    done := make(map[Job]bool)\n    for {\n        var send chan&lt;- Job\n        var item Job\n        if len(list) &gt; 0 {\n            send = toWorkers\n            item = list[0]\n        } else if currentJobs == 0 {\n            close(toWorkers)\n            // this messes up everything!\n            stop &lt;- true\n            return\n        }\n\n        select {\n        case send &lt;- item:\n            currentJobs += 1\n            // We sent an item, remove it\n            list = list[1:]\n        case thing := &lt;-fromWorkers:\n            currentJobs -= 1\n            // Got a new thing\n            if !done[thing] {\n                list = append(list, thing)\n                done[thing] = true\n            }\n        }\n    }\n\n}\n\nfunc main() {\n    in := make(chan Job, 1)\n    out := make(chan Job, 1)\n    stop := make(chan bool)\n    // dispatches jobs to workers\n    go queue(in, out, 0, stop)\n    for i := 0; i &lt; max_workers; i++ {\n        go worker(in, out, i)\n    }\n    duration := time.Second\n    time.Sleep(duration)\n    // this cause deadlock\n    fmt.Println(&lt;-stop)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/AKWV31TCZi\" rel=\"nofollow noreferrer\">Link to playground</a></p>\n\n<p>If I understand correctly, the problem is with the <code>stop</code> channel: when the workers still have jobs, go thinks that no one will send to that channel and declares deadlock. The function <code>queue</code> will both close the <code>toWorkers</code> channel and send a signal to <code>stop</code>, but not while there are outstanding jobs. \nWhat am I missing?</p>\n"}, {"tags": ["json", "sorting", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 7, "creation_date": 1428576603, "post_id": 29536345, "comment_id": 47225271, "body": "Maps don&#39;t maintain order, you can&#39;t sort a map. After unmarshalling from JSON, create a slice out of your elements, and you can sort your slice as you want. Look at the <a href=\"http://golang.org/pkg/sort/\" rel=\"nofollow noreferrer\"><code>sort</code></a> package."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 5, "creation_date": 1428577539, "post_id": 29536345, "comment_id": 47225804, "body": "Besides what @icza said, JSON objects are <a href=\"http://www.json.org/\" rel=\"nofollow noreferrer\">defined</a> as an unordered set of name/value pairs. You need an array of objects if you want order."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1428580775, "post_id": 29536345, "comment_id": 47227850, "body": "First convert from <code>map[string]interface{}</code> to something sensible like <code>[]struct{Name string; Pop int, VC int, Temp int}</code>. Then attach the methods of <code>sort.Interface</code> to your struct type and sort with <code>sort.Sort</code>. Sometimes programming helps :-)"}], "answers": [{"tags": [], "owner": {"reputation": 114, "user_id": 2840601, "user_type": "registered", "profile_image": "https://graph.facebook.com/1605469080/picture?type=large", "display_name": "Felix Ribeiro", "link": "https://stackoverflow.com/users/2840601/felix-ribeiro"}, "is_accepted": false, "score": 0, "last_activity_date": 1429200927, "last_edit_date": 1429200927, "creation_date": 1429200564, "answer_id": 29680336, "question_id": 29536345, "link": "https://stackoverflow.com/questions/29536345/how-to-multiple-sort-a-mapstringinterface-type-in-go-lang/29680336#29680336", "title": "How to multiple sort a map[string]interface{} type in go lang?", "body": "<p>I did this function get a result map from N maps and its sorted keys.</p>\n\n<pre><code>func getSortedKeys(maps ...map[string]string) (map[string]string, []string) {\n    var keys []string\n    resultMap := map[string]string{}\n\n    for _, currMap := range maps {\n        for k, v := range currMap {\n            resultMap[k] = v\n            keys = append(keys, k)\n        }\n    }\n    sort.Strings(keys)\n    return resultMap, keys\n\n}\n</code></pre>\n\n<p>Outside the function you can do:</p>\n\n<pre><code>  concatenedMaps, keys := getSortedKeys(map1,map2)\n  for _, k := range keys {\n        value := concatenedMaps[k]\n  }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 0, "last_activity_date": 1429203326, "last_edit_date": 1429203326, "creation_date": 1429201326, "answer_id": 29680619, "question_id": 29536345, "link": "https://stackoverflow.com/questions/29536345/how-to-multiple-sort-a-mapstringinterface-type-in-go-lang/29680619#29680619", "title": "How to multiple sort a map[string]interface{} type in go lang?", "body": "<p>This answer is more about the methodology for solving this problem than a specific solution. I think it's more what you need at this point because you're not close to an actual solution. Here are the simple procedural steps;</p>\n\n<p>1) define a type for this, I'll call it <code>City</code> from here on;</p>\n\n<pre><code>\"TumkurCity\": {\n    \"Population\": 800,\n    \"VehicleCount\": 300,\n    \"Temperature\": 29\n}\n\ntype City struct {\n    Population   int\n    VehicleCount int\n    Temperature  int\n    Name         string\n}\n</code></pre>\n\n<p>2) unmarshal into a <code>map[string]City</code></p>\n\n<p>3) use a method like this to transform the data;</p>\n\n<pre><code>func ToSlice(m map[string]City) []City {\n    cities := make([]City, 0, len(m))\n    for k, v := range m {\n        v.Name = k\n        cities = append(cities, v)\n    }\n    return cities\n}\n</code></pre>\n\n<p>4) define some method to sort the cities however it is you want</p>\n\n<p>I wrote that code in the browser so it hasn't been tested or anything. It should provide a sufficient example of how to handle it. When you unmarshal your City types will have no value for name so you can just assign the key (the cities name) to that later on. put them in a slice or array, sort that. Pretty simple if you follow those steps.</p>\n"}], "owner": {"reputation": 18920, "user_id": 1933917, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7abf55dbb13da076d7a75637f22a74db?s=128&d=identicon&r=PG", "display_name": "Amol M Kulkarni", "link": "https://stackoverflow.com/users/1933917/amol-m-kulkarni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2222, "favorite_count": 1, "accepted_answer_id": 29680619, "answer_count": 2, "score": 0, "last_activity_date": 1429203326, "creation_date": 1428576269, "question_id": 29536345, "link": "https://stackoverflow.com/questions/29536345/how-to-multiple-sort-a-mapstringinterface-type-in-go-lang", "title": "How to multiple sort a map[string]interface{} type in go lang?", "body": "<p><strong>Scenario</strong>: Consider I have a JSON data to be processed in go lang\nNow I am using <code>map[string]interface{}</code> type using package <code>encoding/json</code> by doing <code>marshal/unmarshal</code></p>\n\n<p>Below is the JSON data:</p>\n\n<pre><code>{\n    \"MysoreCity\": {\n        \"Population\": 1000,\n        \"VehicleCount\": 1700,\n        \"Temperature\": 33\n    },\n    \"BangaloreCity\": {\n        \"Population\": 1000,\n        \"VehicleCount\": 3500,\n        \"Temperature\": 33\n    },\n    \"KolarCity\": {\n        \"Population\": 1250,\n        \"VehicleCount\": 3500,\n        \"Temperature\": 31\n    },\n    \"TumkurCity\": {\n        \"Population\": 800,\n        \"VehicleCount\": 300,\n        \"Temperature\": 29\n    }\n}\n</code></pre>\n\n<p>Now I want to perform a multi-sort descending order on the basis of priority, say priority is <code>Temperature</code>, <code>Population</code>, <code>VehicleCount</code> then I want the output to be like </p>\n\n<pre><code>{\n    \"BangaloreCity\": {\n        \"Population\": 1000,\n        \"VehicleCount\": 3500,\n        \"Temperature\": 33\n    },\n    \"MysoreCity\": {\n        \"Population\": 1000,\n        \"VehicleCount\": 1700,\n        \"Temperature\": 33\n    },\n    \"KolarCity\": {\n        \"Population\": 1250,\n        \"VehicleCount\": 3500,\n        \"Temperature\": 31\n    },\n    \"TumkurCity\": {\n        \"Population\": 800,\n        \"VehicleCount\": 300,\n        \"Temperature\": 29\n    }\n}\n</code></pre>\n\n<p>So the sorting with respect to some dynamic set of priorities.</p>\n\n<p><strong>Issue:</strong> I am not getting any clues how to sort it in go lang. I am new to go lang and found something while searching for sorting my data; where it is mentioned as below (source:<a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"nofollow\">link</a>) </p>\n\n<blockquote>\n  <blockquote>\n    <p>When iterating over a map with a range loop, the iteration order is not specified and is not guaranteed to be the same from one iteration to the next.</p>\n  </blockquote>\n</blockquote>\n\n<p><strong>Question:</strong> Could anyone put some light on how to do this kind of sorting with similar JSON data?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1428569077, "post_id": 29533602, "comment_id": 47220528, "body": "Unfortunately this is not possible. The <code>reflect</code> package does not provide a function like <code>TypeByName(name string)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 6, "last_activity_date": 1428572879, "creation_date": 1428572879, "answer_id": 29535131, "question_id": 29533602, "link": "https://stackoverflow.com/questions/29533602/is-there-a-way-to-get-the-type-by-full-name-using-go-reflection/29535131#29535131", "title": "Is there a way to get the Type by full name using Go reflection?", "body": "<p>Not unless you explicitly register the type, like the <a href=\"http://golang.org/pkg/encoding/gob/#Register\"><code>gob</code></a> package does. Something like</p>\n\n<pre><code>// NOTE Should be protected by a mutex.\nvar types map[string]reflect.Type\n\nfunc Register(value interface{}) {\n    t := reflect.TypeOf(value)\n    name := t.PkgPath() + \".\" + t.Name()\n    types[name] = t\n}\n\nfunc TypeByName(name string) reflect.Type {\n    return types[name]\n}\n</code></pre>\n"}], "owner": {"reputation": 6881, "user_id": 1052922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4bf2f8cc6f4dc4dac32fdd12702134e6?s=128&d=identicon&r=PG", "display_name": "woodings", "link": "https://stackoverflow.com/users/1052922/woodings"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 29535131, "answer_count": 1, "score": 2, "last_activity_date": 1428827901, "creation_date": 1428568452, "last_edit_date": 1428827901, "question_id": 29533602, "link": "https://stackoverflow.com/questions/29533602/is-there-a-way-to-get-the-type-by-full-name-using-go-reflection", "title": "Is there a way to get the Type by full name using Go reflection?", "body": "<p>In Java, it can be done by <code>Class.forName(\"com.my_pkg_name.MyClass\")</code> which returns the class type.</p>\n\n<p>It seems Go reflection can only find the Type by Value but doesn't allow name to Type. This capability can be very helpful when implementing a scripting language interpreter which interops with Go code.</p>\n"}]