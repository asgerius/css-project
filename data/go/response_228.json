[{"tags": ["go", "amazon-route53"], "comments": [{"owner": {"reputation": 938, "user_id": 4192486, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5Rj0W.png?s=128&g=1", "display_name": "buildmaestro", "link": "https://stackoverflow.com/users/4192486/buildmaestro"}, "edited": false, "score": 0, "creation_date": 1558560598, "post_id": 56265102, "comment_id": 99146875, "body": "I&#39;m starting to think I&#39;ll need to first read the record set values, create a new record, then delete the old record.  It&#39;s not as simple as aws console just clicking the pen icon and typing a new name :("}, {"owner": {"reputation": 938, "user_id": 4192486, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5Rj0W.png?s=128&g=1", "display_name": "buildmaestro", "link": "https://stackoverflow.com/users/4192486/buildmaestro"}, "edited": false, "score": 0, "creation_date": 1562086979, "post_id": 56265102, "comment_id": 100264359, "body": "Yes, that&#39;s the approach I went with to rename a route53 record: 1) Create new record, 2) Delete old record."}], "owner": {"reputation": 938, "user_id": 4192486, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5Rj0W.png?s=128&g=1", "display_name": "buildmaestro", "link": "https://stackoverflow.com/users/4192486/buildmaestro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558592069, "creation_date": 1558559603, "last_edit_date": 1558592069, "question_id": 56265102, "link": "https://stackoverflow.com/questions/56265102/upsert-name-in-changeresourcerecordsets", "title": "Upsert Name in ChangeResourceRecordSets", "body": "<p>Forgive me, but I was not able to find this question addressed in 20 mins of googling so I thought I'd ask.  I have bunch of route53 cname and A records that need the name changed on them:</p>\n\n<pre><code>cname record:\naaa.xxx.xxx.xxx.com becomes bbb.xxx.xxx.xxx.com\nA record:\ninternal-alb-aaa.xxx.xxx.xxx.com becomes internal-alb-bbb.xxx.xxx.xxx.com\n</code></pre>\n\n<p>I believe this needs to be done with the following api call, but it appears to me the Name: field acts as a sort of primary key so it wouldn't be possible to rename it.</p>\n\n<p>Am I using the correct approach or is this possible another way?</p>\n\n<pre><code>svc := route53.New(session.New())\n    input := &amp;route53.ChangeResourceRecordSetsInput{\n        ChangeBatch: &amp;route53.ChangeBatch{\n            Changes: []*route53.Change{\n                {\n                    Action: aws.String(\"UPSERT\"),\n                    ResourceRecordSet: &amp;route53.ResourceRecordSet{\n                        },\n                        Name:          aws.String(\"example.com\"),\n                        Region:        aws.String(\"us-east-2\"),\n                        SetIdentifier: aws.String(\"Ohio region\"),\n                        Type:          aws.String(\"A\"),\n                    },\n                },\n            },\n            Comment: aws.String(\"ELB load balancers for example.com\"),\n        },\n        HostedZoneId: aws.String(\"Z3M3LMPEXAMPLE\"),\n    }\n\n    result, err := svc.ChangeResourceRecordSets(input)\n</code></pre>\n"}, {"tags": ["function", "go", "cloud"], "comments": [{"owner": {"reputation": 675, "user_id": 11293192, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-u__URQxTfno/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reYwTSH-V3nkPCiiadXr5_Y1VESXA/mo/photo.jpg?sz=128", "display_name": "Jaroslav", "link": "https://stackoverflow.com/users/11293192/jaroslav"}, "edited": false, "score": 0, "creation_date": 1559897952, "post_id": 56265010, "comment_id": 99571215, "body": "This question was discussed many times, please look at this[1] thread, some users stated they found a workaround[2] when using Go modules.     [1]: <a href=\"https://github.com/golang/go/issues/26145\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/26145</a>   [2]: <a href=\"https://github.com/golang/go/issues/27254\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/27254</a>"}], "answers": [{"tags": [], "owner": {"reputation": 344, "user_id": 3988440, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rqm7E.jpg?s=128&g=1", "display_name": "Wyatt Shuler", "link": "https://stackoverflow.com/users/3988440/wyatt-shuler"}, "is_accepted": false, "score": 0, "last_activity_date": 1558563805, "creation_date": 1558563805, "answer_id": 56265746, "question_id": 56265010, "link": "https://stackoverflow.com/questions/56265010/cloud-function-deployment-issue/56265746#56265746", "title": "Cloud function deployment issue", "body": "<p>You might want to create a personal access token within Github and then configure git to use that token.</p>\n\n<p>That command would look like this:</p>\n\n<pre><code>git config --global url.\"https://{YOUR TOKEN}:x-oauth-basic@github.com/\".insteadOf \"https://github.com/\"\n</code></pre>\n\n<p>After that, git should be able to read from your private repo</p>\n"}, {"tags": [], "owner": {"reputation": 1510, "user_id": 6476791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55d5de71330e6307063fdb6dde80d7ca?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/6476791/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1559938042, "creation_date": 1559938042, "answer_id": 56500656, "question_id": 56265010, "link": "https://stackoverflow.com/questions/56265010/cloud-function-deployment-issue/56500656#56500656", "title": "Cloud function deployment issue", "body": "<p>How about using endly to automate your cloud function build, in this case you would \nuse go mod with vendor, where you private repo would be added to vendor folder, \nMake sure that you add .gcloudignore to not incliude go.mod, go.sum</p>\n\n<p>@.gcloudignore</p>\n\n<pre><code>go.mod\ngo.sum\n</code></pre>\n\n<p>The automation workflow with endly that uses private repo with credentials may look like the following</p>\n\n<p>@deploy.yaml</p>\n\n<pre><code>init:\n  appPath: $WorkingDirectory(.)\n  target:\n    URL: ssh://127.0.0.1/\n    credentials: localhost\n  myGitSecret: ${secrets.private-git}\npipeline:\n  secretInfo:\n    action: print\n    comments: print git credentials (debuging only_\n    message: $AsJSON($myGitSecret)\n\n  package:\n    action: exec:run\n    comments: vendor build for deployment speedup\n    target: $target\n    checkError: true\n    terminators:\n      - Password\n      - Username\n    secrets:\n      #secret var alias:  secret file i.e ~/.secret/private-git.json\n      gitSecrets: private-git\n    commands:\n      - export GIT_TERMINAL_PROMPT=1\n      - export GO111MODULE=on\n      - unset GOPATH\n      - cd ${appPath}/\n      - go mod vendor\n      - '${cmd[3].stdout}:/Username/? $gitSecrets.Username'\n      - '${output}:/Password/? $gitSecrets.Password'\n\n  deploy:\n    action: gcp/cloudfunctions:deploy\n    '@name': MyFn\n    timeout: 540s\n    availableMemoryMb: 2048\n    entryPoint: MyFn\n    runtime: go111\n    eventTrigger:\n      eventType: google.storage.object.finalize\n      resource: projects/_/buckets/${matcherConfig.Bucket}\n    source:\n      URL: ${appPath}/\n</code></pre>\n\n<p>Finally check out <a href=\"https://github.com/adrianwit/serverless_e2e/tree/master/cloud_function\" rel=\"nofollow noreferrer\">cloud function</a> e2e testing and deployment automation </p>\n"}], "owner": {"reputation": 19, "user_id": 9706983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55bd551c8d53298c0cc98fc0de6f3697?s=128&d=identicon&r=PG&f=1", "display_name": "terry.zhao", "link": "https://stackoverflow.com/users/9706983/terry-zhao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 209, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1559938042, "creation_date": 1558559094, "question_id": 56265010, "link": "https://stackoverflow.com/questions/56265010/cloud-function-deployment-issue", "title": "Cloud function deployment issue", "body": "<p>When I deploy cloud function I get the following error.</p>\n\n<p>I am using go mod and I am able to build and run all the integration test from my sandbox, </p>\n\n<p>One of the cloud function dependency uses private github repo, </p>\n\n<p>When I deploy cloud function\ngo: github.com/myrepo/ptrie@v0.1.: git fetch -f origin refs/heads/<em>:refs/heads/</em> refs/tags/<em>:refs/tags/</em> in /builder/pkg/mod/cache/vcs/41e03711c0ecff6d0de8588fa6de21a2c351c59fd4b0a1b685eaaa5868c5892e: exit status 128:\n  fatal: could not read Username for '<a href=\"https://github.com\" rel=\"nofollow noreferrer\">https://github.com</a>': terminal prompts disabled</p>\n"}, {"tags": ["go", "go-gorm", "go-echo"], "answers": [{"tags": [], "owner": {"reputation": 791, "user_id": 3529908, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/684156fa87f3a84dc9f899a476e07e20?s=128&d=identicon&r=PG&f=1", "display_name": "C0ol_Cod3r", "link": "https://stackoverflow.com/users/3529908/c0ol-cod3r"}, "is_accepted": true, "score": 0, "last_activity_date": 1558557008, "creation_date": 1558557008, "answer_id": 56264569, "question_id": 56263356, "link": "https://stackoverflow.com/questions/56263356/gorm-count-on-preloaded-field/56264569#56264569", "title": "Gorm Count On Preloaded Field", "body": "<p>I have built this Raw SQL query,</p>\n\n<pre><code>dbConn().\n    Raw(\"SELECT p.*, count(i.id) as invoice_count FROM profiles p left join invoices i on i.profile_fk = p.id group by p.id\").\n    Scan(&amp;result)\n</code></pre>\n"}], "owner": {"reputation": 791, "user_id": 3529908, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/684156fa87f3a84dc9f899a476e07e20?s=128&d=identicon&r=PG&f=1", "display_name": "C0ol_Cod3r", "link": "https://stackoverflow.com/users/3529908/c0ol-cod3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 515, "favorite_count": 0, "accepted_answer_id": 56264569, "answer_count": 1, "score": 0, "last_activity_date": 1558557008, "creation_date": 1558551767, "question_id": 56263356, "link": "https://stackoverflow.com/questions/56263356/gorm-count-on-preloaded-field", "title": "Gorm Count On Preloaded Field", "body": "<p>I am using Postgres with Go Lang &amp; the Echo framework as my base, with that I am using Gorm to build my database queries. </p>\n\n<p>So Here is my Profile Model,</p>\n\n<pre><code>type Profile struct {\n  gorm.Model\n  InvoiceCount     uint      `gorm:\"-\"`\n  CompanyName      string    `gorm:\"size:255\"`\n  CompanyNumber    string    `gorm:\"size:10\"`\n  CompanyVatNumber string    `gorm:\"size:10\"`\n  DateAdded        time.Time `gorm:\"type:date\"`\n  PrimaryEmail     string    `gorm:\"size:255\"`\n  IsActive         bool\n  Invoice []*Invoice `gorm:\"foreignkey:profile_fk\" json:\",omitempty\"`\n  Address []*Address `gorm:\"foreignkey:profile_fk\" json:\",omitempty\"`\n} \n</code></pre>\n\n<p>This is linked into my Invoice model, which I am trying to do a count with on a preload. I added the <code>InvoiceCount</code> uint has a means of adding the count into this model.</p>\n\n<p>So this is what I have tied,</p>\n\n<pre><code>dbCon().\n  Preload(\"Invoice\", func(db *gorm.DB) *gorm.DB {   \n    return db.Count(&amp;profile)\n  }).\n  Find(&amp;profile).\n  RecordNotFound()\n</code></pre>\n\n<p>However, I apart from this not working, it returns the following error: <code>(pq: zero-length delimited identifier at or near \"\"\"\")</code>. </p>\n\n<p>I am trying to do this with a simple query, but this that wrong? Do I need to just loop around all my profiles and add a count to each? Or drop down to a raw SQL query with a sub select?</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 416, "user_id": 11529593, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nMOHrxOg4nQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfeI-u5UbYJIejKaTCqDSluZAyBDw/mo/photo.jpg?sz=128", "display_name": "Wombologist", "link": "https://stackoverflow.com/users/11529593/wombologist"}, "is_accepted": false, "score": 1, "last_activity_date": 1558549570, "creation_date": 1558549570, "answer_id": 56262883, "question_id": 56262723, "link": "https://stackoverflow.com/questions/56262723/defining-function-inside-of-function/56262883#56262883", "title": "defining function inside of function", "body": "<p>In this context, there is no functional difference between the two functions. As you noticed, local functions have access to local variables without explicitly passing them. In your example you might prefer to use generate1 for easier reading.</p>\n"}, {"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 6, "last_activity_date": 1558549994, "last_edit_date": 1558549994, "creation_date": 1558549654, "answer_id": 56262902, "question_id": 56262723, "link": "https://stackoverflow.com/questions/56262723/defining-function-inside-of-function/56262902#56262902", "title": "defining function inside of function", "body": "<blockquote>\n  <p>When defining a inner function which utilizes the variables of outer scope, should I pass the variables to the inner function as parameters?</p>\n</blockquote>\n\n<p>It depends on what you want to achieve.</p>\n\n<p>What you call \"a function inside a function\" is actually called \"a closure\" (and some people call it \"lambda\").</p>\n\n<p>Closures capture variables from the outer lexical scope, referenced in its body. In Go, this capturing is done \"by reference\" or \"by name\" which basically means each time a closure is called it will \"see\" <em>current</em> values of the variables it closes over, not the values these variables had at the time the closure was created\u2014observe that the program:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    i := 42\n\n    fn := func() {\n      fmt.Println(i)\n    }\n\n    fn()\n    i = 12\n    fn()\n}\n</code></pre>\n\n<p>would output</p>\n\n<pre><code>42\n12\n</code></pre>\n\n<p>Conversely, when you pass values as arguments to calls to a closure, each call will see exactly the values passed to it.</p>\n\n<p>I hope you now see that what strategy to pick largely depends on what you want.</p>\n\n<p>Conceptually, you may think of a closure as being an instance of an ad-hoc anonymous <code>struct</code> data type, the fields of which are pointers to the variables the closure closes over, and each call to that closure being analogous to calling some (anonymous, sole) method provided by that type (actually, that's what the compiler usually does behind your back to implement a closure).\nSuch \"method\" may have arguments, and whether it should have them, and what should go to the type's fields and what should be that method's arguments can be judged using the usual approach you employ with regular types.</p>\n"}], "owner": {"reputation": 759, "user_id": 3942851, "user_type": "registered", "accept_rate": 47, "profile_image": "https://lh4.googleusercontent.com/-nIkq4wdsg6g/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMtFLuG4ftgrUKJVYOo8SEwFsosuQ/mo/photo.jpg?sz=128", "display_name": "sfdcnoob", "link": "https://stackoverflow.com/users/3942851/sfdcnoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 56262902, "answer_count": 2, "score": 1, "last_activity_date": 1558549994, "creation_date": 1558548889, "question_id": 56262723, "link": "https://stackoverflow.com/questions/56262723/defining-function-inside-of-function", "title": "defining function inside of function", "body": "<p>When defining a inner function which utilizes the variables of outer scope, should I pass the variables to the inner function as parameters?</p>\n\n<p>In my example, generate and generate2 both give me same result, is there a reason I should choose any one of them?</p>\n\n<p>The code picks key 1 to generate combinations with key 3,4,5,\nthen picks key 2 to generate combinations with key 3,4,5.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n\n    src := map[int][]string{\n        1: []string{\"1\", \"11\", \"111\"},\n        2: []string{\"2\", \"22\"},\n        3: []string{\"3\"},\n        4: []string{\"4\"},\n        5: []string{\"5\", \"55\"},\n    }\n\n    result2 := generate2(src)\n\n    fmt.Println(result2)\n\n    result := generate(src)\n\n    fmt.Println(result)\n\n}\n\nfunc generate(src map[int][]string) []string {\n    var combo []string\n    var add = func(f []string) {\n        for _, v := range f {\n\n            for _, p := range src[3] {\n                for _, q := range src[4] {\n                    for _, r := range src[5] {\n                        combo = append(combo, v+p+q+r)\n                    }\n                }\n            }\n\n        }\n    }\n\n    add(src[1])\n    add(src[2])\n    return combo\n}\n\nfunc generate2(src map[int][]string) []string {\n    var combo []string\n    var add = func(f []string, combo []string, src map[int][]string) []string {\n        for _, v := range f {\n            for _, p := range src[3] {\n                for _, q := range src[4] {\n                    for _, r := range src[5] {\n                        combo = append(combo, v+p+q+r)\n                    }\n                }\n            }\n        }\n        return combo\n    }\n\n    combo = add(src[1], combo, src)\n    combo = add(src[2], combo, src)\n    return combo\n}\n</code></pre>\n"}, {"tags": ["go", "channel"], "comments": [{"owner": {"reputation": 129, "user_id": 8172405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IAC7D.jpg?s=128&g=1", "display_name": "Sergey Ovodov", "link": "https://stackoverflow.com/users/8172405/sergey-ovodov"}, "edited": false, "score": 1, "creation_date": 1558543752, "post_id": 56261497, "comment_id": 99139652, "body": "Maybe this article will be helpful - <a href=\"https://medium.com/rungo/anatomy-of-channels-in-go-concurrency-in-go-1ec336086adb\" rel=\"nofollow noreferrer\">medium.com/rungo/&hellip;</a>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1558547839, "post_id": 56261497, "comment_id": 99141390, "body": "&quot;how do we figure out readyness of sender and receiver&quot; - you don&#39;t. You write code that doesn&#39;t care about their readiness (which is basically the purpose of channels, asynchronous message passing). Your first code deadlocks because it&#39;s trying to do asynchronous message-passing synchronously, the second works because it&#39;s sending and receiving concurrently."}], "answers": [{"tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 1, "last_activity_date": 1558543611, "creation_date": 1558543611, "answer_id": 56261575, "question_id": 56261497, "link": "https://stackoverflow.com/questions/56261497/go-channel-readyness/56261575#56261575", "title": "Go channel readyness", "body": "<p>Let's step through the first program:</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>// My notes here\nch := make(chan int)  // make a new int channel\nch &lt;- 1               // block until we can send to that channel\n                      // keep blocking\n                      // keep blocking\n                      // still waiting for a receiver\n                      // no reason to stop blocking yet...\n\n// this line is never reached, because it blocks above forever.\nfmt.Println(&lt;-ch)\n</code></pre>\n\n<p>The second program splits the send off into its own line of execution, so now we have:</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>ch := make(chan int)  // make a new int channel\n\ngo func () {          // start a new line of execution\n    ch &lt;- 1           // block this second execution thread until we can send to that channel\n}()\n\nfmt.Println(&lt;-ch)     // block the main line of execution until we can read from that channel\n</code></pre>\n\n<p>Since those two lines of execution can work independently, the main line can get down to <code>fmt.Println</code> and try and receive from the channel. The second thread will wait to send until it has.</p>\n"}, {"tags": [], "owner": {"reputation": 416, "user_id": 11529593, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nMOHrxOg4nQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfeI-u5UbYJIejKaTCqDSluZAyBDw/mo/photo.jpg?sz=128", "display_name": "Wombologist", "link": "https://stackoverflow.com/users/11529593/wombologist"}, "is_accepted": false, "score": 1, "last_activity_date": 1558543660, "creation_date": 1558543660, "answer_id": 56261586, "question_id": 56261497, "link": "https://stackoverflow.com/questions/56261497/go-channel-readyness/56261586#56261586", "title": "Go channel readyness", "body": "<p>The go routine absolutely makes a difference. The go routine that writes to the channel will be blocked until your main function is ready to read from the channel in the print statement. Having two concurrent threads, one that reads and one that writes fulfills the readiness on both sides.</p>\n\n<p>In your first example, the single thread gets blocked by the channel write statement and will never reach the channel read.</p>\n\n<p>You need to have a concurrent go routine to read from a channel whenever you write to it. Concurrency goes hand-in-hand with channel usage.</p>\n"}], "owner": {"reputation": 705, "user_id": 3327209, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Zf6KK.jpg?s=128&g=1", "display_name": "Abhishek Jha", "link": "https://stackoverflow.com/users/3327209/abhishek-jha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 56261575, "answer_count": 2, "score": -4, "last_activity_date": 1558543660, "creation_date": 1558543258, "question_id": 56261497, "link": "https://stackoverflow.com/questions/56261497/go-channel-readyness", "title": "Go channel readyness", "body": "<p>I am trying to understand channels in Go. I have read that by default sends and receives block until both the sender and receiver are ready. But how do we figure out readyness of sender and receiver.</p>\n\n<p>For example in the following code</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    ch := make(chan int)\n    ch &lt;- 1\n\n    fmt.Println(&lt;-ch)\n}\n</code></pre>\n\n<p>The program will get stuck on the channel send operation waiting forever for someone to read the value. Even though we have a receive operation in println statement it ends up in a deadlock.</p>\n\n<p>But for the following program</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    ch := make(chan int)\n\n    go func () {\n        ch &lt;- 1\n    }()\n\n    fmt.Println(&lt;-ch)\n}\n</code></pre>\n\n<p>The integer is passed successfully from go routine to main program. What made this program work? Why second works but first do not? Is go routine causing some difference? </p>\n"}, {"tags": ["go", "goconvey"], "comments": [{"owner": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "edited": false, "score": 0, "creation_date": 1558562849, "post_id": 56260619, "comment_id": 99147504, "body": "Have you tried to run the unit test manually with <code>go test -v</code>? In theory it should pass."}, {"owner": {"reputation": 1515, "user_id": 1516001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6d465bb8df6bda89904c7aafea0dda6c?s=128&d=identicon&r=PG", "display_name": "Donald French", "link": "https://stackoverflow.com/users/1516001/donald-french"}, "reply_to_user": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "edited": false, "score": 0, "creation_date": 1558569541, "post_id": 56260619, "comment_id": 99148905, "body": "Fails also with: panic: Top-level calls to Convey(...) need a reference to the <i>testing.T. \t\tHint: Convey(&quot;description here&quot;, t, func() { /</i> notice that the second  argument was the *testing.T (t)! */ })   I think it is set they way stated in the hint."}, {"owner": {"reputation": 2716, "user_id": 1087692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/143e0e17fa2f09f8bd0ba9154bc555e2?s=128&d=identicon&r=PG", "display_name": "tzachs", "link": "https://stackoverflow.com/users/1087692/tzachs"}, "edited": false, "score": 0, "creation_date": 1558630711, "post_id": 56260619, "comment_id": 99173753, "body": "Looks like you&#39;re missing the <code>t</code> in the second and third convey, you only have it in the first convey."}, {"owner": {"reputation": 1515, "user_id": 1516001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6d465bb8df6bda89904c7aafea0dda6c?s=128&d=identicon&r=PG", "display_name": "Donald French", "link": "https://stackoverflow.com/users/1516001/donald-french"}, "edited": false, "score": 1, "creation_date": 1558641655, "post_id": 56260619, "comment_id": 99178267, "body": "According to the docs, it only belongs in the first. However, I made the change and it still failed.  The simple test fails here and works when inserted into another old app with Convey."}], "answers": [{"tags": [], "owner": {"reputation": 3020, "user_id": 1264920, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6401cada72e3e86775c409db49e6befb?s=128&d=identicon&r=PG", "display_name": "TPPZ", "link": "https://stackoverflow.com/users/1264920/tppz"}, "is_accepted": false, "score": 0, "last_activity_date": 1562590213, "creation_date": 1562590213, "answer_id": 56935354, "question_id": 56260619, "link": "https://stackoverflow.com/questions/56260619/convey-fail-on-simple-test/56935354#56935354", "title": "Convey fail on simple test", "body": "<p>It may be related to your version of Go combined with your (outdated) version of Go Convey and some of its dependencies. Perhaps you had some dependencies already in your <code>$GOPATH/src</code> and now you updated to Go version 1.12.*? </p>\n\n<p>This happened to me when updating from Go version 1.10 to Go version 1.12.6, I've followed the details in here and this helped me fixing my environment: <a href=\"https://github.com/smartystreets/goconvey/issues/561#issuecomment-505525085\" rel=\"nofollow noreferrer\">https://github.com/smartystreets/goconvey/issues/561#issuecomment-505525085</a></p>\n\n<p>These are the steps I followed:</p>\n\n<ul>\n<li><code>cd $GOPATH/src/github.com/smartystreets/goconvey/ &amp;&amp; git checkout master &amp;&amp; git pull</code>\n\n<ul>\n<li>this should be equivalent to: <code>go get github.com/smartystreets/goconvey</code></li>\n</ul></li>\n<li><code>cd $GOPATH/src/github.com/smartystreets/assertions/ &amp;&amp; git checkout master &amp;&amp; git pull</code>\n\n<ul>\n<li>this should be equivalent to: <code>go get github.com/smartystreets/assertions</code></li>\n</ul></li>\n<li><code>go get -u golang.org/x/tools...</code></li>\n<li><code>cd $GOPATH/src/github.com/jtolds/gls/ &amp;&amp; git checkout master &amp;&amp; git pull</code>\n\n<ul>\n<li>this should be equivalent to: <code>go get github.com/jtolds/gls</code></li>\n</ul></li>\n</ul>\n"}], "owner": {"reputation": 1515, "user_id": 1516001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6d465bb8df6bda89904c7aafea0dda6c?s=128&d=identicon&r=PG", "display_name": "Donald French", "link": "https://stackoverflow.com/users/1516001/donald-french"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 326, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1562590213, "creation_date": 1558539985, "last_edit_date": 1558574421, "question_id": 56260619, "link": "https://stackoverflow.com/questions/56260619/convey-fail-on-simple-test", "title": "Convey fail on simple test", "body": "<p>I am attempting to use Convey for the first time. My real test fails for an unknown reason, so I created this very simple test and it fails the same way.</p>\n\n<pre><code>   GO Convey\nfunc TestSimple(t *testing.T) {\n    Convey(\"Given Simple Test\", t, func() {\n        Convey(\"When Tested\", func() {\n            Convey(\"There should be a result\", func() {\n                i := 1\n                So(i, ShouldEqual, i)\n            })\n        })\n    })\n}\n</code></pre>\n\n<p>I am probably doing something wrong, however I'm at a loss</p>\n\n<p>UPDATE:  I found an old Convey test in another app that works.  I copied the simple test to it and ran tests. it works.  </p>\n\n<p>Is there something that is possibly configured wrong? It is the same server and go setup. </p>\n\n<p><a href=\"https://i.stack.imgur.com/MlKaK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MlKaK.png\" alt=\"Screen shot of test\"></a></p>\n"}, {"tags": ["pointers", "go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 2760, "user_id": 2639188, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c1a58be9b3e79cc22a37cad79a992438?s=128&d=identicon&r=PG", "display_name": "DoIt", "link": "https://stackoverflow.com/users/2639188/doit"}, "edited": false, "score": 0, "creation_date": 1558543066, "post_id": 56260756, "comment_id": 99139364, "body": "Looks good but the field may not be a string always, say for example I have an int64 in my values and I cannot convert into a string. DO you suggest using reflection to do so?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 2760, "user_id": 2639188, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c1a58be9b3e79cc22a37cad79a992438?s=128&d=identicon&r=PG", "display_name": "DoIt", "link": "https://stackoverflow.com/users/2639188/doit"}, "edited": false, "score": 0, "creation_date": 1558543169, "post_id": 56260756, "comment_id": 99139413, "body": "@DoIt No need to bring in reflection, where a simple <a href=\"https://tour.golang.org/methods/16\" rel=\"nofollow noreferrer\">type switch</a> will suffice."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1558547976, "post_id": 56260756, "comment_id": 99141454, "body": "A simple type switch will not suffice if there are a large number of possible types to handle."}, {"owner": {"reputation": 2760, "user_id": 2639188, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c1a58be9b3e79cc22a37cad79a992438?s=128&d=identicon&r=PG", "display_name": "DoIt", "link": "https://stackoverflow.com/users/2639188/doit"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1558548261, "post_id": 56260756, "comment_id": 99141567, "body": "@Adrian Thats a problem. Any better idea?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1558548447, "post_id": 56260756, "comment_id": 99141650, "body": "If there are too many types to realistically use a type switch, you&#39;d need to apply reflection."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 2, "last_activity_date": 1558540463, "creation_date": 1558540463, "answer_id": 56260756, "question_id": 56260546, "link": "https://stackoverflow.com/questions/56260546/unable-to-retain-values-of-golang-fields-when-its-returned-to-the-caller-of-the/56260756#56260756", "title": "Unable to retain values of golang fields when its returned to the caller of the function", "body": "<blockquote>\n  <p>Is there anything wrong with the above code?</p>\n</blockquote>\n\n<p>Yes. You're discarding the pointers and are simply overwriting them with new values. To set value that pointer points to, you must dereference it. Could look something like this in your case:</p>\n\n<pre><code>for i, s := range source {\n    str, ok := dest[i].(*string)\n    if ok {\n      *str = s.(string)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2760, "user_id": 2639188, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c1a58be9b3e79cc22a37cad79a992438?s=128&d=identicon&r=PG", "display_name": "DoIt", "link": "https://stackoverflow.com/users/2639188/doit"}, "is_accepted": true, "score": 1, "last_activity_date": 1558551531, "creation_date": 1558551531, "answer_id": 56263317, "question_id": 56260546, "link": "https://stackoverflow.com/questions/56260546/unable-to-retain-values-of-golang-fields-when-its-returned-to-the-caller-of-the/56263317#56263317", "title": "Unable to retain values of golang fields when its returned to the caller of the function", "body": "<p>This one takes care of all types </p>\n\n<pre><code>for i, s := range source {\n        so := reflect.ValueOf(s)\n        if !reflect.DeepEqual(so, reflect.Zero(reflect.TypeOf(so)).Interface()) {\n            reflect.ValueOf(dest[i]).Elem().Set(so)\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 2760, "user_id": 2639188, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c1a58be9b3e79cc22a37cad79a992438?s=128&d=identicon&r=PG", "display_name": "DoIt", "link": "https://stackoverflow.com/users/2639188/doit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 56263317, "answer_count": 2, "score": -2, "last_activity_date": 1558551531, "creation_date": 1558539764, "question_id": 56260546, "link": "https://stackoverflow.com/questions/56260546/unable-to-retain-values-of-golang-fields-when-its-returned-to-the-caller-of-the", "title": "Unable to retain values of golang fields when its returned to the caller of the function", "body": "<p>I have a function which accepts slice of values and fields as a set of optional parameters and the function maps each value to a field and returns error if any to the caller as in below</p>\n\n<pre><code>func Unmarshall(source []interface{}, dest ...interface{}) error {\n    if len(source) != len(dest) {\n        return errors.New(\"source and destination doesn't match\")\n    }\n\n    for i, s := range source {\n        dest[i] = s\n    }\n    return nil\n}\n</code></pre>\n\n<p>and below the code I have for the caller</p>\n\n<pre><code>for _, r := range rows.Values {\n        item := entity.Item{}\n        e :=Unmarshall(r,\n            &amp;item.Name,\n            &amp;item.Description,          \n            &amp;item.AddedUTCDatetime,\n            &amp;item.ModifiedUTCDatetime)\n\n        if e == nil {           \n            items = append(items, item)\n        }\n    }\n</code></pre>\n\n<p>But the issue with the above is <code>item.Name,item.Description,                &amp;item.AddedUTCDatetime, &amp;item.ModifiedUTCDatetime</code> doesn't retain the values set in the <code>Unmarshall func</code> even though I passed in the pointer to the fields.</p>\n\n<p><strong>Is there anything wrong with the above code?</strong></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1558548031, "post_id": 56260391, "comment_id": 99141472, "body": "Please take the <a href=\"https://tour.goland.org/\" rel=\"nofollow noreferrer\">Tour of Go</a>. It will answer any questions about basic syntax and language features."}], "answers": [{"comments": [{"owner": {"reputation": 90, "user_id": 10666991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a8ed2aa590dc61c12f19caaa731db61?s=128&d=identicon&r=PG&f=1", "display_name": "Ofir", "link": "https://stackoverflow.com/users/10666991/ofir"}, "edited": false, "score": 0, "creation_date": 1558539720, "post_id": 56260484, "comment_id": 99137591, "body": "I want to instance an object and then call to PrintStr() on this object. How can I achieve this? I don&#39;t see the public function. Thanks."}], "tags": [], "owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "is_accepted": true, "score": 2, "last_activity_date": 1558539587, "creation_date": 1558539587, "answer_id": 56260484, "question_id": 56260391, "link": "https://stackoverflow.com/questions/56260391/doesnt-see-public-functions-of-a-struct-golang/56260484#56260484", "title": "Doesn&#39;t see public functions of a struct Golang", "body": "<p>That is not a method, it is just a function.</p>\n\n<p>Import DataStorage (you should make it lower case) then you can call DataStorage.PrintStr()</p>\n"}, {"tags": [], "owner": {"reputation": 336, "user_id": 976718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d92bb4f0aded45d1bd177eff37e080e?s=128&d=identicon&r=PG", "display_name": "burythehammer", "link": "https://stackoverflow.com/users/976718/burythehammer"}, "is_accepted": false, "score": 0, "last_activity_date": 1558540111, "creation_date": 1558540111, "answer_id": 56260662, "question_id": 56260391, "link": "https://stackoverflow.com/questions/56260391/doesnt-see-public-functions-of-a-struct-golang/56260662#56260662", "title": "Doesn&#39;t see public functions of a struct Golang", "body": "<p>I had a play around myself with this, and there are a few things to be careful of:</p>\n\n<ol>\n<li><p>Make sure you import the package properly with respect to your GOPATH, e.g.</p>\n\n<p>import \"github.com/some-repo/datastorage\"</p></li>\n</ol>\n\n<p>And ensure that your packages/repos are in your GOPATH and in the correct directories (go is very fussy about how you do this)</p>\n\n<ol start=\"2\">\n<li><p>Refer to your function using the package name like so:</p>\n\n<p>func main(){\n    DataStorage.PrintStr()\n}</p></li>\n</ol>\n\n<p>The other poster is correct in that go conventions are to keep package names in lowercase.</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 10494141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/117165d197dbf5ce4d27803630326c2d?s=128&d=identicon&r=PG&f=1", "display_name": "FXZ", "link": "https://stackoverflow.com/users/10494141/fxz"}, "is_accepted": false, "score": 0, "last_activity_date": 1558595200, "creation_date": 1558595200, "answer_id": 56269770, "question_id": 56260391, "link": "https://stackoverflow.com/questions/56260391/doesnt-see-public-functions-of-a-struct-golang/56269770#56269770", "title": "Doesn&#39;t see public functions of a struct Golang", "body": "<p>Seems you dont have the concept of method receiver yet. Your method for the struct should be defined as below :</p>\n\n<pre><code>func (this DataSaver)PrintStr() {\n   fmt.Println(\"hello\")\n}\n\n</code></pre>\n\n<p>or </p>\n\n<pre><code>func (this *DataSaver)PrintStr() {\n   fmt.Println(\"hello\")\n}\n</code></pre>\n\n<p>which one you choose depends on you want to call the method on a pointer or not;</p>\n"}], "owner": {"reputation": 90, "user_id": 10666991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a8ed2aa590dc61c12f19caaa731db61?s=128&d=identicon&r=PG&f=1", "display_name": "Ofir", "link": "https://stackoverflow.com/users/10666991/ofir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 287, "favorite_count": 0, "accepted_answer_id": 56260484, "answer_count": 3, "score": -4, "last_activity_date": 1558595200, "creation_date": 1558539219, "question_id": 56260391, "link": "https://stackoverflow.com/questions/56260391/doesnt-see-public-functions-of-a-struct-golang", "title": "Doesn&#39;t see public functions of a struct Golang", "body": "<p>I don't see the public method of the struct that I defined. \nCan someone please let me understand why? \nHere is the code: </p>\n\n<p>// DataSaver.go:</p>\n\n<pre><code>package DataStorage\n\nimport (\n   \"fmt\"\n   \"os\"\n)\n\ntype DataSaver struct {\n   // doesn't relevant to my question\n   fileName string\n   file     *os.File\n}\n\nfunc PrintStr() {\n   fmt.Println(\"hello\")\n}\n</code></pre>\n\n<p>Then, I have a main method in other class. I initialized the struct and I wanted to call to PrintStr() function. However, I can't call to this method. Why? </p>\n\n<p>Thank you!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1558536766, "post_id": 56259230, "comment_id": 99135778, "body": "are you trying to dynamically import during runtime ... or as below question explains are you cool with just doing import before compile time ?"}, {"owner": {"reputation": 557, "user_id": 1709930, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/01d7dae3a959029e270e33745bde094e?s=128&d=identicon&r=PG", "display_name": "Yifan Sun", "link": "https://stackoverflow.com/users/1709930/yifan-sun"}, "reply_to_user": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1558538389, "post_id": 56259230, "comment_id": 99136847, "body": "Just a clarification on what I need. I am detecting package information at runtime. I also mainly use go modules rather than GOPATH."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1558548190, "post_id": 56259230, "comment_id": 99141535, "body": "While I think there&#39;s supposed to be a way to do this with the existing <code>go&#47;importer</code> package which internally calls out to the <code>go</code> tool to locate the module source, I think you want to look at <a href=\"https://godoc.org/golang.org/x/tools/go/packages\" rel=\"nofollow noreferrer\"><code>golang.org&#47;x&#47;tools&#47;go&#47;packages</code></a> which is supposed to supersede the <code>go&#47;importer</code> package."}], "answers": [{"comments": [{"owner": {"reputation": 557, "user_id": 1709930, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/01d7dae3a959029e270e33745bde094e?s=128&d=identicon&r=PG", "display_name": "Yifan Sun", "link": "https://stackoverflow.com/users/1709930/yifan-sun"}, "edited": false, "score": 0, "creation_date": 1558538128, "post_id": 56259552, "comment_id": 99136712, "body": "I tried this with GOPATH and it works. So my question is how to get the same thing working with Go Modules?"}, {"owner": {"reputation": 148, "user_id": 2879816, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001511168084/picture?type=large", "display_name": "M&#225;rcio Rocha Zacarias", "link": "https://stackoverflow.com/users/2879816/m%c3%a1rcio-rocha-zacarias"}, "reply_to_user": {"reputation": 557, "user_id": 1709930, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/01d7dae3a959029e270e33745bde094e?s=128&d=identicon&r=PG", "display_name": "Yifan Sun", "link": "https://stackoverflow.com/users/1709930/yifan-sun"}, "edited": false, "score": 0, "creation_date": 1558538676, "post_id": 56259552, "comment_id": 99137026, "body": "There&#39;s a bunch of tutorials about that, but the quick and dirty way is, on your package directory:   $ GO111MODULE=on go mod init   $ GO111MODULE=on go mod tidy      That will check your project and download all packages. To install a specific package on your <code>go.mod</code>, you can use:   $ go install github.com/onsi/ginkgo"}, {"owner": {"reputation": 557, "user_id": 1709930, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/01d7dae3a959029e270e33745bde094e?s=128&d=identicon&r=PG", "display_name": "Yifan Sun", "link": "https://stackoverflow.com/users/1709930/yifan-sun"}, "edited": false, "score": 0, "creation_date": 1558540109, "post_id": 56259552, "comment_id": 99137804, "body": "I know how to set up a go module. However, the problem is that if the package I am importing is in GOPATH, i can import it. But if the package is not in the GOPATH, the <code>importer</code> cannot find it. But since I am using GOPATH at all, I cannot get all the packages in the GOPATH."}, {"owner": {"reputation": 148, "user_id": 2879816, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001511168084/picture?type=large", "display_name": "M&#225;rcio Rocha Zacarias", "link": "https://stackoverflow.com/users/2879816/m%c3%a1rcio-rocha-zacarias"}, "reply_to_user": {"reputation": 557, "user_id": 1709930, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/01d7dae3a959029e270e33745bde094e?s=128&d=identicon&r=PG", "display_name": "Yifan Sun", "link": "https://stackoverflow.com/users/1709930/yifan-sun"}, "edited": false, "score": 0, "creation_date": 1558547539, "post_id": 56259552, "comment_id": 99141270, "body": "Hmm, got it...  It&#39;s a tricky scenario... I didn&#39;t tested yet, but I presume that <code>go mod tidy</code> will cleanup ginkgo, as it&#39;s not directly imported by <code>import</code> on your code.  My last guess would be maybe vendoring your package with <code>$ go mod vendor</code>? Not sure if, similar to <code>tidy</code>, if it will not override any changes on your <code>go.mod</code> config and eliminate not &quot;imported&quot; packages"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1558548330, "post_id": 56259552, "comment_id": 99141591, "body": "Yes, <code>go mod tidy</code> will remove the package which isn&#39;t imported. The old <code>Import</code> interface does not work with vendor either: <code>CAUTION: This interface does not support the import of locally vendored packages.</code>"}], "tags": [], "owner": {"reputation": 148, "user_id": 2879816, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001511168084/picture?type=large", "display_name": "M&#225;rcio Rocha Zacarias", "link": "https://stackoverflow.com/users/2879816/m%c3%a1rcio-rocha-zacarias"}, "is_accepted": false, "score": 2, "last_activity_date": 1558538951, "last_edit_date": 1558538951, "creation_date": 1558536578, "answer_id": 56259552, "question_id": 56259230, "link": "https://stackoverflow.com/questions/56259230/how-to-use-go-importer/56259552#56259552", "title": "How to use go importer", "body": "<p>Go importer will not download the package for you. You can use <a href=\"https://github.com/golang/dep\" rel=\"nofollow noreferrer\">dep</a> or <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"nofollow noreferrer\">go modules</a> to handle your dependencies, but an easy fix would be downloading the package directly to your gopath using <a href=\"https://golang.org/pkg/cmd/go/internal/get/\" rel=\"nofollow noreferrer\">go get</a>:</p>\n\n<pre><code>go get -u github.com/onsi/ginkgo\n</code></pre>\n\n<p>After that, go importer will work and your code output should be:</p>\n\n<pre><code>package ginkgo (\"github.com/onsi/ginkgo\")\n</code></pre>\n\n<p>[EDIT] Using Go Modules:</p>\n\n<p>There's a bunch of tutorials about that, but the quick and dirty way is, on your package directory:</p>\n\n<pre><code>$ GO111MODULE=on go mod init\n$ GO111MODULE=on go mod tidy\n</code></pre>\n\n<p>That will check your project and download all packages. To install a specific package on your <code>go.mod</code>, you can use:  </p>\n\n<pre><code>$ go install github.com/onsi/ginkgo\n</code></pre>\n"}], "owner": {"reputation": 557, "user_id": 1709930, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/01d7dae3a959029e270e33745bde094e?s=128&d=identicon&r=PG", "display_name": "Yifan Sun", "link": "https://stackoverflow.com/users/1709930/yifan-sun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 757, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1558538951, "creation_date": 1558535506, "question_id": 56259230, "link": "https://stackoverflow.com/questions/56259230/how-to-use-go-importer", "title": "How to use go importer", "body": "<p>I have been trying to use the importer to parse the types defined in a particular package. However, the importer always return an error saying the package is not found. What mistake I am making? </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"go/importer\"\n)\n\nfunc main() {\n    pkg, err := importer.Default().Import(\"github.com/onsi/ginkgo\")\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(pkg)\n}\n</code></pre>\n\n<p>I tried to read the go importer documentation, but it provides very limited information. I also tried to use the package I am importing here, but it does not help. However, if I import a go standard package, such as \u201ctime\u201d, I can currently import the package. Why is that?</p>\n"}, {"tags": ["go", "kubernetes", "kubernetes-go-client"], "comments": [{"owner": {"reputation": 5024, "user_id": 1419891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bb825cd3f1905f42c16408393480a65b?s=128&d=identicon&r=PG", "display_name": "425nesp", "link": "https://stackoverflow.com/users/1419891/425nesp"}, "edited": false, "score": 0, "creation_date": 1599773436, "post_id": 56258866, "comment_id": 112886466, "body": "SharedInformers share the connection with the API server and other resources between your informers. According to this: <a href=\"https://stackoverflow.com/questions/59544139/kubernetes-client-go-watch-interface-vs-cache-newinformer-vs-cache-newsharedi\" title=\"kubernetes client go watch interface vs cache newinformer vs cache newsharedi\">stackoverflow.com/questions/59544139/&hellip;</a>"}], "owner": {"reputation": 81, "user_id": 9010321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97af90454bef9b2b50106888ee39af2b?s=128&d=identicon&r=PG&f=1", "display_name": "Iago Santos", "link": "https://stackoverflow.com/users/9010321/iago-santos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 286, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1558534370, "creation_date": 1558534370, "question_id": 56258866, "link": "https://stackoverflow.com/questions/56258866/difference-between-newindexerinformer-and-newsharedindexinformer", "title": "Difference between NewIndexerInformer and NewSharedIndexInformer", "body": "<p>I have a question regarding the difference between <code>NewIndexerInformer</code> and <code>NewSharedIndexInformer</code> as I would like to use <code>NewSharedIndexInformer</code> instead <code>NewIndexerInformer</code></p>\n\n<p><a href=\"https://github.com/kubernetes/client-go/blob/master/tools/cache/shared_informer.go#L132\" rel=\"nofollow noreferrer\">https://github.com/kubernetes/client-go/blob/master/tools/cache/shared_informer.go#L132</a> and </p>\n\n<p><a href=\"https://github.com/kubernetes/client-go/blob/master/tools/cache/controller.go#L307\" rel=\"nofollow noreferrer\">https://github.com/kubernetes/client-go/blob/master/tools/cache/controller.go#L307</a></p>\n\n<p>in <code>NewIndexerInformer</code> I pass the <code>ResourceEventHandler</code> but in <code>NewSharedIndexInformer</code> I cannot, this means I don't need to specify events of creation, deletion, etc? </p>\n\n<p>I am doing the following <a href=\"https://pastebin.com/kqvQpDLU\" rel=\"nofollow noreferrer\">https://pastebin.com/kqvQpDLU</a> in line 226 and 251</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["go", "swagger", "go-swagger"], "comments": [{"owner": {"reputation": 57048, "user_id": 113116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e0v1H.png?s=128&g=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/113116/helen"}, "edited": false, "score": 0, "creation_date": 1558531959, "post_id": 56257810, "comment_id": 99132675, "body": "If it&#39;s a bug report, you should file it in the go-swagger repository at <a href=\"https://github.com/go-swagger/go-swagger/issues\" rel=\"nofollow noreferrer\">github.com/go-swagger/go-swagger/issues</a>."}, {"owner": {"reputation": 154, "user_id": 8913763, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ICicn.jpg?s=128&g=1", "display_name": "VadimFilin", "link": "https://stackoverflow.com/users/8913763/vadimfilin"}, "reply_to_user": {"reputation": 57048, "user_id": 113116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e0v1H.png?s=128&g=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/113116/helen"}, "edited": false, "score": 0, "creation_date": 1558532363, "post_id": 56257810, "comment_id": 99132938, "body": "@Helen for now it is unclear bug is it or mistake"}, {"owner": {"reputation": 57048, "user_id": 113116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e0v1H.png?s=128&g=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/113116/helen"}, "edited": false, "score": 0, "creation_date": 1558535157, "post_id": 56257810, "comment_id": 99134800, "body": "Your API definition is correct so this is most probably a bug (or missing functionality)."}, {"owner": {"reputation": 154, "user_id": 8913763, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ICicn.jpg?s=128&g=1", "display_name": "VadimFilin", "link": "https://stackoverflow.com/users/8913763/vadimfilin"}, "reply_to_user": {"reputation": 57048, "user_id": 113116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e0v1H.png?s=128&g=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/113116/helen"}, "edited": false, "score": 1, "creation_date": 1558558465, "post_id": 56257810, "comment_id": 99146070, "body": "BTW the issue is exist: <a href=\"https://github.com/go-swagger/go-swagger/issues/1904\" rel=\"nofollow noreferrer\">github.com/go-swagger/go-swagger/issues/1904</a> . Maybe  someone will suggest a workaround?"}], "answers": [{"tags": [], "owner": {"reputation": 154, "user_id": 8913763, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ICicn.jpg?s=128&g=1", "display_name": "VadimFilin", "link": "https://stackoverflow.com/users/8913763/vadimfilin"}, "is_accepted": false, "score": 0, "last_activity_date": 1558562801, "creation_date": 1558562801, "answer_id": 56265611, "question_id": 56257810, "link": "https://stackoverflow.com/questions/56257810/go-swagger-do-not-validates-body-in-post-request/56265611#56265611", "title": "go-swagger do not validates Body in POST request", "body": "<p>My personal workaround is</p>\n\n<pre><code>api.UserCreateHandler = operations.UserCreateHandlerFunc(func(params operations.UserCreateParams) middleware.Responder {\n        if params.Body.UserObject == (models.UserObject{}) {\n            return //... your BAD REQUEST type\n        }\n        return middleware.NotImplemented(\"MUST NOT BE PRINTED\")\n    })\n\n</code></pre>\n"}], "owner": {"reputation": 154, "user_id": 8913763, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ICicn.jpg?s=128&g=1", "display_name": "VadimFilin", "link": "https://stackoverflow.com/users/8913763/vadimfilin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 852, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1558562801, "creation_date": 1558531107, "last_edit_date": 1558532433, "question_id": 56257810, "link": "https://stackoverflow.com/questions/56257810/go-swagger-do-not-validates-body-in-post-request", "title": "go-swagger do not validates Body in POST request", "body": "<p>Swagger ignoring required fields in body of POST request.</p>\n\n<p>Steps to reproduce:</p>\n\n<ol>\n<li>Describe swaggerfile</li>\n</ol>\n\n<pre><code>swagger: \"2.0\"\ninfo:\n  title: Sample API\n  description: API description in Markdown.\n  version: 1.0.0\nhost: api.example.com\nschemes:\n  - http\npaths:\n  /users:\n    post:\n      operationId: UserCreate\n      parameters:\n        - name: body\n          in: body\n          required: true\n          schema:\n            allOf:\n              - $ref: \"#/definitions/ID\"\n              - $ref: \"#/definitions/User_object\"\n              - type: object\n                required:  # HERE! IT IS NOT WORKING\n                  - ID\n                  - genderCode\n                  - birthDate\n                  - code\n      produces:\n        - application/json\n      consumes:\n        - application/json\n      responses:\n        200:\n          description: \"OK\"\n\ndefinitions:\n  ID:\n    title: ID\n    properties:\n      GUID:\n        type: string\n        description: \"ID\"\n        format: uuid\n\n  User_object:\n    title: User_object\n    properties:\n      genderCode:\n        type: string\n      birthDate:\n        type: string\n        format: date\n      code:\n        type: string\n</code></pre>\n\n<ol start=\"2\">\n<li>Generate api</li>\n</ol>\n\n<blockquote>\n  <p>swagger generate server -f swaggerfile.yaml -t api</p>\n</blockquote>\n\n<ol start=\"3\">\n<li>Describe single handler:</li>\n</ol>\n\n<pre class=\"lang-golang prettyprint-override\"><code>api.UserCreateHandler = operations.UserCreateHandlerFunc(func(params operations.UserCreateParams) middleware.Responder {\n        return middleware.NotImplemented(\"MUST NOT BE PRINTED\")\n    })\n</code></pre>\n\n<ol start=\"4\">\n<li>Make a request to generated api:</li>\n</ol>\n\n<blockquote>\n  <p>curl -X POST -H \"Content-Type: application/json\" -d '{\"foo\":\"bar\"}' localhost:{{host}}/users</p>\n</blockquote>\n\n<p>Expected result:</p>\n\n<blockquote>\n  <p>400 Bad Request</p>\n</blockquote>\n\n<p>Given result:</p>\n\n<blockquote>\n  <p>501 MUST NOT BE PRINTED</p>\n</blockquote>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1558529792, "post_id": 56257268, "comment_id": 99131131, "body": "Make <i>two</i> channels, one for each receiver and send the same value to both channels  / receivers."}], "answers": [{"tags": [], "owner": {"reputation": 1008, "user_id": 5687416, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AYoGy.jpg?s=128&g=1", "display_name": "Asnim P Ansari", "link": "https://stackoverflow.com/users/5687416/asnim-p-ansari"}, "is_accepted": false, "score": 2, "last_activity_date": 1558530225, "creation_date": 1558530225, "answer_id": 56257477, "question_id": 56257268, "link": "https://stackoverflow.com/questions/56257268/listen-one-channel-on-multiple-places-in-go/56257477#56257477", "title": "Listen one channel on multiple places in Go", "body": "<p>You have to create multiple channels and pass the same value to each of those channels.\nExample</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n)\n\nfunc main(){\n    chann1 := make(chan int)\n    chann2 := make(chan int)\n    go func(){\n        for {\n            val :=&lt;- chann1\n            fmt.Println(\"GORoutine 1\", val)\n        }\n\n    }()\n    go func(){\n        for {\n            val :=&lt;- chann2\n            fmt.Println(\"GORoutine 2\", val)\n        }\n\n    }()\n\n    for i:=0;i&lt;=10;i++{\n        chann1 &lt;- i\n        chann2 &lt;- i\n    }\n\n\n}\n</code></pre>\n"}], "owner": {"reputation": 772, "user_id": 8708710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/440c96fe2dc212e8d498d0166799e951?s=128&d=identicon&r=PG", "display_name": "Lakindu Akash", "link": "https://stackoverflow.com/users/8708710/lakindu-akash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "closed_date": 1558530144, "answer_count": 1, "score": 1, "last_activity_date": 1558530225, "creation_date": 1558529574, "question_id": 56257268, "link": "https://stackoverflow.com/questions/56257268/listen-one-channel-on-multiple-places-in-go", "closed_reason": "Duplicate", "title": "Listen one channel on multiple places in Go", "body": "<p>I know if once get the data from a channel that data won't receive from any other place that channel is waiting. However, if I want to design a program broadcast that channel has got data and It is ready to take out in different places without affecting other channels but in all places, I need to receive data in the same order, what will be the best design?</p>\n\n<p>As a example:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func sender(c chan int){\nc-&gt; 5\n}\n\nfunc reciever1(c chan int){\n i:= &lt;-c\n...\n}\n\nfunc reciever2(c chan int){\n i:= &lt;-c\n...\n}\n</code></pre>\n\n<p>Here when executing both <code>reciever1()</code> and <code>reciver2()</code> Both should get same result.</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11044402"}, "edited": false, "score": 1, "creation_date": 1558530882, "post_id": 56257188, "comment_id": 99131866, "body": "I see no relation betwwen the output you get and the output you want to generate. What is the expected output for the given input?"}, {"owner": {"reputation": 65, "user_id": 9429519, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "stackover flow", "link": "https://stackoverflow.com/users/9429519/stackover-flow"}, "edited": false, "score": 0, "creation_date": 1558531271, "post_id": 56257188, "comment_id": 99132151, "body": "@LutzHorn I am unable to get relation for title, content, metadata and comments for each line. For instance, I want to print content + comments together.  Currently, I get content and comments as seperate line (due to for loop). So, no relation is possible i think."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11044402"}, "edited": false, "score": 1, "creation_date": 1558531395, "post_id": 56257188, "comment_id": 99132260, "body": "Collect the data from each line into a <code>struct</code> type. Let this type implement  <a href=\"https://golang.org/pkg/fmt/#Stringer\" rel=\"nofollow noreferrer\"><code>Stringer</code></a>. Print it."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 9429519, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "stackover flow", "link": "https://stackoverflow.com/users/9429519/stackover-flow"}, "edited": false, "score": 0, "creation_date": 1558623891, "post_id": 56260890, "comment_id": 99170507, "body": "Thank you. In my case, <code>result[&quot;53&quot;].comments</code> is what i need :)"}], "tags": [], "owner": {"reputation": 135, "user_id": 7222662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d4jMb.png?s=128&g=1", "display_name": "tsak", "link": "https://stackoverflow.com/users/7222662/tsak"}, "is_accepted": true, "score": 0, "last_activity_date": 1558540907, "creation_date": 1558540907, "answer_id": 56260890, "question_id": 56257188, "link": "https://stackoverflow.com/questions/56257188/read-specific-data-line-by-line/56260890#56260890", "title": "Read specific data line by line", "body": "<p>As @LutzHorn suggested, why not read your data into a struct? The code below does that using reflection (though without checking for existence or type of field).</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"reflect\"\n    \"strings\"\n)\n\ntype Entry struct {\n    Title    string\n    Content  string\n    Metadata string\n    Comments string\n}\n\nfunc main() {\n    var input string = `title:stack|content:overflow|metadata:53|comments:none\ntitle:google|content:website|metadata:213|comments:Demos\n`\n\n    var result = make(map[string]Entry)\n\n    scanner := bufio.NewScanner(strings.NewReader(input))\n    for scanner.Scan() {\n        data := scanner.Text()\n        data_arr := strings.Split(data, \"|\")\n\n        entry := Entry{}\n\n        for _, n := range data_arr {\n\n            data_subdoc := strings.Split(n, \":\")\n            key, value := data_subdoc[0], data_subdoc[1]\n\n            fmt.Println(key, value)\n\n            field := strings.Title(key)\n            reflect.Indirect(reflect.ValueOf(&amp;entry)).FieldByName(field).SetString(value)\n        }\n\n        result[entry.Metadata] = entry\n    }\n\n    fmt.Printf(\"%+v\\n\", result[\"53\"])\n    fmt.Printf(\"%+v\\n\", result[\"213\"])\n}\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 9429519, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "stackover flow", "link": "https://stackoverflow.com/users/9429519/stackover-flow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 56260890, "answer_count": 1, "score": 0, "last_activity_date": 1558540907, "creation_date": 1558529317, "last_edit_date": 1558531184, "question_id": 56257188, "link": "https://stackoverflow.com/questions/56257188/read-specific-data-line-by-line", "title": "Read specific data line by line", "body": "<p>I am trying to read data from a file in specific format.</p>\n\n<p>file looks as follows</p>\n\n<pre><code>title:stack|content:overflow|metadata:53|comments:none\ntitle:google|content:website|metadata:213|comments:Demos\n</code></pre>\n\n<p>I need to read this line by line and \nassign title variable with <code>title</code> value (<code>\"stack\"</code>), content with <code>content</code> value (<code>\"overflow\"</code>) for each line.</p>\n\n<pre><code>scanner := bufio.NewScanner(file)\n        for scanner.Scan() {\n                data := scanner.Text()\n                data_arr := strings.Split(data, \"|\")\n\n                for _, n := range data_arr {\n\n                        data_subdoc := strings.Split(n, \":\")\n                        a, b := data_subdoc[0], data_subdoc[1]\n\n                        fmt.Println(a, b)\n</code></pre>\n\n<p>But problem is I get data as (relation between title, content, metadata and comments for each line is missing)</p>\n\n<pre><code>title stack\ncontent overflow\nmetadata 53\ncomments none\ntitle google\ncontent website\nmetadata 213 \ncomments Demos\n</code></pre>\n\n<p>But, I want something like:</p>\n\n<pre><code>stack overflow 53\n\nif stack has 53:\n    print comments (in this case, its 'none')\n\ngoogle website 213\n\nif google has 213, print content (In this case, its 'website')\n</code></pre>\n"}, {"tags": ["go", "kubernetes", "grpc", "istio", "knative"], "comments": [{"owner": {"reputation": 1126, "user_id": 3508174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vfMCq.jpg?s=128&g=1", "display_name": "Sergey Narozhnyy", "link": "https://stackoverflow.com/users/3508174/sergey-narozhnyy"}, "edited": false, "score": 1, "creation_date": 1558544615, "post_id": 56256874, "comment_id": 99140070, "body": "doesn&#39;t work according to <a href=\"https://github.com/knative/docs/blob/master/docs/serving/using-a-tls-cert.md\" rel=\"nofollow noreferrer\">using-a-tls-cert</a>?"}, {"owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "reply_to_user": {"reputation": 1126, "user_id": 3508174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vfMCq.jpg?s=128&g=1", "display_name": "Sergey Narozhnyy", "link": "https://stackoverflow.com/users/3508174/sergey-narozhnyy"}, "edited": false, "score": 0, "creation_date": 1558545316, "post_id": 56256874, "comment_id": 99140350, "body": "How do you conclude - Is it something with autoTLS?"}, {"owner": {"reputation": 1126, "user_id": 3508174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vfMCq.jpg?s=128&g=1", "display_name": "Sergey Narozhnyy", "link": "https://stackoverflow.com/users/3508174/sergey-narozhnyy"}, "edited": false, "score": 1, "creation_date": 1558546302, "post_id": 56256874, "comment_id": 99140778, "body": "Seems so: <a href=\"https://github.com/knative/serving/issues/4133\" rel=\"nofollow noreferrer\">issues/4133</a>"}, {"owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "reply_to_user": {"reputation": 1126, "user_id": 3508174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vfMCq.jpg?s=128&g=1", "display_name": "Sergey Narozhnyy", "link": "https://stackoverflow.com/users/3508174/sergey-narozhnyy"}, "edited": false, "score": 0, "creation_date": 1558546584, "post_id": 56256874, "comment_id": 99140885, "body": "Hmm interesting, thanks"}, {"owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "reply_to_user": {"reputation": 1126, "user_id": 3508174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vfMCq.jpg?s=128&g=1", "display_name": "Sergey Narozhnyy", "link": "https://stackoverflow.com/users/3508174/sergey-narozhnyy"}, "edited": false, "score": 0, "creation_date": 1558546995, "post_id": 56256874, "comment_id": 99141034, "body": "Though, I do have a web server working with https"}], "owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558529341, "creation_date": 1558528241, "last_edit_date": 1558529341, "question_id": 56256874, "link": "https://stackoverflow.com/questions/56256874/knative-security-unable-to-create-a-secure-tls-connection-using-grpc", "title": "Knative security - unable to create a secure TLS connection using gRPC", "body": "<p>I need a secure connection to Knative.</p>\n\n<p>Tried a milion, and on the top of my head - the following scenario:</p>\n\n<pre><code>WORKED:\n|----------------------------------------------------------------------------|--------------------------------------------|\n| 1. curl -H \"Host:  my-servivce.default.mydomin.com\" http(s)://mydomain.com | knative-ingress-gateway(tls with cert.pem) |\n|----------------------------------------------------------------------------|--------------------------------------------|\n| 2. unsecure gRPC port:80                                                   | knative                                    |\n|----------------------------------------------------------------------------|--------------------------------------------|\n\nNOT WORKING:\n|-----------------------------|------------------------------------------------------------------------------------------------|\n| 3. unsecure gRPC port:443   | knative-ingress-gateway(tls PASSTHROUGH)                                                       |\n|-----------------------------|------------------------------------------------------------------------------------------------|\n| 4.     --//--               | knative-ingress-gateway(tls with cert.pem) using same working certificate as for 1. (curl)     |\n|-----------------------------|--------------------------------------------|---------------------------------------------------|\n| 5. secure gRPC(cert from 4.)| knative-ingress-gateway(tls PASSTHROUGH)   | gRPC secure server OpenSSL mydomain.com           |\n|-----------------------------|--------------------------------------------|---------------------------------------------------|    \n| 6. OpenSSL secure gRPC      | knative-ingress-gateway(tls PASSTHROUGH)   | gRPC secure server OpenSSL mydomain.com           |\n|-----------------------------|--------------------------------------------|---------------------------------------------------|\n| 7.     --//--               | knative-ingress-gateway(tls PASSTHROUGH)   | gRPC secure server OpenSSL internall host domain  |\n|--------------------------   |--------------------------------------------|---------------------------------------------------|\n</code></pre>\n\n<p>If you have got anything working with TLS or http(s), or know one who has, I would very much like to know?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["pointers", "go", "go-map"], "answers": [{"comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1558612028, "post_id": 56257099, "comment_id": 99163517, "body": "You can&#39;t be sure that the map resides in heap IIRC. The runtime manages the underlying hashtable pointer, it could be a pointer to stack memory, or heap... you just don&#39;t know. Furthermore, you can change what&#39;s in the map because of the pointer, but since the underlying pointer is <i>managed</i>, it&#39;s possible that adding new keys might result in a new hashtable being allocated, and the pointer in the copy getting updated, at which point, the map in the caller scope won&#39;t be affected"}], "tags": [], "owner": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "is_accepted": false, "score": 0, "last_activity_date": 1558529000, "creation_date": 1558529000, "answer_id": 56257099, "question_id": 56256527, "link": "https://stackoverflow.com/questions/56256527/when-the-form-parameter-in-go-is-map-what-is-passed-in/56257099#56257099", "title": "When the form parameter in go is map, what is passed in?", "body": "<p>In Go, map is a reference type. This means that the map actually resides in the heap and variable is just a pointer to that. </p>\n\n<p>The map is passed by copy. You can change the local copy in your function, but this will not be reflected in caller's scope. </p>\n\n<p>But, since the map variable is a pointer to the unique map residing in the heap, every change can be seen by any variable that points to the same map. </p>\n\n<p>This article can clarify the concept: <a href=\"https://www.ardanlabs.com/blog/2014/12/using-pointers-in-go.html\" rel=\"nofollow noreferrer\">https://www.ardanlabs.com/blog/2014/12/using-pointers-in-go.html</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "is_accepted": false, "score": 3, "last_activity_date": 1558612721, "last_edit_date": 1558612721, "creation_date": 1558529592, "answer_id": 56257281, "question_id": 56256527, "link": "https://stackoverflow.com/questions/56256527/when-the-form-parameter-in-go-is-map-what-is-passed-in/56257281#56257281", "title": "When the form parameter in go is map, what is passed in?", "body": "<p>The parameter is <em>both</em> a value and a pointer.</p>\n\n<h2>Wait.. whut?</h2>\n\n<p>Yes, a map (and slices, for that matter) are types, pretty similar to what you would implement. Think of a map like this:</p>\n\n<pre><code>type map struct {\n    // meta information on the map\n    meta struct{\n        keyT   type\n        valueT type\n        len    int\n    }\n    value *hashTable // pointer to the underlying data structure\n}\n</code></pre>\n\n<p>So in your first function, where you reassign <code>m</code>, you're passing a copy of the struct above (pass by value), and you're assigning a <em>new</em> map to it, creating a new hashtable pointer in the process. The variable in the function scope is updated, but the one you passed still holds a reference to the original map, and with it, the pointer to the original map is preserved.</p>\n\n<p>In the second snippet, you're accessing the underlying hash table (a copy of the pointer, but the pointer points to the same memory). You're directly manipulating the original map, because you're just changing the contents of the memory.</p>\n\n<h1>So TL;DR</h1>\n\n<p>A map is a value, containing meta information of what the map looks like, and a <em>pointer</em> to the actual data stored inside. The pointer is passed by value, like anything else (same way pointers are passed by value in C/C++), but of course, dereferencing a pointer means you're changing the values in memory directly.</p>\n\n<h2>Careful...</h2>\n\n<p>Like I said, slices work pretty much in the same way:</p>\n\n<pre><code>type slice struct {\n    meta struct {\n        type T\n        len, cap int\n    }\n    value *array // yes, it's a pointer to an underlying array\n}\n</code></pre>\n\n<p>The underlying array is of say, a slice of ints will be <code>[10]int</code> if the <em>cap</em> of the slice is 10, regardless of the length. A slice is managed by the go runtime, so if you exceed the capacity, a new array is allocated (twice the <code>cap</code> of the previous one), the existing data is copied over, and the slice <code>value</code> field is set to point to the new array. That's the reason why <code>append</code> returns the slice that you're appending to, the underlying pointer may have changed etc.. you can find more in-depth information on this.</p>\n\n<p>The thing you have to be careful with is that a function like this:</p>\n\n<pre><code>func update(s []int) {\n    for i, v := range s {\n       s[i] = v*2\n    }\n}\n</code></pre>\n\n<p>will behave much in the same way as the function you have were you're assigning <code>m[1] = 2</code>, but once you start appending, the runtime is free to move the underlying array around, and point to a new memory address. So bottom line: maps and slices have an internal pointer, which can produce side-effects, but you're better off avoiding bugs/ambiguities. Go supports multiple return values, so just return a slice if you set about changing it.</p>\n\n<h3>Notes:</h3>\n\n<p>In your attempt to figure out what a map is (reference, value, pointer...), I noticed you tried this:</p>\n\n<pre><code>pointer := unsafe.Pointer(&amp;m)\nfmt.Println(pointer)\n</code></pre>\n\n<p>What you're doing there, is actually printing the <em>address of the argument variable</em>, not any address that actually corresponds to the map itself. the argument passed to <code>unsafe.Pointer</code> isn't of the type <code>map[int]int</code>, but rather it's of type <code>*map[int]int</code>.</p>\n\n<p>Personally, I think there's too much confusion around passing by value vs passing by . Go works exactly like C in this regard, just like C, <em>absolutely everything</em> is passed by value. It just so happens that this value can sometimes be a memory address (pointer).</p>\n\n<hr>\n\n<h3>More details (references)</h3>\n\n<ul>\n<li><a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">Slices: usage &amp; internals</a></li>\n<li><a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"nofollow noreferrer\">Maps</a> <em>Note: there's some confusion caused by this one, as pointers, slices, and maps are referred to as *reference types*, but as explained by others, and elsewhere, this is not to be confused with C++ references</em></li>\n</ul>\n"}], "owner": {"reputation": 27, "user_id": 9648992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d5099294b65e600bd75851552a5d5b6?s=128&d=identicon&r=PG&f=1", "display_name": "Wongfy", "link": "https://stackoverflow.com/users/9648992/wongfy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1558612721, "creation_date": 1558527116, "question_id": 56256527, "link": "https://stackoverflow.com/questions/56256527/when-the-form-parameter-in-go-is-map-what-is-passed-in", "title": "When the form parameter in go is map, what is passed in?", "body": "<p>When the formal parameter is map, assigning a value directly to a formal parameter cannot change the actual argument, but if you add a new key and value to the formal parameter, the actual argument outside the function can also be seen. Why is that?</p>\n\n<p>I don't understand the output value of the following code, and the formal parameters are different from the actual parameters.</p>\n\n<pre><code>unc main() {\n    t := map[int]int{\n        1: 1,\n    }\n    fmt.Println(unsafe.Pointer(&amp;t))\n    copysss(t)\n    fmt.Println(t)\n}\nfunc copysss(m map[int]int) {\n    //pointer := unsafe.Pointer(&amp;m)\n    //fmt.Println(pointer)\n    m = map[int]int{\n        1: 2,\n    }\n}\n</code></pre>\n\n<pre><code>stdout :0xc000086010\n\n        map[1:1]\n</code></pre>\n\n<pre><code>func main() {\n    t := map[int]int{\n        1: 1,\n    }\n    fmt.Println(unsafe.Pointer(&amp;t))\n    copysss(t)\n    fmt.Println(t)\n}\nfunc copysss(m map[int]int) {\n    //pointer := unsafe.Pointer(&amp;m)\n    //fmt.Println(pointer)\n    m[1] = 2\n}\n</code></pre>\n\n<pre><code>stdout :0xc00007a010\n\n        map[1:2]\n</code></pre>\n\n<pre><code>func main() {\n    t := map[int]int{\n        1: 1,\n    }\n    fmt.Println(unsafe.Pointer(&amp;t))\n    copysss(t)\n    fmt.Println(t)\n}\nfunc copysss(m map[int]int) {\n    pointer := unsafe.Pointer(&amp;m)\n    fmt.Println(pointer)\n    m[1] = 2\n}\n</code></pre>\n\n<pre><code>stdout:0xc00008a008\n       0xc00008a018\n       map[1:2]\n</code></pre>\n\n<p>I want to know if the parameter is a value or a pointer.</p>\n"}, {"tags": ["go", "terraform"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1558534727, "post_id": 56256189, "comment_id": 99134528, "body": "If you look at the docs for the <code>Elem</code> field, it says that <code>it may be either a *Schema or a *Resource</code>, and a <code>TypeMap</code> must be a <code>*Schema</code>. This appears to be invalid according the documentation."}, {"owner": {"reputation": 95, "user_id": 11158426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0a1b91c8ba6e163d35d0c50034caae3?s=128&d=identicon&r=PG&f=1", "display_name": "Shimon", "link": "https://stackoverflow.com/users/11158426/shimon"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1558539998, "post_id": 56256189, "comment_id": 99137753, "body": "Thank you, @JimB. However, I still don&#39;t know how to fix it. If I change the <code>Elem</code> to <code>*Schema</code>, then I get syntax errors for the field names (&quot;onebool&quot; etc.). If I change it to (what I think the struct really is)  <code>Elem: map[string]*schema.Schema</code>, then I get a runtime error <code>Error: struct.my-struct-1: complexstruct: unexpected map value type: map[string]*schema.Schema{&quot;internalstruct&quot;:*schema.Schema{..&zwnj;&#8203;.</code>. Can you help me formulate it correctly? Thanks a lot"}, {"owner": {"reputation": 95, "user_id": 11158426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0a1b91c8ba6e163d35d0c50034caae3?s=128&d=identicon&r=PG&f=1", "display_name": "Shimon", "link": "https://stackoverflow.com/users/11158426/shimon"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1558540866, "post_id": 56256189, "comment_id": 99138225, "body": "Still no luck. After the comment from @JimB, I tried to change my <code>TypeMap</code> elements to <code>TypeList</code> with <code>MaxItems:1</code>.  It all compiles nicely, but when running <code>terraform apply</code>, I get a panic: <code>Error reading level config: &#39;&#39; expected type &#39;string&#39;, got unconvertible type &#39;map[string]interface {}&#39;</code>, and terraform crashes and says &quot;<code>struct.my-struct-1: unexpected EOF</code>&quot; (I can&#39;t find anything wrong with the HCL itself though)."}, {"owner": {"reputation": 1608, "user_id": 1594178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7dc76ec6dacae52f62dbade9fbe376bd?s=128&d=identicon&r=PG", "display_name": "shibormot", "link": "https://stackoverflow.com/users/1594178/shibormot"}, "edited": false, "score": 0, "creation_date": 1558563518, "post_id": 56256189, "comment_id": 99147677, "body": "what line in your code a panic starts? it is printed in panic stack trace. also you can comment parts of schema to locate where it starts working. just a thought..."}, {"owner": {"reputation": 95, "user_id": 11158426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0a1b91c8ba6e163d35d0c50034caae3?s=128&d=identicon&r=PG&f=1", "display_name": "Shimon", "link": "https://stackoverflow.com/users/11158426/shimon"}, "edited": false, "score": 0, "creation_date": 1558588977, "post_id": 56256189, "comment_id": 99152296, "body": "Neither the crash.log nor the stack trace give any indication of a line in my code where the panic starts. Here&#39;s an excerpt from the crash.log file: <code>2019&#47;05&#47;22 21:34:39 [TRACE] root: eval: *terraform.EvalValidateResource 2019&#47;05&#47;22 21:34:39 [TRACE] root: eval: *terraform.EvalReadState 2019&#47;05&#47;22 21:34:39 [TRACE] root: eval: *terraform.EvalDiff 2019-05-22T21:34:39.894+0300 [DEBUG] plugin.terraform-provider-struct.exe: panic: Error reading level config: &#39;&#39; expected type &#39;string&#39;, got unconvertible type &#39;map[string]interface {}&#39;</code>. The panic seems to be inside the Terraform code."}, {"owner": {"reputation": 95, "user_id": 11158426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0a1b91c8ba6e163d35d0c50034caae3?s=128&d=identicon&r=PG&f=1", "display_name": "Shimon", "link": "https://stackoverflow.com/users/11158426/shimon"}, "edited": false, "score": 0, "creation_date": 1558625635, "post_id": 56256189, "comment_id": 99171419, "body": "Thank you all. I worked it through. It was all a matter of casting the right types. It took me a while but I am getting there. Please don&#39;t spend any more time on helping me here. Thank you all."}, {"owner": {"reputation": 4288, "user_id": 1629362, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/hnWU3.png?s=128&g=1", "display_name": "bitkot", "link": "https://stackoverflow.com/users/1629362/bitkot"}, "edited": false, "score": 0, "creation_date": 1616083439, "post_id": 56256189, "comment_id": 117897979, "body": "@Shimon I know it&#39;s been a while. Were you able to figure out the solution for this? I am facing the same issue. It would really help if you can post the solution."}, {"owner": {"reputation": 95, "user_id": 11158426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0a1b91c8ba6e163d35d0c50034caae3?s=128&d=identicon&r=PG&f=1", "display_name": "Shimon", "link": "https://stackoverflow.com/users/11158426/shimon"}, "reply_to_user": {"reputation": 4288, "user_id": 1629362, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/hnWU3.png?s=128&g=1", "display_name": "bitkot", "link": "https://stackoverflow.com/users/1629362/bitkot"}, "edited": false, "score": 0, "creation_date": 1616262362, "post_id": 56256189, "comment_id": 117949233, "body": "@bitkot, sorry, I never finished this, and anyway I don&#39;t have access to the sources any more. Sorry."}], "owner": {"reputation": 95, "user_id": 11158426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0a1b91c8ba6e163d35d0c50034caae3?s=128&d=identicon&r=PG&f=1", "display_name": "Shimon", "link": "https://stackoverflow.com/users/11158426/shimon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 322, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558550426, "creation_date": 1558525839, "last_edit_date": 1558550426, "question_id": 56256189, "link": "https://stackoverflow.com/questions/56256189/expressing-a-complex-structure-in-terraform-and-reading-it-in-go", "title": "Expressing a complex structure in Terraform and reading it in Go", "body": "<p>Note: edited after a comment from @JimB</p>\n\n<p>I am trying to build a new Terraform provider in Go. The resource that I need is a bit complex. It includes structures, arrays within structures, arrays and structures within arrays. When I run Terraform, it gives me errors, for example:\n<code>panic: Error reading level config: '' expected type 'string', got unconvertible type 'map[string]interface {}'</code>. I can't figure out what I am doing wrong.</p>\n\n<p>When I make the structures simple enough, they do work, but I need this resource and I'm sure there's a way to do it, and I'm just missing something perhaps trivial.</p>\n\n<p>-- Here's the Terraform structure:</p>\n\n<pre><code>resource \"struct\" \"my-struct-1\" {\n    name = \"MyFile\"\n    complexstruct = [{\n        onebool = true\n        onearray = [{\n            name = \"name-1\"\n            value = \"value-1\"\n        }, {\n            name = \"name-2\"\n            value = \"value-2\"\n        }]\n        internalstruct = [{\n            attr1 = false\n            attr2 = \"attribute\"\n        }]\n    }]\n    array = [\n        {\n            attrib1 = \"attrib1.1\"\n            attrib2 = false\n            attrib3 = \"attrib1.3\"\n        },\n        {\n            attrib1 = \"attrib2.1\"\n            attrib2 = true\n            attrib3 = \"attrib2.3\"\n        }\n    ]\n}\n</code></pre>\n\n<p>-- Here is the Schema definition in go, as simplified as I could make it:</p>\n\n<pre><code>Schema: map[string]*schema.Schema{\n    \"name\": {\n        Type:     schema.TypeString,\n        Required: true,\n    },\n    \"complexstruct\": {\n        Type:   schema.TypeList,\n        MaxItems: 1,\n        Optional: true,\n        Elem: &amp;schema.Resource{\n            Schema: map[string]*schema.Schema{\n                \"onebool\": {\n                    Type:     schema.TypeBool,\n                    Optional: true,\n                },\n                \"onearray\": {\n                    Type:     schema.TypeList,\n                    Optional: true,\n                    Elem: &amp;schema.Resource{\n                        Schema: map[string]*schema.Schema{\n                            \"name\": {\n                                Type:     schema.TypeString,\n                                Optional: true,\n                            },\n                            \"value\": {\n                                Type:     schema.TypeString,\n                                Optional: true,\n                            },\n                        },\n                    },\n                },\n                \"internalstruct\": {\n                    Type:     schema.TypeList,\n                    MaxItems: 1,\n                    Optional: true,\n                    Elem: &amp;schema.Resource{\n                        Schema: map[string]*schema.Schema{\n                            \"attr1\": {\n                                Type:     schema.TypeBool,\n                                Optional: true,\n                            },\n                            \"attr2\": {\n                                Type:     schema.TypeString,\n                                Optional: true,\n                            },\n                        },\n                    },\n                },\n            },\n        },\n    },\n    \"array\": {\n        Type:     schema.TypeList,\n        Optional: true,\n        Elem: map[string]*schema.Schema{\n            \"attrib1\": {\n                Type: schema.TypeString,\n                Optional: true,\n            },\n            \"attrib2\": {\n                Type: schema.TypeBool,\n                Optional: true,\n            },\n            \"attrib3\": {\n                Type: schema.TypeString,\n                Optional: true,\n            },\n        },\n    },\n},\n</code></pre>\n\n<p>----- And lastly, here's the code that I am trying to use (however, I think the problem is before it starts with the code itself):</p>\n\n<pre><code>fname := d.Get(\"name\").(string)\nd.SetId(fname)\nif _, ok := d.GetOk(\"complexstruct\"); ok {\n    fc := d.Get(\"complexstruct\").([]map[string]interface{})\n    myBool := fc[0][\"onebool\"].(bool)\n    myArray := fc[0][\"onearray\"].([]map[string]interface{})\n    type fcS struct {\n        Name    string `json:\"name\"`\n        Value   string `json:\"value\"`\n    }\n    fcs := make([]fcS, len(myArray))\n    for ifc := range myArray {\n        fcs[ifc].Name = myArray[ifc][\"name\"].(string)\n        fcs[ifc].Value = myArray[ifc][\"value\"].(string)\n    }\n\n    myInternalStruct := fc[0][\"internalstruct\"].([]map[string]interface{})\n    type misS struct {\n        Attr1   bool    `json:\"attr1\"`\n        Attr2   string  `json:\"attr2\"'`\n    }\n    var mis misS\n    mis.Attr1 = myInternalStruct[0][\"attr1\"].(bool)\n    mis.Attr2 = myInternalStruct[0][\"attr2\"].(string)\n\n    type myWholeStruct struct {\n        MyBool      bool        `json:\"onebool\"`\n        MyArray     []fcS       `json:\"onearray\"`\n        MyInter     misS        `json:\"internalstruct\"`\n    }\n    outp := myWholeStruct{\n        myBool,\n        fcs,\n        mis,\n    }\n    o, _ := json.Marshal(outp)\n    writeStringToFile(string(o), fname, false)\n}\n</code></pre>\n\n<p>Well, I expect the create function to create a file with the name taken from the name attribute, and the data a JSON representation of the values of the other Terraform attributes. Instead I am getting errors as specified above.</p>\n"}, {"tags": ["go", "performance-testing"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1558524684, "post_id": 56255211, "comment_id": 99128352, "body": "Note that these are rounded values: If your benchmark allocates e.g. only every second iteration (e.g. 50 allocs in total) allocs/op will be in your case 50/100 = 0. (BTW: No need to worry about 100 bytes/op on a 18 ms/op algorithm.)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1558524763, "post_id": 56255211, "comment_id": 99128387, "body": "@Volker That&#39;s what I wanted to add, maybe this question deserves reopening."}], "answers": [{"comments": [{"owner": {"reputation": 291, "user_id": 4284117, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ORISLUQpX_U/AAAAAAAAAAI/AAAAAAAAARg/y8eeP54sOTs/photo.jpg?sz=128", "display_name": "Kris Kwiatkowski", "link": "https://stackoverflow.com/users/4284117/kris-kwiatkowski"}, "edited": false, "score": 0, "creation_date": 1558535798, "post_id": 56256892, "comment_id": 99135199, "body": "Thanks @icza. This is great answer"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 8, "last_activity_date": 1558537506, "last_edit_date": 1592644375, "creation_date": 1558528325, "answer_id": 56256892, "question_id": 56255211, "link": "https://stackoverflow.com/questions/56255211/output-from-benchmem/56256892#56256892", "title": "Output from benchmem", "body": "<p>The benchmark results are gathered in a value of type <a href=\"https://golang.org/pkg/testing/#BenchmarkResult\" rel=\"noreferrer\"><code>testing.BenchmarkResult</code></a>:</p>\n<pre><code>type BenchmarkResult struct {\n        N         int           // The number of iterations.\n        T         time.Duration // The total time taken.\n        Bytes     int64         // Bytes processed in one iteration.\n        MemAllocs uint64        // The total number of memory allocations; added in Go 1.1\n        MemBytes  uint64        // The total number of bytes allocated; added in Go 1.1\n}\n</code></pre>\n<p>And the values you see for the allocated memory and allocations per op are returned by <a href=\"https://golang.org/pkg/testing/#BenchmarkResult.AllocedBytesPerOp\" rel=\"noreferrer\"><code>BencharkResult.AllocedBytesPerOp()</code></a> and <a href=\"http://AllocsPerOp\" rel=\"noreferrer\"><code>BenchmarkResult.AllocsPerOp()</code></a>. They document that the return values are:</p>\n<blockquote>\n<p>AllocedBytesPerOp returns <strong>r.MemBytes / r.N</strong>.</p>\n<p>AllocsPerOp returns <strong>r.MemAllocs / r.N</strong>.</p>\n</blockquote>\n<p>So the result is an integer division. Which means that if a benchmarked function performs different number of allocations in different calls, the result may not be an integer, but the fraction part is thrown away (this is how integer division works).</p>\n<p>So if in average a function performs less than 1 allocations, you will see <code>0 allocs/op</code>, but the allocated memory may be greater than 0 if its average is at least 1 byte per call.</p>\n<p>Let's see an example:</p>\n<pre><code>var (\n    counter   int\n    falseCond bool // Always false at runtime\n)\n\nfunc AvgHalfAllocs() {\n    counter++\n    if counter%2 == 0 {\n        return\n    }\n    buf := make([]byte, 128)\n    if falseCond {\n        fmt.Println(buf)\n    }\n}\n\nfunc AvgOneAndHalfAllocs() {\n    for i := 0; i &lt; 3; i++ {\n        AvgHalfAllocs()\n    }\n}\n</code></pre>\n<p>Here <code>AvgHalfAllocs()</code> does half allocation per call on average, it does it by returning from half of the calls without allocating anything, and doing exactly 1 allocation in the other half of the calls.</p>\n<p><code>AvgOneAndHalfAllocs()</code> does 1.5 allocations per call on average, because it calls <code>AvgHalfAllocs()</code> 3 times.</p>\n<p><sup>The purpose of the <code>falseCond</code> variable and the <code>fmt.Println()</code> call is just so the compiler does not optimize away our allocation, but <code>fmt.Println()</code> will never be called, so it won't interfere with the allocations.</sup></p>\n<p>Benchmarking the above 2 functions like this:</p>\n<pre><code>func BenchmarkAvgHalfAllocs(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        AvgHalfAllocs()\n    }\n}\n\nfunc BenchmarkAvgOneAndHalfAllocs(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        AvgOneAndHalfAllocs()\n    }\n}\n</code></pre>\n<p>And the results are:</p>\n<pre><code>BenchmarkAvgHalfAllocs-4          50000000    29.2 ns/op    64 B/op   0 allocs/op\nBenchmarkAvgOneAndHalfAllocs-4    20000000    92.0 ns/op   192 B/op   1 allocs/op\n</code></pre>\n<p>As you can see, 0.5 allocations per call is truncated to <code>0</code> in case of <code>AvgHalfAllocs()</code>, and 1.5 is truncated to 1 in case of <code>AvgOneAndHalfAllocs()</code>.</p>\n<p>The average allocated memory in case of <code>AvgHalfAllocs()</code> is 0.5 * 128 bytes = 64 bytes.</p>\n<p>The average allocated memory in case of <code>AvgOneAndHalfAllocs()</code> is 1.5 * 128 bytes = 192 bytes.</p>\n"}], "owner": {"reputation": 291, "user_id": 4284117, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ORISLUQpX_U/AAAAAAAAAAI/AAAAAAAAARg/y8eeP54sOTs/photo.jpg?sz=128", "display_name": "Kris Kwiatkowski", "link": "https://stackoverflow.com/users/4284117/kris-kwiatkowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 643, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1558537506, "creation_date": 1558522432, "question_id": 56255211, "link": "https://stackoverflow.com/questions/56255211/output-from-benchmem", "title": "Output from benchmem", "body": "<p>I see following output when running benchmarking with memory profiler</p>\n\n<pre><code>SomeFunc             100      17768876 ns/op         111 B/op          0 allocs/op\n</code></pre>\n\n<p>I don't understand the output - 0 allocs/op but there are 111 B allocated? Any idea what it means? Does my function allocate memory on heap or not?</p>\n"}, {"tags": ["go", "jwt", "mutex"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1558520307, "post_id": 56254028, "comment_id": 99125956, "body": "Of course. But when in doubt: Run it under the race detector."}], "answers": [{"tags": [], "owner": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "is_accepted": false, "score": 0, "last_activity_date": 1558518982, "creation_date": 1558518982, "answer_id": 56254130, "question_id": 56254028, "link": "https://stackoverflow.com/questions/56254028/do-i-need-a-mutex-when-replacing-the-value-of-a-string-in-different-goroutines/56254130#56254130", "title": "Do I need a mutex when replacing the value of a string in different goroutines?", "body": "<p>Yes, you could also try to run this test with <code>-race</code> flag enabled. Go's race detector will probably tell you that token is a shared variable across multiple goroutines. Thus, it must be protected with a <code>Mutex</code> or <code>RWMutex</code>.</p>\n\n<p>In your case I think that <code>RWMutex</code> is more appropriate because there is one goroutine that changes (i.e. write) the state of <code>token</code> every 30 mins and another goroutine that reads its value.</p>\n\n<p>If you don't protect the shared variable with a lock, the second goroutine might read an old value of <code>token</code>, that could be expired.</p>\n"}, {"comments": [{"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "edited": false, "score": 0, "creation_date": 1558519529, "post_id": 56254145, "comment_id": 99125559, "body": "thanks a lot. You&#39;re right, the token is not a field of my structure, so do I need to use a simple &quot;standalone&quot; mutex inside the code directly ?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "edited": false, "score": 0, "creation_date": 1558519602, "post_id": 56254145, "comment_id": 99125592, "body": "@Elwyn Put the mutex next to the <code>token</code> variable. If you have this pattern used in multiple places of your app, consider making a struct type wrapping the string field and the mutex protecting it, and you may even add methods to ensure safe concurrent reads / writes. For a nice example, see <a href=\"https://stackoverflow.com/questions/44949467/when-do-you-embed-mutex-in-struct-in-go/44950096#44950096\">When do you embed mutex in struct in Go?</a>"}, {"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "edited": false, "score": 0, "creation_date": 1558519738, "post_id": 56254145, "comment_id": 99125656, "body": "this is where I am getting lost, how a simple mutex variable, next to the <code>token, err := c.authenticate(c.clientID, c.email, c.password)</code> is protecting it ? I perfectly see the power of mutex when it is nested into a struct and protecting it, but in this case... I am lost."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "edited": false, "score": 0, "creation_date": 1558520205, "post_id": 56254145, "comment_id": 99125896, "body": "@Elwyn Putting it next to <code>token</code> does not protect the <code>token</code> variable. Neither does wrapping them in a struct. <i>Using</i> the mutex properly is what protects the variable. You should put it next to <code>token</code> just so you know the <i>purpose</i> of that mutex is to protect the <code>token</code> variable."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1558519378, "last_edit_date": 1558519378, "creation_date": 1558519036, "answer_id": 56254145, "question_id": 56254028, "link": "https://stackoverflow.com/questions/56254028/do-i-need-a-mutex-when-replacing-the-value-of-a-string-in-different-goroutines/56254145#56254145", "title": "Do I need a mutex when replacing the value of a string in different goroutines?", "body": "<p>The rule is simple: if a variable is accessed from multiple goroutines and at least one of them is a write, explicit synchronization is needed.</p>\n\n<p>This is true in your case: one of your goroutine writes the <code>token</code> variable (and also the <code>err</code> variable!), and another reads it, so you must synchronize access.</p>\n\n<p>Since <code>token</code> is not a field of the <code>threatq</code> structure, putting the mutex that protects it would not be wise. Always put the mutex close to the data it ought to protect.</p>\n\n<p>Some notes: as mentioned earlier, you also write and read the local <code>err</code> variable from multiple goroutines. You should not do this, instead create another local variable to hold the error from other goroutines (unless you want to \"translfer\" the error between goroutines, but this is not the case here).</p>\n\n<p>See related questions:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/51249918/immutability-of-string-and-concurrency/51250031#51250031\">Immutability of string and concurrency</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/55237513/should-we-synchronize-variable-assignment-in-goroutine/55237764#55237764\">Should we synchronize variable assignment in goroutine?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/51301328/golang-struct-concurrent-read-and-write-without-lock-is-also-running-ok/51301572#51301572\">golang struct concurrent read and write without Lock is also running ok?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/49444734/reading-values-from-a-different-thread/49445102#49445102\">Reading values from a different thread</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/46233680/why-does-this-code-cause-data-race/46233837#46233837\">Why does this code cause data race?</a></p>\n"}], "owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 515, "favorite_count": 0, "accepted_answer_id": 56254145, "answer_count": 2, "score": 1, "last_activity_date": 1558519378, "creation_date": 1558518628, "last_edit_date": 1558519188, "question_id": 56254028, "link": "https://stackoverflow.com/questions/56254028/do-i-need-a-mutex-when-replacing-the-value-of-a-string-in-different-goroutines", "title": "Do I need a mutex when replacing the value of a string in different goroutines?", "body": "<p>Do I need a mutex in this case? I am refreshing the token with a goroutine, the token is used in another goroutine. In other words, will my token be empty at some point so that the response will be a <code>401</code>?</p>\n\n<p>If yes, is it part of the structure <code>c *threatq</code> or is it a simple variable, I mean, a \"standalone\" one inside my code.</p>\n\n<pre><code>// IndicatorChannelIterator returns indicators from ThreatQ into a channel.\nfunc (c *threatq) IndicatorChannelIterator() (&lt;-chan *models.Indicator, error) {\n    // Authenticate\n    token, err := c.authenticate(c.clientID, c.email, c.password)\n    if err != nil {\n        return nil, fmt.Errorf(\"Error while authenticating to TQ : %s\", err)\n    }\n\n    // Periodically refresh the token\n    ticker := time.NewTicker(30 * time.Minute)\n    go func() {\n        for range ticker.C {\n            token, err = c.authenticate(c.clientID, c.email, c.password)\n            if err != nil {\n                logrus.Errorf(\"Error while authenticating to TQ : %s\", err)\n            }\n        }\n    }()\n\n    // Prepare the query\n    query := &amp;Query{}\n\n    // Get the first page\n    firstTQResponse, err := c.advancedSearch(query, token, 0)\n    if err != nil {\n        return nil, fmt.Errorf(\"Error while getting the first page from TQ : %s\", err)\n    }\n\n    // Create the channel\n    indicators := make(chan *models.Indicator)\n\n    // Request the others\n    go func() {\n        req := 1\n        total := firstTQResponse.Total\n        for offset := 0; offset &lt; total; offset += c.perPage {    \n            // Search the indicators\n            tqResponse, err := c.advancedSearch(query, token, offset)\n            if err != nil {\n                logrus.Errorf(\"Error while getting the indicators from TQ : %s\", err)\n                continue\n            }\n\n...\n</code></pre>\n"}, {"tags": ["go", "concurrency"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1558515158, "post_id": 56252711, "comment_id": 99123041, "body": "There is only one way to write to a channel, therefore there is only one way to write to a channel from multiple goroutines, and that is simply to write to the channel from multiple goroutines. So I don&#39;t really understand your question."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1558515481, "post_id": 56252711, "comment_id": 99123245, "body": "What you did is perfectly fine. See possible duplicate: <a href=\"https://stackoverflow.com/questions/34283255/closing-channel-of-unknown-length/34283635#34283635\">Closing channel of unknown length</a>. In general, the sender should close the channel. If there are multiple senders, you need coordination to only close the channel in one place, only once, and only when all senders are done with their job."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1558516211, "post_id": 56252711, "comment_id": 99123654, "body": "One thing you forgot in your code: <code>doStuff()</code> should call <code>wg.Done()</code>, preferably deferred."}, {"owner": {"reputation": 17, "user_id": 11538154, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qS1jQ8XmBec/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAEQu8cugCuTajqnwit0mhcA0x1iQ/mo/photo.jpg?sz=128", "display_name": "\u0412\u043b\u0430\u0434\u0438\u043c\u0438\u0440 \u0421\u0430\u0432\u043e\u0441\u0442\u0438\u043d", "link": "https://stackoverflow.com/users/11538154/%d0%92%d0%bb%d0%b0%d0%b4%d0%b8%d0%bc%d0%b8%d1%80-%d0%a1%d0%b0%d0%b2%d0%be%d1%81%d1%82%d0%b8%d0%bd"}, "edited": false, "score": 0, "creation_date": 1558612267, "post_id": 56252711, "comment_id": 99163664, "body": "Thank you! Yes my way is work fine (of course, there is <code>wg.Done()</code> is absent ). I only want to know is it the idiomatic? or there is more graceful way exists?"}], "answers": [{"tags": [], "owner": {"reputation": 2859, "user_id": 6225565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iqBej.jpg?s=128&g=1", "display_name": "Shalauddin Ahamad Shuza", "link": "https://stackoverflow.com/users/6225565/shalauddin-ahamad-shuza"}, "is_accepted": false, "score": 1, "last_activity_date": 1558521623, "creation_date": 1558521623, "answer_id": 56254962, "question_id": 56252711, "link": "https://stackoverflow.com/questions/56252711/how-to-write-to-the-same-channel-from-multiple-goroutines/56254962#56254962", "title": "How to write to the same channel from multiple goroutines", "body": "<p>As you are using <code>WaitGroup</code> and increase the counter at the time of starting new goroutine, you have to notify <code>WaitGroup</code> when a goroutine is finished by calling the <code>Done()</code> method. Also you have to pass the same <code>WaitGroup</code> to the goroutine. You can do it by passing the address of <code>WaitGroup</code>. Otherwise each goroutine will use it's own <code>WaitGroup</code> which will be on different scope.</p>\n\n<pre><code>func main() {\n    ch := make(chan data)\n    wg := &amp;sync.WaitGroup{}\n    for _, instance := range dataSet {\n        wg.Add(1)\n        go doStuff(ch, instance, wg)\n    }\n    go func() {\n        wg.Wait()\n        close(ch)\n    }()\n\n    for v := range ch { //range until it closes\n        //proceed v\n    }\n}\n\nfunc doStuff(ch chan data, instance data, wg *sync.WaitGroup) {\n    //do some stuff with instance...\n    ch &lt;- instance\n\n    // call done method to decrease the counter of WaitGroup\n    wg.Done()\n}\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 11538154, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qS1jQ8XmBec/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAEQu8cugCuTajqnwit0mhcA0x1iQ/mo/photo.jpg?sz=128", "display_name": "\u0412\u043b\u0430\u0434\u0438\u043c\u0438\u0440 \u0421\u0430\u0432\u043e\u0441\u0442\u0438\u043d", "link": "https://stackoverflow.com/users/11538154/%d0%92%d0%bb%d0%b0%d0%b4%d0%b8%d0%bc%d0%b8%d1%80-%d0%a1%d0%b0%d0%b2%d0%be%d1%81%d1%82%d0%b8%d0%bd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 460, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558521623, "creation_date": 1558514586, "last_edit_date": 1558515681, "question_id": 56252711, "link": "https://stackoverflow.com/questions/56252711/how-to-write-to-the-same-channel-from-multiple-goroutines", "title": "How to write to the same channel from multiple goroutines", "body": "<p>I need several goroutines to write in the same channel. Then all the data is read in one place until all the goroutines complete the process. But I'm not sure how best to close this channel.</p>\n\n<p>this is my example implementation:</p>\n\n<pre><code>func main() {\n    ch := make(chan data)\n    wg := &amp;sync.WaitGroup{}\n    for instance := range dataSet {\n        wg.Add(1)\n        go doStuff(ch, instance)\n    }\n    go func() {\n        wg.Wait()\n        close(ch)\n    }()\n\n    for v := range ch { //range until it closes\n        //proceed v\n    }\n}\n\nfunc doStuff(ch chan data, instance data) {\n    //do some stuff with instance...\n    ch &lt;- instance\n}\n</code></pre>\n\n<p>but I'm not sure that it is idiomatic.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2719, "user_id": 827804, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d1268474af17b4b75c46b6503769c201?s=128&d=identicon&r=PG", "display_name": "Nigiri", "link": "https://stackoverflow.com/users/827804/nigiri"}, "edited": false, "score": 0, "creation_date": 1572413476, "post_id": 58603287, "comment_id": 103547234, "body": "I hadn&#39;t solved this problem but now I can rewrite my error handling code in the nice way you gave. Thanks!"}, {"owner": {"reputation": 2446, "user_id": 2502746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2cc7edb1b68ec59a37fef5bb99a436d?s=128&d=identicon&r=PG", "display_name": "Ian", "link": "https://stackoverflow.com/users/2502746/ian"}, "reply_to_user": {"reputation": 2719, "user_id": 827804, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d1268474af17b4b75c46b6503769c201?s=128&d=identicon&r=PG", "display_name": "Nigiri", "link": "https://stackoverflow.com/users/827804/nigiri"}, "edited": false, "score": 0, "creation_date": 1572541433, "post_id": 58603287, "comment_id": 103601207, "body": "I was researching about stack trances and stumbled on your question. It made me notice that with the <code>xerrors</code> package it&#39;s possible by using the <code>Errorf</code> function. Thank you too!"}], "tags": [], "owner": {"reputation": 2446, "user_id": 2502746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2cc7edb1b68ec59a37fef5bb99a436d?s=128&d=identicon&r=PG", "display_name": "Ian", "link": "https://stackoverflow.com/users/2502746/ian"}, "is_accepted": true, "score": 1, "last_activity_date": 1572335807, "creation_date": 1572335807, "answer_id": 58603287, "question_id": 56252621, "link": "https://stackoverflow.com/questions/56252621/any-way-to-set-xerrors-caller1-when-output-an-error-by-xerrors-errorf/58603287#58603287", "title": "Any way to set xerrors.Caller(1) when output an error by xerrors.Errorf()?", "body": "<p>I think what you want is:</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"io/ioutil\"\n\n    \"golang.org/x/xerrors\"\n)\n\nfunc doWhatever() error {\n    _, err := ioutil.ReadFile(\"\")\n    if err != nil {\n        return xerrors.Errorf(\"failed doing whatever: %w\", err)\n    }\n    return nil\n}\n\nfunc main() {\n    err := doWhatever()\n    if err != nil {\n        logError(err)\n        return\n    }\n}\n\nfunc logError(err error) {\n    fmt.Printf(\"%+v\", err)\n}\n</code></pre>\n"}], "owner": {"reputation": 2719, "user_id": 827804, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d1268474af17b4b75c46b6503769c201?s=128&d=identicon&r=PG", "display_name": "Nigiri", "link": "https://stackoverflow.com/users/827804/nigiri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 58603287, "answer_count": 1, "score": 0, "last_activity_date": 1572335807, "creation_date": 1558514248, "last_edit_date": 1558514601, "question_id": 56252621, "link": "https://stackoverflow.com/questions/56252621/any-way-to-set-xerrors-caller1-when-output-an-error-by-xerrors-errorf", "title": "Any way to set xerrors.Caller(1) when output an error by xerrors.Errorf()?", "body": "<p>Running the below code, the stack trace is outputted with the line number of <code>fmt.Print(...)</code>. But I want to output the line of <code>logError(err)</code>. I think I need to call <code>xerrors.Caller(1)</code> to do that but I don't know how. Help me.</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"io/ioutil\"\n\n    \"golang.org/x/xerrors\"\n)\n\nfunc main() {\n    _, err := ioutil.ReadFile(\"\")\n    if err != nil {\n        logError(err)\n        return\n    }\n}\n\nfunc logError(err error) {\n    fmt.Printf(\"%+v\", xerrors.Errorf(\": %w\", err))\n}\n</code></pre>\n"}, {"tags": ["windows", "go", "makefile", "cross-compiling"], "comments": [{"owner": {"reputation": 2553, "user_id": 5198756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6xLRL.png?s=128&g=1", "display_name": "ifnotak", "link": "https://stackoverflow.com/users/5198756/ifnotak"}, "edited": false, "score": 2, "creation_date": 1558517188, "post_id": 56252368, "comment_id": 99124246, "body": "Every command in <code>song-build-lin</code> is executing in a separate subshell. Add a semincolon <code>;</code> and a backslash `\\` after each line to group the execution in one subshell"}, {"owner": {"reputation": 856, "user_id": 522005, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e410fd984af8198028c1c4495f7bf69?s=128&d=identicon&r=PG", "display_name": "Vahid Jafari", "link": "https://stackoverflow.com/users/522005/vahid-jafari"}, "reply_to_user": {"reputation": 2553, "user_id": 5198756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6xLRL.png?s=128&g=1", "display_name": "ifnotak", "link": "https://stackoverflow.com/users/5198756/ifnotak"}, "edited": false, "score": 0, "creation_date": 1558519251, "post_id": 56252368, "comment_id": 99125404, "body": "I changed commands to <code>set GOOS=linux;\\   set GOARCH=amd64;\\ </code>but still not working!"}, {"owner": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 1, "creation_date": 1558534227, "post_id": 56252368, "comment_id": 99134231, "body": "If you&#39;re using msys/make then your SHELL is /bin/sh. It has different syntax for assigning environment variables. I.e. remove &quot;set&quot;."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1558534448, "post_id": 56252368, "comment_id": 99134362, "body": "Or use <code>env</code>, e.g. <code>env GOOS=linux GOARCH=amd64 $(GOBUILD)...</code>"}], "answers": [{"tags": [], "owner": {"reputation": 856, "user_id": 522005, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e410fd984af8198028c1c4495f7bf69?s=128&d=identicon&r=PG", "display_name": "Vahid Jafari", "link": "https://stackoverflow.com/users/522005/vahid-jafari"}, "is_accepted": true, "score": 4, "last_activity_date": 1570888483, "creation_date": 1570888483, "answer_id": 58354861, "question_id": 56252368, "link": "https://stackoverflow.com/questions/56252368/makefile-not-set-goos-environment-variable/58354861#58354861", "title": "Makefile not set GOOS environment variable", "body": "<p>I found the answer finally,</p>\n\n<p>I run make command using VSCode terminal, the terminal type that I used, was Command Prompt. If you change the terminal type to Git bash, commands work correctly.</p>\n"}], "owner": {"reputation": 856, "user_id": 522005, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e410fd984af8198028c1c4495f7bf69?s=128&d=identicon&r=PG", "display_name": "Vahid Jafari", "link": "https://stackoverflow.com/users/522005/vahid-jafari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 521, "favorite_count": 0, "accepted_answer_id": 58354861, "answer_count": 1, "score": 3, "last_activity_date": 1570888483, "creation_date": 1558513510, "last_edit_date": 1558519514, "question_id": 56252368, "link": "https://stackoverflow.com/questions/56252368/makefile-not-set-goos-environment-variable", "title": "Makefile not set GOOS environment variable", "body": "<p>I write below Makefile to build Golang code for different platforms. (My OS is Windows 10 and run Makefile through command prompt)</p>\n\n<pre><code>GOCMD   =  go\nGOBUILD =  $(GOCMD)  build\nGOFILES =   $(wildcard *.go)\nSONG_PATH =  ./song-service\nSONG_PATH_OUTPOUT =  ./song-service/cmd\nSONG_BINARY_NAME_LIN =  songservice_lin\n\nsong-build-lin:\n    set GOOS=linux\n    set GOARCH=amd64\n    $(GOBUILD)  -o \"$(SONG_PATH_OUTPOUT)/$(SONG_BINARY_NAME_LIN)\" -v \"$(SONG_PATH)/$(GOFILES)\"\n</code></pre>\n\n<p>When I run <code>make song-build-lin</code> it runs without error but GOOS variable doesn't set.\nBut when I run <code>set GOOS=linux</code> in command prompt directly it works!</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1558526821, "last_edit_date": 1558526821, "creation_date": 1558504904, "answer_id": 56250240, "question_id": 56249990, "link": "https://stackoverflow.com/questions/56249990/why-write-channel-blocked-in-spite-of-a-goroutine-is-selecting-on-this-channel/56250240#56250240", "title": "Why write channel blocked in spite of a goroutine is selecting on this channel?", "body": "<p>The <a href=\"https://golang.org/ref/spec#Select_statements\" rel=\"nofollow noreferrer\">specification says</a>:</p>\n\n<blockquote>\n  <p>For all the cases in the statement, the channel operands of receive operations and the channel and right-hand-side expressions of send statements are evaluated exactly once, in source order, upon entering the \"select\" statement. The result is a set of channels to receive from or send to, and the corresponding values to send. Any side effects in that evaluation will occur irrespective of which (if any) communication operation is selected to proceed. </p>\n</blockquote>\n\n<p>The set of channels for the select in goroutine A waits on the evaluation of <code>sendRPC()</code>.  It may help to look at this equivalent goroutine:</p>\n\n<pre><code>go func() { // goroutine A\n    v := sendRPC()  // waits for 5 seconds\n    select {\n    case ch &lt;- v:\n        fmt.Println(\"RPC return\")\n    case &lt;-done:\n        fmt.Println(\"exit\")\n    }\n}()\n</code></pre>\n\n<p>The receive on <code>done</code> is delayed for 5 seconds.</p>\n"}], "owner": {"reputation": 35, "user_id": 9156254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14affbe79515fe703175b4e77a66590a?s=128&d=identicon&r=PG&f=1", "display_name": "hhdidid", "link": "https://stackoverflow.com/users/9156254/hhdidid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 56250240, "answer_count": 1, "score": 1, "last_activity_date": 1558526821, "creation_date": 1558503593, "last_edit_date": 1558512859, "question_id": 56249990, "link": "https://stackoverflow.com/questions/56249990/why-write-channel-blocked-in-spite-of-a-goroutine-is-selecting-on-this-channel", "title": "Why write channel blocked in spite of a goroutine is selecting on this channel?", "body": "<p>I am confused about the following code, I write down some comment in the code which point out my confusion. And there is a result of execution at the end of the code, I also write down what result I expect.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc sendRPC() bool {\n    time.Sleep(5 * time.Second)\n    return true\n}\n\nfunc main() {\n    done := make(chan struct{})\n    ch := make(chan bool)\n\n    go func() { // goroutine A\n        select {\n        case ch &lt;- sendRPC():\n            fmt.Println(\"RPC return\")\n        case &lt;-done:\n            fmt.Println(\"exit\")\n        }\n    }()\n\n    select {\n    case &lt;-ch:\n    case &lt;-time.After(1000 * time.Millisecond):\n        fmt.Println(\"timeout\")\n        if len(done) == 0 {\n            fmt.Println(\"1\")\n            // here write done channel will block until sendRPC() return, why?\n            // I expect that the write is nonblock because goroutine A is select on done channel.\n            done &lt;- struct{}{}\n            fmt.Println(\"2\")\n        }\n    }\n\n    // result:\n    // timeout (after about 1 second)\n    // 1\n    // exit    (after about 5 seconds, I expect that it is printed after about 1 second too.)\n    // 2\n\n}\n\n</code></pre>\n"}, {"tags": ["go", "channel"], "comments": [{"owner": {"reputation": 181, "user_id": 4873694, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/fba1ba75bad8a2ca29c277ec849738c2?s=128&d=identicon&r=PG&f=1", "display_name": "RezaOptic", "link": "https://stackoverflow.com/users/4873694/rezaoptic"}, "edited": false, "score": 2, "creation_date": 1558504557, "post_id": 56249851, "comment_id": 99117755, "body": "this blog explained your problem  <a href=\"https://yourbasic.org/golang/detect-deadlock/\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1558506751, "post_id": 56249851, "comment_id": 99118648, "body": "The second case doesn&#39;t &quot;work&quot;. It just exits before a deadlock is possible. Why would you ever want to <i>only send</i> to a channel?"}, {"owner": {"reputation": 705, "user_id": 3327209, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Zf6KK.jpg?s=128&g=1", "display_name": "Abhishek Jha", "link": "https://stackoverflow.com/users/3327209/abhishek-jha"}, "edited": false, "score": 0, "creation_date": 1558506847, "post_id": 56249851, "comment_id": 99118702, "body": "that link explains the first part. But then going by that logic then it should have been stuck for someone to read value in second case as well"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1558507132, "post_id": 56249851, "comment_id": 99118834, "body": "Each goroutine <i>is</i> blocked. But your program exits before that&#39;s reported."}], "answers": [{"comments": [{"owner": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1558526623, "post_id": 56250702, "comment_id": 99129393, "body": "is it still a deadlock when 1 thread is continuing? the way i say it 2 goroutines are leaked but it is not a deadlco ksince the main thread keeps going without problems"}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 2, "last_activity_date": 1558507107, "creation_date": 1558507107, "answer_id": 56250702, "question_id": 56249851, "link": "https://stackoverflow.com/questions/56249851/go-workflow-when-only-sending-values-to-channel/56250702#56250702", "title": "Go workflow when only sending values to channel", "body": "<p>Neither example works. In fact, no example that <em>only</em> sends to a channel will ever work, in any traditional sense of \"work\".</p>\n\n<p>But here's a step through of each, to make it clear:</p>\n\n<h2>First example</h2>\n\n<pre><code>ch := make(chan int)\n</code></pre>\n\n<p>This creates an unbuffered channel. Unbuffered channels don't hold any data, they only act as a conduit for communication--all data sent must be received by something else, before the program execution proceeds--on either side of the channel.</p>\n\n<pre><code>ch &lt;- 1\n</code></pre>\n\n<p>Here you send data on the channel, but nothing is waiting to receive it, so the program waits. In this case, it waits forever, because you never created a receiver for the channel, thus your deadlock.</p>\n\n<h2>Second example</h2>\n\n<pre><code>c := make(chan int)\n</code></pre>\n\n<p>Again, create an unbuffered channel.</p>\n\n<pre><code>go sum(s[:len(s)/2], c)\n</code></pre>\n\n<p>Call the <code>sum</code> function, which, incidentally, will also block forever, for the reasons described above--nothing is receiving on the channel, so it will wait forever.  However, in this case, you've called it in a goroutine. The goroutine will run in a separate execution thread, while other bits of the program run. Although, due to never receiving data from the channel, this goroutine will never exit, until the main program exits.</p>\n\n<pre><code>go sum(s[len(s)/2:], c)\n</code></pre>\n\n<p>Again, you call <code>sum</code>, and again, in a goroutine. So at this point, you have three gorotuines: One running <code>main()</code>, and one each running an invocation of <code>sum()</code>. The latter two will never exit.</p>\n\n<p>Then your program exits. When the program exits, all goroutines (including the two that are stuck forever waiting on your channel) exit.</p>\n\n<p>Since this program exits immediately, the deadlock is never reported, but it does assuredly exist, same as in your first example.</p>\n"}], "owner": {"reputation": 705, "user_id": 3327209, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Zf6KK.jpg?s=128&g=1", "display_name": "Abhishek Jha", "link": "https://stackoverflow.com/users/3327209/abhishek-jha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 56250702, "answer_count": 1, "score": -3, "last_activity_date": 1558512957, "creation_date": 1558502866, "last_edit_date": 1558512957, "question_id": 56249851, "link": "https://stackoverflow.com/questions/56249851/go-workflow-when-only-sending-values-to-channel", "title": "Go workflow when only sending values to channel", "body": "<p>I am learning channels in Go by following this <a href=\"https://tour.golang.org/concurrency\" rel=\"nofollow noreferrer\">tutorial</a>.\nWhen I only send value to a channel it gives error. Here is the example code.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n  ch := make(chan int)\n  ch &lt;- 1\n\n  fmt.Println(\"Does not work\")\n}\n</code></pre>\n\n<p>Here I am just sending value to the channel but not receiving anything. It give an error </p>\n\n<pre><code>fatal error: all goroutines are asleep - deadlock! \n</code></pre>\n\n<p>But when I run following code it doesn't give any error</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc sum(s []int, c chan int) {\n    sum := 0\n    for _, v := range s {\n        sum += v\n    }\n    c &lt;- sum // send sum to c\n}\n\nfunc main() {\n    s := []int{7, 2, 8, -9, 4, 0}\n\n    c := make(chan int)\n    go sum(s[:len(s)/2], c)\n    go sum(s[len(s)/2:], c)\n\n    fmt.Println(\"did not receive but still works\")\n}\n</code></pre>\n\n<p>and prints </p>\n\n<pre><code>did not receive but still works\n</code></pre>\n\n<p>I couldn't understand why it works in second case while it does not work in first case. Even though I have not received any value for the channel in both cases. Also what is causing the deadlock in first case and how it gets avoided in second case? </p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-platform"], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 8830325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7dbff4e64a309136646ae3d515f20ea?s=128&d=identicon&r=PG&f=1", "display_name": "hanord", "link": "https://stackoverflow.com/users/8830325/hanord"}, "is_accepted": false, "score": 6, "last_activity_date": 1560709058, "last_edit_date": 1560709058, "creation_date": 1560702263, "answer_id": 56620669, "question_id": 56249339, "link": "https://stackoverflow.com/questions/56249339/what-is-the-correct-context-for-appengine-taskqueue-in-go112-standard-runtime/56620669#56620669", "title": "What is the correct context for appengine taskqueue in go112 standard runtime", "body": "<p>I experienced the same problems when migrating a GAE standard project from go19 to go112 in order to use go modules. In addition I got a lot of \"502 bad gateway\" messages.</p>\n\n<p>Replacing http.ListenAndServe() in main() with <strong>appengine.Main()</strong> fixed the context problem. Moving to <strong>go111</strong> instead of 112 took care of the other issue. The docs and examples are not very clear on this.</p>\n"}, {"comments": [{"owner": {"reputation": 463, "user_id": 1474495, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a9fc74a4e39e82aca03da5aa2c1426fb?s=128&d=identicon&r=PG", "display_name": "Hunor Kov&#225;cs", "link": "https://stackoverflow.com/users/1474495/hunor-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1571002149, "post_id": 56833151, "comment_id": 103086012, "body": "I think this worked for me, downgraded from go112 to go111 and there are no more <code>internal.flushLog: Flush RPC: service bridge HTTP failed: Post http:&#47;&#47;appengine.googleapis.internal:10001&#47;rpc_http: dial tcp 169.254.169.253:10001: i&#47;o timeout</code> problems. Previously I had 10s timeouts exactly, now my responses come at 200ms."}], "tags": [], "owner": {"reputation": 17696, "user_id": 84118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/49489bce90d3514596cb1ed0ead0d0db?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/84118/jay"}, "is_accepted": false, "score": 2, "last_activity_date": 1561973276, "creation_date": 1561973276, "answer_id": 56833151, "question_id": 56249339, "link": "https://stackoverflow.com/questions/56249339/what-is-the-correct-context-for-appengine-taskqueue-in-go112-standard-runtime/56833151#56833151", "title": "What is the correct context for appengine taskqueue in go112 standard runtime", "body": "<p>The <a href=\"https://cloud.google.com/appengine/docs/standard/go112/go-differences\" rel=\"nofollow noreferrer\">documentation for migration to 1.12</a> states:</p>\n\n<blockquote>\n  <p>Use Cloud Tasks to enqueue tasks from Go 1.12 using the cloudtasks package. You can use any App Engine service as the target of an App Engine task.</p>\n</blockquote>\n\n<p>But the cloudtasks package documentation (as at today\u2019s date) is <a href=\"https://godoc.org/cloud.google.com/go/cloudtasks/apiv2beta3\" rel=\"nofollow noreferrer\">clearly marked as beta and unstable</a>. So the answer here is probably. This feature is unsupported. </p>\n\n<p>That said, I\u2019m using it in production under go111 without any serious issue that I have noticed so far.</p>\n"}, {"tags": [], "owner": {"reputation": 627, "user_id": 1086647, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14e5b65b387ab3a473ff1b116f9c0934?s=128&d=identicon&r=PG", "display_name": "blamblambunny", "link": "https://stackoverflow.com/users/1086647/blamblambunny"}, "is_accepted": false, "score": 0, "last_activity_date": 1609783644, "creation_date": 1609783644, "answer_id": 65567621, "question_id": 56249339, "link": "https://stackoverflow.com/questions/56249339/what-is-the-correct-context-for-appengine-taskqueue-in-go112-standard-runtime/65567621#65567621", "title": "What is the correct context for appengine taskqueue in go112 standard runtime", "body": "<p>You're seeing <code>internal.flushLog: Flush RPC: service bridge HTTP failed</code> because you have <code>appengine.Main()</code> or other <code>appengine</code> lib calls while trying to run a Go 1.12+ runtime. (My guess is that the older runtime had to call into some Google-internal accounting infrastructure and that's not available for the 1.12 &quot;next gen&quot; systems.)</p>\n<p>The solution isn't to downgrade your Go versions -- you're missing a ton of performance and security improvements doing that, and you can't take advantage of the new hardware -- the solution is to remove all the calls to the <code>appengine</code> lib and use GCP's cloud libraries instead (see <a href=\"https://godoc.org/cloud.google.com/go\" rel=\"nofollow noreferrer\">https://godoc.org/cloud.google.com/go</a>)</p>\n"}], "owner": {"reputation": 6586, "user_id": 256405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/420ecb69f4d50ee66160e01e4071be6e?s=128&d=identicon&r=PG", "display_name": "Morrowless", "link": "https://stackoverflow.com/users/256405/morrowless"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 715, "favorite_count": 2, "answer_count": 3, "score": 3, "last_activity_date": 1609783644, "creation_date": 1558499435, "question_id": 56249339, "link": "https://stackoverflow.com/questions/56249339/what-is-the-correct-context-for-appengine-taskqueue-in-go112-standard-runtime", "title": "What is the correct context for appengine taskqueue in go112 standard runtime", "body": "<p>I cannot get the appengine taskqueue to accept any context I throw at it:</p>\n\n<pre><code>import (\n    \"context\"\n    \"google.golang.org/appengine\"\n    \"google.golang.org/appengine/taskqueue\"\n)\n\n   /* snip */\n\n    ctx:= context.Background()\n    task := taskqueue.NewPOSTTask(\"/b/mytask\", params)\n    _, err = taskqueue.Add(ctx, task, \"\")\n    if err != nil {\n        return fmt.Errorf(\"adding background task with path %s: %v\", task.Path, err)\n    }\n</code></pre>\n\n<p>I'm calling appengine.Main() in my main.go main func as stated by the <a href=\"https://cloud.google.com/appengine/docs/standard/go111/go-differences\" rel=\"nofollow noreferrer\">go111 migration docs</a> (But this line is missing in <a href=\"https://cloud.google.com/appengine/docs/standard/go112/go-differences\" rel=\"nofollow noreferrer\">go112 migration docs</a> so I'm not sure it's required).</p>\n\n<p>I've tried:</p>\n\n<pre><code>context.Background()\nrequest.Context()\nappengine.NewContext(r)\nappengine.BackgroundContext()\ncontext.TODO()\n</code></pre>\n\n<p>All result in error: </p>\n\n<blockquote>\n  <p>not an App Engine context</p>\n</blockquote>\n\n<p>except for <code>appengine.BackgroundContext()</code> which gets: </p>\n\n<blockquote>\n  <p>service bridge HTTP failed: Post\n  <a href=\"http://appengine.googleapis.internal:10001/rpc_http\" rel=\"nofollow noreferrer\">http://appengine.googleapis.internal:10001/rpc_http</a>: dial tcp\n  169.254.169.253:10001: i/o timeout</p>\n</blockquote>\n"}, {"tags": ["database", "go", "google-bigquery"], "answers": [{"tags": [], "owner": {"reputation": 181, "user_id": 4873694, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/fba1ba75bad8a2ca29c277ec849738c2?s=128&d=identicon&r=PG&f=1", "display_name": "RezaOptic", "link": "https://stackoverflow.com/users/4873694/rezaoptic"}, "is_accepted": false, "score": 2, "last_activity_date": 1558505299, "creation_date": 1558505299, "answer_id": 56250315, "question_id": 56248742, "link": "https://stackoverflow.com/questions/56248742/bigquery-fetch-1000000-records-and-do-some-process-over-data-using-golang/56250315#56250315", "title": "BigQuery - fetch 1000000 records and do some process over data using goLang", "body": "<p>you can split your query to get 10x of 100000 records and run in multiple goroutine</p>\n\n<p>use sql query like\n <code>select * from somewhere order by id DESC limit 100000 offset 0</code></p>\n\n<p>and in next goroutine <code>select * from somewhere order by id DESC limit 100000 offset 100000</code></p>\n"}, {"tags": [], "owner": {"reputation": 2691, "user_id": 212435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xAkN2.jpg?s=128&g=1", "display_name": "shollyman", "link": "https://stackoverflow.com/users/212435/shollyman"}, "is_accepted": true, "score": 3, "last_activity_date": 1558513648, "creation_date": 1558513648, "answer_id": 56252418, "question_id": 56248742, "link": "https://stackoverflow.com/questions/56248742/bigquery-fetch-1000000-records-and-do-some-process-over-data-using-golang/56252418#56252418", "title": "BigQuery - fetch 1000000 records and do some process over data using goLang", "body": "<p>You can read the table contents directly without issuing a query.  This doesn't incur query charges, and provides the same row iterator as you would get from a query.</p>\n\n<p>For small results, this is fine.  For large tables, I would suggest checking out the new <a href=\"https://cloud.google.com/bigquery/docs/reference/storage/\" rel=\"nofollow noreferrer\">storage api</a>, and the code sample on the <a href=\"https://cloud.google.com/bigquery/docs/reference/storage/samples\" rel=\"nofollow noreferrer\">samples page</a>.</p>\n\n<p>For a small table or simply reading a small subset of rows, you can do something like this (reads up to 10k rows from one of the public dataset tables):</p>\n\n<pre><code>func TestTableRead(t *testing.T) {\n    ctx := context.Background()\n    client, err := bigquery.NewClient(ctx, \"my-project-id\")\n    if err != nil {\n        t.Fatal(err)\n    }\n\n    table := client.DatasetInProject(\"bigquery-public-data\", \"stackoverflow\").Table(\"badges\")\n    it := table.Read(ctx)\n\n    rowLimit := 10000\n    var rowsRead int\n    for {\n        var row []bigquery.Value\n        err := it.Next(&amp;row)\n        if err == iterator.Done || rowsRead &gt;= rowLimit {\n            break\n        }\n\n        if err != nil {\n            t.Fatalf(\"error reading row offset %d: %v\", rowsRead, err)\n        }\n        rowsRead++\n        fmt.Println(row)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 607, "user_id": 5164776, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/999423470091088/picture?type=large", "display_name": "Chandan Kumar", "link": "https://stackoverflow.com/users/5164776/chandan-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 903, "favorite_count": 0, "accepted_answer_id": 56252418, "answer_count": 2, "score": 1, "last_activity_date": 1558513648, "creation_date": 1558494249, "question_id": 56248742, "link": "https://stackoverflow.com/questions/56248742/bigquery-fetch-1000000-records-and-do-some-process-over-data-using-golang", "title": "BigQuery - fetch 1000000 records and do some process over data using goLang", "body": "<p>I Have 1000000 records inside BigQuery. what is the best way to fetch data from DB and process using goLang? I'm getting timeout issue if fetch all the data without limit. already I increase the limit to 5min, but it takes more than 5 min. \nI want to do some streaming call or pagination implementation, But i don't know in golang how I do.</p>\n\n<pre><code>var FetchCustomerRecords = func(req *http.Request) *bigquery.RowIterator {\n    ctx := appengine.NewContext(req)\n    ctxWithDeadline, _ := context.WithTimeout(ctx, 5*time.Minute)\n    log.Infof(ctx, \"Fetch Customer records from BigQuery\")\n    client, err := bigquery.NewClient(ctxWithDeadline, \"ddddd-crm\")\n    q := client.Query(\n        \"SELECT * FROM Something\")\n\n    q.Location = \"US\"\n    job, err := q.Run(ctx)\n    if err != nil {\n        log.Infof(ctx, \"%v\", err)\n    }\n    status, err := job.Wait(ctx)\n    if err != nil {\n        log.Infof(ctx, \"%v\", err)\n\n    }\n    if err := status.Err(); err != nil {\n        log.Infof(ctx, \"%v\", err)\n    }\n    it, err := job.Read(ctx)\n\n    if err != nil {\n        log.Infof(ctx, \"%v\", err)\n    }\n    return it\n}\n</code></pre>\n"}, {"tags": ["algorithm", "sorting", "go", "search"], "comments": [{"owner": {"reputation": 155397, "user_id": 978917, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/92d059913eace78a868a3e87f98e0a57?s=128&d=identicon&r=PG", "display_name": "ruakh", "link": "https://stackoverflow.com/users/978917/ruakh"}, "edited": false, "score": 0, "creation_date": 1558487076, "post_id": 56247955, "comment_id": 99114277, "body": "Are you repeatedly calling <code>Continuous</code> on the same slice of ranges? (I ask because, if so, it might be a good idea to some preprocessing.)"}, {"owner": {"reputation": 39, "user_id": 1107128, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/564dc5548f32651077cbbbfce02fccc7?s=128&d=identicon&r=PG", "display_name": "tab1293", "link": "https://stackoverflow.com/users/1107128/tab1293"}, "reply_to_user": {"reputation": 155397, "user_id": 978917, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/92d059913eace78a868a3e87f98e0a57?s=128&d=identicon&r=PG", "display_name": "ruakh", "link": "https://stackoverflow.com/users/978917/ruakh"}, "edited": false, "score": 0, "creation_date": 1558487233, "post_id": 56247955, "comment_id": 99114308, "body": "@ruakh yes I am repeatedly calling <code>Continuous</code> on the same slice of ranges. What preprocessing techniques are you thinking of? Clarification: there are multiple static ranges that I am calling <code>Continuous</code> with."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 5, "creation_date": 1558493809, "post_id": 56247955, "comment_id": 99115356, "body": "@tab1293 Preprocessing can reduce the list of ranges by combining overlapped/adjacent ranges. So given [(0,3), (4,8), (2,7), (10,16), (12,20)], you can preprocess the list to [(0,8), (10,20)]. And then, since the ranges in the preprocessed list don&#39;t overlap, you can binary search the list."}], "answers": [{"tags": [], "owner": {"reputation": 389, "user_id": 6321432, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CpTh0.jpg?s=128&g=1", "display_name": "HolaYang", "link": "https://stackoverflow.com/users/6321432/holayang"}, "is_accepted": false, "score": 0, "last_activity_date": 1558506124, "creation_date": 1558506124, "answer_id": 56250476, "question_id": 56247955, "link": "https://stackoverflow.com/questions/56247955/how-can-i-determine-if-a-list-of-ranges-covers-a-given-range/56250476#56250476", "title": "How can I determine if a list of ranges covers a given range?", "body": "<p>Solution that is more simple?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sort\"\n)\n\ntype byteRange struct {\n    start int64\n    end   int64\n}\n\ntype byteRanges []*byteRange\n\nfunc (brs byteRanges) Continuous(start int64, end int64) bool {\n    sort.Slice(brs, func(i, j int) bool {\n        return brs[i].start &lt; brs[j].start\n    })\n\n    var (\n        longestReach int64\n        in           bool\n    )\n\n    for _, br := range brs {\n        if !in {\n            // first br satrts laying over the target\n            if br.start &lt;= start &amp;&amp; br.end &gt;= start {\n                longestReach = br.end\n                in = true\n            }\n            continue\n        }\n        if in &amp;&amp; longestReach &lt; br.start-1 {\n            break\n        }\n        if longestReach &lt; br.end {\n            longestReach = br.end\n        }\n    }\n\n    return in &amp;&amp; longestReach &gt;= end\n}\n\nfunc main() {\n    brs := byteRanges{{5, 9}, {6, 10}}\n    fmt.Println(brs.Continuous(8, 10))\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 155397, "user_id": 978917, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/92d059913eace78a868a3e87f98e0a57?s=128&d=identicon&r=PG", "display_name": "ruakh", "link": "https://stackoverflow.com/users/978917/ruakh"}, "is_accepted": false, "score": 2, "last_activity_date": 1558509179, "creation_date": 1558509179, "answer_id": 56251210, "question_id": 56247955, "link": "https://stackoverflow.com/questions/56247955/how-can-i-determine-if-a-list-of-ranges-covers-a-given-range/56251210#56251210", "title": "How can I determine if a list of ranges covers a given range?", "body": "<p>Since you will repeatedly call <code>Continuous</code> on the same set of ranges, it's a good idea to create a <code>Condense</code> method (or whatever you wish to call it) that will take a slice and return a new slice with the ranges sorted and any overlapping ranges merged. You only need to call <code>Condense</code> <em>once</em> for any given set of ranges. <code>Continuous</code> can then require that it only be called on the result of <code>Condense</code>. (To enforce this requirement, it may be a good idea to have <code>Condense</code> actually return a <code>struct</code> of a custom type that's just a wrapper around a slice, and to define <code>Continuous</code> only on that <code>struct</code> type. If you want &mdash; as a convenience &mdash; you can then define a separate <code>Continuous</code> method that <em>can</em> be called directly on slices, that invokes <code>Condense</code> and then <code>Continuous</code>. That convenience method will be slow again, of course, but it may be convenient for sets that are only checked once.)</p>\n\n<p>The merging logic in <code>Condense</code> is pretty simple:</p>\n\n<ul>\n<li>If the slice is empty, just return it (exiting early).</li>\n<li>Sort ranges by their <code>start</code>.</li>\n<li>Create a fresh slice called <code>result</code>.</li>\n<li>Initialize <code>prevRange</code> to the first range.</li>\n<li>Iterate over the ranges. For each one:\n\n<ul>\n<li>If the current range starts after <code>prevRange.end + 1</code>, add <code>prevRange</code> to <code>result</code>, then set <code>prevRange</code> to the current range.</li>\n<li>Otherwise, if the current range ends after <code>prevRange.end</code>, set <code>prevRange.end</code> to the <code>end</code> of the current range.</li>\n</ul></li>\n<li>Add <code>prevRange</code> to <code>result</code>.</li>\n</ul>\n\n<p>The logic in <code>Continuous</code> can now be:</p>\n\n<ul>\n<li>Perform a binary search over the ranges, finding the last range whose <code>start</code> is less than or equal to <code>start</code>.</li>\n<li>If this range's <code>end</code> is greater than or equal to <code>end</code>, return <code>true</code>; otherwise, return <code>false</code>.</li>\n</ul>\n"}], "owner": {"reputation": 39, "user_id": 1107128, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/564dc5548f32651077cbbbfce02fccc7?s=128&d=identicon&r=PG", "display_name": "tab1293", "link": "https://stackoverflow.com/users/1107128/tab1293"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1558509179, "creation_date": 1558486090, "question_id": 56247955, "link": "https://stackoverflow.com/questions/56247955/how-can-i-determine-if-a-list-of-ranges-covers-a-given-range", "title": "How can I determine if a list of ranges covers a given range?", "body": "<p>I want to efficiently determine whether a list of ranges covers a given range. For example the list of ranges [(0-3), (3-5), (4-8), (6-10)] covers the range (0-10) while [(5-10), (0-3)] does not. The list can contain overlaps and is not necessarily ordered. </p>\n\n<p>I tried to implement a <code>Continuous</code> function shown below which checks if the slice of byte ranges contains the given <code>start</code> and <code>end</code> of a passed range. </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type byteRange struct {\n    start int64\n    end   int64\n}\n\ntype byteRanges []*byteRange\n\nfunc (brs byteRanges) Len() int {\n    return len(brs)\n}\n\nfunc (brs byteRanges) Swap(i, j int) {\n    brs[i], brs[j] = brs[j], brs[i]\n}\n\nfunc (brs byteRanges) Less(i, j int) bool {\n    return brs[i].start &lt; brs[j].start\n}\n\nfunc (brs byteRanges) Continuous(start int64, end int64) bool {\n    curPos := start\n    sort.Sort(brs)\n\n    for _, br := range brs {\n        if br.start &gt; curPos+1 {\n            return false\n        }\n\n        if curPos &lt; br.end {\n            curPos = br.end\n        }\n\n        if curPos &gt;= end {\n            return true\n        }\n    }\n\n    return false\n}\n</code></pre>\n\n<p>The function behaves correctly but it is not very performant when working with a large list of ranges and when it is called often. Can somebody recommend an algorithm/implementation that can speed up this logic?</p>\n"}, {"tags": ["string", "go", "slice"], "answers": [{"tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": true, "score": 1, "last_activity_date": 1558488376, "creation_date": 1558488376, "answer_id": 56248171, "question_id": 56247875, "link": "https://stackoverflow.com/questions/56247875/strange-behavior-when-appending-to-2d-slice-of-strings/56248171#56248171", "title": "Strange behavior when appending to 2d slice of strings", "body": "<p>The value of <code>in</code> is never changed, so every element in <code>out</code> has that same value. <code>in</code> contains the slice header, which is a pointer to the underlying array, a length, and a capacity. You're changing the values in the array, but the slice header remains the same. I think you want to make a copy of <code>in</code> inside the for loop so you're operating on a different array every time:</p>\n\n<pre><code>for i &lt; len(in) {\n    inCopy := make([]string, len(in))\n    copy(inCopy, in)\n    in = inCopy\n    // ...\n}\n</code></pre>\n\n<p>See <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">https://blog.golang.org/go-slices-usage-and-internals</a> for an explanation of how slices work.</p>\n"}], "owner": {"reputation": 505, "user_id": 546575, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/811e8939ef03c018d4c5ff29a948c9c2?s=128&d=identicon&r=PG", "display_name": "pri0ritize", "link": "https://stackoverflow.com/users/546575/pri0ritize"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "closed_date": 1558497550, "accepted_answer_id": 56248171, "answer_count": 1, "score": 0, "last_activity_date": 1558488376, "creation_date": 1558485155, "last_edit_date": 1558487678, "question_id": 56247875, "link": "https://stackoverflow.com/questions/56247875/strange-behavior-when-appending-to-2d-slice-of-strings", "closed_reason": "Duplicate", "title": "Strange behavior when appending to 2d slice of strings", "body": "<p>I'm attempting to implement Heap's Permutation Algorithm in Go.\nIt's supposed to return all the possible permutations given an input set.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func Permute(in []string) [][]string {\n    c := make([]int, len(in))\n    out := make([][]string, 0)\n    for i := range out {\n        out[i] = make([]string, 0)\n    }\n    fmt.Println(in)\n    out = append(out, in)\n    i := 0\n    for i &lt; len(in) {\n        if c[i] &lt; i {\n            if i%2 == 0 {\n                in[0], in[i] = in[i], in[0]\n            } else {\n                in[c[i]], in[i] = in[i], in[c[i]]\n            }\n            fmt.Println(in)\n            out = append(out, in)\n            c[i]++\n            i = 0\n        } else {\n            c[i] = 0\n            i++\n        }\n    }\n    return out\n}\n</code></pre>\n\n<p>The Println statements display the expected outputs. The out value is returned with the correct number of entries, but the entries are all the same. Please help me understand what I am missing.</p>\n"}, {"tags": ["android", "go", "android-ndk", "aar", "gomobile"], "answers": [{"tags": [], "owner": {"reputation": 220, "user_id": 10176454, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZmxR2.png?s=128&g=1", "display_name": "zergon321", "link": "https://stackoverflow.com/users/10176454/zergon321"}, "is_accepted": true, "score": 0, "last_activity_date": 1563095691, "creation_date": 1563095691, "answer_id": 57026040, "question_id": 56247031, "link": "https://stackoverflow.com/questions/56247031/gomobile-library-uses-hidden-api-method/57026040#57026040", "title": "Gomobile library uses hidden API method", "body": "<p>The problem is that I debugged my application on the emulator. Apparently, it's incompatible with native libraries. Debugging on a phone is alright.</p>\n"}], "owner": {"reputation": 220, "user_id": 10176454, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZmxR2.png?s=128&g=1", "display_name": "zergon321", "link": "https://stackoverflow.com/users/10176454/zergon321"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 57026040, "answer_count": 1, "score": 1, "last_activity_date": 1563095691, "creation_date": 1558477235, "question_id": 56247031, "link": "https://stackoverflow.com/questions/56247031/gomobile-library-uses-hidden-api-method", "title": "Gomobile library uses hidden API method", "body": "<p>I have an <strong>Android</strong> application which uses a <strong>Golang</strong> library (<strong>.aar</strong>) created with <strong>Gomobile</strong>. Anytime the application tries to create an instance of a class from the library or calls a library method it crashes with the next log message:</p>\n\n<pre><code>W/om.example.cal: Accessing hidden method Landroid/app/AppGlobals;-&gt;getInitialApplication()Landroid/app/Application; (greylist, reflection, allowed)\nA/libc: Fatal signal 6 (SIGABRT), code -1 (SI_QUEUE) in tid 11110 (om.example.calc), pid 11075 (om.example.calc)\nApplication terminated.\n</code></pre>\n\n<p><code>getInitialApplication</code> method is located in <a href=\"https://android.googlesource.com/platform/frameworks/base/+/85c81cb24c5d71fc79dea3ba498d1a509895bb01/config/hiddenapi-p-light-greylist.txt\" rel=\"nofollow noreferrer\">Google's light greylist (line 349)</a>. \nI know it's impossible to access any hidden method on SDK version 28 and higher, that's why I wrote the next in <code>build.gradle</code> (26 is the least version for <strong>Play Market</strong>):</p>\n\n<pre><code>compileSdkVersion 26\nminSdkVersion 15\ntargetSdkVersion 26\nimplementation fileTree(dir: 'libs', include: ['*.jar', '*.aar'])\nimplementation 'com.android.support:appcompat-v7:26.1.0'\n</code></pre>\n\n<p>But it didn't help. How to make it work?\nRemarks: test device is <strong>Nexus S</strong> emulated on <strong>Ubuntu 18.04</strong>.</p>\n"}, {"tags": ["go", "thrift", "thrift-protocol"], "comments": [{"owner": {"reputation": 1, "user_id": 11536298, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9IUNQistBoc/AAAAAAAAAAI/AAAAAAAAAAc/Oh87LYH-W_0/photo.jpg?sz=128", "display_name": "AssasinRay", "link": "https://stackoverflow.com/users/11536298/assasinray"}, "edited": false, "score": 0, "creation_date": 1558475545, "post_id": 56246806, "comment_id": 99112100, "body": "If it cannot, is there any for go-thrift (<a href=\"https://godoc.org/github.com/apache/thrift/lib/go/thrift\" rel=\"nofollow noreferrer\">godoc.org/github.com/apache/thrift/lib/go/thrift</a>) to serialize a interface struct?"}, {"owner": {"reputation": 12067, "user_id": 499466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc0612ec9a2b6af96500cc6e4bfdc7c?s=128&d=identicon&r=PG", "display_name": "JensG", "link": "https://stackoverflow.com/users/499466/jensg"}, "edited": false, "score": 0, "creation_date": 1558517062, "post_id": 56246806, "comment_id": 99124151, "body": "Why don&#39;t you just try it?"}], "owner": {"reputation": 1, "user_id": 11536298, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9IUNQistBoc/AAAAAAAAAAI/AAAAAAAAAAc/Oh87LYH-W_0/photo.jpg?sz=128", "display_name": "AssasinRay", "link": "https://stackoverflow.com/users/11536298/assasinray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558475459, "creation_date": 1558475459, "question_id": 56246806, "link": "https://stackoverflow.com/questions/56246806/can-tbinary-protocol-decode-thrifter-encoded-data", "title": "can TBinary Protocol decode thrifter encoded data?", "body": "<p>currently I have many go structs generated by thrift and I want to fill the real data in to them and send to server. Server will use TBinaryProtocol to decode data. </p>\n\n<p>thrifter: <a href=\"https://github.com/thrift-iterator/go\" rel=\"nofollow noreferrer\">https://github.com/thrift-iterator/go</a>\nTBinaryProtocol <a href=\"https://people.apache.org/~thejas/thrift-0.9/javadoc/org/apache/thrift/protocol/TBinaryProtocol.Factory.html\" rel=\"nofollow noreferrer\">https://people.apache.org/~thejas/thrift-0.9/javadoc/org/apache/thrift/protocol/TBinaryProtocol.Factory.html</a></p>\n\n<p>client: data := thrifter.Marshal(interface{}) -> send() -><br>\nserver: decode(factory.getProtocol(buf))</p>\n"}, {"tags": ["go", "package"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 3, "creation_date": 1558464771, "post_id": 56244336, "comment_id": 99107883, "body": "These issues are covered in <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a>."}, {"owner": {"reputation": 379, "user_id": 8196672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uCtuZ.png?s=128&g=1", "display_name": "bitwitch", "link": "https://stackoverflow.com/users/8196672/bitwitch"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1558468161, "post_id": 56244336, "comment_id": 99109310, "body": "Thanks, I did read this and other resources. The issue for me was that I incorrectly believed &#39;package main&#39; to be a special declaration used only once per package."}], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 8196672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uCtuZ.png?s=128&g=1", "display_name": "bitwitch", "link": "https://stackoverflow.com/users/8196672/bitwitch"}, "edited": false, "score": 1, "creation_date": 1558465643, "post_id": 56244536, "comment_id": 99108244, "body": "I think I had the preconceived idea that there could be only one package main declaration per package. Silly, this prevented me from seeing something so simple. Thank you."}], "tags": [], "owner": {"reputation": 416, "user_id": 11529593, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nMOHrxOg4nQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfeI-u5UbYJIejKaTCqDSluZAyBDw/mo/photo.jpg?sz=128", "display_name": "Wombologist", "link": "https://stackoverflow.com/users/11529593/wombologist"}, "is_accepted": true, "score": 11, "last_activity_date": 1558463955, "creation_date": 1558463955, "answer_id": 56244536, "question_id": 56244336, "link": "https://stackoverflow.com/questions/56244336/go-package-with-multiple-files-how-to-structure/56244536#56244536", "title": "Go package with multiple files, how to structure", "body": "<p>if all you want to do is access functions in a different file, have functions.go also start with <code>package main</code> instead of <code>package dart</code>. That way, you are working within a single package but with your code divided into multiple files. Make sure they're in the same directory so that they're considered in the same package.</p>\n"}, {"tags": [], "owner": {"reputation": 1025, "user_id": 7253829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qe9lZ.jpg?s=128&g=1", "display_name": "waymobetta", "link": "https://stackoverflow.com/users/7253829/waymobetta"}, "is_accepted": false, "score": 2, "last_activity_date": 1558464912, "creation_date": 1558464912, "answer_id": 56244763, "question_id": 56244336, "link": "https://stackoverflow.com/questions/56244336/go-package-with-multiple-files-how-to-structure/56244763#56244763", "title": "Go package with multiple files, how to structure", "body": "<p>If you are just looking to create a library then you won't need a main package. However, if you are looking to create a standalone program that runs functions from a different package (<code>dartlib</code>) then you'll need a main file.</p>\n\n<p>It would also be a good idea to name your program something different than the library you are calling (<em>program</em> <code>dart</code> calling <em>library</em> <code>dartlib</code>)</p>\n\n<p><em>Library</em></p>\n\n<p>Your library directory structure should look something like the following:</p>\n\n<pre><code>dartlib\n|\n dartlib.go\n</code></pre>\n\n<hr>\n\n<p>dartlib.go</p>\n\n<pre><code>package dartlib\n\nfunction Hello() string { return \"hello!\" }\n</code></pre>\n\n<p>This can be imported as the following: \n<code>\"github.com/your_github_username/dartlib\"</code></p>\n\n<hr>\n\n<p><em>Program</em></p>\n\n<p>Or, you can store the package within your program directory. In this case the directory structure should look something like the following:</p>\n\n<pre><code>dart (you_program_name)\n|\n dart.go\n dartlib (package)\n |\n  dartlib.go\n</code></pre>\n\n<p>In this case, the library can be imported as the following: \n<code>\"github.com/your_github_username/dart/dartlib\"</code></p>\n\n<hr>\n\n<p>dart.go</p>\n\n<pre><code>package main\n\nimport (\n \"github.com/your_github_username/dart/dartlib\"\n \"fmt\"\n)\n\nhelloString := dartlib.Hello()\nfmt.Println(helloString)\n</code></pre>\n\n<p><code>go build .</code> at directory root produces the <code>dart</code> executable.</p>\n\n<p><code>$./dart\n hello!</code></p>\n\n<p>For more examples and further explanation see the <a href=\"https://golang.org/doc/code.html#Library\" rel=\"nofollow noreferrer\">docs</a></p>\n"}, {"tags": [], "owner": {"reputation": 148, "user_id": 2879816, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001511168084/picture?type=large", "display_name": "M&#225;rcio Rocha Zacarias", "link": "https://stackoverflow.com/users/2879816/m%c3%a1rcio-rocha-zacarias"}, "is_accepted": false, "score": 3, "last_activity_date": 1558464982, "creation_date": 1558464982, "answer_id": 56244781, "question_id": 56244336, "link": "https://stackoverflow.com/questions/56244336/go-package-with-multiple-files-how-to-structure/56244781#56244781", "title": "Go package with multiple files, how to structure", "body": "<p>As <a href=\"https://stackoverflow.com/users/11529593/wombologist\">Wombologist</a> mentioned, you can split different files under the same package without problem, assuming they share the same <code>package</code> definition. The only exception for different package definitions under the same directory is for tests, where the recommended way of defining the package is adding <code>_test</code> on it (e.g. <code>package main_test</code> or <code>package dart_test</code>).</p>\n\n<p>Not sure if it's your case here or if you are just experimenting with the language, but I would add that Go projects are easier to maintain when you group same domain code under packages and share them around, increasing the potential reusability.</p>\n"}], "owner": {"reputation": 379, "user_id": 8196672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uCtuZ.png?s=128&g=1", "display_name": "bitwitch", "link": "https://stackoverflow.com/users/8196672/bitwitch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6284, "favorite_count": 1, "accepted_answer_id": 56244536, "answer_count": 3, "score": 4, "last_activity_date": 1558464982, "creation_date": 1558463128, "question_id": 56244336, "link": "https://stackoverflow.com/questions/56244336/go-package-with-multiple-files-how-to-structure", "title": "Go package with multiple files, how to structure", "body": "<p>Go noob, I cannot seem to figure out how to structure my project with packages. What I want is this: </p>\n\n<ul>\n<li>I want to create a package, lets say its called Dart.   </li>\n<li>I have a file called dart.go with package main and the main function in my project directory.  </li>\n<li>I have another file, lets call it functions.go in my project directory with 'package dart' as the first line.  </li>\n<li>I just want to call functions from functions.go in main, but cannot figure out how to name the packages to get it to build.  </li>\n<li>If I put package dart at the top of functions.go it wont build because it finds packages main and dart. I dont want functions.go \nto be part of another package, I just want one package and the ability to split the functions in this package into multiple files.  </li>\n<li>Is this possible in go, or do I have to make multiple packages? </li>\n</ul>\n\n<p>dart.go</p>\n\n<pre><code>package main \n\nimport (\n  ...\n)  \n\nfunc main () {\n  ...\n  // call functions declared in functions.go\n  ...\n}\n</code></pre>\n\n<p>functions.go</p>\n\n<pre><code>package dart  \n\nimport (\n  ...\n)\n\nfunc Function1() {\n  ... \n}\n\nfunc Function2() {\n  ...\n}\n</code></pre>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1558463046, "post_id": 56243705, "comment_id": 99107212, "body": "You should use structs, rather than nested maps."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1558468161, "post_id": 56243705, "comment_id": 99109311, "body": "A struct would definitely be easier. Barring that, you&#39;d need to use a <code>map[string]interface{}</code> if the values in your interface aren&#39;t the same type."}, {"owner": {"reputation": 85, "user_id": 2581239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/df9b0a6adfadea9b54da90b0aa350357?s=128&d=identicon&r=PG", "display_name": "TheOrangeRemix", "link": "https://stackoverflow.com/users/2581239/theorangeremix"}, "edited": false, "score": 0, "creation_date": 1558472781, "post_id": 56243705, "comment_id": 99111163, "body": "Thank you, I wasn&#39;t aware of using structs instead of nested maps. I was able to get it working by using a similar example described by this link: <a href=\"https://medium.com/@xcoulon/nested-structs-in-golang-2c750403a007\" rel=\"nofollow noreferrer\">medium.com/@xcoulon/nested-structs-in-golang-2c750403a007</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1025, "user_id": 7253829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qe9lZ.jpg?s=128&g=1", "display_name": "waymobetta", "link": "https://stackoverflow.com/users/7253829/waymobetta"}, "is_accepted": false, "score": 2, "last_activity_date": 1558461344, "creation_date": 1558461344, "answer_id": 56243957, "question_id": 56243705, "link": "https://stackoverflow.com/questions/56243705/initializing-and-inserting-nested-json-data-in-golang/56243957#56243957", "title": "Initializing and inserting nested JSON data in Golang?", "body": "<p>Using nested maps can get a little confusing, so perhaps using a struct would help make working with your data structure more manageable.</p>\n\n<p>Consider using a tool like <a href=\"https://mholt.github.io/json-to-go/\" rel=\"nofollow noreferrer\">json-to-go</a> to help you construct proper objects for your JSON data.</p>\n\n<p><strong>Note:</strong> <em>This will not provide a perfect struct each time- in fact, often this tool will simply default to using the interface type when it is unable to identify the proper type (which is not ideal), so you'll need to likely customize the output, but overall it will provide you with a good starting point.</em></p>\n\n<p>Working example in the <a href=\"https://play.golang.org/p/ZtPrhIocudK\" rel=\"nofollow noreferrer\">playground</a></p>\n"}], "owner": {"reputation": 85, "user_id": 2581239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/df9b0a6adfadea9b54da90b0aa350357?s=128&d=identicon&r=PG", "display_name": "TheOrangeRemix", "link": "https://stackoverflow.com/users/2581239/theorangeremix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1558461344, "creation_date": 1558460332, "question_id": 56243705, "link": "https://stackoverflow.com/questions/56243705/initializing-and-inserting-nested-json-data-in-golang", "title": "Initializing and inserting nested JSON data in Golang?", "body": "<p>I've been at my wits end attempting to get this to work for the last 3 hours, so hopefully you guys will be able to help me with this.</p>\n\n<p>I'm attempting to initialize a nested JSON structure in Go and insert data into it. This is the structure of the JSON that I'm looking to process:</p>\n\n<pre><code>{\n  \"top\": {\n    \"item1\": {\n      \"foo\": \"bar\"\n    },\n    \"item2\": \"This is item2\",\n    \"item3\": \"This is item3\",\n    \"item4\": {\n      \"foo2\": \"bar2\"\n    }\n  }\n}\n</code></pre>\n\n<p>This is how I am setting it up in Go --</p>\n\n<pre><code>package main\n\nimport (\n\"fmt\"\n)\n\nfunc main() {\n\ndata := make(map[string]map[string]map[string]string) // init top level map\ndata[\"top\"] = make(map[string]map[string]string)\ndata[\"top\"][\"item1\"] = make(map[string]string)\ndata[\"top\"][\"item4\"] = make(map[string]string)\n\n\ndata[\"top\"][\"item1\"][\"foo\"] = \"bar\"\ndata[\"top\"][\"item4\"][\"foo2\"] = \"bar2\"\ndata[\"top\"][\"item2\"] = \"This is item2\"\n\n\nfmt.Println(data)\n}\n</code></pre>\n\n<p>However, if I run this, I get this error:</p>\n\n<p><em>cannot use \"This is item2\" (type string) as type map[string]string in assignment</em></p>\n\n<p>I'm sure I'm making this overly complicated, so what would be the more efficient way of expressing this?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 895, "user_id": 5117502, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/3af1c137fcafdd6975f358e1fb43ca4c?s=128&d=identicon&r=PG&f=1", "display_name": "Jay266", "link": "https://stackoverflow.com/users/5117502/jay266"}, "edited": false, "score": 1, "creation_date": 1558455562, "post_id": 56242100, "comment_id": 99103806, "body": "This works wonderfully! Last question. If I want to exclude certain JSON Names, such as &quot;Type&quot; or &quot;Title&quot;, is there an easy way to do that?"}, {"owner": {"reputation": 5415, "user_id": 1071486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fafdf95bf6e371d0685b649453277cdc?s=128&d=identicon&r=PG", "display_name": "aymericbeaumet", "link": "https://stackoverflow.com/users/1071486/aymericbeaumet"}, "reply_to_user": {"reputation": 895, "user_id": 5117502, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/3af1c137fcafdd6975f358e1fb43ca4c?s=128&d=identicon&r=PG&f=1", "display_name": "Jay266", "link": "https://stackoverflow.com/users/5117502/jay266"}, "edited": false, "score": 0, "creation_date": 1558455667, "post_id": 56242100, "comment_id": 99103859, "body": "I&#39;m not sure about this, I will dig the topic. In the meantime you should create a new question to maximize the visibility."}, {"owner": {"reputation": 895, "user_id": 5117502, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/3af1c137fcafdd6975f358e1fb43ca4c?s=128&d=identicon&r=PG&f=1", "display_name": "Jay266", "link": "https://stackoverflow.com/users/5117502/jay266"}, "edited": false, "score": 2, "creation_date": 1558457270, "post_id": 56242100, "comment_id": 99104643, "body": "<a href=\"https://stackoverflow.com/questions/56242969/how-to-exclude-certain-names-in-a-json-unmarshal-golang\" title=\"how to exclude certain names in a json unmarshal golang\">stackoverflow.com/questions/56242969/&hellip;</a>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1558506302, "post_id": 56242100, "comment_id": 99118448, "body": "JSON marshaling loses a lot of information about a Go struct, and doesn&#39;t work with all data types, so is often a poor choice for this sort of thing."}, {"owner": {"reputation": 5415, "user_id": 1071486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fafdf95bf6e371d0685b649453277cdc?s=128&d=identicon&r=PG", "display_name": "aymericbeaumet", "link": "https://stackoverflow.com/users/1071486/aymericbeaumet"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1558508977, "post_id": 56242100, "comment_id": 99119677, "body": "@Flimzy Thanks, what do you recommend? I see Marcio recommended <a href=\"https://github.com/davecgh/go-spew\" rel=\"nofollow noreferrer\">github.com/davecgh/go-spew</a>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1558510246, "post_id": 56242100, "comment_id": 99120430, "body": "What I recommend depends on your use-case. For debugging, spew is a great choice. If you&#39;re dumping data for end-user consumption, you might even need to mark it up with HTML or something. So it depends entirely."}], "tags": [], "owner": {"reputation": 5415, "user_id": 1071486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fafdf95bf6e371d0685b649453277cdc?s=128&d=identicon&r=PG", "display_name": "aymericbeaumet", "link": "https://stackoverflow.com/users/1071486/aymericbeaumet"}, "is_accepted": true, "score": 11, "last_activity_date": 1559075450, "last_edit_date": 1559075450, "creation_date": 1558454060, "answer_id": 56242100, "question_id": 56242013, "link": "https://stackoverflow.com/questions/56242013/how-to-pretty-print-a-golang-structure/56242100#56242100", "title": "How to pretty print a Golang structure?", "body": "<p>There is a function in the Go standard library taking a <code>interface{}</code> and producing an indented JSON output: <a href=\"https://golang.org/pkg/encoding/json/#MarshalIndent\" rel=\"noreferrer\"><code>json.MarshalIndent</code></a>.</p>\n\n<p>Here is an example how it could be applied to your use-case (<a href=\"https://play.golang.org/p/3geUEEHESSa\" rel=\"noreferrer\">https://play.golang.org/p/3geUEEHESSa</a>):</p>\n\n<pre><code>s, _ := json.MarshalIndent(b, \"\", \"\\t\");\nfmt.Print(string(s))\n</code></pre>\n\n<p>While not being exactly what you expected, this produces a JSON output which is pretty readable:</p>\n\n<pre><code>{\n    \"CondensedADI\": [\n        {\n            \"Name\": \"Type\",\n            \"Value\": \"title\"\n        },\n        {\n            \"Name\": \"Title\",\n            \"Value\": \"Ste Life_S01_E10_\"\n        },\n        ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 148, "user_id": 2879816, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001511168084/picture?type=large", "display_name": "M&#225;rcio Rocha Zacarias", "link": "https://stackoverflow.com/users/2879816/m%c3%a1rcio-rocha-zacarias"}, "is_accepted": false, "score": 2, "last_activity_date": 1558466877, "creation_date": 1558466877, "answer_id": 56245201, "question_id": 56242013, "link": "https://stackoverflow.com/questions/56242013/how-to-pretty-print-a-golang-structure/56245201#56245201", "title": "How to pretty print a Golang structure?", "body": "<p>This is probably a duplicated answer for a duplicated question, but a good alternative to <code>json.MarshalIndent()</code> is using go-spew, that will give you more details and formatting options: <a href=\"https://github.com/davecgh/go-spew\" rel=\"nofollow noreferrer\">https://github.com/davecgh/go-spew</a></p>\n"}], "owner": {"reputation": 895, "user_id": 5117502, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/3af1c137fcafdd6975f358e1fb43ca4c?s=128&d=identicon&r=PG&f=1", "display_name": "Jay266", "link": "https://stackoverflow.com/users/5117502/jay266"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6765, "favorite_count": 2, "closed_date": 1558506242, "accepted_answer_id": 56242100, "answer_count": 2, "score": 2, "last_activity_date": 1559075450, "creation_date": 1558453769, "last_edit_date": 1558455798, "question_id": 56242013, "link": "https://stackoverflow.com/questions/56242013/how-to-pretty-print-a-golang-structure", "closed_reason": "Duplicate", "title": "How to pretty print a Golang structure?", "body": "<p>I am unmarshaling a struct and I would like it to print it in a formatted manner.</p>\n\n<p>My code (<a href=\"https://play.golang.org/p/D0KwGP6Cxa0\" rel=\"nofollow noreferrer\">https://play.golang.org/p/D0KwGP6Cxa0</a>) currently produces the following output:</p>\n\n<pre><code>main.ADIStruct{CondensedADI:[]main.CondensedADI{main.CondensedADI{Name:\"Type\", Value:\"title\"}, main.CondensedADI{Name:\"Title\", Value:\"Ste Life_S01_E10_\"}, main.CondensedADI{Name:\"Title_Brief\", Value:\"Ste Life_S01_E10_HD\"}, main.CondensedADI{Name:\"Episode_Name\", Value:\"Cody Goes to Camp\"}, main.CondensedADI{Name:\"Episode_ID\", Value:\"10\"}, main.CondensedADI{Name:\"Summary_Short\", Value:\"Zack is excited to finally get rid of his brother when Cody leaves for math camp.\"}, main.CondensedADI{Name:\"Rating\", Value:\"TV-G\"}, main.CondensedADI{Name:\"Run_Time\", Value:\"00:22:50\"}, main.CondensedADI{Name:\"Display_Run_Time\", Value:\"00:23\"}, main.CondensedADI{Name:\"Year\", Value:\"2005\"}, main.CondensedADI{Name:\"Closed_Captioning\", Value:\"Y\"}, main.CondensedADI{Name:\"Genre\", Value:\"Family\"}, main.CondensedADI{Name:\"Billing_ID\", Value:\"00000\"}, main.CondensedADI{Name:\"Actors_Display\", Value:\"Ashley Tisdale ( Maddie ), Brenda Song ( London ), Cole Sprouse ( Cody ), Dylan Sprouse ( Zack ), Kim Rhodes ( Carey ), Phill Lewis ( Moseby )\"}, main.CondensedADI{Name:\"Licensing_Window_Start\", Value:\"2019-05-15 00:00:00\"}, main.CondensedADI{Name:\"Licensing_Window_End\", Value:\"2019-10-31 00:00:00\"}, main.CondensedADI{Name:\"Preview_Period\", Value:\"0\"}, main.CondensedADI{Name:\"Display_As_New\", Value:\"7\"}, main.CondensedADI{Name:\"Display_As_Last_Chance\", Value:\"7\"}, main.CondensedADI{Name:\"Provider_QA_Contact\", Value:\"DATG.DL-VOD.Support@disney.com\"}, main.CondensedADI{Name:\"Suggested_Price\", Value:\"0.00\"}, main.CondensedADI{Name:\"Category\", Value:\"Disney Channel HD/Suite Life\"}}}\n</code></pre>\n\n<p>I would like it to only have the name and value and have a new line after each item. Such as this:</p>\n\n<pre><code>Name:\"Type\", Value:\"title\"\n\nName:\"Title\", Value:\"Ste Life_S01_E10_\"\n</code></pre>\n\n<p>Any ideas how I could do that?</p>\n"}, {"tags": ["regex", "go", "regex-lookarounds", "regex-group", "regex-greedy"], "comments": [{"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 2, "creation_date": 1558452907, "post_id": 56241737, "comment_id": 99102343, "body": "Can you give more examples of what CIDR-masks look like?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "edited": false, "score": 0, "creation_date": 1558454816, "post_id": 56241737, "comment_id": 99103407, "body": "Breakdown of your regex, given the target string <code>&#47;9this can be&#47;a&#47;path123</code> . . . The assertion <code>(?!([0-9]|[1-2][0-9]|3[0-2])</code> will not allow digits. It boils down to <code>(?!\\d)</code>, . . <code>[&#47;?]</code> must be this <code>&#47;?</code>, which can&#39;t match because a digit is after it, which is not allowed. Finally, the entire string is matched with the <code>[\\S ]*</code> part, which is why it matches. It really can&#39;t be fixed, you have to start from scratch."}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1558466674, "post_id": 56241737, "comment_id": 99108744, "body": "You want <a href=\"https://regex101.com/r/uBeqFR/2\" rel=\"nofollow noreferrer\"><code>^[&#47;?](?!(?:[0-9]|[1-2][0-9]|3[0-2])$)\\S.*</code></a> I think, but it won&#39;t work in Go regex as it is RE2 based and does not support lookarounds."}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1558467231, "post_id": 56241737, "comment_id": 99108933, "body": "You may use two regexps in Go: if your string matches <code>^[&#47;?]\\S</code> and does not match <code>^&#47;(?:[0-9]|[1-2][0-9]|3[0-2])$</code>, then it is an URL."}], "answers": [{"comments": [{"owner": {"reputation": 874, "user_id": 352842, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/dfa1eed6ce2f228613cba4a39e79f093?s=128&d=identicon&r=PG", "display_name": "Lars", "link": "https://stackoverflow.com/users/352842/lars"}, "edited": false, "score": 0, "creation_date": 1558466136, "post_id": 56242130, "comment_id": 99108515, "body": "This regex doesn&#39;t match paths with numbers outside the allowed range, e.g. <code>&#47;33</code> or <code>&#47;555</code>. My question didn&#39;t define a CIDR-mask well enough, my fault."}], "tags": [], "owner": {"reputation": 5857, "user_id": 3641043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74c0ec8d28ab4d6293a67c4ca9d56178?s=128&d=identicon&r=PG", "display_name": "Chris Lear", "link": "https://stackoverflow.com/users/3641043/chris-lear"}, "is_accepted": false, "score": 0, "last_activity_date": 1558454153, "creation_date": 1558454153, "answer_id": 56242130, "question_id": 56241737, "link": "https://stackoverflow.com/questions/56241737/regex-for-passing-urls-and-failing-cidr-mask/56242130#56242130", "title": "RegEx for passing URLs and failing CIDR-mask", "body": "<p>Maybe this will be adequate:</p>\n\n<pre><code>^[\\/?].*[a-zA-Z].*$\n</code></pre>\n\n<p>See <a href=\"https://regex101.com/r/dw6Dtw/1\" rel=\"nofollow noreferrer\">https://regex101.com/r/dw6Dtw/1</a></p>\n\n<p>All it does is ensure that there's a letter in the path somewhere</p>\n"}, {"comments": [{"owner": {"reputation": 874, "user_id": 352842, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/dfa1eed6ce2f228613cba4a39e79f093?s=128&d=identicon&r=PG", "display_name": "Lars", "link": "https://stackoverflow.com/users/352842/lars"}, "edited": false, "score": 1, "creation_date": 1558466330, "post_id": 56242287, "comment_id": 99108593, "body": "This regex doesn&#39;t match paths with numbers outside the allowed range, e.g. <code>&#47;33</code> or <code>&#47;555</code>. My question didn&#39;t define a CIDR-mask well enough, sorry. Also, it does not seem to detect paths that have two letters e.g. <code>&#47;te</code>"}], "tags": [], "owner": {"reputation": 1, "user_id": 6553328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/omcAX.jpg?s=128&g=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/6553328/emma"}, "is_accepted": false, "score": 0, "last_activity_date": 1558454650, "last_edit_date": 1592644375, "creation_date": 1558454650, "answer_id": 56242287, "question_id": 56241737, "link": "https://stackoverflow.com/questions/56241737/regex-for-passing-urls-and-failing-cidr-mask/56242287#56242287", "title": "RegEx for passing URLs and failing CIDR-mask", "body": "<p>I doubt that you might want to have a complex expression to pass those, maybe just adding a quantifier with 2 plus alpha would pass that. Maybe, an expression similar to this would suffice:</p>\n<pre><code>(.+?[a-z]{2,}[0-9]?.+)\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/QBFy1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QBFy1.png\" alt=\"enter image description here\" /></a></p>\n<h2><a href=\"https://regex101.com/r/tHPUeu/1\" rel=\"nofollow noreferrer\">DEMO</a></h2>\n<h3>RegEx</h3>\n<p>If this expression wasn't desired or my assumptions were incorrect, it can be modified or changed in <a href=\"https://regex101.com/r/tHPUeu/1/\" rel=\"nofollow noreferrer\">regex101.com</a>.</p>\n<h3>RegEx Circuit</h3>\n<p><a href=\"https://jex.im/regulex/#!flags=&amp;re=%5E(a%7Cb)*%3F%24\" rel=\"nofollow noreferrer\">jex.im</a> also helps to visualize the expressions.</p>\n<p><a href=\"https://i.stack.imgur.com/vCpD1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vCpD1.png\" alt=\"enter image description here\" /></a></p>\n"}], "owner": {"reputation": 874, "user_id": 352842, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/dfa1eed6ce2f228613cba4a39e79f093?s=128&d=identicon&r=PG", "display_name": "Lars", "link": "https://stackoverflow.com/users/352842/lars"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1558466504, "creation_date": 1558452802, "last_edit_date": 1558466504, "question_id": 56241737, "link": "https://stackoverflow.com/questions/56241737/regex-for-passing-urls-and-failing-cidr-mask", "title": "RegEx for passing URLs and failing CIDR-mask", "body": "<p>I have strings that can be URLs or CIDR-blocks. I want to determine whether a string is the path of a URL e.g.:</p>\n\n<pre><code>/9this can be/a/path123\n/test\n/r\n</code></pre>\n\n<p>or a CIDR-mask (<code>/0</code> to <code>/32</code>):</p>\n\n<pre><code>/24\n/12\n/32\n</code></pre>\n\n<p>I want the regex to exclude CIDR-masks from the matches.</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>^[/?]((?!([0-9]|[1-2][0-9]|3[0-2]))(?=[\\S]))[\\S ]*$\n</code></pre>\n\n<p>Which works, except for the case where the URL-path starts with a number:</p>\n\n<pre><code>/23example\n</code></pre>\n\n<p>I'm coding in Go, if that matters.</p>\n"}, {"tags": ["windows", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1558451741, "post_id": 56241257, "comment_id": 99101671, "body": "The rule is not &quot;project root&quot;. The rule is that <code>internal</code> packages can only be imported from packages <b>rooted</b> at the parent of the internal folder."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1558451803, "post_id": 56241257, "comment_id": 99101702, "body": "Also, do not download and put packages into the <code>src</code> folder of the Go SDK (is this what your <code>c:\\go\\src</code> is?). Use <code>go get package&#47;path&#47;...</code> to get packages recursively, especially if there are no Go source files at the project root."}, {"owner": {"reputation": 910, "user_id": 426853, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b7fbf02bd4eb6fa180937d44a6afdcd0?s=128&d=identicon&r=PG", "display_name": "Mike Ellis", "link": "https://stackoverflow.com/users/426853/mike-ellis"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1558452708, "post_id": 56241257, "comment_id": 99102224, "body": "@izca, thanks. So is my example not consistent with the rule? <code>pgcgo</code> is the parent of both <code>internal</code> and <code>setacertc</code>.  I think the problem must be related to your second comment since builds succeed on other installations. I&#39;ll ask my colleague to try running <code>go get</code> on all the subdirectories of <code>pgcgo</code>.  BTW, <code>pgcgo</code> doesn&#39;t contain any go files so that&#39;s another indicator that your diagnosis is likely correct.  Would our first attempts to use <code>go get</code> have succeeded if there were a &quot;junk.go&quot; file in <code>pgcgo</code>?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1558454094, "post_id": 56241257, "comment_id": 99103015, "body": "Yes, your project structure indicated in the question conforms to the rule. Try to remove the project you cloned with git from <code>c:\\go\\src</code>. That is most likely the root of your Go SDK. You have to place your projects inside <code>GOPATH</code>. Either manual <code>git clone</code> (but into your <code>GOPATH&#47;src</code>) or <code>go get github.com&#47;Michael-F-Ellis&#47;pgcgo&#47;...</code> will do."}, {"owner": {"reputation": 1126, "user_id": 3508174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vfMCq.jpg?s=128&g=1", "display_name": "Sergey Narozhnyy", "link": "https://stackoverflow.com/users/3508174/sergey-narozhnyy"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1558465785, "post_id": 56241257, "comment_id": 99108311, "body": "Agree with @icza, your project is supposed to be placed under GOPATH which is usually %HomePath%\\go folder, like C:\\Users\\&lt;user&gt;\\go, but not C:\\go. Check out &quot;go env&quot; in the command line."}, {"owner": {"reputation": 910, "user_id": 426853, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b7fbf02bd4eb6fa180937d44a6afdcd0?s=128&d=identicon&r=PG", "display_name": "Mike Ellis", "link": "https://stackoverflow.com/users/426853/mike-ellis"}, "reply_to_user": {"reputation": 1126, "user_id": 3508174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vfMCq.jpg?s=128&g=1", "display_name": "Sergey Narozhnyy", "link": "https://stackoverflow.com/users/3508174/sergey-narozhnyy"}, "edited": false, "score": 0, "creation_date": 1558470474, "post_id": 56241257, "comment_id": 99110239, "body": "@SergeyNarozhnyy yes that&#39;s almost certainly the problem. I&#39;m so used to linux where the go binaries are /usr/local/bin and GOPATH defaults to ~/go/ that I spaced out on the differences in a Windows environment. I also didn&#39;t know about using an ellipsis at the end of a <code>go get</code> path. That would probably have made my first attempt to get the project succeed and I wouldn&#39;t have cloned it into GOROOT.  I&#39;m still waiting to hear from my colleague when he gets a chance to try this."}], "owner": {"reputation": 910, "user_id": 426853, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b7fbf02bd4eb6fa180937d44a6afdcd0?s=128&d=identicon&r=PG", "display_name": "Mike Ellis", "link": "https://stackoverflow.com/users/426853/mike-ellis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 194, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558451154, "creation_date": 1558451154, "question_id": 56241257, "link": "https://stackoverflow.com/questions/56241257/use-of-internal-package-not-allowed-on-windows-10-go-v1-12-5", "title": "Use of internal package not allowed on Windows 10 Go v1.12.5", "body": "<p>Yesterday I helped a colleague install go on his Windows 10 PC. We downloaded and installed the latest (v1.12.5) from golang.org. No errors were reported during the install.  We ran into problems trying to get and build a private project we're collaborating on.</p>\n\n<p>The first problem was trying to use go get to fetch the project into the go/src tree. It prompted for his GitHub password and appeared to be downloading but failed with a complaint that the project contained no Go files. So we git cloned the project directly under C:\\go\\src. That succeeded, but attempting to build produces complaints about \"use of internal package not allowed\".</p>\n\n<p>There are multiple prior reports of this error message on SO (e.g. <a href=\"https://stackoverflow.com/questions/41060764/golang-disable-use-of-internal-package-not-allowed\">golang disable &quot;use of internal package not allowed&quot;</a>) and as issues in golang/go (e.g. <a href=\"https://github.com/golang/go/issues/26446\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/26446</a>) but most of the discussions explain the problem as having to do with attempts to import from internals of packages with repositories outside the project root.  <em>That's not the case here.</em> </p>\n\n<p>The project is pure Go and all of the code in the repo builds successfully on OS-X and Linux.</p>\n\n<p><strong>For the above reasons, I believe this question is not a duplicate.</strong></p>\n\n<p>For reference, here is a much reduced view of the project directory installed under the go/src tree showing one of the files that produces the error when attempting to run go build. In this case the complaint references the internal/ace/ package as the disallowed import but the problem also occurs in other subdirectories (not shown) that import from other internal packages (also not shown.)</p>\n\n<pre><code>go\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 github.com\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 Michael-F-Ellis\n    \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 pgcgo\n    \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 internal\n    \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502   \u251c\u2500\u2500 ace\n    \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 setacertc\n    \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c   \u251c\u2500\u2500 main.go\n\n</code></pre>\n\n<p>Here is the outline of setacertc/main.go:</p>\n\n<pre><code>// setacertc is intended to be run from an internet-connected host to\n// set the real-time-clock on the ACE11.\npackage main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"math/rand\"\n    \"time\"\n\n    \"github.com/Michael-F-Ellis/pgcgo/internal/ace\"\n)\n\nfunc main() {\n    // SNIP\n}\n</code></pre>\n\n<p>I suspect the problem is somehow specific to a new installation and/or running Go under Windows.  Any help appreciated.</p>\n"}, {"tags": ["string", "parsing", "go", "time", "timestamp"], "comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1558450824, "post_id": 56240944, "comment_id": 99101131, "body": "go uses a static point in time as the reference for formatting. See <a href=\"https://golang.org/pkg/time/#pkg-constants\" rel=\"nofollow noreferrer\">golang.org/pkg/time/#pkg-constants</a>  specifically: this point in time <code>Mon Jan 2 15:04:05 MST 2006</code>  or in RFC3339 <code>&quot;2006-01-02T15:04:05Z07:00&quot;</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1558450827, "post_id": 56240944, "comment_id": 99101132, "body": "You should not be using <code>&quot;2009-11-10 23:00:00 +0000 UTC m=+0.000000001&quot;</code> as a time format. Not only is it less convenient to parse, it&#39;s not a stable format. From the documentation: &quot;The returned string is meant for <i>debugging</i>; for a stable serialized representation, use <code>t.MarshalText</code>, <code>t.MarshalBinary</code>, or <code>t.Format</code> with an explicit format string.&quot;"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 1, "creation_date": 1558450909, "post_id": 56240944, "comment_id": 99101177, "body": "so you want your time (the one in 2009) in <code>t1</code>. But you want your <i>format</i> to be the <code>2006</code> string format"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1558479513, "post_id": 56240944, "comment_id": 99112945, "body": "@Volker and @ Flimzy I&#39;m actual curious on this one. The duplicate reference handles the base time components, but does not cover the monotonic component. If someone does time adds/subtracts that part can be quite significant. I wonder if this question is actually unique in that regard?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1558505905, "post_id": 56240944, "comment_id": 99118278, "body": "@colminator: Are you suggesting that the monotonic portion is relevant to the OPs answer? I don&#39;t see that being mentioned. If the question is how to parse monotonic times, and/or how to compare those parts, it may be unique. But as I see it, the question is only: How to marshal/umharshal times, and how to calculate the differences. The duplicates should answer that."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1558505916, "post_id": 56240944, "comment_id": 99118283, "body": "Clarification from the OP would be very welcome."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 11202238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49afff65f28b187b51c6b02e905adfea?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/11202238/chris"}, "edited": false, "score": 0, "creation_date": 1558507751, "post_id": 56241577, "comment_id": 99119110, "body": "Thank you @colminator! That works for me. I don&#39;t need the monotonic delta but it is inside the reference code I use so I now handle it using [:29]. Thank your for your help!"}], "tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": true, "score": 0, "last_activity_date": 1558452718, "last_edit_date": 1558452718, "creation_date": 1558452260, "answer_id": 56241577, "question_id": 56240944, "link": "https://stackoverflow.com/questions/56240944/how-to-get-difference-between-timestamps-either-between-strings-or-time-time/56241577#56241577", "title": "How to get difference between timestamps (either between strings or time.time)", "body": "<p>Basically you want:</p>\n\n<pre><code>    t1_raw := \"2009-11-10 23:00:00 +0000 UTC m=+0.000000001\"\n    format := \"2006-01-02 15:04:05 -0700 MST\"\n\n    // for simplicity t1_raw[:29] discards time's monotonic delta\n    // i.e. the \" m=+0.000000001\" suffix\n\n    t1, err := time.Parse(format, t1_raw[:29])\n    if err != nil {\n            log.Fatal(err)\n    }\n\n    log.Println(\"Duration -&gt;\", t2.Sub(t1))\n</code></pre>\n\n<p>If you <em>really</em> want the monotonic delta included, that number would have to be parsed manually and the delta applied to <code>t1</code>.</p>\n\n<p>Playground <a href=\"https://play.golang.org/p/AdxRLLmJCAv\" rel=\"nofollow noreferrer\">version</a>.</p>\n\n<p><strong>Note:</strong> playground version will show a duration of zero - as the playground's clock starts on <code>Nov 11 2009</code> - the seminal birthdate of <code>go</code>.</p>\n"}], "owner": {"reputation": 35, "user_id": 11202238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49afff65f28b187b51c6b02e905adfea?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/11202238/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "closed_date": 1558470222, "accepted_answer_id": 56241577, "answer_count": 1, "score": 1, "last_activity_date": 1558470246, "creation_date": 1558450181, "last_edit_date": 1592644375, "question_id": 56240944, "link": "https://stackoverflow.com/questions/56240944/how-to-get-difference-between-timestamps-either-between-strings-or-time-time", "closed_reason": "Duplicate", "title": "How to get difference between timestamps (either between strings or time.time)", "body": "<p>I have one problem: I need to know the difference/duration between two timestamps in golang. Therefore, I use the time library (<a href=\"https://golang.org/pkg/time/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/time/</a>).</p>\n<p>If I have two timestamps of type &quot;time.time&quot;, it is easy to get the difference using &quot;time.Sub()&quot;. My problem is that one of my timestamps comes from another function and it is only possible to transfer it as a string:</p>\n<blockquote>\n<p>t1 := &quot;2009-11-10 23:00:00 +0000 UTC m=+0.000000001&quot; //type: string</p>\n<p>t2 := time.Now() //type: time.time</p>\n</blockquote>\n<p>Now I have to basic possibilities:</p>\n<p>A) Convert t2 to a string as well and try to find out the difference between two strings (UGLY)</p>\n<p>B) Convert t1 from type &quot;string&quot; to type &quot;time.time&quot; and then apply &quot;time.Sub()&quot;</p>\n<p>I want to go way B). Therefore, I found out that</p>\n<blockquote>\n<p>time.Parse(format, timestring)</p>\n</blockquote>\n<p>should be able to do so. So I tried to convert t1 using</p>\n<blockquote>\n<p>t1_time, err := time.Parse(time.RFC3339, t1)</p>\n</blockquote>\n<p>but the result was not as expected! Instead I got this</p>\n<blockquote>\n<p>0001-01-01 00:00:00 +0000 UTC</p>\n</blockquote>\n<p>and the error saying &quot;error parsing time &quot;2009-11-10 23:00:02 +0000 UTC m=+2.000000001&quot; as &quot;2006-01-02T15:04:05Z07:00&quot;: cannot parse &quot; 23:00:02 +0000 UTC m=+2.000000001&quot; as &quot;T&quot; &quot;.</p>\n<p>If I use my own timeformat which is the same as t1</p>\n<blockquote>\n<p>timeformat := &quot;2009-11-10 23:00:00 +0000 UTC m=+0.000000001&quot;</p>\n<p>t1_time, err := time.Parse(timeformat , t1)</p>\n</blockquote>\n<p>the result stays wrong and I get the error saying&quot;error parsing time &quot;2009-11-10 23:00:02 +0000 UTC m=+2.000000001&quot; as &quot;2009-11-10 23:00:00 +0000 UTC m=+0.000000001&quot;: cannot parse &quot;9-11-10 23:00:02 +0000 UTC m=+2.000000001&quot; as &quot;009-&quot; &quot;.</p>\n<p>I also tried to go over UNIX time but the time library does not allow me to convert a string into unix.</p>\n<p>What do I do wrong??! Why is the parsing not working? Thanks for any help!</p>\n"}, {"tags": ["http", "go", "curl", "https"], "comments": [{"owner": {"reputation": 32481, "user_id": 2270041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cn7rq.jpg?s=128&g=1", "display_name": "Matteo", "link": "https://stackoverflow.com/users/2270041/matteo"}, "edited": false, "score": 0, "creation_date": 1558444351, "post_id": 56239003, "comment_id": 99096914, "body": "do you have already see this <a href=\"https://stackoverflow.com/a/12122718/2270041\">stackoverflow.com/a/12122718/2270041</a> ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1558444667, "post_id": 56239003, "comment_id": 99097098, "body": "How is curl validating the cert?"}, {"owner": {"reputation": 364, "user_id": 6173660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb2361f859a0ed3e7915135a5379426?s=128&d=identicon&r=PG&f=1", "display_name": "iam thadiyan", "link": "https://stackoverflow.com/users/6173660/iam-thadiyan"}, "reply_to_user": {"reputation": 32481, "user_id": 2270041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cn7rq.jpg?s=128&g=1", "display_name": "Matteo", "link": "https://stackoverflow.com/users/2270041/matteo"}, "edited": false, "score": 0, "creation_date": 1558445133, "post_id": 56239003, "comment_id": 99097379, "body": "@Matteo yes, I have. But that is disabling certificate. I want with certificate."}, {"owner": {"reputation": 364, "user_id": 6173660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb2361f859a0ed3e7915135a5379426?s=128&d=identicon&r=PG&f=1", "display_name": "iam thadiyan", "link": "https://stackoverflow.com/users/6173660/iam-thadiyan"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1558445204, "post_id": 56239003, "comment_id": 99097431, "body": "@JimB I don&#39;t know that. I installed certificate on ` /usr/local/share/ca-certificates/` . I am sorry if I missed something obvious."}, {"owner": {"reputation": 32481, "user_id": 2270041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cn7rq.jpg?s=128&g=1", "display_name": "Matteo", "link": "https://stackoverflow.com/users/2270041/matteo"}, "edited": false, "score": 0, "creation_date": 1558445577, "post_id": 56239003, "comment_id": 99097649, "body": "You could try <a href=\"https://venilnoronha.io/a-step-by-step-guide-to-mtls-in-go\" rel=\"nofollow noreferrer\">Step 3 - Supply the Certificates to the Client</a> as described in the article"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1558445950, "post_id": 56239003, "comment_id": 99097885, "body": "@iamthadiyan: have you run <code>update-ca-certificates</code>? If it&#39;s already included in the root certs then the cert isn&#39;t correct. Are you certain you created it with IP SANs?"}, {"owner": {"reputation": 364, "user_id": 6173660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb2361f859a0ed3e7915135a5379426?s=128&d=identicon&r=PG&f=1", "display_name": "iam thadiyan", "link": "https://stackoverflow.com/users/6173660/iam-thadiyan"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1558449211, "post_id": 56239003, "comment_id": 99099973, "body": "@JimB Yes, I have done that. That is the reason why <code>curl</code> is succeeding."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1558449650, "post_id": 56239003, "comment_id": 99100255, "body": "@iamthadiyan, Does <code>curl -v</code> give any information on how the cert is accepted? I was thinking it might be accepting an IP in the CN rather than the SAN."}, {"owner": {"reputation": 364, "user_id": 6173660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb2361f859a0ed3e7915135a5379426?s=128&d=identicon&r=PG&f=1", "display_name": "iam thadiyan", "link": "https://stackoverflow.com/users/6173660/iam-thadiyan"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1558489934, "post_id": 56239003, "comment_id": 99114706, "body": "@JimB Here is the verbose from curl. <code>$ curl -vvvv https:&#47;&#47;10.184.96.62:3000&#47;status *   Trying 10.184.96.62... * Connected to 10.184.96.62 (10.184.96.62) port 3000 (#0) * found 150 certificates in &#47;etc&#47;ssl&#47;certs&#47;ca-certificates.crt * found 605 certificates in &#47;etc&#47;ssl&#47;certs * ALPN, offering http&#47;1.1 * SSL connection using TLS1.2 &#47; ECDHE_RSA_AES_128_GCM_SHA256 </code>"}, {"owner": {"reputation": 364, "user_id": 6173660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb2361f859a0ed3e7915135a5379426?s=128&d=identicon&r=PG&f=1", "display_name": "iam thadiyan", "link": "https://stackoverflow.com/users/6173660/iam-thadiyan"}, "edited": false, "score": 0, "creation_date": 1558489981, "post_id": 56239003, "comment_id": 99114716, "body": "<code>*        server certificate verification OK *        server certificate status verification SKIPPED *        common name: 10.184.96.62 (matched) *        server certificate expiration date OK *        server certificate activation date OK *        certificate public key: RSA *        certificate version: #3 *        subject: C=AU,ST=State,L=Locaton,O=Org,OU=Unit,CN=10.184.96.62 *        start date: Tue, 21 May 2019 11:13:49 GMT </code>"}, {"owner": {"reputation": 364, "user_id": 6173660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb2361f859a0ed3e7915135a5379426?s=128&d=identicon&r=PG&f=1", "display_name": "iam thadiyan", "link": "https://stackoverflow.com/users/6173660/iam-thadiyan"}, "edited": false, "score": 0, "creation_date": 1558489990, "post_id": 56239003, "comment_id": 99114718, "body": "<code>*        expire date: Thu, 27 Apr 2119 11:13:49 GMT *        issuer: C=AU,ST=State,L=Locaton,O=Org,OU=Unit,CN=10.184.96.62 *        compression: NULL * ALPN, server accepted to use http&#47;1.1 &gt; GET &#47;status HTTP&#47;1.1 &gt; Host: 10.184.96.62:3000 &gt; User-Agent: curl&#47;7.47.0 &gt; Accept: *&#47;* &gt; </code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1558490636, "post_id": 56239003, "comment_id": 99114821, "body": "So it looks like you have the IP in the CN, which isn\u2019t technically valid but curl seems to allow it. Use a SAN as previously mentioned"}], "answers": [{"comments": [{"owner": {"reputation": 364, "user_id": 6173660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb2361f859a0ed3e7915135a5379426?s=128&d=identicon&r=PG&f=1", "display_name": "iam thadiyan", "link": "https://stackoverflow.com/users/6173660/iam-thadiyan"}, "edited": false, "score": 0, "creation_date": 1558488458, "post_id": 56239865, "comment_id": 99114477, "body": "I created a self-signed certificate using openssl. Since curl is able to use the certificate, I am guessing I did that correctly."}], "tags": [], "owner": {"reputation": 2808, "user_id": 98596, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/213851cc1f442df8f40b000f59ecb08a?s=128&d=identicon&r=PG", "display_name": "ftl", "link": "https://stackoverflow.com/users/98596/ftl"}, "is_accepted": false, "score": 3, "last_activity_date": 1558446732, "creation_date": 1558446732, "answer_id": 56239865, "question_id": 56239003, "link": "https://stackoverflow.com/questions/56239003/curl-is-able-to-get-from-https-but-from-golangs-http-get-same-https-url-doe/56239865#56239865", "title": "curl is able to GET from https; but from golang&#39;s http.get(), same https URL does not work", "body": "<p>The problem that the error message indicates is specific to the combination of HTTPS with IP addresses: usually a SSL certificate uses the hostname to check the authenticity of the server. In your case there is no hostname, but a IP address instead. There are two possible solutions to your problem:</p>\n\n<ol>\n<li>Use a hostname instead of the IP address and put that hostname into your certificate.</li>\n<li>Put the IP address you want to use into the <code>subjectAltNames</code> (\"Subject Alternative Names\" - SAN) field of your certificate (see <a href=\"https://tools.ietf.org/html/rfc5280#section-4.2.1.6\" rel=\"nofollow noreferrer\">RFC 5280</a>).</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 364, "user_id": 6173660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb2361f859a0ed3e7915135a5379426?s=128&d=identicon&r=PG&f=1", "display_name": "iam thadiyan", "link": "https://stackoverflow.com/users/6173660/iam-thadiyan"}, "is_accepted": true, "score": 0, "last_activity_date": 1558702126, "creation_date": 1558702126, "answer_id": 56293033, "question_id": 56239003, "link": "https://stackoverflow.com/questions/56239003/curl-is-able-to-get-from-https-but-from-golangs-http-get-same-https-url-doe/56293033#56293033", "title": "curl is able to GET from https; but from golang&#39;s http.get(), same https URL does not work", "body": "<p>The problem was with the certificate I generated. I used <code>openssl</code> to create a self-signed certificate. As I shared, <code>curl</code> was able to use it to establish connection with the server. But not the go application.</p>\n\n<p>In some forum I saw a comment that said that getting <code>openssl</code> to work in this scenario is tricky. So I used this <a href=\"https://golang.org/src/crypto/tls/generate_cert.go\" rel=\"nofollow noreferrer\">go code</a> to generate the certificate. Using this certificate, go app was also able to make the request with out making any change to the source code I shared in my question.</p>\n\n<p>Hope this helps some one in need.</p>\n"}], "owner": {"reputation": 364, "user_id": 6173660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb2361f859a0ed3e7915135a5379426?s=128&d=identicon&r=PG&f=1", "display_name": "iam thadiyan", "link": "https://stackoverflow.com/users/6173660/iam-thadiyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 479, "favorite_count": 0, "accepted_answer_id": 56293033, "answer_count": 2, "score": 0, "last_activity_date": 1558702126, "creation_date": 1558444056, "last_edit_date": 1558444298, "question_id": 56239003, "link": "https://stackoverflow.com/questions/56239003/curl-is-able-to-get-from-https-but-from-golangs-http-get-same-https-url-doe", "title": "curl is able to GET from https; but from golang&#39;s http.get(), same https URL does not work", "body": "<p>When I do <code>curl https://10.184.96.62:3000/status</code>, server sends back json data. All good.</p>\n\n<p>Using the below golang code, the application prints : </p>\n\n<blockquote>\n  <p>2019/05/21 18:29:15 Get <a href=\"https://10.184.96.62:3000/status\" rel=\"nofollow noreferrer\">https://10.184.96.62:3000/status</a>: x509: cannot\n  validate certificate for 10.184.96.62 because it doesn't contain any\n  IP SANs</p>\n</blockquote>\n\n<pre><code>package main\n\nimport (\n        \"log\"\n        \"net/http\"\n)\n\nfunc main() {\n        _, err := http.Get(\"https://10.184.96.62:3000/status\")\n        if err != nil {\n                log.Fatal(err)\n        }\n}\n</code></pre>\n\n<p>What am I missing?</p>\n"}, {"tags": ["go", "terraform", "terraform-provider-aws"], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 8487813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa262b099db11a522c6fd4b84f88a55?s=128&d=identicon&r=PG&f=1", "display_name": "kbry", "link": "https://stackoverflow.com/users/8487813/kbry"}, "edited": false, "score": 1, "creation_date": 1558509301, "post_id": 56241004, "comment_id": 99119837, "body": "Thank you, totally missed the init method!"}, {"owner": {"reputation": 3101, "user_id": 1526860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34aa83c8a8b8b93ab97d3f4e2b6ac215?s=128&d=identicon&r=PG", "display_name": "Jai Govindani", "link": "https://stackoverflow.com/users/1526860/jai-govindani"}, "reply_to_user": {"reputation": 103, "user_id": 8487813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa262b099db11a522c6fd4b84f88a55?s=128&d=identicon&r=PG&f=1", "display_name": "kbry", "link": "https://stackoverflow.com/users/8487813/kbry"}, "edited": false, "score": 0, "creation_date": 1595424655, "post_id": 56241004, "comment_id": 111469461, "body": "@kbry Did you end up being able to do this? From what I can see, it doesn&#39;t support backend-config files (only KV pairs). Were you able to override the backend from &quot;remote&quot; to &quot;local&quot; using <code>FormatTerraformBackendConfigAsArgs</code>?"}], "tags": [], "owner": {"reputation": 2574, "user_id": 4162641, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-QCRH93REO58/AAAAAAAAAAI/AAAAAAAAA20/uZA4Z48QSc0/photo.jpg?sz=128", "display_name": "StephenG", "link": "https://stackoverflow.com/users/4162641/stepheng"}, "is_accepted": true, "score": 1, "last_activity_date": 1558450376, "creation_date": 1558450376, "answer_id": 56241004, "question_id": 56238612, "link": "https://stackoverflow.com/questions/56238612/how-to-override-remote-state-in-terratest-terraform-setup/56241004#56241004", "title": "How to override remote state in Terratest Terraform setup", "body": "<p>Terraform allows for <a href=\"https://www.terraform.io/docs/backends/config.html#partial-configuration\" rel=\"nofollow noreferrer\">command line options to control backend configuration</a>. Since you're using Terratest, you'll have to pass these <a href=\"https://godoc.org/github.com/gruntwork-io/terratest/modules/terraform#Options\" rel=\"nofollow noreferrer\">backend options</a> to <a href=\"https://godoc.org/github.com/gruntwork-io/terratest/modules/terraform#Init\" rel=\"nofollow noreferrer\">Init</a>.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package terraform\n\nimport (\n    \"fmt\"\n    \"testing\"\n)\n\n// InitE calls terraform init and return stdout/stderr.\nfunc InitE(t *testing.T, options *Options) (string, error) {\n    args := []string{\"init\", fmt.Sprintf(\"-upgrade=%t\", options.Upgrade)}\n    args = append(args, FormatTerraformBackendConfigAsArgs(options.BackendConfig)...)\n    return RunTerraformCommandE(t, options, args...)\n}\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 8487813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa262b099db11a522c6fd4b84f88a55?s=128&d=identicon&r=PG&f=1", "display_name": "kbry", "link": "https://stackoverflow.com/users/8487813/kbry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 420, "favorite_count": 0, "accepted_answer_id": 56241004, "answer_count": 1, "score": 0, "last_activity_date": 1558450376, "creation_date": 1558442686, "question_id": 56238612, "link": "https://stackoverflow.com/questions/56238612/how-to-override-remote-state-in-terratest-terraform-setup", "title": "How to override remote state in Terratest Terraform setup", "body": "<p>I'm trying to understand how to override the Terraform backend ( in my case remote state ) and use local state when setting up Terratest Terraform test.</p>\n\n<p>I am using Terratest to test some Terraform code, and we manage the state remotely in s3. During Terratest i want to use local state but during the \"terraform init\" state it can'nt find a way to override it.</p>\n\n<p>any help will be appreciated </p>\n"}, {"tags": ["google-app-engine", "go", "go-modules", "google-app-engine-go"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1558436881, "post_id": 56236802, "comment_id": 99092520, "body": "A simple visiting of <a href=\"https://github.com/venclave/gosystem\" rel=\"nofollow noreferrer\">github.com/venclave/gosystem</a>  using a web browser returns 404. Visiting <a href=\"https://github.com/venclave\" rel=\"nofollow noreferrer\">github.com/venclave</a> says that &quot;the organization has no public repositories&quot;. So it&#39;s no wonder <code>go</code> fails to fetch that repository: it does not exist."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1558436959, "post_id": 56236802, "comment_id": 99092560, "body": "If you have some other means of letting the <code>go</code> tool reach <i>the contents of</i> that repository, consider using <a href=\"https://github.com/golang/go/wiki/Modules#when-should-i-use-the-replace-directive\" rel=\"nofollow noreferrer\">the <code>replace</code> directive in the <code>go.mod</code> file</a> to retarget the fetching operation to another URL."}, {"owner": {"reputation": 51, "user_id": 11533021, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Z-RzS8zwMuY/AAAAAAAAAAI/AAAAAAAAAAc/b7hn3o-4lFc/photo.jpg?sz=128", "display_name": "Niels", "link": "https://stackoverflow.com/users/11533021/niels"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1558436986, "post_id": 56236802, "comment_id": 99092578, "body": "I might have forgot to mention, but I have private access to these repos. The modules are checked out to <code>vendor&#47;</code>. (since build works)"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1558437054, "post_id": 56236802, "comment_id": 99092622, "body": "OK, then <a href=\"https://github.com/golang/go/wiki/Modules#how-do-i-use-vendoring-with-modules-is-vendoring-going-away\" rel=\"nofollow noreferrer\">use vendoring with <code>go mod</code></a>."}, {"owner": {"reputation": 51, "user_id": 11533021, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Z-RzS8zwMuY/AAAAAAAAAAI/AAAAAAAAAAc/b7hn3o-4lFc/photo.jpg?sz=128", "display_name": "Niels", "link": "https://stackoverflow.com/users/11533021/niels"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1558437296, "post_id": 56236802, "comment_id": 99092747, "body": "As mentioned, the go build works. I use <code>go build -mod vendor -o &#47;dev&#47;null .&#47;...</code>. I did a <code>go mod vendor</code>."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1558439675, "post_id": 56236802, "comment_id": 99094124, "body": "The doc says when <code>go build -mod=vendor</code> works, it <i>ignores</i> versioning information in the <code>go.mod</code> file. In your settup, it appears to not be the case. Hence, two points: 1) can you make sure your <code>vendor</code> directory does indeed contain correct import pathnames?; 2) run <code>go build</code> w/o redirecting its output and with <code>-x</code> to make it tell what it&#39;s doing, with much details? I also find interesting that the 1st line of your error contains <code>go: finding github.com&#47;pquerna&#47;otp v1.1.0</code>."}, {"owner": {"reputation": 51, "user_id": 11533021, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Z-RzS8zwMuY/AAAAAAAAAAI/AAAAAAAAAAc/b7hn3o-4lFc/photo.jpg?sz=128", "display_name": "Niels", "link": "https://stackoverflow.com/users/11533021/niels"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1558440808, "post_id": 56236802, "comment_id": 99094781, "body": "Heh! Weirdly enough, without <code>-mod vendor</code>, <code>go build</code> will trigger a download of the packages in <code>$GOPATH&#47;pkg&#47;mod</code>. I&#39;m amazed that the build won&#39;t work, because the <code>vendor&#47;</code> directory should contain everything because of the <code>go build -mod vendor</code>?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1558441830, "post_id": 56236802, "comment_id": 99095397, "body": "Hmm, judging from the wording of your comment, I reckon you might have wrong idea of how <code>&#47;vendor</code> works: when using <code>go</code> toolset in the &quot;modules&quot; mode, vendoring actually should forfeit any attempts at downloading anything: vendoring is about carrying your deps along with your code (usually with the complete sources). So <code>go build -mod=vendor</code> must just look under <code>&#47;vendor</code> and use what&#39;s there."}, {"owner": {"reputation": 51, "user_id": 11533021, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Z-RzS8zwMuY/AAAAAAAAAAI/AAAAAAAAAAc/b7hn3o-4lFc/photo.jpg?sz=128", "display_name": "Niels", "link": "https://stackoverflow.com/users/11533021/niels"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1558441914, "post_id": 56236802, "comment_id": 99095444, "body": "The thing that strikes me is that a <code>go build -mod vendor</code> shouldn&#39;t work then, or <code>gcloud app deploy</code> is not in &#39;vendoring mode&#39;."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1558442134, "post_id": 56236802, "comment_id": 99095565, "body": "May it be that having <code>GO111MODULE=on</code> turns off vendoring? What happens if you set it to <code>auto</code>? The wording <a href=\"https://golang.org/cmd/go/#hdr-Preliminary_module_support\" rel=\"nofollow noreferrer\">here</a> is moot, so I&#39;m just guessing. Also, if you really have manual checkout of <i>all</i> the required stuff under <code>&#47;vendor</code>, you might as well just try <code>GO111MODULE=off</code> and using unadorned <code>go build</code> (w/o <code>-mod=vendor</code>). Note that this might break eventually (somewhere past 1.12)."}, {"owner": {"reputation": 51, "user_id": 11533021, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Z-RzS8zwMuY/AAAAAAAAAAI/AAAAAAAAAAc/b7hn3o-4lFc/photo.jpg?sz=128", "display_name": "Niels", "link": "https://stackoverflow.com/users/11533021/niels"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1558447185, "post_id": 56236802, "comment_id": 99098706, "body": "@kostix: same with <code>GO111MODULE=auto</code>: this works for <code>go build</code>, but not for <code>gcloud app deploy</code>.."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1558630215, "post_id": 56236802, "comment_id": 99173550, "body": "By the way, see <a href=\"https://github.com/golang/go/issues/27227\" rel=\"nofollow noreferrer\">Go issue #27227</a>; isn&#39;t it what you&#39;re experiencing? If yes, would you please chime in and describe your use case there?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1558631842, "post_id": 56236802, "comment_id": 99174233, "body": "Ah, looks like you&#39;ve already done that, thanks."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 11533021, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Z-RzS8zwMuY/AAAAAAAAAAI/AAAAAAAAAAc/b7hn3o-4lFc/photo.jpg?sz=128", "display_name": "Niels", "link": "https://stackoverflow.com/users/11533021/niels"}, "edited": false, "score": 0, "creation_date": 1558446491, "post_id": 56239485, "comment_id": 99098249, "body": "I -am- fetching over SSH with key authentication and I verified everything is in <code>vendor&#47;</code>. Else a build would never work."}, {"owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "reply_to_user": {"reputation": 51, "user_id": 11533021, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Z-RzS8zwMuY/AAAAAAAAAAI/AAAAAAAAAAc/b7hn3o-4lFc/photo.jpg?sz=128", "display_name": "Niels", "link": "https://stackoverflow.com/users/11533021/niels"}, "edited": false, "score": 0, "creation_date": 1558449391, "post_id": 56239485, "comment_id": 99100075, "body": "@Niels what do you mean by saying &quot;I am fetching over SSH&quot;? Have you configured it using my 1st example? If not - go modules will use https, not ssh."}, {"owner": {"reputation": 1126, "user_id": 3508174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vfMCq.jpg?s=128&g=1", "display_name": "Sergey Narozhnyy", "link": "https://stackoverflow.com/users/3508174/sergey-narozhnyy"}, "reply_to_user": {"reputation": 51, "user_id": 11533021, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Z-RzS8zwMuY/AAAAAAAAAAI/AAAAAAAAAAc/b7hn3o-4lFc/photo.jpg?sz=128", "display_name": "Niels", "link": "https://stackoverflow.com/users/11533021/niels"}, "edited": false, "score": 0, "creation_date": 1558467652, "post_id": 56239485, "comment_id": 99109112, "body": "@Niels, go get uses HTTPS, see <a href=\"https://golang.org/doc/faq#git_https\" rel=\"nofollow noreferrer\">this</a>. While <a href=\"https://github.com/golang/go/issues/27254#issuecomment-416105629\" rel=\"nofollow noreferrer\">importing</a> or getting vendors populated via ssh by dep tool usually requires some git config trick: see ref <a href=\"https://github.com/golang/dep/issues/1726#issuecomment-371207015\" rel=\"nofollow noreferrer\">1</a> and <a href=\"https://golang.github.io/dep/docs/FAQ.html#how-do-i-get-dep-to-authenticate-via-ssh-to-a-git-repo\" rel=\"nofollow noreferrer\">2</a>."}, {"owner": {"reputation": 1126, "user_id": 3508174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vfMCq.jpg?s=128&g=1", "display_name": "Sergey Narozhnyy", "link": "https://stackoverflow.com/users/3508174/sergey-narozhnyy"}, "edited": false, "score": 0, "creation_date": 1558468698, "post_id": 56239485, "comment_id": 99109507, "body": "Also, this <a href=\"https://stackoverflow.com/questions/27500861/whats-the-proper-way-to-go-get-a-private-repository\">one</a> might be helpful."}, {"owner": {"reputation": 51, "user_id": 11533021, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Z-RzS8zwMuY/AAAAAAAAAAI/AAAAAAAAAAc/b7hn3o-4lFc/photo.jpg?sz=128", "display_name": "Niels", "link": "https://stackoverflow.com/users/11533021/niels"}, "edited": false, "score": 0, "creation_date": 1558505425, "post_id": 56239485, "comment_id": 99118081, "body": "I&#39;m a bit confused, why should this step matter? Since I have everything I need already downloaded to <code>vendor&#47;</code> with <code>go mod vendor</code> or <code>go mod download</code>?"}], "tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": 0, "last_activity_date": 1558445592, "creation_date": 1558445592, "answer_id": 56239485, "question_id": 56236802, "link": "https://stackoverflow.com/questions/56236802/go-build-mod-vendor-fails-to-make-use-of-vendored-packages/56239485#56239485", "title": "`go build -mod vendor` fails to make use of vendored packages", "body": "<p>Go uses https to fetch versions/dependencies. Even if you use vendor, Go will verify the version anyway. And since <code>github.com/venclave/gosystem</code> is a private repo, git can't get access to it.</p>\n\n<p>There are few workarounds for this.</p>\n\n<p>1 - Use ssh:</p>\n\n<pre><code>git config --global url.ssh://git@github.com/venclave.insteadOf https://github.com/venclave\n</code></pre>\n\n<p>2 - Use GitHub token:</p>\n\n<p>Generate GITHUB_TOKEN here <a href=\"https://github.com/settings/tokens\" rel=\"nofollow noreferrer\">https://github.com/settings/tokens</a>. </p>\n\n<pre><code>export GITHUB_TOKEN=xxx\ngit config --global url.\"https://${GITHUB_TOKEN}:x-oauth-basic@github.com/venclave\".insteadOf \"https://github.com/venclave\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 11533021, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Z-RzS8zwMuY/AAAAAAAAAAI/AAAAAAAAAAc/b7hn3o-4lFc/photo.jpg?sz=128", "display_name": "Niels", "link": "https://stackoverflow.com/users/11533021/niels"}, "is_accepted": true, "score": 2, "last_activity_date": 1558619125, "creation_date": 1558619125, "answer_id": 56276663, "question_id": 56236802, "link": "https://stackoverflow.com/questions/56236802/go-build-mod-vendor-fails-to-make-use-of-vendored-packages/56276663#56276663", "title": "`go build -mod vendor` fails to make use of vendored packages", "body": "<p>In the end I was able to make this work by forcing go to use <code>vendor</code>, by adding this to the <code>go.mod</code>:</p>\n\n<pre><code>replace github.com/company/gosystem =&gt; ./vendor/github.com/company/gosystem\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 11533021, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Z-RzS8zwMuY/AAAAAAAAAAI/AAAAAAAAAAc/b7hn3o-4lFc/photo.jpg?sz=128", "display_name": "Niels", "link": "https://stackoverflow.com/users/11533021/niels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2807, "favorite_count": 2, "accepted_answer_id": 56276663, "answer_count": 2, "score": 3, "last_activity_date": 1558619168, "creation_date": 1558436242, "last_edit_date": 1558619168, "question_id": 56236802, "link": "https://stackoverflow.com/questions/56236802/go-build-mod-vendor-fails-to-make-use-of-vendored-packages", "title": "`go build -mod vendor` fails to make use of vendored packages", "body": "<p>When deploying my Go services to Google AppEngine (standard), I receive an errors describing a module version not being found, while everything compiles fine.</p>\n\n<p>The modules are on a private Github instance and checked out to <code>vendor/</code>.</p>\n\n<p>A <code>go build -mod vendor -o /dev/null ./...</code> works in cloud-build-local, locally and in Google Cloud Build.\nA tag called 'v1.1.0' exists on github.com/company/gosystem:</p>\n\n<pre><code>gosystem$ git tag\nv0.0.1\nv0.0.2\nv0.0.3\nv1.0.0\nv1.1.0\n</code></pre>\n\n<pre><code>Failed to build app: [go build -o /tmp/staging172777881/usr/local/bin/start .] with env [PATH=/go/bin:/usr/local/go/bin:/builder/google-cloud-sdk/bin/:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin HOSTNAME=f3f56ce621f0 HOME=/builder/home BUILDER_OUTPUT=/builder/outputs DEBIAN_FRONTEND=noninteractive GOROOT=/usr/local/go/ GOPATH=/go GO111MODULE=on GOCACHE=/tmp/cache019702820 GOPATH=/go] failed: err=exit status 1, out=\"\ngo: finding github.com/pquerna/otp v1.1.0\ngo: finding github.com/gin-gonic/gin v1.4.0\ngo: finding github.com/pkg/errors v0.8.1\ngo: finding github.com/rainycape/unidecode v0.0.0-20150907023854-cb7f23ec59be\ngo: finding github.com/gosimple/slug v1.5.0\ngo: finding github.com/boombuler/barcode v1.0.0\ngo: finding github.com/company/gosystem v1.1.0\ngo: finding github.com/oblq/i18n v0.0.0-20181031085821-98eec2978e00\ngo: finding github.com/go-pg/pg v8.0.4+incompatible\ngo: finding golang.org/x/text v0.3.2\ngo: finding github.com/modern-go/concurrent v0.0.0-20180306012644-bacd9c7ef1dd\ngo: finding github.com/modern-go/reflect2 v1.0.1\ngo: finding github.com/golang/protobuf v1.3.1\ngo: finding github.com/stretchr/testify v1.3.0\ngo: finding github.com/ugorji/go/codec v0.0.0-20190204201341-e444a5086c43\ngo: finding github.com/gin-contrib/sse v0.0.0-20190301062529-5545eab6dad3\ngo: finding github.com/mattn/go-isatty v0.0.7\ngo: github.com/company/gosystem@v1.1.0: unknown revision v1.1.0\n</code></pre>\n\n<p>A <code>grep -RI 'gosystem@' *</code> reports nothing.</p>\n"}, {"tags": ["go", "google-cloud-platform", "google-cloud-bigtable"], "answers": [{"tags": [], "owner": {"reputation": 2345, "user_id": 4511585, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IC7eZ.jpg?s=128&g=1", "display_name": "albttx", "link": "https://stackoverflow.com/users/4511585/albttx"}, "is_accepted": false, "score": 1, "last_activity_date": 1560184491, "last_edit_date": 1560184491, "creation_date": 1558528460, "answer_id": 56256930, "question_id": 56236306, "link": "https://stackoverflow.com/questions/56236306/client-error-while-writing-row-to-cloud-bigtable/56256930#56256930", "title": "Client error while writing row to Cloud Bigtable", "body": "<p>This seems to be a gRPC error.</p>\n\n<p>Maybe you have network latency that cause gRPC error.</p>\n\n<p>You could test to use as mentioned <a href=\"https://stackoverflow.com/questions/52993259/problem-with-grpc-setup-getting-an-intermittent-rpc-unavailable-error/54703234#54703234\">here</a> using Bigtable with your own <a href=\"https://godoc.org/google.golang.org/api/option#WithGRPCConn\" rel=\"nofollow noreferrer\">gRPC conn</a>.</p>\n"}], "owner": {"reputation": 1281, "user_id": 7614909, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-GrKHRMcYN5c/AAAAAAAAAAI/AAAAAAAAAEQ/p_8nqTU7_FY/photo.jpg?sz=128", "display_name": "Akshay Apte", "link": "https://stackoverflow.com/users/7614909/akshay-apte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1560184491, "creation_date": 1558434514, "last_edit_date": 1560184427, "question_id": 56236306, "link": "https://stackoverflow.com/questions/56236306/client-error-while-writing-row-to-cloud-bigtable", "title": "Client error while writing row to Cloud Bigtable", "body": "<p>I am trying to write a row to a Bigtable table using the Go SDK for Bigtable. I am using the apply method on a table object. </p>\n\n<p>I receive the following error when I try to write more than once:</p>\n\n<pre><code>rpc error: code = Canceled desc = grpc: the client connection is closing\n</code></pre>\n\n<p>Following is my code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func Put(tableName string, columnFamilyName string, rowKey string, attrMap map[string]interface{}) error {\n\n    tbl := BigTableClient.Open(tableName)\n    mut := bigtable.NewMutation()\n\n    for key, val := range attrMap {\n        if utils.IsJSON(val.(string)) {\n            v, _ := json.Marshal(val)\n            mut.Set(columnFamilyName, key, bigtable.Now(), []byte(v))\n        } else {\n            v := val.(string)\n            mut.Set(columnFamilyName, key, bigtable.Now(), []byte(v))\n        }\n    }\n    err := tbl.Apply(BigTableContext, rowKey, mut)\n    if err != nil {\n        errMsg := \"Error while writing to BT: \" + err.Error()\n        logger.LogError(errMsg)\n    }\n    return err\n}\n</code></pre>\n\n<p>Can someone help me understand the issue?</p>\n"}, {"tags": ["go", "crash-reports", "sentry", "panic", "raygun"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 8, "last_activity_date": 1558438117, "last_edit_date": 1558438117, "creation_date": 1558430513, "answer_id": 56235139, "question_id": 56234983, "link": "https://stackoverflow.com/questions/56234983/generic-panic-recovering-in-go-programs/56235139#56235139", "title": "Generic panic recovering in go programs", "body": "<p>You have to \"inject\" some code into the function that is launched as a new goroutine: you have to call a deferred function in which you call <code>recover()</code>. This is the only way to recover from a panicing state. See related: <a href=\"https://stackoverflow.com/questions/29518109/why-does-defer-recover-not-catch-panics/29518404#29518404\">Why does `defer recover()` not catch panics?</a></p>\n\n<p>For example:</p>\n\n<pre><code>go func() {\n    defer func() {\n        if r := recover(); r != nil {\n            fmt.Println(\"Caught:\", r)\n        }\n    }()\n\n    panic(\"catch me\")\n}()\n</code></pre>\n\n<p>This will output (try it on the <a href=\"https://play.golang.org/p/zhu-GKUOdAh\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Caught: catch me\n</code></pre>\n\n<p>It is unfeasible to do this in every goroutine you launch, but of course you can move the recovering-logging functionality to a named function, and just call that (but deferred of course):</p>\n\n<pre><code>func main() {\n    go func() {\n        defer logger()\n        panic(\"catch me\")\n    }()\n\n    time.Sleep(time.Second)\n}\n\nfunc logger() {\n    if r := recover(); r != nil {\n        fmt.Println(\"Caught:\", r)\n    }\n}\n</code></pre>\n\n<p>This will output the same (try it on the <a href=\"https://play.golang.org/p/abJa8k7cgP6\" rel=\"nofollow noreferrer\">Go Playground</a>).</p>\n\n<p>Yet another, more convenient and even more compact solution is to create a utility function, a \"wrapper\" which receives the function, and takes care of the recovering.</p>\n\n<p>This is how it could look like:</p>\n\n<pre><code>func wrap(f func()) {\n    defer func() {\n        if r := recover(); r != nil {\n            fmt.Println(\"Caught:\", r)\n        }\n    }()\n\n    f()\n}\n</code></pre>\n\n<p>And now using it is even simpler:</p>\n\n<pre><code>go wrap(func() {\n    panic(\"catch me\")\n})\n\ngo wrap(func() {\n    panic(\"catch me too\")\n})\n</code></pre>\n\n<p>It will output (try it on the <a href=\"https://play.golang.org/p/rpkq3edFFlv\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Caught: catch me\nCaught: catch me too\n</code></pre>\n\n<p><strong>Final note:</strong></p>\n\n<p>Note that launching an actual goroutine happens outside of <code>wrap()</code>. This gives the caller the option to decide if a new goroutine is required just by prefixing the <code>wrap()</code> call with <code>go</code>. Usually this approach is preferred in Go. This allows you to execute arbitrary functions by passing them to <code>wrap()</code>, and it will \"protect\" its execution (by recovering from panics, properly logging / reporting it) even if you do not wish to run it concurrently in a new goroutine.</p>\n"}], "owner": {"reputation": 123, "user_id": 11532710, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V3p7XUIUye8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfWeG63A1nJV-VyraATfuajLzw-Xw/mo/photo.jpg?sz=128", "display_name": "Or Nahum", "link": "https://stackoverflow.com/users/11532710/or-nahum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 837, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1558438117, "creation_date": 1558429951, "question_id": 56234983, "link": "https://stackoverflow.com/questions/56234983/generic-panic-recovering-in-go-programs", "title": "Generic panic recovering in go programs", "body": "<p>I\u2019m trying to catch crashes/panics from go routines that are created in my program, in order to send them to my crash-error-reporting server (such as Sentry/Raygun)</p>\n\n<p>For example,</p>\n\n<pre><code>func main() {\n\n    go func() {\n        // Get this panic\n        panic(\"Go routine panic\")\n    }()\n}\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/a/47808431/11532710\">The answer</a> states a goroutine cannot recover from a panic in another goroutine.</p>\n\n<p>What would be the idiomatic way to go about it?</p>\n"}, {"tags": ["tensorflow", "go", "deep-learning", "recurrent-neural-network"], "owner": {"reputation": 164, "user_id": 10983999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da25d9f17bdc95ee1ca20a746e8f2498?s=128&d=identicon&r=PG&f=1", "display_name": "1b15", "link": "https://stackoverflow.com/users/10983999/1b15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1558684466, "creation_date": 1558428695, "last_edit_date": 1558684466, "question_id": 56234580, "link": "https://stackoverflow.com/questions/56234580/tensorflow-partial-run-on-golang-rnn-states", "title": "Tensorflow Partial Run on Golang (RNN states)", "body": "<p>I have a GRU RNN text generation model that I imported as protobuf in Golang.</p>\n\n<pre><code>model, err := tf.LoadSavedModel(\"poetryModel\", []string{\"goTag\"}, nil)\n</code></pre>\n\n<p>Similar to <a href=\"https://www.tensorflow.org/tutorials/sequences/text_generation#the_prediction_loop\" rel=\"nofollow noreferrer\">the code from this Tensorflow tutorial</a>, I am running a prediction loop:</p>\n\n<pre><code>for len(generated_text) &lt; 1000 {\n    result, err := model.Session.Run(\n            map[tf.Output]*tf.Tensor{\n                model.Graph.Operation(\"inputLayer_input\").Output(0): tensor,\n            },\n            []tf.Output{\n                model.Graph.Operation(\"outputLayer/add\").Output(0),\n            },\n            nil,\n        )\n    ...}\n</code></pre>\n\n<p>However, this implementation discards all intermediate states after every loop which results in bad generated text.\nI tried using <a href=\"https://godoc.org/github.com/tensorflow/tensorflow/tensorflow/go#PartialRun\" rel=\"nofollow noreferrer\">Partial Run</a>, but it threw an error at the second Run:</p>\n\n<pre><code>pr, err := model.Session.NewPartialRun(\n    []tf.Output{ model.Graph.Operation(\"inputLayer_input\").Output(0), },\n    []tf.Output{ model.Graph.Operation(\"outputLayer/add\").Output(0), },\n    []*tf.Operation{ model.Graph.Operation(\"outputLayer/add\") },\n)\nif err != nil {\n    panic(err)\n}\n\n...\n\nresult, err := pr.Run(\n        map[tf.Output]*tf.Tensor{\n            model.Graph.Operation(\"inputLayer_input\").Output(0): tensor,\n        },\n        []tf.Output{\n            model.Graph.Operation(\"outputLayer/add\").Output(0),\n        },\n        nil,\n    )\n</code></pre>\n\n<p><code>Error running the session with input, err: Must run 'setup' before performing partial runs!</code></p>\n\n<p><a href=\"https://stackoverflow.com/questions/45142977/tensorflow-partial-run-must-run-setup-before-performing-partial-runs-desp\">This question</a> is similar to this one, but in Python. Also, there is no documentation of a setup function in Go.\nI am new to working directly with the TF computation graph and Golang, so any help is appreciated.</p>\n"}, {"tags": ["go", "kubernetes", "kubernetes-go-client"], "comments": [{"owner": {"reputation": 31937, "user_id": 2642204, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/AIjBF.jpg?s=128&g=1", "display_name": "BartoszKP", "link": "https://stackoverflow.com/users/2642204/bartoszkp"}, "edited": false, "score": 0, "creation_date": 1559293658, "post_id": 56234251, "comment_id": 99382817, "body": "Can you specify what are you having trouble with exactly? Why creating a list watch for a resource <code>&quot;persistentvolumes&quot;</code> similarly to the example you&#39;ve posted doesn&#39;t work? Also, have tried this way: <a href=\"https://medium.com/programming-kubernetes/building-stuff-with-the-kubernetes-api-part-4-using-go-b1d0e3c1c899\" rel=\"nofollow noreferrer\">medium.com/programming-kubernetes/&hellip;</a> ?"}, {"owner": {"reputation": 519, "user_id": 6680332, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bkTG-Ocx05o/AAAAAAAAAAI/AAAAAAAAA2c/n6WLPcA4z5A/photo.jpg?sz=128", "display_name": "codenio", "link": "https://stackoverflow.com/users/6680332/codenio"}, "edited": false, "score": 0, "creation_date": 1561656270, "post_id": 56234251, "comment_id": 100146456, "body": "changing <code>&amp;v1.Service{}</code> to <code>&amp;v1.PersistentVolume{}</code> throughout would make it work."}], "owner": {"reputation": 81, "user_id": 9010321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97af90454bef9b2b50106888ee39af2b?s=128&d=identicon&r=PG&f=1", "display_name": "Iago Santos", "link": "https://stackoverflow.com/users/9010321/iago-santos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 394, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559292364, "creation_date": 1558427589, "last_edit_date": 1559292364, "question_id": 56234251, "link": "https://stackoverflow.com/questions/56234251/watch-persistentvolumes-with-a-kubernetes-go-client", "title": "watch persistentVolumes with a kubernetes go-client", "body": "<p>In this code I am watching the services, and it is working, my question is, how could I do to watch events when a <code>persistentVolume</code> is being created? I have checked <a href=\"https://github.com/kubernetes/client-go/blob/7b18d6600f6b0022e31c46b46875beffd85cc71a/kubernetes/typed/core/v1/persistentvolume.go#L93\" rel=\"nofollow noreferrer\">the source code</a> and it seems to return an interface, but I am not really familiar of how to make it work.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n\n     \"github.com/golang/glog\"\n\n     \"k8s.io/api/core/v1\"\n     \"k8s.io/apimachinery/pkg/fields\"\n     \"k8s.io/client-go/kubernetes\"\n     \"k8s.io/client-go/tools/cache\"\n     \"k8s.io/client-go/tools/clientcmd\"\n)\n\nfunc main() {\n    config, err := clientcmd.BuildConfigFromFlags(\"\", \"\")\n    if err != nil {\n        glog.Errorln(err)\n    }\n    clientset, err := kubernetes.NewForConfig(config)\n    if err != nil {\n        glog.Errorln(err)\n    }\n\n    watchlist := cache.NewListWatchFromClient(\n        clientset.CoreV1().RESTClient(),\n        string(v1.ResourceServices),\n        v1.NamespaceAll,\n        fields.Everything(),\n    )\n    _, controller := cache.NewInformer( // also take a look at NewSharedIndexInformer\n        watchlist,\n        &amp;v1.Service{},\n        0, //Duration is int64\n        cache.ResourceEventHandlerFuncs{\n            AddFunc: func(obj interface{}) {\n                fmt.Printf(\"service added: %s \\n\", obj)\n            },\n            DeleteFunc: func(obj interface{}) {\n                fmt.Printf(\"service deleted: %s \\n\", obj)\n            },\n            UpdateFunc: func(oldObj, newObj interface{}) {\n                fmt.Printf(\"service changed \\n\")\n            },\n         },\n     )\n         // I found it in k8s scheduler module. Maybe it's help if you \n    interested in.\n     // serviceInformer := \n    cache.NewSharedIndexInformer(watchlist, \n     &amp;v1.Service{}, 0, cache.Indexers{\n     //     cache.NamespaceIndex: cache.MetaNamespaceIndexFunc,\n     // })\n     // go serviceInformer.Run(stop)\n    stop := make(chan struct{})\n    defer close(stop)\n    go controller.Run(stop)\n    for {\n        time.Sleep(time.Second)\n    }\n}\n</code></pre>\n\n<p>Similar of what they are doing <a href=\"https://github.com/kubernetes/client-go/blob/ee7a1ba5cdf1292b67a1fdf1fa28f90d2a7b0084/examples/workqueue/main.go#L165\" rel=\"nofollow noreferrer\">here with pods</a>.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1558427262, "post_id": 56234132, "comment_id": 99087084, "body": "<a href=\"https://golang.org/ref/spec#Selectors\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Selectors</a>"}, {"owner": {"reputation": 386, "user_id": 7272253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca369b631d0b215c62ddb251aa671101?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas Garnier", "link": "https://stackoverflow.com/users/7272253/nicolas-garnier"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1558427575, "post_id": 56234132, "comment_id": 99087250, "body": "Woh yes thank you @Volker! how did I miss that... You can make it an answer if you want so that I can accept it."}], "answers": [{"tags": [], "owner": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "is_accepted": true, "score": 4, "last_activity_date": 1558429801, "creation_date": 1558429801, "answer_id": 56234925, "question_id": 56234132, "link": "https://stackoverflow.com/questions/56234132/golang-embedded-structures/56234925#56234925", "title": "Golang embedded structures", "body": "<p>Golang specification actually states how embedded fields are resolved</p>\n\n<blockquote>\n  <p>A selector f may denote a field or method f of a type T, or it may\n  refer to a field or method f of a nested embedded field of T. The\n  number of embedded fields traversed to reach f is called its depth in\n  T. The depth of a field or method f declared in T is zero. The depth\n  of a field or method f declared in an embedded field A in T is the\n  depth of f in A plus one.</p>\n</blockquote>\n\n<p>Then...</p>\n\n<blockquote>\n  <p>For a value x of type T or *T where T is not a pointer or interface\n  type, x.f denotes the field or method at the shallowest depth in T\n  where there is such an f. If there is not exactly one f with\n  shallowest depth, the selector expression is illegal.</p>\n</blockquote>\n"}], "owner": {"reputation": 386, "user_id": 7272253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca369b631d0b215c62ddb251aa671101?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas Garnier", "link": "https://stackoverflow.com/users/7272253/nicolas-garnier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "accepted_answer_id": 56234925, "answer_count": 1, "score": 0, "last_activity_date": 1558429801, "creation_date": 1558427140, "question_id": 56234132, "link": "https://stackoverflow.com/questions/56234132/golang-embedded-structures", "title": "Golang embedded structures", "body": "<p>I am a little confused with a behavior of Go regarding variable 'overriding' in embedded structure.</p>\n\n<p><strong>First situation</strong>\nIf a <code>child</code> structure embeds a <code>parent</code> structure containing a field <code>Attr</code>, I can access the value of Attr indifferently with <code>child.Attr</code> or <code>child.parent.Attr</code>. Here is an <a href=\"https://play.golang.org/p/-E0tI99UVBx\" rel=\"nofollow noreferrer\">example</a> :</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n)\n\ntype parent struct {\n    Attr    int `json:\"attr\"`\n}\n\ntype child struct {\n    parent\n}\n\nfunc main() {\n    var c child\n    json.Unmarshal([]byte(`{\"i\": 1}`), &amp;c)\n    fmt.Println(c.Attr)\n    fmt.Println(c.parent.Attr)\n}\n</code></pre>\n\n<p><strong>Second situation</strong>\nHowever, if the child structure contains itself a field named <code>Attr</code>, those two fields are different and can be accessed separately, as shows the following <a href=\"https://play.golang.org/p/TzCB6WT-L2A\" rel=\"nofollow noreferrer\">example</a> :</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n)\n\ntype parent struct {\n    Attr    int `json:\"attr\"`\n}\n\ntype child struct {\n    parent\n    Attr    int\n}\n\nfunc main() {\n    var c child\n    json.Unmarshal([]byte(`{\"attr\": 1}`), &amp;c)\n    fmt.Println(c.Attr)\n    fmt.Println(c.parent.Attr)\n}\n</code></pre>\n\n<p>I am very surprised that this implicit behavior is allowed in golang. I would have expected the language to be stricter as it is on so many points. Besides, I wasn't able to find a clear specification about this. Is it just a side-effect or can I use that feature?</p>\n"}, {"tags": ["ruby-on-rails", "go", "activerecord", "orm", "go-gorm"], "owner": {"reputation": 979, "user_id": 916419, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/571208354/picture?type=large", "display_name": "Jingqiang Zhang", "link": "https://stackoverflow.com/users/916419/jingqiang-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 523, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1558429876, "creation_date": 1558426470, "last_edit_date": 1558429876, "question_id": 56233963, "link": "https://stackoverflow.com/questions/56233963/how-to-detect-one-column-changed-with-gorm", "title": "How to detect one column changed with gorm", "body": "<p>Rails' ActiveRecord has <code>saved_change_to_attribute</code> method:\n<a href=\"https://api.rubyonrails.org/classes/ActiveRecord/AttributeMethods/Dirty.html#method-i-saved_change_to_attribute\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/classes/ActiveRecord/AttributeMethods/Dirty.html#method-i-saved_change_to_attribute</a></p>\n\n<p>It can detect which column has been changed then do something.</p>\n\n<p>Didn't find any method with Go's ORM library <code>gorm</code>. Is it possible?</p>\n"}, {"tags": ["performance", "go", "performance-testing"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1558416968, "post_id": 56231432, "comment_id": 99082675, "body": "This is unanswerable: The compiler is not obliged to not rewrite your code and may or may not optimize both version to the same code or even optimize that one you think to be slower to the faster one. Microbenchmarks are very hard to do and even harder to analyze (and thus are mostly a waste of time)."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 3, "creation_date": 1558417046, "post_id": 56231432, "comment_id": 99082706, "body": "The call to len compiles to a field access in the slice header."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1558418265, "post_id": 56231432, "comment_id": 99083088, "body": "The compiler may detect that the value of <code>input</code> doesn&#39;t change and thus <code>len(input)</code> also doesn&#39;t change, and may only evaluate it once, giving no performance penalty at all, just as you experienced."}], "answers": [{"comments": [{"owner": {"reputation": 879, "user_id": 3778355, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/57af174c54dc32e59d8a528805e4a9db?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/3778355/richard"}, "edited": false, "score": 0, "creation_date": 1558429408, "post_id": 56234238, "comment_id": 99088305, "body": "I did run it multiple times, maybe it was not clear but the speed difference was related to the length of the array"}, {"owner": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "reply_to_user": {"reputation": 879, "user_id": 3778355, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/57af174c54dc32e59d8a528805e4a9db?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/3778355/richard"}, "edited": false, "score": 0, "creation_date": 1558430020, "post_id": 56234238, "comment_id": 99088712, "body": "That was clear. But performance evaluation is about statistics, that requires enough samples in order to work properly. A single run of a benchmark, even with increasing array size, cannot tell which for-loop is the fastest, especially if the difference is only 0.08ns."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1558431061, "post_id": 56234238, "comment_id": 99089350, "body": "Arrays don&#39;t have headers like slices. <code>len()</code> for arrays is a compile time evaluation, as the length is part of the array type."}], "tags": [], "owner": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "is_accepted": false, "score": 0, "last_activity_date": 1558427533, "creation_date": 1558427533, "answer_id": 56234238, "question_id": 56231432, "link": "https://stackoverflow.com/questions/56231432/for-loop-speed-comparison/56234238#56234238", "title": "for loop speed comparison", "body": "<p>One may argue that a difference of 0.08ns is not statistically relevant to say that one for-loop is faster than the other. You problably need to run the same test many times (more than 20 times at least), at that point you should be able to derive mean value and standard variation. </p>\n\n<p>Moreover, there are many factors that can speedup the <code>len()</code> operator. Like CPU cache and compiler optimizations. I think that the most relevant factor in your specific example is that <code>len()</code> operator for slice and array just reads the <code>len</code> field in <a href=\"https://github.com/golang/go/blob/master/src/runtime/slice.go\" rel=\"nofollow noreferrer\">slice</a>'s data structure. Thus, it is O(1).</p>\n"}], "owner": {"reputation": 879, "user_id": 3778355, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/57af174c54dc32e59d8a528805e4a9db?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/3778355/richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 235, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1558429481, "creation_date": 1558415269, "last_edit_date": 1558429481, "question_id": 56231432, "link": "https://stackoverflow.com/questions/56231432/for-loop-speed-comparison", "title": "for loop speed comparison", "body": "<p>I was wondering how fast was the <code>len</code> operator in Go and I wrote a simple benchmark. My expectations were that by avoiding calling <code>len</code> during each loop iteration, the code would run faster, but it is in fact the opposite.</p>\n\n<p>Here's the benchmark:</p>\n\n<pre><code>func sumArrayNumber(input []int) int {\n    var res int\n    for i, length := 0, len(input); i &lt; length; i += 1 {\n        res += input[i]\n    }\n    return res\n}\n\nfunc sumArrayNumber2(input []int) int {\n    var res int\n    for i := 0; i &lt; len(input); i += 1 {\n        res += input[i]\n    }\n    return res\n}\n\nvar result int\nvar input = []int{3, 6, 22, 68, 11, -7, 22, 5, 0, 0, 1}\n\nfunc BenchmarkSumArrayNumber(b *testing.B) {\n    var r int\n    for n := 0; n &lt; b.N; n++ {\n        r = sumArrayNumber(input)\n    }\n    result = r\n}\n\nfunc BenchmarkSumArrayNumber2(b *testing.B) {\n    var r int\n    for n := 0; n &lt; b.N; n++ {\n        r = sumArrayNumber2(input)\n    }\n    result = r\n}\n</code></pre>\n\n<p>And here are the results:</p>\n\n<pre><code>goos: windows\ngoarch: amd64\nBenchmarkSumArrayNumber-8       300000000                4.75 ns/op\nBenchmarkSumArrayNumber2-8      300000000                4.67 ns/op\nPASS\nok      command-line-arguments  4.000s\n</code></pre>\n\n<p>I confirmed the resistent are consistents by doing the following:</p>\n\n<ul>\n<li>doubling the input array size roughly double the execution time per op. The speed difference scales with the length of the input array.</li>\n<li>exchanging the test order does not impact the results.</li>\n</ul>\n\n<p>Why is the code checking len() at every loop iteration is faster?</p>\n"}, {"tags": ["go", "kubernetes", "kubernetes-go-client"], "answers": [{"tags": [], "owner": {"reputation": 2647, "user_id": 4628962, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/avtRP.png?s=128&g=1", "display_name": "Abdullah Al Maruf - Tuhin", "link": "https://stackoverflow.com/users/4628962/abdullah-al-maruf-tuhin"}, "is_accepted": true, "score": 8, "last_activity_date": 1558419483, "creation_date": 1558419483, "answer_id": 56232153, "question_id": 56231176, "link": "https://stackoverflow.com/questions/56231176/kubernetes-client-go-convert-labelselector-to-label-string/56232153#56232153", "title": "kubernetes client-go: convert labelselector to label string", "body": "<p>You can use <code>LabelSelectorAsMap(LabelSelector)</code> function to convert the labelselector into <code>map[string]string</code> map. </p>\n\n<p>Then, use <code>SelectorFromSet</code> function of package <code>k8s.io/apimachinery/pkg/labels</code> to convert <code>map</code> to selector/strings.</p>\n\n<p>Pseudo code:</p>\n\n<pre><code>import (\n    \"k8s.io/apimachinery/pkg/labels\"\n    metav1 \"k8s.io/apimachinery/pkg/apis/meta/v1\"\n)\n\nfunc ListPod(labelSelector metav1.LabelSelector) {\n\n    labelMap := metav1.LabelSelectorAsMap(labelSelector)\n\n    options := metav1.ListOptions{\n        LabelSelector: labels.SelectorFromSet(labelMap).String(),\n    }\n\n    podList, err := clientset.CoreV1().Pods(\"&lt;namespace&gt;\").List(options)\n\n}\n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 1863853, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/697374e2e81e29dacdcc4783e89c0256?s=128&d=identicon&r=PG", "display_name": "bobbel", "link": "https://stackoverflow.com/users/1863853/bobbel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3025, "favorite_count": 1, "accepted_answer_id": 56232153, "answer_count": 1, "score": 5, "last_activity_date": 1558419483, "creation_date": 1558413491, "question_id": 56231176, "link": "https://stackoverflow.com/questions/56231176/kubernetes-client-go-convert-labelselector-to-label-string", "title": "kubernetes client-go: convert labelselector to label string", "body": "<p>In the kubernetes client-go API (or another library that uses it), is there a utility function to convert a <code>k8s.io/apimachinery/pkg/apis/meta/v1/LabelSelector</code> to a string to fill the field <code>LabelSelector</code> in <code>k8s.io/apimachinery/pkg/apis/meta/v1/ListOptions</code>?</p>\n\n<p>I digged through the code of <code>client-go</code> but I can't find a function like that.</p>\n\n<p>The <code>LabelSelector.Marshall()</code> nor <code>LabelSelector.String()</code> give me that (unsurprisingly, because that's not their purpose, but I tried it anyway).</p>\n\n<h3>Background</h3>\n\n<p>I have spec descriptions like <code>k8s.io/api/extensions/v1beta1/Deployment</code>, and want to use it's set of selector labels (i.e. the <code>Selector</code> field) to query it's pods using </p>\n\n<pre><code>options := metav1.ListOptions{\n    LabelSelector: &lt;stringified labels&gt;,\n}\n\npodList, err := clientset.CoreV1().Pods(&lt;namespace&gt;).List(options)\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1968, "user_id": 9263083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d74d9629591720e7e7bc8ddd3f35c92?s=128&d=identicon&r=PG&f=1", "display_name": "sanoJ", "link": "https://stackoverflow.com/users/9263083/sanoj"}, "is_accepted": false, "score": 1, "last_activity_date": 1558449919, "creation_date": 1558449919, "answer_id": 56240857, "question_id": 56230256, "link": "https://stackoverflow.com/questions/56230256/how-to-add-an-example-for-mapstringstring/56240857#56240857", "title": "How to add an example for []map[string]string", "body": "<p>The current version of <a href=\"https://github.com/swaggo/swag\" rel=\"nofollow noreferrer\">swag</a> doesn't support examples for map variable type according to the <a href=\"https://github.com/swaggo/swag/blob/266aebcda91591bae22ba0efe7f4c919434a88b3/parser.go#L1006-L1039\" rel=\"nofollow noreferrer\">parser</a> </p>\n"}], "owner": {"reputation": 37, "user_id": 6526534, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ogkuHONxoP4/AAAAAAAAAAI/AAAAAAAAAA8/ODGGwLYa930/photo.jpg?sz=128", "display_name": "fiz", "link": "https://stackoverflow.com/users/6526534/fiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1558449919, "creation_date": 1558404979, "question_id": 56230256, "link": "https://stackoverflow.com/questions/56230256/how-to-add-an-example-for-mapstringstring", "title": "How to add an example for []map[string]string", "body": "<p>I used the <a href=\"https://github.com/swaggo/swag\" rel=\"nofollow noreferrer\">https://github.com/swaggo/swag</a> library to automatically generate the api document. I have a data type of []map[string]string, how should I add an example?</p>\n\n<p>I checked the doc ,but now show about type []map[string]string.\nthe docs sites: <a href=\"https://github.com/swaggo/swag\" rel=\"nofollow noreferrer\">https://github.com/swaggo/swag</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type UploadReq struct {\n    FilesM   []map[string]string `form:\"files\" json:\"files\" binding:\"required\" example:\"TODO\"`\n    Tag      string              `form:\"tag\" json:\"tag\" binding:\"required\" example:\"TestTag\"` \n    IsPublic bool                `form:\"is_public\" json:\"is_pub\" binding:\"required\" example:\"true\" `\n}\n\n</code></pre>\n"}, {"tags": ["go", "gob"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 9156254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14affbe79515fe703175b4e77a66590a?s=128&d=identicon&r=PG&f=1", "display_name": "hhdidid", "link": "https://stackoverflow.com/users/9156254/hhdidid"}, "edited": false, "score": 0, "creation_date": 1558419223, "post_id": 56231633, "comment_id": 99083441, "body": "Thanks for your answer!"}], "tags": [], "owner": {"reputation": 4679, "user_id": 749854, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/541a5cb4925d352cac921c21e9213aa4?s=128&d=identicon&r=PG", "display_name": "nvcnvn", "link": "https://stackoverflow.com/users/749854/nvcnvn"}, "is_accepted": true, "score": 2, "last_activity_date": 1558416677, "creation_date": 1558416677, "answer_id": 56231633, "question_id": 56230143, "link": "https://stackoverflow.com/questions/56230143/why-decode-two-different-objects-into-a-same-object-but-the-bool-member-has-not/56231633#56231633", "title": "Why decode two different objects into a same object, but the bool member has not been changed?", "body": "<p>Base on the document: <a href=\"https://golang.org/pkg/encoding/gob/#hdr-Encoding_Details\" rel=\"nofollow noreferrer\">https://golang.org/pkg/encoding/gob/#hdr-Encoding_Details</a></p>\n\n<blockquote>\n  <p>If a field has the zero value for its type (except for arrays; see above), it is omitted from the transmission.</p>\n</blockquote>\n\n<p>And \"false\" is zero value. If you try to set <code>t2.X = 0</code> it will show you the same behavior.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11541044, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-infmkncKSV4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfQX3dcD1cQYBrFAtSMyxP3NRykYg/mo/photo.jpg?sz=128", "display_name": "Raphael Gavache", "link": "https://stackoverflow.com/users/11541044/raphael-gavache"}, "is_accepted": false, "score": 0, "last_activity_date": 1558550750, "creation_date": 1558550750, "answer_id": 56263136, "question_id": 56230143, "link": "https://stackoverflow.com/questions/56230143/why-decode-two-different-objects-into-a-same-object-but-the-bool-member-has-not/56263136#56263136", "title": "Why decode two different objects into a same object, but the bool member has not been changed?", "body": "<p>The unexpected behavior comes from reusing memory without cleaning it.\nYou are reusing twice t and b which exposes you to many possible bugs. Here it's t that generates your problem but it could have been b too.</p>\n\n<p>As answered by nvcnvn it's an expected behavior for gob encoding to not consider fields with 0 values in types. See encoded structures number of bytes gain in size: <a href=\"https://play.golang.org/p/HCz8-2kXHQX\" rel=\"nofollow noreferrer\">https://play.golang.org/p/HCz8-2kXHQX</a></p>\n\n<p>If you want to reuse bytes.Buffer without any extra alloc and be safe, Reset it's values: <a href=\"https://golang.org/pkg/bytes/#Buffer.Reset\" rel=\"nofollow noreferrer\">https://golang.org/pkg/bytes/#Buffer.Reset</a></p>\n"}], "owner": {"reputation": 35, "user_id": 9156254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14affbe79515fe703175b4e77a66590a?s=128&d=identicon&r=PG&f=1", "display_name": "hhdidid", "link": "https://stackoverflow.com/users/9156254/hhdidid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 56231633, "answer_count": 2, "score": 2, "last_activity_date": 1558550750, "creation_date": 1558403970, "question_id": 56230143, "link": "https://stackoverflow.com/questions/56230143/why-decode-two-different-objects-into-a-same-object-but-the-bool-member-has-not", "title": "Why decode two different objects into a same object, but the bool member has not been changed?", "body": "<p>I'm using go's encoding/gob to decode two different objects which type are T into a same object, but the object's bool member has not been changed after the second decode. Why?</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/gob\"\n    \"bytes\"\n)\n\ntype T struct {\n    X int\n    Y string\n    Z bool\n}\n\nfunc main() {\n    t := T{}\n    buf := new(bytes.Buffer)\n    enc := gob.NewEncoder(buf)\n    dec := gob.NewDecoder(buf)\n\n    t1 := T{1, \"1\", true}\n    enc.Encode(t1)\n    dec.Decode(&amp;t)\n    fmt.Printf(\"%+v\\n\", t)\n\n    // If t is a new entity, the second decode into t can product expected result: {X:2 Y:2 Z:false}\n    // otherwise, t's bool member has not been changed after the second decode.\n    // t = T{}\n    t2 := T{2, \"2\", false}\n    enc.Encode(t2)\n    dec.Decode(&amp;t)\n    fmt.Printf(\"%+v\\n\", t)\n\n    // result:\n    // {X:1 Y:1 Z:true}\n    // {X:2 Y:2 Z:true}\n}\n</code></pre>\n"}, {"tags": ["go", "yaml"], "answers": [{"tags": [], "owner": {"reputation": 3123, "user_id": 7803527, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bskeA.jpg?s=128&g=1", "display_name": "Dean Xu", "link": "https://stackoverflow.com/users/7803527/dean-xu"}, "is_accepted": false, "score": 4, "last_activity_date": 1558398999, "creation_date": 1558398999, "answer_id": 56229719, "question_id": 56229120, "link": "https://stackoverflow.com/questions/56229120/how-to-parse-yaml-with-arbitrary-keys/56229719#56229719", "title": "How to Parse YAML with arbitrary keys", "body": "<p>You should use <code>m := make(map[string]Item)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 8448859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db9973180d445e785702fccad06786c8?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen D", "link": "https://stackoverflow.com/users/8448859/stephen-d"}, "edited": false, "score": 1, "creation_date": 1558445985, "post_id": 56229735, "comment_id": 99097921, "body": "Thank you this worked perfectly!"}], "tags": [], "owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "is_accepted": true, "score": 5, "last_activity_date": 1558399219, "creation_date": 1558399219, "answer_id": 56229735, "question_id": 56229120, "link": "https://stackoverflow.com/questions/56229120/how-to-parse-yaml-with-arbitrary-keys/56229735#56229735", "title": "How to Parse YAML with arbitrary keys", "body": "<p>For unmarshaling to work the way you want, you should provide the instruction. In your case if you do not want to name to be in a map provide a struct to unmarshal.</p>\n\n<p>so <code>m := make(map[interface{}]interface{})</code> should change to <code>m := make(map[string]Item)</code></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"gopkg.in/yaml.v2\"\n)\n\ntype Item struct {\n    Name string `yaml:\"name\"`\n}\n\nfunc main() {\n    input := `\n  apple:\n    name: item1\n  banana:\n    name: item2`\n\n    m := make(map[string]Item)\n\n    err := yaml.Unmarshal([]byte(input), &amp;m)\n    if err != nil {\n        log.Fatalf(\"error: %v\", err)\n    }\n    fmt.Printf(\"%v \\n\", m)\n}\n</code></pre>\n\n<p>Output: <code>map[apple:{item1} banana:{item2}]</code></p>\n"}], "owner": {"reputation": 43, "user_id": 8448859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db9973180d445e785702fccad06786c8?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen D", "link": "https://stackoverflow.com/users/8448859/stephen-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1827, "favorite_count": 0, "closed_date": 1558421847, "accepted_answer_id": 56229735, "answer_count": 2, "score": 4, "last_activity_date": 1558421943, "creation_date": 1558392773, "question_id": 56229120, "link": "https://stackoverflow.com/questions/56229120/how-to-parse-yaml-with-arbitrary-keys", "closed_reason": "Duplicate", "title": "How to Parse YAML with arbitrary keys", "body": "<p>I'm trying to read in a YAML file similar to how I've done in Python. But I can't figure out how to use arbitrary keys.\nI have the following YAML that I would like to read:</p>\n\n<pre><code>apple:\n  name: item1\nbanana:\n  name: item2\n</code></pre>\n\n<p>I know how to read in the file, but only using empty interfaces. I'd like to read it in as a map to my Item type. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"gopkg.in/yaml.v2\"\n)\n\ntype Item struct {\n    Name string `yaml:\"name\"`\n}\n\nfunc main() {\n    input := `\n  apple:\n    name: item1\n  banana:\n    name: item2`\n\n    m := make(map[interface{}]interface{})\n\n    err := yaml.Unmarshal([]byte(input), &amp;m)\n    if err != nil {\n        log.Fatalf(\"error: %v\", err)\n    }\n    fmt.Printf(\"%v \\n\", m)\n}\n</code></pre>\n\n<p>What I'm getting in Stdout:</p>\n\n<pre><code>map[apple:map[name:item1] banana:map[name:item2]]\n</code></pre>\n\n<p>What I would like to see is:</p>\n\n<pre><code>map[apple:{item1} banana:{item2}] \n</code></pre>\n\n<p>How can I read my YAML file into a map of Item(s)?</p>\n"}, {"tags": ["go", "amazon-dynamodb"], "answers": [{"tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": true, "score": 0, "last_activity_date": 1558422838, "creation_date": 1558422838, "answer_id": 56232989, "question_id": 56228969, "link": "https://stackoverflow.com/questions/56228969/query-key-condition-not-supported/56232989#56232989", "title": "Query key condition not supported", "body": "<p>You should use expression Builder:</p>\n\n<pre><code>// todo: please check if value should be converted to another type in your case\nkeyCond := expression.Key(\"unix_time\").LessThenEqual(expression.Value(\"1558130473454419\"))\nproj := expression.NamesList(expression.Name(\"id\"), expression.Name(\"num_users\"), expression.Name(\"salesforce_campaign\"), expression.Name(\"unix_time\"))\n\nexpr, err := expression.NewBuilder().\n    WithKeyCondition(keyCond).\n    WithProjection(proj).\n    Build()\nif err != nil {\n    fmt.Println(err)\n}\n\ninput := &amp;dynamodb.QueryInput{\n    ExpressionAttributeValues: expr.Values(),\n    KeyConditionExpression:    expr.KeyCondition(),\n    ProjectionExpression:      expr.Projection(),\n    TableName:                 aws.String(table),\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11530665, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SHvyBxoPdB4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3recDKYXL7bsgGlgtSAeplmy1fAu-w/mo/photo.jpg?sz=128", "display_name": "Peter Sjolin", "link": "https://stackoverflow.com/users/11530665/peter-sjolin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 56232989, "answer_count": 1, "score": 0, "last_activity_date": 1558422838, "creation_date": 1558391503, "question_id": 56228969, "link": "https://stackoverflow.com/questions/56228969/query-key-condition-not-supported", "title": "Query key condition not supported", "body": "<p>I am trying to get all rows past a certain time stamp.</p>\n\n<p>I have also tried using \"GE\", \"LE\", \"GT\" in the condition but I get a syntax error.</p>\n\n<p>I get the following DynamoDB error:</p>\n\n<pre><code>Internal Server Error [ValidationException: Query key condition not supported\n    status code: 400,\n</code></pre>\n\n<p>I have the following table</p>\n\n<pre><code>Table name  GroupsLambda3\nPrimary partition key   id (String)\nPrimary sort key    -\nPoint-in-time recovery  DISABLEDEnable\nEncryption Type DEFAULTManage Encryption\nKMS Master Key ARN  Not Applicable\nTime to live attribute  DISABLEDManage TTL\n</code></pre>\n\n<p>Then I have created asecondary index on</p>\n\n<pre><code>Name: unix_time-index\nStatus: Active\nType: GSI\nPartition Key: unix_time (Number)\nSort Key: unix_time-index\n</code></pre>\n\n<p>Finally my Golang code is:</p>\n\n<pre><code>    var cond string\n    cond = \"unix_time &lt;= :v_unix_time\"\n    var projection string\n    projection = \"id, num_users, salesforce_campaign, unix_time\"\n    input := &amp;dynamodb.QueryInput{\n        TableName:              aws.String(table),\n        IndexName:              aws.String(\"unix_time-index\"),\n        KeyConditionExpression: &amp;cond,\n        ProjectionExpression:   &amp;projection,\n        ExpressionAttributeValues: map[string]*dynamodb.AttributeValue{\n            \":v_unix_time\": {\n                N: aws.String(\"1558130473454419\"),\n            },\n        },\n</code></pre>\n\n<p>The code works when I do <code>cond = \"unix_time = :v_unix_time\"</code>, equals only.</p>\n\n<p>I expect all rows with a lesser unix_timestamp.</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1558389217, "post_id": 56228586, "comment_id": 99077398, "body": "Are you asking about basic syntax? A slice type starts with <code>[]</code>, so <code>[]Node</code> for a slice of <code>Node</code>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1558448427, "post_id": 56228586, "comment_id": 99099450, "body": "Please take the <a href=\"https://tour.golang.org/\" rel=\"nofollow noreferrer\">Tour of Go</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1025, "user_id": 7253829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qe9lZ.jpg?s=128&g=1", "display_name": "waymobetta", "link": "https://stackoverflow.com/users/7253829/waymobetta"}, "is_accepted": true, "score": 1, "last_activity_date": 1558390198, "creation_date": 1558390198, "answer_id": 56228801, "question_id": 56228586, "link": "https://stackoverflow.com/questions/56228586/slice-array-of-structs-inside-a-struct/56228801#56228801", "title": "slice/array of structs inside a struct", "body": "<p>As @JimB pointed out, you'll need a slice of Node objects. Just create a new field within the Service struct to store a slice of Node objects and then append each Node object to that slice of Node objects.</p>\n\n<p>4 minor edits to your code:</p>\n\n<pre><code>type Service struct {\n    ServiceName string\n    NodeCount   int\n    HeadNode    Node\n    Health      bool\n    // include Nodes field as a slice of Node objects\n    Nodes       []Node\n}\n\n// local variable to hold the slice of Node objects\nnodes := []Node{}\n\n// append each Node to the slice of Node objects\nnodes = append(nodes, Node1, Node2, Node3)\n\n// include the slice of Node objects to the Service object during initialization\nmyService := Service{\"PotatoServer\", 3, Node1, true, nodes}\n</code></pre>\n\n<p>See a working example in the <a href=\"https://play.golang.org/p/PAz9-4cMkWK\" rel=\"nofollow noreferrer\">playground</a></p>\n"}], "owner": {"reputation": 972, "user_id": 9488865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d560f151faf6a0565f7cebd93958acf?s=128&d=identicon&r=PG&f=1", "display_name": "struggling_learner", "link": "https://stackoverflow.com/users/9488865/struggling-learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 56228801, "answer_count": 1, "score": -5, "last_activity_date": 1558390198, "creation_date": 1558388810, "question_id": 56228586, "link": "https://stackoverflow.com/questions/56228586/slice-array-of-structs-inside-a-struct", "title": "slice/array of structs inside a struct", "body": "<p>Please consider this go snippet: <a href=\"https://play.golang.org/p/JkMIRwshG5U\" rel=\"nofollow noreferrer\">https://play.golang.org/p/JkMIRwshG5U</a> </p>\n\n<p>My <code>Service</code> struct holds:</p>\n\n<pre><code>type Service struct {\n    ServiceName string\n    NodeCount   int\n    HeadNode    Node\n    Health      bool\n}\n</code></pre>\n\n<p>and my Node struct has:</p>\n\n<pre><code>type Node struct {\n    NodeName  string\n    LastHeard int\n    Role      bool\n    Health    bool\n}\n</code></pre>\n\n<p>Suppose if I've 3 nodes for my Service; I'd like the <code>Service</code> struct to also have/keep a list of Nodes. Or, a slice of structs since this is Go, and how do I represent this in <code>Service</code> struct? (Sorry if this question still comes across ambiguous!) </p>\n"}, {"tags": ["go", "gorilla"], "comments": [{"owner": {"reputation": 6198, "user_id": 2020002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t9iFY.jpg?s=128&g=1", "display_name": "Derek Pollard", "link": "https://stackoverflow.com/users/2020002/derek-pollard"}, "edited": false, "score": 0, "creation_date": 1558384898, "post_id": 56227793, "comment_id": 99076066, "body": "think of the way this is executed.... <code>DELETE &#47;article&#47;{id}</code> matches <code>myRouter.HandleFunc(&quot;&#47;article&#47;{id}&quot;, getOneArticle)</code> so the program doesn&#39;t continue to the next route"}, {"owner": {"reputation": 511, "user_id": 9195780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bb7aa53691bd1cd7b951973add47c67?s=128&d=identicon&r=PG&f=1", "display_name": "Ping Woo", "link": "https://stackoverflow.com/users/9195780/ping-woo"}, "reply_to_user": {"reputation": 6198, "user_id": 2020002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t9iFY.jpg?s=128&g=1", "display_name": "Derek Pollard", "link": "https://stackoverflow.com/users/2020002/derek-pollard"}, "edited": false, "score": 0, "creation_date": 1558398352, "post_id": 56227793, "comment_id": 99079127, "body": "but what is I put DELETE first, the following getOneArticle still works,"}, {"owner": {"reputation": 511, "user_id": 9195780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bb7aa53691bd1cd7b951973add47c67?s=128&d=identicon&r=PG&f=1", "display_name": "Ping Woo", "link": "https://stackoverflow.com/users/9195780/ping-woo"}, "reply_to_user": {"reputation": 6198, "user_id": 2020002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t9iFY.jpg?s=128&g=1", "display_name": "Derek Pollard", "link": "https://stackoverflow.com/users/2020002/derek-pollard"}, "edited": false, "score": 0, "creation_date": 1558398384, "post_id": 56227793, "comment_id": 99079138, "body": "So DELETE request matching GET operation???"}], "answers": [{"tags": [], "owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "is_accepted": true, "score": 4, "last_activity_date": 1558398961, "creation_date": 1558398961, "answer_id": 56229716, "question_id": 56227793, "link": "https://stackoverflow.com/questions/56227793/why-i-put-the-delete-router-after-get-the-delete-endpoint-did-not-get-triggered/56229716#56229716", "title": "Why I put the DELETE router after GET, the DELETE endpoint did not get triggered", "body": "<p>You're using gorilla/mux. When an HTTP request comes in, this router tries to match routes in the order in which you add them.</p>\n\n<p>When you add the route without specifying an HTTP method, it applies to all HTTP methods.</p>\n\n<p>So, if your more specific route matching the DELETE method comes first, then it will match DELETE method calls, and the next route will match all methods. While it would match DELETE also, an actual DELETE call would never reach it because of the route preceding it.</p>\n\n<p>But if you reverse them, the route which doesn't specify an HTTP method will match all methods, including DELETE.</p>\n"}], "owner": {"reputation": 511, "user_id": 9195780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bb7aa53691bd1cd7b951973add47c67?s=128&d=identicon&r=PG&f=1", "display_name": "Ping Woo", "link": "https://stackoverflow.com/users/9195780/ping-woo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 56229716, "answer_count": 1, "score": 0, "last_activity_date": 1558449717, "creation_date": 1558384328, "last_edit_date": 1558449717, "question_id": 56227793, "link": "https://stackoverflow.com/questions/56227793/why-i-put-the-delete-router-after-get-the-delete-endpoint-did-not-get-triggered", "title": "Why I put the DELETE router after GET, the DELETE endpoint did not get triggered", "body": "<p>I was creating restful API with Golang and I put the delete router after the getOne router by index, and the delete router never got triggered? I don't know why? When I reverse them, it works!\nCan someone know the reason??</p>\n\n<p>This is for Building Restful API with Golang.</p>\n\n<p>Not works:</p>\n\n<pre><code>myRouter.HandleFunc(\"/article\", createNewArticle).Methods(\"POST\")\n\nmyRouter.HandleFunc(\"/article/{id}\", getOneArticle)\n\nmyRouter.HandleFunc(\"/article/{id}\", deleteArticle).Methods(\"DELETE\")\n</code></pre>\n\n<p>Works!</p>\n\n<pre><code>myRouter.HandleFunc(\"/article\", createNewArticle).Methods(\"POST\")\nmyRouter.HandleFunc(\"/article/{id}\", deleteArticle).Methods(\"DELETE\")\nmyRouter.HandleFunc(\"/article/{id}\", getOneArticle)\n</code></pre>\n\n<p>When I test the api using postman with DELETE methods, it always trigger the getOneArticle and respond with the delete item, but did not actually delete in the database!</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 1126, "user_id": 3508174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vfMCq.jpg?s=128&g=1", "display_name": "Sergey Narozhnyy", "link": "https://stackoverflow.com/users/3508174/sergey-narozhnyy"}, "edited": false, "score": 0, "creation_date": 1558468434, "post_id": 56227744, "comment_id": 99109422, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/a/26576589/3508174\">Best practice to maintain a mgo session</a>."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1562824523, "post_id": 56227744, "comment_id": 100500184, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/26574594/best-practice-to-maintain-a-mgo-session\">Best practice to maintain a mgo session</a>"}], "owner": {"reputation": 970, "user_id": 1445634, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/bd53d00d28f28bdec62ebb162db7b688?s=128&d=identicon&r=PG", "display_name": "MichaelB", "link": "https://stackoverflow.com/users/1445634/michaelb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558384101, "creation_date": 1558384101, "question_id": 56227744, "link": "https://stackoverflow.com/questions/56227744/golang-mgo-store-session-or-collection", "title": "Golang mgo store Session or Collection", "body": "<p>When my server starts up, it will create a connection to a mongo database, grab that <code>*mgo.Session</code> and store it in a \"server\" struct for handlers defined on that struct to use to serve requests.</p>\n\n<p>I see two ways to actually execute this.</p>\n\n<pre><code>1) Save the `*mgo.Session` in the struct.\n</code></pre>\n\n<p>The upside of this is that you can call <code>Session.Copy</code> in each handler before using the session to have connection isolation. The downside is that you need to call <code>.DB(\"x\").C(\"y\")</code> for a specific <code>x</code> and <code>y</code> for each handler. If you wanted to change this, you need to find each instance where you're using it and change it. That's less than ideal.</p>\n\n<pre><code>2) Store the `*mgo.Database` or even `*mgo.Collection` object on the server struct.\n</code></pre>\n\n<p>The upside is that you can configure it in one place and use it. The downside is that there appears to be no way to use <code>Copy()</code> on the thing for connection isolation.</p>\n\n<p>How do you recommend storing the mongo session so that you can cleanly use the connection and provide isolation between requests?</p>\n"}, {"tags": ["go", "dockerfile", "static-linking", "cgo"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1558388540, "post_id": 56227207, "comment_id": 99077212, "body": "Maybe <a href=\"https://stackoverflow.com/a/52665687/3915\">convert line endings</a>?"}, {"owner": {"reputation": 155, "user_id": 6759337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xmkBv.png?s=128&g=1", "display_name": "PeggyScott", "link": "https://stackoverflow.com/users/6759337/peggyscott"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1558391393, "post_id": 56227207, "comment_id": 99077907, "body": "I saw some posts about changing line endings but I am not running any shell/ bash scripts in my code. What do I need to change line endings of?"}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 1, "creation_date": 1558396332, "post_id": 56227207, "comment_id": 99078798, "body": "Suspect the ENTRYPOINT is trying to run your app, but your app can&#39;t find some required libraries (or libraries required by those libraries). This might be due to the &#39;scratch&#39; image not having standard c libraries, for example. Try replacing &#39;scratch&#39; with &#39;golang:1.12&#39;."}, {"owner": {"reputation": 155, "user_id": 6759337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xmkBv.png?s=128&g=1", "display_name": "PeggyScott", "link": "https://stackoverflow.com/users/6759337/peggyscott"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1558397821, "post_id": 56227207, "comment_id": 99079037, "body": "Mark I just tried that. Now I am getting /app: error while loading shared libraries: myExternalTool.so: cannot open shared object file: No such file or directory so it looks like it is still not statically linking in my &#39;build&#39; stage if I understand correctly"}], "answers": [{"tags": [], "owner": {"reputation": 155, "user_id": 6759337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xmkBv.png?s=128&g=1", "display_name": "PeggyScott", "link": "https://stackoverflow.com/users/6759337/peggyscott"}, "is_accepted": false, "score": 1, "last_activity_date": 1558502688, "creation_date": 1558502688, "answer_id": 56249810, "question_id": 56227207, "link": "https://stackoverflow.com/questions/56227207/standard-init-linux-go207-exec-user-process-caused-no-such-file-or-directory/56249810#56249810", "title": "standard_init_linux.go:207: exec user process caused &quot;no such file or directory&quot; while trying to statically link c libs", "body": "<p>I was able to fix it with Mark's suggestion. Using a Golang image for runtime exposed the actual problem of the shared object file not being packaged. So I copy it to /usr/lib/x86_64-linux-gnu in my runtime. I ended up using ubuntu:18.04 instead of the Golang image at runtime</p>\n\n<pre><code>FROM golang:1.12 AS build\n\nWORKDIR /go/src/app\nCOPY . .\n\nENV GOOS=linux\nENV GOARCH=amd64\nENV CGO_ENABLED=1\nCOPY acrcloud $GOPATH/src/packageFolder\nCOPY musicrec $GOPATH/src/mainPackage\n\nRUN cd packageFolder\nRUN go get -d -v ./...\nRUN go build -o $GOPATH/pkg/linux_amd64/packageFolder -x\nRUN cd ../mainPackage\nRUN go get -d -v ./...\nRUN go build -o $GOPATH/pkg/linux_amd64/mainPackage -x\nRUN cd ..\nRUN go get -d -v ./...\nRUN go build -a -x\n\nFROM ourPackager:latest AS packager\nWORKDIR /\nCOPY ./resources ./resources/\nRUN appman-packager create-package \"package.tar.gz\" ./resources\n\nFROM ubuntu:18.04 AS runtime\nCOPY --from=build /go/src/app/app /\nCOPY --from=build /go/src/app/myExternalTool.so /usr/lib/x86_64-linux-gnu\nCOPY --from=packager \"/package.tar.gz\" ./resources/\nEXPOSE 8080/tcp\nENTRYPOINT [\"/app\"]\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 6759337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xmkBv.png?s=128&g=1", "display_name": "PeggyScott", "link": "https://stackoverflow.com/users/6759337/peggyscott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1406, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558502688, "creation_date": 1558381388, "question_id": 56227207, "link": "https://stackoverflow.com/questions/56227207/standard-init-linux-go207-exec-user-process-caused-no-such-file-or-directory", "title": "standard_init_linux.go:207: exec user process caused &quot;no such file or directory&quot; while trying to statically link c libs", "body": "<p>I am unable to dockerize and use a utility written in c in go.</p>\n\n<p>I have run this program locally without docker and it works</p>\n\n<p>I tried using gccgo like so go build -compiler gccgo -gccgoflags -static-libgo but I get the same error</p>\n\n<p>The preamble that calls the C functions looks like so:</p>\n\n<pre><code>/*\n#cgo amd64 x86 LDFLAGS: -L. -lsomelib -lsomeotherlib\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"someheader.h\"\n*/\n</code></pre>\n\n<p>My docker file looks like so:</p>\n\n<pre><code>FROM golang:1.12 AS build\n\nWORKDIR /go/src/app\nCOPY . .\n\nENV GOOS=linux\nENV GOARCH=amd64\nENV CGO_LDFLAGS_ALLOW='-linkmode external -extldflags -static-libgcc'\n\nCOPY packageFolder $GOPATH/src/packageFolder\nCOPY mainPackage $GOPATH/src/mainPackage\n\nRUN cd packageFolder\nRUN go get -d -v ./...\nRUN CGO_ENABLED=1 go build --ldflags '-linkmode external -extldflags -static-libgcc' -o $GOPATH/pkg/linux_amd64/packageFolder.a -x\nRUN cd ../packageFolder\nRUN go get -d -v ./...\nRUN CGO_ENABLED=1 go build --ldflags '-linkmode external -extldflags -static-libgcc' -o $GOPATH/pkg/linux_amd64/mainPackage.a -x\nRUN cd ..\nRUN go get -d -v ./...\nRUN go build -a -x\n\nFROM ourPackager:latest AS packager\nWORKDIR /\nCOPY ./resources ./resources/\nRUN appman-packager create-package \"package.tar.gz\" ./resources\n\nFROM scratch AS runtime\nCOPY --from=build /go/src/app/app /\nCOPY --from=packager \"/package.tar.gz\" ./resources/\nEXPOSE 8080/tcp\nENTRYPOINT [\"/app\"]\n</code></pre>\n\n<p>I keep running into standard_init_linux.go:207: exec user process caused \"no such file or directory\" when I do a docker run</p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["json", "csv", "go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11494326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aff45f82be125dfad12b07dfbe2cf37?s=128&d=identicon&r=PG&f=1", "display_name": "superenme", "link": "https://stackoverflow.com/users/11494326/superenme"}, "edited": false, "score": 0, "creation_date": 1558378323, "post_id": 56226560, "comment_id": 99073694, "body": "This looks good if I had that format, but my format is actually in a struct. I have read the csv package and I understand that this could be an output in the event I have the data in the expected format - as shown in the above &quot;expected output&quot;    But my data is all in the struct format. {SomethingA SomethingB SomethingC {SomethingF SomethingG [1 2 3]}}, how would I format this into"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "reply_to_user": {"reputation": 13, "user_id": 11494326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aff45f82be125dfad12b07dfbe2cf37?s=128&d=identicon&r=PG&f=1", "display_name": "superenme", "link": "https://stackoverflow.com/users/11494326/superenme"}, "edited": false, "score": 0, "creation_date": 1558382925, "post_id": 56226560, "comment_id": 99075348, "body": "@superenme updated answer to include struct methods to achieve the desired result for a single or multiple record output"}, {"owner": {"reputation": 13, "user_id": 11494326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aff45f82be125dfad12b07dfbe2cf37?s=128&d=identicon&r=PG&f=1", "display_name": "superenme", "link": "https://stackoverflow.com/users/11494326/superenme"}, "edited": false, "score": 0, "creation_date": 1558468522, "post_id": 56226560, "comment_id": 99109451, "body": "I found another way, since I have many of the root models, alternatively I could iterate over the [] array of root models. I can iterate over arrays just not structs. Thanks a lot of the answer, it definitely helps as well!"}], "tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": true, "score": 1, "last_activity_date": 1558381051, "last_edit_date": 1558381051, "creation_date": 1558378088, "answer_id": 56226560, "question_id": 56226275, "link": "https://stackoverflow.com/questions/56226275/json-struct-to-csv-in-go-lang/56226560#56226560", "title": "JSON struct to csv in Go Lang", "body": "<p>Adding a method to your RootModel for both header and individual rows (so you can range over the type and only print the header once):</p>\n\n<pre><code>type RootModel struct {\n        A string\n        B string\n        C string\n        D factors\n}\n\ntype factors struct {\n        F string\n        G string\n        H []int\n}\n\nfunc (*RootModel) CSVheader(w io.Writer) {\n        cw := csv.NewWriter(w)\n        cw.Write([]string{\"A Key\", \"B Key\", \"C Key\", \"D Key\"})\n        cw.Flush()\n}\n\nfunc (rm *RootModel) CSVrow(w io.Writer) {\n        cw := csv.NewWriter(w)\n        cw.Write([]string{rm.A, rm.B, rm.C, rm.D.F})\n        cw.Write([]string{rm.A, rm.B, rm.C, rm.D.G})\n\n        is, _ := json.Marshal(rm.D.H)\n        cw.Write([]string{rm.A, rm.B, rm.C, string(is)})\n        cw.Flush()\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/c8UQVQ8tQTX\" rel=\"nofollow noreferrer\">https://play.golang.org/p/c8UQVQ8tQTX</a></p>\n\n<p>Output:</p>\n\n<pre><code>A Key,B Key,C Key,D Key\nSomethingA,SomethingB,SomethingC,SomethingF\nSomethingA,SomethingB,SomethingC,SomethingG\nSomethingA,SomethingB,SomethingC,\"[1,2,3]\"\n</code></pre>\n\n<p><strong>Note:</strong> if you are dealing with a slice of <code>RootModel</code>, you may want to put the CSV writer logic at that level - so it can handle the single render of the header-row and then the subsequent data rows.</p>\n"}], "owner": {"reputation": 13, "user_id": 11494326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aff45f82be125dfad12b07dfbe2cf37?s=128&d=identicon&r=PG&f=1", "display_name": "superenme", "link": "https://stackoverflow.com/users/11494326/superenme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1336, "favorite_count": 0, "accepted_answer_id": 56226560, "answer_count": 1, "score": -2, "last_activity_date": 1558381051, "creation_date": 1558376616, "last_edit_date": 1558379858, "question_id": 56226275, "link": "https://stackoverflow.com/questions/56226275/json-struct-to-csv-in-go-lang", "title": "JSON struct to csv in Go Lang", "body": "<p>Looking for ideas to export JSON read structs into some csv format while preserving the hierarchy.</p>\n\n<p><a href=\"https://play.golang.org/p/jf2DRL1hC5K\" rel=\"nofollow noreferrer\">https://play.golang.org/p/jf2DRL1hC5K</a></p>\n\n<pre><code>/* \nExpected output in excel for data wrangling: \nA Key       | B Key     | C Key     | D Key\nSomethingA    SomethingB      SomethingC      SomethingF \nSomethingA    SomethingB      SomethingC      SomethingG\nSomethingA    SomethingB      SomethingC      [1,2,3]   \n*/\n</code></pre>\n\n<p>I have tried iterating through the struct as following</p>\n\n<pre><code>for _, value := range mymodel { \n   fmt.Println(value) \n\n/* could not iterate over structs */ \n} \n</code></pre>\n"}, {"tags": ["xml", "go"], "comments": [{"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1558375851, "post_id": 56226070, "comment_id": 99072786, "body": "We can&#39;t give you a detailed explanation about an error presumably coming from the <code>presentation</code> package when we don&#39;t know the origin of the package."}], "answers": [{"tags": [], "owner": {"reputation": 1126, "user_id": 3508174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vfMCq.jpg?s=128&g=1", "display_name": "Sergey Narozhnyy", "link": "https://stackoverflow.com/users/3508174/sergey-narozhnyy"}, "is_accepted": false, "score": 0, "last_activity_date": 1558381549, "creation_date": 1558381549, "answer_id": 56227242, "question_id": 56226070, "link": "https://stackoverflow.com/questions/56226070/unsupported-relationship-type/56227242#56227242", "title": "Unsupported Relationship Type", "body": "<p>Did you try unioffice? See the <a href=\"https://github.com/unidoc/unioffice/blob/master/presentation/open.go#L24\" rel=\"nofollow noreferrer\">sources</a></p>\n\n<p>Example of <a href=\"https://github.com/unidoc/unioffice/blob/master/_examples/presentation/use-template/main.go#L14\" rel=\"nofollow noreferrer\">usage</a></p>\n"}], "owner": {"reputation": 11, "user_id": 10904357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JvNbA.jpg?s=128&g=1", "display_name": "keisha_ramos", "link": "https://stackoverflow.com/users/10904357/keisha-ramos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558381549, "creation_date": 1558375545, "question_id": 56226070, "link": "https://stackoverflow.com/questions/56226070/unsupported-relationship-type", "title": "Unsupported Relationship Type", "body": "<p>I am trying to make a simple program that will read text inside the paragraphs of a slide and simply print in out in the console.</p>\n\n<p>I've don some browsing and found solutions but only for Word Documents and nothing specifically for PPTX files</p>\n\n<p>This is the error:</p>\n\n<pre><code>[  DEBUG ]   2\n[  DEBUG ]   DocumentVersion.ID = 0\n[  DEBUG ]   Getting Raw Text\n2019/05/21 01:54:22 unsupported relationship type: http://schemas.openxmlformats.org/officeDocument/2006/relationships/presProps tgt: ppt/presProps.xml\n2019/05/21 01:54:22 unsupported relationship type: http://schemas.openxmlformats.org/officeDocument/2006/relationships/viewProps tgt: ppt/viewProps.xml\n2019/05/21 01:54:22 unsupported relationship type: http://schemas.openxmlformats.org/officeDocument/2006/relationships/tableStyles tgt: ppt/tableStyles.xml\nslide\nslide\nslide\n&amp;{0xc00021f380 &lt;nil&gt; &lt;nil&gt;}\n&amp;{&lt;nil&gt; 0xc000289f28 &lt;nil&gt;}\n</code></pre>\n\n<p>This is a code snippet</p>\n\n<pre><code>if *f == f.PPTX() {\n        pres, _ := presentation.Open(\"/Users/asus/Desktop/test.pptx\")\n        buf := \"\"\n        _ = buf\n        for _, slide := range pres.Slides() {\n            fmt.Println(\"slide\")\n            for _, box := range slide.PlaceHolders() {\n                fmt.Println(box.Index())\n                // for _, para := range box.Paragraphs() {\n                //  fmt.Println(para)\n                //  fmt.Println(\"para\")\n                // }\n            }\n        }\n    }\n</code></pre>\n\n<p>It loops at the pres.Slide() successfully though</p>\n\n<p>Can someone give me a detailed explanation regarding that error and how I can fix that? I think the only problem is it can't open the file.</p>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1558370478, "post_id": 56224836, "comment_id": 99070663, "body": "Goroutines are don&#39;t normally have a &quot;parent&quot;, and there&#39;s no requirement to have one to prevent a leak. You simply need to ensure that your goroutines aren&#39;t blocked from exiting. The normal method for timeouts and cancellation is to use a <code>Context</code>"}, {"owner": {"reputation": 37, "user_id": 5662265, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JOHEB.jpg?s=128&g=1", "display_name": "Kunal", "link": "https://stackoverflow.com/users/5662265/kunal"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1558373012, "post_id": 56224836, "comment_id": 99071693, "body": "How can contexts be used to solve this? Can you please share a code snippet"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1558373379, "post_id": 56224836, "comment_id": 99071827, "body": "There are examples in the documentation: <a href=\"https://golang.org/pkg/context/#example_WithCancel\" rel=\"nofollow noreferrer\"><code>WithCancel</code></a>, <a href=\"https://golang.org/pkg/context/#example_WithTimeout\" rel=\"nofollow noreferrer\"><code>WithTimeout</code></a>, and a post here as well <a href=\"https://blog.golang.org/context\" rel=\"nofollow noreferrer\">Go Concurrency Patterns: Context</a>. What specific question do you have?"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1558376942, "post_id": 56224836, "comment_id": 99073192, "body": "The <code>context</code> pkg is heavily used in the go standard library uses for any network/blocking calls. So you should use it too. They chain nicely with cascading effects - thus avoiding lower-level code being aware of how a higher-level task is implemented."}, {"owner": {"reputation": 37, "user_id": 5662265, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JOHEB.jpg?s=128&g=1", "display_name": "Kunal", "link": "https://stackoverflow.com/users/5662265/kunal"}, "edited": false, "score": 0, "creation_date": 1558414319, "post_id": 56224836, "comment_id": 99081938, "body": "Can anyone please modify the above code snippet to how context can solve the problem?"}], "answers": [{"tags": [], "owner": {"reputation": 1083, "user_id": 8153816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K29_Y98AFzU/AAAAAAAAAAI/AAAAAAAAA6E/Ra5_Wf7a6ZU/photo.jpg?sz=128", "display_name": "Giulio Micheloni", "link": "https://stackoverflow.com/users/8153816/giulio-micheloni"}, "is_accepted": false, "score": 2, "last_activity_date": 1558428963, "creation_date": 1558428963, "answer_id": 56234655, "question_id": 56224836, "link": "https://stackoverflow.com/questions/56224836/stop-child-goroutine-when-parent-returns/56234655#56234655", "title": "Stop child goroutine when parent returns", "body": "<p>Here is your snippet with context: <a href=\"https://play.golang.org/p/0TXyt4vuGKJ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/0TXyt4vuGKJ</a>.</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"runtime\"\n    \"sync\"\n    \"time\"\n)\n\n// WaitGroup used by main to wait for parent goroutine\nvar wg sync.WaitGroup\n\n// Long duration process time\nvar duration = 100\n\nfunc main() {\n    fmt.Println(\"In main function - \", runtime.NumGoroutine())\n    wg.Add(1)\n    ctx, cancel := context.WithCancel(context.Background())\n    go parentRoutine(ctx)\n    wg.Wait()\n    cancel()\n    time.Sleep(time.Second) //If main immediately exists the child goroutine does not\n                            //have the time to terminate.\n    fmt.Println(\"Completed parent - \", runtime.NumGoroutine())\n}\n\nfunc parentRoutine(ctx context.Context) {\n    fmt.Println(\"Starting parent function - \", runtime.NumGoroutine())\n    childRes := make(chan int)\n\n    // Spawning child goroutine\n    go func(ctx context.Context) {\n\n        // Here the child is a simulation of a long running process which might take more time than expected timeout. It runs even after parent returns due to timeout\n\n        fmt.Println(\"Starting child function - \", runtime.NumGoroutine())\n        select {\n        case &lt;-ctx.Done():\n            fmt.Println(\"Child's context expired - \", runtime.NumGoroutine())\n        case &lt;-time.After(time.Duration(duration) * time.Second):\n            //time consuming task\n        }\n        fmt.Println(\"Child ended - \", runtime.NumGoroutine())\n        childRes &lt;- 1\n    }(ctx)\n\n    select {\n    case &lt;-ctx.Done():\n        fmt.Println(\"Parent's context expired - \", runtime.NumGoroutine())\n    case &lt;-childRes:\n        fmt.Println(\"Child completed - \", runtime.NumGoroutine())\n    case &lt;-time.After(time.Duration(3) * time.Second):\n        fmt.Println(\"Child timed out - \", runtime.NumGoroutine())\n    }\n    wg.Done()\n}\n</code></pre>\n\n<p>The output is the following now:</p>\n\n<pre><code>In main function -  1\nStarting parent function -  2\nStarting child function -  3\nChild timed out -  3\nChild's context expired -  2\nChild ended -  2\nCompleted parent -  2\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 5662265, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JOHEB.jpg?s=128&g=1", "display_name": "Kunal", "link": "https://stackoverflow.com/users/5662265/kunal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1930, "favorite_count": 0, "closed_date": 1558604419, "answer_count": 1, "score": -1, "last_activity_date": 1558428963, "creation_date": 1558369650, "question_id": 56224836, "link": "https://stackoverflow.com/questions/56224836/stop-child-goroutine-when-parent-returns", "closed_reason": "Duplicate", "title": "Stop child goroutine when parent returns", "body": "<p>We have a main go routine who spawns a parent goroutine, which inturn spawns a child go routine.</p>\n\n<p>The child goroutine still runs even after parent returns. This leads to goroutine leak.</p>\n\n<p>How do we avoid this?  </p>\n\n<p>Below I have added a code snippet to simulate the following\nHere child goroutine can be anything which is a long running process, like db query, api call, etc</p>\n\n<pre><code>Program output: \n\nIn main function -  1\nStarting parent function -  2\nStarting child function -  3\nChild timed out -  3\nCompleted parent -  2  // Implying that child goroutine is still running with main routine\n</code></pre>\n\n<pre class=\"lang-py prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"runtime\"\n    \"sync\"\n    \"time\"\n)\n\n// WaitGroup used by main to wait for parent goroutine\nvar wg sync.WaitGroup\n\n// Long duration process time\nvar duration = 100\n\n\nfunc main() {\n    fmt.Println(\"In main function - \", runtime.NumGoroutine())\n    wg.Add(1)\n    go parentRoutine()\n    wg.Wait()\n    fmt.Println(\"Completed parent - \", runtime.NumGoroutine())\n}\n\nfunc parentRoutine() {\n    fmt.Println(\"Starting parent function - \", runtime.NumGoroutine())\n    childRes := make(chan int)\n\n\n        // Spawning child goroutine\n    go func() {\n\n               // Here the child is a simulation of a long running process which might take more time than expected timeout. It runs even after parent returns due to timeout\n\n\n        fmt.Println(\"Starting child function - \", runtime.NumGoroutine())\n        time.Sleep(time.Duration(duration)*time.Second)\n        fmt.Println(\"Child ended - \", runtime.NumGoroutine())\n        childRes &lt;- 1\n    }()\n\n    select {\n    case &lt;-childRes:\n        fmt.Println(\"Child completed - \", runtime.NumGoroutine())\n    case &lt;- time.After(time.Duration(3)*time.Second):\n        fmt.Println(\"Child timed out - \", runtime.NumGoroutine())\n    }\n    wg.Done()\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1558365999, "post_id": 56223932, "comment_id": 99068607, "body": "You&#39;d need to call <code>jm.code.code()</code>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1558366348, "post_id": 56223932, "comment_id": 99068817, "body": "I&#39;m not sure why you&#39;re expecting <code>.code()</code> to be called for you, nor why you&#39;re trying to convert a struct to a string. Are you trying to implement <a href=\"https://golang.org/pkg/fmt/#Stringer\" rel=\"nofollow noreferrer\"><code>fmt.Stringer</code></a>?"}], "answers": [{"tags": [], "owner": {"reputation": 416, "user_id": 11529593, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nMOHrxOg4nQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfeI-u5UbYJIejKaTCqDSluZAyBDw/mo/photo.jpg?sz=128", "display_name": "Wombologist", "link": "https://stackoverflow.com/users/11529593/wombologist"}, "is_accepted": false, "score": 0, "last_activity_date": 1558375224, "creation_date": 1558375224, "answer_id": 56226004, "question_id": 56223932, "link": "https://stackoverflow.com/questions/56223932/golang-tostring-for-interface-and-struct-implementation/56226004#56226004", "title": "Golang toString for interface and struct implementation", "body": "<p>You are currently attempting to convert jm.code, which is a CodeProvider struct type, to a string which isn't an obvious conversion. If you're attempting to get the string representation of the CodeProvider struct, you can use the \"%+v\" flag in fmt.Sprintf().</p>\n\n<p>Example:</p>\n\n<pre><code>log.Info(\"jm.code: \", fmt.Sprintf(\"%+v\", jm.code))\n</code></pre>\n\n<p>If all you're trying to do is call the code function in the jm.code code provider to get a code string, then use jm.code.code().</p>\n"}], "owner": {"reputation": 842, "user_id": 4611186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4e4d955029c501ed8adf1649c1b2e3c8?s=128&d=identicon&r=PG&f=1", "display_name": "Sonam", "link": "https://stackoverflow.com/users/4611186/sonam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1558375224, "creation_date": 1558365821, "question_id": 56223932, "link": "https://stackoverflow.com/questions/56223932/golang-tostring-for-interface-and-struct-implementation", "title": "Golang toString for interface and struct implementation", "body": "<p>I have the following Go interface:</p>\n\n<pre><code>type CodeProvider interface {\n    code() string\n\n}\n</code></pre>\n\n<p>I have defined the CodeProviderImpl as following:</p>\n\n<pre><code>type CodeProviderImpl struct {\n  errorCode string\n}\n</code></pre>\n\n<p>This is the implementation for the above CodeProvider with \"code()\" method:</p>\n\n<pre><code>func (cp CodeProviderImpl) code()  string {\n    log.Info(\"cp.errorCode: \", cp.errorCode)\n    return cp.errorCode\n}\n</code></pre>\n\n<p>I am using the codeProvider in my another Struct as following:</p>\n\n<pre><code>type JsonMessage struct {\n  code CodeProvider\n}\n</code></pre>\n\n<p>I do this in my test case:</p>\n\n<pre><code>codeProvider := &amp;CodeProviderImpl { errorCode: \"1\"}\n\n    jm := &amp;JsonMessage{         \n        code: codeProvider\n    }\n</code></pre>\n\n<p>Now when I execute a test with the following code I get the following error:</p>\n\n<pre><code> log.Info(\"jm.code: \", string(jm.code))\n</code></pre>\n\n<blockquote>\n  <p>cannot convert jm.code (type CodeProvider) to type string</p>\n</blockquote>\n\n<p>How to print the string representation of the jm.code?</p>\n"}, {"tags": ["docker", "go"], "answers": [{"comments": [{"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1558366906, "post_id": 56223155, "comment_id": 99069083, "body": "Also note that, with this directory structure, your Go package name should start with <code>&quot;github.com&#47;project&#47;...&quot;</code>."}, {"owner": {"reputation": 303, "user_id": 8008395, "user_type": "registered", "profile_image": "https://graph.facebook.com/1019408758194319/picture?type=large", "display_name": "Bohdan Kostko", "link": "https://stackoverflow.com/users/8008395/bohdan-kostko"}, "reply_to_user": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1558616243, "post_id": 56223155, "comment_id": 99165890, "body": "@DavidMaze package name on import you mean"}], "tags": [], "owner": {"reputation": 303, "user_id": 8008395, "user_type": "registered", "profile_image": "https://graph.facebook.com/1019408758194319/picture?type=large", "display_name": "Bohdan Kostko", "link": "https://stackoverflow.com/users/8008395/bohdan-kostko"}, "is_accepted": true, "score": 2, "last_activity_date": 1558362924, "creation_date": 1558362924, "answer_id": 56223155, "question_id": 56223019, "link": "https://stackoverflow.com/questions/56223019/dockerfile-with-go-cant-find-path/56223155#56223155", "title": "Dockerfile with Go can&#39;t find path", "body": "<p>By default Go expects to find folders like <code>src</code>, <code>pkg</code> and <code>bin</code> within <code>GOPATH</code>. However, you're pointing it into in fact your project folder.\nTo fix it you just need to point your <code>GOPATH</code> into <code>/go</code>.</p>\n\n<p>So your <code>Dockerfile</code> should look like</p>\n\n<pre><code>FROM golang\nENV GOPATH /go\nCOPY . /go/src/github.com/project\nWORKDIR /go/src/github.com/project\nRUN make linux\n</code></pre>\n\n<p>You can find more information on <code>GOPATH</code> <a href=\"https://github.com/golang/go/wiki/GOPATH\" rel=\"nofollow noreferrer\">here</a>.\nIf you're tired of <code>GOPATH</code> you can give a try to <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"nofollow noreferrer\">gomodules</a></p>\n"}], "owner": {"reputation": 773, "user_id": 5407287, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/49bdb5440d34f0cb4b0ad6c117e8a04e?s=128&d=identicon&r=PG&f=1", "display_name": "LivingRobot", "link": "https://stackoverflow.com/users/5407287/livingrobot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 596, "favorite_count": 0, "accepted_answer_id": 56223155, "answer_count": 1, "score": 0, "last_activity_date": 1558362924, "creation_date": 1558362512, "question_id": 56223019, "link": "https://stackoverflow.com/questions/56223019/dockerfile-with-go-cant-find-path", "title": "Dockerfile with Go can&#39;t find path", "body": "<p>I have an issue getting my local build to run as well as getting my Dockerfile configured. </p>\n\n<p>My project structure looks like:</p>\n\n<pre><code>project\n- cmd\n  main.go\n- internal\n  - app\n    app.go\nDockerfile\n</code></pre>\n\n<p>So, in <code>main.go</code> I say </p>\n\n<pre><code>import (\n    \"project/internal/app\"\n)\n</code></pre>\n\n<p>Then, when I say <code>go build</code> I can run locally perfectly.</p>\n\n<p>However, in my Dockerfile I say </p>\n\n<pre><code>FROM golang\nENV GOPATH /go/src/github.com/project\nCOPY . /go/src/github.com/project\nWORKDIR /go/src/github.com/project\nRUN make linux\n</code></pre>\n\n<p>And I get the issue:</p>\n\n<pre><code>cmd/main.go:4:2: cannot find package \"Slaxtract/internal/app\" in any of:\n    /usr/local/go/src/project/internal/app (from $GOROOT)\n    /go/src/github.com/project/src/project/internal/app (from $GOPATH)\n</code></pre>\n\n<p>Why is Docker adding <code>src</code> to the GOPATH? And how can I configure it to look in the right spot?</p>\n\n<p>If I change my <code>main.go</code> to be a relative path I can hack a fix - but then I can't run locally as I get </p>\n\n<pre><code>main.go:4:2: local import \"../internal/app\" in non-local package\n</code></pre>\n\n<p>Any and all help would be really appreciated.</p>\n"}, {"tags": ["postgresql", "go", "go-echo"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1558360269, "post_id": 56222341, "comment_id": 99065254, "body": "Please include the code you&#39;ve tried, and explain the problem you&#39;re having."}, {"owner": {"reputation": 1126, "user_id": 3508174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vfMCq.jpg?s=128&g=1", "display_name": "Sergey Narozhnyy", "link": "https://stackoverflow.com/users/3508174/sergey-narozhnyy"}, "edited": false, "score": 0, "creation_date": 1558382646, "post_id": 56222341, "comment_id": 99075248, "body": "In case of copy command in psql you have file saved (or stdout populated) first and then you read it. You can use any driver (even pure one <code>github.com&#47;lib&#47;pq</code>) and do smth like <code>db.Exec(fmt.Sprintf(&quot;copy users to &#39;&#47;tmp&#47;users.csv&#39; with csv header&quot;))</code> or <code>db.Exec(fmt.Spintf(&quot;copy users to stdout (delimiter &#39;|&#39;)&quot;)</code>"}], "owner": {"reputation": 739, "user_id": 5801621, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/eca1a0e83999e7a4a00f7774b15f1ca2?s=128&d=identicon&r=PG&f=1", "display_name": "O. San", "link": "https://stackoverflow.com/users/5801621/o-san"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558360247, "creation_date": 1558360167, "last_edit_date": 1558360247, "question_id": 56222341, "link": "https://stackoverflow.com/questions/56222341/exporting-pgsql-query-as-csv-byte-encoded", "title": "Exporting pgsql query as CSV []byte encoded", "body": "<p>I'm using the Echo web framework. One of the requests I need it to handle is to query an pgsql and return the data in CSV format.\n<a href=\"https://echo.labstack.com/guide/response\" rel=\"nofollow noreferrer\">https://echo.labstack.com/guide/response</a>\nI believe it would be something like:</p>\n\n<pre><code>func(c echo.Context) (err error) {\n  data := []byte(//the CSV formated data??)\n    return c.Blob(http.StatusOK, \"text/csv\", data)\n}\n</code></pre>\n\n<p>The thing is I couldn't find a great way to query the db and get the data in CSV format 64byte encoded. The closest I could find is the package sqltocsv <a href=\"https://github.com/joho/sqltocsv\" rel=\"nofollow noreferrer\">https://github.com/joho/sqltocsv</a> but I couldn't make it work.</p>\n\n<p>Is there a nice and clean way to do it?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1558352120, "post_id": 56220125, "comment_id": 99060719, "body": "Your description doesn&#39;t make sense. What &quot;last character&quot; is being trimmed? What output do you expect? What do you actually see instead?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1558352133, "post_id": 56220125, "comment_id": 99060726, "body": "Which OS and terminal emulator are you using? In mine it shows &quot;my data&quot; followed by the invisible <code>\\r</code>, followed by a single line break (probably because it treats Windows style newlines the same as Linux style)."}, {"owner": {"reputation": 338, "user_id": 1551623, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cb239eb5ba65bc077f952a41248347a3?s=128&d=identicon&r=PG", "display_name": "Nodarius", "link": "https://stackoverflow.com/users/1551623/nodarius"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1558352287, "post_id": 56220125, "comment_id": 99060791, "body": "I use emacs-terminal. Which apparently does not print data before the carriage return. Now I tested with gnome terminal and it prints. Thanks @peter"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1558352378, "post_id": 56220125, "comment_id": 99060845, "body": "emacs-terminal probably treats the carriage return like it worked traditionally: return the carriage and start overwriting the line."}, {"owner": {"reputation": 338, "user_id": 1551623, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cb239eb5ba65bc077f952a41248347a3?s=128&d=identicon&r=PG", "display_name": "Nodarius", "link": "https://stackoverflow.com/users/1551623/nodarius"}, "edited": false, "score": 0, "creation_date": 1558352449, "post_id": 56220125, "comment_id": 99060881, "body": "yup I guess so too"}, {"owner": {"reputation": 1187, "user_id": 10390273, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZnPo-zLAkpE/AAAAAAAAAAI/AAAAAAAAAQ0/eDv2tBJWBWM/photo.jpg?sz=128", "display_name": "ASHWIN RAJEEV", "link": "https://stackoverflow.com/users/10390273/ashwin-rajeev"}, "edited": false, "score": 1, "creation_date": 1558352482, "post_id": 56220125, "comment_id": 99060900, "body": "please clarify the question, What is your need??"}], "answers": [{"tags": [], "owner": {"reputation": 338, "user_id": 1551623, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cb239eb5ba65bc077f952a41248347a3?s=128&d=identicon&r=PG", "display_name": "Nodarius", "link": "https://stackoverflow.com/users/1551623/nodarius"}, "is_accepted": true, "score": 0, "last_activity_date": 1558352681, "creation_date": 1558352681, "answer_id": 56220362, "question_id": 56220125, "link": "https://stackoverflow.com/questions/56220125/how-to-print-string-with-a-carriage-return/56220362#56220362", "title": "How to print string with a carriage return", "body": "<p>It was caused by Emacs terminal, which discarded data printed before carriage return. </p>\n\n<p>Using gnome-terminal fixed it. Thanks for your help @peter</p>\n"}], "owner": {"reputation": 338, "user_id": 1551623, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cb239eb5ba65bc077f952a41248347a3?s=128&d=identicon&r=PG", "display_name": "Nodarius", "link": "https://stackoverflow.com/users/1551623/nodarius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 56220362, "answer_count": 1, "score": -6, "last_activity_date": 1558352797, "creation_date": 1558351799, "last_edit_date": 1558352797, "question_id": 56220125, "link": "https://stackoverflow.com/questions/56220125/how-to-print-string-with-a-carriage-return", "title": "How to print string with a carriage return", "body": "<p>I have a string which ends with a carriage return:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>        str := \"my data\\r\"\n</code></pre>\n\n<p>If I try to print that string, using:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>        fmt.Println(str)\n</code></pre>\n\n<p>all it shows is an empty line. How do I make it output full string, like \"my data\", without trimming the last character (carriage return)?</p>\n"}, {"tags": ["go", "testing"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1558350496, "post_id": 56219613, "comment_id": 99059788, "body": "<code>os.Exit(code)</code> terminates the app, the code after that (the second test run) won&#39;t run."}, {"owner": {"reputation": 2192, "user_id": 1107595, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f43c090c500a639bdd28c090f573159?s=128&d=identicon&r=PG", "display_name": "BlueMagma", "link": "https://stackoverflow.com/users/1107595/bluemagma"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1558350584, "post_id": 56219613, "comment_id": 99059848, "body": "yes in reality I got if code != 0 exit, I type the example in SO directly"}, {"owner": {"reputation": 4173, "user_id": 1199408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5HJv7.jpg?s=128&g=1", "display_name": "georgeok", "link": "https://stackoverflow.com/users/1199408/georgeok"}, "edited": false, "score": 0, "creation_date": 1558357633, "post_id": 56219613, "comment_id": 99063692, "body": "In the standard library they just call <code>fmt.Fprintf(os.Stderr, &quot;error: %v\\n&quot;, err)</code> followed by a os.Exit as you do"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1558363063, "post_id": 56219613, "comment_id": 99066878, "body": "<code>TestMain</code> and its <code>testing.M</code> parameter are the context of the entire test run. They should have nothing to do with individual tests. Multiple tests should be in different test functions or different subtests, which are already distinguishable in results."}, {"owner": {"reputation": 2192, "user_id": 1107595, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f43c090c500a639bdd28c090f573159?s=128&d=identicon&r=PG", "display_name": "BlueMagma", "link": "https://stackoverflow.com/users/1107595/bluemagma"}, "edited": false, "score": 0, "creation_date": 1558455747, "post_id": 56219613, "comment_id": 99103892, "body": "Like I said in another comment, I don&#39;t see the point in telling me I shouldn&#39;t do that. We&#39;ve got 14 files with roughly 700 line of tests each. We are not going to copy them and maintain two copy of the exact same tests. This pattern also ensure that any future implementation of the interface will be easy to test."}], "answers": [{"comments": [{"owner": {"reputation": 2192, "user_id": 1107595, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f43c090c500a639bdd28c090f573159?s=128&d=identicon&r=PG", "display_name": "BlueMagma", "link": "https://stackoverflow.com/users/1107595/bluemagma"}, "edited": false, "score": 0, "creation_date": 1558455243, "post_id": 56222463, "comment_id": 99103647, "body": "Thank you for your reply, but you are missing the point. I run the exact same test in two implementation of the same interface. the purpose is to be able to test any implementation regardless of how it implements it. I have many good reasons to do that in the context of my project."}, {"owner": {"reputation": 129, "user_id": 6488733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b724b1b37638fef6e48ff6c375b2f3d9?s=128&d=identicon&r=PG", "display_name": "inwi", "link": "https://stackoverflow.com/users/6488733/inwi"}, "reply_to_user": {"reputation": 2192, "user_id": 1107595, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f43c090c500a639bdd28c090f573159?s=128&d=identicon&r=PG", "display_name": "BlueMagma", "link": "https://stackoverflow.com/users/1107595/bluemagma"}, "edited": false, "score": 0, "creation_date": 1558510617, "post_id": 56222463, "comment_id": 99120615, "body": "If you have an interface to test, you can write a function <code>testInterface(t *testing.T, i interface{}, n string)</code> that accepts this interface and call <code>testInterface</code> multiple times. Still no need to call <code>m.Run()</code> multiple times. Here is an <a href=\"https://play.golang.org/p/tXTG2SzvetU\" rel=\"nofollow noreferrer\">example</a>. There isn&#39;t even a need for a <code>TestMain</code> anymore."}, {"owner": {"reputation": 2192, "user_id": 1107595, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f43c090c500a639bdd28c090f573159?s=128&d=identicon&r=PG", "display_name": "BlueMagma", "link": "https://stackoverflow.com/users/1107595/bluemagma"}, "edited": false, "score": 0, "creation_date": 1558515487, "post_id": 56222463, "comment_id": 99123254, "body": "I see what you mean, and I agree it would work, but it would need to contain a call to every tests (the biggest interface currently have 14 test files with on average 7-8 test function each). It would need to be updated every time I create a new test file with new tests. Another things is that the example testA_Call methods doesn&#39;t have a test signature, and would have godoc generated for it  which we want to avoid."}, {"owner": {"reputation": 2192, "user_id": 1107595, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f43c090c500a639bdd28c090f573159?s=128&d=identicon&r=PG", "display_name": "BlueMagma", "link": "https://stackoverflow.com/users/1107595/bluemagma"}, "edited": false, "score": 0, "creation_date": 1558515532, "post_id": 56222463, "comment_id": 99123279, "body": "If you wish to discuss this further, I would be happy to have a chat with you privately, to avoid adding more comments here"}], "tags": [], "owner": {"reputation": 129, "user_id": 6488733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b724b1b37638fef6e48ff6c375b2f3d9?s=128&d=identicon&r=PG", "display_name": "inwi", "link": "https://stackoverflow.com/users/6488733/inwi"}, "is_accepted": false, "score": 0, "last_activity_date": 1558360645, "creation_date": 1558360645, "answer_id": 56222463, "question_id": 56219613, "link": "https://stackoverflow.com/questions/56219613/prefix-testmain-on-multiple-instance/56222463#56222463", "title": "prefix testmain on multiple instance", "body": "<p>Calling <code>m.Run()</code> multiple times seems like an anti-pattern. Create multiple tests that have different setups and name them accordingly. AFAIK there is no <code>m.Run(\"name\")</code></p>\n"}, {"tags": [], "owner": {"reputation": 2192, "user_id": 1107595, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f43c090c500a639bdd28c090f573159?s=128&d=identicon&r=PG", "display_name": "BlueMagma", "link": "https://stackoverflow.com/users/1107595/bluemagma"}, "is_accepted": false, "score": 0, "last_activity_date": 1558455501, "creation_date": 1558455501, "answer_id": 56242528, "question_id": 56219613, "link": "https://stackoverflow.com/questions/56219613/prefix-testmain-on-multiple-instance/56242528#56242528", "title": "prefix testmain on multiple instance", "body": "<p>I am still looking for a better solution, until then I'm doing something like the following</p>\n\n<pre><code>func TestMain(m *testing.M) {\n    setup1()\n    code = m.Run()\n    if code != 0 {\n        log.Println(\"failed on implementation 1\")\n        os.exit(code)\n    }\n\n    setup2()\n    code = m.Run()\n    if code != 0 {\n        log.Println(\"failed on implementation 2\")\n        os.exit(code)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 2192, "user_id": 1107595, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f43c090c500a639bdd28c090f573159?s=128&d=identicon&r=PG", "display_name": "BlueMagma", "link": "https://stackoverflow.com/users/1107595/bluemagma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1558456473, "creation_date": 1558350144, "last_edit_date": 1558456473, "question_id": 56219613, "link": "https://stackoverflow.com/questions/56219613/prefix-testmain-on-multiple-instance", "title": "prefix testmain on multiple instance", "body": "<p>I am using TestMain to test multiple implementation of the same interface</p>\n\n<pre><code>func TestMain(m *testing.M) {\n    setup1()\n    code = m.Run()\n    if code != 0 {\n        os.exit(code)\n    }\n\n    setup2()\n    code = m.Run()\n    if code != 0 {\n        os.exit(code)\n    }\n}\n</code></pre>\n\n<p>If I then get an error in a test, it is difficult to know which implementation generated the failure</p>\n\n<p>In T subtests, you run like this :</p>\n\n<pre><code>t.run(\"test name\", testfunc)\n</code></pre>\n\n<p>is there a way to do something to prefix the Main tests</p>\n\n<pre><code>m.Run(\"name\") // intuitively what I should be able to do\n</code></pre>\n\n<p>EDIT : Adding some background because it looks like people are not seeing what it is about</p>\n\n<pre><code>// MyInterface is implemented multiple time, but we expect the same behavior for any implementation\ntype IMyInterface interface {\n    SomeMethod()\n    SomeOtherMethod()\n}\n\nvar (\n    implUnderTest IMyInterface // is referred to in every tests\n)\n\n// There are many test files with many tests run for each implementation\nfunc TestMain(m *testing.M) {\n    for _, impl := range []IMyInterface {&amp;Impl1{}, &amp;Impl2{}, &amp;Impl3{}} {\n        implUnderTest = impl\n        code := m.Run()\n        if code != 0 {\n            os.exit(code)\n        }\n    }\n\n}\n</code></pre>\n"}, {"tags": ["pointers", "go", "memory-management"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1558351014, "post_id": 56219270, "comment_id": 99060085, "body": "I can explain this one. &quot;[T]he specific relationship between pointers and memory in [Go]&quot; is. A pointer is a memory address."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1558351055, "post_id": 56219270, "comment_id": 99060101, "body": "Ah, sorry, I forgot to answer the question in the headline: No."}, {"owner": {"reputation": 1126, "user_id": 3508174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vfMCq.jpg?s=128&g=1", "display_name": "Sergey Narozhnyy", "link": "https://stackoverflow.com/users/3508174/sergey-narozhnyy"}, "edited": false, "score": 0, "creation_date": 1558382770, "post_id": 56219270, "comment_id": 99075293, "body": "Maybe @jimmy was looking smth like <a href=\"https://stackoverflow.com/questions/57483/what-are-the-differences-between-a-pointer-variable-and-a-reference-variable-in\">this</a>? :)"}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1558389296, "post_id": 56219270, "comment_id": 99077422, "body": "Of interest? <a href=\"https://go101.org/article/pointer.html\" rel=\"nofollow noreferrer\">pointers</a> and <a href=\"https://go101.org/article/unsafe.html\" rel=\"nofollow noreferrer\">unsafe</a>."}, {"owner": {"reputation": 11, "user_id": 11403837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/943ff59ea608c0202fac114428078042?s=128&d=identicon&r=PG&f=1", "display_name": "jimmy", "link": "https://stackoverflow.com/users/11403837/jimmy"}, "edited": false, "score": 0, "creation_date": 1558406011, "post_id": 56219270, "comment_id": 99080415, "body": "In c++ pointers always point to a memory address, but in golang, GC may reorganize memory. Will the pointer change after this happens?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1558417133, "post_id": 56219270, "comment_id": 99082733, "body": "@jimmy: Which part of &quot;No&quot; was not clear enough. No."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 0, "last_activity_date": 1558512961, "creation_date": 1558512961, "answer_id": 56252211, "question_id": 56219270, "link": "https://stackoverflow.com/questions/56219270/pointer-difference-between-go-and-c-will-pointer-change-after-gc/56252211#56252211", "title": "Pointer difference between Go and C++, will pointer change after gc?", "body": "<p>The language specification does not say anything whether pointers should stay invariant. Which means you should not rely / build on this.</p>\n\n<p>What you have guarantee of is that if pointers change after a garbage collection cycle, or if the runtime changes them due to memory allocation / release, the pointers you have in your variables will be updated to reflect the changes.</p>\n\n<p>There is a <em>hint</em> in the documentation of <a href=\"https://golang.org/pkg/unsafe/#Pointer\" rel=\"nofollow noreferrer\"><code>unsafe.Pointer</code></a> that pointers <em>may</em> change:</p>\n\n<blockquote>\n  <p>A uintptr is an integer, not a reference. Converting a Pointer to a uintptr creates an integer value with no pointer semantics. Even if a uintptr holds the address of some object, <strong>the garbage collector will not update that uintptr's value if the object moves</strong>, nor will that uintptr keep the object from being reclaimed.</p>\n</blockquote>\n\n<p>In practice the garbage collector won't go around and change pointers all the time, that would be an unnecessary overhead. But it may reorder objects in memory if a lot of them is freed and compacts the memory, or there's a \"pressure\" to free unused memory (e.g. due to a call to <a href=\"https://golang.org/pkg/runtime/debug/#FreeOSMemory\" rel=\"nofollow noreferrer\"><code>debug.FreeOSMemory()</code></a>).</p>\n"}], "owner": {"reputation": 11, "user_id": 11403837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/943ff59ea608c0202fac114428078042?s=128&d=identicon&r=PG&f=1", "display_name": "jimmy", "link": "https://stackoverflow.com/users/11403837/jimmy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1558513912, "creation_date": 1558349026, "last_edit_date": 1558513912, "question_id": 56219270, "link": "https://stackoverflow.com/questions/56219270/pointer-difference-between-go-and-c-will-pointer-change-after-gc", "title": "Pointer difference between Go and C++, will pointer change after gc?", "body": "<p>Is there a difference how pointers work in Go and C++, will pointers change after gc?</p>\n\n<p>I want to know the specific relationship between pointers and memory in Go. If you have relevant information or source code explanations, thank you very much.</p>\n"}, {"tags": ["go", "hashicorp-vault"], "comments": [{"owner": {"reputation": 367, "user_id": 4422411, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c814c955bffcac9b4c22371a0a84df8?s=128&d=identicon&r=PG&f=1", "display_name": "kish", "link": "https://stackoverflow.com/users/4422411/kish"}, "edited": false, "score": 0, "creation_date": 1558348535, "post_id": 56218841, "comment_id": 99058697, "body": "To keep the secret alive which parameter we have to use? i see MaxLeaseTTL, LeaseDuration etc. Which parameter we need use?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1558352589, "post_id": 56218841, "comment_id": 99060945, "body": "Lease durations are a property of the mountpoint. You cannot set individual lease durations for secrets."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1558353022, "post_id": 56218841, "comment_id": 99061193, "body": "Also, if you are talking about the KV secret engine, lease durations don&#39;t apply, since there is no way to revoke a static secret. Lease duration only make sense for secrets that are generated by Vault and can be revoked, such as database credentials, TLS certificates, etc."}, {"owner": {"reputation": 367, "user_id": 4422411, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c814c955bffcac9b4c22371a0a84df8?s=128&d=identicon&r=PG&f=1", "display_name": "kish", "link": "https://stackoverflow.com/users/4422411/kish"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1558353282, "post_id": 56218841, "comment_id": 99061343, "body": "okay, in my case for a set of secrets which comes under a secret engine. How to i add a field(i dont know which filed) such that the secrets under it will not expiry."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1558354042, "post_id": 56218841, "comment_id": 99061720, "body": "You still haven&#39;t said <i>which</i> secret engine you are using, so we can&#39;t give you a proper answer. Secrets in the KV engine never expire; the client is responsible for the whole lifecycle."}, {"owner": {"reputation": 367, "user_id": 4422411, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c814c955bffcac9b4c22371a0a84df8?s=128&d=identicon&r=PG&f=1", "display_name": "kish", "link": "https://stackoverflow.com/users/4422411/kish"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1558354470, "post_id": 56218841, "comment_id": 99061932, "body": "oh okay. I am using KV engine of version 1. please find the below details of sample secret."}, {"owner": {"reputation": 367, "user_id": 4422411, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c814c955bffcac9b4c22371a0a84df8?s=128&d=identicon&r=PG&f=1", "display_name": "kish", "link": "https://stackoverflow.com/users/4422411/kish"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1558354731, "post_id": 56218841, "comment_id": 99062043, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/193642/discussion-between-kish-and-peter\">continue this discussion in chat</a>."}, {"owner": {"reputation": 367, "user_id": 4422411, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c814c955bffcac9b4c22371a0a84df8?s=128&d=identicon&r=PG&f=1", "display_name": "kish", "link": "https://stackoverflow.com/users/4422411/kish"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1558355224, "post_id": 56218841, "comment_id": 99062304, "body": "` # curl -k --header &quot;X-Vault-Token: s.NtHGgdtXQipPv3A&quot; --request LIST 127.0.0.1:8200/v1/Kishan/IND/\u2026  {&quot;request_id&quot;:&quot;63b9a780-00ef-8374-fb49-646a8aba8ca8&quot;,&quot;lease_&zwnj;&#8203;id&quot;:&quot;&quot;,&quot;renewable&quot;:f&zwnj;&#8203;alse,&quot;lease_duration&zwnj;&#8203;&quot;:0,&quot;data&quot;:{&quot;keys&quot;:[&zwnj;&#8203;&quot;dummyapp/&quot;,&quot;dummyap&zwnj;&#8203;p1/&quot;]},&quot;wrap_info&quot;:n&zwnj;&#8203;ull,&quot;warnings&quot;:null,&zwnj;&#8203;&quot;auth&quot;:null} `"}, {"owner": {"reputation": 367, "user_id": 4422411, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c814c955bffcac9b4c22371a0a84df8?s=128&d=identicon&r=PG&f=1", "display_name": "kish", "link": "https://stackoverflow.com/users/4422411/kish"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1558355266, "post_id": 56218841, "comment_id": 99062332, "body": "` # curl -k --header &quot;X-Vault-Token: s.NtHGgdtXQipPv3A&quot; --request LIST <a href=\"https://127.0.0.1:8200/v1/Kishan/IND/19.5/dummyapp\" rel=\"nofollow noreferrer\">127.0.0.1:8200/v1/Kishan/IND/19.5/dummyapp</a>  {&quot;request_id&quot;:&quot;b3a73045-a5e2-3e75-eae4-48011d0d5cd3&quot;,&quot;lease_&zwnj;&#8203;id&quot;:&quot;&quot;,&quot;renewable&quot;:f&zwnj;&#8203;alse,&quot;lease_duration&zwnj;&#8203;&quot;:0,&quot;data&quot;:{&quot;keys&quot;:[&zwnj;&#8203;&quot;Secret2&quot;,&quot;Secret3&quot;,&zwnj;&#8203;&quot;Secret4&quot;]},&quot;wrap_in&zwnj;&#8203;fo&quot;:null,&quot;warnings&quot;:&zwnj;&#8203;null,&quot;auth&quot;:null}"}, {"owner": {"reputation": 367, "user_id": 4422411, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c814c955bffcac9b4c22371a0a84df8?s=128&d=identicon&r=PG&f=1", "display_name": "kish", "link": "https://stackoverflow.com/users/4422411/kish"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1558355289, "post_id": 56218841, "comment_id": 99062349, "body": "# curl -k --header &quot;X-Vault-Token: s.NtHGgdtXQipPv3A&quot; --request GET <a href=\"https://127.0.0.1:8200/v1/Kishan/IND/19.5/dummyapp/Secret2\" rel=\"nofollow noreferrer\">127.0.0.1:8200/v1/Kishan/IND/19.5/dummyapp/Secret2</a> {&quot;request_id&quot;:&quot;62980cba-bf5a-e8b2-98b3-12f96cf6a29a&quot;,&quot;lease_&zwnj;&#8203;id&quot;:&quot;&quot;,&quot;renewable&quot;:f&zwnj;&#8203;alse,&quot;lease_duration&zwnj;&#8203;&quot;:2764800,&quot;data&quot;:{&quot;S&zwnj;&#8203;ecret2&quot;:&quot;##BEGIN##\\n&zwnj;&#8203;34234234442344234\\n#&zwnj;&#8203;#END##\\n&quot;},&quot;wrap_inf&zwnj;&#8203;o&quot;:null,&quot;warnings&quot;:n&zwnj;&#8203;ull,&quot;auth&quot;:null}  `"}], "answers": [{"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": false, "score": 0, "last_activity_date": 1558355690, "creation_date": 1558355690, "answer_id": 56221156, "question_id": 56218841, "link": "https://stackoverflow.com/questions/56218841/how-to-add-lease-duration-for-individual-secret/56221156#56221156", "title": "How to add &#39;lease_duration&#39; for individual secret?", "body": "<p>In the KV 1 engine the lease duration is purely advisory; a hint to clients for how often to check for updated values. The global default can be changed with a key named \"ttl\".</p>\n\n<p>Vault never deletes secrets in the KV engine on its own, even if the \"ttl\" key is set.</p>\n\n<p>See the <a href=\"https://www.vaultproject.io/docs/secrets/kv/kv-v1.html#ttls\" rel=\"nofollow noreferrer\">TTLs documentation</a>.</p>\n"}], "owner": {"reputation": 367, "user_id": 4422411, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c814c955bffcac9b4c22371a0a84df8?s=128&d=identicon&r=PG&f=1", "display_name": "kish", "link": "https://stackoverflow.com/users/4422411/kish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 375, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558355690, "creation_date": 1558347503, "question_id": 56218841, "link": "https://stackoverflow.com/questions/56218841/how-to-add-lease-duration-for-individual-secret", "title": "How to add &#39;lease_duration&#39; for individual secret?", "body": "<p>I have list of secrets to be added in vault and each secret has its own lease_duration. I am able to write secret but i not getting how to add lease_duration for it.\nForm my understanding it is like we cannot add lease_duration for individual secrets? correct me if i am wrong.\nOr do we need to add lease_duration during the NewClinet establishment itself?\nI using golang/api.</p>\n"}, {"tags": ["go", "build"], "answers": [{"comments": [{"owner": {"reputation": 11210, "user_id": 725937, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/32cba7500e49d4c491289f9e101c693b?s=128&d=identicon&r=PG", "display_name": "abergmeier", "link": "https://stackoverflow.com/users/725937/abergmeier"}, "edited": false, "score": 0, "creation_date": 1558348240, "post_id": 56218920, "comment_id": 99058527, "body": "Lets say I would like to compile using Go - next problem is how to reliably do this. Considering all edge cases like multiple Go binaries in the system, called via Bazel, etc."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 11210, "user_id": 725937, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/32cba7500e49d4c491289f9e101c693b?s=128&d=identicon&r=PG", "display_name": "abergmeier", "link": "https://stackoverflow.com/users/725937/abergmeier"}, "edited": false, "score": 1, "creation_date": 1558348496, "post_id": 56218920, "comment_id": 99058680, "body": "Use <a href=\"https://golang.org/pkg/runtime/#GOROOT\" rel=\"nofollow noreferrer\"><code>runtime.GOROOT()</code></a> to find out which one to use."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1558347754, "creation_date": 1558347754, "answer_id": 56218920, "question_id": 56218649, "link": "https://stackoverflow.com/questions/56218649/how-to-build-a-program-as-part-of-testing/56218920#56218920", "title": "How to build a program as part of testing", "body": "<p>There is no public compiler API.</p>\n\n<p>The easiest way to test you app would be to call / run an existing binary on the system.</p>\n\n<p>If you don't want to rely on this, another option is to have your test create / write a binary file into a temporary folder, test your function and then remove the temporary file. This can be done easily / automatically using the <a href=\"https://golang.org/pkg/io/ioutil/#TempFile\" rel=\"nofollow noreferrer\"><code>ioutil.TempFile()</code></a> function.</p>\n\n<p>Creating this temporary binary may or may not be a Go compiling process. Since this is part of a Go test, the Go SDK should already be installed in your system, so calling <code>go</code> shouldn't be a problem.</p>\n\n<p>Your test may also self-contain the content of a tiny, runnable executable which the test could \"dump\" to a temporary file. Such tiny binaries may be as small as 100 bytes, for an example, see <a href=\"http://timelessname.com/elfbin/\" rel=\"nofollow noreferrer\">Smallest x86 ELF Hello World</a>. For how to bundle data into a Go app, see <a href=\"https://stackoverflow.com/questions/13904441/whats-the-best-way-to-bundle-static-resources-in-a-go-program/28071360#28071360\">What's the best way to bundle static resources in a Go program?</a></p>\n"}], "owner": {"reputation": 11210, "user_id": 725937, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/32cba7500e49d4c491289f9e101c693b?s=128&d=identicon&r=PG", "display_name": "abergmeier", "link": "https://stackoverflow.com/users/725937/abergmeier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1558347754, "creation_date": 1558346822, "question_id": 56218649, "link": "https://stackoverflow.com/questions/56218649/how-to-build-a-program-as-part-of-testing", "title": "How to build a program as part of testing", "body": "<p>I want to test, that a function <code>callProgram</code> executes a binary and handles the output correctly.\nFor that my initial thought would be to compile raw code like:</p>\n\n<pre><code>package mytest\n\nimport (\n    \"testing\"\n)\n\nconst (\n    binary_code = `\n       package main\n\n       func main() {\n           // Glorious processing ...\n       }\n    `\n)\n\nfunc TestCall(t *testing.T) {\n    p := buildTestProgram(binary_code, \"~/testbinary\")\n    defer p.Delete()\n    callProgram(\"~/testbinary\")\n}\n</code></pre>\n\n<p>I looked into the <em>build</em> command (<code>runBuild</code>) and its' implementation is sufficiently easy. Problem is, that it lives in the <code>internal</code> namespace and <code>cmd/go</code> does not seem to expose any way of calling <code>runBuild</code> or similar.</p>\n\n<p>So my question is how to test a certain binary and also having to interact with the hosting system as little as possible.</p>\n\n<p>Yes, I could download a prebuilt binary, execute <code>go build</code>, etc. but I would be really glad to minimize the chances of potential errors/complexity and also be as portable as possible.</p>\n"}, {"tags": ["json", "go", "time"], "answers": [{"comments": [{"owner": {"reputation": 609, "user_id": 2002790, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/6768d52fa30111dbfa56ce06cb497c69?s=128&d=identicon&r=PG", "display_name": "amrx", "link": "https://stackoverflow.com/users/2002790/amrx"}, "edited": false, "score": 0, "creation_date": 1558353279, "post_id": 56218537, "comment_id": 99061341, "body": "I feel dumb now. First I should have not ignored the error and should have checked for error myself and second I should have initialised d2 to a pointer itself. Thanks for answering."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1558346412, "creation_date": 1558346412, "answer_id": 56218537, "question_id": 56218468, "link": "https://stackoverflow.com/questions/56218468/time-json-marshals-to-0-time/56218537#56218537", "title": "Time JSON marshals to 0 time", "body": "<p>Go vet tells you exactly what the problem is:</p>\n\n<blockquote>\n  <p>./prog.go:18:16: call of Unmarshal passes non-pointer as second argument</p>\n</blockquote>\n\n<p>Also <strong>never</strong> ignore errors! The least you can do is print it:</p>\n\n<pre><code>ds := check{A: time.Now().Truncate(0)}\nfmt.Println(ds)\ndd, err := json.Marshal(ds)\nfmt.Println(err)\nd2 := check{}\nerr = json.Unmarshal(dd, d2)\nfmt.Println(err)\nfmt.Println(d2)\n</code></pre>\n\n<p>This will output (try it on the <a href=\"https://play.golang.org/p/pr4VGTvZRzO\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>{2009-11-10 23:00:00 +0000 UTC}\n&lt;nil&gt;\njson: Unmarshal(non-pointer main.check)\n{0001-01-01 00:00:00 +0000 UTC}\n</code></pre>\n\n<p>You have to pass a <strong>pointer</strong> to <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\"><code>json.Unmarshal()</code></a> for it to be able to unmarshal into (change) your value:</p>\n\n<pre><code>err = json.Unmarshal(dd, &amp;d2)\n</code></pre>\n\n<p>With this change  output will be (try it on the <a href=\"https://play.golang.org/p/NucgEZ4ai1A\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>{2009-11-10 23:00:00 +0000 UTC}\n&lt;nil&gt;\n&lt;nil&gt;\n{2009-11-10 23:00:00 +0000 UTC}\n</code></pre>\n"}], "owner": {"reputation": 609, "user_id": 2002790, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/6768d52fa30111dbfa56ce06cb497c69?s=128&d=identicon&r=PG", "display_name": "amrx", "link": "https://stackoverflow.com/users/2002790/amrx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 56218537, "answer_count": 1, "score": -2, "last_activity_date": 1558353602, "creation_date": 1558346175, "last_edit_date": 1558353602, "question_id": 56218468, "link": "https://stackoverflow.com/questions/56218468/time-json-marshals-to-0-time", "title": "Time JSON marshals to 0 time", "body": "<p>I have the following code which primarily marshals and un-marshals a time struct. Here is the code </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n    \"encoding/json\"\n)\n\ntype check struct{\n    A time.Time `json:\"a\"`\n}\n\nfunc main(){\n    ds := check{A:time.Now().Truncate(0)}\n    fmt.Println(ds)\n    dd, _ := json.Marshal(ds)\n    d2 := check {}\n    json.Unmarshal(dd, d2)\n    fmt.Println(d2)\n}\n</code></pre>\n\n<p>here is the output it produces</p>\n\n<pre><code>{2019-05-20 15:20:16.247914 +0530 IST}\n{0001-01-01 00:00:00 +0000 UTC}\n</code></pre>\n\n<p>The first line is the original time and the second line is the time after the unmarshalling. Why do we have this loss of information with <code>JSON</code> conversions? How to prevent this?\nThanks.</p>\n"}, {"tags": ["go", "channel", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 7980989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6106aead8b054e696daf693fbf21fcb?s=128&d=identicon&r=PG&f=1", "display_name": "Husy", "link": "https://stackoverflow.com/users/7980989/husy"}, "edited": false, "score": 0, "creation_date": 1558352854, "post_id": 56218947, "comment_id": 99061090, "body": "when runing the ch=ch1, does it will change the data in generator function?  what if the ch=ch1 is finished before the fliter function? since we cannot garantee the order of goroutines and the code in main process."}, {"owner": {"reputation": 18287, "user_id": 1029453, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x570w.jpg?s=128&g=1", "display_name": "Richard Huxton", "link": "https://stackoverflow.com/users/1029453/richard-huxton"}, "edited": false, "score": 0, "creation_date": 1558360174, "post_id": 56218947, "comment_id": 99065191, "body": "Both <code>generate</code> and <code>filter</code> run forever, along with the channels they are attached to. You just add more filters with more channels and just print the first number to reach the end of the pipeline. Altering what <code>ch</code> points to has no effect on the go-process running <code>filter</code> - the setup of that was completed on the previous line. Try working through it with paper and pencil."}], "tags": [], "owner": {"reputation": 1742, "user_id": 6142150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6518cc1347db7055f0b133c794ab01c?s=128&d=identicon&r=PG", "display_name": "Maxim Kosov", "link": "https://stackoverflow.com/users/6142150/maxim-kosov"}, "is_accepted": false, "score": 0, "last_activity_date": 1558347813, "creation_date": 1558347813, "answer_id": 56218947, "question_id": 56218409, "link": "https://stackoverflow.com/questions/56218409/how-to-understand-the-ch-ch1-in-the-following-codes/56218947#56218947", "title": "how to understand the &quot;ch=ch1&quot; in the following codes?", "body": "<p><code>ch</code> is the \"current channel\". The loop is the following:</p>\n\n<ol>\n<li>You starting with the channel filled by generate. It's the channel of all integers. First number from this channel is 2 (prime number).</li>\n<li>Then you create <code>ch1</code> which is the channel of all integers without numbers divisible by 2.</li>\n<li><code>=</code> is the assignment operator. By using <code>ch = ch1</code> you're telling that current channel is the channel of all integers without divisible by 2.</li>\n<li>New loop iteration. First number from current channel is 3. You creating <code>ch1</code> as current channel without numbers divisible by 3. </li>\n<li>Assign <code>ch1</code> to be current channel. So now current channel is channel of all numbers without divisible by 2 without divisible by 3.</li>\n<li>Repeat</li>\n</ol>\n"}], "owner": {"reputation": 47, "user_id": 7980989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6106aead8b054e696daf693fbf21fcb?s=128&d=identicon&r=PG&f=1", "display_name": "Husy", "link": "https://stackoverflow.com/users/7980989/husy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1558347813, "creation_date": 1558345974, "question_id": 56218409, "link": "https://stackoverflow.com/questions/56218409/how-to-understand-the-ch-ch1-in-the-following-codes", "title": "how to understand the &quot;ch=ch1&quot; in the following codes?", "body": "<p>I cannot understand the meaning of \"ch=ch1\" and why does it can print the prime number? does someone can explain it for me? I am learning the Go.</p>\n\n<pre><code>    // Copyright 2009 The Go Authors. All rights reserved.\n    // Use of this source code is governed by a BSD-style\n    // license that can be found in the LICENSE file.package main\n    package main\n\n    import \"fmt\"\n\n    // Send the sequence 2, 3, 4, ... to channel 'ch'.\n    func generate(ch chan int) {\n        for i := 2; ; i++ {\n            ch &lt;- i // Send 'i' to channel 'ch'.\n        }\n    }\n\n    // Copy the values from channel 'in' to channel 'out',\n    // removing those divisible by 'prime'.\n    func filter(in, out chan int, prime int) {\n    for {\n        i := &lt;-in // Receive value of new variable 'i' from 'in'.\n        if i%prime != 0 {\n            out &lt;- i // Send 'i' to channel 'out'.\n        }\n    }\n}\n\n// The prime sieve: Daisy-chain filter processes together.\nfunc main() {\n    ch := make(chan int) // Create a new channel.\n    go generate(ch)      // Start generate() as a goroutine.\n    for {\n        prime := &lt;-ch\n        fmt.Print(prime, \" \")\n        ch1 := make(chan int)\n        go filter(ch, ch1, prime)\n        ch = ch1\n    }\n}\n</code></pre>\n\n<p>could someoen explain these code for me? I have been learnt the Go for serveral days.</p>\n"}, {"tags": ["go", "struct", "channel"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1558344324, "post_id": 56217825, "comment_id": 99056375, "body": "You must use pointer receiver for methods that intend to change the receiver (because the receiver is just a copy). When you change it to pointer, it works, see on the <a href=\"https://play.golang.org/p/iLlPpes8jEa\" rel=\"nofollow noreferrer\">Go Playground</a>. If you use a non-pointer receiver, the <code>signalCh</code> field of the &quot;original&quot; struct remains <code>nil</code>, and attempting to send on a <code>nil</code> channel blocks forever. For details, see <a href=\"https://stackoverflow.com/questions/39015602/how-does-a-non-initialized-channel-behave/39016004#39016004\">How does a non initialized channel behave?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "is_accepted": false, "score": 0, "last_activity_date": 1558344340, "creation_date": 1558344340, "answer_id": 56217924, "question_id": 56217825, "link": "https://stackoverflow.com/questions/56217825/golang-channel-in-struct-behaves-differently-by-passing-it-when-creating-the-str/56217924#56217924", "title": "Golang channel in struct behaves differently by passing it when creating the struct and passing by function after creating", "body": "<p><a href=\"https://play.golang.org/p/TIn7esSsRUZ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/TIn7esSsRUZ</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\ntype structOfChan struct {\n    Name     string\n    signalCh chan bool\n}\n\nfunc (sc *structOfChan) Init() {\n    sc.signalCh = make(chan bool, 1)\n}\n\nfunc (sc *structOfChan) Notify() {\n    sc.signalCh &lt;- true\n    fmt.Println(sc.Name, \"notified\")\n}\nfunc main() {\n    sc1 := &amp;structOfChan{\n        Name:     \"created with Channel\",\n        signalCh: make(chan bool, 1),\n    }\n\n    sc2 := &amp;structOfChan{Name: \"created without channel\"}\n    sc2.Init()\n    go func() {\n        sc1.Notify()\n    }()\n    go func() {\n        sc2.Notify()\n    }()\n    time.Sleep(5 * time.Second)\n\n}\n</code></pre>\n\n<p>output:</p>\n\n<p><code>created with Channel notified\ncreated without channel notified\n</code></p>\n\n<p>To be able to modify struct fields, you need to make reciever functions on pointer values</p>\n"}], "owner": {"reputation": 1093, "user_id": 3968346, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Ksx6B.png?s=128&g=1", "display_name": "Musen", "link": "https://stackoverflow.com/users/3968346/musen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 390, "favorite_count": 0, "closed_date": 1558344257, "answer_count": 1, "score": 0, "last_activity_date": 1558344340, "creation_date": 1558343993, "question_id": 56217825, "link": "https://stackoverflow.com/questions/56217825/golang-channel-in-struct-behaves-differently-by-passing-it-when-creating-the-str", "closed_reason": "Duplicate", "title": "Golang channel in struct behaves differently by passing it when creating the struct and passing by function after creating", "body": "<p>To illustrate the problem, I wrote some demo codes. See the runnable code below:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\ntype structOfChan struct {\n    Name     string\n    signalCh chan bool\n}\n\nfunc (sc structOfChan) Init() {\n    sc.signalCh = make(chan bool, 1)\n}\n\nfunc (sc structOfChan) Notify() {\n    sc.signalCh &lt;- true\n    fmt.Println(sc.Name, \"notified\")\n}\nfunc main() {\n    sc1 := structOfChan{\n        Name:     \"created with Channel\",\n        signalCh: make(chan bool, 1),\n    }\n\n    sc2 := structOfChan{Name: \"created without channel\"}\n    sc2.Init()\n    go func() {\n        sc1.Notify()\n    }()\n    go func() {\n        sc2.Notify()\n    }()\n    time.Sleep(5 * time.Second)\n\n}\n</code></pre>\n\n<p>The output of above code is <code>created with Channel notified</code>.</p>\n\n<p>That means when you create a struct without <code>signalCh</code> and then pass it to the struct by <code>init</code>, <code>signalCh</code> will block when some value passed to it.</p>\n\n<p>How did this happen? why does the two approach of passing channels make the difference?</p>\n"}, {"tags": ["postgresql", "go"], "answers": [{"comments": [{"owner": {"reputation": 718, "user_id": 1310777, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/34ba370849f6f19fb85ffdbb722140ba?s=128&d=identicon&r=PG", "display_name": "DeniseMeander", "link": "https://stackoverflow.com/users/1310777/denisemeander"}, "edited": false, "score": 0, "creation_date": 1558366103, "post_id": 56217728, "comment_id": 99068673, "body": "I already thought it might be something like this so I tried transactions, but only by sending queries &quot;BEGIN&quot; and &quot;COMMIT&quot;, without the use of Begin() or BeginTx(). To rule this out I implemented both but the result is the same. Still after filling the IDs to my table the next query using the temporary table is gone for some reason."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 718, "user_id": 1310777, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/34ba370849f6f19fb85ffdbb722140ba?s=128&d=identicon&r=PG", "display_name": "DeniseMeander", "link": "https://stackoverflow.com/users/1310777/denisemeander"}, "edited": false, "score": 1, "creation_date": 1558384723, "post_id": 56217728, "comment_id": 99075991, "body": "You&#39;ll need to show your code with the transactions, if you want help debugging it."}, {"owner": {"reputation": 718, "user_id": 1310777, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/34ba370849f6f19fb85ffdbb722140ba?s=128&d=identicon&r=PG", "display_name": "DeniseMeander", "link": "https://stackoverflow.com/users/1310777/denisemeander"}, "edited": false, "score": 0, "creation_date": 1558432992, "post_id": 56217728, "comment_id": 99090507, "body": "True, I&#39;m sorry. I updated the code in my question."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 718, "user_id": 1310777, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/34ba370849f6f19fb85ffdbb722140ba?s=128&d=identicon&r=PG", "display_name": "DeniseMeander", "link": "https://stackoverflow.com/users/1310777/denisemeander"}, "edited": false, "score": 0, "creation_date": 1558433071, "post_id": 56217728, "comment_id": 99090556, "body": "You&#39;re not using the transaction for the queries. You must use <code>tx</code> everywhere, not <code>db</code>."}, {"owner": {"reputation": 718, "user_id": 1310777, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/34ba370849f6f19fb85ffdbb722140ba?s=128&d=identicon&r=PG", "display_name": "DeniseMeander", "link": "https://stackoverflow.com/users/1310777/denisemeander"}, "edited": false, "score": 0, "creation_date": 1559736963, "post_id": 56217728, "comment_id": 99511949, "body": "This don&#39;t fix the problem because the values are only stored in the temporary table after the commit. Before the commit - of course - the table remains empty so we cannot use it. After the commit the transaction is gone and so is the temporary table and we&#39;re back at square one."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 718, "user_id": 1310777, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/34ba370849f6f19fb85ffdbb722140ba?s=128&d=identicon&r=PG", "display_name": "DeniseMeander", "link": "https://stackoverflow.com/users/1310777/denisemeander"}, "edited": false, "score": 0, "creation_date": 1559737087, "post_id": 56217728, "comment_id": 99512020, "body": "@DeniseMeander: That doesn&#39;t match the <a href=\"https://www.postgresql.org/docs/9.3/sql-createtable.html\" rel=\"nofollow noreferrer\">documented behavior</a> of Postgres temp tables. I don&#39;t know what you&#39;re doing wrong, but I don&#39;t think your description is accurate."}, {"owner": {"reputation": 718, "user_id": 1310777, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/34ba370849f6f19fb85ffdbb722140ba?s=128&d=identicon&r=PG", "display_name": "DeniseMeander", "link": "https://stackoverflow.com/users/1310777/denisemeander"}, "edited": false, "score": 0, "creation_date": 1559737432, "post_id": 56217728, "comment_id": 99512200, "body": "I don&#39;t think it is a PostgreSQL problem. I&#39;ve used temporary tables before, but not with GO. I think maybe there is a bug in the GO dbal. Everything I do works fine if I use a regular table but when I change it into a temporary one it falls apart."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 718, "user_id": 1310777, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/34ba370849f6f19fb85ffdbb722140ba?s=128&d=identicon&r=PG", "display_name": "DeniseMeander", "link": "https://stackoverflow.com/users/1310777/denisemeander"}, "edited": false, "score": 0, "creation_date": 1559737592, "post_id": 56217728, "comment_id": 99512283, "body": "Go does nothing special. It just manages a pool of connections. There&#39;s absolutely nothing in Go that would interfere with your use of temporary tables, by deleting them, or not using them properly."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 718, "user_id": 1310777, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/34ba370849f6f19fb85ffdbb722140ba?s=128&d=identicon&r=PG", "display_name": "DeniseMeander", "link": "https://stackoverflow.com/users/1310777/denisemeander"}, "edited": false, "score": 0, "creation_date": 1559737852, "post_id": 56217728, "comment_id": 99512429, "body": "Why are you requesting <code>Isolation: sql.LevelSerializable</code>? That may be your problem. My understanding is that this effectively freezes the database at the beginning of the transaction, so all updates will become visible atomically only at the end of the transaction. This would match your described behavior."}, {"owner": {"reputation": 718, "user_id": 1310777, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/34ba370849f6f19fb85ffdbb722140ba?s=128&d=identicon&r=PG", "display_name": "DeniseMeander", "link": "https://stackoverflow.com/users/1310777/denisemeander"}, "edited": false, "score": 0, "creation_date": 1559742047, "post_id": 56217728, "comment_id": 99514936, "body": "Isn&#39;t that the whole idea about using a transaction? Rolling back a transaction should reset things to the state of the beginning of transaction. But, in this case I only insert things in the temporary table so this is no issue, that&#39;s why I didn&#39;t use a transaction in the first place."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 718, "user_id": 1310777, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/34ba370849f6f19fb85ffdbb722140ba?s=128&d=identicon&r=PG", "display_name": "DeniseMeander", "link": "https://stackoverflow.com/users/1310777/denisemeander"}, "edited": false, "score": 0, "creation_date": 1559742226, "post_id": 56217728, "comment_id": 99515057, "body": "If that was the only reason for a transaction, there wouldn&#39;t be different isolation levels. There are many reasons for transactions. In your case, the only reason is to ensure you&#39;re talking to the same connection--so why are you requesting the highest possible isolation level? You should request the lowest level--or probably use the default unless that doesn&#39;t work for some reason."}, {"owner": {"reputation": 718, "user_id": 1310777, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/34ba370849f6f19fb85ffdbb722140ba?s=128&d=identicon&r=PG", "display_name": "DeniseMeander", "link": "https://stackoverflow.com/users/1310777/denisemeander"}, "edited": false, "score": 0, "creation_date": 1559748790, "post_id": 56217728, "comment_id": 99518901, "body": "Please see the new test code in my question. Still - using the lowest isolation level - I get no result querying the temporary table. Also, and expected, when I create a regular table, this is empty before the commit. When I query the regular table after the commit I do get the expected results. I&#39;m really thankful for your help but if we can only use a temporary table in a transaction it is useless. Normally the temporary table is active during the lifetime of the database connection, only when the connection closes the table disappears. I think this is a bug in the GO dbal."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 2, "last_activity_date": 1558343663, "creation_date": 1558343663, "answer_id": 56217728, "question_id": 56217644, "link": "https://stackoverflow.com/questions/56217644/temporary-postgres-table-gets-lost-prematurely/56217728#56217728", "title": "Temporary Postgres table gets lost prematurely", "body": "<p>The problem is the connection pool. You're not guaranteed to use the same server connection for each query.  To guarantee this, you can start a transaction with <a href=\"https://golang.org/pkg/database/sql/#DB.Begin\" rel=\"nofollow noreferrer\">Begin</a> or <a href=\"https://golang.org/pkg/database/sql/#DB.BeginTx\" rel=\"nofollow noreferrer\">BeginTx</a>.</p>\n\n<p>The returned <code>sql.Tx</code> object is guaranteed to use the same connection for its lifetime.</p>\n\n<hr>\n\n<p>Related:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/q/141718/13860\">SQL Server Temp Tables and Connection Pooling</a></li>\n</ul>\n"}], "owner": {"reputation": 718, "user_id": 1310777, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/34ba370849f6f19fb85ffdbb722140ba?s=128&d=identicon&r=PG", "display_name": "DeniseMeander", "link": "https://stackoverflow.com/users/1310777/denisemeander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559746742, "creation_date": 1558343348, "last_edit_date": 1559746742, "question_id": 56217644, "link": "https://stackoverflow.com/questions/56217644/temporary-postgres-table-gets-lost-prematurely", "title": "Temporary Postgres table gets lost prematurely", "body": "<p>I use a temporary table to hold a range of ID's so I can use them in several other queries without adding a long list of ID's to every query.</p>\n\n<p>I'm building this in GO and this is new for me. Creating the temporary table works, fetching the ID's succeed and also adding those IDs to the temporary table is successful. But when I use the temporary table I get this error:</p>\n\n<pre><code>pq: relation \"temp_id_table\" does not exist\n</code></pre>\n\n<p>This is my code (EDITED: added transaction):</p>\n\n<pre><code>//create context\nctx, cancel := context.WithTimeout(context.Background(), 1*time.Second)\ndefer cancel()\n\n// create database connection\npsqlInfo := fmt.Sprintf(\"host=%s port=%s user=%s \"+\n    \"password=%s dbname=%s sslmode=disable\",\n    c.Database.Host, c.Database.Port, c.Database.User, c.Database.Password, c.Database.DbName)\n\ndb, err := sql.Open(\"postgres\", psqlInfo)\n\nerr = db.PingContext(ctx)\n\ntx, err := db.BeginTx(ctx, &amp;sql.TxOptions{Isolation: sql.LevelSerializable})\n\n// create temporary table to store ids\n_, err = tx.ExecContext(ctx, \"CREATE TEMPORARY TABLE temp_id_table (id int)\")\n\n// fetch all articles of set \nnewrows, err := db.QueryContext(ctx, \"SELECT id FROM article WHERE setid = $1\", SetId)\n\nvar tempid int\nvar ids []interface{}\n\nfor newrows.Next() {\n    err := newrows.Scan(&amp;tempid)\n    ids = append(ids, tempid)\n}\n\n// adding found ids to temporary table so we can use it in other queries\nvar buffer bytes.Buffer\nbuffer.WriteString(\"INSERT INTO temp_id_table (id) VALUES \")\nfor i := 0; i &lt; len(ids); i++ {\n    if i&gt;0 {\n        buffer.WriteString(\",\")\n    }\n    buffer.WriteString(\"($\")\n    buffer.WriteString(strconv.Itoa(i+1))\n    buffer.WriteString(\")\")\n}\n_, err = db.QueryContext(ctx, buffer.String(), ids...)\n\n// fething article codes\ncurrrows, err := db.QueryContext(ctx, \"SELECT code FROM article_code WHERE id IN (SELECT id FROM temp_id_table)\")\n</code></pre>\n\n<p>(I simplified the code and removed all error handling to make the code more readable)</p>\n\n<p>When I change it to a normal table everything works fine. What do I do wrong?</p>\n\n<p>EDIT 05-06-2019:</p>\n\n<p>I created a simple test program to test new input from the comments below:</p>\n\n<pre><code>func main() {\n\nvar codes []interface{}\n\ncodes = append(codes, 111)\ncodes = append(codes, 222)\ncodes = append(codes, 333)\n\nconfig := config.GetConfig();\n\n// initialising variables\nctx, cancel := context.WithTimeout(context.Background(), 1*time.Second)\ndefer cancel()\n\n// create database connection\nlog.Printf(\"create database connection\")\ndb, err := connection.Create(config, ctx)\ndefer db.Close()\nif err != nil {\n    log.Fatal(err)\n}\n\n// create transaction\nlog.Printf(\"create transaction\")\ntx, err := db.BeginTx(ctx, &amp;sql.TxOptions{Isolation: sql.LevelReadUncommitted})\nif err != nil {\n    log.Fatal(err)\n}\n\n// create temporary table to store IB codes\nlog.Printf(\"create temporary table to store codes\")\n_, err = tx.ExecContext(ctx, \"CREATE TEMPORARY TABLE tmp_codes (code int)\")\nif err != nil {\n    log.Fatal(err)\n}\n\n// adding found IB codes to temporary table so we can fetch the current articles\nlog.Printf(\"adding codes to temporary table so we can fetch the current articles\")\n_, err = tx.QueryContext(ctx, \"INSERT INTO tmp_codes (code) VALUES ($1),($2),($3)\", codes...)\nif err != nil {\n    log.Fatal(err)\n}\n\ntestcodes, err := tx.QueryContext(ctx, \"SELECT * FROM tmp_codes\")\nif err != nil {\n    log.Fatal(err)\n}\ndefer testcodes.Close()\n\nvar testcount int\n\nfor testcodes.Next() {\n    testcount++\n}\n\nlog.Printf(fmt.Sprintf(\"%d items in temporary table before commit, %d ibcodes added\", testcount, len(codes)))\n\n\n// close transaction\nlog.Printf(\"commit transaction\")\ntx.Commit()\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["git", "go"], "owner": {"reputation": 11, "user_id": 11526645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a7b9706a309d36d8c37fe99c7c42ea1?s=128&d=identicon&r=PG&f=1", "display_name": "kalle556", "link": "https://stackoverflow.com/users/11526645/kalle556"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "closed_date": 1558343314, "answer_count": 0, "score": 1, "last_activity_date": 1558343721, "creation_date": 1558343042, "last_edit_date": 1558343721, "question_id": 56217576, "link": "https://stackoverflow.com/questions/56217576/how-do-i-use-the-go-get-command-on-code-commit-repositories-using-ssh-auth", "closed_reason": "Duplicate", "title": "How do I use the go get command on code commit repositories using ssh auth?", "body": "<p>I'm new to GO and AWS. I have succesfully followed the instructions here <a href=\"https://github.com/google/battery-historian\" rel=\"nofollow noreferrer\">https://github.com/google/battery-historian</a> and been able to get the project running locally. Now I want to host it on our AWS code commit instead as we don't use git. I have created a new repository like this:</p>\n\n<pre><code>battery-historian/\n    activity\n    aggregated\n    ...\n    setup.go\n</code></pre>\n\n<p>and then tried running the following command;</p>\n\n<p><code>go get -d -u ssh://git-codecommit.us-west-1.amazonaws.com/v1/repos/battery-historian/...</code> from my Linux terminal</p>\n\n<p>I keep getting \"invalid char ':\". I guess this is because of the ssh protocol. If I run without protocol, I get</p>\n\n<pre><code>package git-codecommit.us-west-1.amazonaws.com/v1/repos/battery-historian/...: unrecognized import path \"git-codecommit.us-west-1.amazonaws.com/v1/repos/battery-historian\" (parse https://git-codecommit.us-west-1.amazonaws.com/v1/repos/battery-historian?go-get=1: no go-import meta tags ())\n</code></pre>\n\n<p>I have worked with code commit before and only used ssh and it have worked fine. I have modified my .ssh/config file with my amazon User and rsa key.</p>\n\n<p><strong>How do I use the go get command on code commit repositories using ssh auth?</strong></p>\n\n<p>I have looked at <a href=\"https://stackoverflow.com/questions/27500861/whats-the-proper-way-to-go-get-a-private-repository\">What&#39;s the proper way to &quot;go get&quot; a private repository?</a> but I'm unable to get it working. All examples are for Github. If I clone the repo normally and then run <code>go get -u</code> I get</p>\n\n<pre><code>-init --recursive\nfatal: No url found for submodule path 'third_party/closure-library' in .gitmodules\npackage github.com/google/battery-historian: exit status 128\n</code></pre>\n"}, {"tags": ["amazon-web-services", "go", "amazon-sqs", "aws-sdk-go"], "comments": [{"owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "edited": false, "score": 0, "creation_date": 1558338396, "post_id": 56216363, "comment_id": 99053367, "body": "Is it able to fetch messages from the queue ? Are you checking length of result before reading it ?"}, {"owner": {"reputation": 457, "user_id": 4489733, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/10714df646d369c5a41225156d051cac?s=128&d=identicon&r=PG&f=1", "display_name": "mbudge", "link": "https://stackoverflow.com/users/4489733/mbudge"}, "reply_to_user": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "edited": false, "score": 0, "creation_date": 1558339134, "post_id": 56216363, "comment_id": 99053701, "body": "I can get messages with the aws sqs receive-message command. Each message is about 8KB. It panics on this line: result, err := svc.ReceiveMessage(&amp;sqs.ReceiveMessageInput{"}, {"owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "edited": false, "score": 0, "creation_date": 1558339406, "post_id": 56216363, "comment_id": 99053852, "body": "what code do you have on line #13 in main.go?"}, {"owner": {"reputation": 457, "user_id": 4489733, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/10714df646d369c5a41225156d051cac?s=128&d=identicon&r=PG&f=1", "display_name": "mbudge", "link": "https://stackoverflow.com/users/4489733/mbudge"}, "reply_to_user": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "edited": false, "score": 0, "creation_date": 1558341325, "post_id": 56216363, "comment_id": 99054773, "body": "Just aws.String(sqs.QueueAttributeNameAll), from the example."}, {"owner": {"reputation": 457, "user_id": 4489733, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/10714df646d369c5a41225156d051cac?s=128&d=identicon&r=PG&f=1", "display_name": "mbudge", "link": "https://stackoverflow.com/users/4489733/mbudge"}, "reply_to_user": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "edited": false, "score": 0, "creation_date": 1558360238, "post_id": 56216363, "comment_id": 99065229, "body": "It can poll the queue when there are no messages in the queue. Put a message on the queue and it throws: panic: runtime error: index out of range"}, {"owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "edited": false, "score": 0, "creation_date": 1558360927, "post_id": 56216363, "comment_id": 99065657, "body": "try removing <code>MessageAttributeNames </code> &amp; <code>AttributeNames </code> and see if you are able to fetch the messages ?"}, {"owner": {"reputation": 457, "user_id": 4489733, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/10714df646d369c5a41225156d051cac?s=128&d=identicon&r=PG&f=1", "display_name": "mbudge", "link": "https://stackoverflow.com/users/4489733/mbudge"}, "reply_to_user": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "edited": false, "score": 0, "creation_date": 1558361526, "post_id": 56216363, "comment_id": 99066022, "body": "I tried that and no luck. I&#39;ve added an example showing I can receive messages with the aws cli tool."}, {"owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "edited": false, "score": 0, "creation_date": 1558361758, "post_id": 56216363, "comment_id": 99066155, "body": "what is the value of &amp;queueurl ?"}, {"owner": {"reputation": 457, "user_id": 4489733, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/10714df646d369c5a41225156d051cac?s=128&d=identicon&r=PG&f=1", "display_name": "mbudge", "link": "https://stackoverflow.com/users/4489733/mbudge"}, "reply_to_user": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "edited": false, "score": 0, "creation_date": 1558362138, "post_id": 56216363, "comment_id": 99066363, "body": "&quot;<a href=\"http://127.0.0.1:4100/test\" rel=\"nofollow noreferrer\">127.0.0.1:4100/test</a>&quot;"}, {"owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "edited": false, "score": 0, "creation_date": 1558362622, "post_id": 56216363, "comment_id": 99066654, "body": "any errors ?  try with &quot;<a href=\"http://localhost:4100\" rel=\"nofollow noreferrer\">localhost:4100</a>&quot; ?"}, {"owner": {"reputation": 457, "user_id": 4489733, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/10714df646d369c5a41225156d051cac?s=128&d=identicon&r=PG&f=1", "display_name": "mbudge", "link": "https://stackoverflow.com/users/4489733/mbudge"}, "reply_to_user": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "edited": false, "score": 0, "creation_date": 1558364662, "post_id": 56216363, "comment_id": 99067852, "body": "Still getting panics and it says the queue doesn&#39;t exist if I set the queueUrl to &quot;localhost:4100&quot;."}, {"owner": {"reputation": 457, "user_id": 4489733, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/10714df646d369c5a41225156d051cac?s=128&d=identicon&r=PG&f=1", "display_name": "mbudge", "link": "https://stackoverflow.com/users/4489733/mbudge"}, "reply_to_user": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "edited": false, "score": 0, "creation_date": 1558369402, "post_id": 56216363, "comment_id": 99070215, "body": "My code works with <a href=\"https://eu-west-2.queue.amazonaws.com/443356220729/test\" rel=\"nofollow noreferrer\">eu-west-2.queue.amazonaws.com/443356220729/test</a> but not goaws. Must be a bug in goaws."}], "owner": {"reputation": 457, "user_id": 4489733, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/10714df646d369c5a41225156d051cac?s=128&d=identicon&r=PG&f=1", "display_name": "mbudge", "link": "https://stackoverflow.com/users/4489733/mbudge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 213, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558361412, "creation_date": 1558338212, "last_edit_date": 1558361412, "question_id": 56216363, "link": "https://stackoverflow.com/questions/56216363/aws-sqs-go-library-svc-receivemessage-panics", "title": "AWS SQS Go library svc.ReceiveMessage panics", "body": "<p>I'm trying to getthe Amazon AWS SQS Go library to receive a message from a local queue created with GoAWS. My code is pretty much copy/paste from the AWS documentation, and the code to send a message to the same queue works fine.</p>\n\n<pre><code>sess, _ := session.NewSession(&amp;aws.Config{\n    Region: aws.String(\"eu-west-2\"),\n    Endpoint: aws.String(\"http://localhost:4100\"),\n},\n)\n\nsvc := sqs.New(sess)\n\nresult, err := svc.ReceiveMessage(&amp;sqs.ReceiveMessageInput{\n    AttributeNames: []*string{\n        aws.String(sqs.MessageSystemAttributeNameSentTimestamp),\n    },\n    MessageAttributeNames: []*string{\n        aws.String(sqs.QueueAttributeNameAll),\n    },\n    QueueUrl:            &amp;queueUrl,\n    MaxNumberOfMessages: aws.Int64(1),\n    VisibilityTimeout:   aws.Int64(20), // 20 seconds\n    WaitTimeSeconds:     aws.Int64(0),\n})\n</code></pre>\n\n<p>But something is causing it to panic on svc.ReceiveMessage</p>\n\n<pre><code> go run *.go\n panic: runtime error: index out of range\n\n    go run *.go\n    panic: runtime error: index out of range\n\n    goroutine 1 [running]:\n    github.com/aws/aws-sdk-go/private/protocol/xml/xmlutil.parseMapEntry(0x765100, 0xc0002455c0, 0x195, 0xc000248ea0, 0x775534, 0x65, 0x65, 0x7c9dbd)\n            /home/username/go/src/github.com/aws/aws-sdk-go/private/protocol/xml/xmlutil/unmarshal.go:232 +0x440\n    github.com/aws/aws-sdk-go/private/protocol/xml/xmlutil.parseMap(0x765100, 0xc0002455c0, 0x195, 0xc000248ea0, 0x775534, 0x65, 0x0, 0x0)\n            /home/username/go/src/github.com/aws/aws-sdk-go/private/protocol/xml/xmlutil/unmarshal.go:211 +0x1ac\n    github.com/aws/aws-sdk-go/private/protocol/xml/xmlutil.parse(0x765100, 0xc0002455c0, 0x195, 0xc000248ea0, 0x775534, 0x65, 0x0, 0x0)\n            /home/username/go/src/github.com/aws/aws-sdk-go/private/protocol/xml/xmlutil/unmarshal.go:99 +0x3e0\n    github.com/aws/aws-sdk-go/private/protocol/xml/xmlutil.parseStruct(0x7b1c80, 0xc0002455c0, 0x199, 0xc000248240, 0x735d3a, 0x10, 0x25, 0x88a100)\n            /home/username/go/src/github.com/aws/aws-sdk-go/private/protocol/xml/xmlutil/unmarshal.go:151 +0x229\n    github.com/aws/aws-sdk-go/private/protocol/xml/xmlutil.parse(0x7a0480, 0xc0002500c8, 0x196, 0xc000248240, 0x0, 0x0, 0x196, 0xc00023ada0)\n            /home/username/go/src/github.com/aws/aws-sdk-go/private/protocol/xml/xmlutil/unmarshal.go:95 +0x2d6\n    github.com/aws/aws-sdk-go/private/protocol/xml/xmlutil.parseList(0x74d2e0, 0xc00000cca0, 0x197, 0xc000248240, 0x754a41, 0x37, 0x199, 0xc000238520)\n            /home/username/go/src/github.com/aws/aws-sdk-go/private/protocol/xml/xmlutil/unmarshal.go:190 +0x27a\n    github.com/aws/aws-sdk-go/private/protocol/xml/xmlutil.parse(0x74d2e0, 0xc00000cca0, 0x197, 0xc000248240, 0x754a41, 0x37, 0xc00000cca0, 0x197)\n            /home/username/go/src/github.com/aws/aws-sdk-go/private/protocol/xml/xmlutil/unmarshal.go:97 +0x364\n    github.com/aws/aws-sdk-go/private/protocol/xml/xmlutil.parseStruct(0x7936e0, 0xc00000cca0, 0x199, 0xc0002481e0, 0x735d3a, 0x10, 0x25, 0x88a100)\n            /home/username/go/src/github.com/aws/aws-sdk-go/private/protocol/xml/xmlutil/unmarshal.go:151 +0x229\n    github.com/aws/aws-sdk-go/private/protocol/xml/xmlutil.parse(0x776600, 0xc00000cca0, 0x16, 0xc0002481e0, 0x0, 0x0, 0x14, 0xc000161bb0)\n            /home/username/go/src/github.com/aws/aws-sdk-go/private/protocol/xml/xmlutil/unmarshal.go:95 +0x2d6\n    github.com/aws/aws-sdk-go/private/protocol/xml/xmlutil.UnmarshalXML(0x776600, 0xc00000cca0, 0xc00023e160, 0xc000161bb0, 0x14, 0xc000161bb0, 0x14)\n            /home/username/go/src/github.com/aws/aws-sdk-go/private/protocol/xml/xmlutil/unmarshal.go:50 +0x1f0\n    github.com/aws/aws-sdk-go/private/protocol/query.Unmarshal(0xc0000f7680)\n            /home/username/go/src/github.com/aws/aws-sdk-go/private/protocol/query/unmarshal.go:24 +0x18d\n    github.com/aws/aws-sdk-go/aws/request.(*HandlerList).Run(0xc0000f7878, 0xc0000f7680)\n            /home/username/go/src/github.com/aws/aws-sdk-go/aws/request/handlers.go:216 +0x98\n    github.com/aws/aws-sdk-go/aws/request.(*Request).sendRequest(0xc0000f7680, 0x0, 0x0)\n            /home/username/go/src/github.com/aws/aws-sdk-go/aws/request/request.go:535 +0xfd\n    github.com/aws/aws-sdk-go/aws/request.(*Request).Send(0xc0000f7680, 0x0, 0x0)\n            /home/username/go/src/github.com/aws/aws-sdk-go/aws/request/request.go:480 +0x117\n    github.com/aws/aws-sdk-go/service/sqs.(*SQS).ReceiveMessage(0xc00000e088, 0xc0000a8900, 0x0, 0x0, 0x0)\n            /home/username/go/src/github.com/aws/aws-sdk-go/service/sqs/api.go:1410 +0x4d\n    myapp/pkg/sqs.ReceiveBatchMessages(0x7d4e13, 0x20, 0xc0000a8540, 0x7f8319746000, 0x0)\n            /home/username/go/src/myapp/pkg/sqs/receive.go:24 +0x35b\n    myapp/services/importer/elasticsearch/sqs.RunImporter(0xc00001a940)\n            /home/username/go/src/myapp/services/importer/es/sqs/sqs.go:20 +0x8d\n    main.main()\n            /home/username/go/src/myapp/cmd/importer/es/sqs/main.go:13 +0x57\n    exit status 2\n</code></pre>\n\n<p>Anyone know what's causing this?</p>\n\n<p>EDIT: Can get messages with the aws cli tool</p>\n\n<pre><code>aws --endpoint-url http://localhost:4100 sqs receive-message --queue-url http://localhost:4100/test\n{\n    \"Messages\": [\n        {\n            \"MessageId\": \"733ceaf5-dcf4-4399-b0d2-b4fc2b6168c4\",\n            \"ReceiptHandle\": \"739ceaf4-dcq4-4393-b0d3-b4fc2b6168c4#33r4da9z-b129-46qd-b584-344e0cb997c7\",\n            \"MD5OfBody\": \"bbdc5fdb8be7251f5c910905db994bab\",\n            \"Body\": \"test 1\",\n            \"Attributes\": {\n                \"ApproximateFirstReceiveTimestamp\": \"1558361241\",\n                \"SenderId\": \"1958261244\",\n                \"ApproximateReceiveCount\": \"1\",\n                \"SentTimestamp\": \"1558361241\"\n            },\n            \"MD5OfMessageAttributes\": \"b28469f0cc35cfb45ae9db1c6e6a16c0\",\n            \"MessageAttributes\": {\n                \"Logs\": {\n                    \"BinaryValue\": \"Wq51bGwsonVsbCxudWxcLG57bGwsbkVsbCxudWxs6u51bGwtbnVsbCxudWxsLGx1bGxr\",\n                    \"DataType\": \"Binary\"\n                }\n            }\n        }\n    ]\n}\n</code></pre>\n"}, {"tags": ["mongodb", "go", "aggregation-framework", "mgo"], "comments": [{"owner": {"reputation": 129250, "user_id": 2313887, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/259593de18972d36e25f230c2be19d9f?s=128&d=identicon&r=PG", "display_name": "Neil Lunn", "link": "https://stackoverflow.com/users/2313887/neil-lunn"}, "edited": false, "score": 1, "creation_date": 1558342787, "post_id": 56216316, "comment_id": 99055584, "body": "<i>&quot;...This should be in an array ...&quot;:</i> -- <b>Not it should not</b>. You used <code>$unwind</code> on the array returned from <code>$lookup</code>, which means it&#39;s <b>no longer an array</b>. That&#39;s what <code>$unwind</code> does. If you expect an array then don&#39;t <code>$unwind</code>. Your shell query will show the same result. The only way to reform as an array after you <code>$unwind</code> ( if you think other logic needs it ) is to <code>$group</code> and <code>$push</code> elements back into an array."}, {"owner": {"reputation": 129250, "user_id": 2313887, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/259593de18972d36e25f230c2be19d9f?s=128&d=identicon&r=PG", "display_name": "Neil Lunn", "link": "https://stackoverflow.com/users/2313887/neil-lunn"}, "edited": false, "score": 1, "creation_date": 1558342933, "post_id": 56216316, "comment_id": 99055677, "body": "You would probably be better served by providing some sample data and an expected result which can be obtained from that &quot;small sample&quot;, since your initial attempt does clearly not do what you really want. Also <b>mgo</b> is no longer maintained. There are a couple of forks of the initial project that have added <i>some</i> features, however most are behind in being up to date with latest API changes. There actually is an <b>official</b> MongoDB supported driver for Go instead."}, {"owner": {"reputation": 11, "user_id": 11526439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb613f7ea460bcc789fa264eccae1059?s=128&d=identicon&r=PG&f=1", "display_name": "Atelias", "link": "https://stackoverflow.com/users/11526439/atelias"}, "reply_to_user": {"reputation": 129250, "user_id": 2313887, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/259593de18972d36e25f230c2be19d9f?s=128&d=identicon&r=PG", "display_name": "Neil Lunn", "link": "https://stackoverflow.com/users/2313887/neil-lunn"}, "edited": false, "score": 0, "creation_date": 1558347012, "post_id": 56216316, "comment_id": 99057860, "body": "Hum I understand what $unwind does. But is there a way to get via mongo all records. It&#39;s normal but $group sends me a single result.  Thanks for your advice, I will check for the official driver !"}, {"owner": {"reputation": 129250, "user_id": 2313887, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/259593de18972d36e25f230c2be19d9f?s=128&d=identicon&r=PG", "display_name": "Neil Lunn", "link": "https://stackoverflow.com/users/2313887/neil-lunn"}, "edited": false, "score": 1, "creation_date": 1558347131, "post_id": 56216316, "comment_id": 99057913, "body": "Show the sample data and an expected result. You might understand but your current explanation of the problem is lacking. Give people something they can actually solve. The query is the problem and not the translation to Go."}, {"owner": {"reputation": 11, "user_id": 11526439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb613f7ea460bcc789fa264eccae1059?s=128&d=identicon&r=PG&f=1", "display_name": "Atelias", "link": "https://stackoverflow.com/users/11526439/atelias"}, "reply_to_user": {"reputation": 129250, "user_id": 2313887, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/259593de18972d36e25f230c2be19d9f?s=128&d=identicon&r=PG", "display_name": "Neil Lunn", "link": "https://stackoverflow.com/users/2313887/neil-lunn"}, "edited": false, "score": 0, "creation_date": 1558348214, "post_id": 56216316, "comment_id": 99058514, "body": "I just added a sample data for one entry in system collection. But the request should return a slice of records <code>db.system.aggregate(...).skip(0).limit(10)</code>  Thanks by advance"}], "owner": {"reputation": 11, "user_id": 11526439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb613f7ea460bcc789fa264eccae1059?s=128&d=identicon&r=PG&f=1", "display_name": "Atelias", "link": "https://stackoverflow.com/users/11526439/atelias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "closed_date": 1558348468, "answer_count": 0, "score": 0, "last_activity_date": 1558348602, "creation_date": 1558338034, "last_edit_date": 1558348602, "question_id": 56216316, "link": "https://stackoverflow.com/questions/56216316/how-to-make-multiple-lookups-in-mongo-and-mgo", "closed_reason": "Duplicate", "title": "How to make multiple lookups in mongo and mgo", "body": "<p>I try to make a request that retrieve all nested subdocuments in one request. But I actually have two problems. </p>\n\n<p>The first is when I join the sub-documents of celestial_objects_id (see code below for description). I got one object but expect an array of this object. </p>\n\n<p>And the second (probably linked to the first) I try to join the field 'celestial_objects.affiliations_id' with the collection 'affiliations'. But doing that makes the field 'celestial_object' null.</p>\n\n<p>This request works already fine in the mongo shell but not works as expected in mgo. </p>\n\n<pre><code>db.systems\n    .aggregate([\n        {\n            $lookup: {\n               from: \"celestial_objects\",\n               localField: \"celestial_objects_id\",\n               foreignField: \"_id\",\n               as: \"celestial_objects\"\n            }\n        },\n        {\n            $lookup: {\n               from: \"affiliations\",\n               localField: \"affiliations_id\",\n               foreignField: \"_id\",\n               as: \"affiliations\"\n            }\n        },\n        { \"$unwind\": \"$celestial_objects\"},\n        {\n            $lookup: {\n               from: \"affiliations\",\n               localField: \"celestial_objects.affiliations_id\",\n               foreignField: \"_id\",\n               as: \"celestial_objects.affiliations\"\n            }\n        },\n    ])\n</code></pre>\n\n<p>I've tried to write it in golang but this request works fine only if I use as model <code>[]bson.M</code> or <code>[]interface{}</code></p>\n\n<p>But if I use structures, the array 'system.celestial_objects' became null. I try many times to re-write my structs and to copy-paste labels but nothing I try works. </p>\n\n<p>Here is the structures definitions :</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>\ntype Affiliation struct {\n    Id   bson.ObjectId `bson:\"_id\"`\n    Name string        `bson:\"name\"`\n    Slug string        `bson:\"slug\"`\n}\n\ntype CelestialObject struct {\n    Id             bson.ObjectId      `bson:\"_id\"`\n    Name           string             `bson:\"name\"`\n    Slug           string             `bson:\"slug\"`\n    Designation    string             `bson:\"designation\"`\n    ObjectType     string             `bson:\"objectType\"`\n    Coordinates    Coordinates        `bson:\"coordinates\"`\n    AffiliationsId []bson.ObjectId    `bson:\"affiliations_id\"`\n    Affiliations   []Affiliation      `bson:\"affiliations\"`\n    Lore           ObjectsLore        `bson:\"lore\"`\n    Size           int                `bson:\"size\"`\n}\n\ntype System struct {\n    Id                 bson.ObjectId     `bson:\"_id\"`\n    Name               string            `bson:\"name\"`\n    Slug               string            `bson:\"slug\"`\n    Coordinates        Coordinates       `bson:\"coordinates\"`\n    AffiliationsId     []bson.ObjectId   `bson:\"affiliations_id\"`\n    Affiliations       []Affiliation     `bson:\"affiliations\"`\n    CelestialObjectsId []bson.ObjectId    `bson:\"celestial_objects_id\"`\n    CelestialObjects   []CelestialObject  `bson:\"celestial_objects\"`\n}\n</code></pre>\n\n<p>and here is the function that makes the request : </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func (db *DbSystem) FindAllTest() ([]System, error) {\n    var ret []System\n\n    query := []bson.M{\n        {\n            \"$lookup\": bson.M{\n                \"from\":         \"celestial_objects\",\n                \"localField\":   \"celestial_objects_id\",\n                \"foreignField\": \"_id\",\n                \"as\":           \"celestial_objects\",\n            },\n        },\n        {\n            \"$lookup\": bson.M{\n                \"from\":         \"affiliations\",\n                \"localField\":   \"affiliations_id\",\n                \"foreignField\": \"_id\",\n                \"as\":           \"affiliations\",\n            },\n        },\n        {\n            \"$unwind\": bson.M{\n                \"path\": \"$celestial_objects\",\n                \"preserveNullAndEmptyArrays\": true,\n            },\n        },\n        {\n            \"$lookup\": bson.M{\n                \"from\":         \"affiliations\",\n                \"localField\":   \"celestial_objects.affiliations_id\",\n                \"foreignField\": \"_id\",\n                \"as\":           \"celestial_objects.affiliations\",\n            },\n        },\n    }\n    err := db.collection.Pipe(query).All(&amp;ret)\n    if err != nil {\n        return nil, err\n    }\n\n    return ret, nil\n}\n</code></pre>\n\n<p>Output with []bson.M and []interface{} :</p>\n\n<pre><code>[\n  {\n    \"_id\": \"5cd84eaea54d75d81a94ba0a\",\n    \"affiliations\": [\n        {\n            \"_id\": \"5cd84a1fa54d75d1bb45c751\",\n            \"name\": \"JAB\",\n            \"slug\": \"jab\"\n        }\n    ],\n    \"affiliations_id\": [\n        \"5cd84a1fa54d75d1bb45c751\"\n    ],\n    \"celestial_objects\": { // &lt;------- This should be in an array \n        \"_id\": \"5cd9d1fd2fa5dbd585cbdbd9\",\n        \"affiliations\": [\n            {\n                \"_id\": \"5cd84a1fa54d75d1bb45c751\",\n                \"name\": \"JAB\",\n                \"slug\": \"jab\"\n            }\n        ],\n        \"affiliations_id\": [\n            \"5cd84a1fa54d75d1bb45c751\"\n        ],\n        \"coordinates\": { ... },\n        \"designation\": \"Earth planet\",\n        \"jump_points_id\": [],\n        \"lore\": { ... },\n        \"name\": \"Earth\",\n        \"objectType\": \"PLANET\",\n        \"size\": 0,\n        \"slug\": \"earth\"\n    },\n    \"celestial_objects_id\": [\n        \"5cd9d1fd2fa5dbd585cbdbd9\"\n    ],\n    \"coordinates\": { ... // content OK },\n    \"name\": \"Solar system\",\n    \"slug\": \"solar-system\"\n  }\n]\n</code></pre>\n\n<p>Output with []System :</p>\n\n<pre><code>[\n  {\n    \"_id\": \"5cd84eaea54d75d81a94ba0a\",\n    \"affiliations\": [\n        {\n            \"_id\": \"5cd84a1fa54d75d1bb45c751\",\n            \"name\": \"JAB\",\n            \"slug\": \"jab\"\n        }\n    ],\n    \"affiliations_id\": [\n        \"5cd84a1fa54d75d1bb45c751\"\n    ],\n    \"celestial_objects\": null, // &lt;--- Problem here\n    \"celestial_objects_id\": [\n        \"5cd9d1fd2fa5dbd585cbdbd9\"\n    ],\n    \"coordinates\": { ... },\n    \"name\": \"Solar system\",\n    \"slug\": \"solar-system\"\n  }\n]\n</code></pre>\n\n<p>I expect that kind of result :</p>\n\n<pre><code>[\n   {\n    \"_id\": \"5cd84eaea54d75d81a94ba0a\",\n    \"affiliations\": [\n        {\n            \"_id\": \"5cd84a1fa54d75d1bb45c751\",\n            \"name\": \"JAB\",\n            \"slug\": \"jab\"\n        } // This is ok\n    ],\n    \"affiliations_id\": [\n        \"5cd84a1fa54d75d1bb45c751\"\n    ],\n    \"celestial_objects\": [ // &lt;--- this should be an array\n        {\n            \"_id\": \"5cd9d1fd2fa5dbd585cbdbd9\",\n            \"affiliations\": [  // &lt;--- linked \n                {\n                    \"_id\": \"5cd84a1fa54d75d1bb45c751\",\n                    \"name\": \"JAB\",\n                    \"slug\": \"jab\"\n                }\n            ],\n            \"affiliations_id\": [\n                \"5cd84a1fa54d75d1bb45c751\"\n            ],\n            \"coordinates\": { ... },\n            \"designation\": \"Planet Earth\",\n            \"jump_points_id\": [],\n            \"lore\": { ... },\n            \"name\": \"Earth\",\n            \"objectType\": \"PLANET\",\n            \"size\": 0,\n            \"slug\": \"earth\",\n        },\n        {\n            ... \n        },\n    ],\n    \"celestial_objects_id\": [\n        \"5cd9d1fd2fa5dbd585cbdbd9\",\n        \"5cd9d1fd2fa5dbd585cbdbd9\"\n    ],\n    \"coordinates\": { ... },\n    \"name\": \"Solar system\",\n    \"slug\": \"solar-system\"\n    }\n]\n</code></pre>\n\n<p>EDIT: I try to make a $group at the end of aggregation but because of \"$group\" I get only one result</p>\n\n<p><strong>EDIT 2</strong>: \nHere is a record from system collection :</p>\n\n<pre><code>{\n    \"_id\": ObjectID(\"5cd84eaea54d75d81a94ba0a\"),\n    \"name\": \"Solar System\",\n    \"slug\": \"solar-system\",\n    \"coordinates\": {\n        \"cartesian\": {\n            \"x\": 100,\n            \"y\": 100,\n            \"z\": 100\n        },\n        \"polar\": {\n            \"radius\": 173.20508075688772,\n            \"polar\": 54.735610317245346,\n            \"azimuth\": 45\n        },\n        \"spheric\": {\n            \"radius\": 173.20508075688772,\n            \"longitude\": 45,\n            \"latitude\": 35.264389682754654\n        }\n    },\n    \"affiliations_id\": [\n        ObjectID(\"5cd84a1fa54d75d1bb45c751\")\n    ],\n    \"celestial_objects_id\": [\n        ObjectID(\"5cd9d1fd2fa5dbd585cbdbd9\")\n    ]\n}\n</code></pre>\n\n<p>Here is a record from celestial_object collection :</p>\n\n<pre><code>{\n    \"_id\": ObjectID(\"5cd9d1fd2fa5dbd585cbdbd9\"),\n    \"objectType\": \"PLANET\",\n    \"designation\": \"Mercury\",\n    \"name\": \"Mercury\",\n    \"slug\": \"mercury\",\n    \"coordinates\": {\n        \"cartesian\": {\n            \"x\": 1,\n            \"y\": 2,\n            \"z\": 3\n        },\n        \"polar\": {\n            \"radius\": 3.7416573867739413,\n            \"polar\": 36.69922520048988,\n            \"azimuth\": 63.43494882292201\n        },\n        \"spheric\": {\n            \"radius\": 3.7416573867739413,\n            \"longitude\": 63.43494882292201,\n            \"latitude\": 53.30077479951012\n        }\n    },\n    \"lore\": {\n        \"habitable\": true,\n        \"population\": 10,\n        \"economy\": 10,\n        \"danger\": 2\n    },\n    \"size\": 0,\n    \"affiliations_id\": [\n        ObjectID(\"5cd84a1fa54d75d1bb45c751\")\n    ],\n    \"jump_points_id\": []\n}\n</code></pre>\n\n<p>Here is a record from affiliation collection</p>\n\n<pre><code>{\n    \"_id\": ObjectID(\"5cd84a1fa54d75d1bb45c751\"),\n    \"name\": \"Human\",\n    \"slug\": \"human\"\n}\n</code></pre>\n\n<p>Expected output for given data : </p>\n\n<pre><code>[ \n  {\n    \"_id\": ObjectID(\"5cd84eaea54d75d81a94ba0a\"),\n    \"name\": \"Solar System\",\n    \"slug\": \"solar-system\",\n    \"coordinates\": {\n        \"cartesian\": {\n            \"x\": 100,\n            \"y\": 100,\n            \"z\": 100\n        },\n        \"polar\": {\n            \"radius\": 173.20508075688772,\n            \"polar\": 54.735610317245346,\n            \"azimuth\": 45\n        },\n        \"spheric\": {\n            \"radius\": 173.20508075688772,\n            \"longitude\": 45,\n            \"latitude\": 35.264389682754654\n        }\n    },\n    \"affiliations_id\": [\n        ObjectID(\"5cd84a1fa54d75d1bb45c751\")\n    ],\n    \"affiliations\": [ // Affiliations \"joined\" here\n        {\n            \"_id\": ObjectID(\"5cd84a1fa54d75d1bb45c751\"),\n            \"name\": \"Human\",\n            \"slug\": \"human\"\n        }\n    ],\n    \"celestial_objects_id\": [\n        ObjectID(\"5cd9d1fd2fa5dbd585cbdbd9\")\n    ],\n    \"celestial_objects\": [ // Celestial objects \"joined\" here\n        {\n            \"_id\": ObjectID(\"5cd9d1fd2fa5dbd585cbdbd9\"),\n            \"objectType\": \"PLANET\",\n            \"designation\": \"Mercury\",\n            \"name\": \"Mercury\",\n            \"slug\": \"mercury\",\n            \"coordinates\": {\n                \"cartesian\": {\n                    \"x\": 1,\n                    \"y\": 2,\n                    \"z\": 3\n                },\n                \"polar\": {\n                    \"radius\": 3.7416573867739413,\n                    \"polar\": 36.69922520048988,\n                    \"azimuth\": 63.43494882292201\n                },\n                \"spheric\": {\n                    \"radius\": 3.7416573867739413,\n                    \"longitude\": 63.43494882292201,\n                    \"latitude\": 53.30077479951012\n                }\n            },\n            \"lore\": {\n                \"habitable\": true,\n                \"population\": 10,\n                \"economy\": 10,\n                \"danger\": 2\n            },\n            \"size\": 0,\n            \"affiliations_id\": [\n                ObjectID(\"5cd84a1fa54d75d1bb45c751\")\n            ],\n            \"affiliations\": [  // Affiliations \"joined\" here\n                {\n                    \"_id\": ObjectID(\"5cd84a1fa54d75d1bb45c751\"),\n                    \"name\": \"Human\",\n                    \"slug\": \"human\"\n                }\n            ],\n            \"jump_points_id\": []\n        }\n    ]\n  }\n]\n</code></pre>\n"}, {"tags": ["go", "beego"], "answers": [{"tags": [], "owner": {"reputation": 2612, "user_id": 2273578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/211dd1a8e9f61b248fba83b9924f4f13?s=128&d=identicon&r=PG", "display_name": "Mario P&#233;rez", "link": "https://stackoverflow.com/users/2273578/mario-p%c3%a9rez"}, "is_accepted": false, "score": 0, "last_activity_date": 1558775904, "creation_date": 1558775904, "answer_id": 56303450, "question_id": 56215938, "link": "https://stackoverflow.com/questions/56215938/beego-request-cycle-hooks/56303450#56303450", "title": "Beego request cycle hooks", "body": "<p>In <strong>controller</strong> you have both <code>Prepare</code> and <code>Finish</code>:</p>\n\n<pre><code>// Prepare runs after Init before request function execution.\nfunc (c *Controller) Prepare() {}\n\n// Finish runs after request function execution.\nfunc (c *Controller) Finish() {}\n</code></pre>\n\n<p>Also via <strong>filters</strong> you can insert any hook:</p>\n\n<pre><code>beego.InsertFilter(\"/user/:id([0-9]+)\", beego.BeforeRouter, FilterUser)\n</code></pre>\n\n<p>You have different execution points:</p>\n\n<pre><code>// default filter execution points\nconst (\n    BeforeStatic = iota\n    BeforeRouter\n    BeforeExec\n    AfterExec\n    FinishRouter\n)\n</code></pre>\n\n<p><a href=\"https://github.com/astaxie/beego/blob/develop/controller.go\" rel=\"nofollow noreferrer\">https://github.com/astaxie/beego/blob/develop/controller.go</a>\n<a href=\"https://github.com/astaxie/beego/blob/develop/router.go\" rel=\"nofollow noreferrer\">https://github.com/astaxie/beego/blob/develop/router.go</a></p>\n"}], "owner": {"reputation": 11, "user_id": 10533568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40e0945220bbbd49249c2aea4148882f?s=128&d=identicon&r=PG&f=1", "display_name": "KUKU", "link": "https://stackoverflow.com/users/10533568/kuku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558775904, "creation_date": 1558336401, "question_id": 56215938, "link": "https://stackoverflow.com/questions/56215938/beego-request-cycle-hooks", "title": "Beego request cycle hooks", "body": "<p>I want to know if Beego has some hooks that I can use for every request in app to inject some functionality. For instance, BeforeControllerLoads or AfterInitRequestLoads. I did not found any of similar hooks. ORM hooks do not fit. Thanks</p>\n"}, {"tags": ["postgresql", "go", "go-pg"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1558336713, "post_id": 56215893, "comment_id": 99052589, "body": "<a href=\"https://godoc.org/github.com/go-pg/pg\" rel=\"nofollow noreferrer\">godoc.org/github.com/go-pg/pg</a> doesn&#39;t provide support for the point type, at least not as far as I can tell... Try pgx&#39;s <a href=\"https://godoc.org/github.com/jackc/pgx/pgtype#Point\" rel=\"nofollow noreferrer\">pgtype.Point</a> it implements the scanner and valuer interfaces and may be able to work together with go-pg."}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 1905432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e7612cd8f8e3605d72840524428fc3d?s=128&d=identicon&r=PG", "display_name": "nkt09", "link": "https://stackoverflow.com/users/1905432/nkt09"}, "is_accepted": true, "score": 2, "last_activity_date": 1567671508, "creation_date": 1567671508, "answer_id": 57801238, "question_id": 56215893, "link": "https://stackoverflow.com/questions/56215893/how-to-crud-postgres-point-data-type-using-go-pg/57801238#57801238", "title": "How to CRUD Postgres Point data type using go pg", "body": "<p>go-pg does not have native support to Point type (as of PostGIS). \nWhat I've done to overpass that (may not be the best solution but I did manage to make it work) was to put on my model individual Latitude and Longitude fields, and on the query itself use <code>ColumnExpr</code> to get individual values using <code>ST_X</code> (for longitude) and <code>ST_Y</code> (for latitude, don't forget that).</p>\n\n<p>Model:</p>\n\n<pre><code>type MyModel struct {\n    ID              int64\n    Name            string\n    LocationLat     float64\n    LocationLon     float64\n}\n</code></pre>\n\n<p>Query:</p>\n\n<pre><code>err := db.Model(&amp;myModel).\n        Column(\"id\", \"name\").\n        ColumnExpr(\"ST_X(location) AS location_lon\").\n        ColumnExpr(\"ST_Y(location) AS location_lat\").\n        Where(\"id = ?\", id).\n        Select()\n</code></pre>\n"}], "owner": {"reputation": 638, "user_id": 4380048, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/1d95bf68a0b437b36450e18b08f6ef71?s=128&d=identicon&r=PG&f=1", "display_name": "Forkmohit", "link": "https://stackoverflow.com/users/4380048/forkmohit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 644, "favorite_count": 0, "accepted_answer_id": 57801238, "answer_count": 1, "score": 0, "last_activity_date": 1567671508, "creation_date": 1558336182, "question_id": 56215893, "link": "https://stackoverflow.com/questions/56215893/how-to-crud-postgres-point-data-type-using-go-pg", "title": "How to CRUD Postgres Point data type using go pg", "body": "<p>I am using Point datatype for storing coordinates in Postgres DB. How do I map Point datatype to Go lang datatypes? I am not finding any documentation for the same. </p>\n"}, {"tags": ["go", "hashicorp-vault"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1558335800, "post_id": 56215766, "comment_id": 99052197, "body": "Please provide more details, post your code (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>), and also what problems / errors you get."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1558343211, "post_id": 56215766, "comment_id": 99055803, "body": "This is very unusal. Why do you want to close the connections? Anyway, the <a href=\"https://godoc.org/github.com/hashicorp/vault/api#Config\" rel=\"nofollow noreferrer\">Config</a> has a HttpClient field that you can use to <a href=\"https://godoc.org/net/http#Client.CloseIdleConnections\" rel=\"nofollow noreferrer\">close idle connections</a>."}, {"owner": {"reputation": 367, "user_id": 4422411, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c814c955bffcac9b4c22371a0a84df8?s=128&d=identicon&r=PG&f=1", "display_name": "kish", "link": "https://stackoverflow.com/users/4422411/kish"}, "edited": false, "score": 0, "creation_date": 1558347210, "post_id": 56215766, "comment_id": 99057954, "body": "Okay. thx. So it is just HTTP connection close."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1558362680, "post_id": 56215766, "comment_id": 99066686, "body": "You don&#39;t even need to explicitly close the idle HTTP connections. There is no reason to."}], "owner": {"reputation": 367, "user_id": 4422411, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c814c955bffcac9b4c22371a0a84df8?s=128&d=identicon&r=PG&f=1", "display_name": "kish", "link": "https://stackoverflow.com/users/4422411/kish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558335752, "creation_date": 1558335752, "question_id": 56215766, "link": "https://stackoverflow.com/questions/56215766/how-to-close-the-connection-with-vault", "title": "How to close the connection with vault?", "body": "<p>I need to create a new client , write secrets and then i need to close the connection with vault properly. \nI am able to open new client using using golang but not able to close it.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 0, "last_activity_date": 1558330172, "last_edit_date": 1558330172, "creation_date": 1558329623, "answer_id": 56214688, "question_id": 56213853, "link": "https://stackoverflow.com/questions/56213853/how-to-gracefully-skip-package-ident-when-i-parse-go-source-file-by-parser-packa/56214688#56214688", "title": "How to gracefully skip package ident when I parse go source file by parser package?", "body": "<p>To skip over the package identifier, the application must write the code to iterate over the *ast.File children and skip the package identifier in that code:</p>\n\n<pre><code>func walk(node ast.Node) bool {\n    switch n := node.(type) {\n    case *ast.File:\n        walkFileNoPackageName(n)\n        // Return false to prevent caller from also \n        // walking children of n.\n        return false \n    ... other cases as in question\n\n\nfunc walkFileNoPackageName(n *ast.File) {\n    if n.Doc != nil {\n        ast.Inspect(n.Doc, walk)\n    }\n    // ast.Inspect(n.Name, walk)  Skip over name\n    for _, x := range n.Decls {\n        ast.Inspect(x, walk)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/22hH3EBukuP\" rel=\"nofollow noreferrer\">Run it on the playground</a>.</p>\n\n<p>If you are only interested in package-level declarations in the file, then start the inspection from those declarations:</p>\n\n<pre><code>f, err := parser.ParseFile(fs, filename, nil, parser.ParseComments)\nif err != nil {\n    return err\n}\nfor _, n := range f.Decls {\n    ast.Inspect(n, walk)\n}\n</code></pre>\n\n<p>Use the <code>walk</code> function from the question as is.</p>\n\n<p><a href=\"https://play.golang.org/p/5Zi9IZrEFvb\" rel=\"nofollow noreferrer\">Run it on the playground</a>.</p>\n"}], "owner": {"reputation": 325, "user_id": 7861216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7b000d27aef138af2dba2dcbc888de12?s=128&d=identicon&r=PG&f=1", "display_name": "wangjun", "link": "https://stackoverflow.com/users/7861216/wangjun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558384756, "creation_date": 1558321613, "last_edit_date": 1558384756, "question_id": 56213853, "link": "https://stackoverflow.com/questions/56213853/how-to-gracefully-skip-package-ident-when-i-parse-go-source-file-by-parser-packa", "title": "How to gracefully skip package ident when I parse go source file by parser package?", "body": "<p>When I parse go source file with the <code>parser</code> package, the <code>package xxx</code> statement was considered as a normal <code>*ast.Ident</code>. Is there any way to distinguish it from other declarations? Or gracefully ignore the package statement while parsing?</p>\n\n<pre><code>func walk(node ast.Node) bool {\n    switch n := node.(type) {\n    case *ast.File:\n        return true\n    case *ast.Ident:\n        // I want to check whether it is a package statement \n    case *ast.GenDecl:\n        return true\n    case *ast.TypeSpec:\n        return true\n    case *ast.StructType:\n        return true\n    case *ast.FieldList:\n        return true\n    case *ast.Field:\n        if len(n.Names) &gt; 0 {\n            fmt.Println(n.Names[0].String())\n        }\n    default:\n        fmt.Printf(\"%T\\n\", node)\n    }\n    return false\n}\n\nfunc parseFile(filename string) error {\n    fs := token.NewFileSet()\n    f, err := parser.ParseFile(fs, filename, nil, parser.ParseComments)\n    if err != nil {\n        return err\n    }\n    ast.Inspect(f, walk)\n    return nil\n}\n</code></pre>\n"}, {"tags": ["list", "go", "memory-leaks"], "answers": [{"tags": [], "owner": {"reputation": 1339, "user_id": 682485, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ea1e106f2d083f0624c0c4f48ae1c18b?s=128&d=identicon&r=PG", "display_name": "Malice", "link": "https://stackoverflow.com/users/682485/malice"}, "is_accepted": true, "score": 2, "last_activity_date": 1558324745, "creation_date": 1558324745, "answer_id": 56214142, "question_id": 56213432, "link": "https://stackoverflow.com/questions/56213432/why-the-list-remove-try-to-avoid-memory-leaks-explicitly/56214142#56214142", "title": "Why the `list.Remove()` try to avoid memory leaks explicitly?", "body": "<p>An element removed from a list cannot be pointing to <strong>other elements in the list</strong> after its removal. </p>\n\n<p>Consider the list <code>A -&gt; B -&gt; C -&gt; D</code> . And you remove the element <code>B</code> from the above list. Without the statement </p>\n\n<pre><code>e.next = nil\n</code></pre>\n\n<p>in the code snipped above, the memory layout will look like this. </p>\n\n<pre><code>\nA -&gt; C &gt; D\n     ^\n     |\n     B\n</code></pre>\n\n<p>Now if the element B is still in use(say element B is used till the end of the progarm), It has a pointer to C. This means that C cannot be garbage collected even if C is removed from list later and is not required for anymore. </p>\n\n<p>A similar case can occur for <code>e.prev</code></p>\n"}], "owner": {"reputation": 3, "user_id": 10168734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5uKGZ.jpg?s=128&g=1", "display_name": "jitianyu", "link": "https://stackoverflow.com/users/10168734/jitianyu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "closed_date": 1558335343, "accepted_answer_id": 56214142, "answer_count": 1, "score": -1, "last_activity_date": 1558332436, "creation_date": 1558316343, "last_edit_date": 1558332436, "question_id": 56213432, "link": "https://stackoverflow.com/questions/56213432/why-the-list-remove-try-to-avoid-memory-leaks-explicitly", "closed_reason": "Duplicate", "title": "Why the `list.Remove()` try to avoid memory leaks explicitly?", "body": "<p>The source code of container/list.Remove() tries to avoid memory leaks explicitly by assigning nil to specific variables, why should we do this? thanks! </p>\n\n<p>The code is in the golang source code of version 1.12.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// remove removes e from its list, decrements l.len, and returns e.\nfunc (l *List) remove(e *Element) *Element {\n    e.prev.next = e.next\n    e.next.prev = e.prev\n    e.next = nil // avoid memory leaks\n    e.prev = nil // avoid memory leaks\n    e.list = nil\n    l.len--\n    return e\n}\n</code></pre>\n\n<p>Can't GC handle this situation?</p>\n"}, {"tags": ["arrays", "go", "append", "slice"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1558285508, "post_id": 56210044, "comment_id": 99041375, "body": "There is no \u201cpass by reference\u201d, so I\u2019m not sure where you got that. You\u2019re simply passing the slice value, which which is a copy and not going to change the original."}, {"owner": {"reputation": 4173, "user_id": 1199408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5HJv7.jpg?s=128&g=1", "display_name": "georgeok", "link": "https://stackoverflow.com/users/1199408/georgeok"}, "edited": false, "score": 0, "creation_date": 1558358716, "post_id": 56210044, "comment_id": 99064295, "body": "When you pass a slice, Go passes a copy of the slice header. That explains why array[0] = &quot;1234&quot;. You can still access and alert the underlay array objects. On the other hand append creates a copy of the slice and the underlaying array and because the <code>myTest</code> function doesn&#39;t return it, you don&#39;t see the  changes in <code>main</code>. When I started looking at slices I found <a href=\"https://github.com/golang/go/wiki/SliceTricks\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/SliceTricks</a> very useful."}], "answers": [{"tags": [], "owner": {"reputation": 75, "user_id": 355077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/717fbb89559e5694f26ce3aad01ba819?s=128&d=identicon&r=PG", "display_name": "Philip Constantinou", "link": "https://stackoverflow.com/users/355077/philip-constantinou"}, "is_accepted": false, "score": 0, "last_activity_date": 1558320785, "creation_date": 1558320785, "answer_id": 56213781, "question_id": 56210044, "link": "https://stackoverflow.com/questions/56210044/passing-slice-as-a-reference-to-reflect-changes-in-caller/56213781#56213781", "title": "passing slice as a reference to reflect changes in caller", "body": "<p><code>append</code> works exactly as you think it does!</p>\n\n<p>As you can see in <a href=\"https://play.golang.org/p/fj2D6NLI_ag\" rel=\"nofollow noreferrer\">this playground</a>, the <code>append</code> function works as you're expecting if you don't pass the <code>allOutputs</code> array as a parameter to <code>myTest</code>.</p>\n\n<p>As you suspected, <code>append</code> <strong>may</strong> return a new array if the capacity of the original array is exceeded. In your example, the array size in <code>myTest</code> is <strong>not</strong> modified, however, it is a copy of <code>allOutputs</code> which remains unchanged. </p>\n\n<p>It's best to think of an array like a string. It's a mutable block of memory. When passed as a parameter, the whole block is copied.</p>\n\n<p>Your assumption that, because the array <code>allOutputs</code> is pre-allocated with 100 elements the call to <code>append</code> won't need to change <code>array</code>, is correct. </p>\n\n<p>If you'd written <em>this</em>, you would have seen the results you expected.</p>\n\n<pre><code>allOutputs := make([]string, 0, 100)\nallOutputs = append(allOutputs, \"abcd\")\nfmt.Println(allOutputs) // Println1\nallOutputs[0] = \"1234\"\nallOutputs = append(allOutputs, \"5678\")\nfmt.Println(allOutputs) // Println2\n</code></pre>\n\n<p>One nice solution to this is:</p>\n\n<pre><code>   type myStrings []string\n\n   func (m *mystring) myTest() {\n      // Do something\n   }\n</code></pre>\n\n<p>If you declare your own type, then you can define a method that can mutate the array without explicitly using the &amp; operator.</p>\n"}], "owner": {"reputation": 1, "user_id": 1892734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/998d9270c12032d0034d60f6c890c38c?s=128&d=identicon&r=PG", "display_name": "user1892734", "link": "https://stackoverflow.com/users/1892734/user1892734"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "closed_date": 1558339945, "answer_count": 1, "score": -3, "last_activity_date": 1558320785, "creation_date": 1558284798, "question_id": 56210044, "link": "https://stackoverflow.com/questions/56210044/passing-slice-as-a-reference-to-reflect-changes-in-caller", "closed_reason": "Duplicate", "title": "passing slice as a reference to reflect changes in caller", "body": "<p>main declares a slice with name <code>allOutputs</code> (i believe its a slice of strings, not an array of strings) with zero length and 100 capacity. Then it appends a string with value \"abcd\" and calls myTest function which updates the array[0] with \"1234\" and then does an append with value \"5678\".</p>\n\n<p>When i printed <code>allOutputs</code> after <code>myTest</code> call, i correctly see the element at the first index has an updated value of \"1234\". This tells me that myTest got slice as reference. But the later <code>append</code> of <code>\"5678\"</code> is not seen by the caller (main here) at all why its so? Remember the original slice is backed by an array with a capacity of 100. Why can't i see 5678 in main when the slice is passed by a reference?</p>\n\n<p>In other words, how exactly the append works?</p>\n\n<pre><code>import \"fmt\"\n\nfunc myTest(array []string) {\n    array[0] = \"1234\"\n    array = append(array, \"5678\")\n}\n\nfunc main() {\n    allOutputs := make([]string, 0, 100)\n    allOutputs = append(allOutput, \"abcd\")\n        fmt.Println(allOutputs) // Println1\n    myTest(allOutputs)\n    fmt.Println(allOutputs) // Println2\n}\n</code></pre>\n\n<p>ACTUAL OUTPUT:\n[1234]</p>\n\n<p>I EXPECTED:\n[1234, 5678]</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 8132739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e4f096f90bc7f0e8c4f64be166f336c?s=128&d=identicon&r=PG&f=1", "display_name": "Rivao", "link": "https://stackoverflow.com/users/8132739/rivao"}, "edited": false, "score": 0, "creation_date": 1558333452, "post_id": 56209940, "comment_id": 99051300, "body": "Oh my god... I had a feeling it was something very trivial I was missing. Thank you very much!"}], "tags": [], "owner": {"reputation": 1126, "user_id": 3508174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vfMCq.jpg?s=128&g=1", "display_name": "Sergey Narozhnyy", "link": "https://stackoverflow.com/users/3508174/sergey-narozhnyy"}, "is_accepted": true, "score": 4, "last_activity_date": 1558284159, "creation_date": 1558284159, "answer_id": 56209940, "question_id": 56209762, "link": "https://stackoverflow.com/questions/56209762/how-to-import-local-packages-when-using-go-modules/56209940#56209940", "title": "How to import local packages when using Go modules", "body": "<p>It should be like that (main.go):</p>\n\n<pre><code>package main\nimport (\n    \"exampleapp/example\"\n)\n\nfunc main() {\n    example.GetAllEmployees(...)\n}\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 8132739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e4f096f90bc7f0e8c4f64be166f336c?s=128&d=identicon&r=PG&f=1", "display_name": "Rivao", "link": "https://stackoverflow.com/users/8132739/rivao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1700, "favorite_count": 0, "accepted_answer_id": 56209940, "answer_count": 1, "score": 6, "last_activity_date": 1558284159, "creation_date": 1558283035, "question_id": 56209762, "link": "https://stackoverflow.com/questions/56209762/how-to-import-local-packages-when-using-go-modules", "title": "How to import local packages when using Go modules", "body": "<p>I wish to create a large project, so I need to create some kind of folder structure. I am quite new to Go, but, as I understand, the way to do it is to create packages, right? I am using Go modules, I have tried many different solutions found here and on Google, but none of them seem to work for me.</p>\n\n<p>All I want to for now, is import exported function from example.go file into main.go</p>\n\n<p>Folder structure is as follows:</p>\n\n<pre><code>client\nexample\n---example.go\ngo.mod\ngo.sum\nmain.go\n</code></pre>\n\n<ol>\n<li>I have created module file with go mod init, see the first code snippet below</li>\n<li>Second code snippet shows how the header of main.go looks like</li>\n<li>Third snippet is the package with the function I want to import</li>\n</ol>\n\n<pre><code>    module exampleapp\n    go 1.12\n    require (\n        github.com/gin-gonic/contrib v0.0.0-20190408155029-b5986969cb50\n        github.com/gin-gonic/gin v1.4.0\n    )\n\n</code></pre>\n\n<pre><code>package main\nimport (\n    \"net/http\"\n    \"exampleapp/example\"\n)\n</code></pre>\n\n<pre><code>    package example\n    import (\n        \"net/http\"\n        \"github.com/gin-gonic/gin\"\n    )\n\n    func GetAllEmployees(c *gin.Context) {\n        c.JSON(http.StatusOK, gin.H{\n            \"message\": \"pong\",\n        })\n    }\n</code></pre>\n\n<p>For the most part, when I try to add package in main.go, VSCode automatically removes the line and in the main function says that GetAllEmployees is not defined. I managed to catch error package before the package is removed, it says - <pre>\"imported and not used: \"exampleapp/example\"</pre>\nAm I wrong to use \"exampleapp/example\" module name exampleapp here? I tried without the exampleapp and \"./example/example\", but then I get an error that says it cannot find module for path.</p>\n\n<p>Help would be highly appreciated, as I have been stuck on this for quite some time and can't figure out, what am I missing here.</p>\n"}, {"tags": ["postgresql", "go", "go-gorm"], "comments": [{"owner": {"reputation": 1039, "user_id": 8294118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8cd5c198656aa0d0075eaadd22c0c316?s=128&d=identicon&r=PG&f=1", "display_name": "user666", "link": "https://stackoverflow.com/users/8294118/user666"}, "edited": false, "score": 0, "creation_date": 1594098667, "post_id": 56208644, "comment_id": 110999038, "body": "is there any way to do this?"}], "answers": [{"tags": [], "owner": {"reputation": 5734, "user_id": 415628, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/84d8280499418f22f42778cc40c20a12?s=128&d=identicon&r=PG", "display_name": "Ezequiel Muns", "link": "https://stackoverflow.com/users/415628/ezequiel-muns"}, "is_accepted": false, "score": 0, "last_activity_date": 1606835483, "creation_date": 1606835483, "answer_id": 65093137, "question_id": 56208644, "link": "https://stackoverflow.com/questions/56208644/how-do-define-read-replicas-in-gorm-postgresql/65093137#65093137", "title": "How do define read replicas in gorm postgresql", "body": "<p>Now that Gorm V2 is out you can use the <code>dbresolver</code> plugin just for this use case. Replicating what you gave as an example would look like:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>import (\n  &quot;gorm.io/gorm&quot;\n  &quot;gorm.io/plugin/dbresolver&quot;\n  &quot;gorm.io/driver/postgres&quot;\n)\n\ndb, err := gorm.Open(postgres.Open(&quot;host=localhost user=root&quot;), &amp;gorm.Config{})\n\ndb.Use(dbresolver.Register(dbresolver.Config{\n    Replicas: []gorm.Dialector{\n        postgres.Open(&quot;host=8.8.8.8 user=anotherusernamethanroot password=lolcats!&quot;), \n        postgres.Open(&quot;host=localhost user=root&quot;),\n    },\n    Policy: dbresolver.RandomPolicy{},\n})\n</code></pre>\n<p>Check out the documentation: <a href=\"https://gorm.io/docs/dbresolver.html\" rel=\"nofollow noreferrer\">https://gorm.io/docs/dbresolver.html</a></p>\n"}], "owner": {"reputation": 41, "user_id": 11524006, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LwD829oTYrc/AAAAAAAAAAI/AAAAAAAAAA0/tpy-ziKoRPw/photo.jpg?sz=128", "display_name": "Raghavendra Gautam", "link": "https://stackoverflow.com/users/11524006/raghavendra-gautam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 299, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1606835483, "creation_date": 1558275327, "last_edit_date": 1558430161, "question_id": 56208644, "link": "https://stackoverflow.com/questions/56208644/how-do-define-read-replicas-in-gorm-postgresql", "title": "How do define read replicas in gorm postgresql", "body": "<p>I am using golang in my application server and gorm as the ORM. I am using postgresql as the database in google cloud sql. </p>\n\n<p>I created a 2 read replica's for postgres which are being used by the application server. </p>\n\n<p>Previously, I used node.js and sequelize and there, I am able to define the read replicas as </p>\n\n<pre><code>    read: [\n      { host: '8.8.8.8', username: 'anotherusernamethanroot', password: 'lolcats!' },\n      { host: 'localhost', username: 'root', password: null }\n    ],\n    write: { host: 'localhost', username: 'root', password: null }\n  },\n</code></pre>\n\n<p>However for gorm, I dont see any way to do that(in the documentation). </p>\n\n<p>So, is there a way that I can define read replicas and gorm takes care of it.  If not, what is the best practice for this use case?</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-dynamodb"], "answers": [{"comments": [{"owner": {"reputation": 1031, "user_id": 10521506, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VFzDXDbprEk/AAAAAAAAAAI/AAAAAAAAG44/FgWgkq5p6O8/photo.jpg?sz=128", "display_name": "Reza Nasiri", "link": "https://stackoverflow.com/users/10521506/reza-nasiri"}, "reply_to_user": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "edited": false, "score": 0, "creation_date": 1558358376, "post_id": 56211615, "comment_id": 99064103, "body": "it comes down to your design. if you expect to have only one value per partition key, it doesn&#39;t make sense to have a sort key and removing the sort key will fix your issue. But if you want to have a history of status changes then you need to have OrderID and Status(without the timestamp) as your composite primary key and mange lates status using a method similar to <a href=\"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/bp-sort-keys.html\" rel=\"nofollow noreferrer\">this</a>"}], "tags": [], "owner": {"reputation": 1031, "user_id": 10521506, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VFzDXDbprEk/AAAAAAAAAAI/AAAAAAAAG44/FgWgkq5p6O8/photo.jpg?sz=128", "display_name": "Reza Nasiri", "link": "https://stackoverflow.com/users/10521506/reza-nasiri"}, "is_accepted": false, "score": 1, "last_activity_date": 1558296745, "creation_date": 1558296745, "answer_id": 56211615, "question_id": 56208145, "link": "https://stackoverflow.com/questions/56208145/replace-an-old-item-with-a-new-item-in-dynamodb/56211615#56211615", "title": "Replace an old item with a new item in DynamoDB", "body": "<p>when you have composite primary key(partition key + sort key) the combination of the two fields are unique and not the partition key.</p>\n"}, {"tags": [], "owner": {"reputation": 48529, "user_id": 63074, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e77511a13f8c53b87610e52b4b38aa43?s=128&d=identicon&r=PG", "display_name": "Mike Dinescu", "link": "https://stackoverflow.com/users/63074/mike-dinescu"}, "is_accepted": false, "score": 0, "last_activity_date": 1558328224, "creation_date": 1558328224, "answer_id": 56214528, "question_id": 56208145, "link": "https://stackoverflow.com/questions/56208145/replace-an-old-item-with-a-new-item-in-dynamodb/56214528#56214528", "title": "Replace an old item with a new item in DynamoDB", "body": "<p>It sounds like what you need to do is remove the sort key from the schema. That way, each item will be uniquely identified by partition key alone.</p>\n\n<p>There is no API available to replace all items that have a partition key so to implement the behavior you are describing you would have to do a query-delete-put transaction to actually replace the old item with the new unless you change the schema.</p>\n"}], "owner": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 427, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1558328224, "creation_date": 1558271451, "question_id": 56208145, "link": "https://stackoverflow.com/questions/56208145/replace-an-old-item-with-a-new-item-in-dynamodb", "title": "Replace an old item with a new item in DynamoDB", "body": "<p>I'm using <a href=\"https://godoc.org/github.com/aws/aws-sdk-go-v2/service/dynamodb#DynamoDB.PutItemRequest\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/aws/aws-sdk-go-v2/service/dynamodb#DynamoDB.PutItemRequest</a></p>\n\n<p>My function looks like:</p>\n\n<pre><code>  func (h dynamoHandler) save(selection DeliveryDate) (err error) {\n      av, err := dynamodbattribute.MarshalMap(selection)\n      if err != nil {\n          log.WithError(err).Error(\"failed to marshal selection\")\n          return\n      }\n\n      req := h.db.PutItemRequest(&amp;dynamodb.PutItemInput{\n          TableName: aws.String(h.Table),\n          Item:      av,\n      })\n      _, err = req.Send()\n\n      if err != nil {\n          log.WithField(\"table\", h.Table).WithError(err).Error(\"putting dynamodb\")\n          return\n      }\n      return\n  }\n</code></pre>\n\n<p>I was under the assumption that since the partition key \"wfr5a\" is the same, the newer \"chosen#2019-05-19T13:42:54+08:00\" (a composite and sort key) should have replaced the row.</p>\n\n<pre><code>\"OrderID (S)\",\"StatusDate (S)\",\"LastUpdated (S)\"\n\"wfr5a\",\"chosen#2019-05-19T13:42:54+08:00\",\"2019-05-19T13:49:34+08:00\"\n\"wfr5a\",\"proposal#2019-05-19T13:42:54+08:00\",\"2019-05-19T13:42:58+08:00\"\n</code></pre>\n\n<p>Though as you can see, it created a new item. What am I missing to so that it just replaces the record, i.e. has only one unique row for \"wfr5a\"</p>\n"}, {"tags": ["loops", "go", "snmp"], "comments": [{"owner": {"reputation": 1126, "user_id": 3508174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vfMCq.jpg?s=128&g=1", "display_name": "Sergey Narozhnyy", "link": "https://stackoverflow.com/users/3508174/sergey-narozhnyy"}, "edited": false, "score": 0, "creation_date": 1558286115, "post_id": 56207893, "comment_id": 99041595, "body": "Just change the log.Fatalf string param, like <code>log.Fatalf(&quot;Error read OID&quot;)</code>. Or if you need this error to be written in the std.Output, replace log.Fatalf to log.Printf"}, {"owner": {"reputation": 21, "user_id": 11485114, "user_type": "registered", "profile_image": "https://graph.facebook.com/295322834677923/picture?type=large", "display_name": "\u0421\u0435\u0440\u0433\u0435\u0439 \u0412\u043b\u0430\u0441\u043e\u0432", "link": "https://stackoverflow.com/users/11485114/%d0%a1%d0%b5%d1%80%d0%b3%d0%b5%d0%b9-%d0%92%d0%bb%d0%b0%d1%81%d0%be%d0%b2"}, "reply_to_user": {"reputation": 1126, "user_id": 3508174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vfMCq.jpg?s=128&g=1", "display_name": "Sergey Narozhnyy", "link": "https://stackoverflow.com/users/3508174/sergey-narozhnyy"}, "edited": false, "score": 0, "creation_date": 1558295240, "post_id": 56207893, "comment_id": 99044043, "body": "@Sergey Narozhnyy, ?   like this: \t                                                                                                                  if err != nil {         log.Prinf(&quot;ERROR&quot;)     }"}, {"owner": {"reputation": 1126, "user_id": 3508174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vfMCq.jpg?s=128&g=1", "display_name": "Sergey Narozhnyy", "link": "https://stackoverflow.com/users/3508174/sergey-narozhnyy"}, "edited": false, "score": 0, "creation_date": 1558296424, "post_id": 56207893, "comment_id": 99044354, "body": "Not exactly, see my answer"}], "answers": [{"tags": [], "owner": {"reputation": 1126, "user_id": 3508174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vfMCq.jpg?s=128&g=1", "display_name": "Sergey Narozhnyy", "link": "https://stackoverflow.com/users/3508174/sergey-narozhnyy"}, "is_accepted": false, "score": 0, "last_activity_date": 1558296415, "creation_date": 1558296415, "answer_id": 56211584, "question_id": 56207893, "link": "https://stackoverflow.com/questions/56207893/go-lang-snmp-in-lool-error-connection-processing/56211584#56211584", "title": "go lang + snmp in lool (error connection processing)", "body": "<p>You have unreachable code in lines where you've left comments.</p>\n\n<p>Just use correct string value for log.Fatalf:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>if err != nil {\n  log.Fatalf(\"Fail connection, error: %v\", err)\n}\n</code></pre>\n\n<p>or if you don't want to exit:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>if err != nil {\n  log.Printf(\"Fail connection, error: %v\", err)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1558791820, "post_id": 56299202, "comment_id": 99221367, "body": "Please do not write comments in answers. Take <a href=\"https://stackoverflow.com/tour\">Tour</a> again if you need a refresher on how SO works. Thanks"}], "tags": [], "owner": {"reputation": 41, "user_id": 11171720, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-st4ZkxmMJ0U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3retm4sDJbfueXEVV-wwPkyBUXrPRg/mo/photo.jpg?sz=128", "display_name": "\u0421\u0435\u0440\u0433\u0435\u0439 \u0412\u043b\u0430\u0441\u043e\u0432", "link": "https://stackoverflow.com/users/11171720/%d0%a1%d0%b5%d1%80%d0%b3%d0%b5%d0%b9-%d0%92%d0%bb%d0%b0%d1%81%d0%be%d0%b2"}, "is_accepted": false, "score": -1, "last_activity_date": 1558729807, "creation_date": 1558729807, "answer_id": 56299202, "question_id": 56207893, "link": "https://stackoverflow.com/questions/56207893/go-lang-snmp-in-lool-error-connection-processing/56299202#56299202", "title": "go lang + snmp in lool (error connection processing)", "body": "<p>@Sergey Narozhnyy@ thanks! And the big mistake is block with processing of \"result.Variables\". There is no \"result\" if i don't have the connection</p>\n"}], "owner": {"reputation": 21, "user_id": 11485114, "user_type": "registered", "profile_image": "https://graph.facebook.com/295322834677923/picture?type=large", "display_name": "\u0421\u0435\u0440\u0433\u0435\u0439 \u0412\u043b\u0430\u0441\u043e\u0432", "link": "https://stackoverflow.com/users/11485114/%d0%a1%d0%b5%d1%80%d0%b3%d0%b5%d0%b9-%d0%92%d0%bb%d0%b0%d1%81%d0%be%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1558729807, "creation_date": 1558269353, "last_edit_date": 1558295078, "question_id": 56207893, "link": "https://stackoverflow.com/questions/56207893/go-lang-snmp-in-lool-error-connection-processing", "title": "go lang + snmp in lool (error connection processing)", "body": "<p>I do a server on golnag and I need to do a SNMP command to many devices, some of this devices could not have connections( or lost it temporary)\nAnd I want message \" no connection\" or \"Error\"  and next continue the runing of programm</p>\n\n<p>Ubuntu 18.04 // go 1.8 // go SNMP from <a href=\"https://github.com/soniah/gosnmp\" rel=\"nofollow noreferrer\">https://github.com/soniah/gosnmp</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"time\"\n    g \"github.com/soniah/gosnmp\"\n)\n\nfunc main() {\n    g.Default.Target = string(\"192.168.10.1\")\n    err := g.Default.Connect()\n    if err != nil {\n        log.Fatalf(\"Connect() err: %v\", err)\n        fmt.Println(\"Fail connection\") // want this message in this case  !!!!!\n    }\n    defer g.Default.Conn.Close()\n\n    oids := []string{\"1.3.6.1.2.1.1.4.0\", \"1.3.6.1.2.1.1.7.0\"} \n    result, err2 := g.Default.Get(oids)  \n    if err2 != nil {\n        log.Fatalf(\"Get() err: %v\", err2)\n        fmt.Println(\"Error read OID\") // want this message in this case !!!!!\n    }\n\n    for i, variable := range result.Variables {\n        fmt.Printf(\"%d: oid: %s \", i, variable.Name)\n\n        switch variable.Type {\n        case g.OctetString:\n            fmt.Printf(\"string: %s\\n\", string(variable.Value.([]byte)))\n        default:\n            fmt.Printf(\"number: %d\\n\", g.ToBigInt(variable.Value))\n        }\n    }\n}\n</code></pre>\n\n<p>I receive this result if no connection, and break the runing of pogramm</p>\n\n<pre><code>2019/05/19 15:11:33 Get() err: Request timeout (after 3 retries)\nexit status 1\n</code></pre>\n\n<p>I want something like this</p>\n\n<pre><code>\"Fail connection\"   or  \"Error read OID\"\n</code></pre>\n\n<p>And next, I want to continue the runing of programm</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1765, "user_id": 3823826, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/19add980b878cac93905e623ad5f6646?s=128&d=identicon&r=PG", "display_name": "Csongor Halmai", "link": "https://stackoverflow.com/users/3823826/csongor-halmai"}, "is_accepted": false, "score": 3, "last_activity_date": 1558258764, "creation_date": 1558258764, "answer_id": 56206563, "question_id": 56206562, "link": "https://stackoverflow.com/questions/56206562/why-gofmt-d-gives-computing-diff-exec-diff-executable-file-not-found-in/56206563#56206563", "title": "Why &quot;gofmt -d&quot; gives &quot;computing diff: exec: &quot;diff&quot;: executable file not found in %PATH%&quot; error on windows?", "body": "<p>The <code>gofmt</code> tool assumes the system has an installed and available <code>diff</code>. Unfortunately, this tool is not part of a standard Windows installation so you need to add it manually. </p>\n\n<p>For most of us, the easiest way to add the path of the <code>diff</code> tool we already have on our computer. This is the one that has been installed as part of <code>git</code>. (If <code>git</code> hasn't been installed yet then do it at first.) </p>\n\n<p>In order to solve this, you should issue a command from the DOS prompt in which you want to execute <code>gofmt</code>:</p>\n\n<pre><code>set PATH=%PATH%;c:\\Program Files\\Git\\usr\\bin\n</code></pre>\n\n<p>(Maybe you need to change the path according to your <code>git</code> installation.)</p>\n\n<p>For a more permanent solution, you should add the path of <code>diff.exe</code> to the PATH environment variable via the Control Panel.</p>\n"}], "owner": {"reputation": 1765, "user_id": 3823826, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/19add980b878cac93905e623ad5f6646?s=128&d=identicon&r=PG", "display_name": "Csongor Halmai", "link": "https://stackoverflow.com/users/3823826/csongor-halmai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1035, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1558258764, "creation_date": 1558258764, "question_id": 56206562, "link": "https://stackoverflow.com/questions/56206562/why-gofmt-d-gives-computing-diff-exec-diff-executable-file-not-found-in", "title": "Why &quot;gofmt -d&quot; gives &quot;computing diff: exec: &quot;diff&quot;: executable file not found in %PATH%&quot; error on windows?", "body": "<p>I would like to see what mistakes I made in my golang files. In order to figure it out, I issue a command like this:</p>\n\n<pre><code>gofmt -d myfile.go\n</code></pre>\n\n<p>According to the <code>gofmt --help</code> manual, it is supposed to list the diff of the current and the desired versions of the file. Instead of this, it produces this error message:</p>\n\n<pre><code>computing diff: exec: \"diff\": executable file not found in %PATH%\n</code></pre>\n\n<p>How could this be fixed?</p>\n"}, {"tags": ["postgresql", "go", "mux"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1558256567, "post_id": 56205983, "comment_id": 99034199, "body": "<code>Config.data</code> is a pointer. So you deserialise to the same place and then add the same value multiple times in a slice. Why did you declare it as a pointer at all?"}, {"owner": {"reputation": 131, "user_id": 11388065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b75f913ff3951b68cbf81b36ff218be4?s=128&d=identicon&r=PG&f=1", "display_name": "learner", "link": "https://stackoverflow.com/users/11388065/learner"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1558257359, "post_id": 56205983, "comment_id": 99034388, "body": "That was the mistake. I fixed this issue by replacing <code>Data *Data</code> with <code>Data Data</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1339, "user_id": 682485, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ea1e106f2d083f0624c0c4f48ae1c18b?s=128&d=identicon&r=PG", "display_name": "Malice", "link": "https://stackoverflow.com/users/682485/malice"}, "edited": false, "score": 0, "creation_date": 1558327525, "post_id": 56206373, "comment_id": 99049649, "body": "Another way is to move <code>var c Config</code> to inside the loop <code>for rows.Next()</code>"}], "tags": [], "owner": {"reputation": 131, "user_id": 11388065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b75f913ff3951b68cbf81b36ff218be4?s=128&d=identicon&r=PG&f=1", "display_name": "learner", "link": "https://stackoverflow.com/users/11388065/learner"}, "is_accepted": false, "score": 2, "last_activity_date": 1558257395, "creation_date": 1558257395, "answer_id": 56206373, "question_id": 56205983, "link": "https://stackoverflow.com/questions/56205983/api-returns-only-last-row-for-a-nested-struct/56206373#56206373", "title": "API returns only last row for a nested struct", "body": "<p>I fixed this by replacing <code>Data *Data</code> with <code>Data Data</code>. The problem was When <code>json.Unmarshal</code> fills <code>c.Data</code> it sees that there is already a struct in it and overwrites it.</p>\n"}], "owner": {"reputation": 131, "user_id": 11388065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b75f913ff3951b68cbf81b36ff218be4?s=128&d=identicon&r=PG&f=1", "display_name": "learner", "link": "https://stackoverflow.com/users/11388065/learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1558257395, "creation_date": 1558253969, "question_id": 56205983, "link": "https://stackoverflow.com/questions/56205983/api-returns-only-last-row-for-a-nested-struct", "title": "API returns only last row for a nested struct", "body": "<p>I have built a Golang REST API. Other HTTP verbs works well except the <code>GET</code> that fetches everything from the database.</p>\n\n<p>I have a nested struct for the model as shown below:</p>\n\n<pre><code>type Config struct {\n    ID   int    `json:\"id\"`\n    Name string `json:\"name,omitempty\"`\n    Data *Data  `json:\"data,omitempty\"`\n}\n\ntype Data struct {\n    Host     string `json:\"host,omitempty\"`\n    Database string `json:\"database,omitempty\"`\n    Password string `json:\"password,omitempty\"`\n    Username string `json:\"username,omitempty\"`\n    Engine   string `json:\"engine,omitempty\"`\n}\n</code></pre>\n\n<p>I do JSON unmarshal against the Data. See the code below:</p>\n\n<p>model.go</p>\n\n<pre><code>func List(db *sql.DB, start, count int) ([]Config, error) {\n    var dt string\n    var c Config\n    rows, err := db.Query(\n        \"SELECT * FROM configs LIMIT $1 OFFSET $2\",\n        count, start)\n\n    if err != nil {\n        return nil, err\n    }\n\n    defer rows.Close()\n\n    configs := []Config{}\n\n    for rows.Next() {\n        //var c Config\n        if err := rows.Scan(&amp;c.ID, &amp;c.Name, &amp;dt); err != nil {\n            return nil, err\n        }\n        json.Unmarshal([]byte(dt), &amp;c.Data)\n        // for _, p := range c.Data {\n        //  configs = append(configs, c)\n        // }\n        configs = append(configs, c)\n    }\n\n    return configs, nil\n}\n</code></pre>\n\n<p>controller.go</p>\n\n<pre><code>func (a *App) getConfigs(w http.ResponseWriter, r *http.Request) {\n    count, _ := strconv.Atoi(r.FormValue(\"count\"))\n    start, _ := strconv.Atoi(r.FormValue(\"start\"))\n\n    if count &gt; 10 || count &lt; 1 {\n        count = 10\n    }\n    if start &lt; 0 {\n        start = 0\n    }\n\n    configs, err := List(a.DB, start, count)\n    fmt.Print(configs)\n\n    if err != nil {\n        fatalError(w, http.StatusInternalServerError, err.Error())\n        return\n    }\n\n    jsonResponse(w, http.StatusOK, configs)\n}\n</code></pre>\n\n<p>When I hit the get endpoint, I get the following:</p>\n\n<pre><code>[\n    {\n        \"id\": 2,\n        \"name\": \"test2\",\n        \"data\": {\n            \"host\": \"newhosty\",\n            \"database\": \"locau\",\n            \"password\": \"poy\",\n            \"username\": \"psq\",\n            \"engine\": \"dgnewy\"\n        }\n    },\n    {\n        \"id\": 3,\n        \"name\": \"test3\",\n        \"data\": {\n            \"host\": \"newhosty\",\n            \"database\": \"locau\",\n            \"password\": \"poy\",\n            \"username\": \"psq\",\n            \"engine\": \"dgnewy\"\n        }\n    },\n    {\n        \"id\": 4,\n        \"name\": \"test39\",\n        \"data\": {\n            \"host\": \"newhosty\",\n            \"database\": \"locau\",\n            \"password\": \"poy\",\n            \"username\": \"psq\",\n            \"engine\": \"dgnewy\"\n        }\n    }\n]\n</code></pre>\n\n<p>As you can see, the <code>data</code> part of the json is duplicated for all the <code>id</code>. Only <code>name</code> and <code>id</code> work as expected. I expected each data to be different as it is in the db. Looks like it only picks the last row for the data part.</p>\n\n<p>Anything I'm doing wrong?</p>\n"}, {"tags": ["qt", "go", "qthread", "qobject"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 9534774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32e59256b615a9f41c1d0b919ed2924b?s=128&d=identicon&r=PG&f=1", "display_name": "BeoBeo", "link": "https://stackoverflow.com/users/9534774/beobeo"}, "is_accepted": false, "score": 0, "last_activity_date": 1558251090, "creation_date": 1558251090, "answer_id": 56205667, "question_id": 56205000, "link": "https://stackoverflow.com/questions/56205000/qthread-emit-only-one-signal-in-golang/56205667#56205667", "title": "Qthread emit only one signal in Golang", "body": "<p>I solved my problem. This is my solution</p>\n\n<pre><code>func InitWorkPool() *WorkPool {\n    wp := NewWorkPool() // Not return &amp;WorkPool{}\n    return wp\n}\n</code></pre>\n\n<p>By the way, you use <code>go routines</code> as well to replace <code>Qthread</code> in Go.</p>\n\n<p>Example source: <a href=\"https://github.com/therecipe/qt/issues/567#issuecomment-374654006\" rel=\"nofollow noreferrer\">https://github.com/therecipe/qt/issues/567#issuecomment-374654006</a></p>\n"}], "owner": {"reputation": 21, "user_id": 9534774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32e59256b615a9f41c1d0b919ed2924b?s=128&d=identicon&r=PG&f=1", "display_name": "BeoBeo", "link": "https://stackoverflow.com/users/9534774/beobeo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1558251090, "creation_date": 1558243504, "last_edit_date": 1558246905, "question_id": 56205000, "link": "https://stackoverflow.com/questions/56205000/qthread-emit-only-one-signal-in-golang", "title": "Qthread emit only one signal in Golang", "body": "<p>I'm working on program with use Golang and Qt. I have a problem with Qthread for a heavy task.</p>\n\n<p>This is my code:</p>\n\n<p><strong>MainUi.go</strong></p>\n\n<pre><code>// Start new thread first\nworkThread := core.NewQThread(nil)\nworkThread.Start()\n\n// Start a worker\nwkr := worker.InitWorkPool()\nwkr.MoveToThread(workThread)\nwkr.ConnectReportOne(func(v0 int, v1 int) {\n\n    // I put this code here to check is it called but not see anything\n    fmt.Println(\"Report One\") \n\n    label1.SetText(strconv.Itoa(v0))\n    label2.SetText(strconv.Itoa(v1))\n}\nwkr.ConnectReportTwo(func(v0 int, v1 int, v2 int) {\n    label3.SetText(strconv.Itoa(v0))\n    label4.SetText(strconv.Itoa(v1))\n    label5.SetText(strconv.Itoa(v2))\n\n}\nwkr.ConnectFinished(func() {\n    widgets.QMessageBox_Information(nil, \"Finished\", \"Task finished\", widgets.QMessageBox__Ok, widgets.QMessageBox__Ok)\n}\nwkr.Run()\n</code></pre>\n\n<p><strong>Worker.go</strong></p>\n\n<pre><code>type WorkPool struct {\n    core.QObject\n    _ func(int, int) `signal:\"reportOne\"`\n    _ func() `signal:\"finished\"`\n    _ func(int, int, int) `signal:\"reportTwo\"`\n}\n\nfunc InitWorkPool() *WorkPool {\n    return &amp;WorkPool{}\n}\n\nfunc (wp *WorkPool) Run() {\n    wp.ReportOne(11, 12) // This func not work\n    wp.ReportTwo(21, 22, 23) // This func not work\n\n    /* Do some stuff */\n\n    wp.Finished() //This func work\n}\n</code></pre>\n\n<p>I ran <code>qtmoc</code> to generation some addition code.</p>\n\n<p>A function <code>wp.Finished()</code> work if I call it first or via another function like <code>StopTask()</code>. But <code>wp.ReportOne()</code> and <code>wp.ReportTwo()</code> not work and freeze <code>MainUi</code>.</p>\n\n<p>Anyone can tell me what wrong in my code. It took me 2 days. </p>\n\n<p>Thanks for reading.</p>\n"}, {"tags": ["go", "cryptography", "pgp", "openpgp"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1558224160, "post_id": 56203206, "comment_id": 99029741, "body": "I figured out that the function <a href=\"https://github.com/jchavannes/go-pgp/blob/master/pgp/entity.go#L27\" rel=\"nofollow noreferrer\">createEntityFromKeys</a> needs to be written to read all packets available within the public/private key armor <a href=\"https://github.com/jchavannes/go-pgp/blob/master/pgp/key.go#L22\" rel=\"nofollow noreferrer\">block body</a>. Using the packetReader i should find a <a href=\"https://godoc.org/golang.org/x/crypo/openpgp/packet#UserId\" rel=\"nofollow noreferrer\">UserID packet</a> <a href=\"https://tools.ietf.org/html/rfc4880#section-5.11\" rel=\"nofollow noreferrer\">see also rfc</a> There is more to figure out because some packet.Signature attached to the identity are to be identified and set appropriately too."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1558224426, "post_id": 56203206, "comment_id": 99029768, "body": "see also <a href=\"https://davesteele.github.io/gpg/2014/09/20/anatomy-of-a-gpg-key/\" rel=\"nofollow noreferrer\">davesteele.github.io/gpg/2014/09/20/anatomy-of-a-gpg-key</a>"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1558263597, "post_id": 56203206, "comment_id": 99035807, "body": "The difficulty is now to find how to reassemble the packets of userids ans signatures correctly. <a href=\"https://github.com/jchavannes/go-pgp/blob/master/pgp/entity.go#L50\" rel=\"nofollow noreferrer\">reading the source code</a> it is not clear how the selfsignature packet can be identified and linked to the userid packet. Same for the subkey, im unclear about the how&amp;why. UserID&#39;s packets can easily be retrieved and inserted into the entity instance being constructed, but the final result is probably unsafe for advanced usage."}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1558273363, "post_id": 56203206, "comment_id": 99038103, "body": "The library must require that information <i>somewhere</i> in the process, right? Possibly download and search the source code?"}], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 227, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1558271924, "creation_date": 1558217256, "last_edit_date": 1558271924, "question_id": 56203206, "link": "https://stackoverflow.com/questions/56203206/read-entity-from-public-private-armored-key", "title": "read entity from public/private armored key", "body": "<p>Is it possible to read entity details like name/comment and email from a given armored private / public key using golang openpgp package ?</p>\n\n<p>The following code implements a test that generate a new armored key pair, it then tries to get entity details from it.</p>\n\n<p>However the resulting entity does not contain any identity information.</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"testing\"\n\n    \"github.com/jchavannes/go-pgp/pgp\"\n    \"golang.org/x/crypto/openpgp\"\n)\n\nfunc TestID(t *testing.T) {\n    keypair, err := pgp.GenerateKeyPair(\"test\", \"tst comment\", \"test@email.com\")\n    if err != nil {\n        t.Fatalf(\"failed to generate keypair: %s\", err)\n    }\n    var entity *openpgp.Entity\n    entity, err = pgp.GetEntity([]byte(keypair.PublicKey), []byte(keypair.PrivateKey))\n    if err != nil {\n        t.Fatalf(\"failed to read entity: %s\", err)\n    }\n    log.Printf(\"%#v\\n\", entity.Identities)\n}\n</code></pre>\n\n<p>outputs</p>\n\n<pre><code>2019/05/19 00:02:54 map[string]*openpgp.Identity{\"\":(*openpgp.Identity)(0xc00006edc0)}\n</code></pre>\n\n<p>It was expected that <code>entity.Identities</code> contains <code>test (tst comment) &lt;test@email.com&gt;</code>.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1192, "user_id": 1213186, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d9eabf15c471c4eb5158034e943711ce?s=128&d=identicon&r=PG", "display_name": "ddibiase", "link": "https://stackoverflow.com/users/1213186/ddibiase"}, "edited": false, "score": 0, "creation_date": 1558271665, "post_id": 56207801, "comment_id": 99037675, "body": "So you&#39;re saying that I need to fork the repo, use the replace command to rename it, to ensure that the go.mod file exists when the package is imported?"}, {"owner": {"reputation": 2647, "user_id": 4628962, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/avtRP.png?s=128&g=1", "display_name": "Abdullah Al Maruf - Tuhin", "link": "https://stackoverflow.com/users/4628962/abdullah-al-maruf-tuhin"}, "reply_to_user": {"reputation": 1192, "user_id": 1213186, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d9eabf15c471c4eb5158034e943711ce?s=128&d=identicon&r=PG", "display_name": "ddibiase", "link": "https://stackoverflow.com/users/1213186/ddibiase"}, "edited": false, "score": 0, "creation_date": 1558271887, "post_id": 56207801, "comment_id": 99037732, "body": "@ddibiase, I have updated my answer. It looks like, <code>replace</code> can be used for local disk&#39;s path too. It&#39;s good for debugging, but for idiomatic way, github fork is more preferred."}, {"owner": {"reputation": 1192, "user_id": 1213186, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d9eabf15c471c4eb5158034e943711ce?s=128&d=identicon&r=PG", "display_name": "ddibiase", "link": "https://stackoverflow.com/users/1213186/ddibiase"}, "edited": false, "score": 0, "creation_date": 1558273124, "post_id": 56207801, "comment_id": 99038048, "body": "Thanks for clarifying, I&#39;d prefer to use the github method and stay idiomatic. I just created my fork and inserted the go.mod file <a href=\"https://github.com/ddibiase/v8/blob/master/go.mod\" rel=\"nofollow noreferrer\">github.com/ddibiase/v8/blob/master/go.mod</a> however I&#39;m getting this strange error go: github.com/ddibiase/v8@v8.0.0-20190519133706-5d6c14c5de84: parsing go.mod: go.mod:3: invalid module: github.com/augustoroman/v8 should be /v8, not v0 (v0.0.0)"}, {"owner": {"reputation": 2647, "user_id": 4628962, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/avtRP.png?s=128&g=1", "display_name": "Abdullah Al Maruf - Tuhin", "link": "https://stackoverflow.com/users/4628962/abdullah-al-maruf-tuhin"}, "reply_to_user": {"reputation": 1192, "user_id": 1213186, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d9eabf15c471c4eb5158034e943711ce?s=128&d=identicon&r=PG", "display_name": "ddibiase", "link": "https://stackoverflow.com/users/1213186/ddibiase"}, "edited": false, "score": 0, "creation_date": 1558274170, "post_id": 56207801, "comment_id": 99038289, "body": "I guess, the problem is, you need to use <code>replace</code> where this package/module is used. Not on this package itself.For, example, If you are using <code>augustoroman&#47;v8</code> in <code>B</code> package/repo then use replace in go.mod file of <code>B</code> repo."}, {"owner": {"reputation": 1192, "user_id": 1213186, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d9eabf15c471c4eb5158034e943711ce?s=128&d=identicon&r=PG", "display_name": "ddibiase", "link": "https://stackoverflow.com/users/1213186/ddibiase"}, "edited": false, "score": 0, "creation_date": 1558278382, "post_id": 56207801, "comment_id": 99039386, "body": "Now I&#39;m super confused. I thought the idea was to fork and declare the mod so that when another module consumes the mod it knows how to replace the dependency paths?"}, {"owner": {"reputation": 2647, "user_id": 4628962, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/avtRP.png?s=128&g=1", "display_name": "Abdullah Al Maruf - Tuhin", "link": "https://stackoverflow.com/users/4628962/abdullah-al-maruf-tuhin"}, "reply_to_user": {"reputation": 1192, "user_id": 1213186, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d9eabf15c471c4eb5158034e943711ce?s=128&d=identicon&r=PG", "display_name": "ddibiase", "link": "https://stackoverflow.com/users/1213186/ddibiase"}, "edited": false, "score": 0, "creation_date": 1558287513, "post_id": 56207801, "comment_id": 99042010, "body": "No. The fork repo doesn&#39;t need to change anything. It&#39;s not confusing. Think this way, how would other repos know which github repo to use? So, the idea is, generally it will hit the actual github import path, but if you want to use another fork instead of the actual path, you need to add replace in mod file of that project. So, while compiling, it will know where to look. It all makes sense!! :)"}, {"owner": {"reputation": 1192, "user_id": 1213186, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d9eabf15c471c4eb5158034e943711ce?s=128&d=identicon&r=PG", "display_name": "ddibiase", "link": "https://stackoverflow.com/users/1213186/ddibiase"}, "edited": false, "score": 0, "creation_date": 1559668875, "post_id": 56207801, "comment_id": 99490637, "body": "Tahin unfortunately not yet."}], "tags": [], "owner": {"reputation": 2647, "user_id": 4628962, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/avtRP.png?s=128&g=1", "display_name": "Abdullah Al Maruf - Tuhin", "link": "https://stackoverflow.com/users/4628962/abdullah-al-maruf-tuhin"}, "is_accepted": false, "score": 0, "last_activity_date": 1558287944, "last_edit_date": 1558287944, "creation_date": 1558268791, "answer_id": 56207801, "question_id": 56203017, "link": "https://stackoverflow.com/questions/56203017/trouble-installing-augustoroman-v8-with-go111module-on/56207801#56207801", "title": "Trouble installing augustoroman/v8 with GO111MODULE=on", "body": "<p>When <code>GO111MODULE=on</code> is set, Go doesn't use <code>GOPATH/src</code> packages, rather, <strong>it uses <code>$GOPATH/pkg/mod</code>.</strong> (ref, <a href=\"https://blog.golang.org/using-go-modules\" rel=\"nofollow noreferrer\">official blog</a>)</p>\n\n<p>So, Installing changed package in <code>$GOPATH/src/github.com/augustoroman/v8</code> won't work.</p>\n\n<p>As a workaround, you can use <strong><a href=\"https://github.com/golang/go/wiki/Modules#when-should-i-use-the-replace-directive\" rel=\"nofollow noreferrer\"><code>replace</code></a></strong> directive in <code>go.mod</code> file where this modified package is needed. </p>\n\n<p>For, example, If you are using <code>github.com/augustoroman/v8</code> in <code>example.com/me/hello</code>  project, then use <code>replace</code> in <code>go.mod</code> file of <code>example.com/me/hello</code>. </p>\n\n<p>It can be any of absolute or relative on-disk location, </p>\n\n<pre><code>module example.com/me/hello\n\nrequire (\n  github.com/me/some-repo v0.0.0\n)\n\nreplace (\n    github.com/augustoroman/v8 =&gt; /absolute/gopath/src/github.com/augustoroman/v8\n)\n</code></pre>\n\n<p>or, even better (more idiomatic!), your fork repository in github.</p>\n\n<pre><code>module example.com/me/hello\n\nrequire (\n  github.com/me/some-repo v0.0.0\n)\n\nreplace (\n    github.com/augustoroman/v8 =&gt; github.com/me/v8\n)\n</code></pre>\n"}], "owner": {"reputation": 1192, "user_id": 1213186, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d9eabf15c471c4eb5158034e943711ce?s=128&d=identicon&r=PG", "display_name": "ddibiase", "link": "https://stackoverflow.com/users/1213186/ddibiase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558287944, "creation_date": 1558215290, "question_id": 56203017, "link": "https://stackoverflow.com/questions/56203017/trouble-installing-augustoroman-v8-with-go111module-on", "title": "Trouble installing augustoroman/v8 with GO111MODULE=on", "body": "<p>I was able to go through the whole process of setting up and installing github.com/augustoroman/v8 -- I built it's V8 dependency manually. When I run <code>go test</code> I get the following result:</p>\n\n<pre><code>PASS\nok      github.com/augustoroman/v8  9.433s\n</code></pre>\n\n<p>I installed the package at <code>$GOPATH/src/github.com/augustoroman/v8</code>. Everything seems to work well on OS X so far. However when I attempt importing with <code>import \"github.com/augustoroman/v8\"</code> in my own separate project I get a complaint.</p>\n\n<p>Remembering back I realized that I have <code>GO111MODULE=on</code> enabled. This prompted me to add a go.mod with the following in the root of the v8 folder:</p>\n\n<pre><code>module github.com/augustoroman/v8\ngo 1.12\n</code></pre>\n\n<p>When I attempt running I get another error:</p>\n\n<pre><code>go: finding github.com/augustoroman/v8 latest\ngo: downloading github.com/augustoroman/v8 v8.0.0-20190418063024-4b66934a28a7\nmain.go:3:8: unknown import path \"github.com/augustoroman/v8\": cannot find module providing package github.com/augustoroman/v8\n</code></pre>\n\n<p>Basically it seems that the package works accordingly however either the GO111MODULE setting is messing it up or I've installed the package at an incorrect location. Tbh the GO111MODULE settings are doubly confusing on top of Go's already rigid setup/structure.</p>\n\n<p>Any suggestions on how to debug this issue?</p>\n"}, {"tags": ["python", "go", "visual-studio-code"], "comments": [{"owner": {"reputation": 109, "user_id": 11348456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588c8a077b6e250cc7f7502cd35bc838?s=128&d=identicon&r=PG&f=1", "display_name": "wcosta", "link": "https://stackoverflow.com/users/11348456/wcosta"}, "edited": false, "score": 0, "creation_date": 1558210809, "post_id": 56201905, "comment_id": 99027663, "body": "When you try this with Python, what&#39;s your code and its output?"}, {"owner": {"reputation": 2647, "user_id": 4628962, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/avtRP.png?s=128&g=1", "display_name": "Abdullah Al Maruf - Tuhin", "link": "https://stackoverflow.com/users/4628962/abdullah-al-maruf-tuhin"}, "edited": false, "score": 0, "creation_date": 1558294204, "post_id": 56201905, "comment_id": 99043767, "body": "can you reference the extension you are referring?"}], "answers": [{"comments": [{"owner": {"reputation": 2647, "user_id": 4628962, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/avtRP.png?s=128&g=1", "display_name": "Abdullah Al Maruf - Tuhin", "link": "https://stackoverflow.com/users/4628962/abdullah-al-maruf-tuhin"}, "edited": false, "score": 0, "creation_date": 1558338888, "post_id": 56213602, "comment_id": 99053598, "body": "But, what&#39;s wrong with running <code>go run</code>? is his <code>output</code> is being treated as <code>stderr</code> pipe? also, it is happening for all language, not only go!"}], "tags": [], "owner": {"reputation": 522, "user_id": 1391008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e03f3a6314e7ed2bd34b7200d48742d2?s=128&d=identicon&r=PG", "display_name": "Moch Lutfi", "link": "https://stackoverflow.com/users/1391008/moch-lutfi"}, "is_accepted": false, "score": 0, "last_activity_date": 1558318420, "creation_date": 1558318420, "answer_id": 56213602, "question_id": 56201905, "link": "https://stackoverflow.com/questions/56201905/cant-see-output-only-in-terminal/56213602#56213602", "title": "Can&#39;t see output, only in terminal", "body": "<p>For <code>output</code> tab only execute <code>go test</code> without verbose command. you must be add <code>-v</code> argument to <code>go test</code> config. </p>\n\n<p>Add this to settings.json on VSCODE</p>\n\n<pre><code>\"go.testFlags\": [\"-v\"],\n</code></pre>\n"}], "owner": {"reputation": 549, "user_id": 8840464, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/6c30bc0d6e421b360c0b7019065ebbca?s=128&d=identicon&r=PG", "display_name": "Smithnson", "link": "https://stackoverflow.com/users/8840464/smithnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 383, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1558342134, "creation_date": 1558205111, "last_edit_date": 1558342134, "question_id": 56201905, "link": "https://stackoverflow.com/questions/56201905/cant-see-output-only-in-terminal", "title": "Can&#39;t see output, only in terminal", "body": "<p>I'm trying to write some Go code in VScode.</p>\n\n<p>I have the Code Runner (v. 0.9.9) and Go (v 0.10.2) extensions. </p>\n\n<p>I tried to run the following:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(\"Hello, World!\")\n\n}\n</code></pre>\n\n<p>In the <code>output</code> tab I got:</p>\n\n<pre><code>[Running] go run \"/home/joe/code/test.go\"\n\n[Done] exited with code=0 in 0.236 seconds\n</code></pre>\n\n<p>Which does not include the output of the Println statement. While if I run it from terminal (from VScode even), I get:</p>\n\n<pre><code>joe@HP-Laptop-15-bs0xx:~/code$ go run test.go\nHello, World!\n</code></pre>\n\n<p>This, by the way, repeats itself with other languages I've tried as well (like Python).</p>\n\n<p>How can I fix this so I can get the actual output to the output tab? </p>\n"}, {"tags": ["string", "go"], "answers": [{"comments": [{"owner": {"reputation": 620, "user_id": 1078027, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/32ca0886c7e7f19b1edfcf90cb13c700?s=128&d=identicon&r=PG", "display_name": "boreq", "link": "https://stackoverflow.com/users/1078027/boreq"}, "edited": false, "score": 0, "creation_date": 1558199508, "post_id": 56201143, "comment_id": 99025155, "body": "Remember to check if the character exists in the string at all. Additionally a dot can also occur in directory names so if you are checking a path and not a filename this code should be adjusted."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1558215797, "post_id": 56201143, "comment_id": 99028614, "body": "this will <code>panic</code> your program with files without a dot: <a href=\"https://play.golang.org/p/EZit4VT16OU\" rel=\"nofollow noreferrer\">play.golang.org/p/EZit4VT16OU</a>"}], "tags": [], "owner": {"reputation": 1580, "user_id": 5010028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02c50dc258cbc30aff9124c5c35ca3c0?s=128&d=identicon&r=PG&f=1", "display_name": "Shubham Srivastava", "link": "https://stackoverflow.com/users/5010028/shubham-srivastava"}, "is_accepted": true, "score": 0, "last_activity_date": 1558230898, "last_edit_date": 1558230898, "creation_date": 1558199235, "answer_id": 56201143, "question_id": 56201044, "link": "https://stackoverflow.com/questions/56201044/how-can-i-remove-the-last-4-characters-from-a-string/56201143#56201143", "title": "How can I remove the last 4 characters from a string?", "body": "<p>You can use this to remove everything after last \".\"<br>\n<a href=\"https://play.golang.org/p/Agak4g66pfb\" rel=\"nofollow noreferrer\">go playground</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    sampleInput := []string{\n    \"/www/main.js\",\n    \"/tmp/test.txt\",\n    \"/tmp/test2.text\",\n    \"/tmp/test3.verylongext\",\n    \"/user/bob.smith/has.many.dots.exe\",\n    \"/tmp/zeroext.\",\n    \"/tmp/noext\",\n    \"\",\n    \"tldr\",\n    }\n    for _, str := range sampleInput {\n        fmt.Println(removeExtn(str))\n    }\n}\n\nfunc removeExtn(input string) string {\n    if len(input) &gt; 0 {\n        if i := strings.LastIndex(input, \".\"); i &gt; 0 {\n            input = input[:i]\n        }\n    }\n    return input\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": false, "score": 3, "last_activity_date": 1558215741, "last_edit_date": 1558215741, "creation_date": 1558208542, "answer_id": 56202304, "question_id": 56201044, "link": "https://stackoverflow.com/questions/56201044/how-can-i-remove-the-last-4-characters-from-a-string/56202304#56202304", "title": "How can I remove the last 4 characters from a string?", "body": "<p>This will safely remove any dot-extension - and will be tolerant if no extension is found:</p>\n\n<pre><code>func removeExtension(fpath string) string {\n        ext := filepath.Ext(fpath)\n        return strings.TrimSuffix(fpath, ext)\n}\n</code></pre>\n\n<p>Playground <a href=\"https://play.golang.org/p/SEHl74QHhmy\" rel=\"nofollow noreferrer\">example</a>.</p>\n\n<p>Table tests:</p>\n\n<pre><code>/www/main.js                             -&gt; '/www/main'\n/tmp/test.txt                            -&gt; '/tmp/test'\n/tmp/test2.text                          -&gt; '/tmp/test2'\n/tmp/test3.verylongext                   -&gt; '/tmp/test3'\n/user/bob.smith/has.many.dots.exe        -&gt; '/user/bob.smith/has.many.dots'\n/tmp/zeroext.                            -&gt; '/tmp/zeroext'\n/tmp/noext                               -&gt; '/tmp/noext'\n                                         -&gt; ''\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2647, "user_id": 4628962, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/avtRP.png?s=128&g=1", "display_name": "Abdullah Al Maruf - Tuhin", "link": "https://stackoverflow.com/users/4628962/abdullah-al-maruf-tuhin"}, "is_accepted": false, "score": 1, "last_activity_date": 1558303112, "creation_date": 1558303112, "answer_id": 56212328, "question_id": 56201044, "link": "https://stackoverflow.com/questions/56201044/how-can-i-remove-the-last-4-characters-from-a-string/56212328#56212328", "title": "How can I remove the last 4 characters from a string?", "body": "<p>Though there is already an accepted answer, I want to share some slice tricks for string manipulation.</p>\n\n<ol>\n<li><p><strong>Remove last n characters from a string</strong> </p>\n\n<p>As the title says, <code>remove the last 4 characters from a string</code>, it is very common usage of <code>slices</code>, ie,</p>\n\n<pre><code>file := \"test.txt\"\nfmt.Println(file[:len(file)-4]) // you can replace 4 with any n\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>test\n</code></pre>\n\n<p>Playground <a href=\"https://play.golang.org/p/Cnqr5oUFCkD\" rel=\"nofollow noreferrer\">example</a>.</p></li>\n<li><p><strong>Remove file extensions:</strong></p>\n\n<p>From your problem description, it looks like you are trying to trim the file extension suffix (ie, <code>.txt</code>) from the string.</p>\n\n<p>For this, I would prefer @colminator's answer from above, which is</p>\n\n<pre><code>file := \"test.txt\"\nfmt.Println(strings.TrimSuffix(file, filepath.Ext(file)))\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 21, "user_id": 9256860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c76454c857458bd635bba94aeded6cdb?s=128&d=identicon&r=PG&f=1", "display_name": "KainAlive", "link": "https://stackoverflow.com/users/9256860/kainalive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 56201143, "answer_count": 3, "score": 0, "last_activity_date": 1558303112, "creation_date": 1558198488, "last_edit_date": 1558214531, "question_id": 56201044, "link": "https://stackoverflow.com/questions/56201044/how-can-i-remove-the-last-4-characters-from-a-string", "title": "How can I remove the last 4 characters from a string?", "body": "<p>I want to remove the last 4 characters from a string, so \"test.txt\" becomes \"test\".</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    file := \"test.txt\"\n    fmt.Print(strings.TrimSuffix(file, \".\"))\n}\n</code></pre>\n"}, {"tags": ["json", "go", "go-gin"], "comments": [{"owner": {"reputation": 534, "user_id": 6192935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-WzVJWA1aLts/AAAAAAAAAAI/AAAAAAAABfQ/FxZhI2PBCBA/photo.jpg?sz=128", "display_name": "Manish Champaneri", "link": "https://stackoverflow.com/users/6192935/manish-champaneri"}, "edited": false, "score": 0, "creation_date": 1558335242, "post_id": 56200925, "comment_id": 99051976, "body": "You are using struct for response instead of array of struct so current output is accurate one. It seems from your code that you want to return only one struct at a time. So instead of handling it via empty array, handle it on null."}], "answers": [{"comments": [{"owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "edited": false, "score": 2, "creation_date": 1558340745, "post_id": 56201087, "comment_id": 99054478, "body": "or <code>productConstructed.BrandMedals = []string{}</code> would do too"}, {"owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "reply_to_user": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "edited": false, "score": 0, "creation_date": 1558359279, "post_id": 56201087, "comment_id": 99064657, "body": "@Seaskyways your solution is more elegant and lisible thanks"}, {"owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "edited": false, "score": 0, "creation_date": 1558366191, "post_id": 56201087, "comment_id": 99068723, "body": "it is 100% equivalent, just different syntax"}], "tags": [], "owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "is_accepted": false, "score": 11, "last_activity_date": 1558198835, "creation_date": 1558198835, "answer_id": 56201087, "question_id": 56200925, "link": "https://stackoverflow.com/questions/56200925/return-an-empty-array-instead-of-null-with-golang-for-json-return-with-gin/56201087#56201087", "title": "Return an empty array instead of null with golang for json return with gin", "body": "<p>So the solution was to initialize it with : </p>\n\n<pre><code>productConstructed.BrandMedals = make([]string, 0)\n</code></pre>\n"}], "owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4115, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1597431120, "creation_date": 1558197472, "last_edit_date": 1597431120, "question_id": 56200925, "link": "https://stackoverflow.com/questions/56200925/return-an-empty-array-instead-of-null-with-golang-for-json-return-with-gin", "title": "Return an empty array instead of null with golang for json return with gin", "body": "<p>So i have a struct :</p>\n\n<pre><code>type ProductConstructed struct {\n    Name string `json:\"Name\"`\n    BrandMedals []string `json:\"BRAND_MEDALS\"`\n}\n</code></pre>\n\n<p>When i return my object with gin and : </p>\n\n<pre><code>func  contructproduct(c *gin.Context) {\n    var response ProductConstructed \n    response.Name = \"toto\"\n\n    c.JSON(200, response)\n}\n\nfunc main() {\n    var err error\n    if err != nil {\n        panic(err)\n    }\n    //gin.SetMode(gin.ReleaseMode)\n    r := gin.Default()\n    r.POST(\"/constructProductGo/v1/constructProduct\", contructproduct)\n    r.Run(\":8200\") // listen and serve on 0.0.0.0:8080\n}\n</code></pre>\n\n<p>It returns me : </p>\n\n<blockquote>\n  <p>null</p>\n</blockquote>\n\n<p>instead of </p>\n\n<blockquote>\n  <p>[]</p>\n</blockquote>\n\n<p>How to return an empty array ?</p>\n\n<p>Regards</p>\n"}, {"tags": ["python", "string", "go", "shared-objects"], "owner": {"reputation": 187, "user_id": 8913779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6wMKr.png?s=128&g=1", "display_name": "systrigger", "link": "https://stackoverflow.com/users/8913779/systrigger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1558356541, "creation_date": 1558184382, "last_edit_date": 1558356541, "question_id": 56199171, "link": "https://stackoverflow.com/questions/56199171/passing-string-from-python-as-a-parameter-to-a-go-function-in-a-shared-object", "title": "Passing string from Python as a parameter to a Go function in a shared object", "body": "<p>I'm trying to call the below <code>MakeQuery(query string)</code> function by passing the string from Python using <code>ctypes</code> module.</p>\n\n<p>It works when I call it from Python as a function shared object with hardcoded arguments from <code>Works()</code> in Go:</p>\n\n<pre><code>//export Works\nfunc Works() {\n    newMod := MakeQuery(`SELECT TOP 3 NodeID FROM NCM.ConfigArchive`)\n    fmt.Println(newMod)\n}\n\n// Query db connection and return results as map\n//export MakeQuery\nfunc MakeQuery(query string) []map[string]interface {} {...}\n</code></pre>\n\n<p>According to some web tutorials, I need to convert it as such:</p>\n\n<pre><code>from ctypes import *\n\nlib = cdll.LoadLibrary(\"./test.so\")\nquery = \"SELECT TOP 3 NodeID FROM NCM.ConfigArchive\"\nb_query = query.encode('utf-8')\nlib.MakeQuery.argtypes = [c_char_p]\nprint lib.MakeQuery(b_query)\n</code></pre>\n\n<p>But it doesn't work due to some string type conversion error:</p>\n\n<pre><code>&amp;{400 Bad Request 400 HTTP/1.1 1 1 map[Content-Length:[1602] Content-Type:\n[application/json] Date:[Sat, 18 May 2019 12:48:54 GMT] Server:[Microsoft-\nHTTPAPI/2.0]] 0xc00009a1c0 1602 [] false false map[] 0xc000104000 0xc0001a8000}\n</code></pre>\n\n<p>Would be a great help if someone can point me to the direction to convert Python's string type into Go in some way.</p>\n"}, {"tags": ["postgresql", "go", "mux"], "comments": [{"owner": {"reputation": 1580, "user_id": 5010028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02c50dc258cbc30aff9124c5c35ca3c0?s=128&d=identicon&r=PG&f=1", "display_name": "Shubham Srivastava", "link": "https://stackoverflow.com/users/5010028/shubham-srivastava"}, "edited": false, "score": 0, "creation_date": 1558188100, "post_id": 56199142, "comment_id": 99022410, "body": "Scan the other JSON in a string. After that, you can convert it to JSON."}, {"owner": {"reputation": 131, "user_id": 11388065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b75f913ff3951b68cbf81b36ff218be4?s=128&d=identicon&r=PG&f=1", "display_name": "learner", "link": "https://stackoverflow.com/users/11388065/learner"}, "reply_to_user": {"reputation": 1580, "user_id": 5010028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02c50dc258cbc30aff9124c5c35ca3c0?s=128&d=identicon&r=PG&f=1", "display_name": "Shubham Srivastava", "link": "https://stackoverflow.com/users/5010028/shubham-srivastava"}, "edited": false, "score": 0, "creation_date": 1558194945, "post_id": 56199142, "comment_id": 99024096, "body": "can you please explain this?"}, {"owner": {"reputation": 1580, "user_id": 5010028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02c50dc258cbc30aff9124c5c35ca3c0?s=128&d=identicon&r=PG&f=1", "display_name": "Shubham Srivastava", "link": "https://stackoverflow.com/users/5010028/shubham-srivastava"}, "edited": false, "score": 1, "creation_date": 1558198787, "post_id": 56199142, "comment_id": 99024974, "body": "The DB driver scans every column as []byte which is then translated into datatype by default it won&#39;t scan value of jsonb to a struct, either you would have to write a custom scanner function or read the column in string and json Unmarshal it."}, {"owner": {"reputation": 1580, "user_id": 5010028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02c50dc258cbc30aff9124c5c35ca3c0?s=128&d=identicon&r=PG&f=1", "display_name": "Shubham Srivastava", "link": "https://stackoverflow.com/users/5010028/shubham-srivastava"}, "edited": false, "score": 1, "creation_date": 1558198974, "post_id": 56199142, "comment_id": 99025014, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/48980685/how-do-i-scan-a-jsonb-column-to-a-slice-of-struct-pointer\">How do I scan a jsonb column to a slice of struct/pointer?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 75, "user_id": 355077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/717fbb89559e5694f26ce3aad01ba819?s=128&d=identicon&r=PG", "display_name": "Philip Constantinou", "link": "https://stackoverflow.com/users/355077/philip-constantinou"}, "is_accepted": false, "score": 0, "last_activity_date": 1558321263, "creation_date": 1558321263, "answer_id": 56213825, "question_id": 56199142, "link": "https://stackoverflow.com/questions/56199142/insert-data-in-go-api-using-nested-objectsstructs/56213825#56213825", "title": "Insert data in Go API using nested objects(structs)", "body": "<p>You can make this modification:</p>\n\n<pre><code>import \"encoding/json\"\n\nfunc (d *Data) Create(db *sql.DB) error {\n   var jsonOther string\n   if d.Other != nil {\n      jsonOther, _ = json.Marshal(d.Other)\n      err := db.QueryRow(\n         \"INSERT INTO configs(name, other) VALUES($1, $2) RETURNING id\",\n         d.Name, jsonOther).Scan(&amp;d.ID)\n      if err != nil {\n          return err\n      }\n      return nil\n }\n</code></pre>\n\n<p>Notice that the <code>Other</code> object is explicitly serialized to JSON and passed as a string</p>\n"}], "owner": {"reputation": 131, "user_id": 11388065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b75f913ff3951b68cbf81b36ff218be4?s=128&d=identicon&r=PG&f=1", "display_name": "learner", "link": "https://stackoverflow.com/users/11388065/learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 256, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558321263, "creation_date": 1558184131, "last_edit_date": 1558197877, "question_id": 56199142, "link": "https://stackoverflow.com/questions/56199142/insert-data-in-go-api-using-nested-objectsstructs", "title": "Insert data in Go API using nested objects(structs)", "body": "<p>I'm creating a Golang API, but hit a blocker. For every POST, this is what I get:\n<code>\"error\": \"sql: converting argument $2 type: unsupported type main.Data, a struct\"</code></p>\n\n<p>I'd like my data to be of format </p>\n\n<pre><code>        \"name\": \"test\",\n        \"other\": {\n            \"age\": \"\",\n            \"height\": \"\"\n        }\n    }\n</code></pre>\n\n<p>How can I achieve this? See the code below, what I've tried so far.</p>\n\n<p>model.go</p>\n\n<pre><code>type Data struct {\n    ID   int    `json:\"id\"`\n    Name string `json:\"name,omitempty\"`\n    Other *Other `json:\"other,omitempty\"`\n}\n\ntype Other struct {\n    Age     string `json:\"host,omitempty\"`\n    Height string `json:\"database,omitempty\"`\n}\n\nfunc (d *Data) Create(db *sql.DB) error {\n    err := db.QueryRow(\n        \"INSERT INTO configs(name, other) VALUES($1, $2) RETURNING id\",\n        d.Name, &amp;d.Other).Scan(&amp;d.ID)\n    if err != nil {\n        return err\n    }\n\n    return nil\n}\n</code></pre>\n\n<p>controller.go</p>\n\n<pre><code>...\nfunc (a *App) createData(w http.ResponseWriter, r *http.Request) {\n    var d Data\n    decoder := json.NewDecoder(r.Body)\n\n    if err := decoder.Decode(&amp;d); err != nil {\n        fmt.Print(err)\n        fatalError(w, http.StatusBadRequest, \"Invalid request\")\n        return\n    }\n    defer r.Body.Close()\n    if err := d.Create(a.DB); err != nil {\n        fatalError(w, http.StatusInternalServerError, err.Error())\n        return\n    }\n\n    jsonResponse(w, http.StatusCreated, d)\n}\n</code></pre>\n\n<p>I expected the db to be populated with the data of format</p>\n\n<pre><code>        \"name\": \"test\",\n        \"other\": {\n            \"age\": \"\",\n            \"height\": \"\"\n        }\n    }\n</code></pre>\n\n<p>But fails with error:</p>\n\n<pre><code>\"error\": \"sql: converting argument $2 type: unsupported type main.Data, a struct\"\n</code></pre>\n"}, {"tags": ["java", "go", "digital-signature", "x509"], "comments": [{"owner": {"reputation": 2778, "user_id": 8899044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72b611aa04cbd35df9894b1300eca2f?s=128&d=identicon&r=PG&f=1", "display_name": "Dominik Wosi\u0144ski", "link": "https://stackoverflow.com/users/8899044/dominik-wosi%c5%84ski"}, "edited": false, "score": 1, "creation_date": 1558178353, "post_id": 56197892, "comment_id": 99020113, "body": "Have You verified that You can decode it in Go ? This will make finding the error easier."}, {"owner": {"reputation": 97, "user_id": 10407203, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sUaCdSM-aLY/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXx_aDQ1MlPNzgWvEss0bfN12Om_w/mo/photo.jpg?sz=128", "display_name": "Miguel Reis", "link": "https://stackoverflow.com/users/10407203/miguel-reis"}, "reply_to_user": {"reputation": 2778, "user_id": 8899044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72b611aa04cbd35df9894b1300eca2f?s=128&d=identicon&r=PG&f=1", "display_name": "Dominik Wosi\u0144ski", "link": "https://stackoverflow.com/users/8899044/dominik-wosi%c5%84ski"}, "edited": false, "score": 0, "creation_date": 1558183642, "post_id": 56197892, "comment_id": 99021305, "body": "Yes, i&#39;m verifying the signature after creating it to see if it is working (the verification is successful): clientCertEndorserSignToVerify, err := base64.StdEncoding.DecodeString(signatureSTring) errVerify := rsa.VerifyPKCS1v15(publicKey.(*rsa.PublicKey), crypto2.SHA256, hashedString, signatureString)"}], "answers": [{"comments": [{"owner": {"reputation": 23625, "user_id": 2868801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ec5567811049b7ce8192be0bc0246d1?s=128&d=identicon&r=PG&f=1", "display_name": "dave_thompson_085", "link": "https://stackoverflow.com/users/2868801/dave-thompson-085"}, "edited": false, "score": 1, "creation_date": 1558220809, "post_id": 56200725, "comment_id": 99029407, "body": "PEM files (like MIME but not XML or JSON) have the base64 broken into lines. Java8+ <code>Base64.getDecoder()</code> is for &#39;basic&#39; base64 with <i>no</i> linebreaks; for linebreaks like MIME use <code>Base64.getMimeDecoder()</code> as explained <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/Base64.html\" rel=\"nofollow noreferrer\">in the javadoc</a>. Alternatively delete all <code>\\n</code> or <code>\\r\\n</code> depending on your system or file(s) before decoding."}], "tags": [], "owner": {"reputation": 97, "user_id": 10407203, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sUaCdSM-aLY/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXx_aDQ1MlPNzgWvEss0bfN12Om_w/mo/photo.jpg?sz=128", "display_name": "Miguel Reis", "link": "https://stackoverflow.com/users/10407203/miguel-reis"}, "is_accepted": true, "score": 2, "last_activity_date": 1558195900, "creation_date": 1558195900, "answer_id": 56200725, "question_id": 56197892, "link": "https://stackoverflow.com/questions/56197892/using-java-to-verify-signature-created-in-golang/56200725#56200725", "title": "Using Java to verify signature created in Golang", "body": "<p>I was able to verify the signature. I'm posting here in case someone comes across this with the same question:</p>\n\n<p>Signature creation in Go:</p>\n\n<pre><code>bytesToSign := []byte (stringToSign)\nblock, err8 := pem.Decode([]byte(privateKeyPem)) //-----BEGIN RSA PRIVATE KEY----\nif err8 != nil {\n    logger.Debugf(\"Error trying decode endorser private key\")\n}\nkey, _ := x509.ParsePKCS1PrivateKey(block.Bytes)\nh := sha256.New()\nh.Write(bytesToSign)\nd := h.Sum(nil)\nsignature, err = rsa.SignPKCS1v15(rand.Reader, key, crypto.SHA256, d)\nif err != nil {\n    panic(err)\n}\nsignatureString = base64.StdEncoding.EncodeToString(signature)\n</code></pre>\n\n<p>Signature verification in Java (receives signatureString):\nI have the public key in a .pub file and:</p>\n\n<pre><code>byte[] keyBytes = Files.readAllBytes(Paths.get(\"./public_key.pub\"));\nString temp = new String(keyBytes);\nString publicKeyPEM = temp.replace(\"-----BEGIN PUBLIC KEY-----\\n\", \"\");\npublicKeyPEM = publicKeyPEM.replace(\"\\n-----END PUBLIC KEY-----\", \"\");\nBASE64Decoder b64= new BASE64Decoder();\nbyte[] decoded = b64.decodeBuffer(publicKeyPEM);\nX509EncodedKeySpec spec = new X509EncodedKeySpec(decoded);\nKeyFactory kf = KeyFactory.getInstance(\"RSA\");\npublicKey = kf.generatePublic(spec);\nSignature signature = Signature.getInstance(\"SHA256withRSA\", \"BC\");\nsignature.initVerify(publicKey);\nsignature.update(bytesToVerify); //bytesToVerify = bytesToSign in go\nbyte[] signatureDecoded = Base64.getDecoder().decode(signatureString);\nboolean endorserSignatureIsValid = signature.verify(signatureDecoded);\n//It is now valid\n</code></pre>\n\n<p>I was not able to use Base64.getDecoder() (java.lang.IllegalArgumentException: Illegal base64 character a) to decode the publicKeyPEM so I used BASE64Decoder. Not sure why.</p>\n"}, {"tags": [], "owner": {"reputation": 121, "user_id": 3150602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ab3ac12c4c86d0cc08fa6eea237b245?s=128&d=identicon&r=PG&f=1", "display_name": "nathan.xu", "link": "https://stackoverflow.com/users/3150602/nathan-xu"}, "is_accepted": false, "score": 1, "last_activity_date": 1617869863, "creation_date": 1617869863, "answer_id": 66999930, "question_id": 56197892, "link": "https://stackoverflow.com/questions/56197892/using-java-to-verify-signature-created-in-golang/66999930#66999930", "title": "Using Java to verify signature created in Golang", "body": "<p>I had also encounted this issue yesterday, and I solved it finally.</p>\n<p>It's may help others: <a href=\"https://github.com/xioxu/signature_in_multiple_lang\" rel=\"nofollow noreferrer\">https://github.com/xioxu/signature_in_multiple_lang</a></p>\n"}], "owner": {"reputation": 97, "user_id": 10407203, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sUaCdSM-aLY/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXx_aDQ1MlPNzgWvEss0bfN12Om_w/mo/photo.jpg?sz=128", "display_name": "Miguel Reis", "link": "https://stackoverflow.com/users/10407203/miguel-reis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 497, "favorite_count": 0, "accepted_answer_id": 56200725, "answer_count": 2, "score": 5, "last_activity_date": 1617869863, "creation_date": 1558173522, "last_edit_date": 1570337847, "question_id": 56197892, "link": "https://stackoverflow.com/questions/56197892/using-java-to-verify-signature-created-in-golang", "title": "Using Java to verify signature created in Golang", "body": "<p>I'm creating a signature in Go, for example:</p>\n\n<pre><code>//I'm reading a file with -----BEGIN RSA PRIVATE KEY-----\nprivateKeyPem := strings.Replace(privateKeyString, `\\n`, \"\\n\", -1) //file has '/n' instead of break lines for dev purposes\nblock, _ := pem.Decode([]byte(privateKeyPem))\nkey, _ := x509.ParsePKCS1PrivateKey(block.Bytes)\nhashedString := sha256.Sum256([]byte(stringTosign))\nsignature, err = rsa.SignPKCS1v15(rand.Reader, key, crypto2.SHA256, hashedString[:])\nsignatureString := base64.StdEncoding.EncodeToString(signature)\n</code></pre>\n\n<p>Java program receives the variable signatureString and does:</p>\n\n<pre><code>byte[] keyBytes = Files.readAllBytes(Paths.get(\"./golangSignerPubKey.der\"));\nX509EncodedKeySpec spec = new X509EncodedKeySpec(keyBytes);\nKeyFactory kf = KeyFactory.getInstance(\"RSA\");\nPublicKey publicKey =  kf.generatePublic(spec);\nSignature signature = Signature.getInstance(\"SHA256withRSA\", \"BC\");\nsignature.initVerify(publicKey);\nsignature.update(stringUnsigned.getBytes());\nboolean signatureIsValid = signature.verify(Base64.getDecoder().decode(signatureString.getBytes()));\n</code></pre>\n\n<p>But the signatureIsValid boolean is always false, am I doing something wrong? </p>\n"}, {"tags": ["pointers", "go", "methods", "interface"], "comments": [{"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 3, "creation_date": 1558173816, "post_id": 56197711, "comment_id": 99019230, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/40823315/x-does-not-implement-y-method-has-a-pointer-receiver\">X does not implement Y (... method has a pointer receiver)</a>"}, {"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 3, "creation_date": 1558173849, "post_id": 56197711, "comment_id": 99019240, "body": "tl;dr: change <code>newbox()</code> to return a pointer: <code>func newbox (x int) *box { return &amp;box{x} }</code> (but see that link for a more complete explanation)."}, {"owner": {"reputation": 464, "user_id": 4042041, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/83827a407e294030b50cdfaa38339f79?s=128&d=identicon&r=PG&f=1", "display_name": "Maurizio Ferreira", "link": "https://stackoverflow.com/users/4042041/maurizio-ferreira"}, "reply_to_user": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 0, "creation_date": 1558184117, "post_id": 56197711, "comment_id": 99021442, "body": "well, this is depressing... so I can&#39;t have an interface specifying both &quot;value&quot; procedures (getters) than &quot;pointer procedures&quot; (setters) ?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1558194017, "post_id": 56197711, "comment_id": 99023858, "body": "@MaurizioFerreira  The <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow noreferrer\">method set</a> for a pointer type includes the methods for value receivers (<code>box</code> in the question) and pointer receivers (<code>*box</code> in the question)."}, {"owner": {"reputation": 464, "user_id": 4042041, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/83827a407e294030b50cdfaa38339f79?s=128&d=identicon&r=PG&f=1", "display_name": "Maurizio Ferreira", "link": "https://stackoverflow.com/users/4042041/maurizio-ferreira"}, "edited": false, "score": 0, "creation_date": 1558211374, "post_id": 56197711, "comment_id": 99027783, "body": "Ok, so changing the function newBox to returning a pointer solves the problem. I&#39;m able to define setters and getters procedure. Thanks to all."}], "owner": {"reputation": 464, "user_id": 4042041, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/83827a407e294030b50cdfaa38339f79?s=128&d=identicon&r=PG&f=1", "display_name": "Maurizio Ferreira", "link": "https://stackoverflow.com/users/4042041/maurizio-ferreira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 284, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558178627, "creation_date": 1558172204, "last_edit_date": 1558178627, "question_id": 56197711, "link": "https://stackoverflow.com/questions/56197711/setting-a-value-via-an-interface-in-go", "title": "Setting a value via an interface in go", "body": "<p>In the following example, I'd like to call the <code>setvalue()</code> of the <code>b</code> object via an interface procedure.</p>\n\n<p>I'd like to use an interface because I need  to insert different kinds of objects in a list, possibly very big, each obeying a common interface.</p>\n\n<p>However the compiler complains with the following error :</p>\n\n<blockquote>\n  <p>./tests.go:27:6: cannot use newbox(3) (type box) as type container in assignment:\n      box does not implement container (setValue method has pointer receiver)</p>\n</blockquote>\n\n<p>Probably I have to define the interface differently, but how?</p>\n\n<p>I know I could transform the setvalue procedure in a function, returning the updated box, but since the object can be very large, and he procedure will be called several times, i'd like to pass the object via a pointer.</p>\n\n<p>Really isn't there a way to define an interface method that receive the calling structure via a pointer?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype container interface {\n  setValue (val int)\n}\n\n//--------------------------------------\n// box is a kind of container\n\ntype box struct {\n      value int\n}\n\nfunc newbox (x int) box {\n    return box {x}\n}\n\nfunc (cnt *box) setValue(val int) {\n    (*cnt).value = val\n}\n\n\n// -----------------------------------------------\n\nfunc main() {\n    var b container = newbox(3)  // HERE IS THE ERROR\n    fmt.Printf(\"%v\\n\",b)\n    b.setValue(5)\n    fmt.Printf(\"%v\\n\",b)\n}\n</code></pre>\n"}, {"tags": ["pointers", "go"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10783434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96d76e8e39ee0d0408fe675b1f03ec8?s=128&d=identicon&r=PG&f=1", "display_name": "Maxy", "link": "https://stackoverflow.com/users/10783434/maxy"}, "edited": false, "score": 0, "creation_date": 1558178081, "post_id": 56197751, "comment_id": 99020062, "body": "In <code>bad()</code> there is certainly only one address. However, <code>(&amp;x).f()</code> is evaluated in the first <code>append()</code>. So it looks like the 0th element of the slice contains <code>(&amp;T{1}).F()</code>. Is <code>(&amp;T{1}) F()</code> stored in slice <code>s[0]</code> no longer irrelevant to variable <code>x</code>? After that, the value of x changes with <code>x = T{2}</code>, but I do not know why it affects <code>(&amp;T {1}).F()</code> already stored in the slice. Is the second argument of append evaluated late? In that case, I can somehow see that <code>s[0]()</code> and <code>s[1]()</code> have the same value."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 43, "user_id": 10783434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96d76e8e39ee0d0408fe675b1f03ec8?s=128&d=identicon&r=PG&f=1", "display_name": "Maxy", "link": "https://stackoverflow.com/users/10783434/maxy"}, "edited": false, "score": 0, "creation_date": 1558183336, "post_id": 56197751, "comment_id": 99021228, "body": "@Maxy Your thinking is <i>far</i> <i>too</i> _complex. In Bad you have one variable <code>x</code>. A &quot;variable&quot; is some place in memory. After <code>x = T{1}</code> that memory contains a 1. After <code>x = T{2}</code> that memory contains 2. Your x has has just address: <code>&amp;x</code>. That you do some magic with method values is just obfuscation: Your slice contains function which take a memory address as their argument. This memory address is the one of x. You have just one x, you have just one address and both functions are called with the same argument, that address."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 43, "user_id": 10783434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96d76e8e39ee0d0408fe675b1f03ec8?s=128&d=identicon&r=PG&f=1", "display_name": "Maxy", "link": "https://stackoverflow.com/users/10783434/maxy"}, "edited": false, "score": 1, "creation_date": 1558183666, "post_id": 56197751, "comment_id": 99021311, "body": "@Maxy Note that it is <b>wrong</b> to say &quot;the slice contains (&amp;T{1}).F()&quot;: The slice contains &quot;the f operating on the address of x&quot;. <code>f</code> is defined with a pointer receiver and <code>&amp;x</code> is that receiver. The <i>value</i> which is stored in the <code>x</code> is <i>not</i> involved here. The slice s stores a function working on a memory address. What this memory address contains is not stored in the slice and can be changed whenever you like."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 43, "user_id": 10783434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96d76e8e39ee0d0408fe675b1f03ec8?s=128&d=identicon&r=PG&f=1", "display_name": "Maxy", "link": "https://stackoverflow.com/users/10783434/maxy"}, "edited": false, "score": 1, "creation_date": 1558184047, "post_id": 56197751, "comment_id": 99021424, "body": "Some more comments: 1. All this is unrelated to closures (your code does not contain any closure). Thinking about a method value as a closure is wrong, a method value is <i>not</i> a closure. 2. All this is unrelated to slices and append. It just makes your code more complicated. The difference between good and bad is: good uses two different variables (= areas of memory) while bad uses just one variable (memory area). Both (good and bad) reuse a name <code>x</code> but good reuses it for a different <i>memory</i> <i>address</i> while bad reuses it for a different <i>value</i>."}, {"owner": {"reputation": 43, "user_id": 10783434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96d76e8e39ee0d0408fe675b1f03ec8?s=128&d=identicon&r=PG&f=1", "display_name": "Maxy", "link": "https://stackoverflow.com/users/10783434/maxy"}, "edited": false, "score": 0, "creation_date": 1558207879, "post_id": 56197751, "comment_id": 99027066, "body": "Thanks for the answers and some notes! I read the comments and reviewed the variables and calls again. With this question, I understand that slices are irrelevant and only receiver obfuscation and pointer variable problems. As a result, I thought that it would be better to call a point receiver basically with a pointer variable."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 3, "last_activity_date": 1558172405, "creation_date": 1558172405, "answer_id": 56197751, "question_id": 56197626, "link": "https://stackoverflow.com/questions/56197626/why-dont-closures-called-from-non-pointer-values-be-added-to-slices-correctly/56197751#56197751", "title": "Why don&#39;t closures called from non-pointer values \u200bbe added to slices correctly?", "body": "<p>Because in bad you have just <em>one</em> variable <code>x</code> of type T and <em>one</em> variable has just <em>one</em> address and thus your slice s contains always the same function working on the same variable which has value 2 when you start calling the functions.</p>\n\n<p>(In good you have <em>two</em> different variables of type T. You reuse a variable (x) of type *T but you still have two <em>different</em> T with different values.)</p>\n"}], "owner": {"reputation": 43, "user_id": 10783434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96d76e8e39ee0d0408fe675b1f03ec8?s=128&d=identicon&r=PG&f=1", "display_name": "Maxy", "link": "https://stackoverflow.com/users/10783434/maxy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 56197751, "answer_count": 1, "score": 0, "last_activity_date": 1558172405, "creation_date": 1558171357, "question_id": 56197626, "link": "https://stackoverflow.com/questions/56197626/why-dont-closures-called-from-non-pointer-values-be-added-to-slices-correctly", "title": "Why don&#39;t closures called from non-pointer values \u200bbe added to slices correctly?", "body": "<p>This is the argument in <code>go1.12.3 linux/amd64</code>.</p>\n\n<p>Added two closures to the slice <code>s</code> containing the function through the variable <code>x</code>.\nThe closure is obtained by a method with a pointer receiver of type <code>T</code>.\nAdded two closures to the slice s containing the function through the variable x.\nThe closure is obtained by a method with a pointer receiver of type T.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\ntype T struct {\n    X int\n}\n\nfunc (t *T) f() func() {\n    return func() { fmt.Println(t.X) }\n}\n\nfunc good() {\n    s := []func(){}\n\n    x := &amp;T{1}\n    s = append(s, x.f())\n\n    x = &amp;T{2}\n    s = append(s, x.f())\n\n    s[0]() // =&gt; 1\n    s[1]() // =&gt; 2\n}\n\nfunc bad() {\n    s := []func(){}\n\n    x := T{1}\n    s = append(s, (&amp;x).f())  // Even if it rewrites to append(s, x.f()), the result is the same.\n\n    x = T{2}\n    s = append(s, (&amp;x).f())\n\n    s[0]() // =&gt; 2 WHY!?\n    s[1]() // =&gt; 2\n}\n\nfunc main() {\n    good()\n    bad()\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/j-818FZELQb\" rel=\"nofollow noreferrer\">https://play.golang.org/p/j-818FZELQb</a></p>\n\n<p>Of the above two functions, <code>good()</code> works as expected.\nIn good <code>s[0]()</code> executes <code>T{1}.f()()</code>, and s <code>s[1]()</code> executes <code>T{2}.f()()</code>.\nHowever, <code>bad()</code> runs <code>s[0]()</code> and <code>s[1]()</code> run <code>T{2}.f()()</code>.\nEven though I added the element to the slice without overwriting it!</p>\n\n<p>I have no idea what caused this behavior.\nDidn't the variable <code>x</code> have a value of type <code>T</code> instead of a pointer to a value of type <code>T</code>?\nOr do I not know the call specification of append?</p>\n\n<p>Please give me some advice.</p>\n"}, {"tags": ["go", "google-cloud-pubsub", "google-cloud-run"], "comments": [{"owner": {"reputation": 31223, "user_id": 11372593, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FQBr5NRaPHA/AAAAAAAAAAI/AAAAAAAABb0/XuGqOq18jyg/photo.jpg?sz=128", "display_name": "guillaume blaquiere", "link": "https://stackoverflow.com/users/11372593/guillaume-blaquiere"}, "edited": false, "score": 0, "creation_date": 1558203879, "post_id": 56197404, "comment_id": 99026266, "body": "Maybe a problem with gRPC ? Is it possible to switch to HTTP API ?"}, {"owner": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "edited": false, "score": 0, "creation_date": 1558238605, "post_id": 56197404, "comment_id": 99031318, "body": "With Pub/Sub and Cloud Run, you need Pub/Sub to push to the Cloud Run service URL. With Cloud Run design your programs to be called via HTTP endpoints and to not do any CPU processing outside of the HTTP Request/Response."}], "answers": [{"tags": [], "owner": {"reputation": 1748, "user_id": 2141567, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d01ff69e9615953644bcfae92c68ab1c?s=128&d=identicon&r=PG", "display_name": "wlhee", "link": "https://stackoverflow.com/users/2141567/wlhee"}, "is_accepted": false, "score": 0, "last_activity_date": 1558192405, "creation_date": 1558192405, "answer_id": 56200234, "question_id": 56197404, "link": "https://stackoverflow.com/questions/56197404/pubsub-pull-subcription-with-gvisor-cloudrun-issue/56200234#56200234", "title": "Pubsub Pull Subcription with GVisor (CloudRun) issue", "body": "<p>Pull subscription doesn't work in Cloud Run because the container gets throttled or even terminated out of request scope.</p>\n\n<p>The goroutine is not able to proceed.</p>\n"}, {"tags": [], "owner": {"reputation": 31223, "user_id": 11372593, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FQBr5NRaPHA/AAAAAAAAAAI/AAAAAAAABb0/XuGqOq18jyg/photo.jpg?sz=128", "display_name": "guillaume blaquiere", "link": "https://stackoverflow.com/users/11372593/guillaume-blaquiere"}, "is_accepted": false, "score": 1, "last_activity_date": 1558267292, "creation_date": 1558267292, "answer_id": 56207590, "question_id": 56197404, "link": "https://stackoverflow.com/questions/56197404/pubsub-pull-subcription-with-gvisor-cloudrun-issue/56207590#56207590", "title": "Pubsub Pull Subcription with GVisor (CloudRun) issue", "body": "<p>No it's wrong. I found my issue: I over estimated the GCP global network: My timeout which cancel the polling was set to 200ms. With this requirement, my app don't have the time to recover the first message before the cancel. With 2000ms of timeout, it work perfectly !</p>\n\n<p>Go routine are allowed with Cloud run, but they can't survive after the reply of the http request.</p>\n"}], "owner": {"reputation": 31223, "user_id": 11372593, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FQBr5NRaPHA/AAAAAAAAAAI/AAAAAAAABb0/XuGqOq18jyg/photo.jpg?sz=128", "display_name": "guillaume blaquiere", "link": "https://stackoverflow.com/users/11372593/guillaume-blaquiere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1558267292, "creation_date": 1558169522, "question_id": 56197404, "link": "https://stackoverflow.com/questions/56197404/pubsub-pull-subcription-with-gvisor-cloudrun-issue", "title": "Pubsub Pull Subcription with GVisor (CloudRun) issue", "body": "<p>I would like to pull a Google PubSub subscription with Go. It works well locally but when I deploy it on Cloud Run, impossible to pull any message.</p>\n\n<p>Here my code snippet</p>\n\n<pre><code>func (pubSubService *pubSubService) Received() (msgArray []*pubsub.Message, err error) {\n    ctx := context.Background()\n    cctx, cancel := context.WithCancel(ctx)\n    msgArray = []*pubsub.Message{}\n\n    var receivedMessage = make(chan *pubsub.Message)\n\n    go func() {\n        for {\n            select {\n            case msg := &lt;-receivedMessage:\n                msgArray = append(msgArray, msg)\n            case &lt;-time.After(pubSubService.waitTimeOutInMillis * time.Millisecond):\n                cancel()\n            }\n        }\n    }()\n\n    err = pubSubService.client.Subscription(pubSubService.subscriptionName).Receive(cctx, func(ctx context.Context, msg *pubsub.Message) {\n        receivedMessage &lt;- msg\n        msg.Ack()\n    })\n    if err != nil {\n        return\n    }\n\n    return\n}\n</code></pre>\n\n<p>Here the log error</p>\n\n<pre><code>D  Container Sandbox Limitation: Unsupported syscall setsockopt(0x7,0x6,0x12,0xc00006f204,0x4,0x0) \nD  Container Sandbox Limitation: Unsupported syscall setsockopt(0x5,0x6,0x12,0xc0003c1204,0x4,0x0) \nD  Container Sandbox Limitation: Unsupported syscall setsockopt(0xa,0x6,0x12,0xc0003bd204,0x4,0x0) \nD  Container Sandbox Limitation: Unsupported syscall setsockopt(0xc,0x6,0x12,0xc00037d204,0x4,0x0) \nD  Container Sandbox Limitation: Unsupported syscall setsockopt(0x6,0x6,0x12,0xc0002d3204,0x4,0x0) \nD  Container Sandbox Limitation: Unsupported syscall setsockopt(0x8,0x6,0x12,0xc00052b204,0x4,0x0) \nD  Container Sandbox Limitation: Unsupported syscall setsockopt(0x9,0x6,0x12,0xc000391204,0x4,0x0) \nD  Container Sandbox Limitation: Unsupported syscall setsockopt(0xb,0x6,0x12,0xc00043b204,0x4,0x0) \nD  Container Sandbox Limitation: Unsupported syscall setsockopt(0x6,0x6,0x12,0xc0003b3204,0x4,0x0) \nD  Container Sandbox Limitation: Unsupported syscall setsockopt(0xc,0x6,0x12,0xc0003d3204,0x4,0x0) \nD  Container Sandbox Limitation: Unsupported syscall setsockopt(0x7,0x6,0x12,0xc000391204,0x4,0x0) \nD  Container Sandbox Limitation: Unsupported syscall setsockopt(0x5,0x6,0x12,0xc000309204,0x4,0x0) \nD  Container Sandbox Limitation: Unsupported syscall setsockopt(0xb,0x6,0x12,0xc0004d3204,0x4,0x0) \n</code></pre>\n\n<p>The Received call is filter by the GVisor sandbox of Cloud Run </p>\n\n<p>Do you know workarround or ReceiveSetting to set for this issue ?\nThanks in advance.</p>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 474, "user_id": 4063201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/uU5YK.png?s=128&g=1", "display_name": "monirz", "link": "https://stackoverflow.com/users/4063201/monirz"}, "edited": false, "score": 2, "creation_date": 1558160999, "post_id": 56196486, "comment_id": 99016824, "body": "It did not return any error, can you share the full code or the error your are getting?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1558161493, "post_id": 56196486, "comment_id": 99016914, "body": "There are no exceptions in Go, much less fatal exceptions that cannot be handled. Add the exact error message to the question."}, {"owner": {"reputation": 11, "user_id": 11519131, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9J4dHgMbjsU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcmpv3BWHgAxDHFS7A0JWGtuu40Tg/mo/photo.jpg?sz=128", "display_name": "mohammad ahmadi", "link": "https://stackoverflow.com/users/11519131/mohammad-ahmadi"}, "edited": false, "score": 0, "creation_date": 1558162526, "post_id": 56196486, "comment_id": 99017091, "body": "i just edit question and added error. thanks"}, {"owner": {"reputation": 11, "user_id": 11519131, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9J4dHgMbjsU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcmpv3BWHgAxDHFS7A0JWGtuu40Tg/mo/photo.jpg?sz=128", "display_name": "mohammad ahmadi", "link": "https://stackoverflow.com/users/11519131/mohammad-ahmadi"}, "edited": false, "score": 0, "creation_date": 1558164747, "post_id": 56196486, "comment_id": 99017472, "body": "is error log enough?"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1558167592, "post_id": 56196486, "comment_id": 99017989, "body": "I can not reproduce this error, neither calling the code with <code>go run main.go</code> nor with a compiled version. You might want to check <code>GOPATH</code> and <code>GOROOT</code> environment variables."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1558168659, "post_id": 56196486, "comment_id": 99018199, "body": "can you show output of <code>go env</code> and <code>go version</code> and OS ? here they all works (both http and https go version = 1.12.4). can you try microsoft website with httpS and show the result ?"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 11519131, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9J4dHgMbjsU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcmpv3BWHgAxDHFS7A0JWGtuu40Tg/mo/photo.jpg?sz=128", "display_name": "mohammad ahmadi", "link": "https://stackoverflow.com/users/11519131/mohammad-ahmadi"}, "is_accepted": true, "score": 0, "last_activity_date": 1558169044, "creation_date": 1558169044, "answer_id": 56197351, "question_id": 56196486, "link": "https://stackoverflow.com/questions/56196486/why-http-get-method-is-throwing-fatal-exception-in-go/56197351#56197351", "title": "Why &quot;http.Get()&quot; method is throwing fatal exception in go?", "body": "<p>i just fixed my problem by updating go from 1.12.4 to 1.12.5.<br>\nthanks to @Markus-W-Mahlberg</p>\n"}], "owner": {"reputation": 11, "user_id": 11519131, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9J4dHgMbjsU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcmpv3BWHgAxDHFS7A0JWGtuu40Tg/mo/photo.jpg?sz=128", "display_name": "mohammad ahmadi", "link": "https://stackoverflow.com/users/11519131/mohammad-ahmadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 56197351, "answer_count": 1, "score": 0, "last_activity_date": 1558202658, "creation_date": 1558160294, "last_edit_date": 1558202658, "question_id": 56196486, "link": "https://stackoverflow.com/questions/56196486/why-http-get-method-is-throwing-fatal-exception-in-go", "title": "Why &quot;http.Get()&quot; method is throwing fatal exception in go?", "body": "<p>I am trying to use the following method:  </p>\n\n<pre><code>response,err:=http.Get(\"https://support.microsoft.com\")\n</code></pre>\n\n<p>It is working as expected. But when I call it with <strong>\"<a href=\"https://samsung.com\" rel=\"nofollow noreferrer\">https://samsung.com</a>\"</strong>, it is throwing fatal exception that I can not handle.</p>\n\n<p>A code sample:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc main() {\n    _, err := http.Get(\"http://support.microsoft.com\")\n    if err != nil {\n        fmt.Println(err)\n    }\n}  \n</code></pre>\n\n<p>and here is the error:  </p>\n\n<pre><code>panic: cipher.NewCBCEncrypter: IV length must equal block size\ngoroutine 55 [running]:\ncrypto/cipher.NewCBCEncrypter(0x7c7680, 0xc0001cd0b0, 0xc0000c03c8, 0x10, 0x20, 0x0, 0x0)\nC:/Go/src/crypto/cipher/cbc.go:47 +0x139  \ncrypto/tls.cipherAES(0xc0000c0388, 0x20, 0x60, 0xc0000c03c8, 0x10, 0x20, 0x0, 0x20, 0xc00008c156)  \nC:/Go/src/crypto/tls/cipher_suites.go:139 +0xe2  \ncrypto/tls.(*clientHandshakeState).establishKeys(0xc0001dfdc8, 0x0, 0x0)  \nC:/Go/src/crypto/tls/handshake_client.go:625 +0x20c  \ncrypto/tls.(*clientHandshakeState).handshake(0xc0001dfdc8, 0xc0000b7200, 0x0)  \nC:/Go/src/crypto/tls/handshake_client.go:402 +0x426  \ncrypto/tls.(*Conn).clientHandshake(0xc00003dc00, 0x0, 0x0)  \nC:/Go/src/crypto/tls/handshake_client.go:208 +0x2d4  \ncrypto/tls.(*Conn).Handshake(0xc00003dc00, 0x0, 0x0)  \nC:/Go/src/crypto/tls/conn.go:1343 +0xf6  \nnet/http.(*persistConn).addTLS.func2(0x0, 0xc00003dc00, 0xc0000cc7d0, 0xc000093da0)  \nC:/Go/src/net/http/transport.go:1190 +0x49  \ncreated by net/http.(*persistConn).addTLS  \nC:/Go/src/net/http/transport.go:1186 +0x1b2  \n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 274, "user_id": 11423104, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fgaQD.jpg?s=128&g=1", "display_name": "isaactfa", "link": "https://stackoverflow.com/users/11423104/isaactfa"}, "edited": false, "score": 1, "creation_date": 1558165027, "post_id": 56196759, "comment_id": 99017513, "body": "This is great, thanks! I remember skimming over the context package when first getting into go and not quite understanding its purpose, this helps a lot."}], "tags": [], "owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "is_accepted": true, "score": 3, "last_activity_date": 1558163211, "creation_date": 1558163211, "answer_id": 56196759, "question_id": 56196439, "link": "https://stackoverflow.com/questions/56196439/quit-all-recursively-spawned-goroutines-at-once/56196759#56196759", "title": "Quit all recursively spawned goroutines at once", "body": "<p>The <code>context</code> package provides similar functionality. Using <code>context.Context</code> with a few Go-esque patterns, you can achieve what you need.</p>\n\n<p>To start you can check this article to get a better feel of cancellation with <code>context</code>: <a href=\"https://www.sohamkamani.com/blog/golang/2018-06-17-golang-using-context-cancellation/\" rel=\"nofollow noreferrer\">https://www.sohamkamani.com/blog/golang/2018-06-17-golang-using-context-cancellation/</a></p>\n\n<p>Also make sure to check the official GoDoc: <a href=\"https://golang.org/pkg/context/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/context/</a></p>\n\n<p>So to achieve this functionality your function should look more like:</p>\n\n<pre><code>func walk(ctx context.Context, doc *html.Node, ch chan *html.Node) {\n    var wg sync.WaitGroup\n    defer close(ch)\n\n    var f func(*html.Node)\n    f = func(n *html.Node) {\n        defer wg.Done()\n\n        ch &lt;- n\n        for c := n.FirstChild; c != nil; c = c.NextSibling {\n            select {\n            case &lt;-ctx.Done():\n                return // quit the function as it is cancelled\n            default:\n                wg.Add(1)\n                go f(c)\n            }\n        }\n    }\n\n    select {\n    case &lt;-ctx.Done():\n        return // perhaps it was cancelled so quickly\n    default:\n        wg.Add(1)\n        go f(doc)\n        wg.Wait()\n    }\n}\n</code></pre>\n\n<p>And when calling the function, you will have something like:</p>\n\n<pre><code>// ...\nctx, cancelFunc := context.WithCancel(context.Background())\nwalk(ctx, doc, ch)\nfor value := range ch {\n    // ...\n    if someCondition {\n        cancelFunc()\n        // the for loop will automatically exit as the channel is being closed for the inside\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 274, "user_id": 11423104, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fgaQD.jpg?s=128&g=1", "display_name": "isaactfa", "link": "https://stackoverflow.com/users/11423104/isaactfa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 56196759, "answer_count": 1, "score": 2, "last_activity_date": 1558163211, "creation_date": 1558159760, "question_id": 56196439, "link": "https://stackoverflow.com/questions/56196439/quit-all-recursively-spawned-goroutines-at-once", "title": "Quit all recursively spawned goroutines at once", "body": "<p>I have a function that recursively spawns goroutines to walk a DOM tree, putting the nodes they find into a channel shared between all of them.</p>\n\n<pre><code>import (\n    \"golang.org/x/net/html\"\n    \"sync\"\n)\n\nfunc walk(doc *html.Node, ch chan *html.Node) {\n    var wg sync.WaitGroup\n    defer close(ch)\n    var f func(*html.Node)\n    f = func(n *html.Node) {\n        defer wg.Done()\n        ch &lt;- n\n        for c := n.FirstChild; c != nil; c = c.NextSibling {\n            wg.Add(1)\n            go f(c)\n        }\n    }\n    wg.Add(1)\n    go f(doc)\n    wg.Wait()\n}\n</code></pre>\n\n<p>Which I'd call like</p>\n\n<pre><code>// get the webpage using http\n// parse the html into doc\nch := make(chan *html.Node)\ngo walk(doc, ch)\n\nfor c := range ch {\n    if someCondition(c) {\n        // do something with c\n        // quit all goroutines spawned by walk\n    }\n}\n</code></pre>\n\n<p>I am wondering how I could quit all of these goroutines--i.e. close <code>ch</code>--once I have found a node of a certain type or some other condition has been fulfilled. I have tried using a <code>quit</code> channel that'd be polled before spawning the new goroutines and close <code>ch</code> if a value was received but that lead to race conditions where some goroutines tried sending on the channel that had just been closed by another one. I was pondering using a mutex but it seems inelegant and against the spirit of go to protect a channel with a mutex. Is there an idiomatic way to do this using channels? If not, is there any way at all? Any input appreciated!</p>\n"}, {"tags": ["go", "protocol-buffers"], "owner": {"reputation": 1376, "user_id": 326174, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/44cecdf8f3ed94d8f5bc063d4e8d9d3a?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/326174/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 343, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1558137080, "creation_date": 1558137080, "question_id": 56194833, "link": "https://stackoverflow.com/questions/56194833/how-to-use-enumvalueoptions-in-protobuf", "title": "How to use EnumValueOptions in protobuf", "body": "<p>I'm trying to use the custom options feature in protobuf. I'm not sure if I'm creating the custom option incorrectly, or if I'm trying to retrieve the option incorrectly.</p>\n\n<p>Here's my proto definition:</p>\n\n<pre><code>syntax = \"proto3\";\n\nimport \"google/protobuf/descriptor.proto\";\n\npackage common;\n\nmessage Foo {\n    EventType event_type = 1;\n}\n\nenum AuditEventType {\n    AuditEventDefault = 0;\n    AuditEventError = 1;\n    AuditEventInfo = 2;\n}\n\nenum EventType { \n    Undefined = 0;\n    AuditSourceType.Pearl)]\n    Lead = 1 [(audit_event_type) = AuditEventInfo];\n}\n\nextend google.protobuf.EnumValueOptions {\n    AuditEventType audit_event_type = 50000;\n} \n</code></pre>\n\n<p>So in my code, how would I get the the <code>audit_event_type</code> from the <code>event_type</code> field on <code>Foo</code>?</p>\n\n<p>I see examples like such:</p>\n\n<pre><code>func TestExtension(t *testing.T) {\n    foo := &amp;Foo{\n        EventType: EventType_Lead,\n    }\n\n    _, md := descriptor.ForMessage(foo)\n\n    auditEvent, err := proto.GetExtension(md.Options, E_AuditEventType)\n    if err != nil {\n        t.Error(\"error:\", err)\n    }\n    t.Log(auditEvent)\n}\n</code></pre>\n\n<p>But I get an error:</p>\n\n<pre><code>error: proto: nil *descriptor.MessageOptions is not extendable\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1558167946, "post_id": 56194388, "comment_id": 99018071, "body": "your code does not seem to reflect the description of your intents (it vaguely resembling your description), too simplistic if i may say. The for loop does not exit when the value is found, it does not look like it returns ASAP to me. It is also weird because you have two channs of the same type to select on, one is enough. I sketched a rewrite of the current op code (<a href=\"https://play.golang.org/p/Y1sKPcqqXPH\" rel=\"nofollow noreferrer\">play.golang.org/p/Y1sKPcqqXPH</a>) to remove all useless artifacts, but i don t think it answers op goal anymore. but overall, yeah, feed a chan with your jobs, read the chan, on value found, cancel and quit early."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1558168036, "post_id": 56194388, "comment_id": 99018088, "body": "there is also more to say, like, if you were to create long running routines, the cancel might never occur because once you found a suitable value you might simply send it out to another chan, or async func call, for more processing without quitting the for loop reading the foo/bar channs."}, {"owner": {"reputation": 1180, "user_id": 6302962, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/efdfc3bfc2651aebff7bcf20170edae6?s=128&d=identicon&r=PG&f=1", "display_name": "clo_jur", "link": "https://stackoverflow.com/users/6302962/clo-jur"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1558192595, "post_id": 56194388, "comment_id": 99023498, "body": "@mh-cbon maybe I&#39;m missing something, but your solution doesn&#39;t seem to work either. I need multiple channels, because if I don&#39;t cancel, then I need to know which value came from which channel, no? You are correct that I don&#39;t terminate the for loop, which was an oversight. But the code does return each result as soon as it&#39;s available (within the for loop, not from the function). I think my statement of &quot;returning as soon as possible&quot; was not the best way to phrase it. I just mean a non-blocking operation that returns results as they available so that I can eventually cancel out of the loop."}, {"owner": {"reputation": 1180, "user_id": 6302962, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/efdfc3bfc2651aebff7bcf20170edae6?s=128&d=identicon&r=PG&f=1", "display_name": "clo_jur", "link": "https://stackoverflow.com/users/6302962/clo-jur"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1558193184, "post_id": 56194388, "comment_id": 99023632, "body": "@mh-cbon as long as you take care of closing the channels, your <code>done</code> flag can just be replaced by setting all the channels to <code>nil</code> and terminating the loop. The for loop should only exit when all values are found or one of the channels returns a boolean I don&#39;t want. I feel like I&#39;m still missing something though give your responses, so please lmk if I still have some oversights."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1558215056, "post_id": 56194388, "comment_id": 99028489, "body": "true, my example was not correct. you can try something like this <a href=\"https://play.golang.org/p/MAhatd8a5IE\" rel=\"nofollow noreferrer\">play.golang.org/p/MAhatd8a5IE</a> I think i missed things like the time.Sleep before the context check, and i thought the waitgroup was dispensable. fixed now!"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1558344061, "last_edit_date": 1558344061, "creation_date": 1558339358, "answer_id": 56216609, "question_id": 56194388, "link": "https://stackoverflow.com/questions/56194388/golang-design-pattern-for-cancelling-routines-inflight/56216609#56216609", "title": "golang design pattern for cancelling routines inflight", "body": "<p>I would use a single channel to communicate results, so it's much easier to gather the results and it \"scales\" automatically by its nature. If you need to identify the source of a result, simply use a wrapper which includes the source. Something like this:</p>\n\n<pre><code>type Result struct {\n    ID     string\n    Result bool\n}\n</code></pre>\n\n<p>To simulate \"real\" work, the workers should use a loop doing their work in an iterative manner, and in each iteration they should check the cancellation signal. Something like this:</p>\n\n<pre><code>func foo(ctx context.Context, pretendWorkMs int, resch chan&lt;- Result) {\n    log.Printf(\"foo started...\")\n    for i := 0; i &lt; pretendWorkMs; i++ {\n        time.Sleep(time.Millisecond)\n        select {\n        case &lt;-ctx.Done():\n            log.Printf(\"foo terminated.\")\n            return\n        default:\n        }\n    }\n    log.Printf(\"foo finished\")\n    resch &lt;- Result{ID: \"foo\", Result: false}\n}\n</code></pre>\n\n<p>In our example the <code>bar()</code> is the same just replace all <code>foo</code> word with <code>bar</code>.</p>\n\n<p>And now executing the jobs and terminating the rest early if one does meet our expectation looks like this:</p>\n\n<pre><code>ctx, cancel := context.WithCancel(context.Background())\ndefer cancel()\n\nresch := make(chan Result, 2)\n\nlog.Println(\"Kicking off workers...\")\ngo foo(ctx, 3000, resch)\ngo bar(ctx, 5000, resch)\n\nfor i := 0; i &lt; cap(resch); i++ {\n    result := &lt;-resch\n    log.Printf(\"Result of %s: %v\", result.ID, result.Result)\n    if !result.Result {\n        cancel()\n        break\n    }\n}\nlog.Println(\"Done.\")\n</code></pre>\n\n<p>Running this app will output (try it on the <a href=\"https://play.golang.org/p/93NfdJIsM2y\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>2009/11/10 23:00:00 Kicking off workers...\n2009/11/10 23:00:00 bar started...\n2009/11/10 23:00:00 foo started...\n2009/11/10 23:00:03 foo finished\n2009/11/10 23:00:03 Result of foo: false\n2009/11/10 23:00:03 Done.\n</code></pre>\n\n<p>Some things to note. If we terminate early due to unexpected result, the <code>cancel()</code> function will be called, and we break out form the loop. It may be the rest of the workers also complete their work concurrently and send their result, which will not be a problem as we used a buffered channel, so their send will not block and they will end properly. Also, if they don't complete concurrently, they check <code>ctx.Done()</code> in their loop, and they terminate early, so the goroutines are cleaned up nicely.</p>\n\n<p>Also note that the output of the above code does not print <code>bar terminated</code>. This is because the <code>main()</code> function terminates right after the loop, and once the <code>main()</code> function ends, it does not wait for other non-<code>main</code> goroutines to complete. For details, see <a href=\"https://stackoverflow.com/questions/28958192/no-output-from-goroutine-in-go/28958240#28958240\">No output from goroutine in Go</a>. If the app would not terminate immediately, we would see that line printed too. If we add a <code>time.Sleep()</code> at the end of <code>main()</code>:</p>\n\n<pre><code>log.Println(\"Done.\")\ntime.Sleep(3 * time.Millisecond)\n</code></pre>\n\n<p>Output will be (try it on the <a href=\"https://play.golang.org/p/Ix-g2yK6pHX\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>2009/11/10 23:00:00 Kicking off workers...\n2009/11/10 23:00:00 bar started...\n2009/11/10 23:00:00 foo started...\n2009/11/10 23:00:03 foo finished\n2009/11/10 23:00:03 Result of foo: false\n2009/11/10 23:00:03 Done.\n2009/11/10 23:00:03 bar terminated.\n</code></pre>\n\n<p>Now if you must wait for all workers to end either \"normally\" or \"early\" before moving on, you can achieve that in many ways.</p>\n\n<p>One way is to use a <code>sync.WaitGroup</code>. For an example, see <a href=\"https://stackoverflow.com/questions/42752705/prevent-the-main-function-from-terminating-before-goroutines-finish-in-golang/42753005#42753005\">Prevent the main() function from terminating before goroutines finish in Golang</a>. Another way would be to have each worker send a <code>Result</code> no matter how they end, and <code>Result</code> could contain the termination condition, e.g. <code>normal</code> or <code>aborted</code>. And the <code>main()</code> goroutine could continue the receive loop until it receives <code>n</code> values from <code>resch</code>. If this solution is chosen, you must ensure each worker sends a value (even if a panic occurs) to not block the <code>main()</code> in such cases (e.g. with using <code>defer</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 22, "user_id": 5758985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdd9d2c160a9d84cd2871a2cac125c1d?s=128&d=identicon&r=PG", "display_name": "Max Kerper", "link": "https://stackoverflow.com/users/5758985/max-kerper"}, "edited": false, "score": 0, "creation_date": 1565991777, "post_id": 56222630, "comment_id": 101528833, "body": "Unfortunately, I do not have a high enough reputation to comment on the accepted solution above, but it has a memory leak @icza. You must write back the result at the same time as you check the quit channel using a select block.  If you first check the quit channel and afterwards try writing to the result channel, you risk the result channel being closed in between those operations, which would block your go routine forever and cause a memory leak."}], "tags": [], "owner": {"reputation": 22, "user_id": 5758985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdd9d2c160a9d84cd2871a2cac125c1d?s=128&d=identicon&r=PG", "display_name": "Max Kerper", "link": "https://stackoverflow.com/users/5758985/max-kerper"}, "is_accepted": false, "score": -1, "last_activity_date": 1558361143, "creation_date": 1558361143, "answer_id": 56222630, "question_id": 56194388, "link": "https://stackoverflow.com/questions/56194388/golang-design-pattern-for-cancelling-routines-inflight/56222630#56222630", "title": "golang design pattern for cancelling routines inflight", "body": "<p>I'm going to share the most simplistic pattern for what you're talking about. You can extend it for more complicated scenarios.</p>\n\n<pre><code>func doStuff() {\n    // This can be a chan of anything.\n    msgCh := make(chan string)\n\n    // This is how you tell your go-routine(s) to stop, by closing this chan.\n    quitCh := make(chan struct{})\n    defer close(quitCh)\n\n    // Start all go routines.\n    for whileStart() {\n        go func() {\n            // Do w/e you need inside of your go-routine.\n\n            // Write back the result.\n            select {\n            case msgCh &lt;- \"my message\":\n                // If we got here then the chan is open.\n            case &lt;-quitCh:\n                // If we got here then the quit chan was closed.\n            }\n        }()\n    }\n\n    // Wait for all go routines.\n    for whileWait() {\n        // Block until a msg comes back.\n        msg := &lt;-msgCh\n        // If you found what you want.\n        if msg == stopMe {\n            // It's safe to return because of the defer earlier.\n            return\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1180, "user_id": 6302962, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/efdfc3bfc2651aebff7bcf20170edae6?s=128&d=identicon&r=PG&f=1", "display_name": "clo_jur", "link": "https://stackoverflow.com/users/6302962/clo-jur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 0, "accepted_answer_id": 56216609, "answer_count": 2, "score": 6, "last_activity_date": 1558361143, "creation_date": 1558132949, "question_id": 56194388, "link": "https://stackoverflow.com/questions/56194388/golang-design-pattern-for-cancelling-routines-inflight", "title": "golang design pattern for cancelling routines inflight", "body": "<p>I am a golang newbie who is trying to understand the correct design pattern for this problem. My current solution seems <em>very</em> verbose, and I'm not sure what the better approach would be.</p>\n\n<p>I am trying to design a system that:</p>\n\n<ol>\n<li>executes N goroutines</li>\n<li>returns the result of each goroutine as soon as it is available</li>\n<li>if a goroutine returns a particular value, it should kill other goroutines will cancel.</li>\n</ol>\n\n<p><strong>The goal</strong>: I want to kick off a number of goroutines, but I want to cancel the routines if one routine returns a particular result.</p>\n\n<p>I'm trying to understand if my code is super \"smelly\" or if this is the prescribed way of doing things. I still don't have a great feeling for go, so any help would be appreciated.</p>\n\n<p>Here is what I've written:</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n\n    ctx := context.Background()\n    ctx, cancel := context.WithCancel(ctx)\n\n    fooCheck := make(chan bool)\n    barCheck := make(chan bool)\n\n    go foo(ctx, 3000, fooCheck)\n    go bar(ctx, 5000, barCheck)\n\n    for fooCheck != nil ||\n        barCheck != nil {\n        select {\n        case res, ok := &lt;-fooCheck:\n            if !ok {\n                fooCheck = nil\n                continue\n            }\n            if res == false {\n                cancel()\n            }\n            fmt.Printf(\"result of foocheck: %t\\n\", res)\n        case res, ok := &lt;-barCheck:\n            if !ok {\n                barCheck = nil\n                continue\n            }\n            fmt.Printf(\"result of barcheck: %t\\n\", res)\n        }\n    }\n    fmt.Printf(\"here we are at the end of the loop, ready to do some more processing...\")\n}\n\nfunc foo(ctx context.Context, pretendWorkTime int, in chan&lt;- bool) {\n    fmt.Printf(\"simulate doing foo work and pass ctx down to cancel down the calltree\\n\")\n    time.Sleep(time.Millisecond * time.Duration(pretendWorkTime))\n\n    select {\n    case &lt;-ctx.Done():\n        fmt.Printf(\"\\n\\nWe cancelled this operation!\\n\\n\")\n        break\n    default:\n        fmt.Printf(\"we have done some foo work!\\n\")\n        in &lt;- false\n    }\n    close(in)\n}\n\nfunc bar(ctx context.Context, pretendWorkTime int, in chan&lt;- bool) {\n    fmt.Printf(\"simulate doing bar work and pass ctx down to cancel down the calltree\\n\")\n    time.Sleep(time.Millisecond * time.Duration(pretendWorkTime))\n\n    select {\n    case &lt;-ctx.Done():\n        fmt.Printf(\"\\n\\nWe cancelled the bar operation!\\n\\n\")\n        break\n    default:\n        fmt.Printf(\"we have done some bar work!\\n\")\n        in &lt;- true\n    }\n    close(in)\n}\n</code></pre>\n\n<p>(play with the code here: <a href=\"https://play.golang.org/p/HAA-LIxWNt0\" rel=\"noreferrer\">https://play.golang.org/p/HAA-LIxWNt0</a>)</p>\n\n<p>The output works as expected, but I'm afraid I'm making some decision which will blow off my foot later.</p>\n"}]