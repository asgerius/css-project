[{"tags": ["reflection", "go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1444862479, "post_id": 33136669, "comment_id": 54085228, "body": "Is this supposed to be a method that works for the general case? If not, convention would be to define a constructor in the package, do the assignment in there and return a new instance. It would be like <code>func NewStoreObject(store map[string]string) StoreObject, error</code>. If you&#39;re looking for a generalized solution you&#39;re asking a lot. But I can give an explanation of that as well I suppose. It would just be to reflect the types on the struct, index the map based on the field name, switch on the struct fields type, in each case you have code to do conversion and assignment."}, {"owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1444862649, "post_id": 33136669, "comment_id": 54085301, "body": "@evanmcdonnal Hello! This is not meant for a general use case, but specific. I&#39;ll now exactly wich types are used in the structs, so will only do the convestion for those types, but still i will need to test the reflect.Type i guess. The map won&#39;t be passed as an argument, it comes from elsewhere, but the prototype you suggest is what i thought."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1444862898, "post_id": 33136669, "comment_id": 54085404, "body": "ummm that doesn&#39;t really fit with either paradigm. If you are using reflection, I expect you to use it to decide which values are set on which fields at run time. If you write code that at compile time says <code>thisType.Name = storeMap[&quot;name&quot;]</code> then you may as well be using the constructor type paradigm I described because you will have a special case for every type, just like if they all had their own constructor methods that took in the map and returned the instance. If you want a single method like <code>ConvertoObject(store Store) interface{}</code> then using reflection is justified."}, {"owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1444863337, "post_id": 33136669, "comment_id": 54085592, "body": "@evanmcdonnal I understand your point. I thought it would be much &#39;cleaner&#39; than writting a big constructor block. Could you please still expand on the reflection solution with a general approach, so i could learn about that?"}], "answers": [{"comments": [{"owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "edited": false, "score": 0, "creation_date": 1444864901, "post_id": 33137251, "comment_id": 54086063, "body": "Thank you very much for this clear answer. I understood the approach and it is much more concise in my head with this explanation."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1444865198, "post_id": 33137251, "comment_id": 54086149, "body": "RE: building a generalised method - it may be saner to use something like <a href=\"https://github.com/mitchellh/mapstructure\" rel=\"nofollow noreferrer\">github.com/mitchellh/mapstructure</a> rather than rolling your own. The reflect package can be brittle (due to its nature) to work with."}, {"owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1444865892, "post_id": 33137251, "comment_id": 54086335, "body": "@elithrar This is looking like exactly what i need. I will look onto this to increase the accepted answer. Thanks!"}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 4, "last_activity_date": 1544292265, "last_edit_date": 1544292265, "creation_date": 1444864553, "answer_id": 33137251, "question_id": 33136669, "link": "https://stackoverflow.com/questions/33136669/fill-a-struct-from-a-map-with-reflection/33137251#33137251", "title": "Fill a struct from a map with reflection", "body": "<p>To avoid some extended discussion in comments I'm just going to make an answer explaining the two approaches I would choose from. Generally speaking, I would avoid the reflective method. There are cases where it is called for but most of the time the more verbose, literal, simple code will be better, even if it's a few more lines and there is some overlap between what the methods do.</p>\n\n<p>So, starting with the simple example. Suppose you got 3 types, <code>GroceryStore</code>, <code>ComputerStore</code>, and <code>CornerStore</code>. In whatever package each type is defined in, it is fairly common to define some constructor like methods (they're not technically constructors, just package scoped methods that instantiate a type and return it but same purpose). So an example would be;</p>\n\n<pre><code>func NewComputerStore(store Store) *ComputerStore {\n      return &amp;ComputerStore{\n            Name: store[\"Name\"],\n            Location: store[\"Location\"],\n            //ect\n      }\n}\n</code></pre>\n\n<p>Of course the example above is completely unsafe. In reality you need to use the <code>v, ok := myMape[\"key\"]</code> syntax and then assign if <code>ok</code> and do whatever if not (probably some combination of assign default value, log error, and throw error).</p>\n\n<p>Now if you want a generalized method... It typically look something more like this (note this is untested and is more pseudo code than a working example);</p>\n\n<pre><code>func (s *Store) ConvertToObject(obj interface{}) error {\n    val := reflect.ValueOf(obj)\n    for i := 0; i &lt; val.NumField(); i++ {\n        switch v := val.Field(i).(type) {\n        case int64:\n            val.Field(i).SetInt(strconv.Atoi(s[val.Field(i).Name]))\n        }\n    }\n}\n</code></pre>\n\n<p>So the basic idea of the code above is this. You're starting with a store map. The caller knows what type that map is supposed to be. They call this method passing a new instance of that type. In the method we don't really care what the type is, we care what the type of it's fields are. So I iterate all the fields on the object passed in. Each field is put through the type switch (since I'll need a string to X conversion for every type that is present in the structs this method should work with, or at least a decent base case), in the case for each type you can do assignment using the field name to look up it's value in the <code>Store</code> map and converting from string to X.</p>\n\n<p>Hope that makes sense. I can follow up if it doesn't really clarify the approach. Remember the code above is not intended to run. Also, I've ignored all error handling which you will need <strong>lots</strong> of to make a generalized function work (what to do if conversion fails? What if type isn't recognized? What about all the other possible errors that won't be common place?).</p>\n"}], "owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1748, "favorite_count": 0, "accepted_answer_id": 33137251, "answer_count": 1, "score": 2, "last_activity_date": 1544292265, "creation_date": 1444861529, "last_edit_date": 1444861903, "question_id": 33136669, "link": "https://stackoverflow.com/questions/33136669/fill-a-struct-from-a-map-with-reflection", "title": "Fill a struct from a map with reflection", "body": "<p>I have a map of this kind\n<code>type Store map[string]string</code></p>\n\n<p>From this map, i would like to fill a struct. The goal is, for each field of the struct, find the key that match the field name, take the value, and based on the type of the struct field, convert the value to the proper struct field type and set it.</p>\n\n<p>Basically the map will contains integers, booleans, strings and durations as strings so the convestion should be simply <code>strconv.atoi()</code>, <code>time.parseDuration()</code> ...</p>\n\n<p>Also, i would like to use the structs tags to specify the name of the key in the map, because the struct field will be likely camelCase, while the keys in the map will be like this \"example_key\"</p>\n\n<p>Any idea of how doing this. I have read about golang reflection but it is still opaque for me. I would just need an explanation to approach the problem, and then i think i can handle the implementation by my own.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 1615, "user_id": 1376205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ff8ba613f2dc50cc30e7f3af3e2914?s=128&d=identicon&r=PG", "display_name": "Will C", "link": "https://stackoverflow.com/users/1376205/will-c"}, "edited": false, "score": 1, "creation_date": 1444874401, "post_id": 33135375, "comment_id": 54088325, "body": "Auto-incrementing in MongoDB tends to be a bad practice because it doesn&#39;t scale well. It kind of defeats the purpose of using it. There&#39;s a reason why the default is not an auto-incrementing primary key value. Is there something you have in mind that you want to achieve that can only be done by auto-incrementing the ids?"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 1615, "user_id": 1376205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ff8ba613f2dc50cc30e7f3af3e2914?s=128&d=identicon&r=PG", "display_name": "Will C", "link": "https://stackoverflow.com/users/1376205/will-c"}, "edited": false, "score": 0, "creation_date": 1445819566, "post_id": 33135375, "comment_id": 54470115, "body": "I could not agree more with @WillC . Furthermore: <code>_id</code> is immutable. When you &quot;change&quot; it, you effectively create a new document. In the case you really need a counter (for example for optimistic locking), you should use  the <code>$inc</code> operator on a field which is <i>not</i> <code>_id</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1920, "user_id": 4980029, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5fxH7.png?s=128&g=1", "display_name": "Vrushank Doshi", "link": "https://stackoverflow.com/users/4980029/vrushank-doshi"}, "edited": false, "score": 1, "creation_date": 1444860453, "post_id": 33136037, "comment_id": 54084397, "body": "i tried the same thing but the field does not seem to increment."}, {"owner": {"reputation": 4635, "user_id": 1411589, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2a6b1a1c31198db776d76af7f04c1bbd?s=128&d=identicon&r=PG", "display_name": "deepakssn", "link": "https://stackoverflow.com/users/1411589/deepakssn"}, "edited": false, "score": 0, "creation_date": 1495706057, "post_id": 33136037, "comment_id": 75369364, "body": "Helped me a lot! Thanks!"}], "tags": [], "owner": {"reputation": 3818, "user_id": 1247113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRMFj.png?s=128&g=1", "display_name": "rob74", "link": "https://stackoverflow.com/users/1247113/rob74"}, "is_accepted": false, "score": 4, "last_activity_date": 1444858713, "creation_date": 1444858713, "answer_id": 33136037, "question_id": 33135375, "link": "https://stackoverflow.com/questions/33135375/how-to-auto-increment-id-field-of-mongodb-with-golang-mgo-driver/33136037#33136037", "title": "How to auto-increment id field of mongodb with golang mgo driver?", "body": "<p>According to the mgo package documentation, you can use <a href=\"https://godoc.org/labix.org/v2/mgo#Query.Apply\" rel=\"nofollow\">Query.Apply</a> for that. I haven't tried it myself, but the example given there seems to already do what you want to achieve:</p>\n\n<pre><code> change := mgo.Change{\n         Update: bson.M{\"$inc\": bson.M{\"n\": 1}},\n         ReturnNew: true,\n }\n info, err = col.Find(M{\"_id\": id}).Apply(change, &amp;doc)\n fmt.Println(doc.N)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1522145109, "post_id": 39121325, "comment_id": 86024000, "body": "This does not provide safety if 2 concurrent goroutines query the total count and attempt to insert a new document, they will use the same ID."}], "tags": [], "owner": {"reputation": 58, "user_id": 3173409, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d6e363f7845b9b2ab6efbf756c53749d?s=128&d=identicon&r=PG&f=1", "display_name": "Rudys", "link": "https://stackoverflow.com/users/3173409/rudys"}, "is_accepted": false, "score": 1, "last_activity_date": 1472036010, "creation_date": 1472036010, "answer_id": 39121325, "question_id": 33135375, "link": "https://stackoverflow.com/questions/33135375/how-to-auto-increment-id-field-of-mongodb-with-golang-mgo-driver/39121325#39121325", "title": "How to auto-increment id field of mongodb with golang mgo driver?", "body": "<p>Try the below one</p>\n\n<p>Declare one more variable name <code>var total_doc int'</code></p>\n\n<p>Then do <code>collection.Find(bson.M{}).Count(total_doc)</code> this will return the total number of document your have in you mongodb database.</p>\n\n<p>After add <code>doc.Seq = total_doc + 1</code>.This will keep on incrementing the sequence value whenever a new document gets added.</p>\n\n<p>Hope this could help you</p>\n"}, {"tags": [], "owner": {"reputation": 1988, "user_id": 6716410, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbA3G.png?s=128&g=1", "display_name": "sf9v", "link": "https://stackoverflow.com/users/6716410/sf9v"}, "is_accepted": false, "score": 1, "last_activity_date": 1508076264, "creation_date": 1508076264, "answer_id": 46755905, "question_id": 33135375, "link": "https://stackoverflow.com/questions/33135375/how-to-auto-increment-id-field-of-mongodb-with-golang-mgo-driver/46755905#46755905", "title": "How to auto-increment id field of mongodb with golang mgo driver?", "body": "<p>Might be late but you can also use <a href=\"https://github.com/night-codes/mgo-ai\" rel=\"nofollow noreferrer\">night-codes/mgo-ai</a> package to manage your sequences.</p>\n\n<p>I personally used this, I created a separate <code>sequences</code> collection to store the incremented values. I also kept the <code>_id</code> field and had a separate <code>id</code> field for my <code>sequence</code> value.</p>\n\n<p>From its <code>README.md</code>:</p>\n\n<pre><code>    package main\n\n    import (\n        \"github.com/night-codes/mgo-ai\"\n        \"gopkg.in/mgo.v2\"\n        \"gopkg.in/mgo.v2/bson\"\n    )\n\n    func main() {\n        session, err := mgo.Dial(\"localhost\")\n        if err != nil {\n            panic(err)\n        }\n\n        // connect AutoIncrement to collection \"counters\"\n        ai.Connect(session.DB(\"example-db\").C(\"counters\"))\n\n        // ...\n\n        // use AutoIncrement\n        session.DB(\"example-db\").C(\"users\").Insert(bson.M{\n            \"_id\":   ai.Next(\"users\"),\n            \"login\": \"test\",\n            \"age\":   32,\n\n    }\n</code></pre>\n"}], "owner": {"reputation": 1920, "user_id": 4980029, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5fxH7.png?s=128&g=1", "display_name": "Vrushank Doshi", "link": "https://stackoverflow.com/users/4980029/vrushank-doshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6032, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1508076264, "creation_date": 1444855931, "last_edit_date": 1444860933, "question_id": 33135375, "link": "https://stackoverflow.com/questions/33135375/how-to-auto-increment-id-field-of-mongodb-with-golang-mgo-driver", "title": "How to auto-increment id field of mongodb with golang mgo driver?", "body": "<p>I am new to mongodb and golang. In one of my project i want to connect mongo with go. I am using mgo.v2 driver for connecting mongo with go. My question is:\nHow can i auto-increment the _id field of my document so that whenever i try to perform POST operation, it should auto increment the _id field of the document ?\nI want to implement something similar to \"FindAndModify\" function but i don't see this function in go. \nThis is what i want to try in go. \n<a href=\"http://docs.mongodb.org/manual/tutorial/create-an-auto-incrementing-field/\" rel=\"nofollow\">Auto increment id in mongodb</a></p>\n\n<pre><code>    type count struct {\n        ID  string `bson:\"_id\"`\n        Seq int    `bson:\"seq\"`\n    }\n\n    var doc count\n\n    func get NextSequence(name string) int{\n    change := mgo.Change{\n            Update:    collection.Update(count{ID: \"userid\"}, bson.M{\"$inc\": count{Seq: 1}}),\n            ReturnNew: true,\n        }\n\n        _, err1 := collection.Find(bson.M{}).Apply(change, &amp;doc)\n       return doc.Seq\n   }\n\n    func main(){\n        fmt.Println(getNextSequence(\"userid\"))\n        fmt.Println(getNextSequence(\"userid\"))\n        doc2 := msg{ID: getNextSequence(\"userid\"), Name: \"Sarah\"}\n        doc3 := msg{ID: getNextSequence(\"userid\"), Name: \"Sarah2\"}\n    }\n</code></pre>\n\n<p>I tried the above code, but the value of Seq does not seem to increment.It gives me 0 everytime i make a call to the function.\nThanks for the help.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 3, "creation_date": 1444849119, "post_id": 33130949, "comment_id": 54078413, "body": "yes, convert to uint64 or int64, then encode to string."}, {"owner": {"reputation": 1230, "user_id": 3651739, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/D0irV.gif?s=128&g=1", "display_name": "Jishnu Prathap", "link": "https://stackoverflow.com/users/3651739/jishnu-prathap"}, "edited": false, "score": 0, "creation_date": 1481363050, "post_id": 33130949, "comment_id": 69354728, "body": "Use fmt.Sprintf() to convert any integer type to string"}, {"owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 0, "creation_date": 1594206807, "post_id": 33130949, "comment_id": 111043710, "body": "<code>[]byte(s)</code> to set a string to a slice of uint8 or <code>[]rune(s)</code> to set a string to a slice of int32. See <a href=\"https://stackoverflow.com/a/62740786/12817546\">stackoverflow.com/a/62740786/12817546</a>. <code>string([]byte(s))</code> or <code>string([]rune(s))</code> to set a slice of bytes or runes to a string. See <a href=\"https://stackoverflow.com/a/62725637/12817546\">stackoverflow.com/a/62725637/12817546</a> and <a href=\"https://stackoverflow.com/a/62739051/12817546\">stackoverflow.com/a/62739051/12817546</a>."}], "answers": [{"comments": [{"owner": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "edited": false, "score": 7, "creation_date": 1444841913, "post_id": 33131027, "comment_id": 54074233, "body": "<code>ParseInt</code> converts <i>from</i> a string to an integer.   The question is asking about the other direction - converting <i>to</i> a string."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "edited": false, "score": 0, "creation_date": 1444842067, "post_id": 33131027, "comment_id": 54074339, "body": "@zmb I highly doubt that. The issue of size is only relevant when going from a string to the number types. Strings are unbounded in size (except by your cpu&#39;s memory) so I can obviously convert any type of number in the language to a string without having to consider any of this. I also, don&#39;t need to use a special library like <code>strconv</code> the methods in <code>fmt</code> are perfectly sufficient. Lastly, if I have an 32-bit int and a &#39;itoa&#39; method that only works for 64-bit as the OP points out it&#39;s very obvious what needs to be done which is a cast to <code>(int64)</code> which will always succeed..."}, {"owner": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "edited": false, "score": 4, "creation_date": 1444862457, "post_id": 33131027, "comment_id": 54085215, "body": "How doesn&#39;t it?  The question is titled &quot;number to string conversion&quot; and then says &quot;strconv converts int64 and uint64 to string&quot;."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "edited": false, "score": 0, "creation_date": 1444862634, "post_id": 33131027, "comment_id": 54085292, "body": "@zmb I assumed the OP is confused due to that question not making any sense. The amount of bytes occupied by a number obviously has no bearing on the conversion to string... Anyway, in response to your comment I updated to explain conversions in either direction then got downvoted &#175;_(\u30c4)_/&#175;"}, {"owner": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "edited": false, "score": 0, "creation_date": 1444862831, "post_id": 33131027, "comment_id": 54085382, "body": "I think the OP is confused too, just for a different reason.  Perhaps (s)he doesn&#39;t know about the fmt package.  You&#39;ve got my upvote in either case :)"}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 4, "last_activity_date": 1444842859, "last_edit_date": 1444842859, "creation_date": 1444840884, "answer_id": 33131027, "question_id": 33130949, "link": "https://stackoverflow.com/questions/33130949/string-to-number-conversion-in-golang/33131027#33131027", "title": "string to number conversion in golang", "body": "<p>If you look at the docs a bit more closely you can use this method;</p>\n\n<pre><code>func ParseInt(s string, base int, bitSize int)\n</code></pre>\n\n<p><a href=\"https://golang.org/pkg/strconv/#ParseInt\" rel=\"nofollow\">https://golang.org/pkg/strconv/#ParseInt</a></p>\n\n<p>The <code>bitSize</code> argument says how large the int is so you can do <code>8</code> or <code>16</code> or <code>32</code> for those smaller integer types. <code>Atoi</code> calls this internally. I believe you're wanting <code>10</code> for the <code>base</code> argument. So like <code>b, err := strconv.ParseInt(\"5\", 10, 8)</code> for a byte.</p>\n\n<p>EDIT: Just going to add a couple things to the answer here in case the OP is in fact confused how to convert a 16-bit int into a string... If that is your intended goal just use <code>fmt.Sprintf</code> or you can do a conversion from smaller int to larger int as it will always succeed. Examples of both here; <a href=\"https://play.golang.org/p/UWSVxEmQ1N\" rel=\"nofollow\">https://play.golang.org/p/UWSVxEmQ1N</a></p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"strconv\"\n\nfunc main() {\n    var a int16\n    a = 5\n    s := fmt.Sprintf(\"%d\", a)\n    s2 := strconv.Itoa(int(a))\n    fmt.Println(s)\n    fmt.Println(s2)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 3, "last_activity_date": 1444910476, "creation_date": 1444910476, "answer_id": 33148035, "question_id": 33130949, "link": "https://stackoverflow.com/questions/33130949/string-to-number-conversion-in-golang/33148035#33148035", "title": "string to number conversion in golang", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n)\n\nfunc main() {\n    n := int16(42)\n    s := strconv.FormatInt(int64(n), 10)\n    fmt.Printf(\"n %d s %q\\n\", n, s)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>n 42 s \"42\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 0, "creation_date": 1594158092, "post_id": 41074199, "comment_id": 111027579, "body": "Top-notch answer that I quoted. Did I add to it? See <a href=\"https://stackoverflow.com/a/62725637/12817546\">stackoverflow.com/a/62725637/12817546</a>"}], "tags": [], "owner": {"reputation": 1230, "user_id": 3651739, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/D0irV.gif?s=128&g=1", "display_name": "Jishnu Prathap", "link": "https://stackoverflow.com/users/3651739/jishnu-prathap"}, "is_accepted": false, "score": 4, "last_activity_date": 1482984989, "last_edit_date": 1482984989, "creation_date": 1481363305, "answer_id": 41074199, "question_id": 33130949, "link": "https://stackoverflow.com/questions/33130949/string-to-number-conversion-in-golang/41074199#41074199", "title": "string to number conversion in golang", "body": "<p>You can convert any int type to string using fmt.Sprintf() method</p>\n\n<pre><code>var num int64\nnumstring:=fmt.Sprintf(\"%d\",num)\n</code></pre>\n"}], "owner": {"reputation": 1201, "user_id": 651028, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6d5887835c21dace586b98180544c74e?s=128&d=identicon&r=PG", "display_name": "Sergei G", "link": "https://stackoverflow.com/users/651028/sergei-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10896, "favorite_count": 1, "accepted_answer_id": 33131027, "answer_count": 3, "score": 4, "last_activity_date": 1491232384, "creation_date": 1444840643, "last_edit_date": 1491232384, "question_id": 33130949, "link": "https://stackoverflow.com/questions/33130949/string-to-number-conversion-in-golang", "title": "string to number conversion in golang", "body": "<p>Golang has <a href=\"https://golang.org/pkg/strconv/\" rel=\"nofollow noreferrer\">strconv</a> library that converts string to int64 and uint64.</p>\n\n<p>However, the rest of integer data types seems to be unsupported as I can't find conversion functions for byte, int16, uint16, int32, uint32 data types.  </p>\n\n<p>One can always convert from byte, 16-bit and 32-bit data types to int64 and uint64 without loss of precision.  Is that what's intended by language?</p>\n"}, {"tags": ["regex", "go", "word-boundary"], "comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1444832464, "post_id": 33127836, "comment_id": 54067870, "body": "I haven&#39;t played with regex in Go yet, but the common problem here is the <code>\\</code> being used as an escape character both for strings and for the regex engine. It&#39;s probably being gobbled up by the string so the regex engine never sees it. Try double escaping?"}, {"owner": {"reputation": 175, "user_id": 3516147, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8fd0e9cb94a25f7acf9d162e20ba4301?s=128&d=identicon&r=PG&f=1", "display_name": "pritesh", "link": "https://stackoverflow.com/users/3516147/pritesh"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1444832562, "post_id": 33127836, "comment_id": 54067968, "body": "Thank you Adam Smith. solution from Anar-G worked perfectly"}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 3516147, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8fd0e9cb94a25f7acf9d162e20ba4301?s=128&d=identicon&r=PG&f=1", "display_name": "pritesh", "link": "https://stackoverflow.com/users/3516147/pritesh"}, "edited": false, "score": 0, "creation_date": 1444832478, "post_id": 33127869, "comment_id": 54067885, "body": "Awesome, thank you Ainar-G for such a quick reply. It worked perfectly."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1444832514, "post_id": 33127869, "comment_id": 54067917, "body": "enclose the backslash in triple backticks to make the formatting work. In a strange parallel to the question being asked! :)"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 5, "last_activity_date": 1444832478, "last_edit_date": 1444832478, "creation_date": 1444832313, "answer_id": 33127869, "question_id": 33127836, "link": "https://stackoverflow.com/questions/33127836/how-to-use-word-boundry-b-with-regexp-matchstring-in-go/33127869#33127869", "title": "How to use word boundry (\\b) with regexp.MatchString() in go", "body": "<p>Double quotes often swallow the <code>\\</code>. Always use <a href=\"https://golang.org/ref/spec#String_literals\" rel=\"nofollow\">raw strings</a> with regexps, SQL, and such.</p>\n\n<pre><code>filterVal := `(?i)compute\\b`\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/ePzZf5uLtw\" rel=\"nofollow\">http://play.golang.org/p/ePzZf5uLtw</a>.</p>\n"}], "owner": {"reputation": 175, "user_id": 3516147, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8fd0e9cb94a25f7acf9d162e20ba4301?s=128&d=identicon&r=PG&f=1", "display_name": "pritesh", "link": "https://stackoverflow.com/users/3516147/pritesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1518, "favorite_count": 0, "accepted_answer_id": 33127869, "answer_count": 1, "score": 1, "last_activity_date": 1444832478, "creation_date": 1444832215, "question_id": 33127836, "link": "https://stackoverflow.com/questions/33127836/how-to-use-word-boundry-b-with-regexp-matchstring-in-go", "title": "How to use word boundry (\\b) with regexp.MatchString() in go", "body": "<p>I am using a function regexp.matchString() to match regex pattern to my string. I have to use word boundary in order to find exact match. For example, I want to match \"compute\" but not \"computer\". The problem is my string will have both \"compute\" and \"computer\". So I want to use word boundary. I tried using \\b in couple of online go-regex tester and it worked. However, \\b does not seem to work for regexp.matchString() function. Does anyone know if there is an alternate to \\b? or how can I get expected result?\nMy code</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"regexp\"\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n    brandName := \"home;compute furniture;computer\"\n    filterVal := \"(?i)compute\\b\"\n    regexMatch, _ := regexp.MatchString(filterVal, brandName)\n    fmt.Println(regexMatch)\n}\n</code></pre>\n\n<p>This function returns me false when I use \\b. Please help</p>\n"}, {"tags": ["nginx", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1444830239, "post_id": 33126798, "comment_id": 54066221, "body": "There&#39;s no such thing as &quot;directly hosting a go application with nginx&quot;."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1444830295, "post_id": 33126798, "comment_id": 54066264, "body": "I&#39;m not sure what you mean by &quot;Host a go app on nginx.&quot; nginx is a webserver and your app (by definition) is an application. The common thing to do is to have your app listen on a local port (let&#39;s say 4040) and set nginx up in front of it to reverse proxy from remote port 80 to local port 4040 so that your app handles the request."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1444830369, "post_id": 33126798, "comment_id": 54066336, "body": "Similarly telling nginx to use 8 workers means there&#39;s 8 worker threads available to handle JUST THE reverse proxy requests. If you&#39;re getting a lot of requests at once that might be helpful, but since nginx is just serving (pun intended) as a signpost here, it&#39;s probably unnecessary. Golang&#39;s workers are entirely separate from nginx&#39;s."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1444832487, "post_id": 33127403, "comment_id": 54067894, "body": "Also note that FastCGI is a pre-http/1.1 relic. Go&#39;s http/1.1 server is far faster and more efficient than the fcgi implementation."}, {"owner": {"reputation": 443, "user_id": 3434403, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c0c0a9e47077644ff4b6fc39b7e0ff8?s=128&d=identicon&r=PG&f=1", "display_name": "affo", "link": "https://stackoverflow.com/users/3434403/affo"}, "edited": false, "score": 0, "creation_date": 1444836944, "post_id": 33127403, "comment_id": 54071130, "body": "Perfect. I think I was misunderstanding the relationship web/application server. The first bullet list someway cleared my mind. Can you please rephrase &quot;That would suggest FastCGI, which I believe...&quot;? Did you mean &quot;That would affect...&quot;? Thank you"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1444866450, "post_id": 33127403, "comment_id": 54086463, "body": "I think there was some confusion between nginx workers (which are independant of whatever backend you&#39;re using) and FastCGI workers, which aren&#39;t related. The worker count you set in nginx is entirely dependent on your hardware and performance requirements, but having multiple nginx workers proxying to one Go backend is <i>not</i> a problem (it &quot;just works&quot;)."}, {"owner": {"reputation": 443, "user_id": 3434403, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c0c0a9e47077644ff4b6fc39b7e0ff8?s=128&d=identicon&r=PG&f=1", "display_name": "affo", "link": "https://stackoverflow.com/users/3434403/affo"}, "edited": false, "score": 0, "creation_date": 1444904043, "post_id": 33127403, "comment_id": 54101108, "body": "My consideration is another one. I&#39;ll try to explain better:   Say you have nginx and a nodejs backend.   Node is single threaded and will use a thread at a time to process requests.    Now, if I tell nginx &quot;Use 8 workers&quot; I think it is not a great deal. I will need to spawn 8 backends and load-balance them with nginx to achieve what I meant telling nginx &quot;Use 8 workers&quot;. Is it clearer?"}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": true, "score": 3, "last_activity_date": 1444831142, "creation_date": 1444831142, "answer_id": 33127403, "question_id": 33126798, "link": "https://stackoverflow.com/questions/33126798/golang-app-nginx-reverse-proxy-vs-nginx-host/33127403#33127403", "title": "Go(lang) app: nginx reverse proxy VS nginx host", "body": "<blockquote>\n  <p>Is it possible to directly host a go app on nginx</p>\n</blockquote>\n\n<p>Nginx can communicate with its backend (your app) through various different mechanisms. Some of them are:</p>\n\n<ul>\n<li>Via CGI/FastCGI (process multiplexing)</li>\n<li>Via HTTP (reverse proxying)</li>\n<li>Serving static files which your app produced</li>\n</ul>\n\n<blockquote>\n  <p>does the different approaches affects the configuration someway?</p>\n</blockquote>\n\n<p>Yes, each case is very different.</p>\n\n<blockquote>\n  <p>Ok, use 8 workers, please</p>\n</blockquote>\n\n<p>That would suggest FastCGI, which I believe is what you mean when you say \"directly hosting an application on nginx\".</p>\n\n<blockquote>\n  <p>telling nothing to go's internal webserver... What would happen?</p>\n</blockquote>\n\n<p>Each Go FastCGI process would spawn a lot of goroutines, which are multiplexed to software threads, which are multiplexed to hardware threads, which are multiplexed to CPU cores.</p>\n\n<p>Go's <code>net/http</code> server is good enough for a production environment, you don't necessarily need nginx unless you want to use some nginx-specific feature. There are only so many use cases where a FastCGI setup makes sense. You just add overhead, basically.</p>\n"}, {"tags": [], "owner": {"reputation": 106259, "user_id": 51197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/QG9pG.jpg?s=128&g=1", "display_name": "Adam Matan", "link": "https://stackoverflow.com/users/51197/adam-matan"}, "is_accepted": false, "score": 5, "last_activity_date": 1471756173, "creation_date": 1471756173, "answer_id": 39061006, "question_id": 33126798, "link": "https://stackoverflow.com/questions/33126798/golang-app-nginx-reverse-proxy-vs-nginx-host/39061006#39061006", "title": "Go(lang) app: nginx reverse proxy VS nginx host", "body": "<p><a href=\"https://github.com/hgfischer\" rel=\"noreferrer\">Herbert Fischer</a> wrote a <a href=\"https://gist.github.com/hgfischer/7965620\" rel=\"noreferrer\">comprehensive benchmark of Nginx with Go</a>, including NGinx configuration files and Go code. </p>\n\n<p>He checked the following settings:</p>\n\n<ul>\n<li>Go HTTP standalone (as the control group) </li>\n<li>Nginx proxy to Go HTTP</li>\n<li>Nginx fastcgi to Go TCP FastCGI </li>\n<li>Nginx fastcgi to Go Unix Socket FastCGI</li>\n</ul>\n\n<p>Nginx proxy to Go HTTP was, by far, the fastest. The results were pretty much the same in Go versions since 1.2.</p>\n"}], "owner": {"reputation": 443, "user_id": 3434403, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c0c0a9e47077644ff4b6fc39b7e0ff8?s=128&d=identicon&r=PG&f=1", "display_name": "affo", "link": "https://stackoverflow.com/users/3434403/affo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4473, "favorite_count": 0, "accepted_answer_id": 33127403, "answer_count": 2, "score": 3, "last_activity_date": 1471756173, "creation_date": 1444829573, "last_edit_date": 1495541385, "question_id": 33126798, "link": "https://stackoverflow.com/questions/33126798/golang-app-nginx-reverse-proxy-vs-nginx-host", "title": "Go(lang) app: nginx reverse proxy VS nginx host", "body": "<p>I have already read some of the <a href=\"https://stackoverflow.com/questions/17440415/golang-production-web-application-configuration/17461472#17461472\">questions</a> about <strong>go</strong> and <strong>nginx</strong> but I didn't find any answer to my one.</p>\n\n<p>I think (i'm not an expert) that using nginx as a reverse proxy in front of a <code>net/http</code> go server is different as directly hosting your go application with nginx.<br>\nShout at me if I'm wrong, ok?</p>\n\n<p>The question came to me because I need to develop an application (possibly with go, just to learn something new) and have total control on the webserver, especially on the number of workers it uses to answer requests.</p>\n\n<p>So, here come the questions:</p>\n\n<ol>\n<li><p>Is it possible to directly host a go app on nginx, or is it nginx that only serves static files (if the answer is \"NO\", then the second question doesn't make much sense)?</p></li>\n<li><p>What are the key differences between the two approaches above, precisely, does the different approaches affects the configuration someway?</p></li>\n<li><p>I am scared about telling nginx: \"Ok, use 8 workers, please\" and telling nothing to go's internal webserver... What would happen?</p></li>\n</ol>\n\n<p>Thank you so much in advance</p>\n"}, {"tags": ["string", "time", "go"], "comments": [{"owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "edited": false, "score": 0, "creation_date": 1444831185, "post_id": 33119748, "comment_id": 54066948, "body": "It is worth highlighting the fact the compiler error describes the error completely. You cannot put a type Time in an array of a strings."}, {"owner": {"reputation": 549, "user_id": 611527, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d8eae5f2829023af325878239f0adc5c?s=128&d=identicon&r=PG", "display_name": "Oleksandr Savchenko", "link": "https://stackoverflow.com/users/611527/oleksandr-savchenko"}, "edited": false, "score": 0, "creation_date": 1494503874, "post_id": 33119748, "comment_id": 74862576, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/20234104/how-to-format-current-time-using-a-yyyymmddhhmmss-format\">How to format current time using a yyyyMMddHHmmss format?</a>"}, {"owner": {"reputation": 1101, "user_id": 1141160, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/28cd1684b890b0351f37a5a592f2d53b?s=128&d=identicon&r=PG", "display_name": "Mark Robson", "link": "https://stackoverflow.com/users/1141160/mark-robson"}, "edited": false, "score": 0, "creation_date": 1604327100, "post_id": 33119748, "comment_id": 114306065, "body": "I couldn&#39;t get some of the suggestions working, I used <code>time.Now().String()</code> for now"}], "answers": [{"comments": [{"owner": {"reputation": 926, "user_id": 2760325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0acf8a8895f6f9da5c0f202e8975a61d?s=128&d=identicon&r=PG", "display_name": "Ahmed Essam", "link": "https://stackoverflow.com/users/2760325/ahmed-essam"}, "edited": false, "score": 24, "creation_date": 1483549409, "post_id": 33119937, "comment_id": 70144458, "body": "Just to make clear. In order to pass a custom time format, you have to use the time value <code>Mon Jan 2 15:04:05 -0700 MST 2006</code> and put this time in whatever format you want. Go will understand the format if you passed it with this value. You cannot use any other time value. It took me sometime to figure this out and thought to add it as a comment"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 926, "user_id": 2760325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0acf8a8895f6f9da5c0f202e8975a61d?s=128&d=identicon&r=PG", "display_name": "Ahmed Essam", "link": "https://stackoverflow.com/users/2760325/ahmed-essam"}, "edited": false, "score": 0, "creation_date": 1483614623, "post_id": 33119937, "comment_id": 70171775, "body": "@AhmedEssam Thanks, included that in the answer."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 196, "last_activity_date": 1483614605, "last_edit_date": 1592644375, "creation_date": 1444810022, "answer_id": 33119937, "question_id": 33119748, "link": "https://stackoverflow.com/questions/33119748/convert-time-time-to-string/33119937#33119937", "title": "Convert time.Time to string", "body": "<p>You can use the <a href=\"https://golang.org/pkg/time/#Time.String\" rel=\"noreferrer\"><code>Time.String()</code></a> method to convert a <a href=\"https://golang.org/pkg/time/#Time\" rel=\"noreferrer\"><code>time.Time</code></a> to a <code>string</code>. This uses the format string <code>&quot;2006-01-02 15:04:05.999999999 -0700 MST&quot;</code>.</p>\n<p>If you need other custom format, you can use <a href=\"https://golang.org/pkg/time/#Time.Format\" rel=\"noreferrer\"><code>Time.Format()</code></a>. For example to get the timestamp in the format of <code>yyyy-MM-dd HH:mm:ss</code> use the format string <code>&quot;2006-01-02 15:04:05&quot;</code>.</p>\n<p>Example:</p>\n<pre><code>t := time.Now()\nfmt.Println(t.String())\nfmt.Println(t.Format(&quot;2006-01-02 15:04:05&quot;))\n</code></pre>\n<p>Output (try it on the <a href=\"http://play.golang.org/p/VysF0Eu7v8\" rel=\"noreferrer\">Go Playground</a>):</p>\n<pre><code>2009-11-10 23:00:00 +0000 UTC\n2009-11-10 23:00:00\n</code></pre>\n<p>Note: time on the Go Playground is always set to the value seen above. Run it locally to see current date/time.</p>\n<p>Also note that using <code>Time.Format()</code>, as the layout <code>string</code> you always have to pass the same time \u2013called the <em>reference</em> time\u2013 formatted in a way you want the result to be formatted. This is documented at <code>Time.Format()</code>:</p>\n<blockquote>\n<p>Format returns a textual representation of the time value formatted according to layout, which defines the format by showing how the reference time, defined to be</p>\n<pre><code>Mon Jan 2 15:04:05 -0700 MST 2006\n</code></pre>\n<p>would be displayed if it were the value; it serves as an example of the desired output. The same display rules will then be applied to the time value.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "edited": false, "score": 0, "creation_date": 1485021589, "post_id": 34730577, "comment_id": 70755430, "body": "When I try fmt.Println(time.Now().Format(&quot;2017/20/01 13:53:35&quot;)) I am getting strange 21017/210/01 112:3012:1230"}, {"owner": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "reply_to_user": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "edited": false, "score": 0, "creation_date": 1524570848, "post_id": 34730577, "comment_id": 87017959, "body": "because you do 20 which is not meaningful for go so 2 is the date which was 21 probably at that time and the extra 0 is just appended @irom"}], "tags": [], "owner": {"reputation": 710, "user_id": 2854272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e84TW.jpg?s=128&g=1", "display_name": "firebitsbr", "link": "https://stackoverflow.com/users/2854272/firebitsbr"}, "is_accepted": false, "score": 2, "last_activity_date": 1465620177, "last_edit_date": 1465620177, "creation_date": 1452544489, "answer_id": 34730577, "question_id": 33119748, "link": "https://stackoverflow.com/questions/33119748/convert-time-time-to-string/34730577#34730577", "title": "Convert time.Time to string", "body": "<p>Go Playground\n<a href=\"http://play.golang.org/p/DN5Py5MxaB\" rel=\"nofollow\">http://play.golang.org/p/DN5Py5MxaB</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    t := time.Now()\n    // The Time type implements the Stringer interface -- it\n    // has a String() method which gets called automatically by\n    // functions like Printf().\n    fmt.Printf(\"%s\\n\", t)\n\n    // See the Constants section for more formats\n    // http://golang.org/pkg/time/#Time.Format\n    formatedTime := t.Format(time.RFC1123)\n    fmt.Println(formatedTime)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "edited": false, "score": 1, "creation_date": 1485021651, "post_id": 39287194, "comment_id": 70755453, "body": "When I try fmt.Println(time.Now().Format(&quot;2017/20/01 13:53:35&quot;)) I am getting strange 21017/210/01 112:3012:1230"}, {"owner": {"reputation": 311, "user_id": 6757469, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4p4-0biiuQs/AAAAAAAAAAI/AAAAAAAAAh8/6_UVxIgys1M/photo.jpg?sz=128", "display_name": "Hao", "link": "https://stackoverflow.com/users/6757469/hao"}, "reply_to_user": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "edited": false, "score": 3, "creation_date": 1486541053, "post_id": 39287194, "comment_id": 71384270, "body": "use fmt.Println(time.Now().Format(&quot;2006/01/02 15:04:05&quot;))   , because the format string is fixed, It&#39;s &quot;2006 01 02 15 04 05&quot;"}], "tags": [], "owner": {"reputation": 311, "user_id": 6757469, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4p4-0biiuQs/AAAAAAAAAAI/AAAAAAAAAh8/6_UVxIgys1M/photo.jpg?sz=128", "display_name": "Hao", "link": "https://stackoverflow.com/users/6757469/hao"}, "is_accepted": false, "score": 21, "last_activity_date": 1472805525, "last_edit_date": 1472805525, "creation_date": 1472803029, "answer_id": 39287194, "question_id": 33119748, "link": "https://stackoverflow.com/questions/33119748/convert-time-time-to-string/39287194#39287194", "title": "Convert time.Time to string", "body": "<pre><code>package main                                                                                                                                                           \n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\n// @link https://golang.org/pkg/time/\n\nfunc main() {\n\n    //caution : format string is `2006-01-02 15:04:05.000000000`\n    current := time.Now()\n\n    fmt.Println(\"origin : \", current.String())\n    // origin :  2016-09-02 15:53:07.159994437 +0800 CST\n\n    fmt.Println(\"mm-dd-yyyy : \", current.Format(\"01-02-2006\"))\n    // mm-dd-yyyy :  09-02-2016\n\n    fmt.Println(\"yyyy-mm-dd : \", current.Format(\"2006-01-02\"))\n    // yyyy-mm-dd :  2016-09-02\n\n    // separated by .\n    fmt.Println(\"yyyy.mm.dd : \", current.Format(\"2006.01.02\"))\n    // yyyy.mm.dd :  2016.09.02\n\n    fmt.Println(\"yyyy-mm-dd HH:mm:ss : \", current.Format(\"2006-01-02 15:04:05\"))\n    // yyyy-mm-dd HH:mm:ss :  2016-09-02 15:53:07\n\n    // StampMicro\n    fmt.Println(\"yyyy-mm-dd HH:mm:ss: \", current.Format(\"2006-01-02 15:04:05.000000\"))\n    // yyyy-mm-dd HH:mm:ss:  2016-09-02 15:53:07.159994\n\n    //StampNano\n    fmt.Println(\"yyyy-mm-dd HH:mm:ss: \", current.Format(\"2006-01-02 15:04:05.000000000\"))\n    // yyyy-mm-dd HH:mm:ss:  2016-09-02 15:53:07.159994437\n}    \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 578, "user_id": 2586904, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xCQwO.jpg?s=128&g=1", "display_name": "Vignesh Kumar", "link": "https://stackoverflow.com/users/2586904/vignesh-kumar"}, "is_accepted": false, "score": 2, "last_activity_date": 1499173894, "creation_date": 1499173894, "answer_id": 44907004, "question_id": 33119748, "link": "https://stackoverflow.com/questions/33119748/convert-time-time-to-string/44907004#44907004", "title": "Convert time.Time to string", "body": "<p>Please find the simple solution to convete Date &amp; Time Format in Go Lang. Please find the example below.</p>\n\n<p>Package Link: <a href=\"https://github.com/vigneshuvi/GoDateFormat\" rel=\"nofollow noreferrer\">https://github.com/vigneshuvi/GoDateFormat</a>.</p>\n\n<p>Please find the plackholders:<a href=\"https://medium.com/@Martynas/formatting-date-and-time-in-golang-5816112bf098\" rel=\"nofollow noreferrer\">https://medium.com/@Martynas/formatting-date-and-time-in-golang-5816112bf098</a></p>\n\n<pre><code>package main\n\n\n// Import Package\nimport (\n    \"fmt\"\n    \"time\"\n    \"github.com/vigneshuvi/GoDateFormat\"\n)\n\nfunc main() {\n    fmt.Println(\"Go Date Format(Today - 'yyyy-MM-dd HH:mm:ss Z'): \", GetToday(GoDateFormat.ConvertFormat(\"yyyy-MM-dd HH:mm:ss Z\")))\n    fmt.Println(\"Go Date Format(Today - 'yyyy-MMM-dd'): \", GetToday(GoDateFormat.ConvertFormat(\"yyyy-MMM-dd\")))\n    fmt.Println(\"Go Time Format(NOW - 'HH:MM:SS'): \", GetToday(GoDateFormat.ConvertFormat(\"HH:MM:SS\")))\n    fmt.Println(\"Go Time Format(NOW - 'HH:MM:SS tt'): \", GetToday(GoDateFormat.ConvertFormat(\"HH:MM:SS tt\")))\n}\n\nfunc GetToday(format string) (todayString string){\n    today := time.Now()\n    todayString = today.Format(format);\n    return\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1048, "user_id": 1112106, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8b13708b990969672f830616bf5ed46d?s=128&d=identicon&r=PG", "display_name": "feuyeux", "link": "https://stackoverflow.com/users/1112106/feuyeux"}, "is_accepted": false, "score": 1, "last_activity_date": 1594634378, "creation_date": 1594634378, "answer_id": 62873464, "question_id": 33119748, "link": "https://stackoverflow.com/questions/33119748/convert-time-time-to-string/62873464#62873464", "title": "Convert time.Time to string", "body": "<pre class=\"lang-golang prettyprint-override\"><code>strconv.Itoa(int(time.Now().Unix()))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 152, "user_id": 10483233, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xa2GjvU9ggA/AAAAAAAAAAI/AAAAAAAAACU/_ap15LAnzgA/photo.jpg?sz=128", "display_name": "Sonu Sharma", "link": "https://stackoverflow.com/users/10483233/sonu-sharma"}, "is_accepted": false, "score": 0, "last_activity_date": 1609783526, "creation_date": 1609783526, "answer_id": 65567597, "question_id": 33119748, "link": "https://stackoverflow.com/questions/33119748/convert-time-time-to-string/65567597#65567597", "title": "Convert time.Time to string", "body": "<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;time&quot;\n)\n\nfunc main() {\n    v , _ := time.Now().UTC().MarshalText()\n    fmt.Println(string(v))\n}\n</code></pre>\n<p>Output : <code>2009-11-10T23:00:00Z</code></p>\n<p><a href=\"https://play.golang.org/p/xbQzszzVPjM\" rel=\"nofollow noreferrer\">Go Playground</a></p>\n"}], "owner": {"reputation": 1640, "user_id": 4273851, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/24f0896e35ca5cf36f0b6b4ec2aeec34?s=128&d=identicon&r=PG&f=1", "display_name": "A.D", "link": "https://stackoverflow.com/users/4273851/a-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217893, "favorite_count": 19, "accepted_answer_id": 33119937, "answer_count": 6, "score": 126, "last_activity_date": 1609783526, "creation_date": 1444809438, "last_edit_date": 1536072593, "question_id": 33119748, "link": "https://stackoverflow.com/questions/33119748/convert-time-time-to-string", "title": "Convert time.Time to string", "body": "<p>I'm trying to add some values from my database to a <code>[]string</code> in Go. Some of these are timestamps.</p>\n\n<p>I get the error:</p>\n\n<blockquote>\n  <p>cannot use U.Created_date (type time.Time) as type string in array element</p>\n</blockquote>\n\n<p>Can I convert <code>time.Time</code> to <code>string</code>?</p>\n\n<pre><code>type UsersSession struct {\n    Userid int\n    Timestamp time.Time\n    Created_date time.Time\n}\n\ntype Users struct {\n    Name string\n    Email string\n    Country string\n    Created_date time.Time\n    Id int\n    Hash string\n    IP string\n}\n</code></pre>\n\n<p>-</p>\n\n<pre><code>var usersArray = [][]string{}\n\nrows, err := db.Query(\"SELECT u.id, u.hash, u.name, u.email, u.country, u.IP, u.created_date, us.timestamp, us.created_date FROM usersSession AS us LEFT JOIN users AS u ON u.id = us.userid WHERE us.timestamp + interval 30 minute &gt;= now()\")\n\nU := Users{}\nUS := UsersSession{}\n\nfor rows.Next() {\n    err = rows.Scan(&amp;U.Id, &amp;U.Hash, &amp;U.Name, &amp;U.Email, &amp;U.Country, &amp;U.IP, &amp;U.Created_date, &amp;US.Timestamp, &amp;US.Created_date)\n    checkErr(err)\n\n    userid_string := strconv.Itoa(U.Id)\n    user := []string{userid_string, U.Hash, U.Name, U.Email, U.Country, U.IP, U.Created_date, US.Timestamp, US.Created_date}\n    // -------------\n    // ^ this is where the error occurs\n    // cannot use U.Created_date (type time.Time) as type string in array element (for US.Created_date and US.Timestamp aswell)\n    // -------------\n\n    usersArray = append(usersArray, user)\n    log.Print(\"usersArray: \", usersArray)\n}\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>I added the following. It works now, thanks.</p>\n\n<pre><code>userCreatedDate := U.Created_date.Format(\"2006-01-02 15:04:05\")\nuserSessionCreatedDate := US.Created_date.Format(\"2006-01-02 15:04:05\")\nuserSessionTimestamp := US.Timestamp.Format(\"2006-01-02 15:04:05\")\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1662, "user_id": 961517, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Nboyt.png?s=128&g=1", "display_name": "Gima", "link": "https://stackoverflow.com/users/961517/gima"}, "edited": false, "score": 0, "creation_date": 1456640849, "post_id": 33119819, "comment_id": 59037000, "body": "It would be nice to know where the special case is handled in go source tree - or official documentation for the behavior. Couldn&#39;t find either, but I assume the functionality resides with <code>build</code> subcommand."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 6, "last_activity_date": 1444830186, "last_edit_date": 1444830186, "creation_date": 1444809658, "answer_id": 33119819, "question_id": 33118766, "link": "https://stackoverflow.com/questions/33118766/why-is-there-no-binary-created-when-running-go-get-golang-org-x-tools-cmd-godoc/33119819#33119819", "title": "Why is there no binary created when running `go get golang.org/x/tools/cmd/godoc`?", "body": "<p>Godoc is special as it is an official tool being part of the Go distribution.</p>\n\n<p>So if you <code>go get</code> godoc, the result binary will not be placed under <code>$GOPATH/bin</code> where all other executables go, but under <code>$GOROOT/bin</code>.</p>\n\n<p>Gotour is not special in this way, so it gets installed into your <code>$GOPATH/bin</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 590, "user_id": 2025820, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/95b84e5d526a41b18d71aebef64e9105?s=128&d=identicon&r=PG", "display_name": "lumo", "link": "https://stackoverflow.com/users/2025820/lumo"}, "edited": false, "score": 0, "creation_date": 1611221050, "post_id": 35679478, "comment_id": 116382252, "body": "Windows: go build -o %GOPATH%/bin/godoc.exe golang.org/x/tools/cmd/godoc"}], "tags": [], "owner": {"reputation": 1662, "user_id": 961517, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Nboyt.png?s=128&g=1", "display_name": "Gima", "link": "https://stackoverflow.com/users/961517/gima"}, "is_accepted": false, "score": 5, "last_activity_date": 1456640547, "creation_date": 1456640547, "answer_id": 35679478, "question_id": 33118766, "link": "https://stackoverflow.com/questions/33118766/why-is-there-no-binary-created-when-running-go-get-golang-org-x-tools-cmd-godoc/35679478#35679478", "title": "Why is there no binary created when running `go get golang.org/x/tools/cmd/godoc`?", "body": "<p>And for those just <em>want to</em> install <code>godoc</code> under <code>$GOPATH</code> can do so:</p>\n\n<hr>\n\n<p>1. <em>Download, don't install:</em></p>\n\n<pre><code>$ go get -u -d golang.org/x/tools/cmd/godoc\n</code></pre>\n\n<p>2. <em>Build binary to specific path:</em></p>\n\n<pre><code>$ go build -o $GOPATH/bin/godoc golang.org/x/tools/cmd/godoc\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 2322857, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/681763f12948f568f90f10380bd0afa6?s=128&d=identicon&r=PG", "display_name": "AmeBel", "link": "https://stackoverflow.com/users/2322857/amebel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 932, "favorite_count": 0, "accepted_answer_id": 33119819, "answer_count": 2, "score": 3, "last_activity_date": 1456640547, "creation_date": 1444806405, "question_id": 33118766, "link": "https://stackoverflow.com/questions/33118766/why-is-there-no-binary-created-when-running-go-get-golang-org-x-tools-cmd-godoc", "title": "Why is there no binary created when running `go get golang.org/x/tools/cmd/godoc`?", "body": "<p><code>godoc</code> and <code>gotour</code> can be built and run from their respecitve source directory with <code>go build</code>. What is the reason a <code>gotour</code> binary created when one <code>go get</code> it and that is not the case for <code>godoc</code>.</p>\n\n<h1>Command Line Output:</h1>\n\n<pre><code>[ user@pc:~/.gvm/pkgsets/go1.5.1/global ]\n&gt;&gt; ls\n\n[ user@pc:~/.gvm/pkgsets/go1.5.1/global ]\n&gt;&gt; go env\nGOARCH=\"amd64\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/user/.gvm/pkgsets/go1.5.1/global\"\nGORACE=\"\"\nGOROOT=\"/home/user/.gvm/gos/go1.5.1\"\nGOTOOLDIR=\"/home/user/.gvm/gos/go1.5.1/pkg/tool/linux_amd64\"\nGO15VENDOREXPERIMENT=\"\"\nCC=\"gcc\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\n\n[ user@pc:~/.gvm/pkgsets/go1.5.1/global ]\n&gt;&gt; go get golang.org/x/tools/cmd/godoc\n\n[ user@pc:~/.gvm/pkgsets/go1.5.1/global ]\n&gt;&gt; ls\npkg  src\n\n[ user@pc:~/.gvm/pkgsets/go1.5.1/global ]\n&gt;&gt; go get golang.org/x/tour/gotour\n\n[ user@pc:~/.gvm/pkgsets/go1.5.1/global ]\n&gt;&gt; ls \nbin  pkg  src\n\n[ user@pc:~/.gvm/pkgsets/go1.5.1/global ]\n&gt;&gt; ls bin/\ngotour\n\n[ user@pc:~/.gvm/pkgsets/go1.5.1/global ]\n&gt;&gt; cd src/golang.org/x/tools/cmd/godoc/\n\n[ user@pc:~/.gvm/pkgsets/go1.5.1/global/src/golang.org/x/tools/cmd/godoc ]\n&gt;&gt; go build\n\n[ user@pc:~/.gvm/pkgsets/go1.5.1/global/src/golang.org/x/tools/cmd/godoc ]\n&gt;&gt; ./godoc \nusage: godoc package [name ...]\n    godoc -http=:6060\n  -analysis string\n        comma-separated list of analyses to perform (supported: type, pointer). See http://golang.org/lib/godoc/analysis/help.html\n  -ex\n        show examples in command line mode\n  -goroot string\n        Go root directory (default \"/home/user/.gvm/gos/go1.5.1\")\n  -html\n        print HTML in command-line mode\n  -http string\n        HTTP service address (e.g., ':6060')\n  -httptest.serve string\n        if non-empty, httptest.NewServer serves on this address and blocks\n  -index\n....\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 5, "creation_date": 1444802854, "post_id": 33116941, "comment_id": 54049091, "body": "It worth reiterating that you&#39;re trying to create a slice, not array. To create an array you&#39;d use <code>[N]type{42, 33, 567}</code> or <code>[...]type{42, 33, 567}</code> \u2014 to get the size inferred from the number of member in the initializer."}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1444857156, "post_id": 33116941, "comment_id": 54082935, "body": "^Sure, I guess in Go you use arrays so rarely and the syntax is so similar that I basically interchange the two even if they are different things."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1444906422, "post_id": 33116941, "comment_id": 54102618, "body": "I&#39;d not say I use them rarely. In a code which parses some network protocol, it&#39;s customary to decrale an array and then reslice it multiple times -- passing those slices, being sort of windows to the underlying array, to other functions.  In either case, a) I thought you could have wrong model in your head which needed fixing up ;-) b) it&#39;s better to not confuse readers which will stumble on your post later."}], "answers": [{"comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 3, "creation_date": 1444804522, "post_id": 33117022, "comment_id": 54049845, "body": "You don&#39;t have to specify the types of the values: <a href=\"https://play.golang.org/p/Wdhabb3qca\" rel=\"nofollow noreferrer\">play.golang.org/p/Wdhabb3qca</a>"}], "tags": [], "owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "is_accepted": false, "score": 1, "last_activity_date": 1444799304, "creation_date": 1444799304, "answer_id": 33117022, "question_id": 33116941, "link": "https://stackoverflow.com/questions/33116941/create-array-of-array-literal-in-golang/33117022#33117022", "title": "Create array of array literal in Golang", "body": "<p>A slice literal is written as <code>[]type{&lt;value 1&gt;, &lt;value 2&gt;, ... }</code>. A slice of ints  would be <code>[]int{1,2,3}</code> and a slice of int slices would be <code>[][]int{[]int{1,2,3},[]int{4,5,6}}</code>.</p>\n\n<pre><code>groups := [][]int{[]int{1,2,3},[]int{4,5,6}}\n\nfor _, group := range groups {\n    sum := 0\n    for _, num := range group {\n        sum += num\n    }\n    fmt.Printf(\"The array %+v has a sum of %d\\n\", sub, sum)\n} \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 2, "creation_date": 1444803552, "post_id": 33117089, "comment_id": 54049411, "body": "You don&#39;t have to use the same syntax for the inner arrays: <a href=\"http://play.golang.org/p/Wdhabb3qca\" rel=\"nofollow noreferrer\">play.golang.org/p/Wdhabb3qca</a>"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1444840057, "post_id": 33117089, "comment_id": 54073191, "body": "@twotwotwo true, that is technically different and imo preferred."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 2, "creation_date": 1444843100, "post_id": 33117089, "comment_id": 54074927, "body": "Glad you added the shorter example, but the answer still says &quot;you have to use the syntax recursively. It&#39;s very verbose,&quot; and &quot;you have to use the same syntax for the inner arrays,&quot; which seem confusing or inaccurate when you consider that inner slices can be written out in a different and shorter way."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1444843705, "post_id": 33117089, "comment_id": 54075250, "body": "@twotwotwo alright well I&#39;ve changed my wording. I think that&#39;s nitpicking. It is the same syntax, they&#39;re both covered as &#39;composite literal&#39; it&#39;s just in the case of the inner collections the type information can be inferred but using <code>[]</code> vs <code>{}</code> is really the important distinction."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 27, "last_activity_date": 1444843632, "last_edit_date": 1444843632, "creation_date": 1444799674, "answer_id": 33117089, "question_id": 33116941, "link": "https://stackoverflow.com/questions/33116941/create-array-of-array-literal-in-golang/33117089#33117089", "title": "Create array of array literal in Golang", "body": "<p>You almost have the right thing however your syntax for the inner arrays is slightly off, needing curly braces like; <code>test := [][]int{[]int{1,2,3},[]int{1,2,3}}</code> or a slightly more concise version; <code>test := [][]int{{1,2,3},{1,2,3}}</code></p>\n\n<p>The expression is called a 'composite literal' and you can read more about them here; <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"noreferrer\">https://golang.org/ref/spec#Composite_literals</a></p>\n\n<p>But as a basic rule of thumb, if you have nested structures, you have to use the syntax recursively. It's very verbose.</p>\n"}, {"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": false, "score": 6, "last_activity_date": 1444803929, "creation_date": 1444803929, "answer_id": 33118050, "question_id": 33116941, "link": "https://stackoverflow.com/questions/33116941/create-array-of-array-literal-in-golang/33118050#33118050", "title": "Create array of array literal in Golang", "body": "<p>In some other langauges (Perl, Python, JavaScript), <code>[1,2,3]</code> might be an array literal, but in Go, <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"noreferrer\">composite literals</a> use braces, and here, you have to specify the type of the outer slice:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype T struct{ foo [][]int }\n\nfunc main() {\n    a := [][]int{{1, 2, 3}, {4, 5, 6}}\n    b := T{foo: [][]int{{1, 2, 3}, {4, 5, 6}}}\n    fmt.Println(a, b)\n}\n</code></pre>\n\n<p>You can <a href=\"http://play.golang.org/p/E5uLWLyrGy\" rel=\"noreferrer\">run or play with that on the Playground</a>.</p>\n\n<p>The Go compiler is just tricky enough to figure out that the elements of an <code>[][]int</code> are <code>[]int</code> without you saying so on each element. You do have to write out the outer type's name, though.</p>\n"}, {"tags": [], "owner": {"reputation": 207, "user_id": 2306084, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89e18a22f5b528fbc07ad17bc5d5b31b?s=128&d=identicon&r=PG", "display_name": "NurShomik", "link": "https://stackoverflow.com/users/2306084/nurshomik"}, "is_accepted": false, "score": 3, "last_activity_date": 1536108073, "creation_date": 1536108073, "answer_id": 52175587, "question_id": 33116941, "link": "https://stackoverflow.com/questions/33116941/create-array-of-array-literal-in-golang/52175587#52175587", "title": "Create array of array literal in Golang", "body": "<p>Just replace the square brackets with curly braces. In Go, array literals are identified with curly braces. </p>\n\n<p><code>\ntest := [][]int{{1,2,3},{1,2,3}}\n</code></p>\n"}], "owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27452, "favorite_count": 4, "accepted_answer_id": 33117089, "answer_count": 4, "score": 20, "last_activity_date": 1611443377, "creation_date": 1444798830, "last_edit_date": 1611443377, "question_id": 33116941, "link": "https://stackoverflow.com/questions/33116941/create-array-of-array-literal-in-golang", "title": "Create array of array literal in Golang", "body": "<p>How do I create an array of int arrays in Golang using slice literals?</p>\n<p>I've tried</p>\n<pre><code>test := [][]int{[1,2,3],[1,2,3]}\n</code></pre>\n<p>and</p>\n<pre><code>type Test struct {\n   foo [][]int\n}\n\nbar := Test{foo: [[1,2,3], [1,2,3]]}\n</code></pre>\n"}, {"tags": ["asynchronous", "ssh", "go", "io"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444829918, "post_id": 33116411, "comment_id": 54065992, "body": "What do you mean that it only prints the appropriate output intermittently? Is there an error returned by ReadAll? (This code also can&#39;t compile, are you using something different?)"}, {"owner": {"reputation": 1063, "user_id": 2443833, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/lL91m.jpg?s=128&g=1", "display_name": "Langston", "link": "https://stackoverflow.com/users/2443833/langston"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444845807, "post_id": 33116411, "comment_id": 54076460, "body": "The above code fixed the error. I am using something different, but I am certain that the changes aren&#39;t substrantial to the question I have. I mean that sometimes when it is run it prints the output of the command, and other times prints nothing. Thanks again!"}], "answers": [{"tags": [], "owner": {"reputation": 1063, "user_id": 2443833, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/lL91m.jpg?s=128&g=1", "display_name": "Langston", "link": "https://stackoverflow.com/users/2443833/langston"}, "is_accepted": true, "score": 0, "last_activity_date": 1444846036, "creation_date": 1444846036, "answer_id": 33132546, "question_id": 33116411, "link": "https://stackoverflow.com/questions/33116411/asynchronously-reading-from-ssh-output/33132546#33132546", "title": "Asynchronously Reading From SSH Output", "body": "<p>The problem was that I had the following code in my function: </p>\n\n<pre><code>if session != nil {\n    defer session.Close()\n}\n</code></pre>\n\n<p>That way, the output would only print if the command completed and sent back its stdout before the function returned (which was infrequent). I fixed my code simply by removing these lines. </p>\n"}], "owner": {"reputation": 1063, "user_id": 2443833, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/lL91m.jpg?s=128&g=1", "display_name": "Langston", "link": "https://stackoverflow.com/users/2443833/langston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 33132546, "answer_count": 1, "score": 2, "last_activity_date": 1444846036, "creation_date": 1444795411, "last_edit_date": 1444845744, "question_id": 33116411, "link": "https://stackoverflow.com/questions/33116411/asynchronously-reading-from-ssh-output", "title": "Asynchronously Reading From SSH Output", "body": "<p>I'd like to write a function that takes a SSH session and runs a command, providing an <code>io.Reader</code> that reads its output as it is recieved. </p>\n\n<pre><code>package main\n\nimport (\n    \"golang.org/x/crypto/ssh\"\n    \"io\"\n)\n\nfunc StreamOutput(session *ssh.Session, command string) (output io.Reader, err error) {\n    if session != nil {\n        defer session.Close()\n    }\n    if err != nil {\n        return output, err\n    }\n    // connect to both outputs\n    outReader, err := session.StdoutPipe()\n    if err != nil {\n        return output, err\n    }\n    errReader, err := session.StderrPipe()\n    if err != nil {\n        return output, err\n    }\n    output = io.MultiReader(outReader, errReader)\n    err = session.Start(command)\n    // return the readers that are to be read from\n    return output, err\n</code></pre>\n\n<p>When I test this code using an <code>ioutil.ReadAll</code> on <code>output</code>, however, it only prints the appropriate output intermittently, even after calling <code>session.Wait()</code>. Why might this be? Is there a better way to return the functions output (channels, perhaps?)? Thanks!</p>\n"}, {"tags": ["go", "reflection", "go-reflect"], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 4941660, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-beeVlw22lWE/AAAAAAAAAAI/AAAAAAAAAAA/sAJka-txNR8/photo.jpg?sz=128", "display_name": "Peter Noyes", "link": "https://stackoverflow.com/users/4941660/peter-noyes"}, "is_accepted": false, "score": 2, "last_activity_date": 1444794824, "last_edit_date": 1495541207, "creation_date": 1444794824, "answer_id": 33116342, "question_id": 33115946, "link": "https://stackoverflow.com/questions/33115946/how-to-know-if-a-variable-of-arbitrary-type-is-zero-in-golang/33116342#33116342", "title": "How to know if a variable of arbitrary type is Zero in Golang?", "body": "<p>See this post:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/23555241/golang-reflection-how-to-get-zero-value-of-a-field-type\">Golang: Reflection - How to get zero value of a field type</a></p>\n\n<p>Basically you need to have special cases for the non comparable types.</p>\n"}, {"tags": [], "owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "is_accepted": false, "score": 2, "last_activity_date": 1444795868, "creation_date": 1444795868, "answer_id": 33116479, "question_id": 33115946, "link": "https://stackoverflow.com/questions/33115946/how-to-know-if-a-variable-of-arbitrary-type-is-zero-in-golang/33116479#33116479", "title": "How to know if a variable of arbitrary type is Zero in Golang?", "body": "<p>As Peter Noyes points out, you just need to make sure you're not comparing a type which isn't comparable. Luckily, this is very straightforward with the <code>reflect</code> package:</p>\n\n<pre><code>func IsZero(v interface{}) (bool, error) {\n    t := reflect.TypeOf(v)\n    if !t.Comparable() {\n        return false, fmt.Errorf(\"type is not comparable: %v\", t)\n    }\n    return v == reflect.Zero(t).Interface(), nil\n}\n</code></pre>\n\n<p>See an example use <a href=\"https://play.golang.org/p/zDE0csOqZ_\" rel=\"nofollow\">here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 151, "user_id": 4253860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d62e10c624393be984cd61ba56e4e425?s=128&d=identicon&r=PG&f=1", "display_name": "v1ct0r", "link": "https://stackoverflow.com/users/4253860/v1ct0r"}, "edited": false, "score": 1, "creation_date": 1444880215, "post_id": 33116480, "comment_id": 54089765, "body": "Hi Rhythmic, Thanks for your response! In fact, == and DeepEqual are different. DeepEqual works for both comparable and non comparable variable, according to go document <a href=\"https://golang.org/pkg/reflect/#DeepEqual\" rel=\"nofollow noreferrer\">reflect.DeepEqual</a>"}, {"owner": {"reputation": 30089, "user_id": 22147, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/x74x2.png?s=128&g=1", "display_name": "Rhythmic Fistman", "link": "https://stackoverflow.com/users/22147/rhythmic-fistman"}, "reply_to_user": {"reputation": 151, "user_id": 4253860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d62e10c624393be984cd61ba56e4e425?s=128&d=identicon&r=PG&f=1", "display_name": "v1ct0r", "link": "https://stackoverflow.com/users/4253860/v1ct0r"}, "edited": false, "score": 0, "creation_date": 1444886404, "post_id": 33116480, "comment_id": 54091479, "body": "I&#39;m yet to understand comparable, I&#39;ll check it out, thanks."}], "tags": [], "owner": {"reputation": 30089, "user_id": 22147, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/x74x2.png?s=128&g=1", "display_name": "Rhythmic Fistman", "link": "https://stackoverflow.com/users/22147/rhythmic-fistman"}, "is_accepted": false, "score": 2, "last_activity_date": 1444795868, "creation_date": 1444795868, "answer_id": 33116480, "question_id": 33115946, "link": "https://stackoverflow.com/questions/33115946/how-to-know-if-a-variable-of-arbitrary-type-is-zero-in-golang/33116480#33116480", "title": "How to know if a variable of arbitrary type is Zero in Golang?", "body": "<p>Both of the following give me reasonable results (probably because they're the same?)</p>\n\n<pre><code>reflect.ValueOf(v) == reflect.Zero(reflect.TypeOf(v)))\n\nreflect.DeepEqual(reflect.ValueOf(v), reflect.Zero(reflect.TypeOf(v)))\n</code></pre>\n\n<p>e.g. various integer 0 flavours and uninitialized <code>struct</code>s are \"zero\"</p>\n\n<p>Sadly, empty strings and arrays are not. and <code>nil</code> gives an exception.<br>\nYou could special case these if you wanted.</p>\n"}, {"tags": [], "owner": {"reputation": 383, "user_id": 8216204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bc75d2ed2c77d48af4bdbd45e8e355c?s=128&d=identicon&r=PG&f=1", "display_name": "mrpandey", "link": "https://stackoverflow.com/users/8216204/mrpandey"}, "is_accepted": false, "score": 1, "last_activity_date": 1589829443, "creation_date": 1589829443, "answer_id": 61877328, "question_id": 33115946, "link": "https://stackoverflow.com/questions/33115946/how-to-know-if-a-variable-of-arbitrary-type-is-zero-in-golang/61877328#61877328", "title": "How to know if a variable of arbitrary type is Zero in Golang?", "body": "<p>Go 1.13 introduced <code>Value.IsZero</code> method in <code>reflect</code> package. This is how you can check for zero value using it:</p>\n\n<pre><code>if reflect.ValueOf(v).IsZero() {\n    // v is zero, do something\n}\n</code></pre>\n\n<p>Apart from basic types, it also works for Chan, Func, Array, Interface, Map, Ptr, Slice, UnsafePointer, and Struct.</p>\n"}], "owner": {"reputation": 151, "user_id": 4253860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d62e10c624393be984cd61ba56e4e425?s=128&d=identicon&r=PG&f=1", "display_name": "v1ct0r", "link": "https://stackoverflow.com/users/4253860/v1ct0r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2594, "favorite_count": 0, "answer_count": 4, "score": 8, "last_activity_date": 1589829443, "creation_date": 1444792073, "last_edit_date": 1471850528, "question_id": 33115946, "link": "https://stackoverflow.com/questions/33115946/how-to-know-if-a-variable-of-arbitrary-type-is-zero-in-golang", "title": "How to know if a variable of arbitrary type is Zero in Golang?", "body": "<p>Because not all types are comparable, e.g. a slice. So we can't do this</p>\n\n<pre><code>var v ArbitraryType\nv == reflect.Zero(reflect.TypeOf(v)).Interface()\n</code></pre>\n\n<p><strong>Edit - Solution reflect.DeepEqual</strong></p>\n\n<pre><code>var v ArbitratyType\nzero := reflect.Zero(reflect.TypeOf(v)).Interface()\nisZero := reflect.DeepEqual(v, zero)\n</code></pre>\n\n<p>Go documentation about <a href=\"https://golang.org/pkg/reflect/#DeepEqual\" rel=\"nofollow\">reflect.DeepEqual</a></p>\n\n<blockquote>\n  <p>DeepEqual tests for deep equality. It uses normal == equality where possible but will scan elements of arrays, slices, maps, and fields of structs.</p>\n</blockquote>\n"}, {"tags": ["go", "concurrency", "webserver"], "answers": [{"comments": [{"owner": {"reputation": 3525, "user_id": 775361, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b4499eb383a02267b50a02d75d86d5fa?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/775361/alan"}, "edited": false, "score": 0, "creation_date": 1444839004, "post_id": 33115125, "comment_id": 54072529, "body": "Thank you for your help on this.  I was working off of the concepts outlined in the Effective Go section on Concurrency.  <a href=\"https://golang.org/doc/effective_go.html#concurrency\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html#concurrency</a>"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1444786063, "last_edit_date": 1444786063, "creation_date": 1444785716, "answer_id": 33115125, "question_id": 33114991, "link": "https://stackoverflow.com/questions/33114991/simple-go-web-server-not-seeing-responses-in-the-client/33115125#33115125", "title": "Simple Go web server, not seeing responses in the client", "body": "<p>The server closes the response when <code>serveHandler</code> returns.  </p>\n\n<p>One fix is to block <code>serveHandler</code> until the request is processed. In the following code, the worker closes <code>done</code> to signal that the request is complete.  The handler waits for <code>done</code> to close.</p>\n\n<pre><code>type clientRequest struct {\n    r *http.Request\n    w http.ResponseWriter\n    done chan struct{}  // &lt;-- add this line\n}\n\nfunc serveHandler(w http.ResponseWriter, r *http.Request) {\n   var newRequest = new(clientRequest)\n   newRequest.r = r\n   newRequest.w = w\n   newRequest.done = make(chan struct{})\n\n   reqChannel &lt;- newRequest // send the new request to the request channel\n   fmt.Printf(\"Sent request to reqChannel for URL: %q\\n\", html.EscapeString(r.URL.Path))\n   &lt;-newRequest.done  // wait for worker goroutine to complete\n}\n\nfunc processRequest(instanceNbr int) {\n   fmt.Printf(\"processRequest started for instance #%d\\n\", instanceNbr)\n   for theRequest := range reqChannel { // receive requests from the channel until it is closed\n       fmt.Printf(\"Got request from reqChannel for URL: %q\\n\", html.EscapeString(theRequest.r.URL.Path))\n\n       fmt.Fprintf(theRequest.w, \"processRequest instance #%d: URL is %q\", instanceNbr, html.EscapeString(theRequest.r.URL.Path))\n       if f, ok := theRequest.w.(http.Flusher); ok {\n           f.Flush()\n       }\n       close(theRequest.done)  // signal handler that request is complete\n   }\n}\n</code></pre>\n\n<p>If the goal is to limit the number of active handlers, then you can use a channel as a counting semaphore to limit the number of active handler goroutines:</p>\n\n<pre><code>var reqChannel = make(chan struct{}, MaxRequests)\n\nfunc serveHandler(w http.ResponseWriter, r *http.Request) {\n    reqChannel &lt;- struct{}{} \n    // handle the request\n    &lt;-reqChannel\n}\n</code></pre>\n\n<p>Note that the server runs handlers in a per connection goroutine.  </p>\n\n<p>Even simpler is to just write a handler. Most servers do not need to limit request handler concurrency.</p>\n"}, {"tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": false, "score": 2, "last_activity_date": 1444786489, "last_edit_date": 1444786489, "creation_date": 1444786062, "answer_id": 33115164, "question_id": 33114991, "link": "https://stackoverflow.com/questions/33114991/simple-go-web-server-not-seeing-responses-in-the-client/33115164#33115164", "title": "Simple Go web server, not seeing responses in the client", "body": "<p>Your answer is in this <a href=\"https://github.com/golang/go/blob/f2e4c8b5fb3660d793b2c545ef207153db0a34b1/src/net/http/server.go#L1356\" rel=\"nofollow\">part of the net/http code</a> :</p>\n\n<pre><code>    // HTTP cannot have multiple simultaneous active requests.[*]\n    // Until the server replies to this request, it can't read another,\n    // so we might as well run the handler in this goroutine.\n    // [*] Not strictly true: HTTP pipelining.  We could let them all process\n    // in parallel even if their responses need to be serialized.\n    serverHandler{c.server}.ServeHTTP(w, w.req)\n    if c.hijacked() {\n        return\n    }\n    w.finishRequest()\n</code></pre>\n\n<p>After <code>ServeHTTP</code> returns, the request is finished.</p>\n\n<p>So you have a few solutions :</p>\n\n<ul>\n<li><p>drop your worker pattern and do the job in <code>serveHandler</code></p></li>\n<li><p>wait for the request to be fully processed before finishing <code>serveHandler</code>, with something like this:</p></li>\n</ul>\n\n<p>(tested on my local)</p>\n\n<pre><code>type clientRequest struct {\n    r *http.Request\n    w http.ResponseWriter\n    done chan struct{}\n}\n\nfunc serveHandler(w http.ResponseWriter, r *http.Request) {\n    var newRequest = new(clientRequest)\n    newRequest.r = r\n    newRequest.w = w\n    newRequest.done = make(chan struct{})\n\n    reqChannel &lt;- newRequest // send the new request to the request channel\n    fmt.Printf(\"Sent request to reqChannel for URL: %q\\n\", html.EscapeString(r.URL.Path))\n    &lt;-newRequest.done // wait for the worker to finish\n}\n\nfunc processRequest(instanceNbr int) {\n    fmt.Printf(\"processRequest started for instance #%d\\n\", instanceNbr)\n    for theRequest := range reqChannel { // receive requests from the channel until it is closed\n        fmt.Printf(\"Got request from reqChannel for URL: %q\\n\", html.EscapeString(theRequest.r.URL.Path))\n\n        // xxx this isn't working:\n        fmt.Fprintf(theRequest.w, \"processRequest instance #%d: URL is %q\", instanceNbr, html.EscapeString(theRequest.r.URL.Path))\n        if f, ok := theRequest.w.(http.Flusher); ok {\n            f.Flush()\n        }\n        theRequest.done &lt;- struct{}{}\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3525, "user_id": 775361, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b4499eb383a02267b50a02d75d86d5fa?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/775361/alan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 880, "favorite_count": 2, "accepted_answer_id": 33115125, "answer_count": 2, "score": 2, "last_activity_date": 1444786489, "creation_date": 1444784425, "question_id": 33114991, "link": "https://stackoverflow.com/questions/33114991/simple-go-web-server-not-seeing-responses-in-the-client", "title": "Simple Go web server, not seeing responses in the client", "body": "<p>I'm learning Go, and am writing a simple web server that uses a channel to limit the number of concurrent requests.  The server prints log entries at the console that show it's receiving the requests and processing them, however the client browser doesn't show any output.  I've tried adding a flush of the response writer, that didn't help.</p>\n\n<p>As a noob, what am I missing?  Thanks for any tips/pointers.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"html\"\n    \"net/http\"\n    \"time\"\n)\n\n// define a type to be used with our request channel\ntype clientRequest struct {\n    r *http.Request\n    w http.ResponseWriter\n}\n\nconst (\n    MaxRequests int = 10\n)\n\n// the request channel, to limit the number of simultaneous requests being processed\nvar reqChannel chan *clientRequest\n\nfunc init() {\n    reqChannel = make(chan *clientRequest, MaxRequests)\n}\n\nfunc main() {\n    // create the server's handler\n    var ServeMux = http.NewServeMux()\n    ServeMux.HandleFunc(\"/\", serveHandler)\n\n    // start pool of request handlers, all reading from the same channel\n    for i := 0; i &lt; MaxRequests; i++ {\n        go processRequest(i)\n    }\n\n    // create the server object\n    s := &amp;http.Server{\n        Addr:           \":8080\",\n        Handler:        ServeMux,         // handler to invoke, http.DefaultServeMux if nil\n        ReadTimeout:    10 * time.Second, // maximum duration before timing out read of the request\n        WriteTimeout:   10 * time.Second, // maximum duration before timing out write of the response\n        MaxHeaderBytes: 1 &lt;&lt; 20,          // maximum size of request headers, 1048576 bytes\n    }\n\n    // start the server\n    err := s.ListenAndServe()\n    if err != nil {\n        fmt.Println(\"Server failed to start: \", err)\n    }\n}\n\nfunc serveHandler(w http.ResponseWriter, r *http.Request) {\n    var newRequest = new(clientRequest)\n    newRequest.r = r\n    newRequest.w = w\n\n    reqChannel &lt;- newRequest // send the new request to the request channel\n    fmt.Printf(\"Sent request to reqChannel for URL: %q\\n\", html.EscapeString(r.URL.Path))\n}\n\nfunc processRequest(instanceNbr int) {\n    fmt.Printf(\"processRequest started for instance #%d\\n\", instanceNbr)\n    for theRequest := range reqChannel { // receive requests from the channel until it is closed\n        fmt.Printf(\"Got request from reqChannel for URL: %q\\n\", html.EscapeString(theRequest.r.URL.Path))\n\n        // xxx this isn't working:\n        fmt.Fprintf(theRequest.w, \"processRequest instance #%d: URL is %q\", instanceNbr, html.EscapeString(theRequest.r.URL.Path))\n        if f, ok := theRequest.w.(http.Flusher); ok {\n            f.Flush()\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "rkt"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444772870, "post_id": 33113190, "comment_id": 54040794, "body": "Can you show us how you&#39;re building your app? The process hasn&#39;t really changed."}, {"owner": {"reputation": 8184, "user_id": 99542, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e94a065789007e8c3301ae1d726e6537?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/99542/richard"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444773635, "post_id": 33113190, "comment_id": 54041090, "body": "and I added some links to articles."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1444773853, "post_id": 33113190, "comment_id": 54041166, "body": "have you set <code>CGO_ENABLED=0</code>?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1444775503, "post_id": 33113190, "comment_id": 54041777, "body": "Not required but could you possibly provide some context and/or links to information about <code>rkt</code>? Yours is the first use of the tag and I at least am not familiar with it."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1444778356, "post_id": 33113190, "comment_id": 54042650, "body": "JimB&#39;s comment seems right. 1.5 doesn&#39;t dynamically link Go code by default, so your problem is probably with Go linking to the system&#39;s C library for DNS reoslution, which was also what older versions did. <code>CGO_ENABLED=0</code> turns that off."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1444779364, "post_id": 33113190, "comment_id": 54042912, "body": "@evanmcdonnal: rkt: <a href=\"https://github.com/coreos/rkt\" rel=\"nofollow noreferrer\">github.com/coreos/rkt</a>"}, {"owner": {"reputation": 8184, "user_id": 99542, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e94a065789007e8c3301ae1d726e6537?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/99542/richard"}, "edited": false, "score": 0, "creation_date": 1471233939, "post_id": 33113190, "comment_id": 65253195, "body": "While I still like to create static binaries from my go projects I have also started using rkt-builder to build my projects inside a rkt container. This has a number of cool side effects."}], "answers": [{"comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1444796120, "post_id": 33115015, "comment_id": 54046936, "body": "Is this running on Mac OS X (darwin)? I thought this was the only platform where DNS lookups are not done by Go itself."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1444827129, "post_id": 33115015, "comment_id": 54063939, "body": "@Volker: dns lookups are done in go when nsswitch.conf permits, but the cgo resolver is still linked so it can be used when needed (there&#39;s also a ` GODEBUG=netdns=` option for switching back and forth at runtime, which needs both available)"}, {"owner": {"reputation": 3117, "user_id": 4686743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1ca31a61cae3ec468b1c1bff333c3e1?s=128&d=identicon&r=PG", "display_name": "David Castillo", "link": "https://stackoverflow.com/users/4686743/david-castillo"}, "edited": false, "score": 1, "creation_date": 1458676029, "post_id": 33115015, "comment_id": 59964725, "body": "@Richard you have to add your own /etc/hosts to your container, like they do <a href=\"https://github.com/coreos/etcd/blob/master/scripts/build-aci#L64\" rel=\"nofollow noreferrer\">here</a>, in the etcd project."}], "tags": [], "owner": {"reputation": 8184, "user_id": 99542, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e94a065789007e8c3301ae1d726e6537?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/99542/richard"}, "is_accepted": false, "score": 11, "last_activity_date": 1444784776, "creation_date": 1444784776, "answer_id": 33115015, "question_id": 33113190, "link": "https://stackoverflow.com/questions/33113190/how-to-create-a-statically-linked-golang-executable-with-go-1-5/33115015#33115015", "title": "how to create a statically linked golang executable with go 1.5+", "body": "<p>I hate to answer my own question. The comments have been correct <code>CGO_ENABLED=0 go build ./...</code> seems to have have done the trick. </p>\n\n<p>While it was not part of the original question, once the program started executing in the rkt container it could not perform a proper DNS request. So there must be something else going on too.</p>\n"}, {"tags": [], "owner": {"reputation": 9594, "user_id": 448734, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/94ccfc629c6862b5950de3512742bcae?s=128&d=identicon&r=PG", "display_name": "Bryan", "link": "https://stackoverflow.com/users/448734/bryan"}, "is_accepted": false, "score": 8, "last_activity_date": 1470928572, "creation_date": 1470928572, "answer_id": 38900253, "question_id": 33113190, "link": "https://stackoverflow.com/questions/33113190/how-to-create-a-statically-linked-golang-executable-with-go-1-5/38900253#38900253", "title": "how to create a statically linked golang executable with go 1.5+", "body": "<p>Static linking:</p>\n\n<p>Go 1.5:</p>\n\n<pre><code>go build -ldflags \"-extldflags -static\" ...\n</code></pre>\n\n<p>With Go 1.6 I had to use:</p>\n\n<pre><code>go build -ldflags \"-linkmode external -extldflags -static\" ...\n</code></pre>\n"}], "owner": {"reputation": 8184, "user_id": 99542, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e94a065789007e8c3301ae1d726e6537?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/99542/richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8761, "favorite_count": 3, "answer_count": 2, "score": 8, "last_activity_date": 1470928572, "creation_date": 1444772728, "last_edit_date": 1444773615, "question_id": 33113190, "link": "https://stackoverflow.com/questions/33113190/how-to-create-a-statically-linked-golang-executable-with-go-1-5", "title": "how to create a statically linked golang executable with go 1.5+", "body": "<p>golang version &lt; 1.5 - there are plenty of static linking examples, posts and recipes.  What about >= 1.5? (google search has returned no useful results for my search terms.) Anyone have any recommendations on how to produce a statically linked binary that can be executed inside a basic rkt (from CoreOS) container?</p>\n\n<p>my go:</p>\n\n<pre><code>$go version\ngo version go1.5 linux/amd64\n</code></pre>\n\n<p>when I try to run my container:</p>\n\n<pre><code>sudo rkt --insecure-skip-verify run /tmp/FastBonusReport.aci\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>[38049.477658] FastBonusReport[4]: Error: Unable to open \"/lib64/ld-linux-x86-64.so.2\": No such file or directory\n</code></pre>\n\n<p>suggesting that the executable in the container is depending on this lib and hence not static.</p>\n\n<p>my manifest looks like:</p>\n\n<pre><code>cat &lt;&lt;EOF &gt; /tmp/${myapp}/manifest\n{\n    \"acKind\": \"ImageManifest\",\n    \"acVersion\": \"0.9.0\",\n    \"name\": \"${lowermyapp}\",\n    \"labels\": [\n        {\"name\": \"os\", \"value\": \"linux\"},\n        {\"name\": \"arch\", \"value\": \"amd64\"}\n    ],\n    \"app\": {\n        \"exec\": [\n            \"/bin/${myapp}\"\n        ],\n        \"user\": \"0\",\n        \"group\": \"0\"\n    }\n}\nEOF\n</code></pre>\n\n<p>my command line to build the binary looks like:</p>\n\n<pre><code>go build ${myapp}.go\n</code></pre>\n\n<p>This <a href=\"http://blog.hashbangbash.com/2014/04/linking-golang-statically/\">article</a> has a few examples golang &lt; 1.5. And then there is this <a href=\"https://coreos.com/rkt/docs/latest/getting-started-guide.html\">getting started</a> article on the CoreOS site.</p>\n"}, {"tags": ["xml", "go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 3, "creation_date": 1444769594, "post_id": 33112235, "comment_id": 54039105, "body": "You&#39;re printing the error, which is nil because it worked. <code>xml.Unmarshal</code> doesn&#39;t return the value, that is being passed in - second arg <code>&amp;b</code>. Additionally on you type <code>Book</code> the fields are unexported (need to be changed to uppercase on first letter) so the unmarshaller will not be able to set their values."}], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 2, "last_activity_date": 1444774109, "last_edit_date": 1444774109, "creation_date": 1444769670, "answer_id": 33112444, "question_id": 33112235, "link": "https://stackoverflow.com/questions/33112235/nil-when-parsing-xml-string-in-golang/33112444#33112444", "title": "&lt;nil&gt; when parsing xml string in golang", "body": "<p>I put the debugging feedback in a comment but I've just modified your example to work and it can be tested here; <a href=\"https://play.golang.org/p/_UIph2je7f\" rel=\"nofollow\">https://play.golang.org/p/_UIph2je7f</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    //\"io/ioutil\"\n    \"encoding/xml\"\n)\n\nfunc check(e error) {\n    if e != nil {\n        panic(e)\n    }\n}\n\ntype Books struct {\n    XMLName xml.Name `xml:\"Books\"`\n    BookList []Book `xml:\"Book\"`\n}\n\ntype Book struct {\n    Title string `xml:\"title,attr\"`\n    Author string `xml:\"author,attr\"`\n    Published string `xml:\"published,attr\"`\n}\n\nfunc main() {\n    //f, err := ioutil.ReadFile(\"xml/Books.xml\")\n    //check(err)\n\n    var data = []byte(`\n        &lt;Books&gt;\n            &lt;Book title=\"A Brief History of Time\" author=\"Stephen Hawking\" published=\"1988\"&gt;\n                &lt;title&gt;title here&lt;/title&gt;\n                A Brief History of Time: From the Big Bang to Black Holes is a 1988 popular-science book by British physicist Stephen Hawking. It became a bestseller and sold more than 10 million copies in 20 years.\n            &lt;/Book&gt;\n            &lt;Book title=\"Steve Jobs\" author=\"Walter Isaacson\" published=\"2011\"&gt;\n                Steve Jobs is the authorized self-titled biography book of Steve Jobs. The book was written at the request of Jobs by Walter Isaacson, a former executive at CNN.\n            &lt;/Book&gt;\n        &lt;/Books&gt;\n    `)\n\n    b := Books{}\n    o := xml.Unmarshal([]byte(data), &amp;b)\n    fmt.Println(o)\n    fmt.Println(b)\n}\n</code></pre>\n\n<p>Here's a rundown of the four changes I made;</p>\n\n<p>1) print the <code>Books</code> object instead of the err returned from <code>Unmarshal</code></p>\n\n<p>2) uppercase the first letter of fields on <code>Book</code> to make them 'exported' so they can be get/set by other packages (the unmarshaller in this case)</p>\n\n<p>3) add xml attributes. In exporting the fields it makes it so there isn't an implicit string match so you gotta explicitly specify which xml value is read into each field</p>\n\n<p>4) update the XML path for <code>BookList</code> for this you said it would be Books>Book but that implies another level of nesting that didn't exist in your xml. This object is <code>Books</code>, the elements you want in that list would have a relative xpath of simply <code>Book</code> so that's what you put there.</p>\n"}], "owner": {"reputation": 1536, "user_id": 1793374, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qK8kV.png?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/1793374/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 411, "favorite_count": 0, "accepted_answer_id": 33112444, "answer_count": 1, "score": -1, "last_activity_date": 1445812163, "creation_date": 1444768924, "last_edit_date": 1445812163, "question_id": 33112235, "link": "https://stackoverflow.com/questions/33112235/nil-when-parsing-xml-string-in-golang", "title": "&lt;nil&gt; when parsing xml string in golang", "body": "<p>I would like to parse <code>xml</code> using <code>golang</code>. Being new to using <code>go</code>, I've read articles around the web, explaining how to parse XML but I'm not sure why my return value is <code>nil</code> in this case.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    //\"io/ioutil\"\n    \"encoding/xml\"\n)\n\nfunc check(e error) {\n    if e != nil {\n        panic(e)\n    }\n}\n\ntype Books struct {\n    XMLName xml.Name `xml:\"Books\"`\n    BookList []Book `xml:\"Books&gt;Book\"`\n}\n\ntype Book struct {\n    title string `xml:\"title,attr\"`\n    author string\n    published string\n}\n\nfunc main() {\n    //f, err := ioutil.ReadFile(\"xml/Books.xml\")\n    //check(err)\n\n    var data = []byte(`\n        &lt;Books&gt;\n            &lt;Book title=\"A Brief History of Time\" author=\"Stephen Hawking\" published=\"1988\"&gt;\n                &lt;title&gt;title here&lt;/title&gt;\n                A Brief History of Time: From the Big Bang to Black Holes is a 1988 popular-science book by British physicist Stephen Hawking. It became a bestseller and sold more than 10 million copies in 20 years.\n            &lt;/Book&gt;\n            &lt;Book title=\"Steve Jobs\" author=\"Walter Isaacson\" published=\"2011\"&gt;\n                Steve Jobs is the authorized self-titled biography book of Steve Jobs. The book was written at the request of Jobs by Walter Isaacson, a former executive at CNN.\n            &lt;/Book&gt;\n        &lt;/Books&gt;\n    `)\n\n    b := Books{}\n    o := xml.Unmarshal([]byte(data), &amp;b)\n    fmt.Println(o)\n}\n</code></pre>\n"}, {"tags": ["go", "interface"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1444768319, "post_id": 33111912, "comment_id": 54038402, "body": "If you want to prevent the wrong type from going through your Compare function, then either check the <code>ok</code> value of the type assertion, or elide it and let the code panic. You&#39;re writing that allows the comparison of different types, then asking why it can compare different types."}, {"owner": {"reputation": 1087, "user_id": 2554442, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/H8XWN.jpg?s=128&g=1", "display_name": "carpenter", "link": "https://stackoverflow.com/users/2554442/carpenter"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444768805, "post_id": 33111912, "comment_id": 54038673, "body": "Yes, I agree that I could handle things of the wrong type. I am not handling the <code>ok</code> value coming back in my implementation because it is in my test and I know that I am calling it with the write types. My main issue is that I believe it is tedious to force users to implement an interface and the interface solution can only be enforced at runtime."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1444769057, "post_id": 33111912, "comment_id": 54038817, "body": "You can enforce the interface implementation at compile time with something like <code>var _ myType = (interfaceType)(nil)</code> at package scope. It&#39;s fairly common practice. You&#39;re talking about passing the wrong type into a method that allows for polymorphic behavior by taking a general type and casting down to a specific one. Try the equivalent in C#, it will throw an <code>InvalidOperationException</code>. In many cases there&#39;s a generic method you can use instead that will give you the error at compile time but even in that context you run into this same thing."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1444776391, "post_id": 33111912, "comment_id": 54042077, "body": "The &quot;problem&quot; arises because the <code>Comparer interface {...}</code> has just one method and the method also takes a <code>Comparer</code> as an argument. If you redesign your solution this &quot;problem&quot; might vanish. In reality you do not write such code, so there is no real problem here. Compile time safety is nice but IMHO not <i>that</i> necessary when invoking interface methods."}, {"owner": {"reputation": 1087, "user_id": 2554442, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/H8XWN.jpg?s=128&g=1", "display_name": "carpenter", "link": "https://stackoverflow.com/users/2554442/carpenter"}, "edited": false, "score": 0, "creation_date": 1444795857, "post_id": 33111912, "comment_id": 54046897, "body": "I would love to know why this is getting down voted. If it doesn&#39;t show research or isn&#39;t helpful, I would love to fix it."}], "answers": [{"comments": [{"owner": {"reputation": 1087, "user_id": 2554442, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/H8XWN.jpg?s=128&g=1", "display_name": "carpenter", "link": "https://stackoverflow.com/users/2554442/carpenter"}, "edited": false, "score": 0, "creation_date": 1444769131, "post_id": 33112128, "comment_id": 54038846, "body": "I understand that a runtime check could be added to handle this situation but I disagree that performing a runtime check is as safe as a compile-time check. But my main issue is that I am attempting to write data structures and am looking for a standard/less demanding-on-users solution. I am willing to proceed with this solution if that is what is expected of programmers in Go. I am new to this environment."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 1087, "user_id": 2554442, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/H8XWN.jpg?s=128&g=1", "display_name": "carpenter", "link": "https://stackoverflow.com/users/2554442/carpenter"}, "edited": false, "score": 0, "creation_date": 1444769312, "post_id": 33112128, "comment_id": 54038951, "body": "@carpenter yeah, sorry I don&#39;t mean to say it is as safe, it&#39;s not. But it is all go offers. As I pointed out in a comment you can verify interface implementation at compile time but that&#39;s not what you&#39;re asking for here. You&#39;re saying &quot;this method can take anything implementing this interface&quot; and then wanting to enforce that the calling type and argument are the same. Like I said, generics address that issue however there are probably thousands of methods in the current version of .NET that are not generic and will behave the same as Go behaves in all cases since it doesn&#39;t feature generics"}, {"owner": {"reputation": 1087, "user_id": 2554442, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/H8XWN.jpg?s=128&g=1", "display_name": "carpenter", "link": "https://stackoverflow.com/users/2554442/carpenter"}, "edited": false, "score": 0, "creation_date": 1444769654, "post_id": 33112128, "comment_id": 54039135, "body": "You are right. The question does not say that is what I am looking for and it does make it sound like Go cannot enforce types at all. I will fix the question."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 1087, "user_id": 2554442, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/H8XWN.jpg?s=128&g=1", "display_name": "carpenter", "link": "https://stackoverflow.com/users/2554442/carpenter"}, "edited": false, "score": 0, "creation_date": 1444770008, "post_id": 33112128, "comment_id": 54039334, "body": "@carpenter anyway, I generally agree with you. This is just how it is. Seems the Go team is pretty adamant about not adding generics to the language. I personally think it&#39;s Go&#39;s biggest short coming but you get used to writing a different style of code and it does work really well."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 2, "last_activity_date": 1444768901, "last_edit_date": 1444768901, "creation_date": 1444768478, "answer_id": 33112128, "question_id": 33111912, "link": "https://stackoverflow.com/questions/33111912/how-to-ensure-compile-time-safety-in-custom-data-structures/33112128#33112128", "title": "How to ensure compile-time safety in custom data structures", "body": "<p>I mean there's nothing unsafe about that code... There just isn't compile time safety. For example, in your method below, the first line does a type assertion on <code>comparer</code>, if it's not a number and you didn't have <code>_</code> for the second item on the LHS then it would return an error and you could act accordingly. Or you could call it without that at all and a <code>panic</code> will occur leaving it up to the caller to handle it (would be appropriate since they're the person calling the method with wrong arguments, would be like getting an <code>InvalidOperationException</code> in C#).</p>\n\n<pre><code>func (n1 number) Compare(comparer Comparer) int {\n    n2, _ := comparer.(number)\n    if n1 &gt; n2 {\n        return 1\n    } else if n1 &lt; n2 {\n        return -1\n    } else {\n        return 0\n    }\n}\n</code></pre>\n\n<p>The difference between this and a language like C# is purely in generics, which allow you to do these kinds of things with more compile time safety (because you're not able to call the method incorrectly). That being said, there was a time before C# had generics and many languages before that which didn't feature them at all. These operations are no more unsafe than the casts you do routinely even in languages <em>that do</em> have generics.</p>\n"}], "owner": {"reputation": 1087, "user_id": 2554442, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/H8XWN.jpg?s=128&g=1", "display_name": "carpenter", "link": "https://stackoverflow.com/users/2554442/carpenter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 33112128, "answer_count": 1, "score": -3, "last_activity_date": 1444774500, "creation_date": 1444767703, "last_edit_date": 1444774500, "question_id": 33111912, "link": "https://stackoverflow.com/questions/33111912/how-to-ensure-compile-time-safety-in-custom-data-structures", "title": "How to ensure compile-time safety in custom data structures", "body": "<p>I am writing some data structures to get my feet wet and learn about the Go language and am struggling with Go's lack of generics. </p>\n\n<p>In my implementations I have chosen to force each user to implement an interface so my structures could refer to these objects abstractly but I don't love my solution because this is not verified at compile-time as you will see.</p>\n\n<h3>Comparer Interface</h3>\n\n<p>Each object that is held in a container must implement a <code>Compare</code> function of the following signature (onerous if all you wanted to hold were raw types)</p>\n\n\n\n<pre><code>type Comparer interface {\n    Compare(Comparer) int\n}\n</code></pre>\n\n<p>You could then have various elements that implement the interface like <code>float64</code> or a custom struct:</p>\n\n<h3>float64</h3>\n\n<pre><code>type number float64\n\nfunc (n1 number) Compare(comparer Comparer) int {\n    n2, _ := comparer.(number)\n    if n1 &gt; n2 {\n        return 1\n    } else if n1 &lt; n2 {\n        return -1\n    } else {\n        return 0\n    }\n}\n</code></pre>\n\n<h3>Person</h3>\n\n<pre><code>type Person struct {\n    Age int\n}\n\nfunc (p1 Person) Compare(comparer Comparer) int {\n    p2, _ := comparer.(Person)\n    if p1.Age &gt; p2.Age {\n        return 1\n    } else if p1.Age &lt; p2.Age {\n        return -1\n    } else {\n        return 0\n    }\n}\n</code></pre>\n\n<p>And now I can compare some of these things:</p>\n\n<pre><code>func main() {\n    fmt.Println(number(2).Compare(number(4)))    // -1\n    fmt.Println(Person{26}.Compare(Person{28}))  // -1\n    fmt.Println(Person{26}.Compare(number(28)))  //  1\n}\n</code></pre>\n\n<p>The problem here is that I should not be able to compare a <code>Person</code> and a <code>number</code>. I realize that I can check the type at runtime but I would like to find either a) a compile-time way to verify the type or b) a different method to implement data structures generically.</p>\n\n<p><strong>Questions</strong></p>\n\n<ol>\n<li>I know that one can do almost everything one might need with the built in data structures ... <em>but</em> how would someone make their own data structures without generics or runtime type checking?</li>\n<li>Since interface implementation in Go appears to use duck typing, how does Go enforce types at compile time?</li>\n</ol>\n"}, {"tags": ["go", "operating-system", "cross-compiling", "travis-ci"], "answers": [{"comments": [{"owner": {"reputation": 3391, "user_id": 4470201, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/558270100/picture?type=large", "display_name": "Shikloshi", "link": "https://stackoverflow.com/users/4470201/shikloshi"}, "edited": false, "score": 0, "creation_date": 1445000017, "post_id": 33165892, "comment_id": 54149509, "body": "Thanks, that&#39;s great!"}], "tags": [], "owner": {"reputation": 118, "user_id": 4105538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675f27a30d3598d2966ee911bcec9f85?s=128&d=identicon&r=PG", "display_name": "Heero Yui", "link": "https://stackoverflow.com/users/4105538/heero-yui"}, "is_accepted": true, "score": 3, "last_activity_date": 1446106468, "last_edit_date": 1446106468, "creation_date": 1444984462, "answer_id": 33165892, "question_id": 33111375, "link": "https://stackoverflow.com/questions/33111375/travis-ci-go-creating-a-specific-build-flow-for-different-os/33165892#33165892", "title": "Travis CI + Go: creating a specific build flow for different OS", "body": "<p>It might be simple, but matrix environement can not be done for a specific OS ...</p>\n\n<p>Then just select with local environement variable:</p>\n\n<pre><code>language: go\ngo: \n  - 1.5.1\nbranches: \n  only: \n    - master\nos:\n  - osx\n  - linux\ninstall:\n  - if [ \"$TRAVIS_OS_NAME\" == \"linux\" ]; then\n        export GIMME_OS=windows;\n        export GIMME_ARCH=amd64;\n    fi\nbefore_script:\n  - go get -d -v ./...\nscript:\n  - go build -v ./...\nafter_script:\n  - go test -v ./...\nbefore_deploy: \n  - ./before_deploy.sh\n</code></pre>\n\n<p>An other way:</p>\n\n<pre><code>language: go\ngo: \n  - 1.5.1\nbranches: \n  only: \n    - master\nmatrix:\n  include:\n    - os: linux\n      env: GIMME_OS=windows; GIMME_ARCH=amd64;\n    - os: osx\nbefore_script:\n  - go get -d -v ./...\nscript:\n  - go build -v ./...\nafter_script:\n  - go test -v ./...\nbefore_deploy: \n  - ./before_deploy.sh\n</code></pre>\n\n<p><strong>Note:</strong> the commande: <code>- chmod +x ./before_deploy.sh</code> can be directly done in your repository and commited on it ...</p>\n\n<p><strong>Note:</strong> The environament variable can be accessibe: <a href=\"http://docs.travis-ci.com/user/environment-variables/#Default-Environment-Variables\" rel=\"nofollow\">http://docs.travis-ci.com/user/environment-variables/#Default-Environment-Variables</a> or calling \\printenv`</p>\n"}], "owner": {"reputation": 3391, "user_id": 4470201, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/558270100/picture?type=large", "display_name": "Shikloshi", "link": "https://stackoverflow.com/users/4470201/shikloshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 628, "favorite_count": 0, "accepted_answer_id": 33165892, "answer_count": 1, "score": 3, "last_activity_date": 1446106468, "creation_date": 1444765737, "question_id": 33111375, "link": "https://stackoverflow.com/questions/33111375/travis-ci-go-creating-a-specific-build-flow-for-different-os", "title": "Travis CI + Go: creating a specific build flow for different OS", "body": "<p>I have a Go project that I want to build with Travis-CI and deploy it to a specific provider.\nI familiar with <a href=\"https://github.com/travis-ci/gimme\" rel=\"nofollow\">Gimme project</a> that will use a cross-compilation to do so.\nBut because Travis already support linux and osx I only need this feature for Windows build. </p>\n\n<p>The big motivation is, of course, to avoid cross-compilation run time error as there are plenty of it.</p>\n\n<p>My question is how can I create, in the same .travis.yml file, a different build flow: </p>\n\n<ol>\n<li>Native linux/os build (with \"os\" section).</li>\n<li>Windows compilation using Gimmme</li>\n</ol>\n\n<p>The .travis.yml file for the first option will look something like:</p>\n\n<pre><code>language: go\n\ngo: \n  - 1.5.1\n\nbranches: \n  only: \n    - master\n\nos:\n    - osx\n    - linux\n\n\nbefore_script:\n    - go get -d -v ./...\n\nscript:\n    - go build -v ./...\n    # - go test -v ./...\n\nbefore_deploy: \n  -  chmod +x ./before_deploy.sh\n  - ./before_deploy.sh\n</code></pre>\n\n<p>The .travis.yml file for the second option will look something like:</p>\n\n<pre><code>language: go\n\ngo: \n  - 1.5.1\n\nbranches: \n  only: \n    - master\n\nenv:\n    - GIMME_OS=windows GIMME_ARCH=amd64\n\n\nbefore_script:\n    - go get -d -v ./...\n\nscript:\n    - go build -v ./...\n    # - go test -v ./...\n\nbefore_deploy: \n  -  chmod +x ./before_deploy.sh\n  - ./before_deploy.sh\n</code></pre>\n\n<p>Is there a nice clean way to combine these two (with Environment variables or any other crazy idea)?</p>\n"}, {"tags": ["go", "interface"], "answers": [{"comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 1800, "user_id": 2372663, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/D76OC.jpg?s=128&g=1", "display_name": "petomalina", "link": "https://stackoverflow.com/users/2372663/petomalina"}, "edited": false, "score": 0, "creation_date": 1444751567, "post_id": 33107029, "comment_id": 54029012, "body": "@Gelidus I can&#39;t help a ton on that but I gave you my two cents."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 6, "last_activity_date": 1444751555, "last_edit_date": 1495542215, "creation_date": 1444751052, "answer_id": 33107029, "question_id": 33106960, "link": "https://stackoverflow.com/questions/33106960/implementing-interface-method-with-variable-arguments/33107029#33107029", "title": "Implementing interface method with variable arguments", "body": "<p>This doesn't implement the interface;</p>\n\n<pre><code>func (m *TestModule) Init(str string) error {\n    return nil\n}\n</code></pre>\n\n<p>Where your confusion arises is in \"because this method should match any number of provided arguments\" this is a language feature which lets the <em>caller</em> invoke the method with a variable number of arguments (see here <a href=\"https://stackoverflow.com/questions/10128771/what-does-mean-when-next-to-a-parameter-in-a-go-function-declaration\">What does &quot;...&quot; mean when next to a parameter in a go function declaration?</a>). To implement it you need to implement the same signature meaning <code>... interface{}</code>.</p>\n\n<p>So to be clear, the 'any number of provided arguments' is for calling the method only, that doesn't mean you can implement the method with any set of arguments of any types and it will have the same definition. The definition states there will be a variable number of items implementing <code>interface{}</code> passed in by the caller.</p>\n\n<p>\"is there any best practice to implement this kind of behaviour?\"</p>\n\n<p>Not that I know of. I think the common practice would be to relax the type being passed in to <code>interface{}</code> or the <code>... interface{}</code> and then inspect the collection inside the method. For example, if the <code>Module</code> interface had it's definition as <code>Init(deps interface{}) error</code> then you could implement it in test module like this;</p>\n\n<pre><code>func (m *TestModule) Init(deps interface{}) error {\n      str := deps.(string)\n      return nil\n}\n</code></pre>\n\n<p>If you want variable length of args, you would just have to add a <code>for range</code> construct into the method to unbox the value or do some bounds checking. I can't speak to whether or not this would be a good practice in your application because I think it depends on how much value you get from having a single method sig. It adds extra boiler plate code and has some minor performance penalty.</p>\n"}], "owner": {"reputation": 1800, "user_id": 2372663, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/D76OC.jpg?s=128&g=1", "display_name": "petomalina", "link": "https://stackoverflow.com/users/2372663/petomalina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 33107029, "answer_count": 1, "score": 1, "last_activity_date": 1444751555, "creation_date": 1444750859, "last_edit_date": 1444751136, "question_id": 33106960, "link": "https://stackoverflow.com/questions/33106960/implementing-interface-method-with-variable-arguments", "title": "Implementing interface method with variable arguments", "body": "<p>I started with the simple interface:</p>\n\n<pre><code>type Module interface {\n    Init(deps ...interface{}) error\n}\n</code></pre>\n\n<p>I thought, the implementation will be really simple, because this method should match any number of provided arguments. This is what I end up with this code, thinking, the <code>TestModule</code> implements the <code>Module</code> interface.</p>\n\n<pre><code>type TestModule struct {\n}\n\nfunc (m *TestModule) Init(str string) error {\n    return nil\n}\n</code></pre>\n\n<p>But when I want to pass the TestModule to any function that wants Module, I get this error:</p>\n\n<blockquote>\n  <p>cannot use module(type *TestModule) as type Module in argument to testFunc:</p>\n</blockquote>\n\n<pre><code>func testFunc(module Module) {\n\n}\n</code></pre>\n\n<p>Edit: is there any best practice to implement this kind of behaviour?</p>\n"}, {"tags": ["api", "go", "concurrency", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 9, "creation_date": 1444744106, "post_id": 33104192, "comment_id": 54023671, "body": "you&#39;re trying to open too many sockets. Either limit the concurrent requests, or increase the process limits."}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 5, "creation_date": 1444747160, "post_id": 33104192, "comment_id": 54026015, "body": "you are also incrementing total in an unsafe way, it easily won&#39;t add up to the number of runs.  Use atomic.AddInt64(&amp;total) (and change to total := int64(0))"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1444759167, "post_id": 33104192, "comment_id": 54033384, "body": "@evanmcdonnal: that error is caused by running out of file descriptors. Has nothing to do with the remote host."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1444761841, "post_id": 33104192, "comment_id": 54034834, "body": "Oh that makes sense. My mistake."}, {"owner": {"reputation": 49, "user_id": 5441005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4ea6430c5e590a6df066bf73320267?s=128&d=identicon&r=PG&f=1", "display_name": "Shashank pai k", "link": "https://stackoverflow.com/users/5441005/shashank-pai-k"}, "edited": false, "score": 0, "creation_date": 1444818677, "post_id": 33104192, "comment_id": 54058579, "body": "can i restrict like only 1024 requests at a time (ie go routines) amd rest have to wait ??"}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1444837840, "post_id": 33127681, "comment_id": 54071748, "body": "Another more common pattern is to have &quot;concurrency&quot; number of worker goroutines ranging over a channel, instead of spawning a new goroutine each time."}, {"owner": {"reputation": 745, "user_id": 2540509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a053895b4bd95faef139fb2f9a87ec9e?s=128&d=identicon&r=PG", "display_name": "Antony Mativos", "link": "https://stackoverflow.com/users/2540509/antony-mativos"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444846155, "post_id": 33127681, "comment_id": 54076674, "body": "@JimB Right, will add an additional example."}], "tags": [], "owner": {"reputation": 745, "user_id": 2540509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a053895b4bd95faef139fb2f9a87ec9e?s=128&d=identicon&r=PG", "display_name": "Antony Mativos", "link": "https://stackoverflow.com/users/2540509/antony-mativos"}, "is_accepted": false, "score": 5, "last_activity_date": 1444847073, "last_edit_date": 1444847073, "creation_date": 1444831857, "answer_id": 33127681, "question_id": 33104192, "link": "https://stackoverflow.com/questions/33104192/how-to-run-10000-goroutines-in-parallel-where-each-routine-calls-an-api/33127681#33127681", "title": "how to run 10000 goroutines in parallel where each routine calls an api?", "body": "<p>As others mentioned in the comments, your main issue is that you are exceeding the open file limit of the process.</p>\n\n<p>You can easily implement a semaphore using channels to limit concurrency:</p>\n\n<pre><code>totalRequests := 100000\nconcurrency := 1024\nsem := make(chan bool, concurrency)\n\nstart := time.Now()\ntotal := int32(0)\n\nfor i := 0; i &lt; totalRequests; i++ {\n    sem &lt;- true\n\n    go func(current int) {\n        startTime := time.Now()\n\n        // Make request here\n\n        elapsedTime := time.Since(startTime)\n        atomic.AddInt32(&amp;total, 1)\n        fmt.Printf(\"Request %d took %s. Requests completed: %d\\n\", current, elapsedTime, atomic.LoadInt32(&amp;total))\n\n        &lt;-sem\n    }(i)\n}\n\nfor i := 0; i &lt; cap(sem); i++ {\n    sem &lt;- true\n}\nelapsedTotal := time.Since(start)\nfmt.Printf(\"\\nTotal time elapsed: %s\\n\", elapsedTotal)\n</code></pre>\n\n<p>This will limit the number of parallel requests to whatever is specified in <code>concurrency</code>.</p>\n\n<p>As you can see, the <code>total</code> variable is incremented using the <code>atomic</code> package since we are modifying that variable from potentially parallel goroutines, which could have produced an incorrect total when modified unsafely, as you did.</p>\n\n<p>See this blog post for the original example &amp; explanation of limiting concurrency in Go: <a href=\"http://jmoiron.net/blog/limiting-concurrency-in-go\" rel=\"noreferrer\">http://jmoiron.net/blog/limiting-concurrency-in-go</a></p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>As mentioned by JimB below, another common approach is to have <code>concurrency</code> number of goroutines doing the work while we feed it to them. Here's a generic <code>do</code> function that one might use for this:</p>\n\n<pre><code>func do(total, concurrency int, fn func(int)) {\n    workQueue := make(chan int, concurrency)\n\n    var wg sync.WaitGroup\n    wg.Add(concurrency)\n\n    for i := 0; i &lt; concurrency; i++ {\n        go func() {\n            for i := range workQueue {\n                fn(i)\n            }\n            wg.Done()\n        }()\n    }\n    for i := 0; i &lt; total; i++ {\n        workQueue &lt;- i\n    }\n    close(workQueue)\n    wg.Wait()\n}\n</code></pre>\n\n<p>We spawn <code>concurrency</code> goroutines and then start sending values to the <code>workQueue</code> channel until <code>total</code> is sent. By closing the <code>workQueue</code> channel we effectively terminate the range loops in our goroutines. After that we just wait until all the remaining goroutines finish running.</p>\n\n<p>For the use case in question, it could be used like this:</p>\n\n<pre><code>totalRequests := 1000000\nconcurrency := 1024\n\ndo(totalRequests, concurrency, func(i int) {\n    // Make request here\n\n    fmt.Printf(\"Request %d done.\\n\", i)\n})\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 5441005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4ea6430c5e590a6df066bf73320267?s=128&d=identicon&r=PG&f=1", "display_name": "Shashank pai k", "link": "https://stackoverflow.com/users/5441005/shashank-pai-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1750, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444847073, "creation_date": 1444743503, "last_edit_date": 1444771181, "question_id": 33104192, "link": "https://stackoverflow.com/questions/33104192/how-to-run-10000-goroutines-in-parallel-where-each-routine-calls-an-api", "title": "how to run 10000 goroutines in parallel where each routine calls an api?", "body": "<p>I have the following code, where I am trying to call an api 10000 times but i am getting errors:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"net/http\"\n    \"runtime\"\n    \"sync\"\n    \"time\"\n)\n\nfunc main() {\n\n    nCPU := runtime.NumCPU()\n    runtime.GOMAXPROCS(nCPU)\n\n    var wg sync.WaitGroup\n    totalRequests := 100000\n    wg.Add(totalRequests)\n\n    fmt.Println(\"Starting Go Routines\")\n\n    start := time.Now()\n    total := 0\n\n    for i := 0; i &lt; totalRequests; i++ {\n\n        go func(current int) {\n            defer wg.Done()\n\n            startFunc := time.Now()\n            _, err := http.Get(\"http://127.0.0.1:8080/event/list\")\n            // resp, err := http.Get(\"https://graph.facebook.com/v2.4/me\" + \"?fields=id%2Cname&amp;access_token=\" + \"CAACEdEose0cBAEpQvcsvVMQu5oZCyyDjcEPQi9yCdiXimm4F0AYexGHPZAJHgpyrFOJN5X1VMcicNJjlkaCquUqHMZAfRrtxx6K9cRIROrA0OmbqAqCcg8ZA3qJZCHCl68I1n4LtFb5qxPcotlP5ne5PBakK0OUa7sc6FAOWwByOnFtNZBpIe8XDeM4YFa33sDfftVUpZCoBgZDZD\")\n\n            if err != nil {\n                fmt.Println(err)\n            }\n            // defer resp.Body.Close()\n            elapsedFunc := time.Since(startFunc)\n            fmt.Println(\"The request (\", current, \") took\", elapsedFunc, \"No of requests completed\", total)\n            total++\n\n        }(i)\n\n    }\n\n    wg.Wait()\n    elapsed := time.Since(start)\n    fmt.Println(\"\\nThe total time with cores\", elapsed)\n    fmt.Println(\"\\nTerminating Program\")\n}\n</code></pre>\n\n<p>The errors I am getting:</p>\n\n<pre><code>Get http://127.0.0.1:8080/event/list: dial tcp 127.0.0.1:8080: socket: too many open files\nThe request ( 5390 ) took 1.619876633s No of requests completed 2781\nGet http://127.0.0.1:8080/event/list: dial tcp 127.0.0.1:8080: socket: too many open files\nThe request ( 7348 ) took 650.609825ms No of requests completed 1445\n</code></pre>\n"}, {"tags": ["google-app-engine", "go", "polymer"], "answers": [{"comments": [{"owner": {"reputation": 2178, "user_id": 104104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e4c9652e58d33f02977db1ef0979e6d1?s=128&d=identicon&r=PG", "display_name": "chila", "link": "https://stackoverflow.com/users/104104/chila"}, "edited": false, "score": 0, "creation_date": 1444744568, "post_id": 33103675, "comment_id": 54024026, "body": "I&#39;m not familiar with gcloud. I&#39;m just using goapp. I tried putting them uppercase, but it does not work either."}, {"owner": {"reputation": 6465, "user_id": 1182891, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/64170963e481496b89074f68786f4aeb?s=128&d=identicon&r=PG", "display_name": "Josh J", "link": "https://stackoverflow.com/users/1182891/josh-j"}, "reply_to_user": {"reputation": 2178, "user_id": 104104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e4c9652e58d33f02977db1ef0979e6d1?s=128&d=identicon&r=PG", "display_name": "chila", "link": "https://stackoverflow.com/users/104104/chila"}, "edited": false, "score": 1, "creation_date": 1444745055, "post_id": 33103675, "comment_id": 54024373, "body": "gcloud is the unified tooling for deploying app engine applications so it shares a lot of the same infrastructure and ideas as the app engine sdk."}, {"owner": {"reputation": 6465, "user_id": 1182891, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/64170963e481496b89074f68786f4aeb?s=128&d=identicon&r=PG", "display_name": "Josh J", "link": "https://stackoverflow.com/users/1182891/josh-j"}, "reply_to_user": {"reputation": 2178, "user_id": 104104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e4c9652e58d33f02977db1ef0979e6d1?s=128&d=identicon&r=PG", "display_name": "chila", "link": "https://stackoverflow.com/users/104104/chila"}, "edited": false, "score": 0, "creation_date": 1444745746, "post_id": 33103675, "comment_id": 54024930, "body": "According to <a href=\"https://golang.org/pkg/net/http/\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http</a> it should respect HTTP_PROXY based on your current <code>env</code>. Stupid question but are those environment variables set in the env of the user that you are running <code>goapp serve</code> as?"}, {"owner": {"reputation": 2178, "user_id": 104104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e4c9652e58d33f02977db1ef0979e6d1?s=128&d=identicon&r=PG", "display_name": "chila", "link": "https://stackoverflow.com/users/104104/chila"}, "edited": false, "score": 0, "creation_date": 1444829878, "post_id": 33103675, "comment_id": 54065956, "body": "Yes, they are.  /* comments must be 15 chars long, so I&#39;ll fill this one with a comment. */"}, {"owner": {"reputation": 6465, "user_id": 1182891, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/64170963e481496b89074f68786f4aeb?s=128&d=identicon&r=PG", "display_name": "Josh J", "link": "https://stackoverflow.com/users/1182891/josh-j"}, "reply_to_user": {"reputation": 2178, "user_id": 104104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e4c9652e58d33f02977db1ef0979e6d1?s=128&d=identicon&r=PG", "display_name": "chila", "link": "https://stackoverflow.com/users/104104/chila"}, "edited": false, "score": 0, "creation_date": 1444830737, "post_id": 33103675, "comment_id": 54066634, "body": "If it still isn&#39;t working then it may be a bug and you can report it here <a href=\"https://code.google.com/p/googleappengine/wiki/FilingIssues\" rel=\"nofollow noreferrer\">code.google.com/p/googleappengine/wiki/FilingIssues</a>"}, {"owner": {"reputation": 6465, "user_id": 1182891, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/64170963e481496b89074f68786f4aeb?s=128&d=identicon&r=PG", "display_name": "Josh J", "link": "https://stackoverflow.com/users/1182891/josh-j"}, "reply_to_user": {"reputation": 2178, "user_id": 104104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e4c9652e58d33f02977db1ef0979e6d1?s=128&d=identicon&r=PG", "display_name": "chila", "link": "https://stackoverflow.com/users/104104/chila"}, "edited": false, "score": 0, "creation_date": 1444830965, "post_id": 33103675, "comment_id": 54066776, "body": "@chila See <a href=\"https://code.google.com/p/googleappengine/issues/detail?id=544\" rel=\"nofollow noreferrer\">code.google.com/p/googleappengine/issues/detail?id=544</a> I have updated my answer to also include this bug report."}], "tags": [], "owner": {"reputation": 6465, "user_id": 1182891, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/64170963e481496b89074f68786f4aeb?s=128&d=identicon&r=PG", "display_name": "Josh J", "link": "https://stackoverflow.com/users/1182891/josh-j"}, "is_accepted": false, "score": 2, "last_activity_date": 1444830943, "last_edit_date": 1444830943, "creation_date": 1444742099, "answer_id": 33103675, "question_id": 33103557, "link": "https://stackoverflow.com/questions/33103557/problems-using-go-app-engine-behind-a-proxy/33103675#33103675", "title": "Problems using Go App Engine behind a proxy", "body": "<p><strong>EDIT</strong> Looks like there is a defect in the SDK around using a proxy with URLFetch.</p>\n\n<p><a href=\"https://code.google.com/p/googleappengine/issues/detail?id=544\" rel=\"nofollow\">https://code.google.com/p/googleappengine/issues/detail?id=544</a></p>\n\n<p>Try setting the uppercase versions of those environment variables, <code>HTTP_PROXY</code> and <code>HTTPS_PROXY</code>. The <a href=\"https://cloud.google.com/sdk/gcloud-app#Using_an_HTTP_proxy\" rel=\"nofollow\"><code>gcloud</code> launcher</a> requires them that way so I assume <code>goapp</code> does as well.</p>\n\n<blockquote>\n  <p><strong>Using an HTTP proxy</strong></p>\n  \n  <p>If you are running gcloud preview app behind an HTTP proxy, you must\n  tell gcloud preview app the name of the proxy. To set an HTTP proxy\n  for gcloud preview app, set the http_proxy and https_proxy environment\n  variables. Note that you must specify the full path for the app.yaml\n  file.</p>\n  \n  <p>Using Windows (in Command Prompt):</p>\n\n<pre><code>$ set HTTP_PROXY=http://cache.mycompany.com:3128\n$ set HTTPS_PROXY=http://cache.mycompany.com:3128\n$ gcloud preview app deploy DIRECTORY/app.yaml\n</code></pre>\n  \n  <p>Using the command line in Mac OS X (in Terminal) or Linux:</p>\n\n<pre><code>$ export HTTP_PROXY=\"http://cache.mycompany.com:3128\"\n$ export HTTPS_PROXY=\"http://cache.mycompany.com:3128\"\n$ gcloud preview app deploy DIRECTORY/app.yaml\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 2178, "user_id": 104104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e4c9652e58d33f02977db1ef0979e6d1?s=128&d=identicon&r=PG", "display_name": "chila", "link": "https://stackoverflow.com/users/104104/chila"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1444830943, "creation_date": 1444741706, "question_id": 33103557, "link": "https://stackoverflow.com/questions/33103557/problems-using-go-app-engine-behind-a-proxy", "title": "Problems using Go App Engine behind a proxy", "body": "<p>I'm trying to run the example application hosted at: <a href=\"https://github.com/googlesamples/cloud-polymer-go\" rel=\"nofollow\">https://github.com/googlesamples/cloud-polymer-go</a>, but when running it behind a proxy, I get the following errors:</p>\n\n<pre><code>$ goapp serve dispatch.yaml frontend/app.yaml backend/app.yaml\nINFO     2015-10-13 13:04:19,461 devappserver2.py:763] Skipping SDK update check.\nINFO     2015-10-13 13:04:19,526 api_server.py:205] Starting API server at: http://localhost:59441\nINFO     2015-10-13 13:04:19,527 dispatcher.py:185] Starting dispatcher running at: http://localhost:8080\nINFO     2015-10-13 13:04:19,529 dispatcher.py:197] Starting module \"frontend\" running at: http://localhost:8081\nINFO     2015-10-13 13:04:19,534 dispatcher.py:197] Starting module \"default\" running at: http://localhost:8082\nINFO     2015-10-13 13:04:19,534 admin_server.py:116] Starting admin server at: http://localhost:8000\nINFO     2015-10-13 13:04:23,859 module.py:786] frontend: \"GET / HTTP/1.1\" 304 -\nINFO     2015-10-13 13:04:23,870 module.py:786] frontend: \"GET /elements/post-list.html HTTP/1.1\" 304 -\nINFO     2015-10-13 13:04:24,377 module.py:786] frontend: \"GET /elements/post-service.html HTTP/1.1\" 304 -\nINFO     2015-10-13 13:04:24,377 module.py:786] frontend: \"GET /elements/post-form.html HTTP/1.1\" 304 -\nINFO     2015-10-13 13:04:24,377 module.py:786] frontend: \"GET /elements/post-card.html HTTP/1.1\" 304 -\nWARNING  2015-10-13 13:04:26,344 dispatcher.py:762] Skipping dispatch.yaml rules because /_ah/api/static/proxy.html is not a dispatchable path.\nsocket.error 101\nTraceback (most recent call last):\n  File \"/home/robert/applib/appEngine/go_appengine/lib/cherrypy/cherrypy/wsgiserver/wsgiserver2.py\", line 1302, in communicate\n    req.respond()\n  File \"/home/robert/applib/appEngine/go_appengine/lib/cherrypy/cherrypy/wsgiserver/wsgiserver2.py\", line 831, in respond\n    self.server.gateway(self).respond()\n  File \"/home/robert/applib/appEngine/go_appengine/lib/cherrypy/cherrypy/wsgiserver/wsgiserver2.py\", line 2117, in respond\n    for chunk in response:\n  File \"/home/robert/applib/appEngine/go_appengine/google/appengine/tools/devappserver2/endpoints/endpoints_server.py\", line 121, in __call__\n    yield self.dispatch(request, start_response)\n  File \"/home/robert/applib/appEngine/go_appengine/google/appengine/tools/devappserver2/endpoints/endpoints_server.py\", line 138, in dispatch\n    start_response)\n  File \"/home/robert/applib/appEngine/go_appengine/google/appengine/tools/devappserver2/endpoints/endpoints_server.py\", line 172, in dispatch_non_api_requests\n    return dispatch_function(request, start_response)\n  File \"/home/robert/applib/appEngine/go_appengine/google/appengine/tools/devappserver2/endpoints/endpoints_server.py\", line 212, in handle_api_static_request\n    response, body = discovery_api.get_static_file(request.relative_url)\n  File \"/home/robert/applib/appEngine/go_appengine/google/appengine/tools/devappserver2/endpoints/discovery_api_proxy.py\", line 113, in get_static_file\n    connection.request('GET', path, None, {})\n  File \"/usr/lib/python2.7/httplib.py\", line 979, in request\n    self._send_request(method, url, body, headers)\n  File \"/usr/lib/python2.7/httplib.py\", line 1013, in _send_request\n    self.endheaders(body)\n  File \"/usr/lib/python2.7/httplib.py\", line 975, in endheaders\n    self._send_output(message_body)\n  File \"/usr/lib/python2.7/httplib.py\", line 835, in _send_output\n    self.send(msg)\n  File \"/usr/lib/python2.7/httplib.py\", line 797, in send\n    self.connect()\n  File \"/usr/lib/python2.7/httplib.py\", line 1178, in connect\n    self.timeout, self.source_address)\n  File \"/usr/lib/python2.7/socket.py\", line 571, in create_connection\n    raise err\nerror: [Errno 101] Network is unreachable\n</code></pre>\n\n<p>The variables:</p>\n\n<pre><code>$ echo $http_proxy \nhttp://asusis-isa2.personal.com.py:8080/\n$ echo $https_proxy \nhttp://asusis-isa2.personal.com.py:8080/\n</code></pre>\n\n<p>Are correctly set.</p>\n\n<p>I works with a direct Internet connection.</p>\n\n<p>I'm under Ubuntu 14.04.</p>\n"}, {"tags": ["json", "reflection", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1444744965, "post_id": 33100910, "comment_id": 54024292, "body": "I am unsure if I understand the problem. Maybe you should show code of what you would like to merge into what."}], "answers": [{"tags": [], "owner": {"reputation": 1615, "user_id": 1376205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ff8ba613f2dc50cc30e7f3af3e2914?s=128&d=identicon&r=PG", "display_name": "Will C", "link": "https://stackoverflow.com/users/1376205/will-c"}, "is_accepted": false, "score": 1, "last_activity_date": 1444740604, "creation_date": 1444740604, "answer_id": 33103200, "question_id": 33100910, "link": "https://stackoverflow.com/questions/33100910/is-it-possible-to-merge-merge-multiple-structs-into-one-dynamically-using-refle/33103200#33103200", "title": "Is it possible to merge/merge multiple structs into one dynamically (using reflect)?", "body": "<p>I'm not sure if this answers your question but you can definitely embed structs into one struct and access the properties directly. You wouldn't need to use reflection and might I add that its often the case that reflection is frowned upon since its more preferable to be explicit; reflection is often implicit.</p>\n\n<p>Here is some code, that hopefully addresses what you wanted:</p>\n\n<pre><code>type Foo struct {\n  Bar\n  Baz\n}\n\ntype Bar struct {\n  BarValue string\n}\n\ntype Baz struct {\n  BazValue string\n}\n\nfunc main() {\n  test := Foo{Bar: Bar{BarValue: \"bar\"}, Baz: Baz{BazValue: \"baz\"}}\n  fmt.Println(test.BarValue)\n  fmt.Println(test.BazValue)\n}\n</code></pre>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1444740604, "creation_date": 1444733941, "question_id": 33100910, "link": "https://stackoverflow.com/questions/33100910/is-it-possible-to-merge-merge-multiple-structs-into-one-dynamically-using-refle", "title": "Is it possible to merge/merge multiple structs into one dynamically (using reflect)?", "body": "<p>I need to build a function which merges responses from multiple other functions into one (struct). Currently I'm thinking that the only way would be to create a map[string]interface{} and then range over the fields of structs I need to merge and assign field name -> value as key, values in the map. Is there any other way? I basically just need to embed two structs into one.</p>\n"}, {"tags": ["go", "beego"], "comments": [{"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1444732913, "post_id": 33100091, "comment_id": 54015974, "body": "I don&#39;t see a way to do it without assembly, either."}, {"owner": {"reputation": 191, "user_id": 4074586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30b8eaeb188788da55f046402d6e9277?s=128&d=identicon&r=PG&f=1", "display_name": "Diablojoe", "link": "https://stackoverflow.com/users/4074586/diablojoe"}, "reply_to_user": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1444733796, "post_id": 33100091, "comment_id": 54016485, "body": "I could change the timeout constant in src/net/hosts.go and roll my own custom go build but there has to be another way. Glad to see I&#39;m not the only one a but stuck on this one."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1444743175, "post_id": 33100091, "comment_id": 54022930, "body": "Normally dynamic changes should be done via another mechanism, like dns or another config db. If you build the binary with cgo enabled, it will use the system resolver to lookup hosts (that also doesn&#39;t guarantee it won&#39;t be cached for a short period by your system, but it&#39;s usually less than 5 minutes in most cases)"}, {"owner": {"reputation": 1652, "user_id": 918176, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2bdb37b11c35de00bb68359342a82f38?s=128&d=identicon&r=PG", "display_name": "user918176", "link": "https://stackoverflow.com/users/918176/user918176"}, "edited": false, "score": 0, "creation_date": 1448053998, "post_id": 33100091, "comment_id": 55437608, "body": "@Diablojoe I think you might also make a copy of the library that uses hosts.go, and patch it to use a modified version. That&#39;s an option unless you use large amount of affected libraries in your solution. Other than that,  it&#39;s the way it is probably by design... You probably have already selected a solution? Would you please document it as an answer :)"}, {"owner": {"reputation": 3099, "user_id": 1595320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a7394f8a600a66b2dfaf6613fd32f8fc?s=128&d=identicon&r=PG", "display_name": "Riscie", "link": "https://stackoverflow.com/users/1595320/riscie"}, "edited": false, "score": 0, "creation_date": 1453729397, "post_id": 33100091, "comment_id": 57716216, "body": "I just tested this with the following code. When I run it and add the host to my host file, it resolves it immediately. Am I missing something? <a href=\"https://play.golang.org/p/HwOLn3w9BP\" rel=\"nofollow noreferrer\">play.golang.org/p/HwOLn3w9BP</a> Do you depend on another function than net.LookupHost()?"}, {"owner": {"reputation": 5678, "user_id": 2487549, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/874b378607eb21bc868bdadb8847560f?s=128&d=identicon&r=PG", "display_name": "Foreever", "link": "https://stackoverflow.com/users/2487549/foreever"}, "edited": false, "score": 0, "creation_date": 1496770453, "post_id": 33100091, "comment_id": 75792471, "body": "I&#39;m also facing similar issue. Hosts added through <code>extra_hosts</code> parameter in Docker Compose is not being identified when calling <code>http.Get</code> method"}], "answers": [{"tags": [], "owner": {"reputation": 752, "user_id": 7496656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zMGuk.jpg?s=128&g=1", "display_name": "Jan Zerebecki", "link": "https://stackoverflow.com/users/7496656/jan-zerebecki"}, "is_accepted": false, "score": 0, "last_activity_date": 1500406674, "creation_date": 1500406674, "answer_id": 45175635, "question_id": 33100091, "link": "https://stackoverflow.com/questions/33100091/is-there-a-way-to-force-refresh-hosts-in-go/45175635#45175635", "title": "Is there a way to force refresh hosts in go?", "body": "<p><a href=\"https://github.com/golang/go/commit/b598a7fc5d167fe5be137d2c5cc9f1f6a01636ef\" rel=\"nofollow noreferrer\">The hosts file cache time in Go was shortened to 5 seconds.</a> The behaviour of Go differs whether the pure Go (default, with exceptions) or Cgo resolver is used. To avoid the Go internal cache of the pure Go resolver there is currently no way other than to force the Cgo resolver.</p>\n\n<p><a href=\"https://github.com/golang/go/blob/4bd95702dd1e81f383ee67c14945620d30247908/src/net/conf.go\" rel=\"nofollow noreferrer\">There are various ways to force Go to use the Cgo resolver.</a> The <a href=\"https://golang.org/pkg/net/#Resolver\" rel=\"nofollow noreferrer\">way to force Go to use the Cgo resolver suggested by the documentation</a> is to set the environment variable <code>GODEBUG</code> to <code>netdns=cgo</code>.</p>\n"}], "owner": {"reputation": 191, "user_id": 4074586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30b8eaeb188788da55f046402d6e9277?s=128&d=identicon&r=PG&f=1", "display_name": "Diablojoe", "link": "https://stackoverflow.com/users/4074586/diablojoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 672, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1500406674, "creation_date": 1444731451, "question_id": 33100091, "link": "https://stackoverflow.com/questions/33100091/is-there-a-way-to-force-refresh-hosts-in-go", "title": "Is there a way to force refresh hosts in go?", "body": "<p>I am running a Beego application that relies on updates in /etc/hosts (via Docker links) to find other servers. /etc/hosts updates fine but the application will not use new hosts unless it is either restarted or after it has waited way too long. After reviewing the documentation for <a href=\"https://golang.org/src/net/hosts.go\" rel=\"noreferrer\">src/net/hosts</a> it looks like I am locked into a 5 minute refresh time.</p>\n\n<p>Is there a way to force this cache to refresh or am I looking at this problem the wrong way?</p>\n"}, {"tags": ["google-app-engine", "go", "oauth-2.0", "google-api", "google-analytics-api"], "answers": [{"tags": [], "owner": {"reputation": 5515, "user_id": 534005, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/aa6285532343827af4b4811de7d52277?s=128&d=identicon&r=PG", "display_name": "murrekatt", "link": "https://stackoverflow.com/users/534005/murrekatt"}, "is_accepted": true, "score": 1, "last_activity_date": 1444841717, "last_edit_date": 1495539906, "creation_date": 1444733891, "answer_id": 33100894, "question_id": 33099412, "link": "https://stackoverflow.com/questions/33099412/asserting-identity-to-google-apis-with-app-engine-development-server/33100894#33100894", "title": "Asserting identity to Google APIs with App Engine development server", "body": "<p>It is possible to provide the development server with the necessary information at start like <a href=\"https://stackoverflow.com/a/22723127/534005\">here</a>.</p>\n\n<pre><code>$ dev_appserver.py --appidentity_email_address email --appidentity_private_key_path file.pem\n</code></pre>\n\n<p>And for App Engine you need to not use this Service Account but the one with the app name:</p>\n\n<pre><code>app_name@appspot.gserviceaccount.com\n</code></pre>\n"}], "owner": {"reputation": 5515, "user_id": 534005, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/aa6285532343827af4b4811de7d52277?s=128&d=identicon&r=PG", "display_name": "murrekatt", "link": "https://stackoverflow.com/users/534005/murrekatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 33100894, "answer_count": 1, "score": 1, "last_activity_date": 1444841717, "creation_date": 1444729637, "last_edit_date": 1444829452, "question_id": 33099412, "link": "https://stackoverflow.com/questions/33099412/asserting-identity-to-google-apis-with-app-engine-development-server", "title": "Asserting identity to Google APIs with App Engine development server", "body": "<p>I have a Golang app running on App Engine and <strong>I would like to call the Analytics API to process some metrics. Both on App Engine and on the development server.</strong></p>\n\n<p><a href=\"https://developers.google.com/identity/protocols/OAuth2ServiceAccount\" rel=\"nofollow\">This page describes the overall procedure</a> using a service account for server-to-server communication and getting an access token using OAuth2. I would like to avoid doing this myself so I found <a href=\"https://github.com/google/google-api-go-client/blob/master/analytics/v3/analytics-gen.go\" rel=\"nofollow\">Google APIs for Go</a> and the following that describes <a href=\"https://cloud.google.com/appengine/docs/go/appidentity/#Go_Asserting_identity_to_Google_APIs\" rel=\"nofollow\">how to do it for App Engine</a>.</p>\n\n<p>I have added the App Engine app's service account email to Google Analytics for read access.</p>\n\n<p>I have played around with queries using the <a href=\"https://ga-dev-tools.appspot.com/query-explorer/\" rel=\"nofollow\">Query Explorer</a> and that works great. I have even used the API Query URI from here that includes the proper access token and that works fine. That works fine with cURL or calling it through urlfetch on App Engine.</p>\n\n<p><strong>What I need is to get hold of an access token automatically on App Engine and also while using the development server.</strong></p>\n\n<p>In here is an example for URL shortener which a have modified to use the Analytics API instead. </p>\n\n<pre><code>    client := http.Client{\n            Transport: &amp;oauth2.Transport{\n                    Source: google.AppEngineTokenSource(c, analytics.AnalyticsScope),\n                    Base: &amp;urlfetch.Transport{Context: c},\n            },\n    }\n    svc, err := analytics.New(&amp;client)\n    if err != nil {\n            return nil, err\n    }\n\n    data, err := svc.Data.Ga.Get(\"...\")\n</code></pre>\n\n<p>The response in the development server is <em>401 Invalid Credentials, authError.</em></p>\n\n<p><strong>Is this supposed to work like this or am I missing something?</strong></p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>So, the problem is half solved. It works fine now using the development server when I pass in the service account's email and <code>.pem</code> file. However, that very same service account that is in App Engine does not work with the above code!</p>\n\n<pre><code>googleapi: Error 403: User does not have any Google Analytics account., insufficientPermissions\n</code></pre>\n\n<p>User should be the service account that I already successfully use on the development server, so I don't really understand this problem. It's the exact same code on App Engine and on the development server as well.</p>\n\n<p>Google Analytics is set up to have read access and I use the read-only API. And it already works on the development server so that should be fine. </p>\n\n<p><strong>What might be different that is the issue?</strong></p>\n"}, {"tags": ["parsing", "go"], "answers": [{"tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": false, "score": 1, "last_activity_date": 1444731411, "creation_date": 1444731411, "answer_id": 33100074, "question_id": 33099162, "link": "https://stackoverflow.com/questions/33099162/how-to-parse-result-from-ovs-vsctl-get-interface-interface-statistics/33100074#33100074", "title": "How to parse result from ovs-vsctl get interface &lt;interface&gt; statistics", "body": "<p>If that transport format is not recursively defined, i.e. a key cannot start a sub-structure, then its language is <a href=\"https://en.wikipedia.org/wiki/Regular_language\" rel=\"nofollow\">regular</a>. As such, you can soundly parse it with Go's standard <code>regexp</code> package: </p>\n\n<p><a href=\"http://play.golang.org/p/LkJsLsc0aR\" rel=\"nofollow\">Playground link</a>.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n    \"strconv\"\n)\n\nconst data = `{collisions=0, rx_bytes=258, rx_crc_err=0, rx_dropped=0, rx_errors=0, rx_frame_err=0, rx_over_err=0, rx_packets=3, tx_bytes=648, tx_dropped=0, tx_errors=0, tx_packets=8}`\n\nconst regex = `([a-z_]+)=([0-9]+)`\n\nfunc main() {\n    ms := regexp.MustCompile(regex).FindAllStringSubmatch(data, -1)\n\n    vs := make(map[string]int)\n\n    for _, m := range ms {\n        v, _ := strconv.Atoi(m[2])\n        vs[m[1]] = v\n    }\n\n    fmt.Printf(\"%#v\\n\", vs)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 0, "last_activity_date": 1444742230, "last_edit_date": 1592644375, "creation_date": 1444732649, "answer_id": 33100503, "question_id": 33099162, "link": "https://stackoverflow.com/questions/33099162/how-to-parse-result-from-ovs-vsctl-get-interface-interface-statistics/33100503#33100503", "title": "How to parse result from ovs-vsctl get interface &lt;interface&gt; statistics", "body": "<p>Regexp by @thwd is an elegant solution.</p>\n<p>You can get a more efficient solution by using <a href=\"https://golang.org/pkg/strings/#Split\" rel=\"nofollow noreferrer\"><code>strings.Split()</code></a> to split by comma-space (<code>&quot;, &quot;</code>) to get the pairs, and then split again by the equal sign (<code>&quot;=&quot;</code>) to get the key-value pairs. After that you just need to put these into a map:</p>\n<pre><code>func Parse(s string) (m map[string]int, err error) {\n    if len(s) &lt; 2 || s[0] != '{' || s[len(s)-1] != '}' {\n        return nil, fmt.Errorf(&quot;Invalid input, no wrapping brackets!&quot;)\n    }\n\n    m = make(map[string]int)\n    for _, v := range strings.Split(s[1:len(s)-1], &quot;, &quot;) {\n        parts := strings.Split(v, &quot;=&quot;)\n        if len(parts) != 2 {\n            return nil, fmt.Errorf(&quot;Equal sign not found in: %s&quot;, v)\n        }\n        if m[parts[0]], err = strconv.Atoi(parts[1]); err != nil {\n            return nil, err\n        }\n    }\n    return\n}\n</code></pre>\n<p>Using it:</p>\n<pre><code>s := &quot;{collisions=0, rx_bytes=258, ...}&quot;\n\nfmt.Println(Parse(s))\n</code></pre>\n<p>Try it on the <kbd><a href=\"http://play.golang.org/p/5BUmfG5_uY\" rel=\"nofollow noreferrer\">Go Playground</a></kbd>.</p>\n<p><strong>Note:</strong> If performance is important, this can be improved by not using <code>strings.Split()</code> in the outer loop, but instead searching for the comma &quot;manually&quot; and maintaining indices, and only &quot;take out&quot; substrings that represent actual keys and values (but this solution would be more complex).</p>\n<h3>Another solution...</h3>\n<p>...but this option is much slower so it is only viable if performance is not a key requirement: you can turn your input string into a valid JSON format and after that you can use <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\"><code>json.Unmarshal()</code></a>. Error checks omitted:</p>\n<pre><code>s := &quot;{collisions=0, rx_bytes=258, ...}&quot;\n\n// Turn into valid JSON:\ns = strings.Replace(s, `=`, `&quot;:`, -1)\ns = strings.Replace(s, `, `, `, &quot;`, -1)\ns = strings.Replace(s, `{`, `{&quot;`, -1)\n\n// And now simply unmarshal:\nm := make(map[string]int)\njson.Unmarshal([]byte(s), &amp;m)\nfmt.Println(m)\n</code></pre>\n<p>Advantage of this solution is that this also works if the destination value you unmarhsal into is a <code>struct</code>:</p>\n<pre><code>// Unmarshal into a struct (you don't have to care about all fields)\nst := struct {\n    Collisions int `json:&quot;collisions&quot;`\n    Rx_bytes   int `json:&quot;rx_bytes&quot;`\n}{}\njson.Unmarshal([]byte(s), &amp;st)\nfmt.Printf(&quot;%+v\\n&quot;, st)\n</code></pre>\n<p>Try these on the <kbd><a href=\"http://play.golang.org/p/SaGWbKi9hx\" rel=\"nofollow noreferrer\">Go Playground</a></kbd>.</p>\n"}], "owner": {"reputation": 185, "user_id": 288089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5i3wC.jpg?s=128&g=1", "display_name": "Cofyc", "link": "https://stackoverflow.com/users/288089/cofyc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 451, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1444742230, "creation_date": 1444728991, "question_id": 33099162, "link": "https://stackoverflow.com/questions/33099162/how-to-parse-result-from-ovs-vsctl-get-interface-interface-statistics", "title": "How to parse result from ovs-vsctl get interface &lt;interface&gt; statistics", "body": "<p>Result example:</p>\n\n<pre><code>{collisions=0, rx_bytes=258, rx_crc_err=0, rx_dropped=0, rx_errors=0, rx_frame_err=0, rx_over_err=0, rx_packets=3, tx_bytes=648, tx_dropped=0, tx_errors=0, tx_packets=8}\n</code></pre>\n\n<p>This format is like JSON, but not JSON.</p>\n\n<p>Is there an easy way to parse this into <code>map[string]int</code>? Like <code>json.Unmarshal(data, &amp;value)</code>.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1444728182, "post_id": 33098460, "comment_id": 54012896, "body": "I looked at the other post, but I could still not fix my problem."}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1444728322, "post_id": 33098460, "comment_id": 54012996, "body": "By looking at the other post, I tried this: return NullInt64{NullInt64: NullInt64{Int64: int64(i), Valid: err == nil}}. But I get the same error."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1444728378, "post_id": 33098460, "comment_id": 54013030, "body": "The inner <code>NullInt64</code> should be <code>sql.NullInt64</code>."}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1444728546, "post_id": 33098460, "comment_id": 54013152, "body": "Like this you mean? return NullInt64{sql.NullInt64{Int64: int64(i), Valid: err == nil}}"}], "answers": [{"tags": [], "owner": {"reputation": 3818, "user_id": 1247113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRMFj.png?s=128&g=1", "display_name": "rob74", "link": "https://stackoverflow.com/users/1247113/rob74"}, "is_accepted": true, "score": 4, "last_activity_date": 1444729058, "last_edit_date": 1444729058, "creation_date": 1444728554, "answer_id": 33099014, "question_id": 33098460, "link": "https://stackoverflow.com/questions/33098460/getting-error-unknown-field-in-struct-literal/33099014#33099014", "title": "Getting error: unknown field in struct literal", "body": "<p>To initialize the embedded sql.NullInt64, you have to write:</p>\n\n<pre><code>NullInt64{sql.NullInt64{Int64: int64(i), Valid: err == nil}}\n</code></pre>\n\n<p>or, if your NullInt64 struct contains other fields which you don't want to initialize explicitly, you can access the embedded field by using its type:</p>\n\n<pre><code>NullInt64{NullInt64: sql.NullInt64{Int64: int64(i), Valid: err == nil}}\n</code></pre>\n"}], "owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4480, "favorite_count": 0, "closed_date": 1444728808, "accepted_answer_id": 33099014, "answer_count": 1, "score": 0, "last_activity_date": 1444729506, "creation_date": 1444727090, "last_edit_date": 1444729506, "question_id": 33098460, "link": "https://stackoverflow.com/questions/33098460/getting-error-unknown-field-in-struct-literal", "closed_reason": "Duplicate", "title": "Getting error: unknown field in struct literal", "body": "<p>I am trying to run this code:</p>\n\n<pre><code>type NullInt64 struct {\n    sql.NullInt64\n}\n\nfunc ToNullInt64(s string) NullInt64 {\n    i, err := strconv.Atoi(s)\n    return NullInt64{Int64: int64(i), Valid: err == nil}\n}\n</code></pre>\n\n<p>but I get this error:</p>\n\n<pre><code>..\\sql\\sql.go:27: unknown NullInt64 field 'Int64' in struct literal\n..\\sql\\sql.go:27: unknown NullInt64 field 'Valid' in struct literal\n</code></pre>\n"}, {"tags": ["c", "go", "ldap", "openldap"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 2, "creation_date": 1444727886, "post_id": 33098380, "comment_id": 54012708, "body": "You should probably be passing the plaintext password, and if you&#39;re using OpenLDAP with the password policy extension you should be using the modify-password extended operation, not just an attribute change."}, {"owner": {"reputation": 109, "user_id": 4366370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ddc65670ad15ee10d61b114b715ecc?s=128&d=identicon&r=PG&f=1", "display_name": "madraven", "link": "https://stackoverflow.com/users/4366370/madraven"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1444728686, "post_id": 33098380, "comment_id": 54013250, "body": "Using a non-encoded password in my code doesn&#39;t work either. As for your other suggestion, do you mean using ldappasswd in a shell command ?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1444733638, "post_id": 33098380, "comment_id": 54016393, "body": "@madraven, no, that&#39;s a special kind of operation (examples of operations are &quot;search&quot; and &quot;update&quot;) supported by some LDAP servers -- see <a href=\"https://www.ietf.org/rfc/rfc3062.txt\" rel=\"nofollow noreferrer\">RFC 3062</a>."}, {"owner": {"reputation": 109, "user_id": 4366370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ddc65670ad15ee10d61b114b715ecc?s=128&d=identicon&r=PG&f=1", "display_name": "madraven", "link": "https://stackoverflow.com/users/4366370/madraven"}, "edited": false, "score": 0, "creation_date": 1444737041, "post_id": 33098380, "comment_id": 54018562, "body": "Ok I think I get it now, so i must use something like ldap_extended_operation_s ? I&#39;m gonna try that and let you guys know if it works ! Thanks !"}, {"owner": {"reputation": 109, "user_id": 4366370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ddc65670ad15ee10d61b114b715ecc?s=128&d=identicon&r=PG&f=1", "display_name": "madraven", "link": "https://stackoverflow.com/users/4366370/madraven"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1444811324, "post_id": 33098380, "comment_id": 54053663, "body": "Hi again @kostix ! Ok so i tried using ldap_passwd_s, which apparently calls ldap_extended_operations, but i keep getting a Protocol Error... any idea what could cause that ?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1444821939, "post_id": 33098380, "comment_id": 54060567, "body": "@madraven, a bit of further googling tells me that my suggestion might have completely missed the point: the AD sems to not support the password modify operation. <a href=\"http://www.dirmgr.com/blog/2010/8/26/ldap-password-changes-in-active-directory.html\" rel=\"nofollow noreferrer\">This post</a> deals with AD-specific warts with regard to plain modify operation on that special attribute."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1444822279, "post_id": 33098380, "comment_id": 54060780, "body": "@madraven, you might as well try another route and rather than trying to talk to AD using LDAP -- a technique never officially endorsed by MS itself -- you could try using WinAPI to make MS own stuff talk to AD in a way it prefers. Say, <a href=\"https://msdn.microsoft.com/en-us/library/aa370650\" rel=\"nofollow noreferrer\"><code>NetUserChangePassword</code></a> from <code>netapi32.dll</code> seems like a good fit. Of course, this would only work if your code runs on Windows. In return, to call a WInAPI functon you don&#39;t need to use <code>cgo</code> which is IMO a win."}, {"owner": {"reputation": 109, "user_id": 4366370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ddc65670ad15ee10d61b114b715ecc?s=128&d=identicon&r=PG&f=1", "display_name": "madraven", "link": "https://stackoverflow.com/users/4366370/madraven"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1444826168, "post_id": 33098380, "comment_id": 54063309, "body": "Thanks so much for your help @kostix ! So unfortunately i can&#39;t run my code on windows... Would you happen to know another way ? But there is something i don&#39;t understand: my company has some php code, that uses ldap to change passwords without any problems. They want to get rid of the php and i have have to code it in C / Go. Why would these almost same functions work with php and not in C ?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1444830656, "post_id": 33098380, "comment_id": 54066561, "body": "Well, OK, at this point I&#39;d turn to debugging. I&#39;d take the working PHP code, modify it a bit to use LDAP (not LDAPS), and run the user addition operation while having <code>tcpdump</code> capturing the relevant traffic. The operation will supposedly fail (because of SSL/TLS turned off) but you could grab the dump file and inspect it using Wireshark which has excellent dissectors for LDAP. The next step would be to run your Go/C code using the same approach (turn off SSL/TLS and dump the traffic) and then compare the on-the-wire LDAP commands sent in both cases."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1444830752, "post_id": 33098380, "comment_id": 54066641, "body": "And while we&#39;re on it, you could consider using <a href=\"https://godoc.org/github.com/go-ldap/ldap\" rel=\"nofollow noreferrer\">a native Go library for LDAPv3</a> instead of interfacing <code>libldap</code> via <code>cgo</code>."}, {"owner": {"reputation": 109, "user_id": 4366370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ddc65670ad15ee10d61b114b715ecc?s=128&d=identicon&r=PG&f=1", "display_name": "madraven", "link": "https://stackoverflow.com/users/4366370/madraven"}, "edited": false, "score": 0, "creation_date": 1444833481, "post_id": 33098380, "comment_id": 54068678, "body": "Again, thank you man. So first i tried using the native Go library for LDAP, but of course still the protocol error (even though you were right: so much easier to code !!). I&#39;m now gonna try what you suggested about capturing the tcp traffic, but I dont really understand everything xD"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 109, "user_id": 4366370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ddc65670ad15ee10d61b114b715ecc?s=128&d=identicon&r=PG&f=1", "display_name": "madraven", "link": "https://stackoverflow.com/users/4366370/madraven"}, "edited": false, "score": 0, "creation_date": 1444833674, "post_id": 33098380, "comment_id": 54068838, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/92278/discussion-between-kostix-and-madraven\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 109, "user_id": 4366370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ddc65670ad15ee10d61b114b715ecc?s=128&d=identicon&r=PG&f=1", "display_name": "madraven", "link": "https://stackoverflow.com/users/4366370/madraven"}, "is_accepted": true, "score": 1, "last_activity_date": 1445435629, "creation_date": 1445435629, "answer_id": 33261234, "question_id": 33098380, "link": "https://stackoverflow.com/questions/33098380/ldap-in-c-go-error-code-53-server-is-unwilling-to-perfom-when-trying-to-set/33261234#33261234", "title": "LDAP in C/Go : Error code 53 &quot;Server is unwilling to perfom&quot; when trying to set unicodePwd", "body": "<p>I don't know if anybody would be interested but i found a solution with the help of @kostix and i thought i'd share: the extended modify operations in C (using CGO) didn't work, but a simple modify operation using go-ldap with the correct encoding allowed me to change a user password on windows AD.</p>\n"}], "owner": {"reputation": 109, "user_id": 4366370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ddc65670ad15ee10d61b114b715ecc?s=128&d=identicon&r=PG&f=1", "display_name": "madraven", "link": "https://stackoverflow.com/users/4366370/madraven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1406, "favorite_count": 0, "accepted_answer_id": 33261234, "answer_count": 1, "score": 0, "last_activity_date": 1537534674, "creation_date": 1444726886, "question_id": 33098380, "link": "https://stackoverflow.com/questions/33098380/ldap-in-c-go-error-code-53-server-is-unwilling-to-perfom-when-trying-to-set", "title": "LDAP in C/Go : Error code 53 &quot;Server is unwilling to perfom&quot; when trying to set unicodePwd", "body": "<p>So i'm coding a program in Go, with C bindings thanks to CGo, and i'm using ldap to perform search, add and modify operations. I could manage to do all that, but now im trying to set a password in the unicodePwd mod_type and i can't seem to get around the Error 53: Server is unwilling to perfom.</p>\n\n<p>I know a lot of stuff can cause this error so:\nI'm connected with ldaps.\nI hard-coded for testing purpose a password made of 10 characters, with double quotes at the beginning and the end, and got that in UTF-16LE, Base64.\nThe password hase lowercase letters, uppercase letters and punctuations symbols.</p>\n\n<p>Here are some samples of my code, im just testing stuff right now so the coding is really bad:</p>\n\n<p>Setting options :<code>C.ldap_set_option(l, LDAP_OPT_PROTOCOL_VERSION, unsafe.Pointer(&amp;version))\nC.ldap_set_option(l, LDAP_OPT_REFERRALS, unsafe.Pointer(&amp;v))</code></p>\n\n<p>Initialization:<code>C.ldap_initialize(&amp;l, C.CString(\"ldaps://**.**.**.**:636\"))</code></p>\n\n<p>Binding:<code>rc := C.ldap_simple_bind_s(l, C.CString(\"CN=Administrator,CN=Users,DC=intra,DC=localdomain,DC=com\"), C.CString(\"**********\"))</code></p>\n\n<p>And now the important part, adding a user with a password :</p>\n\n<pre><code>add_user(l, \"ldaps://**.**.**.**\", \"636\", \"CN=Administrator,CN=Users,DC=intra,DC=localdomain,DC=com\", \"OU=*******,DC=intra,DC=localdomain,DC=com\")\n\nfunc add_user(l *C.LDAP, host string, port string, login string, container string) {\n\nvar mods [5]*C.LDAPModStr\nvar modClass, modCN, modSN, modPass C.LDAPModStr\nvar vclass [5]*C.char\nvar vcn [4]*C.char\nvar vsn [2]*C.char\nvar vpass [2]*C.char\nmodClass.mod_op = 0\nmodClass.mod_type = C.CString(\"objectclass\")\nvclass[0] = C.CString(\"top\")\nvclass[1] = C.CString(\"person\")\nvclass[2] = C.CString(\"organizationalPerson\")\nvclass[3] = C.CString(\"User\")\nvclass[4] = nil\nmodClass.mod_vals = &amp;vclass[0]\n\nmodCN.mod_op = 0\nmodCN.mod_type = C.CString(\"cn\")\nvcn[0] = C.CString(\"john\")\nvcn[1] = nil\nmodCN.mod_vals = &amp;vcn[0]\n\nmodSN.mod_op = 0\nmodSN.mod_type = C.CString(\"sn\")\nvsn[0] = C.CString(\"mclane\")\nvsn[1] = nil\nmodSN.mod_vals = &amp;vsn[0]\n\nmodPass.mod_op = 0\nmodPass.mod_type = C.CString(\"unicodePwd\")\nvpass[0] = C.CString(\"IgBTAHcAZQBlAHQATgBlAHcAUAB3AGQAMQAyADMAIQAiAA==\")\nvpass[1] = nil\nmodPass.mod_vals = &amp;vpass[0]\n\nmods[0] = &amp;modClass\nmods[1] = &amp;modCN\nmods[2] = &amp;modSN\nmods[3] = &amp;modPass\nmods[4] = nil\n\ndn := \"cn=john,OU=*********,DC=intra,DC=localdomain,DC=com\"\n\nrc := C._ldap_add(l, C.CString(dn), &amp;mods[0])\n\nif rc != LDAP_SUCCESS {\n    er := C.ldap_err2string(rc)\n    fmt.Println(\"ADD ERROR\")\n    fmt.Println(rc)\n    fmt.Println(C.GoString(er))\n}\n</code></pre>\n\n<p>Oh, and heres the definition of the type LDAPModStr:</p>\n\n<pre><code>typedef struct ldapmod_str {\n    int  mod_op;\n    char      *mod_type;\n    char    **mod_vals;} LDAPModStr;\n</code></pre>\n\n<p>And _ldap_add :</p>\n\n<pre><code>int _ldap_add(LDAP *ld, char* dn, LDAPModStr **attrs){\n\n            return ldap_add_ext_s(ld, dn, (LDAPMod **)attrs, NULL, NULL);\n        }\n</code></pre>\n\n<p>I'm probably missing something obvious here, since i'm kinda new to GO and LDAP, but if you could help me solve this i would really be grateful. I dont know if this is relevant but the programs connects to the Active Directory of Windows Server 2012 R2, which is running on the same computer in a virtual machine. Also i'm kinda new here, i can post all of my code here if its easier for you, but i thought posting just important steps was maybe better.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1444724437, "post_id": 33096365, "comment_id": 54010581, "body": "I have to admit I do not understand what&#39;s your question here? Package net/http <i>does</i> process request asynchronously already. And of course: If a handler completes the request is done. If you don&#39;t want this your handler should not terminate but do your other work you intend to do asynchronously."}, {"owner": {"reputation": 159, "user_id": 2217612, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9ed9bb09b74d85e8a2a1fb5c74d64db9?s=128&d=identicon&r=PG", "display_name": "Shri Javadekar", "link": "https://stackoverflow.com/users/2217612/shri-javadekar"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1444798419, "post_id": 33096365, "comment_id": 54047569, "body": "Good to know that the net/http package handles http requests asynchronously. But I want to push all http requests into a queue from the handler (producer) and have another thread (consumer) read these requests and its data and return them (I&#39;ll update the main question with some of this for better visibility)."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1444804753, "post_id": 33096365, "comment_id": 54049944, "body": "Okay, I think this is nonsensical as this make request processing a <b>synchronous</b> process, but it can be done: The request handler pushes the request into channel 1 and <i>waits</i> (!!) until the consumer has processed the request by waiting on the result on channel 2. The consumer listens on channel 1, grabs request, processes them and returns to producer via channel 2. Complete serial processing. Don&#39;t do that, it is nonsense. The Go http server <i>is</i> already a producer and your handlers <i>are</i> consumers, there is no need to redo this work."}, {"owner": {"reputation": 159, "user_id": 2217612, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9ed9bb09b74d85e8a2a1fb5c74d64db9?s=128&d=identicon&r=PG", "display_name": "Shri Javadekar", "link": "https://stackoverflow.com/users/2217612/shri-javadekar"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1444846491, "post_id": 33096365, "comment_id": 54076875, "body": "The data sent via the http requests needs to be written to disk. I&#39;ll obviously benchmark this, but generally having multiple threads writing to a single rotational disks isn&#39;t a good idea as it can increase the # of seeks."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1444866641, "post_id": 33096365, "comment_id": 54086497, "body": "It sounds there&#39;s some confusion here: do you mean <code>http.Request</code> (as in a server) or <code>http.Response</code> (i.e. your application is a HTTP <b>client</b>). If you want to write a client that can issue (e.g.) 50+ requests concurrently and then push the <code>http.Response</code> into a channel so you can digest the <code>http.Response.Body</code>s one-by-one (i.e. write to disk) then that&#39;s a different thing."}, {"owner": {"reputation": 159, "user_id": 2217612, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9ed9bb09b74d85e8a2a1fb5c74d64db9?s=128&d=identicon&r=PG", "display_name": "Shri Javadekar", "link": "https://stackoverflow.com/users/2217612/shri-javadekar"}, "edited": false, "score": 0, "creation_date": 1444948781, "post_id": 33096365, "comment_id": 54128328, "body": "I want to write a server. This server receives multiple <code>http.Request</code>&#39;s (PUT requests) and writes the body of each of those requests into file/s."}], "answers": [{"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 1, "last_activity_date": 1444750766, "creation_date": 1444750766, "answer_id": 33106925, "question_id": 33096365, "link": "https://stackoverflow.com/questions/33096365/complete-http-request-asynchronously-in-golang/33106925#33106925", "title": "Complete http.Request asynchronously in Golang", "body": "<p>http handlers are executed in a different goroutine per request, so if you are simply trying to free up the main serve loop, it's not neccesary.</p>\n\n<p>If you are looking to serialize processing of requests, you could use a <code>sync.Mutex</code> and have your handler's lock on that. This would have a similar effect in that the requests would be handled one at a time.</p>\n\n<p>I don't think <code>sync.Mutex</code> is fair, so it may not meet your needs.</p>\n\n<p>also, if you wanted to be stateful between requests, then this is probably not the right solution.</p>\n\n<p>As Jorge Marey mentioned, channels would work as well.  </p>\n\n<p>Though, i'd suggest you look at <a href=\"https://godoc.org/golang.org/x/net/context\" rel=\"nofollow\">golang.org/x/net/context</a> as it is a package specifically designed for multi-stage processing with timeouts and whatnot.</p>\n\n<p>my guess is you will end up with a channel that passes structs that look like:</p>\n\n<pre><code>type Req struct{\n   ctx context.Context\n   w http.ResponseWriter\n   r *http.Request\n}\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 2217612, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9ed9bb09b74d85e8a2a1fb5c74d64db9?s=128&d=identicon&r=PG", "display_name": "Shri Javadekar", "link": "https://stackoverflow.com/users/2217612/shri-javadekar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5001, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1444798536, "creation_date": 1444720483, "last_edit_date": 1444798536, "question_id": 33096365, "link": "https://stackoverflow.com/questions/33096365/complete-http-request-asynchronously-in-golang", "title": "Complete http.Request asynchronously in Golang", "body": "<p>I want to put all arriving <code>http.Request</code>s into a queue and have a separate thread (<code>goroutine</code>?) process these requests and return the appropriate status.</p>\n\n<p>However, the main <code>http request</code> handler directly completes the request even when the <code>http.Request</code> object is sent asynchronously to a <code>goroutine</code>.</p>\n\n<p>Is there a way to control when the <code>http.Request</code> is completed and thereby asynchronously process it?</p>\n\n<p>[Update]</p>\n\n<p>I want to implement a producer-consumer model. The main request handler produces the requests and put them into a queue. A consumer thread (or threads) will read these requests, consume the body of the requests and return them.</p>\n"}, {"tags": ["linux", "caching", "go", "system-calls"], "comments": [{"owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "edited": false, "score": 1, "creation_date": 1444723642, "post_id": 33095053, "comment_id": 54010135, "body": "Have you tried to do the open-read-close with those exact arguments in something else than go (C maybe)? From what I can see on the man page, O_SYNC only affects write operations and O_DIRECT needs some kind of accurately sized (?) buffer in userspace, this might be a go-specific problem, but I&#39;d first try to get that working in C..."}, {"owner": {"reputation": 62800, "user_id": 391161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb76d8bcc69144a3ee4c893ece7fc588?s=128&d=identicon&r=PG&f=1", "display_name": "merlin2011", "link": "https://stackoverflow.com/users/391161/merlin2011"}, "reply_to_user": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "edited": false, "score": 0, "creation_date": 1444724608, "post_id": 33095053, "comment_id": 54010677, "body": "@mrd0ll4r, Actually I ran <a href=\"http://man7.org/tlpi/code/online/book/filebuff/direct_read.c.html\" rel=\"nofollow noreferrer\">this program</a> and got the same error <code>EINVAL</code> on the C side. So no, it is not go-specific."}], "answers": [{"comments": [{"owner": {"reputation": 1447, "user_id": 3570747, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/RKIuH.png?s=128&g=1", "display_name": "vastlysuperiorman", "link": "https://stackoverflow.com/users/3570747/vastlysuperiorman"}, "edited": false, "score": 0, "creation_date": 1444747580, "post_id": 33101119, "comment_id": 54026316, "body": "Very interesting insight on the complications of using O_DIRECT. Are you aware of any solution to the question of skipping filesystem cache in Go (even if it involves a completely different route)? I&#39;m also in need of a solution."}], "tags": [], "owner": {"reputation": 30089, "user_id": 22147, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/x74x2.png?s=128&g=1", "display_name": "Rhythmic Fistman", "link": "https://stackoverflow.com/users/22147/rhythmic-fistman"}, "is_accepted": false, "score": 1, "last_activity_date": 1444734581, "creation_date": 1444734581, "answer_id": 33101119, "question_id": 33095053, "link": "https://stackoverflow.com/questions/33095053/how-do-i-skip-the-filesystem-cache-when-reading-a-file-in-golang/33101119#33101119", "title": "How do I skip the filesystem cache when reading a file in Golang?", "body": "<p>From the <code>open</code> man page, under NOTES:</p>\n\n<blockquote>\n  <p>The O_DIRECT flag may impose alignment restrictions on the length and address of user-space buffers and the file offset of I/Os.  In Linux alignment restrictions vary by file system and kernel version and might be absent entirely. </p>\n</blockquote>\n\n<p>So you could have alignment issues, of either the memory or the file offset, or your buffer size could be \"wrong\". What the alignments and sizes <em>should</em> be is not obvious. The man page continues:</p>\n\n<blockquote>\n  <p>However there is currently no file system-independent interface for an application to discover these restrictions for a given file or file  system.</p>\n</blockquote>\n\n<p>And even Linus weighs in, in his usual understated manner:</p>\n\n<blockquote>\n  <p>\"The thing that has always disturbed me about O_DIRECT is that the whole interface is just stupid, and was probably designed by a deranged monkey on some serious mind-controlling substances.\" \u2014Linus </p>\n</blockquote>\n\n<p>Good luck!</p>\n\n<p>p.s. Stab in the dark: why not read 512 bytes?</p>\n"}, {"comments": [{"owner": {"reputation": 62800, "user_id": 391161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb76d8bcc69144a3ee4c893ece7fc588?s=128&d=identicon&r=PG&f=1", "display_name": "merlin2011", "link": "https://stackoverflow.com/users/391161/merlin2011"}, "edited": false, "score": 0, "creation_date": 1444762983, "post_id": 33106182, "comment_id": 54035449, "body": "I tried to use your package but I get <code>unexpected EOF</code> when I try to read."}, {"owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "reply_to_user": {"reputation": 62800, "user_id": 391161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb76d8bcc69144a3ee4c893ece7fc588?s=128&d=identicon&r=PG&f=1", "display_name": "merlin2011", "link": "https://stackoverflow.com/users/391161/merlin2011"}, "edited": false, "score": 0, "creation_date": 1444825740, "post_id": 33106182, "comment_id": 54062989, "body": "@merlin2011 in your example is <code>&quot;Foo.txt&quot;</code> bigger than <code>directio.BlockSize</code>?"}, {"owner": {"reputation": 62800, "user_id": 391161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb76d8bcc69144a3ee4c893ece7fc588?s=128&d=identicon&r=PG&f=1", "display_name": "merlin2011", "link": "https://stackoverflow.com/users/391161/merlin2011"}, "edited": false, "score": 0, "creation_date": 1445491910, "post_id": 33106182, "comment_id": 54348605, "body": "It is smaller than <code>directio.BlockSize</code>."}, {"owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "reply_to_user": {"reputation": 62800, "user_id": 391161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb76d8bcc69144a3ee4c893ece7fc588?s=128&d=identicon&r=PG&f=1", "display_name": "merlin2011", "link": "https://stackoverflow.com/users/391161/merlin2011"}, "edited": false, "score": 0, "creation_date": 1445507613, "post_id": 33106182, "comment_id": 54356831, "body": "@merlin2011 it needs to be bigger than <code>directio.BlockSize</code> otherwise you&#39;ll get that error."}], "tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": false, "score": 5, "last_activity_date": 1444748746, "creation_date": 1444748746, "answer_id": 33106182, "question_id": 33095053, "link": "https://stackoverflow.com/questions/33095053/how-do-i-skip-the-filesystem-cache-when-reading-a-file-in-golang/33106182#33106182", "title": "How do I skip the filesystem cache when reading a file in Golang?", "body": "<p>You may enjoy my <a href=\"https://github.com/ncw/directio\" rel=\"noreferrer\">directio package</a> which I made for exactly this purpose.</p>\n\n<p>From the site</p>\n\n<p>This is library for the Go language to enable use of Direct IO under all supported OSes of Go (except openbsd and plan9).</p>\n\n<p>Direct IO does IO to and from disk without buffering data in the OS. It is useful when you are reading or writing lots of data you don't want to fill the OS cache up with.</p>\n\n<p>See here for package docs</p>\n\n<p><a href=\"http://go.pkgdoc.org/github.com/ncw/directio\" rel=\"noreferrer\">http://go.pkgdoc.org/github.com/ncw/directio</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6699804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed7c6404133a4fc9a3b1dafae324eb63?s=128&d=identicon&r=PG&f=1", "display_name": "ProhtMeyhet", "link": "https://stackoverflow.com/users/6699804/prohtmeyhet"}, "is_accepted": false, "score": 0, "last_activity_date": 1471073030, "creation_date": 1471073030, "answer_id": 38930309, "question_id": 33095053, "link": "https://stackoverflow.com/questions/33095053/how-do-i-skip-the-filesystem-cache-when-reading-a-file-in-golang/38930309#38930309", "title": "How do I skip the filesystem cache when reading a file in Golang?", "body": "<p>you can try to use fadvice and madvice, but there is no guarantee. both will work more probably with larger files/data, because:</p>\n\n<blockquote>\n  <p>Partial pages are deliberately preserved on the expectation that it is better to preserve needed memory than to discard unneeded memory.</p>\n</blockquote>\n\n<p>see the linux source code, what will do something and what not. POSIX_FADV_NOREUSE for example doesn't do anything.</p>\n\n<p><a href=\"http://lxr.free-electrons.com/source/mm/fadvise.c#L62\" rel=\"nofollow\">http://lxr.free-electrons.com/source/mm/fadvise.c#L62</a></p>\n\n<p><a href=\"http://lxr.free-electrons.com/source/mm/madvise.c\" rel=\"nofollow\">http://lxr.free-electrons.com/source/mm/madvise.c</a></p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"os\"\nimport \"syscall\"\n\nimport \"golang.org/x/sys/unix\"\n\nfunc main() {\n    advise := false\n    if len(os.Args) &gt; 1 &amp;&amp; os.Args[1] == \"-x\" {\n        fmt.Println(\"setting file advise\")\n        advise =true\n    }\n\n    data := make([]byte, 100)\n    handler, err := os.Open(\"Foo.txt\")\n    if err != nil {\n        fmt.Println(\"Failed on open: \", err)\n    }; defer handler.Close()\n\n    if advise {\n        unix.Fadvise(int(handler.Fd()), 0, 0, 4) // 4 == POSIX_FADV_DONTNEED\n    }\n\n    read, err := handler.Read(data)\n    if err != nil {\n        fmt.Println(\"Failed on read: \", err)\n        os.Exit(1)\n    }\n\n    if advise {\n        syscall.Madvise(data, 4) // 4 == MADV_DONTNEED\n    }\n\n    fmt.Printf(\"read %v bytes\\n\", read)\n}\n</code></pre>\n\n<p>/usr/bin/time -v ./direct -x</p>\n\n<pre><code>Command being timed: \"./direct -x\"\nUser time (seconds): 0.00\nSystem time (seconds): 0.00\nPercent of CPU this job got: 0%\nElapsed (wall clock) time (h:mm:ss or m:ss): 0:00.03\nAverage shared text size (kbytes): 0\nAverage unshared data size (kbytes): 0\nAverage stack size (kbytes): 0\nAverage total size (kbytes): 0\nMaximum resident set size (kbytes): 1832\nAverage resident set size (kbytes): 0\nMajor (requiring I/O) page faults: 2\nMinor (reclaiming a frame) page faults: 149\nVoluntary context switches: 2\nInvoluntary context switches: 2\nSwaps: 0\nFile system inputs: 200\nFile system outputs: 0\nSocket messages sent: 0\nSocket messages received: 0\nSignals delivered: 0\nPage size (bytes): 4096\nExit status: 0\n</code></pre>\n"}], "owner": {"reputation": 62800, "user_id": 391161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb76d8bcc69144a3ee4c893ece7fc588?s=128&d=identicon&r=PG&f=1", "display_name": "merlin2011", "link": "https://stackoverflow.com/users/391161/merlin2011"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3059, "favorite_count": 3, "answer_count": 3, "score": 8, "last_activity_date": 1471073030, "creation_date": 1444715405, "last_edit_date": 1444763081, "question_id": 33095053, "link": "https://stackoverflow.com/questions/33095053/how-do-i-skip-the-filesystem-cache-when-reading-a-file-in-golang", "title": "How do I skip the filesystem cache when reading a file in Golang?", "body": "<p>Assume that the contents of the file <code>Foo.txt</code> are as follows.</p>\n\n<pre><code>Foo Bar Bar Foo\n</code></pre>\n\n<p>Consider the following short program.</p>\n\n<pre><code>package main\n\nimport \"syscall\"\nimport \"fmt\"\n\n\nfunc main() {\n    fd, err := syscall.Open(\"Foo.txt\", syscall.O_RDONLY, 0)\n    if err != nil {\n        fmt.Println(\"Failed on open: \", err)\n    }\n    data := make([]byte, 100)\n    _, err = syscall.Read(fd, data)\n    if err != nil {\n        fmt.Println(\"Failed on read: \", err)\n    }\n    syscall.Close(fd)\n}\n</code></pre>\n\n<p>When we run the program above, we get no errors, which is correct behavior.</p>\n\n<p>Now, I modify the <code>syscall.Open</code> line to be the following.</p>\n\n<pre><code>fd, err := syscall.Open(\"Foo.txt\", syscall.O_RDONLY | syscall.O_SYNC | syscall.O_DIRECT, 0)\n</code></pre>\n\n<p>When I run the program again, I get the following (undesirable) output.</p>\n\n<pre><code>Failed on read:  invalid argument\n</code></pre>\n\n<p><strong>How can I correctly pass the flags <code>syscall.O_SYNC</code> and <code>syscall.O_DIRECT</code> as specified by the the <a href=\"http://man7.org/linux/man-pages/man2/open.2.html\" rel=\"nofollow\"><code>open</code> man page</a> for skipping the filesystem cache?</strong></p>\n\n<p>Note that I am using the <code>syscall</code> file interface directly instead of the <code>os</code> file interface because I could not find a way to pass those flags into the functions provided by <code>os</code>, but I am open to solutions that use <code>os</code> provided that they work correctly to disable the filesystem cache on reads.</p>\n\n<p>Note also that I am running on <code>Ubuntu 14.04</code> with <code>ext4</code> as my filesystem.</p>\n\n<hr>\n\n<p><strong>Update</strong>: I tried to use @Nick Craig-Wood's package in the code below.</p>\n\n<pre><code>package main\n\nimport \"io\"\nimport \"github.com/ncw/directio\" \nimport \"os\"\nimport \"fmt\"\n\n\nfunc main() {\n    in, err := directio.OpenFile(\"Foo.txt\", os.O_RDONLY, 0666)\n    if err != nil {\n        fmt.Println(\"Error on open: \", err)\n    }\n\n    block := directio.AlignedBlock(directio.BlockSize)\n    _, err = io.ReadFull(in, block)\n    if err != nil {\n        fmt.Println(\"Error on read: \", err)\n    }\n}\n</code></pre>\n\n<p>The output is the following</p>\n\n<pre><code>Error on read:  unexpected EOF\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 1, "creation_date": 1444706579, "post_id": 33093450, "comment_id": 54002966, "body": "To write null to a pointer you need to pass pointer to pointer to a function. I am not sure if it will work with Scan though."}], "answers": [{"tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": true, "score": 1, "last_activity_date": 1444713426, "creation_date": 1444713426, "answer_id": 33094651, "question_id": 33093450, "link": "https://stackoverflow.com/questions/33093450/getting-error-when-trying-to-scan-into-an-int64-pointer-in-go/33094651#33094651", "title": "Getting error when trying to scan into an int64 pointer in Go", "body": "<p><code>Scan</code> needs a pointer to your pointer for this to work  :</p>\n\n<pre><code>var id int64\nvar replyTo *int64\nreplyTo = new(int64)\n\nquery := `\n    SELECT id, reply_to\n    FROM message\n    WHERE id = 211\n    LIMIT 1;\n`\n// The change is here : &amp;replyTo instead of just replyTo\nif err := sql.DB.QueryRow(query).Scan(&amp;id, &amp;replyTo); err != nil {\n    log.Println(err)\n}\n\nspew.Dump(id, replyTo)\n</code></pre>\n\n<p>Then don't forget to test for <code>replyTo == nil</code> before using the value <code>*replyTo</code></p>\n\n<p>Alternative solution : use a <code>sql.NullInt64</code> : <a href=\"https://golang.org/pkg/database/sql/#NullInt64\" rel=\"nofollow\">https://golang.org/pkg/database/sql/#NullInt64</a></p>\n"}], "owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 719, "favorite_count": 0, "accepted_answer_id": 33094651, "answer_count": 1, "score": 0, "last_activity_date": 1444713426, "creation_date": 1444705660, "last_edit_date": 1444706069, "question_id": 33093450, "link": "https://stackoverflow.com/questions/33093450/getting-error-when-trying-to-scan-into-an-int64-pointer-in-go", "title": "Getting error when trying to scan into an int64 pointer in Go", "body": "<p>I'm getting this error</p>\n\n<pre><code> Scan error on column index 1: converting string \"&lt;nil&gt;\" to a int64:\n strconv.ParseInt: parsing \"&lt;nil&gt;\": invalid syntax\n</code></pre>\n\n<p>when trying to run this simple code:</p>\n\n<pre><code>var id int64\nvar replyTo *int64\nreplyTo = new(int64)\n\nquery := `\n    SELECT id, reply_to\n    FROM message\n    WHERE id = 211\n    LIMIT 1;\n`\nif err := sql.DB.QueryRow(query).Scan(&amp;id, replyTo); err != nil {\n    log.Println(err)\n}\n\nspew.Dump(id, replyTo)\n</code></pre>\n\n<p>The table I am selecting from looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/PWfRT.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PWfRT.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>If I change the select query to: <code>WHERE id = 210</code>, instead of 211 then it works.</p>\n\n<p>The sql.DB is just an instance of the sqlx library.</p>\n\n<pre><code>var DB *sqlx.DB\n</code></pre>\n\n<p>I am using a pointer to be able to catch NULL columns from the database. I am using a pointer because I am not sure if sql.NullInt64 works well with the sqlx library.</p>\n\n<p>Why do I get this error? What can I do about it?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 4139166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/079a22c9c08d2b54e915c602db8f69d5?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Swaminathan", "link": "https://stackoverflow.com/users/4139166/joseph-swaminathan"}, "edited": false, "score": 0, "creation_date": 1444706985, "post_id": 33093095, "comment_id": 54003074, "body": "Thanks. So it seems a slice of n elements expanded is not same as passing n arguments. What is the definition of expansion. Is there any reason why the compiler has to treat an argument followed by an expansion not same as one single expanded list"}, {"owner": {"reputation": 1665, "user_id": 4638952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03791badf72f6918a8910148dfc4401e?s=128&d=identicon&r=PG&f=1", "display_name": "SnoProblem", "link": "https://stackoverflow.com/users/4638952/snoproblem"}, "reply_to_user": {"reputation": 95, "user_id": 4139166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/079a22c9c08d2b54e915c602db8f69d5?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Swaminathan", "link": "https://stackoverflow.com/users/4139166/joseph-swaminathan"}, "edited": false, "score": 0, "creation_date": 1444710460, "post_id": 33093095, "comment_id": 54004038, "body": "No, because the list must be collapsed into a slice by the underlying system, which will either 1) collect a set of single arguments or 2) pass a slice.  The easiest way to think about it is to match the ellipses if you&#39;re expanding a slice."}, {"owner": {"reputation": 95, "user_id": 4139166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/079a22c9c08d2b54e915c602db8f69d5?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Swaminathan", "link": "https://stackoverflow.com/users/4139166/joseph-swaminathan"}, "edited": false, "score": 0, "creation_date": 1444712217, "post_id": 33093095, "comment_id": 54004604, "body": "according to go specs, &quot;We write ... after v in the nested call to Sprintln to tell the compiler to treat v as a list of arguments; otherwise it would just pass v as a single slice argument. &quot;     Based on the above statement the correct behavior should be treating it as a list of argument instead of a single slice argument.  I even tried the following and it doesn&#39;t work     ` func myPrint(v ...interface{}) {         fmt.Println(interface{}(&quot;Hello&quot;), v...)     }`"}, {"owner": {"reputation": 1665, "user_id": 4638952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03791badf72f6918a8910148dfc4401e?s=128&d=identicon&r=PG&f=1", "display_name": "SnoProblem", "link": "https://stackoverflow.com/users/4638952/snoproblem"}, "reply_to_user": {"reputation": 95, "user_id": 4139166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/079a22c9c08d2b54e915c602db8f69d5?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Swaminathan", "link": "https://stackoverflow.com/users/4139166/joseph-swaminathan"}, "edited": false, "score": 0, "creation_date": 1444716214, "post_id": 33093095, "comment_id": 54006185, "body": "The issue isn&#39;t the compiler, but the parser.  The function call <code>fmt.Println(&quot;Hello&quot;, v...)</code> is parsed (using the comma) into two arguments, then sent to the compiler.  Without this, there would need to be a complicated set of type-checking and validation to decide if the preceding argument belongs in the list or not.  How would the compiler be able to match that call to the function if there was one function <code>fmt.Println(s string, v...interface{})</code> and another <code>fmt.Println(v...interface{})</code>?"}, {"owner": {"reputation": 1665, "user_id": 4638952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03791badf72f6918a8910148dfc4401e?s=128&d=identicon&r=PG&f=1", "display_name": "SnoProblem", "link": "https://stackoverflow.com/users/4638952/snoproblem"}, "reply_to_user": {"reputation": 95, "user_id": 4139166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/079a22c9c08d2b54e915c602db8f69d5?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Swaminathan", "link": "https://stackoverflow.com/users/4139166/joseph-swaminathan"}, "edited": false, "score": 0, "creation_date": 1444717258, "post_id": 33093095, "comment_id": 54006637, "body": "This is the same reason two expanded slices can&#39;t be used for the same variadic list, such as <code>fmt.Println(v..., v...)</code>."}, {"owner": {"reputation": 95, "user_id": 4139166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/079a22c9c08d2b54e915c602db8f69d5?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Swaminathan", "link": "https://stackoverflow.com/users/4139166/joseph-swaminathan"}, "edited": false, "score": 0, "creation_date": 1444752089, "post_id": 33093095, "comment_id": 54029337, "body": "Thanks very much for explaining this. So its the Golang&#39;s polymorphism coming in the way. I understand it now."}, {"owner": {"reputation": 1876, "user_id": 1930339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1463fb8321cdc4f08f63c97a070079b7?s=128&d=identicon&r=PG&f=1", "display_name": "Salim", "link": "https://stackoverflow.com/users/1930339/salim"}, "edited": false, "score": 0, "creation_date": 1585666023, "post_id": 33093095, "comment_id": 107838222, "body": "With parallel writes to std-out this could lead to another process/thread writing/printing something inbetween those print-commands. Please use the different answer provided by Rhythmic Fistman."}], "tags": [], "owner": {"reputation": 1665, "user_id": 4638952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03791badf72f6918a8910148dfc4401e?s=128&d=identicon&r=PG&f=1", "display_name": "SnoProblem", "link": "https://stackoverflow.com/users/4638952/snoproblem"}, "is_accepted": true, "score": 1, "last_activity_date": 1444702830, "creation_date": 1444702830, "answer_id": 33093095, "question_id": 33092994, "link": "https://stackoverflow.com/questions/33092994/golang-variable-argument/33093095#33093095", "title": "Golang : Variable argument", "body": "<p>You're mis-using the variadic shorthand in your call to <code>fmt.Println()</code>.  What you're actually sending is 2 arguments: a single string, then the slice of type <code>interface{}</code> expanded.  The function call will not concatenate that into a single slice.</p>\n\n<p>This design will compile and run with the results you're expecting:</p>\n\n<pre><code>func myPrint(v ...interface{}) {\n    fmt.Print(\"Hello \")\n    fmt.Println(v...)\n}\n\nfunc main() {\n    myPrint(\"new\", \"world\")\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95, "user_id": 4139166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/079a22c9c08d2b54e915c602db8f69d5?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Swaminathan", "link": "https://stackoverflow.com/users/4139166/joseph-swaminathan"}, "edited": false, "score": 1, "creation_date": 1444706651, "post_id": 33093145, "comment_id": 54002985, "body": "Thanks that works. I also did the same to get by. But I would like to understand why the other doesn&#39;t work. Is this an expected behavior according to language specs or an anomaly of the compiler?"}], "tags": [], "owner": {"reputation": 30089, "user_id": 22147, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/x74x2.png?s=128&g=1", "display_name": "Rhythmic Fistman", "link": "https://stackoverflow.com/users/22147/rhythmic-fistman"}, "is_accepted": false, "score": 5, "last_activity_date": 1444703180, "creation_date": 1444703180, "answer_id": 33093145, "question_id": 33092994, "link": "https://stackoverflow.com/questions/33092994/golang-variable-argument/33093145#33093145", "title": "Golang : Variable argument", "body": "<p>Try this. It prepends Hello to the variadic arguments, then prints them all at once with <code>println</code>.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc myPrint(v ...interface{}) {\n    a := append([]interface{}{\"Hello\"}, v...)   // prepend \"Hello\" to variadics\n    fmt.Println(a...)                           // println the whole lot\n}\nfunc main() {\n    myPrint(\"new\", \"world\")\n}\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 4139166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/079a22c9c08d2b54e915c602db8f69d5?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Swaminathan", "link": "https://stackoverflow.com/users/4139166/joseph-swaminathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3207, "favorite_count": 0, "accepted_answer_id": 33093095, "answer_count": 2, "score": 2, "last_activity_date": 1444703180, "creation_date": 1444702134, "question_id": 33092994, "link": "https://stackoverflow.com/questions/33092994/golang-variable-argument", "title": "Golang : Variable argument", "body": "<p>When I compile the following program</p>\n\n<pre><code>func myPrint(v ...interface{}) {\n        fmt.Println(\"Hello\", v...)\n}\nfunc main() {\n    myPrint(\"new\", \"world\")\n}\n</code></pre>\n\n<p>I get a compilation error</p>\n\n<pre><code>too many arguments in call to fmt.Println\n</code></pre>\n\n<p>I thought v... is going to expand into 2nd, 3rd arguments and the fmt.Println would see three item variadic argument list. I thought it would be equivalent to</p>\n\n<pre><code>fmt.Println(\"Hello\", \"new\", \"world\")\n</code></pre>\n\n<p>Why is it giving an error.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 4, "creation_date": 1444698762, "post_id": 33092559, "comment_id": 54001120, "body": "elemType is not a type, it is a var, that&#39;s why that type assertion cannot work. You could do a type assertion to <code>reflect.Type</code>, but somehow I doubt that&#39;s what you want to do. Show us some code maybe?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1444710472, "post_id": 33092559, "comment_id": 54004042, "body": "Puh, empty <code>interface{}</code> <i>and</i> type assertion to <code>reflect.Type</code>! Are you sure you a) must and b) should solve your problem like this? Sometimes reflection is the best way to do things, sometimes the empty interface is helpful, but both are not the most straightforward way to solve problems."}], "answers": [{"tags": [], "owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "is_accepted": false, "score": 2, "last_activity_date": 1444709662, "creation_date": 1444709662, "answer_id": 33093997, "question_id": 33092559, "link": "https://stackoverflow.com/questions/33092559/in-golang-how-to-type-assert-an-interface-to-a-type-specified-by-a-reflect-ty/33093997#33093997", "title": "In golang, how to type assert an interface{} to a type specified by a reflect.Type?", "body": "<p>Consider a standard type assertion in Go:</p>\n\n<pre><code>v := a.(typeName)\n</code></pre>\n\n<p>Here the compiler can determine the type of the variable <code>v</code> at compile time, and make use of that knowledge when compiling any further statements involving the variable.</p>\n\n<p>With your example of using a <code>refltect.Type</code> variable in the assertion, it would be impossible to determine the type of <code>v</code>, so the code could not be compiled.</p>\n\n<p>If you need to check that a particular interface variable is of a particular type at runtime, you can still do that with the <code>reflect</code> package.  For example:</p>\n\n<pre><code>// if elemType is a normal type\nif reflect.ValueOf(a).Type() == elemType {\n    fmt.Println(\"type matches\")\n}\n\n// if elemType is an interface, can check if the value implements it\nif reflect.ValueOf(a).Type().Implements(elemType) {\n    fmt.Println(\"value implements interface\")\n}\n</code></pre>\n\n<p>But you will need a concrete type to return back to standard variables.  If you've only got a small selection of possible types, perhaps using a type switch might do what you want.</p>\n"}], "owner": {"reputation": 632, "user_id": 4068848, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/FD7nX.png?s=128&g=1", "display_name": "huron", "link": "https://stackoverflow.com/users/4068848/huron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1619, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1444741631, "creation_date": 1444698348, "last_edit_date": 1444741631, "question_id": 33092559, "link": "https://stackoverflow.com/questions/33092559/in-golang-how-to-type-assert-an-interface-to-a-type-specified-by-a-reflect-ty", "title": "In golang, how to type assert an interface{} to a type specified by a reflect.Type?", "body": "<p>For example, I have an <code>interface{}</code> named <code>a</code>, and I also have an <code>reflect.Type</code> called <code>elemType</code>. Now, I want to type assert a to <code>elemType</code>, but <code>a.(elemType)</code> can't be compiled successfully. How to fix it?</p>\n\n<p>Sorry for my confusing expression. My meaning is that I get a type from a function, and I want to type assert an interface{} to this type, but this type is stored in a reflect.Type variable.</p>\n\n<p>What I want to do is similar to the code below:</p>\n\n<pre><code>var a interface{}\n\n//do something\n\nfunc getType() reflect.Type {\n    var ret reflect.Type\n    //do something\n    return ret\n}\n\ntargetType := getType()\nresult := a.(targetType)\n</code></pre>\n"}, {"tags": ["string", "go", "string-formatting", "text-alignment"], "comments": [{"owner": {"reputation": 77, "user_id": 2750176, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d9c1d01bdd9953ba7d28d344a040c5db?s=128&d=identicon&r=PG&f=1", "display_name": "pronessssssssssss", "link": "https://stackoverflow.com/users/2750176/pronessssssssssss"}, "edited": false, "score": 0, "creation_date": 1444695777, "post_id": 33091939, "comment_id": 54000296, "body": "Dont understand why people are downvoting this ! If you cant provide a solution and still want to downvote then atleast state the reason why you did that!"}, {"owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "edited": false, "score": 7, "creation_date": 1444696665, "post_id": 33091939, "comment_id": 54000584, "body": "I would guess people are downvoting because it looks like asking someone to do your homework for you. There are multiple ways you could solve this problem. Consider looking at <code>strings.Repeat</code>, the padding options on <code>fmt.Printf</code> or even just using some nested loops."}, {"owner": {"reputation": 77, "user_id": 2750176, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d9c1d01bdd9953ba7d28d344a040c5db?s=128&d=identicon&r=PG&f=1", "display_name": "pronessssssssssss", "link": "https://stackoverflow.com/users/2750176/pronessssssssssss"}, "reply_to_user": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "edited": false, "score": 0, "creation_date": 1444722589, "post_id": 33091939, "comment_id": 54009547, "body": "@jcbwlkr Definetly this was not a homework .  I was taking a online quiz and came across this .  I posted my code, the output I am getting and the output that was epected.  I definetlely dont see any form of spoonfeeding here.  Strange to see so many downvotes for a question that was valid; uses String functions and generates output as described."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1444803435, "post_id": 33091939, "comment_id": 54049362, "body": "Well, my take is that your question is about a thing <i>too simple</i> to ask for help on solving. No, really. You as a programmer are supposed to program. There&#39;s just no indication of any attempt at solving the problem in your example. Please consider reading <a href=\"http://whathaveyoutried.com\" rel=\"nofollow noreferrer\">whathaveyoutried.com</a>"}], "answers": [{"comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1444835624, "post_id": 33096326, "comment_id": 54070225, "body": "For more flexibility, you could avoid hardcoding the upper bound (<code>6</code>, in this case) in the format string: <code>fmtString := &quot;%&quot; + strconv.Itoa(n) + &quot;s\\n&quot;</code> (where <code>n := 6</code>), and then, in the loop, <code>for i := 1; i &lt;= n; i++ {fmt.Printf(fmtString, strings.Repeat(&quot;#&quot;, i))}</code>."}], "tags": [], "owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "is_accepted": true, "score": 3, "last_activity_date": 1444720375, "creation_date": 1444720375, "answer_id": 33096326, "question_id": 33091939, "link": "https://stackoverflow.com/questions/33091939/how-to-print-the-star-pattern-aligned-to-right-hand-side-in-go-lang/33096326#33096326", "title": "How to print the star pattern aligned to right hand side in GO lang", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    for i := 1; i &lt;= 6; i++ {\n        fmt.Printf(\"%6s\\n\", strings.Repeat(\"#\", i))\n    }\n}\n</code></pre>\n\n<p>Try it on the <kbd><a href=\"https://play.golang.org/p/OqgZTi9GjV\" rel=\"nofollow\">Go playground</a></kbd></p>\n"}], "owner": {"reputation": 77, "user_id": 2750176, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d9c1d01bdd9953ba7d28d344a040c5db?s=128&d=identicon&r=PG&f=1", "display_name": "pronessssssssssss", "link": "https://stackoverflow.com/users/2750176/pronessssssssssss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1857, "favorite_count": 0, "accepted_answer_id": 33096326, "answer_count": 1, "score": -5, "last_activity_date": 1444720375, "creation_date": 1444693634, "last_edit_date": 1444694216, "question_id": 33091939, "link": "https://stackoverflow.com/questions/33091939/how-to-print-the-star-pattern-aligned-to-right-hand-side-in-go-lang", "title": "How to print the star pattern aligned to right hand side in GO lang", "body": "<p>I want to print a star pattern in GO .The desired output is as belows :  </p>\n\n<p><a href=\"https://i.stack.imgur.com/24vaE.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/24vaE.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I wrote the program to print it but I could write it to print the output aliged on the leftmost side. </p>\n\n<p>The code is : </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    for i := 1; i &lt;= 6; i++ {\n        if i == 1 {\n            fmt.Printfln(\"#\")\n            fmt.Println()\n        }\n        if i == 2 {\n            fmt.Println( \"##\")\n            fmt.Println()\n        }\n        if i == 3 {\n            fmt.Println(\"###\")\n            fmt.Println()\n        }\n        if i == 4 {\n            fmt.Println(\"####\")\n            fmt.Println()\n        }\n        if i == 5 {\n            fmt.Println(\"#####\")\n            fmt.Println()\n        }\n        if i == 6 {\n            fmt.Println(\"######\")\n            fmt.Println()\n        }\n    }\n\n    //Enter your code here. Read input from STDIN. Print output to STDOUT\n}\n</code></pre>\n\n<p>The output that I get is : \n<a href=\"https://i.stack.imgur.com/1iGpA.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1iGpA.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>How can I achieve the desired format in GO ? </p>\n"}, {"tags": ["go", "io"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1444688253, "post_id": 33091071, "comment_id": 53998119, "body": "<code>w+</code> doesn\u2019t append. Try <code>os.ModeAppend | 0644</code>, anyway."}, {"owner": {"reputation": 62800, "user_id": 391161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb76d8bcc69144a3ee4c893ece7fc588?s=128&d=identicon&r=PG&f=1", "display_name": "merlin2011", "link": "https://stackoverflow.com/users/391161/merlin2011"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1444688351, "post_id": 33091071, "comment_id": 53998148, "body": "@minitech, I had intended to append, but the focus is on the permissions of the file after the operation. I&#39;ll edit the question."}, {"owner": {"reputation": 62800, "user_id": 391161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb76d8bcc69144a3ee4c893ece7fc588?s=128&d=identicon&r=PG&f=1", "display_name": "merlin2011", "link": "https://stackoverflow.com/users/391161/merlin2011"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1444688716, "post_id": 33091071, "comment_id": 53998298, "body": "@minitech, That works! I will accept that answer, although I do wonder whether one must always explicitly specify the permissions to have anything reasonable given that this is not needed in most other languages."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1444688806, "post_id": 33091071, "comment_id": 53998331, "body": "I think many of them do, but with 0666 as reasonable defaults, since their permissions and modes are separate."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1444688917, "post_id": 33091071, "comment_id": 53998369, "body": "Yeah that behavior is a bit surprising. I&#39;m probably mixing up the method in <code>ioutil</code> with another one but I&#39;m fairly certain I&#39;ve written plenty of files in Go without ever considering this."}], "answers": [{"comments": [{"owner": {"reputation": 19167, "user_id": 432193, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/87f2efac0ff72169aa6e92fc3c613189?s=128&d=identicon&r=PG", "display_name": "Endophage", "link": "https://stackoverflow.com/users/432193/endophage"}, "edited": false, "score": 0, "creation_date": 1444693712, "post_id": 33091201, "comment_id": 53999800, "body": "Does this actually work? Just curious because the docs for <code>ioutil.WriteFile</code> explicitly say it truncates the file."}, {"owner": {"reputation": 62800, "user_id": 391161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb76d8bcc69144a3ee4c893ece7fc588?s=128&d=identicon&r=PG&f=1", "display_name": "merlin2011", "link": "https://stackoverflow.com/users/391161/merlin2011"}, "reply_to_user": {"reputation": 19167, "user_id": 432193, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/87f2efac0ff72169aa6e92fc3c613189?s=128&d=identicon&r=PG", "display_name": "Endophage", "link": "https://stackoverflow.com/users/432193/endophage"}, "edited": false, "score": 0, "creation_date": 1444718048, "post_id": 33091201, "comment_id": 54007001, "body": "@Endophage, I am not trying to match behavior exactly with the <code>C</code> program, just to get the permissions on the resulting file correct."}, {"owner": {"reputation": 19167, "user_id": 432193, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/87f2efac0ff72169aa6e92fc3c613189?s=128&d=identicon&r=PG", "display_name": "Endophage", "link": "https://stackoverflow.com/users/432193/endophage"}, "reply_to_user": {"reputation": 62800, "user_id": 391161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb76d8bcc69144a3ee4c893ece7fc588?s=128&d=identicon&r=PG&f=1", "display_name": "merlin2011", "link": "https://stackoverflow.com/users/391161/merlin2011"}, "edited": false, "score": 0, "creation_date": 1444746444, "post_id": 33091201, "comment_id": 54025489, "body": "@merlin2011 don&#39;t take offense but I wasn&#39;t asking for your benefit :-P I&#39;m actually curious if this will append because I would use it. I guess I&#39;ll just hack up a tiny test program to see."}], "tags": [], "owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "is_accepted": true, "score": 4, "last_activity_date": 1444688835, "creation_date": 1444688835, "answer_id": 33091201, "question_id": 33091071, "link": "https://stackoverflow.com/questions/33091071/which-combination-of-os-filemodes-corresponds-to-a-in-fopen-with-respect-to/33091201#33091201", "title": "Which combination of os.FileMode&#39;s corresponds to `a` in fopen, with respect to the permissions on the created file?", "body": "<p>As <code>FileMode</code> includes permission bits for newly-created files, you\u2019ll need to provide those:</p>\n\n<pre><code>ioutil.WriteFile(\"/tmp/FooBar\", []byte(\"Hello World\"), os.ModeAppend | 0644)\n</code></pre>\n"}], "owner": {"reputation": 62800, "user_id": 391161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb76d8bcc69144a3ee4c893ece7fc588?s=128&d=identicon&r=PG&f=1", "display_name": "merlin2011", "link": "https://stackoverflow.com/users/391161/merlin2011"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 0, "accepted_answer_id": 33091201, "answer_count": 1, "score": 1, "last_activity_date": 1444688835, "creation_date": 1444688060, "last_edit_date": 1444688810, "question_id": 33091071, "link": "https://stackoverflow.com/questions/33091071/which-combination-of-os-filemodes-corresponds-to-a-in-fopen-with-respect-to", "title": "Which combination of os.FileMode&#39;s corresponds to `a` in fopen, with respect to the permissions on the created file?", "body": "<p>Consider the following short program in Golang, which simply attempts to write a file.</p>\n\n<pre><code>package main\n\nimport \"io/ioutil\"\nimport \"os\"\n\nfunc main() {\n    ioutil.WriteFile(\"/tmp/FooBar\", []byte(\"Hello World\"), os.ModeAppend)\n}\n</code></pre>\n\n<p>After running this program, I get a file with the following permissions.</p>\n\n<pre><code>---------- 1 merlin sudo 5 Oct 12 15:02 /tmp/FooBar\n</code></pre>\n\n<p>The permissions are essentially unuseable.</p>\n\n<p>If I run the equivalent C program.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n    FILE* foo = fopen(\"/tmp/BarFoo\", \"a\");\n    fprintf(foo, \"Hello World\");\n    fclose(foo);\n}\n</code></pre>\n\n<p>Then I get a file that looks like this, which is much more desirable.</p>\n\n<pre><code>-rw-r--r-- 1 merlin sudo 11 Oct 12 15:10 /tmp/BarFoo\n</code></pre>\n\n<p><strong>What is the correct combination of flags in the <code>Golang</code> program to produce a file with the same permissions as the C program?</strong></p>\n\n<p>I have looked at the <a href=\"https://golang.org/pkg/os/#FileMode\" rel=\"nofollow\">FileMode documentation</a> but did not see any good candidates.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1444689626, "post_id": 33090833, "comment_id": 53998615, "body": "Yeah you can&#39;t assign to an int pointer unless you already have an int stored in memory somewhere which isn&#39;t the case here (you&#39;re assigning that memory address to the value, not the value itself). Personally, I don&#39;t think you should be using a pointer in your struct. Unless your actual program differs substantially from your example there is no reason for it. It&#39;s bad for application performance too. In the example you gave you&#39;re doubling the memory required to store those values, one word for the int, another to store the address as a value on your struct."}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1444689849, "post_id": 33090833, "comment_id": 53998682, "body": "I have to do it for MySQL and NULL values. sql.NullInt64 works but I&#39;m not sure if it works with sqlx library where you can just take a struct and pass it ass parameter for prepared statements."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1444690014, "post_id": 33090833, "comment_id": 53998729, "body": "Oh yeah that makes sense. This is when you&#39;re trying to instantiate the type directly then, right? Like when you unmarshal a row into an instance of type <code>Message</code> that value gets set correctly, right?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1444710563, "post_id": 33090833, "comment_id": 54004071, "body": "This is duplicate. (Too lazy to look up the original)."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444689940, "post_id": 33090986, "comment_id": 53998709, "body": "Don&#39;t forget about <code>new(int)</code>"}, {"owner": {"reputation": 1615, "user_id": 1376205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ff8ba613f2dc50cc30e7f3af3e2914?s=128&d=identicon&r=PG", "display_name": "Will C", "link": "https://stackoverflow.com/users/1376205/will-c"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1444690588, "post_id": 33090986, "comment_id": 53998905, "body": "@JimB but I don&#39;t think its possible to assign it a value. It would still be a two step process, something like <code>value := new(int); *value = 10</code> . I guess thats a little more elegant than assigning a temporary variable and getting the reference of that though."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1444695172, "post_id": 33090986, "comment_id": 54000144, "body": "It does assign a value, but it&#39;s always the zero value ;) sometimes that&#39;s all you need to ensure something&#39;s not nil."}], "tags": [], "owner": {"reputation": 1615, "user_id": 1376205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ff8ba613f2dc50cc30e7f3af3e2914?s=128&d=identicon&r=PG", "display_name": "Will C", "link": "https://stackoverflow.com/users/1376205/will-c"}, "is_accepted": true, "score": 2, "last_activity_date": 1444687598, "creation_date": 1444687598, "answer_id": 33090986, "question_id": 33090833, "link": "https://stackoverflow.com/questions/33090833/is-there-a-shortcut-for-assigning-a-variable-to-a-pointer-without-creating-the-v/33090986#33090986", "title": "Is there a shortcut for assigning a variable to a pointer without creating the variable in a separate line first?", "body": "<p>I don't think you can because the value is a primitive and attempting to do it in one shot like the below would be a syntax error. Its attempting to get an address of a <strong>value</strong> so it wouldn't be possible. At least I am not aware of a way where its possible.</p>\n\n<pre><code>someInt := &amp;int64(10) // would not compile \n</code></pre>\n\n<p>The other alternative you have is to write a function to return a pointer to the primitive like the following:</p>\n\n<pre><code>func NewIntPointer(value int) *int {\n  return &amp;value\n}\n</code></pre>\n"}], "owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "accepted_answer_id": 33090986, "answer_count": 1, "score": 1, "last_activity_date": 1444687598, "creation_date": 1444686788, "question_id": 33090833, "link": "https://stackoverflow.com/questions/33090833/is-there-a-shortcut-for-assigning-a-variable-to-a-pointer-without-creating-the-v", "title": "Is there a shortcut for assigning a variable to a pointer without creating the variable in a separate line first?", "body": "<p>If I have a struct like this:</p>\n\n<pre><code>type Message struct {\n    Id      int64\n    Message string\n    ReplyTo *int64\n}\n</code></pre>\n\n<p>And then if I did create an instance of this struct like this:</p>\n\n<pre><code>var m Message\nm.Id = 1\nm.Message = \"foo bar yo\"\n\nvar replyTo = int64(64)\nm.ReplyTo = &amp;replyTo\n</code></pre>\n\n<p>Then it would work.</p>\n\n<p>But I was wondering if there was a shortcut for the last step?</p>\n\n<p>I tried doing something like:</p>\n\n<pre><code>m.ReplyTo = &amp;int64{64}\n</code></pre>\n\n<p>But it did not work.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 8, "creation_date": 1444681476, "post_id": 33089523, "comment_id": 53995269, "body": "Go FAQ: <a href=\"https://golang.org/doc/faq#implements_interface\" rel=\"nofollow noreferrer\">Why doesn&#39;t Go have &quot;implements&quot; declarations?</a> and answer <a href=\"https://golang.org/doc/faq#guarantee_satisfies_interface\" rel=\"nofollow noreferrer\">How can I guarantee my type satisfies an interface?</a>"}, {"owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 0, "creation_date": 1584070646, "post_id": 33089523, "comment_id": 107329928, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/a/60663003\">Ensure a type implements an interface at compile time in Go</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1201, "user_id": 651028, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6d5887835c21dace586b98180544c74e?s=128&d=identicon&r=PG", "display_name": "Sergei G", "link": "https://stackoverflow.com/users/651028/sergei-g"}, "edited": false, "score": 1, "creation_date": 1565195132, "post_id": 33089540, "comment_id": 101278873, "body": "Thank you, that has been one of the best tips I have kept in my GO lang toolbox for years."}, {"owner": {"reputation": 320, "user_id": 5532217, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/84da3181a852ae4522f7f1e725c011ff?s=128&d=identicon&r=PG&f=1", "display_name": "Siege21x", "link": "https://stackoverflow.com/users/5532217/siege21x"}, "edited": false, "score": 0, "creation_date": 1583083097, "post_id": 33089540, "comment_id": 106988726, "body": "hi this may be an thread but, how do you implement design patterns if implementation will be like that? is it still possible&gt;"}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 31, "last_activity_date": 1444688642, "last_edit_date": 1444688642, "creation_date": 1444681245, "answer_id": 33089540, "question_id": 33089523, "link": "https://stackoverflow.com/questions/33089523/how-to-mark-golang-struct-as-implementing-interface/33089540#33089540", "title": "How to mark golang struct as implementing interface?", "body": "<p>In Go, implementing an interface is implicit. There is no need to explicitly mark it as implementing the interface. Though it's a bit different, you can use assignment to test if a type implements an interface and it will produce a compile time error if it does not. It looks like this (example from Go's FAQ page);</p>\n\n<pre><code>type T struct{}\nvar _ I = T{}       // Verify that T implements I.\nvar _ I = (*T)(nil) // Verify that *T implements I.\n</code></pre>\n\n<p>To answer your second question, yes that is saying your struct is composed of a type which implements that interface.</p>\n"}], "owner": {"reputation": 1201, "user_id": 651028, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6d5887835c21dace586b98180544c74e?s=128&d=identicon&r=PG", "display_name": "Sergei G", "link": "https://stackoverflow.com/users/651028/sergei-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10927, "favorite_count": 10, "accepted_answer_id": 33089540, "answer_count": 1, "score": 18, "last_activity_date": 1444688642, "creation_date": 1444681168, "question_id": 33089523, "link": "https://stackoverflow.com/questions/33089523/how-to-mark-golang-struct-as-implementing-interface", "title": "How to mark golang struct as implementing interface?", "body": "<p>I have interface:</p>\n\n<pre><code>  type MyInterface interface {\n  ...\n  }\n</code></pre>\n\n<p>and I want to mark that my struct implements it.  I think it is not possible in go, but I want to be certain.  </p>\n\n<p>I did the following, but I think it results in an anonymous variable that implements interface.  Am I right?</p>\n\n<pre><code>  type MyStruct struct {\n    ...\n    MyInterface\n  }\n</code></pre>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 3493, "user_id": 4270992, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZTDS.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4270992/nick"}, "edited": false, "score": 1, "creation_date": 1444752214, "post_id": 33091084, "comment_id": 54029418, "body": "There&#39;s of course always the option of putting the files into <a href=\"https://cloud.google.com/storage/\" rel=\"nofollow noreferrer\">Cloud Storage</a>."}, {"owner": {"reputation": 3946, "user_id": 736070, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2ffe94c53681b5b72e448cd8a575e687?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/736070/dan"}, "edited": false, "score": 0, "creation_date": 1444760657, "post_id": 33091084, "comment_id": 54034198, "body": "Copying files as part of a build script as @AlistairB suggests would also work."}, {"owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "reply_to_user": {"reputation": 3493, "user_id": 4270992, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZTDS.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4270992/nick"}, "edited": false, "score": 0, "creation_date": 1472659954, "post_id": 33091084, "comment_id": 65844620, "body": "@Nick, True, but that doesn&#39;t play very well with version-controlling the files (which are technically part of the app code)"}], "tags": [], "owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "is_accepted": true, "score": 1, "last_activity_date": 1472659843, "last_edit_date": 1472659843, "creation_date": 1444688146, "answer_id": 33091084, "question_id": 33088104, "link": "https://stackoverflow.com/questions/33088104/how-can-i-share-files-html-templates-between-app-engine-modules/33091084#33091084", "title": "How can I share files (HTML templates) between App Engine modules?", "body": "<p>GAE regards each module as a standalone application (each will run in its own GAE instance). No uploadable artifacts are shared at GAE level between the modules, each such artifact needs to be separately uploaded in each module using it.</p>\n\n<p>While other approaches are technically possible (as other mentioned) symlinking the files is IMHO the simplest solution to avoid code duplication in your own repo.</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 5383542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c806b52f6b16bdba08d43fece246a59e?s=128&d=identicon&r=PG&f=1", "display_name": "AlistairB", "link": "https://stackoverflow.com/users/5383542/alistairb"}, "is_accepted": false, "score": 1, "last_activity_date": 1444705142, "creation_date": 1444705142, "answer_id": 33093384, "question_id": 33088104, "link": "https://stackoverflow.com/questions/33088104/how-can-i-share-files-html-templates-between-app-engine-modules/33093384#33093384", "title": "How can I share files (HTML templates) between App Engine modules?", "body": "<p>You could copy the templates to each module as part of a build step and gitignore the copied files.</p>\n"}], "owner": {"reputation": 3946, "user_id": 736070, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2ffe94c53681b5b72e448cd8a575e687?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/736070/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 33091084, "answer_count": 2, "score": 0, "last_activity_date": 1472659843, "creation_date": 1444675502, "question_id": 33088104, "link": "https://stackoverflow.com/questions/33088104/how-can-i-share-files-html-templates-between-app-engine-modules", "title": "How can I share files (HTML templates) between App Engine modules?", "body": "<p>I am using the Go runtime of Google App Engine and have two modules. I would like to share HTML templates between them but don't the best way.</p>\n\n<p>My modules are organised as below:</p>\n\n<pre><code>src/github.com/myproject/moduleone/app.yaml\nsrc/github.com/myproject/moduleone/templates/base.html\nsrc/github.com/myproject/moduleone/templates/homeone.html\n\nsrc/github.com/myproject/moduletwo/app.yaml\nsrc/github.com/myproject/moduletwo/templates/base.html\nsrc/github.com/myproject/moduletwo/templates/hometwo.html\n</code></pre>\n\n<p>In my situation <code>base.html</code> is the same for <code>moduleone</code> and <code>moduletwo</code>. How can I share it between both modules without having to duplicate the file as is done now?</p>\n\n<p>I would like to put <code>base.html</code> in a directory called  <code>src/github.com/myproject/templates</code> but I believe neither <code>moduleone</code> or <code>moduletwo</code> would be able to access the file as it's not in the same or child directory of the module <code>app.yaml</code> files. Is my only option to symlink the <code>base.html</code> file between each module's template directory?</p>\n"}, {"tags": ["javascript", "go", "cryptography", "sha"], "comments": [{"owner": {"reputation": 1462, "user_id": 600540, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/33ae9fd93e4d5c771c1bab29c8705106?s=128&d=identicon&r=PG", "display_name": "Ronze", "link": "https://stackoverflow.com/users/600540/ronze"}, "reply_to_user": {"reputation": 58084, "user_id": 1816580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30e6b41f1e2bd48b058e8e72c1f0f57?s=128&d=identicon&r=PG", "display_name": "Artjom B.", "link": "https://stackoverflow.com/users/1816580/artjom-b"}, "edited": false, "score": 0, "creation_date": 1444673310, "post_id": 33087033, "comment_id": 53991341, "body": "Sorry, just added a snippet."}, {"owner": {"reputation": 58084, "user_id": 1816580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30e6b41f1e2bd48b058e8e72c1f0f57?s=128&d=identicon&r=PG", "display_name": "Artjom B.", "link": "https://stackoverflow.com/users/1816580/artjom-b"}, "edited": false, "score": 0, "creation_date": 1444673564, "post_id": 33087033, "comment_id": 53991487, "body": "Can you show both results?"}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "reply_to_user": {"reputation": 58084, "user_id": 1816580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30e6b41f1e2bd48b058e8e72c1f0f57?s=128&d=identicon&r=PG", "display_name": "Artjom B.", "link": "https://stackoverflow.com/users/1816580/artjom-b"}, "edited": false, "score": 0, "creation_date": 1444673987, "post_id": 33087033, "comment_id": 53991726, "body": "@ArtjomB. I looked into the meaning of &quot;parsing&quot; an UUID. It seems that it will remove the dashes, convert the values and produce a byte array. Ronze I think you could try removing the hashes, perform hex decode and then SHA1, but I&#39;m not sure."}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1444674172, "post_id": 33087033, "comment_id": 53991815, "body": "<a href=\"https://code.google.com/p/go-uuid/source/browse/uuid/uuid.go?r=4f1c1d3e2957d4fad2fe354912bebb69cf5928e6\" rel=\"nofollow noreferrer\">Now I am sure</a>"}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 2, "creation_date": 1444674532, "post_id": 33087033, "comment_id": 53991981, "body": "...but there are more calculations in <code>NewSHA1</code>, that&#39;s not just SHA1. OK, enough reasons to at least vote up."}, {"owner": {"reputation": 1462, "user_id": 600540, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/33ae9fd93e4d5c771c1bab29c8705106?s=128&d=identicon&r=PG", "display_name": "Ronze", "link": "https://stackoverflow.com/users/600540/ronze"}, "edited": false, "score": 0, "creation_date": 1444674718, "post_id": 33087033, "comment_id": 53992069, "body": "Thanks maarten. I still can&#39;t figure out how to do this. I understand that I need to turn the SHA1 into a UUID, but the Golang code can help me with that. It&#39;s just grabbing the first <code>n</code> characters and adding the <code>-</code>. But I can&#39;t seem to generate the same SHA1 no matter what I do with the namespace."}, {"owner": {"reputation": 16814, "user_id": 3849456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AonOf.jpg?s=128&g=1", "display_name": "Anzel", "link": "https://stackoverflow.com/users/3849456/anzel"}, "edited": false, "score": 0, "creation_date": 1444677493, "post_id": 33087033, "comment_id": 53993358, "body": "do you want SHA1 or NewSHA1? Apparently they are different implementation with NewSHA1 adding another hash bit in the mix as in version 5?"}, {"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 0, "creation_date": 1444681962, "post_id": 33087033, "comment_id": 53995480, "body": "The part I&#39;m not certain you&#39;re getting is that, for the javascript, you must hex decode the namespace string before you hash."}], "answers": [{"comments": [{"owner": {"reputation": 1566, "user_id": 299209, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/c1fc0e1dee65573215cdf9335ba19f71?s=128&d=identicon&r=PG", "display_name": "philk", "link": "https://stackoverflow.com/users/299209/philk"}, "edited": false, "score": 0, "creation_date": 1616428454, "post_id": 33509489, "comment_id": 117993099, "body": "How would this look like using a lib like node-forge which has SHA and hex tooling on board?"}], "tags": [], "owner": {"reputation": 1462, "user_id": 600540, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/33ae9fd93e4d5c771c1bab29c8705106?s=128&d=identicon&r=PG", "display_name": "Ronze", "link": "https://stackoverflow.com/users/600540/ronze"}, "is_accepted": true, "score": 4, "last_activity_date": 1446586447, "creation_date": 1446586447, "answer_id": 33509489, "question_id": 33087033, "link": "https://stackoverflow.com/questions/33087033/generating-the-same-sha1-uuid-in-golang-and-javascript/33509489#33509489", "title": "Generating the same SHA1 UUID in golang and Javascript", "body": "<p>Well, that only took me a month.</p>\n\n<pre><code>var SHA1Generator = {\n\n    hex_chr: \"0123456789abcdef\",\n\n    hex: function (num) {\n        var str = \"\";\n        for (var j = 7; j &gt;= 0; j--)\n            str += this.hex_chr.charAt((num &gt;&gt; (j * 4)) &amp; 0x0F);\n        return str;\n    },\n\n\n    str2blks_SHA1: function (str) {\n        var nblk = ((str.length + 8) &gt;&gt; 6) + 1;\n        var blks = new Array(nblk * 16);\n        for (var i = 0; i &lt; nblk * 16; i++) blks[i] = 0;\n        for (i = 0; i &lt; str.length; i++)\n            blks[i &gt;&gt; 2] |= str.charCodeAt(i) &lt;&lt; (24 - (i % 4) * 8);\n        blks[i &gt;&gt; 2] |= 0x80 &lt;&lt; (24 - (i % 4) * 8);\n        blks[nblk * 16 - 1] = str.length * 8;\n        return blks;\n    },\n\n\n    add: function (x, y) {\n        var lsw = (x &amp; 0xFFFF) + (y &amp; 0xFFFF);\n        var msw = (x &gt;&gt; 16) + (y &gt;&gt; 16) + (lsw &gt;&gt; 16);\n        return (msw &lt;&lt; 16) | (lsw &amp; 0xFFFF);\n    },\n\n\n    rol: function (num, cnt) {\n        return (num &lt;&lt; cnt) | (num &gt;&gt;&gt; (32 - cnt));\n    },\n\n\n    ft: function (t, b, c, d) {\n        if (t &lt; 20) return (b &amp; c) | ((~b) &amp; d);\n        if (t &lt; 40) return b ^ c ^ d;\n        if (t &lt; 60) return (b &amp; c) | (b &amp; d) | (c &amp; d);\n        return b ^ c ^ d;\n    },\n\n\n    kt: function (t) {\n        return (t &lt; 20) ? 1518500249 : (t &lt; 40) ? 1859775393 :\n         (t &lt; 60) ? -1894007588 : -899497514;\n    },\n\n    calcSHA1FromByte: function(byteArr) {\n        var str = '';\n        for(var i=0; i&lt;byteArr.length; i++)\n            str += String.fromCharCode(byteArr[i]);\n        return this.calcSHA1(str);\n    },\n\n    calcSHA1: function (str) {\n        if (str != '') {\n            var x = this.str2blks_SHA1(str);\n            var w = new Array(80);\n\n            var a = 1732584193;\n            var b = -271733879;\n            var c = -1732584194;\n            var d = 271733878;\n            var e = -1009589776;\n\n            for (var i = 0; i &lt; x.length; i += 16) {\n                var olda = a;\n                var oldb = b;\n                var oldc = c;\n                var oldd = d;\n                var olde = e;\n\n                for (var j = 0; j &lt; 80; j++) {\n                    if (j &lt; 16) w[j] = x[i + j];\n                    else w[j] = this.rol(w[j - 3] ^ w[j - 8] ^ w[j - 14] ^ w[j - 16], 1);\n                    t = this.add(this.add(this.rol(a, 5), this.ft(j, b, c, d)), this.add(this.add(e, w[j]), this.kt(j)));\n                    e = d;\n                    d = c;\n                    c = this.rol(b, 30);\n                    b = a;\n                    a = t;\n                }\n\n                a = this.add(a, olda);\n                b = this.add(b, oldb);\n                c = this.add(c, oldc);\n                d = this.add(d, oldd);\n                e = this.add(e, olde);\n            }\n            return this.hex(a) + this.hex(b) + this.hex(c) + this.hex(d) + this.hex(e);\n        }\n        else {\n            return '';\n        }\n    }\n};\n\nfunction stringToByteArray(str) {\n  var bytes = [];\n  for (var i = 0; i &lt; str.length; ++i) {\n      bytes.push(str.charCodeAt(i));\n  }\n  return bytes;\n}\n\nfunction uuidToByteArray(hex) {\n\n  // If this is a uuid, remove the dashes\n  hex = hex.replace(/-/g, \"\");\n\n  // convert each hex number into a string representation\n  // of the byte integer.\n  var bytes = [];\n  for(var i = 0; i &lt; hex.length; i += 2) {\n    bytes.push(parseInt(hex.substring(i, i+2),16));\n  }\n\n  return bytes;\n}\n\nfunction sha1ToUUID5(hash) {\n  var uuid =  hash.substring(0, 8) +\n    '-' + hash.substring(8, 12) +\n    // four most significant bits holds version number 5\n    '-' + ((parseInt(hash.substring(12, 16), 16) &amp; 0x0fff) | 0x5000).toString(16) +\n    // two most significant bits holds zero and one for variant DCE1.1\n    '-' + ((parseInt(hash.substring(16, 20), 16) &amp; 0x3fff) | 0x8000).toString(16) +\n    '-' + hash.substring(20, 32); //12 digits\n  return uuid;\n}\n\nvar namespace = \"e75a36a9-3323-40dd-a7d1-1c57ad2aa3cd\"\nvar id = \"event154\"\n\nvar namespaceBytes = uuidToByteArray(namespace);\nvar idBytes = stringToByteArray(id);\nvar allBytes = namespaceBytes.concat(idBytes);\n\nconsole.log(\"ORG 4505612c-c323-5d6f-b5cc-b7f362b9ba55\")\nconsole.log(\"NEW \" + sha1ToUUID5(SHA1Generator.calcSHA1FromByte(allBytes)))\n</code></pre>\n"}], "owner": {"reputation": 1462, "user_id": 600540, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/33ae9fd93e4d5c771c1bab29c8705106?s=128&d=identicon&r=PG", "display_name": "Ronze", "link": "https://stackoverflow.com/users/600540/ronze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1452, "favorite_count": 1, "accepted_answer_id": 33509489, "answer_count": 1, "score": 5, "last_activity_date": 1446586447, "creation_date": 1444671314, "last_edit_date": 1444673265, "question_id": 33087033, "link": "https://stackoverflow.com/questions/33087033/generating-the-same-sha1-uuid-in-golang-and-javascript", "title": "Generating the same SHA1 UUID in golang and Javascript", "body": "<p>I have what I thought was a pretty simply question. I'm using this code to generate a SHA1 uuid in Golang:</p>\n\n<pre><code>namespace := uuid.Parse(\"b9cfdb9d-f741-4e1f-89ae-fac6b2a5d740\")\nsha := uuid.NewSHA1(namespace, []byte(\"something\"))\nfmt.Println(sha.String())\n</code></pre>\n\n<p>Now I want to generate the same UUID in javascript, and I thought it would be as easy as something like this:</p>\n\n<pre><code>var hash = CryptoJS.SHA1(\"b9cfdb9d-f741-4e1f-89ae-fac6b2a5d740\" + \"something\")\n// chomp the hash into a UUID string\n</code></pre>\n\n<p>However, I'm running into serious issues. It seems that the <code>uuid.Parse</code> function in Golang is running <a href=\"https://code.google.com/p/go-uuid/source/browse/uuid/util.go#39\" rel=\"noreferrer\">this parsing function</a> that converts the namespace to a 16-byte array, so even though I use the same SHA1 algorithm in Javascript, I'm not getting the same output.</p>\n\n<p>I'v been messing around with doing the same in JS, but I'm stumped. </p>\n\n<p>Any smart crypto people in here that can help me?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1778, "user_id": 2303988, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/VcVRc.jpg?s=128&g=1", "display_name": "Alessio", "link": "https://stackoverflow.com/users/2303988/alessio"}, "edited": false, "score": 4, "creation_date": 1444662198, "post_id": 33084300, "comment_id": 53984997, "body": "you can&#39;t because otherwise you&#39;ll have a circular dependency between the 2 packages. You should read the GO docs before start using it : <a href=\"https://golang.org/doc/effective_go.html\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html</a> (you can also follow the tour <a href=\"https://tour.golang.org/welcome/1\" rel=\"nofollow noreferrer\">tour.golang.org/welcome/1</a>)"}, {"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 0, "creation_date": 1444662768, "post_id": 33084300, "comment_id": 53985384, "body": "Do not try to over-engineer code organization in Go. Many projects that you&#39;ll encounter online have a pretty flat structure. I recommend you to work in a single package to begin with (main) and eventually move code to other packages if it represents independent functionality."}, {"owner": {"reputation": 1, "user_id": 4551372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d9df3fef60b231d31fe1146f8643fe?s=128&d=identicon&r=PG&f=1", "display_name": "Irv", "link": "https://stackoverflow.com/users/4551372/irv"}, "edited": false, "score": 0, "creation_date": 1444663694, "post_id": 33084300, "comment_id": 53985958, "body": "Ah okay. That&#39;s a big change for me. In PHP you usually want to split everything into different files and folders. That&#39;s going to be a hard change (putting (almost) everything in the same folder)."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1444666571, "post_id": 33084300, "comment_id": 53987758, "body": "@Irv, in Go, you can have arbitrarily nested packages in your project. They just have to be <i>packages</i> (hence forming their own visibilty for their members) as Go programs are compiled, so when the program is executing there&#39;s no concept of files (which, in PHP, are loaded and parsed at runtime). Please consider reading my answer for useful pointers as you really have to relearn your approach to thinking about programming when moving to a compiled language."}], "answers": [{"comments": [{"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1444667968, "post_id": 33084765, "comment_id": 53988489, "body": "Unless you need everything to have access to everything, you should organize your project into packages with clear responsibilities and simple exposed (exported) APIs.  In vague terms, over-engineering is bad, but in any project of non-trivial complexity, you should think clearly about the boundaries and dependencies between components or packages or modules, Golang isn&#39;t somehow an exception to the rule."}, {"owner": {"reputation": 1582, "user_id": 3486065, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/EozB4.png?s=128&g=1", "display_name": "Taco de Wolff", "link": "https://stackoverflow.com/users/3486065/taco-de-wolff"}, "reply_to_user": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1444669424, "post_id": 33084765, "comment_id": 53989282, "body": "Of course, but <code>Log</code> is not necessarily something that goes into a new package. And especially controllers for a webapp should go in the root directory. The controllers are certainly not separate packages."}], "tags": [], "owner": {"reputation": 1582, "user_id": 3486065, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/EozB4.png?s=128&g=1", "display_name": "Taco de Wolff", "link": "https://stackoverflow.com/users/3486065/taco-de-wolff"}, "is_accepted": false, "score": 0, "last_activity_date": 1444663533, "creation_date": 1444663533, "answer_id": 33084765, "question_id": 33084300, "link": "https://stackoverflow.com/questions/33084300/php-to-go-how-should-i-structure-my-projects/33084765#33084765", "title": "PHP to Go. How should I structure my projects?", "body": "<p>To expand on what @SirDarius said to not over-organize your code structure.</p>\n\n<p>It is customary for Go projects to have one directory with sources. Each file is like a module and can be quite long in terms of lines. Each directory is a project, also sub-directories! They are sub-projects.</p>\n\n<p>Following that thought, is Controllers a sub-project? No, it's part of the actual project. So put that in the parent directory. If you have some code that could be reused outside of this package you make a new package or a sub-package (whichever fits best).</p>\n\n<p>Generally, simplify! Don't create directories to organize similar functionality, but group them by putting them into one file.</p>\n\n<p>In your case, have <code>main.go</code> and <code>log.go</code> in the root directory. Unless you want to create a generalized logging package, then create a directory called log containing <code>main.go</code>. But this would be an independent package so it wouldn't need to get variables from another or parent package. If you seem to need that var anyways, pass it as a configuration.</p>\n"}, {"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 2, "last_activity_date": 1460124431, "last_edit_date": 1460124431, "creation_date": 1444666340, "answer_id": 33085655, "question_id": 33084300, "link": "https://stackoverflow.com/questions/33084300/php-to-go-how-should-i-structure-my-projects/33085655#33085655", "title": "PHP to Go. How should I structure my projects?", "body": "<p>Please read the following material first:</p>\n\n<ul>\n<li><a href=\"https://golang.org/doc/code.html\" rel=\"nofollow\">How to write Go code</a>.</li>\n<li><a href=\"https://blog.golang.org/organizing-go-code\" rel=\"nofollow\">Organizing Go code</a>.</li>\n<li><a href=\"https://blog.golang.org/package-names\" rel=\"nofollow\">Package names</a>.</li>\n<li><a href=\"https://github.com/golang/go/wiki/GithubCodeLayout\" rel=\"nofollow\">Github Go code layout</a>.</li>\n</ul>\n\n<p>Then look at how, say, <a href=\"https://github.com/sourcegraph/thesrc\" rel=\"nofollow\"><code>thesrc</code></a> project is structured.</p>\n\n<p>Try out tutorials &mdash; just google for <code>golang+webapp+tutorials</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 4551372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d9df3fef60b231d31fe1146f8643fe?s=128&d=identicon&r=PG&f=1", "display_name": "Irv", "link": "https://stackoverflow.com/users/4551372/irv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1460124431, "creation_date": 1444662086, "question_id": 33084300, "link": "https://stackoverflow.com/questions/33084300/php-to-go-how-should-i-structure-my-projects", "title": "PHP to Go. How should I structure my projects?", "body": "<p>I'm learning Go with PHP being my best out of my pool (my pool is a kiddie pool: HTML, CSS, PHP, JavaScript, SQL). I've never actually gotten into the big scary ones like C, C++, etc. I thought Go would be a fair start.</p>\n\n<p>Let's say I have the structure:</p>\n\n<pre><code>|App\n|server.go\n----|Controllers\n-------|main.go\n</code></pre>\n\n<p>In PHP including one file means you have access to things on the parent file and all previous files that have been included.(depending on a couple of things, but for the most part).</p>\n\n<p>In Go, if I have this in server.go</p>\n\n<pre><code>package main\n\nimport (\n    \"REST/Controllers\"\n    \"fmt\"\n)\n\ntype test struct {\n    Number int\n}\n\nvar TestVar = test{}\n\nfunc main() {\n    controllers.Log()\n}\n</code></pre>\n\n<p>Is it possible to access TestVar in my Controller/main.go? I've tried but I can't seem to find how. The following code throws an undefined var error:</p>\n\n<p>main.go</p>\n\n<pre><code>package controllers\n\nimport (\n    \"fmt\"\n)\n\nfunc Log() {\n    fmt.Printf(\"%q\", TestVar)\n}\n</code></pre>\n\n<p>My only other idea is to pass it down through a function, but what if I want to actually change a value in TestVar? I'm not that far into the language, so I don't know much about pointers and all of that. And if I have 10 variables, wouldn't passing 10 variables to a function every time become too much of a hassle? </p>\n\n<p>Remember I'm from PHP, so pretty much all of the dirty stuff was sugarcoated for me. </p>\n\n<p>Thanks for the help.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 726, "user_id": 1855731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3cc8bd146f4ee3a422562049e6077a3?s=128&d=identicon&r=PG", "display_name": "Mujibur", "link": "https://stackoverflow.com/users/1855731/mujibur"}, "edited": false, "score": 0, "creation_date": 1444640486, "post_id": 33076502, "comment_id": 53971149, "body": "By theory, its not possible/not authorize to do that. In golang any function you want that should be under a package.   <code>Package builtin provides documentation for Go&#39;s predeclared identifiers. The items documented here are not actually in package builtin but their descriptions here allow godoc to present documentation for the language&#39;s special identifiers.</code> <a href=\"https://golang.org/pkg/builtin/\" rel=\"nofollow noreferrer\">golang.org/pkg/builtin</a> If you take a look at the content of <a href=\"http://golang.org/src/pkg/builtin/builtin.go\" rel=\"nofollow noreferrer\">golang.org/src/pkg/builtin/builtin.go</a> You will notice that there are only declarations"}, {"owner": {"reputation": 1582, "user_id": 3486065, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/EozB4.png?s=128&g=1", "display_name": "Taco de Wolff", "link": "https://stackoverflow.com/users/3486065/taco-de-wolff"}, "edited": false, "score": 1, "creation_date": 1444643719, "post_id": 33076502, "comment_id": 53973097, "body": "Why would you need this? Organizing code into packages and calling them through their package name is a nice way to clarify where the function is coming from and what it does."}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 6, "creation_date": 1444645956, "post_id": 33076502, "comment_id": 53974461, "body": "<code>append</code>, <code>make</code>, <code>new</code> and almost all &quot;functions&quot; in package <a href=\"https://golang.org/pkg/builtin/\" rel=\"nofollow noreferrer\"><code>builtin</code></a> are actually better thought of as macros. They are not real functions, they get re-written by the compiler and end up calling different code, depending on types, special cases and other stuff. This becomes obvious when you think about the fact that you can pass a type as an argument."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 1, "creation_date": 1444659891, "post_id": 33076502, "comment_id": 53983399, "body": "IMO the @thwd&#39;s comment should be treated as <i>the</i> answer. While those answered actually explained how one could use &quot;dot import&quot; to make a function appear to be global, real built-in function <i>behave</i> differently, and that&#39;s a crucial point not to be missed."}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 10, "last_activity_date": 1444642482, "creation_date": 1444642482, "answer_id": 33077779, "question_id": 33076502, "link": "https://stackoverflow.com/questions/33076502/writing-global-function-in-go-like-append/33077779#33077779", "title": "Writing Global Function in Go -- like append()", "body": "<p>It's not possible to do exactly what you want but you can get somewhat close to it by using a dot-import. E.g. if you dot-import the <code>fmt</code> package, you can spell <code>fmt.Println</code> as just <code>Println</code>:</p>\n\n<pre><code>package main\n\nimport . \"fmt\"\n\nfunc main() {\n    Println(\"Hello, playground\")\n}\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/--dWV6PHYA\">http://play.golang.org/p/--dWV6PHYA</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 3818, "user_id": 1247113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRMFj.png?s=128&g=1", "display_name": "rob74", "link": "https://stackoverflow.com/users/1247113/rob74"}, "is_accepted": false, "score": 3, "last_activity_date": 1444653565, "creation_date": 1444653565, "answer_id": 33081391, "question_id": 33076502, "link": "https://stackoverflow.com/questions/33076502/writing-global-function-in-go-like-append/33081391#33081391", "title": "Writing Global Function in Go -- like append()", "body": "<p>The short answer is: you can't. Go has builtin functions and types, but even the language designers try to keep their number to a minimum and avoid them if possible. For instance, there is a builtin <code>printf</code> function, but it is recommended to use <code>fmt.Printf</code> instead, as the builtin function \"is not guaranteed to stay in the language\".</p>\n\n<p>While having to prepend the package name every time you use a function may appear cumbersome, it has its obvious advantages (makes code easier to read, avoids name collisions) and isn't actually as bad as it sounds if the package designer followed the guidelines described under \"Naming package contents\" in <a href=\"https://blog.golang.org/package-names\" rel=\"nofollow\">this blog post</a>. </p>\n\n<p>Example: to create a <code>Regexp</code> object from a pattern string, you call <code>regexp.Compile()</code>, not <code>regexp.CompileRegexp()</code> - since you use the package name when calling a function, the name of the function can be shortened. This is of course lost if you use the \"dot import\" as per Ainar-G's suggestion. Then you would have just <code>Compile()</code>, which might be confusing (\"compile what?\").</p>\n"}], "owner": {"reputation": 2527, "user_id": 3476121, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1c621706e2e37eed4f82f074af9f706a?s=128&d=identicon&r=PG", "display_name": "sadlil", "link": "https://stackoverflow.com/users/3476121/sadlil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 720, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1444653565, "creation_date": 1444638547, "question_id": 33076502, "link": "https://stackoverflow.com/questions/33076502/writing-global-function-in-go-like-append", "title": "Writing Global Function in Go -- like append()", "body": "<p>The Question is simple - how can i implement a package independent global function in golang.</p>\n\n<p>ID, if i have a function in an package called core then from another package i need core.Function() to call that function. But i In go implementation there are some functions like - make(), append() for slice that can used without any import and within any package directly. If i wanted to write function like this what is the way of doing this? how can i write any function like this if it is possible. </p>\n"}, {"tags": ["go", "gob"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 2, "creation_date": 1444627336, "post_id": 33073434, "comment_id": 53965139, "body": "The enc.Encode(test) function returns an error, it&#39;s good practice to capture and check all possible errors"}, {"owner": {"reputation": 183, "user_id": 1855653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xd8XK.jpg?s=128&g=1", "display_name": "alienchow", "link": "https://stackoverflow.com/users/1855653/alienchow"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1444629228, "post_id": 33073434, "comment_id": 53965720, "body": "Thanks for the reminder. I do usually catch and handle errors, but in this case I&#39;m just trying to demonstrate a problem in encoding and decoding nested interfaces."}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 2, "creation_date": 1444631556, "post_id": 33073434, "comment_id": 53966624, "body": "Sorry, I mean that call is returning an error, and when running the code and capturing the error, it shows &quot;gob: type not registered for interface: main.B&quot;. Adding a gob.Register(B{}) before encoding prevents the EOF."}, {"owner": {"reputation": 183, "user_id": 1855653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xd8XK.jpg?s=128&g=1", "display_name": "alienchow", "link": "https://stackoverflow.com/users/1855653/alienchow"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1444632295, "post_id": 33073434, "comment_id": 53966912, "body": "I TOTALLY forgot about having to register! Thank you Mark! I&#39;ll take note to  check for the error.&quot;"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1444668150, "post_id": 33073434, "comment_id": 53988579, "body": "Questions and answers should include all the relevant code in them an not rely on a third party site (Go playground links are nice, but they should not be the only way to understand the question)."}], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 1855653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xd8XK.jpg?s=128&g=1", "display_name": "alienchow", "link": "https://stackoverflow.com/users/1855653/alienchow"}, "edited": false, "score": 0, "creation_date": 1444629090, "post_id": 33073738, "comment_id": 53965665, "body": "I&#39;m using interfaces to abstract the job queue so that I don&#39;t have to switch case assert to a specific struct type everytime. (There are many structs other than B implementing the testInterface)  Does this mean that I have no way to abstract a child field into an interface?"}, {"owner": {"reputation": 1615, "user_id": 1376205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ff8ba613f2dc50cc30e7f3af3e2914?s=128&d=identicon&r=PG", "display_name": "Will C", "link": "https://stackoverflow.com/users/1376205/will-c"}, "reply_to_user": {"reputation": 183, "user_id": 1855653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xd8XK.jpg?s=128&g=1", "display_name": "alienchow", "link": "https://stackoverflow.com/users/1855653/alienchow"}, "edited": false, "score": 0, "creation_date": 1444655047, "post_id": 33073738, "comment_id": 53980153, "body": "Great! Thats nice to know. I haven&#39;t personally used the <code>gob</code> package myself. I&#39;ve used other <code>encoding</code> packages so I assumed it was the same behavior."}], "tags": [], "owner": {"reputation": 1615, "user_id": 1376205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ff8ba613f2dc50cc30e7f3af3e2914?s=128&d=identicon&r=PG", "display_name": "Will C", "link": "https://stackoverflow.com/users/1376205/will-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1444627579, "last_edit_date": 1444627579, "creation_date": 1444627183, "answer_id": 33073738, "question_id": 33073434, "link": "https://stackoverflow.com/questions/33073434/gob-decoder-returning-eof-error/33073738#33073738", "title": "Gob Decoder Returning EOF Error", "body": "<p>In your Go Playground example, you're trying to encode an interface and interfaces don't have a concrete implementation. If you remove the interface from your <code>A</code> struct, that should work. Like the following:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"encoding/gob\"\nimport \"bytes\"\n\ntype testInterface interface{}\n\ntype A struct {\n  Name string\n  Interface *B // note this change here\n}\n\ntype B struct {\n  Value string\n}\n\nfunc main() {\n  var err error\n  test := &amp;A {\n    Name: \"wut\",\n    Interface: &amp;B{Value: \"BVALUE\"},\n  }\n  buf := bytes.NewBuffer([]byte{})\n  enc := gob.NewEncoder(buf)\n  dec := gob.NewDecoder(buf)\n\n  // added error checking as per Mark's comment\n  err = enc.Encode(test)\n  if err != nil {\n    panic(err.Error())\n  }\n\n  result := &amp;A{}\n  err := dec.Decode(result)\n  fmt.Printf(\"%+v\\n\", result)\n  fmt.Println(\"Error is:\", err)\n  fmt.Println(\"Hello, playground\")\n}\n</code></pre>\n\n<p>Also, just as a side note you will see some sort of output like the following: <code>&amp;{Name:wut Interface:0x1040a5a0}</code> because <code>A</code> is referencing a reference to a <code>B</code> struct. To clean that up further:</p>\n\n<pre><code>type A struct{\n  Name string\n  Interface B // no longer a pointer\n}\n\nfunc main() {\n   // ...\n   test := &amp;A{Name: \"wut\", Interface: B{Value: \"BVALUE\"}}\n   // ...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 183, "user_id": 1855653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xd8XK.jpg?s=128&g=1", "display_name": "alienchow", "link": "https://stackoverflow.com/users/1855653/alienchow"}, "is_accepted": false, "score": 0, "last_activity_date": 1444632436, "creation_date": 1444632436, "answer_id": 33074813, "question_id": 33073434, "link": "https://stackoverflow.com/questions/33073434/gob-decoder-returning-eof-error/33074813#33074813", "title": "Gob Decoder Returning EOF Error", "body": "<p>Found the answer to the problem from Mark above. I have forgotten to do a <code>gob.Register(B{})</code></p>\n\n<p><a href=\"https://play.golang.org/p/7rQDHvMhD7\" rel=\"nofollow\">https://play.golang.org/p/7rQDHvMhD7</a></p>\n"}], "owner": {"reputation": 183, "user_id": 1855653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xd8XK.jpg?s=128&g=1", "display_name": "alienchow", "link": "https://stackoverflow.com/users/1855653/alienchow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3741, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1444632436, "creation_date": 1444625125, "question_id": 33073434, "link": "https://stackoverflow.com/questions/33073434/gob-decoder-returning-eof-error", "title": "Gob Decoder Returning EOF Error", "body": "<p>I am attempting to implement an interface based message queue where jobs are pushed as bytes to a redis queue. But I keep receiving an EOF error when attempting to decode the byte stream.</p>\n\n<p><a href=\"https://play.golang.org/p/l9TBvcn9qg\" rel=\"nofollow\">https://play.golang.org/p/l9TBvcn9qg</a></p>\n\n<p>Could someone point me in the right direction?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["mysql", "go", "jwt-go"], "comments": [{"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 1, "creation_date": 1444620806, "post_id": 33072861, "comment_id": 53963500, "body": "Well, where do you define the type <code>Partage</code>?"}, {"owner": {"reputation": 1350, "user_id": 3200803, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/1325785612/picture?type=large", "display_name": "asubanovsky", "link": "https://stackoverflow.com/users/3200803/asubanovsky"}, "reply_to_user": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 0, "creation_date": 1444620838, "post_id": 33072861, "comment_id": 53963510, "body": "How to define the type of Partage?"}], "answers": [{"comments": [{"owner": {"reputation": 1350, "user_id": 3200803, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/1325785612/picture?type=large", "display_name": "asubanovsky", "link": "https://stackoverflow.com/users/3200803/asubanovsky"}, "edited": false, "score": 0, "creation_date": 1444621515, "post_id": 33072914, "comment_id": 53963665, "body": "Thanks for the answer, Mas Noval (I&#39;m from Indonesia too). But how do I display the result as JSON response? I&#39;ve tried r.JSON(200, partages) but the results aren&#39;t displayed."}, {"owner": {"reputation": 1350, "user_id": 3200803, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/1325785612/picture?type=large", "display_name": "asubanovsky", "link": "https://stackoverflow.com/users/3200803/asubanovsky"}, "edited": false, "score": 0, "creation_date": 1444623409, "post_id": 33072914, "comment_id": 53964064, "body": "Well implemented. Thank you very much. You save my day."}], "tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": true, "score": 2, "last_activity_date": 1492673172, "last_edit_date": 1492673172, "creation_date": 1444621119, "answer_id": 33072914, "question_id": 33072861, "link": "https://stackoverflow.com/questions/33072861/golang-retrieve-multiple-results-from-mysql-then-display-them-as-json/33072914#33072914", "title": "Golang - retrieve multiple results from MySQL, then display them as JSON", "body": "<p>The error showing up because you use struct <code>Partage</code> to create an object, but you haven't declared it.</p>\n\n<pre><code>type Partage struct {\n    user_id string\n    nama string\n}\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>But how do I display the result as JSON response? I've tried r.JSON(200, partages) but the results aren't displayed</p>\n</blockquote>\n\n<p>In <strong>martini</strong> you can use <code>r.JSON()</code> to print <code>rows</code> as JSON</p>\n\n<pre><code>m.Get(\"/users\", func(params martini.Params, r render.Render) {\n    // ... \n\n    r.JSON(200, map[string]interface{}{\n        data: rows\n    })\n})\n</code></pre>\n"}], "owner": {"reputation": 1350, "user_id": 3200803, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/1325785612/picture?type=large", "display_name": "asubanovsky", "link": "https://stackoverflow.com/users/3200803/asubanovsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1010, "favorite_count": 0, "accepted_answer_id": 33072914, "answer_count": 1, "score": -1, "last_activity_date": 1588099214, "creation_date": 1444620698, "last_edit_date": 1588099214, "question_id": 33072861, "link": "https://stackoverflow.com/questions/33072861/golang-retrieve-multiple-results-from-mysql-then-display-them-as-json", "title": "Golang - retrieve multiple results from MySQL, then display them as JSON", "body": "<p>Recently, I'm learning about Go (Golang). I'm trying to make a simple web service using Martini and jwt-go. I didn't find any difficulty in retrieving a single row data and put in JSON as the response. But, when dealing with multiple-rows, it's a whole different story. Basically, I refer to the accepted answer <a href=\"https://stackoverflow.com/questions/11353679/whats-the-recommended-way-to-connect-to-mysql-from-go\">here.</a></p>\n\n<p>Here is the piece of my code: </p>\n\n<pre><code>m.Get(\"/users\", func(params martini.Params, r render.Render) {\n    db, err := sql.Open(\"mysql\", \"root:@/sirat_v2\")\n    if err != nil {\n        panic(err.Error())\n    }\n    defer db.Close()\n\n    rows, err := db.Query(\"SELECT user_id, nama FROM `users` WHERE password = ?\", \"asdfasdf\")\n    defer rows.Close()\n\n    cols, err := rows.Columns()\n    if err != nil {\n        panic(err.Error())\n    }\n\n    partages := make([]*Partage, 0, 10)\n    var user_id int\n    var nama string\n    for rows.Next() {\n        err = rows.Scan(&amp;user_id, &amp;nama)\n        if err != nil { /* error handling */\n        }\n        partages = append(partages, &amp;Partage{user_id, nama})\n    }\n})\n</code></pre>\n\n<p>When trying to build, there's an error said that Partage is undefined. </p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1444625279, "creation_date": 1444625279, "answer_id": 33073462, "question_id": 33072737, "link": "https://stackoverflow.com/questions/33072737/using-redirects-in-gae/33073462#33073462", "title": "Using Redirects in GAE", "body": "<p>Your clients are probably caching the 301 response <a href=\"https://tools.ietf.org/html/rfc2616#section-10.3.2\" rel=\"nofollow\">as allowed by RFC 2616</a>.</p>\n\n<p>Change the response status code to 302, <a href=\"https://godoc.org/net/http#StatusFound\" rel=\"nofollow\">http.StatusFound</a>.</p>\n"}], "owner": {"reputation": 11, "user_id": 4547184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f869fc3090c1a8fe6de24fca51b8bea5?s=128&d=identicon&r=PG&f=1", "display_name": "Colin Adler", "link": "https://stackoverflow.com/users/4547184/colin-adler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 33073462, "answer_count": 1, "score": 0, "last_activity_date": 1444625279, "creation_date": 1444619725, "question_id": 33072737, "link": "https://stackoverflow.com/questions/33072737/using-redirects-in-gae", "title": "Using Redirects in GAE", "body": "<p>I am fairly new to Go, and I am trying to make a few apps for GAE. I couldn't find anyone with the same problem as me so I thought I would ask here!  </p>\n\n<p>Basically, I am creating a program that will take a random url from an array and redirect the user.  </p>\n\n<p>The problem that arises is that on every computer I try it on, it will send a different video, but it will always send the same video to that person.</p>\n\n<p>If anyone has any insight into this it would be greatly appreciated!</p>\n\n<pre><code>    package randvid\n\n    import (\n        \"net/http\"\n        \"math/rand\"\n        \"time\"\n    )\n\n    func RandLink() string{\n      VideoList := []string{\n        ...\n      }\n      r := rand.New(rand.NewSource(time.Now().UTC().UnixNano()))\n      vid := r.Intn(len(VideoList)) + 1;\n      return VideoList[vid]\n    }\n\n    func redirectHandler(path string) func(http.ResponseWriter, *http.Request) {\n      return func (w http.ResponseWriter, r *http.Request) {\n        http.Redirect(w, r, path, http.StatusMovedPermanently)\n      }\n    }\n\n    func init() {\n      http.HandleFunc(\"/\", redirectHandler(RandLink()))\n    }\n</code></pre>\n"}, {"tags": ["sql", "json", "go"], "comments": [{"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 1, "creation_date": 1444617328, "post_id": 33072172, "comment_id": 53962766, "body": "You should explain what you mean by &quot;not how it used to be when I used regular int64 and string&quot; in your question."}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 4, "creation_date": 1444670197, "post_id": 33072172, "comment_id": 53989699, "body": "you have tried using pointers to ints, yes?  ie: var anint *int, then using &amp;anint  if its null the pointer will be nil.  works fine with JSON encoding.  this works with gorp for sure, haven&#39;t tested with straight sql package though"}], "answers": [{"comments": [{"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "edited": false, "score": 5, "creation_date": 1444620598, "post_id": 33072822, "comment_id": 53963461, "body": "What a great solution! Thank you!"}, {"owner": {"reputation": 3668, "user_id": 392653, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/xD3HW.jpg?s=128&g=1", "display_name": "NSTJ", "link": "https://stackoverflow.com/users/392653/nstj"}, "edited": false, "score": 2, "creation_date": 1487259326, "post_id": 33072822, "comment_id": 71712756, "body": "Maybe it&#39;s redundant to say, but so fantastic to have Golang Playgrounds to demonstrate stuff like this - really makes a huge difference for language adoption.  Thanks for a great answer."}, {"owner": {"reputation": 65, "user_id": 6662969, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3koge.jpg?s=128&g=1", "display_name": "Nguyen DN", "link": "https://stackoverflow.com/users/6662969/nguyen-dn"}, "edited": false, "score": 0, "creation_date": 1615162242, "post_id": 33072822, "comment_id": 117599126, "body": "Thanks mate! This is exactly what I&#39;m looking for"}], "tags": [], "owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "is_accepted": true, "score": 65, "last_activity_date": 1444620433, "creation_date": 1444620433, "answer_id": 33072822, "question_id": 33072172, "link": "https://stackoverflow.com/questions/33072172/how-can-i-work-with-sql-null-values-and-json-in-a-good-way/33072822#33072822", "title": "How can I work with SQL NULL values and JSON in a good way?", "body": "<p>Types like <code>sql.NullInt64</code> do not implement any special handling for JSON marshaling or unmarshaling, so the default rules apply.  Since the type is a struct, it gets marshalled as an object with its fields as attributes.</p>\n\n<p>One way to work around this is to create your own type that implements the <code>json.Marshaller</code> / <code>json.Unmarshaler</code> interfaces.  By embedding the <code>sql.NullInt64</code> type, we get the SQL methods for free.  Something like this:</p>\n\n<pre><code>type JsonNullInt64 struct {\n    sql.NullInt64\n}\n\nfunc (v JsonNullInt64) MarshalJSON() ([]byte, error) {\n    if v.Valid {\n        return json.Marshal(v.Int64)\n    } else {\n        return json.Marshal(nil)\n    }\n}\n\nfunc (v *JsonNullInt64) UnmarshalJSON(data []byte) error {\n    // Unmarshalling into a pointer will let us detect null\n    var x *int64\n    if err := json.Unmarshal(data, &amp;x); err != nil {\n        return err\n    }\n    if x != nil {\n        v.Valid = true\n        v.Int64 = *x\n    } else {\n        v.Valid = false\n    }\n    return nil\n}\n</code></pre>\n\n<p>If you use this type in place of <code>sql.NullInt64</code>, it should be encoded as you expect.</p>\n\n<p>You can test this example here: <a href=\"http://play.golang.org/p/zFESxLcd-c\">http://play.golang.org/p/zFESxLcd-c</a></p>\n"}, {"comments": [{"owner": {"reputation": 1152, "user_id": 1603399, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/95QCa.jpg?s=128&g=1", "display_name": "dimiguel", "link": "https://stackoverflow.com/users/1603399/dimiguel"}, "edited": false, "score": 7, "creation_date": 1554018940, "post_id": 50807801, "comment_id": 97594653, "body": "This is a massive time-saver. I thought I was going to have to write all of the marshaling code but this package works perfectly."}], "tags": [], "owner": {"reputation": 1017, "user_id": 896958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43efcebc2dc9a61cd389ff8107240107?s=128&d=identicon&r=PG", "display_name": "Stephen Wood", "link": "https://stackoverflow.com/users/896958/stephen-wood"}, "is_accepted": false, "score": 29, "last_activity_date": 1528763988, "creation_date": 1528763988, "answer_id": 50807801, "question_id": 33072172, "link": "https://stackoverflow.com/questions/33072172/how-can-i-work-with-sql-null-values-and-json-in-a-good-way/50807801#50807801", "title": "How can I work with SQL NULL values and JSON in a good way?", "body": "<p>If you use the <a href=\"https://gopkg.in/guregu/null.v3\" rel=\"noreferrer\">null.v3</a> package, you won't need to implement any of the marshal or unmarshal methods. It's a superset of the sql.Null structs and is probably what you want.</p>\n\n<pre><code>package main\n\nimport \"gopkg.in/guregu/null.v3\"\n\ntype Person struct {\n    Name     string      `json:\"id\"`\n    Age      int         `json:\"age\"`\n    NickName null.String `json:\"nickname\"` // Optional\n}\n</code></pre>\n\n<p>If you'd like to see a full Golang webserver that uses sqlite, nulls, and json you can consult <a href=\"https://gist.github.com/stephen-mw/f55cb15f1d097f0fc3a81221a5835804\" rel=\"noreferrer\">this gist</a>.</p>\n"}], "owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17359, "favorite_count": 10, "accepted_answer_id": 33072822, "answer_count": 2, "score": 45, "last_activity_date": 1582120869, "creation_date": 1444615145, "last_edit_date": 1582120869, "question_id": 33072172, "link": "https://stackoverflow.com/questions/33072172/how-can-i-work-with-sql-null-values-and-json-in-a-good-way", "title": "How can I work with SQL NULL values and JSON in a good way?", "body": "<p>Go types like <code>Int64</code> and <code>String</code> cannot store null values,\nso I found I could use <a href=\"https://golang.org/pkg/database/sql/#NullInt64\" rel=\"noreferrer\">sql.NullInt64</a> and <a href=\"https://golang.org/pkg/database/sql/#NullString\" rel=\"noreferrer\">sql.NullString</a> for this.</p>\n\n<p>But when I use these in a Struct,\nand generate JSON from the Struct with the <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"noreferrer\">json</a> package,\nthen the format is different to when I use regular <code>Int64</code> and <code>String</code> types.</p>\n\n<p>The JSON has an additional level because the sql.Null*** is also a Struct.</p>\n\n<p>Is there a good workaround for this,\nor should I not use NULLs in my SQL database?</p>\n"}, {"tags": ["unit-testing", "go", "closures"], "comments": [{"owner": {"reputation": 1615, "user_id": 1376205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ff8ba613f2dc50cc30e7f3af3e2914?s=128&d=identicon&r=PG", "display_name": "Will C", "link": "https://stackoverflow.com/users/1376205/will-c"}, "edited": false, "score": 0, "creation_date": 1444625847, "post_id": 33071854, "comment_id": 53964672, "body": "Just curious but why do you want to hide the server. It seems pretty reasonable that the server is returned since it is expected to be used for the test eg. server is created and server is closed by the test (instead of in its callback)."}], "answers": [{"comments": [{"owner": {"reputation": 1615, "user_id": 1376205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ff8ba613f2dc50cc30e7f3af3e2914?s=128&d=identicon&r=PG", "display_name": "Will C", "link": "https://stackoverflow.com/users/1376205/will-c"}, "edited": false, "score": 0, "creation_date": 1444625658, "post_id": 33072008, "comment_id": 53964625, "body": "The other alternative I&#39;d like to point out is that the server could be avoid  altogether. The handler could be invokved on a <code>httptest.ResponseRecorder</code> and the <code>http.Request</code>. Using the <code>ResponseRecorder</code>, you can check the <code>.Code</code> and see that it should have been updated to <code>http.StatusUnauthorized</code> since the code under the test isn&#39;t doing much. The only difference is that this is a unit test vs being an integration test."}], "tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": true, "score": 4, "last_activity_date": 1444613770, "creation_date": 1444613770, "answer_id": 33072008, "question_id": 33071854, "link": "https://stackoverflow.com/questions/33071854/go-closure-deadlock/33072008#33072008", "title": "Go closure deadlock", "body": "<p>The program doesn't terminate because of a deadlock (and it has nothing to do with closures). You cannot call <code>Close</code> inside a handler because internally <code>Close</code> waits for all handlers to finish.</p>\n\n<p>The easiest way to fix it is to \"leak\" httptest.Server outside of oneOffUrlWithResponseCode:</p>\n\n<pre><code>func TestAuthorization(t *testing.T) {\n    ...\n    server := oneOffUrlWithResponseCode(http.StatusUnauthorized)\n    defer server.Close()\n    request, _ := http.NewRequest(\"GET\", server.URL, nil)\n    ...\n}\n\nfunc oneOffUrlWithResponseCode(responseCode int) *httptest.Server {\n    return httptest.NewServer(http.HandlerFunc(func(response http.ResponseWriter, request *http.Request) {\n        response.WriteHeader(responseCode)\n    }))\n}\n</code></pre>\n"}], "owner": {"reputation": 184, "user_id": 939775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c803490200156738cbaca2591fb9597?s=128&d=identicon&r=PG", "display_name": "Sergei M", "link": "https://stackoverflow.com/users/939775/sergei-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 33072008, "answer_count": 1, "score": -2, "last_activity_date": 1444614300, "creation_date": 1444612242, "last_edit_date": 1444614300, "question_id": 33071854, "link": "https://stackoverflow.com/questions/33071854/go-closure-deadlock", "title": "Go closure deadlock", "body": "<p>Trying to mock http response in Go test. The code snippet below never terminates if I run it with </p>\n\n<blockquote>\n  <p>go test example.com/auth/...</p>\n</blockquote>\n\n<pre><code>package auth_test\nimport (\n    \"testing\"\n    \"net/http/httptest\"\n    \"net/http\"\n)\n\nfunc TestAuthorization(t *testing.T) {\n    t.Log(\"Should return 401 when Gateway returns 401\")\n    {\n        url := oneOffUrlWithResponseCode(http.StatusUnauthorized)\n        request, _ := http.NewRequest(\"GET\", url, nil)\n        response, _ := http.DefaultClient.Do(request)\n\n        if response.StatusCode != http.StatusUnauthorized {\n            t.Fatalf(\"Response should be 401 (Unauthorized)\")\n        }\n    }\n}\n\nfunc oneOffUrlWithResponseCode(responseCode int) string {\n    var server *httptest.Server\n    server = httptest.NewServer(http.HandlerFunc(func(response http.ResponseWriter, request *http.Request) {\n        defer server.Close()\n        response.WriteHeader(responseCode)\n    }))\n    return server.URL\n}\n</code></pre>\n\n<p>However, if I comment out this line </p>\n\n<blockquote>\n  <p>defer server.Close()</p>\n</blockquote>\n\n<p>everything works fine. </p>\n\n<p>Ideally, I do not want to \"leak\" *httptest.Server outside of oneOffUrlWithResponseCode function and obviously close it after first request. </p>\n\n<p>Why it never terminates? What am I doing wrong? What is the right thing to do?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "edited": false, "score": 0, "creation_date": 1444613849, "post_id": 33071486, "comment_id": 53962041, "body": "I have no clue what you are talking about?! What webserver? Where does the JSON come from? You always can Marshall/Unmarshall JSON to/from a struct."}, {"owner": {"reputation": 101, "user_id": 6572240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5b71f81964e0a620edfc840451af9bd?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Kramme", "link": "https://stackoverflow.com/users/6572240/paul-kramme"}, "reply_to_user": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "edited": false, "score": 0, "creation_date": 1496837484, "post_id": 33071486, "comment_id": 75823417, "body": "@0x434D53 Completely irrelevant."}], "answers": [{"tags": [], "owner": {"reputation": 1615, "user_id": 1376205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ff8ba613f2dc50cc30e7f3af3e2914?s=128&d=identicon&r=PG", "display_name": "Will C", "link": "https://stackoverflow.com/users/1376205/will-c"}, "is_accepted": true, "score": 2, "last_activity_date": 1444688211, "last_edit_date": 1444688211, "creation_date": 1444609365, "answer_id": 33071567, "question_id": 33071486, "link": "https://stackoverflow.com/questions/33071486/golang-structs-or-maps-in-restful-api/33071567#33071567", "title": "golang structs or maps in RESTFUL API", "body": "<p>I think this discussion could go either way but the advantages of using structs vs maps are that structs give you an idea of how the schema should look like whereas a map leaves the schema open-ended.</p>\n\n<p>If you use structs, developers who look at the code will have a clear idea of what parameters you're expecting for the API or how the response of the API may look like without digging further into implementation detail. On the other hand if the requests or responses were maps, they would have to look at the implementation detail to see what keys and values are being assigned. Hope this helps!</p>\n"}], "owner": {"reputation": 707, "user_id": 5428494, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5075ba00acc4f6068e8923f60f514eca?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/5428494/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "closed_date": 1444622904, "accepted_answer_id": 33071567, "answer_count": 1, "score": -1, "last_activity_date": 1444688211, "creation_date": 1444608397, "question_id": 33071486, "link": "https://stackoverflow.com/questions/33071486/golang-structs-or-maps-in-restful-api", "closed_reason": "Needs details or clarity", "title": "golang structs or maps in RESTFUL API", "body": "<p>When creating a webserver in golang, is there any specific reason why JSON data would be represented as a MAP over a STRUCT or vice versa? ..or is this decision based purely on user preference ?</p>\n"}, {"tags": ["unit-testing", "testing", "go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1444589443, "post_id": 33068684, "comment_id": 53955811, "body": "For the first part, read the <a href=\"https://godoc.org/github.com/codegangsta/cli#ex-App\" rel=\"nofollow noreferrer\">documentation</a>. <code>cli.App</code> provides a <code>Writer</code> field that you can set to any <code>io.Writer</code> you&#39;d like (e.g. a <code>bytes.Buffer</code>)."}, {"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1444589765, "post_id": 33068684, "comment_id": 53955903, "body": "Thanks! Apologies I did look to see if one could be passed into Run but I should have looked at the App type."}], "owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1448309487, "creation_date": 1444588753, "last_edit_date": 1448309487, "question_id": 33068684, "link": "https://stackoverflow.com/questions/33068684/with-gos-testing-package-is-it-possible-to-test-whats-printed-to-os-stdout-if", "title": "With Go&#39;s testing package is it possible to test what&#39;s printed to os.Stdout if part of the output is nondeterministic?", "body": "<p>I'm making a golang cli app using the github.com/codegangsta/cli package</p>\n\n<p>I'm trying to test my app by calling app.Run(args) with invalid arguments. When running go test the output of the invalid arguments test is almost all deterministic except the USAGE section refers to go-build435629639 as part of the name of the executable (i.e. os.Args[0]) which is different each time.</p>\n\n<p>Can I direct the output from app.Run into another io.writer without changing the cli package?</p>\n\n<p>Can Examples with output specified be forced to skip over certain lines (or to only check the first line of output)?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 0, "creation_date": 1444589447, "post_id": 33068644, "comment_id": 53955812, "body": "Show us the code you have already written, explain what problems you are having, and why you think it might be hard."}, {"owner": {"reputation": 81, "user_id": 5434107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c64de875b4bf1ab2ea43873ba75718d?s=128&d=identicon&r=PG&f=1", "display_name": "ROAM", "link": "https://stackoverflow.com/users/5434107/roam"}, "reply_to_user": {"reputation": 74488, "user_id": 797495, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/BKD7l.jpg?s=128&g=1", "display_name": "Pedro Lobito", "link": "https://stackoverflow.com/users/797495/pedro-lobito"}, "edited": false, "score": 0, "creation_date": 1444590285, "post_id": 33068644, "comment_id": 53956073, "body": "I&#39;m trying to read each record, and put it in a mysql database @PedroLobito"}, {"owner": {"reputation": 81, "user_id": 5434107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c64de875b4bf1ab2ea43873ba75718d?s=128&d=identicon&r=PG&f=1", "display_name": "ROAM", "link": "https://stackoverflow.com/users/5434107/roam"}, "reply_to_user": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 0, "creation_date": 1444591281, "post_id": 33068644, "comment_id": 53956416, "body": "Added some code @gbulmer"}, {"owner": {"reputation": 2912, "user_id": 3081206, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YaKOY.jpg?s=128&g=1", "display_name": "takendarkk", "link": "https://stackoverflow.com/users/3081206/takendarkk"}, "edited": false, "score": 0, "creation_date": 1444592133, "post_id": 33068644, "comment_id": 53956701, "body": "Now, what&#39;s the problem? Errors? Wrong output?"}, {"owner": {"reputation": 81, "user_id": 5434107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c64de875b4bf1ab2ea43873ba75718d?s=128&d=identicon&r=PG&f=1", "display_name": "ROAM", "link": "https://stackoverflow.com/users/5434107/roam"}, "edited": false, "score": 0, "creation_date": 1444592375, "post_id": 33068644, "comment_id": 53956767, "body": "My questions : 1. How can I handle the last line from the log file?  2. There is a more optimized/elegant way to achieve the same goal?"}, {"owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "edited": false, "score": 0, "creation_date": 1444595256, "post_id": 33068644, "comment_id": 53957674, "body": "You could have asked this question in a more general sense by asking how a scanner can be implemented with a custom split. It would apply to more people who are interested in a permutation of this problem. Consider editing your question to make it general and use your particular instance as an example."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 5434107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c64de875b4bf1ab2ea43873ba75718d?s=128&d=identicon&r=PG&f=1", "display_name": "ROAM", "link": "https://stackoverflow.com/users/5434107/roam"}, "edited": false, "score": 0, "creation_date": 1444596309, "post_id": 33069759, "comment_id": 53958007, "body": "Thanks @benjic. Elegant solution that works as expected :)"}, {"owner": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "edited": false, "score": 0, "creation_date": 1564796272, "post_id": 33069759, "comment_id": 101159296, "body": "This will be problematic when the input data contains multiple newlines before <code>#</code>s."}], "tags": [], "owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "is_accepted": true, "score": 14, "last_activity_date": 1444595002, "creation_date": 1444595002, "answer_id": 33069759, "question_id": 33068644, "link": "https://stackoverflow.com/questions/33068644/how-a-scanner-can-be-implemented-with-a-custom-split/33069759#33069759", "title": "How a scanner can be implemented with a custom split", "body": "<p>The <a href=\"https://golang.org/pkg/bufio/#Scanner\" rel=\"noreferrer\"><code>Scanner</code></a> type has a function called <a href=\"https://golang.org/pkg/bufio/#Scanner.Split\" rel=\"noreferrer\">Split</a> which allows you to pass a <a href=\"https://golang.org/pkg/bufio/#SplitFunc\" rel=\"noreferrer\"><code>SplitFunc</code></a> to determine how the scanner will split the given byte slice. The default <a href=\"https://golang.org/pkg/bufio/#SplitFunc\" rel=\"noreferrer\"><code>SplitFunc</code></a> is the <a href=\"https://golang.org/pkg/bufio/#ScanLines\" rel=\"noreferrer\"><code>ScanLines</code></a> which you can see the <a href=\"https://golang.org/src/bufio/scan.go?s=9745:9823#L280\" rel=\"noreferrer\">implementation source</a>. From this point you can write your own <a href=\"https://golang.org/pkg/bufio/#SplitFunc\" rel=\"noreferrer\"><code>SplitFunc</code></a> to break the <code>bufio.Reader</code> content based on your specific format.</p>\n\n<pre><code>func crunchSplitFunc(data []byte, atEOF bool) (advance int, token []byte, err error) {\n\n    // Return nothing if at end of file and no data passed\n    if atEOF &amp;&amp; len(data) == 0 {\n        return 0, nil, nil\n    }\n\n    // Find the index of the input of a newline followed by a \n    // pound sign.\n    if i := strings.Index(string(data), \"\\n#\"); i &gt;= 0 {\n        return i + 1, data[0:i], nil\n    }\n\n    // If at end of file with data return the data\n    if atEOF {\n        return len(data), data, nil\n    }\n\n    return\n}\n</code></pre>\n\n<p>You can see the full implementation of the example at <a href=\"https://play.golang.org/p/ecCYkTzme4\" rel=\"noreferrer\">https://play.golang.org/p/ecCYkTzme4</a>. The documentaiton is going to provide all the insight needed to implement something like this. </p>\n"}, {"tags": [], "owner": {"reputation": 331, "user_id": 6672339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V3iXK.jpg?s=128&g=1", "display_name": "stu-b-doo", "link": "https://stackoverflow.com/users/6672339/stu-b-doo"}, "is_accepted": false, "score": 2, "last_activity_date": 1530487149, "creation_date": 1530487149, "answer_id": 51127669, "question_id": 33068644, "link": "https://stackoverflow.com/questions/33068644/how-a-scanner-can-be-implemented-with-a-custom-split/51127669#51127669", "title": "How a scanner can be implemented with a custom split", "body": "<p><a href=\"https://stackoverflow.com/a/33069759/6672339\">Ben Campbell's answer</a> wrapped into a func that returns a splitfunc for a substring:</p>\n\n<p><a href=\"https://play.golang.org/p/FY-TfF_sVcB\" rel=\"nofollow noreferrer\">demo on play.golang.org</a></p>\n\n<p>Improvement suggestions welcome</p>\n\n<pre><code>// SplitAt returns a bufio.SplitFunc closure, splitting at a substring\n// scanner.Split(SplitAt(\"\\n# \"))\nfunc SplitAt(substring string) func(data []byte, atEOF bool) (advance int, token []byte, err error) {\n\n    return func(data []byte, atEOF bool) (advance int, token []byte, err error) {\n\n        // Return nothing if at end of file and no data passed\n        if atEOF &amp;&amp; len(data) == 0 {\n            return 0, nil, nil\n        }\n\n        // Find the index of the input of the separator substring\n        if i := strings.Index(string(data), substring); i &gt;= 0 {\n            return i + len(substring), data[0:i], nil\n        }\n\n        // If at end of file with data return the data\n        if atEOF {\n            return len(data), data, nil\n        }\n\n        return\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 11844755, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xVijPAZRTNk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re-e1dzoicyew412aHycESSnZ89yw/photo.jpg?sz=128", "display_name": "afedorenchik", "link": "https://stackoverflow.com/users/11844755/afedorenchik"}, "is_accepted": false, "score": 5, "last_activity_date": 1564242014, "last_edit_date": 1564242014, "creation_date": 1564234871, "answer_id": 57232670, "question_id": 33068644, "link": "https://stackoverflow.com/questions/33068644/how-a-scanner-can-be-implemented-with-a-custom-split/57232670#57232670", "title": "How a scanner can be implemented with a custom split", "body": "<p>Slightly optimized solution of <a href=\"https://stackoverflow.com/a/33069759/11844755\">Ben Campbell</a> and <a href=\"https://stackoverflow.com/a/51127669/11844755\">sto-b-doo</a></p>\n\n<p>Conversion of byte slice to string appears to be quite heavy operation.</p>\n\n<p>In my app for log processing it became a bottleneck.</p>\n\n<p>Just keeping data in bytes gives <strong>~1500%</strong> performance boost to my app.</p>\n\n<pre><code>func SplitAt(substring string) func(data []byte, atEOF bool) (advance int, token []byte, err error) {\n    searchBytes := []byte(substring)\n    searchLen := len(searchBytes)\n    return func(data []byte, atEOF bool) (advance int, token []byte, err error) {\n        dataLen := len(data)\n\n        // Return nothing if at end of file and no data passed\n        if atEOF &amp;&amp; dataLen == 0 {\n            return 0, nil, nil\n        }\n\n        // Find next separator and return token\n        if i := bytes.Index(data, searchBytes); i &gt;= 0 {\n            return i + searchLen, data[0:i], nil\n        }\n\n        // If we're at EOF, we have a final, non-terminated line. Return it.\n        if atEOF {\n            return dataLen, data, nil\n        }\n\n        // Request more data.\n        return 0, nil, nil\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 5434107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c64de875b4bf1ab2ea43873ba75718d?s=128&d=identicon&r=PG&f=1", "display_name": "ROAM", "link": "https://stackoverflow.com/users/5434107/roam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5618, "favorite_count": 5, "accepted_answer_id": 33069759, "answer_count": 3, "score": 2, "last_activity_date": 1564242014, "creation_date": 1444588483, "last_edit_date": 1444596257, "question_id": 33068644, "link": "https://stackoverflow.com/questions/33068644/how-a-scanner-can-be-implemented-with-a-custom-split", "title": "How a scanner can be implemented with a custom split", "body": "<p>I have a log file, and I need to parse each record in it using golang.\nEach record begin with \"#\", and a record can span one or more lines :</p>\n\n<pre><code># Line1\n# Line2\nContinued line2\nContinued line2\n# line3\n.....\n</code></pre>\n\n<p>Some code :), I'm a beginner </p>\n\n<pre><code>   f, _ := os.Open(mylog)\n    scanner := bufio.NewScanner(f)\n    var queryRec string\n\n    for scanner.Scan() {\n            line := scanner.Text()\n\n            if strings.HasPrefix(line, \"# \") &amp;&amp; len(queryRec) == 0 {\n                    queryRec = line\n            } else if !strings.HasPrefix(line, \"# \") &amp;&amp; len(queryRec) == 0 {\n                    fmt.Println(\"There is a big problem!!!\")\n            } else if !strings.HasPrefix(line, \"# \") &amp;&amp; len(queryRec) != 0 {\n                    queryRec += line\n            } else if strings.HasPrefix(line, \"# \") &amp;&amp; len(queryRec) != 0 {\n                    queryRec = line\n            }\n    }\n</code></pre>\n\n<p>Thanks,</p>\n"}, {"tags": ["go", "couchbase"], "answers": [{"comments": [{"owner": {"reputation": 5639, "user_id": 1277048, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/tGJVH.jpg?s=128&g=1", "display_name": "FuzzyAmi", "link": "https://stackoverflow.com/users/1277048/fuzzyami"}, "edited": false, "score": 0, "creation_date": 1444715102, "post_id": 33085034, "comment_id": 54005682, "body": "Apologies: but this does not compile. Specifically: you can&#39;t access Value in g: the instance g is of type gocb.BulkOp which does not have that field."}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "reply_to_user": {"reputation": 5639, "user_id": 1277048, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/tGJVH.jpg?s=128&g=1", "display_name": "FuzzyAmi", "link": "https://stackoverflow.com/users/1277048/fuzzyami"}, "edited": false, "score": 0, "creation_date": 1444717173, "post_id": 33085034, "comment_id": 54006604, "body": "Welp, sorry. Forgot the type-assertion there. Edited."}, {"owner": {"reputation": 5639, "user_id": 1277048, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/tGJVH.jpg?s=128&g=1", "display_name": "FuzzyAmi", "link": "https://stackoverflow.com/users/1277048/fuzzyami"}, "edited": false, "score": 0, "creation_date": 1444735215, "post_id": 33085034, "comment_id": 54017372, "body": "Thanks! (I will further edit the code to create a fully standalone example). and maybe make it a little more verbose."}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "reply_to_user": {"reputation": 5639, "user_id": 1277048, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/tGJVH.jpg?s=128&g=1", "display_name": "FuzzyAmi", "link": "https://stackoverflow.com/users/1277048/fuzzyami"}, "edited": false, "score": 1, "creation_date": 1444825137, "post_id": 33085034, "comment_id": 54062572, "body": "Thank <i>you</i>. One very small nitpick: in Go, <a href=\"https://golang.org/doc/effective_go.html#mixed-caps\" rel=\"nofollow noreferrer\">it&#39;s discouraged</a> to use underscores in identifiers. I&#39;ll edit that."}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": true, "score": 1, "last_activity_date": 1444825149, "last_edit_date": 1444825149, "creation_date": 1444664387, "answer_id": 33085034, "question_id": 33068478, "link": "https://stackoverflow.com/questions/33068478/gocb-bulk-get-operation-example/33085034#33085034", "title": "gocb: bulk Get operation example", "body": "<p>Just replace the <code>*InsertOp</code> values with <code>*GetOp</code> values, then read their <code>Value</code> field:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"gopkg.in/couchbaselabs/gocb.v1\"\n\nfunc main() {\n        getKeys()\n}\n\nfunc getKeys() {\n        myCluster, err := gocb.Connect(\"couchbase://&lt;couchbase-address&gt;\")\n        if err != nil {\n                fmt.Println(\"cluster error:\", err)\n        }\n        myBucket, err := myCluster.OpenBucket(\"Test\", \"\") //case sensitive!\n        if err != nil {\n                fmt.Println(\"bucket error:\", err)\n        }\n\n        var items []gocb.BulkOp\n        items = append(items, &amp;gocb.GetOp{Key: \"document_name_1\"})\n        items = append(items, &amp;gocb.GetOp{Key: \"document_name_2\"})\n\n        err = myBucket.Do(items)\n\n        if err != nil {\n                fmt.Println(\"Do error:\", err)\n                panic(err)\n        }\n\n        for _, g := range items {\n                //\"downcast\" the instance back to its concrete type - GetOp\n                t := g.(*gocb.GetOp)\n                fmt.Println(t)\n        }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7588311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b27dd57fc9bd1341d025353794c59c83?s=128&d=identicon&r=PG", "display_name": "morya", "link": "https://stackoverflow.com/users/7588311/morya"}, "is_accepted": false, "score": 1, "last_activity_date": 1487505974, "creation_date": 1487505974, "answer_id": 42327015, "question_id": 33068478, "link": "https://stackoverflow.com/questions/33068478/gocb-bulk-get-operation-example/42327015#42327015", "title": "gocb: bulk Get operation example", "body": "<p>This is a working version, but I think it's quite verbose</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"gopkg.in/couchbase/gocb.v1\"\n)\n\nconst (\n    COUCH_OP_COUNT = 3\n)\n\n// data interchange with Couchbase store\ntype StorageUrl struct {\n    Url string\n}\n\nfunc storeThings(b *gocb.Bucket) {\n    var ops []gocb.BulkOp\n    for i := 0; i &lt; COUCH_OP_COUNT; i++ {\n        k := fmt.Sprintf(\"key_%v\", i)\n        ops = append(ops, &amp;gocb.UpsertOp{\n            Key:   k,\n            Value: StorageUrl{Url: fmt.Sprintf(\"http://www.i-%v.com\", i)},\n        })\n    }\n\n    b.Do(ops)\n}\n\nfunc fetchThings(b *gocb.Bucket) {\n    var err error\n    var ops []gocb.BulkOp\n    var results []interface{}\n    for i := 0; i &lt; COUCH_OP_COUNT; i++ {\n        k := fmt.Sprintf(\"key_%v\", i)\n        results = append(results, &amp;StorageUrl{})\n        ops = append(ops, &amp;gocb.GetOp{\n            Key:   k,\n            Value: results[i],\n        })\n    }\n\n    err = b.Do(ops)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n\n    for _, op := range ops {\n        getOp := op.(*gocb.GetOp)\n        v := getOp.Value.(*StorageUrl)\n        fmt.Println(v)\n    }\n}\n\nfunc main() {\n    cluster, err := gocb.Connect(\"couchbase://127.0.0.1\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n\n    bucket, err := cluster.OpenBucket(\"test\", \"\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n\n    storeThings(bucket)\n    fetchThings(bucket)\n}\n</code></pre>\n"}], "owner": {"reputation": 5639, "user_id": 1277048, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/tGJVH.jpg?s=128&g=1", "display_name": "FuzzyAmi", "link": "https://stackoverflow.com/users/1277048/fuzzyami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1063, "favorite_count": 0, "accepted_answer_id": 33085034, "answer_count": 2, "score": 2, "last_activity_date": 1487505974, "creation_date": 1444587498, "question_id": 33068478, "link": "https://stackoverflow.com/questions/33068478/gocb-bulk-get-operation-example", "title": "gocb: bulk Get operation example", "body": "<p>The recently released gocb lib (the official golang client for couchbase) offers API for performing bulk operations (Get, Delete, etc). I would love to see a complete example of such an operation, alas - my go skills are lacking and there's nothing online.</p>\n\n<p>I'd like to see a snippet that (1) compiles and (2) performs multi-get and finally (3) manages to access the values returned from couchbase.</p>\n\n<p>here's what little documentation exists online:\n<a href=\"http://developer.couchbase.com/documentation/server/4.0/sdks/go-beta/bulk-operations.html\" rel=\"nofollow\">http://developer.couchbase.com/documentation/server/4.0/sdks/go-beta/bulk-operations.html</a></p>\n\n<p>the following code (which performs insert) is not enough: I want Get (and specifically - how one would review the contents of the get-operation results).</p>\n\n<pre><code>myBucket, _ := myCluster.OpenBucket(\"default\", \"\")\n\nvar items []gocb.BulkOp\nitems = append(items, &amp;gocb.InsertOp{Key: \"document_name_1\", Value: \"Hello World 1\"})\nitems = append(items, &amp;gocb.InsertOp{Key: \"document_name_2\", Value: \"Hello World 2\"})\n\nerr := bucket.Do(items)\n</code></pre>\n"}, {"tags": ["node.js", "string", "go", "exec"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1444612242, "post_id": 33068128, "comment_id": 53961733, "body": "Forgive me for asking, but is it not possible to use a go markdown processor?"}, {"owner": {"reputation": 1897, "user_id": 473368, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e24aa1cfabf417ef8833ea8721a66a8?s=128&d=identicon&r=PG", "display_name": "01AutoMonkey", "link": "https://stackoverflow.com/users/473368/01automonkey"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1444750621, "post_id": 33068128, "comment_id": 54028406, "body": "I could but I want to use the same &quot;markup to html&quot; code on the server and in the browser."}], "answers": [{"tags": [], "owner": {"reputation": 815, "user_id": 943428, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9ea1c683f53f26b5d720da6d4b2162db?s=128&d=identicon&r=PG", "display_name": "uiron", "link": "https://stackoverflow.com/users/943428/uiron"}, "is_accepted": true, "score": -1, "last_activity_date": 1444647311, "creation_date": 1444647311, "answer_id": 33079347, "question_id": 33068128, "link": "https://stackoverflow.com/questions/33068128/whats-the-optimal-way-to-execute-a-nodejs-script-from-golang-that-returns-a-st/33079347#33079347", "title": "What&#39;s the optimal way to execute a nodejs script from golang, that returns a string, and then communicate that string back to a golang variable?", "body": "<p>I've approached similar requirement both ways.</p>\n\n<p>For a build pipeline extension, I'd write a Python script that takes arguments from command line and outputs results to stdout. It's a simple interface, for a \"run once\", \"everything succeeds otherwise fail fast\" usage. If that's the same in your case, I'd keep the implementation as-is.</p>\n\n<p>For a web application, I had Java service for just a specific function (in my case, <a href=\"http://natty.joestelmach.com/\" rel=\"nofollow\">Natty</a> date recognition from a natural language string). This has the benefit that the application is already \"warmed up\" at the time of the call, and will definitely respond faster rather than booting up each time the request comes in. Going with a rest interface will probably reveal more benefits over time - e.g. simpler client implementation, monitoring, deployment options, switch implementation without changing clients, etc. It's just more conventional this way.</p>\n"}, {"tags": [], "owner": {"reputation": 1871, "user_id": 4178182, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-nwJYccYDwvs/AAAAAAAAAAI/AAAAAAAAOUg/A4Wnjm7UsLM/photo.jpg?sz=128", "display_name": "jrkt", "link": "https://stackoverflow.com/users/4178182/jrkt"}, "is_accepted": false, "score": 5, "last_activity_date": 1472148118, "creation_date": 1472148118, "answer_id": 39151979, "question_id": 33068128, "link": "https://stackoverflow.com/questions/33068128/whats-the-optimal-way-to-execute-a-nodejs-script-from-golang-that-returns-a-st/39151979#39151979", "title": "What&#39;s the optimal way to execute a nodejs script from golang, that returns a string, and then communicate that string back to a golang variable?", "body": "<p>The easiest way to do this with <a href=\"https://golang.org/pkg/os/exec/\" rel=\"noreferrer\">os/exec</a>:</p>\n\n<pre><code>command := \"node parser.js /path/to/some/file.md\"\nparts := strings.Fields(command)        \ndata, err := exec.Command(parts[0], parts[1:]...).Output()\nif err != nil {\n    panic(err)\n}\n\noutput := string(data)\n</code></pre>\n\n<p>\"output\" is the data that is printed from your NodeJS script. \"command\" is any command as a string.</p>\n"}], "owner": {"reputation": 1897, "user_id": 473368, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e24aa1cfabf417ef8833ea8721a66a8?s=128&d=identicon&r=PG", "display_name": "01AutoMonkey", "link": "https://stackoverflow.com/users/473368/01automonkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7196, "favorite_count": 4, "accepted_answer_id": 33079347, "answer_count": 2, "score": 4, "last_activity_date": 1472148118, "creation_date": 1444585487, "question_id": 33068128, "link": "https://stackoverflow.com/questions/33068128/whats-the-optimal-way-to-execute-a-nodejs-script-from-golang-that-returns-a-st", "title": "What&#39;s the optimal way to execute a nodejs script from golang, that returns a string, and then communicate that string back to a golang variable?", "body": "<p>I'm currently doing it with <code>os/exec</code> and <code>Stdout</code> on golang's side, and <code>console.log(\"string\")</code> on nodejs's side.</p>\n\n<p>Basically I need to generate a string but can only do so within nodejs but the majority of my code is in golang, so I'm trying to make this little blip in my code as seamless, secure, and reliable as possible and I'm a little uneasy about resting such an important part of my program on \"console.log\" and reading from shell output.</p>\n\n<p>In short: I'm wondering if there exists a better and more standard communication line between my node and go code then console.log + shell output, or is that perhaps optimal enough?</p>\n\n<p>Oh and the function of this particular part of my program is to take a markdown text file and convert it to HTML using <a href=\"https://github.com/markdown-it/markdown-it\" rel=\"nofollow\">markdown-it</a>.</p>\n\n<p>Some ideas:</p>\n\n<ul>\n<li>Communicate through HTTP (send the data/string to a golang http listener)</li>\n<li>Communicate through the filesystem (write the string to a temporary file and read it with golang)</li>\n<li>Communicate through \"something similiar to HTTP but specific to local application data sharing\"</li>\n</ul>\n\n<p>P.S.</p>\n\n<p>I can't use otto, since markdown-it doesn't run there.</p>\n\n<p>Actual code:</p>\n\n<p><code>parser.go</code></p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n    \"os/exec\"\n    \"fmt\"\n    \"bytes\"\n)\n\nfunc main() {\n    cmd := \"node\"\n    args := []string{\"parser.js\", \"/home/user1/dev/current/wikis/Bob's Pain/markup/index.md\"}\n    process := exec.Command(cmd, args...)\n    stdin, err := process.StdinPipe()\n    if err != nil {\n        fmt.Println(err)\n    }\n    defer stdin.Close()\n    buf := new(bytes.Buffer) // THIS STORES THE NODEJS OUTPUT\n    process.Stdout = buf\n    process.Stderr = os.Stderr\n\n    if err = process.Start(); err != nil {\n        fmt.Println(\"An error occured: \", err) \n    }\n\n    process.Wait()\n    fmt.Println(\"Generated string:\", buf)\n}\n</code></pre>\n\n<p><code>parser.js</code></p>\n\n<pre><code>var md = require('markdown-it')();\nvar yaml = require('js-yaml');\nvar fs = require('fs');\n\nif (process.argv.length &lt; 3) {\n  console.log('Usage: node ' + process.argv[1] + ' FILENAME');\n  process.exit(1);\n}\n\nvar filename = process.argv[2];\nfs.readFile(filename, 'utf8', function(err, data) {\n  if (err) {\n    throw err;\n  }\n  parse(data)\n});\n\nfunction parse(data) {\n    data = data.split(\"---\")\n    yamlData = data[1];\n    markData = data[2];\n    y = yamlProcess(yamlData);\n    markData = \"# \"+y.title+\"\\n\\n\"+markData\n    html = markdownToHTML(markData);\n    console.log(html) // SEND THE DATA BACK TO GOLANG\n}\n\nfunction yamlProcess(data) {\n    try {\n      var doc = yaml.safeLoad(data);\n      return doc;\n    } catch (e) {\n      console.log(e);\n      return {};\n    }\n}\n\nfunction markdownToHTML(data) {\n    return md.render(data);\n}\n</code></pre>\n"}, {"tags": ["go", "revel"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5433864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72514954b34ffcee776c21d4105cbdb7?s=128&d=identicon&r=PG&f=1", "display_name": "St. Venom", "link": "https://stackoverflow.com/users/5433864/st-venom"}, "edited": false, "score": 0, "creation_date": 1444669422, "post_id": 33071030, "comment_id": 53989280, "body": "its working in Firefox, but Chrome doesnt display page with error net::ERR_CONTENT_LENGTH_MISMATCH. Tried to insert filter before or after revel.CompressFilter with no success."}, {"owner": {"reputation": 1582, "user_id": 3486065, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/EozB4.png?s=128&g=1", "display_name": "Taco de Wolff", "link": "https://stackoverflow.com/users/3486065/taco-de-wolff"}, "reply_to_user": {"reputation": 11, "user_id": 5433864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72514954b34ffcee776c21d4105cbdb7?s=128&d=identicon&r=PG&f=1", "display_name": "St. Venom", "link": "https://stackoverflow.com/users/5433864/st-venom"}, "edited": false, "score": 0, "creation_date": 1444669684, "post_id": 33071030, "comment_id": 53989413, "body": "I&#39;m not sure how Revel works, but take a look at <a href=\"https://github.com/revel/revel/blob/master/compress.go#L46\" rel=\"nofollow noreferrer\">github.com/revel/revel/blob/master/compress.go#L46</a>, it seems that you need to remove the content-length header so it gets recalculated?"}, {"owner": {"reputation": 11, "user_id": 5433864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72514954b34ffcee776c21d4105cbdb7?s=128&d=identicon&r=PG&f=1", "display_name": "St. Venom", "link": "https://stackoverflow.com/users/5433864/st-venom"}, "edited": false, "score": 0, "creation_date": 1444679330, "post_id": 33071030, "comment_id": 53994284, "body": "Thank you so much for your great help and nice minify library) The only problem i see is endless errors like goroutine 45 [semacquire]: sync.runtime_Syncsemacquire(0xc82013aa00) ; /home/venom/gocode/src/github.com/tdewolff/buffer/shifter.go&zwnj;&#8203;:75 after i renew page like 10 times"}, {"owner": {"reputation": 1582, "user_id": 3486065, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/EozB4.png?s=128&g=1", "display_name": "Taco de Wolff", "link": "https://stackoverflow.com/users/3486065/taco-de-wolff"}, "reply_to_user": {"reputation": 11, "user_id": 5433864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72514954b34ffcee776c21d4105cbdb7?s=128&d=identicon&r=PG&f=1", "display_name": "St. Venom", "link": "https://stackoverflow.com/users/5433864/st-venom"}, "edited": false, "score": 0, "creation_date": 1444679840, "post_id": 33071030, "comment_id": 53994541, "body": "Thanks! That is a weird error, by the line number it seems to come from the Read function of the given io.Reader. Maybe because the pipe isn&#39;t properly closed? Can&#39;t say for sure without more information."}, {"owner": {"reputation": 11, "user_id": 5433864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72514954b34ffcee776c21d4105cbdb7?s=128&d=identicon&r=PG&f=1", "display_name": "St. Venom", "link": "https://stackoverflow.com/users/5433864/st-venom"}, "edited": false, "score": 0, "creation_date": 1444682594, "post_id": 33071030, "comment_id": 53995776, "body": "111 line is: if err := m.Minify(&quot;text/html&quot;, w, pr); err != nil { panic(err)} Error: Conn.Write wrote more than the declared Content-Length; goroutine 56 [running]: my-site/app.glob.func3.1(0xc820281810, 0xc820276b28, 0x7f834fdb4100, 0xc820281760) \t/home/venom/gocode/src/my-site/app/init.go:111 +0x666 created by my-site/app.glob.func3 \t/home/venom/gocode/src/my-site/app/init.go:114 +0x2f4"}, {"owner": {"reputation": 1582, "user_id": 3486065, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/EozB4.png?s=128&g=1", "display_name": "Taco de Wolff", "link": "https://stackoverflow.com/users/3486065/taco-de-wolff"}, "reply_to_user": {"reputation": 11, "user_id": 5433864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72514954b34ffcee776c21d4105cbdb7?s=128&d=identicon&r=PG&f=1", "display_name": "St. Venom", "link": "https://stackoverflow.com/users/5433864/st-venom"}, "edited": false, "score": 0, "creation_date": 1444745671, "post_id": 33071030, "comment_id": 54024889, "body": "Can&#39;t say what is going on without more information. Please identify whether this is a bug in Minify or not."}, {"owner": {"reputation": 11, "user_id": 5433864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72514954b34ffcee776c21d4105cbdb7?s=128&d=identicon&r=PG&f=1", "display_name": "St. Venom", "link": "https://stackoverflow.com/users/5433864/st-venom"}, "edited": false, "score": 0, "creation_date": 1444762782, "post_id": 33071030, "comment_id": 54035336, "body": "This error (Conn.Write wrote more than the declared Content-Length) appers randomly (from 2 page renews to 30). I think it happens for some strange reason when new content length of minified content is countent, but non-minified version is written to response, so actual size of content is bigger than expexted content length. Additionally, this error occurs randomly, so I think its just easier to minify html by text editor rather than solve this problem:("}, {"owner": {"reputation": 1582, "user_id": 3486065, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/EozB4.png?s=128&g=1", "display_name": "Taco de Wolff", "link": "https://stackoverflow.com/users/3486065/taco-de-wolff"}, "reply_to_user": {"reputation": 11, "user_id": 5433864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72514954b34ffcee776c21d4105cbdb7?s=128&d=identicon&r=PG&f=1", "display_name": "St. Venom", "link": "https://stackoverflow.com/users/5433864/st-venom"}, "edited": false, "score": 0, "creation_date": 1444820448, "post_id": 33071030, "comment_id": 54059655, "body": "Sounds like a data race (check with <code>go test -race</code>) or something. But if you want to compress it in the text editor this tool will help: <a href=\"http://pi.tacodewolff.nl:8080/minify\" rel=\"nofollow noreferrer\">pi.tacodewolff.nl:8080/minify</a>"}], "tags": [], "owner": {"reputation": 1582, "user_id": 3486065, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/EozB4.png?s=128&g=1", "display_name": "Taco de Wolff", "link": "https://stackoverflow.com/users/3486065/taco-de-wolff"}, "is_accepted": false, "score": 0, "last_activity_date": 1444665322, "last_edit_date": 1444665322, "creation_date": 1444604568, "answer_id": 33071030, "question_id": 33067616, "link": "https://stackoverflow.com/questions/33067616/how-to-perform-html-minify-with-revel-framework/33071030#33071030", "title": "How to perform html minify with Revel framework", "body": "<p>It seems, by looking at the docs, that a filter can access the <code>Controller</code> type, which contains the <code>Response</code>. This response contains <code>Out</code> which is a ResponseWriter (and thus also an io.Writer). We need to replace only the Write method to redirect the write to the minifier, which then writes to the response writer. We need to use <code>io.Pipe</code> and a goroutine for this.</p>\n\n<pre><code>type MinifyResponseWriter struct {\n    http.ResponseWriter\n    io.Writer\n}\n\nfunc (f MinifyResponseWriter) Write(b []byte) (int, error) {\n    return f.Writer.Write(b)\n}\n\nfunc MinifyFilter(c *Controller, fc []Filter) {\n    pr, pw := io.Pipe()\n    go func(w io.Writer) {\n        m := minify.New()\n        m.AddFunc(\"text/css\", css.Minify)\n        m.AddFunc(\"text/html\", html.Minify)\n        m.AddFunc(\"text/javascript\", js.Minify)\n        m.AddFunc(\"image/svg+xml\", svg.Minify)\n        m.AddFuncRegexp(regexp.MustCompile(\"[/+]json$\"), json.Minify)\n        m.AddFuncRegexp(regexp.MustCompile(\"[/+]xml$\"), xml.Minify)\n\n        if err := m.Minify(\"mimetype\", w, pr); err != nil {\n            panic(err)\n        }\n    }(c.Response.Out)\n    c.Response.Out = MinifyResponseWriter{c.Response.Out, pw}\n}\n</code></pre>\n\n<p>Something along those lines (not tested). Here we take the incoming <code>io.Writer</code> (which is part of the <code>ResponseWriter</code>), and wrap a struct around that. It keeps the original methods for the response writer, but the Write method is overrided to be replaced by the <code>PipeWriter</code>. This means that any write to the new response writer goes to <code>PipeWriter</code>, which is coupled to <code>PipeReader</code>. Minify Reads from that reader and writes to the original response writer.</p>\n\n<p>Because we change the value of <code>c.Response.Out</code>, we need to pass it explicitly to the goroutine. Make sure you obtain the correct mimetype (through extension?) or call the appropriate minify function directly.</p>\n"}], "owner": {"reputation": 11, "user_id": 5433864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72514954b34ffcee776c21d4105cbdb7?s=128&d=identicon&r=PG&f=1", "display_name": "St. Venom", "link": "https://stackoverflow.com/users/5433864/st-venom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 255, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444665322, "creation_date": 1444582503, "question_id": 33067616, "link": "https://stackoverflow.com/questions/33067616/how-to-perform-html-minify-with-revel-framework", "title": "How to perform html minify with Revel framework", "body": "<p>My first idea was to get the response body within the filter, then use one of minify libraries like tdewolff/minify and write to response, but i cant find the way to get response body.\nIs there any better solutions?</p>\n"}, {"tags": ["mysql", "go", "gorp"], "comments": [{"owner": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "edited": false, "score": 0, "creation_date": 1444614724, "post_id": 33067457, "comment_id": 53962210, "body": "What does MySQL output for the query?"}, {"owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "reply_to_user": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "edited": false, "score": 0, "creation_date": 1444624734, "post_id": 33067457, "comment_id": 53964404, "body": "It&#39;s always a number SUM(outputoctets)"}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1444627700, "post_id": 33067457, "comment_id": 53965257, "body": "SUM() returns NULL if there were no matching rows"}], "answers": [{"tags": [], "owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "is_accepted": false, "score": 1, "last_activity_date": 1444616473, "last_edit_date": 1444616473, "creation_date": 1444614171, "answer_id": 33072061, "question_id": 33067457, "link": "https://stackoverflow.com/questions/33067457/mysql-null-value-issue-on-selectint-gorp/33072061#33072061", "title": "MySQL NULL value issue on SelectInt gorp", "body": "<p>Looks like the additional location criteria is filtering out all results, so the sum(outputoctets) is null. <code>\\u003cnil\\u003e</code> is the string <code>\"&lt;nil&gt;\"</code>, which go rejects as an invalid integer.</p>\n\n<p>Use a 'nullable' type to hold the sum, eg, <a href=\"https://golang.org/pkg/database/sql/#NullInt64\" rel=\"nofollow\">NullInt64</a></p>\n\n<p>Alternatively, use the mysql <a href=\"https://dev.mysql.com/doc/refman/5.0/en/control-flow-functions.html#function_ifnull\" rel=\"nofollow\">IFNULL</a> function to avoid returning a null from the query, eg, IFNULL(sum(outputoctets),0)</p>\n\n<p>See the <a href=\"http://go-database-sql.org/nulls.html\" rel=\"nofollow\">Go database tutorial</a> for more information</p>\n"}], "owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1581, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1444616473, "creation_date": 1444581480, "last_edit_date": 1444582077, "question_id": 33067457, "link": "https://stackoverflow.com/questions/33067457/mysql-null-value-issue-on-selectint-gorp", "title": "MySQL NULL value issue on SelectInt gorp", "body": "<p>I'm trying to run the following query using gorp library with mysql</p>\n\n<pre><code>query = \"SELECT SUM(outputoctets) FROM monthlyacct where date &gt;= ? AND date &lt; ? AND location = ?\"\ncount, err := dbMap.SelectInt(query , constrains.From, constrains.To, constrains.LocationId)\n</code></pre>\n\n<p>This query throws the following error,</p>\n\n<blockquote>\n  <p>Scan error on column index 0: converting string \\\"\\u003cnil\\u003e\\\" to\n  a int64: strconv.ParseInt: parsing \\\"\\u003cnil\\u003e\\\": invalid syntax</p>\n</blockquote>\n\n<p>Here column outputoctets is type BIGINT. I also tried changing SelectInt to SelectStr, then it threw the following error;</p>\n\n<blockquote>\n  <p>Scan error on column index 0: unsupported driver -\\u003e Scan pair:\n  \\u003cnil\\u003e -\\u003e *string</p>\n</blockquote>\n\n<p>When I ran the query without location filter, it worked. Seems like this is due to some NULL values present in the location column. However I need to have the location filter on the query. How can I solve this?</p>\n"}, {"tags": ["ssl", "go"], "answers": [{"tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": false, "score": 3, "last_activity_date": 1444583596, "creation_date": 1444583596, "answer_id": 33067810, "question_id": 33066946, "link": "https://stackoverflow.com/questions/33066946/cannot-convert-tls-listener-to-net-tcplistener-on-golang/33067810#33067810", "title": "Cannot convert *tls.listener to *net.TCPListener on golang", "body": "<p>You explicitly mention <code>SetLinger</code> but that's called on a <code>TCPConn</code> <strong>not</strong> on a <code>TCPListener</code>. Have you checked if the accepted <code>net.Conn</code> can be asserted to <code>*net.TCPConn</code>?</p>\n\n<p><br>\nThe <code>crypto/tls</code> package implements the <code>net.Listener</code> interface via a non-exported type so you cannot access the \"inner\" listener that way.</p>\n\n<p>If you really need a <code>net.TCPListener</code>:\nAs with all the other Go standard packages that provide convenience functions that create listeners for you, there are lower level functions that let you create your own. So call <code>net.ListenTCP</code>, then whatever methods you like on it, then pass that to the <code>tls</code> package via <a href=\"https://golang.org/pkg/crypto/tls/#NewListener\" rel=\"nofollow\"><code>tls.NewListener</code></a>.\nSee the <a href=\"https://github.com/golang/go/blob/f2e4c8b5fb3660d793b2c545ef207153db0a34b1/src/crypto/tls/tls.go#L69-L78\" rel=\"nofollow\">source for <code>crypto/tls</code>'s <code>Listen</code></a> for further guidance.</p>\n"}], "owner": {"reputation": 65, "user_id": 3042989, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/TXsJs.jpg?s=128&g=1", "display_name": "shranet", "link": "https://stackoverflow.com/users/3042989/shranet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1430, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1525822879, "creation_date": 1444578727, "last_edit_date": 1444580607, "question_id": 33066946, "link": "https://stackoverflow.com/questions/33066946/cannot-convert-tls-listener-to-net-tcplistener-on-golang", "title": "Cannot convert *tls.listener to *net.TCPListener on golang", "body": "<p>I created a TLS server on GO.</p>\n\n<pre><code>func main() {\n    Log(\"Hello server!\")\n\n    cert, err := tls.LoadX509KeyPair(\"cert.pem\", \"key.pem\")\n    if err != nil {\n        Log(\"server: loadkeys: \", err);\n        return;\n    }\n\n    config := tls.Config{Certificates: []tls.Certificate{cert}}\n    config.Rand = rand.Reader\n    service := \"0.0.0.0:9988\"\n    listener, err := tls.Listen(\"tcp\", service, &amp;config)\n    if err != nil {\n        Log(\"server: listen: %s\", err)\n        return\n    }\n\n    defer listener.Close()\n\n    for {\n        Log(\"Waiting for clients\")\n\n        connection, error := listener.Accept()\n        if error != nil {\n            Log(\"Client error: \", error)\n        } else {\n            //connection.SetLinger(0) //error here\n            go ClientHandler(connection)\n        }\n    }\n}\n</code></pre>\n\n<p>I cannot call SetLinger function, because tls.Listen function returns net.Listener. I need net.TCPListener.</p>\n\n<p>I tried:</p>\n\n<pre><code>tpcListener := listener.(*net.TCPListener)\n</code></pre>\n\n<p>Error: panic: interface conversion: net.Listener is *tls.listener, not *net.TCPListener</p>\n\n<p>There is ListenTCP on <strong>net</strong> package but there is not ListenTCP on <strong>tls</strong> package.</p>\n"}, {"tags": ["git", "github", "go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1444581690, "post_id": 33064343, "comment_id": 53953329, "body": "Don&#39;t use screen shots for text log/error messages. Images are not searchable or selecatable."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1444595467, "post_id": 33064343, "comment_id": 53957739, "body": "Git 1.9.5 is probably <b>way</b> to old. Or your git config is strange."}, {"owner": {"reputation": 736, "user_id": 1330710, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/c0afd1bb4e2b1d752f666b9c318dfd26?s=128&d=identicon&r=PG", "display_name": "rolfk", "link": "https://stackoverflow.com/users/1330710/rolfk"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1444634110, "post_id": 33064343, "comment_id": 53967791, "body": "@DaveC I have attached a text description of the same error in the same concern. Hope you managed to notice."}], "answers": [{"comments": [{"owner": {"reputation": 736, "user_id": 1330710, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/c0afd1bb4e2b1d752f666b9c318dfd26?s=128&d=identicon&r=PG", "display_name": "rolfk", "link": "https://stackoverflow.com/users/1330710/rolfk"}, "edited": false, "score": 0, "creation_date": 1444575631, "post_id": 33064420, "comment_id": 53951585, "body": "i&#39;m not working inside a repo, but would just like to download the package using &quot;go get&quot;. your command throws a fatal error about git repository."}, {"owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "edited": false, "score": 1, "creation_date": 1444595818, "post_id": 33064420, "comment_id": 53957848, "body": "@Carla is referring to the repository in the $GOPATH/src directory. When you <code>go get</code> the tooling is cloning a copy of the library into to your $GOPATH."}], "tags": [], "owner": {"reputation": 46, "user_id": 5032001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2eca42528522bccbbec5e5309ad9f398?s=128&d=identicon&r=PG&f=1", "display_name": "Carla", "link": "https://stackoverflow.com/users/5032001/carla"}, "is_accepted": false, "score": 0, "last_activity_date": 1444562711, "creation_date": 1444562711, "answer_id": 33064420, "question_id": 33064343, "link": "https://stackoverflow.com/questions/33064343/go-get-git-error-on-all-sources-but-golang-org/33064420#33064420", "title": "&quot;go get&quot; git error on all sources but golang.org", "body": "<p>Have you tried this?</p>\n\n<pre><code>git branch --set-upstream-to=origin/master master\n</code></pre>\n\n<p>In case your branch is different than \"master\" you can confirm it with:</p>\n\n<pre><code>git remote -v\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 2793823, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SHXkP.png?s=128&g=1", "display_name": "Min Ju", "link": "https://stackoverflow.com/users/2793823/min-ju"}, "is_accepted": false, "score": 4, "last_activity_date": 1499135635, "creation_date": 1499135635, "answer_id": 44896130, "question_id": 33064343, "link": "https://stackoverflow.com/questions/33064343/go-get-git-error-on-all-sources-but-golang-org/44896130#44896130", "title": "&quot;go get&quot; git error on all sources but golang.org", "body": "<p>Delete the package from GOPATH and go get it again. Your package is modified and git is refusing to pull from upstream.</p>\n"}, {"tags": [], "owner": {"reputation": 733, "user_id": 8380779, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-O4uKl34-THU/AAAAAAAAAAI/AAAAAAAAAHc/oTrJsLNQHyg/photo.jpg?sz=128", "display_name": "kenn", "link": "https://stackoverflow.com/users/8380779/kenn"}, "is_accepted": false, "score": 0, "last_activity_date": 1587785227, "creation_date": 1587785227, "answer_id": 61420603, "question_id": 33064343, "link": "https://stackoverflow.com/questions/33064343/go-get-git-error-on-all-sources-but-golang-org/61420603#61420603", "title": "&quot;go get&quot; git error on all sources but golang.org", "body": "<p>Anybody who might expirience the same error you could try.\n<code>go get -v -u -x ${package name}</code></p>\n"}], "owner": {"reputation": 736, "user_id": 1330710, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/c0afd1bb4e2b1d752f666b9c318dfd26?s=128&d=identicon&r=PG", "display_name": "rolfk", "link": "https://stackoverflow.com/users/1330710/rolfk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2141, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1587785227, "creation_date": 1444562246, "question_id": 33064343, "link": "https://stackoverflow.com/questions/33064343/go-get-git-error-on-all-sources-but-golang-org", "title": "&quot;go get&quot; git error on all sources but golang.org", "body": "<p><strong>go version go1.5.1 windows/amd64\ngit version 1.9.5.msysgit.1</strong></p>\n\n<p>I have been trying to get some Go libraries.\nThey are downloaded fine, when accessed on golang.org\nbut github.com or google.golang.org packages give an error.</p>\n\n<pre><code>There is no tracking information for the current branch.\nPlease specify which branch you want to merge with.\nSee git-pull(1) for details\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/P8ved.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/P8ved.jpg\" alt=\"go get gives an error when fetching from google.golang.org\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/rD8F0.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rD8F0.jpg\" alt=\"go get gives no error when fetching from golang.org\"></a></p>\n"}, {"tags": ["multithreading", "tcp", "go"], "comments": [{"owner": {"reputation": 106150, "user_id": 213464, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a7ba62044bc19143ea4a38cf490b67f2?s=128&d=identicon&r=PG", "display_name": "YOU", "link": "https://stackoverflow.com/users/213464/you"}, "edited": false, "score": 0, "creation_date": 1444554393, "post_id": 33063014, "comment_id": 53945594, "body": "I don&#39;t think routers can handle 500k connections."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 4, "creation_date": 1444554639, "post_id": 33063014, "comment_id": 53945653, "body": "Whenever a goroutine makes a blocking syscall or goes to call C code in a library, go uses a new thread for other goroutines. I suspect that the part commented as <code>&#47;&#47; ... some business logic with data</code> has something blocking that causes go to spin extra goroutines.  Are you per chance calling some C code in that part?"}, {"owner": {"reputation": 99, "user_id": 2637522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1810c5e4b326854c64d804af00ad3a?s=128&d=identicon&r=PG", "display_name": "sintanial", "link": "https://stackoverflow.com/users/2637522/sintanial"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1444556700, "post_id": 33063014, "comment_id": 53946127, "body": "@Not_a_Golfer No, I&#39;m not calling some C code. Furthermore data from the clients come very rarely... so business logic calling very rarely too."}, {"owner": {"reputation": 99, "user_id": 2637522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1810c5e4b326854c64d804af00ad3a?s=128&d=identicon&r=PG", "display_name": "sintanial", "link": "https://stackoverflow.com/users/2637522/sintanial"}, "reply_to_user": {"reputation": 106150, "user_id": 213464, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a7ba62044bc19143ea4a38cf490b67f2?s=128&d=identicon&r=PG", "display_name": "YOU", "link": "https://stackoverflow.com/users/213464/you"}, "edited": false, "score": 0, "creation_date": 1444556888, "post_id": 33063014, "comment_id": 53946172, "body": "@YOU why you so think ? Golang designed for net communications, and IMHO 500K in our time it&#39;s not so much :) ?"}, {"owner": {"reputation": 99, "user_id": 2637522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1810c5e4b326854c64d804af00ad3a?s=128&d=identicon&r=PG", "display_name": "sintanial", "link": "https://stackoverflow.com/users/2637522/sintanial"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1444557152, "post_id": 33063014, "comment_id": 53946260, "body": "@Not_a_Golfer Also, why go create new thread for every blocking syscall, in net/tcp golang by default using epoll which can handle many fd in small numbers of threads ?!"}, {"owner": {"reputation": 106150, "user_id": 213464, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a7ba62044bc19143ea4a38cf490b67f2?s=128&d=identicon&r=PG", "display_name": "YOU", "link": "https://stackoverflow.com/users/213464/you"}, "edited": false, "score": 0, "creation_date": 1444557416, "post_id": 33063014, "comment_id": 53946334, "body": "one big project I knew of have 20 million user login targeted for 20k at maximum peak usage with 10+ servers load-balanced. your 500k is obviously unrealistic."}, {"owner": {"reputation": 99, "user_id": 2637522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1810c5e4b326854c64d804af00ad3a?s=128&d=identicon&r=PG", "display_name": "sintanial", "link": "https://stackoverflow.com/users/2637522/sintanial"}, "reply_to_user": {"reputation": 106150, "user_id": 213464, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a7ba62044bc19143ea4a38cf490b67f2?s=128&d=identicon&r=PG", "display_name": "YOU", "link": "https://stackoverflow.com/users/213464/you"}, "edited": false, "score": 0, "creation_date": 1444558126, "post_id": 33063014, "comment_id": 53946519, "body": "@YOU you talkink about 20k http requests at the same time, which connected, executed, and died. And I talking about long time tcp keep alive connections. In internet has many examples about 1 million keep alive connections on node.js( which working in one threads :) ), and other language like erlang, java and of course  c/c++"}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 1, "creation_date": 1444558879, "post_id": 33063014, "comment_id": 53946692, "body": "@sintanial: Go&#39;s <code>net</code> package will multiplex reads and writes to multiple sockets using epoll/select.  Have you tried inspecting the app with gdb to see what al the threads are doing when you see this error?"}, {"owner": {"reputation": 99, "user_id": 2637522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1810c5e4b326854c64d804af00ad3a?s=128&d=identicon&r=PG", "display_name": "sintanial", "link": "https://stackoverflow.com/users/2637522/sintanial"}, "reply_to_user": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 0, "creation_date": 1444559199, "post_id": 33063014, "comment_id": 53946775, "body": "@James Henstridge Thx for answer, I&#39;ll try it now :)"}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 1, "creation_date": 1444559601, "post_id": 33063014, "comment_id": 53946873, "body": "TCP connections use up one port on each peer. The ports are represented by 16 bit numbers, so there you have a technological limit on the number of TCP connections that you can have on a single IP address which is far from your goal of 0.5M connections. What are you trying to do?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 1, "creation_date": 1444560412, "post_id": 33063014, "comment_id": 53947042, "body": "@UlrichEckhardt AFAIK from multiple source addresses and ports, you can have more than 65k connections, as each connection has two addresses it is identified by."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1444581498, "post_id": 33063014, "comment_id": 53953271, "body": "By the way, your <code>Dispatcher.AddHandler</code> is a <a href=\"https://blog.golang.org/race-detector\" rel=\"nofollow noreferrer\">giant data race</a> making the entire behaviour of your program undefined. You cannot add or delete elements from a map concurrently."}, {"owner": {"reputation": 99, "user_id": 2637522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1810c5e4b326854c64d804af00ad3a?s=128&d=identicon&r=PG", "display_name": "sintanial", "link": "https://stackoverflow.com/users/2637522/sintanial"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1444585859, "post_id": 33063014, "comment_id": 53954629, "body": "@DaveC your are right, it&#39;s example, in real app i use mutex to work in concurrent."}, {"owner": {"reputation": 99, "user_id": 2637522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1810c5e4b326854c64d804af00ad3a?s=128&d=identicon&r=PG", "display_name": "sintanial", "link": "https://stackoverflow.com/users/2637522/sintanial"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1444586012, "post_id": 33063014, "comment_id": 53954682, "body": "@Not_a_Golfer you were right. I remove my business logic, and run server, and it&#39;s works fine. Running in 34 threads and thats all, threads not increasing :). Thx for your, I thought that in the golang problem :)"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1444586768, "post_id": 33063014, "comment_id": 53954943, "body": "@sintanial so what in your business logic blocked the execution and made go&#39;s scheduler spawn more threads? You should read about go&#39;s scheduler BTW, it will make all this less mysterious :)"}, {"owner": {"reputation": 99, "user_id": 2637522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1810c5e4b326854c64d804af00ad3a?s=128&d=identicon&r=PG", "display_name": "sintanial", "link": "https://stackoverflow.com/users/2637522/sintanial"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1444595537, "post_id": 33063014, "comment_id": 53957763, "body": "@Not_a_Golfer a few weeks ago, i published this question <a href=\"http://stackoverflow.com/questions/32238082/the-right-way-to-detect-tcp-broken-connection-manual-keepalive-idle-and-don/32239407\" title=\"the right way to detect tcp broken connection manual keepalive idle and don\">stackoverflow.com/questions/32238082/&hellip;</a>, where i used this library <a href=\"https://github.com/felixge/tcpkeepalive\" rel=\"nofollow noreferrer\">github.com/felixge/tcpkeepalive</a>. The problem was just out of this library"}, {"owner": {"reputation": 1652, "user_id": 918176, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2bdb37b11c35de00bb68359342a82f38?s=128&d=identicon&r=PG", "display_name": "user918176", "link": "https://stackoverflow.com/users/918176/user918176"}, "edited": false, "score": 0, "creation_date": 1447878022, "post_id": 33063014, "comment_id": 55346207, "body": "@sintanial Nice digging! Could you please answer your own question and accept the answer :)"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1447969712, "post_id": 33063014, "comment_id": 55395598, "body": "Could you describe the exact problem the library caused? Have you filed a bug report?"}, {"owner": {"reputation": 99, "user_id": 2637522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1810c5e4b326854c64d804af00ad3a?s=128&d=identicon&r=PG", "display_name": "sintanial", "link": "https://stackoverflow.com/users/2637522/sintanial"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1451061062, "post_id": 33063014, "comment_id": 56670899, "body": "@MarkusWMahlberg problem already reported, but unfortunately author not have amount of time, to fix this problem"}], "answers": [{"tags": [], "owner": {"reputation": 99, "user_id": 2637522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1810c5e4b326854c64d804af00ad3a?s=128&d=identicon&r=PG", "display_name": "sintanial", "link": "https://stackoverflow.com/users/2637522/sintanial"}, "is_accepted": false, "score": 2, "last_activity_date": 1451061382, "last_edit_date": 1451061382, "creation_date": 1447947000, "answer_id": 33808032, "question_id": 33063014, "link": "https://stackoverflow.com/questions/33063014/go-exceeds-10000-thread-on-simple-tcp-server/33808032#33808032", "title": "GO: Exceeds 10000-thread on simple tcp server?", "body": "<p>The problem was that <a href=\"https://github.com/felixge/tcpkeepalive\" rel=\"nofollow\">https://github.com/felixge/tcpkeepalive</a> library. \nThis library get socket file descriptor (fd), copy then and worked with new fd, which running in blocked mode. Therefore, go created new thread on every connect. Go don't kill created thread (because this is native golang behavior), and after some times go failed with \"Exceeds 10000-thread\". That's it !\nPlease do not use it :)</p>\n"}], "owner": {"reputation": 99, "user_id": 2637522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1810c5e4b326854c64d804af00ad3a?s=128&d=identicon&r=PG", "display_name": "sintanial", "link": "https://stackoverflow.com/users/2637522/sintanial"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1634, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1451061382, "creation_date": 1444552251, "last_edit_date": 1444595703, "question_id": 33063014, "link": "https://stackoverflow.com/questions/33063014/go-exceeds-10000-thread-on-simple-tcp-server", "title": "GO: Exceeds 10000-thread on simple tcp server?", "body": "<p>I need to write a tcp server which can handle more than 500k connections.</p>\n\n<p>I wrote a simple server on golang, but when connections more than 10k, the server crashed with the error message \"runtime: program exceeds 10000-thread limit fatal error: thread exhaustion\".</p>\n\n<p>Server runs in last linux build. That go can use epoll for tcp connection, to make it async and use few fd. So why does the server exceed the thread limit?!</p>\n\n<p>My simple server:</p>\n\n<pre><code>package main\nimport (\n    \"strconv\"\n    \"net\"\n    \"log\"\n    \"time\"\n    \"bufio\"\n    \"io\"\n)\n\ntype Handler struct {\n    conn   net.Conn\n    closed chan bool\n}\n\nfunc (h *Handler) Listen() { // listen connection for incomming data\n    defer h.conn.Close()\n    bf := bufio.NewReader(h.conn)\n    for {\n        line, _, err := bf.ReadLine()\n        if err != nil {\n            if err == io.EOF {\n                log.Println(\"End connection\")\n            }\n            h.closed &lt;- true // send to dispatcher, that connection is closed\n            return\n        }\n\n        // ... some business logic with data\n    }\n}\n\ntype Dispatcher struct {\n    handlers map[string]*Handler `map[ip]*Handler`\n}\n\nfunc (d *Dispatcher) AddHandler(conn net.Conn) {\n    addr := conn.RemoteAddr().String()\n    handler := &amp;Handler{conn, make(chan bool, 1)}\n    d.handlers[addr] = handler\n\n    go handler.Listen()\n\n    &lt;-handler.closed // when connection closed, remove handler from handlers\n    delete(d.handlers, addr)\n}\n\nfunc (d *Dispatcher) ListenHandlers(port int) {\n    sport := strconv.Itoa(port)\n\n    ln, err := net.Listen(\"tcp\", \":\" + sport)\n    if err != nil {\n        log.Println(err)\n        return\n    }\n\n    defer ln.Close()\n\n    for {\n        conn, err := ln.Accept() // accept connection\n        if err != nil {\n            log.Println(err)\n            continue\n        }\n\n        tcpconn := conn.(*net.TCPConn)\n        tcpconn.SetKeepAlive(true)\n        tcpconn.SetKeepAlivePeriod(10 * time.Second)\n\n        go d.AddHandler(conn)\n    }\n}\n\nfunc main() {\n    dispatcher := &amp;Dispatcher{make(map[string]*Handler)}\n    dispatcher.ListenHandlers(3000)\n}\n</code></pre>\n\n<p><strong>Update 11.10.2015</strong><br>\nThe problem was that <a href=\"https://github.com/felixge/tcpkeepalive\" rel=\"nofollow\">https://github.com/felixge/tcpkeepalive</a> library. Please do not use it :)</p>\n"}, {"tags": ["arrays", "json", "struct", "go", "encoder"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1444552981, "post_id": 33062750, "comment_id": 53945277, "body": "JSON encoding requires <b>exported</b> field names like <code>Name</code> and <code>Timestamp</code>. This is duplicate. The encoding/json clearly statets that only exported fields are de/encodable. This has been asked at least ten time her on SO."}], "answers": [{"comments": [{"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1444572438, "post_id": 33063116, "comment_id": 53950620, "body": "You are able to retain the original names if you do: <code>Name string `json:&quot;name&quot;`</code> and <code>TimeStamp int64 `json:&quot;timeStamp&quot;`</code>--this can be useful for exporting more idiomatic json."}], "tags": [], "owner": {"reputation": 1053, "user_id": 3608492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68e469e0555fc5221b227deb0d9a305a?s=128&d=identicon&r=PG&f=1", "display_name": "Satyen Rai", "link": "https://stackoverflow.com/users/3608492/satyen-rai"}, "is_accepted": true, "score": 2, "last_activity_date": 1444553144, "creation_date": 1444553144, "answer_id": 33063116, "question_id": 33062750, "link": "https://stackoverflow.com/questions/33062750/json-encode-of-array-of-own-struct/33063116#33063116", "title": "JSON encode of array of own struct", "body": "<p>It doesn't work because none of the fields in the File struct are exported.</p>\n\n<p>The following works just fine:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"os\"\n    \"path/filepath\"\n    \"time\"\n)\n\ntype File struct {\n    Name      string\n    TimeStamp int64\n}\n\nfunc main() {\n\n    files := make([]File, 0, 20)\n\n    filepath.Walk(\"/tmp/\", func(path string, f os.FileInfo, err error) error {\n\n        if f == nil {\n            return nil\n        }\n\n        name := f.Name()\n        if len(name) &gt; 3 {\n            files = append(files, File{\n                Name:      name,\n                TimeStamp: f.ModTime().UnixNano() / int64(time.Millisecond),\n            })\n\n            // grow array if needed\n            if cap(files) == len(files) {\n                newFiles := make([]File, len(files), cap(files)*2)\n                for i := range files {\n                    newFiles[i] = files[i]\n                }\n                files = newFiles\n            }\n        }\n        return nil\n    })\n\n    fmt.Println(files)\n    encoder := json.NewEncoder(os.Stdout)\n    encoder.Encode(&amp;files)\n}\n</code></pre>\n"}], "owner": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 33063116, "answer_count": 1, "score": -4, "last_activity_date": 1444553144, "creation_date": 1444550084, "question_id": 33062750, "link": "https://stackoverflow.com/questions/33062750/json-encode-of-array-of-own-struct", "title": "JSON encode of array of own struct", "body": "<p>I try to read a directory and make a JSON string out of the file entries. But the json.encoder.Encode() function returns only empty objects. For test I have two files in a tmp dir: </p>\n\n<pre><code>test1.js  test2.js \n</code></pre>\n\n<p>The go program is this:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"os\"\n    \"path/filepath\"\n    \"time\"\n)\n\ntype File struct {\n    name      string\n    timeStamp int64\n}\n\nfunc main() {\n\n    files := make([]File, 0, 20)\n\n    filepath.Walk(\"/home/michael/tmp/\", func(path string, f os.FileInfo, err error) error {\n\n        if f == nil {\n            return nil\n        }\n\n        name := f.Name()\n        if len(name) &gt; 3 {\n            files = append(files, File{\n                name:      name,\n                timeStamp: f.ModTime().UnixNano() / int64(time.Millisecond),\n            })\n\n            // grow array if needed\n            if cap(files) == len(files) {\n                newFiles := make([]File, len(files), cap(files)*2)\n                for i := range files {\n                    newFiles[i] = files[i]\n                }\n                files = newFiles\n            }\n        }\n        return nil\n    })\n\n    fmt.Println(files)\n\n    encoder := json.NewEncoder(os.Stdout)\n    encoder.Encode(&amp;files)\n}\n</code></pre>\n\n<p>And the out that it produces is:</p>\n\n<pre><code>[{test1.js 1444549471481} {test2.js 1444549481017}]\n[{},{}]\n</code></pre>\n\n<p>Why is the JSON string empty?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1152113"}, "edited": false, "score": 1, "creation_date": 1444532980, "post_id": 33061117, "comment_id": 53941837, "body": "<a href=\"http://stackoverflow.com/questions/1938428/marshall-unmarshall-a-json-to-a-java-class-using-jaxb\" title=\"marshall unmarshall a json to a java class using jaxb\">stackoverflow.com/questions/1938428/&hellip;</a>"}, {"owner": {"reputation": 6891, "user_id": 2425939, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/SSlFi.png?s=128&g=1", "display_name": "christian", "link": "https://stackoverflow.com/users/2425939/christian"}, "edited": false, "score": 1, "creation_date": 1496304322, "post_id": 33061117, "comment_id": 75609011, "body": "there&#180;s a good answer here: <a href=\"https://stackoverflow.com/questions/21197239/decoding-json-in-golang-using-json-unmarshal-vs-json-newdecoder-decode\" title=\"decoding json in golang using json unmarshal vs json newdecoder decode\">stackoverflow.com/questions/21197239/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 14588, "user_id": 3166303, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/877b076ec96e4ab48f7f4567c1ea2741?s=128&d=identicon&r=PG", "display_name": "leeor", "link": "https://stackoverflow.com/users/3166303/leeor"}, "is_accepted": false, "score": 12, "last_activity_date": 1444533628, "last_edit_date": 1444533628, "creation_date": 1444532868, "answer_id": 33061142, "question_id": 33061117, "link": "https://stackoverflow.com/questions/33061117/in-golang-what-is-the-difference-between-json-encoding-and-marshalling/33061142#33061142", "title": "in Golang, what is the difference between json encoding and marshalling", "body": "<p>Generally, encoding/decoding <code>JSON</code> refers to the process of actually reading/writing the character data to a string or binary form. Marshaling/Unmarshaling refers to the process of mapping <code>JSON</code> types from and to <code>Go</code> data types and primitives.</p>\n\n<p>Actual encoding can include things like serializing unicode characters for example. I think they may be used somewhat interchangeably in documentation sometimes because they generally occur in the same step. The Marshal function for example, will determine which JSON type to marshal something to, and then it will be encoded in string form (which may include other details such as special characters if its textual data).</p>\n\n<p>You can consult the go json package docs for more details on how the <a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"noreferrer\">marshaling</a>/<a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"noreferrer\">unmarshaling</a> steps work.</p>\n"}, {"tags": [], "owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "is_accepted": false, "score": 0, "last_activity_date": 1444571976, "creation_date": 1444571976, "answer_id": 33065848, "question_id": 33061117, "link": "https://stackoverflow.com/questions/33061117/in-golang-what-is-the-difference-between-json-encoding-and-marshalling/33065848#33065848", "title": "in Golang, what is the difference between json encoding and marshalling", "body": "<p>func Encode is a method on an Encoder, which writes JSON encoded Go types to an output stream (func NewEncoder takes an io.Writer and returns a *Encoder).</p>\n\n<p>Your Go types enter the black box and are written out to the stream in JSON formatting.</p>\n\n<p>Marshal is a function that returns JSON encoding of Go types.</p>\n\n<p>Here your Go types enter the black box and come out of the box in JSON formatting.</p>\n\n<p>It's well documented at: \n<a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow\">golang.org/pkg/encoding/json/</a></p>\n"}, {"tags": [], "owner": {"reputation": 956, "user_id": 4365085, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/QBriT.jpg?s=128&g=1", "display_name": "vinit kantrod", "link": "https://stackoverflow.com/users/4365085/vinit-kantrod"}, "is_accepted": false, "score": 51, "last_activity_date": 1576518021, "last_edit_date": 1576518021, "creation_date": 1493445547, "answer_id": 43692324, "question_id": 33061117, "link": "https://stackoverflow.com/questions/33061117/in-golang-what-is-the-difference-between-json-encoding-and-marshalling/43692324#43692324", "title": "in Golang, what is the difference between json encoding and marshalling", "body": "<ul>\n<li>Marshal => String</li>\n<li>Encode => Stream</li>\n</ul>\n\n<p>Marshal and Unmarshal convert a string into JSON and vice versa.\nEncoding and decoding convert a stream into JSON and vice versa.</p>\n\n<p>The below code show working of marshal and unmarshal</p>\n\n<pre><code>type Person struct {\nFirst string\nLast string\n}\nfunc main() {\n    /* This will marshal the JSON into []bytes */\n\n    p1 := Person{\"alice\", \"bob\"}\n    bs, _ := json.Marshal(p1)\n    fmt.Println(string(bs))\n\n    /* This will unmarshal the JSON from []bytes */\n\n    var p2 Person\n    bs = []byte(`{\"First\":\"alice\",\"Last\":\"bob\"}`)\n    json.Unmarshal(bs, &amp;p2)\n    fmt.Println(p2)\n\n}\n</code></pre>\n\n<p>Encoder and decoder write struct to slice of a stream or read data from a slice of a stream and convert it into a struct. Internally, it also implements the marshal method. The only difference is if you want to play with string or bytes use marshal, and if any data you want to read or write to some writer interface, use encodes and decode.</p>\n"}, {"tags": [], "owner": {"reputation": 11808, "user_id": 1404726, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/an5FZ.jpg?s=128&g=1", "display_name": "tim-montague", "link": "https://stackoverflow.com/users/1404726/tim-montague"}, "is_accepted": false, "score": 9, "last_activity_date": 1618530939, "last_edit_date": 1618530939, "creation_date": 1592342327, "answer_id": 62417761, "question_id": 33061117, "link": "https://stackoverflow.com/questions/33061117/in-golang-what-is-the-difference-between-json-encoding-and-marshalling/62417761#62417761", "title": "in Golang, what is the difference between json encoding and marshalling", "body": "<blockquote>\n<p>What is the difference between JSON 'encoding/decoding' and JSON 'marshalling/unmarshalling'?</p>\n</blockquote>\n<hr />\n<p><a href=\"https://en.wikipedia.org/wiki/Marshalling_(computer_science)\" rel=\"nofollow noreferrer\">Marshaling</a> and <a href=\"https://en.wikipedia.org/wiki/Character_encoding\" rel=\"nofollow noreferrer\">Encoding</a> are of course different concepts, better addressed on Wikipedia (or elsewhere). But in short, objects are marshaled into JSON encoded strings.</p>\n<p>Also don't let the Golang <code>json.Marshal</code> and <code>json.NewEncoder</code> / <code>(json.Encoder).Encode</code> methods confuse you. They both marshal objects into JSON encoded strings.</p>\n<p>The difference roughly being that:</p>\n<p><code>(json.Encoder).Encode</code> = <code>json.Marshal</code> + streaming</p>\n<p>It's a more advanced version of <code>json.Marshal</code>, that uses more overhead (code and memory), because it first marshals and then streams the output.</p>\n<p>You can see this in the source code.</p>\n<ul>\n<li>Marshal: <a href=\"https://golang.org/src/encoding/json/encode.go?s=6458:6501#L148\" rel=\"nofollow noreferrer\">https://golang.org/src/encoding/json/encode.go?s=6458:6501#L148</a></li>\n<li>Encode: <a href=\"https://golang.org/src/encoding/json/stream.go?s=5070:5117#L191\" rel=\"nofollow noreferrer\">https://golang.org/src/encoding/json/stream.go?s=5070:5117#L191</a></li>\n</ul>\n<p>If you're working with streams use <code>(json.Encoder).Encode</code>, otherwise use <code>json.Marshal</code>.</p>\n"}], "owner": {"reputation": 707, "user_id": 5428494, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/5075ba00acc4f6068e8923f60f514eca?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/5428494/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19148, "favorite_count": 14, "answer_count": 4, "score": 59, "last_activity_date": 1618530939, "creation_date": 1444532552, "question_id": 33061117, "link": "https://stackoverflow.com/questions/33061117/in-golang-what-is-the-difference-between-json-encoding-and-marshalling", "title": "in Golang, what is the difference between json encoding and marshalling", "body": "<p>What is the difference between JSON 'encoding/decoding' and JSON 'marshalling/unmarshalling'?</p>\n\n<p>Trying to learn how to write a RESTFUL api in golang and not sure what the difference between JSON 'encoding' and 'marshalling' is or if they are the same?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 1, "creation_date": 1444517474, "post_id": 33059420, "comment_id": 53939327, "body": "Seems fine and idiomatic to me. Only thing I think would be better would be to make sure that if i is larger than len(a), then you don&#39;t rotate more than necessary."}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 0, "creation_date": 1444537515, "post_id": 33059420, "comment_id": 53942520, "body": "If you don&#39;t mind allocating a temporary array of <code>i</code> elements, it might be quicker to just do a few <code>copy()</code> operations.  It handles overlapping source and destination correctly."}], "answers": [{"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 2, "last_activity_date": 1444571623, "last_edit_date": 1444571623, "creation_date": 1444558513, "answer_id": 33063846, "question_id": 33059420, "link": "https://stackoverflow.com/questions/33059420/is-this-a-reasonable-and-idiomatic-golang-circular-shift-implementation/33063846#33063846", "title": "Is this a reasonable and idiomatic GoLang circular shift implementation?", "body": "<p>Your code is fine for in-place modification.</p>\n\n<p>Don't clearly understand what you mean by bitwise operations. Maybe this</p>\n\n<pre><code>package main\n\n    import \"fmt\"\n\n    func main() {\n        a := []int{1, 2, 3, 4, 5, 6, 7, 8, 9, 10}\n        fmt.Println(a)\n        rotateR(&amp;a, 4)\n        fmt.Println(a)\n        rotateL(&amp;a, 4)\n        fmt.Println(a)\n    }\n\n    func rotateL(a *[]int, i int) {\n        x, b := (*a)[:i], (*a)[i:]\n        *a = append(b, x...)\n    }\n\n    func rotateR(a *[]int, i int) {\n        x, b := (*a)[:(len(*a)-i)], (*a)[(len(*a)-i):]\n        *a = append(b, x...)\n    }\n</code></pre>\n\n<p>Code works <a href=\"https://play.golang.org/p/0VtiRFQVl7\" rel=\"nofollow\">https://play.golang.org/p/0VtiRFQVl7</a></p>\n\n<p>It's called reslicing in Go vocabulary. Tradeoff is coping and looping in your snippet vs dynamic allocation in this. It's your choice, but in case of shifting 10000 elements array by one position reslicing looks much cheaper. </p>\n"}, {"tags": [], "owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "is_accepted": false, "score": 5, "last_activity_date": 1511104454, "last_edit_date": 1511104454, "creation_date": 1444581336, "answer_id": 33067435, "question_id": 33059420, "link": "https://stackoverflow.com/questions/33059420/is-this-a-reasonable-and-idiomatic-golang-circular-shift-implementation/33067435#33067435", "title": "Is this a reasonable and idiomatic GoLang circular shift implementation?", "body": "<p>Rotating the slice one position at a time, and repeating to get the total desired rotation means it will take time proportional to <em>rotation distance</em> \u00d7 <em>length of slice</em>. By moving each element directly into its final position you can do this in time proportional to just the length of the slice.</p>\n\n<p><a href=\"https://play.golang.org/p/UwrHJYskNS\" rel=\"nofollow noreferrer\">The code for this</a> is a little more tricky than you have, and you\u2019ll need a GCD function to determine how many times to go through the slice:</p>\n\n<pre><code>func gcd(a, b int) int {\n    for b != 0 {\n        a, b = b, a % b\n    }\n\n    return a\n}\n\nfunc rotateL(a []int, i int) {\n\n    // Ensure the shift amount is less than the length of the array,\n    // and that it is positive.\n    i = i % len(a)\n    if i &lt; 0 {\n        i += len(a)\n    }\n\n    for c := 0; c &lt; gcd(i, len(a)); c++ {\n\n        t := a[c]\n\n        j := c\n\n        for {\n            k := j + i\n            // loop around if we go past the end of the slice\n            if k &gt;= len(a) {\n                k -= len(a)\n            }\n            // end when we get to where we started\n            if k == c {\n                break\n            }\n            // move the element directly into its final position\n            a[j] = a[k]\n            j = k\n        }\n\n        a[j] = t\n    }\n}\n</code></pre>\n\n<p>Rotating a slice of size <em>l</em> right by <em>p</em> positions is equivalent to rotating it <em>left</em> by <em>l</em> \u2212 <em>p</em> positions, so you can simplify your <code>rotateR</code> function by using <code>rotateL</code>:</p>\n\n<pre><code>func rotateR(a []int, i int) {\n    rotateL(a, len(a) - i)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 153, "user_id": 5642133, "user_type": "registered", "profile_image": "https://graph.facebook.com/1630487807170647/picture?type=large", "display_name": "Huy Tran", "link": "https://stackoverflow.com/users/5642133/huy-tran"}, "is_accepted": false, "score": 0, "last_activity_date": 1556570268, "last_edit_date": 1556570268, "creation_date": 1556569925, "answer_id": 55910449, "question_id": 33059420, "link": "https://stackoverflow.com/questions/33059420/is-this-a-reasonable-and-idiomatic-golang-circular-shift-implementation/55910449#55910449", "title": "Is this a reasonable and idiomatic GoLang circular shift implementation?", "body": "<p>I like Uvelichitel solution but if you would like modular arithmetic which would be O(n) complexity </p>\n\n<pre><code>package main\nfunc main(){\n   s := []string{\"1\", \"2\", \"3\"}\n   rot := 5\n   fmt.Println(\"Before RotL\", s)\n   fmt.Println(\"After RotL\", rotL(rot, s))\n   fmt.Println(\"Before RotR\", s)\n   fmt.Println(\"After RotR\", rotR(rot,s))\n\n}\nfunc rotL(m int, arr []string) []string{\n     newArr := make([]string, len(arr))\n\n     for i, k := range arr{\n         newPos := (((i - m) % len(arr)) + len(arr)) % len(arr)\n         newArr[newPos] = k\n     }\n\n     return newArr\n}\n\nfunc rotR(m int, arr []string) []string{\n\n     newArr := make([]string, len(arr))\n\n     for i, k := range arr{\n         newPos := (i + m) % len(arr)\n         newArr[newPos] = k\n      }\n      return newArr\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5432090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65df0b0e3cb073a3a80d0cc83ab36ef7?s=128&d=identicon&r=PG&f=1", "display_name": "ssh", "link": "https://stackoverflow.com/users/5432090/ssh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2078, "favorite_count": 1, "answer_count": 3, "score": 4, "last_activity_date": 1556570268, "creation_date": 1444514699, "question_id": 33059420, "link": "https://stackoverflow.com/questions/33059420/is-this-a-reasonable-and-idiomatic-golang-circular-shift-implementation", "title": "Is this a reasonable and idiomatic GoLang circular shift implementation?", "body": "<p>Can anyone comment on whether this is a reasonable and idiomatic way of implementing <a href=\"https://en.wikipedia.org/wiki/Circular_shift\" rel=\"nofollow\">circular shift</a> of integer arrays in Go? (I deliberately chose not to use bitwise operations.)</p>\n\n<p>How could it be improved?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    a := []int{1,2,3,4,5,6,7,8,9,10}\n    fmt.Println(a)\n    rotateR(a, 5)\n    fmt.Println(a)\n    rotateL(a, 5)\n    fmt.Println(a)\n}\n\nfunc rotateL(a []int, i int) {\n    for count := 1; count &lt;= i; count++ {\n        tmp := a[0]\n        for n := 1;n &lt; len(a);n++ {\n            a[n-1] = a[n]\n        }\n        a[len(a)-1] = tmp\n    }\n}\n\nfunc rotateR(a []int, i int) {\n    for count := 1; count &lt;= i; count++ {\n        tmp := a[len(a)-1]\n        for n := len(a)-2;n &gt;=0 ;n-- {\n            a[n+1] = a[n]\n        }\n        a[0] = tmp\n    }\n}\n</code></pre>\n"}, {"tags": ["struct", "go", "import", "undefined"], "answers": [{"tags": [], "owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "is_accepted": true, "score": 27, "last_activity_date": 1444512890, "creation_date": 1444512890, "answer_id": 33059201, "question_id": 33059179, "link": "https://stackoverflow.com/questions/33059179/how-to-use-struct-that-is-imported-from-another-package/33059201#33059201", "title": "How to use struct that is imported from another package", "body": "<p>You need to export the fields of your structure in order for them to be accessible by having them start with upper case characters:</p>\n\n<pre><code>type Player struct {\n    Name         string\n    Speciality   string\n}\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 5227264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e76227526603ba490fda1f62ddf943d5?s=128&d=identicon&r=PG&f=1", "display_name": "Leonid Manieiev", "link": "https://stackoverflow.com/users/5227264/leonid-manieiev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7627, "favorite_count": 2, "accepted_answer_id": 33059201, "answer_count": 1, "score": 3, "last_activity_date": 1552476364, "creation_date": 1444512756, "last_edit_date": 1552476364, "question_id": 33059179, "link": "https://stackoverflow.com/questions/33059179/how-to-use-struct-that-is-imported-from-another-package", "title": "How to use struct that is imported from another package", "body": "<p>Well, I have my struct <strong>Player</strong> in package <strong>Player</strong></p>\n\n<pre><code>package Player\n\ntype Player struct {\n    name         string\n    speciality   string\n}\n</code></pre>\n\n<p>And I have my <strong>main function</strong> in package <strong>main</strong></p>\n\n<pre><code>package main\n\nimport \"pack/Player\"   \n\nfunc main() {   \n   var player Player.Player\n   fmt.Print(player.name)\n}\n</code></pre>\n\n<p>But after I compile it I get </p>\n\n<blockquote>\n  <p>player.name undefined (cannot refer to unexported field or method\n  name)</p>\n</blockquote>\n\n<p>What I am doing wrong?</p>\n"}, {"tags": ["mysql", "go", "rows"], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 5239706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a3fd18c4ea2522fc605c41be0dc7ed8e?s=128&d=identicon&r=PG&f=1", "display_name": "Sohail Shaikh", "link": "https://stackoverflow.com/users/5239706/sohail-shaikh"}, "edited": false, "score": 0, "creation_date": 1444490825, "post_id": 33055567, "comment_id": 53931342, "body": "I already used that ... it returning address ... <code>No of rows are : &amp;{0xc82001a060 0x6b6d0 0xc82000e260 false [] &lt;nil&gt; 0xc8200141b0}</code>"}, {"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "reply_to_user": {"reputation": 155, "user_id": 5239706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a3fd18c4ea2522fc605c41be0dc7ed8e?s=128&d=identicon&r=PG&f=1", "display_name": "Sohail Shaikh", "link": "https://stackoverflow.com/users/5239706/sohail-shaikh"}, "edited": false, "score": 2, "creation_date": 1444491053, "post_id": 33055567, "comment_id": 53931419, "body": "Have you read the documentation on how to read results from a query?  <a href=\"http://go-database-sql.org/retrieving.html\" rel=\"nofollow noreferrer\">go-database-sql.org/retrieving.html</a>"}], "tags": [], "owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "is_accepted": false, "score": 0, "last_activity_date": 1444490462, "creation_date": 1444490462, "answer_id": 33055567, "question_id": 33055527, "link": "https://stackoverflow.com/questions/33055527/how-to-get-number-of-rows-by-select-query-using-mysql/33055567#33055567", "title": "How to get number of rows by select query using mysql", "body": "<p>The application language doesn't make a different.  Use <code>count(*)</code>:</p>\n\n<pre><code>select count(*) as cnt\nfrom userLog\nwhere u_name = ? and u_pass = ?;\n</code></pre>\n\n<p>Then read the value that the query returns.</p>\n"}, {"comments": [{"owner": {"reputation": 706, "user_id": 5924962, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qYiK2.png?s=128&g=1", "display_name": "fafrd", "link": "https://stackoverflow.com/users/5924962/fafrd"}, "edited": false, "score": 0, "creation_date": 1554254855, "post_id": 33059353, "comment_id": 97680577, "body": "keep in mind this works for MySQL, but other databases like sqlite don&#39;t support &#39;IF&#39;."}], "tags": [], "owner": {"reputation": 106, "user_id": 2804626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8913b19679541b271d580c470df42a8?s=128&d=identicon&r=PG&f=1", "display_name": "Yellow", "link": "https://stackoverflow.com/users/2804626/yellow"}, "is_accepted": true, "score": 9, "last_activity_date": 1444514116, "creation_date": 1444514116, "answer_id": 33059353, "question_id": 33055527, "link": "https://stackoverflow.com/questions/33055527/how-to-get-number-of-rows-by-select-query-using-mysql/33059353#33059353", "title": "How to get number of rows by select query using mysql", "body": "<p>As i understand it you need to check if user and password exist in database. If so you can do:</p>\n\n<pre><code>var isAuthenticated bool\nerr := db.QueryRow(\"SELECT IF(COUNT(*),'true','false') FROM userLog WHERE u_name = ? AND u_pass = ?\", uname, pswd).Scan(&amp;isAuthenticated)\nif err != nil {\n    log.Fatal(err)\n} \n</code></pre>\n\n<p>If database contains supplied user and password isAuthenticated will be set to true.</p>\n"}, {"tags": [], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "is_accepted": false, "score": 6, "last_activity_date": 1465686213, "creation_date": 1465686213, "answer_id": 37769245, "question_id": 33055527, "link": "https://stackoverflow.com/questions/33055527/how-to-get-number-of-rows-by-select-query-using-mysql/37769245#37769245", "title": "How to get number of rows by select query using mysql", "body": "<p>If you already executed a query <code>db.Query(\"SELECT * FROM some_tbl\")</code> and have a <code>rows</code> iterator, then you can't extract the number of rows without iterating through it. As you see <a href=\"https://golang.org/pkg/database/sql/#Rows\" rel=\"noreferrer\">there nothing that returns the number of rows</a>.</p>\n\n<p>So the only thing you can do is to make a query to select the number of rows: <code>db.Query(\"SELECT COUNT(*) FROM some_tbl\")</code></p>\n"}, {"comments": [{"owner": {"reputation": 486, "user_id": 6513167, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/597312657096897/picture?type=large", "display_name": "Martin Niederl", "link": "https://stackoverflow.com/users/6513167/martin-niederl"}, "edited": false, "score": 1, "creation_date": 1512070743, "post_id": 38174397, "comment_id": 82120062, "body": "That is exactly what you should NEVER do. Don&#39;t combine SQL statements yourself, always use prepared statements which are auto implemented in most of the SQL functions implemented in Go. e.g.: <code>db.QueryRow(&quot;SELECT id, description FROM status WHERE id = ?&quot;, user.StatusID)</code>"}, {"owner": {"reputation": 486, "user_id": 6513167, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/597312657096897/picture?type=large", "display_name": "Martin Niederl", "link": "https://stackoverflow.com/users/6513167/martin-niederl"}, "edited": false, "score": 0, "creation_date": 1512075295, "post_id": 38174397, "comment_id": 82122470, "body": "Joining the statement string yourself is highly vulnerable to <b>SQL Injections</b>!"}, {"owner": {"reputation": 3485, "user_id": 2099484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/191c10d87d5026cc1cfd2702459d0aba?s=128&d=identicon&r=PG", "display_name": "user2099484", "link": "https://stackoverflow.com/users/2099484/user2099484"}, "reply_to_user": {"reputation": 486, "user_id": 6513167, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/597312657096897/picture?type=large", "display_name": "Martin Niederl", "link": "https://stackoverflow.com/users/6513167/martin-niederl"}, "edited": false, "score": 5, "creation_date": 1512209632, "post_id": 38174397, "comment_id": 82171888, "body": "There is an orthodoxy developing in this area that is becoming quite shrill. If the manipulations involved in assembling an SQL statement are entirely within the program, there is no more chance of injection than there is of the programmer using an erroneous/malicious value via a prepared statement. In my experience, some prepared statements do not work with complex SDQ statement assembly. Yes, if untrusted input is involved, not only use prepared statements but even then do not depend on them entirely. If trusted input is involved, then use your head."}], "tags": [], "owner": {"reputation": 3485, "user_id": 2099484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/191c10d87d5026cc1cfd2702459d0aba?s=128&d=identicon&r=PG", "display_name": "user2099484", "link": "https://stackoverflow.com/users/2099484/user2099484"}, "is_accepted": false, "score": 3, "last_activity_date": 1467580550, "creation_date": 1467580550, "answer_id": 38174397, "question_id": 33055527, "link": "https://stackoverflow.com/questions/33055527/how-to-get-number-of-rows-by-select-query-using-mysql/38174397#38174397", "title": "How to get number of rows by select query using mysql", "body": "<p>As mentioned, count(*) works fine and Scan makes it simpler still, e.g.:</p>\n\n<pre><code>func GetCount(schemadottablename string) int {\n    var cnt int\n    _ = db.QueryRow(`select count(*) from ` + schemadottablename).Scan(&amp;cnt)\n    return cnt \n}\n</code></pre>\n\n<p>You can, of course, use this with a where statement to \"refine\" the count, e.g.:</p>\n\n<pre><code>func GetCount(schemadottablename string, column string, value string) int {\n    var cnt int\n    _ = db.QueryRow(`select count(` + column + `) from ` + schemadottablename + ` where ` + column + `=?`, value).Scan(&amp;cnt)\n    return cnt \n</code></pre>\n\n<p>}</p>\n"}, {"comments": [{"owner": {"reputation": 802, "user_id": 2018909, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/10ebdad579fc333db3830e893baf977e?s=128&d=identicon&r=PG", "display_name": "srini", "link": "https://stackoverflow.com/users/2018909/srini"}, "edited": false, "score": 0, "creation_date": 1542831801, "post_id": 42124311, "comment_id": 93714144, "body": "i agree, this is good solution especially if we dont have the flexibility to modify the query from select * to select count(*)"}], "tags": [], "owner": {"reputation": 3485, "user_id": 2099484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/191c10d87d5026cc1cfd2702459d0aba?s=128&d=identicon&r=PG", "display_name": "user2099484", "link": "https://stackoverflow.com/users/2099484/user2099484"}, "is_accepted": false, "score": 4, "last_activity_date": 1567439030, "last_edit_date": 1567439030, "creation_date": 1486590608, "answer_id": 42124311, "question_id": 33055527, "link": "https://stackoverflow.com/questions/33055527/how-to-get-number-of-rows-by-select-query-using-mysql/42124311#42124311", "title": "How to get number of rows by select query using mysql", "body": "<p>Here is a fairly efficient way to return the number of rows in a MySQL select in go:</p>\n\n<pre><code>rows, selerr := db.Query(sql, StartDate, EndDate) // Query\nif selerr != nil { \n    fmt.Fprint(w, selerr); \n    return \n}\ncount := 0\nfor rows.Next() { \n    count += 1 \n}\n\nrows, _ := db.Query(sql, StartDate, EndDate) // Query again - no error \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3344, "user_id": 903998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pZCd4.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/903998/victor"}, "is_accepted": false, "score": 0, "last_activity_date": 1556384764, "last_edit_date": 1556384764, "creation_date": 1556375314, "answer_id": 55881560, "question_id": 33055527, "link": "https://stackoverflow.com/questions/33055527/how-to-get-number-of-rows-by-select-query-using-mysql/55881560#55881560", "title": "How to get number of rows by select query using mysql", "body": "<p>Just to add some insight into this subject, have you thought like having a general recipe that allows you to express any select  statement into select count(*), that might be useful in pagination affairs and hopefully on what someone is looking for:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n)\n\nconst sample = `select a,b,c\nfrom &lt;table&gt;\nwhere &lt;conditions&gt;`\n\nfunc main() {\n    var re = regexp.MustCompile(`(select)\\b.[\\s\\S]*(from[\\s\\S]*)`)\n    s := re.ReplaceAllString(sample, \"$1 count(*)\\n$2\")\n    fmt.Println(sample + \"\\n\")\n    fmt.Println(s)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/29Iiv1Ta-0_D\" rel=\"nofollow noreferrer\">https://play.golang.org/p/29Iiv1Ta-0_D</a></p>\n"}], "owner": {"reputation": 155, "user_id": 5239706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a3fd18c4ea2522fc605c41be0dc7ed8e?s=128&d=identicon&r=PG&f=1", "display_name": "Sohail Shaikh", "link": "https://stackoverflow.com/users/5239706/sohail-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19089, "favorite_count": 2, "accepted_answer_id": 33059353, "answer_count": 6, "score": 9, "last_activity_date": 1567441743, "creation_date": 1444490194, "last_edit_date": 1567441743, "question_id": 33055527, "link": "https://stackoverflow.com/questions/33055527/how-to-get-number-of-rows-by-select-query-using-mysql", "title": "How to get number of rows by select query using mysql", "body": "<p>I'm new in golang. I want to create a login verification from MySQL db.\nI want a method like as in PHP <code>mysqli_num_rows($res) == 1</code>...\nI tried <code>len(rows)</code> or <code>rows.Column()</code> @<code>fmt.Println(\"No of rows are :\", rows)</code> but it won't...\nThe code which i tried ... (It is a dummy code) </p>\n\n<pre><code>rows, err := db.Query(\"select * from userLog where u_name = ? and u_pass = ?\", uname, pswd)\nif err != nil {\n    log.Fatal(err)\n}\nfmt.Println(\"No of rows are :\", rows)\ndefer rows.Close()\n</code></pre>\n\n<p>If you have another solution for login verification purpose then kindly suggest and explain it briefly Kindly help me out.</p>\n"}, {"tags": ["database", "go"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1444492951, "post_id": 33055112, "comment_id": 53932004, "body": "have you looked at existing ORMs?"}, {"owner": {"reputation": 106, "user_id": 2804626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8913b19679541b271d580c470df42a8?s=128&d=identicon&r=PG&f=1", "display_name": "Yellow", "link": "https://stackoverflow.com/users/2804626/yellow"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1444504417, "post_id": 33055112, "comment_id": 53935736, "body": "I prefer to write my own sql."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1444518556, "post_id": 33055112, "comment_id": 53939557, "body": "Can you expand on what #2 would look like?"}, {"owner": {"reputation": 912, "user_id": 1912391, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/890f477cf12dd59c58e326be303f04b6?s=128&d=identicon&r=PG", "display_name": "ZAky", "link": "https://stackoverflow.com/users/1912391/zaky"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1444560858, "post_id": 33055112, "comment_id": 53947158, "body": "@Not_a_Golfer asked if you looked at existing ORMs, not adviced you to use one. I think that if it will not actually answer your question it will help you to ask more productive one.  <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>. Specially, Proof-read before posting!"}, {"owner": {"reputation": 912, "user_id": 1912391, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/890f477cf12dd59c58e326be303f04b6?s=128&d=identicon&r=PG", "display_name": "ZAky", "link": "https://stackoverflow.com/users/1912391/zaky"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1444561821, "post_id": 33055112, "comment_id": 53947383, "body": "@Not_a_Golfer asked if you looked at existing ORMs, not adviced you to use one. I think that if it will not actually answer your question it will help you to ask more productive one.  <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>. Specially, Proof-read before posting!"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 912, "user_id": 1912391, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/890f477cf12dd59c58e326be303f04b6?s=128&d=identicon&r=PG", "display_name": "ZAky", "link": "https://stackoverflow.com/users/1912391/zaky"}, "edited": false, "score": 0, "creation_date": 1444562600, "post_id": 33055112, "comment_id": 53947609, "body": "@ZAky right, I meant looking at the implementation patterns of others, and implicitly wondered if OP really wants to write yet another ORM. BTW I have written one, but it it&#39;s flat and doesn&#39;t use relations at all, so this issue was never something I&#39;ve dealt with."}, {"owner": {"reputation": 106, "user_id": 2804626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8913b19679541b271d580c470df42a8?s=128&d=identicon&r=PG&f=1", "display_name": "Yellow", "link": "https://stackoverflow.com/users/2804626/yellow"}, "edited": false, "score": 0, "creation_date": 1444611045, "post_id": 33055112, "comment_id": 53961490, "body": "Thank you for comments. Probably my question wasn&#39;t very clear. I will try to think this over and update it in a couple of days. In relation to ORM&#39;s: gorm (the only one i looked at) constructs queries based on metadata, I have concrete queries for data manipulation, gorm uses metadata to construct multi table objects, i prefer concrete methods for that too. It looks orthogonal to my question."}, {"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 0, "creation_date": 1445245768, "post_id": 33055112, "comment_id": 54225443, "body": "Gorp specifically supports selecting view-like objects that join tables (<a href=\"https://github.com/go-gorp/gorp\" rel=\"nofollow noreferrer\">github.com/go-gorp/gorp</a>)"}], "answers": [{"comments": [{"owner": {"reputation": 106, "user_id": 2804626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8913b19679541b271d580c470df42a8?s=128&d=identicon&r=PG&f=1", "display_name": "Yellow", "link": "https://stackoverflow.com/users/2804626/yellow"}, "edited": false, "score": 0, "creation_date": 1444663388, "post_id": 33081494, "comment_id": 53985776, "body": "Let&#39;s say i have User { name string, addresses []Address }, and two UserService methods Get() and Save(). How UserService get/save addresses? What if i need user without addresses? What if Address { []Phone } ?"}, {"owner": {"reputation": 815, "user_id": 943428, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9ea1c683f53f26b5d720da6d4b2162db?s=128&d=identicon&r=PG", "display_name": "uiron", "link": "https://stackoverflow.com/users/943428/uiron"}, "reply_to_user": {"reputation": 106, "user_id": 2804626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8913b19679541b271d580c470df42a8?s=128&d=identicon&r=PG&f=1", "display_name": "Yellow", "link": "https://stackoverflow.com/users/2804626/yellow"}, "edited": false, "score": 0, "creation_date": 1444697354, "post_id": 33081494, "comment_id": 54000784, "body": "If only user can have adresses and phones, I would initially put it all under user service to keep things simple. If the logic around address handling grows too complex over time, I&#39;d move it outside user service to keep it tight."}], "tags": [], "owner": {"reputation": 815, "user_id": 943428, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9ea1c683f53f26b5d720da6d4b2162db?s=128&d=identicon&r=PG", "display_name": "uiron", "link": "https://stackoverflow.com/users/943428/uiron"}, "is_accepted": false, "score": 0, "last_activity_date": 1444653852, "creation_date": 1444653852, "answer_id": 33081494, "question_id": 33055112, "link": "https://stackoverflow.com/questions/33055112/how-to-construct-object-from-multiple-tables-in-go/33081494#33081494", "title": "How to construct object from multiple tables in Go", "body": "<p>If just to reduce the duplication of code each time you want <code>User</code>, put that somewhere that deals with users. <code>UserService</code> if you will, along with <code>createUser</code> and <code>isUserNameAvailable</code>. Some would go even further and create separate layer just for data retrieval and persistence (DAO layer), for me that's a bit too much of boilerplate.</p>\n\n<p>Sometimes you'll find that you probably don't need a separate method at all. You're pulling a complex report from the DB, but the only time you need it is to return via single rest endpoint. The only time you need user by username and password hash is during login - just use it in unside the login(username,password) method. In those cases, just call <code>sqlx</code> directly in your business methods.</p>\n"}], "owner": {"reputation": 106, "user_id": 2804626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8913b19679541b271d580c470df42a8?s=128&d=identicon&r=PG&f=1", "display_name": "Yellow", "link": "https://stackoverflow.com/users/2804626/yellow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 248, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444653852, "creation_date": 1444487580, "last_edit_date": 1444521319, "question_id": 33055112, "link": "https://stackoverflow.com/questions/33055112/how-to-construct-object-from-multiple-tables-in-go", "title": "How to construct object from multiple tables in Go", "body": "<p>I'm trying to find the best way to work with objects represented by multiple database tables.</p>\n\n<p>For database access I wrapped sqlx with my own type and then defined some methods:</p>\n\n<pre><code>type DB struct {\n    *sqlx.DB\n}\nfunc (db *DB) GetSomething(id uint32) *Something {} \nfunc (db *DB) AddSomething(*Something) {}\n</code></pre>\n\n<p>It works nice for objects that map one-to-one with single database table. I see a couple of ways to work with multi-table objects:</p>\n\n<ol>\n<li>Define methods on *DB that do selects from multiple tables and then\nconstruct an object. Save is similiar. </li>\n<li>Create a layer on top of *DB which would construct an object.  </li>\n<li>Do not construct an object, use its parts.</li>\n</ol>\n\n<p>I rather prefer number 2, but need help on how to design it in Go.</p>\n"}, {"tags": ["go", "session-variables"], "answers": [{"comments": [{"owner": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "edited": false, "score": 0, "creation_date": 1444493822, "post_id": 33055577, "comment_id": 53932251, "body": "You can also use a popular Middleware like Negroni for it."}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 3, "last_activity_date": 1444490551, "creation_date": 1444490551, "answer_id": 33055577, "question_id": 33053361, "link": "https://stackoverflow.com/questions/33053361/how-to-create-a-common-function-for-all-requests-in-go/33055577#33055577", "title": "How to create a common function for all requests in Go?", "body": "<p>Basic common approach to create middleware in Gorillatoolkit is to wrap top-level mux. Something like</p>\n\n<pre><code>func Middleware(h http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        //You do something here using request\n        h.ServeHTTP(w, r)\n    })\n}\n</code></pre>\n\n<p>And then</p>\n\n<pre><code>r := mux.NewRouter()\nr.HandleFunc(\"/\", handleHome)\nhttp.Handle(\"/\", Middleware(r))\n</code></pre>\n"}], "owner": {"reputation": 4236, "user_id": 2231905, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/0d4a1b6ef81bd93c9dd8896880995b77?s=128&d=identicon&r=PG", "display_name": "Fallen", "link": "https://stackoverflow.com/users/2231905/fallen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 33055577, "answer_count": 1, "score": 1, "last_activity_date": 1444490551, "creation_date": 1444475717, "question_id": 33053361, "link": "https://stackoverflow.com/questions/33053361/how-to-create-a-common-function-for-all-requests-in-go", "title": "How to create a common function for all requests in Go?", "body": "<p>I am writing a web application with Go to get better with it. My use case is pretty simple. I want to have a common function that will be executed for every request and will generate the navigation bar depending on the user status.</p>\n\n<p>init method looks like (will also give you the idea of my implementation of handler methods):</p>\n\n<pre><code>func init() {\n    initDB()\n    gob.Register(user.User{})\n    r := mux.NewRouter()\n    r.HandleFunc(\"/\", handleHome)\n    http.Handle(\"/\", r)\n}\n</code></pre>\n\n<p>I am using the following method to execute templates.</p>\n\n<pre><code>func executeTemplate(w http.ResponseWriter, name string, status int, data map[string]interface{}) error {\n    w.Header().Set(\"Content-Type\", \"text/html; charset=utf-8\")\n    w.WriteHeader(status)\n    data[\"User\"] = getUser(r)\n    return tpls[name].ExecuteTemplate(w, \"base\", data)\n}\n</code></pre>\n\n<p>I am using Gorilla toolkit to store the session but as of my understanding, I need the http.Request instance every time to access the cookie store. Now I don't want to change the signature of executeTemplate method. Is there any way I can add a function to generate the navigation bar without changing signature of any of the existing methods?</p>\n\n<p>What are some good ways to do it (even with changing the existing methods)?</p>\n"}, {"tags": ["go", "docker", "rethinkdb"], "answers": [{"tags": [], "owner": {"reputation": 2234, "user_id": 316183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/659d0c8387cefd176347beef316688cd?s=128&d=identicon&r=PG", "display_name": "kureikain", "link": "https://stackoverflow.com/users/316183/kureikain"}, "is_accepted": false, "score": 0, "last_activity_date": 1444499013, "creation_date": 1444499013, "answer_id": 33057057, "question_id": 33052699, "link": "https://stackoverflow.com/questions/33052699/how-to-access-install-setup-web-panel-on-live-application-rethinkdb/33057057#33057057", "title": "How to access/Install/Setup Web Panel on live application RethinkDB", "body": "<p>The dashboard actually should available to you without doing anything extra. When you runs it, you usually see thing like</p>\n\n<pre><code>$ rethinkdb\ninfo: Creating directory .../rethinkdb_data\ninfo: Listening for intracluster connections on port 29015\ninfo: Listening for client driver connections on port 28015\ninfo: Listening for administrative HTTP connections on port 8080\ninfo: Server ready\n</code></pre>\n\n<p>When you run RethinkDB, the web panel admin runs on port 8080 by default.But by default it only binds to loopback address: <code>127.0.0.1</code>. So when you are putting it on a production server, you cannot access it by using <code>server_ip:8080</code>. However, accessing via <code>127.0.0.1:8080</code> inside production server should work.</p>\n\n<p>Other reasons maybe because, you accidently change it to a different port in config file.</p>\n\n<p>First, verify that you can reach the dashboard locally on production. By SSHing into production server, try something like:</p>\n\n<ul>\n<li><code>lsof -i :8080</code></li>\n<li><code>curl 127.0.0.1:8080</code></li>\n</ul>\n\n<p>If nothing listen on that port, or it does't respond, then ensure that you don't change the HTTP port. Check your configuration.</p>\n\n<p>Once you verified you can reach it locally on production server.  You had some option to access it from outside:</p>\n\n<ul>\n<li><p>Simplest way I think is using SSH port forwarding like this</p>\n\n<p><code>ssh -fNTL localhost:8080:127.0.0.1:8080 username@ipaddress_of_server</code></p>\n\n<p>Then on your PC, visiting <code>http://localhost:8080</code> will show you web panel of production RethinkDB. What this does it it forwards traffic to port 8080 from your local computer, to <code>127.0.0.1:8080</code> on server you are SSHing to. </p></li>\n<li><p>Install a proxy like Squid on production server. Squid runs on production server, so it can talk to RethinkDB dashboard. Then configure your browser/network to use this proxy when you need access to admin dashboard. Ensure to config Squid properly and with authentication.</p></li>\n<li><p>Install a VPN like <code>openvpn</code> or <code>strongswan</code> on server. Then change binding address to LAN IP. So after connecting to VPN, you can reached it via that LAN IP. If you runs on EC2 classical, you can create a virtual interface, and bind to it. Never bind to private IP of a classical EC2 server, or if you do, ensure to setup security group or using <code>iptable</code> to only allow your office access to it.</p></li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 5175456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X6Oxl.png?s=128&g=1", "display_name": "Ally Cat", "link": "https://stackoverflow.com/users/5175456/ally-cat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444591894, "creation_date": 1444471157, "last_edit_date": 1444591894, "question_id": 33052699, "link": "https://stackoverflow.com/questions/33052699/how-to-access-install-setup-web-panel-on-live-application-rethinkdb", "title": "How to access/Install/Setup Web Panel on live application RethinkDB", "body": "<p>I've looked extensively and hit many brick walls.</p>\n\n<p>We are utilising RethinkDB in Invmail.IO a portion of the tech stack we have acquired and intergrated from LB source is the Invite system, which i understand is all database driven. </p>\n\n<p>Though finding experienced developers in RethinkDB's is prooving quiet difficult, \n<a href=\"http://rethinkdb.com/docs/administration-tools/\" rel=\"nofollow\">http://rethinkdb.com/docs/administration-tools/</a>.\nWe would like to have the web panel active yet can not find a guide on how to do this on a live application so that we can login and see where the invite and update the wording. </p>\n\n<p>Any advice would be appreciated.</p>\n"}, {"tags": ["c++", "c++11", "go", "functional-programming", "destructor"], "comments": [{"owner": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 2, "creation_date": 1444463332, "post_id": 33050620, "comment_id": 53923739, "body": "This might be more appropriate for <a href=\"http://codereview.stackexchange.com\">CodeReview</a>. Note that there are already many implementations of this ScopeGuard-like class, so why reinvent the wheel? Some implementations I know have various benefits or specialized tools that I&#39;d prefer to your version (e.g. no type erasure)."}, {"owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "edited": false, "score": 2, "creation_date": 1444465945, "post_id": 33050620, "comment_id": 53924416, "body": "The problem with this is that each class should already do what you are doing in their destructor so the use cases in C++ are way rarer than in Go. If you are looking for existing implementations check boost.ScopeExit. Facebook&#39;s Folly has one as well I think."}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 1, "creation_date": 1444470210, "post_id": 33050620, "comment_id": 53925505, "body": "You are probably better off marking the destructor <code>noexcept</code>.  If the function you use <code>FrameExitTask</code> in returns normally, an exception from your finally handler will probably work.  If the function exits due to some other exception, then a second exception from your handler is going to cause problems."}, {"owner": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1444490284, "post_id": 33050620, "comment_id": 53931186, "body": "<code>FrameExitTask</code>&#39;s destructor is implicitly <code>noexcept</code>. That is, if <code>func_()</code> throws an exception, your program will be terminated."}, {"owner": {"reputation": 9586, "user_id": 1000282, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/371832f83b79a41443fa50d3793b0cfd?s=128&d=identicon&r=PG", "display_name": "pepper_chico", "link": "https://stackoverflow.com/users/1000282/pepper-chico"}, "edited": false, "score": 2, "creation_date": 1444492785, "post_id": 33050620, "comment_id": 53931946, "body": "what does it have anything to do with the <code>functional-programming</code> tag?"}, {"owner": {"reputation": 2549, "user_id": 292924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9206efbd844c802932b2c70c82ca209e?s=128&d=identicon&r=PG", "display_name": "daveagp", "link": "https://stackoverflow.com/users/292924/daveagp"}, "edited": false, "score": 0, "creation_date": 1444501623, "post_id": 33050620, "comment_id": 53934849, "body": "Thanks to the answer mentioning ScopeGuard I found this implementation of a more general tool: <a href=\"http://stackoverflow.com/questions/10270328/the-simplest-and-neatest-c11-scopeguard\" title=\"the simplest and neatest c11 scopeguard\">stackoverflow.com/questions/10270328/&hellip;</a> It points out one improvement, using rvalue references and move semantics."}, {"owner": {"reputation": 2549, "user_id": 292924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9206efbd844c802932b2c70c82ca209e?s=128&d=identicon&r=PG", "display_name": "daveagp", "link": "https://stackoverflow.com/users/292924/daveagp"}, "edited": false, "score": 0, "creation_date": 1444501919, "post_id": 33050620, "comment_id": 53934946, "body": "inf: You&#39;re right for the example I gave here, but the application that motivated me at first does not correspond to a file or other known class. Specifically, a function does some checks then some work and when taking one of several exits, it ships the results of the work somewhere else. I could implement a single-use class but wanted to know the best general approach."}, {"owner": {"reputation": 728, "user_id": 986783, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/82f641d40c181891a19b13b2480f5966?s=128&d=identicon&r=PG", "display_name": "Ilya Denisov", "link": "https://stackoverflow.com/users/986783/ilya-denisov"}, "edited": false, "score": 0, "creation_date": 1584815424, "post_id": 33050620, "comment_id": 107555916, "body": "@daveagp <a href=\"https://youtu.be/WjTrfoiB0MQ\" rel=\"nofollow noreferrer\">youtu.be/WjTrfoiB0MQ</a> - video posted 8 days after your question :)"}], "answers": [{"comments": [{"owner": {"reputation": 2549, "user_id": 292924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9206efbd844c802932b2c70c82ca209e?s=128&d=identicon&r=PG", "display_name": "daveagp", "link": "https://stackoverflow.com/users/292924/daveagp"}, "edited": false, "score": 0, "creation_date": 1444501149, "post_id": 33054951, "comment_id": 53934707, "body": "I meant that it correctly works when an exception is thrown mid-function, not in the callback. Finding out about ScopeGuard is very helpful. Thanks!"}], "tags": [], "owner": {"reputation": 15544, "user_id": 1908347, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1305fee562b70958e65b557ce049e31?s=128&d=identicon&r=PG", "display_name": "Nir Friedman", "link": "https://stackoverflow.com/users/1908347/nir-friedman"}, "is_accepted": true, "score": 5, "last_activity_date": 1444486580, "creation_date": 1444486580, "answer_id": 33054951, "question_id": 33050620, "link": "https://stackoverflow.com/questions/33050620/golang-style-defer-in-c/33054951#33054951", "title": "golang-style &quot;defer&quot; in C++", "body": "<p>This already exists, and it's called scope guard. See this fantastic talk: <a href=\"https://channel9.msdn.com/Shows/Going+Deep/C-and-Beyond-2012-Andrei-Alexandrescu-Systematic-Error-Handling-in-C\" rel=\"noreferrer\">https://channel9.msdn.com/Shows/Going+Deep/C-and-Beyond-2012-Andrei-Alexandrescu-Systematic-Error-Handling-in-C</a>. This lets you easily create an arbitrary callable to be called at exit. This is the newer version; it was developed originally long before go existed. </p>\n\n<p>It works perfectly in general, but I'm not sure what you mean by it handling exceptions. Throwing exceptions from a function that has to be called at scope exit is a mess. The reason: when an exception is thrown (and not immediately caught), current scope exits. All destructors get run, and the exception will continue propagating. If one of the destructors throws, what do you do? You now have two live exceptions. </p>\n\n<p>I suppose there are ways a language could try to deal with this, but it's very complex. In C++, it's very rare that a throwing destructor would be considered a good idea. </p>\n"}, {"comments": [{"owner": {"reputation": 479, "user_id": 4653540, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RPA8ER0TWvw/AAAAAAAAAAI/AAAAAAAAAiY/2g8Wf4I-SvA/photo.jpg?sz=128", "display_name": "Yuriy Pozniak", "link": "https://stackoverflow.com/users/4653540/yuriy-pozniak"}, "edited": false, "score": 1, "creation_date": 1544287956, "post_id": 33055002, "comment_id": 94226087, "body": "IMO there is no universal rule or tool, capable of solving any problem. I mean, talking about your suggestion with a raii wrapper, there are situations when you simply don&#39;t want to clutter your codebase with wrappers for every single adhoc acquire/release. scope_guard + lambda provides a good alternative."}, {"owner": {"reputation": 9586, "user_id": 1000282, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/371832f83b79a41443fa50d3793b0cfd?s=128&d=identicon&r=PG", "display_name": "pepper_chico", "link": "https://stackoverflow.com/users/1000282/pepper-chico"}, "edited": false, "score": 1, "creation_date": 1551816225, "post_id": 33055002, "comment_id": 96776180, "body": "It looks like your hopes are finally about to <i>not</i> be fulfilled :)  <a href=\"https://github.com/jensmaurer/papers/issues/278\" rel=\"nofollow noreferrer\">github.com/jensmaurer/papers/issues/278</a>"}], "tags": [], "owner": {"reputation": 138660, "user_id": 298661, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3445f56229632874a44596385ed6d40c?s=128&d=identicon&r=PG", "display_name": "Puppy", "link": "https://stackoverflow.com/users/298661/puppy"}, "is_accepted": false, "score": -4, "last_activity_date": 1444487304, "last_edit_date": 1444487304, "creation_date": 1444486950, "answer_id": 33055002, "question_id": 33050620, "link": "https://stackoverflow.com/questions/33050620/golang-style-defer-in-c/33055002#33055002", "title": "golang-style &quot;defer&quot; in C++", "body": "<p>This already exists in C++, and it's a tremendously bad idea and the example you gave exemplifies why it's a pointless thing to do and I hope that the Committee never introduces it.</p>\n\n<p>For example, if you have a file handle, then write a class to do it for you and then you won't have to write a defer statement for every single use case, which you could easily forget to do. Or just plain get it wrong. You write one destructor, once. That's it. Then you're guaranteed for all uses of the class that it's safe. It's much safer and much easier.</p>\n"}, {"tags": [], "owner": {"reputation": 9586, "user_id": 1000282, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/371832f83b79a41443fa50d3793b0cfd?s=128&d=identicon&r=PG", "display_name": "pepper_chico", "link": "https://stackoverflow.com/users/1000282/pepper-chico"}, "is_accepted": false, "score": 23, "last_activity_date": 1551815504, "last_edit_date": 1551815504, "creation_date": 1444491213, "answer_id": 33055669, "question_id": 33050620, "link": "https://stackoverflow.com/questions/33050620/golang-style-defer-in-c/33055669#33055669", "title": "golang-style &quot;defer&quot; in C++", "body": "<p>Boost discuss this in Smart Pointer Programming Techniques:</p>\n\n<ul>\n<li><a href=\"http://www.boost.org/doc/libs/1_59_0/libs/smart_ptr/sp_techniques.html#handle\" rel=\"noreferrer\">http://www.boost.org/doc/libs/1_59_0/libs/smart_ptr/sp_techniques.html#handle</a></li>\n</ul>\n\n<p>You can do, for example:</p>\n\n<pre><code>#include &lt;memory&gt;\n#include &lt;iostream&gt;\n#include &lt;functional&gt;\n\nusing namespace std;\nusing defer = shared_ptr&lt;void&gt;;    \n\nint main() {\n    defer _(nullptr, bind([]{ cout &lt;&lt; \", World!\"; }));\n    cout &lt;&lt; \"Hello\";\n}\n</code></pre>\n\n<p>Or, without <code>bind</code>:</p>\n\n<pre><code>#include &lt;memory&gt;\n#include &lt;iostream&gt;\n\nusing namespace std;\nusing defer = shared_ptr&lt;void&gt;;    \n\nint main() {\n    defer _(nullptr, [](...){ cout &lt;&lt; \", World!\"; });\n    cout &lt;&lt; \"Hello\";\n}\n</code></pre>\n\n<p>You may also as well rollout your own small class for such, or make use of the reference implementation for N3830/P0052:</p>\n\n<ul>\n<li><a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n3830.pdf\" rel=\"noreferrer\">N3830</a>: <a href=\"https://github.com/alsliahona/N3830\" rel=\"noreferrer\">https://github.com/alsliahona/N3830</a></li>\n<li><a href=\"http://wg21.link/p0052\" rel=\"noreferrer\">P0052</a>: <a href=\"https://github.com/PeterSommerlad/scope17\" rel=\"noreferrer\">https://github.com/PeterSommerlad/scope17</a></li>\n</ul>\n\n<p><a href=\"http://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines\" rel=\"noreferrer\">The C++ Core Guidelines</a> also <a href=\"http://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines#c30-define-a-destructor-if-a-class-needs-an-explicit-action-at-object-destruction\" rel=\"noreferrer\">have a guideline</a> which employs the <code>gsl::finally</code> function, for which there's an implementation <a href=\"https://github.com/Microsoft/GSL/blob/ebe7ebfd855a95eb93783164ffb342dbd85cbc27/include/gsl/gsl_util#L85-L89\" rel=\"noreferrer\">here</a>.</p>\n\n<p>There are many codebases that employ similar solutions for this, hence,\nthere's a demand for this tool.</p>\n\n<p>Related SO discussion:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/14878121/is-there-a-proper-ownership-in-a-package-for-handles-available\">Is there a proper &#39;ownership-in-a-package&#39; for &#39;handles&#39; available?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/14865919/wheres-the-proper-resource-handling-rule-of-zero\">Where&#39;s the proper (resource handling) Rule of Zero?</a></li>\n</ul>\n"}], "owner": {"reputation": 2549, "user_id": 292924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9206efbd844c802932b2c70c82ca209e?s=128&d=identicon&r=PG", "display_name": "daveagp", "link": "https://stackoverflow.com/users/292924/daveagp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11636, "favorite_count": 4, "closed_date": 1444776328, "accepted_answer_id": 33054951, "answer_count": 3, "score": 15, "last_activity_date": 1551815504, "creation_date": 1444454597, "last_edit_date": 1495535483, "question_id": 33050620, "link": "https://stackoverflow.com/questions/33050620/golang-style-defer-in-c", "closed_reason": "Duplicate", "title": "golang-style &quot;defer&quot; in C++", "body": "<p>I was reading about the go language's <a href=\"http://blog.golang.org/defer-panic-and-recover\" rel=\"noreferrer\">defer</a> statement. It allows you to specify an action to take when a function has ended. For example, if you have a file pointer or resource, instead of writing free/delete with every possible return path, you just need to specify the defer function once.</p>\n\n<p>It looks like an analogue might be coming to C++ eventually (<a href=\"https://stackoverflow.com/questions/32432450/what-is-standard-defer-finalizer-implementation-in-c\">What is standard defer/finalizer implementation in C++?</a>, <a href=\"https://stackoverflow.com/questions/30405269/will-there-be-standardization-of-scope-guard-scope-exit-idioms\">Will there be standardization of scope guard/scope exit idioms?</a>) Until then, is there anything unforeseen about doing it with an object whose destructor makes a callback? It looks like the <a href=\"https://isocpp.org/wiki/faq/dtors#order-dtors-for-locals\" rel=\"noreferrer\">destructor order for local variables is sane</a> and that it also handles exceptions well, though maybe not exiting on signals.</p>\n\n<p>Here is a sample implementation... is there anything troubling about it?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;functional&gt;\nusing namespace std;\n\nclass FrameExitTask {\n    std::function&lt;void()&gt; func_;\npublic:\n    FrameExitTask(std::function&lt;void()&gt; func) :\n    func_(func) {\n    }\n    ~FrameExitTask() {\n        func_();\n    }\n    FrameExitTask&amp; operator=(const FrameExitTask&amp;) = delete;\n    FrameExitTask(const FrameExitTask&amp;) = delete;\n};\n\nint main() {\n    FrameExitTask outer_task([](){cout &lt;&lt; \"world!\";});\n    FrameExitTask inner_task([](){cout &lt;&lt; \"Hello, \";});\n    if (1+1 == 2)\n        return -1;\n    FrameExitTask skipped_task([](){cout &lt;&lt; \"Blam\";});\n}\n</code></pre>\n\n<p>Output: <code>Hello, world!</code></p>\n"}, {"tags": ["json", "go", "struct", "slice"], "answers": [{"comments": [{"owner": {"reputation": 372, "user_id": 1214879, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/HTNHK.jpg?s=128&g=1", "display_name": "j boschiero", "link": "https://stackoverflow.com/users/1214879/j-boschiero"}, "edited": false, "score": 0, "creation_date": 1444623256, "post_id": 33050660, "comment_id": 53964024, "body": "Worked brilliantly, thank you. This may be a naive question, by what is more efficient about the slice of pointers versus the slice of struct? Either way the code is using references, no?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 372, "user_id": 1214879, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/HTNHK.jpg?s=128&g=1", "display_name": "j boschiero", "link": "https://stackoverflow.com/users/1214879/j-boschiero"}, "edited": false, "score": 0, "creation_date": 1444633130, "post_id": 33050660, "comment_id": 53967313, "body": "@jboschiero In case of pointers, when you assign a value to a slice element, it only copies a pointer (4 or 8 bytes). If slice contains non-pointers, assigning a value to a slice element (e.g. <code>allData[i] = &amp;Data{Valid: true}</code>) copies the whole struct which may be big if your struct is big (you said it has like 14 fields), so if size of struct is 200 bytes, an assignment copies 200 bytes."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1475647712, "last_edit_date": 1475647712, "creation_date": 1444454972, "answer_id": 33050660, "question_id": 33050511, "link": "https://stackoverflow.com/questions/33050511/how-do-i-turn-an-array-of-json-objects-into-an-array-of-structs-with-default-val/33050660#33050660", "title": "How do I turn an array of JSON objects into an array of structs with default values in Go?", "body": "<p>You can use the <a href=\"https://golang.org/pkg/encoding/json/#RawMessage\" rel=\"nofollow\"><code>json.RawMessage</code></a> type to defer unmarshaling some JSON text value. If you use this type, then the JSON text will be stored in this without unmarshaling (so you can unmarshal this fragment later on as you wish).</p>\n\n<p>So in your case if you try to unmarshal into a slice of such <code>RawMessage</code>, you can use the technique what you linked in your question, that is you can iterate over the slice of raw values (which are the JSON text for each <code>Data</code>), create a <code>Data</code> struct with values you want as defaults for missing values, and unmarshal a slice element into this prepared struct. That's all.</p>\n\n<p>It looks like this:</p>\n\n<pre><code>allJson := []json.RawMessage{}\nif err := json.Unmarshal(src, &amp;allJson); err != nil {\n    panic(err)\n}\n\nallData := make([]Data, len(allJson))\nfor i, v := range allJson {\n    // Here create your Data with default values\n    allData[i] = Data{Valid: true}\n    if err := json.Unmarshal(v, &amp;allData[i]); err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/XEBorqgntM\" rel=\"nofollow\">Go Playground</a>.</p>\n\n<p><strong>Notes / Variants</strong></p>\n\n<p>For efficiency (to avoid copying structs), you can also make the <code>allData</code> to be a slice of pointers in the above example, which would look like this:</p>\n\n<pre><code>allData := make([]*Data, len(allJson))\nfor i, v := range allJson {\n    // Here create your Data with default values\n    allData[i] = &amp;Data{Valid: true}\n    if err := json.Unmarshal(v, allData[i]); err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>If you want to keep using non-pointers, for efficiency you can \"prepare\" your wished default values in the slice elements itself, which would look like this:</p>\n\n<pre><code>allData := make([]Data, len(allJson))\nfor i, v := range allJson {\n    // Here set your default values in the slice elements\n    // Only set those which defer from the zero values:\n    allData[i].Valid = true\n    if err := json.Unmarshal(v, &amp;allData[i]); err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": false, "score": 1, "last_activity_date": 1444455658, "creation_date": 1444455658, "answer_id": 33050735, "question_id": 33050511, "link": "https://stackoverflow.com/questions/33050511/how-do-i-turn-an-array-of-json-objects-into-an-array-of-structs-with-default-val/33050735#33050735", "title": "How do I turn an array of JSON objects into an array of structs with default values in Go?", "body": "<p>You can do a good trick by providing an <code>UnmarshalJSON</code> method on your type to make it transparent and work automatically even if your type is found within structs or slices.</p>\n\n<pre><code>func (d *Data) UnmarshalJSON(j []byte) error {\n    type _Data Data // Dummy type to avoid infinite recursion in UnmarshalJSON\n    tmp := _Data{ // Set defaults here\n        Valid: true,\n    }\n\n    err := json.Unmarshal(j, &amp;tmp)\n    if err != nil {\n        return err\n    }\n\n    *d = Data(tmp)\n    return nil\n}\n</code></pre>\n\n<p>The type <code>_Data</code> exists simply so that we can call <code>json.Unmarshal(j, &amp;tmp)</code> and get the original un-overridden behavior, instead of calling the <code>UnmarshalJSON</code> method that we're already in the middle of. We can set default values on <code>tmp</code> using the trick that you already linked to. And then after the unmarshalling is done, we can just cast <code>tmp</code> to <code>Data</code> because after all <code>Data</code> and <code>_Data</code> are really the same type.</p>\n\n<p>Given this method you can simply</p>\n\n<pre><code>var structs []Data\nerr := json.Unmarshal(input, &amp;structs)\n</code></pre>\n\n<p>(or likewise with a <code>json.Decoder</code>) and have it work just the way you want.</p>\n"}], "owner": {"reputation": 372, "user_id": 1214879, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/HTNHK.jpg?s=128&g=1", "display_name": "j boschiero", "link": "https://stackoverflow.com/users/1214879/j-boschiero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 33050660, "answer_count": 2, "score": 3, "last_activity_date": 1536075733, "creation_date": 1444453504, "last_edit_date": 1536075733, "question_id": 33050511, "link": "https://stackoverflow.com/questions/33050511/how-do-i-turn-an-array-of-json-objects-into-an-array-of-structs-with-default-val", "title": "How do I turn an array of JSON objects into an array of structs with default values in Go?", "body": "<p>I'm working on a Go API that can receive POSTs consisting of a JSON array of objects. The structure of the POST will look something like:</p>\n\n<pre><code>[\n  {\n    \"name\":\"Las Vegas\",\n    \"size\":14\n  },\n  {\n    \"valid\": false,\n    \"name\":\"Buffalo\",\n    \"size\":63\n  }\n]  \n</code></pre>\n\n<p>Let's say I have the following struct:</p>\n\n<pre><code>type Data {\n    Valid    bool\n    Name     string\n    Size     float64\n}\n</code></pre>\n\n<p>I want to create a bunch of <code>Data</code>s with <code>Valid</code> set to <code>true</code> anytime it's not actually specified in the JSON as <code>false</code>. If I were doing a single one I could use <a href=\"https://stackoverflow.com/questions/30445479/how-to-specify-default-values-when-parsing-json-in-go\">How to specify default values when parsing JSON in Go</a>, but for doing an unknown number of them the only thing I've been able to come up with is something like:</p>\n\n<pre><code>var allMap []map[string]interface{}\nvar structs []Data\nfor _, item := range allMap {\n  var data Data\n  var v interface{}\n  var ok bool\n  if v, ok := item[\"value\"]; ok {\n    data.Valid = v\n  } else {\n    data.Valid = true\n  }\n  id v, ok := item[\"name\"]; ok {\n    data.Name = v\n  }\n  ...\n  structs = append(structs, data)\n}\nreturn structs\n</code></pre>\n\n<p>Right now the struct I'm actually working with has 14 fields, some of them have values I want to assign defaults, others are fine to leave blank, but all of them have to be iterated through using this approach. </p>\n\n<p>Is there a better way?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": false, "score": 1, "last_activity_date": 1444449420, "creation_date": 1444449420, "answer_id": 33050095, "question_id": 33049931, "link": "https://stackoverflow.com/questions/33049931/golang-how-to-get-element-from-the-interface-type-of-slice/33050095#33050095", "title": "golang - how to get element from the interface{} type of slice?", "body": "<p>You can't do that, because a slice of int, string or anything can't be directly casted to a slice of interfaces. (see <a href=\"https://stackoverflow.com/questions/12753805/type-converting-slices-of-interfaces-in-go\">that question</a> for more explanation on this).</p>\n\n<p>To do the conversion, you need to cast each item of the slice as an <code>interface{}</code> separately. And you can't access the items without casting to a slice first, but for that you need to know the slice's type (so we're back to square one).</p>\n\n<p>One way to shorten your syntax is to take in a slice of interfaces as argument, and let the caller do the conversion (because the caller knows the slice's type). Here is an example : <a href=\"https://play.golang.org/p/6yLYk1OM25\" rel=\"nofollow\">https://play.golang.org/p/6yLYk1OM25</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    mySlice := []int{1, 2, 3}\n\n    interfaceSlice := make([]interface{}, len(mySlice))\n    for index := range mySlice {\n        interfaceSlice[index] = mySlice[index]\n    }\n\n    fmt.Println(sliceToString(interfaceSlice))\n}\n\nfunc sliceToString(values []interface{}) string {\n    s := make([]string, len(values)) // Pre-allocate the right size\n    for index := range values {\n        s[index] = fmt.Sprintf(\"%v\", values[index])\n    }\n    return strings.Join(s, \",\")\n}\n</code></pre>\n\n<p>This will work with any slice as <code>mySlice</code>, but on the way you lose a lot of convenience for the caller.</p>\n"}], "owner": {"reputation": 5435, "user_id": 1078503, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/00cb3812de2cb2d15f6e5d14c15e6ed8?s=128&d=identicon&r=PG", "display_name": "leiyonglin", "link": "https://stackoverflow.com/users/1078503/leiyonglin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6239, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1444449420, "creation_date": 1444447625, "question_id": 33049931, "link": "https://stackoverflow.com/questions/33049931/golang-how-to-get-element-from-the-interface-type-of-slice", "title": "golang - how to get element from the interface{} type of slice?", "body": "<p>I want to write a function that can convert slice([]int, []string, []bool, []int64, []float64) to string.</p>\n\n<pre><code>[]string{a,b,c} -&gt; a,b,c\n[]int{1,2,3}    -&gt; 1,2,3\n</code></pre>\n\n<p>There is my <a href=\"http://play.golang.org/p/QgwFJAsYwg\" rel=\"nofollow\">code</a>:</p>\n\n<pre><code>func sliceToString(itr interface{}) string {\n    switch itr.(type) {\n    case []string:\n        return strings.Join(itr.([]string), \",\")\n    case []int:\n        s := []string{}\n        for _, v := range itr.([]int) {\n            s = append(s, fmt.Sprintf(\"%v\", v))\n        }\n        return strings.Join(s, \",\")\n    case []int64:\n        s := []string{}\n        for _, v := range itr.([]int64) {\n            s = append(s, fmt.Sprintf(\"%v\", v))\n        }\n        return strings.Join(s, \",\")\n    case []float64:\n        s := []string{}\n        for _, v := range itr.([]float64) {\n            s = append(s, fmt.Sprintf(\"%v\", v))\n        }\n        return strings.Join(s, \",\")\n    case []bool:\n        s := []string{}\n        for _, v := range itr.([]bool) {\n            s = append(s, fmt.Sprintf(\"%v\", v))\n        }\n        return strings.Join(s, \",\")\n    }\n\n    return \"\"\n}\n</code></pre>\n\n<p>But it's a little complicated, if i can convert interface{}(type is slice) to []interface{} or get element , it's getting more simple.</p>\n\n<pre><code> func sliceToString(itr interface{}) string {\n    s := []string{}\n    // convert interface{} to []interface{} or get elements\n    // els := ...\n    for _,v:= range els{\n       s = append(s, fmt.Sprintf(\"%v\", v))\n    }\n    return s\n }\n</code></pre>\n"}, {"tags": ["go", "dbase"], "comments": [{"owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 0, "creation_date": 1444436072, "post_id": 33047686, "comment_id": 53918563, "body": "Do you get a stack trace when it crashes? What line of code is it executing?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user177800"}, "edited": false, "score": 0, "creation_date": 1444436431, "post_id": 33047686, "comment_id": 53918645, "body": "define <i>crashes</i> ..."}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 3966197, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/559991476/picture?type=large", "display_name": "Marian Montagnino", "link": "https://stackoverflow.com/users/3966197/marian-montagnino"}, "edited": false, "score": 0, "creation_date": 1485918078, "post_id": 33049361, "comment_id": 71120715, "body": "Thank you for your help!"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 2, "last_activity_date": 1444479523, "last_edit_date": 1444479523, "creation_date": 1444441047, "answer_id": 33049361, "question_id": 33047686, "link": "https://stackoverflow.com/questions/33047686/binary-read-returns-unexpected-eof-no-matter-what-dbase-dbf-file-i-use/33049361#33049361", "title": "binary.read returns &quot;unexpected EOF&quot; no matter what dBase (.dbf) File I use", "body": "<p>You have provided no evidence that your file format is correct. Before you wrote your program, you should have confirmed that you have the correct format for the file.</p>\n\n<p>What are the first 256 bytes of the file? For example,</p>\n\n<p><code>hex.go</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/hex\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"os\"\n    \"strconv\"\n)\n\nfunc main() {\n    if len(os.Args) &lt;= 1 {\n        fmt.Fprintln(os.Stderr, \"usage: hex filename [bytes]\")\n        return\n    }\n    data, err := ioutil.ReadFile(os.Args[1])\n    if err != nil {\n        fmt.Fprintln(os.Stderr, \"filename:\", err)\n        return\n    }\n    n := len(data)\n    if len(os.Args) &gt; 2 {\n        i, err := strconv.Atoi(os.Args[2])\n        if err != nil {\n            fmt.Fprintln(os.Stderr, \"bytes:\", err)\n            return\n        }\n        if n &gt; i {\n            n = i\n        }\n    }\n    fmt.Print(hex.Dump(data[:n]))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ go run hex.go example.dbf 256\n00000000  03 01 04 18 01 00 00 00  41 07 d0 05 00 00 00 00  |........A.......|\n00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 03 00 00  |................|\n00000020  54 52 41 43 4b 5f 49 44  00 00 00 43 01 00 00 00  |TRACK_ID...C....|\n00000030  0b 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000040  4c 4d 55 4c 54 00 00 00  00 00 00 4c 0c 00 00 00  |LMULT......L....|\n00000050  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000060  4e 54 41 58 59 45 41 52  00 00 00 4e 0d 00 00 00  |NTAXYEAR...N....|\n00000070  04 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n00000080  4e 43 4f 55 4e 54 59 43  4f 44 00 4e 11 00 00 00  |NCOUNTYCOD.N....|\n00000090  02 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n000000a0  43 50 52 4f 50 41 44 44  00 00 00 43 13 00 00 00  |CPROPADD...C....|\n000000b0  3c 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |&lt;...............|\n000000c0  4c 43 4f 4d 4d 49 4e 44  00 00 00 4c 4f 00 00 00  |LCOMMIND...LO...|\n000000d0  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n000000e0  4c 56 41 43 4c 41 4e 44  00 00 00 4c 50 00 00 00  |LVACLAND...LP...|\n000000f0  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n$\n</code></pre>\n\n<blockquote>\n  <p><a href=\"http://www.compkarori.com/dbase/bu12ce02.htm#The%20level%20and%20language%20of%20a%20table\" rel=\"nofollow\">The table level</a></p>\n  \n  <p>But what is the level of a table? The level means its version. The\n  dBASE table format is a standard that has evolved over time. When a\n  new version of dBASE made some improvements to that format, a new\n  format level number was given, identical to the new dBASE version. For\n  example, we have levels 3, 4, 5 and 7 corresponding to dBASE III,\n  dBASE IV, dBASE 5, and Visual dBASE 7. There is no level 6 because\n  there was no Visual dBASE 6.</p>\n  \n  <p>Level 7 brought many improvements. The field names can have up to 31\n  characters (from a maximum of 10 before). Some new fields types have\n  appeared (for example, the AutoIncrement field that makes nearly\n  impossible to give the same number to two records in the same table).\n  If your tables have to be used by other software, you might have to\n  sacrifice these advantages for the sake of compatibility, as few\n  applications can use a level 7 table.</p>\n</blockquote>\n\n<p>.dbf File Formats:</p>\n\n<p>The file header byte 0, bits 0-2 indicates the version number: 3 for dBASE Level 5, 4 for dBASE Level 7.</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/.dbf#Level_5_DOS_Headers\" rel=\"nofollow\">Level 5 DOS Headers</a></p>\n\n<p><a href=\"http://www.clicketyclick.dk/databases/xbase/format/dbf.html#DBF_STRUCT\" rel=\"nofollow\">Xbase Data file (*.dbf)</a></p>\n\n<p><a href=\"http://www.dbase.com/Knowledgebase/INT/db7_file_fmt.htm\" rel=\"nofollow\">dBASE Version 7 Table File</a></p>\n"}], "owner": {"reputation": 105, "user_id": 3966197, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/559991476/picture?type=large", "display_name": "Marian Montagnino", "link": "https://stackoverflow.com/users/3966197/marian-montagnino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 947, "favorite_count": 2, "accepted_answer_id": 33049361, "answer_count": 1, "score": 0, "last_activity_date": 1444479523, "creation_date": 1444427572, "last_edit_date": 1444436314, "question_id": 33047686, "link": "https://stackoverflow.com/questions/33047686/binary-read-returns-unexpected-eof-no-matter-what-dbase-dbf-file-i-use", "title": "binary.read returns &quot;unexpected EOF&quot; no matter what dBase (.dbf) File I use", "body": "<pre><code>func main() {\n        file, err := os.Open(\"example.dbf\") // For read access.\n        if err != nil {\n            log.Fatal(err)\n        }\n\n        dBaseioReader, err := NewReader(file)\n        if err != nil {\n            log.Fatal(err)\n        }\n        return nil\n}\n\ntype dbHeader struct {\n    Version             byte\n    LastUpdate          [3]byte\n    NumRecords          int32\n    NumBytesInHeader    int16\n    NumBytesInRecord    int16\n    _                   [2]byte //reserved\n    IncompatFlag        byte\n    EncryptionFlag      byte\n    MultiUserProcessing [12]byte\n    MDXProductionFlag   byte\n    LangDriverId        byte\n    _                   [2]byte //reserved\n    LangDriverName      [32]byte\n    _                   [4]byte //reserved\n}\n\n\ntype dbFieldDescriptor struct {\n    FieldName         [32]byte\n    FieldType         byte\n    FieldLen          byte\n    FieldDec          byte\n    _                 [2]byte\n    MDXProductionFlag byte\n    _                 [2]byte\n    NextAutoIncrement [4]byte\n    _                 [4]byte\n}\n\n\ntype DBaseReader struct {\n    rawInput *bufio.Reader\n    Header   *dbHeader\n    Fields   []*dbFieldDescriptor\n\n    recordsLeft int\n}\n\nfunc NewReader(input io.Reader) (dbr *DBaseReader, err error) {\n    dbr = &amp;DBaseReader{\n        rawInput: bufio.NewReaderSize(input, 32*1024),\n        Header:   &amp;dbHeader{},\n    }\n\n    err = binary.Read(dbr.rawInput, binary.LittleEndian, dbr.Header)\n    if err != nil{\n        return\n    }\n\n    dbr.recordsLeft = int(dbr.Header.NumRecords)\n\n    headerBytesLeft := dbr.Header.NumBytesInHeader\n    headerBytesLeft -= dbHeaderSize\n\n    // read field descriptors until 0x0D termination byte\n    var term []byte\n    for {\n        field := &amp;dbFieldDescriptor{}\n\n        err = binary.Read(dbr.rawInput, binary.LittleEndian, field)\n        if err != nil{\n            //FIRST CRASH HAPPENS HERE.\n            return\n        }\n\n        dbr.Fields = append(dbr.Fields, field)\n        headerBytesLeft -= dbFieldDescriptorSize\n\n        // check for terminator byte\n        term, err = dbr.rawInput.Peek(1)\n        if err != nil{\n            return\n        }\n\n        if term[0] == 0x0D {\n            break\n        }\n    }\n\n    // read the terminator\n    _, err = dbr.rawInput.ReadByte()\n    if err != nil {\n        return\n    }\n    headerBytesLeft -= 1\n\n    if headerBytesLeft &gt; 0 {\n        err = fmt.Errorf(\"Error: Header Bytes Left: %d.. Read Properties?!..\\n\", headerBytesLeft)\n        return\n\n        // headerLeftOver := make([]byte, headerBytesLeft)\n        // err = binary.Read(dbr.rawInput, binary.LittleEndian, headerLeftOver)\n        // if err != nil {\n        //  return\n        // }\n\n        // props := &amp;dbFieldProperties{}\n        // err = binary.Read(dbr.rawInput, binary.LittleEndian, props)\n        // if err != nil {\n        //  return\n        // }\n\n        // fmt.Printf(\"Props: %#v\\n\", props)\n    }\n\n    // read until first record marker\n    _, err = dbr.rawInput.ReadBytes(' ')\n    if err != nil {\n        return\n    }\n    return dbr, nil\n}\n</code></pre>\n\n<p>Above is the relevant code.  Program crashes no matter what example dbf file I use.  I'm not sure why I keep getting \"Unexpected EOF\" error.  I've been trying to figure this out over the past few days with no luck unfortunately.</p>\n"}, {"tags": ["go", "google-cloud-datastore"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1444425013, "creation_date": 1444425013, "answer_id": 33047210, "question_id": 33047118, "link": "https://stackoverflow.com/questions/33047118/where-does-this-function-return-non-error/33047210#33047210", "title": "Where does this function return non error?", "body": "<p>The default is to return <code>errFieldMismatch</code>, which is declared, but not initialized at the top of the function. </p>\n\n<p>If there isn't an <code>ErrFieldMismatch</code> at any point during the iteration, <code>errFieldMismatch</code> will still be <code>nil</code> at the end, thus <code>GetAll</code> will return a <code>nil</code> error.</p>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 33047210, "answer_count": 1, "score": -1, "last_activity_date": 1475211098, "creation_date": 1444424509, "last_edit_date": 1475211098, "question_id": 33047118, "link": "https://stackoverflow.com/questions/33047118/where-does-this-function-return-non-error", "title": "Where does this function return non error?", "body": "<p>I'm building a wrapper around the datastore <a href=\"https://github.com/golang/appengine/blob/master/datastore/query.go#L441\" rel=\"nofollow\"><code>GetAll</code></a> function and I have a hard time finding where this function returns a non-error. It seems to me that unless there is any other error (i.e. when it breaks on <a href=\"https://github.com/golang/appengine/blob/master/datastore/query.go#L464\" rel=\"nofollow\"><code>Done</code></a>) it returns <code>errFieldMismatch</code> which I think is not correct.</p>\n\n<pre><code>func (q *Query) GetAll(c context.Context, dst interface{}) ([]*Key, error) {\n    var (\n        dv               reflect.Value\n        mat              multiArgType\n        elemType         reflect.Type\n        errFieldMismatch error\n    )\n    if !q.keysOnly {\n        dv = reflect.ValueOf(dst)\n        if dv.Kind() != reflect.Ptr || dv.IsNil() {\n            return nil, ErrInvalidEntityType\n        }\n        dv = dv.Elem()\n        mat, elemType = checkMultiArg(dv)\n        if mat == multiArgTypeInvalid || mat == multiArgTypeInterface {\n            return nil, ErrInvalidEntityType\n        }\n    }\n\n    var keys []*Key\n    for t := q.Run(c); ; {\n        k, e, err := t.next()\n        if err == Done {\n            break\n        }\n        if err != nil {\n            return keys, err\n        }\n        if !q.keysOnly {\n            ev := reflect.New(elemType)\n            if elemType.Kind() == reflect.Map {\n                // This is a special case. The zero values of a map type are\n                // not immediately useful; they have to be make'd.\n                //\n                // Funcs and channels are similar, in that a zero value is not useful,\n                // but even a freshly make'd channel isn't useful: there's no fixed\n                // channel buffer size that is always going to be large enough, and\n                // there's no goroutine to drain the other end. Theoretically, these\n                // types could be supported, for example by sniffing for a constructor\n                // method or requiring prior registration, but for now it's not a\n                // frequent enough concern to be worth it. Programmers can work around\n                // it by explicitly using Iterator.Next instead of the Query.GetAll\n                // convenience method.\n                x := reflect.MakeMap(elemType)\n                ev.Elem().Set(x)\n            }\n            if err = loadEntity(ev.Interface(), e); err != nil {\n                if _, ok := err.(*ErrFieldMismatch); ok {\n                    // We continue loading entities even in the face of field mismatch errors.\n                    // If we encounter any other error, that other error is returned. Otherwise,\n                    // an ErrFieldMismatch is returned.\n                    errFieldMismatch = err\n                } else {\n                    return keys, err\n                }\n            }\n            if mat != multiArgTypeStructPtr {\n                ev = ev.Elem()\n            }\n            dv.Set(reflect.Append(dv, ev))\n        }\n        keys = append(keys, k)\n    }\n    return keys, errFieldMismatch\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1444434030, "post_id": 33047091, "comment_id": 53918112, "body": "What makes embedding insufficient? Whatever superclass functionality you want, you should be able to implement without duplication by defining a type that has a common subset of fields, putting the methods that deal with them there and then embedding it in the types that would inherit in a subclass-superclass relationship. While the relationship between the types is inverted, there is afaik, nothing preventing the same exact functionality with embedding."}, {"owner": {"reputation": 23, "user_id": 5429110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4cf559fb999931b69c823690f2579d4?s=128&d=identicon&r=PG&f=1", "display_name": "user5429110", "link": "https://stackoverflow.com/users/5429110/user5429110"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1444581229, "post_id": 33047091, "comment_id": 53953192, "body": "See the clarification edit and/or my response to Darkstar for why embedding isn&#39;t going to fulfill what I need.  Thanks, though!"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5429110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4cf559fb999931b69c823690f2579d4?s=128&d=identicon&r=PG&f=1", "display_name": "user5429110", "link": "https://stackoverflow.com/users/5429110/user5429110"}, "edited": false, "score": 0, "creation_date": 1444581167, "post_id": 33058453, "comment_id": 53953168, "body": "I thought that&#39;s what my last example was attempting to do, unless you mean a &quot;nested&quot; interface."}, {"owner": {"reputation": 1288, "user_id": 1876626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e81a0d90315dfb0b3f64c0936a34699e?s=128&d=identicon&r=PG", "display_name": "Joonazan", "link": "https://stackoverflow.com/users/1876626/joonazan"}, "reply_to_user": {"reputation": 23, "user_id": 5429110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4cf559fb999931b69c823690f2579d4?s=128&d=identicon&r=PG&f=1", "display_name": "user5429110", "link": "https://stackoverflow.com/users/5429110/user5429110"}, "edited": false, "score": 0, "creation_date": 1444656122, "post_id": 33058453, "comment_id": 53980852, "body": "Yes, I mean having two interfaces."}], "tags": [], "owner": {"reputation": 1288, "user_id": 1876626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e81a0d90315dfb0b3f64c0936a34699e?s=128&d=identicon&r=PG", "display_name": "Joonazan", "link": "https://stackoverflow.com/users/1876626/joonazan"}, "is_accepted": false, "score": 0, "last_activity_date": 1444507554, "creation_date": 1444507554, "answer_id": 33058453, "question_id": 33047091, "link": "https://stackoverflow.com/questions/33047091/golang-code-duplication-and-similar-structs/33058453#33058453", "title": "Golang: code duplication and similar structs", "body": "<p>If you have the problem that the types of some things are different, you could make the <code>Time</code> and <code>User</code> functions operate on an interface that wraps linux and bsd functionality.</p>\n\n<p>If you don't like that, you can generate the code to avoid duplication.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 5429110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4cf559fb999931b69c823690f2579d4?s=128&d=identicon&r=PG&f=1", "display_name": "user5429110", "link": "https://stackoverflow.com/users/5429110/user5429110"}, "edited": false, "score": 0, "creation_date": 1444580791, "post_id": 33064198, "comment_id": 53953068, "body": "The &quot;rest&quot; of the story (and also in partial answer to @evanmcdonnal )is that I&#39;m using encoding/binary.Read(...) to parse these structs from a buffer.  They have to be in the struct in precisely the order they are on-disk.  As this practice will feed to other structures and endianness, I&#39;d really rather not reimplement that function, but suppose I could copy data once read.  Not sure which is the greater evil - gratuitous data copying or excessively duplicated code."}, {"owner": {"reputation": 1053, "user_id": 3608492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68e469e0555fc5221b227deb0d9a305a?s=128&d=identicon&r=PG&f=1", "display_name": "Satyen Rai", "link": "https://stackoverflow.com/users/3608492/satyen-rai"}, "reply_to_user": {"reputation": 23, "user_id": 5429110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4cf559fb999931b69c823690f2579d4?s=128&d=identicon&r=PG&f=1", "display_name": "user5429110", "link": "https://stackoverflow.com/users/5429110/user5429110"}, "edited": false, "score": 0, "creation_date": 1444581680, "post_id": 33064198, "comment_id": 53953326, "body": "@user5429110: Edited after reading your response more closely. You can read the data in a buffer struct that matches the format you need and copy the fields to the final structs. In case your application is very performance sensitive and can&#39;t tolerate the overhead of copying, you could have the final structs hold references to the actual data read in the buffer instead of copying. Since Go uses automatic GC, you don&#39;t need to worry about the memory management issues an approach like this would gave caused."}, {"owner": {"reputation": 23, "user_id": 5429110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4cf559fb999931b69c823690f2579d4?s=128&d=identicon&r=PG&f=1", "display_name": "user5429110", "link": "https://stackoverflow.com/users/5429110/user5429110"}, "edited": false, "score": 0, "creation_date": 1444586223, "post_id": 33064198, "comment_id": 53954755, "body": "Good point; I&#39;ll check that out.  I don&#39;t expect this code to be too terribly performance critical, but people rarely do."}], "tags": [], "owner": {"reputation": 1053, "user_id": 3608492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68e469e0555fc5221b227deb0d9a305a?s=128&d=identicon&r=PG&f=1", "display_name": "Satyen Rai", "link": "https://stackoverflow.com/users/3608492/satyen-rai"}, "is_accepted": true, "score": 0, "last_activity_date": 1444561240, "creation_date": 1444561240, "answer_id": 33064198, "question_id": 33047091, "link": "https://stackoverflow.com/questions/33047091/golang-code-duplication-and-similar-structs/33064198#33064198", "title": "Golang: code duplication and similar structs", "body": "<p>I don't understand your comment about embedding. Here is how I'd do it (using embedding):</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package test\n\nimport \"time\"\n\ntype Utmp struct {\n    // Common fields\n}\n\nfunc (u Utmp) User() {\n    return string(l.ut_user[:])\n}\n\ntype LinuxUtmp struct {\n    Utmp\n    // Linux specific fields\n}\n\nfunc (l LinuxUtmp) Time() time.Time {\n    return time.Unix(int64(l.tv_sec), int64(l.tv_usec))\n}\n\ntype BsdUtmp struct {\n    Utmp\n    // BSD specific fields\n}\n\nfunc (b BsdUtmp) Time() time.Time {\n    return time.Unix(int64(b.ut_time), 0)\n}\n</code></pre>\n\n<p>Any code importing the library can call <code>User()</code> method directly on <code>LinuxUtmp</code> and <code>BsdUtmp</code> objects directly as <code>l.User()</code> or <code>b.User()</code> without mentioning <code>Utmp</code> at all. You can even keep <code>Utmp</code> unexpected (as <code>utmp</code>) if you like.</p>\n\n<p>Check out <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow\">Effective Go</a> for details.</p>\n\n<p>You can even ensure that only the code meant for the relevant platform gets compiled in the binary, if you like. <a href=\"http://blog.ralch.com/tutorial/golang-conditional-compilation/\" rel=\"nofollow\">This blog</a> has got some examples. In the interest of keeping things simple, I wouldn't bother going down that route if the platform specific code is not very big or there are other factors involved.</p>\n\n<p>For the sake of completeness, here is the official <a href=\"https://golang.org/pkg/go/build/\" rel=\"nofollow\">go build</a> doc.</p>\n"}], "owner": {"reputation": 23, "user_id": 5429110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4cf559fb999931b69c823690f2579d4?s=128&d=identicon&r=PG&f=1", "display_name": "user5429110", "link": "https://stackoverflow.com/users/5429110/user5429110"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1177, "favorite_count": 0, "accepted_answer_id": 33064198, "answer_count": 2, "score": 2, "last_activity_date": 1444581091, "creation_date": 1444424379, "last_edit_date": 1444581091, "question_id": 33047091, "link": "https://stackoverflow.com/questions/33047091/golang-code-duplication-and-similar-structs", "title": "Golang: code duplication and similar structs", "body": "<p>What's an idiomatic way in Go to superclass similar (but not identical) data types in order to minimize code duplication?  Trite example:</p>\n\n<pre><code>import \"time\"\n\ntype LinuxUtmp struct {\n    ut_type uint16\n    _       [2]byte\n    ut_pid  uint32\n    ut_line [32]byte\n    ut_id   [4]byte\n    ut_user [32]byte\n    ut_host [256]byte\n    exit_status [2]uint32\n    tv_sec  uint32\n    tv_usec uint32\n    ...\n}\n\nfunc (l LinuxUtmp) User() string {\n    return string(l.ut_user[:])\n}\n\nfunc (l LinuxUtmp) Time() time.Time {\n    return time.Unix(int64(l.tv_sec), int64(l.tv_usec))\n}\n\ntype BsdUtmp struct {\n    ut_line [8]char\n    ut_name [16]char\n    ut_host [16]char\n    ut_time uint32\n}\n\nfunc (b BsdUtmp) User() string {\n    return string(b.ut_user[:])\n}\n\nfunc (b BsdUtmp) Time() time.Time {\n    return time.Unix(int64(b.ut_time), 0)\n}\n</code></pre>\n\n<p>Obviously there's more to it than that, but I'd love to be able to somehow superclass those so I only have to write and maintain one copy of particular functions.  An interface seems to be the \"right\" way, but that leaves much to be desired (non-working example):</p>\n\n<pre><code>type Utmp interface {\n    Time() time.Time\n}\n\nfunc User(u Utmp) string {\n    return string(u.ut_user[:])\n}\n</code></pre>\n\n<p>I've also considered embedding, but that seems a dead end too since Go is so strictly typed.  Am I doomed to have multiple pieces of code that are identical in every way but the signature?</p>\n\n<p>[edit]</p>\n\n<p>Part of the complication is that I'm using encoding/binary.Read() to parse this data according to endianness (it's not just utmp records and not just Linux/BSD).  To use that, the fields must be [exported] in the struct in the precise order they are on-disk.  Hence I can't just embed the fields of another struct, as in some records they're in different order (and of differing sizes)</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 7826, "user_id": 51923, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/7a491ebe0536e388a07b5a726247bab2?s=128&d=identicon&r=PG", "display_name": "deepblue", "link": "https://stackoverflow.com/users/51923/deepblue"}, "edited": false, "score": 0, "creation_date": 1444418453, "post_id": 33045657, "comment_id": 53912191, "body": "damn it, right! mgo is an external package :) thank you"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1444423874, "post_id": 33045657, "comment_id": 53914827, "body": "To build on this - you should name your fields according to Go conventions - <code>UserSessionID</code> or <code>GoogleAnalyPixelID</code> - and use the struct tags (as you have) if your database expects <code>snake_case</code>."}, {"owner": {"reputation": 1315, "user_id": 7133623, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oTRkmNT7RVY/AAAAAAAAAAI/AAAAAAAABjU/A9o9mSGxL60/photo.jpg?sz=128", "display_name": "cdimitroulas", "link": "https://stackoverflow.com/users/7133623/cdimitroulas"}, "edited": false, "score": 0, "creation_date": 1530140645, "post_id": 33045657, "comment_id": 89134773, "body": "what happens if you want a field with an uppercase letter?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 1315, "user_id": 7133623, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oTRkmNT7RVY/AAAAAAAAAAI/AAAAAAAABjU/A9o9mSGxL60/photo.jpg?sz=128", "display_name": "cdimitroulas", "link": "https://stackoverflow.com/users/7133623/cdimitroulas"}, "edited": false, "score": 0, "creation_date": 1530140816, "post_id": 33045657, "comment_id": 89134804, "body": "@cdimitroulas The first character must be uppercase.  All other characters can be upper or lower."}, {"owner": {"reputation": 1315, "user_id": 7133623, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oTRkmNT7RVY/AAAAAAAAAAI/AAAAAAAABjU/A9o9mSGxL60/photo.jpg?sz=128", "display_name": "cdimitroulas", "link": "https://stackoverflow.com/users/7133623/cdimitroulas"}, "edited": false, "score": 0, "creation_date": 1531168817, "post_id": 33045657, "comment_id": 89486326, "body": "so it&#39;s not possible to have a field with all lowercase characters?? Isn&#39;t this a huge limitation of the library? What is you work with existing data with has fieldnames which are all lower case?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1531170040, "post_id": 33045657, "comment_id": 89486849, "body": "The field name in the database can be specified using a field tags.  There are no restrictions on the case of the names used in the field tag.  The code in this answer uses lowercase field names in the db."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 7, "last_activity_date": 1444418461, "last_edit_date": 1444418461, "creation_date": 1444418374, "answer_id": 33045657, "question_id": 33045404, "link": "https://stackoverflow.com/questions/33045404/golang-mongodb-mgo-is-not-inserting-docs/33045657#33045657", "title": "golang mongodb (mgo) is not inserting docs", "body": "<p>You need to <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"noreferrer\">export</a> the fields by starting the field name with a capital letter.</p>\n\n<pre><code>type AN_Track_Log struct {\n  Id                       bson.ObjectId `bson:\"_id,omitempty\"`\n  User_session_id_str      string       `bson:\"user_session_id_str\"`\n\n  Googleanaly_pixel_id_str string `bson:\"googleanaly_pixel_id_str\"`\n  ...\n}\n</code></pre>\n"}], "owner": {"reputation": 7826, "user_id": 51923, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/7a491ebe0536e388a07b5a726247bab2?s=128&d=identicon&r=PG", "display_name": "deepblue", "link": "https://stackoverflow.com/users/51923/deepblue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1566, "favorite_count": 1, "accepted_answer_id": 33045657, "answer_count": 1, "score": 4, "last_activity_date": 1444418461, "creation_date": 1444417266, "question_id": 33045404, "link": "https://stackoverflow.com/questions/33045404/golang-mongodb-mgo-is-not-inserting-docs", "title": "golang mongodb (mgo) is not inserting docs", "body": "<p>Im having issues with persisting a golang struct in mongodb using mgo.   </p>\n\n<pre><code>type AN_Track_Log struct {\n    Id                       bson.ObjectId `bson:\"_id,omitempty\"`\n    user_session_id_str      string       `bson:\"user_session_id_str\"`\n\n    googleanaly_pixel_id_str string `bson:\"googleanaly_pixel_id_str\"`\n    perfaud_pixel_id_str     string `bson:\"perfaud_pixel_id_str\"`\n    site_id_str              string `bson:\"site_id_str\"`\n    metric_str               string `bson:\"metric_str\"`\n    value_str                string `bson:\"value_str\"`\n    event_str                string `bson:\"event_str\"`\n    location_id_str          string `bson:\"location_id_str\"`\n    referer_str              string `bson:\"referer_str\"`\n    track_origin_str         string `bson:\"track_origin_str\"`\n    fingerprint_str          string `bson:\"fingerprint_str\"`\n    ...\n}\n\np_track_log.Id = bson.NewObjectId()\nerr := p_mongodb_coll.Insert(&amp;p_track_log)\n</code></pre>\n\n<p>the problem is that when the Insert() call completes, the only thing thats persisted in the DB is an empty doc</p>\n\n<pre><code>{u'_id': ObjectId('561809d20037873154000003')}\n</code></pre>\n\n<p>I check that the struct fields are indeed set, and not empty. \nAny ideas as to why this is happening. \nHints are appreciated :) thank you</p>\n"}, {"tags": ["go", "socks"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1444406009, "post_id": 33042457, "comment_id": 53905732, "body": "Perhaps also useful: <a href=\"https://github.com/golang/go/wiki/GoGetProxyConfig\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/GoGetProxyConfig</a>"}, {"owner": {"reputation": 183, "user_id": 2826143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/213c5a9410ae6f1b7574189804dfdd6c?s=128&d=identicon&r=PG&f=1", "display_name": "AaronS", "link": "https://stackoverflow.com/users/2826143/aarons"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1444409355, "post_id": 33042457, "comment_id": 53907599, "body": "@TimCooper Thanks for your first link! In fact I&#39;ve looked at that question but didn&#39;t read the comments carefully:).  Anyway, privoxy is exactly what I need."}], "owner": {"reputation": 183, "user_id": 2826143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/213c5a9410ae6f1b7574189804dfdd6c?s=128&d=identicon&r=PG&f=1", "display_name": "AaronS", "link": "https://stackoverflow.com/users/2826143/aarons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "closed_date": 1444407096, "answer_count": 0, "score": 0, "last_activity_date": 1444405842, "creation_date": 1444405842, "question_id": 33042457, "link": "https://stackoverflow.com/questions/33042457/redirect-go-get-to-use-socks", "closed_reason": "Duplicate", "title": "Redirect &#39;go get&#39; to use SOCKS", "body": "<p>I need proxy to download packages from golang.org. I have a SOCKS server myself, and need to direct 'go get' to connect through it. But I've tried tsocks and proxychains and they both don't help. How can I resolve this?</p>\n"}, {"tags": ["go", "visual-studio-code", "args"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444404815, "post_id": 33042017, "comment_id": 53904944, "body": "It looks like it&#39;s not getting a &quot;test&quot; argument. Can you check the actual command that is executed ?"}, {"owner": {"reputation": 1520, "user_id": 117859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/E80kd.png?s=128&g=1", "display_name": "Mattl", "link": "https://stackoverflow.com/users/117859/mattl"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444404867, "post_id": 33042017, "comment_id": 53904986, "body": "Without the args it runs &quot;go test&quot;. With the args in place it runs &quot;go ./...&quot;."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444405294, "post_id": 33042017, "comment_id": 53905261, "body": "I would imagine you need <code>[&quot;test&quot;, &quot;.&#47;...&quot;]</code>."}, {"owner": {"reputation": 1520, "user_id": 117859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/E80kd.png?s=128&g=1", "display_name": "Mattl", "link": "https://stackoverflow.com/users/117859/mattl"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444405407, "post_id": 33042017, "comment_id": 53905322, "body": "That&#39;s the other weird thing, adding test to the args as per above returns &quot;can&#39;t load package: package test: cannot find package &quot;test&quot;&quot;"}, {"owner": {"reputation": 698, "user_id": 2134614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73fa65b72233733b6aae68bc370ed9f7?s=128&d=identicon&r=PG", "display_name": "GJSmith3rd", "link": "https://stackoverflow.com/users/2134614/gjsmith3rd"}, "edited": false, "score": 0, "creation_date": 1444757411, "post_id": 33042017, "comment_id": 54032399, "body": "Reverse the task and args for a hack."}], "answers": [{"tags": [], "owner": {"reputation": 698, "user_id": 2134614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73fa65b72233733b6aae68bc370ed9f7?s=128&d=identicon&r=PG", "display_name": "GJSmith3rd", "link": "https://stackoverflow.com/users/2134614/gjsmith3rd"}, "is_accepted": true, "score": 0, "last_activity_date": 1444757291, "last_edit_date": 1592644375, "creation_date": 1444756189, "answer_id": 33108609, "question_id": 33042017, "link": "https://stackoverflow.com/questions/33042017/visual-studio-code-task-argument/33108609#33108609", "title": "Visual Studio Code Task Argument", "body": "<h1>THIS MAY BE A BUG</h1>\n<hr />\n<h2>VSCode Reverse Args and Task as of v0.8.0</h2>\n<p>This may be a bug that still persists in the newer versions.  As of v0.9.1 I have not had a chance to test.  Prior to 0.9.1  at least one hack worked by reversing the task and it's arg as in the following example:</p>\n<pre><code>{\n&quot;version&quot;: &quot;0.1.0&quot;,\n&quot;command&quot;: &quot;go&quot;,\n\n&quot;tasks&quot;: [\n    {\n        &quot;taskName&quot;: &quot;build&quot;,\n        &quot;isBuildCommand&quot;: true\n    },\n    {\n        &quot;taskName&quot;: &quot;./...&quot;,\n        &quot;isTestCommand&quot;: true,\n        &quot;args&quot;: [&quot;test&quot;]\n    }\n  ]\n}\n</code></pre>\n<p>It's hard to believe that this has still persisted until v0.8.0 so there may be a preferred solution that I have not discovered.</p>\n<p>Here is a link to a prior post that deals with a similar issue:</p>\n<p><a href=\"https://stackoverflow.com/questions/30046411/define-multiple-tasks-in-vscode/31543908#31543908\">Define multiple tasks in VSCode</a></p>\n<p>Scroll down to my answer for more explanation.</p>\n"}], "owner": {"reputation": 1520, "user_id": 117859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/E80kd.png?s=128&g=1", "display_name": "Mattl", "link": "https://stackoverflow.com/users/117859/mattl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1255, "favorite_count": 0, "accepted_answer_id": 33108609, "answer_count": 1, "score": 2, "last_activity_date": 1444757291, "creation_date": 1444404348, "question_id": 33042017, "link": "https://stackoverflow.com/questions/33042017/visual-studio-code-task-argument", "title": "Visual Studio Code Task Argument", "body": "<p>I'm trying to create some tasks in Visual Studio Code to run all the tests in my go project.</p>\n\n<p>I usually execute the tests on the command line using:</p>\n\n<pre><code>go test ./...\n</code></pre>\n\n<p>In Visual Studio Code my tasks.json looks like this:</p>\n\n<pre><code>{\n    \"version\": \"0.1.0\",\n    \"command\": \"go\",\n\n    \"tasks\": [\n        {\n            \"taskName\": \"build\",\n            \"isBuildCommand\": true\n        },\n        {\n            \"taskName\": \"test\",\n            \"isTestCommand\": true,\n            \"args\": [\"./...\"]\n        }\n    ]\n}\n</code></pre>\n\n<p>So Build works fine (CTRL + SHIFT + B)</p>\n\n<p>But when I try to run the tests (CTRL + SHIFT + T) the following error occurs:</p>\n\n<pre><code>go: unknown subcommand \"./...\"\n</code></pre>\n\n<p>It seems to be omitting the \"test\" param, but when I comment out the args it runs go test fine.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["mysql", "go", "sqlx"], "comments": [{"owner": {"reputation": 2644, "user_id": 956548, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1aae6638a9e6c445a90467bc045071ab?s=128&d=identicon&r=PG", "display_name": "ravnur", "link": "https://stackoverflow.com/users/956548/ravnur"}, "edited": false, "score": 0, "creation_date": 1444402280, "post_id": 33041063, "comment_id": 53903198, "body": "do you want to do it on &quot;server&quot; side or on mysql side?"}, {"owner": {"reputation": 6885, "user_id": 539115, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/agxrQ.jpg?s=128&g=1", "display_name": "Sanjit Saluja", "link": "https://stackoverflow.com/users/539115/sanjit-saluja"}, "reply_to_user": {"reputation": 2644, "user_id": 956548, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1aae6638a9e6c445a90467bc045071ab?s=128&d=identicon&r=PG", "display_name": "ravnur", "link": "https://stackoverflow.com/users/956548/ravnur"}, "edited": false, "score": 0, "creation_date": 1444402501, "post_id": 33041063, "comment_id": 53903357, "body": "Server side is preferrable."}, {"owner": {"reputation": 2644, "user_id": 956548, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1aae6638a9e6c445a90467bc045071ab?s=128&d=identicon&r=PG", "display_name": "ravnur", "link": "https://stackoverflow.com/users/956548/ravnur"}, "edited": false, "score": 0, "creation_date": 1444402908, "post_id": 33041063, "comment_id": 53903642, "body": "if you are implementing your project right now. you can create one entry point in your application where sqlx used. you can do logging there. is it works for you?"}, {"owner": {"reputation": 6885, "user_id": 539115, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/agxrQ.jpg?s=128&g=1", "display_name": "Sanjit Saluja", "link": "https://stackoverflow.com/users/539115/sanjit-saluja"}, "reply_to_user": {"reputation": 2644, "user_id": 956548, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1aae6638a9e6c445a90467bc045071ab?s=128&d=identicon&r=PG", "display_name": "ravnur", "link": "https://stackoverflow.com/users/956548/ravnur"}, "edited": false, "score": 1, "creation_date": 1444403091, "post_id": 33041063, "comment_id": 53903791, "body": "There are a lot of places we are calling sqlx APIs. That is not a very appealing solution for me."}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 7062932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6ctGTCCX6kw/AAAAAAAAAAI/AAAAAAAAIkQ/9UGDL-KOqVo/photo.jpg?sz=128", "display_name": "Ram Ashish Pal", "link": "https://stackoverflow.com/users/7062932/ram-ashish-pal"}, "edited": false, "score": 0, "creation_date": 1547016595, "post_id": 33042034, "comment_id": 95041373, "body": "I&#39;m stuck on queries with arguments like: (&quot;select * from item where id=?&quot;, nId). I&#39;m getting result like: select * from item where id=?%!(EXTRA int=2). Logger.Printf doesn&#39;t understand character &#39;?&#39;. Please help."}, {"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "reply_to_user": {"reputation": 143, "user_id": 7062932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6ctGTCCX6kw/AAAAAAAAAAI/AAAAAAAAIkQ/9UGDL-KOqVo/photo.jpg?sz=128", "display_name": "Ram Ashish Pal", "link": "https://stackoverflow.com/users/7062932/ram-ashish-pal"}, "edited": false, "score": 0, "creation_date": 1547030125, "post_id": 33042034, "comment_id": 95048288, "body": "@RamAshishPal I provided a very basic implementation of such logging. If you want to substitute &#39;?&#39; arguments with the actual values, you&#39;ll have to parse SQL strings manually and do the replacement yourself. If you need help writing a function for this, you should ask a new question."}], "tags": [], "owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "is_accepted": true, "score": 13, "last_activity_date": 1444404929, "last_edit_date": 1444404929, "creation_date": 1444404412, "answer_id": 33042034, "question_id": 33041063, "link": "https://stackoverflow.com/questions/33041063/how-can-i-log-all-outgoing-sql-statements-from-go-mysql/33042034#33042034", "title": "How can I log all outgoing SQL statements from Go / MySQL?", "body": "<p>sqlx has a very interesting abstraction in the form of the following interfaces:</p>\n\n<ul>\n<li><a href=\"https://godoc.org/github.com/jmoiron/sqlx#Execer\" rel=\"noreferrer\">sqlx.Execer</a></li>\n<li><a href=\"https://godoc.org/github.com/jmoiron/sqlx#Queryer\" rel=\"noreferrer\">sqlx.Queryer</a></li>\n</ul>\n\n<p>They are used all through the library as the interfaces representing the functionality of using strings as SQL queries.</p>\n\n<p>For example:</p>\n\n<pre><code>db, err := sqlx.Connect(\"postgres\", \"user=foo dbname=bar sslmode=disable\")\nif err != nil {\n    log.Fatalln(err)\n}\n\n// exec the schema or fail; multi-statement Exec behavior varies between\n// database drivers;  pq will exec them all, sqlite3 won't, ymmv\ndb.MustExec(\"CREATE TABLE person (first_name text)\")\n</code></pre>\n\n<p>The last line is in fact equivalent to:</p>\n\n<pre><code>sqlx.MustExec(db, \"CREATE TABLE person (first_name text)\")\n</code></pre>\n\n<p>Where <code>db</code> is used as an <code>Execer</code>.</p>\n\n<p>In the same vein, this:</p>\n\n<pre><code>people := []Person{}\ndb.Select(&amp;people, \"SELECT * FROM person ORDER BY first_name ASC\")\n</code></pre>\n\n<p>is equivalent to:</p>\n\n<pre><code>sqlx.Select(db, &amp;people, \"SELECT * FROM person ORDER BY first_name ASC\")\n</code></pre>\n\n<p>where <code>db</code> is used as a <code>Queryer</code>.</p>\n\n<p>So if you are willing not to use the <code>DB</code> type directly but instead use the underlying free functions of the library, you can use the following structure to wrap your <code>db</code> into objects that perform logging:</p>\n\n<pre><code>type QueryLogger struct {\n    queryer sqlx.Queryer\n    logger  *log.Logger\n}\n\nfunc (p *QueryLogger) Query(query string, args ...interface{}) (*sql.Rows, error) {\n    p.logger.Print(query, args...)\n    return p.queryer.Query(query, args...)\n}\n\nfunc (p *QueryLogger) Queryx(query string, args ...interface{}) (*Rows, error) {\n    p.logger.Print(query, args...)\n    return p.queryer.Queryx(query, args...)\n}\n\nfunc (p *QueryLogger) QueryRowx(query string, args ...interface{}) *Row {\n    p.logger.Print(query, args...)\n    return p.queryer.QueryRowx(query, args...)\n}\n</code></pre>\n\n<p>And when connecting to your database:</p>\n\n<pre><code>db, err := sqlx.Connect(\"postgres\", \"user=foo dbname=bar sslmode=disable\")\nif err != nil {\n    log.Fatalln(err)\n}\n\nql := &amp;QueryLogger{db, yourLogger}\n\nsqlx.Select(ql, &amp;people, \"SELECT * FROM person ORDER BY first_name ASC\")\n</code></pre>\n\n<p>Of course this only works when using the free functions of the sqlx library, so if your code has a large amount of calls using the sqlx.DB type, this will probably not be convenient enough.</p>\n"}], "owner": {"reputation": 6885, "user_id": 539115, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/agxrQ.jpg?s=128&g=1", "display_name": "Sanjit Saluja", "link": "https://stackoverflow.com/users/539115/sanjit-saluja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8943, "favorite_count": 4, "accepted_answer_id": 33042034, "answer_count": 1, "score": 13, "last_activity_date": 1444404929, "creation_date": 1444401598, "question_id": 33041063, "link": "https://stackoverflow.com/questions/33041063/how-can-i-log-all-outgoing-sql-statements-from-go-mysql", "title": "How can I log all outgoing SQL statements from Go / MySQL?", "body": "<p>I'm using a non-framework Go stack with <a href=\"https://github.com/jmoiron/sqlx\" rel=\"noreferrer\">sqlx</a>, and <a href=\"https://github.com/go-sql-driver/mysql\" rel=\"noreferrer\">MySQL</a> for a web project. </p>\n\n<p>I would like to log all outgoing SQL statements for debugging. Is it possible to do this? Hopefully looking to get output like this (copied from a Rails project):</p>\n\n<pre><code>  User Load (94.4ms)  SELECT `users`.* FROM `users` WHERE `users`.`login` = 'bondnewyork' LIMIT 1\n  User Load (16.3ms)  SELECT `users`.* FROM `users` WHERE `users`.`login` = 'mkovarik' LIMIT 1\n  User Load (0.3ms)  SELECT `users`.* FROM `users` WHERE `users`.`login` = 'mkovarik' LIMIT 1\n  User Load (0.3ms)  SELECT `users`.* FROM `users` ORDER BY `users`.`id` DESC LIMIT 1\n  User Load (0.4ms)  SELECT `users`.* FROM `users` ORDER BY `users`.`id` DESC LIMIT 1\n</code></pre>\n"}, {"tags": ["ssh", "go"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 2, "last_activity_date": 1444425242, "last_edit_date": 1444425242, "creation_date": 1444411319, "answer_id": 33043933, "question_id": 33040563, "link": "https://stackoverflow.com/questions/33040563/reverse-ssh-with-golang/33043933#33043933", "title": "Reverse SSH with golang", "body": "<p>You use <a href=\"https://godoc.org/golang.org/x/crypto/ssh#Client.Listen\" rel=\"nofollow\"><code>Client.Listen</code></a> (or <a href=\"https://godoc.org/golang.org/x/crypto/ssh#Client.ListenTCP\" rel=\"nofollow\"><code>Client.ListenTCP</code></a>) to setup the forwarding port on the server.</p>\n\n<p>You can then accept connections from the returned listener just as you would any other network listener. </p>\n"}, {"comments": [{"owner": {"reputation": 485, "user_id": 829078, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/456e1a7ba2d8a5526da9f782ae8475bd?s=128&d=identicon&r=PG", "display_name": "Anton", "link": "https://stackoverflow.com/users/829078/anton"}, "edited": false, "score": 0, "creation_date": 1479748311, "post_id": 33052259, "comment_id": 68678577, "body": "Hey, I tried your server_complex.go, it does not work, I get the error: 2016/11/21 16:56:04 new ssh connection from 193.40.242.84:53374 (SSH-2.0-Go) 2016/11/21 16:56:04 recieved out-of-band request: &amp;{Type:tcpip-forward WantReply:true Payload:[0 0 0 7 48 46 48 46 48 46 48 0 0 85 241] ch:&lt;nil&gt; mux:0x105675c0}"}], "tags": [], "owner": {"reputation": 735, "user_id": 2162742, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7b67fb1eacc7bda976b1856af6ffbec8?s=128&d=identicon&r=PG", "display_name": "arkhon", "link": "https://stackoverflow.com/users/2162742/arkhon"}, "is_accepted": true, "score": 3, "last_activity_date": 1444468259, "creation_date": 1444468259, "answer_id": 33052259, "question_id": 33040563, "link": "https://stackoverflow.com/questions/33040563/reverse-ssh-with-golang/33052259#33052259", "title": "Reverse SSH with golang", "body": "<p>I found a solution. OpenSSH returns a terminal session or the output of a command if you supply one. Furthermore it allows you to authenticate the connection from the server to the client over the open tunnel. </p>\n\n<p>To support this behavior I needed to supply the listener of the open connection to a ssh server implementet in go on the remote side. More complicated then I thought but it works.</p>\n\n<p>I got a working example server <a href=\"https://github.com/Scalingo/go-ssh-examples\" rel=\"nofollow\">here</a>. I just need to exchange the listener in the example code for a listener on the client connection.</p>\n"}], "owner": {"reputation": 735, "user_id": 2162742, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7b67fb1eacc7bda976b1856af6ffbec8?s=128&d=identicon&r=PG", "display_name": "arkhon", "link": "https://stackoverflow.com/users/2162742/arkhon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1851, "favorite_count": 0, "accepted_answer_id": 33052259, "answer_count": 2, "score": 5, "last_activity_date": 1444468259, "creation_date": 1444400110, "last_edit_date": 1444400354, "question_id": 33040563, "link": "https://stackoverflow.com/questions/33040563/reverse-ssh-with-golang", "title": "Reverse SSH with golang", "body": "<p>I have a server and a remote computer. Now I want to access the remote computer via SSH but it is possible that it is behind a NAT. That's one of the reasons I want a reverse SSH connection.</p>\n\n<p>The idea is to establish a connection from the remote computer to the server and use this connection to communicate via SSH from the server to the remote computer.</p>\n\n<p>With OpenSSH this is quite easy. From the remote computer I open the reverse SSH tunnel:</p>\n\n<pre><code>ssh- R 19999:localhost:22 user@192.168.0.10\n</code></pre>\n\n<p>Now I can use this from the server side with:</p>\n\n<pre><code>ssh localhost -p 19999\n</code></pre>\n\n<p>I want to achieve the same behavior with a go application and the go SSH library on the remote computer. The server will still use OpenSSH so it should not be changed.</p>\n\n<p>I know how to connect to a computer via SSH from go but how can the reverse part be achieved?</p>\n\n<pre><code>func main() {\n    config := &amp;ssh.ClientConfig{\n        User: \"vagrant\",\n        Auth: []ssh.AuthMethod{\n            ssh.Password(\"vagrant\"),\n        },\n    }\n\n    conn, err := ssh.Dial(\"tcp\", \"192.168.0.10:22\", config)\n    if err != nil {\n        panic(\"Failed to dial: \" + err.Error())\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "methods", "struct", "operator-overloading"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1444399992, "post_id": 33040495, "comment_id": 53901681, "body": "Yes, use pointer receiver."}], "answers": [{"comments": [{"owner": {"reputation": 1499, "user_id": 5128105, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/NDMnr.png?s=128&g=1", "display_name": "Sundar", "link": "https://stackoverflow.com/users/5128105/sundar"}, "edited": false, "score": 0, "creation_date": 1444401471, "post_id": 33040529, "comment_id": 53902627, "body": "Great. This works as expected. Question: When I make the argument also as pointer, then will it help in performance, by passing it as reference instead of value."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1499, "user_id": 5128105, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/NDMnr.png?s=128&g=1", "display_name": "Sundar", "link": "https://stackoverflow.com/users/5128105/sundar"}, "edited": false, "score": 2, "creation_date": 1444402345, "post_id": 33040529, "comment_id": 53903250, "body": "@Sundar In case of small structs it doesn&#39;t matter and you shouldn&#39;t care. If your structs are big, then yes, it (may) help. For a discussion on the topic, see <a href=\"http://stackoverflow.com/questions/23542989/pointers-vs-values-in-parameters-and-return-values\">Pointers vs. values in parameters and return values</a>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 21, "last_activity_date": 1486734820, "last_edit_date": 1486734820, "creation_date": 1444400029, "answer_id": 33040529, "question_id": 33040495, "link": "https://stackoverflow.com/questions/33040495/golang-operator-overloading/33040529#33040529", "title": "Golang Operator Overloading", "body": "<p>Yes, use pointer receiver:</p>\n\n<pre><code>func (a *A) AddValue(v A) {\n    a.value1 += v.value1\n    a.value2 += v.value2\n}\n</code></pre>\n\n<p>By using a pointer receiver, the address of a value of type <code>A</code> will be passed, and therefore if you modify the pointed object, you don't have to return it, you will modify the \"original\" object and not a copy.</p>\n\n<p>You could also simply name it <code>Add()</code>. And you could also make its argument a pointer (for consistency):</p>\n\n<pre><code>func (a *A) Add(v *A) {\n    a.value1 += v.value1\n    a.value2 += v.value2\n}\n</code></pre>\n\n<p>And so using it:</p>\n\n<pre><code>x, y := &amp;A{1, 2}, &amp;A{3, 4}\n\nx.Add(y)\n\nfmt.Println(x)  // Prints &amp;{4 6}\n</code></pre>\n\n<p><strong>Notes</strong></p>\n\n<p>Note that even though you now have a pointer receiver, you can still call your <code>Add()</code> method on non-pointer values if they are addressable, so for example the following also works:</p>\n\n<pre><code>a, b := A{1, 2}, A{3, 4}\na.Add(&amp;b)\nfmt.Println(a)\n</code></pre>\n\n<p><code>a.Add()</code> is a shorthand for <code>(&amp;a).Add()</code>. Try these on the <a href=\"https://play.golang.org/p/ZxtuXAQ1Qv\" rel=\"noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 1499, "user_id": 5128105, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/NDMnr.png?s=128&g=1", "display_name": "Sundar", "link": "https://stackoverflow.com/users/5128105/sundar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17253, "favorite_count": 0, "accepted_answer_id": 33040529, "answer_count": 1, "score": 8, "last_activity_date": 1528905512, "creation_date": 1444399906, "last_edit_date": 1528905512, "question_id": 33040495, "link": "https://stackoverflow.com/questions/33040495/golang-operator-overloading", "title": "Golang Operator Overloading", "body": "<p>I understand that golang does not provide operator overloading, as it believe that it is increasing the complexity.</p>\n\n<p>So I want to implement that for structures directly. </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype A struct {\n    value1 int\n    value2 int\n}\n\nfunc (a A) AddValue(v A) A {\n    a.value1 += v.value1\n    a.value2 += v.value2\n    return a\n}\n\n\nfunc main() {\n    x, z := A{1, 2}, A{1, 2}\n    y := A{3, 4}\n\n    x = x.AddValue(y)\n\n    z.value1 += y.value1\n    z.value2 += y.value2\n\n    fmt.Println(x)\n    fmt.Println(z)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/1U8omyF8-V\" rel=\"noreferrer\">https://play.golang.org/p/1U8omyF8-V</a></p>\n\n<p>From the above code, the <strong><em>AddValue</em></strong> works as I want to. However, my only concern is that it is a pass by value and hence I have to return the newly added value everytime.</p>\n\n<p>Is there any other better method, in order to avoid returning the summed up variable.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "is_accepted": false, "score": 1, "last_activity_date": 1444389895, "creation_date": 1444389895, "answer_id": 33037064, "question_id": 33036796, "link": "https://stackoverflow.com/questions/33036796/i-am-using-postgres-database-with-golang-and-i-am-trying-to-return-connection-ob/33037064#33037064", "title": "I am using postgres database with golang and i am trying to return connection object but I don&#39;t know the return type connection object", "body": "<p>According to <a href=\"https://golang.org/pkg/database/sql/#Open\" rel=\"nofollow\">https://golang.org/pkg/database/sql/#Open</a><br>\n<code>sql.Open</code> returns <code>*DB, error</code>, so you should return <code>*sql.DB</code> in your case.<br>\nYou can use this information <a href=\"https://golang.org/pkg/database/sql/\" rel=\"nofollow\">https://golang.org/pkg/database/sql/</a> about <code>databse/sql</code> package</p>\n"}, {"tags": [], "owner": {"reputation": 241, "user_id": 5427367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e56416b1e446e56c0c715732c918191c?s=128&d=identicon&r=PG&f=1", "display_name": "M-AbdalRahman", "link": "https://stackoverflow.com/users/5427367/m-abdalrahman"}, "is_accepted": true, "score": 2, "last_activity_date": 1444390163, "creation_date": 1444390163, "answer_id": 33037158, "question_id": 33036796, "link": "https://stackoverflow.com/questions/33036796/i-am-using-postgres-database-with-golang-and-i-am-trying-to-return-connection-ob/33037158#33037158", "title": "I am using postgres database with golang and i am trying to return connection object but I don&#39;t know the return type connection object", "body": "<p>Open function returns (*DB, error), so you should return <code>*sql.DB</code></p>\n\n<p><a href=\"https://golang.org/pkg/database/sql/#Open\" rel=\"nofollow\">func Open(driverName, dataSourceName string) (*DB, error)</a></p>\n\n<pre><code>func (t *DbConnection) Connect() (*sql.DB) {\n    dbTest, err := sql.Open(\"postgres\", \"user = praveen dbname = test_twichblade sslmode = disable\")\n    return dbTest\n}\n</code></pre>\n"}], "owner": {"reputation": 1124, "user_id": 3719105, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/naAxR.jpg?s=128&g=1", "display_name": "Praveen_Shukla", "link": "https://stackoverflow.com/users/3719105/praveen-shukla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 355, "favorite_count": 0, "accepted_answer_id": 33037158, "answer_count": 2, "score": -2, "last_activity_date": 1444390163, "creation_date": 1444389053, "question_id": 33036796, "link": "https://stackoverflow.com/questions/33036796/i-am-using-postgres-database-with-golang-and-i-am-trying-to-return-connection-ob", "title": "I am using postgres database with golang and i am trying to return connection object but I don&#39;t know the return type connection object", "body": "<pre><code>func (t *DbConnection) Connect() (return type) {\n    dbTest, err := sql.Open(\"postgres\", \"user = praveen dbname = test_twichblade sslmode = disable\")\n    return dbTest\n}\n</code></pre>\n\n<p>In above example what should be the return type ?</p>\n"}, {"tags": ["go", "channel"], "comments": [{"owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "edited": false, "score": 0, "creation_date": 1444386486, "post_id": 33035745, "comment_id": 53892925, "body": "Can it happen that an item is found multiple times, i.e. <code>found &lt;- true</code> is executed multiple times?"}, {"owner": {"reputation": 328, "user_id": 1176300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5382d5f3db26dfdd3d2a82db6dc99fc2?s=128&d=identicon&r=PG", "display_name": "Kokos", "link": "https://stackoverflow.com/users/1176300/kokos"}, "edited": false, "score": 3, "creation_date": 1444386662, "post_id": 33035745, "comment_id": 53893016, "body": "Are you aware that break just breaks select, not whole loop?"}, {"owner": {"reputation": 328, "user_id": 1176300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5382d5f3db26dfdd3d2a82db6dc99fc2?s=128&d=identicon&r=PG", "display_name": "Kokos", "link": "https://stackoverflow.com/users/1176300/kokos"}, "edited": false, "score": 1, "creation_date": 1444387361, "post_id": 33035745, "comment_id": 53893389, "body": "<code>&lt;-found</code> case of select may also not manage to trigger before loop ends (default kicks in as soon as possible)"}, {"owner": {"reputation": 102, "user_id": 2608651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/784882a64e77202f2230e2b2e42b395c?s=128&d=identicon&r=PG", "display_name": "Rijin", "link": "https://stackoverflow.com/users/2608651/rijin"}, "reply_to_user": {"reputation": 328, "user_id": 1176300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5382d5f3db26dfdd3d2a82db6dc99fc2?s=128&d=identicon&r=PG", "display_name": "Kokos", "link": "https://stackoverflow.com/users/1176300/kokos"}, "edited": false, "score": 0, "creation_date": 1444421186, "post_id": 33035745, "comment_id": 53913530, "body": "@Kokos Yes. I forgot to add the label for break above. Question edited!"}], "answers": [{"comments": [{"owner": {"reputation": 102, "user_id": 2608651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/784882a64e77202f2230e2b2e42b395c?s=128&d=identicon&r=PG", "display_name": "Rijin", "link": "https://stackoverflow.com/users/2608651/rijin"}, "edited": false, "score": 0, "creation_date": 1444422752, "post_id": 33036299, "comment_id": 53914282, "body": "You are right. Looks like the loop is finishing before &lt;-found is fired. The solution you gave is excellent. But I would still like to find out an elegant way to modify my existing code to make it work."}], "tags": [], "owner": {"reputation": 328, "user_id": 1176300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5382d5f3db26dfdd3d2a82db6dc99fc2?s=128&d=identicon&r=PG", "display_name": "Kokos", "link": "https://stackoverflow.com/users/1176300/kokos"}, "is_accepted": true, "score": 1, "last_activity_date": 1444387679, "creation_date": 1444387679, "answer_id": 33036299, "question_id": 33035745, "link": "https://stackoverflow.com/questions/33035745/go-routine-deadlock-with-single-channel/33036299#33036299", "title": "go routine deadlock with single channel", "body": "<p>One possible solution is to avoid select statement and use separate goroutine for receiver (or sender, or both).\nExample:</p>\n\n<pre><code>package main    \nimport \"sync\"\n\nfunc worker(res chan bool, wg *sync.WaitGroup) {\n    res &lt;- true\n    wg.Done()\n}\n\nfunc receiver(res chan bool, wg *sync.WaitGroup) {\n    for range res {\n    }\n    wg.Done()\n}\n\nfunc main() {\n    var wg, wg2 sync.WaitGroup\n    wg.Add(1)\n    wg2.Add(10)\n    found := make(chan bool)\n    go receiver(found, &amp;wg)\n    for i := 0; i &lt; 10; i++ {\n        go worker(found, &amp;wg2)\n    }\n    wg2.Wait()\n    close(found)\n    wg.Done()\n}\n</code></pre>\n"}], "owner": {"reputation": 102, "user_id": 2608651, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/784882a64e77202f2230e2b2e42b395c?s=128&d=identicon&r=PG", "display_name": "Rijin", "link": "https://stackoverflow.com/users/2608651/rijin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 33036299, "answer_count": 1, "score": 1, "last_activity_date": 1444447572, "creation_date": 1444386046, "last_edit_date": 1444429437, "question_id": 33035745, "link": "https://stackoverflow.com/questions/33035745/go-routine-deadlock-with-single-channel", "title": "go routine deadlock with single channel", "body": "<p>I started learning go recently and I am stuck on a problem.\nI have a simple go routine which either returns or pushes value to a channel.\nAnd my main fn delegates work to this routine till it meets condition or data is exhausted. \nThis code seem to deadlock on \"found\" channel. What am I doing wrong?</p>\n\n<ul>\n<li>There are multiple workers</li>\n<li>Item can be found in more than one worker at the same time</li>\n<li>Once item is found, all workers should be stopped.</li>\n</ul>\n\n<p>.</p>\n\n<pre><code>func workerRoutine(data Data, found chan bool, wg *sync.WaitGroup){\n\n   defer (*wg).Done()\n   // data processing\n   // return on false \n\n   // multiple routines can set this at the same time\n   found &lt;-true\n}\n\nfunc main {\n\n   // ....\n   found:=make(chan bool)\n   var wg sync.WaitGroup\n   itemFound:=false\n       Loop:\n          for i:=0; i&lt;limit; i++ {\n              select {\n                 case &lt;-found:\n                    itemFound = true\n                    break Loop\n                 default:\n                    if(some_check) {\n                       wg.Add(1)\n                       go workerRoutine(mdata,found,&amp;wg)\n                    }\n              }\n       }\n\n   wg.Wait()\n\n   // use itemFound\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2195, "user_id": 1108279, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ceab1df9b9083d662c34efd1b7c7868?s=128&d=identicon&r=PG", "display_name": "pregmatch", "link": "https://stackoverflow.com/users/1108279/pregmatch"}, "edited": false, "score": 0, "creation_date": 1444382372, "post_id": 33034442, "comment_id": 53890258, "body": "have you try go get github.com/asaskevich/govalidator ?"}, {"owner": {"reputation": 627, "user_id": 1029949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/78b3ab7db53dea6f07f963d1ee70c6b7?s=128&d=identicon&r=PG", "display_name": "Elliot Reeve", "link": "https://stackoverflow.com/users/1029949/elliot-reeve"}, "reply_to_user": {"reputation": 2195, "user_id": 1108279, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ceab1df9b9083d662c34efd1b7c7868?s=128&d=identicon&r=PG", "display_name": "pregmatch", "link": "https://stackoverflow.com/users/1108279/pregmatch"}, "edited": false, "score": 0, "creation_date": 1444382743, "post_id": 33034442, "comment_id": 53890472, "body": "I am using go 1.5 so I have that file inside vendor/github.com to avoid using go get then having different versions on different environments"}], "answers": [{"comments": [{"owner": {"reputation": 627, "user_id": 1029949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/78b3ab7db53dea6f07f963d1ee70c6b7?s=128&d=identicon&r=PG", "display_name": "Elliot Reeve", "link": "https://stackoverflow.com/users/1029949/elliot-reeve"}, "edited": false, "score": 0, "creation_date": 1444384056, "post_id": 33034955, "comment_id": 53891330, "body": "Thanks but I am getting this: go: GOPATH entry cannot start with shell metacharacter &#39;~&#39;: &quot;~/Documents/gocode/src/&quot; - do i need to explicitly fill out the GOPATH?"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 627, "user_id": 1029949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/78b3ab7db53dea6f07f963d1ee70c6b7?s=128&d=identicon&r=PG", "display_name": "Elliot Reeve", "link": "https://stackoverflow.com/users/1029949/elliot-reeve"}, "edited": false, "score": 3, "creation_date": 1444384111, "post_id": 33034955, "comment_id": 53891373, "body": "Try replacing <code>~</code> with <code>${HOME}</code>."}, {"owner": {"reputation": 627, "user_id": 1029949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/78b3ab7db53dea6f07f963d1ee70c6b7?s=128&d=identicon&r=PG", "display_name": "Elliot Reeve", "link": "https://stackoverflow.com/users/1029949/elliot-reeve"}, "edited": false, "score": 0, "creation_date": 1444384997, "post_id": 33034955, "comment_id": 53891978, "body": "I now get ($GOPATH not set)?"}, {"owner": {"reputation": 627, "user_id": 1029949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/78b3ab7db53dea6f07f963d1ee70c6b7?s=128&d=identicon&r=PG", "display_name": "Elliot Reeve", "link": "https://stackoverflow.com/users/1029949/elliot-reeve"}, "edited": false, "score": 0, "creation_date": 1444385248, "post_id": 33034955, "comment_id": 53892144, "body": "export GO15VENDOREXPERIMENT=&quot;1&quot; export GOPATH=&quot;$HOME/Documents/gocode&quot; go build . - tried {HOME} too"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 627, "user_id": 1029949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/78b3ab7db53dea6f07f963d1ee70c6b7?s=128&d=identicon&r=PG", "display_name": "Elliot Reeve", "link": "https://stackoverflow.com/users/1029949/elliot-reeve"}, "edited": false, "score": 0, "creation_date": 1444385515, "post_id": 33034955, "comment_id": 53892318, "body": "Are both exports on the same line? In that case either add a semicolon after every export statement (<code>export A=a; export B=b; echo $A $B</code>) or just use <code>env</code> like in my answer."}, {"owner": {"reputation": 627, "user_id": 1029949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/78b3ab7db53dea6f07f963d1ee70c6b7?s=128&d=identicon&r=PG", "display_name": "Elliot Reeve", "link": "https://stackoverflow.com/users/1029949/elliot-reeve"}, "edited": false, "score": 0, "creation_date": 1444386017, "post_id": 33034955, "comment_id": 53892633, "body": "Ok so the semicolons seems to have fixed the issue, now i get this:  main.go:4:2: cannot find package &quot;controllers&quot; in any of: \t/Users/ereeve/Documents/gocode/src/apps_api/vendor/controll&zwnj;&#8203;ers (vendor tree) \t/Users/ereeve/.gvm/gos/go1.5/src/controllers (from $GOROOT) \t/Users/ereeve/Documents/gocode/src/controllers (from $GOPATH)"}, {"owner": {"reputation": 627, "user_id": 1029949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/78b3ab7db53dea6f07f963d1ee70c6b7?s=128&d=identicon&r=PG", "display_name": "Elliot Reeve", "link": "https://stackoverflow.com/users/1029949/elliot-reeve"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1444386466, "post_id": 33034955, "comment_id": 53892912, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/91832/discussion-between-elliot-reeve-and-ainar-g\">continue this discussion in chat</a>."}, {"owner": {"reputation": 13601, "user_id": 1564659, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f7524296b1d11599c7a1bd2c045a73ac?s=128&d=identicon&r=PG", "display_name": "Aminah Nuraini", "link": "https://stackoverflow.com/users/1564659/aminah-nuraini"}, "edited": false, "score": 0, "creation_date": 1452439976, "post_id": 33034955, "comment_id": 57160392, "body": "<a href=\"http://stackoverflow.com/questions/25499670/gopath-value-setting\">stackoverflow.com/questions/25499670/gopath-value-setting</a> GOPATH is the path to an empty folder for building your code"}, {"owner": {"reputation": 3000, "user_id": 1335245, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3b201e069f3e6868c1c0285f6e31801c?s=128&d=identicon&r=PG", "display_name": "Charney Kaye", "link": "https://stackoverflow.com/users/1335245/charney-kaye"}, "edited": false, "score": 0, "creation_date": 1467303990, "post_id": 33034955, "comment_id": 63688575, "body": "IMO this answer is dangerously hack-y"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 9, "last_activity_date": 1444385894, "last_edit_date": 1444385894, "creation_date": 1444383820, "answer_id": 33034955, "question_id": 33034442, "link": "https://stackoverflow.com/questions/33034442/golang-1-5-vendors-cannot-find-package/33034955#33034955", "title": "Golang 1.5 vendors - Cannot find package", "body": "<p>IIRC, <code>GO15VENDOREXPERIMENT</code> will work only if the package you're building is inside <code>$GOPATH/src</code>, so setting</p>\n\n<pre><code>export GOPATH=`pwd`\n</code></pre>\n\n<p>in your <code>build.sh</code> makes it fail. If you put your <code>apps_api</code> inside say <code>~/fakegopath/src/</code> and run</p>\n\n<pre><code>env GOPATH=\"${HOME}/fakegopath/src/\" GO15VENDOREXPERIMENT=\"1\" go build .\n</code></pre>\n\n<p>it should work.</p>\n"}], "owner": {"reputation": 627, "user_id": 1029949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/78b3ab7db53dea6f07f963d1ee70c6b7?s=128&d=identicon&r=PG", "display_name": "Elliot Reeve", "link": "https://stackoverflow.com/users/1029949/elliot-reeve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3904, "favorite_count": 1, "accepted_answer_id": 33034955, "answer_count": 1, "score": 7, "last_activity_date": 1444385894, "creation_date": 1444382247, "last_edit_date": 1444382958, "question_id": 33034442, "link": "https://stackoverflow.com/questions/33034442/golang-1-5-vendors-cannot-find-package", "title": "Golang 1.5 vendors - Cannot find package", "body": "<p>Trying to build my project in go lang using version 1.5 with <code>GO15VENDOREXPERIMENT=\"1\"</code> turned on to ensure I look for the vendors locally.</p>\n\n<p>My structure is:</p>\n\n<pre><code>apps_api\n   main.go\n   build.sh\n   src\n      controllers\n      models\n      views\n   vendor\n      github.com\n      golang.org\n      .....\n</code></pre>\n\n<p>build.sh contains</p>\n\n<pre><code>export GO15VENDOREXPERIMENT=\"1\"\nexport GOPATH=`pwd`\ngo build .\n</code></pre>\n\n<p>controller file example</p>\n\n<pre><code>import (\n    \"models\"\n    \"views\"\n\n    \"github.com/gin-gonic/gin\"\n)\n</code></pre>\n\n<p>But i get lots of errors saying package not found see below for exmaple</p>\n\n<pre><code>src/controllers/app-versions.go:10:2: cannot find package \"github.com/asaskevich/govalidator\" in any of:\n    /Users/ereeve/.gvm/gos/go1.5/src/github.com/asaskevich/govalidator (from $GOROOT)\n    /Users/ereeve/Documents/gocode/src/apps_api/src/github.com/asaskevich/govalidator (from $GOPATH)\n\nsrc/controllers/index.go:4:2: cannot find package \"github.com/chnlr/baseurl\" in any of:\n    /Users/ereeve/.gvm/gos/go1.5/src/github.com/chnlr/baseurl (from $GOROOT)\n    /Users/ereeve/Documents/gocode/src/apps_api/src/github.com/chnlr/baseurl (from $GOPATH)\n</code></pre>\n\n<p>If i add these lines into my build.sh file it will build, but I don't want to use go get because I am using go 1.5 with the vendors locally inside my project to avoid dependancies.</p>\n\n<pre><code># go get github.com/gin-gonic/gin\n# go get github.com/go-sql-driver/mysql\n# go get github.com/rif/cache2go\n....\n</code></pre>\n\n<p>Any ideas what I am doing wrong?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 6, "creation_date": 1444386881, "post_id": 33035696, "comment_id": 53893136, "body": "Trace is competently unrelated to this problem, not sure why you mention it."}, {"owner": {"reputation": 328, "user_id": 1176300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5382d5f3db26dfdd3d2a82db6dc99fc2?s=128&d=identicon&r=PG", "display_name": "Kokos", "link": "https://stackoverflow.com/users/1176300/kokos"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444387982, "post_id": 33035696, "comment_id": 53893805, "body": "I can imagine that <i>trace</i>-like tool can record entering to and returning from any function with current context (function arguments or return values and line number when returning)."}, {"owner": {"reputation": 19808, "user_id": 1472049, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1qeQt.jpg?s=128&g=1", "display_name": "serejja", "link": "https://stackoverflow.com/users/1472049/serejja"}, "edited": false, "score": 0, "creation_date": 1444394753, "post_id": 33035696, "comment_id": 53897965, "body": "I expected it to be this way but hoped there&#39;s at least something I could wrap problematic code with (something like the trace you mentioned) to get more detailed stack trace."}, {"owner": {"reputation": 769, "user_id": 1245992, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3920847cf9e236c2f3e950d73e915959?s=128&d=identicon&r=PG", "display_name": "Gellweiler", "link": "https://stackoverflow.com/users/1245992/gellweiler"}, "edited": false, "score": 0, "creation_date": 1513125421, "post_id": 33035696, "comment_id": 82528970, "body": "I tried to use trace for this without much success. So this is why I ended up writing my own small debug utility (see my answer)."}], "tags": [], "owner": {"reputation": 328, "user_id": 1176300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5382d5f3db26dfdd3d2a82db6dc99fc2?s=128&d=identicon&r=PG", "display_name": "Kokos", "link": "https://stackoverflow.com/users/1176300/kokos"}, "is_accepted": true, "score": 6, "last_activity_date": 1548164299, "last_edit_date": 1548164299, "creation_date": 1444385911, "answer_id": 33035696, "question_id": 33034241, "link": "https://stackoverflow.com/questions/33034241/how-to-get-the-stack-trace-pointing-to-actual-error-reason/33035696#33035696", "title": "How to get the stack trace pointing to actual error reason", "body": "<p>Shortly: this is not possible.\nSince <a href=\"https://blog.golang.org/errors-are-values\" rel=\"nofollow noreferrer\">errors are values</a>, they are not treated in any special way. Due to this, when function (normally) returns, stack is no more available (ie. another function call may overwrite memory used by returning-error function' stack).</p>\n\n<p>There is a tool called <em>trace</em> which was introduced with go1.5, but for now, there is no comprehensive tutorial available neither any of those I found says that this kind of feature will be included.</p>\n"}, {"comments": [{"owner": {"reputation": 2812, "user_id": 3738542, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002024985258/picture?type=large", "display_name": "oren", "link": "https://stackoverflow.com/users/3738542/oren"}, "edited": false, "score": 0, "creation_date": 1545675104, "post_id": 46058037, "comment_id": 94675895, "body": "It would be more helpful if you wrote down the lines numbers :)"}], "tags": [], "owner": {"reputation": 2624, "user_id": 3310285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaFcy.png?s=128&g=1", "display_name": "Alex Efimov", "link": "https://stackoverflow.com/users/3310285/alex-efimov"}, "is_accepted": false, "score": 1, "last_activity_date": 1504623433, "creation_date": 1504623433, "answer_id": 46058037, "question_id": 33034241, "link": "https://stackoverflow.com/questions/33034241/how-to-get-the-stack-trace-pointing-to-actual-error-reason/46058037#46058037", "title": "How to get the stack trace pointing to actual error reason", "body": "<p>Take a look at: <a href=\"https://github.com/efimovalex/stackerr\" rel=\"nofollow noreferrer\">https://github.com/efimovalex/stackerr</a></p>\n\n<p>Is this the thing you are looking for?</p>\n\n<pre><code>package main\n\nimport \"github.com/efimovalex/stackerr\"\nimport \"fmt\"\n\nfunc f1() *stackerr.Err {\n    err := stackerr.Error(\"message\")\n    return err.Stack()\n}\n\nfunc f2() *stackerr.Err {\n    err := f1()\n    return err.Stack()\n}\n\ntype t1 struct{}\n\nfunc (t *t1) f3() *stackerr.Err {\n    err := f2()\n    return err.Stack()\n}\n\nfunc main() {\n    ts := t1{}\n    err := ts.f3()\n\n    err.Log()\n}\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>2017/08/31 12:13:47 Error Stacktrace:\n-&gt; github.com/efimovalex/stackerr/example/main.go:25 (main.main)\n-&gt; github.com/efimovalex/stackerr/example/main.go:19 (main.(*t1).f3)\n-&gt; github.com/efimovalex/stackerr/example/main.go:12 (main.f2)\n-&gt; github.com/efimovalex/stackerr/example/main.go:7 (main.f1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 769, "user_id": 1245992, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3920847cf9e236c2f3e950d73e915959?s=128&d=identicon&r=PG", "display_name": "Gellweiler", "link": "https://stackoverflow.com/users/1245992/gellweiler"}, "is_accepted": false, "score": 4, "last_activity_date": 1599587421, "last_edit_date": 1599587421, "creation_date": 1513125208, "answer_id": 47783790, "question_id": 33034241, "link": "https://stackoverflow.com/questions/33034241/how-to-get-the-stack-trace-pointing-to-actual-error-reason/47783790#47783790", "title": "How to get the stack trace pointing to actual error reason", "body": "<p>As others have pointed out tracing errors in go isn't trivial. There are projects like <a href=\"https://github.com/juju/errgo\" rel=\"nofollow noreferrer\">juju/errgo</a>, that allow you to wrap errors and then trace these errors back. For that to work tough, you must use them consistently throughout your project and that won't help you with errors in 3rd party libraries or with errors that get handled and never get returned.</p>\n<p>Because this is such a common issue and I really got annoyed with this, I wrote a small <a href=\"https://github.com/gellweiler/errgotrace\" rel=\"nofollow noreferrer\">debug utility</a> that will add debug code to go files that logs every returned error (value that implements <code>error</code>) and the function in which it was returned to STDOUT (if you need more advanced logging just hack the logger in the project, it's really simple).</p>\n<p><strong>Installation</strong></p>\n<pre><code>go get github.com/gellweiler/errgotrace\n</code></pre>\n<p><strong>Usage</strong></p>\n<p>To debug all files in the current directory:</p>\n<pre><code>$ find . -name '*.go' -print0 | xargs -0 errgotrace -w\n</code></pre>\n<p>To remove the added debug code from the go files:</p>\n<pre><code>$ find . -name '*.go' -print0 | xargs -0 errgotrace -w -r\n</code></pre>\n<p>Then just simply compile &amp; run your code or your test cases.</p>\n<p><strong>Sample Output</strong></p>\n<pre><code>[...]\n2017/12/13 00:54:39 [ERRGOTRACE] parser.*Parser.objectKey: EOF token found\n2017/12/13 00:54:39 [ERRGOTRACE] parser.*Parser.objectItem: EOF token found\n2017/12/13 00:54:39 [ERRGOTRACE] parser.*Parser.objectKey: EOF token found\n2017/12/13 00:54:39 [ERRGOTRACE] parser.*Parser.objectItem: EOF token found\n2017/12/13 00:54:39 [ERRGOTRACE] parser.*Parser.objectKey: At 3:4: nested object expected: LBRACE got: ASSIGN\n2017/12/13 00:54:39 [ERRGOTRACE] parser.*Parser.objectItem: At 3:4: nested object expected: LBRACE got: ASSIGN\n2017/12/13 00:54:39 [ERRGOTRACE] parser.*Parser.objectList: At 3:4: nested object expected: LBRACE got: ASSIGN\n2017/12/13 00:54:39 [ERRGOTRACE] parser.*Parser.Parse: At 2:31: literal not terminated\n2017/12/13 00:54:39 [ERRGOTRACE] parser.Parse: At 2:31: literal not terminated\n2017/12/13 00:54:39 [ERRGOTRACE] hcl.parse: At 2:31: literal not terminated\n2017/12/13 00:54:39 [ERRGOTRACE] hcl.ParseBytes: At 2:31: literal not terminated\n2017/12/13 00:54:39 [ERRGOTRACE] formula.parse: parsing failed\n[...]\n</code></pre>\n<p>As you can see from this output, it's really easy to tell in which function the error originally occurred. Once you know that, you can use a debugger to get more context.</p>\n"}, {"tags": [], "owner": {"reputation": 3250, "user_id": 4801289, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/I0puU.jpg?s=128&g=1", "display_name": "Ismail H", "link": "https://stackoverflow.com/users/4801289/ismail-h"}, "is_accepted": false, "score": 6, "last_activity_date": 1543224290, "last_edit_date": 1543224290, "creation_date": 1519723353, "answer_id": 49005129, "question_id": 33034241, "link": "https://stackoverflow.com/questions/33034241/how-to-get-the-stack-trace-pointing-to-actual-error-reason/49005129#49005129", "title": "How to get the stack trace pointing to actual error reason", "body": "<p>I think that there is an easier way to achieve this. You can try <a href=\"https://godoc.org/github.com/pkg/errors\" rel=\"noreferrer\">wrapping errors</a> using the golang \"default\" error package:</p>\n\n<p>You need to define the interface to be implemented by your <code>error</code> :</p>\n\n<pre><code>type stackTracer interface {\n    StackTrace() errors.StackTrace\n}\n</code></pre>\n\n<p>Then use it when wrapping/treating an error :</p>\n\n<pre><code>err, ok := errors.(stackTracer) // ok is false if errors doesn't implement stackTracer\n\nstack := err.StackTrace()\nfmt.Println(stack) // here you'll have your stack trace\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 133, "user_id": 1519258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd0bb6bc7bab7b9cb7c49c990129d9d9?s=128&d=identicon&r=PG", "display_name": "Johan", "link": "https://stackoverflow.com/users/1519258/johan"}, "reply_to_user": {"reputation": 2011, "user_id": 3257288, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a00db57a0e7cb5e24f8ad561ede60911?s=128&d=identicon&r=PG&f=1", "display_name": "Alpha2k", "link": "https://stackoverflow.com/users/3257288/alpha2k"}, "edited": false, "score": 0, "creation_date": 1573441350, "post_id": 54653592, "comment_id": 103871484, "body": "@Alpha2k I tried to run this code on go 1.13.4 on macos and it seems fine, could you please provide more details?"}], "tags": [], "owner": {"reputation": 133, "user_id": 1519258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd0bb6bc7bab7b9cb7c49c990129d9d9?s=128&d=identicon&r=PG", "display_name": "Johan", "link": "https://stackoverflow.com/users/1519258/johan"}, "is_accepted": false, "score": 3, "last_activity_date": 1549985564, "creation_date": 1549985564, "answer_id": 54653592, "question_id": 33034241, "link": "https://stackoverflow.com/questions/33034241/how-to-get-the-stack-trace-pointing-to-actual-error-reason/54653592#54653592", "title": "How to get the stack trace pointing to actual error reason", "body": "<p>Take a look at <a href=\"https://github.com/ztrue/tracerr\" rel=\"nofollow noreferrer\">https://github.com/ztrue/tracerr</a></p>\n\n<p>I created this package in order to have both stack trace and source fragments to be able to debug faster and log errors with much more details.</p>\n\n<p>Here is a code example:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"io/ioutil\"\n    \"github.com/ztrue/tracerr\"\n)\n\nfunc main() {\n    if err := read(); err != nil {\n        tracerr.PrintSourceColor(err)\n    }\n}\n\nfunc read() error {\n    return readNonExistent()\n}\n\nfunc readNonExistent() error {\n    _, err := ioutil.ReadFile(\"/tmp/non_existent_file\")\n    // Add stack trace to existing error, no matter if it's nil.\n    return tracerr.Wrap(err)\n}\n</code></pre>\n\n<p>And here is the output:\n<a href=\"https://i.stack.imgur.com/8BpcJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8BpcJ.png\" alt=\"golang error stack trace\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11297642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76bbe3a4f63cb79821512fbc9772fbb4?s=128&d=identicon&r=PG", "display_name": "user11297642", "link": "https://stackoverflow.com/users/11297642/user11297642"}, "is_accepted": false, "score": 1, "last_activity_date": 1574145094, "creation_date": 1574145094, "answer_id": 58927919, "question_id": 33034241, "link": "https://stackoverflow.com/questions/33034241/how-to-get-the-stack-trace-pointing-to-actual-error-reason/58927919#58927919", "title": "How to get the stack trace pointing to actual error reason", "body": "<p>As I know, stackrerror is the simplest stack display package. You can use all the native log library records or output the call stack yourself. For example:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    package main\n\n    import \"github.com/lingdor/stackerror\"\n\n    func act1()error {\n    return stackerror.New(\"here Error\")\n    }\n\n    func main(){\n    err:=act1()\n    fmt.println(err.Error()) //panic(err) and log.Info(err) are ok\n    }\n\n</code></pre>\n\n<p>output :</p>\n\n<pre><code>*stackError.stackError : here Error\nat main.act1( /Users/user/go/testMain/src/main/main.go:17 )\nat main.main( /Users/user/go/testMain/src/main/main.go:22 )\nat runtime.main( /usr/local/Cellar/go/1.13.4/libexec/src/runtime/proc.go:203 )\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1285, "user_id": 1102092, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bcab51f901bd9cf7c2f09c65359f03aa?s=128&d=identicon&r=PG", "display_name": "sum2000", "link": "https://stackoverflow.com/users/1102092/sum2000"}, "is_accepted": false, "score": 0, "last_activity_date": 1577471058, "creation_date": 1577471058, "answer_id": 59504656, "question_id": 33034241, "link": "https://stackoverflow.com/questions/33034241/how-to-get-the-stack-trace-pointing-to-actual-error-reason/59504656#59504656", "title": "How to get the stack trace pointing to actual error reason", "body": "<p>You can use the built-in Recover function to handle panic and print the stack trace.</p>\n\n<p>From <a href=\"https://blog.golang.org/defer-panic-and-recover\" rel=\"nofollow noreferrer\">https://blog.golang.org/defer-panic-and-recover</a></p>\n\n<blockquote>\n  <p>Recover is a built-in function that regains control of a panicking\n  goroutine. Recover is only useful inside deferred functions. During\n  normal execution, a call to recover will return nil and have no other\n  effect. If the current goroutine is panicking, a call to recover will\n  capture the value given to panic and resume normal execution.</p>\n</blockquote>\n\n<p>I have modified your example to use recover and <a href=\"https://github.com/rotisserie/eris\" rel=\"nofollow noreferrer\">eris</a>. Eris provides a better way to handle, trace, and log errors in Go.</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/rotisserie/eris\"\n    \"fmt\"\n)\n\nfunc main() {\n    value, err := DoSomething()\n    defer func() {\n        if r := recover(); r!= nil {\n            fmt.Println(fmt.Sprintf(\"%+v\", r))\n        }\n    }()\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Println(value)\n}\n\nfunc DoSomething() (string, error) {\n    return \"\", eris.New(\"some error explanation here\")\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>some error explanation here\n    main.DoSomething: /tmp/sandbox147128055/prog.go: 23\n    main.main: /tmp/sandbox147128055/prog.go: 9\n    runtime.main: /usr/local/go/src/runtime/proc.go: 203\n    runtime.goexit: /usr/local/go/src/runtime/asm_amd64p32.s: 523\n</code></pre>\n\n<p>See it in action here <a href=\"https://play.golang.org/p/jgkaR42ub5q\" rel=\"nofollow noreferrer\">https://play.golang.org/p/jgkaR42ub5q</a></p>\n"}, {"tags": [], "owner": {"reputation": 2576, "user_id": 631612, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/b7d2a769fa193f9efa36668148deb9f5?s=128&d=identicon&r=PG", "display_name": "quanta", "link": "https://stackoverflow.com/users/631612/quanta"}, "is_accepted": false, "score": 1, "last_activity_date": 1606563188, "last_edit_date": 1606563188, "creation_date": 1606562471, "answer_id": 65049022, "question_id": 33034241, "link": "https://stackoverflow.com/questions/33034241/how-to-get-the-stack-trace-pointing-to-actual-error-reason/65049022#65049022", "title": "How to get the stack trace pointing to actual error reason", "body": "<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n    &quot;errors&quot;\n    &quot;fmt&quot;\n)\n\nfunc main() {\n    value, err := DoSomething()\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(value)\n}\n\nfunc DoSomething() (string, error) {\n    return &quot;&quot;, errors.New(&quot;some error explanation here&quot;)\n}\n</code></pre>\n<p>The problem is the standard package <code>errors</code> does not attach the stack trace at the point it occurs. You can use <a href=\"https://pkg.go.dev/github.com/pkg/errors#hdr-Retrieving_the_stack_trace_of_an_error_or_wrapper\" rel=\"nofollow noreferrer\">github.com/pkg/errors</a> to do that:</p>\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n    &quot;github.com/pkg/errors&quot;\n    &quot;fmt&quot;\n)\n\nfunc main() {\n    value, err := DoSomething()\n    if err != nil {\n        fmt.Printf(&quot;%+v&quot;, err)\n    }\n    fmt.Println(value)\n}\n\nfunc DoSomething() (string, error) {\n    return &quot;&quot;, errors.New(&quot;some error explanation here&quot;)\n}\n</code></pre>\n<pre><code>$ go run stacktrace.go\nsome error explanation here\nmain.DoSomething\n    /Users/quanta/go/src/github.com/quantonganh/errors/stacktrace.go:18\nmain.main\n    /Users/quanta/go/src/github.com/quantonganh/errors/stacktrace.go:10\nruntime.main\n    /usr/local/Cellar/go/1.15.2/libexec/src/runtime/proc.go:204\nruntime.goexit\n    /usr/local/Cellar/go/1.15.2/libexec/src/runtime/asm_amd64.s:1374\n</code></pre>\n<p>More details: <a href=\"https://dave.cheney.net/2016/06/12/stack-traces-and-the-errors-package\" rel=\"nofollow noreferrer\">https://dave.cheney.net/2016/06/12/stack-traces-and-the-errors-package</a></p>\n"}], "owner": {"reputation": 19808, "user_id": 1472049, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1qeQt.jpg?s=128&g=1", "display_name": "serejja", "link": "https://stackoverflow.com/users/1472049/serejja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17756, "favorite_count": 1, "accepted_answer_id": 33035696, "answer_count": 8, "score": 20, "last_activity_date": 1606563188, "creation_date": 1444381657, "last_edit_date": 1595180971, "question_id": 33034241, "link": "https://stackoverflow.com/questions/33034241/how-to-get-the-stack-trace-pointing-to-actual-error-reason", "title": "How to get the stack trace pointing to actual error reason", "body": "<p>Let's say I have some code like this:</p>\n\n<pre><code>value, err := some3rdpartylib.DoSomething()\nif err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>In case <code>err != nil</code> I will get something like this:</p>\n\n<pre><code>panic: some error explanation here\n\ngoroutine 1 [running]:\nmain.main()\n    /tmp/blabla/main.go:6 +0x80\n</code></pre>\n\n<p>This stack trace is completely legit but sometimes these error messages may not clarify what happened and so I'd like to dig deeper into the source code of the 3rd party library to investigate what exactly causes this error to be returned. However when my code panics like this, there is no way to get the actual place that returned this error.</p>\n\n<p>A little bit more clarification: as I'm coming from JVM world where exceptions are thrown I can completely trace what exactly line of code thrown the exception and thus can easily find the place and see what gone wrong. Go stack trace ends exactly where my code panics and thus not too useful in my case.</p>\n\n<p>I've created a playground <a href=\"http://play.golang.org/p/5ydALOMSJi\" rel=\"noreferrer\">here</a> and ideally I'd like to be able to trace the error to the place it was actually returned from, not panic. (e.g. to line 17, <code>return \"\", errors.New(\"some error explanation here\")</code>)</p>\n\n<p>Is this even possible?</p>\n"}, {"tags": ["go", "rsa", "public-key", "digital-certificate"], "answers": [{"tags": [], "owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "is_accepted": true, "score": 21, "last_activity_date": 1510087742, "last_edit_date": 1510087742, "creation_date": 1444678072, "answer_id": 33088784, "question_id": 33031658, "link": "https://stackoverflow.com/questions/33031658/getting-rsa-public-key-from-certificate-in-golang/33088784#33088784", "title": "Getting RSA Public Key from Certificate in Golang", "body": "<p>I have struggled my way learning just enough of Go to cobble together this example.</p>\n\n<pre><code>package main\n\nimport(\n    \"fmt\"\n    \"encoding/pem\"\n    \"crypto/x509\"\n    \"crypto/rsa\"\n)\n\nfunc main(){\n    const rootPEM = `\n-----BEGIN CERTIFICATE-----\nMIIEBDCCAuygAwIBAgIDAjppMA0GCSqGSIb3DQEBBQUAMEIxCzAJBgNVBAYTAlVT\nMRYwFAYDVQQKEw1HZW9UcnVzdCBJbmMuMRswGQYDVQQDExJHZW9UcnVzdCBHbG9i\nYWwgQ0EwHhcNMTMwNDA1MTUxNTU1WhcNMTUwNDA0MTUxNTU1WjBJMQswCQYDVQQG\nEwJVUzETMBEGA1UEChMKR29vZ2xlIEluYzElMCMGA1UEAxMcR29vZ2xlIEludGVy\nbmV0IEF1dGhvcml0eSBHMjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEB\nAJwqBHdc2FCROgajguDYUEi8iT/xGXAaiEZ+4I/F8YnOIe5a/mENtzJEiaB0C1NP\nVaTOgmKV7utZX8bhBYASxF6UP7xbSDj0U/ck5vuR6RXEz/RTDfRK/J9U3n2+oGtv\nh8DQUB8oMANA2ghzUWx//zo8pzcGjr1LEQTrfSTe5vn8MXH7lNVg8y5Kr0LSy+rE\nahqyzFPdFUuLH8gZYR/Nnag+YyuENWllhMgZxUYi+FOVvuOAShDGKuy6lyARxzmZ\nEASg8GF6lSWMTlJ14rbtCMoU/M4iarNOz0YDl5cDfsCx3nuvRTPPuj5xt970JSXC\nDTWJnZ37DhF5iR43xa+OcmkCAwEAAaOB+zCB+DAfBgNVHSMEGDAWgBTAephojYn7\nqwVkDBF9qn1luMrMTjAdBgNVHQ4EFgQUSt0GFhu89mi1dvWBtrtiGrpagS8wEgYD\nVR0TAQH/BAgwBgEB/wIBADAOBgNVHQ8BAf8EBAMCAQYwOgYDVR0fBDMwMTAvoC2g\nK4YpaHR0cDovL2NybC5nZW90cnVzdC5jb20vY3Jscy9ndGdsb2JhbC5jcmwwPQYI\nKwYBBQUHAQEEMTAvMC0GCCsGAQUFBzABhiFodHRwOi8vZ3RnbG9iYWwtb2NzcC5n\nZW90cnVzdC5jb20wFwYDVR0gBBAwDjAMBgorBgEEAdZ5AgUBMA0GCSqGSIb3DQEB\nBQUAA4IBAQA21waAESetKhSbOHezI6B1WLuxfoNCunLaHtiONgaX4PCVOzf9G0JY\n/iLIa704XtE7JW4S615ndkZAkNoUyHgN7ZVm2o6Gb4ChulYylYbc3GrKBIxbf/a/\nzG+FA1jDaFETzf3I93k9mTXwVqO94FntT0QJo544evZG0R0SnU++0ED8Vf4GXjza\nHFa9llF7b1cq26KqltyMdMKVvvBulRP/F/A8rLIQjcxz++iPAsbw+zOzlTvjwsto\nWHPbqCRiOwY1nQ2pM714A5AuTHhdUDqB1O6gyHA43LL5Z/qHQF1hwFGPa4NrzQU6\nyuGnBXj8ytqU0CwIPX4WecigUCAkVDNx\n-----END CERTIFICATE-----`\n\n    block, _ := pem.Decode([]byte(rootPEM))\n    var cert* x509.Certificate\n    cert, _ = x509.ParseCertificate(block.Bytes)\n    rsaPublicKey := cert.PublicKey.(*rsa.PublicKey)\n    fmt.Println(rsaPublicKey.N)\n    fmt.Println(rsaPublicKey.E)\n}\n</code></pre>\n\n<p>Playground snippet with the code above: <a href=\"https://play.golang.org/p/pn7CKVVdQF\" rel=\"noreferrer\">https://play.golang.org/p/pn7CKVVdQF</a></p>\n"}], "owner": {"reputation": 485, "user_id": 5221361, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ed56bd4393f501d4b691424cc689a75?s=128&d=identicon&r=PG&f=1", "display_name": "Gakho", "link": "https://stackoverflow.com/users/5221361/gakho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10769, "favorite_count": 3, "accepted_answer_id": 33088784, "answer_count": 1, "score": 7, "last_activity_date": 1510087742, "creation_date": 1444373277, "last_edit_date": 1444419984, "question_id": 33031658, "link": "https://stackoverflow.com/questions/33031658/getting-rsa-public-key-from-certificate-in-golang", "title": "Getting RSA Public Key from Certificate in Golang", "body": "<p>I can't find it in the functions that a Certificate has in <a href=\"https://golang.org/pkg/crypto/x509/\" rel=\"noreferrer\">https://golang.org/pkg/crypto/x509/</a></p>\n\n<p>But, how do I get a Public Key as defined in <a href=\"https://golang.org/pkg/crypto/rsa/#PublicKey\" rel=\"noreferrer\">https://golang.org/pkg/crypto/rsa/#PublicKey</a> from a Certificate in Go?</p>\n"}, {"tags": ["arrays", "go", "variable-assignment"], "comments": [{"owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 0, "creation_date": 1444373335, "post_id": 33031354, "comment_id": 53885203, "body": "You have to define your data structures"}, {"owner": {"reputation": 720, "user_id": 1752124, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f37430e935542dafdc7f86c6e9fa03e4?s=128&d=identicon&r=PG", "display_name": "ravi", "link": "https://stackoverflow.com/users/1752124/ravi"}, "reply_to_user": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 3, "creation_date": 1444716699, "post_id": 33031354, "comment_id": 54006397, "body": "Can someone point out the reasons for down votes, so that I can put my questions in a better way next time."}], "answers": [{"tags": [], "owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "is_accepted": true, "score": 22, "last_activity_date": 1444373568, "creation_date": 1444373568, "answer_id": 33031739, "question_id": 33031354, "link": "https://stackoverflow.com/questions/33031354/how-to-create-array-of-objects-in-golang/33031739#33031739", "title": "How to create array of objects in golang?", "body": "<p>What you're asking for is possible -- <a href=\"https://play.golang.org/p/PjUa4Yjx0C\" rel=\"noreferrer\">playground link</a>:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    v := []interface{}{\n        map[string]string{\"name\": \"ravi\"},\n        []string{\"art\", \"coding\", \"music\", \"travel\"},\n        map[string]string{\"language\": \"golang\"},\n        map[string]string{\"experience\": \"no\"},\n    }\n    fmt.Println(v)\n}\n</code></pre>\n\n<p>But you probably don't want to be doing this.  You're fighting the type system, I would question why you're using Go if you were doing it like this.  Consider leveraging the type system -- <a href=\"https://play.golang.org/p/oy1QfHgWKE\" rel=\"noreferrer\">playground link</a>:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype candidate struct {\n    name string\n    interests []string\n    language string\n    experience bool\n}\n\nfunc main() {\n    candidates := []candidate{\n        {\n            name: \"ravi\",\n            interests: []string{\"art\", \"coding\", \"music\", \"travel\"},\n            language: \"golang\",\n            experience: false,\n        },\n    }\n    fmt.Println(candidates)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "is_accepted": false, "score": -3, "last_activity_date": 1444374107, "creation_date": 1444374107, "answer_id": 33031894, "question_id": 33031354, "link": "https://stackoverflow.com/questions/33031354/how-to-create-array-of-objects-in-golang/33031894#33031894", "title": "How to create array of objects in golang?", "body": "<p>Perfect python syntax, but go unfortunately use something less readable.\n<a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"nofollow\">https://golang.org/ref/spec#Composite_literals</a> </p>\n"}], "owner": {"reputation": 720, "user_id": 1752124, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f37430e935542dafdc7f86c6e9fa03e4?s=128&d=identicon&r=PG", "display_name": "ravi", "link": "https://stackoverflow.com/users/1752124/ravi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29649, "favorite_count": 7, "accepted_answer_id": 33031739, "answer_count": 2, "score": 14, "last_activity_date": 1444729157, "creation_date": 1444372176, "last_edit_date": 1444729157, "question_id": 33031354, "link": "https://stackoverflow.com/questions/33031354/how-to-create-array-of-objects-in-golang", "title": "How to create array of objects in golang?", "body": "<p>I have a requirement in which I need to store array of objects in a variable. The objects are of different types. Refer to following example:</p>\n\n<pre><code> v := [ {\"name\":\"ravi\"},\n        [\"art\",\"coding\",\"music\",\"travel\"],\n        {\"language\":\"golang\"},\n        {\"experience\":\"no\"}\n      ]\n</code></pre>\n\n<p>Notice the second element is array of string itself. After research, I thought of storing this as interface type like:</p>\n\n<pre><code> var v interface{} = [ {\"name\":\"ravi\"},\n                       [\"art\",\"coding\",\"music\",\"travel\"],\n                       {\"language\":\"golang\"},\n                       {\"experience\":\"no\"}\n                     ]\n</code></pre>\n\n<p>Still, I am getting few compilation errors which I am not able to find out.</p>\n"}, {"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1444361894, "post_id": 33029462, "comment_id": 53881192, "body": "there are you interfaces in your code."}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1444362346, "post_id": 33029462, "comment_id": 53881311, "body": "I&#39;ve corrected the question"}], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 6, "last_activity_date": 1444362325, "creation_date": 1444362325, "answer_id": 33029581, "question_id": 33029462, "link": "https://stackoverflow.com/questions/33029462/how-to-detect-if-an-interface-is-a-pointer/33029581#33029581", "title": "How to detect if an interface{} is a pointer?", "body": "<p>Use a type switch if you already know the type(s):</p>\n\n<pre><code>switch v.(type) {\ncase *str:\n    return \"*str\"\ncase str:\n    return \"str\"\n}\n</code></pre>\n\n<p>If you don't, then you can use <code>if reflect.TypeOf(v).Kind() == reflect.Ptr {}</code></p>\n\n<p><a href=\"http://play.golang.org/p/8-leSJRhXT\"><kbd>playground</kbd></a></p>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444362470, "creation_date": 1444361565, "last_edit_date": 1444362470, "question_id": 33029462, "link": "https://stackoverflow.com/questions/33029462/how-to-detect-if-an-interface-is-a-pointer", "title": "How to detect if an interface{} is a pointer?", "body": "<p>I'm wondering how can you know if the interface is of type pointer.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"reflect\"\n\ntype str struct {\n    a, b string\n}\n\nfunc main() {\n    var s str\n    x := &amp;s\n    t := reflect.TypeOf(interface{}(x))\n    fmt.Printf(\"%v\", t.Size())\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1444387671, "post_id": 33029228, "comment_id": 53893579, "body": "If you know the type, why not just use a type assertion?"}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444424223, "post_id": 33029228, "comment_id": 53914962, "body": "@JimB, but I don&#39;t know it, thus the reason why there is an interface{}."}], "answers": [{"tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": false, "score": 3, "last_activity_date": 1444388311, "creation_date": 1444388311, "answer_id": 33036531, "question_id": 33029228, "link": "https://stackoverflow.com/questions/33029228/how-to-copy-clone-an-interface-pointer/33036531#33036531", "title": "How to copy/clone an interface pointer?", "body": "<p>You need <a href=\"https://golang.org/pkg/reflect/#Indirect\" rel=\"nofollow\">reflect.Indirect</a>, and also to set <code>b</code> before changing <code>s.field</code>.</p>\n\n<p>Here is some working code :</p>\n\n<p><a href=\"https://play.golang.org/p/PShhvwXjdG\" rel=\"nofollow\">https://play.golang.org/p/PShhvwXjdG</a></p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"reflect\"\n\ntype str struct {\n    field string\n}\n\nfunc main() {\n\n    s := &amp;str{field: \"astr\"}\n    a := interface{}(s)\n\n    v := reflect.Indirect(reflect.ValueOf(a))\n    b := v.Interface()\n\n    s.field = \"changed field\"\n\n    fmt.Println(a, b)\n}\n</code></pre>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1380, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1444388311, "creation_date": 1444359927, "question_id": 33029228, "link": "https://stackoverflow.com/questions/33029228/how-to-copy-clone-an-interface-pointer", "title": "How to copy/clone an interface pointer?", "body": "<p>I'm trying to make a copy of a pointer received as interface{}. Any idea how to do that? I've tried Reflect.Value.Interface() but it returns the pointer/ address itself instead to return its value (deference). I'm also wondering if there is a signifiant performance loss as I'm planning doing this kind of copy vs simple pointer deference.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"reflect\"\n\ntype str struct {\n    field string\n}\n\nfunc main() {\n    s := &amp;str{field: \"astr\"}\n    a := interface{}(s)\n    v := reflect.ValueOf(a)\n    s.field = \"changed field\"\n    b := v.Interface()\n    fmt.Println(a, b)\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/rFmJGrLVaa\" rel=\"noreferrer\">http://play.golang.org/p/rFmJGrLVaa</a></p>\n"}, {"tags": ["templates", "variables", "go", "go-templates"], "comments": [{"owner": {"reputation": 328, "user_id": 1176300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5382d5f3db26dfdd3d2a82db6dc99fc2?s=128&d=identicon&r=PG", "display_name": "Kokos", "link": "https://stackoverflow.com/users/1176300/kokos"}, "edited": false, "score": 1, "creation_date": 1444389737, "post_id": 33027070, "comment_id": 53894880, "body": "By writing <code>{{$prev_year:=$year}}</code> you are creating brand new variable."}], "answers": [{"comments": [{"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1444591030, "post_id": 33037076, "comment_id": 53956316, "body": "Thanks a lot, but this is also problematic. Map I spent some time by thinking and I don&#39;t find really idiomatic solution. In this situation, I think, is the best return"}, {"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 1, "creation_date": 1444591443, "post_id": 33037076, "comment_id": 53956470, "body": "Thanks a lot, but this is also problematic. Map in template is rendered in ASC oreder, and I need DESC. Therefore I would create a type for year with method Less. Also sorting in my case is not necessary, real data comes from database, therefore is simple to sort that. I spent some time by thinking and I don&#39;t find really idiomatic solution. The best to maintain is probably return []struct {PrevYear *int; Tournament}"}, {"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "reply_to_user": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1444610738, "post_id": 33037076, "comment_id": 53961453, "body": "@lofcek : you&#39;re right, a map wasn&#39;t the good structure for what you want to do. I added a working example that does the job"}, {"owner": {"reputation": 2229, "user_id": 484529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rp6uy.png?s=128&g=1", "display_name": "ijt", "link": "https://stackoverflow.com/users/484529/ijt"}, "reply_to_user": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 1, "creation_date": 1488696469, "post_id": 33037076, "comment_id": 72340699, "body": "@lofcek, it looks like HectorJ answered your question. Can you accept the answer?"}], "tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": true, "score": 14, "last_activity_date": 1558940288, "last_edit_date": 1558940288, "creation_date": 1444389916, "answer_id": 33037076, "question_id": 33027070, "link": "https://stackoverflow.com/questions/33027070/variables-inside-templates-in-golang/33037076#33037076", "title": "Variables inside templates in golang", "body": "<p>Edit: See <a href=\"https://stackoverflow.com/a/52925780/1685538\">https://stackoverflow.com/a/52925780/1685538</a> for a more up-to-date answer.</p>\n\n<hr>\n\n<p>Original answer:</p>\n\n<p><a href=\"https://golang.org/pkg/text/template/#hdr-Variables\" rel=\"nofollow noreferrer\">https://golang.org/pkg/text/template/#hdr-Variables</a>:</p>\n\n<blockquote>\n  <p>A variable's scope extends to the \"end\" action of the control\n  structure (\"if\", \"with\", or \"range\") in which it is declared, or to\n  the end of the template if there is no such control structure.</p>\n</blockquote>\n\n<p>So the <code>$prev_year</code> you define with <code>{{$prev_year:=$year}}</code> only lives until.. the next line (<code>{{end}}</code>).</p>\n\n<p>It seems there is no way of going around that.</p>\n\n<p>The \"right\" way to do this is to take that logic out of your template, and do the grouping in your Go code.</p>\n\n<p>Here is a working example : <a href=\"https://play.golang.org/p/DZoSXo9WQR\" rel=\"nofollow noreferrer\">https://play.golang.org/p/DZoSXo9WQR</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"text/template\"\n    \"time\"\n)\n\ntype Tournament struct {\n    Place string\n    Date  time.Time\n}\n\ntype TournamentGroup struct {\n    Year        int\n    Tournaments []Tournament\n}\n\nfunc groupTournamentsByYear(tournaments []Tournament) []TournamentGroup {\n    if len(tournaments) == 0 {\n        return nil\n    }\n\n    result := []TournamentGroup{\n        {\n            Year:        tournaments[0].Date.Year(),\n            Tournaments: make([]Tournament, 0, 1),\n        },\n    }\n\n    i := 0\n    for _, tournament := range tournaments {\n        year := tournament.Date.Year()\n        if result[i].Year == year {\n            // Add to existing group\n            result[i].Tournaments = append(result[i].Tournaments, tournament)\n        } else {\n            // New group\n            result = append(result, TournamentGroup{\n                Year: year,\n                Tournaments: []Tournament{\n                    tournament,\n                },\n            })\n            i++\n        }\n    }\n\n    return result\n}\n\nfunc main() {\n    tournaments := []Tournament{\n        // for clarity - date is sorted, we don't need sort it again\n        {\"Town1\", time.Date(2015, time.November, 10, 23, 0, 0, 0, time.Local)},\n        {\"Town2\", time.Date(2015, time.October, 10, 23, 0, 0, 0, time.Local)},\n        {\"Town3\", time.Date(2014, time.November, 10, 23, 0, 0, 0, time.Local)},\n    }\n\n    t, err := template.New(\"\").Parse(`\n{{$prev_year:=0}}\n{{range .}}\n    Actions in year {{.Year}}:\n    {{range .Tournaments}}\n\n            {{.Place}}, {{.Date}}\n    {{end}}\n    {{end}}\n\n    `)\n    if err != nil {\n        panic(err)\n    }\n    err = t.Execute(os.Stdout, groupTournamentsByYear(tournaments))\n    if err != nil {\n        fmt.Println(\"executing template:\", err)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3519, "user_id": 1523072, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/300fdf9ab1bd6f3bb12aac1dacb2d41a?s=128&d=identicon&r=PG", "display_name": "Peter Ilfrich", "link": "https://stackoverflow.com/users/1523072/peter-ilfrich"}, "is_accepted": false, "score": 5, "last_activity_date": 1521610838, "last_edit_date": 1521610838, "creation_date": 1521599481, "answer_id": 49397181, "question_id": 33027070, "link": "https://stackoverflow.com/questions/33027070/variables-inside-templates-in-golang/49397181#49397181", "title": "Variables inside templates in golang", "body": "<p>As mentioned by <a href=\"https://stackoverflow.com/a/33037076/1523072\">this</a> answer, the scope of that variable \"re-assignment\" ends with the <code>{{end}}</code> block. Therefore using standard variables <strong>only</strong> there's no way around the problem and it should be solved inside the Go program executing the template.</p>\n\n<p>In some frameworks however this is not that easy (e.g. protoc-gen-gotemplate).</p>\n\n<p>The <a href=\"http://masterminds.github.io/sprig/\" rel=\"noreferrer\">Sprig library</a> adds additional functionality to the standard template language. One of them are mutable maps that can be used in the following way:</p>\n\n<pre><code>// init the dictionary (you can init it without initial key/values as well)\n{{$myVar := dict \"key\" \"value\"}}\n\n// getting the \"key\" from the dictionary (returns array) and then fetching the first element from that array\n{{pluck \"key\" $myVar | first}}\n\n// conditional update block\n{{if eq \"some\" \"some\"}}\n     // the $_ seems necessary because Go template functions need to return something\n     {{$_ := set $myVar \"key\" \"newValue\"}}\n{{end}}\n\n// print out the updated value\n{{pluck \"key\" $myVar | first}}\n</code></pre>\n\n<p>This little example prints out:</p>\n\n<pre><code>value\nnewValue\n</code></pre>\n\n<p>A pragmatic approach would be to use a single dictionary for all mutable variables and store them under their corresponding variable name as key.</p>\n\n<p>Reference: </p>\n\n<ul>\n<li><a href=\"http://masterminds.github.io/sprig/dicts.html\" rel=\"noreferrer\">http://masterminds.github.io/sprig/dicts.html</a></li>\n<li><a href=\"https://github.com/Masterminds/sprig\" rel=\"noreferrer\">https://github.com/Masterminds/sprig</a></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 645, "user_id": 2411557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae8c9f0ccda3c134c0c25589100dbe97?s=128&d=identicon&r=PG", "display_name": "Marc Tamsky", "link": "https://stackoverflow.com/users/2411557/marc-tamsky"}, "edited": false, "score": 0, "creation_date": 1566843252, "post_id": 52925780, "comment_id": 101774743, "body": "<code>{{$prev_year:=0}}</code> before the <code>{{range}}</code> block is key.  Variable must be initialized before assignment."}], "tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": false, "score": 11, "last_activity_date": 1540199231, "creation_date": 1540199231, "answer_id": 52925780, "question_id": 33027070, "link": "https://stackoverflow.com/questions/33027070/variables-inside-templates-in-golang/52925780#52925780", "title": "Variables inside templates in golang", "body": "<p>In go1.11 <a href=\"https://golang.org/doc/go1.11#text/template\" rel=\"noreferrer\">text/template and hence html/template became able to set the value of existing variables</a>, which means that the original code can be made to work with one very small modification.</p>\n\n<p>Change</p>\n\n<pre><code>{{$prev_year:=$year}}\n</code></pre>\n\n<p>To</p>\n\n<pre><code>{{$prev_year = $year}}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/c4t7J19_Quj\" rel=\"noreferrer\">Playground</a></p>\n"}], "owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49054, "favorite_count": 5, "accepted_answer_id": 33037076, "answer_count": 3, "score": 14, "last_activity_date": 1558940288, "creation_date": 1444343752, "last_edit_date": 1544615113, "question_id": 33027070, "link": "https://stackoverflow.com/questions/33027070/variables-inside-templates-in-golang", "title": "Variables inside templates in golang", "body": "<p>What is the namespace of variables inside <code>html/text</code> templates? I thought that a variable <code>$x</code> can change value inside a template, but this example shows me that I cannot.</p>\n\n<p>I failed when I tried to group tournaments according year - something like this (<a href=\"http://play.golang.org/p/EX1Aut_ULD\" rel=\"noreferrer\">http://play.golang.org/p/EX1Aut_ULD</a>):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"text/template\"\n    \"time\"\n)\n\nfunc main() {\n    tournaments := []struct {\n        Place string\n        Date  time.Time\n    }{\n        // for clarity - date is sorted, we don't need sort it again\n        {\"Town1\", time.Date(2015, time.November, 10, 23, 0, 0, 0, time.Local)},\n        {\"Town2\", time.Date(2015, time.October, 10, 23, 0, 0, 0, time.Local)},\n        {\"Town3\", time.Date(2014, time.November, 10, 23, 0, 0, 0, time.Local)},\n    }\n    t, err := template.New(\"\").Parse(`\n{{$prev_year:=0}}\n{{range .}}\n    {{with .Date}}\n        {{$year:=.Year}}\n                    {{if ne $year $prev_year}}\n                        Actions in year {{$year}}:\n                {{$prev_year:=$year}}\n            {{end}}\n    {{end}}\n\n        {{.Place}}, {{.Date}}\n    {{end}}\n\n    `)\n    if err != nil {\n        panic(err)\n    }\n    err = t.Execute(os.Stdout, tournaments)\n    if err != nil {\n        fmt.Println(\"executing template:\", err)\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "cryptography", "digital-signature", "x509"], "answers": [{"tags": [], "owner": {"reputation": 30089, "user_id": 22147, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/x74x2.png?s=128&g=1", "display_name": "Rhythmic Fistman", "link": "https://stackoverflow.com/users/22147/rhythmic-fistman"}, "is_accepted": true, "score": 0, "last_activity_date": 1444354959, "creation_date": 1444354959, "answer_id": 33028606, "question_id": 33026915, "link": "https://stackoverflow.com/questions/33026915/x509-checksignature-parameter/33028606#33028606", "title": "x509 CheckSignature parameter", "body": "<p><code>signed</code> looks to be the certificate in ASN.1 DER format of the <em>signer</em>.</p>\n"}], "owner": {"reputation": 485, "user_id": 5221361, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ed56bd4393f501d4b691424cc689a75?s=128&d=identicon&r=PG&f=1", "display_name": "Gakho", "link": "https://stackoverflow.com/users/5221361/gakho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 1, "accepted_answer_id": 33028606, "answer_count": 1, "score": 1, "last_activity_date": 1444354959, "creation_date": 1444342932, "last_edit_date": 1444344890, "question_id": 33026915, "link": "https://stackoverflow.com/questions/33026915/x509-checksignature-parameter", "title": "x509 CheckSignature parameter", "body": "<p>In the x509 library, there is a function called <code>CheckSignature</code>. I'm a bit lost as to what to pass into <code>signed</code>. What is it supposed to be?</p>\n\n<p>The function is </p>\n\n<pre><code>func (c *Certificate) CheckSignature(algo SignatureAlgorithm, signed, signature []byte) (err error)\n</code></pre>\n\n<p><a href=\"https://golang.org/src/crypto/x509/x509.go?s=21660:21759#L623\" rel=\"nofollow\">https://golang.org/src/crypto/x509/x509.go?s=21660:21759#L623</a></p>\n\n<p>Another thing I want to double is that if I signed something with the private key associated with the certificate, will that signature pass this <code>CheckSignature</code> function?</p>\n"}, {"tags": ["mongodb", "go", "mongodb-query"], "answers": [{"comments": [{"owner": {"reputation": 444, "user_id": 1202623, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cbae78493ed2188bfb70b0c078ceb2c3?s=128&d=identicon&r=PG", "display_name": "Nikkolasg", "link": "https://stackoverflow.com/users/1202623/nikkolasg"}, "edited": false, "score": 0, "creation_date": 1444373296, "post_id": 33028768, "comment_id": 53885177, "body": "My goodness. I will keep hitting my head and recode this thing a thousand times for punition.... Thank you ;)"}], "tags": [], "owner": {"reputation": 1039, "user_id": 382733, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e3f31a7fa1e87dbeaeabc38476f595cd?s=128&d=identicon&r=PG", "display_name": "Vitor De Mario", "link": "https://stackoverflow.com/users/382733/vitor-de-mario"}, "is_accepted": true, "score": 0, "last_activity_date": 1444356316, "creation_date": 1444356316, "answer_id": 33028768, "question_id": 33025572, "link": "https://stackoverflow.com/questions/33025572/duplicate-id-in-mongodb-with-go/33028768#33028768", "title": "Duplicate Id in mongodb with go", "body": "<p>Looks like you have a stray character in your struct tags:</p>\n\n<pre><code>type User struct {\n    Id     bson.ObjectId `json:\"id\"i bson:\"_id,omitempty\"`\n    Pseudo string        `json:\"pseudo\" bson:\"pseudo\"`\n}\n</code></pre>\n\n<p>That <code>i</code> should not exist after <code>json:\"id\"</code>. It should be:</p>\n\n<pre><code>type User struct {\n    Id     bson.ObjectId `json:\"id\" bson:\"_id,omitempty\"`\n    Pseudo string        `json:\"pseudo\" bson:\"pseudo\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 444, "user_id": 1202623, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cbae78493ed2188bfb70b0c078ceb2c3?s=128&d=identicon&r=PG", "display_name": "Nikkolasg", "link": "https://stackoverflow.com/users/1202623/nikkolasg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 750, "favorite_count": 0, "accepted_answer_id": 33028768, "answer_count": 1, "score": 0, "last_activity_date": 1444356316, "creation_date": 1444336836, "question_id": 33025572, "link": "https://stackoverflow.com/questions/33025572/duplicate-id-in-mongodb-with-go", "title": "Duplicate Id in mongodb with go", "body": "<p>I'm trying to code a simple web app in Go using Mongodb.\nI've created a minimalistic simple Model / Controller setup.\nI can create new user using POST with url \"/user\" with data such as '{\"pseudo\": \"bobby1\"}'. The user is created. However, when looking inside Mongodb shell, I get:</p>\n\n<pre><code>{ \"_id\" : ObjectId(\"5616d1ea56ca4dbc03bb83bc\"), \"id\" : ObjectId(\"5616d1ea5213c64824000001\"), \"pseudo\" : \"bobby2\"}\n</code></pre>\n\n<p>The \"id\" field is the one coming from my struct and the \"_id\" field is the one from Mongodb. From looking at different sample code, it looked like I could use myself the one from Mongodb but I can't find how to do it.. >&lt;\nSince the \"id\" is only used by me, I can't find user by their ID since I do not have that one...\nMore over, when I do a GET /user, it returns the full list of user, and I only get:</p>\n\n<pre><code>{\"id\":\"5616d1ea5213c64824000001\",\"pseudo\":\"bobby2\"\n</code></pre>\n\n<p>Not the \"real\" Mongodb Id...</p>\n\n<p>Thanks,</p>\n\n<p>Here's the code:</p>\n\n<p><strong>model/user.go</strong></p>\n\n<pre><code>const userCollection = \"user\"\n\n// Get our collection\nvar C *mgo.Collection = database.GetCollection(userCollection)\n\n// User represents the fields of a user in db\ntype User struct {\n    Id     bson.ObjectId `json:\"id\"i bson:\"_id,omitempty\"`\n    Pseudo string        `json:\"pseudo\" bson:\"pseudo\"`\n}\n\n// it will return every users in the db\nfunc UserFindAll() []User {\n    var users []User\n    err := C.Find(bson.M{}).All(&amp;users)\n    if err != nil {\n        panic(err)\n    }\n    return users\n}\n\n// UserFIndId return the user in the db with\n// corresponding ID\nfunc UserFindId(id string) User {\n    if !bson.IsObjectIdHex(id) {\n        s := fmt.Sprintf(\"Id given %s is not valid.\", id)\n        panic(errors.New(s))\n    }\n    oid := bson.ObjectIdHex(id)\n    u := User{}\n    if err := C.FindId(oid).One(&amp;u); err != nil {\n        panic(err)\n    }\n    return u\n}\n\n// UserCreate create a new user on the db\nfunc UserCreate(u *User) {\n    u.Id = bson.NewObjectId()\n    err := C.Insert(u)\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p><strong>controller/user.go</strong></p>\n\n<pre><code>/ GetAll returns all users\nfunc (us *UserController) GetAll(w http.ResponseWriter, request *http.Request) {\n    //  u := model.User{\n    //      ID:     \"987654321\",\n    //      Pseudo: \"nikko\",\n    //  }\n    users := model.UserFindAll()\n    bu, err := json.Marshal(users)\n    if err != nil {\n        fmt.Printf(\"[-] Error while marshaling user struct : %v\\n\", err)\n        w.Write([]byte(\"Error Marshaling\"))\n        w.WriteHeader(404)\n        return\n    }\n\n    w.Header().Set(\"Content-type\", \"application/json\")\n    w.WriteHeader(200)\n    fmt.Fprintf(w, \"%s\\n\", bu)\n}\n\n// Get return a specific user according to Id\nfunc (us *UserController) Get(w http.ResponseWriter, request *http.Request) {\n    vars := mux.Vars(request)\n    ps := vars[\"id\"]\n    u := model.UserFindId(ps)\n    bu, err := json.Marshal(u)\n    if err != nil {\n        fmt.Printf(\"[-] Error while marshaling user struct : %v\\n\", err)\n        w.Write([]byte(\"Error Marshaling\"))\n        w.WriteHeader(404)\n        return\n    }\n\n    w.Header().Set(\"Content-type\", \"application/json\")\n    w.WriteHeader(200)\n    fmt.Fprintf(w, \"%s\\n\", bu)\n}\n\nfunc (us *UserController) Post(w http.ResponseWriter, r *http.Request) {\n    u := model.User{}\n    json.NewDecoder(r.Body).Decode(&amp;u)\n    model.UserCreate(&amp;u)\n    bu, err := json.Marshal(u)\n\n    if err != nil {\n        fmt.Printf(\"[-] Error PUT user struct : %v\\n\", err)\n        w.WriteHeader(404)\n        return\n    }\n\n    w.Header().Set(\"Content-type\", \"application/json\")\n    w.WriteHeader(201)\n    fmt.Fprintf(w, \"%s\\n\", bu)\n}\n</code></pre>\n"}, {"tags": ["windows", "go"], "comments": [{"owner": {"reputation": 614, "user_id": 4876536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36757ceb0bbec00338926fc2ab6cda58?s=128&d=identicon&r=PG&f=1", "display_name": "fassl", "link": "https://stackoverflow.com/users/4876536/fassl"}, "edited": false, "score": 0, "creation_date": 1444340740, "post_id": 33025369, "comment_id": 53875259, "body": "You can with openssl, i dont know Go. <a href=\"http://blog.didierstevens.com/2015/03/30/howto-make-your-own-cert-with-openssl-on-windows/\" rel=\"nofollow noreferrer\">blog.didierstevens.com/2015/03/30/&hellip;</a>"}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1444638177, "post_id": 33025369, "comment_id": 53969871, "body": "CertificateRequest represents a PKCS #10, certificate signature request <a href=\"https://golang.org/pkg/crypto/x509/#CreateCertificateRequest\" rel=\"nofollow noreferrer\">https://golang.org/pkg/crypto/x509/#CreateCertificateRequest</a>"}], "owner": {"reputation": 6121, "user_id": 1513388, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/a235aa59e48586dcab866c685d042874?s=128&d=identicon&r=PG", "display_name": "user1513388", "link": "https://stackoverflow.com/users/1513388/user1513388"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1444338083, "creation_date": 1444336040, "last_edit_date": 1444338083, "question_id": 33025369, "link": "https://stackoverflow.com/questions/33025369/creating-certificate-signing-request-on-windows", "title": "Creating Certificate Signing Request on Windows", "body": "<p>Is there a way to create a CSR using Go on Windows. I need the private key to be stored in the windows certificate store.</p>\n\n<p>Any pointers would be much appreciated. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1444332167, "post_id": 33022687, "comment_id": 53870952, "body": "Normally you kill the process group: <a href=\"http://stackoverflow.com/questions/32921792/killing-processes-on-timeout-in-go-code\" title=\"killing processes on timeout in go code\">stackoverflow.com/questions/32921792/&hellip;</a>?"}, {"owner": {"reputation": 1053, "user_id": 3608492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68e469e0555fc5221b227deb0d9a305a?s=128&d=identicon&r=PG&f=1", "display_name": "Satyen Rai", "link": "https://stackoverflow.com/users/3608492/satyen-rai"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444399631, "post_id": 33022687, "comment_id": 53901449, "body": "Thanks for the pointer!"}], "owner": {"reputation": 1053, "user_id": 3608492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68e469e0555fc5221b227deb0d9a305a?s=128&d=identicon&r=PG&f=1", "display_name": "Satyen Rai", "link": "https://stackoverflow.com/users/3608492/satyen-rai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1444326574, "creation_date": 1444326574, "question_id": 33022687, "link": "https://stackoverflow.com/questions/33022687/how-to-find-and-kill-all-the-decendent-process-in-go", "title": "How to find and kill all the decendent process in Go?", "body": "<p>I am looking for a cross platform (various flavours of Unix, including Linux) to find and kill all processes spawned by my program. For Linux, I can walk to /proc to obtain this information, and I am sure I can find somethinf similar for OS X and *BSD. But I'd prefer if there were a standard library for this.</p>\n\n<p>Background: I am writing a custom job schedular which needs to terminate the jobs that don't complete within a given period of time. Simply killing (SIGTERM, followed by SIGKILL- if the formar is not ignored) the child process works fine when the job doesn't spawn any other process or handles SIGTERM properly and takes care of the cleanup. But I don't control the jobs - and I know at least some that are poorly written. In the latter case, the system is left with a bunch of orphaned process which keep holdin on to certain resouces and cause all sorts of problems.</p>\n\n<p>Any pointer to libraries or some cross platform way of doing this would be welcome.</p>\n"}, {"tags": ["go", "cloud-foundry", "ibm-cloud"], "answers": [{"comments": [{"owner": {"reputation": 4055, "user_id": 1427084, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zT5I_gPn0kw/AAAAAAAAAAI/AAAAAAAAADo/Bn7X3Tf8GmU/photo.jpg?sz=128", "display_name": "James Thomas", "link": "https://stackoverflow.com/users/1427084/james-thomas"}, "reply_to_user": {"reputation": 4817, "user_id": 3817025, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/02fd68a33285e876c0b9652ccb9fbc3a?s=128&d=identicon&r=PG", "display_name": "Jeff Sloyer", "link": "https://stackoverflow.com/users/3817025/jeff-sloyer"}, "edited": false, "score": 0, "creation_date": 1444324629, "post_id": 33021812, "comment_id": 53866739, "body": "TBH I&#39;m not sure you need both."}], "tags": [], "owner": {"reputation": 4055, "user_id": 1427084, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zT5I_gPn0kw/AAAAAAAAAAI/AAAAAAAAADo/Bn7X3Tf8GmU/photo.jpg?sz=128", "display_name": "James Thomas", "link": "https://stackoverflow.com/users/1427084/james-thomas"}, "is_accepted": true, "score": 3, "last_activity_date": 1444323845, "last_edit_date": 1444323845, "creation_date": 1444323525, "answer_id": 33021812, "question_id": 33021094, "link": "https://stackoverflow.com/questions/33021094/go-worker-app-not-starting-in-cloud-foundry/33021812#33021812", "title": "Go worker app not starting in Cloud Foundry", "body": "<p><strong>Remove the './' prefix from the Procfile.</strong></p>\n\n<p>It should only contain the command name. </p>\n\n<pre><code>worker: slack-disable-2fa\n</code></pre>\n\n<p><strong>Also Remove the './' prefix from the manifest.yml.</strong></p>\n\n<pre><code>  command: slack-disable-2fa\n</code></pre>\n"}], "owner": {"reputation": 4817, "user_id": 3817025, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/02fd68a33285e876c0b9652ccb9fbc3a?s=128&d=identicon&r=PG", "display_name": "Jeff Sloyer", "link": "https://stackoverflow.com/users/3817025/jeff-sloyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 0, "accepted_answer_id": 33021812, "answer_count": 1, "score": 1, "last_activity_date": 1444323845, "creation_date": 1444321290, "question_id": 33021094, "link": "https://stackoverflow.com/questions/33021094/go-worker-app-not-starting-in-cloud-foundry", "title": "Go worker app not starting in Cloud Foundry", "body": "<p>I am trying to run a go worker app (no binding to a route) in Cloud Foundry.  I can start the Go binary locally and it works fine.</p>\n\n<p>When the app tries to start in Cloud Foundry I get the following error.</p>\n\n<pre><code>2015-10-08T12:23:50.49-0400 [STG/127]    OUT -----&gt; Downloaded app package (1.1M)\n2015-10-08T12:23:53.48-0400 [STG/127]    OUT -----&gt; Downloaded app buildpack cache (75M)\n2015-10-08T12:23:55.45-0400 [STG/0]      ERR Cloning into '/tmp/buildpacks/go-buildpack'...\n2015-10-08T12:23:57.48-0400 [STG/0]      OUT Submodule 'compile-extensions' (https://github.com/cloudfoundry/compile-extensions.git) registered for path 'compile-extensions'\n2015-10-08T12:23:57.53-0400 [STG/0]      ERR Cloning into 'compile-extensions'...\n2015-10-08T12:23:58.51-0400 [STG/0]      OUT Submodule path 'compile-extensions': checked out 'b5e0cf7be729718d162d56709ec7f27d34e68c7c'\n2015-10-08T12:23:58.58-0400 [STG/0]      OUT -------&gt; Buildpack version 1.6.2\n2015-10-08T12:23:58.65-0400 [STG/0]      OUT -----&gt; Checking Godeps/Godeps.json file.\n2015-10-08T12:23:58.69-0400 [STG/0]      OUT -----&gt; Using go1.5.1\n2015-10-08T12:23:58.73-0400 [STG/0]      OUT -----&gt; Running: godep go install -tags cloudfoundry ./...\n2015-10-08T12:24:01.01-0400 [STG/127]    OUT -----&gt; Uploading droplet (1.8M)\n2015-10-08T12:24:23.98-0400 [DEA/127]    OUT Starting app instance (index 0) with guid 8b427c83-67b7-463e-99cd-53a4ad4154ac\n2015-10-08T12:24:37.04-0400 [API/1]      OUT App instance exited with guid 8b427c83-67b7-463e-99cd-53a4ad4154ac payload: {\"cc_partition\"=&gt;\"default\", \"droplet\"=&gt;\"8b427c83-67b7-463e-99cd-53a4ad4154ac\", \"version\"=&gt;\"9f5da0a0-1b4c-4907-a92a-40b4ce6d5669\", \"instance\"=&gt;\"73b999f6770949098d59bef51e81d31d\", \"index\"=&gt;0, \"reason\"=&gt;\"CRASHED\", \"exit_status\"=&gt;126, \"exit_description\"=&gt;\"failed to start\", \"crash_timestamp\"=&gt;1444321477}\n2015-10-08T12:24:37.04-0400 [API/8]      OUT App instance exited with guid 8b427c83-67b7-463e-99cd-53a4ad4154ac payload: {\"cc_partition\"=&gt;\"default\", \"droplet\"=&gt;\"8b427c83-67b7-463e-99cd-53a4ad4154ac\", \"version\"=&gt;\"9f5da0a0-1b4c-4907-a92a-40b4ce6d5669\", \"instance\"=&gt;\"73b999f6770949098d59bef51e81d31d\", \"index\"=&gt;0, \"reason\"=&gt;\"CRASHED\", \"exit_status\"=&gt;126, \"exit_description\"=&gt;\"app instance exited\", \"crash_timestamp\"=&gt;1444321477}\n</code></pre>\n\n<p>Below is my <code>Procfile</code>.</p>\n\n<pre><code>worker: ./slack-disable-2fa\n</code></pre>\n\n<p>Below is my <code>manifest.yml</code> file.</p>\n\n<pre><code>applications:\n- path: .\n  memory: 512MB\n  instances: 1\n  domain: mybluemix.net\n  name: myapp\n  host: myapp\n  no-route: true\n  disk_quota: 1024M\n  command: ./slack-disable-2fa\n  buildpack: https://github.com/cloudfoundry/go-buildpack.git\n</code></pre>\n\n<p>Snippet from the go app (<code>slack-disable-2fa.go</code>)</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\n\nfunc main() {\n\n    for {\n        fmt.Printf(\"hello\\n\")\n        fmt.Printf(\"Running again in 24 hours...\\n\")\n        time.Sleep(time.Hour * 1)\n    }\n\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "is_accepted": true, "score": 2, "last_activity_date": 1444320952, "last_edit_date": 1444320952, "creation_date": 1444320543, "answer_id": 33020862, "question_id": 33020521, "link": "https://stackoverflow.com/questions/33020521/goroutine-only-passes-half-of-values-through-channel/33020862#33020862", "title": "goroutine only passes half of values through channel", "body": "<p>If we simplify a bit, a slice in Go is basically a pointer to an array, so by passing a slice that you still own and modify through a channel, you create a data race.</p>\n\n<p>There is no telling if the contents of the slice are modified between the moment it is passed to the channel and the moment it is read from the channel by another goroutine.</p>\n\n<p>So your whole algorithm leads to undefined behaviour, because you only pass the same contents over and over again while modifying them.</p>\n\n<p>A solution in your case would be to copy the slice before sending it through the channel:</p>\n\n<pre><code>buf := make([]byte, len(res))\ncopy(buf, res)\nresult &lt;- buf\n</code></pre>\n\n<p>See it running here: <a href=\"http://play.golang.org/p/ulLYy9Uqnp\" rel=\"nofollow\">http://play.golang.org/p/ulLYy9Uqnp</a></p>\n\n<p>Also, I don't recommend using <code>len</code> as a variable name, because it can conflict with the <code>len()</code> builtin function.</p>\n"}], "owner": {"reputation": 14004, "user_id": 41241, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/10e7a4afa4bebca010d372055bcb694f?s=128&d=identicon&r=PG", "display_name": "Nathaniel Flath", "link": "https://stackoverflow.com/users/41241/nathaniel-flath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 33020862, "answer_count": 1, "score": 0, "last_activity_date": 1444320952, "creation_date": 1444319565, "question_id": 33020521, "link": "https://stackoverflow.com/questions/33020521/goroutine-only-passes-half-of-values-through-channel", "title": "goroutine only passes half of values through channel", "body": "<p>I have a file:</p>\n\n<pre><code>package main\nimport \"fmt\"\n\nfunc\ncombinations(result chan []byte, len int, min byte, max byte) {\n    res := make([]byte,len)\n    for i := 0; i &lt; len; i++ {\n        res[i] = min\n    }\n    result &lt;- res\n    for true {\n        i := 0\n        for i = 0; i &lt; len; i++ {\n            if res[i] &lt; max {\n                res[i] = res[i] + 1;\n                break\n            } else {\n                res[i] = 32\n            }\n        }\n        result &lt;- res\n        if(i == len) {\n            close(result)\n            return;\n        }\n    }\n}\n\nfunc\nmain() {\n    combination_chan := make(chan []byte)\n    go combinations(combination_chan, 2, 0, 5)\n    for next_combination := range combination_chan {\n        fmt.Printf(\"%x\\n\",next_combination)\n    }\n}\n</code></pre>\n\n<p>I expect this to print all possible combinations of 2 bytes between 0 and 5, IE:</p>\n\n<pre><code>0000\n0100\n...\n0001\n...\n0505\n</code></pre>\n\n<p>However, it seems to skip every other value, and print the same value twice, IE:</p>\n\n<pre><code>0100\n0100\n0300\n0300\n...\n</code></pre>\n\n<p>Why would it be doing this?  I've inserted prints before the 'result &lt;- res' line, and those are all correct.</p>\n"}, {"tags": ["java", "python", "go", "base64", "amazon-sqs"], "answers": [{"comments": [{"owner": {"reputation": 1053, "user_id": 3608492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68e469e0555fc5221b227deb0d9a305a?s=128&d=identicon&r=PG&f=1", "display_name": "Satyen Rai", "link": "https://stackoverflow.com/users/3608492/satyen-rai"}, "edited": false, "score": 0, "creation_date": 1444367431, "post_id": 33027422, "comment_id": 53882739, "body": "I just wish the behaviour was consistent across various SDKs. Or there were a clear rule book saying which languages auto encode and which don&#39;t - instead of having to throughly go through every API referance."}, {"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "reply_to_user": {"reputation": 1053, "user_id": 3608492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68e469e0555fc5221b227deb0d9a305a?s=128&d=identicon&r=PG&f=1", "display_name": "Satyen Rai", "link": "https://stackoverflow.com/users/3608492/satyen-rai"}, "edited": false, "score": 0, "creation_date": 1444392279, "post_id": 33027422, "comment_id": 53896293, "body": "Seems legit.  But boto is, or at least originally was, not an SDK. More of an adopted stepchild. <a href=\"https://aws.amazon.com/blogs/aws/big-news-regarding-python-boto-and-aws/\" rel=\"nofollow noreferrer\">aws.amazon.com/blogs/aws/big-news-regarding-python-boto-and-&zwnj;&#8203;aws</a>"}, {"owner": {"reputation": 398, "user_id": 2117367, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8gYLw.png?s=128&g=1", "display_name": "bappak", "link": "https://stackoverflow.com/users/2117367/bappak"}, "edited": false, "score": 0, "creation_date": 1583264385, "post_id": 33027422, "comment_id": 107055594, "body": "Does boto3 also automatically encode and decode SQS messages with Base64 encoding?"}, {"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "reply_to_user": {"reputation": 398, "user_id": 2117367, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8gYLw.png?s=128&g=1", "display_name": "bappak", "link": "https://stackoverflow.com/users/2117367/bappak"}, "edited": false, "score": 0, "creation_date": 1583528173, "post_id": 33027422, "comment_id": 107160939, "body": "@bappak it shouldn&#39;t, otherwise the <a href=\"https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sqs.html#SQS.Client.send_message\" rel=\"nofollow noreferrer\">warning in the boto docs</a> that <i>&quot;A message can include only XML, JSON, and unformatted text&quot;</i> wouldn&#39;t make sense, as that&#39;s the typical reason for using base64 -- to pass arbitrary binary data across a channel that only supports character data.  Also, the data type of the <code>MessageBody</code> parameter to boto3&#39;s <code>send_message()</code> is <i>string</i>.  All of this implies that you&#39;ll need to encode the payload it yourself before passing it, if it isn&#39;t utf8 text."}], "tags": [], "owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "is_accepted": true, "score": 5, "last_activity_date": 1444345810, "creation_date": 1444345810, "answer_id": 33027422, "question_id": 33019426, "link": "https://stackoverflow.com/questions/33019426/rules-regarding-auto-encoding-of-messages-into-base64-while-submitting-to-sqs/33027422#33027422", "title": "Rules regarding auto encoding of messages into base64 while submitting to SQS", "body": "<p>You probably want to encode your messages as <em>something</em> because SQS does not accept every possible byte combination in message payload, at the API.  Only valid UTF-8, tab, newline, and carriage return are supported.</p>\n\n<blockquote>\n  <p><strong>Important</strong></p>\n  \n  <p>The following list shows the characters (in Unicode) allowed in your message, according to the W3C XML specification. For more information, go to <a href=\"http://www.w3.org/TR/REC-xml/#charsets\" rel=\"noreferrer\">http://www.w3.org/TR/REC-xml/#charsets</a> If you send any characters not included in the list, your request will be rejected.</p>\n  \n  <p><code>#x9 | #xA | #xD | [#x20 to #xD7FF] | [#xE000 to #xFFFD] | [#x10000 to #x10FFFF]</code></p>\n  \n  <p><a href=\"http://docs.aws.amazon.com/AWSSimpleQueueService/latest/APIReference/API_SendMessage.html\" rel=\"noreferrer\">http://docs.aws.amazon.com/AWSSimpleQueueService/latest/APIReference/API_SendMessage.html</a></p>\n</blockquote>\n\n<p>The base64 alphabet clearly falls in this range, making it impossible for a message with base64 encoding to be rejected as invalid.  Of course, it also bloats your payload, since base64 expands every 3 bytes of the original message into 4 bytes of output (64 symbols limits each output byte to carrying 6 bits of usable information, 3 x 8 &rarr; 4 x 6).</p>\n\n<p>Presumably boto automatically base64-encodes and decodes messages for you in order to be \"helpful.\"  </p>\n\n<p><strong>But there is no reason why base64 has to be used at all.</strong> </p>\n\n<p>An example that comes to mind... valid JSON would also comply with the restricted character ranges supported by SQS payloads.  (Theoretically, I guess, JSON could be argued not to be an \"encoding,\" but that would be a bit pedantic).</p>\n\n<p>There is no clean way to determine whether a message needs to be decoded more than once, other than the sketchy one you proposed, but the argument could be made that if you are in a situation where the need to decode is ambiguous, then that should be eliminated. </p>\n\n<p>If boto's behavior weren't documented and there were no way to make it behave otherwise, I'd say it is wrong behavior.  But, as it is, I'll have to relent a bit and say it's just unusual.</p>\n"}], "owner": {"reputation": 1053, "user_id": 3608492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68e469e0555fc5221b227deb0d9a305a?s=128&d=identicon&r=PG&f=1", "display_name": "Satyen Rai", "link": "https://stackoverflow.com/users/3608492/satyen-rai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1316, "favorite_count": 0, "accepted_answer_id": 33027422, "answer_count": 1, "score": 3, "last_activity_date": 1444345810, "creation_date": 1444316406, "question_id": 33019426, "link": "https://stackoverflow.com/questions/33019426/rules-regarding-auto-encoding-of-messages-into-base64-while-submitting-to-sqs", "title": "Rules regarding auto encoding of messages into base64 while submitting to SQS", "body": "<p>I am developing an application in which clients (written in multiple languages - Go, C++, Python, C#, Java, Perl and possibly more in the future) submit protobuf (and in some cases, JSON) messages to SQS. At the other end, the messages are read and decoded by Python and Go clients - depending on the message type. Boto seems to automatically encode the messages into base64, but other language libraries don't seem to do so. Or maybe there are some other rules?</p>\n\n<p>Boto does have an option to submit raw messages.</p>\n\n<p>What is the expected behavior here? Am I supposed to encode messages into base64 on my own - which makes boto an odd case - or am I missing something?</p>\n\n<p>This has caused some subtle bugs in my application because an of extra layer of base64 encoding or decoding. As far as I know, there is no idiomatic way to detect whether a message is base64 encoded or not. The best option is to try to decode and see if it throws an exception - something I don't really like.</p>\n\n<p>I tried to look for some documentation, but couldn't find anything with clear guidelines. Maybe I was looking at the wrong places?</p>\n\n<p>Thanks in advance for any pointers.</p>\n"}, {"tags": ["ssh", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1444317492, "post_id": 33019398, "comment_id": 53862542, "body": "<code>exec.Command</code> isn&#39;t a shell, so there is no concept of <code>|</code>. See <a href=\"http://stackoverflow.com/questions/10781516/how-to-pipe-several-commands-in-go\" title=\"how to pipe several commands in go\">stackoverflow.com/questions/10781516/&hellip;</a>"}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1444319365, "post_id": 33019398, "comment_id": 53863765, "body": "You can use exec.Command to execute shell though: <code>sh -c command</code>"}], "answers": [{"comments": [{"owner": {"reputation": 863, "user_id": 2218023, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/JmNYB.jpg?s=128&g=1", "display_name": "Alessandro Resta", "link": "https://stackoverflow.com/users/2218023/alessandro-resta"}, "edited": false, "score": 0, "creation_date": 1444320448, "post_id": 33020682, "comment_id": 53864427, "body": "Thank you very much @JimB"}, {"owner": {"reputation": 117, "user_id": 6682255, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8sENID_nb9o/AAAAAAAAAAI/AAAAAAAAAA0/ieuk6e4jgXU/photo.jpg?sz=128", "display_name": "chuixue", "link": "https://stackoverflow.com/users/6682255/chuixue"}, "edited": false, "score": 0, "creation_date": 1618283288, "post_id": 33020682, "comment_id": 118548947, "body": "but when i want to copy-ssh-id, I didn&#39;t have the key installed in remote server. How to input my password? <code>&quot;ssh&quot;, &quot;user@host&quot;</code> where to input the password?"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 4, "last_activity_date": 1444320022, "creation_date": 1444320022, "answer_id": 33020682, "question_id": 33019398, "link": "https://stackoverflow.com/questions/33019398/copying-ssh-public-key-to-server/33020682#33020682", "title": "Copying ssh public key to server", "body": "<p>You don't need to execute <code>/bin/sh -c \"cat file\"</code> to read a file in Go. Open the file normally, and give that to the ssh command</p>\n\n<pre><code>keyFile, err := os.Open(filename)\nif err != nil {\n    log.Fatal(err)\n}\n\ncmd := exec.Command(\"ssh\", \"user@host\", \"cat &gt;&gt; ~/.ssh/authorized_keys\")\ncmd.Stdin = keyFile\n\n// run the command however you want\nout, err := cmd.CombinedOutput()\nif err != nil {\n    fmt.Println(string(out))\n    log.Fatal(err)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1053, "user_id": 3608492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68e469e0555fc5221b227deb0d9a305a?s=128&d=identicon&r=PG&f=1", "display_name": "Satyen Rai", "link": "https://stackoverflow.com/users/3608492/satyen-rai"}, "is_accepted": false, "score": 1, "last_activity_date": 1444327058, "creation_date": 1444327058, "answer_id": 33022812, "question_id": 33019398, "link": "https://stackoverflow.com/questions/33019398/copying-ssh-public-key-to-server/33022812#33022812", "title": "Copying ssh public key to server", "body": "<p>You could simply execute rsync or scp for this purpose.</p>\n"}], "owner": {"reputation": 863, "user_id": 2218023, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/JmNYB.jpg?s=128&g=1", "display_name": "Alessandro Resta", "link": "https://stackoverflow.com/users/2218023/alessandro-resta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 440, "favorite_count": 0, "accepted_answer_id": 33020682, "answer_count": 2, "score": 0, "last_activity_date": 1444327058, "creation_date": 1444316353, "question_id": 33019398, "link": "https://stackoverflow.com/questions/33019398/copying-ssh-public-key-to-server", "title": "Copying ssh public key to server", "body": "<p>I'm trying to add a public key under my local $HOME/.ssh/ directory using Go. </p>\n\n<p>I've been running multiple commands with this the same code without problem, but not for this particular one.</p>\n\n<pre><code>identity := fmt.Sprintf(\"cat %s/.ssh/%s.pub\", fileUtil.FindUserHomeDir(), p.sshkey.name)\naddress := fmt.Sprintf(\"| ssh %s@%s 'cat &gt;&gt; ~/.ssh/authorized_keys', p.projectname.name, p.host.name)\n\ncmd := exec.Command(identity, address)\n\nerr := cmd.Run()\nif err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p>Basically I'm trying to run:</p>\n\n<pre><code>cat /home/foo/.ssh/foobar.pub | ssh foo@bar.com 'cat &gt;&gt; ~/.shh/authorized_keys'\"\n</code></pre>\n\n<p>Which works fine if I run it through the command line directly.</p>\n\n<p>I want to run this program in different OS X machines, where some don't have ssh-copy-id installed. So, I'm not considering to use it.</p>\n\n<p>But anyway, I'm open to other suggestions. Thank you in advance.</p>\n"}, {"tags": ["git", "go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1444328532, "post_id": 33018414, "comment_id": 53868863, "body": "A short term solution is to just go into the relevant GitHub repository directory and directly issue the relevant <code>git</code> commands to change to whatever revision you wish. Unless you use <code>go get -u</code> (which tries to update to the latest version), the Go tools will leave it at the revision you manually selected."}], "answers": [{"tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": false, "score": 4, "last_activity_date": 1444317301, "last_edit_date": 1444317301, "creation_date": 1444316164, "answer_id": 33019320, "question_id": 33018414, "link": "https://stackoverflow.com/questions/33018414/how-to-checkout-a-release-with-go-get/33019320#33019320", "title": "How to checkout a release with go get?", "body": "<p>No, you'll need to use an external dependency management tool that can handle branch and version freezes. Then you use it instead of calling <code>go get</code> directly - this changes from tool to tool - and you can freeze versions. A few popular tools:</p>\n\n<ol>\n<li><p>Godep (I personally use it): <a href=\"https://github.com/tools/godep\" rel=\"nofollow\">https://github.com/tools/godep</a></p></li>\n<li><p>Nut <a href=\"https://github.com/jingweno/nut\" rel=\"nofollow\">https://github.com/jingweno/nut</a></p></li>\n<li><p>Gopm <a href=\"https://github.com/gpmgo/gopm\" rel=\"nofollow\">https://github.com/gpmgo/gopm</a></p></li>\n<li><p>Some libraries use <code>gopkg.in</code> which embeds vesions into the import urls. <a href=\"http://labix.org/gopkg.in\" rel=\"nofollow\">http://labix.org/gopkg.in</a> <em>This does allow to use go-get directly, but it depends on whether the libraries are released via gopkg</em></p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 912, "user_id": 1912391, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/890f477cf12dd59c58e326be303f04b6?s=128&d=identicon&r=PG", "display_name": "ZAky", "link": "https://stackoverflow.com/users/1912391/zaky"}, "is_accepted": false, "score": 1, "last_activity_date": 1444379568, "creation_date": 1444379568, "answer_id": 33033543, "question_id": 33018414, "link": "https://stackoverflow.com/questions/33018414/how-to-checkout-a-release-with-go-get/33033543#33033543", "title": "How to checkout a release with go get?", "body": "<p>You can fork the library and decide if you want to pull new versions to your fork. And roll back if the new version break you application.</p>\n"}], "owner": {"reputation": 2203, "user_id": 773079, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f494bf18ea8fc96190a398ecee6deedc?s=128&d=identicon&r=PG", "display_name": "Pensu", "link": "https://stackoverflow.com/users/773079/pensu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1143, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1444379568, "creation_date": 1444313860, "last_edit_date": 1444314216, "question_id": 33018414, "link": "https://stackoverflow.com/questions/33018414/how-to-checkout-a-release-with-go-get", "title": "How to checkout a release with go get?", "body": "<p>I have been trying to install a module using <code>go get github.com/xxx/xxx</code>. It used to get installed easily previously, but the maintainers release a new release and it's not working for me anymore. I am looking to know if there is any way I can get the previous release to install? By default it is installing the master branch. Is there any flag where I can put the branch info like <code>go get github.com/xxx/xxx --branch=xxx</code>?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 1, "creation_date": 1444311711, "post_id": 33017547, "comment_id": 53858022, "body": "<code>Ctrl+D</code> will send EOF to your program"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444311839, "post_id": 33017547, "comment_id": 53858114, "body": "If you don&#39;t know how many numbers there will be, why not scan the line in all at once?"}, {"owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 1, "creation_date": 1444336072, "post_id": 33017547, "comment_id": 53873123, "body": "IMHO it&#39;s unclear what you are asking. Are you trying to 1. read <i>all</i> of the numbers in a file (which looks like the first code in your question), 2. read <i>all</i> the numbers on one line (the code in your answer), or 3. read <i>exactly</i> n numbers from one line (which looks like the second code block in your question), or 4. something else? If you tell us <i>exactly</i> what you want, I&#39;m confident the community can help."}], "answers": [{"tags": [], "owner": {"reputation": 13962, "user_id": 52573, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f46863ecd43e4ac1a482558a8a13683d?s=128&d=identicon&r=PG", "display_name": "nes1983", "link": "https://stackoverflow.com/users/52573/nes1983"}, "is_accepted": false, "score": 2, "last_activity_date": 1444312399, "creation_date": 1444312399, "answer_id": 33017834, "question_id": 33017547, "link": "https://stackoverflow.com/questions/33017547/golang-scan-a-line-of-numbers-from-sdin/33017834#33017834", "title": "golang scan a line of numbers from sdin", "body": "<p>It seems that you want <a href=\"https://golang.org/pkg/fmt/#Fscanln\" rel=\"nofollow\">https://golang.org/pkg/fmt/#Fscanln</a></p>\n\n<p>Something like </p>\n\n<pre><code>ok := func(err error) { if err != nil { panic(err) } }\n\nfor {\n  var i, j, k int\n  _, err := fmt.Fscanln(io.Stdin, &amp;i, &amp;j, &amp;k)\n  ok(err)\n  fmt.Println(i, j, k)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 1, "creation_date": 1444336316, "post_id": 33017991, "comment_id": 53873225, "body": "I think the code you&#39;ve pasted is incomplete. There should be another &#39;}&#39; at the end to close the for loop. It&#39;d be nice for the <code>if nums[] ... {...}</code> to be indented too. It looks like this is reading all of the numbers on one line. Is that what you want?"}, {"owner": {"reputation": 996, "user_id": 1478734, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e7e6165d9ee3338be3582313ec6648ba?s=128&d=identicon&r=PG", "display_name": "ehrt1974", "link": "https://stackoverflow.com/users/1478734/ehrt1974"}, "reply_to_user": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 0, "creation_date": 1444383609, "post_id": 33017991, "comment_id": 53891018, "body": "Yepp, that&#39;s what i wanted :) I&#39;d have thought there would be a way to read it with something like <code>var args []interface{}; fmt.Scanln(args...)</code> but I couldn&#39;t get that to work."}, {"owner": {"reputation": 13962, "user_id": 52573, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f46863ecd43e4ac1a482558a8a13683d?s=128&d=identicon&r=PG", "display_name": "nes1983", "link": "https://stackoverflow.com/users/52573/nes1983"}, "edited": false, "score": 0, "creation_date": 1444704060, "post_id": 33017991, "comment_id": 54002369, "body": "Did you just pass an empty interface slice? The documentation (predictably) states: &quot;All arguments to be scanned must be either pointers to basic types or implementations of the Scanner interface.&quot;"}, {"owner": {"reputation": 996, "user_id": 1478734, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e7e6165d9ee3338be3582313ec6648ba?s=128&d=identicon&r=PG", "display_name": "ehrt1974", "link": "https://stackoverflow.com/users/1478734/ehrt1974"}, "edited": false, "score": 0, "creation_date": 1444825466, "post_id": 33017991, "comment_id": 54062790, "body": "Yep, that&#39;s exactly what I did :) It didn&#39;t like <code>var args []string; fmt.Scanln(args...)</code>. I&#39;ll dig out the error message"}, {"owner": {"reputation": 13962, "user_id": 52573, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f46863ecd43e4ac1a482558a8a13683d?s=128&d=identicon&r=PG", "display_name": "nes1983", "link": "https://stackoverflow.com/users/52573/nes1983"}, "edited": false, "score": 0, "creation_date": 1445058156, "post_id": 33017991, "comment_id": 54172705, "body": "That&#39;s because []string is a different type from []interface{}.  Again, the documentation says you must pass pointers to basic types. You&#39;re not passing any pointers, so you&#39;re not getting any results.  If you pass this:  var i, j, k int; fmt.Scanln([]interface{&amp;i, &amp;j, &amp;k}...}  You&#39;ll get better results. You&#39;ll find those results in vars i, j, k.  I think the source of the confusion is that you&#39;re trying to leave open the question of how many numbers there are on a line. fmt.Scanln isn&#39;t built that way. You must pass n pointers to read n numbers."}], "tags": [], "owner": {"reputation": 996, "user_id": 1478734, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e7e6165d9ee3338be3582313ec6648ba?s=128&d=identicon&r=PG", "display_name": "ehrt1974", "link": "https://stackoverflow.com/users/1478734/ehrt1974"}, "is_accepted": false, "score": 5, "last_activity_date": 1444383516, "last_edit_date": 1444383516, "creation_date": 1444312806, "answer_id": 33017991, "question_id": 33017547, "link": "https://stackoverflow.com/questions/33017547/golang-scan-a-line-of-numbers-from-sdin/33017991#33017991", "title": "golang scan a line of numbers from sdin", "body": "<p>Ok, I decided to bring out the large bufio hammer and solve it like this:</p>\n\n<pre><code>in := bufio.NewReader(os.Stdin)\nline, err := in.ReadString('\\n')\nif err != nil {\n    log.Fatal(err)\n}\nstrs := strings.Split(line[0:len(line)-1], \" \")\nnums := make([]int, len(strs))\nfor i, str := range strs {\n    if nums[i], err = strconv.Atoi(str); err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>It does seem like an awful lot of code, but it works.</p>\n"}, {"tags": [], "owner": {"reputation": 379, "user_id": 6097285, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caed10d0c712a106142e2bb79a8cd665?s=128&d=identicon&r=PG&f=1", "display_name": "yogesh_desai", "link": "https://stackoverflow.com/users/6097285/yogesh-desai"}, "is_accepted": false, "score": 1, "last_activity_date": 1500933990, "creation_date": 1500933990, "answer_id": 45290839, "question_id": 33017547, "link": "https://stackoverflow.com/questions/33017547/golang-scan-a-line-of-numbers-from-sdin/45290839#45290839", "title": "golang scan a line of numbers from sdin", "body": "<p>I will suggest to use \"bufio\" package with the \"scan()\" method.\nFollowing is the code where I'm reading two lines from \"stdin\" and storing the lines into an array.\nHope this helps you.</p>\n\n<pre><code>package main\n\nimport (\n\n    \"fmt\"\n    \"bufio\"\n    \"os\"\n    \"strconv\"\n    \"strings\"\n)\n\nfunc ReadInput() []string{\n\n    var lines []string\n    scanner := bufio.NewScanner(os.Stdin)\n\n    for scanner.Scan() {\n        lines = append(lines, scanner.Text())\n        //count, _ := strconv.Atoi(lines[0])\n        if len(lines) == 2 { break }\n    }\n    if err := scanner.Err(); err != nil {\n    fmt.Fprintln(os.Stderr, err)\n    }\n    return lines\n}\n\nfunc main(){\n\n    lines   := ReadInput()\n    count ,_ := strconv.Atoi(lines[0])\n    num := strings.Fields(lines[1])\n    if count != len(num) { os.Exit(0) }\n // Do whatever you want here\n}\n</code></pre>\n\n<p>Two lines will be accepted. First line will have a count. Second line will have all the numbers. You can modify the same code as per your requirement.</p>\n\n<p>Example:</p>\n\n<pre><code>3\n1 5 10 \n</code></pre>\n"}], "owner": {"reputation": 996, "user_id": 1478734, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e7e6165d9ee3338be3582313ec6648ba?s=128&d=identicon&r=PG", "display_name": "ehrt1974", "link": "https://stackoverflow.com/users/1478734/ehrt1974"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7669, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1500933990, "creation_date": 1444311648, "last_edit_date": 1444383462, "question_id": 33017547, "link": "https://stackoverflow.com/questions/33017547/golang-scan-a-line-of-numbers-from-sdin", "title": "golang scan a line of numbers from sdin", "body": "<p>I'm trying to read input from stdin like</p>\n\n<pre><code>3 2 1&lt;ENTER&gt;\n</code></pre>\n\n<p>and save it in a list of ints. At the moment my code looks like this:</p>\n\n<pre><code>nums = make([]int, 0)\nvar i int\nfor {\n    _, err := fmt.Scan(&amp;i)\n    if err != nil {\n        if err==io.EOF { break }\n        log.Fatal(err)\n    }\n    nums = append(nums, i)\n}\n</code></pre>\n\n<p>at the moment the program never leaves the for-loop. I can't find an easy way to check for a newline character in the documentation. how would i do this?</p>\n\n<p>Edit:</p>\n\n<p>Since I know that there will almost certainly be four numbers, I tried the following:</p>\n\n<pre><code>var i0,i1,i2,i3 int\nfmt.Scanf(\"%d %d %d %d\\n\", &amp;i0, &amp;i1, &amp;i2, &amp;i3)\n</code></pre>\n\n<p>but this only scanned the first number and then exited the program. I'm not sure if that's because of the z-shell I'm using.</p>\n\n<p>Edit:</p>\n\n<p>To clarify, the program will pause and ask for the user to input a list of n numbers separated by spaces and terminated with a newline. these numbers should be stored in an array.</p>\n"}, {"tags": ["php", "serialization", "go", "redis"], "comments": [{"owner": {"reputation": 7615, "user_id": 1399505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87c3585b6069569985208fe061e0ab5a?s=128&d=identicon&r=PG", "display_name": "Hieu Le", "link": "https://stackoverflow.com/users/1399505/hieu-le"}, "edited": false, "score": 0, "creation_date": 1444295666, "post_id": 33011305, "comment_id": 53846497, "body": "Use JSON if  you want to serialize/deserialize  between multi languages."}], "answers": [{"comments": [{"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1444309096, "post_id": 33014012, "comment_id": 53855928, "body": "This is correct. The format also depends on the PHP version. For scalar PHP types, the decoding is quite trivial. However, for objects, you need information about their classes. See <a href=\"https://3v4l.org/8DYb7\" rel=\"nofollow noreferrer\">this</a> for example."}, {"owner": {"reputation": 12725, "user_id": 125913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69dc00171d2344fb0be796ddb7994541?s=128&d=identicon&r=PG", "display_name": "The Real Bill", "link": "https://stackoverflow.com/users/125913/the-real-bill"}, "edited": false, "score": 0, "creation_date": 1444314961, "post_id": 33014012, "comment_id": 53860715, "body": "Another alternative is to store the data in a Redis hash if it primarily consists of k/v mappings."}, {"owner": {"reputation": 39, "user_id": 5273213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8225edf7e7e3658201e31ae323d63eb4?s=128&d=identicon&r=PG&f=1", "display_name": "RieuxThomas", "link": "https://stackoverflow.com/users/5273213/rieuxthomas"}, "edited": false, "score": 0, "creation_date": 1444382139, "post_id": 33014012, "comment_id": 53890097, "body": "I know.. i would love to use json, But all the redis db is encoded like that and it is very complicated to migrate all the service to json format."}, {"owner": {"reputation": 39, "user_id": 5273213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8225edf7e7e3658201e31ae323d63eb4?s=128&d=identicon&r=PG&f=1", "display_name": "RieuxThomas", "link": "https://stackoverflow.com/users/5273213/rieuxthomas"}, "edited": false, "score": 0, "creation_date": 1444811476, "post_id": 33014012, "comment_id": 54053742, "body": "I choose to migrate the redis db json format, thanks for help and have a nice day"}], "tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": true, "score": 2, "last_activity_date": 1444302380, "creation_date": 1444302380, "answer_id": 33014012, "question_id": 33011305, "link": "https://stackoverflow.com/questions/33011305/how-to-decode-php-serialized-redis-response-with-golang/33014012#33014012", "title": "How to decode PHP serialized Redis response with Golang", "body": "<p>To read such data in your Go program you will have to reimplement <code>unserialize</code> PHP function in Go. I doubt it is an easy task though.</p>\n\n<p>A better solution would be to use a portable format to store data in Redis, such as JSON or Google Protobuf.</p>\n"}, {"comments": [{"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 0, "creation_date": 1444391029, "post_id": 33034449, "comment_id": 53895584, "body": "And here is one more : <a href=\"https://github.com/yvasiyarov/php_session_decoder/tree/master/php_serialize\" rel=\"nofollow noreferrer\">github.com/yvasiyarov/php_session_decoder/tree/master/&hellip;</a>"}, {"owner": {"reputation": 39, "user_id": 5273213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8225edf7e7e3658201e31ae323d63eb4?s=128&d=identicon&r=PG&f=1", "display_name": "RieuxThomas", "link": "https://stackoverflow.com/users/5273213/rieuxthomas"}, "reply_to_user": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 0, "creation_date": 1444660286, "post_id": 33034449, "comment_id": 53983701, "body": "this one its pretty nice"}, {"owner": {"reputation": 39, "user_id": 5273213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8225edf7e7e3658201e31ae323d63eb4?s=128&d=identicon&r=PG&f=1", "display_name": "RieuxThomas", "link": "https://stackoverflow.com/users/5273213/rieuxthomas"}, "reply_to_user": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 0, "creation_date": 1444662746, "post_id": 33034449, "comment_id": 53985365, "body": "But i can&#39;t convert the result in json"}], "tags": [], "owner": {"reputation": 39, "user_id": 5273213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8225edf7e7e3658201e31ae323d63eb4?s=128&d=identicon&r=PG&f=1", "display_name": "RieuxThomas", "link": "https://stackoverflow.com/users/5273213/rieuxthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1444382274, "creation_date": 1444382274, "answer_id": 33034449, "question_id": 33011305, "link": "https://stackoverflow.com/questions/33011305/how-to-decode-php-serialized-redis-response-with-golang/33034449#33034449", "title": "How to decode PHP serialized Redis response with Golang", "body": "<p>I found this <a href=\"https://github.com/wulijun/go-php-serialize\" rel=\"nofollow\">https://github.com/wulijun/go-php-serialize</a> i don't know if you already use it </p>\n"}], "owner": {"reputation": 39, "user_id": 5273213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8225edf7e7e3658201e31ae323d63eb4?s=128&d=identicon&r=PG&f=1", "display_name": "RieuxThomas", "link": "https://stackoverflow.com/users/5273213/rieuxthomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1982, "favorite_count": 0, "accepted_answer_id": 33014012, "answer_count": 2, "score": 0, "last_activity_date": 1491515271, "creation_date": 1444295173, "last_edit_date": 1491515271, "question_id": 33011305, "link": "https://stackoverflow.com/questions/33011305/how-to-decode-php-serialized-redis-response-with-golang", "title": "How to decode PHP serialized Redis response with Golang", "body": "<p>I have a problem with my Redis db, it is encoded with PHP serialized protocol but I don't how I can decode this data using Golang, is there something like JSON Unmarshall/Marshall for this?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 2, "creation_date": 1444293200, "post_id": 33010220, "comment_id": 53844848, "body": "Why not just copy struct Foo into struct Bar, either manually (field by field) or via reflecting over the fields? What is the reason the tags differ?"}, {"owner": {"reputation": 492, "user_id": 3001914, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8504236f484986099fe3aed935d6d190?s=128&d=identicon&r=PG&f=1", "display_name": "miguelg", "link": "https://stackoverflow.com/users/3001914/miguelg"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1444293653, "post_id": 33010220, "comment_id": 53845130, "body": "@elithrar: I&#39;m trying to avoid manually copying and using interface{} or reflection.  The tags differ because the application I&#39;m working on has different user types and it may be the case that some struct fields should not be available to all user types."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1444295248, "post_id": 33010220, "comment_id": 53846227, "body": "@miguelg if they are really identical I suppose it would be ok, as the tags are saved as part of the type info, not the data of the object. It is, though, of course, <i>unsafe</i> :)"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1444296461, "post_id": 33010220, "comment_id": 53847054, "body": "If some struct fields don&#39;t apply, selectively embed a second struct into your User struct as needed. Use Marshal/Unmarshal logic or <code>omitempty</code> tags to choose how to omit that struct when you leave it <code>nil</code>."}, {"owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1444305647, "post_id": 33010220, "comment_id": 53853287, "body": "@Not_a_Golfer I take <code>unsafe</code> to mean &quot;the safety is guaranteed by the programmer&quot; more than &quot;actually unsafe&quot;. For instance, converting an <code>f64</code> to its bits as a <code>uint64</code> via unsafe cannot in any sane implementation of the language actually be unsafe. Which is kinda why <code>math</code> does it that way. There are, of course, times when it is actually unsafe because it relies on ephemeral OS or compiler details, but that&#39;s just because <code>unsafe</code> lets you do potentially unsafe things, not that anything done with unsafe is inherently bad."}], "answers": [{"tags": [], "owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "is_accepted": true, "score": 1, "last_activity_date": 1444304800, "creation_date": 1444304800, "answer_id": 33014868, "question_id": 33010220, "link": "https://stackoverflow.com/questions/33010220/unsafe-conversion-between-identical-struct-types-where-only-tags-differ/33014868#33014868", "title": "Unsafe conversion between identical struct types where only tags differ", "body": "<p><strong>Strictly</strong> speaking, this isn't safe. The reason is that the relevant section of the <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow\">spec</a> doesn't give any guidelines for memory layout for structs. It doesn't guarantee in-memory field ordering, packing, or alignment. In theory, a compiler could, based on optimization info, decide two seemingly identical structs are to be represented differently based on their usage. This could even be a Heisenbug where the offending optimization doesn't happen in <code>go test</code> builds.</p>\n\n<p><strong>Practically</strong> speaking, this is unlikely to happen in any real compiler and you can probably do it safely. This is especially true of one field structs like the one you provided. You should probably ensure through profiling that copying is insufficient before you go doing this though.</p>\n"}, {"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1480729032, "creation_date": 1480729032, "answer_id": 40943371, "question_id": 33010220, "link": "https://stackoverflow.com/questions/33010220/unsafe-conversion-between-identical-struct-types-where-only-tags-differ/40943371#40943371", "title": "Unsafe conversion between identical struct types where only tags differ", "body": "<blockquote>\n  <p>Unfortunately Go's idiom forbids casting between two types when their tags differ and for good reason</p>\n</blockquote>\n\n<p>The <a href=\"https://beta.golang.org/doc/go1.8\" rel=\"nofollow noreferrer\">release notes for Go 1.8</a> (currently in beta) seems to indicate this restriction is now lifted:</p>\n\n<blockquote>\n  <h2>Changes to the language</h2>\n  \n  <p>When explicitly converting a value from one struct type to another, as of Go 1.8 the tags are ignored.<br>\n  <strong>Thus two structs that differ only in their tags may be converted from one to the other</strong>:</p>\n</blockquote>\n\n<pre><code>func example() {\n    type T1 struct {\n        X int `json:\"foo\"`\n    }\n    type T2 struct {\n        X int `json:\"bar\"`\n    }\n    var v1 T1\n    var v2 T2\n    v1 = T1(v2) // now legal\n}\n</code></pre>\n"}], "owner": {"reputation": 492, "user_id": 3001914, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8504236f484986099fe3aed935d6d190?s=128&d=identicon&r=PG&f=1", "display_name": "miguelg", "link": "https://stackoverflow.com/users/3001914/miguelg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 1, "accepted_answer_id": 33014868, "answer_count": 2, "score": 3, "last_activity_date": 1480729032, "creation_date": 1444292029, "last_edit_date": 1444305077, "question_id": 33010220, "link": "https://stackoverflow.com/questions/33010220/unsafe-conversion-between-identical-struct-types-where-only-tags-differ", "title": "Unsafe conversion between identical struct types where only tags differ", "body": "<p>Consider two types identical in structure but differing in their tags:</p>\n\n<pre><code>type Foo struct {\n  Id int64 `json:\"-\"`\n}\n\ntype Bar struct {\n  Id int64 `json:\"id\"`\n}\n</code></pre>\n\n<p>Unfortunately Go's idiom forbids casting between two types when their tags differ and for good reason.  However I still need to be able to control the data that is serialised to JSON and don't want to use <code>interface{}</code> types.</p>\n\n<p>My question is, how safe is it to use golang's <code>unsafe.Pointer</code> to perform casts between two types which are identical in structure (but not tags)?  Something like:</p>\n\n<pre><code>rf := &amp;Foo{1}\nrb := (*Bar)(unsafe.Pointer(rf))\n</code></pre>\n\n<p>Is there <strong>any</strong> chance at all of a panic ensuing maybe because internally the data in each of the two types is held slightly differently due to the tags differing <strong>or</strong> is the information about tags held separate from the actual type data and data in each of the types is structurally identical?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>For clarification I should mention that although the example provided above employs single-field structs, the question is really about struct types containing multiple fields.</p>\n"}, {"tags": ["go", "get", "mime-types"], "comments": [{"owner": {"reputation": 3818, "user_id": 1247113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRMFj.png?s=128&g=1", "display_name": "rob74", "link": "https://stackoverflow.com/users/1247113/rob74"}, "edited": false, "score": 0, "creation_date": 1444288118, "post_id": 33008063, "comment_id": 53841736, "body": "Your Go program is making requests to a server and you are trying to get the MIME type of the response? Have you checked if the content type is set correctly by the server?"}, {"owner": {"reputation": 421, "user_id": 2873262, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5f8b8419c1469cda8acef2c3a8546d4e?s=128&d=identicon&r=PG&f=1", "display_name": "Sunil", "link": "https://stackoverflow.com/users/2873262/sunil"}, "reply_to_user": {"reputation": 3818, "user_id": 1247113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRMFj.png?s=128&g=1", "display_name": "rob74", "link": "https://stackoverflow.com/users/1247113/rob74"}, "edited": false, "score": 0, "creation_date": 1444290099, "post_id": 33008063, "comment_id": 53842941, "body": "I&#39;m trying to crawl sites. Is it a bad idea for crawler? Because we cannot be certain about it."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1444291965, "post_id": 33008063, "comment_id": 53844100, "body": "@Sunil it&#39;s probably a badly configured server. In HTML files you can also check META tags for overriding headers or lacking headers. In JS and CSS you might want to add heuristic checks."}], "answers": [{"comments": [{"owner": {"reputation": 2245, "user_id": 462760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc47f8239d7da0dce3f07d249edacfa4?s=128&d=identicon&r=PG", "display_name": "hradac", "link": "https://stackoverflow.com/users/462760/hradac"}, "edited": false, "score": 0, "creation_date": 1444410674, "post_id": 33043637, "comment_id": 53908301, "body": "Would any down voters explain what you disagree with?"}, {"owner": {"reputation": 1047, "user_id": 1430562, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/58d917891ac131bd1957297341df0e9e?s=128&d=identicon&r=PG&f=1", "display_name": "rsz", "link": "https://stackoverflow.com/users/1430562/rsz"}, "edited": false, "score": 0, "creation_date": 1530953197, "post_id": 33043637, "comment_id": 89423505, "body": "Because the OP wanted to get the content type of the file, your solution only checks for an extension, which is unrealiable and not useful at all for what the OP wanted. (Disclosure: I did not downvote because the solution was already written in comments of the post)"}, {"owner": {"reputation": 2245, "user_id": 462760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc47f8239d7da0dce3f07d249edacfa4?s=128&d=identicon&r=PG", "display_name": "hradac", "link": "https://stackoverflow.com/users/462760/hradac"}, "reply_to_user": {"reputation": 1047, "user_id": 1430562, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/58d917891ac131bd1957297341df0e9e?s=128&d=identicon&r=PG&f=1", "display_name": "rsz", "link": "https://stackoverflow.com/users/1430562/rsz"}, "edited": false, "score": 1, "creation_date": 1531326235, "post_id": 33043637, "comment_id": 89558177, "body": "@rsz Fair enough. Looking at it again, I should have read it more carefully. I thought it was a question of how to determine MIME types in general where what OP wanted was to get the MIME type from the response header. Though I disagree about file extensions. They are how system typically determine what kind of file it is. Also, web servers use file extensions to determine the MIME type returned in the response header."}], "tags": [], "owner": {"reputation": 2245, "user_id": 462760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc47f8239d7da0dce3f07d249edacfa4?s=128&d=identicon&r=PG", "display_name": "hradac", "link": "https://stackoverflow.com/users/462760/hradac"}, "is_accepted": false, "score": 3, "last_activity_date": 1444410048, "creation_date": 1444410048, "answer_id": 33043637, "question_id": 33008063, "link": "https://stackoverflow.com/questions/33008063/how-can-i-get-mime-type-of-the-http-response-with-media-subtype/33043637#33043637", "title": "How can I get MIME type of the http response with media subtype?", "body": "<p>Sounds like you could use Go's mime package. The TypeByExtension method in the mime package might suit your needs. <a href=\"https://golang.org/pkg/mime/#TypeByExtension\" rel=\"nofollow\">https://golang.org/pkg/mime/#TypeByExtension</a></p>\n\n<p>I believe this uses the host system's mime type table. It is possible that the mime type determined by this method could be different than the mime type reported by the remote server.</p>\n\n<pre><code>import \"mime\"\n\nfunc DetermineMimeType (fileExtension string) string {\n    return mime.TypeByExtension(fileExtension)\n}\n</code></pre>\n\n<p>Be sure to pass in the full file extension including the period, for example \".js\" or \".css\". Just to cover all the cases, if you can't determine the file's extension or this method doesn't return a mime type then perhaps default to the mime type reported by the remote server.</p>\n"}], "owner": {"reputation": 421, "user_id": 2873262, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5f8b8419c1469cda8acef2c3a8546d4e?s=128&d=identicon&r=PG&f=1", "display_name": "Sunil", "link": "https://stackoverflow.com/users/2873262/sunil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5199, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1444410048, "creation_date": 1444285380, "last_edit_date": 1444288866, "question_id": 33008063, "link": "https://stackoverflow.com/questions/33008063/how-can-i-get-mime-type-of-the-http-response-with-media-subtype", "title": "How can I get MIME type of the http response with media subtype?", "body": "<p>I want to store MIME type of the response obtained from GET request. I have used the <code>DetectContentType</code> function but it gives me <code>text/plain; charset=utf-8</code> for both js and css resource. I have to distinguish the filetype for each url and I'm depending on MIME type for that purpose.</p>\n\n<pre><code>response, error := http.Get(url) \nif error == nil { \n    contentType := response.Header.Get(\"Content-Type\") \n    // ... \n}\n</code></pre>\n\n<p>Only gives me content type.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1444279677, "post_id": 33006628, "comment_id": 53837995, "body": "Related / possible duplicate of <a href=\"http://stackoverflow.com/questions/18017979/golang-pointer-to-function-from-string-functions-name\">Golang: pointer to function from string (function&#39;s name)</a>"}, {"owner": {"reputation": 2527, "user_id": 3476121, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1c621706e2e37eed4f82f074af9f706a?s=128&d=identicon&r=PG", "display_name": "sadlil", "link": "https://stackoverflow.com/users/3476121/sadlil"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1444286729, "post_id": 33006628, "comment_id": 53840898, "body": "@icza I read that qustion and answer. But their solution which they said to use reflect. And reflect needs an struct and functions be a member of that struct. What if My functions are not member of a struct? just plain methods in a package. and the calling methods and called methods are in different package. Then?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1444293961, "post_id": 33006628, "comment_id": 53845330, "body": "Then the answer is no, you can&#39;t do that without something like a pre-populated name-function map as seen in @LightWeight&#39;s answer."}, {"owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "edited": false, "score": 0, "creation_date": 1444308122, "post_id": 33006628, "comment_id": 53855086, "body": "@eror Read <code>mnagel</code>&#39;s answer to the linked question. It should be the second answer from the top at this time.   You <b>can</b> use reflect to call functions as long as you have the function&#39;s handle, which you can get via a map. You&#39;re misinterpreting the fact that you <b>cannot</b> get a free function&#39;s handle <b>solely</b> via reflection. As long as you build a <code>map[string]interface{}</code> that returns the functions by name yourself, you can call the function via <code>reflect.ValueOf</code> followed by <code>Value.Call</code> or <code>Value.CallSlice</code>"}, {"owner": {"reputation": 2527, "user_id": 3476121, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1c621706e2e37eed4f82f074af9f706a?s=128&d=identicon&r=PG", "display_name": "sadlil", "link": "https://stackoverflow.com/users/3476121/sadlil"}, "reply_to_user": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "edited": false, "score": 0, "creation_date": 1444370660, "post_id": 33006628, "comment_id": 53883934, "body": "@Jsor Thanx, brother. I resolved it with a map you specified. :) But still in my idiot mind one question is Present - if i dont have a map how can i do it."}, {"owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "edited": false, "score": 0, "creation_date": 1444372379, "post_id": 33006628, "comment_id": 53884714, "body": "@eror You cannot get types at the package level without constructing it yourself."}], "answers": [{"comments": [{"owner": {"reputation": 2527, "user_id": 3476121, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1c621706e2e37eed4f82f074af9f706a?s=128&d=identicon&r=PG", "display_name": "sadlil", "link": "https://stackoverflow.com/users/3476121/sadlil"}, "edited": false, "score": 1, "creation_date": 1444286645, "post_id": 33006779, "comment_id": 53840847, "body": "reflect needs an struct and functions be a member of that struct. What if My functions are not member of a struct? just plain methods in a package. and the calling methods and called methods are in different package. Then?"}], "tags": [], "owner": {"reputation": 1, "user_id": 3274981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9288b6c9640bf574dcdafc2bc720f511?s=128&d=identicon&r=PG&f=1", "display_name": "LightWeight", "link": "https://stackoverflow.com/users/3274981/lightweight"}, "is_accepted": false, "score": 0, "last_activity_date": 1444279313, "creation_date": 1444279313, "answer_id": 33006779, "question_id": 33006628, "link": "https://stackoverflow.com/questions/33006628/how-to-call-method-of-another-package-from-string-method-name-in-go/33006779#33006779", "title": "How To Call Method of another package from string method name in Go", "body": "<p>You can try to use reflect in go. This link may be help you\n<a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow\">https://golang.org/pkg/reflect/</a>\nand <a href=\"http://mikespook.com/2012/07/function-call-by-name-in-golang/\" rel=\"nofollow\">http://mikespook.com/2012/07/function-call-by-name-in-golang/</a></p>\n\n<pre><code>func foo() {\n    // bla...bla...bla...\n}\nfunc bar(a, b, c int) {\n    // bla...bla...bla...\n}\nfuncs := map[string]interface{}{\"foo\":foo, \"bar\":bar}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2527, "user_id": 3476121, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1c621706e2e37eed4f82f074af9f706a?s=128&d=identicon&r=PG", "display_name": "sadlil", "link": "https://stackoverflow.com/users/3476121/sadlil"}, "edited": false, "score": 0, "creation_date": 1444286639, "post_id": 33008200, "comment_id": 53840842, "body": "reflect needs an struct and functions be a member of that struct. What if My functions are not member of a struct? just plain methods in a package. and the calling methods and called methods are in different package. Then?"}, {"owner": {"reputation": 2741, "user_id": 141372, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ba052fde0349728a8a2d2442dd1f3966?s=128&d=identicon&r=PG", "display_name": "monkey_p", "link": "https://stackoverflow.com/users/141372/monkey-p"}, "reply_to_user": {"reputation": 2527, "user_id": 3476121, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1c621706e2e37eed4f82f074af9f706a?s=128&d=identicon&r=PG", "display_name": "sadlil", "link": "https://stackoverflow.com/users/3476121/sadlil"}, "edited": false, "score": 1, "creation_date": 1444290812, "post_id": 33008200, "comment_id": 53843366, "body": "Yeah, I&#39;m an idiot :) I knew that when I was looking at it. There is no way to directly get the package functions. You can create a map of all the functions you would want to call. <code>funcMap := map[string]interface{}{&quot;TestOne&quot;:TestOne,&quot;TestTwo&quot;:TestTwo}</code> and then use <code>reflect.ValueOf(funcMap[&quot;TestOne&quot;]).Call()</code> to execute it as in the Sample Code above."}, {"owner": {"reputation": 2527, "user_id": 3476121, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1c621706e2e37eed4f82f074af9f706a?s=128&d=identicon&r=PG", "display_name": "sadlil", "link": "https://stackoverflow.com/users/3476121/sadlil"}, "edited": false, "score": 0, "creation_date": 1444291050, "post_id": 33008200, "comment_id": 53843516, "body": "why will u be an idiot, brother. I am the one here who asks stupid questions. :P :P thank though. Trying what you just described."}, {"owner": {"reputation": 81, "user_id": 7324205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wvr4o.jpg?s=128&g=1", "display_name": "Meet Sinojia", "link": "https://stackoverflow.com/users/7324205/meet-sinojia"}, "edited": false, "score": 0, "creation_date": 1584081901, "post_id": 33008200, "comment_id": 107332113, "body": "@monkey_p Finally a solution which does what was asked. <code>funcMap := map[string]interface{}</code> way described in the comment is the right way to call methods not part of a struct IMO."}], "tags": [], "owner": {"reputation": 2741, "user_id": 141372, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ba052fde0349728a8a2d2442dd1f3966?s=128&d=identicon&r=PG", "display_name": "monkey_p", "link": "https://stackoverflow.com/users/141372/monkey-p"}, "is_accepted": false, "score": 6, "last_activity_date": 1444285874, "creation_date": 1444285874, "answer_id": 33008200, "question_id": 33006628, "link": "https://stackoverflow.com/questions/33006628/how-to-call-method-of-another-package-from-string-method-name-in-go/33008200#33008200", "title": "How To Call Method of another package from string method name in Go", "body": "<p>Like LightWeight said in his answer, you can use reflection.</p>\n\n<p>You use the reflect.ValueOf method to get the value of the type. Then you can use the MethodByName method to get the function value. Once you have the function value you can call the Call method to execute it.</p>\n\n<p>Code Sample</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype TypeOne struct {\n}\n\nfunc (t *TypeOne) FuncOne() {\n    fmt.Println(\"FuncOne\")\n}\n\nfunc (t *TypeOne) FuncTwo(name string) {\n    fmt.Println(\"Hello\", name)\n}\n\nfunc CallFuncByName(myClass interface{}, funcName string, params ...interface{}) (out []reflect.Value, err error) {\n    myClassValue := reflect.ValueOf(myClass)\n    m := myClassValue.MethodByName(funcName)\n    if !m.IsValid() {\n        return make([]reflect.Value, 0), fmt.Errorf(\"Method not found \\\"%s\\\"\", funcName)\n    }\n    in := make([]reflect.Value, len(params))\n    for i, param := range params {\n        in[i] = reflect.ValueOf(param)\n    }\n    out = m.Call(in)\n    return\n}\n\nfunc main() {\n    t1 := &amp;TypeOne{}\n    out, err := CallFuncByName(t1, \"FuncOne\")\n    if err != nil {\n        panic(err)\n    }\n    //Return value\n    _ = out\n    out, err = CallFuncByName(t1, \"FuncTwo\", \"monkey\")\n    if err != nil {\n        panic(err)\n    }\n    //Return value\n    _ = out\n}\n</code></pre>\n"}], "owner": {"reputation": 2527, "user_id": 3476121, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1c621706e2e37eed4f82f074af9f706a?s=128&d=identicon&r=PG", "display_name": "sadlil", "link": "https://stackoverflow.com/users/3476121/sadlil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5535, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1444286819, "creation_date": 1444278391, "last_edit_date": 1444286819, "question_id": 33006628, "link": "https://stackoverflow.com/questions/33006628/how-to-call-method-of-another-package-from-string-method-name-in-go", "title": "How To Call Method of another package from string method name in Go", "body": "<p>Suppose I have two package like</p>\n\n<blockquote>\n  <p>-a</p>\n  \n  <p>-b</p>\n</blockquote>\n\n<p><strong>a</strong> have some methods like this</p>\n\n<pre><code> func TestOne() { //something }\n func TestTwo() { //something }\n</code></pre>\n\n<p>I need to call package <strong>a</strong>'s methods from package <strong>b</strong> but by only string method name. Like i get the string \"TestOne\" and calls for the method TestOne(). How can i get that done.</p>\n\n<p><strong>Edit :</strong>\nI have Read about <code>reflect</code>. but <code>reflect</code> needs an <strong>struct and functions be a member of that struct.</strong> What if My functions are not member of a struct? just plain methods in a package. and the calling methods and called methods are in different package. Then?</p>\n\n<p>NB. There could be some methods that have parameters as well.</p>\n"}, {"tags": ["xml", "go", "saml"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444310580, "post_id": 33006152, "comment_id": 53857162, "body": "Just checking the obvious first since it&#39;s a parse error, is this the <i>entirety</i> of the response? Because it doesn&#39;t have the outer &lt;?xml&gt; tag or namespace definitions."}, {"owner": {"reputation": 597, "user_id": 3731722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000181698389/picture?type=large", "display_name": "vinniyo", "link": "https://stackoverflow.com/users/3731722/vinniyo"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444332350, "post_id": 33006152, "comment_id": 53871053, "body": "Go-SAML package and the others I&#39;ve used prepend &lt;?xml version=\u201c1.0\u201d encoding=\u201cutf-8\u201d?&gt; but SAML trace the firefox plugin removes it from the displayed output. Sorry, I should have added to avoid confusion."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444332612, "post_id": 33006152, "comment_id": 53871218, "body": "But are the namespaces defined? (I&#39;m still assuming this is an XML problem, because I don&#39;t know what else that error from google could mean). Does this work with other service providers?"}, {"owner": {"reputation": 597, "user_id": 3731722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000181698389/picture?type=large", "display_name": "vinniyo", "link": "https://stackoverflow.com/users/3731722/vinniyo"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444360801, "post_id": 33006152, "comment_id": 53880859, "body": "Yes, I&#39;ve been using the same namespaces that are defined from two different IdP providers and also the google developers page: <a href=\"https://developers.google.com/google-apps/sso/saml_reference_implementation_web?hl=en#samlReferenceImplementationWebCodeStructure\" rel=\"nofollow noreferrer\">developers.google.com/google-apps/sso/&hellip;</a>"}, {"owner": {"reputation": 597, "user_id": 3731722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000181698389/picture?type=large", "display_name": "vinniyo", "link": "https://stackoverflow.com/users/3731722/vinniyo"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444360869, "post_id": 33006152, "comment_id": 53880872, "body": "I will try to use the code against another service provider that takes the same email attribute tonight. At the very least it might give me a better error response. Thanks."}, {"owner": {"reputation": 597, "user_id": 3731722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000181698389/picture?type=large", "display_name": "vinniyo", "link": "https://stackoverflow.com/users/3731722/vinniyo"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444411034, "post_id": 33006152, "comment_id": 53908472, "body": "Ok, I was not able to get another SP working completely but it did give a little feedback which said that the cert was not valid.. But it said that even with a verified valid cert that actually logged me in. I&#39;ll try a different SP. Also, I ran the Response through a XML XSD schema that I just found on Onelogin here: <a href=\"https://www.samltool.com/validate_xml.php\" rel=\"nofollow noreferrer\">samltool.com/validate_xml.php</a> which threw quite a few errors on the formatting of the xml. I&#39;ll fix these before trying anything else even though they do not cause issues with the second SP, they might be bad on Google."}, {"owner": {"reputation": 597, "user_id": 3731722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000181698389/picture?type=large", "display_name": "vinniyo", "link": "https://stackoverflow.com/users/3731722/vinniyo"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444841332, "post_id": 33006152, "comment_id": 54073884, "body": "I&#39;ve reordered some things in the XML, added the samlsig:reference URI and still get an error from Google: Server Error."}], "owner": {"reputation": 597, "user_id": 3731722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000181698389/picture?type=large", "display_name": "vinniyo", "link": "https://stackoverflow.com/users/3731722/vinniyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1173, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1444841546, "creation_date": 1444275217, "last_edit_date": 1444841546, "question_id": 33006152, "link": "https://stackoverflow.com/questions/33006152/golang-saml-authentication-for-google-apps-idp-response", "title": "Golang SAML authentication for Google Apps IdP response", "body": "<p>I've used gosaml and go-saml packages from github to build an IdP in revel. Both packages use xmlsec to take the private key to fill in the signed SAML but when trying to authenticate with Google I get the following error: \"Google Apps - This account cannot be accessed because we could not parse the login request.\" I've used two different servers, windows and linux to verify that it wasn't an issue with the xmlsec, modified variations of the response from bitium, and okta. Built keys from openSSL and OneLogin test tools. Here is the rendered SAML after being extracted from SAML Trace on Firefox that results in the error:</p>\n\n<pre><code>&lt;samlp:Response xmlns:samlp=\"urn:oasis:names:tc:SAML:2.0:protocol\"\n            xmlns:saml=\"urn:oasis:names:tc:SAML:2.0:assertion\"\n            xmlns:samlsig=\"http://www.w3.org/2000/09/xmldsig#\"\n            Destination=\"https://www.google.com/a/wikiplays.org/acs\"\n            ID=\"_b521e7bc-9917-4c18-7e89-25032fb49278\"\n            Version=\"2.0\"\n            IssueInstant=\"2015-10-14T05:42:57.6982498Z\"\n            InResponseTo=\"ncgobkpepepgfjhanlpafamijhhpklilagehhfee\"\n            &gt;\n&lt;saml:Issuer&gt;http://104.175.190.209&lt;/saml:Issuer&gt;\n&lt;samlsig:Signature Id=\"Signature1\"&gt;\n    &lt;samlsig:SignedInfo&gt;\n        &lt;samlsig:CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\" /&gt;\n        &lt;samlsig:SignatureMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#rsa-sha1\" /&gt;\n        &lt;samlsig:Reference URI=\"#_b521e7bc-9917-4c18-7e89-25032fb49278\"&gt;\n            &lt;samlsig:Transforms&gt;\n                &lt;samlsig:Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\" /&gt;\n            &lt;/samlsig:Transforms&gt;\n            &lt;samlsig:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\" /&gt;\n            &lt;samlsig:DigestValue&gt;n9fNsHr4zU9oR6Ycjx1jAdzzb64=&lt;/samlsig:DigestValue&gt;\n        &lt;/samlsig:Reference&gt;\n    &lt;/samlsig:SignedInfo&gt;\n    &lt;samlsig:SignatureValue&gt;YG9ZHBkr5NMm4b5N0NOnasgiLR5U17o9jMTrx6wXtklqx8DxV1uiI7siFRFlsnLy\nwk+htqAOhMmTX/pSye6gbIO0xVBNlcRGuMF9uf4CE8dunbQx6cy3nVTKI0MKQtBq\nWpsu6y/v/z/xa+Xg4DDaEprgxi2NwlDOedZ+deUnA54=&lt;/samlsig:SignatureValue&gt;\n    &lt;samlsig:KeyInfo&gt;\n        &lt;samlsig:X509Data&gt;\n            &lt;samlsig:X509Certificate&gt;MIICZjCCAc+gAwIBAgIBADANBgkqhkiG9w0BAQ0FADBQMQswCQYDVQQ    GEwJ1czET\nMBEGA1UECAwKQ0FMSUZPUk5JQTEPMA0GA1UECgwGWmVhbG90MRswGQYDVQQDDBJ6\nZWFsb3RuZXR3b3Jrcy5jb20wHhcNMTUxMDEzMDMyMDAxWhcNMjUxMDEwMDMyMDAx\nWjBQMQswCQYDVQQGEwJ1czETMBEGA1UECAwKQ0FMSUZPUk5JQTEPMA0GA1UECgwG\nWmVhbG90MRswGQYDVQQDDBJ6ZWFsb3RuZXR3b3Jrcy5jb20wgZ8wDQYJKoZIhvcN\nAQEBBQADgY0AMIGJAoGBAMZJ+2Yg2hg0gBI+O9eglZ5pwvC7CXjaN+R4ZCpOm9w3\n82iidvdeWzHxEXpkmEgSPSbot9AO9LhiL0io5vJ9ro6Xh87x/5zuB9IxnFtSAH9S\nK4LA4A7lhpA5HrhDUYBIUksqyIc+TBUXA+Blpexs9b5fcjkzN2iVFyBWR2xn17Hl\nAgMBAAGjUDBOMB0GA1UdDgQWBBQ7o5RDaoy91nhHgLt8L2YilDlCkjAfBgNVHSME\nGDAWgBQ7o5RDaoy91nhHgLt8L2YilDlCkjAMBgNVHRMEBTADAQH/MA0GCSqGSIb3\nDQEBDQUAA4GBAEFxqDwc2X/cP6YX8neW1AgBxZ4AOAlJ9YgRKQKDuHzOJX22s2ah\n65XCA16Tnw8xG0AdZUU5dn07Y05EYgYW+cktvitT9fNTdpJ9JDnGB1KAlVqGlB7d\n oIn8BV7bDA+YkeAgH98UE6OOEkNYnygkg2eT9H0FoyXkMyiizixeH8BO&lt;/samlsig:X509Certificate&gt;\n        &lt;/samlsig:X509Data&gt;\n    &lt;/samlsig:KeyInfo&gt;\n&lt;/samlsig:Signature&gt;\n&lt;samlp:Status&gt;\n    &lt;samlp:StatusCode Value=\"urn:oasis:names:tc:SAML:2.0:status:Success\" /&gt;\n&lt;/samlp:Status&gt;\n&lt;saml:Assertion xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"\n                xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n                ID=\"_f7437494-03ce-4eb1-483c-169f43f6e1f7\"\n                Version=\"2.0\"\n                IssueInstant=\"2015-10-14T05:42:57.6982498Z\"\n                &gt;\n    &lt;saml:Issuer&gt;http://104.175.190.209&lt;/saml:Issuer&gt;\n    &lt;saml:Subject&gt;\n        &lt;saml:NameID SPNameQualifier=\"google.com/a/wikiplays.org\"\n                     Format=\"urn:oasis:names:tc:SAML:2.0:nameid-format:email\"\n                     &gt;vince@wikiplays.org&lt;/saml:NameID&gt;\n        &lt;saml:SubjectConfirmation Method=\"urn:oasis:names:tc:SAML:2.0:cm:bearer\"&gt;\n            &lt;saml:SubjectConfirmationData InResponseTo=\"ncgobkpepepgfjhanlpafamijhhpklilagehhfee\"\n                                          NotOnOrAfter=\"2015-10-14T05:47:57.6982498Z\"\n                                          Recipient=\"https://www.google.com/a/wikiplays.org/acs\"\n                                          /&gt;\n        &lt;/saml:SubjectConfirmation&gt;\n    &lt;/saml:Subject&gt;\n    &lt;saml:Conditions NotBefore=\"2015-10-14T05:37:57.6982498Z\"\n                     NotOnOrAfter=\"2015-10-14T05:47:57.6982498Z\"\n                     /&gt;\n    &lt;saml:AttributeStatement&gt;\n        &lt;saml:Attribute Name=\"Email\"\n                        FriendlyName=\"Email Address\"\n                        NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\"\n                        &gt;\n            &lt;saml:AttributeValue xsi:type=\"xs:string\"&gt;vince@wikiplays.org&lt;/saml:AttributeValue&gt;\n        &lt;/saml:Attribute&gt;\n    &lt;/saml:AttributeStatement&gt;\n&lt;/saml:Assertion&gt;\n</code></pre>\n\n<p></p>\n"}]