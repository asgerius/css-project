[{"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1481759200, "post_id": 41154055, "comment_id": 69510210, "body": "Yes, <code>*sql.Rows</code> does implement <code>DatabaseRows</code>. The problem is that the method signatures are different, resulting in different method sets."}, {"owner": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481759405, "post_id": 41154055, "comment_id": 69510267, "body": "I don&#39;t follow. I copied Query func&#39;s signature from the source. Even looking at the error message, one could see that the only difference between the 2 signature is the return value."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1481759571, "post_id": 41154055, "comment_id": 69510317, "body": "That is the <i>only</i> difference, but there can&#39;t be <i>any</i> difference, or it&#39;s a different signature."}, {"owner": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481760000, "post_id": 41154055, "comment_id": 69510426, "body": "Duh! You&#39;d think that&#39;s obvious. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "edited": false, "score": 1, "creation_date": 1535852751, "post_id": 52123983, "comment_id": 91217151, "body": "I created the interfaces the same way I mentioned in my question, but created types that implemented those interfaces and wrapped the actual &quot;database/sql&quot; library&#39;s types. That way, I could create (or use other&#39;s) test types."}], "tags": [], "owner": {"reputation": 6841, "user_id": 3960399, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/c5OVT.jpg?s=128&g=1", "display_name": "Frank Bryce", "link": "https://stackoverflow.com/users/3960399/frank-bryce"}, "is_accepted": false, "score": 0, "last_activity_date": 1535762352, "creation_date": 1535762352, "answer_id": 52123983, "question_id": 41154055, "link": "https://stackoverflow.com/questions/41154055/golang-building-interfaces-for-existing-types-to-make-code-testable/52123983#52123983", "title": "golang: building interfaces for existing types to make code testable", "body": "<p>If you haven't found a way to work around this, yet, I would recommend creating a new API around your DB calls which actually return what you want.  This means you'll need to apply some judgment, but your tests will end up being cleaner after you apply a little bit of thought to your problem.</p>\n\n<p>For instance, if your DB contains a table like this</p>\n\n<pre><code>+------------+----------+-----+-------------------+\n| EmployeeID | Name     | Age | Salary            |\n+------------+----------+-----+-------------------+\n| 123        | Kara Bob | 28  | 1 Million Dollars |\n+ ...\n</code></pre>\n\n<p>Create an interface like this</p>\n\n<pre><code>type Employee interface {\n    GetEmployeeId() int\n    GetName() string\n    ...\n}\n</code></pre>\n\n<p>Then create a real version calling your SQL database, and then a fake one with struct fields for your tests.</p>\n"}], "owner": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 253, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535762352, "creation_date": 1481758398, "last_edit_date": 1592644375, "question_id": 41154055, "link": "https://stackoverflow.com/questions/41154055/golang-building-interfaces-for-existing-types-to-make-code-testable", "title": "golang: building interfaces for existing types to make code testable", "body": "<p>I built the following 2 interfaces in order to make my code, which makes calls to the <em>sql</em> package, testable:</p>\n<pre><code>type Database interface {\n    Close() error\n    Query(string, ...interface{}) (DatabaseRows, error)\n}\n\ntype DatabaseRows interface {\n    Close() error\n    Next() bool\n    Scan(...interface{}) error\n}\n</code></pre>\n<p>and the actual code which I want to test is:</p>\n<pre><code>func getDatabase(connectionString string) (db Database, err error) {\n    if db , err = sql.Open(&quot;mysql&quot;, connectionString); err != nil {\n        glog.V(0).Infof(&quot;Error %s&quot;, err)\n    }\n    return\n}\n</code></pre>\n<p>But this fails to compile:</p>\n<blockquote>\n<p>*sql.DB does not implement Database (wrong type for Query method)</p>\n<p>have Query(string, ...interface {}) (*sql.Rows, error)</p>\n<p>want Query(string, ...interface {}) (DatabaseRows, error)</p>\n</blockquote>\n<p>If I understand it correctly, it's telling me that it can't return a <em>*Row</em> where a <em>DatabaseRow</em> is expected, even though <em>Rows</em> struct in is implementing all 3 functions that I declared in <em>DatabaseRows</em> interface.</p>\n<p>Why doesn't compiler make that association?</p>\n"}, {"tags": ["debugging", "go", "race-condition"], "answers": [{"tags": [], "owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "is_accepted": false, "score": 2, "last_activity_date": 1481758202, "creation_date": 1481758202, "answer_id": 41154019, "question_id": 41153912, "link": "https://stackoverflow.com/questions/41153912/golang-race-with-sync-mutex-on-mapstringint/41154019#41154019", "title": "Golang race with sync.Mutex on map[string]int", "body": "<p>A Minimal Complete Verifiable Example would be useful here, but I think your problem is in <code>All()</code>:</p>\n\n<pre><code>// All the counters\nfunc All() map[string]int64 {\n    counters.mu.Lock()\n    defer counters.mu.Unlock()\n    return counters.values        // running during write above\n}\n</code></pre>\n\n<p>This returns a <code>map</code> which does not make a copy of it, so it can be accessed outside the protection of the mutex.</p>\n"}, {"tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": true, "score": 1, "last_activity_date": 1481758209, "creation_date": 1481758209, "answer_id": 41154021, "question_id": 41153912, "link": "https://stackoverflow.com/questions/41153912/golang-race-with-sync-mutex-on-mapstringint/41154021#41154021", "title": "Golang race with sync.Mutex on map[string]int", "body": "<p><code>All</code> returns the underlying map and the releases the lock, so the code using the map will have a data race.</p>\n\n<p>You should return a copy of the map:</p>\n\n<pre><code>func All() map[string]int64 {\n    counters.mu.Lock()\n    defer counters.mu.Unlock()\n    m := make(map[string]int64)\n    for k, v := range counters.values {\n        m[k] = v\n    }\n    return m    \n}\n</code></pre>\n\n<p>Or not have an <code>All</code> method.</p>\n"}], "owner": {"reputation": 50646, "user_id": 99923, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/211755e2897f699737d63f5e2ecf5b07?s=128&d=identicon&r=PG", "display_name": "Xeoncross", "link": "https://stackoverflow.com/users/99923/xeoncross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 41154021, "answer_count": 2, "score": 1, "last_activity_date": 1481758209, "creation_date": 1481757556, "question_id": 41153912, "link": "https://stackoverflow.com/questions/41153912/golang-race-with-sync-mutex-on-mapstringint", "title": "Golang race with sync.Mutex on map[string]int", "body": "<p>I have a simple package I am using to log stats during a program run and I found that <code>go run -race</code> says there is a race condition in it. Looking at the program I'm not sure how I can have a race condition when every read and write is protected by a mutex. Can someone explain this?</p>\n\n<pre><code>package counters\n\nimport \"sync\"\n\ntype single struct {\n    mu     sync.Mutex\n    values map[string]int64\n}\n\n// Global counters object\nvar counters = single{\n    values: make(map[string]int64),\n}\n\n// Get the value of the given counter\nfunc Get(key string) int64 {\n    counters.mu.Lock()\n    defer counters.mu.Unlock()\n    return counters.values[key]\n}\n\n// Incr the value of the given counter name\nfunc Incr(key string) int64 {\n    counters.mu.Lock()\n    defer counters.mu.Unlock()\n    counters.values[key]++        // Race condition\n    return counters.values[key]\n}\n\n// All the counters\nfunc All() map[string]int64 {\n    counters.mu.Lock()\n    defer counters.mu.Unlock()\n    return counters.values        // running during write above\n}\n</code></pre>\n\n<p>I use the package like so:</p>\n\n<pre><code>counters.Incr(\"foo\")\ncounters.Get(\"foo\")\n</code></pre>\n"}, {"tags": ["api", "facebook-graph-api", "go", "oauth2"], "comments": [{"owner": {"reputation": 583, "user_id": 6748318, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3370165705aeb0f3b12b87cb6ae4b1f?s=128&d=identicon&r=PG&f=1", "display_name": "vermotr", "link": "https://stackoverflow.com/users/6748318/vermotr"}, "edited": false, "score": 0, "creation_date": 1481793057, "post_id": 41152648, "comment_id": 69521471, "body": "I have found this: <a href=\"http://stackoverflow.com/a/15603312/6748318\">stackoverflow.com/a/15603312/6748318</a>"}], "owner": {"reputation": 583, "user_id": 6748318, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3370165705aeb0f3b12b87cb6ae4b1f?s=128&d=identicon&r=PG&f=1", "display_name": "vermotr", "link": "https://stackoverflow.com/users/6748318/vermotr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1368, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1481751495, "creation_date": 1481751495, "question_id": 41152648, "link": "https://stackoverflow.com/questions/41152648/api-in-golang-with-oauth2-and-google-facebook-authentication", "title": "API in Golang with OAuth2 and Google/Facebook Authentication", "body": "<p>I'm currently developing an API in go for an iOS, an Android and a web application (react.js/redux). I have already implemented authentication with OAuth2 by using the osin package.</p>\n\n<p>To log in my users, I use the Resource Owner Password Credentials Grant flow, but I would like to add the Google and Facebook authentication.</p>\n\n<p>I'm a little bit confused and I really didn't know how to start\u2026</p>\n\n<p>Should be using the Facebook/Google token to authenticate a user and return my access tokens?</p>\n\n<p>Should be using Facebook/Google token and my token at the same time to verify a user before return a resource?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["parsing", "go", "yaml"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1481751178, "post_id": 41152405, "comment_id": 69507277, "body": "What exactly is unclear in the error message? Your YAML is a map and maps cannot be unmarshaled to a slice. So maybe use a map?"}, {"owner": {"reputation": 9123, "user_id": 1040718, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u0SVy.jpg?s=128&g=1", "display_name": "cybertextron", "link": "https://stackoverflow.com/users/1040718/cybertextron"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1481751218, "post_id": 41152405, "comment_id": 69507299, "body": "@Volker let me reformulate my question..."}, {"owner": {"reputation": 9123, "user_id": 1040718, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u0SVy.jpg?s=128&g=1", "display_name": "cybertextron", "link": "https://stackoverflow.com/users/1040718/cybertextron"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1481751528, "post_id": 41152405, "comment_id": 69507430, "body": "@Volker I&#39;ve updated my question"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481757674, "post_id": 41152405, "comment_id": 69509782, "body": "You have unexported fields in your structs, and you still only have mappings in your yaml."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1481785838, "post_id": 41152405, "comment_id": 69517849, "body": "You have to write <code>networks</code> and <code>driver</code> fields with the first letter as upper case, to make them public"}], "answers": [{"comments": [{"owner": {"reputation": 9123, "user_id": 1040718, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u0SVy.jpg?s=128&g=1", "display_name": "cybertextron", "link": "https://stackoverflow.com/users/1040718/cybertextron"}, "edited": false, "score": 0, "creation_date": 1481760089, "post_id": 41154284, "comment_id": 69510450, "body": "Marius, the main issue here is that output comes from a <code>docker-compose.yml</code> file, which will be parsed and used alongside the docker go API. The docker-compose output does not have that format. I solved the issue by using maps."}], "tags": [], "owner": {"reputation": 151, "user_id": 700973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rJ8fe.jpg?s=128&g=1", "display_name": "Marius", "link": "https://stackoverflow.com/users/700973/marius"}, "is_accepted": false, "score": 0, "last_activity_date": 1481759966, "creation_date": 1481759966, "answer_id": 41154284, "question_id": 41152405, "link": "https://stackoverflow.com/questions/41152405/parsing-a-yaml-file-with-golang/41154284#41154284", "title": "Parsing a yaml file with Golang", "body": "<p>AFAIKT there to things, data structures with unexported fields and test data which doesn't match your data structures. </p>\n\n<p>Something like this would give you a go:</p>\n\n<pre><code>type DockerNetwork struct {\n    MyNetwork struct {\n        Driver string `yaml:driver`\n    } `yaml:\"my_network\"`\n}\n\ntype DockerNetworks struct {\n    Networks []DockerNetwork `yaml:networks`\n}\n</code></pre>\n\n<p>And test data:</p>\n\n<pre><code>networks:\n-  my_network:\n    driver: bridge\n</code></pre>\n\n<p>Gives an output:</p>\n\n<pre><code>2016/12/14 23:47:23 --- t:\n{[{{bridge}}]}\n\n\nPASS\n</code></pre>\n\n<p>And It's hard to tell, what is \"working\" in your opinion.</p>\n"}, {"tags": [], "owner": {"reputation": 9123, "user_id": 1040718, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u0SVy.jpg?s=128&g=1", "display_name": "cybertextron", "link": "https://stackoverflow.com/users/1040718/cybertextron"}, "is_accepted": false, "score": 2, "last_activity_date": 1481760275, "creation_date": 1481760275, "answer_id": 41154328, "question_id": 41152405, "link": "https://stackoverflow.com/questions/41152405/parsing-a-yaml-file-with-golang/41154328#41154328", "title": "Parsing a yaml file with Golang", "body": "<p>My <code>yaml</code> file is a <code>docker-compose.yml</code> file, which is in the format described above (part of it). I agree with Marius that I have unexported fields, which is an error. The solution I used was <code>map</code>:</p>\n\n<pre><code>m := make(map[interface{}]interface{})\n\nerr = yaml.Unmarshal([]byte(data), &amp;m)\nif err != nil {\n   log.Fatalf(\"error: %v\", err)\n}\nfmt.Printf(\"--- m:\\n%v\\n\\n\", m)\n</code></pre>\n"}], "owner": {"reputation": 9123, "user_id": 1040718, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u0SVy.jpg?s=128&g=1", "display_name": "cybertextron", "link": "https://stackoverflow.com/users/1040718/cybertextron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2776, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1481760275, "creation_date": 1481750490, "last_edit_date": 1481751410, "question_id": 41152405, "link": "https://stackoverflow.com/questions/41152405/parsing-a-yaml-file-with-golang", "title": "Parsing a yaml file with Golang", "body": "<p>I'm trying to parse a <code>yaml</code> file with Golang. I defined the following <code>types</code>:</p>\n\n<pre><code>type DockerNetwork struct {\n   MyNetwork struct {\n      driver string\n   } `yaml:\"my_network\"`\n}\n\n// DockerNetworks represent the docker Networks type\ntype DockerNetworks struct {\n    networks []DockerNetwork\n}\n</code></pre>\n\n<p>so I have my unit test in place:</p>\n\n<pre><code>func TestDockerNetwork(t *testing.T) {\n    dn := DockerNetworks{}\n    var data = `\nnetworks:\n   my_network:\n     driver: bridge\n    `\n    err := yaml.Unmarshal([]byte(data), &amp;dn)\n    if err != nil {\n        log.Fatalf(\"error: %v\", err)\n        t.Error(\"Could not Unmarshal the data\")\n    }\n    log.Println(fmt.Sprintf(\"--- t:\\n%v\\n\\n\", dn))\n}\n</code></pre>\n\n<p>I expected it to work, however I'm getting no input:</p>\n\n<pre><code>2016/12/14 13:38:12 --- t:\n{{}}\n</code></pre>\n\n<p>what am I doing wrong?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1481749341, "post_id": 41152037, "comment_id": 69506403, "body": "You cannot. As you know you can test for &quot;beeing string&quot; like <code>value.(string)</code> or you can test for &quot;being MyString` with <code>value.(MyString)</code>, but you cannot for both. Or you use a type switch. Work through the Tour of Go once more, especially the chapter about type switches: <a href=\"https://tour.golang.org/methods/16\" rel=\"nofollow noreferrer\">tour.golang.org/methods/16</a> and ff."}], "answers": [{"comments": [{"owner": {"reputation": 2860, "user_id": 5397, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e1d626dc8d86cfc672022946ee03be83?s=128&d=identicon&r=PG", "display_name": "Martin Del Vecchio", "link": "https://stackoverflow.com/users/5397/martin-del-vecchio"}, "edited": false, "score": 0, "creation_date": 1481749932, "post_id": 41152179, "comment_id": 69506697, "body": "In place of the last line (&quot;S = ref.String()&quot;), could I simply say &quot;S = value&quot;?"}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "reply_to_user": {"reputation": 2860, "user_id": 5397, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e1d626dc8d86cfc672022946ee03be83?s=128&d=identicon&r=PG", "display_name": "Martin Del Vecchio", "link": "https://stackoverflow.com/users/5397/martin-del-vecchio"}, "edited": false, "score": 0, "creation_date": 1481750118, "post_id": 41152179, "comment_id": 69506785, "body": "@MartinDelVecchio: No, because the type of <code>S</code> is not the same as the type of <code>value</code>."}, {"owner": {"reputation": 2860, "user_id": 5397, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e1d626dc8d86cfc672022946ee03be83?s=128&d=identicon&r=PG", "display_name": "Martin Del Vecchio", "link": "https://stackoverflow.com/users/5397/martin-del-vecchio"}, "edited": false, "score": 0, "creation_date": 1481750878, "post_id": 41152179, "comment_id": 69507135, "body": "OK.  My goal here is to avoid calling value.String() or its equivalent, because it&#39;s already a string.  How can I convert a variable of type MyString to a variable of type string?  Does &quot;string (value)&quot; do it?"}, {"owner": {"reputation": 7745, "user_id": 3926995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2l63X.jpg?s=128&g=1", "display_name": "Chiheb Nexus", "link": "https://stackoverflow.com/users/3926995/chiheb-nexus"}, "edited": false, "score": 0, "creation_date": 1481793735, "post_id": 41152179, "comment_id": 69521893, "body": "@TimCooper Thanks for your answer. Can you explain why type switch isn&#39;t accurate wihile checking the exact type ?"}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "reply_to_user": {"reputation": 7745, "user_id": 3926995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2l63X.jpg?s=128&g=1", "display_name": "Chiheb Nexus", "link": "https://stackoverflow.com/users/3926995/chiheb-nexus"}, "edited": false, "score": 1, "creation_date": 1481800563, "post_id": 41152179, "comment_id": 69526238, "body": "@nexus66: <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">Type assertions</a> &quot;x.(T) asserts that the dynamic type of x is <b>identical</b> to the type T&quot;"}, {"owner": {"reputation": 7745, "user_id": 3926995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2l63X.jpg?s=128&g=1", "display_name": "Chiheb Nexus", "link": "https://stackoverflow.com/users/3926995/chiheb-nexus"}, "edited": false, "score": 0, "creation_date": 1481816193, "post_id": 41152179, "comment_id": 69536235, "body": "Thanks for your comment."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": false, "score": 5, "last_activity_date": 1481749565, "creation_date": 1481749565, "answer_id": 41152179, "question_id": 41152037, "link": "https://stackoverflow.com/questions/41152037/how-do-i-do-a-go-golang-type-assertion-for-type-mystring-string/41152179#41152179", "title": "How do I do a Go/Golang type assertion for &quot;type MyString string&quot;?", "body": "<p>You cannot perform a type assertion or a type switch to a string, as the <strong>exact type</strong> does not match. The closest you can get is to use the <a href=\"https://godoc.org/reflect\" rel=\"nofollow noreferrer\"><code>reflect</code></a> package and check the value's <a href=\"https://godoc.org/reflect#Value.Kind\" rel=\"nofollow noreferrer\"><code>Kind</code></a>:</p>\n\n<pre><code>var S string\nref := reflect.ValueOf(value)\nif ref.Kind() == reflect.String {\n    S = ref.String()\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2860, "user_id": 5397, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e1d626dc8d86cfc672022946ee03be83?s=128&d=identicon&r=PG", "display_name": "Martin Del Vecchio", "link": "https://stackoverflow.com/users/5397/martin-del-vecchio"}, "edited": false, "score": 0, "creation_date": 1481897901, "post_id": 41179321, "comment_id": 69572352, "body": "It is an interface; I have a function that takes an arbitrary value (the argument value is of type interface{}), and I want to return a string.  For actual string variables, and for variables of equivalent types (e.g., MyString), I want to return the original value as efficiently as possible.  For others (int, struct, etc.), I will have to use a String() method or fmt.Sprintf(), etc."}, {"owner": {"reputation": 1, "user_id": 1664841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f1bc2997fbb3f6c30be60f09a24fcf?s=128&d=identicon&r=PG", "display_name": "Stas Zholudev", "link": "https://stackoverflow.com/users/1664841/stas-zholudev"}, "reply_to_user": {"reputation": 2860, "user_id": 5397, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e1d626dc8d86cfc672022946ee03be83?s=128&d=identicon&r=PG", "display_name": "Martin Del Vecchio", "link": "https://stackoverflow.com/users/5397/martin-del-vecchio"}, "edited": false, "score": 0, "creation_date": 1482174901, "post_id": 41179321, "comment_id": 69658050, "body": "I see, in this case only reflection can solve the problem"}], "tags": [], "owner": {"reputation": 1, "user_id": 1664841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f1bc2997fbb3f6c30be60f09a24fcf?s=128&d=identicon&r=PG", "display_name": "Stas Zholudev", "link": "https://stackoverflow.com/users/1664841/stas-zholudev"}, "is_accepted": false, "score": 0, "last_activity_date": 1481873467, "creation_date": 1481873467, "answer_id": 41179321, "question_id": 41152037, "link": "https://stackoverflow.com/questions/41152037/how-do-i-do-a-go-golang-type-assertion-for-type-mystring-string/41179321#41179321", "title": "How do I do a Go/Golang type assertion for &quot;type MyString string&quot;?", "body": "<p>Why you use an assertion, it's for interfaces. Try conversion like:</p>\n\n<pre><code>type MyString string\n\nvar s MyString = \"test\"\nvar t string\n\nt = string(s)\n</code></pre>\n"}], "owner": {"reputation": 2860, "user_id": 5397, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e1d626dc8d86cfc672022946ee03be83?s=128&d=identicon&r=PG", "display_name": "Martin Del Vecchio", "link": "https://stackoverflow.com/users/5397/martin-del-vecchio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1236, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1481873467, "creation_date": 1481749038, "last_edit_date": 1481749774, "question_id": 41152037, "link": "https://stackoverflow.com/questions/41152037/how-do-i-do-a-go-golang-type-assertion-for-type-mystring-string", "title": "How do I do a Go/Golang type assertion for &quot;type MyString string&quot;?", "body": "<p>If I want to know whether a variable is of type string, I can do a type assertion:</p>\n\n<pre><code>S, OK:= value.(string)\n</code></pre>\n\n<p>If value is of type string, then OKis true, and S is the original value.</p>\n\n<p>But this type assertion doesn't work for custom string types; for example:</p>\n\n<pre><code>type MyString string\n</code></pre>\n\n<p>For a variable of this type, the above type assertion returns false for OK.</p>\n\n<p>How can I determine if a variable is of type string, or of an equivalent type, without a separate assertion for each such equivalent type?</p>\n"}, {"tags": ["go", "cgo"], "comments": [{"owner": {"reputation": 9826, "user_id": 467732, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/93af4ec7a03d6ec6e95eff3a83af3dd4?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas", "link": "https://stackoverflow.com/users/467732/lucas"}, "edited": false, "score": 0, "creation_date": 1481763002, "post_id": 41151303, "comment_id": 69511226, "body": "Did you set your CPATH and LIBRARY_PATH environment vairables for GCC? Because it looks like it just can&#39;t find png.h in any of the folders it knows to look in; even though you&#39;ve compiled libpng it still needs the header files at least."}], "answers": [{"comments": [{"owner": {"reputation": 8856, "user_id": 4746087, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/3C19Q.png?s=128&g=1", "display_name": "Kurt Van den Branden", "link": "https://stackoverflow.com/users/4746087/kurt-van-den-branden"}, "edited": false, "score": 1, "creation_date": 1484924156, "post_id": 41765999, "comment_id": 70724231, "body": "Please add some explanation of what your links are doing. Links can disappear, and if so, this answer would be worthless."}, {"owner": {"reputation": 6398, "user_id": 4284627, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2e017633cda5465e6683c74992cdec5e?s=128&d=identicon&r=PG", "display_name": "Donald Duck", "link": "https://stackoverflow.com/users/4284627/donald-duck"}, "edited": false, "score": 0, "creation_date": 1484924172, "post_id": 41765999, "comment_id": 70724240, "body": "Please provide more details."}], "tags": [], "owner": {"reputation": 91, "user_id": 6952538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1be4d6fde639edc17de291f0f3e7d5f?s=128&d=identicon&r=PG&f=1", "display_name": "vway", "link": "https://stackoverflow.com/users/6952538/vway"}, "is_accepted": false, "score": 0, "last_activity_date": 1484922678, "creation_date": 1484922678, "answer_id": 41765999, "question_id": 41151303, "link": "https://stackoverflow.com/questions/41151303/libpng-in-golang-package/41765999#41765999", "title": "libpng in golang package", "body": "<p>You can use <a href=\"https://github.com/go-vgo/Mingw\" rel=\"nofollow noreferrer\">Mingw</a> or read <a href=\"https://github.com/go-vgo/Mingw32\" rel=\"nofollow noreferrer\">this</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 46, "user_id": 5711392, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-urznBCvU-Gc/AAAAAAAAAAI/AAAAAAAAAEw/LCGz5jMK79I/photo.jpg?sz=128", "display_name": "Suhas 007", "link": "https://stackoverflow.com/users/5711392/suhas-007"}, "is_accepted": false, "score": 0, "last_activity_date": 1497192401, "last_edit_date": 1497192401, "creation_date": 1497191761, "answer_id": 44485016, "question_id": 41151303, "link": "https://stackoverflow.com/questions/41151303/libpng-in-golang-package/44485016#44485016", "title": "libpng in golang package", "body": "<p>Use these steps </p>\n\n<ol>\n<li>download Mingw from <a href=\"https://github.com/go-vgo/Mingw\" rel=\"nofollow noreferrer\">https://github.com/go-vgo/Mingw</a></li>\n<li>Set Environment set environment variables C:\\Mingw\\bin</li>\n<li>Download win32 <a href=\"https://github.com/go-vgo/Mingw32\" rel=\"nofollow noreferrer\">https://github.com/go-vgo/Mingw32</a></li>\n<li>copy win32 inside the file (don't copy win32 folder) to \nMingw/lib/gcc/mingw32/4.8.1/include</li>\n<li>Download zlib from  <a href=\"https://zlib.net/\" rel=\"nofollow noreferrer\">https://zlib.net/</a></li>\n<li>use command \n    1) copy win32\\makefile.gcc Makefile.gcc\n    2)  mingw32-make -f makefile.gcc</li>\n<li>copy libz.a to Mingw/lib</li>\n<li><p>Download libpng from <a href=\"http://www.libpng.org/pub/png/libpng.html\" rel=\"nofollow noreferrer\">http://www.libpng.org/pub/png/libpng.html</a></p></li>\n<li><p>generate libpng.a and copy to Mingw/lib using command 1) copy scripts\\makefile.gcc makefile.gcc 2) mingw32-make -f makefile.gcc</p></li>\n</ol>\n"}], "owner": {"reputation": 3, "user_id": 4899968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2240618d1dc55fc9233dc2c6474fb418?s=128&d=identicon&r=PG", "display_name": "hitakiri", "link": "https://stackoverflow.com/users/4899968/hitakiri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 510, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1497192401, "creation_date": 1481746077, "last_edit_date": 1481747802, "question_id": 41151303, "link": "https://stackoverflow.com/questions/41151303/libpng-in-golang-package", "title": "libpng in golang package", "body": "<p>I need to import <a href=\"https://github.com/go-vgo/robotgo\" rel=\"nofollow noreferrer\">this</a> package.</p>\n\n<p>It require zlib and libpng.</p>\n\n<p>I compile zlib and libpng by MinGW (my OS - Windows 8.1 64).</p>\n\n<p><code>libpng.a</code> now in MinGW lib folder, but nothin changed, same arror:</p>\n\n<pre><code>In file included from ./bitmap/../base/io_c.h:4:0,\n             from ./bitmap/goBitmap.h:25,\n             from ..\\github.com\\go-vgo\\robotgo\\robotgo.go:26:\n./bitmap/../base/png_io_c.h:4:17: fatal error: png.h: No such file or directory\n#include &lt;png.h&gt;\n</code></pre>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1481736436, "post_id": 41148357, "comment_id": 69499616, "body": "No. you will have to come up with a better isolation scheme if you have untrusted input."}, {"owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "edited": false, "score": 1, "creation_date": 1481759520, "post_id": 41148357, "comment_id": 69510304, "body": ":sigh: This is not a duplicate. The answer to your question is here: <a href=\"https://github.com/yuin/gopher-lua/pull/84\" rel=\"nofollow noreferrer\">github.com/yuin/gopher-lua/pull/84</a>. Someone added context support, which would solve this problem, but the PR was rejected because they wanted to support older versions of Go. You should fork the project and use their PR."}, {"owner": {"reputation": 476, "user_id": 1235577, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9e26e029aeb67386a54fff5db023348b?s=128&d=identicon&r=PG", "display_name": "Pownyan", "link": "https://stackoverflow.com/users/1235577/pownyan"}, "reply_to_user": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "edited": false, "score": 0, "creation_date": 1481800533, "post_id": 41148357, "comment_id": 69526228, "body": "thanks @Caleb, that solved it"}], "owner": {"reputation": 476, "user_id": 1235577, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9e26e029aeb67386a54fff5db023348b?s=128&d=identicon&r=PG", "display_name": "Pownyan", "link": "https://stackoverflow.com/users/1235577/pownyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "closed_date": 1481740109, "answer_count": 0, "score": 0, "last_activity_date": 1481736743, "creation_date": 1481735454, "last_edit_date": 1481736743, "question_id": 41148357, "link": "https://stackoverflow.com/questions/41148357/force-kill-goroutine-after-timeout", "closed_reason": "Duplicate", "title": "Force kill goroutine after timeout", "body": "<p>Is there any way of forcibly kill a go routine? I have a function that allows users to input Lua code that will be executed on the server, and the user could potentially send in a infinite loop. I can't stop the routine by a channel, as the execution of the lua code is blocking.</p>\n\n<p>I'm using Gopher lua (found here: <a href=\"https://github.com/yuin/gopher-lua\" rel=\"nofollow noreferrer\">https://github.com/yuin/gopher-lua</a>)</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 5459, "user_id": 1734730, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/L8dDj.jpg?s=128&g=1", "display_name": "Nathan Cooper", "link": "https://stackoverflow.com/users/1734730/nathan-cooper"}, "edited": false, "score": 0, "creation_date": 1481733926, "post_id": 41147766, "comment_id": 69498062, "body": "Reminds me of a linked list node. Google some implementations, <a href=\"https://gist.github.com/Maksadbek/f76f69198395d18338887a60fb08c7fa\" rel=\"nofollow noreferrer\">here&#39;s one</a>. Not sure how it turn it to JSON and back however."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481734199, "post_id": 41147766, "comment_id": 69498254, "body": "Have you tried? It is valid code. What problem are you having?"}, {"owner": {"reputation": 4719, "user_id": 2676845, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/TTFOs.jpg?s=128&g=1", "display_name": "fstanis", "link": "https://stackoverflow.com/users/2676845/fstanis"}, "edited": false, "score": 1, "creation_date": 1481734352, "post_id": 41147766, "comment_id": 69498342, "body": "What are you trying to do? What kind of relationship do you expect? Marshal to what?"}, {"owner": {"reputation": 83, "user_id": 5002696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe39a20a8b04687209259180ea4bc64?s=128&d=identicon&r=PG&f=1", "display_name": "Stefano", "link": "https://stackoverflow.com/users/5002696/stefano"}, "edited": false, "score": 0, "creation_date": 1481734409, "post_id": 41147766, "comment_id": 69498378, "body": "when marshal to json this struct, the field A losts"}, {"owner": {"reputation": 4719, "user_id": 2676845, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/TTFOs.jpg?s=128&g=1", "display_name": "fstanis", "link": "https://stackoverflow.com/users/2676845/fstanis"}, "edited": false, "score": 0, "creation_date": 1481734656, "post_id": 41147766, "comment_id": 69498525, "body": "Please explain exactly what you want. The question as it is now is too abstract to have a good answer."}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1481734976, "post_id": 41147766, "comment_id": 69498704, "body": "@Stefano: The embedded <code>*A</code> fields are lost because they have the same names as the struct they are embedded in. You could fix this by unembedding <code>*A</code>: <code>A *A</code>."}, {"owner": {"reputation": 83, "user_id": 5002696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe39a20a8b04687209259180ea4bc64?s=128&d=identicon&r=PG&f=1", "display_name": "Stefano", "link": "https://stackoverflow.com/users/5002696/stefano"}, "edited": false, "score": 0, "creation_date": 1481735124, "post_id": 41147766, "comment_id": 69498796, "body": "ok, it&#39;s work!, thanks Tim.. thanks at all!"}], "answers": [{"comments": [{"owner": {"reputation": 7745, "user_id": 3926995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2l63X.jpg?s=128&g=1", "display_name": "Chiheb Nexus", "link": "https://stackoverflow.com/users/3926995/chiheb-nexus"}, "edited": false, "score": 0, "creation_date": 1481735699, "post_id": 41148293, "comment_id": 69499147, "body": "can you add a complete example how it works with your code ?"}], "tags": [], "owner": {"reputation": 83, "user_id": 5002696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe39a20a8b04687209259180ea4bc64?s=128&d=identicon&r=PG&f=1", "display_name": "Stefano", "link": "https://stackoverflow.com/users/5002696/stefano"}, "is_accepted": true, "score": 0, "last_activity_date": 1481735286, "creation_date": 1481735286, "answer_id": 41148293, "question_id": 41147766, "link": "https://stackoverflow.com/questions/41147766/go-struct-inside-of-same-struct-type/41148293#41148293", "title": "Go struct inside of same struct type?", "body": "<p>The code is correct, but the anonimous filed A is lost because have the same names as the struct.\nSolution:</p>\n\n<pre><code>type A struct {\n   X string\n   Y int\n   Z *A\n}\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 5002696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe39a20a8b04687209259180ea4bc64?s=128&d=identicon&r=PG&f=1", "display_name": "Stefano", "link": "https://stackoverflow.com/users/5002696/stefano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 41148293, "answer_count": 1, "score": -1, "last_activity_date": 1481735286, "creation_date": 1481733693, "last_edit_date": 1481734852, "question_id": 41147766, "link": "https://stackoverflow.com/questions/41147766/go-struct-inside-of-same-struct-type", "title": "Go struct inside of same struct type?", "body": "<p>I want a relationship between structs, example: </p>\n\n<pre><code>type A struct {\n   X string\n   Y int\n   *A\n}\n</code></pre>\n\n<p>It's possible this?\nAnd if it's possible, what is the right way to marshal and unmarshal to JSON this?</p>\n\n<p>When i marshal this struct to JSON the field A is lost.</p>\n"}, {"tags": ["python", "oop", "go", "error-handling", "idioms"], "comments": [{"owner": {"reputation": 32098, "user_id": 124319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVhrR.jpg?s=128&g=1", "display_name": "coredump", "link": "https://stackoverflow.com/users/124319/coredump"}, "edited": false, "score": 3, "creation_date": 1481732109, "post_id": 41147191, "comment_id": 69496814, "body": "Is it important if it is idiomatic? If it helps you, panic or log, that should be enough."}, {"owner": {"reputation": 1012, "user_id": 6650014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10157116047225461/picture?type=large", "display_name": "Alex", "link": "https://stackoverflow.com/users/6650014/alex"}, "reply_to_user": {"reputation": 32098, "user_id": 124319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVhrR.jpg?s=128&g=1", "display_name": "coredump", "link": "https://stackoverflow.com/users/124319/coredump"}, "edited": false, "score": 2, "creation_date": 1481732153, "post_id": 41147191, "comment_id": 69496846, "body": "Not necessarily important, but I am still learning Go and want to understand the proper ways to use it."}, {"owner": {"reputation": 4719, "user_id": 2676845, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/TTFOs.jpg?s=128&g=1", "display_name": "fstanis", "link": "https://stackoverflow.com/users/2676845/fstanis"}, "edited": false, "score": 1, "creation_date": 1481734589, "post_id": 41147191, "comment_id": 69498475, "body": "I feel there&#39;s no correct answer to this. Interfaces are implemented implicitly, so if you created the interface in this case, then you should just modify it or separate into two separate interfaces. If you haven&#39;t, you should probably read the documentation and figure out how whatever uses the interface behaves and when would <code>Method2</code> be called anyway (e.g. if it&#39;s close file and you don&#39;t have a file to close, you can just do nothing and return success). In short, highly recommend that you give more information to get a better answer."}], "answers": [{"tags": [], "owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "is_accepted": false, "score": 2, "last_activity_date": 1481732208, "creation_date": 1481732208, "answer_id": 41147280, "question_id": 41147191, "link": "https://stackoverflow.com/questions/41147191/golang-equivalent-to-pythons-notimplementedexception/41147280#41147280", "title": "Golang equivalent to Python&#39;s NotImplementedException", "body": "<p>Usually in golang if you want to implement error handling you return an error</p>\n\n<pre><code>type MyInterface interface {\n    Method1() bool\n    Method2() (bool, error)\n}\n</code></pre>\n\n<p>Then you can return an error.\nYou can also log, or panic as @coredump said in the comments.</p>\n"}, {"tags": [], "owner": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "is_accepted": false, "score": 0, "last_activity_date": 1481732739, "creation_date": 1481732739, "answer_id": 41147454, "question_id": 41147191, "link": "https://stackoverflow.com/questions/41147191/golang-equivalent-to-pythons-notimplementedexception/41147454#41147454", "title": "Golang equivalent to Python&#39;s NotImplementedException", "body": "<p>a empty var will do this</p>\n\n<pre><code>var _ MyInterface = &amp;Thing{}\n</code></pre>\n\n<p>if <code>Thing</code> doesn't implement the interface <code>MyInterface</code>, compile will fail</p>\n"}, {"tags": [], "owner": {"reputation": 3439, "user_id": 1887281, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/xV9qF.jpg?s=128&g=1", "display_name": "devinbost", "link": "https://stackoverflow.com/users/1887281/devinbost"}, "is_accepted": false, "score": 0, "last_activity_date": 1578765874, "creation_date": 1578765874, "answer_id": 59697192, "question_id": 41147191, "link": "https://stackoverflow.com/questions/41147191/golang-equivalent-to-pythons-notimplementedexception/59697192#59697192", "title": "Golang equivalent to Python&#39;s NotImplementedException", "body": "<p>Here's an example that was generated from my implementation of gRPC in Go:</p>\n\n<pre><code>import (\n    status \"google.golang.org/grpc/status\"\n)\n\n// . . .\n\n// UnimplementedInstanceControlServer can be embedded to have forward compatible implementations.\ntype UnimplementedInstanceControlServer struct {\n}\n\nfunc (*UnimplementedInstanceControlServer) HealthCheck(ctx context.Context, req *empty.Empty) (*HealthCheckResult, error) {\n    return nil, status.Errorf(codes.Unimplemented, \"method HealthCheck not implemented\")\n}\n</code></pre>\n\n<p>Alternatively, you could log an error inside the method and then return a nil to satisfy the method contract.</p>\n"}], "owner": {"reputation": 1012, "user_id": 6650014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10157116047225461/picture?type=large", "display_name": "Alex", "link": "https://stackoverflow.com/users/6650014/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2141, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1578765874, "creation_date": 1481731887, "last_edit_date": 1481732418, "question_id": 41147191, "link": "https://stackoverflow.com/questions/41147191/golang-equivalent-to-pythons-notimplementedexception", "title": "Golang equivalent to Python&#39;s NotImplementedException", "body": "<p>Is there an equivalent in Golang to raising a <code>NotImplementedException</code> in Python when you define an interface with methods that you don't want to implement yet? Is this idiomatic Golang?</p>\n\n<p>For example:</p>\n\n<pre><code>type MyInterface interface {\n    Method1() bool\n    Method2() bool\n}\n\n\n// Implement this interface\ntype Thing struct {}\nfunc (t *Thing) Method1() bool {\n    return true\n}\n\nfunc (t *Thing) Method2() bool {\n    // I don't want to implement this yet\n}\n</code></pre>\n"}, {"tags": ["go", "mux"], "answers": [{"tags": [], "owner": {"reputation": 10833, "user_id": 1305067, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/HI2TR.png?s=128&g=1", "display_name": "paulvs", "link": "https://stackoverflow.com/users/1305067/paulvs"}, "is_accepted": false, "score": 3, "last_activity_date": 1482790948, "last_edit_date": 1482790948, "creation_date": 1481730999, "answer_id": 41146889, "question_id": 41146750, "link": "https://stackoverflow.com/questions/41146750/understanding-mux-router-in-golang/41146889#41146889", "title": "Understanding mux router in golang", "body": "<p>It appears that you are not assigning <code>r</code> to anything, you should add the following at the end of your <code>main</code>:</p>\n\n<pre><code>http.Handle(\"/\", r)\n</code></pre>\n"}], "owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 898, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1482790948, "creation_date": 1481730648, "question_id": 41146750, "link": "https://stackoverflow.com/questions/41146750/understanding-mux-router-in-golang", "title": "Understanding mux router in golang", "body": "<p>here is my code trying to display a base64 image it worked before using mux.    </p>\n\n<p>I've used http handlefunc before using mux, here i want to use mux and get the value of key.</p>\n\n<pre><code>package main\n\nimport (\n\"fmt\"\n\"net/http\"\n\"strconv\"\nbase64 \"encoding/base64\"\n\"log\"\n\"io\"\n    \"io/ioutil\"\n    \"os\"\n    \"github.com/gorilla/mux\"\n)\n\n\nvar (\n    Trace   *log.Logger\n    Info    *log.Logger\n    Warning *log.Logger\n    Error   *log.Logger\n)\n\nfunc Init(\ntraceHandle io.Writer,\ninfoHandle io.Writer,\nwarningHandle io.Writer,\nerrorHandle io.Writer) {\n\n    Trace = log.New(traceHandle,\n        \"TRACE: \",\n        log.Ldate|log.Ltime|log.Lshortfile)\n\n    Info = log.New(infoHandle,\n        \"INFO: \",\n        log.Ldate|log.Ltime|log.Lshortfile)\n\n    Warning = log.New(warningHandle,\n        \"WARNING: \",\n        log.Ldate|log.Ltime|log.Lshortfile)\n\n    Error = log.New(errorHandle,\n        \"ERROR: \",\n        log.Ldate|log.Ltime|log.Lshortfile)\n}\n\nfunc get_info(r *http.Request){\nfmt.Println(r.RemoteAddr)\nfmt.Println(r.Header.Get(\"x-forwarded-for\"))\nfmt.Println(r.UserAgent())\nfmt.Println(r.Referer())\n}\n\n\nfunc pix(w http.ResponseWriter, r *http.Request) {\n    Info.Println(\"Hi there, I love %s!\", r.URL.Path[1:])\n    vars := mux.Vars(r)\n    key := vars[\"key\"]\n    Info.Println(\"key\", key)\n    var cookie  *http.Cookie\n    cookie , err := r.Cookie(\"csrftoken\")\n    if (err != nil ){\n        fmt.Printf(\"error\")\n        fmt.Println(err)\n    }\n    get_info(r)\n    fmt.Printf(cookie.Value)\n    w.Header().Set(\"Content-Type\", \"image/jpeg\")\n    p, err := base64.StdEncoding.DecodeString(\"iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAIAAACRXR/mAAADMUlEQVRYw+2YTUgUYRjHZzOJIoNA+rrUyYNIRQgRHaLo4qFDBEGeunSxS9TFU0QEnhIh6IvokrUzO2uamRmbG6XmR/mVaKZpZVbYvvO143zszsxOz+yahNm+785sITEP72F3Z+adH8/zf5+PpagwtxKXj+Vj+Vg+lo/lY+W+WI4KpddKwWIQFUSF97nNLcLGZt75SiOHchEXfskDVmYjlowpiEoei3UT2ljcFJOpOd169C1Z2SuvgsdpB7cgzB16EV/byGM2xDIVPxQujKmBDF/2m2l0vFvmEin7N2v8kiiPiOeGlGHRvP1RdxA9eYtGR7pk2Pf6lI7RCoP2RaWkZWe3fsFc18hvesAHPGEFUc24ltnx3kyiCJwfRMs6dTXLdSIjO9Osal18qzKfE5V9coDxhlU7qS3uOyiaB55JDtkS2TKoLCLaOLPS4b02pQdCHiUfRKf653/d2kjZN6f10jYxI2EnrGk5H+2WsVi6ZZ8fVSmGQKaYyyFuR6ugmUtVrJo2C7HokeGq8447sYpOPBbo3XFzKC95626sZlz905sUM9XLGbXvtKtTOhZrQDApkhNNkiAOPo/viojh2YSZsj1aF2eQ5n2stuomNQjiiGQanrFufdCXP8gu8tbhjridJ6saVPKExXJrwlwfb3pnAg2Ut0tEBZFI8gza81Tik15DCDIoINQ7aQdBo90RMfrdwNaWLFY9opJGkBQrhCA/HXspQ8W1XHkN6vfWFiGH9ouwhdpJUFuy2JX3eg6uyqENpNHZYcUd02jcLMI2WO67UwZVv1G1HLMq3L83KuEbLPdY7IL2L42p0MMQiuzkq/ncwucOi6qPbWkWoPfCUsENpweUnP1EmE4XGhgagT72RyXolkSCHBbTU3By3fgJj8VyJW3CmSHl8oTWMJuYUUizVvtcsuyJ6J4J663CMLevXar/lJgnKNSgbphzKjriTn5i0F8eX9ODXnEzf6JHvjGtv+aNGdWCOEKnJRmpr5oFVQV8WTWglIKHMlPhv5uqQ1xGYfB5fRMPo+n2VmFbi7ChiS9oWBhZvXrI01TNLg7yPxt51v9rxMfysXwsH8vH+g+wfgDUr+5LcyNV4AAAAABJRU5ErkJggg==\")\n    if err != nil {\n        http.Error(w, \"internal error\", 500)\n        return\n    }\n    w.Header().Set(\"Content-Length\", strconv.Itoa(len(p))) //len(dec)\n    w.Write(p)\n}\n\n\nfunc main() {\n    Init(ioutil.Discard, os.Stdout, os.Stdout, os.Stderr)\n    Info.Println(\"1\")\n    r := mux.NewRouter()\n    Info.Println(\"2\")\n    r.HandleFunc(\"/pix/{key}/pixel.gif\", pix)\n    err := http.ListenAndServe(\":9080\", nil)\n    Info.Println(\"3\")\n    if err != nil {\n        fmt.Println(err)\n    }\n}\n</code></pre>\n\n<p>It seems that when i call <a href=\"http://localhost:9080/pix/2/pixel.gif\" rel=\"nofollow noreferrer\">http://localhost:9080/pix/2/pixel.gif</a>\nit doesn't call pix.</p>\n\n<p>the url for calling it seems correct</p>\n\n<p>any idea why ?</p>\n\n<p>regards and thanks</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 7297164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vSPLm.gif?s=128&g=1", "display_name": "Rocky", "link": "https://stackoverflow.com/users/7297164/rocky"}, "edited": false, "score": 0, "creation_date": 1481815539, "post_id": 41155793, "comment_id": 69535853, "body": "Awesome ! Superb solution at one short. Love You! Keep up with great work."}], "tags": [], "owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "is_accepted": true, "score": 2, "last_activity_date": 1481771346, "creation_date": 1481771346, "answer_id": 41155793, "question_id": 41146072, "link": "https://stackoverflow.com/questions/41146072/golang-how-to-concatenate-byte-key-vaules-with-other-variable/41155793#41155793", "title": "golang how to concatenate []byte key vaules with other variable", "body": "<p>Go doesn't support string interpolation, so you'll have to use something like <a href=\"https://golang.org/pkg/fmt/#Sprintf\" rel=\"nofollow noreferrer\"><code>fmt.Sprintf</code></a> or the <a href=\"https://golang.org/pkg/text/template/\" rel=\"nofollow noreferrer\"><code>template</code></a> package if you want to compose strings out of smaller substrings.</p>\n\n<p>You can do the former like so:</p>\n\n<pre><code>var buf bytes.Buffer\nbyt := []byte(fmt.Sprintf(`\n                    {\n                        \"fields\": {\n                          \"project\":\n                           { \n                              \"key\": \"DC\"\n                           },\n                           \"summary\": \"Test%d\",\n                           \"description\": \"%s\",\n                           \"issuetype\": {\n                              \"name\": \"Bug\"\n                           }\n                       }\n                    }`, result.SummaryID, result.Description))\n</code></pre>\n\n<p>Though I would really advise against it, since the <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow noreferrer\"><code>encoding/json</code></a> package is designed for safely and sanely outputting JSON strings.</p>\n\n<p><a href=\"https://play.golang.org/p/oAUaiRyt_5\" rel=\"nofollow noreferrer\">Here's an example</a> that uses struct embedding for the main object, and maps elsewhere to demonstrate both approaches.</p>\n\n<pre><code>type WrappedResult struct {\n    Project map[string]string `json:\"project\"`\n    Result\n    IssueType map[string]string `json:\"issuetype\"`\n}\n\nbyt, err := json.MarshalIndent(map[string]interface{}{\n    \"fields\": WrappedResult{\n        Result: result,\n        Project: map[string]string{ \"key\": \"DC\" },\n        IssueType: map[string]string{ \"name\": \"Bug\" },\n     },\n});\n</code></pre>\n\n<p>(note that your type declaration contradicts your JSON example in that the former specifies <code>summaryid</code> but the latter has <code>summary</code>)</p>\n"}], "owner": {"reputation": 29, "user_id": 7297164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vSPLm.gif?s=128&g=1", "display_name": "Rocky", "link": "https://stackoverflow.com/users/7297164/rocky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 631, "favorite_count": 0, "accepted_answer_id": 41155793, "answer_count": 1, "score": -5, "last_activity_date": 1481771346, "creation_date": 1481728756, "last_edit_date": 1481729176, "question_id": 41146072, "link": "https://stackoverflow.com/questions/41146072/golang-how-to-concatenate-byte-key-vaules-with-other-variable", "title": "golang how to concatenate []byte key vaules with other variable", "body": "<p>How to concatenate variable value into the byte key values ?</p>\n\n<pre><code>type Result struct {\n        SummaryID       int              `json:\"summaryid\"`\n        Description     string           `json:\"description\"` \n    }\n\nbyt := []byte(`\n                        {\n                            \"fields\": {                                                              \n                               \"project\":\n                               { \n                                  \"key\": \"DC\"\n                               },\n                               \"summary\": \"Test\" + Result.SummaryID,    \n                               \"description\": Result.Description,\n                               \"issuetype\": {\n                                  \"name\": \"Bug\"\n                               }\n                           }\n                        }`)\n</code></pre>\n\n<p>Note: values of <code>Result.SummaryID</code> and <code>Result.Description</code> return from the <code>db.Query()</code> and <code>rows.Scan()</code>.</p>\n"}, {"tags": ["mysql", "json", "go", "marshalling", "go-gorm"], "comments": [{"owner": {"reputation": 13379, "user_id": 1033027, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b56ea1c43a4ecb1060ec8bcb8d2bce78?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/1033027/jules"}, "edited": false, "score": 0, "creation_date": 1481729081, "post_id": 41146050, "comment_id": 69494787, "body": "First of all, <b>how does it not work?</b> What&#39;s breaking? Second, I&#39;m not a Go expert -- but wouldn&#39;t it make more sense that the second annotation read <code>json:&quot;data&quot;</code>?"}, {"owner": {"reputation": 390, "user_id": 1515447, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/43510527f879c9121efd0cb0d115d577?s=128&d=identicon&r=PG&f=1", "display_name": "An Phung", "link": "https://stackoverflow.com/users/1515447/an-phung"}, "reply_to_user": {"reputation": 13379, "user_id": 1033027, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b56ea1c43a4ecb1060ec8bcb8d2bce78?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/1033027/jules"}, "edited": false, "score": 0, "creation_date": 1481733201, "post_id": 41146050, "comment_id": 69497582, "body": "Thanks for the suggestion."}, {"owner": {"reputation": 13379, "user_id": 1033027, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b56ea1c43a4ecb1060ec8bcb8d2bce78?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/1033027/jules"}, "edited": false, "score": 0, "creation_date": 1481737653, "post_id": 41146050, "comment_id": 69500263, "body": "If this is working with a pre-existing database, is there any chance that there&#39;s a type conflict between the <code>data</code> field and the corresponding database field?"}, {"owner": {"reputation": 390, "user_id": 1515447, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/43510527f879c9121efd0cb0d115d577?s=128&d=identicon&r=PG&f=1", "display_name": "An Phung", "link": "https://stackoverflow.com/users/1515447/an-phung"}, "reply_to_user": {"reputation": 13379, "user_id": 1033027, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b56ea1c43a4ecb1060ec8bcb8d2bce78?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/1033027/jules"}, "edited": false, "score": 0, "creation_date": 1481738832, "post_id": 41146050, "comment_id": 69500850, "body": "<code>gorm</code> is an ORM, so the schema is defined on the fly (in this case <code>db.CreateTable</code> and <code>db.AutoMigrate</code>). I think this is a feature that <code>gorm</code> not implemented yet. I found a work around that uses 2 struct; one uses <code>string</code> for <code>json.Unmarshal()</code> part, then copy each field of this struct to another struct that uses <code>interface{}</code>; but it looks rather messy when <code>Item</code> has lots of fields. So, I want to know if anyone have better idea."}, {"owner": {"reputation": 534, "user_id": 4513263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c02283d203020618ad7d90e061632d4?s=128&d=identicon&r=PG&f=1", "display_name": "Elad", "link": "https://stackoverflow.com/users/4513263/elad"}, "edited": false, "score": 0, "creation_date": 1481738895, "post_id": 41146050, "comment_id": 69500885, "body": "Try to change the type from <code>interface{}</code> to <code>json.RawMessage</code>, if you sure its a json."}, {"owner": {"reputation": 390, "user_id": 1515447, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/43510527f879c9121efd0cb0d115d577?s=128&d=identicon&r=PG&f=1", "display_name": "An Phung", "link": "https://stackoverflow.com/users/1515447/an-phung"}, "edited": false, "score": 0, "creation_date": 1481739203, "post_id": 41146050, "comment_id": 69501041, "body": "It got similar error while calling <code>db.Create(item)</code>: <code>(sql: converting Exec argument #5&#39;s type: unsupported type json.RawMessage, a slice)</code>"}, {"owner": {"reputation": 7745, "user_id": 3926995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2l63X.jpg?s=128&g=1", "display_name": "Chiheb Nexus", "link": "https://stackoverflow.com/users/3926995/chiheb-nexus"}, "edited": false, "score": 0, "creation_date": 1481742185, "post_id": 41146050, "comment_id": 69502664, "body": "Is your <code>&quot;data&quot;: {1: 2}</code> field contain non string keys like what you&#39;ve put in your question ? Try to have a look at this <a href=\"http://blog.dubbelboer.com/2015/05/24/go-intmap-marshal.html\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 390, "user_id": 1515447, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/43510527f879c9121efd0cb0d115d577?s=128&d=identicon&r=PG&f=1", "display_name": "An Phung", "link": "https://stackoverflow.com/users/1515447/an-phung"}, "edited": false, "score": 0, "creation_date": 1481763579, "post_id": 41146050, "comment_id": 69511390, "body": "Nice catch, my bad, it should contain only string key."}, {"owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "edited": false, "score": 0, "creation_date": 1481772364, "post_id": 41146050, "comment_id": 69513624, "body": "<code>json.RawMessage</code> is an alias for <code>[]byte</code> which <a href=\"https://golang.org/src/encoding/json/stream.go?s=6218:6240#L237\" rel=\"nofollow noreferrer\">defines the JSON marshaller interface</a>. You can implement an analogous type yourself based on <code>string</code>, whose <code>UnmarshalJSON</code> method casts its argument to a <code>string</code> instead of appending it to the invocant slice."}, {"owner": {"reputation": 390, "user_id": 1515447, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/43510527f879c9121efd0cb0d115d577?s=128&d=identicon&r=PG&f=1", "display_name": "An Phung", "link": "https://stackoverflow.com/users/1515447/an-phung"}, "edited": false, "score": 0, "creation_date": 1481773693, "post_id": 41146050, "comment_id": 69513949, "body": "Thanks, I just implemented the same thing you mentioned."}], "answers": [{"tags": [], "owner": {"reputation": 390, "user_id": 1515447, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/43510527f879c9121efd0cb0d115d577?s=128&d=identicon&r=PG&f=1", "display_name": "An Phung", "link": "https://stackoverflow.com/users/1515447/an-phung"}, "is_accepted": true, "score": 1, "last_activity_date": 1481774035, "creation_date": 1481774035, "answer_id": 41156160, "question_id": 41146050, "link": "https://stackoverflow.com/questions/41146050/gorm-json-of-json-not-work/41156160#41156160", "title": "gorm: json of json not work", "body": "<p>The solution is defining a custom type that implements <code>sql.Valuer</code>, <code>sql.Scanner</code>, <code>json.Marshaler</code> and <code>json.Unmarshaler</code> interfaces. Sample of my implementation:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Data string\n\nfunc (t *Data) MarshalJSON() ([]byte, error) {\n    return []byte(*t), nil\n}\n\nfunc (t *Data) UnmarshalJSON(data []byte) error {\n    *t = Data(data)\n    return nil\n}\n\nfunc (t Data) Value() (driver.Value, error) {\n    return string(t), nil\n}\n\nfunc (t *Data) Scan(src interface{}) error {\n    s, ok := src.([]byte)\n    if !ok {\n        return nil\n    }\n    *t = Data(s)\n    return nil\n}\n\n// Data implements the below interfaces to satisfy both\n// json parser and sql parser\nvar _ json.Marshaler = (*Data)(nil)\nvar _ json.Unmarshaler = (*Data)(nil)\nvar _ sql.Scanner = (*Data)(nil)\nvar _ driver.Valuer = (*Data)(nil)\n</code></pre>\n"}], "owner": {"reputation": 390, "user_id": 1515447, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/43510527f879c9121efd0cb0d115d577?s=128&d=identicon&r=PG&f=1", "display_name": "An Phung", "link": "https://stackoverflow.com/users/1515447/an-phung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2336, "favorite_count": 0, "accepted_answer_id": 41156160, "answer_count": 1, "score": 0, "last_activity_date": 1481774035, "creation_date": 1481728664, "last_edit_date": 1481763591, "question_id": 41146050, "link": "https://stackoverflow.com/questions/41146050/gorm-json-of-json-not-work", "title": "gorm: json of json not work", "body": "<p>Sample:</p>\n\n<pre><code>{\n  \"id\": 1\n  \"data\": {\"1\": 2}\n}\n</code></pre>\n\n<p>Struct definition:</p>\n\n<pre><code>type Item struct {\n  id int `json:\"id\"`\n  data interface{} `json:\"data\"`\n}\n</code></pre>\n\n<p>I need to parse the payload from a http post, so I used <code>interface{}</code> for <code>data</code>, <code>json.Unmarshal()</code> is successful, but gorm produces error while calling <code>db.Create(item)</code>:</p>\n\n<pre><code>(sql: converting Exec argument #5's type: unsupported type map[string]interface {}, a map)\n</code></pre>\n\n<p>Instead, I change from <code>interface{}</code> to <code>string</code>, calling <code>json.Unmarshal()</code> to parse json POST payload produces error.</p>\n\n<pre><code>unmarshal type error: expected=string, got=object\n</code></pre>\n\n<p>Basically, one requires <code>interface{}</code>, one requires <code>string</code>.</p>\n\n<p>Anyone encountered this?</p>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 4, "creation_date": 1481725141, "post_id": 41144656, "comment_id": 69492121, "body": "This is not the issue, but you should replace <code>io.WriteString(w,string(p))</code> with the more efficient and simpler <code>w.Write(p)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 6, "last_activity_date": 1481725058, "creation_date": 1481725058, "answer_id": 41144827, "question_id": 41144656, "link": "https://stackoverflow.com/questions/41144656/render-an-image-from-base64-in-golang/41144827#41144827", "title": "Render an image from base64 in golang", "body": "<p>You are writing data to client other than the image. Specifically, this line:</p>\n\n<pre><code>fmt.Fprintf(w, \"Hi there, I love %s!\", r.URL.Path[1:])\n</code></pre>\n\n<p>You browser tries to render the content as a JPEG, but fails because of this extra data, so it prompts you to download it instead. Remove it and the picture will be displayed correctly.</p>\n\n<p>You should also follow @Mellow Marmot's suggestion and use <code>w.Write(p)</code> instead of <code>io.WriteString(w, string(p))</code>.</p>\n"}], "owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1339, "favorite_count": 0, "accepted_answer_id": 41144827, "answer_count": 1, "score": -1, "last_activity_date": 1481725573, "creation_date": 1481724516, "last_edit_date": 1481725573, "question_id": 41144656, "link": "https://stackoverflow.com/questions/41144656/render-an-image-from-base64-in-golang", "title": "Render an image from base64 in golang", "body": "<p>I would like to render an image from base64 in golang (here the twitter icon)</p>\n\n<pre><code>package main\n\nimport (\n    base64 \"encoding/base64\"\n    \"fmt\"\n    \"io\"\n    \"net/http\"\n    \"strconv\"\n)\n\nfunc pix(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"Hi there, I love %s!\", r.URL.Path[1:])\n    var cookie *http.Cookie\n    cookie, err := r.Cookie(\"csrftoken\")\n    if err != nil {\n        fmt.Printf(\"error\")\n        fmt.Println(err)\n    }\n    fmt.Printf(cookie.Value)\n    w.Header().Set(\"Content-Type\", \"image/jpeg\")\n    p, err := base64.StdEncoding.DecodeString(\"iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAIAAACRXR/mAAADMUlEQVRYw+2YTUgUYRjHZzOJIoNA+rrUyYNIRQgRHaLo4qFDBEGeunSxS9TFU0QEnhIh6IvokrUzO2uamRmbG6XmR/mVaKZpZVbYvvO143zszsxOz+yahNm+785sITEP72F3Z+adH8/zf5+PpagwtxKXj+Vj+Vg+lo/lY+W+WI4KpddKwWIQFUSF97nNLcLGZt75SiOHchEXfskDVmYjlowpiEoei3UT2ljcFJOpOd169C1Z2SuvgsdpB7cgzB16EV/byGM2xDIVPxQujKmBDF/2m2l0vFvmEin7N2v8kiiPiOeGlGHRvP1RdxA9eYtGR7pk2Pf6lI7RCoP2RaWkZWe3fsFc18hvesAHPGEFUc24ltnx3kyiCJwfRMs6dTXLdSIjO9Osal18qzKfE5V9coDxhlU7qS3uOyiaB55JDtkS2TKoLCLaOLPS4b02pQdCHiUfRKf653/d2kjZN6f10jYxI2EnrGk5H+2WsVi6ZZ8fVSmGQKaYyyFuR6ugmUtVrJo2C7HokeGq8447sYpOPBbo3XFzKC95626sZlz905sUM9XLGbXvtKtTOhZrQDApkhNNkiAOPo/viojh2YSZsj1aF2eQ5n2stuomNQjiiGQanrFufdCXP8gu8tbhjridJ6saVPKExXJrwlwfb3pnAg2Ut0tEBZFI8gza81Tik15DCDIoINQ7aQdBo90RMfrdwNaWLFY9opJGkBQrhCA/HXspQ8W1XHkN6vfWFiGH9ouwhdpJUFuy2JX3eg6uyqENpNHZYcUd02jcLMI2WO67UwZVv1G1HLMq3L83KuEbLPdY7IL2L42p0MMQiuzkq/ncwucOi6qPbWkWoPfCUsENpweUnP1EmE4XGhgagT72RyXolkSCHBbTU3By3fgJj8VyJW3CmSHl8oTWMJuYUUizVvtcsuyJ6J4J663CMLevXar/lJgnKNSgbphzKjriTn5i0F8eX9ODXnEzf6JHvjGtv+aNGdWCOEKnJRmpr5oFVQV8WTWglIKHMlPhv5uqQ1xGYfB5fRMPo+n2VmFbi7ChiS9oWBhZvXrI01TNLg7yPxt51v9rxMfysXwsH8vH+g+wfgDUr+5LcyNV4AAAAABJRU5ErkJggg==\")\n    if err != nil {\n        http.Error(w, \"internal error\", 500)\n        return\n    }\n    w.Header().Set(\"Content-Length\", strconv.Itoa(len(p))) //len(dec)\n    io.WriteString(w, string(p))\n}\n\nfunc main() {\n    http.HandleFunc(\"/pix/\", pix)\n    err := http.ListenAndServe(\":9080\", nil)\n    if err != nil {\n        fmt.Println(err)\n    }\n}\n</code></pre>\n\n<p>But it doesn't display anything and when I try to go to the URL; it downloads a file that contains error. Anyone have any idea why this is?</p>\n"}, {"tags": ["xml", "go", "struct", "slice"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1481734310, "last_edit_date": 1481734310, "creation_date": 1481730642, "answer_id": 41146746, "question_id": 41144058, "link": "https://stackoverflow.com/questions/41144058/xml-document-with-attributes-with-golang/41146746#41146746", "title": "xml document with attributes with golang", "body": "<p>You have to model your XML structure with Go structs.</p>\n\n<p>For elements which may have varying content (child elements), one option is to list all possible variations, and only the encountered element will be unmarshaled.</p>\n\n<p>Your XML structure can be modeled like this:</p>\n\n<pre><code>type Venue struct {\n    As []A `xml:\"c&gt;a\"`\n}\n\ntype A struct {\n    N string `xml:\"n,attr\"`\n    I I      `xml:\"i\"`\n    B B      `xml:\"b\"`\n}\n\ntype I struct {\n    I int `xml:\",chardata\"`\n}\n\ntype B struct {\n    V bool `xml:\"v,attr\"`\n}\n</code></pre>\n\n<p>And code to unmarshal the XML document:</p>\n\n<pre><code>func main() {\n    var v Venue\n    err := xml.Unmarshal([]byte(data), &amp;v)\n    fmt.Printf(\"%+v %v\", v, err)\n}\n\nconst data = `&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE venue SYSTEM \"z.dtd\"&gt;\n&lt;venue&gt;\n&lt;c&gt;\n    &lt;a n=\"k1\"&gt;&lt;i&gt;1&lt;/i&gt;&lt;/a&gt;\n    &lt;a n=\"k2\"&gt;&lt;b v=\"f\"/&gt;&lt;/a&gt;\n&lt;/c&gt;\n&lt;/venue&gt;`\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/Nd4cXt19Z_\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>{As:[{N:k1 I:{I:1} B:{V:false}} {N:k2 I:{I:0} B:{V:false}}]} &lt;nil&gt;\n</code></pre>\n\n<p>As you can see, the first element of the <code>Venue.As</code> slice has <code>A.N=k1</code>, and it has the <code>A.I.I=1</code> value, which was taken from the XML.</p>\n\n<p>The second element of the <code>Venue.As</code> slice has <code>A.N=k2</code>, and it has the <code>A.B.V=false</code> value, taken from the XML.</p>\n\n<p>If it bothers you that the \"wrapper\" <code>A</code> struct contains both the <code>I</code> and the <code>B</code> fields (even though only one of them contains valid data), you may declare them to be pointers, and the one that is not present in the XML will be <code>nil</code> (making it obvious and easy to tell which element was present in the XML):</p>\n\n<pre><code>type A struct {\n    N string `xml:\"n,attr\"`\n    I *I     `xml:\"i\"`\n    B *B     `xml:\"b\"`\n}\n</code></pre>\n\n<p>Output this time (try it on the <a href=\"https://play.golang.org/p/Mby1KzqJE7\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>{As:[{N:k1 I:0x1050e24c B:&lt;nil&gt;} {N:k2 I:&lt;nil&gt; B:0x1050e2f5}]} &lt;nil&gt;\n</code></pre>\n"}], "owner": {"reputation": 2502, "user_id": 3589054, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2af7ed5cc40b1b8479cd082ca3e0c4af?s=128&d=identicon&r=PG&f=1", "display_name": "NinjaGaiden", "link": "https://stackoverflow.com/users/3589054/ninjagaiden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "accepted_answer_id": 41146746, "answer_count": 1, "score": 2, "last_activity_date": 1536075921, "creation_date": 1481722725, "last_edit_date": 1536075921, "question_id": 41144058, "link": "https://stackoverflow.com/questions/41144058/xml-document-with-attributes-with-golang", "title": "xml document with attributes with golang", "body": "<p>I have an XML document which looks like this</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE venue SYSTEM \"z.dtd\"&gt;\n&lt;venue&gt;\n&lt;c&gt;\n    &lt;a n=\"k1\"&gt;&lt;i&gt;0&lt;/i&gt;&lt;/a&gt;\n    &lt;a n=\"k2\"&gt;&lt;b v=\"f\"/&gt;&lt;/a&gt;\n&lt;/c&gt;\n&lt;/venue&gt;\n</code></pre>\n\n<p>I would like to extract k1 (integer) , 0 and also k2 (bool) , false</p>\n\n<p>How can I do this with \"encoding/xml\" ?</p>\n"}, {"tags": ["xml", "date", "go"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 2, "last_activity_date": 1481720962, "creation_date": 1481720962, "answer_id": 41143483, "question_id": 41143350, "link": "https://stackoverflow.com/questions/41143350/parsing-date-from-xml-does-not-work/41143483#41143483", "title": "Parsing date from XML does not work", "body": "<p><code>date</code> is an XML attribute, not an element. Therefore, you must implement the <a href=\"https://godoc.org/encoding/xml#UnmarshalerAttr\" rel=\"nofollow noreferrer\"><code>xml.UnmarshalerAttr</code></a> interface rather than <a href=\"https://godoc.org/encoding/xml#Unmarshaler\" rel=\"nofollow noreferrer\"><code>xml.Unmarshaler</code></a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n    \"time\"\n)\n\ntype xmlSource struct {\n    XMLName xml.Name `xml:\"BicDBList\"`\n    Base    string   `xml:\"Base,attr\"`\n    Items   []item   `xml:\"item\"`\n}\n\n// Item represent structure of node \"item\"\ntype item struct {\n    File string     `xml:\"file,attr\"`\n    Date customDate `xml:\"date,attr\"`\n}\n\ntype customDate struct {\n    time.Time\n}\n\nfunc (c *customDate) UnmarshalXMLAttr(attr xml.Attr) error {\n    loc, err := time.LoadLocation(\"Europe/Moscow\")\n    if err != nil {\n        return err\n    }\n    prs, err := time.ParseInLocation(\"02.01.2006\", attr.Value, loc)\n    if err != nil {\n        return err\n    }\n\n    c.Time = prs\n    return nil\n}\n\nvar data = []byte(`&lt;BicDBList Base=\"/mcirabis/BIK/\"&gt;\n    &lt;item file=\"bik_db_09122016.zip\" date=\"09.12.2016\"/&gt;\n    &lt;item file=\"bik_db_08122016.zip\" date=\"08.12.2016\"/&gt;\n    &lt;item file=\"bik_db_07122016.zip\" date=\"07.12.2016\"/&gt;\n    &lt;item file=\"bik_db_06122016.zip\" date=\"06.12.2016\"/&gt;\n&lt;/BicDBList&gt;`)\n\nfunc main() {\n    var sample xmlSource\n\n    err := xml.Unmarshal(data, &amp;sample)\n\n    if err != nil {\n        println(err.Error())\n    }\n    fmt.Printf(\"%#v\\n\", sample)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/U56qfEOe-A\" rel=\"nofollow noreferrer\">https://play.golang.org/p/U56qfEOe-A</a></p>\n"}], "owner": {"reputation": 37, "user_id": 2782106, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/35ea3e05dcf39844745b5a5dc3317e45?s=128&d=identicon&r=PG&f=1", "display_name": "user2782106", "link": "https://stackoverflow.com/users/2782106/user2782106"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 1, "accepted_answer_id": 41143483, "answer_count": 1, "score": 2, "last_activity_date": 1481721105, "creation_date": 1481720519, "last_edit_date": 1481721105, "question_id": 41143350, "link": "https://stackoverflow.com/questions/41143350/parsing-date-from-xml-does-not-work", "title": "Parsing date from XML does not work", "body": "<p>If I execute <code>time.Parse()</code> with simple values - then everything is fine, but parsing XML does not.</p>\n\n<pre><code>type customDate struct {\n    time.Time\n}\n\n\nfunc (c *customDate) UnmarshalXml(d *xml.Decoder, start xml.StartElement) error {\n    var v string\n    if err := d.DecodeElement(&amp;v, &amp;start); err != nil{\n        return err\n    }\n\n    loc, _ := time.LoadLocation(\"Europe/Moscow\")\n    prs, err := time.ParseInLocation(\"02.01.2006\", v, loc)\n    if err != nil {\n        return err\n    }\n\n    *c = customDate{prs}\n    return nil\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/nCuxTmK-uZ\" rel=\"nofollow noreferrer\">example on playground</a></p>\n"}, {"tags": ["go", "reverse-proxy", "go-iris"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1481722417, "post_id": 41143044, "comment_id": 69490261, "body": "I don&#39;t understand why anyone uses iris <a href=\"http://www.florinpatan.ro/2016/10/why-you-should-not-use-iris-for-your-go.html?m=1\" rel=\"nofollow noreferrer\">florinpatan.ro/2016/10/&hellip;</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481722911, "post_id": 41143044, "comment_id": 69490610, "body": "you can&#39;t use the httputil reverse proxy, because iris doesn&#39;t use the std lib net/http package."}, {"owner": {"reputation": 769, "user_id": 2647655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qGHOi.png?s=128&g=1", "display_name": "kataras", "link": "https://stackoverflow.com/users/2647655/kataras"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497095535, "post_id": 41143044, "comment_id": 75941512, "body": "@JimB After version 5, Iris is built on top of net/http to complete its HTTP/2 features."}], "answers": [{"tags": [], "owner": {"reputation": 2053, "user_id": 3734595, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/8e9c5c21bb867834bf0f3be8a7ce4b4d?s=128&d=identicon&r=PG&f=1", "display_name": "Ysak", "link": "https://stackoverflow.com/users/3734595/ysak"}, "is_accepted": false, "score": 0, "last_activity_date": 1481822946, "creation_date": 1481822946, "answer_id": 41170042, "question_id": 41143044, "link": "https://stackoverflow.com/questions/41143044/golang-reverseproxy-with-iris-go-framework/41170042#41170042", "title": "Golang ReverseProxy with Iris-Go framework", "body": "<p>After searching and posting at Iris i got this example in iris sources. May be helpful for others</p>\n\n<p><a href=\"https://github.com/kataras/iris/blob/master/http.go#L1412\" rel=\"nofollow noreferrer\">https://github.com/kataras/iris/blob/master/http.go#L1412</a></p>\n"}, {"comments": [{"owner": {"reputation": 2053, "user_id": 3734595, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/8e9c5c21bb867834bf0f3be8a7ce4b4d?s=128&d=identicon&r=PG&f=1", "display_name": "Ysak", "link": "https://stackoverflow.com/users/3734595/ysak"}, "edited": false, "score": 0, "creation_date": 1502975786, "post_id": 44473050, "comment_id": 78430077, "body": "Is there a way to do dynamic proxying, means, i cant configure my proxy to a constant third server, rather its on the incoming requests Header(say X-Forward-To).. So that request i should forward to the corresponding server mentioned there..."}], "tags": [], "owner": {"reputation": 769, "user_id": 2647655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qGHOi.png?s=128&g=1", "display_name": "kataras", "link": "https://stackoverflow.com/users/2647655/kataras"}, "is_accepted": false, "score": 0, "last_activity_date": 1497095835, "creation_date": 1497095835, "answer_id": 44473050, "question_id": 41143044, "link": "https://stackoverflow.com/questions/41143044/golang-reverseproxy-with-iris-go-framework/44473050#44473050", "title": "Golang ReverseProxy with Iris-Go framework", "body": "<p>With iris you have two options, make a proxy server and run it:</p>\n\n<pre><code>import \"github.com/kataras/iris/core/host\"\n[...]\ntarget, _ := url.Parse(\"https://example.com\")\ngo host.NewProxy(\"example.com:80\", target).ListenAndServe()\n// this will proxy all http://example.com to https://example.com\n// you can use that proxy as you like.\n</code></pre>\n\n<p>create a new proxy handler and use it anywhere you like: </p>\n\n<pre><code>import \"github.com/kataras/iris/core/host\"\n[...]\ntarget, _ := url.Parse(\"https://example.com\")\nproxy := host.ProxyHandler(target)\nhttp.ListenAndServe(\"example.com:80\", proxy)\n</code></pre>\n"}], "owner": {"reputation": 2053, "user_id": 3734595, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/8e9c5c21bb867834bf0f3be8a7ce4b4d?s=128&d=identicon&r=PG&f=1", "display_name": "Ysak", "link": "https://stackoverflow.com/users/3734595/ysak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 852, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1527044654, "creation_date": 1481719571, "last_edit_date": 1527044654, "question_id": 41143044, "link": "https://stackoverflow.com/questions/41143044/golang-reverseproxy-with-iris-go-framework", "title": "Golang ReverseProxy with Iris-Go framework", "body": "<p>Anybody able to wire Golang's ReverseProxy functionality with Iris-Go web framework. I couldnt make it working. I am able to wire it with regular net/http.</p>\n\n<pre><code>func MultiHostReverseProxy(targets map[string]utils.Service) *httputil.ReverseProxy {\n    r := regexp.MustCompile(`\\/proxy/(?P&lt;Service&gt;[a-zA-Z_-]*)(?P&lt;Path&gt;\\/.*)`)\n    director := func(req *http.Request) {\n        if strings.HasPrefix(req.URL.Path, \"/proxy/\") {\n            temp := r.FindStringSubmatch(req.URL.Path);\n            if (len(temp) &gt; 1) {\n                system := temp[1]\n                if val, ok := targets[system]; ok {\n                    s := val.Host + \":\" + val.Port\n                    req.URL.Scheme = val.Scheme\n                    req.URL.Host = s\n                    req.URL.Path = temp[2]\n\n                    if enc, ok := GetAxleHeader(req.Header); ok {\n                        dec := utils.Decrypt(KEY, enc)\n                        req.Header.Set(val.AuthHeader, dec)\n                        req.Header.Set(AXLE_HEADER, \"\")\n                    } else {\n                        token, nq := utils.FindAxleToken(req.URL.RawQuery);\n                        fmt.Printf(\"%s -&gt; token : %s    newQuery: %s\\n\", req.URL.RawQuery, token, nq);\n                        if token != \"\" {\n                            req.URL.RawQuery = nq\n                            dec := utils.Decrypt(KEY, token)\n                            req.Header.Set(val.AuthHeader, dec)\n                            req.Header.Set(AXLE_HEADER, \"\")\n                        }\n                    }\n                }\n            }\n        }\n    }\n    return &amp;httputil.ReverseProxy{Director: director}\n}\n</code></pre>\n\n<p>How can I use this ReverseProxy object with iris framework;</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 4, "creation_date": 1481717927, "post_id": 41142354, "comment_id": 69487297, "body": "Show the exact <code>go:generate</code> comment please."}, {"owner": {"reputation": 37807, "user_id": 293686, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1426a9fd5267e73d9e30ebaac1bde144?s=128&d=identicon&r=PG", "display_name": "Maur&#237;cio Linhares", "link": "https://stackoverflow.com/users/293686/maur%c3%adcio-linhares"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1481726107, "post_id": 41142354, "comment_id": 69492744, "body": "Updated with the actual line."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481726709, "post_id": 41142354, "comment_id": 69493140, "body": "Go generate isn&#39;t executing a shell. If you want a shell you need to execute one."}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 2, "last_activity_date": 1481727595, "last_edit_date": 1481727595, "creation_date": 1481726948, "answer_id": 41145479, "question_id": 41142354, "link": "https://stackoverflow.com/questions/41142354/bad-quoted-string-in-go-generate/41145479#41145479", "title": "&quot;bad quoted string&quot; in go generate", "body": "<p>Go generate only works by calling <em>one</em> command. If you want to call several, you either put them into a BASH script, or do something like this:</p>\n\n<pre><code>//go:generate echo var baseConfigProduction = `\n//go:generate cat base-production.json\n//go:generate echo `\n</code></pre>\n\n<p>But AFAIK, the order of evaluation for several <code>go:generate</code> commands is undefined, so you can't really count on that, so I would recommend sticking to BASH scripts.</p>\n\n<p><strong>EDIT:</strong> Another possibility:</p>\n\n<pre><code>//go:generate sh -c \"echo var baseConfigProduction = \\\\`$DOLLAR(cat base-production.json)\\\\`\"\n</code></pre>\n"}], "owner": {"reputation": 37807, "user_id": 293686, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1426a9fd5267e73d9e30ebaac1bde144?s=128&d=identicon&r=PG", "display_name": "Maur&#237;cio Linhares", "link": "https://stackoverflow.com/users/293686/maur%c3%adcio-linhares"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "accepted_answer_id": 41145479, "answer_count": 1, "score": -2, "last_activity_date": 1481727595, "creation_date": 1481717570, "last_edit_date": 1481726044, "question_id": 41142354, "link": "https://stackoverflow.com/questions/41142354/bad-quoted-string-in-go-generate", "title": "&quot;bad quoted string&quot; in go generate", "body": "<p>I'm trying to insert a file as a variable in a go file using <code>go generate</code> but it fails with <code>bad quoted string</code>, the issue is that I can run this in a shell without issue:</p>\n\n<pre><code>//go:generate echo \"var baseConfigProduction = \\`\" &amp;&amp; cat base-production.json &amp;&amp; echo \"\\`\"\n</code></pre>\n\n<p>What am I missing here?</p>\n"}, {"tags": ["go", "tcp", "connection-pooling", "pool", "tls1.2"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1481717493, "post_id": 41140914, "comment_id": 69487012, "body": "You can&#39;t copy a tls.Conn, always use a pointer."}, {"owner": {"reputation": 9, "user_id": 6524463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e3d86d06d6e13cc19b1f5cc18b1d85?s=128&d=identicon&r=PG&f=1", "display_name": "YoannK", "link": "https://stackoverflow.com/users/6524463/yoannk"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484219008, "post_id": 41140914, "comment_id": 70424277, "body": "Thank for your answer. The func Dial(network, addr string, config *Config) (*Conn, error)   , now it make sense why i can&#39;t return return *conn, err . Thank you"}], "owner": {"reputation": 9, "user_id": 6524463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e3d86d06d6e13cc19b1f5cc18b1d85?s=128&d=identicon&r=PG&f=1", "display_name": "YoannK", "link": "https://stackoverflow.com/users/6524463/yoannk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 354, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1481716512, "creation_date": 1481713145, "last_edit_date": 1481716512, "question_id": 41140914, "link": "https://stackoverflow.com/questions/41140914/how-to-create-a-tls-pool-in-go", "title": "How to create a TLS pool in go", "body": "<p>I currently have an issue with Golang 1.7.1\nMy purpose is to create a pool with TLS connections from lib \"crypto/tls\"</p>\n\n<p>My purpose is to forward stdin entry to the network via TLS. I am reading the stdin with <code>reader := bufio.NewReader(os.Stdin)</code> and loop at it. before the loop I tried to create the pool.</p>\n\n<p>I followed the TCP pool sample from : <a href=\"https://github.com/fatih/pool\" rel=\"nofollow noreferrer\">https://github.com/fatih/pool</a> </p>\n\n<p>Sample from my code :</p>\n\n<pre><code>factory    := func() (tls.Conn, error) {\n    log.Println(\"**************  factory start :) :() **************\")\n    conn, err :=    tls.Dial(\"tcp\", \"discover.logs.ovh.com:12202\" , &amp;tls.Config{\n    InsecureSkipVerify: true,   })\n    if err != nil {\n        panic(err)\n    }\n    log.Println(\"**************  factory stop :) **************\")\n    return *conn, err\n}\np, err := NewChannelPool(3, 10, factory)\nif err != nil {\n    panic(err)\n}\n\nreader := bufio.NewReader(os.Stdin)\nlog.Println(\"NewReader done\")\nfor {\n    line, overflow, err := reader.ReadLine()\n    if err == io.EOF {\n        /*err = p.Close()\n        if err != nil {\n            log.Fatal(err)\n        }*/\n        os.Exit(0)\n    }\n    ......\n    ......\n    ......\n    conn, err := p.Get()\n    if err != nil {\n        log.Fatal(err)\n    }\n    bytes, err := conn.Write(databytes)\n    if err != nil {\n        log.Fatal(err)\n    }\n    conn.Close()\n\n}\n</code></pre>\n\n<p>The main difference between tls / tcp lib (apart from the secure part) is the Dial return <code>*tls.Conn</code>\nand tcp <code>tcp.Conn</code></p>\n\n<p>So I thought I was doing well by returning *conn, I return the object pointed by the pointer.</p>\n\n<p>I always end up open by this error when I start the second connection:</p>\n\n<blockquote>\n  <p>journald-gateway_1  | 2016/12/13 16:19:20 socat[15] E write(6, 0x55fc5a73db80, 1006): Broken pipe</p>\n</blockquote>\n\n<p>Any Idea?</p>\n\n<p>Thank you for reading me.</p>\n"}, {"tags": ["go", "rabbitmq"], "answers": [{"tags": [], "owner": {"reputation": 95, "user_id": 4271535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4de3be5b5f99e349cd9b7c60002e9fef?s=128&d=identicon&r=PG&f=1", "display_name": "tleif", "link": "https://stackoverflow.com/users/4271535/tleif"}, "is_accepted": false, "score": 0, "last_activity_date": 1489505352, "creation_date": 1489505352, "answer_id": 42790126, "question_id": 41140907, "link": "https://stackoverflow.com/questions/41140907/timeout-rabbitmq-in-golang-comsumer-side/42790126#42790126", "title": "Timeout rabbitmq in golang comsumer side", "body": "<p>If I understand your question correctly, you want to be able to exit out of a routine processings a queue?</p>\n\n<p>The timeout setting won't work here. That's for server/client heartbeats and only kicks in if a heartbeat isn't received in whatever time, but won't do anything for not receiving a frame on the queue.</p>\n\n<p>What I would suggest is something like</p>\n\n<pre><code>import \"sync\"\nimport \"os/signal\"\n\nvar (\n  wg sync.WaitGroup\n  sigs = make(chan os.Signal, 1)\n  stop = make(chan bool)\n)\n\nfunc main () {\n\n  signal.Notify(sigs, syscall.SIGINT, syscall.SIGTERM, syscall.SIGQUIT)\n\n  //your other setup stuff\n\n  wg.Add(2)\n  go myQueueProcessor()\n  go mySignalProcessor()\n\n  //Now your main will wait for your goroutines to finish here.\n  wg.Wait()\n\n  //your program cleanup stuff\n}\n\nfunc myQueueProcessor() {\n   defer wg.Done()\n  //keep running over the select indefinitely\n  for {\n    select {\n      case &lt;-stop: //if the stop channel is closed exit out of go routine\n        return\n      case msg := &lt;-sub.C:  //Whatever queue processes you want\n         //do message stuff\n    }\n  }\n}\n\nfunc mySignalProcessor() {\n  defer wg.Done()\n  select {\n    case sig := &lt;-sigs:\n      close(stop)\n      return\n  }\n}\n</code></pre>\n\n<p>Now if you send your program a kill signal, it will catch it, close the the stop channel and your queue processing goroutine will exit out and things should shutdown cleanly.</p>\n"}], "owner": {"reputation": 51, "user_id": 7219322, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/acd61f4c20b57cdbd2b3c7ea846ce574?s=128&d=identicon&r=PG&f=1", "display_name": "rum", "link": "https://stackoverflow.com/users/7219322/rum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 730, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489505352, "creation_date": 1481713121, "question_id": 41140907, "link": "https://stackoverflow.com/questions/41140907/timeout-rabbitmq-in-golang-comsumer-side", "title": "Timeout rabbitmq in golang comsumer side", "body": "<p>I am using rabbitmq and golang, I make a thread for wait message in comsumer side like rabbitmq example. I want to main thread will wait kill signal and send signal to rabbitmq thread, but if message not push in queue, rabbitmq thread wait forever so it not handle kill signal message. \nI found rabbitmq have timeout in comsumer, but I have just found code in java, not golang.\nCan you help me? Thank you.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1481711064, "last_edit_date": 1481711064, "creation_date": 1481709394, "answer_id": 41139608, "question_id": 41139447, "link": "https://stackoverflow.com/questions/41139447/is-it-okay-to-panic-inside-defer-function-especially-when-its-already-panickin/41139608#41139608", "title": "Is it okay to panic inside defer function, especially when it&#39;s already panicking?", "body": "<p>Yes, it's okay. Panicking from a deferred function is not really a new, special state, it just means that the panicking sequence will not stop. </p>\n\n<p>Your example code also proves that it's okay, and even a <a href=\"https://golang.org/pkg/builtin/#panic\" rel=\"noreferrer\"><code>panic()</code></a> called from a deferred function can be stopped by an \"upper\" level call to <a href=\"https://golang.org/pkg/builtin/#recover\" rel=\"noreferrer\"><code>recover()</code></a>.</p>\n\n<p><a href=\"https://golang.org/ref/spec#Handling_panics\" rel=\"noreferrer\">Spec: Handling panics:</a></p>\n\n<blockquote>\n  <p>Suppose a function <code>G</code> defers a function <code>D</code> that calls <code>recover</code> and a panic occurs in a function on the same goroutine in which <code>G</code> is executing. When the running of deferred functions reaches <code>D</code>, the return value of <code>D</code>'s call to <code>recover</code> will be the value passed to the call of panic. <strong>If <code>D</code> returns normally, without starting a new panic, the panicking sequence stops.</strong> In that case, the state of functions called between <code>G</code> and the call to panic is discarded, and normal execution resumes.</p>\n</blockquote>\n\n<p>One thing to note here is that even if you call <code>panic()</code> in a deferred function, still all the other deferred functions will run. Also a <code>panic()</code> without <code>recover()</code> from a deferred function will rather \"wrap\" the existing panic and not \"overwrite\" it (although it's true that a <code>recover()</code> call will only give you back the value passed to the last <code>panic()</code> call).</p>\n\n<p>See this example:</p>\n\n<pre><code>func main() {\n    defer func() {\n        fmt.Println(\"Checkpoint 1\")\n        panic(1)\n    }()\n    defer func() {\n        fmt.Println(\"Checkpoint 2\")\n        panic(2)\n    }()\n    panic(999)\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/Eq5sdpNkDl\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Checkpoint 2\nCheckpoint 1\npanic: 999\n    panic: 2\n    panic: 1\n\ngoroutine 1 [running]:\npanic(0xfed00, 0x1040e140)\n    /usr/local/go/src/runtime/panic.go:500 +0x720\nmain.main.func1()\n    /tmp/sandbox284410661/main.go:8 +0x120\npanic(0xfed00, 0x1040e0fc)\n    /usr/local/go/src/runtime/panic.go:458 +0x8a0\nmain.main.func2()\n    /tmp/sandbox284410661/main.go:12 +0x120\npanic(0xfed00, 0x1040e0f8)\n    /usr/local/go/src/runtime/panic.go:458 +0x8a0\nmain.main()\n    /tmp/sandbox284410661/main.go:14 +0xc0\n</code></pre>\n\n<p>Even though all deferred functions call <code>panic()</code>, all deferred functions get executed, and the final panic sequence printed contains values passed to all <code>panic()</code> calls.</p>\n\n<p>If you call <code>recover()</code> in the deferred functions, you also get this \"recovered\" state or info in the final printout:</p>\n\n<pre><code>defer func() {\n    recover()\n    fmt.Println(\"Checkpoint 1\")\n    panic(1)\n}()\ndefer func() {\n    recover()\n    fmt.Println(\"Checkpoint 2\")\n    panic(2)\n}()\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/r24bJOKJk3\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Checkpoint 2\nCheckpoint 1\npanic: 999 [recovered]\n    panic: 2 [recovered]\n    panic: 1\n...\n</code></pre>\n"}], "owner": {"reputation": 4764, "user_id": 2419922, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/41e095cca8abbfde0f1f52d73a1efcd7?s=128&d=identicon&r=PG", "display_name": "cshu", "link": "https://stackoverflow.com/users/2419922/cshu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1850, "favorite_count": 1, "accepted_answer_id": 41139608, "answer_count": 1, "score": 6, "last_activity_date": 1502370874, "creation_date": 1481708957, "last_edit_date": 1502370874, "question_id": 41139447, "link": "https://stackoverflow.com/questions/41139447/is-it-okay-to-panic-inside-defer-function-especially-when-its-already-panickin", "title": "Is it okay to panic inside defer function, especially when it&#39;s already panicking?", "body": "<pre><code>func sub(){\n    defer func (){\n        panic(2)\n    }()\n    panic(1)\n}\n\nfunc main(){\n    defer func(){\n        x:=recover()\n        println(x.(int));\n    }()\n    sub()\n}\n</code></pre>\n\n<p>I tried this code and it seems the first panic <code>panic(1)</code> is simply \"overwritten\" by the second panic <code>panic(2)</code>.</p>\n\n<p>But is it okay to do that? Or call a Golang function that might panic inside defer function?</p>\n\n<p>(In C++ it's almost never acceptable to throw exception out of a destructor. It terminates program if stack is already unwinding. I wonder if panicking in a similar manner could be bad in Golang.)</p>\n"}, {"tags": ["regex", "go"], "answers": [{"comments": [{"owner": {"reputation": 4007, "user_id": 616398, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/83e5ba145326da0edcc404bfff584df5?s=128&d=identicon&r=PG", "display_name": "Gerben Jacobs", "link": "https://stackoverflow.com/users/616398/gerben-jacobs"}, "edited": false, "score": 0, "creation_date": 1481715725, "post_id": 41138934, "comment_id": 69485918, "body": "Ahh, I see what you mean. Replace double dashes with dash, replace edge-dashes with nothing! Also good point about the greedy modifier!"}], "tags": [], "owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 3, "last_activity_date": 1481707471, "creation_date": 1481707471, "answer_id": 41138934, "question_id": 41138630, "link": "https://stackoverflow.com/questions/41138630/removing-excessive-dashes-with-or-regex/41138934#41138934", "title": "Removing excessive dashes with OR regex", "body": "<p>You need to remove the leading/trailing <code>-</code> symbols, and shrink those inside the string. You need to split the dashes regex into</p>\n\n<pre><code>StateFileRegexDashes = regexp.MustCompile(`--+`)\nStateFileRegexDashesRemove = regexp.MustCompile(`^-+|-+$`)\n</code></pre>\n\n<p>And then use something like</p>\n\n<pre><code>func hashBotStateFile(name string) string {\n    lower := strings.ToLower(name)\n    dashes := StateFileRegex.ReplaceAllString(lower, StateFileCharReplacer)\n    trimmed := StateFileRegexDashes.ReplaceAllString(dashes, StateFileCharReplacer)\n    final := StateFileRegexDashesRemove.ReplaceAllString(trimmed, \"\")\n    return filepath.Join(StateFileFolder, fmt.Sprintf(\"%s.json\", final))\n}\n</code></pre>\n\n<p>See the <a href=\"https://play.golang.org/p/sVJWXqOzdw\" rel=\"nofollow noreferrer\">Go demo</a></p>\n\n<p>Also, note that <code>--+?</code> at the end of the pattern will always match only 2 hyphens, you need to turn the lazy quantifiers into <em>greedy</em> ones.</p>\n"}], "owner": {"reputation": 4007, "user_id": 616398, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/83e5ba145326da0edcc404bfff584df5?s=128&d=identicon&r=PG", "display_name": "Gerben Jacobs", "link": "https://stackoverflow.com/users/616398/gerben-jacobs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 0, "accepted_answer_id": 41138934, "answer_count": 1, "score": 2, "last_activity_date": 1481716014, "creation_date": 1481706517, "last_edit_date": 1481716014, "question_id": 41138630, "link": "https://stackoverflow.com/questions/41138630/removing-excessive-dashes-with-or-regex", "title": "Removing excessive dashes with OR regex", "body": "<p>I'm trying to remove all excessive dashes from strings.</p>\n\n<p><code>StateFileRegexDashes = regexp.MustCompile(</code>--+?|^-+?|-+$<code>)</code></p>\n\n<p>The above regex seems to work for me on regex101, but not within my code.\nI was thinking it could be because of the 'g|global modifier', but I assume that is solved by the 'All' part in <code>ReplaceAllString()</code></p>\n\n<p>Golang Playground: <a href=\"https://play.golang.org/p/ZR72gZEhZ_\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ZR72gZEhZ_</a><br>\nRegex101: <a href=\"https://regex101.com/r/tUYHo1/1\" rel=\"nofollow noreferrer\">https://regex101.com/r/tUYHo1/1</a></p>\n\n<p><strong>Edit</strong>:<br>\nProblem was I was replacing everything with - dashes, where I actually wanted to remove prefixed and trailing dashes.</p>\n\n<p>Instead of doing another regex, I'm just using <code>strings.Trim()</code> now.</p>\n\n<pre><code>var (\n    StateFileRegex       = regexp.MustCompile(`[\\/\\?&lt;&gt;\\\\:\\*\\|\":!\\s.]`)\n    StateFileRegexDashes = regexp.MustCompile(`--+`)\n)\n\nfunc hashBotStateFile(name string) string {\n    lower := strings.ToLower(name)\n    dashes := StateFileRegex.ReplaceAllString(lower, StateFileCharReplacer)\n    singles := StateFileRegexDashes.ReplaceAllString(dashes, StateFileCharReplacer)\n    trimmed := strings.Trim(singles, \"-\")\n    return filepath.Join(StateFileFolder, fmt.Sprintf(\"%s.json\", trimmed))\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1481699288, "post_id": 41136004, "comment_id": 69476656, "body": "Embedding is <b>not</b> inheritance. Thinking about parent/child or super/subclass relationships is not helpful at all. Stop that. <code>b.say()</code> is <i>nothing</i> but a shorthand notation for <code>b.A.say()</code>: The method <code>say</code> is always invoked on an <code>A</code>. What you try to do is impossible."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7294822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c88c4dc956983776702844307086dc7d?s=128&d=identicon&r=PG&f=1", "display_name": "yansen", "link": "https://stackoverflow.com/users/7294822/yansen"}, "edited": false, "score": 2, "creation_date": 1481706115, "post_id": 41136825, "comment_id": 69480094, "body": "Thx, i need to change my way of thinking"}], "tags": [], "owner": {"reputation": 7745, "user_id": 3926995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2l63X.jpg?s=128&g=1", "display_name": "Chiheb Nexus", "link": "https://stackoverflow.com/users/3926995/chiheb-nexus"}, "is_accepted": true, "score": 2, "last_activity_date": 1481721026, "last_edit_date": 1481721026, "creation_date": 1481699628, "answer_id": 41136825, "question_id": 41136004, "link": "https://stackoverflow.com/questions/41136004/how-to-get-childs-type-in-golang/41136825#41136825", "title": "How to get child&#39;s type in golang", "body": "<p>You got always the A value because you have only one <code>say()</code> method which point to A struct. </p>\n\n<p>So, when you apply the <code>say()</code> method to B struct, the compiler will look at B struct and its fileds in order to find if there is a <code>say()</code> method of B struct or there is any field of B struct who have a <code>say()</code> method.</p>\n\n<p>In your case, B struct doesn't have any method which will point to it. But it have a field which cointain A struct and which have a <code>say()</code> method.</p>\n\n<p>So, everytime you'll call the <code>say()</code> method within B struct, you'll call <code>B.A.say()</code> which will print the A value.</p>\n\n<p>Otherwise, if you want to print B and A values, you can modify your code to something like this example:</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype A struct {\n    foo string\n}\n// This method will point to A struct\nfunc (a *A) say() {\n    fmt.Println(reflect.ValueOf(a).Type().String())\n}\n\ntype B struct {\n    A\n}\n// This method will point to B struct\nfunc (a *B) say() {\n    fmt.Println(reflect.ValueOf(a).Type().String())\n}\n\nfunc main() {\n    b := new(B)\n    b.say()     // expected output: *main.B\n    b.A.say()   // expected output: *main.A\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>*main.B\n*main.A\n</code></pre>\n\n<p>You can also run this code with <a href=\"https://play.golang.org/p/iHagZljRWz\" rel=\"nofollow noreferrer\">Go Playground</a></p>\n"}], "owner": {"reputation": 13, "user_id": 7294822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c88c4dc956983776702844307086dc7d?s=128&d=identicon&r=PG&f=1", "display_name": "yansen", "link": "https://stackoverflow.com/users/7294822/yansen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 724, "favorite_count": 0, "accepted_answer_id": 41136825, "answer_count": 1, "score": 0, "last_activity_date": 1481721026, "creation_date": 1481696240, "last_edit_date": 1481701423, "question_id": 41136004, "link": "https://stackoverflow.com/questions/41136004/how-to-get-childs-type-in-golang", "title": "How to get child&#39;s type in golang", "body": "<p>I've been studying <code>Go</code> recently.\nIn the under sample, I got the type a, not b. Why?\nAnd how do I get b?</p>\n\n<pre><code>// parent\ntype A struct {\n    foo string\n}\n\nfunc (a *A) say() {\n    // I want b here, not a\n    fmt.Println(reflect.ValueOf(a).Type().String())\n}\n\n// child\ntype B struct {\n    A\n}\n\nfunc main() {\n    b := new(B)\n    b.say()\n}\n</code></pre>\n"}, {"tags": ["ajax", "http", "templates", "go", "server"], "comments": [{"owner": {"reputation": 147, "user_id": 5728873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/R37ba.jpg?s=128&g=1", "display_name": "Dheeraj Sarwaiya", "link": "https://stackoverflow.com/users/5728873/dheeraj-sarwaiya"}, "edited": false, "score": 0, "creation_date": 1481700896, "post_id": 41136000, "comment_id": 69477412, "body": "why negative vote, if you think question is not good, give feedback. This is a road block for me, looking for ideas here."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1481708382, "post_id": 41136000, "comment_id": 69481437, "body": "I guess downvotes come from you showing little research or effort trying to solve the problem. Also your question as it is is too broad, but this is a quite common and handy feature to have for a webapp, so I&#39;ll answer it anyway."}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 5728873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/R37ba.jpg?s=128&g=1", "display_name": "Dheeraj Sarwaiya", "link": "https://stackoverflow.com/users/5728873/dheeraj-sarwaiya"}, "edited": false, "score": 0, "creation_date": 1481742014, "post_id": 41138344, "comment_id": 69502566, "body": "It worked.. Thanks. I didn&#39;t know about block and somehow I missed that in your last post as well.. This is great. Thank you very much for your help."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 147, "user_id": 5728873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/R37ba.jpg?s=128&g=1", "display_name": "Dheeraj Sarwaiya", "link": "https://stackoverflow.com/users/5728873/dheeraj-sarwaiya"}, "edited": false, "score": 0, "creation_date": 1481787400, "post_id": 41138344, "comment_id": 69518608, "body": "@DheerajSarwaiya Note that <code>{{block}}</code> is not a requirement, you can do this wtihout using <code>{{block}}</code>. It is simply a shorthand for a <code>{{define}}</code> followed by a <code>{{template}}</code>."}, {"owner": {"reputation": 147, "user_id": 5728873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/R37ba.jpg?s=128&g=1", "display_name": "Dheeraj Sarwaiya", "link": "https://stackoverflow.com/users/5728873/dheeraj-sarwaiya"}, "edited": false, "score": 0, "creation_date": 1481820780, "post_id": 41138344, "comment_id": 69539118, "body": "Thanks for your help. I am facing one problem with this approach. js doesnt work if I use block or template. I am using js script to display images from URLs receiving from data store. I realized that even simple &lt;script&gt;alert(&quot;hello&quot;);&lt;/script&gt; does not work when you press load more. Any suggestion for this?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 147, "user_id": 5728873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/R37ba.jpg?s=128&g=1", "display_name": "Dheeraj Sarwaiya", "link": "https://stackoverflow.com/users/5728873/dheeraj-sarwaiya"}, "edited": false, "score": 2, "creation_date": 1481821332, "post_id": 41138344, "comment_id": 69539432, "body": "@DheerajSarwaiya Most likely the text you try to insert in the template gets auto-escaped by the <code>html&#47;template</code> package. Check out this answer: <a href=\"http://stackoverflow.com/questions/34348072/golang-web-html-comments-are-not-rendered/34351058#34351058\">Golang Web - HTML Comments are not rendered</a>; and this: <a href=\"http://stackoverflow.com/questions/36980049/avoid-auto-escape-in-html-template/36980336#36980336\">avoid auto escape in html template</a>. If those don&#39;t help, I suggest to post a new question with more details."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 8, "last_activity_date": 1481729610, "last_edit_date": 1592644375, "creation_date": 1481705631, "answer_id": 41138344, "question_id": 41136000, "link": "https://stackoverflow.com/questions/41136000/creating-load-more-button-in-golang-with-templates/41138344#41138344", "title": "Creating load more button in Golang with templates", "body": "<p>My other answer you linked in your question contains all the details and tricks you need to implement the <em>&quot;Load more...&quot;</em> functionality: <a href=\"https://stackoverflow.com/questions/37118281/dynamically-refresh-a-part-of-the-template-when-a-variable-is-updated-golang/37119014#37119014\">Dynamically refresh a part of the template when a variable is updated golang</a></p>\n<p>Yes, it's not trivial, but it's not that hard / complex either. That answer discusses different ways / alternatives, but obviously a solution only needs one.</p>\n<p>Here I show a working solution. The <kbd>Load more</kbd> button here will  not &quot;remember&quot; what were the last posts returned, it will just retrieve 2 new posts. Think about how you could implement sending back the last ID, and when more is requested, send records following that.</p>\n<p>The complete, runnable application code can be found here on the <a href=\"https://play.golang.org/p/_u8ZbSzRl2\" rel=\"noreferrer\">Go Playground</a>. Of course you can't run it on the Go Playground, save it locally and run it on your computer.</p>\n<p>So, we'll work with the following <code>Post</code> entities:</p>\n<pre><code>type Post struct {\n    User, Time, Text string\n}\n</code></pre>\n<p>I'm gonna use the following template:</p>\n<pre><code>&lt;html&gt;&lt;body&gt;&lt;h2&gt;Posts&lt;/h2&gt;\n{{block &quot;batch&quot; .}}\n    {{range .posts}}\n        &lt;div&gt;&lt;b&gt;{{.Time}} {{.User}}:&lt;/b&gt; {{.Text}}&lt;/div&gt;\n    {{end}}\n    &lt;div id=&quot;nextBatch&quot;&gt;&lt;/div&gt;\n{{end}}\n&lt;button onclick=&quot;loadMore()&quot;&gt;Load more&lt;/button&gt;\n&lt;script&gt;\n    function loadMore() {\n        var e = document.getElementById(&quot;nextBatch&quot;);\n        var xhr = new XMLHttpRequest();\n        xhr.onreadystatechange = function() {\n            if (xhr.readyState == 4 &amp;&amp; xhr.status == 200) {\n                e.outerHTML = xhr.responseText;\n            }\n        }\n        xhr.open(&quot;GET&quot;, &quot;/posts/more&quot;, true);\n        try { xhr.send(); } catch (err) { /* handle error */ }\n    }\n&lt;/script&gt;\n&lt;/body&gt;&lt;/html&gt;\n</code></pre>\n<p>It contains a <code>{{block &quot;batch&quot; .}}</code> block for listing posts, and also renders a placeholder for the next batch (<code>&lt;div id=&quot;nextBatch&quot;&gt;</code>). Next it contains a <kbd>Load More</kbd> button, which when pressed, fetches the next batch in a rendered form, and replaces the placeholder. The rendered next batch also contains the placeholder for the next batch.</p>\n<p>The javascript function for making an AJAX call is detailed in my linked another answer.</p>\n<p>The handler that executes this template:</p>\n<pre><code>var t = template.Must(template.New(&quot;&quot;).Parse(page))\n\nvar lastTime = time.Now()\n\nfunc produceTime() string {\n    lastTime = lastTime.Add(time.Second)\n    return lastTime.Format(&quot;15:04:05&quot;)\n}\n\nfunc postsHandler(w http.ResponseWriter, r *http.Request) {\n    // Put up some random data for demonstration:\n    data := map[string]interface{}{&quot;posts&quot;: []Post{\n        {User: &quot;Bob&quot;, Time: produceTime(), Text: &quot;The weather is nice.&quot;},\n        {User: &quot;Alice&quot;, Time: produceTime(), Text: &quot;It's raining.&quot;},\n    }}\n    var err error\n    switch r.URL.Path {\n    case &quot;/posts/&quot;:\n        err = t.Execute(w, data)\n    case &quot;/posts/more&quot;:\n        err = t.ExecuteTemplate(w, &quot;batch&quot;, data)\n    }\n    if err != nil {\n        log.Printf(&quot;Template execution error: %v&quot;, err)\n    }\n}\n</code></pre>\n<p><code>produceTime()</code> just produces monotonic increasing timestamp strings, so the output will look like something sensible.</p>\n<p>And the <code>main()</code> function to register the handler and start the server:</p>\n<pre><code>func main() {\n    http.HandleFunc(&quot;/posts/&quot;, postsHandler)\n    panic(http.ListenAndServe(&quot;:8080&quot;, nil))\n}\n</code></pre>\n<p>And that's about it. It's a working application. Entering <code>http://localhost:8080/posts/</code> in a browser, you'll see:</p>\n<blockquote>\n<h2>Posts</h2>\n<p><strong>09:42:29 Bob:</strong> The weather is nice.<br />\n<strong>09:42:30 Alice:</strong> It's raining.<br />\n<kbd>Load more</kbd></p>\n</blockquote>\n<p>Pressing the <kbd>Load more</kbd> button, the content in the browser will be refreshed dynamically, without page reload. The new content:</p>\n<blockquote>\n<h2>Posts</h2>\n<p><strong>09:42:29 Bob:</strong> The weather is nice.<br />\n<strong>09:42:30 Alice:</strong> It's raining.<br />\n<strong>09:42:31 Bob:</strong> The weather is nice.<br />\n<strong>09:42:32 Alice:</strong> It's raining.<br />\n<kbd>Load more</kbd></p>\n</blockquote>\n<p>Pressing it again:</p>\n<blockquote>\n<h2>Posts</h2>\n<p><strong>09:42:29 Bob:</strong> The weather is nice.<br />\n<strong>09:42:30 Alice:</strong> It's raining.<br />\n<strong>09:42:31 Bob:</strong> The weather is nice.<br />\n<strong>09:42:32 Alice:</strong> It's raining.<br />\n<strong>09:42:33 Bob:</strong> The weather is nice.<br />\n<strong>09:42:34 Alice:</strong> It's raining.<br />\n<kbd>Load more</kbd></p>\n</blockquote>\n"}], "owner": {"reputation": 147, "user_id": 5728873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/R37ba.jpg?s=128&g=1", "display_name": "Dheeraj Sarwaiya", "link": "https://stackoverflow.com/users/5728873/dheeraj-sarwaiya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3430, "favorite_count": 2, "accepted_answer_id": 41138344, "answer_count": 1, "score": 0, "last_activity_date": 1481729610, "creation_date": 1481696224, "last_edit_date": 1495541375, "question_id": 41136000, "link": "https://stackoverflow.com/questions/41136000/creating-load-more-button-in-golang-with-templates", "title": "Creating load more button in Golang with templates", "body": "<p>I want to create a Facebook-like page where in if user scroll down the page fetch old post without refreshing. I have done this earlier using Ajax and appending the HTML page using JS.</p>\n\n<p>However, since I am now using Go and its template to build the page, I am not sure how to achieve the similar results. Kindly help me with your suggestion.</p>\n\n<pre><code>{{range .posts}}\n &lt;&lt;in side the range brackets, I am showing the posts &gt;&gt;\n{{end}}\nout side range I have created load more button which calls \nthe js which internally fetch the posts slice.\n</code></pre>\n\n<p>The link below shows one solution but it will not work for high volume data, creating all those buttons in js will be difficult. \n<a href=\"https://stackoverflow.com/questions/37118281/dynamically-refresh-a-part-of-the-template-when-a-variable-is-updated-golang\">Dynamically refresh a part of the template when a variable is updated golang</a> </p>\n\n<p>Thanks for help. :)</p>\n"}, {"tags": ["json", "go", "file-read"], "answers": [{"tags": [], "owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "is_accepted": true, "score": 40, "last_activity_date": 1481699697, "last_edit_date": 1481699697, "creation_date": 1481698892, "answer_id": 41136623, "question_id": 41135686, "link": "https://stackoverflow.com/questions/41135686/how-can-we-read-a-json-file-as-json-object-in-golang/41136623#41136623", "title": "How can we read a json file as json object in golang", "body": "<p>The value to be populated by <code>json.Unmarshal</code> needs to be a pointer. </p>\n\n<p>From <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"noreferrer\">GoDoc</a> :</p>\n\n<blockquote>\n  <p>Unmarshal parses the JSON-encoded data and stores the result in the value <strong>pointed</strong> to by v.</p>\n</blockquote>\n\n<p>So you need to do the following : </p>\n\n<pre><code>plan, _ := ioutil.ReadFile(filename)\nvar data interface{}\nerr := json.Unmarshal(plan, &amp;data)\n</code></pre>\n\n<p>Your error (Unmarshal(nil)) indicates that there was some problem in reading the file , please check the error returned by <code>ioutil.ReadFile</code></p>\n\n<hr>\n\n<p>Also please note that when using an empty interface in unmarshal, you would need to use <a href=\"https://tour.golang.org/methods/15\" rel=\"noreferrer\">type assertion</a> to get the underlying values as go primitive types.</p>\n\n<blockquote>\n  <p>To unmarshal JSON into an interface value, Unmarshal stores one of\n  these in the interface value:</p>\n\n<pre><code>bool, for JSON booleans\nfloat64, for JSON numbers\nstring, for JSON strings\n[]interface{}, for JSON arrays\nmap[string]interface{}, for JSON objects\nnil for JSON null\n</code></pre>\n</blockquote>\n\n<p>It is always a much better approach to use a concrete structure to populate your json using <code>Unmarshal</code>.</p>\n"}], "owner": {"reputation": 263, "user_id": 7184004, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7fe4abb3ae5ee09e1f63d04d549746c3?s=128&d=identicon&r=PG&f=1", "display_name": "Aishwarya", "link": "https://stackoverflow.com/users/7184004/aishwarya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30098, "favorite_count": 3, "accepted_answer_id": 41136623, "answer_count": 1, "score": 23, "last_activity_date": 1481699697, "creation_date": 1481694496, "last_edit_date": 1481696328, "question_id": 41135686, "link": "https://stackoverflow.com/questions/41135686/how-can-we-read-a-json-file-as-json-object-in-golang", "title": "How can we read a json file as json object in golang", "body": "<p>I have a JSON file stored on the local machine. I need to read it in a variable and loop through it to fetch the JSON object values. If I use the Marshal command after reading the file using the ioutil.Readfile method, it gives some numbers as an output. These are my few failed attempts,</p>\n\n<p>Attempt 1: </p>\n\n<pre><code>plan, _ := ioutil.ReadFile(filename) // filename is the JSON file to read\nvar data interface{}\nerr := json.Unmarshal(plan, data)\nif err != nil {\n        log.Error(\"Cannot unmarshal the json \", err)\n      }\nfmt.Println(data)\n</code></pre>\n\n<p>It gave me following error,</p>\n\n<pre><code>time=\"2016-12-13T22:13:05-08:00\" level=error msg=\"Cannot unmarshal the json json: Unmarshal(nil)\"\n&lt;nil&gt;\n</code></pre>\n\n<p>Attempt 2: I tried to store the JSON values in a struct and then using MarshalIndent</p>\n\n<pre><code>generatePlan, _ := json.MarshalIndent(plan, \"\", \" \") // plan is a pointer to a struct\nfmt.Println(string(generatePlan))\n</code></pre>\n\n<p>It give me the output as string. But if I cast the output to string then I won't be able to loop it as JSON object.</p>\n\n<p>How can we read a JSON file as JSON object in golang?  Is it possible to do that?\nAny help is appreciated. Thanks in advance!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "edited": false, "score": 1, "creation_date": 1481684235, "post_id": 41133886, "comment_id": 69472122, "body": "There is no &#39;os.Name&#39; in the os package. What you need is to use get a <code>FileInfo</code> using <code>f.Stat()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 496, "user_id": 576372, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3c3256ae98b2d42cf1907384147365c1?s=128&d=identicon&r=PG", "display_name": "jkulak", "link": "https://stackoverflow.com/users/576372/jkulak"}, "edited": false, "score": 0, "creation_date": 1481686629, "post_id": 41134114, "comment_id": 69472753, "body": "Obviously... \ud83d\ude44 I was trying that and I guess, some other error caught me off guard. Thanks, works."}], "tags": [], "owner": {"reputation": 905, "user_id": 3781709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd4fa60c6b287ee4f006d6c4e320daf5?s=128&d=identicon&r=PG", "display_name": "Pradip Patil", "link": "https://stackoverflow.com/users/3781709/pradip-patil"}, "is_accepted": true, "score": 2, "last_activity_date": 1481684329, "creation_date": 1481684329, "answer_id": 41134114, "question_id": 41133886, "link": "https://stackoverflow.com/questions/41133886/how-can-i-use-os-name-in-go/41134114#41134114", "title": "How can I use os.Name() in go?", "body": "<p>Because <code>Name</code> is a special function (<code>method</code>) defined on <code>File</code> struct. Means it takes <code>File</code> type as receiver and can be called using receiver instance (in your case <code>f</code>).</p>\n\n<p>This should work </p>\n\n<blockquote>\n  <p><code>name := f.Name()</code></p>\n</blockquote>\n\n<p>Read more at :</p>\n\n<p><a href=\"https://tour.golang.org/methods/1\" rel=\"nofollow noreferrer\">https://tour.golang.org/methods/1</a></p>\n\n<p><a href=\"https://gobyexample.com/methods\" rel=\"nofollow noreferrer\">https://gobyexample.com/methods</a></p>\n"}], "owner": {"reputation": 496, "user_id": 576372, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3c3256ae98b2d42cf1907384147365c1?s=128&d=identicon&r=PG", "display_name": "jkulak", "link": "https://stackoverflow.com/users/576372/jkulak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 1, "accepted_answer_id": 41134114, "answer_count": 1, "score": -1, "last_activity_date": 1481684329, "creation_date": 1481682788, "question_id": 41133886, "link": "https://stackoverflow.com/questions/41133886/how-can-i-use-os-name-in-go", "title": "How can I use os.Name() in go?", "body": "<p>I'm trying to use: <a href=\"https://golang.org/src/os/file.go?s=1472:1577#L35\" rel=\"nofollow noreferrer\">https://golang.org/src/os/file.go?s=1472:1577#L35</a></p>\n\n<p>by importing the \"os\" package and then running</p>\n\n<pre><code>f, err := os.Open(\"/tmp/dat3\")\ncheck(err)\nname := os.Name(f)\n</code></pre>\n\n<p>I get <code>./main.go:29: undefined: os.Name</code></p>\n\n<p>Why? What am I doing wrong. </p>\n\n<p>(Of course I know I <em>have</em> the name of the open file - but I'm curious why, I'm not able to call that function)</p>\n"}, {"tags": ["go", "xor"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1481685953, "post_id": 41133870, "comment_id": 69472595, "body": "each in the string is a <a href=\"https://golang.org/ref/spec#Rune_literals\" rel=\"nofollow noreferrer\">rune</a>, it&#39;s just an alias for an <b>int</b>, all you have to do is convert them to unsigned ints and do the xor operation ^"}], "answers": [{"tags": [], "owner": {"reputation": 964, "user_id": 3184079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/819c77c230e755f43bfbbbb87429c046?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/3184079/omar"}, "is_accepted": false, "score": 0, "last_activity_date": 1481686588, "creation_date": 1481686588, "answer_id": 41134467, "question_id": 41133870, "link": "https://stackoverflow.com/questions/41133870/how-to-xor-two-string-arrays-in-golang/41134467#41134467", "title": "How to XOR two string arrays in Golang?", "body": "<p>This doesn't seem like something that would go in a standard library in Go, but here's a bit of code that does the trick:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    A := []string{\"ab\", \"cd\", \"ef\", \"gh\"}\n    B := []string{\"ef\", \"gh\"}\n    fmt.Println(xor(A,B))\n}\n\nfunc xor(list1, list2 []string) []string {\n    set1 := make(map[string]bool)\n    for _, s := range list1 {\n        set1[s] = true\n    }\n    set2 := make(map[string]bool)\n    for _, s := range list2 {\n        set2[s] = true\n    }\n\n    var c []string\n    for _, s := range list1 {\n        if !set2[s] {\n          c = append(c, s)\n        }\n    }\n    for _, s := range list2 {\n        if !set1[s] {\n          c = append(c, s)\n        }\n    }\n    return c\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/SDPhNIQ66E\" rel=\"nofollow noreferrer\">https://play.golang.org/p/SDPhNIQ66E</a></p>\n"}], "owner": {"reputation": 165, "user_id": 4150729, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/1492722699/picture?type=large", "display_name": "Nik Kunkel", "link": "https://stackoverflow.com/users/4150729/nik-kunkel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2736, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1481686588, "creation_date": 1481682678, "question_id": 41133870, "link": "https://stackoverflow.com/questions/41133870/how-to-xor-two-string-arrays-in-golang", "title": "How to XOR two string arrays in Golang?", "body": "<p>Let's say I have two string array.</p>\n\n<p>A = [ \"ab\", \"cd\", \"ef\", \"gh\"]<br>\nB = [ \"ef\", \"gh\"]   </p>\n\n<p>I want to do C = A^B</p>\n\n<p>where C = [\"ab\", \"cd\"]</p>\n\n<p>I'm aware Golang allows XOR byte-wise, but I haven't seen anything for string arrays in the documentation. </p>\n\n<p>How would I go about doing this? Perhaps there is a utility someone has already made for this?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 1, "creation_date": 1481678269, "post_id": 41133244, "comment_id": 69470651, "body": "Be aware that this will overwrite any <code>MY_VAR</code> already in the environment of the current process. If this is your intent, then this solution works fine."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 1, "creation_date": 1481678949, "post_id": 41133244, "comment_id": 69470831, "body": "Otherwise, you&#39;d probably want to enclose the <code>append()</code> line inside something like <code>if _, ok := os.LookupEnv(&quot;MY_VAR&quot;); !ok { ... }</code>"}, {"owner": {"reputation": 235, "user_id": 4017439, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-v6-6SQOeGVI/AAAAAAAAAAI/AAAAAAAAABg/Scha2K5nzuM/photo.jpg?sz=128", "display_name": "Iskander Sharipov", "link": "https://stackoverflow.com/users/4017439/iskander-sharipov"}, "edited": false, "score": 1, "creation_date": 1551693259, "post_id": 41133244, "comment_id": 96719302, "body": "Personally, I would copy os.Environ slice instead of appending without deep copy. Maybe it works today, but I don&#39;t like appending to the same slice via different names."}, {"owner": {"reputation": 2041, "user_id": 1333724, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/acc5cea42dca926af89f94eb56fbbdbb?s=128&d=identicon&r=PG", "display_name": "maxm", "link": "https://stackoverflow.com/users/1333724/maxm"}, "edited": false, "score": 0, "creation_date": 1579910954, "post_id": 41133244, "comment_id": 105937125, "body": "I don&#39;t think that&#39;s true, os.Environ() returns a new slice. this should be safe"}], "tags": [], "owner": {"reputation": 1305, "user_id": 3377285, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/eaa60f6024489bcf022e818ee1ac4c41?s=128&d=identicon&r=PG&f=1", "display_name": "user18007", "link": "https://stackoverflow.com/users/3377285/user18007"}, "is_accepted": false, "score": 68, "last_activity_date": 1481678174, "creation_date": 1481678174, "answer_id": 41133244, "question_id": 41133115, "link": "https://stackoverflow.com/questions/41133115/pass-env-var-to-exec-command/41133244#41133244", "title": "pass ENV VAR to exec.Command?", "body": "<p>For those wondering for the solution:</p>\n\n<pre><code>    cmd := exec.Command(\"ansible-playbook\", args...)\n    cmd.Env = os.Environ()\n    cmd.Env = append(cmd.Env, \"MY_VAR=some_value\")\n</code></pre>\n\n<p>Will preserve the existing environment and then write the one value that you want.</p>\n\n<p>Thank goodness for godoc and open source!!</p>\n"}], "owner": {"reputation": 1305, "user_id": 3377285, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/eaa60f6024489bcf022e818ee1ac4c41?s=128&d=identicon&r=PG&f=1", "display_name": "user18007", "link": "https://stackoverflow.com/users/3377285/user18007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14714, "favorite_count": 6, "answer_count": 1, "score": 33, "last_activity_date": 1481678878, "creation_date": 1481677236, "last_edit_date": 1481677860, "question_id": 41133115, "link": "https://stackoverflow.com/questions/41133115/pass-env-var-to-exec-command", "title": "pass ENV VAR to exec.Command?", "body": "<p>I'm writing a go wrapper for a popular command line tool (ansible-playbook) and I need to pass a parameter through with the exec.Command call. The bash equivalent would be:</p>\n\n<pre><code>MY_VAR=some_value ansible-playbook -i custom-inventory playbook.yml\n</code></pre>\n\n<p>Previously I was just exporting MY_VAR using os.Setenv, but that causes problems for parallel executions of the playbook. So I want to pass the var in front of the command so that each call has it's own value for this var.</p>\n\n<p>I'm not really sure how to do this with exec.Command since the first parameter to that function is \"command\". Any tips?</p>\n\n<p>edit: I have tried using the Env field of the Cmd struct but that overrides all environment variables. I have a significant amount of configuration set and I would just like to override this one specific environment variable. Is this not possible??</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "edited": false, "score": 1, "creation_date": 1481681160, "post_id": 41133006, "comment_id": 69471381, "body": "So do you know the width of the shell or is that part of what you need to work out how to do?"}, {"owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "edited": false, "score": 0, "creation_date": 1481683983, "post_id": 41133006, "comment_id": 69472065, "body": "This can tell you the width and height:  <a href=\"http://stackoverflow.com/questions/263890/how-do-i-find-the-width-height-of-a-terminal-window\" title=\"how do i find the width height of a terminal window\">stackoverflow.com/questions/263890/&hellip;</a>"}, {"owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "reply_to_user": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "edited": false, "score": 0, "creation_date": 1481713722, "post_id": 41133006, "comment_id": 69484748, "body": "@miltonb, your link is for bash, ... can I use bash from go?"}, {"owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "edited": false, "score": 0, "creation_date": 1481744303, "post_id": 41133006, "comment_id": 69503724, "body": "Yes, you can make a call to OS using <code>os&#47;exec</code> package.  It will take some lines of code based around <code>exec.Command()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "edited": false, "score": 0, "creation_date": 1481714476, "post_id": 41133739, "comment_id": 69485171, "body": "I&#39;ve seen. But could you explain a bit &quot;%%-%ds&quot;? Doc says <code>%%\ta literal percent sign; consumes no value</code> what exactly means? <code>%d is for digit</code>."}, {"owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "reply_to_user": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "edited": false, "score": 0, "creation_date": 1481744004, "post_id": 41133739, "comment_id": 69503576, "body": "Updated with better description of the code to produce the format strings."}, {"owner": {"reputation": 3063, "user_id": 5075720, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kNyMGvaELDs/AAAAAAAAAAI/AAAAAAAAVnw/P1Rt8TFE2gc/photo.jpg?sz=128", "display_name": "PaSTE", "link": "https://stackoverflow.com/users/5075720/paste"}, "edited": false, "score": 1, "creation_date": 1513293631, "post_id": 41133739, "comment_id": 82609860, "body": "I think there&#39;s a bug in the solution code, as it does not take into account the width of the string <code>s</code>.  See the modified playground code at <a href=\"https://play.golang.org/p/8L5IfEIKSS\" rel=\"nofollow noreferrer\">play.golang.org/p/8L5IfEIKSS</a>.  I think you need to replace the first <code>w&#47;2</code> with a <code>w</code> and the second with a <code>(w + len(s))&#47;2</code>, as shown in my answer below."}], "tags": [], "owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "is_accepted": true, "score": 1, "last_activity_date": 1481743985, "last_edit_date": 1481743985, "creation_date": 1481681823, "answer_id": 41133739, "question_id": 41133006, "link": "https://stackoverflow.com/questions/41133006/how-to-fmt-printprint-this-on-the-center/41133739#41133739", "title": "How to fmt.Print(&quot;print this on the center&quot;)", "body": "<p>This code is managing to centre the text as long as the shell width is a known value.  Its not quite 'pixel perfect', but I hope it helps.</p>\n\n<p>If we break it down there are two bits of code to produce the format strings to pad right and then left.</p>\n\n<pre><code>fmt.Sprintf(\"%%-%ds\", w/2)  // produces \"%-55s\"  which is pad left string\nfmt.Sprintf(\"%%%ds\", w/2)   // produces \"%55s\"   which is right pad\n</code></pre>\n\n<p>So the final <code>Printf</code> statement becomes</p>\n\n<pre><code>fmt.Printf(\"%-55s\", fmt.Sprintf(\"%55s\", \"my string to centre\")) \n</code></pre>\n\n<p>The full code:</p>\n\n<pre><code>s := \" in the middle\"\nw := 110 // shell width\n\nfmt.Printf(fmt.Sprintf(\"%%-%ds\", w/2), fmt.Sprintf(fmt.Sprintf(\"%%%ds\", w/2),s))\n</code></pre>\n\n<p>Produces the following:</p>\n\n<blockquote>\n<pre><code>                                     in the middle\n</code></pre>\n</blockquote>\n\n<p>Link to play ground: <a href=\"https://play.golang.org/p/J3mYnzNjEf\" rel=\"nofollow noreferrer\">play</a></p>\n"}, {"comments": [{"owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "edited": false, "score": 1, "creation_date": 1513305466, "post_id": 47823574, "comment_id": 82612545, "body": "Excellent addition regarding the [n] notation, makes it simpler - which is always better."}, {"owner": {"reputation": 927, "user_id": 798372, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/383ba8f2609a21395b37850a84dc137f?s=128&d=identicon&r=PG", "display_name": "Chris Dennis", "link": "https://stackoverflow.com/users/798372/chris-dennis"}, "edited": false, "score": 0, "creation_date": 1607197681, "post_id": 47823574, "comment_id": 115198783, "body": "Good answer, but in fact it works without the <code>[1]</code>s, because in each case the width is the first argument."}], "tags": [], "owner": {"reputation": 3063, "user_id": 5075720, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kNyMGvaELDs/AAAAAAAAAAI/AAAAAAAAVnw/P1Rt8TFE2gc/photo.jpg?sz=128", "display_name": "PaSTE", "link": "https://stackoverflow.com/users/5075720/paste"}, "is_accepted": false, "score": 10, "last_activity_date": 1607206283, "last_edit_date": 1607206283, "creation_date": 1513293409, "answer_id": 47823574, "question_id": 41133006, "link": "https://stackoverflow.com/questions/41133006/how-to-fmt-printprint-this-on-the-center/47823574#47823574", "title": "How to fmt.Print(&quot;print this on the center&quot;)", "body": "<p>As an update to this long-answered question, the solution posted by @miltonb can be improved upon by using the <code>*</code> notation from the <code>fmt</code> package.  From <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\">the package documentation</a>:</p>\n<blockquote>\n<p>In Printf, Sprintf, and Fprintf, the default behavior is for each\nformatting verb to format successive arguments passed in the call.\nHowever, the notation [n] immediately before the verb indicates that\nthe nth one-indexed argument is to be formatted instead. <strong>The same\nnotation before a '*' for a width or precision selects the argument\nindex holding the value.</strong> After processing a bracketed expression [n],\nsubsequent verbs will use arguments n+1, n+2, etc. unless otherwise\ndirected.</p>\n</blockquote>\n<p>So you can replace two of the <code>fmt.Sprintf</code> calls with a more concise format statement to achieve the same result:</p>\n<pre><code>s := &quot;in the middle&quot;\nw := 110 // or whatever\n\nfmt.Sprintf(&quot;%[1]*s&quot;, -w, fmt.Sprintf(&quot;%[1]*s&quot;, (w + len(s))/2, s))\n</code></pre>\n<p><a href=\"https://play.golang.org/p/pxnJjZe6Bw\" rel=\"nofollow noreferrer\">See the code in action</a>.</p>\n<p>Additionally, as @chris-dennis mentioned, the <code>[1]</code> notation is superfluous in this example because the width of the string is already the first argument. This works as well:</p>\n<pre><code>fmt.Sprintf(&quot;%*s&quot;, -w, fmt.Sprintf(&quot;%*s&quot;, (w + len(s))/2, s))\n</code></pre>\n<p><a href=\"https://play.golang.org/p/NAY601_5JxX\" rel=\"nofollow noreferrer\">See this example in action</a>.</p>\n"}], "owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3272, "favorite_count": 0, "accepted_answer_id": 41133739, "answer_count": 2, "score": 5, "last_activity_date": 1607206283, "creation_date": 1481676353, "question_id": 41133006, "link": "https://stackoverflow.com/questions/41133006/how-to-fmt-printprint-this-on-the-center", "title": "How to fmt.Print(&quot;print this on the center&quot;)", "body": "<p>Is possible, with <code>fmt.Println(\"...\")</code> to print a string with center alignement of the shell?</p>\n"}, {"tags": ["go", "channel"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481665727, "post_id": 41131115, "comment_id": 69466527, "body": "why not check for <code>nil</code> and replace it with a dummy value?"}, {"owner": {"reputation": 6626, "user_id": 886749, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d8206b3ff36c7985108359f97562a9a4?s=128&d=identicon&r=PG", "display_name": "Cory Kendall", "link": "https://stackoverflow.com/users/886749/cory-kendall"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481666076, "post_id": 41131115, "comment_id": 69466720, "body": "@JimB Is your dummy value <code>make (chan bool, x)</code> where x is the number of times I&#39;m going to write to it?  Can I avoid allocating memory/GC-ing away the things I write there later?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481666345, "post_id": 41131115, "comment_id": 69466841, "body": "A channel used for a signal is usually just closed once. If the values are really useful, then yes, you either need to consume them or buffer them. If the values are just sentinels, you should be using a <code>sync.WaitGroup</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481667102, "post_id": 41131115, "comment_id": 69467180, "body": "It might be worth noting that it is also very common to provide a channel called &quot;done&quot; which is only closed to signal completion. Using a &quot;done&quot; channel to return values is going to be unexpected by most Go programmers."}], "answers": [{"tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": false, "score": 4, "last_activity_date": 1481666620, "last_edit_date": 1481666620, "creation_date": 1481666250, "answer_id": 41131270, "question_id": 41131115, "link": "https://stackoverflow.com/questions/41131115/garbage-channel-in-golang/41131270#41131270", "title": "Garbage channel in Golang?", "body": "<p>You can use a select on the send to avoid blocking:</p>\n\n<pre><code>select {\ncase done &lt;- true:\ndefault:\n}\n</code></pre>\n\n<p>The other alternative, and my preferred one, is to <em>not send things over done channels</em>.  Instead, <em>close</em> the channel.  This causes all blocked receive operations to instantly return, all at the same time (instead of having to send each one a value), <em>and</em> prevents blocking in the function sending the quit signal if nothing is listening.  This also lets you replace the channel with a <code>chan struct{}</code>, which is nice, because a <code>struct{}</code> has 0 size.</p>\n\n<p>Still, worth noting that closing a nil channel, instead of blocking, panics, so you still have to do a nil check on it.</p>\n\n<p>Edit: my preferred style on this:</p>\n\n<pre><code>func myFunc(foo int, done chan&lt;- struct{}) {\n    if done != nil {\n        defer close(done)\n    }\n    ....\n}\n</code></pre>\n\n<p>Edit 2: You could even make it a variadic, which allows the done channel to be omitted, <em>or</em> more than one to be provided.</p>\n\n<pre><code>func myFunc(foo int, done ...chan&lt;- struct{}) {\n    for _, d := range done {\n        if d != nil {\n            defer close(d)\n        }\n    }\n    ....\n}\n----\nmyFunc(1)\nmyFunc(2, ch1)\nmyFunc(3, ch2, ch3, ch4)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 898632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/367707ac13ca23f6968cea31565efaa9?s=128&d=identicon&r=PG", "display_name": "adamski", "link": "https://stackoverflow.com/users/898632/adamski"}, "is_accepted": false, "score": 0, "last_activity_date": 1490794524, "creation_date": 1490794524, "answer_id": 43095093, "question_id": 41131115, "link": "https://stackoverflow.com/questions/41131115/garbage-channel-in-golang/43095093#43095093", "title": "Garbage channel in Golang?", "body": "<p>How about this:</p>\n\n<pre><code>func DoAllTheThings(done ...chan&lt;- bool) {\n\n    // do the things\n\n    // all done!\n    if len(done) &gt;= 1 {\n        done[0] &lt;- true\n    }\n    return\n}\n</code></pre>\n\n<p>If no channel is given in arguments, then nothing is sent. It would be up to the caller to set up a listener for the channel, obviously. Then you could call it as:</p>\n\n<pre><code>func main() {\n    DoAllTheThings()\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>func main() {\n    ch := make(chan bool)\n    go func() {\n        done := &lt;- ch\n        if done {\n            fmt.Println(\"Yay!\")\n        }\n    }()\n    DoAllTheThings(ch)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Ktc977gYpA\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Ktc977gYpA</a></p>\n"}], "owner": {"reputation": 6626, "user_id": 886749, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d8206b3ff36c7985108359f97562a9a4?s=128&d=identicon&r=PG", "display_name": "Cory Kendall", "link": "https://stackoverflow.com/users/886749/cory-kendall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1490794524, "creation_date": 1481665662, "question_id": 41131115, "link": "https://stackoverflow.com/questions/41131115/garbage-channel-in-golang", "title": "Garbage channel in Golang?", "body": "<p>I accept a <code>done</code> channel in my function, which is nice for notifying callers when some async process has finished, if they care.  This is very useful for writing unit tests for example.</p>\n\n<p>If my caller doesn't need this functionality, is there an idiomatic way to pass a garbage channel, where all values sent to it are discarded immediately?  I was initially surprised sending <code>nil</code> didn't work (sending to nil blocks the sender).  I can think of one gross implementation (like a goroutine always running that consumes from this channel), but I would love to write something like:</p>\n\n<pre><code>func myFunc(foo int, done chan bool) {\n    ....\n}\n\nfunc main() {\n    myfunc(4, _)\n}\n</code></pre>\n\n<p>Is there a simple way to accomplish this?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 1, "last_activity_date": 1481840651, "last_edit_date": 1481840651, "creation_date": 1481665878, "answer_id": 41131170, "question_id": 41131041, "link": "https://stackoverflow.com/questions/41131041/marshalling-time-fields-as-unix-time/41131170#41131170", "title": "Marshalling Time fields as Unix time", "body": "<p>You need to convert your type back to a <code>time.Time</code> to have access to its methods.  Named types do not \"inherit\" the methods of their underlying types (to do that, you need <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow noreferrer\">embedding</a>).</p>\n\n<pre><code>func (t Timestamp) MarshalJSON() ([]byte, error) {\n    return []byte(strconv.FormatInt(time.Time(t).Unix(), 10)), nil\n}\n</code></pre>\n\n<p>Also, just as a matter of personal preference, I tend to preferred <code>fmt.Sprintf(\"%v\", i)</code> over <code>strconv.FormatInt(i, 10)</code> or even <code>strconv.Itoa(i)</code>.  Honestly not sure which is faster, but the <code>fmt</code> version seems easier to read, personally.</p>\n"}], "owner": {"reputation": 95, "user_id": 5479994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b1cabcd992fc6047e4108a59fcac6c4?s=128&d=identicon&r=PG", "display_name": "s1gtrap", "link": "https://stackoverflow.com/users/5479994/s1gtrap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 41131170, "answer_count": 1, "score": 0, "last_activity_date": 1481840651, "creation_date": 1481665291, "question_id": 41131041, "link": "https://stackoverflow.com/questions/41131041/marshalling-time-fields-as-unix-time", "title": "Marshalling Time fields as Unix time", "body": "<p>I want to encode my <code>time.Time</code> fields as numeric Unix time and I would prefer not to implement custom MarshalJSON functions for each and every struct, since I have lots and lots of structs.</p>\n\n<p>So, I tried defining a type alias as such:</p>\n\n<p><code>type Timestamp time.Time</code></p>\n\n<p>And implementing MarshalJSON on it like so:</p>\n\n<pre><code>func (t Timestamp) MarshalJSON() ([]byte, error) {\n    return []byte(strconv.FormatInt(t.Unix(), 10)), nil\n}\n</code></pre>\n\n<p>But that gives me a <code>t.Unix undefined (type Timestamp has no field or method Unix)</code>, which doesn't make sense to me. Shouldn't <code>Timestamp</code> 'inherit' (I know that's probably the wrong term) all functions of <code>time.Time</code>?</p>\n\n<p>I also tried using a type assertion like so:</p>\n\n<pre><code>strconv.FormatInt(t.(time.Time).Unix(), 10)\n</code></pre>\n\n<p>But that also fails, complaining about an invalid type assertion: <code>invalid type assertion: t.(time.Time) (non-interface type Timestamp on left)</code></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 1295393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ed986cde33cb871e5992d4f824562a8?s=128&d=identicon&r=PG", "display_name": "xrefor", "link": "https://stackoverflow.com/users/1295393/xrefor"}, "edited": false, "score": 0, "creation_date": 1481665078, "post_id": 41130442, "comment_id": 69466179, "body": "Thank you. I&#39;ve tried to add it to my application but I keep getting errors like this:   go run digall.go google.com # command-line-arguments ./digall.go:54: undefined: err ./digall.go:58: undefined: cname ./digall.go:60: undefined: addresses ./digall.go:61: undefined: addresses ./digall.go:62: undefined: addresses ./digall.go:63: undefined: addresses ./digall.go:64: undefined: addresses ./digall.go:91: cannot use query[1] (type byte) as type string in argument to srvRecord  The unaltered version is here: <a href=\"http://dpaste.com/3X24ZYR\" rel=\"nofollow noreferrer\">dpaste.com/3X24ZYR</a>"}, {"owner": {"reputation": 3058, "user_id": 2776473, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/JvVL6.jpg?s=128&g=1", "display_name": "Shmulik Klein", "link": "https://stackoverflow.com/users/2776473/shmulik-klein"}, "reply_to_user": {"reputation": 13, "user_id": 1295393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ed986cde33cb871e5992d4f824562a8?s=128&d=identicon&r=PG", "display_name": "xrefor", "link": "https://stackoverflow.com/users/1295393/xrefor"}, "edited": false, "score": 0, "creation_date": 1481665258, "post_id": 41130442, "comment_id": 69466283, "body": "Please notice I&#39;ve declared <code>cname</code>, <code>addrs</code> and <code>err</code> inside the loop, so they won&#39;t be available if you are trying to print their content outside the scope of the loop."}, {"owner": {"reputation": 13, "user_id": 1295393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ed986cde33cb871e5992d4f824562a8?s=128&d=identicon&r=PG", "display_name": "xrefor", "link": "https://stackoverflow.com/users/1295393/xrefor"}, "edited": false, "score": 0, "creation_date": 1484680867, "post_id": 41130442, "comment_id": 70606174, "body": "I&#39;m sorry for the late reply. I think I&#39;ve figured it out. Thank you! :)"}], "tags": [], "owner": {"reputation": 3058, "user_id": 2776473, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/JvVL6.jpg?s=128&g=1", "display_name": "Shmulik Klein", "link": "https://stackoverflow.com/users/2776473/shmulik-klein"}, "is_accepted": true, "score": 1, "last_activity_date": 1481663845, "last_edit_date": 1481663845, "creation_date": 1481662766, "answer_id": 41130442, "question_id": 41130307, "link": "https://stackoverflow.com/questions/41130307/golang-net-modulelookupsrv/41130442#41130442", "title": "golang net module(LookupSRV)", "body": "<p>You can't query multiple services at once using <code>LookupSRV</code> method, as you can't use <code>dig</code> for querying several services at once.</p>\n\n<p>You better create a slice of the services' names:</p>\n\n<pre><code>services := [...]string{\"service1\", \"service2\", \"service3\")\n</code></pre>\n\n<p>And then iterate over it and call <code>LookupSRV</code> for each service:</p>\n\n<pre><code>for _, service := range services {\n    cname , addrs, err := net.LookupSRV(service, \"tcp\", \"your.domain.name\")\n\n    // error handlling\n}\n</code></pre>\n\n<p>Also when iterating over the lookup result, it is better to use the <code>range</code> keyword:</p>\n\n<pre><code>for _, record := range addrs {\n    fmt.Printf(\"Target: %s:%d\\n\", record.Target, record.Port)\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 1295393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ed986cde33cb871e5992d4f824562a8?s=128&d=identicon&r=PG", "display_name": "xrefor", "link": "https://stackoverflow.com/users/1295393/xrefor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 847, "favorite_count": 0, "accepted_answer_id": 41130442, "answer_count": 1, "score": 0, "last_activity_date": 1481664961, "creation_date": 1481662205, "last_edit_date": 1481664961, "question_id": 41130307, "link": "https://stackoverflow.com/questions/41130307/golang-net-modulelookupsrv", "title": "golang net module(LookupSRV)", "body": "<p>I'm very new to golang, I have some experience with python but not on this level per say. I am creating an application that's called \"digall\", making it easy for a user to see active dns-records when checking a domain name.</p>\n\n<p>In the application I am using <code>LookupSRV</code>, which I seem to have some issues with:</p>\n\n<pre><code>    func srvRecord(query string) {\n        service := \"sipfederationtls\"\n        protocol:= \"tcp\"\n        fmt.Printf(\"\\n[+] SRV Record(s)\\n\")\n        //srvMap := [\"sipfederationtls\", \"autodiscover\", \"VLMCS\"]\n        cname, addresses, err := net.LookupSRV(service, protocol, query)\n\n        if err != nil {\n                fmt.Printf(\"[!] This feature is currently under development, thus not ready yet.\\n\")\n        }\n\n        fmt.Printf(\"cname : %s \\n\", cname)\n\n        for i := 0; i &lt; len(addresses); i++ {\n                fmt.Printf(\"addrs[%d].Target : %s \\n\", i, addresses[i].Target)\n                fmt.Printf(\"addrs[%d].Port : %d \\n\", i, addresses[i].Port)\n                fmt.Printf(\"addrs[%d].Priority : %d \\n\", i, addresses[i].Priority)\n                fmt.Printf(\"addrs[%d].Weight : %d \\n\", i, addresses[i].Weight)\n        }\n}\n</code></pre>\n\n<p>As you can see the variable \"service\" serves as the prefix of the SRV record. My only problem is that i want to check multiple prefixes of this record, namely \"sipfederationtls\", \"autodiscover\" and \"VLMCS\".</p>\n\n<p>What I am asking is; How to i make this function swift through these prefixes and return the ones that work? (the ones that error out will be handled by err by my fantastic error message)</p>\n\n<p>I am aware that this is a noob question, and like I said I am very new to golang. I would appreciate any tips you guys could give me.</p>\n\n<p>Here is the full source of the application: <a href=\"http://dpaste.com/3X24ZYR\" rel=\"nofollow noreferrer\">http://dpaste.com/3X24ZYR</a></p>\n\n<p>Thank you.</p>\n"}, {"tags": ["go", "struct", "printing", "interface"], "comments": [{"owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 0, "creation_date": 1481662730, "post_id": 41130075, "comment_id": 69464969, "body": "you don&#39;t have any built-in way to print that data, but you can implement a <code>print</code> or <code>toString</code> method for your AST if you have access to the attributes of <code>Node</code>."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 5430451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b280523ffc5b569ead4ce35e0b4a5baf?s=128&d=identicon&r=PG&f=1", "display_name": "ssow", "link": "https://stackoverflow.com/users/5430451/ssow"}, "is_accepted": false, "score": 2, "last_activity_date": 1481663125, "creation_date": 1481663125, "answer_id": 41130534, "question_id": 41130075, "link": "https://stackoverflow.com/questions/41130075/is-there-a-built-in-way-to-recursively-print-a-tree/41130534#41130534", "title": "Is there a built-in way to recursively print a tree?", "body": "<p>You are looking for ast.Fprint, <a href=\"https://godoc.org/go/ast#Fprint\" rel=\"nofollow noreferrer\">https://godoc.org/go/ast#Fprint</a></p>\n"}], "owner": {"reputation": 3591, "user_id": 4107956, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/LjlBF.jpg?s=128&g=1", "display_name": "Will", "link": "https://stackoverflow.com/users/4107956/will"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 506, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481663125, "creation_date": 1481661208, "question_id": 41130075, "link": "https://stackoverflow.com/questions/41130075/is-there-a-built-in-way-to-recursively-print-a-tree", "title": "Is there a built-in way to recursively print a tree?", "body": "<p>I am learning Go and looking for a way to print my AST (For reference, I'm following along with Ruslan's excellent <a href=\"https://ruslanspivak.com/lsbasi-part1/\" rel=\"nofollow noreferrer\">Let's Build a Simple Interpreter</a>).</p>\n\n<p>I am printing the root with the following:</p>\n\n<pre><code>tree := par.Parse()\nfmt.Printf(\"\\nParse Tree:\\n%#v\\n\", tree)\n</code></pre>\n\n<p>Which prints:</p>\n\n<pre><code>Parse Tree:\n&amp;Node.Program{name:\"PART10AST\", block:(*Node.Block)(0x11b32160)}\n</code></pre>\n\n<p>Is there a way to recursively print a node, and all child nodes?  Something to the effect of:</p>\n\n<pre><code>&amp;Node.Program{name:\"PART10AST\", block:(*Node.Block{decl: *Node.declarations{...}, comp: *Node.Compound{...}})}\n</code></pre>\n\n<p>Is this functionality built in to Go in any way?  <code>Node</code> is an interface for several different types of <code>struct</code>s which store data and/or more <code>Node</code>s.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "edited": false, "score": 0, "creation_date": 1481651101, "post_id": 41127380, "comment_id": 69458708, "body": "just put it back into the map  s[0] = firstEntry  or use a pointer"}], "answers": [{"tags": [], "owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "is_accepted": true, "score": 23, "last_activity_date": 1481655173, "creation_date": 1481655173, "answer_id": 41128504, "question_id": 41127380, "link": "https://stackoverflow.com/questions/41127380/how-to-modify-a-slice-element-which-is-a-struct-in-golang/41128504#41128504", "title": "How to modify a slice element which is a struct in golang?", "body": "<p>Try</p>\n\n<pre><code>s[0].value = 5\n</code></pre>\n\n<p>This gets to the backing store of the slice.  Also</p>\n\n<pre><code>p := &amp;s[1]\np.value = 6\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2971, "user_id": 496351, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/ce4ddeab530fecaf1270a1bf5cccea90?s=128&d=identicon&r=PG", "display_name": "Tristian", "link": "https://stackoverflow.com/users/496351/tristian"}, "is_accepted": false, "score": 3, "last_activity_date": 1553701690, "last_edit_date": 1553701690, "creation_date": 1548117786, "answer_id": 54299731, "question_id": 41127380, "link": "https://stackoverflow.com/questions/41127380/how-to-modify-a-slice-element-which-is-a-struct-in-golang/54299731#54299731", "title": "How to modify a slice element which is a struct in golang?", "body": "<p>You can also take the address of the slice element directly and de-reference it:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func main() {\n\n    s := []Type{{0}, {0}}\n\n    // Prints  [{0} {0}]\n    fmt.Println(s)\n\n    // De-reference the address of the slice element\n    (&amp;s[0]).value = 5\n\n    // Prints [{5} {0}]\n    fmt.Println(s)\n}\n</code></pre>\n"}], "owner": {"reputation": 1330, "user_id": 5771861, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/cbtGq.jpg?s=128&g=1", "display_name": "Hakan Baba", "link": "https://stackoverflow.com/users/5771861/hakan-baba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17463, "favorite_count": 3, "accepted_answer_id": 41128504, "answer_count": 2, "score": 15, "last_activity_date": 1553701690, "creation_date": 1481650969, "last_edit_date": 1481651553, "question_id": 41127380, "link": "https://stackoverflow.com/questions/41127380/how-to-modify-a-slice-element-which-is-a-struct-in-golang", "title": "How to modify a slice element which is a struct in golang?", "body": "<p>You have a golang slice of structs and you would like to change one entry in there. </p>\n\n<pre><code>type Type struct {\n    value int\n}\n\nfunc main() {\n\n    s := []Type{{0}, {0}}\n\n    // Prints  [{0} {0}]\n    fmt.Println(s)\n\n    firstEntry := s[0]\n    firstEntry.value = 5\n\n    // Also prints [{0} {0}]\n    fmt.Println(s)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/32tpcc3-OD\" rel=\"noreferrer\">https://play.golang.org/p/32tpcc3-OD</a></p>\n\n<p>Using the brackets operator and modifying its return does not change the slice itself. </p>\n\n<p>What is the recommended way of doing this slice entry modification ? </p>\n"}, {"tags": ["go", "certificate", "pem"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481663462, "post_id": 41127019, "comment_id": 69465343, "body": "You can load the values directly into an <a href=\"https://golang.org/pkg/crypto/rsa/#PublicKey\" rel=\"nofollow noreferrer\"><code>rsa.PublicKey</code></a>. What format do need the key in?"}, {"owner": {"reputation": 1745, "user_id": 3888307, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/65d6a22ea2fb9fb7a3d78bd57b9d71ea?s=128&d=identicon&r=PG&f=1", "display_name": "user3888307", "link": "https://stackoverflow.com/users/3888307/user3888307"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481670563, "post_id": 41127019, "comment_id": 69468506, "body": "Thank you for asking. I&#39;m trying to convert into .PEM format like this"}, {"owner": {"reputation": 1745, "user_id": 3888307, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/65d6a22ea2fb9fb7a3d78bd57b9d71ea?s=128&d=identicon&r=PG&f=1", "display_name": "user3888307", "link": "https://stackoverflow.com/users/3888307/user3888307"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481670635, "post_id": 41127019, "comment_id": 69468525, "body": "-----BEGIN PUBLIC KEY----- MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDfu6fJMNQNy13wCYvlIuKP&zwnj;&#8203;BfBt BHgeAeUbrn4JVmuAJGnQ2i08RizbWPzbckWQX8IXQJkYykCU1YJ+Y98tLPo/&zwnj;&#8203;276c zJLaFXhwe4qzocQ52SXSMTTTGN51CgYEAfNY4PJTU3gayahC0iYkV0CHuT8l&zwnj;&#8203;iVsE CdV67X0DXMBpCAjNSwIDAQAB -----END PUBLIC KEY-----"}], "answers": [{"comments": [{"owner": {"reputation": 526, "user_id": 2139818, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/tBfb7.png?s=128&g=1", "display_name": "Venkatesh Marepalli", "link": "https://stackoverflow.com/users/2139818/venkatesh-marepalli"}, "edited": false, "score": 0, "creation_date": 1498692652, "post_id": 41132320, "comment_id": 76608741, "body": "I was trying to implement similar function in lua. There is a slight difference between the key generated by my code and your GoLang code. The key generated by your code worked for me. Can you refer to this link and let me know what I was missing, I guess I have to add OID in my code similar to the implementation of GoLang, But again not sure how to convert ASN.1 to ASCII in lua. I will update my code based on your inputs. Thanks <a href=\"https://stackoverflow.com/questions/44791186/how-can-i-fix-this-code-to-get-similar-output-as-golang-function?noredirect=1#comment76563822_44791186\" title=\"how can i fix this code to get similar output as golang function\">stackoverflow.com/questions/44791186/&hellip;</a>"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 9, "last_activity_date": 1481671621, "creation_date": 1481671621, "answer_id": 41132320, "question_id": 41127019, "link": "https://stackoverflow.com/questions/41127019/go-language-convert-modulus-exponent-to-x-509-certificate/41132320#41132320", "title": "Go Language Convert Modulus exponent to X.509 certificate", "body": "<p>You can put the values directly into an <code>rsa.PublicKey</code>, which can be used as is. Since you want to encode that as a pem encoded x.509, you can use the <a href=\"https://golang.org/pkg/crypto/x509/#MarshalPKIXPublicKey\" rel=\"noreferrer\"><code>x509.MarshalPKIXPublicKey</code></a> function to marshal the der block, and encode that with the pem package. </p>\n\n<p>After unmarshaling the first key in your example to <code>jwk</code>:</p>\n\n<pre><code>// decode the base64 bytes for n\nnb, err := base64.RawURLEncoding.DecodeString(jwk[\"n\"])\nif err != nil {\n    log.Fatal(err)\n}\n\ne := 65537\n// The default exponent is usually 65537, so just compare the\n// base64 for [1,0,1] or [0,1,0,1]\nif jwk[\"e\"] != \"AQAB\" &amp;&amp; jwk[\"e\"] != \"AAEAAQ\" {\n    // still need to decode the big-endian int\n    log.Fatal(\"need to deocde e:\", jwk[\"e\"])\n}\n\npk := &amp;rsa.PublicKey{\n    N: new(big.Int).SetBytes(nb),\n    E: e,\n}\n\nder, err := x509.MarshalPKIXPublicKey(pk)\nif err != nil {\n    log.Fatal(err)\n}\n\nblock := &amp;pem.Block{\n    Type:  \"RSA PUBLIC KEY\",\n    Bytes: der,\n}\n\nvar out bytes.Buffer\npem.Encode(&amp;out, block)\nfmt.Println(out.String())\n</code></pre>\n\n<p>Which will output:</p>\n\n<pre><code>-----BEGIN RSA PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAok6rvXu95337IxsDXrKz\nlIqw/I/zPDG8JyEw2CTOtNMoDi1QzpXQVMGj2snNEmvNYaCTmFf51I+EDgeFLLex\nr40jzBXlg72quV4aw4yiNuxkigW0gMA92OmaT2jMRIdDZM8mVokoxyPfLub2YnXH\nFq0XuUUgkX/TlutVhgGbyPN0M12teYZtMYo2AUzIRggONhHvnibHP0CPWDjCwSfp\n3On1Recn4DPxbn3DuGslF2myalmCtkujNcrhHLhwYPP+yZFb8e0XSNTcQvXaQxAq\nmnWH6NXcOtaeWMQe43PNTAyNinhndgI8ozG3Hz+1NzHssDH/yk6UYFSszhDbWAzy\nqwIDAQAB\n-----END RSA PUBLIC KEY-----\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Ch6Nr9F6Ik\" rel=\"noreferrer\">https://play.golang.org/p/Ch6Nr9F6Ik</a></p>\n"}], "owner": {"reputation": 1745, "user_id": 3888307, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/65d6a22ea2fb9fb7a3d78bd57b9d71ea?s=128&d=identicon&r=PG&f=1", "display_name": "user3888307", "link": "https://stackoverflow.com/users/3888307/user3888307"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2198, "favorite_count": 5, "accepted_answer_id": 41132320, "answer_count": 1, "score": 6, "last_activity_date": 1596632297, "creation_date": 1481649771, "last_edit_date": 1596632297, "question_id": 41127019, "link": "https://stackoverflow.com/questions/41127019/go-language-convert-modulus-exponent-to-x-509-certificate", "title": "Go Language Convert Modulus exponent to X.509 certificate", "body": "<p>I have seen a lot of examples of how to convert a X.509 to Exponent Modulus, but I have not seen the reverse.</p>\n<p>The values I have from my key endpoint look like this:</p>\n<pre><code>{\n  &quot;keys&quot;: [\n    {\n      &quot;alg&quot;: &quot;RS256&quot;,\n      &quot;e&quot;: &quot;AQAB&quot;,\n      &quot;n&quot;: &quot;ok6rvXu95337IxsDXrKzlIqw_I_zPDG8JyEw2CTOtNMoDi1QzpXQVMGj2snNEmvNYaCTmFf51I-EDgeFLLexr40jzBXlg72quV4aw4yiNuxkigW0gMA92OmaT2jMRIdDZM8mVokoxyPfLub2YnXHFq0XuUUgkX_TlutVhgGbyPN0M12teYZtMYo2AUzIRggONhHvnibHP0CPWDjCwSfp3On1Recn4DPxbn3DuGslF2myalmCtkujNcrhHLhwYPP-yZFb8e0XSNTcQvXaQxAqmnWH6NXcOtaeWMQe43PNTAyNinhndgI8ozG3Hz-1NzHssDH_yk6UYFSszhDbWAzyqw&quot;,\n      &quot;kid&quot;: &quot;wyMwK4A6CL9Qw11uofVeyQ119XyX-xykymkkXygZ5OM&quot;,\n      &quot;kty&quot;: &quot;RSA&quot;,\n      &quot;use&quot;: &quot;sig&quot;\n    },\n    {\n      &quot;alg&quot;: &quot;RS256&quot;,\n      &quot;e&quot;: &quot;AQAB&quot;,\n      &quot;n&quot;: &quot;nXv6FSAcMjuanQ2hIIUb8Vkqe94t98kPh2T8-0j6-Jq8pOclgKdtVeIZcBE9F_XiuJvg4b6WVs-uvA-pS8mmMvQ21xU5Q_37Cojv8v_QlHWETHwEJdXXiY2Xq5LgXDSwEhhdDZHSMQYDuvhp_P6nl2LNqqUvJkjoFWcnn2btgSIUQROIaDdxtx7_2h4oUi5u11BGSF2SZZiEpDAKT08Htv3uwXdwDA6ll99fbi8X8RmH5oY_tIZTeIzu50qHxElPewoYO8QrJYsO9oFcCPMHGxYWjXQEa-QZYgo0wS9zRIkeJc5kshc4-9Uhv2DVIjk_-ofGlML9ieggGyillBKptw&quot;,\n      &quot;kid&quot;: &quot;GRF55Lbzgg4sANCmER-sm55eX_qUOpY8UTptDmDG_6U&quot;,\n      &quot;kty&quot;: &quot;RSA&quot;,\n      &quot;use&quot;: &quot;sig&quot;\n    }\n  ]\n}\n</code></pre>\n<p>I think this is the Key:</p>\n<pre><code>ok6rvXu95337IxsDXrKzlIqw_I_zPDG8JyEw2CTOtNMoDi1QzpXQVMGj2snNEmvNYaCTmFf51I-EDgeFLLexr40jzBXlg72quV4aw4yiNuxkigW0gMA92OmaT2jMRIdDZM8mVokoxyPfLub2YnXHFq0XuUUgkX_TlutVhgGbyPN0M12teYZtMYo2AUzIRggONhHvnibHP0CPWDjCwSfp3On1Recn4DPxbn3DuGslF2myalmCtkujNcrhHLhwYPP-yZFb8e0XSNTcQvXaQxAqmnWH6NXcOtaeWMQe43PNTAyNinhndgI8ozG3Hz-1NzHssDH_yk6UYFSszhDbWAzyqw\n\nvar key = &quot;ok6rvXu95337IxsDXrKzlIqw_I_zPDG8JyEw2CTOtNMoDi1QzpXQVMGj2snNEmvNYaCTmFf51I-EDgeFLLexr40jzBXlg72quV4aw4yiNuxkigW0gMA92OmaT2jMRIdDZM8mVokoxyPfLub2YnXHFq0XuUUgkX_TlutVhgGbyPN0M12teYZtMYo2AUzIRggONhHvnibHP0CPWDjCwSfp3On1Recn4DPxbn3DuGslF2myalmCtkujNcrhHLhwYPP-yZFb8e0XSNTcQvXaQxAqmnWH6NXcOtaeWMQe43PNTAyNinhndgI8ozG3Hz-1NzHssDH_yk6UYFSszhDbWAzyqw&quot;\n</code></pre>\n<h2>Expected Output</h2>\n<p>I'm trying to convert into .PEM format like this</p>\n<pre><code>-----BEGIN PUBLIC KEY-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDfu6fJMNQNy13wCYvlIuKPBfBt\nBHgeAeUbrn4JVmuAJGnQ2i08RizbWPzbckWQX8IXQJkYykCU1YJ+Y98tLPo/276c\nzJLaFXhwe4qzocQ52SXSMTTTGN51CgYEAfNY4PJTU3gayahC0iYkV0CHuT8liVsEdV67X0DXMBpCAjNSwIDAQAB\n-----END PUBLIC KEY----- \u2013\n</code></pre>\n<p>If anyone can point me in the right direction to do this in the GO language would be appreciated. I'll also put it on the Go Lang playground so others can use it.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481650135, "post_id": 41126762, "comment_id": 69458112, "body": "I&#39;m not sure I understand. You are using <code>json.UseNumber</code>. The values like <code>3.531951269E10</code> are in a float format, so they can only be displayed as is or converted to a float64. <code>json.Number</code> can&#39;t convert that to an integer, and will display <code>strconv.ParseInt: parsing &quot;3.531951269E10&quot;: invalid syntax</code> if you try."}, {"owner": {"reputation": 15349, "user_id": 2282538, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0a4fff09f1f0e3360daeabb30c2c06bb?s=128&d=identicon&r=PG", "display_name": "Tyler", "link": "https://stackoverflow.com/users/2282538/tyler"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481651257, "post_id": 41126762, "comment_id": 69458805, "body": "In ElasticSearch the numbers are stored as Longs.  When I query it with Postman I get back Longs.  When I query it will Go I get back Floats instead of Longs."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481653414, "post_id": 41126762, "comment_id": 69459961, "body": "The unmodified output from curl is for example is <code>3.531951269E10</code>, which is a float. You can check yourself if that can be converted to an Int64 without any loss in precision, but that&#39;s not something that <code>json.Number</code> does for you."}, {"owner": {"reputation": 15349, "user_id": 2282538, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0a4fff09f1f0e3360daeabb30c2c06bb?s=128&d=identicon&r=PG", "display_name": "Tyler", "link": "https://stackoverflow.com/users/2282538/tyler"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481654275, "post_id": 41126762, "comment_id": 69460372, "body": "You&#39;re correct.  It looks like Postman was doing some conversions behind the scenes and piping the <code>curl</code> output to <code>jq</code> does the same thing."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481654606, "post_id": 41128300, "comment_id": 69460522, "body": "jq and postman are <i>not</i> converting the numbers to integers for you, they are simply using a different format for the float. there is no such thing as an integer in JSON, so <code>35319512690</code> is just a float without the decimal point which equivalent to both <code>35319512690.0</code>  and  <code>3.531951269E10</code>."}, {"owner": {"reputation": 15349, "user_id": 2282538, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0a4fff09f1f0e3360daeabb30c2c06bb?s=128&d=identicon&r=PG", "display_name": "Tyler", "link": "https://stackoverflow.com/users/2282538/tyler"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481661865, "post_id": 41128300, "comment_id": 69464513, "body": "Thanks for the clarification, I will add that to my answer"}], "tags": [], "owner": {"reputation": 15349, "user_id": 2282538, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0a4fff09f1f0e3360daeabb30c2c06bb?s=128&d=identicon&r=PG", "display_name": "Tyler", "link": "https://stackoverflow.com/users/2282538/tyler"}, "is_accepted": true, "score": 0, "last_activity_date": 1481661929, "last_edit_date": 1481661929, "creation_date": 1481654489, "answer_id": 41128300, "question_id": 41126762, "link": "https://stackoverflow.com/questions/41126762/decode-get-request-with-usenumber/41128300#41128300", "title": "Decode GET request with UseNumber", "body": "<p>As the curl output indicated, Elasticsearch was actually giving the results in floating point format.  It seems the Postman and <code>jq</code> do the conversion for you, so my solution for now is to just make a system call to <code>jq</code>:</p>\n\n<pre><code>// Make request\nresp, err := client.Do(req)\nif err != nil {\n    log.Fatal(err)\n}\ndefer resp.Body.Close()\n\n// Use jq to convert the floating point stuff to Longs / Ints\ncmd := exec.Command(\"jq\", \".\")\ncmd.Stdin = resp.Body\nvar out bytes.Buffer\ncmd.Stdout = &amp;out\nerr = cmd.Run()\nif err != nil {\n    log.Fatal(err)\n}\n\n// Decode the output from jq\nd := json.NewDecoder(bytes.NewReader(out.Bytes())\nd.UseNumber()\n\nvar x interface{}\nif err = d.Decode(&amp;x); err != nil {\n    log.Fatal(err)\n}\n\nfmt.Printf(\"decoded to %#v\\n\", x)\n</code></pre>\n\n<p>To clarify about Postman / curl:</p>\n\n<blockquote>\n  <p>(They) are simply using a different format for the float. there is no\n  such thing as an integer in JSON, so 35319512690 is just a float\n  without the decimal point which equivalent to both 35319512690.0 and\n  3.531951269E10  - JimB</p>\n</blockquote>\n"}], "owner": {"reputation": 15349, "user_id": 2282538, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0a4fff09f1f0e3360daeabb30c2c06bb?s=128&d=identicon&r=PG", "display_name": "Tyler", "link": "https://stackoverflow.com/users/2282538/tyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 41128300, "answer_count": 1, "score": 0, "last_activity_date": 1481661929, "creation_date": 1481648879, "question_id": 41126762, "link": "https://stackoverflow.com/questions/41126762/decode-get-request-with-usenumber", "title": "Decode GET request with UseNumber", "body": "<p>I have the following code that makes a request to Elasticsearch:</p>\n\n<pre><code>// Prepare request\ntr := &amp;http.Transport{\n    TLSClientConfig: &amp;tls.Config{InsecureSkipVerify: true},\n}\nclient := &amp;http.Client{Transport: tr}\nreq, err := http.NewRequest(\"GET\", url, nil)\nreq.Header.Add(\"Authorization\", ES_AUTH)\n\n// Make request\nresp, err := client.Do(req)\nif err != nil {\n    log.Fatal(err)\n}\ndefer resp.Body.Close()\n\nd := json.NewDecoder(resp.Body)\nd.UseNumber()\n\nvar x interface{}\nif err = d.Decode(&amp;x); err != nil {\n    log.Fatal(err)\n}\n\nfmt.Printf(\"decoded to %#v\\n\", x)\n</code></pre>\n\n<p>The output is this:</p>\n\n<pre><code>decoded to map[string]interface {}{\"took\":\"2\", \"timed_out\":false, \"_shards\":map[string]interface {}{\"total\":\"1\", \"successful\":\"1\", \"failed\":\"0\"}, \"hits\":map[string]interface {}{\"total\":\"15\", \"max_score\":\"1.0\", \"hits\":[]interface {}{map[string]interface {}{\"_index\":\"reports2\", \"_type\":\"insiders\", \"_id\":\"cbaf7513-0046-4929-a740-afe13d6616b4\", \"_score\":\"1.0\", \"_routing\":\"524364278561685819\", \"_source\":map[string]interface {}{\"insider_mean\":\"420.7546961325966\",  \"friend_total\":\"3.7859686E7\", \"sum_of_followers\":\"3.531951269E10\", \"follower_total\":\"50000.0\"}}}}}\n</code></pre>\n\n<p>I am trying to use <code>d.UseNumber()</code> to get the output to have integer numbers where possible, instead of using floats for everything.  I was expecting <code>\"friend_total\"</code>, <code>\"sum_of_followers\"</code>, and <code>\"follower_total\"</code> to have integer-style values.</p>\n\n<p>If I make the same request with postman you can see that these values should be whole numbers:</p>\n\n<pre><code>{\n  \"took\": 2,\n  \"timed_out\": false,\n  \"_shards\": {\n    \"total\": 1,\n    \"successful\": 1,\n    \"failed\": 0\n  },\n  \"hits\": {\n    \"total\": 15,\n    \"max_score\": 1,\n    \"hits\": [\n      {\n        \"_index\": \"reports2\",\n        \"_type\": \"insiders\",\n        \"_id\": \"cbaf7513-0046-4929-a740-afe13d6616b4\",\n        \"_score\": 1,\n        \"_routing\": \"524364278561685819\",\n        \"_source\": {\n          \"insider_mean\": 420.7546961325966,\n          \"sum_of_followers\": 35319512690,\n          \"follower_total\": 50000,\n          \"friend_total\": 37859686\n        }\n      }\n    ]\n  }\n}\n</code></pre>\n\n<p>I was unable to replicate the error in <a href=\"https://play.golang.org/p/CBM7ksLrWN\" rel=\"nofollow noreferrer\">this Go Playground</a> so I think that the error may be because of the request itself, and not the decoding.</p>\n\n<hr>\n\n<p>Edit:</p>\n\n<p>I have discovered that doing a curl request returns the payload, so now I am certain that the decoding is not the problem.</p>\n\n<pre><code>curl localhost:9200/524364278561685819/insiders/_search\\?size\\=1                   \n{\"took\":2,\"timed_out\":false,\"_shards\":{\"total\":1,\"successful\":1,\"failed\":0},\"hits\":{\"total\":15,\"max_score\":1.0,\"hits\":[{\"_index\":\"reports2\",\"_type\":\"insiders\",\"_id\":\"cbaf7513-0046-4929-a740-afe13d6616b4\",\"_score\":1.0,\"_routing\":\"524364278561685819\",\"_source\":{\"insider_mean\":420.7546961325966,\"sum_of_followers\":3.531951269E10,\"follower_total\":50000.0,\"friend_total\":3.7859686E7}}]}}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1481643267, "post_id": 41124798, "comment_id": 69453562, "body": "Values from functions are not addressable, so yes: You do have to assign the return value to a variable before taking the address."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1481645202, "post_id": 41124798, "comment_id": 69454888, "body": "Also duplicate of <a href=\"http://stackoverflow.com/questions/34197248/how-can-i-store-reference-to-the-result-of-an-operation-in-go/34197367#34197367\">How can I store reference to the result of an operation in Go?</a>; and <a href=\"http://stackoverflow.com/questions/30744965/how-to-get-the-pointer-of-return-value-from-function-call/30751102#30751102\">How to get the pointer of return value from function call?</a>"}], "owner": {"reputation": 6626, "user_id": 886749, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d8206b3ff36c7985108359f97562a9a4?s=128&d=identicon&r=PG", "display_name": "Cory Kendall", "link": "https://stackoverflow.com/users/886749/cory-kendall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "closed_date": 1481643750, "answer_count": 0, "score": 0, "last_activity_date": 1481643017, "creation_date": 1481643017, "question_id": 41124798, "link": "https://stackoverflow.com/questions/41124798/can-i-use-the-address-of-a-returned-value", "closed_reason": "Duplicate", "title": "Can I Use the Address of a returned value?", "body": "<p>I have a function that returns a <code>string</code>, and a structure that wants a <code>string*</code>.  Currently I'm doing this <a href=\"https://play.golang.org/p/rFfeONFS33\" rel=\"nofollow noreferrer\">https://play.golang.org/p/rFfeONFS33</a></p>\n\n<pre><code>stupid := a()\ny.z = &amp;stupid\n</code></pre>\n\n<p>What I want (doesn't work) <a href=\"https://play.golang.org/p/Hhh8GP7JJl\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Hhh8GP7JJl</a></p>\n\n<pre><code>z.y = &amp;(a())\n</code></pre>\n\n<p>Is this because returned values are using the stack?  Is there a more elegant way than allocating some other variable with a nonsense name?</p>\n"}, {"tags": ["go", "inline"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1481630328, "post_id": 41119734, "comment_id": 69444678, "body": "Don&#39;t worry too much. Especially as there is not much you can do and what you can do changes every 6 month with a new compiler (which can do more and better inlining)."}], "answers": [{"comments": [{"owner": {"reputation": 254, "user_id": 6834400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/755a8bd56eb19e5474875be5552d01eb?s=128&d=identicon&r=PG&f=1", "display_name": "User2910293", "link": "https://stackoverflow.com/users/6834400/user2910293"}, "edited": false, "score": 0, "creation_date": 1481630226, "post_id": 41119979, "comment_id": 69444622, "body": "Thank you for your explanation icza. I will definitely read those articles as soon as I get back home! I&#39;m aware from C++ (GNU docs also state this) that inlining can also cause the counter-effect of causing bloating-effects. I +1&#39;d your post, but will first read the articles later today and accept your answer based on the found criteria :). I know this is sometimes the withy optimisation-methodology, but I&#39;m just interested in the logic in itself too over the &quot;performance-gain&quot; per se."}, {"owner": {"reputation": 104432, "user_id": 53212, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0fbce15f81d6308656931250db267a1?s=128&d=identicon&r=PG", "display_name": "thomasrutter", "link": "https://stackoverflow.com/users/53212/thomasrutter"}, "edited": false, "score": 0, "creation_date": 1505126374, "post_id": 41119979, "comment_id": 79268915, "body": "Note that the compiler <i>does</i> inline functions that call other functions if those functions in turn have been inlined, and together the resulting function still satisfies the criteria. In particular, the &quot;budget&quot; starts becoming tight, as the function and any inlined functions it calls must fit within the same budget, of 40 operations or whatever it is in the latest version. When talking about non-leaf or &quot;mid stack&quot; functions, people are referring to functions that call other functions <i>that aren&#39;t inlined</i>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 13, "last_activity_date": 1481650042, "last_edit_date": 1481650042, "creation_date": 1481628443, "answer_id": 41119979, "question_id": 41119734, "link": "https://stackoverflow.com/questions/41119734/stimulate-code-inlining/41119979#41119979", "title": "Stimulate code-inlining", "body": "<p><a href=\"https://groups.google.com/d/msg/golang-nuts/V_xI29FGDZM/ubw6lPH2M-MJ\" rel=\"noreferrer\">Quoting minux</a> (on 2013-01-31):</p>\n\n<blockquote>\n  <p>By default, the inliner will try to inline leaf function (doesn't call other functions/method/interfaces) that doesn't call panic or recover or select or switch or create closure or go/defer functions (see example below) and which is less than 40 nodes when represented (roughly  corresponding to 40 simple operations). But please beware that this only describes the current status quo of the gc compiler, and it will surely improve in the future. Thus please try not to depend on this.</p>\n</blockquote>\n\n<p>Until you have performance problems, you shouldn't care. Inlined or not, it will do the same.</p>\n\n<p>If performance does matter and it makes a noticable and significant difference, then don't rely on current (or past) inlining conditions, \"inline\" it yourself (do not put it in a separate function).</p>\n\n<p>The rules can be found in the <a href=\"https://github.com/golang/go/blob/master/src/cmd/compile/internal/gc/inl.go\" rel=\"noreferrer\"><code>$GOROOT/src/cmd/compile/internal/gc/inl.go</code></a> file. You may control its aggressiveness with the <code>'l'</code> debug flag.</p>\n\n<pre><code>// The inlining facility makes 2 passes: first caninl determines which\n// functions are suitable for inlining, and for those that are it\n// saves a copy of the body. Then inlcalls walks each function body to\n// expand calls to inlinable functions.\n//\n// The debug['l'] flag controls the aggressiveness. Note that main() swaps level 0 and 1,\n// making 1 the default and -l disable.  -ll and more is useful to flush out bugs.\n// These additional levels (beyond -l) may be buggy and are not supported.\n//      0: disabled\n//      1: 40-nodes leaf functions, oneliners, lazy typechecking (default)\n//      2: early typechecking of all imported bodies\n//      3: allow variadic functions\n//      4: allow non-leaf functions , (breaks runtime.Caller)\n//\n//  At some point this may get another default and become switch-offable with -N.\n//\n//  The debug['m'] flag enables diagnostic output.  a single -m is useful for verifying\n//  which calls get inlined or not, more is for debugging, and may go away at any point.\n</code></pre>\n\n<p>Also check out blog post: <a href=\"https://dave.cheney.net/2014/06/07/five-things-that-make-go-fast\" rel=\"noreferrer\">Dave Cheney - Five things that make Go fast</a> (2014-06-07) which writes about inlining (long post, it's about in the middle, search for the \"inline\" word).</p>\n\n<p>Also interesting discussion about inlining improvements (maybe Go 1.9?): <a href=\"https://github.com/golang/go/issues/17566\" rel=\"noreferrer\">cmd/compile: improve inlining cost model #17566</a></p>\n"}, {"comments": [{"owner": {"reputation": 254, "user_id": 6834400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/755a8bd56eb19e5474875be5552d01eb?s=128&d=identicon&r=PG&f=1", "display_name": "User2910293", "link": "https://stackoverflow.com/users/6834400/user2910293"}, "edited": false, "score": 0, "creation_date": 1481630027, "post_id": 41120032, "comment_id": 69444482, "body": "I understand your point Franck. I use the <code>testing</code> library a lot, yet it&#39;s not always the literal &quot;explainer&quot; to see if it actually did inlining. It&#39;s also harder to determine it by testing if the function is used in more locations. I already cache a lot of data-sets, so there&#39;s not much overhead there. My question was mostly literal to the point of inlining on it&#39;s own. Your point is generally valid tho and I totally agree :)."}], "tags": [], "owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "is_accepted": false, "score": 2, "last_activity_date": 1481628639, "creation_date": 1481628639, "answer_id": 41120032, "question_id": 41119734, "link": "https://stackoverflow.com/questions/41119734/stimulate-code-inlining/41120032#41120032", "title": "Stimulate code-inlining", "body": "<p>Better still, don\u2019t guess, measure!\nYou should trust the compiler and avoid trying to guess its inner workings as it will change from one version to the next.\nThere are far too many tricks the compiler, the CPU or the cache can play to be able to predict performance from source code.</p>\n\n<p>What if inlining makes your code bigger to the point that it doesn\u2019t fit in the cache line anymore, making it much slower than the non-inlined version? Cache locality can have a much bigger impact on performance than branching.</p>\n"}], "owner": {"reputation": 254, "user_id": 6834400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/755a8bd56eb19e5474875be5552d01eb?s=128&d=identicon&r=PG&f=1", "display_name": "User2910293", "link": "https://stackoverflow.com/users/6834400/user2910293"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 919, "favorite_count": 2, "accepted_answer_id": 41119979, "answer_count": 2, "score": 4, "last_activity_date": 1481655119, "creation_date": 1481627746, "last_edit_date": 1481655119, "question_id": 41119734, "link": "https://stackoverflow.com/questions/41119734/stimulate-code-inlining", "title": "Stimulate code-inlining", "body": "<p>Unlike in languages like C++, where you can explicitly state <code>inline</code>, in Go the compiler dynamically detects functions that are candidate for inlining (which C++ can do too, but Go can't do both). Also there's a debug option to see possible inlining happening, yet there is very few documented online about the exact logic of the go compiler(s) doing this.</p>\n\n<p>Let's say I need to rerun some big loop over a set of data every n-period;</p>\n\n<pre><code>func Encrypt(password []byte) ([]byte, error) {\n    return bcrypt.GenerateFromPassword(password, 13)\n}\n\nfor id, data := range someDataSet {\n    newPassword, _ := Encrypt([]byte(\"generatedSomething\"))\n    data[\"password\"] = newPassword\n    someSaveCall(id, data)\n}\n</code></pre>\n\n<p>Aiming for example for <code>Encrypt</code> to being inlined properly what logic should I need to take into consideration for the compiler?</p>\n\n<p>I know from C++ that passing by reference will increase likeliness for automatic inlining without the explicit <code>inline</code> keyword, but it's not very easy to understand what the compiler exactly does to determine the decisions on choosing to inline or not in Go. Scriptlanguages like PHP for example suffer immensely if you do a loop with a constant <code>addSomething($a, $b)</code> where benchmarking such a billion cycles the cost of it versus <code>$a + $b</code> (inline) is almost ridiculous.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 5, "creation_date": 1481613842, "post_id": 41115526, "comment_id": 69435211, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/40333562/parsing-explicit-arrays/40333763#40333763\">Parsing explicit arrays</a>."}, {"owner": {"reputation": 142, "user_id": 3898735, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zcvJv.gif?s=128&g=1", "display_name": "gentlyawesome", "link": "https://stackoverflow.com/users/3898735/gentlyawesome"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1481614273, "post_id": 41115526, "comment_id": 69435408, "body": "Thanks, I&#39;m new to Go so I have no explicit understanding on how to convert things."}, {"owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "edited": false, "score": 1, "creation_date": 1481623301, "post_id": 41115526, "comment_id": 69440304, "body": "consider following the <a href=\"https://tour.golang.org/\" rel=\"nofollow noreferrer\">tour of go</a> which walks through most of the language fairly quickly, including the basics such as how to work with arrays and strings."}], "answers": [{"comments": [{"owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "edited": false, "score": 0, "creation_date": 1481726810, "post_id": 41135010, "comment_id": 69493235, "body": "icza&#39;s link to a similar question has a much more thorough answer giving more details about the json package.  Maybe view this as a simple primer.  I&#39;ll also mention here that there have been questions about how to parse a string when it was not in JSON format and sometimes the easiest Go program to handle it turned out to be writing a parser for the string that just created a new string from it that was in JSON format and then letting the json package do the heavy lifting."}], "tags": [], "owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "is_accepted": false, "score": 3, "last_activity_date": 1481722129, "last_edit_date": 1481722129, "creation_date": 1481690661, "answer_id": 41135010, "question_id": 41115526, "link": "https://stackoverflow.com/questions/41115526/convert-string-to-array-in-golang/41135010#41135010", "title": "Convert String to Array in Golang", "body": "<p>Go is a strictly typed language so there isn't something like an eval statement that turns data into code directly.  In this case that you asked about, seeing that your list of lists is in a format compatible with the JSON format, I thought of using the JSON package to do the parsing.  So it takes only three lines of code, defining the type of data that is expected, creating the decoder from the string, and applying the decoder to the data type.  The fact that Go is strictly typed but supports reflection (which you won't see in this code) is what took me a little time to get used to.  Reflection is what makes the third line possible and why the first line defines the variable as a list of lists ([][]int).</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"strings\"\n)\n\n// Prints:\n// &lt;nil&gt; [[0 1] [0 2] [0 3]]\n// 0 0 0\n// 0 1 1\n// 1 0 0\n// 1 1 2\n// 2 0 0\n// 2 1 3\n\nfunc main() {\n    jsonstring := \"[[0, 1], [0, 2], [0,3 ]]\"\n    var listoflists [][]int\n    dec := json.NewDecoder(strings.NewReader(jsonstring))\n    err := dec.Decode(&amp;listoflists)\n    fmt.Println(err, listoflists)\n    for i, list := range listoflists {\n        for j, value := range list {\n            fmt.Println(i, j, value)\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 142, "user_id": 3898735, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zcvJv.gif?s=128&g=1", "display_name": "gentlyawesome", "link": "https://stackoverflow.com/users/3898735/gentlyawesome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9596, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1481722129, "creation_date": 1481613498, "question_id": 41115526, "link": "https://stackoverflow.com/questions/41115526/convert-string-to-array-in-golang", "title": "Convert String to Array in Golang", "body": "<p>I have a string that is from an text file. I was able to get it via 'io/ioutil' it contains the following text:</p>\n\n<pre><code>\"[[0, 1], [0, 2], [0,3 ]]\"\n</code></pre>\n\n<p>How do I convert this string to an array that I can use in a for loop?</p>\n"}, {"tags": ["json", "go", "struct"], "comments": [{"owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "edited": false, "score": 1, "creation_date": 1481611725, "post_id": 41115055, "comment_id": 69434349, "body": "Please make sure to post the actual failing code in the future. The error message also does not match your code sample.  Your problem is that you are appending a pointer value to a slice of structs. Either change the slice definition to be a <code>[]*Struct2</code>, or dereference the pointer as in <code>x.Attack_resources = append(x.Attack_resources, *struct2)</code>.  Note that snake_case is generally not encouraged  in go."}], "answers": [{"tags": [], "owner": {"reputation": 6079, "user_id": 907186, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/409d9fd7356a2876a35dcd461713d749?s=128&d=identicon&r=PG", "display_name": "daltonclaybrook", "link": "https://stackoverflow.com/users/907186/daltonclaybrook"}, "is_accepted": true, "score": 0, "last_activity_date": 1481612812, "creation_date": 1481612812, "answer_id": 41115366, "question_id": 41115055, "link": "https://stackoverflow.com/questions/41115055/how-to-initialize-the-struct-of-following-structure-in-golang/41115366#41115366", "title": "how to initialize the struct of following structure in golang", "body": "<p>You can initialize a struct value using:</p>\n\n<pre><code>resource := struct2{}\n</code></pre>\n\n<p>As @nothingmuch pointed out, if you have a struct pointer and need the underlying value, you can dereference the pointer using:</p>\n\n<pre><code>deref := *resource\n</code></pre>\n"}], "owner": {"reputation": 263, "user_id": 7184004, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7fe4abb3ae5ee09e1f63d04d549746c3?s=128&d=identicon&r=PG&f=1", "display_name": "Aishwarya", "link": "https://stackoverflow.com/users/7184004/aishwarya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 572, "favorite_count": 0, "accepted_answer_id": 41115366, "answer_count": 1, "score": -1, "last_activity_date": 1481612812, "creation_date": 1481611338, "question_id": 41115055, "link": "https://stackoverflow.com/questions/41115055/how-to-initialize-the-struct-of-following-structure-in-golang", "title": "how to initialize the struct of following structure in golang", "body": "<p>I have the following data structure. I need to initialize it without using nested initialization. This data structure will be flushed to output a json file later.</p>\n\n<pre><code>type GeneratePlan struct{\n    Mode    string `json:\"mode\"`\n    Name    string `json:\"name\"`\n    Schema  string `json:\"schema\"`\n    Version string `json:\"version\"`\n    Attack_plans []struct1 `json:\"attack-plans\"`\n\n} \n\ntype struct1 struct {\n    Attack_plan Attack_plan `json:\"attack-plan\"`\n}\n\n\ntype Attack_plan struct{\n    Attack_resouces []struct2 `json:\"attack-resources\"`\n}\n\ntype struct2 struct {\n    Attack_resource Attack_resource `json:\"attack-resource\"`\n}\n</code></pre>\n\n<p>Problem is when I try to append the variable of type struct2 to the Attack_resources[] slice, it gives the error as</p>\n\n<pre><code>cannot use struct2 (type *structs.Struct2) as type structs.Struct2 in append\n</code></pre>\n\n<p>How can we initialize the struct without using new or any ptr? As, if we use any of the standard struct initialization technique, it will give the above error.\nIf I change the above data structure and make it hold a pointer to another struct, it doesn't store the values correctly. I am very new to golang. Any help is appreciated. Thanks in advance!</p>\n"}, {"tags": ["intellij-idea", "go"], "comments": [{"owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "edited": false, "score": 0, "creation_date": 1481612020, "post_id": 41114683, "comment_id": 69434473, "body": "fmt.Println prints bytes to a the stdout descriptor, so the only way to refer back to the file would be to print the file and line number in addition to the other text. You can <a href=\"https://stackoverflow.com/questions/35212985/is-it-possible-get-information-about-caller-function-in-golang\">find these by examining the call stack</a> and add the to the message in a format that idea understands."}], "answers": [{"tags": [], "owner": {"reputation": 964, "user_id": 3184079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/819c77c230e755f43bfbbbb87429c046?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/3184079/omar"}, "is_accepted": true, "score": 3, "last_activity_date": 1481617347, "last_edit_date": 1481617347, "creation_date": 1481614817, "answer_id": 41115822, "question_id": 41114683, "link": "https://stackoverflow.com/questions/41114683/idea-intellij-how-to-navigate-to-line-from-consoles-print-statement/41115822#41115822", "title": "Idea Intellij how to navigate to line from console&#39;s print statement", "body": "<p>I'd recommend looking into the log package.\n<a href=\"https://golang.org/pkg/log/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/log/</a></p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n)\n\nfunc main() {\n    log.SetFlags(log.Lshortfile)\n    log.Println(\"Hello world\") // main.go:9: Hello world\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/lQGW6P10fs\" rel=\"nofollow noreferrer\">https://play.golang.org/p/lQGW6P10fs</a></p>\n"}, {"tags": [], "owner": {"reputation": 416, "user_id": 8606979, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MLyvM.jpg?s=128&g=1", "display_name": "sadeghpro", "link": "https://stackoverflow.com/users/8606979/sadeghpro"}, "is_accepted": false, "score": 0, "last_activity_date": 1549278543, "last_edit_date": 1549278543, "creation_date": 1537881858, "answer_id": 52499325, "question_id": 41114683, "link": "https://stackoverflow.com/questions/41114683/idea-intellij-how-to-navigate-to-line-from-consoles-print-statement/52499325#52499325", "title": "Idea Intellij how to navigate to line from console&#39;s print statement", "body": "<p>I know it's late but maybe help others</p>\n\n<p>you can use <code>function, file, line, ok := runtime.Caller(1)</code> to get where is the runtime, for example, you can use <a href=\"https://github.com/sadeghpro/GoToError\" rel=\"nofollow noreferrer\">this</a> project for your error</p>\n"}], "owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 41115822, "answer_count": 2, "score": 0, "last_activity_date": 1549278543, "creation_date": 1481609500, "question_id": 41114683, "link": "https://stackoverflow.com/questions/41114683/idea-intellij-how-to-navigate-to-line-from-consoles-print-statement", "title": "Idea Intellij how to navigate to line from console&#39;s print statement", "body": "<p>There are various fmt.Println statements in my golang project which I run through Idea IntelliJ version 2016.3. Is there any way I navigate to the code from console's printed statements? I want know what code is printing the line [rinted on console.</p>\n"}, {"tags": ["javascript", "email", "canvas", "go", "email-attachments"], "comments": [{"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1481606953, "post_id": 41113598, "comment_id": 69432717, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/34790771/how-do-i-insert-an-image-into-email-body\">How do I Insert an image into email body?</a>"}, {"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1481607016, "post_id": 41113598, "comment_id": 69432732, "body": "Is <code>t.Test</code> the image or the filename ?"}, {"owner": {"reputation": 7204, "user_id": 4333347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b091d5e3973e6f65ec16442c3b1b16b?s=128&d=identicon&r=PG", "display_name": "buydadip", "link": "https://stackoverflow.com/users/4333347/buydadip"}, "reply_to_user": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1481640876, "post_id": 41113598, "comment_id": 69451957, "body": "@JohnSPerayil it is the image itself I believe"}, {"owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 0, "creation_date": 1481662285, "post_id": 41113598, "comment_id": 69464758, "body": "@Bolboa what do you get when you print <code>t.Test</code>?"}, {"owner": {"reputation": 7204, "user_id": 4333347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b091d5e3973e6f65ec16442c3b1b16b?s=128&d=identicon&r=PG", "display_name": "buydadip", "link": "https://stackoverflow.com/users/4333347/buydadip"}, "reply_to_user": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 0, "creation_date": 1481682568, "post_id": 41113598, "comment_id": 69471729, "body": "@Motakjuq Its a very long string of numbers and letter. Way to long to paste here. Also I edited my answer to show how I save it."}, {"owner": {"reputation": 7204, "user_id": 4333347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b091d5e3973e6f65ec16442c3b1b16b?s=128&d=identicon&r=PG", "display_name": "buydadip", "link": "https://stackoverflow.com/users/4333347/buydadip"}, "reply_to_user": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1481682841, "post_id": 41113598, "comment_id": 69471799, "body": "@JohnSPerayil I don&#39;t believe it is a duplicate as I have already tried those answers to no avail."}], "answers": [{"comments": [{"owner": {"reputation": 7204, "user_id": 4333347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b091d5e3973e6f65ec16442c3b1b16b?s=128&d=identicon&r=PG", "display_name": "buydadip", "link": "https://stackoverflow.com/users/4333347/buydadip"}, "edited": false, "score": 0, "creation_date": 1481684424, "post_id": 41116844, "comment_id": 69472170, "body": "I tried convert <code>t.Test</code> to <code>[]byte(t.Test)</code> and then using your method...but its prints out the entire byte array as the image source"}, {"owner": {"reputation": 7204, "user_id": 4333347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b091d5e3973e6f65ec16442c3b1b16b?s=128&d=identicon&r=PG", "display_name": "buydadip", "link": "https://stackoverflow.com/users/4333347/buydadip"}, "edited": false, "score": 0, "creation_date": 1481685192, "post_id": 41116844, "comment_id": 69472386, "body": "I think the <code>html</code> is not getting rendered. I am seeing the <code>tags</code> not the image itself"}, {"owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "reply_to_user": {"reputation": 7204, "user_id": 4333347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b091d5e3973e6f65ec16442c3b1b16b?s=128&d=identicon&r=PG", "display_name": "buydadip", "link": "https://stackoverflow.com/users/4333347/buydadip"}, "edited": false, "score": 0, "creation_date": 1481688518, "post_id": 41116844, "comment_id": 69473153, "body": "@Bolboa your img format is <code>data:image&#47;png:base64, iVBORw0.....</code>, you only need to replate the <code>:</code> after <code>image&#47;png</code> with a <code>;</code> and use it with <code>fmt.Sprintf(&quot;&lt;img src=\\&quot;%s\\&quot;&#47;&gt;&quot;, yourImageEncoded)</code>"}, {"owner": {"reputation": 7204, "user_id": 4333347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b091d5e3973e6f65ec16442c3b1b16b?s=128&d=identicon&r=PG", "display_name": "buydadip", "link": "https://stackoverflow.com/users/4333347/buydadip"}, "edited": false, "score": 0, "creation_date": 1481690639, "post_id": 41116844, "comment_id": 69473613, "body": "it still isn&#39;t rendering the image. I must be doing something wrong. I&#39;m sending the string in json format to the go server. On receipt I decode it as shown above. Then I place it in my <code>src</code> as you said. But it does not read the <code>src</code> because the image is blank. ( I replaced the <code>:</code> too)"}, {"owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "reply_to_user": {"reputation": 7204, "user_id": 4333347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b091d5e3973e6f65ec16442c3b1b16b?s=128&d=identicon&r=PG", "display_name": "buydadip", "link": "https://stackoverflow.com/users/4333347/buydadip"}, "edited": false, "score": 0, "creation_date": 1481693879, "post_id": 41116844, "comment_id": 69474608, "body": "@bolboa check the example"}], "tags": [], "owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "is_accepted": true, "score": 2, "last_activity_date": 1481693844, "last_edit_date": 1481693844, "creation_date": 1481618820, "answer_id": 41116844, "question_id": 41113598, "link": "https://stackoverflow.com/questions/41113598/how-to-add-image-to-html-body-of-an-email-go/41116844#41116844", "title": "How to add image to html body of an email (Go)", "body": "<p>First of all, check if the data in t.Test is correct (if contains the filename, path, or whatever you need to reference the image)</p>\n\n<p>Well, you have some options, first, if it's ok just attaching the image, you only should do:</p>\n\n<pre><code>mail.Attach(\"/path/of/your/image/image.png\")\n</code></pre>\n\n<p>But, if you need to use the image in the message, you have some alternatives.</p>\n\n<p>Alt 1: Use <code>Embed</code> method</p>\n\n<p>You must to have the image in your filesystem, because the method is defined in that way. You have to do something like:</p>\n\n<pre><code>mail.SetBody(\"text/html\", \"Image &lt;img src=\\\"cid:tux.png\\\"/&gt;\")\nmail.Embed(\"/path/of/your/image/tux.png\")\n</code></pre>\n\n<p>You must to use the image name, in this case <code>tux.png</code>, when you add it in the html body with the <code>img</code> tag, you have to define the <code>src</code> like <code>cid:tux.png</code></p>\n\n<p>Alt 2: Use a base64 encoding</p>\n\n<p>For this you need to know the mime type of the image file, in my example is a png file, so the mime is <code>image/png</code>. Also, you have to encode the image as base64.</p>\n\n<pre><code>img, err := ioutil.ReadFile(\"/path/of/your/image/tux.png\")\nif err != nil {\n    // check errors\n}\nout := base64.StdEncoding.EncodeToString(img)\n</code></pre>\n\n<p>Or, if you don't have the image in the filesystem, but you have it in a variable (<code>[]byte</code> type), you can use it with <code>EncodeToString</code></p>\n\n<pre><code>var imageData []byte\n// in some part, you load the image data into imageData\nout := base64.StdEncoding.EncodeToString(imageData)\n</code></pre>\n\n<p>And you use it like</p>\n\n<pre><code>mail.SetBody(\"text/html\", fmt.Sprintf(\"Image &lt;img src=\\\"data:image/png;base64,%s\\\"/&gt;\", out))\n</code></pre>\n\n<p>So, when you use <code>img</code>, you have to set in <code>src</code> an embedded image with <code>data:mime_type;base64,image_encoded_base64</code>, if we look the example, is <code>data:image/png;base64,iVBORw0K...</code></p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I created an example with the JSON request and the handler <a href=\"https://gist.github.com/Motakjuq/9b403498b042a037e0d1e43c06a53263\" rel=\"nofollow noreferrer\">Example</a></p>\n"}], "owner": {"reputation": 7204, "user_id": 4333347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b091d5e3973e6f65ec16442c3b1b16b?s=128&d=identicon&r=PG", "display_name": "buydadip", "link": "https://stackoverflow.com/users/4333347/buydadip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1942, "favorite_count": 0, "accepted_answer_id": 41116844, "answer_count": 1, "score": 2, "last_activity_date": 1481693844, "creation_date": 1481602249, "last_edit_date": 1481683435, "question_id": 41113598, "link": "https://stackoverflow.com/questions/41113598/how-to-add-image-to-html-body-of-an-email-go", "title": "How to add image to html body of an email (Go)", "body": "<p>I am using <a href=\"https://github.com/go-gomail/gomail\" rel=\"nofollow noreferrer\">Gomail</a></p>\n\n<p>I am attempting to send an email to myself. I have figured out how to do so, but now I want to add an image, either in the html body or as an attachment (does not really matter). I just need to be able to see the image in my email.</p>\n\n<p>First off, I am sending the <code>img</code> <code>src</code> through a <code>POST</code> request, which I then save into the following <code>struct</code>...</p>\n\n<pre><code>type test_struct struct {\n    Test string `json:\"image\"`\n}\n</code></pre>\n\n<p>I then try to attach it in the email body like so...</p>\n\n<pre><code>mail := gomail.NewMessage()\nmail.SetHeader(\"From\", \"XXXX@gmail.com\")\nmail.SetHeader(\"To\", \"XXXX@gmail.com\")\nmail.SetHeader(\"Subject\", \"IMAGE!\")\n\nmail.SetBody(\"text/html\", `&lt;img src=\"cid:t.Test\" alt=\"My Image\"/&gt;`)\n</code></pre>\n\n<p>this did not work, so I tried to use <a href=\"https://godoc.org/gopkg.in/gomail.v2#Message.Embed\" rel=\"nofollow noreferrer\">Embed method</a>...</p>\n\n<pre><code>mail.Embed(t.Test)\n</code></pre>\n\n<p>This gave me a blank image with the error the filename or extension is too long. Not sure if this is important, but note that the <code>src</code> I got is from <code>HTML5</code> Canvas. I got the source of the image from Canvas...</p>\n\n<pre><code>localCanvas.toDataURL('image/png');\n</code></pre>\n\n<p>And this is the value I save in <code>t.Test</code>...</p>\n\n<pre><code>buf, err := ioutil.ReadAll(req.Body)\nreader := bytes.NewReader(buf)\n\nvar t test_struct\n\nerr = json.NewDecoder(reader).Decode(&amp;t)\n</code></pre>\n\n<p>The string being save in the <code>t.Test</code> is of the following format...</p>\n\n<pre><code>data:image/png:base64, iVBORw0KGgoAAAANSUhEUgAAAoAAAAHgCAYAAAA10dzkAAAgA...\n</code></pre>\n\n<p>How can I send this to my email? The documentation only gets me so far.</p>\n"}, {"tags": ["linux", "go", "usb", "hardware"], "comments": [{"owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "edited": false, "score": 0, "creation_date": 1481669284, "post_id": 41113388, "comment_id": 69468048, "body": "What is the exact error message you get when you run your program?"}, {"owner": {"reputation": 482, "user_id": 2425491, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8ae984fbdd00145a099890523538c5ac?s=128&d=identicon&r=PG", "display_name": "VsM", "link": "https://stackoverflow.com/users/2425491/vsm"}, "reply_to_user": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "edited": false, "score": 0, "creation_date": 1481681739, "post_id": 41113388, "comment_id": 69471515, "body": "just added it!    Basically, it can write, then can not read anything and then times out"}, {"owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "edited": false, "score": 0, "creation_date": 1481682660, "post_id": 41113388, "comment_id": 69471758, "body": "I think the real problem is that you read zero bytes on the first run of the program.  If you can fix that, then the write timeout on the second run will probably go away.  I suspect the device is waiting for you to read the response to your command before it processes any more commands from you.  I am not sure why the read would fail.  Perhaps it is actually a non-blocking read?  Can you try delaying for, say, 100 ms before issuing the read?  What about doing a few reads in a row with 100 ms of delay between then?"}, {"owner": {"reputation": 482, "user_id": 2425491, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8ae984fbdd00145a099890523538c5ac?s=128&d=identicon&r=PG", "display_name": "VsM", "link": "https://stackoverflow.com/users/2425491/vsm"}, "reply_to_user": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "edited": false, "score": 0, "creation_date": 1481714589, "post_id": 41113388, "comment_id": 69485229, "body": "I just added 1s sleep between the write and the read, but same issue. I also tried a loop read with 1s interval, always reads 0 byte. I&#39;m wondering if I should try to go towards HID libs to check if it works better. I will give it a try, I don&#39;t have many ideas left."}], "owner": {"reputation": 482, "user_id": 2425491, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8ae984fbdd00145a099890523538c5ac?s=128&d=identicon&r=PG", "display_name": "VsM", "link": "https://stackoverflow.com/users/2425491/vsm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3860, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1482117217, "creation_date": 1481600560, "last_edit_date": 1482117217, "question_id": 41113388, "link": "https://stackoverflow.com/questions/41113388/interacting-with-a-usb-device-in-golang", "title": "interacting with a USB device in Golang", "body": "<p>I am trying to communicate with a USB device (<a href=\"https://rads.stackoverflow.com/amzn/click/com/B0194MNAX8\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">cottonwood RFID reader</a>) with golang under Linux.</p>\n\n<p>Here is where I am so far:</p>\n\n<ol>\n<li><p>My computer sees the hardware: I see the device in my <code>/dev/bus/usb</code></p></li>\n<li><p>The hardware works fine: the demo software they provide works seemlessly (under windows, they don't have a Linux version)</p></li>\n<li><p>It seems I can open the endpoints</p></li>\n<li><p>It seems I can write to the device</p></li>\n</ol>\n\n<p>Now, when I try to read from thehardware, I always get a timeout. I'm a total beginner on hardware, any help would be greatly appreciated, maybe the issue is actually very basic.</p>\n\n<p>My very simple codebase is here: </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"strconv\"\n\n    \"github.com/jpoirier/gousb/usb\"\n)\n\nfunc main() {\n    // Only one context should be needed for an application.  It should always be closed.\n    ctx := usb.NewContext()\n    defer func() {\n        errCl := ctx.Close()\n        if errCl != nil {\n            log.Fatal(errCl)\n        }\n    }()\n\n    ctx.Debug(1)\n\n    // ListDevices is used to find the devices to open.\n    devs, err := ctx.ListDevices(\n        func(desc *usb.Descriptor) bool {\n            if desc.Vendor == GetCottonwoodVendor() &amp;&amp; desc.Product == GetCottonwoodProduct() {\n                return true\n            }\n            return false\n        })\n\n    // All Devices returned from ListDevices must be closed.\n    defer func() {\n        for _, dev := range devs {\n            errCl := dev.Close()\n            if errCl != nil {\n                log.Fatal(errCl)\n            }\n        }\n    }()\n\n    // ListDevices can occasionally  fail, so be sure to check its return value.\n    if err != nil {\n        log.Fatalf(\"list: %s\", err)\n    }\n\nfor _, dev := range devs {\n    // Once the device has been selected from ListDevices, it is opened\n    // and can be interacted with.\n    // Open up two ep for read and write\n\n    epBulkWrite, err := dev.OpenEndpoint(1, 0, 0, 2|uint8(usb.ENDPOINT_DIR_OUT))\n    if err != nil {\n        log.Fatalf(\"OpenEndpoint Write error for %v: %v\", dev.Address, err)\n    }\n\n    // Poll Firmware/Hardware Version ID\n\n    // AntennaOn\n    // outAntennaPowerOnCmd := []byte{0x18, 0x03, 0xFF}\n    outFirmIdCmd := []byte{0x10, 0x03, 0x00}\n    // outHardIdCmd := []byte{0x10, 0x03, 0x01}\n\n    i, err := epBulkWrite.Write(outFirmIdCmd)\n    if err != nil {\n        log.Fatalf(\"Cannot write command: %v\\n\", err)\n    }\n    log.Printf(\"%v bytes sent\", i)\n\n    time.Sleep(1 * time.Second)\n\n    epBulkRead, err := dev.OpenEndpoint(1, 0, 0, 1|uint8(usb.ENDPOINT_DIR_IN))\n    if err != nil {\n        log.Fatalf(\"OpenEndpoint Read error for %v: %v\", dev.Address, err)\n    }\n\n    readBuffer := make([]byte, 64)\n    n, errRead := epBulkRead.Read(readBuffer)\n    log.Printf(\"read %d bytes: %v\", n, readBuffer)\n    if errRead != nil {\n        log.Printf(\"error reading: %v\", errRead)\n        break\n    }\n}\n\n// GetCottonwoodVendor returns the vendor ID of cottonwood UHF reader\nfunc GetCottonwoodVendor() usb.ID {\n    value, err := strconv.ParseUint(\"1325\", 16, 16)\n    if err != nil {\n        log.Fatal(err)\n    }\n    return usb.ID(value)\n}\n\n// GetCottonwoodProduct returns the product ID of cottonwood UHF reader\nfunc GetCottonwoodProduct() usb.ID {\n    value, err := strconv.ParseUint(\"c029\", 16, 16)\n    if err != nil {\n        log.Fatal(err)\n    }\n    return usb.ID(value)\n}\n</code></pre>\n\n<p>First time I launch it, I get:</p>\n\n<pre><code>2016/12/14 19:19:18 3 bytes sent\n2016/12/14 19:19:20 read 0 bytes: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]\n2016/12/14 19:19:20 error reading: libusb: timeout [code -7]\n</code></pre>\n\n<p>Second time and all after:</p>\n\n<pre><code>2016/12/14 19:21:21 Cannot write command: libusb: timeout [code -7]\n</code></pre>\n\n<p>I tried with another library using hidraw, but it seems not to work either (probably detach usb device issue).</p>\n"}, {"tags": ["go", "rethinkdb", "rethinkdb-go", "gorethink"], "comments": [{"owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "edited": false, "score": 2, "creation_date": 1481591251, "post_id": 41112155, "comment_id": 69428803, "body": "I&#39;m no rethinkdb expert, but it seems to me like you&#39;re using the map function on a single object, but it is designed to work on each element of sequences, which is an ordered collection. This is just a guess, but I think you want <code>row.Field(&quot;user&quot;).Field(&quot;email&quot;)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 27333, "user_id": 309343, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0af367dc4d144a1580cac9500a29f16f?s=128&d=identicon&r=PG", "display_name": "Moon", "link": "https://stackoverflow.com/users/309343/moon"}, "is_accepted": false, "score": 1, "last_activity_date": 1481603449, "creation_date": 1481603449, "answer_id": 41113754, "question_id": 41112155, "link": "https://stackoverflow.com/questions/41112155/unable-to-run-filter-on-rethinkdb-in-golang/41113754#41113754", "title": "Unable to run filter on RethinkDB in Golang", "body": "<p>Basically, here is what I needed to do:</p>\n\n<pre><code>result, err = db.Table(\"unverified_requests\").Filter(func(uu r.Term) r.Term {\n    return uu.Field(\"user\").Field(\"email\").Eq(email)\n}).Run(session)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 491, "user_id": 4699030, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PtpXlAvuawc/AAAAAAAAAAI/AAAAAAAABgA/eeoUql28GSs/photo.jpg?sz=128", "display_name": "Juan Carlos Garcia", "link": "https://stackoverflow.com/users/4699030/juan-carlos-garcia"}, "is_accepted": false, "score": 0, "last_activity_date": 1481608578, "last_edit_date": 1481608578, "creation_date": 1481603812, "answer_id": 41113816, "question_id": 41112155, "link": "https://stackoverflow.com/questions/41112155/unable-to-run-filter-on-rethinkdb-in-golang/41113816#41113816", "title": "Unable to run filter on RethinkDB in Golang", "body": "<p>You're trying to map over a single object. Maybe this would work:</p>\n\n<pre><code>db.Table(\"unverified_requests\").Filter(r.Row.Field(\"user\").Field(\"email\").Eq(email)).Run(session)\n</code></pre>\n"}], "owner": {"reputation": 27333, "user_id": 309343, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0af367dc4d144a1580cac9500a29f16f?s=128&d=identicon&r=PG", "display_name": "Moon", "link": "https://stackoverflow.com/users/309343/moon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 633, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1506685921, "creation_date": 1481590795, "last_edit_date": 1506685921, "question_id": 41112155, "link": "https://stackoverflow.com/questions/41112155/unable-to-run-filter-on-rethinkdb-in-golang", "title": "Unable to run filter on RethinkDB in Golang", "body": "<p>I am trying to run a filter on a nested property of RethinkDB data in Golang using <code>GoRethink</code> library.</p>\n\n<p>But, I am getting this error:</p>\n\n<blockquote>\n  <p>gorethink: Cannot convert OBJECT to SEQUENCE in: r.DB(\"uc_dev\").Table(\"unverified_requests\").Filter(func(var_\u200c\u200b5 r.Term) r.Term { return var_5.Field(\"user\").Map(func(var_6 r.Term) r.Term { return var_6.Field(\"email\") }).Eq(\"myemail@gmail.com\") })</p>\n</blockquote>\n\n<p>Here is my code:</p>\n\n<pre><code>type User struct {\n    Id        string `json:\"id,omitempty\"`\n    FirstName string `json:\"firstName,omitempty\"`\n    LastName  string `json:\"lastName,omitempty\"`\n    Email     string `json:\"email,omitempty\"`\n    Password  string `json:\"password,omitempty\"`\n    Salt      string `json:\"salt,omitempty\"`\n}\n\ntype UnverifiedUserRequest struct {\n    Id    string `json:\"id,omitempty\"`\n    Token string `json:\"token,omitempty\"`\n    User  User   `json:\"user,omitempty\"`\n}\n\ndb.Table(\"unverified_requests\").Filter(func(row r.Term) r.Term {\n    return row.Field(\"user\").Map(func(user r.Term) r.Term {\n        return user.Field(\"email\")\n    }).Eq(email)\n}).Run(session)\n</code></pre>\n"}, {"tags": ["json", "go", "websocket"], "answers": [{"comments": [{"owner": {"reputation": 327, "user_id": 6878109, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0203bee52f4e9266945f07732403a43a?s=128&d=identicon&r=PG&f=1", "display_name": "billyzaelani", "link": "https://stackoverflow.com/users/6878109/billyzaelani"}, "edited": false, "score": 0, "creation_date": 1481590886, "post_id": 41112050, "comment_id": 69428684, "body": "Thankyou for your quick answer, that&#39;s really helping me. The solution is in the <code>encoding&#47;json</code> and i realize i need to read more before asking, Thankyou once again."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1481590151, "creation_date": 1481590151, "answer_id": 41112050, "question_id": 41111932, "link": "https://stackoverflow.com/questions/41111932/go-websocket-serialization-deserialization-json/41112050#41112050", "title": "Go websocket serialization/deserialization json", "body": "<p>Use <a href=\"https://godoc.org/encoding/json#RawMessage\" rel=\"nofollow noreferrer\">RawMessage</a>.</p>\n\n<pre><code>type Messages struct {\n  Control string `json:\"control\"`\n  X json.RawMessage\n}\n\nvar m Messages\nerr := c.ReadJSON(&amp;m)\nif err != nil {\n    // handle error\n}\nswitch m.Control {\ncase \"Foo\":\n    var foo Foo\n    if err := json.Unmarshal([]byte(m.X), &amp;foo); err != nil {\n       // handle error\n    }\n    // do something with foo\n\ncase \"Bar\":\n   ... follow pattern for Foo\n\n}\n</code></pre>\n"}], "owner": {"reputation": 327, "user_id": 6878109, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0203bee52f4e9266945f07732403a43a?s=128&d=identicon&r=PG&f=1", "display_name": "billyzaelani", "link": "https://stackoverflow.com/users/6878109/billyzaelani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 463, "favorite_count": 0, "accepted_answer_id": 41112050, "answer_count": 1, "score": 0, "last_activity_date": 1481590189, "creation_date": 1481589161, "last_edit_date": 1481590189, "question_id": 41111932, "link": "https://stackoverflow.com/questions/41111932/go-websocket-serialization-deserialization-json", "title": "Go websocket serialization/deserialization json", "body": "<p>I'm using <a href=\"http://www.gorillatoolkit.org/pkg/websocket\" rel=\"nofollow noreferrer\">gorilla</a> websocket, and i'm planing using json for serialization/deserialization.</p>\n\n<p>Let say i have struct like this for receive the incoming messages:</p>\n\n<pre><code>type Foo struct {\n    A string `json:\"a\"`\n    B string `json:\"b\"`\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>type Bar struct {\n    C string `json:\"c\"`\n    D string `json:\"d\"`\n}\n</code></pre>\n\n<p>gorilla provide <code>conn.ReadJSON</code> for receive incoming messages. The incoming messages can be Foo or Bar but i can't use <code>conn.ReadJSON(Foo)</code> and listen for other <code>conn.ReadJSON(Bar)</code>, it's a mess. I want something like just <code>conn.ReadJSON(Messages)</code>, like <code>JSON.parse()</code> in javascript. How to handle incoming messages if Foo is received, then it stored into <code>Foo</code> struct, and if Bar is received then it stored into <code>Bar</code> struct ?</p>\n\n<p>I'm thingking the solution is using this struct:</p>\n\n<pre><code>type Messages struct {\n    Control string `json:\"control\"`\n    X // Data type for either Foo or Bar struct\n}\n</code></pre>\n\n<p>The incoming messages now have json control, value of control can be Foo or Bar. Using <code>if else</code> if control==Foo then <code>X</code> is assign to Foo, else <code>X</code> is assign to Bar. But i can't figured the data type for <code>X</code>.</p>\n\n<p>Any sollution is welcome, thankyou.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 364, "user_id": 3361109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494e91579143e9af4c0ee535de88b6e5?s=128&d=identicon&r=PG", "display_name": "Hemel", "link": "https://stackoverflow.com/users/3361109/hemel"}, "edited": false, "score": 2, "creation_date": 1481585926, "post_id": 41111354, "comment_id": 69427426, "body": "Looks fine to me."}, {"owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "edited": false, "score": 0, "creation_date": 1481611375, "post_id": 41111354, "comment_id": 69434223, "body": "M2 is only the name of the lexical variable in that scope. By the time the value is in the Top structure, there is no trace of where the value came from, and even if there was, that&#39;d just be a pointer address at best, as Go does not have a mechanism for introspecting lexical scopes. If you really need &quot;M2&quot; instead of &quot;A2&quot; (which you can get by <a href=\"https://stackoverflow.com/questions/24337145/get-name-of-struct-field-using-reflection\">reflecting the type</a>), you can use something like a <code>map[*Mid]string</code> and assign <code>m[&amp;T.A2] = &quot;M2&quot;</code> to keep track of these yourself."}], "owner": {"reputation": 165, "user_id": 4150729, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/1492722699/picture?type=large", "display_name": "Nik Kunkel", "link": "https://stackoverflow.com/users/4150729/nik-kunkel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 722, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1481588574, "creation_date": 1481585018, "last_edit_date": 1481588574, "question_id": 41111354, "link": "https://stackoverflow.com/questions/41111354/how-to-loop-through-struct-containing-fields-of-the-same-type-in-golang", "title": "How to loop through struct containing fields of the same type in Golang?", "body": "<p>I want to test the fields in a struct returned from a web API.\nTo do this I need to iterate over the fields in the struct instance Top.\nHow do I do this? </p>\n\n<p>My struct looks like this:</p>\n\n<pre><code>type Top struct {\n    A1 Mid,\n    A2 Mid,\n    A3 Mid,\n}\n\ntype Mid struct {\n   B1 string,\n   B2 int64,\n   B3 float64\n}\n</code></pre>\n\n<p>My intuition is to do something like this:</p>\n\n<pre><code>M1 := Mid{\"a\", 1, 1.9}\nM2 := Mid{\"b\", 2, 3.8}\nM3 := Mid{\"c\", 3, 5.7}\n\nT := Top{M1, M2, M3}\nS := reflect.ValueOf(&amp;T).Elem()\nfor i := 0; i &lt; S.NumField(); i++ {\n    m := S.Field(i)\n    verifyValuesOfMid(&amp;m)\n}\n</code></pre>\n\n<p>This works. But now I have a different problem. Let's say I find an instance of Mid in Top T that is invalid. I want to print out the name of that instance (M2). Is there a way to do this?</p>\n"}, {"tags": ["go", "server", "graphql"], "comments": [{"owner": {"reputation": 225, "user_id": 4281350, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b055dc1d5abb73b783551400dfd03e0?s=128&d=identicon&r=PG&f=1", "display_name": "OsYYYY", "link": "https://stackoverflow.com/users/4281350/osyyyy"}, "edited": false, "score": 0, "creation_date": 1519384231, "post_id": 41110968, "comment_id": 84899288, "body": "I made a simple starter making use of neelance/graphql-go. You could take reference to it : <a href=\"https://github.com/OscarYuen/go-graphql-starter\" rel=\"nofollow noreferrer\">github.com/OscarYuen/go-graphql-starter</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "is_accepted": false, "score": 4, "last_activity_date": 1481584461, "creation_date": 1481584461, "answer_id": 41111258, "question_id": 41110968, "link": "https://stackoverflow.com/questions/41110968/simple-golang-graphql-server/41111258#41111258", "title": "Simple Golang GraphQL Server", "body": "<p>The most stared project is <a href=\"https://github.com/graphql-go/graphql\" rel=\"noreferrer\">https://github.com/graphql-go/graphql</a> but it seems to be not actively developed.</p>\n\n<p>I've been keeping an eye to this implementation that looks promising:<a href=\"https://github.com/neelance/graphql-go\" rel=\"noreferrer\">https://github.com/neelance/graphql-go</a></p>\n\n<p>a new repo that I still need to check: <a href=\"https://github.com/playlyfe/go-graphql\" rel=\"noreferrer\">https://github.com/playlyfe/go-graphql</a></p>\n"}, {"comments": [{"owner": {"reputation": 2284, "user_id": 1848376, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/lQaYC.jpg?s=128&g=1", "display_name": "julestruong", "link": "https://stackoverflow.com/users/1848376/julestruong"}, "edited": false, "score": 0, "creation_date": 1508597000, "post_id": 43036467, "comment_id": 80676277, "body": "can you show us some code ? repo ?"}], "tags": [], "owner": {"reputation": 622, "user_id": 860603, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/171e00a2a5873654f81fc38edfd8b7d8?s=128&d=identicon&r=PG", "display_name": "Perspective", "link": "https://stackoverflow.com/users/860603/perspective"}, "is_accepted": true, "score": 6, "last_activity_date": 1490577189, "creation_date": 1490577189, "answer_id": 43036467, "question_id": 41110968, "link": "https://stackoverflow.com/questions/41110968/simple-golang-graphql-server/43036467#43036467", "title": "Simple Golang GraphQL Server", "body": "<p>I've actually spent a bit of time this weekend creating a golang graphql server for a presentation upcoming this week, that has nothing to do with golang graphql. I don't know any golang, and never put together a server, I also threw in Neo4j, it's been an adventure, the <code>hello world</code> example is the following;</p>\n\n<p><a href=\"https://github.com/graphql-go/graphql/blob/master/examples/hello-world/main.go\" rel=\"noreferrer\">https://github.com/graphql-go/graphql/blob/master/examples/hello-world/main.go</a></p>\n\n<p>In addition I used <code>graphql-go/handler</code> to create an endpoint;</p>\n\n<p><a href=\"https://github.com/graphql-go/handler\" rel=\"noreferrer\">https://github.com/graphql-go/handler</a></p>\n\n<p>Finally added <code>graphiql</code> in order to check out my queries;</p>\n\n<p><a href=\"https://github.com/mnmtanish/go-graphiql\" rel=\"noreferrer\">https://github.com/mnmtanish/go-graphiql</a></p>\n\n<p>I started with getting the <code>hello world</code> example to be visible in <code>go-graphiql</code>, but using the <code>handler</code> to expose the schema.</p>\n"}], "owner": {"reputation": 123, "user_id": 6579787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qkiyO.jpg?s=128&g=1", "display_name": "Abdelrahman Abdelhafez", "link": "https://stackoverflow.com/users/6579787/abdelrahman-abdelhafez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4616, "favorite_count": 0, "closed_date": 1494342092, "accepted_answer_id": 43036467, "answer_count": 2, "score": 3, "last_activity_date": 1494341338, "creation_date": 1481582768, "question_id": 41110968, "link": "https://stackoverflow.com/questions/41110968/simple-golang-graphql-server", "closed_reason": "Not suitable for this site", "title": "Simple Golang GraphQL Server", "body": "<p>Does a simple &amp; working \"Hello World!\" GraphQL server code in Go exist?</p>\n\n<p>There is a deficiency in tutorials concerning that topic, especially because <code>graphql-go/graphql</code> is currently a work-in-progress.</p>\n"}, {"tags": ["go", "docker", "containers"], "comments": [{"owner": {"reputation": 18224, "user_id": 406987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8865b16d4f3493cfae865af2b3247fd3?s=128&d=identicon&r=PG", "display_name": "Doon", "link": "https://stackoverflow.com/users/406987/doon"}, "edited": false, "score": 0, "creation_date": 1481582903, "post_id": 41110935, "comment_id": 69426430, "body": "What does your resolv.conf look like.  As you are asking for bare host names it could be that the resolver is taking on your domain name?"}, {"owner": {"reputation": 673, "user_id": 689527, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2df1ee807f389ec59c4f520d79b32134?s=128&d=identicon&r=PG", "display_name": "silentnights", "link": "https://stackoverflow.com/users/689527/silentnights"}, "reply_to_user": {"reputation": 18224, "user_id": 406987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8865b16d4f3493cfae865af2b3247fd3?s=128&d=identicon&r=PG", "display_name": "Doon", "link": "https://stackoverflow.com/users/406987/doon"}, "edited": false, "score": 0, "creation_date": 1481583401, "post_id": 41110935, "comment_id": 69426631, "body": "search fritz.box nameserver 127.0.0.11 options ndots:0"}, {"owner": {"reputation": 18224, "user_id": 406987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8865b16d4f3493cfae865af2b3247fd3?s=128&d=identicon&r=PG", "display_name": "Doon", "link": "https://stackoverflow.com/users/406987/doon"}, "edited": false, "score": 1, "creation_date": 1481583898, "post_id": 41110935, "comment_id": 69426824, "body": "do you have something like pow installed? or does docker intercept."}, {"owner": {"reputation": 673, "user_id": 689527, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2df1ee807f389ec59c4f520d79b32134?s=128&d=identicon&r=PG", "display_name": "silentnights", "link": "https://stackoverflow.com/users/689527/silentnights"}, "reply_to_user": {"reputation": 18224, "user_id": 406987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8865b16d4f3493cfae865af2b3247fd3?s=128&d=identicon&r=PG", "display_name": "Doon", "link": "https://stackoverflow.com/users/406987/doon"}, "edited": false, "score": 0, "creation_date": 1481584051, "post_id": 41110935, "comment_id": 69426871, "body": "@Doon No, I don&#39;t have pow installed. Just bare alpine image."}], "answers": [{"comments": [{"owner": {"reputation": 673, "user_id": 689527, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2df1ee807f389ec59c4f520d79b32134?s=128&d=identicon&r=PG", "display_name": "silentnights", "link": "https://stackoverflow.com/users/689527/silentnights"}, "edited": false, "score": 0, "creation_date": 1481886061, "post_id": 41111438, "comment_id": 69565406, "body": "Sorry for my late response.   The problem is that this is set by router dhcp server, which I have to find a way to change it as there is no where in the router interface to do it.  But again why is it working from the dns tools and not from gethostbyname?"}], "tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": false, "score": 0, "last_activity_date": 1481585522, "creation_date": 1481585522, "answer_id": 41111438, "question_id": 41110935, "link": "https://stackoverflow.com/questions/41110935/golang-net-lookuphost-in-docker-container-return-127-0-53-53/41111438#41111438", "title": "golang net.LookupHost in docker container return 127.0.53.53", "body": "<p><a href=\"https://gtldresult.icann.org/application-result/applicationstatus/applicationdetails/160\" rel=\"nofollow noreferrer\"><code>.box</code> is a real TLD.</a> Don't use it for internal systems.</p>\n\n<p>If you need to give hostnames to local systems, use the <code>.local</code> TLD, which is reserved for this purpose.</p>\n"}, {"tags": [], "owner": {"reputation": 1166, "user_id": 564807, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/vZrqH.jpg?s=128&g=1", "display_name": "xrstf", "link": "https://stackoverflow.com/users/564807/xrstf"}, "is_accepted": false, "score": 1, "last_activity_date": 1489251366, "creation_date": 1489251366, "answer_id": 42737987, "question_id": 41110935, "link": "https://stackoverflow.com/questions/41110935/golang-net-lookuphost-in-docker-container-return-127-0-53-53/42737987#42737987", "title": "golang net.LookupHost in docker container return 127.0.53.53", "body": "<p>I've run into the same issue when using Telegraf.</p>\n\n<p>Unfortunately I don't know the root cause, but I was able to work around the issue by setting <code>--dns-search=.</code> when using <code>docker run</code> or by setting <code>dns_search: .</code> in Docker Compose v1 yaml files:</p>\n\n<pre><code>telegraf:\n  image: telegraf:1.2.1-alpine\n  dns_search: .\n  volumes:\n    - ./telegraf.conf:/etc/telegraf/telegraf.conf:ro\n</code></pre>\n\n<p>See the <a href=\"https://docs.docker.com/engine/userguide/networking/default_network/configure-dns/\" rel=\"nofollow noreferrer\">Docker DNS documentation</a> for details about the <code>--dns-search</code> switch.</p>\n"}], "owner": {"reputation": 673, "user_id": 689527, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2df1ee807f389ec59c4f520d79b32134?s=128&d=identicon&r=PG", "display_name": "silentnights", "link": "https://stackoverflow.com/users/689527/silentnights"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 917, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1489251366, "creation_date": 1481582595, "last_edit_date": 1481583456, "question_id": 41110935, "link": "https://stackoverflow.com/questions/41110935/golang-net-lookuphost-in-docker-container-return-127-0-53-53", "title": "golang net.LookupHost in docker container return 127.0.53.53", "body": "<p>I am writing a small app that should run in a docker container, and should interact with other docker container via its hostname.</p>\n\n<p>I am trying to get the IP Address of the server using net.LookupHost, but I am always getting 127.0.53.53</p>\n\n<p>The weird thing is that I can get the right IP Address using dns tools like dig from the same container. It only does not work from the go program.</p>\n\n<p>Below is the section from my code where I get the IP Address.</p>\n\n<pre><code>zk_server_ips, err := net.LookupHost(\"zookeeper\")\naddrs, err := net.LookupIP(\"testserver\")\nif err != nil {\n    fmt.Fprintf(w, \"Failed to lookup ip address for testserver\")\n    return\n}\nfor _, addr := range addrs {\nif ipv4 := addr.To4(); ipv4 != nil {\n    fmt.Fprintf(w, \"IPv4: %s\", ipv4)\n}\n</code></pre>\n\n<p>I have read a lot that 127.0.53.53 is the way ICANN is telling me that there is something wrong with dsn setup, but I do not know why is it working with dig and drill and not from the go code. !</p>\n\n<p>Also what is the right way to setup the docker containers to resolve hostnames?</p>\n\n<p>The containers are running on Alpine linux image.</p>\n\n<p>Below is my resolv.conf in the container:</p>\n\n<pre><code>search fritz.box\nnameserver 127.0.0.11\noptions ndots:0\n</code></pre>\n"}, {"tags": ["database", "go", "package"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1481577882, "post_id": 41109708, "comment_id": 69424065, "body": "You really should come up with a minimal example which shows your problem. You show much to much complicated code which has no relation to the problem."}], "answers": [{"comments": [{"owner": {"reputation": 2147, "user_id": 1435064, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/YtaeH.jpg?s=128&g=1", "display_name": "Jack Daniel", "link": "https://stackoverflow.com/users/1435064/jack-daniel"}, "edited": false, "score": 0, "creation_date": 1481578174, "post_id": 41109834, "comment_id": 69424205, "body": "so, I must move my GetContracts(or anothers) from entity/contract.go to dbconfig package?"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 2147, "user_id": 1435064, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/YtaeH.jpg?s=128&g=1", "display_name": "Jack Daniel", "link": "https://stackoverflow.com/users/1435064/jack-daniel"}, "edited": false, "score": 1, "creation_date": 1481579033, "post_id": 41109834, "comment_id": 69424686, "body": "Or write them as functions (not methods) within the entity package.  Your choice.  Personally, I recommend putting the database queries in the database package."}], "tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 14, "last_activity_date": 1481577874, "creation_date": 1481577874, "answer_id": 41109834, "question_id": 41109708, "link": "https://stackoverflow.com/questions/41109708/cant-define-receiver-from-another-package-in-go/41109834#41109834", "title": "Can&#39;t define receiver from another package in Go", "body": "<p>You can only define methods on a type defined <em>in that same package</em>.  Your <code>DB</code> type, in this case, is defined within your <code>dbconfig</code> package, so your <code>entity</code> package can't define methods on it.</p>\n\n<p>In this case, your options are to make GetContracts a function instead of a method and hand it the <code>*dbconfig.DB</code> as an argument, or to invert the dependency by importing your <code>entity</code> package in <code>dbconfig</code> and write GetContracts there (as a method or function, works either way).  This second one may actually be the better option, because, from a design perspective, it breaks abstraction to have packages other than your database package creating SQL query strings.</p>\n"}], "owner": {"reputation": 2147, "user_id": 1435064, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/YtaeH.jpg?s=128&g=1", "display_name": "Jack Daniel", "link": "https://stackoverflow.com/users/1435064/jack-daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5395, "favorite_count": 2, "accepted_answer_id": 41109834, "answer_count": 1, "score": 5, "last_activity_date": 1577337132, "creation_date": 1481577338, "last_edit_date": 1577337132, "question_id": 41109708, "link": "https://stackoverflow.com/questions/41109708/cant-define-receiver-from-another-package-in-go", "title": "Can&#39;t define receiver from another package in Go", "body": "<p>I'm a beginner in Golang and can't understand some concepts in this language. I like it very much, but every examples on the web are very simple and not explain the correct way of developing.<br>\nI want to configure db connection with MySQL. I create a package <code>dbconfig</code> with file dbconfig.go and package dastructure with interfaces files and another package <code>entity</code> with entities files.<br>\nThis is the structure:\n[<img src=\"https://i.stack.imgur.com/Ddkhl.png\" alt=\"1]\"></p>\n\n<p><strong>main.go:</strong></p>\n\n<pre><code>import (\n    y \"github.com/danyalov/shebeke/dbconfig\"\n    \"github.com/danyalov/shebeke/routes\"\n    _ \"github.com/go-sql-driver/mysql\"\n    \"github.com/labstack/gommon/log\"\n)\n\nfunc main() {\n    db, err := y.InitDB(\"mysql\", \"root:root@tcp(localhost:3306)/dbtest?parseTime=true\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    e := routes.NewConnection(db)\n    e.Logger.Fatal(e.Start(\":9898\"))\n}\n</code></pre>\n\n<p><strong>routes.go:</strong></p>\n\n<pre><code>import (\n    \"github.com/danyalov/shebeke/datastructure\"\n    y \"github.com/danyalov/shebeke/dbconfig\"\n    \"github.com/labstack/echo\"\n    \"github.com/labstack/echo/middleware\"\n)\n\nfunc NewConnection(db *y.DB) *echo.Echo {\n    e := echo.New()\n    env := Env{db}\n    e.Use(middleware.Logger())\n    e.Use(middleware.Recover())\n\n    e.GET(\"/contracts\", env.GetContracts)\n    e.GET(\"/contract/:id\", env.GetContractByID)\n\n    return e\n}\n\ntype Env struct {\n    contract datastructure.Contract\n}\n</code></pre>\n\n<p><strong>services.go:</strong></p>\n\n<pre><code>import (\n    \"github.com/labstack/echo\"\n    \"log\"\n    \"net/http\"\n    \"strconv\"\n)\n\nfunc (env *Env) GetContracts(c echo.Context) error {\n    contracts, err := env.contract.GetContracts()\n    if err != nil {\n        log.Fatal(err)\n    }\n    return c.JSON(http.StatusOK, &amp;contracts)\n}\n</code></pre>\n\n<p><strong>dbconfig.go:</strong></p>\n\n<pre><code>import (\n    \"database/sql\"\n    \"fmt\"\n    \"github.com/labstack/gommon/log\"\n)\n\ntype DB struct {\n    *sql.DB\n}\n\n//InitDB initialize mysql database\nfunc InitDB(driver, path string) (*DB, error) {\n    db, err := sql.Open(driver, path)\n    if err != nil {\n        log.Fatal(err)\n    }\n    err = db.Ping()\n    if err != nil {\n        log.Fatal(err)\n    } else {\n        fmt.Println(\"Connected to DB\")\n    }\n    return &amp;DB{db}, err\n}\n</code></pre>\n\n<p><strong>datastructure/contract.go:</strong></p>\n\n<pre><code>import y \"github.com/danyalov/shebeke/datastructure/entity\"\n\ntype Contract interface {\n    GetContracts() (y.Contracts, error)\n    GetContractByID(id int) (y.Contract, error)\n}\n</code></pre>\n\n<p><strong>datastructure/entity/contract.go:</strong></p>\n\n<pre><code>import (\n    \"github.com/labstack/gommon/log\"\n    \"time\"\n)\n\ntype Contract struct {\n    ID         int       `json:\"id\"`\n    State      string    `json:\"state\"`\n    StartDate  time.Time `json:\"start_date\"`\n    FinishDate time.Time `json:\"finish_date\"`\n}\n\ntype Contracts []Contract\n\nfunc (db *DB) GetContracts() (c Contracts, err error) {\n    rows, err := db.Query(\"select * from contract\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    contract := Contract{}\n    for rows.Next() {\n        err = rows.Scan(&amp;contract.ID, &amp;contract.State, &amp;contract.StartDate, &amp;contract.FinishDate)\n        c = append(c, contract)\n    }\n    return c, err\n}\n</code></pre>\n\n<p>Why can't I import <code>DB</code> type from <code>dbconfig</code> package into <code>entity</code> package as a method receiver? I get <code>Unresolved type 'DB'</code> error.</p>\n\n<p>This is <a href=\"https://github.com/danyalov/shebeke\" rel=\"nofollow noreferrer\">my working copy(Git)</a> of this project, I put <code>dbconfig.go</code> inside the entity, but I don't like it, I think it's incorrect place for <code>dbconfig</code> file.</p>\n\n<p>What is the correct file structure for configuring db in Go? Maybe you have your own examples in Git or some tutorial?</p>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 431, "user_id": 3579289, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/983dc0388721513b4c7ec63e280cb7e1?s=128&d=identicon&r=PG", "display_name": "Adrien", "link": "https://stackoverflow.com/users/3579289/adrien"}, "edited": false, "score": 0, "creation_date": 1481576662, "post_id": 41109458, "comment_id": 69423375, "body": "Nice catch ! So anyway I could make it &quot;unset&quot; so it set it automatically as wanted?"}, {"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "reply_to_user": {"reputation": 431, "user_id": 3579289, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/983dc0388721513b4c7ec63e280cb7e1?s=128&d=identicon&r=PG", "display_name": "Adrien", "link": "https://stackoverflow.com/users/3579289/adrien"}, "edited": false, "score": 0, "creation_date": 1481576887, "post_id": 41109458, "comment_id": 69423512, "body": "First I would verify that your header is set. But you could set the headers to <code>nil</code> as such: <code>w.Header() = nil</code>. This seems silly to have to do, but I suppose that is the API&#39;s choice."}, {"owner": {"reputation": 431, "user_id": 3579289, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/983dc0388721513b4c7ec63e280cb7e1?s=128&d=identicon&r=PG", "display_name": "Adrien", "link": "https://stackoverflow.com/users/3579289/adrien"}, "edited": false, "score": 0, "creation_date": 1481577443, "post_id": 41109458, "comment_id": 69423833, "body": "c.Writer.Header().Write(nil) don&#39;t change the result and yes it is silly :("}, {"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "reply_to_user": {"reputation": 431, "user_id": 3579289, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/983dc0388721513b4c7ec63e280cb7e1?s=128&d=identicon&r=PG", "display_name": "Adrien", "link": "https://stackoverflow.com/users/3579289/adrien"}, "edited": false, "score": 0, "creation_date": 1481577589, "post_id": 41109458, "comment_id": 69423901, "body": "Ah I wrote the wrong thing. You need to delete the <code>Content-Type</code> header. You can do this: <code>w.Header().Del(&quot;Content-Type&quot;)</code>."}, {"owner": {"reputation": 431, "user_id": 3579289, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/983dc0388721513b4c7ec63e280cb7e1?s=128&d=identicon&r=PG", "display_name": "Adrien", "link": "https://stackoverflow.com/users/3579289/adrien"}, "edited": false, "score": 0, "creation_date": 1481577949, "post_id": 41109458, "comment_id": 69424103, "body": "Yeah I tried, not working, the only way is to write \tc.Writer.Header().Set(&quot;Content-Type&quot;, &quot;application/json&quot;) but that is supper ugly do add that everywhere, I am frustrated ^^"}, {"owner": {"reputation": 431, "user_id": 3579289, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/983dc0388721513b4c7ec63e280cb7e1?s=128&d=identicon&r=PG", "display_name": "Adrien", "link": "https://stackoverflow.com/users/3579289/adrien"}, "edited": false, "score": 0, "creation_date": 1481579003, "post_id": 41109458, "comment_id": 69424673, "body": "HEY, wait a minute, this function do absolutely nothing, header is a function variable and go nowhere after ... @squiguy"}, {"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "reply_to_user": {"reputation": 431, "user_id": 3579289, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/983dc0388721513b4c7ec63e280cb7e1?s=128&d=identicon&r=PG", "display_name": "Adrien", "link": "https://stackoverflow.com/users/3579289/adrien"}, "edited": false, "score": 0, "creation_date": 1481579550, "post_id": 41109458, "comment_id": 69424933, "body": "What do you mean &quot;function variable&quot; and that it goes nowhere after?"}, {"owner": {"reputation": 431, "user_id": 3579289, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/983dc0388721513b4c7ec63e280cb7e1?s=128&d=identicon&r=PG", "display_name": "Adrien", "link": "https://stackoverflow.com/users/3579289/adrien"}, "reply_to_user": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 0, "creation_date": 1481579633, "post_id": 41109458, "comment_id": 69424986, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/130442/discussion-between-adrien-and-squiguy\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "is_accepted": true, "score": 3, "last_activity_date": 1481576388, "creation_date": 1481576388, "answer_id": 41109458, "question_id": 41109065, "link": "https://stackoverflow.com/questions/41109065/golang-gin-gonic-content-type-not-setting-to-application-json-with-c-json/41109458#41109458", "title": "golang gin gonic content-type not setting to application/json with c.JSON", "body": "<p>After looking at the source, it looks like it won't write the <code>Content-Type</code> header if it is already set.</p>\n\n<p><code>c.JSON</code> calls <a href=\"https://sourcegraph.com/github.com/gin-gonic/gin@e2212d40c62a98b388a5eb48ecbdcf88534688ba/-/blob/render/json.go#L39\" rel=\"nofollow noreferrer\">this function</a> which calls the following code:</p>\n\n<pre><code>func writeContentType(w http.ResponseWriter, value []string) {\n    header := w.Header()\n    if val := header[\"Content-Type\"]; len(val) == 0 {\n        header[\"Content-Type\"] = value\n    }\n}\n</code></pre>\n\n<p>Therefore your <code>Content-Type</code> must be set somewhere else.</p>\n"}, {"tags": [], "owner": {"reputation": 199, "user_id": 4822520, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0bHvs.jpg?s=128&g=1", "display_name": "Billcountry", "link": "https://stackoverflow.com/users/4822520/billcountry"}, "is_accepted": false, "score": 2, "last_activity_date": 1594877022, "creation_date": 1594877022, "answer_id": 62927972, "question_id": 41109065, "link": "https://stackoverflow.com/questions/41109065/golang-gin-gonic-content-type-not-setting-to-application-json-with-c-json/62927972#62927972", "title": "golang gin gonic content-type not setting to application/json with c.JSON", "body": "<p>If you expect all your requests to be JSON, add a middle ware instead.</p>\n<pre><code>func JSONMiddleware() gin.HandlerFunc {\n    return func(c *gin.Context) {\n        c.Writer.Header().Set(&quot;Content-Type&quot;, &quot;application/json&quot;)\n        c.Next()\n    }\n}\n</code></pre>\n<p>On your router add</p>\n<pre><code>router.Use(JSONMiddleware())\n</code></pre>\n"}], "owner": {"reputation": 431, "user_id": 3579289, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/983dc0388721513b4c7ec63e280cb7e1?s=128&d=identicon&r=PG", "display_name": "Adrien", "link": "https://stackoverflow.com/users/3579289/adrien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4246, "favorite_count": 0, "accepted_answer_id": 41109458, "answer_count": 2, "score": 0, "last_activity_date": 1594877022, "creation_date": 1481574823, "last_edit_date": 1481581937, "question_id": 41109065, "link": "https://stackoverflow.com/questions/41109065/golang-gin-gonic-content-type-not-setting-to-application-json-with-c-json", "title": "golang gin gonic content-type not setting to application/json with c.JSON", "body": "<p>According to the <a href=\"https://gowalker.org/github.com/gin-gonic/gin#Context_JSON\" rel=\"nofollow noreferrer\">official documentation</a>, c.JSON of <a href=\"https://github.com/gin-gonic/gin\" rel=\"nofollow noreferrer\">gin-gonic</a> should set the response header to <code>application/json</code>, but when I call my API from <a href=\"https://www.getpostman.com/\" rel=\"nofollow noreferrer\">Postman</a>, the response header is set to <code>text/plain; charset=utf-8</code></p>\n\n<p>I don't understand what I am missing, any idea ?</p>\n\n<p>Doc :</p>\n\n<blockquote>\n  <p><strong>func JSON</strong></p>\n  \n  <p>JSON serializes the given struct as JSON into the response body. It\n  also sets the Content-Type as \"application/json\".</p>\n</blockquote>\n\n<p>Here is a sample of my code :</p>\n\n<pre><code>func postLogin(c *gin.Context) {\n    var credentials DTO.Credentials\n    if err := c.BindJSON(&amp;credentials); err == nil {\n        c.JSON(buildResponse(services.CheckUserCredentials(credentials)))\n    } else {\n        var apiErrors = DTO.ApiErrors{}\n        for _, v := range err.(validator.ValidationErrors) {\n            apiErrors.Errors = append(apiErrors.Errors, DTO.ApiError{Field: v.Field, Message: v.Field + \" is \" + v.Tag})\n        }\n        c.JSON(http.StatusBadRequest, apiErrors)\n    }\n}\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>After investigation, log.Println(c.Writer.Header().Get(\"Content-Type\")) doesn't print any thing, showing content-type is empty as it should be.</p>\n\n<pre><code>func writeContentType(w http.ResponseWriter, value []string) {\n    header := w.Header()\n    log.Println(header.Get(\"Content-Type\")) // &lt;=========== Nothing happen\n    if val := header[\"Content-Type\"]; len(val) == 0 {\n        header[\"Content-Type\"] = value\n    }\n}\n</code></pre>\n\n<p>I really don't want to have to add <code>c.Writer.Header().Set(\"Content-Type\", \"application/json\")</code> to every route in my architecture...</p>\n\n<p><strong>EDIT 2</strong></p>\n\n<p>It seems like <code>binding:\"required\"</code> break the Content-Type Header</p>\n\n<pre><code>type Credentials struct {\n    Email         string        `json:\"email\" binding:\"required\"`\n    Password      string        `json:\"password\" binding:\"required\"`\n}\n</code></pre>\n"}, {"tags": ["go", "amazon-s3"], "answers": [{"tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": true, "score": 0, "last_activity_date": 1481573376, "creation_date": 1481573376, "answer_id": 41108720, "question_id": 41108412, "link": "https://stackoverflow.com/questions/41108412/go-download-s3-file-under-a-prefix/41108720#41108720", "title": "Go - Download S3 file under a prefix", "body": "<p><code>Bucket</code> should always be the name of your bucket. <code>Key</code> is the full name (path) of the object, so in your case, that should be <code>myFolder/myFile</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 3945488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e9bc4de26253e0740968a56313b57d9?s=128&d=identicon&r=PG&f=1", "display_name": "Gurucharan", "link": "https://stackoverflow.com/users/3945488/gurucharan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3172, "favorite_count": 0, "accepted_answer_id": 41108720, "answer_count": 1, "score": 0, "last_activity_date": 1481573376, "creation_date": 1481572130, "question_id": 41108412, "link": "https://stackoverflow.com/questions/41108412/go-download-s3-file-under-a-prefix", "title": "Go - Download S3 file under a prefix", "body": "<p>I am trying to download a file that is under a directory instead of directly in a bucket.</p>\n\n<pre><code>file, err := os.Create(\"s3file.csv\")\ndownloader := s3manager.NewDownloader(session.New(&amp;aws.Config{Region: aws.String(\"us-east-1\")}))\nnumBytes, err := downloader.Download(file,\n    &amp;s3.GetObjectInput{\n        Bucket: aws.String(bucket),\n        Key:    aws.String(key),\n    })\n</code></pre>\n\n<p>Bucket name - \"myBucket\"\nFolder name - \"myFolder\"\nfile name - \"myFile\"</p>\n\n<p>GetObjectInput doesn't accept Prefix as a parameter.\nSpecifying only bucket name without prefix is leading to Key not found error.\nTried setting \"bucket\" as following but got error</p>\n\n<ol>\n<li>myBucket/myFolder </li>\n<li>myBucket/myFolder/ </li>\n<li>myBucket&amp;prefix=myFolder</li>\n</ol>\n\n<p>Error: Failed to download file SignatureDoesNotMatch: The request signature we calculated does not match the signature you provided. Check your key and signing method.\n    status code: 403, request id: 647D920C72888888</p>\n\n<p>Note: Downloading a file directly under the bucket is working.</p>\n"}, {"tags": ["go", "cross-compiling"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1481565277, "post_id": 41106491, "comment_id": 69417524, "body": "<code>GOGCCFLAGS</code> isn&#39;t configurable. What are you trying to do?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1481568913, "post_id": 41106491, "comment_id": 69419489, "body": "BTW, I also see you have <code>CGO_ENABLED=0</code>, so you&#39;re not going to be calling a C compiler at all. You also have a very old (and no longer supported) version of Go. You should update to go1.7+ (or try the upcoming go1.8, with huge improvements to the code generated for arm)"}, {"owner": {"reputation": 19, "user_id": 7286271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9dd222d2210b94a5dba85a29548986b?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon DePalo", "link": "https://stackoverflow.com/users/7286271/brandon-depalo"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481570855, "post_id": 41106491, "comment_id": 69420490, "body": "@JimB I think that might be the problem. There seems to be some embedded C code in the google pcap libraries. I am able to compile the program just fine for amd64 with <code>CGO_ENABLED=0</code> but when I switch to ARM would I need to enable this?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481573810, "post_id": 41106491, "comment_id": 69421941, "body": "Yes. I&#39;m not sure how you were compiling the package for amd64, but the <a href=\"https://github.com/google/gopacket/blob/master/pcap/pcap.go\" rel=\"nofollow noreferrer\"><code>github.com&#47;google&#47;gopacket&#47;pcap</code></a> package is done completely through cgo."}], "owner": {"reputation": 19, "user_id": 7286271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9dd222d2210b94a5dba85a29548986b?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon DePalo", "link": "https://stackoverflow.com/users/7286271/brandon-depalo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1111, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1481564600, "creation_date": 1481564600, "question_id": 41106491, "link": "https://stackoverflow.com/questions/41106491/go-environment-variable-gogccflags-not-setting", "title": "go environment variable GOGCCFLAGS not setting", "body": "<p>I am trying to cross compile some Go code for ARM architecture and am running into an issue with the compiler flags.</p>\n\n<p>When I try to build my project I get some undefined errors relating to pcap</p>\n\n<pre><code>[brandon@f4998 src]$ go build\n# _/home/brandon/IdeaProjects/new-snap/src\n./main.go:120: undefined: pcap.OpenLive\n./main.go:120: undefined: pcap.BlockForever\n</code></pre>\n\n<p>I assumed this was because I need to include -lpcap when compiling so I set the GOGCCFLAGS environment variable to include -lpcap. However, this does not work because go is reading the $GOGCCFLAGS from somewhere else</p>\n\n<pre><code>[brandon@f4998 src]$ export GOGCCFLAGS=-lpcap\n[brandon@f4998 src]$ echo $GOGCCFLAGS\n-lpcap\n[brandon@f4998 src]$ go version\ngo version go1.5.4 linux/amd64\n[brandon@f4998 src]$ go env\nGOARCH=\"arm\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/brandon/IdeaProjects/new-snap\"\nGORACE=\"\"\nGOROOT=\"/usr/local/go\"\nGOTOOLDIR=\"/usr/local/go/pkg/tool/linux_amd64\"\nGO15VENDOREXPERIMENT=\"\"\nCC=\"arm-linux-gnu-gcc\"\nGOGCCFLAGS=\"-fPIC -marm -fmessage-length=0\"\nCXX=\"arm-linux-gnu-g++\"\nCGO_ENABLED=\"0\"\n</code></pre>\n\n<p>All of the other variables seem to be set correctly, but nothing happens when I set $GOGCCFLAGS</p>\n"}, {"tags": ["serialization", "go", "binary", "bit-fields"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1481556543, "post_id": 41104049, "comment_id": 69412426, "body": "Of course there&#39;s some way to handle it, but we need to know what the format is if you want assistance. Please provide an example of what you&#39;re tying to do."}], "answers": [{"comments": [{"owner": {"reputation": 725, "user_id": 156459, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e944b56331602c572d23b47243dca582?s=128&d=identicon&r=PG", "display_name": "thamurath", "link": "https://stackoverflow.com/users/156459/thamurath"}, "edited": false, "score": 0, "creation_date": 1484769768, "post_id": 41108447, "comment_id": 70651274, "body": "Thanks for your answer ... good code it set my path to the way I am doing it right now."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 1, "last_activity_date": 1481644706, "last_edit_date": 1481644706, "creation_date": 1481572258, "answer_id": 41108447, "question_id": 41104049, "link": "https://stackoverflow.com/questions/41104049/how-to-deserialize-a-non-standard-size-field/41108447#41108447", "title": "How to deserialize a non-standard size field?", "body": "<p>While there's probably no generic package to implement this custom struct packing, you can easily create your own method extracting just the bits required for each field.</p>\n\n<pre><code>func (m *Message) UnmarshalBinary(data []byte) error {\n    m.Length = binary.BigEndian.Uint32(data[:4])\n\n    if int(m.Length) &gt; len(data) {\n        return fmt.Errorf(\"not enough bytes\")\n    }\n\n    m.Type = MessageType(data[4])\n\n    m.Version = data[5] &gt;&gt; 4\n    m.Subversion = data[5] &gt;&gt; 2 &amp; 0x03\n    m.Optional = data[5] &gt;&gt; 1 &amp; 0x01\n\n    // move the index for ANumber back if there's an optional string\n    idx := 6\n    if m.Optional == 0 {\n        // remove the last two bytes for ANumber\n        end := int(m.Length) - 2\n        m.NodeName = string(data[6:end])\n        idx = end\n    }\n\n    m.ANumber = uint16(data[idx]&amp;0xc0)&lt;&lt;2 | uint16(data[idx]&amp;0x3f&lt;&lt;2|data[idx+1]&gt;&gt;6)\n    return nil\n</code></pre>\n\n<p>}</p>\n\n<p>You can of course add more bound checks to return errors rather than letting this panic when indexing out of bounds.</p>\n\n<p>I modified your <code>inStream</code> slice slightly to match your definition, and you can see the example output here: <a href=\"https://play.golang.org/p/FoNoazluOF\" rel=\"nofollow noreferrer\">https://play.golang.org/p/FoNoazluOF</a></p>\n"}, {"tags": [], "owner": {"reputation": 725, "user_id": 156459, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e944b56331602c572d23b47243dca582?s=128&d=identicon&r=PG", "display_name": "thamurath", "link": "https://stackoverflow.com/users/156459/thamurath"}, "is_accepted": true, "score": 0, "last_activity_date": 1484747647, "creation_date": 1484747647, "answer_id": 41721291, "question_id": 41104049, "link": "https://stackoverflow.com/questions/41104049/how-to-deserialize-a-non-standard-size-field/41721291#41721291", "title": "How to deserialize a non-standard size field?", "body": "<p>I have been working on some patch for restruct.io to be able to work with bitfields .... Still not fully tested but seems to work ... </p>\n\n<p>Will try to send a pull request once tested ... </p>\n\n<pre><code>func (e *encoder) writeBits(f field, inBuf []byte) {\n\n    var inputLength uint8 = uint8(len(inBuf))\n\n    if f.BitSize == 0 {\n        // Having problems with complex64 type ... so we asume we want to read all\n        //f.BitSize = uint8(f.Type.Bits())\n        f.BitSize = 8 * inputLength\n    }\n\n    // destPos: Destination position ( in the result ) of the first bit in the first byte\n    var destPos uint8 = 8 - e.bitCounter\n\n    // originPos: Original position of the first bit in the first byte\n    var originPos uint8 = f.BitSize % 8\n    if originPos == 0 {\n        originPos = 8\n    }\n\n    // numBytes: number of complete bytes to hold the result\n    var numBytes uint8 = f.BitSize / 8\n\n    // numBits: number of remaining bits in the first non-complete byte of the result\n    var numBits uint8 = f.BitSize % 8\n\n    // number of positions we have to shift the bytes to get the result\n    var shift uint8\n    if originPos &gt; destPos {\n        shift = originPos - destPos\n    } else {\n        shift = destPos - originPos\n    }\n    shift = shift % 8\n\n    var inputInitialIdx uint8 = inputLength - numBytes\n    if numBits &gt; 0 {\n        inputInitialIdx = inputInitialIdx - 1\n    }\n\n    if originPos &lt; destPos {\n        // shift left\n        carry := func(idx uint8) uint8 {\n            if (idx + 1) &lt; inputLength {\n                return (inBuf[idx+1] &gt;&gt; (8 - shift))\n            }\n            return 0x00\n\n        }\n        mask := func(idx uint8) uint8 {\n            if idx == 0 {\n                return (0x01 &lt;&lt; destPos) - 1\n            }\n            return 0xFF\n        }\n        var idx uint8 = 0\n        for inIdx := inputInitialIdx; inIdx &lt; inputLength; inIdx++ {\n            e.buf[idx] |= ((inBuf[inIdx] &lt;&lt; shift) | carry(inIdx)) &amp; mask(idx)\n            idx++\n        }\n\n    } else {\n        // originPos &gt;= destPos =&gt; shift right\n        var idx uint8 = 0\n        // carry : is a little bit tricky in this case because of the first case\n        // when idx == 0 and there is no carry at all\n        carry := func(idx uint8) uint8 {\n            if idx == 0 {\n                return 0x00\n            }\n            return (inBuf[idx-1] &lt;&lt; (8 - shift))\n        }\n        mask := func(idx uint8) uint8 {\n            if idx == 0 {\n                return (0x01 &lt;&lt; destPos) - 1\n            }\n            return 0xFF\n        }\n        inIdx := inputInitialIdx\n        for ; inIdx &lt; inputLength; inIdx++ {\n            //note: Should the mask be done BEFORE the OR with carry?\n            e.buf[idx] |= ((inBuf[inIdx] &gt;&gt; shift) | carry(inIdx)) &amp; mask(idx)\n\n            idx++\n        }\n        if ((e.bitCounter + f.BitSize) % 8) &gt; 0 {\n            e.buf[idx] |= carry(inIdx)\n        }\n    }\n\n    //now we should update buffer and bitCounter\n    e.bitCounter = (e.bitCounter + f.BitSize) % 8\n\n    // move the head to the next non-complete byte used\n    headerUpdate := func() uint8 {\n        if (e.bitCounter == 0) &amp;&amp; ((f.BitSize % 8) != 0) {\n            return (numBytes + 1)\n        }\n        return numBytes\n    }\n\n    e.buf = e.buf[headerUpdate():]\n\n    return\n}\n</code></pre>\n"}], "owner": {"reputation": 725, "user_id": 156459, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e944b56331602c572d23b47243dca582?s=128&d=identicon&r=PG", "display_name": "thamurath", "link": "https://stackoverflow.com/users/156459/thamurath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 41721291, "answer_count": 2, "score": 1, "last_activity_date": 1484747647, "creation_date": 1481556129, "last_edit_date": 1481569544, "question_id": 41104049, "link": "https://stackoverflow.com/questions/41104049/how-to-deserialize-a-non-standard-size-field", "title": "How to deserialize a non-standard size field?", "body": "<p>I have to deserialize some binary messages coming from another application. I would love to use <a href=\"http://restruct.io\" rel=\"nofollow noreferrer\">restruct.io</a> but some fields in the message structure use a \"non-standard\" number of bits ( 5 bits, 3 bits, ... 10 bits ... ).</p>\n\n<p>Is there any way to handle this type of structs? I have been searching for some time without any success so any help will be very welcomed. </p>\n\n<p>thanks in advance</p>\n\n<p>I wil try to give an example to clarify my question. Given the code: </p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/binary\"\n    \"fmt\"\n\n    restruct \"gopkg.in/restruct.v1\"\n)\n\ntype MessageType uint8\n\nconst (\n    MessageTypeOne MessageType = iota + 1\n    MessageTypeTwo\n    MessageTypeThree\n)\n\n// Message is the data to deserialize from the binary stream\ntype Message struct {\n    Length     uint32      `struct:\"uint32\"` // message size in bytes (including length)\n    Type       MessageType `struct:\"uint8\"`\n    Version    uint8       `struct:\"uint8:4\"` // Just need 4 bits\n    Subversion uint8       `struct:\"uint8:2\"` // just need 2 bits\n    Optional   uint8       `struct:\"uint8:1\"` // just one bit --&gt; '1' means next field is NOT present\n    NodeName   string      ``\n    ANumber    uint16      `struct:\"uint16:10\"` // just need 10 bits\n}\n\n// (length(4)+type(1)+(version(4bits)+Subversion(2bits)+Optional(1bit))) = 6 bytes\n// need 32bit alignment\nfunc main() {\n    var inStream = []byte{0x08, // just 8 bytes needed\n        0x01,       // messge type = MessageTypeOne\n        0x4a,       // Version=0100 Subversion=10 Optional=1 ANumber = 0 (MSB bit)\n        0x00, 0x60, // ANumber(000 0000 011) Padding = 0 0000 for 32 bits alignment\n    }\n    var msg Message\n\n    err := restruct.Unpack(inStream, binary.BigEndian, &amp;msg)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(msg)\n    // Expected:\n    // msg.Length = 8\n    // msg.Type = 1\n    // msg.Version = 4\n    // msg.Subversion = 2\n    // msg.Optional = 1\n    // msg.NodeName = \"\"\n    // msg.ANumber = 3\n}\n</code></pre>\n\n<p>I will receive inStream from a TCP connection and will want to deserialize the binary data and get a Message struct with the expected values ... </p>\n\n<p>Hope this will clarify my question.</p>\n\n<p>Thanks again ;)</p>\n"}, {"tags": ["go", "dependency-injection", "grpc"], "comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 1, "creation_date": 1481566849, "post_id": 41100683, "comment_id": 69418353, "body": "If you&#39;re abstracting something away with the same API, why not pass interfaces around? However, if 2 components do 2 fundamentally different things, I think abstraction isn&#39;t the way forwards. Different things are handled by different components, not by an abstraction layer..."}, {"owner": {"reputation": 497, "user_id": 3003363, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/eb34b5175fd0b3eb8259160eb3d1ae0c?s=128&d=identicon&r=PG&f=1", "display_name": "Ross", "link": "https://stackoverflow.com/users/3003363/ross"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1481606416, "post_id": 41100683, "comment_id": 69432554, "body": "@EliasVanOotegem I don&#39;t want to put it in the service definition of <code>GrpcServerExample</code> in the proto file because <code>differentService</code> is internal to the api. Is there any other way?"}], "answers": [{"tags": [], "owner": {"reputation": 421, "user_id": 1467852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3924baa7a34bda966b4b9ada1c4189?s=128&d=identicon&r=PG", "display_name": "Lance Chen", "link": "https://stackoverflow.com/users/1467852/lance-chen"}, "is_accepted": false, "score": 1, "last_activity_date": 1542959536, "creation_date": 1542959536, "answer_id": 53442607, "question_id": 41100683, "link": "https://stackoverflow.com/questions/41100683/dependency-injection-in-grpc-server-go/53442607#53442607", "title": "dependency injection in grpc server go", "body": "<p>You can inject the service into <code>GrpcServer</code> while registering the gRPC server.</p>\n\n<pre><code>package grpcserver\n\ntype GrpcServer struct {\n    MyService Service\n}\n\nfunc (g *GrpcServer) GrpcServerExample(ctx context.Context, r *grpcpackage.SampleGrpcRequest) (*grpcpackage.SampleGrpcResponse, error) {\n    service := g.MyService\n    result := service.DoSomething()\n    return nil,nil\n}\n\nfunc main() {\n    s := grpcpackage.NewServer()\n\n    grpcpackage.RegisterGrpcServer(s, &amp;GrpcServer{\n        // Inject Here\n        MyService: &amp;ServiceImpl{},\n    })\n}\n</code></pre>\n\n<p>service_interface.go</p>\n\n<pre><code>package grpcserver\n\ntype Service interface {\n    DoSomething() int\n}\n</code></pre>\n\n<p>service_impl.go</p>\n\n<pre><code>package grpcserver\n\ntype ServiceImpl struct {\n}\n\nfunc (s *ServiceImpl) DoSomething() int {\n    return 123\n}\n</code></pre>\n"}], "owner": {"reputation": 497, "user_id": 3003363, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/eb34b5175fd0b3eb8259160eb3d1ae0c?s=128&d=identicon&r=PG&f=1", "display_name": "Ross", "link": "https://stackoverflow.com/users/3003363/ross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 657, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1542959536, "creation_date": 1481544752, "question_id": 41100683, "link": "https://stackoverflow.com/questions/41100683/dependency-injection-in-grpc-server-go", "title": "dependency injection in grpc server go", "body": "<p>Suppose we have a go api containing a grpc server implementation.</p>\n\n<p>This grpc server method has to do a variety of tasks which needs to be abstracted as a different service within the same api.</p>\n\n<p>Is there a way to inject this new service in the grpc server?</p>\n\n<p>Sample code:</p>\n\n<pre><code>package grpcserver\n\nfunc (g *GrpcServer) GrpcServerExample(ctx context.Context, r *grpcpackage.SampleGrpcRequest) (*grpcpackage.SampleGrpcResponse, error) {\n    service := differentService{}   //how to inject this instead of creating here\n    result := service.DoSomething()\n    return nil,nil\n}\n</code></pre>\n"}, {"tags": ["go", "govendor"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1481540702, "post_id": 41099027, "comment_id": 69402936, "body": "Vendoring works good for commands and less good for individual packages..."}, {"owner": {"reputation": 1217, "user_id": 5066719, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/902c0e0e880e8e5d5395c6872f05fb05?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Soni", "link": "https://stackoverflow.com/users/5066719/abhishek-soni"}, "edited": false, "score": 0, "creation_date": 1481542540, "post_id": 41099027, "comment_id": 69403981, "body": "Can you give your exact directory structure your point is not clear"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1481573308, "post_id": 41099027, "comment_id": 69421716, "body": "This is why most vendoring tool flatten the vendor directory.  Govendor does this by default, I&#39;m not sure about other vendor tools.  The paradigm I&#39;ve started using for our libraries intended for import (as opposed to apps themselves) is to add <code>&#47;vendor&#47;*&#47;</code> to our <code>.gitignore</code>.  This ignores subfolders in <code>&#47;vendor&#47;</code>, but NOT files (like <code>vendor.json</code>, for govendor).  Govendor then gracefully handles flattening the dependency tree, and your error vanishes, because both packages are now using the same fully-qualified import path for the structure&#39;s package."}], "answers": [{"tags": [], "owner": {"reputation": 1217, "user_id": 5066719, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/902c0e0e880e8e5d5395c6872f05fb05?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Soni", "link": "https://stackoverflow.com/users/5066719/abhishek-soni"}, "is_accepted": false, "score": 3, "last_activity_date": 1534927720, "last_edit_date": 1534927720, "creation_date": 1481543738, "answer_id": 41100335, "question_id": 41099027, "link": "https://stackoverflow.com/questions/41099027/golang-vendor-package-with-vendored-sub-packages/41100335#41100335", "title": "Golang vendor package with vendored sub-packages", "body": "<p>I think what you are missing is this point:</p>\n\n<blockquote>\n  <p>Code below a directory named \"vendor\" is importable only by code in the directory tree rooted at the parent of \"vendor\", and only using an import path that omits the prefix up to and including the vendor element. (<a href=\"https://golang.org/cmd/go/#hdr-Vendor_Directories\" rel=\"nofollow noreferrer\">go command</a>)</p>\n</blockquote>\n\n<p>What I understand from your problem is your <code>mypackage</code> has vendor as its child, so when it's imported by any other package at same level, then for obvious reason they cannot see that vendored list.</p>\n\n<p>You can understand this as being similar to a <code>protected</code> feature.</p>\n\n<p>So if you want to use that version in any other package, then this <code>vendor</code> should be present at same level. For example</p>\n\n<pre><code>ParentDirectory\n &gt; mypackage\n &gt; otherpackage (this will be importing mypackage)\n &gt; vendor (vendor should be present in here so that all children under ParentDirectory can access this)\n</code></pre>\n\n<p>I hope I am clear with my point.</p>\n"}], "owner": {"reputation": 1778, "user_id": 2303988, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/VcVRc.jpg?s=128&g=1", "display_name": "Alessio", "link": "https://stackoverflow.com/users/2303988/alessio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2059, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1542472768, "creation_date": 1481539429, "last_edit_date": 1542472768, "question_id": 41099027, "link": "https://stackoverflow.com/questions/41099027/golang-vendor-package-with-vendored-sub-packages", "title": "Golang vendor package with vendored sub-packages", "body": "<p><strong>Situation:</strong></p>\n\n<p>Let's assume I've a package called <code>mypackage</code>. It exposes one method called <code>Build()</code>, that returns a concrete struct exposed by a third party library called <code>thirdpartypackage</code>, e.g. like shown as follows:</p>\n\n<pre><code>package mypackage\n\nimport tpp \"github.com/thirdpartycompany/thirdpartypackage\"\n\nfunc Build() *tpp.SharedStruct{\n   //...implementation\n}\n</code></pre>\n\n<p>The package that exposes <code>SharedStruct</code> is vendored inside <code>mypackage</code>, because I want to distribute it and make that package independent. </p>\n\n<p><strong>Problem:</strong></p>\n\n<p>After importing <code>mypackage</code> into another project and using <code>thirdpartypackage</code> in my (integration) tests, I'm getting the following error:</p>\n\n<blockquote>\n  <p>cannot use XXXX (type\n  \"github.com/mycompany/mymainproject/vendor/github.com/mycompany/mypackage/vendor/github.com/thirdcompany/thirdpartypackage-go\".Token)\n  as type\n  \"github.com/empatica/mycompany/vendor/github.com/thirdcompany/thirdpartypackage\"</p>\n</blockquote>\n\n<p>Basically the compiler is distinguishing the vendored third-party package inside my library and the vendored package that I put in my main project.</p>\n\n<p><strong>Question:</strong></p>\n\n<p>Are there ways to solve this issue, that are not removing the vendored dependencies from my library, like suggested <a href=\"https://forum.golangbridge.org/t/vendoring-and-multiple-versions-of-the-same-library/2010/6\" rel=\"nofollow noreferrer\">here</a>? Am I missing something?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 0, "creation_date": 1481527911, "post_id": 41095929, "comment_id": 69396491, "body": "It&#39;s not exactly clear what you want. Maybe you can tell us an example story of what should happen and why?"}, {"owner": {"reputation": 593, "user_id": 4273375, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/394947ca0e4bf377dacf12d32a424671?s=128&d=identicon&r=PG&f=1", "display_name": "Test admin", "link": "https://stackoverflow.com/users/4273375/test-admin"}, "reply_to_user": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 0, "creation_date": 1481528051, "post_id": 41095929, "comment_id": 69396540, "body": "I&#39;m using CentOS 7. If I run my Go lang code, it must create one user and its group. Is this posssible?"}, {"owner": {"reputation": 511, "user_id": 618193, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/f48765b88da721fa79615644ba26e375?s=128&d=identicon&r=PG", "display_name": "Haridas N", "link": "https://stackoverflow.com/users/618193/haridas-n"}, "edited": false, "score": 1, "creation_date": 1481528214, "post_id": 41095929, "comment_id": 69396613, "body": "I think you were looking for an utility script execution, changing the script permission does the job. Like chmod 500 &lt;executable&gt;. Also you can execute all shell commands from golang."}, {"owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 0, "creation_date": 1481528292, "post_id": 41095929, "comment_id": 69396644, "body": "Yes, it is possible. But you still have to answer why a simple <code>useradd</code> does not serve you well. Tell us more about the whole story and its surrounding."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1481530774, "post_id": 41095929, "comment_id": 69397619, "body": "Please elaborate on the &quot;to be executed only for a specific user&quot; bit. Do you want your program to be somehow executable only by a specific system user? Or do you mean you want to somehow pass the name of the user and group for your program to create in the system? It&#39;s okay if English is not your native language; just write down your requirements in a few sentences. It helps to just spell out the <i>intended</i> outcome of your program, and how you intend to run it. Like 1) I run my program; 2) It does such and such; 3) In the result I have this and that..."}], "answers": [{"tags": [], "owner": {"reputation": 1308, "user_id": 5089153, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cf636637f2f2f80acaa49e04082922cd?s=128&d=identicon&r=PG&f=1", "display_name": "Said  Saifi", "link": "https://stackoverflow.com/users/5089153/said-saifi"}, "is_accepted": false, "score": 0, "last_activity_date": 1481533472, "creation_date": 1481533472, "answer_id": 41097323, "question_id": 41095929, "link": "https://stackoverflow.com/questions/41095929/to-create-user-and-a-group-using-go-lang-but-the-go-binary-must-be-executed-onl/41097323#41097323", "title": "To create user and a group using Go Lang. But the Go Binary must be executed only for a specific user", "body": "<p>you can call the binary and pass a parameter specifying the use and then you in your code you check if you want to continue or not. i.e:</p>\n\n<p>the first thing in your main function:</p>\n\n<pre><code>func main(){\n    if os.Args[1]!=\"your specific user\"{\n         fmt.Println(\"code will not be executed for this user\")\n         return\n\n    } \n    //continue what you want to do\n\n\n\n}\n</code></pre>\n\n<p>then build your project, and call it like <code>./project user</code> </p>\n"}], "owner": {"reputation": 593, "user_id": 4273375, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/394947ca0e4bf377dacf12d32a424671?s=128&d=identicon&r=PG&f=1", "display_name": "Test admin", "link": "https://stackoverflow.com/users/4273375/test-admin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1523, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1481533472, "creation_date": 1481527418, "question_id": 41095929, "link": "https://stackoverflow.com/questions/41095929/to-create-user-and-a-group-using-go-lang-but-the-go-binary-must-be-executed-onl", "title": "To create user and a group using Go Lang. But the Go Binary must be executed only for a specific user", "body": "<p>I have a Go Binary, which when executed will create a User and a Group.</p>\n\n<p>But now I want this Go Binary to be executed only for a specific user?</p>\n\n<p>Is it possible? If yes, how can I achieve this?</p>\n\n<p>Any help is greatly appreciated.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["go", "matomo"], "answers": [{"comments": [{"owner": {"reputation": 1358, "user_id": 5275376, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a8bbb1e2df58ceebc9bbb5596bf823f3?s=128&d=identicon&r=PG&f=1", "display_name": "Shiva Kishore", "link": "https://stackoverflow.com/users/5275376/shiva-kishore"}, "edited": false, "score": 0, "creation_date": 1481648668, "post_id": 41101681, "comment_id": 69457209, "body": "Thanks @Gerben Jacobs  Is there any alternative to piwik suitable for golang?"}, {"owner": {"reputation": 101, "user_id": 475517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e45d50e58af59d5612b348df39dbf710?s=128&d=identicon&r=PG", "display_name": "davm85", "link": "https://stackoverflow.com/users/475517/davm85"}, "edited": false, "score": 0, "creation_date": 1609402795, "post_id": 41101681, "comment_id": 115833886, "body": "For ref, there&#39;s <a href=\"https://github.com/usefathom/fathom\" rel=\"nofollow noreferrer\">github.com/usefathom/fathom</a> which looks promising."}], "tags": [], "owner": {"reputation": 4007, "user_id": 616398, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/83e5ba145326da0edcc404bfff584df5?s=128&d=identicon&r=PG", "display_name": "Gerben Jacobs", "link": "https://stackoverflow.com/users/616398/gerben-jacobs"}, "is_accepted": false, "score": 0, "last_activity_date": 1481548232, "creation_date": 1481548232, "answer_id": 41101681, "question_id": 41094896, "link": "https://stackoverflow.com/questions/41094896/setup-piwik-with-golang/41101681#41101681", "title": "setup piwik with golang", "body": "<p>Piwik itself is a PHP project, you can not set it up using Go.</p>\n\n<p>The repository you linked to is a couple of methods to send Piwik specific data to the Piwik API.</p>\n"}, {"tags": [], "owner": {"reputation": 304, "user_id": 1845836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QmDna.jpg?s=128&g=1", "display_name": "Eddynand Fuchs", "link": "https://stackoverflow.com/users/1845836/eddynand-fuchs"}, "is_accepted": true, "score": 1, "last_activity_date": 1509125589, "creation_date": 1509125589, "answer_id": 46980603, "question_id": 41094896, "link": "https://stackoverflow.com/questions/41094896/setup-piwik-with-golang/46980603#46980603", "title": "setup piwik with golang", "body": "<p>I have found your question and decided to write a middleware for piwik. You have to set up piwik on a PHP server first, then you can use this middleware to track your requests: <a href=\"https://github.com/veecue/piwik-middleware\" rel=\"nofollow noreferrer\">https://github.com/veecue/piwik-middleware</a></p>\n"}], "owner": {"reputation": 1358, "user_id": 5275376, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a8bbb1e2df58ceebc9bbb5596bf823f3?s=128&d=identicon&r=PG&f=1", "display_name": "Shiva Kishore", "link": "https://stackoverflow.com/users/5275376/shiva-kishore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 46980603, "answer_count": 2, "score": 0, "last_activity_date": 1509125589, "creation_date": 1481522040, "question_id": 41094896, "link": "https://stackoverflow.com/questions/41094896/setup-piwik-with-golang", "title": "setup piwik with golang", "body": "<p>I want to setup piwik with go server, I tried searching for it in google\nthe only relevant result that came up was <a href=\"https://gitlab.sedara.io/zoey/middleware/blob/bf02334f5e5e317a0524a5e7d7efd851f40f7af4/piwik/piwik.go\" rel=\"nofollow noreferrer\">piwik.go zoey middleware</a><br>\nbut it doesnt have any info on how to use the middleware\nif anyone could point me in a right direction, to configure piwik or an alternative analytics platform suitable with go it will be really helpfull</p>\n\n<p>thanks in advance </p>\n"}, {"tags": ["json", "go", "maps", "decode"], "comments": [{"owner": {"reputation": 2547, "user_id": 6255980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/454bc16f39711097b06e71a597725238?s=128&d=identicon&r=PG&f=1", "display_name": "jussius", "link": "https://stackoverflow.com/users/6255980/jussius"}, "edited": false, "score": 0, "creation_date": 1481553017, "post_id": 41093398, "comment_id": 69410240, "body": "Your json doesn&#39;t match your struct. If you can change either one, you should use the solution given by Motakjuq. Otherwise you can define a custom MarshalJSON method for your struct."}], "answers": [{"tags": [], "owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "is_accepted": true, "score": 1, "last_activity_date": 1481510758, "creation_date": 1481510758, "answer_id": 41093511, "question_id": 41093398, "link": "https://stackoverflow.com/questions/41093398/best-way-to-store-decode-json-inside-struct-mapping/41093511#41093511", "title": "Best way to store/decode json inside struct mapping", "body": "<p>If your JSON is</p>\n\n<pre><code>{\n  \"Params\":[{\"rewew\": \"tref\"},{\"Value\": \"x\"},....]    \n}\n</code></pre>\n\n<p>And if you want to map <code>Params</code> into <code>Tel</code>, your structure should be:</p>\n\n<pre><code>type Red struct {\n   **other \n   Tel []map[string]string `json:\"Params\"`\n}\n</code></pre>\n\n<p>And you can add new elements like:</p>\n\n<pre><code>red.Tel = append(red.Tel, map[string]string{\"rewew\": \"tref\"})\nred.Tel = append(red.Tel, map[string]string{\"Value\": \"x\"})\n</code></pre>\n\n<p>But, I think there is a better way to do it if you're allowed to change the request AND the keys don't repeat themselves, using a JSON like</p>\n\n<pre><code>{\n  \"Params\":{\"rewew\": \"tref\", \"Value\": \"x\"}    \n}\n</code></pre>\n\n<p>The struct should be:</p>\n\n<pre><code>type Red struct {\n   **other \n   Tel map[string]string `json:\"Params\"`\n}\n</code></pre>\n\n<p>and you can use the data like:</p>\n\n<pre><code>red.Tel[\"rewew\"] = \"tref\"\nred.Tel[\"Value\"] = \"x\"\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 6803922, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/148de7ec8289954fcd634b00556026d0?s=128&d=identicon&r=PG&f=1", "display_name": "Cam.phiefr", "link": "https://stackoverflow.com/users/6803922/cam-phiefr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 41093511, "answer_count": 1, "score": -1, "last_activity_date": 1481510758, "creation_date": 1481509694, "question_id": 41093398, "link": "https://stackoverflow.com/questions/41093398/best-way-to-store-decode-json-inside-struct-mapping", "title": "Best way to store/decode json inside struct mapping", "body": "<p>I have a mapping inside a struct as follow :</p>\n\n<pre><code>type Red struct {\n       **other \n       Tel map[string]string `json:\"Tel\"`\n}\n</code></pre>\n\n<p>I receive my data json formated the following way </p>\n\n<pre><code>{\n \"Params\":[{\"rewew\": \"tref\"},{\"Value\": \"x\"},....]    \n}\n</code></pre>\n\n<p>And i'm searching for the most effective way of populating my struct with the data so that</p>\n\n<pre><code>Tel[\"rewew\"] = \"tref\"\nTel[\"Value\"] = \"x\"\n</code></pre>\n\n<p>For the rest of the values it works fine when those are simplier values when doing this:</p>\n\n<pre><code> var t Red\n decode := json.NewDecoder(req.Body)\n decode.Decode(&amp;t)\n</code></pre>\n\n<p>But i'm having trouble with maps</p>\n"}, {"tags": ["javascript", "rest", "go", "fetch"], "answers": [{"tags": [], "owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "is_accepted": true, "score": 3, "last_activity_date": 1481501539, "creation_date": 1481501539, "answer_id": 41092598, "question_id": 41091950, "link": "https://stackoverflow.com/questions/41091950/how-to-send-an-string-to-server-using-fetch-api/41092598#41092598", "title": "How to send an string to server using fetch API", "body": "<p>When you decode <code>req.Body</code>, you can't read again the request body, because it's already read the buffer, for that reason you're getting the message <code>SyntaxError: Unexpected end of input</code>. If you want to use the value on <code>req.Body</code>, you must to save the content of <code>req.Body</code> in a variable, something like this.</p>\n\n<pre><code>buf, err := ioutil.ReadAll(r.Body)\n// check err for errors when you read r.Body\nreader := bytes.NewReader(buf)\nerr = json.NewDecoder(reader).Decode(&amp;t)\nfmt.Println(string(buf))\nif err != nil {\n    http.Error(rw, err.Error(), 400)\n    return\n}\n</code></pre>\n\n<p>Also, your JSON is like <code>{\"image\":\"hello\"}</code>, so your struct should be:</p>\n\n<pre><code>type test_struct struct {\n    Test string `json:\"image\"`\n}\n</code></pre>\n\n<p>If you want to map the <code>image</code> value into <code>Test</code></p>\n"}], "owner": {"reputation": 7204, "user_id": 4333347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b091d5e3973e6f65ec16442c3b1b16b?s=128&d=identicon&r=PG", "display_name": "buydadip", "link": "https://stackoverflow.com/users/4333347/buydadip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "accepted_answer_id": 41092598, "answer_count": 1, "score": 2, "last_activity_date": 1481501539, "creation_date": 1481495996, "question_id": 41091950, "link": "https://stackoverflow.com/questions/41091950/how-to-send-an-string-to-server-using-fetch-api", "title": "How to send an string to server using fetch API", "body": "<p>I am using the <code>fetch</code> API to make a <code>POST</code> request to my server written in Go...</p>\n\n<pre><code>fetch('http://localhost:8080', {\n    method:'POST',\n    headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n        image:\"hello\"\n    })\n})\n.then((response) =&gt; response.json())\n.then((responseJson) =&gt; {\n    console.log(\"response\");\n})\n.catch(function(error) {\n    console.log(error);\n})\n</code></pre>\n\n<p>On my Go server I am receiving the <code>POST</code>...</p>\n\n<pre><code>type test_struct struct {\n    Test string\n}\n\nfunc GetImage(rw http.ResponseWriter, req *http.Request, _ httprouter.Params) {\n    var t test_struct\n\n    if req.Body == nil {\n        http.Error(rw, \"Please send a request body\", 400)\n        return\n    }\n    err := json.NewDecoder(req.Body).Decode(&amp;t)\n    fmt.Println(req.Body)\n    if err != nil {\n        http.Error(rw, err.Error(), 400)\n        return\n    }\n    fmt.Println(t.Test);\n}\n</code></pre>\n\n<p>The <code>POST</code> request is made. I know this because <code>fmt.Println(t.Test)</code> is printing a blank line to the console.</p>\n\n<p><code>fmt.Println(req.Body)</code> gives me <code>&lt;nil&gt;</code> in the console.</p>\n\n<p>The only error message I get is from the fetch API. It prints to the console the following error...</p>\n\n<pre><code>SyntaxError: Unexpected end of input\n</code></pre>\n\n<p>this is coming from the <code>.catch</code> declaration.</p>\n\n<p>In short, how can I receive the string on the server?</p>\n"}, {"tags": ["android", "go", "google-play"], "comments": [{"owner": {"reputation": 952, "user_id": 4555798, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/956224387724154/picture?type=large", "display_name": "oharlem", "link": "https://stackoverflow.com/users/4555798/oharlem"}, "edited": false, "score": 0, "creation_date": 1481517174, "post_id": 41091275, "comment_id": 69393260, "body": "Without more details hard to comment, however response code 400 means you have bad argument(s), i.e. maybe the problem is not in your package name. Are product ID and a token required? If so, are they correct?"}], "answers": [{"tags": [], "owner": {"reputation": 1768, "user_id": 899671, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/EPYny.jpg?s=128&g=1", "display_name": "Michael Draper", "link": "https://stackoverflow.com/users/899671/michael-draper"}, "is_accepted": false, "score": 0, "last_activity_date": 1481575998, "creation_date": 1481575998, "answer_id": 41109357, "question_id": 41091275, "link": "https://stackoverflow.com/questions/41091275/error-400-invalid-value-invalid/41109357#41109357", "title": "Error 400: Invalid Value, invalid", "body": "<p>Sadly without any other tests to look at or any other information to troubleshoot available, I switched to a different solution that I got working instead. There just wasn't enough information to work with, I posted this question in the hopes that someone had experienced this in the past and had easily hopped over it. I don't know where the particular black hole of information is, but I'm suspecting it's play store api. </p>\n\n<p>I believe this is most likely an artifact of go-iap using the oauth2 authentication mechanism, and something I either had missed setting up or misconfigured was causing a problem. The node validator only uses the public key and  purchase signature and it worked pretty much right out of the box. This really surprised me as I thought that oauth was required. This is my first time working with the payment gateways, and I'm still trying to figure out what can even go wrong, and when the error messages are <em>this</em> cryptic, it's a real uphill battle.</p>\n"}], "owner": {"reputation": 1768, "user_id": 899671, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/EPYny.jpg?s=128&g=1", "display_name": "Michael Draper", "link": "https://stackoverflow.com/users/899671/michael-draper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 725, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481575998, "creation_date": 1481491321, "question_id": 41091275, "link": "https://stackoverflow.com/questions/41091275/error-400-invalid-value-invalid", "title": "Error 400: Invalid Value, invalid", "body": "<p>Trying to troubleshoot unit tests written against <a href=\"https://github.com/dogenzaka/go-iap/blob/master/playstore/validator.go#L75\" rel=\"nofollow noreferrer\" title=\"android in app purchase validator in golang\">go-iap</a> and I'm having a hard time. </p>\n\n<p>When using VerifyProduct() I'm getting googleapi: Error 400: Invalid Value, invalid, this is with the receipt contract provided in the unit tests that shipped with the library and the <em>only</em> change being modification from packageName to my package name (which I am pretty sure is a valid package name).</p>\n\n<p>Steps I've taken so far:\nI've verified the token permissions are set correctly to Finance, configured the service account.</p>\n\n<p>I believe that this token is working as my test gives me the same results the passing unit test gave with the same contract, but with my own package it throws a 400. What could be wrong with my package name that the api is returning an invalid value for it?</p>\n"}, {"tags": ["dictionary", "go", "null"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1481483886, "post_id": 41089913, "comment_id": 69384996, "body": "That&#39;s just how the formatter prints it. It&#39;s only for convenience, so having the type shown is useful (not to mention you can index from a nil map)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481487049, "post_id": 41089913, "comment_id": 69385981, "body": "@JimB That&#39;s actually the answer, post it."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481506444, "post_id": 41091055, "comment_id": 69390967, "body": "Except the documentation you cite specifically states that the zero vale of a map is <code>nil</code> <a href=\"https://play.golang.org/p/c6NOfiotCC\" rel=\"nofollow noreferrer\">play.golang.org/p/c6NOfiotCC</a>"}], "tags": [], "owner": {"reputation": 549, "user_id": 618352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/348d2acd843f6a6f8486fa54cf67c350?s=128&d=identicon&r=PG", "display_name": "Jacques Supcik", "link": "https://stackoverflow.com/users/618352/jacques-supcik"}, "is_accepted": false, "score": 0, "last_activity_date": 1481489603, "creation_date": 1481489603, "answer_id": 41091055, "question_id": 41089913, "link": "https://stackoverflow.com/questions/41089913/why-does-printing-of-a-nil-map-in-golang-yield-a-non-nil-result/41091055#41091055", "title": "Why does printing of a (nil) map in golang yield a non &quot;&lt;nil&gt;&quot; result?", "body": "<p>A nil pointer is not the same as an empty (or zero) map. See <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#The_zero_value</a> for authoritative information concerning zero values.</p>\n\n<p>If you want a nil, you need a pointer, such as in the following <a href=\"https://play.golang.org/p/IJhmHQKFqf\" rel=\"nofollow noreferrer\">example</a>:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var myMap map[string]int64\n    fmt.Printf(\"myMap before assignment: %v\\n\", myMap)\n\n    myMap = make(map[string]int64)\n    fmt.Printf(\"myMap after assignment : %v\\n\", myMap)\n\n    var myMapPointer *map[string]int64\n    fmt.Printf(\"myMapPointer before assignment: %v\\n\", myMapPointer)\n\n    myMapPointer = new(map[string]int64)\n    fmt.Printf(\"myMapPointer after assignment : %v\\n\", myMapPointer)\n}\n</code></pre>\n\n<p>This gives:</p>\n\n<pre><code>myMap before assignment: map[]\nmyMap after assignment : map[]\nmyMapPointer before assignment: &lt;nil&gt;\nmyMapPointer after assignment : &amp;map[]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "is_accepted": false, "score": 4, "last_activity_date": 1575802420, "last_edit_date": 1575802420, "creation_date": 1481541365, "answer_id": 41099628, "question_id": 41089913, "link": "https://stackoverflow.com/questions/41089913/why-does-printing-of-a-nil-map-in-golang-yield-a-non-nil-result/41099628#41099628", "title": "Why does printing of a (nil) map in golang yield a non &quot;&lt;nil&gt;&quot; result?", "body": "<p>It's just for making things clear. If you run this code:</p>\n\n<pre><code>var m map[string]int64\nlog.Println(m == nil)\nlog.Printf(\"%T\\n\", m)\n</code></pre>\n\n<p>It will print:</p>\n\n<pre><code>$ true\n$ map[string]int64\n</code></pre>\n\n<p>So <code>m</code> is actually <code>nil</code> at this point. A <code>nil</code> value (can) have a type too and the formater uses that to print out something meaningful when possible.</p>\n\n<p>A <code>map</code> behaves like a reference type in other languages. And in Go you can call methods of a struct even if its value is <code>nil</code>.</p>\n\n<p>So even for your own structs, you can <em>implement</em> <code>fmt.Stringer</code> interface by just defining the <code>String() string</code> method on your struct and whenever your struct's value is <code>nil</code> you can print out something more proper than <code>&lt;nil&gt;</code>. Having:</p>\n\n<pre><code>type someData struct {\n    someValue string\n}\n\nfunc (x *someData) String() string {\n    if x == nil {\n        return \"NO PROPER DATA HERE!\"\n    }\n\n    return x.someValue\n}\n</code></pre>\n\n<p>Then if we run:</p>\n\n<pre><code>var data *someData\nlog.Println(data)\ndata = new(someData)\ndata.someValue = \"Aloha! :)\"\nlog.Println(data)\n</code></pre>\n\n<p>The output will be:</p>\n\n<pre><code>$ NO PROPER DATA HERE!\n$ Aloha! :)\n</code></pre>\n\n<p>See at the first line we did not get <code>&lt;nil&gt;</code> as output, despite the fact that our struct pointer is <code>nil</code> at that point.</p>\n"}], "owner": {"reputation": 16400, "user_id": 350542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/024d1da9fad214ca44af8fcc649ebb86?s=128&d=identicon&r=PG", "display_name": "jayunit100", "link": "https://stackoverflow.com/users/350542/jayunit100"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1038, "favorite_count": 0, "answer_count": 2, "score": 6, "last_activity_date": 1575802420, "creation_date": 1481482864, "last_edit_date": 1481482984, "question_id": 41089913, "link": "https://stackoverflow.com/questions/41089913/why-does-printing-of-a-nil-map-in-golang-yield-a-non-nil-result", "title": "Why does printing of a (nil) map in golang yield a non &quot;&lt;nil&gt;&quot; result?", "body": "<p>In golang, if you create a struct with a map in it, which is uninitialized, printing the map yields a non <code>&lt;nil&gt;</code> string.</p>\n\n<p>Why does \"print\" of a nil map output \"map[]\" instead of <code>&lt;nil&gt;</code> ? </p>\n\n<pre><code>// Assume above there is a struct, a.AA, which is created but which otherwise\n// has not created the map.\n//output:\n//map[]\n//map[]\nfmt.Println(a.AA)\nfmt.Println(make(map[string]int64))\n</code></pre>\n"}, {"tags": ["go", "package"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 4, "creation_date": 1481477563, "post_id": 41088984, "comment_id": 69382864, "body": "<code>get_info_from</code> is not exported; rename it to <code>GetInfoFrom</code>."}, {"owner": {"reputation": 893, "user_id": 5016201, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/axdqP.jpg?s=128&g=1", "display_name": "aurelienC", "link": "https://stackoverflow.com/users/5016201/aurelienc"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1481478431, "post_id": 41088984, "comment_id": 69383170, "body": "You mean there is a naming convention to make function private/public, like snake_case for private and CamelCase for public? I didn&#39;t saw this in the specs..."}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 3, "creation_date": 1481478545, "post_id": 41088984, "comment_id": 69383209, "body": "See <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow noreferrer\">Exported identifiers</a>. The uppercase first letter makes it exported; <a href=\"https://golang.org/doc/effective_go.html#mixed-caps\" rel=\"nofollow noreferrer\">using camel case over snake case is just convention</a>."}, {"owner": {"reputation": 893, "user_id": 5016201, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/axdqP.jpg?s=128&g=1", "display_name": "aurelienC", "link": "https://stackoverflow.com/users/5016201/aurelienc"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1481478719, "post_id": 41088984, "comment_id": 69383264, "body": "Thanks, if you want post an answer I will accept it."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1481484303, "post_id": 41088984, "comment_id": 69385140, "body": "While not very prominent in the spec, the Tour of Go explains this very well."}], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 4, "last_activity_date": 1481478963, "creation_date": 1481478963, "answer_id": 41089234, "question_id": 41088984, "link": "https://stackoverflow.com/questions/41088984/how-to-import-your-own-package/41089234#41089234", "title": "How to import your own package?", "body": "<p>In order for an identifier to be accessible from an outside package, its name must begin with an uppercase letter. <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow noreferrer\">From the spec</a>:</p>\n\n<blockquote>\n  <h3>Exported identifiers</h3>\n  \n  <p>An identifier may be exported to permit access to it from another package. An identifier is exported if both:</p>\n  \n  <ul>\n  <li>the first character of the identifier's name is a Unicode upper case letter (Unicode class \"Lu\"); and</li>\n  <li>the identifier is declared in the package block or it is a field name or method name.</li>\n  </ul>\n  \n  <p>All other identifiers are not exported.</p>\n</blockquote>\n\n<p>Additionally, <a href=\"https://golang.org/doc/effective_go.html#mixed-caps\" rel=\"nofollow noreferrer\">it is Go convention</a> to name identifiers using mixed case, rather than snake case.</p>\n\n<pre><code>package parser\n\n// ...\n\nfunc GetInfoFrom(filename string) Info {\n    // ...\n}\n</code></pre>\n"}], "owner": {"reputation": 893, "user_id": 5016201, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/axdqP.jpg?s=128&g=1", "display_name": "aurelienC", "link": "https://stackoverflow.com/users/5016201/aurelienc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 41089234, "answer_count": 1, "score": -2, "last_activity_date": 1481479068, "creation_date": 1481477502, "last_edit_date": 1481479068, "question_id": 41088984, "link": "https://stackoverflow.com/questions/41088984/how-to-import-your-own-package", "title": "How to import your own package?", "body": "<p>After reading <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">https://golang.org/doc/code.html</a>, and having a look at a few StackOverflow questions on the topic, <strong>I still can't build a program with several files in it</strong>.</p>\n\n<p>My GOPATH is: <code>C:/go_dev/</code>, and my directory structure is:</p>\n\n<pre><code>go_dev/\n    src/\n        github.com/\n            aurelienCastel/\n                crashTest/\n                    main.go\n                    parser/\n                        parser.go\n</code></pre>\n\n<p><strong>main.go:</strong></p>\n\n<pre><code>package main\n\nimport \"github.com/aurelienCastel/crashTest/parser\"\n\nfunc main() {\n     info := parser.get_info_from(\"file.go\")\n     // ...\n}\n</code></pre>\n\n<p><strong>parser/parser.go:</strong></p>\n\n<pre><code>package parser\n\n// ...\n\nfunc get_info_from(file_name string) Info {\n    // ...\n}\n</code></pre>\n\n<p>When I run <code>go install</code>in the <code>crashTest</code>directory I get the following error:</p>\n\n<blockquote>\n  <p>undefined: parser.get_info_from</p>\n</blockquote>\n\n<p>I know this is a recurrent question, but could someone tell me what I am doing wrong?</p>\n"}, {"tags": ["go", "rethinkdb", "gorethink", "rethinkdb-go"], "answers": [{"comments": [{"owner": {"reputation": 27333, "user_id": 309343, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0af367dc4d144a1580cac9500a29f16f?s=128&d=identicon&r=PG", "display_name": "Moon", "link": "https://stackoverflow.com/users/309343/moon"}, "edited": false, "score": 1, "creation_date": 1481519709, "post_id": 41090708, "comment_id": 69393844, "body": "I tried it. But now I get this error when I run it:  <code>gorethink: Cannot convert OBJECT to SEQUENCE in: r.DB(&quot;uc_dev&quot;).Table(&quot;unverified_requests&quot;).Filter(func(var_&zwnj;&#8203;5 r.Term) r.Term { return var_5.Field(&quot;user&quot;).Map(func(var_6 r.Term) r.Term { return var_6.Field(&quot;email&quot;) }).Eq(&quot;myemail@gmail.com&quot;) })</code>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1481487785, "last_edit_date": 1481487785, "creation_date": 1481487438, "answer_id": 41090708, "question_id": 41088294, "link": "https://stackoverflow.com/questions/41088294/golang-rethinkdb-nested-filter/41090708#41090708", "title": "Golang Rethinkdb nested filter", "body": "<p>A misplaced parenthesis. Instead of <code>}.Eq(email))</code> use <code>}).Eq(email)</code>:</p>\n\n<pre><code>db.Table(\"unverified_requests\").Filter(func(row r.Term) r.Term {\n    return row.Field(\"user\").Map(func(user r.Term) r.Term {\n        return user.Field(\"email\")\n    }).Eq(email)\n}).Run(session)\n</code></pre>\n\n<p>You tried to call <code>Eq()</code> on the function literal argument that is passed to <code>Map()</code>. It is obviously not of type <a href=\"https://godoc.org/github.com/GoRethink/gorethink#Term\" rel=\"nofollow noreferrer\"><code>gorethink.Term</code></a>, but the return value of <a href=\"https://godoc.org/github.com/GoRethink/gorethink#Map\" rel=\"nofollow noreferrer\"><code>gorethink.Map()</code></a> is, so call <code>Eq()</code> on the reutrn value of <code>Map()</code>, which means put the <code>.Eq()</code> after the parenthesis that closes the method call <code>Map()</code>.</p>\n"}], "owner": {"reputation": 27333, "user_id": 309343, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0af367dc4d144a1580cac9500a29f16f?s=128&d=identicon&r=PG", "display_name": "Moon", "link": "https://stackoverflow.com/users/309343/moon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 611, "favorite_count": 0, "accepted_answer_id": 41090708, "answer_count": 1, "score": 1, "last_activity_date": 1516800469, "creation_date": 1481473348, "last_edit_date": 1516800469, "question_id": 41088294, "link": "https://stackoverflow.com/questions/41088294/golang-rethinkdb-nested-filter", "title": "Golang Rethinkdb nested filter", "body": "<p>I am trying to run a filter on a property of a nested object for RethinkDB in Golang. But I am sure that I am missing something here.</p>\n\n<p>This is the error I am getting:</p>\n\n<blockquote>\n  <p>(func literal).Eq undefined (type func(gorethink.Term) gorethink.Term has no field or method Eq)</p>\n</blockquote>\n\n<p>Here is my code:</p>\n\n<pre><code>type User struct {\n    Id        string `json:\"id,omitempty\"`\n    FirstName string `json:\"firstName,omitempty\"`\n    LastName  string `json:\"lastName,omitempty\"`\n    Email     string `json:\"email,omitempty\"`\n    Password  string `json:\"password,omitempty\"`\n    Salt      string `json:\"salt,omitempty\"`\n}\n\ntype UnverifiedUserRequest struct {\n    Id    string `json:\"id,omitempty\"`\n    Token string `json:\"token,omitempty\"`\n    User  User   `json:\"user,omitempty\"`\n}\n\ndb.Table(\"unverified_requests\").Filter(func(row r.Term) r.Term {\n    return row.Field(\"user\").Map(func(user r.Term) r.Term {\n        return user.Field(\"email\")\n    }.Eq(email))\n}).Run(session)\n</code></pre>\n\n<hr>\n\n<h2>UPDATE 1</h2>\n\n<p>After making changes as suggested by @icza, the program builds fine. But I am getting the following error at runtime:</p>\n\n<blockquote>\n  <p>gorethink: Cannot convert OBJECT to SEQUENCE in: r.DB(\"uc_dev\").Table(\"unverified_requests\").Filter(func(var_\u200c\u200b5 r.Term) r.Term { return var_5.Field(\"user\").Map(func(var_6 r.Term) r.Term { return var_6.Field(\"email\") }).Eq(\"myemail@gmail.com\") })</p>\n</blockquote>\n"}, {"tags": ["json", "go"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 9, "last_activity_date": 1481463111, "creation_date": 1481463111, "answer_id": 41086704, "question_id": 41086654, "link": "https://stackoverflow.com/questions/41086654/creating-json-representation-from-go-struct/41086704#41086704", "title": "Creating JSON representation from Go struct", "body": "<p>What you are printing is <code>fmt</code>'s serialization of the <code>CommentResp</code> struct. Instead, you want to do is use <a href=\"https://godoc.org/encoding/json#Marshal\"><code>json.Marshal</code></a> to get the encoded JSON repsentation:</p>\n\n<pre><code>data, err := json.Marshal(stringa)\nif err != nil {\n     // Problem encoding stringa\n     panic(err)\n}\nfmt.Println(string(data))\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/ogWKQ3M6tb\">https://play.golang.org/p/ogWKQ3M6tb</a></p>\n\n<p>Also, your <code>json</code> struct tags are not valid; there cannot be a space between <code>:</code> and the quoted string:</p>\n\n<pre><code>type CommentResp struct {\n    Id   string `json:\"id\"`\n    Name string `json:\"name\"`\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/eQiyTk6-vQ\">https://play.golang.org/p/eQiyTk6-vQ</a></p>\n"}], "owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 41086704, "answer_count": 1, "score": -2, "last_activity_date": 1486776893, "creation_date": 1481462765, "last_edit_date": 1486776893, "question_id": 41086654, "link": "https://stackoverflow.com/questions/41086654/creating-json-representation-from-go-struct", "title": "Creating JSON representation from Go struct", "body": "<p>I am trying to create a JSON string from a struct:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    type CommentResp struct {\n        Id   string `json: \"id\"`\n        Name string `json: \"name\"`\n    }\n\n    stringa := CommentResp{\n        Id:   \"42\",\n        Name: \"Foo\",\n    }\n\n    fmt.Println(stringa)\n}\n</code></pre>\n\n<p>This code prints <code>{42 foo}</code>, but I expected <code>{\"Id\":\"42\",\"Name\":\"Foo\"}</code>.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 747, "user_id": 5539547, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/z3y7F.jpg?s=128&g=1", "display_name": "Tahseen", "link": "https://stackoverflow.com/users/5539547/tahseen"}, "edited": false, "score": 1, "creation_date": 1481455152, "post_id": 41085307, "comment_id": 69376494, "body": "Thanks you so much. I didn&#39;t know that non-capital makes the variable private. So just a question on this - if the variables of struct are private, we can only use them in the functions that struct ?"}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "reply_to_user": {"reputation": 747, "user_id": 5539547, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/z3y7F.jpg?s=128&g=1", "display_name": "Tahseen", "link": "https://stackoverflow.com/users/5539547/tahseen"}, "edited": false, "score": 0, "creation_date": 1481455422, "post_id": 41085307, "comment_id": 69376551, "body": "If the field is private will be visible only at package scope, in your example it will be accessible in any file inside the <b>main</b> package, but because <code>t.Execute()</code> is in other pkg will not be able to access the fields. That&#39;s the way to do encapsulation in Go <b>private</b>: lower case, <b>public</b>: upper case"}], "tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": true, "score": 2, "last_activity_date": 1481452980, "creation_date": 1481452980, "answer_id": 41085307, "question_id": 41085135, "link": "https://stackoverflow.com/questions/41085135/go-web-page-template-served-blank/41085307#41085307", "title": "Go Web Page Template served Blank", "body": "<p>You should write the first letter of the fields of <code>Blog</code> with upper case to make them public</p>\n\n<pre><code>type Blog struct {\n    Title   string\n    Heading string\n    Para    string\n}\n</code></pre>\n\n<p>Also you can pass a map to the method <code>Execute()</code>, something like this:</p>\n\n<pre><code>b := map[string]string{\n    \"title\": \"GoLang\",\n    \"heading\": \"WebServer\",\n    \"para\": \"coding\",\n}\nt.Execute(w, b)\n</code></pre>\n"}], "owner": {"reputation": 747, "user_id": 5539547, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/z3y7F.jpg?s=128&g=1", "display_name": "Tahseen", "link": "https://stackoverflow.com/users/5539547/tahseen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "accepted_answer_id": 41085307, "answer_count": 1, "score": 2, "last_activity_date": 1523624691, "creation_date": 1481451660, "question_id": 41085135, "link": "https://stackoverflow.com/questions/41085135/go-web-page-template-served-blank", "title": "Go Web Page Template served Blank", "body": "<p>I wrote this Go Lang code for serving web page with template and values passed to parameters through Go program</p>\n\n<pre><code>// +build\n\npackage main\n\nimport (\n    \"html/template\"\n    \"io/ioutil\"\n    \"net/http\"\n)\ntype Blog struct {\n    title   string\n    heading string\n    para    string\n}\nfunc loadfile(filename string) (string, error) {\n    byte, err := ioutil.ReadFile(filename)\n    return string(byte), err\n}\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    blog := Blog{title: \"GoLang\", heading: \"WebServer\", para: \"coding\"}\n    t, err := template.ParseFiles(\"test.html\")\n    fmt.Println(err)\n    t.Execute(w, blog)\n}\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    http.ListenAndServe(\":9000\", nil)\n}\n</code></pre>\n\n<p>HTML Template file named as test.html as follows</p>\n\n<pre><code>&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;{{.title}}&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;h1&gt;{{.heading}}&lt;/h1&gt;\n&lt;p&gt;{{.para}}&lt;/p&gt;\n\n&lt;/body&gt;\n&lt;/html&gt; \n</code></pre>\n\n<p>When I execute the program, the issue is that the page served is coming up as blank. The parameters that were to be passed to the template don't show up on the page rendered. I even printed the error but there is no error</p>\n"}, {"tags": ["go", "interface", "slice"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 3, "creation_date": 1481422950, "post_id": 41082059, "comment_id": 69370659, "body": "See the <a href=\"https://golang.org/doc/faq#convert_slice_of_interface\" rel=\"nofollow noreferrer\">FAQ</a>.  Possible dup: <a href=\"http://stackoverflow.com/questions/12990338/cannot-convert-string-to-interface\" title=\"cannot convert string to interface\">stackoverflow.com/questions/12990338/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 964, "user_id": 3184079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/819c77c230e755f43bfbbbb87429c046?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/3184079/omar"}, "is_accepted": true, "score": 3, "last_activity_date": 1481422301, "creation_date": 1481422301, "answer_id": 41082316, "question_id": 41082059, "link": "https://stackoverflow.com/questions/41082059/golang-initialize-a-slice-of-empty-interfaces/41082316#41082316", "title": "golang initialize a slice of empty interfaces", "body": "<p>The issue is that an array of structs can't be used as an array of interfaces, even if the individual structs implement the individual interfaces. You would need to append each element directly like so:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\ntype a struct{\n    Data []interface{}\n}\nfunc main() {\n    ints := []int{2,3,4}\n    tmp := a{}\n    for _, v := range ints {\n        tmp.Data = append(tmp.Data, v)\n    }\n    fmt.Println(ints, tmp) // [2 3 4] {[2 3 4]}\n}\n</code></pre>\n"}], "owner": {"reputation": 16093, "user_id": 534298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4ba32c06ed067564a6c6512de5217657?s=128&d=identicon&r=PG", "display_name": "nos", "link": "https://stackoverflow.com/users/534298/nos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5171, "favorite_count": 0, "closed_date": 1481484389, "accepted_answer_id": 41082316, "answer_count": 1, "score": 0, "last_activity_date": 1521603264, "creation_date": 1481419143, "last_edit_date": 1521603264, "question_id": 41082059, "link": "https://stackoverflow.com/questions/41082059/golang-initialize-a-slice-of-empty-interfaces", "closed_reason": "Duplicate", "title": "golang initialize a slice of empty interfaces", "body": "<p>I defined a struct</p>\n\n<pre><code>type container struct{\n    Data []interface{}\n}\n</code></pre>\n\n<p>and was hoping to assign slice of all different kinds of data types to it. For example</p>\n\n<pre><code>ints := []int{2,3,4}\ntmp := container{ints}\n</code></pre>\n\n<p>However, the compiler complains: </p>\n\n<blockquote>\n  <p>cannot use ints (type []int) as type []interface {} in field value</p>\n</blockquote>\n\n<p>How should I define the container struct? Or the assignment needs to be done differently?</p>\n\n<p>A complete example can be found <a href=\"https://play.golang.org/p/4UJczoh2KQ\" rel=\"nofollow noreferrer\">here</a></p>\n"}, {"tags": ["matlab", "go", "websocket", "ffi", "gorilla"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1481423209, "post_id": 41081428, "comment_id": 69370694, "body": "Cross posted here: <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/Jc1a2U4DwVM\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/golang-nuts/Jc1a2U4DwVM</a>"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1481642405, "post_id": 41081428, "comment_id": 69453042, "body": "You say that you can send commands and receive answers back without using websockets.  Take the code and run it in a goroutine and see if ti works.  Perhaps the matlib requires that all code run on the main thread or something."}, {"owner": {"reputation": 76, "user_id": 7278188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68ec486c8f14f6b6034c0af9a916b3e1?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy Bejanin", "link": "https://stackoverflow.com/users/7278188/jeremy-bejanin"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1481754492, "post_id": 41081428, "comment_id": 69508622, "body": "I just tried and starting the engine in a goroutine works properly."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1481757426, "post_id": 41081428, "comment_id": 69509712, "body": "I don&#39;t see an obvious problem. Show the code that works without websockets."}, {"owner": {"reputation": 76, "user_id": 7278188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68ec486c8f14f6b6034c0af9a916b3e1?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy Bejanin", "link": "https://stackoverflow.com/users/7278188/jeremy-bejanin"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1481813867, "post_id": 41081428, "comment_id": 69534699, "body": "Me neither, it&#39;s driving me crazy! I included on the gist (which I realize I had not linked) an example without the websocket, which is also the one I tried directly in a goroutine."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1481854657, "post_id": 41081428, "comment_id": 69553180, "body": "Evaluate the exact same expressions in the two apps and see if that makes a difference..  The websocket app evals &quot;version&quot;, the other app does not. The websocket app prints the version output twice. Perhaps there&#39;s a bug in matlab with the &quot;version&quot; expression."}, {"owner": {"reputation": 76, "user_id": 7278188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68ec486c8f14f6b6034c0af9a916b3e1?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy Bejanin", "link": "https://stackoverflow.com/users/7278188/jeremy-bejanin"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1481905905, "post_id": 41081428, "comment_id": 69577154, "body": "That didn&#39;t work either, when I do that, the function seems to read an empty buffer and outputs nothing, instead of that version string. Thanks for all the help by the way, I know this is hard to troubleshoot without being able to do it yourself..."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1481906097, "post_id": 41081428, "comment_id": 69577273, "body": "Please be more specific about where the empty buffer is read and where the nothing output is returned. Is the empty buffer from the websocket or is it the return from the library?"}, {"owner": {"reputation": 76, "user_id": 7278188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68ec486c8f14f6b6034c0af9a916b3e1?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy Bejanin", "link": "https://stackoverflow.com/users/7278188/jeremy-bejanin"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1481943660, "post_id": 41081428, "comment_id": 69589800, "body": "I read the result of evaluating expressions from a buffer: <a href=\"https://gist.github.com/jebej/647503c638e7ce7e68b68552fec15806#file-engine-go-L38\" rel=\"nofollow noreferrer\">gist.github.com/jebej/&hellip;</a>"}], "owner": {"reputation": 76, "user_id": 7278188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68ec486c8f14f6b6034c0af9a916b3e1?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy Bejanin", "link": "https://stackoverflow.com/users/7278188/jeremy-bejanin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1481813787, "creation_date": 1481412731, "last_edit_date": 1481813787, "question_id": 41081428, "link": "https://stackoverflow.com/questions/41081428/using-gorilla-websocket-with-the-matlab-engine", "title": "Using gorilla/websocket with the MATLAB Engine", "body": "<p>I am trying to make a simple Go Websocket server that will allow clients to talk to MATLAB. I managed to use the MATLAB Engine from Go properly, as in I am able to send commands to MATLAB and receive the answers back, but for some reason getting the command from a Websocket client and sending it to MATLAB fails.</p>\n\n<p>The server receives the message properly, but the message is not passed to MATLAB (or I cannot get the output properly)...</p>\n\n<p>I have included the relevant Go code and console output below, and the more details can be found on <a href=\"https://gist.github.com/jebej/647503c638e7ce7e68b68552fec15806\" rel=\"nofollow noreferrer\">this Gist</a>.</p>\n\n<p><strong>Go server:</strong></p>\n\n<pre><code>func handler(w http.ResponseWriter, r *http.Request) {\n    conn, err := upgrader.Upgrade(w, r, nil)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    // Start a MATLAB session\n    s := gm.OpenMSession()\n    defer gm.CloseMSession(s)\n    // Check if MATLAB is up\n    fmt.Println(\"MATLAB v\" + gm.EvalString(s, \"version\"))\n    // Tell user what to do\n    tell := \"MATLAB was loaded, please enter your commands:\"\n    fmt.Println(tell)\n    if err = conn.WriteMessage(ws.TextMessage, []byte(tell)); err != nil {\n        fmt.Println(err)\n    }\n\n    // Main REPL loop\n    for {\n        fmt.Println(\"Waiting for incoming message...\")\n        _, p, errin := conn.ReadMessage()\n        if errin != nil {\n            fmt.Println(\"Close message received!\")\n            break\n        }\n        fmt.Println(\"Whooo, here it is: \" + string(p))\n\n        // Feed message to MATLAB\n        res := gm.EvalString(s, string(p))\n\n        // Send response to client\n        fmt.Println(\"Sending response: \" + res)\n        if err := conn.WriteMessage(ws.TextMessage, []byte(res)); err != nil {\n            fmt.Println(\"Client disconnected!\")\n            break\n        }\n        fmt.Println(\"Done! Now we can start again!\")\n    }\n    fmt.Println(\"Closing down the conn\")\n    conn.Close()\n    fmt.Println(\"Closing down the sesh\")\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    http.ListenAndServe(\":30000\", nil)\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>MATLAB v\nans =\n\n9.0.0.341360 (R2016a)\n\n\nMATLAB was loaded, please enter your commands:\nWaiting for incoming message...\nWhooo, here it is: 2+2\nSending response: \nans =\n\n9.0.0.341360 (R2016a)\n\n\nDone! Now we can start again!\nWaiting for incoming message...\n</code></pre>\n"}, {"tags": ["javascript", "regex", "go"], "answers": [{"comments": [{"owner": {"reputation": 1579, "user_id": 1354514, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e83e6f559891e7489995dfa43e010fa3?s=128&d=identicon&r=PG", "display_name": "steve landiss", "link": "https://stackoverflow.com/users/1354514/steve-landiss"}, "edited": false, "score": 0, "creation_date": 1481407718, "post_id": 41080302, "comment_id": 69367765, "body": "That was exactly what I was looking for Omar!"}], "tags": [], "owner": {"reputation": 964, "user_id": 3184079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/819c77c230e755f43bfbbbb87429c046?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/3184079/omar"}, "is_accepted": true, "score": 2, "last_activity_date": 1481403765, "creation_date": 1481403765, "answer_id": 41080302, "question_id": 41080116, "link": "https://stackoverflow.com/questions/41080116/how-do-i-match-exactly-a-partial-string-in-regexp-and-ignore-any-characters-befo/41080302#41080302", "title": "How do I match exactly a partial string in regexp and ignore any characters before and after a pattern?", "body": "<p>I'm not entirely clear on what the goal is. If you're always looking for needle=haystack then you can use strings.Contains(str, \"needle=haystack\").</p>\n\n<p>If you really want to do it with regexes then it would be something like the code below.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n)\n\nfunc main() {\n    str := \"name1=val1;name2=val2;needle=haystack;name3=val3\"\n\n    r := regexp.MustCompile(\"needle=([a-z]+);\")\n    found := r.FindString(str)\n    if found == \"\" {\n        fmt.Println(\"No match found\")\n        return\n    }\n    fmt.Println(found) // needle=haystack;\n\n    submatches := r.FindStringSubmatch(str)\n    fmt.Println(submatches) // [needle=haystack; haystack]\n    if len(submatches) &lt; 2 {\n        fmt.Println(\"No submatch found\")\n        return\n    }\n    fmt.Println(submatches[1]) // haystack\n}\n</code></pre>\n"}], "owner": {"reputation": 1579, "user_id": 1354514, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e83e6f559891e7489995dfa43e010fa3?s=128&d=identicon&r=PG", "display_name": "steve landiss", "link": "https://stackoverflow.com/users/1354514/steve-landiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 1, "accepted_answer_id": 41080302, "answer_count": 1, "score": 1, "last_activity_date": 1481403765, "creation_date": 1481402522, "question_id": 41080116, "link": "https://stackoverflow.com/questions/41080116/how-do-i-match-exactly-a-partial-string-in-regexp-and-ignore-any-characters-befo", "title": "How do I match exactly a partial string in regexp and ignore any characters before and after a pattern?", "body": "<p>I am using golang regexp and I want to extract a pattern in a string.</p>\n\n<p>For example, I can have the following name value pairs in the string:</p>\n\n<p>\"name1=val1;name2=val2;needle=haystack;name3=val3\"</p>\n\n<p>I am looking for exactly the string \"needle=haystack\" and discard anything else.</p>\n\n<p>It would be even better if I could just get the result to be exactly haystack. </p>\n\n<p>How do I do this with regexp in golang?</p>\n"}, {"tags": ["go", "cpu"], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1481448195, "post_id": 41079746, "comment_id": 69374894, "body": "This code has race conditions, accesses to the local variable <code>keepGoing</code> are not synchronized (run with the <code>-race</code> option to verify). Better to use channels for such thing."}, {"owner": {"reputation": 694, "user_id": 4475267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--RSHYsfQegM/AAAAAAAAAAI/AAAAAAAAAI0/NQY8UBQZ-ag/photo.jpg?sz=128", "display_name": "noisypixy", "link": "https://stackoverflow.com/users/4475267/noisypixy"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1481460751, "post_id": 41079746, "comment_id": 69377811, "body": "I didn&#39;t see the need since this program exits right after the sleep. In fact, now that you mention it, even the <code>keepGoing</code> variable is unneeded if this program is to be ran as a whole."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1481463721, "post_id": 41079746, "comment_id": 69378610, "body": "That is not true. As it is, you&#39;re in the hands of the goroutine scheduler, and if the main goroutine does not get scheduled after the sleep, your app might run &quot;forever&quot;.."}, {"owner": {"reputation": 694, "user_id": 4475267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--RSHYsfQegM/AAAAAAAAAAI/AAAAAAAAAI0/NQY8UBQZ-ag/photo.jpg?sz=128", "display_name": "noisypixy", "link": "https://stackoverflow.com/users/4475267/noisypixy"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1481465344, "post_id": 41079746, "comment_id": 69379129, "body": "Hmm... That is interesting... Today I learned something new. Thanks!"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1481486936, "post_id": 41079746, "comment_id": 69385953, "body": "Check out this code: it should terminate after 1 millisecond, but it runs forever, for the same reason I mentioned above: <a href=\"https://play.golang.org/p/4Swz4WSG9d\" rel=\"nofollow noreferrer\">Go Playground</a>. If you think it&#39;s playground related, save it locally, and run it. It again will run forever."}], "tags": [], "owner": {"reputation": 694, "user_id": 4475267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--RSHYsfQegM/AAAAAAAAAAI/AAAAAAAAAI0/NQY8UBQZ-ag/photo.jpg?sz=128", "display_name": "noisypixy", "link": "https://stackoverflow.com/users/4475267/noisypixy"}, "is_accepted": false, "score": 4, "last_activity_date": 1481460784, "last_edit_date": 1481460784, "creation_date": 1481400273, "answer_id": 41079746, "question_id": 41079492, "link": "https://stackoverflow.com/questions/41079492/how-to-artificially-increase-cpu-usage/41079746#41079746", "title": "How to artificially increase CPU usage", "body": "<p>Here's a little snippet that writes <code>.</code> characters to <code>/dev/null</code> using all your cores, and stops after 10 seconds.</p>\n\n<p>In my case this uses almost 100% of my <strong>Intel Core 2 Duo @ 2.20GHz</strong>, so I don't know how it will behave when executed somewhere with higher specs, but I guess increasing the number of goroutines would do.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"runtime\"\n    \"time\"\n)\n\nfunc main() {\n    f, err := os.Open(os.DevNull)\n    if err != nil {\n        panic(err)\n    }\n    defer f.Close()\n\n    n := runtime.NumCPU()\n    runtime.GOMAXPROCS(n)\n\n    for i := 0; i &lt; n; i++ {\n        go func() {\n            for {\n                fmt.Fprintf(f, \".\")\n            }\n        }()\n    }\n\n    time.Sleep(10 * time.Second)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 964, "user_id": 3184079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/819c77c230e755f43bfbbbb87429c046?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/3184079/omar"}, "is_accepted": false, "score": 2, "last_activity_date": 1481402442, "creation_date": 1481402442, "answer_id": 41080105, "question_id": 41079492, "link": "https://stackoverflow.com/questions/41079492/how-to-artificially-increase-cpu-usage/41080105#41080105", "title": "How to artificially increase CPU usage", "body": "<p>noisypixy has the right idea with using all cores, but on my machine it only managed to hit about 50% load on all processors. I believe this is due to Prints being slow, but not CPU intensive.</p>\n\n<pre><code>package main\n\nimport (\n    \"runtime\"\n    \"time\"\n)\n\nfunc main() {\n    n := runtime.NumCPU()\n    runtime.GOMAXPROCS(n)\n\n    quit := make(chan bool)\n\n    for i := 0; i &lt; n; i++ {\n        go func() {\n            for {\n                select {\n                case &lt;-quit:\n                    return\n                default:\n                }\n            }\n        }()\n    }\n\n    time.Sleep(10 * time.Second)\n    for i := 0; i &lt; n; i++ {\n        quit &lt;- true\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 1, "creation_date": 1481483757, "post_id": 41084841, "comment_id": 69384957, "body": "Yep, if trying to stress CPU, avoid blockong operations and just do an endless loop (that can be cancelled)."}, {"owner": {"reputation": 674, "user_id": 1641739, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/85298f15ba4d65ebd54f602c9a469fd6?s=128&d=identicon&r=PG", "display_name": "Futile32", "link": "https://stackoverflow.com/users/1641739/futile32"}, "edited": false, "score": 4, "creation_date": 1519677125, "post_id": 41084841, "comment_id": 84998535, "body": "Any idea how you would tackle dialing this approach in to hit a particular Target %. Like if you wanted to simulate an 40% or 85% load?"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 16, "last_activity_date": 1533880700, "last_edit_date": 1533880700, "creation_date": 1481449486, "answer_id": 41084841, "question_id": 41079492, "link": "https://stackoverflow.com/questions/41079492/how-to-artificially-increase-cpu-usage/41084841#41084841", "title": "How to artificially increase CPU usage", "body": "<p>You don't really need any \"CPU-intensive\" calculations; you just have to avoid blocking operations (such as waiting for data on a network connection or writing to a file) and you need at least as many goroutines doing this as CPU cores you have available (this can be queried using <a href=\"https://golang.org/pkg/runtime/#NumCPU\" rel=\"noreferrer\"><code>runtime.NumCPU()</code></a>).</p>\n\n<p>Note that you don't even have to manually set the max number of CPUs that can execute simultaneously (<a href=\"https://golang.org/pkg/runtime/#GOMAXPROCS\" rel=\"noreferrer\"><code>runtime.GOMAXPROCS()</code></a>), as this defaults to the number of available cores since Go 1.5.</p>\n\n<p>Using <a href=\"https://golang.org/pkg/fmt/#Println\" rel=\"noreferrer\"><code>fmt.Println()</code></a> is a bad idea as it may be directed to a file, a network connection etc., and as such, printing to it may block (I/O wait).</p>\n\n<p>Use an \"endless\" loop which does nothing except check if it's time to abort. You can do this with a single channel, closing it when you want to abort, as receiving on a closed channel can proceed immediately, yielding the zero value of the element type of the channel, and goroutines may check it using the <code>select</code> statement while also having a <code>default</code> branch, else the <code>select</code> statement would just block forever.</p>\n\n<p>Simplest solution:</p>\n\n<pre><code>done := make(chan int)\n\nfor i := 0; i &lt; runtime.NumCPU(); i++ {\n    go func() {\n        for {\n            select {\n            case &lt;-done:\n                return\n            default:\n            }\n        }\n    }()\n}\n\ntime.Sleep(time.Second * 10)\nclose(done)\n</code></pre>\n"}], "owner": {"reputation": 219, "user_id": 863196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gUMCZ.jpg?s=128&g=1", "display_name": "Shariq", "link": "https://stackoverflow.com/users/863196/shariq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4485, "favorite_count": 5, "answer_count": 3, "score": 4, "last_activity_date": 1577576237, "creation_date": 1481398649, "last_edit_date": 1577576237, "question_id": 41079492, "link": "https://stackoverflow.com/questions/41079492/how-to-artificially-increase-cpu-usage", "title": "How to artificially increase CPU usage", "body": "<p>I need a Go code snippet to increase CPU usage, this is to test auto-scaling in a K8s cluster running a pod with my service written in Go. I tried with a loop calculating Sqrt as show below and print the result but it hardly utilizes the CPU.</p>\n\n<pre><code>num += math.Sqrt(num)\nfmt.Println(num)\n</code></pre>\n\n<p>It would be better if it's not an infinite loop since I need to also stop the load and test scaling in.</p>\n"}, {"tags": ["dictionary", "go", "initialization"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 62, "last_activity_date": 1481391463, "last_edit_date": 1481391463, "creation_date": 1481391100, "answer_id": 41078296, "question_id": 41078272, "link": "https://stackoverflow.com/questions/41078272/initializing-a-go-map-in-a-single-statement/41078296#41078296", "title": "Initializing a Go map in a single statement", "body": "<p>Yes, you can create a map with a single statement (called a <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"noreferrer\">composite literal</a> in the spec): </p>\n\n<pre><code>var keys = map[int]string{\n    1: \"aa\",\n    2: \"ab\",\n    3: \"ac\",\n    4: \"ba\",\n    5: \"bb\",\n    6: \"bc\",\n    7: \"ca\",\n    8: \"cb\",\n    9: \"cc\",\n}\n</code></pre>\n\n<p>Or, if you are inside of a function, you can use a <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"noreferrer\">short variable declaration</a>:</p>\n\n<pre><code>keys := map[int]string{\n    1: \"aa\",\n    2: \"ab\",\n    3: \"ac\",\n    4: \"ba\",\n    5: \"bb\",\n    6: \"bc\",\n    7: \"ca\",\n    8: \"cb\",\n    9: \"cc\",\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 7, "last_activity_date": 1481444755, "last_edit_date": 1495540802, "creation_date": 1481393711, "answer_id": 41078714, "question_id": 41078272, "link": "https://stackoverflow.com/questions/41078272/initializing-a-go-map-in-a-single-statement/41078714#41078714", "title": "Initializing a Go map in a single statement", "body": "<p>When there is logic between keys and values, you may also use a loop to initialize the map. \"Put\" the logic into the loop body. This may be significantly shorter than using a <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"nofollow noreferrer\">composite literal</a> enumerating all key-value pairs, especially if the number of key-value pairs is big.</p>\n\n<p>Your example can be implemented with this:</p>\n\n<pre><code>m := map[int]string{}\nfor i := 0; i &lt; 9; i++ {\n    m[i+1] = string(\"abc\"[i/3]) + string(\"abc\"[i%3])\n}\nfmt.Println(m)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/ekOi0L0Gr8\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>map[5:bb 8:cb 4:ba 2:ab 3:ac 6:bc 7:ca 9:cc 1:aa]\n</code></pre>\n\n<p>A variant of this solution (using a different logic implementation):</p>\n\n<pre><code>m := map[int]string{}\nfor i := 0; i &lt; 9; i++ {\n    m[i+1] = \"abc\"[i/3:i/3+1] + \"abc\"[i%3:i%3+1]\n}\nfmt.Println(m)\n</code></pre>\n\n<p>Output is the \"same\". Try this variant on the <a href=\"https://play.golang.org/p/0PQJ6EDCIy\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p>And even more solutions, now posting only the loop body (Playground links:  <a href=\"https://play.golang.org/p/mYJ-ikF7qc\" rel=\"nofollow noreferrer\">another #1</a>, <a href=\"https://play.golang.org/p/lqKFhdNJJz\" rel=\"nofollow noreferrer\">another #2</a>):</p>\n\n<pre><code>// Another #1:\nm[i+1] = fmt.Sprintf(\"%c%c\", \"abc\"[i/3], \"abc\"[i%3])\n// Another #2:\nm[i+1] = fmt.Sprintf(\"%c%c\", 'a'+i/3, 'a'+i%3)\n</code></pre>\n\n<p>A different approach might use 2 loops (embedded) which generate the value, and calculates the key from the value:</p>\n\n<pre><code>for i := 'a'; i &lt;= 'c'; i++ {\n    for j := 'a'; j &lt;= 'c'; j++ {\n        m[int((i-'a')*3+j-'a'+1)] = string(i) + string(j)\n    }\n}\n</code></pre>\n\n<p>Try this on the <a href=\"https://play.golang.org/p/SwvfsXJVOA\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p>If the number of values is not big, another viable approach can be to enumerate all the elements in one <code>string</code> value, and use subslicing (which is efficient as no new backing arrays will be created, the backing array of the strings is shared):</p>\n\n<pre><code>const s = \"aaabacbabbbccacbcc\"\n\nm := map[int]string{}\nfor i := 0; i &lt; 9; i++ {\n    m[i+1] = s[i*2 : i*2+2]\n}\nfmt.Println(m)\n</code></pre>\n\n<p>Output (try this on the <a href=\"https://play.golang.org/p/L-fJpTFeeA\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>map[9:cc 1:aa 2:ab 5:bb 8:cb 3:ac 4:ba 6:bc 7:ca]\n</code></pre>\n\n<p>Also note that if the key is of type <code>int</code> and the set of keys is (more or less) contiguous, often it is more efficient (both memory and performance-wise) to use a slice instead:</p>\n\n<pre><code>m := make([]string, 10)\nfor i := 0; i &lt; 9; i++ {\n    m[i+1] = fmt.Sprintf(\"%c%c\", 'a'+i/3, 'a'+i%3)\n}\nfmt.Printf(\"%q\\n\", m)\n\nm2 := []string{\"\", \"aa\", \"ab\", \"ac\", \"ba\", \"bb\", \"bc\", \"ca\", \"cb\", \"cc\"}\nfmt.Printf(\"%q\\n\", m2)\n\nm3 := []string{1: \"aa\", \"ab\", \"ac\", \"ba\", \"bb\", \"bc\", \"ca\", \"cb\", \"cc\"}\nfmt.Printf(\"%q\\n\", m3)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/Jrn2DTi7br\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[\"\" \"aa\" \"ab\" \"ac\" \"ba\" \"bb\" \"bc\" \"ca\" \"cb\" \"cc\"]\n[\"\" \"aa\" \"ab\" \"ac\" \"ba\" \"bb\" \"bc\" \"ca\" \"cb\" \"cc\"]\n[\"\" \"aa\" \"ab\" \"ac\" \"ba\" \"bb\" \"bc\" \"ca\" \"cb\" \"cc\"]\n</code></pre>\n\n<p>As you can see in the third example <code>m3</code>, you can use optional indices in the composite literal to specify the index of the value following. More about this here: <a href=\"https://stackoverflow.com/questions/36302441/keyed-items-in-golang-array-initialization/36302875#36302875\">Keyed items in golang array initialization</a> </p>\n"}, {"comments": [{"owner": {"reputation": 14380, "user_id": 31818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3487ce6ed9ec277bac79a838537b46a8?s=128&d=identicon&r=PG", "display_name": "seh", "link": "https://stackoverflow.com/users/31818/seh"}, "edited": false, "score": 0, "creation_date": 1481505092, "post_id": 41087916, "comment_id": 69390702, "body": "Your <code>initMap</code> function should supply an initial capacity for the map as a second argument to <code>make</code>: <code>len(sa)</code>."}, {"owner": {"reputation": 804, "user_id": 7171834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9r1VB.png?s=128&g=1", "display_name": "Peter Gloor", "link": "https://stackoverflow.com/users/7171834/peter-gloor"}, "reply_to_user": {"reputation": 14380, "user_id": 31818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3487ce6ed9ec277bac79a838537b46a8?s=128&d=identicon&r=PG", "display_name": "seh", "link": "https://stackoverflow.com/users/31818/seh"}, "edited": false, "score": 1, "creation_date": 1481573522, "post_id": 41087916, "comment_id": 69421805, "body": "The capacity is important for slices, but maps work different and dont have a capacity. You are right, in case of large maps you can and should provide an optional size parameter in the make statement. In case of small maps, like in this example, you probably wont recognize any measurable performance gain."}, {"owner": {"reputation": 14380, "user_id": 31818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3487ce6ed9ec277bac79a838537b46a8?s=128&d=identicon&r=PG", "display_name": "seh", "link": "https://stackoverflow.com/users/31818/seh"}, "edited": false, "score": 0, "creation_date": 1481579580, "post_id": 41087916, "comment_id": 69424955, "body": "Fine, call it &quot;initial space,&quot; as the specification does. The point is that it avoids the need for subsequent allocation and reorganization of the map. It&#39;s the &quot;capacity for avoiding table growth&quot; given its current allocation."}], "tags": [], "owner": {"reputation": 804, "user_id": 7171834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9r1VB.png?s=128&g=1", "display_name": "Peter Gloor", "link": "https://stackoverflow.com/users/7171834/peter-gloor"}, "is_accepted": false, "score": 1, "last_activity_date": 1481656810, "last_edit_date": 1481656810, "creation_date": 1481470870, "answer_id": 41087916, "question_id": 41078272, "link": "https://stackoverflow.com/questions/41078272/initializing-a-go-map-in-a-single-statement/41087916#41087916", "title": "Initializing a Go map in a single statement", "body": "<p>My preferred approach is a composite literal in a short variable declaration. In some cases a function might help to reduce clutter. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\n// initMap initializes a map with an integer key starting at 1\nfunc initMap(sa []string) map[int]string {\n    m := make(map[int]string, len(sa))\n    for k, v := range sa {\n        m[k+1] = v // add 1 to k as it is starting at base 0\n    }\n    return m\n}\n\n// main is the entry point of any go application\nfunc main() {\n    // My preferred approach is a composite literal in a short variable declaration\n    keys := map[int]string{1: \"aa\", 2: \"ab\", 3: \"ac\", 4: \"ba\", 5: \"bb\", 6: \"bc\", 7: \"ca\", 8: \"cb\", 9: \"cc\"}\n    fmt.Println(keys)\n\n    // Using a function to initialize the map might help to avoid clutter\n    keys2 := initMap([]string{\"aa\", \"ab\", \"ac\", \"ba\", \"bb\", \"bc\", \"ca\", \"cb\", \"cc\"})\n    fmt.Println(keys2)\n}\n</code></pre>\n\n<p>See it in action at <a href=\"https://play.golang.org/p/Rrb9ChBkXW\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Rrb9ChBkXW</a></p>\n"}], "owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27892, "favorite_count": 5, "accepted_answer_id": 41078296, "answer_count": 3, "score": 26, "last_activity_date": 1574092560, "creation_date": 1481390949, "last_edit_date": 1574092560, "question_id": 41078272, "link": "https://stackoverflow.com/questions/41078272/initializing-a-go-map-in-a-single-statement", "title": "Initializing a Go map in a single statement", "body": "<p>This is my code:</p>\n\n<pre><code>var keys map[int]string\nkeys = make(map[int]string)\n\nkeys[1] = \"aa\"\nkeys[2] = \"ab\"\nkeys[3] = \"ac\"\nkeys[4] = \"ba\"\nkeys[5] = \"bb\"\nkeys[6] = \"bc\"\nkeys[7] = \"ca\"\nkeys[8] = \"cb\"\nkeys[9] = \"cc\"\n</code></pre>\n\n<p>Can I do the same thing in one statement and/or in one line?</p>\n"}, {"tags": ["go", "constructor", "function-pointers", "go-interface"], "comments": [{"owner": {"reputation": 438, "user_id": 4415841, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DB5caEBdrzM/AAAAAAAAAAI/AAAAAAAAAGc/6ZL5xamCycc/photo.jpg?sz=128", "display_name": "Jorge Marey", "link": "https://stackoverflow.com/users/4415841/jorge-marey"}, "edited": false, "score": 1, "creation_date": 1481393428, "post_id": 41078189, "comment_id": 69363500, "body": "Try to change the return type of NewASimpleRulesEngine to RulesEngine"}, {"owner": {"reputation": 3006, "user_id": 920130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/eF81F.jpg?s=128&g=1", "display_name": "Mathias Dolidon", "link": "https://stackoverflow.com/users/920130/mathias-dolidon"}, "reply_to_user": {"reputation": 438, "user_id": 4415841, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DB5caEBdrzM/AAAAAAAAAAI/AAAAAAAAAGc/6ZL5xamCycc/photo.jpg?sz=128", "display_name": "Jorge Marey", "link": "https://stackoverflow.com/users/4415841/jorge-marey"}, "edited": false, "score": 0, "creation_date": 1481394603, "post_id": 41078189, "comment_id": 69363911, "body": "Thanks, it did work, although it does feel somewhat unsatisfactory. Now my objects can&#39;t easily implement several interfaces, can they ?"}], "answers": [{"comments": [{"owner": {"reputation": 14380, "user_id": 31818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3487ce6ed9ec277bac79a838537b46a8?s=128&d=identicon&r=PG", "display_name": "seh", "link": "https://stackoverflow.com/users/31818/seh"}, "edited": false, "score": 1, "creation_date": 1481505375, "post_id": 41078995, "comment_id": 69390752, "body": "Go does not have covariant return types, per the following FAQ entry: <a href=\"https://golang.org/doc/faq#covariant_types\" rel=\"nofollow noreferrer\">golang.org/doc/faq#covariant_types</a>. To my mind, it&#39;s not so much an explanation of <i>why</i> as it is confirmation of the intended lack. Nor does it give a hint of how to get what you want. Instead, it tells you not to want that."}], "tags": [], "owner": {"reputation": 3006, "user_id": 920130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/eF81F.jpg?s=128&g=1", "display_name": "Mathias Dolidon", "link": "https://stackoverflow.com/users/920130/mathias-dolidon"}, "is_accepted": true, "score": 0, "last_activity_date": 1481713279, "last_edit_date": 1481713279, "creation_date": 1481395267, "answer_id": 41078995, "question_id": 41078189, "link": "https://stackoverflow.com/questions/41078189/store-a-collection-of-constructors-for-types-that-all-conform-to-the-same-interf/41078995#41078995", "title": "Store a collection of constructors for types that all conform to the same interface", "body": "<p>(edited : I've accepted my own answer for lack of any other, but its most relevant part is @seh 's comment below)</p>\n\n<hr>\n\n<p>Following @JorgeMarey 's comment, and not wanting to sacrifice the constructor's type signature, I came up with this. But it does feel very tacky to me. I'll be glad to hear about a cleaner way.</p>\n\n<pre><code>func init() {\n    rulesEngineConstructorsPerExtension = make(map[string](func(string)RulesEngine))\n\n    cast_NewASimpleRulesEngine := func(content string) RulesEngine {\n        return NewASimpleRulesEngine(content)\n    }\n\n    rulesEngineConstructorsPerExtension[\".ini\"] = cast_NewASimpleRulesEngine\n}\n</code></pre>\n\n<p>(an attempt to explicitly cast with <code>(func(string)RulesEngine)( NewASimpleRulesEngine)</code> was deemed unfit by the compiler too)</p>\n"}], "owner": {"reputation": 3006, "user_id": 920130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/eF81F.jpg?s=128&g=1", "display_name": "Mathias Dolidon", "link": "https://stackoverflow.com/users/920130/mathias-dolidon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 41078995, "answer_count": 1, "score": 0, "last_activity_date": 1481713279, "creation_date": 1481390449, "last_edit_date": 1481395601, "question_id": 41078189, "link": "https://stackoverflow.com/questions/41078189/store-a-collection-of-constructors-for-types-that-all-conform-to-the-same-interf", "title": "Store a collection of constructors for types that all conform to the same interface", "body": "<p>I'm making an app that'll need sets of rules to run a job. The app offers the possibility to express the rules in one of several different languages.  I therefore have defined an interface to a live rules engine, that offers the methods that the app will need to query the current set of rules. Behind this interface, there will be one different type of engine, according to the source language.</p>\n\n<p>Now I'd like to instantiate a rules engine according to the rule file's extension. But I get some errors which I have a hard time to overcome.</p>\n\n<p>Let me first offer this simplified skeleton :</p>\n\n<pre><code>package main\n\n//\n//\n// The interface\n\ntype RulesEngine interface {\n    SomeRuleEvaluator(string) bool\n}\n\n//\n//\n// An implementation, with its constructor\n\ntype ASimpleRulesEngine struct {\n    // I've also tried with :\n    // RulesEngine\n}\n\nfunc NewASimpleRulesEngine(context string) *ASimpleRulesEngine {\n    re := ASimpleRulesEngine{}\n    return &amp;re\n}\n\nfunc (re *ASimpleRulesEngine) SomeRuleEvaluator(dummy string) bool {\n    return true\n}\n\n//\n//\n// A client, that'll want to be able to choose a constructor\n\nvar rulesEngineConstructorsPerExtension map[string](func(string) RulesEngine)\n\nfunc init() {\n    rulesEngineConstructorsPerExtension = make(map[string](func(string)RulesEngine))\n    rulesEngineConstructorsPerExtension[\".ini\"] = NewASimpleRulesEngine\n}\n\nfunc main() {\n}\n</code></pre>\n\n<p>When I try to build this, I get <code>35: cannot use NewASimpleRulesEngine (type func(string) *ASimpleRulesEngine) as type func(string) RulesEngine in assignment</code></p>\n\n<p>I've also tried :</p>\n\n<ul>\n<li>assigning without a pointer, although I felt stupid while trying it</li>\n<li>having an intermediate step in the <code>init</code>function, where I'd create a <code>new(func (string) RulesEngine)</code> and then assign to it, with and without pointer.</li>\n<li>storing function pointers like in C, but the compiler said it could not take the adress of my function.</li>\n</ul>\n\n<p>I'm not that familiar with Go and this felt a bit surprising. What would be the proper type signature to use ? Is this possible at all ? If it's unavoidable, I'll obviously have a simple array of extensions on one side (to check if a file is potentially a rules file), and a big <code>switch</code> on the other side to provide the adequate constructor, but as much possible I'd like to avoid such duplication.</p>\n\n<p>Thank you for any insight !</p>\n"}, {"tags": ["go", "jwt", "jwt-go"], "comments": [{"owner": {"reputation": 906, "user_id": 497300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c8cc3daf6dde73ad11a7e27cf3bc20?s=128&d=identicon&r=PG", "display_name": "trung", "link": "https://stackoverflow.com/users/497300/trung"}, "edited": false, "score": 0, "creation_date": 1560523539, "post_id": 41077953, "comment_id": 99779907, "body": "I answered <a href=\"https://stackoverflow.com/questions/45405626/decoding-jwt-token-in-golang/56600389#56600389\">similar question</a> and the answer shows examples using an <a href=\"https://github.com/square/go-jose/\" rel=\"nofollow noreferrer\">alternate library</a> to do similar (better IMO)"}], "answers": [{"comments": [{"owner": {"reputation": 1745, "user_id": 3888307, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/65d6a22ea2fb9fb7a3d78bd57b9d71ea?s=128&d=identicon&r=PG&f=1", "display_name": "user3888307", "link": "https://stackoverflow.com/users/3888307/user3888307"}, "edited": false, "score": 1, "creation_date": 1481390843, "post_id": 41078085, "comment_id": 69362697, "body": "That worked ! I put the code on the GO Playground so others can see the code. <a href=\"https://play.golang.org/p/fkag0DMexY\" rel=\"nofollow noreferrer\">play.golang.org/p/fkag0DMexY</a>"}, {"owner": {"reputation": 727, "user_id": 3365278, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d58c4b6b44306a99fd704477e729acc6?s=128&d=identicon&r=PG", "display_name": "Lewis Lebentz", "link": "https://stackoverflow.com/users/3365278/lewis-lebentz"}, "edited": false, "score": 0, "creation_date": 1562340524, "post_id": 41078085, "comment_id": 100356271, "body": "@Tim has this code broken now? If I run it directly it just says unable to find key."}, {"owner": {"reputation": 727, "user_id": 3365278, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d58c4b6b44306a99fd704477e729acc6?s=128&d=identicon&r=PG", "display_name": "Lewis Lebentz", "link": "https://stackoverflow.com/users/3365278/lewis-lebentz"}, "edited": false, "score": 1, "creation_date": 1562354331, "post_id": 41078085, "comment_id": 100361073, "body": "Apologies, this does work, just had to update the token and jwks url to a valid one!"}, {"owner": {"reputation": 1159, "user_id": 666397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/097ee41669d9e37f526dfcf396a632b0?s=128&d=identicon&r=PG", "display_name": "Atifm", "link": "https://stackoverflow.com/users/666397/atifm"}, "edited": false, "score": 0, "creation_date": 1565204058, "post_id": 41078085, "comment_id": 101282955, "body": "Looks like the current version of the jwx library is at: &quot;github.com/lestrrat-go/jwx&quot;"}, {"owner": {"reputation": 1255, "user_id": 433168, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e257008a27d31126a51c3277a2931518?s=128&d=identicon&r=PG", "display_name": "Jim Wharton", "link": "https://stackoverflow.com/users/433168/jim-wharton"}, "edited": false, "score": 0, "creation_date": 1593826190, "post_id": 41078085, "comment_id": 110921473, "body": "Is it possible the API for jwx keeps changing? I&#39;m getting <code>key[0].Materialize undefined (type jwk.Key has no field or method Materialize)</code>"}, {"owner": {"reputation": 863, "user_id": 445372, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/770d69559776cf668d129a85931180c4?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/445372/david"}, "reply_to_user": {"reputation": 1255, "user_id": 433168, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e257008a27d31126a51c3277a2931518?s=128&d=identicon&r=PG", "display_name": "Jim Wharton", "link": "https://stackoverflow.com/users/433168/jim-wharton"}, "edited": false, "score": 3, "creation_date": 1594231435, "post_id": 41078085, "comment_id": 111057050, "body": "@JimWharton there&#39;s an example of the new <code>Raw</code> method that replaced Materialize in the Readme.md"}, {"owner": {"reputation": 1255, "user_id": 433168, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e257008a27d31126a51c3277a2931518?s=128&d=identicon&r=PG", "display_name": "Jim Wharton", "link": "https://stackoverflow.com/users/433168/jim-wharton"}, "reply_to_user": {"reputation": 863, "user_id": 445372, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/770d69559776cf668d129a85931180c4?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/445372/david"}, "edited": false, "score": 0, "creation_date": 1594245744, "post_id": 41078085, "comment_id": 111062935, "body": "Thank you @David, I dug into the docs a bit more and did find that."}, {"owner": {"reputation": 814, "user_id": 2962507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd475510f51619445b5235fe1dbe754?s=128&d=identicon&r=PG", "display_name": "dinvlad", "link": "https://stackoverflow.com/users/2962507/dinvlad"}, "edited": false, "score": 0, "creation_date": 1600753226, "post_id": 41078085, "comment_id": 113178397, "body": "One should not forget to also verify key alg here ;)"}, {"owner": {"reputation": 596, "user_id": 363293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hlfV4.jpg?s=128&g=1", "display_name": "Ivaylo Novakov", "link": "https://stackoverflow.com/users/363293/ivaylo-novakov"}, "edited": false, "score": 3, "creation_date": 1608298623, "post_id": 41078085, "comment_id": 115547531, "body": "This doesn&#39;t work with the <code>lestrrat-go</code> version of the library. They broke compatibility and the <code>Materialize()</code> method doesn&#39;t exist anymore. The keys in the keyset are now <code>*jwk.rsaPublicKey</code> and we need <code>*rsa.PublicKey</code> in order to use dgrijalva&#39;s <code>jwt.Parse()</code>. I don&#39;t have a solution for the moment."}, {"owner": {"reputation": 311, "user_id": 3315934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e372beba07029914e8a5ee18510eb011?s=128&d=identicon&r=PG&f=1", "display_name": "Anton", "link": "https://stackoverflow.com/users/3315934/anton"}, "reply_to_user": {"reputation": 596, "user_id": 363293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hlfV4.jpg?s=128&g=1", "display_name": "Ivaylo Novakov", "link": "https://stackoverflow.com/users/363293/ivaylo-novakov"}, "edited": false, "score": 0, "creation_date": 1610217652, "post_id": 41078085, "comment_id": 116065175, "body": "@IvayloNovakov: <code>return key[0].Materialize()</code> above has been replaced with these two calls: <code>var empty interface{}</code> and then <code>return nil, key[0].Raw(&amp;empty)</code>. However, I also have a problem that the Parse method always returns an error : <code>key is of invalid type</code>. Any idea?"}, {"owner": {"reputation": 311, "user_id": 3315934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e372beba07029914e8a5ee18510eb011?s=128&d=identicon&r=PG&f=1", "display_name": "Anton", "link": "https://stackoverflow.com/users/3315934/anton"}, "edited": false, "score": 0, "creation_date": 1610218658, "post_id": 41078085, "comment_id": 116065501, "body": "Until I find a solution, I switch to <code>github.com&#47;lestrrat-go&#47;jwx v0.9.2</code> where <code>Materialize()</code> exists."}, {"owner": {"reputation": 311, "user_id": 3315934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e372beba07029914e8a5ee18510eb011?s=128&d=identicon&r=PG&f=1", "display_name": "Anton", "link": "https://stackoverflow.com/users/3315934/anton"}, "edited": false, "score": 0, "creation_date": 1610230860, "post_id": 41078085, "comment_id": 116068852, "body": "Found the solution using the Raw method (starting from <code>lestrrat-go&#47;jwx v1.x.y</code>): <code>var pubkey interface{}</code>, then <code>err := key[0].Raw(&amp;pubkey)</code> and <code>return pubkey, nil</code>. Ensure you do an error check on the <code>err</code> (return value of the Raw method)."}, {"owner": {"reputation": 444, "user_id": 9996080, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FoRKR.jpg?s=128&g=1", "display_name": "James South", "link": "https://stackoverflow.com/users/9996080/james-south"}, "edited": false, "score": 0, "creation_date": 1611880495, "post_id": 41078085, "comment_id": 116599892, "body": "See <a href=\"https://stackoverflow.com/questions/56905995/how-to-verify-a-jwt-token-from-aws-cognito-in-go#answer-65947083\">my answer</a> to a similar question. <code>github.com&#47;dgrijalva&#47;jwt-go</code> doesn&#39;t seem to be maintained anymore."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 36, "last_activity_date": 1565204768, "last_edit_date": 1565204768, "creation_date": 1481389652, "answer_id": 41078085, "question_id": 41077953, "link": "https://stackoverflow.com/questions/41077953/go-language-and-verify-jwt/41078085#41078085", "title": "Go Language and Verify JWT", "body": "<p>Below is an example of JWT decoding and verification. It uses both the <a href=\"https://godoc.org/github.com/dgrijalva/jwt-go\" rel=\"noreferrer\">jwt-go</a> and <a href=\"https://godoc.org/github.com/lestrrat-go/jwx/jwk\" rel=\"noreferrer\">jwk</a> packages:</p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n\n    \"github.com/dgrijalva/jwt-go\"\n    \"github.com/lestrrat-go/jwx/jwk\"\n)\n\nconst token = `eyJhbGciOiJSUzI1NiIsImtpZCI6Ind5TXdLNEE2Q0w5UXcxMXVvZlZleVExMTlYeVgteHlreW1ra1h5Z1o1T00ifQ.eyJzdWIiOiIwMHUxOGVlaHUzNDlhUzJ5WDFkOCIsIm5hbWUiOiJva3RhcHJveHkgb2t0YXByb3h5IiwidmVyIjoxLCJpc3MiOiJodHRwczovL2NvbXBhbnl4Lm9rdGEuY29tIiwiYXVkIjoidlpWNkNwOHJuNWx4ck45YVo2ODgiLCJpYXQiOjE0ODEzODg0NTMsImV4cCI6MTQ4MTM5MjA1MywianRpIjoiSUQuWm9QdVdIR3IxNkR6a3RUbEdXMFI4b1lRaUhnVWg0aUotTHo3Z3BGcGItUSIsImFtciI6WyJwd2QiXSwiaWRwIjoiMDBveTc0YzBnd0hOWE1SSkJGUkkiLCJub25jZSI6Im4tMFM2X1d6QTJNaiIsInByZWZlcnJlZF91c2VybmFtZSI6Im9rdGFwcm94eUBva3RhLmNvbSIsImF1dGhfdGltZSI6MTQ4MTM4ODQ0MywiYXRfaGFzaCI6Im1YWlQtZjJJczhOQklIcV9CeE1ISFEifQ.OtVyCK0sE6Cuclg9VMD2AwLhqEyq2nv3a1bfxlzeS-bdu9KtYxcPSxJ6vxMcSSbMIIq9eEz9JFMU80zqgDPHBCjlOsC5SIPz7mm1Z3gCwq4zsFJ-2NIzYxA3p161ZRsPv_3bUyg9B_DPFyBoihgwWm6yrvrb4rmHXrDkjxpxCLPp3OeIpc_kb2t8r5HEQ5UBZPrsiScvuoVW13YwWpze59qBl_84n9xdmQ5pS7DklzkAVgqJT_NWBlb5uo6eW26HtJwHzss7xOIdQtcOtC1Gj3O82a55VJSQnsEEBeqG1ESb5Haq_hJgxYQnBssKydPCIxdZiye-0Ll9L8wWwpzwig`\n\nconst jwksURL = `https://companyx.okta.com/oauth2/v1/keys`\n\nfunc getKey(token *jwt.Token) (interface{}, error) {\n\n    // TODO: cache response so we don't have to make a request every time\n    // we want to verify a JWT\n    set, err := jwk.FetchHTTP(jwksURL)\n    if err != nil {\n        return nil, err\n    }\n\n    keyID, ok := token.Header[\"kid\"].(string)\n    if !ok {\n        return nil, errors.New(\"expecting JWT header to have string kid\")\n    }\n\n    if key := set.LookupKeyID(keyID); len(key) == 1 {\n        return key[0].Materialize()\n    }\n\n    return nil, fmt.Errorf(\"unable to find key %q\", keyID)\n}\n\nfunc main() {\n    token, err := jwt.Parse(token, getKey)\n    if err != nil {\n        panic(err)\n    }\n    claims := token.Claims.(jwt.MapClaims)\n    for key, value := range claims {\n        fmt.Printf(\"%s\\t%v\\n\", key, value)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 332, "user_id": 14797322, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ExHOE.jpg?s=128&g=1", "display_name": "Micah Parks", "link": "https://stackoverflow.com/users/14797322/micah-parks"}, "is_accepted": false, "score": 0, "last_activity_date": 1615423409, "creation_date": 1615423409, "answer_id": 66574942, "question_id": 41077953, "link": "https://stackoverflow.com/questions/41077953/go-language-and-verify-jwt/66574942#66574942", "title": "Go Language and Verify JWT", "body": "<p>I've had a very similar use case recently so I read through some RFCs and authored this package: <a href=\"https://github.com/MicahParks/keyfunc\" rel=\"nofollow noreferrer\"><code>github.com/MicahParks/keyfunc</code></a>.</p>\n<p>It allows you to use the most popular JWT package, <a href=\"https://github.com/dgrijalva/jwt-go\" rel=\"nofollow noreferrer\"><code>github.com/dgrijalva/jwt-go</code></a>, to parse tokens. It can also automatically live reload the contents of your JWKS in a background goroutine.</p>\n<p>Using your JWKS and JWT, here are two examples. The first will load the JWKS from a remote URL via HTTPS. The second will load it from static JSON.</p>\n<h1>From JWKS hosted via HTTPS</h1>\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    &quot;log&quot;\n    &quot;time&quot;\n\n    &quot;github.com/dgrijalva/jwt-go&quot;\n\n    &quot;github.com/MicahParks/keyfunc&quot;\n)\n\nfunc main() {\n\n    // Get the JWKS URL.\n    jwksURL := &quot;https://companyx.okta.com/oauth2/v1/keys&quot;\n\n    // Create the keyfunc options. Refresh the JWKS every hour and log errors.\n    refreshInterval := time.Hour\n    options := keyfunc.Options{\n        RefreshInterval: &amp;refreshInterval,\n        RefreshErrorHandler: func(err error) {\n            log.Printf(&quot;There was an error with the jwt.KeyFunc\\nError: %s&quot;, err.Error())\n        },\n    }\n\n    // Create the JWKS from the resource at the given URL.\n    jwks, err := keyfunc.Get(jwksURL, options)\n    if err != nil {\n        log.Fatalf(&quot;Failed to create JWKS from resource at the given URL.\\nError: %s&quot;, err.Error())\n    }\n\n    // Get a JWT to parse.\n    jwtB64 := &quot;eyJhbGciOiJSUzI1NiIsImtpZCI6Ind5TXdLNEE2Q0w5UXcxMXVvZlZleVExMTlYeVgteHlreW1ra1h5Z1o1T00ifQ.eyJzdWIiOiIwMHUxOGVlaHUzNDlhUzJ5WDFkOCIsIm5hbWUiOiJva3RhcHJveHkgb2t0YXByb3h5IiwidmVyIjoxLCJpc3MiOiJodHRwczovL2NvbXBhbnl4Lm9rdGEuY29tIiwiYXVkIjoidlpWNkNwOHJuNWx4ck45YVo2ODgiLCJpYXQiOjE0ODEzODg0NTMsImV4cCI6MTQ4MTM5MjA1MywianRpIjoiSUQuWm9QdVdIR3IxNkR6a3RUbEdXMFI4b1lRaUhnVWg0aUotTHo3Z3BGcGItUSIsImFtciI6WyJwd2QiXSwiaWRwIjoiMDBveTc0YzBnd0hOWE1SSkJGUkkiLCJub25jZSI6Im4tMFM2X1d6QTJNaiIsInByZWZlcnJlZF91c2VybmFtZSI6Im9rdGFwcm94eUBva3RhLmNvbSIsImF1dGhfdGltZSI6MTQ4MTM4ODQ0MywiYXRfaGFzaCI6Im1YWlQtZjJJczhOQklIcV9CeE1ISFEifQ.OtVyCK0sE6Cuclg9VMD2AwLhqEyq2nv3a1bfxlzeS-bdu9KtYxcPSxJ6vxMcSSbMIIq9eEz9JFMU80zqgDPHBCjlOsC5SIPz7mm1Z3gCwq4zsFJ-2NIzYxA3p161ZRsPv_3bUyg9B_DPFyBoihgwWm6yrvrb4rmHXrDkjxpxCLPp3OeIpc_kb2t8r5HEQ5UBZPrsiScvuoVW13YwWpze59qBl_84n9xdmQ5pS7DklzkAVgqJT_NWBlb5uo6eW26HtJwHzss7xOIdQtcOtC1Gj3O82a55VJSQnsEEBeqG1ESb5Haq_hJgxYQnBssKydPCIxdZiye-0Ll9L8wWwpzwig&quot;\n\n    // Parse the JWT.\n    token, err := jwt.Parse(jwtB64, jwks.KeyFunc)\n    if err != nil {\n        log.Fatalf(&quot;Failed to parse the JWT.\\nError: %s&quot;, err.Error())\n    }\n\n    // Check if the token is valid.\n    if !token.Valid {\n        log.Fatalf(&quot;The token is not valid.&quot;)\n    }\n\n    log.Println(&quot;The token is valid.&quot;)\n}\n</code></pre>\n<h1>From JWKS as JSON</h1>\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    &quot;encoding/json&quot;\n    &quot;log&quot;\n\n    &quot;github.com/dgrijalva/jwt-go&quot;\n\n    &quot;github.com/MicahParks/keyfunc&quot;\n)\n\nfunc main() {\n\n    // Get the JWKS as JSON.\n    var jwksJSON json.RawMessage = []byte(`{&quot;keys&quot;:[{&quot;alg&quot;:&quot;RS256&quot;,&quot;e&quot;:&quot;AQAB&quot;,&quot;n&quot;:&quot;ok6rvXu95337IxsDXrKzlIqw_I_zPDG8JyEw2CTOtNMoDi1QzpXQVMGj2snNEmvNYaCTmFf51I-EDgeFLLexr40jzBXlg72quV4aw4yiNuxkigW0gMA92OmaT2jMRIdDZM8mVokoxyPfLub2YnXHFq0XuUUgkX_TlutVhgGbyPN0M12teYZtMYo2AUzIRggONhHvnibHP0CPWDjCwSfp3On1Recn4DPxbn3DuGslF2myalmCtkujNcrhHLhwYPP-yZFb8e0XSNTcQvXaQxAqmnWH6NXcOtaeWMQe43PNTAyNinhndgI8ozG3Hz-1NzHssDH_yk6UYFSszhDbWAzyqw&quot;,&quot;kid&quot;:&quot;wyMwK4A6CL9Qw11uofVeyQ119XyX-xykymkkXygZ5OM&quot;,&quot;kty&quot;:&quot;RSA&quot;,&quot;use&quot;:&quot;sig&quot;},{&quot;alg&quot;:&quot;RS256&quot;,&quot;e&quot;:&quot;AQAB&quot;,&quot;n&quot;:&quot;nXv6FSAcMjuanQ2hIIUb8Vkqe94t98kPh2T8-0j6-Jq8pOclgKdtVeIZcBE9F_XiuJvg4b6WVs-uvA-pS8mmMvQ21xU5Q_37Cojv8v_QlHWETHwEJdXXiY2Xq5LgXDSwEhhdDZHSMQYDuvhp_P6nl2LNqqUvJkjoFWcnn2btgSIUQROIaDdxtx7_2h4oUi5u11BGSF2SZZiEpDAKT08Htv3uwXdwDA6ll99fbi8X8RmH5oY_tIZTeIzu50qHxElPewoYO8QrJYsO9oFcCPMHGxYWjXQEa-QZYgo0wS9zRIkeJc5kshc4-9Uhv2DVIjk_-ofGlML9ieggGyillBKptw&quot;,&quot;kid&quot;:&quot;GRF55Lbzgg4sANCmER-sm55eX_qUOpY8UTptDmDG_6U&quot;,&quot;kty&quot;:&quot;RSA&quot;,&quot;use&quot;:&quot;sig&quot;}]}`)\n\n    // Create the JWKS from the resource at the given URL.\n    jwks, err := keyfunc.New(jwksJSON)\n    if err != nil {\n        log.Fatalf(&quot;Failed to create JWKS from resource at the given URL.\\nError: %s&quot;, err.Error())\n    }\n\n    // Get a JWT to parse.\n    jwtB64 := &quot;eyJhbGciOiJSUzI1NiIsImtpZCI6Ind5TXdLNEE2Q0w5UXcxMXVvZlZleVExMTlYeVgteHlreW1ra1h5Z1o1T00ifQ.eyJzdWIiOiIwMHUxOGVlaHUzNDlhUzJ5WDFkOCIsIm5hbWUiOiJva3RhcHJveHkgb2t0YXByb3h5IiwidmVyIjoxLCJpc3MiOiJodHRwczovL2NvbXBhbnl4Lm9rdGEuY29tIiwiYXVkIjoidlpWNkNwOHJuNWx4ck45YVo2ODgiLCJpYXQiOjE0ODEzODg0NTMsImV4cCI6MTQ4MTM5MjA1MywianRpIjoiSUQuWm9QdVdIR3IxNkR6a3RUbEdXMFI4b1lRaUhnVWg0aUotTHo3Z3BGcGItUSIsImFtciI6WyJwd2QiXSwiaWRwIjoiMDBveTc0YzBnd0hOWE1SSkJGUkkiLCJub25jZSI6Im4tMFM2X1d6QTJNaiIsInByZWZlcnJlZF91c2VybmFtZSI6Im9rdGFwcm94eUBva3RhLmNvbSIsImF1dGhfdGltZSI6MTQ4MTM4ODQ0MywiYXRfaGFzaCI6Im1YWlQtZjJJczhOQklIcV9CeE1ISFEifQ.OtVyCK0sE6Cuclg9VMD2AwLhqEyq2nv3a1bfxlzeS-bdu9KtYxcPSxJ6vxMcSSbMIIq9eEz9JFMU80zqgDPHBCjlOsC5SIPz7mm1Z3gCwq4zsFJ-2NIzYxA3p161ZRsPv_3bUyg9B_DPFyBoihgwWm6yrvrb4rmHXrDkjxpxCLPp3OeIpc_kb2t8r5HEQ5UBZPrsiScvuoVW13YwWpze59qBl_84n9xdmQ5pS7DklzkAVgqJT_NWBlb5uo6eW26HtJwHzss7xOIdQtcOtC1Gj3O82a55VJSQnsEEBeqG1ESb5Haq_hJgxYQnBssKydPCIxdZiye-0Ll9L8wWwpzwig&quot;\n\n    // Parse the JWT.\n    token, err := jwt.Parse(jwtB64, jwks.KeyFunc)\n    if err != nil {\n        log.Fatalf(&quot;Failed to parse the JWT.\\nError: %s&quot;, err.Error())\n    }\n\n    // Check if the token is valid.\n    if !token.Valid {\n        log.Fatalf(&quot;The token is not valid.&quot;)\n    }\n\n    log.Println(&quot;The token is valid.&quot;)\n}\n</code></pre>\n"}], "owner": {"reputation": 1745, "user_id": 3888307, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/65d6a22ea2fb9fb7a3d78bd57b9d71ea?s=128&d=identicon&r=PG&f=1", "display_name": "user3888307", "link": "https://stackoverflow.com/users/3888307/user3888307"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7573, "favorite_count": 5, "accepted_answer_id": 41078085, "answer_count": 2, "score": 16, "last_activity_date": 1615423409, "creation_date": 1481388905, "last_edit_date": 1588106746, "question_id": 41077953, "link": "https://stackoverflow.com/questions/41077953/go-language-and-verify-jwt", "title": "Go Language and Verify JWT", "body": "<p>I have been searching for an example I can understand of how to validate the signature of a JWT with the GO Language.</p>\n\n<p>This might be especially tricky since I am using Okta, and it uses JWKs, so it is not especially straight forward.</p>\n\n<p>When I receive a JWT, I can decode it no problem, just get stuck on how to verify the signature.</p>\n\n<p>Below I have included a JWT, and the JWK details. If anyone is comfortable with this, and can complete signature validation with an Example, that would be amazing.:)</p>\n\n<p>You can get to all of this information here: <a href=\"https://oktaproxy.com/oidcgenerator.php\" rel=\"noreferrer\">https://oktaproxy.com/oidcgenerator.php</a>, this site will generate a JWT from Okta, and the keys can be obtained here: <a href=\"https://companyx.okta.com/oauth2/v1/keys\" rel=\"noreferrer\">https://companyx.okta.com/oauth2/v1/keys</a>.</p>\n\n<p>Here is the JWT: </p>\n\n<pre><code>eyJhbGciOiJSUzI1NiIsImtpZCI6Ind5TXdLNEE2Q0w5UXcxMXVvZlZleVExMTlYeVgteHlreW1ra1h5Z1o1T00ifQ.eyJzdWIiOiIwMHUxOGVlaHUzNDlhUzJ5WDFkOCIsIm5hbWUiOiJva3RhcHJveHkgb2t0YXByb3h5IiwidmVyIjoxLCJpc3MiOiJodHRwczovL2NvbXBhbnl4Lm9rdGEuY29tIiwiYXVkIjoidlpWNkNwOHJuNWx4ck45YVo2ODgiLCJpYXQiOjE0ODEzODg0NTMsImV4cCI6MTQ4MTM5MjA1MywianRpIjoiSUQuWm9QdVdIR3IxNkR6a3RUbEdXMFI4b1lRaUhnVWg0aUotTHo3Z3BGcGItUSIsImFtciI6WyJwd2QiXSwiaWRwIjoiMDBveTc0YzBnd0hOWE1SSkJGUkkiLCJub25jZSI6Im4tMFM2X1d6QTJNaiIsInByZWZlcnJlZF91c2VybmFtZSI6Im9rdGFwcm94eUBva3RhLmNvbSIsImF1dGhfdGltZSI6MTQ4MTM4ODQ0MywiYXRfaGFzaCI6Im1YWlQtZjJJczhOQklIcV9CeE1ISFEifQ.OtVyCK0sE6Cuclg9VMD2AwLhqEyq2nv3a1bfxlzeS-bdu9KtYxcPSxJ6vxMcSSbMIIq9eEz9JFMU80zqgDPHBCjlOsC5SIPz7mm1Z3gCwq4zsFJ-2NIzYxA3p161ZRsPv_3bUyg9B_DPFyBoihgwWm6yrvrb4rmHXrDkjxpxCLPp3OeIpc_kb2t8r5HEQ5UBZPrsiScvuoVW13YwWpze59qBl_84n9xdmQ5pS7DklzkAVgqJT_NWBlb5uo6eW26HtJwHzss7xOIdQtcOtC1Gj3O82a55VJSQnsEEBeqG1ESb5Haq_hJgxYQnBssKydPCIxdZiye-0Ll9L8wWwpzwig\n</code></pre>\n\n<p>Here are the Keys:</p>\n\n<pre><code>{\n   \"keys\":[\n      {\n         \"alg\":\"RS256\",\n         \"e\":\"AQAB\",\n         \"n\":\"ok6rvXu95337IxsDXrKzlIqw_I_zPDG8JyEw2CTOtNMoDi1QzpXQVMGj2snNEmvNYaCTmFf51I-EDgeFLLexr40jzBXlg72quV4aw4yiNuxkigW0gMA92OmaT2jMRIdDZM8mVokoxyPfLub2YnXHFq0XuUUgkX_TlutVhgGbyPN0M12teYZtMYo2AUzIRggONhHvnibHP0CPWDjCwSfp3On1Recn4DPxbn3DuGslF2myalmCtkujNcrhHLhwYPP-yZFb8e0XSNTcQvXaQxAqmnWH6NXcOtaeWMQe43PNTAyNinhndgI8ozG3Hz-1NzHssDH_yk6UYFSszhDbWAzyqw\",\n         \"kid\":\"wyMwK4A6CL9Qw11uofVeyQ119XyX-xykymkkXygZ5OM\",\n         \"kty\":\"RSA\",\n         \"use\":\"sig\"\n      },\n      {\n         \"alg\":\"RS256\",\n         \"e\":\"AQAB\",\n         \"n\":\"nXv6FSAcMjuanQ2hIIUb8Vkqe94t98kPh2T8-0j6-Jq8pOclgKdtVeIZcBE9F_XiuJvg4b6WVs-uvA-pS8mmMvQ21xU5Q_37Cojv8v_QlHWETHwEJdXXiY2Xq5LgXDSwEhhdDZHSMQYDuvhp_P6nl2LNqqUvJkjoFWcnn2btgSIUQROIaDdxtx7_2h4oUi5u11BGSF2SZZiEpDAKT08Htv3uwXdwDA6ll99fbi8X8RmH5oY_tIZTeIzu50qHxElPewoYO8QrJYsO9oFcCPMHGxYWjXQEa-QZYgo0wS9zRIkeJc5kshc4-9Uhv2DVIjk_-ofGlML9ieggGyillBKptw\",\n         \"kid\":\"GRF55Lbzgg4sANCmER-sm55eX_qUOpY8UTptDmDG_6U\",\n         \"kty\":\"RSA\",\n         \"use\":\"sig\"\n      }\n   ]\n}\n</code></pre>\n"}, {"tags": ["go", "redis"], "answers": [{"tags": [], "owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "is_accepted": true, "score": 3, "last_activity_date": 1481525669, "last_edit_date": 1592644375, "creation_date": 1481525669, "answer_id": 41095549, "question_id": 41077942, "link": "https://stackoverflow.com/questions/41077942/relation-between-pooltimeout-idletimeout-idlecheckfrequency-in-go-redis/41095549#41095549", "title": "Relation between PoolTimeout, IdleTimeout &amp; IdleCheckFrequency in go-redis", "body": "<p>This has been answered in github <a href=\"https://github.com/go-redis/redis/issues/441\" rel=\"nofollow noreferrer\">here</a>. Just posting the relevant parts below:-</p>\n<blockquote>\n<p>PoolSize limits max number of open connections. If app is idle then\ngo-redis does not open any connections.</p>\n<p>New connection is opened when there is a command to process and there\nare no idle connections in the pool. Idle connections are closed after\nthey are idle for IdleTimeout.</p>\n<p>IdleCheckFrequency specifies how often we check if connection is\nexpired. This is needed in case app is idle and there is no activity.\nNormally idle connections are closed when go-redis asks pool for a\n(healthy) connection.</p>\n</blockquote>\n"}], "owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1342, "favorite_count": 1, "accepted_answer_id": 41095549, "answer_count": 1, "score": 2, "last_activity_date": 1481525669, "creation_date": 1481388838, "last_edit_date": 1481389257, "question_id": 41077942, "link": "https://stackoverflow.com/questions/41077942/relation-between-pooltimeout-idletimeout-idlecheckfrequency-in-go-redis", "title": "Relation between PoolTimeout, IdleTimeout &amp; IdleCheckFrequency in go-redis", "body": "<p>Can someone let me know the relation between <a href=\"https://github.com/go-redis/redis/blob/854c88a72c8bb9c09936145aef886b7697d6b995/options.go#L54\" rel=\"nofollow noreferrer\">PoolTimeout</a>, <a href=\"https://github.com/go-redis/redis/blob/854c88a72c8bb9c09936145aef886b7697d6b995/options.go#L58\" rel=\"nofollow noreferrer\">IdleTimeout</a> &amp; <a href=\"https://github.com/go-redis/redis/blob/854c88a72c8bb9c09936145aef886b7697d6b995/options.go#L62\" rel=\"nofollow noreferrer\">IdleCheckFrequency</a> in <a href=\"https://github.com/go-redis/redis\" rel=\"nofollow noreferrer\">go-redis</a>?</p>\n\n<p>Doubts:-</p>\n\n<ol>\n<li>If I specify <code>PoolTimeout</code> 20ms, <code>IdleTimeout</code> 20ms, <code>PoolSize</code> 100 &amp; <code>IdleCheckFrequency</code> 1 min. Let's say all the connection in the pool are used and a connection finishes its operation. Then will the request for a new connection wait till the IdleCheck is run in 1 min interval?</li>\n<li>If I specify <code>PoolSize</code> 100 will the client keep open 100 connections to redis even if there is no active client operation being performed to Redis?</li>\n</ol>\n\n<p>Environment:-</p>\n\n<ol>\n<li>Go - 1.7.4</li>\n<li>Redis - 3.2.6</li>\n<li>Go-Redis - v5.2</li>\n</ol>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 1, "creation_date": 1481378461, "post_id": 41076250, "comment_id": 69359018, "body": "See also: <a href=\"http://stackoverflow.com/questions/35274528/golang-return-values-of-function-as-input-arguments-to-another\">Golang return values of function as input arguments to another</a> and <a href=\"https://github.com/golang/go/issues/973\" rel=\"nofollow noreferrer\">issue 973</a>."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1481378124, "last_edit_date": 1481378124, "creation_date": 1481377812, "answer_id": 41076292, "question_id": 41076250, "link": "https://stackoverflow.com/questions/41076250/how-in-go-lang-function-returning-multiple-value-can-be-passed-to-other-function/41076292#41076292", "title": "How in Go lang function returning multiple value can be passed to other function with a variadic parameter", "body": "<p>From the <a href=\"https://golang.org/ref/spec#Calls\" rel=\"nofollow noreferrer\">specification</a>:</p>\n\n<blockquote>\n  <p>As a special case, if the return values of a function or method g are equal in number and individually assignable to the parameters of another function or method f, then the call f(g(parameters_of_g)) will invoke f after binding the return values of g to the parameters of f in order. The call of f must contain no parameters other than the call of g, and g must have at least one return value. If f has a final ... parameter, it is assigned the return values of g that remain after assignment of regular parameters.</p>\n</blockquote>\n\n<p>The problem with the call that you want to make is that one of the arguments to <code>Printf</code> is not a return value of <code>max</code>.  This call does work work:</p>\n\n<pre><code>fmt.Println(max(a, b))\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/ZZayVkwZJi\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ZZayVkwZJi</a></p>\n"}, {"tags": [], "owner": {"reputation": 804, "user_id": 7171834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9r1VB.png?s=128&g=1", "display_name": "Peter Gloor", "link": "https://stackoverflow.com/users/7171834/peter-gloor"}, "is_accepted": false, "score": 1, "last_activity_date": 1481382612, "creation_date": 1481382612, "answer_id": 41076965, "question_id": 41076250, "link": "https://stackoverflow.com/questions/41076250/how-in-go-lang-function-returning-multiple-value-can-be-passed-to-other-function/41076965#41076965", "title": "How in Go lang function returning multiple value can be passed to other function with a variadic parameter", "body": "<p>You can do something similar with an inline helper function with a variadic parameter.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n   var a int = 150\n   var b int = 130\n   func(i ...int){fmt.Printf( \"Max val: %d Min val: %d\\n\", i[0], i[1] )}(max(a,b))\n}\n\nfunc max(num1, num2 int) (int,int) {\n   if (num1 &gt; num2) {\n      return num1, num2\n   } else {\n      return num2, num1\n   }\n}\n</code></pre>\n\n<p>I hope it helps.</p>\n\n<p>Look at <a href=\"https://play.golang.org/p/tB-q8hjNdu\" rel=\"nofollow noreferrer\">https://play.golang.org/p/tB-q8hjNdu</a> to see it in action.</p>\n"}], "owner": {"reputation": 1562, "user_id": 3182574, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/100000511275756/picture?type=large", "display_name": "Samrat Das", "link": "https://stackoverflow.com/users/3182574/samrat-das"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3600, "favorite_count": 0, "closed_date": 1481383021, "accepted_answer_id": 41076292, "answer_count": 2, "score": 2, "last_activity_date": 1481384572, "creation_date": 1481377543, "last_edit_date": 1481384572, "question_id": 41076250, "link": "https://stackoverflow.com/questions/41076250/how-in-go-lang-function-returning-multiple-value-can-be-passed-to-other-function", "closed_reason": "Duplicate", "title": "How in Go lang function returning multiple value can be passed to other function with a variadic parameter", "body": "<p>I am new to go programming,</p>\n\n<p>Assume this code, where in function <code>fmt.Printf()</code> passing two different values</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n   var a int = 150\n   var b int = 130\n   var ret1, ret2 int\n   ret1, ret2 = max(a, b)\n   fmt.Printf( \"Max val: %d Min val: %d\\n\", ret1, ret2 )\n}\n\nfunc max(num1, num2 int) (int,int) {\n   if (num1 &gt; num2) {\n      return num1, num2\n   } else {\n      return num2, num1\n   }\n}\n</code></pre>\n\n<p>Instead of passing ret1, ret2 in <code>fmt.Printf( \"Max val: %d Min val: %d\\n\", ret1, ret2 )</code> is there any way, I can directly pass <code>max(a, b)</code> in <code>fmt.Printf()</code> like</p>\n\n<pre><code>fmt.Printf( \"Max val: %d Min val: %d\\n\", max(a, b))\n</code></pre>\n\n<p>I had tried it, it is giving error </p>\n\n<blockquote>\n  <p>multiple-value max() in single-value context</p>\n</blockquote>\n\n<p>As it seems, returning two different values not a tuple, is my concept for this returning is wrong or I am doing it wrong.</p>\n\n<p><strong>Is there any method to pass function with multiple return directly to function require variable number of values</strong></p>\n\n<p>TIA</p>\n"}, {"tags": ["go", "docker", "kubernetes"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481333763, "post_id": 41071276, "comment_id": 69349484, "body": "Is &quot;Gocode&quot; and app or a package? What is you&#39;re program doing?"}, {"owner": {"reputation": 63, "user_id": 6803472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b48c44e9a3f10a3c3944eac30fd8d7c3?s=128&d=identicon&r=PG&f=1", "display_name": "lufeng", "link": "https://stackoverflow.com/users/6803472/lufeng"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481334892, "post_id": 41071276, "comment_id": 69349698, "body": "sorry, it is a app write by go, and the program use a go routine  interval to obtain IP info from elasticsearch ,then put in redis, the other routine get ip from redis and do ping &lt;ip&gt; for it continuously"}, {"owner": {"reputation": 23608, "user_id": 2915097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91318014af3b3d389901d50d5f9276d5?s=128&d=identicon&r=PG&f=1", "display_name": "user2915097", "link": "https://stackoverflow.com/users/2915097/user2915097"}, "edited": false, "score": 0, "creation_date": 1481353506, "post_id": 41071276, "comment_id": 69352722, "body": "Show the Dockerfile and the <code>docker run</code> command"}, {"owner": {"reputation": 63, "user_id": 6803472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b48c44e9a3f10a3c3944eac30fd8d7c3?s=128&d=identicon&r=PG&f=1", "display_name": "lufeng", "link": "https://stackoverflow.com/users/6803472/lufeng"}, "edited": false, "score": 0, "creation_date": 1481383107, "post_id": 41071276, "comment_id": 69360390, "body": "<code>FROM index.tenxcloud.com&#47;tenxcloud&#47;centos:centos7 ADD .&#47;ping-app &#47;wls&#47;applications&#47;ping-app  RUN yum install -y gcc libxml2-devel libxslt-devel &amp;&amp; ldconfig RUN yum install -y openssh-server net-tools telnet RUN &#47;bin&#47;cp &#47;usr&#47;share&#47;zoneinfo&#47;Asia&#47;Shanghai &#47;etc&#47;localtime RUN mkdir -p &#47;wls&#47;logs&#47; &amp;&amp; touch &#47;wls&#47;logs&#47;ping-app.log ADD run.sh &#47;run.sh CMD [&quot;&#47;run.sh&quot;]</code>"}, {"owner": {"reputation": 63, "user_id": 6803472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b48c44e9a3f10a3c3944eac30fd8d7c3?s=128&d=identicon&r=PG&f=1", "display_name": "lufeng", "link": "https://stackoverflow.com/users/6803472/lufeng"}, "edited": false, "score": 0, "creation_date": 1481384015, "post_id": 41071276, "comment_id": 69360627, "body": "Thanks for any help. I use kubernetes to manage my container  and the <code>docker run</code> command is <code>&#47;run.sh</code>"}, {"owner": {"reputation": 63, "user_id": 6803472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b48c44e9a3f10a3c3944eac30fd8d7c3?s=128&d=identicon&r=PG&f=1", "display_name": "lufeng", "link": "https://stackoverflow.com/users/6803472/lufeng"}, "edited": false, "score": 0, "creation_date": 1481385155, "post_id": 41071276, "comment_id": 69360950, "body": "The content of run.sh is <code>#!&#47;bin&#47;bash mkdir -p &#47;wls&#47;logs&#47; cd &#47;wls&#47;applications&#47;ping-app &amp;&amp; .&#47;ping-app &gt;&gt; &#47;wls&#47;logs&#47;ping-app.log 2&gt;&amp;1 &#47;usr&#47;sbin&#47;sshd -D</code>"}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 6803472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b48c44e9a3f10a3c3944eac30fd8d7c3?s=128&d=identicon&r=PG&f=1", "display_name": "lufeng", "link": "https://stackoverflow.com/users/6803472/lufeng"}, "is_accepted": false, "score": 1, "last_activity_date": 1481508365, "creation_date": 1481508365, "answer_id": 41093271, "question_id": 41071276, "link": "https://stackoverflow.com/questions/41071276/errorfork-exec-no-such-file-or-directory-when-run-golang-code-in-docker/41093271#41093271", "title": "Error:fork/exec : no such file or directory -- when run Golang code in docker", "body": "<p>sorry I have found that I missed to copy a command to container which exec.Command need to run. Anyway,thanks for help </p>\n"}], "owner": {"reputation": 63, "user_id": 6803472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b48c44e9a3f10a3c3944eac30fd8d7c3?s=128&d=identicon&r=PG&f=1", "display_name": "lufeng", "link": "https://stackoverflow.com/users/6803472/lufeng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5137, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1481508365, "creation_date": 1481333622, "question_id": 41071276, "link": "https://stackoverflow.com/questions/41071276/errorfork-exec-no-such-file-or-directory-when-run-golang-code-in-docker", "title": "Error:fork/exec : no such file or directory -- when run Golang code in docker", "body": "<p>first of all any help is appreciated</p>\n\n<p>I want execute Gocode  in a container, but when I try and execute in a container I get the following error:</p>\n\n<pre><code>[root@ping-app-3618687774-abqmo ping-app]# go run main.go \nstart check_server\nINFO[0000] http.startHttpServer ok, listening 0.0.0.0:8080  source=\"api.go:106\"\nINFO[0000] Index=ipdata exists=true                      source=\"elastic.go:164\"\nINFO[0000] Index=ipdata Type=entity exists=true          source=\"elastic.go:184\"\nfork/exec : no such file or directory\nfork/exec : no such file or directory\nfork/exec : no such file or directory\nfork/exec : no such file or directory\nfork/exec : no such file or directory\nfork/exec : no such file or directory\nfork/exec : no such file or directory\nfork/exec : no such file or directory\n</code></pre>\n\n<p>I can't understand why this is happening and it only happened in docker, but when I run that Gocode on the host and it is ok.</p>\n\n<pre><code>Environment :\n\nCentos: 7.0.1406\n\nKubernetes: 1.2.0\n\ndocker: 1.10.3\n</code></pre>\n\n<p>Thanks a lot for any suggestions.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1481332506, "post_id": 41071033, "comment_id": 69349266, "body": "You should only have one top level vendor directory in your project for this reason"}, {"owner": {"reputation": 1791, "user_id": 363243, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/5527ddcd6dfc9e1df739c2aa0c8daa20?s=128&d=identicon&r=PG", "display_name": "dingalingchickenwiing", "link": "https://stackoverflow.com/users/363243/dingalingchickenwiing"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481333262, "post_id": 41071033, "comment_id": 69349391, "body": "These are two separate groups of code - the main site is a project, the subdomain site is a package."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481333557, "post_id": 41071033, "comment_id": 69349440, "body": "If they are both being imported into the same program, they are not separate as far as the build tools are concerned."}, {"owner": {"reputation": 1791, "user_id": 363243, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/5527ddcd6dfc9e1df739c2aa0c8daa20?s=128&d=identicon&r=PG", "display_name": "dingalingchickenwiing", "link": "https://stackoverflow.com/users/363243/dingalingchickenwiing"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481333682, "post_id": 41071033, "comment_id": 69349469, "body": "Only the subdomain project is being imported into the primary website project.  both main folders are located under src/ of my gopath, at the same level."}], "answers": [{"comments": [{"owner": {"reputation": 1791, "user_id": 363243, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/5527ddcd6dfc9e1df739c2aa0c8daa20?s=128&d=identicon&r=PG", "display_name": "dingalingchickenwiing", "link": "https://stackoverflow.com/users/363243/dingalingchickenwiing"}, "edited": false, "score": 0, "creation_date": 1481339594, "post_id": 41071312, "comment_id": 69350452, "body": "These are two separate projects. Src/proj1 and src/proj2. They are NOT the same project."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1791, "user_id": 363243, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/5527ddcd6dfc9e1df739c2aa0c8daa20?s=128&d=identicon&r=PG", "display_name": "dingalingchickenwiing", "link": "https://stackoverflow.com/users/363243/dingalingchickenwiing"}, "edited": false, "score": 0, "creation_date": 1481340222, "post_id": 41071312, "comment_id": 69350545, "body": "@dingalingchickenwiing You said you import the subdomain site into the primary site, that makes them part of the same program. Call it what you like, but multiple vendor directories in the same project will cause type mismatch errors like this."}, {"owner": {"reputation": 1791, "user_id": 363243, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/5527ddcd6dfc9e1df739c2aa0c8daa20?s=128&d=identicon&r=PG", "display_name": "dingalingchickenwiing", "link": "https://stackoverflow.com/users/363243/dingalingchickenwiing"}, "edited": false, "score": 0, "creation_date": 1481340688, "post_id": 41071312, "comment_id": 69350615, "body": "I may have used the wrong terminology as I am new, but I tried to explain that both projects were the same folder level under $GOPATH/src. for example, $GOPATH/src/proj1 and $GOPATH/src/proj2. If what you said is true, then every project I ever build will actually be part of the same project and there will never be a distinction between any projects."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1791, "user_id": 363243, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/5527ddcd6dfc9e1df739c2aa0c8daa20?s=128&d=identicon&r=PG", "display_name": "dingalingchickenwiing", "link": "https://stackoverflow.com/users/363243/dingalingchickenwiing"}, "edited": false, "score": 0, "creation_date": 1481373324, "post_id": 41071312, "comment_id": 69357469, "body": "@dingalingchickenwiing, so you&#39;re saying that all code you ever intend to write will be imported into the same main program? If that&#39;s the case, then yes you will only have one project. Maybe think of it this way, don&#39;t put a vendor directory in &quot;libraries&quot; -- only put one in the package creating your final binary."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 2, "last_activity_date": 1481334030, "creation_date": 1481334030, "answer_id": 41071312, "question_id": 41071033, "link": "https://stackoverflow.com/questions/41071033/type-conflicts-between-projects/41071312#41071312", "title": "Type conflicts between projects", "body": "<p>You have 2 vendor directories in your project. You need to flatten them into a single vendor directory at the top level in order to share vendored types between packages. Remove the <code>subdomain_site/vendor</code> and only use the vendor directory in your main pacakage. </p>\n"}], "owner": {"reputation": 1791, "user_id": 363243, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/5527ddcd6dfc9e1df739c2aa0c8daa20?s=128&d=identicon&r=PG", "display_name": "dingalingchickenwiing", "link": "https://stackoverflow.com/users/363243/dingalingchickenwiing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 685, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481334030, "creation_date": 1481331137, "question_id": 41071033, "link": "https://stackoverflow.com/questions/41071033/type-conflicts-between-projects", "title": "Type conflicts between projects", "body": "<p>I want to move code used by a specific subdomain its own project, which will be imported by the main code base which is currently resides in.  I am able to import code from the subdomain into the main project successfully, until I add the Gorilla Mux code.  For example, this works:</p>\n\n<pre><code>// imports and non-relevant routes removed for simplicity\nr := mux.NewRouter()\n// Primary site routes here...\ns := r.Host(\"subdomain-regex-here\").Subrouter()\ns.HandleFunc(\"/\", people.Index)\nhttp.ListenAndServe(\"localhost:8080\", r)\n</code></pre>\n\n<p>But when I move the subdomain to its own project and import it, then call the LoadRoutes() function which passes in the mux.Router object from the primary site, I receive an error.  Here's the code:</p>\n\n<pre><code>// Primary Project\nr := mux.NewRouter()\n// Primary site routes here...\n\n// function located in the subdomain go project, which is imported\nfunc LoadRoutes(host string, r *m.Router) {\n\n    s := r.Host(host).Subrouter()\n    s.HandleFunc(\"/\", people.Index)\n    s.HandleFunc(\"/people\", people.Index)\n    s.HandleFunc(\"/person/new\", people.New)\n}\n</code></pre>\n\n<p><strong># command-line-arguments\n./main.go:25: cannot use r (type *\"primary_site/vendor/github.com/gorilla/mux\".Router) as type *\"subdomain_site/vendor/github.com/gorilla/mux\".Router in argument to routers.LoadRoutes</strong></p>\n\n<p>It looks like I have two instances of the Gorilla Mux, from two separate projects, that are conflicting.  I only import packages from the subdomain site to the primary site, not the other way around.  This exact code works perfectly as long as I have it in a single project, but when I try to separate the projects, it breaks.</p>\n\n<p>Since I pass in the instance of mux.NewRouter(), why am I having a conflict?</p>\n"}, {"tags": ["go", "websocket", "slack", "gorilla"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1481324284, "post_id": 41069869, "comment_id": 69347425, "body": "There is no concurrent access to the connection in this example. Concurrency is not the issue.  Run with the <a href=\"https://golang.org/doc/articles/race_detector.html\" rel=\"nofollow noreferrer\">race detector</a> if you are unsure.  The error indicates that peer closed the connection without a closing handshake.  Is it possible that the peer didn&#39;t like the message sent? (I now knothing about slack)."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1481325012, "post_id": 41069869, "comment_id": 69347625, "body": "Being curious about Slack, I looked up the API and see that it uses JSON for messages.  Random guess is that Slack closed the connection because the application sent invalid JSON (the string <code>You talkin&#39; to me?</code>)."}, {"owner": {"reputation": 1384, "user_id": 1512572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/069ec845bb230e1f3da804446fd52806?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1512572/alex"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1481325064, "post_id": 41069869, "comment_id": 69347645, "body": "I did not know about the race detector - I&#39;ll check that out shortly and report back. Very possible that my response is malformed, I didn&#39;t consider that.Thank you!"}, {"owner": {"reputation": 1384, "user_id": 1512572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/069ec845bb230e1f3da804446fd52806?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1512572/alex"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1481328354, "post_id": 41069869, "comment_id": 69348483, "body": "@MellowMarmot This was just an issue of a malformed response! :facepalm: I love easy fixes but it&#39;s always embarrassing to catch them.   Would you drop an answer so I can accept and get you those sweet internet points you deserve? Thanks so much for your help!"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1481330563, "creation_date": 1481330563, "answer_id": 41070981, "question_id": 41069869, "link": "https://stackoverflow.com/questions/41069869/websocket-failure-on-writemessage/41070981#41070981", "title": "Websocket Failure on WriteMessage", "body": "<p>The message sent to the server is not JSON as expected by the server. The server closed the connection without a handshake.</p>\n"}], "owner": {"reputation": 1384, "user_id": 1512572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/069ec845bb230e1f3da804446fd52806?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1512572/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 399, "favorite_count": 0, "accepted_answer_id": 41070981, "answer_count": 1, "score": 0, "last_activity_date": 1481330563, "creation_date": 1481322476, "question_id": 41069869, "link": "https://stackoverflow.com/questions/41069869/websocket-failure-on-writemessage", "title": "Websocket Failure on WriteMessage", "body": "<p>I'm building out a simple Slackbot as a learning experience with Go, and I've hit my first snag: I'm unable to write a message back to the connection!</p>\n\n<p>Here's my main func:</p>\n\n<pre><code>func main() {\n  conn, botId, err := slackInit(os.Getenv(\"SLACKBOT_TOKEN\"))\n  if err != nil { return }\n\n  defer conn.Close()\n  for {\n    _, event, err := conn.ReadMessage()\n    if err != nil {\n      fmt.Println(\"Error processing message:\", err)\n      return\n    }\n\n    fmt.Println(string(event))\n\n    message, err := slackGetMessage(event)\n    if strings.Contains(message, botId) {\n      fmt.Println(\"Bot was mentioned!\")\n      resp := []byte(\"You talkin' to me?\")\n      err = conn.WriteMessage(1, resp)\n      if err != nil {\n        fmt.Println(\"Error writing message:\", string(resp))\n        return\n      }\n    }\n  }\n}\n</code></pre>\n\n<p>This listens and reports events with no issue, but fails as soon as the <code>conn.WriteMessage</code> method is called. I get a fatal error from <code>websocket</code> with code 1006 &amp; the message \"unexpected closure\". </p>\n\n<p>I'm using Gorilla for my websocket library, and I suspect maybe this is a concurrency issue related to their \"one reader, one writer\" limit. I've tried a few tweaks, but honestly just don't know enough about the languge/library yet to really dive deep on debugging this. :-/</p>\n\n<p>I'm sure I'm missing something obvious here! Any tips for managing my Writer to get my bot talking back? Thanks!</p>\n"}, {"tags": ["postgresql", "go", "go-gorm"], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1481320723, "post_id": 41069521, "comment_id": 69346264, "body": "There is no inheritance in Go. You will want to look at <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow noreferrer\">Struct Embedding</a>"}, {"owner": {"reputation": 431, "user_id": 3579289, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/983dc0388721513b4c7ec63e280cb7e1?s=128&d=identicon&r=PG", "display_name": "Adrien", "link": "https://stackoverflow.com/users/3579289/adrien"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481357225, "post_id": 41069521, "comment_id": 69353555, "body": "Thank you for this important precision !"}], "tags": [], "owner": {"reputation": 431, "user_id": 3579289, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/983dc0388721513b4c7ec63e280cb7e1?s=128&d=identicon&r=PG", "display_name": "Adrien", "link": "https://stackoverflow.com/users/3579289/adrien"}, "is_accepted": true, "score": 3, "last_activity_date": 1481320606, "creation_date": 1481320606, "answer_id": 41069521, "question_id": 41069390, "link": "https://stackoverflow.com/questions/41069390/do-i-need-to-have-two-different-objects-to-read-and-to-write-in-my-database-usin/41069521#41069521", "title": "Do I need to have two different objects to read and to write in my database using gorm (golang)?", "body": "<p>Ok, just read the code behind <code>gorm.Model</code> and I got my answer.</p>\n\n<pre><code>type Model struct {\n    ID        uint `gorm:\"primary_key\"`\n    CreatedAt time.Time\n    UpdatedAt time.Time\n    DeletedAt *time.Time `sql:\"index\"`\n}\n</code></pre>\n\n<p>It means I just leaned how inheritance works in go ! </p>\n"}], "owner": {"reputation": 431, "user_id": 3579289, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/983dc0388721513b4c7ec63e280cb7e1?s=128&d=identicon&r=PG", "display_name": "Adrien", "link": "https://stackoverflow.com/users/3579289/adrien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 803, "favorite_count": 1, "accepted_answer_id": 41069521, "answer_count": 1, "score": 2, "last_activity_date": 1481320658, "creation_date": 1481319922, "last_edit_date": 1481320658, "question_id": 41069390, "link": "https://stackoverflow.com/questions/41069390/do-i-need-to-have-two-different-objects-to-read-and-to-write-in-my-database-usin", "title": "Do I need to have two different objects to read and to write in my database using gorm (golang)?", "body": "<p>gorm tell in the documentation that \"Base model definition gorm.Model, including fields ID, CreatedAt, UpdatedAt, DeletedAt, you could embed it in your model, or only write those fields you want\":</p>\n\n<pre><code>// Base Model's definition\ntype Model struct {\n  ID        uint `gorm:\"primary_key\"`\n  CreatedAt time.Time\n  UpdatedAt time.Time\n  DeletedAt *time.Time\n}\n\n// Add fields `ID`, `CreatedAt`, `UpdatedAt`, `DeletedAt`\ntype User struct {\n  gorm.Model\n  Name string\n}\n\n// Only need field `ID`, `CreatedAt`\ntype User struct {\n  ID        uint\n  CreatedAt time.Time\n  Name      string\n}\n</code></pre>\n\n<p>Following the documentation, I expect to have only one definition of User, so I create an object like that:</p>\n\n<pre><code>type User struct {\n  gorm.Model\n  ID        uint\n  CreatedAt time.Time\n  Name      string\n}\n</code></pre>\n\n<p>But if I do a <code>DB.CreateTable(&amp;User{})</code>, I get the following errors from postgres:</p>\n\n<pre><code>(pq: column \"id\" specified more than once)\n(pq: column \"created_at\" specified more than once)\n</code></pre>\n\n<p>So I have to have two different objects : </p>\n\n<pre><code>type CreateUser struct {\n  gorm.Model\n  Name string\n}\n\ntype RetrieveUser struct {\n  gorm.Model\n  ID        uint\n  CreatedAt time.Time\n  Name      string\n}\n</code></pre>\n\n<p>So I can do a <code>DB.CreateTable(&amp;CreateUser{})</code></p>\n\n<p>It is very ugly and I must be missing something, any idea?</p>\n"}, {"tags": ["go", "sftp"], "comments": [{"owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 1, "creation_date": 1481323877, "post_id": 41069325, "comment_id": 69347304, "body": "You didn&#39;t set the current working directory when you create the file. <code>sftp.Create(&quot;&#47;your&#47;working&#47;path&#47;products.xml&quot;)</code>. Maybe at the moment of connect, your user doesn&#39;t have some privileges with the default directory path."}, {"owner": {"reputation": 3446, "user_id": 540981, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LTwr5.jpg?s=128&g=1", "display_name": "Danish", "link": "https://stackoverflow.com/users/540981/danish"}, "reply_to_user": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 0, "creation_date": 1481558405, "post_id": 41069325, "comment_id": 69413558, "body": "I tried doing a simple put from the command line and it uploaded the file with flags as <code>--w--w--w-</code>. When I look at the docs for <code>sftp.Create</code> creates a file with <code>0666</code>, which is what is causing it. I need to be able to create a file with write only permissions."}], "answers": [{"tags": [], "owner": {"reputation": 3446, "user_id": 540981, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LTwr5.jpg?s=128&g=1", "display_name": "Danish", "link": "https://stackoverflow.com/users/540981/danish"}, "is_accepted": true, "score": 4, "last_activity_date": 1481579344, "creation_date": 1481579344, "answer_id": 41110208, "question_id": 41069325, "link": "https://stackoverflow.com/questions/41069325/sftp-in-go-error-user-does-not-have-appropriate-read-permission/41110208#41110208", "title": "SFTP In Go Error: User does not have appropriate read permission", "body": "<p>I am answering my own question to help anyone else that is having this problem. I was able to find a solution.</p>\n\n<p>The <strong>Google Merchant SFTP</strong> account only gives you write only access. However, according to the docs, when using the <code>sftp.Create(..)</code> function, it creates a file with the flags as <code>0666</code>, which does not agree with the permissions set on your user.</p>\n\n<p>To mimic the behavior of <code>sftp.Create(..)</code> with write only permissions, you can use the more general <code>sftp.OpenFile(..)</code> function.</p>\n\n<pre><code>remoteFile, err := sftp.OpenFile(fileName, os.O_WRONLY|os.O_CREATE|os.O_TRUNC)\n</code></pre>\n\n<p>The flags <code>os.O_WRONLY|os.O_CREATE|os.O_TRUNC</code> will mimic the behavior of <code>Create()</code> i.e. create a file it doesn't exist and truncate the file if it does.</p>\n"}], "owner": {"reputation": 3446, "user_id": 540981, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LTwr5.jpg?s=128&g=1", "display_name": "Danish", "link": "https://stackoverflow.com/users/540981/danish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1007, "favorite_count": 0, "accepted_answer_id": 41110208, "answer_count": 1, "score": 2, "last_activity_date": 1481579344, "creation_date": 1481319615, "question_id": 41069325, "link": "https://stackoverflow.com/questions/41069325/sftp-in-go-error-user-does-not-have-appropriate-read-permission", "title": "SFTP In Go Error: User does not have appropriate read permission", "body": "<p>I am trying to upload a product feed to a Google Merchant SFTP account. I am able to upload a file manually through the command prompt but encounter the following error when trying to do it through Go.</p>\n\n<p><strong>Error</strong>: <code>sftp: \"User does not have appropriate read permission.\" (SSH_FX_PERMISSION_DENIED)</code></p>\n\n<p>I am using the <code>github.com/pkg/sftp</code> package, following the example in <a href=\"https://godoc.org/github.com/pkg/sftp#Client.Open\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/pkg/sftp#Client.Open</a>. I suspect that the <code>Create</code>/<code>Write</code> pattern here ends up being different from a simple <code>put</code> from command line.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>func (g *GoogleExporter) ExportToSFTP(file []byte) error {\n\n// Creating an SSH connection\nsshConfig := &amp;ssh.ClientConfig{\n    User: g.Creds.AccessData.SFTPUser,\n    Auth: []ssh.AuthMethod{\n        ssh.Password(g.Creds.AccessData.SFTPPassword),\n    },\n}\n\nhostPort := fmt.Sprintf(\"%s:%d\", SFTPHostName, SFTPHostPort)\nconnection, err := ssh.Dial(\"tcp\", hostPort, sshConfig)\nif err != nil {\n    return err\n}\n\nfmt.Println(\"&gt;&gt; SSH Connection Created!\")\n\n// Creating an SFPT connection over SSH\nsftp, err := sftp.NewClient(connection)\nif err != nil {\n    return err\n}\ndefer sftp.Close()\n\nfmt.Println(\"&gt;&gt; SFTP Client Created!\")\n\n// Uploading the file\nremoteFileName := \"products.xml\" // TODO: Make this name configurable\nremoteFile, err := sftp.Create(remoteFileName)\nif err != nil {\n    return err\n}\nfmt.Println(\"&gt;&gt; SFTP File Created!\")\nif _, err := remoteFile.Write(file); err != nil {\n    return err\n}\n\nfmt.Println(\"Successfully uploaded product feed to SFTP, file:%s user:%s\", remoteFileName, g.Creds.AccessData.SFTPUser)\nutil.Log(\"Successfully uploaded product feed to SFTP, file:%s user:%s\", remoteFileName, g.Creds.AccessData.SFTPUser)\n\n// Confirming if the file is there\nif _, err := sftp.Lstat(remoteFileName); err != nil {\n    return err\n}\n\nreturn nil\n}\n</code></pre>\n\n<p>The error is cause by this line:</p>\n\n<pre><code>remoteFile, err := sftp.Create(remoteFileName)\n</code></pre>\n"}, {"tags": ["http", "go"], "answers": [{"comments": [{"owner": {"reputation": 390, "user_id": 2637167, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/298d6f4aa1c8775a09bb6c1c9fb5f2a2?s=128&d=identicon&r=PG", "display_name": "Eaton Emmerich", "link": "https://stackoverflow.com/users/2637167/eaton-emmerich"}, "edited": false, "score": 1, "creation_date": 1550148873, "post_id": 41069037, "comment_id": 96169256, "body": "Note: &quot;Should not&quot; does not mean it can&#39;t. And thats because it actually can."}, {"owner": {"reputation": 4165, "user_id": 3299397, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/HvJkt.jpg?s=128&g=1", "display_name": "Kyle Bridenstine", "link": "https://stackoverflow.com/users/3299397/kyle-bridenstine"}, "edited": false, "score": 0, "creation_date": 1603307575, "post_id": 41069037, "comment_id": 113999026, "body": "@Riking you are a life saver!"}], "tags": [], "owner": {"reputation": 2129, "user_id": 1210278, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5120fc4e345db0d1a964888272073819?s=128&d=identicon&r=PG", "display_name": "Riking", "link": "https://stackoverflow.com/users/1210278/riking"}, "is_accepted": true, "score": 4, "last_activity_date": 1481318205, "creation_date": 1481318205, "answer_id": 41069037, "question_id": 41068906, "link": "https://stackoverflow.com/questions/41068906/golang-http-newrequestmethod-url-body-fails-to-create-correctly-formatted/41069037#41069037", "title": "Golang &#39;http.NewRequest(method, url, body)&#39; fails to create correctly formatted request", "body": "<p>GET requests should not contain a body. Instead, you need to put the form into the query string.</p>\n\n<p>Here's the proper way to do that, without hacky string concatenation:</p>\n\n<pre><code>reqURL := \"https://poloniex.com/public\"\nvalues := url.Values { \"currencyPair\": []string{pair}, \"depth\": []string{depth}}\nvalues.Set(\"command\", \"returnOrderBook\")\nuri, _ := url.Parse(reqURL)\nuri.Query = values.Encode()\nreqURL = uri.String()\nfmt.Println(reqURL)\n\nreq, err := http.NewRequest(\"GET\", reqURL, nil)\nif err != nil {\n    panic(err) // NewRequest only errors on bad methods or un-parsable urls\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/ZCLUu7UgZL\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ZCLUu7UgZL</a></p>\n"}], "owner": {"reputation": 165, "user_id": 4150729, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/1492722699/picture?type=large", "display_name": "Nik Kunkel", "link": "https://stackoverflow.com/users/4150729/nik-kunkel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2503, "favorite_count": 0, "accepted_answer_id": 41069037, "answer_count": 1, "score": 0, "last_activity_date": 1481318205, "creation_date": 1481317664, "question_id": 41068906, "link": "https://stackoverflow.com/questions/41068906/golang-http-newrequestmethod-url-body-fails-to-create-correctly-formatted", "title": "Golang &#39;http.NewRequest(method, url, body)&#39; fails to create correctly formatted request", "body": "<p>I'm trying to send a GET request to the following api:      </p>\n\n<blockquote>\n  <p><a href=\"https://poloniex.com/public?command=returnOrderBook\" rel=\"nofollow noreferrer\">https://poloniex.com/public?command=returnOrderBook</a></p>\n</blockquote>\n\n<p>w/ URL parameters: </p>\n\n<blockquote>\n  <p>currencyPair=BTC_ETH<br>\n  depth=20<br>\n  --> &amp;currencyPair=BTC_ETH&amp;depth=20</p>\n</blockquote>\n\n<p>I try to setup and execute my request as so: (note I've removed error checking for brevity)</p>\n\n<pre><code>pair := \"BTC_ETH\"\ndepth := 20\nreqURL := \"https://poloniex.com/public?command=returnOrderBook\"\nvalues := url.Values { \"currencyPair\": []string{pair}, \"depth\": []string{depth}}\nfmt.Printf(\"\\n Values = %s\\n\", values.Encode())        //DEBUG\nreq, err := http.NewRequest(\"GET\", reqURL, strings.NewReader(values.Encode()))\nfmt.Printf(\"\\nREQUEST = %+v\\n\", req)                   //DEBUG\nresp, err := api.client.Do(req)\ndefer resp.Body.Close()\nbody, err := ioutil.ReadAll(resp.Body)\nfmt.Printf(\"\\nREST CALL RETURNED: %X\\n\",body)          //DEBUG\n</code></pre>\n\n<p>My DEBUG print statements print out the following:   </p>\n\n<pre><code>Values = currencyPair=BTC_ETH&amp;depth=20\n\nREQUEST = &amp;{Method:GET URL:https://poloniex.com/public?command=returnOrderBook Proto:HTTP/1.1 ProtoMajor:1 ProtoMinor:1 Header:map[User-Agent:[Poloniex GO API Agent]] Body:{Reader:0xc82028e840} ContentLength:29 TransferEncoding:[] Close:false Host:poloniex.com Form:map[] PostForm:map[] MultipartForm:&lt;nil&gt; Trailer:map[] RemoteAddr: RequestURI: TLS:&lt;nil&gt; Cancel:&lt;nil&gt;}\n\nREST CALL RETURNED: {\"error\":\"Please specify a currency pair.\"}\n</code></pre>\n\n<p>Playing around with Postman I figured out the API only returns this error when the currencyPair parameter is not specified (including miscapitalized). I can't  figure out why the request doesn't include the URL parameters I specified as it's obvious from my debug print statements that the values.Encode() is correct. The content length in the request corresponds to the right amount of chars (bytes) needed for URL parameters. </p>\n\n<p>Now after playing around a bit I found a solution.\nIf I replace the http.NewRequest() line with the following it works:</p>\n\n<pre><code>req, err := http.NewRequest(HTTPType, reqURL + \"&amp;\" + values.Encode(), nil)\n</code></pre>\n\n<p>However, it's really bothering me why the original statement doesn't work. </p>\n\n<p>The new DEBUG output is:</p>\n\n<pre><code>Values = currencyPair=BTC_ETH&amp;depth=20\n\nREQUEST = &amp;{Method:GET URL:https://poloniex.com/public?command=returnOrderBook&amp;currencyPair=BTC_ETH&amp;depth=5 Proto:HTTP/1.1 ProtoMajor:1 ProtoMinor:1 Header:map[User-Agent:[Poloniex GO API Agent]] Body:&lt;nil&gt; ContentLength:0 TransferEncoding:[] Close:false Host:poloniex.com Form:map[] PostForm:map[] MultipartForm:&lt;nil&gt; Trailer:map[] RemoteAddr: RequestURI: TLS:&lt;nil&gt; Cancel:&lt;nil&gt;}\n\nREST CALL RETURNED: *way too long, just assume it's the correct financial data*\n</code></pre>\n\n<p>Would love some input on what I did wrong in the original statement. I used the same method (original) for a different api endpoint w/ URL parameters and it worked fine. Confused on why it didn't work in this case.  </p>\n"}, {"tags": ["go", "compilation"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1481324122, "post_id": 41067095, "comment_id": 69347374, "body": "A &quot;context register&quot; is just what the Go authors called the register holding the context for a closure. Stub functions (which are implemented non-locally, like in assembly files, the runtime, etc) aren&#39;t really related. And yes, if you have questions on this the mailing list is a much more appropriate forum."}, {"owner": {"reputation": 885, "user_id": 3669757, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5556acc8458f9ed1ca2f743e3165d172?s=128&d=identicon&r=PG", "display_name": "eje", "link": "https://stackoverflow.com/users/3669757/eje"}, "edited": false, "score": 3, "creation_date": 1481324492, "post_id": 41067095, "comment_id": 69347477, "body": "Hopefully this isn&#39;t too meta, but why is stackoverflow -- a site whose entire purpose is literally asking and answering questions about programming -- somehow &quot;much less appropriate&quot; for a go-lang question than an email list?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 885, "user_id": 3669757, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5556acc8458f9ed1ca2f743e3165d172?s=128&d=identicon&r=PG", "display_name": "eje", "link": "https://stackoverflow.com/users/3669757/eje"}, "edited": false, "score": 2, "creation_date": 1481381126, "post_id": 41067095, "comment_id": 69359803, "body": "@eje: The best reason is that if you want an answer about an implementation detail in the gc toolchain the mailing list is a better forum, simply because the developers are active there, and much less so here. This assumes the OP did due diligence and has already looked at the commit log (which VonC quoted for us below), and wants more context which the original developers could provide."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 6, "last_activity_date": 1481328983, "creation_date": 1481328983, "answer_id": 41070801, "question_id": 41067095, "link": "https://stackoverflow.com/questions/41067095/what-is-a-context-register-in-golang/41070801#41070801", "title": "What is a context register in golang?", "body": "<p>The expression \"context register\" first appeared in <a href=\"https://github.com/golang/go/commit/b1b67a36ace635744cd261ee6f3441d1044c66b3\" rel=\"noreferrer\">commit b1b67a3</a> (Feb. 2013, Go 1.1rc2) for implementing step 3 of the <a href=\"https://docs.google.com/document/d/1bMwCey-gmqZVTpRax-ESeVuZGmjwbocYs1iHplK-cjo/pub\" rel=\"noreferrer\">Go 1.1 Function Calls</a></p>\n\n<blockquote>\n  <p>Change the <code>reflect.MakeFunc</code> implementation to avoid run-time code generation as well</p>\n</blockquote>\n\n<p>It was picked up in <a href=\"https://github.com/golang/go/commit/4a000b9d51b88346e01464f2cf8b8ab7eaa66063\" rel=\"noreferrer\">commit 4a000b9</a> in Feb. 2014, Go 1.3beta1, for assembly and system calls for Native Client x86-64, where <a href=\"https://github.com/golang/go/blob/4a000b9d51b88346e01464f2cf8b8ab7eaa66063/src/pkg/runtime/sys_nacl_386.s#L189-L217\" rel=\"noreferrer\">sigreturn is managed as</a>:</p>\n\n<blockquote>\n  <p><code>NaCl</code> has abidcated its traditional operating system responsibility and declined to implement '<code>sigreturn</code>'.<br>\n  Instead the only way to return to the execution of our program is to restore the registers ourselves.</p>\n  \n  <p>Unfortunately, that is impossible to do with strict fidelity, because there is no way to do the final update of PC that ends the sequence without either </p>\n  \n  <ul>\n  <li>(1) jumping to a register, in which case the register ends holding the PC value instead of its intended value, or</li>\n  <li>(2) storing the <code>PC</code> on the stack and using <code>RET</code>, which imposes the requirement that <code>SP</code> is valid and that is okay to smash the word below it. </li>\n  </ul>\n  \n  <p>The second would normally be the lesser of the two evils, except that on NaCl, the linker must rewrite <code>RET</code> into \"<code>POP reg; AND $~31, reg; JMP reg</code>\", so either way we are going to lose a register as a result of the incoming signal.  </p>\n  \n  <p>Similarly, there is no way to restore <code>EFLAGS</code>; the usual way is to use <code>POPFL</code>, but <code>NaCl</code> rejects that instruction.<br>\n  We could inspect the bits and execute a sequence of instructions designed to recreate those flag settings, but that's a lot of work.</p>\n  \n  <p>Thankfully, Go's signal handlers never try to return directly to the executing code, so all the registers and <code>EFLAGS</code> are dead and can be smashed.<br>\n  The only registers that matter are the ones that are setting up for the simulated call that the signal handler has created.<br>\n  Today those registers are just <code>PC</code> and <code>SP</code>, but in case additional registers are relevant in the future (<strong>for example <code>DX</code> is the Go func <code>context register</code></strong>) we restore as many registers as possible.</p>\n</blockquote>\n\n<p>Much more recently (Q4 2016), for Go 1.8, we have <a href=\"https://github.com/golang/go/commit/d5bd797ee55d36b07b388d0b8ca2393dc186bea1\" rel=\"noreferrer\">commit d5bd797</a> and <a href=\"https://github.com/golang/go/commit/bf9c71cb434a730679f54a3a87c2e9e36ec400d0\" rel=\"noreferrer\">commit bf9c71c</a>, for <a href=\"https://github.com/golang/go/issues/17503\" rel=\"noreferrer\">eliminating stack rescanning</a>:</p>\n\n<blockquote>\n  <p><code>morestack</code> writes the context pointer to <code>gobuf.ctxt</code>, but since\n  <code>morestack</code> is written in assembly (and has to be very careful with\n  state), it does <em>not</em> invoke the requisite write barrier for this\n  write. Instead, we patch this up later, in <code>newstack</code>, where we invoke\n  an explicit write barrier for ctxt.</p>\n  \n  <p>This already requires some subtle reasoning, and it's going to get a\n  lot hairier with the hybrid barrier.</p>\n  \n  <p>Fix this by simplifying the whole mechanism.<br>\n  Instead of writing <code>gobuf.ctxt</code> in <code>morestack</code>, <strong>just pass the value of the context register to <code>newstack</code> and let it write it to <code>gobuf.ctxt</code></strong>. This is a normal Go pointer write, so it gets the normal Go write barrier. No subtle reasoning required.</p>\n</blockquote>\n"}], "owner": {"reputation": 16400, "user_id": 350542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/024d1da9fad214ca44af8fcc649ebb86?s=128&d=identicon&r=PG", "display_name": "jayunit100", "link": "https://stackoverflow.com/users/350542/jayunit100"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 486, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1542473501, "creation_date": 1481309733, "last_edit_date": 1542473501, "question_id": 41067095, "link": "https://stackoverflow.com/questions/41067095/what-is-a-context-register-in-golang", "title": "What is a context register in golang?", "body": "<p>What is a <strong><em>context register</em></strong> and how does it change the way Go code is compiled?</p>\n\n<p><em>Context:</em> I've seen uses of stub functions in some parts of GOROOT, i.e. <code>reflect</code>, but am not quite sure how these work.</p>\n"}, {"tags": ["go", "struct", "initialization", "runtime"], "comments": [{"owner": {"reputation": 709, "user_id": 3016478, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/hTZcs.jpg?s=128&g=1", "display_name": "rsudip90", "link": "https://stackoverflow.com/users/3016478/rsudip90"}, "edited": false, "score": 0, "creation_date": 1481308827, "post_id": 41066798, "comment_id": 69340716, "body": "I saw this: <a href=\"http://stackoverflow.com/questions/7850140/how-do-you-create-a-new-instance-of-a-struct-from-its-type-at-runtime-in-go\" title=\"how do you create a new instance of a struct from its type at runtime in go\">stackoverflow.com/questions/7850140/&hellip;</a>, but I don&#39;t understand it."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481308971, "post_id": 41066798, "comment_id": 69340791, "body": "Are you just looking for a for loop? <a href=\"https://play.golang.org/p/88GiQuQyBP\" rel=\"nofollow noreferrer\">play.golang.org/p/88GiQuQyBP</a> (also, these are slices not arrays, which are different in Go)"}, {"owner": {"reputation": 709, "user_id": 3016478, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/hTZcs.jpg?s=128&g=1", "display_name": "rsudip90", "link": "https://stackoverflow.com/users/3016478/rsudip90"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481309178, "post_id": 41066798, "comment_id": 69340890, "body": "Oh Sorry that was mistake, yup they are slices but let&#39;s say I have 50 fields in struct and 100 slices which contains my struct data, then how do I achieve this?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481309863, "post_id": 41066798, "comment_id": 69341222, "body": "You mean you want to set the fields via reflection? <a href=\"https://play.golang.org/p/QzHvhMnput\" rel=\"nofollow noreferrer\">play.golang.org/p/QzHvhMnput</a>"}, {"owner": {"reputation": 709, "user_id": 3016478, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/hTZcs.jpg?s=128&g=1", "display_name": "rsudip90", "link": "https://stackoverflow.com/users/3016478/rsudip90"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481310232, "post_id": 41066798, "comment_id": 69341438, "body": "@JimB exactly that is what I want!! thanks bro. But I have a question which one is a good way to do this? via reflection or via hard coded assignment? See reason behind asking this is I have struct with 40 fields and have 1000 slices of slices which contains data for struct and I need good solution."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481310552, "post_id": 41066798, "comment_id": 69341601, "body": "This seems like a very awkward data structure to deal with, does it have to be a struct? If the slices of ints are already ordered accordingly, why do they need to be converted to structs at all? If the int&#39;s just need names, why not a map?"}, {"owner": {"reputation": 709, "user_id": 3016478, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/hTZcs.jpg?s=128&g=1", "display_name": "rsudip90", "link": "https://stackoverflow.com/users/3016478/rsudip90"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481310621, "post_id": 41066798, "comment_id": 69341635, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/130248/discussion-between-rsudip90-and-jimb\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 709, "user_id": 3016478, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/hTZcs.jpg?s=128&g=1", "display_name": "rsudip90", "link": "https://stackoverflow.com/users/3016478/rsudip90"}, "edited": false, "score": 0, "creation_date": 1481309913, "post_id": 41067052, "comment_id": 69341254, "body": "Thanks for the answer. But is there any other way so that we can directly to do this with field index like for <code>0</code> indexed field assign value of <code>0</code> indexed data from slice?"}], "tags": [], "owner": {"reputation": 4197, "user_id": 1632346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c043a71ec4903a9a9e6a4de90c787fa1?s=128&d=identicon&r=PG", "display_name": "slomek", "link": "https://stackoverflow.com/users/1632346/slomek"}, "is_accepted": false, "score": 1, "last_activity_date": 1481309529, "creation_date": 1481309529, "answer_id": 41067052, "question_id": 41066798, "link": "https://stackoverflow.com/questions/41066798/create-struct-instance-with-initialization-from-slices-of-data-golang/41067052#41067052", "title": "Create Struct instance with initialization from slices of data golang", "body": "<p>I'm not sure if that is what you are looking for, but you can create those objects in a simple loop:</p>\n\n<pre><code>func main() {\n    data := [][]int{\n        {1, 2, 3},\n        {4, 3, 2},\n    }\n\n    for _, intArr := range data {\n        a := NewA(intArr)\n        // a:= A{I: ints[0], J: ints[1], K: ints[2]}\n\n        fmt.Println(a)\n    }\n}\n</code></pre>\n\n<p>Full solution available at <a href=\"https://play.golang.org/p/j7fxbmu3jp\" rel=\"nofollow noreferrer\">https://play.golang.org/p/j7fxbmu3jp</a></p>\n"}, {"comments": [{"owner": {"reputation": 709, "user_id": 3016478, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/hTZcs.jpg?s=128&g=1", "display_name": "rsudip90", "link": "https://stackoverflow.com/users/3016478/rsudip90"}, "edited": false, "score": 0, "creation_date": 1483423736, "post_id": 41407398, "comment_id": 70080791, "body": "Thanks for your help, but I achieved this via reflection."}], "tags": [], "owner": {"reputation": 527, "user_id": 335472, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3eec49d54e643c464a5d9e42c8dd5c59?s=128&d=identicon&r=PG", "display_name": "Joao Henrique", "link": "https://stackoverflow.com/users/335472/joao-henrique"}, "is_accepted": false, "score": 0, "last_activity_date": 1483179384, "creation_date": 1483179384, "answer_id": 41407398, "question_id": 41066798, "link": "https://stackoverflow.com/questions/41066798/create-struct-instance-with-initialization-from-slices-of-data-golang/41407398#41407398", "title": "Create Struct instance with initialization from slices of data golang", "body": "<p>Here it is, for a more compact version...</p>\n\n<p>Just range over your \"data\" array of arrays and create a new \"A\" from each index.</p>\n\n<p>No need to do that in a separate function.</p>\n\n<pre><code>for _, arr := range data {\n    a := A{I: arr[0], J: arr[1], K: arr[2]}\n\n    fmt.Println(a)\n}\n</code></pre>\n\n<p>Full solution here: <a href=\"https://play.golang.org/p/jyN7f9c-o-\" rel=\"nofollow noreferrer\">https://play.golang.org/p/jyN7f9c-o-</a></p>\n"}], "owner": {"reputation": 709, "user_id": 3016478, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/hTZcs.jpg?s=128&g=1", "display_name": "rsudip90", "link": "https://stackoverflow.com/users/3016478/rsudip90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1156, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1483179384, "creation_date": 1481308510, "last_edit_date": 1481309408, "question_id": 41066798, "link": "https://stackoverflow.com/questions/41066798/create-struct-instance-with-initialization-from-slices-of-data-golang", "title": "Create Struct instance with initialization from slices of data golang", "body": "<p>I have a data with array of array.</p>\n\n<blockquote>\n  <p><code>data := [][]int{{1,2,3}, {4,5,6}}</code></p>\n</blockquote>\n\n<p>and struct </p>\n\n<blockquote>\n  <p><code>type A struct {\n      I, J, K int\n  }</code></p>\n</blockquote>\n\n<p>Now I want to create instance run time for struct A with each array from data, How do I achieve that? If reflect is a way, then tell how?</p>\n\n<p>This is just an example that I want to show you. But let's say if struct A contains 26 fields from A to Z with type of int and I have 100 slices of data from which I can create/init my struct A, then how it could be possible without using dot notation on struct and just looping over field index and assign that field from slice data?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype A struct {\n    I, J, K int\n}\n\nfunc main() {\n    data := [][]int{\n        {1, 2, 3},\n        {4, 3, 2},\n    }\n\n    var a A\n    // create instance of type A with params\n    // initialization for each array in data\n    fmt.Println(a)\n}\n</code></pre>\n\n<p>Please help me at this link: <a href=\"https://play.golang.org/p/rYuoajn5Ln\" rel=\"nofollow noreferrer\">https://play.golang.org/p/rYuoajn5Ln</a></p>\n"}, {"tags": ["go", "assembly", "x86", "x86-64", "eflags"], "comments": [{"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1481306662, "post_id": 41066226, "comment_id": 69339683, "body": "It&#39;s probably CMOVS with 32-bit operands. That is <code>CMOVS EDX, EBX</code> in standard Intel assembly.  I don&#39;t know if Go bothers to document their bizarre assembly language anywhere."}, {"owner": {"reputation": 240649, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1481306733, "post_id": 41066226, "comment_id": 69339712, "body": "What does it disassemble to if you make a binary and use a normal disassembler for either NASM or GAS syntax?  (e.g. <code>objdump -drwC foo.o</code> to get AT&amp;T syntax, which is closest to what it looks like Go uses).  L is a valid condition-code (&quot;less than&quot;), and it&#39;s also used as an operand-size suffix in AT&amp;T syntax (and in this Go asm).  Confusingly, Go appears to always use AX, not EAX or RAX, even with 32-bit operand size.  MI doesn&#39;t make any sense to me (since I don&#39;t know Go asm), but LM and MI aren&#39;t valid condition codes.  <a href=\"http://www.felixcloutier.com/x86/CMOVcc.html\" rel=\"nofollow noreferrer\">felixcloutier.com/x86/CMOVcc.html</a>"}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "reply_to_user": {"reputation": 240649, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 3, "creation_date": 1481307149, "post_id": 41066226, "comment_id": 69339911, "body": "@PeterCordes I&#39;m guessing the L suffix means &quot;long&quot; like the other instructions and the MI suffix means &quot;minus&quot;."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1481307469, "post_id": 41066226, "comment_id": 69340088, "body": "What&#39;s the point of yet another x86 assembly syntax? Any good reason?"}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "reply_to_user": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 4, "creation_date": 1481307983, "post_id": 41066226, "comment_id": 69340292, "body": "@Ped7g Go invented it&#39;s own assembly syntax which they use across all platforms. Presumably it was done to make writing the compiler easier, though it comes at the cost of having to port the assembler too."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "reply_to_user": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1481310623, "post_id": 41066226, "comment_id": 69341636, "body": "@RossRidge But there&#39;s already one generic assembly syntax, over almost all platforms... C++. Doesn&#39;t make any sense to me. Whatever, it&#39;s their problem."}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "reply_to_user": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 1, "creation_date": 1481576092, "post_id": 41066226, "comment_id": 69423074, "body": "@Ped7g the video <a href=\"https://www.youtube.com/watch?v=KINIAgRpkDA\" rel=\"nofollow noreferrer\">Rob Pike - The Design of the Go Assembler</a> explains some of the motivation behind the assembly syntax"}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1481590166, "post_id": 41066226, "comment_id": 69428494, "body": "@Mark hm, so they dumbed down C for a false feel of being at machine code level. May work well for their needs, but the claim of being universal assembly is just laughable, the difference for example between x86 and MIPS is much more than syntax of <code>add</code>. On x86 you have for example rich flag register functionality (none on MIPS). They may look same, if you compare C++ produced output, because C++ never exploited the CPU fully. The only point is that they can produce new architecture pseudo-assembler more quickly. But if you want to use that CPU fully, you still need proper Assembler later."}], "answers": [{"tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": false, "score": 3, "last_activity_date": 1604333017, "last_edit_date": 1604333017, "creation_date": 1604073640, "answer_id": 64611799, "question_id": 41066226, "link": "https://stackoverflow.com/questions/41066226/go-x64-assembly-and-cmovlmi-where-is-this-opcode-described/64611799#64611799", "title": "Go, x64 assembly and CMOVLMI: Where is this opcode described?", "body": "<p>The <a href=\"http://golang.org/doc/asm\" rel=\"nofollow noreferrer\">Go assemblers</a> are derived from the <a href=\"https://9p.io/sys/doc/asm.html\" rel=\"nofollow noreferrer\">Plan 9 assemblers</a> with little changes.  The design concept of the Plan 9 assemblers is that they were supposed to have common syntax and naming conventions across all architectures.  While making assembly code more consistent within the framework of the Go toolchain, it can at time be very confusing to read such assembly code for people more familiar with conventional assemblers.</p>\n<p>As for the instruction in question, <code>CMOVLMI BX, DX</code>, specifically; it demonstrates some of the peculiar design choices of the Go assembler.  The mnemonic <code>CMOVLMI</code> has to be read like an ARM mnemonic where <code>CMOV</code> is the opcode, <code>L</code> is the operand size (long word, 32 bit) and <code>MI</code> is the condition on which it is executed (<strong>mi</strong>nus, i.e. sign flag set).  The operand size follows the established DEC conventions where <code>B</code>, <code>W</code>, <code>L</code>, <code>Q</code>, and <code>O</code> stand for <strong>b</strong>yte, <strong>w</strong>ord, <strong>l</strong>ong word, <strong>q</strong>uad word, and <strong>o</strong>cta word respectively.  The condition codes follow M68k conventions; here is a handy translation table:</p>\n<pre><code>Go syntax  Intel syntax\n---------  ------------\nOS         o\nOC         no\nCS, LO     b, c, nae\nCC, HS     nb, nc, ae\nEQ         e, z\nNE         ne, nz\nLS         be, na\nHI         nbe, a\nMI         s\nPL         ns\nPS         p, pe\nPC         np, po\nLT         l, nge\nGE         nl, ge\nLE         le, ng\nGT         nle, g\n</code></pre>\n<p>The mnemonics <code>LO</code> and <code>HS</code> are swapped for targets where carry is the inverse of borrow, like ARM.  For jump instructions, the Intel syntax variants are recognised as alternative mnemonics to ease the transition.  This is however not the case for other instructions.</p>\n<p>Additionally, the Go assembler does not distinguish general purpose register sizes by given the different register sizes different names (except for <code>AL</code>, <code>BL</code>, <code>CL</code>, and <code>DL</code> supported for consistency with <code>AH</code>, <code>BH</code>, <code>CH</code>, and <code>DH</code>).  The register <code>BX</code> can refer to any of <code>bl</code>, <code>bx</code>, <code>ebx</code>, and <code>rbx</code> depending on the instruction's operand size.</p>\n<p>Lastly, operand ordering follows AT&amp;T conventions, i.e. source, then destination.</p>\n<p>The instruction thus corresponds to the Intel instruction</p>\n<pre><code>cmovs edx, ebx\n</code></pre>\n<p>To compare the different representations, the <code>objdump</code> utility shipped with the Go toolchain supports a <code>-gnu</code> flag.  This dumps instructions in GNU syntax in addition to Plan 9 syntax, making it easy to compare the two.</p>\n"}], "owner": {"reputation": 15131, "user_id": 166838, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0c01a983961c34967d0ccedda9eb7d49?s=128&d=identicon&r=PG", "display_name": "Elf Sternberg", "link": "https://stackoverflow.com/users/166838/elf-sternberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1604333017, "creation_date": 1481306151, "last_edit_date": 1604097306, "question_id": 41066226, "link": "https://stackoverflow.com/questions/41066226/go-x64-assembly-and-cmovlmi-where-is-this-opcode-described", "title": "Go, x64 assembly and CMOVLMI: Where is this opcode described?", "body": "<p>I was reading through the Go source code, as one does, and as I was reading the <code>fastrand()</code> function, which for my machine would be in the <code>asm_amd64.s</code> file, I came across this snippet:</p>\n\n<pre><code>    XORL    $0x88888eef, DX\n    CMOVLMI BX, DX\n    MOVL    DX, m_fastrand(AX)\n</code></pre>\n\n<p>For the life of me, I cannot figure out what <code>CMOVLMI</code> is supposed to be doing.  A search for it reveals that only Go seems to know anything about it; I can find plenty of <code>CMOVxx</code> opcodes defined in the AMD X86_64 reference, and the <a href=\"https://en.wikipedia.org/wiki/X86_instruction_listings\" rel=\"nofollow noreferrer\">Wikipedia Page</a> has a long history of conditional move instructions, but this doesn't appear anywhere on that list.</p>\n\n<p>Where is CMOVLMI defined?  Is it unique to Go's internal assembler?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "edited": false, "score": 2, "creation_date": 1481299314, "post_id": 41064208, "comment_id": 69335671, "body": "You should remove all the UDP and other stuff not related to map. Try to provide simple code sample."}, {"owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "edited": false, "score": 4, "creation_date": 1481299721, "post_id": 41064208, "comment_id": 69335889, "body": "Try to get the value of the key in the map and compare it to the value of <code>testname</code> - they can look same but be different. For example <code>adc</code> and <code>\u0430d\u0441</code> - looks similar but have 2 different characters.  Put your code sample to play.golang.org"}, {"owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "edited": false, "score": 0, "creation_date": 1481301354, "post_id": 41064208, "comment_id": 69336863, "body": "Thanks for updating the code sample. But, 1st you are checkign hex not of the map key. try to move print of hex inside of range. 2nd. I guess the issue is with the way you get the test name. Try to print len(testname) - proabably the 0 bytes are simply not printed so you think it&#39;s just &#39;adc&#39; but in reality it is &#39;adc\\x0\\0....&#39;"}, {"owner": {"reputation": 1055, "user_id": 4205792, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0297dc684ce4aad71243b4e66d9e9f13?s=128&d=identicon&r=PG&f=1", "display_name": "dangeroushobo", "link": "https://stackoverflow.com/users/4205792/dangeroushobo"}, "reply_to_user": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "edited": false, "score": 0, "creation_date": 1481301646, "post_id": 41064208, "comment_id": 69337047, "body": "Key length was the issue. One was len=3, the other len=1024. Thanks for your help!"}], "answers": [{"comments": [{"owner": {"reputation": 1055, "user_id": 4205792, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0297dc684ce4aad71243b4e66d9e9f13?s=128&d=identicon&r=PG&f=1", "display_name": "dangeroushobo", "link": "https://stackoverflow.com/users/4205792/dangeroushobo"}, "edited": false, "score": 0, "creation_date": 1481550970, "post_id": 41066204, "comment_id": 69408999, "body": "If you use TrimSpace, it still doesn&#39;t work. There is no newline. The issue was the number of byte between the two keys were different."}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "reply_to_user": {"reputation": 1055, "user_id": 4205792, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0297dc684ce4aad71243b4e66d9e9f13?s=128&d=identicon&r=PG&f=1", "display_name": "dangeroushobo", "link": "https://stackoverflow.com/users/4205792/dangeroushobo"}, "edited": false, "score": 0, "creation_date": 1481553253, "post_id": 41066204, "comment_id": 69410405, "body": "Yes, that&#39;s true... upvoted your answer :) (TrimSpace <i>did</i> work for me... maybe it was a fluke that the extra bytes in my test runs were newlines)"}], "tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": false, "score": 2, "last_activity_date": 1481306056, "creation_date": 1481306056, "answer_id": 41066204, "question_id": 41064208, "link": "https://stackoverflow.com/questions/41064208/go-map-has-duplicate-keys/41066204#41066204", "title": "Go map has duplicate keys", "body": "<p>One of the keys has a trailing newline.  If you use <code>strings.TrimSpace</code> instead of <code>strings.Trim</code> you'll see that the trailing newline is trimmed and there is no duplicate.</p>\n"}, {"tags": [], "owner": {"reputation": 1055, "user_id": 4205792, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0297dc684ce4aad71243b4e66d9e9f13?s=128&d=identicon&r=PG&f=1", "display_name": "dangeroushobo", "link": "https://stackoverflow.com/users/4205792/dangeroushobo"}, "is_accepted": true, "score": 3, "last_activity_date": 1481551214, "creation_date": 1481551214, "answer_id": 41102560, "question_id": 41064208, "link": "https://stackoverflow.com/questions/41064208/go-map-has-duplicate-keys/41102560#41102560", "title": "Go map has duplicate keys", "body": "<p>As pointed out by Alexander, the issue is the length between the two keys are different. One key has the length of 3 and the other has the length of 1024. The first three bytes were the same and on the longer key the remaining bytes were 0x00.</p>\n\n<p>So the string output of the two keys make it appear the two are identical, but this was fooling me. The length of the keys was different.</p>\n"}], "owner": {"reputation": 1055, "user_id": 4205792, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0297dc684ce4aad71243b4e66d9e9f13?s=128&d=identicon&r=PG&f=1", "display_name": "dangeroushobo", "link": "https://stackoverflow.com/users/4205792/dangeroushobo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4182, "favorite_count": 0, "accepted_answer_id": 41102560, "answer_count": 2, "score": 0, "last_activity_date": 1481551214, "creation_date": 1481298802, "last_edit_date": 1481301370, "question_id": 41064208, "link": "https://stackoverflow.com/questions/41064208/go-map-has-duplicate-keys", "title": "Go map has duplicate keys", "body": "<p>I'm working on a small Go program that receives an ascii message over UDP. I want to look up the first field in the message and see if it exist in a map. Go thinks the key does not exist in the map but it does. I can add the key to the map and it creates a new entry, so I have two entries with the same key. I'm I doing something wrong or is this a bug?</p>\n\n<p>EDIT:\n I've simplified the test down to remove the UDP and YAML.</p>\n\n<p><a href=\"https://play.golang.org/p/2Bg8UjhfWC\" rel=\"nofollow noreferrer\">https://play.golang.org/p/2Bg8UjhfWC</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\ntype TestCase struct {\n    Test string\n    Result string\n}\n\nfunc main() {\n    tcmap := make(map[string]TestCase)\n    tcmap[\"adc\"] = TestCase{Test: \"/bar\"}\n    fmt.Printf(\"TestMap: ----------\\n%v\\n\\n\", tcmap)\n\n    buf := make([]byte, 1024)\n    buf[0] = 'a'//0x61\n    buf[1] = 'd'//0x64\n    buf[2] = 'c'//0x63\n\n    fmt.Printf(\"Received: ---------\\n%v\\n\\n\", string(buf[0:3]))\n    fmt.Printf(\"Compare hex:-------\\n|%x| |%x|\\n\\n\", buf[0:3], \"adc\")\n\n    // Get the first field from the message\n    testname := strings.Split(strings.Trim(string(buf), \" \"), \" \")[0]\n    fmt.Printf(\"Test Name: |%v|\\n\", testname)\n\n    // Does the key exist in the map?\n    if t, ok := tcmap[testname]; ok {\n        fmt.Printf(\"Test found: %v\\n\", t)\n    } else {\n        fmt.Printf(\"Test NOT found\\n\")\n    }\n\n    // Add testname to map, does it replace existing?\n    tcmap[testname] = TestCase{Test: \"/foo\"}\n    fmt.Printf(\"\\nMAP: ---------\\n%v\\n\\n\", tcmap)\n    fmt.Printf(\"KEY adc:---------\\n%v\\n\\n\", tcmap[\"adc\"])\n    for k,v := range tcmap {\n        fmt.Printf(\"%v: %v\\n\", k, v)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>TestMap: ----------\nmap[adc:{/bar }]\n\nReceived: ---------\nadc\n\nCompare hex:-------\n|616463| |616463|\n\nTest Name: |adc|\nTest NOT found\n\nMAP: ---------\nmap[adc:{/bar } adc:{/foo }]\n\nKEY adc:---------\n{/bar }\n\nadc: {/bar }\nadc: {/foo }\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 4, "last_activity_date": 1481300103, "creation_date": 1481300103, "answer_id": 41064567, "question_id": 41063435, "link": "https://stackoverflow.com/questions/41063435/how-can-i-handle-any-url-beginning-with-some-url-in-go/41064567#41064567", "title": "How Can I handle any url beginning with some url in Go?", "body": "<p>Per the documentation for gorilla/mux: <a href=\"http://www.gorillatoolkit.org/pkg/mux#Route.PathPrefix\" rel=\"nofollow noreferrer\">http://www.gorillatoolkit.org/pkg/mux#Route.PathPrefix</a></p>\n\n<pre><code>func (r *Router) PathPrefix(tpl string) *Route\n</code></pre>\n\n<blockquote>\n  <p>PathPrefix registers a new route with a matcher for the URL path\n  prefix. See Route.PathPrefix().</p>\n</blockquote>\n\n<pre><code>func (r *Route) PathPrefix(tpl string) *Route\n</code></pre>\n\n<blockquote>\n  <p>PathPrefix adds a matcher for the URL path prefix. This matches if the\n  given template is a prefix of the full URL path. See Route.Path() for\n  details on the tpl argument.</p>\n  \n  <p>Note that it does not treat slashes specially (\"/foobar/\" will be\n  matched by the prefix \"/foo\") so you may want to use a trailing slash\n  here.</p>\n  \n  <p>Also note that the setting of Router.StrictSlash() has no effect on\n  routes with a PathPrefix matcher.</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p>Note that the path provided to PathPrefix() represents a \"wildcard\":\n  calling PathPrefix(\"/static/\").Handler(...) means that the handler\n  will be passed any request that matches \"/static/*\".</p>\n</blockquote>\n\n<p>So what you're looking for is:</p>\n\n<pre><code>router := mux.NewRouter()\nrouter.PathPrefix(\"/a/b/c/\").HandleFunc(proxy.GrafanaHandler) // matches /a/b/c/*\n</code></pre>\n"}], "owner": {"reputation": 1308, "user_id": 5089153, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cf636637f2f2f80acaa49e04082922cd?s=128&d=identicon&r=PG&f=1", "display_name": "Said  Saifi", "link": "https://stackoverflow.com/users/5089153/said-saifi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 355, "favorite_count": 0, "accepted_answer_id": 41064567, "answer_count": 1, "score": 0, "last_activity_date": 1481356993, "creation_date": 1481296449, "last_edit_date": 1481356993, "question_id": 41063435, "link": "https://stackoverflow.com/questions/41063435/how-can-i-handle-any-url-beginning-with-some-url-in-go", "title": "How Can I handle any url beginning with some url in Go?", "body": "<p>Hi I am using gorilla/mux in go, and I want to handle any url that begins with : \"/a/b/c\" </p>\n\n<p>I tried:</p>\n\n<pre><code>router := mux.NewRouter().StrictSlash(true)\nrouter.HandleFunc(`/a/b/{_dummy:c(\\/)?.*}`, Func1)\n</code></pre>\n\n<p>that is the url can be /a/b/c/d or /a/b/c/d/e </p>\n"}, {"tags": ["go", "code-generation"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1481295999, "post_id": 41063147, "comment_id": 69333626, "body": "The usual method is to just try and parse the generated source. The keywords are all handled by the tokenizer in the &quot;go/token&quot; package."}], "answers": [{"tags": [], "owner": {"reputation": 4884, "user_id": 1087001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8k294.jpg?s=128&g=1", "display_name": "Sam Whited", "link": "https://stackoverflow.com/users/1087001/sam-whited"}, "is_accepted": true, "score": 2, "last_activity_date": 1481329143, "creation_date": 1481329143, "answer_id": 41070824, "question_id": 41063147, "link": "https://stackoverflow.com/questions/41063147/get-list-of-reserved-words-from-within-a-go-program/41070824#41070824", "title": "Get list of reserved words from within a Go program", "body": "<p>You can use the <code>IsKeyword</code> method from the <a href=\"https://godoc.org/go/token#Lookup\" rel=\"nofollow noreferrer\"><code>go/token</code></a> package. For instance:</p>\n\n<pre><code>token.Lookup(\"hello\").IsKeyword() // false\ntoken.Lookup(\"func\").IsKeyword()  // true\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/E5Yux3Z_PO\" rel=\"nofollow noreferrer\">Playground</a></p>\n"}], "owner": {"reputation": 1829, "user_id": 261006, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/67ccb6ee1a893be3dac35a7feff19e09?s=128&d=identicon&r=PG", "display_name": "Jasper", "link": "https://stackoverflow.com/users/261006/jasper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 41070824, "answer_count": 1, "score": 0, "last_activity_date": 1481329143, "creation_date": 1481295386, "question_id": 41063147, "link": "https://stackoverflow.com/questions/41063147/get-list-of-reserved-words-from-within-a-go-program", "title": "Get list of reserved words from within a Go program", "body": "<p>I am writing my first golang generator and want to make sure that some strings are not reserved keywords.<br>\nShould I copy the keywords from the spec to check against or does anyone know a better way?</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 7159, "user_id": 1458771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daccc9f7e12a09ef7adc52f9c7bd13b1?s=128&d=identicon&r=PG", "display_name": "Drew MacInnis", "link": "https://stackoverflow.com/users/1458771/drew-macinnis"}, "edited": false, "score": 0, "creation_date": 1481406931, "post_id": 41061803, "comment_id": 69367530, "body": "Are you sure the call to <code>Namespace</code> isn&#39;t returning an error? Your code sample shows you assigning <code>ctx</code> but there is no mentioning of where you are assigning the error return value. <a href=\"https://cloud.google.com/appengine/docs/go/reference#Namespace\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/docs/go/reference#Namespace</a>"}, {"owner": {"reputation": 767, "user_id": 4080676, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/NXpQt.png?s=128&g=1", "display_name": "iswak", "link": "https://stackoverflow.com/users/4080676/iswak"}, "reply_to_user": {"reputation": 7159, "user_id": 1458771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daccc9f7e12a09ef7adc52f9c7bd13b1?s=128&d=identicon&r=PG", "display_name": "Drew MacInnis", "link": "https://stackoverflow.com/users/1458771/drew-macinnis"}, "edited": false, "score": 0, "creation_date": 1481438557, "post_id": 41061803, "comment_id": 69373082, "body": "To answer your question, yes no errors are produced when setting up namespace. However after I inspected the code used to set/manage namespace, I noticed that internal namespace function <code>internal.NamespacedContext(c, namespace)</code> uses <code>netcontext.WithValue(ctx, &amp;namespaceKey, ns)</code> and upon dumping ctx I can see value <b>MyContext</b>. It&#39;s just not being set on namespace property, which am assume is used by internal logic in namespace aware API or maybe libs are not updated to use <code>namespaceKey</code> to obtain namespace from context."}, {"owner": {"reputation": 7159, "user_id": 1458771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daccc9f7e12a09ef7adc52f9c7bd13b1?s=128&d=identicon&r=PG", "display_name": "Drew MacInnis", "link": "https://stackoverflow.com/users/1458771/drew-macinnis"}, "edited": false, "score": 0, "creation_date": 1481452420, "post_id": 41061803, "comment_id": 69375860, "body": "Rather than inspecting the internals of <code>ctx</code>, have you tried using it and confirming that it isn&#39;t working? Is there actually a problem here?"}, {"owner": {"reputation": 767, "user_id": 4080676, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/NXpQt.png?s=128&g=1", "display_name": "iswak", "link": "https://stackoverflow.com/users/4080676/iswak"}, "reply_to_user": {"reputation": 7159, "user_id": 1458771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daccc9f7e12a09ef7adc52f9c7bd13b1?s=128&d=identicon&r=PG", "display_name": "Drew MacInnis", "link": "https://stackoverflow.com/users/1458771/drew-macinnis"}, "edited": false, "score": 0, "creation_date": 1481452706, "post_id": 41061803, "comment_id": 69375927, "body": "@DrewMacInnis there is an issue, using the ctx with datastore api <a href=\"https://cloud.google.com/appengine/docs/go/multitenancy/multitenancy#Go_Using_namespaces_with_the_Datastore\" rel=\"nofollow noreferrer\">Go_Using_namespaces_with_the_Datastore</a> which has been documented to support multi tenancy using namespace, still stores data under default namespace. Therefore it doesn&#39;t work, reason I started inspecting the internals and started this thread. Have you successfully used namespace to implement multi tenancy feature?"}, {"owner": {"reputation": 7159, "user_id": 1458771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daccc9f7e12a09ef7adc52f9c7bd13b1?s=128&d=identicon&r=PG", "display_name": "Drew MacInnis", "link": "https://stackoverflow.com/users/1458771/drew-macinnis"}, "edited": false, "score": 0, "creation_date": 1481453169, "post_id": 41061803, "comment_id": 69376054, "body": "I&#39;m just trying to understand your problem, this last comment better explains what you are trying to do and what isn&#39;t working. To answer your question, no I haven&#39;t."}], "answers": [{"tags": [], "owner": {"reputation": 767, "user_id": 4080676, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/NXpQt.png?s=128&g=1", "display_name": "iswak", "link": "https://stackoverflow.com/users/4080676/iswak"}, "is_accepted": true, "score": 2, "last_activity_date": 1481669803, "creation_date": 1481669803, "answer_id": 41132011, "question_id": 41061803, "link": "https://stackoverflow.com/questions/41061803/app-engine-go-context-context-has-no-namespace/41132011#41132011", "title": "App Engine go context.Context has no namespace", "body": "<p>Mixing of google api go libs, was causing the problem.</p>\n\n<p><a href=\"https://github.com/GoogleCloudPlatform/google-cloud-go/issues/460\" rel=\"nofollow noreferrer\"><strong>Long Answer</strong></a></p>\n\n<p><strong>Short Answer</strong></p>\n\n<p>Google Cloud API libs come in two different flavors, issues was caused by mixing of lib features from libs below.</p>\n\n<p><a href=\"https://github.com/GoogleCloudPlatform/google-cloud-go\" rel=\"nofollow noreferrer\">google-cloud-go</a> <em>Recommanded</em></p>\n\n<p><a href=\"https://github.com/google/google-api-go-client\" rel=\"nofollow noreferrer\">google-api-go-client</a></p>\n"}], "owner": {"reputation": 767, "user_id": 4080676, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/NXpQt.png?s=128&g=1", "display_name": "iswak", "link": "https://stackoverflow.com/users/4080676/iswak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 1, "accepted_answer_id": 41132011, "answer_count": 1, "score": 1, "last_activity_date": 1482429395, "creation_date": 1481290857, "last_edit_date": 1482429395, "question_id": 41061803, "link": "https://stackoverflow.com/questions/41061803/app-engine-go-context-context-has-no-namespace", "title": "App Engine go context.Context has no namespace", "body": "<p>After obtain a context from <code>ctx, ctxErr := appengine.Namespace(ctx, \"MyContext\")</code> I would expect <code>ctx</code> namespace to be populated with <code>MyContext</code> </p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>import (\n...\n\"golang.org/x/net/context\"\n\"google.golang.org/appengine\"\n)\n\n\nctx := appengine.NewContext(r)\nctx, ctxErr := appengine.Namespace(ctx, \"MyContext\")\nif ctxErr != nil {\n  log.Errorf(ctx, \"Failed to obtain custom namespace context, error:%s\", ctxErr.Error())\n  //use default if all else fails\n  ctx = appengine.NewContext(r)\n}\n</code></pre>\n\n<p>However this is not the case, thus causing all namespace aware API to use default namespace.</p>\n\n<p>Dump of ctx produces the following (see yellow bordered output)</p>\n\n<p><a href=\"https://i.stack.imgur.com/IQ9xD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IQ9xD.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Example App</strong></p>\n\n<p>Populate <code>projectID := \"\"</code> with your project id, ensure you have performed authentication on your development environment and run <code>go run /example/app/main.go</code></p>\n\n<p><a href=\"https://play.golang.org/p/tYEDG16MBl\" rel=\"nofollow noreferrer\">Example App</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1481290780, "post_id": 41061702, "comment_id": 69330077, "body": "You can&#39;t. The value in an interface is not addressable. If you need a pointer, put a pointer in the interface."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1481291060, "post_id": 41061702, "comment_id": 69330249, "body": "As JimB pointed out, it is not addressable. The interface value holds a copy of the original, so there would be no point. See related / possible duplicate question: <a href=\"http://stackoverflow.com/questions/41015114/types-of-go-struct-methods-that-satisfy-an-interface/41016448#41016448\">Types of Go struct methods that satisfy an interface</a>"}, {"owner": {"reputation": 273, "user_id": 665706, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/00f7d33b4493a6263e6edebde9001fc5?s=128&d=identicon&r=PG", "display_name": "paolo_losi", "link": "https://stackoverflow.com/users/665706/paolo-losi"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1481384959, "post_id": 41061702, "comment_id": 69360884, "body": "@icza. You really helped me to understad"}], "answers": [{"tags": [], "owner": {"reputation": 1217, "user_id": 5066719, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/902c0e0e880e8e5d5395c6872f05fb05?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Soni", "link": "https://stackoverflow.com/users/5066719/abhishek-soni"}, "is_accepted": false, "score": 1, "last_activity_date": 1481296342, "creation_date": 1481296342, "answer_id": 41063415, "question_id": 41061702, "link": "https://stackoverflow.com/questions/41061702/how-to-obtain-a-reference-to-an-interface-value/41063415#41063415", "title": "how to obtain a reference to an interface value", "body": "<p>To clear your doubts if you go by the meaning Assert</p>\n\n<blockquote>\n  <p>state a fact or belief confidently and forcefully</p>\n</blockquote>\n\n<p>in your example <code>x.(Foo)</code> is just a type assertion it's not a object so you can not get its address.</p>\n\n<p>so at runtime when the object will be created for example </p>\n\n<pre><code>var c interface{} = 5\nd := c.(int)\nfmt.Println(\"Hello\", c, d)  // Hello 5 5\n</code></pre>\n\n<p>it only assert that </p>\n\n<blockquote>\n  <p>asserts that c is not nil and that the value stored in c is of type int</p>\n</blockquote>\n\n<p>So its not any physical entity in memory but at runtime <code>d</code> will be allocated memory based on asserted type and than the contents of c will be copied into that location.</p>\n\n<p>So you can do something like</p>\n\n<pre><code>var c interface{} = 5\nd := &amp;c\nfmt.Println(\"Hello\", (*d).(int)) // hello 5\n</code></pre>\n\n<p>Hope i cleared your confusion.</p>\n"}], "owner": {"reputation": 273, "user_id": 665706, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/00f7d33b4493a6263e6edebde9001fc5?s=128&d=identicon&r=PG", "display_name": "paolo_losi", "link": "https://stackoverflow.com/users/665706/paolo-losi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1481296342, "creation_date": 1481290547, "question_id": 41061702, "link": "https://stackoverflow.com/questions/41061702/how-to-obtain-a-reference-to-an-interface-value", "title": "how to obtain a reference to an interface value", "body": "<p>Is it possibile to obtain a reference to an Interface Value without \nreccurring to reflection? If not, why not?</p>\n\n<p>I have attempted:</p>\n\n<pre><code>package foo\n\ntype Foo struct {\n    a, b int\n}\n\nfunc f(x interface{}) {\n    var foo *Foo = &amp;x.(Foo)\n    foo.a = 2\n}\n\nfunc g(foo Foo) {\n    f(foo)\n}\n</code></pre>\n\n<p>but it fails with:</p>\n\n<pre><code>./test.go:8: cannot take the address of x.(Foo)\n</code></pre>\n"}, {"tags": ["database", "rest", "go"], "comments": [{"owner": {"reputation": 952, "user_id": 4555798, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/956224387724154/picture?type=large", "display_name": "oharlem", "link": "https://stackoverflow.com/users/4555798/oharlem"}, "edited": false, "score": 0, "creation_date": 1481293161, "post_id": 41061042, "comment_id": 69331659, "body": "I find it confusing that while your database fields are all non-null, you still have &quot;...in the reply many of the fields are nil...&quot;, i.e. some values for your would-be query where not set. Unless I miss some point, there&#39;s an issue with business-logic. Please elaborate."}, {"owner": {"reputation": 16093, "user_id": 534298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4ba32c06ed067564a6c6512de5217657?s=128&d=identicon&r=PG", "display_name": "nos", "link": "https://stackoverflow.com/users/534298/nos"}, "reply_to_user": {"reputation": 952, "user_id": 4555798, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/956224387724154/picture?type=large", "display_name": "oharlem", "link": "https://stackoverflow.com/users/4555798/oharlem"}, "edited": false, "score": 0, "creation_date": 1481298994, "post_id": 41061042, "comment_id": 69335483, "body": "@mpmlj After the query, there is a projection, I only return say 3 of the fields back to user instead of all fields. In the current implementation, I return the datum struct with many nil fields. Hope it clarifies."}], "answers": [{"tags": [], "owner": {"reputation": 3102, "user_id": 2518022, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dyYFh.jpg?s=128&g=1", "display_name": "Gepser", "link": "https://stackoverflow.com/users/2518022/gepser"}, "is_accepted": false, "score": 0, "last_activity_date": 1481293241, "creation_date": 1481293241, "answer_id": 41062492, "question_id": 41061042, "link": "https://stackoverflow.com/questions/41061042/strategy-for-rest-api-in-go/41062492#41062492", "title": "strategy for REST API in go", "body": "<p>The approach I suggest (is the one I use) is the <code>new struct</code> with <code>omitempty</code> tag, for example:</p>\n\n<pre><code>type datumResponse struct{\n    Id *string `json:\"task_id,omitempty\"`\n    Status *string `json:\"status,omitempty\"`\n    AccountId *string `json:\"account_id,omitempty\"`\n    .... // many more fields\n}\n</code></pre>\n\n<p>and there is no option to write your new <code>struct</code> using the fields of the old one if there is not substructs or you don't write an array of structs.</p>\n"}, {"comments": [{"owner": {"reputation": 16093, "user_id": 534298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4ba32c06ed067564a6c6512de5217657?s=128&d=identicon&r=PG", "display_name": "nos", "link": "https://stackoverflow.com/users/534298/nos"}, "edited": false, "score": 0, "creation_date": 1481321595, "post_id": 41066332, "comment_id": 69346560, "body": "Your 3rd way is what I wanted. Thanks very much."}], "tags": [], "owner": {"reputation": 952, "user_id": 4555798, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/956224387724154/picture?type=large", "display_name": "oharlem", "link": "https://stackoverflow.com/users/4555798/oharlem"}, "is_accepted": true, "score": 1, "last_activity_date": 1481317801, "last_edit_date": 1481317801, "creation_date": 1481306619, "answer_id": 41066332, "question_id": 41061042, "link": "https://stackoverflow.com/questions/41061042/strategy-for-rest-api-in-go/41066332#41066332", "title": "strategy for REST API in go", "body": "<p>You have several options, with choice depending what is more wasteful/expensive in your particular case:</p>\n\n<ol>\n<li>Just use pointers+omitempty in the original struct.</li>\n<li>Prepare a custom response object. But you'll need to copy/convert the values from the original struct into its export version.</li>\n<li>Write a custom marshaller, that will be exploring your struct and creating an export-ready variant, this way being more dynamic/automatic that #1.</li>\n</ol>\n\n<p>While #1 needs no comments, and #2 to some extend covered by Gepser above, here's how you can address this with a custom marshaller (the idea is to re-assemble your output skipping nil fields):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"encoding/json\"\n    \"reflect\"\n)\n\ntype datum struct {\n    Id        *string `json:\"task_id\"`\n    Status    *string `json:\"status\"`\n    AccountId *string `json:\"account_id\"`\n}\n\ntype Response struct {\n    Reply []datum `json:\"reply\"`\n}\n\nfunc main() {\n\n    var query_result []datum\n\n    // mocking a query result with records with nil fields\n    val_id_a := \"id-a\"\n    val_status := \"status-b\"\n    d1 := datum{\n        Id:     &amp;val_id_a,\n        Status: &amp;val_status,\n    }\n\n    query_result = append(query_result, d1)\n\n    val_id_b := \"id-b\"\n    val_account_id := \"account-id-b\"\n    d2 := datum{\n        Id:        &amp;val_id_b,\n        AccountId: &amp;val_account_id,\n    }\n\n    query_result = append(query_result, d2)\n\n    reply := &amp;Response{\n        Reply: query_result,\n    }\n\n    data, err := json.Marshal(reply)\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Printf(\"%+v\\n\", string(data))\n}\n\n// MarshalJSON is a custom JSON marshaller implementation for Response object.\nfunc (r *Response) MarshalJSON() ([]byte, error) {\n    a := struct {\n        Reply []map[string]interface{} `json:\"reply\"`\n    }{}\n\n    for _, v := range r.Reply {\n        a.Reply = append(a.Reply, converter(v))\n    }\n\n    return json.Marshal(a)\n}\n\n// converter converts a struct into a map, skipping fields with nil values.\nfunc converter(in interface{}) map[string]interface{} {\n    out := make(map[string]interface{})\n    v := reflect.ValueOf(in)\n\n    for i := 0; i &lt; v.NumField(); i++ {\n        f := v.Type().Field(i)\n        tag := f.Tag.Get(\"json\")\n        if tag != \"\" &amp;&amp; !v.Field(i).IsNil() {\n            out[tag] = v.Field(i).Interface()\n        }\n    }\n    return out\n}\n</code></pre>\n"}], "owner": {"reputation": 16093, "user_id": 534298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4ba32c06ed067564a6c6512de5217657?s=128&d=identicon&r=PG", "display_name": "nos", "link": "https://stackoverflow.com/users/534298/nos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 1, "accepted_answer_id": 41066332, "answer_count": 2, "score": 2, "last_activity_date": 1481317801, "creation_date": 1481288237, "last_edit_date": 1481293470, "question_id": 41061042, "link": "https://stackoverflow.com/questions/41061042/strategy-for-rest-api-in-go", "title": "strategy for REST API in go", "body": "<p>In my database, each row corresponds to a struct </p>\n\n<pre><code>type datum struct{\n    Id *string `json:\"task_id\"`\n    Status *string `json:\"status\"`\n    AccountId *string `json:\"account_id\"`\n    .... // many more fields, all of pointer types\n}\n</code></pre>\n\n<p>On the webpage, the user can query on several fields of datum (say <code>account_id</code> and <code>status</code>). The server will return all data that satisfy the query with a projection of the fields (say <code>Id</code>, <code>account_id</code> and <code>status</code>).</p>\n\n<p>Right now, I wrote a HTTP handler to </p>\n\n<p>Extract the query as a datum object from the request: </p>\n\n<pre><code>body, err := ioutil.ReadAll(r.Body)\ncondition := datum{} \nerr = json.Unmarshal(body, &amp;condition)\n</code></pre>\n\n<p>Use the partially filled datum object to query the database, only the non-nil fields translate to <code>SELECT ... WHERE ..=..</code>. The query result is saved in <code>query_result []datum</code></p>\n\n<p>Write the <code>query_result</code> into json object for reply:</p>\n\n<pre><code>reply := map[string]interface{}{\n            \"reply\": query_result,\n        }\ndata, err := json.Marshal(reply)\n</code></pre>\n\n<p>The problem is that in the reply many of the fields are nil, but I still send them, which is wasteful. On the other hand, I don't want to change the datum struct to include <code>omitempty</code> tag because in the database a value entry has all fields non-nil.</p>\n\n<ul>\n<li>In this case, shall I define a new struct just for the reply? Is there a way to define this new struct using <code>datum</code> struct, instead of hard code one?</li>\n<li>Is there a better design for this query feature?</li>\n</ul>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1481287901, "post_id": 41060764, "comment_id": 69328144, "body": "No there is not. You&#39;ll either have to invoke the compiler &quot;by hand&quot; (<code>go tool compile</code>) ore move these packages."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 2, "creation_date": 1481301795, "post_id": 41060764, "comment_id": 69337131, "body": "Generally, if they are in an <code>&#47;internal&#47;</code> subdirectory, that means you&#39;re either using a library from before vendoring was added (Go 1.5/1.6), or <i>you&#39;re not supposed to use those packages</i>."}, {"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 1, "creation_date": 1484222725, "post_id": 41060764, "comment_id": 70426766, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/41571946/internal-packages-in-go\">Internal packages in Go</a>"}, {"owner": {"reputation": 343, "user_id": 5019932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa317ece3b13543559cbf2e2d0833e37?s=128&d=identicon&r=PG", "display_name": "Javier Zunzunegui", "link": "https://stackoverflow.com/users/5019932/javier-zunzunegui"}, "edited": false, "score": 0, "creation_date": 1487342250, "post_id": 41060764, "comment_id": 71755600, "body": "Re invoke compiler &quot;by hand&quot;, i have found no way of building it using the go build libraries as-is."}, {"owner": {"reputation": 343, "user_id": 5019932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa317ece3b13543559cbf2e2d0833e37?s=128&d=identicon&r=PG", "display_name": "Javier Zunzunegui", "link": "https://stackoverflow.com/users/5019932/javier-zunzunegui"}, "edited": false, "score": 0, "creation_date": 1487342308, "post_id": 41060764, "comment_id": 71755636, "body": "I have been able to do it by modifying the <code>cmd&#47;go</code> pkg, removing all uses of  <a href=\"https://github.com/golang/go/blob/2ac32b6360b47e3e5bb87ad8cbc51c3d91467c85/src/cmd/go/internal/load/pkg.go#L591-L594\" rel=\"nofollow noreferrer\">disallowInternal</a>"}], "answers": [{"tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": false, "score": 18, "last_activity_date": 1588162316, "last_edit_date": 1588162316, "creation_date": 1481289212, "answer_id": 41061330, "question_id": 41060764, "link": "https://stackoverflow.com/questions/41060764/how-to-disable-use-of-internal-package-not-allowed/41061330#41061330", "title": "How to disable &quot;use of internal package not allowed&quot;", "body": "<p>An import of a path containing the element \u201cinternal\u201d disallowed if the importing code is outside the tree rooted at the parent of the \u201cinternal\u201d directory. There is no mechanism for exceptions. In particular, by design, there is no ACL mechanism for allowing a whitelist of other packages to use an internal package.</p>\n\n<p><a href=\"https://docs.google.com/document/d/1e8kOo3r51b2BWtTs_1uADIA5djfXhPT36s6eHVRIvaU/edit\" rel=\"nofollow noreferrer\">Proposal for the rule</a></p>\n"}], "owner": {"reputation": 343, "user_id": 5019932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa317ece3b13543559cbf2e2d0833e37?s=128&d=identicon&r=PG", "display_name": "Javier Zunzunegui", "link": "https://stackoverflow.com/users/5019932/javier-zunzunegui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30264, "favorite_count": 2, "answer_count": 1, "score": 25, "last_activity_date": 1591016542, "creation_date": 1481287329, "last_edit_date": 1591016542, "question_id": 41060764, "link": "https://stackoverflow.com/questions/41060764/how-to-disable-use-of-internal-package-not-allowed", "title": "How to disable &quot;use of internal package not allowed&quot;", "body": "<p>I have a go program that inspects a large repository, selects some packages of interest, and then generates a new main.go file that has:</p>\n\n<pre><code>import(\n  _ (package of interest here)\n  _ (another package of interest here)\n  ...\n)\nfunc main() {...}\n</code></pre>\n\n<p>The main is interested in some values these packages set in their <code>init</code> method. </p>\n\n<p>However some of these packages have (...)/internal/(...) paths and so I get <code>use of internal package not allowed</code> when trying to run the generated main.go.</p>\n\n<p>Is there some compiler / linker / other flag that disables the <code>internal</code> path check?</p>\n"}, {"tags": ["go", "process", "command", "kill"], "comments": [{"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 1, "creation_date": 1481292173, "post_id": 41060457, "comment_id": 69330984, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/9030680/list-of-currently-running-process-in-golang\">List of currently running process in Golang</a>"}, {"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 0, "creation_date": 1481309384, "post_id": 41060457, "comment_id": 69340994, "body": "There is no way but to execute an external command."}], "answers": [{"tags": [], "owner": {"reputation": 804, "user_id": 7171834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9r1VB.png?s=128&g=1", "display_name": "Peter Gloor", "link": "https://stackoverflow.com/users/7171834/peter-gloor"}, "is_accepted": false, "score": 7, "last_activity_date": 1481404012, "creation_date": 1481404012, "answer_id": 41080337, "question_id": 41060457, "link": "https://stackoverflow.com/questions/41060457/golang-kill-process-by-name/41080337#41080337", "title": "Golang - kill process by name", "body": "<p>Running external commands is probably the best way to do this. However, the following code runs on Ubuntu at least as long as you are the owner of the process to kill.</p>\n\n<pre><code>// killprocess project main.go\npackage main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"io\"\n    \"io/ioutil\"\n    \"log\"\n    \"os\"\n    \"path/filepath\"\n    \"strconv\"\n    \"strings\"\n)\n\n// args holds the commandline args\nvar args []string\n\n// findAndKillProcess walks iterative through the /process directory tree\n// looking up the process name found in each /proc/&lt;pid&gt;/status file. If\n// the name matches the name in the argument the process with the corresponding\n// &lt;pid&gt; will be killed.\nfunc findAndKillProcess(path string, info os.FileInfo, err error) error {\n    // We just return in case of errors, as they are likely due to insufficient\n    // privileges. We shouldn't get any errors for accessing the information we\n    // are interested in. Run as root (sudo) and log the error, in case you want\n    // this information.\n    if err != nil {\n        // log.Println(err)\n        return nil\n    }\n\n    // We are only interested in files with a path looking like /proc/&lt;pid&gt;/status.\n    if strings.Count(path, \"/\") == 3 {\n        if strings.Contains(path, \"/status\") {\n\n            // Let's extract the middle part of the path with the &lt;pid&gt; and\n            // convert the &lt;pid&gt; into an integer. Log an error if it fails.\n            pid, err := strconv.Atoi(path[6:strings.LastIndex(path, \"/\")])\n            if err != nil {\n                log.Println(err)\n                return nil\n            }\n\n            // The status file contains the name of the process in its first line.\n            // The line looks like \"Name: theProcess\".\n            // Log an error in case we cant read the file.\n            f, err := ioutil.ReadFile(path)\n            if err != nil {\n                log.Println(err)\n                return nil\n            }\n\n            // Extract the process name from within the first line in the buffer\n            name := string(f[6:bytes.IndexByte(f, '\\n')])\n\n            if name == args[1] {\n                fmt.Printf(\"PID: %d, Name: %s will be killed.\\n\", pid, name)\n                proc, err := os.FindProcess(pid)\n                if err != nil {\n                    log.Println(err)\n                }\n                // Kill the process\n                proc.Kill()\n\n                // Let's return a fake error to abort the walk through the\n                // rest of the /proc directory tree\n                return io.EOF\n            }\n\n        }\n    }\n\n    return nil\n}\n\n// main is the entry point of any go application\nfunc main() {\n    args = os.Args\n    if len(args) != 2 {\n        log.Fatalln(\"Usage: killprocess &lt;processname&gt;\")\n    }\n    fmt.Printf(\"trying to kill process \\\"%s\\\"\\n\", args[1])\n\n    err := filepath.Walk(\"/proc\", findAndKillProcess)\n    if err != nil {\n        if err == io.EOF {\n            // Not an error, just a signal when we are done\n            err = nil\n        } else {\n            log.Fatal(err)\n        }\n    }\n}\n</code></pre>\n\n<p>It's just an example that certainly can be improved. I wrote this for Linux and tested the code on Ubuntu 15.10. It will not run on Windows.</p>\n"}, {"comments": [{"owner": {"reputation": 312, "user_id": 4920026, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KR0NK.jpg?s=128&g=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/4920026/priyanka"}, "edited": false, "score": 0, "creation_date": 1518527190, "post_id": 42251505, "comment_id": 84535334, "body": "But how to kill process if we do not know pid?"}, {"owner": {"reputation": 16065, "user_id": 1561148, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/zN5vT.jpg?s=128&g=1", "display_name": "tgogos", "link": "https://stackoverflow.com/users/1561148/tgogos"}, "reply_to_user": {"reputation": 312, "user_id": 4920026, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KR0NK.jpg?s=128&g=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/4920026/priyanka"}, "edited": false, "score": 1, "creation_date": 1518527669, "post_id": 42251505, "comment_id": 84535689, "body": "The above code snippet does exactly what you are asking for. You don&#39;t know the <code>pid</code> but you have to know the <code>name</code> of the executable that you want to kill. For example, here the signal is sent to <code>my_app_name</code>"}], "tags": [], "owner": {"reputation": 16065, "user_id": 1561148, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/zN5vT.jpg?s=128&g=1", "display_name": "tgogos", "link": "https://stackoverflow.com/users/1561148/tgogos"}, "is_accepted": true, "score": 7, "last_activity_date": 1518529004, "last_edit_date": 1518529004, "creation_date": 1487167375, "answer_id": 42251505, "question_id": 41060457, "link": "https://stackoverflow.com/questions/41060457/golang-kill-process-by-name/42251505#42251505", "title": "Golang - kill process by name", "body": "<p>I finally used something like the following:</p>\n\n<pre><code>// `echo \"sudo_password\" | sudo -S [command]`\n// is used in order to run the command with `sudo`\n\n_, err := exec.Command(\"sh\", \"-c\", \"echo '\"+ sudopassword +\"' | sudo -S pkill -SIGINT my_app_name\").Output()\n\nif err != nil {\n    // ...\n} else {\n    // ...\n}\n</code></pre>\n\n<p>I used the <code>SIGINT</code> signal to gracefully stop the app.</p>\n\n<p>From <a href=\"https://en.wikipedia.org/wiki/Signal_(IPC)\" rel=\"noreferrer\">wikipedia</a>:</p>\n\n<ul>\n<li><p><code>SIGINT</code></p>\n\n<p>The SIGINT signal is sent to a process by its controlling terminal when a user wishes to interrupt the process. This is typically initiated by pressing Ctrl+C, but on some systems, the \"delete\" character or \"break\" key can be used.</p></li>\n<li><p><code>SIGKILL</code></p>\n\n<p>The SIGKILL signal is sent to a process to cause it to terminate immediately (kill). In contrast to SIGTERM and SIGINT, this signal cannot be caught or ignored, and the receiving process cannot perform any clean-up upon receiving this signal. The following exceptions apply:</p></li>\n</ul>\n"}], "owner": {"reputation": 16065, "user_id": 1561148, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/zN5vT.jpg?s=128&g=1", "display_name": "tgogos", "link": "https://stackoverflow.com/users/1561148/tgogos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16984, "favorite_count": 1, "accepted_answer_id": 42251505, "answer_count": 2, "score": 6, "last_activity_date": 1518529004, "creation_date": 1481286295, "last_edit_date": 1495535400, "question_id": 41060457, "link": "https://stackoverflow.com/questions/41060457/golang-kill-process-by-name", "title": "Golang - kill process by name", "body": "<p>What would be an effective way to kill a process with Go code if you only know the process name? I see some functions provided by the <code>os</code> package like:</p>\n\n<pre><code>func FindProcess(pid int) (*Process, error)\nfunc (p *Process) Kill() error\nfunc (p *Process) Signal(sig Signal) error\n</code></pre>\n\n<p>Is there a good/common practice to get the <code>pid</code> without having to execute commands and then parse the output?</p>\n\n<p>I have found a way to get back the pid using a command like the following:</p>\n\n<ul>\n<li><code>echo $(ps cax | grep myapp | grep -o '^[ ]*[0-9]*')</code></li>\n</ul>\n\n<p>and I have <a href=\"https://stackoverflow.com/questions/41037870/go-exec-command-run-command-which-contains-pipe\">used it with <code>exec.Command()</code></a> but I would like to avoid it if there is a better approach.</p>\n"}, {"tags": ["go", "beego"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1481283771, "post_id": 41059688, "comment_id": 69325763, "body": "<code>?&lt;!</code> is <a href=\"https://github.com/google/re2/wiki/Syntax\" rel=\"nofollow noreferrer\">not supported</a>."}, {"owner": {"reputation": 1462, "user_id": 4476788, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/100000129818719/picture?type=large", "display_name": "Muhamad Yulianto", "link": "https://stackoverflow.com/users/4476788/muhamad-yulianto"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1481284838, "post_id": 41059688, "comment_id": 69326370, "body": "@Ainar-G just updated my regex, still not work"}], "owner": {"reputation": 1462, "user_id": 4476788, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/100000129818719/picture?type=large", "display_name": "Muhamad Yulianto", "link": "https://stackoverflow.com/users/4476788/muhamad-yulianto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 233, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1481284777, "creation_date": 1481283708, "last_edit_date": 1481284777, "question_id": 41059688, "link": "https://stackoverflow.com/questions/41059688/regex-insert-filter-on-router-beego-framework", "title": "Regex Insert Filter on Router Beego Framework", "body": "<p>I try to use regex that not contain url prefix /<strong>token</strong> like this</p>\n\n<pre><code>    beego.InsertFilter(\"^((?!token).)*$\",beego.BeforeRouter,token_construct.APIBaiscAuth(\"ok\",\"ok\"))\n</code></pre>\n\n<p>But not work, all url prefix still skip the filter function.</p>\n\n<p>How to use regex in this function</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 373, "user_id": 1924721, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ba12cccb8e7b9f1da05f7226a25521d2?s=128&d=identicon&r=PG", "display_name": "neclepsio", "link": "https://stackoverflow.com/users/1924721/neclepsio"}, "edited": false, "score": 1, "creation_date": 1481281442, "post_id": 41058872, "comment_id": 69324397, "body": "What you are asking would not save your bacon. You can do it with <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\">reflection</a>, but I would not recommend it."}], "answers": [{"comments": [{"owner": {"reputation": 11213, "user_id": 103999, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/231742e13810156987b1e462314f8eb9?s=128&d=identicon&r=PG", "display_name": "Lee Armstrong", "link": "https://stackoverflow.com/users/103999/lee-armstrong"}, "edited": false, "score": 0, "creation_date": 1481282628, "post_id": 41059089, "comment_id": 69325072, "body": "Perfect, nice answer.  I have not just string types so I will also look into reflection"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1481283883, "last_edit_date": 1481283883, "creation_date": 1481281823, "answer_id": 41059089, "question_id": 41058872, "link": "https://stackoverflow.com/questions/41058872/being-a-little-more-dynamic-with-go/41059089#41059089", "title": "Being a little more dynamic with Go", "body": "<p>Without any \"magic\", your code can be simplified to this:</p>\n\n<pre><code>parsed, err := jsonparser.ParseInt(value)\n// check err\nswitch intValue := int(parsed); key {\ncase \"altitude\":\n    n.ThisDataRaw.Altitude = &amp;intValue\ncase \"heading\":\n    n.ThisDataRaw.Heading = &amp;intValue\ncase \"speed\":\n    n.ThisDataRaw.Speed = &amp;intValue\n}\n</code></pre>\n\n<p>It's much cleaner and contains minimal code redundancy. If the <code>n.ThisDataRaw</code> field is a pointer, we can do a little more:</p>\n\n<pre><code>parsed, err := jsonparser.ParseInt(value)\n// check err\nswitch intValue, tdr := int(parsed), n.ThisDataRaw; key {\ncase \"altitude\":\n    tdr.Altitude = &amp;intValue\ncase \"heading\":\n    tdr.Heading = &amp;intValue\ncase \"speed\":\n    tdr.Speed = &amp;intValue\n}\n</code></pre>\n\n<p>If the <code>n.ThisDataRaw</code> field is not a pointer, we can still apply this last step, by taking its address:</p>\n\n<pre><code>switch intValue, tdr := int(parsed), &amp;n.ThisDataRaw; key {\n</code></pre>\n\n<p>(The rest of the code is the same.)</p>\n\n<p>You should be satisfied by this. If not, read on.</p>\n\n<p>If the data identifying your struct field comes as a <code>string</code>, we either have to use some kind of branching (like the <code>switch</code> above), or we may use reflection to get the field based on the <code>string</code> value.</p>\n\n<p>Note: using reflection instead of the <code>switch</code>, we'd risk setting fields which otherwise we would not want to. Also reflection will make it slower, and harder to understand. If the number of fields is not big, just use the <code>switch</code>.</p>\n\n<p>If the key value equals to the field name, this would be very simple, but be sure to pass a pointer to <a href=\"https://golang.org/pkg/reflect/#ValueOf\" rel=\"nofollow noreferrer\"><code>reflect.ValueOf()</code></a>, else it won't be settable.</p>\n\n<p>If the key value does not equal to the field name, we could create a mapping from the actual key values to the target field names, so again after indexing this map getting the target field would be the same. This solution also gives us some kind of protection: if the key value is not in the map, we would not change any fields.</p>\n"}], "owner": {"reputation": 11213, "user_id": 103999, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/231742e13810156987b1e462314f8eb9?s=128&d=identicon&r=PG", "display_name": "Lee Armstrong", "link": "https://stackoverflow.com/users/103999/lee-armstrong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 41059089, "answer_count": 1, "score": 2, "last_activity_date": 1481283883, "creation_date": 1481281137, "question_id": 41058872, "link": "https://stackoverflow.com/questions/41058872/being-a-little-more-dynamic-with-go", "title": "Being a little more dynamic with Go", "body": "<p>I'm new to Go and I do like the static type checking a lot, it has saved my bacon a few times already at compile phase!</p>\n\n<p>I do however see that I am duplicating a lot of code such as...</p>\n\n<pre><code>if string(key) == \"altitude\" {\n    altitudeInt, _ := jsonparser.ParseInt(value)\n    n.ThisDataRaw.Altitude = new(int)\n    *n.ThisDataRaw.Altitude = int(altitudeInt)\n    return nil\n}\n\nif string(key) == \"heading\" {\n    headingInt, _ := jsonparser.ParseInt(value)\n    n.ThisDataRaw.Heading = new(int)\n    *n.ThisDataRaw.Heading = int(headingInt)\n    return nil\n}\n\nif string(key) == \"speed\" {\n    speedInt, _ := jsonparser.ParseInt(value)\n    n.ThisDataRaw.Speed = new(int)\n    *n.ThisDataRaw.Speed = int(speedInt)\n    return nil\n}\n</code></pre>\n\n<p>Is it possible to get a little bit more dynamic so that I don't need to duplicate the code and for the example below have a single function at all?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 1, "creation_date": 1481276835, "post_id": 41057016, "comment_id": 69321519, "body": "Your structure will not match that JSON. In JSON you have array of arrays with array and string and in Go you have array of structures with array and string. On the second level there is a mismatch between array and structure."}, {"owner": {"reputation": 1536, "user_id": 588611, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f1ef7d612f498f57d5c1f6b82cf83d12?s=128&d=identicon&r=PG", "display_name": "Shulhi Sapli", "link": "https://stackoverflow.com/users/588611/shulhi-sapli"}, "reply_to_user": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 0, "creation_date": 1481277383, "post_id": 41057016, "comment_id": 69321850, "body": "@Grzegorz\u017bur I also tried <code>DescriptionMap [][]struct</code> to cater for that case but that won&#39;t work either"}, {"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 2, "creation_date": 1481278053, "post_id": 41057016, "comment_id": 69322283, "body": "I believe there is no easy way of directly unmarshalling an array of mixed types ([num,num], &quot;string&quot;). You&#39;ll have to write a custom unmarshaller -- <a href=\"http://eagain.net/articles/go-json-array-to-struct/\" rel=\"nofollow noreferrer\">eagain.net/articles/go-json-array-to-struct</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1536, "user_id": 588611, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f1ef7d612f498f57d5c1f6b82cf83d12?s=128&d=identicon&r=PG", "display_name": "Shulhi Sapli", "link": "https://stackoverflow.com/users/588611/shulhi-sapli"}, "edited": false, "score": 0, "creation_date": 1481286045, "post_id": 41057957, "comment_id": 69327010, "body": "Thanks. This works really well. Unfortunately, I can&#39;t do anything with the JSON schema, I&#39;m just consuming it."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 3, "last_activity_date": 1481278342, "creation_date": 1481278342, "answer_id": 41057957, "question_id": 41057016, "link": "https://stackoverflow.com/questions/41057016/go-parse-json-array-of-array/41057957#41057957", "title": "Go parse JSON array of array", "body": "<p>You have a very unfortunate JSON schema which treats arrays as objects. The best you can do in this situation is something like this:</p>\n\n<pre><code>type Body struct {\n    DescriptionMap []Description `json:\"descriptionMap\"`\n}\n\ntype Description struct {\n    IDPair      []int\n    Description string\n}\n\nfunc (d *Description) UnmarshalJSON(b []byte) error {\n    arr := []interface{}{}\n    err := json.Unmarshal(b, &amp;arr)\n    if err != nil {\n        return err\n    }\n\n    idPair := arr[0].([]interface{})\n    d.IDPair = make([]int, len(idPair))\n    for i := range idPair {\n        d.IDPair[i] = int(idPair[i].(float64))\n    }\n\n    d.Description = arr[1].(string)\n\n    return nil\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/MPho12GJfc\" rel=\"nofollow noreferrer\">https://play.golang.org/p/MPho12GJfc</a>.</p>\n\n<p>Notice though that this will panic if any of the types in the JSON don't match. You can create a better version which returns errors in such cases.</p>\n"}], "owner": {"reputation": 1536, "user_id": 588611, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f1ef7d612f498f57d5c1f6b82cf83d12?s=128&d=identicon&r=PG", "display_name": "Shulhi Sapli", "link": "https://stackoverflow.com/users/588611/shulhi-sapli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 682, "favorite_count": 0, "accepted_answer_id": 41057957, "answer_count": 1, "score": 3, "last_activity_date": 1481278342, "creation_date": 1481275479, "question_id": 41057016, "link": "https://stackoverflow.com/questions/41057016/go-parse-json-array-of-array", "title": "Go parse JSON array of array", "body": "<p>I have data like this</p>\n\n<pre><code>\"descriptionMap\": [[[1,2], \"a\"], [[3,4], \"b\"]]\n</code></pre>\n\n<p>and I was trying to decode it with</p>\n\n<pre><code>  DescriptionMap []struct {\n    OpcodeTableIdPair []int\n    OpcodeDescription string   \n  } `json:\"descriptionMap\"`\n</code></pre>\n\n<p>but I keep on getting empty arrays,</p>\n\n<pre><code>[[{[] } {[] }]]\n</code></pre>\n"}, {"tags": ["json", "go", "beego"], "comments": [{"owner": {"reputation": 24723, "user_id": 3150943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06074c6f020f2509f0b51a2c0ad3a9a8?s=128&d=identicon&r=PG", "display_name": "nu11p01n73R", "link": "https://stackoverflow.com/users/3150943/nu11p01n73r"}, "edited": false, "score": 0, "creation_date": 1481264765, "post_id": 41054288, "comment_id": 69315697, "body": "<code>brands[0] = Brand{&quot;Gucci&quot;}</code>"}, {"owner": {"reputation": 1462, "user_id": 4476788, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/100000129818719/picture?type=large", "display_name": "Muhamad Yulianto", "link": "https://stackoverflow.com/users/4476788/muhamad-yulianto"}, "reply_to_user": {"reputation": 24723, "user_id": 3150943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06074c6f020f2509f0b51a2c0ad3a9a8?s=128&d=identicon&r=PG", "display_name": "nu11p01n73R", "link": "https://stackoverflow.com/users/3150943/nu11p01n73r"}, "edited": false, "score": 0, "creation_date": 1481264882, "post_id": 41054288, "comment_id": 69315747, "body": "it will showing result with [] (square brackets), how to remove it? @nu11p01n73R"}, {"owner": {"reputation": 952, "user_id": 4555798, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/956224387724154/picture?type=large", "display_name": "oharlem", "link": "https://stackoverflow.com/users/4555798/oharlem"}, "edited": false, "score": 1, "creation_date": 1481265450, "post_id": 41054288, "comment_id": 69315967, "body": "@AlanEl-ninoMalmsteen, you see square brackets because it is a slice. What do you want to see instead?"}], "answers": [{"tags": [], "owner": {"reputation": 151, "user_id": 700973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rJ8fe.jpg?s=128&g=1", "display_name": "Marius", "link": "https://stackoverflow.com/users/700973/marius"}, "is_accepted": false, "score": 1, "last_activity_date": 1481265379, "creation_date": 1481265379, "answer_id": 41054444, "question_id": 41054288, "link": "https://stackoverflow.com/questions/41054288/dynamic-struct-with-result-object-in-go-language/41054444#41054444", "title": "Dynamic struct with result object in Go Language", "body": "<p>Line 22 should be: <code>brands = []Brand{Brand{\"Gucci\"}}</code></p>\n"}], "owner": {"reputation": 1462, "user_id": 4476788, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/100000129818719/picture?type=large", "display_name": "Muhamad Yulianto", "link": "https://stackoverflow.com/users/4476788/muhamad-yulianto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481265379, "creation_date": 1481264569, "last_edit_date": 1495540905, "question_id": 41054288, "link": "https://stackoverflow.com/questions/41054288/dynamic-struct-with-result-object-in-go-language", "title": "Dynamic struct with result object in Go Language", "body": "<p>I want to create result object json with dynamic structure of data, ex\nin func1 the result is like this\n</p>\n\n<pre><code>{\n  'result': 'this is result',\n  'content': {\n    'func1'  : 'value',\n    'some_desc_func1': 'value'\n  }\n}\n</code></pre>\n\n\n\n<p>and func2 maybe the result is <em>just</em> (focus on content) like this\n</p>\n\n<pre><code>{\n  'result': 'this is result',\n  'content': {\n    'func2'  : 'value'\n  }\n}\n</code></pre>\n\n\n\n<p>As this reference <a href=\"https://stackoverflow.com/a/35657622/4476788\">https://stackoverflow.com/a/35657622/4476788</a>, i want to show result json with just one key of result.</p>\n\n<p>Like this</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>{\r\n  'result': 'this is result',\r\n  'content': {\r\n    'key'  : 'value'\r\n  }\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>And not like this</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>[\r\n  {\r\n    'result_1' : 'answer 1'\r\n  },\r\n  {\r\n    'result_2' : 'answer 2'\r\n  }\r\n]</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>i try to update the play ground of the answer but it showing error</p>\n\n<pre><code>type Brand struct {\n   Name string\n}\n\nvar database map[string]interface{}\n\nfunc init() {\n  database = make(map[string]interface{})\n\n  brands := make([]Brand, 1)\n  brands = Brand{\"Gucci\"}\n\n  database[\"brands\"] = brands\n} \n</code></pre>\n\n<p>You can try run in here <a href=\"https://play.golang.org/p/mKCwKEVI7E\" rel=\"nofollow noreferrer\">https://play.golang.org/p/mKCwKEVI7E</a></p>\n\n<p>it showing error</p>\n\n<p><em>tmp/sandbox651609402/main.go:22: cannot use Brand literal (type Brand) as type []Brand in assignment</em></p>\n"}, {"tags": ["mysql", "linux", "go"], "answers": [{"comments": [{"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1481284825, "post_id": 41053940, "comment_id": 69326362, "body": "Technically valid but probably not appropriate, since this behavior causes MySQL to assume something is wrong with the connecting host and should cause warnings to be logged if <code>log_warnings</code> is set high enouhh.  By default, the server will start blocking you, which could be especially bad if you&#39;re testint through a load balancer: <a href=\"http://dev.mysql.com/doc/refman/5.7/en/blocked-host.html\" rel=\"nofollow noreferrer\">dev.mysql.com/doc/refman/5.7/en/blocked-host.html</a>"}, {"owner": {"reputation": 952, "user_id": 4555798, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/956224387724154/picture?type=large", "display_name": "oharlem", "link": "https://stackoverflow.com/users/4555798/oharlem"}, "reply_to_user": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1481296259, "post_id": 41053940, "comment_id": 69333761, "body": "There&#39;s some vagueness in the haroldT&#39;s question and anyways, you cannot be sure about state of connection with MySQL w/o actually running at least a simple query like &#39;SELECT 1&#39;. With all that in mind, and considering his phrase &quot;...to ping some linux machines...&quot; I assumed that his <i>only</i> concern is port being open on particular host. You have a good point about blocked-host! Would be great to understand if connection attempt to port 3306 would be considered by MySQL as a &quot;connection request&quot;? (continued below)"}, {"owner": {"reputation": 952, "user_id": 4555798, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/956224387724154/picture?type=large", "display_name": "oharlem", "link": "https://stackoverflow.com/users/4555798/oharlem"}, "reply_to_user": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1481296265, "post_id": 41053940, "comment_id": 69333764, "body": "(cont.) In my understanding, looking at the MySQL driver, to &quot;officially  connect&quot;, in addition to a dial, it also doing: authentication, checks max_allowed_packet, checks charset + smth else. So maybe, just pinging the port is not leading to Host &#39;host_name&#39; is blocked, because no &quot;connection requests&quot; actually happened. Thoughts?"}, {"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1481318249, "post_id": 41053940, "comment_id": 69345226, "body": "A TCP connection attempt with nothing sent, followed by closing the connection, is sufficient to increment the counter. Confirmed with test:  using the (old) default value of 10, <code>for n in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15; do (true | nc x.x.x.x 3306 | strings | egrep &#39;^5|blocked&#39;); done</code> results in <code>Host &#39;xxxxxxx&#39; is blocked because of many connection errors; unblock with &#39;mysqladmin flush-hosts&#39;</code> beginning with the 12th attempt (I&#39;m not sure why it isn&#39;t the 10th or 11th, but this behavior is repeatable)."}, {"owner": {"reputation": 952, "user_id": 4555798, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/956224387724154/picture?type=large", "display_name": "oharlem", "link": "https://stackoverflow.com/users/4555798/oharlem"}, "reply_to_user": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1481320003, "post_id": 41053940, "comment_id": 69345987, "body": "@Michael-sqlbot, great! Thank you for checking that."}, {"owner": {"reputation": 145, "user_id": 7004844, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/13debc3965e74232e3500042265051d3?s=128&d=identicon&r=PG&f=1", "display_name": "haroldT", "link": "https://stackoverflow.com/users/7004844/haroldt"}, "edited": false, "score": 0, "creation_date": 1484358104, "post_id": 41053940, "comment_id": 70491549, "body": "@mpmlj,Thank you for your help.If I want to use <code>for</code> to do that , so what your suggestions did not work.I want to use goroutine to make sure the connection status.what should I do?"}], "tags": [], "owner": {"reputation": 952, "user_id": 4555798, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/956224387724154/picture?type=large", "display_name": "oharlem", "link": "https://stackoverflow.com/users/4555798/oharlem"}, "is_accepted": false, "score": 2, "last_activity_date": 1481262794, "creation_date": 1481262794, "answer_id": 41053940, "question_id": 41053830, "link": "https://stackoverflow.com/questions/41053830/how-to-ping-remote-mysql-using-golang/41053940#41053940", "title": "How to ping remote mysql using golang", "body": "<p>If you just need to check connection to a specific host &amp; port, you can do this as:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net\"\n)\n\nconst (\n    host = \"192.168.2.1\"\n    port = \"3306\" // default MySQL port\n)\n\nfunc main() {\n\n    conn, err := net.Dial(\"tcp\", host+\":\"+port)\n    if err != nil {\n        panic(err)\n    }\n    defer conn.Close()\n\n    fmt.Printf(\"Connected to %s \\n\", conn.RemoteAddr().String())\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 145, "user_id": 7004844, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/13debc3965e74232e3500042265051d3?s=128&d=identicon&r=PG&f=1", "display_name": "haroldT", "link": "https://stackoverflow.com/users/7004844/haroldt"}, "edited": false, "score": 0, "creation_date": 1484358022, "post_id": 41054161, "comment_id": 70491535, "body": "Thank you for your help, but if I want to use db.ping() all day like <code>for {err = db.ping() iferr != nil {log.Fatalln(err)}}</code> . However ,It does not work when I poweroff some machine."}], "tags": [], "owner": {"reputation": 151, "user_id": 700973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rJ8fe.jpg?s=128&g=1", "display_name": "Marius", "link": "https://stackoverflow.com/users/700973/marius"}, "is_accepted": false, "score": 3, "last_activity_date": 1481263896, "creation_date": 1481263896, "answer_id": 41054161, "question_id": 41053830, "link": "https://stackoverflow.com/questions/41053830/how-to-ping-remote-mysql-using-golang/41054161#41054161", "title": "How to ping remote mysql using golang", "body": "<p>I assume you want to know if mysql is reachable or not. You can use following example:</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"flag\"\n    \"fmt\"\n    \"log\"\n\n    _ \"github.com/go-sql-driver/mysql\"\n)\n\nfunc main() {\n    var (\n        server = flag.String(\"mysql\", \"localhost:3306\", \"mysql server\")\n        user   = flag.String(\"user\", \"root\", \"mysql user\")\n        pass   = flag.String(\"password\", \"\", \"mysql password\")\n    )\n    flag.Parse()\n\n    db, err := sql.Open(\"mysql\", fmt.Sprintf(\"%s:%s@tcp(%s)/\", *user, *pass, *server))\n    if err != nil {\n        log.Fatalln(err)\n\n    }\n    defer db.Close()\n\n    err = db.Ping()\n\n    if err != nil {\n        log.Fatalln(err)\n\n    } else {\n        log.Println(\"mysqld is alive\")\n\n    }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 7004844, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/13debc3965e74232e3500042265051d3?s=128&d=identicon&r=PG&f=1", "display_name": "haroldT", "link": "https://stackoverflow.com/users/7004844/haroldt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1420, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1481263896, "creation_date": 1481262217, "question_id": 41053830, "link": "https://stackoverflow.com/questions/41053830/how-to-ping-remote-mysql-using-golang", "title": "How to ping remote mysql using golang", "body": "<p>I am using golang to ping some linux machines\u3002\nBut it is not work accurate\uff0cbecause it is always need almost 10 second to connet the remote mysql\u3002</p>\n\n<p>I use this command :</p>\n\n<blockquote>\n  <p>mysql -u USER -p PASSWORD -h REMOTE_IP</p>\n</blockquote>\n\n<p>So i want to know how to use linux command to know whether it open or not.</p>\n\n<p>Then I will use golang 's <code>exec.Command</code> to do that .</p>\n\n<p>Here is my <code>ping</code> code:</p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n    \"github.com/tatsushid/go-fastping\"\n    \"net\"\n    \"net/smtp\"\n    \"strings\"\n    \"time\"\n)\n\nfunc main(){\n    err := ping(\"192.168.2.1\")\n    if err != nil{\n        fmt.Println(\"WARNING!!!!!!\")\n    }\n}\nfunc ping(ip string) error {\n    p := fastping.NewPinger()\n    ra, err := net.ResolveIPAddr(\"ip\", ip)\n    if err != nil {\n        return err\n    }\n    p.AddIPAddr(ra)\n    found := false\n    p.OnRecv = func(addr *net.IPAddr, rtt time.Duration) {\n        found = true\n    }\n    err = p.Run()\n    if err != nil {\n        return err\n    }\n    if !found {\n        return errors.New(\"response error\")\n    }\n    return nil\n}\n</code></pre>\n"}, {"tags": ["go", "transactions", "redis", "pipelining"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1481285202, "post_id": 41053692, "comment_id": 69326539, "body": "What&#39;s wrong with using the <code>Watch</code> method? If you don&#39;t like the API, <code>redigo</code> is a another popular package."}], "answers": [{"tags": [], "owner": {"reputation": 12725, "user_id": 125913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69dc00171d2344fb0be796ddb7994541?s=128&d=identicon&r=PG", "display_name": "The Real Bill", "link": "https://stackoverflow.com/users/125913/the-real-bill"}, "is_accepted": false, "score": 4, "last_activity_date": 1481294126, "creation_date": 1481294126, "answer_id": 41062751, "question_id": 41053692, "link": "https://stackoverflow.com/questions/41053692/implementing-pipelining-and-transaction-both-to-a-redis-cluster-using-go-redis-p/41062751#41062751", "title": "Implementing pipelining and transaction both to a redis cluster using go-redis package without WATCH", "body": "<p>You will probably experience unhappy results with a combination of pipeline, transactions (MULTI/EXEC), and Cluster. In Redis Cluster you will be talking to multiple servers. This matters here because both pipelining and MULTI/EXEC are single-node oriented commands. </p>\n\n<p>Pipelining is essentially queueing up a bunch of commands and shipping them as a single network call to the server. If your commands need to go to different cluster nodes, that won't work as you can't use a single network send to send to multiple nodes.</p>\n\n<p>Similarly MULTI only exists within the node it was sent to, not cluster-wide. Thus, if your commands in the multi/exec access keys on different nodes, you will not have reliable transactions.</p>\n\n<p>How that manifests is unknown because it depends on the client library and any checks it makes such as how it handles a redirect during a transaction block.</p>\n\n<p>Ultimately, however, if you absolutely need pipelined multi/exec you will either need to ensure all keys are on one node by using Redis' \"hashtag\" method; use client-side code to check where all the keys are, raising an error if not on the same node while also hoping that a key doesn't been moved between the check and the command execution; or not use cluster. In the first two cases you will want to use <code>WATCH</code> to specify the keys to be used, thus giving you a chance at detecting a slot change as well as detecting different-node conditions.</p>\n"}], "owner": {"reputation": 1, "user_id": 7204674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fac10e44692f83ed52a29e3c463d1468?s=128&d=identicon&r=PG&f=1", "display_name": "PLSD", "link": "https://stackoverflow.com/users/7204674/plsd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2057, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481294126, "creation_date": 1481261442, "question_id": 41053692, "link": "https://stackoverflow.com/questions/41053692/implementing-pipelining-and-transaction-both-to-a-redis-cluster-using-go-redis-p", "title": "Implementing pipelining and transaction both to a redis cluster using go-redis package without WATCH", "body": "<p>My requirement is to implement pipelined transactions connecting to a redis cluster using go.I am using go-redis package which supports redis cluster,pipeling and transactions.How do I implement pipelined transactions without using WATCH key in go-redis package.\nI also looked at Tx.Pipeline() in the package.Is WATCH key necessary while implementing transaction</p>\n"}, {"tags": ["unit-testing", "go", "mocking"], "answers": [{"comments": [{"owner": {"reputation": 21161, "user_id": 1788806, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0ca4c6bc08e59c34de7fc39e09de8dbe?s=128&d=identicon&r=PG", "display_name": "Willi Mentzel", "link": "https://stackoverflow.com/users/1788806/willi-mentzel"}, "edited": false, "score": 0, "creation_date": 1600351060, "post_id": 41053354, "comment_id": 113065498, "body": "@sadlil can you pls update your answer to use <code>Car</code>, <code>CarFactory</code> etc.? OP hast unfortunately changed that after you posted your answer."}], "tags": [], "owner": {"reputation": 2527, "user_id": 3476121, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1c621706e2e37eed4f82f074af9f706a?s=128&d=identicon&r=PG", "display_name": "sadlil", "link": "https://stackoverflow.com/users/3476121/sadlil"}, "is_accepted": false, "score": 9, "last_activity_date": 1561121409, "last_edit_date": 1561121409, "creation_date": 1481259256, "answer_id": 41053354, "question_id": 41053280, "link": "https://stackoverflow.com/questions/41053280/how-to-write-mock-for-structs-in-go/41053354#41053354", "title": "How to write mock for structs in Go", "body": "<p>You use an interface.</p>\n\n<pre><code>type Employee interface {\n    GetHuman() Human\n}\n\ntype RealEmployee struct {\n    Company string\n    h Human\n}\n\nfunc (e RealEmployee) GetHuman() Human {\n    return e.h\n}\n\n// Call Hire with real employee\nHire(RealEmployee{h: RealHuman})\n</code></pre>\n\n<p><code>Hire</code> method accepts the interface <code>Employee</code>, then you can write one <code>MockEmployee</code> struct in your tests. </p>\n\n<pre><code>func Hire(e Employee) {\n    ...\n    h := e.GetHuman()\n    fmt.Println(h.Name)\n    ...\n}\n\n// Mock Employee instance\ntype MockEmployee struct {\n    Company string\n    h Human\n}\n\nfunc (m MockEmployee) GetHuman() Human {\n    return m.h\n}\n\n// Call Hire to test with mock employee\nHire(MockEmployee{h: MockHuman})\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 4754995, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hGx6GIURgog/AAAAAAAAAAI/AAAAAAAAAVA/ERBE_pk-VRo/photo.jpg?sz=128", "display_name": "chandan singh", "link": "https://stackoverflow.com/users/4754995/chandan-singh"}, "edited": false, "score": 0, "creation_date": 1618825396, "post_id": 41054865, "comment_id": 118710653, "body": "what if Run() method returning two or more values like Run()(string, error). Can we override Run()(string, error) method, so that we can add test cases for different scenario. Like :     type CarMock struct{ handleRun func() (string, error)} and in                                              func (cm CarMock) Run() { return cm.handleRun() }"}], "tags": [], "owner": {"reputation": 2850, "user_id": 2646539, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/O5bBC.jpg?s=128&g=1", "display_name": "thanhpk", "link": "https://stackoverflow.com/users/2646539/thanhpk"}, "is_accepted": true, "score": 22, "last_activity_date": 1600371757, "last_edit_date": 1600371757, "creation_date": 1481267119, "answer_id": 41054865, "question_id": 41053280, "link": "https://stackoverflow.com/questions/41053280/how-to-write-mock-for-structs-in-go/41054865#41054865", "title": "How to write mock for structs in Go", "body": "<p>It takes more code to mock a struct in Go than other OOP languages that support full late binding.</p>\n<p>This code must remain untouched since its taken from a 3rd party:</p>\n<pre><code>type Car struct {\n    Name string\n}\n\nfunc (c Car) Run() { \n    fmt.Println(&quot;Real car &quot; + c.Name + &quot; is running&quot;)\n}\n\ntype CarFactory struct {}\n\nfunc (cf CarFactory) MakeCar(name string) Car {\n    return Car{name}\n}\n</code></pre>\n<p>Since Go only supports late binding on interface, I had to make <code>Transport</code> receive an interface as a parameter instead of a struct:</p>\n<pre><code>type ICar interface {\n    Run()\n}\n\ntype ICarFactory interface {\n    MakeCar(name string) ICar\n}\n\nfunc Transport(cf ICarFactory) {\n    ...\n    car := cf.MakeCar(&quot;lamborghini&quot;)\n    car.Run()\n    ...\n}\n</code></pre>\n<p>And here are the mocks:</p>\n<pre><code>type CarMock struct {\n    Name string\n}\n\nfunc (cm CarMock) Run() {\n    fmt.Println(&quot;Mocking car &quot; + cm.Name + &quot; is running&quot;)\n}\n\ntype CarFactoryMock struct {}\nfunc (cf CarFactoryMock) MakeCar(name string) ICar {\n    return CarMock{name}\n}\n</code></pre>\n<p>Now I can easily use the mock <code>Transport(CarFactoryMock{})</code>. But when I try to call the real method <code>Transport(CarFactory{})</code>, the go compiler shows me the following errors:</p>\n<pre><code>cannot use CarFactory literal (type CarFactory) as type ICarFactory in argument to Transport:\n    CarFactory does not implement ICarFactory (wrong type for MakeCar method)\n        have MakeCar(string) Car\n        want MakeCar(string) ICar\n</code></pre>\n<p>As the message says, <code>MakeCar</code> function from the interface returns an <code>ICar</code>, but the real <code>MakeCar</code> returns a <code>Car</code>. Go doesn't allow that. To walk around this problem I had to define a wrapper to manually convert <code>Car</code> to <code>ICar</code>.</p>\n<pre><code>type CarFactoryWrapper struct {\n    CarFactory\n}\n\nfunc (cf CarFactoryWrapper) MakeCar(name string) ICar {\n    return cf.CarFactory.MakeCar(name)\n}\n</code></pre>\n<p>Now you can call the <code>Transport</code> function like this: <code>Transport(CarFactoryWrapper{CarFactory{}})</code>.</p>\n<p>Here is the working code <a href=\"https://play.golang.org/p/6YyeZP4tcC\" rel=\"nofollow noreferrer\">https://play.golang.org/p/6YyeZP4tcC</a>.</p>\n"}], "owner": {"reputation": 2850, "user_id": 2646539, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/O5bBC.jpg?s=128&g=1", "display_name": "thanhpk", "link": "https://stackoverflow.com/users/2646539/thanhpk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23051, "favorite_count": 6, "accepted_answer_id": 41054865, "answer_count": 2, "score": 24, "last_activity_date": 1600371757, "creation_date": 1481258755, "last_edit_date": 1578155315, "question_id": 41053280, "link": "https://stackoverflow.com/questions/41053280/how-to-write-mock-for-structs-in-go", "title": "How to write mock for structs in Go", "body": "<p>I want to write a unit test for the <code>Transport</code> function which will require mocking <code>CarFactory</code> and <code>Car</code> structs. See the following code:</p>\n\n<pre><code>package main\n\ntype Car struct {\n    Name string\n}\n\nfunc (h Car) Run() { ... }\n\ntype CarFactory struct {}\n\nfunc (e CarFactory) MakeCar() Car {\n    return Car{}\n}\n\nfunc Transport(cf CarFactory) {\n    ...\n    car := cf.MakeCar()\n    car.Run()\n    ...\n}\n</code></pre>\n\n<p>In other OOP languages like Java, C# or C++, I can just define <code>CarFactoryMock</code> and <code>CarMock</code> that extend <code>CarFactory</code> and <code>Car</code> then override <code>MakeCar()</code> method to return a <code>CarMock</code> object</p>\n\n<pre><code>class CarMock extends Car {\n    public Run() {...}\n}\n\nclass CarFactoryMock extends CarFactory {\n    public Car MakeCar() { return new CarMock(); }                                                                                                                                                                                        \n}\n\nTransport(new CarFactoryMock())\n</code></pre>\n\n<p>How do I achieve this in Go?</p>\n\n<p><strong>Note that I can change prototype and source code of <code>Transport</code> function, but must keep <code>CarFactory</code> and <code>Car</code> the same since they are taken from a 3rd package</strong></p>\n\n<hr>\n\n<p>The last code snippet was about Human and Employee, which lead to confusion`.</p>\n"}, {"tags": ["recursion", "go", "nested-loops"], "comments": [{"owner": {"reputation": 7745, "user_id": 3926995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2l63X.jpg?s=128&g=1", "display_name": "Chiheb Nexus", "link": "https://stackoverflow.com/users/3926995/chiheb-nexus"}, "edited": false, "score": 0, "creation_date": 1481259465, "post_id": 41053016, "comment_id": 69314012, "body": "What about using a generator within Python ?"}], "answers": [{"comments": [{"owner": {"reputation": 7745, "user_id": 3926995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2l63X.jpg?s=128&g=1", "display_name": "Chiheb Nexus", "link": "https://stackoverflow.com/users/3926995/chiheb-nexus"}, "edited": false, "score": 1, "creation_date": 1481263593, "post_id": 41053888, "comment_id": 69315274, "body": "Why there is a lot of empty spaces at the end ?"}, {"owner": {"reputation": 7745, "user_id": 3926995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2l63X.jpg?s=128&g=1", "display_name": "Chiheb Nexus", "link": "https://stackoverflow.com/users/3926995/chiheb-nexus"}, "edited": false, "score": 0, "creation_date": 1481263750, "post_id": 41053888, "comment_id": 69315330, "body": "If you want, look at the correct output <a href=\"https://repl.it/ElYx/0\" rel=\"nofollow noreferrer\">here</a> and try to improve your code."}, {"owner": {"reputation": 436, "user_id": 3244407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31a2e00b7474c0ed5d44482b8714bb99?s=128&d=identicon&r=PG&f=1", "display_name": "Ethan", "link": "https://stackoverflow.com/users/3244407/ethan"}, "reply_to_user": {"reputation": 7745, "user_id": 3926995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2l63X.jpg?s=128&g=1", "display_name": "Chiheb Nexus", "link": "https://stackoverflow.com/users/3926995/chiheb-nexus"}, "edited": false, "score": 1, "creation_date": 1481264324, "post_id": 41053888, "comment_id": 69315520, "body": "@nexus66 Found it. Was still going through it when <code>length = 0</code>"}, {"owner": {"reputation": 7745, "user_id": 3926995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2l63X.jpg?s=128&g=1", "display_name": "Chiheb Nexus", "link": "https://stackoverflow.com/users/3926995/chiheb-nexus"}, "edited": false, "score": 1, "creation_date": 1481264401, "post_id": 41053888, "comment_id": 69315540, "body": "Yes but still your output is reversed :-) try to give the same output like the OP wants to have."}, {"owner": {"reputation": 436, "user_id": 3244407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31a2e00b7474c0ed5d44482b8714bb99?s=128&d=identicon&r=PG&f=1", "display_name": "Ethan", "link": "https://stackoverflow.com/users/3244407/ethan"}, "reply_to_user": {"reputation": 7745, "user_id": 3926995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2l63X.jpg?s=128&g=1", "display_name": "Chiheb Nexus", "link": "https://stackoverflow.com/users/3926995/chiheb-nexus"}, "edited": false, "score": 1, "creation_date": 1481267282, "post_id": 41053888, "comment_id": 69316661, "body": "@nexus66 Added it as a separate method :D Sorry for the delay, had lunch."}], "tags": [], "owner": {"reputation": 436, "user_id": 3244407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31a2e00b7474c0ed5d44482b8714bb99?s=128&d=identicon&r=PG&f=1", "display_name": "Ethan", "link": "https://stackoverflow.com/users/3244407/ethan"}, "is_accepted": false, "score": 2, "last_activity_date": 1481268012, "last_edit_date": 1495542273, "creation_date": 1481262521, "answer_id": 41053888, "question_id": 41053016, "link": "https://stackoverflow.com/questions/41053016/recursive-implementation-of-a-nested-loop/41053888#41053888", "title": "Recursive implementation of a nested loop", "body": "<p>Here's my attempt of recursion: <a href=\"https://repl.it/ElYY/9\" rel=\"nofollow noreferrer\">https://repl.it/ElYY/9</a></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc reverse(str string, length int, i int) {\n  if len(str) &gt; length+i &amp;&amp; length &gt; 0 {\n    fmt.Println(str[i:length+i])\n    reverse(str, length, i+1)\n  } else if len(str) == length+i &amp;&amp; length &gt; 0 {\n    fmt.Println(str[i:length+i])\n    reverse(str, length-1, 0)\n  }\n}\n\nfunc recIterate(str string, length int, i int) {\n  if length &gt; i {\n    fmt.Println(str[i:len(str)-length+i+1])\n    recIterate(str, length, i+1)\n  } else if length == i &amp;&amp; length &gt; 0{\n    recIterate(str, length-1, 0)\n  }\n}\n\nfunc main() {\n  str := \"234051234\"\n  recIterate(str, len(str), 0)\n  // reverse(str, len(str), 0)\n}\n</code></pre>\n\n<p>Shout out to <a href=\"https://stackoverflow.com/users/3926995/nexus66\">nexus66</a> for helping~</p>\n"}], "owner": {"reputation": 21, "user_id": 7270829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be52789a3e8396f32c1cb4c3a9ff5ea?s=128&d=identicon&r=PG&f=1", "display_name": "Bermuda", "link": "https://stackoverflow.com/users/7270829/bermuda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1481279313, "creation_date": 1481257057, "question_id": 41053016, "link": "https://stackoverflow.com/questions/41053016/recursive-implementation-of-a-nested-loop", "title": "Recursive implementation of a nested loop", "body": "<p>I'm trying to generate incremental combinations from a string, like:</p>\n\n<pre><code>// for \"23405\"\n2\n3\n4\n5\n23\n34\n40\n05\n234\n340\n405\n2340\n3405\n23405\n</code></pre>\n\n<p>I'm doing it with nested loops:</p>\n\n<pre><code>str := \"23405\"\nfor i := 0; i &lt;= len(str); i++ {\n    for j := 0; j &lt;= i; j++ {\n        fmt.Println(str[j:i])\n    }\n}\n</code></pre>\n\n<p>Is it possible to do the same with recursive function? I'm writing it with go but an example in any language would be helpful. Here's the playground <a href=\"https://play.golang.org/p/xkOloSEWwO\" rel=\"nofollow noreferrer\">link</a>.</p>\n"}, {"tags": ["windows", "go", "bitcoin"], "comments": [{"owner": {"reputation": 871, "user_id": 3971840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047e6970f3add2393adbce3069847ba2?s=128&d=identicon&r=PG&f=1", "display_name": "Angelo Angeles", "link": "https://stackoverflow.com/users/3971840/angelo-angeles"}, "edited": false, "score": 2, "creation_date": 1481253153, "post_id": 41052489, "comment_id": 69312370, "body": "the question is why you set your  gopath in System32?"}, {"owner": {"reputation": 952, "user_id": 4555798, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/956224387724154/picture?type=large", "display_name": "oharlem", "link": "https://stackoverflow.com/users/4555798/oharlem"}, "edited": false, "score": 0, "creation_date": 1481253304, "post_id": 41052489, "comment_id": 69312410, "body": "You are looking for reciprocal imports in different packages. For example, in package &quot;packageA&quot; you have  import &quot;github.com/foo/packageB&quot;  and in package &quot;packageB&quot; you have import &quot;github.com/foo/packageA&quot;.  To solve need to see your code."}, {"owner": {"reputation": 21, "user_id": 7270696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/836f82f0461552d33e5fd88cde0d3103?s=128&d=identicon&r=PG&f=1", "display_name": "drewh784", "link": "https://stackoverflow.com/users/7270696/drewh784"}, "reply_to_user": {"reputation": 871, "user_id": 3971840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047e6970f3add2393adbce3069847ba2?s=128&d=identicon&r=PG&f=1", "display_name": "Angelo Angeles", "link": "https://stackoverflow.com/users/3971840/angelo-angeles"}, "edited": false, "score": 0, "creation_date": 1481256094, "post_id": 41052489, "comment_id": 69313074, "body": "@AngeloAngeles I was following a guide and just did as it said. Should it not go through System32?"}, {"owner": {"reputation": 871, "user_id": 3971840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047e6970f3add2393adbce3069847ba2?s=128&d=identicon&r=PG&f=1", "display_name": "Angelo Angeles", "link": "https://stackoverflow.com/users/3971840/angelo-angeles"}, "edited": false, "score": 0, "creation_date": 1481261053, "post_id": 41052489, "comment_id": 69314476, "body": "@drewh784 usually you want to put it in your user profile."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7270696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/836f82f0461552d33e5fd88cde0d3103?s=128&d=identicon&r=PG&f=1", "display_name": "drewh784", "link": "https://stackoverflow.com/users/7270696/drewh784"}, "edited": false, "score": 0, "creation_date": 1481255761, "post_id": 41052562, "comment_id": 69313011, "body": "those are the instructions which I was following, so I&#39;m still not sure what to do @Aminadav"}, {"owner": {"reputation": 16685, "user_id": 1229624, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33221e57892f65c519a16ff5cd30f874?s=128&d=identicon&r=PG", "display_name": "Aminadav Glickshtein", "link": "https://stackoverflow.com/users/1229624/aminadav-glickshtein"}, "reply_to_user": {"reputation": 21, "user_id": 7270696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/836f82f0461552d33e5fd88cde0d3103?s=128&d=identicon&r=PG&f=1", "display_name": "drewh784", "link": "https://stackoverflow.com/users/7270696/drewh784"}, "edited": false, "score": 0, "creation_date": 1481255808, "post_id": 41052562, "comment_id": 69313022, "body": "So please edit the question, so what you tried and the response. You don&#39;t need to use <code>go install</code> as you mention"}], "tags": [], "owner": {"reputation": 16685, "user_id": 1229624, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33221e57892f65c519a16ff5cd30f874?s=128&d=identicon&r=PG", "display_name": "Aminadav Glickshtein", "link": "https://stackoverflow.com/users/1229624/aminadav-glickshtein"}, "is_accepted": false, "score": 0, "last_activity_date": 1481253655, "creation_date": 1481253655, "answer_id": 41052562, "question_id": 41052489, "link": "https://stackoverflow.com/questions/41052489/no-matter-how-much-i-pour-over-my-code-i-cant-figure-out-how-to-rectify-my-imp/41052562#41052562", "title": "No matter how much I pour over my code, I can&#39;t figure out how to rectify my import cycle. (Golang)", "body": "<p>To install this repo, you don't need to use <code>get install</code> from the root directory of the project. Instead you should use <code>make geth</code></p>\n\n<p>For information how the installation process works you can read the Makefile of go-etherenum:</p>\n\n<ul>\n<li><a href=\"https://github.com/ethereum/go-ethereum/blob/master/Makefile\" rel=\"nofollow noreferrer\">https://github.com/ethereum/go-ethereum/blob/master/Makefile</a></li>\n</ul>\n\n<p>For details installation instuction for Mac/Linux/Windows follow this guide:</p>\n\n<ul>\n<li><a href=\"https://github.com/ethereum/go-ethereum/wiki/Building-Ethereum\" rel=\"nofollow noreferrer\">https://github.com/ethereum/go-ethereum/wiki/Building-Ethereum</a></li>\n</ul>\n"}], "owner": {"reputation": 21, "user_id": 7270696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/836f82f0461552d33e5fd88cde0d3103?s=128&d=identicon&r=PG&f=1", "display_name": "drewh784", "link": "https://stackoverflow.com/users/7270696/drewh784"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1481253655, "creation_date": 1481253019, "question_id": 41052489, "link": "https://stackoverflow.com/questions/41052489/no-matter-how-much-i-pour-over-my-code-i-cant-figure-out-how-to-rectify-my-imp", "title": "No matter how much I pour over my code, I can&#39;t figure out how to rectify my import cycle. (Golang)", "body": "<p>I've spent hours pouring over multiple threads looking for solutions but I'm struggling with even being able to identify the issue. I'm very,very new to Go, but I understand that it's not permitted to have import cycles, and I understand that means that package a is relying on package b and vise versa. Here is the output I am getting,</p>\n\n<pre><code>C:\\Windows\\System32\\src\\github.com\\ethereum\\go-ethereum&gt;go install -v\nimport cycle not allowed\npackage .\n    imports errors\n    imports runtime\n    imports runtime/internal/atomic\n    imports unsafe\n    imports runtime\nimport cycle not allowed\npackage .\n    imports github.com/ethereum/go-ethereum/core/types\n    imports github.com/ethereum/go-ethereum/core/vm\n    imports github.com/ethereum/go-ethereum/crypto\n    imports github.com/ethereum/go-ethereum/crypto/ecies\n    imports github.com/ethereum/go-ethereum/crypto/secp256k1\n    imports runtime/cgo\n    imports runtime/cgo\n</code></pre>\n\n<p>can someone PLEASE help me at least figure out what I'm looking for in order to fix it :/ </p>\n\n<p>Thanks all in advance</p>\n"}, {"tags": ["go", "revel"], "answers": [{"comments": [{"owner": {"reputation": 691, "user_id": 3304717, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/1NUML.jpg?s=128&g=1", "display_name": "Mohanrajan", "link": "https://stackoverflow.com/users/3304717/mohanrajan"}, "edited": false, "score": 0, "creation_date": 1481478277, "post_id": 41052481, "comment_id": 69383106, "body": "I made that issue. Added incorrect Environment variables."}], "tags": [], "owner": {"reputation": 952, "user_id": 4555798, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/956224387724154/picture?type=large", "display_name": "oharlem", "link": "https://stackoverflow.com/users/4555798/oharlem"}, "is_accepted": true, "score": 2, "last_activity_date": 1481252917, "creation_date": 1481252917, "answer_id": 41052481, "question_id": 41052390, "link": "https://stackoverflow.com/questions/41052390/golang-after-installed-revel-command-tool-not-working-properly/41052481#41052481", "title": "Golang : After installed revel command tool, not working properly", "body": "<ol>\n<li>Run: go get github.com/revel/revel</li>\n<li>Run: go get github.com/revel/cmd/revel</li>\n<li>Now revel should be available from any place. If not, make sure you have $GOPATH/bin set.</li>\n</ol>\n\n<p>P.S.\nIf have problems installing github.com/revel/cmd/revel, try removing completely github.com/revel, and re-installing both packages.</p>\n"}], "owner": {"reputation": 691, "user_id": 3304717, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/1NUML.jpg?s=128&g=1", "display_name": "Mohanrajan", "link": "https://stackoverflow.com/users/3304717/mohanrajan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 981, "favorite_count": 0, "accepted_answer_id": 41052481, "answer_count": 1, "score": 0, "last_activity_date": 1481252917, "creation_date": 1481252163, "question_id": 41052390, "link": "https://stackoverflow.com/questions/41052390/golang-after-installed-revel-command-tool-not-working-properly", "title": "Golang : After installed revel command tool, not working properly", "body": "<p><a href=\"https://i.stack.imgur.com/lSSgF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lSSgF.png\" alt=\"Tried in Git Bash\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/G6Q6T.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/G6Q6T.png\" alt=\"Tried in windows cmd\"></a></p>\n\n<p>Here I followed revel FW document and installed successfully. But try to use revel command in both Git bash and cmd, it is not working</p>\n\n<p>Please anyone give some suggestion for that...</p>\n"}]