[{"tags": ["google-app-engine", "go", "google-cloud-storage"], "comments": [{"owner": {"reputation": 696, "user_id": 189303, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/1417181e48148b2b441b46b0743d5ce4?s=128&d=identicon&r=PG", "display_name": "Etienne", "link": "https://stackoverflow.com/users/189303/etienne"}, "edited": false, "score": 0, "creation_date": 1425513781, "post_id": 28867408, "comment_id": 45999617, "body": "Just as an FYI, when uploading files larger than 10MB via the web interface, it uploads with no problems."}, {"owner": {"reputation": 696, "user_id": 189303, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/1417181e48148b2b441b46b0743d5ce4?s=128&d=identicon&r=PG", "display_name": "Etienne", "link": "https://stackoverflow.com/users/189303/etienne"}, "edited": false, "score": 0, "creation_date": 1425516011, "post_id": 28867408, "comment_id": 46000325, "body": "Ok, I added some error handling on wc.Close() and I get the following error: ERROR %!(EXTRA *url.Error=Post <a href=\"https://www.googleapis.com/upload/storage/v1/b/maxr-test/o?alt=json&amp;uploadType=multipart\" rel=\"nofollow noreferrer\">googleapis.com/upload/storage/v1/b/maxr-test/&hellip;</a>: Call error 5: )"}, {"owner": {"reputation": 696, "user_id": 189303, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/1417181e48148b2b441b46b0743d5ce4?s=128&d=identicon&r=PG", "display_name": "Etienne", "link": "https://stackoverflow.com/users/189303/etienne"}, "edited": false, "score": 0, "creation_date": 1425528900, "post_id": 28867408, "comment_id": 46003652, "body": "Hmm, I found this: <a href=\"https://cloud.google.com/appengine/docs/go/urlfetch/#Go_Quotas_and_limits\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/docs/go/urlfetch/&hellip;</a> ~ seems like there is indeed a 10MB limit.  What now?"}, {"owner": {"reputation": 3386, "user_id": 1668204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bc95f5cf4f7a5da0f8c3d9bd745ab45?s=128&d=identicon&r=PG", "display_name": "tx802", "link": "https://stackoverflow.com/users/1668204/tx802"}, "edited": false, "score": 0, "creation_date": 1425561653, "post_id": 28867408, "comment_id": 46019317, "body": "A couple of thoughts: (i) what happens if you try to get the object&#39;s metadata after the <code>Copy()</code> returns (<a href=\"http://godoc.org/google.golang.org/cloud/storage#Writer.Close\" rel=\"nofollow noreferrer\">godoc</a>)? And (ii), when you say the file is nowhere to be found, are you trying to <i>get</i> the object or <i>list</i> the bucket contents (see <a href=\"https://cloud.google.com/storage/docs/concepts-techniques#consistency\" rel=\"nofollow noreferrer\">consistency</a>)"}, {"owner": {"reputation": 696, "user_id": 189303, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/1417181e48148b2b441b46b0743d5ce4?s=128&d=identicon&r=PG", "display_name": "Etienne", "link": "https://stackoverflow.com/users/189303/etienne"}, "reply_to_user": {"reputation": 3386, "user_id": 1668204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bc95f5cf4f7a5da0f8c3d9bd745ab45?s=128&d=identicon&r=PG", "display_name": "tx802", "link": "https://stackoverflow.com/users/1668204/tx802"}, "edited": false, "score": 0, "creation_date": 1425577741, "post_id": 28867408, "comment_id": 46029893, "body": "Hi there, I updated the post to reflect more information and hopefully the answer to your first question."}], "answers": [{"tags": [], "owner": {"reputation": 601, "user_id": 1877121, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ICrJF.jpg?s=128&g=1", "display_name": "Khalid", "link": "https://stackoverflow.com/users/1877121/khalid"}, "is_accepted": false, "score": 0, "last_activity_date": 1426127602, "creation_date": 1426127602, "answer_id": 29000950, "question_id": 28867408, "link": "https://stackoverflow.com/questions/28867408/writing-files-to-google-app-engine-storage-with-go-seems-to-have-a-10mb-limit/29000950#29000950", "title": "Writing files to Google App Engine Storage with Go seems to have a 10MB limit?", "body": "<p>One of the solutions may be to use <a href=\"https://cloud.google.com/storage/docs/json_api/v1/libraries\" rel=\"nofollow\">Cloud Storage Java Client Library</a> to upload/write the file in Cloud Storage. The advantage of using that it automatically support resumable/chunk uploads so that you will not fall under that URL Fetch request size exceed error. Here is the <a href=\"https://cloud.google.com/storage/docs/json_api/v1/json-api-go-samples\" rel=\"nofollow\">Go example</a>. </p>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 1579801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3e09d7a34fb8463e95253bed3fe1eb?s=128&d=identicon&r=PG", "display_name": "sratatata", "link": "https://stackoverflow.com/users/1579801/sratatata"}, "is_accepted": false, "score": 0, "last_activity_date": 1453304534, "last_edit_date": 1453304534, "creation_date": 1453288724, "answer_id": 34898590, "question_id": 28867408, "link": "https://stackoverflow.com/questions/28867408/writing-files-to-google-app-engine-storage-with-go-seems-to-have-a-10mb-limit/34898590#34898590", "title": "Writing files to Google App Engine Storage with Go seems to have a 10MB limit?", "body": "<p>It's due to limit on Google Storage 10MB. \nIn my logs:</p>\n\n<pre><code>com.google.appengine.api.urlfetch.RequestPayloadTooLargeException: The request to https://www.googleapis.com/upload/storage/v1/b/XXXXXXXX exceeded the 10 MiB limit.\n</code></pre>\n\n<p>This is what I've found and I'm using  Java lib: (<code>com.google.api.services.storage.Storage</code>)</p>\n\n<p>Here I found example by <a href=\"https://github.com/google/google-api-java-client-samples/blob/master/storage-cmdline-sample/src/main/java/com/google/api/services/samples/storage/cmdline/StorageSample.java\" rel=\"nofollow\">google</a> however my team mate is still investigating this.</p>\n\n<p>Maybe that would help you. I would add my results when finished.</p>\n\n<p>Ok. Solved. \nMediaHttpUploader.DEFAULT_CHUNK_SIZE is around 10MB and this is already too much. Everything below 10MB would be accepted. </p>\n\n<pre><code>    Storage client = getService();\n    Storage.Objects.Insert insertRequest = client.objects().insert(\n            BUCKET_NAME, objectMetadata, contentStream);\n\n    //done by adding following two lines:\n    //  - chunk is set to &lt;10MB (~5MB in this case)\n    //  - directed upload is disabled.\n    insertRequest.getMediaHttpUploader().setChunkSize(MediaHttpUploader.DEFAULT_CHUNK_SIZE/2); //set to 5MB\n    insertRequest.getMediaHttpUploader().setDirectUploadEnabled(false);\n\n    final StorageObject storageObject = insertRequest.execute();\n</code></pre>\n\n<p>Maybe this would lead you by analogy to solution in your GO problem</p>\n\n<p>Cheers!</p>\n"}], "owner": {"reputation": 696, "user_id": 189303, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/1417181e48148b2b441b46b0743d5ce4?s=128&d=identicon&r=PG", "display_name": "Etienne", "link": "https://stackoverflow.com/users/189303/etienne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1020, "favorite_count": 2, "answer_count": 2, "score": 2, "last_activity_date": 1453304534, "creation_date": 1425513090, "last_edit_date": 1425577708, "question_id": 28867408, "link": "https://stackoverflow.com/questions/28867408/writing-files-to-google-app-engine-storage-with-go-seems-to-have-a-10mb-limit", "title": "Writing files to Google App Engine Storage with Go seems to have a 10MB limit?", "body": "<p>I am using <a href=\"http://godoc.org/google.golang.org/cloud/storage#Writer\" rel=\"nofollow\">http://godoc.org/google.golang.org/cloud/storage#Writer</a> to write files to GAE Storage. Using <code>io.Copy</code> returns successful results as long as the size of the file I am trying to copy is less than 10MB.  If the file is greater than 10MB, my <code>io.Copy</code> exits successfully with number of bytes written but the file is nowhere to be found in my bucket.</p>\n\n<p>I can't find any pointers in the docs so would appreciate some community feedback on how they're doing this.  Here is my code snippet:</p>\n\n<pre><code>func (s *GoogleStorage) StoreReader(r io.ReadCloser) error {\n  defer r.Close()\n\n  wc := storage.NewWriter(s.Context, s.Bucket, s.BackupName)\n  wc.ContentType = \"text/plain\"\n  wc.ACL = []storage.ACLRule{{storage.AllUsers, storage.RoleReader}}\n  defer wc.Close()\n\n  count, err := io.Copy(wc, r)\n  if err != nil {\n    s.app.Infof(\"Error doing copy:\", err)\n  }\n  s.app.Infof(\"Bytes written: %d\", count)\n  return err\n}\n</code></pre>\n\n<p>I updated the above code to return more information:</p>\n\n<pre><code>func (s *GoogleStorage) StoreReader(r io.ReadCloser) error {\n  defer r.Close()\n\n  wc := storage.NewWriter(s.Context, s.Bucket, s.BackupName)\n  wc.ContentType = \"text/plain\"\n  wc.ACL = []storage.ACLRule{{storage.AllUsers, storage.RoleReader}}\n\n  count, err := io.Copy(wc, r)\n  if err != nil {\n    s.app.Infof(\"Error doing copy:\", err)\n  }\n  if err := wc.Close(); err != nil {\n    s.app.Infof(\"ERROR \", err)\n  }\n  s.app.Infof(\"updated object:\", wc.Object())\n  s.app.Infof(\"Bytes written: %d\", count)\n  return err\n}\n</code></pre>\n\n<p>And this is the error I get after the <code>wc.Close()</code></p>\n\n<pre><code>    I 16:31:19.729 ERROR %!(EXTRA *url.Error=Post https://www.googleapis.com/upload/storage/v1/b/maxr-test/o?alt=json&amp;uploadType=multipart: Call error 5: )\nI 16:31:19.729 updated object:%!(EXTRA *storage.Object=&lt;nil&gt;)\n</code></pre>\n"}, {"tags": ["json", "struct", "go", "deserialization"], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1425507607, "post_id": 28866104, "comment_id": 45997281, "body": "The encoding/json package will unmarshal <code>lowercase</code> fields into <code>Uppercase</code> for you if there&#39;s no ambiguity, but it is better to not rely on that behavior."}, {"owner": {"reputation": 2431, "user_id": 232337, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3b17ed9811882a5db9f185cde695cf8d?s=128&d=identicon&r=PG&f=1", "display_name": "RockyMountainHigh", "link": "https://stackoverflow.com/users/232337/rockymountainhigh"}, "edited": false, "score": 0, "creation_date": 1425508022, "post_id": 28866104, "comment_id": 45997492, "body": "Fantastic! Makes perfect sense now. Thank you!"}], "tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": true, "score": 3, "last_activity_date": 1425507243, "creation_date": 1425507243, "answer_id": 28866104, "question_id": 28865899, "link": "https://stackoverflow.com/questions/28865899/not-able-to-deserialize-json-data-into-structs/28866104#28866104", "title": "Not able to deserialize json data into structs", "body": "<p>There are a few problems.  For starters you are trying to decode a school, but the data is schools, which has a member (an array) of school.</p>\n\n<p>Another issue is you have mismatched names.  <code>GsId</code> != <code>gsid</code> unless you tell Go about it by using struct tags.  </p>\n\n<p>Try decoding to a SchoolResponseData instead:</p>\n\n<pre><code>type SchoolResponseData struct {\n    Schools struct {\n        School []struct {\n            Address         string  `json:\"address\"`\n            City            string  `json:\"city\"`\n            Enrollment      float64 `json:\"enrollment\"`\n            Fax             string  `json:\"fax\"`\n            GradeRange      string  `json:\"gradeRange\"`\n            GsId            float64 `json:\"gsId\"`\n            Lat             float64 `json:\"lat\"`\n            Lon             float64 `json:\"lon\"`\n            Name            string  `json:\"name\"`\n            NcesId          string  `json:\"ncesId\"`\n            OverviewLink    string  `json:\"overviewLink\"`\n            ParentRating    float64 `json:\"parentRating\"`\n            Phone           string  `json:\"phone\"`\n            RatingsLink     string  `json:\"ratingsLink\"`\n            ReviewsLink     string  `json:\"reviewsLink\"`\n            SchoolStatsLink string  `json:\"schoolStatsLink\"`\n            State           string  `json:\"state\"`\n            Type            string  `json:\"type\"`\n            Website         string  `json:\"website\"`\n        } `json:\"school\"`\n    } `json:\"schools\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 2431, "user_id": 232337, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3b17ed9811882a5db9f185cde695cf8d?s=128&d=identicon&r=PG&f=1", "display_name": "RockyMountainHigh", "link": "https://stackoverflow.com/users/232337/rockymountainhigh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 28866104, "answer_count": 1, "score": 0, "last_activity_date": 1425507243, "creation_date": 1425506543, "question_id": 28865899, "link": "https://stackoverflow.com/questions/28865899/not-able-to-deserialize-json-data-into-structs", "title": "Not able to deserialize json data into structs", "body": "<p>I'm a newbie to go and trying to write a simple app to pull some school data from greatschools.org. The json data looks like this:</p>\n\n<pre>{\n    \"schools\": {\n        \"school\": [\n            {\n                \"gsId\": 1,\n                \"name\": \"Catholic School\",\n                \"type\": \"private\",\n                \"gradeRange\": \"PK-9\",\n                \"enrollment\": 39,\n                \"parentRating\": 4,\n                \"city\": \"Denver\",\n                \"state\": \"CO\",\n                \"address\": \"111 Main St., \\nDenver, CO  80100\",\n                \"phone\": \"(720) 555-1212\",\n                \"fax\": \"(720) 555-1212\",\n                \"website\": \"http://www.myschool.org\",\n                \"ncesId\": \"1234567\",\n                \"lat\": 30.519446,\n                \"lon\": -105.71314,\n                \"overviewLink\": \"http://www.greatschools.org/colorado/Denver/1-Catholic-School/?s_cid=gsapi\",\n                \"ratingsLink\": \"http://www.greatschools.org/school/rating.page?state=CO&id=1&s_cid=gsapi\",\n                \"reviewsLink\": \"http://www.greatschools.org/school/parentReviews.page?state=CO&id=1&s_cid=gsapi\",\n                \"schoolStatsLink\": \"http://www.greatschools.org/cgi-bin/CO/otherprivate/1\"\n            }...</pre>\n\n<p>My structs look like this:</p>\n\n<pre>\ntype SchoolStruct struct {\n    GsId            int\n    Name            string\n    SchoolType      string\n    GradeRange      string\n    Enrollment      int\n    ParentRating    int\n    City            string\n    State           string\n    Address         string\n    Phone           string\n    Fax             string\n    Website         string\n    NcesId          string\n    Lat             float64\n    Lon             float64\n    OverviewLink    string\n    RatingsLink     string\n    ReviewsLink     string\n    SchoolStatsLink string\n}\n\ntype SchoolsStruct struct {\n    Schools []SchoolStruct\n}</pre>\n\n<p>When I run my code I get \"json: cannot unmarshal object into Go value of type []main.SchoolStruct\"</p>\n\n<p>I'm using the <a href=\"https://github.com/bndr/gopencils\" rel=\"nofollow\">gopencils</a> library to make my requests and have used it successfully with very simple requests. Do you see what I might be doing wrong?</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4122236"}, "edited": false, "score": 2, "creation_date": 1425506308, "post_id": 28865383, "comment_id": 45996605, "body": "You must use <code>goapp</code> to build code that depends on the appengine packages. The standard <code>go</code> tool does not work."}], "answers": [{"comments": [{"owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1425506665, "post_id": 28865741, "comment_id": 45996789, "body": "I added the // +build appengine as you suggested but i got the same result"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1425507742, "post_id": 28865741, "comment_id": 45997357, "body": "@MIkCode like BeBop said, you have to use <code>goapp</code>"}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 0, "last_activity_date": 1425505941, "creation_date": 1425505941, "answer_id": 28865741, "question_id": 28865383, "link": "https://stackoverflow.com/questions/28865383/build-constraint-app-engine-golang/28865741#28865741", "title": "build constraint app engine golang", "body": "<p>You just need to use <code>-tags appengine</code>, and in the file that needs to just work on appengine you can start it with:</p>\n\n<pre><code>// +build appengine\n\npackage someName\n</code></pre>\n"}], "owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 805, "favorite_count": 0, "accepted_answer_id": 28865741, "answer_count": 1, "score": -1, "last_activity_date": 1425505941, "creation_date": 1425504620, "last_edit_date": 1495534197, "question_id": 28865383, "link": "https://stackoverflow.com/questions/28865383/build-constraint-app-engine-golang", "title": "build constraint app engine golang", "body": "<p>Im pretty new to go and to the the app engine ,</p>\n\n<p>I got this error <strong>cannot find package \"appengine\"</strong> .</p>\n\n<p>so i researched a little bit and i found out about  build constraint<br>\n<a href=\"https://stackoverflow.com/questions/19852395/cannot-find-package-appengine-cloudsql\">cannot find package &quot;appengine/cloudsql&quot;</a></p>\n\n<p>I tried to solve it by this commands .</p>\n\n<pre><code> go build  -v -tags  +build appengine\n</code></pre>\n\n<p>But i got the same  error <strong>package appengine: cannot find package \"appengine\"</strong> .</p>\n\n<p>I can run the  goapp server and deploy app to the app engine</p>\n\n<p>But i cant build or get the auto complete of the app engine library    </p>\n\n<p>thanks,</p>\n\n<p>miki</p>\n"}, {"tags": ["xml", "struct", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1425499217, "post_id": 28863473, "comment_id": 45992593, "body": "Your question is very confusing. Are you just asking how to print a <code>Link</code> struct as a string? Have you looked at the <code>fmt</code> package?"}, {"owner": {"reputation": 82, "user_id": 3632187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f0010c865b55fe305a51a4ea2767c422?s=128&d=identicon&r=PG&f=1", "display_name": "Shubham", "link": "https://stackoverflow.com/users/3632187/shubham"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1425499527, "post_id": 28863473, "comment_id": 45992769, "body": "I know how to print struct as string but I want to convert it so that I can append all of them in html variable to construct a view"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1425500525, "last_edit_date": 1425500525, "creation_date": 1425500186, "answer_id": 28864047, "question_id": 28863473, "link": "https://stackoverflow.com/questions/28863473/converting-go-struct-to-string/28864047#28864047", "title": "Converting Go struct to string", "body": "<p>In your case you don't want to append the <code>string</code> representation of the struct <code>Link</code>, you just need its <code>Href</code> field which is already of type <code>string</code>.</p>\n\n<pre><code>func (s Entry) LinkString() string {\n    return s.Link.Href\n}\n</code></pre>\n\n<p>Also note that if you use a non-pointer receiver <code>Entry</code>, your method <code>LinkString()</code> will receive a copy of the struct. Which in this case is not a problem, it's just a little slower because a copy has to be made.</p>\n\n<p>If your struct gets bigger, it's better to use pointer receiver: <code>*Entry</code>:</p>\n\n<pre><code>func (s *Entry) LinkString() string {\n    return s.Link.Href\n}\n</code></pre>\n\n<p>Also note that you don't even need a method to access the URL text because your fields (<code>Entry.Link</code> and <code>Link.Href</code>) are exported because they start with an upper-case letter, so you can simply refer to it like this:</p>\n\n<pre><code>// e is of type Entry:\nurl := e.Link.Href\n// url is of type string\n</code></pre>\n"}], "owner": {"reputation": 82, "user_id": 3632187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f0010c865b55fe305a51a4ea2767c422?s=128&d=identicon&r=PG&f=1", "display_name": "Shubham", "link": "https://stackoverflow.com/users/3632187/shubham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1816, "favorite_count": 0, "accepted_answer_id": 28864047, "answer_count": 1, "score": 2, "last_activity_date": 1425550772, "creation_date": 1425498290, "question_id": 28863473, "link": "https://stackoverflow.com/questions/28863473/converting-go-struct-to-string", "title": "Converting Go struct to string", "body": "<p>My Code :</p>\n\n<pre><code>type Link struct {\n    Href string `xml:\"href,attr\"`\n}\n\nvar html Link = \"\"\nfunc (s Entry) String() string {\n  links := string(s.Link)\n}\n</code></pre>\n\n<p>I parsed a whole XML document to get the links and text, Now I want to append all the parsed data in <code>html</code> variable to construct a nice view on the localhost. But <code>s.Link</code> can't be converted to string data type maybe because type conversion only supports basic data-types , Any Solutions ?</p>\n\n<p>Live demo : <a href=\"http://play.golang.org/p/7HRHusXLe2\" rel=\"nofollow\">http://play.golang.org/p/7HRHusXLe2</a></p>\n"}, {"tags": ["json", "dictionary", "types", "go"], "answers": [{"comments": [{"owner": {"reputation": 1897, "user_id": 473368, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e24aa1cfabf417ef8833ea8721a66a8?s=128&d=identicon&r=PG", "display_name": "01AutoMonkey", "link": "https://stackoverflow.com/users/473368/01automonkey"}, "edited": false, "score": 0, "creation_date": 1425489933, "post_id": 28860080, "comment_id": 45987216, "body": "I want a dictionary yes but it must support multiple levels of hierarchy or parent - child, that is this supports only one level or <code>{&quot;key1&quot;: &quot;val1&quot;, &quot;key2&quot;: &quot;val2&quot;}</code> but I also need to support arbitrary number of levels, like <code>{&quot;key1&quot;: {&quot;c1key1&quot;: &quot;c1val1&quot;}}</code> or <code>{&quot;key1&quot;: {&quot;c1key1&quot;: {&quot;c2key1: &quot;c2val1&quot;}}}</code>."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1897, "user_id": 473368, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e24aa1cfabf417ef8833ea8721a66a8?s=128&d=identicon&r=PG", "display_name": "01AutoMonkey", "link": "https://stackoverflow.com/users/473368/01automonkey"}, "edited": false, "score": 0, "creation_date": 1425490434, "post_id": 28860080, "comment_id": 45987541, "body": "@01AutoMonkey This <b>does</b> support multi-level maps, in unlimited depth. I edited my answer to include an inner map."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 28, "last_activity_date": 1425491626, "last_edit_date": 1425491626, "creation_date": 1425487594, "answer_id": 28860080, "question_id": 28859941, "link": "https://stackoverflow.com/questions/28859941/whats-the-golang-equivalent-of-converting-any-json-to-standard-dict-in-python/28860080#28860080", "title": "What&#39;s the golang equivalent of converting any JSON to standard dict in Python?", "body": "<p>If you want a dictionary, use the Go type <code>map[string]interface{}</code> (which is a <code>map</code> with <code>string</code> keys and values of any type):</p>\n\n<pre><code>var data map[string]interface{}\n</code></pre>\n\n<p>And then you can refer to its elements like:</p>\n\n<pre><code>data[\"entities\"]\n</code></pre>\n\n<p>See this example:</p>\n\n<pre><code>s := `{\"text\":\"I'm a text.\",\"number\":1234,\"floats\":[1.1,2.2,3.3],\n    \"innermap\":{\"foo\":1,\"bar\":2}}`\n\nvar data map[string]interface{}\nerr := json.Unmarshal([]byte(s), &amp;data)\nif err != nil {\n    panic(err)\n}\n\nfmt.Println(\"text =\", data[\"text\"])\nfmt.Println(\"number =\", data[\"number\"])\nfmt.Println(\"floats =\", data[\"floats\"])\nfmt.Println(\"innermap =\", data[\"innermap\"])\n\ninnermap, ok := data[\"innermap\"].(map[string]interface{})\nif !ok {\n    panic(\"inner map is not a map!\")\n}\nfmt.Println(\"innermap.foo =\", innermap[\"foo\"])\nfmt.Println(\"innermap.bar =\", innermap[\"bar\"])\n\nfmt.Println(\"The whole map:\", data)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>text = I'm a text.\nnumber = 1234\nfloats = [1.1 2.2 3.3]\ninnermap = map[foo:1 bar:2]\ninnermap.foo = 1\ninnermap.bar = 2\nThe whole map: map[text:I'm a text. number:1234 floats:[1.1 2.2 3.3]\n    innermap:map[foo:1 bar:2]]\n</code></pre>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/LVH5G3FM04\" rel=\"noreferrer\">Go Playground</a>.</p>\n\n<p><strong>Notes:</strong></p>\n\n<p>Basically if your map is multi-level (the <code>map</code> contains another <code>map</code>) like the <code>\"innermap\"</code> in the above example, when you access the inner map, you can use <a href=\"http://golang.org/ref/spec#Type_assertions\" rel=\"noreferrer\">Type assertion</a> to have it as another map:</p>\n\n<pre><code>innermap, ok := data[\"innermap\"].(map[string]interface{})\n// If ok, innermap is of type map[string]interface{}\n// and you can refer to its elements.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 0, "last_activity_date": 1609455237, "creation_date": 1609455237, "answer_id": 65526116, "question_id": 28859941, "link": "https://stackoverflow.com/questions/28859941/whats-the-golang-equivalent-of-converting-any-json-to-standard-dict-in-python/65526116#65526116", "title": "What&#39;s the golang equivalent of converting any JSON to standard dict in Python?", "body": "<p>I prefer to add a type declaration, that way you can add methods to simplify the\ntype assertions:</p>\n<pre><code>package main\n\nimport (\n   &quot;encoding/json&quot;\n   &quot;log&quot;\n   &quot;net/http&quot;\n   &quot;net/url&quot;\n)\n\ntype Map map[string]interface{}\n\nfunc (m Map) M(s string) Map {\n   return m[s].(map[string]interface{})\n}\n\nfunc (m Map) N(s string) float64 {\n   return m[s].(float64)\n}\n\nfunc main() {\n   v := url.Values{}\n   v.Set(&quot;action&quot;, &quot;wbgetentities&quot;)\n   v.Set(&quot;format&quot;, &quot;json&quot;)\n   v.Set(&quot;ids&quot;, &quot;Q24871&quot;)\n   resp, e := http.Get(&quot;https://www.wikidata.org/w/api.php?&quot; + v.Encode())\n   if e != nil {\n      log.Fatal(e)\n   }\n   data := Map{}\n   json.NewDecoder(resp.Body).Decode(&amp;data)\n   pageid := data.M(&quot;entities&quot;).M(&quot;Q24871&quot;).N(&quot;pageid&quot;)\n   println(pageid == 28268)\n}\n</code></pre>\n<p><a href=\"https://golang.org/ref/spec#Type_declarations\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Type_declarations</a></p>\n"}], "owner": {"reputation": 1897, "user_id": 473368, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e24aa1cfabf417ef8833ea8721a66a8?s=128&d=identicon&r=PG", "display_name": "01AutoMonkey", "link": "https://stackoverflow.com/users/473368/01automonkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12667, "favorite_count": 3, "accepted_answer_id": 28860080, "answer_count": 2, "score": 10, "last_activity_date": 1609455237, "creation_date": 1425487181, "last_edit_date": 1425491307, "question_id": 28859941, "link": "https://stackoverflow.com/questions/28859941/whats-the-golang-equivalent-of-converting-any-json-to-standard-dict-in-python", "title": "What&#39;s the golang equivalent of converting any JSON to standard dict in Python?", "body": "<p>In Python you can do something like this:</p>\n\n<pre><code>r = requests.get(\"http://wikidata.org/w/api.php\", params=params)\ndata = r.json()\n</code></pre>\n\n<p>And now <code>data</code> is a dict or hash table (also, I did not need to define beforehand the structure of the dict), and I can access values of keys by doing data[\"entities\"], data[\"entities\"][\"Q12\"], etc.</p>\n\n<p>How would I do this in golang? So far I have this:</p>\n\n<pre><code>resp, err := http.Get(\"http://wikidata.org/w/api.php?\"+v.Encode())\nif err != nil {\n    // handle error\n}\n\ndefer resp.Body.Close()\ndecoder := json.NewDecoder(resp.Body)\nvar data interface{}\ndecodeErr := decoder.Decode(&amp;data)\nif decodeErr != nil {\n    // handle error\n}\nfmt.Println(data[\"entities\"], data[\"entities\"][\"Q\"+id])\n</code></pre>\n\n<p>Which gives me the compile error: <code>invalid operation: data[\"entities\"] (index of type interface {})</code></p>\n\n<p>So what type should <code>var data</code> be? And do I need to define a structure to the JSON beforehand or is it possible to handle any JSON file/stream without modifying the code?</p>\n"}, {"tags": ["multithreading", "go", "webserver", "mutex"], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1425585204, "post_id": 28861574, "comment_id": 46034253, "body": "Or, instead of a mutex use a single goroutine in a loop that reads from a channel telling it when to modify the file and, if necessary, a channel to respond with new values/error. If you know the file isn&#39;t supposed to be modified outside of your program then you can avoid re-reading the file all time."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1425586062, "post_id": 28861574, "comment_id": 46034721, "body": "while true, when protecting a single resource from multiple access, a Mutex or a RWMutex is still often the simplest choice. Yes, the file handling could be improved (outside the scope of this question), but I&#39;ll usually prefer these 3 lines of code over multiple channels, selects, and a goroutine."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 8, "last_activity_date": 1425491989, "creation_date": 1425491989, "answer_id": 28861574, "question_id": 28859619, "link": "https://stackoverflow.com/questions/28859619/how-to-make-reading-and-writing-to-file-concurent-in-golang/28861574#28861574", "title": "How to make reading and writing to file concurent in Golang?", "body": "<p>You can't make the reading and writing of a file concurrent (well, it's possible, but not with the access pattern you're describing). Use a single mutex to serialize all access to your file:</p>\n\n<pre><code>var fileMutex sync.Mutex\n\nfunc DoSomething() {\n    fileMutex.Lock()\n    defer fileMutex.Unlock()\n\n    //...\n}\n</code></pre>\n"}], "owner": {"reputation": 869, "user_id": 2620356, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d70e7de8674154dc8b6a5dde5d5c75?s=128&d=identicon&r=PG", "display_name": "kingSlayer", "link": "https://stackoverflow.com/users/2620356/kingslayer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5705, "favorite_count": 5, "answer_count": 1, "score": 2, "last_activity_date": 1425567912, "creation_date": 1425486336, "last_edit_date": 1425567912, "question_id": 28859619, "link": "https://stackoverflow.com/questions/28859619/how-to-make-reading-and-writing-to-file-concurent-in-golang", "title": "How to make reading and writing to file concurent in Golang?", "body": "<p>I setup a webserver and I use my own package where I do some write/read from and to files. When the server gets a tcp connection, I start a different goroutine to handle the request for each connection. In the request handler func, I call the <code>func DoSomething()</code> of some_package.</p>\n\n<p>Here's the code for web_server.go:</p>\n\n<pre><code> package main\n import (\n    sp \"./some_package\"\n    \"log\"\n    \"net\"\n    \"os\"\n    \"net/http\"\n   )\n\nfunc main() {\n\n  l, err := net.Listen(\"tcp\", \"0.0.0.0\" + \":\" + \"4567\")\n  if err != nil {\n    log.Println(\"Error listening:\", err.Error())\n    os.Exit(1)\n  }\n  defer l.Close()\n  log.Println(\"Listening on 0.0.0.0:4567\")  \n  go func() {\n    for {\n        // Listen for an incoming connection.\n        conn, err := l.Accept()\n        if err != nil {\n            log.Println(\"Error accepting: \", err.Error())\n            os.Exit(1)\n        }\n        // Handle connections in a new goroutine.\n        go handlerFunction(conn)\n    }\n  }()\n\n  log.Printf(\"Setting up the Webserver...\")\n  err = http.ListenAndServe(\"0.0.0.0:\"+\"4568\", nil)\n  if err != nil {\n    log.Fatal(err)\n  }\n}\n\nfunc handlerFunction(conn net.Conn) {\n  defer conn.Close()\n  sp.DoSomething()\n}\n</code></pre>\n\n<p>The function <code>DoSomething()</code> reads and writes to file. You can see the code where it is declared in the package:</p>\n\n<pre><code>package some_package\nimport (    \n    \"io/ioutil\"\n    \"strconv\"\n    \"os\"\n    \"log\"\n   )\nfunc IncrementValue(pastValue string)(newValue string){\n  newValueInt, _ := strconv.Atoi(pastValue)\n  return strconv.Itoa(newValueInt + 1)\n}\n\nfunc DoSomething() (err error){\n  initialValue := \"1\"\n  filename := \"myFile.txt\"\n  if _, err := os.Stat(filename); err == nil {\n    someText, err := ioutil.ReadFile(filename)\n    if err != nil {\n        log.Printf(\"Error reading\")\n        return err\n    }\n    newValue := IncrementValue(string(someText))\n\n    err = ioutil.WriteFile(filename,[]byte(newValue), 0644)\n    if err != nil { \n        return err\n    }\n  }else{\n    err = ioutil.WriteFile(filename,[]byte(initialValue), 0644)\n    if err != nil { \n        return err\n    }\n  }\n  return\n }\n</code></pre>\n\n<p>How can I use a locking mechanism like <code>mutex.Lock</code> and <code>mutex.Unlock</code> in this case to make the reading and writing to file concurrent so when one routine which is currently writing can stop the other from reading till the first one writes to file successfully?</p>\n\n<p>Is my example suitable to be concurrent when reading or writing to file?</p>\n\n<p>Is this the right approach to do so? Thank You</p>\n"}, {"tags": ["xml", "go"], "answers": [{"comments": [{"owner": {"reputation": 82, "user_id": 3632187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f0010c865b55fe305a51a4ea2767c422?s=128&d=identicon&r=PG&f=1", "display_name": "Shubham", "link": "https://stackoverflow.com/users/3632187/shubham"}, "edited": false, "score": 0, "creation_date": 1425485429, "post_id": 28858260, "comment_id": 45984164, "body": "Hey thanks it worked I am newbie to golang would you recommend some sources to learn more ?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 82, "user_id": 3632187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f0010c865b55fe305a51a4ea2767c422?s=128&d=identicon&r=PG&f=1", "display_name": "Shubham", "link": "https://stackoverflow.com/users/3632187/shubham"}, "edited": false, "score": 0, "creation_date": 1425485522, "post_id": 28858260, "comment_id": 45984234, "body": "@Shubham For XML parsing and generating check out the package documentation of the <a href=\"http://golang.org/pkg/encoding/xml/\" rel=\"nofollow noreferrer\"><code>xml</code></a> package. For everything else Go, <a href=\"http://golang.org/\" rel=\"nofollow noreferrer\">golang.org</a> is the main source. For nice readings, check out its <a href=\"http://blog.golang.org/\" rel=\"nofollow noreferrer\">Blog</a> page."}, {"owner": {"reputation": 82, "user_id": 3632187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f0010c865b55fe305a51a4ea2767c422?s=128&d=identicon&r=PG&f=1", "display_name": "Shubham", "link": "https://stackoverflow.com/users/3632187/shubham"}, "edited": false, "score": 0, "creation_date": 1425485731, "post_id": 28858260, "comment_id": 45984389, "body": "Thank&#39;s I will take note of it."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1425482838, "creation_date": 1425482838, "answer_id": 28858260, "question_id": 28857837, "link": "https://stackoverflow.com/questions/28857837/golang-google-alert-xml-parse/28858260#28858260", "title": "Golang Google alert XML parse", "body": "<p>You're close. Your code doesn't extract the link URL because it is not the value of the element <code>&lt;link&gt;</code> but it is the value of its <em>attribute</em> <code>\"href\"</code>.</p>\n\n<p>You can extract the value of the attribute with the following code:</p>\n\n<pre><code>type Link struct {\n    Href string `xml:\"href,attr\"`\n}\n</code></pre>\n\n<p>And your modified <code>Entry</code> type:</p>\n\n<pre><code>type Entry struct {\n    XMLName xml.Name `xml:\"entry\"`\n    Link    Link     `xml:\"link\"`\n    Title   string   `xml:\"title\"`\n}\n</code></pre>\n\n<p>Try your modified app on the <a href=\"http://play.golang.org/p/7HRHusXLe2\" rel=\"nofollow\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 82, "user_id": 3632187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f0010c865b55fe305a51a4ea2767c422?s=128&d=identicon&r=PG&f=1", "display_name": "Shubham", "link": "https://stackoverflow.com/users/3632187/shubham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 1, "accepted_answer_id": 28858260, "answer_count": 1, "score": 1, "last_activity_date": 1425482838, "creation_date": 1425481733, "question_id": 28857837, "link": "https://stackoverflow.com/questions/28857837/golang-google-alert-xml-parse", "title": "Golang Google alert XML parse", "body": "<p>My XML data :</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;feed \n    xmlns=\"http://www.w3.org/2005/Atom\" \n    xmlns:idx=\"urn:atom-extension:indexing\"&gt;\n\n    &lt;entry&gt;\n        &lt;title type=\"html\"&gt;Some Title&lt;/title&gt;\n        &lt;link href=\"https://www.google.com\"&gt;&lt;/link&gt;\n    &lt;/entry&gt;\n&lt;/feed&gt;\n</code></pre>\n\n<p>I want to parse Each <code>&lt;entry&gt;</code> with its <code>&lt;title&gt;</code>&amp; <code>&lt;link&gt;</code> tag so far I have successfully parsed the title but no success with <code>&lt;link&gt;</code>.</p>\n\n<p>My Code :</p>\n\n<pre><code>type Entry struct {\n    XMLName xml.Name `xml:\"entry\"`\n    Link    string   `xml:\"link\"`\n    Title   string   `xml:\"title\"`\n}\n\ntype Feed struct {\n    XMLName xml.Name `xml:\"feed\"`\n    Entries []Entry  `xml:\"entry\"`\n}\n\nfunc (s Entry) String() string {\n    return fmt.Sprintf(\"\\t Link : %s - Title : %s \\n\", s.Link, s.Title)\n}\n</code></pre>\n\n<p>Live demo at <a href=\"http://play.golang.org/p/hteQ5RuMco\" rel=\"nofollow\">http://play.golang.org/p/hteQ5RuMco</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 3, "creation_date": 1425481567, "post_id": 28857741, "comment_id": 45981441, "body": "Have you tried doing it without <code>sudo</code>?"}, {"owner": {"reputation": 2445, "user_id": 1505341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XpLu.jpg?s=128&g=1", "display_name": "Kerem", "link": "https://stackoverflow.com/users/1505341/kerem"}, "edited": false, "score": 0, "creation_date": 1462228128, "post_id": 28857741, "comment_id": 61539399, "body": "My problem was <a href=\"http://stackoverflow.com/a/26197363/1505341\">missing xcode licence agreement action</a> after a clean install."}], "answers": [{"comments": [{"owner": {"reputation": 1663, "user_id": 2949840, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b5ea45d4d574deb29d47020a14e1ab21?s=128&d=identicon&r=PG&f=1", "display_name": "WildCat", "link": "https://stackoverflow.com/users/2949840/wildcat"}, "edited": false, "score": 0, "creation_date": 1425481832, "post_id": 28857808, "comment_id": 45981605, "body": "<code>go install golang.org&#47;x&#47;tools&#47;cmd&#47;cover: open &#47;usr&#47;local&#47;go&#47;pkg&#47;tool&#47;darwin_amd64&#47;cover: permission denied</code> How can I execute commands like this?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1663, "user_id": 2949840, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b5ea45d4d574deb29d47020a14e1ab21?s=128&d=identicon&r=PG&f=1", "display_name": "WildCat", "link": "https://stackoverflow.com/users/2949840/wildcat"}, "edited": false, "score": 0, "creation_date": 1425481948, "post_id": 28857808, "comment_id": 45981691, "body": "@WildCat: <code>cmd&#47;cover</code> is an exception to the rule. You can use sudo, or on osx I prefer to make my go installing writable by my local user account."}, {"owner": {"reputation": 3065, "user_id": 3425138, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/a3oSD.png?s=128&g=1", "display_name": "Ashish Karpe", "link": "https://stackoverflow.com/users/3425138/ashish-karpe"}, "edited": false, "score": 0, "creation_date": 1530516841, "post_id": 28857808, "comment_id": 89246835, "body": "# go get -u github.com/golang/lint/golint  ...... I ran this no error but still golint command not found"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 3065, "user_id": 3425138, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/a3oSD.png?s=128&g=1", "display_name": "Ashish Karpe", "link": "https://stackoverflow.com/users/3425138/ashish-karpe"}, "edited": false, "score": 1, "creation_date": 1530517805, "post_id": 28857808, "comment_id": 89247298, "body": "@AshishKarpe Maybe because <code>$GOPATH&#47;bin</code> is not in your <code>$PATH</code>?"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 8, "last_activity_date": 1425482114, "last_edit_date": 1495541822, "creation_date": 1425481638, "answer_id": 28857808, "question_id": 28857741, "link": "https://stackoverflow.com/questions/28857741/i-have-set-my-gopath-but-it-doesnt-work/28857808#28857808", "title": "I have set my $GOPATH, but it doesn&#39;t work", "body": "<p>The issue is that you are using <code>sudo</code>: it will use the root environment variable instead of the ones of your account.</p>\n\n<p>You shouldn't need to use <code>sudo</code>, as I mentioned in \"<a href=\"https://stackoverflow.com/a/28741724/6309\">How to set GOPATH in Mac OS X 10.10</a>\":</p>\n\n<ul>\n<li><code>sudo</code> has a default policy of resetting the Environment and setting a secure path</li>\n<li>unless you use the more complex <code>sudo -E bash -c 'go get github.com/golang/lint/golint'</code>):</li>\n</ul>\n\n<p>For now, this should be enough:</p>\n\n<pre><code>go get -u github.com/golang/lint/golint\n</code></pre>\n\n<hr>\n\n<p>The OP adds a <em>different</em> <code>go get</code> command in the comments:</p>\n\n<pre><code>go install golang.org/x/tools/cmd/cover: \n  open /usr/local/go/pkg/tool/darwin_amd64/cover: permission denied \n</code></pre>\n\n<p>That one would be using <code>$GOTOOLDIR</code> (set in your case to \"/usr/local/go/pkg/tool/darwin_amd64\")</p>\n\n<p>As documented in \"<a href=\"https://stackoverflow.com/a/27273294/6309\">Permission denied error for 'go.tools'</a>\", running <code>sudo -s</code> then the <code>go get</code> command should work.</p>\n"}, {"tags": [], "owner": {"reputation": 1172, "user_id": 504262, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/73f854ddc54795abe5bd0fe1e914ed7e?s=128&d=identicon&r=PG", "display_name": "satran", "link": "https://stackoverflow.com/users/504262/satran"}, "is_accepted": false, "score": 1, "last_activity_date": 1425481736, "creation_date": 1425481736, "answer_id": 28857838, "question_id": 28857741, "link": "https://stackoverflow.com/questions/28857741/i-have-set-my-gopath-but-it-doesnt-work/28857838#28857838", "title": "I have set my $GOPATH, but it doesn&#39;t work", "body": "<p>sudo according to man:</p>\n\n<blockquote>\n  <p>sudo allows a permitted user to execute a command as the superuser or\n       another user, as specified by the security policy.</p>\n</blockquote>\n\n<p>When using <code>sudo</code> you are executing as root. I would suggest that you remove sudo and try executing it.</p>\n"}], "owner": {"reputation": 1663, "user_id": 2949840, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b5ea45d4d574deb29d47020a14e1ab21?s=128&d=identicon&r=PG&f=1", "display_name": "WildCat", "link": "https://stackoverflow.com/users/2949840/wildcat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6601, "favorite_count": 2, "accepted_answer_id": 28857808, "answer_count": 2, "score": 2, "last_activity_date": 1425482198, "creation_date": 1425481394, "last_edit_date": 1425482198, "question_id": 28857741, "link": "https://stackoverflow.com/questions/28857741/i-have-set-my-gopath-but-it-doesnt-work", "title": "I have set my $GOPATH, but it doesn&#39;t work", "body": "<pre><code>$ sudo go get -u github.com/golang/lint/golint\npackage github.com/golang/lint/golint: cannot download, $GOPATH not set. For more details see: go help gopath\n</code></pre>\n\n<p>I have set my $GOPATH:\n(in <code>~/.bash_profile</code> on my Mac)\nexport GOPATH=$HOME/gocode</p>\n\n<p>And my <code>go env</code>: </p>\n\n<pre><code>$ go env\nGOARCH=\"amd64\"\nGOBIN=\"\"\nGOCHAR=\"6\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"darwin\"\nGOOS=\"darwin\"\nGOPATH=\"/Users/wildcat/gocode\"\nGORACE=\"\"\nGOROOT=\"/usr/local/go\"\nGOTOOLDIR=\"/usr/local/go/pkg/tool/darwin_amd64\"\nCC=\"gcc\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0 -fno-common\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\n</code></pre>\n\n<p>What's the problem?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 711, "user_id": 494091, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2d741a1c3addcea457cceb7c1faee4ab?s=128&d=identicon&r=PG", "display_name": "Humble Learner", "link": "https://stackoverflow.com/users/494091/humble-learner"}, "edited": false, "score": 0, "creation_date": 1425481690, "post_id": 28857315, "comment_id": 45981507, "body": "Thanks! If we don&#39;t close quit then walkers will outlive the Same and eventually be terminated as soon as Main exits. Correct?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 711, "user_id": 494091, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2d741a1c3addcea457cceb7c1faee4ab?s=128&d=identicon&r=PG", "display_name": "Humble Learner", "link": "https://stackoverflow.com/users/494091/humble-learner"}, "edited": false, "score": 0, "creation_date": 1425481857, "post_id": 28857315, "comment_id": 45981626, "body": "@HumbleLearner yes, everything stops when <code>Main()</code> exits."}, {"owner": {"reputation": 711, "user_id": 494091, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2d741a1c3addcea457cceb7c1faee4ab?s=128&d=identicon&r=PG", "display_name": "Humble Learner", "link": "https://stackoverflow.com/users/494091/humble-learner"}, "edited": false, "score": 0, "creation_date": 1425482270, "post_id": 28857315, "comment_id": 45981925, "body": "BTW, isn&#39;t this incorrect - &quot;w1, w2 := Walk(t1, quit), Walk(t2, quit)&quot;. Not using go routines?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 711, "user_id": 494091, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2d741a1c3addcea457cceb7c1faee4ab?s=128&d=identicon&r=PG", "display_name": "Humble Learner", "link": "https://stackoverflow.com/users/494091/humble-learner"}, "edited": false, "score": 0, "creation_date": 1425482398, "post_id": 28857315, "comment_id": 45982017, "body": "@HumbleLearner the <code>Walk()</code> function (<a href=\"http://talks.golang.org/2014/go4gophers.slide#36\" rel=\"nofollow noreferrer\">talks.golang.org/2014/go4gophers.slide#36</a>) triggers a goroutine, and returns immediatly a channel. So no, it doesn&#39;t look incorrect. It is non-blocking, and return the mean to listen to the walk results."}, {"owner": {"reputation": 711, "user_id": 494091, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2d741a1c3addcea457cceb7c1faee4ab?s=128&d=identicon&r=PG", "display_name": "Humble Learner", "link": "https://stackoverflow.com/users/494091/humble-learner"}, "edited": false, "score": 0, "creation_date": 1425482606, "post_id": 28857315, "comment_id": 45982173, "body": "Yes, you&#39;re right. I got confused Walk with walk (from above). I just saw the slide."}, {"owner": {"reputation": 711, "user_id": 494091, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2d741a1c3addcea457cceb7c1faee4ab?s=128&d=identicon&r=PG", "display_name": "Humble Learner", "link": "https://stackoverflow.com/users/494091/humble-learner"}, "edited": false, "score": 0, "creation_date": 1425566999, "post_id": 28857315, "comment_id": 46022659, "body": "Why Println doesn&#39;t work in &#39;quit&#39; case? What can I do to make it work?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 711, "user_id": 494091, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2d741a1c3addcea457cceb7c1faee4ab?s=128&d=identicon&r=PG", "display_name": "Humble Learner", "link": "https://stackoverflow.com/users/494091/humble-learner"}, "edited": false, "score": 0, "creation_date": 1425567479, "post_id": 28857315, "comment_id": 46023007, "body": "@HumbleLearner which <code>Println</code>?"}, {"owner": {"reputation": 711, "user_id": 494091, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2d741a1c3addcea457cceb7c1faee4ab?s=128&d=identicon&r=PG", "display_name": "Humble Learner", "link": "https://stackoverflow.com/users/494091/humble-learner"}, "edited": false, "score": 0, "creation_date": 1425567628, "post_id": 28857315, "comment_id": 46023119, "body": "If I do something like &#39;fmt.Println(&quot;here&quot;)&#39; just after &#39;case &lt;-quit&#39;, it never prints it. Sorry, this might be a stupid question but still trying to get my head around these channels."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 711, "user_id": 494091, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2d741a1c3addcea457cceb7c1faee4ab?s=128&d=identicon&r=PG", "display_name": "Humble Learner", "link": "https://stackoverflow.com/users/494091/humble-learner"}, "edited": false, "score": 0, "creation_date": 1425567772, "post_id": 28857315, "comment_id": 46023217, "body": "@HumbleLearner that might be a case where the <code>Stdout</code> isn&#39;t flush quickly enough before <code>Main()</code> exit. Could you try the same Print on <code>Stderr</code> to check if you see its output? <code>fmt.Fprintf(os.Stderr, &quot;Test\\n&quot;)</code>"}, {"owner": {"reputation": 711, "user_id": 494091, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2d741a1c3addcea457cceb7c1faee4ab?s=128&d=identicon&r=PG", "display_name": "Humble Learner", "link": "https://stackoverflow.com/users/494091/humble-learner"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1425568001, "post_id": 28857315, "comment_id": 46023379, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/72347/discussion-between-humble-learner-and-vonc\">continue this discussion in chat</a>."}, {"owner": {"reputation": 711, "user_id": 494091, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2d741a1c3addcea457cceb7c1faee4ab?s=128&d=identicon&r=PG", "display_name": "Humble Learner", "link": "https://stackoverflow.com/users/494091/humble-learner"}, "edited": false, "score": 0, "creation_date": 1425651133, "post_id": 28857315, "comment_id": 46060353, "body": "For fellows like me, don&#39;t get confused with &#39;quit&#39; case. I&#39;ve created a simple program explaining the concept - <a href=\"http://play.golang.org/p/0bSFfdJkxd\" rel=\"nofollow noreferrer\">play.golang.org/p/0bSFfdJkxd</a>. Thanks @VonC for helping me out."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 711, "user_id": 494091, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2d741a1c3addcea457cceb7c1faee4ab?s=128&d=identicon&r=PG", "display_name": "Humble Learner", "link": "https://stackoverflow.com/users/494091/humble-learner"}, "edited": false, "score": 0, "creation_date": 1425652342, "post_id": 28857315, "comment_id": 46061099, "body": "@HumbleLearner Sure. Your example does show the main purpose of the quit channel as mentioned in <a href=\"http://talks.golang.org/2014/go4gophers.slide#36\" rel=\"nofollow noreferrer\">talks.golang.org/2014/go4gophers.slide#36</a>: &quot;so we can stop it mid-stride&quot;. Good one."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 2, "last_activity_date": 1425480214, "creation_date": 1425480214, "answer_id": 28857315, "question_id": 28857190, "link": "https://stackoverflow.com/questions/28857190/what-is-the-purpose-of-quit-channel-in-binarytrees-quit-go-in-go-tour-solutions/28857315#28857315", "title": "What is the purpose of quit channel in binarytrees_quit.go in go-tour solutions?", "body": "<p>You can see that approached detailed in \"<a href=\"http://talks.golang.org/2014/go4gophers.slide#36\" rel=\"nofollow\">Go for gophers - GopherCon closing keynote - 25 April 2014 - Andrew Gerrand </a>\"</p>\n\n<blockquote>\n  <p>Stopping early<br>\n  Add a <code>quit</code> channel to the walker so we can stop it mid-stride.</p>\n</blockquote>\n\n<pre><code>func walk(t *tree.Tree, ch chan int, quit chan struct{}) {\n    if t.Left != nil {\n        walk(t.Left, ch, quit)\n    }\n    select {\n    case ch &lt;- t.Value:\n    // vvvvvvvvvvvv\n    case &lt;-quit:\n        return\n    }\n    // ^^^^^^^^^^^^\n    if t.Right != nil {\n        walk(t.Right, ch, quit)\n    }\n}\n</code></pre>\n\n<blockquote>\n  <p>Create a quit channel and pass it to each walker.<br>\n  <strong>By closing <code>quit</code> when the <code>Same</code> exits, any running walkers are terminated</strong>. </p>\n</blockquote>\n\n<pre><code>func Same(t1, t2 *tree.Tree) bool {\n    // vvvvvvvvvvvv\n    quit := make(chan struct{})\n    defer close(quit)\n    w1, w2 := Walk(t1, quit), Walk(t2, quit)\n    // ^^^^^^^^^^^^\n    for {\n        v1, ok1 := &lt;-w1\n        v2, ok2 := &lt;-w2\n        if v1 != v2 || ok1 != ok2 {\n            return false\n        }\n        if !ok1 {\n            return true\n        }\n    }\n}\n</code></pre>\n\n<p>Andrew adds:</p>\n\n<blockquote>\n  <p>Why not just kill the goroutines?</p>\n  \n  <p>Goroutines are invisible to Go code. They can't be killed or waited on.<br>\n  You have to build that yourself.</p>\n  \n  <p>There's a reason:</p>\n  \n  <p><strong>As soon as Go code knows in which thread it runs you get thread-locality.<br>\n  Thread-locality defeats the concurrency model</strong>.</p>\n  \n  <ul>\n  <li>Channels are just values; they fit right into the type system.</li>\n  <li>Goroutines are invisible to Go code; this gives you concurrency anywhere.</li>\n  </ul>\n  \n  <p>Less is more. </p>\n</blockquote>\n"}], "owner": {"reputation": 711, "user_id": 494091, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2d741a1c3addcea457cceb7c1faee4ab?s=128&d=identicon&r=PG", "display_name": "Humble Learner", "link": "https://stackoverflow.com/users/494091/humble-learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 1, "accepted_answer_id": 28857315, "answer_count": 1, "score": 1, "last_activity_date": 1425480214, "creation_date": 1425479900, "question_id": 28857190, "link": "https://stackoverflow.com/questions/28857190/what-is-the-purpose-of-quit-channel-in-binarytrees-quit-go-in-go-tour-solutions", "title": "What is the purpose of quit channel in binarytrees_quit.go in go-tour solutions?", "body": "<p>I don't quite understand the purpose of quit channel variable in binarytrees_quit.go. Or, am I missing the important point here. I can understand that receiver can send value to quit to tell the go routine to return or exit. But I don't think that it's the case here. Is it just to make sure that Walk routines stick around till Same finishes the execution? Won't go routine stick around just because channels are not buffered. Even if this is the case, that does not make any sense. Please help me to understand.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1425483214, "post_id": 28857123, "comment_id": 45982600, "body": "It may look strange, but are you certain this is actually a problem? Most json decoders should handle that correctly."}, {"owner": {"reputation": 602, "user_id": 1154200, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ca722d97bf250f7abcb87a05d63ac6c3?s=128&d=identicon&r=PG", "display_name": "seenickcode", "link": "https://stackoverflow.com/users/1154200/seenickcode"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1425484275, "post_id": 28857123, "comment_id": 45983330, "body": "Well it&#39;s not a problem per se, it becomes a problem when one needs to keep certain characters intact when sending smth over the wire."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1425484670, "post_id": 28857123, "comment_id": 45983625, "body": "What I&#39;m saying is that this is correct json, and the json decoder on the other end of the wire should unescape those characters correctly. If not, you need to replace the characters manually after encoding; <code>bytes.Replace</code> would be the fastest way."}, {"owner": {"reputation": 602, "user_id": 1154200, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ca722d97bf250f7abcb87a05d63ac6c3?s=128&d=identicon&r=PG", "display_name": "seenickcode", "link": "https://stackoverflow.com/users/1154200/seenickcode"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1425485354, "post_id": 28857123, "comment_id": 45984099, "body": "Thanks for clarifying. You&#39;re right.  I just realized after posting other characters are getting encoded to unicode as well and those are indeed working.  Cheers."}], "answers": [{"tags": [], "owner": {"reputation": 602, "user_id": 1154200, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ca722d97bf250f7abcb87a05d63ac6c3?s=128&d=identicon&r=PG", "display_name": "seenickcode", "link": "https://stackoverflow.com/users/1154200/seenickcode"}, "is_accepted": true, "score": 2, "last_activity_date": 1425485392, "creation_date": 1425485392, "answer_id": 28859251, "question_id": 28857123, "link": "https://stackoverflow.com/questions/28857123/prevent-gos-json-marshal-from-coercing-string-to-valid-utf-8-unicode/28859251#28859251", "title": "Prevent Go&#39;s json.Marshal from coercing string to valid UTF-8 unicode?", "body": "<p>I just realized after posting other characters are getting encoded to unicode as well and those are indeed working.</p>\n"}, {"tags": [], "owner": {"reputation": 2573, "user_id": 209962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d85d44a0eca045f40e5a31449277c26c?s=128&d=identicon&r=PG", "display_name": "Ben Marini", "link": "https://stackoverflow.com/users/209962/ben-marini"}, "is_accepted": false, "score": 0, "last_activity_date": 1521502107, "creation_date": 1521502107, "answer_id": 49374018, "question_id": 28857123, "link": "https://stackoverflow.com/questions/28857123/prevent-gos-json-marshal-from-coercing-string-to-valid-utf-8-unicode/49374018#49374018", "title": "Prevent Go&#39;s json.Marshal from coercing string to valid UTF-8 unicode?", "body": "<p>You can choose not to encode if you wish:\n<a href=\"https://golang.org/pkg/encoding/json/#Encoder.SetEscapeHTML\" rel=\"nofollow noreferrer\">https://golang.org/pkg/encoding/json/#Encoder.SetEscapeHTML</a></p>\n\n<p><a href=\"https://play.golang.org/p/gfy1WaDrEIH\" rel=\"nofollow noreferrer\">https://play.golang.org/p/gfy1WaDrEIH</a></p>\n"}], "owner": {"reputation": 602, "user_id": 1154200, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ca722d97bf250f7abcb87a05d63ac6c3?s=128&d=identicon&r=PG", "display_name": "seenickcode", "link": "https://stackoverflow.com/users/1154200/seenickcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4113, "favorite_count": 1, "accepted_answer_id": 28859251, "answer_count": 2, "score": 7, "last_activity_date": 1521502107, "creation_date": 1425479703, "question_id": 28857123, "link": "https://stackoverflow.com/questions/28857123/prevent-gos-json-marshal-from-coercing-string-to-valid-utf-8-unicode", "title": "Prevent Go&#39;s json.Marshal from coercing string to valid UTF-8 unicode?", "body": "<p>I'm trying to POST some JSON to a server using Go where special characters like ampersand must exist intact in the JSON string I'm sending.</p>\n\n<p><a href=\"http://play.golang.org/p/bPt9kl88-y\" rel=\"noreferrer\">http://play.golang.org/p/bPt9kl88-y</a> </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n)\n\nfunc main() {\n\n    type TransactionStatement struct {\n        Query      string                 \n    }\n\n    statement := &amp;TransactionStatement{\n        Query:       \"my query with this &amp; that\",\n    }\n    data, _ := json.Marshal(statement)\n\n    fmt.Printf(\"&gt; %v\", string(data))\n}\n</code></pre>\n\n<p>Go's <a href=\"http://golang.org/pkg/encoding/json/#Marshal\" rel=\"noreferrer\">json.Marshal</a> is converting certain characters like '&amp;' to unicode.  Which is great:</p>\n\n<blockquote>\n  <p>String values encode as JSON strings coerced to valid UTF-8, replacing invalid bytes with the Unicode replacement rune. The angle brackets \"&lt;\" and \">\" are escaped to \"\\u003c\" and \"\\u003e\" to keep some browsers from misinterpreting JSON output as HTML. Ampersand \"&amp;\" is also escaped to \"\\u0026\" for the same reason. \n  Blockquote</p>\n</blockquote>\n\n<p>It may sound rediculous but the JSON I'm sending is for a database query using a RESTful endpoint, where this literal string will be used to perform a freetext database query - so I can't use unicode since it's interpreted literally. </p>\n\n<p>So is there any way to prevent this conversion to unicode? Or will I just have to undo these replacements <em>after</em> the marshaling is done?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["json", "postgresql", "go"], "comments": [{"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1425470764, "post_id": 28853714, "comment_id": 45974174, "body": "Is the problem in unmarshaling the time, or in storing it in postgres (what client?)"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1425472834, "post_id": 28853714, "comment_id": 45975525, "body": "Is this the direction you need? this answer is about converting times to json, but the principal is the same: <a href=\"http://stackoverflow.com/questions/23695479/format-timestamp-in-outgoing-json-in-golang\" title=\"format timestamp in outgoing json in golang\">stackoverflow.com/questions/23695479/&hellip;</a>"}, {"owner": {"reputation": 28971, "user_id": 1499698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad28bf1565b1191c0591bf90d46299a7?s=128&d=identicon&r=PG", "display_name": "pozs", "link": "https://stackoverflow.com/users/1499698/pozs"}, "edited": false, "score": 0, "creation_date": 1425477354, "post_id": 28853714, "comment_id": 45978498, "body": "<i>Note</i> that PostgreSQL does not actually <i>store</i> the time zone offset in that field/type. Instead, it will be taken into account, when input/output occurs (inputs normalized to UTC ((-ish, actually to UT1)) and outputs <code>timestamptz</code> values according to the current set <a href=\"http://www.postgresql.org/docs/current/static/sql-set.html\" rel=\"nofollow noreferrer\"><code>TimeZone</code> setting</a>)."}], "answers": [{"tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": false, "score": 1, "last_activity_date": 1425480994, "creation_date": 1425480994, "answer_id": 28857588, "question_id": 28853714, "link": "https://stackoverflow.com/questions/28853714/data-type-for-storing-date-time-offset-in-golang/28857588#28857588", "title": "Data type for storing date time offset in golang", "body": "<p>The <code>time.Time</code> struct is aware of the timezone, and should be properly handled by most of the SQL drivers available.</p>\n\n<p>The only thing to add is that the convention in most systems is to use only UTC dates in exchange formats (JSON, SQL, etc) and let the application shift to timezone when necessary.</p>\n"}], "owner": {"reputation": 95, "user_id": 4540462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14bf078b1e197e17779e63518d2c3fc4?s=128&d=identicon&r=PG&f=1", "display_name": "Aishwarya Gopalakrishnan", "link": "https://stackoverflow.com/users/4540462/aishwarya-gopalakrishnan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3197, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1425480994, "creation_date": 1425469777, "question_id": 28853714, "link": "https://stackoverflow.com/questions/28853714/data-type-for-storing-date-time-offset-in-golang", "title": "Data type for storing date time offset in golang", "body": "<p>I am using go language to develop an application . In my program i receive a JSON data which contains an entity in date time offset format for example <strong>DateTime\": \"2014-10-19T23:08:24Z\"</strong> I need to unmarshal the JSON and store it in the database in the <strong>TIMESTAMP(p) WITH TIME ZONE</strong> format in POSTGRESQL database .When i unmarshal i need to store this in a variable of the same data type . Is there a data type available in golang to do this or any other means of doing this ??? </p>\n"}, {"tags": ["c", "go"], "answers": [{"comments": [{"owner": {"reputation": 1446, "user_id": 1947066, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gR6Eb.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/1947066/tom"}, "edited": false, "score": 1, "creation_date": 1425463674, "post_id": 28851264, "comment_id": 45970159, "body": "A of course! What a fool, thank you! I should have known that :P I think I was getting confused as go doesn&#39;t require you to deference the pointer when you use it like (*object).function or object-&gt;function in C, so I thought taking the address there would be the address of the pointer, not the pointer itself. Thanks!"}, {"owner": {"reputation": 1446, "user_id": 1947066, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gR6Eb.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/1947066/tom"}, "edited": false, "score": 1, "creation_date": 1425471701, "post_id": 28851264, "comment_id": 45974826, "body": "A small addendum to this, and I think why I was initially getting confused. if you create a custom type (type MyType struct { }) and use that instead of int, when you use Println, you get &#39;&amp;{}&#39; output, not the address. For a custom object do you know how to get the address to print?"}], "tags": [], "owner": {"reputation": 21711, "user_id": 418729, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Vm1jt.jpg?s=128&g=1", "display_name": "Sadique", "link": "https://stackoverflow.com/users/418729/sadique"}, "is_accepted": true, "score": 7, "last_activity_date": 1425463033, "last_edit_date": 1425463033, "creation_date": 1425462651, "answer_id": 28851264, "question_id": 28851190, "link": "https://stackoverflow.com/questions/28851190/golang-return-object-from-a-function/28851264#28851264", "title": "golang return object from a function", "body": "<p>You are printing the address of the pointer here <code>fmt.Println(&amp;i);</code>. Try this:</p>\n\n<pre><code>func main() {\n    i := createPointerToInt();\n    fmt.Println(i); //--&gt; Remove the ampersand\n}\n</code></pre>\n\n<p><code>i</code> is the pointer returned from <code>createPointerToInt</code> - while <code>&amp;i</code> is the address of the pointer you are trying to print. Note in your C sample you are printing it correctly:</p>\n\n<pre><code>printf(\"%#08x\\n\", r);\n                 ^No ampersand here\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1446, "user_id": 1947066, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gR6Eb.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/1947066/tom"}, "edited": false, "score": 0, "creation_date": 1425473908, "post_id": 28851329, "comment_id": 45976155, "body": "Hi there, small update to this and one of the reasons why I think I&#39;d tried to use the ampersands in the wrong place is when using a custom object (<code>type Example struct {}</code>) using <code>fmt.Println</code> produces <code>&amp;{}</code> not a memory address. Is there a way to force <code>fmt.Println</code> to convert that to a memory address?"}], "tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": false, "score": 2, "last_activity_date": 1425462838, "creation_date": 1425462838, "answer_id": 28851329, "question_id": 28851190, "link": "https://stackoverflow.com/questions/28851190/golang-return-object-from-a-function/28851329#28851329", "title": "golang return object from a function", "body": "<p>Change <code>&amp;i</code> to <code>i</code>. You are printing address of i while you should print the value of i.</p>\n\n<pre><code>func createPointerToInt() *int {\n     i := new(int)\n     fmt.Println(i);\n     return i;\n}\n\nfunc main() {\n    i := createPointerToInt();\n    fmt.Println(i);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1446, "user_id": 1947066, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gR6Eb.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/1947066/tom"}, "edited": false, "score": 0, "creation_date": 1425540571, "post_id": 28869270, "comment_id": 46007387, "body": "In the original code the first block was the function and the second was main calling that function. The address being returned was that of the local variable pointer in each case, not the address to the region in memory the pointer was referring to. The reason I made this mistake in the first place is in the online golang tool, when you use a custom type (one you create) and use that in place of int in the example, <code>&amp;{}</code> is printed to the console, not an address, which seemed kind of odd, and I&#39;m not sure how to force an address to print"}, {"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "reply_to_user": {"reputation": 1446, "user_id": 1947066, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gR6Eb.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/1947066/tom"}, "edited": false, "score": 0, "creation_date": 1425565388, "post_id": 28869270, "comment_id": 46021615, "body": "Yes, yes, I was actually talking about the addresses of the two pointers in the original example. Maybe it is too obvious for most people, but it had me confused at first."}, {"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "reply_to_user": {"reputation": 1446, "user_id": 1947066, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gR6Eb.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/1947066/tom"}, "edited": false, "score": 0, "creation_date": 1425567008, "post_id": 28869270, "comment_id": 46022669, "body": "@Tom, You need to use <code>printf</code> to print address of a <code>struct</code>, I updated my answer."}, {"owner": {"reputation": 1446, "user_id": 1947066, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gR6Eb.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/1947066/tom"}, "edited": false, "score": 0, "creation_date": 1425585218, "post_id": 28869270, "comment_id": 46034262, "body": "Awesome that&#39;s just what I was looking for :) Thank you! Much appreciated! @Akavall"}], "tags": [], "owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "is_accepted": false, "score": 0, "last_activity_date": 1425566797, "last_edit_date": 1425566797, "creation_date": 1425524668, "answer_id": 28869270, "question_id": 28851190, "link": "https://stackoverflow.com/questions/28851190/golang-return-object-from-a-function/28869270#28869270", "title": "golang return object from a function", "body": "<p>But how come in your original code the addresses of the two pointers (not memory addresses the pointers are pointing too) are different?</p>\n\n<pre><code>func main() {\n    i := createPointerToInt();\n    fmt.Println(&amp;i);\n}\n</code></pre>\n\n<p>Is equivalent to:</p>\n\n<pre><code>func main() {\n    var i *int  // declare variable i\n    i = createPointerToInt(); // assign value of\n                              // a different i that was \n                              // declared and initialized\n                              // inside the function\n    fmt.Println(&amp;i);\n}\n</code></pre>\n\n<p>Edit:</p>\n\n<p>To print the address of a struct you need to use:</p>\n\n<pre><code>fmt.Printf(\"%p\\n\", &amp;your_struct)\n</code></pre>\n\n<p><a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow\">golang.org/pkg/fmt/</a></p>\n\n<p>For example:</p>\n\n<p><a href=\"https://play.golang.org/p/-i9vxGaQQz\" rel=\"nofollow\">goplayground</a></p>\n"}], "owner": {"reputation": 1446, "user_id": 1947066, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gR6Eb.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/1947066/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4596, "favorite_count": 0, "accepted_answer_id": 28851264, "answer_count": 3, "score": 5, "last_activity_date": 1425566797, "creation_date": 1425462445, "last_edit_date": 1425462996, "question_id": 28851190, "link": "https://stackoverflow.com/questions/28851190/golang-return-object-from-a-function", "title": "golang return object from a function", "body": "<p>I am struggling to understand exactly what is happening when you return a new object from a function in go.</p>\n\n<p>I have this</p>\n\n<pre><code>func createPointerToInt() *int {\n    i := new(int)\n    fmt.Println(&amp;i);\n    return i;\n}\n\nfunc main() {\n    i := createPointerToInt();\n    fmt.Println(&amp;i);\n}\n</code></pre>\n\n<p>The values printed returned are </p>\n\n<pre><code>0x1040a128\n0x1040a120\n</code></pre>\n\n<p>I would expect these two values to be the same. I do not understand why there is an 8 byte difference.</p>\n\n<p>In what I see as the equivalent C code:</p>\n\n<pre><code>int* createPointerToInt() {\n    int* i = new int;\n    printf(\"%#08x\\n\", i);\n    return i;\n}\n\nint main() {\n    int* r = createPointerToInt();\n    printf(\"%#08x\\n\", r);\n    return 0;\n}\n</code></pre>\n\n<p>The address returned is the same:</p>\n\n<pre><code>0x8218008\n0x8218008\n</code></pre>\n\n<p>Am I missing something blindingly obvious here? Any clarification would be greatly appreciated!</p>\n"}, {"tags": ["string", "go", "type-conversion", "slice"], "comments": [{"owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 0, "creation_date": 1594279365, "post_id": 28848187, "comment_id": 111071579, "body": "<code>string(u)</code> or <code>fmt.Sprintf(&quot;%s&quot;, u)</code> to set <code>[]uint8</code> to a sting. See <a href=\"https://stackoverflow.com/a/62725637/12817546\">stackoverflow.com/a/62725637/12817546</a>. <code>[]uint8(&quot;abc&quot;)</code> to set a string to <code>[]uint8</code>. See <a href=\"https://stackoverflow.com/a/62740786/12817546\">stackoverflow.com/a/62740786/12817546</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1425464600, "last_edit_date": 1495539987, "creation_date": 1425452799, "answer_id": 28848444, "question_id": 28848187, "link": "https://stackoverflow.com/questions/28848187/how-to-convert-int8-to-string/28848444#28848444", "title": "How to convert []int8 to string", "body": "<p>What is sure from \"<a href=\"https://stackoverflow.com/q/11924196/6309\">Convert between slices of different types</a>\" is that you have to build the right slice from your original <code>int8[]</code>.</p>\n\n<p>I ended up using <code>rune</code> (<code>int32</code> alias) (<a href=\"http://play.golang.org/p/r6OZa5N2bC\" rel=\"nofollow noreferrer\">playground</a>), assuming that the uint8 were all simple ascii character. That is obviously an over-simplification and <a href=\"https://stackoverflow.com/users/1705598/icza\">icza</a>'s <a href=\"https://stackoverflow.com/a/28848879/6309\">answer</a> has more on that.<br>\nPlus the <a href=\"https://github.com/jmoiron/sqlx/blob/69738bd209812c5a381786011aff17944a384554/sqlx.go#L674-L677\" rel=\"nofollow noreferrer\">SliceScan()</a> method ended up returning <code>uint8[]</code> anyway.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    s := []int8{'a', 'b', 'c'}\n    b := make([]rune, len(s))\n    for i, v := range s {\n        b[i] = rune(v)\n    }\n    fmt.Println(string(b))\n}\n</code></pre>\n\n<p>But I didn't benchmark it against using a <code>[]byte</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "is_accepted": false, "score": 2, "last_activity_date": 1425455039, "last_edit_date": 1425455039, "creation_date": 1425453156, "answer_id": 28848534, "question_id": 28848187, "link": "https://stackoverflow.com/questions/28848187/how-to-convert-int8-to-string/28848534#28848534", "title": "How to convert []int8 to string", "body": "<p>Not entirely sure it is the fastest, but I haven't found anything better.\nChange <code>ba := []byte{}</code> for <code>ba := make([]byte,0, len(bs)</code> so at the end you have:</p>\n\n<pre><code>func B2S(bs []int8) string {\n    ba := make([]byte,0, len(bs))\n    for _, b := range bs {\n        ba = append(ba, byte(b))\n    }\n    return string(ba)\n}\n</code></pre>\n\n<p>This way the append function will never try to insert more data that it can fit in the slice's underlying array and you will avoid unnecessary copying to a bigger array.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 18, "last_activity_date": 1533543624, "last_edit_date": 1533543624, "creation_date": 1425454565, "answer_id": 28848879, "question_id": 28848187, "link": "https://stackoverflow.com/questions/28848187/how-to-convert-int8-to-string/28848879#28848879", "title": "How to convert []int8 to string", "body": "<p><strong>Note beforehand:</strong> The asker first stated that input slice is <code>[]int8</code> so that is what the answer is for. Later he realized the input is <code>[]uint8</code> which can be directly converted to <code>string</code> because <code>byte</code> is an alias for <code>uint8</code> (and <code>[]byte</code> => <code>string</code> conversion is supported by the <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"noreferrer\">language spec</a>).</p>\n\n<hr>\n\n<p>You can't convert slices of different types, you have to do it manually.</p>\n\n<p>Question is what type of slice should we convert to? We have 2 candidates: <code>[]byte</code> and <code>[]rune</code>. Strings are stored as UTF-8 encoded byte sequences internally (<code>[]byte</code>), and a <code>string</code> can also be converted to a slice of runes. The language supports converting both of these types (<code>[]byte</code> and <code>[]rune</code>) to <code>string</code>.</p>\n\n<p>A <code>rune</code> is a unicode codepoint. And if we try to convert an <code>int8</code> to a <code>rune</code> in a one-to-one fashion, it will fail (meaning wrong output) if the input contains characters which are encoded to multiple bytes (using UTF-8) because in this case multiple <code>int8</code> values should end up in one <code>rune</code>.</p>\n\n<p>Let's start from the string <code>\"\u4e16\u754c\"</code> whose bytes are:</p>\n\n<pre><code>fmt.Println([]byte(\"\u4e16\u754c\"))\n// Output: [228 184 150 231 149 140]\n</code></pre>\n\n<p>And its runes:</p>\n\n<pre><code>fmt.Println([]rune(\"\u4e16\u754c\"))\n// [19990 30028]\n</code></pre>\n\n<p>It's only 2 runes and 6 bytes. So obviously 1-to-1 <code>int8</code>-><code>rune</code> mapping won't work, we have to go with 1-1 <code>int8</code>-><code>byte</code> mapping.</p>\n\n<p><sup><code>byte</code> is alias for <code>uint8</code> having range <code>0..255</code>, to convert it to <code>[]int8</code> (having range <code>-128..127</code>) we have to use <code>-256+bytevalue</code> if the byte value is > 127 so the <code>\"\u4e16\u754c\"</code> <code>string</code> in <code>[]int8</code> looks like this:</sup></p>\n\n<pre><code>[-28 -72 -106 -25 -107 -116]\n</code></pre>\n\n<p><sup>The backward conversion what we want is: <code>bytevalue = 256 + int8value</code> if the <code>int8</code> is negative but we can't do this as <code>int8</code> (range -128..127) and neither as <code>byte</code> (range 0..255) so we also have to convert it to <code>int</code> first (and back to <code>byte</code> at the end). This could look something like this:</sup></p>\n\n<pre><code>if v &lt; 0 {\n    b[i] = byte(256 + int(v))\n} else {\n    b[i] = byte(v)\n}\n</code></pre>\n\n<p><strong>But actually since signed integers are represented using <a href=\"https://en.wikipedia.org/wiki/Two%27s_complement\" rel=\"noreferrer\">2's complement</a>, we get the same result if we simply use a <code>byte(v)</code> conversion (which in case of negative numbers this is equivalent to <code>256 + v</code>).</strong></p>\n\n<p><strong>Note:</strong> Since we know the length of the slice, it is much faster to allocate a slice with this length and just set its elements using indexing <code>[]</code> and not calling the built-in <code>append</code> function.</p>\n\n<p>So here is the final conversion:</p>\n\n<pre><code>func B2S(bs []int8) string {\n    b := make([]byte, len(bs))\n    for i, v := range bs {\n        b[i] = byte(v)\n    }\n    return string(b)\n}\n</code></pre>\n\n<p>Try it on the <a href=\"https://play.golang.org/p/pCymfKl_Hp\" rel=\"noreferrer\">Go Playground</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1425461669, "post_id": 28850884, "comment_id": 45968913, "body": "Please delete one of your answers as they are identical."}, {"owner": {"reputation": 11, "user_id": 3859249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8tAtU.jpg?s=128&g=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/3859249/felix"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1426554974, "post_id": 28850884, "comment_id": 46412020, "body": "This is my first answer in stackoverflow.thks"}], "tags": [], "owner": {"reputation": 11, "user_id": 3859249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8tAtU.jpg?s=128&g=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/3859249/felix"}, "is_accepted": false, "score": 0, "last_activity_date": 1425464275, "last_edit_date": 1425464275, "creation_date": 1425461539, "answer_id": 28850884, "question_id": 28848187, "link": "https://stackoverflow.com/questions/28848187/how-to-convert-int8-to-string/28850884#28850884", "title": "How to convert []int8 to string", "body": "<p>Use unsafe package.</p>\n\n<pre><code>func B2S(bs []int8) string {\n  return strings.TrimRight(string(*(*[]byte)unsafe.Pointer(&amp;bs)), \"\\x00\")\n}\n</code></pre>\n\n<p>Send again ^^</p>\n"}], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15678, "favorite_count": 1, "accepted_answer_id": 28848879, "answer_count": 4, "score": 6, "last_activity_date": 1543488110, "creation_date": 1425451661, "last_edit_date": 1543488110, "question_id": 28848187, "link": "https://stackoverflow.com/questions/28848187/how-to-convert-int8-to-string", "title": "How to convert []int8 to string", "body": "<p>What's the best way (fastest performance) to convert from <code>[]int8</code> to string?</p>\n\n<p>For <code>[]byte</code> we could do <code>string(byteslice)</code>, but for <code>[]int8</code> it gives an error:</p>\n\n<pre><code>cannot convert ba (type []int8) to type string\n</code></pre>\n\n<p>I got the <code>ba</code> from <code>SliceScan()</code> method of <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow\"><code>*sqlx.Rows</code></a> that produces <code>[]int8</code> instead of <code>string</code></p>\n\n<p>Is this solution the fastest?</p>\n\n<pre><code>func B2S(bs []int8) string {\n    ba := []byte{}\n    for _, b := range bs {\n        ba = append(ba, byte(b))\n    }\n    return string(ba)\n}\n</code></pre>\n\n<p><strong>EDIT</strong> my bad, it's <code>uint8</code> instead of <code>int8</code>.. so I can do <code>string(ba)</code> directly.</p>\n"}, {"tags": ["git", "go", "patch", "libgit2", "pygit2"], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 2588618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4ec5b29e8058ff54dacb12a5c6f45fa?s=128&d=identicon&r=PG", "display_name": "Jessica Yuen", "link": "https://stackoverflow.com/users/2588618/jessica-yuen"}, "is_accepted": true, "score": 2, "last_activity_date": 1425446307, "creation_date": 1425446307, "answer_id": 28847134, "question_id": 28846582, "link": "https://stackoverflow.com/questions/28846582/getting-full-indexes-of-a-patch-using-libgit2-git2go/28847134#28847134", "title": "Getting full indexes of a patch using libgit2 / git2go", "body": "<p>So I've managed to get some outside help. If anyone runs into the same issue, it can be returned using:</p>\n\n<p><code>git_diff_options</code> in libgit2 and setting <code>id_abbrev</code> to 40.\n<a href=\"https://libgit2.github.com/libgit2/#HEAD/type/git_diff_options\" rel=\"nofollow\">https://libgit2.github.com/libgit2/#HEAD/type/git_diff_options</a></p>\n\n<p>or <code>DiffOptions</code> in git2go and setting <code>IdAbbrev</code> to 40.\n<a href=\"https://godoc.org/github.com/libgit2/git2go#DiffOptions\" rel=\"nofollow\">https://godoc.org/github.com/libgit2/git2go#DiffOptions</a></p>\n"}], "owner": {"reputation": 31, "user_id": 2588618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4ec5b29e8058ff54dacb12a5c6f45fa?s=128&d=identicon&r=PG", "display_name": "Jessica Yuen", "link": "https://stackoverflow.com/users/2588618/jessica-yuen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 28847134, "answer_count": 1, "score": 1, "last_activity_date": 1425446307, "creation_date": 1425442601, "last_edit_date": 1425443615, "question_id": 28846582, "link": "https://stackoverflow.com/questions/28846582/getting-full-indexes-of-a-patch-using-libgit2-git2go", "title": "Getting full indexes of a patch using libgit2 / git2go", "body": "<p>git2go's git.Patch or libgit2's git_patch returns a String value of the following format:</p>\n\n<pre><code>\"diff\": \"diff --git a/test b/test\n         index 9daeafb..dced80a 100644  \n         --- a/test \n         +++ b/test \n         @@ -1 +1,3 @@  \n         test\n         +  \n         +test\"\n</code></pre>\n\n<p>Notice that <code>index 9daeafb..dced80a 100644</code> is not the full index. Is there anyway using libgit2 / git2go to return the full index? i.e. the equivalence of running <code>git diff --full-index</code>?</p>\n"}, {"tags": ["xml", "go"], "answers": [{"tags": [], "owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "is_accepted": true, "score": 2, "last_activity_date": 1425436363, "creation_date": 1425436363, "answer_id": 28845716, "question_id": 28845321, "link": "https://stackoverflow.com/questions/28845321/parsing-xml-text-in-golang/28845716#28845716", "title": "parsing xml text in golang", "body": "<p>You can extract the <code>reason</code> field by updating your structs to read:</p>\n\n<pre><code>type State struct {\n    Reason string `xml:\"reason,attr\"`\n}\n\ntype PortData struct {\n    Protocol string `xml:\"protocol,attr\"`\n    Port     uint32 `xml:\"portid,attr\"`\n    State    State  `xml:\"state\"`\n}\n</code></pre>\n\n<p>Unfortunately you can't decode the reason attribute into a <code>PortData</code> field.  While the package does support picking nested elements, it won't let you combine that with attribute selection (i.e. <code>xml:\"state&gt;reason,attr\"</code> will result in an error from <code>Unmarshal</code>).</p>\n\n<p>Secondly, there is a small error in your test program: you are bailing out when <code>err</code> is nil, rather than the reverse.  With those two changes you should be able to extract the data you're after.</p>\n\n<p>You can experiment with this at: <a href=\"http://play.golang.org/p/hVxLzZ03cC\" rel=\"nofollow\">http://play.golang.org/p/hVxLzZ03cC</a></p>\n"}, {"comments": [{"owner": {"reputation": 12054, "user_id": 3614835, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/xzZDV.png?s=128&g=1", "display_name": "Jeffrey Bosboom", "link": "https://stackoverflow.com/users/3614835/jeffrey-bosboom"}, "edited": false, "score": 0, "creation_date": 1425436995, "post_id": 28845771, "comment_id": 45960219, "body": "The other answer points out this error and provides other information besides.  Only add a new answer if you have something new to add."}, {"owner": {"reputation": 662, "user_id": 4467308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/926e3460baba919e642f52ffda802cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Sinatra", "link": "https://stackoverflow.com/users/4467308/sinatra"}, "reply_to_user": {"reputation": 12054, "user_id": 3614835, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/xzZDV.png?s=128&g=1", "display_name": "Jeffrey Bosboom", "link": "https://stackoverflow.com/users/3614835/jeffrey-bosboom"}, "edited": false, "score": 0, "creation_date": 1425438410, "post_id": 28845771, "comment_id": 45960574, "body": "When I started writing the answer (and testing the code to ensure there were no other errors), there was no other answer to the question. I&#39;ll try to remember to reload the question just before submitting the answer so that I don&#39;t submit an answer if it&#39;s already covered by someone else in the mean-time. I&#39;m a new user, so I&#39;m not aware of the best-practices regarding this."}, {"owner": {"reputation": 12054, "user_id": 3614835, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/xzZDV.png?s=128&g=1", "display_name": "Jeffrey Bosboom", "link": "https://stackoverflow.com/users/3614835/jeffrey-bosboom"}, "edited": false, "score": 0, "creation_date": 1425438513, "post_id": 28845771, "comment_id": 45960599, "body": "Don&#39;t worry about it; I wouldn&#39;t have said anything if I&#39;d noticed the answers were posted so closely together."}], "tags": [], "owner": {"reputation": 662, "user_id": 4467308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/926e3460baba919e642f52ffda802cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Sinatra", "link": "https://stackoverflow.com/users/4467308/sinatra"}, "is_accepted": false, "score": 1, "last_activity_date": 1425436866, "last_edit_date": 1425436866, "creation_date": 1425436760, "answer_id": 28845771, "question_id": 28845321, "link": "https://stackoverflow.com/questions/28845321/parsing-xml-text-in-golang/28845771#28845771", "title": "parsing xml text in golang", "body": "<p>You just have a typo. It should be <code>err != nil</code>.</p>\n"}], "owner": {"reputation": 1010, "user_id": 3326103, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06afeeee747f8c3245b1dc74f634db88?s=128&d=identicon&r=PG&f=1", "display_name": "linuxfan", "link": "https://stackoverflow.com/users/3326103/linuxfan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 842, "favorite_count": 0, "accepted_answer_id": 28845716, "answer_count": 2, "score": 0, "last_activity_date": 1425436866, "creation_date": 1425433492, "question_id": 28845321, "link": "https://stackoverflow.com/questions/28845321/parsing-xml-text-in-golang", "title": "parsing xml text in golang", "body": "<p>Haven't had any luck parsing this snippet of xml text from the output of <code>nmap</code>.  I'm interested in parsing the <code>protocol</code>, <code>portid</code> and <code>reason</code> fields out of the xml text. Initially, I tried extracting only the first two fields:</p>\n\n<pre><code>var data = []byte(`\n &lt;ports&gt;&lt;extraports state=\"filtered\" count=\"65526\"&gt;\n    &lt;extrareasons reason=\"no-responses\" count=\"65526\"/&gt;\n    &lt;/extraports&gt;\n    &lt;port protocol=\"tcp\" portid=\"1\"&gt;&lt;state state=\"closed\" reason=\"conn-refused\" reason_ttl=\"0\"/&gt;&lt;service name=\"tcpmux\" method=\"table\" conf=\"3\"/&gt;&lt;/port&gt;\n    &lt;port protocol=\"tcp\" portid=\"2\"&gt;&lt;state state=\"closed\" reason=\"conn-refused\" reason_ttl=\"0\"/&gt;&lt;service name=\"compressnet\" method=\"table\" conf=\"3\"/&gt;&lt;/port&gt;\n    &lt;port protocol=\"tcp\" portid=\"8\"&gt;&lt;state state=\"closed\" reason=\"conn-refused\" reason_ttl=\"0\"/&gt;&lt;service name=\"unknown\" method=\"table\" conf=\"3\"/&gt;&lt;/port&gt;\n    &lt;port protocol=\"tcp\" portid=\"2709\"&gt;&lt;state state=\"closed\" reason=\"conn-refused\" reason_ttl=\"0\"/&gt;&lt;/port&gt;\n    &lt;port protocol=\"tcp\" portid=\"7748\"&gt;&lt;state state=\"closed\" reason=\"conn-refused\" reason_ttl=\"0\"/&gt;&lt;/port&gt;\n    &lt;port protocol=\"tcp\" portid=\"12946\"&gt;&lt;state state=\"closed\" reason=\"conn-refused\" reason_ttl=\"0\"/&gt;&lt;/port&gt;\n    &lt;port protocol=\"tcp\" portid=\"53094\"&gt;&lt;state state=\"closed\" reason=\"conn-refused\" reason_ttl=\"0\"/&gt;&lt;/port&gt;\n    &lt;port protocol=\"tcp\" portid=\"58137\"&gt;&lt;state state=\"closed\" reason=\"conn-refused\" reason_ttl=\"0\"/&gt;&lt;/port&gt;\n    &lt;port protocol=\"tcp\" portid=\"63139\"&gt;&lt;state state=\"closed\" reason=\"conn-refused\" reason_ttl=\"0\"/&gt;&lt;/port&gt;\n    &lt;/ports&gt;\n`)\n</code></pre>\n\n<p>I defined my structures as below:</p>\n\n<pre><code>type PortData struct {\n    Protocol string `xml:\"protocol,attr\"`\n    Port uint32 `xml:\"portid,attr\"`\n}\n\ntype Nmap struct {\n    IgnoreMe xml.Name `xml:\"ports\"`\n    Data []PortData `xml:\"port\"`    \n}\n\nfunc main() {\n    var m Nmap\n    if err := xml.Unmarshal(data, &amp;m); err == nil {\n        log.Fatalln(err)\n    }\n    log.Println(\"Succeeded\")\n    fmt.Printf(\"%#v\\n\", m)\n}\n</code></pre>\n\n<p>How can I fix my struct definitions to extract the fields of interest? Thanks</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 4552, "user_id": 2417948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a6ac877074faa3d602825e4b0b8c797?s=128&d=identicon&r=PG", "display_name": "Patrice", "link": "https://stackoverflow.com/users/2417948/patrice"}, "edited": false, "score": 0, "creation_date": 1425434422, "post_id": 28845253, "comment_id": 45959590, "body": "hmmmmm.... I remember I had an issue with pull queues where the url request for the &quot;project ID&quot;. Sometimes it asks for the app id (ie &quot;clever-blossom-273&quot;), and sometimes it&#39;s the actual project number. I don&#39;t know which one you&#39;re using right now, but try the other one?"}, {"owner": {"reputation": 336, "user_id": 163668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/655035a55b549d3abfb34e962a59985d?s=128&d=identicon&r=PG", "display_name": "Alexei Andreev", "link": "https://stackoverflow.com/users/163668/alexei-andreev"}, "reply_to_user": {"reputation": 4552, "user_id": 2417948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a6ac877074faa3d602825e4b0b8c797?s=128&d=identicon&r=PG", "display_name": "Patrice", "link": "https://stackoverflow.com/users/2417948/patrice"}, "edited": false, "score": 0, "creation_date": 1425482365, "post_id": 28845253, "comment_id": 45981994, "body": "Patrice, were you pulling tasks from outside of GAE? In that case I think you need to provide a URL. But I&#39;m doing things within GAE, so there is no place I need to provide the app id."}, {"owner": {"reputation": 4552, "user_id": 2417948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a6ac877074faa3d602825e4b0b8c797?s=128&d=identicon&r=PG", "display_name": "Patrice", "link": "https://stackoverflow.com/users/2417948/patrice"}, "edited": false, "score": 0, "creation_date": 1425487113, "post_id": 28845253, "comment_id": 45985367, "body": "well it was within the App Engine, but I was calling it on the REST API, so yeah.... could&#39;ve been done outside of the app engine"}, {"owner": {"reputation": 4552, "user_id": 2417948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a6ac877074faa3d602825e4b0b8c797?s=128&d=identicon&r=PG", "display_name": "Patrice", "link": "https://stackoverflow.com/users/2417948/patrice"}, "edited": false, "score": 0, "creation_date": 1425584738, "post_id": 28845253, "comment_id": 46034004, "body": "hmmm if you&#39;re not using the REST API, mind including your call?"}, {"owner": {"reputation": 336, "user_id": 163668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/655035a55b549d3abfb34e962a59985d?s=128&d=identicon&r=PG", "display_name": "Alexei Andreev", "link": "https://stackoverflow.com/users/163668/alexei-andreev"}, "reply_to_user": {"reputation": 4552, "user_id": 2417948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a6ac877074faa3d602825e4b0b8c797?s=128&d=identicon&r=PG", "display_name": "Patrice", "link": "https://stackoverflow.com/users/2417948/patrice"}, "edited": false, "score": 0, "creation_date": 1425605781, "post_id": 28845253, "comment_id": 46042933, "body": "I&#39;m also having a conversation about this here: <a href=\"https://groups.google.com/forum/#!topic/google-appengine-go/fgxkrBFPQ-Q\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/google-appengine-go/fgxkrBFP&zwnj;&#8203;Q-Q</a> David correctly pointed out that technically production isn&#39;t picking up my queue from queue.yaml, so that&#39;s probably the heart of the problem."}, {"owner": {"reputation": 4552, "user_id": 2417948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a6ac877074faa3d602825e4b0b8c797?s=128&d=identicon&r=PG", "display_name": "Patrice", "link": "https://stackoverflow.com/users/2417948/patrice"}, "edited": false, "score": 0, "creation_date": 1425606466, "post_id": 28845253, "comment_id": 46043149, "body": "Yeah as he pointed out, you&#39;ll have trouble pulling from a queue with no tasks. I&#39;m wondering how come the queue doesn&#39;t show up in your admin console though.... if you had that up it should all run perfectly...."}, {"owner": {"reputation": 4552, "user_id": 2417948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a6ac877074faa3d602825e4b0b8c797?s=128&d=identicon&r=PG", "display_name": "Patrice", "link": "https://stackoverflow.com/users/2417948/patrice"}, "edited": false, "score": 0, "creation_date": 1425606705, "post_id": 28845253, "comment_id": 46043216, "body": "If I was at a computer I&#39;d check... but isn&#39;t there an appcfg command to ONLY push your queue.yaml?"}, {"owner": {"reputation": 4552, "user_id": 2417948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a6ac877074faa3d602825e4b0b8c797?s=128&d=identicon&r=PG", "display_name": "Patrice", "link": "https://stackoverflow.com/users/2417948/patrice"}, "edited": false, "score": 0, "creation_date": 1425607098, "post_id": 28845253, "comment_id": 46043342, "body": "Just checked from my cell (the bus ride is long). If you try appcfg.py update_ queues on your app folder. Does it do anything? (Technically deploying should do that... but worth testing)"}, {"owner": {"reputation": 336, "user_id": 163668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/655035a55b549d3abfb34e962a59985d?s=128&d=identicon&r=PG", "display_name": "Alexei Andreev", "link": "https://stackoverflow.com/users/163668/alexei-andreev"}, "reply_to_user": {"reputation": 4552, "user_id": 2417948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a6ac877074faa3d602825e4b0b8c797?s=128&d=identicon&r=PG", "display_name": "Patrice", "link": "https://stackoverflow.com/users/2417948/patrice"}, "edited": false, "score": 0, "creation_date": 1425610511, "post_id": 28845253, "comment_id": 46044225, "body": "Yup, that was the problem. (See the google groups thread.) Looks like you got the solution slightly earlier than David, so in that spirit, I&#39;d be happy to accept your answer if you post it below."}, {"owner": {"reputation": 4552, "user_id": 2417948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a6ac877074faa3d602825e4b0b8c797?s=128&d=identicon&r=PG", "display_name": "Patrice", "link": "https://stackoverflow.com/users/2417948/patrice"}, "edited": false, "score": 0, "creation_date": 1425654657, "post_id": 28845253, "comment_id": 46062621, "body": "As much as I appreciate the sentiment, David just answered here :) feel free to accept his answer :). I&#39;m not here for the points. Just happy to have helped ^^"}], "answers": [{"tags": [], "owner": {"reputation": 857, "user_id": 1527967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19af6603d5b10fa883500305bdfd8b4c?s=128&d=identicon&r=PG", "display_name": "dsymonds", "link": "https://stackoverflow.com/users/1527967/dsymonds"}, "is_accepted": true, "score": 2, "last_activity_date": 1425614585, "creation_date": 1425614585, "answer_id": 28892150, "question_id": 28845253, "link": "https://stackoverflow.com/questions/28845253/queue-doesnt-work-in-production/28892150#28892150", "title": "Queue doesn&#39;t work in production", "body": "<p>You don't have the queue configured in production. Make sure you are deploying your whole app directory so <code>queue.yaml</code> get uploaded. Point <code>goapp deploy</code> or <code>appcfg.py</code> at the directory holding <code>app.yaml</code> and <code>queue.yaml</code>, not at <code>app.yaml</code> directly.</p>\n"}], "owner": {"reputation": 336, "user_id": 163668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/655035a55b549d3abfb34e962a59985d?s=128&d=identicon&r=PG", "display_name": "Alexei Andreev", "link": "https://stackoverflow.com/users/163668/alexei-andreev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 576, "favorite_count": 0, "accepted_answer_id": 28892150, "answer_count": 1, "score": 2, "last_activity_date": 1425614585, "creation_date": 1425433019, "last_edit_date": 1425604745, "question_id": 28845253, "link": "https://stackoverflow.com/questions/28845253/queue-doesnt-work-in-production", "title": "Queue doesn&#39;t work in production", "body": "<p>When I'm testing my website locally everything works. But in production, I get the following error: <code>Couldn't lease a task: API error 1 (taskqueue: UNKNOWN_QUEUE)</code></p>\n\n<p>I'm pretty sure my code is correct since it works locally. My best guess is that there is something wrong with the queue.yaml file, but it's dead simple:</p>\n\n<pre><code>queue:\n- name: daemonQueue\n  mode: pull\n</code></pre>\n\n<p>What could I be doing wrong?</p>\n\n<p>EDIT:<br>\nTurns out enqueueing fails as well: <code>TickTask enqueue error: Failed to insert task: API error 1 (taskqueue: UNKNOWN_QUEUE)</code><br>\nHere is how I'm enqueueing the task.</p>\n\n<pre><code>// Add the task to the queue.\nfunc EnqueueWithName(c sessions.Context, task interface{}, tag string, name string) (err error) {\n   buffer := new(bytes.Buffer) \n   err = gob.NewEncoder(buffer).Encode(task) \n   if err != nil { \n     return \n   } \n   newTask := &amp;taskqueue.Task{ \n     Method:  \"PULL\", \n     Payload: buffer.Bytes(), \n     Tag:     tag, \n     Name:    name} \n   newTask, err = taskqueue.Add(c, newTask, \"daemonQueue\") \n   return err\n }   \n</code></pre>\n"}, {"tags": ["performance", "unit-testing", "google-app-engine", "optimization", "go"], "comments": [{"owner": {"reputation": 12677, "user_id": 220710, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0e3616fa71abd6c30910910d4d439470?s=128&d=identicon&r=PG", "display_name": "Emil Davtyan", "link": "https://stackoverflow.com/users/220710/emil-davtyan"}, "edited": false, "score": 0, "creation_date": 1425438552, "post_id": 28844384, "comment_id": 45960610, "body": "Can you copy some more of the log especially the sections taking up most of the time? I don&#39;t use GAE, so you should try debugging this yourself, but there seems to be several places where a 15 second timeout wait kicks in <a href=\"https://code.google.com/p/appengine-go/source/browse/appengine/aetest/instance.go#156\" rel=\"nofollow noreferrer\">code.google.com/p/appengine-go/source/browse/appengine/aetes&zwnj;&#8203;t/&hellip;</a>"}, {"owner": {"reputation": 7245, "user_id": 953732, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f8115344be80362b14eb47e29c44c61e?s=128&d=identicon&r=PG", "display_name": "ThePiachu", "link": "https://stackoverflow.com/users/953732/thepiachu"}, "reply_to_user": {"reputation": 12677, "user_id": 220710, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0e3616fa71abd6c30910910d4d439470?s=128&d=identicon&r=PG", "display_name": "Emil Davtyan", "link": "https://stackoverflow.com/users/220710/emil-davtyan"}, "edited": false, "score": 0, "creation_date": 1425442719, "post_id": 28844384, "comment_id": 45961568, "body": "@EmilDavtyan Most of the logs look like the log attached. It&#39;s just a lot of those logs. I am guessing each function that creates Context also calls for the Context to be closed, so that might be what&#39;s slowing it down..."}, {"owner": {"reputation": 632, "user_id": 872227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ddef50299354758664f679265746cd?s=128&d=identicon&r=PG", "display_name": "freeformz", "link": "https://stackoverflow.com/users/872227/freeformz"}, "edited": false, "score": 0, "creation_date": 1428478184, "post_id": 28844384, "comment_id": 47173429, "body": "Why are you effectively testing another package?"}, {"owner": {"reputation": 7245, "user_id": 953732, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f8115344be80362b14eb47e29c44c61e?s=128&d=identicon&r=PG", "display_name": "ThePiachu", "link": "https://stackoverflow.com/users/953732/thepiachu"}, "reply_to_user": {"reputation": 632, "user_id": 872227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ddef50299354758664f679265746cd?s=128&d=identicon&r=PG", "display_name": "freeformz", "link": "https://stackoverflow.com/users/872227/freeformz"}, "edited": false, "score": 0, "creation_date": 1428509206, "post_id": 28844384, "comment_id": 47194542, "body": "@freeformz I&#39;m not testing another package, but testing a package that uses appengine packages."}], "answers": [{"comments": [{"owner": {"reputation": 21950, "user_id": 50924, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dbc0bddea11bf42a70a370f0222e6898?s=128&d=identicon&r=PG", "display_name": "Dan McNevin", "link": "https://stackoverflow.com/users/50924/dan-mcnevin"}, "edited": false, "score": 0, "creation_date": 1455038995, "post_id": 29703754, "comment_id": 58306974, "body": "Thanks! This increased my test speed by about a million percent."}], "tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": false, "score": 4, "last_activity_date": 1429285373, "creation_date": 1429285373, "answer_id": 29703754, "question_id": 28844384, "link": "https://stackoverflow.com/questions/28844384/how-to-speed-up-google-app-engine-go-unit-tests/29703754#29703754", "title": "How to speed up Google App Engine Go unit tests?", "body": "<p>You can use a custom <code>TestMain</code> function:</p>\n\n<pre><code>var ctx aetest.Context\n\nvar c aetest.Context\n\nfunc TestMain(m *testing.M) {\n    var err error\n    ctx, err = aetest.NewContext(nil)\n    if err != nil {\n        panic(err)\n    }\n    code := m.Run() // this runs the tests\n    ctx.Close()\n    os.Exit(code)\n}\n\nfunc TestUsers(t *testing.T) {\n    // use ctx here\n}\n</code></pre>\n\n<p>This way the dev server is started once for all the tests. More details on <code>TestMain</code> are available here: <a href=\"http://golang.org/pkg/testing/#hdr-Main\" rel=\"nofollow\">http://golang.org/pkg/testing/#hdr-Main</a>.</p>\n"}], "owner": {"reputation": 7245, "user_id": 953732, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f8115344be80362b14eb47e29c44c61e?s=128&d=identicon&r=PG", "display_name": "ThePiachu", "link": "https://stackoverflow.com/users/953732/thepiachu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 538, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1429285373, "creation_date": 1425427319, "question_id": 28844384, "link": "https://stackoverflow.com/questions/28844384/how-to-speed-up-google-app-engine-go-unit-tests", "title": "How to speed up Google App Engine Go unit tests?", "body": "<p>I am currently writing a lot of unit tests for my package that runs on GAE Go. The package in question is focused on data saving and loading to and from appengine/datastore. As such, I have about 20 unit test files that look a bit like this:</p>\n\n<pre><code>package Data\n\nimport (\n    \"appengine\"\n    \"appengine/aetest\"\n    . \"gopkg.in/check.v1\"\n    \"testing\"\n)\n\nfunc TestUsers(t *testing.T) { TestingT(t) }\n\ntype UsersSuite struct{}\n\nvar _ = Suite(&amp;UsersSuite{})\n\nconst UserID string = \"UserID\"\n\n\nfunc (s *UsersSuite) TestSaveLoad(cc *C) {\n    c, err := aetest.NewContext(nil)\n    cc.Assert(err, IsNil)\n    defer c.Close()\n    ...\n</code></pre>\n\n<p>As a result, each individual test file appears to be starting its own version of devappserver:</p>\n\n<p><img src=\"https://i.stack.imgur.com/wodQ1.jpg\" alt=\"enter image description here\"></p>\n\n<p>Repeat this 20 times and my unit tests run for over 10 minutes.</p>\n\n<p>I am wondering, how can I speed up the execution of my testing suite? Should I have just one file that creates aetest.NewContext and passes that onwards, or is it due to me using separate Suites for each unit test? How can I speed this thing up?</p>\n"}, {"tags": ["http", "go"], "answers": [{"comments": [{"owner": {"reputation": 634, "user_id": 868460, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1e857f65ecfce17be0366f5bc2f7afb4?s=128&d=identicon&r=PG", "display_name": "Suchipi", "link": "https://stackoverflow.com/users/868460/suchipi"}, "edited": false, "score": 1, "creation_date": 1425438703, "post_id": 28845255, "comment_id": 45960647, "body": "Thank you! Just what I needed."}], "tags": [], "owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "is_accepted": true, "score": 23, "last_activity_date": 1425433058, "creation_date": 1425433058, "answer_id": 28845255, "question_id": 28843047, "link": "https://stackoverflow.com/questions/28843047/how-can-i-parse-the-content-disposition-header-to-retrieve-the-filename-property/28845255#28845255", "title": "How can I parse the Content-Disposition header to retrieve the filename property?", "body": "<p>You can parse the <code>Content-Disposition</code> header using the <a href=\"http://golang.org/pkg/mime/#ParseMediaType\" rel=\"noreferrer\"><code>mime.ParseMediaType</code></a> function.</p>\n\n<pre><code>disposition, params, err := mime.ParseMediaType(`attachment;filename=\"foo.png\"`)\nfilename := params[\"filename\"] // set to \"foo.png\"\n</code></pre>\n\n<p>This will also work for Unicode file names in the header (e.g. <code>Content-Disposition: attachment;filename*=\"UTF-8''fo%c3%b6.png\"</code>).</p>\n\n<p>You can experiment with this here: <a href=\"http://play.golang.org/p/AjWbJB8vUk\" rel=\"noreferrer\">http://play.golang.org/p/AjWbJB8vUk</a></p>\n"}], "owner": {"reputation": 634, "user_id": 868460, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1e857f65ecfce17be0366f5bc2f7afb4?s=128&d=identicon&r=PG", "display_name": "Suchipi", "link": "https://stackoverflow.com/users/868460/suchipi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5918, "favorite_count": 4, "accepted_answer_id": 28845255, "answer_count": 1, "score": 12, "last_activity_date": 1425433058, "creation_date": 1425421046, "question_id": 28843047, "link": "https://stackoverflow.com/questions/28843047/how-can-i-parse-the-content-disposition-header-to-retrieve-the-filename-property", "title": "How can I parse the Content-Disposition header to retrieve the filename property?", "body": "<p>Using go, how can I parse the Content-Disposition header retrieved from an http HEAD request to obtain the filename of the file?</p>\n\n<p>Additionally, how do I retrieve the header itself from the http HEAD response? Is something like this correct?</p>\n\n<pre><code>resp, err := http.Head(\"http://example.com/\")\n//handle error\ncontentDisposition := resp.Header.Get(\"Content-Disposition\")\n</code></pre>\n\n<p>The <code>mime/multipart</code> package specifies a method on the Part type that returns the filename (called FileName), but it's not clear to me how I should construct a Part, or from what.</p>\n"}, {"tags": ["python", "google-app-engine", "go"], "answers": [{"tags": [], "owner": {"reputation": 757655, "user_id": 95810, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e8d5fe90f1fe2148bf130cccd4dc311c?s=128&d=identicon&r=PG", "display_name": "Alex Martelli", "link": "https://stackoverflow.com/users/95810/alex-martelli"}, "is_accepted": true, "score": 2, "last_activity_date": 1425427743, "last_edit_date": 1425427743, "creation_date": 1425427586, "answer_id": 28844419, "question_id": 28842167, "link": "https://stackoverflow.com/questions/28842167/appengine-convert-ndb-model-to-go-lang-struct/28844419#28844419", "title": "appengine: convert ndb model to go lang struct", "body": "<p>Per <a href=\"https://cloud.google.com/appengine/docs/go/datastore/entities#Go_Properties_and_value_types\" rel=\"nofollow\">https://cloud.google.com/appengine/docs/go/datastore/entities#Go_Properties_and_value_types</a> , <code>String</code> (a short string of up to 500 characters, indexed by default) maps to Go <code>string</code>; <code>Text</code> (a long string up to 1MB, not indexed) also to Go <code>string</code> but always with <code>noindex</code>; for datastore <code>Key</code> there is <code>*datastore.Key</code>, see <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#Key\" rel=\"nofollow\">https://cloud.google.com/appengine/docs/go/datastore/reference#Key</a> ; for <code>Integer</code>, <code>int64</code>; for <code>Float</code>, <code>float64</code> (you could use shorter ints and floats but the datastore uses 64 bits for each anyway so you might as well:-).</p>\n\n<blockquote>\n  <p>Also can I just ignore the <code>required=True</code> &amp; <code>indexed=False</code> options?</p>\n</blockquote>\n\n<p>Yes for <code>required</code>, but I believe that, using <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference\" rel=\"nofollow\">https://cloud.google.com/appengine/docs/go/datastore/reference</a> , you do have to use option <code>noindex</code> for <code>Text</code> because it's necessary to indicate strings that can be longer than 512 (unicode) characters.</p>\n\n<p>Not sure which versions of <code>go</code> and its <code>datastore</code> package enforce this constraint, but even if the present one doesn't it's safer to respect it anyway -- or else your app might break with a simple Go version upgrade!-)</p>\n"}, {"tags": [], "owner": {"reputation": 14155, "user_id": 632088, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4b02313659bcb668d49a0075c2de0bc1?s=128&d=identicon&r=PG", "display_name": "robert king", "link": "https://stackoverflow.com/users/632088/robert-king"}, "is_accepted": false, "score": 0, "last_activity_date": 1425501849, "last_edit_date": 1425501849, "creation_date": 1425501387, "answer_id": 28864406, "question_id": 28842167, "link": "https://stackoverflow.com/questions/28842167/appengine-convert-ndb-model-to-go-lang-struct/28864406#28864406", "title": "appengine: convert ndb model to go lang struct", "body": "<p>Here's the code - it's working in production &amp; locally too:</p>\n\n<pre><code>type Course struct {\n    Name              string         `datastore:\"name\"`\n    NeatName          string         `datastore:\"neat_name\"`\n    Country           *datastore.Key `datastore:\"country\"`\n    University        *datastore.Key `datastore:\"university\"`\n    Faculty           *datastore.Key `datastore:\"faculty\"`\n    Department        *datastore.Key `datastore:\"department\"`\n    Stage             *datastore.Key `datastore:\"stage\"`\n    LegacyId          string         `datastore:\"legacy_id\"`\n    CourseTitle       string         `datastore:\"course_title,noindex\"`\n    CourseDescription string         `datastore:\"course_description\"`\n    CourseLink        string         `datastore:\"course_link,noindex\"`\n    CourseRating      float64        `datastore:\"course_rating_\"`\n    CourseReviewCount int64          `datastore:\"course_review_count_\"`\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>func (ttt *EdSearchApi) Search(r *http.Request,\n    req *SearchQuery, resp *SearchResults) error {\n    c := appengine.NewContext(r)\n    q := datastore.NewQuery(\"Course\").Limit(1)\n    var courses []Course\n    _, err := q.GetAll(c, &amp;courses)\n    c.Infof(\"err %v\", err)\n    c.Infof(\"courses 0: %v\", courses[0])\n    c.Infof(\"!!!\")\n    return nil\n}\n</code></pre>\n"}], "owner": {"reputation": 14155, "user_id": 632088, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4b02313659bcb668d49a0075c2de0bc1?s=128&d=identicon&r=PG", "display_name": "robert king", "link": "https://stackoverflow.com/users/632088/robert-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 0, "accepted_answer_id": 28844419, "answer_count": 2, "score": 0, "last_activity_date": 1425501849, "creation_date": 1425417855, "question_id": 28842167, "link": "https://stackoverflow.com/questions/28842167/appengine-convert-ndb-model-to-go-lang-struct", "title": "appengine: convert ndb model to go lang struct", "body": "<p>I've got a python module and a go module on app engine. The go module is fairly simple and just provides a readonly search interface to the datastore which is populated by the python module.</p>\n\n<p>How do I convert the following ndb model into a go struct:</p>\n\n<pre><code>class Course(ndb.Model):\n    name = ndb.StringProperty()\n    neat_name = ndb.StringProperty(required=True)\n    country = ndb.KeyProperty(kind=Country, required=True)\n    university = ndb.KeyProperty(kind=University, required=True)\n    faculty = ndb.KeyProperty(kind=Faculty, required=True)\n    department = ndb.KeyProperty(kind=Department, required=True)\n    stage = ndb.KeyProperty(kind=Stage, required=True)\n\n    legacy_id = ndb.StringProperty()\n    course_title = ndb.StringProperty(required=True, indexed=False)\n    course_description = ndb.TextProperty(required=True)\n    course_link = ndb.StringProperty(required=True, indexed=False)\n\n    #0-5 or None or not has attribute.\n    course_rating_ = ndb.FloatProperty()\n    course_review_count_ = ndb.IntegerProperty()\n</code></pre>\n\n<p>To start with I'll have:</p>\n\n<pre><code>type Course struct {\n    Name string `datastore:\"name\"`\n    NeatName `datastore:\"neat_name\"`\n    ...\n}\n</code></pre>\n\n<p>For the <code>ndb.KeyProperty</code> properties - Do I just use a <code>string</code> in my <code>struct</code>? &amp; I'll have to parse that string - is that straight forward?</p>\n\n<p>Also can I just ignore the <code>required=True</code> &amp; <code>indexed=False</code> options? Obviously since i'm not doing any writes?</p>\n"}, {"tags": ["go", "url-encoding"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1425414371, "post_id": 28841195, "comment_id": 45951636, "body": "You have json stored in a json string. Can you fix that, or do you have to decode this value exactly as is?"}, {"owner": {"reputation": 1364, "user_id": 791842, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/e22db9b1ffd20305669ffe5676baca02?s=128&d=identicon&r=PG", "display_name": "sathishvj", "link": "https://stackoverflow.com/users/791842/sathishvj"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1425414567, "post_id": 28841195, "comment_id": 45951735, "body": "I would have like to not have it, but as of now, it&#39;s what I&#39;m getting.  I do have a brute force solution in <a href=\"http://play.golang.org/p/of6XgePtOu\" rel=\"nofollow noreferrer\">play.golang.org/p/of6XgePtOu</a>.  But I&#39;m hoping that there is a cleaner way."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 852329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11bcadf15046a199c661894f9c35680b?s=128&d=identicon&r=PG", "display_name": "lafolle", "link": "https://stackoverflow.com/users/852329/lafolle"}, "edited": false, "score": 0, "creation_date": 1502863573, "post_id": 28841810, "comment_id": 78370289, "body": "Or <code>go doc strconv.Unquote</code> can be used to remove quotes (double in my case) and then feed the output to json.Unmarshal."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1425418234, "last_edit_date": 1425418234, "creation_date": 1425416517, "answer_id": 28841810, "question_id": 28841195, "link": "https://stackoverflow.com/questions/28841195/golang-unencode-string-to-be-parsable-into-json/28841810#28841810", "title": "golang unencode string to be parsable into json", "body": "<p>You can either manually remove the quoting yourself, as you have in your comment, or you could unmarshal first as a json string:</p>\n\n<pre><code>var unquote string\nerr := json.Unmarshal([]byte(s), &amp;unquote)\nfmt.Println(unquote, err)\n\nvar i Info \nerr = json.Unmarshal([]byte(unquote), &amp;i)\nfmt.Println(i, err)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": false, "score": 1, "last_activity_date": 1425439222, "last_edit_date": 1425439222, "creation_date": 1425426337, "answer_id": 28844233, "question_id": 28841195, "link": "https://stackoverflow.com/questions/28841195/golang-unencode-string-to-be-parsable-into-json/28844233#28844233", "title": "golang unencode string to be parsable into json", "body": "<p>I believe this does what you want: \n<kbd><a href=\"http://play.golang.org/p/7M00dQPiN9\" rel=\"nofollow\"><strong>GoPlay</strong></a></kbd></p>\n\n<p>Essentially you implement <code>unmarshalJsonJson</code> (clever name, I know)...\nThe function will unmarshal as a json string, then use that string in the Info unmarshalling.</p>\n\n<pre><code>func unmarshalJsonJson(inval string) (*Info, error) {\n    var s string\n    err := json.Unmarshal([]byte(inval), &amp;s)\n    if err != nil {\n        return nil, err\n    }\n    info := new(Info)\n    err = json.Unmarshal([]byte(s), info)\n    if err != nil {\n        return nil, err\n    }\n    return info, nil\n}\n</code></pre>\n\n<p><strong>OUTPUT</strong>  </p>\n\n<pre><code>main.Info{\n    SessionId:\"5331b937-7b55-4c2d-798a-25e574a7e8af\",\n    UserId:2,\n    Username:\"datami_op\",\n    Email:\"datami_op@example.com\",\n    Roles:[]string{\"operator\"},\n}\n</code></pre>\n"}], "owner": {"reputation": 1364, "user_id": 791842, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/e22db9b1ffd20305669ffe5676baca02?s=128&d=identicon&r=PG", "display_name": "sathishvj", "link": "https://stackoverflow.com/users/791842/sathishvj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1658, "favorite_count": 0, "accepted_answer_id": 28841810, "answer_count": 2, "score": 1, "last_activity_date": 1425439222, "creation_date": 1425414027, "question_id": 28841195, "link": "https://stackoverflow.com/questions/28841195/golang-unencode-string-to-be-parsable-into-json", "title": "golang unencode string to be parsable into json", "body": "<p>How do I get <a href=\"http://play.golang.org/p/EQLUqzIqds\" rel=\"nofollow\">this</a> to work?</p>\n\n<pre><code>s, _ := url.QueryUnescape(\"%22%7B%5C%22sessionId%5C%22%3A%5C%225331b937-7b55-4c2d-798a-25e574a7e8af%5C%22%2C%5C%22userId%5C%22%3A2%2C%5C%22userName%5C%22%3A%5C%22datami_op%5C%22%2C%5C%22userEmail%5C%22%3A%5C%22datami_op%40example.com%5C%22%2C%5C%22userRoles%5C%22%3A%5B%5C%22operator%5C%22%5D%7D%22\")\nfmt.Println(s)\n//s := \"{\\\"sessionId\\\":\\\"5331b937-7b55-4c2d-798a-25e574a7e8af\\\",\\\"userId\\\":2,\\\"userName\\\":\\\"op\\\",\\\"userEmail\\\":\\\"datami_op@example.com\\\",\\\"userRoles\\\":[\\\"operator\\\"]}\"\nvar i Info\nerr := json.Unmarshal([]byte(s), &amp;i)\nfmt.Println(i, err)\n</code></pre>\n"}, {"tags": ["go", "scheduler"], "comments": [{"owner": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "edited": false, "score": 0, "creation_date": 1425397307, "post_id": 28835758, "comment_id": 45941296, "body": "The C compiler probably optimizes the empty loop away."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "edited": false, "score": 0, "creation_date": 1425397328, "post_id": 28835758, "comment_id": 45941313, "body": "@Arjan: that&#39;s incorrect"}, {"owner": {"reputation": 9586, "user_id": 1000282, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/371832f83b79a41443fa50d3793b0cfd?s=128&d=identicon&r=PG", "display_name": "pepper_chico", "link": "https://stackoverflow.com/users/1000282/pepper-chico"}, "reply_to_user": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "edited": false, "score": 0, "creation_date": 1425397404, "post_id": 28835758, "comment_id": 45941353, "body": "@Arjan yes, output also supports it&#39;s incorrect."}], "answers": [{"comments": [{"owner": {"reputation": 9586, "user_id": 1000282, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/371832f83b79a41443fa50d3793b0cfd?s=128&d=identicon&r=PG", "display_name": "pepper_chico", "link": "https://stackoverflow.com/users/1000282/pepper-chico"}, "edited": false, "score": 0, "creation_date": 1425397920, "post_id": 28835880, "comment_id": 45941739, "body": "The sentence &quot;It has to be in it&#39;s own thread for other goroutines to be scheduled&quot; is not very clear IMO. The busy loop has to be in its own thread, and because of this the others can be scheduled?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 9586, "user_id": 1000282, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/371832f83b79a41443fa50d3793b0cfd?s=128&d=identicon&r=PG", "display_name": "pepper_chico", "link": "https://stackoverflow.com/users/1000282/pepper-chico"}, "edited": false, "score": 0, "creation_date": 1425398275, "post_id": 28835880, "comment_id": 45941986, "body": "@pepper_chico: tried to fix the wording a bit. Although goroutines are scheduled automatically, they are in a sense still cooperative. If there&#39;s no free threads to run a goroutine, and the running goroutine[s] aren&#39;t yielding, there&#39;s no way to continue."}, {"owner": {"reputation": 9586, "user_id": 1000282, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/371832f83b79a41443fa50d3793b0cfd?s=128&d=identicon&r=PG", "display_name": "pepper_chico", "link": "https://stackoverflow.com/users/1000282/pepper-chico"}, "edited": false, "score": 0, "creation_date": 1425400542, "post_id": 28835880, "comment_id": 45943550, "body": "Thanks for the fix, I think it would just better if you worded that the loop requires its own thread which implies &gt;1 (GOMAXPROCS) are necessary to be enabled for the scheduler to run the other ones."}, {"owner": {"reputation": 9586, "user_id": 1000282, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/371832f83b79a41443fa50d3793b0cfd?s=128&d=identicon&r=PG", "display_name": "pepper_chico", "link": "https://stackoverflow.com/users/1000282/pepper-chico"}, "edited": false, "score": 0, "creation_date": 1425401466, "post_id": 28835880, "comment_id": 45944180, "body": "send and receive operations in a Go busy loop are not scheduling points? I thought net IO (send/receive?) would be so."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 9586, "user_id": 1000282, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/371832f83b79a41443fa50d3793b0cfd?s=128&d=identicon&r=PG", "display_name": "pepper_chico", "link": "https://stackoverflow.com/users/1000282/pepper-chico"}, "edited": false, "score": 0, "creation_date": 1425404680, "post_id": 28835880, "comment_id": 45946145, "body": "send and receive are channel operations, and they  <i>are</i> scheduling points. Net IO also yields to a scheduler, but there&#39;s no way to create a busy loop around that, you have a function call boundary and the blocking call itself. File IO happens in separate threads, not limited by <code>GOMAXPROCS</code>. In the real world, the only place where this generally maters is a programming error where you have an empty loop."}, {"owner": {"reputation": 9586, "user_id": 1000282, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/371832f83b79a41443fa50d3793b0cfd?s=128&d=identicon&r=PG", "display_name": "pepper_chico", "link": "https://stackoverflow.com/users/1000282/pepper-chico"}, "edited": false, "score": 0, "creation_date": 1425406760, "post_id": 28835880, "comment_id": 45947285, "body": "Hence I asked, your wording seem to imply that &quot;(function calls, send or receive operations)&quot; are example of A: CPU intensive loop with no scheduling points, B: example of scheduling points. From your comment I see you mean the last, except that I didn&#39;t expect plain function calls are subject to the go scheduler (which seems what you meant assuming function calls are example of scheduling points)."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 4, "last_activity_date": 1425409405, "last_edit_date": 1425409405, "creation_date": 1425397415, "answer_id": 28835880, "question_id": 28835758, "link": "https://stackoverflow.com/questions/28835758/go-scheduler-and-cgo-please-explain-this-difference-of-behavior/28835880#28835880", "title": "Go scheduler and CGO: Please explain this difference of behavior?", "body": "<p>The runtime can't preempt a true busy-loop. A CPU intensive loop with no scheduling points has to be in it's own thread for other goroutines to be able to run. Function calls and channel send or receive operations all yield. Network IO is scheduled asynchronously, and file IO gets its own thread. </p>\n\n<p>Generally setting <code>GOMAXPROCS</code> > 1 is sufficient, but since you have 3 of these loops, and only 2 threads, the scheduler is still blocked. If you have a valid CPU intensive loop that is making it difficult to schedule goroutines, you can call <code>runtime.GoSched()</code> periodically to yield to the scheduler. In the real world, the only place where this generally maters is a programming error where you have an empty loop.</p>\n\n<p>All cgo calls happen in their own threads outside of the go runtime, so those loops have no effect on the main loop, other than wasting CPU.  </p>\n"}], "owner": {"reputation": 9586, "user_id": 1000282, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/371832f83b79a41443fa50d3793b0cfd?s=128&d=identicon&r=PG", "display_name": "pepper_chico", "link": "https://stackoverflow.com/users/1000282/pepper-chico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 672, "favorite_count": 1, "accepted_answer_id": 28835880, "answer_count": 1, "score": 1, "last_activity_date": 1425409405, "creation_date": 1425396979, "last_edit_date": 1425397315, "question_id": 28835758, "link": "https://stackoverflow.com/questions/28835758/go-scheduler-and-cgo-please-explain-this-difference-of-behavior", "title": "Go scheduler and CGO: Please explain this difference of behavior?", "body": "<p>I'd like to know the implementation reason for this:</p>\n\n<pre><code>package main\n\nfunc main() {\n    c := make(chan struct{})\n\n    go func() {\n        print(\"a\")\n        for {\n        }\n    }()\n\n    go func() {\n        print(\"b\")\n        for {\n        }\n    }()\n\n    go func() {\n        print(\"c\")\n        c &lt;- struct{}{}\n        for {\n        }\n    }()\n\n    &lt;-c\n}\n\n\u276f\u276f\u276f GOMAXPROCS=2 go run sample1.go                                    \nab  &lt;--- blocks.\n</code></pre>\n\n<hr>\n\n<pre><code>package main\n\n// static void loop() { for(;;); }\nimport \"C\"\n\nfunc main() {\n    c := make(chan struct{})\n\n    go func() {\n        print(\"a\")\n        C.loop()\n        print(\"x\")\n    }()\n\n    go func() {\n        print(\"b\")\n        C.loop()\n        print(\"y\")\n    }()\n\n    go func() {\n        print(\"c\")\n        c &lt;- struct{}{}\n        C.loop()\n        print(\"z\")\n    }()\n\n    &lt;-c\n}\n\n\u276f\u276f\u276f GOMAXPROCS=2 go run sample2.go                                    \nabc  &lt;--- ends gracefully.\n</code></pre>\n\n<p>More specifically I mean how the C tight loop differs from the Go one in the context of go routine scheduling. And even though the C tight loops should be being abruptly terminated at the end of the Go program, I'd like to know whether it's safe to rely on this behavior to start C tasks without blocking the Go program.</p>\n"}, {"tags": ["postgresql", "go"], "answers": [{"comments": [{"owner": {"reputation": 1927, "user_id": 740696, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8e6b6f969d3e9ca3197876b78a5d3747?s=128&d=identicon&r=PG", "display_name": "Casper Beyer", "link": "https://stackoverflow.com/users/740696/casper-beyer"}, "edited": false, "score": 0, "creation_date": 1540180616, "post_id": 28834653, "comment_id": 92753641, "body": "Dead link to rambler."}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "reply_to_user": {"reputation": 1927, "user_id": 740696, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8e6b6f969d3e9ca3197876b78a5d3747?s=128&d=identicon&r=PG", "display_name": "Casper Beyer", "link": "https://stackoverflow.com/users/740696/casper-beyer"}, "edited": false, "score": 0, "creation_date": 1540286540, "post_id": 28834653, "comment_id": 92799005, "body": "Hum\u2026 nope. Github repository is still there\u2026. But Github had a production incident yesterday, with database consistency issues throughout the day."}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": true, "score": 6, "last_activity_date": 1425393806, "creation_date": 1425393806, "answer_id": 28834653, "question_id": 28832831, "link": "https://stackoverflow.com/questions/28832831/execute-sql-script-in-go-directly-from-file-or-string/28834653#28834653", "title": "Execute SQL script in Go directly from file or string", "body": "<p>As far as I know, there isn't a real better method if multiple statement queries aren't allowed. It has nothing to do with the driver you're using, as this is a <code>database/sql</code> package limitation. Debating for whether or not it is a good design is another question (and I'm sure there is plenty already).</p>\n\n<p>On the alternatives side, you could probably use a SQL Schema Migration tool or use inspiration from them. The general convention is to use a semantically inert marker, such as a comment, and split around theses.</p>\n\n<p>For examples in golang, you can see:</p>\n\n<ul>\n<li><a href=\"https://bitbucket.org/liamstask/goose\" rel=\"noreferrer\">goose</a>: full featured, migrations can be written in Go</li>\n<li><a href=\"https://github.com/elwinar/rambler\" rel=\"noreferrer\">rambler</a>: lightweight, SQL-only</li>\n</ul>\n\n<p>Disclaimer: I'm <em>rambler</em>'s developer. That said, you should definitively have a look at <em>goose</em>, which is really cool.</p>\n"}, {"tags": [], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "is_accepted": false, "score": 1, "last_activity_date": 1466146525, "creation_date": 1466146525, "answer_id": 37875015, "question_id": 28832831, "link": "https://stackoverflow.com/questions/28832831/execute-sql-script-in-go-directly-from-file-or-string/37875015#37875015", "title": "Execute SQL script in Go directly from file or string", "body": "<p>Have struggled with the same problem for some time. I needed it for a slightly different reason (initialize the database before running tests).</p>\n\n<p>As Elwinar already mentioned, <code>database/sql</code> package does not allow this. The way I overcame this is by creating a python script (let's call it <code>sql_runner.py</code>) which executes a file and then run a go exec command to execute python script (do not forget to make it executable).</p>\n\n<p>So a python command to run sql file: <code>cursor.execute(open(\"setting_up.sql\"), \"r\").read())</code></p>\n\n<p>And part's of a Go code to run this file:</p>\n\n<pre><code>cmd := exec.Command(\"sql.py\")\n\ncmd.Stdout = os.Stdout\ncmd.Stderr = os.Stderr\nlog.Println(cmd.Run())\n</code></pre>\n"}], "owner": {"reputation": 1751, "user_id": 3973406, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b2d94768947ebd5fd0f38ee5b3f472c5?s=128&d=identicon&r=PG&f=1", "display_name": "Dac0d3r", "link": "https://stackoverflow.com/users/3973406/dac0d3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4231, "favorite_count": 1, "accepted_answer_id": 28834653, "answer_count": 2, "score": 5, "last_activity_date": 1466146525, "creation_date": 1425388697, "last_edit_date": 1425403905, "question_id": 28832831, "link": "https://stackoverflow.com/questions/28832831/execute-sql-script-in-go-directly-from-file-or-string", "title": "Execute SQL script in Go directly from file or string", "body": "<p>In my install script for my application I'm checking to see if the db contains any tables. If the database is empty I have DML and DDL SQL script I'd like to run.</p>\n\n<p>It's not important that it reads the SQL from a seperate .sql file, so right now I've just put it directly into two strings - one for DDL and one for DML - and concatenated those.</p>\n\n<p>My problem now is that I'm now getting this error, when trying to run the script for generating tables and inserting data into them with .Exec(sqlStr):</p>\n\n<pre><code>\"pq: cannot insert multiple commands into a prepared statement\"\n</code></pre>\n\n<p>I can of course do a workaround. Something like:</p>\n\n<pre><code>sqlStr := sqlDML + sqlDDL\nsqlStmtSlice := strings.Split(sqlStr, \";\")\nfor i:= 0; i &lt; len(sqlStmtSlice) i++ {\n    // Exec() each individual statement!\n}\n</code></pre>\n\n<p>However, I'm not sure I like that method at all. Surely there has to be a much better way of just loading a SQL script from file and executing the whole batch, right? Do you know?</p>\n\n<p>Ps. I'm using the PostgreSQL driver for Go, but I don't think that makes any difference.</p>\n\n<p><strong>Edit</strong>:</p>\n\n<p>Since there doesn't seem to be any better solution to get this done at the time, I made a slight improvement to the above pseudo code, which is tested and seems to work just fine:</p>\n\n<pre><code>tx, err := db.Begin()\n\nsqlStr := fmt.Sprintf(sqlDML + sqlDDL)\nsqlStmtSlice := strings.Split(sqlStr, \";\\r\")\n\nif err != nil {\n    return err\n}\n\ndefer func() {\n    _ = tx.Rollback()\n}()\n\nfor _, q := range sqlStmtSlice {\n    _, err := tx.Exec(q)\n\n    if err != nil {\n        return err\n    }\n}\n\nerr = tx.Commit()\n</code></pre>\n"}, {"tags": ["go", "office365"], "answers": [{"tags": [], "owner": {"reputation": 15641, "user_id": 3307985, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bvlg9.jpg?s=128&g=1", "display_name": "Jason Johnston", "link": "https://stackoverflow.com/users/3307985/jason-johnston"}, "is_accepted": true, "score": 2, "last_activity_date": 1425397487, "creation_date": 1425397487, "answer_id": 28835921, "question_id": 28832017, "link": "https://stackoverflow.com/questions/28832017/could-not-retrieve-app-only-tokens-for-office-365/28835921#28835921", "title": "Could not retrieve app only tokens for office 365", "body": "<p>The error indicates there's a problem with your signature. Comparing with a working one, it is way shorter. Be sure you're signing the string with an RSA SHA-256 hash. Using HMAC is probably causing the issue.</p>\n"}], "owner": {"reputation": 95, "user_id": 4540462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14bf078b1e197e17779e63518d2c3fc4?s=128&d=identicon&r=PG&f=1", "display_name": "Aishwarya Gopalakrishnan", "link": "https://stackoverflow.com/users/4540462/aishwarya-gopalakrishnan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1298, "favorite_count": 0, "accepted_answer_id": 28835921, "answer_count": 1, "score": 1, "last_activity_date": 1437924130, "creation_date": 1425386324, "last_edit_date": 1437924130, "question_id": 28832017, "link": "https://stackoverflow.com/questions/28832017/could-not-retrieve-app-only-tokens-for-office-365", "title": "Could not retrieve app only tokens for office 365", "body": "<p>I followed the blog to develop an application that reads mails of users without having them signed in: <a href=\"http://blogs.msdn.com/b/exchangedev/archive/2015/01/21/building-demon-or-service-apps-with-office-365-mail-calendar-and-contacts-apis-oauth2-client-credential-flow.aspx?CommentPosted=true#commentmessage\" rel=\"nofollow\">http://blogs.msdn.com/b/exchangedev/archive/2015/01/21/building-demon-or-service-apps-with-office-365-mail-calendar-and-contacts-apis-oauth2-client-credential-flow.aspx?CommentPosted=true#commentmessage</a>   </p>\n\n<p>I got the id token and got the tenant Id. When i try to get the access token it throws an error:</p>\n\n<pre><code>{\"error\":\"invalid_client\",\"error_description\":\"AADSTS70002: Error validating cre\ndentials. AADSTS50012: Client assertion contains an invalid signature.\\r\\nTrace\nID: 9646a93b-0094-4736-8d21-aed08f04b06e\\r\\nCorrelation ID: 8dd562af-556d-4d90-9\nf71-a60f5a232215\\r\\nTimestamp: 2015-03-03 10:47:25Z\",\"error_codes\":[70002,50012]\n,\"timestamp\":\"2015-03-03 10:47:25Z\",\"trace_id\":\"9646a93b-0094-4736-8d21-aed08f04\nb06e\",\"correlation_id\":\"8dd562af-556d-4d90-9f71-a60f5a232215\",\"submit_url\":null,\n\"context\":null}\n</code></pre>\n\n<p>But I created the certificate as per the instructions. I am not using ADAL library. I am using go language. So i followed the steps in a stack overflow link: <a href=\"https://stackoverflow.com/questions/28351558/office-365-rest-api-daemon-week-authentication\">Office 365 Rest API - Daemon week authentication</a></p>\n\n<p>I signed the string using HMAC base64 encoded it and URL encoded it and then appended to the string as explained in the above post. This is my client assertion </p>\n\n<pre><code>eyJhbGciOiJSUzI1NiIsIng1dCI6IjZlLzEra01scHhuTHArZFJ4d1BqS21EdmZCQT0ifQ.eyJhdWQiOiJodHRwczovL2xvZ2luLndpbmRvd3MubmV0L2ZmNjQxNTFmLTIwM2EtNGM0MC1hZDcxLTExOTE2YjY2Yzg3My9vYXV0aDIvdG9rZW4iLCJleHAiOjE0MjU3Mzc2MDEsImlzcyI6Ijk3MjhiOGFiLTVhOGUtNGM0OC05YTZkLTZmMzFjMWYyZTdkYyIsImp0aSI6IjMyMDZiYWI5LTVmYmUtNDA3ZS02OWY2LTJlNGRjNDQ3NzQxYSIsIm5iZiI6MTQyNTc0MjYwMSwic3ViIjoiOTcyOGI4YWItNWE4ZS00YzQ4LTlhNmQtNmYzMWMxZjJlN2RjIn0.pG4okCzcgXZbS067U9BkGWid6Z6ExU7pbPYOlm2mSAg\n</code></pre>\n\n<p>Where am I going wrong?</p>\n"}, {"tags": ["go", "garbage-collection", "slice"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1425388269, "post_id": 28832016, "comment_id": 45934875, "body": "Sadly, yes. Maybe that&#39;s going to be improved in a future version of the Go language."}], "answers": [{"comments": [{"owner": {"reputation": 2325, "user_id": 1492051, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/07ecac667abb2bfa8d6698dc629bbb54?s=128&d=identicon&r=PG", "display_name": "FPGA", "link": "https://stackoverflow.com/users/1492051/fpga"}, "edited": false, "score": 0, "creation_date": 1425386643, "post_id": 28832096, "comment_id": 45933822, "body": "what if it was a slice of strings?, do i just need to set it to empty string?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2325, "user_id": 1492051, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/07ecac667abb2bfa8d6698dc629bbb54?s=128&d=identicon&r=PG", "display_name": "FPGA", "link": "https://stackoverflow.com/users/1492051/fpga"}, "edited": false, "score": 1, "creation_date": 1425386722, "post_id": 28832096, "comment_id": 45933883, "body": "@FPGA Then the values of the <code>string</code> elements will remain in memory and consume memory."}, {"owner": {"reputation": 2325, "user_id": 1492051, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/07ecac667abb2bfa8d6698dc629bbb54?s=128&d=identicon&r=PG", "display_name": "FPGA", "link": "https://stackoverflow.com/users/1492051/fpga"}, "edited": false, "score": 0, "creation_date": 1425386798, "post_id": 28832096, "comment_id": 45933943, "body": "so in that case i should make it a slice of pointers to strings?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2325, "user_id": 1492051, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/07ecac667abb2bfa8d6698dc629bbb54?s=128&d=identicon&r=PG", "display_name": "FPGA", "link": "https://stackoverflow.com/users/1492051/fpga"}, "edited": false, "score": 1, "creation_date": 1425386947, "post_id": 28832096, "comment_id": 45934017, "body": "@FPGA No, you shoudln&#39;t. What I meant was that if you don&#39;t zero the elements then they will continue to occupy memory. You can zero <code>string</code> elements like this: <code>lines[0] = &quot;&quot;</code> (empty string is the zero element of a <code>string</code>)."}, {"owner": {"reputation": 2325, "user_id": 1492051, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/07ecac667abb2bfa8d6698dc629bbb54?s=128&d=identicon&r=PG", "display_name": "FPGA", "link": "https://stackoverflow.com/users/1492051/fpga"}, "edited": false, "score": 0, "creation_date": 1425387295, "post_id": 28832096, "comment_id": 45934242, "body": "and it does get garbage collected after setting it to empty string?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2325, "user_id": 1492051, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/07ecac667abb2bfa8d6698dc629bbb54?s=128&d=identicon&r=PG", "display_name": "FPGA", "link": "https://stackoverflow.com/users/1492051/fpga"}, "edited": false, "score": 1, "creation_date": 1425387488, "post_id": 28832096, "comment_id": 45934357, "body": "@FPGA Yes, if there are no other refernences to it."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1425387931, "last_edit_date": 1495541571, "creation_date": 1425386509, "answer_id": 28832096, "question_id": 28832016, "link": "https://stackoverflow.com/questions/28832016/re-slicing-and-garbage-collection/28832096#28832096", "title": "Re-slicing and garbage collection", "body": "<p>Short answer: yes.</p>\n\n<p>After reslicing a slice or array, elements that are not visible in the new slice are not zeroed automatically. And since the backing array is kept in memory, so are the elements stored in them.</p>\n\n<p>See <a href=\"https://stackoverflow.com/a/28432812/1705598\">this answer</a> for more details. Quoting the relevant part:</p>\n\n<blockquote>\n  <p>Also another very important thing is that if an element is popped from the front, the slice will be resliced and not contain a reference to the popped element, but since the underlying array still contains that value, the value will also remain in memory (not just the array). It is recommended that whenever an element is popped or removed from your queue (slice/array), <strong>always zero</strong> it (its respective element in the slice) so the value will not remain in memory needlessly. This becomes even more critical if your slice contains pointers to big data structures.</p>\n</blockquote>\n\n<p><strong>Update:</strong></p>\n\n<p>Your updated code could be zeroed this way:</p>\n\n<pre><code>strings:=[]string{\"a\",\"b\",\"c\",\"d\"}\n// IMPORTANT: zero before reslicing:\nstrings[0] = \"\" // Empty string is the zero value of string\nstrings = strings[1:]\n</code></pre>\n\n<p>Note: Making a copy of the element(s) and zeroing them <strong>does not</strong> zero the values in array, so this has no effect:</p>\n\n<pre><code>strings:=[]string{\"a\",\"b\",\"c\",\"d\"}\nstring0:= strings[0]\nstrings = strings[1:]\n\n// This has no effect on the array, it just zeroes the variable string0\nstring0 = \"\"\n</code></pre>\n"}], "owner": {"reputation": 2325, "user_id": 1492051, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/07ecac667abb2bfa8d6698dc629bbb54?s=128&d=identicon&r=PG", "display_name": "FPGA", "link": "https://stackoverflow.com/users/1492051/fpga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 0, "accepted_answer_id": 28832096, "answer_count": 1, "score": 2, "last_activity_date": 1425399071, "creation_date": 1425386322, "last_edit_date": 1425399071, "question_id": 28832016, "link": "https://stackoverflow.com/questions/28832016/re-slicing-and-garbage-collection", "title": "Re-slicing and garbage collection", "body": "<p>When re-slicing, do i need to set the elements that are not in the slice anymore to nil,does it have any effect on garbage collection? </p>\n\n<pre><code>type X struct {\n  Value   string\n}\n\nfunc main() {\n    Xs:=[]*X{&amp;X{\"a\"},&amp;X{\"b\"},&amp;X{\"c\"},&amp;X{\"d\"}}\n    X0:= Xs[0]\n    Xs[0] = nil //does this line has any effect on the garbage collector,is it necessary?\n    Xs= Xs[1:]\n}\n</code></pre>\n\n<p><strong>Update</strong>:</p>\n\n<pre><code>strings:=[]string{\"a\",\"b\",\"c\",\"d\"}\nstring0:= strings[0]\n//how do i zero strings[0]?\nstrings = strings[1:]\n</code></pre>\n"}, {"tags": ["http", "go"], "answers": [{"comments": [{"owner": {"reputation": 6155, "user_id": 4378314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7935867003690df779b06563293f6293?s=128&d=identicon&r=PG", "display_name": "MarsAndBack", "link": "https://stackoverflow.com/users/4378314/marsandback"}, "edited": false, "score": 0, "creation_date": 1512514434, "post_id": 28831783, "comment_id": 82287277, "body": "This saved me!  Banging my head following all kinds of SO threads, wondering what&#39;s going on. Thx"}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": true, "score": 6, "last_activity_date": 1425385487, "creation_date": 1425385487, "answer_id": 28831783, "question_id": 28831190, "link": "https://stackoverflow.com/questions/28831190/routes-returning-404-for-mux-gorilla/28831783#28831783", "title": "Routes returning 404 for mux gorilla", "body": "<p>Gorilla's mux routes are evaluated in the order in which they are added. Therefore, the first route to match the request is used.</p>\n\n<p>In your case, the <code>/</code> handler will match every incoming request, then look for the file in the <code>frontend/</code> directory, then display a 404 error. You just need to swap your routes order to get it running:</p>\n\n<pre><code>router := mux.NewRouter().StrictSlash(true)\nrouter.HandleFunc(\"/api/abc/{id}\", AbcShow)\nrouter.HandleFunc(\"/api/abc\", AbcIndex)\nrouter.HandleFunc(\"/api\", Abc)\nrouter.PathPrefix(\"/\").Handler(http.FileServer(http.Dir(\"./frontend/\")))\nhttp.Handle(\"/\", router)\n</code></pre>\n"}], "owner": {"reputation": 9113, "user_id": 146003, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/272ed3d9a5c9813ed1fad7ab8f512576?s=128&d=identicon&r=PG", "display_name": "Atmocreations", "link": "https://stackoverflow.com/users/146003/atmocreations"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2459, "favorite_count": 0, "accepted_answer_id": 28831783, "answer_count": 1, "score": 2, "last_activity_date": 1425385487, "creation_date": 1425383691, "question_id": 28831190, "link": "https://stackoverflow.com/questions/28831190/routes-returning-404-for-mux-gorilla", "title": "Routes returning 404 for mux gorilla", "body": "<p>In my Go application, I'm using gorilla/mux.</p>\n\n<p>I would like to have</p>\n\n<p><code>http://host:3000/</code> to be serving files statically from the subdirectory \"frontend\" <strong>and</strong>\n<code>http://host:3000/api/</code> and its subpaths being served by the specified functions.</p>\n\n<p>With the following code, neither of the calls work.\n<code>/index.html</code> is the only one that doesn (but not the resources being loaded by it). What am I doing wrong?</p>\n\n<pre><code>package main\n\nimport (\n  \"log\"\n  \"net/http\"\n  \"fmt\"\n  \"strconv\"\n  \"github.com/gorilla/mux\"\n)\n\nfunc main() {\n  routineQuit := make(chan int)\n\n  router := mux.NewRouter().StrictSlash(true)\n  router.PathPrefix(\"/\").Handler(http.FileServer(http.Dir(\"./frontend/\")))\n  router.HandleFunc(\"/api\", Index)\n  router.HandleFunc(\"/api/abc\", AbcIndex)\n  router.HandleFunc(\"/api/abc/{id}\", AbcShow)\n  http.Handle(\"/\", router)\n  http.ListenAndServe(\":\" + strconv.Itoa(3000), router)\n\n  &lt;- routineQuit\n}\n\nfunc Abc(w http.ResponseWriter, r *http.Request) {\n  fmt.Fprintln(w, \"Index!\")\n}\n\nfunc AbcIndex(w http.ResponseWriter, r *http.Request) {\n  fmt.Fprintln(w, \"Todo Index!\")\n}\n\nfunc AbcShow(w http.ResponseWriter, r *http.Request) {\n  vars := mux.Vars(r)\n  todoId := vars[\"todoId\"]\n  fmt.Fprintln(w, \"Todo show:\", todoId)\n}\n</code></pre>\n"}, {"tags": ["arrays", "loops", "go", "slice"], "answers": [{"tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": true, "score": 3, "last_activity_date": 1425384997, "last_edit_date": 1425384997, "creation_date": 1425384574, "answer_id": 28831495, "question_id": 28831158, "link": "https://stackoverflow.com/questions/28831158/when-populating-a-slice-with-length-set-at-runtime-do-i-absolutely-need-two-loo/28831495#28831495", "title": "When populating a slice with length set at runtime, do I absolutely need two loops, one for determining the length and one for populating?", "body": "<p>You don't. Golang slices are dynamic arrays (don't confuse them for the actual arrays). You should (re-)read the excellent <a href=\"http://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow\">golang slice internals</a> blog post about it.</p>\n\n<p>Here is your example rewritten in a more idiomatic way:</p>\n\n<pre><code>func removeAndIndexPunctuation(word string) (string, []rune, []int) {\n    var punctuations []rune\n    var indexes []int\n\n    for i, char := range word {\n        if unicode.IsPunct(char) {\n            punctuations = append(punctuations, char)\n            indexes = append(indexes, i)\n        }\n    }\n\n    // Remove all punctuation from word string\n    res := r.ReplaceAllString(word, \"\")\n    return res, punctuations, indexes\n}\n</code></pre>\n\n<p>Note that I don't think the use of <code>regex</code> is particularly relevant here. Here is another version using a slice of runes:</p>\n\n<pre><code>func removeAndIndexPunctuation(word string) (string, []rune, []int) {\n    var punctuations []rune\n    var indexes []int\n    var result []rune\n\n    for i, char := range word {\n        if unicode.IsPunct(char) {\n            punctuations = append(punctuations, char)\n            indexes = append(indexes, i)\n        } else {\n            result = append(result, char)\n        }\n    }\n\n    return string(result), punctuations, indexes\n}\n</code></pre>\n"}], "owner": {"reputation": 1897, "user_id": 473368, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e24aa1cfabf417ef8833ea8721a66a8?s=128&d=identicon&r=PG", "display_name": "01AutoMonkey", "link": "https://stackoverflow.com/users/473368/01automonkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 28831495, "answer_count": 1, "score": 0, "last_activity_date": 1425384997, "creation_date": 1425383608, "question_id": 28831158, "link": "https://stackoverflow.com/questions/28831158/when-populating-a-slice-with-length-set-at-runtime-do-i-absolutely-need-two-loo", "title": "When populating a slice with length set at runtime, do I absolutely need two loops, one for determining the length and one for populating?", "body": "<p>So I have a function that removes punctuation from a string and puts those punctuation characters and their index into two slices:</p>\n\n<pre><code>func removeAndIndexPunctuation(word string) (string, []rune, []int) {\n    // Index punctuation\n    numberOfPunct := 0\n    for _, char := range word {\n        if unicode.IsPunct(char) {\n            numberOfPunct += 1\n        }\n    }\n\n    punctuations := make([]rune, numberOfPunct)\n    punctuationIndex := make([]int, numberOfPunct)\n\n    x := 0\n    for i, char := range word {\n        if unicode.IsPunct(char) {\n            punctuations[x] = char\n            punctuationIndex[x] = i\n            x += 1\n        }\n    }\n\n    // Remove all punctuation from word string\n    res := r.ReplaceAllString(word, \"\")\n    return res, punctuations, punctuationIndex\n}\n</code></pre>\n\n<p>In order to make and populate the slices I have to run two for loops, one for counting the number of punctuations so I can make the array the correct length and then another that's pretty much the same except now I populate the slices.</p>\n\n<p>In Python though I don't need two for loops since Python supports \"dynamic arrays\": </p>\n\n<pre><code>def removeAndIndexPunctuation(word):\n    punctuations = []\n    # Index punctuation\n    for i, char in enumerate(word):\n        if char in string.punctuation:\n            punctuations.append((char, i))\n    # Remove all punctuation from word string\n    word = word.encode(\"utf-8\").translate(None, string.punctuation).decode(\"utf-8\")\n    return word, punctuations\n</code></pre>\n\n<p>So I just want to make sure, in this case in golang, do I absolutely need two for loops because it doesn't support dynamic arrays or am I missing something? Or in other words, If I'm looping over a set of characters and adding some to an array/slice, do I really need two loops, one for counting the number of characters for setting the length of the slice, and one for populating the slice?</p>\n\n<p>I come from Python and am learning Go.</p>\n"}, {"tags": ["sockets", "tcp", "go"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1425382865, "post_id": 28830549, "comment_id": 45931586, "body": "There is the issue of OS write buffer, and TCP no-delay (the default is to not delay packets, but you might have set it otherwise), and other factors that can cause a write not to actually send packets to the other side."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 2, "last_activity_date": 1425395715, "creation_date": 1425395715, "answer_id": 28835339, "question_id": 28830549, "link": "https://stackoverflow.com/questions/28830549/golang-write-net-conn-without-returning-error-but-the-other-side-of-the-socket-c/28835339#28835339", "title": "golang write net conn without returning error but the other side of the socket can&#39;t receive data", "body": "<p>This is a function of how the TCP protocol works. There's is no way to determine if you're sending to a closed socket before hand (even if there were, sending and closing would race).</p>\n\n<p>If a remote socket is closed, you will eventually get an error, <code>broken pipe</code> or <code>connection reset by peer</code>. Simply because of the berkley socket api, you often won't see this until your second send operation. This relies on the remote host responding with an RST, or an intermediary sending an ICMP signal, so it still is possible that if the packets are delayed or lost, and you can continue sending without an error. </p>\n\n<p>The only way to reliably detect a closed connection is to Read from a connection, and and get a 0 byte response, which go translates to EOF. </p>\n"}], "owner": {"reputation": 41, "user_id": 1781824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b9942966f596b0c00712d1ea62e0646?s=128&d=identicon&r=PG", "display_name": "justmao945", "link": "https://stackoverflow.com/users/1781824/justmao945"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1785, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1425395715, "creation_date": 1425381687, "question_id": 28830549, "link": "https://stackoverflow.com/questions/28830549/golang-write-net-conn-without-returning-error-but-the-other-side-of-the-socket-c", "title": "golang write net conn without returning error but the other side of the socket can&#39;t receive data", "body": "<pre><code>// only Data\nfunc (self *Packet) WriteData(w io.Writer) error {\n    n := len(self.Data)\n    data := self.Data[0:n]\n    for n &gt; 0 {\n        wn, err := w.Write(data)\n        data = data[wn:n]\n        n -= wn\n        if err != nil {\n            return err\n        }\n    }\n    return nil\n}\n</code></pre>\n\n<p>When I call the WriteData function with a net.Conn (created by net.Dial(\"tcp\")), it returns nil but the other port of the socket can't receive the sent data sometimes.</p>\n\n<p>It seems the connection was broken, but w.Write still returns without error.</p>\n\n<p>In my mind w.Write shouldn't return without error when the other side of this socket doesn't receive the packet, so is there something I missed?</p>\n"}, {"tags": ["templates", "go", "go-templates"], "answers": [{"comments": [{"owner": {"reputation": 253, "user_id": 4611478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99f943e18102d1616bccc1756ad9fe38?s=128&d=identicon&r=PG&f=1", "display_name": "user4611478", "link": "https://stackoverflow.com/users/4611478/user4611478"}, "edited": false, "score": 2, "creation_date": 1425386654, "post_id": 28831138, "comment_id": 45933830, "body": "Thanks, @icza. Really, I&#39;m panicking now :). I thought easy way exists. Your variants are very good, but in my situation I prefer using like this <code>{{ if .IsArticle }}{{ template &quot;article&quot; . }}{{ else }}{{ template &quot;page&quot; .}}{{ end }}</code>. Where <code>IsArticle</code> bool flag based on user request (URL)."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 253, "user_id": 4611478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99f943e18102d1616bccc1756ad9fe38?s=128&d=identicon&r=PG&f=1", "display_name": "user4611478", "link": "https://stackoverflow.com/users/4611478/user4611478"}, "edited": false, "score": 2, "creation_date": 1425386860, "post_id": 28831138, "comment_id": 45933972, "body": "@user4611478 That is also a very good alternative if you know the template names prior and it is not an exhausting list. I include it in the answer if you don&#39;t mind."}, {"owner": {"reputation": 526, "user_id": 1035977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/310abc9d873d41cede1258891d6bcaf3?s=128&d=identicon&r=PG", "display_name": "Gwyneth Llewelyn", "link": "https://stackoverflow.com/users/1035977/gwyneth-llewelyn"}, "edited": false, "score": 0, "creation_date": 1499767869, "post_id": 28831138, "comment_id": 77036749, "body": "Thank you, two years later I have asked myself how to deal with this situation and it really seems that using a bunch of <code>{{ if }}</code> is really the way to go..."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 19, "last_activity_date": 1506245156, "last_edit_date": 1506245156, "creation_date": 1425383543, "answer_id": 28831138, "question_id": 28830543, "link": "https://stackoverflow.com/questions/28830543/how-to-use-a-field-of-struct-or-variable-value-as-template-name/28831138#28831138", "title": "How to use a field of struct or variable value as template name?", "body": "<p>Unfortunately you can't.</p>\n\n<p>The syntax of the <code>{{template}}</code> action:</p>\n\n<pre><code>{{template \"name\"}}\n    The template with the specified name is executed with nil data.\n\n{{template \"name\" pipeline}}\n    The template with the specified name is executed with dot set\n    to the value of the pipeline.\n</code></pre>\n\n<p>The name of the template to be included is a <em>constant</em> string, it is not a <em>pipeline</em> which could vary during execution based on parameters.</p>\n\n<p>If the allowed syntax would be:</p>\n\n<pre><code>{{template pipeline}}\n</code></pre>\n\n<p>then you could use something like <code>{{template .TemplName}}</code> but since the syntax only allows a constant string, you can't.</p>\n\n<p>Reasoning from Rob why dynamic template invocation is not allowed (<a href=\"https://groups.google.com/forum/#!topic/golang-nuts/PRLloHrJrDU/discussion\" rel=\"noreferrer\">source</a>):</p>\n\n<blockquote>\n  <p>We want the template language to be statically analyzable so the context of a template's invocation is clear, checkable, and lockdownable.  If an invocation point is totally dynamic, this can't be done. Similarly, if a template can belong to multiple sets, its context can differ between sets in a way that would require all sets to be analyzed simultaneously.  Since both these constraints are easy to work around if you want to, at the cost of losing those static checks in a higher-level package, it seemed wise to control the situation in the base template implementation. A higher-level package, such as a hypothetical HTML-only wrapper, can guarantee no workarounds more easily if the constraints are clear.</p>\n</blockquote>\n\n<h2>Alternative #1: Execute Includable Template First</h2>\n\n<p>What you can do is execute the template you would want to include first, and insert the result where you want to include it. You can use special types not to escape the result of the inner template when inserting, for example <a href=\"http://golang.org/pkg/html/template/#HTML\" rel=\"noreferrer\"><code>html.HTML</code></a> in case of HTML templates.</p>\n\n<p>See this example:</p>\n\n<pre><code>func main() {\n    t := template.Must(template.New(\"t\").Parse(t))\n    template.Must(t.New(\"t1\").Parse(t1))\n\n    params := struct {\n        Name  string\n        Value interface{}\n    }{\"t1\", nil}\n    b := bytes.Buffer{}\n    t.ExecuteTemplate(&amp;b, params.Name, nil)\n    params.Value = template.HTML(b.String())\n\n    t.Execute(os.Stdout, params)\n}\n\nconst t = `&lt;html&gt;&lt;body&gt;\nNow I will include template with name: {{.Name}}\n{{.Value}}\n&lt;/body&gt;/html&gt;`\n\nconst t1 = `I'm template &lt;b&gt;t1&lt;/b&gt;.`\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>&lt;html&gt;&lt;body&gt;\nNow I will include template with name: t1\nI'm template &lt;b&gt;t1&lt;/b&gt;.\n&lt;/body&gt;/html&gt;\n</code></pre>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/rKxAf5eM-V\" rel=\"noreferrer\">Go Playground</a>.</p>\n\n<p>The result of template <code>t1</code> was inserted unescaped. If you leave out <code>template.HTML</code>:</p>\n\n<pre><code>params.Value = b.String()\n</code></pre>\n\n<p><code>t1</code> would be inserted escaped, like this:</p>\n\n<pre><code>&lt;html&gt;&lt;body&gt;\nNow I will include template with name: t1\nI&amp;#39;m template &amp;lt;b&amp;gt;t1&amp;lt;/b&amp;gt;.\n&lt;/body&gt;/html&gt;\n</code></pre>\n\n<h2>Alternative #2: Restructure Templates</h2>\n\n<p>You can restructure your templates not to be in situations where you would want to include a template with varying names.</p>\n\n<p>Example: you might want to create pages where you have a <code>page</code> template something like this:</p>\n\n<pre><code>&lt;html&gt;&lt;body&gt;\n    Title, headers etc.\n    {{template .Page}}\n    Footers\n&lt;/body&gt;&lt;/html&gt;\n</code></pre>\n\n<p>You can restructure it to be something like this:</p>\n\n<p><code>header</code> template:</p>\n\n<pre><code>&lt;html&gt;&lt;body&gt;\n    Title, headers, etc.\n</code></pre>\n\n<p><code>footer</code> template:</p>\n\n<pre><code>    Footers\n&lt;/body&gt;&lt;/html\n</code></pre>\n\n<p>And your page templates would include <code>header</code> and <code>footer</code> like this:</p>\n\n<pre><code>{{template \"header\" .}}\n    Page content comes here.\n{{template \"footer\" .}}\n</code></pre>\n\n<h2>Alternative #3: Use <code>{{if}}</code> action and predefined names</h2>\n\n<p>If you know the template names prior and it is not an exhausting list, you can use the <code>{{if}}</code> template action to include the desired template. Example:</p>\n\n<pre><code>{{if eq .Name \"page1\"}}\n\n    {{template \"page1\" .}}\n\n{{else if eq .Name \"page2\"}}\n\n    {{template \"page2\" .}}\n    ...\n\n{{end}}\n</code></pre>\n\n<h2>Alternative #4: Modifying the static template text</h2>\n\n<p>The idea here is that you could modify the static text of the outer template manually and insert the name of the inner template you want to include.</p>\n\n<p>The downside of this method is that after inserting the name of the inner template, you have to re-parse the template, so I don't recommend this.</p>\n"}], "owner": {"reputation": 253, "user_id": 4611478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99f943e18102d1616bccc1756ad9fe38?s=128&d=identicon&r=PG&f=1", "display_name": "user4611478", "link": "https://stackoverflow.com/users/4611478/user4611478"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3124, "favorite_count": 5, "accepted_answer_id": 28831138, "answer_count": 1, "score": 11, "last_activity_date": 1506245156, "creation_date": 1425381670, "last_edit_date": 1473066825, "question_id": 28830543, "link": "https://stackoverflow.com/questions/28830543/how-to-use-a-field-of-struct-or-variable-value-as-template-name", "title": "How to use a field of struct or variable value as template name?", "body": "<p>We can define template name via <code>{{define \"home\"}}</code>, and then load it in other (parent) template via <code>{{template \"home\"}}</code>.</p>\n\n<p>How I can load template via variable value <code>{{template .TemplateName}}</code>. Or it's impossible?</p>\n"}, {"tags": ["go", "slice", "contains"], "answers": [{"tags": [], "owner": {"reputation": 5024, "user_id": 1419891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bb825cd3f1905f42c16408393480a65b?s=128&d=identicon&r=PG", "display_name": "425nesp", "link": "https://stackoverflow.com/users/1419891/425nesp"}, "is_accepted": false, "score": 0, "last_activity_date": 1425377636, "creation_date": 1425377636, "answer_id": 28829126, "question_id": 28828440, "link": "https://stackoverflow.com/questions/28828440/is-there-a-way-to-write-generic-code-to-find-out-whether-a-slice-contains-specif/28829126#28829126", "title": "Is there a way to write generic code to find out whether a slice contains specific element in Go?", "body": "<p>I'm not sure what your specific context is, but you'll probably want to use a <code>map</code> to check if something already exists.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype PublicClassObjectBuilderFactoryStructure struct {\n    Tee string\n    Hee string\n}\n\nfunc main() {\n    // Empty structs occupy zero bytes.\n    mymap := map[interface{}]struct{}{}\n\n    one := PublicClassObjectBuilderFactoryStructure{Tee: \"hi\", Hee: \"hey\"}\n    two := PublicClassObjectBuilderFactoryStructure{Tee: \"hola\", Hee: \"oye\"}\n\n    three := PublicClassObjectBuilderFactoryStructure{Tee: \"hi\", Hee: \"again\"}\n\n    mymap[one] = struct{}{}\n    mymap[two] = struct{}{}\n\n    // The underscore is ignoring the value, which is an empty struct.\n    if _, exists := mymap[one]; exists {\n        fmt.Println(\"one exists\")\n    }\n\n    if _, exists := mymap[two]; exists {\n        fmt.Println(\"two exists\")\n    }\n\n    if _, exists := mymap[three]; exists {\n        fmt.Println(\"three exists\")\n    }\n}\n</code></pre>\n\n<p>Another advantage of using maps instead of a slice is that there is a built-in <code>delete</code> function for maps. <a href=\"https://play.golang.org/p/dmSyyryyS8\" rel=\"nofollow\">https://play.golang.org/p/dmSyyryyS8</a></p>\n"}, {"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 3, "last_activity_date": 1425377760, "creation_date": 1425377760, "answer_id": 28829175, "question_id": 28828440, "link": "https://stackoverflow.com/questions/28828440/is-there-a-way-to-write-generic-code-to-find-out-whether-a-slice-contains-specif/28829175#28829175", "title": "Is there a way to write generic code to find out whether a slice contains specific element in Go?", "body": "<p>You can make it using the <a href=\"http://golang.org/pkg/reflect/\" rel=\"nofollow\"><code>reflect</code></a> package like that:</p>\n\n<pre><code>func In(s, e interface{}) bool {\n    slice, elem := reflect.ValueOf(s), reflect.ValueOf(e)\n    for i := 0; i &lt; slice.Len(); i++ {\n        if reflect.DeepEqual(slice.Index(i).Interface(), elem.Interface()) {\n            return true\n        }\n    }\n    return false\n}\n</code></pre>\n\n<p>Playground examples: <a href=\"http://play.golang.org/p/TQrmwIk6B4\" rel=\"nofollow\">http://play.golang.org/p/TQrmwIk6B4</a></p>\n\n<p>Alternatively, you can:</p>\n\n<ul>\n<li>define an interface and make your slices implement it</li>\n<li>use maps instead of slices</li>\n<li>just write a simple for loop</li>\n</ul>\n\n<p>What way to choose depends on the problem you are solving.</p>\n"}, {"tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 4, "last_activity_date": 1425378370, "last_edit_date": 1425378370, "creation_date": 1425377914, "answer_id": 28829237, "question_id": 28828440, "link": "https://stackoverflow.com/questions/28828440/is-there-a-way-to-write-generic-code-to-find-out-whether-a-slice-contains-specif/28829237#28829237", "title": "Is there a way to write generic code to find out whether a slice contains specific element in Go?", "body": "<p>You can do it with <code>reflect</code>, but it will be <em>MUCH SLOWER</em> than a non-generic equivalent function:</p>\n\n<pre><code>func Contains(slice, elem interface{}) bool {\n\n    sv := reflect.ValueOf(slice)\n\n    // Check that slice is actually a slice/array. \n    // you might want to return an error here\n    if sv.Kind() != reflect.Slice &amp;&amp; sv.Kind() != reflect.Array {\n        return false\n    }\n\n    // iterate the slice\n    for i := 0; i &lt; sv.Len(); i++ {\n\n        // compare elem to the current slice element\n        if elem == sv.Index(i).Interface() {\n            return true\n        }\n    }\n\n    // nothing found\n    return false\n\n\n}\n\nfunc main(){\n    si := []int {3, 4, 5, 10, 11}\n    ss := []string {\"hello\", \"world\", \"foo\", \"bar\"}\n\n    fmt.Println(Contains(si, 3))\n    fmt.Println(Contains(si, 100))\n    fmt.Println(Contains(ss, \"hello\"))\n    fmt.Println(Contains(ss, \"baz\"))\n\n}\n</code></pre>\n\n<p>How much slower? <strong>about x50-x60 slower</strong>:\nBenchmarking against a non generic function of the form:</p>\n\n<pre><code>func ContainsNonGeneic(slice []int, elem int) bool {\n    for _, i := range slice {\n        if i == elem {\n            return true\n        }\n    }\n    return false\n}\n</code></pre>\n\n<p>I'm getting:</p>\n\n<ul>\n<li>Generic: <code>N=100000, running time: 73.023214ms 730.23214 ns/op</code></li>\n<li>Non Generic: <code>N=100000, running time: 1.315262ms 13.15262 ns/op</code></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "is_accepted": false, "score": 0, "last_activity_date": 1425476642, "creation_date": 1425476642, "answer_id": 28856029, "question_id": 28828440, "link": "https://stackoverflow.com/questions/28828440/is-there-a-way-to-write-generic-code-to-find-out-whether-a-slice-contains-specif/28856029#28856029", "title": "Is there a way to write generic code to find out whether a slice contains specific element in Go?", "body": "<p>If you want a rather different solution, you might try the code-generator approach offered by tools such as <a href=\"http://clipperhouse.github.io/gen/slice/#first\" rel=\"nofollow\">Gen</a>. Gen writes source code for each concrete class you want to hold in a slice, so it supports type-safe slices that let you search for the <a href=\"http://clipperhouse.github.io/gen/slice/#first\" rel=\"nofollow\">first match of an element</a>.</p>\n\n<p>(Gen also offers a few other kinds of collection and allows you to write your own.)</p>\n"}], "owner": {"reputation": 6945, "user_id": 2288944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/7qryD.jpg?s=128&g=1", "display_name": "armnotstrong", "link": "https://stackoverflow.com/users/2288944/armnotstrong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 28829237, "answer_count": 4, "score": 3, "last_activity_date": 1470220204, "creation_date": 1425375613, "last_edit_date": 1470220204, "question_id": 28828440, "link": "https://stackoverflow.com/questions/28828440/is-there-a-way-to-write-generic-code-to-find-out-whether-a-slice-contains-specif", "title": "Is there a way to write generic code to find out whether a slice contains specific element in Go?", "body": "<p>I want to know is there a generic way to write code to judge whether a slice contains an element, I find it will frequently useful since there is a lot of logic to fist judge whether specific elem is already in a slice and then decide what to do next. But there seemed not a built-in method for that(For God's sake, why?)</p>\n\n<p>I try to use <code>interface{}</code> to do that like:</p>\n\n<pre><code>func sliceContains(slice []interface{}, elem interface{}) bool {\n    for _, item := range slice {\n       if item == elem {\n          return true\n       }\n    }\n    return false\n}\n</code></pre>\n\n<p>I thought <code>interface{}</code> is sort of like <code>Object</code> of Java, but apparently, I was wrong. Should I write this every time meet with a new struct of slice? Isn't there a generic way to do this?</p>\n"}, {"tags": ["nginx", "go", "websocket", "gorilla"], "answers": [{"comments": [{"owner": {"reputation": 3137, "user_id": 2112259, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2WwTg.jpg?s=128&g=1", "display_name": "Max Yari", "link": "https://stackoverflow.com/users/2112259/max-yari"}, "edited": false, "score": 0, "creation_date": 1431174102, "post_id": 28829907, "comment_id": 48388436, "body": "So far so good, You never know, when dude going to share some wisdom with you. Thanks dude!"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 3137, "user_id": 2112259, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2WwTg.jpg?s=128&g=1", "display_name": "Max Yari", "link": "https://stackoverflow.com/users/2112259/max-yari"}, "edited": false, "score": 1, "creation_date": 1431184857, "post_id": 28829907, "comment_id": 48391938, "body": "@MaxYari The Dude Abides"}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 37, "last_activity_date": 1425379868, "creation_date": 1425379868, "answer_id": 28829907, "question_id": 28828332, "link": "https://stackoverflow.com/questions/28828332/gorilla-websocket-disconnects-after-a-minute/28829907#28829907", "title": "Gorilla WebSocket disconnects after a minute", "body": "<p>I had the same issue, the problem is the nginx configuration. It defaults to a 1 minute read timeout for <code>proxy_pass</code>:</p>\n\n<blockquote>\n  <p>Syntax:   proxy_read_timeout time;</p>\n  \n  <p>Default: proxy_read_timeout 60s;</p>\n  \n  <p>Context: http, server, location</p>\n</blockquote>\n\n<p>See <a href=\"http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_read_timeout\" rel=\"noreferrer\">http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_read_timeout</a></p>\n\n<p>In my case I've increased the timeout to 10 hours:</p>\n\n<p><code>proxy_read_timeout  36000s;</code></p>\n"}], "owner": {"reputation": 5024, "user_id": 1419891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bb825cd3f1905f42c16408393480a65b?s=128&d=identicon&r=PG", "display_name": "425nesp", "link": "https://stackoverflow.com/users/1419891/425nesp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8366, "favorite_count": 5, "accepted_answer_id": 28829907, "answer_count": 1, "score": 11, "last_activity_date": 1425379868, "creation_date": 1425375265, "last_edit_date": 1425375682, "question_id": 28828332, "link": "https://stackoverflow.com/questions/28828332/gorilla-websocket-disconnects-after-a-minute", "title": "Gorilla WebSocket disconnects after a minute", "body": "<p>I'm using Go (Golang) 1.4.2 with Gorilla WebSockets behind an nginx 1.4.6 reverse proxy. My WebSockets are disconnecting after about a minute of having the page open. Same behavior occurs on Chrome and Firefox.</p>\n\n<p>At first, I had problems connecting the server and client with WebSockets. Then, I read that I needed to tweak my nginx configuration. This is what I have.</p>\n\n<pre><code>server {\n    listen 80;\n    server_name example.com;\n\n    proxy_pass_header Server;\n\n    location / {\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forward-Proto $scheme;\n\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n\n        proxy_pass http://127.0.0.1:1234;\n    }\n}\n</code></pre>\n\n<p>My Go code is basically echoing back the client's message. (Errors omitted for brevity). This is my <code>HandleFunc</code>.</p>\n\n<pre><code>var up = websocket.Upgrader{\n    ReadBufferSize:  1024,\n    WriteBufferSize: 1024,\n}\n\nws, _ := up.Upgrade(resp, req, nil)\ndefer ws.Close()\n\nvar s struct {\n    Foo string\n    Bar string\n}\n\nfor {\n    ws.ReadJSON(&amp;s)\n    ws.WriteJSON(s)\n}\n</code></pre>\n\n<p>The JavaScript is pretty simple as well.</p>\n\n<pre><code>var ws = new WebSocket(\"ws://example.com/ws/\");\nws.addEventListener(\"message\", function(evnt) {\n    console.log(JSON.parse(evnt.data));\n});\n\nvar s = {\n    Foo: \"hello\",\n    Bar: \"world\"\n};\nws.send(JSON.stringify(s));\n</code></pre>\n\n<p>Go is reporting <code>websocket: close 1006 unexpected EOF</code>. I know that when I leave or refresh the page <code>ReadJSON</code> returns <code>EOF</code>, but this appears to be a different error. Also, the unexpected EOF happens by itself after about a minute of having the page open.</p>\n\n<p>I have an <code>onerror</code> function in JavaScript. That event doesn't fire, but <code>onclose</code> fires instead.</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 10668, "user_id": 3000179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8c01224502223a420219f7f3531505d?s=128&d=identicon&r=PG", "display_name": "\u02b0\u1d48\u02d1", "link": "https://stackoverflow.com/users/3000179/%ca%b0%e1%b5%88%cb%91"}, "edited": false, "score": 0, "creation_date": 1425372107, "post_id": 28827207, "comment_id": 45925043, "body": "Do you need to match <code>third paragraph</code> too? Or just the first 2?"}, {"owner": {"reputation": 47383, "user_id": 122536, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6fd51ed284bddf7eeab9de416359021e?s=128&d=identicon&r=PG", "display_name": "alexchenco", "link": "https://stackoverflow.com/users/122536/alexchenco"}, "reply_to_user": {"reputation": 10668, "user_id": 3000179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8c01224502223a420219f7f3531505d?s=128&d=identicon&r=PG", "display_name": "\u02b0\u1d48\u02d1", "link": "https://stackoverflow.com/users/3000179/%ca%b0%e1%b5%88%cb%91"}, "edited": false, "score": 0, "creation_date": 1425373308, "post_id": 28827207, "comment_id": 45925629, "body": "@\u02b0\u1d48\u02d1 Yeah, I just realized that problem. No need for now. I&#39;ll figure out that later."}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 1, "creation_date": 1425374187, "post_id": 28827207, "comment_id": 45926173, "body": "Is regex a requirement? It seems overkill..."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 1, "last_activity_date": 1425376521, "creation_date": 1425376521, "answer_id": 28828753, "question_id": 28827207, "link": "https://stackoverflow.com/questions/28827207/matching-paragraphs-in-go/28828753#28828753", "title": "Matching paragraphs in Go", "body": "<p>You can try, using a <a href=\"https://code.google.com/p/re2/wiki/Syntax\" rel=\"nofollow\">re2-compliant regexp</a>, <code>(?s).*?(\\n\\n|$)</code> (see <a href=\"http://play.golang.org/p/8XyW3kKER6\" rel=\"nofollow\">playground example</a>):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n)\n\nfunc main() {\n    str := `first paragraph\nsecond line of first paragraph\n\nsecond paragraph\n\nthird paragraph\nsecond line of third paragraph`\n\n    r, _ := regexp.Compile(`(?s).*?(\\n\\n|$)`)\n\n    res := r.FindAllString(str, -1)\n    fmt.Printf(\"%+v %d\", res, len(res))\n}\n</code></pre>\n\n<p>That would output:</p>\n\n<pre><code>[first paragraph\nsecond line of first paragraph\n\n second paragraph\n\n third paragraph\nsecond line of third paragraph] 3\n</code></pre>\n"}], "owner": {"reputation": 47383, "user_id": 122536, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6fd51ed284bddf7eeab9de416359021e?s=128&d=identicon&r=PG", "display_name": "alexchenco", "link": "https://stackoverflow.com/users/122536/alexchenco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 1, "accepted_answer_id": 28828753, "answer_count": 1, "score": 1, "last_activity_date": 1425376521, "creation_date": 1425371486, "question_id": 28827207, "link": "https://stackoverflow.com/questions/28827207/matching-paragraphs-in-go", "title": "Matching paragraphs in Go", "body": "<p>I'm a Go beginner. I'm trying to match paragraphs with <code>regexp</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n)\n\nfunc main() {\n    str := `first paragraph\n\nsecond paragraph\n\nthird paragraph`\n\n    r, _ := regexp.Compile(`(.+)(\\n\\n)`)\n\n    fmt.Println(r.FindAllString(str, -1))\n}\n</code></pre>\n\n<p>The output is this:</p>\n\n<pre><code>[first paragraph\n\n second paragraph\n\n]\n</code></pre>\n\n<p>I think it's matching the empty lines also. I only want to match the paragraphs (<code>first paragraph</code>, <code>second paragraph</code>).</p>\n\n<p>How to modify my code to accomplish that? </p>\n"}, {"tags": ["go", "mux", "gorilla"], "answers": [{"tags": [], "owner": {"reputation": 6066, "user_id": 119669, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/959be122ff68722c18fc41e487e9465d?s=128&d=identicon&r=PG", "display_name": "Lee Hambley", "link": "https://stackoverflow.com/users/119669/lee-hambley"}, "is_accepted": false, "score": 2, "last_activity_date": 1425374534, "creation_date": 1425374534, "answer_id": 28828110, "question_id": 28826101, "link": "https://stackoverflow.com/questions/28826101/pathprefixed-subrouter-with-individual-handlers/28828110#28828110", "title": "PathPrefixed Subrouter with individual handlers", "body": "<p>The problem was that <code>gorilla/mux</code> fires the first matching handler. That's important <strong><em>the first matching handler</em></strong>.</p>\n\n<p>That means that routes logically <em>under</em> <code>/{id}/</code> are never found, since the routes that would match them are matched first by the parent handler.</p>\n\n<p>Changing the code to the following makes it work as expected:</p>\n\n<pre><code>// Collection\nroot   := r.PathPrefix(\"/widgets/\").Subrouter()\nobject := root.PathPrefix(\"/{uuid}\").Subrouter()\n\n// Relationships\nobject.Methods(\"GET\").Path(\"/foos\").Handler(eh.Foos)\nobject.Methods(\"GET\").Path(\"/bars\").Handler(eh.Bars)\n\n// Individual\nroot.Methods(\"POST\").Handler(h.Create)\nobject.Methods(\"GET\").Handler(h.Show)\nobject.Methods(\"PUT\").Handler(h.Replace)\nobject.Methods(\"DELETE\").Handler(h.Delete)\n</code></pre>\n\n<p>Then things work perfectly.</p>\n"}], "owner": {"reputation": 6066, "user_id": 119669, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/959be122ff68722c18fc41e487e9465d?s=128&d=identicon&r=PG", "display_name": "Lee Hambley", "link": "https://stackoverflow.com/users/119669/lee-hambley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 471, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1425374534, "creation_date": 1425366962, "question_id": 28826101, "link": "https://stackoverflow.com/questions/28826101/pathprefixed-subrouter-with-individual-handlers", "title": "PathPrefixed Subrouter with individual handlers", "body": "<p>Given the following (<a href=\"http://play.golang.org/p/TKQ9kgRtoA\" rel=\"nofollow\">complete example at Go playground</a>):</p>\n\n<pre><code>// Collection\nroot := r.PathPrefix(\"/widgets/\").Subrouter()\nroot.Methods(\"POST\").Handler(h.Create)\n\n// Individual\nobject := root.PathPrefix(\"/{uuid}\").Subrouter()\n// ~neither: object := root.PathPrefix(\"/{uuid}\").Subrouter() \nobject.Methods(\"GET\").Handler(h.Show)\nobject.Methods(\"PUT\").Handler(h.Replace)\nobject.Methods(\"DELETE\").Handler(h.Delete)\n\n// Relationships\nobject.Methods(\"GET\").Path(\"/foos\").Handler(eh.Foos)\nobject.Methods(\"GET\").Path(\"/bars\").Handler(eh.Bars)\n</code></pre>\n\n<p>I would have expected the following URLs to trigger the respective handlers, but I can't seem to make it work:</p>\n\n<pre><code>\u2714 POST /widgets          =&gt; h.Create\n\u2714 GET  /widgets/123      =&gt; h.Show    (assumes PathPrefix('/{uuid}'))\n\u2714 GET  /widgets/123/     =&gt; h.Show    (required if 'PathPrefix('/{uuid}/')')\n\u2716 GET  /widgets/123/foos =&gt; h.Foos    (actually routes h.Show)\n\u2716 GET  /widgets/123/bars =&gt; h.Bars    (actually routes h.Show)\n</code></pre>\n\n<p>Unfortunately neither of the last two are apparently routable, they both trigger <code>h.Show</code>, can anyone point out what I'm doing wrong? I might have expected that having an unbounded <code>{uuid}</code> (without the trailing slash) could have run-on, ignoring the <code>/</code> but that doesn't seem to be the case.</p>\n\n<p>I don't even know if this has to do with the Subrouter strict-slash issue which is still open on Github (#31), but to the best of my understanding I did try the alternatives there. (i.e <code>object.Methods(\"GET\").Path(\"/\").Handler(h.Show)</code>)</p>\n\n<p>Could the Handler mounted on the <code>object</code> root via <code>Methods()</code> prevent any further routes matching?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 9325, "user_id": 4931, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f4182656449e54bde861a02d6ef44ecd?s=128&d=identicon&r=PG", "display_name": "Michael Deardeuff", "link": "https://stackoverflow.com/users/4931/michael-deardeuff"}, "edited": false, "score": 1, "creation_date": 1425365376, "post_id": 28825259, "comment_id": 45922088, "body": "why does assign1 need a pointer-to-a-pointer? <a href=\"http://play.golang.org/p/Vzrma3IrV3\" rel=\"nofollow noreferrer\">play.golang.org/p/Vzrma3IrV3</a>"}, {"owner": {"reputation": 3433, "user_id": 1766065, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a693ccc173e95b983371c444b86edc82?s=128&d=identicon&r=PG", "display_name": "Jens D", "link": "https://stackoverflow.com/users/1766065/jens-d"}, "reply_to_user": {"reputation": 9325, "user_id": 4931, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f4182656449e54bde861a02d6ef44ecd?s=128&d=identicon&r=PG", "display_name": "Michael Deardeuff", "link": "https://stackoverflow.com/users/4931/michael-deardeuff"}, "edited": false, "score": 0, "creation_date": 1425366097, "post_id": 28825259, "comment_id": 45922347, "body": "Indeed, you&#39;re right. I thought I had tested this, but obviously didn&#39;t get it right which is why I thought I needed a pointer-to-a-pointer."}], "answers": [{"tags": [], "owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "is_accepted": false, "score": 2, "last_activity_date": 1425365263, "creation_date": 1425365263, "answer_id": 28825704, "question_id": 28825259, "link": "https://stackoverflow.com/questions/28825259/in-golang-how-do-i-re-assign-an-external-reference-from-within-a-function/28825704#28825704", "title": "In golang, how do I re-assign an external reference from within a function?", "body": "<p>Both forms are valid Go, as you've discovered.</p>\n\n<p>For the <code>assign2</code> case, the compiler finds that <code>assign2</code> does not appear in <code>Blob</code>'s method set, but it is part of <code>*Blob</code>'s method set.  It then converts the method call to:</p>\n\n<pre><code>(&amp;x2).assign2()\n</code></pre>\n\n<p>While it can be confusing if a method then goes and changes <code>x2</code> like in your example, there are a number of places in the standard library where this pattern is used.  Probably the most common one is implementing custom decoding for a type with the <code>encoding/json</code> module: you implement the <code>DecodeJSON</code> method with a pointer receiver, and update the value being pointed to.</p>\n"}, {"comments": [{"owner": {"reputation": 3433, "user_id": 1766065, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a693ccc173e95b983371c444b86edc82?s=128&d=identicon&r=PG", "display_name": "Jens D", "link": "https://stackoverflow.com/users/1766065/jens-d"}, "edited": false, "score": 0, "creation_date": 1425451177, "post_id": 28826018, "comment_id": 45964048, "body": "Thanks Michael. Both yours and @JamesHenstridge comments were very helpful."}], "tags": [], "owner": {"reputation": 9325, "user_id": 4931, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f4182656449e54bde861a02d6ef44ecd?s=128&d=identicon&r=PG", "display_name": "Michael Deardeuff", "link": "https://stackoverflow.com/users/4931/michael-deardeuff"}, "is_accepted": true, "score": 2, "last_activity_date": 1425367293, "last_edit_date": 1495534183, "creation_date": 1425366678, "answer_id": 28826018, "question_id": 28825259, "link": "https://stackoverflow.com/questions/28825259/in-golang-how-do-i-re-assign-an-external-reference-from-within-a-function/28826018#28826018", "title": "In golang, how do I re-assign an external reference from within a function?", "body": "<p><a href=\"https://stackoverflow.com/a/28825704/4931\">James answers</a> the mechanics of <code>assign2</code>. I'll touch a bit on when to use it.</p>\n\n<p>Let's take a simpler example, first. </p>\n\n<pre><code>type Counter uint\n\nfunc (c *Counter) Increment() {\n    *c += 1\n}\n</code></pre>\n\n<p>In the counter example the <em>entire</em> state of the receiver is changing. Similarly for the <code>encoding/json</code> package the <em>entire</em> state of the receiver is changing. That's really the only time I would use that style.</p>\n\n<p>One major advantage of the style: you can define an interface for the change, just like the <a href=\"http://golang.org/pkg/encoding/gob/#GobDecoder\" rel=\"nofollow noreferrer\">GobDecoder</a> does.</p>\n\n<p>When I first saw the <code>assign2</code> style it was a little grating. But then I remembered that <code>(c *Counter) Increment</code> gets translated to <code>Increment(c *Counter)</code> in the machine code and it didn't bother me anymore. I personally prefer <code>assign1</code>-style. (Though, there is <a href=\"http://play.golang.org/p/Vzrma3IrV3\" rel=\"nofollow noreferrer\">no need</a> for the double pointers as orignally posted.)</p>\n\n<pre><code>package main\nimport \"fmt\"\n\ntype Blob struct {\n    Message string\n}\n\nfunc assign1(b *Blob) {\n    *b = Blob{\"Internally created by assign1\"}\n}\n\nfunc main() {\n    x1 := Blob{\"Hello World\"}\n    assign1(&amp;x1)\n    fmt.Printf(\"x1 = %+v\\n\", *x1)\n}\n</code></pre>\n"}], "owner": {"reputation": 3433, "user_id": 1766065, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a693ccc173e95b983371c444b86edc82?s=128&d=identicon&r=PG", "display_name": "Jens D", "link": "https://stackoverflow.com/users/1766065/jens-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 472, "favorite_count": 1, "accepted_answer_id": 28826018, "answer_count": 2, "score": 3, "last_activity_date": 1425367293, "creation_date": 1425363248, "question_id": 28825259, "link": "https://stackoverflow.com/questions/28825259/in-golang-how-do-i-re-assign-an-external-reference-from-within-a-function", "title": "In golang, how do I re-assign an external reference from within a function?", "body": "<p>I'm probably not expressing this correctly in the question, but perhaps this code will make it clearer:</p>\n\n<pre><code>package main\nimport \"fmt\"\n\ntype Blob struct {\n    Message string\n}\n\nfunc assign1(bb **Blob) {\n    *bb = &amp;Blob{\"Internally created by assign1\"}\n}\n\nfunc (b *Blob) assign2() {\n    *b = Blob{\"Internally created by assign2\"}\n}\n\nfunc main() {\n    x1 := &amp;Blob{\"Hello World\"}\n    assign1(&amp;x1)\n    fmt.Printf(\"x1 = %+v\\n\", *x1)\n\n    x2 := Blob{\"Hello World\"}\n    x2.assign2()\n    fmt.Printf(\"x2 = %+v\\n\", x2)\n}\n</code></pre>\n\n<p>Produces, as desired:</p>\n\n<pre><code>x1 = {Message:Internally created by assign1}\nx2 = {Message:Internally created by assign2}\n</code></pre>\n\n<p>I want to pass a reference (pointer to a pointer) into a function and have the function assign a new value to the pointer such that the calling scope will see that new value.</p>\n\n<p>I've figured out the above two ways of doing this, but I'd like to know if they are actually correct or if there is some hidden flaw. Also, are either of them more idiomatic than the other?</p>\n\n<p>Coming from Java, <code>assign2</code> just seems wrong but I'm sure I've seen something similar in the <code>encoding/json</code> package. What is that actually doing?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["bash", "autocomplete", "go"], "comments": [{"owner": {"reputation": 801, "user_id": 3264448, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/1EyDR.jpg?s=128&g=1", "display_name": "CodeQuestor", "link": "https://stackoverflow.com/users/3264448/codequestor"}, "edited": false, "score": 0, "creation_date": 1483526537, "post_id": 28823678, "comment_id": 70129010, "body": "Did it work for you? Any suggestions?"}], "answers": [{"comments": [{"owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "edited": false, "score": 1, "creation_date": 1425932910, "post_id": 28824598, "comment_id": 46156085, "body": "The readme leaves a lot to be desired... For example, how to distribute this program with autocompletion (not that this topic <i>should</i> be in the scope of the README, but for the purposes of answering this question)."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1425940879, "post_id": 28824598, "comment_id": 46159733, "body": "It sounds like you&#39;re expecting magic and/or don&#39;t understand how auto completion in various shell&#39;s work."}, {"owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1425993412, "post_id": 28824598, "comment_id": 46181147, "body": "@DaveC I&#39;m not expecting magic--lots of programs permit other programs/plugins to define their own behavior without any magic. I don&#39;t know how autocompletion works, but it&#39;s certainly not unreasonable that it might be a similar mechanism. A good answer would explain why a library can&#39;t deliver this functionality, and what the CLI API means by &quot;enable bash completion&quot; (which looks to me like it means, &quot;set this flag to true and get autocompletion goodness!&quot;).  I&#39;m not asking for magic, just a good answer to the question."}], "tags": [], "owner": {"reputation": 6093, "user_id": 965495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a75b5bed74983dcc367dfbd5b6c259e2?s=128&d=identicon&r=PG", "display_name": "klobucar", "link": "https://stackoverflow.com/users/965495/klobucar"}, "is_accepted": false, "score": -2, "last_activity_date": 1425359836, "creation_date": 1425359836, "answer_id": 28824598, "question_id": 28823678, "link": "https://stackoverflow.com/questions/28823678/bash-autocomplete-using-codegangsta-cli-framework-https-github-com-codegangst/28824598#28824598", "title": "Bash autocomplete using codegangsta cli framework [https://github.com/codegangsta/cli]", "body": "<p>I would take a read at this part of the readme for the <a href=\"https://github.com/codegangsta/cli#to-enable\" rel=\"nofollow\">cli repo</a>. </p>\n"}, {"tags": [], "owner": {"reputation": 2079, "user_id": 4233342, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zBkZL.jpg?s=128&g=1", "display_name": "yahavi", "link": "https://stackoverflow.com/users/4233342/yahavi"}, "is_accepted": false, "score": 0, "last_activity_date": 1563605653, "last_edit_date": 1592644375, "creation_date": 1563605653, "answer_id": 57122487, "question_id": 28823678, "link": "https://stackoverflow.com/questions/28823678/bash-autocomplete-using-codegangsta-cli-framework-https-github-com-codegangst/57122487#57122487", "title": "Bash autocomplete using codegangsta cli framework [https://github.com/codegangsta/cli]", "body": "<p>Enabling bash completion in the Go code is just one step out of two.</p>\n<p>You need also to download and source <a href=\"https://github.com/urfave/cli/blob/master/autocomplete/bash_autocomplete\" rel=\"nofollow noreferrer\">this</a> script. After downloading, just run:</p>\n<pre><code>source bash_autocomplete\n</code></pre>\n<p>To make it permanent, add the above command with full path to your ~/.bashrc or ~/.bash_profile files.</p>\n"}], "owner": {"reputation": 29, "user_id": 4020318, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Stack Exchange", "link": "https://stackoverflow.com/users/4020318/stack-exchange"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 635, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1563605653, "creation_date": 1425353967, "last_edit_date": 1425934865, "question_id": 28823678, "link": "https://stackoverflow.com/questions/28823678/bash-autocomplete-using-codegangsta-cli-framework-https-github-com-codegangst", "title": "Bash autocomplete using codegangsta cli framework [https://github.com/codegangsta/cli]", "body": "<p>I am a newbie to golang and i am using the code gangsta cli framework [<a href=\"https://github.com/codegangsta/cli]\" rel=\"nofollow\">https://github.com/codegangsta/cli]</a> to develop a command line application. I am trying to implement the autocomplete feature for the flags of the commands, but looks like it is not working as expected. Has anybody tried to implement this feature using this framework?</p>\n\n<p>Here is my part of the code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n\n    \"github.com/codegangsta/cli\"\n)\n\nfunc main() {\n    app := cli.NewApp()\n    app.Name = \"greet\"\n    app.Usage = \"sample command-line app by greet\"\n    app.Author = \"abc\"\n    app.Email = \"xyz@aaa.com\"\n    app.EnableBashCompletion = true\n    app.Commands = []cli.Command{\n        {\n            Name:      \"read\",\n            ShortName: \"r\",\n            Usage:     \"read something\",\n            Subcommands: []cli.Command{\n                {\n                    Name:   \"articles\",\n                    Usage:  \"read articles\",\n                    Action: readArticles,\n                },\n\n                {\n                    Name:  \"tweets\",\n                    Usage: \"read Tweets\",\n                    Flags: []cli.Flag{\n                        cli.StringFlag{\n\n                            Name:  \"account\",\n                            Value: \"SomeThing\",\n                            Usage: \"name of Twitter account\",\n                        },\n                    },\n                    Action: readTwitter,\n                },\n            },\n        },\n    }\n    app.Run(os.Args)\n}\n\nfunc readArticles(ctx *cli.Context) {\n    fmt.Println(\"Go to http://www.google.com to read articles!\")\n}\n\nfunc readTwitter(ctx *cli.Context) {\n    fmt.Printf(\"Go to https://twitter.com/%s to read tweets!\", ctx.String(\"account\"))\n}\n</code></pre>\n\n<p>Here is the expected output:</p>\n\n<p>./greet read tweets --a [TAB][TAB] does not work.</p>\n"}, {"tags": ["regex", "go"], "answers": [{"tags": [], "owner": {"reputation": 2009, "user_id": 4618774, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/031e68c41285d97f220f8e1d056eb7b0?s=128&d=identicon&r=PG&f=1", "display_name": "cycle4passion", "link": "https://stackoverflow.com/users/4618774/cycle4passion"}, "is_accepted": false, "score": 0, "last_activity_date": 1425429444, "creation_date": 1425429444, "answer_id": 28844710, "question_id": 28823626, "link": "https://stackoverflow.com/questions/28823626/go-trying-to-loop-date-regex-results/28844710#28844710", "title": "Go, trying to loop date Regex results", "body": "<p>After some rethinking and help from above, with aid of the above answer I came up looping the regex's separately to better handle overlapping named capture groups I came up with this: (posted for benefit of others and any critique is welcome)</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"regexp\"\n    \"strconv\"\n    \"strings\"\n)\n\nfunc main() {\n    month_d := `(?P&lt;month&gt;1[012]|0?[1-9])`\n    month_t := `(?P&lt;month&gt;jan(?:uary|.)?|feb(?:ruary|.)?|mar(?:ch|.)?|apr(?:il|.)?|may(.)|jun(?:e|.)?|jul(?:y|.)?|aug(?:ust|.)?|sep(?:tember|t|t.|.)?|oct(?:ober|.)?|nov(?:ember|.)?|dec(?:ember|.)?)`\n    day := `(?P&lt;day&gt;3[01]|[12][0-9]|[0]?[1-9])(?:\\s)?(?:th|rd|nd|st)?`\n    year := `(?P&lt;year&gt;(?:19|20)?\\d\\d)`\n    sep_d := `[?:/.-]`\n    sep_t := `[?:,\\s]`\n\n    text := \"fedskjnkvdsj February 6 2004 sdffd Jan 12th 56 1/12/2000 2013/12/1 2099/12/5 1/12/1999 dsfjhfdhj\"\n    regs := []string{\n        \"(\" + month_d + sep_d + day + sep_d + year + \")\",\n        \"(\" + year + sep_d + month_d + sep_d + day + \")\",\n        \"(\" + day + sep_d + month_d + sep_d + year + \")\",\n        \"(\" + month_t + sep_t + day + sep_t + year + \")\",\n        \"(\" + day + sep_t + month_t + sep_t + year + \")\",\n    }\n    for i := 0; i &lt; len(regs); i++ {\n        myExp, err := regexp.Compile(\"(?i)\" + regs[i])\n        if err != nil {\n            fmt.Printf(\"There is a problem with your regexp.\\n\")\n            return\n        }\n        match := myExp.FindAllStringSubmatch(text, -1)\n        //fmt.Println(\"Match\", match, len(match))\n        //fmt.Println(\"Names\", myExp.SubexpNames(), len(myExp.SubexpNames()))\n        for j := 0; j &lt; len(match); j++ {\n            result := make(map[string]string)\n            for k, name := range myExp.SubexpNames() {\n                result[name] = match[j][k]\n            }\n            // Fix Month\n            themonth := strings.ToLower(result[\"month\"])\n\n            if len(themonth) == 1 {\n                themonth = \"0\" + themonth\n            }\n            if len(themonth) &gt;= 3 {\n                themonth = themonth[0:3]\n                switch themonth {\n                case \"jan\":\n                    themonth = \"01\"\n                case \"feb\":\n                    themonth = \"02\"\n                case \"mar\":\n                    themonth = \"03\"\n                case \"apr\":\n                    themonth = \"04\"\n                case \"may\":\n                    themonth = \"05\"\n                case \"jun\":\n                    themonth = \"06\"\n                case \"jul\":\n                    themonth = \"07\"\n                case \"aug\":\n                    themonth = \"08\"\n                case \"sep\":\n                    themonth = \"09\"\n                case \"oct\":\n                    themonth = \"10\"\n                case \"nov\":\n                    themonth = \"11\"\n                case \"dec\":\n                    themonth = \"12\"\n                default:\n                    fmt.Println(\"Month Error: \" + themonth)\n                    os.Exit(2)\n                }\n            }\n            // Day\n            theday := result[\"day\"]\n            if len(theday) == 1 {\n                theday = \"0\" + theday\n            }\n            // Fix Year\n            theyear := result[\"year\"]\n            if len(theyear) == 2 {\n                val_year, err := strconv.ParseInt(theyear,10,0)\n                if err != nil {\n                    // handle error\n                    fmt.Println(err)\n                    os.Exit(2)\n                }\n                if val_year &gt; 50 {\n                    theyear = \"19\" + theyear\n                } else {\n                    theyear = \"20\" + theyear\n                }\n            }\n            date := themonth + \"/\" + theday + \"/\" + theyear\n            fmt.Println(date)\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 2009, "user_id": 4618774, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/031e68c41285d97f220f8e1d056eb7b0?s=128&d=identicon&r=PG&f=1", "display_name": "cycle4passion", "link": "https://stackoverflow.com/users/4618774/cycle4passion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1425429444, "creation_date": 1425353584, "question_id": 28823626, "link": "https://stackoverflow.com/questions/28823626/go-trying-to-loop-date-regex-results", "title": "Go, trying to loop date Regex results", "body": "<p>Doing a FindAllStringSubmatch regex match including named groups for different date formats. I am having trouble looping results. The commented out conditional makes it work, but not cleanly and it breaks as I add additional matches. I feel like I am approaching it wrong and would like some redirection. thx/</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n    \"strings\"\n)\n\nfunc main() {\n    text := \"12/31/1956 31/11/1960\"\n    reg := []string{`(?P&lt;month&gt;1[12])/(?P&lt;day&gt;\\d\\d)/(?P&lt;year&gt;19\\d\\d)`, `(?P&lt;day&gt;\\d\\d)/(?P&lt;month&gt;1[12])/(?P&lt;year&gt;19\\d\\d)`}\n    // Combine them, case ignored\n    regall := \"(?i)\" + strings.Join(reg, \"|\")\n    myExp := regexp.MustCompile(regall)\n    match := myExp.FindAllStringSubmatch(text, -1)\n    fmt.Println(\"Match\", match, len(match))\n    fmt.Println(\"Names\", myExp.SubexpNames(), len(myExp.SubexpNames()))\n    for i := 0; i &lt; len(match); i++ {\n        result := make(map[string]string)\n        for j, name := range myExp.SubexpNames() {\n            result[name] = match[i][j]\n            //if (result[\"month\"] != \"\" &amp;&amp; result[\"day\"] != \"\" &amp;&amp; result[\"year\"] != \"\") {\n                fmt.Println(match[i][0],i,j,result[\"month\"] + \"/\" + result[\"day\"] + \"/\" + result[\"year\"])\n            //}\n        }\n    }\n}\n\nResults in:\nMatch [[12/31/1956 12 31 1956   ] [31/11/1960    31 11 1960]] 2\nNames [ month day year day month year] 7\n12/31/1956 0 0 //\n12/31/1956 0 1 12//\n12/31/1956 0 2 12/31/\n12/31/1956 0 3 12/31/1956\n12/31/1956 0 4 12//1956\n12/31/1956 0 5 //1956\n12/31/1956 0 6 //\n31/11/1960 1 0 //\n31/11/1960 1 1 //\n31/11/1960 1 2 //\n31/11/1960 1 3 //\n31/11/1960 1 4 /31/\n31/11/1960 1 5 11/31/\n31/11/1960 1 6 11/31/1960\n</code></pre>\n"}, {"tags": ["go", "revel"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 4, "last_activity_date": 1425327757, "creation_date": 1425327757, "answer_id": 28818794, "question_id": 28818680, "link": "https://stackoverflow.com/questions/28818680/pass-interface-object-without-declaring-a-struct/28818794#28818794", "title": "Pass interface object without declaring a struct", "body": "<p>You don't have to declare a named <code>struct</code> type prior, you could simply use:</p>\n\n<pre><code>return c.RenderJson(struct{ Error string }{\"xyz\"})\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 75, "user_id": 4624990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3cfc726fb30ff1d17cd29916a76ce1c?s=128&d=identicon&r=PG&f=1", "display_name": "Dino", "link": "https://stackoverflow.com/users/4624990/dino"}, "edited": false, "score": 0, "creation_date": 1425328406, "post_id": 28818797, "comment_id": 45909583, "body": "That&#39;s exactly what I was looking for, thanks. could you redirect me to a source that&#39;s saying what exactly does the <code>json:&quot;error_message&quot;</code> mean in the struct? I am a newbie to Golang so it&#39;s the first time i&#39;m seeing it"}, {"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "reply_to_user": {"reputation": 75, "user_id": 4624990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3cfc726fb30ff1d17cd29916a76ce1c?s=128&d=identicon&r=PG&f=1", "display_name": "Dino", "link": "https://stackoverflow.com/users/4624990/dino"}, "edited": false, "score": 0, "creation_date": 1425329953, "post_id": 28818797, "comment_id": 45910412, "body": "Have a look in here: <a href=\"http://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow noreferrer\">golang.org/pkg/encoding/json/#Marshal</a>.  They are called struct tags.  This is how they are used via reflect: <a href=\"http://golang.org/pkg/reflect/#StructTag\" rel=\"nofollow noreferrer\">golang.org/pkg/reflect/#StructTag</a>.  And here is a bit of explanation in general: <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Struct_types</a>"}], "tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": true, "score": 4, "last_activity_date": 1425327768, "creation_date": 1425327768, "answer_id": 28818797, "question_id": 28818680, "link": "https://stackoverflow.com/questions/28818680/pass-interface-object-without-declaring-a-struct/28818797#28818797", "title": "Pass interface object without declaring a struct", "body": "<p>For 1. Try the following:</p>\n\n<pre><code>return c.RenderJson(map[string]string{\"error\": \"xyz\"})\n</code></pre>\n\n<p><code>RenderJson</code> takes an interface, which means you can pass it anything.  You don't need to explicitly cast to an interface, though that would be done like</p>\n\n<pre><code>interface{}(map[string]string{\"error\": \"xyz\"})\n</code></pre>\n\n<p>For 2.  I am not certain, but I tend to have a helper function that takes the error string (or error type) and a status code and does the handling for me.</p>\n\n<pre><code>return HandleError(c, \"xyz is not valid\", 400)\n</code></pre>\n\n<p>And then <code>HandleError</code> just creates and writes the error.</p>\n\n<p>If you are going to be handling errors in general, I don't know why you wouldn't make an error type though, </p>\n\n<pre><code>type RequestError struct {\n    Error string `json:\"error_message\"`,\n    StatusCode int `json:\"status_code\"`,\n    ...\n}\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 4624990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3cfc726fb30ff1d17cd29916a76ce1c?s=128&d=identicon&r=PG&f=1", "display_name": "Dino", "link": "https://stackoverflow.com/users/4624990/dino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 28818797, "answer_count": 2, "score": 0, "last_activity_date": 1425327768, "creation_date": 1425327260, "question_id": 28818680, "link": "https://stackoverflow.com/questions/28818680/pass-interface-object-without-declaring-a-struct", "title": "Pass interface object without declaring a struct", "body": "<p>How can I pass an <code>Interface{}</code> object without declaring a Struct? \nfor example when I'm using the Revel framework I want to return an error on a specific case.</p>\n\n<ol>\n<li><p>The following example is not working, I tried various conventions nothing worked, whats the right approach?</p>\n\n<p>return c.RenderJson(interface{\"error\":\"xyz\"})</p></li>\n<li><p>Whats the right approach to return an error to the Client if i'm building a Server with the Revel framework?</p></li>\n</ol>\n"}, {"tags": ["pointers", "go", "struct", "literals"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1433927831, "post_id": 28817992, "comment_id": 49558133, "body": "Related: <a href=\"http://stackoverflow.com/questions/30716354/how-do-i-do-a-literal-int64-in-go\" title=\"how do i do a literal int64 in go\">stackoverflow.com/questions/30716354/&hellip;</a>"}, {"owner": {"reputation": 101, "user_id": 7481796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cikv0.jpg?s=128&g=1", "display_name": "Xor", "link": "https://stackoverflow.com/users/7481796/xor"}, "edited": false, "score": 0, "creation_date": 1573121701, "post_id": 28817992, "comment_id": 103781675, "body": "You can use package <a href=\"https://github.com/xorcare/pointer\" rel=\"nofollow noreferrer\">pointer</a>, for example: <code>var _ *bool = pointer.Bool(true)</code>"}, {"owner": {"reputation": 12661, "user_id": 648955, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/DUiuD.jpg?s=128&g=1", "display_name": "leventov", "link": "https://stackoverflow.com/users/648955/leventov"}, "edited": false, "score": 0, "creation_date": 1587032926, "post_id": 28817992, "comment_id": 108351879, "body": "Note: if you are dealing with AWS Go SDK, there is an <code>aws.Bool()</code> function specifically for this."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 4, "last_activity_date": 1425326374, "creation_date": 1425326374, "answer_id": 28818446, "question_id": 28817992, "link": "https://stackoverflow.com/questions/28817992/how-to-set-bool-pointer-to-true-in-struct-literal/28818446#28818446", "title": "How to set bool pointer to true in struct literal?", "body": "<p>No.</p>\n\n<p>There is no syntax to define a pointer to a primitive type, other than the zero value returned by <code>new</code>. The same goes for numeric types, and strings.</p>\n\n<p>You either need to create a value before hand to take the address of, or you create the pointer with a zero value, and assign a new value after the fact.</p>\n"}, {"comments": [{"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1425326927, "post_id": 28818489, "comment_id": 45908738, "body": "I guess I have to go with the ugly slice of bools b/c the syntax is provided as a command argument  to a generator so I can&#39;t afford a helper function."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 1, "creation_date": 1425327351, "post_id": 28818489, "comment_id": 45908950, "body": "@Theuserwithnohat I don&#39;t see why your case wouldn&#39;t allow a function. Care to share more details?"}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1425520366, "post_id": 28818489, "comment_id": 46001588, "body": "The syntax (type fields) is supposed to be provided to a command line/generator. Providing a function as cli argument is not nice."}, {"owner": {"reputation": 314, "user_id": 5579463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b605f30fa77cd9f62b99fd74c2ce8cf2?s=128&d=identicon&r=PG&f=1", "display_name": "MrR", "link": "https://stackoverflow.com/users/5579463/mrr"}, "edited": false, "score": 0, "creation_date": 1568640314, "post_id": 28818489, "comment_id": 102327526, "body": "isn&#39;t it better just to create a spurious variable? performance implications?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 314, "user_id": 5579463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b605f30fa77cd9f62b99fd74c2ce8cf2?s=128&d=identicon&r=PG&f=1", "display_name": "MrR", "link": "https://stackoverflow.com/users/5579463/mrr"}, "edited": false, "score": 0, "creation_date": 1568640411, "post_id": 28818489, "comment_id": 102327590, "body": "@MrR Yes, that&#39;s preferable. Probably the one-liner helper gets inlined too."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 43, "last_activity_date": 1505287404, "last_edit_date": 1505287404, "creation_date": 1425326555, "answer_id": 28818489, "question_id": 28817992, "link": "https://stackoverflow.com/questions/28817992/how-to-set-bool-pointer-to-true-in-struct-literal/28818489#28818489", "title": "How to set bool pointer to true in struct literal?", "body": "<p>You can do that but it's not optimal:</p>\n\n<pre><code>h := handler{is: &amp;[]bool{true}[0]}\nfmt.Println(*h.is) // Prints true\n</code></pre>\n\n<p>Basically it creates a slice with one <code>bool</code> of value <code>true</code>, indexes its first element and takes its address. No new variable is created, but there is a lot of boilerplate (and backing array will remain in memory until the address to its first element exists).</p>\n\n<p>A better solution would be to write a helper function:</p>\n\n<pre><code>func newTrue() *bool {\n    b := true\n    return &amp;b\n}\n</code></pre>\n\n<p>And using it:</p>\n\n<pre><code>h := handler{is: newTrue()}\nfmt.Println(*h.is) // Prints true\n</code></pre>\n\n<p>You can also do it with a one-liner anonymous function:</p>\n\n<pre><code>h := handler{is: func() *bool { b := true; return &amp;b }()}\nfmt.Println(*h.is) // Prints true\n</code></pre>\n\n<p>Or a variant:</p>\n\n<pre><code>h := handler{is: func(b bool) *bool { return &amp;b }(true)}\n</code></pre>\n\n<p>To see all your options, check out my other answer: <a href=\"https://stackoverflow.com/questions/30716354/how-do-i-do-a-literal-int64-in-go/30716481#30716481\">How do I do a literal *int64 in Go?</a></p>\n"}, {"tags": [], "owner": {"reputation": 99, "user_id": 7961353, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2c0d31851dd72635ee741200a6ce5747?s=128&d=identicon&r=PG&f=1", "display_name": "Onkar Banerjee", "link": "https://stackoverflow.com/users/7961353/onkar-banerjee"}, "is_accepted": false, "score": -2, "last_activity_date": 1514468008, "last_edit_date": 1514468008, "creation_date": 1514466698, "answer_id": 48008143, "question_id": 28817992, "link": "https://stackoverflow.com/questions/28817992/how-to-set-bool-pointer-to-true-in-struct-literal/48008143#48008143", "title": "How to set bool pointer to true in struct literal?", "body": "<p>One of the reasons why pointers are helpful in go or any language for that matter, is they help us to \"pass by reference\". So if we pass anything by reference we can then \"change\" that thing. A function which takes a pointer to bool, can change the bool's value effectively even after the function returns. This is the very thing we do not want with constants, ie. their values should not change. Hence this restriction makes sense.     </p>\n\n<p>Apart from the tricks mentioned by <code>icza</code> above, would want to add a point here. Mostly we use pointers to bools rather than bools directly in order to use the nil value of pointers effectively, which otherwise have to be either true or false. If that IS the case, then you might want to use optional bool flags directly in the functions, rather than have pointers to bool or even a struct wrapping the single bool pointer as shown in your example, doing away with the complete requirement of a struct even.. Now, of course if the struct is reqd for any other reason, you can very well use any of the tricks by <code>icza</code> above.\nBtw, you can directly have a copy of the bool value for using the adress of as below as well.</p>\n\n<pre><code>const check = true\nchk := check\nfmt.Println(&amp;chk) // will give you the address of chk\nchk = false\nfmt.Println(chk) // will print false\nfmt.Println(check) // will print true\n</code></pre>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35372, "favorite_count": 6, "accepted_answer_id": 28818489, "answer_count": 3, "score": 33, "last_activity_date": 1514468008, "creation_date": 1425324714, "last_edit_date": 1475651151, "question_id": 28817992, "link": "https://stackoverflow.com/questions/28817992/how-to-set-bool-pointer-to-true-in-struct-literal", "title": "How to set bool pointer to true in struct literal?", "body": "<p>I have the function below which accepts a bool pointer. I'm wondering if there is any notation which allows me to set the value of the <code>is</code> field to <code>true</code> in the struct literal; basically without to define a new identifier <code>(i.e. var x := true ; handler{is: &amp;x} )</code></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n    check(handler{is: new(bool) })\n}\n\n\ntype handler struct{\n    is *bool\n}\n\nfunc check(is handler){}\n</code></pre>\n"}, {"tags": ["session", "go", "session-variables", "gorilla"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1425326769, "post_id": 28817869, "comment_id": 45908664, "body": "What is a &quot;shared session&quot;? Shared between what? Goroutines or clients?"}], "answers": [{"tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": true, "score": 6, "last_activity_date": 1425326744, "creation_date": 1425326744, "answer_id": 28818534, "question_id": 28817869, "link": "https://stackoverflow.com/questions/28817869/go-gorilla-mux-session-name/28818534#28818534", "title": "Go Gorilla Mux Session Name", "body": "<p>The session data is stored in the client's cookies.  So the session you retrieve with <code>store.Get(r, \"session-name\")</code> is reading that particular client't (request) cookies.  You do not need unique names.  The name in this case is the name of the cookie so it will be unique to the request.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4211028"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1086, "favorite_count": 0, "accepted_answer_id": 28818534, "answer_count": 1, "score": 3, "last_activity_date": 1425326744, "creation_date": 1425324357, "question_id": 28817869, "link": "https://stackoverflow.com/questions/28817869/go-gorilla-mux-session-name", "title": "Go Gorilla Mux Session Name", "body": "<p>I am having a hard time understanding Gorilla <code>mux</code>'s session name.</p>\n\n<p><a href=\"http://www.gorillatoolkit.org/pkg/sessions#CookieStore.Get\" rel=\"nofollow\">http://www.gorillatoolkit.org/pkg/sessions#CookieStore.Get</a></p>\n\n<pre><code>var store = sessions.NewCookieStore([]byte(\"something-very-secret\"))\n\nfunc MyHandler(w http.ResponseWriter, r *http.Request) {\n    // Get a session. We're ignoring the error resulted from decoding an\n    // existing session: Get() always returns a session, even if empty.\n    session, _ := store.Get(r, \"session-name\")\n    // Set some session values.\n    session.Values[\"foo\"] = \"bar\"\n    session.Values[42] = 43\n    // Save it.\n    session.Save(r, w)\n}\n</code></pre>\n\n<p>I want to use session to avoid using global variables between two handlers. So I save the key-value in the shared session and retrieve the value from the session.</p>\n\n<p>And I wonder if I want each user to have its own unique session and its <code>Values</code>, do I need to assign unique session name(session id)? Or the gorilla session handles by itself that each user gets its own session and values?</p>\n\n<p>I wonder if I need to generate session names with unique identifiers.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1208, "user_id": 1198639, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1a4ae40d7871bc0c93776301e28b3548?s=128&d=identicon&r=PG", "display_name": "Will H", "link": "https://stackoverflow.com/users/1198639/will-h"}, "edited": false, "score": 0, "creation_date": 1425317772, "post_id": 28815815, "comment_id": 45903748, "body": "Thanks for the help on that."}, {"owner": {"reputation": 6849, "user_id": 1896761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e28ac3e5849a144937aa74efbc272e?s=128&d=identicon&r=PG", "display_name": "Austin Mullins", "link": "https://stackoverflow.com/users/1896761/austin-mullins"}, "edited": false, "score": 0, "creation_date": 1425322196, "post_id": 28815815, "comment_id": 45906074, "body": "In <code>Close</code>, was that supposed to be <code>my.db.Close()</code>?"}], "tags": [], "owner": {"reputation": 4679, "user_id": 749854, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/541a5cb4925d352cac921c21e9213aa4?s=128&d=identicon&r=PG", "display_name": "nvcnvn", "link": "https://stackoverflow.com/users/749854/nvcnvn"}, "is_accepted": true, "score": 2, "last_activity_date": 1425396483, "last_edit_date": 1425396483, "creation_date": 1425317060, "answer_id": 28815815, "question_id": 28815555, "link": "https://stackoverflow.com/questions/28815555/sharing-of-conn-pointer-between-interfaces-in-golang/28815815#28815815", "title": "Sharing of conn pointer between interfaces in golang", "body": "<p>Don't call <strong>defer db.Close()</strong> in your <strong>initDB</strong> function. After that function executed, db will close too! So when you call your method you get the closed error.<br>\nMaybe you need to re-desgin your interface, for example:</p>\n\n<pre><code>type Datastore interface {\n    Insert(table string, item DataItem) bool\n    CheckEmpty(table string) bool\n    FetchAll(table string) []DataItem\n    Close() error // call this method when you want to close the connection\n    initDB()\n}\n</code></pre>\n\n<p>Your <strong>MySQLDB</strong> implement now look like:</p>\n\n<pre><code>type MySQLDB struct {\n    config *config.Configuration\n    db *sqlx.DB\n}\n\n\nfunc (my *MySQLDB) initDB() {\n    log.Println(\"Getting DB Connection\")\n    tempdb, err := sqlx.Connect(\"mysql\", my.config.Database.Dsn+\"&amp;parseTime=True\")\n    if err != nil {\n        log.Println(err.Error())\n    }\n    my.db = tempdb\n}\n\nfunc (my *MySQLDB) Close() error {\n    return my.db.Close()\n}\n\nfunc (my *MySQLDB) FetchAll(table string) []DataItem {\n    dTable := []DataItem{}\n    query := \"SELECT foo, bar FROM \" + table + \" ORDER BY last_update ASC\"\n    err := my.db.Select(&amp;dTable, query)\n    if err != nil{\n        panic(err)\n    }\n    return dTable\n}\n</code></pre>\n"}], "owner": {"reputation": 1208, "user_id": 1198639, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1a4ae40d7871bc0c93776301e28b3548?s=128&d=identicon&r=PG", "display_name": "Will H", "link": "https://stackoverflow.com/users/1198639/will-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 640, "favorite_count": 0, "accepted_answer_id": 28815815, "answer_count": 1, "score": 0, "last_activity_date": 1425396483, "creation_date": 1425316165, "question_id": 28815555, "link": "https://stackoverflow.com/questions/28815555/sharing-of-conn-pointer-between-interfaces-in-golang", "title": "Sharing of conn pointer between interfaces in golang", "body": "<p>What I'm trying to accomplish is sharing a pointer of db.sqlx between multiple functions, except for posts saying pass along the pointer, which is fine but how to do that in an interface?  I cannot find anything that illustrates the use of this anywhere.  Basically what I have is an interface of type Datastore.  I also have mysql &amp; pgsql that implements the Datastore type.  The interface by itself works fine however the issue is I'm trying to create a single connect function for *sqlx.DB to be shared across all functions within the implemented interface.  I think the issue is I've confused myself on how to share the pointer between functions of the interface or even \"where\" to share it.  The main interface looks like below:</p>\n\n<pre><code>var (\n    storage Datastore\n    db * sqlx.DB\n)\n\ntype Datastore interface {\n    Insert(db *sqlx.DB, table string, item DataItem) bool\n    CheckEmpty(db *sqlx.DB, table string) bool\n    FetchAll(db *sqlx.DB, table string) []DataItem\n    DBInit(db *sqlx.DB)\n    initDB()\n}\n</code></pre>\n\n<p>Within my implemented interface (simplified mysql example) I have the initDB function which looks like this:</p>\n\n<pre><code>type MySQLDB struct {\n    config *config.Configuration\n}\n\n\nfunc (my *MySQLDB) initDB() {\n    log.Println(\"Getting DB Connection\")\n    tempdb, err := sqlx.Connect(\"mysql\", my.config.Database.Dsn+\"&amp;parseTime=True\")\n    if err != nil {\n        log.Println(err.Error())\n    }\n    db = tempdb\n    defer db.Close()\n}\n\nfunc (my *MySQLDB) FetchAll(db *sqlx.DB, table string) []DataItem {\n    dTable := []DataItem{}\n    query := \"SELECT foo, bar FROM \" + table + \" ORDER BY last_update ASC\"\n    err := db.Select(&amp;dTable, query)\n    if err != nil{\n        panic(err)\n    }\n    return dTable\n}\n</code></pre>\n\n<p>At this point I know the connection is initially opened but the next time a function is called I get db is closed error.  So how do I properly share the db connection between functions, or do I really have to run a connection open in every function?</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1425316544, "post_id": 28815334, "comment_id": 45902994, "body": "Suspect you just need to <code>recover()</code> in each handler (possibly by wrapping them in a panic-recovery function). (Sorry, not familiar enough with GAE, etc. to actually give you code.)"}], "answers": [{"comments": [{"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1425978671, "post_id": 28821182, "comment_id": 46171947, "body": "For some reasons it works when I recover from my own panics (i.e. like in the example you provided) but when some google packages (e.g.  google cloud storage  [0]  trying to write using a nil / incorrect context ) panics the program doesn&#39;t recover anymore. Any idea why? <a href=\"http://godoc.org/google.golang.org/cloud/storage#NewReader\" rel=\"nofollow noreferrer\">godoc.org/google.golang.org/cloud/storage#NewReader</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1425980025, "post_id": 28821182, "comment_id": 46172660, "body": "@Theuserwithnohat The protecting mechanism presented above can only recover from panics initiated from the <code>ServeHTTP()</code> method. I guess the panics that you can&#39;t catch are not called from within the <code>ServeHttp()</code> method but potentially from other goroutines (that may or may not be started from within your <code>ServeHTTP()</code> method)."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1425338510, "last_edit_date": 1425338510, "creation_date": 1425337969, "answer_id": 28821182, "question_id": 28815334, "link": "https://stackoverflow.com/questions/28815334/is-it-possible-to-recover-from-panic-on-google-app-engine/28821182#28821182", "title": "Is it possible to recover from panic on google app engine?", "body": "<p>Handlers in an AppEngine webapp are registered in the same way as would be in a normal Go application. You just don't have to call <code>http.ListenAndServe()</code> explicitly (because it will be by the platform), and handler registration happens in an <code>init()</code> function (not in <code>main()</code>).</p>\n\n<p>Having said that, the same panic-recover wrapping works on AppEngine too, and unfortunately there is no other, better way.</p>\n\n<p>Take a look at this example: it uses a function registered with <a href=\"http://golang.org/pkg/net/http/#HandleFunc\" rel=\"nofollow\"><code>HandleFunc()</code></a> and a <a href=\"http://golang.org/pkg/net/http/#Handler\" rel=\"nofollow\"><code>Handler</code></a> registered with <a href=\"http://golang.org/pkg/net/http/#Handle\" rel=\"nofollow\"><code>Handle()</code></a> to handle 2 URL patterns, but both intentionally panics (they refuse to serve):</p>\n\n<pre><code>func myHandleFunc(w http.ResponseWriter, r *http.Request) {\n    panic(\"I'm myHandlerFunc and I refuse to serve!\")\n}\n\ntype MyHandler int\n\nfunc (m *MyHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    panic(\"I'm MyHandler and I refuse to serve!\")\n}\n\nfunc main() {\n    http.HandleFunc(\"/myfunc\", myHandleFunc)\n    http.Handle(\"/myhandler\", new(MyHandler))\n\n    panic(http.ListenAndServe(\":8080\", nil))\n}\n</code></pre>\n\n<p>Directing your browser to <code>http://localhost:8080/myfunc</code> and <code>http://localhost:8080/myhandler</code> results in HTTP 500 status: internal server error (or an empty response depending on where you check it).</p>\n\n<p>The general idea is to use <code>recover</code> to \"catch\" the panics from handlers (<a href=\"http://golang.org/ref/spec#Handling_panics\" rel=\"nofollow\">spec: Handling panics</a>). We can \"wrap\" handle functions or Handlers in a way that we first register a <a href=\"http://golang.org/ref/spec#Defer_statements\" rel=\"nofollow\"><code>defer</code></a> statement which is called even if the rest of the function panics, and in which we recover from the panicing state.</p>\n\n<p>See these 2 functions:</p>\n\n<pre><code>func protectFunc(hf func(http.ResponseWriter,\n    *http.Request)) func(http.ResponseWriter, *http.Request) {\n    return func(w http.ResponseWriter, r *http.Request) {\n        defer func() {\n            r := recover()\n            if r != nil {\n                // hf() paniced, we just recovered from it.\n                // Handle error somehow, serve custom error page.\n                w.Write([]byte(\"Something went bad but I recovered and sent this!\"))\n            }\n        }()\n        hf(w, r)\n    }\n}\n\nfunc protectHandler(h http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        defer func() {\n            r := recover()\n            if r != nil {\n                // h.ServeHTTP() paniced, we just recovered from it.\n                // Handle error somehow, serve custom error page.\n                w.Write([]byte(\"Something went bad but I recovered and sent this!\"))\n            }\n        }()\n        h.ServeHTTP(w, r)\n    })\n}\n</code></pre>\n\n<p>The first one takes a function and returns one which calles the one we passed but recovers from panicing state if one was initiated.</p>\n\n<p>The second one takes a <code>Handler</code> and returns another <code>Handler</code> which similarly calls the passed one but also handles panics and restores normal execution.</p>\n\n<p>Now if we register handler functions and <code>Handler</code>s protected by these methods, the registered handlers will never panic (assuming the code after restoring normal execution does not panic):</p>\n\n<pre><code>http.HandleFunc(\"/myfunc-protected\", protectFunc(myHandleFunc))\nhttp.Handle(\"/myhandler-protected\", protectHandler(new(MyHandler)))\n</code></pre>\n\n<p>Visiting <code>http://localhost:8080/myfunc-protected</code> and <code>http://localhost:8080/myhandler-protected</code> URLs resuls in HTTP 200 status (OK) with the message:</p>\n\n<pre><code>Something went bad but I recovered and sent this!\n</code></pre>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 454, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1425338510, "creation_date": 1425315443, "question_id": 28815334, "link": "https://stackoverflow.com/questions/28815334/is-it-possible-to-recover-from-panic-on-google-app-engine", "title": "Is it possible to recover from panic on google app engine?", "body": "<p>I'm wondering if it's possible to recover from a panic. It seems GAE has it's own <a href=\"https://github.com/golang/appengine/blob/master/internal/api.go\" rel=\"nofollow\">panic recovery</a> mechanism but I can't find any hook to handle it on my app.</p>\n"}, {"tags": ["go", "protocol-buffers"], "comments": [{"owner": {"reputation": 6849, "user_id": 1896761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e28ac3e5849a144937aa74efbc272e?s=128&d=identicon&r=PG", "display_name": "Austin Mullins", "link": "https://stackoverflow.com/users/1896761/austin-mullins"}, "edited": false, "score": 0, "creation_date": 1425316397, "post_id": 28815214, "comment_id": 45902895, "body": "Take a look at the source for the extension handling code in the protobuf library <a href=\"https://github.com/golang/protobuf/blob/master/proto/extensions.go\" rel=\"nofollow noreferrer\">here</a>. I get the impression that they don&#39;t want you to access the <code>extensions</code> field directly, but you can get and set extensions using API functions like <code>GetExtensions</code>."}, {"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1425316429, "post_id": 28815214, "comment_id": 45902917, "body": "There&#39;s <code>GetExtension</code>, <code>GetExtensions</code> and <code>SetExtention</code>. Do you need to do something that those functions can&#39;t handle?"}], "answers": [{"comments": [{"owner": {"reputation": 1972, "user_id": 1377728, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2489a7615f0beecb9b37213f184e84ff?s=128&d=identicon&r=PG", "display_name": "Doron Segal", "link": "https://stackoverflow.com/users/1377728/doron-segal"}, "edited": false, "score": 0, "creation_date": 1543432886, "post_id": 28815658, "comment_id": 93922105, "body": "Hi @sberry what if you have a large number of extensions? is there a way to get the extension type by a string?  meaning Person have <code>ex_type</code>"}], "tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": false, "score": 2, "last_activity_date": 1425316904, "last_edit_date": 1425316904, "creation_date": 1425316522, "answer_id": 28815658, "question_id": 28815214, "link": "https://stackoverflow.com/questions/28815214/how-to-set-get-protobufs-extension-field-in-go/28815658#28815658", "title": "How to set/get protobuf&#39;s extension field in Go?", "body": "<p>Getting the extension...</p>\n\n<pre><code>yourExtendedEvent := &amp;path_to_your_events.Person{}\nerr := proto.Unmarshal(yourBytes, yourExtendedEvent)\nif err != nil {\n    // handle error case\n}\nextendedEvent, extendedError := proto.GetExtension(\n    yourExtendedEvent,\n    path_to_your_events.E_Height,\n)\n...\n</code></pre>\n\n<p>Setting the extension...</p>\n\n<pre><code>yourExtendedEvent := &amp;path_to_your_events.Person{\n    Field1: proto.Uint64(1),\n    Field2: proto.String(\"foo\"),\n}\n\nheight := &amp;path_to_your_events.Height {\n    Field1: proto.Int64(120),\n}\n\nerr := proto.SetExtension(\n    yourExtendedEvent,\n    path_to_your_events.E_Height,\n    height,\n)\n\nif err != nil {\n    // handle error case\n}\n</code></pre>\n\n<p><strong>EDIT</strong>  </p>\n\n<p>Actually, if I am reading it right, your extension is just a single field (an int32) so I don't know that you actually have a <code>Height</code> type.  If not, it might be more like</p>\n\n<pre><code>height := proto.Int32(120)\n</code></pre>\n\n<p>And then you set the same way with height as a single field rather than as a distinct proto type.  </p>\n\n<p>This line</p>\n\n<pre><code>ExtensionType: (*int32)(nil),\n</code></pre>\n\n<p>Makes me think it will be a single field, whereas our extensions look more like</p>\n\n<pre><code>ExtensionType: (*SomeOtherType)(nil),\n</code></pre>\n\n<p>This is a good resource\n<a href=\"https://github.com/golang/protobuf/blob/master/proto/extensions_test.go#L96\" rel=\"nofollow\">TestExtensionsRoundTrip</a></p>\n"}], "owner": {"reputation": 21, "user_id": 4624253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33f20cf1751048042b6c8ad546acd2e?s=128&d=identicon&r=PG&f=1", "display_name": "jack Sun", "link": "https://stackoverflow.com/users/4624253/jack-sun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4014, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1425316904, "creation_date": 1425315137, "last_edit_date": 1425315976, "question_id": 28815214, "link": "https://stackoverflow.com/questions/28815214/how-to-set-get-protobufs-extension-field-in-go", "title": "How to set/get protobuf&#39;s extension field in Go?", "body": "<p>I am a Go language developer. Our team chose to use protocol buffers to transform data.\nI chose this protobuf package:  <a href=\"https://github.com/golang/protobuf\" rel=\"nofollow\">https://github.com/golang/protobuf</a>.\nHowever, this package has no method to handle the <code>extensions</code> field in a protocol buffer. I have only found this code in the class file generated by protoc:</p>\n\n<pre><code>var E_Height = &amp;proto.ExtensionDesc{\n    ExtendedType:  (*Person)(nil),\n    ExtensionType: (*int32)(nil),\n    Field:         110,\n    Name:          \"eg.Height\",\n    Tag:           \"varint,110,opt\",\n}\n\nfunc init() {\n    proto.RegisterExtension(E_Height)\n}\n</code></pre>\n\n<p>So, how can I set/get the <code>extensions</code> field in Go?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1425313771, "post_id": 28814366, "comment_id": 45901239, "body": "Can you show us a sample, or the structure of the json returned?"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1425313866, "post_id": 28814366, "comment_id": 45901294, "body": "From what I see, you clearly have a map with three keys, <code>error</code>, <code>error_description</code> and <code>error_code</code>. Just print <code>len(v)</code> or <code>v[&quot;error_code&quot;]</code>."}, {"owner": {"reputation": 395, "user_id": 636599, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/30eb9d8543d9f120fd762c6f53420ac7?s=128&d=identicon&r=PG", "display_name": "JSP", "link": "https://stackoverflow.com/users/636599/jsp"}, "edited": false, "score": 0, "creation_date": 1425314742, "post_id": 28814366, "comment_id": 45901871, "body": "It was decoding the JSON correctly all long.  I was reading the log line as essentially map[&quot;error_description:that is not a recognized WePay API call error_code:1001 error:invalid_request&quot;] (the key as the entire JSON string) instead of it being a map with these 3 values.  Bottom line I&#39;m an idiot ;)"}], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 1995288, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5d9Nr.jpg?s=128&g=1", "display_name": "Vinit Gaikwad", "link": "https://stackoverflow.com/users/1995288/vinit-gaikwad"}, "edited": false, "score": 0, "creation_date": 1443474970, "post_id": 28814763, "comment_id": 53499706, "body": "How to retrieve individual values from this interface?"}, {"owner": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "reply_to_user": {"reputation": 319, "user_id": 1995288, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5d9Nr.jpg?s=128&g=1", "display_name": "Vinit Gaikwad", "link": "https://stackoverflow.com/users/1995288/vinit-gaikwad"}, "edited": false, "score": 0, "creation_date": 1443476187, "post_id": 28814763, "comment_id": 53500255, "body": "@VinitGaikwad <code>result[&quot;error&quot;].(string)</code> and similar for the others"}], "tags": [], "owner": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "is_accepted": true, "score": 2, "last_activity_date": 1443476210, "last_edit_date": 1443476210, "creation_date": 1425313824, "answer_id": 28814763, "question_id": 28814366, "link": "https://stackoverflow.com/questions/28814366/using-golang-json-newdecoder-json-newencoder/28814763#28814763", "title": "Using Golang json.NewDecoder / json.NewEncoder", "body": "<p><code>Decoder</code> will decode the whole <code>JSON</code> value at once (in this case the error object), you don;y have to call it in a loop:</p>\n\n<pre><code>if err := dec.Decode(&amp;v); err != nil {\n    log.Println(\"ERROR: \" + err.Error())\n    return\n}\n</code></pre>\n\n<p>As a response you get a map equavalent of this <code>JSON</code>:</p>\n\n<pre><code>{\"error\":\"invalid_request\",\"error_description\":\"that is not a recognized WePay API call\",\"error_code\":1001}\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>map[string]interface{} {\n    \"error\":\"invalid_request\",\n    \"error_description\":\"that is not a recognized WePay API call\",\n    \"error_code\":1001,\n}\n</code></pre>\n"}], "owner": {"reputation": 395, "user_id": 636599, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/30eb9d8543d9f120fd762c6f53420ac7?s=128&d=identicon&r=PG", "display_name": "JSP", "link": "https://stackoverflow.com/users/636599/jsp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5369, "favorite_count": 0, "accepted_answer_id": 28814763, "answer_count": 1, "score": 2, "last_activity_date": 1443476210, "creation_date": 1425312705, "question_id": 28814366, "link": "https://stackoverflow.com/questions/28814366/using-golang-json-newdecoder-json-newencoder", "title": "Using Golang json.NewDecoder / json.NewEncoder", "body": "<p>I'm a total noob at go and I'm trying to understand what I'm missing here.  I'm expecting to use <code>dec.Decode</code> to loop over the json values and end up with a map of the response.  What I'm getting is the entire json string as the key to the first element of the map.  What am I missing?</p>\n\n<p>Example response:</p>\n\n<p><code>2015/03/02 10:03:16 map[error:invalid_request error_description:that is not a recognized WePay API call error_code:1001] map[string]interface {}</code></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"io\"\n    \"log\"\n    \"net/http\"\n    \"reflect\"\n)\n\nfunc main() {\n    var v map[string]interface{}\n    resp, err := http.Get(\"https://wepayapi.com/v2/\")\n    if err != nil {\n        log.Println(\"Error: \" + err.Error())\n    }   \n    defer resp.Body.Close()\n\n    // resp.Body is an io.ReadCloser... NewDecoder expects an io.Reader\n    dec := json.NewDecoder(resp.Body)\n\n    // Decode reads the next JSON-encoded value from its input and stores it in the value pointed to by v.\n    for err := dec.Decode(&amp;v); err != nil &amp;&amp; err != io.EOF; {\n        log.Println(\"ERROR: \" + err.Error())\n        return\n    }   \n    log.Println(v, reflect.TypeOf(v))\n}\n</code></pre>\n"}, {"tags": ["go", "martini"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 1, "last_activity_date": 1425312359, "creation_date": 1425312359, "answer_id": 28814259, "question_id": 28814114, "link": "https://stackoverflow.com/questions/28814114/put-the-http-handler-in-martini/28814259#28814259", "title": "Put the http.Handler in martini", "body": "<p>I believe the FileServer isn't used directly in Martini: see <a href=\"https://github.com/go-martini/martini/issues/20\" rel=\"nofollow\">issues/20</a>:</p>\n\n<blockquote>\n  <p>Unfortunately The fileserver middleware throws a 404 if there is no match, which means we will need to roll our own</p>\n</blockquote>\n\n<p>Hence <a href=\"https://github.com/go-martini/martini/pull/26\" rel=\"nofollow\">PR 26</a> and <a href=\"https://github.com/go-martini/martini/commit/a945713cdd5c8f7413ef6d07f897e2c9faff8531\" rel=\"nofollow\">commit a945713</a> in <a href=\"https://github.com/go-martini/martini/blob/a945713cdd5c8f7413ef6d07f897e2c9faff8531/static.go\" rel=\"nofollow\"><code>static.go</code></a> that you can see in <a href=\"https://github.com/go-martini/martini/blob/7d32ea3fa6590565c928b90a48178b60b96df98f/static_test.go\" rel=\"nofollow\"><code>static_test.go</code></a></p>\n\n<pre><code>m := New()\nr := NewRouter()\nm.Use(Static(currentRoot))\nm.Action(r.Handle)\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4624007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe7df13f037232c92d313ef33c8b0124?s=128&d=identicon&r=PG&f=1", "display_name": "dazhuo", "link": "https://stackoverflow.com/users/4624007/dazhuo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 1, "accepted_answer_id": 28814259, "answer_count": 1, "score": 1, "last_activity_date": 1425312359, "creation_date": 1425311978, "question_id": 28814114, "link": "https://stackoverflow.com/questions/28814114/put-the-http-handler-in-martini", "title": "Put the http.Handler in martini", "body": "<p>How do I integrate just like <code>http.FileServer</code> with martini? \n`   package main</p>\n\n<pre><code>import (\n    \"github.com/go-martini/martini\"\n    \"net/http\"\n)\n\nfunc main() {\n    m := martini.Classic()\n    //http.Handle(\"/\", http.FileServer(http.Dir(\".\"))) //It doesn't work!\n    m.Run()\n}`\n</code></pre>\n"}, {"tags": ["go", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": false, "score": 0, "last_activity_date": 1425310562, "last_edit_date": 1425310562, "creation_date": 1425310243, "answer_id": 28813477, "question_id": 28812496, "link": "https://stackoverflow.com/questions/28812496/is-there-a-better-way-to-parse-a-mongodb-query-in-go/28813477#28813477", "title": "Is there a better way to parse a mongodb query in go?", "body": "<p>Yes, there is a better way. Break your code into multiple lines and use comma after last element in map or array. Then the code will be formatted automatically and you will also get a readable error messages indicating line.</p>\n\n<pre><code>package main\n\ntype M map[string]M\n\nvar x = M{\n    \"a\": M{\n        \"b\": M{},\n        \"c\": M{},\n    },\n}\n</code></pre>\n\n<p>By the way. Look at this part <code>bson.M{\"$clktime\"}, bson.M{60 * 5}}</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "edited": false, "score": 0, "creation_date": 1425317802, "post_id": 28813559, "comment_id": 45903772, "body": "Can you elaborate on what this is doing?"}, {"owner": {"reputation": 6945, "user_id": 2288944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/7qryD.jpg?s=128&g=1", "display_name": "armnotstrong", "link": "https://stackoverflow.com/users/2288944/armnotstrong"}, "edited": false, "score": 0, "creation_date": 1425357683, "post_id": 28813559, "comment_id": 45919453, "body": "I find it&#39;s illuminating to using <code>[]interface{}</code> when come to arrays <code>[&quot;$clktime&quot;, 60*5]</code> in the query command, although the sentence you write may not be correct in this situation, inspired me, through, thank you"}], "tags": [], "owner": {"reputation": 11, "user_id": 4624031, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9beadaaaaa19549657f195ec96881598?s=128&d=identicon&r=PG", "display_name": "Morty", "link": "https://stackoverflow.com/users/4624031/morty"}, "is_accepted": false, "score": 0, "last_activity_date": 1425310502, "creation_date": 1425310502, "answer_id": 28813559, "question_id": 28812496, "link": "https://stackoverflow.com/questions/28812496/is-there-a-better-way-to-parse-a-mongodb-query-in-go/28813559#28813559", "title": "Is there a better way to parse a mongodb query in go?", "body": "<pre><code>    x := []bson.M{{\"$match\": bson.M{\"clktime\": bson.M{\"gt\": 1425289561}}},{\"$group\": bson.M{\"_id\": bson.M{\"$subtract\": []interface{}{\"$clktime\", bson.M{\"$mod\": []interface{}{\"$clktime\", 60 * 5}}}}, \"count\": bson.M{\"$sum\": 1}}}}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6945, "user_id": 2288944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/7qryD.jpg?s=128&g=1", "display_name": "armnotstrong", "link": "https://stackoverflow.com/users/2288944/armnotstrong"}, "is_accepted": false, "score": 0, "last_activity_date": 1425357753, "last_edit_date": 1425357753, "creation_date": 1425357446, "answer_id": 28824189, "question_id": 28812496, "link": "https://stackoverflow.com/questions/28812496/is-there-a-better-way-to-parse-a-mongodb-query-in-go/28824189#28824189", "title": "Is there a better way to parse a mongodb query in go?", "body": "<p>Finally, I have write this out, but the suggestions @Grzegorz give(which to split the building or query to multi lines for convenience) and also considered @Morty's opinion(which using <code>[]interface{}</code> when come to arrays in query command). And here is what I got which works:</p>\n\n<pre><code>q := []bson.M{\n    bson.M{\n        \"$match\": bson.M{\n            \"clktime\": bson.M{\n                \"$gt\": 1425289561,\n            },\n        },\n    },\n    bson.M{\n        \"$group\": bson.M{\n            \"_id\": bson.M{\n                \"$subtract\": []interface{}{\n                    \"$clktime\",\n                    bson.M{\n                        \"$mod\": []interface{}{\n                            \"$clktime\",\n                            60 * 5,\n                        },\n                    },\n                },\n            },\n            \"count\": bson.M{\"$sum\": 1},\n        },\n    },\n}\n</code></pre>\n\n<p>Hope it will be helpful for other people come to similar issue.</p>\n"}], "owner": {"reputation": 6945, "user_id": 2288944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/7qryD.jpg?s=128&g=1", "display_name": "armnotstrong", "link": "https://stackoverflow.com/users/2288944/armnotstrong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1605, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1425357753, "creation_date": 1425307381, "question_id": 28812496, "link": "https://stackoverflow.com/questions/28812496/is-there-a-better-way-to-parse-a-mongodb-query-in-go", "title": "Is there a better way to parse a mongodb query in go?", "body": "<p>Hi I got a sort of complex aggregate query that I must write with mgo, but I got really dazed when work it out half way :-(, Is there a better way to do that ? </p>\n\n<p>Here is a console query aggregate command that I have tested and it works.</p>\n\n<pre><code>db.event.aggregate([{$match:{clktime:{$gt:1425289561}}},{$group:{\"_id\":{$subtract:[\"$clktime\",{$mod:[\"$clktime\", 60*5]}]}, count:{$sum:1}}}])\n</code></pre>\n\n<p>And here is what I have got so far:</p>\n\n<pre><code>c.Pipe([]bson.M{bson.M{\"$match\": bson.M{\"clktime\": bson.M{\"$gt\": 1425289561}}}, bson.M{\"$group\": bson.M{\"_id\": bson.M{\"$subtract\": []bson.M{bson.M{\"$clktime\"}, bson.M{\"$mod\": []bson.M{bson.M{\"$clktime\"}, bson.M{60 * 5}}}}}}, \"count\": bson.M{\"$sum\": 1}}})\n</code></pre>\n\n<p>It says that <strong>there is a missing key in map literal</strong>, but I can't find where.</p>\n\n<p>I thought human beings don't deserve that, I am so desperate T_T.</p>\n\n<p>Is there a better or humanity way to do that ?</p>\n"}, {"tags": ["database", "postgresql", "go", "benchmarking"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1425309440, "post_id": 28812293, "comment_id": 45898221, "body": "Your gist is not loading for me."}, {"owner": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "edited": false, "score": 0, "creation_date": 1425310227, "post_id": 28812293, "comment_id": 45898751, "body": "Remove the .git suffix to view it online."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1425310275, "post_id": 28812293, "comment_id": 45898771, "body": "What exactly is giving you the &quot;too many connections&quot; error? Postgres, go,  ab? (and please try something other than ab)"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 2, "creation_date": 1425310604, "post_id": 28812293, "comment_id": 45899000, "body": "The &quot;problem&quot; is that go spawns a new goroutine and db connection per incoming request, so you probably blow out the database&#39;s incoming connection. You can limit that with something like a worker pool and channels for incoming/outgoing requests, or some sort of barrier that makes sure no more than N requests are being sent to the database at once."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1425317088, "post_id": 28812293, "comment_id": 45903313, "body": "Agree with Not_a_Golfer: &quot;too many connections&quot; sounds like something from the DB. And it&#39;s there for a reason: if running all those long queries is doing real work, then running too many of them is going to starve new queries of resources and make the DB slow to do anything. You might end up having to work out how not to be constantly running many copies of this long query, either by caching it for one user and showing the cached result to others (if applicable) or tuning the SQL."}, {"owner": {"reputation": 332, "user_id": 1190411, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cbd50a86ebdb58788e32848a01ced3f1?s=128&d=identicon&r=PG", "display_name": "user1190411", "link": "https://stackoverflow.com/users/1190411/user1190411"}, "edited": false, "score": 0, "creation_date": 1425393883, "post_id": 28812293, "comment_id": 45938765, "body": "The spawning part is correct, as the query is long running and as I understand that every request spawns, then all the resources are consumed. Would a framework like martini etc. solve the problem for me? Being a new gopher, it is hard to work with high powered tool without protection and keep all my mental limbs :D I&#39;m surprised that node is not going berserk."}], "answers": [{"comments": [{"owner": {"reputation": 332, "user_id": 1190411, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cbd50a86ebdb58788e32848a01ced3f1?s=128&d=identicon&r=PG", "display_name": "user1190411", "link": "https://stackoverflow.com/users/1190411/user1190411"}, "edited": false, "score": 0, "creation_date": 1425366861, "post_id": 28817985, "comment_id": 45922655, "body": "Hm, are the other frameworks limiting artificially or have set default values? And if I limit, will it cause benchmark to time out again? Forgot to mention, that the sql query takes 10-20 seconds to run, so it is easy to overload the database and fill the open connections :)"}, {"owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "reply_to_user": {"reputation": 332, "user_id": 1190411, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cbd50a86ebdb58788e32848a01ced3f1?s=128&d=identicon&r=PG", "display_name": "user1190411", "link": "https://stackoverflow.com/users/1190411/user1190411"}, "edited": false, "score": 0, "creation_date": 1425377867, "post_id": 28817985, "comment_id": 45928518, "body": "I suspect that the other frameworks aren&#39;t truly concurrent, as in they will be processing some of the requests sequentially.  Your original Go code will definitely make 100 simultaneous connections to the database... As for will it timeout - I don&#39;t know - you&#39;ll have to experiment."}], "tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": false, "score": 2, "last_activity_date": 1425324698, "creation_date": 1425324698, "answer_id": 28817985, "question_id": 28812293, "link": "https://stackoverflow.com/questions/28812293/how-do-i-write-long-running-requests-in-go/28817985#28817985", "title": "How do I write long running requests in go?", "body": "<p>The trouble looks like you are overloading your database with too many simultaneous connections. Remember Go is a truly concurrent language.</p>\n\n<p>Have you tried setting <code>db.SetMaxOpenConns(1000)</code> to a much smaller number, say <code>db.SetMaxOpenConns(10)</code>?</p>\n\n<p>Or alternatively you could limit the number of simultaneously running goroutines like this</p>\n\n<p>Declare these globally</p>\n\n<pre><code>const maxAtOnce = 50\n\nvar limiter = make(chan struct{}, maxAtOnce)\n\nfunc init() {\n    // Fill up with tokens\n    for i := 0; i &lt; maxAtOnce; i++ {\n        limiter &lt;- struct{}{}\n    }\n}\n</code></pre>\n\n<p>And in your <code>getTimeSheet</code> put this at the start</p>\n\n<pre><code>// take a token\n&lt;-limiter\n// give it back on exit\ndefer func() {\n    limiter &lt;- struct{}{}\n}()\n</code></pre>\n"}], "owner": {"reputation": 332, "user_id": 1190411, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cbd50a86ebdb58788e32848a01ced3f1?s=128&d=identicon&r=PG", "display_name": "user1190411", "link": "https://stackoverflow.com/users/1190411/user1190411"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1425324698, "creation_date": 1425306734, "last_edit_date": 1425317800, "question_id": 28812293, "link": "https://stackoverflow.com/questions/28812293/how-do-i-write-long-running-requests-in-go", "title": "How do I write long running requests in go?", "body": "<p>Story so far. We are thinking about switching away from perl. The candidates are go or node. For that we wrote simple wrappers in Dancer2, Flask, Node and Go for a long running database query that we have. I had them all up and running, so I benchmarked a bit with light load. Then I decided to stress the applications. Every framework was able to cope with</p>\n\n<pre><code>ab -n 1000 -c 100 http://localhost:8080/\n</code></pre>\n\n<p>except go. If I did not limit connection then I would get error 'too many connections', if I limited connections to 100, then ab would give timeout error and quit.</p>\n\n<p>My gist <a href=\"https://gist.github.com/2d8473ce576cab5f7c66\" rel=\"nofollow\">https://gist.github.com/2d8473ce576cab5f7c66</a> with go code. What should I change, so I can use go server under load?</p>\n"}, {"tags": ["xml", "go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 0, "last_activity_date": 1425308508, "last_edit_date": 1425308508, "creation_date": 1425306920, "answer_id": 28812360, "question_id": 28811899, "link": "https://stackoverflow.com/questions/28811899/parsing-a-tei-xml-with-golang/28812360#28812360", "title": "Parsing a tei XML with golang", "body": "<p>It is perfectly fine to read this XML using <a href=\"http://golang.org/pkg/encoding/xml/#Unmarshal\" rel=\"nofollow\">xml.Unmarshal()</a>.</p>\n\n<p>The problem is that the XML structure is the following:</p>\n\n<pre><code>&lt;TEI&gt;\n    &lt;text&gt;\n        &lt;sp&gt;\n        &lt;/sp&gt;\n        &lt;sp&gt;\n        &lt;/sp&gt;\n    &lt;/text&gt;\n&lt;/TEI&gt;\n</code></pre>\n\n<p>And your Go structure is the following:</p>\n\n<pre><code>Page\n    []Speak\n</code></pre>\n\n<p><strong>There is one missing layer.</strong> Your <code>Page</code> might match the <code>&lt;TEI&gt;</code> or <code>&lt;text&gt;</code> element, but not both. It works for you if you remove the <code>&lt;TEI&gt;</code> element because then <code>Page</code> can match <code>&lt;text&gt;</code> and its contents.</p>\n\n<p><strong>Solution:</strong></p>\n\n<p>Add another wrapper like this:</p>\n\n<pre><code>type Text struct {\n    Txt Page `xml:\"text\"`\n}\n</code></pre>\n\n<p>And of course parse a value of this type:</p>\n\n<pre><code>var p Text\nerr := xml.Unmarshal([]byte(data), &amp;p)\n</code></pre>\n\n<p>Try it your modified code on the <a href=\"http://play.golang.org/p/DuMW9GLHnS\" rel=\"nofollow\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 1041, "user_id": 1070980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/edac813115d540c99244cbb5a629fd95?s=128&d=identicon&r=PG", "display_name": "robert laing", "link": "https://stackoverflow.com/users/1070980/robert-laing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 28812360, "answer_count": 1, "score": 1, "last_activity_date": 1481048581, "creation_date": 1425305577, "last_edit_date": 1481048581, "question_id": 28811899, "link": "https://stackoverflow.com/questions/28811899/parsing-a-tei-xml-with-golang", "title": "Parsing a tei XML with golang", "body": "<p>I need to parse a tei XML file with golang. I tried using the encoding/xml unmarshaller. Here is the example:\n<a href=\"http://play.golang.org/p/h0k-4IjngY\" rel=\"nofollow noreferrer\">http://play.golang.org/p/h0k-4IjngY</a></p>\n\n<p>Problems:</p>\n\n<ol>\n<li>Even if tei file is not valid and the xml is valid the example returns me nothing. If I remove line 23 <code>&lt;TEI&gt;</code> (so xml is not anymore valid), the example prints something.</li>\n<li>How can I have the Line struct a string containing the content of <code>&lt;l&gt;</code> element?</li>\n<li>In the Page struct I need the value of <code>n</code> attribute, how do I achieve this?</li>\n</ol>\n\n<p>Is unmarshalling the right way to parse these kinds of files or nokogiri would be a better solution?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "bson", "mgo"], "comments": [{"owner": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "edited": false, "score": 0, "creation_date": 1425310734, "post_id": 28810662, "comment_id": 45899101, "body": "The struct tag <code>bson:&quot;-&quot;</code> tells bson to ignore the C field of Child."}, {"owner": {"reputation": 1792, "user_id": 1544643, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/EoQoF.png?s=128&g=1", "display_name": "Alain1405", "link": "https://stackoverflow.com/users/1544643/alain1405"}, "reply_to_user": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "edited": false, "score": 0, "creation_date": 1425311608, "post_id": 28810662, "comment_id": 45899750, "body": "Which is a problem as Child has to be stored as a standalone document as well."}], "answers": [{"tags": [], "owner": {"reputation": 18455, "user_id": 2657550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88d553accfca32636d96a8d5075e85d1?s=128&d=identicon&r=PG", "display_name": "Gustavo Niemeyer", "link": "https://stackoverflow.com/users/2657550/gustavo-niemeyer"}, "is_accepted": true, "score": 2, "last_activity_date": 1425480543, "creation_date": 1425480543, "answer_id": 28857434, "question_id": 28810662, "link": "https://stackoverflow.com/questions/28810662/model-relationships-in-mgo/28857434#28857434", "title": "Model relationships in mgo", "body": "<p>You are probably looking for the <code>bson:\",omitempty\"</code> tag instead of <code>bson:\"-\"</code>. The former will omit the field only if it is empty, instead of at all times. Alternatively, you can also have a secondary <code>ChildReference</code> type that is used on references only. It's fine to use different types with the same collection.</p>\n\n<p>As an aside, note that although that practice is used in some situations, you don't <em>have</em> to store the collection name next to the document id in all cases. The most common practice for well defined schemas is to store simply the document id (e.g. with <code>{\"person_id\": 123}</code> the meaning is clear).</p>\n"}], "owner": {"reputation": 1792, "user_id": 1544643, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/EoQoF.png?s=128&g=1", "display_name": "Alain1405", "link": "https://stackoverflow.com/users/1544643/alain1405"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1606, "favorite_count": 2, "accepted_answer_id": 28857434, "answer_count": 1, "score": 1, "last_activity_date": 1425480543, "creation_date": 1425301968, "question_id": 28810662, "link": "https://stackoverflow.com/questions/28810662/model-relationships-in-mgo", "title": "Model relationships in mgo", "body": "<p>I'm writing a db interface with mgo.\nSome documents in my model reference other documents. </p>\n\n<pre><code>type Child struct{\n    Id       bson.ObjectId   `json:\"_id,omitempty\" bson:\"_id,omitempty\"`\n    C        string\n}\n\ntype Parent struct {\n    Id       bson.ObjectId   `json:\"_id,omitempty\" bson:\"_id,omitempty\"`\n    A        string          \n    B        Child           \n}\n\nchild := Child{\n    Id: bson.NewObjectId(),\n    C: \"panino\"\n}\n\nparent := Parent{\n    Id: bson.NewObjectId(),\n    A: \"Just a string\",\n    B: child,\n}\n</code></pre>\n\n<p>My aim is to:</p>\n\n<ol>\n<li>keep these documents embedded in the code, </li>\n<li>store parent in Parents collection with only a reference to child,</li>\n<li>store child in Children collection as a standalone document. </li>\n</ol>\n\n<p>The following:</p>\n\n<pre><code>type Child struct{\n    Id       bson.ObjectId   `json:\"_id,omitempty\" bson:\"_id,omitempty\"`\n    C        string          `bson:\"-\"`\n}\n</code></pre>\n\n<p>succeeds in 1 and 2 but only child.Id get stored in Children collection.\nI'm very new to Golang/mgo. I played a bit with Marshaling and Unmarshaling, but I don't quite understand how Getter and Setter work. I have the feeling they would do the trick though.\nAny clue?</p>\n"}, {"tags": ["xml", "go", "sequence", "choice"], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 4, "last_activity_date": 1425300540, "creation_date": 1425300540, "answer_id": 28810229, "question_id": 28809738, "link": "https://stackoverflow.com/questions/28809738/how-to-map-an-xml-sequence-of-mixed-elements-to-a-go-struct/28810229#28810229", "title": "How to map an xml sequence of mixed elements to a go struct?", "body": "<p>You can use <code>xml:\",any\"</code> tag on your root node and then unmarshal the rest into structs that have an <code>XMLName</code> field like this:</p>\n\n<pre><code>type RootNode struct {\n    Elements []Element `xml:\",any\"`\n}\n\ntype Element struct {\n    XMLName xml.Name\n}\n</code></pre>\n\n<p>More on <code>xml:\",any\"</code> and <code>XMLName</code> <a href=\"http://golang.org/pkg/encoding/xml/#Unmarshal\" rel=\"nofollow\">here</a>.</p>\n\n<p>Playground example: <a href=\"http://play.golang.org/p/Vl9YI8GG1E\" rel=\"nofollow\">http://play.golang.org/p/Vl9YI8GG1E</a></p>\n"}], "owner": {"reputation": 53, "user_id": 4622859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d6387ce301419d87da5f42f55f9b7c2?s=128&d=identicon&r=PG&f=1", "display_name": "failed onceagain", "link": "https://stackoverflow.com/users/4622859/failed-onceagain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 572, "favorite_count": 2, "accepted_answer_id": 28810229, "answer_count": 1, "score": 5, "last_activity_date": 1425300540, "creation_date": 1425299140, "question_id": 28809738, "link": "https://stackoverflow.com/questions/28809738/how-to-map-an-xml-sequence-of-mixed-elements-to-a-go-struct", "title": "How to map an xml sequence of mixed elements to a go struct?", "body": "<p>'m trying to load an XML file that contains an unbounded sequence of mixed elements (a choice in a sequence in the XSD)\nThe file looks like that : </p>\n\n<pre><code>&lt;RootNode&gt;\n    &lt;ElementB&gt;...&lt;/ElementB&gt;\n    &lt;ElementA&gt;...&lt;/ElementA&gt;\n    &lt;ElementA&gt;...&lt;/ElementA&gt;\n    &lt;ElementC&gt;...&lt;/ElementC&gt;\n    &lt;ElementB&gt;...&lt;/ElementB&gt;\n    &lt;ElementA&gt;...&lt;/ElementA&gt;\n    &lt;ElementB&gt;...&lt;/ElementB&gt;\n&lt;/RootNode&gt;\n</code></pre>\n\n<p>I use xml.Unmarshal to initialize and fill these structs : </p>\n\n<pre><code>type RootNode struct {\n    ElementA []ElementA\n    ElementB []ElementB\n    ElementC []ElementC\n}\n\ntype ElementA struct {\n}\n\ntype ElementB struct {\n}\n\ntype ElementC struct {\n}\n</code></pre>\n\n<p>I have working exemple here <a href=\"http://play.golang.org/p/ajIReJS35F\" rel=\"noreferrer\">http://play.golang.org/p/ajIReJS35F</a>.\nThe problem is that i need to know the index of the elements in the original sequence. And with that description, this info is lost.</p>\n\n<p>Is there a way to to load elements of type ElementA, ElementB or ElementC in the same array ? More generally, what is the best way to map a list of mixed elements to a go struct ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 3, "creation_date": 1425335617, "post_id": 28809094, "comment_id": 45913205, "body": "Add <code>q.Items[0] = nil</code> between when you set <code>item</code> and when you reslice. That will remove the reference to the item from the slice so that it can be garbage collected earlier (if it&#39;s something on the heap that can be collected). Otherwise you&#39;ll keep the reference around until the next time <code>append</code> within <code>Push</code> happens to do a realloc+copy of the array that is backing the slice."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1425336204, "post_id": 28809094, "comment_id": 45913488, "body": "If your queue will have a fixed maximum size then you can just use a buffered channel. When the buffer is full you could either have the &quot;push&quot; block or use a trivial <code>select</code> loop to return a &quot;queue full&quot; error."}], "answers": [{"comments": [{"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 1, "creation_date": 1425299202, "post_id": 28809560, "comment_id": 45891630, "body": "slicing like that is basically a memory leak, no?  that slice is backed by an actual array, and a sub-slice is the same array.  So as you consume you are just removing from view, not from memory.  Maybe append will discard old items when it has to grow array.  But if you use a large capacity up front, it&#39;s basically a memory leak, I believe.  This may be ok depending on how long app runs and how much memory you have"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 2, "creation_date": 1425335858, "post_id": 28809560, "comment_id": 45913328, "body": "@DavidBudworth, as long as <code>q.Items[0] = nil</code> is added (as described in a comment on the question) then there is no leak. <code>append</code> will grow the underlying array as required and when doing so will only copy over the currently used items. E.g. if the slice is currently referencing the last n items of much larger array, when it reaches capacity then <code>append</code> will allocate an array of size n+1+someAmount and copy the n items before adding the new one."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1425335996, "post_id": 28809560, "comment_id": 45913394, "body": "Also, for that reason using an initial capacity that is much larger then the typical length of the queue won&#39;t make any difference after the first realloc. E.g. with an initial capacity of 100 and a queue that normally has ~5 items in it, after the 101st <code>Push</code> the underlying array will likely be just 8 items long."}], "tags": [], "owner": {"reputation": 21722, "user_id": 357705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cb8f635bfd71c18b91e1b0ed5d2ee9?s=128&d=identicon&r=PG", "display_name": "jimt", "link": "https://stackoverflow.com/users/357705/jimt"}, "is_accepted": true, "score": 3, "last_activity_date": 1615888279, "last_edit_date": 1615888279, "creation_date": 1425298533, "answer_id": 28809560, "question_id": 28809094, "link": "https://stackoverflow.com/questions/28809094/simple-concurrent-queue/28809560#28809560", "title": "Simple concurrent queue", "body": "<p>The re-slicing is not an issue here. It will also make no difference whether you have a thread-safe or unsafe version as this is pretty much how the re-sizing is meant to be done.</p>\n<p>You can alleviate some of the re-sizing overhead by initializing the queue with a capacity:</p>\n<pre><code>func NewQueue(capacity int) *Queue {\n    return &amp;Queue {\n        Items: make([]interface{}, 0, capacity),\n    }\n}\n</code></pre>\n<p>This will initialize the queue. It can still grow beyond the capacity, but you will not be having any unnecessary copying/re-allocation until that capacity is reached.</p>\n<p>What may potentially cause problems with many concurrent accesses, is the mutex lock. At some point, you will be spending more time waiting for locks to be released than you are actually doing work. This is a general problem with lock contention and can be solved by implementing the queue as a lock-free data structure.</p>\n<p>There are a few third-party packages out there which provide lock free implementations of basic data structures.</p>\n<p>Whether this will actually be useful to you can only be determined with some benchmarking. Lock-free structures can have a higher base cost, but they scale much better when you get many concurrent users. There is a cutoff point at which mutex locks become more expensive than the lock-free approach.</p>\n"}, {"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1425336086, "post_id": 28809578, "comment_id": 45913435, "body": "I&#39;d only use a linked list if it was commonly required to remove arbitrary items or insert items into an arbitrary position. For a simple FIFO queue either a channel or a slice is simpler, easier, etc."}, {"owner": {"reputation": 771, "user_id": 1715470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bcadf360dfb4207fdb68b89aa5bc179?s=128&d=identicon&r=PG", "display_name": "kruczy", "link": "https://stackoverflow.com/users/1715470/kruczy"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1425378855, "post_id": 28809578, "comment_id": 45929133, "body": "well I think a list is a better choice though probably running benchmarks might answer that better"}], "tags": [], "owner": {"reputation": 771, "user_id": 1715470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bcadf360dfb4207fdb68b89aa5bc179?s=128&d=identicon&r=PG", "display_name": "kruczy", "link": "https://stackoverflow.com/users/1715470/kruczy"}, "is_accepted": false, "score": 1, "last_activity_date": 1425298587, "creation_date": 1425298587, "answer_id": 28809578, "question_id": 28809094, "link": "https://stackoverflow.com/questions/28809094/simple-concurrent-queue/28809578#28809578", "title": "Simple concurrent queue", "body": "<p>I think the best way to approach this is to use a linked list, there is already one available for you in standard package <a href=\"http://golang.org/pkg/container/list/\" rel=\"nofollow\">here</a></p>\n"}, {"comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1425432142, "post_id": 28828891, "comment_id": 45959021, "body": "This should be the proper solution."}, {"owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "edited": false, "score": 0, "creation_date": 1496436173, "post_id": 28828891, "comment_id": 75678185, "body": "Would this be considered the proper approach to threadsafe queue?"}, {"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 0, "creation_date": 1496659808, "post_id": 28828891, "comment_id": 75735568, "body": "Yes, channels are the idiomatic solution for queues of messages."}, {"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 0, "creation_date": 1496660042, "post_id": 28828891, "comment_id": 75735719, "body": "You would only need to implement a more complex alternative if disk-based persistence is needed - for example for durability over some app or server restart. Or possibly you need huge (&#39;infinite&#39;) disk-based queues. In both these cases, you should design an api with channel ends for insertion and extraction operations so that the complex queue could be a drop-in replacement for a Go channel."}], "tags": [], "owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "is_accepted": false, "score": 7, "last_activity_date": 1597748410, "last_edit_date": 1597748410, "creation_date": 1425376952, "answer_id": 28828891, "question_id": 28809094, "link": "https://stackoverflow.com/questions/28809094/simple-concurrent-queue/28828891#28828891", "title": "Simple concurrent queue", "body": "<p>You could simply use a buffered channel.</p>\n<pre><code>var queue = make(chan interface{}, 100)\n</code></pre>\n<p>The size of the buffer could to be determined empirically to be large enough for the high-water mark for the rate of pushes vs rate of pops. It should ideally not be much larger than this, to avoid wasting memory.</p>\n<p>Indeed, a smaller buffer size will also work, provided the interacting goroutines don't deadlock for other reasons. If you use a smaller buffer size, you are effectively getting queueing via the run-queue of the goroutine time-slice engine, part of the Go runtime. (Quite possible, a buffer size of zero could work in many circumstances.)</p>\n<p>Channels allow many reader goroutines and many writer goroutines. The concurrency of their access is handled automatically by the Go runtime. All writes into the channel are interleaved so as to be a sequential stream. All the reads are also interleaved to extract values sequentially in the same order they were enqueued. Here's <a href=\"https://stackoverflow.com/questions/15715605/multiple-goroutines-listening-on-one-channel/15721380#15721380\">further discussion</a> on this topic.</p>\n"}], "owner": {"reputation": 2325, "user_id": 1492051, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/07ecac667abb2bfa8d6698dc629bbb54?s=128&d=identicon&r=PG", "display_name": "FPGA", "link": "https://stackoverflow.com/users/1492051/fpga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5978, "favorite_count": 1, "accepted_answer_id": 28809560, "answer_count": 3, "score": 0, "last_activity_date": 1615888279, "creation_date": 1425296959, "last_edit_date": 1567784376, "question_id": 28809094, "link": "https://stackoverflow.com/questions/28809094/simple-concurrent-queue", "title": "Simple concurrent queue", "body": "<p>Could someone please mention the flaws and performance drawbacks in the Queue like implementation?</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Queue struct {\n    sync.Mutex\n    Items []interface{}\n}\n\nfunc (q *Queue) Push(item interface{}) {\n    q.Lock()\n    defer q.Unlock()\n    q.Items = append(q.Items, item)\n}\n\nfunc (q *Queue) Pop() interface{} {\n    q.Lock()\n    defer q.Unlock()\n    if len(q.Items) == 0 {\n        return nil\n    }\n    item := q.Items[0]\n    q.Items = q.Items[1:]\n    return item\n}\n</code></pre>\n\n<p>I also have methods like <code>PopMany</code> and <code>PushMany</code>, and what I am concerned about is: Is too much re-slicing that bad?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1425335046, "post_id": 28806972, "comment_id": 45912914, "body": "Why do people not read the language spec/reference and, you know, actually <i>learn the language</i> before typing random stuff they make up and wondering why it doesn&#39;t work??&lt;/rant&gt; [sigh]"}], "answers": [{"tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": true, "score": 3, "last_activity_date": 1425290972, "creation_date": 1425290972, "answer_id": 28807122, "question_id": 28806972, "link": "https://stackoverflow.com/questions/28806972/switch-or-operator-compiler-error/28807122#28807122", "title": "Switch or operator compiler error", "body": "<p>Just use comma <code>,</code> instead of <code>||</code>.</p>\n\n<pre><code>case \"POST\", \"PUT\", \"DELETE\":\n</code></pre>\n\n<p>See <a href=\"http://golang.org/ref/spec#Switch_statements\" rel=\"nofollow\">switch statement reference</a>.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 28807122, "answer_count": 1, "score": -3, "last_activity_date": 1425290972, "creation_date": 1425290510, "question_id": 28806972, "link": "https://stackoverflow.com/questions/28806972/switch-or-operator-compiler-error", "title": "Switch or operator compiler error", "body": "<p>I have following code that compiler complain.</p>\n\n<pre><code>switch req.Method {\n        case \"POST\" || \"PUT\" || \"DELETE\":\n            if req.Header.Get(\"Content-Type\") != \"application/json\" {\n                return handleErr(req)\n            }\n    }\n</code></pre>\n\n<p>Compiler error message </p>\n\n<pre><code>..\\..\\controllers\\routes\\header.go:59: invalid operation: \"POST\" || \"PUT\" (operator || not defined on string)\n</code></pre>\n\n<p>Do I use OR operator in wrong way?</p>\n"}, {"tags": ["json", "dictionary", "go", "interface"], "answers": [{"comments": [{"owner": {"reputation": 1032, "user_id": 1148993, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/mSL1j.jpg?s=128&g=1", "display_name": "Sreejith Ramakrishnan", "link": "https://stackoverflow.com/users/1148993/sreejith-ramakrishnan"}, "edited": false, "score": 0, "creation_date": 1425292213, "post_id": 28807170, "comment_id": 45887812, "body": "Also, if <code>foo</code> is of type <code>interface{}</code>, what&#39;s the difference between doing <code>string(foo)</code> and <code>foo.(string)</code>?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1032, "user_id": 1148993, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/mSL1j.jpg?s=128&g=1", "display_name": "Sreejith Ramakrishnan", "link": "https://stackoverflow.com/users/1148993/sreejith-ramakrishnan"}, "edited": false, "score": 0, "creation_date": 1425294127, "post_id": 28807170, "comment_id": 45888814, "body": "@SreejithRamakrishnan I don&#39;t think there is any significant performance hit as if you use a custom <code>struct</code>, it is also populated via reflection."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1032, "user_id": 1148993, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/mSL1j.jpg?s=128&g=1", "display_name": "Sreejith Ramakrishnan", "link": "https://stackoverflow.com/users/1148993/sreejith-ramakrishnan"}, "edited": false, "score": 2, "creation_date": 1425294378, "post_id": 28807170, "comment_id": 45888954, "body": "@SreejithRamakrishnan And yes, there is difference between <code>stirng(foo)</code> and <code>foo.(string)</code>. First is a <i>conversion</i>, the latter is a <i>type assertion</i>. Type assersion can only be used on <i>interface types</i> (<code>interface{}</code> is an empty interface which qualifies), and for the rules of conversion read the spec: <a href=\"http://golang.org/ref/spec#Conversions\" rel=\"nofollow noreferrer\">Conversions</a>. If your case you can&#39;t use conversion only type assertion."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 36, "last_activity_date": 1425294674, "last_edit_date": 1425294674, "creation_date": 1425291097, "answer_id": 28807170, "question_id": 28806951, "link": "https://stackoverflow.com/questions/28806951/accessing-nested-map-of-type-mapstringinterface-in-golang/28807170#28807170", "title": "Accessing Nested Map of Type map[string]interface{} in Golang", "body": "<p>The notation <code>x.(T)</code> is called a <a href=\"http://golang.org/ref/spec#Type_assertions\" rel=\"noreferrer\">Type Assertion</a>.</p>\n\n<blockquote>\n  <p>For an expression <code>x</code> of interface type and a type <code>T</code>, the primary expression <code>x.(T)</code> asserts that <code>x</code> is not <code>nil</code> and that the value stored in <code>x</code> is of type <code>T</code>.</p>\n</blockquote>\n\n<p>Your example:</p>\n\n<pre><code>result[\"args\"].(map[string]interface{})[\"foo\"]\n</code></pre>\n\n<p>It means that the value of your <code>results</code> map associated with key <code>\"args\"</code> is of type <code>map[string]interface{}</code> (another map with <code>string</code> keys and any values). And you want to access the element of that map associated with the key <code>\"foo\"</code>.</p>\n\n<p>If you know noting about the input JSON format, then yes, you have to use a generic <code>map[string]interface{}</code> type to process it. If you know the exact structure of the input JSON, you can create a <code>struct</code> to match the expected fields, and doing so you can unmarshal a JSON text into a value of your custom <code>struct</code> type, for example:</p>\n\n<pre><code>type Point struct {\n    Name string\n    X, Y int\n}\n\nfunc main() {\n    in := `{\"Name\":\"center\",\"X\":2,\"Y\":3}`\n\n    pt := Point{}\n    json.Unmarshal([]byte(in), &amp;pt)\n\n    fmt.Printf(\"Result: %+v\", pt)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Result: {Name:center X:2 Y:3}\n</code></pre>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/9P3kdq6Cg0\" rel=\"noreferrer\">Go Playground</a>.</p>\n\n<h2>Modeling your input</h2>\n\n<p>Your current JSON input could be modelled with this type:</p>\n\n<pre><code>type Data struct {\n    Args struct {\n        Foo string\n    }\n}\n</code></pre>\n\n<p>And accessing <code>Foo</code> (try it on the <a href=\"http://play.golang.org/p/80dWvpwUsH\" rel=\"noreferrer\">Go Playground)</a>:</p>\n\n<pre><code>d := Data{}\njson.Unmarshal([]byte(in), &amp;d)\nfmt.Println(\"Foo:\", d.Args.Foo)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 0, "last_activity_date": 1608473143, "creation_date": 1608473143, "answer_id": 65380727, "question_id": 28806951, "link": "https://stackoverflow.com/questions/28806951/accessing-nested-map-of-type-mapstringinterface-in-golang/65380727#65380727", "title": "Accessing Nested Map of Type map[string]interface{} in Golang", "body": "<p>I prefer to add a type declaration for a Map, then you can add methods to help\nwith the type assertions:</p>\n<pre><code>package main\nimport &quot;encoding/json&quot;\ntype Map map[string]interface{}\n\nfunc (m Map) M(s string) Map {\n   return m[s].(map[string]interface{})\n}\n\nfunc (m Map) S(s string) string {\n   return m[s].(string)\n}\n\nfunc main() {\n   apiResponse := []byte(`{&quot;args&quot;: {&quot;foo&quot;: &quot;bar&quot;}}`)\n   result := Map{}\n   json.Unmarshal(apiResponse, &amp;result)\n   foo := result.M(&quot;args&quot;).S(&quot;foo&quot;)\n   println(foo == &quot;bar&quot;)\n}\n</code></pre>\n<p><a href=\"https://golang.org/ref/spec#Type_declarations\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Type_declarations</a></p>\n"}], "owner": {"reputation": 1032, "user_id": 1148993, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/mSL1j.jpg?s=128&g=1", "display_name": "Sreejith Ramakrishnan", "link": "https://stackoverflow.com/users/1148993/sreejith-ramakrishnan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26878, "favorite_count": 9, "accepted_answer_id": 28807170, "answer_count": 2, "score": 19, "last_activity_date": 1608473143, "creation_date": 1425290453, "last_edit_date": 1438447927, "question_id": 28806951, "link": "https://stackoverflow.com/questions/28806951/accessing-nested-map-of-type-mapstringinterface-in-golang", "title": "Accessing Nested Map of Type map[string]interface{} in Golang", "body": "<p>So I'm trying to parse a JSON response. It can be multiple levels deep. This is what I did:</p>\n\n<pre><code>var result map[string]interface{}\njson.Unmarshal(apiResponse, &amp;result)\n</code></pre>\n\n<p><strong>Firstly, is this the right way to do it?</strong></p>\n\n<p>Lets say the response was as follows:</p>\n\n<pre><code>{\n  \"args\": {\n            \"foo\": \"bar\"\n          }\n}\n</code></pre>\n\n<p>To access key <code>foo</code>, I saw a <a href=\"http://play.golang.org/p/D2cz2Af4vE\" rel=\"noreferrer\">playground</a> doing this:</p>\n\n<pre><code>result[\"args\"].(map[string]interface{})[\"foo\"]\n</code></pre>\n\n<p>Here, what is the <code>.()</code> notation? Is this correct?</p>\n"}, {"tags": ["go", "extension-methods"], "comments": [{"owner": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "edited": false, "score": 0, "creation_date": 1482406582, "post_id": 28800672, "comment_id": 69766063, "body": "Interestingly extension methods are considered as non object-oriented (<a href=\"https://blogs.msdn.microsoft.com/ericlippert/2008/10/28/the-future-of-c-part-two/\" rel=\"nofollow noreferrer\"><i><code>\u201cextension methods are not object-oriented\u201d</code></i></a>) for C#, but when looking at them today, I was immediately remembered of Go&#39;s interfaces (and its approach to rethink object orientation), and then I had this very question."}], "answers": [{"comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 12, "creation_date": 1425254552, "post_id": 28800807, "comment_id": 45875386, "body": "Or just use a function...?"}, {"owner": {"reputation": 2129, "user_id": 1210278, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5120fc4e345db0d1a964888272073819?s=128&d=identicon&r=PG", "display_name": "Riking", "link": "https://stackoverflow.com/users/1210278/riking"}, "reply_to_user": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 5, "creation_date": 1454557214, "post_id": 28800807, "comment_id": 58101131, "body": "@Paul doing this is required to override functions like String() and MarshalJSON()"}, {"owner": {"reputation": 10343, "user_id": 108857, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4e8076a0fdac6b8f284d8b316efdf7f3?s=128&d=identicon&r=PG", "display_name": "docwhat", "link": "https://stackoverflow.com/users/108857/docwhat"}, "edited": false, "score": 39, "creation_date": 1461987639, "post_id": 28800807, "comment_id": 61459255, "body": "If you do the first part, then how do you coerce the <code>mux.Router</code> instances to <code>MyRouter</code>s?  e.g. if you have a library that returns <code>mux.Router</code> but you want to use your new methods?"}, {"owner": {"reputation": 206, "user_id": 493316, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/eda8bc78dfba62918b9f63c731bbc1ad?s=128&d=identicon&r=PG", "display_name": "tfzxyinhao", "link": "https://stackoverflow.com/users/493316/tfzxyinhao"}, "edited": false, "score": 0, "creation_date": 1466062427, "post_id": 28800807, "comment_id": 63164002, "body": "how to use the first solution? MyRouter(router)"}, {"owner": {"reputation": 476, "user_id": 144411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f6fbd05e123ff2bb1d34de48424ddc1?s=128&d=identicon&r=PG", "display_name": "ivanjovanovic", "link": "https://stackoverflow.com/users/144411/ivanjovanovic"}, "edited": false, "score": 1, "creation_date": 1485792525, "post_id": 28800807, "comment_id": 71061059, "body": "embedding seems a bit more practical to use."}, {"owner": {"reputation": 3344, "user_id": 903998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pZCd4.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/903998/victor"}, "reply_to_user": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1533165548, "post_id": 28800807, "comment_id": 90251260, "body": "@PaulHankin how many ways are at disposal for adapting an struct to an interface? as far i get to know, By type embed (or wrap) or type alias there is a way to archive it."}, {"owner": {"reputation": 3344, "user_id": 903998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pZCd4.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/903998/victor"}, "edited": false, "score": 0, "creation_date": 1534443076, "post_id": 28800807, "comment_id": 90717674, "body": "@all, above i leave an open question... please anyone with the time and will, consider to provide an opinion! Would be nice!"}, {"owner": {"reputation": 2886, "user_id": 2081835, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4741683a91497af9910946e555ebfe0e?s=128&d=identicon&r=PG", "display_name": "TheHerk", "link": "https://stackoverflow.com/users/2081835/theherk"}, "reply_to_user": {"reputation": 3344, "user_id": 903998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pZCd4.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/903998/victor"}, "edited": false, "score": 0, "creation_date": 1534892205, "post_id": 28800807, "comment_id": 90865943, "body": "@Victor, there is precisely one way to make a struct satisfy an interface; the type must implement the methods as defined by the interface."}, {"owner": {"reputation": 847, "user_id": 3172290, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MIH9i.jpg?s=128&g=1", "display_name": "aniztar", "link": "https://stackoverflow.com/users/3172290/aniztar"}, "edited": false, "score": 0, "creation_date": 1613710237, "post_id": 28800807, "comment_id": 117165432, "body": "I did only the golang official tour to learn the language. So I feel quite empowered after I read this answer and came to know of Embedding!"}], "tags": [], "owner": {"reputation": 21722, "user_id": 357705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cb8f635bfd71c18b91e1b0ed5d2ee9?s=128&d=identicon&r=PG", "display_name": "jimt", "link": "https://stackoverflow.com/users/357705/jimt"}, "is_accepted": true, "score": 194, "last_activity_date": 1425254522, "creation_date": 1425254522, "answer_id": 28800807, "question_id": 28800672, "link": "https://stackoverflow.com/questions/28800672/how-to-add-new-methods-to-an-existing-type-in-go/28800807#28800807", "title": "How to add new methods to an existing type in Go?", "body": "<p>As the compiler mentions, you can't extend existing types in another package. You can define your own alias or sub-package as follows:</p>\n\n<pre><code>type MyRouter mux.Router\n\nfunc (m *MyRouter) F() { ... }\n</code></pre>\n\n<p>or by embedding the original router:</p>\n\n<pre><code>type MyRouter struct {\n    *mux.Router\n}\n\nfunc (m *MyRouter) F() { ... }\n\n...\nr := &amp;MyRouter{router}\nr.F()\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3344, "user_id": 903998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pZCd4.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/903998/victor"}, "edited": false, "score": 0, "creation_date": 1533230135, "post_id": 43507669, "comment_id": 90281595, "body": "your post is very helpful as show a lot of research and effort trying to compare point by point each tecniche.. allow me to encourage you to think what happens in terms of conversion to a given interface. I mean, if you have a struct and you want that struct (from a third party vendor let&#39;s assume) you want to adapt to a given interface, who do you manage to get that? You could employ type alias or type embed for that."}, {"owner": {"reputation": 2886, "user_id": 2081835, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4741683a91497af9910946e555ebfe0e?s=128&d=identicon&r=PG", "display_name": "TheHerk", "link": "https://stackoverflow.com/users/2081835/theherk"}, "reply_to_user": {"reputation": 3344, "user_id": 903998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pZCd4.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/903998/victor"}, "edited": false, "score": 0, "creation_date": 1534350200, "post_id": 43507669, "comment_id": 90677451, "body": "@Victor I don&#39;t follow your question, but I think your asking how to get a struct you don&#39;t control to satisfy a given interface. Short answer, you don&#39;t except by contributing to that codebase. However, using the material in this post, you can create another struct from the first, then implement the interface on that struct. See this <a href=\"https://play.golang.org/p/sDFBros3Wm_6\" rel=\"nofollow noreferrer\">playground example</a>."}, {"owner": {"reputation": 3344, "user_id": 903998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pZCd4.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/903998/victor"}, "edited": false, "score": 0, "creation_date": 1534443095, "post_id": 43507669, "comment_id": 90717684, "body": "hi @TheHerk, What i&#39;m aim is to you to point out another difference when &quot;extending&quot; a struct from another package. Looks like to me, that there are two ways to archeive this, by using type alias (your example) and using type embed (<a href=\"https://play.golang.org/p/psejeXYbz5T\" rel=\"nofollow noreferrer\">play.golang.org/p/psejeXYbz5T</a>). For me it looks like that type alias make easier the conversion as you only need a <i>type conversion</i>, if you use type wrap you need to reference the &quot;parent&quot; struct by using a dot, thus, accessing the parent type itself. I guess is up to the client code..."}, {"owner": {"reputation": 3344, "user_id": 903998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pZCd4.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/903998/victor"}, "edited": false, "score": 0, "creation_date": 1534443123, "post_id": 43507669, "comment_id": 90717701, "body": "please, see the motivation of this topic here <a href=\"https://stackoverflow.com/a/28800807/903998\">stackoverflow.com/a/28800807/903998</a>, follow the comments and i hope you will see my point"}, {"owner": {"reputation": 2886, "user_id": 2081835, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4741683a91497af9910946e555ebfe0e?s=128&d=identicon&r=PG", "display_name": "TheHerk", "link": "https://stackoverflow.com/users/2081835/theherk"}, "reply_to_user": {"reputation": 3344, "user_id": 903998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pZCd4.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/903998/victor"}, "edited": false, "score": 0, "creation_date": 1534891811, "post_id": 43507669, "comment_id": 90865824, "body": "I wish I could follow your meaning, but I&#39;m still having trouble. In the answer upon which we are writing these comments, I explain both embedding and aliasing, including the advantages and disadvantages of each. I&#39;m not advocating for one over the other. It may be that your are suggesting I missed one of those pros or cons."}, {"owner": {"reputation": 2886, "user_id": 2081835, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4741683a91497af9910946e555ebfe0e?s=128&d=identicon&r=PG", "display_name": "TheHerk", "link": "https://stackoverflow.com/users/2081835/theherk"}, "reply_to_user": {"reputation": 3344, "user_id": 903998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pZCd4.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/903998/victor"}, "edited": false, "score": 0, "creation_date": 1534891898, "post_id": 43507669, "comment_id": 90865841, "body": "As far as having to use the dot to reference the embedded child, you only have to do so, if the parent doesn&#39;t contain the method or attribute being referenced, which avoids ambiguity in those cases. See <a href=\"https://play.golang.org/p/O5FGX9p3Iyf\" rel=\"nofollow noreferrer\">this playground example</a> where I added a call to a method in the embedded type without using the dot notation to reference that type."}, {"owner": {"reputation": 3498, "user_id": 6801443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09cba631e2b30cf9b6b8fa433996ef1e?s=128&d=identicon&r=PG&f=1", "display_name": "Sean F", "link": "https://stackoverflow.com/users/6801443/sean-f"}, "edited": false, "score": 0, "creation_date": 1540415098, "post_id": 43507669, "comment_id": 92862315, "body": "The alias does allow access to the methods if you use type assertion.  So, for instance, you would do asserted := imported.Thing(myThing) and then call methods on asserted."}, {"owner": {"reputation": 1598, "user_id": 1410221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/CW5Pu.jpg?s=128&g=1", "display_name": "HappyFace", "link": "https://stackoverflow.com/users/1410221/happyface"}, "edited": false, "score": 0, "creation_date": 1598734287, "post_id": 43507669, "comment_id": 112557431, "body": "How do you coerce the mux.Router instances to MyRouters? e.g. if you have a library that returns mux.Router but you want to use your new methods?"}, {"owner": {"reputation": 2219, "user_id": 8608146, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3B2gl.jpg?s=128&g=1", "display_name": "Phani Rithvij", "link": "https://stackoverflow.com/users/8608146/phani-rithvij"}, "reply_to_user": {"reputation": 1598, "user_id": 1410221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/CW5Pu.jpg?s=128&g=1", "display_name": "HappyFace", "link": "https://stackoverflow.com/users/1410221/happyface"}, "edited": false, "score": 0, "creation_date": 1604278352, "post_id": 43507669, "comment_id": 114290765, "body": "@HappyFace In that case won&#39;t this work? <code>child := &amp;childPointerParent{&amp;parent{}}</code> i.e. <code>parentRouter := function(...); cRouter := &amp;RouterChildPointer{&amp;parentRouter}</code> now <code>cRouter.Method(...)</code>"}], "tags": [], "owner": {"reputation": 2886, "user_id": 2081835, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4741683a91497af9910946e555ebfe0e?s=128&d=identicon&r=PG", "display_name": "TheHerk", "link": "https://stackoverflow.com/users/2081835/theherk"}, "is_accepted": false, "score": 148, "last_activity_date": 1567106906, "last_edit_date": 1567106906, "creation_date": 1492644139, "answer_id": 43507669, "question_id": 28800672, "link": "https://stackoverflow.com/questions/28800672/how-to-add-new-methods-to-an-existing-type-in-go/43507669#43507669", "title": "How to add new methods to an existing type in Go?", "body": "<p>I wanted to expand on the answer given by @jimt <a href=\"https://stackoverflow.com/a/28800807/2081835\">here</a>. That answer is correct and helped me tremendously in sorting this out. However, there are some caveats to both methods (alias, embed) with which I had trouble.</p>\n\n<p><em>note</em>: I use the terms parent and child, though I'm not sure that is the best for composition. Basically, parent is the type which you want to modify locally. Child is the new type that attempts to implement that modification.</p>\n\n<h3>Method 1 - Type Definition</h3>\n\n<pre><code>type child parent\n// or\ntype MyThing imported.Thing\n</code></pre>\n\n<ul>\n<li>Provides access to the fields.</li>\n<li>Does not provide access to the methods.</li>\n</ul>\n\n<h3>Method 2 - Embedding (<a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"noreferrer\">official documentation</a>)</h3>\n\n<pre><code>type child struct {\n    parent\n}\n// or with import and pointer\ntype MyThing struct {\n    *imported.Thing\n}\n</code></pre>\n\n<ul>\n<li>Provides access to the fields.</li>\n<li>Provides access to the methods.</li>\n<li>Requires consideration for initialization.</li>\n</ul>\n\n<h3>Summary</h3>\n\n<ul>\n<li>Using the composition method the embedded parent will not initialize if it is a pointer. The parent must be initialized separately.</li>\n<li>If the embedded parent is a pointer and is not initialized when the child is initialized, a nil pointer dereference error will occur.</li>\n<li>Both type definition and embed cases provide access to the fields of the parent.</li>\n<li>The type definition does not allow access to the parent's methods, but embedding the parent does.</li>\n</ul>\n\n<p>You can see this in the following code.</p>\n\n<p><a href=\"https://play.golang.org/p/x6q-2HUfTH\" rel=\"noreferrer\">working example on the playground</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype parent struct {\n    attr string\n}\n\ntype childAlias parent\n\ntype childObjParent struct {\n    parent\n}\n\ntype childPointerParent struct {\n    *parent\n}\n\nfunc (p *parent) parentDo(s string) { fmt.Println(s) }\nfunc (c *childAlias) childAliasDo(s string) { fmt.Println(s) }\nfunc (c *childObjParent) childObjParentDo(s string) { fmt.Println(s) }\nfunc (c *childPointerParent) childPointerParentDo(s string) { fmt.Println(s) }\n\nfunc main() {\n    p := &amp;parent{\"pAttr\"}\n    c1 := &amp;childAlias{\"cAliasAttr\"}\n    c2 := &amp;childObjParent{}\n    // When the parent is a pointer it must be initialized.\n    // Otherwise, we get a nil pointer error when trying to set the attr.\n    c3 := &amp;childPointerParent{}\n    c4 := &amp;childPointerParent{&amp;parent{}}\n\n    c2.attr = \"cObjParentAttr\"\n    // c3.attr = \"cPointerParentAttr\" // NOGO nil pointer dereference\n    c4.attr = \"cPointerParentAttr\"\n\n    // CAN do because we inherit parent's fields\n    fmt.Println(p.attr)\n    fmt.Println(c1.attr)\n    fmt.Println(c2.attr)\n    fmt.Println(c4.attr)\n\n    p.parentDo(\"called parentDo on parent\")\n    c1.childAliasDo(\"called childAliasDo on ChildAlias\")\n    c2.childObjParentDo(\"called childObjParentDo on ChildObjParent\")\n    c3.childPointerParentDo(\"called childPointerParentDo on ChildPointerParent\")\n    c4.childPointerParentDo(\"called childPointerParentDo on ChildPointerParent\")\n\n    // CANNOT do because we don't inherit parent's methods\n    // c1.parentDo(\"called parentDo on childAlias\") // NOGO c1.parentDo undefined\n\n    // CAN do because we inherit the parent's methods\n    c2.parentDo(\"called parentDo on childObjParent\")\n    c3.parentDo(\"called parentDo on childPointerParent\")\n    c4.parentDo(\"called parentDo on childPointerParent\")\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 0, "last_activity_date": 1611268852, "creation_date": 1611268852, "answer_id": 65836840, "question_id": 28800672, "link": "https://stackoverflow.com/questions/28800672/how-to-add-new-methods-to-an-existing-type-in-go/65836840#65836840", "title": "How to add new methods to an existing type in Go?", "body": "<p>Expanding on one of the other answers, in my case the parent is an array. If you\nwant to add methods, but also have access to the parent methods, you must wrap\nwhen defining the type, and wrap when declaring a variable:</p>\n<pre><code>package main\n\ntype parent []int\n\nfunc (p parent) first() int {\n   return p[0]\n}\n\ntype child struct {\n   parent\n}\n\nfunc (c child) second() int {\n   return c.parent[1]\n}\n\nfunc main() {\n   a := child{\n      parent{1, 2},\n   }\n   first := a.first()\n   second := a.second()\n   println(first == 1, second == 2)\n}\n</code></pre>\n"}], "owner": {"reputation": 10946, "user_id": 1259261, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a105607c3fd93df0d386c6d6a6b4aad?s=128&d=identicon&r=PG", "display_name": "Daniel Robinson", "link": "https://stackoverflow.com/users/1259261/daniel-robinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78059, "favorite_count": 51, "accepted_answer_id": 28800807, "answer_count": 3, "score": 148, "last_activity_date": 1611268852, "creation_date": 1425253496, "last_edit_date": 1554156178, "question_id": 28800672, "link": "https://stackoverflow.com/questions/28800672/how-to-add-new-methods-to-an-existing-type-in-go", "title": "How to add new methods to an existing type in Go?", "body": "<p>I want to add a convenience util method on to <code>gorilla/mux</code> Route and Router types:</p>\n\n<pre><code>package util\n\nimport(\n    \"net/http\"\n    \"github.com/0xor1/gorillaseed/src/server/lib/mux\"\n)\n\nfunc (r *mux.Route) Subroute(tpl string, h http.Handler) *mux.Route{\n    return r.PathPrefix(\"/\" + tpl).Subrouter().PathPrefix(\"/\").Handler(h)\n}\n\nfunc (r *mux.Router) Subroute(tpl string, h http.Handler) *mux.Route{\n    return r.PathPrefix(\"/\" + tpl).Subrouter().PathPrefix(\"/\").Handler(h)\n}\n</code></pre>\n\n<p>but the compiler informs me</p>\n\n<blockquote>\n  <p>Cannot define new methods on non-local type mux.Router</p>\n</blockquote>\n\n<p>So how would I achieve this? Do I create a new struct type that has an anonymous mux.Route and mux.Router fields? Or something else?</p>\n"}, {"tags": ["go", "bitbucket"], "comments": [{"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1425247621, "post_id": 28799661, "comment_id": 45873491, "body": "Wow. Please. Please give us the relevant information to help you. We aren&#39;t standing behind you .. and we certainly aren&#39;t mind readers. I am sorry but your screenshot and your single sentence make zero sense. You even have <code>revel</code> randomly tagged."}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1425248141, "post_id": 28799661, "comment_id": 45873653, "body": "Thanks for editing. Are you pushing your <i>entire</i> GOPATH up to Bitbucket?"}, {"owner": {"reputation": 220, "user_id": 4017025, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-5OrL0KDNrn0/AAAAAAAAAAI/AAAAAAAAADw/7JoTQG9KHiY/photo.jpg?sz=128", "display_name": "WarrenV", "link": "https://stackoverflow.com/users/4017025/warrenv"}, "reply_to_user": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1425248158, "post_id": 28799661, "comment_id": 45873659, "body": "@SimonWhitehead, I edited my post. Please let me know if I make sense now."}, {"owner": {"reputation": 220, "user_id": 4017025, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-5OrL0KDNrn0/AAAAAAAAAAI/AAAAAAAAADw/7JoTQG9KHiY/photo.jpg?sz=128", "display_name": "WarrenV", "link": "https://stackoverflow.com/users/4017025/warrenv"}, "reply_to_user": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1425248212, "post_id": 28799661, "comment_id": 45873675, "body": "@SimonWhitehead, Yes I am pushing my entire GOPATH up to Bitbucket."}, {"owner": {"reputation": 220, "user_id": 4017025, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-5OrL0KDNrn0/AAAAAAAAAAI/AAAAAAAAADw/7JoTQG9KHiY/photo.jpg?sz=128", "display_name": "WarrenV", "link": "https://stackoverflow.com/users/4017025/warrenv"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1425248697, "post_id": 28799661, "comment_id": 45873810, "body": "@JimB, sorry about that. I posted my question without any clarification/explanation at first because I wanted to test out if I can post an image( this is the 1st time I am posting an image). I have edit my post. Would you be able to help now?"}], "answers": [{"comments": [{"owner": {"reputation": 220, "user_id": 4017025, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-5OrL0KDNrn0/AAAAAAAAAAI/AAAAAAAAADw/7JoTQG9KHiY/photo.jpg?sz=128", "display_name": "WarrenV", "link": "https://stackoverflow.com/users/4017025/warrenv"}, "edited": false, "score": 0, "creation_date": 1425248833, "post_id": 28799716, "comment_id": 45873854, "body": "I edit my post. I am trying to use git push to push my GOPATH into Bitbucket. However, when I logged into Bitbucket, I do not see my file instead I see an arrow pointing to a bunch of char+numbers."}, {"owner": {"reputation": 3094, "user_id": 1572233, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e11b6b1471a04b78bae081589b87c9b8?s=128&d=identicon&r=PG", "display_name": "giaour", "link": "https://stackoverflow.com/users/1572233/giaour"}, "reply_to_user": {"reputation": 220, "user_id": 4017025, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-5OrL0KDNrn0/AAAAAAAAAAI/AAAAAAAAADw/7JoTQG9KHiY/photo.jpg?sz=128", "display_name": "WarrenV", "link": "https://stackoverflow.com/users/4017025/warrenv"}, "edited": false, "score": 1, "creation_date": 1425249846, "post_id": 28799716, "comment_id": 45874155, "body": "Right, what you&#39;re seeing is a way git stores references to other git repositories. Try taking a look at this tutorial for an alternative approach: <a href=\"https://github.com/jamesgraves/example-go-app\" rel=\"nofollow noreferrer\">github.com/jamesgraves/example-go-app</a>"}], "tags": [], "owner": {"reputation": 3094, "user_id": 1572233, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e11b6b1471a04b78bae081589b87c9b8?s=128&d=identicon&r=PG", "display_name": "giaour", "link": "https://stackoverflow.com/users/1572233/giaour"}, "is_accepted": true, "score": 1, "last_activity_date": 1425247599, "creation_date": 1425247599, "answer_id": 28799716, "question_id": 28799661, "link": "https://stackoverflow.com/questions/28799661/github-com-go-packages-not-showing-in-remote-repository-in-bitbucket/28799716#28799716", "title": "&quot;Github.com&quot; go packages not showing in remote repository in Bitbucket", "body": "<p><code>Go get</code> will clone github repositories into the appropriate folder of your gopath. What you're seeing in BitBucket is a submodule. You can treat the folder as a subtree if you'd like to check it into version control.</p>\n"}], "owner": {"reputation": 220, "user_id": 4017025, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-5OrL0KDNrn0/AAAAAAAAAAI/AAAAAAAAADw/7JoTQG9KHiY/photo.jpg?sz=128", "display_name": "WarrenV", "link": "https://stackoverflow.com/users/4017025/warrenv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 28799716, "answer_count": 1, "score": -3, "last_activity_date": 1425249481, "creation_date": 1425247330, "last_edit_date": 1425249481, "question_id": 28799661, "link": "https://stackoverflow.com/questions/28799661/github-com-go-packages-not-showing-in-remote-repository-in-bitbucket", "title": "&quot;Github.com&quot; go packages not showing in remote repository in Bitbucket", "body": "<p>When I push my go code into my remote bitbucket repository, I don't see my files in github.com package folder instead I see this (this is a screen shot of my bitbucket repository, where I expect to find my go files):\n<img src=\"https://i.stack.imgur.com/n74Fr.png\" alt=\"enter image description here\"></p>\n\n<p>I used this command to push my code into my remote repository:</p>\n\n<pre><code>git add .\ngit commit -m \"message\"\ngit push -u origin master\n</code></pre>\n\n<p>When I log into my Bitbucket account, <strong>I expect to see my go files</strong> inside the \"drakecheckin/src/github.com/coopernurse\" directory. However I do not see my go file instead I see an arrow pointing to a bunch of characters+numbers.</p>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 647, "user_id": 831484, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fd29df2de2d7acf2fe08ebb40a45de36?s=128&d=identicon&r=PG", "display_name": "Sean M", "link": "https://stackoverflow.com/users/831484/sean-m"}, "edited": false, "score": 2, "creation_date": 1425245490, "post_id": 28799110, "comment_id": 45872821, "body": "Why not just use <code>reg := []string {&quot;a&quot;,&quot;b&quot;,&quot;c&quot;}</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 332764, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "is_accepted": false, "score": 114, "last_activity_date": 1425244652, "last_edit_date": 1425244652, "creation_date": 1425244351, "answer_id": 28799141, "question_id": 28799110, "link": "https://stackoverflow.com/questions/28799110/how-to-join-a-slice-of-strings-into-a-single-string/28799141#28799141", "title": "How to join a slice of strings into a single string?", "body": "<p>Use a slice, not an arrray. Just create it using</p>\n\n<pre><code>reg := []string {\"a\",\"b\",\"c\"}\n</code></pre>\n\n<p>An alternative would have been to convert your array to a slice when joining :</p>\n\n<pre><code>fmt.Println(strings.Join(reg[:],\",\"))\n</code></pre>\n\n<p>Read <a href=\"http://blog.golang.org/go-slices-usage-and-internals\">the Go blog about the differences between slices and arrays</a>. </p>\n"}, {"comments": [{"owner": {"reputation": 15085, "user_id": 598500, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bd0a1f6e3de136eb18d7e2981bf4b195?s=128&d=identicon&r=PG", "display_name": "shadyyx", "link": "https://stackoverflow.com/users/598500/shadyyx"}, "edited": false, "score": 8, "creation_date": 1456845074, "post_id": 28799151, "comment_id": 59127703, "body": "Pls, provide the working code in the answer itself, playground is a plus but not enough for acceptable answer ;-). TY!"}, {"owner": {"reputation": 155397, "user_id": 978917, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/92d059913eace78a868a3e87f98e0a57?s=128&d=identicon&r=PG", "display_name": "ruakh", "link": "https://stackoverflow.com/users/978917/ruakh"}, "reply_to_user": {"reputation": 15085, "user_id": 598500, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bd0a1f6e3de136eb18d7e2981bf4b195?s=128&d=identicon&r=PG", "display_name": "shadyyx", "link": "https://stackoverflow.com/users/598500/shadyyx"}, "edited": false, "score": 9, "creation_date": 1456849497, "post_id": 28799151, "comment_id": 59131102, "body": "@shadyyx: I agree that the playground link is strictly supplemental; but I&#39;m not sure what you think is missing from the answer proper. The OP&#39;s sole error was on line 10, and I provided the corrected version of that line, together with explanation. (Are you suggesting that I should have copied his/her entire example program into the answer? If so, then -- I disagree.)"}, {"owner": {"reputation": 2505, "user_id": 749521, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/302a64f5f51a7f8dc83c0881f4520eb5?s=128&d=identicon&r=PG", "display_name": "Steven Roose", "link": "https://stackoverflow.com/users/749521/steven-roose"}, "edited": false, "score": 1, "creation_date": 1506326707, "post_id": 28799151, "comment_id": 79757743, "body": "&quot;trying to join a slice into a string&quot; Your solution only works for <b>slices of strings</b> instead of the general slice type."}], "tags": [], "owner": {"reputation": 155397, "user_id": 978917, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/92d059913eace78a868a3e87f98e0a57?s=128&d=identicon&r=PG", "display_name": "ruakh", "link": "https://stackoverflow.com/users/978917/ruakh"}, "is_accepted": true, "score": 142, "last_activity_date": 1561753584, "last_edit_date": 1561753584, "creation_date": 1425244388, "answer_id": 28799151, "question_id": 28799110, "link": "https://stackoverflow.com/questions/28799110/how-to-join-a-slice-of-strings-into-a-single-string/28799151#28799151", "title": "How to join a slice of strings into a single string?", "body": "<p>The title of your question is:</p>\n\n<blockquote>\n  <p>How to join a slice of strings into a single string?</p>\n</blockquote>\n\n<p>but in fact, <code>reg</code> is <em>not</em> a slice, but a length-three array. <code>[...]string</code> is just syntactic sugar for (in this case) <code>[3]string</code>.</p>\n\n<p>To get an actual slice, you should write:</p>\n\n<pre><code>reg := []string {\"a\",\"b\",\"c\"}\n</code></pre>\n\n<p>(Try it out: <a href=\"https://play.golang.org/p/vqU5VtDilJ\" rel=\"noreferrer\">https://play.golang.org/p/vqU5VtDilJ</a>.)</p>\n\n<p>Incidentally, if you ever really do need to join an array of strings into a single string, you can get a slice from the array by adding <code>[:]</code>, like so:</p>\n\n<pre><code>fmt.Println(strings.Join(reg[:], \",\"))\n</code></pre>\n\n<p>(Try it out: <a href=\"https://play.golang.org/p/zy8KyC8OTuJ\" rel=\"noreferrer\">https://play.golang.org/p/zy8KyC8OTuJ</a>.)</p>\n"}, {"tags": [], "owner": {"reputation": 1704, "user_id": 2912740, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4730dc939ce11655d239d1f54a9cd399?s=128&d=identicon&r=PG&f=1", "display_name": "Edwinner", "link": "https://stackoverflow.com/users/2912740/edwinner"}, "is_accepted": false, "score": 35, "last_activity_date": 1520817636, "creation_date": 1520817636, "answer_id": 49226877, "question_id": 28799110, "link": "https://stackoverflow.com/questions/28799110/how-to-join-a-slice-of-strings-into-a-single-string/49226877#49226877", "title": "How to join a slice of strings into a single string?", "body": "<h2>This is still relevant in 2018.</h2>\n\n<p>To String</p>\n\n<pre><code>import strings\nstringFiles := strings.Join(fileSlice[:], \",\")\n</code></pre>\n\n<p>Back to Slice again</p>\n\n<pre><code>import strings\nfileSlice := strings.Split(stringFiles, \",\")\n</code></pre>\n"}], "owner": {"reputation": 2009, "user_id": 4618774, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/031e68c41285d97f220f8e1d056eb7b0?s=128&d=identicon&r=PG&f=1", "display_name": "cycle4passion", "link": "https://stackoverflow.com/users/4618774/cycle4passion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164638, "favorite_count": 18, "accepted_answer_id": 28799151, "answer_count": 3, "score": 156, "last_activity_date": 1561753584, "creation_date": 1425244187, "last_edit_date": 1561600987, "question_id": 28799110, "link": "https://stackoverflow.com/questions/28799110/how-to-join-a-slice-of-strings-into-a-single-string", "title": "How to join a slice of strings into a single string?", "body": "<pre><code>package main\n\nimport (\n\"fmt\"\n\"strings\"\n)\n\nfunc main() {\nreg := [...]string {\"a\",\"b\",\"c\"}\nfmt.Println(strings.Join(reg,\",\"))\n}\n</code></pre>\n\n<p>gives me an error of:</p>\n\n<blockquote>\n  <p>prog.go:10: cannot use reg (type [3]string) as type []string in argument to strings.Join</p>\n</blockquote>\n\n<p>Is there a more direct/better way than looping and adding to a var?</p>\n"}, {"tags": ["tcp", "go", "network-programming"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 0, "last_activity_date": 1425245745, "creation_date": 1425245745, "answer_id": 28799400, "question_id": 28798964, "link": "https://stackoverflow.com/questions/28798964/tcp-connections-in-go/28799400#28799400", "title": "TCP Connections in Go", "body": "<p>No, your Listener is accepting connections in port 8081, so the <code>LocalAddr</code> is going to have that port. If you dial out to another server, you usually use a different port each time, though that's not required either. </p>\n"}, {"tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": true, "score": 0, "last_activity_date": 1425250336, "creation_date": 1425250336, "answer_id": 28800221, "question_id": 28798964, "link": "https://stackoverflow.com/questions/28798964/tcp-connections-in-go/28800221#28800221", "title": "TCP Connections in Go", "body": "<p>It got me puzzled for a second, but this is correct. A new socket is indeed created (with a unique local+remote address tuple). This quote from <a href=\"http://en.wikipedia.org/wiki/Network_socket#Socket_states_and_the_client-server_model\" rel=\"nofollow\">wikipedia</a> describes it pretty well:</p>\n\n<blockquote>\n  <p>A server may create several concurrently established TCP sockets with the same local port number and local IP address, each mapped to its own server-child process, serving its own client process. They are treated as different sockets by the operating system, since the remote socket address (the client IP address and/or port number) are different; i.e. since they have different socket pair tuples.</p>\n</blockquote>\n\n<p>If you think about it other way around, i.e. outgoing connection, you don't find it strange seeing remote address being the same across many sockets (e.g. <code>google.com:80</code>), so the same holds for incoming connections.</p>\n\n<p>Probably a nice side effect of this is that tools like <code>netstat</code>, when inspecting sockets, are nicely showing the source port, instead of random pairs.</p>\n"}], "owner": {"reputation": 3291, "user_id": 1388603, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c0203853665322695e2bf5bc6eca2a62?s=128&d=identicon&r=PG", "display_name": "fvrghl", "link": "https://stackoverflow.com/users/1388603/fvrghl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 889, "favorite_count": 0, "accepted_answer_id": 28800221, "answer_count": 2, "score": 0, "last_activity_date": 1425250336, "creation_date": 1425243328, "question_id": 28798964, "link": "https://stackoverflow.com/questions/28798964/tcp-connections-in-go", "title": "TCP Connections in Go", "body": "<p>Here is my code:</p>\n\n<pre><code>package main                                                                       \n\nimport (                                                                           \n    \"fmt\"                                                                          \n    \"net\"                                                                          \n)                                                                                  \n\nfunc main() {                                                                      \n    addr, _ := net.ResolveTCPAddr(\"tcp\", \"127.0.0.1:8081\")                         \n    listener, _ := net.ListenTCP(\"tcp\", addr)                                      \n    fmt.Printf(\"listener addr: %s\\n\", listener.Addr().String())                    \n    for {                                                                          \n        conn, err := listener.AcceptTCP()                                          \n        if err != nil {                                                            \n            // handle error                                                        \n            fmt.Println(\"err\")                                                     \n            return                                                                 \n        }                                                                          \n        go handleConnection(conn)                                                  \n    }                                                                              \n}                                                                                  \n\nfunc handleConnection(conn *net.TCPConn) {                                         \n    fmt.Printf(\"conn addr: %s\\n\", conn.LocalAddr().String())                       \n    fmt.Printf(\"conn remote addr: %s\\n\", conn.RemoteAddr().String())               \n}  \n</code></pre>\n\n<p>Output</p>\n\n<pre><code>listener addr: 127.0.0.1:8081\nconn addr: 127.0.0.1:8081\nconn remote addr: 127.0.0.1:1234\n</code></pre>\n\n<p>Why do <code>listener</code> and <code>conn</code> have the same address?  In TCP, I thought a new socket was created for new connections.</p>\n"}, {"tags": ["go", "http-status-code-404"], "comments": [{"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 1, "creation_date": 1425237035, "post_id": 28797765, "comment_id": 45869903, "body": "I have never tried including a query string in the route, but that would be the first thing that jumps out to me as &quot;highly suspicious&quot;"}, {"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1425237644, "post_id": 28797765, "comment_id": 45870120, "body": "I am assuming you are trying to test: <a href=\"https://github.com/johnwesonga/go-prismatic\" rel=\"nofollow noreferrer\">github.com/johnwesonga/go-prismatic</a>?  I would try to verify the test issue, but you have some compiler errors related to topic_tagurl based on Master HEAD."}, {"owner": {"reputation": 2679, "user_id": 3081480, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UVerL.jpg?s=128&g=1", "display_name": "Kyle Chadha", "link": "https://stackoverflow.com/users/3081480/kyle-chadha"}, "edited": false, "score": 0, "creation_date": 1425238295, "post_id": 28797765, "comment_id": 45870388, "body": "The router you created doesn&#39;t have a route defined for &quot;/topic/search?search-query=Clojure&quot;, so why would you expect anything but a 404?"}, {"owner": {"reputation": 3847, "user_id": 251840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e3bf4bcc6dfbe7c13231f914334db925?s=128&d=identicon&r=PG", "display_name": "jwesonga", "link": "https://stackoverflow.com/users/251840/jwesonga"}, "edited": false, "score": 0, "creation_date": 1425239475, "post_id": 28797765, "comment_id": 45870809, "body": "sberry - fixed that bug in tagurl, thanks for pointing it out."}, {"owner": {"reputation": 3847, "user_id": 251840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e3bf4bcc6dfbe7c13231f914334db925?s=128&d=identicon&r=PG", "display_name": "jwesonga", "link": "https://stackoverflow.com/users/251840/jwesonga"}, "edited": false, "score": 0, "creation_date": 1425239650, "post_id": 28797765, "comment_id": 45870857, "body": "sberry - yes the query string was the problem..thanks for the tip :-)"}], "answers": [{"tags": [], "owner": {"reputation": 6093, "user_id": 965495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a75b5bed74983dcc367dfbd5b6c259e2?s=128&d=identicon&r=PG", "display_name": "klobucar", "link": "https://stackoverflow.com/users/965495/klobucar"}, "is_accepted": false, "score": 1, "last_activity_date": 1425240320, "creation_date": 1425240320, "answer_id": 28798424, "question_id": 28797765, "link": "https://stackoverflow.com/questions/28797765/golang-testing-api-using-httptest-returns-404/28798424#28798424", "title": "Golang: Testing API using httptest returns 404", "body": "<p>Remove the query param. that isn't a route. </p>\n"}], "owner": {"reputation": 3847, "user_id": 251840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e3bf4bcc6dfbe7c13231f914334db925?s=128&d=identicon&r=PG", "display_name": "jwesonga", "link": "https://stackoverflow.com/users/251840/jwesonga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1583, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1425240320, "creation_date": 1425236670, "last_edit_date": 1425239369, "question_id": 28797765, "link": "https://stackoverflow.com/questions/28797765/golang-testing-api-using-httptest-returns-404", "title": "Golang: Testing API using httptest returns 404", "body": "<p>I'm trying to test a library I wrote that talks to an external API. I came up with this code:</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"net/http\"\n    \"net/http/httptest\"\n    \"net/url\"\n    \"testing\"\n)\n\nvar (\n    // mux is the HTTP request multiplexer used with the test server.\n    mux *http.ServeMux\n\n    // client is the GitHub client being tested.\n    client *Client\n\n    // server is a test HTTP server used to provide mock API responses.\n    server *httptest.Server\n)\n\nfunc setup() {\n    mux = http.NewServeMux()\n    server = httptest.NewServer(mux)\n\n    client = NewClient(nil, \"foo\")\n    url, _ := url.Parse(server.URL)\n    client.BaseURL = url\n\n}\n\nfunc teardown() {\n    server.Close()\n}\n\nfunc testMethod(t *testing.T, r *http.Request, want string) {\n    if got := r.Method; got != want {\n        t.Errorf(\"Request method: %v, want %v\", got, want)\n    }\n}\n\nfunc TestSearchForInterest(t *testing.T) {\n    setup()\n    defer teardown()\n\n    mux.HandleFunc(\"/topic/search?search-query=Clojure\", func(w http.ResponseWriter, r *http.Request) {\n        fmt.Fprintln(w, `{\"results\": [ {\"topic\": \"Clojure\", \"id\": 1000} ]}`)\n    })\n\n    results, _, err := client.Topics.SearchForInterest(\"Clojure\")\n    if err != nil {\n        t.Errorf(\"SearchForInterest returned error: %v\", err)\n    }\n\n    fmt.Println(results)\n\n}\n</code></pre>\n\n<p>When I run \"go test\" I keep getting an <strong>error 404</strong> not sure what I'm doing wrong. any pointers</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1425240389, "post_id": 28798392, "comment_id": 45871146, "body": "Suspect the last paragraph is a big part of it: the custom stdlib ensures your dev code doesn&#39;t have syscall, etc. just as the production code doesn&#39;t."}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1425252861, "post_id": 28798392, "comment_id": 45874945, "body": "If you remove <code>go_appengine&#47;goroot&#47;pkg</code> the sdk stops working so it tells me that   /src/ is not used to compile/build the app.  As far as the version hunting is concerned there are version managers (e.g. gvm - <a href=\"https://github.com/moovweb/gvm\" rel=\"nofollow noreferrer\">github.com/moovweb/gvm</a>) so it&#39;s basically a solved problem."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1425281727, "post_id": 28798392, "comment_id": 45882493, "body": "@Theuserwithnohat The <code>pkg</code> folder might be included for performance reasons so you don&#39;t have to compile everything inside the SDK. But the fact remains that you also get the source code too. If you don&#39;t trust Google, remove the package objects and compile the source yourself."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1425241276, "last_edit_date": 1425241276, "creation_date": 1425240166, "answer_id": 28798392, "question_id": 28797257, "link": "https://stackoverflow.com/questions/28797257/why-is-the-go-appengine-sdk-distributed-with-the-go-language-compiled/28798392#28798392", "title": "Why is the go-appengine sdk distributed with the Go language compiled?", "body": "<p>I think you are misinformed.</p>\n\n<p>The Go Appengine SDK contains the Go runtime and standard library that is used/available at production in <em>source code</em> form.</p>\n\n<p>Download the latest SDK, extract it and you will see a folder <code>go_appengine/goroot/src</code> inside it. This is the source of the Go standard library, it is not compiled into package objects or native executable binary.</p>\n\n<p>And the reason why it is included is so that you will have the exact same version that will be used at production, and also so that you don't need to hunt down the exact version that is used/required which is most of the time <strong>not</strong> the same as the latest Go version (at the moment the latest Go version is 1.4.2, the one used at AppEngine is 1.4.1 which was released on February 18, 2015, up until then it was Go 1.2 which you can see was quite out-dated - Go 1.3 was entirely skipped).</p>\n\n<p>And also because your app at AppEngine runs in a sandbox, many features of Go are not available e.g. network connections, access to the file system etc.</p>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1425241276, "creation_date": 1425234086, "question_id": 28797257, "link": "https://stackoverflow.com/questions/28797257/why-is-the-go-appengine-sdk-distributed-with-the-go-language-compiled", "title": "Why is the go-appengine sdk distributed with the Go language compiled?", "body": "<p>Go Appengine SDK provides the Go programming language compiled as part of the distribution. I'm wondering if there is a good reason for this as to me looks like bad practice. One bad reason is the security because you don't know what you are running if you download and execute compiled code.</p>\n\n<p>Go is open source and you are supposed to already have it installed  so it doesn't make much sense to me why it's distributed in a compiled form. </p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 4, "last_activity_date": 1425235972, "last_edit_date": 1425235972, "creation_date": 1425235226, "answer_id": 28797468, "question_id": 28797007, "link": "https://stackoverflow.com/questions/28797007/how-to-build-a-program-with-a-foreign-main-function/28797468#28797468", "title": "How to build a program with a foreign main function?", "body": "<p>The <code>main</code> function must be in the <code>main</code> package: <a href=\"http://golang.org/ref/spec#Program_execution\" rel=\"nofollow\">Program Execution</a></p>\n\n<blockquote>\n  <p>Program execution begins by initializing the main package and then invoking the function main. When that function invocation returns, the program exits. It does not wait for other (non-main) goroutines to complete.</p>\n</blockquote>\n\n<p>If you want a package to initialize some state at start up, or have side-effects by simply importing it, you use an <a href=\"http://golang.org/doc/effective_go.html#init\" rel=\"nofollow\"><code>init function</code></a>. The init however must return, so you can't block with it <code>http.ListenAndServe</code>. </p>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1850, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1425235972, "creation_date": 1425232673, "question_id": 28797007, "link": "https://stackoverflow.com/questions/28797007/how-to-build-a-program-with-a-foreign-main-function", "title": "How to build a program with a foreign main function?", "body": "<p>I'm writing a kind of framework and I would like to make the initialisation of the http server part of this framework. So basically I have a package <code>internal</code> as below which is imported by the framework middleware:</p>\n\n<pre><code>package internal\n\nimport(\n    \"net/http\"\n    \"log\"\n)\n\nfunc main() {\n    checkHealth(http.DefaultServeMux)\n\n    if err := http.ListenAndServe(\":8080\", http.HandlerFunc(handleHTTP)); err != nil {\n        log.Fatalf(\"http.ListenAndServe: %v\", err)\n    }\n}\n</code></pre>\n\n<p>In the app code I'm looking to define the handlers in an init function.\ne.g. </p>\n\n<pre><code>func init() {\n    http.HandleFunc(\"/\", handler)\n}\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprint(w, \"Hello, world!\")\n}\n</code></pre>\n\n<p>However if I run <code>go build</code> in the app code directory/package it errors out that the main function is not defined:\n<code>runtime.main_main: main.main: not defined\nruntime.main_main: undefined: main.main\n</code> \nSo my question is how should I build / compile the program so and why using the standard <code>go build</code> command it doesn't find the main function defined in the internal package.</p>\n"}, {"tags": ["logging", "go"], "comments": [{"owner": {"reputation": 6093, "user_id": 965495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a75b5bed74983dcc367dfbd5b6c259e2?s=128&d=identicon&r=PG", "display_name": "klobucar", "link": "https://stackoverflow.com/users/965495/klobucar"}, "edited": false, "score": 1, "creation_date": 1425232806, "post_id": 28796021, "comment_id": 45868426, "body": "Can you clarify what rotation is a little more? Is it on program start, or when the files reach a specific size, etc?"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1435547726, "post_id": 28796021, "comment_id": 50229143, "body": "For posterity: I would highly recommend lumberjack (<a href=\"https://github.com/natefinch/lumberjack\" rel=\"nofollow noreferrer\">github.com/natefinch/lumberjack</a>) - which hooks into the standard library&#39;s <code>log</code> package via <code>log.SetOutput</code> and handles log rotation, max sizes and retaining backups."}], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 0, "last_activity_date": 1425231894, "creation_date": 1425231894, "answer_id": 28796869, "question_id": 28796021, "link": "https://stackoverflow.com/questions/28796021/how-can-i-log-in-golang-to-a-file-with-log-rotation/28796869#28796869", "title": "How can I log in golang to a file with log rotation?", "body": "<p>One option that comes to mind is to wrap the logging in your own type and provide a reload function, something like:</p>\n\n<pre><code>type Logger struct {\n    l *log.Logger\n    f *os.File\n    m sync.RWMutex\n}\n\nfunc NewLogger(fn string) (*Logger, error) {\n    f, err := os.Create(fn)\n    if err != nil {\n        return nil, err\n    }\n    l := &amp;Logger{\n        l: log.New(f, \"your-app\", log.Lshortfile),\n        f: f,\n    }\n    return l, nil\n}\n\nfunc (l *Logger) Logf(f string, args ...interface{}) {\n    l.m.RLock()\n    l.l.Printf(f, args...)\n    l.m.RUnlock()\n}\n\nfunc (l *Logger) Reload() (err error) {\n    l.m.Lock()\n    defer l.m.Unlock()\n    l.f.Close()\n    if l.f, err = os.Create(l.f.Name()); err != nil {\n        return\n    }\n    l.l = log.New(l.f, \"your-app\", log.Lshortfile)\n    return\n}\n</code></pre>\n\n<p>Then either listen for a signal (usually <code>-HUP</code> on *nix) or add an endpoint in your app that would call <code>Logger.Reload()</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1426731583, "post_id": 28797984, "comment_id": 46497243, "body": "I&#39;d probably just us <code>sync.Mutex</code> rather than <code>sync.RWMutex</code> since (A) the <code>log</code> package already handles serializing writes so supporting multiple callers of <code>RotateWriter.Write</code> doesn&#39;t get you anything and (B) unless perhaps you use <code>os.O_APPEND</code>, doing concurrent writes to a file is undefined/bad."}, {"owner": {"reputation": 1880, "user_id": 471622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c1384132ace283798b6e1294f31ac62?s=128&d=identicon&r=PG", "display_name": "lethalman", "link": "https://stackoverflow.com/users/471622/lethalman"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1447422244, "post_id": 28797984, "comment_id": 55159560, "body": "@Dave Even with O_APPEND writes are not guaranteed to be atomic unless the written data is under PIPE_BUF."}, {"owner": {"reputation": 556, "user_id": 157460, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ae8acaa8e78dbafd31a844977bd4b844?s=128&d=identicon&r=PG", "display_name": "f0ster", "link": "https://stackoverflow.com/users/157460/f0ster"}, "edited": false, "score": 0, "creation_date": 1463098882, "post_id": 28797984, "comment_id": 61931163, "body": "when renaming your file, you can&#39;t concatenate a string with a rune, so you would have to use &quot;.&quot; (to build without error)"}, {"owner": {"reputation": 26124, "user_id": 171950, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/ccee38944752d481128936450ddb687e?s=128&d=identicon&r=PG", "display_name": "Muhammad Hewedy", "link": "https://stackoverflow.com/users/171950/muhammad-hewedy"}, "edited": false, "score": 0, "creation_date": 1565535270, "post_id": 28797984, "comment_id": 101376960, "body": "A simple tee writer won&#39;t harm  (to run inside ide) <a href=\"https://gist.github.com/mhewedy/63d243e8ef84ac23c740aabba9ac3f32\" rel=\"nofollow noreferrer\">gist.github.com/mhewedy/63d243e8ef84ac23c740aabba9ac3f32</a>"}], "tags": [], "owner": {"reputation": 14588, "user_id": 244393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55eb813499c0cf9fd47e95690782bf83?s=128&d=identicon&r=PG", "display_name": "Crast", "link": "https://stackoverflow.com/users/244393/crast"}, "is_accepted": false, "score": 17, "last_activity_date": 1463531035, "last_edit_date": 1463531035, "creation_date": 1425237800, "answer_id": 28797984, "question_id": 28796021, "link": "https://stackoverflow.com/questions/28796021/how-can-i-log-in-golang-to-a-file-with-log-rotation/28797984#28797984", "title": "How can I log in golang to a file with log rotation?", "body": "<p>The best way to fulfill all your three requirements instead of creating an alternate logger struct, if you were satisfied using the base-level log.Log, is instead to set the output of the logger to your own io.Writer instance.</p>\n\n<p>So basically what I'm going to do here is show an example where I create my own io.Writer:</p>\n\n<pre><code>import (\n    \"os\"\n    \"sync\"\n    \"time\"\n)\n\ntype RotateWriter struct {\n    lock     sync.Mutex\n    filename string // should be set to the actual filename\n    fp       *os.File\n}\n\n// Make a new RotateWriter. Return nil if error occurs during setup.\nfunc New(filename string) *RotateWriter {\n    w := &amp;RotateWriter{filename: filename}\n    err := w.Rotate()\n    if err != nil {\n        return nil\n    }\n    return w\n}\n\n// Write satisfies the io.Writer interface.\nfunc (w *RotateWriter) Write(output []byte) (int, error) {\n    w.lock.Lock()\n    defer w.lock.Unlock()\n    return w.fp.Write(output)\n}\n\n// Perform the actual act of rotating and reopening file.\nfunc (w *RotateWriter) Rotate() (err error) {\n    w.lock.Lock()\n    defer w.lock.Unlock()\n\n    // Close existing file if open\n    if w.fp != nil {\n        err = w.fp.Close()\n        w.fp = nil\n        if err != nil {\n            return\n        }\n    }\n    // Rename dest file if it already exists\n    _, err = os.Stat(w.filename)\n    if err == nil {\n        err = os.Rename(w.filename, w.filename+\".\"+time.Now().Format(time.RFC3339))\n        if err != nil {\n            return\n        }\n    }\n\n    // Create a file.\n    w.fp, err = os.Create(w.filename)\n    return\n}\n</code></pre>\n\n<p>You then create a RotateWriter and use <code>log.SetOutput</code> to set this writer (if other packages are using the standard logger instance) or alternately create your own instances using <code>log.New</code> to pass around.</p>\n\n<p>I haven't solved the situation of when to call Rotate, I'll leave that to you to decide. It'd be fairly simple to trigger it based on time, or alternately do so after some amount of writes or some amount of bytes.</p>\n"}, {"comments": [{"owner": {"reputation": 1534, "user_id": 554694, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ba14da2ab595a710d7474fc664fc532?s=128&d=identicon&r=PG", "display_name": "Nilambar Sharma", "link": "https://stackoverflow.com/users/554694/nilambar-sharma"}, "edited": false, "score": 3, "creation_date": 1435307961, "post_id": 31068518, "comment_id": 50156691, "body": "Link only answers are not quite recommended. Please provide some examples with explanation."}, {"owner": {"reputation": 79, "user_id": 5839609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b986a59a846c72f1262e9fae1cdbd020?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/5839609/ravi"}, "edited": false, "score": 0, "creation_date": 1602911869, "post_id": 31068518, "comment_id": 113875588, "body": "@antigloss Though I like your library, it is under LGPL-3.0. Might not be suitable for closed source commercial deployments."}], "tags": [], "owner": {"reputation": 31, "user_id": 5052223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce8e20d3edc41f864500d1ef7faa843a?s=128&d=identicon&r=PG", "display_name": "antigloss", "link": "https://stackoverflow.com/users/5052223/antigloss"}, "is_accepted": false, "score": 3, "last_activity_date": 1435546086, "last_edit_date": 1435546086, "creation_date": 1435307494, "answer_id": 31068518, "question_id": 28796021, "link": "https://stackoverflow.com/questions/28796021/how-can-i-log-in-golang-to-a-file-with-log-rotation/31068518#31068518", "title": "How can I log in golang to a file with log rotation?", "body": "<p>Here is a light-weighted logging package that supports log rotation and auto purging</p>\n\n<p><a href=\"https://github.com/antigloss/go/tree/master/logger\" rel=\"nofollow\">https://github.com/antigloss/go/tree/master/logger</a></p>\n\n<pre><code>// logger.Init must be called first to setup logger\nlogger.Init(\"./log\", // specify the directory to save the logfiles\n            400, // maximum logfiles allowed under the specified log directory\n            20, // number of logfiles to delete when number of logfiles exceeds the configured limit\n            100, // maximum size of a logfile in MB\n            false) // whether logs with Trace level are written down\nlogger.Info(\"Failed to find player! uid=%d plid=%d cmd=%s xxx=%d\", 1234, 678942, \"getplayer\", 102020101)\nlogger.Warn(\"Failed to parse protocol! uid=%d plid=%d cmd=%s\", 1234, 678942, \"getplayer\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 637, "user_id": 1334598, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8bc4b7637f167a4ab4221851adf3dddf?s=128&d=identicon&r=PG", "display_name": "greenthunder", "link": "https://stackoverflow.com/users/1334598/greenthunder"}, "edited": false, "score": 1, "creation_date": 1495426105, "post_id": 33109737, "comment_id": 75228874, "body": "I&#39;ve tried your answer above for log rolling but it didn&#39;t work. The log file stopped at specified MaxSize and stopped logging without rolling it. What am I missing?"}, {"owner": {"reputation": 3071, "user_id": 3222727, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/aea934c6f382518133aeb0e8c975580e?s=128&d=identicon&r=PG", "display_name": "kinshuk4", "link": "https://stackoverflow.com/users/3222727/kinshuk4"}, "reply_to_user": {"reputation": 637, "user_id": 1334598, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8bc4b7637f167a4ab4221851adf3dddf?s=128&d=identicon&r=PG", "display_name": "greenthunder", "link": "https://stackoverflow.com/users/1334598/greenthunder"}, "edited": false, "score": 0, "creation_date": 1495959024, "post_id": 33109737, "comment_id": 75460303, "body": "@greenthunder did you set MaxBackups more than 1?"}, {"owner": {"reputation": 548, "user_id": 5345652, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZdgGaohbRX0/AAAAAAAAAAI/AAAAAAAAAAA/65laXilEcK8/photo.jpg?sz=128", "display_name": "Sharon Katz", "link": "https://stackoverflow.com/users/5345652/sharon-katz"}, "edited": false, "score": 0, "creation_date": 1531942120, "post_id": 33109737, "comment_id": 89790700, "body": "Works great for me. I tested it with several threads running stress logging and it looks good."}, {"owner": {"reputation": 793, "user_id": 90506, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a4bffdc2e88202aa1c2b74e165355199?s=128&d=identicon&r=PG", "display_name": "farhany", "link": "https://stackoverflow.com/users/90506/farhany"}, "edited": false, "score": 0, "creation_date": 1559182942, "post_id": 33109737, "comment_id": 99344039, "body": "Works perfectly. Thanks for mentioning that package. Though I learned something important from the @Crast by trying out his code. Nothing beats experimenting with actual code."}, {"owner": {"reputation": 541, "user_id": 1280343, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wpNOe.png?s=128&g=1", "display_name": "SomeGuyWhoCodes", "link": "https://stackoverflow.com/users/1280343/someguywhocodes"}, "edited": false, "score": 0, "creation_date": 1579881453, "post_id": 33109737, "comment_id": 105926966, "body": "this is not working for me on Mac, is it only for linux?"}, {"owner": {"reputation": 3071, "user_id": 3222727, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/aea934c6f382518133aeb0e8c975580e?s=128&d=identicon&r=PG", "display_name": "kinshuk4", "link": "https://stackoverflow.com/users/3222727/kinshuk4"}, "reply_to_user": {"reputation": 541, "user_id": 1280343, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wpNOe.png?s=128&g=1", "display_name": "SomeGuyWhoCodes", "link": "https://stackoverflow.com/users/1280343/someguywhocodes"}, "edited": false, "score": 0, "creation_date": 1580834571, "post_id": 33109737, "comment_id": 106224948, "body": "@SomeGuyWhoCodes It should work for all OSes. Try setting gopath"}], "tags": [], "owner": {"reputation": 3071, "user_id": 3222727, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/aea934c6f382518133aeb0e8c975580e?s=128&d=identicon&r=PG", "display_name": "kinshuk4", "link": "https://stackoverflow.com/users/3222727/kinshuk4"}, "is_accepted": false, "score": 19, "last_activity_date": 1568983945, "last_edit_date": 1568983945, "creation_date": 1444759974, "answer_id": 33109737, "question_id": 28796021, "link": "https://stackoverflow.com/questions/28796021/how-can-i-log-in-golang-to-a-file-with-log-rotation/33109737#33109737", "title": "How can I log in golang to a file with log rotation?", "body": "<p>Though @Crast has given a very good answer, I want to also bring to the notice - <a href=\"https://github.com/natefinch/lumberjack\" rel=\"nofollow noreferrer\">lumberjack</a> logger by <a href=\"https://github.com/natefinch\" rel=\"nofollow noreferrer\">Nate Finch</a> which I ended up using. </p>\n\n<p>Here is how to use it:</p>\n\n<ol>\n<li>First, clone the <a href=\"https://github.com/natefinch/lumberjack\" rel=\"nofollow noreferrer\">lumberjack</a> repository OR get it somehow.</li>\n<li>Run the <code>go install</code> command on the folder.</li>\n<li>Now import go's \"log\" package and \"lumberjack package\".</li>\n</ol>\n\n<p>import (\n    \"log\"\n    \"github.com/natefinch/lumberjack\"\n )</p>\n\n<ol start=\"4\">\n<li>Now use it in your code like this:</li>\n</ol>\n\n<p>Outside of main, declare your log variable.</p>\n\n<pre><code>var errLog *log.Logger\n</code></pre>\n\n<p>Inside main:</p>\n\n<pre><code>e, err := os.OpenFile(\"./foo.log\", os.O_WRONLY|os.O_CREATE|os.O_APPEND, 0666)\n\nif err != nil {\n    fmt.Printf(\"error opening file: %v\", err)\n    os.Exit(1)\n}\nerrLog = log.New(e, \"\", log.Ldate|log.Ltime)\nerrLog.SetOutput(&amp;lumberjack.Logger{\n    Filename:   \"./foo.log\",\n    MaxSize:    1,  // megabytes after which new file is created\n    MaxBackups: 3,  // number of backups\n    MaxAge:     28, //days\n})\n</code></pre>\n\n<p>Now as soon as the file size get 1MB, a new file is created to keep the previous logs with the current timestamps, and the new logs will continue to log into foo.log file. Also, I have created the file using os.OpenFile but you may not need it as lumberjack internally does it, but I preferred it that way. Thanks, hope it helps.\nOnce again thanks to @Crast and <a href=\"https://github.com/natefinch\" rel=\"nofollow noreferrer\">NateFinch</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 2079881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55e2c31f991a65ff99be345bca6a1647?s=128&d=identicon&r=PG", "display_name": "jame2981", "link": "https://stackoverflow.com/users/2079881/jame2981"}, "edited": false, "score": 0, "creation_date": 1487994905, "post_id": 42451768, "comment_id": 72047133, "body": "log.Logger.Writer use any std logger."}], "tags": [], "owner": {"reputation": 41, "user_id": 2079881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55e2c31f991a65ff99be345bca6a1647?s=128&d=identicon&r=PG", "display_name": "jame2981", "link": "https://stackoverflow.com/users/2079881/jame2981"}, "is_accepted": false, "score": 0, "last_activity_date": 1487995156, "last_edit_date": 1487995156, "creation_date": 1487994811, "answer_id": 42451768, "question_id": 28796021, "link": "https://stackoverflow.com/questions/28796021/how-can-i-log-in-golang-to-a-file-with-log-rotation/42451768#42451768", "title": "How can I log in golang to a file with log rotation?", "body": "<p><a href=\"https://github.com/jame2981/log\" rel=\"nofollow noreferrer\">https://github.com/jame2981/log</a> My package can help you. </p>\n\n<pre><code>l1 := log.Pool.New(\"l1\", \"file:///tmp/test1.log\")\nl2 := log.Pool.New(\"l2\", \"file:///tmp/test2.log\")\nl3 := log.Pool.New(\"l3\", \"file:///tmp/test3.log\")\nl4 := log.Pool.New(\"l4\", \"file:///tmp/test4.log\")\n\nl1.Rotate() // rotate l1 only\nlog.Pool.Rotate() // was rotate all instances.\n\n// rotate with signal\nreopen := make(chan os.Signal, 1)\nsignal.Notify(reopen, syscall.SIGUSR1)\ngo func() {\n    for{\n       &lt;-reopen\n       l.Pool.Rotate()\n    }\n}()\n</code></pre>\n\n<p>set std logger writer so rotate work yet.</p>\n\n<pre><code>// std logger writer\nimport \"log\"\nlogger := log.New(\"test\", \"\", 0)\nlogger.SetOutput(l1.Writer())\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 835, "user_id": 4008473, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/bab2d01a5c2ce91bed8964aabf65527c?s=128&d=identicon&r=PG&f=1", "display_name": "user27111987", "link": "https://stackoverflow.com/users/4008473/user27111987"}, "is_accepted": false, "score": 1, "last_activity_date": 1575137338, "creation_date": 1575137338, "answer_id": 59118894, "question_id": 28796021, "link": "https://stackoverflow.com/questions/28796021/how-can-i-log-in-golang-to-a-file-with-log-rotation/59118894#59118894", "title": "How can I log in golang to a file with log rotation?", "body": "<p>We can also use a lib <a href=\"https://github.com/lestrrat/go-file-rotatelogs\" rel=\"nofollow noreferrer\">https://github.com/lestrrat/go-file-rotatelogs</a> to achieve the same. It provides option to set</p>\n\n<pre><code>Max Age\nLog Rotation Time\n</code></pre>\n\n<p>It can be hooked to any kind of logger too. </p>\n\n<p>Source: <a href=\"https://golangbyexample.com/go-logger-rotation/\" rel=\"nofollow noreferrer\">https://golangbyexample.com/go-logger-rotation/</a></p>\n"}], "owner": {"reputation": 597, "user_id": 1460991, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a8c1a4a881ddda8411db0c59c6678cf9?s=128&d=identicon&r=PG", "display_name": "FlowRaja", "link": "https://stackoverflow.com/users/1460991/flowraja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39234, "favorite_count": 7, "answer_count": 6, "score": 18, "last_activity_date": 1575137338, "creation_date": 1425227531, "question_id": 28796021, "link": "https://stackoverflow.com/questions/28796021/how-can-i-log-in-golang-to-a-file-with-log-rotation", "title": "How can I log in golang to a file with log rotation?", "body": "<p>I am trying to write a web application which will run on a remote server. I need to log to capture errors/debug/audit.\nI find that multiple logging packages are available for golang including the standard \"log\" package. However, I need to fulfill three requirements:</p>\n\n<ol>\n<li>The log files need to be rotated </li>\n<li>It applies to the included packages\nwhich use \"log\" </li>\n<li>It needs to be cross-platform. Dev environment is\nLinux and needs to be deployed on Windows.</li>\n</ol>\n"}, {"tags": ["go", "server"], "comments": [{"owner": {"reputation": 230, "user_id": 2152105, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5YGz.jpg?s=128&g=1", "display_name": "Jaemin Park", "link": "https://stackoverflow.com/users/2152105/jaemin-park"}, "edited": false, "score": 1, "creation_date": 1425216586, "post_id": 28793619, "comment_id": 45862726, "body": "The biggest diffence is that <code>http.FileServer</code> is <code>http.Handler</code> while <code>http.ServeFile</code> is not."}, {"owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "reply_to_user": {"reputation": 230, "user_id": 2152105, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5YGz.jpg?s=128&g=1", "display_name": "Jaemin Park", "link": "https://stackoverflow.com/users/2152105/jaemin-park"}, "edited": false, "score": 0, "creation_date": 1425218768, "post_id": 28793619, "comment_id": 45863398, "body": "Thanks, I know it, but it doesn&#39;t make plight better to me)"}], "answers": [{"comments": [{"owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "edited": false, "score": 1, "creation_date": 1425279662, "post_id": 28798174, "comment_id": 45881698, "body": "Very, very good! It is exactly what I want to hear! Big thank you!) My English is not mother tongue, so could you tell me what does &quot;munging&quot; mean?)"}, {"owner": {"reputation": 6304, "user_id": 390722, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/64fc18734e843f8bb227765cb1b62137?s=128&d=identicon&r=PG&f=1", "display_name": "StartupGuy", "link": "https://stackoverflow.com/users/390722/startupguy"}, "edited": false, "score": 2, "creation_date": 1455905401, "post_id": 28798174, "comment_id": 58714777, "body": "Munging: <a href=\"https://en.wikipedia.org/wiki/Data_wrangling\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Data_wrangling</a> ..  so he basically means creating your own path mapping"}, {"owner": {"reputation": 14588, "user_id": 244393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55eb813499c0cf9fd47e95690782bf83?s=128&d=identicon&r=PG", "display_name": "Crast", "link": "https://stackoverflow.com/users/244393/crast"}, "edited": false, "score": 0, "creation_date": 1456368769, "post_id": 28798174, "comment_id": 58917864, "body": "Or even <a href=\"https://en.wikipedia.org/wiki/Mung_(computer_term)\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Mung_(computer_term)</a>  &quot;It is sometimes used for vague data transformation steps that are not yet clear to the speaker.[2] Common munging operations include removing punctuation or html tags, data parsing, filtering, and transformation.&quot;"}, {"owner": {"reputation": 3554, "user_id": 3233810, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1135890448/picture?type=large", "display_name": "daino3", "link": "https://stackoverflow.com/users/3233810/daino3"}, "edited": false, "score": 4, "creation_date": 1474305167, "post_id": 28798174, "comment_id": 66467116, "body": "Note, to serve a directory on disk (/tmp) under an alternate URL path (/tmpfiles/), make sure you include the trailing slash. E.g. the example above to serve files in <code>&#47;tmp</code> with the route <code>static</code> would become: <code>http.Handle(&quot;&#47;static&#47;&quot;, http.StripPrefix(&quot;&#47;static&#47;&quot;, fs))</code>"}, {"owner": {"reputation": 2435, "user_id": 175510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/628fe9ac0ebc35658c2dde1aeb7df2b5?s=128&d=identicon&r=PG", "display_name": "djule5", "link": "https://stackoverflow.com/users/175510/djule5"}, "edited": false, "score": 1, "creation_date": 1502232348, "post_id": 28798174, "comment_id": 78117816, "body": "Good advice on the safety concerns \u2013 <code>http.FileServer</code> is probably the safest approach for most use cases."}], "tags": [], "owner": {"reputation": 14588, "user_id": 244393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55eb813499c0cf9fd47e95690782bf83?s=128&d=identicon&r=PG", "display_name": "Crast", "link": "https://stackoverflow.com/users/244393/crast"}, "is_accepted": true, "score": 80, "last_activity_date": 1495097701, "last_edit_date": 1495097701, "creation_date": 1425238851, "answer_id": 28798174, "question_id": 28793619, "link": "https://stackoverflow.com/questions/28793619/golang-what-to-use-http-servefile-or-http-fileserver/28798174#28798174", "title": "Golang. What to use? http.ServeFile(..) or http.FileServer(..)?", "body": "<p>The main difference is that <code>http.FileServer</code> does effectively almost 1:1 mapping of an HTTP prefix with a filesystem. In plain english, it serves up an entire directory path. and all its children.</p>\n\n<p>Say you had a  directory called <code>/home/bob/static</code> and you had this setup: </p>\n\n<pre><code>fs := http.FileServer(http.Dir(\"/home/bob/static\"))\nhttp.Handle(\"/static/\", http.StripPrefix(\"/static\", fs))\n</code></pre>\n\n<p>Your server would take requests for e.g. <code>/static/foo/bar</code> and serve whatever is at <code>/home/bob/static/foo/bar</code> (or 404)</p>\n\n<p>In contrast, the <code>ServeFile</code> is a lower level helper that can be used to implement something similar to FileServer, or implement your own path munging potentially, and any number of things. It simply takes the named local file and sends it over the HTTP connection. By itself, it won't serve a whole directory prefix (unless you wrote a handler that did some lookup similar to FileServer)</p>\n\n<p><strong>NOTE</strong> Serving up a filesystem naively is a potentially dangerous thing (there are potentially ways to break out of the rooted tree) hence I recommend that unless you <em>really</em> know what you're doing, use <code>http.FileServer</code> and <code>http.Dir</code> as they include checks to make sure people can't break out of the FS, which <code>ServeFile</code> doesn't.</p>\n\n<p><em>Addendum</em>\nYour secondary question, how do you do a custom NotFound handler, unfortunately, is not easily answered. Because this is called from internal function <code>serveFile</code> as you noticed, there's no super easy place to break into that. There are potentially some sneaky things like intercepting the response with your own <code>ResponseWriter</code> which intercepts the 404 response code, but I'll leave that exercise to you.</p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 6860234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a1FuX.jpg?s=128&g=1", "display_name": "Oliver Koeth", "link": "https://stackoverflow.com/users/6860234/oliver-koeth"}, "is_accepted": false, "score": 6, "last_activity_date": 1548956592, "creation_date": 1548956592, "answer_id": 54466375, "question_id": 28793619, "link": "https://stackoverflow.com/questions/28793619/golang-what-to-use-http-servefile-or-http-fileserver/54466375#54466375", "title": "Golang. What to use? http.ServeFile(..) or http.FileServer(..)?", "body": "<p>Here a handler which sends a redirect to \"/\" if file is not found. This comes in handy when adding a fallback for an Angular application, as suggested <a href=\"https://angular.io/guide/deployment\" rel=\"noreferrer\">here</a>, which is served from within a golang service.</p>\n\n<p><strong>Note:</strong> This code is not production ready. Only illustrative (at best :-)</p>\n\n<pre><code>    package main\n\n    import \"net/http\"\n\n    type (\n        // FallbackResponseWriter wraps an http.Requesthandler and surpresses\n        // a 404 status code. In such case a given local file will be served.\n        FallbackResponseWriter struct {\n            WrappedResponseWriter http.ResponseWriter\n            FileNotFound          bool\n        }\n    )\n\n    // Header returns the header of the wrapped response writer\n    func (frw *FallbackResponseWriter) Header() http.Header {\n        return frw.WrappedResponseWriter.Header()\n    }\n\n    // Write sends bytes to wrapped response writer, in case of FileNotFound\n    // It surpresses further writes (concealing the fact though)\n    func (frw *FallbackResponseWriter) Write(b []byte) (int, error) {\n        if frw.FileNotFound {\n            return len(b), nil\n        }\n        return frw.WrappedResponseWriter.Write(b)\n    }\n\n    // WriteHeader sends statusCode to wrapped response writer\n    func (frw *FallbackResponseWriter) WriteHeader(statusCode int) {\n        Log.Printf(\"INFO: WriteHeader called with code %d\\n\", statusCode)\n        if statusCode == http.StatusNotFound {\n            Log.Printf(\"INFO: Setting FileNotFound flag\\n\")\n            frw.FileNotFound = true\n            return\n        }\n        frw.WrappedResponseWriter.WriteHeader(statusCode)\n    }\n\n    // AddFallbackHandler wraps the handler func in another handler func covering authentication\n    func AddFallbackHandler(handler http.HandlerFunc, filename string) http.HandlerFunc {\n        Log.Printf(\"INFO: Creating fallback handler\")\n        return func(w http.ResponseWriter, r *http.Request) {\n            Log.Printf(\"INFO: Wrapping response writer in fallback response writer\")\n            frw := FallbackResponseWriter{\n                WrappedResponseWriter: w,\n                FileNotFound:          false,\n            }\n            handler(&amp;frw, r)\n            if frw.FileNotFound {\n                Log.Printf(\"INFO: Serving fallback\")\n                http.Redirect(w, r, \"/\", http.StatusSeeOther)\n            }\n        }\n    }\n</code></pre>\n\n<p>It can be added as in this example (using goji as mux):</p>\n\n<pre><code>    mux.Handle(pat.Get(\"/*\"),\n        AddFallbackHandler(http.FileServer(http.Dir(\"./html\")).ServeHTTP, \"/\"))\n\n</code></pre>\n"}], "owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53929, "favorite_count": 20, "accepted_answer_id": 28798174, "answer_count": 2, "score": 46, "last_activity_date": 1548956592, "creation_date": 1425213530, "question_id": 28793619, "link": "https://stackoverflow.com/questions/28793619/golang-what-to-use-http-servefile-or-http-fileserver", "title": "Golang. What to use? http.ServeFile(..) or http.FileServer(..)?", "body": "<p>I'm a little bit confused. Much of examples shows usage of both: <code>http.ServeFile(..)</code> and <code>http.FileServer(..)</code>, but seems they have very close functionality. Also I have found no information about how to set custom NotFound handler. </p>\n\n<pre><code>// This works and strip \"/static/\" fragment from path\nfs := http.FileServer(http.Dir(\"static\"))\nhttp.Handle(\"/static/\", http.StripPrefix(\"/static/\", fs))\n\n// This works too, but \"/static2/\" fragment remains and need to be striped manually\nhttp.HandleFunc(\"/static2/\", func(w http.ResponseWriter, r *http.Request) {\n    http.ServeFile(w, r, r.URL.Path[1:])\n})\n\nhttp.ListenAndServe(\":8080\", nil)\n</code></pre>\n\n<p>I've tried to read source code and both of them use <code>serveFile(ResponseWriter, *Request, FileSystem, string, bool)</code> underlying function. However <code>http.FileServer</code> return <code>fileHandler</code> with its own <code>ServeHTTP()</code> method and make some preparation work before serving file (eg path.Clean()).</p>\n\n<p>So why need this separation? Which method better to use? And how can I set custom NotFound handler, for example when requested file not found?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 0, "last_activity_date": 1425241676, "creation_date": 1425241676, "answer_id": 28798663, "question_id": 28792884, "link": "https://stackoverflow.com/questions/28792884/go-generate-stringer-invalid-operation-has-no-field-or-method-string/28798663#28798663", "title": "go generate: stringer: invalid operation: has no field or method String", "body": "<p>Each file must be parsed and type checked by the <a href=\"http://godoc.org/golang.org/x/tools/go/types\" rel=\"nofollow\"><code>types</code></a> library before the methods are generated. This usually doesn't pose a problem, since the <code>String()</code> method is rarely called directly, and is used by passing a value to something like <code>fmt.Println</code> that always checks first for a <code>Stringer</code>.</p>\n\n<p>You can either <em>not</em> call <code>String()</code> yourself:</p>\n\n<p>file: type.go</p>\n\n<pre><code>//go:generate stringer -type=MyIntType\npackage painkiller\n\nimport \"fmt\"\n\ntype MyIntType int\n\nconst (\n    resource MyIntType = iota\n)\n\nfunc myfunc() {\n    fmt.Println(resource)\n}\n</code></pre>\n\n<p>Or you can put the calls in another file, and pass only the files that stringer needs as arguments. With no arguments, stringer checks the package as a whole, but if you provide only a list of files, they assume that some methods may be defined in files not provided. </p>\n\n<p>file: type.go</p>\n\n<pre><code>//go:generate stringer -type=MyIntType type.go\npackage foo\n\ntype MyIntType int\n\nconst (\n    resource MyIntType = iota\n)\n</code></pre>\n\n<p>file myfunc.go</p>\n\n<pre><code>package foo\n\nfunc myfunc() {\n    print(resource.String())\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1172, "user_id": 504262, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/73f854ddc54795abe5bd0fe1e914ed7e?s=128&d=identicon&r=PG", "display_name": "satran", "link": "https://stackoverflow.com/users/504262/satran"}, "edited": false, "score": 0, "creation_date": 1425243338, "post_id": 28798830, "comment_id": 45872107, "body": "Have submitted an <a href=\"https://github.com/golang/go/issues/10045\" rel=\"nofollow noreferrer\">issue</a>. Do have a look at how things work out."}], "tags": [], "owner": {"reputation": 1172, "user_id": 504262, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/73f854ddc54795abe5bd0fe1e914ed7e?s=128&d=identicon&r=PG", "display_name": "satran", "link": "https://stackoverflow.com/users/504262/satran"}, "is_accepted": false, "score": 0, "last_activity_date": 1425242675, "creation_date": 1425242675, "answer_id": 28798830, "question_id": 28792884, "link": "https://stackoverflow.com/questions/28792884/go-generate-stringer-invalid-operation-has-no-field-or-method-string/28798830#28798830", "title": "go generate: stringer: invalid operation: has no field or method String", "body": "<p>The stringer cmd calls the go/parser.ParseFile for every go file. Thus if you have a method that is not declared it will fail. You will have to use fmt.Sprint* statements to get over this. Or you could tell go generate to only generate a specific file.</p>\n\n<p>I don't know if we could term this as a bug. You could file it, probably see what the response is.</p>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 787, "favorite_count": 1, "accepted_answer_id": 28798663, "answer_count": 2, "score": 3, "last_activity_date": 1425242675, "creation_date": 1425208543, "question_id": 28792884, "link": "https://stackoverflow.com/questions/28792884/go-generate-stringer-invalid-operation-has-no-field-or-method-string", "title": "go generate: stringer: invalid operation: has no field or method String", "body": "<p>I'm trying to use the <a href=\"https://godoc.org/golang.org/x/tools/cmd/stringer\" rel=\"nofollow\">stringer</a> cmd so that I can generate String() methods for some int types. Here is how the code looks like</p>\n\n<pre><code>//go:generate stringer -type=MyIntType\ntype MyIntType int\n\nconst (\n    resource MyIntType = iota\n)\nfunc myfunc(){\nprint(resource.String())\n}\n</code></pre>\n\n<p>The error I'm getting on go generate command is <code>invalid operation: resource (constant 0 of type MyIntType) has no field or method String</code> which makes sense because there is no String method yet. How am I supposed to fix this error if stringer cmd is supposed to actually generate the String method? Should I use fmt.Sprintf(\"%s\", resource) all over the code ? it looks a bit ugly to me. At least not as nice as resource.String().</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3308, "user_id": 289684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e0cf554b2f6c7b75ded2918fcb3d74f?s=128&d=identicon&r=PG", "display_name": "Ha.", "link": "https://stackoverflow.com/users/289684/ha"}, "edited": false, "score": 2, "creation_date": 1425205773, "post_id": 28792439, "comment_id": 45859766, "body": "This process is called compilation. Search for &quot;how to compile a go program&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 0, "last_activity_date": 1425209585, "creation_date": 1425209585, "answer_id": 28793041, "question_id": 28792439, "link": "https://stackoverflow.com/questions/28792439/install-a-go-script-to-run-from-shell/28793041#28793041", "title": "Install a go script to run from shell", "body": "<p>If you SSL_CHECK.go is in the package main, all you need to do is <code>go install</code> (as in \"<a href=\"https://golang.org/cmd/go/#hdr-Compile_and_install_packages_and_dependencies\" rel=\"nofollow\">Compile and install packages and dependencies</a>\").  </p>\n\n<p>That will generate a <code>SSH_CHECK</code> executable and put it in your <code>$GOPATH/bin</code> folder, which should be referenced in your <code>$PATH</code>.</p>\n"}], "owner": {"reputation": 15, "user_id": 4512643, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/41683598b29b64dc551cd2d24eaadc8c?s=128&d=identicon&r=PG&f=1", "display_name": "Rajlakshmi Sarma", "link": "https://stackoverflow.com/users/4512643/rajlakshmi-sarma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1592, "favorite_count": 1, "accepted_answer_id": 28793041, "answer_count": 1, "score": -2, "last_activity_date": 1425209585, "creation_date": 1425205388, "question_id": 28792439, "link": "https://stackoverflow.com/questions/28792439/install-a-go-script-to-run-from-shell", "title": "Install a go script to run from shell", "body": "<p>I have a go script named <code>SSL_CHECK.go</code>. Now to run it I need to run it as <code>go run SSL_CHECK.go &lt;&lt;optiional arguments&gt;&gt;</code></p>\n\n<p>I want to compile this script so that I can execute it as a shell command.</p>\n\n<p>For instance like <code>./ssl_check &lt;&lt;optional arguments&gt;&gt;</code> from the shell.</p>\n\n<p>Can I achieve that in Go.</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4122236"}, "edited": false, "score": 2, "creation_date": 1425225136, "post_id": 28791692, "comment_id": 45865616, "body": "It&#39;s a matter of opinion on which router is best for the task. If you are new to Go, it&#39;s probably best to start with the standard library and then reach elsewhere if you need more."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1425293889, "last_edit_date": 1425293889, "creation_date": 1425290976, "answer_id": 28807123, "question_id": 28791692, "link": "https://stackoverflow.com/questions/28791692/go-rest-api-on-gae/28807123#28807123", "title": "Go Rest API on GAE", "body": "<p>As mentioned in a comment, you can start with the Go standard library, and only utilize 3rd party libs if you reach a point when the standard library is not sufficient for you (which point you may never reach).</p>\n\n<p>If your clients are not browsers (you said you don't want any views) but any other arbitrary HTTP clients, an HTTP session may not be what you want. An HTTP session is usually managed by storing a session ID in an HTTP cookie which is automatically sent by the browser along with each HTTP request, and at the server side this session ID is read and an associated, server side data structue is looked up by it.</p>\n\n<p>A common solution is to use some kind of <em>secret information</em> referred to as a <em>key</em> or <em>API key</em>. The idea is that if you want to grant access to someone, you generate a <em>secret key</em> (e.g. a random text) at server side which you store in the database. You send this key to the client who has to attach this to every API request he makes. At server side in the beginning of each API request you can check if the provided API key is valid (this also identifies the caller) and act accordingly.</p>\n\n<p>The API key can be sent in various ways by the clients, e.g. as a URL parameter (<strong>strongly not recommended</strong> for unsecure HTTP requests but is perfectly fine for HTTPS requests), as an HTTP header field or as part of the request data structure. It is really up to you how you expect it, usually depends on how the requests look like (e.g. if they don't include any data, it's better to put the KEY in a header or URL parameter; if the clients are expected to send other, complex data which can be in the form of JSON text, it can be convenient to also include the API key in the JSON data too).</p>\n"}], "owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 690, "favorite_count": 1, "accepted_answer_id": 28807123, "answer_count": 1, "score": 1, "last_activity_date": 1425293889, "creation_date": 1425199976, "last_edit_date": 1425205212, "question_id": 28791692, "link": "https://stackoverflow.com/questions/28791692/go-rest-api-on-gae", "title": "Go Rest API on GAE", "body": "<p>I'm pretty new to go and I want to build a CRUD rest API on GAE without views just simple JSON Rest API.</p>\n\n<p>There is allot of frameworks out there,\n<a href=\"https://github.com/julienschmidt/go-http-routing-benchmark\" rel=\"nofollow\">go-http-routing-benchmark</a>.</p>\n\n<p>But I'm not sure which one will be most suitable for GAE.</p>\n\n<p>My main concern is how to handle a safe and secure session .</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 8782, "user_id": 554279, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1eb91391d341dfa930ff2e2a59025ce6?s=128&d=identicon&r=PG", "display_name": "Rangi Lin", "link": "https://stackoverflow.com/users/554279/rangi-lin"}, "edited": false, "score": 0, "creation_date": 1425200553, "post_id": 28791744, "comment_id": 45858558, "body": "Thank you, that make sense now."}], "tags": [], "owner": {"reputation": 230, "user_id": 2152105, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5YGz.jpg?s=128&g=1", "display_name": "Jaemin Park", "link": "https://stackoverflow.com/users/2152105/jaemin-park"}, "is_accepted": true, "score": 5, "last_activity_date": 1425200397, "creation_date": 1425200397, "answer_id": 28791744, "question_id": 28791568, "link": "https://stackoverflow.com/questions/28791568/compile-error-when-comparing-between-named-type-and-unamed-type/28791744#28791744", "title": "Compile error when comparing between named type and unamed type", "body": "<p>In short, second expression is invalid their types are incompatible.</p>\n\n<p>Every operations in Go, arguments are must be same type. The second expression</p>\n\n<pre><code>template.HTML(\"test\") == htmlString\n</code></pre>\n\n<p>is invalid since it's comparing <code>template.HTML</code> and <code>string</code>. Although <code>template.HTML</code> is driven from <code>string</code>, but it is incompatible. You should cast the variable like <code>template.HTML(htmlString)</code>.</p>\n\n<p>But the first expression</p>\n\n<pre><code>template.HTML(\"test\") == \"test\"\n</code></pre>\n\n<p>is valid because the type of constant \"test\" interpreted as <code>template.HTML</code>. Untyped constant has default type, but it can be any driven type by context at compile time. <a href=\"http://blog.golang.org/constants\" rel=\"noreferrer\">This article</a> explains about constant in detail. Maybe this article make your question clear.</p>\n"}], "owner": {"reputation": 8782, "user_id": 554279, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1eb91391d341dfa930ff2e2a59025ce6?s=128&d=identicon&r=PG", "display_name": "Rangi Lin", "link": "https://stackoverflow.com/users/554279/rangi-lin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 28791744, "answer_count": 1, "score": 0, "last_activity_date": 1425200397, "creation_date": 1425198807, "question_id": 28791568, "link": "https://stackoverflow.com/questions/28791568/compile-error-when-comparing-between-named-type-and-unamed-type", "title": "Compile error when comparing between named type and unamed type", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"html/template\"\n)\n\nfunc main() {\n    fmt.Println(template.HTML(\"test\") == \"test\")\n\n    htmlString := \"test\"\n    fmt.Println(template.HTML(\"test\") == htmlString)\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/dON4eLpGN8\" rel=\"nofollow\">http://play.golang.org/p/dON4eLpGN8</a></p>\n\n<p>document for <code>template.HTML</code>:\n<a href=\"http://golang.org/pkg/html/template/#HTML\" rel=\"nofollow\">http://golang.org/pkg/html/template/#HTML</a></p>\n\n<p>The first comparison is <code>true</code>. However, the second comparison yield following error :</p>\n\n<blockquote>\n  <p>invalid operation: \"html/template\".HTML(\"test\") == htmlString\n  (mismatched types \"html/template\".HTML and string)</p>\n</blockquote>\n\n<p>Can someone explain what happened under the hood ?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 0, "creation_date": 1425194483, "post_id": 28790407, "comment_id": 45857387, "body": "That results in the test binary being built and run though."}, {"owner": {"reputation": 16, "user_id": 4619470, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d05dc0c81cd03117cc417e116161a331?s=128&d=identicon&r=PG", "display_name": "Morton", "link": "https://stackoverflow.com/users/4619470/morton"}, "reply_to_user": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 0, "creation_date": 1425227289, "post_id": 28790407, "comment_id": 45866420, "body": "@JamesHenstridge The only way to tell if something builds successfully is to build it. This command does not run the tests per the requirement in the question."}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 0, "creation_date": 1425259515, "post_id": 28790407, "comment_id": 45876582, "body": "any code in <code>init</code> functions, or run to initialise globals will be executed, since that happens before the test program decides what tests to execute."}, {"owner": {"reputation": 16, "user_id": 4619470, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d05dc0c81cd03117cc417e116161a331?s=128&d=identicon&r=PG", "display_name": "Morton", "link": "https://stackoverflow.com/users/4619470/morton"}, "reply_to_user": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 1, "creation_date": 1425266015, "post_id": 28790407, "comment_id": 45877981, "body": "@JamesHenstridge Yeah, but that&#39;s not what you asked in the question."}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 0, "creation_date": 1425273623, "post_id": 28790407, "comment_id": 45879734, "body": "I didn&#39;t ask the question.  But if his concern is about running untrusted code, then code in <code>init</code> functions is going to be just as much a concern as code within <code>Test*</code> functions."}], "tags": [], "owner": {"reputation": 16, "user_id": 4619470, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d05dc0c81cd03117cc417e116161a331?s=128&d=identicon&r=PG", "display_name": "Morton", "link": "https://stackoverflow.com/users/4619470/morton"}, "is_accepted": true, "score": 0, "last_activity_date": 1425187276, "creation_date": 1425187276, "answer_id": 28790407, "question_id": 28790347, "link": "https://stackoverflow.com/questions/28790347/check-package-and-its-tests-build-without-creating-a-binary-or-running-the-tests/28790407#28790407", "title": "Check package and its tests build without creating a binary or running the tests", "body": "<p>Use the command:</p>\n\n<pre><code>go test -run @\n</code></pre>\n\n<p>This command compiles the package and tests and starts the test application, but no tests run because no function name matches the regular expression \"@\".</p>\n"}], "owner": {"reputation": 99684, "user_id": 149482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb6a2b464b7190c48e4f148a0e51d13a?s=128&d=identicon&r=PG", "display_name": "Matt Joiner", "link": "https://stackoverflow.com/users/149482/matt-joiner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 28790407, "answer_count": 1, "score": 2, "last_activity_date": 1425316192, "creation_date": 1425186734, "last_edit_date": 1425316192, "question_id": 28790347, "link": "https://stackoverflow.com/questions/28790347/check-package-and-its-tests-build-without-creating-a-binary-or-running-the-tests", "title": "Check package and its tests build without creating a binary or running the tests", "body": "<p>Using Go, how can I check that a package and its tests will build successfully, without running the tests or creating a binary that outlives the check?</p>\n"}, {"tags": ["go", "martini"], "answers": [{"tags": [], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "is_accepted": false, "score": 0, "last_activity_date": 1425184330, "creation_date": 1425184330, "answer_id": 28790115, "question_id": 28789901, "link": "https://stackoverflow.com/questions/28789901/get-request-url-in-martini-context/28790115#28790115", "title": "get request url in martini.Context", "body": "<p>The answer is in adding <code>req *http.Request</code> parameter to <code>func RecoverWrap(c martini.Context, req *http.Request, w http.ResponseWriter)</code></p>\n\n<p>Full code:  </p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n    \"github.com/go-martini/martini\"\n    \"net/http\"\n)\n\nfunc main() {\n    m := martini.Classic()\n    m.Use(RecoverWrap)\n    m.Get(\"/panic\", func() {\n        panic(\"some panic\")\n    })\n\n    m.Get(\"/\", func(req *http.Request, res http.ResponseWriter) {\n        res.Write([]byte(\"mainPage\"))\n    })\n\n    m.Run()\n}\n\nfunc RecoverWrap(c martini.Context, req *http.Request, w http.ResponseWriter) {\n    var err error\n    defer func(w http.ResponseWriter) {\n        r := recover()\n        if r != nil {\n            switch t := r.(type) {\n            case string:\n                err = errors.New(t)\n            case error:\n                err = t\n            default:\n                err = errors.New(\"Unknown error\")\n            }\n\n            fmt.Println(\"req.URL.Path\")\n            fmt.Println(req.URL.Path)\n            http.Error(w, \"Something goes wrong\", http.StatusInternalServerError)\n        }\n    }(w)\n    c.Next()\n}\n</code></pre>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 585, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1425184330, "creation_date": 1425181939, "question_id": 28789901, "link": "https://stackoverflow.com/questions/28789901/get-request-url-in-martini-context", "title": "get request url in martini.Context", "body": "<p>I want to send email to myself with error occured on page <a href=\"http://localhost:3000/panic\" rel=\"nofollow\">http://localhost:3000/panic</a> with containing error url - <code>/panic</code> in our case. But I can not figure out how to get url from <code>c martini.Context</code> inside <code>RecoverWrap</code> method.</p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"github.com/go-martini/martini\"\n    \"net/http\"\n)\n\nfunc main() {\n    m := martini.Classic()\n    m.Use(RecoverWrap)\n    m.Get(\"/panic\", func() {\n        panic(\"some panic\")\n    })\n\n    m.Get(\"/\", func(req *http.Request, res http.ResponseWriter) {\n        res.Write([]byte(\"mainPage\"))\n    })\n\n    m.Run()\n}\n\nfunc RecoverWrap(c martini.Context, w http.ResponseWriter) {\n    var err error\n    defer func(w http.ResponseWriter) {\n        r := recover()\n        if r != nil {\n            switch t := r.(type) {\n            case string:\n                err = errors.New(t)\n            case error:\n                err = t\n            default:\n                err = errors.New(\"Unknown error\")\n            }\n            // how to get request url here\n            // I want to send email with error url\n            http.Error(w, \"Something goes wrong\", http.StatusInternalServerError)\n        }\n    }(w)\n    c.Next()\n}\n</code></pre>\n"}, {"tags": ["go", "variadic"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 5, "creation_date": 1425162807, "post_id": 28787489, "comment_id": 45851239, "body": "Yes, your version is much saner."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1425163081, "post_id": 28787489, "comment_id": 45851345, "body": "I wonder if the compiler optimizes the first example somehow..."}], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1425244868, "post_id": 28799153, "comment_id": 45872613, "body": "Note: rather than running <code>go test -bench</code> repeatedly just (apparently) to eliminate noise you could have used something like <code>-benchtime=10s</code>."}], "tags": [], "owner": {"reputation": 1172, "user_id": 504262, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/73f854ddc54795abe5bd0fe1e914ed7e?s=128&d=identicon&r=PG", "display_name": "satran", "link": "https://stackoverflow.com/users/504262/satran"}, "is_accepted": true, "score": 1, "last_activity_date": 1425282563, "last_edit_date": 1425282563, "creation_date": 1425244393, "answer_id": 28799153, "question_id": 28787489, "link": "https://stackoverflow.com/questions/28787489/variadic-pack-and-unpack-in-go-lang-stringfv/28799153#28799153", "title": "variadic pack and unpack in go lang: &#39;[]string{f(v)}...&#39;", "body": "<p>The version you have written is correct and sane to understand. I wrote a benchmark:</p>\n\n<pre><code>package p\n\nimport (\n    \"testing\"\n    \"strings\"\n)\n\nvar s = []string{\"hello\", \"world\", \"this\", \"new\", \"world\"}\n\nfunc BenchmarkAcc1(b *testing.B) {\n    for n := 0; n &lt; b.N; n++ {\n        Accumulate(s, strings.ToUpper)\n    }\n}\n\nfunc BenchmarkAcc2(b *testing.B) {\n    for n := 0; n &lt; b.N; n++ {\n        Accumulate2(s, strings.ToUpper)\n    }\n}\n</code></pre>\n\n<p>Here are a few results I got:</p>\n\n<pre><code>% go test -benchtime=10s -bench=.\ntesting: warning: no tests to run\nPASS\nBenchmarkAcc1   10000000          1510 ns/op\nBenchmarkAcc2   10000000          1492 ns/op\nok      _/home/satran/test  33.064s\n</code></pre>\n\n<p>As you can see there is no performance gain either, in fact your version works better.</p>\n\n<p>Here is the source:</p>\n\n<pre><code>package p\n\nfunc Accumulate(s []string, f func(st string) string) (result []string) {\n    for _, v := range s {\n        result = append(result, []string{f(v)}...)\n    }\n    return result\n}\n\nfunc Accumulate2(s []string, f func(st string) string) (result []string) {\n    for _, v := range s {\n        result = append(result, f(v))\n    }\n    return result\n}\n</code></pre>\n"}], "owner": {"reputation": 14155, "user_id": 632088, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4b02313659bcb668d49a0075c2de0bc1?s=128&d=identicon&r=PG", "display_name": "robert king", "link": "https://stackoverflow.com/users/632088/robert-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 28799153, "answer_count": 1, "score": 1, "last_activity_date": 1425282563, "creation_date": 1425161081, "question_id": 28787489, "link": "https://stackoverflow.com/questions/28787489/variadic-pack-and-unpack-in-go-lang-stringfv", "title": "variadic pack and unpack in go lang: &#39;[]string{f(v)}...&#39;", "body": "<p>I found this function while browsing github:</p>\n\n<pre><code>func Accumulate(s []string, f func(st string) string) (result []string) {\n    for _, v := range s {\n        result = append(result, []string{f(v)}...)\n    }\n    return result\n}\n</code></pre>\n\n<p>Could this method be simplified to the following, or am I missing something:</p>\n\n<pre><code>func Accumulate(s []string, f func(st string) string) (result []string) {\n    for _, v := range s {\n        result = append(result, f(v))\n    }\n    return result\n}\n</code></pre>\n"}, {"tags": ["linux", "unix", "ssh", "go"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 5, "creation_date": 1425153607, "post_id": 28786190, "comment_id": 45848539, "body": "Don&#39;t do that; configure your <code>ssh</code> for public/private keys"}, {"owner": {"reputation": 17, "user_id": 2509594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/316caddb3d92d604422d482421b6c1e1?s=128&d=identicon&r=PG", "display_name": "user2509594", "link": "https://stackoverflow.com/users/2509594/user2509594"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1425153868, "post_id": 28786190, "comment_id": 45848620, "body": "There a few cases where I need this, would be useful if you could provide some help :)"}, {"owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "edited": false, "score": 1, "creation_date": 1425156964, "post_id": 28786190, "comment_id": 45849552, "body": "The problem in doing this is that the password prompt is not to your stdin/stdout, but to the /dev/tty device.  It might be possible to work around that using pseudo-terminal connections, but I haven&#39;t seen it done."}, {"owner": {"reputation": 17, "user_id": 2509594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/316caddb3d92d604422d482421b6c1e1?s=128&d=identicon&r=PG", "display_name": "user2509594", "link": "https://stackoverflow.com/users/2509594/user2509594"}, "reply_to_user": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "edited": false, "score": 0, "creation_date": 1425158650, "post_id": 28786190, "comment_id": 45850032, "body": "@ThomasDickey Interesting, could you tell me more on how to implement this?"}, {"owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "edited": false, "score": 0, "creation_date": 1425159271, "post_id": 28786190, "comment_id": 45850230, "body": "An explanation would be lengthy (I don&#39;t program in go, and my explanation would require some tinkering to make it useful to you).  I checked my recollection of scp&#39;s use of /dev/tty using strace."}, {"owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "edited": false, "score": 0, "creation_date": 1425159778, "post_id": 28786190, "comment_id": 45850388, "body": "The &quot;expect&quot; program might be able to supply the password, for instance -- <a href=\"http://expect.sourceforge.net/\" rel=\"nofollow noreferrer\">expect.sourceforge.net</a> using a suitable script.  From the nature of what it does, I assume it is manipulating things with pseudo-terminals.  The &quot;script&quot; program is much simpler, if you simply wanted to study the topic.  But that assumes you would call some special wrapper for scp.  Within go, there might be some more elegant solution."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "edited": false, "score": 0, "creation_date": 1425160179, "post_id": 28786190, "comment_id": 45850479, "body": "@ThomasDickey If ssh does not support getting a password from a file descriptor or similar, there is probably a damn good reason for that."}, {"owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "edited": false, "score": 0, "creation_date": 1425160638, "post_id": 28786190, "comment_id": 45850593, "body": "I&#39;m well aware of that.  However, that was not the question."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 2509594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/316caddb3d92d604422d482421b6c1e1?s=128&d=identicon&r=PG", "display_name": "user2509594", "link": "https://stackoverflow.com/users/2509594/user2509594"}, "edited": false, "score": 0, "creation_date": 1425158614, "post_id": 28786936, "comment_id": 45850015, "body": "That&#39;s using the SSH library, it makes a connection to the server and calls scp from the server. I don&#39;t have scp available to me on the server."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 17, "user_id": 2509594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/316caddb3d92d604422d482421b6c1e1?s=128&d=identicon&r=PG", "display_name": "user2509594", "link": "https://stackoverflow.com/users/2509594/user2509594"}, "edited": false, "score": 1, "creation_date": 1425163271, "post_id": 28786936, "comment_id": 45851402, "body": "@user2509594: for scp to work, you must have scp on the server. scp works over ssh, but technically has nothing to do with it, and the scp binary is required on both sides since it is called via <code>ssh hostname scp -t</code>"}], "tags": [], "owner": {"reputation": 3818, "user_id": 1247113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRMFj.png?s=128&g=1", "display_name": "rob74", "link": "https://stackoverflow.com/users/1247113/rob74"}, "is_accepted": false, "score": 1, "last_activity_date": 1425158099, "last_edit_date": 1495540253, "creation_date": 1425157782, "answer_id": 28786936, "question_id": 28786190, "link": "https://stackoverflow.com/questions/28786190/how-to-feed-a-password-to-ssh/28786936#28786936", "title": "How to feed a password to SSH?", "body": "<p>The answer to this self-answered question might help:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/23019890/golang-write-input-and-get-output-from-terminal-process\">Golang write input and get output from terminal process</a></p>\n\n<p>at least, he mentions in the answer that he \"was able to get ssh access working with a password\", which is not mentioned explicitly in the question - that's why you probably didn't find it while searching the site?</p>\n"}], "owner": {"reputation": 17, "user_id": 2509594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/316caddb3d92d604422d482421b6c1e1?s=128&d=identicon&r=PG", "display_name": "user2509594", "link": "https://stackoverflow.com/users/2509594/user2509594"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1425202270, "creation_date": 1425153419, "last_edit_date": 1425202270, "question_id": 28786190, "link": "https://stackoverflow.com/questions/28786190/how-to-feed-a-password-to-ssh", "title": "How to feed a password to SSH?", "body": "<p>I need to use password authenticated scp to download a file from a server. How do I do so using Go? Tried the following code, but it doesn't pass in the password.</p>\n\n<pre><code>package main\n\nimport (\n    \"os/exec\"\n    \"time\"\n)\n\nfunc main() {\n    password := \"password\"\n    cmd := exec.Command(\"scp\", \"admin@192.168.1.150:file\", \"file\")\n\n    in, err := cmd.StdinPipe()\n    if err != nil {\n        panic(err)\n    }\n\n    defer in.Close()\n\n    out, err := cmd.StdoutPipe()\n    if err != nil {\n        panic(err)\n    }\n\n    defer out.Close()\n\n    if err = cmd.Run(); err != nil {\n        panic(err)\n    }\n\n    go func() {\n        time.Sleep(10 * time.Second)\n        _, err = in.Write([]byte(password + \"\\n\"))\n        if err != nil {\n            panic(err)\n        }\n    }()\n}\n</code></pre>\n\n<p>Edit: I ended up using the gexpect (github.com/ThomasRooney/gexpect) library.</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/ThomasRooney/gexpect\"\n    \"log\"\n)\n\nfunc main() {\n    child, err := gexpect.Spawn(\"scp admin@192.168.1.150:file file\")\n    if err != nil {\n        log.Fatalln(err)\n    }\n    child.Expect(\"password:\")\n    child.SendLine(\"password\")\n    child.Interact()\n    child.Close()\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 20459, "user_id": 1120221, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0977d36f1cf30241c35121f1d741c8e9?s=128&d=identicon&r=PG&f=1", "display_name": "Salah Eddine Taouririt", "link": "https://stackoverflow.com/users/1120221/salah-eddine-taouririt"}, "edited": false, "score": 0, "creation_date": 1425153876, "post_id": 28786232, "comment_id": 45848621, "body": "Thanks @FUZxxl  Where can I read this in the golang spec document ?"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 20459, "user_id": 1120221, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0977d36f1cf30241c35121f1d741c8e9?s=128&d=identicon&r=PG&f=1", "display_name": "Salah Eddine Taouririt", "link": "https://stackoverflow.com/users/1120221/salah-eddine-taouririt"}, "edited": false, "score": 0, "creation_date": 1425154217, "post_id": 28786232, "comment_id": 45848709, "body": "@tarrsalah That&#39;s a bit tricky. Syntactically, a slice or index expression takes a <code>PrimaryExpr</code> and creates a <code>PrimaryExpr</code> whereas unary <code>*</code> is an operator that takes a <code>UnaryExpr</code> and creates a <code>UnaryExpr</code>. A <code>PrimaryExpr</code> can become an <code>UnaryExpr</code> but not the other way round which explains these precedence rules. It&#39;s all over the place in the spec, nowhere in particular to point you too."}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 4, "last_activity_date": 1425153683, "creation_date": 1425153683, "answer_id": 28786232, "question_id": 28786137, "link": "https://stackoverflow.com/questions/28786137/slicing-a-pointer-to-slice/28786232#28786232", "title": "Slicing a pointer to slice", "body": "<p>A slice expression binds stronger than a dereference. Try this:</p>\n\n<pre><code>*slicePtr = (*slicePtr)[0 : len(*slicePtr)-1]\n</code></pre>\n"}], "owner": {"reputation": 20459, "user_id": 1120221, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0977d36f1cf30241c35121f1d741c8e9?s=128&d=identicon&r=PG&f=1", "display_name": "Salah Eddine Taouririt", "link": "https://stackoverflow.com/users/1120221/salah-eddine-taouririt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 0, "accepted_answer_id": 28786232, "answer_count": 1, "score": 2, "last_activity_date": 1425169534, "creation_date": 1425153097, "last_edit_date": 1425169534, "question_id": 28786137, "link": "https://stackoverflow.com/questions/28786137/slicing-a-pointer-to-slice", "title": "Slicing a pointer to slice", "body": "<p>When I'm following this <a href=\"http://blog.golang.org/slices\" rel=\"nofollow\">golang blog post</a>  about arrays and slices, I tried to pass a <strong>pointer to a slice</strong> to a function that modify the underlying <code>len</code> property in the slice header:</p>\n\n<pre><code>func PtrSubtractOneFromLength(slicePtr *[]byte) {\n    slice := *slicePtr\n    *slicePtr = slice[0 : len(slice)-1]\n}\n</code></pre>\n\n<p>And when I tried to refactor it to this from:</p>\n\n<pre><code>func PtrSubtractOneFromLength(slicePtr *[]int) {\n    *slicePtr = *slicePtr[0 : len(*slicePtr)-1]\n}\n</code></pre>\n\n<p>I get this error</p>\n\n<pre><code>cannot slice slicePtr (type *[]int)\n</code></pre>\n\n<p>Where is the magic in the <code>slice := *slicePtr</code> statement?</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "edited": false, "score": 1, "creation_date": 1425151113, "post_id": 28785505, "comment_id": 45847704, "body": "Care to elaborate on the down vote?"}], "answers": [{"comments": [{"owner": {"reputation": 52749, "user_id": 1400768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tM0N8.png?s=128&g=1", "display_name": "nhahtdh", "link": "https://stackoverflow.com/users/1400768/nhahtdh"}, "edited": false, "score": 0, "creation_date": 1425290174, "post_id": 28785651, "comment_id": 45886601, "body": "You might want to include an alternation for empty string, since the original regex allows for it."}], "tags": [], "owner": {"reputation": 65435, "user_id": 2206004, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCB1e.png?s=128&g=1", "display_name": "hwnd", "link": "https://stackoverflow.com/users/2206004/hwnd"}, "is_accepted": true, "score": 2, "last_activity_date": 1425362151, "last_edit_date": 1425362151, "creation_date": 1425150332, "answer_id": 28785651, "question_id": 28785505, "link": "https://stackoverflow.com/questions/28785505/negative-lookbehind-failure/28785651#28785651", "title": "Negative Lookbehind failure", "body": "<p>Lookarounds are not supported, you could use a possible workaround:</p>\n\n<pre><code>re := regexp.MustCompile(`'(.*?[^\\\\]|)'`)\nvalues := re.FindAllStringSubmatch(theRawEnumValuesString, -1)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 28785651, "answer_count": 1, "score": 1, "last_activity_date": 1425362151, "creation_date": 1425149530, "question_id": 28785505, "link": "https://stackoverflow.com/questions/28785505/negative-lookbehind-failure", "title": "Negative Lookbehind failure", "body": "<p>I have a little MySQL table inspector script in my Golang code. The last thing I wanted to do was to store any possible <code>enum</code> value when my application starts so I can read it out of the buffer instead of having to describe the tables constantly for API calls.</p>\n\n<p>Now with <code>enum</code>'s stuff like <code>'value1','value2','value\\'s3</code> can occur, where simple RegEx like <code>'(.*?)'</code> doesn't work because of the escaped quotation-mark in <code>value\\'s3</code>. So I wrote a negative look-behind to make it match only if it is a non-escaped quotation-mark. Not totally flawless but at least some extra checks and I manage the database structure by myself so it's something I can just keep a small note on.</p>\n\n<p>To the point; the negative-lookbehind fails  <code>'(.*?)(?&lt;!\\\\)'</code>:</p>\n\n<pre><code>panic: regexp: Compile(`'(.*?)(?&lt;!\\\\)'`): error parsing regexp: invalid or unsupported Perl syntax: `(?&lt;`\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>var enumMatchValues = regexp.MustCompile(`'(.*?)(?&lt;!\\\\)'`)\nvalues := enumMatchValues.FindAllStringSubmatch(theRawEnumValuesString, -1)\n</code></pre>\n\n<p>Are the lookaheads/lookbehinds officially not part of the core of the RegEx functionality or is this just something Golang hasn't implemented yet?</p>\n\n<p>Would there be another workaround or extended RegEx package for Go to solve this?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1425152821, "post_id": 28783637, "comment_id": 45848273, "body": "Where does the requirement to not write intermediate files comes from?"}], "answers": [{"comments": [{"owner": {"reputation": 4181, "user_id": 3337677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2a3cb5dc363dbc123686e074c4c3181e?s=128&d=identicon&r=PG&f=1", "display_name": "packetie", "link": "https://stackoverflow.com/users/3337677/packetie"}, "edited": false, "score": 0, "creation_date": 1425145988, "post_id": 28784016, "comment_id": 45846058, "body": "Thanks @Not_a_Golfer for the idea of using strace.  Sounds like the only possibility is to create ramdisk so go will write the intermediate files in thse ramdisk. Wonder if there is a package for it."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 4181, "user_id": 3337677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2a3cb5dc363dbc123686e074c4c3181e?s=128&d=identicon&r=PG&f=1", "display_name": "packetie", "link": "https://stackoverflow.com/users/3337677/packetie"}, "edited": false, "score": 0, "creation_date": 1425150668, "post_id": 28784016, "comment_id": 45847562, "body": "@codingFun on most recent linux distros, /tmp is a ramdisk (tmpfs)."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1425157595, "post_id": 28784016, "comment_id": 45849746, "body": "@OneOfOne: that&#39;s far from universally true. Most do have a block of shared memory mapped to <code>&#47;run&#47;shm</code>, or <code>&#47;dev&#47;shm</code> though."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1425163598, "post_id": 28784016, "comment_id": 45851488, "body": "@JimB good to know, I&#39;m personally using arch and tried 1 or 2 other that had it that way too."}, {"owner": {"reputation": 4181, "user_id": 3337677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2a3cb5dc363dbc123686e074c4c3181e?s=128&d=identicon&r=PG&f=1", "display_name": "packetie", "link": "https://stackoverflow.com/users/3337677/packetie"}, "edited": false, "score": 0, "creation_date": 1425225135, "post_id": 28784016, "comment_id": 45865613, "body": "Thanks guys for the points. I have clarified the question with update1."}, {"owner": {"reputation": 4181, "user_id": 3337677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2a3cb5dc363dbc123686e074c4c3181e?s=128&d=identicon&r=PG&f=1", "display_name": "packetie", "link": "https://stackoverflow.com/users/3337677/packetie"}, "edited": false, "score": 0, "creation_date": 1425250863, "post_id": 28784016, "comment_id": 45874434, "body": "ok. @Not_a_Golfer, I will accept your answer as the best then.  Thanks."}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 4, "last_activity_date": 1425140918, "creation_date": 1425140918, "answer_id": 28784016, "question_id": 28783637, "link": "https://stackoverflow.com/questions/28783637/how-to-make-golang-execute-a-string/28784016#28784016", "title": "how to make golang execute a string", "body": "<p>AFAIK it cannot be done, and the go compiler has to write intermediate files, so even if you use <code>go run</code> and not <code>go build</code>, files are created for the sake of running the code, they are just cleaned up if necessary. So you can't run a go program without touching the disk, even if you manage to somehow make the compiler take the source not from a file.</p>\n\n<p>For example, running <code>strace</code> on calling <code>go run</code> on a simple hello world program, shows among other things, the following lines:</p>\n\n<pre><code>mkdir(\"/tmp/go-build167589894\", 0700) \n// ....\nmkdir(\"/tmp/go-build167589894/command-line-arguments/_obj/exe/\", 0777) \n// ... and at the end of things\nunlink(\"/tmp/go-build167589894/command-line-arguments/_obj/exe/foo\") \n// ^^^ my program was called foo.go\n// ....\n// and eventually:\nrmdir(\"/tmp/go-build167589894\")\n</code></pre>\n\n<p>So you can see that go run does a lot of disk writing behind the scenes, just cleans up afterwards.</p>\n\n<p>I suppose you can mount some tmpfs and build in it if you wish, but otherwise I don't believe it's possible.</p>\n"}, {"tags": [], "owner": {"reputation": 487, "user_id": 8623347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/QG7yn.jpg?s=128&g=1", "display_name": "user9123", "link": "https://stackoverflow.com/users/8623347/user9123"}, "is_accepted": false, "score": 2, "last_activity_date": 1588591249, "creation_date": 1588591249, "answer_id": 61591017, "question_id": 28783637, "link": "https://stackoverflow.com/questions/28783637/how-to-make-golang-execute-a-string/61591017#61591017", "title": "how to make golang execute a string", "body": "<p>I know that this question is (5 years) old but I wanted to say that actually, it is possible now, for anyone looking for an up-to-date answer.</p>\n\n<p>The Golang compiler is itself written in Go so can theoretically be embedded in a Go program. This would be quite complicated though.</p>\n\n<p>As a better alternative, there are projects like <a href=\"https://github.com/containous/yaegi\" rel=\"nofollow noreferrer\">yaegi</a> which are effectively a Go interpreter which can be embedded into Go programs.</p>\n"}], "owner": {"reputation": 4181, "user_id": 3337677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2a3cb5dc363dbc123686e074c4c3181e?s=128&d=identicon&r=PG&f=1", "display_name": "packetie", "link": "https://stackoverflow.com/users/3337677/packetie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2154, "favorite_count": 0, "accepted_answer_id": 28784016, "answer_count": 2, "score": 3, "last_activity_date": 1588591249, "creation_date": 1425138696, "last_edit_date": 1425224875, "question_id": 28783637, "link": "https://stackoverflow.com/questions/28783637/how-to-make-golang-execute-a-string", "title": "how to make golang execute a string", "body": "<p>I am not asking to make golang do some sort of \"eval\" in the current context, just need it to take a input string (say, received from network) and execute it as a separate golang program. </p>\n\n<p>In theory, when you run <code>go run testme.go</code>, it will read the content of <code>testme.go</code> into a string and parse, compile and execute it. Wonder if it is possible to call a go function to execute a string directly. Note that I have a requirement not to write the string into a file. </p>\n\n<p><strong>UPDATE1</strong></p>\n\n<p>I really want to find out if there is a function (in some go package) that serves as an entry point of go, in another word, I can call this function with a string as parameter, it will behave like <code>go run testme.go</code>, where testme.go has the content of that string.</p>\n"}, {"tags": ["go", "gorilla"], "answers": [{"comments": [{"owner": {"reputation": 823, "user_id": 1185305, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/540a599b52bb161062f4b0e2ce53c907?s=128&d=identicon&r=PG", "display_name": "user1185305", "link": "https://stackoverflow.com/users/1185305/user1185305"}, "edited": false, "score": 0, "creation_date": 1425139729, "post_id": 28783731, "comment_id": 45843863, "body": "How would I add this to my above code to make it work with my structure exactly ?"}, {"owner": {"reputation": 823, "user_id": 1185305, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/540a599b52bb161062f4b0e2ce53c907?s=128&d=identicon&r=PG", "display_name": "user1185305", "link": "https://stackoverflow.com/users/1185305/user1185305"}, "edited": false, "score": 0, "creation_date": 1425160580, "post_id": 28783731, "comment_id": 45850578, "body": "Thanks for the detailed instructions. Unfortunately I couldn&#39;t get that working either. Using your above code as it is. Is it possible to somehow debug to see why my CSS files are not loaded ?"}, {"owner": {"reputation": 823, "user_id": 1185305, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/540a599b52bb161062f4b0e2ce53c907?s=128&d=identicon&r=PG", "display_name": "user1185305", "link": "https://stackoverflow.com/users/1185305/user1185305"}, "edited": false, "score": 0, "creation_date": 1425166082, "post_id": 28783731, "comment_id": 45852147, "body": "I got it working with your above code example. Thank you so much :-)"}, {"owner": {"reputation": 823, "user_id": 1185305, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/540a599b52bb161062f4b0e2ce53c907?s=128&d=identicon&r=PG", "display_name": "user1185305", "link": "https://stackoverflow.com/users/1185305/user1185305"}, "edited": false, "score": 0, "creation_date": 1425246820, "post_id": 28783731, "comment_id": 45873247, "body": "I have a question regarding your code. If I want to place my index.html file, css and images folder inside a subfolder, lets call it MyLoginPage. Where in the code should I add that subfolder so my Go program can find the files ?"}], "tags": [], "owner": {"reputation": 20459, "user_id": 1120221, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0977d36f1cf30241c35121f1d741c8e9?s=128&d=identicon&r=PG&f=1", "display_name": "Salah Eddine Taouririt", "link": "https://stackoverflow.com/users/1120221/salah-eddine-taouririt"}, "is_accepted": true, "score": 4, "last_activity_date": 1425165763, "last_edit_date": 1425165763, "creation_date": 1425139262, "answer_id": 28783731, "question_id": 28783541, "link": "https://stackoverflow.com/questions/28783541/how-can-i-find-css-files-using-golang-gorilla-mux/28783731#28783731", "title": "How can I find CSS files using golang Gorilla mux", "body": "<p>You can use <a href=\"http://golang.org/pkg/net/http/#FileServer\" rel=\"nofollow\">http.FileServer</a> for serving all the static files independently of <code>gorilla/mux</code>.</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n\n    \"github.com/gorilla/mux\"\n)\n\nfunc HomeHandler(rw http.ResponseWriter, r *http.Request) {\n    http.ServeFile(rw, r, \"index.html\")\n}\n\nfunc main() {\n    r := mux.NewRouter()\n\n    cssHandler := http.FileServer(http.Dir(\"./css/\"))\n    imagesHandler := http.FileServer(http.Dir(\"./images/\"))\n\n    http.Handle(\"/css/\", http.StripPrefix(\"/css/\", cssHandler))\n    http.Handle(\"/images/\", http.StripPrefix(\"/images/\", imagesHandler))\n    r.HandleFunc(\"/\", HomeHandler)\n    http.Handle(\"/\", r)\n\n    log.Println(\"Server running on :8080\")\n    log.Fatal(http.ListenAndServe(\":8080\", nil))\n}\n</code></pre>\n"}], "owner": {"reputation": 823, "user_id": 1185305, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/540a599b52bb161062f4b0e2ce53c907?s=128&d=identicon&r=PG", "display_name": "user1185305", "link": "https://stackoverflow.com/users/1185305/user1185305"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2324, "favorite_count": 0, "accepted_answer_id": 28783731, "answer_count": 1, "score": 3, "last_activity_date": 1425165763, "creation_date": 1425138174, "last_edit_date": 1425138555, "question_id": 28783541, "link": "https://stackoverflow.com/questions/28783541/how-can-i-find-css-files-using-golang-gorilla-mux", "title": "How can I find CSS files using golang Gorilla mux", "body": "<p>I'm using Go with Gorilla Mux.</p>\n\n<p>This is my webserver.go file</p>\n\n<pre><code>package main\n\nimport (\n  \"log\"\n  \"net/http\"\n\n  \"github.com/gorilla/mux\"\n)\n\nfunc HomeHandler(rw http.ResponseWriter, r *http.Request) {\n  http.ServeFile(rw, r, \"index.html\")\n}\n\nfunc main() {\n  r := mux.NewRouter()\n  r.HandleFunc(\"/\", HomeHandler)\n\n  http.Handle(\"/\", r)\n\n  log.Println(\"Server running on :8080\")\n  err := http.ListenAndServe(\":8080\", r)\n  if err != nil {\n     log.Printf(\"Error: %s\\n\", err.Error())\n  }\n}\n</code></pre>\n\n<p>In the same folder where the webserver.go file is located is the index.html file.</p>\n\n<p>/  - here is the index.html</p>\n\n<p>/css - All the CSS files</p>\n\n<p>/images - All the images, resource files</p>\n\n<p>I manage to load the index.html file using the above code but it doesn't seem to load the CSS files and images.</p>\n\n<p>inside the index.html file I have.</p>\n\n<pre><code>&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"css/demo.css\" /&gt;\n&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"css/style.css\" /&gt;\n&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"css/animate-custom.css\" /&gt;\n</code></pre>\n\n<p>So it should find the css files or do I have to make sure that \"Go\" can find the css and image folder?\nHow?</p>\n"}, {"tags": ["go", "martini"], "answers": [{"tags": [], "owner": {"reputation": 956, "user_id": 1207791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f097e2409f02bfcaf6f53cfca268401f?s=128&d=identicon&r=PG", "display_name": "cfstras", "link": "https://stackoverflow.com/users/1207791/cfstras"}, "is_accepted": true, "score": 1, "last_activity_date": 1425138872, "creation_date": 1425138872, "answer_id": 28783668, "question_id": 28780565, "link": "https://stackoverflow.com/questions/28780565/martini-recover-for-any-panics/28783668#28783668", "title": "martini recover for any panics", "body": "<p>Middleware handlers in Martini do not get to \"wrap\" other handler calls, so http.Handler is not found by the injector.</p>\n\n<p>What you can do is use <a href=\"http://godoc.org/github.com/go-martini/martini#Context\" rel=\"nofollow\">context.Next()</a>:</p>\n\n<pre><code>package main\n\nimport (\n\"errors\"\n\"github.com/go-martini/martini\"\n\"net/http\"\n)\n\nfunc main() {\n    m := martini.Classic()\n    m.Use(RecoverWrap)\n    m.Get(\"/\", func() {\n        panic(\"some panic\")\n        })\n\n    m.Run()\n}\n\nfunc RecoverWrap(c martini.Context, w http.ResponseWriter) {\n    var err error\n    defer func(w http.ResponseWriter) {\n        r := recover()\n        if r != nil {\n            switch t := r.(type) {\n            case string:\n                err = errors.New(t)\n            case error:\n                err = t\n            default:\n                err = errors.New(\"Unknown error\")\n            }\n            http.Error(w, \"Something goes wrong\", http.StatusInternalServerError)\n        }\n        }(w)\n    c.Next()\n}\n</code></pre>\n\n<p>You will have to make sure that your error handler is the first middleware registered, or those handlers running before will not be caught.</p>\n\n<p>Actually, the same method is implemented in <a href=\"http://godoc.org/github.com/go-martini/martini#Recovery\" rel=\"nofollow\">martini.Recovery</a>:</p>\n\n<p><a href=\"https://github.com/go-martini/martini/blob/6241001738f6e1b1ea7c4a4089195e1b0681609a/recovery.go#L115\" rel=\"nofollow\">https://github.com/go-martini/martini/blob/6241001738f6e1b1ea7c4a4089195e1b0681609a/recovery.go#L115</a></p>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 28783668, "answer_count": 1, "score": 0, "last_activity_date": 1425138872, "creation_date": 1425118533, "question_id": 28780565, "link": "https://stackoverflow.com/questions/28780565/martini-recover-for-any-panics", "title": "martini recover for any panics", "body": "<p>I want to wire <code>RecoverWrap</code> to all handlers of martini routes to make any <code>panic</code> be finished by code inside <code>RecoverWrap</code>.</p>\n\n<p>I tried to do it like <code>m.Use(RecoverWrap)</code> but do not know how to do it exactly, it fails on compile.</p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"github.com/go-martini/martini\"\n    \"net/http\"\n)\n\nfunc main() {\n    m := martini.Classic()\n    //m.Use(RecoverWrap)\n    m.Get(\"/\", func() {\n        panic(\"some panic\")\n    })\n\n    m.Run()\n}\n\nfunc RecoverWrap(h http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, req *http.Request) {\n        var err error\n        defer func() {\n            r := recover()\n            if r != nil {\n                switch t := r.(type) {\n                case string:\n                    err = errors.New(t)\n                case error:\n                    err = t\n                default:\n                    err = errors.New(\"Unknown error\")\n                }\n\n                http.Error(w, \"Something goes wrong\", http.StatusInternalServerError)\n            }\n        }()\n        h.ServeHTTP(w, req)\n    })\n}\n</code></pre>\n"}, {"tags": ["memory", "memory-management", "go", "garbage-collection"], "answers": [{"comments": [{"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1425128759, "post_id": 28781913, "comment_id": 45840702, "body": "@OP - &quot;undergoing rework&quot; in this instance means that there are times where variables escape during escape analysis that shouldn&#39;t - and the Go team are aware of that. That means you&#39;re getting heap allocations when really you should be getting a stack allocation. There&#39;s a fascinating document on that somewhere (I can&#39;t seem to find it on go-dev at the moment). &quot;Escape analysis&quot; the term will be helpful for your research. Nice answer Volker :)"}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 9, "last_activity_date": 1425127971, "creation_date": 1425127971, "answer_id": 28781913, "question_id": 28780543, "link": "https://stackoverflow.com/questions/28780543/golang-zero-garbage-propagation-or-efficient-use-of-memory/28781913#28781913", "title": "Golang. Zero Garbage propagation or efficient use of memory", "body": "<p>The garbage collector doesn't allocate memory :-), it just deallocates. Go's garbage collector is evolving, for the details have a look at the design document <a href=\"https://docs.google.com/document/d/16Y4IsnNRCN43Mx0NZc5YXZLovrHvvLhK_h0KN8woTO4/preview?sle=true\">https://docs.google.com/document/d/16Y4IsnNRCN43Mx0NZc5YXZLovrHvvLhK_h0KN8woTO4/preview?sle=true</a> and follow the discussion on the golang mailing lists.</p>\n\n<p>The last two columns in the benchmark output are dead simple: How many bytes have been allocated in total and how many allocations have happened during one iteration of the benchmark code.  (This allocation is done by your code, not by the garbage collector). As any allocation is a potential creation of garbage reducing these numbers might be a design goal.</p>\n\n<p>When are things allocated on the heap? Whenever the Go compiler decides to! The compiler tries to allocate on the stack, but sometimes it must use the heap, especially if a value escapes from the local stack-bases scopes. This escape analysis is currently undergoing rework, so it is not easy to tell which value will be heap- or stack-allocated, especially as this is changing from compiler version to version.</p>\n\n<p>I wouldn't be too obsessed with avoiding allocations until your benchmarking show too much GC overhead.</p>\n"}], "owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1496, "favorite_count": 2, "accepted_answer_id": 28781913, "answer_count": 1, "score": 8, "last_activity_date": 1425151525, "creation_date": 1425118313, "last_edit_date": 1425151525, "question_id": 28780543, "link": "https://stackoverflow.com/questions/28780543/golang-zero-garbage-propagation-or-efficient-use-of-memory", "title": "Golang. Zero Garbage propagation or efficient use of memory", "body": "<p>From time to time I face with the concepts like <strong>zero garbage</strong> or efficient use of memory etc. As an example in the section Features of well-known package <a href=\"https://github.com/julienschmidt/httprouter\" rel=\"noreferrer\">httprouter</a> you can see the following:</p>\n\n<blockquote>\n  <p><strong>Zero Garbage:</strong> The matching and dispatching process generates zero bytes of garbage. In fact, the only heap allocations that are made, is by building the slice of the key-value pairs for path parameters. If the request path contains no parameters, not a single heap allocation is necessary.</p>\n</blockquote>\n\n<p>Also this package shows very good benchmark results compared to standard library's http.ServeMux:</p>\n\n<pre><code>BenchmarkHttpServeMux         5000     706222 ns/op          96 B/op        6 allocs/op\nBenchmarkHttpRouter         100000      15010 ns/op           0 B/op        0 allocs/op\n</code></pre>\n\n<p>As far as I understand the second one has (from the table) no heap memory allocation and zero average number of allocations made per repetition.</p>\n\n<p><strong>The question</strong>: I want to learn a basic understanding of memory management.  When garbage collector <del>allocates</del>/deallocates memory. What does the benchmark numbers means (the last two columns of the table) and how people know when heap is allocating?</p>\n\n<p>I'm absolutely new in memory management, so it's really difficult to understand what's going on \"under the hood\". The articles I've read:</p>\n\n<ul>\n<li><a href=\"https://golang.org/ref/mem\" rel=\"noreferrer\">https://golang.org/ref/mem</a></li>\n<li><a href=\"https://golang.org/doc/effective_go.html\" rel=\"noreferrer\">https://golang.org/doc/effective_go.html</a></li>\n<li><a href=\"http://gribblelab.org/CBootcamp/7_Memory_Stack_vs_Heap.html\" rel=\"noreferrer\">http://gribblelab.org/CBootcamp/7_Memory_Stack_vs_Heap.html</a></li>\n<li><a href=\"http://en.wikipedia.org/wiki/Garbage_collection_(computer_science)\" rel=\"noreferrer\">http://en.wikipedia.org/wiki/Garbage_collection_(computer_science)</a></li>\n</ul>\n"}, {"tags": ["excel", "go"], "answers": [{"comments": [{"owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 0, "creation_date": 1425232432, "post_id": 28780312, "comment_id": 45868314, "body": "You could also not use <code>range</code> here and instead do a normal for loop starting at the end and going forwards looking for the first non-empty row (this way you don&#39;t waste tons of time looking at already filled in rows)."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 3, "last_activity_date": 1425116686, "creation_date": 1425116686, "answer_id": 28780312, "question_id": 28779596, "link": "https://stackoverflow.com/questions/28779596/find-last-filled-row-in-excel-using-golang/28780312#28780312", "title": "Find last filled row in excel using Golang", "body": "<p>From the <a href=\"https://github.com/tealeg/xlsx#reading-xlsx-files\" rel=\"nofollow\">example of the README</a></p>\n\n<pre><code>for _, sheet := range xlFile.Sheets {\n    for _, row := range sheet.Rows {\n        for _, cell := range row.Cells {\n            fmt.Printf(\"%s\\n\", cell.String())\n        }\n    }\n}\n</code></pre>\n\n<p>Those _ are actually indexes for the loop, which are here ignored (hence the placeholder '<code>_</code>')</p>\n\n<p>But nothing prevents you to use those indexes for the row part of those loops:</p>\n\n<pre><code>for _, sheet := range xlFile.Sheets {\n    rmax := 0\n    for r, row := range sheet.Rows {\n        for _, cell := range row.Cells {\n            fmt.Printf(\"%s\\n\", cell.String())\n            // If at least one cell in this row is not empty,\n            // memorize current row index\n            if cell.String() != \"\" {\n                rmax = r\n            }\n        }\n    }\n    fmt.Printf(\"Last line: %d\\n\", rmax)\n}\n</code></pre>\n"}], "owner": {"reputation": 553, "user_id": 3551708, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/077ec64fb39a80e6bf84872bcc9f096e?s=128&d=identicon&r=PG&f=1", "display_name": "user3551708", "link": "https://stackoverflow.com/users/3551708/user3551708"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1389, "favorite_count": 2, "accepted_answer_id": 28780312, "answer_count": 1, "score": 1, "last_activity_date": 1425116686, "creation_date": 1425111238, "question_id": 28779596, "link": "https://stackoverflow.com/questions/28779596/find-last-filled-row-in-excel-using-golang", "title": "Find last filled row in excel using Golang", "body": "<p>I am looking for a way to get the last filled row in excel I.e</p>\n\n<pre><code>1. Lorem Ipsum\n2. qui dolorem ipsum\n .\n .\nnth.architecto beatae vitae &lt;- this is the last filled row, how do I get its\nnumber?\n</code></pre>\n\n<p>I am using the <a href=\"https://godoc.org/github.com/tealeg/xlsx\" rel=\"nofollow\">xlsx library</a> for this.</p>\n"}, {"tags": ["go", "certificate", "openshift-origin"], "answers": [{"comments": [{"owner": {"reputation": 1772, "user_id": 2904939, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pEOFP.png?s=128&g=1", "display_name": "James Fremen", "link": "https://stackoverflow.com/users/2904939/james-fremen"}, "edited": false, "score": 0, "creation_date": 1425186324, "post_id": 28786494, "comment_id": 45855902, "body": "Thanks! That fixes it."}], "tags": [], "owner": {"reputation": 194, "user_id": 4233608, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a11fa93ab5083fda91dc98704f728c93?s=128&d=identicon&r=PG", "display_name": "David Aiken", "link": "https://stackoverflow.com/users/4233608/david-aiken"}, "is_accepted": true, "score": 1, "last_activity_date": 1425155244, "creation_date": 1425155244, "answer_id": 28786494, "question_id": 28778558, "link": "https://stackoverflow.com/questions/28778558/openshift-m5-sample-app-self-signed-certificate-errors/28786494#28786494", "title": "openshift m5 sample-app self-signed certificate errors", "body": "<p>Had the same problem and taharqa on the #openshift-dev IRC had the answer. The problem is that optional step 1 in the directions has to be executed in the sample subdirectory but step 4 assumes that you are in the origin subdirectory. You have to execute the commands in the correct subdirectory or the certificates aren't located properly.</p>\n"}], "owner": {"reputation": 1772, "user_id": 2904939, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pEOFP.png?s=128&g=1", "display_name": "James Fremen", "link": "https://stackoverflow.com/users/2904939/james-fremen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 0, "accepted_answer_id": 28786494, "answer_count": 1, "score": 0, "last_activity_date": 1425155244, "creation_date": 1425102168, "last_edit_date": 1425149107, "question_id": 28778558, "link": "https://stackoverflow.com/questions/28778558/openshift-m5-sample-app-self-signed-certificate-errors", "title": "openshift m5 sample-app self-signed certificate errors", "body": "<p>I'm trying to follow the directions for the openshift 3 v0.3.3 sample-app on centos 6.6 as per <a href=\"https://github.com/openshift/origin/tree/v0.3.3\" rel=\"nofollow\">https://github.com/openshift/origin/tree/v0.3.3</a> . When i run </p>\n\n<pre><code>openshift ex policy add-user view anypassword:test-admin\n</code></pre>\n\n<p>i get complaints from add_user.go:43</p>\n\n<pre><code>Get https://localhost:8443/osapi/v1beta1/policyBindings/master?namespace=default: x509: certificate signed by unknown authority\n</code></pre>\n\n<p>I didn't know how to get around it so i commented out the Fatal() call. This allowed execution to continue and i can login to the web administrator console. The next step worked but then i hit </p>\n\n<pre><code>openshift ex registry --create --credentials=\"${KUBECONFIG}\"\n</code></pre>\n\n<p>which produces the error</p>\n\n<pre><code>registry.go:145] Can't check for existing docker-registry \"docker-registry\": Get https://localhost:8443/api/v1beta1/services/docker-registry?namespace=default: x509: certificate signed by unknown authority\n</code></pre>\n\n<p>There are LOTS of registry.go files in openshift and i don't like kludging through these errors in any case. Perhaps it's just a case of finding the right .pem file so i can follow this procedure: <a href=\"https://www.happyassassin.net/2015/01/14/trusting-additional-cas-in-fedora-rhel-centos-dont-append-to-etcpkitlscertsca-bundle-crt-or-etcpkitlscert-pem/\" rel=\"nofollow\">https://www.happyassassin.net/2015/01/14/trusting-additional-cas-in-fedora-rhel-centos-dont-append-to-etcpkitlscertsca-bundle-crt-or-etcpkitlscert-pem/</a>. Does anyone have experience with this?</p>\n\n<p>thanks!</p>\n"}, {"tags": ["c", "go"], "comments": [{"owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "edited": false, "score": 1, "creation_date": 1425111505, "post_id": 28778521, "comment_id": 45836489, "body": "What platform?  Unix, Windows or both?"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1425127932, "post_id": 28778521, "comment_id": 45840479, "body": "I think the problem passing pointers is more passing go managed memory to C.  If you are basically doing shm* functions (on linux), go&#39;s GC won&#39;t relocate that stuff since it not managed by the go runtime"}, {"owner": {"reputation": 4181, "user_id": 3337677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2a3cb5dc363dbc123686e074c4c3181e?s=128&d=identicon&r=PG&f=1", "display_name": "packetie", "link": "https://stackoverflow.com/users/3337677/packetie"}, "reply_to_user": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1425136249, "post_id": 28778521, "comment_id": 45842803, "body": "@DavidBudworth, if I call C routine in golang to get a pointer to the shared memory region,  can I use golang code to process the data pointed to? new to golang here, but I am excited about the great features that go has to offer."}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1425156922, "post_id": 28778521, "comment_id": 45849541, "body": "yes, we do this all the time, we have a C library that memmaps a shared file for us and hands us pointers, we just cast those pointers to a struct and it works.  Look at unsafe.Pointer, it is special and can be converted int o any type.  d := (*Quote)(vaddr) // from my code base, vaddr is: (unsafe.Pointer)(uintptr(raddr)) - hope that helps"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1425158922, "post_id": 28778521, "comment_id": 45850120, "body": "sorry, that was maybe a little too low level, if you have a C api that returns a pointer to a struct, you can use it just normal and it&#39;s fine.  The example i had there was from my project where the memory is a big chunk of shared ram and I compute record locations and cast the to type in go"}, {"owner": {"reputation": 4577, "user_id": 217965, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/2f56f147c441727ffd27a57d747f131c?s=128&d=identicon&r=PG", "display_name": "Drew", "link": "https://stackoverflow.com/users/217965/drew"}, "edited": false, "score": 0, "creation_date": 1437625033, "post_id": 28778521, "comment_id": 51110280, "body": "You can access C pointers just fine. Go may one day prevent the ability to pass Go pointers into C: <a href=\"https://github.com/golang/go/issues/8310\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/8310</a> but this will work just fine for the foreseeable future."}], "answers": [{"tags": [], "owner": {"reputation": 972, "user_id": 410496, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2860f84bcf050b1010a72cbda366ed32?s=128&d=identicon&r=PG", "display_name": "John Jeffery", "link": "https://stackoverflow.com/users/410496/john-jeffery"}, "is_accepted": false, "score": 0, "last_activity_date": 1460804391, "creation_date": 1460804391, "answer_id": 36663249, "question_id": 28778521, "link": "https://stackoverflow.com/questions/28778521/golang-support-for-shared-memory/36663249#36663249", "title": "golang support for shared memory", "body": "<p>I take it that you are referring to System V IPC shared memory. There is a good post in <a href=\"https://groups.google.com/forum/?fromgroups#!searchin/golang-nuts/posix$20semaphore/golang-nuts/zpwbWye5o7o/EuE-E6EhBAAJ\" rel=\"nofollow\">golang-nuts</a> about how to go about implementing System V IPC semaphores, and much of this would also apply to the shm system calls.</p>\n\n<p>You can use CGO, but it is generally better to write pure Go functions that call the UNIX system calls directly. The package at <a href=\"https://golang.org/x/sys/unix\" rel=\"nofollow\">golang.org/x/sys/unix</a> contains many good examples of how to invoke system calls from Go without having to involve CGO. (If you do go down this path, it would be a great idea to create a CL to update that package).</p>\n"}], "owner": {"reputation": 4181, "user_id": 3337677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2a3cb5dc363dbc123686e074c4c3181e?s=128&d=identicon&r=PG&f=1", "display_name": "packetie", "link": "https://stackoverflow.com/users/3337677/packetie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 7062, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1613304120, "creation_date": 1425101856, "last_edit_date": 1425138897, "question_id": 28778521, "link": "https://stackoverflow.com/questions/28778521/golang-support-for-shared-memory", "title": "golang support for shared memory", "body": "<p>I heard the slogan in golang about shared memory via communication, but here I have a need to write an application to interact with an existing application A using shared memory. Basically A writes a big chunk of data in memory (so big that it's inefficient to other other means of IPC), and wait for a program B to process it and report the result to A. </p>\n\n<p>Would like to write the program B using golang due to its scriptability and speed,   but don't see the direct support for shared memory. Thought of using C interface in golang but there is a problem with passing pointers between the two languages.</p>\n\n<p>Any ideas? Thanks!</p>\n\n<p><strong>UPDATE1</strong>: \n   Forgot to mention this is on Ubuntu 12.04. Thanks for asking.</p>\n\n<p><strong>UPDATE2</strong>:\n   Created a simple program to test the reading of data pointed to by C pointer. </p>\n\n<p>golang code called \"reader.go\"</p>\n\n<pre><code>import \"C\"\nimport \"unsafe\"\nimport \"fmt\"\n\nfunc read(filename string) string {\n    f := C.CString(filename)\n    defer C.free(unsafe.Pointer(f))\n    s := C.testc(f)\n    defer C.free(unsafe.Pointer(s))\n    return C.GoString(s)\n}\n\nfunc main() {\n    fmt.Println(read(\"tmp\"))\n}\n</code></pre>\n\n<p>C code called wrapper.c</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n\nchar buf[0x10000];\n\nchar* testc(char* filename){\n    printf(\"reading file %s\\n\", filename);\n    FILE *fp = fopen(filename, \"r\");\n    fread(buf, 1, 100, fp);\n    fclose(fp);\n    return buf;\n}\n</code></pre>\n\n<p>When running <code>go run reader.go</code>, got a stackdump on go (too long to include here). </p>\n\n<p><strong>UPDATE 3</strong>:</p>\n\n<p>Find the line that caused go to crash: <code>defer C.free(unsafe.Pointer(s))</code>\nWithout it, things works fine. </p>\n\n<p>Credit: the code snippet is adapted from <a href=\"https://gist.github.com/jedy/3282764\" rel=\"nofollow\">https://gist.github.com/jedy/3282764</a>. </p>\n"}, {"tags": ["reflection", "struct", "go"], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1425149181, "post_id": 28778228, "comment_id": 45847077, "body": "Or simplifying by just using <code>fmt.Sprint</code> (and supporting all types that can be &quot;stringified&quot;): <a href=\"http://play.golang.org/p/PKfcuGk-cO\" rel=\"nofollow noreferrer\">play.golang.org/p/PKfcuGk-cO</a>"}], "tags": [], "owner": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "is_accepted": true, "score": 1, "last_activity_date": 1425099241, "creation_date": 1425099241, "answer_id": 28778228, "question_id": 28778120, "link": "https://stackoverflow.com/questions/28778120/how-to-iterate-through-a-struct-in-go-with-reflect/28778228#28778228", "title": "How to iterate through a struct in go with reflect", "body": "<p>You shouldn't have a space between the colon and the value in the struct tags. <code>paramName:\"username\"</code> not <code>paramName: \"username\"</code>. Also, you're using the field name instead of the field value. In order to turn the value into a string you'll need something a bit more complex. Here is a complete example: <a href=\"http://play.golang.org/p/4hEQ4jgDph\" rel=\"nofollow\">http://play.golang.org/p/4hEQ4jgDph</a></p>\n"}], "owner": {"reputation": 6945, "user_id": 2288944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/7qryD.jpg?s=128&g=1", "display_name": "armnotstrong", "link": "https://stackoverflow.com/users/2288944/armnotstrong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 639, "favorite_count": 0, "accepted_answer_id": 28778228, "answer_count": 1, "score": 0, "last_activity_date": 1425099241, "creation_date": 1425097984, "question_id": 28778120, "link": "https://stackoverflow.com/questions/28778120/how-to-iterate-through-a-struct-in-go-with-reflect", "title": "How to iterate through a struct in go with reflect", "body": "<p>I have a specific struct that contains some url parameters, I want to build a url parameters string using reflect to iterate through the struct field, so that I wont care about what's the struct really contains.</p>\n\n<p>Let's say I have a struct like this:</p>\n\n<pre><code>type Student struct {\n   Name string `paramName: \"username\"`\n   Age int `paramName: userage`\n}\n</code></pre>\n\n<p>And I assign a student like this:</p>\n\n<pre><code>s := Student{\n  Name : \"Bob\",\n  Age : 15,\n}\n</code></pre>\n\n<p>I want to build a query parameter string like this for this student instance:</p>\n\n<pre><code>username=Bob&amp;userage=15\n</code></pre>\n\n<p>So far I have got:</p>\n\n<pre><code>func (s Student) buildParams() string {\n    st := reflect.TypeOf(s)\n    fieldCount := st.NumField()\n    params := \"\"\n    for i := fieldCount; i &gt; 0 ; i-- {\n      params = params +  \"&amp;\" + st.Field(i).Tag.Get(\"paramName\") + \"=\" + st.Field(i).Name\n    }\n    return params\n}\n</code></pre>\n\n<p>But <code>s.buildParams()</code> gets me nothing, not event the tag value of paramName in each field :-(</p>\n\n<p>So How can I do this?</p>\n"}, {"tags": ["go", "package"], "answers": [{"tags": [], "owner": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "is_accepted": true, "score": 4, "last_activity_date": 1425097892, "creation_date": 1425097892, "answer_id": 28778113, "question_id": 28778062, "link": "https://stackoverflow.com/questions/28778062/using-the-private-lowercase-functions-from-a-go-package/28778113#28778113", "title": "Using the private &quot;lowercase&quot; functions from a Go package", "body": "<p>You can't. That is a deliberate decision by the authors of blackfriday. Your only option is to define your own function which does the same thing. It's just like accessing a private member in a language like Java. </p>\n\n<p>See the spec here:\n<a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow\">https://golang.org/ref/spec#Exported_identifiers</a></p>\n"}], "owner": {"reputation": 47383, "user_id": 122536, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6fd51ed284bddf7eeab9de416359021e?s=128&d=identicon&r=PG", "display_name": "alexchenco", "link": "https://stackoverflow.com/users/122536/alexchenco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 28778113, "answer_count": 1, "score": -2, "last_activity_date": 1425097892, "creation_date": 1425097378, "question_id": 28778062, "link": "https://stackoverflow.com/questions/28778062/using-the-private-lowercase-functions-from-a-go-package", "title": "Using the private &quot;lowercase&quot; functions from a Go package", "body": "<p>I'm trying so use the following function in my <code>main</code> package:</p>\n\n<p><strong><a href=\"https://github.com/russross/blackfriday/blob/77efab57b2f74dd3f9051c79752b2e8995c8b789/html.go\" rel=\"nofollow\">html.go</a></strong> (from <a href=\"https://github.com/russross/blackfriday\" rel=\"nofollow\">blackfriday</a>):</p>\n\n<pre><code>func doubleSpace(out *bytes.Buffer) {\n    if out.Len() &gt; 0 {\n        out.WriteByte('\\n')\n    }\n}\n</code></pre>\n\n<p><strong>main.go:</strong></p>\n\n<pre><code>func (options *renderer) Paragraph(out *bytes.Buffer, text func() bool) {\n    marker := out.Len()\n    doubleSpace(out)\n\n    out.WriteString(\"&lt;p class='custom'&gt;\")\n    if !text() {\n        out.Truncate(marker)\n        return\n    }\n    out.WriteString(\"&lt;/p&gt;\\n\")\n}\n</code></pre>\n\n<p>I tried doing <code>blackfriday.doubleSpace</code> and <code>blackfriday.DoubleSpace</code> but in the three cases I get <code>undefined</code>.</p>\n\n<p>What's the correct way to do it?</p>\n"}, {"tags": ["go", "mux"], "answers": [{"comments": [{"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "edited": false, "score": 0, "creation_date": 1425100092, "post_id": 28778083, "comment_id": 45834309, "body": "<code>http.Handle(&quot;&#47;&quot;, commonHanlder(rtr))</code> gives error <code>cannot use rtr (type *mux.Router) as type gorelic.tHTTPHandlerFunc in argument to commonHanlder command </code>"}, {"owner": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "reply_to_user": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "edited": false, "score": 1, "creation_date": 1425188689, "post_id": 28778083, "comment_id": 45856306, "body": "Ah, yes. I overlooked that. Since rtr is not a function, but an http.Handler, you need to use agent.WrapHTTPHandler not agent.WrapHTTPHandlerFunc"}], "tags": [], "owner": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "is_accepted": true, "score": 1, "last_activity_date": 1425188641, "last_edit_date": 1425188641, "creation_date": 1425097640, "answer_id": 28778083, "question_id": 28777972, "link": "https://stackoverflow.com/questions/28777972/one-common-http-handler-instead-of-several/28778083#28778083", "title": "one common http handler instead of several", "body": "<p>It seems like you want to call commonHandler on the root of your application and have it work for all. Since you are using mux, just wrap the mux router once.</p>\n\n<pre><code>func main() {\n    initNewRelic()\n    rtr := mux.NewRouter()\n    var commonHandler = agent.WrapHTTPHandler\n\n    rtr.HandleFunc(\"/\", handler1).Methods(\"GET\")\n    rtr.HandleFunc(\"/page2\", handler2).Methods(\"GET\")\n\n    http.Handle(\"/\", commonHandler(rtr))\n    log.Println(\"Listening...\")\n    http.ListenAndServe(\":3000\", nil)\n}\n</code></pre>\n\n<p>I also removed the http.DefaultServeMux reference in ListenAndServe since passing nil will automatically use the default.</p>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 918, "favorite_count": 0, "accepted_answer_id": 28778083, "answer_count": 1, "score": 0, "last_activity_date": 1425188641, "creation_date": 1425096272, "question_id": 28777972, "link": "https://stackoverflow.com/questions/28777972/one-common-http-handler-instead-of-several", "title": "one common http handler instead of several", "body": "<p>Is it possible to not copy paste expression <code>commonHanlder(handler1)</code>, <code>commonHanlder(handler2)</code> ... <code>commonHanlder(handlerN)</code> in this code:</p>\n\n<pre><code>rtr.HandleFunc(\"/\", commonHanlder(handler1)).Methods(\"GET\")\nrtr.HandleFunc(\"/page2\", commonHanlder(handler2)).Methods(\"GET\")\n</code></pre>\n\n<p>and set it in one place like </p>\n\n<pre><code>http.ListenAndServe(\":3000\", commonHanlder(http.DefaultServeMux))\n</code></pre>\n\n<p>But this variant is not working and gives two errors on compile:</p>\n\n<pre><code>./goRelicAndMux.go:20: cannot use http.DefaultServeMux (type *http.ServeMux) as type gorelic.tHTTPHandlerFunc in argument to commonHanlder\n./goRelicAndMux.go:20: cannot use commonHanlder(http.DefaultServeMux) (type gorelic.tHTTPHandlerFunc) as type http.Handler in argument to http.ListenAndServe:\n    gorelic.tHTTPHandlerFunc does not implement http.Handler (missing ServeHTTP method)\n</code></pre>\n\n<p>The full code: </p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/gorilla/mux\"\n    \"github.com/yvasiyarov/gorelic\"\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n    initNewRelic()\n    rtr := mux.NewRouter()\n    var commonHanlder = agent.WrapHTTPHandlerFunc\n\n    rtr.HandleFunc(\"/\", commonHanlder(handler1)).Methods(\"GET\")\n    rtr.HandleFunc(\"/page2\", commonHanlder(handler2)).Methods(\"GET\")\n\n    http.Handle(\"/\", rtr)\n    log.Println(\"Listening...\")\n    http.ListenAndServe(\":3000\", http.DefaultServeMux)\n}\n\nfunc handler1(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(\"mainPage\"))\n}\n\nfunc handler2(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(\"page 2\"))\n}\n\nvar agent *gorelic.Agent\n\nfunc initNewRelic() {\n    agent = gorelic.NewAgent()\n    agent.Verbose = true\n    agent.NewrelicName = \"test\"\n    agent.NewrelicLicense = \"new relic key\"\n    agent.Run()\n}\n</code></pre>\n"}, {"tags": ["interface", "go"], "answers": [{"tags": [], "owner": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "is_accepted": false, "score": 2, "last_activity_date": 1425098392, "creation_date": 1425098392, "answer_id": 28778157, "question_id": 28777780, "link": "https://stackoverflow.com/questions/28777780/what-is-the-data-structure-to-be-able-to-contain-any-type-in-go/28778157#28778157", "title": "What is the data structure to be able to contain any type in go?", "body": "<p>Go does not support parametric polymorphism. What you're trying to do is only possible with reflection which will be much longer and more error prone than just using the _, ok := m[key] form. Usually you would write it like so:</p>\n\n<pre><code>if _, ok := m[key]; ok {\n    // do something conditionally.\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6849, "user_id": 1896761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e28ac3e5849a144937aa74efbc272e?s=128&d=identicon&r=PG", "display_name": "Austin Mullins", "link": "https://stackoverflow.com/users/1896761/austin-mullins"}, "is_accepted": true, "score": 2, "last_activity_date": 1425100022, "creation_date": 1425100022, "answer_id": 28778314, "question_id": 28777780, "link": "https://stackoverflow.com/questions/28777780/what-is-the-data-structure-to-be-able-to-contain-any-type-in-go/28778314#28778314", "title": "What is the data structure to be able to contain any type in go?", "body": "<p>It's true that <code>interface{}</code> is kind of like C's <code>void *</code>, but you can't implicitly convert a <code>map[string]string</code> into a <code>map[string]interface{}</code>. The key is to define your <code>map</code> objects at their declaration as <code>map[string]interface{}</code> objects. Unfortunately, you cannot assign new values to such a map, since Go can't know how much memory to allocate for each instance.</p>\n\n<pre><code>func main() {\n    one := map[string]interface{} {\n        \"A\": []string{\"a\", \"b\", \"c\"},\n    }\n    fmt.Println(map_exist(one, \"A\"))\n\n    two := map[string]interface{} {\n        \"B\": \"a\",\n    }\n    fmt.Println(map_exist(two, \"B\"))\n}\n</code></pre>\n\n<p>This works, but it probably isn't useful enough for your intended use case.</p>\n\n<p>Another approach is to define a generic map interface and make sure that the functions you intend to use are defined for the types you want to support. Basically, your goal is to build a library that's useful enough that you can reasonably offload the work of implementing your interface to the library's users. It would be nice if you could declare a default function or maybe just a macro to prevent the copy-paste, but I'm not aware of such a mechanism.</p>\n\n<p>Here's an example using an interface:</p>\n\n<pre><code>type GenericMap interface{\n    ValueForKey(string) (interface{}, bool)\n}\n\ntype SliceMap map[string][]string\ntype StringMap map[string]string\ntype VoidMap map[string]interface{}\n\nfunc map_exist(map_val GenericMap, key string) bool {\n    _, ok := map_val.ValueForKey(key)\n    return ok\n}\n\nfunc (map_val SliceMap) ValueForKey(key string) (interface{}, bool) {\n    val, ok := map_val[key]\n    return val, ok\n}\n\nfunc (map_val StringMap) ValueForKey(key string) (interface{}, bool) {\n    val, ok := map_val[key]\n    return val, ok\n}\n\nfunc (map_val VoidMap) ValueForKey(key string) (interface{}, bool) {\n    val, ok := map_val[key]\n    return val, ok\n}\n\nfunc main() {\n    one := SliceMap {\n        \"A\": []string{\"a\", \"b\", \"c\"},\n    }\n    fmt.Println(map_exist(GenericMap(one), \"A\"))\n\n    two := StringMap {\n        \"B\": \"a\",\n    }\n    fmt.Println(map_exist(GenericMap(two), \"B\"))\n}\n</code></pre>\n\n<p>In the end, Go programmers tend to prefer a simple, straight-forward solution over all this misdirection, so your best bet is to just use the construct proposed by @Logiraptor:</p>\n\n<pre><code>if _, ok := m[key]; ok {\n    // You're ok!\n}\n</code></pre>\n"}], "owner": {"reputation": 2099, "user_id": 1917479, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/daEaw.jpg?s=128&g=1", "display_name": "soapbar", "link": "https://stackoverflow.com/users/1917479/soapbar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1144, "favorite_count": 0, "accepted_answer_id": 28778314, "answer_count": 2, "score": 0, "last_activity_date": 1425100022, "creation_date": 1425094178, "last_edit_date": 1592644375, "question_id": 28777780, "link": "https://stackoverflow.com/questions/28777780/what-is-the-data-structure-to-be-able-to-contain-any-type-in-go", "title": "What is the data structure to be able to contain any type in go?", "body": "<p>Reference <a href=\"https://stackoverflow.com/questions/8996771/go-equivalent-of-a-void-pointer-in-c\">Go equivalent of a void pointer in C</a></p>\n<p>this is a demo.</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n)\n\nfunc map_exist(map_val map[string]interface{}, key string) bool {\n    _, ok := map_val[key]\n    return ok\n}\n\nfunc main() {\n    var one map[string][]string\n    one[&quot;A&quot;] = []string{&quot;a&quot;, &quot;b&quot;, &quot;c&quot;}\n    fmt.Println(map_exist(one, &quot;A&quot;))\n\n    var two map[string]string\n    two[&quot;B&quot;] = &quot;a&quot;\n    fmt.Println(map_exist(two, &quot;B&quot;))\n}\n</code></pre>\n<p>run result:</p>\n<blockquote>\n<p>./main.go:15: cannot use one (type map[string][]string) as type map[string]interface {} in argument to map_exist</p>\n<p>./main.go:19: cannot use two (type map[string]string) as type map[string]interface {} in argument to map_exist</p>\n</blockquote>\n<p>I can not find a data structure to be able to contain any type .</p>\n"}, {"tags": ["database", "google-app-engine", "go", "data-structures", "google-cloud-datastore"], "answers": [{"comments": [{"owner": {"reputation": 7245, "user_id": 953732, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f8115344be80362b14eb47e29c44c61e?s=128&d=identicon&r=PG", "display_name": "ThePiachu", "link": "https://stackoverflow.com/users/953732/thepiachu"}, "edited": false, "score": 2, "creation_date": 1425866283, "post_id": 28778137, "comment_id": 46124048, "body": "Hmm, I think this will still cause an issue when an old piece of data is loaded into a new structure - <code>datastore: cannot load field &quot;NotImportant&quot; into a &quot;Foo&quot;: no such struct field</code>"}, {"owner": {"reputation": 7245, "user_id": 953732, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f8115344be80362b14eb47e29c44c61e?s=128&d=identicon&r=PG", "display_name": "ThePiachu", "link": "https://stackoverflow.com/users/953732/thepiachu"}, "edited": false, "score": 0, "creation_date": 1426019455, "post_id": 28778137, "comment_id": 46198234, "body": "Hmm, would <code>omitempty</code> flag work instead, similarly to how <code>json</code> package does it?"}], "tags": [], "owner": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "is_accepted": false, "score": 3, "last_activity_date": 1425098171, "creation_date": 1425098171, "answer_id": 28778137, "question_id": 28777595, "link": "https://stackoverflow.com/questions/28777595/gae-go-datastore-ignoring-some-variables/28778137#28778137", "title": "GAE Go datastore - ignoring some variables?", "body": "<p>See here: <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference\" rel=\"nofollow\">https://cloud.google.com/appengine/docs/go/datastore/reference</a>\nSpecifically the section on Properties. </p>\n\n<pre><code>type Foo struct {\n    Important string\n    NotImportant string `datastore:\"-\"`\n}\n</code></pre>\n\n<p>That <code>datastore:\"-\"</code> bit is called a struct tag. They allow you to specify metadata about struct fields. A \"-\" means ignore this field. The Go spec discusses them here: <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow\">https://golang.org/ref/spec#Struct_types</a></p>\n\n<p>The encoding/json package (and many others) have similar tags.</p>\n"}, {"tags": [], "owner": {"reputation": 567, "user_id": 1420619, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/58949da6ec947c849f22e8b51fd0cfc8?s=128&d=identicon&r=PG", "display_name": "Marwan", "link": "https://stackoverflow.com/users/1420619/marwan"}, "is_accepted": false, "score": 7, "last_activity_date": 1498541077, "creation_date": 1498541077, "answer_id": 44772758, "question_id": 28777595, "link": "https://stackoverflow.com/questions/28777595/gae-go-datastore-ignoring-some-variables/44772758#44772758", "title": "GAE Go datastore - ignoring some variables?", "body": "<p>You could do that</p>\n\n<pre><code>if err != nil &amp;&amp; err != err.(*datastore.ErrFieldMismatch) {         \n}\n</code></pre>\n"}], "owner": {"reputation": 7245, "user_id": 953732, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f8115344be80362b14eb47e29c44c61e?s=128&d=identicon&r=PG", "display_name": "ThePiachu", "link": "https://stackoverflow.com/users/953732/thepiachu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1117, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1498541077, "creation_date": 1425092123, "last_edit_date": 1475295765, "question_id": 28777595, "link": "https://stackoverflow.com/questions/28777595/gae-go-datastore-ignoring-some-variables", "title": "GAE Go datastore - ignoring some variables?", "body": "<p>Say I start by saving this structure into datastore:</p>\n\n<pre><code>type Foo struct {\n    Important string\n    NotImportant string\n}\n</code></pre>\n\n<p>But later I decide that I don't really care for <code>NotImportant</code> anymore and would like to stop supporting it. The problem is, my datastore is already populated with data and I can't just drop it and replace the entire database with an updated structure. I know it is possible to create custom Load and Save methods like <code>Load(c &lt;-chan datastore.Property) error {</code>, but that would require a lot of effort on a large struct.</p>\n\n<p>Is there some easy way to tell Google App Engine Go datastore to ignore some variable when saving and not complain that the structure I'm loading the data into doesn't have the variable I don't care about any more?</p>\n"}, {"tags": ["go", "garbage-collection"], "answers": [{"tags": [], "owner": {"reputation": 628808, "user_id": 139985, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=128&d=identicon&r=PG", "display_name": "Stephen C", "link": "https://stackoverflow.com/users/139985/stephen-c"}, "is_accepted": true, "score": 2, "last_activity_date": 1425093435, "last_edit_date": 1592644375, "creation_date": 1425093119, "answer_id": 28777676, "question_id": 28777573, "link": "https://stackoverflow.com/questions/28777573/who-does-the-garbage-collection-work-in-go/28777676#28777676", "title": "Who does the garbage collection work in go?", "body": "<p>Many of your questions are answered here:</p>\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/7823725/what-kind-of-garbage-collection-does-go-use\">What kind of Garbage Collection does Go use?</a></li>\n</ul>\n<p>For the rest:</p>\n<blockquote>\n<p>But who does it?</p>\n</blockquote>\n<p>Native code runtime libraries provided by the Go implementation.</p>\n<p>(I haven't looked at the implementation, but it is hard to imagine that you could implement a high-performance GC for Go &quot;above the line&quot; in the Go language.)</p>\n<blockquote>\n<p>Go code will compile to native binary, right?</p>\n</blockquote>\n<p>Correct.  The Go FAQ says so clearly.</p>\n<blockquote>\n<p>So there will not be a virtual machine like Java which it could rely on.</p>\n</blockquote>\n<p>Correct.  However, that makes no difference.  In the Java case, the GC is also implemented by native code libraries provided by the Java runtime.</p>\n<blockquote>\n<p>So who does this dirty work for us? A cryptic thread? Or just a goroutine?</p>\n</blockquote>\n<p>Well from Go 1.1 onwards, the GC is parallel so there must be some kind of multi-threading going on behind the scenes.  Goroutines are a Go language concept, and it is hard to image that you would use them &quot;below the line&quot; in the native code GC implementation.  (But I could be wrong ...)</p>\n<p>But you also need to understand that goroutines also entail multiple threads under the hood.  The FAQ says:</p>\n<blockquote>\n<p><em>&quot;Why doesn't my multi-goroutine program use multiple CPUs?</em></p>\n<p><em>You must set the GOMAXPROCS shell environment variable or use the similarly-named function of the runtime package to allow the run-time support to utilize more than one OS thread.&quot;</em></p>\n</blockquote>\n<p>See?  Native / OS threads are involved under the hood.</p>\n"}], "owner": {"reputation": 6945, "user_id": 2288944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/7qryD.jpg?s=128&g=1", "display_name": "armnotstrong", "link": "https://stackoverflow.com/users/2288944/armnotstrong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1017, "favorite_count": 0, "accepted_answer_id": 28777676, "answer_count": 1, "score": 0, "last_activity_date": 1425093435, "creation_date": 1425091920, "question_id": 28777573, "link": "https://stackoverflow.com/questions/28777573/who-does-the-garbage-collection-work-in-go", "title": "Who does the garbage collection work in go?", "body": "<p>According to this <a href=\"http://golang.org/doc/faq#garbage_collection\" rel=\"nofollow\">specification</a>, there is a <strong>mark-and-sweep</strong> garbage collection mechanism behind go. But who does it? </p>\n\n<ul>\n<li><p>Go code will compile to native binary, right? So there will not be a virtual machine like Java which it could rely on. So who does this <em>dirty work</em> for us? A cryptic thread? Or just a goroutine?  </p></li>\n<li><p>Will the garbage collecting procedure <strong>stop-the-world</strong> like a full GC of Java? And could any one tell the difference of GC mechanisms between Java and Go? I could find rarely material on the net.</p></li>\n</ul>\n"}, {"tags": ["go", "socket.io"], "answers": [{"tags": [], "owner": {"reputation": 1972, "user_id": 2981535, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/qegDI.jpg?s=128&g=1", "display_name": "amahfouz", "link": "https://stackoverflow.com/users/2981535/amahfouz"}, "is_accepted": false, "score": 0, "last_activity_date": 1425089631, "creation_date": 1425089631, "answer_id": 28777334, "question_id": 28777285, "link": "https://stackoverflow.com/questions/28777285/count-number-of-sockets-in-room-with-golang-socketio-package/28777334#28777334", "title": "Count number of sockets in room with golang socketio package", "body": "<p>You basically can't. There is no method in the API that accepts a room and returns the number of sockets.</p>\n\n<p>Post a feature request on the <a href=\"https://github.com/googollee/go-socket.io\" rel=\"nofollow\">project github page</a>.</p>\n"}], "owner": {"reputation": 7466, "user_id": 288424, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cf91d37f026ddaccc28c9907b567ab13?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/288424/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 307, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1425089631, "creation_date": 1425089169, "last_edit_date": 1495541572, "question_id": 28777285, "link": "https://stackoverflow.com/questions/28777285/count-number-of-sockets-in-room-with-golang-socketio-package", "title": "Count number of sockets in room with golang socketio package", "body": "<p>How do you count the number of sockets in a room in Golang. With socketio in nodejs it <a href=\"https://stackoverflow.com/a/24425207/288424\">appears you can do this</a>:</p>\n\n<pre><code>io.of('/chat').sockets.length\n</code></pre>\n\n<p>How do you do the same with the <a href=\"http://godoc.org/github.com/googollee/go-socket.io\" rel=\"nofollow noreferrer\">socketio library</a> for Golang?</p>\n"}, {"tags": ["mongodb", "struct", "interface", "go", "mgo"], "comments": [{"owner": {"reputation": 103, "user_id": 3215881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e30480662e8bfc527fc7c806d9f0ed0?s=128&d=identicon&r=PG&f=1", "display_name": "UnNatural", "link": "https://stackoverflow.com/users/3215881/unnatural"}, "edited": false, "score": 0, "creation_date": 1453915317, "post_id": 28775929, "comment_id": 57812060, "body": "This link is a great solution to this problem <a href=\"http://stackoverflow.com/questions/26975880/convert-mapinterface-interface-to-mapstringstring?rq=1\" title=\"convert mapinterface interface to mapstringstring\">stackoverflow.com/questions/26975880/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 103, "user_id": 3215881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e30480662e8bfc527fc7c806d9f0ed0?s=128&d=identicon&r=PG&f=1", "display_name": "UnNatural", "link": "https://stackoverflow.com/users/3215881/unnatural"}, "is_accepted": true, "score": 0, "last_activity_date": 1426032611, "creation_date": 1426032611, "answer_id": 28976376, "question_id": 28775929, "link": "https://stackoverflow.com/questions/28775929/using-mgo-with-nested-documents-that-convert-to-mapstringinterface-how-to-i/28976376#28976376", "title": "Using mgo with nested documents that convert to map[string]interface{}. How to iterate through maps?", "body": "<p>After much research and forum searching I found an answer to the aforementioned problem.</p>\n\n<p>Since I knew some basic information about my structure, I knew there was a timestamp and that there was going to a sub-document related to the forecast key:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/gorilla/mux\"\n    \"gopkg.in/mgo.v2\"\n    \"gopkg.in/mgo.v2/bson\"\n    \"log\"\n    \"net/http\"\n    \"time\"\n)\n\nvar (\n    mgoSession *mgo.Session\n)\n\nfunc ConnectDb() {\n    if mgoSession == nil {\n        session, err := mgo.Dial(\"localhost\")\n        if err != nil {\n            log.Print(err)\n        }\n        session.SetMode(mgo.Monotonic, true)\n        mgoSession = session\n    }\n    return\n}\n\nfunc CloseDb() {\n    mgoSession.Close()\n    return\n}\n\ntype WeatherForecastData struct {\n    Timestamp time.Time                `json:\"timestamp,omitempty\" bson:\"date,omitempty\"`\n    Forecast  []map[string]interface{} `json:\"forecast\" bson:\"forecast\"`\n}\n\ntype WeatherFutureForecast struct {\n    Timestamp   time.Time `json:\"timestamp,omitempty\" bson:\"date,omitempty\"`\n    Temperature float64   `json:\"temperature\"`\n}\n\nfunc GetWeatherForecast(city string) []WeatherFutureForecast {\n    session := mgoSession.Clone()\n    defer session.Close()\n\n    collection := mgoSession.DB(\"db\").C(\"weather_forecast_io\")\n\n    var results WeatherForecastData\n    var forecastResults []WeatherFutureForecast\n\n    err := collection.Find(bson.M{\n        \"city\":       city,\n        \"forecast.1\": bson.M{\"$exists\": true},\n    }).Sort(\"-date\").One(&amp;results)\n    if err != nil {\n        log.Print(err)\n    } else {\n        for _, value := range results.Forecast {\n            if _, ok := value[\"date\"]; ok {\n                if _, ok2 := value[\"temp\"]; ok2 {\n                    date := value[\"date\"].(time.Time)\n                    temp := value[\"temp\"].(float64)\n                    day := WeatherFutureForecast{Timestamp: date, Temperature: temp}\n                    forecastResults = append(forecastResults, day)\n                }\n            }\n        }\n    }\n    return forecastResults\n}\n\nfunc main() {\n    ConnectDb()\n    defer CloseDb()\n    router := mux.NewRouter().StrictSlash(true)\n    router.HandleFunc(\"/weather/forecast/{city}\", WeatherForecast)\n    log.Fatal(http.ListenAndServe(\":8080\", router))\n}\n</code></pre>\n\n<p>Basically I used map[string]interface to solve the problem of my unknown forecast sub-document structure. From that I was then able to loop through and extract the necessary information.</p>\n"}], "owner": {"reputation": 103, "user_id": 3215881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e30480662e8bfc527fc7c806d9f0ed0?s=128&d=identicon&r=PG&f=1", "display_name": "UnNatural", "link": "https://stackoverflow.com/users/3215881/unnatural"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1998, "favorite_count": 0, "accepted_answer_id": 28976376, "answer_count": 1, "score": 1, "last_activity_date": 1426032611, "creation_date": 1425078714, "question_id": 28775929, "link": "https://stackoverflow.com/questions/28775929/using-mgo-with-nested-documents-that-convert-to-mapstringinterface-how-to-i", "title": "Using mgo with nested documents that convert to map[string]interface{}. How to iterate through maps?", "body": "<p>I have the following documents in a MongoDB database, but sometimes I don't know the structure for certain:</p>\n\n<pre><code>{\n    \"_id\" : ObjectId(\"54e58ea6128ae6385faa576e\"),\n    \"date\" : ISODate(\"2015-02-19T00:00:00.000Z\"),\n    \"lat\" : \"53.5558774\",\n    \"lng\" : \"-113.4939486\",\n    \"apparentTemp\" : -1.727777777777777,\n    \"timezone\" : \"America/Edmonton\",\n    \"humidity\" : 0.92,\n    \"city\" : \"Edmonton\",\n    \"dewPoint\" : 26.85,\n    \"temp\" : -1.727777777777777,\n    \"summary\" : \"Light Snow\",\n    \"gmt_offset\" : -7,\n    \"windSpeed\" : 0.13,\n    \"windBearing\" : 87,\n    \"precipIntensity\" : 0.0086,\n    \"precipProbability\" : 0.44,\n    \"forecast\" : [ \n        {\n            \"humidity\" : 0.86,\n            \"windSpeed\" : 0.86,\n            \"precipProbability\" : 0.83,\n            \"dewPoint\" : 28.26,\n            \"temp\" : -0.02777777777777817,\n            \"date\" : ISODate(\"2015-02-19T00:00:00.000Z\"),\n            \"windBearing\" : 63,\n            \"precipIntensity\" : 0.0528,\n            \"apparentTemp\" : -0.02777777777777817,\n            \"summary\" : \"Snow (Under 1 in.)\"\n        }\n    ]\n}\n</code></pre>\n\n<p>I have used the following code to query the database and am attempting to build an array of just the \"date\" and \"temp\" from forecast sub-document and have so far used the following code, but can't get to the point where I can query on the key to get the value:</p>\n\n<pre><code>var results bson.M\nerr2 := collection.Find(bson.M{\n    \"city\": vars[\"city\"],\n    \"forecast.1\": bson.M{\"$exists\": true},\n}).Sort(\"-date\").One(&amp;results)\nif err2 != nil {\n    log.Fatal(err2)\n}\n\nswitch reflect.TypeOf(results[\"forecast\"]).Kind() {\ncase reflect.Slice:\n    s := reflect.ValueOf(results[\"forecast\"])\n\n    for i := 0; i &lt; s.Len(); i++ {\n        hourly_temps := s.Index(i).Interface()\n        fmt.Fprintln(w, hourly_temps)\n    }\n}\n</code></pre>\n\n<p>The output I'm getting is:</p>\n\n<pre><code>map[humidity:0.86 temp:-.0277777777777817 windBearing:63 windSpeed:0.86        precipProbability:0.83 dewPoint:28.26 date:2015-02-19 00:00:00 -0700 MST precipIntensity:0.0528 apparentTemp:-0.02777777777777817 summary:Snow (Under 1 in.)]\n</code></pre>\n\n<p>I am fairly new to go and unsure of how to extract the value from date and temp. Any help would be greatly appreciated.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1418, "user_id": 112682, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d9b6ffb74650eeaa3bfc8d9aa3c3dd6e?s=128&d=identicon&r=PG", "display_name": "Kyle Krull", "link": "https://stackoverflow.com/users/112682/kyle-krull"}, "edited": false, "score": 0, "creation_date": 1521479517, "post_id": 28775878, "comment_id": 85738230, "body": "Why the downvotes for the question?  Are multiline struct literals not idiomatic in Go?"}, {"owner": {"reputation": 833, "user_id": 825489, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/27b4ce861fcad13f3a8b5a0e09a19277?s=128&d=identicon&r=PG", "display_name": "Bean Taxi", "link": "https://stackoverflow.com/users/825489/bean-taxi"}, "edited": false, "score": 0, "creation_date": 1529645305, "post_id": 28775878, "comment_id": 88957728, "body": "Maybe because neither the question title nor the question body mentions Go. Just a tag. (That&#39;s a sincere guess; I&#39;m not being sarcastic)"}], "answers": [{"comments": [{"owner": {"reputation": 2519, "user_id": 744228, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/643b3082c1d45dc0562ab95532f7d0ca?s=128&d=identicon&r=PG", "display_name": "Ray", "link": "https://stackoverflow.com/users/744228/ray"}, "edited": false, "score": 0, "creation_date": 1425078902, "post_id": 28775940, "comment_id": 45830024, "body": "Thanks, I tried it and thought it wasn&#39;t working, turns out this is the problem  I&#39;m really getting: <a href=\"https://stackoverflow.com/questions/14765395/why-am-i-seeing-zgotmplz-in-my-go-html-template-output\" title=\"why am i seeing zgotmplz in my go html template output\">stackoverflow.com/questions/14765395/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2656, "user_id": 942390, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e9b73c78dfba274d0c0548a9a02c1f68?s=128&d=identicon&r=PG&f=1", "display_name": "vvondra", "link": "https://stackoverflow.com/users/942390/vvondra"}, "is_accepted": true, "score": 9, "last_activity_date": 1425078777, "creation_date": 1425078777, "answer_id": 28775940, "question_id": 28775878, "link": "https://stackoverflow.com/questions/28775878/multiple-line-struct-definition/28775940#28775940", "title": "Multiple line struct definition", "body": "<p>You're just missing a comma after the second field:</p>\n\n<pre><code>template := Page{\n    Title: \"My Title\",\n    ContentPath: \"/some/file/path\",\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": false, "score": 18, "last_activity_date": 1425078783, "creation_date": 1425078783, "answer_id": 28775942, "question_id": 28775878, "link": "https://stackoverflow.com/questions/28775878/multiple-line-struct-definition/28775942#28775942", "title": "Multiple line struct definition", "body": "<p>You need to end <strong>all</strong> lines with a comma.</p>\n\n<p>This is because of how semicolons are auto-inserted.</p>\n\n<p><a href=\"http://golang.org/ref/spec#Semicolons\" rel=\"noreferrer\">http://golang.org/ref/spec#Semicolons</a></p>\n\n<p>Your current code ends up like</p>\n\n<pre><code>template := Page{\n    Title: \"My Title\",\n    ContentPath: \"/some/file/path\";\n};\n</code></pre>\n\n<p>Adding the comma gets rid of the incorrect semicolon, but also makes it easier to add new items in the future without having to remember to add the comma above.</p>\n"}], "owner": {"reputation": 2519, "user_id": 744228, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/643b3082c1d45dc0562ab95532f7d0ca?s=128&d=identicon&r=PG", "display_name": "Ray", "link": "https://stackoverflow.com/users/744228/ray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3505, "favorite_count": 0, "accepted_answer_id": 28775940, "answer_count": 2, "score": 9, "last_activity_date": 1425078783, "creation_date": 1425078477, "question_id": 28775878, "link": "https://stackoverflow.com/questions/28775878/multiple-line-struct-definition", "title": "Multiple line struct definition", "body": "<p>How do I define a struct using more than 1 line?</p>\n\n<pre><code>type Page struct {\n    Title string\n    ContentPath string\n}\n\n//this is giving me a syntax error\ntemplate := Page{\n    Title: \"My Title\",\n    ContentPath: \"/some/file/path\"\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1425076872, "post_id": 28775485, "comment_id": 45829318, "body": "Do you just want to print it to inspect the data within?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1425076969, "post_id": 28775485, "comment_id": 45829364, "body": "Have you tried the various outputs provided by the <code>fmt</code> package? Does Marshaling to json work for you?"}, {"owner": {"reputation": 14101, "user_id": 139117, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f327e79d803f7372c952f0023983195d?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad the Impala", "link": "https://stackoverflow.com/users/139117/vlad-the-impala"}, "reply_to_user": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1425078469, "post_id": 28775485, "comment_id": 45829876, "body": "@sberry I don&#39;t want to inspect the data within, I just want to compare the values of two arbitrary json hashes and print out the intersection."}, {"owner": {"reputation": 14101, "user_id": 139117, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f327e79d803f7372c952f0023983195d?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad the Impala", "link": "https://stackoverflow.com/users/139117/vlad-the-impala"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1425078511, "post_id": 28775485, "comment_id": 45829893, "body": "@JimB yup, I am marshalling from json to this format, because the data is arbitrary."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1425084211, "post_id": 28775485, "comment_id": 45831491, "body": "@VladtheImpala your comment and the question don&#39;t match"}, {"owner": {"reputation": 1267, "user_id": 1598790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a11ea12f06eefbb34068f4c1090e2e0b?s=128&d=identicon&r=PG", "display_name": "ramrunner", "link": "https://stackoverflow.com/users/1598790/ramrunner"}, "edited": false, "score": 0, "creation_date": 1425101658, "post_id": 28775485, "comment_id": 45834613, "body": "i don&#39;t really know the specifics of the problem you&#39;re trying to solve, and i might be wrong, but usually having to use reflection is a sign of bad design. I really believe that you should implement the proper interface functions on your types (like String()) and then sure, if at some point you are forced to use an interface{} receiver for them, do it, but having concrete implementation on the types will produce the intented behaviour on each in stuff like printing etc."}], "answers": [{"comments": [{"owner": {"reputation": 14101, "user_id": 139117, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f327e79d803f7372c952f0023983195d?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad the Impala", "link": "https://stackoverflow.com/users/139117/vlad-the-impala"}, "edited": false, "score": 0, "creation_date": 1425080594, "post_id": 28776203, "comment_id": 45830528, "body": "thank you, the key turned out to be <code>reflect.TypeOf(value).Kind() == reflect.Map</code>."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 14101, "user_id": 139117, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f327e79d803f7372c952f0023983195d?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad the Impala", "link": "https://stackoverflow.com/users/139117/vlad-the-impala"}, "edited": false, "score": 0, "creation_date": 1429171723, "post_id": 28776203, "comment_id": 47476074, "body": "@VladtheImpala Note: printing a Reflect.Value() will be easier with Go 1.5. See <a href=\"http://stackoverflow.com/a/29668359/6309\">stackoverflow.com/a/29668359/6309</a>."}, {"owner": {"reputation": 621, "user_id": 5838252, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/41ecb1f8a19f1718311e3c7954920a86?s=128&d=identicon&r=PG&f=1", "display_name": "Bat", "link": "https://stackoverflow.com/users/5838252/bat"}, "edited": false, "score": 0, "creation_date": 1590612284, "post_id": 28776203, "comment_id": 109749446, "body": "Can you point out how it should be used? When I use the <code>InspectStruct(myMap, 1)</code> it gives me the error <code>reflect.Value.NumField on map Value</code>"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "reply_to_user": {"reputation": 621, "user_id": 5838252, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/41ecb1f8a19f1718311e3c7954920a86?s=128&d=identicon&r=PG&f=1", "display_name": "Bat", "link": "https://stackoverflow.com/users/5838252/bat"}, "edited": false, "score": 0, "creation_date": 1590656402, "post_id": 28776203, "comment_id": 109763606, "body": "@bat it should be used like that, but it is not 100% failsave. I have had to disable some lines from time to time to make this work for particular payloads."}], "tags": [], "owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "is_accepted": true, "score": 1, "last_activity_date": 1425080479, "creation_date": 1425080479, "answer_id": 28776203, "question_id": 28775485, "link": "https://stackoverflow.com/questions/28775485/print-all-values-in-map-recursively-in-go/28776203#28776203", "title": "Print all values in map recursively in Go", "body": "<p>I shamelessly ripped this from a site some time ago:</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"reflect\"\n    \"strings\"\n)\n\n/*\nInspectStruct prints the guts of an instantiated struct. Very handy for debugging\nusage: InspectStruct(req, 0) -&gt; prints all children\n*/\n\nfunc InspectStructV(val reflect.Value, level int) {\n    if val.Kind() == reflect.Interface &amp;&amp; !val.IsNil() {\n        elm := val.Elem()\n        if elm.Kind() == reflect.Ptr &amp;&amp; !elm.IsNil() &amp;&amp; elm.Elem().Kind() == reflect.Ptr {\n            val = elm\n        }\n    }\n    if val.Kind() == reflect.Ptr {\n        val = val.Elem()\n    }\n\n    for i := 0; i &lt; val.NumField(); i++ {\n        valueField := val.Field(i)\n        typeField := val.Type().Field(i)\n        address := \"not-addressable\"\n\n        if valueField.Kind() == reflect.Interface &amp;&amp; !valueField.IsNil() {\n            elm := valueField.Elem()\n            if elm.Kind() == reflect.Ptr &amp;&amp; !elm.IsNil() &amp;&amp; elm.Elem().Kind() == reflect.Ptr {\n                valueField = elm\n            }\n        }\n\n        if valueField.Kind() == reflect.Ptr {\n            valueField = valueField.Elem()\n\n        }\n        if valueField.CanAddr() {\n            address = fmt.Sprintf(\"0x%X\", valueField.Addr().Pointer())\n        }\n\n        fmt.Printf(\"%vField Name: %s,\\t Field Value: %v,\\t Address: %v\\t, Field type: %v\\t, Field kind: %v\\n\",\n            strings.Repeat(\"\\t\", level),\n            typeField.Name,\n            //valueField.Interface(),\n            address,\n            typeField.Type,\n            valueField.Kind())\n\n        if valueField.Kind() == reflect.Struct {\n            InspectStructV(valueField, level+1)\n        }\n    }\n}\n\nfunc InspectStruct(v interface{}, level int) {\n    InspectStructV(reflect.ValueOf(v), level)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1267, "user_id": 1598790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a11ea12f06eefbb34068f4c1090e2e0b?s=128&d=identicon&r=PG", "display_name": "ramrunner", "link": "https://stackoverflow.com/users/1598790/ramrunner"}, "is_accepted": false, "score": 0, "last_activity_date": 1425081426, "creation_date": 1425081426, "answer_id": 28776346, "question_id": 28775485, "link": "https://stackoverflow.com/questions/28775485/print-all-values-in-map-recursively-in-go/28776346#28776346", "title": "Print all values in map recursively in Go", "body": "<p>Using %v on fmt.Printf will traverse the inner maps and print the elements\ntoo by calling String() on each. Now if you want to change this default printing on an inner type you just have to implement String() on that type. in the following example i created a version of []int that prints one int per line.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\ntype OnePerLineInt []int\n\nfunc (ip OnePerLineInt) String() string {\n    var ret []string\n    for _, a := range ip {\n        ret = append(ret, fmt.Sprintf(\"Item: %v\\n\", a))\n    }\n    return strings.Join(ret, \"\")\n}\n\nfunc main() {\n    arr := &amp;OnePerLineInt{1, 2, 3}\n    arr1 := []int{4, 5 , 6}\n    foo := make(map[string]interface{})\n    bar := make(map[string]interface{})\n    bar[\"a\"] = \"foobar1\"\n    bar[\"b\"] = \"foobar2\"\n    foo[\"1\"] = arr\n    foo[\"2\"] = bar\n    foo[\"3\"] = arr1\n    fmt.Printf(\"foo contents: %v\\n\", foo)\n    fmt.Printf(\"bar is :%v\\n\", bar)\n}\n</code></pre>\n\n<p>prints:</p>\n\n<pre><code>foo contents: map[1:Item: 1\nItem: 2\nItem: 3\n2:map[a:foobar1 b:foobar2] 3:[4 5 6]]\nbar is :map[a:foobar1 b:foobar2]\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/kc6xm7dHwx\" rel=\"nofollow\">http://play.golang.org/p/kc6xm7dHwx</a></p>\n"}], "owner": {"reputation": 14101, "user_id": 139117, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f327e79d803f7372c952f0023983195d?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad the Impala", "link": "https://stackoverflow.com/users/139117/vlad-the-impala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4958, "favorite_count": 2, "accepted_answer_id": 28776203, "answer_count": 2, "score": 2, "last_activity_date": 1425081426, "creation_date": 1425076343, "question_id": 28775485, "link": "https://stackoverflow.com/questions/28775485/print-all-values-in-map-recursively-in-go", "title": "Print all values in map recursively in Go", "body": "<p>Suppose I have a map of this type:</p>\n\n<pre><code>var results map[string]interface{}\n</code></pre>\n\n<p>The values can be anything, even another map. How would I print all the values? If the value is an array, I want to print each item in the array individually. If it is another map, I want to recursively call the same function on the map.</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore", "nosql"], "answers": [{"comments": [{"owner": {"reputation": 2679, "user_id": 3081480, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UVerL.jpg?s=128&g=1", "display_name": "Kyle Chadha", "link": "https://stackoverflow.com/users/3081480/kyle-chadha"}, "edited": false, "score": 0, "creation_date": 1425074949, "post_id": 28775147, "comment_id": 45828570, "body": "If I create users with the above methods, don&#39;t they share the same ancestor? The way it works in the application is: as users customize items, each change prompts a put to save their changes, and happening across the expected volume of users I would realistically see a few hundred puts per second. Still no issue?"}, {"owner": {"reputation": 6412, "user_id": 272372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLzr8.png?s=128&g=1", "display_name": "Hanuman", "link": "https://stackoverflow.com/users/272372/hanuman"}, "reply_to_user": {"reputation": 2679, "user_id": 3081480, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UVerL.jpg?s=128&g=1", "display_name": "Kyle Chadha", "link": "https://stackoverflow.com/users/3081480/kyle-chadha"}, "edited": false, "score": 0, "creation_date": 1425075922, "post_id": 28775147, "comment_id": 45828946, "body": "Oh I see now... and have you tried this live? I wouldn&#39;t recommend this architecture, sharing a common ancestor at a root level is difficult to scale, and even if the datastore is making its best effort, and succeeding in this case, there are no guarantees this will keep up in the future."}, {"owner": {"reputation": 2679, "user_id": 3081480, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UVerL.jpg?s=128&g=1", "display_name": "Kyle Chadha", "link": "https://stackoverflow.com/users/3081480/kyle-chadha"}, "edited": false, "score": 0, "creation_date": 1425076460, "post_id": 28775147, "comment_id": 45829163, "body": "I tried this in a deployed app, yes. Okay -- that makes sense, so to confirm I&#39;m not missing anything, and this architecture should fail. The solution, then, is to remove the parent key &#39;usersKey(c)&#39; and not specify any ancestor?"}, {"owner": {"reputation": 6412, "user_id": 272372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLzr8.png?s=128&g=1", "display_name": "Hanuman", "link": "https://stackoverflow.com/users/272372/hanuman"}, "reply_to_user": {"reputation": 2679, "user_id": 3081480, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UVerL.jpg?s=128&g=1", "display_name": "Kyle Chadha", "link": "https://stackoverflow.com/users/3081480/kyle-chadha"}, "edited": false, "score": 0, "creation_date": 1425078897, "post_id": 28775147, "comment_id": 45830022, "body": "Yes, without common ancestors you&#39;ll be able to handle any load under your current scheme :)"}], "tags": [], "owner": {"reputation": 6412, "user_id": 272372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLzr8.png?s=128&g=1", "display_name": "Hanuman", "link": "https://stackoverflow.com/users/272372/hanuman"}, "is_accepted": true, "score": 3, "last_activity_date": 1425074690, "creation_date": 1425074690, "answer_id": 28775147, "question_id": 28774980, "link": "https://stackoverflow.com/questions/28774980/google-datastore-not-seeing-1-write-per-second-per-entity-group-limitation/28775147#28775147", "title": "Google Datastore - Not Seeing 1 Write per Second per Entity Group Limitation", "body": "<p>The limitation is per entity group, that means you could create as many users as you need without limitation (that's where scaling shines), as long as they don't share the same ancestor.</p>\n\n<p>Things change once you start using the user key as the ancestor of other entities, making them part of the same group and thus having a limit on how many changes you can make to it per second.</p>\n\n<p>Btw this is a generalization, most likely you will be able to make ~5 changes per second, this limitation exist because of the transactional properties of an entity group, so there's some kind of table with changes that must be executed sequentially, so you have to lock, and thus there's limited throughput.</p>\n\n<p>Still, rule of thumb is thinking you can only do 1 per second to force yourself think about how to work under this conditions.</p>\n\n<p>And like mentioned, this is only relevant when you update the database, gets and queries should scale as needed.</p>\n"}, {"comments": [{"owner": {"reputation": 2679, "user_id": 3081480, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UVerL.jpg?s=128&g=1", "display_name": "Kyle Chadha", "link": "https://stackoverflow.com/users/3081480/kyle-chadha"}, "edited": false, "score": 0, "creation_date": 1425075801, "post_id": 28775150, "comment_id": 45828895, "body": "So are you saying the threshold of 25 at once is too low? Others say even 10 is too high. I would expect a few hundred per second constantly."}, {"owner": {"reputation": 38473, "user_id": 821657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qDRGg.png?s=128&g=1", "display_name": "Andrei Volgin", "link": "https://stackoverflow.com/users/821657/andrei-volgin"}, "reply_to_user": {"reputation": 2679, "user_id": 3081480, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UVerL.jpg?s=128&g=1", "display_name": "Kyle Chadha", "link": "https://stackoverflow.com/users/3081480/kyle-chadha"}, "edited": false, "score": 0, "creation_date": 1425078963, "post_id": 28775150, "comment_id": 45830044, "body": "Even 5 per second is too high if it happens often or lasts for more than a few seconds. Also, entity groups are very inflexible. You should use them only when you have to (e.g. transactions) or when child entities are updated infrequently (e.g. address entity as a child to a user entity). I definitely see no reason to have all users in the same entity group."}], "tags": [], "owner": {"reputation": 38473, "user_id": 821657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qDRGg.png?s=128&g=1", "display_name": "Andrei Volgin", "link": "https://stackoverflow.com/users/821657/andrei-volgin"}, "is_accepted": false, "score": 4, "last_activity_date": 1425074702, "creation_date": 1425074702, "answer_id": 28775150, "question_id": 28774980, "link": "https://stackoverflow.com/questions/28774980/google-datastore-not-seeing-1-write-per-second-per-entity-group-limitation/28775150#28775150", "title": "Google Datastore - Not Seeing 1 Write per Second per Entity Group Limitation", "body": "<p>From the documentation:</p>\n\n<blockquote>\n  <p>Writes to a single entity group are serialized by the App Engine\n  datastore, and thus there's a limit on how quickly you can update one\n  entity group. In general, this works out to somewhere between 1 and 5\n  updates per second; a good guideline is that you should consider\n  rearchitecting if you expect an entity group to have to sustain more\n  than one update per second for an extended period.</p>\n</blockquote>\n\n<p>Note the words \"extended period\". 1 update per second is basically a minimum guaranteed throughput. At any given moment you may be able to achieve a significantly higher levels, but Google is warning you not to architect for those levels to be always available.</p>\n"}, {"tags": [], "owner": {"reputation": 11357, "user_id": 584846, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/uD1uQ.jpg?s=128&g=1", "display_name": "Brent Washburne", "link": "https://stackoverflow.com/users/584846/brent-washburne"}, "is_accepted": false, "score": 1, "last_activity_date": 1430520559, "last_edit_date": 1430520559, "creation_date": 1425101634, "answer_id": 28778497, "question_id": 28774980, "link": "https://stackoverflow.com/questions/28774980/google-datastore-not-seeing-1-write-per-second-per-entity-group-limitation/28778497#28778497", "title": "Google Datastore - Not Seeing 1 Write per Second per Entity Group Limitation", "body": "<p>I don't think you're missing anything here.  Previously, I had seen the same limitations when writing to the same entity group but recently (this week, in fact) I have not seen the delays.  I'm willing to suggest that Google has solved this problem, and I'm hoping that someone will prove me correct.</p>\n"}], "owner": {"reputation": 2679, "user_id": 3081480, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UVerL.jpg?s=128&g=1", "display_name": "Kyle Chadha", "link": "https://stackoverflow.com/users/3081480/kyle-chadha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 494, "favorite_count": 0, "accepted_answer_id": 28775147, "answer_count": 3, "score": 2, "last_activity_date": 1505741123, "creation_date": 1425073999, "last_edit_date": 1506103282, "question_id": 28774980, "link": "https://stackoverflow.com/questions/28774980/google-datastore-not-seeing-1-write-per-second-per-entity-group-limitation", "title": "Google Datastore - Not Seeing 1 Write per Second per Entity Group Limitation", "body": "<p>I've read a lot about strong vs eventual consistency, using ancestor / entity groups, and the 1 write per second per entity group limitation of Google Datastore.</p>\n\n<p>However, in my testing I have never hit the exception <code>Too much contention on these datastore entities. please try again.</code> <strong>and am trying to understand whether I'm misunderstanding these concepts or missing a piece of the puzzle.</strong></p>\n\n<p>I'm creating entities like so:</p>\n\n<pre><code>func usersKey(c appengine.Context) *datastore.Key {\n    return datastore.NewKey(c, \"User\", \"default_users\", 0, nil)\n}\n\nfunc (a *UserDS) UserCreateOrUpdate(c appengine.Context, user models.User) error {\n\n    key := datastore.NewKey(c, \"User\", user.UserId, 0, usersKey(c))\n    _, err := datastore.Put(c, key, &amp;user)\n\n    return err\n}\n</code></pre>\n\n<p>And then reading them with <code>datastore.Get</code>. I know I won't have issues reading since I'm doing a lookup by key, but if I have a high volume of users creating and updating their information, I would theoretically hit the max of 1 write per second constantly.</p>\n\n<p><strong>To test this, I attempted to create 25 users at once (using the above methods, no batching), yet I don't log any exceptions</strong>, which this post implies I should: <a href=\"https://stackoverflow.com/questions/10454467/google-app-engine-hrd-what-if-i-exceed-the-1-write-per-second-limit-for-writin\">Google App Engine HRD - what if I exceed the 1 write per second limit for writing to the entity group?</a></p>\n\n<p>What am I missing? Does the contention only apply to querying, is 25 not a high enough volume, or am I missing something else entirely?</p>\n"}, {"tags": ["go", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 230, "user_id": 2152105, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5YGz.jpg?s=128&g=1", "display_name": "Jaemin Park", "link": "https://stackoverflow.com/users/2152105/jaemin-park"}, "is_accepted": false, "score": 0, "last_activity_date": 1425094411, "creation_date": 1425094411, "answer_id": 28777806, "question_id": 28774705, "link": "https://stackoverflow.com/questions/28774705/partial-updates-using-nested-structs-with-go-mgo/28777806#28777806", "title": "Partial updates using nested structs with go/mgo", "body": "<p>It's the problem in the <code>setAValue</code> you commit type A, not B. Newly committed BSON value not containing <code>B_value</code>.</p>\n\n<p>I think you should separate set function and commit function. You may solve this set-and-commit problem via reflection or interface, but just splitting functionality is more simpler.</p>\n"}], "owner": {"reputation": 15505, "user_id": 857238, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e7efe5b6a2b92bb52c23a639b88b544c?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/857238/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 500, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1425094411, "creation_date": 1425072900, "question_id": 28774705, "link": "https://stackoverflow.com/questions/28774705/partial-updates-using-nested-structs-with-go-mgo", "title": "Partial updates using nested structs with go/mgo", "body": "<p>I'm trying to maximize code reuse across objects that share data by using nested structs. Consider the following code:</p>\n\n<pre><code>package main\n\nimport (\n    \"gopkg.in/mgo.v2\"\n    \"gopkg.in/mgo.v2/bson\"\n)\n\nvar collection *mgo.Collection\n\ntype Identifiable interface {\n    GetId() bson.ObjectId\n}\n\ntype A struct {\n    Id bson.ObjectId `bson:\"_id\"`\n    A_value int\n}\n\ntype B struct {\n    A `bson:\",inline\"`\n    B_value int\n}\n\nfunc (self *A) GetId() bson.ObjectId {\n    return self.Id\n}\n\nfunc setAValue(value int, a *A) {\n    a.A_value = value\n    commit(a)\n}\n\nfunc commit(i Identifiable) {\n    collection.UpsertId(i.GetId(), i)\n}\n\nfunc main() {\n    session, _ := mgo.Dial(\"localhost\")\n    collection = session.DB(\"test\").C(\"my_collection\")\n\n    b := B{A: A{Id: bson.NewObjectId(), A_value: 1}, B_value: 2}\n    commit(&amp;b)\n}\n</code></pre>\n\n<p>At this point, the record in mongo looks like this (as I expect):</p>\n\n<blockquote>\n  <p>{ \"_id\" : ObjectId(\"54f0e231eefbfe049c000001\"), \"a_value\" : 1, \"b_value\" : 2 }</p>\n</blockquote>\n\n<p>But then I would like to do something like this in order to avoid having to write redundant functions:</p>\n\n<pre><code>setAValue(42, &amp;b.A)\n</code></pre>\n\n<p>The problem is that this results in data loss as it replaces the whole entry instead of just updating it:</p>\n\n<blockquote>\n  <p>{ \"_id\" : ObjectId(\"54f0df4eeefbfe0474000001\"), \"a_value\" : 42 }</p>\n</blockquote>\n\n<p>Is there a way to perform an update like this without it blowing away any values that don't belong to <code>A</code>? Or am I just going about this the wrong way entirely?</p>\n"}, {"tags": ["go", "set", "intersection"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1425072822, "post_id": 28774572, "comment_id": 45827594, "body": "You&#39;re comparing 2 slices, to a slice and a map. They&#39;re not really comparable, and the result will vary depending on the number of elements. You&#39;re also not finding an intersection, just returning true if there is a single match."}, {"owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "edited": false, "score": 1, "creation_date": 1425072998, "post_id": 28774572, "comment_id": 45827691, "body": "<a href=\"http://stackoverflow.com/questions/8350609/how-do-you-time-a-function-in-go-and-return-its-runtime-in-milliseconds\" title=\"how do you time a function in go and return its runtime in milliseconds\">stackoverflow.com/questions/8350609/&hellip;</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1425073075, "post_id": 28774572, "comment_id": 45827733, "body": "yes, forgot to mention the obvious, just run the two versions with your data and see which one is faster!"}], "answers": [{"tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": true, "score": 14, "last_activity_date": 1425074914, "last_edit_date": 1425074914, "creation_date": 1425073386, "answer_id": 28774813, "question_id": 28774572, "link": "https://stackoverflow.com/questions/28774572/which-is-faster-in-golang-for-finding-intersection-of-two-arrays/28774813#28774813", "title": "Which is faster in golang for finding intersection of two arrays?", "body": "<p>As was pointed out in the comments, you are not finding an intersection rather you are finding if a single entity of <code>original</code> is present in <code>target</code>.  That being said, your first example is <code>O(N)</code> because the range is <code>O(N)</code> and the map lookup is <code>O(1)</code>.  Your second example is <code>O(N^2)</code> because of the nested range loops.  Without any benchmarking I can tell you the first method will be far superior time wise (in worst case.)</p>\n\n<p>I benchmarked it just to show.  With 5000 items in original, and 500 in target - running both functions above, and testing with all matching and no matching elements in target:</p>\n\n<pre><code>BenchmarkMapLookup             50000         39756 ns/op\nBenchmarkNestedRange             300       4508598 ns/op\nBenchmarkMapLookupNoMatch      10000        103441 ns/op\nBenchmarkNestRangeNoMatch        300       4528756 ns/op\nok      so  7.072s\n</code></pre>\n\n<p>This is the benchmarking code:</p>\n\n<pre><code>package main\n\nimport (\n    \"math/rand\"\n    \"testing\"\n    \"time\"\n)\n\nvar letters = []rune(\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\")\n\nfunc randSeq(n int) string {\n    b := make([]rune, n)\n    for i := range b {\n        b[i] = letters[rand.Intn(len(letters))]\n    }\n    return string(b)\n}\n\nvar (\n    original         = []string{}\n    target           = []string{}\n    targetMap        = map[string]bool{}\n    targetNoMatch    = []string{}\n    targetMapNoMatch = map[string]bool{}\n)\n\nfunc init() {\n    rand.Seed(time.Now().UTC().UnixNano())\n    numItems := 5000\n    for i := 0; i &lt; numItems; i++ {\n        original = append(original, randSeq(10))\n    }\n\n    i := rand.Intn(numItems)\n    if i &gt;= 4500 {\n        i = 4499\n    }\n    stop := i + 500\n    for ; i &lt; stop; i++ {\n        target = append(target, original[i])\n        targetMap[original[i]] = true\n        noMatch := randSeq(9)\n        targetNoMatch = append(target, noMatch)\n        targetMapNoMatch[noMatch] = true\n    }\n\n}\n\nfunc ON(orig []string, tgt map[string]bool) bool {\n    for _, val := range orig {\n        if tgt[val] {\n            return true\n        }\n    }\n    return false\n}\n\nfunc ON2(orig, tgt []string) bool {\n    for _, i := range orig {\n        for _, x := range tgt {\n            if i == x {\n                return true\n            }\n        }\n    }\n    return false\n}\n\nfunc BenchmarkMapLookup(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        ON(original, targetMap)\n    }\n}\n\nfunc BenchmarkNestedRange(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        ON2(original, target)\n    }\n}\n\nfunc BenchmarkMapLookupNoMatch(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        ON(original, targetMapNoMatch)\n    }\n}\n\nfunc BenchmarkNestRangeNoMatch(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        ON2(original, targetNoMatch)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 1184210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f095e4f5824ec364f98379c1d8783be?s=128&d=identicon&r=PG", "display_name": "user324324", "link": "https://stackoverflow.com/users/1184210/user324324"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8013, "favorite_count": 0, "accepted_answer_id": 28774813, "answer_count": 1, "score": 1, "last_activity_date": 1425074914, "creation_date": 1425072362, "question_id": 28774572, "link": "https://stackoverflow.com/questions/28774572/which-is-faster-in-golang-for-finding-intersection-of-two-arrays", "title": "Which is faster in golang for finding intersection of two arrays?", "body": "<p>Which is faster in golang for finding intersection of two arrays?</p>\n\n<p>Original can be a very large list, as can target</p>\n\n<pre><code>original := []string{\"test\", \"test2\", \"test3\"} // n amount of items\n\ntarget := map[string]bool{\n    \"test\": true,\n    \"test2\": true,\n}\n\nfor _, val := range original {\n    if target[val] {\n        return true\n    }\n}\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>original := []string{\"test\", \"test2\", \"test3\"} // n amount of items\ntarget := []string{\"test\", \"test2\"}\n\nfor _, i := range original {\n    for _, x := range target {\n        if i == x {\n            return true\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["mysql", "go", "go-gorm", "last-insert-id"], "answers": [{"comments": [{"owner": {"reputation": 1364, "user_id": 791842, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/e22db9b1ffd20305669ffe5676baca02?s=128&d=identicon&r=PG", "display_name": "sathishvj", "link": "https://stackoverflow.com/users/791842/sathishvj"}, "edited": false, "score": 1, "creation_date": 1425247845, "post_id": 28776926, "comment_id": 45873558, "body": "I wasn&#39;t passing it as a pointer!  It works well now. Meanwhile, thank you for a very useful library."}], "tags": [], "owner": {"reputation": 415, "user_id": 2851543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14ccf22c2997ad9d6512b4a0a5527e6a?s=128&d=identicon&r=PG&f=1", "display_name": "Jinzhu", "link": "https://stackoverflow.com/users/2851543/jinzhu"}, "is_accepted": true, "score": 15, "last_activity_date": 1508383286, "last_edit_date": 1508383286, "creation_date": 1425085968, "answer_id": 28776926, "question_id": 28773963, "link": "https://stackoverflow.com/questions/28773963/how-can-i-retrieve-instance-of-last-added-item/28776926#28776926", "title": "How can I retrieve instance of last added item", "body": "<pre><code>type User struct {\n  Id int\n  Name string\n}\n\nuser := User{Name: \"jinzhu\"}\ndb.Save(&amp;user)\n// user.Id is set to last insert id\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 426, "user_id": 1878312, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4b021598e70a2e301a687f7a639266a8?s=128&d=identicon&r=PG", "display_name": "balaaagi", "link": "https://stackoverflow.com/users/1878312/balaaagi"}, "edited": false, "score": 0, "creation_date": 1554172723, "post_id": 52830059, "comment_id": 97643899, "body": "Can&#39;t we do this via db.Create?"}, {"owner": {"reputation": 5283, "user_id": 6336221, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Rh8CEJ_IGpA/AAAAAAAAAAI/AAAAAAAAALc/VV4nk6Yyqhg/photo.jpg?sz=128", "display_name": "Nisal Edu", "link": "https://stackoverflow.com/users/6336221/nisal-edu"}, "reply_to_user": {"reputation": 426, "user_id": 1878312, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4b021598e70a2e301a687f7a639266a8?s=128&d=identicon&r=PG", "display_name": "balaaagi", "link": "https://stackoverflow.com/users/1878312/balaaagi"}, "edited": false, "score": 0, "creation_date": 1554180200, "post_id": 52830059, "comment_id": 97645471, "body": "@BalajiSrinivasan you can but Create insert the value into database and Save update value in database, if the value doesn&#39;t have primary key, will insert it"}], "tags": [], "owner": {"reputation": 5283, "user_id": 6336221, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Rh8CEJ_IGpA/AAAAAAAAAAI/AAAAAAAAALc/VV4nk6Yyqhg/photo.jpg?sz=128", "display_name": "Nisal Edu", "link": "https://stackoverflow.com/users/6336221/nisal-edu"}, "is_accepted": false, "score": 2, "last_activity_date": 1539674828, "creation_date": 1539674828, "answer_id": 52830059, "question_id": 28773963, "link": "https://stackoverflow.com/questions/28773963/how-can-i-retrieve-instance-of-last-added-item/52830059#52830059", "title": "How can I retrieve instance of last added item", "body": "<p>Try as follows</p>\n\n<pre><code>type User struct {\n  Id   int    `gorm:\"column:id; PRIMARY_KEY\" json:\"id\"`\n  Name string `gorm:\"column:name\" json:\"name\"`\n}\n\nuser := User{Name: \"Andy\"}\ndb.Save(&amp;user)\n// user.Id is set to last insert id\n</code></pre>\n"}], "owner": {"reputation": 1364, "user_id": 791842, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/e22db9b1ffd20305669ffe5676baca02?s=128&d=identicon&r=PG", "display_name": "sathishvj", "link": "https://stackoverflow.com/users/791842/sathishvj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10923, "favorite_count": 1, "accepted_answer_id": 28776926, "answer_count": 2, "score": 6, "last_activity_date": 1609329357, "creation_date": 1425069941, "last_edit_date": 1609329357, "question_id": 28773963, "link": "https://stackoverflow.com/questions/28773963/how-can-i-retrieve-instance-of-last-added-item", "title": "How can I retrieve instance of last added item", "body": "<p>I'm using github.com/jinzhu/gorm with a mysql backend.  I want to retrieve the Id (or the full entity) of the row in the previous Create call.  </p>\n\n<p>As in, last-insert-id: (<a href=\"http://dev.mysql.com/doc/refman/5.0/en/information-functions.html#function_last-insert-id\" rel=\"noreferrer\">http://dev.mysql.com/doc/refman/5.0/en/information-functions.html#function_last-insert-id</a>)</p>\n\n<p>How can I do this?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 643, "user_id": 2402831, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2c32d36536daf6acc5634e65379b691?s=128&d=identicon&r=PG", "display_name": "user2402831", "link": "https://stackoverflow.com/users/2402831/user2402831"}, "edited": false, "score": 1, "creation_date": 1425315461, "post_id": 28774141, "comment_id": 45902347, "body": "Thanks, this is good info. Though it looks like I&#39;m not able to get the host without defining what the host is, which I find to be a little sloppy for what I&#39;m trying to do."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1425070728, "creation_date": 1425070728, "answer_id": 28774141, "question_id": 28770363, "link": "https://stackoverflow.com/questions/28770363/api-discovering-its-own-url-golang/28774141#28774141", "title": "API Discovering its own URL Golang", "body": "<p>You can \"reverse\" a gorilla/mux url by looking up the route by name, and generating the url with <a href=\"http://www.gorillatoolkit.org/pkg/mux#Route.URL\" rel=\"nofollow\"><code>Route.URL</code></a></p>\n\n<p>You will want to name your route, so that you can easily look it up via <a href=\"http://www.gorillatoolkit.org/pkg/mux#Router.Get\" rel=\"nofollow\"><code>Router.Get</code></a>.</p>\n\n<pre><code>r := mux.NewRouter()\nr.HandleFunc(\"/articles/{category}/{id:[0-9]+}\", ArticleHandler).\n  Name(\"article\")\n</code></pre>\n\n<p>And once you have the route, you can build a url by passing the parameters to URL</p>\n\n<pre><code>url, err := r.Get(\"article\").URL(\"category\", \"technology\", \"id\", \"42\")\n// \"/articles/technology/42\"\n</code></pre>\n\n<p>Note that if you want the host to be inserted automatically, it will need to be defined on your route:</p>\n\n<pre><code>r := mux.NewRouter()\nr.Host(\"{subdomain}.domain.com\").\n  HandleFunc(\"/articles/{category}/{id:[0-9]+}\", ArticleHandler).\n  Name(\"article\")\n\n// url.String() will be \"http://news.domain.com/articles/technology/42\"\nurl, err := r.Get(\"article\").URL(\"subdomain\", \"news\",\n                                 \"category\", \"technology\",\n                                 \"id\", \"42\")\n</code></pre>\n"}], "owner": {"reputation": 643, "user_id": 2402831, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2c32d36536daf6acc5634e65379b691?s=128&d=identicon&r=PG", "display_name": "user2402831", "link": "https://stackoverflow.com/users/2402831/user2402831"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 28774141, "answer_count": 1, "score": 1, "last_activity_date": 1425070728, "creation_date": 1425056398, "question_id": 28770363, "link": "https://stackoverflow.com/questions/28770363/api-discovering-its-own-url-golang", "title": "API Discovering its own URL Golang", "body": "<p>I've created an API in Go that can search or directly access an <code>Element</code> via ElasticSearch, which then adds some data to the JSON payload, and returns that to the user. When searching I'm returning a list of <code>Elements</code>, and I'd like to be able to give a direct URL to the specific <code>Element</code> should the user wish to get more information.      </p>\n\n<p><strong>However I can't ascertain how the application is supposed to figure out its own URL. In the event that it can't, what would be a reasonable alternative for the URL itself?</strong>      </p>\n\n<p>Using net/http package and gorilla/mux for net based things.</p>\n"}, {"tags": ["string", "go", "orm", "type-conversion"], "answers": [{"comments": [{"owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "edited": false, "score": 0, "creation_date": 1425049228, "post_id": 28767991, "comment_id": 45814665, "body": "Yes, but the data inserted to the database is truncated. I verified when I tried to retrieve the data and sliced it. I got the error, slice out of bounds. But when I manually insert the bytes to the db the slice doesn&#39;t error out."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "edited": false, "score": 0, "creation_date": 1425051291, "post_id": 28767991, "comment_id": 45816037, "body": "@majidarif See my edited question. What version of MySQL are you using? Also could it be that when you created your table, you specified a length less than 2000?"}, {"owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "edited": false, "score": 0, "creation_date": 1425051352, "post_id": 28767991, "comment_id": 45816076, "body": "I have a varbinary(2000) column and it is actually the latest mariadb. :)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "edited": false, "score": 0, "creation_date": 1425052358, "post_id": 28767991, "comment_id": 45816689, "body": "@majidarif Please see the update in my answer about MariaDB and max length of 255 characters. This explains why the value you read from db only contains non-zero values in the first 255 bytes and all zeros beyond that."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1425052293, "last_edit_date": 1425052293, "creation_date": 1425049127, "answer_id": 28767991, "question_id": 28767067, "link": "https://stackoverflow.com/questions/28767067/go-binary-data-being-truncated-on-string-conversion/28767991#28767991", "title": "Go binary data being truncated on string conversion", "body": "<p><strong>EDIT:</strong></p>\n\n<p>You mentioned in the comment that you use MariaDB (not MySQL).</p>\n\n<p>See <a href=\"http://www.techonthenet.com/mariadb/datatypes.php\" rel=\"nofollow\">MariaDB Tutorial: DATA TYPES</a>:</p>\n\n<blockquote>\n  <p>VARBINARY(size) - Maximum size of 255 characters. - Where size is the number of characters to store. Variable-length string.</p>\n</blockquote>\n\n<p><code>varbinary</code> length is limited to 255 characters... Also it is in section <code>STRING DATATYPES</code>. This means MariaDB handles varbinary as a string...</p>\n\n<p>This may very well explain the value you see: after about 255 bytes it contains just <code>0</code> values and nothing else, most likely because only 255 bytes come from the database and the rest is just filled with the zero-value of <code>byte</code> (which is <code>0</code>).</p>\n\n<hr>\n\n<p>A <code>string</code> in Go is stored as a byte array and interpreted using UTF-8 encoding.</p>\n\n<p>A <code>string</code> may contain any byte sequence, but not all byte sequences represent valid UTF-8 encoded text.</p>\n\n<p>So if you use <code>Data</code> to store arbitrary seuqence of bytes, you can't always display or treat it as a text. Just because printing the result of <code>string(Data)</code> conversion displays only 16 characters it doesn't mean <code>Data</code> contains only 16 bytes (or the bytes of 16 characters).</p>\n\n<p>You can check it by printing its length:</p>\n\n<pre><code>fmt.Println(len(charData.Data))\n</code></pre>\n\n<p>Read this blog post to learn more about the topic:</p>\n\n<p><a href=\"http://blog.golang.org/strings\" rel=\"nofollow\"><strong>Strings, bytes, runes and characters in Go</strong></a></p>\n\n<p><strong>Edit:</strong></p>\n\n<p>You mentioned you use MySQL. What version?</p>\n\n<p>MySQL version 5.0.2 and below only allows 255 bytes in <code>varbinary</code>, version 5.0.3 and above allows 64 KB. If the data inserted does not fit into the max (or defined) length, it is truncated.</p>\n\n<p>Also please see <a href=\"http://dev.mysql.com/doc/refman/5.6/en/storage-requirements.html\" rel=\"nofollow\">MySQL 5.6 Reference Manual :: Section 11 Data Types :: 11.7 Data Type Storage Requirements</a>:</p>\n\n<blockquote>\n  <p>The internal representation of a table has a maximum row size of 65,535 bytes, even if the storage engine is capable of supporting larger rows.</p>\n</blockquote>\n\n<p>So if you (obviously) have other values in the row, they also have to fit into the row limit (which is 64 KB). Note that this is MySQL 5.6.</p>\n"}], "owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 826, "favorite_count": 0, "accepted_answer_id": 28767991, "answer_count": 1, "score": 2, "last_activity_date": 1475354421, "creation_date": 1425046268, "last_edit_date": 1475354421, "question_id": 28767067, "link": "https://stackoverflow.com/questions/28767067/go-binary-data-being-truncated-on-string-conversion", "title": "Go binary data being truncated on string conversion", "body": "<p>I am using <a href=\"https://github.com/jinzhu/gorm\" rel=\"nofollow\">GORM</a>. My data field is <code>varbinary(2000)</code> but why is the data being inserted (new) being truncated to around 20 bytes?</p>\n\n<pre><code>var charData CharacterData\ndb.Where(CharacterData{CharId: charId, Segment: 0}).FirstOrInit(&amp;charData)\ncharData.Data = data[16:]\ndb.Save(&amp;charData)\n</code></pre>\n\n<p><code>len(data[16:])</code> is 2000.</p>\n\n<pre><code> type CharacterData struct {\n  CharId    uint32\n  Data      []byte\n  Segment   uint8\n  SegmentId uint16\n\n  CreatedAt time.Time\n  UpdatedAt time.Time\n  DeletedAt time.Time\n }\n</code></pre>\n\n<p>I also tried:</p>\n\n<pre><code>fmt.Println(string(charData0))\nfmt.Println(len(charData0))\nfmt.Println(len(string(charData0)))\n\n0uyuyuyyuyuyuyy\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd // only this gets inserted to the db which is short of the actual 1587\n1587\n1587\n</code></pre>\n\n<p>And it is also truncating the data. So I guess the problem lies with the to string casting.</p>\n\n<p>The insert log shows:</p>\n\n<pre><code>INSERT INTO character_data (char_id, data, segment) VALUES ('2', '0tututututt\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd', '0')\n</code></pre>\n\n<p><code>data[16:]</code> contains:</p>\n\n<pre><code>[0 0 48 6 1 0 1 0 104 101 104 101 104 101 104 101 104 101 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 255 255 0 0 0 0 0 0 0 0 0 0 0 0 0 0 255 255 0 0 0 0 0 0 0 0 0 0 0 0 0 0 255 255 0 0 0 0 0 0 0 0 0 0 0 0 0 0 255 255 0 0 0 0 0 0 0 0 0 0 0 0 0 0 255 255 0 0 0 0 0 0 0 0 0 0 0 0 0 0 255 255 0 0 0 0 0 0 0 0 0 0 0 0 0 0 255 255 0 0 0 0 0 0 0 0 0 0 0 0 0 0 255 255 0 0 0 0 0 0 0 0 0 0 0 0 0 0 255 255 0 0 0 0 0 0 0 0 0 0 0 0 0 0 255 255 0 0 0 0 0 0 0 0 0 0 0 0 0 0 255 255 0 0 0 0 0 0 0 0 0 0 0 0 0 0 255 255 0 0 0 0 0 0 0 0 0 0 0 0 0 0 255 255 0 0 0 0 0 0 0 0 0 0 0 0 0 0 255 255 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]\n</code></pre>\n\n<h2>update</h2>\n\n<p>Actual data inserted to database:</p>\n\n<pre><code>0tututututt\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\n</code></pre>\n\n<p>Instead of what normally should be something similar to:</p>\n\n<pre><code>pdukel\u00d0\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff2\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff1\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ffHHllb\u00cdf\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00fa\u00fa\u00fa\u00fa\u00fa\u00fa\u00fa\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00fe  \u00fa\n\u00fa\u00fa\u00fe\n\u00fe\u00fe\u00fe\u00fe\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff'\u00ff\u00ff\n</code></pre>\n\n<h2>using raw queries</h2>\n\n<pre><code>var charData0 []byte = data[16:]\nhexData := fmt.Sprintf(\"%x\", charData0)\nfmt.Println(hexData)\ndb.Exec(\"INSERT INTO character_data (char_id, data, segment) VALUES (?, UNHEX(?), ?)\", charId, hexData, 0)\n\n=&gt; 000030060100010079697969796979697979697900000000000000000000000000000000ffff0000000000000000000000000000ffff0000000000000000000000000000ffff0000000000000000000000000000ffff0000000000000000000000000000ffff0000000000000000000000000000ffff0000000000000000000000000000ffff0000000000000000000000000000ffff0000000000000000000000000000ffff0000000000000000000000000000ffff0000000000000000000000000000ffff0000000000000000000000000000ffff0000000000000000000000000000ffff0000000000000000000000000000ffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n</code></pre>\n\n<p>But the database only got:</p>\n\n<pre><code>0yiyiyiyiyyiy\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\n</code></pre>\n\n<h2>update</h2>\n\n<p>Actually tried running the query on sqlpro:</p>\n\n<pre><code>INSERT INTO character_data (char_id, data, segment) VALUES ('4', UNHEX('000030060100010074757475747574757475740000000000050000000000000000000000ffff0000000000000000000000000000ffff0000000000000000000000000000ffff0000000000000000000000000000ffff0000000000000000000000000000ffff0000000000000000000000000000ffff0000000000000000000000000000ffff0000000000000000000000000000ffff0000000000000000000000000000ffff0000000000000000000000000000ffff0000000000000000000000000000ffff0000000000000000000000000000ffff0000000000000000000000000000ffff0000000000000000000000000000ffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'), '0')\n</code></pre>\n\n<p>And I still got truncated data. So does the problem lie with MYSQL?</p>\n"}, {"tags": ["mongodb", "variables", "go", "global-variables"], "answers": [{"comments": [{"owner": {"reputation": 6945, "user_id": 2288944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/7qryD.jpg?s=128&g=1", "display_name": "armnotstrong", "link": "https://stackoverflow.com/users/2288944/armnotstrong"}, "edited": false, "score": 2, "creation_date": 1425045537, "post_id": 28766583, "comment_id": 45812433, "body": "Aha.. not again, falling into the pitfall of <code>:=</code> and <code>=</code> one more time. Thanks, things works now."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1425044802, "creation_date": 1425044802, "answer_id": 28766583, "question_id": 28766489, "link": "https://stackoverflow.com/questions/28766489/using-and-assign-variables-of-other-file-package-in-go/28766583#28766583", "title": "Using and assign variables of other file (package) in go", "body": "<p>The <a href=\"http://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow\">Short variable declaration</a> <code>:=</code> creates new variables. The name of the new variables cannot contain package names, but yours does:</p>\n\n<pre><code>dbutil.MySession, err := dbutil.ConnectDb()\n</code></pre>\n\n<p>Just don't use the short variable declaration:</p>\n\n<pre><code>var err error\ndbutil.MySession, err = dbutil.ConnectDb()\n// ...rest of your code\n</code></pre>\n"}], "owner": {"reputation": 6945, "user_id": 2288944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/7qryD.jpg?s=128&g=1", "display_name": "armnotstrong", "link": "https://stackoverflow.com/users/2288944/armnotstrong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 28766583, "answer_count": 1, "score": 1, "last_activity_date": 1425045769, "creation_date": 1425044474, "last_edit_date": 1425045769, "question_id": 28766489, "link": "https://stackoverflow.com/questions/28766489/using-and-assign-variables-of-other-file-package-in-go", "title": "Using and assign variables of other file (package) in go", "body": "<p>I have a http server using mongodb as a backend db, I wrapped the db operations in a separate file (<em>package</em>), and I don't want to make a connection every time, So I think make a <strong>global</strong> session and copy it like <a href=\"https://gist.github.com/ardan-bkennedy/9198289#file-gomgosample-full-go-L95\" rel=\"nofollow\">this</a> maybe a good idea. So this is so far I've got:</p>\n\n<p>File <code>server.go</code> in which I start the http server, and I also want to init the mongodb connection from here, for I don't know other way to make a connection that could live through the whole life of the http server so far :-(</p>\n\n<pre><code>package main\n\nimport(\n    \"./mylib\"\n    \"net/http\"\n)\n...\nfunc main(){\n    dbutil.MySession, err := dbutil.ConnectDb()\n    if err != nil {\n       panic(err)\n    }\n    // I will just omit the http server config code for convenience\n    http.HandleFunc(...)\n    http.HandleFunc(...)\n}\n...\n</code></pre>\n\n<p>And here is the file <code>dbutil.go</code> which contains the variable <code>MySession</code>. By the way, the total dir structure of them is like this, should be fine:</p>\n\n<pre><code>.\n\u251c\u2500\u2500 mylib\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 dbutil.go\n\u2514\u2500\u2500 server.go\n</code></pre>\n\n<p>And in <code>dbutil.go</code>:</p>\n\n<pre><code>package dbutil\nimport (\n  ...\n)\n\nvar MySession *mgo.Session\nfunc ConnectDb() (*mgo.Session, error){\n   session, err := mgo.Dial(\"127.0.0.1\")\n   if err != nil {\n       return nil, err\n   }\n   return session, nil\n}\n</code></pre>\n\n<p>But when I compile them and run the server, it complains that:</p>\n\n<pre><code># command-line-arguments\n./server.go:28: cannot declare name dbutil.MySession\n</code></pre>\n\n<p>I notice that if I change <code>dbutil.MySession, err := dbutil.ConnectDb()</code> to <code>dbutil.MySession, err = dbutil.ConnectDb()</code> things will not work either. </p>\n\n<p>So How Can I assign the <strong>global</strong> Variable <code>MySession</code> in this case? Or did I do something wrong (<em>try to use a variable of other file</em>) at the first place?</p>\n"}, {"tags": ["loops", "pointers", "go", "linked-list"], "comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 1, "creation_date": 1425022910, "post_id": 28759275, "comment_id": 45799741, "body": "Your modification is certainly cleaner than mine ;) I just tried to modify as little as possible your initial version of the loop."}], "answers": [{"comments": [{"owner": {"reputation": 4737, "user_id": 36693, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/OWMEs.jpg?s=128&g=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/36693/nate"}, "edited": false, "score": 0, "creation_date": 1425022593, "post_id": 28759399, "comment_id": 45799567, "body": "Thanks! I face-palmed when reading the doc you linked to. Makes so much sense when I think about it now."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 4, "last_activity_date": 1425022485, "last_edit_date": 1425022485, "creation_date": 1425020859, "answer_id": 28759399, "question_id": 28759275, "link": "https://stackoverflow.com/questions/28759275/what-is-wrong-with-my-iterate-function/28759399#28759399", "title": "What is wrong with my iterate function", "body": "<p>Looking at the <a href=\"http://golang.org/ref/spec#For_statements\" rel=\"nofollow\"><code>For</code> statement spec</a>: </p>\n\n<ul>\n<li>The \"init statement\" part of your loop (<code>n := head.Next</code>) is evaluated only once.</li>\n<li>The post statement keeps resetting <code>head</code> to the initial value of <code>n</code> (<code>getNext(head)</code>).</li>\n</ul>\n\n<p>Hence the inifinite loop.</p>\n\n<p>Putting <code>n := getNext(head)</code> <em>within</em> the loop should be better, as in this <a href=\"http://play.golang.org/p/7rcCfCNfID\" rel=\"nofollow\">working example</a>:</p>\n\n<pre><code>for n := head; n != nil; head = n {\n    fmt.Printf(\"head %+v n %+v\\n\", head, n)\n    time.Sleep(time.Second * 1)\n    n = head.Next\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 4370266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0EhWFkqtFKU/AAAAAAAAAAI/AAAAAAAAAGw/3edSWYQsjQs/photo.jpg?sz=128", "display_name": "Amc", "link": "https://stackoverflow.com/users/4370266/amc"}, "is_accepted": false, "score": 3, "last_activity_date": 1425022507, "creation_date": 1425022507, "answer_id": 28759789, "question_id": 28759275, "link": "https://stackoverflow.com/questions/28759275/what-is-wrong-with-my-iterate-function/28759789#28759789", "title": "What is wrong with my iterate function", "body": "<p><code>n := head.Next</code> just run once.</p>\n\n<p>in <code>for \u2460; \u2461; \u2462 { \u2463 }</code> </p>\n\n<p>it runs \u2460 - \u2461\u2463\u2462 - \u2461\u2463\u2462 - \u2461\u2463\u2462 - ...</p>\n\n<p>so you should put the iteration in \u2462, of course, you can put it in \u2461 or \u2463 but it's not very obvious.</p>\n"}], "owner": {"reputation": 4737, "user_id": 36693, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/OWMEs.jpg?s=128&g=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/36693/nate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 1, "accepted_answer_id": 28759399, "answer_count": 2, "score": 2, "last_activity_date": 1425072484, "creation_date": 1425020280, "last_edit_date": 1425072484, "question_id": 28759275, "link": "https://stackoverflow.com/questions/28759275/what-is-wrong-with-my-iterate-function", "title": "What is wrong with my iterate function", "body": "<p>I am attempting to iterate over a simple linked list. This should be so simple, but it's not working. The iterate function contains the issue. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\ntype Node struct {\n    Next  *Node\n    Value int\n}\n\nfunc main() {\n    //Load up 100 *Node in a linked list (albeit a simple one)\n    head := &amp;Node{Value: 0}\n    current := head\n    for i := 1; i &lt; 100; i++ {\n        current.Next = &amp;Node{Value: i}\n        current = current.Next\n        fmt.Printf(\"current %p %+v\\n\", current, current)\n    }\n\n    iterate(head)\n}\n\n//Iterate through the list starting at head. It never \n//advances past the first \"Next\", loops forever.\nfunc iterate(head *Node) {\n    for n := head.Next; n != nil; head = n {\n        fmt.Printf(\"head %+v n %+v\\n\", head, n)\n        time.Sleep(time.Second * 1)\n    }\n}\n</code></pre>\n\n<p>The output of iterate looks something like:</p>\n\n<pre><code>head &amp;{Next:0x20818c230 Value:0} n &amp;{Next:0x20818c280 Value:1}\nhead &amp;{Next:0x20818c280 Value:1} n &amp;{Next:0x20818c280 Value:1}\nhead &amp;{Next:0x20818c280 Value:1} n &amp;{Next:0x20818c280 Value:1}\nhead &amp;{Next:0x20818c280 Value:1} n &amp;{Next:0x20818c280 Value:1}\nhead &amp;{Next:0x20818c280 Value:1} n &amp;{Next:0x20818c280 Value:1}\n</code></pre>\n\n<p>For kicks I tried another version of the iterate loop that uses a function to fetch .Next. My thinking was that maybe head.Next was always pointing at my original head due to some sort of loop optimization. That theory seems incorrect.</p>\n\n<pre><code>func iterate(head *Node) {\n    getNext := func (n *Node) *Node {\n        return n.Next\n    }\n\n    for n := getNext(head); n != nil; head = n {\n        fmt.Printf(\"head %+v n %+v\\n\", head, n)\n        time.Sleep(time.Second * 1)\n    }\n}\n</code></pre>\n\n<p>Gosh, am I just not seeing it? I set head to n after the loop body executes which is equal to the next Node. Shouldn't the next head.Next return the subsequent Node until we get to a nil node and exit the loop?</p>\n\n<p>--- Update ---</p>\n\n<p>I've come up with the following modification to iterate which is so much cleaner and actually correct now:</p>\n\n<pre><code>func iterate(head *Node) {\n    for ; head != nil; head = head.Next {\n        fmt.Printf(\"head %+v head.Next %+v\\n\", head, head.Next)\n    }\n}\n</code></pre>\n"}, {"tags": ["session", "go", "revel"], "comments": [{"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 1, "creation_date": 1425018864, "post_id": 28758693, "comment_id": 45798100, "body": "You could go the simple route and encode your data as a string using <code>encoding&#47;json</code> for example.  Other options would be a base64 encoded gob.  Or just store the various pieces in the session individually like you show above, and use a couple helpers to store from a <code>t.Token</code> and recreate a <code>t.Token</code> from the session data."}, {"owner": {"reputation": 597, "user_id": 3731722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000181698389/picture?type=large", "display_name": "vinniyo", "link": "https://stackoverflow.com/users/3731722/vinniyo"}, "reply_to_user": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1425024470, "post_id": 28758693, "comment_id": 45800391, "body": "Thank you! Worked wonderfully!"}], "answers": [{"comments": [{"owner": {"reputation": 597, "user_id": 3731722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000181698389/picture?type=large", "display_name": "vinniyo", "link": "https://stackoverflow.com/users/3731722/vinniyo"}, "edited": false, "score": 0, "creation_date": 1425024518, "post_id": 28760186, "comment_id": 45800417, "body": "I used jsonT, err := json.Marshal(t) and \tvar t *oauth.Transport  json.Unmarshal([]byte(c.Session[&quot;jsonT&quot;]), &amp;t) Thank you!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1425024269, "creation_date": 1425024269, "answer_id": 28760186, "question_id": 28758693, "link": "https://stackoverflow.com/questions/28758693/revel-storing-an-object-in-session/28760186#28760186", "title": "Revel - Storing an object in session", "body": "<p>You can use the <a href=\"http://golang.org/pkg/encoding/json/\" rel=\"nofollow\"><code>json</code></a> package to \"convert\" structs to <code>string</code> and vice versa. Just know that only exported fields are serialized this way.</p>\n\n<p>Since <code>oauth.Token</code> has only exported fields, this will work:</p>\n\n<pre><code>if data, err := json.Marshal(t.Token); err == nil {\n    c.Session[\"Token\"] = string(data)\n} else {\n    panic(err)\n}\n</code></pre>\n\n<p>And this is how you can reconstruct the token from the session:</p>\n\n<pre><code>if err := json.Unmarshal([]byte(c.Session[\"Token\"]), &amp;t.Token); err != nil {\n    panic(err)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26, "user_id": 4569250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afe999a1d6e4870446aa29d7082dae0c?s=128&d=identicon&r=PG&f=1", "display_name": "anonx", "link": "https://stackoverflow.com/users/4569250/anonx"}, "is_accepted": false, "score": 0, "last_activity_date": 1428403539, "last_edit_date": 1428403539, "creation_date": 1428402247, "answer_id": 29489302, "question_id": 28758693, "link": "https://stackoverflow.com/questions/28758693/revel-storing-an-object-in-session/29489302#29489302", "title": "Revel - Storing an object in session", "body": "<p>Instead of that you can try to save some string ID to <code>Session</code> and the object you need to <code>Cache</code>:</p>\n\n<pre><code>c.Session[\"id\"] = id\ngo cache.Set(\"token_\"+id, t.Token, 30*time.Minute)\n</code></pre>\n\n<p>And then use it as follows:</p>\n\n<pre><code>var token oauth.Token\n\nid := c.Session[\"id\"]\nif err := cache.Get(\"token_\"+id, &amp;token); err != nil {\n    // TODO: token not found, do something\n}\n\n// TODO: use your token here...\n</code></pre>\n\n<p>The advantage of this approach is you do not have to work with <code>json</code> package explicitly and cache has a few different back-ends out of the box: memory, redis, memcached. Moreover, you do not have a limitation of 4K as in case of <code>Cookie</code> based <code>Session</code>.</p>\n\n<p><a href=\"https://revel.github.io/manual/cache.html\" rel=\"nofollow\">https://revel.github.io/manual/cache.html</a></p>\n"}], "owner": {"reputation": 597, "user_id": 3731722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000181698389/picture?type=large", "display_name": "vinniyo", "link": "https://stackoverflow.com/users/3731722/vinniyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 910, "favorite_count": 0, "accepted_answer_id": 28760186, "answer_count": 2, "score": 2, "last_activity_date": 1428403539, "creation_date": 1425017675, "question_id": 28758693, "link": "https://stackoverflow.com/questions/28758693/revel-storing-an-object-in-session", "title": "Revel - Storing an object in session", "body": "<p>I'm using the oauth package \"code.google.com/p/goauth2/oauth\" with revel and the it creates a few structures with quite a bit of information in it. I need this information to be persistent throughout the session but sessions can only be type string. Is there a better way of doing this than the following?</p>\n\n<pre><code>c.Session[\"AccessToken\"] = t.Token.AccessToken\nc.Session[\"RefreshToken\"] = t.Token.RefreshToken\n...\n</code></pre>\n\n<p>If not how do I reassign the strings to create another structure to call Client.Get() ?</p>\n"}, {"tags": ["go", "markdown"], "answers": [{"comments": [{"owner": {"reputation": 47383, "user_id": 122536, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6fd51ed284bddf7eeab9de416359021e?s=128&d=identicon&r=PG", "display_name": "alexchenco", "link": "https://stackoverflow.com/users/122536/alexchenco"}, "edited": false, "score": 0, "creation_date": 1425026905, "post_id": 28759176, "comment_id": 45801556, "body": "Thanks but now it outputs: <code>This is a &lt;a href=&quot;http:&#47;&#47;www.example.org&#47;&quot;&gt;link&lt;&#47;a&gt; being rendered in a custom way.&lt;p class=&#39;custom&#39;&gt;%!q(bool=true)&lt;&#47;p&gt;</code>"}, {"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "reply_to_user": {"reputation": 47383, "user_id": 122536, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6fd51ed284bddf7eeab9de416359021e?s=128&d=identicon&r=PG", "display_name": "alexchenco", "link": "https://stackoverflow.com/users/122536/alexchenco"}, "edited": false, "score": 0, "creation_date": 1425053739, "post_id": 28759176, "comment_id": 45817552, "body": "Ah, right, text returns a <code>bool</code>.  I would need to look further to see how paragraph content is injected because it does not appear the default Paragraph function does it.  Give @Jaemin&#39;s answer a try."}], "tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": false, "score": 1, "last_activity_date": 1425019840, "creation_date": 1425019840, "answer_id": 28759176, "question_id": 28758686, "link": "https://stackoverflow.com/questions/28758686/go-how-to-use-the-func-bool-arguments-in-go/28759176#28759176", "title": "Go: How to use the func() bool arguments in go?", "body": "<p>I believe all you need to do is call <code>text</code> </p>\n\n<pre><code>func (options *renderer) Paragraph(out *bytes.Buffer, text func() bool) {\n    fmt.Fprintf(out, \"&lt;p class='custom'&gt;%q&lt;/p&gt;\\n\", text())\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 47383, "user_id": 122536, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6fd51ed284bddf7eeab9de416359021e?s=128&d=identicon&r=PG", "display_name": "alexchenco", "link": "https://stackoverflow.com/users/122536/alexchenco"}, "edited": false, "score": 0, "creation_date": 1425054462, "post_id": 28760041, "comment_id": 45817978, "body": "Thanks but it doesn&#39;t work because when you use <code>doubleSpace(out)</code> out of the package you get an undefined variable error."}, {"owner": {"reputation": 230, "user_id": 2152105, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5YGz.jpg?s=128&g=1", "display_name": "Jaemin Park", "link": "https://stackoverflow.com/users/2152105/jaemin-park"}, "reply_to_user": {"reputation": 47383, "user_id": 122536, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6fd51ed284bddf7eeab9de416359021e?s=128&d=identicon&r=PG", "display_name": "alexchenco", "link": "https://stackoverflow.com/users/122536/alexchenco"}, "edited": false, "score": 0, "creation_date": 1425058463, "post_id": 28760041, "comment_id": 45820489, "body": "Yes, it&#39;s private function so you somehow rewrite it or write alternative one."}], "tags": [], "owner": {"reputation": 230, "user_id": 2152105, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5YGz.jpg?s=128&g=1", "display_name": "Jaemin Park", "link": "https://stackoverflow.com/users/2152105/jaemin-park"}, "is_accepted": true, "score": 1, "last_activity_date": 1425023615, "creation_date": 1425023615, "answer_id": 28760041, "question_id": 28758686, "link": "https://stackoverflow.com/questions/28758686/go-how-to-use-the-func-bool-arguments-in-go/28760041#28760041", "title": "Go: How to use the func() bool arguments in go?", "body": "<p>I think your usage of function is wrong.</p>\n\n<p>Take a look at <a href=\"https://github.com/russross/blackfriday/blob/f4bb968b5f379b73adac606686bbfe96e57339ec/html.go#L401\" rel=\"nofollow\"><code>Html.Paragraph</code></a> and override this.</p>\n\n<p>Maybe it would look like:</p>\n\n<pre><code>func (options *renderer) Paragraph(out *bytes.Buffer, text func() bool) {\n    marker := out.Len()\n    doubleSpace(out) \n\n    out.WriteString(\"&lt;p class='custom'&gt;\")\n    if !text() {\n        out.Truncate(marker)\n        return\n    }\n    out.WriteString(\"&lt;/p&gt;\\n\")\n}\n</code></pre>\n"}], "owner": {"reputation": 47383, "user_id": 122536, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6fd51ed284bddf7eeab9de416359021e?s=128&d=identicon&r=PG", "display_name": "alexchenco", "link": "https://stackoverflow.com/users/122536/alexchenco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 28760041, "answer_count": 2, "score": 0, "last_activity_date": 1425023615, "creation_date": 1425017610, "question_id": 28758686, "link": "https://stackoverflow.com/questions/28758686/go-how-to-use-the-func-bool-arguments-in-go", "title": "Go: How to use the func() bool arguments in go?", "body": "<p>This is a sample code from the Go <a href=\"https://github.com/russross/blackfriday\" rel=\"nofollow\">blackfriday</a> package:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"github.com/russross/blackfriday\"\n)\n\nfunc main() {\n\ninput := []byte(`##Title\n\n- another paragragh\n\nThis is a being rendered in a custom way.\n`)\n\n    htmlFlags := 0\n    renderer := &amp;renderer{Html: blackfriday.HtmlRenderer(htmlFlags, \"\", \"\").(*blackfriday.Html)}\n\n    extensions := 0\n\n    unsanitized := blackfriday.Markdown(input, renderer, extensions)\n    os.Stdout.Write(unsanitized)\n}\n\n// renderer implements blackfriday.Renderer and reuses blackfriday.Html for the most part,\n// except overriding Link rendering.\ntype renderer struct {\n    *blackfriday.Html\n}\n\nfunc (options *renderer) Header(out *bytes.Buffer, text func() bool, level int, id string) {\n    fmt.Fprintf(out, \"&lt;custom link %q to %q&gt;\", content, link)\n}\n</code></pre>\n\n<p>The purpose of the code is to customize the <code>link</code> attributes of the output HTML.</p>\n\n<p>I tried to do the same but with <code>p</code> tags:</p>\n\n<pre><code>func (options *renderer) Paragraph(out *bytes.Buffer, text func() bool) {\n    fmt.Fprintf(out, \"&lt;p class='custom'&gt;%q&lt;/p&gt;\", text)\n}\n</code></pre>\n\n<p>But the output was this:</p>\n\n<pre><code>&lt;h1&gt;Title&lt;/h1&gt;\n\n&lt;ul&gt;\n&lt;li&gt;another paragragh&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p class='custom'&gt;%!q(func() bool=0x80a15d0)&lt;/p&gt;\n</code></pre>\n\n<p>So I have no idea how to output the actual text (<code>This is a being rendered in a custom way.</code>). Any ideas?</p>\n\n<p>This is the source code of the function:</p>\n\n<pre><code>func (options *Html) Paragraph(out *bytes.Buffer, text func() bool) {\n    marker := out.Len()\n    doubleSpace(out)\n\n    out.WriteString(\"&lt;p&gt;\")\n    if !text() {\n        out.Truncate(marker)\n        return\n    }\n    out.WriteString(\"&lt;/p&gt;\\n\")\n}\n</code></pre>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1425018388, "last_edit_date": 1425018388, "creation_date": 1425017334, "answer_id": 28758638, "question_id": 28757639, "link": "https://stackoverflow.com/questions/28757639/how-to-create-a-slice-of-a-type-given-as-parameter-in-golang-or-how-to-give-a/28758638#28758638", "title": "How to create a slice of a type given as parameter in Golang? or how to give a []interface{} to Appengine datastore getAll", "body": "<p>Here's how you get an argument of type *[]Person:</p>\n\n<pre><code>items := reflect.New(reflect.SliceOf(T))\n_, err := q.GetAll(c, items.Interface())\n</code></pre>\n\n<p>GetAll will allocate the backing array for the slice. There's no need to preallocate the backing array with <code>make</code>.</p>\n\n<p>Assuming that the argument to context.Set is a value containing a slice, then you need to dereference the pointer:</p>\n\n<pre><code>context.Set(r, collection, items.Elem())\n</code></pre>\n\n<p>If the context does not work with reflect values, then you probably want:</p>\n\n<pre><code>context.Set(r, collection, items.Elem().Interface())\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "is_accepted": false, "score": 0, "last_activity_date": 1425030090, "creation_date": 1425030090, "answer_id": 28761843, "question_id": 28757639, "link": "https://stackoverflow.com/questions/28757639/how-to-create-a-slice-of-a-type-given-as-parameter-in-golang-or-how-to-give-a/28761843#28761843", "title": "How to create a slice of a type given as parameter in Golang? or how to give a []interface{} to Appengine datastore getAll", "body": "<p>There are at least two code-generator based tools for creating type-safe parameterised code. The two I know of are</p>\n\n<ul>\n<li><a href=\"http://clipperhouse.github.io/gen/\" rel=\"nofollow\">Gen</a></li>\n<li><a href=\"https://github.com/cheekybits/genny\" rel=\"nofollow\">Genny</a></li>\n</ul>\n\n<p>I am currently using Gen. It's not as seamless as a built-in language feature might be, but it's a good way to produce generic collection types etc. Gen templates are called typewriters. Using the provided typewriters is really quite easy. Creating your own is a bit more work.</p>\n\n<p>Gen works using the Go template package. So the typewriters are written merely as strings; the compiler doesn't check them until output code is created (a minor drawback).</p>\n\n<p>Conversely, Genny tries to allow you to write compilable code containing generic marker types, and then it substitutes the generic markers with specific types. This is a simpler approach but didn't always work for me.</p>\n"}], "owner": {"reputation": 409, "user_id": 492973, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d60ab46b16446d4b2169af8afa6e3b78?s=128&d=identicon&r=PG", "display_name": "estebarb", "link": "https://stackoverflow.com/users/492973/estebarb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 28758638, "answer_count": 2, "score": 1, "last_activity_date": 1425030090, "creation_date": 1425011954, "last_edit_date": 1425018975, "question_id": 28757639, "link": "https://stackoverflow.com/questions/28757639/how-to-create-a-slice-of-a-type-given-as-parameter-in-golang-or-how-to-give-a", "title": "How to create a slice of a type given as parameter in Golang? or how to give a []interface{} to Appengine datastore getAll", "body": "<p>I'm trying to create a generator of handlers that works for several kinds of entities.\nThe following code works if the items slice is of a specific type (eg: <code>var items []Person</code>), but I'm having problems generalizing it: specifically \"<code>ERROR: Can't get items: datastore: invalid entity type</code>\".\nAny idea of how to declare items so that it have a type valid for GetAll?</p>\n\n<pre><code>func ScaffoldList(entity interface{}, collection string, templ *template.Template) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request){\n        c := appengine.NewContext(r)\n        T := reflect.TypeOf(entity)\n        q := datastore.NewQuery(T.String())\n        items := reflect.MakeSlice(reflect.SliceOf(T), 0, 10)\n        _, err := q.GetAll(c, &amp;items)\n        if err != nil{\n            c.Errorf(\"Can't get items: %v\", err)\n            http.Error(w, \"Can't get items\", http.StatusInternalServerError)\n            return\n        }\n        context.Set(r, collection, items)\n        ion.RenderTemplate(templ).ServeHTTP(w, r)\n    })\n}\n</code></pre>\n"}, {"tags": ["tcp", "go"], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 0, "last_activity_date": 1425049165, "last_edit_date": 1425049165, "creation_date": 1425011933, "answer_id": 28757632, "question_id": 28757552, "link": "https://stackoverflow.com/questions/28757552/tcp-client-ends-without-reaching-some-statements/28757632#28757632", "title": "tcp client ends without reaching some statements", "body": "<p>Your program will exit before it finishes executing, you need to use <code>sync.WaitGroup</code> or channels to wait for all the output before exiting.</p>\n\n<pre><code>func client(wg *sync.WaitGroup, servId uint16, servAddr string) {\n    defer wg.Done()\n.....\n}\n\nfunc main() {\n    var (\n        c, startId, servId uint16\n        wg                 sync.WaitGroup\n    )\n    for _, srv := range config.Servers {\n        for c = 0; c &lt; config.Total_clients; c++ {\n        ......\n            wg.Add(1)\n            go client(&amp;wg, servId, servAddr)\n        }\n    }\n    wg.Wait()\n}\n</code></pre>\n"}], "owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 28757632, "answer_count": 1, "score": 0, "last_activity_date": 1425049165, "creation_date": 1425011381, "question_id": 28757552, "link": "https://stackoverflow.com/questions/28757552/tcp-client-ends-without-reaching-some-statements", "title": "tcp client ends without reaching some statements", "body": "<p>The code below is suppose to open a connection to a server, send a message and wait for a reply before ending but the problem is it isn't even reaching the end of the function. What could be wrong? Should I use <code>wg sync.WaitGroup</code>?</p>\n\n<pre><code>func client(servId uint16, servAddr string) {\n\n    tcpAddr, err := net.ResolveTCPAddr(\"tcp\", servAddr)\n    check(err)\n\n    conn, err := net.DialTCP(\"tcp\", nil, tcpAddr)\n    check(err)\n\n    _, err = conn.Write(handshake(servId, 1500))\n    check(err)\n\n    init := make([]byte, 8)\n    _, err = io.ReadFull(conn, init)\n    check(err)\n\n    fmt.Println(\"is reached\") // doesn't get printed WHY?\n    fmt.Println(init)\n}\n</code></pre>\n\n<p>How the function above is called from <code>main</code></p>\n\n<pre><code>// vars\nvar c, startId, servId uint16\n\n// for each servers\nfor s := 0; s &lt; len(config.Servers); s++ {\n\n    // for each connection\n    for c = 0; c &lt; config.Total_clients; c++ {\n\n        startId = config.Server_id * config.Total_clients\n        servId = startId + c\n\n        servAddr := fmt.Sprintf(\"%s:%d\", config.Servers[s].Host, config.Servers[s].Port)\n\n        // create the clients in new go routines\n        go client(servId, servAddr)\n    }\n\n}\n</code></pre>\n"}, {"tags": ["go", "markdown"], "answers": [{"comments": [{"owner": {"reputation": 47383, "user_id": 122536, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6fd51ed284bddf7eeab9de416359021e?s=128&d=identicon&r=PG", "display_name": "alexchenco", "link": "https://stackoverflow.com/users/122536/alexchenco"}, "edited": false, "score": 0, "creation_date": 1425014970, "post_id": 28757544, "comment_id": 45796864, "body": "Oh, thanks. Is that something that&#39;s commonly done in Go (changing the input/output type)? Or I&#39;m using them in a wrong way?"}, {"owner": {"reputation": 2679, "user_id": 3081480, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UVerL.jpg?s=128&g=1", "display_name": "Kyle Chadha", "link": "https://stackoverflow.com/users/3081480/kyle-chadha"}, "reply_to_user": {"reputation": 47383, "user_id": 122536, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6fd51ed284bddf7eeab9de416359021e?s=128&d=identicon&r=PG", "display_name": "alexchenco", "link": "https://stackoverflow.com/users/122536/alexchenco"}, "edited": false, "score": 0, "creation_date": 1425047208, "post_id": 28757544, "comment_id": 45813495, "body": "I&#39;m not familiar with the blackfriday package so I can&#39;t comment on how that&#39;s supposed to work -- but in general it&#39;s not uncommon to have to convert types when manipulating data"}, {"owner": {"reputation": 2679, "user_id": 3081480, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UVerL.jpg?s=128&g=1", "display_name": "Kyle Chadha", "link": "https://stackoverflow.com/users/3081480/kyle-chadha"}, "reply_to_user": {"reputation": 47383, "user_id": 122536, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6fd51ed284bddf7eeab9de416359021e?s=128&d=identicon&r=PG", "display_name": "alexchenco", "link": "https://stackoverflow.com/users/122536/alexchenco"}, "edited": false, "score": 0, "creation_date": 1425047506, "post_id": 28757544, "comment_id": 45813651, "body": "Looking at their source, it looks like they take in and return []bytes everywhere, so yes -- I think you&#39;re on the right track. <a href=\"https://github.com/russross/blackfriday/blob/master/markdown.go#L250\" rel=\"nofollow noreferrer\">github.com/russross/blackfriday/blob/master/markdown.go#L250</a>"}], "tags": [], "owner": {"reputation": 2679, "user_id": 3081480, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UVerL.jpg?s=128&g=1", "display_name": "Kyle Chadha", "link": "https://stackoverflow.com/users/3081480/kyle-chadha"}, "is_accepted": true, "score": 3, "last_activity_date": 1425011357, "creation_date": 1425011357, "answer_id": 28757544, "question_id": 28757340, "link": "https://stackoverflow.com/questions/28757340/go-using-using-a-string-in-a-byte-function-type-argument/28757544#28757544", "title": "Go: Using using a string in a []byte function type argument?", "body": "<p>Convert it back to a string.</p>\n\n<p><code>fmt.Println(string(output))</code></p>\n"}], "owner": {"reputation": 47383, "user_id": 122536, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6fd51ed284bddf7eeab9de416359021e?s=128&d=identicon&r=PG", "display_name": "alexchenco", "link": "https://stackoverflow.com/users/122536/alexchenco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3324, "favorite_count": 0, "accepted_answer_id": 28757544, "answer_count": 1, "score": 1, "last_activity_date": 1425011357, "creation_date": 1425009990, "question_id": 28757340, "link": "https://stackoverflow.com/questions/28757340/go-using-using-a-string-in-a-byte-function-type-argument", "title": "Go: Using using a string in a []byte function type argument?", "body": "<p>I'm begginer to Go. I'm trying to use <a href=\"https://github.com/russross/blackfriday/blob/master/markdown.go\" rel=\"nofollow\">blackfriday</a> (a Go Markdown parser). This is the code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/russross/blackfriday\"\n)\n\nfunc main() {\n    input := \"this is a test\"\n    output := blackfriday.MarkdownCommon(input)\n\n    fmt.Println(output)\n}\n</code></pre>\n\n<p>I got an error, though:</p>\n\n<pre><code>alex@alex-K43U:~/go/src/m2kgo$ go run m2kgo.go\n# command-line-arguments\n./m2kgo.go:20: cannot use input (type string) as type []byte in argument to blackfriday.MarkdownCommon\n</code></pre>\n\n<p>So I tried turning the argument into <code>[]byte</code>:</p>\n\n<pre><code>output := blackfriday.MarkdownCommon([]byte(input))\n</code></pre>\n\n<p>This output the bytes though:</p>\n\n<pre><code>alex@alex-K43U:~/go/src/m2kgo$ go run m2kgo.go\n[60 112 62 116 104 105 115 32 105 115 32 97 32 116 101 115 116 60 47 112 62 10]\n</code></pre>\n\n<p>How can I print the generated HTML instead of the bytes?</p>\n"}]