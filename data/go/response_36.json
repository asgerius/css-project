[{"tags": ["hash", "go"], "answers": [{"comments": [{"owner": {"reputation": 269, "user_id": 2105489, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f2de1fca3cddc2162f295dcf528f431?s=128&d=identicon&r=PG", "display_name": "nullgraph", "link": "https://stackoverflow.com/users/2105489/nullgraph"}, "edited": false, "score": 0, "creation_date": 1443742559, "post_id": 32620340, "comment_id": 53625724, "body": "I just checked this again and I don&#39;t think <code>h.Sum(dat)</code> would do it, I don&#39;t get the same result if I call the function directly like <code>sha256.Sum256(dat)</code>. The example <a href=\"https://golang.org/pkg/crypto/sha1/#example_New\" rel=\"nofollow noreferrer\">sha1.New()</a> mentions adding the string before calling <code>Sum</code>."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 5, "last_activity_date": 1442446196, "last_edit_date": 1442446196, "creation_date": 1442445890, "answer_id": 32620340, "question_id": 32620290, "link": "https://stackoverflow.com/questions/32620290/how-to-dynamically-switch-between-hash-algorithms-in-golang/32620340#32620340", "title": "How to dynamically switch between hash algorithms in golang?", "body": "<p>What you need to do is <a href=\"https://golang.org/doc/effective_go.html#blank_import\" rel=\"noreferrer\">import the packages for their side effects only</a> (i.e. use the blank identifier when importing the packages). This means that the imported packages' <code>init</code> functions will be executed, but you will not be able to access any of their exported members directly.</p>\n\n<p>Here is one way you could solve your problem:</p>\n\n<pre><code>import (\n  \"errors\"\n  \"encoding/hex\"\n  \"crypto\"\n  _ \"crypto/md5\"\n  _ \"crypto/sha1\"\n  // import more hash packages\n)\n\nfunc GenericHash(dat []byte, hash crypto.Hash) (string, error) {\n  if !hash.Available() {\n    return \"\", errors.New(\"hash unavailable\")\n  }\n  h := hash.New()\n  return hex.EncodeToString(h.Sum(dat)), nil\n}\n</code></pre>\n"}], "owner": {"reputation": 269, "user_id": 2105489, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f2de1fca3cddc2162f295dcf528f431?s=128&d=identicon&r=PG", "display_name": "nullgraph", "link": "https://stackoverflow.com/users/2105489/nullgraph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 32620340, "answer_count": 1, "score": 2, "last_activity_date": 1442446196, "creation_date": 1442445549, "question_id": 32620290, "link": "https://stackoverflow.com/questions/32620290/how-to-dynamically-switch-between-hash-algorithms-in-golang", "title": "How to dynamically switch between hash algorithms in golang?", "body": "<p>I want to be able to switch between hash algorithms depending on caller input, for example, implement a function:</p>\n\n<pre><code>func GenericHash(dat []byte, hash unint) (string, error) { ... }\n</code></pre>\n\n<p>where hash is the algorithm type as specified by <a href=\"http://golang.org/pkg/crypto/#Hash\" rel=\"nofollow\">crypto.Hash</a>.</p>\n\n<p>I'm not sure how to write this function, in particular, where the import statements should go. If I include all the import statements for algorithms that I will use at the top, go complains that they're imported and not used. Is there anyway to import on demand?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "is_accepted": true, "score": 4, "last_activity_date": 1442445266, "last_edit_date": 1442445266, "creation_date": 1442444946, "answer_id": 32620197, "question_id": 32620086, "link": "https://stackoverflow.com/questions/32620086/what-is-the-proper-way-to-organize-structure-go-package-folders-and-files/32620197#32620197", "title": "What is the proper way to organize / structure Go package folders and files?", "body": "<p>The first place to look for inspiration is the <a href=\"http://golang.org/src/\" rel=\"nofollow\">Go standard library</a>. The Go standard library is a pretty good guide of what \"good\" Go code should look like. A library isn't quite the same as an application, but it's definitely a good introduction.</p>\n\n<p>In general, you would not break up every method into its own file. Go tends to prefer larger files that cover a topic. 3000 lines seems quite large, though. Even the net/http <a href=\"http://golang.org/src/net/http/server.go\" rel=\"nofollow\">server.go</a> is only 2200 lines, and it's pretty big.</p>\n\n<p>Global mutable variables are just as bad in Go as in any language. Since Go relies so heavily on concurrent programming, global mutable variables are quite horrible. Don't do that. One common exception is <code>sync</code> structures like <code>sync.Pool</code> or <code>sync.Once</code>, which sometimes are package global, but are also designed to be accessed concurrently. There are also sometimes \"Default\" versions of structures, like <code>http.DefaultClient</code>, but you can still pass explicit ones to functions. Again, look through the Go standard library and see what is common and what is rare.</p>\n"}, {"comments": [{"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 1, "creation_date": 1442497491, "post_id": 32622542, "comment_id": 53112731, "body": "Note that Go tends to use a very different package structure than Java. In particular, Go tends to favor larger packages that cover an entire reusable system, rather than splitting it up by feature. For example, <code>net</code> covers DNS, IP, creating network connections, networking hardware, and more. In Java, you would tend to split those features up. Also note that Go packages are not hierarchical. <code>net&#47;http</code> is unrelated to <code>net</code>. Every package stands completely alone in Go. I agree that &quot;controllers&quot; is a very bad package, though, in any system. And loggers often are global as you note."}, {"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 1, "creation_date": 1442497693, "post_id": 32622542, "comment_id": 53112862, "body": "(I have found that making loggers global, while common, also makes testing in Go a bit more complicated, and makes some kinds of code reuse much harder. Same for debug flags. That said, it is a very common solution.)"}], "tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": false, "score": 1, "last_activity_date": 1442463707, "creation_date": 1442463707, "answer_id": 32622542, "question_id": 32620086, "link": "https://stackoverflow.com/questions/32620086/what-is-the-proper-way-to-organize-structure-go-package-folders-and-files/32622542#32622542", "title": "What is the proper way to organize / structure Go package folders and files?", "body": "<p>Just a few tips that you hopefully find useful:</p>\n\n<ul>\n<li><p>Organize code into multiple files and packages by features, not by layers. This becomes more important the bigger your application becomes. package <code>controllers</code> with one or two controllers is probably ok, but putting hundreds of unrelated controllers in the same package doesn't make any sense. The following article explains it very well: <a href=\"http://www.javapractices.com/topic/TopicAction.do?Id=205\" rel=\"nofollow\">http://www.javapractices.com/topic/TopicAction.do?Id=205</a></p></li>\n<li><p>Global variables sometimes make code easier to write however they should be used with care. I think unexported global variables for things like logger, debug flags, etc are ok.</p></li>\n</ul>\n"}], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 32620197, "answer_count": 2, "score": 3, "last_activity_date": 1613738492, "creation_date": 1442444170, "last_edit_date": 1613738492, "question_id": 32620086, "link": "https://stackoverflow.com/questions/32620086/what-is-the-proper-way-to-organize-structure-go-package-folders-and-files", "title": "What is the proper way to organize / structure Go package folders and files?", "body": "<p>I know this might be controversial or not very broad but I'm going to try to be very specific and relate to other questions.</p>\n<p>Ok so when I make a Go program what things should I be thinking in terms of how I should organize my project? (E.g. should I think ok I'm going to have controllers of some sort so I should have a controller subdirectory that's going to do this so I should have that)</p>\n<p>How should I structure a package?</p>\n<p>For example the current program I'm working on I'm trying to make a <code>SteamBot</code> using <a href=\"http://github.com/Philipp15b/go-steam\" rel=\"nofollow noreferrer\">this</a> package</p>\n<p>But while I'm writing it I don't know if I should export certain methods into their own own files, e.g. I'd have something like</p>\n<pre><code>func (t *tradeBot) acceptTrade() {}\nfunc (t *tradeBot) declineTrade() {}\nfunc (t *tradeBot) monitorTrade() {}\nfunc (t *tradeBot) sendTrade() {}\n</code></pre>\n<p>each method is going to have quite a bit of code so should I export each method into its own file or just have 1 file with 3000 lines of code in it?</p>\n<p>Also using global variables so that I can set one variable and then leave it and be able to use it in multiple functions, or is this bad and I should pass the variables as arguments?</p>\n<p>Also should I order my files like:</p>\n<pre><code>package\nimports\nconstants\nvariables\nfunctions\nmethods\n</code></pre>\n<p>Or do I just put things where I need them?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1442456120, "post_id": 32619318, "comment_id": 53093343, "body": "Also look at <a href=\"https://github.com/natefinch/lumberjack\" rel=\"nofollow noreferrer\">github.com/natefinch/lumberjack</a>"}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 2780144, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/a93bcfbf0518005fe617e99b27731a1c?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/2780144/craig"}, "edited": false, "score": 2, "creation_date": 1442441173, "post_id": 32619406, "comment_id": 53089620, "body": "Nice!  That&#39;s it.  Would the best practice in go be to move my logging initialization from init to main, or to just keep the log file open without the explicit close?"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 91, "user_id": 2780144, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/a93bcfbf0518005fe617e99b27731a1c?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/2780144/craig"}, "edited": false, "score": 0, "creation_date": 1442539665, "post_id": 32619406, "comment_id": 53133226, "body": "@Craig I&#39;d just just move it to main, because if you don&#39;t close it on exit you can be miss few bytes at the end of the file."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 7, "last_activity_date": 1442440392, "creation_date": 1442440392, "answer_id": 32619406, "question_id": 32619318, "link": "https://stackoverflow.com/questions/32619318/logging-to-a-file-in-golang/32619406#32619406", "title": "Logging to a file in golang", "body": "<p>Since you setup the file in the <code>init</code> function and you have <code>defer f.Close()</code>, the file gets closed after <code>init</code> returns.</p>\n\n<p>you either have to keep the file open or move the whole thing into main.</p>\n"}, {"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1442586284, "post_id": 32644526, "comment_id": 53155317, "body": "s/Linux/unix-like/g or better yet <code>s&#47;Linux&#47;sane OS&#47;g</code>"}, {"owner": {"reputation": 659, "user_id": 1155514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mjZMX.jpg?s=128&g=1", "display_name": "Muhammad Tariq", "link": "https://stackoverflow.com/users/1155514/muhammad-tariq"}, "edited": false, "score": 0, "creation_date": 1606904338, "post_id": 32644526, "comment_id": 115101849, "body": "Is it good idea to create log file in /var/log/myAppLog.log for production ?"}], "tags": [], "owner": {"reputation": 912, "user_id": 1912391, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/890f477cf12dd59c58e326be303f04b6?s=128&d=identicon&r=PG", "display_name": "ZAky", "link": "https://stackoverflow.com/users/1912391/zaky"}, "is_accepted": false, "score": 1, "last_activity_date": 1442554430, "creation_date": 1442554430, "answer_id": 32644526, "question_id": 32619318, "link": "https://stackoverflow.com/questions/32619318/logging-to-a-file-in-golang/32644526#32644526", "title": "Logging to a file in golang", "body": "<p>On Linux\nIn development you can write to stdout and pipe to a file.\nIn production write to syslog.\nBoth ways you dont need to handle the file yourself.</p>\n"}, {"tags": [], "owner": {"reputation": 75, "user_id": 495836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf94462872707bd5550e6900e4e217c8?s=128&d=identicon&r=PG", "display_name": "safepost", "link": "https://stackoverflow.com/users/495836/safepost"}, "is_accepted": false, "score": 0, "last_activity_date": 1611046035, "creation_date": 1611046035, "answer_id": 65788034, "question_id": 32619318, "link": "https://stackoverflow.com/questions/32619318/logging-to-a-file-in-golang/65788034#65788034", "title": "Logging to a file in golang", "body": "<p>If you use logrus you should better use hooks which is recommended by documentation.</p>\n<p>See : <a href=\"https://github.com/rifflock/lfshook\" rel=\"nofollow noreferrer\">https://github.com/rifflock/lfshook</a> for examples.</p>\n<p>In my opinon moving the whole thing to the main is generally not a good idea, instead we want well-segmented code.</p>\n"}], "owner": {"reputation": 91, "user_id": 2780144, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/a93bcfbf0518005fe617e99b27731a1c?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/2780144/craig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14952, "favorite_count": 1, "accepted_answer_id": 32619406, "answer_count": 3, "score": 2, "last_activity_date": 1611046035, "creation_date": 1442440006, "question_id": 32619318, "link": "https://stackoverflow.com/questions/32619318/logging-to-a-file-in-golang", "title": "Logging to a file in golang", "body": "<p>I am starting out with golang, and as I am starting to build out my applciation I want to add logging from the start, and that is where I am running into issues.</p>\n\n<p>If I open a file and use the standard logging library, I am able to write to a file.  Like so.</p>\n\n<pre><code>    package main\n\n\n\n   import (\n        \"os\"\n        \"fmt\"\n        \"log\"\n    )\n\n\n    func main() {\n        // open a file\n        f, err := os.OpenFile(\"test.log\", os.O_APPEND | os.O_CREATE | os.O_RDWR, 0666)\n        if err != nil {\n            fmt.Printf(\"error opening file: %v\", err)\n        }\n\n        // don't forget to close it\n        defer f.Close()\n\n        // assign it to the standard logger\n        log.SetOutput(f)\n\n        log.Output(1, \"this is an event\")\n\n    }\n</code></pre>\n\n<p>I will get my test.log with the log line in it.  However if I try to adapt this to support logrus <a href=\"https://github.com/Sirupsen/logrus\" rel=\"nofollow\">https://github.com/Sirupsen/logrus</a> like this</p>\n\n<pre><code>    package main\n\nimport (\n    \"os\"\n    \"fmt\"\n    log \"github.com/Sirupsen/logrus\"\n)\n\nfunc init() {\n\n    // open a file\n    f, err := os.OpenFile(\"testlogrus.log\", os.O_APPEND | os.O_CREATE | os.O_RDWR, 0666)\n    if err != nil {\n        fmt.Printf(\"error opening file: %v\", err)\n    }\n\n    // don't forget to close it\n    defer f.Close()\n\n    // Log as JSON instead of the default ASCII formatter.\n    log.SetFormatter(&amp;log.JSONFormatter{})\n\n    // Output to stderr instead of stdout, could also be a file.\n    log.SetOutput(f)\n\n    // Only log the warning severity or above.\n    log.SetLevel(log.DebugLevel)\n}\n\n\nfunc main() {\n\n    log.WithFields(log.Fields{\n        \"Animal\": \"Logrus\",\n    }).Info(\"A logrus appears\")\n\n\n}\n</code></pre>\n\n<p>All I will ever see are errors.</p>\n\n<p>Failed to write to log, write testlogrus.log: bad file descriptor</p>\n\n<p>All I ever get is the bad file descriptor error.  Any ideas what I am doing wrong?</p>\n\n<p>Thanks\nCraig</p>\n"}, {"tags": ["go", "println"], "answers": [{"tags": [], "owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "is_accepted": true, "score": 6, "last_activity_date": 1442439066, "creation_date": 1442439066, "answer_id": 32619107, "question_id": 32618724, "link": "https://stackoverflow.com/questions/32618724/whats-the-order-of-this-go-print-statements/32619107#32619107", "title": "What&#39;s the order of this Go print statements?", "body": "<p>This is actually somewhat subtle and had me confused for a second. The \"secret\" is that a function must evaluate all its arguments before it's called. So it calls the function twice to get 9 and 20, but one of those evaluations happens to call Println.</p>\n\n<p>It's fairly straightforward why the language evaluates its arguments before calling a function (that sort of partial application is tricky when side effects are involved, and is mostly reserved for functional languages), but hiding functions with side effects such as printing inside a function evaluation should probably be discouraged just for the purposes of clarity.</p>\n\n<p>The code is perhaps more straightforwardly:</p>\n\n<pre><code>func main() {\n    arg1,arg2 := pow(3,2,10),pow(3,3,20)\n    fmt.Println(arg1, arg2)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 183757, "user_id": 20654, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/94066dfa49c2feb14706cb081848fda7?s=128&d=identicon&r=PG", "display_name": "OscarRyz", "link": "https://stackoverflow.com/users/20654/oscarryz"}, "is_accepted": false, "score": 2, "last_activity_date": 1442440003, "creation_date": 1442440003, "answer_id": 32619317, "question_id": 32618724, "link": "https://stackoverflow.com/questions/32618724/whats-the-order-of-this-go-print-statements/32619317#32619317", "title": "What&#39;s the order of this Go print statements?", "body": "<p><code>fmt.Println()</code>  needs all its parameters before it gets invoked.</p>\n\n<p>So, you have 9, but while you're getting the other value (20) the console prints something else.</p>\n\n<p>Is <a href=\"http://play.golang.org/p/2BnLSL0C7C\" rel=\"nofollow\">just like this</a>:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n\n    fmt.Println(9, f())\n}\nfunc f() int {\n    fmt.Println(\"This gets printed before\")\n    return 20\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>This gets printed before\n9 20\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 5344136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-X5FAA0CQOok/AAAAAAAAAAI/AAAAAAAAAH8/luln8tUF7zc/photo.jpg?sz=128", "display_name": "codybythesea", "link": "https://stackoverflow.com/users/5344136/codybythesea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1292, "favorite_count": 0, "accepted_answer_id": 32619107, "answer_count": 2, "score": 3, "last_activity_date": 1442440003, "creation_date": 1442437658, "question_id": 32618724, "link": "https://stackoverflow.com/questions/32618724/whats-the-order-of-this-go-print-statements", "title": "What&#39;s the order of this Go print statements?", "body": "<p>I'm taking 'A Tour of GO' tutorial about Golang and this code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n)\n\nfunc pow(x, n, lim float64) float64 {\n    if v := math.Pow(x, n); v &lt; lim {\n        return v\n    } else {\n        fmt.Printf(\"%g &gt;= %g\\n\", v, lim)\n    }\n    // can't use v here, though\n    return lim\n}\n\nfunc main() {\n    fmt.Println(\n        pow(3, 2, 10),\n        pow(3, 3, 20),\n    )\n}\n</code></pre>\n\n<p>would print \n\"27 >= 20 9 20\".</p>\n\n<p>I'm rather confused why it's not\n\"9 27 >= 20 20\"</p>\n\n<p>Shouldn't the first call to pow(3,2,10) return 9, print it, then call pow(3,3,20) and print the rest?</p>\n"}, {"tags": ["go", "imap"], "comments": [{"owner": {"reputation": 1665, "user_id": 4638952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03791badf72f6918a8910148dfc4401e?s=128&d=identicon&r=PG&f=1", "display_name": "SnoProblem", "link": "https://stackoverflow.com/users/4638952/snoproblem"}, "edited": false, "score": 1, "creation_date": 1442458419, "post_id": 32615313, "comment_id": 53093895, "body": "There are 5 calls in this code snippet that return error values.  Are you checking them in the actual code?  If so, are all of them returning nil?"}], "answers": [{"comments": [{"owner": {"reputation": 2731, "user_id": 74361, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/adca63afb01fa2d56850114c337476fb?s=128&d=identicon&r=PG", "display_name": "Bart Silverstrim", "link": "https://stackoverflow.com/users/74361/bart-silverstrim"}, "edited": false, "score": 0, "creation_date": 1442499440, "post_id": 32630941, "comment_id": 53114139, "body": "@amt - Some background...yes, I was catching (most of) the errors in question. I started entering my actual source code for analysis in my question when I realized that I did have a mismatched slash (backslash vs forward slash) in my call to copy compared to my Select! I had slash blindness! It doesn&#39;t look like it was triggering an error or oddball response in the call...so I&#39;m going to investigate how to better tease that reply from the server. But it solved my copy part of the equation! Thank you!"}, {"owner": {"reputation": 2731, "user_id": 74361, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/adca63afb01fa2d56850114c337476fb?s=128&d=identicon&r=PG", "display_name": "Bart Silverstrim", "link": "https://stackoverflow.com/users/74361/bart-silverstrim"}, "edited": false, "score": 0, "creation_date": 1442499536, "post_id": 32630941, "comment_id": 53114210, "body": "Re: UID move vs. copy/delete...I don&#39;t see a direct move function in the imap package? Either there would have to be a way to directly enter the raw command or the copy/delete method would have to do, I think...or maybe the copy/delete method is more backwards compatible/safer?"}], "tags": [], "owner": {"reputation": 6958, "user_id": 857727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3772f7ef99bd17c1e77d77edbf76c13d?s=128&d=identicon&r=PG&f=1", "display_name": "arnt", "link": "https://stackoverflow.com/users/857727/arnt"}, "is_accepted": true, "score": 1, "last_activity_date": 1442494807, "creation_date": 1442494807, "answer_id": 32630941, "question_id": 32615313, "link": "https://stackoverflow.com/questions/32615313/golang-imap-moving-messages-to-another-folder/32630941#32630941", "title": "Golang IMAP: moving messages to another folder", "body": "<p>Try to add error checking to the two commands that name mailboxes; the backslash is a special character in source code so I expect gmail is giving you an error such as <code>No such mailbox: [Gmail]Movethese</code>.</p>\n\n<p>Handling errors is generally a good idea, particularly in cases such as this, when you know there <em>is</em> an error somewhere.</p>\n\n<p>BTW, the copy/delete sequence is a bit oldfashioned. Most IMAP servers support <a href=\"https://tools.ietf.org/html/rfc6851\" rel=\"nofollow\">UID MOVE</a> as an atomic command these days, and IIRC gmail is among the supporters. Can't check now, though, so don't trust me.</p>\n"}], "owner": {"reputation": 2731, "user_id": 74361, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/adca63afb01fa2d56850114c337476fb?s=128&d=identicon&r=PG", "display_name": "Bart Silverstrim", "link": "https://stackoverflow.com/users/74361/bart-silverstrim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1217, "favorite_count": 0, "accepted_answer_id": 32630941, "answer_count": 1, "score": 1, "last_activity_date": 1536868300, "creation_date": 1442425520, "last_edit_date": 1536868300, "question_id": 32615313, "link": "https://stackoverflow.com/questions/32615313/golang-imap-moving-messages-to-another-folder", "title": "Golang IMAP: moving messages to another folder", "body": "<p>I'm lost on where to look in the references to accomplish this; I've tried several iterations of code and each fails. Slightly edited, but enough to get the gist...</p>\n\n<pre><code>// Make connection\nimConnection, err := imap.DialTLS(strAddress, nil)\n\n// Defer disconnect\ndefer func(){\n    imConnection.Logout(30*time.Second)\n}\n\n// Authenticate\nimConnection.Login(strUname, strPass)\n\n//Select the folder with messages I want to move\nimConnection.Select(`[Gmail]\\Movethese`, false)\n\n// Create a set\nset, _ = imap.NewSeqSet(\"1:*\")\n\n// It's my understanding that moving messages means copying them over, then\n// deleting the original messages?\ncmd, _ := imConnection.UIDCopy(set, `[Gmail]\\Destination`)\n</code></pre>\n\n<p>This seems to silently fail. This to me looked like it should select everything in the \"Movethese\" folder and copy them to \"Destination.\" What am I missing in properly copying them over? Is there a simple way to move individual messages that match a certain subject line string?</p>\n\n<p>Also I wasn't sure if the source directory would have to be set to False for R/W when selected, but it doesn't seem to make a difference.</p>\n\n<p>This is importing the <a href=\"https://github.com/mxk/go-imap\" rel=\"nofollow noreferrer\">github.com/mxk/go-imap/imap package</a></p>\n"}, {"tags": ["http", "go", "httpresponse", "writer"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1442416777, "post_id": 32612262, "comment_id": 53075939, "body": "This should work. Make sure that the installed version of your <code>infrastructure&#47;routing</code> package is up to date."}, {"owner": {"reputation": 448, "user_id": 4742941, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/03597e35f96065ea034b3baaeb27f908?s=128&d=identicon&r=PG&f=1", "display_name": "leylandski", "link": "https://stackoverflow.com/users/4742941/leylandski"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1442416944, "post_id": 32612262, "comment_id": 53076063, "body": "It&#39;s my own package, and I&#39;ve posted it in full. I don&#39;t understand what the issue could be if it works from a function in the same package but not from one in a different one."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1442417805, "post_id": 32612262, "comment_id": 53076590, "body": "Yes, I mean make sure the installed object files are up to date with <code>go install infrastructure&#47;routing</code> (though if that works, it would be interesting to know why it&#39;s <i>not</i> rebuilding the source). You can also see exactly what&#39;s going on by using the  <code>-x</code> flag when you build/install your <code>main</code> package."}, {"owner": {"reputation": 448, "user_id": 4742941, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/03597e35f96065ea034b3baaeb27f908?s=128&d=identicon&r=PG&f=1", "display_name": "leylandski", "link": "https://stackoverflow.com/users/4742941/leylandski"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1442418029, "post_id": 32612262, "comment_id": 53076730, "body": "Huh. Looks like a clean &amp; build all worked. I&#39;m using LiteIDE and I&#39;ve just been pressing build individually on all the packages I changed. Going to use build all from now on. Thank you!"}, {"owner": {"reputation": 3440, "user_id": 1407735, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7c273f8bbfe205223d4f785dd5e8b830?s=128&d=identicon&r=PG", "display_name": "Marc-Fran&#231;ois", "link": "https://stackoverflow.com/users/1407735/marc-fran%c3%a7ois"}, "edited": false, "score": 0, "creation_date": 1442418114, "post_id": 32612262, "comment_id": 53076789, "body": "Yeah, I tested on my machine and everything works. I get 200 responses. But when I send many requests at the same time, some of the responses are 0 instead of 200. You might want to check that."}], "answers": [{"tags": [], "owner": {"reputation": 448, "user_id": 4742941, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/03597e35f96065ea034b3baaeb27f908?s=128&d=identicon&r=PG&f=1", "display_name": "leylandski", "link": "https://stackoverflow.com/users/4742941/leylandski"}, "is_accepted": false, "score": 1, "last_activity_date": 1442418142, "creation_date": 1442418142, "answer_id": 32613136, "question_id": 32612262, "link": "https://stackoverflow.com/questions/32612262/why-cant-i-write-an-http-response-from-a-seperate-package-in-go/32613136#32613136", "title": "Why can&#39;t I write an HTTP response from a seperate package in Go?", "body": "<p>Well, as it turns out when I was building my code for whatever reason it wasn't keeping the object files updated. I've been using LiteIDE for a while and this is the first time clicking Build on all relevant packages individually hasn't worked.</p>\n\n<p>I cleaned it and then used Build All, now it works.</p>\n"}], "owner": {"reputation": 448, "user_id": 4742941, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/03597e35f96065ea034b3baaeb27f908?s=128&d=identicon&r=PG&f=1", "display_name": "leylandski", "link": "https://stackoverflow.com/users/4742941/leylandski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1442418142, "creation_date": 1442415680, "question_id": 32612262, "link": "https://stackoverflow.com/questions/32612262/why-cant-i-write-an-http-response-from-a-seperate-package-in-go", "title": "Why can&#39;t I write an HTTP response from a seperate package in Go?", "body": "<p>I'm using <a href=\"https://github.com/julienschmidt/httprouter\" rel=\"nofollow\">httprouter</a> to set up an API endpoint, but I'm having some trouble getting it to output a response correctly.</p>\n\n<p>My main file as it stands:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/julienschmidt/httprouter\"\n    \"infrastructure/routing\"\n    \"log\"\n    \"net/http\"\n)\n\nfunc testPrint(w http.ResponseWriter, r *http.Request, p httprouter.Params) {\n    fmt.Fprint(w, \"Test output.\")\n}\n\nfunc main() {\n\n    fmt.Printf(\"\\n************************************\\n\")\n    fmt.Printf(\"MySite Application Server\\n\")\n    fmt.Printf(\"Version: %s\", \"Unversioned Development Build\\n\")\n    fmt.Printf(\"************************************\\n\\n\")\n\n    router := httprouter.New()\n\n    //////Records//////\n    router.GET(\"/test\", testPrint)\n    router.GET(\"/records\", routing.RecordList)\n    router.GET(\"/records/id/:id\", routing.RecordGetById)\n    router.GET(\"/records/name/:name\", routing.RecordGetByName)\n    router.GET(\"/records/search/*search-string\", routing.RecordSearch)\n    router.HEAD(\"/records/:id\", routing.RecordGetExists)\n    router.POST(\"/records\", routing.RecordCreate)\n    router.PATCH(\"/records\", routing.RecordUpdate)\n    router.PUT(\"/records\", routing.RecordUpsert)\n    router.DELETE(\"/records/:id\", routing.RecordDelete)\n    router.DELETE(\"/records/:id/undelete\", routing.RecordUndelete)\n    router.DELETE(\"/records/:id/purge\", routing.RecordPurge)\n\n    fmt.Printf(\"Listening on port 8080...\\n\")\n    log.Fatal(http.ListenAndServe(\":8080\", router))\n\n}\n</code></pre>\n\n<p><em>Most</em> of the handler functions are located in <code>infrastructure/routing</code>, but this is where the problem starts. The code for routing is currently:</p>\n\n<pre><code>package routing\n\nimport (\n    \"fmt\"\n    \"github.com/julienschmidt/httprouter\"\n    \"net/http\"\n)\n\nfunc RecordList(w http.ResponseWriter, r *http.Request, _ httprouter.Params) {\n    //Returns a list of records.\n    fmt.Fprint(w, \"Returned a list of records.\")\n}\n\nfunc RecordGetById(w http.ResponseWriter, r *http.Request, params httprouter.Params) {\n    //Return a record with the specified ID.\n    w.Write([]byte(\"Returned a record by its ID.\"))\n}\n\nfunc RecordGetByName(w http.ResponseWriter, r *http.Request, params httprouter.Params) {\n    //Returns a record with the specified string in the name field.\n    w.Write([]byte(\"Returned a record by its name.\"))\n}\n\nfunc RecordSearch(w http.ResponseWriter, r *http.Request, params httprouter.Params) {\n    //Full text search for the search term provided.\n    w.Write([]byte(\"Search results.\"))\n}\n\nfunc RecordGetExists(w http.ResponseWriter, r *http.Request, params httprouter.Params) {\n    //Returns whether a record exists.\n    w.Write([]byte(\"Returns whether a record exists. Should usually return 200 or 404.\"))\n}\n\nfunc RecordCreate(w http.ResponseWriter, r *http.Request, params httprouter.Params) {\n    //Creates new records from JSON data in request body.\n    w.Write([]byte(\"Creates new records.\"))\n}\n\nfunc RecordUpdate(w http.ResponseWriter, r *http.Request, params httprouter.Params) {\n    //Updates records using JSON data in request body.\n    w.Write([]byte(\"Updates existing records.\"))\n}\n\nfunc RecordUpsert(w http.ResponseWriter, r *http.Request, params httprouter.Params) {\n    //Updates existing records and creates new ones using JSON data in request body.\n    w.Write([]byte(\"Upserts records.\"))\n}\n\nfunc RecordDelete(w http.ResponseWriter, r *http.Request, params httprouter.Params) {\n    //Marks the record with the specified ID as deleted.\n    w.Write([]byte(\"Marks records as deleted.\"))\n}\n\nfunc RecordUndelete(w http.ResponseWriter, r *http.Request, params httprouter.Params) {\n    //Marks the record with the specified ID as undeleted.\n    w.Write([]byte(\"Marks deleted records as undeleted.\"))\n}\n\nfunc RecordPurge(w http.ResponseWriter, r *http.Request, params httprouter.Params) {\n    //Permanently deletes the record with the specified ID.\n    w.Write([]byte(\"Permanently deletes record with given ID.\"))\n}\n</code></pre>\n\n<p>When I make a request to <strong>localhost:8080/test</strong>, it calls the handler function in the main package and prints \"Test output.\". But any of the other defined URLs return a <code>200 OK</code> status code and an empty (0 bytes) response body instead of the expected text.</p>\n\n<p>I'm fairly sure this is <em>something</em> to do with the <code>ResponseWriter</code> object being passed through but I can't figure out why it works for one function in the same package but not another function in a different package, even though both functions have a copy of the writer passed through. I've tried a few different ways of writing including <code>fmt.FPrintf</code>, <code>io.WriteString</code>, and <code>w.Write</code>, to no avail.</p>\n"}, {"tags": ["dictionary", "go", "interface", "range", "slice"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1442418448, "post_id": 32611829, "comment_id": 53077011, "body": "I don&#39;t quite get your question. Do you want to get a list of all keys in all maps, list of values, or what?"}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1442421261, "post_id": 32613914, "comment_id": 53078911, "body": "You&#39;re making things slower by using reflect, and still have a type assertion that might panic. If you know the type, skip the reflection altogether."}], "tags": [], "owner": {"reputation": 13457, "user_id": 954376, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/08PZK.jpg?s=128&g=1", "display_name": "NeoWang", "link": "https://stackoverflow.com/users/954376/neowang"}, "is_accepted": false, "score": 0, "last_activity_date": 1442420612, "creation_date": 1442420612, "answer_id": 32613914, "question_id": 32611829, "link": "https://stackoverflow.com/questions/32611829/iterate-through-a-map-of-interface-that-contains-different-levels-of-maps/32613914#32613914", "title": "Iterate through a map of interface that contains different levels of maps", "body": "<p>You can use reflect:</p>\n\n<pre><code>import \"reflect\"\n\nfunc sanitize_map(m map[string]interface{}) map[string]interface{} {\n    for k, v := range m {\n        // Do something with the key k\n        kind := reflect.ValueOf(v).Kind()\n        if kind == reflect.Map {\n             // You have to be sure the value is of type map[string]interface{}\n             newValue := v.(map[string]interface{})\n             // recursively call sanitize\n             sanitize_map(newValue)\n        }\n    }\n    return m\n}\n</code></pre>\n\n<p>The carveat is: every value in the map has to be either <strong>not</strong> a <code>map</code> (atom) or a <code>map[string]interface{}</code>. Note <code>map[string]interface{}</code> and <code>map[string]map[string]interface{}</code> are completely unrelated types, and you cannot use a type assertion of the second type on the first one.</p>\n\n<p>However, you can put a <code>map[string]map[string]string</code> in a <code>map[string]interface{}</code>, like this:</p>\n\n<pre><code>innerMap1 := make(map[string]interface{})\n// map to strings\ninnerMap1[\"a\"] = \"String 1\"\ninnerMap2 := make(map[string]interface{})\n// set mappings, maybe to other types\n\nouterMap := make(map[string]interface{})\nouterMap[\"ABC\"] = innerMap1\nouterMap[\"DEF\"] = innerMap2\n</code></pre>\n\n<p>Now you can pass outerMap to the function, and reflect will automatically \"strip\" the layers of maps for you.</p>\n"}, {"comments": [{"owner": {"reputation": 13457, "user_id": 954376, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/08PZK.jpg?s=128&g=1", "display_name": "NeoWang", "link": "https://stackoverflow.com/users/954376/neowang"}, "edited": false, "score": 0, "creation_date": 1442461919, "post_id": 32614473, "comment_id": 53094713, "body": "Your solution will fail at the end of recursion, when <code>v</code> is not a map.  With recursion, you always need a terminating condition."}, {"owner": {"reputation": 13457, "user_id": 954376, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/08PZK.jpg?s=128&g=1", "display_name": "NeoWang", "link": "https://stackoverflow.com/users/954376/neowang"}, "edited": false, "score": 0, "creation_date": 1442462133, "post_id": 32614473, "comment_id": 53094758, "body": "I see you use type assertion failure to end the recursion. OK, scratch my last comment. I thought OP may want to do something special when <code>v</code> is an atom."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1442422543, "creation_date": 1442422543, "answer_id": 32614473, "question_id": 32611829, "link": "https://stackoverflow.com/questions/32611829/iterate-through-a-map-of-interface-that-contains-different-levels-of-maps/32614473#32614473", "title": "Iterate through a map of interface that contains different levels of maps", "body": "<p>No need for reflection; use a <a href=\"http://golang.org/ref/spec#Type_assertions\" rel=\"nofollow\">type assertion</a> and pass the value back to your sanitize function</p>\n\n<pre><code>func sanitizeMap(m map[string]interface{}) map[string]interface{} {\n    for k, v := range m {\n        _ = k\n        if v, ok := v.(map[string]interface{}); ok {\n            sanitizeMap(v)\n        }\n    }\n    return m\n}\n</code></pre>\n"}], "owner": {"reputation": 305, "user_id": 3342213, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/787dca87f677ecd27581651d9f0443c0?s=128&d=identicon&r=PG&f=1", "display_name": "KNgu", "link": "https://stackoverflow.com/users/3342213/kngu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 555, "favorite_count": 0, "accepted_answer_id": 32614473, "answer_count": 2, "score": 1, "last_activity_date": 1442422543, "creation_date": 1442414567, "last_edit_date": 1442416487, "question_id": 32611829, "link": "https://stackoverflow.com/questions/32611829/iterate-through-a-map-of-interface-that-contains-different-levels-of-maps", "title": "Iterate through a map of interface that contains different levels of maps", "body": "<p>So lets say I have a map of interface like this:</p>\n\n<pre><code>c := map[string]interface{} {\n    \"test\":    test,\n    \"test2\":   test2,\n}\n</code></pre>\n\n<p>Assuming that <code>test</code> is a <code>map[string]map[string]map[string]string</code> and <code>test2</code> is <code>map[string]string</code>. </p>\n\n<p>How would I create a for loop that would enumerate each index of the map and would enumerate through each index's map also?</p>\n\n<p>So far I have gotten:</p>\n\n<pre><code>func sanitize_map(m map[string]interface{}) map[string]interface{} {\n    for k, v := range m {\n    //Here is where I want to enumerate through the map of k\n    }\n    return m\n}\n</code></pre>\n"}, {"tags": ["multithreading", "go", "concurrency", "worker"], "comments": [{"owner": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "edited": false, "score": 0, "creation_date": 1442383636, "post_id": 32600873, "comment_id": 53054170, "body": "Most likely there is some overhead for using a worker thread, and the job done by each worker thread is so trivial that the overhead takes more time than the actual job. There may also be overhead for synchronizing between threads, and with one thread only this synchronisation doesn&#39;t happen at all."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1442383815, "post_id": 32600873, "comment_id": 53054241, "body": "I don&#39;t know anything about Go, but it sounds like a synchronization issue, that your worker threads don&#39;t really work in parallel but in serial."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1131435"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1442383856, "post_id": 32600873, "comment_id": 53054261, "body": "@JoachimPileborg If that were the case, shouldn&#39;t it take the same amount of time no matter how many available threads were allocated?"}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 1, "creation_date": 1442386450, "post_id": 32600873, "comment_id": 53055482, "body": "you need remove the <code>waitGroup</code>, or goroutine schedule and synchronization problem is mixed, making the testing too complex."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1131435"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1442388303, "post_id": 32600873, "comment_id": 53056496, "body": "@JiangYD How would you suggest waiting for all tasks to finish without exiting early, instead?"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 1, "creation_date": 1442391247, "post_id": 32600873, "comment_id": 53058147, "body": "Your way of using the wait group is weird. <a href=\"http://play.golang.org/p/I6I-sKhMTE\" rel=\"nofollow noreferrer\">Here&#39;s how it&#39;s normally done</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1131435"}, "reply_to_user": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1442393399, "post_id": 32600873, "comment_id": 53059429, "body": "@thwd I can see why that makes more sense."}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1442393696, "post_id": 32600873, "comment_id": 53059655, "body": "@Emrakul well, because your channel just have one slot, <code>fibNum &lt;- rand.Intn(1000)</code> will block till the channel being empty. so considering you have 500000 tasks, just print time-stamp after send the 500000 numbers is ok. i.e. just remove all waitgroup operations."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1131435"}, "edited": false, "score": 0, "creation_date": 1442393450, "post_id": 32601423, "comment_id": 53059480, "body": "Is there something being blocked that requires calling the scheduler? And/or shouldn&#39;t the program be using the four threads it&#39;s allocated either way?"}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": -1, "last_activity_date": 1442385764, "creation_date": 1442385764, "answer_id": 32601423, "question_id": 32600873, "link": "https://stackoverflow.com/questions/32600873/why-does-this-program-run-faster-when-its-allocated-fewer-threads/32601423#32601423", "title": "Why does this program run faster when it&#39;s allocated fewer threads?", "body": "<p>Your main computation routine in <code>worker</code> does not allow the scheduler to run.\nCalling the scheduler manually like</p>\n\n<pre><code>    for i := 0; i &lt; tgt; i++ {\n        a, b = a+b, a\n        if i%300 == 0 {\n            runtime.Gosched()\n        }\n    }\n</code></pre>\n\n<p>Reduces wall clock by 30% when switching from one to two threads.</p>\n\n<p>Such artificial microbenchmarks are really hard to get right.  </p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1131435"}, "edited": false, "score": 0, "creation_date": 1442397307, "post_id": 32604890, "comment_id": 53061974, "body": "Well that&#39;s an interesting result. I see where this could originate. This is a lot to ask, but do you have any resources on hand discussing the threshold after which multithreading is appropriate?"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1442399827, "post_id": 32604890, "comment_id": 53063600, "body": "No, I don&#39;t know any good articles on that topic. You could tweak your program to the point where 1 and 8 threads time the same and then calculate the amount of cycles of work. This should then be equivalent to the amount of cycles synchronization takes on average. In broad terms, for any real-world program that performs some IO, synchronization costs should be dwarfed by that work."}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": true, "score": 4, "last_activity_date": 1442396964, "last_edit_date": 1442396964, "creation_date": 1442396250, "answer_id": 32604890, "question_id": 32600873, "link": "https://stackoverflow.com/questions/32600873/why-does-this-program-run-faster-when-its-allocated-fewer-threads/32604890#32604890", "title": "Why does this program run faster when it&#39;s allocated fewer threads?", "body": "<p>I revised your program to look like the following:</p>\n\n<pre><code>package main\n\nimport (\n    \"math/rand\"\n    \"runtime\"\n    \"sync\"\n    \"time\"\n)\n\nvar workerWG sync.WaitGroup\n\nfunc worker(fibNum chan int) {\n    for tgt := range fibNum {\n        var a, b float64 = 0, 1\n        for i := 0; i &lt; tgt; i++ {\n            a, b = a+b, a\n        }\n    }\n    workerWG.Done()\n}\n\nfunc main() {\n    rand.Seed(time.Now().UnixNano())\n    runtime.GOMAXPROCS(1) // LINE IN QUESTION\n\n    var fibNum = make(chan int)\n\n    for i := 0; i &lt; 4; i++ {\n        go worker(fibNum)\n        workerWG.Add(1)\n    }\n    for i := 0; i &lt; 500000; i++ {\n        fibNum &lt;- rand.Intn(100000)\n    }\n    close(fibNum)\n    workerWG.Wait()\n}\n</code></pre>\n\n<ul>\n<li>I cleaned up the wait group usage.</li>\n<li>I changed <code>rand.Intn(1000)</code> to <code>rand.Intn(100000)</code></li>\n</ul>\n\n<p>On my machine that produces:</p>\n\n<pre><code>$ time go run threading.go (GOMAXPROCS=1)\n\nreal    0m20.934s\nuser    0m20.932s\nsys 0m0.012s\n\n$ time go run threading.go (GOMAXPROCS=8)\n\nreal    0m10.634s\nuser    0m44.184s\nsys 0m1.928s\n</code></pre>\n\n<p>This means that in your original code, the work performed vs synchronization (channel read/write) was negligible. The slowdown came from having to synchronize across threads instead of one and only perform a very small amount of work inbetween.</p>\n\n<p>In essence, synchronization is expensive compared to calculating  fibonacci numbers up to 1000. This is why people tend to discourage micro-benchmarks. Upping that number gives a better perspective. But an even better idea is to benchmark actual work being done i.e. including IO, syscalls, processing, crunching, writing output, formatting, etc.</p>\n\n<p>Edit: As an experiment, I upped the number of workers to 8 with GOMAXPROCS set to 8 and the result was:</p>\n\n<pre><code>$ time go run threading.go \n\nreal    0m4.971s\nuser    0m35.692s\nsys 0m0.044s\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1665, "user_id": 4638952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03791badf72f6918a8910148dfc4401e?s=128&d=identicon&r=PG&f=1", "display_name": "SnoProblem", "link": "https://stackoverflow.com/users/4638952/snoproblem"}, "is_accepted": false, "score": 1, "last_activity_date": 1442478015, "creation_date": 1442478015, "answer_id": 32625584, "question_id": 32600873, "link": "https://stackoverflow.com/questions/32600873/why-does-this-program-run-faster-when-its-allocated-fewer-threads/32625584#32625584", "title": "Why does this program run faster when it&#39;s allocated fewer threads?", "body": "<p>The code written by @thwd is correct and idiomatic Go.  </p>\n\n<p>Your code was being serialized due to the atomic nature of sync.WaitGroup.  Both <code>workerWG.Add(1)</code> and <code>workerWG.Done()</code> will block until they're able to atomically update the internal counter.  </p>\n\n<ul>\n<li>Since the workload is between 0 and 1000 recursive calls, the bottleneck of a single core was enough to keep data races on the waitgroup counter to a minimum.  </li>\n<li>On multiple cores, the processor spends a lot of time spinning to fix the collisions of waitgroup calls.  Add that to the fact that the waitgroup counter is kept on one core and you now have added communication between cores (taking up even more cycles).  </li>\n</ul>\n\n<p>A couple hints for simplifying code:  </p>\n\n<ul>\n<li>For a small, set number of goroutines, a complete channel (<code>chan struct{}</code> to avoid allocations) is cheaper to use.  </li>\n<li>Use the send channel close as a kill signal for goroutines and have them signal that they've exited (waitgroup or channel).  Then, close to complete channel to free them up for the GC.  </li>\n<li>If you need a waitgroup, aggressively minimize the number of calls to it.  Those calls must be internally serialized, so extra calls forces added synchronization.</li>\n</ul>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1131435"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 32604890, "answer_count": 3, "score": 4, "last_activity_date": 1442478015, "creation_date": 1442383423, "last_edit_date": 1442383728, "question_id": 32600873, "link": "https://stackoverflow.com/questions/32600873/why-does-this-program-run-faster-when-its-allocated-fewer-threads", "title": "Why does this program run faster when it&#39;s allocated fewer threads?", "body": "<p>I have a fairly simple Go program designed to compute random Fibonacci numbers to test some strange behavior I observed in a worker pool I wrote. <strong>When I allocate one thread, the program finishes in 1.78s. When I allocate 4, it finishes in 9.88s.</strong></p>\n\n<p>The code is as follows:</p>\n\n<pre><code>var workerWG sync.WaitGroup\n\nfunc worker(fibNum chan int) {\n    for {\n        var tgt = &lt;-fibNum\n        workerWG.Add(1)\n        var a, b float64 = 0, 1\n        for i := 0; i &lt; tgt; i++ {\n            a, b = a+b, a\n        }\n        workerWG.Done()\n    }\n}\n\nfunc main() {\n    rand.Seed(time.Now().UnixNano())\n    runtime.GOMAXPROCS(1) // LINE IN QUESTION\n\n    var fibNum = make(chan int)\n\n    for i := 0; i &lt; 4; i++ {\n        go worker(fibNum)\n    }\n    for i := 0; i &lt; 500000; i++ {\n        fibNum &lt;- rand.Intn(1000)\n    }\n    workerWG.Wait()\n}\n</code></pre>\n\n<p>If I replace <code>runtime.GOMAXPROCS(1)</code> with <code>4</code>, the program takes four times as long to run.</p>\n\n<p>What's going on here? Why does <em>adding</em> more available threads to a worker pool slow the entire pool down? </p>\n\n<p>My personal theory is that it has to do with the processing time of the worker being less than the overhead of thread management, but I'm not sure. My reservation is caused by the following test:</p>\n\n<p>When I replace the <code>worker</code> function with the following code:</p>\n\n<pre><code>for {\n    &lt;-fibNum\n    time.Sleep(500 * time.Millisecond)\n}\n</code></pre>\n\n<p>both one available thread and four available threads take the same amount of time. </p>\n"}, {"tags": ["dictionary", "go", "hashmap"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 17, "last_activity_date": 1442386913, "last_edit_date": 1442386913, "creation_date": 1442383114, "answer_id": 32600807, "question_id": 32600763, "link": "https://stackoverflow.com/questions/32600763/maximum-number-of-elements-in-map/32600807#32600807", "title": "Maximum number of elements in map", "body": "<p>There is no theoretical limit to the number of elements in a map except the maximum value of the map-length type which is <code>int</code>. The max value of <code>int</code> depends on the target architecture you compile to, it may be <code>1 &lt;&lt; 31 - 1 = 2147483647</code> in case of 32 bit, and <code>1 &lt;&lt; 63 - 1 = 9223372036854775807</code> in case of 64 bit.</p>\n\n<p>Note that as an implementation restriction you may not be able to add exactly max-int elements, but the order of magnitude will be the same.</p>\n\n<p>Since the builtin <code>map</code> type uses a hashmap implementation, access time complexity is usually O(1), so it is perfectly fine to add many elements to a map, you can still access elements very fast. Note that however adding many elements will cause a rehashing and rebuilding the internals, which will require some additional calculations - which may happen occasionally when adding new keys to the map.</p>\n\n<p>If you can \"guess\" or estimate the size of your map, you can create your map with a big capacity to avoid rehashing. E.g. you can create a map with space for a million elements like this:</p>\n\n<pre><code>m := make(map[string]int, 1e6)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 1, "last_activity_date": 1442385921, "creation_date": 1442385921, "answer_id": 32601466, "question_id": 32600763, "link": "https://stackoverflow.com/questions/32600763/maximum-number-of-elements-in-map/32601466#32601466", "title": "Maximum number of elements in map", "body": "<p>\"A maximum number\"? Practically no.</p>\n\n<p>\"A good idea\"? Measure, there cannot be a general answer.</p>\n"}], "owner": {"reputation": 421, "user_id": 2873262, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5f8b8419c1469cda8acef2c3a8546d4e?s=128&d=identicon&r=PG&f=1", "display_name": "Sunil", "link": "https://stackoverflow.com/users/2873262/sunil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6136, "favorite_count": 1, "accepted_answer_id": 32600807, "answer_count": 2, "score": 3, "last_activity_date": 1536935170, "creation_date": 1442382914, "last_edit_date": 1536935170, "question_id": 32600763, "link": "https://stackoverflow.com/questions/32600763/maximum-number-of-elements-in-map", "title": "Maximum number of elements in map", "body": "<p>What is the maximum number of elements that can be stored in a Map in GO? If I need to access data from Map frequently, is it a good idea to keep on adding items to Map and retrieving from it, in a long running program?</p>\n"}, {"tags": ["go", "process", "stdin"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1442415109, "post_id": 32600547, "comment_id": 53074752, "body": "Does the parent need to do something after starting the child? Normally this is what you&#39;d use the <code>execve</code> syscall for (<code>syscall.Exec</code> in go)."}, {"owner": {"reputation": 1086, "user_id": 974992, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pVJbN.png?s=128&g=1", "display_name": "Dan Doe", "link": "https://stackoverflow.com/users/974992/dan-doe"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1442440503, "post_id": 32600547, "comment_id": 53089349, "body": "Using syscall.Exec was the answer! Thanks very much."}], "answers": [{"tags": [], "owner": {"reputation": 99, "user_id": 524060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c89b01fb690d62919432f902117b7fcb?s=128&d=identicon&r=PG", "display_name": "abiosoft", "link": "https://stackoverflow.com/users/524060/abiosoft"}, "is_accepted": false, "score": 0, "last_activity_date": 1442402903, "creation_date": 1442402903, "answer_id": 32607326, "question_id": 32600547, "link": "https://stackoverflow.com/questions/32600547/pass-stdin-to-child-process-after-killing-parent/32607326#32607326", "title": "Pass Stdin to child process after killing parent", "body": "<p>From my experience, I do not know of a way to get around that for <code>Stdin</code>.  Only <code>Stdout</code> and <code>Stderr</code> works that way. </p>\n\n<p>An alternative is to free the resources being used by the parent process (i.e. to leave it as light as possible) and let it wait for the execution of the child process.</p>\n"}], "owner": {"reputation": 1086, "user_id": 974992, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pVJbN.png?s=128&g=1", "display_name": "Dan Doe", "link": "https://stackoverflow.com/users/974992/dan-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 239, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1442402903, "creation_date": 1442381868, "question_id": 32600547, "link": "https://stackoverflow.com/questions/32600547/pass-stdin-to-child-process-after-killing-parent", "title": "Pass Stdin to child process after killing parent", "body": "<p>I have the following code in Go:</p>\n\n<pre><code>cmd := exec.Command(...)\ncmd.Stdout = os.Stdout\ncmd.Stdin = os.Stdin\ncmd.Stderr = os.Stderr\ncmd.Run()\n</code></pre>\n\n<p>Which spawns another Go program as a child process and sets its Stdin, Stdout, and Stderr to that of the parent. After the child is spawned, I want to kill the parent via <code>os.Exit()</code> in the parent process or <code>syscall.Kill(os.Getppid(), syscall.SIGTERM)</code> in the child. The problem arises after I kill the parent. It seems to close Stdin, so the child can't receive input from the terminal where the parent was spawned.</p>\n\n<p>I can receive input on the child before I kill the parent, so it's definitely the action of killing the parent that closes Stdin. Is there any way I can work around this?</p>\n"}, {"tags": ["unit-testing", "go", "sleep"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 4, "creation_date": 1442373924, "post_id": 32599117, "comment_id": 53051116, "body": "you need have some time to read the api reference.there is a type <code>Duration</code>."}, {"owner": {"reputation": 406, "user_id": 1644647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qZyFl.jpg?s=128&g=1", "display_name": "jabgibson", "link": "https://stackoverflow.com/users/1644647/jabgibson"}, "edited": false, "score": 0, "creation_date": 1442384154, "post_id": 32599117, "comment_id": 53054400, "body": "You can mess with durations, or you could simply subtract int values. time.Now() - time.Now() does not return a time.Second duration."}, {"owner": {"reputation": 2854, "user_id": 41292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/939e50606775eea4b7589dd7aebbd8b3?s=128&d=identicon&r=PG", "display_name": "LenW", "link": "https://stackoverflow.com/users/41292/lenw"}, "edited": false, "score": 0, "creation_date": 1442393188, "post_id": 32599117, "comment_id": 53059296, "body": "It would be interesting to know if your sleep function passes the test ?"}, {"owner": {"reputation": 8684, "user_id": 410747, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4939d91065321d68191a16481ccbd9f2?s=128&d=identicon&r=PG", "display_name": "netbrain", "link": "https://stackoverflow.com/users/410747/netbrain"}, "edited": false, "score": 1, "creation_date": 1442395001, "post_id": 32599117, "comment_id": 53060492, "body": "Why create your own sleep function when time.Sleep() is available?"}], "answers": [{"tags": [], "owner": {"reputation": 406, "user_id": 1644647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qZyFl.jpg?s=128&g=1", "display_name": "jabgibson", "link": "https://stackoverflow.com/users/1644647/jabgibson"}, "is_accepted": false, "score": 1, "last_activity_date": 1442384632, "last_edit_date": 1442384632, "creation_date": 1442383956, "answer_id": 32600995, "question_id": 32599117, "link": "https://stackoverflow.com/questions/32599117/how-to-test-a-sleep-function-in-golang/32600995#32600995", "title": "How to test a sleep function in golang", "body": "<p>If you use time.Unix() which gives you the amount of seconds since the epoch (January 1, 1970 UTC.) then your test should work.</p>\n\n<pre><code>func TestSleep(t *testing.T) {\n    start := time.Now().Unix()\n    mySleepFunction(65)\n    end := time.Now().Unix()\n    if (end - start) != 65{\n        t.Error(\"Incorrect sleep function\")\n    }\n}\n</code></pre>\n\n<p>Currently, your code is subtracting a time.Now() which doesn't return the result you intend. Your test wants simple int values that represent seconds.</p>\n"}, {"comments": [{"owner": {"reputation": 406, "user_id": 1644647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qZyFl.jpg?s=128&g=1", "display_name": "jabgibson", "link": "https://stackoverflow.com/users/1644647/jabgibson"}, "edited": false, "score": 0, "creation_date": 1442384838, "post_id": 32601158, "comment_id": 53054723, "body": "This is the best answer. I didn&#39;t know of the Since function."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 13, "last_activity_date": 1442393651, "last_edit_date": 1442393651, "creation_date": 1442384695, "answer_id": 32601158, "question_id": 32599117, "link": "https://stackoverflow.com/questions/32599117/how-to-test-a-sleep-function-in-golang/32601158#32601158", "title": "How to test a sleep function in golang", "body": "<p><strong>Elapsed time:</strong></p>\n\n<p>The easiest to get the elapsed time since a specific time (<code>start</code>) is to use the <a href=\"https://golang.org/pkg/time/#Since\"><code>time.Since()</code></a> function which returns a <a href=\"https://golang.org/pkg/time/#Duration\"><code>time.Duration</code></a> which has a <a href=\"https://golang.org/pkg/time/#Duration.Seconds\"><code>Duration.Seconds()</code></a> method which returns the duration in seconds as <code>float64</code>.</p>\n\n<p>So in your case the elapsed seconds:</p>\n\n<pre><code>sec := time.Since(start).Seconds()\n</code></pre>\n\n<p><strong>Now on to testing...</strong></p>\n\n<p>When testing sleep-like functions you should take into consideration that after the sleep it is not guaranteed that the code will continue to execute immediately. For example quoting from the doc of <a href=\"https://golang.org/pkg/time/#Sleep\"><code>time.Sleep()</code></a>:</p>\n\n<blockquote>\n  <p>Sleep pauses the current goroutine for <strong>at least</strong> the duration d.</p>\n</blockquote>\n\n<p>So when writing test code for sleep-like functions, I would test like this:</p>\n\n<ul>\n<li>elapsed time should be at least the specified,</li>\n<li>and allow some error margin.</li>\n</ul>\n\n<p>So for example test it like this:</p>\n\n<pre><code>func TestSleep(t *testing.T) {\n    const secSleep = 65.0\n\n    start := time.Now()\n    mySleepFunction(int(secSleep))\n    sec := time.Since(start).Seconds()\n\n    if sec &lt; secSleep || sec &gt; secSleep*1.05 {\n        t.Error(\"Incorrect sleep function\")\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1920, "user_id": 4980029, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5fxH7.png?s=128&g=1", "display_name": "Vrushank Doshi", "link": "https://stackoverflow.com/users/4980029/vrushank-doshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4319, "favorite_count": 0, "answer_count": 2, "score": 7, "last_activity_date": 1442393651, "creation_date": 1442372944, "last_edit_date": 1442387357, "question_id": 32599117, "link": "https://stackoverflow.com/questions/32599117/how-to-test-a-sleep-function-in-golang", "title": "How to test a sleep function in golang", "body": "<p>I have written my own sleep function and want to test it. Following is my code:</p>\n\n<pre><code>func TestSleep(t *testing.T) {\n    start := time.Now()\n    mySleepFunction(65)\n    end := time.Now()\n    if (end - start) != 65 {\n        t.Error(\"Incorrect sleep function\")\n    }\n}\n</code></pre>\n\n<p>This is not working. I am trying to get start time and end time and then compare it with expected time. The expected time will be in seconds. I tried <code>end.Sub(start)</code> but this returns me something like <code>1m30.0909</code>, instead I need <code>90</code> as a result. It would be great if someone could help me.\nThanks :)</p>\n"}, {"tags": ["json", "struct", "go"], "comments": [{"owner": {"reputation": 1800, "user_id": 893231, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eeca0a8dbb5aa977cba945aeffd3caa8?s=128&d=identicon&r=PG", "display_name": "sbrichards", "link": "https://stackoverflow.com/users/893231/sbrichards"}, "edited": false, "score": 0, "creation_date": 1442354138, "post_id": 32596255, "comment_id": 53046050, "body": "If I understand your question I believe you could iterate through the Data []struct and treat each one as an interface with an unknown type and use a type switch to access each one : <a href=\"https://golang.org/doc/effective_go.html#type_switch\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html#type_switch</a> so if we reach an element that is a string treat it this way, if its an int treat it this way, etc."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1442354719, "post_id": 32596255, "comment_id": 53046238, "body": "I don&#39;t understand where the keys are that you are referring to. Can you give an example of the input and describe where the keys are in the input?"}, {"owner": {"reputation": 1256, "user_id": 4949938, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7586b74526dc4ef59eb6f8b6d4cb6a94?s=128&d=identicon&r=PG", "display_name": "mxplusb", "link": "https://stackoverflow.com/users/4949938/mxplusb"}, "edited": false, "score": 0, "creation_date": 1442355172, "post_id": 32596255, "comment_id": 53046386, "body": "sorry, I was calling them keys because I was thinking of key value pairs, I fixed it! I would like to print out the structure field name."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1442355185, "post_id": 32596255, "comment_id": 53046389, "body": "That is going to require reflection. The iteration is for the array of those objects, <code>key, value</code> are actually getting index and value, the value being the entire object. Inside the loop you then need to use reflect to get all the properties and iterate over them printing their name and value."}, {"owner": {"reputation": 1665, "user_id": 4638952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03791badf72f6918a8910148dfc4401e?s=128&d=identicon&r=PG&f=1", "display_name": "SnoProblem", "link": "https://stackoverflow.com/users/4638952/snoproblem"}, "edited": false, "score": 0, "creation_date": 1442355187, "post_id": 32596255, "comment_id": 53046390, "body": "The loop will range over the slice of <code>Data struct</code> objects, not the fields within the struct.  Inside your loop, <code>fmt.Println(value.Width)</code> will print out <code>1234</code> as you expect.  Simply access the field you want with the name you&#39;ve given it in the struct.  <code>json.Unmarshal(jsonFile, &amp;jsonParser)</code> will match the json keys to the struct fields and fill the struct."}], "answers": [{"comments": [{"owner": {"reputation": 1256, "user_id": 4949938, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7586b74526dc4ef59eb6f8b6d4cb6a94?s=128&d=identicon&r=PG", "display_name": "mxplusb", "link": "https://stackoverflow.com/users/4949938/mxplusb"}, "edited": false, "score": 0, "creation_date": 1442355933, "post_id": 32596612, "comment_id": 53046648, "body": "your code doesn&#39;t work at all, but I understand what you&#39;re getting at! Thanks!"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 1256, "user_id": 4949938, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7586b74526dc4ef59eb6f8b6d4cb6a94?s=128&d=identicon&r=PG", "display_name": "mxplusb", "link": "https://stackoverflow.com/users/4949938/mxplusb"}, "edited": false, "score": 0, "creation_date": 1442358308, "post_id": 32596612, "comment_id": 53047348, "body": "@mynameismevin yeah sorry, I had to go to a meeting before I was able to finish editing/writing that. I&#39;ll edit it if I have a minute."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 1256, "user_id": 4949938, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7586b74526dc4ef59eb6f8b6d4cb6a94?s=128&d=identicon&r=PG", "display_name": "mxplusb", "link": "https://stackoverflow.com/users/4949938/mxplusb"}, "edited": false, "score": 1, "creation_date": 1442358644, "post_id": 32596612, "comment_id": 53047459, "body": "@mynameismevin I believe it should work now. Just a couple typos from me copying the example in that blog. If it were easier to instantiate your type I&#39;d test it further but I don&#39;t have time to mock out a bunch of data for it."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 1256, "user_id": 4949938, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7586b74526dc4ef59eb6f8b6d4cb6a94?s=128&d=identicon&r=PG", "display_name": "mxplusb", "link": "https://stackoverflow.com/users/4949938/mxplusb"}, "edited": false, "score": 0, "creation_date": 1442433692, "post_id": 32596612, "comment_id": 53085926, "body": "@mynameismevin keep in mind that using reflection is slow, and it would be slightly more efficient to use <code>Data []map[string]interface{}</code> and type assert it."}, {"owner": {"reputation": 1256, "user_id": 4949938, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7586b74526dc4ef59eb6f8b6d4cb6a94?s=128&d=identicon&r=PG", "display_name": "mxplusb", "link": "https://stackoverflow.com/users/4949938/mxplusb"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1442441100, "post_id": 32596612, "comment_id": 53089595, "body": "@OneOfOne thanks! I&#39;m not very good with type assertion in golang just yet, but I appreciate it! do you have a link to a good type assertion of structures?"}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 6, "last_activity_date": 1442358656, "last_edit_date": 1442358656, "creation_date": 1442355422, "answer_id": 32596612, "question_id": 32596255, "link": "https://stackoverflow.com/questions/32596255/looping-with-nested-struct-in-go/32596612#32596612", "title": "looping with nested []struct in Go?", "body": "<p>This code based off an example here should do it for you; <a href=\"http://blog.golang.org/laws-of-reflection\" rel=\"noreferrer\">http://blog.golang.org/laws-of-reflection</a></p>\n\n<pre><code>import \"reflect\"\n\n\nfor _, value := range jsonParser.Data {\n            s := reflect.ValueOf(&amp;value).Elem()\n            typeOfT := s.Type()\n            for i := 0; i &lt; s.NumField(); i++ {\n            f := s.Field(i)\n            fmt.Print(\"key: \", typeOfT.Field(i).Name, \"\\n\")\n            fmt.Print(\"value: \", f.Interface(), \"\\n\")\n       }\n\n}\n</code></pre>\n\n<p>Note that in your original code the loop is iterating items in the slice called <code>Data</code>. Each of those things an object of that anonymous struct type. You're not dealing with the fields at that point, from there, you can leverage the <code>reflect</code> package to print the names and values of fields in the struct. You can't just <code>range</code> over a struct natively, the operation isn't defined.</p>\n"}, {"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 1, "last_activity_date": 1442540387, "creation_date": 1442540387, "answer_id": 32642545, "question_id": 32596255, "link": "https://stackoverflow.com/questions/32596255/looping-with-nested-struct-in-go/32642545#32642545", "title": "looping with nested []struct in Go?", "body": "<p>This is an alternative approach that we discussed in the comments:</p>\n\n<p>Keep in mind that while this is faster than reflection, it's still better and more efficient to use the struct fields directly and make it a pointer (<code>Data []*struct{....}</code>).</p>\n\n<pre><code>type ImgurJson struct {\n    Status  int16                    `json:\"status\"`\n    Success bool                     `json:\"success\"`\n    Data    []map[string]interface{} `json:\"data\"`\n}\n//.....\nfor i, d := range ij.Data {\n    fmt.Println(i, \":\")\n    for k, v := range d {\n        fmt.Printf(\"\\t%s: \", k)\n        switch v := v.(type) {\n        case float64:\n            fmt.Printf(\"%v (number)\\n\", v)\n        case string:\n            fmt.Printf(\"%v (str)\\n\", v)\n        case bool:\n            fmt.Printf(\"%v (bool)\\n\", v)\n        default:\n            fmt.Printf(\"%v (%T)\\n\", v, v)\n        }\n    }\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/_7O_0EjVvM\" rel=\"nofollow\"><kbd>playground</kbd></a></p>\n"}, {"tags": [], "owner": {"reputation": 607, "user_id": 5164776, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/999423470091088/picture?type=large", "display_name": "Chandan Kumar", "link": "https://stackoverflow.com/users/5164776/chandan-kumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1559394876, "creation_date": 1559394876, "answer_id": 56407091, "question_id": 32596255, "link": "https://stackoverflow.com/questions/32596255/looping-with-nested-struct-in-go/56407091#56407091", "title": "looping with nested []struct in Go?", "body": "<p>You can also iterate using normal golang for loop on nested struct.</p>\n\n<pre><code>type ImgurJson struct {\n      Status int16 `json:\"status\"`\n      Success bool `json:\"success\"`\n      Data []struct {\n            Width int16 `json:\"width\"`\n            Points int32 `json:\"points\"`\n            CommentCount int32 `json:\"comment_count\"`\n            TopicId int32 `json:\"topic_id\"`\n            AccountId int32 `json:\"account_id\"`\n            Ups int32 `json:\"ups\"`\n            Downs int32 `json:\"downs\"`\n            Bandwidth int64 `json:\"bandwidth\"`\n            Datetime int64 `json:\"datetime\"`\n            Score int64 `json:\"score\"`\n            Account_Url string `json:\"account_url\"`\n            Topic string `json:\"topic\"`\n            Link string `json:\"link\"`\n            Id string `json:\"id\"`\n            Description string`json:\"description\"`\n            CommentPreview string `json:\"comment_preview\"`\n            Vote string `json:\"vote\"`\n            Title string `json:\"title\"`\n            Section string `json:\"section\"`\n            Favorite bool `json:\"favorite\"`\n            Is_Album bool `json:\"is_album\"`\n            Nsfw bool `json:\"nsfw\"`\n             } `json:\"data\"`\n}\n\nfunc parseJson(file string) {\n      jsonFile, err := ioutil.ReadFile(file)\n      if err != nil {\n            ...\n            }\n      jsonParser := ImgurJson{}\n      err = json.Unmarshal(jsonFile, &amp;jsonParser)\n      for i :=0; i&lt;len(jsonParser.Data); i++ {\n            fmt.Print(\"key: \", jsonParser.Data[i].TopicId, \"\\n\")\n      }\n}\n</code></pre>\n"}], "owner": {"reputation": 1256, "user_id": 4949938, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7586b74526dc4ef59eb6f8b6d4cb6a94?s=128&d=identicon&r=PG", "display_name": "mxplusb", "link": "https://stackoverflow.com/users/4949938/mxplusb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4076, "favorite_count": 1, "accepted_answer_id": 32596612, "answer_count": 3, "score": 3, "last_activity_date": 1559394876, "creation_date": 1442353725, "last_edit_date": 1442355197, "question_id": 32596255, "link": "https://stackoverflow.com/questions/32596255/looping-with-nested-struct-in-go", "title": "looping with nested []struct in Go?", "body": "<p>I have a structure I'm working with, and I'm not sure how to loop through it properly. I would like to access the field names, but all it is doing is just incrementally counting at each loop.</p>\n\n<p>Here is my structure:</p>\n\n<pre><code>type ImgurJson struct {\n      Status int16 `json:\"status\"`\n      Success bool `json:\"success\"`\n      Data []struct {\n            Width int16 `json:\"width\"`\n            Points int32 `json:\"points\"`\n            CommentCount int32 `json:\"comment_count\"`\n            TopicId int32 `json:\"topic_id\"`\n            AccountId int32 `json:\"account_id\"`\n            Ups int32 `json:\"ups\"`\n            Downs int32 `json:\"downs\"`\n            Bandwidth int64 `json:\"bandwidth\"`\n            Datetime int64 `json:\"datetime\"`\n            Score int64 `json:\"score\"`\n            Account_Url string `json:\"account_url\"`\n            Topic string `json:\"topic\"`\n            Link string `json:\"link\"`\n            Id string `json:\"id\"`\n            Description string`json:\"description\"`\n            CommentPreview string `json:\"comment_preview\"`\n            Vote string `json:\"vote\"`\n            Title string `json:\"title\"`\n            Section string `json:\"section\"`\n            Favorite bool `json:\"favorite\"`\n            Is_Album bool `json:\"is_album\"`\n            Nsfw bool `json:\"nsfw\"`\n             } `json:\"data\"`\n}\n</code></pre>\n\n<p>Here is my function:</p>\n\n<pre><code>func parseJson(file string) {\n      jsonFile, err := ioutil.ReadFile(file)\n      if err != nil {\n            ...\n            }\n      jsonParser := ImgurJson{}\n      err = json.Unmarshal(jsonFile, &amp;jsonParser)\n      for field, value := range jsonParser.Data {\n            fmt.Print(\"key: \", field, \"\\n\")\n            fmt.Print(\"value: \", value, \"\\n\")\n      }\n}\n</code></pre>\n\n<p>How do I loop through a nested, []struct in Go and return the fields? I've seen several posts about reflection, but I don't understand if that would assist me or not. I can return the values of each field, but I don't understand how to map the field name to the key value.</p>\n\n<p>Edit:</p>\n\n<p>Renamed \"keys\" to \"field\", sorry! Didn't realise they were called fields.</p>\n\n<p>I would like to be able to print:</p>\n\n<pre><code>field: Width\nvalue: 1234\n</code></pre>\n\n<p>I would like to learn how to do this so I can later call a specific field by name so I can map it to a SQL column name.</p>\n"}, {"tags": ["macos", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1442351338, "post_id": 32595037, "comment_id": 53044878, "body": "If possible at all, than through C."}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 1, "creation_date": 1442413502, "post_id": 32595037, "comment_id": 53073484, "body": "A .framework bundle contains at its top level a dynamically loaded library. In the case of the system frameworks, this dynamically loaded library&#39;s filename is the base name of the framework, and does not have the typical <code>.dylib</code> extension. If you are willing to use <a href=\"https://github.com/andlabs/dl\" rel=\"nofollow noreferrer\">libdl directly</a>, which means cgo, you can dynamically load this dylib and call its functions directly. But since we&#39;re using cgo at this point, there&#39;s a better way: <code>&#47;&#47;cgo LDFLAGS: -framework CoreWLAN</code> and then use the API directly from cgo."}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 1, "creation_date": 1442413655, "post_id": 32595037, "comment_id": 53073599, "body": "And in fact, looking into it, CoreWLAN&#39;s API is Objective-C based, so you have no choice but to use cgo and do the latter of what I said :/ (Do not try to use the Objective-C runtime API directly; that leads to verbose, unsafe, and nonportable code.)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5076297"}, "edited": false, "score": 0, "creation_date": 1442413668, "post_id": 32595037, "comment_id": 53073607, "body": "I figured I&#39;d need cgo, you should put this as an answer as it&#39;s what I&#39;m definitely going to do. Thanks mang!"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5076297"}, "is_accepted": false, "score": 2, "last_activity_date": 1443448776, "creation_date": 1443448776, "answer_id": 32824929, "question_id": 32595037, "link": "https://stackoverflow.com/questions/32595037/import-osx-bundles-in-golang/32824929#32824929", "title": "Import OSX bundles in golang?", "body": "<p>Andlabs gave an excellent response that he has unfortunately not put in as an answer.</p>\n\n<p>Basically you use cgo like this...</p>\n\n<pre><code>//cgo LDFLAGS: -framework CoreWLAN\n</code></pre>\n\n<p>...and you are able to call into the framework directly. To quote his responses:</p>\n\n<blockquote>\n  <p>A .framework bundle contains at its top level a dynamically loaded library. In the case of the system frameworks, this dynamically loaded library's filename is the base name of the framework, and does not have the typical .dylib extension. If you are willing to use libdl directly, which means cgo, you can dynamically load this dylib and call its functions directly. But since we're using cgo at this point, there's a better way: //cgo LDFLAGS: -framework CoreWLAN and then use the API directly from cgo. \u2013  andlabs</p>\n  \n  <p>And in fact, looking into it, CoreWLAN's API is Objective-C based, so you have no choice but to use cgo and do the latter of what I said :/ (Do not try to use the Objective-C runtime API directly; that leads to verbose, unsafe, and nonportable code.) \u2013  andlabs</p>\n</blockquote>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5076297"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 658, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1443448776, "creation_date": 1442348908, "question_id": 32595037, "link": "https://stackoverflow.com/questions/32595037/import-osx-bundles-in-golang", "title": "Import OSX bundles in golang?", "body": "<p>So, in python if I want to access an OSX bundle I can use the objc module like this:</p>\n\n<pre><code>import objc\nobjc.loadBundle('CoreWLAN', \n       bundle_path='/System/Library/Frameworks/CoreWLAN.framework', \n       module_globals=globals())\n</code></pre>\n\n<p>Is there an elegant way to do this in golang, perhaps with a module? Google is not finding me much. Do I have to call out to this using the C import features of the language? Is this even possible?</p>\n\n<p>My specific situation is that I would like to read WIFI data for available access points, channels, signal strength and signal/noise ratio for talking to the Google Maps Geolocation API.</p>\n"}, {"tags": ["parsing", "time", "go"], "comments": [{"owner": {"reputation": 1739, "user_id": 1074847, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kyb3y.jpg?s=128&g=1", "display_name": "Yauheni Leichanok", "link": "https://stackoverflow.com/users/1074847/yauheni-leichanok"}, "edited": false, "score": 1, "creation_date": 1442339841, "post_id": 32592458, "comment_id": 53038840, "body": "Is it helpful? <a href=\"https://github.com/golang/go/issues/9346\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/9346</a>"}, {"owner": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "reply_to_user": {"reputation": 1739, "user_id": 1074847, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kyb3y.jpg?s=128&g=1", "display_name": "Yauheni Leichanok", "link": "https://stackoverflow.com/users/1074847/yauheni-leichanok"}, "edited": false, "score": 0, "creation_date": 1442345455, "post_id": 32592458, "comment_id": 53041871, "body": "Yes, that was helpful. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 27, "last_activity_date": 1442343762, "last_edit_date": 1442343762, "creation_date": 1442340823, "answer_id": 32592903, "question_id": 32592458, "link": "https://stackoverflow.com/questions/32592458/why-cant-go-parse-the-time-represented-by-the-provided-formats/32592903#32592903", "title": "Why can&#39;t go parse the time represented by the provided formats?", "body": "<p>The <code>time.RFC3339</code> format is a case where the format string itself isn't a valid time. You can't have a <code>Z</code> <em>and</em> an offset in the time string, but the format string has both because the spec can contain either type of timezone specification.</p>\n\n<p>Both of these are valid RFC3339 times:</p>\n\n<pre><code>\"2015-09-15T14:00:12-00:00\"\n\"2015-09-15T14:00:13Z\"\n</code></pre>\n\n<p>And the time package needs to be able to parse them both using the same RFC3339 format string.</p>\n"}, {"tags": [], "owner": {"reputation": 11161, "user_id": 1908967, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vPwiV.jpg?s=128&g=1", "display_name": "Grokify", "link": "https://stackoverflow.com/users/1908967/grokify"}, "is_accepted": false, "score": 5, "last_activity_date": 1522253015, "last_edit_date": 1522253015, "creation_date": 1522252257, "answer_id": 49538984, "question_id": 32592458, "link": "https://stackoverflow.com/questions/32592458/why-cant-go-parse-the-time-represented-by-the-provided-formats/49538984#49538984", "title": "Why can&#39;t go parse the time represented by the provided formats?", "body": "<p>As noted, <code>2006-01-02T15:04:05Z07:00</code> is an invalid <a href=\"https://tools.ietf.org/html/rfc3339\" rel=\"noreferrer\">IETF RFC-3339</a> time format. Here's an explanation.</p>\n\n<p>The reason you cannot have both Z and an offset is that they are both ways to represent a time offset. <code>Z</code> is equivalent to <code>+00:00</code> indicating a zero hour/minute offset, or no offset. You cannot say both <code>+00:00</code> offset and <code>+07:00</code> offset in the same time representation.</p>\n\n<p>The following is the <code>Z</code> definition in the RFC-3339 Section 2:</p>\n\n<p><a href=\"https://tools.ietf.org/html/rfc3339#section-2\" rel=\"noreferrer\">https://tools.ietf.org/html/rfc3339#section-2</a></p>\n\n<pre><code>Z  A suffix which, when applied to a time, denotes a UTC\n   offset of 00:00; often spoken \"Zulu\" from the ICAO\n   phonetic alphabet representation of the letter \"Z\".\n</code></pre>\n\n<p>Of note, while <code>Z</code> is equivalent to <code>+00:00</code>, they are both different from <code>-00:00</code> which indicates known UTC time with an unknown offset, as described in RFC-3339 Section 4.3:</p>\n\n<p><a href=\"https://tools.ietf.org/html/rfc3339#section-4.3\" rel=\"noreferrer\">https://tools.ietf.org/html/rfc3339#section-4.3</a></p>\n\n<pre><code>4.3. Unknown Local Offset Convention\n\n   If the time in UTC is known, but the offset to local time is unknown,\n   this can be represented with an offset of \"-00:00\".  This differs\n   semantically from an offset of \"Z\" or \"+00:00\", which imply that UTC\n   is the preferred reference point for the specified time.  RFC2822\n   [IMAIL-UPDATE] describes a similar convention for email.\n</code></pre>\n"}], "owner": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6899, "favorite_count": 1, "accepted_answer_id": 32592903, "answer_count": 2, "score": 18, "last_activity_date": 1522253015, "creation_date": 1442339086, "last_edit_date": 1442468222, "question_id": 32592458, "link": "https://stackoverflow.com/questions/32592458/why-cant-go-parse-the-time-represented-by-the-provided-formats", "title": "Why can&#39;t go parse the time represented by the provided formats?", "body": "<p>Consider this example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    fmt.Println(time.Parse(time.RFC3339, time.RFC3339))\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>0001-01-01 00:00:00 +0000 UTC parsing time \"2006-01-02T15:04:05Z07:00\": extra text: 07:00\n</code></pre>\n\n<p>Why can't time.Parse() handle a layout as a value? What's missing here?</p>\n\n<hr>\n\n<p><strong>UPDATE:</strong> Cutting off the time zone value (but not the 'Z' delimiting the time from the zone) fixes it:</p>\n\n<pre><code>fmt.Println(time.Parse(time.RFC3339, \"2015-09-15T11:50:00Z\"))\n</code></pre>\n\n<p>Why can't time.Parse() handle time zone info when using time.RFC3339 as the layout string?</p>\n\n<p><a href=\"http://play.golang.org/p/p3fHfJNHVK\" rel=\"noreferrer\">http://play.golang.org/p/p3fHfJNHVK</a></p>\n\n<hr>\n\n<p><strong>UPDATE:</strong> JimB's answer led me to read from RFC3339 and I found these examples that clarify further:</p>\n\n<p>Here are some examples of Internet date/time format.</p>\n\n<blockquote>\n  <p><code>1985-04-12T23:20:50.52Z</code></p>\n  \n  <p>This represents 20 minutes and 50.52 seconds after the 23rd hour of\n  April 12th, 1985 in UTC.</p>\n  \n  <p><code>1996-12-19T16:39:57-08:00</code></p>\n  \n  <p>This represents 39 minutes and 57 seconds after the 16th hour of\n  December 19th, 1996 with an offset of -08:00 from UTC (Pacific\n  Standard Time).  Note that this is equivalent to <code>1996-12-20T00:39:57Z</code>\n  in UTC.</p>\n</blockquote>\n"}, {"tags": ["git", "go", "godeps"], "comments": [{"owner": {"reputation": 38376, "user_id": 275354, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1c9b7128b63f0a8d36ac2f3cc060dfca?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/275354/andy"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1442331638, "post_id": 32589511, "comment_id": 53034158, "body": "My import is uses the full path <code>myplace&#47;myprojectRepo&#47;somePackage</code>.  There are no errors, it just was odd to me that a folder in my repository contained the contents of another folder."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1442331992, "post_id": 32589511, "comment_id": 53034431, "body": "oh sorry, I completely misread what you were saying. You want to <i>stop</i> godep from doing that! There&#39;s probably no way, since godep uses the VCS to manage the files. If you clone <code>myprojectRepo</code>, you&#39;re going to get all the files it contains."}, {"owner": {"reputation": 38376, "user_id": 275354, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1c9b7128b63f0a8d36ac2f3cc060dfca?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/275354/andy"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1442332112, "post_id": 32589511, "comment_id": 53034511, "body": "I&#39;m OK with getting all the files it contains, but with godeps, when I check out <code>myprojectRepo</code>, it has two versions of <code>somePackage.go</code>.  One in the somePackage directory and one in the <code>godeps&#47;_workspace...</code>directory."}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1442367974, "post_id": 32589511, "comment_id": 53049736, "body": "You should run godep from <code>src</code> directory"}], "answers": [{"tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": false, "score": 0, "last_activity_date": 1442407449, "creation_date": 1442407449, "answer_id": 32608976, "question_id": 32589511, "link": "https://stackoverflow.com/questions/32589511/godep-with-local-packages/32608976#32608976", "title": "Godep with local packages", "body": "<blockquote>\n  <p>when I run godep save inside of the someCmd folder</p>\n</blockquote>\n\n<p>Godep will vendor everything that is not a <strong>sub-directory</strong>, it does not goes up to your repository's root.</p>\n\n<p>You have to run <code>godep save ./...</code> from the root of your project : it will save all external dependencies for your project in one place.</p>\n\n<p>As @JimB said, anyway people are gonna be pulling the whole repository at once, not sub-packages by sub-packages. And they should run <code>godep restore</code> from the repository's root too.</p>\n"}], "owner": {"reputation": 38376, "user_id": 275354, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1c9b7128b63f0a8d36ac2f3cc060dfca?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/275354/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1437, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1442407449, "creation_date": 1442329616, "last_edit_date": 1442333939, "question_id": 32589511, "link": "https://stackoverflow.com/questions/32589511/godep-with-local-packages", "title": "Godep with local packages", "body": "<p>I have a repository that looks like this:</p>\n\n<pre><code>src\n|\n|--myplace\n   |--myprojectRepo\n      |--someCmd\n      |      main.go\n      |--somePackage\n      |      package.go\n</code></pre>\n\n<p>I'm trying to use Godeps to manage dependencies.  However, when I run <code>godep save</code> inside of the <code>someCmd</code> folder, it copies not just the external code into the godep <code>_workspace</code>, but also the <code>somePackage</code> code into the godep <code>_workspace</code>.</p>\n\n<p>Is there anyway to stop godep from copying code that is in the same repository into its <code>_workspace</code>?</p>\n\n<p>The main ugliness that I see with this is that now there are  two versions of <code>somePackage.go</code>. One in the <code>somePackage</code> directory and one in the <code>godeps/_workspace...</code> directory.  And if I make a change to <code>somePackage</code>, I have to rerun godep inside of <code>someCmd</code> in order to have those changes pulled in.</p>\n"}, {"tags": ["go", "cuda", "environment", "nvcc", "cgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1442329526, "post_id": 32589153, "comment_id": 53032700, "body": "Have you tried just using the standard CC anc CXX environment variables? (I have no idea if cgo works with cuda in this case, but it should be easy to try)"}, {"owner": {"reputation": 107, "user_id": 4903180, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10206015533888282/picture?type=large", "display_name": "Marco Jammajalla Mangraviti", "link": "https://stackoverflow.com/users/4903180/marco-jammajalla-mangraviti"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1442351232, "post_id": 32589153, "comment_id": 53044836, "body": "Hi, thank you for response. In /etc/profile file i added this:  export PATH=$PATH:/usr/local/cuda-7.0/bin   export CC=nvcc     now this is errore message:               nvcc fatal : Unknown option &#39;dM&#39;"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1442351666, "post_id": 32589153, "comment_id": 53045023, "body": "I wasn&#39;t sure how cuda compiler worked, but it&#39;s obviously not a standard CC replacement. I think you&#39;ll need to compile the cuda code outside of the Go program. (as an aside, you don&#39;t need to edit the global profile to set an environment variable, you don&#39;t even need to export it if you define it with the command)."}], "answers": [{"tags": [], "owner": {"reputation": 309, "user_id": 5166832, "user_type": "registered", "profile_image": "https://graph.facebook.com/688226600/picture?type=large", "display_name": "alfalfasprout", "link": "https://stackoverflow.com/users/5166832/alfalfasprout"}, "is_accepted": false, "score": 2, "last_activity_date": 1448815231, "creation_date": 1448815231, "answer_id": 33985201, "question_id": 32589153, "link": "https://stackoverflow.com/questions/32589153/how-to-compile-cuda-source-with-go-languages-cgo/33985201#33985201", "title": "how to compile Cuda source with Go language&#39;s cgo?", "body": "<p>I finally figured out how to do this. Thing biggest problem is that <code>nvcc</code>does not follow <code>gcc</code> standard flags and unlike <code>clang</code> it won't silently ignore them. <code>cgo</code> triggers the problem by adding a bunch of flags not explicitly specified by the user.</p>\n\n<p>To make it all work, you'll need to separate out your device code and the functions that directly call it into separate files and compile/package them directly using <code>nvcc</code> into a shared library (.so). Then you'll use cgo to link this shared library using whatever default linker you have on your system. The only thing you'll have to add is <code>-lcudart</code> to your <code>LDFLAGS</code> (linker flags) to link the CUDA runtime.  </p>\n"}], "owner": {"reputation": 107, "user_id": 4903180, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10206015533888282/picture?type=large", "display_name": "Marco Jammajalla Mangraviti", "link": "https://stackoverflow.com/users/4903180/marco-jammajalla-mangraviti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 901, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1448815231, "creation_date": 1442328666, "last_edit_date": 1442330784, "question_id": 32589153, "link": "https://stackoverflow.com/questions/32589153/how-to-compile-cuda-source-with-go-languages-cgo", "title": "how to compile Cuda source with Go language&#39;s cgo?", "body": "<p>I wrote a simple program in cuda-c and it works on eclipse nsight. This is source code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;stdio.h&gt;\n\n\n__global__ void add( int a,int b, int *c){\n*c = a + b;\n}\n\nint main(void){\n\nint c;\nint *dev_c;\n\ncudaMalloc((void**)&amp;dev_c, sizeof(int));\n\nadd &lt;&lt;&lt;1,1&gt;&gt;&gt;(2,7,dev_c);\n\ncudaMemcpy(&amp;c, dev_c, sizeof(int),cudaMemcpyDeviceToHost);\n\nprintf(\"\\n2+7= %d\\n\",c);\ncudaFree(dev_c);\n\nreturn 0;\n}\n</code></pre>\n\n<p>Now I'm trying to use this code with Go language with cgo!!!\nSo I wrote this new code:</p>\n\n<pre><code>package main\n\n//#include \"/usr/local/cuda-7.0/include/cuda.h\"\n//#include \"/usr/local/cuda-7.0/include/cuda_runtime.h\"\n//#cgo LDFLAGS: -lcuda\n//#cgo LDFLAGS: -lcurand\n////default location:\n//#cgo LDFLAGS: -L/usr/local/cuda-7.0/lib64 -L/usr/local/cuda-7.0/lib\n//#cgo CFLAGS: -I/usr/local/cuda-7.0/include/\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n/*\n\n#include &lt;stdio.h&gt;\n\n__global__ void add( int a,int b, int *c){\n    *c = a + b;\n}\n\nint esegui_somma(void){\n\n    int c;\n    int *dev_c;\n\n    cudaMalloc((void**)&amp;dev_c, sizeof(int));\n    add &lt;&lt;&lt;1,1&gt;&gt;&gt; (2,7,dev_c);\n    cudaMemcpy(&amp;c, dev_c, sizeof(int),cudaMemcpyDeviceToHost);\n\n    cudaFree(dev_c);\n    return c;\n}\n*/\nimport \"C\"\nimport \"fmt\"\n\nfunc main(){\n    fmt.Printf(\"il risultato \u00e8 %d\",C.esegui_somma)\n}\n</code></pre>\n\n<p>But it doesn't work!!\nI read this error message:</p>\n\n<pre><code>cgo_cudabyexample_1/main.go:34:8: error: expected expression before '&lt;' token\nadd &lt;&lt;&lt;1,1&gt;&gt;&gt; (2,7,dev_c);\n      ^\n</code></pre>\n\n<p>I think that I must to set nvcc cuda compiler for cgo instead of gcc.\nHow can I do it? Can I change CC environment variable?\nbest regards</p>\n"}, {"tags": ["java", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 9, "creation_date": 1442327524, "post_id": 32588120, "comment_id": 53031156, "body": "This is not how you should approach the problem. You should not do &quot;mirror&quot; translation but rather &quot;functional&quot; translation. Annotations in Java attach meta information to different source code elements. But by themselves they worth nothing if there isn&#39;t a code or framework that processes them and does different things based on that. What you should discover is what your Java libraries/frameworks will do with the method that is annotated with <code>@OnKeyWord</code> and try to implement that functionality in Go."}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1442371458, "post_id": 32588120, "comment_id": 53050509, "body": "but, if golang can still add &#39;tag&#39; to struct and func, would be great."}, {"owner": {"reputation": 21, "user_id": 5268629, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2gN6IVGTc5I/AAAAAAAAAAI/AAAAAAAABbE/93yZ5YMzJb0/photo.jpg?sz=128", "display_name": "Sandeep Jaluthairya", "link": "https://stackoverflow.com/users/5268629/sandeep-jaluthairya"}, "edited": false, "score": 1, "creation_date": 1442382434, "post_id": 32588120, "comment_id": 53053726, "body": "<b>icza</b> you are right. I can implement @OnKeyWord functionality with <i>if</i> statement but I was not feeling that this is the good approach. I wanted to know if there is any better method I can use for this."}], "answers": [{"tags": [], "owner": {"reputation": 1652, "user_id": 918176, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2bdb37b11c35de00bb68359342a82f38?s=128&d=identicon&r=PG", "display_name": "user918176", "link": "https://stackoverflow.com/users/918176/user918176"}, "is_accepted": false, "score": 2, "last_activity_date": 1447881477, "creation_date": 1447881477, "answer_id": 33790577, "question_id": 32588120, "link": "https://stackoverflow.com/questions/32588120/how-to-convert-java-annotation-to-go-code/33790577#33790577", "title": "how to convert java annotation to go code?", "body": "<p>After you have done the translation as @icza explained, you wish probably to move the functionality to a middleware (<a href=\"http://www.alexedwards.net/blog/making-and-using-middleware\" rel=\"nofollow\">example</a>) that gets run for all your requests. That way you can add the assisting logic (the \"if\" part) out of your business methods.</p>\n\n<p>There is also no need to implement middlewares for HTTP frameworks yourself. Most web frameworks <a href=\"http://beego.me/docs/mvc/controller/filter.md\" rel=\"nofollow\">include</a> one by <a href=\"https://revel.github.io/manual/filters.html\" rel=\"nofollow\">default</a>. </p>\n"}], "owner": {"reputation": 21, "user_id": 5268629, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2gN6IVGTc5I/AAAAAAAAAAI/AAAAAAAABbE/93yZ5YMzJb0/photo.jpg?sz=128", "display_name": "Sandeep Jaluthairya", "link": "https://stackoverflow.com/users/5268629/sandeep-jaluthairya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1622, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1540248301, "creation_date": 1442325714, "last_edit_date": 1540248301, "question_id": 32588120, "link": "https://stackoverflow.com/questions/32588120/how-to-convert-java-annotation-to-go-code", "title": "how to convert java annotation to go code?", "body": "<p>I'm changing my java project to golang. I'm using a java annotation and want to convert it into go code. I want to know the best data structure in go to convert this annotation.</p>\n\n<p>My code is as follows:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"strconv\"\n    \"time\"\n)\n\nfunc getBody(method string, Id string, auth string, body []byte,timeStamp int64) ([]byte, error) {\n\n    url := \"****************\"+Id+\"***********\"+strconv.FormatInt(timeStamp,10)\n    client := &amp;http.Client{}\n    req, err := http.NewRequest(method, url, bytes.NewReader(body))\n\n    if err != nil {\n        return nil, err\n    }\n\n    var header = make(map[string]string,2)\n    header[\"Accept\"]=\"*******************\"\n    header[\"Authorization\"]=auth\n\n    for key, value := range header {\n        req.Header.Add(key, value)\n    }\n\n    res, err := client.Do(req)\n    defer res.Body.Close()\n\n    if err != nil {\n        return nil, err\n    }\n\n    var bodyBytes []byte\n\n    if res.StatusCode == 200 {\n        bodyBytes, err = ioutil.ReadAll(res.Body)\n    } else if err != nil {\n        return nil, err\n    } else {\n        return nil, fmt.Errorf(\"The remote end did not return a HTTP 200 (OK) response.\")\n    }\n\n    return bodyBytes, nil\n\n}\n\nfunc main() {\n\n    method := \"GET\"\n    auth:=\"************\"\n    var timeStamp int64 = 1441689793403\n    Id:=\"***********\"\n    fmt.Println(timeStamp)\n    var cs int64 = time.Now().UnixNano()/1000000\n    for{\n        cs = time.Now().UnixNano()/1000000\n        bodyBytes, err := getBody(method, Id, auth, nil,timeStamp)\n        if err != nil {\n            fmt.Errorf(\"unable to retrieve the response body from the Glance API server: %v\", err)\n        }\n\n        var obj []interface{}\n        err = json.Unmarshal(bodyBytes, &amp;obj)\n\n        if err != nil {\n            fmt.Errorf(\"unable to parse the JSON response:\", err)\n        }\n\n        for i,_:=range obj{\n            m := obj[i].(map[string]interface{})\n            fmt.Println(m[\"text\"])\n\n         /* @OnKeyWord(\"hi\")\n          public void HelloWorld(TeamchatAPI api) {\n          System.out.println(\"Hello word\");\n                );  */\n\n\n        }\n\n        timeStamp = cs\n    }\n}\n</code></pre>\n\n<p>I want to convert the commented java code into go code.</p>\n\n<p>Alternatively you can take your own example to explain, if you want.</p>\n"}, {"tags": ["css", "web", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1442302304, "post_id": 32580043, "comment_id": 53014630, "body": "Please read: <a href=\"http://stackoverflow.com/questions/28293452/404-page-not-found-go-rendering-css-file\">404 page not found - Go rendering css file</a> and <a href=\"http://stackoverflow.com/questions/27945310/why-do-i-need-to-use-http-stripprefix-to-access-my-static-files\">Why do I need to use http.StripPrefix to access my static files?</a>. Also note that your pages are availabe under <code>&#47;edit&#47;</code> and <code>&#47;view&#47;</code>, but the HTML templates refer to <i>relative</i> css urls (so e.g. it will mean <code>&#47;view&#47;css&#47;styles.css</code> - <b>not</b> what you want!)."}, {"owner": {"reputation": 992, "user_id": 362417, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f5d79195c2f3d6390ac4dbb847c24c08?s=128&d=identicon&r=PG", "display_name": "Hannibal", "link": "https://stackoverflow.com/users/362417/hannibal"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1442302511, "post_id": 32580043, "comment_id": 53014760, "body": "Damn. :) Why not put this as an answer @icza? I would have accepted it. :) Also, thanks. I did not find these questions. I should have looked harder. :/"}], "answers": [{"comments": [{"owner": {"reputation": 992, "user_id": 362417, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f5d79195c2f3d6390ac4dbb847c24c08?s=128&d=identicon&r=PG", "display_name": "Hannibal", "link": "https://stackoverflow.com/users/362417/hannibal"}, "edited": false, "score": 0, "creation_date": 1442311078, "post_id": 32580296, "comment_id": 53019888, "body": "Thanks, it&#39;s working perfectly. Had to handle /view/css/ of course. Though I wonder if there is a better way of doing it rather than serving static content in order for a simple CSS and an IMG to be loaded?!"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 992, "user_id": 362417, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f5d79195c2f3d6390ac4dbb847c24c08?s=128&d=identicon&r=PG", "display_name": "Hannibal", "link": "https://stackoverflow.com/users/362417/hannibal"}, "edited": false, "score": 0, "creation_date": 1442314860, "post_id": 32580296, "comment_id": 53022252, "body": "@Hannibal You could embed small resources in the Go app itself, see <a href=\"http://stackoverflow.com/a/28071360/1705598\">What&#39;s the best way to bundle static resources in a Go program?</a>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1442344040, "last_edit_date": 1495535293, "creation_date": 1442302586, "answer_id": 32580296, "question_id": 32580043, "link": "https://stackoverflow.com/questions/32580043/using-external-css-file-on-a-go-web-server/32580296#32580296", "title": "Using external CSS file on a go web server", "body": "<p>Since you use relative paths (e.g. <code>http.Dir(\"tmp/css\")</code>, it is important how (from which folder) you start your app.</p>\n\n<p>Please read: <a href=\"https://stackoverflow.com/questions/28293452/404-page-not-found-go-rendering-css-file\">404 page not found - Go rendering css file</a> and <a href=\"https://stackoverflow.com/questions/27945310/why-do-i-need-to-use-http-stripprefix-to-access-my-static-files\">Why do I need to use http.StripPrefix to access my static files?</a> for more details.</p>\n\n<p>Also note that your pages are available under <code>/edit/</code> and <code>/view/</code>, but the HTML templates include CSS resources using <em>relative</em> urls:</p>\n\n<pre><code>&lt;link rel=\"stylesheet\" href=\"css/styles.css\"&gt;\n</code></pre>\n\n<p>So e.g. the result will be <code>/view/css/styles.css</code> - <strong>not</strong> what you want!</p>\n"}], "owner": {"reputation": 992, "user_id": 362417, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f5d79195c2f3d6390ac4dbb847c24c08?s=128&d=identicon&r=PG", "display_name": "Hannibal", "link": "https://stackoverflow.com/users/362417/hannibal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1649, "favorite_count": 1, "accepted_answer_id": 32580296, "answer_count": 1, "score": 3, "last_activity_date": 1442344040, "creation_date": 1442301710, "question_id": 32580043, "link": "https://stackoverflow.com/questions/32580043/using-external-css-file-on-a-go-web-server", "title": "Using external CSS file on a go web server", "body": "<p>I'm trying to implement a simple wiki as depicted here => \n<a href=\"https://golang.org/doc/articles/wiki/\" rel=\"nofollow\">https://golang.org/doc/articles/wiki/</a></p>\n\n<p>I know this has been asked several times, but I can't get the static content to load in my code. It's stupid, I followed the instructions which let's me add a handler for static content but the CSS still does not get used in the html file.</p>\n\n<p>I added the handlers like this:</p>\n\n<pre><code>http.Handle(\"tmp/css\", http.StripPrefix(\"tmp/css\", http.FileServer(http.Dir(\"tmp/css\"))))\nhttp.Handle(\"tmp/img\", http.StripPrefix(\"tmp/img\", http.FileServer(http.Dir(\"tmp/img\"))))\n</code></pre>\n\n<p>The whole code can be seen here, on my github page => <a href=\"https://github.com/Skarlso/goprojects/tree/master/golangwiki\" rel=\"nofollow\">https://github.com/Skarlso/goprojects/tree/master/golangwiki</a></p>\n\n<p>Thanks for the help!\nGergely.</p>\n"}, {"tags": ["performance", "http", "go", "template-engine"], "answers": [{"comments": [{"owner": {"reputation": 587, "user_id": 2151532, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f9392b5d79f398886479292f2945c3c6?s=128&d=identicon&r=PG&f=1", "display_name": "loose11", "link": "https://stackoverflow.com/users/2151532/loose11"}, "edited": false, "score": 1, "creation_date": 1442298643, "post_id": 32579117, "comment_id": 53012611, "body": "Thank you. OK I understand it with the data. But what if the template change, so I habe to restart the server"}, {"owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "reply_to_user": {"reputation": 587, "user_id": 2151532, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f9392b5d79f398886479292f2945c3c6?s=128&d=identicon&r=PG&f=1", "display_name": "loose11", "link": "https://stackoverflow.com/users/2151532/loose11"}, "edited": false, "score": 1, "creation_date": 1442298720, "post_id": 32579117, "comment_id": 53012656, "body": "Yes, sorry, I might have misunderstood the question, please see the edit."}, {"owner": {"reputation": 1042, "user_id": 374924, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/08ef4cdbafc228a2a6052467e74f3c2e?s=128&d=identicon&r=PG", "display_name": "Jacek Wysocki", "link": "https://stackoverflow.com/users/374924/jacek-wysocki"}, "reply_to_user": {"reputation": 587, "user_id": 2151532, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f9392b5d79f398886479292f2945c3c6?s=128&d=identicon&r=PG&f=1", "display_name": "loose11", "link": "https://stackoverflow.com/users/2151532/loose11"}, "edited": false, "score": 2, "creation_date": 1442321680, "post_id": 32579117, "comment_id": 53026881, "body": "@loose11 you can use configured BRA <a href=\"https://github.com/Unknwon/bra\" rel=\"nofollow noreferrer\">github.com/Unknwon/bra</a> it&#39;s nice tool which detects changes in source code and restarts server automatically, I wouldn&#39;t go for introducing code changes in your handlers only to introduce environment handling."}], "tags": [], "owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "is_accepted": false, "score": 5, "last_activity_date": 1449718008, "last_edit_date": 1449718008, "creation_date": 1442298462, "answer_id": 32579117, "question_id": 32578718, "link": "https://stackoverflow.com/questions/32578718/read-template-in-init-or-in-handler-function/32579117#32579117", "title": "Read template in init or in handler function?", "body": "<p>Let's analyze the performance:</p>\n\n<p>We name your first solution (with slight changes, see below) <strong>a</strong> and your second solution <strong>b</strong>.</p>\n\n<p>One request:<br>\na: One disk access<br>\nb: One disk access</p>\n\n<p>Ten requests:<br>\na: One disk access<br>\nb: Ten disk accesses</p>\n\n<p>10 000 000 requests:<br>\na: One disk access<br>\nb: 10 000 000 disk accesses (this is slow)</p>\n\n<p>So, performance is better with your first solution. But what about your concern regarding up-to-date data? From the documentation of <code>func (t *Template) Execute(wr io.Writer, data interface{}) error</code>:</p>\n\n<blockquote>\n  <p>Execute applies a parsed template to the specified data object, writing the output to wr. If an error occurs executing the template or writing its output, execution stops, but partial results may already have been written to the output writer. A template may be executed safely in parallel.</p>\n</blockquote>\n\n<p>So, what happens is this:</p>\n\n<ol>\n<li>You read a template from disk</li>\n<li>You parse the file into a template</li>\n<li>You choose the data to <em>fill in the blanks</em> with</li>\n<li>You <code>Execute</code> the template with that data, the result is written out into an <code>io.Writer</code></li>\n</ol>\n\n<p>Your data is as up-to-date as you choose it. This has nothing to do with re-reading the template from disk, or even re-parsing it. This is the whole idea behind templates: One disk access, one parse, multiple dynamic end results.</p>\n\n<p>The documentation quoted above tells us another thing:</p>\n\n<blockquote>\n  <p>A template may be executed safely in parallel.</p>\n</blockquote>\n\n<p>This is very useful, because your <code>http.HandlerFunc</code>s are ran in parallel, if you have multiple requests in parallel.</p>\n\n<p>So, what to do now?<br>\n<code>Read</code> the template file <strong>once</strong>,<br>\n<code>Parse</code> the template <strong>once</strong>,<br>\n<code>Execute</code> the template <strong>for every request</strong>.</p>\n\n<p>I'm not sure if you should read and parse in the <code>init()</code> function, because at least the <code>Must</code> can panic (and don't use some relative, hard coded path in there!) - I would try to do that in a more controlled environment, e.g. provide a function (like <code>New()</code>) to create a new instance of your server and do that stuff in there.</p>\n\n<p><strong>EDIT</strong>: I re-read your question and I might have misunderstood you:</p>\n\n<p>If the template itself is still in development then yes, you would have to read it on every request to have an up-to-date result. This is more convenient than to restart the server every time you change the template. For production, the template should be fixed and only the data should change.</p>\n\n<p>Sorry if I got you wrong there.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1442317069, "last_edit_date": 1495539881, "creation_date": 1442299800, "answer_id": 32579486, "question_id": 32578718, "link": "https://stackoverflow.com/questions/32578718/read-template-in-init-or-in-handler-function/32579486#32579486", "title": "Read template in init or in handler function?", "body": "<p>Never read and parse template files in the request handler in production, that is as bad as it can get (you should like always avoid this). During development it is ok of course.</p>\n\n<p>Read this question for more details:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/28451675/it-takes-too-much-time-when-using-template-package-to-generate-a-dynamic-web-p\">It takes too much time when using &quot;template&quot; package to generate a dynamic web page to client in golang</a></p>\n\n<p>You could approach this in multiple ways. Here I list 4 with example implementation.</p>\n\n<h3>1. With a \"dev mode\" setting</h3>\n\n<p>You could have a constant or variable telling if you're running in development mode which means templates are not to be cached.</p>\n\n<p>Here's an example to that:</p>\n\n<pre><code>const dev = true\n\nvar indexTmpl *template.Template\n\nfunc init() {\n    if !dev { // Prod mode, read and cache template\n        indexTmpl = template.Must(template.New(\"index\").ParseFiles(\".tpl/index.tpl\"))\n    }\n}\n\nfunc getIndexTmpl() *template.Template {\n    if dev { // Dev mode, always read fresh template\n        return template.Must(template.New(\"index\").ParseFiles(\".tpl/index.tpl\"))\n    } else { // Prod mode, return cached template\n        return indexTmpl\n    }\n}\n\nfunc indexHandler(w http.ResponseWriter, r *http.Request) {\n    getIndexTmpl().Execute(w, \"test\")\n}\n</code></pre>\n\n<h3>2. Specify in the request (as a param) if you want a fresh template</h3>\n\n<p>When you develop, you may specify an extra URL parameter indicating to read a fresh template and not use the cached one, e.g. <code>http://localhost:8080/index?dev=true</code></p>\n\n<p>Example implementation:</p>\n\n<pre><code>var indexTmpl *template.Template\n\nfunc init() {\n    indexTmpl = getIndexTmpl()\n}\n\nfunc getIndexTmpl() *template.Template {\n    return template.Must(template.New(\"index\").ParseFiles(\".tpl/index.tpl\"))\n}\n\nfunc indexHandler(w http.ResponseWriter, r *http.Request) {\n    t := indexTmpl\n    if r.FormValue(\"dev\") != nil {\n        t = getIndexTmpl()\n    }\n    t.Execute(w, \"test\")\n}\n</code></pre>\n\n<h3>3. Decide based on host</h3>\n\n<p>You can also check the host name of the request URL, and if it is <code>\"localhost\"</code>, you can omit the cache and use a fresh template. This requires the smallest extra code and effort. Note that you may want to accept other hosts as well e.g. <code>\"127.0.0.1\"</code> (up to you what you want to include).</p>\n\n<p>Example implementation:</p>\n\n<pre><code>var indexTmpl *template.Template\n\nfunc init() {\n    indexTmpl = getIndexTmpl()\n}\n\nfunc getIndexTmpl() *template.Template {\n    return template.Must(template.New(\"index\").ParseFiles(\".tpl/index.tpl\"))\n}\n\nfunc indexHandler(w http.ResponseWriter, r *http.Request) {\n    t := indexTmpl\n    if r.URL.Host == \"localhost\" || strings.HasPrefix(r.URL.Host, \"localhost:\") {\n        t = getIndexTmpl()\n    }\n    t.Execute(w, \"test\")\n}\n</code></pre>\n\n<h3>4. Check template file last modified</h3>\n\n<p>You could also store the last modified time of the template file when it is loaded. Whenever the template is requested, you can check the last modified time of the source template file. If it has changed, you can reload it before executing it.</p>\n\n<p>Example implementation:</p>\n\n<pre><code>type mytempl struct {\n    t       *template.Template\n    lastmod time.Time\n    mutex   sync.Mutex\n}\n\nvar indexTmpl mytempl\n\nfunc init() {\n    // You may want to call this in init so first request won't be slow\n    checkIndexTempl()\n}\n\nfunc checkIndexTempl() {\n    nm := \".tpl/index.tpl\"\n    fi, err := os.Stat(nm)\n    if err != nil {\n        panic(err)\n    }\n    if indexTmpl.lastmod != fi.ModTime() {\n        // Changed, reload. Don't forget the locking!\n        indexTmpl.mutex.Lock()\n        defer indexTmpl.mutex.Unlock()\n        indexTmpl.t = template.Must(template.New(\"index\").ParseFiles(nm))\n        indexTmpl.lastmod = fi.ModTime()\n    }\n}\n\nfunc indexHandler(w http.ResponseWriter, r *http.Request) {\n    checkIndexTempl()\n    indexTmpl.t.Execute(w, \"test\")\n}\n</code></pre>\n"}], "owner": {"reputation": 587, "user_id": 2151532, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f9392b5d79f398886479292f2945c3c6?s=128&d=identicon&r=PG&f=1", "display_name": "loose11", "link": "https://stackoverflow.com/users/2151532/loose11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "accepted_answer_id": 32579486, "answer_count": 2, "score": 2, "last_activity_date": 1449718008, "creation_date": 1442296739, "last_edit_date": 1442303425, "question_id": 32578718, "link": "https://stackoverflow.com/questions/32578718/read-template-in-init-or-in-handler-function", "title": "Read template in init or in handler function?", "body": "<p>I'm writing a basic server for a website. Now I face a (for me) difficult performance question. Is it better to read the template file in the <code>init()</code> function?</p>\n\n<pre><code>// Initialize all pages of website\nfunc init(){\n indexPageData, err := ioutil.ReadFile(\"./tpl/index.tpl\")\n check(err)\n}\n</code></pre>\n\n<p>Or in the <code>http.HandlerFunc</code>?</p>\n\n<pre><code>func index(w http.ResponseWriter, req *http.Request){\n  indexPageData, err := ioutil.ReadFile(\"./tpl/index.tpl\")\n  check(err)\n  indexPageTpl := template.Must(template.New(\"index\").Parse(string(indexPageData)))\n  indexPageTpl.Execute(w, \"test\")\n}\n</code></pre>\n\n<p>I think in the first example, after the server is started you have no need to access the disk and increase the performance of the request.<br>\nBut during development I want to refresh the browser and see the new content. That can be done with the second example. </p>\n\n<p>Does someone have a state-of-the-art solution? Or what is the right from the performance point of view?</p>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 1279, "user_id": 4299078, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/85e4a1e6895c608aa595b2480d15fb27?s=128&d=identicon&r=PG&f=1", "display_name": "AndreyT", "link": "https://stackoverflow.com/users/4299078/andreyt"}, "edited": false, "score": 1, "creation_date": 1442299985, "post_id": 32578486, "comment_id": 53013334, "body": "I think <a href=\"https://github.com/jinzhu/gorm\" rel=\"nofollow noreferrer\">GORM</a> is what you want. It&#39;s one of famous ORM in Go."}, {"owner": {"reputation": 269, "user_id": 3142303, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/39f23a408e48229147f4336d765dd649?s=128&d=identicon&r=PG&f=1", "display_name": "Jack_125", "link": "https://stackoverflow.com/users/3142303/jack-125"}, "reply_to_user": {"reputation": 1279, "user_id": 4299078, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/85e4a1e6895c608aa595b2480d15fb27?s=128&d=identicon&r=PG&f=1", "display_name": "AndreyT", "link": "https://stackoverflow.com/users/4299078/andreyt"}, "edited": false, "score": 0, "creation_date": 1442355275, "post_id": 32578486, "comment_id": 53046425, "body": "Thank you for your comment. I reviewed GORM. I can learn many things for this. At this time I am exploring more on hand written sql."}], "answers": [{"comments": [{"owner": {"reputation": 269, "user_id": 3142303, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/39f23a408e48229147f4336d765dd649?s=128&d=identicon&r=PG&f=1", "display_name": "Jack_125", "link": "https://stackoverflow.com/users/3142303/jack-125"}, "edited": false, "score": 0, "creation_date": 1442355177, "post_id": 32590850, "comment_id": 53046387, "body": "Thank you for your response. I am looking for best practice example on how to do master detail relationship with hand written sql and without using ORM. I reviewed <a href=\"http://go-database-sql.org/\" rel=\"nofollow noreferrer\">go-database-sql.org</a> and it has pretty god tutorial but I could not find master detail example."}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "reply_to_user": {"reputation": 269, "user_id": 3142303, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/39f23a408e48229147f4336d765dd649?s=128&d=identicon&r=PG&f=1", "display_name": "Jack_125", "link": "https://stackoverflow.com/users/3142303/jack-125"}, "edited": false, "score": 0, "creation_date": 1442389900, "post_id": 32590850, "comment_id": 53057407, "body": "I think what you call <i>master detail relationship</i> is a term specific to your C# ORM for a child entity. I think the wikipedia page on <a href=\"https://en.wikipedia.org/wiki/Foreign_key\" rel=\"nofollow noreferrer\">foreign keys</a> is a good starting place to get insights on this matter."}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": false, "score": 1, "last_activity_date": 1442333549, "creation_date": 1442333549, "answer_id": 32590850, "question_id": 32578486, "link": "https://stackoverflow.com/questions/32578486/golang-with-master-detail-mysql-entities/32590850#32590850", "title": "golang with master detail mysql entities", "body": "<p>What you are looking for is an <em>Object Relationnal Mapper</em>. There is a lot of ORMs written in Golang, but they have limitations compared to libraries written in more dynamic languages due to the language itself.</p>\n\n<p>You could also writte your SQL statements by hand, which is often simpler and faster than using an ORM.</p>\n"}], "owner": {"reputation": 269, "user_id": 3142303, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/39f23a408e48229147f4336d765dd649?s=128&d=identicon&r=PG&f=1", "display_name": "Jack_125", "link": "https://stackoverflow.com/users/3142303/jack-125"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1442333549, "creation_date": 1442295637, "question_id": 32578486, "link": "https://stackoverflow.com/questions/32578486/golang-with-master-detail-mysql-entities", "title": "golang with master detail mysql entities", "body": "<p>I have been playing around with GO programming language. I am looking for some help on how to set up master detail entities. \nin c#, I would do below. I have seen many example in GO that deals with one table. but I could not find any example that deals with master detail entities like this.</p>\n\n<p>GO seems very different than C# and Java. If this is not the right way to do it, please explain or point me to some example how I can achieve similar functionality in GO.</p>\n\n<p>Thank you!</p>\n\n<pre><code>public class Employee\n{\n    public int id{get; set;}\n    public string lastName{get; set;}\n    public string firstName{get; set;}\n    public Collection&lt;Address&gt; addresses { get; set; }    \n}\n\npublic class Address\n{\n    public int id{get; set;}\n    public string street{get; set;}\n    public string zip{get; set;} \n    public virtual Employee employee{get; set;}    \n}\n</code></pre>\n"}, {"tags": ["ssl", "go"], "answers": [{"comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1442302915, "post_id": 32576035, "comment_id": 53014976, "body": "Noting, that of course, there isn&#39;t a way to know if it&#39;s your own self-signed certificate you&#39;re allowing or an attacker&#39;s, which makes it somewhat pointless!"}, {"owner": {"reputation": 160, "user_id": 3574791, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/UywtN.jpg?s=128&g=1", "display_name": "Ganitzsh", "link": "https://stackoverflow.com/users/3574791/ganitzsh"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1442307484, "post_id": 32576035, "comment_id": 53017518, "body": "Thank you so much! I must have skip this flag when I read the help... @elithrar I know, but getting a signed certificate by a CA when you&#39;re a student is pretty hard to get haha. Thanks for the analysis I didn&#39;t really think of it this way."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "reply_to_user": {"reputation": 160, "user_id": 3574791, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/UywtN.jpg?s=128&g=1", "display_name": "Ganitzsh", "link": "https://stackoverflow.com/users/3574791/ganitzsh"}, "edited": false, "score": 0, "creation_date": 1442310749, "post_id": 32576035, "comment_id": 53019679, "body": "@Ganitzsh It&#39;s definitely not hard to get a proper (domain verified) certificate, even as a student. You don&#39;t need to provide any formal ID. Places like Namecheap or Gandi are extremely cheap."}, {"owner": {"reputation": 160, "user_id": 3574791, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/UywtN.jpg?s=128&g=1", "display_name": "Ganitzsh", "link": "https://stackoverflow.com/users/3574791/ganitzsh"}, "edited": false, "score": 0, "creation_date": 1442311790, "post_id": 32576035, "comment_id": 53020334, "body": "Thanks for the tip, it&#39;s the first I face real problems with SSL and certificates.. Pretty hard to understand at first."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 5, "last_activity_date": 1442278679, "creation_date": 1442278679, "answer_id": 32576035, "question_id": 32575775, "link": "https://stackoverflow.com/questions/32575775/go-get-accept-selfsigned-certificate-from-distant-host/32576035#32576035", "title": "go get accept selfsigned certificate from distant host", "body": "<p>Use <code>go get -insecure https://xxxxx</code>.</p>\n\n<p>From <code>go get -h</code>:</p>\n\n<blockquote>\n  <p>The -insecure flag permits fetching from repositories and resolving\n  custom domains using insecure schemes such as HTTP. Use with caution.</p>\n</blockquote>\n"}], "owner": {"reputation": 160, "user_id": 3574791, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/UywtN.jpg?s=128&g=1", "display_name": "Ganitzsh", "link": "https://stackoverflow.com/users/3574791/ganitzsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4544, "favorite_count": 0, "accepted_answer_id": 32576035, "answer_count": 1, "score": 3, "last_activity_date": 1442278679, "creation_date": 1442276337, "question_id": 32575775, "link": "https://stackoverflow.com/questions/32575775/go-get-accept-selfsigned-certificate-from-distant-host", "title": "go get accept selfsigned certificate from distant host", "body": "<p>I'd like to be able to <code>go get</code> from my Stash server with a nice URL. My stash server works only over HTTPS. The problem is that my SSL certificate I'm using with stash is self-signed and any <code>go get</code> to my server gets me the following error:</p>\n\n<pre><code>x509: certificate signed by unknown authority\n</code></pre>\n\n<p>Is there a way to authorize self-signed certificates from <code>go get</code>?</p>\n"}, {"tags": ["macos", "sockets", "go", "packet"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1442278572, "post_id": 32575558, "comment_id": 53007042, "body": "On Linux, you need to be root to be able to do that, maybe it&#39;s the same on osx?"}, {"owner": {"reputation": 740, "user_id": 4488456, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4146daa51bdb93084db63bbf9b5d5c43?s=128&d=identicon&r=PG", "display_name": "jordan2175", "link": "https://stackoverflow.com/users/4488456/jordan2175"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1442278732, "post_id": 32575558, "comment_id": 53007072, "body": "Thanks for picking up that omission, I have added that to the writeup.  Yes, I am running as root, you have to have root access to open raw sockets."}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1442295761, "post_id": 32575558, "comment_id": 53011404, "body": "please show the hexdump"}, {"owner": {"reputation": 740, "user_id": 4488456, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4146daa51bdb93084db63bbf9b5d5c43?s=128&d=identicon&r=PG", "display_name": "jordan2175", "link": "https://stackoverflow.com/users/4488456/jordan2175"}, "edited": false, "score": 0, "creation_date": 1442329232, "post_id": 32575558, "comment_id": 53032466, "body": "Added additional information to show the hexdumps"}, {"owner": {"reputation": 740, "user_id": 4488456, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4146daa51bdb93084db63bbf9b5d5c43?s=128&d=identicon&r=PG", "display_name": "jordan2175", "link": "https://stackoverflow.com/users/4488456/jordan2175"}, "edited": false, "score": 0, "creation_date": 1442363029, "post_id": 32575558, "comment_id": 53048593, "body": "In the &quot;man socket&quot; manual on OSX it looks like there is an entry point of &quot;PF_NDRV&quot; that would probably do what I need.  As it appears that the &quot;AF_INET&quot; is really for things above layer 3.  But &quot;PF_NDRV&quot; does not seem to be part of the Go syscall.Socket library. Any other thoughts?"}, {"owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "edited": false, "score": 0, "creation_date": 1442374034, "post_id": 32575558, "comment_id": 53051151, "body": "You should set the protocol to <code>syscall.IPPROTO_ICMP</code> instead of raw, no?"}, {"owner": {"reputation": 740, "user_id": 4488456, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4146daa51bdb93084db63bbf9b5d5c43?s=128&d=identicon&r=PG", "display_name": "jordan2175", "link": "https://stackoverflow.com/users/4488456/jordan2175"}, "edited": false, "score": 0, "creation_date": 1442375834, "post_id": 32575558, "comment_id": 53051575, "body": "I was playing around with ICMP just an example.  Ultimately I need the ability to craft frames / packets for any protocol.  It just seems like either there is a bug or I am doing something wrong.  I hope I am just doing something wrong."}, {"owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "edited": false, "score": 0, "creation_date": 1442396650, "post_id": 32575558, "comment_id": 53061553, "body": "Perhaps Linux automatically sets the <code>IP_HDRINCL</code> socket option when you have a raw socket and OS X doesn&#39;t. I have tried adding <code>syscall.SetsockoptInt(s, syscall.IPPROTO_IP, syscall.IP_HDRINCL, 1)</code> to fix it, but I am getting a problem with the packet I am sending now. Perhaps a byte order issue or something."}], "answers": [{"comments": [{"owner": {"reputation": 740, "user_id": 4488456, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4146daa51bdb93084db63bbf9b5d5c43?s=128&d=identicon&r=PG", "display_name": "jordan2175", "link": "https://stackoverflow.com/users/4488456/jordan2175"}, "edited": false, "score": 0, "creation_date": 1442521841, "post_id": 32599757, "comment_id": 53127425, "body": "This works, and is very helpful.  I also got a response back from Mikio from the Go project with another solution that I will post below as a separate answer."}], "tags": [], "owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "is_accepted": false, "score": 1, "last_activity_date": 1442401925, "last_edit_date": 1442401925, "creation_date": 1442377437, "answer_id": 32599757, "question_id": 32575558, "link": "https://stackoverflow.com/questions/32575558/creating-raw-packets-with-go-1-5-on-macosx/32599757#32599757", "title": "Creating RAW Packets with Go 1.5 on MacOSX", "body": "<p>Ok I was able to get this to work on OS X now. You need to make sure you are setting <code>IP_HDRINCL</code> socket option <code>syscall.SetsockoptInt(s, syscall.IPPROTO_IP, syscall.IP_HDRINCL, 1)</code> and then you need to be careful building the packet. One trick that caught me for a LONG TIME was that, for some reason, for <code>Sendto</code> <a href=\"http://cseweb.ucsd.edu/~braghava/notes/freebsd-sockets.txt\" rel=\"nofollow\">OS X/BSD want the IP length in host byte order</a>, which in my case was LittleEndian, not BigEndian which is the typical network order. If you look at this code (I just kinda built the IP header myself, you can build it another way) it runs as expected.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/binary\"\n    \"fmt\"\n    \"syscall\"\n)\n\nfunc main() {\n    s, err := syscall.Socket(syscall.AF_INET, syscall.SOCK_RAW, syscall.IPPROTO_RAW)\n    if err != nil {\n        panic(err)\n    }\n\n    err = syscall.SetsockoptInt(s, syscall.IPPROTO_IP, syscall.IP_HDRINCL, 1)\n    if err != nil {\n        panic(err)\n    }\n    addr := syscall.SockaddrInet4{Addr: [4]byte{127, 0, 0, 1}}\n\n    data := makepacket()\n\n    for _, v := range data {\n        if v == 0 {\n            fmt.Printf(\"00 \")\n            continue\n        } else if v &lt; 0xf {\n            fmt.Printf(\"0%x \", v)\n            continue\n        }\n        fmt.Printf(\"%x \", v)\n    }\n    fmt.Printf(\"\\n\")\n    err = syscall.Sendto(s, data, 0, &amp;addr)\n    if err != nil {\n        panic(err)\n    }   \n}       \n\nfunc makepacket() []byte {\n    icmp := []byte{\n        8, // type: echo request\n        0, // code: not used by echo request\n        0, // checksum (16 bit), we fill in below\n        0,\n        0, // identifier (16 bit). zero allowed.\n        0,\n        0, // sequence number (16 bit). zero allowed.\n        0,\n        0xC0, // Optional data. ping puts time packet sent here\n        0xDE, \n    }\n    cs := csum(icmp)\n    icmp[2] = byte(cs)\n    icmp[3] = byte(cs &gt;&gt; 8)\n\n    buf := []byte{0x45, 0x00, 0x00, 0x00, 0x95, 0x13, 0x00, 0x00, 0x40, 0x01, 0x00, 0x00, 0x7f, 0x00, 0x0\n0, 0x01, 0x7f, 0x00, 0x00, 0x01}\n    binary.LittleEndian.PutUint16(buf[2:4], uint16(len(icmp) + len(buf)))\n    return append(buf, icmp...)\n}\n\nfunc csum(b []byte) uint16 {\n    var s uint32\n    for i := 0; i &lt; len(b); i += 2 {\n        s += uint32(b[i+1])&lt;&lt;8 | uint32(b[i])\n</code></pre>\n\n<p>This code gives me this output in <code># tcpdump -X -i lo0</code></p>\n\n<pre><code>20:05:24.016465 IP localhost &gt; localhost: ICMP echo request, id 0, seq 0, length 10\n    0x0000:  4500 001e 9513 0000 4001 0000 7f00 0001  E.......@.......\n    0x0010:  7f00 0001 0800 3721 0000 0000 c0de       ......7!......\n20:05:24.016495 IP localhost &gt; localhost: ICMP echo reply, id 0, seq 0, length 10\n    0x0000:  4500 001e 3e4f 0000 4001 0000 7f00 0001  E...&gt;O..@.......\n    0x0010:  7f00 0001 0000 3f21 0000 0000 c0de       ......?!......\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "edited": false, "score": 0, "creation_date": 1442538246, "post_id": 32639488, "comment_id": 53132942, "body": "This is kinda cool; I should have known there&#39;d be an easier solution. I haven&#39;t looked much through the <code>net&#47;ipv4</code> package. Typically in Go you don&#39;t have to go down to syscalls like we were trying. For this type of networking it might also be useful to write these parts in C and just call the C from your Go code."}], "tags": [], "owner": {"reputation": 740, "user_id": 4488456, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4146daa51bdb93084db63bbf9b5d5c43?s=128&d=identicon&r=PG", "display_name": "jordan2175", "link": "https://stackoverflow.com/users/4488456/jordan2175"}, "is_accepted": false, "score": 1, "last_activity_date": 1442522019, "creation_date": 1442522019, "answer_id": 32639488, "question_id": 32575558, "link": "https://stackoverflow.com/questions/32575558/creating-raw-packets-with-go-1-5-on-macosx/32639488#32639488", "title": "Creating RAW Packets with Go 1.5 on MacOSX", "body": "<p>Here is an answer I got back from Mikio on the Go project.  I am adding it here for other people that might be looking for a solution to this problem.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"golang.org/x/net/ipv4\"\n    \"log\"\n    \"net\"\n)\n\nfunc main() {\n    ip := net.ParseIP(\"127.0.0.1\")\n    proto := 1\n\n    c, err := net.ListenPacket(fmt.Sprintf(\"ip4:%d\", proto), \"0.0.0.0\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer c.Close()\n\n    p, err := ipv4.NewRawConn(c)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    b := []byte(\"HELLO-R-U-THERE\")\n    h := &amp;ipv4.Header{\n        Version:  ipv4.Version,\n        Len:      ipv4.HeaderLen,\n        TotalLen: ipv4.HeaderLen + len(b),\n        ID:       12345,\n        Protocol: proto,\n        Dst:      ip.To4(),\n    }\n    if err := p.WriteTo(h, b, nil); err != nil {\n        log.Println(err)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 740, "user_id": 4488456, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4146daa51bdb93084db63bbf9b5d5c43?s=128&d=identicon&r=PG", "display_name": "jordan2175", "link": "https://stackoverflow.com/users/4488456/jordan2175"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1472, "favorite_count": 3, "answer_count": 2, "score": 4, "last_activity_date": 1442522019, "creation_date": 1442274223, "last_edit_date": 1442390428, "question_id": 32575558, "link": "https://stackoverflow.com/questions/32575558/creating-raw-packets-with-go-1-5-on-macosx", "title": "Creating RAW Packets with Go 1.5 on MacOSX", "body": "<p>I am trying to do some basic packet crafting for a testing tool I am working on, but I can not seem to get the packet crafting to work (I am using Go 1.5 on OSX  and am running as root.) </p>\n\n<p>I am using the following code (<a href=\"http://www.darkcoding.net/software/raw-sockets-in-go-link-layer/\" rel=\"nofollow noreferrer\">taken from here</a>) to try and create an ICMP packet, but when I try to specify say specific options in the IP header it does not seem to work.  Further when I look at this packet in wireshark it shows up as protocol 255 (unknown).  </p>\n\n<p>I have read that on Linux system you can use AF_PACKET but on OSX systems you need to use BPF, however the sample code I found is using \"syscall.Socket(syscall.AF_INET, syscall.SOCK_RAW, syscall.IPPROTO_RAW)\" and I am not sure how to get started with BPF.  I have also seen some people try to use gopacket instead of the x/net/ipv4 package.  </p>\n\n<pre><code>package main\n\nimport (\n    \"golang.org/x/net/ipv4\"\n    \"net\"\n    \"syscall\"\n)\n\nfunc main() {\n    var err error\n    fd, _ := syscall.Socket(syscall.AF_INET, syscall.SOCK_RAW, syscall.IPPROTO_RAW)\n\n    addr := syscall.SockaddrInet4{\n        Port: 0,\n        Addr: [4]byte{127, 0, 0, 1},\n    }\n    p := pkt()\n\n    _ = syscall.Sendto(fd, p, 0, &amp;addr)\n}\n\nfunc pkt() []byte {\n    h := ipv4.Header{\n        Version:  4,\n        Len:      20,\n        TOS:      0,\n        TotalLen: 85, // I can not seem to change this\n        ID:       2,  // I can not seem to change this\n        TTL:      64, // I can not seem to change this\n        Protocol: 1,  // ICMP, This does not seem to work\n        Dst:      net.IPv4(127, 0, 0, 1),\n    }\n\n    icmp := []byte{\n        8, // type: echo request\n        0, // code: not used by echo request\n        0, // checksum (16 bit), we fill in below\n        0,\n        0, // identifier (16 bit). zero allowed.\n        0,\n        0, // sequence number (16 bit). zero allowed.\n        0,\n        0xC0, // Optional data. ping puts time packet sent here\n        0xDE,\n    }\n    cs := csum(icmp)\n    icmp[2] = byte(cs)\n    icmp[3] = byte(cs &gt;&gt; 8)\n\n    out, _ := h.Marshal()\n\n    return append(out, icmp...)\n}\n\nfunc csum(b []byte) uint16 {\n    var s uint32\n    for i := 0; i &lt; len(b); i += 2 {\n        s += uint32(b[i+1])&lt;&lt;8 | uint32(b[i])\n    }\n    // add back the carry\n    s = s&gt;&gt;16 + s&amp;0xffff\n    s = s + s&gt;&gt;16\n    return uint16(^s)\n}\n</code></pre>\n\n<p>If I print out the p variable that contains the packet data in Main() after the data comes back from pkt() it looks right:</p>\n\n<pre><code>DEBUG: (decimal) [69 0 60 0 0 0 0 0 64 1 0 0 0 0 0 0 127 0 0 1 8 0 55 33 0 0 0 0 192 222]\nDEBUG: (hex)      45 0 3c 0 0 0 0 0 40 1 0 0 0 0 0 0 7f 0 0 1 8 0 37 21 0 0 0 0 c0 de \n</code></pre>\n\n<p>And you can see that the protocol is set for \"1\" in the 10th byte.  But when we look at this packet in wireshark it looks like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/oTg5f.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oTg5f.png\" alt=\"wireshark screen shot\"></a></p>\n"}, {"tags": ["go", "rabbitmq", "amqp"], "answers": [{"comments": [{"owner": {"reputation": 1721, "user_id": 159241, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/369622138dc13486f9747cceda3e7be1?s=128&d=identicon&r=PG", "display_name": "Harel", "link": "https://stackoverflow.com/users/159241/harel"}, "edited": false, "score": 0, "creation_date": 1442313559, "post_id": 32575307, "comment_id": 53021446, "body": "While we&#39;re at it, what is the benefit of storing undelivered messages in the database instead of a Dead Letter Exchange?"}, {"owner": {"reputation": 68895, "user_id": 93448, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e592bd1326b1e80188ed4c0bf26b9f75?s=128&d=identicon&r=PG", "display_name": "Derick Bailey", "link": "https://stackoverflow.com/users/93448/derick-bailey"}, "reply_to_user": {"reputation": 1721, "user_id": 159241, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/369622138dc13486f9747cceda3e7be1?s=128&d=identicon&r=PG", "display_name": "Harel", "link": "https://stackoverflow.com/users/159241/harel"}, "edited": false, "score": 1, "creation_date": 1442323080, "post_id": 32575307, "comment_id": 53027877, "body": "same problems for the same reasons. a DLX will route a message to a different queue. at that point, you&#39;re in the same situation because you can&#39;t query a queue for a specific message based on criteria <a href=\"http://derickbailey.com/2015/07/22/airport-baggage-claims-selective-consumers-and-rabbitmq-anti-patterns/\" rel=\"nofollow noreferrer\">derickbailey.com/2015/07/22/&hellip;</a>"}], "tags": [], "owner": {"reputation": 68895, "user_id": 93448, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e592bd1326b1e80188ed4c0bf26b9f75?s=128&d=identicon&r=PG", "display_name": "Derick Bailey", "link": "https://stackoverflow.com/users/93448/derick-bailey"}, "is_accepted": true, "score": 2, "last_activity_date": 1442272437, "creation_date": 1442272437, "answer_id": 32575307, "question_id": 32573913, "link": "https://stackoverflow.com/questions/32573913/how-can-i-acknowledge-a-rabbitmq-message-using-the-message-id-only-in-go/32575307#32575307", "title": "How can I acknowledge a Rabbitmq message using the message id only (in Go)?", "body": "<p>Even if you can do this, it's bad design.</p>\n\n<p>What happens to the message if the user doesn't see it? Does your web server infinitely hang on to it? Does it \"nack\" the message back to the queue? </p>\n\n<p>Neither of these options are good. </p>\n\n<p>Hang on to every message, and RabbitMQ will start having issues with thousands of unacknowledged messages from a lot of users. Nack the message back to the queue and you'll thrash the message round in circles, spiking CPU resources on the web server and the RMQ server, as well as network traffic between the two.</p>\n\n<p>The better solution to this problem is to store the message in a database, after pulling it out of RabbitMQ. When it gets sent to / viewed by the browser, update the database to reflect that.</p>\n\n<p>From a yet-unpublished article I've written:</p>\n\n<blockquote>\n  <p><em>Store the message in a database.</em></p>\n  \n  <p>Add a field to the database record that says who this message belongs\n  to. When the user reconnects later, query the database for any\n  messages that this user needs to see and send them along at that time.</p>\n  \n  <p>The full process started above, then becomes this:</p>\n  \n  <ul>\n  <li>User's browser connects to SignalR/Socket.io/Pusher/websockets on web\n  server </li>\n  <li>Web server checks a queue for updates that happen during a long\n  running process </li>\n  <li>When a message for a logged in user comes in \n  \n  <ul>\n  <li>If the\n  user is logged in, broadcast the message through the websocket to the\n  user </li>\n  <li>If the user is not logged in, store the message in a database</li>\n  </ul></li>\n  <li>When the user logs in again, query the database and send all waiting\n  messages </li>\n  </ul>\n  \n  <p>It's what you would have done before the idea of a message\n  queue came in to play, right? It should be what you would do now that\n  you have a message queue, as well.</p>\n</blockquote>\n"}], "owner": {"reputation": 1721, "user_id": 159241, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/369622138dc13486f9747cceda3e7be1?s=128&d=identicon&r=PG", "display_name": "Harel", "link": "https://stackoverflow.com/users/159241/harel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 933, "favorite_count": 1, "accepted_answer_id": 32575307, "answer_count": 1, "score": 0, "last_activity_date": 1442272437, "creation_date": 1442264622, "question_id": 32573913, "link": "https://stackoverflow.com/questions/32573913/how-can-i-acknowledge-a-rabbitmq-message-using-the-message-id-only-in-go", "title": "How can I acknowledge a Rabbitmq message using the message id only (in Go)?", "body": "<p>I built a small server (golang) to grab messages from a RabbitMQ and deliver them to connected browsers via a Websocket.<br>\nIt works quite well, though has one caveat: the messages are acknowledged when delivered to the browser via the websocket. For most messages that is ok but some messages might be very important. If the user's browser received those but the user didn't SEE the message, it would be lost if the browser was closed or reloaded.<br>\nIs there a way to ack a message at a later time based on its message id (from the Delivery struct)?<br>\nThe use case would be that <em>some</em> messages are acked when the user acknowledges them explicitly and at that point the message id is sent back to the tool to be acknowledged with RabbitMQ.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 4, "creation_date": 1442255563, "post_id": 32571504, "comment_id": 52998337, "body": "<code>gzip.Writer</code>&#39;s destination gets fewer bytes than its input, but it still reports the length of the input. It&#39;s answering &quot;how many bytes of input were successfully handled?&quot; not &quot;how many bytes went to the destination?&quot; If you need to expose the number somehow, I suggest exposing it outside the <code>Writer</code> interface--e.g., your struct exposes <code>OutputByteCount int</code> or something."}, {"owner": {"reputation": 11, "user_id": 5335033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b072cb3a7f38e406a2592178ba60027?s=128&d=identicon&r=PG&f=1", "display_name": "serex", "link": "https://stackoverflow.com/users/5335033/serex"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1442255717, "post_id": 32571504, "comment_id": 52998424, "body": "That&#39;s a good point about <code>gzip.Writer</code>. I should have thought about checking that and see what it does"}], "answers": [{"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1442255643, "post_id": 32571588, "comment_id": 52998386, "body": "<code>&#47;dev&#47;null</code> is a function? I suspect that&#39;s not what you meant."}, {"owner": {"reputation": 1447, "user_id": 3570747, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/RKIuH.png?s=128&g=1", "display_name": "vastlysuperiorman", "link": "https://stackoverflow.com/users/3570747/vastlysuperiorman"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1442255924, "post_id": 32571588, "comment_id": 52998541, "body": "@KeithThompson first, I should note that for a moment I thought your name was Ken Thompson, and nearly had a heart attack. Second, I will update my post to clarify. I was actually referring to the function in source for the driver used for the /dev/null device."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1442256973, "post_id": 32571588, "comment_id": 52999109, "body": "I believe I have now lost track of the number of times I&#39;ve been mistaken for Ken Thompson. (We&#39;re even both gray-bearded Unix hackers.)"}], "tags": [], "owner": {"reputation": 1447, "user_id": 3570747, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/RKIuH.png?s=128&g=1", "display_name": "vastlysuperiorman", "link": "https://stackoverflow.com/users/3570747/vastlysuperiorman"}, "is_accepted": true, "score": 4, "last_activity_date": 1576860401, "last_edit_date": 1576860401, "creation_date": 1442255457, "answer_id": 32571588, "question_id": 32571504, "link": "https://stackoverflow.com/questions/32571504/what-number-of-bytes-written-should-my-io-writer-return-when-it-intentionally/32571588#32571588", "title": "What &quot;number of bytes written&quot; should my io.Writer return when it intentionally does not write all the bytes it is passed", "body": "<p>On success, return len(p).</p>\n\n<p>The <a href=\"https://github.com/torvalds/linux/blob/7e0165b2f1a912a06e381e91f0f4e495f4ac3736/drivers/char/mem.c#L675\" rel=\"nofollow noreferrer\">function called</a> when you write to /dev/null returns the number of bytes that you tried to \"write\" to it. It never actually writes anything, but it properly <em>handles</em> data being sent to it. </p>\n\n<p>I would assume that in your case, you should only return n &lt; len(p) if your writer was unable to properly <em>handle</em> all of the bytes sent to it.</p>\n\n<p>Then, the documentation for your writer should <strong>very clearly</strong> state what data is and is not written. People using your function need to know what data will be retrievable after the write is finished.</p>\n"}], "owner": {"reputation": 11, "user_id": 5335033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b072cb3a7f38e406a2592178ba60027?s=128&d=identicon&r=PG&f=1", "display_name": "serex", "link": "https://stackoverflow.com/users/5335033/serex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 713, "favorite_count": 0, "accepted_answer_id": 32571588, "answer_count": 1, "score": 0, "last_activity_date": 1576860401, "creation_date": 1442255176, "question_id": 32571504, "link": "https://stackoverflow.com/questions/32571504/what-number-of-bytes-written-should-my-io-writer-return-when-it-intentionally", "title": "What &quot;number of bytes written&quot; should my io.Writer return when it intentionally does not write all the bytes it is passed", "body": "<p>I want to create a struct that implements <code>io.Writer</code>, ie <code>Write(p []byte) (n int, err error)</code>. The struct will omit certain bytes that is passed to it and thus not actually write all the bytes that is passed in the <code>p</code> parameter. (The actual purpose isn't important, but it could for example be to ignore the first 10 bytes written, ignore every second byte or something else that alters the number of bytes written from what the caller passed to the method).</p>\n\n<p><a href=\"http://golang.org/pkg/io/#Writer\" rel=\"nofollow\">The documentation</a> for <code>io.Writer</code>'s <code>Write</code> method says the following (emphasis mine):</p>\n\n<blockquote>\n  <p>Write writes len(p) bytes from p to the underlying data stream. It\n  returns the number of bytes written from p (0 &lt;= n &lt;= len(p)) and any\n  error encountered that caused the write to stop early. <strong>Write must\n  return a non-nil error if it returns n &lt; len(p)</strong>. Write must not modify\n  the slice data, even temporarily.</p>\n</blockquote>\n\n<p>What should I return as the <code>n</code> value? To comply with the documentation, on success I should return <code>len(p)</code>. However, the method might actually not have written that many bytes, and the return value will be \"wrong\".</p>\n"}, {"tags": ["linux", "go", "pprof"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1442256808, "post_id": 32571396, "comment_id": 52999005, "body": "The format is a little different, but the data and columns still have the same meaning. &#39;flat&#39; is the time in a function, &#39;cum&#39; is the cumulative time is a function and everything below it."}, {"owner": {"reputation": 1409, "user_id": 5117552, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/71a2ae84018279b9286caa4922297a6d?s=128&d=identicon&r=PG", "display_name": "Ryan Lyu", "link": "https://stackoverflow.com/users/5117552/ryan-lyu"}, "edited": false, "score": 0, "creation_date": 1562223164, "post_id": 32571396, "comment_id": 100312074, "body": "Do you mind to change your title to <code>What does flat, flat%, sum%, cum, cum% mean in Golang pprof results?</code>"}, {"owner": {"reputation": 1409, "user_id": 5117552, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/71a2ae84018279b9286caa4922297a6d?s=128&d=identicon&r=PG", "display_name": "Ryan Lyu", "link": "https://stackoverflow.com/users/5117552/ryan-lyu"}, "edited": false, "score": 0, "creation_date": 1562223213, "post_id": 32571396, "comment_id": 100312093, "body": "I think it maybe easier to reach when people search this kind of question."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1529891"}, "is_accepted": false, "score": 1, "last_activity_date": 1500666765, "creation_date": 1500666765, "answer_id": 45245712, "question_id": 32571396, "link": "https://stackoverflow.com/questions/32571396/pprof-and-golang-how-to-interpret-a-results/45245712#45245712", "title": "Pprof and golang - how to interpret a results?", "body": "<p>I know I'm going to get flack for this, but take a look at the GopherCon talks; <a href=\"http://www.gophercon.in/2016/pdf/gcon1.pdf\" rel=\"nofollow noreferrer\">one such example on interpretation is here</a>, there is also a talk from <a href=\"https://docs.google.com/presentation/d/1n6bse0JifemG7yve0Bb0ZAC-IWhTQjCNAclblnn2ANY\" rel=\"nofollow noreferrer\">Uber about pprof</a> as well.</p>\n\n<p>There is also <a href=\"https://blog.golang.org/profiling-go-programs\" rel=\"nofollow noreferrer\">Profiling Go Programs</a> blog post.</p>\n"}, {"tags": [], "owner": {"reputation": 1409, "user_id": 5117552, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/71a2ae84018279b9286caa4922297a6d?s=128&d=identicon&r=PG", "display_name": "Ryan Lyu", "link": "https://stackoverflow.com/users/5117552/ryan-lyu"}, "is_accepted": false, "score": 11, "last_activity_date": 1562223477, "last_edit_date": 1562223477, "creation_date": 1562223101, "answer_id": 56882137, "question_id": 32571396, "link": "https://stackoverflow.com/questions/32571396/pprof-and-golang-how-to-interpret-a-results/56882137#56882137", "title": "Pprof and golang - how to interpret a results?", "body": "<h2>flat and cum</h2>\n\n<p>Assuming there is a function foo, which is composed of 3 functions and a direct operation.</p>\n\n<pre><code>func foo(){\n    a()                                 step1\n    b()                                 step2\n    do something directly.              step3\n    c()                                 step4\n}\n</code></pre>\n\n<p>Imagine when you call function <code>foo</code>, it takes 6 seconds, and the time distribution are following.</p>\n\n<pre><code>func foo(){\n    a()                                 // step1 takes 1s\n    b()                                 // step2 takes 1s\n    do something directly.              // step3 takes 3s\n    c()                                 // step4 takes 1s\n}\n</code></pre>\n\n<ul>\n<li><code>flat</code> would be the time spent on step3.</li>\n<li><code>cum</code> would be the total execution time of foo, which contains sub-function call and direct operations. (cum = step1+ step2+ step3+ step4)</li>\n</ul>\n\n<h2>sum%</h2>\n\n<p>when you run <code>top</code> in pprof console, each line of output stands for the time spent on specific function. <code>Sum%</code> means how much time/memory has been spent by previous lines.</p>\n\n<p>To explain this metric, I pick another example which contains more lines. the value of <code>sum%</code> for forth line is 45.17%. it's the calculated in this way:</p>\n\n<pre><code>line1 19.33%\nline2 13.27%\nline3 6.60%\nline4 5.97%\n-----------\nsum% 45.17%\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/NlzRB.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/NlzRB.png\" alt=\"enter image description here\"></a></p>\n\n<h2>Application of sum%</h2>\n\n<p><code>sum%</code> could help you to identify the big rocks quickly. The following is another example of memory allocation report.</p>\n\n<p>You can see that the first four functions consume 91.06% memory. If I want to do some performance tuning, I should focus on first four functions. All the functions below fourth could be ignored.</p>\n\n<p><a href=\"https://i.stack.imgur.com/0GYM0.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/0GYM0.png\" alt=\"enter image description here\"></a></p>\n\n<h2>Reference</h2>\n\n<p><a href=\"https://www.reddit.com/r/golang/comments/7ony5f/what_is_the_meaning_of_flat_and_cum_in_golang/\" rel=\"noreferrer\">Reddit: What is the meaning of \"flat\" and \"cum\" in golang pprof output</a></p>\n"}], "owner": {"reputation": 10277, "user_id": 190446, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c544188078900e5d5976689949177f11?s=128&d=identicon&r=PG", "display_name": "S\u0142awosz", "link": "https://stackoverflow.com/users/190446/s%c5%82awosz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5484, "favorite_count": 2, "answer_count": 2, "score": 7, "last_activity_date": 1562223477, "creation_date": 1442254841, "question_id": 32571396, "link": "https://stackoverflow.com/questions/32571396/pprof-and-golang-how-to-interpret-a-results", "title": "Pprof and golang - how to interpret a results?", "body": "<p>I am trying to use pprof on my program, however, I have slightly different results from articles I read (links below). In my results, I am getting such table:</p>\n\n<pre><code>(pprof) top10\n1.65s of 1.72s total (95.93%)\nShowing top 10 nodes out of 114 (cum &gt;= 0.01s)\n      flat  flat%   sum%        cum   cum%\n     1.19s 69.19% 69.19%      1.20s 69.77%  syscall.Syscall\n     0.16s  9.30% 78.49%      0.16s  9.30%  runtime._ExternalCode\n</code></pre>\n\n<p>what are this columns: <code>flat flat% sum% cum cum%</code>?</p>\n\n<p>Articles I was reading: \n<a href=\"https://software.intel.com/en-us/blogs/2014/05/10/debugging-performance-issues-in-go-programs\" rel=\"noreferrer\">https://software.intel.com/en-us/blogs/2014/05/10/debugging-performance-issues-in-go-programs</a>\n<a href=\"http://blog.golang.org/profiling-go-programs\" rel=\"noreferrer\">http://blog.golang.org/profiling-go-programs</a></p>\n"}, {"tags": ["c", "image", "go"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1442253470, "post_id": 32570883, "comment_id": 52997162, "body": "I have no idea what <code>GO</code> is, but I would guess, that the <code>imgeProvider</code> thing is returning the image data stripped of all of the metadata, while C is not."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1442253589, "post_id": 32570883, "comment_id": 52997231, "body": "Agreed with @EugeneSh. The Go code does not look like a simple file-access. You are likely comparing apples with oranges. Note: <code>return</code> is not a function and you should not parenthetise the expression."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1442253699, "post_id": 32570883, "comment_id": 52997300, "body": "You never ever ran the Go code you sowed. It doesn&#39;t even compile. And wrapping img in a <code>bytes.Buffer</code> is complete useless if you want to know <code>len(img)</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1442254635, "post_id": 32570883, "comment_id": 52997825, "body": "Simply check the size in your filemanager or with <code>ls -l</code>."}, {"owner": {"reputation": 365, "user_id": 1345145, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/95e953e7ed701481fa93d3a2b67eff19?s=128&d=identicon&r=PG&f=1", "display_name": "asing", "link": "https://stackoverflow.com/users/1345145/asing"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1442255465, "post_id": 32570883, "comment_id": 52998286, "body": "updated code sample, thanks @Volker."}, {"owner": {"reputation": 365, "user_id": 1345145, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/95e953e7ed701481fa93d3a2b67eff19?s=128&d=identicon&r=PG&f=1", "display_name": "asing", "link": "https://stackoverflow.com/users/1345145/asing"}, "edited": false, "score": 0, "creation_date": 1442255527, "post_id": 32570883, "comment_id": 52998318, "body": "I was wondering if I could get that same number as fseek is returning given the go code (sorry for the poorly written question). Is my only option to convert that image to ppm and read it that way?"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1442256964, "post_id": 32570883, "comment_id": 52999101, "body": "You need to tell us what that <code>imageProvider.Get()</code> call actually does."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1442257005, "post_id": 32570883, "comment_id": 52999128, "body": "@bigthyme: file access in Go is works the same way. You can get the same value by reading, or seeking in the same file. We have no idea what <code>imageProvider</code> is doing between you and the file."}, {"owner": {"reputation": 365, "user_id": 1345145, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/95e953e7ed701481fa93d3a2b67eff19?s=128&d=identicon&r=PG&f=1", "display_name": "asing", "link": "https://stackoverflow.com/users/1345145/asing"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1442257482, "post_id": 32570883, "comment_id": 52999390, "body": "Remove the abstracted code. Thanks @JimB. I don&#39;t want to have to write the file upon getting the request just to get the size if at all possible."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1442258822, "post_id": 32570883, "comment_id": 53000056, "body": "You are comparing apples to oranges. The C code reads a file from the filesystem while to Go code measures the length of a HTTP request body. Maybe the body is gziped? Or these are simply two different files. Read the same file from the FS, once with C, once with Go and don&#39;t try to be clever and you&#39;ll see the same size."}], "answers": [{"comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1442253965, "post_id": 32571003, "comment_id": 52997437, "body": "No, that is not the reason. <i>Decode</i> images are basically just <code>width * height * bitdepth</code> large but you <i>cannot</i> measure that size with the Gode shown."}, {"owner": {"reputation": 1471, "user_id": 2745183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edb5d7f7a643300cb7783dfb12139c07?s=128&d=identicon&r=PG&f=1", "display_name": "JVene", "link": "https://stackoverflow.com/users/2745183/jvene"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1442254505, "post_id": 32571003, "comment_id": 52997756, "body": "The C code is examining the size of the file. Depending on the type of image, that may not in any way represent a size representative of width * height * bitdepth."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1442259064, "post_id": 32571003, "comment_id": 53000168, "body": "Sorry for being unclear. I was talking only about the Go code where you have a <code>[]byte</code> representing the encoded (jpeg, gif, png ...) image or a decoded pixel representation which is w * h * d bytes (+some metadata) or an abstract Image interface."}], "tags": [], "owner": {"reputation": 1471, "user_id": 2745183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edb5d7f7a643300cb7783dfb12139c07?s=128&d=identicon&r=PG&f=1", "display_name": "JVene", "link": "https://stackoverflow.com/users/2745183/jvene"}, "is_accepted": false, "score": -3, "last_activity_date": 1442253564, "creation_date": 1442253564, "answer_id": 32571003, "question_id": 32570883, "link": "https://stackoverflow.com/questions/32570883/image-size-mismatch-between-c-and-go/32571003#32571003", "title": "Image size mismatch between C and GO", "body": "<p>In C, you're reading the raw file. It is not being interpreted as an image file, just a collection of bytes.</p>\n\n<p>In Go (I'm not actually familiar), it appears you're using an image loader, which WOULD interpret the data as an image, decode it (decompress it if it's compressed), giving the size of the DECODED image.</p>\n\n<p>The two would often differ (probably always except for some raw image types).</p>\n"}], "owner": {"reputation": 365, "user_id": 1345145, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/95e953e7ed701481fa93d3a2b67eff19?s=128&d=identicon&r=PG&f=1", "display_name": "asing", "link": "https://stackoverflow.com/users/1345145/asing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1442257396, "creation_date": 1442253172, "last_edit_date": 1442257396, "question_id": 32570883, "link": "https://stackoverflow.com/questions/32570883/image-size-mismatch-between-c-and-go", "title": "Image size mismatch between C and GO", "body": "<p>Reading an image and counting the size of it's bytes yields different results in C vs. Go:</p>\n\n<p>Using the same image, here's my readFile function in c: </p>\n\n<pre><code>FILE *inputFile = fopen(inputFilename, \"rb\");\nif (inputFile == NULL)\n{\n    printf(\"cannot open file %s\", inputFilename);\n    return 0;\n}\nelse\n{\n    fseek(inputFile, 0, SEEK_END);\n    long fsize = ftell(inputFile);\n    rewind(inputFile);\n    return(fsize);\n}\n</code></pre>\n\n<p>In Go, the same image: </p>\n\n<pre><code>// requests the same image as above\nreq, _ := http.NewRequest(\"GET\", url, nil)\n\nresp, _ := client.Do(req)\n\n// Read the image into memory and set up the bytes buffer\nimg, err := ioutil.ReadAll(resp.Body)\nif err != nil {\n    return err\n}\n\nsize := len(img)\nfmt.Println(\"%s\\n\", size)\nreturn size\n</code></pre>\n\n<p>The C length of image is: 2275674\nIn Go, the size is: 1901248</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1442248592, "post_id": 32569479, "comment_id": 52994527, "body": "You don&#39;t need to  &quot;consider maps like associative arrays&quot;, they are hash maps and their behavior is well-defined."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1442250636, "post_id": 32569479, "comment_id": 52995589, "body": "I&#39;m sure this is a FAQ somewhere\u2026 the &quot;why&quot; is simply because of the two sane options, returning the zero value or causing a panic, the former is far more useful in practice (e.g. <code>m[k]++</code> works even if <code>k</code> isn&#39;t yet in the map)."}, {"owner": {"reputation": 1348, "user_id": 1929406, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e9276c036f99fff7dba74db8f5a06bac?s=128&d=identicon&r=PG", "display_name": "kivagant", "link": "https://stackoverflow.com/users/1929406/kivagant"}, "edited": false, "score": 0, "creation_date": 1442259555, "post_id": 32569479, "comment_id": 53000417, "body": "Dave, yes, I think, that this behavior can be used in some logic. But in same time, I sure, that it can make invisible mistakes with large amounts of data."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1442347019, "post_id": 32569479, "comment_id": 53042708, "body": "Go usually handles errors in normal control flow (<code>if err != nil</code>, etc.). Out-of-bounds access, nil pointer deref, and type assertion failure are the oddballs for panicking. In part, that&#39;s because those errors tend to indicate issues with program logic (off by one error setting bounds for a loop over an array, say), not only odd input (missing key in input JSON map, say). There&#39;re also issues with the other designs that would avoid panics (e.g., imagine the problems with unintentionally growing a slice by accessing <code>a[123]</code>)."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1442347080, "post_id": 32569479, "comment_id": 53042747, "body": "That&#39;s not to say Go objectively did The Only Right Thing here (I don&#39;t like that kind of argument) but it might give useful context for understanding the decision and maybe even for how to better write in Go."}], "answers": [{"comments": [{"owner": {"reputation": 1348, "user_id": 1929406, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e9276c036f99fff7dba74db8f5a06bac?s=128&d=identicon&r=PG", "display_name": "kivagant", "link": "https://stackoverflow.com/users/1929406/kivagant"}, "edited": false, "score": 0, "creation_date": 1442259781, "post_id": 32569608, "comment_id": 53000550, "body": "I thought about some function like this one, but perspective of transferring it from package to package saddens me."}, {"owner": {"reputation": 1665, "user_id": 4638952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03791badf72f6918a8910148dfc4401e?s=128&d=identicon&r=PG&f=1", "display_name": "SnoProblem", "link": "https://stackoverflow.com/users/4638952/snoproblem"}, "reply_to_user": {"reputation": 1348, "user_id": 1929406, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e9276c036f99fff7dba74db8f5a06bac?s=128&d=identicon&r=PG", "display_name": "kivagant", "link": "https://stackoverflow.com/users/1929406/kivagant"}, "edited": false, "score": 0, "creation_date": 1442263651, "post_id": 32569608, "comment_id": 53002379, "body": "I don&#39;t see why you would regularly want panic in map access, though.  The &quot;comma, ok&quot; idiom allows for much cleaner error handling than a panic/recover pair."}, {"owner": {"reputation": 1348, "user_id": 1929406, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e9276c036f99fff7dba74db8f5a06bac?s=128&d=identicon&r=PG", "display_name": "kivagant", "link": "https://stackoverflow.com/users/1929406/kivagant"}, "edited": false, "score": 1, "creation_date": 1442316181, "post_id": 32569608, "comment_id": 53023077, "body": "Of course, I will use this way and will try to change my mind to go-way. =)"}], "tags": [], "owner": {"reputation": 1665, "user_id": 4638952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03791badf72f6918a8910148dfc4401e?s=128&d=identicon&r=PG&f=1", "display_name": "SnoProblem", "link": "https://stackoverflow.com/users/4638952/snoproblem"}, "is_accepted": true, "score": 3, "last_activity_date": 1442263702, "last_edit_date": 1442263702, "creation_date": 1442248294, "answer_id": 32569608, "question_id": 32569479, "link": "https://stackoverflow.com/questions/32569479/non-existent-keys-in-mutating-maps-vs-similar-in-arrays/32569608#32569608", "title": "Non-existent keys in mutating maps vs similar in arrays", "body": "<p>The only way to be certain that a zero value from a map isn't due to the key not existing is the \"comma, ok\" idiom (<code>v, ok := m[k]</code>).  If you need a panic response to a non-existent key, the best route is to write a helper function.  </p>\n\n<pre><code>func mapSafe(m map[string]int, key string) (i int) {\n    i, ok: = m[key]\n    if (!ok) {\n        panic(\"Key not in map\")\n    }\n    return\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 1, "last_activity_date": 1442252108, "creation_date": 1442252108, "answer_id": 32570598, "question_id": 32569479, "link": "https://stackoverflow.com/questions/32569479/non-existent-keys-in-mutating-maps-vs-similar-in-arrays/32570598#32570598", "title": "Non-existent keys in mutating maps vs similar in arrays", "body": "<blockquote>\n  <p>How can I make a map with panic-level checking of keys?</p>\n</blockquote>\n\n<p>You cannot.</p>\n"}], "owner": {"reputation": 1348, "user_id": 1929406, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e9276c036f99fff7dba74db8f5a06bac?s=128&d=identicon&r=PG", "display_name": "kivagant", "link": "https://stackoverflow.com/users/1929406/kivagant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 356, "favorite_count": 1, "accepted_answer_id": 32569608, "answer_count": 2, "score": 0, "last_activity_date": 1442263702, "creation_date": 1442247760, "question_id": 32569479, "link": "https://stackoverflow.com/questions/32569479/non-existent-keys-in-mutating-maps-vs-similar-in-arrays", "title": "Non-existent keys in mutating maps vs similar in arrays", "body": "<p>I'm a newbie in golang and this part of a tour of Go about <a href=\"https://tour.golang.org/moretypes/18\" rel=\"nofollow\">mutating maps</a> is killing my world of pink ponies.</p>\n\n<p>Here is an example of the problem:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    a := make([]int, 10)\n    fmt.Println(a[123]) //panic: runtime error: index out of range, good\n\n    b := make(map[int]int, 10)\n    fmt.Println(b[123]) // 0 ? WHAAAT? Not nil, not panic?\n}\n</code></pre>\n\n<p>I know, that I can check element existence with second value, like this:</p>\n\n<pre><code>v, ok := b[11]\nif (!ok) {\n    // do something strange\n}\n</code></pre>\n\n<p>But why I need to do this every time in every place where I need to get something from map? I consider maps like associative arrays, but this behavior is really strange.</p>\n\n<p>How can I make a map with panic-level checking of keys?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5076297"}, "edited": false, "score": 0, "creation_date": 1442259263, "post_id": 32569017, "comment_id": 53000258, "body": "The empty string &quot;&quot; was what I was using, I&#39;m going to implement variadic syntax though. I assume this is similar to *arg/**kwargs from python. Cheers!"}, {"owner": {"reputation": 4657, "user_id": 102699, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/81df87e0d3e269d6fa6a17c6914fd656?s=128&d=identicon&r=PG", "display_name": "MikeSchinkel", "link": "https://stackoverflow.com/users/102699/mikeschinkel"}, "edited": false, "score": 0, "creation_date": 1553090973, "post_id": 32569017, "comment_id": 97256790, "body": "Go <b>does</b> have optional parameters, with variadics."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 4657, "user_id": 102699, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/81df87e0d3e269d6fa6a17c6914fd656?s=128&d=identicon&r=PG", "display_name": "MikeSchinkel", "link": "https://stackoverflow.com/users/102699/mikeschinkel"}, "edited": false, "score": 0, "creation_date": 1553091834, "post_id": 32569017, "comment_id": 97257404, "body": "@MikeSchinkel: variadics are variadics, and I note them as a possible solution in the answer. Since the go language spec does not define &quot;optional parameters&quot;, you would need to borrow the definition from other languages which do, like python or ruby, and those are different concepts which is made more apparent since they also have variadic parameters. When defining and describing programming concepts, the precision of the language used is quite important."}, {"owner": {"reputation": 4657, "user_id": 102699, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/81df87e0d3e269d6fa6a17c6914fd656?s=128&d=identicon&r=PG", "display_name": "MikeSchinkel", "link": "https://stackoverflow.com/users/102699/mikeschinkel"}, "edited": false, "score": 0, "creation_date": 1553101011, "post_id": 32569017, "comment_id": 97263815, "body": "I strongly agree that using precise language is important, which is why I commented. Your statement <i>&quot;No arguments in Go are &quot;optional&quot;;&quot;</i> can be wrongly read it is not possible to call a function without passing named parameters.  Had you said <i>&quot;Go does not have &quot;optional&quot; arguments as a generally understood concept in other languages&quot;</i> then I would not have commented. Alternatively I would not have commented had you started with <i>&quot;No arguments in Go are &quot;optional&quot;,  but Go does have variadics&quot;</i> since your mention of variadics at the end suffers from the common <code>#tldr;</code> problem on the web."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 4657, "user_id": 102699, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/81df87e0d3e269d6fa6a17c6914fd656?s=128&d=identicon&r=PG", "display_name": "MikeSchinkel", "link": "https://stackoverflow.com/users/102699/mikeschinkel"}, "edited": false, "score": 1, "creation_date": 1553101256, "post_id": 32569017, "comment_id": 97263970, "body": "@MikeSchinkel: that&#39;s a fair enough comment on the semantics of the first line, and could have just been submitted as an edit on the post (that is accepted practice on SO after all)."}, {"owner": {"reputation": 4657, "user_id": 102699, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/81df87e0d3e269d6fa6a17c6914fd656?s=128&d=identicon&r=PG", "display_name": "MikeSchinkel", "link": "https://stackoverflow.com/users/102699/mikeschinkel"}, "edited": false, "score": 0, "creation_date": 1553101544, "post_id": 32569017, "comment_id": 97264146, "body": "Fair enough <i>(this parenthetical to get past SO&#39;s requirement for more than 15 characters per comment.)</i>"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 12, "last_activity_date": 1553101277, "last_edit_date": 1553101277, "creation_date": 1442246262, "answer_id": 32569017, "question_id": 32568977, "link": "https://stackoverflow.com/questions/32568977/golang-pass-nil-as-optional-argument-to-a-function/32569017#32569017", "title": "Golang pass nil as optional argument to a function?", "body": "<p>Go does not have \"optional\" arguments as a generally understood concept in other languages; <code>nil</code> is just the zero value for an interface (<code>io.Reader</code> in this case).</p>\n\n<p>The equivalent zero value for a string is an empty string:</p>\n\n<pre><code>getChallenges(\"\")\n</code></pre>\n\n<p>If you want to accept 0 or more of the same argument type, you use the variadic syntax:</p>\n\n<pre><code>func getChallenges(after ...string) ([]challenge, string, error)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1047, "user_id": 2822466, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/jXerW.jpg?s=128&g=1", "display_name": "ggaaooppeenngg", "link": "https://stackoverflow.com/users/2822466/ggaaooppeenngg"}, "is_accepted": false, "score": -1, "last_activity_date": 1442246543, "creation_date": 1442246543, "answer_id": 32569104, "question_id": 32568977, "link": "https://stackoverflow.com/questions/32568977/golang-pass-nil-as-optional-argument-to-a-function/32569104#32569104", "title": "Golang pass nil as optional argument to a function?", "body": "<p>You can use reflect.\nIn fact <code>io.Reader</code> is a interface.</p>\n\n<p>So you can define signature like <code>func getChallenges(after interface{}) ([]challenge, string, error)</code></p>\n\n<p>interface{} is a empty interface, that is interface for anything.</p>\n\n<p>But I suggest you use syntax <code>args...</code> to pass slice , refer to <code>fmt.Printf</code> implementation for usage, because if you pass no string the slice len is 0 and \nthis will avoid the reflect which I think too heavy for your function.</p>\n"}, {"tags": [], "owner": {"reputation": 1074, "user_id": 5312548, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/89a837174bf7e62b26df5afb3e2bc497?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin Tripathi", "link": "https://stackoverflow.com/users/5312548/nitin-tripathi"}, "is_accepted": false, "score": 4, "last_activity_date": 1442247095, "creation_date": 1442247095, "answer_id": 32569270, "question_id": 32568977, "link": "https://stackoverflow.com/questions/32568977/golang-pass-nil-as-optional-argument-to-a-function/32569270#32569270", "title": "Golang pass nil as optional argument to a function?", "body": "<p>you can use ellipse operator to send the optional parameters.. don't pass anything in optional parameter and check the length of parameter.\nit should solve your problem</p>\n\n<pre><code>func foo(params ...int) {\n   fmt.Println(len(params))\n}\n\nfunc main() {\n    foo()\n    foo(1)\n    foo(1,2,3)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 118, "user_id": 4793074, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-y9Wb12vU4fk/AAAAAAAAAAI/AAAAAAABEZs/seLXCAMAEuY/photo.jpg?sz=128", "display_name": "Chris Harrington", "link": "https://stackoverflow.com/users/4793074/chris-harrington"}, "edited": false, "score": 3, "creation_date": 1474183581, "post_id": 32580744, "comment_id": 66421514, "body": "A huge downside of making the argument a *string is the fact that you can&#39;t take the address of a string literal, nor does it automatically box up the string for you. <a href=\"https://play.golang.org/p/d4jvq5xrAk\" rel=\"nofollow noreferrer\">play.golang.org/p/d4jvq5xrAk</a>"}, {"owner": {"reputation": 4657, "user_id": 102699, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/81df87e0d3e269d6fa6a17c6914fd656?s=128&d=identicon&r=PG", "display_name": "MikeSchinkel", "link": "https://stackoverflow.com/users/102699/mikeschinkel"}, "edited": false, "score": 0, "creation_date": 1553090826, "post_id": 32580744, "comment_id": 97256659, "body": "The <i>&quot;just add another function&quot;</i> argument can result in an explosion of methods required to deal with multiple permutations, requires the burden of deciding on meaningful, discoverable and rememberable names for those methods, and adds burden to learning the packages that use more methods vs. less. #jmtcw"}], "tags": [], "owner": {"reputation": 1218, "user_id": 749836, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/HjVtW.jpg?s=128&g=1", "display_name": "coquin", "link": "https://stackoverflow.com/users/749836/coquin"}, "is_accepted": false, "score": 10, "last_activity_date": 1442304070, "creation_date": 1442304070, "answer_id": 32580744, "question_id": 32568977, "link": "https://stackoverflow.com/questions/32568977/golang-pass-nil-as-optional-argument-to-a-function/32580744#32580744", "title": "Golang pass nil as optional argument to a function?", "body": "<p>You can modify you function to receive pointer value, like this:</p>\n\n<p><code>func getChallenges(after *string) ([]challenge, string, error)</code></p>\n\n<p>Then you can pass <code>nil</code> as an argument to it. But don't forget to check <code>after</code> for <code>nil</code> value inside your function before dereferencing it, or you will get a nil pointer exception:</p>\n\n<pre><code>func getChallenges(after *string) ([]challenge, string, error) {\n    if after == nil {\n        // No value specified\n    } else {\n        fmt.Printf(\"After: %s\\n\", *after) // Note pointer dereferencing with \"*\"\n    }\n    // ...\n}\n</code></pre>\n\n<p><strong>Another option:</strong></p>\n\n<p>Just use two functions:</p>\n\n<pre><code>func getChallenges(after string) {}\n\nfunc getAllChallenges() {\n    return getChallenges(/* some default value here */)\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5076297"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29389, "favorite_count": 3, "answer_count": 4, "score": 16, "last_activity_date": 1571680884, "creation_date": 1442246093, "last_edit_date": 1571680884, "question_id": 32568977, "link": "https://stackoverflow.com/questions/32568977/golang-pass-nil-as-optional-argument-to-a-function", "title": "Golang pass nil as optional argument to a function?", "body": "<p>In Golang, <code>http.NewRequest</code> has a specification like this:</p>\n\n<pre><code>func NewRequest(method, urlStr string, body io.Reader) (*Request, error)\n</code></pre>\n\n<p>However, I can pass <code>nil</code> as the <code>body</code> option if I don't want to pass the <code>body</code> to an <code>io.Reader</code> object, like this:</p>\n\n<pre><code>req, err := http.NewRequest(\"GET\", \"http://www.blahblah.org\", nil)\n</code></pre>\n\n<p>How do I implement this functionality in my code? I have a function that I want to pass an optional string value so that it can page through API results however if I pass a <code>nil</code> to the string input I get this:</p>\n\n<blockquote>\n  <p>./snippets.go:32: cannot convert nil to type string</p>\n</blockquote>\n\n<p>The parameters for my function look like this:</p>\n\n<pre><code>func getChallenges(after string) ([]challenge, string, error)\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 4, "last_activity_date": 1442245478, "creation_date": 1442245478, "answer_id": 32568806, "question_id": 32568746, "link": "https://stackoverflow.com/questions/32568746/how-to-buffer-a-response-in-web-app-in-golang/32568806#32568806", "title": "How to buffer a response in web app in golang?", "body": "<p><code>bytes.Buffer</code> has a <a href=\"http://golang.org/pkg/bytes/#Buffer.Bytes\" rel=\"nofollow\"><code>Bytes</code></a> method, so you don't actually need to call <code>String</code> and convert it to <code>[]byte</code>:</p>\n\n<pre><code>w.Write(buf.Bytes())\n</code></pre>\n\n<p>Additionally, it's a good practice to write errors to stderr. Just replace your <code>fmt</code> with <code>log</code>:</p>\n\n<pre><code>if err != nil {\n    log.Println(err)\n    http.Error(w, err.Error(), http.StatusInternalServerError)\n    return\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1665, "user_id": 4638952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03791badf72f6918a8910148dfc4401e?s=128&d=identicon&r=PG&f=1", "display_name": "SnoProblem", "link": "https://stackoverflow.com/users/4638952/snoproblem"}, "is_accepted": false, "score": 2, "last_activity_date": 1442246759, "creation_date": 1442246759, "answer_id": 32569163, "question_id": 32568746, "link": "https://stackoverflow.com/questions/32568746/how-to-buffer-a-response-in-web-app-in-golang/32569163#32569163", "title": "How to buffer a response in web app in golang?", "body": "<p><code>bytes.Buffer</code> has a built-in method for writing out to an <code>io.Writer</code>:</p>\n\n<pre><code>func get_handler(w http.ResponseWriter, r *http.Request) {\n    buf := new(bytes.Buffer)\n\n    //fill buffer\n\n    _,err := buf.WriteTo(w)\n    if err != nil { \n         log.Println(err)\n    }\n}\n</code></pre>\n\n<p>docs:  <a href=\"http://golang.org/pkg/bytes/#Buffer.WriteTo\" rel=\"nofollow\">http://golang.org/pkg/bytes/#Buffer.WriteTo</a></p>\n"}, {"tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": false, "score": 2, "last_activity_date": 1442272114, "creation_date": 1442272114, "answer_id": 32575267, "question_id": 32568746, "link": "https://stackoverflow.com/questions/32568746/how-to-buffer-a-response-in-web-app-in-golang/32575267#32575267", "title": "How to buffer a response in web app in golang?", "body": "<p>You can use a <code>bytes.Buffer</code> \"as is\" by writing into it, but at the cost of discarding the buffer on every request.</p>\n\n<p>Using a pooled approach (that safely resets the contents between use, but retains the buffer) can have some gains:</p>\n\n<pre><code>var bufPool *bpool.BufferPool\n\nfunc YourHandler(w http.ResponseWriter, r *http.Request) {\n    buf := bufPool.Get()\n    defer bufPool.Put(buf)\n    err := template.ExecuteTemplate(buf, \"forms/create.html\", user)\n    // or err := json.NewEncoder(buf).Encode(value)\n    if err != nil {\n      return err\n    }\n\n    buf.WriteTo(w)\n}\n</code></pre>\n\n<p>This uses the <a href=\"https://github.com/oxtoacart/bpool\" rel=\"nofollow\">bpool</a> library.</p>\n"}], "owner": {"reputation": 487, "user_id": 2078517, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1191996186/picture?type=large", "display_name": "tlama", "link": "https://stackoverflow.com/users/2078517/tlama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2166, "favorite_count": 0, "accepted_answer_id": 32568806, "answer_count": 3, "score": 3, "last_activity_date": 1442272114, "creation_date": 1442245266, "question_id": 32568746, "link": "https://stackoverflow.com/questions/32568746/how-to-buffer-a-response-in-web-app-in-golang", "title": "How to buffer a response in web app in golang?", "body": "<p>I want to make a hello world web app that will properly catch template error. So I need to buffer the response but don't know how to do it. I've put together this code. Is this the way to buffer a response in golang?  </p>\n\n<pre><code>func get_handler(w http.ResponseWriter, r *http.Request) {\n\n    buf := new(bytes.Buffer)\n    err := templates.ExecuteTemplate(buf, \"hello.html\", nil)\n    if err != nil {\n        fmt.Println(err.Error())\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n    w.Write([]byte(buf.String()))\n}\n</code></pre>\n"}, {"tags": ["logging", "go"], "answers": [{"comments": [{"owner": {"reputation": 13257, "user_id": 335717, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66fc33d259df37b17198d0d76e0ac169?s=128&d=identicon&r=PG", "display_name": "Radek Simko", "link": "https://stackoverflow.com/users/335717/radek-simko"}, "edited": false, "score": 0, "creation_date": 1442241916, "post_id": 32566918, "comment_id": 52990407, "body": "That still means I&#39;ll have to do post-processing of either one or multiple logs, won&#39;t I? I know I could use <code>io.MultiWriter</code> to write into multiple files, but to <i>write everything</i> (twice), not filtered messages."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 13257, "user_id": 335717, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66fc33d259df37b17198d0d76e0ac169?s=128&d=identicon&r=PG", "display_name": "Radek Simko", "link": "https://stackoverflow.com/users/335717/radek-simko"}, "edited": false, "score": 0, "creation_date": 1442242601, "post_id": 32566918, "comment_id": 52990868, "body": "What kind of post-processing? If you assign each library a logger that writes to that file then all log messages from that library should be in that file. Or is that not what you&#39;re looking for?"}, {"owner": {"reputation": 13257, "user_id": 335717, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66fc33d259df37b17198d0d76e0ac169?s=128&d=identicon&r=PG", "display_name": "Radek Simko", "link": "https://stackoverflow.com/users/335717/radek-simko"}, "edited": false, "score": 0, "creation_date": 1442242918, "post_id": 32566918, "comment_id": 52991073, "body": "Ah, I&#39;m sorry, I see your point now. it will only work if the library exposes the Logger, which (from my experience) most don&#39;t."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 2, "last_activity_date": 1442239653, "creation_date": 1442239653, "answer_id": 32566918, "question_id": 32566740, "link": "https://stackoverflow.com/questions/32566740/how-to-separate-logs-from-different-packages/32566918#32566918", "title": "How to separate logs from different packages", "body": "<p>If the package exposes its logger to you, you can create a new logger for it with a prefix:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n\n    \"example.com/lib/foo\"\n)\n\nfunc main() {\n    foo.Logger := log.New(os.Stderr, \"libfoo: \", log.LstdFlags)\n    // Do stuff.\n}\n</code></pre>\n\n<p>This way, <code>foo</code>'s messages will look like this:</p>\n\n<pre><code>libfoo: 2015/09/14 17:04:52 Something's happened!\n</code></pre>\n\n<p>Additionally, <code>log.New</code> accepts an <code>io.Writer</code>, so you can open any file and make it just write there directly.</p>\n"}], "owner": {"reputation": 13257, "user_id": 335717, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66fc33d259df37b17198d0d76e0ac169?s=128&d=identicon&r=PG", "display_name": "Radek Simko", "link": "https://stackoverflow.com/users/335717/radek-simko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1442239653, "creation_date": 1442239153, "question_id": 32566740, "link": "https://stackoverflow.com/questions/32566740/how-to-separate-logs-from-different-packages", "title": "How to separate logs from different packages", "body": "<p>I'm struggling to find out how to separate logs coming from different packages.</p>\n\n<p><strong>Example:</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"github.com/org/verbose\"\n)\n\nfunc main() {\n    log.Print(\"Hello World\")\n    verbose.DoSomething() // Which will generate a lot log messages\n}\n</code></pre>\n\n<p>I know there's flag <code>log.Llongfile</code> which I can enable and then each line inside the log will contain the full path of the file where is the log message coming from. This however still means I'll need to do some post-processing to filter out from that single file what I don't want and what I do want.</p>\n\n<p>I'd like to do that filtering in real-time already, so I end up having <code>verbose-lib.log</code> and <code>my-app.log</code> or something like that.</p>\n\n<p>I'm looking for a solution that will work with most existing OSS packages - i.e. I cannot just change logging mechanisms in these libraries in any way I want, hence custom logging libraries are out of the game I reckon.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 5, "creation_date": 1442234314, "post_id": 32564935, "comment_id": 52984928, "body": "Because they can be removed without side effects (except for <code>init</code>, which always runs). Variables less so because their instantiation may have side effects. Also, unused variables on package level are allowed."}, {"owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "reply_to_user": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1442237405, "post_id": 32564935, "comment_id": 52987170, "body": "I thought that they do that to keep the code clean too not only to avoid side effects(i.e. allocations)"}, {"owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "edited": false, "score": 2, "creation_date": 1442237701, "post_id": 32564935, "comment_id": 52987396, "body": "Unused types (interfaces, structs) also aren&#39;t an error. I think the only real answer is that while a programmer can reasonably avoid unused local variables and imports, it would be too difficult to build anything if you could never compile an unused helper function or type."}, {"owner": {"reputation": 3818, "user_id": 1247113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRMFj.png?s=128&g=1", "display_name": "rob74", "link": "https://stackoverflow.com/users/1247113/rob74"}, "edited": false, "score": 1, "creation_date": 1442238452, "post_id": 32564935, "comment_id": 52987971, "body": "I also wondered about why unused function parameters aren&#39;t flagged as errors, but I figured that obviously must be so that a type can satisfy an interface even though it doesn&#39;t need all the parameters of a certain method."}, {"owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "reply_to_user": {"reputation": 3818, "user_id": 1247113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRMFj.png?s=128&g=1", "display_name": "rob74", "link": "https://stackoverflow.com/users/1247113/rob74"}, "edited": false, "score": 0, "creation_date": 1442238929, "post_id": 32564935, "comment_id": 52988298, "body": "@rob74 I actually wrote an answer about that one: <a href=\"http://stackoverflow.com/questions/22549228/why-does-golang-allow-compilation-of-unused-function-parameters/22549439#22549439\" title=\"why does golang allow compilation of unused function parameters\">stackoverflow.com/questions/22549228/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "edited": false, "score": 0, "creation_date": 1442314482, "post_id": 32564935, "comment_id": 53021985, "body": "Calling one of the functions with reflection would also cause an issue for this matter. If you would let the compiler be strict on this you wouldn&#39;t be able to compile reasonable &quot;valid&quot; code that calls a function by reflection."}, {"owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "edited": false, "score": 0, "creation_date": 1442332847, "post_id": 32564935, "comment_id": 53035001, "body": "@ErwinRenkema I&#39;m not sure I understand this. Is it possible to call arbitrary functions though reflection?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "edited": false, "score": 0, "creation_date": 1442336361, "post_id": 32564935, "comment_id": 53036929, "body": "Yes you can invoke methods through reflection."}, {"owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "edited": false, "score": 0, "creation_date": 1442341193, "post_id": 32564935, "comment_id": 53039546, "body": "right... methods, though I think it&#39;s doable to find that with static analysis."}, {"owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "reply_to_user": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "edited": false, "score": 0, "creation_date": 1443879970, "post_id": 32564935, "comment_id": 53673213, "body": "@Jsor It doesn&#39;t make sense to me. Why would it be too difficult to compile something that you don&#39;t use anyway?"}, {"owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "edited": false, "score": 0, "creation_date": 1443909153, "post_id": 32564935, "comment_id": 53681861, "body": "@AnthonyHunt too difficult for the <b>programmer</b> to build something."}], "answers": [{"tags": [], "owner": {"reputation": 494, "user_id": 6392978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C7NNr.jpg?s=128&g=1", "display_name": "Opnauticus", "link": "https://stackoverflow.com/users/6392978/opnauticus"}, "is_accepted": false, "score": 3, "last_activity_date": 1464905889, "last_edit_date": 1495539966, "creation_date": 1464905889, "answer_id": 37603061, "question_id": 32564935, "link": "https://stackoverflow.com/questions/32564935/why-does-golang-allow-compilation-of-unused-functions/37603061#37603061", "title": "Why Does Golang Allow Compilation of Unused Functions?", "body": "<p>I believe this is a combination of scope and the default interface {}.</p>\n\n<p>This is the same reason that you can declare a variable at the package level that is unused and the code will build just fine.</p>\n\n<p>This snippet is perfectly valid go code:</p>\n\n<pre><code>package main\nimport (\n  \"fmt\"\n  \"time\"\n)\n\nvar (\n  testVar = \"sup\"\n)\n\nfunc main() {\n  start := time.Now()\n\n  fmt.Println(\"This sure was a test\")\n\n  //Mon Jan 2 15:04:05 -0700 MST 2006\n  fmt.Println(\"Finished!\\nTimeElapsed:\", time.Since(start))\n}\n</code></pre>\n\n<p><i>Even though</i> the variable <b>testVar</b> is never used.</p>\n\n<p>There are several related questions here, and I think they all have the same general answer. </p>\n\n<ul>\n<li>Why are unused variables not allowed?</li>\n<li>Why are unused function parameters allowed if unused variables are not?</li>\n<li>Why are unused functions/structs allowed?</li>\n</ul>\n\n<p>...</p>\n\n<p>The general answer is that unused variables in the scope of a function are ALWAYS either a waste of compiler time, or a legitimate error - so they are strictly not allowed.</p>\n\n<p>However, unused function parameters, as well as private structs and functions, may satisfy an interface. At the very least they ALL satisfy the default interface {}. And as such, they are not at all guaranteed to be errors..</p>\n\n<p>There doesn't appear to be any official documentation outlining the reasoning behind this particular corner of the golang philosophy, but as pointed out in <a href=\"https://stackoverflow.com/a/22549439/6392978\">the answer to a similar question</a> you might have better luck finding answers and asking questions on the <a href=\"https://groups.google.com/forum/#!forum/golang-nuts\" rel=\"nofollow noreferrer\">golang-nuts forum</a>.</p>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1939, "favorite_count": 0, "answer_count": 1, "score": 9, "last_activity_date": 1464905889, "creation_date": 1442234005, "last_edit_date": 1443879849, "question_id": 32564935, "link": "https://stackoverflow.com/questions/32564935/why-does-golang-allow-compilation-of-unused-functions", "title": "Why Does Golang Allow Compilation of Unused Functions?", "body": "<p>Private/unexported functions not used could be detected. Why the compiler doesn't complain like it does for unused variables?</p>\n\n<p>Edit: The question also applies to unused private types/interfaces too.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "edited": false, "score": 0, "creation_date": 1442240077, "post_id": 32562072, "comment_id": 52989094, "body": "Thanks alot, very helpful!"}], "tags": [], "owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "is_accepted": true, "score": 2, "last_activity_date": 1442232501, "last_edit_date": 1442232501, "creation_date": 1442225056, "answer_id": 32562072, "question_id": 32560810, "link": "https://stackoverflow.com/questions/32560810/how-can-i-check-if-a-posted-file-via-multipart-form-is-of-image-type-and-that-it/32562072#32562072", "title": "How can I check if a posted file via multipart form is of image type and that it is less than a given maxsize in Go?", "body": "<p>To avoid having tons of data uploaded to your server, I recommend wrapping your <code>multipart.File</code>, which is essentially an <code>io.Reader</code> with an <code>io.LimitedReader</code>, like</p>\n\n<pre><code>wrapped := io.LimitReader(mpf,10*1024*1024)    //10 MiB\n</code></pre>\n\n<p>and then work on the <code>wrapped</code> reader. This will read the specified amount of bytes and then return EOF, so anything larger than 10 MiB will be truncated.</p>\n\n<p>To check whether the received data is an image, you have two choices:</p>\n\n<ol>\n<li>Parse the data with <code>image.Decode(io.Reader)</code>, that will throw an error if it can't parse the data as an image - this also allows you to check whether the received data is complete and correct. Note however that this takes some time/steals performance. Maybe you want to avoid this, if you just discard the decoded image afterwards. Be sure to check the <a href=\"http://golang.org/pkg/image/\" rel=\"nofollow\">godoc</a> for the image package, as you will have to import any formats you expect to decode.</li>\n<li>Check the <a href=\"https://en.wikipedia.org/wiki/Magic_number_(programming)\" rel=\"nofollow\">magic number</a>, PNG files for example have <code>89 50 4e 47 0d 0a 1a 0a</code> as their magic number. However, a correct magic number does not imply a correct image. Especially if you truncated larger images to 10 MiB.</li>\n</ol>\n\n<p>If you have the power needed to decode every image at hand, go for it - the results should be more precise, but this is just a recommendation.</p>\n\n<p>I would rather not check the FileHeader (pkg/mime/multipart/#FileHeader) for the file type, I expect it to be unreliable. You might, however, find information about the (original) file size in there, I recommend just dumping the FileHeaders for some requests.</p>\n"}], "owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 564, "favorite_count": 1, "accepted_answer_id": 32562072, "answer_count": 1, "score": 3, "last_activity_date": 1442232501, "creation_date": 1442221116, "question_id": 32560810, "link": "https://stackoverflow.com/questions/32560810/how-can-i-check-if-a-posted-file-via-multipart-form-is-of-image-type-and-that-it", "title": "How can I check if a posted file via multipart form is of image type and that it is less than a given maxsize in Go?", "body": "<p>I would like to know if there is a way of checking the size and the type before uploading it to the server. I am worried about people trying to upload really large files to slow the server down on purpose.</p>\n\n<p>I only know how to check the size of a file after I have copied it to the server. I don't know how to check the file type. I would like to do it before having to upload 2 GB of data, and then validating the file.</p>\n\n<p>This is what I have so far but this copies the file to the server first which is not what I want.</p>\n\n<pre><code>func userUploadImage(w http.ResponseWriter, r *http.Request, _ httprouter.Params) error {\n    mpf, mpfh, err := r.FormFile(\"file\")\n    if err != nil {\n        return nil\n    }\n    defer mpf.Close()\n\n    dstFile, err := os.Create(config.UploadDir + \"/img/\" + mpfh.Filename)\n    if err != nil {\n        return err\n    }\n    defer dstFile.Close()\n\n    size, err := io.Copy(dstFile, mpf)\n    if err != nil {\n        return err\n    }\n\n    spew.Dump(size)\n    return nil\n}\n</code></pre>\n"}, {"tags": ["xml", "go", "cdata"], "comments": [{"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 1, "creation_date": 1442222288, "post_id": 32560664, "comment_id": 52977803, "body": "CDATA is a node; if it were not it could not be created by the XML DOM; that is, it is <i>not</i> just an encoding detail. Not sure why it just comes in a text node (?) though, or maybe that is just the representation.. view the node type, perhaps."}, {"owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "reply_to_user": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 0, "creation_date": 1442226492, "post_id": 32560664, "comment_id": 52980170, "body": "@user2864740 [Not disagreeing with your point, just trying to understand the rationale behind the thing] Sure it is a node. But when I request the next token, I don&#39;t see any difference (as you write). So I&#39;d expect it to be joined together, as from the user perspective (the program above doesn&#39;t see any information about that CDATA node) it is the same."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1442229415, "post_id": 32560664, "comment_id": 52981873, "body": "So your question is basically: &quot;Why does Decoder Next work as documented (i.e. provide next token) instead of coalescing CDATA tokens and returning just one token for a sequence of CDATA tokens?&quot;  Even the Streaming API for XML (StAX) does not coalesce these token in the default mode. Not sure what answer to give, it is just the way it works. What type of answer would you expect to see?"}, {"owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1442230157, "post_id": 32560664, "comment_id": 52982345, "body": "@Volker I don&#39;t know what type of answer I expect. Probably a technical answer in the form &quot;the behaviour is on purpose, because of technical reason XYZ and the xml.CharData sections can&#39;t be joined together because ZYX&quot;. I do see the practical reasoning from the librarays programming point of view, but maybe there is some more behind that."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1442235320, "post_id": 32560664, "comment_id": 52985597, "body": "No, there is no deep technical reason. Joining the CDATA sections is trivial, the actual API is clean and straightforward and adding an option like <code>Coalescence bool</code> just makes the API complicated while giving very little extra value."}], "owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1442220630, "creation_date": 1442220630, "question_id": 32560664, "link": "https://stackoverflow.com/questions/32560664/different-token-for-cdata-section-on-purpose", "title": "Different token for CDATA section on purpose?", "body": "<p>Is there a special purpose for the extra token of the CDATA section in the following program?</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    src := `&lt;root&gt;a&lt;![CDATA[b]]&gt;c&lt;/root&gt;`\n    r := strings.NewReader(src)\n\n    dec := xml.NewDecoder(r)\n    for {\n        tok, err := dec.Token()\n        if err != nil {\n            fmt.Println(err)\n            break\n        }\n        fmt.Printf(\"%#v\\n\", tok)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/JRXUztgrfo\" rel=\"nofollow\">https://play.golang.org/p/JRXUztgrfo</a></p>\n\n<p>The output is</p>\n\n<pre><code>xml.StartElement{Name:xml.Name{Space:\"\", Local:\"root\"}, Attr:[]xml.Attr{}}\nxml.CharData{0x61}\nxml.CharData{0x62}\nxml.CharData{0x63}\nxml.EndElement{Name:xml.Name{Space:\"\", Local:\"root\"}}\nEOF\n</code></pre>\n\n<p>but I would expect something like </p>\n\n<pre><code>xml.StartElement{Name:xml.Name{Space:\"\", Local:\"root\"}, Attr:[]xml.Attr{}}\nxml.CharData{0x61, 0x62, 0x63}\nxml.EndElement{Name:xml.Name{Space:\"\", Local:\"root\"}}\nEOF\n</code></pre>\n\n<p>as the CDATA section should be transparent. Is there any reasoning on this?</p>\n\n<p>The <code>a&lt;![CDATA[b]]&gt;c</code> should be equivalent to <code>abc</code> from the user's point of view.</p>\n"}, {"tags": ["go", "vmware"], "comments": [{"owner": {"reputation": 1760, "user_id": 3369324, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LBmEb.png?s=128&g=1", "display_name": "Cel Skeggs", "link": "https://stackoverflow.com/users/3369324/cel-skeggs"}, "edited": false, "score": 0, "creation_date": 1442212454, "post_id": 32558278, "comment_id": 52972967, "body": "What doubts do you have?"}, {"owner": {"reputation": 1, "user_id": 4422939, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_sjaogehSdY/AAAAAAAAAAI/AAAAAAAAAhk/VyAmLvXKYkI/photo.jpg?sz=128", "display_name": "Bhuvana chinnadurai", "link": "https://stackoverflow.com/users/4422939/bhuvana-chinnadurai"}, "reply_to_user": {"reputation": 1760, "user_id": 3369324, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LBmEb.png?s=128&g=1", "display_name": "Cel Skeggs", "link": "https://stackoverflow.com/users/3369324/cel-skeggs"}, "edited": false, "score": 0, "creation_date": 1442212885, "post_id": 32558278, "comment_id": 52973141, "body": "The QueryChangedDiskAreas method takes req as one of the arguments.req is of types.QueryChangedDiskAreas type.I tried to assign virtual machine reference to req.this .But i am getting  The request refers to an unexpected or unknown type error.am i doing it wrongly?"}, {"owner": {"reputation": 1760, "user_id": 3369324, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LBmEb.png?s=128&g=1", "display_name": "Cel Skeggs", "link": "https://stackoverflow.com/users/3369324/cel-skeggs"}, "edited": false, "score": 0, "creation_date": 1442213041, "post_id": 32558278, "comment_id": 52973200, "body": "I suggest linking to the documentation about what you&#39;re worried about, and to try to explain as clearly as possible why you&#39;re worried about it."}, {"owner": {"reputation": 1, "user_id": 4422939, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_sjaogehSdY/AAAAAAAAAAI/AAAAAAAAAhk/VyAmLvXKYkI/photo.jpg?sz=128", "display_name": "Bhuvana chinnadurai", "link": "https://stackoverflow.com/users/4422939/bhuvana-chinnadurai"}, "reply_to_user": {"reputation": 1760, "user_id": 3369324, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LBmEb.png?s=128&g=1", "display_name": "Cel Skeggs", "link": "https://stackoverflow.com/users/3369324/cel-skeggs"}, "edited": false, "score": 0, "creation_date": 1442213564, "post_id": 32558278, "comment_id": 52973390, "body": "I posted the code that i have.Can you please have a look at it?"}, {"owner": {"reputation": 1760, "user_id": 3369324, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LBmEb.png?s=128&g=1", "display_name": "Cel Skeggs", "link": "https://stackoverflow.com/users/3369324/cel-skeggs"}, "edited": false, "score": 0, "creation_date": 1442213613, "post_id": 32558278, "comment_id": 52973420, "body": "You posted it in the wrong location. You posted it as an answer, but it is not an answer. Please edit your code into your question instead. (Use the &#39;edit&#39; link on your original question.)"}, {"owner": {"reputation": 1, "user_id": 4422939, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_sjaogehSdY/AAAAAAAAAAI/AAAAAAAAAhk/VyAmLvXKYkI/photo.jpg?sz=128", "display_name": "Bhuvana chinnadurai", "link": "https://stackoverflow.com/users/4422939/bhuvana-chinnadurai"}, "reply_to_user": {"reputation": 1760, "user_id": 3369324, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LBmEb.png?s=128&g=1", "display_name": "Cel Skeggs", "link": "https://stackoverflow.com/users/3369324/cel-skeggs"}, "edited": false, "score": 0, "creation_date": 1442213814, "post_id": 32558278, "comment_id": 52973518, "body": "Sorry .I have edited now"}], "owner": {"reputation": 1, "user_id": 4422939, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_sjaogehSdY/AAAAAAAAAAI/AAAAAAAAAhk/VyAmLvXKYkI/photo.jpg?sz=128", "display_name": "Bhuvana chinnadurai", "link": "https://stackoverflow.com/users/4422939/bhuvana-chinnadurai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 443, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1442213746, "creation_date": 1442211067, "last_edit_date": 1442213746, "question_id": 32558278, "link": "https://stackoverflow.com/questions/32558278/querychangeddiskareas-method", "title": "QueryChangedDiskAreas method", "body": "<p>I m new to vmware and i started exploring different formats in vmdk ,snapshots and all.I m using golang as a programming language.I found out that govmomi library that supports vsphere APIs that is similar to pyvmomi .I ve created snapshots using createSnapshotTask method .But i m stuck with QuerychangedDiskAreas method that retrieves list of changed blocks.I have some doubts regarding it.Can anyone help me to clear my doubts?\nThis is the code to get changed blocks .</p>\n\n<p>func main() {</p>\n\n<pre><code>ctx, cancel := context.WithCancel(context.Background())\ndefer cancel()\n\nflag.Parse()\n\n// Parse URL from string\nu, err := url.Parse(*urlFlag)\nif err != nil {\n    exit(err)\n}\n\n// Override username and/or password as required\nprocessOverride(u)\n\n// Connect and log in to ESX or vCenter\nc, err := govmomi.NewClient(ctx, u, *insecureFlag)\nif err != nil {\n    exit(err)\n}\n\nf := find.NewFinder(c.Client, true)\n\n// Find one and only datacenter\ndc, err := f.DefaultDatacenter(ctx)\nif err != nil {\n    exit(err)\n}\n\n// Make future calls local to this datacenter\nf.SetDatacenter(dc)\n\n// Find datastores in datacenter\ndss, err := f.DatastoreList(ctx, \"*\")\nif err != nil {\n    exit(err)\n}\n\npc := property.DefaultCollector(c.Client)\n\n// Convert datastores into list of references\nvar refs []types.ManagedObjectReference\nfor _, ds := range dss {\n    refs = append(refs, ds.Reference())\n}\n\n// Retrieve summary property for all datastores\nvar dst []mo.Datastore\nerr = pc.Retrieve(ctx, refs, []string{\"summary\"}, &amp;dst)\nif err != nil {\n    exit(err)\n}\n\n//get Virtual Machines\nvms, err := f.VirtualMachineList(ctx, \"*\")\nif err != nil {\n\n}\n\n//apps, _ := f.VirtualAppList(ctx, \"\")\n//fmt.Println(apps[0].String())\n\n//r.dataStore = r.f.DefaultDatastore(r.ctx, \"*\")\n// Convert virtual machines into list of references\nvar vmrefs types.ManagedObjectReference\nvar device *types.VirtualDevice\nfmt.Println(device)\nvar devices object.VirtualDeviceList\nname := \"\"\nfor i, vm := range vms {\n    name, _ = vm.Name(ctx)\n    if name == \"Ubuntu Target\" {\n        fmt.Println(name)\n        devices, _ = vm.Device(ctx)\n        device = devices[i].GetVirtualDevice()\n\n        vmrefs = vm.Common.Reference()\n\n        break\n    }\n\n}\n\nreq := new(types.CreateSnapshot_Task)\nreq.Description = \"Snapshot created  by Data Migration Tool.\"\nreq.Name = \"Ubuntu Target\"\nreq.Memory = false\n\nreq.This.Type = vmrefs.Type\nreq.This.Value = vmrefs.Value\ns, e := methods.CreateSnapshot_Task(ctx, c.RoundTripper, req)\nif e != nil {\n    fmt.Println(e)\n\n}\n\ntime.Sleep(time.Second * 3)\n\nqueryReq := new(types.QueryChangedDiskAreas)\nqueryReq.ChangeId = \"*\"\nqueryReq.DeviceKey = device.Key\nqueryReq.Snapshot = new(types.ManagedObjectReference)\nqueryReq.Snapshot.Type = s.Returnval.Type\nqueryReq.Snapshot.Value = s.Returnval.Value\nqueryReq.StartOffset = 0\n\nqueryReq.This.Type =vmrefs.Type\nqueryReq.This.Value= =vmrefs.Value\n_, e = methods.QueryChangedDiskAreas(ctx, c.RoundTripper, queryReq)\n\nif e != nil {\n    fmt.Println(\"error in query\", e.Error())\n}\n</code></pre>\n\n<p>}</p>\n\n<p>Can you please tell if i am missing anything?</p>\n"}, {"tags": ["linux", "macos", "go"], "comments": [{"owner": {"reputation": 1101, "user_id": 757102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60bb12c55b318f541cb55c7eeb6bec8f?s=128&d=identicon&r=PG", "display_name": "Colin Nicholson", "link": "https://stackoverflow.com/users/757102/colin-nicholson"}, "edited": false, "score": 1, "creation_date": 1442219934, "post_id": 32557438, "comment_id": 52976559, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/23377271/how-do-i-cross-compile-a-go-program-on-a-mac-for-ubuntu\">How do I cross-compile a Go program on a Mac for Ubuntu?</a>"}, {"owner": {"reputation": 1665, "user_id": 4638952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03791badf72f6918a8910148dfc4401e?s=128&d=identicon&r=PG&f=1", "display_name": "SnoProblem", "link": "https://stackoverflow.com/users/4638952/snoproblem"}, "reply_to_user": {"reputation": 1101, "user_id": 757102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60bb12c55b318f541cb55c7eeb6bec8f?s=128&d=identicon&r=PG", "display_name": "Colin Nicholson", "link": "https://stackoverflow.com/users/757102/colin-nicholson"}, "edited": false, "score": 0, "creation_date": 1442246499, "post_id": 32557438, "comment_id": 52993354, "body": "@Colin Nicholson - Similar problem as that question, but different solution due to changes in the Go toolchain.  The process is much simpler with Go 1.5."}], "answers": [{"tags": [], "owner": {"reputation": 1665, "user_id": 4638952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03791badf72f6918a8910148dfc4401e?s=128&d=identicon&r=PG&f=1", "display_name": "SnoProblem", "link": "https://stackoverflow.com/users/4638952/snoproblem"}, "is_accepted": true, "score": 77, "last_activity_date": 1503782435, "last_edit_date": 1503782435, "creation_date": 1442206963, "answer_id": 32557590, "question_id": 32557438, "link": "https://stackoverflow.com/questions/32557438/how-do-i-cross-compile-my-go-program-from-mac-os-x-to-ubuntu-64-bit/32557590#32557590", "title": "How do I cross compile my Go program from Mac OS X to Ubuntu 64-bit", "body": "<p>The build command needs to identify the target environment:</p>\n\n<pre><code>$ GOOS=linux GOARCH=amd64 go build -v /path/to/target/package\n</code></pre>\n"}], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17103, "favorite_count": 14, "accepted_answer_id": 32557590, "answer_count": 1, "score": 21, "last_activity_date": 1503782435, "creation_date": 1442205932, "last_edit_date": 1495540464, "question_id": 32557438, "link": "https://stackoverflow.com/questions/32557438/how-do-i-cross-compile-my-go-program-from-mac-os-x-to-ubuntu-64-bit", "title": "How do I cross compile my Go program from Mac OS X to Ubuntu 64-bit", "body": "<p>As the title says I'm wondering how to cross-compile my program so that I can run it on Ubuntu 64-bit</p>\n\n<p>I've went into the <code>/usr/local/go/src</code> folder and ran </p>\n\n<p><code>GOOS=linux GOARCH=amd64 ./make.bash --no-clean</code></p>\n\n<p>everything compiled fine</p>\n\n<p>then went into my project directory and ran <code>go build -v -a</code> and then took the compiled binary and moved it to my linux server, but when running it I get this error:</p>\n\n<pre><code>root@PanicCSGO40:~/test# ./test\n-bash: ./test: cannot execute binary file: Exec format error\nroot@PanicCSGO40:~/test# sudo ./test\n./test: 1: ./test: Syntax error: \"(\" unexpected\nroot@PanicCSGO40:~/test#\n</code></pre>\n\n<p>Not sure what I am doing wrong any information would be great thanks.</p>\n\n<p>I've also tried doing it with <code>GOARCH=386</code> but still get the same errors. Thanks!</p>\n\n<p><a href=\"https://stackoverflow.com/questions/23377271/how-do-i-cross-compile-a-go-program-on-a-mac-for-ubuntu\">This link</a> does not solve my question because the chosen answer is a link to a blog post which relies heavily on doing all cross-compilation on using the blog writers <code>bash</code> scripts to do it, I just simply wanted to know what the correct way to do it was and now I do.</p>\n"}, {"tags": ["performance", "http", "go", "websocket", "rpc"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1442197521, "post_id": 32556174, "comment_id": 52969040, "body": "but the most important is your DB."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1442210960, "post_id": 32556174, "comment_id": 52972395, "body": "Is the server you send data to a webserver? Is transport restricted to HTTP only? Is it written in Go? Do you want your solution be portable across different technologies or may it be tied to Go?"}, {"owner": {"reputation": 442, "user_id": 3158232, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ol4CR.jpg?s=128&g=1", "display_name": "deankarn", "link": "https://stackoverflow.com/users/3158232/deankarn"}, "edited": false, "score": 0, "creation_date": 1442229688, "post_id": 32556174, "comment_id": 52982036, "body": "Jiang, the DB doesn&#39;t really matter at this point. icza, the data is just being sent to another server running a go program, could be a webserver, but also could just be a program. No transport is not restricted to HTTP. Yes it is written in go. It is completely OK to be tied to go."}], "answers": [{"comments": [{"owner": {"reputation": 15256, "user_id": 43786, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/40d8767cf48359c6e880fb66a6916de6?s=128&d=identicon&r=PG", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/43786/nicholas"}, "edited": false, "score": 0, "creation_date": 1442231807, "post_id": 32563983, "comment_id": 52983384, "body": "UDP is a good suggestion. Might also consider Google Protocol Buffers to simplify your codecs."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 15256, "user_id": 43786, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/40d8767cf48359c6e880fb66a6916de6?s=128&d=identicon&r=PG", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/43786/nicholas"}, "edited": false, "score": 0, "creation_date": 1442232392, "post_id": 32563983, "comment_id": 52983711, "body": "@Nicholas If profiling data is captured/described as a Go <code>struct</code>, Google Protocol Buffer would just complicate it and slow it down (you can send and recieve a <code>struct</code> with one simple method call using <code>encoding&#47;gob</code>, requiring nothing from your part)."}, {"owner": {"reputation": 442, "user_id": 3158232, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ol4CR.jpg?s=128&g=1", "display_name": "deankarn", "link": "https://stackoverflow.com/users/3158232/deankarn"}, "edited": false, "score": 0, "creation_date": 1442234102, "post_id": 32563983, "comment_id": 52984804, "body": "Perfect Thanks, Exactly what I was looking for!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1442233352, "last_edit_date": 1442233352, "creation_date": 1442231078, "answer_id": 32563983, "question_id": 32556174, "link": "https://stackoverflow.com/questions/32556174/go-rpc-http-or-websockets-which-is-fastest-for-transferring-many-small-pieces-o/32563983#32563983", "title": "go rpc, http or websockets,which is fastest for transferring many small pieces of data, repeatedly, from one server to another", "body": "<p>As you mentioned in your comment, HTTP is not a requirement.</p>\n\n<p>In this case in search for the fastest transferring solution I would completely drop the HTTP transport layer and would use just plain (TCP) socket connections as HTTP gives quite a big overhead just for transferring a few bytes.</p>\n\n<p>Define your own protocol (which may be very simple), open a TCP connection to the server, and send the data packets every seconds or so as your requirements dictate.</p>\n\n<p>Your protocol for sending (and receiving) data can be as simple as:</p>\n\n<ul>\n<li>Do an optional authenticating or client/server identification (to ensure you connected to the server/program you wanted to).</li>\n<li>Use the <a href=\"https://golang.org/pkg/encoding/gob/\" rel=\"nofollow\"><code>encoding/gob</code></a> packgae from the standard library to send data in binary form over the connection.</li>\n</ul>\n\n<p>So basically the profiled program (client) should open the TCP connection, and use <a href=\"https://golang.org/pkg/encoding/gob/#NewEncoder\" rel=\"nofollow\"><code>gob.NewEncoder()</code></a> wrapping the connection to send data. The server should accept the incoming TCP connection and use <a href=\"https://golang.org/pkg/encoding/gob/#NewDecoder\" rel=\"nofollow\"><code>gob.NewDecoder()</code></a> to wrapping the connection to recieve data.</p>\n\n<p>Client calls <a href=\"https://golang.org/pkg/encoding/gob/#Encoder.Encode\" rel=\"nofollow\"><code>Encoder.Encode()</code></a> so send profiling info, it can be typically a struct value. Server calls <a href=\"https://golang.org/pkg/encoding/gob/#Decoder.Decode\" rel=\"nofollow\"><code>Decoder.Decode()</code></a> to receive a profiling info, the struct that the client sent. That's all.</p>\n\n<p>Sending data in binary form using the <code>encoding/gob</code> package requires you to use the same type to describe the profiling data on both sides. If you want more flexibility, you may also use the <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow\"><code>encoding/json</code></a> package to send/receive profiling info as JSON text. The downside is that JSON will require more data to be sent and it takes more time to produce and parse the JSON text compared to the binary representation.</p>\n\n<p>If loosing some profiling packets (or recieving duplicates) is not an issue, you may want to try/experiment using UDP instead of TCP which may be even more efficient.</p>\n"}], "owner": {"reputation": 442, "user_id": 3158232, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ol4CR.jpg?s=128&g=1", "display_name": "deankarn", "link": "https://stackoverflow.com/users/3158232/deankarn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1278, "favorite_count": 1, "accepted_answer_id": 32563983, "answer_count": 1, "score": 1, "last_activity_date": 1442233352, "creation_date": 1442194153, "question_id": 32556174, "link": "https://stackoverflow.com/questions/32556174/go-rpc-http-or-websockets-which-is-fastest-for-transferring-many-small-pieces-o", "title": "go rpc, http or websockets,which is fastest for transferring many small pieces of data, repeatedly, from one server to another", "body": "<p><strong>Background</strong></p>\n\n<p>I'm experimenting creating a memory + cpu profiler in go, and wish to transfer the information quickly, maybe every second, from the program/service being profiled to a server which will do all of the heavy lifting by saving the data to a database and/or serving it via http to a site; this will reduce the load on the program being profiled for more accurate measurements. It will be small pieces of data being transferred. I know there are some libraries out there already, but like I said, experimenting.</p>\n\n<p><strong>Transfer Content Type</strong></p>\n\n<p>I have not decided on a concrete transfer type but looks like JSON for HTTP or Websockets and just the Struct for RPC (if I've done my research correctly)</p>\n\n<p><strong>Summary</strong></p>\n\n<p>I will likely try each just to see for myself, but have little experience using RPC and Websockets and would like some opinions or recommendations on which may be faster or more suitable for what I'm trying to do:</p>\n\n<ul>\n<li>HTTP</li>\n<li>RPC</li>\n<li>Websockets</li>\n<li>Anything else I'm not thinking about</li>\n</ul>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 0, "creation_date": 1442194145, "post_id": 32556020, "comment_id": 52968451, "body": "Where are you running your program from? See this for information about relative path in Go : <a href=\"https://stackoverflow.com/questions/17071286/how-can-i-open-files-using-relative-paths-in-go\" title=\"how can i open files using relative paths in go\">stackoverflow.com/questions/17071286/&hellip;</a>"}, {"owner": {"reputation": 21, "user_id": 2449560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf5a2a45e3bf534a0b7917b4d0251c9?s=128&d=identicon&r=PG", "display_name": "Jake", "link": "https://stackoverflow.com/users/2449560/jake"}, "reply_to_user": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 0, "creation_date": 1442194669, "post_id": 32556020, "comment_id": 52968554, "body": "The templates folder is actually under the app directory.  I updated the question to clear it up."}, {"owner": {"reputation": 1665, "user_id": 4638952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03791badf72f6918a8910148dfc4401e?s=128&d=identicon&r=PG&f=1", "display_name": "SnoProblem", "link": "https://stackoverflow.com/users/4638952/snoproblem"}, "edited": false, "score": 1, "creation_date": 1442195107, "post_id": 32556020, "comment_id": 52968631, "body": "Are you using <code>go run</code> or <code>go install</code> for your executable?  Remember that <code>go install</code> puts the binary in <code>$GOPATH&#47;bin</code> folder."}, {"owner": {"reputation": 21, "user_id": 2449560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf5a2a45e3bf534a0b7917b4d0251c9?s=128&d=identicon&r=PG", "display_name": "Jake", "link": "https://stackoverflow.com/users/2449560/jake"}, "reply_to_user": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 1, "creation_date": 1442195810, "post_id": 32556020, "comment_id": 52968763, "body": "I was using go build I was able to put in the absolute path to the file which resolved the issue.  Then using filepath.Join() to vary the file name and folder name.  My issue seems to be the same as the question seen in the link from @HectorJ."}], "answers": [{"comments": [{"owner": {"reputation": 8149, "user_id": 616644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wVwGC.png?s=128&g=1", "display_name": "Rick Smith", "link": "https://stackoverflow.com/users/616644/rick-smith"}, "edited": false, "score": 4, "creation_date": 1442250411, "post_id": 32560888, "comment_id": 52995456, "body": "Please edit with more information. Code-only and &quot;try this&quot; answers are <a href=\"http://meta.stackexchange.com/questions/196187/is-try-this-bad-practice\">discouraged</a>, because they contain no searchable content, and don&#39;t explain why someone should &quot;try this&quot;."}, {"owner": {"reputation": 21, "user_id": 2449560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf5a2a45e3bf534a0b7917b4d0251c9?s=128&d=identicon&r=PG", "display_name": "Jake", "link": "https://stackoverflow.com/users/2449560/jake"}, "edited": false, "score": 0, "creation_date": 1442455649, "post_id": 32560888, "comment_id": 53093244, "body": "I tried this, but I received the same error as the original posting."}], "tags": [], "owner": {"reputation": 232, "user_id": 4999035, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9d76a1cd7adf79d16508210a751d04ee?s=128&d=identicon&r=PG&f=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/4999035/priyanka"}, "is_accepted": false, "score": -1, "last_activity_date": 1442221356, "creation_date": 1442221356, "answer_id": 32560888, "question_id": 32556020, "link": "https://stackoverflow.com/questions/32556020/go-template-parsefiles-and-filepath-join/32560888#32560888", "title": "Go Template.ParseFiles and filepath.Join", "body": "<p>Try this,</p>\n\n<pre><code>template.Must(template.New(\"mytemplate.html\").ParseFiles(\"templates/mytemplate.html\"))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 2449560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf5a2a45e3bf534a0b7917b4d0251c9?s=128&d=identicon&r=PG", "display_name": "Jake", "link": "https://stackoverflow.com/users/2449560/jake"}, "edited": false, "score": 0, "creation_date": 1442455314, "post_id": 32584127, "comment_id": 53093169, "body": "I tried this and it did not work.  The working directory returned &quot;/Users/{username}/templates/mytemplate.html&quot; and the actual location is &quot;/Users/{username}/go/src/{projectname}/templates/mytemplate&zwnj;&#8203;.html&quot;"}, {"owner": {"reputation": 2854, "user_id": 41292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/939e50606775eea4b7589dd7aebbd8b3?s=128&d=identicon&r=PG", "display_name": "LenW", "link": "https://stackoverflow.com/users/41292/lenw"}, "reply_to_user": {"reputation": 21, "user_id": 2449560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf5a2a45e3bf534a0b7917b4d0251c9?s=128&d=identicon&r=PG", "display_name": "Jake", "link": "https://stackoverflow.com/users/2449560/jake"}, "edited": false, "score": 0, "creation_date": 1442465272, "post_id": 32584127, "comment_id": 53095585, "body": "So as per the comments above your working directory is no correct, how are you running you program ?"}, {"owner": {"reputation": 21, "user_id": 2449560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf5a2a45e3bf534a0b7917b4d0251c9?s=128&d=identicon&r=PG", "display_name": "Jake", "link": "https://stackoverflow.com/users/2449560/jake"}, "edited": false, "score": 0, "creation_date": 1442496479, "post_id": 32584127, "comment_id": 53111968, "body": "Using &quot;go build&quot; then executing it out of the /Users/{username}/go/src/app directory."}, {"owner": {"reputation": 2854, "user_id": 41292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/939e50606775eea4b7589dd7aebbd8b3?s=128&d=identicon&r=PG", "display_name": "LenW", "link": "https://stackoverflow.com/users/41292/lenw"}, "reply_to_user": {"reputation": 21, "user_id": 2449560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf5a2a45e3bf534a0b7917b4d0251c9?s=128&d=identicon&r=PG", "display_name": "Jake", "link": "https://stackoverflow.com/users/2449560/jake"}, "edited": false, "score": 0, "creation_date": 1442496818, "post_id": 32584127, "comment_id": 53112224, "body": "copy your templates under that app directory"}], "tags": [], "owner": {"reputation": 2854, "user_id": 41292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/939e50606775eea4b7589dd7aebbd8b3?s=128&d=identicon&r=PG", "display_name": "LenW", "link": "https://stackoverflow.com/users/41292/lenw"}, "is_accepted": false, "score": 1, "last_activity_date": 1442465370, "last_edit_date": 1442465370, "creation_date": 1442314230, "answer_id": 32584127, "question_id": 32556020, "link": "https://stackoverflow.com/questions/32556020/go-template-parsefiles-and-filepath-join/32584127#32584127", "title": "Go Template.ParseFiles and filepath.Join", "body": "<p>Check the working directory that your program has at runtime with </p>\n\n<pre><code>dir, _ := os.Getwd()\nfmt.Println(dir)\n</code></pre>\n\n<p>Then you can use that to get the right path for the templates</p>\n\n<p><code>template.Must(template.ParseFiles(filepath.Join(dir, \"templates\", \"mytemplate.html\")))</code></p>\n\n<p>For production use you could get the val of <code>dir</code> fro a config file or the environment, </p>\n\n<p>ref : <a href=\"https://golang.org/pkg/os/#Getwd\" rel=\"nofollow\">https://golang.org/pkg/os/#Getwd</a></p>\n\n<p>EDIT: When you run the program make sure you are in the correct directory using <code>cd</code> in your terminal </p>\n"}], "owner": {"reputation": 21, "user_id": 2449560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf5a2a45e3bf534a0b7917b4d0251c9?s=128&d=identicon&r=PG", "display_name": "Jake", "link": "https://stackoverflow.com/users/2449560/jake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1505, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1442465370, "creation_date": 1442192305, "last_edit_date": 1442456256, "question_id": 32556020, "link": "https://stackoverflow.com/questions/32556020/go-template-parsefiles-and-filepath-join", "title": "Go Template.ParseFiles and filepath.Join", "body": "<p>I am trying to load an html file from a directory and I am getting the error \"open templates: no such file or directory\"</p>\n\n<p>My directory structure is below</p>\n\n<p>/Users/{username}/go/src/app\nmain.go</p>\n\n<p>/Users/{username}/go/src/app/templates\nmytemplate.html</p>\n\n<p>The error is coming from the line below</p>\n\n<pre><code>template.Must(template.ParseFiles(filepath.Join(\"templates\", \"mytemplate.html\")))\n</code></pre>\n\n<p>I am new to go and just trying to get a feel for the syntax.</p>\n\n<p>EDIT 1</p>\n\n<p>I am building the project using the \"go build\" command and executing it out of the \"app\" directory shown above.</p>\n\n<p>$GOROOT = /usr/local/go\n$GOPATH = /Users/{username}/go</p>\n\n<p>I also updated the directory structure to integrate the $GOPATH</p>\n"}, {"tags": ["go", "reactjs", "react-router"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "is_accepted": true, "score": 2, "last_activity_date": 1442300090, "last_edit_date": 1442300090, "creation_date": 1442182653, "answer_id": 32555079, "question_id": 32555038, "link": "https://stackoverflow.com/questions/32555038/golang-with-react-router/32555079#32555079", "title": "Golang with React Router?", "body": "<p>You have to render different routes with new bindings, or handle that binding specifically in your handler function and read out the request object's information.</p>\n\n<pre><code>Echo.Get(\"/user/:id\", getUser)\nEcho.Get(\"/users\", listUsers)\nEcho.Get(\"/*\", catchAllRemainingCalls)\n</code></pre>\n\n<p>Hope this helps. Good luck!</p>\n"}], "owner": {"reputation": 153, "user_id": 4489257, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/755572e35afde5bf222b3096a3b9d36b?s=128&d=identicon&r=PG&f=1", "display_name": "Maxim Lis", "link": "https://stackoverflow.com/users/4489257/maxim-lis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2354, "favorite_count": 2, "accepted_answer_id": 32555079, "answer_count": 1, "score": 4, "last_activity_date": 1533269008, "creation_date": 1442182258, "last_edit_date": 1533269008, "question_id": 32555038, "link": "https://stackoverflow.com/questions/32555038/golang-with-react-router", "title": "Golang with React Router?", "body": "<p><strong>How do I use React Router with Go?</strong></p>\n\n<hr>\n\n<p>For example,</p>\n\n<p>I have this in Go:</p>\n\n<pre><code>Echo.Get(\"/*\", *handler which return page with ReactRouter*)\n</code></pre>\n\n<p>And this in React Router:</p>\n\n<pre><code>React.render((\n&lt;Router history={History.createHistory()}&gt;\n    &lt;Route name=\"index\" path=\"/\" component={Main}&gt;\n        &lt;Route name=\"users\" path=\"/users\" component={Users}&gt;\n            &lt;Route name=\"user\" path=\"/user/:userId\" component={User} /&gt;\n        &lt;/Route&gt;\n        &lt;Route path=\"*\" component={NotFound} /&gt;\n    &lt;/Route&gt;\n&lt;/Router&gt;\n), document.body)\n</code></pre>\n\n<p>But I keep getting the index (/) page. All routes behave the same ('/', '/users', '/user/qwe', etc.)</p>\n"}, {"tags": ["json", "go", "decoding"], "comments": [{"owner": {"reputation": 53873, "user_id": 3737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04a3fc14ec0008acf8d406c93e23c3ae?s=128&d=identicon&r=PG", "display_name": "Jesse Rusak", "link": "https://stackoverflow.com/users/3737/jesse-rusak"}, "edited": false, "score": 0, "creation_date": 1442181579, "post_id": 32554899, "comment_id": 52965852, "body": "Maybe show the contents of b?"}, {"owner": {"reputation": 5147, "user_id": 334761, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZXRM5.jpg?s=128&g=1", "display_name": "Stefan Majewsky", "link": "https://stackoverflow.com/users/334761/stefan-majewsky"}, "reply_to_user": {"reputation": 53873, "user_id": 3737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04a3fc14ec0008acf8d406c93e23c3ae?s=128&d=identicon&r=PG", "display_name": "Jesse Rusak", "link": "https://stackoverflow.com/users/3737/jesse-rusak"}, "edited": false, "score": 0, "creation_date": 1442181745, "post_id": 32554899, "comment_id": 52965893, "body": "Of course, in my application, the actual <code>Group</code> is more than a plain string. I left it as a struct in here for the sake of keeping the minimal example intact."}, {"owner": {"reputation": 5147, "user_id": 334761, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZXRM5.jpg?s=128&g=1", "display_name": "Stefan Majewsky", "link": "https://stackoverflow.com/users/334761/stefan-majewsky"}, "reply_to_user": {"reputation": 53873, "user_id": 3737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04a3fc14ec0008acf8d406c93e23c3ae?s=128&d=identicon&r=PG", "display_name": "Jesse Rusak", "link": "https://stackoverflow.com/users/3737/jesse-rusak"}, "edited": false, "score": 0, "creation_date": 1442181771, "post_id": 32554899, "comment_id": 52965904, "body": "@JesseRusak: Sorry, I missed that in the initial copy-paste. Fixed now."}, {"owner": {"reputation": 5147, "user_id": 334761, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZXRM5.jpg?s=128&g=1", "display_name": "Stefan Majewsky", "link": "https://stackoverflow.com/users/334761/stefan-majewsky"}, "reply_to_user": {"reputation": 53873, "user_id": 3737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04a3fc14ec0008acf8d406c93e23c3ae?s=128&d=identicon&r=PG", "display_name": "Jesse Rusak", "link": "https://stackoverflow.com/users/3737/jesse-rusak"}, "edited": false, "score": 0, "creation_date": 1442579077, "post_id": 32554899, "comment_id": 53150518, "body": "May I inquire why the question was down-voted? It&#39;s a valid question with a concise example. It <i>is</i> a duplicate, granted, but I don&#39;t see how I could have found that problem with more searching. It&#39;s always hard to search for something that you don&#39;t yet know."}], "answers": [{"comments": [{"owner": {"reputation": 5147, "user_id": 334761, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZXRM5.jpg?s=128&g=1", "display_name": "Stefan Majewsky", "link": "https://stackoverflow.com/users/334761/stefan-majewsky"}, "edited": false, "score": 0, "creation_date": 1442182285, "post_id": 32554971, "comment_id": 52966037, "body": "Bah, I didn&#39;t see that because it is only mentioned in the documentation for <code>Marshal</code>, not in <code>Unmarshal</code>."}, {"owner": {"reputation": 981, "user_id": 4637358, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/sIfTB.jpg?s=128&g=1", "display_name": "1a1a11a", "link": "https://stackoverflow.com/users/4637358/1a1a11a"}, "edited": false, "score": 1, "creation_date": 1544492550, "post_id": 32554971, "comment_id": 94286554, "body": "This is really helpful! Thank you!"}, {"owner": {"reputation": 1397, "user_id": 4940278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06NHi.jpg?s=128&g=1", "display_name": "Luna Lovegood", "link": "https://stackoverflow.com/users/4940278/luna-lovegood"}, "edited": false, "score": 0, "creation_date": 1611547951, "post_id": 32554971, "comment_id": 116478028, "body": "Saved me! thanks"}], "tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": true, "score": 11, "last_activity_date": 1442181824, "creation_date": 1442181824, "answer_id": 32554971, "question_id": 32554899, "link": "https://stackoverflow.com/questions/32554899/in-go-why-is-my-json-decoding-not-working-here/32554971#32554971", "title": "In Go, why is my JSON decoding not working here?", "body": "<p>The field names have to start with a capital letter:</p>\n\n<pre><code>type Group struct{ Name string }\nvar contents struct {\n    Groups []Group\n}\n</code></pre>\n"}], "owner": {"reputation": 5147, "user_id": 334761, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZXRM5.jpg?s=128&g=1", "display_name": "Stefan Majewsky", "link": "https://stackoverflow.com/users/334761/stefan-majewsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1528, "favorite_count": 0, "closed_date": 1442182192, "accepted_answer_id": 32554971, "answer_count": 1, "score": 5, "last_activity_date": 1442181824, "creation_date": 1442181245, "last_edit_date": 1442181586, "question_id": 32554899, "link": "https://stackoverflow.com/questions/32554899/in-go-why-is-my-json-decoding-not-working-here", "closed_reason": "Duplicate", "title": "In Go, why is my JSON decoding not working here?", "body": "<p>I cannot get the standard library's <code>encoding/json</code> package to work for decoding JSON objects. Here's a minimal example:</p>\n\n<pre><code>b := []byte(`{\"groups\":[{\"name\":\"foo\"},{\"name\":\"bar\"}]}`)\ntype Group struct{ name string }\nvar contents struct {\n    groups []Group\n}\nerr := json.Unmarshal(b, &amp;contents)\nfmt.Printf(\"contents = %+v\\nerr = %+v\\n\", contents, err)\n</code></pre>\n\n<p>This prints:</p>\n\n<pre><code>contents = {groups:[]}\nerr = nil\n</code></pre>\n\n<p>But I expect:</p>\n\n<pre><code>contents = {groups:[{name:foo} {name:bar}]}\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["go", "kubernetes"], "answers": [{"tags": [], "owner": {"reputation": 463, "user_id": 2740427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ny9tB.jpg?s=128&g=1", "display_name": "Chris Snell", "link": "https://stackoverflow.com/users/2740427/chris-snell"}, "is_accepted": false, "score": 7, "last_activity_date": 1442202714, "creation_date": 1442202714, "answer_id": 32557053, "question_id": 32554893, "link": "https://stackoverflow.com/questions/32554893/how-can-i-create-a-simple-client-app-with-the-kubernetes-go-library/32557053#32557053", "title": "How can I create a simple client app with the Kubernetes Go library?", "body": "<p>So after a little experimentation and a hint from the k8s Slack channel, I have this example.  Perhaps someone can update the example with a proper import path.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n\n    \"github.com/kubernetes/kubernetes/pkg/api\"\n    client \"github.com/kubernetes/kubernetes/pkg/client/unversioned\"\n)\n\nfunc main() {\n\n    config := client.Config{\n        Host: \"http://my-kube-api-server.me:8080\",\n    }\n    c, err := client.New(&amp;config)\n    if err != nil {\n        log.Fatalln(\"Can't connect to Kubernetes API:\", err)\n    }\n\n    s, err := c.Services(api.NamespaceDefault).Get(\"some-service-name\")\n    if err != nil {\n        log.Fatalln(\"Can't get service:\", err)\n    }\n    fmt.Println(\"Name:\", s.Name)\n    for p, _ := range s.Spec.Ports {\n        fmt.Println(\"Port:\", s.Spec.Ports[p].Port)\n        fmt.Println(\"NodePort:\", s.Spec.Ports[p].NodePort)\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 980, "user_id": 2486083, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/pZudJ.jpg?s=128&g=1", "display_name": "Chetan", "link": "https://stackoverflow.com/users/2486083/chetan"}, "edited": false, "score": 0, "creation_date": 1490864964, "post_id": 39283200, "comment_id": 73306392, "body": "My code is not able to resolve &quot;c.Pods&quot; in the line pod, err := c.Pods(v1.NamespaceDefault).Get(&quot;my-pod&quot;) Any idea why?"}, {"owner": {"reputation": 350, "user_id": 267777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01aca4d340834af92eebe27a4c734de3?s=128&d=identicon&r=PG", "display_name": "itorres", "link": "https://stackoverflow.com/users/267777/itorres"}, "reply_to_user": {"reputation": 980, "user_id": 2486083, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/pZudJ.jpg?s=128&g=1", "display_name": "Chetan", "link": "https://stackoverflow.com/users/2486083/chetan"}, "edited": false, "score": 0, "creation_date": 1490893927, "post_id": 39283200, "comment_id": 73327668, "body": "@Chetan this code explicitly uses the 1.5 version of the <code>go-client</code> library with support up to kubernetes-1.4. If you&#39;re connecting to a GKE cluster you probably need the 2.0 version to connect to kubernetes 1.5.x. Check the compatibility matrix: <a href=\"https://github.com/kubernetes/client-go#compatibility-matrix\" rel=\"nofollow noreferrer\">github.com/kubernetes/client-go#compatibility-matrix</a>"}, {"owner": {"reputation": 980, "user_id": 2486083, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/pZudJ.jpg?s=128&g=1", "display_name": "Chetan", "link": "https://stackoverflow.com/users/2486083/chetan"}, "edited": false, "score": 0, "creation_date": 1490941570, "post_id": 39283200, "comment_id": 73345274, "body": "My kubernetes is 1.5 and the go-client library is master/HEAD. I also tried the same with go-client 2.0. Also a catch which might have affected is, I was unable to do a &quot;go get k8s.io/client-go/...&quot; So i manually downloaded the client and placed it in the workspace. So i think the dependencies have not resolved. If so, any idea how to resolve them?"}], "tags": [], "owner": {"reputation": 843, "user_id": 881626, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W7KEQ.jpg?s=128&g=1", "display_name": "Rush", "link": "https://stackoverflow.com/users/881626/rush"}, "is_accepted": false, "score": 5, "last_activity_date": 1489702816, "last_edit_date": 1489702816, "creation_date": 1472781011, "answer_id": 39283200, "question_id": 32554893, "link": "https://stackoverflow.com/questions/32554893/how-can-i-create-a-simple-client-app-with-the-kubernetes-go-library/39283200#39283200", "title": "How can I create a simple client app with the Kubernetes Go library?", "body": "<p>Here's how to do it with the latest Go client.</p>\n\n<p>If you're inside the k8s cluster:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n\n  \"k8s.io/client-go/1.5/kubernetes\"\n  \"k8s.io/client-go/1.5/pkg/api/v1\"\n  \"k8s.io/client-go/1.5/rest\"\n)\n\nfunc main()  {\n    config, err = rest.InClusterConfig()\n    if err != nil {\n      return nil, err\n    }\n\n    c, err := kubernetes.NewForConfig(config)\n    if err != nil {\n      return nil, err\n    }\n\n    // Get Pod by name\n    pod, err := c.Pods(v1.NamespaceDefault).Get(\"my-pod\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n\n    // Print its creation time\n    fmt.Println(pod.GetCreationTimestamp())\n}\n</code></pre>\n\n<p>And if you're outside of the cluster:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n\n  \"k8s.io/client-go/1.5/kubernetes\"\n  \"k8s.io/client-go/1.5/pkg/api/v1\"\n  \"k8s.io/client-go/1.5/tools/clientcmd\"\n)\n\nfunc main()  {\n    config, err := clientcmd.BuildConfigFromFlags(\"\", &lt;kube-config-path&gt;)\n    if err != nil {\n      return nil, err\n    }\n\n    c, err := kubernetes.NewForConfig(config)\n    if err != nil {\n      return nil, err\n    }\n\n    // Get Pod by name\n    pod, err := c.Pods(v1.NamespaceDefault).Get(\"my-pod\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n\n    // Print its creation time\n    fmt.Println(pod.GetCreationTimestamp())\n}\n</code></pre>\n\n<p>I have gone into more detail on this in a <a href=\"https://www.rushtehrani.com/post/using-kubernetes-api/\" rel=\"nofollow noreferrer\">blog post</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 664, "user_id": 935203, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/764e5f288b3534281b1fe7a1b95218ae?s=128&d=identicon&r=PG", "display_name": "Ramin Mir.", "link": "https://stackoverflow.com/users/935203/ramin-mir"}, "is_accepted": false, "score": 3, "last_activity_date": 1481019781, "last_edit_date": 1481019781, "creation_date": 1480943544, "answer_id": 40975087, "question_id": 32554893, "link": "https://stackoverflow.com/questions/32554893/how-can-i-create-a-simple-client-app-with-the-kubernetes-go-library/40975087#40975087", "title": "How can I create a simple client app with the Kubernetes Go library?", "body": "<p>With kubernetes go client, it could be done this way:</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n\n    \"k8s.io/client-go/kubernetes\"\n    \"k8s.io/client-go/pkg/api/v1\"\n    \"k8s.io/client-go/tools/clientcmd\"\n)\n\nvar (\n    kubeconfig = flag.String(\"kubeconfig\", \"./config\", \"absolute path to the kubeconfig file\")\n)\n\nfunc main() {\n    flag.Parse()\n    // uses the current context in kubeconfig\n    config, err := clientcmd.BuildConfigFromFlags(\"\", *kubeconfig)\n    if err != nil {\n        panic(err.Error())\n    }\n    // creates the clientset\n    clientset, err := kubernetes.NewForConfig(config)\n    if err != nil {\n        panic(err.Error())\n    }\n    services, err := clientset.Core().Services(\"\").List(v1.ListOptions{})\n    if err != nil {\n        panic(err.Error())\n    }\n    fmt.Printf(\"There are %d pods in the cluster\\n\", len(services.Items))\n\n    for _, s := range services.Items {\n        for p, _ := range s.Spec.Ports {\n            fmt.Println(\"Port:\", s.Spec.Ports[p].Port)\n            fmt.Println(\"NodePort:\", s.Spec.Ports[p].NodePort)\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 463, "user_id": 2740427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ny9tB.jpg?s=128&g=1", "display_name": "Chris Snell", "link": "https://stackoverflow.com/users/2740427/chris-snell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11757, "favorite_count": 5, "answer_count": 3, "score": 11, "last_activity_date": 1614232988, "creation_date": 1442181221, "question_id": 32554893, "link": "https://stackoverflow.com/questions/32554893/how-can-i-create-a-simple-client-app-with-the-kubernetes-go-library", "title": "How can I create a simple client app with the Kubernetes Go library?", "body": "<p>I'm struggling with the Kubernetes Go library.  The docs--<a href=\"https://github.com/kubernetes/kubernetes/blob/master/pkg/client/unversioned/doc.go\">at least the ones I found</a>--appear out-of-date with the library itself.  The example provided does not build because of issues with the imports.  I'm just trying to do something simple: get a Service object by name and print some attributes (like nodePort).  I just need a simple example of library usage to get me going.</p>\n\n<p>I could easily do this using the RESTful API but that feels like re-inventing the wheel.</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 63, "user_id": 4875444, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MAKBVRhtLJY/AAAAAAAAAAI/AAAAAAAAAMY/rgj-NZjd3ng/photo.jpg?sz=128", "display_name": "Josh", "link": "https://stackoverflow.com/users/4875444/josh"}, "edited": false, "score": 0, "creation_date": 1442179323, "post_id": 32554642, "comment_id": 52965233, "body": "Just as a note, the API key in the code is public."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1442181013, "post_id": 32554642, "comment_id": 52965717, "body": "The go json package is well documented, and has been written about at length on many blogs (including the official golang.org). Can you give us some idea about what you&#39;ve tried and hasn&#39;t worked?"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 4875444, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MAKBVRhtLJY/AAAAAAAAAAI/AAAAAAAAAMY/rgj-NZjd3ng/photo.jpg?sz=128", "display_name": "Josh", "link": "https://stackoverflow.com/users/4875444/josh"}, "edited": false, "score": 0, "creation_date": 1442181823, "post_id": 32554953, "comment_id": 52965916, "body": "Dude, thank you -- I know it&#39;s obnoxious, but you don&#39;t understand how much you just helped Go make sense to me."}], "tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": true, "score": 1, "last_activity_date": 1442181649, "creation_date": 1442181649, "answer_id": 32554953, "question_id": 32554642, "link": "https://stackoverflow.com/questions/32554642/new-to-go-trying-to-sort-out-how-to-process-json/32554953#32554953", "title": "New to Go, trying to sort out how to process JSON", "body": "<p>Just map them to a new type:</p>\n\n<pre><code>func main() {\n    flag.Parse()\n    c := gombta.Client{APIKey: apikey, URL: apiurl}\n\n    // get a list of routes by type\n    d, err := c.GetRoutes(format)\n    check(err)\n\n    var toPrint interface{}\n\n    if typeid == 9999 {\n        type Result struct {\n            RouteType string `json:\"route_type\"`\n            ModeName  string `json:\"mode_name\"`\n        }\n        rs := []Result{}\n        for _, m := range d.Mode {\n            rs = append(rs, Result{\n                RouteType: m.RouteType,\n                ModeName:  m.ModeName,\n            })\n        }\n        toPrint = rs\n    } else {\n        type Result struct {\n            RouteID   string `json:\"route_id\"`\n            RouteName string `json:\"route_name\"`\n        }\n        rs := []Result{}\n        for _, m := range d.Mode {\n            if fmt.Sprint(typeid) == m.RouteType {\n                for _, r := range m.Route {\n                    rs = append(rs, Result{\n                        RouteID:   r.RouteID,\n                        RouteName: r.RouteName,\n                    })\n                }\n            }\n        }\n        toPrint = rs\n    }\n\n    j, err := json.MarshalIndent(toPrint, \"\", \" \")\n    fmt.Printf(\"RouteTypes: \")\n    os.Stdout.Write(j)\n}\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 4875444, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MAKBVRhtLJY/AAAAAAAAAAI/AAAAAAAAAMY/rgj-NZjd3ng/photo.jpg?sz=128", "display_name": "Josh", "link": "https://stackoverflow.com/users/4875444/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 32554953, "answer_count": 1, "score": 2, "last_activity_date": 1442181649, "creation_date": 1442179083, "question_id": 32554642, "link": "https://stackoverflow.com/questions/32554642/new-to-go-trying-to-sort-out-how-to-process-json", "title": "New to Go, trying to sort out how to process JSON", "body": "<p>Coming from languages like Python, Ruby, and JS, I am really struggling with Go right now.  It feels overly complex, but I am hoping I am just missing something.</p>\n\n<p>Right now I have code that can successfully call Boston's MBTA API (<strong>using their public developer key)</strong> and return all route information. </p>\n\n<p>I have dropped the code here: <a href=\"http://pastebin.com/PkBaP714\" rel=\"nofollow\">http://pastebin.com/PkBaP714</a> and here: <a href=\"http://pastebin.com/7mRxgrpp\" rel=\"nofollow\">http://pastebin.com/7mRxgrpp</a></p>\n\n<p>Sample data returned: <a href=\"http://pastebin.com/M2hzMKYs\" rel=\"nofollow\">http://pastebin.com/M2hzMKYs</a></p>\n\n<p>I want to return two things 1) JUST each route_type and mode_name, and 2) when route_type is called each of the route_id and route_name.</p>\n\n<p>For whatever reason I am just totally lost.  I've spent 16 hours staring at documentation and I feel like I am looking at a foreign language :).</p>\n\n<p>It may be too much to ask for specific help, but I would LOVE IT.</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4651282"}, "edited": false, "score": 2, "creation_date": 1442163964, "post_id": 32552224, "comment_id": 52960434, "body": "I think, here better not use regex. Show this: <a href=\"http://stackoverflow.com/questions/18390266/how-can-we-truncate-float64-type-to-a-particular-precision-in-golang\" title=\"how can we truncate float64 type to a particular precision in golang\">stackoverflow.com/questions/18390266/&hellip;</a> and then converting."}], "answers": [{"comments": [{"owner": {"reputation": 5332, "user_id": 155409, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f7742b7d6787ae672a59adc841aab728?s=128&d=identicon&r=PG", "display_name": "Slinky", "link": "https://stackoverflow.com/users/155409/slinky"}, "edited": false, "score": 0, "creation_date": 1442164321, "post_id": 32552239, "comment_id": 52960544, "body": "That makes sense. Thanks"}], "tags": [], "owner": {"reputation": 159902, "user_id": 3297613, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/KHhzd.jpg?s=128&g=1", "display_name": "Avinash Raj", "link": "https://stackoverflow.com/users/3297613/avinash-raj"}, "is_accepted": true, "score": 3, "last_activity_date": 1442163661, "creation_date": 1442163661, "answer_id": 32552239, "question_id": 32552224, "link": "https://stackoverflow.com/questions/32552224/return-a-defined-range-of-characters-in-go/32552239#32552239", "title": "Return a defined range of characters in Go", "body": "<p>You must remove the end of the line anchor <code>$</code> since it won't be a line end after exactly 6 digits. For to capture exactly 6 digits, the quantifier must be</p>\n\n<pre><code>re2 := regexp.MustCompile(`[!.](\\d{6})`)\n</code></pre>\n\n<p>Note that, this would also the digits which exists next to <code>!</code>. If you don't want this behaviour, you must remove the <code>!</code> from the charcater class like</p>\n\n<pre><code>re2 := regexp.MustCompile(`[.](\\d{6})`)\n</code></pre>\n\n<p><strong>or</strong></p>\n\n<p>For to capture digits ranges from 1 to 6,</p>\n\n<pre><code>re2 := regexp.MustCompile(`[!.](\\d{1,6})`)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "is_accepted": false, "score": 4, "last_activity_date": 1442168299, "last_edit_date": 1442168299, "creation_date": 1442167468, "answer_id": 32552844, "question_id": 32552224, "link": "https://stackoverflow.com/questions/32552224/return-a-defined-range-of-characters-in-go/32552844#32552844", "title": "Return a defined range of characters in Go", "body": "<p>Alternatively...</p>\n\n<pre><code>func DecimalPlaces(decimalStr string, places int) string {\n    location := strings.Index(decimalStr, \".\")\n    if location == -1 {\n        return \"\"\n    }\n    return decimalStr[location+1 : min(location+1+places, len(decimalStr))]\n}\n</code></pre>\n\n<p>Where min is just a simple function to find the minimum of two integers.</p>\n\n<p>Regular expressions seem a bit heavyweight for this sort of simple string manipulation.</p>\n\n<p><a href=\"http://play.golang.org/p/gDdwtmvkLB\" rel=\"nofollow\">Playground</a></p>\n"}], "owner": {"reputation": 5332, "user_id": 155409, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f7742b7d6787ae672a59adc841aab728?s=128&d=identicon&r=PG", "display_name": "Slinky", "link": "https://stackoverflow.com/users/155409/slinky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 32552239, "answer_count": 2, "score": 0, "last_activity_date": 1442168299, "creation_date": 1442163579, "question_id": 32552224, "link": "https://stackoverflow.com/questions/32552224/return-a-defined-range-of-characters-in-go", "title": "Return a defined range of characters in Go", "body": "<p>Let's say we have a converted float to a string:</p>\n\n<pre><code>\"24.22334455667\"\n</code></pre>\n\n<p>I want to just return 6 of the digits on the right of the decimal</p>\n\n<p>I can get all digits, after the decimal this way:</p>\n\n<pre><code>re2 := regexp.MustCompile(`[!.]([\\d]+)$`)\n</code></pre>\n\n<p>But I want only the first 6 digits after the decimal but this returns nothing:</p>\n\n<pre><code>re2 := regexp.MustCompile(`[!.]([\\d]{1,6})$`)\n</code></pre>\n\n<p>How can I do this? I could not find an example of using <code>[\\d]{1,6}</code></p>\n\n<p>Thanks</p>\n"}, {"tags": ["file", "templates", "go", "io"], "comments": [{"owner": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1442164495, "post_id": 32551811, "comment_id": 52960613, "body": "I try to extend a static side generator. Therefore I need to do this only once."}], "answers": [{"comments": [{"owner": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "edited": false, "score": 0, "creation_date": 1442166266, "post_id": 32552619, "comment_id": 52961168, "body": "I use <code>os.Walk(&quot;root&quot;, filterFunc)</code> and a filter to find all css files. if the script found one it calls <code>parse()</code> with the path. So, does it makes sense to call <code>ParseFiles()</code> if I need only to parse a single file? And lastly: <code>os.Create(path)</code> will overwrite the original file, right?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "edited": false, "score": 1, "creation_date": 1442166338, "post_id": 32552619, "comment_id": 52961195, "body": "For this scenario, you should call ParseFiles with a single file at a time.  Caling ParseFiles with a single file saves code as noted in the answer. Yes, this overwrites the original file. If that&#39;s not what you are asking in the question, then please clarify."}, {"owner": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "edited": false, "score": 0, "creation_date": 1442166456, "post_id": 32552619, "comment_id": 52961240, "body": "No, that&#39;s exactly what I needed. Thank you very much."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6198643"}, "edited": false, "score": 0, "creation_date": 1519209734, "post_id": 32552619, "comment_id": 84813067, "body": "Great, thanks @CeriseLim&#243;n I needed this too. Could you please explain what this is? Never seen this before <code>map[string]string</code>"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1519230233, "post_id": 32552619, "comment_id": 84827640, "body": "@Sbe88 It&#39;s a <a href=\"https://golang.org/ref/spec#Map_types\" rel=\"nofollow noreferrer\">map</a> with string keys and string values."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 41, "last_activity_date": 1442165947, "creation_date": 1442165947, "answer_id": 32552619, "question_id": 32551811, "link": "https://stackoverflow.com/questions/32551811/read-file-as-template-execute-it-and-write-it-back/32552619#32552619", "title": "Read file as template, execute it and write it back", "body": "<p>Use <a href=\"http://godoc.org/text/template#ParseFiles\" rel=\"noreferrer\">ParseFiles</a> to parse the template. This code basically does the same thing as calling ReadFile, template.New and Parse as in the question, but it's shorter.</p>\n\n<pre><code>t, err := template.ParseFiles(path)\nif err != nil {\n    log.Print(err)\n    return\n}\n</code></pre>\n\n<p>Use <a href=\"http://godoc.org/os#Create\" rel=\"noreferrer\">os.Create</a> to open the output file.</p>\n\n<pre><code>f, err := os.Create(path)\nif err != nil {\n    log.Println(\"create file: \", err)\n    return\n}\n</code></pre>\n\n<p>A file is an io.Writer. You can execute the template directly to the open file:</p>\n\n<pre><code>err = t.Execute(f, config)\nif err != nil {\n    log.Print(\"execute: \", err)\n    return\n}\n</code></pre>\n\n<p>Close the file when done.</p>\n\n<pre><code>f.Close()\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/Kuo18jwuSm\" rel=\"noreferrer\">Complete working example on the playground.</a></p>\n"}], "owner": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20375, "favorite_count": 4, "accepted_answer_id": 32552619, "answer_count": 1, "score": 18, "last_activity_date": 1591923427, "creation_date": 1442161309, "last_edit_date": 1591923427, "question_id": 32551811, "link": "https://stackoverflow.com/questions/32551811/read-file-as-template-execute-it-and-write-it-back", "title": "Read file as template, execute it and write it back", "body": "<p>I'm trying to parse CSS files in which variables can be injected that are defined in a config file. Currently the function does:</p>\n\n<ol>\n<li>Opens the file based on the given path argument</li>\n<li>Parses the file's content</li>\n<li>Executes the template by injecting the config variable</li>\n<li>Writes the rendered content to the console instead of the original file</li>\n</ol>\n\n\n\n<pre><code>func parse(path string) {\n    f, err := ioutil.ReadFile(path)\n\n    if err != nil {\n        log.Print(err)\n        return\n    }\n\n    // Parse requires a string\n    t, err := template.New(\"css\").Parse(string(f))\n\n    if err != nil {\n        log.Print(err)\n        return\n    }\n\n    // A sample config\n    config := map[string]string {\n        \"textColor\": \"#abcdef\",\n        \"linkColorHover\": \"#ffaacc\",\n    }   \n\n    // Execute needs some sort of io.Writer\n    err = t.Execute(os.Stdout, config)  \n\n    if err != nil {\n        log.Print(\"Can't execute \", path)\n    }\n}\n</code></pre>\n\n<p>My problem is that <code>template.Parse()</code> requires the content as string and <code>template.Execute()</code> an <code>io.Writer</code> as argument. I tried to open the file with <code>os.Open()</code> which returns a file object that implements the <code>io.Writer</code> interface. But how can I get the file's content as a string from such a file object in order to use it with <code>Parse()</code>? </p>\n"}, {"tags": ["go", "constraint-programming"], "comments": [{"owner": {"reputation": 1958, "user_id": 830641, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/a70b7.jpg?s=128&g=1", "display_name": "James Hurford", "link": "https://stackoverflow.com/users/830641/james-hurford"}, "edited": false, "score": 0, "creation_date": 1442182062, "post_id": 32549840, "comment_id": 52965985, "body": "I can appreciate there is a typo in my code here, but I can&#39;t accept this makes it a bad question.  Could you please tell me, whoever is downvoting me, as to why you&#39;re doing so."}], "answers": [{"comments": [{"owner": {"reputation": 1958, "user_id": 830641, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/a70b7.jpg?s=128&g=1", "display_name": "James Hurford", "link": "https://stackoverflow.com/users/830641/james-hurford"}, "edited": false, "score": 0, "creation_date": 1442176288, "post_id": 32553690, "comment_id": 52964384, "body": "Thanks, I think I see my obvious mistake. Well not so obvious. As to total, it means nothing, I just stumbled across using it to get an answer when I was trying to figure out why it wasn&#39;t working. I&#39;ll correct the mistake and see what happens. I hate typos :-("}, {"owner": {"reputation": 1958, "user_id": 830641, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/a70b7.jpg?s=128&g=1", "display_name": "James Hurford", "link": "https://stackoverflow.com/users/830641/james-hurford"}, "edited": false, "score": 0, "creation_date": 1442181617, "post_id": 32553690, "comment_id": 52965860, "body": "Yep, it was the ! instead of 1 that caused me problems.  Thanks."}], "tags": [], "owner": {"reputation": 4942, "user_id": 195636, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z4Rl9.jpg?s=128&g=1", "display_name": "hakank", "link": "https://stackoverflow.com/users/195636/hakank"}, "is_accepted": true, "score": 1, "last_activity_date": 1442172519, "creation_date": 1442172519, "answer_id": 32553690, "question_id": 32549840, "link": "https://stackoverflow.com/questions/32549840/why-do-i-have-to-use-core-createintvarfromto-to-get-this-sudoku-solver-to-work/32553690#32553690", "title": "Why do I have to use core.CreateIntVarFromTo to get this Sudoku solver to work?", "body": "<p>First, I have to confess that I'm not a Go programmer, but I might look more into Go and the gofd package (which I didn't know about; thanks for the tip).</p>\n\n<p>I don't know why \"total\" make the model behaves as it does, but why are you naming some of the cells with an \"!\" instead of \"1\", e.g. \"A!\", \"D!\", and \"G!\"? </p>\n\n<p>When I replace \"!\" with \"1\", the correct and unique solution (without the \"total\" variable) is shown:</p>\n\n<pre><code>consistent: true \nsolutionFound: true \n6 3 2 8 9 7 1 5 4 \n4 1 7 6 2 5 8 9 3 \n8 5 9 4 3 1 2 7 6 \n5 4 3 2 7 9 6 1 8 \n7 2 6 3 1 8 9 4 5 \n9 8 1 5 4 6 7 3 2 \n3 7 5 9 6 2 4 8 1 \n1 6 4 7 8 3 5 2 9 \n2 9 8 1 5 4 3 6 7 \n</code></pre>\n\n<p>I added the following to check for the unicity of the solution:</p>\n\n<pre><code>query2 := labeling.CreateSearchAllQuery()\nsolutionFound2 := labeling.Labeling(store, query2, labeling.SmallestDomainFirst, labeling.InDomainMin)\nif solutionFound2 {\n    println(\"The Sudoku problem has\", len(query2.GetResultSet()), \"solutions.\")\n}\n</code></pre>\n"}], "owner": {"reputation": 1958, "user_id": 830641, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/a70b7.jpg?s=128&g=1", "display_name": "James Hurford", "link": "https://stackoverflow.com/users/830641/james-hurford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 32553690, "answer_count": 1, "score": -1, "last_activity_date": 1442172519, "creation_date": 1442148522, "question_id": 32549840, "link": "https://stackoverflow.com/questions/32549840/why-do-i-have-to-use-core-createintvarfromto-to-get-this-sudoku-solver-to-work", "title": "Why do I have to use core.CreateIntVarFromTo to get this Sudoku solver to work?", "body": "<p>I'm using the Golang gofd package, to provide a constraints satisfaction solution to solve the Sudoku problem.  I create the following</p>\n\n<pre><code>package main\n\nimport (\n    \"bitbucket.org/gofd/gofd/core\"\n    \"bitbucket.org/gofd/gofd/propagator\"\n    \"bitbucket.org/gofd/gofd/labeling\"\n    \"encoding/json\"\n    \"io/ioutil\"\n    \"fmt\"\n)\n\nvar ROWS = []string{\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\"}\nvar COLS = []int{1,2,3,4,5,6,7,8,9}\n\n\nvar SQUARE1 = []string{\n    \"A!\", \"A2\", \"A3\",\n    \"B1\", \"B2\", \"B3\",\n    \"C1\", \"C2\", \"C3\"}\n\nvar SQUARE2 = []string{\n    \"A4\", \"A5\", \"A6\",\n    \"B4\", \"B5\", \"B6\",\n    \"C4\", \"C5\", \"C6\"}\n\nvar SQUARE3 = []string{\n    \"A7\", \"A8\", \"A9\",\n    \"B7\", \"B8\", \"B9\",\n    \"C7\", \"C8\", \"C9\"}\n\nvar SQUARE4 = []string{\n    \"D!\", \"D2\", \"D3\",\n    \"E1\", \"E2\", \"E3\",\n    \"F1\", \"F2\", \"F3\"}\n\nvar SQUARE5 = []string{\n    \"D4\", \"D5\", \"D6\",\n    \"E4\", \"E5\", \"E6\",\n    \"F4\", \"F5\", \"F6\"}\n\nvar SQUARE6 = []string{\n    \"D7\", \"D8\", \"D9\",\n    \"E7\", \"E8\", \"E9\",\n    \"F7\", \"F8\", \"F9\"}\n\nvar SQUARE7 = []string{\n    \"G!\", \"G2\", \"G3\",\n    \"H1\", \"H2\", \"H3\",\n    \"I1\", \"I2\", \"I3\"}\n\nvar SQUARE8 = []string{\n    \"G4\", \"G5\", \"G6\",\n    \"H4\", \"H5\", \"H6\",\n    \"I4\", \"I5\", \"I6\"}\n\nvar SQUARE9 = []string{\n    \"G7\", \"G8\", \"G9\",\n    \"H7\", \"H8\", \"H9\",\n    \"I7\", \"I8\", \"I9\"}\n\nvar SQUARES = [][]string{\n    SQUARE1, SQUARE2, SQUARE3,\n    SQUARE4, SQUARE5, SQUARE6,\n    SQUARE7, SQUARE8, SQUARE9}\n\ntype Grid struct {\n    Grid map[string]int\n}\n\nfunc create() Grid {\n    grid := map[string]int{}\n    return Grid{grid}\n}\n\nfunc (g *Grid) load(filename string) {\n    body, _ := ioutil.ReadFile(filename)\n    err := json.Unmarshal(body, g)\n    if err != nil {\n        fmt.Println(err)\n    }\n}\n\n\nfunc main() {\n    store := core.CreateStore()\n    n := 9\n\n    sudoku := map[string]core.VarId{}\n\n    for _, row := range ROWS {\n        for _, col := range COLS {\n            varname := fmt.Sprintf(\"%s%d\", row, col)\n            sudoku[varname] = core.CreateIntVarFromTo(varname, store, 1, n)\n        }\n    }\n\n    for _, square := range SQUARES {\n        area := make([]core.VarId, len(square))\n        for i, key := range square {\n            area[i] = sudoku[key]\n        }\n\n        prop := propagator.CreateAlldifferent(area...)\n        store.AddPropagators(prop)\n    }\n\n    for _, row := range ROWS {\n        area := make([]core.VarId, len(COLS))\n        for i, col := range COLS {\n            varname := fmt.Sprintf(\"%s%d\", row, col)\n            area[i] = sudoku[varname]\n        }\n        prop := propagator.CreateAlldifferent(area...)\n        store.AddPropagators(prop)\n    }\n\n    for _, col := range COLS {\n        area := make([]core.VarId, len(COLS))\n        for i, row := range ROWS {\n            varname := fmt.Sprintf(\"%s%d\", row, col)\n            area[i] = sudoku[varname]\n        }\n        prop := propagator.CreateAlldifferent(area...)\n        store.AddPropagators(prop)\n    }\n\n    grid := create()\n    grid.load(\"test2.json\")\n\n    for k,v := range grid.Grid {\n        prop := propagator.CreateXeqC(sudoku[k], v)\n        store.AddPropagators(prop)\n    }\n\n    consistent := store.IsConsistent()\n    fmt.Printf(\"consistent: %v \\n\", consistent)\n\n    query := labeling.CreateSearchAllQuery()\n    solutionFound := labeling.Labeling(store, query,labeling.SmallestDomainFirst, labeling.InDomainMin)\n    fmt.Printf(\"solutionFound: %v \\n\", solutionFound)\n    if solutionFound {\n        resultSet := query.GetResultSet()\n        for _, result := range resultSet {\n            values := map[string]int{}\n\n            for k,v := range result {\n                id := store.GetName(k)\n                values[string(id)] = v\n            }\n\n            for _, row := range ROWS {\n                for _, col := range COLS {\n                    key := fmt.Sprintf(\"%s%d\", row, col)\n                    fmt.Print(values[key], \" \")\n                }\n                fmt.Println()\n            }\n\n\n        }\n    }\n}\n</code></pre>\n\n<p>You'll notice I'm loading from a JSON file 'test2.json'.  This files contents are as follows</p>\n\n<pre><code>{\"Grid\": {\n  \"A1\": 6, \"A2\": 3, \"A3\": 2, \"A6\": 7, \"A7\": 1,\n  \"B3\": 7, \"B4\": 6, \"B5\": 2, \"B7\": 8, \"B8\": 9,\n  \"C2\": 5,\n  \"D1\": 5, \"D3\": 3, \"D6\": 9,\n  \"E2\": 2, \"E3\": 6, \"E5\": 1, \"E7\": 9, \"E8\": 4,\n  \"F4\": 5, \"F7\": 7, \"F9\": 2,\n  \"G8\": 8,\n  \"H2\": 6, \"H3\": 4, \"H5\": 8, \"H6\": 3, \"H7\": 5,\n  \"I3\": 8, \"I4\": 1, \"I7\": 3, \"I8\": 6, \"I9\": 7}}\n</code></pre>\n\n<p>This program doesn't work, coming up wi the following.</p>\n\n<pre><code>consistent: false \nsolutionFound: false\n</code></pre>\n\n<p>Unless I add the following var</p>\n\n<pre><code>core.CreateIntVarFromTo(\"total\", store, 50, 50)\n</code></pre>\n\n<p>In which case I do get an answer.  Why do I need to do this?  As far as I can see the other constraints should be enough.  You're after all wanting the row to have all different values within the domain of 1 to 9, same with columns, and units (which I label as squares here).  There should be only one answer to any sudoku problem, and I shouldn't need to add</p>\n\n<pre><code>core.CreateIntVarFromTo(\"total\", store, 50, 50)\n</code></pre>\n\n<p>It doesn't matter what value you give it, as you'll get as many answers as the allowed by this var.  So if I set it like this</p>\n\n<pre><code>core.CreateIntVarFromTo(\"total\", store, 10, 11)\n</code></pre>\n\n<p>I'll get 2 results, of the same numbers.  Also another thing that puzzles me is if I set the to value to below 10</p>\n\n<pre><code>core.CreateIntVarFromTo(\"total\", store, 9, 9)\n</code></pre>\n\n<p>it fails to be consistent and no solution is found, but if I set the to value to 10 or above it comes up with an answer as many times starting from from, up to to, in the following case it will give 3 results</p>\n\n<pre><code>core.CreateIntVarFromTo(\"total\", store, 9, 12)\n</code></pre>\n\n<p>What fact am I missing here?</p>\n"}, {"tags": ["go", "render", "martini"], "answers": [{"tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": true, "score": 1, "last_activity_date": 1442148223, "creation_date": 1442148223, "answer_id": 32549801, "question_id": 32549195, "link": "https://stackoverflow.com/questions/32549195/martini-render-shows-yield-on-page/32549801#32549801", "title": "Martini render shows {{ yield }} on page", "body": "<p>You set your delimiters to \"{[{\" and \"}]}\", but then uses \"{{\" and \"}}\".</p>\n\n<p>Either use <code>Delims:     render.Delims{\"{{\", \"}}\"},</code> or change your template to use <code>{[{ yield }]}</code></p>\n"}], "owner": {"reputation": 37, "user_id": 2782106, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/35ea3e05dcf39844745b5a5dc3317e45?s=128&d=identicon&r=PG&f=1", "display_name": "user2782106", "link": "https://stackoverflow.com/users/2782106/user2782106"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 32549801, "answer_count": 1, "score": -1, "last_activity_date": 1442148223, "creation_date": 1442143863, "last_edit_date": 1442146526, "question_id": 32549195, "link": "https://stackoverflow.com/questions/32549195/martini-render-shows-yield-on-page", "title": "Martini render shows {{ yield }} on page", "body": "<p>I try to render my page in martini\nlayout.html</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n    &lt;head&gt;...&lt;/head&gt;\n    &lt;header&gt;...&lt;/header&gt;\n    {{ yield }}\n    &lt;footer&gt;...&lt;/footer&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>index.html</p>\n\n<pre><code>&lt;main&gt;\n    &lt;h1&gt;Hello&lt;/h1&gt;\n&lt;/main&gt;\n</code></pre>\n\n<p>Render options:</p>\n\n<pre><code>m.Use(render.Renderer(render.Options{\n        Directory:  \"templates\",                \n        Layout:     \"layout\", \n        Extensions: []string{\".tmpl\", \".html\"},\n        Delims:     render.Delims{\"{[{\", \"}]}\"}, \n        Charset:    \"UTF-8\",  \n        IndentJSON: true, \n}))\n</code></pre>\n\n<p>try show page:</p>\n\n<pre><code>rnd.HTML(200, \"edit\", nil)\n</code></pre>\n\n<p>run app and see my page:</p>\n\n<p>All code from layout.html is processed normaly, but the {{ yield }} string stays without difference.</p>\n"}, {"tags": ["mysql", "go"], "answers": [{"comments": [{"owner": {"reputation": 219, "user_id": 5232239, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1676367115908897/picture?type=large", "display_name": "Mitsuhiko Shimomura", "link": "https://stackoverflow.com/users/5232239/mitsuhiko-shimomura"}, "edited": false, "score": 1, "creation_date": 1442149328, "post_id": 32547584, "comment_id": 52955918, "body": "Thanks! I tried removing <code>pkg</code> folder and reinstall the <code>pkg</code> . However error is not disappearing. So I tried  <code>go install github.com&#47;go-sql-driver&#47;mysql</code> . By doing so, I resolve this problem!"}], "tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": true, "score": 2, "last_activity_date": 1442144143, "last_edit_date": 1442144143, "creation_date": 1442131341, "answer_id": 32547584, "question_id": 32546541, "link": "https://stackoverflow.com/questions/32546541/golang-go-sql-driver-mysql-a/32547584#32547584", "title": "Golang go-sql-driver/mysql.a", "body": "<p>As said <a href=\"https://stackoverflow.com/questions/28934618/import-object-is-expected-error-in-golang-1-4-2\">here</a>, with this kind of error, deleting the <code>pkg</code> folder often helps</p>\n"}], "owner": {"reputation": 219, "user_id": 5232239, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1676367115908897/picture?type=large", "display_name": "Mitsuhiko Shimomura", "link": "https://stackoverflow.com/users/5232239/mitsuhiko-shimomura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 611, "favorite_count": 0, "accepted_answer_id": 32547584, "answer_count": 1, "score": 2, "last_activity_date": 1442144143, "creation_date": 1442121265, "question_id": 32546541, "link": "https://stackoverflow.com/questions/32546541/golang-go-sql-driver-mysql-a", "title": "Golang go-sql-driver/mysql.a", "body": "<p>I'm using \"github.com/go-sql-driver/mysql\" library on CentOS6.6 server.<br>\nAnd import the library:</p>\n\n<pre><code>import (\n    _ \"github.com/go-sql-driver/mysql\"\n)\n</code></pre>\n\n<p>Building</p>\n\n<pre><code>go build index.go\n</code></pre>\n\n<p>However, an error occurred.</p>\n\n<blockquote>\n  <p>import /usr/local/go/pkg/linux_amd64/github.com/go-sql-driver/mysql.a: object is [darwin amd64 go1.4.2 X:precisestack] expected [linux amd64 go1.4 X:precisestack]</p>\n</blockquote>\n\n<p>I don't know what this error says.</p>\n\n<p>Please tell me how to solve this problem.</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-elastic-beanstalk"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 3, "creation_date": 1442115178, "post_id": 32545980, "comment_id": 52948781, "body": "After building the binary, the dependencies matter not.  Just deploy the two binaries appA and appB."}, {"owner": {"reputation": 1665, "user_id": 4638952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03791badf72f6918a8910148dfc4401e?s=128&d=identicon&r=PG&f=1", "display_name": "SnoProblem", "link": "https://stackoverflow.com/users/4638952/snoproblem"}, "edited": false, "score": 0, "creation_date": 1442115188, "post_id": 32545980, "comment_id": 52948782, "body": "Is someSharedDep a different app or a library?"}, {"owner": {"reputation": 1334, "user_id": 1505411, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/61848a23c12b4a6dea12ed58a64f32be?s=128&d=identicon&r=PG", "display_name": "Qiming", "link": "https://stackoverflow.com/users/1505411/qiming"}, "reply_to_user": {"reputation": 1665, "user_id": 4638952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03791badf72f6918a8910148dfc4401e?s=128&d=identicon&r=PG&f=1", "display_name": "SnoProblem", "link": "https://stackoverflow.com/users/4638952/snoproblem"}, "edited": false, "score": 0, "creation_date": 1442119163, "post_id": 32545980, "comment_id": 52949361, "body": "@SnoProblem I imagine someSharedDep to be some shared functions or constants between appA and appB. It might also be a shared database helper that defines tables that both appA and appB, for example."}, {"owner": {"reputation": 1334, "user_id": 1505411, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/61848a23c12b4a6dea12ed58a64f32be?s=128&d=identicon&r=PG", "display_name": "Qiming", "link": "https://stackoverflow.com/users/1505411/qiming"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1442119210, "post_id": 32545980, "comment_id": 52949366, "body": "@BravadaZadada I&#39;m not quite sure how to deploy binaries to services like AWS through docker, is that something you can speak more to?"}, {"owner": {"reputation": 1665, "user_id": 4638952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03791badf72f6918a8910148dfc4401e?s=128&d=identicon&r=PG&f=1", "display_name": "SnoProblem", "link": "https://stackoverflow.com/users/4638952/snoproblem"}, "edited": false, "score": 3, "creation_date": 1442120254, "post_id": 32545980, "comment_id": 52949512, "body": "Once appA and appB are compiled to executables, they have everything they need from someSharedDep included in that binary.  Then, it can be deployed as any other executable:  <a href=\"http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create_deploy_go.html\" rel=\"nofollow noreferrer\">docs.aws.amazon.com/elasticbeanstalk/latest/dg/&hellip;</a>"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1442153936, "post_id": 32545980, "comment_id": 52957139, "body": "To deploy a docker image with a binary, add the binary to the image just like you would any other file."}, {"owner": {"reputation": 1334, "user_id": 1505411, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/61848a23c12b4a6dea12ed58a64f32be?s=128&d=identicon&r=PG", "display_name": "Qiming", "link": "https://stackoverflow.com/users/1505411/qiming"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1442339820, "post_id": 32545980, "comment_id": 53038826, "body": "Thanks @BravadaZadada it took some time to get up to speed on exactly what Docker is and some of go&#39;s build processes; is having an image with just a binary (that comes from a previous build step) an anti-pattern in any way? Would you do the build steps in a separate docker container too (to keep things the same)?"}], "owner": {"reputation": 1334, "user_id": 1505411, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/61848a23c12b4a6dea12ed58a64f32be?s=128&d=identicon&r=PG", "display_name": "Qiming", "link": "https://stackoverflow.com/users/1505411/qiming"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 284, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459470531, "creation_date": 1442114401, "last_edit_date": 1459470531, "question_id": 32545980, "link": "https://stackoverflow.com/questions/32545980/source-code-structure-deploying-go-with-subpackages", "title": "Source code structure: deploying Go with Subpackages", "body": "<p>When there is just one go repository and it imports only public dependencies, deploying to (for example, a Docker container on AWS) is extremely straightforward.</p>\n\n<p>However, I have a question about how to use subpackages with go.</p>\n\n<p>Suppose we have a monorepo with 3 packages.</p>\n\n<pre><code>/src\n- /appA\n- /appB\n- /someSharedDep\n</code></pre>\n\n<p>How are deployments typically built so that you deploy appA and someSharedDep to one server and appB and someSharedDep on another server?</p>\n\n<p>I imagine there needs to be some creative employments of our friend the GOPATH, but some help on the topic would be appreciated.</p>\n\n<p>Bonus points if we're talking about an elastic beanstalk deployment.</p>\n\n<h2>Suspicions</h2>\n\n<p>I have some thoughts on how to approach the problem now (and I'll add more or submit an answer if this becomes more complete).</p>\n\n<ol>\n<li>Use vendoring, this means you have the source code of all your dependencies checked into your own repo. It doesn't sound good (esp. if you're used to NodeJS) but it works.</li>\n<li>Now that you use vendoring, vendor your own submodules into the <code>./vendor</code> folder in the application. Yes you will have copies of the same code in two places but whatever.</li>\n<li>Create automated scripts to help manage some of these things. I'm still looking for tools that make vendoring more convenient.</li>\n</ol>\n\n<p>Some problems I still face:</p>\n\n<ol>\n<li>When vendoring, sometimes the dependency has files that have a main() function or declare <code>package main</code>, usually in an <code>./example</code> subfolder. These have to be removed manually. I don't like editing the working source of someone else's project though!</li>\n</ol>\n"}, {"tags": ["go", "hex"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1442122862, "post_id": 32545949, "comment_id": 52949832, "body": "Are we talking about base 32 representation of the result or <a href=\"https://en.wikipedia.org/wiki/Base32\" rel=\"nofollow noreferrer\">Base32</a> encoding? Would be nice if you&#39;d posted some example input and output."}, {"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 0, "creation_date": 1442128760, "post_id": 32545949, "comment_id": 52950829, "body": "Fore quick testing purpose, running the ruby code with str = &quot;example&quot; outputs &quot;od4po9p9ec57v03uve37da9dpdnokfsf&quot;"}, {"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 0, "creation_date": 1442129182, "post_id": 32545949, "comment_id": 52950922, "body": "With steps : str = &quot;example&quot; gives hexdigest =&gt; &quot;c3499c2729730a7f807efb8676a92dcb6f8a3f8f&quot;, to_i =&gt; 1114894757552854782121625437503858766054806929295, to_s =&gt; &quot;od4po9p9ec57v03uve37da9dpdnokfsf&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 88, "user_id": 5329851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae5f6a9ed12b9c387c64ad0257521387?s=128&d=identicon&r=PG", "display_name": "Zohar Arad", "link": "https://stackoverflow.com/users/5329851/zohar-arad"}, "edited": false, "score": 0, "creation_date": 1442209771, "post_id": 32547488, "comment_id": 52971976, "body": "Thanks! Exactly what I Was looking for"}, {"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "reply_to_user": {"reputation": 88, "user_id": 5329851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae5f6a9ed12b9c387c64ad0257521387?s=128&d=identicon&r=PG", "display_name": "Zohar Arad", "link": "https://stackoverflow.com/users/5329851/zohar-arad"}, "edited": false, "score": 0, "creation_date": 1442219918, "post_id": 32547488, "comment_id": 52976552, "body": "@ZoharArad: I just edited my code with a shorter version : the hexadecimal (string and big Int) steps were completely unecessary"}], "tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": true, "score": 9, "last_activity_date": 1541956838, "last_edit_date": 1541956838, "creation_date": 1442130643, "answer_id": 32547488, "question_id": 32545949, "link": "https://stackoverflow.com/questions/32545949/convert-sha1-hex-to-base-16-integer/32547488#32547488", "title": "Convert SHA1 Hex to Base 16 Integer", "body": "<p>Here is an example code (playground : <a href=\"https://play.golang.org/p/izBIq97-0S\" rel=\"nofollow noreferrer\">https://play.golang.org/p/izBIq97-0S</a>):</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/sha1\"\n    \"encoding/base32\"\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    // Input\n    exampleString := \"example\"\n\n    // SHA1 hash\n    hash := sha1.New()\n    hash.Write([]byte(exampleString))\n    hashBytes := hash.Sum(nil)\n\n    // Conversion to base32\n    base32str := strings.ToLower(base32.HexEncoding.EncodeToString(hashBytes))\n\n    fmt.Println(base32str)\n}\n</code></pre>\n\n<p>I tested it agaisnt this Ruby script and the ouput matches :</p>\n\n<pre><code>require 'digest'\n\nstr = \"example\"\nhex = Digest::SHA1.hexdigest(str).to_i(16)\n\nputs hex.to_s(32)\n</code></pre>\n\n<hr>\n\n<p>Edit : here is my original answer, which reproduces every step from the ruby script, but two of them are unnecessary (playground : <a href=\"https://play.golang.org/p/tyQt3ftb1j\" rel=\"nofollow noreferrer\">https://play.golang.org/p/tyQt3ftb1j</a>) :</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/sha1\"\n    \"encoding/base32\"\n    \"encoding/hex\"\n    \"fmt\"\n    \"math/big\"\n    \"strings\"\n)\n\nfunc main() {\n    // Input\n    exampleString := \"example\"\n\n    // SHA1 hash\n    hash := sha1.New()\n    hash.Write([]byte(exampleString))\n    hashBytes := hash.Sum(nil)\n\n    // Hexadecimal conversion\n    hexSha1 := hex.EncodeToString(hashBytes)\n\n    // Integer base16 conversion\n    intBase16, success := new(big.Int).SetString(hexSha1, 16)\n    if !success {\n        panic(\"Failed parsing big Int from hex\")\n    }\n\n    // Conversion to base32\n    base32str := strings.ToLower(base32.HexEncoding.EncodeToString(intBase16.Bytes()))\n\n    fmt.Println(base32str)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1119, "user_id": 9406420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4afd4d026590218c0aff8389c0ec7334?s=128&d=identicon&r=PG", "display_name": "Ritwik", "link": "https://stackoverflow.com/users/9406420/ritwik"}, "is_accepted": false, "score": 2, "last_activity_date": 1554290919, "creation_date": 1554290919, "answer_id": 55494071, "question_id": 32545949, "link": "https://stackoverflow.com/questions/32545949/convert-sha1-hex-to-base-16-integer/55494071#55494071", "title": "Convert SHA1 Hex to Base 16 Integer", "body": "<p>try this \ud83d\ude42</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>h := sha1.New()\nh.Write(content)\nsha := h.Sum(nil)  // \"sha\" is uint8 type, encoded in base16\n\nshaStr := hex.EncodeToString(sha)  // String representation\n\nfmt.Printf(\"%x\\n\", sha)\nfmt.Println(shaStr)\n\n</code></pre>\n\n<p>Example Output...</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>fcbc340d999e751840e17f862cc9eaf826cc6079\nfcbc340d999e751840e17f862cc9eaf826cc6079\n</code></pre>\n"}], "owner": {"reputation": 88, "user_id": 5329851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae5f6a9ed12b9c387c64ad0257521387?s=128&d=identicon&r=PG", "display_name": "Zohar Arad", "link": "https://stackoverflow.com/users/5329851/zohar-arad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3626, "favorite_count": 1, "accepted_answer_id": 32547488, "answer_count": 2, "score": 5, "last_activity_date": 1561812944, "creation_date": 1442114019, "last_edit_date": 1561812944, "question_id": 32545949, "link": "https://stackoverflow.com/questions/32545949/convert-sha1-hex-to-base-16-integer", "title": "Convert SHA1 Hex to Base 16 Integer", "body": "<p>I need some help porting an algorithm from Ruby to Go.</p>\n\n<p>In Ruby I have:</p>\n\n<pre><code>hex = Digest::SHA1.hexdigest(str).to_i(16)\nhex.to_s(32)\n</code></pre>\n\n<p>Which creates a SHA1 hex string, converts it to an integer in base 16 and then back to a string in base 32.</p>\n\n<p>How do I achieve the same in Go?</p>\n"}, {"tags": ["go", "concurrency", "pipe", "producer-consumer"], "comments": [{"owner": {"reputation": 1665, "user_id": 4638952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03791badf72f6918a8910148dfc4401e?s=128&d=identicon&r=PG&f=1", "display_name": "SnoProblem", "link": "https://stackoverflow.com/users/4638952/snoproblem"}, "edited": false, "score": 0, "creation_date": 1442110683, "post_id": 32545103, "comment_id": 52948179, "body": "Have you tried using the built-in pipe generators instead of creating them yourself? <code>func (c *Cmd) StdinPipe() (io.WriteCloser, error)</code> and <code>func (c *Cmd) StdoutPipe() (io.ReadCloser, error)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 713, "user_id": 1846021, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/975c623c961d8fd39daaa6ab78d37065?s=128&d=identicon&r=PG", "display_name": "Madhav Jha", "link": "https://stackoverflow.com/users/1846021/madhav-jha"}, "edited": false, "score": 0, "creation_date": 1442114995, "post_id": 32545994, "comment_id": 52948754, "body": "After some minor changes (like changing io.ReadCloser to io.WriteCloser) and running it, the program blocks for me and doesn&#39;t produce any output."}, {"owner": {"reputation": 1665, "user_id": 4638952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03791badf72f6918a8910148dfc4401e?s=128&d=identicon&r=PG&f=1", "display_name": "SnoProblem", "link": "https://stackoverflow.com/users/4638952/snoproblem"}, "reply_to_user": {"reputation": 713, "user_id": 1846021, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/975c623c961d8fd39daaa6ab78d37065?s=128&d=identicon&r=PG", "display_name": "Madhav Jha", "link": "https://stackoverflow.com/users/1846021/madhav-jha"}, "edited": false, "score": 0, "creation_date": 1442115530, "post_id": 32545994, "comment_id": 52948825, "body": "Sorry, pasted the wrong code.  Edited to correct it.  The goroutine in runIt shouldn&#39;t have been removed."}, {"owner": {"reputation": 713, "user_id": 1846021, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/975c623c961d8fd39daaa6ab78d37065?s=128&d=identicon&r=PG", "display_name": "Madhav Jha", "link": "https://stackoverflow.com/users/1846021/madhav-jha"}, "edited": false, "score": 0, "creation_date": 1442116022, "post_id": 32545994, "comment_id": 52948897, "body": "This is great and running pretty reliably and smoothly. One final question. Any idea how to incorporate &quot;DIFF&quot; program in this? I mean I want the the two output streams from prog1 and prog2 to be input of another process DIFF."}, {"owner": {"reputation": 1665, "user_id": 4638952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03791badf72f6918a8910148dfc4401e?s=128&d=identicon&r=PG&f=1", "display_name": "SnoProblem", "link": "https://stackoverflow.com/users/4638952/snoproblem"}, "reply_to_user": {"reputation": 713, "user_id": 1846021, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/975c623c961d8fd39daaa6ab78d37065?s=128&d=identicon&r=PG", "display_name": "Madhav Jha", "link": "https://stackoverflow.com/users/1846021/madhav-jha"}, "edited": false, "score": 1, "creation_date": 1442116721, "post_id": 32545994, "comment_id": 52949004, "body": "Grab the output using <code>cmd.StdoutPipe()</code> similar to the way <code>cmd.StdinPipe()</code> is captured in <code>runProg()</code>."}], "tags": [], "owner": {"reputation": 1665, "user_id": 4638952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03791badf72f6918a8910148dfc4401e?s=128&d=identicon&r=PG&f=1", "display_name": "SnoProblem", "link": "https://stackoverflow.com/users/4638952/snoproblem"}, "is_accepted": true, "score": 3, "last_activity_date": 1442115480, "last_edit_date": 1442115480, "creation_date": 1442114551, "answer_id": 32545994, "question_id": 32545103, "link": "https://stackoverflow.com/questions/32545103/how-to-wire-up-multiple-programs-reading-writing-via-stdin-stdout-in-golang-conc/32545994#32545994", "title": "How to wire up multiple programs reading/writing via STDIN/STDOUT in Golang concurrently?", "body": "<p>There are a couple things here.  You're adding work and complexity in creating all those pipes.  Also, running the command concurrently is built-in using Cmd.Start() and Cmd.Wait().  </p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"io\"\n        \"os\"\n        \"os/exec\"\n)\n\nconst UPPER = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"\nconst LOWER = \"abcdefghijklmnopqrstuvwxyz\"\n\nfunc runProg(cmd *exec.Cmd) (w io.WriteCloser, err error) {\n        w, err := cmd.StdinPipe()\n        if err != nil {\n                fmt.Println(err)\n        }\n        cmd.Stdout = os.Stdout\n        err = cmd.Start()\n}\n\n\n\nfunc runIt(r io.Reader, prog1 *exec.Cmd, prog2 *exec.Cmd) {\n\n        w1, err := runProg(prog1)\n        if err != nil {\n                fmt.Println(err)\n        }\n        w2, err := runProg(prog2)\n        if err != nil {\n                fmt.Println(err)\n        }\n\n        go func() {\n                defer w1.Close()\n                defer w2.Close()\n                mw := io.MultiWriter(w1, w2)\n                io.Copy(mw, r)\n        }()\n\n}\n\nfunc main() {\n        generator := exec.Command(\"ls\", \"-l\")\n        r, err := generator.StdoutPipe()\n        if err != nil {\n                fmt.Println(err)\n        }\n\n        prog1 := exec.Command(\"tr\", LOWER, UPPER)\n        prog2 := exec.Command(\"tr\", UPPER, LOWER)\n\n        runIt(r, prog1, prog2)\n\n        generator.Run()\n\n        err = prog1.Wait()\n        err1 := prog2.Wait()\n        if err != nil || err1 != nil {\n                fmt.Println(err, err1)\n        }\n}\n</code></pre>\n"}], "owner": {"reputation": 713, "user_id": 1846021, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/975c623c961d8fd39daaa6ab78d37065?s=128&d=identicon&r=PG", "display_name": "Madhav Jha", "link": "https://stackoverflow.com/users/1846021/madhav-jha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1127, "favorite_count": 0, "accepted_answer_id": 32545994, "answer_count": 1, "score": 3, "last_activity_date": 1442115480, "creation_date": 1442103827, "question_id": 32545103, "link": "https://stackoverflow.com/questions/32545103/how-to-wire-up-multiple-programs-reading-writing-via-stdin-stdout-in-golang-conc", "title": "How to wire up multiple programs reading/writing via STDIN/STDOUT in Golang concurrently?", "body": "<p>At a high level I would like to accomplish the following. Each box is a running program reading from STDIN and writing to STDOUT. I want to write a golang program which sets this up and runs it so that all production/consumption is happening in parallel. I am thinking of using io.Pipe, channels, and os.Exec etc.</p>\n\n<pre><code>                            +-----------+                                  \n                            |  PROG-1   +-----------------------+          \n                +---------&gt; |           |                       v          \n                |           +-----------+                                  \n                |                                           +-------+      \n    +-----------+                                           | DIFF  +-----&gt;\n    | GENERATOR |                                           |       |      \n    +-----------+                                           +---+---+      \n                |                                               ^          \n                |                                               |          \n                |           +-----------+                       |          \n                |           |           |                       |          \n                +---------&gt; |  PROG-2   +-----------------------+          \n                            +-----------+                                  \n</code></pre>\n\n<p>Here's an attempt but it doesn't seem to be working reliably and also the \"DIFF\" part is not implemented.</p>\n\n<pre><code>package main\n\nimport (\n    \"io\"\n    \"os\"\n    \"os/exec\"\n)\n\nconst UPPER = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"\nconst LOWER = \"abcdefghijklmnopqrstuvwxyz\"\n\nfunc runProg(r io.Reader, cmd *exec.Cmd) {\n    cmd.Stdin = r\n    cmd.Stdout = os.Stdout // I want this to go to a third prog call \"diff\".\n    cmd.Run()\n}\n\nfunc runIt(r io.Reader, prog1 *exec.Cmd, prog2 *exec.Cmd) {\n    r1, w1 := io.Pipe()\n    r2, w2 := io.Pipe()\n\n    go runProg(r1, prog1)\n    go runProg(r2, prog2)\n\n    go func() {\n        defer w1.Close()\n        defer w2.Close()\n        mw := io.MultiWriter(w1, w2)\n        io.Copy(mw, r)\n    }()\n\n}\n\nfunc main() {\n    generator := exec.Command(\"ls\", \"-l\")\n    r, w := io.Pipe()\n    generator.Stdout = w\n\n    prog1 := exec.Command(\"tr\", LOWER, UPPER)\n    prog2 := exec.Command(\"tr\", UPPER, LOWER)\n\n    runIt(r, prog1, prog2)\n\n    generator.Run()\n\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 7931, "user_id": 441099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d18ac367611aeb431cef6e156525d5a?s=128&d=identicon&r=PG", "display_name": "Guy Sirton", "link": "https://stackoverflow.com/users/441099/guy-sirton"}, "edited": false, "score": 1, "creation_date": 1442110213, "post_id": 32544927, "comment_id": 52948109, "body": "This isn&#39;t exactly what you&#39;re looking for but maybe can help: <a href=\"http://stackoverflow.com/questions/12430874/image-manipulation-in-golang\" title=\"image manipulation in golang\">stackoverflow.com/questions/12430874/&hellip;</a>"}, {"owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "reply_to_user": {"reputation": 7931, "user_id": 441099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d18ac367611aeb431cef6e156525d5a?s=128&d=identicon&r=PG", "display_name": "Guy Sirton", "link": "https://stackoverflow.com/users/441099/guy-sirton"}, "edited": false, "score": 0, "creation_date": 1442172519, "post_id": 32544927, "comment_id": 52963198, "body": "Guy that was helpful thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "edited": false, "score": 0, "creation_date": 1442221241, "post_id": 32546835, "comment_id": 52977253, "body": "Thanks for the suggestion. But I found out that I can crop with offsets with the image/draw package from the standard library. Thanks for the suggestion tho!"}], "tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": false, "score": 1, "last_activity_date": 1442124377, "creation_date": 1442124377, "answer_id": 32546835, "question_id": 32544927, "link": "https://stackoverflow.com/questions/32544927/cropping-and-creating-thumbnails-with-go/32546835#32546835", "title": "Cropping and creating thumbnails with Go", "body": "<p><a href=\"https://github.com/gographics/imagick\" rel=\"nofollow\">https://github.com/gographics/imagick</a> seems to have what you need : <a href=\"https://godoc.org/github.com/gographics/imagick/imagick#MagickWand.CropImage\" rel=\"nofollow\">https://godoc.org/github.com/gographics/imagick/imagick#MagickWand.CropImage</a></p>\n"}, {"comments": [{"owner": {"reputation": 2353, "user_id": 6228832, "user_type": "registered", "profile_image": "https://graph.facebook.com/1104619716246069/picture?type=large", "display_name": "Reenath Reddy Thummala", "link": "https://stackoverflow.com/users/6228832/reenath-reddy-thummala"}, "edited": false, "score": 1, "creation_date": 1578048095, "post_id": 32553728, "comment_id": 105320644, "body": "Can you please share the sample code to crop an image using a rectangle? Thanks"}], "tags": [], "owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "is_accepted": true, "score": 11, "last_activity_date": 1442172729, "creation_date": 1442172729, "answer_id": 32553728, "question_id": 32544927, "link": "https://stackoverflow.com/questions/32544927/cropping-and-creating-thumbnails-with-go/32553728#32553728", "title": "Cropping and creating thumbnails with Go", "body": "<p>I'll answer my own question so that it can be of help to other newcomers of Go.</p>\n\n<p>Reading these two articles helped me greatly to understand how to crop images in Go. No need for third libraries. You decide how to crop an image with points and rectangles which is a very neat way of doing it.</p>\n\n<p><a href=\"http://blog.golang.org/go-image-package\" rel=\"noreferrer\">http://blog.golang.org/go-image-package</a></p>\n\n<p><a href=\"http://blog.golang.org/go-imagedraw-package\" rel=\"noreferrer\">http://blog.golang.org/go-imagedraw-package</a></p>\n"}, {"tags": [], "owner": {"reputation": 5024, "user_id": 1419891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bb825cd3f1905f42c16408393480a65b?s=128&d=identicon&r=PG", "display_name": "425nesp", "link": "https://stackoverflow.com/users/1419891/425nesp"}, "is_accepted": false, "score": 2, "last_activity_date": 1596583802, "creation_date": 1596583802, "answer_id": 63256403, "question_id": 32544927, "link": "https://stackoverflow.com/questions/32544927/cropping-and-creating-thumbnails-with-go/63256403#63256403", "title": "Cropping and creating thumbnails with Go", "body": "<p>Here's a simple program that crops an image. If chops off the image outside of a given rectangle.</p>\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;image&quot;\n    &quot;log&quot;\n    &quot;os&quot;\n\n    &quot;image/png&quot;\n)\n\nfunc main() {\n    if err := run(); err != nil {\n        log.Fatalln(err)\n    }\n}\n\nfunc run() error {\n    img, err := readImage(&quot;pic.png&quot;)\n    if err != nil {\n        return err\n    }\n\n    // I've hard-coded a crop rectangle, start (0,0), end (100, 100).\n    img, err = cropImage(img, image.Rect(0, 0, 100, 100))\n    if err != nil {\n        return err\n    }\n\n    return writeImage(img, &quot;pic-cropped.png&quot;)\n}\n\n// readImage reads a image file from disk. We're assuming the file will be png\n// format.\nfunc readImage(name string) (image.Image, error) {\n    fd, err := os.Open(&quot;pic.png&quot;)\n    if err != nil {\n        return nil, err\n    }\n    defer fd.Close()\n\n    // image.Decode requires that you import the right image package. We've\n    // imported &quot;image/png&quot;, so Decode will work for png files. If we needed to\n    // decode jpeg files then we would need to import &quot;image/jpeg&quot;.\n    //\n    // Ignored return value is image format name.\n    img, _, err := image.Decode(fd)\n    if err != nil {\n        return nil, err\n    }\n\n    return img, nil\n}\n\n// cropImage takes an image and crops it to the specified rectangle.\nfunc cropImage(img image.Image, crop image.Rectangle) (image.Image, error) {\n    type subImager interface {\n        SubImage(r image.Rectangle) image.Image\n    }\n\n    // img is an Image interface. This checks if the underlying value has a\n    // method called SubImage. If it does, then we can use SubImage to crop the\n    // image.\n    simg, ok := img.(subImager)\n    if !ok {\n        return nil, fmt.Errorf(&quot;image does not support cropping&quot;)\n    }\n\n    return simg.SubImage(crop), nil\n}\n\n// writeImage writes an Image back to the disk.\nfunc writeImage(img image.Image, name string) error {\n    fd, err := os.Create(name)\n    if err != nil {\n        return err\n    }\n    defer fd.Close()\n\n    return png.Encode(fd, img)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1885, "user_id": 1536133, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8b7d4d7ca49c05b83a6a296c27df27b0?s=128&d=identicon&r=PG", "display_name": "Gabriel Furstenheim", "link": "https://stackoverflow.com/users/1536133/gabriel-furstenheim"}, "is_accepted": false, "score": 1, "last_activity_date": 1597870612, "creation_date": 1597870612, "answer_id": 63494873, "question_id": 32544927, "link": "https://stackoverflow.com/questions/32544927/cropping-and-creating-thumbnails-with-go/63494873#63494873", "title": "Cropping and creating thumbnails with Go", "body": "<p>It is explained better in this <a href=\"https://stackoverflow.com/a/16093117/1536133\">answer</a>. The SubImage method is implemented for most of the image formats (seems to be all but <code>Uniform</code>). Since it does not belong to the main interface you need to assert it in order to use it.</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;image&quot;\n    &quot;image/jpeg&quot;\n    &quot;log&quot;\n    &quot;os&quot;\n)\n\nfunc main() {\n    image_file, err := os.Open(&quot;somefile.jpeg&quot;)\n    if err != nil {\n        log.Fatal(err)\n    }\n    my_image, err := jpeg.Decode(image_file)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    my_sub_image := my_image.(interface {\n        SubImage(r image.Rectangle) image.Image\n    }).SubImage(image.Rect(0, 0, 10, 10))\n\n    output_file, outputErr := os.Create(&quot;output.jpeg&quot;)\n    if outputErr != nil {\n        log.Fatal(outputErr)\n    }\n    jpeg.Encode(output_file, my_sub_image, nil)\n\n}\n</code></pre>\n"}], "owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4820, "favorite_count": 1, "accepted_answer_id": 32553728, "answer_count": 4, "score": 5, "last_activity_date": 1597870612, "creation_date": 1442101791, "question_id": 32544927, "link": "https://stackoverflow.com/questions/32544927/cropping-and-creating-thumbnails-with-go", "title": "Cropping and creating thumbnails with Go", "body": "<p>Is there a way for me to crop an image with Go by giving dimensions and offsets?</p>\n\n<p>I'm thinking of something flexible like this php function:\n<a href=\"http://php.net/manual/en/function.imagecopyresampled.php\" rel=\"noreferrer\">http://php.net/manual/en/function.imagecopyresampled.php</a></p>\n\n<p>I found this: <a href=\"https://github.com/nfnt/resize\" rel=\"noreferrer\">https://github.com/nfnt/resize</a>\nBut that library does not seem to have an offset option.</p>\n\n<p>I need to be able to crop any area of the original image. Not just scaling down, but also a different positioning of the cropped image.</p>\n\n<p>Any suggestions on how I can achieve this?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1442178863, "post_id": 32545483, "comment_id": 52965098, "body": "Any particular reason you aren&#39;t making these methods rather than functions? E.g. <code>func (f *fileScanner) Open(path string) error</code> (I prefer to <a href=\"https://github.com/golang/go/wiki/CodeReviewComments#named-result-parameters\" rel=\"nofollow noreferrer\">avoid named result parameters and naked returns</a>), <code>func (f *fileScanner) Scanner() *bufio.Scanner</code>, etc. You wouldn&#39;t need a <code>Close</code> method if you embedded the <code>*os.File</code> (or better, an <code>io.ReadCloser</code>) and similarly you wouldn&#39;t need to return the scanner if you just embedded it as they could call <code>Scan</code>, <code>Text</code> etc on your <code>fileScanner</code> in that case."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1442178950, "post_id": 32545483, "comment_id": 52965123, "body": "Also you made a <code>Scanner</code> field but <code>NewScanner</code> doesn&#39;t use it."}, {"owner": {"reputation": 7931, "user_id": 441099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d18ac367611aeb431cef6e156525d5a?s=128&d=identicon&r=PG", "display_name": "Guy Sirton", "link": "https://stackoverflow.com/users/441099/guy-sirton"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1442182210, "post_id": 32545483, "comment_id": 52966019, "body": "@DaveC I meant to use it :)  let me fix that."}, {"owner": {"reputation": 7931, "user_id": 441099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d18ac367611aeb431cef6e156525d5a?s=128&d=identicon&r=PG", "display_name": "Guy Sirton", "link": "https://stackoverflow.com/users/441099/guy-sirton"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1442183357, "post_id": 32545483, "comment_id": 52966286, "body": "@DaveC and yeah, those should have been methods as the answer text suggests.  Fixed that as well.  I like your embedding solution better but that&#39;s your answer so I&#39;ll leave it up to you to submit it...  As to named return parameters, sometimes it just seems to make for nicer code but thanks for that reference."}], "tags": [], "owner": {"reputation": 7931, "user_id": 441099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d18ac367611aeb431cef6e156525d5a?s=128&d=identicon&r=PG", "display_name": "Guy Sirton", "link": "https://stackoverflow.com/users/441099/guy-sirton"}, "is_accepted": false, "score": 0, "last_activity_date": 1442183172, "last_edit_date": 1442183172, "creation_date": 1442108217, "answer_id": 32545483, "question_id": 32544899, "link": "https://stackoverflow.com/questions/32544899/how-to-close-a-file-outside-of-the-function-from-which-it-is-opened/32545483#32545483", "title": "How to close a file outside of the function from which it is opened?", "body": "<p>I think the simplest solution is just not to open the file in your <code>fileScanner</code> function.  </p>\n\n<p>If it's really important for you to extract these operations out of your main function then consider creating a new struct type that holds both your scanner and your file pointer and then you can define methods on that type to open, close and get the scanner.  Something along these lines:</p>\n\n<pre><code>type fileScanner struct {\n    File    *os.File\n    Scanner *bufio.Scanner\n}\n\nfunc NewFileScanner() *fileScanner {\n    return &amp;fileScanner{}\n}\n\nfunc (f *fileScanner) Open(path string) (err error) {\n    f.File, err = os.Open(path)\n    return err\n}\n\nfunc (f *fileScanner) Close() error {\n    return f.File.Close()\n}\n\nfunc (f *fileScanner) GetScanner() *bufio.Scanner {\n    if f.Scanner == nil {\n        f.Scanner = bufio.NewScanner(f.File)\n        f.Scanner.Split(bufio.ScanLines)\n    }\n    return f.Scanner\n}\n\nfunc main() {\n    var path string\n    if len(os.Args) &gt; 1 {\n        fscanner := NewFileScanner()\n        err := fscanner.Open(path)\n        if err == nil {\n            defer fscanner.Close()\n            scanner := fscanner.GetScanner()\n            // Go through file line by line.\n            for scanner.Scan() {\n                fmt.Println(scanner.Text())\n                // or do other stuff\n            }\n\n        }\n    }\n}\n</code></pre>\n\n<p>Which is rather a lot of work for this purpose.  Other alternatives are to return the file from your function (though you should handle panics to avoid any possible leaks) or to return a cleanup function.</p>\n"}], "owner": {"reputation": 131, "user_id": 1127116, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6e86285b295284eb11c0abde9d10708f?s=128&d=identicon&r=PG", "display_name": "mojo5000", "link": "https://stackoverflow.com/users/1127116/mojo5000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1289, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1593188216, "creation_date": 1442101537, "last_edit_date": 1593188216, "question_id": 32544899, "link": "https://stackoverflow.com/questions/32544899/how-to-close-a-file-outside-of-the-function-from-which-it-is-opened", "title": "How to close a file outside of the function from which it is opened?", "body": "<p>I'm trying to read lines in files.  I'd like to easily open a file, and parse through the lines one at a time, and remove some boilerplate opening and closing.  I'm passing back a pointer to the 'scanner'.  Is this just a dumb approach?  Has the scanner already read the contents because of the Split?  Are there better ways of doing this?  Any insight regarding best practices are appreciated.</p>\n\n<pre><code>    func main() {\n            var path string\n            if len(os.Args) &gt; 1 {\n                    err, scanner := fileScanner(path)\n                    if err == nil {\n                            // Go through file line by line.\n                            for scanner.Scan() {\n                                    fmt.Println(scanner.Text())\n                                    // or do other stuff\n                            }\n                            // so how do I make sure to close the file?\n                    }\n            }\n    }\n\n    // Return a scanner for a file.\n    func fileScanner(path string) *bufio.Scanner {\n            file, err := os.Open(path)\n            if err != nil {\n                    return err\n            }\n            //defer file.Close()\n            scanner := bufio.NewScanner(file)\n            scanner.Split(bufio.ScanLines)\n            return err, scanner\n    }\n</code></pre>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 1364, "user_id": 791842, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/e22db9b1ffd20305669ffe5676baca02?s=128&d=identicon&r=PG", "display_name": "sathishvj", "link": "https://stackoverflow.com/users/791842/sathishvj"}, "edited": false, "score": 0, "creation_date": 1442093693, "post_id": 32543751, "comment_id": 52944738, "body": "Meanwhile I deleted unused indexes.  Also the one that I am interested in (CustomerCode &amp; Timestamp).  Then added it back again.  Still the same,  &quot;- - Serving&quot; and timeout errors in code."}, {"owner": {"reputation": 1364, "user_id": 791842, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/e22db9b1ffd20305669ffe5676baca02?s=128&d=identicon&r=PG", "display_name": "sathishvj", "link": "https://stackoverflow.com/users/791842/sathishvj"}, "edited": false, "score": 1, "creation_date": 1442094758, "post_id": 32543751, "comment_id": 52945051, "body": "Looks like the problem was elsewhere.  This apparently has to do with a timeout rather than the index itself.  <a href=\"http://stackoverflow.com/questions/25827362/appengine-datastore-timeout-error-thrown-before-30s-limit-reached\" title=\"appengine datastore timeout error thrown before 30s limit reached\">stackoverflow.com/questions/25827362/&hellip;</a>"}], "owner": {"reputation": 1364, "user_id": 791842, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/e22db9b1ffd20305669ffe5676baca02?s=128&d=identicon&r=PG", "display_name": "sathishvj", "link": "https://stackoverflow.com/users/791842/sathishvj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "closed_date": 1443158137, "answer_count": 0, "score": 0, "last_activity_date": 1475211410, "creation_date": 1442092169, "last_edit_date": 1475211410, "question_id": 32543751, "link": "https://stackoverflow.com/questions/32543751/appengine-datastore-index-has-no-entries", "closed_reason": "Duplicate", "title": "appengine datastore index has no entries", "body": "<p>I was trying out a couple of things on golang and google appengine datastore.  In some cases indexes seem to be created as shown in the image.  In other cases it says 'Serving', but there are seemingly no entries. Because of this I also get an error in the logs: </p>\n\n<p><code>API error 5 (datastore_v3: TIMEOUT): The datastore operation timed out, or the data was temporarily unavailable.</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/TiGzh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TiGzh.png\" alt=\"screenshot of empty datastore index\"></a></p>\n\n<p>As far as I can see, there doesn't seem to be any significant difference between the various indexes I'm trying.  Is there any reason why some indexes would be served but others not?  </p>\n"}, {"tags": ["go", "resource-cleanup"], "comments": [{"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 2, "creation_date": 1442127158, "post_id": 32541870, "comment_id": 52950525, "body": "Just a small note (not worth a full answer) that <code>defer</code> has a performance cost. It&#39;s extremely tiny (~75 ns according to my tests on go1.5.1 linux/amd64) and probably not worth considering, but it still should be noted."}], "answers": [{"tags": [], "owner": {"reputation": 3575, "user_id": 111866, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e742e21c1b64a037eaa90aea1fdf7874?s=128&d=identicon&r=PG", "display_name": "Ross Light", "link": "https://stackoverflow.com/users/111866/ross-light"}, "is_accepted": true, "score": 34, "last_activity_date": 1442085057, "creation_date": 1442085057, "answer_id": 32542683, "question_id": 32541870, "link": "https://stackoverflow.com/questions/32541870/multiple-defers-vs-deferred-anonymous-function/32542683#32542683", "title": "Multiple defers vs deferred anonymous function", "body": "<p>In this example, the anonymous function is easier to read, especially once you add in error handling.</p>\n\n<pre><code>f, err := ioutil.TempFile(\"\", \"prefix\")\nif err != nil {\n  log.Println(\"creating temp file:\", err)\n  return\n}\ndefer func() {\n  err := f.Close()\n  if err != nil {\n    log.Println(\"close:\", err)\n  }\n  err = os.Remove(f.Name())\n  if err != nil {\n    log.Println(\"remove:\", err)\n  }\n}()\n</code></pre>\n\n<p>If you have multiple resources, then multiple <code>defer</code>s is generally appropriate.</p>\n"}, {"comments": [{"owner": {"reputation": 544, "user_id": 2469559, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7DCjy.jpg?s=128&g=1", "display_name": "Benjamin R", "link": "https://stackoverflow.com/users/2469559/benjamin-r"}, "edited": false, "score": 0, "creation_date": 1601104288, "post_id": 55878049, "comment_id": 113306078, "body": "Can someone shape this into an actual answer to the question, and the bottom-line takeaway? &quot;April 2019: But in that case, consider Go 1.13...&quot; doesn&#39;t seem to actually refute the statement &quot;If you have multiple resources, then multiple <code>defer</code>s is generally appropriate.&quot; It just provides some context on the overheads, right?"}, {"owner": {"reputation": 544, "user_id": 2469559, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7DCjy.jpg?s=128&g=1", "display_name": "Benjamin R", "link": "https://stackoverflow.com/users/2469559/benjamin-r"}, "edited": false, "score": 2, "creation_date": 1601126668, "post_id": 55878049, "comment_id": 113311389, "body": "Thanks so much for the clarification, this is a brilliant and complete answer now."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 8, "last_activity_date": 1601111535, "last_edit_date": 1601111535, "creation_date": 1556347730, "answer_id": 55878049, "question_id": 32541870, "link": "https://stackoverflow.com/questions/32541870/multiple-defers-vs-deferred-anonymous-function/55878049#55878049", "title": "Multiple defers vs deferred anonymous function", "body": "<p>As <a href=\"https://stackoverflow.com/users/111866/ross-light\">Ross Light</a> answer <a href=\"https://stackoverflow.com/q/32541870/6309\">states</a>:</p>\n<blockquote>\n<p>If you have multiple resources, then multiple defers is generally appropriate.</p>\n</blockquote>\n<p>April 2019: But in that case, consider Go 1.13 (Q4 2019), as it does integrate a fix for <a href=\"https://github.com/golang/go/issues/14939\" rel=\"nofollow noreferrer\">go issue 14939: &quot;runtime: defer is slow&quot;</a> and <a href=\"https://github.com/golang/go/issues/6980\" rel=\"nofollow noreferrer\">go issue 6980: &quot;cmd/compile: allocate some defers in stack frames&quot;</a></p>\n<p>See <a href=\"https://go-review.googlesource.com/c/go/+/171758/\" rel=\"nofollow noreferrer\">Go CL 171758: &quot;cmd/compile,runtime: allocate defer records on the stack&quot;</a></p>\n<blockquote>\n<p>When a defer is executed at most once in a function body,\nwe can allocate the defer record for it on the stack instead\nof on the heap.</p>\n<p>This should make defers like this (which are very common) faster.</p>\n<p>This optimization applies to 363 out of the 370 static defer sites\nin the cmd/go binary.</p>\n<pre><code>name     old time/op  new time/op  delta\nDefer-4  52.2ns \u00b1 5%  36.2ns \u00b1 3%  -30.70%  (p=0.000 n=10+10)\n</code></pre>\n</blockquote>\n<hr />\n<p>Oct. 2019 (Go 1.13 is released a few weeks ago)</p>\n<p>This <a href=\"https://twitter.com/bradfitz/status/1184547163235184640\" rel=\"nofollow noreferrer\">is confirmed (Brad Fitzpatrick)</a> with <a href=\"https://go-review.googlesource.com/c/go/+/190098\" rel=\"nofollow noreferrer\">CL 190098</a>:</p>\n<blockquote>\n<p>Cost of defer statement  [ <code>go test -run NONE -bench BenchmarkDefer$ runtime</code> ]</p>\n</blockquote>\n<blockquote>\n<pre><code>With normal (stack-allocated) defers only:         35.4  ns/op\nWith open-coded defers:                             5.6  ns/op\nCost of function call alone (remove defer keyword): 4.4  ns/op\n</code></pre>\n</blockquote>\n<p>But <a href=\"https://twitter.com/dgryski/status/1184568632082227200\" rel=\"nofollow noreferrer\">Damien Grisky adds</a>:</p>\n<blockquote>\n<p>Defer gets cheaper, but panic/recover is more expensive.</p>\n</blockquote>\n<blockquote>\n<pre><code>Cost of defer: 34ns -&gt; 6ns.\nCost of panic/recover: 62ns -&gt; 255ns\n</code></pre>\n</blockquote>\n<p>That is not a bad trade-off.</p>\n<hr />\n<p>In other words, while using multiple defer can be idiomatic, that practice was held back by performance costs which are no longer a concern with Go 1.13+.<br />\n(as illustrated by <a href=\"https://tpaschalis.github.io/about/\" rel=\"nofollow noreferrer\">Paschalis</a>'s blog post &quot;<a href=\"https://tpaschalis.github.io/defer-internals/\" rel=\"nofollow noreferrer\">What is a defer? And how many can you run?</a>&quot;)</p>\n<p>That makes <a href=\"https://golangbot.com/defer/#practicaluseofdefer\" rel=\"nofollow noreferrer\">practical use if defer</a> (in places where a function call should be executed irrespective of the code flow) possible.</p>\n<p><a href=\"https://twitter.com/jrefior\" rel=\"nofollow noreferrer\">John Refior</a> notes, however, that <a href=\"https://johnrefior.com/gobits/read?post=15\" rel=\"nofollow noreferrer\"><code>defer</code> is synchronous</a>:</p>\n<blockquote>\n<p>Actually defer is executed immediately before the function exits.<br />\nAnd it occurs synchronously, so the caller waits for defer to complete.</p>\n</blockquote>\n<p>So even if you can now have multiple defer, make sure they are fast, or, as John notes:</p>\n<blockquote>\n<p>Fortunately it\u2019s easy to wrap a goroutine in a <code>defer</code>, giving us the flow control and timing we want, without delaying the caller:</p>\n</blockquote>\n<pre class=\"lang-golang prettyprint-override\"><code>func Handler(w http.ResponseWriter, r *http.Request) {\n    log.Println(&quot;Entered Handler&quot;)\n    defer func() {\n        go func() {\n            time.Sleep(5 * time.Second)\n            log.Println(&quot;Exiting goroutine&quot;)\n        }()\n        log.Println(&quot;Exiting defer&quot;)\n    }()\n}\n</code></pre>\n<blockquote>\n<p>Often defers are used for locking a mutex, or closing a connection or file descriptor, and the work they do is fast, or we want it to complete before the caller moves on.</p>\n<p>But when you\u2019re doing slow work that the client shouldn\u2019t need to wait for at the end of an HTTP handler, making the call asynchronous can substantially improve user experience.</p>\n</blockquote>\n"}], "owner": {"reputation": 3563, "user_id": 836097, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2e0fa7cc4752b302df71ac7fa7de9188?s=128&d=identicon&r=PG", "display_name": "Vlad Didenko", "link": "https://stackoverflow.com/users/836097/vlad-didenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14689, "favorite_count": 4, "accepted_answer_id": 32542683, "answer_count": 2, "score": 35, "last_activity_date": 1601111535, "creation_date": 1442080047, "question_id": 32541870, "link": "https://stackoverflow.com/questions/32541870/multiple-defers-vs-deferred-anonymous-function", "title": "Multiple defers vs deferred anonymous function", "body": "<p>Is it safer or more idiomatic to issue multiple <code>defer</code> statements which are dependent on the order, or to defer an anonymous function which packages the logic?</p>\n\n<p>Examples:</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>defer os.Remove(tempFile.Name())\ndefer tempFile.Close()\n</code></pre>\n\n<p>In the case above the syntax is minimal, yet the order of defers is reverse to the logic to be executed.</p>\n\n<p>In the case below there are more lines, more \"syntax\", but the logic is in a more natural order:</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>defer func() {\n    tempFile.Close()\n    os.Remove(tempFile.Name())\n}()\n</code></pre>\n\n<p>Which one to use?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 8, "last_activity_date": 1442070751, "creation_date": 1442070751, "answer_id": 32540356, "question_id": 32540219, "link": "https://stackoverflow.com/questions/32540219/set-headers-for-request-using-http-client-and-http-transport/32540356#32540356", "title": "set headers for request using http.Client and http.Transport", "body": "<p>Create a request:</p>\n\n<pre><code> req, err := http.NewRequest(\"GET\", \"https://www.whatismyip.com/\", nil)\n if err != nil {\n  // handle error\n }\n</code></pre>\n\n<p>Set the headers:</p>\n\n<pre><code> req.Header.Set(\"name\", \"value\")\n</code></pre>\n\n<p>Run the request using <code>client</code> as configured in the question:</p>\n\n<pre><code> resp, err := client.Do(req)\n if err != nil {\n     // handle error\n }\n</code></pre>\n\n<p>Handle the response as shown in the question.</p>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4210, "favorite_count": 0, "accepted_answer_id": 32540356, "answer_count": 1, "score": 3, "last_activity_date": 1442070751, "creation_date": 1442069940, "last_edit_date": 1495542767, "question_id": 32540219, "link": "https://stackoverflow.com/questions/32540219/set-headers-for-request-using-http-client-and-http-transport", "title": "set headers for request using http.Client and http.Transport", "body": "<p>I have more than one ip to go to the internet. I am making request choosing interface. In this case how should I set headers?</p>\n\n<pre><code>tcpAddr := &amp;net.TCPAddr{\n    IP: addrs[3].(*net.IPNet).IP, // Choosing ip address number 3\n}\nd := net.Dialer{LocalAddr: tcpAddr}\nconn, err2 := d.Dial(\"tcp\", \"www.whatismyip.com:80\")\nif err2 != nil {\n    log.Fatal(err2)\n}\n\ndefer conn.Close()\n\ntransport := &amp;http.Transport{\n    Proxy:               http.ProxyFromEnvironment,\n    Dial:                (&amp;net.Dialer{LocalAddr: tcpAddr}).Dial,\n    TLSHandshakeTimeout: 10 * time.Second,\n}\n\nclient := &amp;http.Client{\n    Transport: transport,\n}\n\nresponse, err := client.Get(\"https://www.whatismyip.com/\")\n</code></pre>\n\n<p>Usually headers are set in this <a href=\"https://stackoverflow.com/questions/12864302/how-to-set-headers-in-http-get-request\">way</a>: </p>\n\n<pre><code>req.Header.Set(\"name\", \"value\")\n</code></pre>\n\n<p>But cannot figure out how to set them to my code.</p>\n\n<p>I guess they must be set somewhere in <code>http.Transport</code> or <code>http.Client</code>. But how exactly?</p>\n\n<p>My full code:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"github.com/PuerkitoBio/goquery\"\n    \"io/ioutil\"\n    \"log\"\n    \"net\"\n    \"net/http\"\n    \"os\"\n    \"time\"\n)\n\nfunc main() {\n    ief, err := net.InterfaceByName(\"eth0\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    addrs, err := ief.Addrs()\n    if err != nil {\n        log.Fatal(err)\n    }\n    tcpAddr := &amp;net.TCPAddr{\n        IP: addrs[3].(*net.IPNet).IP, // Choosing ip address number 3\n    }\n    d := net.Dialer{LocalAddr: tcpAddr}\n    conn, err2 := d.Dial(\"tcp\", \"www.whatismyip.com:80\")\n    if err2 != nil {\n        log.Fatal(err2)\n    }\n\n    defer conn.Close()\n\n    transport := &amp;http.Transport{\n        Proxy:               http.ProxyFromEnvironment,\n        Dial:                (&amp;net.Dialer{LocalAddr: tcpAddr}).Dial,\n        TLSHandshakeTimeout: 10 * time.Second,\n    }\n\n    client := &amp;http.Client{\n        Transport: transport,\n    }\n\n    response, err := client.Get(\"https://www.whatismyip.com/\")\n\n    if err != nil {\n        fmt.Printf(\"%s\", err)\n        os.Exit(1)\n    } else {\n        defer response.Body.Close()\n        contents, err := ioutil.ReadAll(response.Body)\n        if err != nil {\n            fmt.Printf(\"%s\", err)\n            os.Exit(1)\n        }\n        var contentsStr = string(contents)\n        fmt.Printf(\"%s\\n\", contentsStr)\n        var doc = DocByHtmlString(contentsStr)\n\n        doc.Find(\"div\").Each(func(i int, s *goquery.Selection) {\n            attr, exists := s.Attr(\"class\")\n            if exists {\n                if attr == \"ip\" {\n                    fmt.Println(s.Text())\n                }\n            }\n        })\n    }\n}\n\nfunc DocByHtmlString(html string) *goquery.Document {\n    doc, err := goquery.NewDocumentFromReader(bytes.NewBufferString(html))\n    if err != nil {\n        panic(err)\n    }\n    return doc\n}\n</code></pre>\n"}, {"tags": ["select", "go", "channel"], "answers": [{"comments": [{"owner": {"reputation": 328, "user_id": 1928896, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3ad63be0c09f16ea40d160b4177a551b?s=128&d=identicon&r=PG", "display_name": "user1928896", "link": "https://stackoverflow.com/users/1928896/user1928896"}, "edited": false, "score": 0, "creation_date": 1442065789, "post_id": 32538597, "comment_id": 52936298, "body": "Thanks for the clarification."}, {"owner": {"reputation": 11133, "user_id": 4275347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CdbsN.jpg?s=128&g=1", "display_name": "Michael Laszlo", "link": "https://stackoverflow.com/users/4275347/michael-laszlo"}, "reply_to_user": {"reputation": 328, "user_id": 1928896, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3ad63be0c09f16ea40d160b4177a551b?s=128&d=identicon&r=PG", "display_name": "user1928896", "link": "https://stackoverflow.com/users/1928896/user1928896"}, "edited": false, "score": 0, "creation_date": 1442065886, "post_id": 32538597, "comment_id": 52936340, "body": "Thanks for the upvote. I am a bit irked because I posted my answer first."}, {"owner": {"reputation": 328, "user_id": 1928896, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3ad63be0c09f16ea40d160b4177a551b?s=128&d=identicon&r=PG", "display_name": "user1928896", "link": "https://stackoverflow.com/users/1928896/user1928896"}, "edited": false, "score": 0, "creation_date": 1442066404, "post_id": 32538597, "comment_id": 52936495, "body": "I chose the other answer since it included the reason for the program exiting even before the go routines finishing their job."}, {"owner": {"reputation": 11133, "user_id": 4275347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CdbsN.jpg?s=128&g=1", "display_name": "Michael Laszlo", "link": "https://stackoverflow.com/users/4275347/michael-laszlo"}, "reply_to_user": {"reputation": 328, "user_id": 1928896, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3ad63be0c09f16ea40d160b4177a551b?s=128&d=identicon&r=PG", "display_name": "user1928896", "link": "https://stackoverflow.com/users/1928896/user1928896"}, "edited": false, "score": 0, "creation_date": 1442066732, "post_id": 32538597, "comment_id": 52936587, "body": "I thought I covered it here: &quot;In the original code, the <code>default</code> case is ready on both iterations of the loop because there is a delay before anything is sent on <code>c1</code> or <code>c2</code>.&quot;"}], "tags": [], "owner": {"reputation": 11133, "user_id": 4275347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CdbsN.jpg?s=128&g=1", "display_name": "Michael Laszlo", "link": "https://stackoverflow.com/users/4275347/michael-laszlo"}, "is_accepted": false, "score": 4, "last_activity_date": 1442059645, "creation_date": 1442059645, "answer_id": 32538597, "question_id": 32538438, "link": "https://stackoverflow.com/questions/32538438/how-does-channel-blocking-work-in-go/32538597#32538597", "title": "How does channel blocking work in Go?", "body": "<p>The <code>select</code> statement blocks until at least one case is ready. The Go language specification <a href=\"https://golang.org/ref/spec#Select_statements\" rel=\"nofollow\">reads, in part</a>:</p>\n\n<blockquote>\n  <p>If one or more of the communications can proceed, a single one that can proceed is chosen via a uniform pseudo-random selection. Otherwise, if there is a default case, that case is chosen. If there is no default case, the \"select\" statement blocks until at least one of the communications can proceed.</p>\n</blockquote>\n\n<p>In the original code, the <code>default</code> case is ready on both iterations of the loop because there is a delay before anything is sent on <code>c1</code> or <code>c2</code>.</p>\n\n<p>After you remove the <code>default</code> case, the <code>select</code> statement must wait for data to be available in <code>c1</code> or <code>c2</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 19346, "user_id": 2793118, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5da03d2e233e1a40a4f1923acfb9d433?s=128&d=identicon&r=PG", "display_name": "Filipe Gon&#231;alves", "link": "https://stackoverflow.com/users/2793118/filipe-gon%c3%a7alves"}, "is_accepted": true, "score": 24, "last_activity_date": 1442059984, "last_edit_date": 1442059984, "creation_date": 1442059682, "answer_id": 32538604, "question_id": 32538438, "link": "https://stackoverflow.com/questions/32538438/how-does-channel-blocking-work-in-go/32538604#32538604", "title": "How does channel blocking work in Go?", "body": "<p>This is related to how <code>select</code> statements work in Go.</p>\n\n<p>From <a href=\"https://golang.org/ref/spec#Select_statements\" rel=\"noreferrer\">the Go documentation on <code>select</code></a>:</p>\n\n<blockquote>\n  <p>If one or more of the communications can proceed, a single one that\n  can proceed is chosen via a uniform pseudo-random selection.\n  Otherwise, if there is a default case, that case is chosen. If there\n  is no default case, the \"select\" statement blocks until at least one\n  of the communications can proceed.</p>\n</blockquote>\n\n<p>So, without a default case, the code will block until some data is available in either of the channels. It implicitly waits for the other goroutines to wake up and write to their channel.</p>\n\n<p>When you add the default case, it is very likely that the <code>select</code> statement is reached before the other goroutines wake up from sleeping.</p>\n\n<p>So, since there is no data available (yet), and there is a default case, the default case is executed. This is done twice, and it takes less than 1 second. So the program ends up terminating before any of the go routines have a chance to wake up and write to the channel.</p>\n\n<p>Note that this is technically a race condition; there is absolutely no guarantee that the 2 iterations of the loop will run before any of the go routines wake up, so in theory it is possible to have a different output even with a default case, but in practice it is extremely unlikely.</p>\n"}, {"comments": [{"owner": {"reputation": 2276, "user_id": 4925121, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3TTcs.jpg?s=128&g=1", "display_name": "d219", "link": "https://stackoverflow.com/users/4925121/d219"}, "edited": false, "score": 2, "creation_date": 1523398838, "post_id": 49763261, "comment_id": 86542985, "body": "Links are useful but it&#39;s better if you can post the relevant code to as if the links die your answer becomes useless, thanks."}], "tags": [], "owner": {"reputation": 1, "user_id": 8309550, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--H0QD_6tBWs/AAAAAAAAAAI/AAAAAAAAABU/mSoJHYmJKNU/photo.jpg?sz=128", "display_name": "Neetish Pathak", "link": "https://stackoverflow.com/users/8309550/neetish-pathak"}, "is_accepted": false, "score": -2, "last_activity_date": 1523396478, "creation_date": 1523396478, "answer_id": 49763261, "question_id": 32538438, "link": "https://stackoverflow.com/questions/32538438/how-does-channel-blocking-work-in-go/49763261#49763261", "title": "How does channel blocking work in Go?", "body": "<p><a href=\"https://tour.golang.org/concurrency/5\" rel=\"nofollow noreferrer\">https://tour.golang.org/concurrency/5</a></p>\n\n<p><a href=\"https://tour.golang.org/concurrency/6\" rel=\"nofollow noreferrer\">https://tour.golang.org/concurrency/6</a></p>\n\n<p>See the links given above for example execution. The default case gets executed if no other case is ready. \nselect in golang blocks until one of the cases is ready. Therefore removing default made the execution of other cases possible otherwise it was the one that was ready before others </p>\n"}, {"comments": [{"owner": {"reputation": 3629, "user_id": 1744107, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/91748b7203b0ef849403e8099da4528f?s=128&d=identicon&r=PG", "display_name": "Rambatino", "link": "https://stackoverflow.com/users/1744107/rambatino"}, "edited": false, "score": 0, "creation_date": 1544436499, "post_id": 51257585, "comment_id": 94261480, "body": "This is very unhelpful"}], "tags": [], "owner": {"reputation": 890, "user_id": 1438934, "user_type": "registered", "accept_rate": 18, "profile_image": "https://i.stack.imgur.com/43agr.jpg?s=128&g=1", "display_name": "Anish Mittal", "link": "https://stackoverflow.com/users/1438934/anish-mittal"}, "is_accepted": false, "score": -3, "last_activity_date": 1531199158, "creation_date": 1531199158, "answer_id": 51257585, "question_id": 32538438, "link": "https://stackoverflow.com/questions/32538438/how-does-channel-blocking-work-in-go/51257585#51257585", "title": "How does channel blocking work in Go?", "body": "<pre><code>Explanation:\n\nc1 := make(chan string) // Creates a channel of type string. [Means only \nstrings can be sent/received on this channel]\n\ngo func() {\n        time.Sleep(time.Second * 1)\n        c1 &lt;- \"one\"\n    }()\n// func() is a goroutine [As go keyword is placed before, if no go keyword \nhere, then it is a simple function].\n\ntime.Sleep(time.Second * 1) // here this func() goroutine will sleep for a \nsecond before passing a value to the channel c1.\n\nc1 &lt;- \"one\"// value \"one\" is passed to this channel.\n\nselect statement: Here it waits for the goroutines to complete it's task. \nOnce a goroutine above finishes, it matches it's case and executes the \nstatements. \n</code></pre>\n"}], "owner": {"reputation": 328, "user_id": 1928896, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3ad63be0c09f16ea40d160b4177a551b?s=128&d=identicon&r=PG", "display_name": "user1928896", "link": "https://stackoverflow.com/users/1928896/user1928896"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13952, "favorite_count": 2, "accepted_answer_id": 32538604, "answer_count": 4, "score": 6, "last_activity_date": 1531199158, "creation_date": 1442058613, "last_edit_date": 1442060648, "question_id": 32538438, "link": "https://stackoverflow.com/questions/32538438/how-does-channel-blocking-work-in-go", "title": "How does channel blocking work in Go?", "body": "<p>I'm learning the Go language. Here is an example I've come across. Can someone please explain what is happening here?</p>\n\n<pre><code>package main\nimport \"time\"\nimport \"fmt\"\nfunc main() {\n    c1 := make(chan string)\n    c2 := make(chan string)\n    go func() {\n        time.Sleep(time.Second * 1)\n        c1 &lt;- \"one\"\n    }()\n    go func() {\n        time.Sleep(time.Second * 2)\n        c2 &lt;- \"two\"\n    }()\n    for i := 0; i &lt; 2; i++ {\n      select {\n        case msg1 := &lt;-c1:\n          fmt.Println(\"received\", msg1)\n        case msg2 := &lt;-c2:\n          fmt.Println(\"received\", msg2)\n        default:\n          fmt.Println(\"Default\")\n      }\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Default\nDefault\nProgram Exited\n</code></pre>\n\n<p>If I comment out the default section</p>\n\n<pre><code>//default:\n//    fmt.Println(\"Default\")\n</code></pre>\n\n<p>the output becomes:</p>\n\n<pre><code>received one\nreceived two\nProgram exited.\n</code></pre>\n\n<p>How does the presence of the <code>default</code> case change the way channel blocking works?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2359, "user_id": 405454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/IDzwW.png?s=128&g=1", "display_name": "mhutter", "link": "https://stackoverflow.com/users/405454/mhutter"}, "edited": false, "score": 2, "creation_date": 1442060881, "post_id": 32538104, "comment_id": 52934971, "body": "I think you have a misconception about IP addresses. You can&#39;t just convert IPv6 to IPv4 Addresses."}, {"owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "reply_to_user": {"reputation": 2359, "user_id": 405454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/IDzwW.png?s=128&g=1", "display_name": "mhutter", "link": "https://stackoverflow.com/users/405454/mhutter"}, "edited": false, "score": 0, "creation_date": 1442061401, "post_id": 32538104, "comment_id": 52935123, "body": "Yeah probably I am thinking in the wrong way."}, {"owner": {"reputation": 2359, "user_id": 405454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/IDzwW.png?s=128&g=1", "display_name": "mhutter", "link": "https://stackoverflow.com/users/405454/mhutter"}, "edited": false, "score": 2, "creation_date": 1442064287, "post_id": 32538104, "comment_id": 52935908, "body": "Listening only for IPv4 is a way, but I don&#39;t recommend it as it&#39;s not future-proof. By the way, what problem tries <code>FilterIpv4</code> to solve?"}, {"owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "reply_to_user": {"reputation": 2359, "user_id": 405454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/IDzwW.png?s=128&g=1", "display_name": "mhutter", "link": "https://stackoverflow.com/users/405454/mhutter"}, "edited": false, "score": 0, "creation_date": 1442064684, "post_id": 32538104, "comment_id": 52936008, "body": "It tries to check if the ip is a valid one, and also check if the client is behind a proxy. I wanted to get ipv4 to begin with because that is what I am used to from &quot;php days&quot;, but I don&#39;t know, maybe I should just stick to ipv6?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1442068244, "post_id": 32538104, "comment_id": 52937065, "body": "If a client connects with IPv6 it doesn&#39;t have an IPv4 address and vice versa. Neither is more or less valid, it just the network protocol used."}], "owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 727, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1442070636, "creation_date": 1442056099, "last_edit_date": 1442070636, "question_id": 32538104, "link": "https://stackoverflow.com/questions/32538104/how-can-i-fetch-the-client-ipv4-address-in-go", "title": "How can I fetch the client IPv4 address in Go?", "body": "<p>I am trying to write a function that returns the client IPv4 address.</p>\n\n<p>I fetch the string from <code>http.Request.RemoteAddr</code> and filter out the ip with <code>net.SplitHostPort</code>. This gives me ::1 because I am on localhost which I asume is supposed to be an IPv6 address?</p>\n\n<p>then I do <code>ip := net.ParseIP(s)</code> and then <code>ip = ip.To4()</code> to get the IPv4 address.</p>\n\n<p>I am on Windows and have this in my hosts file: (The rest is commented out.)</p>\n\n<pre><code>127.0.0.1 localhost localhost.com www.localhost.com *.localhost.com\n</code></pre>\n\n<p>Basically I expect to get 127.0.0.1, but I can't get it.</p>\n\n<p>This is the code:</p>\n\n<pre><code>func FilterIpv4(r *http.Request) (string, error) {\n    var s string\n    // if xff := r.Header.Get(\"X-Forwarded-For\"); xff != \"\" {\n    //  ip = xff\n    // }\n    s, _, err := net.SplitHostPort(r.RemoteAddr)\n    if err != nil {\n        return \"\", err\n    }\n    ip := net.ParseIP(s)\n    ip = ip.To4()\n    spew.Dump(ip.String()) // outputs \"&lt;nil&gt;\"\n    return \"\", nil\n\n}\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>I don't know if it is a good idea to do this but atleast I get the ipv4 addresses now. Maybe I should just stick to ipv6? I don't know about this. But replacing this code:</p>\n\n<pre><code>log.Fatal(http.ListenAndServe(\":\"+config.SrvPort, router))\n</code></pre>\n\n<p>With this:</p>\n\n<pre><code>ln, err := net.Listen(\"tcp4\", \":\"+config.SrvPort)\nif err != nil {\n    log.Fatal(err)\n}\nlog.Fatal(http.Serve(ln, router))\n</code></pre>\n\n<p>Made it possible for me to get the ipv4 address.</p>\n\n<p>Does someone know if this is a good idea in general? Or should I stick to ipv6 addresses?</p>\n\n<p>EDIT 2:</p>\n\n<p>I ended up with this function:</p>\n\n<pre><code>func FilterIP(r *http.Request) (string, error) {\n    var ip string\n    var err error\n    if xff := r.Header.Get(\"X-Forwarded-For\"); xff != \"\" {\n        ips := strings.Split(xff, \", \")\n        ip = ips[0]\n    } else {\n        ip, _, err = net.SplitHostPort(r.RemoteAddr)\n        if err != nil {\n            return \"\", err\n        }\n    }\n    if !IsIP(ip) {\n        return \"\", err\n    }\n    return ip, nil\n}\n</code></pre>\n\n<p>I will save both ipv6 and ipv4 addresses.</p>\n"}, {"tags": ["angularjs", "go"], "comments": [{"owner": {"reputation": 1363, "user_id": 2419919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a03b15fe26ab63725cd1bf235fbde154?s=128&d=identicon&r=PG", "display_name": "Moncef Hassein-bey", "link": "https://stackoverflow.com/users/2419919/moncef-hassein-bey"}, "edited": false, "score": 0, "creation_date": 1442025018, "post_id": 32534499, "comment_id": 52927021, "body": "You can see this answer : <a href=\"http://stackoverflow.com/a/14771362/2419919\">stackoverflow.com/a/14771362/2419919</a>"}, {"owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "reply_to_user": {"reputation": 1363, "user_id": 2419919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a03b15fe26ab63725cd1bf235fbde154?s=128&d=identicon&r=PG", "display_name": "Moncef Hassein-bey", "link": "https://stackoverflow.com/users/2419919/moncef-hassein-bey"}, "edited": false, "score": 0, "creation_date": 1442025349, "post_id": 32534499, "comment_id": 52927081, "body": "@MoncefHassein-bey I have already configured that and still no luck."}], "answers": [{"tags": [], "owner": {"reputation": 1945, "user_id": 1586394, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/1hfhi.jpg?s=128&g=1", "display_name": "maddygoround", "link": "https://stackoverflow.com/users/1586394/maddygoround"}, "is_accepted": false, "score": 0, "last_activity_date": 1442028319, "creation_date": 1442028319, "answer_id": 32534862, "question_id": 32534499, "link": "https://stackoverflow.com/questions/32534499/serving-angularjs-routes-go-lang/32534862#32534862", "title": "Serving angularjs routes go-lang", "body": "<p>You need to enable <code>html5mode</code> in angularjs </p>\n"}], "owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 505, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1442028319, "creation_date": 1442024293, "last_edit_date": 1442025563, "question_id": 32534499, "link": "https://stackoverflow.com/questions/32534499/serving-angularjs-routes-go-lang", "title": "Serving angularjs routes go-lang", "body": "<p>I'm using the following code to server an Angular app.</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/gorilla/mux\"\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n    r := mux.NewRouter()\n    r.PathPrefix(\"/portals/\").Handler(http.StripPrefix(\"/portals/\", http.FileServer(http.Dir(\"./portals/\"))))\n    r.PathPrefix(\"/dependencies/\").Handler(http.StripPrefix(\"/dependencies/\", http.FileServer(http.Dir(\"./dependencies/\"))))\n    r.HandleFunc(\"/registeruser\", UserRegistrationHandler)\n    r.HandleFunc(\"/deleteuser/{username}\", DeleteUserHandler)\n    http.Handle(\"/\", r)\n\n    log.Println(\"Listening...\")\n    http.ListenAndServe(\":8000\", r)\n}\n</code></pre>\n\n<p>If I navigate to <a href=\"http://localhost:8000/portals/\" rel=\"nofollow\">http://localhost:8000/portals/</a> it's able to render the site correctly with all the dependencies.But <a href=\"http://localhost:8000/portals\" rel=\"nofollow\">http://localhost:8000/portals</a> fails with 404 Not Found.</p>\n\n<p>Similarly if I navigate to <a href=\"http://localhost:8000/portals/#login\" rel=\"nofollow\">http://localhost:8000/portals/#login</a> it works as expected.But if I navigate to <a href=\"http://localhost:8000/portals/login\" rel=\"nofollow\">http://localhost:8000/portals/login</a> it gives 404.</p>\n\n<p>Another thing I noticed is <a href=\"http://localhost:8000/portals/login\" rel=\"nofollow\">http://localhost:8000/portals/login</a> url works if I navigate to it via a link inside the app(say login link). But if I  type the url in the browser and hit enter it gives a 404.</p>\n\n<p>What would be the missing part here?Am I handling the static content wrongly? </p>\n"}, {"tags": ["inheritance", "go"], "comments": [{"owner": {"reputation": 1665, "user_id": 4638952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03791badf72f6918a8910148dfc4401e?s=128&d=identicon&r=PG&f=1", "display_name": "SnoProblem", "link": "https://stackoverflow.com/users/4638952/snoproblem"}, "edited": false, "score": 1, "creation_date": 1442018966, "post_id": 32533992, "comment_id": 52926093, "body": "Is there a reason that &quot;parent&quot; and &quot;child&quot; are being implemented as separate, dependent packages?  They could easily be placed in the same package, with access to un-exported fields."}, {"owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "edited": false, "score": 5, "creation_date": 1442028242, "post_id": 32533992, "comment_id": 52927546, "body": "I&#39;m trying to write an answer, but it&#39;s a bit difficult. The problem largely comes down to trying to write Java code instead of Go code. Words such as &quot;Generic&quot;, &quot;parent&quot;, &quot;Bottom&quot;, or &quot;child&quot; are huge, huge code smells in Go because the type system is not equipped to handle those concepts. In Go, you generally want to go the route of having things in the same package, or else making things public and taking reasonable precautions against abuse. Code repetition is, for better or worse, far more common than base implementations in Go. This is the only sane way to use Go&#39;s type system."}], "answers": [{"tags": [], "owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "is_accepted": false, "score": 17, "last_activity_date": 1442030752, "last_edit_date": 1442030752, "creation_date": 1442030357, "answer_id": 32535022, "question_id": 32533992, "link": "https://stackoverflow.com/questions/32533992/golang-inheritance-using-setting-protected-values/32535022#32535022", "title": "Golang inheritance using setting protected values", "body": "<p>Your main problem is that you're a Java programmer. I don't mean that to be mean, or cast aspersions on Java programmers; I mean that the common style of thinking in Java is just completely disparate from the kind of design thinking you do in Go. Maybe not as much as trying to write Haskell code in C, but they're still entirely different mindsets. </p>\n\n<p>I've written quite a few drafts trying to \"fix\" your code, but the way you designed it is just fundamentally at odds with a language with no real notion inheritance. If you find yourself ever using the words \"base\" or \"parent\" in Go, and to some degree even the word \"generic\", you're probably about to have a nice fight with the type system. I think this is a phase most people who come to Go from OO languages have to fight through.</p>\n\n<p>I advise looking through the Go standard library and looking at how they lay out their packages. Generally, you'll find the following: One package will define one or several interfaces, and functions that operate on those interfaces. However, the number of actual, concrete implementations of the interface are either non-existent or very small. Then, in another package, they provide utility concrete implementations. Most strikingly, compared to your code, is that there are never, ever any <em>partial</em> implementations, except in the case that implementing one interface automatically partially implements another.</p>\n\n<p>There's nothing necessarily \"wrong\" with your <code>GenericBottom</code>, I've certainly made hidden pseudo-abstract classes myself, but in Go what you want is for them to be unexported as <code>genericBottom</code>, and in the same package as all concrete implementations. That or in an <a href=\"https://docs.google.com/document/d/1e8kOo3r51b2BWtTs_1uADIA5djfXhPT36s6eHVRIvaU/edit\">internal package</a> as of Go 1.4.</p>\n\n<p>You may now be saying, \"but what if I need to define other concrete implementations of my interfaces elsewhere?\" Well, you'll be duplicating code. This can be viewed as (and probably is) a weakness of Go's type system, but it's definitely idiomatic and common to repeat some code when implementing an interface in a different package. That's what things like <code>internal</code> were meant to alleviate somewhat.</p>\n\n<p>As another note, do not treat packages like classes. It's a problem I had too at first. It's relatively unremarkable for medium-large packages to have 10 or more files in them. As long as they're a single conceptual unit, that's what they're for. That's how \"protected\" functionality is achieved in Go (more like default/no modifier actually), by having types share a package. They can all access each others' unexported fields.</p>\n\n<p>The final piece of advice would be to not return interfaces from <code>NewX</code> methods. You should (almost) always return a pointer to the struct. Generally you want to construct a type, and pass it into another method as an interface, not receive an interface in the first place.</p>\n\n<p>I would recommend pretty much a complete rewrite. Challenge yourself; every time you think of words like \"child class\" stop and do something else. See what you can come up with. I think you'll find that while it's a bit hard at first, you'll ultimately get a lot more done by writing code in a way that's cooperative with the type system, even if it leads to some code stutter.</p>\n"}], "owner": {"reputation": 614, "user_id": 391831, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/9ba524baa16647432e421a0aba3c52d2?s=128&d=identicon&r=PG", "display_name": "rybit", "link": "https://stackoverflow.com/users/391831/rybit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2579, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1442030752, "creation_date": 1442018297, "question_id": 32533992, "link": "https://stackoverflow.com/questions/32533992/golang-inheritance-using-setting-protected-values", "title": "Golang inheritance using setting protected values", "body": "<p>\nI am trying to understand better how one can use the protected space in Go. I am coming form java which means that I can have values accessible via protected inheritance, as there is only composition here I wanted to make sure I was on the right path. </p>\n\n<p>The problem: I want to set a value in a child implementation, but not expose a setter on the generic interface. </p>\n\n<p>What is the best way to provide a setter to a 'sub-class' when there really isn't a hierarchy? </p>\n\n<p>This means I want:</p>\n\n<pre><code>type Bottom interface {\n    GetYouSome()\n\n    // rote things\n    SetSpeed(int)\n    DeliveryMechanism() chan string\n}\n</code></pre>\n\n<p>Note that there is no <code>SetDeliveryMechanism(chan string)</code> method. </p>\n\n<p>I thought I would start with a base that implements the rote things, meaning that actual implementations will provide the 'GetYouSome' method. I'd also like these to exist inside different packages. There will be dozens of implementations and I'd like to have the namespaces be sandboxed (i.e. they can both use the const <code>DefaultPort</code>). </p>\n\n<p>To illustrate the problem I have made a little project. It is laid out like this:</p>\n\n<pre><code>.\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 main.go\n    \u2514\u2500\u2500 parent\n        \u251c\u2500\u2500 child\n        \u2502\u00a0\u00a0 \u2514\u2500\u2500 child.go\n        \u2514\u2500\u2500 parent.go\n</code></pre>\n\n<p>Where in <code>child.go</code> we actually create a few types of <code>Bottom</code>, but in <code>parent.go</code> we actually define the boilerplate code (setters/getters). The problem is that I can't instantiate the channel anywhere!</p>\n\n<p>Ideally an implementation would look like this: </p>\n\n<pre><code>//------------- parent.go -------------\npackage parent\n\ntype Bottom interface {\n    GetYouSome()\n\n    // rote things\n    SetSpeed(int)\n    DeliveryMechanism() chan string\n}\n\n// Intended to implement the boring things\ntype GenericBottom struct {\n    speed        int\n    deliveryChan chan string\n}\n\nfunc (bot *GenericBottom) SetSpeed(speed int) {\n    bot.speed = speed\n}\n\nfunc (bot GenericBottom) DeliveryMechanism() chan string {\n    return bot.deliveryChan\n}\n\n//------------- child.go -------------\npackage child\n\nimport \"parent\"\n\nfunc New(speed int) parent.Bottom {\n    impl := new(Composite)\n    impl.name = \"simple\"\n    impl.SetSpeed(speed)\n\n    // illegal! not exported\n    // impl.deliveryChannel = make(chan string)\n    return impl\n}\n// intended so that we can seamlessly treat the Composite\n// as a Bottom\ntype Composite struct {\n    parent.GenericBottom\n    name string\n}\n\nfunc (a Composite) GetYouSome() {\n    fmt.Println(\"Inside the actual implementation\")\n}\n</code></pre>\n\n<p>There are two ways I can think to get around this. </p>\n\n<p>(1) create a child class that would wrap the <code>GenericBottom</code> class, passing through all the methods. That is le sad, and it also still has the problem that I can't access the <code>deliveryChannel</code> class directly. I would have to build a <code>new</code> constructor into the parent package, then explicitly set the instance in the child class. </p>\n\n<pre><code>//------------- parent.go -------------\nfunc NewGenericBottom() GenericBottom {\n    return GenericBottom{0, make(chan string)}\n}\n\n//------------- child.go -------------\nfunc New(speed int) parent.Bottom {\n    impl := new(ExplicitComposite)\n    impl.name = \"explicit\"\n\n    // now I can set the channel? Nope\n    // impl.gb = parent.GenericBottom{speed, make(chan string)}\n\n    impl.gb = parent.NewGenericBottom()\n    impl.SetSpeed(speed)\n    return impl\n}\n// this has to pass through each method\ntype ExplicitComposite struct {\n    gb   parent.GenericBottom\n    name string\n}\n\nfunc (e ExplicitComposite) GetYouSome() {\n    fmt.Println(\"Inside the explicit implementation\")\n}\n\nfunc (e ExplicitComposite) DeliveryMechanism() chan string {\n    return e.gb.DeliveryMechanism()\n}\n\nfunc (e *ExplicitComposite) SetSpeed(speed int) {\n    e.gb.SetSpeed(speed)\n}\n</code></pre>\n\n<p>OR! (2) I can add a setter method on the GenericBottom. But anyone using the GenericBottom can just cast to that an access it right? I wouldn't really be 'protected'. </p>\n\n<p>Like this: </p>\n\n<pre><code>//------------- parent.go -------------\n\nfunc (bot *GenericBottom) SetChannel(c chan string) {\n    bot.deliveryChan = c\n}\n\n//------------- child.go -------------\n\ntype CheatersBottom struct {\n    parent.GenericBottom\n    name string\n}\n\nfunc (a CheatersBottom) GetYouSome() {\n    fmt.Println(\"Inside the cheaters bottom\")\n}\n\nfunc NewCheatersBottom(speed int) parent.Bottom {\n    impl := new(CheatersBottom)\n    impl.SetChannel(make(chan string))\n    impl.SetSpeed(speed)\n    return impl\n}\n</code></pre>\n\n<p>What is the best way to provide a setter to a 'sub-class' when there really isn't a hierarchy? </p>\n"}, {"tags": ["asynchronous", "go", "buffer", "channel", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 4, "last_activity_date": 1442012178, "last_edit_date": 1442012178, "creation_date": 1442011752, "answer_id": 32533200, "question_id": 32533138, "link": "https://stackoverflow.com/questions/32533138/golang-why-does-increasing-the-size-of-a-buffered-channel-eliminate-output-from/32533200#32533200", "title": "Golang: Why does increasing the size of a buffered channel eliminate output from my goroutines?", "body": "<p>This has nothing directly to do with the size of the buffer. Adding the buffer is exposing a bug in where you're calling <code>waitGroup.Add(1)</code></p>\n\n<p>You have to add to the <code>WaitGroup</code> <em>before</em> you dispatch the goroutine, otherwise you may end up calling <code>Wait()</code> <em>before</em> the <code>waitGroup.Add(1)</code> executes.</p>\n\n<p><a href=\"http://play.golang.org/p/YaDhc6n8_B\" rel=\"nofollow\">http://play.golang.org/p/YaDhc6n8_B</a></p>\n\n<p>The reason it works in the first and not the second, is because the synchronous sends ensure that the gouroutines have executed at least that far.  In the second example, the for loop fills up the channel, closes it and calls Wait before anything else can happen.</p>\n"}], "owner": {"reputation": 25, "user_id": 4581492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f013dd6ad38eebd77acdd9bf3907449?s=128&d=identicon&r=PG&f=1", "display_name": "kris", "link": "https://stackoverflow.com/users/4581492/kris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1949, "favorite_count": 0, "accepted_answer_id": 32533200, "answer_count": 1, "score": 0, "last_activity_date": 1442012178, "creation_date": 1442011404, "question_id": 32533138, "link": "https://stackoverflow.com/questions/32533138/golang-why-does-increasing-the-size-of-a-buffered-channel-eliminate-output-from", "title": "Golang: Why does increasing the size of a buffered channel eliminate output from my goroutines?", "body": "<p>I am trying to understand why making the buffer size of a channel larger changes causes my code to run unexpectedly. If the buffer is smaller than my input (100 ints), the output is as expected, i.e., 7 goroutines each read a subset of the input and send output on another channel which prints it. If the buffer is the same size or larger than the input, I get no output and no error. Am I closing a channel at the wrong time? Do I have the wrong expectation about how buffers work? Or, something else?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nvar wg1, wg2 sync.WaitGroup\n\nfunc main() {\n    share := make(chan int, 10)\n    out := make(chan string)\n    go printChan(out)\n    for j:= 1; j&lt;=7; j++ {\n        go readInt(share, out, j)\n    }\n    for i:=1; i&lt;=100; i++ {\n        share &lt;- i\n    }\n    close(share)\n    wg1.Wait()\n    close(out)\n    wg2.Wait()\n}\nfunc readInt(in chan int, out chan string, id int) {\n    wg1.Add(1)\n    for n := range in {\n        out &lt;- fmt.Sprintf(\"goroutine:%d was sent %d\", id, n)\n    }\n    wg1.Done()\n}\nfunc printChan(out chan string){\n    wg2.Add(1)\n    for l := range out {\n        fmt.Println(l)\n    }\n    wg2.Done()\n}\n</code></pre>\n\n<p>To run this:\nSmall buffer, expected output. <a href=\"http://play.golang.org/p/4r7rTGypPO\" rel=\"nofollow\">http://play.golang.org/p/4r7rTGypPO</a>\nBig buffer, no output. <a href=\"http://play.golang.org/p/S-BDsw7Ctu\" rel=\"nofollow\">http://play.golang.org/p/S-BDsw7Ctu</a></p>\n"}, {"tags": ["parsing", "go", "code-generation", "abstract-syntax-tree"], "answers": [{"comments": [{"owner": {"reputation": 364, "user_id": 332313, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b780d855a41025813831a1c810a948b9?s=128&d=identicon&r=PG", "display_name": "Prashanth Ellina", "link": "https://stackoverflow.com/users/332313/prashanth-ellina"}, "edited": false, "score": 0, "creation_date": 1442015358, "post_id": 32533087, "comment_id": 52925369, "body": "Thank you. I&#39;m going to attempt an implementation based on the above."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 364, "user_id": 332313, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b780d855a41025813831a1c810a948b9?s=128&d=identicon&r=PG", "display_name": "Prashanth Ellina", "link": "https://stackoverflow.com/users/332313/prashanth-ellina"}, "edited": false, "score": 0, "creation_date": 1442017300, "post_id": 32533087, "comment_id": 52925808, "body": "They are different importers.  The <code>ast.Importer</code> is simple: Call the go/build import function to get a <code>*build.Package</code> and return <code>&amp;ast.Object{Kind: ast.Pkg, Name: p.Name}</code> where <code>p</code> is the <code>*build.Package</code>.  I would use go/types instead of go/ast. The problem described in the question is at the limit of what one can do with the go/ast package.  The code will probably be shorter if you use go/types instead of go/ast directly."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 5, "last_activity_date": 1442068637, "last_edit_date": 1442068637, "creation_date": 1442010993, "answer_id": 32533087, "question_id": 32532335, "link": "https://stackoverflow.com/questions/32532335/usage-of-go-parser-across-packages/32533087#32533087", "title": "Usage of go/parser across packages", "body": "<p>Call <a href=\"http://godoc.org/go/ast#NewPackage\" rel=\"nofollow\">ast.NewPackage</a> to resolve a package names.  You will need to supply an <a href=\"http://godoc.org/go/ast#Importer\" rel=\"nofollow\">importer</a> that returns an <a href=\"http://godoc.org/go/ast#Object\" rel=\"nofollow\">*ast.Object</a> for the given import path. If all you want to do is resolve the name to a path, the importer can simply return an <a href=\"http://godoc.org/go/ast#Object\" rel=\"nofollow\">*ast.Object</a> with the <a href=\"http://godoc.org/go/ast#Object.Kind\" rel=\"nofollow\">Kind</a> set to <a href=\"http://godoc.org/go/ast#Pkg\" rel=\"nofollow\">ast.Pkg</a> and the <a href=\"http://godoc.org/go/ast#Object.Name\" rel=\"nofollow\">Name</a> set to name of the package. Most of the heavy lifting in the importer can be done with the <a href=\"http://godoc.org/go/build\" rel=\"nofollow\">go/build</a> package.  If want to resolve do the AST for the target package, you will need to parse the package and return the ast.Object for the package. To prevent loading the same package multiple times, use the map argument to the importer as a cache of previously loaded packages.</p>\n\n<p>Here's some untested code for finding the resolved package path from the <code>*ast.SelectorExpr</code> <code>se</code>:</p>\n\n<pre><code>    if x, _ := se.X.(*ast.Ident); x != nil {\n        if obj := x.Obj; obj != nil &amp;&amp; obj.Kind == ast.Pkg {\n            if spec, _ := obj.Decl.(*ast.ImportSpec); spec != nil {\n                if path, err := strconv.Unquote(spec.Path.Value); err == nil {\n                    // path is resolved path for selector expression se.\n                }\n            }\n         }\n     }\n</code></pre>\n\n<p>The <a href=\"http://godoc.org/go/types\" rel=\"nofollow\">go/types</a> package can also be used to get this information and more.  I recommend using go/types instead of using go/ast directly.</p>\n"}], "owner": {"reputation": 364, "user_id": 332313, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b780d855a41025813831a1c810a948b9?s=128&d=identicon&r=PG", "display_name": "Prashanth Ellina", "link": "https://stackoverflow.com/users/332313/prashanth-ellina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 852, "favorite_count": 1, "accepted_answer_id": 32533087, "answer_count": 1, "score": 2, "last_activity_date": 1442068637, "creation_date": 1442006659, "question_id": 32532335, "link": "https://stackoverflow.com/questions/32532335/usage-of-go-parser-across-packages", "title": "Usage of go/parser across packages", "body": "<p>I have used <a href=\"https://golang.org/pkg/go/parser/\" rel=\"nofollow\">go/parser</a> to parse a golang file and examine it's AST. I have a specific problem for which I want to use go/parser but I hit a roadblock.</p>\n\n<p>Consider that the following files are present in GOPATH/src</p>\n\n<pre><code>$GOPATH/src/\n    example.go\n    example_package/\n        example_package.go\n</code></pre>\n\n<p>The following are the contents of the files above</p>\n\n<p><strong>example.go</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"example_package\"\n)\n\ntype MyObject struct {\n    base *example_package.BaseObject\n}\n\nfunc DoMyThing(arg *example_package.FirstArg) {\n    arg.Write(10)\n}\n\nfunc DoMyAnotherThing() {\n}\n\nfunc main() {\n    example_package.GetItStarted(&amp;MyObject{})\n}\n</code></pre>\n\n<p><strong>example_package.go</strong></p>\n\n<pre><code>package example_package\n\nfunc GetItStarted(obj interface{}) {\n}\n\ntype FirstArg interface {\n    Read() int\n    Write(x int)\n}\n\ntype BaseObject struct {\n}\n\nfunc (p *BaseObject) DoSomething(arg *FirstArg, a int) {\n    arg.Write(arg.Read() + a)\n}\n</code></pre>\n\n<p>My intention is to write a go program called <code>gen_structure</code> that is used like this</p>\n\n<pre><code>$ gen_structure example.go\n</code></pre>\n\n<p>The output would be</p>\n\n<pre><code>&gt; MyObject\n- DoMyThing(arg)\n- base\n    - DoSomething(arg, a)\n</code></pre>\n\n<p><strong>What did gen_structure do?</strong></p>\n\n<p>It parses example.go and</p>\n\n<ol>\n<li>Extracts \"MyObject\" from the line <code>example_package.GetItStarted(&amp;MyObject{})</code> from inside the main() function.</li>\n<li>Looks for methods on <code>MyObject</code> that have atleast one argument with the first one being of type <code>*package_example.FirstArg</code>. It finds <code>DoMyThing</code> (and ignored <code>DoMyAnotherThing</code>).</li>\n<li>Identifies the member <code>base</code> and peeks inside (by opening the <code>example_package</code>).</li>\n<li>Applies the same process to find methods as above and finds <code>DoSomething</code></li>\n<li>Using the collected information, it prints the required output.</li>\n</ol>\n\n<p>I understand I can parse a single file or a bunch of files in the same directory using the functionality within <code>go/parser</code>. However, I am unable to figure out how to resolve symbols across packages (In this case, <code>example_package</code>).</p>\n\n<p>How do I do this?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 5298, "user_id": 12606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1086eadc88de1e47fbffca9a73fd82?s=128&d=identicon&r=PG", "display_name": "Stuart Carnie", "link": "https://stackoverflow.com/users/12606/stuart-carnie"}, "is_accepted": true, "score": 3, "last_activity_date": 1442004659, "creation_date": 1442004659, "answer_id": 32531935, "question_id": 32531854, "link": "https://stackoverflow.com/questions/32531854/how-to-initialize-nested-structure-array-in-golang/32531935#32531935", "title": "How to initialize nested structure array in golang?", "body": "<p>You can initialize it <a href=\"http://play.golang.org/p/yRiTVshL13\" rel=\"nofollow\">as such</a></p>\n\n<pre><code>cfg := Configuration{\n    Val: \"foo\",\n    Proxy: []struct {\n        Address string\n        Port    string\n    }{\n        {Address: \"a\", Port: \"093\"},\n    },\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 3, "last_activity_date": 1506453098, "last_edit_date": 1506453098, "creation_date": 1442004665, "answer_id": 32531937, "question_id": 32531854, "link": "https://stackoverflow.com/questions/32531854/how-to-initialize-nested-structure-array-in-golang/32531937#32531937", "title": "How to initialize nested structure array in golang?", "body": "<p>Yes, but since you have to declare the type somewhere, it gets (subjectively) ugly:</p>\n\n<pre><code>c := Configuration{\n    Val: \"value\",\n    Proxy: []struct {\n        Address string\n        Port    string\n    }{\n        {\"addr1\", \"2\"},\n        {\"addr2\", \"4\"},\n    },\n}\n</code></pre>\n"}], "owner": {"reputation": 102535, "user_id": 20128, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/4b62eef3ad218a5d3cbdd1077660ca8b?s=128&d=identicon&r=PG", "display_name": "serg", "link": "https://stackoverflow.com/users/20128/serg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2793, "favorite_count": 0, "closed_date": 1442009973, "accepted_answer_id": 32531935, "answer_count": 2, "score": 2, "last_activity_date": 1506453098, "creation_date": 1442004242, "last_edit_date": 1495541033, "question_id": 32531854, "link": "https://stackoverflow.com/questions/32531854/how-to-initialize-nested-structure-array-in-golang", "closed_reason": "Duplicate", "title": "How to initialize nested structure array in golang?", "body": "<p>Similar to <a href=\"https://stackoverflow.com/questions/24809235/initialize-a-nested-struct-in-golang?rq=1\">this question</a>, I'm try to initialize the following structure with some default values:</p>\n\n<pre><code>type Configuration struct {\n    Val   string\n    Proxy []struct {\n        Address string\n        Port    string\n    }\n}\n</code></pre>\n\n<p>Is there a way to do this without declaring <code>Proxy</code> separately?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6632, "user_id": 210547, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70ebc83b42f07ad8e3363085e722500e?s=128&d=identicon&r=PG", "display_name": "MDrollette", "link": "https://stackoverflow.com/users/210547/mdrollette"}, "edited": false, "score": 1, "creation_date": 1442190293, "post_id": 32530952, "comment_id": 52967661, "body": "Why would people downvote this question? It was a legitimate question and received a helpful answer...."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1442005217, "last_edit_date": 1442005217, "creation_date": 1442000919, "answer_id": 32531122, "question_id": 32530952, "link": "https://stackoverflow.com/questions/32530952/should-i-be-able-to-type-assert-a-slice-of-string-maps/32531122#32531122", "title": "Should I be able to type assert a slice of string maps?", "body": "<p>This is covered briefly <a href=\"http://golang.org/doc/faq#convert_slice_of_interface\" rel=\"nofollow\">here in the FAQ</a>.</p>\n\n<p>The types <code>[]interface{}</code> and <code>[]map[string]string</code> have two different representation in memory. There is no direct way to convert between them. </p>\n\n<p>Also, even when a conversion is allowed, you should note that you can't successfully assert to a different basic type at all (<a href=\"http://play.golang.org/p/zMp1qebIZZ\" rel=\"nofollow\">http://play.golang.org/p/zMp1qebIZZ</a>). You can only assert to the original type, or another type of interface,</p>\n\n<pre><code>// panics\nvar i interface{} = int32(42)\n_ = i.(int64)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1442001404, "post_id": 32531193, "comment_id": 52920525, "body": "yes, that&#39;s why he commented out the obvious assertion that he knows works"}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 1, "last_activity_date": 1442001240, "creation_date": 1442001240, "answer_id": 32531193, "question_id": 32530952, "link": "https://stackoverflow.com/questions/32530952/should-i-be-able-to-type-assert-a-slice-of-string-maps/32531193#32531193", "title": "Should I be able to type assert a slice of string maps?", "body": "<p>The conversion referred to doesn't work as described in Jim's answer. However, if you actually have the type you claim, and the interface you state it implements is just <code>interface{}</code> then the type assertion works fine. I don't want to speculate on the details of why the other doesn't work but I believe it's because you would have to unbox it in two phases as the <code>map[string]string</code>'s inside the slice are actually being viewed as some <code>interface{}</code> themselves. Here's an example;</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var value interface{}\n\n    value = []map[string]string{{\"address\": string(\"this is interface literal\")}}\n    // value = []map[string]string{{\"address\": \"this is map literal\"}}\n\n    AssertIt(value)\n\n\n}\n\nfunc AssertIt(value interface{}) {\n    if str, ok := value.([]map[string]string); ok &amp;&amp; len(str) &gt; 0 {\n        fmt.Println(str[0][\"address\"])\n    } else {\n        fmt.Println(\"nope\")\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/hJfoh_havC\" rel=\"nofollow\">https://play.golang.org/p/hJfoh_havC</a></p>\n"}], "owner": {"reputation": 6632, "user_id": 210547, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70ebc83b42f07ad8e3363085e722500e?s=128&d=identicon&r=PG", "display_name": "MDrollette", "link": "https://stackoverflow.com/users/210547/mdrollette"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1363, "favorite_count": 0, "accepted_answer_id": 32531122, "answer_count": 2, "score": -1, "last_activity_date": 1442005217, "creation_date": 1442000229, "question_id": 32530952, "link": "https://stackoverflow.com/questions/32530952/should-i-be-able-to-type-assert-a-slice-of-string-maps", "title": "Should I be able to type assert a slice of string maps?", "body": "<p>I am receiving a message using the <a href=\"http://github.com/bitly/go-nsq\" rel=\"nofollow\">Go NSQ library</a> where a field is a slice of <code>map[string]string</code>'s. I feel like I should be able to type assert this field as <code>value.([]map[string]string)</code> but it's failing and I can't tell if this is expected or not.</p>\n\n<p>This snippet replicates the behavior <a href=\"https://play.golang.org/p/qcZM880Nal\" rel=\"nofollow\">https://play.golang.org/p/qcZM880Nal</a></p>\n\n<p>Why does this type assertion fail?</p>\n"}, {"tags": ["go", "gorilla"], "answers": [{"tags": [], "owner": {"reputation": 99, "user_id": 524060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c89b01fb690d62919432f902117b7fcb?s=128&d=identicon&r=PG", "display_name": "abiosoft", "link": "https://stackoverflow.com/users/524060/abiosoft"}, "is_accepted": false, "score": 0, "last_activity_date": 1442404044, "creation_date": 1442404044, "answer_id": 32607745, "question_id": 32528754, "link": "https://stackoverflow.com/questions/32528754/how-to-get-full-request-path-when-using-gorilla-mux-sub-router/32607745#32607745", "title": "How to get full request path when using gorilla mux sub router?", "body": "<p>Try <a href=\"http://godoc.org/net/http#Request.Referer\" rel=\"nofollow\"><code>req.Referer()</code></a></p>\n\n<p>It is retrieved from an header value and you are not guaranteed that it is not spoofed.</p>\n"}], "owner": {"reputation": 3964, "user_id": 5288071, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/hdcFK.png?s=128&g=1", "display_name": "zola", "link": "https://stackoverflow.com/users/5288071/zola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 784, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1442404044, "creation_date": 1441991481, "last_edit_date": 1441993886, "question_id": 32528754, "link": "https://stackoverflow.com/questions/32528754/how-to-get-full-request-path-when-using-gorilla-mux-sub-router", "title": "How to get full request path when using gorilla mux sub router?", "body": "<p>I am using the gorilla toolkit mux to route requests, i have a couple of subroutes using path prefix, problem is i want to get the full request path but req.URL.path only has the part of the url after the path prefix so how do i get a path including the path prefix? thanks in advance</p>\n"}, {"tags": ["xml", "go", "unmarshalling"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1441990069, "post_id": 32528184, "comment_id": 52914817, "body": "&quot;anyone an idea how to work around this?&quot; - Have a sensible XML schema. In your snippet there are two &#39;values&#39; nodes and they don&#39;t share a common schema... How else should it process it? That is a values node, it does not have a key and an array of type <code>Value</code>. It just has a value. Is that even valid?"}], "answers": [{"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 0, "last_activity_date": 1441993728, "creation_date": 1441993728, "answer_id": 32529351, "question_id": 32528184, "link": "https://stackoverflow.com/questions/32528184/go-xml-unmarshal-nested-key-value-pairs/32529351#32529351", "title": "Go: XML Unmarshal nested key-value pairs", "body": "<p>Two things to look at:</p>\n\n<ul>\n<li><p>A <code>struct</code> type representing the contents of an XML element might have a special field \"XMLName\" of type <code>xml.Name</code>.</p>\n\n<p>This can be used to have types named differently from XML elements.</p></li>\n<li><p>The name of an XML element specified for a field of your <code>struct</code> type via the \"xml\" tag might specify <em>nesting</em> of elements using the <code>&gt;</code> notation, like in</p>\n\n<pre><code>Foo string `xml:\"a&gt;b&gt;c\"`\n</code></pre>\n\n<p>This can be used to skip unneeded intermediate (enclosing) elements and directly extract their child elements of interest.</p></li>\n</ul>\n\n<p>All this stuff is explained in the <a href=\"http://golang.org/pkg/encoding/xml/#Unmarshal\" rel=\"nofollow\">package's doc for the <code>Unmarshal()</code> func</a>.</p>\n\n<p>Supposedly, these capabilities should allow you to deal with your problem.</p>\n\n<p>If you will find that your case is truly pathological and is hard to deal with plain unmarshaling, you might try to approach it <a href=\"http://godoc.org/gopkg.in/xmlpath.v2\" rel=\"nofollow\">using XPath</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 5326146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38ce1bdf0c0625dca4e2600f01194110?s=128&d=identicon&r=PG&f=1", "display_name": "John Dadson", "link": "https://stackoverflow.com/users/5326146/john-dadson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1086, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1441993728, "creation_date": 1441989280, "question_id": 32528184, "link": "https://stackoverflow.com/questions/32528184/go-xml-unmarshal-nested-key-value-pairs", "title": "Go: XML Unmarshal nested key-value pairs", "body": "<p>I started a project to process XML input, I ran into a problem with the unmarshal method. I'm trying to umarshal the XML below into a struct. The are multiple 'values' tag, which is fine, but within the 'values' tag there can be either one 'value' tag with a value. Or there are multiple 'value' tags with a 'key'&amp;'value' tag inside. I'm trying to capture this in a Go struct, but no luck so far..</p>\n\n<pre><code>&lt;lines&gt;\n&lt;values&gt;\n    &lt;key&gt;Key_1&lt;/key&gt;\n    &lt;value&gt;Value_1&lt;/value&gt;\n&lt;/values&gt;\n&lt;values&gt;\n    &lt;key&gt;Key_2&lt;/key&gt;\n    &lt;value&gt;\n        &lt;key&gt;NestedKey_1&lt;/key&gt;\n        &lt;value&gt;NestedValue_1&lt;/value&gt;\n    &lt;/value&gt;\n    &lt;value&gt;\n        &lt;key&gt;NestedKey_2&lt;/key&gt;\n        &lt;value&gt;NestedValue_2&lt;/value&gt;\n    &lt;/value&gt;\n&lt;/values&gt;\n</code></pre>\n\n<p></p>\n\n<p>Go struct:</p>\n\n<pre><code>type Value struct {\n    Key string `xml:\"key\"`\n    Value string `xml:\"value\"`\n}\n\ntype Values struct {\n    Key string `xml:\"key\"`\n    Value []Value `xml:\"value\"`\n}\n\ntype Lines struct {\n    Values []Values `xml:\"values\"`\n}\n</code></pre>\n\n<p>When I print the unmarshal output, I do see Key_1 and Key_2 and the nested key-value pairs, but I don't see Value_1 in the output.  Which is obvious since it's a string and not an array, anyone an idea how to work around this?</p>\n\n<p>Playground: <a href=\"http://play.golang.org/p/I4U0lhPt5U\" rel=\"nofollow\">http://play.golang.org/p/I4U0lhPt5U</a></p>\n"}, {"tags": ["go", "go-html-template"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 5, "last_activity_date": 1442011983, "last_edit_date": 1442011983, "creation_date": 1441987520, "answer_id": 32527670, "question_id": 32527241, "link": "https://stackoverflow.com/questions/32527241/how-to-pass-multiple-objects-to-go-html-template/32527670#32527670", "title": "How to pass multiple objects to Go html template", "body": "<p>Define an anonymous struct with fields for people count and consultations and pass the struct to the template Execute method:</p>\n\n<pre><code>var data = struct {\n    PeopleCounts  []PeopleCount\n    Consultations []Consultation\n}{\n    PeopleCounts:  p,\n    Consultations: c,\n}\nerr := t.Execute(w, &amp;data)\nif err != nil {\n    // handle error\n}\n</code></pre>\n\n<p>Use these fields in the template:</p>\n\n<pre><code>{{range .PeopleCounts}}{{.Name}}\n{{end}}\n{{range .Consultations}}{{.Name}}\n{{end}}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/lHXK0KhP6H\" rel=\"nofollow\">Playground example</a></p>\n\n<p>You can declare a named type for the template data. The advantage of the anonymous type declaration is that knowledge of the template data is localized to the function that invokes the template.</p>\n\n<p>You can also use a map instead of a type:</p>\n\n<pre><code>err := t.Execute(w, map[string]interface{}{\"PeopleCounts\": p, \"Consultations\": c})\nif err != nil {\n    // handle error\n}\n</code></pre>\n\n<p>The disadvantage of using a map is that a typo in the template may not result in an error. For example, ``{{range .PopleConts}}{{end}}` silent does nothing.</p>\n\n<p>The code above assumes that PeopleCount and Consultation are struct types and not slices of anonymous struct types:</p>\n\n<pre><code>type PeopleCount struct {\n  Name  string\n  Count int\n}\n\ntype Consultation struct {\n  Name          string\n  Opd_count     int\n  Opinion_count int\n  Req_count     int\n}\n</code></pre>\n\n<p>It's usually more convenient to give the element a named type than to give the slice a named type.</p>\n"}, {"tags": [], "owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "is_accepted": false, "score": 1, "last_activity_date": 1442009601, "creation_date": 1442009601, "answer_id": 32532874, "question_id": 32527241, "link": "https://stackoverflow.com/questions/32527241/how-to-pass-multiple-objects-to-go-html-template/32532874#32532874", "title": "How to pass multiple objects to Go html template", "body": "<p>If you prefer, define an unexported struct with fields for people count and consultations and pass the struct to the template Execute method:</p>\n\n<pre><code>type viewModel struct {\n    PeopleCounts  []PeopleCount\n    Consultations []Consultation\n}\n\n// ...\n\nvar data = viewModel{\n    PeopleCounts:  p,\n    Consultations: c,\n}\nerr := t.Execute(w, &amp;data)\nif err != nil {\n    // handle error\n}\n</code></pre>\n\n<p>This approach is broadly similar to @Bravada's answer. It's merely a matter of personal taste whether to use a view-model type explicitly or anonymously.</p>\n"}], "owner": {"reputation": 232, "user_id": 4999035, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9d76a1cd7adf79d16508210a751d04ee?s=128&d=identicon&r=PG&f=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/4999035/priyanka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "accepted_answer_id": 32527670, "answer_count": 2, "score": 3, "last_activity_date": 1442011983, "creation_date": 1441986058, "question_id": 32527241, "link": "https://stackoverflow.com/questions/32527241/how-to-pass-multiple-objects-to-go-html-template", "title": "How to pass multiple objects to Go html template", "body": "<p>Here are my array of objects,</p>\n\n<pre><code>type PeopleCount []struct{\n   Name  string\n   Count int\n}\n\ntype Consultation []struct{\n   Name          string\n   Opd_count     int\n   Opinion_count int\n   Req_count     int\n}\n</code></pre>\n\n<p>How should I pass both the objects to html template and arrange them in table? </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 5, "creation_date": 1441985120, "post_id": 32526935, "comment_id": 52911845, "body": "The answer to this question depends on your actual problem and your actual constraints."}, {"owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1441986729, "post_id": 32526935, "comment_id": 52912862, "body": "I just wondered if there could be a congestion/race issue. For example the program getting stuck  / deadlock for some reasons."}], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 0, "last_activity_date": 1442002011, "creation_date": 1442002011, "answer_id": 32531357, "question_id": 32526935, "link": "https://stackoverflow.com/questions/32526935/should-i-use-sync-or-blocking-channels/32531357#32531357", "title": "Should I use sync or blocking channels?", "body": "<p>This implementation isn't inherently worse or better and I've written code of this style in favor of using a <code>WaitGroup</code> with success. I've also implemented the same functionality with <code>WaitGroup</code> and had roughly the same results. As mentioned in the comments which is better is situational, and likely subjective in many cases (the difference will be in maintainability or readability rather than performance).</p>\n\n<p>Personally, I really like this style for a situation where I'm spinning off one worker per item in a collection. I was already encountering a lot of pains with shutting down cleanly (signaling on an abort or close channel which had to be made available to the worker methods one way or another) so I thought it was very convenient to take that communication loop one step further and enclose all the work in a channel select. In order to have a working abort you kind of have to anyway.</p>\n"}, {"tags": [], "owner": {"reputation": 929, "user_id": 8109026, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jomoj.jpg?s=128&g=1", "display_name": "Raed Shomali", "link": "https://stackoverflow.com/users/8109026/raed-shomali"}, "is_accepted": false, "score": 0, "last_activity_date": 1496883665, "creation_date": 1496883665, "answer_id": 44425040, "question_id": 32526935, "link": "https://stackoverflow.com/questions/32526935/should-i-use-sync-or-blocking-channels/44425040#44425040", "title": "Should I use sync or blocking channels?", "body": "<p>Channels and <code>WaitGroup</code>s are both available for you to use as appropriate. For a given problem, your solution could be solved using channels or <code>WaitGroup</code> or even a combination of both.</p>\n\n<p>From what I understand, channels are more appropriate when your goroutines need to communicate with each other (as in they are not independent). <code>WaitGroup</code> is usually used when your goroutines are independent of each other.</p>\n\n<p>Personally, I like <code>WaitGroup</code> because it is more readable and simpler to use. However, just like channels, I do not like that we need to pass the reference to the goroutine because that would mean that the concurrency logic would be mixed with your business logic.</p>\n\n<p>So I came up with this generic function to solve this problem for me:</p>\n\n<pre><code>// Parallelize parallelizes the function calls\nfunc Parallelize(functions ...func()) {\n    var waitGroup sync.WaitGroup\n    waitGroup.Add(len(functions))\n\n    defer waitGroup.Wait()\n\n    for _, function := range functions {\n        go func(copy func()) {\n            defer waitGroup.Done()\n            copy()\n        }(function)\n    }\n}\n</code></pre>\n\n<p>Here is an example:</p>\n\n<pre><code>func1 := func() {\n        for char := 'a'; char &lt; 'a' + 3; char++ {\n            fmt.Printf(\"%c \", char)\n        }\n}\n\nfunc2 := func() {\n        for number := 1; number &lt; 4; number++ {\n            fmt.Printf(\"%d \", number)\n        }\n}\n\nParallelize(func1, func2)  // a 1 b 2 c 3\n</code></pre>\n\n<p>If you would like to use it, you can find it here <a href=\"https://github.com/shomali11/util\" rel=\"nofollow noreferrer\">https://github.com/shomali11/util</a></p>\n"}], "owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 32531357, "answer_count": 2, "score": -1, "last_activity_date": 1496883665, "creation_date": 1441985035, "last_edit_date": 1441986520, "question_id": 32526935, "link": "https://stackoverflow.com/questions/32526935/should-i-use-sync-or-blocking-channels", "title": "Should I use sync or blocking channels?", "body": "<p>I have several go routines and I use <strong>unbuffered channels</strong> as sync mechanism. </p>\n\n<p>I'm wondering if there is anything wrong in this(e.g. compared with a WaitGroup implementation). A known <strong>\"drawback\"</strong> that I'm aware of is that two go routines may stay blocked until the 3rd(last) one completes because the channel is not buffered but I don't know the internals/what this really means.</p>\n\n<pre><code>func main() {\n    chan1, chan2, chan3 := make(chan bool), make(chan bool), make(chan bool)\n    go fn(chan1)\n    go fn(chan2)\n    go fn(chan3)\n    res1, res2, res3 := &lt;-chan1, &lt;-chan2, &lt;-chan3\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 2, "creation_date": 1441984730, "post_id": 32526729, "comment_id": 52911603, "body": "Does it print any error messages before the segfault? Do you always call <code>sql.Init</code> before <code>user.ByUnique</code>? Are there any other functions besides <code>sql.Init</code> that modify <code>sql.DB</code>?"}, {"owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "edited": false, "score": 0, "creation_date": 1441984963, "post_id": 32526729, "comment_id": 52911738, "body": "This is so embarrassing. I had sql.Init() below the code I run in main.. I sat here for 45 minutes going through everything else. Thanks anyways! And I still love Go."}, {"owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "edited": false, "score": 0, "creation_date": 1441985109, "post_id": 32526729, "comment_id": 52911836, "body": "Bravada Zadada, that sql comes from my own package, which wraps the sqlx library, I made my own package so I can include it in my other packages and use the same *sqlx.DB pool, without ever closing it."}, {"owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "edited": false, "score": 0, "creation_date": 1441985197, "post_id": 32526729, "comment_id": 52911898, "body": "Thank you Ainar-G. That was the problem!"}], "owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1796, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1441984381, "creation_date": 1441984381, "question_id": 32526729, "link": "https://stackoverflow.com/questions/32526729/panic-runtime-error-invalid-memory-address-or-nil-pointer-dereference", "title": "panic: runtime error: invalid memory address or nil pointer dereference", "body": "<p>I am using the sqlx library to fetch a user from the database and this worked before but for some reason it does not work now.</p>\n\n<p>I get this error:</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xc0000005 code=0x0 addr=0x0 pc=0x61d093]\n\ngoroutine 1 [running]:\ngithub.com/jmoiron/sqlx.(*DB).QueryRowx(0x0, 0xc08200e7d0, 0x4c, 0xc082097df0, 0x1, 0x1, 0x4c)\n        D:/Go/src/github.com/jmoiron/sqlx/sqlx.go:335 +0x23\nmgtow.co/user.ByUnique(0x7f77c0, 0x5, 0x83d030, 0x11, 0x411ddd, 0x0, 0x0)\n        D:/Go/src/mgtow.co/user/user_crud.go:21 +0x26b\nmain.main()\n        D:/Go/src/mgtow.co/main/main.go:102 +0x66\n</code></pre>\n\n<p>I run this in the main() function to test the code:</p>\n\n<pre><code>_, err := user.ByUnique(\"email\", \"myemail@gmail.com\")\nif err != nil {\n    log.Println(err)\n}\n</code></pre>\n\n<p>in the user package I have that function:</p>\n\n<pre><code>func ByUnique(column, value string) (*User, error) {\n\n    query := fmt.Sprintf(`\n        SELECT *\n        FROM user\n        WHERE\n            %s = ? AND\n            deleted = 0\n        LIMIT 1;\n    `, column)\n\n    user := &amp;User{}\n    err := sql.DB.QueryRowx(query, value).StructScan(user)\n    if err != nil {\n        return nil, err\n    }\n    return user, nil\n}\n</code></pre>\n\n<p>In the sql package there is a pointer to the sqlx.DB variable and an Init() function I run in main:</p>\n\n<pre><code>var DB *sqlx.DB\n\nvar ErrNoRows = sql.ErrNoRows\n\n    func Init() {\n\n        dsn := fmt.Sprintf(\"%s:%s@%s(%s)/%s?charset=utf8\",\n            config.DbUser, config.DbPass, config.DbProtocol, config.DbAddress, config.DbName)\n\n        var err error\n        // DB, err = sql.Open(\"mysql\", dsn)\n        DB, err = sqlx.Open(\"mysql\", dsn)\n        if err != nil {\n            log.Fatal(err)\n        }\n\n        if err = DB.Ping(); err != nil {\n            log.Fatal(err)\n        }\n    }\n</code></pre>\n\n<p>What could be the problem?</p>\n"}, {"tags": ["ssl", "go", "https", "handshake"], "comments": [{"owner": {"reputation": 41, "user_id": 5325331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69af802fca161001ffe24b6da65e8411?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolay", "link": "https://stackoverflow.com/users/5325331/nikolay"}, "edited": false, "score": 0, "creation_date": 1441977816, "post_id": 32523521, "comment_id": 52906789, "body": "@Ainar-G Yes, its 1.5"}], "answers": [{"comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1441977203, "post_id": 32524298, "comment_id": 52906331, "body": "This is cool. Could you share how did you debug this? Also, any idea why it might&#39;ve worked in 1.4.2 and broke in 1.5?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 2, "creation_date": 1441977572, "post_id": 32524298, "comment_id": 52906593, "body": "@Ainar-G: RC4 is has been disabled because it&#39;s very weak, and now prohibited: <a href=\"https://tools.ietf.org/html/rfc7465\" rel=\"nofollow noreferrer\">tools.ietf.org/html/rfc7465</a>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 2, "creation_date": 1441977691, "post_id": 32524298, "comment_id": 52906685, "body": "@Ainar-G: re debugging; a common cause of handshake failures is when there are no shared ciphers, so I look up what the server supports, and check those with the constants defined in crypto/tls. (I also check if the server even supports tls1.1, tls1.2, etc. Go1.5 is a little better at falling back for misbehaving servers now, so it tends to be more forgiving)"}, {"owner": {"reputation": 41, "user_id": 5325331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69af802fca161001ffe24b6da65e8411?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolay", "link": "https://stackoverflow.com/users/5325331/nikolay"}, "edited": false, "score": 0, "creation_date": 1441978085, "post_id": 32524298, "comment_id": 52907006, "body": "@JimB Thank you! Exactly what is needed. How can you check the supported protocols?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 41, "user_id": 5325331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69af802fca161001ffe24b6da65e8411?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolay", "link": "https://stackoverflow.com/users/5325331/nikolay"}, "edited": false, "score": 1, "creation_date": 1441978392, "post_id": 32524298, "comment_id": 52907253, "body": "@Nikolay: the easiest way is <a href=\"https://www.ssllabs.com/\" rel=\"nofollow noreferrer\">ssllabs.com</a>. You can also script it with any tls client, plus some other methods mentioned here: <a href=\"http://superuser.com/questions/109213/how-do-i-list-the-ssl-tls-cipher-suites-a-particular-website-offers\" title=\"how do i list the ssl tls cipher suites a particular website offers\">superuser.com/questions/109213/&hellip;</a>,"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 7, "last_activity_date": 1441976902, "creation_date": 1441976902, "answer_id": 32524298, "question_id": 32523521, "link": "https://stackoverflow.com/questions/32523521/golang-http-client-handshake-failure/32524298#32524298", "title": "Golang http client handshake failure", "body": "<p>That server only supports a few, weak ciphers:</p>\n\n<pre><code>TLS_DHE_RSA_WITH_AES_256_CBC_SHA (0x39)   DH 1024 bits (p: 128, g: 1, Ys: 128)   FS   WEAK\nTLS_DHE_RSA_WITH_AES_128_CBC_SHA (0x33)   DH 1024 bits (p: 128, g: 1, Ys: 128)   FS   WEAK\nTLS_RSA_WITH_RC4_128_SHA (0x5)   WEAK\n</code></pre>\n\n<p>If you really must connect to that server, Go does support the last cipher in the list, but not by default. Create a client with a new tls.Config specifying the cipher you want:</p>\n\n<pre><code>t := &amp;http.Transport{\n    Proxy: http.ProxyFromEnvironment,\n    Dial: (&amp;net.Dialer{\n        Timeout:   30 * time.Second,\n        KeepAlive: 30 * time.Second,\n    }).Dial,\n    TLSHandshakeTimeout: 10 * time.Second,\n    TLSClientConfig: &amp;tls.Config{\n        CipherSuites: []uint16{tls.TLS_RSA_WITH_RC4_128_SHA},\n    },\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5325331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69af802fca161001ffe24b6da65e8411?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolay", "link": "https://stackoverflow.com/users/5325331/nikolay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3691, "favorite_count": 1, "accepted_answer_id": 32524298, "answer_count": 1, "score": 3, "last_activity_date": 1441976902, "creation_date": 1441974412, "last_edit_date": 1441974854, "question_id": 32523521, "link": "https://stackoverflow.com/questions/32523521/golang-http-client-handshake-failure", "title": "Golang http client handshake failure", "body": "<p>Try get webpage:</p>\n\n<pre><code>    tr := &amp;http.Transport{\n        TLSHandshakeTimeout: 30 * time.Second,\n        DisableKeepAlives: true,\n    }\n\n    client := &amp;http.Client{Transport: tr}\n\n    req, err := http.NewRequest(\"GET\", \"https://www.fl.ru/\", nil)\n    if err != nil {\n        log.Fatalf(\"%s\\n\", err);\n    }\n\n    resp, err := client.Do(req);\n    if err != nil {\n        log.Fatalf(\"%s\\n\", err);\n    }\n    defer resp.Body.Close()\n</code></pre>\n\n<p>Get <a href=\"https://www.fl.ru/\" rel=\"nofollow\">https://www.fl.ru/</a>: remote error: handshake failure. </p>\n\n<p>If I try to get another HTTPS page - all is OK.</p>\n"}, {"tags": ["multithreading", "http", "go", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1441980333, "post_id": 32522762, "comment_id": 52908602, "body": "the http.Request is only valid for the duration of that request. Once your handler exits, the state of the Request is unknown, and the its connection could even be serving another request."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1441987605, "post_id": 32522762, "comment_id": 52913378, "body": "Doing the <code>log()</code> call in a goroutine so that the handler can return quickly if the channel would block is just using goroutines as an expensive buffering mechanism. If you want to return quickly when your workers are busy and just queue the work for later then use a queue. You can make a simple concurrent safe queue with one extra goroutine that <code>log()</code> sends to. That goroutine would append input from that channel onto a slice and write the first element (if any) to your worker channel (<a href=\"http://stackoverflow.com/a/29498219/55504\">e.g. like this</a>)."}], "answers": [{"comments": [{"owner": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "edited": false, "score": 0, "creation_date": 1442138399, "post_id": 32524370, "comment_id": 52953053, "body": "Thanks. I know go does that (fire up the handler func inside a go routine), but it&#39;s not really relevant to my question (the question is about firing up another go routine to prevent blocking). Thanks for the bit of information about closing with io.Closer. re: the content-length, I&#39;m actually returning some content (1x1 pixel) but thanks (wanted to spare outside the point detail from my question)"}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": false, "score": 5, "last_activity_date": 1441977129, "creation_date": 1441977129, "answer_id": 32524370, "question_id": 32522762, "link": "https://stackoverflow.com/questions/32522762/golang-to-goroutine-or-not-to-goroutine/32524370#32524370", "title": "Golang: to goroutine or not to goroutine?", "body": "<blockquote>\n  <p>There's no point in opening up a goroutine for every http request in this case.</p>\n</blockquote>\n\n<p>That already happens when you use <code>net/http</code>'s Server. Your handler is invoked in a goroutine of its own.</p>\n\n<blockquote>\n  <p>I am guessing it's not a good idea to open a goroutine for each request.</p>\n</blockquote>\n\n<p>It's not a bad idea either. Go's runtime can easily handle hundreds of thousands of goroutines.</p>\n\n<p>However, if <code>log</code> blocks, you risk timing out on your client, who is waiting to receive a full HTTP response and only doing <code>rw.WriteHeader(200)</code> doesn't constitute one yet.</p>\n\n<p>To remedy this, you can do something like:</p>\n\n<pre><code>if cr, ok := rw.(io.Closer) {\n    cr.Close()\n}\n</code></pre>\n\n<p>And it's also probably a good idea to set the <code>Content-Length</code> header of your response to <code>0</code>.</p>\n"}], "owner": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2417, "favorite_count": 3, "answer_count": 1, "score": 2, "last_activity_date": 1441977129, "creation_date": 1441971973, "question_id": 32522762, "link": "https://stackoverflow.com/questions/32522762/golang-to-goroutine-or-not-to-goroutine", "title": "Golang: to goroutine or not to goroutine?", "body": "<p>Many times when developing an http server in Go I have this dilemma. </p>\n\n<p>Assuming I want to respond to the client with <code>http statuscode 200</code> as fast as possible (and then perform work at the back), this is why I usually do:</p>\n\n<p>I have my main http handler receive the request, I write <code>http 200</code> to the response, and I send a message over a <code>channel</code> (if I have <code>N</code> workers listening on that <code>channel</code>, I am using a <code>buffered channel</code> of <code>N</code>):</p>\n\n<pre><code>func myHttpHandler(rw http.ResponseWriter, req *http.Request) {\n    rw.WriteHeader(200)\n    log(req)\n}\n\nfunc log(req *http.Request) {\n    msg := createLog(req)\n    if msg != nil {\n        channel &lt;- msg\n    }\n}\n</code></pre>\n\n<p>I have my listeners (fired off on init) listening forever on that channel:</p>\n\n<pre><code>func init() {\n    for i := 0; i &lt; workerCount; i++ {\n        go worker(i, maxEntrySize, maxBufferSize, maxBufferTime)\n    }\n}\n\nfunc worker(workerID int, maxEntrySize int, maxBufferSize int, maxBufferTime time.Duration) {\n    for {\n        entry := &lt;-channel\n        ...\n        ...\n        ...\n</code></pre>\n\n<p>Now, my main question is: should I fire off the <code>log(req)</code> function inside a go routine? i.e.</p>\n\n<pre><code>func myHttpHandler(rw http.ResponseWriter, req *http.Request) {\n    rw.WriteHeader(200)\n    go func() { log(req) } ()\n}\n</code></pre>\n\n<p>As far as I can gather, there's no point in opening up a goroutine for every http request in this case. </p>\n\n<p>Since the current operation of the <code>log(req)</code> function is mostly sending some data over a <code>channel</code> - that operation is super quick. The only time when it's not quick - is if the <code>channel</code> blocks. Now, if the <code>channel</code> blocks, it has to mean that the worker is blocked. And since the worker listens for messages on the channel forever - if the worker is blocked, it means my machine is truly not capable to produce faster output (the worker does some <code>I/O</code> as you can imagine, but that's also very quick, because the I/O only happens once per minute). </p>\n\n<p>Furthermore, since I have <code>N</code> workers, the <code>channel</code> I am using to send the messages on from the handler is buffered with <code>N</code>, so it only blocks if all <code>N</code> workers are blocked. </p>\n\n<p>Is this correct? What are the pros and cons of using a <code>goroutine</code> for the <code>log(req)</code> call? This handler receives upto 10K requests per second, I am guessing it's not a good idea to open a <code>goroutine</code> for each request. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1441963421, "post_id": 32518539, "comment_id": 52897621, "body": "Specify a port in <code>net.TCPAddr</code> (second method). It seems like it&#39;s defaulting to 80 and that port requires privileges and may already be bound."}, {"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "reply_to_user": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1441964833, "post_id": 32518539, "comment_id": 52898531, "body": "@thwd  with port it doesn&#39;t give an error but gives empty response in 10 seconds (added code above)"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1441965051, "post_id": 32518539, "comment_id": 52898667, "body": "Smells like a timeout of some sort."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1441975265, "post_id": 32518539, "comment_id": 52905099, "body": "Your 3rd example isn&#39;t going to print anything, because you&#39;re not sending an HTTP request."}, {"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1441976838, "post_id": 32518539, "comment_id": 52906057, "body": "@JimB how to send HTTP request using <code>net.Dialer{LocalAddr: tcpAddr}</code>?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1441977918, "post_id": 32518539, "comment_id": 52906875, "body": "The answers you linked to are both mine, and the first is this exact same question. If that doesn&#39;t work, we need more information about your network configuration, OS, etc."}, {"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1441978343, "post_id": 32518539, "comment_id": 52907210, "body": "@JimB it&#39;s ubuntu, I added <code>ifcongif</code> information above."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1441980014, "post_id": 32518539, "comment_id": 52908362, "body": "The second example you have makes no sense, because you don&#39;t have an interface named <code>en0</code>, and the last one doesn&#39;t make a request. How about you send a request using the last example? You could also make a Dial function that logs what it&#39;s doing as well as the LocalAddr and RemoteAddr of the actual connection once it&#39;s made."}, {"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1441983260, "post_id": 32518539, "comment_id": 52910638, "body": "@JimB it was a typo with <code>en0</code> - my local computer trials. I updated the second trial above with printing  <code>LocalAddr</code> and <code>RemoteAddr</code>. Looks like the correct the ip is choosed. Why do you say I don&#39;t make a request? This is request <code>conn, err2 := d.Dial(&quot;tcp&quot;, &quot;www.whatismyip.com:80&quot;)</code>, isn&#39;t?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1441983580, "post_id": 32518539, "comment_id": 52910854, "body": "No, that&#39;s not an HTTP request, that&#39;s creating a TCP connection.  You&#39;re example shows it&#39;s using the address you want. You&#39;re going to have to log what the transport dialer is doing."}], "answers": [{"tags": [], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "is_accepted": true, "score": 3, "last_activity_date": 1441986818, "creation_date": 1441986818, "answer_id": 32527460, "question_id": 32518539, "link": "https://stackoverflow.com/questions/32518539/make-http-request-with-a-specified-ethernet-ip/32527460#32527460", "title": "make http request with a specified ethernet ip", "body": "<p>Thank you @JimB. Working solution:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"github.com/PuerkitoBio/goquery\"\n    \"io/ioutil\"\n    \"log\"\n    \"net\"\n    \"net/http\"\n    \"os\"\n    \"time\"\n)\n\nfunc main() {\n    ief, err := net.InterfaceByName(\"eth0\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    addrs, err := ief.Addrs()\n    if err != nil {\n        log.Fatal(err)\n    }\n    tcpAddr := &amp;net.TCPAddr{\n        IP: addrs[3].(*net.IPNet).IP, // Choosing ip address number 3\n    }\n    d := net.Dialer{LocalAddr: tcpAddr}\n    conn, err2 := d.Dial(\"tcp\", \"www.whatismyip.com:80\")\n    if err2 != nil {\n        log.Fatal(err2)\n    }\n    fmt.Println(`conn.LocalAddr()`)\n    fmt.Println(conn.LocalAddr())\n    fmt.Println(`conn.RemoteAddr()`)\n    fmt.Println(conn.RemoteAddr())\n    defer conn.Close()\n\n    transport := &amp;http.Transport{\n        Proxy:               http.ProxyFromEnvironment,\n        Dial:                (&amp;net.Dialer{LocalAddr: tcpAddr}).Dial,\n        TLSHandshakeTimeout: 10 * time.Second,\n    }\n\n    client := &amp;http.Client{\n        Transport: transport,\n    }\n\n    response, err := client.Get(\"https://www.whatismyip.com/\")\n\n    if err != nil {\n        fmt.Printf(\"%s\", err)\n        os.Exit(1)\n    } else {\n        defer response.Body.Close()\n        contents, err := ioutil.ReadAll(response.Body)\n        if err != nil {\n            fmt.Printf(\"%s\", err)\n            os.Exit(1)\n        }\n        var contentsStr = string(contents)\n        fmt.Printf(\"%s\\n\", contentsStr)\n        var doc = DocByHtmlString(contentsStr)\n\n        doc.Find(\"div\").Each(func(i int, s *goquery.Selection) {\n            attr, exists := s.Attr(\"class\")\n            if exists {\n                if attr == \"ip\" {\n                    fmt.Println(s.Text())\n                }\n            }\n        })\n    }\n}\n\nfunc DocByHtmlString(html string) *goquery.Document {\n    doc, err := goquery.NewDocumentFromReader(bytes.NewBufferString(html))\n    if err != nil {\n        panic(err)\n    }\n    return doc\n}\n</code></pre>\n\n<p>Prints in the end <code>Your IP Address Is: 111.222.333.213</code> as expected.</p>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1215, "favorite_count": 2, "accepted_answer_id": 32527460, "answer_count": 1, "score": 2, "last_activity_date": 1441986818, "creation_date": 1441958661, "last_edit_date": 1495540021, "question_id": 32518539, "link": "https://stackoverflow.com/questions/32518539/make-http-request-with-a-specified-ethernet-ip", "title": "make http request with a specified ethernet ip", "body": "<p>I have several public ip addresses on my machine. I want to specify which one to use for a request.</p>\n\n<p>I can do it using curl:</p>\n\n<pre><code>curl --interface 111.222.333.444 https://www.iplocation.net/find-ip-address | grep \"Your IP address\"\n</code></pre>\n\n<p>where <code>111.222.333.444</code> is one of my local ip addresses which I am using to make requests to the internet.</p>\n\n<p>How to do the same using <code>golang</code>?</p>\n\n<h1><a href=\"https://stackoverflow.com/questions/30552447/how-to-set-which-ip-to-use-for-a-http-request\">This</a> method...</h1>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"github.com/PuerkitoBio/goquery\"\n    \"io/ioutil\"\n    \"net\"\n    \"net/http\"\n    \"os\"\n    \"time\"\n)\n\nfunc main() {\n    var localAddr = \"111.222.333.444\"\n    localAddress, _ := net.ResolveTCPAddr(\"tcp\", localAddr)\n\n    // Create a transport like http.DefaultTransport, but with a specified localAddr\n    transport := &amp;http.Transport{\n        Proxy: http.ProxyFromEnvironment,\n        Dial: (&amp;net.Dialer{\n            Timeout:   30 * time.Second,\n            KeepAlive: 30 * time.Second,\n            LocalAddr: localAddress,\n        }).Dial,\n        TLSHandshakeTimeout: 10 * time.Second,\n    }\n\n    client := &amp;http.Client{\n        Transport: transport,\n    }\n\n    response, err := client.Get(\"https://www.whatismyip.com/\")\n\n    if err != nil {\n        fmt.Printf(\"%s\", err)\n        os.Exit(1)\n    } else {\n        defer response.Body.Close()\n        contents, err := ioutil.ReadAll(response.Body)\n        if err != nil {\n            fmt.Printf(\"%s\", err)\n            os.Exit(1)\n        }\n        var contentsStr = string(contents)\n        fmt.Printf(\"%s\\n\", contentsStr)\n        var doc = DocByHtmlString(contentsStr)\n\n        doc.Find(\"div\").Each(func(i int, s *goquery.Selection) {\n            attr, exists := s.Attr(\"class\")\n            if exists {\n                if attr == \"ip\" {\n                    fmt.Println(s.Text())\n                    fmt.Println(\"expected ip is \" + localAddr)\n                }\n            }\n        })\n    }\n}\n\nfunc DocByHtmlString(html string) *goquery.Document {\n    doc, err := goquery.NewDocumentFromReader(bytes.NewBufferString(html))\n    if err != nil {\n        panic(err)\n    }\n    return doc\n}\n</code></pre>\n\n<p>... gives me always the following result:</p>\n\n<pre><code>Your IP Address Is: 555.666.777.888 // main IP address on my machine\nexpected ip is 111.222.333.444\n</code></pre>\n\n<h1><a href=\"https://stackoverflow.com/questions/27410764/dial-with-a-specific-address-interface-golang\">Another</a> method</h1>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"net\"\n)\n\nfunc main() {\n    ief, err := net.InterfaceByName(\"eth0\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    addrs, err := ief.Addrs()\n    if err != nil {\n        log.Fatal(err)\n    }\n    tcpAddr := &amp;net.TCPAddr{\n        IP: addrs[3].(*net.IPNet).IP,\n        // Port: 8080,\n    }\n    d := net.Dialer{LocalAddr: tcpAddr}\n    conn, err2 := d.Dial(\"tcp\", \"www.whatismyip.com:80\")\n    if err2 != nil {\n        log.Fatal(err2)\n    }\n    fmt.Println(`conn.LocalAddr()`)\n    fmt.Println(conn.LocalAddr())\n    fmt.Println(`conn.RemoteAddr()`)\n    fmt.Println(conn.RemoteAddr())\n    defer conn.Close()\n    bytesResult, err3 := ioutil.ReadAll(conn)\n    if err3 != nil {\n        log.Fatal(err3)\n    }\n    fmt.Println(`string(bytesResult)`)\n    fmt.Println(string(bytesResult))\n}\n</code></pre>\n\n<p>gives output</p>\n\n<pre><code>conn.LocalAddr()\n111.222.333.213:37036 \nconn.RemoteAddr()\n141.101.120.15:80\n                     // 15 seconds pause\nstring(bytesResult)\n                     // empty string\n</code></pre>\n\n<h1>ifcongif</h1>\n\n<p>Ubuntu 14.04.3 LTS (GNU/Linux 3.13.0-63-generic x86_64)</p>\n\n<pre><code>$ ifconfig\neth0      Link encap:Ethernet  HWaddr 00:18:3c:96:69:8c  \n          inet addr:111.222.333.208  Bcast:111.222.333.255  Mask:255.255.255.0\n          inet6 addr: de90::216:3cff:fe56:698c/64 Scope:Link\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:942000 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:336708 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000 \n          RX bytes:133860794 (133.8 MB)  TX bytes:84577381 (84.5 MB)\n\neth0:0    Link encap:Ethernet  HWaddr 00:18:3c:96:69:8c  \n          inet addr:111.222.333.209  Bcast:111.222.333.255  Mask:255.255.255.0\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n\neth0:1    Link encap:Ethernet  HWaddr 00:18:3c:96:69:8c  \n          inet addr:111.222.333.212  Bcast:111.222.333.255  Mask:255.255.255.0\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n\neth0:2    Link encap:Ethernet  HWaddr 00:18:3c:96:69:8c  \n          inet addr:111.222.333.213  Bcast:111.222.333.255  Mask:255.255.255.0\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n\neth0:3    Link encap:Ethernet  HWaddr 00:18:3c:96:69:8c  \n          inet addr:111.222.333.216  Bcast:111.222.333.255  Mask:255.255.255.0\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n\neth0:4    Link encap:Ethernet  HWaddr 00:18:3c:96:69:8c  \n          inet addr:111.222.333.217  Bcast:111.222.333.255  Mask:255.255.255.0\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n\neth0:5    Link encap:Ethernet  HWaddr 00:18:3c:96:69:8c  \n          inet addr:111.222.333.220  Bcast:111.222.333.255  Mask:255.255.255.0\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n\neth0:6    Link encap:Ethernet  HWaddr 00:18:3c:96:69:8c  \n          inet addr:111.222.333.221  Bcast:111.222.333.255  Mask:255.255.255.0\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n\neth0:7    Link encap:Ethernet  HWaddr 00:18:3c:96:69:8c  \n          inet addr:111.222.333.224  Bcast:111.222.333.255  Mask:255.255.255.0\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n\neth0:8    Link encap:Ethernet  HWaddr 00:18:3c:96:69:8c  \n          inet addr:111.222.333.225  Bcast:111.222.333.255  Mask:255.255.255.0\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n\nlo        Link encap:Local Loopback  \n          inet addr:127.0.0.1  Mask:255.0.0.0\n          inet6 addr: ::1/128 Scope:Host\n          UP LOOPBACK RUNNING  MTU:65536  Metric:1\n          RX packets:0 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:0 \n          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)\n</code></pre>\n"}, {"tags": ["unicode", "go"], "comments": [{"owner": {"reputation": 469137, "user_id": 476, "user_type": "moderator", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a235706e3d81b614acaec3368edfea4b?s=128&d=identicon&r=PG", "display_name": "deceze", "link": "https://stackoverflow.com/users/476/deceze"}, "edited": false, "score": 0, "creation_date": 1441958728, "post_id": 32518432, "comment_id": 52894904, "body": "Do you mean an <i>encoding</i>? There&#39;s only <i>one</i> Unicode, and Arabic 1256 is not &quot;a Unicode&quot;."}, {"owner": {"reputation": 4877, "user_id": 553825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/87f04a9e81b3d62aab4de5ca63156abc?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Bahrami", "link": "https://stackoverflow.com/users/553825/ali-bahrami"}, "reply_to_user": {"reputation": 469137, "user_id": 476, "user_type": "moderator", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a235706e3d81b614acaec3368edfea4b?s=128&d=identicon&r=PG", "display_name": "deceze", "link": "https://stackoverflow.com/users/476/deceze"}, "edited": false, "score": 0, "creation_date": 1441958793, "post_id": 32518432, "comment_id": 52894944, "body": "You&#39;re right, Iv&#39;e edited the question. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 4877, "user_id": 553825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/87f04a9e81b3d62aab4de5ca63156abc?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Bahrami", "link": "https://stackoverflow.com/users/553825/ali-bahrami"}, "edited": false, "score": 0, "creation_date": 1441959323, "post_id": 32518698, "comment_id": 52895253, "body": "I can&#39;t find a live example of converting an encoding to another, doing that in dot net was easy but here I&#39;m really newbie."}, {"owner": {"reputation": 4877, "user_id": 553825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/87f04a9e81b3d62aab4de5ca63156abc?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Bahrami", "link": "https://stackoverflow.com/users/553825/ali-bahrami"}, "edited": false, "score": 0, "creation_date": 1441994322, "post_id": 32518698, "comment_id": 52916944, "body": "Great live example.  Hmm, so here we are trying to convert from UTF8 TO Japanese SHIFTJIS, is it possible to do it wise versa?"}, {"owner": {"reputation": 3818, "user_id": 1247113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRMFj.png?s=128&g=1", "display_name": "rob74", "link": "https://stackoverflow.com/users/1247113/rob74"}, "reply_to_user": {"reputation": 4877, "user_id": 553825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/87f04a9e81b3d62aab4de5ca63156abc?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Bahrami", "link": "https://stackoverflow.com/users/553825/ali-bahrami"}, "edited": false, "score": 0, "creation_date": 1442050457, "post_id": 32518698, "comment_id": 52932275, "body": "To decode ShiftJIS, use the second part, starting with &quot;declare a decoder...&quot;, encS is the string which you wish to decode, string(decBytes) is the decoded string. Maybe two functions would have been better, but I wanted to keep the example as short as possible..."}], "tags": [], "owner": {"reputation": 3818, "user_id": 1247113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRMFj.png?s=128&g=1", "display_name": "rob74", "link": "https://stackoverflow.com/users/1247113/rob74"}, "is_accepted": true, "score": 16, "last_activity_date": 1442069375, "last_edit_date": 1492087958, "creation_date": 1441959199, "answer_id": 32518698, "question_id": 32518432, "link": "https://stackoverflow.com/questions/32518432/how-to-convert-from-an-encoding-to-utf-8-in-go/32518698#32518698", "title": "How to convert from an encoding to UTF-8 in Go?", "body": "<p>You can use <a href=\"https://godoc.org/golang.org/x/text/encoding\" rel=\"noreferrer\">the encoding package</a>, which includes support for Windows-1256 via the package <code>golang.org/x/text/encoding/charmap</code> (in the example below, import this package and use <code>charmap.Windows1256</code> instead of <code>japanese.ShiftJIS</code>).</p>\n\n<p>Here's a short example which encodes a japanese UTF-8 string to ShiftJIS encoding and then decodes the ShiftJIS string back to UTF-8. Unfortunately it doesn't work on the playground since the playground doesn't have the \"x\" packages.</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"strings\"\n\n    \"golang.org/x/text/encoding/japanese\"\n    \"golang.org/x/text/transform\"\n)\n\nfunc main() {\n    // the string we want to transform\n    s := \"\u4eca\u65e5\u306f\"\n    fmt.Println(s)\n\n    // --- Encoding: convert s from UTF-8 to ShiftJIS \n    // declare a bytes.Buffer b and an encoder which will write into this buffer\n    var b bytes.Buffer\n    wInUTF8 := transform.NewWriter(&amp;b, japanese.ShiftJIS.NewEncoder())\n    // encode our string\n    wInUTF8.Write([]byte(s))\n    wInUTF8.Close()\n    // print the encoded bytes\n    fmt.Printf(\"%#v\\n\", b)\n    encS := b.String()\n    fmt.Println(encS)\n\n    // --- Decoding: convert encS from ShiftJIS to UTF8\n    // declare a decoder which reads from the string we have just encoded\n    rInUTF8 := transform.NewReader(strings.NewReader(encS), japanese.ShiftJIS.NewDecoder())\n    // decode our string\n    decBytes, _ := ioutil.ReadAll(rInUTF8)\n    decS := string(decBytes)\n    fmt.Println(decS)\n}\n</code></pre>\n\n<p>There's a more complete example on the Japanese StackOverflow site. The text is Japanese, but the code should be self-explanatory: <a href=\"https://ja.stackoverflow.com/questions/6120\">https://ja.stackoverflow.com/questions/6120</a></p>\n"}, {"comments": [{"owner": {"reputation": 469137, "user_id": 476, "user_type": "moderator", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a235706e3d81b614acaec3368edfea4b?s=128&d=identicon&r=PG", "display_name": "deceze", "link": "https://stackoverflow.com/users/476/deceze"}, "edited": false, "score": 1, "creation_date": 1441964818, "post_id": 32520058, "comment_id": 52898523, "body": "I&#39;m not terribly proficient in Go, but allocating a buffer roughly <code>*2</code> seems like a terrible idea. Theoretically UTF-8 could be four times the size of the input string (probably never in practice though)."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 469137, "user_id": 476, "user_type": "moderator", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a235706e3d81b614acaec3368edfea4b?s=128&d=identicon&r=PG", "display_name": "deceze", "link": "https://stackoverflow.com/users/476/deceze"}, "edited": false, "score": 0, "creation_date": 1441965496, "post_id": 32520058, "comment_id": 52898970, "body": "It&#39;s just an example. Most of the characters in Win1256 would <a href=\"http://www.unicode.org/Public/MAPPINGS/VENDORS/MICSFT/WindowsBestFit/bestfit1256.txt\" rel=\"nofollow noreferrer\">take two bytes</a>, and none take more than three. Edited."}, {"owner": {"reputation": 469137, "user_id": 476, "user_type": "moderator", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a235706e3d81b614acaec3368edfea4b?s=128&d=identicon&r=PG", "display_name": "deceze", "link": "https://stackoverflow.com/users/476/deceze"}, "edited": false, "score": 0, "creation_date": 1441966230, "post_id": 32520058, "comment_id": 52899457, "body": "There&#39;s gotta be a deterministic way to size buffers, not by guesstimating. @rob74&#39;s answer seems to show such a way."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1441986722, "post_id": 32520058, "comment_id": 52912860, "body": "<code>NewDecoder</code> returns a <code>transform.Transformer</code>. You are <b>not</b> supposed to directly call the <a href=\"https://godoc.org/golang.org/x/text/transform#Transformer\" rel=\"nofollow noreferrer\"><code>Transform</code></a> method like you do! (E.g. like an <code>io.Reader</code> a transformer is allowed to transform as little as it wants on each call.) If you want to use a transformer to transform a <code>[]byte</code> you should use <a href=\"https://godoc.org/golang.org/x/text/transform#Bytes\" rel=\"nofollow noreferrer\"><code>transform.Bytes</code></a>"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 4, "last_activity_date": 1441965433, "last_edit_date": 1441965433, "creation_date": 1441963527, "answer_id": 32520058, "question_id": 32518432, "link": "https://stackoverflow.com/questions/32518432/how-to-convert-from-an-encoding-to-utf-8-in-go/32520058#32520058", "title": "How to convert from an encoding to UTF-8 in Go?", "body": "<p>Use modules from <a href=\"https://godoc.org/golang.org/x/text\" rel=\"noreferrer\"><code>golang.org/x/text</code></a>. In your case this would be something like:</p>\n\n<pre><code>b := /* Win1256 bytes here. */\ndec := charmap.Windows1256.NewDecoder()\n// Take more space just in case some characters need\n// more bytes in UTF-8 than in Win1256.\nbUTF := make([]byte, len(b)*3)\nn, _, err := dec.Transform(bUTF, b, false)\nif err != nil {\n    panic(err)\n}\nbUTF = bUTF[:n]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14998, "user_id": 212378, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/185aae2d842026d2eefa7528b00b394b?s=128&d=identicon&r=PG", "display_name": "Alexis Wilke", "link": "https://stackoverflow.com/users/212378/alexis-wilke"}, "is_accepted": false, "score": 1, "last_activity_date": 1594853017, "creation_date": 1594853017, "answer_id": 62924831, "question_id": 32518432, "link": "https://stackoverflow.com/questions/32518432/how-to-convert-from-an-encoding-to-utf-8-in-go/62924831#62924831", "title": "How to convert from an encoding to UTF-8 in Go?", "body": "<p>I checked out the docs, <a href=\"https://godoc.org/golang.org/x/text\" rel=\"nofollow noreferrer\">here</a>, and I came up with a way to convert an array of bytes to (or from) UTF-8.</p>\n<p>What I have a hard time with is that, so far, I've not found an interface that would allow me to use a locale. Instead, it's like the possible ways are limited to predefined sets of encodings.</p>\n<p>In my case, I needed to convert UTF-16 (really I have USC-2 data, but it should still work) to UTF-8. To do that, I needed to check for the BOM and then do the conversion:</p>\n<pre><code>bom := buf[0] + buf[1] * 256\nif bom == 0xFEFF {\n    enc = unicode.UTF16(unicode.LittleEndian, unicode.IgnoreBOM)\n} else if bom == 0xFFFE {\n    enc = unicode.UTF16(unicode.BigEndian, unicode.IgnoreBOM)\n} else {\n    return Error(&quot;BOM missing&quot;)\n}\n\ne := enc.NewDecoder()\n\n// convert USC-2 (LE or BE) to UTF-8\nutf8 := e.Bytes(buf[2:])\n</code></pre>\n<p>Unfortunate that I have to use &quot;ignore&quot; BOM since in my case it should instead be forbidden past the first character. But that's close enough for my situation. These functions were mentioned in a couple of places, but not shown in practice.</p>\n"}, {"tags": [], "owner": {"reputation": 1451, "user_id": 2930836, "user_type": "registered", "accept_rate": 39, "profile_image": "https://lh4.googleusercontent.com/-hOD6KYRyIY4/AAAAAAAAAAI/AAAAAAAAfv0/9V13VHORoHk/photo.jpg?sz=128", "display_name": "igonejack", "link": "https://stackoverflow.com/users/2930836/igonejack"}, "is_accepted": false, "score": 0, "last_activity_date": 1606549668, "creation_date": 1606549668, "answer_id": 65047518, "question_id": 32518432, "link": "https://stackoverflow.com/questions/32518432/how-to-convert-from-an-encoding-to-utf-8-in-go/65047518#65047518", "title": "How to convert from an encoding to UTF-8 in Go?", "body": "<p>I made a tool for myself, maybe you could borrow some idea from it :)</p>\n<p><a href=\"https://github.com/gonejack/transcode\" rel=\"nofollow noreferrer\">https://github.com/gonejack/transcode</a></p>\n<p>This is the key code:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>_, err = io.Copy(\n    transform.NewWriter(output, targetEncoding.NewEncoder()),\n    transform.NewReader(input, sourceEncoding.NewDecoder()),\n)\n</code></pre>\n"}], "owner": {"reputation": 4877, "user_id": 553825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/87f04a9e81b3d62aab4de5ca63156abc?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Bahrami", "link": "https://stackoverflow.com/users/553825/ali-bahrami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21433, "favorite_count": 5, "accepted_answer_id": 32518698, "answer_count": 4, "score": 13, "last_activity_date": 1606549668, "creation_date": 1441958299, "last_edit_date": 1441964278, "question_id": 32518432, "link": "https://stackoverflow.com/questions/32518432/how-to-convert-from-an-encoding-to-utf-8-in-go", "title": "How to convert from an encoding to UTF-8 in Go?", "body": "<p>I'm working on a project where I need to convert text from an encoding (for example Windows-1256 Arabic) to UTF-8.</p>\n\n<p>How do I do this in Go?</p>\n"}, {"tags": ["go", "character-encoding"], "comments": [{"owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "edited": false, "score": 0, "creation_date": 1441936343, "post_id": 32512500, "comment_id": 52887228, "body": "Could you perhaps read it without using <code>ioutil.ReadAll</code> and do some error checking along the way to narrow down to the bad byte and skip it?"}, {"owner": {"reputation": 601, "user_id": 1347268, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/abd1a63352cf4aa1e8e18228eb2c88c3?s=128&d=identicon&r=PG", "display_name": "Mark Fletcher", "link": "https://stackoverflow.com/users/1347268/mark-fletcher"}, "reply_to_user": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "edited": false, "score": 0, "creation_date": 1441941683, "post_id": 32512500, "comment_id": 52888416, "body": "Unfortunately I don&#39;t think that&#39;d work. Once it hits the bad byte, that&#39;s it. There&#39;s no skipping/seeking/etc."}], "answers": [{"comments": [{"owner": {"reputation": 601, "user_id": 1347268, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/abd1a63352cf4aa1e8e18228eb2c88c3?s=128&d=identicon&r=PG", "display_name": "Mark Fletcher", "link": "https://stackoverflow.com/users/1347268/mark-fletcher"}, "edited": false, "score": 0, "creation_date": 1441941608, "post_id": 32514347, "comment_id": 52888396, "body": "Unfortunately that doesn&#39;t work. The RemoveFunc does get called for every character, but no characters match utf8.RuneError. If I do return true in the RemoveFunc, it stops the transform at that character. I&#39;ve added a test program that shows the (original) problem."}, {"owner": {"reputation": 5661, "user_id": 3179857, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/74a01200b8e1bc8b9b57ddd5633288bc?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/3179857/evan"}, "reply_to_user": {"reputation": 601, "user_id": 1347268, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/abd1a63352cf4aa1e8e18228eb2c88c3?s=128&d=identicon&r=PG", "display_name": "Mark Fletcher", "link": "https://stackoverflow.com/users/1347268/mark-fletcher"}, "edited": false, "score": 0, "creation_date": 1441988004, "post_id": 32514347, "comment_id": 52913635, "body": "Interesting. So the EUC-KR decoder specifically does not fulfill the contract specified by <code>encoding.Encoding</code>, since it returns a custom error at <a href=\"https://github.com/golang/text/blob/6368131e2e9977b23aa20c631034cb98d65461a7/encoding/korean/euckr.go#L56-L58\" rel=\"nofollow noreferrer\">github.com/golang/text/blob/&hellip;</a> instead of just using a RuneError. You should file a bug against the package about this. In the short-term, I think the only choice you have is to copy/fix the encoding package manually :("}], "tags": [], "owner": {"reputation": 5661, "user_id": 3179857, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/74a01200b8e1bc8b9b57ddd5633288bc?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/3179857/evan"}, "is_accepted": false, "score": 4, "last_activity_date": 1441936842, "creation_date": 1441936842, "answer_id": 32514347, "question_id": 32512500, "link": "https://stackoverflow.com/questions/32512500/ignore-illegal-bytes-when-decoding-text-with-go/32514347#32514347", "title": "Ignore illegal bytes when decoding text with Go?", "body": "<p><code>enc.NewDecoder()</code> results in a <code>transform.Transformer</code>. The doc of <code>NewDecoder()</code> says:</p>\n\n<blockquote>\n  <p>Transforming source bytes that are not of that encoding will not result in an error per se. Each byte that cannot be transcoded will be represented in the output by the UTF-8 encoding of '\\uFFFD', the replacement rune.</p>\n</blockquote>\n\n<p>This tells us it is the reader failing on the replacement rune (also known as the error rune). Fortunately it is easy to strip those out.</p>\n\n<p><code>golang.org/x/text/transform</code> provides two helper functions we can use to solve this problem. <code>Chain()</code> takes a set of transformers and chains them together. <code>RemoveFunc()</code> takes a function and filters out all bytes for which it returns true.</p>\n\n<p>Something like the following (untested) should work:</p>\n\n<pre><code>filter := transform.Chain(enc.NewDecoder(), transform.RemoveFunc(func (r rune) bool {\n    return r == utf8.RuneError\n}))\nr := transform.NewReader(strings.NewReader(body), filter)\n</code></pre>\n\n<p>That should filter out all rune-errors before they get to the reader and blow up.</p>\n"}, {"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1442160733, "post_id": 32529537, "comment_id": 52959300, "body": "I think you&#39;re making unwarranted assumptions about the error that at best make this fragile. The <a href=\"https://godoc.org/golang.org/x/text/transform#Transformer\" rel=\"nofollow noreferrer\"><code>transform.Transformer</code></a> documented says &quot;Other than the error conditions listed here, implementations are free to report other errors that arise.&quot;"}], "tags": [], "owner": {"reputation": 601, "user_id": 1347268, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/abd1a63352cf4aa1e8e18228eb2c88c3?s=128&d=identicon&r=PG", "display_name": "Mark Fletcher", "link": "https://stackoverflow.com/users/1347268/mark-fletcher"}, "is_accepted": true, "score": 0, "last_activity_date": 1441994550, "creation_date": 1441994550, "answer_id": 32529537, "question_id": 32512500, "link": "https://stackoverflow.com/questions/32512500/ignore-illegal-bytes-when-decoding-text-with-go/32529537#32529537", "title": "Ignore illegal bytes when decoding text with Go?", "body": "<p>Here is the solution I went with. Instead of using a Reader, I allocate the destination buffer by hand and call the <code>Transform()</code> function directly. When <code>Transform()</code> errors out, I check for a short destination buffer, and reallocate if necessary. Otherwise I skip a rune, assuming that it is the illegal character. For completeness, I should also check for a short input buffer, but I do not do so in this example.</p>\n\n<pre><code>raw := `So, at 64 kBps, or kilobits per second, you\u2019re getting 8 kilobytes a second.`\nenc, _ := charset.Lookup(\"euc-kr\")\ndst := make([]byte, len(raw))\nd := enc.NewDecoder()\n\nvar (\n    in  int\n    out int\n)\nfor in &lt; len(raw) {\n    // Do the transformation\n    ndst, nsrc, err := d.Transform(dst[out:], []byte(raw[in:]), true)\n    in += nsrc\n    out += ndst\n    if err == nil {\n        // Completed transformation\n        break\n    }\n    if err == transform.ErrShortDst {\n        // Our output buffer is too small, so we need to grow it\n        log.Printf(\"Short\")\n        t := make([]byte, (cap(dst)+1)*2)\n        copy(t, dst)\n        dst = t\n        continue\n    }\n    // We're here because of at least one illegal character. Skip over the current rune\n    // and try again.\n    _, width := utf8.DecodeRuneInString(raw[in:])\n    in += width\n}\n</code></pre>\n"}], "owner": {"reputation": 601, "user_id": 1347268, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/abd1a63352cf4aa1e8e18228eb2c88c3?s=128&d=identicon&r=PG", "display_name": "Mark Fletcher", "link": "https://stackoverflow.com/users/1347268/mark-fletcher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 993, "favorite_count": 0, "accepted_answer_id": 32529537, "answer_count": 2, "score": 2, "last_activity_date": 1441994550, "creation_date": 1441923348, "last_edit_date": 1441941498, "question_id": 32512500, "link": "https://stackoverflow.com/questions/32512500/ignore-illegal-bytes-when-decoding-text-with-go", "title": "Ignore illegal bytes when decoding text with Go?", "body": "<p>I'm converting a Go program that decodes email messages. It currently runs iconv to do the actual decoding, which of course has overhead. I would like to use the <code>golang.org/x/text/transform</code> and <code>golang.org/x/net/html/charset</code> packages to do this. Here is working code:</p>\n\n<pre><code>// cs is the charset that the email body is encoded with, pulled from\n// the Content-Type declaration.\nenc, name := charset.Lookup(cs)\nif enc == nil {\n    log.Fatalf(\"Can't find %s\", cs)\n}\n// body is the email body we're converting to utf-8\nr := transform.NewReader(strings.NewReader(body), enc.NewDecoder())\n\n// result contains the converted-to-utf8 email body\nresult, err := ioutil.ReadAll(r)\n</code></pre>\n\n<p>That works great except for when it encounters illegal bytes, which unfortunately is not an uncommon experience when dealing with email in the wild. ioutil.ReadAll() returns an error and all the converted bytes up until the problem. Is there a way to tell the transform package to ignore illegal bytes? Right now, we use the -c flag to iconv to do that. I've gone through the docs for the transform package, and I can't tell if it's possible or not.</p>\n\n<p><strong>UPDATE:</strong>\nHere's a test program that shows the problem (the Go playground doesn't have the charset or transform packages...). The raw text was taken from an actual email. Yep, it's in English, and yep, the charset in the email was set to EUC-KR. I need it to ignore that apostrophe.</p>\n\n<pre><code>package main\n\nimport (\n    \"io/ioutil\"\n    \"log\"\n    \"strings\"\n\n    \"golang.org/x/net/html/charset\"\n    \"golang.org/x/text/transform\"\n)\n\nfunc main() {\n    raw := `So, at 64 kBps, or kilobits per second, you\u2019re getting 8 kilobytes a second.`\n    enc, _ := charset.Lookup(\"euc-kr\")\n    r := transform.NewReader(strings.NewReader(raw), enc.NewDecoder())\n    result, err := ioutil.ReadAll(r)\n    if err != nil {\n        log.Printf(\"ReadAll returned %s\", err)\n    }\n    log.Printf(\"RESULT: '%s'\", string(result))\n}\n</code></pre>\n"}, {"tags": ["go", "nim-lang"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1441922188, "post_id": 32512065, "comment_id": 52883522, "body": "<code>&#47;my&#47;path&#47;to&#47;target&#47;libtarget.a</code> on it&#39;s own isn&#39;t a valid LDFLAG. You also need to specifically link <i>all</i> needed libraries, i.e. you need <code>-ldl</code> to link to libdl for <code>dlclose</code>, <code>dlopen</code>, etc."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1441922282, "post_id": 32512065, "comment_id": 52883560, "body": "and directly from the page you linked to:  &gt; &quot;for instance, on Linux systems you will likely need to use -ldl too to link in required dlopen functionality.&quot;"}, {"owner": {"reputation": 2258, "user_id": 3352025, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/RpFHA.jpg?s=128&g=1", "display_name": "Lye Fish", "link": "https://stackoverflow.com/users/3352025/lye-fish"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1441923004, "post_id": 32512065, "comment_id": 52883805, "body": "@JimB: Thank you. So much of this is Greek to me. I&#39;ll give those suggestions a try."}, {"owner": {"reputation": 2258, "user_id": 3352025, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/RpFHA.jpg?s=128&g=1", "display_name": "Lye Fish", "link": "https://stackoverflow.com/users/3352025/lye-fish"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1441923951, "post_id": 32512065, "comment_id": 52884126, "body": "@JimB: Thanks again. It&#39;s working by adding <code>#cgo LDFLAGS: -ldl</code> to the <code>app.go</code> file, but only works if I keep the invalid <code>#cgo LDFLAGS: &#47;my&#47;path&#47;to&#47;target&#47;libtarget.a</code>. Any idea why that would be or how/where it should be included to be properly done?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1441924734, "post_id": 32512065, "comment_id": 52884353, "body": "Forgot you can pass files directly to gcc like that. I&#39;m not sure if it&#39;s any better to use <code>-L &#47;path&#47;to&#47;target -ltarget</code>. Go with whichever works \ud83d\udc4d\ud83c\udffb"}, {"owner": {"reputation": 2258, "user_id": 3352025, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/RpFHA.jpg?s=128&g=1", "display_name": "Lye Fish", "link": "https://stackoverflow.com/users/3352025/lye-fish"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1441924829, "post_id": 32512065, "comment_id": 52884377, "body": "@JimB: Excellent, thanks. If you wish to post an answer about my <code>-ldl</code> omission, I&#39;ll accept it. Thanks again."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1441925052, "creation_date": 1441925052, "answer_id": 32512779, "question_id": 32512065, "link": "https://stackoverflow.com/questions/32512065/statically-linking-nim-code-to-go/32512779#32512779", "title": "Statically linking Nim code to Go", "body": "<p>You're missing the libdl library. Add <code>-ldl</code> to your LDFLAGS </p>\n"}], "owner": {"reputation": 2258, "user_id": 3352025, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/RpFHA.jpg?s=128&g=1", "display_name": "Lye Fish", "link": "https://stackoverflow.com/users/3352025/lye-fish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 715, "favorite_count": 0, "accepted_answer_id": 32512779, "answer_count": 1, "score": 6, "last_activity_date": 1441925052, "creation_date": 1441921210, "question_id": 32512065, "link": "https://stackoverflow.com/questions/32512065/statically-linking-nim-code-to-go", "title": "Statically linking Nim code to Go", "body": "<p>I'm trying in Linux to statically link some code created in Nim into a Go application. I've followed the <a href=\"http://nim-lang.org/docs/backends.html\" rel=\"noreferrer\">Nim Backend Integration</a> docs and some articles for linking C in Go but haven't gotten it working.</p>\n\n<p>Here's where I'm at so far...</p>\n\n<hr>\n\n<p>Nim code <code>target.nim</code>:</p>\n\n<pre><code>proc testnim* {.exportc.} =\n  echo \"In Nim!\"\n</code></pre>\n\n<p>I compile it with:</p>\n\n<pre><code>nim c --app:staticLib --noMain --header target.nim\n</code></pre>\n\n<hr>\n\n<p>Go code <code>app.go</code>:</p>\n\n<pre><code>package main\n\n/*\n#cgo CFLAGS: -I/my/path/to/target/nimcache\n#cgo CFLAGS: -I/my/path/to/Nim/lib\n#cgo LDFLAGS: /my/path/to/target/libtarget.a\n#include \"/my/path/to/target/nimcache/target.h\"\n*/\nimport \"C\"\nimport \"fmt\"\n\nfunc main() {\n  fmt.Println(\"In Go!\")\n  C.NimMain()\n  C.testnim()\n}\n</code></pre>\n\n<hr>\n\n<p>I tried building it both of these:</p>\n\n<pre><code>go build\n\ngo build --ldflags '-extldflags \"-static\"' app.go\n</code></pre>\n\n<p>Here's what I get:</p>\n\n<pre>\n# command-line-arguments\n/my/path/to/target/libtarget.a(stdlib_system.o): In function `nimUnloadLibrary':\nstdlib_system.c:(.text+0xe6f0): undefined reference to `dlclose'\n/my/path/to/target/libtarget.a(stdlib_system.o): In function `nimLoadLibrary':\nstdlib_system.c:(.text+0xe71b): undefined reference to `dlopen'\n/my/path/to/target/libtarget.a(stdlib_system.o): In function `nimGetProcAddr':\nstdlib_system.c:(.text+0xe750): undefined reference to `dlsym'\ncollect2: error: ld returned 1 exit status\n</pre>\n\n<hr>\n\n<p>So I'm missing something(s). I'm using Go 1.5 and Nim 0.11.3 (devel branch). Any advice or hints would be much appreciated.</p>\n"}, {"tags": ["intellij-idea", "go"], "answers": [{"comments": [{"owner": {"reputation": 647, "user_id": 888876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cb57b434530eb62f9816c1dca4cd97b?s=128&d=identicon&r=PG", "display_name": "Andre de Miranda", "link": "https://stackoverflow.com/users/888876/andre-de-miranda"}, "edited": false, "score": 0, "creation_date": 1452994803, "post_id": 32509574, "comment_id": 57409792, "body": "Thanks for that!  have been able to use the debugger?"}, {"owner": {"reputation": 1366, "user_id": 4931643, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/702807200eaef92e4d1c6896893d7888?s=128&d=identicon&r=PG&f=1", "display_name": "Mbded", "link": "https://stackoverflow.com/users/4931643/mbded"}, "reply_to_user": {"reputation": 647, "user_id": 888876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cb57b434530eb62f9816c1dca4cd97b?s=128&d=identicon&r=PG", "display_name": "Andre de Miranda", "link": "https://stackoverflow.com/users/888876/andre-de-miranda"}, "edited": false, "score": 0, "creation_date": 1453281094, "post_id": 32509574, "comment_id": 57528342, "body": "Yes ofcorse. I use debugger very often. If I good remember I nothing to do with setup for him, just works, but debugger for <code>go</code>  for me is little meager, but works, may be in future something will change. If I help You please give me vote up :)"}, {"owner": {"reputation": 3448, "user_id": 1114357, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8c7fe61be399d9508e87815aa4ff1a85?s=128&d=identicon&r=PG", "display_name": "Sarp Kaya", "link": "https://stackoverflow.com/users/1114357/sarp-kaya"}, "edited": false, "score": 0, "creation_date": 1471167491, "post_id": 32509574, "comment_id": 65237029, "body": "For me this says package not found in your case RightApp package is not found"}, {"owner": {"reputation": 3210, "user_id": 379906, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d0d2b9a421355f4a5bab3658c6f6b41d?s=128&d=identicon&r=PG", "display_name": "db80", "link": "https://stackoverflow.com/users/379906/db80"}, "edited": false, "score": 0, "creation_date": 1495198297, "post_id": 32509574, "comment_id": 75165069, "body": "you made my day."}, {"owner": {"reputation": 3374, "user_id": 1470257, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/Jxn44.png?s=128&g=1", "display_name": "yiwei", "link": "https://stackoverflow.com/users/1470257/yiwei"}, "edited": false, "score": 0, "creation_date": 1506888863, "post_id": 32509574, "comment_id": 79987118, "body": "Boom. Fixed for me in both Intellij + Gogland"}, {"owner": {"reputation": 133, "user_id": 6805420, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OGwp1Fq3e90/AAAAAAAAAAI/AAAAAAAAVEM/E_UmZ0lYvPU/photo.jpg?sz=128", "display_name": "SagarKapasi099", "link": "https://stackoverflow.com/users/6805420/sagarkapasi099"}, "edited": false, "score": 0, "creation_date": 1601208460, "post_id": 32509574, "comment_id": 113328837, "body": "I Think You Should Not Edit Defaults (As Shown In Screenshot), As It Could Be Of Use Another Time, In Another Project."}], "tags": [], "owner": {"reputation": 1366, "user_id": 4931643, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/702807200eaef92e4d1c6896893d7888?s=128&d=identicon&r=PG&f=1", "display_name": "Mbded", "link": "https://stackoverflow.com/users/4931643/mbded"}, "is_accepted": false, "score": 28, "last_activity_date": 1488363753, "last_edit_date": 1488363753, "creation_date": 1441911017, "answer_id": 32509574, "question_id": 32508254, "link": "https://stackoverflow.com/questions/32508254/go-in-intellij-idea-multiple-file-and-error-undefined-data/32509574#32509574", "title": "GO in IntelliJ IDEA. Multiple File and Error Undefined: Data", "body": "<p><strong>----------------------SOLVED-------------------------------------------SOLVED---------------------</strong></p>\n\n<p>Steps</p>\n\n<ul>\n<li>Project must be found in directory <code>for/example/MyProject/src/HERE_DIRECTORY_WITH_YOUR_SOURCE_GO_FILE</code>\nsub direcytory <strong>src</strong> is important</li>\n<li>Go to <code>Run --&gt; Edit Configurations</code></li>\n<li>Find below position</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/PqrMB.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/PqrMB.png\" alt=\"enter image description here\"></a></p>\n\n<ul>\n<li>Change <code>Run Kind</code> to <code>Package</code></li>\n<li>In Position <code>Package</code> write Your folder with Your code (Shold be Highlight it is correct)</li>\n<li>Click On PLUS icon in left top corner, and Add <code>Go Application</code></li>\n<li>Apply changes</li>\n<li>In the right top corner main window IDE You see small icon Play </li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/MVJrs.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/MVJrs.png\" alt=\"enter image description here\"></a></p>\n\n<ul>\n<li>Chose early defined <code>Go Application</code> my is Unamed</li>\n<li>Click Play</li>\n<li>An Joy :D</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6807416, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qM9ZvlZ1AuQ/AAAAAAAAAAI/AAAAAAAAAAA/EiwftNMndMo/photo.jpg?sz=128", "display_name": "Bayu Cahya", "link": "https://stackoverflow.com/users/6807416/bayu-cahya"}, "is_accepted": false, "score": -1, "last_activity_date": 1473575395, "last_edit_date": 1473575395, "creation_date": 1473311026, "answer_id": 39382928, "question_id": 32508254, "link": "https://stackoverflow.com/questions/32508254/go-in-intellij-idea-multiple-file-and-error-undefined-data/39382928#39382928", "title": "GO in IntelliJ IDEA. Multiple File and Error Undefined: Data", "body": "<p>Sarp Kaya, just follow Mbded steps. Additional step is, ensure that your <strong>additional</strong> GOPATH should be there.</p>\n\n<p>For example, this is our <code>~/.profile GOPATH</code></p>\n\n<pre><code>export GOPATH=$HOME/lib/Go:$HOME/Development/Go\n</code></pre>\n\n<p>The first path used by go get processes etc, while your active go development directory goes to the next path.</p>\n\n<p>According to our config, the RightApp exact path should be <code>$HOME/Development/Go/src/RightApp</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 6026560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/825562bd2ad71a761b46940c60d184f1?s=128&d=identicon&r=PG&f=1", "display_name": "Squareme", "link": "https://stackoverflow.com/users/6026560/squareme"}, "is_accepted": false, "score": 6, "last_activity_date": 1481846001, "creation_date": 1481846001, "answer_id": 41175242, "question_id": 32508254, "link": "https://stackoverflow.com/questions/32508254/go-in-intellij-idea-multiple-file-and-error-undefined-data/41175242#41175242", "title": "GO in IntelliJ IDEA. Multiple File and Error Undefined: Data", "body": "<p>Let say you are having a project with src/ sub directory and two .go files inside: hello.go and typetest.go and both defines the same package \"main\". One of them (hello.go) also implements func main().</p>\n\n<p>To make it compile as whole you need to make sure two things are configured properly: GOPATH and Run/Debug configuration.</p>\n\n<p>Open the Project Libraries/GOPATH settings:</p>\n\n<p>For <strong>Gogland</strong></p>\n\n<p>File -> Settings -> Go</p>\n\n<p>For <strong>Intellij IDEA</strong></p>\n\n<p>File -> Settings -> Languages &amp; Frameworks -> Go -> Go Libraries</p>\n\n<p>Makes sure the GOPATH for the project looks something like that:</p>\n\n<p><a href=\"https://i.stack.imgur.com/DKRYe.jpg\" rel=\"noreferrer\">GOPATH settings</a></p>\n\n<p>Next, open Run -> Edit Configurations and make sure your configuration looks similar to this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/4JH2W.jpg\" rel=\"noreferrer\">Run/Debug configuration</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 3814357, "user_type": "registered", "profile_image": "https://graph.facebook.com/585502212/picture?type=large", "display_name": "user3814357", "link": "https://stackoverflow.com/users/3814357/user3814357"}, "is_accepted": false, "score": 0, "last_activity_date": 1485012537, "creation_date": 1485012537, "answer_id": 41781098, "question_id": 32508254, "link": "https://stackoverflow.com/questions/32508254/go-in-intellij-idea-multiple-file-and-error-undefined-data/41781098#41781098", "title": "GO in IntelliJ IDEA. Multiple File and Error Undefined: Data", "body": "<p>You can add second file (in your case Data.go) as Go tool arguments field in Run/Debug Configurations. I read about this here: <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin/issues/2013\" rel=\"nofollow noreferrer\">https://github.com/go-lang-plugin-org/go-lang-idea-plugin/issues/2013</a> near the end of discussion. Example below (I used 2 files HelGo.go and aaa.go) worked for me:</p>\n\n<p><a href=\"https://i.stack.imgur.com/vabS1.png\" rel=\"nofollow noreferrer\">Go Run Configuration with 2 files</a></p>\n\n<p>Intellij objected in these 2 files were in different folders, and so both of them has to be same package (main).\nOn the other side I couldn't make any advises on this page work at all. </p>\n"}], "owner": {"reputation": 1366, "user_id": 4931643, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/702807200eaef92e4d1c6896893d7888?s=128&d=identicon&r=PG&f=1", "display_name": "Mbded", "link": "https://stackoverflow.com/users/4931643/mbded"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6591, "favorite_count": 7, "answer_count": 4, "score": 15, "last_activity_date": 1488363753, "creation_date": 1441906293, "last_edit_date": 1441911035, "question_id": 32508254, "link": "https://stackoverflow.com/questions/32508254/go-in-intellij-idea-multiple-file-and-error-undefined-data", "title": "GO in IntelliJ IDEA. Multiple File and Error Undefined: Data", "body": "<p><strong>I want use IntelliJ IDE Community Edition</strong> to write code in <strong>GO (GoLang)</strong>. I instaled right plugin, and instaled all need tools to build application. \nMy application consists with two below file. Each is in direcytory <em>../EventServer</em>. </p>\n\n<ul>\n<li>Main.go</li>\n<li>Data.go</li>\n</ul>\n\n<p>If I want to run project from IntelliJ using function Run (Ctlr+Shift+F10) and I <strong>get below error</strong></p>\n\n<pre><code>/usr/lib/go/bin/go build -o \"/tmp/Build Main.go and run0go\" -gcflags \"-N -l\" /my/home/blah/EventServer/Main.go\n# command-line-arguments\n./Main.go:11: undefined: Data\n</code></pre>\n\n<p>I can without any problem compiled code from terminal come in to direcytory with project and execution command </p>\n\n<pre><code>:~/Pulpit/EventServer$ go build\n./EventServer \nHello\ndane w strukturze someone\n</code></pre>\n\n<p>tree direcytory and files looks like</p>\n\n<pre><code>EventServer$ tree -a\n.\n\u251c\u2500\u2500 Data.go\n\u251c\u2500\u2500 EventServer\n\u251c\u2500\u2500 EventServer.iml\n\u251c\u2500\u2500 .idea\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 compiler.xml\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 copyright\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 profiles_settings.xml\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 libraries\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 GOPATH__EventServer_.xml\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 misc.xml\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 modules.xml\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 .name\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 vcs.xml\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 workspace.xml\n\u2514\u2500\u2500 Main.go\n</code></pre>\n\n<p>I suppose that command to run is bad, because compiler trying build program with only one file Main.go but not with all files. Right command should be</p>\n\n<pre><code>$ go run *.go \n</code></pre>\n\n<p>But I do not know where Can I set this. </p>\n\n<p>I also set GOPATH to:</p>\n\n<pre><code>export GOPATH=$HOME/Pulpit/EventServer\n</code></pre>\n\n<p>This also hasn't help</p>\n\n<p><strong>CODE</strong></p>\n\n<p><strong>Main.go</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n)\n\nfunc main() {\n\n    fmt.Println(\"Hello\")\n    abcd := Data{\"someone\" , \"1234567\"}\n    fmt.Printf(\"dane w strukturze %s \", abcd.Name)\n\n}\n</code></pre>\n\n<p>And  <strong>Data.go</strong></p>\n\n<pre><code>package main\n\n\ntype Data struct {\nName string\nPhone string\n\n}\n</code></pre>\n\n<p><strong>SYSTEM: LINUX</strong></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 177, "user_id": 5086822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853c6f82008ed7b4728c143159e206f1?s=128&d=identicon&r=PG", "display_name": "Zhuharev", "link": "https://stackoverflow.com/users/5086822/zhuharev"}, "edited": false, "score": 0, "creation_date": 1441893980, "post_id": 32503247, "comment_id": 52867499, "body": "execute template to string, then execute second template with this string"}, {"owner": {"reputation": 177, "user_id": 5086822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853c6f82008ed7b4728c143159e206f1?s=128&d=identicon&r=PG", "display_name": "Zhuharev", "link": "https://stackoverflow.com/users/5086822/zhuharev"}, "edited": false, "score": 0, "creation_date": 1441894285, "post_id": 32503247, "comment_id": 52867713, "body": "UPD: you can youse <code>{{ template &quot;templates&#47;base.html&quot; .}}</code> from any template"}], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 5250918, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a241b785773d58ae2cd8be649f9b97a?s=128&d=identicon&r=PG&f=1", "display_name": "Kaign", "link": "https://stackoverflow.com/users/5250918/kaign"}, "edited": false, "score": 0, "creation_date": 1441969130, "post_id": 32510483, "comment_id": 52901188, "body": "I&#39;ve tried to do as you said, but it turned out that i can&#39;t parse two templates with same name {{define &quot;content&quot;}} using ParseGlob() or ParseFiles(). I get error that &quot;content&quot; is being redefined. Is there some workaround? And Zhuharev&#39;s proposal works fine."}, {"owner": {"reputation": 1665, "user_id": 4638952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03791badf72f6918a8910148dfc4401e?s=128&d=identicon&r=PG&f=1", "display_name": "SnoProblem", "link": "https://stackoverflow.com/users/4638952/snoproblem"}, "reply_to_user": {"reputation": 273, "user_id": 5250918, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a241b785773d58ae2cd8be649f9b97a?s=128&d=identicon&r=PG&f=1", "display_name": "Kaign", "link": "https://stackoverflow.com/users/5250918/kaign"}, "edited": false, "score": 0, "creation_date": 1441971156, "post_id": 32510483, "comment_id": 52902511, "body": "Zhuharev&#39;s suggestion is the idiomatic way to compose templates.  If you&#39;re working with dynamic compositions that need to pass one template into another, define a template within base that simply drops the incoming HTML in the template.  Rename edit and view to avoid duplicates and it&#39;s ready to go."}], "tags": [], "owner": {"reputation": 1665, "user_id": 4638952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03791badf72f6918a8910148dfc4401e?s=128&d=identicon&r=PG&f=1", "display_name": "SnoProblem", "link": "https://stackoverflow.com/users/4638952/snoproblem"}, "is_accepted": true, "score": 2, "last_activity_date": 1441917632, "last_edit_date": 1441917632, "creation_date": 1441914664, "answer_id": 32510483, "question_id": 32503247, "link": "https://stackoverflow.com/questions/32503247/render-one-template-inside-another-without-parsing-them-every-time/32510483#32510483", "title": "Render one template inside another without parsing them every time", "body": "<p>Instead of writing directly to the <code>http.ResponseWriter</code> on your call to <code>ExecuteTemplate</code>, write to a byte buffer and send that through the call to the next template by prepping it with a <code>template.HTML</code> call.  </p>\n\n<pre><code>var b bytes.Buffer\n\nvar templates = template.Must(template.ParseGlob(\"templates/*.html\"))\n\nerr := templates.ExecuteTemplate(b, templ_1, p)\nif err != nil { //handle err }\nerr := templates.ExecuteTemplate(w, templ_2, template.HTML(b.String()))\nif err != nil { //handle err }\n</code></pre>\n\n<p>If you're going to use an unknown number of templates, you can capture the intermediate step with a string:  </p>\n\n<pre><code>var strtmp string\nerr := templates.ExecuteTemplate(b, templ_1, p)\nif err != nil { //handle err }\n\nstrtemp = b.String()  //store the output\nb.Reset()             //prep buffer for next template's output\n\nerr := templates.ExecuteTemplate(b, templ_2, template.HTML(strtmp))\nif err != nil { //handle err }\n\n//... until all templates are applied\n\nb.WriteTo(w)  //Send the final output to the ResponseWriter\n</code></pre>\n\n<p>EDIT:  As @Zhuharev pointed out, if the composition of the view and edit templates are fixed, they can both reference base rather than base trying to provide a reference to either view or edit:  </p>\n\n<pre><code>{{define \"viewContent\"}}\n{{template \"templates/base.html\" .}}\n...Current view.html template...\n{{end}}\n\n{{define \"editContent\"}}\n{{template \"templates/base.html\" .}}\n...Current edit.html template...\n{{end}}\n</code></pre>\n"}], "owner": {"reputation": 273, "user_id": 5250918, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a241b785773d58ae2cd8be649f9b97a?s=128&d=identicon&r=PG&f=1", "display_name": "Kaign", "link": "https://stackoverflow.com/users/5250918/kaign"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 615, "favorite_count": 0, "accepted_answer_id": 32510483, "answer_count": 1, "score": 1, "last_activity_date": 1441917632, "creation_date": 1441891674, "question_id": 32503247, "link": "https://stackoverflow.com/questions/32503247/render-one-template-inside-another-without-parsing-them-every-time", "title": "Render one template inside another without parsing them every time", "body": "<p>I have three templates like this:</p>\n\n<p>base.html:</p>\n\n<pre><code>&lt;h1&gt;Base.html rendered here&lt;/h1&gt;\n{{template \"content\" .}}\n</code></pre>\n\n<p>view.html:</p>\n\n<pre><code>{{define \"content\"}}\n...\n{{end}}\n</code></pre>\n\n<p>edit.html:</p>\n\n<pre><code>{{define \"content\"}}\n...\n{{end}}\n</code></pre>\n\n<p>I store them in folder \"templates\".</p>\n\n<p>What i want is to dynamically change template which will be rendered in {{template \"content\" .}} place, without parsing every time. So what i DO NOT want is this :</p>\n\n<pre><code>func main() {\n   http.HandleFunc(\"/edit\", handlerEdit)\n   http.HandleFunc(\"/view\", handlerView)\n   http.ListenAndServe(\":8080\", nil)\n}\nfunc handlerView(w http.ResponseWriter, req *http.Request) {\n   renderTemplate(w, req, \"view\")\n}\n\nfunc handlerEdit(w http.ResponseWriter, req *http.Request) {\n   renderTemplate(w, req, \"edit\")\n}\n\nfunc renderTemplate(w http.ResponseWriter, req *http.Request, tmpl    string) {\n   templates, err := template.ParseFiles(\"templates/base.html\",  \"templates/\"+tmpl+\".html\")\n   if err != nil {\n       fmt.Println(\"Something goes wrong \", err)\n       return\n   }\n   someData := &amp;Page{Title: \"QWE\", Body: []byte(\"sample body\")}\n   templates.Execute(w, someData)\n}\n</code></pre>\n\n<p>I was looking at the template.ParseGlobe(), in order to do something like this </p>\n\n<pre><code>var templates = template.Must(template.ParseGlob(\"templates/*.html\"))\n... //and then somthing like this:\nerr := templates.ExecuteTemplate(w, tmpl+\".html\", p)\n</code></pre>\n\n<p>But ExecuteTamplate() recieves only one string as template's name. How in this case i can render two and more templates?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1441890836, "post_id": 32501784, "comment_id": 52865014, "body": "Which type is e.g. <code>countryName</code> in your database schema ?"}], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 3, "last_activity_date": 1441890741, "creation_date": 1441890741, "answer_id": 32502887, "question_id": 32501784, "link": "https://stackoverflow.com/questions/32501784/the-sqlx-library-gives-weird-base64-encoded-looking-results/32502887#32502887", "title": "The sqlx library gives weird base64 encoded looking results", "body": "<p>Package encoding/json will marshal <code>[]byte</code> slices base64 encoded (see <a href=\"http://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow\">http://golang.org/pkg/encoding/json/#Marshal</a>). So the problem is just in the output via <code>json.Marshal(results)</code>.</p>\n\n<p>Somewhere your code calls a function which produces a <code>[]byte</code> which is nicely hidden in one of these <code>{}interface</code>s . Get rid of each of the empty interfaces, use strings where appropriate and the problem will either vanish or the solution will be obvious.</p>\n\n<p>(Calling <code>json.Marshal</code> and outputting the result for debug purpose might not be a good idea, especially if you do not really know what you are actuall marshaling.)</p>\n"}, {"comments": [{"owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "edited": false, "score": 0, "creation_date": 1441891614, "post_id": 32503082, "comment_id": 52865602, "body": "I tried to do that but I keep getting &quot;missing destination name cityId&quot; error."}, {"owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "edited": false, "score": 1, "creation_date": 1441891939, "post_id": 32503082, "comment_id": 52865872, "body": "Ok it works now, I needed to change the sql tag to db tag!"}, {"owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "edited": false, "score": 0, "creation_date": 1441892068, "post_id": 32503082, "comment_id": 52865969, "body": "Thanks. By the way do you know if I should defer rows.Close() and additional err = rows.Err() check at the end as emphasized here: <a href=\"http://go-database-sql.org/retrieving.html\" rel=\"nofollow noreferrer\">go-database-sql.org/retrieving.html</a>"}, {"owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "edited": false, "score": 0, "creation_date": 1441892726, "post_id": 32503082, "comment_id": 52866470, "body": "I keep getting the &quot;missing destination name cityId&quot; error"}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "reply_to_user": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "edited": false, "score": 0, "creation_date": 1441892874, "post_id": 32503082, "comment_id": 52866594, "body": "This error occurs when the struct doesn&#39;t have a matching field for a result&#39;s coumn. So, double-check the tags (I can&#39;t remember if its <code>db</code> or <code>sql</code>, there is long time I used it) and the results names. The case matter\u2026"}, {"owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "edited": false, "score": 0, "creation_date": 1441893358, "post_id": 32503082, "comment_id": 52867058, "body": "I made an edit on the post, please check it. Your struct works, if I just replace sql with db, but when I do it does not work. The only difference is the admin name and ID instead if Id and the ordering of the struct properties.."}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "reply_to_user": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "edited": false, "score": 0, "creation_date": 1441893781, "post_id": 32503082, "comment_id": 52867360, "body": "I don&#39;t know exactly what change, but I would suggest opening another question so you can provide a fuller example without polluting this question (given that the question themselves are mostly unrelated)."}, {"owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "edited": false, "score": 0, "creation_date": 1441895342, "post_id": 32503082, "comment_id": 52868577, "body": "In case you wondered I found out the issue. I can not have comma separated tags, I can only do spacing with the space key, I can&#39;t even tab."}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": true, "score": 5, "last_activity_date": 1441891230, "creation_date": 1441891230, "answer_id": 32503082, "question_id": 32501784, "link": "https://stackoverflow.com/questions/32501784/the-sqlx-library-gives-weird-base64-encoded-looking-results/32503082#32503082", "title": "The sqlx library gives weird base64 encoded looking results", "body": "<p>As <code>spew.Dump</code> tells you, the SQL driver returns <code>[]uint8</code> for textual column. In fact, it is equivalent to <code>[]byte</code>, which <code>json.Marshal</code> encode as base64 strings.</p>\n\n<p>The simplest way to work around that is to scan your rows into a real struct (which sqlx does quite well with <code>StructScan</code>), which will have <code>string</code> fields so that <code>json.Marshal</code> will display them as you expect. You can control the name of both the SQL and JSON names of the field using tags, so your entity can have conventionnal names in every language\u2026</p>\n\n<p>Example:</p>\n\n<pre><code>type City struct {\n    AdminName    string `json:\"admin1Name\"   sql:\"admin1Name\"`\n    CityID       int64  `json:\"cityId\"       sql:\"cityId\"`\n    CityName     string `json:\"cityName\"     sql:\"cityName\"`\n    CountryName  string `json:\"countryName\"  sql:\"countryName\"`\n    SearchString string `json:\"searchString\" sql:\"searchString\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 693, "favorite_count": 0, "accepted_answer_id": 32503082, "answer_count": 2, "score": 2, "last_activity_date": 1441895393, "creation_date": 1441887753, "last_edit_date": 1441895393, "question_id": 32501784, "link": "https://stackoverflow.com/questions/32501784/the-sqlx-library-gives-weird-base64-encoded-looking-results", "title": "The sqlx library gives weird base64 encoded looking results", "body": "<p>I am using this library from <a href=\"http://jmoiron.github.io/sqlx/\" rel=\"nofollow\">http://jmoiron.github.io/sqlx/</a> to do a query. Following the documentation led me to the code below.</p>\n\n<pre><code>func cities(w http.ResponseWriter, r *http.Request, _ httprouter.Params) error {\n    var main string\n    var secondary string\n    var limit string\n    queryParams := make(map[string]interface{})\n\n    if k := r.PostFormValue(\"keyword\"); k != \"\" {\n        main = \"city.name LIKE :keyword\"\n        queryParams[\"keyword\"] = k + \"%\"\n    }\n\n    if sk := r.PostFormValue(\"secondaryKeyword\"); sk != \"\" &amp;&amp; sk != \"null\" {\n        secondary = \"OR city.name = :secondaryKeyword\"\n        queryParams[\"secondaryKeyword\"] = sk\n    }\n\n    if mr := r.PostFormValue(\"maxResults\"); mr != \"\" {\n        limit = \"LIMIT :maxResults\"\n        queryParams[\"maxResults\"] = mr\n    }\n\n    if lr := r.PostFormValue(\"lastRequest\"); lr != \"\" &amp;&amp; lr == \"1\" {\n        limit = \"\"\n    }\n\n    query := fmt.Sprintf(`\n        SELECT\n            city.geonameid AS cityId,\n            city.name AS cityName,\n            COALESCE(admin1.name_local, '') AS admin1Name,\n            country.name AS countryName,\n            CONCAT_WS(' ', city.name, city.asciiname, country.name) AS searchString\n        FROM geonames_cities1000 AS city\n            INNER JOIN geonames_countryinfo AS country\n                ON city.iso_alpha2 = country.iso_alpha2\n            LEFT OUTER JOIN geonames_admin1_codes_ascii as admin1\n                ON admin1.code = CONCAT(city.iso_alpha2, '.', city.admin1_code)\n        WHERE %s %s\n        ORDER BY city.name ASC %s;\n    `, main, secondary, limit)\n\n    nstmt, err := sql.DB.PrepareNamed(query)\n    if err != nil {\n        return err\n    }\n\n    rows, err := nstmt.Queryx(queryParams)\n    if err != nil {\n        return err\n    }\n\n    results := []interface{}{}\n\n    for rows.Next() {\n        row := make(map[string]interface{})\n        err := rows.MapScan(row)\n        if err != nil {\n            return err\n        }\n        results = append(results, row)\n    }\n\n    b, err := json.Marshal(results)\n    if err != nil {\n        return err\n    }\n    w.Write(b)\n    return nil\n}\n</code></pre>\n\n<p>Sending a POST request postman chrome plugin with these values:</p>\n\n<pre><code>keyword: \"tron\"\nmaxResults: 7\nlastRequest: 0\n</code></pre>\n\n<p>gave this JSON output:</p>\n\n<pre><code>[\n    {\n        \"admin1Name\": \"VXR0YXJhZGl0\",\n        \"cityId\": 1605268,\n        \"cityName\": \"VHJvbg==\",\n        \"countryName\": \"VGhhaWxhbmQ=\",\n        \"searchString\": \"VHJvbiBUcm9uIFRoYWlsYW5k\"\n    },\n    {\n        \"admin1Name\": \"Q2FsYWJyaWE=\",\n        \"cityId\": 8949073,\n        \"cityName\": \"VHJvbmNh\",\n        \"countryName\": \"SXRhbHk=\",\n        \"searchString\": \"VHJvbmNhIFRyb25jYSBJdGFseQ==\"\n    },\n    {\n        \"admin1Name\": \"QXJhZ29u\",\n        \"cityId\": 3107444,\n        \"cityName\": \"VHJvbmNow7Nu\",\n        \"countryName\": \"U3BhaW4=\",\n        \"searchString\": \"VHJvbmNow7NuIFRyb25jaG9uIFNwYWlu\"\n    },\n    {\n        \"admin1Name\": \"UHVlYmxh\",\n        \"cityId\": 8859151,\n        \"cityName\": \"VHJvbmNvbmFs\",\n        \"countryName\": \"TWV4aWNv\",\n        \"searchString\": \"VHJvbmNvbmFsIFRyb25jb25hbCBNZXhpY28=\"\n    },\n    {\n        \"admin1Name\": \"U2NobGVzd2lnLUhvbHN0ZWlu\",\n        \"cityId\": 2821000,\n        \"cityName\": \"VHLDtm5kZWw=\",\n        \"countryName\": \"R2VybWFueQ==\",\n        \"searchString\": \"VHLDtm5kZWwgVHJvbmRlbCBHZXJtYW55\"\n    },\n    {\n        \"admin1Name\": \"U8O4ci1UcsO4bmRlbGFn\",\n        \"cityId\": 3133880,\n        \"cityName\": \"VHJvbmRoZWlt\",\n        \"countryName\": \"Tm9yd2F5\",\n        \"searchString\": \"VHJvbmRoZWltIFRyb25kaGVpbSBOb3J3YXk=\"\n    },\n    {\n        \"admin1Name\": \"VG9uZ3Nh\",\n        \"cityId\": 1252408,\n        \"cityName\": \"VHJvbmdzYQ==\",\n        \"countryName\": \"Qmh1dGFu\",\n        \"searchString\": \"VHJvbmdzYSBUcm9uZ3NhIEJodXRhbg==\"\n    }\n]\n</code></pre>\n\n<p>Why are the results like this? Putting the results in spew.Dump()\nwill give something like this (I'm just outputting one of the rows): </p>\n\n<pre><code>(map[string]interface {}) (len=5) {\n  (string) (len=11) \"countryName\": ([]uint8) (len=6 cap=6) {\n   00000000  4e 6f 72 77 61 79                                 |Norway|\n  },\n  (string) (len=12) \"searchString\": ([]uint8) (len=26 cap=26) {\n   00000000  54 72 6f 6e 64 68 65 69  6d 20 54 72 6f 6e 64 68  |Trondheim Trondh|\n   00000010  65 69 6d 20 4e 6f 72 77  61 79                    |eim Norway|\n  },\n  (string) (len=6) \"cityId\": (int64) 3133880,\n  (string) (len=8) \"cityName\": ([]uint8) (len=9 cap=9) {\n   00000000  54 72 6f 6e 64 68 65 69  6d                       |Trondheim|\n  },\n  (string) (len=10) \"admin1Name\": ([]uint8) (len=15 cap=15) {\n   00000000  53 c3 b8 72 2d 54 72 c3  b8 6e 64 65 6c 61 67     |S..r-Tr..ndelag|\n  }\n</code></pre>\n\n<p>What do I do wrong here?'</p>\n\n<p>EDIT:</p>\n\n<p>I tried doing as Elwinar suggested with structs instead. But something really weird is going on.</p>\n\n<p>This code works:</p>\n\n<pre><code>type City struct {\n    AdminName    string `json:\"admin1Name\"   db:\"admin1Name\"`\n    CityID       int64  `json:\"cityId\"       db:\"cityId\"`\n    CityName     string `json:\"cityName\"     db:\"cityName\"`\n    CountryName  string `json:\"countryName\"  db:\"countryName\"`\n    SearchString string `json:\"searchString\" db:\"searchString\"`\n}\n</code></pre>\n\n<p>But this code does not work and outputs error \"missing destination name cityId\":</p>\n\n<pre><code>type City struct {\n    CityId       int64  `json:\"cityId\"       db:\"cityId\"`\n    CityName     string `json:\"cityName\"     db:\"cityName\"`\n    Admin1Name   string `json:\"admin1Name\"   db:\"admin1Name\"`\n    CountryName  string `json:\"countryName\"  db:\"countryName\"`\n    SearchString string `json:\"searchString\" db:\"searchString\"`\n}\n</code></pre>\n\n<p>What is the difference?</p>\n\n<p>Solution: Must separate the tags with space key. Can not do spacing with tab key, and can not use commas to separate tags.</p>\n"}, {"tags": ["html", "regex", "go", "html-parsing"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 5, "creation_date": 1441874691, "post_id": 32496163, "comment_id": 52853965, "body": "Parsing HTML with regular expressions is hard to impossible. Maybe using golang.org/x/net/html to parse the HTML would be a) easier and b) more robust?"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 5, "creation_date": 1441875647, "post_id": 32496163, "comment_id": 52854619, "body": "<a href=\"http://stackoverflow.com/a/1732454/532430\">stackoverflow.com/a/1732454/532430</a>"}], "owner": {"reputation": 2634, "user_id": 1868277, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/oi5jr.jpg?s=128&g=1", "display_name": "Puzzled Boy", "link": "https://stackoverflow.com/users/1868277/puzzled-boy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 494, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1441871586, "creation_date": 1441871586, "question_id": 32496163, "link": "https://stackoverflow.com/questions/32496163/regular-expression-for-option-value-parse-from-select-tag", "title": "Regular Expression for OPTION value parse from Select tag", "body": "<p>What should be regex to OPTION</p>\n\n<p>I am using this </p>\n\n<pre><code>&lt;SELECT name=\"SELECT___F14CCNYCV___31\".*?&gt;\\s*?(.+)?\\s*?&lt;/SELECT&gt;\n</code></pre>\n\n<p>But result is Blank .. I want to use this Regex in GoLang.</p>\n\n<p>Html sample having New line and spaces</p>\n\n<p><strong>HTML Sample</strong></p>\n\n<pre><code>&lt;SELECT name=\"SELECT___F14CCNYCV___31\" onChange=\"change_option('SELECT___F14CCNYCV___31',this.options[this.selectedIndex].value)\"&gt;\n&lt;OPTION value=\"167\" &gt;0/3 months&lt;/OPTION&gt;\n&lt;OPTION value=\"169\" &gt;3/6 months&lt;/OPTION&gt;\n&lt;OPTION value=\"175\" &gt;6/9 months&lt;/OPTION&gt;\n&lt;/SELECT&gt;\n</code></pre>\n"}, {"tags": ["pointers", "memory", "go", "memory-address"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1441869301, "post_id": 32495402, "comment_id": 52850557, "body": "Read this: <a href=\"http://stackoverflow.com/questions/25294290/go-do-arrays-and-maps-have-to-be-different-concepts-features\">Go: Do arrays and maps have to be different concepts/features?</a>"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 4, "creation_date": 1441870701, "post_id": 32495402, "comment_id": 52851443, "body": "Unfortunately, nothing is special about taking the address of a slice element--if you keep using that first address after the slice grows (rather than running the code <code>&amp;a[2]</code> again post-<code>append</code>, as you&#39;re doing), you&#39;ll still have pointer into the old array, so you can&#39;t use it to see or make updates to the new array, and the old array is still reachable and so not garbage-collectable."}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1441871029, "post_id": 32495402, "comment_id": 52851654, "body": "fix address for map is more difficult than fixing address for array, i think."}, {"owner": {"reputation": 9594, "user_id": 448734, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/94ccfc629c6862b5950de3512742bcae?s=128&d=identicon&r=PG", "display_name": "Bryan", "link": "https://stackoverflow.com/users/448734/bryan"}, "edited": false, "score": 0, "creation_date": 1547153791, "post_id": 32495402, "comment_id": 95105083, "body": "See also <a href=\"https://stackoverflow.com/questions/32751537/why-do-i-get-a-cannot-assign-error-when-setting-value-to-a-struct-as-a-value-i\" title=\"why do i get a cannot assign error when setting value to a struct as a value i\">stackoverflow.com/questions/32751537/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 13457, "user_id": 954376, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/08PZK.jpg?s=128&g=1", "display_name": "NeoWang", "link": "https://stackoverflow.com/users/954376/neowang"}, "edited": false, "score": 0, "creation_date": 1441894036, "post_id": 32496031, "comment_id": 52867542, "body": "Thanks! How about struct fields? I can take the address of a field like this: <code>ptr := &amp;(object.Field1)</code>, but when I try to get the address from reflect, <code>CanAddr()</code> return false: I tried <code>reflect.ValueOf(object).FieldByName(&quot;Field1&quot;).CanAddr()</code> and <code>reflect.ValueOf(&amp;object).Elem().FieldByName(&quot;Field1&quot;).CanAdd&zwnj;&#8203;r()</code>, both returns false. Why?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 13457, "user_id": 954376, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/08PZK.jpg?s=128&g=1", "display_name": "NeoWang", "link": "https://stackoverflow.com/users/954376/neowang"}, "edited": false, "score": 2, "creation_date": 1441897536, "post_id": 32496031, "comment_id": 52870184, "body": "@NeoWang: because you&#39;re passing the value of object to reflect. You can ask another separate question if you still don&#39;t understand; it&#39;s not related to maps or slices."}, {"owner": {"reputation": 380, "user_id": 1296971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70cac3042002156797622eb0a9711fe3?s=128&d=identicon&r=PG", "display_name": "mugi", "link": "https://stackoverflow.com/users/1296971/mugi"}, "edited": false, "score": 1, "creation_date": 1543982346, "post_id": 32496031, "comment_id": 94110028, "body": "I don&#39;t think it is the correct answer. The address of slice elements may also change. But GO allows to take the address of slice elements. There is no dangling pointer in GO. All pointers are managed."}, {"owner": {"reputation": 11609, "user_id": 100237, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/05dddc8770b7d4f438c78a287da1c404?s=128&d=identicon&r=PG", "display_name": "pingw33n", "link": "https://stackoverflow.com/users/100237/pingw33n"}, "reply_to_user": {"reputation": 380, "user_id": 1296971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70cac3042002156797622eb0a9711fe3?s=128&d=identicon&r=PG", "display_name": "mugi", "link": "https://stackoverflow.com/users/1296971/mugi"}, "edited": false, "score": 0, "creation_date": 1574674195, "post_id": 32496031, "comment_id": 104301374, "body": "If you think about the address of the element as the address of the slot where this element is stored, maps are no longer that different from slices. In both cases you can observe different value after mutation, with map being different in that it&#39;s also possible to see zero value (like if the key would be missing). Arguably both behaviors lead to similar bugs, which are still less severe than data race bugs in general where interleaved read/writes start producing new values. As @mugi mentioned no dangling pointers are possible in absence of data races."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 11609, "user_id": 100237, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/05dddc8770b7d4f438c78a287da1c404?s=128&d=identicon&r=PG", "display_name": "pingw33n", "link": "https://stackoverflow.com/users/100237/pingw33n"}, "edited": false, "score": 0, "creation_date": 1574675810, "post_id": 32496031, "comment_id": 104302317, "body": "@pingw33n Maps and slices in Go are fundamental different according to the language specification. Also terms like &quot;address&quot; has a very well defined and concrete meaning in Go. There are no dangling pointers in Go even in the presence of data races."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 380, "user_id": 1296971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70cac3042002156797622eb0a9711fe3?s=128&d=identicon&r=PG", "display_name": "mugi", "link": "https://stackoverflow.com/users/1296971/mugi"}, "edited": false, "score": 0, "creation_date": 1574675909, "post_id": 32496031, "comment_id": 104302381, "body": "@mugi The address of a slice element does not &quot;change&quot; as the element is addressable. If you construct a new slice (e.g. via append) its elements will have different addresses but the address of the elements of the old slice do not change."}, {"owner": {"reputation": 11609, "user_id": 100237, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/05dddc8770b7d4f438c78a287da1c404?s=128&d=identicon&r=PG", "display_name": "pingw33n", "link": "https://stackoverflow.com/users/100237/pingw33n"}, "edited": false, "score": 0, "creation_date": 1574678325, "post_id": 32496031, "comment_id": 104303783, "body": "Go is memory safe only when there&#39;s no data races <a href=\"https://blog.stalkr.net/2015/04/golang-data-races-to-break-memory-safety.html\" rel=\"nofollow noreferrer\">blog.stalkr.net/2015/04/&hellip;</a>. This is something you can&#39;t avoid within current language semantics and implementation. /// Go specs defines &quot;addressable&quot; but doesn&#39;t add to &quot;address&quot; any special meaning. Address is just an offset in linear memory space and not a reference to specific identifiable value (despite in most cases it&#39;s the effective semantics). Aliasing allows simultaneous memory reads &amp; writes producing effects I described above. Non-addressable map seems an artificial restriction."}, {"owner": {"reputation": 764, "user_id": 1195013, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4ed7ee81265e8dcf1aa5738dc14f4049?s=128&d=identicon&r=PG", "display_name": "Valer", "link": "https://stackoverflow.com/users/1195013/valer"}, "edited": false, "score": 0, "creation_date": 1613245866, "post_id": 32496031, "comment_id": 117018607, "body": "the address of <code>slice[x]</code> will change on reallocation of the underlying array. ofc, references to the old elements still remain intact. <a href=\"https://play.golang.org/p/pX6_wp0bvVE\" rel=\"nofollow noreferrer\">play.golang.org/p/pX6_wp0bvVE</a>"}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 31, "last_activity_date": 1441871213, "creation_date": 1441871213, "answer_id": 32496031, "question_id": 32495402, "link": "https://stackoverflow.com/questions/32495402/why-does-go-forbid-taking-the-address-of-map-member-yet-allows-slice-el/32496031#32496031", "title": "Why does Go forbid taking the address of (&amp;) map member, yet allows (&amp;) slice element?", "body": "<p>There is a major difference between slices and maps: Slices are backed by a backing array and maps are not.</p>\n\n<p>If a map grows or shrinks a potential pointer to a map element may become a dangling pointer pointing into nowhere (uninitialised memory). The problem here is not \"confusion of the user\" but that it would break a major design element of Go: No dangling pointers.</p>\n\n<p>If a slice runs out of capacity a new, larger backing array is created and the old backing array is copied into the new; and the old backing array <em>remains</em> <em>existing</em>. Thus any pointers obtained from the \"ungrown\" slice pointing into the old backing array are still valid pointers to valid memory.</p>\n\n<p>If you have a slice still pointing to the old backing array (e.g. because you made a copy of the slice before growing the slice beyond its capacity) you still access the old backing array. This has less to do with pointers of slice elements, but slices being views into arrays and the arrays being copied during slice growth.</p>\n\n<p>Note that there is no \"reducing the backing array of a slice\" during slice shrinkage.</p>\n"}, {"tags": [], "owner": {"reputation": 293, "user_id": 2098298, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f0cc2c45add2377604dc8295fcfe8d27?s=128&d=identicon&r=PG", "display_name": "user13097", "link": "https://stackoverflow.com/users/2098298/user13097"}, "is_accepted": false, "score": 4, "last_activity_date": 1520922922, "creation_date": 1520922922, "answer_id": 49249710, "question_id": 32495402, "link": "https://stackoverflow.com/questions/32495402/why-does-go-forbid-taking-the-address-of-map-member-yet-allows-slice-el/49249710#49249710", "title": "Why does Go forbid taking the address of (&amp;) map member, yet allows (&amp;) slice element?", "body": "<p>A fundamental difference between map and slice is that a map is a dynamic data structure that moves the values that it contains as it grows.  The specific implementation of Go map may even grow incrementally, a little bit during insert and delete operations until all values are moved to a bigger memory structure.  So you may delete a value and suddenly another value may move.  A slice on the other hand is just an interface/pointer to a subarray.  A slice never grows.  The append function may copy a slice into another slice with more capacity, but it leaves the old slice intact and is also a function instead of just an indexing operator.</p>\n\n<p>In the words of the map implementor himself:</p>\n\n<blockquote>\n  <p><a href=\"https://www.youtube.com/watch?v=Tl7mi9QmLns&amp;feature=youtu.be&amp;t=21m45s\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=Tl7mi9QmLns&amp;feature=youtu.be&amp;t=21m45s</a>\n  \"It interferes with this growing procedure, so if I take the address\n  of some entry in the bucket, and then I keep that entry around for a\n  long time and in the meantime the map grows, then all of a sudden that\n  pointer points to an old bucket and not a new bucket and that pointer\n  is now invalid, so it's hard to provide the ability to take the\n  address of a value in a map, without constraining how grow works...\n  C++ grows in a different way, so you can take the address of a bucket\"</p>\n</blockquote>\n\n<p>So, even though &amp;m[x] could have been allowed and would be useful for short-lived operations (do a modification to the value and then not use that pointer again), and in fact the map internally does that, I think the language designers/implementors chose to be on the safe side with map, not allowing &amp;m[x] in order to avoid subtle bugs with programs that might keep the pointer for a long time without realizing then it would point to different data than the programmer thought.</p>\n\n<p>See also <a href=\"https://stackoverflow.com/questions/49202077/why-doesnt-go-allow-taking-the-address-of-map-value\">Why doesn&#39;t Go allow taking the address of map value?</a> for related comments.</p>\n"}], "owner": {"reputation": 13457, "user_id": 954376, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/08PZK.jpg?s=128&g=1", "display_name": "NeoWang", "link": "https://stackoverflow.com/users/954376/neowang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10235, "favorite_count": 14, "accepted_answer_id": 32496031, "answer_count": 2, "score": 28, "last_activity_date": 1554156420, "creation_date": 1441869141, "last_edit_date": 1554156420, "question_id": 32495402, "link": "https://stackoverflow.com/questions/32495402/why-does-go-forbid-taking-the-address-of-map-member-yet-allows-slice-el", "title": "Why does Go forbid taking the address of (&amp;) map member, yet allows (&amp;) slice element?", "body": "<p>Go doesn't allow taking the address of a map member:</p>\n\n<pre><code>// if I do this:\np := &amp;mm[\"abc\"]\n// Syntax Error - cannot take the address of mm[\"abc\"]\n</code></pre>\n\n<p>The rationale is that if Go allows taking this address, when the map backstore grows or shinks, the address can become invalid, confusing the user.</p>\n\n<p>But Go slice gets relocated when it outgrows its capacity, yet, Go allows us to take the address of a slice element:</p>\n\n<pre><code> a := make([]Test, 5)\n a[0] = Test{1, \"dsfds\"}\n a[1] = Test{2, \"sdfd\"}\n a[2] = Test{3, \"dsf\"}\n\n addr1 := reflect.ValueOf(&amp;a[2]).Pointer()\n fmt.Println(\"Address of a[2]: \", addr1)\n\n a = append(a, Test{4, \"ssdf\"})\n addrx := reflect.ValueOf(&amp;a[2]).Pointer()\n fmt.Println(\"Address of a[2] After Append:\", addrx)\n\n // Note after append, the first address is invalid\n Address of a[2]:  833358258224\n Address of a[2] After Append: 833358266416\n</code></pre>\n\n<p>Why is Go designed like this? What is special about taking address of slice element?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 2, "creation_date": 1441866029, "post_id": 32493677, "comment_id": 52848812, "body": "you are using two package Gorilla and Pongo, of course you need write some code to glue them together. or please make the question more specific"}, {"owner": {"reputation": 3964, "user_id": 5288071, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/hdcFK.png?s=128&g=1", "display_name": "zola", "link": "https://stackoverflow.com/users/5288071/zola"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1441867075, "post_id": 32493677, "comment_id": 52849370, "body": "I have updated the question"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1441873341, "post_id": 32493677, "comment_id": 52853113, "body": "Having to pull the User from the context and pass it to the template isn&#39;t odd \u2014 that&#39;s 4 lines of code in the handler? There really isn&#39;t a way to &#39;simplify&#39; this."}, {"owner": {"reputation": 3964, "user_id": 5288071, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/hdcFK.png?s=128&g=1", "display_name": "zola", "link": "https://stackoverflow.com/users/5288071/zola"}, "edited": false, "score": 0, "creation_date": 1441873868, "post_id": 32493677, "comment_id": 52853439, "body": "it makes a difference when there are potentially 100s of request handlers."}], "answers": [{"comments": [{"owner": {"reputation": 3964, "user_id": 5288071, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/hdcFK.png?s=128&g=1", "display_name": "zola", "link": "https://stackoverflow.com/users/5288071/zola"}, "edited": false, "score": 0, "creation_date": 1441872253, "post_id": 32495328, "comment_id": 52852414, "body": "Tried it but pongo2.Context doesn&#39;t support indexing, it does have an update method that takes another pongo2.Context though, i don&#39;t know what i can do with that"}, {"owner": {"reputation": 3964, "user_id": 5288071, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/hdcFK.png?s=128&g=1", "display_name": "zola", "link": "https://stackoverflow.com/users/5288071/zola"}, "edited": false, "score": 0, "creation_date": 1441874719, "post_id": 32495328, "comment_id": 52853988, "body": "Great but because <code>context.GetAll()</code> returns <code>map[interface{}]interface{}</code>, it needs type assertion before the key can be converted to string, problem is, when i try to assert it, it panics saying <b>interface conversion: interface is mux.contextKey, not string</b>"}, {"owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "edited": false, "score": 0, "creation_date": 1441875713, "post_id": 32495328, "comment_id": 52854671, "body": "@JiangYD Should that be <code>if str, ok := key.(string); ok {</code> ?"}], "tags": [], "owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "is_accepted": true, "score": 1, "last_activity_date": 1441875774, "last_edit_date": 1441875774, "creation_date": 1441868842, "answer_id": 32495328, "question_id": 32493677, "link": "https://stackoverflow.com/questions/32493677/how-to-pass-data-to-template-automatically-in-go/32495328#32495328", "title": "How to pass data to template automatically in Go?", "body": "<p>invoke <code>MyExecute(req, tpl)</code> instead of <code>tpl.Execute(data)</code></p>\n\n<pre><code>func MyExecute(req *http.Request, tpl TemplateSet) (string, error){\n    gorillaObj := context.GetAll(req)\n    pongoObj := make(map[string]interface{})\n\n    for key, value := range gorillaObj {\n        if str, ok := key.(string); ok{\n            pongoObj[str] = value\n        }\n    }\n\n    return tpl.Execute(pongo2.Context(pongoObj))\n}\n</code></pre>\n\n<p>not tested, it should work.\nthe most problem is that gorilla use <code>map[interface{}]interface{}</code> as store, but pongo use <code>map[string]interface{}</code>, note not to use non-string as key in gorilla context.</p>\n"}], "owner": {"reputation": 3964, "user_id": 5288071, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/hdcFK.png?s=128&g=1", "display_name": "zola", "link": "https://stackoverflow.com/users/5288071/zola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 584, "favorite_count": 0, "accepted_answer_id": 32495328, "answer_count": 1, "score": 0, "last_activity_date": 1441875774, "creation_date": 1441862206, "last_edit_date": 1441874340, "question_id": 32493677, "link": "https://stackoverflow.com/questions/32493677/how-to-pass-data-to-template-automatically-in-go", "title": "How to pass data to template automatically in Go?", "body": "<p>Right now i am using <a href=\"http://www.gorillatoolkit.org/pkg/context\" rel=\"nofollow\">Gorilla context</a> package to pass data around in my middlewares &amp; controllers, but what i want to do is pass the data directly to my <a href=\"https://github.com/flosch/pongo2\" rel=\"nofollow\">Pongo2</a> template so later in my controller i don't have to get the data from the Gorilla context and manually pass it to the template context, for those of you familiar with express.js it would be like</p>\n\n<pre><code>var user = {\n    name: \"Name\",\n    age: 0\n}\n\nresponse.locals = user\n</code></pre>\n\n<p>Edit: So every pongo2 template needs access to a User object, right now i fetch the user from database using middleware and using Gorilla context pass the data to my controller, from there on to my template on each controller but what i want to do is pass the User object to template from my middleware instead of using Gorilla context.</p>\n\n<pre><code>func UserMiddleware(next http.HandlerFunc) http.HandlerFunc {\n    return http.HandlerFunc(func(res http.ResponseWriter, req *http.Request) {\n\n       user := &amp;User{} // user will normally be fetched from database\n       context.Set(req, \"user\", user)\n       next.ServeHTTP(res, req)\n    })\n}\n</code></pre>\n\n<p>Then In My Request Handler</p>\n\n<pre><code>func Handler(res http.ResponseWriter, req *http.Request) {\n    tpl, _ := pongo2.FromFile(\"view/template.html\")\n    user := context.Get(req, \"user\").(*User)\n    data := pongo2.Context{\n       \"user\": user,\n    }\n    out, _ := tpl.Execute(data)\n    res.Write([]byte(out))\n}\n</code></pre>\n\n<p>For all of my handlers i have to pass in user to template like that, but i want to pass it in from my middleware so that i don't have to do it in each of my handlers.</p>\n"}]