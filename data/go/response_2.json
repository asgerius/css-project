[{"tags": ["google-app-engine", "go"], "answers": [{"tags": [], "owner": {"reputation": 5222, "user_id": 818420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6a3ae1214b4d2450f85a2039c38af7f1?s=128&d=identicon&r=PG", "display_name": "Toni C&#225;rdenas", "link": "https://stackoverflow.com/users/818420/toni-c%c3%a1rdenas"}, "is_accepted": true, "score": 3, "last_activity_date": 1421875875, "creation_date": 1421875875, "answer_id": 28077220, "question_id": 28077155, "link": "https://stackoverflow.com/questions/28077155/package-imports/28077220#28077220", "title": "Package imports", "body": "<p>Yes. Imports work per file, not per package.</p>\n\n<p>I recommend <a href=\"http://godoc.org/golang.org/x/tools/cmd/goimports\" rel=\"nofollow\">installing <code>goimports</code></a> to handle imports for you.</p>\n"}], "owner": {"reputation": 1689, "user_id": 3791027, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a240d8bb3d536a1ecc16adf28f7b1feb?s=128&d=identicon&r=PG&f=1", "display_name": "RockNinja", "link": "https://stackoverflow.com/users/3791027/rockninja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 28077220, "answer_count": 1, "score": 1, "last_activity_date": 1421875875, "creation_date": 1421875599, "question_id": 28077155, "link": "https://stackoverflow.com/questions/28077155/package-imports", "title": "Package imports", "body": "<p>I have one <code>package</code> called <code>model</code> and two files which both are using the model package (user.go, task.go).</p>\n\n<p>My question: In both files I am importing the <code>appengine</code> and <code>appengine\\datasotre</code> libs, do I need to do so?, or there is a better way of doing this?</p>\n\n<p>user.go</p>\n\n<pre><code>package model\n\nimport \"appengine\"\nimport \"appengine/datastore\"\n\n\ntype User struct {\n  name\n}\nfunc (u *User) Save(c appengine.Context) (*User, error){\n}\n</code></pre>\n\n<p>task.go</p>\n\n<pre><code>package model\nimport \"appengine\"\nimport \"appengine/datastore\"\n\ntype Task struct {\n  name\n}\n\nfunc (u *Task) Save(c appengine.Context) (*Task, error){\n}\n</code></pre>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "answers": [{"tags": [], "owner": {"reputation": 75, "user_id": 1271628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/210b281435b306783d0f6a312fd15a18?s=128&d=identicon&r=PG", "display_name": "Ian Childress", "link": "https://stackoverflow.com/users/1271628/ian-childress"}, "is_accepted": false, "score": 2, "last_activity_date": 1421871242, "creation_date": 1421871242, "answer_id": 28076032, "question_id": 28075872, "link": "https://stackoverflow.com/questions/28075872/google-cloud-datastore-is-storing-a-float-as-an-int-if-it-doesnt-have-a-decimal/28076032#28076032", "title": "Google Cloud Datastore is storing a float as an int if it doesn&#39;t have a decimal, how do I parse it?", "body": "<p>It appears this is specific to using the Developer's Console. The only option under the Developer's Console for a number is \"is a number\" which automatically saves it with it'd predicted type.</p>\n\n<p>If you save the entity using Put in your Go app, it will store it as type float64 and also pull it out as a float64. </p>\n"}], "owner": {"reputation": 75, "user_id": 1271628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/210b281435b306783d0f6a312fd15a18?s=128&d=identicon&r=PG", "display_name": "Ian Childress", "link": "https://stackoverflow.com/users/1271628/ian-childress"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1421871294, "creation_date": 1421870644, "last_edit_date": 1421871294, "question_id": 28075872, "link": "https://stackoverflow.com/questions/28075872/google-cloud-datastore-is-storing-a-float-as-an-int-if-it-doesnt-have-a-decimal", "title": "Google Cloud Datastore is storing a float as an int if it doesn&#39;t have a decimal, how do I parse it?", "body": "<p>For testing I am using the developer's console and entering an entity of kind Account into the datastore. </p>\n\n<pre><code>type Account struct {\nBalance      float64\nUserid       int}\n</code></pre>\n\n<p>If I input a Balance amount of 10 I get the following when using my Go app to \"Get\" the entity.</p>\n\n<pre><code>Balance:0 Userid:1\n</code></pre>\n\n<p>However, if I change Balance to 10.1 then I get the expected result</p>\n\n<pre><code>Balance:10.1 Userid:1\n</code></pre>\n\n<p>This is somewhat expected. However, if I store a float without anything after the decimal it is turned into type INT. In this scenario if I have a balance without a decimal like 1.00 it won't load into my struct. (It will drop the two 00's)</p>\n"}, {"tags": ["go", "package"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 2, "last_activity_date": 1421864407, "last_edit_date": 1495540619, "creation_date": 1421864407, "answer_id": 28074120, "question_id": 28074013, "link": "https://stackoverflow.com/questions/28074013/use-custom-go-packages/28074120#28074120", "title": "use custom Go packages", "body": "<blockquote>\n  <p>Now I'd like to import my <code>package1</code> in <code>package2</code>, I know I can use my published code on github using <code>go get</code></p>\n</blockquote>\n\n<p>It doesn't have to be published on github.<br>\nThe import path just has to be a valid path within your <strong><a href=\"https://golang.org/doc/code.html#Workspaces\" rel=\"nofollow noreferrer\">workspace</a></strong> (<code>$GOPATH</code>)</p>\n\n<pre><code>import \"github.com/myusername/myfirstrepo/somefolder1/package1\"\n</code></pre>\n\n<p>Relative paths are <a href=\"https://stackoverflow.com/a/21616792/6309\">not the best practice</a> (unless you really need to <a href=\"https://stackoverflow.com/a/26816170/6309\">access your functions without classifier</a>).</p>\n"}], "owner": {"reputation": 7273, "user_id": 2641547, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/660520007/picture?type=large", "display_name": "Spearfisher", "link": "https://stackoverflow.com/users/2641547/spearfisher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 1, "accepted_answer_id": 28074120, "answer_count": 1, "score": 2, "last_activity_date": 1421865244, "creation_date": 1421863965, "last_edit_date": 1421865244, "question_id": 28074013, "link": "https://stackoverflow.com/questions/28074013/use-custom-go-packages", "title": "use custom Go packages", "body": "<p>I have written some custom packages which I am struggling to reuse.</p>\n\n<p>My code is structured as follows:</p>\n\n<pre><code>$GOPATH/src/github.com/myusername/myfirstrepo/\n</code></pre>\n\n<p>In <code>myfirstrepo</code> I have 2 different packages:</p>\n\n<pre><code>myfirstrepo\n   |--somefolder1/package1\n   |--somefolder2/package2\n</code></pre>\n\n<p>Now I'd like to import my <code>package1</code> in <code>package2</code>, I know I can use my published code on github using <code>go get</code> but I'd like to know if it's possible to use something similar to <code>npm</code>:</p>\n\n<pre><code>import \"./../somefolder1/package1\"\n</code></pre>\n\n<p>Obviously I've tried this and it doesn't work. </p>\n\n<p>How can I simply do this?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1655, "user_id": 8682074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1739167192766622/picture?type=large", "display_name": "John Balvin Arias", "link": "https://stackoverflow.com/users/8682074/john-balvin-arias"}, "edited": false, "score": 2, "creation_date": 1537036068, "post_id": 28073807, "comment_id": 91640676, "body": "content-length can be tamper by malicious user, I would not use that"}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 1, "last_activity_date": 1421863214, "creation_date": 1421863214, "answer_id": 28073807, "question_id": 28073395, "link": "https://stackoverflow.com/questions/28073395/limiting-file-size-in-formfile/28073807#28073807", "title": "Limiting file size in FormFile", "body": "<p>You have <code>r.ContentLength int64</code> field in request struct and <code>r.Header.Get(\"Content-Length\") string</code> method. Maybe that can help.</p>\n"}, {"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 4, "last_activity_date": 1421864672, "last_edit_date": 1421864672, "creation_date": 1421863473, "answer_id": 28073878, "question_id": 28073395, "link": "https://stackoverflow.com/questions/28073395/limiting-file-size-in-formfile/28073878#28073878", "title": "Limiting file size in FormFile", "body": "<p>Calling <code>FormFile</code> calls <a href=\"http://golang.org/pkg/net/http/#Request.ParseMultipartForm\" rel=\"nofollow\"><code>ParseMultiPartForm</code></a>, which will parse the entire request body, using up to 32M by default before storing the contents in temporary files. You can call <code>ParseMultiPartForm</code> yourself before calling <code>FormFile</code> to determine how much memory to consume, but the body will still be parsed.</p>\n\n<p>Th client may provide a <code>Content-Length</code> header in the <a href=\"http://golang.org/pkg/mime/multipart/#FileHeader\" rel=\"nofollow\"><code>multipart.FileHeader</code></a> which you could use, but that is dependent on the client.</p>\n\n<p>If you want to limit the incoming request size, wrap the <code>request.Body</code> with <a href=\"http://golang.org/pkg/net/http/#MaxBytesReader\" rel=\"nofollow\"><code>MaxBytesReader</code></a> in your handler before parsing any of the Body.</p>\n"}, {"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1488801373, "post_id": 28074084, "comment_id": 72377818, "body": "<code>http.MaxBytesReader()</code> expects an <code>io.ReadCloser</code>, so <code>r.Body</code> should be passed instead of just <code>r</code>: <code>r.Body = http.MaxBytesReader(w, r.Body, max)</code>"}, {"owner": {"reputation": 50646, "user_id": 99923, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/211755e2897f699737d63f5e2ecf5b07?s=128&d=identicon&r=PG", "display_name": "Xeoncross", "link": "https://stackoverflow.com/users/99923/xeoncross"}, "edited": false, "score": 0, "creation_date": 1518312808, "post_id": 28074084, "comment_id": 84453702, "body": "This will limit the total request (including all fields + headers + files combined). If you only want to limit each file (and not the number of files) use <a href=\"https://golang.org/pkg/net/http/#Request.ParseMultipartForm\" rel=\"nofollow noreferrer\">r.ParseMultipartForm(MaxSize)</a>. Keep in mind you might need both to be safe from attackers uploading 100 different 10MB files in one request."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 15, "last_activity_date": 1619194636, "last_edit_date": 1619194636, "creation_date": 1421864252, "answer_id": 28074084, "question_id": 28073395, "link": "https://stackoverflow.com/questions/28073395/limiting-file-size-in-formfile/28074084#28074084", "title": "Limiting file size in FormFile", "body": "<p>Use <a href=\"https://pkg.go.dev/net/http#MaxBytesReader\" rel=\"nofollow noreferrer\">http.MaxBytesReader</a> to limit the number of bytes read from the request.  Before calling ParseMultiPartForm or FormFile, execute this line:</p>\n<pre><code> r.Body = http.MaxBytesReader(w, r.Body, max)\n</code></pre>\n<p>where <code>r</code> is the <code>*http.Request</code> and <code>w</code> is the <code>http.Response</code>.</p>\n<p>MaxBytesReader limits the bytes read for the <em>entire</em> request body and not an individual file. A limit on the request body size can be a good approximation of a limit on the file size when there's only one file upload. If you need to enforce a specific limit for one or more files, then set the MaxBytesReader limit large enough for all expected request data and check <a href=\"https://pkg.go.dev/mime/multipart#FileHeader.Size\" rel=\"nofollow noreferrer\">FileHeader.Size</a> for each file.</p>\n<p>When the http.MaxBytesReader limit is breached, the server stops reading from the request and closes the connection after the handler returns.</p>\n<p>If you want to limit the amount of memory used instead of the request body size, then call <a href=\"https://golang.org/pkg/net/http/#Request.ParseMultipartForm\" rel=\"nofollow noreferrer\">r.ParseMultipartForm(maxMemory)</a> before calling <code>r.FormFile()</code>. This will use up to <code>maxMemory</code> bytes for file parts, with the remainder stored in temporary files on disk. This call does not limit the total number of bytes read from the client or the size of an uploaded file.</p>\n<p>Checking the <a href=\"https://pkg.go.dev/net/http#Request.ContentLength\" rel=\"nofollow noreferrer\">request Content-Length</a> header does not work for two reasons:</p>\n<ul>\n<li>The content length is not set for chunked request bodies.</li>\n<li>The server may read the entire request body to support connection keep-alive.  Breaching the MaxBytesReader limit is the only way to ensure that the server stops reading the request body.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 78, "user_id": 15697984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f45828b3cf3a025d311d8f7546fb052?s=128&d=identicon&r=PG", "display_name": "Hannah89", "link": "https://stackoverflow.com/users/15697984/hannah89"}, "edited": false, "score": 0, "creation_date": 1619227720, "post_id": 38175993, "comment_id": 118849354, "body": "Because the net/http server limits read on the request body to the length specified in the content-length header, a malicious client does not gain anything by specifying small content-length.  That said, MaxBytesReader is the way to go."}], "tags": [], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "is_accepted": false, "score": 9, "last_activity_date": 1467597472, "creation_date": 1467597472, "answer_id": 38175993, "question_id": 28073395, "link": "https://stackoverflow.com/questions/28073395/limiting-file-size-in-formfile/38175993#38175993", "title": "Limiting file size in FormFile", "body": "<p>Some people are suggesting to rely on <code>Content-Length</code> header and I have to warn you not to use it at all. This header can be any number because it can be changed by a client regardless of the actual file size.</p>\n\n<p>Use <a href=\"https://golang.org/pkg/net/http/#MaxBytesReader\" rel=\"noreferrer\">MaxBytesReader</a> because:</p>\n\n<blockquote>\n  <p>MaxBytesReader prevents clients from accidentally or maliciously\n  sending a large request and wasting server resources.</p>\n</blockquote>\n\n<p>Here is an example:</p>\n\n<pre><code>r.Body = http.MaxBytesReader(w, r.Body, 2 * 1024 * 1024) // 2 Mb\nclientFile, handler, err := r.FormFile(formDataKey)\nif err != nil {\n    log.Println(err)\n    return\n}\n</code></pre>\n\n<p>If your request body is bigger than 2 Mb, you will see something like this: <code>multipart: NextPart: http: request body too large</code></p>\n"}], "owner": {"reputation": 1560, "user_id": 830610, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/6ad4beaa5454a99a1d3a581302f7d6af?s=128&d=identicon&r=PG", "display_name": "John Montague", "link": "https://stackoverflow.com/users/830610/john-montague"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7388, "favorite_count": 4, "answer_count": 4, "score": 8, "last_activity_date": 1619194636, "creation_date": 1421861594, "last_edit_date": 1619057338, "question_id": 28073395, "link": "https://stackoverflow.com/questions/28073395/limiting-file-size-in-formfile", "title": "Limiting file size in FormFile", "body": "<p>I'm letting users upload a file using FormFile.  At what point should I check if the file size is too large.  When I do</p>\n<pre><code> file, header, fileErr := r.FormFile(&quot;file&quot;)\n</code></pre>\n<p>A file object is already created.  So have I incurred the cost of reading in the entire file already?</p>\n<p><a href=\"https://golang.org/pkg/net/http#Request.FormFile\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/http#Request.FormFile</a></p>\n"}, {"tags": ["go", "gorilla"], "comments": [{"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 0, "creation_date": 1421855219, "post_id": 28070923, "comment_id": 44521832, "body": "What you want is called Middleware in this context, also see <a href=\"http://www.alexedwards.net/blog/making-and-using-middleware\" rel=\"nofollow noreferrer\">alexedwards.net/blog/making-and-using-middleware</a>"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 7, "last_activity_date": 1502105603, "last_edit_date": 1502105603, "creation_date": 1421854845, "answer_id": 28071147, "question_id": 28070923, "link": "https://stackoverflow.com/questions/28070923/golang-net-http-and-gorilla-run-code-before-handler/28071147#28071147", "title": "Golang net/http and Gorilla: run code before handler", "body": "<p>Create a handler that invokes another handler after checking the IP address:</p>\n\n<pre><code>type checker struct {\n   h http.Handler\n}\n\nfunc (c checker) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n   if blackListed(r.RemoteAddr) {\n      http.Error(w, \"not authorized\", http.StatusForbidden)\n      return\n   }\n   c.h.ServeHTTP(w, r)\n}\n</code></pre>\n\n<p>Pass this handler to ListenAndServe instead of your original handler. For example, if you had:</p>\n\n<pre><code>err := http.ListenAndServe(addr, mux)\n</code></pre>\n\n<p>change the code to</p>\n\n<pre><code>err := http.ListenAndServe(addr, checker{mux})\n</code></pre>\n\n<p>This also applies to all the variations of ListenAndServe. It works with http.ServeMux, Gorilla mux and other routers.</p>\n"}, {"tags": [], "owner": {"reputation": 37028, "user_id": 59198, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6448b40e7037dd0fda767f2370c31809?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/59198/chris"}, "is_accepted": false, "score": 0, "last_activity_date": 1559089642, "creation_date": 1559089642, "answer_id": 56351611, "question_id": 28070923, "link": "https://stackoverflow.com/questions/28070923/golang-net-http-and-gorilla-run-code-before-handler/56351611#56351611", "title": "Golang net/http and Gorilla: run code before handler", "body": "<p>If you want to use the default muxer, which i find is common, you can create middleware like so:</p>\n\n<pre><code>func mustBeLoggedIn(handler func(http.ResponseWriter, *http.Request)) func(http.ResponseWriter, *http.Request) {\n    return func(w http.ResponseWriter, r *http.Request) {\n        // Am i logged in?\n        if ...not logged in... {\n            http.Error(w, err.Error(), http.StatusUnauthorized)\n            return\n        }\n        // Pass through to the original handler.\n        handler(w, r)\n    }\n}\n</code></pre>\n\n<p>Use it like so:</p>\n\n<pre><code>http.HandleFunc(\"/some/priveliged/action\", mustBeLoggedIn(myVanillaHandler))\nhttp.ListenAndServe(\":80\", nil)\n</code></pre>\n"}], "owner": {"reputation": 4811, "user_id": 2874789, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/VKbXD.jpg?s=128&g=1", "display_name": "Christopher Shroba", "link": "https://stackoverflow.com/users/2874789/christopher-shroba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1090, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1559089642, "creation_date": 1421854248, "question_id": 28070923, "link": "https://stackoverflow.com/questions/28070923/golang-net-http-and-gorilla-run-code-before-handler", "title": "Golang net/http and Gorilla: run code before handler", "body": "<p>Is it possible using the net/http package and/or any of the gorilla libraries to make some code execute on EVERY URL before going to the handler?  For example, to check if a connection is coming from a black listed IP address?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 9369, "user_id": 71079, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3e302415f77b6c398abc0b16efc653f3?s=128&d=identicon&r=PG", "display_name": "Ralph Caraveo", "link": "https://stackoverflow.com/users/71079/ralph-caraveo"}, "edited": false, "score": 0, "creation_date": 1421857689, "post_id": 28067076, "comment_id": 44523611, "body": "Good question and good find, I&#39;ve never seen that written before."}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 1, "creation_date": 1422691978, "post_id": 28067076, "comment_id": 44858912, "body": "td; I find <code>(&lt;-chan Delivery)(deliveries)</code>  more confusing than  <code>&lt;-chan Delivery(deliveries)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 9, "last_activity_date": 1421842902, "creation_date": 1421842902, "answer_id": 28067138, "question_id": 28067076, "link": "https://stackoverflow.com/questions/28067076/what-does-chan-deliverydeliveries-do/28067138#28067138", "title": "What does `(&lt;-chan Delivery)(deliveries)` do?", "body": "<p>It's a <a href=\"http://golang.org/ref/spec#Conversions\" rel=\"noreferrer\">type conversion</a>. In your case, it converts <code>chan Delivery</code> (two-way channel of <code>Delivery</code> values) to <code>&lt;-chan Delivery</code> (receive-only channel of <code>Delivery</code> values).</p>\n"}, {"comments": [{"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 1, "creation_date": 1421943195, "post_id": 28067148, "comment_id": 44563177, "body": "The term &#39;read-only&#39; channel is a bit misleading; it&#39;s is better understood as the &#39;read-end&#39; of a channel (which has a &#39;write-end&#39; also)."}], "tags": [], "owner": {"reputation": 5222, "user_id": 818420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6a3ae1214b4d2450f85a2039c38af7f1?s=128&d=identicon&r=PG", "display_name": "Toni C&#225;rdenas", "link": "https://stackoverflow.com/users/818420/toni-c%c3%a1rdenas"}, "is_accepted": false, "score": 4, "last_activity_date": 1421842934, "creation_date": 1421842934, "answer_id": 28067148, "question_id": 28067076, "link": "https://stackoverflow.com/questions/28067076/what-does-chan-deliverydeliveries-do/28067148#28067148", "title": "What does `(&lt;-chan Delivery)(deliveries)` do?", "body": "<p>It is a <a href=\"http://golang.org/ref/spec#Conversions\" rel=\"nofollow\">type conversion</a>. Returns <code>deliveries</code> as a read-only channel.</p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 4, "last_activity_date": 1421843715, "creation_date": 1421843715, "answer_id": 28067403, "question_id": 28067076, "link": "https://stackoverflow.com/questions/28067076/what-does-chan-deliverydeliveries-do/28067403#28067403", "title": "What does `(&lt;-chan Delivery)(deliveries)` do?", "body": "<p>Its a type conversion from two-way channel to send-only channel and in case you provide it can be omitted. Conversion would be done implicitly.</p>\n"}], "owner": {"reputation": 10277, "user_id": 190446, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c544188078900e5d5976689949177f11?s=128&d=identicon&r=PG", "display_name": "S\u0142awosz", "link": "https://stackoverflow.com/users/190446/s%c5%82awosz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 3, "accepted_answer_id": 28067138, "answer_count": 3, "score": 7, "last_activity_date": 1424405028, "creation_date": 1421842725, "last_edit_date": 1424405028, "question_id": 28067076, "link": "https://stackoverflow.com/questions/28067076/what-does-chan-deliverydeliveries-do", "title": "What does `(&lt;-chan Delivery)(deliveries)` do?", "body": "<p>I found this line:</p>\n\n<pre><code>return (&lt;-chan Delivery)(deliveries), nil\n</code></pre>\n\n<p><a href=\"https://github.com/streadway/amqp/blob/master/channel.go#L1089\" rel=\"nofollow\">https://github.com/streadway/amqp/blob/master/channel.go#L1089</a></p>\n\n<p>What does it do? Why the double parentheses?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "edited": false, "score": 0, "creation_date": 1421857161, "post_id": 28066434, "comment_id": 44523242, "body": "The variable will live until the last line of main; however, the value of &#39;b&#39; will be mutated on your second call to addMulti(). This is typical of any programming language, and it has nothing to do with multiple returns."}], "answers": [{"comments": [{"owner": {"reputation": 1892, "user_id": 3158810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1ebf9e065f654642fecfee399b439030?s=128&d=identicon&r=PG&f=1", "display_name": "G4143", "link": "https://stackoverflow.com/users/3158810/g4143"}, "edited": false, "score": 0, "creation_date": 1421841302, "post_id": 28066563, "comment_id": 44512988, "body": "So could we change the code of the second call to addMulti(3, 4) so that it assigns the return values to a, b?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1892, "user_id": 3158810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1ebf9e065f654642fecfee399b439030?s=128&d=identicon&r=PG&f=1", "display_name": "G4143", "link": "https://stackoverflow.com/users/3158810/g4143"}, "edited": false, "score": 0, "creation_date": 1421841472, "post_id": 28066563, "comment_id": 44513085, "body": "@G4143 What and why do you want to change it? To keep the previous value of <code>b</code>? If so then simply use a new variable, for example: <code>c, d := addMulti(3, 4)</code>"}, {"owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "edited": false, "score": 0, "creation_date": 1421857232, "post_id": 28066563, "comment_id": 44523287, "body": "Probably worth noting that this has nothing to do with multiple return values--it could be as easily demonstrated with <code>b := 4</code> followed by <code>b = 5</code>. You&#39;re just mutating the value contained in the variable."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "edited": false, "score": 1, "creation_date": 1421857573, "post_id": 28066563, "comment_id": 44523535, "body": "@weberc2 Yes, this is true, but there is one important difference: with multiple return values the short variable declaration <code>:=</code> could be used which might be confusing what happens to the (existing) variable, while if there is only one return value, at the second call you can only use <code>=</code> to store its return value into an existing variable which is clear in that it is just an assignment (and not a (re)declaration)."}, {"owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "edited": false, "score": 0, "creation_date": 1421860800, "post_id": 28066563, "comment_id": 44525592, "body": "@icza Ah, I understand. Yeah, that is important. Maybe you could just mention that there is no difference despite the different operator."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 10, "last_activity_date": 1421841061, "creation_date": 1421841061, "answer_id": 28066563, "question_id": 28066434, "link": "https://stackoverflow.com/questions/28066434/golang-scope-of-multi-return-values-from-function/28066563#28066563", "title": "Golang: Scope of multi return values from function", "body": "<p>We're not talking about the scope of the return value of a function but rather the scope of the variable you assign the return value to.</p>\n\n<p>The <a href=\"http://golang.org/ref/spec#Declarations_and_scope\">scope</a> of the variable <code>b</code> in your case is the function body, from the point at which you declare it.</p>\n\n<p>At first you do it at this line:</p>\n\n<pre><code>a, b := addMulti(1, 2)\n</code></pre>\n\n<p>But then you use another <a href=\"http://golang.org/ref/spec#Short_variable_declarations\">Short Variable declaration</a> at this line:</p>\n\n<pre><code>c, b := addMulti(3, 4)\n</code></pre>\n\n<p>which - since <code>b</code> is already declared - just assigns a new value to it. <code>b</code> will be in scope until the end of your <code>main()</code> function. Quoting from the Go Language Specification:</p>\n\n<blockquote>\n  <p>Unlike regular variable declarations, a short variable declaration may redeclare variables provided they were originally declared earlier in the same block with the same type, and at least one of the non-blank variables is new. As a consequence, redeclaration can only appear in a multi-variable short declaration. <strong>Redeclaration does not introduce a new variable; it just assigns a new value to the original.</strong></p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 5222, "user_id": 818420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6a3ae1214b4d2450f85a2039c38af7f1?s=128&d=identicon&r=PG", "display_name": "Toni C&#225;rdenas", "link": "https://stackoverflow.com/users/818420/toni-c%c3%a1rdenas"}, "is_accepted": false, "score": 0, "last_activity_date": 1421841115, "creation_date": 1421841115, "answer_id": 28066583, "question_id": 28066434, "link": "https://stackoverflow.com/questions/28066434/golang-scope-of-multi-return-values-from-function/28066583#28066583", "title": "Golang: Scope of multi return values from function", "body": "<p>It's a normal variable inside a block. From <a href=\"http://golang.org/ref/spec#Declarations_and_scope\" rel=\"nofollow\">the spec</a>:</p>\n\n<blockquote>\n  <p>The scope of a constant or variable identifier declared inside a function begins at the end of the ConstSpec or VarSpec (ShortVarDecl for short variable declarations) and ends at the end of the innermost containing block.</p>\n</blockquote>\n\n<p>In the second call, you're just reassigning the value of the same <code>b</code> variable. Its scope is the same.</p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1421841372, "creation_date": 1421841372, "answer_id": 28066659, "question_id": 28066434, "link": "https://stackoverflow.com/questions/28066434/golang-scope-of-multi-return-values-from-function/28066659#28066659", "title": "Golang: Scope of multi return values from function", "body": "<p>The scope of b variable is <code>main.main()</code>. In second assignment  <code>c, b := addMulti(3, 4)</code> you introduce new variable c, and assign variable b introduced in first assignment. If you change second assignment to be <code>a, b := addMulti(3, 4)</code> same as first it want not to compile.</p>\n"}], "owner": {"reputation": 1892, "user_id": 3158810, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1ebf9e065f654642fecfee399b439030?s=128&d=identicon&r=PG&f=1", "display_name": "G4143", "link": "https://stackoverflow.com/users/3158810/g4143"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1304, "favorite_count": 2, "accepted_answer_id": 28066563, "answer_count": 3, "score": 1, "last_activity_date": 1421841372, "creation_date": 1421840661, "question_id": 28066434, "link": "https://stackoverflow.com/questions/28066434/golang-scope-of-multi-return-values-from-function", "title": "Golang: Scope of multi return values from function", "body": "<p>When a function returns more than one variable in Golang, what's the scope of the variables? In the code attached, I can't figure out the scope of b. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc addMulti(x, y int) (int, int) {\n    return (x + y), (x * y)\n}\n\nfunc main() {\n    //what is the scope of the b variable here?\n    a, b := addMulti(1, 2)\n\n    fmt.Printf(\"%d %d\\n\", a, b)\n\n    //what is the scope of the b variable here?\n    c, b := addMulti(3, 4)\n\n    fmt.Printf(\"%d %d\\n\", c, b)\n\n}   \n</code></pre>\n"}, {"tags": ["xml", "go"], "answers": [{"tags": [], "owner": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "is_accepted": true, "score": 3, "last_activity_date": 1421840038, "creation_date": 1421840038, "answer_id": 28066211, "question_id": 28064641, "link": "https://stackoverflow.com/questions/28064641/how-to-dynamically-change-the-xml-node/28066211#28066211", "title": "How to dynamically change the xml node?", "body": "<p>Here's a working example: <a href=\"http://play.golang.org/p/XNvXeU_H2D\" rel=\"nofollow\">Playground</a></p>\n\n<p>xml.Name has a field <code>Local</code> that contains the name for the tag.</p>\n\n<p>If you set the value of <code>Local</code> to <code>\"myrow\"</code> it will output the struct as <code>&lt;myrow r=\"...\"&gt;&lt;/myrow&gt;</code>.</p>\n\n<p>Also, you have to remove the xml tag from the <code>XMLName</code> field. When the xml packages sees this tag (<code>xml:\"row\"</code>) it will automatically name the tag <code>\"row\"</code>, no matter what <code>XMLName</code> contains.</p>\n"}, {"tags": [], "owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "is_accepted": false, "score": 1, "last_activity_date": 1421840157, "creation_date": 1421840157, "answer_id": 28066265, "question_id": 28064641, "link": "https://stackoverflow.com/questions/28064641/how-to-dynamically-change-the-xml-node/28066265#28066265", "title": "How to dynamically change the xml node?", "body": "<p>If you remove the annotation on the <code>XMLName</code> field of the struct, then you can change its value to adjust how the struct will be marshalled.  For instance:</p>\n\n<pre><code>r.XMLName = xml.Name{\"\", \"myrow\"}\n</code></pre>\n\n<p>Would set the element name to <code>myrow</code> with an empty namespace.  The annotation needs to be removed because it will take precedence over the value of <code>XMLName</code>.</p>\n\n<p>You can see the results of this here: <a href=\"http://play.golang.org/p/3hGbE5WO8D\" rel=\"nofollow\">http://play.golang.org/p/3hGbE5WO8D</a></p>\n"}], "owner": {"reputation": 285, "user_id": 3373877, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/532526780ffab7d05fae3a14045c3f8d?s=128&d=identicon&r=PG&f=1", "display_name": "user3373877", "link": "https://stackoverflow.com/users/3373877/user3373877"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1584, "favorite_count": 0, "accepted_answer_id": 28066211, "answer_count": 2, "score": 2, "last_activity_date": 1421840157, "creation_date": 1421835501, "question_id": 28064641, "link": "https://stackoverflow.com/questions/28064641/how-to-dynamically-change-the-xml-node", "title": "How to dynamically change the xml node?", "body": "<p>I am using golang to  change the xml node dynamically? some struct is as the following:</p>\n\n<pre><code>type Row struct {\nXMLName xml.Name `xml:\"row\"`\nR string `xml:\"r,attr,omitempty\"`\n}\n</code></pre>\n\n<p>after xml.Marshal(), it output maybe <code>\"&lt;row r=\"123\"&gt;&lt;/row&gt;\"</code>\nbut i want to change the <code>\"&lt;row&gt;&lt;/row&gt;\"</code> to <code>\"&lt;myrow&gt;&lt;/myrow&gt;\"</code> if some condition is true.</p>\n\n<p>how to dynamically change the xml node using golang?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1421832954, "post_id": 28063465, "comment_id": 44507982, "body": "Do you really intend to have <code>if rand == 3</code> in both <code>err3</code> and <code>err4</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1421832775, "post_id": 28063605, "comment_id": 44507884, "body": "I did <code>rand == 3</code> on functions err3 and err4 with consciously."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1421833677, "post_id": 28063605, "comment_id": 44508402, "body": "@zero_coding Edited my answer, included the 2 possible solutions."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1421834526, "last_edit_date": 1421834526, "creation_date": 1421832416, "answer_id": 28063605, "question_id": 28063465, "link": "https://stackoverflow.com/questions/28063465/how-can-i-avoid-deadlock/28063605#28063605", "title": "How can I avoid deadlock", "body": "<p>Since you wrote you intentionally used <code>rand == 3</code> in both <code>err3()</code> and <code>err4()</code>, there can be 2 solutions:</p>\n\n<h2>1. Increase the buffer size of the channel</h2>\n\n<p>Increase the buffer size of the <code>chErr</code> channel to at least 2 because in your program using <code>n = 3</code> might result 2 goroutines sending a value on the channel.</p>\n\n<h2>2. Use non-blocking send</h2>\n\n<p>Use a non-blocking channel send preferably in all of your <code>errX()</code> functions (but at least in <code>err3()</code> and <code>err4()</code> because they send on the same condition) with <code>select</code>:</p>\n\n<pre><code>select {\ncase chErr &lt;- errors.New(\"Error 3\"):\ndefault:\n}\n</code></pre>\n\n<p>This will try to send an <code>error</code> on the channel but if it is not ready (if it's full because another goroutine has already sent a value), the <code>default</code> case will be selected which does nothing.</p>\n\n<p>Try it out on <a href=\"http://play.golang.org/p/f8_IYjMkRm\" rel=\"nofollow\">Go Playground</a>.</p>\n\n<p>Note: this will \"lose\" one of the errors because the channel can only hold one error, but you read (receive) only one value from it anyway.</p>\n\n<p>You can read more about the non-blocking send in the <a href=\"http://blog.golang.org/go-concurrency-patterns-timing-out-and\" rel=\"nofollow\">Go Concurrency Patterns: Timing out, moving on</a> blog article.</p>\n"}, {"comments": [{"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 0, "creation_date": 1421914872, "post_id": 28063695, "comment_id": 44545948, "body": "<b>This is fundamentally wrong</b>. Adding buffering may work in certain cases but is a risky strategy. See my answer."}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "reply_to_user": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 0, "creation_date": 1421916647, "post_id": 28063695, "comment_id": 44546777, "body": "@Rick-777 With such a small example that the OP clearly threw together, I was unsure how I might explain the sorts of things you mention in your answer. So, I opted to answer the question as directly asked. I honestly find it difficult to apply larger patterns to such simple examples - feel free to provide one. I will certainly upvote you."}], "tags": [], "owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "is_accepted": true, "score": 3, "last_activity_date": 1421833011, "last_edit_date": 1421833011, "creation_date": 1421832678, "answer_id": 28063695, "question_id": 28063465, "link": "https://stackoverflow.com/questions/28063465/how-can-i-avoid-deadlock/28063695#28063695", "title": "How can I avoid deadlock", "body": "<p>Your program is deadlocking because your channels are full.</p>\n\n<p>Your channel size is one. You're then calling <code>wg.Wait()</code> .. which waits for 5 functions to be called. Now, once you get to <code>err3</code> .. <code>rand == 3</code> and therefore an error is passed on your channel.</p>\n\n<p>At this point, your channel is full and you've only ticked off 3 of your waitgroup items.</p>\n\n<p><code>err4</code> is called with the value 3 .. which also wants to put an error on your channel. At this point, it blocks - because your channel is full and nothing has been popped from it.</p>\n\n<p>So your main goroutine will block because your waitgroup will never be finished.</p>\n\n<p>The fix is indeed to make your channel buffer larger. That way, when the errors are attempting to be placed on the channel - it won't block, and your waitgroup has a chance to have all of its items ticked off.</p>\n"}, {"tags": [], "owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "is_accepted": false, "score": 3, "last_activity_date": 1421921438, "last_edit_date": 1495542505, "creation_date": 1421915145, "answer_id": 28084123, "question_id": 28063465, "link": "https://stackoverflow.com/questions/28063465/how-can-i-avoid-deadlock/28084123#28084123", "title": "How can I avoid deadlock", "body": "<p>Generally, do not fall into the trap of thinking that larger buffers fix deadlocks. This approach might work in certain specific cases but just isn't generally true.</p>\n\n<p>Deadlock is best addressed by understanding how goroutines depend on each other. Essentially, you must eliminate loops of communicating where there is a mutual dependency. The non-blocking send idea (see @izca's answer) is one helpful trick, but not the only one.</p>\n\n<p>There is a considerable body of knowledge on how to avoid deadlock/livelock. Much of it is from the days when Occam was popular in the '80s and '90s. There are a few special gems from people such as Jeremy Martin (<a href=\"http://wotug.ukc.ac.uk/parallel/theory/formal/csp/jeremy-martin/\" rel=\"nofollow noreferrer\">Design Strategy for Deadlock-Free\nConcurrent Systems</a>), Peter Welch (<a href=\"http://kar.kent.ac.uk/21094/1/HigherWelch.pdf\" rel=\"nofollow noreferrer\">Higher Level Paradigms</a>) and others.</p>\n\n<ol>\n<li><p>The client-server strategy is simple: describe your Go-routine\nnetwork as a set of communicating servers and their clients; ensure\nthat there are no loops in the network graph => deadlock is\neliminated.</p></li>\n<li><p>I/o-par is a way to form rings and toruses of Go-routines such that\nthere will not be a deadlock within the structure; this is a\nparticular case where loops <em>are</em> allowed but behave in a \ngeneral deadlock-free way.</p></li>\n</ol>\n\n<p>So, my strategy is to <em>reduce</em> the buffer sizes first, think about what's happening, fix the deadlocks. Then later, re-introduce buffers to improve performance, based on benchmarks. Deadlocks are caused by loops in the communication graph. Break the loops.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/15113410/when-to-use-a-buffered-channel/15144455#15144455\">Related answer</a></p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 28063695, "answer_count": 3, "score": 1, "last_activity_date": 1421921438, "creation_date": 1421831971, "last_edit_date": 1421832929, "question_id": 28063465, "link": "https://stackoverflow.com/questions/28063465/how-can-i-avoid-deadlock", "title": "How can I avoid deadlock", "body": "<p>Look at the following code snippet.</p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n    \"math/rand\"\n    \"runtime\"\n    \"sync\"\n    \"time\"\n)\n\nfunc random(min, max int) int {\n    rand.Seed(time.Now().Unix())\n    return rand.Intn(max-min) + min\n}\n\nfunc err1(rand int, chErr chan error, wg *sync.WaitGroup) {\n    if rand == 1 {\n        chErr &lt;- errors.New(\"Error 1\")\n    }\n\n    wg.Done()\n\n}\n\nfunc err2(rand int, chErr chan error, wg *sync.WaitGroup) {\n    if rand == 2 {\n        chErr &lt;- errors.New(\"Error 2\")\n    }\n    wg.Done()\n}\n\nfunc err3(rand int, chErr chan error, wg *sync.WaitGroup) {\n    if rand == 3 {\n        chErr &lt;- errors.New(\"Error 3\")\n    }\n    wg.Done()\n}\n\nfunc err4(rand int, chErr chan error, wg *sync.WaitGroup) {\n    if rand == 3 {\n        chErr &lt;- errors.New(\"Error 4\")\n    }\n    wg.Done()\n}\n\nfunc err5(rand int, chErr chan error, wg *sync.WaitGroup) {\n    if rand == 4 {\n        chErr &lt;- errors.New(\"Error 5\")\n    }\n    wg.Done()\n}\n\nfunc main() {\n\n    runtime.GOMAXPROCS(runtime.NumCPU())\n\n    chErr := make(chan error, 1)\n    wg := new(sync.WaitGroup)\n\n    //n := random(1, 8)\n    n := 3\n    fmt.Println(n)\n\n    wg.Add(5)\n    go err1(n, chErr, wg)\n    go err2(n, chErr, wg)\n    go err3(n, chErr, wg)\n    go err4(n, chErr, wg)\n    go err5(n, chErr, wg)\n\n    fmt.Println(\"Wait\")\n    wg.Wait()\n    select {\n    case err := &lt;-chErr:\n        fmt.Println(err)\n        close(chErr)\n    default:\n        fmt.Println(\"NO error, job done\")\n    }\n}\n</code></pre>\n\n<p>How can I avoid deadlock here? I could assign buffer length 2, but maybe it has more elegant way to solve the problem.</p>\n\n<p>I did rand == 3 on functions err3 and err4 with consciously.</p>\n"}, {"tags": ["http", "cookies", "go", "session-cookies"], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 136935, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7d9f3e54e4a94df9ac7668411ffb24b3?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/136935/tyler"}, "edited": false, "score": 0, "creation_date": 1421822161, "post_id": 28060823, "comment_id": 44503110, "body": "Yep, that did the trick. Even just adding the path in my code worked as well, although I kind of like your implementation better. Thanks!"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 347, "user_id": 136935, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7d9f3e54e4a94df9ac7668411ffb24b3?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/136935/tyler"}, "edited": false, "score": 2, "creation_date": 1421822540, "post_id": 28060823, "comment_id": 44503247, "body": "The code in the question does not handle the case where the client did not send the cookie.  Creating a new cookie is simpler."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1421821691, "last_edit_date": 1421821691, "creation_date": 1421821356, "answer_id": 28060823, "question_id": 28060767, "link": "https://stackoverflow.com/questions/28060767/how-to-remove-a-cookie-in-go/28060823#28060823", "title": "How to remove a cookie in Go", "body": "<p>Try this:</p>\n\n<pre><code>http.SetCookie(w, &amp;http.Cookie{\n     Name: \"login\",\n     MaxAge: -1,\n     Expires: time.Now().Add(-100 * time.Hour),// Set expires for older versions of IE\n     Path: pathUsedToSetCookie,\n})\n</code></pre>\n\n<p>where pathUsedToSetCookie is whatever path you used to create the original cookie.</p>\n\n<p>Do not reuse the request cookie. The Name field is the only field you need from the request cookie, but you know that already.</p>\n"}], "owner": {"reputation": 347, "user_id": 136935, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7d9f3e54e4a94df9ac7668411ffb24b3?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/136935/tyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 750, "favorite_count": 0, "accepted_answer_id": 28060823, "answer_count": 1, "score": 3, "last_activity_date": 1421821691, "creation_date": 1421821065, "question_id": 28060767, "link": "https://stackoverflow.com/questions/28060767/how-to-remove-a-cookie-in-go", "title": "How to remove a cookie in Go", "body": "<p>I've set a cookie and can see it in my browser. I couldn't find anyway to remove it. What I've tried was:</p>\n\n<pre><code>deleteCookie, _ := r.Cookie(\"login\")\ndeleteCookie.Value = \"\" \ndeleteCookie.MaxAge = -1\nhttp.SetCookie(w, deleteCookie)\n</code></pre>\n\n<p>But the cookie is still there with it's original value after running this code.</p>\n"}, {"tags": ["java", "concurrency", "go"], "comments": [{"owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 1, "creation_date": 1421819003, "post_id": 28060277, "comment_id": 44502054, "body": "<i>Is there something equivalent in Java?</i> Yes. <i>I would have thought it would be much more verbose to implement the same thing.</i> Quite possibly. My hourly rates are really almost unbelievably reasonable if you&#39;d like to find out for sure..."}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 0, "creation_date": 1421819004, "post_id": 28060277, "comment_id": 44502057, "body": "Technically yes, although I&#39;m not going to do it :-) have a look at <a href=\"http://www.ibm.com/developerworks/library/j-csp1/index.html\" rel=\"nofollow noreferrer\">ibm.com/developerworks/library/j-csp1/index.html</a> (there are also parts 2 and 3, llinked from that doc) Also <a href=\"http://www.cs.kent.ac.uk/projects/ofa/jcsp/\" rel=\"nofollow noreferrer\">cs.kent.ac.uk/projects/ofa/jcsp</a> and wikipedia article on the same <a href=\"http://en.wikipedia.org/wiki/JCSP\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/JCSP</a> ."}, {"owner": {"reputation": 2321, "user_id": 380161, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/89bc4ef62c589653ed0f0f8a66d7a24d?s=128&d=identicon&r=PG", "display_name": "Anupam Saini", "link": "https://stackoverflow.com/users/380161/anupam-saini"}, "edited": false, "score": 1, "creation_date": 1421820763, "post_id": 28060277, "comment_id": 44502630, "body": "This would be a good starting point:  <a href=\"http://stackoverflow.com/questions/22561110/equivalent-of-golang-channel-in-java\" title=\"equivalent of golang channel in java\">stackoverflow.com/questions/22561110/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 0, "last_activity_date": 1421840028, "creation_date": 1421840028, "answer_id": 28066206, "question_id": 28060277, "link": "https://stackoverflow.com/questions/28060277/concurrency-java-example-of-go/28066206#28066206", "title": "Concurrency Java example of Go", "body": "<p><code>Select</code> statement <strong><em>is</em></strong> the reason to introduce concurrency at language syntax level in Go. Concurrent function call can (and usually done) be implemented on library level  with helper function like <code>spawn( function())</code> and channels just as data structures with mutex or lock in most other languages. But <code>select</code> statement can't.</p>\n"}], "owner": {"reputation": 8564, "user_id": 841090, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/CYTJH.jpg?s=128&g=1", "display_name": "Passionate Engineer", "link": "https://stackoverflow.com/users/841090/passionate-engineer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 28066206, "answer_count": 1, "score": -1, "last_activity_date": 1421840028, "creation_date": 1421818421, "question_id": 28060277, "link": "https://stackoverflow.com/questions/28060277/concurrency-java-example-of-go", "title": "Concurrency Java example of Go", "body": "<p>I have below example of concurrency channels from <a href=\"https://gobyexample.com/non-blocking-channel-operations\" rel=\"nofollow\">GoByExamples</a></p>\n\n<p>Is there something equivalent in Java? I would have thought it would be much more verbose to implement the same thing.</p>\n\n<pre><code>// Basic sends and receives on channels are blocking.\n// However, we can use `select` with a `default` clause to\n// implement _non-blocking_ sends, receives, and even\n// non-blocking multi-way `select`s.\n\npackage main\n\nimport \"fmt\"\n\nfunc main() {\n    messages := make(chan string)\n    signals := make(chan bool)\n\n    // Here's a non-blocking receive. If a value is\n    // available on `messages` then `select` will take\n    // the `&lt;-messages` `case` with that value. If not\n    // it will immediately take the `default` case.\n    select {\n    case msg := &lt;-messages:\n        fmt.Println(\"received message\", msg)\n    default:\n        fmt.Println(\"no message received\")\n    }\n\n    // A non-blocking send works similarly.\n    msg := \"hi\"\n    select {\n    case messages &lt;- msg:\n        fmt.Println(\"sent message\", msg)\n    default:\n        fmt.Println(\"no message sent\")\n    }\n\n    // We can use multiple `case`s above the `default`\n    // clause to implement a multi-way non-blocking\n    // select. Here we attempt non-blocking receives\n    // on both `messages` and `signals`.\n    select {\n    case msg := &lt;-messages:\n        fmt.Println(\"received message\", msg)\n    case sig := &lt;-signals:\n        fmt.Println(\"received signal\", sig)\n    default:\n        fmt.Println(\"no activity\")\n    }\n}\n</code></pre>\n"}, {"tags": ["testing", "go"], "answers": [{"comments": [{"owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "edited": false, "score": 0, "creation_date": 1421815652, "post_id": 28059745, "comment_id": 44500944, "body": "Good find, way to beat me to the punch! :) +1"}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "reply_to_user": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "edited": false, "score": 0, "creation_date": 1421815992, "post_id": 28059745, "comment_id": 44501029, "body": "@weberc2 I think your answer provides better justification for the lack of prevalence in the std lib. That second quote pretty much sums up why they haven&#39;t gone through the std lib tests and &quot;parallelized&quot; them all."}], "tags": [], "owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "is_accepted": false, "score": 3, "last_activity_date": 1421815354, "creation_date": 1421815354, "answer_id": 28059745, "question_id": 28058640, "link": "https://stackoverflow.com/questions/28058640/what-is-the-practical-benefit-to-putting-t-parallel-at-the-top-of-my-tests/28059745#28059745", "title": "What is the practical benefit to putting t.Parallel() at the top of my tests?", "body": "<p>This seems to have been brought up first <a href=\"https://groups.google.com/d/topic/golang-dev/RAKiqi44GEU/discussion\" rel=\"nofollow\">on the golang-dev group</a>.</p>\n\n<p>The initial request states:</p>\n\n<blockquote>\n  <p>\"I'd like to add an option to run tests in parallel with gotest. \n  My motivation comes from running selenium tests where each test is pretty much independent from each other but they take time.\"</p>\n</blockquote>\n\n<p>The thread contains the discussion of the practical benefits.</p>\n\n<p>It's really just for allowing you to run unrelated, long-running tests at the same time. It's not really used in the standard library as almost all of the functionality needs to be as fast as possible (some crypto exceptions etc.)</p>\n\n<p>There was further discussion <a href=\"https://groups.google.com/d/topic/golang-dev/UVAoxc-k9DA/discussion\" rel=\"nofollow\">here</a> and the commit is <a href=\"https://code.google.com/p/go/source/detail?r=84bf0597069e\" rel=\"nofollow\">here</a></p>\n"}, {"tags": [], "owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "is_accepted": false, "score": 5, "last_activity_date": 1421851564, "last_edit_date": 1495541603, "creation_date": 1421815607, "answer_id": 28059787, "question_id": 28058640, "link": "https://stackoverflow.com/questions/28058640/what-is-the-practical-benefit-to-putting-t-parallel-at-the-top-of-my-tests/28059787#28059787", "title": "What is the practical benefit to putting t.Parallel() at the top of my tests?", "body": "<p><a href=\"https://groups.google.com/forum/#!msg/golang-dev/RAKiqi44GEU/WkD64zvPR_0J\" rel=\"nofollow noreferrer\">This thread</a> (in which <code>t.Parallel</code> is conceived and discussed) indicates that <strong><code>t.Parallel()</code> is intended to be used for slow tests only; average tests are so fast that any gain from parallel execution would be negligible.</strong></p>\n\n<p>Here are some quotes (only from Russ, but there wasn't much opposition):</p>\n\n<p><a href=\"https://stackoverflow.com/users/1537746/russ-cox\">Russ Cox</a> [<a href=\"https://groups.google.com/d/msg/golang-dev/RAKiqi44GEU/vl7eUYlQ65cJ\" rel=\"nofollow noreferrer\">link</a>]:</p>\n\n<blockquote>\n  <p>There is some question about what the right default is.\n  Most of our tests run so fast that parallelizing them is\n  unnecessary.  I think that's probably the right model,\n  which would suggest parallelizing is the exception,\n  not the rule.\n  As an exception, this can be accommodated having a\n      t.Parallel()\n  method that a test can call to declare that it is okay\n  to run in parallel with other tests.</p>\n</blockquote>\n\n<p>Russ Cox again [<a href=\"https://groups.google.com/d/msg/golang-dev/RAKiqi44GEU/EIzhfHHofdkJ\" rel=\"nofollow noreferrer\">link</a>]:</p>\n\n<blockquote>\n  <p>the non-parallel tests should be fast.  they're inconsequential.\n  if two tests are slow, then you can t.Parallel them if it bothers you.\n  if one test is slow, well, one test is slow.</p>\n</blockquote>\n"}], "owner": {"reputation": 48731, "user_id": 329700, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/41910a452554b187d044c00c576866b1?s=128&d=identicon&r=PG", "display_name": "Kevin Burke", "link": "https://stackoverflow.com/users/329700/kevin-burke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1421851564, "creation_date": 1421807506, "question_id": 28058640, "link": "https://stackoverflow.com/questions/28058640/what-is-the-practical-benefit-to-putting-t-parallel-at-the-top-of-my-tests", "title": "What is the practical benefit to putting t.Parallel() at the top of my tests?", "body": "<p>The go <code>testing</code> package defines <a href=\"http://golang.org/pkg/testing/#T.Parallel\" rel=\"nofollow\">a Parallel() function</a>:</p>\n\n<blockquote>\n  <p>Parallel signals that this test is to be run in parallel with (and only with) other parallel tests.</p>\n</blockquote>\n\n<p>However when I searched the tests written for the standard library, I found only a few uses of this function.</p>\n\n<p>My tests are pretty fast, and generally don't rely on mutating shared state, so I've been adding this, figuring it would lead to a speedup. But the fact it's not used in the standard library gives me pause. What is the practical benefit to adding <code>t.Parallel()</code> to your tests?</p>\n"}, {"tags": ["database", "go"], "comments": [{"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 3, "creation_date": 1421816260, "post_id": 28058534, "comment_id": 44501111, "body": "From <a href=\"https://golang.org/doc/effective_go.html#defer\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html#defer</a> &quot;Go&#39;s defer statement schedules a function call (the deferred function) to be run immediately before the function executing the defer returns. It&#39;s an unusual but effective way to deal with situations such as resources that must be released regardless of which path a function takes to return.&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 1993, "user_id": 623949, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cf441bdd92dabf1b772104901c78cf99?s=128&d=identicon&r=PG", "display_name": "tgrosinger", "link": "https://stackoverflow.com/users/623949/tgrosinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1421890194, "last_edit_date": 1421890194, "creation_date": 1421858234, "answer_id": 28072296, "question_id": 28058534, "link": "https://stackoverflow.com/questions/28058534/better-shorter-way-to-close-database-connection-in-go/28072296#28072296", "title": "Better/shorter way to close database connection in Go", "body": "<p>As mentioned by Intermernet, the defer statement is the best way to get the close statement closer to where the rows var is declared. The only way I can think of that might make this shorter or easier would be to create a wrapper function around your database call.</p>\n\n<pre><code>func performQuery(q string, op func(db.rows)) {\n    rows := db.MyPg.Conn.QueryRows(q)\n    // defer rows.Close()\n    op(rows)\n    rows.Close()\n}\n\n// then we could do:\nperformQuery(`SELECT * FROM bla`,func(rows db.Rows) {\n  for rows.Next() {\n    // rows.Scan(      \n  }\n})\n</code></pre>\n\n<p>This however would limit you from making queries with parameters (for example <code>SELECT * FROM tableName WHERE id = $1</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "is_accepted": false, "score": 6, "last_activity_date": 1421858329, "creation_date": 1421858329, "answer_id": 28072329, "question_id": 28058534, "link": "https://stackoverflow.com/questions/28058534/better-shorter-way-to-close-database-connection-in-go/28072329#28072329", "title": "Better/shorter way to close database connection in Go", "body": "<p>Go introduced <a href=\"https://golang.org/doc/effective_go.html#defer\" rel=\"noreferrer\"><code>defer</code></a> exactly for this purpose.</p>\n\n<pre><code>rows := db.MyPgConn.QueryRows(`SELECT * FROM bla`) // or any other query\ndefer rows.Close()\n\nfor rows.Next() { // if there are result\n   // rows.Scan( \n   // do custom operation\n}\n</code></pre>\n\n<p>From the documentation:</p>\n\n<blockquote>\n  <p>Deferring a call to a function such as <code>Close</code> has two advantages. First, it guarantees that you will never forget to close the file, a mistake that's easy to make if you later edit the function to add a new return path. Second, it means that the close sits near the open, which is much clearer than placing it at the end of the function.</p>\n</blockquote>\n"}], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2133, "favorite_count": 0, "accepted_answer_id": 28072296, "answer_count": 2, "score": 1, "last_activity_date": 1421890194, "creation_date": 1421806748, "question_id": 28058534, "link": "https://stackoverflow.com/questions/28058534/better-shorter-way-to-close-database-connection-in-go", "title": "Better/shorter way to close database connection in Go", "body": "<p>Usually I write something like this</p>\n\n<pre><code>rows := db.MyPgConn.QueryRows(`SELECT * FROM bla`) // or any other query\nfor rows.Next() { // if there are result\n   // rows.Scan( \n   // do custom operation\n}\nrows.Close() // close recordset\n</code></pre>\n\n<p>But that way, there are possibility that I forgot to write <code>rows.Close()</code> just like this <a href=\"http://golang.org/src/database/sql/sql.go?s=26261:26323#L991\" rel=\"nofollow\">code</a> that could make the number of available connection/socket depleted, is there better way to do this?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1079, "user_id": 112335, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a53edef395e43b93f8b0f7d662b72ca3?s=128&d=identicon&r=PG", "display_name": "Saulo Silva", "link": "https://stackoverflow.com/users/112335/saulo-silva"}, "edited": false, "score": 0, "creation_date": 1421806663, "post_id": 28058506, "comment_id": 44498630, "body": "That works! Now isn&#39;t the documentation is a bit misleading? It shows code like this: <code>tmpl.Execute(out, HTML(`&lt;b&gt;World&lt;&#47;b&gt;`))</code>."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 1079, "user_id": 112335, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a53edef395e43b93f8b0f7d662b72ca3?s=128&d=identicon&r=PG", "display_name": "Saulo Silva", "link": "https://stackoverflow.com/users/112335/saulo-silva"}, "edited": false, "score": 1, "creation_date": 1421806765, "post_id": 28058506, "comment_id": 44498659, "body": "Yes, the documentation is confusing and should be changed. File an issue at <a href=\"https://github.com/golang/go/issues\" rel=\"nofollow noreferrer\">github.com/golang/go/issues</a>."}, {"owner": {"reputation": 3230, "user_id": 1243064, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cfd730a0226e5295824a0a1d9224af24?s=128&d=identicon&r=PG", "display_name": "Wessie", "link": "https://stackoverflow.com/users/1243064/wessie"}, "edited": false, "score": 0, "creation_date": 1421837244, "post_id": 28058506, "comment_id": 44510638, "body": "Documentation is written in the context of the package, you do not need the full qualifier when using <code>HTML</code> from the <code>html&#47;template</code> package itself."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 3230, "user_id": 1243064, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cfd730a0226e5295824a0a1d9224af24?s=128&d=identicon&r=PG", "display_name": "Wessie", "link": "https://stackoverflow.com/users/1243064/wessie"}, "edited": false, "score": 1, "creation_date": 1421854507, "post_id": 28058506, "comment_id": 44521297, "body": "@Wessie, Yes, that&#39;s the perspective used for that section of documentation page. That&#39;s not the same perspective used elsewhere on the same page, nor is the best perspective for the intended audience of the page."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1421806534, "creation_date": 1421806534, "answer_id": 28058506, "question_id": 28058496, "link": "https://stackoverflow.com/questions/28058496/how-to-import-the-html-type/28058506#28058506", "title": "How to import the HTML type?", "body": "<p>Scope the types with the package name:</p>\n\n<p>package main</p>\n\n<pre><code>import (\n  \"fmt\"\n  \"html/template\"\n)\n\nfunc main() {\n   fmt.Println(template.HTML(`&lt;strong&gt;Hi&lt;/strong&gt;`))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/ij2WIP4mdX\" rel=\"nofollow\">playground example</a></p>\n"}], "owner": {"reputation": 1079, "user_id": 112335, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a53edef395e43b93f8b0f7d662b72ca3?s=128&d=identicon&r=PG", "display_name": "Saulo Silva", "link": "https://stackoverflow.com/users/112335/saulo-silva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 28058506, "answer_count": 1, "score": -1, "last_activity_date": 1421806534, "creation_date": 1421806475, "question_id": 28058496, "link": "https://stackoverflow.com/questions/28058496/how-to-import-the-html-type", "title": "How to import the HTML type?", "body": "<p>The <a href=\"http://golang.org/pkg/html/template/#hdr-Typed_Strings\" rel=\"nofollow\"><code>html/template</code> documentation</a> mentions an <code>HTML</code> type:</p>\n\n<blockquote>\n  <p>Types HTML, JS, URL, and others from content.go can carry safe content\n  that is exempted from escaping.</p>\n</blockquote>\n\n<p>How can I import and use it?</p>\n\n<p>I have tried the following code, which throws an \"undefined: HTML\" error (<a href=\"https://play.golang.org/p/hrrrp8d4jQ\" rel=\"nofollow\">Go Playground</a>):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"html/template\"\n)\n\nfunc main() {\n    fmt.Println(HTML(`&lt;strong&gt;Hi&lt;/strong&gt;`))\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 3, "creation_date": 1421830680, "post_id": 28058278, "comment_id": 44506696, "body": "Note that <code>sort.Reverse</code> doesn&#39;t reverse the slice: instead it will sort the slice in descending order."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 46, "last_activity_date": 1594399057, "last_edit_date": 1594399057, "creation_date": 1421805212, "answer_id": 28058324, "question_id": 28058278, "link": "https://stackoverflow.com/questions/28058278/how-do-i-reverse-a-slice-in-go/28058324#28058324", "title": "How do I reverse a slice in go?", "body": "<p>There is not a simple, built-in for reversing a slice of interface{}.  You can write a for loop to do it:</p>\n<pre><code>for i, j := 0, len(s)-1; i &lt; j; i, j = i+1, j-1 {\n    s[i], s[j] = s[j], s[i]\n}\n</code></pre>\n<p>Use the <a href=\"https://tip.golang.org/pkg/reflect/#Swapper\" rel=\"noreferrer\">reflect.Swapper</a> function introduced in Go 1.8 to write a generic reversing function:</p>\n<pre><code>func reverseAny(s interface{}) {\n    n := reflect.ValueOf(s).Len()\n    swap := reflect.Swapper(s)\n    for i, j := 0, n-1; i &lt; j; i, j = i+1, j-1 {\n        swap(i, j)\n    }\n}\n</code></pre>\n<p><a href=\"https://play.golang.org/p/oEJWgr721LH\" rel=\"noreferrer\">playground example</a></p>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 9903336, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VBCMNjUXsMM/AAAAAAAAAAI/AAAAAAAAADs/SzCIW3FXF9s/photo.jpg?sz=128", "display_name": "MIchael", "link": "https://stackoverflow.com/users/9903336/michael"}, "is_accepted": false, "score": 1, "last_activity_date": 1565861446, "creation_date": 1565861446, "answer_id": 57507614, "question_id": 28058278, "link": "https://stackoverflow.com/questions/28058278/how-do-i-reverse-a-slice-in-go/57507614#57507614", "title": "How do I reverse a slice in go?", "body": "<p>There are my code example, you can run it in <a href=\"https://play.golang.org/p/NikNBoUgwQq\" rel=\"nofollow noreferrer\">playground</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n    \"errors\"\n)\n\nfunc ReverseSlice(data interface{}) {\n    value := reflect.ValueOf(data)\n    if value.Kind() != reflect.Slice {\n        panic(errors.New(\"data must be a slice type\"))\n    }\n    valueLen := value.Len()\n    for i := 0; i &lt;= int((valueLen-1)/2); i++ {\n        reverseIndex := valueLen - 1 - i\n        tmp := value.Index(reverseIndex).Interface()\n        value.Index(reverseIndex).Set(value.Index(i))\n        value.Index(i).Set(reflect.ValueOf(tmp))\n    }\n}\n\n\nfunc main() {\n    names := []string{\"bob\", \"mary\", \"sally\", \"michael\"}\n    ReverseSlice(names)\n    fmt.Println(names)\n}\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 11153846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf237b33dfbed5086f1b08f665c4c74?s=128&d=identicon&r=PG&f=1", "display_name": "mzarrugh", "link": "https://stackoverflow.com/users/11153846/mzarrugh"}, "is_accepted": false, "score": 1, "last_activity_date": 1586902387, "creation_date": 1586902387, "answer_id": 61218109, "question_id": 28058278, "link": "https://stackoverflow.com/questions/28058278/how-do-i-reverse-a-slice-in-go/61218109#61218109", "title": "How do I reverse a slice in go?", "body": "<p>This will return a reversed slice without modifying the original slice.</p>\n\n<p>Algorithm used from official wiki page: <a href=\"https://github.com/golang/go/wiki/SliceTricks#reversing\" rel=\"nofollow noreferrer\">https://github.com/golang/go/wiki/SliceTricks#reversing</a></p>\n\n<pre><code>func reverse(s []interface{}) []interface{} {\n    a := make([]interface{}, len(s))\n    copy(a, s)\n\n    for i := len(a)/2 - 1; i &gt;= 0; i-- {\n        opp := len(a) - 1 - i\n        a[i], a[opp] = a[opp], a[i]\n    }\n\n    return a\n}\n</code></pre>\n"}], "owner": {"reputation": 2980, "user_id": 454196, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0fd6a92775b8ccdcf488bc686869d618?s=128&d=identicon&r=PG", "display_name": "Andrew C", "link": "https://stackoverflow.com/users/454196/andrew-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15322, "favorite_count": 3, "accepted_answer_id": 28058324, "answer_count": 3, "score": 16, "last_activity_date": 1594399057, "creation_date": 1421804843, "question_id": 28058278, "link": "https://stackoverflow.com/questions/28058278/how-do-i-reverse-a-slice-in-go", "title": "How do I reverse a slice in go?", "body": "<p>How do I reverse an arbitrary slice (<code>[]interface{}</code>) in Go? I'd rather not have to write <code>Less</code> and <code>Swap</code> to use <code>sort.Reverse</code>. Is there a simple, builtin way to do this?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "edited": false, "score": 0, "creation_date": 1421787562, "post_id": 28054913, "comment_id": 44491847, "body": "<a href=\"http://stackoverflow.com/questions/15945030/change-values-while-iterating-in-golang\" title=\"change values while iterating in golang\">stackoverflow.com/questions/15945030/&hellip;</a>"}, {"owner": {"reputation": 3829, "user_id": 1146334, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cL3do.png?s=128&g=1", "display_name": "FuriousGeorge", "link": "https://stackoverflow.com/users/1146334/furiousgeorge"}, "reply_to_user": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "edited": false, "score": 0, "creation_date": 1421788497, "post_id": 28054913, "comment_id": 44492286, "body": "I&#39;m confused by that link.  It seems like it says to use indexing, which I am doing."}], "answers": [{"comments": [{"owner": {"reputation": 3829, "user_id": 1146334, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cL3do.png?s=128&g=1", "display_name": "FuriousGeorge", "link": "https://stackoverflow.com/users/1146334/furiousgeorge"}, "edited": false, "score": 0, "creation_date": 1421788648, "post_id": 28055189, "comment_id": 44492357, "body": "That works, but is there a better way that doesn&#39;t involve creating a modified element and assigning back?  Can I just work with the original value?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 3829, "user_id": 1146334, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cL3do.png?s=128&g=1", "display_name": "FuriousGeorge", "link": "https://stackoverflow.com/users/1146334/furiousgeorge"}, "edited": false, "score": 4, "creation_date": 1421788873, "post_id": 28055189, "comment_id": 44492452, "body": "No, you cannot modify the value in an interface{}.  If you had a []Bar, then you could do z[i].Value = 42.  If put *Bars in the slice, then you could do b := q.(*Bar); b.Value = 42."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 6, "last_activity_date": 1421788799, "last_edit_date": 1421788799, "creation_date": 1421788187, "answer_id": 28055189, "question_id": 28054913, "link": "https://stackoverflow.com/questions/28054913/modify-array-of-interface-golang/28055189#28055189", "title": "Modify array of interface{} golang", "body": "<p>The program is modifying a copy of the value in the interface{}. One way to achieve your goal is to assign the modified value back to the slice:</p>\n\n<pre><code>for i, _ := range(z.([]interface{})) {      \n    q := z.([]interface{})[i]\n    b := (q).(Bar)\n    b.Value = 42\n    z.([]interface{})[i] = b\n    fmt.Printf(\"Changed to: %v\\n\", b)\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/XFDV4wxyj4\" rel=\"noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 3829, "user_id": 1146334, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cL3do.png?s=128&g=1", "display_name": "FuriousGeorge", "link": "https://stackoverflow.com/users/1146334/furiousgeorge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1837, "favorite_count": 1, "accepted_answer_id": 28055189, "answer_count": 1, "score": 3, "last_activity_date": 1421788799, "creation_date": 1421787148, "question_id": 28054913, "link": "https://stackoverflow.com/questions/28054913/modify-array-of-interface-golang", "title": "Modify array of interface{} golang", "body": "<p>This type assertion, def-referencing has been driving me crazy.  So I have a nested structure of <code>Key string / Value interface{}</code> pairs.  Stored in the <code>Value</code> is an <code>[]interface</code> which I want to modify each of the values.  Below is an example of creating an array of <code>Bar</code> and passing it into the <code>ModifyAndPrint</code> function which should modify the top level structure.  The problem that I come accross is as written it doesn't actually modify the contents of z, and I can't do a <code>q := z.([]interface{})[i].(Bar)</code> or <code>&amp;</code> thereof. </p>\n\n<p>Is there a way to do this? If so, what combination did I miss?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Bar struct {\n   Name string\n   Value int\n}\n\nfunc ModifyAndPrint(z interface{}){\n    fmt.Printf(\"z before: %v\\n\", z)\n    for i, _ := range(z.([]interface{})) {      \n        q := z.([]interface{})[i]\n        b := (q).(Bar)\n        b.Value = 42\n        fmt.Printf(\"Changed to: %v\\n\", b)\n    }\n    fmt.Printf(\"z after: %v\\n\", z)\n}\n\nfunc main() {       \n    bars := make([]interface{}, 2)\n    bars[0] = Bar{\"a\",1}\n    bars[1] = Bar{\"b\",2}\n\n    ModifyAndPrint(bars)    \n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/vh4QXS51tq\" rel=\"nofollow\">https://play.golang.org/p/vh4QXS51tq</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 1, "creation_date": 1421781174, "post_id": 28053105, "comment_id": 44488520, "body": "<a href=\"http://play.golang.org/p/6L6xsrWa2X\" rel=\"nofollow noreferrer\">play.golang.org/p/6L6xsrWa2X</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1421782275, "post_id": 28053105, "comment_id": 44489146, "body": "You can&#39;t convert it in one step as you expect it to be done."}], "answers": [{"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 2, "last_activity_date": 1421782606, "creation_date": 1421782606, "answer_id": 28053738, "question_id": 28053105, "link": "https://stackoverflow.com/questions/28053105/converting-a-slice-of-slices-in-go/28053738#28053738", "title": "Converting a slice of slices in Go?", "body": "<p>You should do for loop, but you can cheat a-little using std lib</p>\n\n<pre><code>byt := bytes.Join(a, []byte(sep))\nstr := strings.Split(string(byt), sep)\n</code></pre>\n\n<p>here is working example <a href=\"https://play.golang.org/p/QzySUsRMg6\" rel=\"nofollow\">https://play.golang.org/p/QzySUsRMg6</a></p>\n"}, {"tags": [], "owner": {"reputation": 12822, "user_id": 87750, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c9eb0c80f3b41463ed45f45584b065a9?s=128&d=identicon&r=PG", "display_name": "fredrik", "link": "https://stackoverflow.com/users/87750/fredrik"}, "is_accepted": false, "score": 2, "last_activity_date": 1421797690, "creation_date": 1421797690, "answer_id": 28057297, "question_id": 28053105, "link": "https://stackoverflow.com/questions/28053105/converting-a-slice-of-slices-in-go/28057297#28057297", "title": "Converting a slice of slices in Go?", "body": "<p>You can do it with a for-loop like so:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var res []string\n    arr := [][]byte{{105, 100}, {49}}\n\n    for _, b := range arr {\n        res = append(res, string(b))\n    }\n    fmt.Println(res)\n}\n</code></pre>\n\n<p>Test here: <a href=\"http://play.golang.org/p/el4YXfFZpM\" rel=\"nofollow\">http://play.golang.org/p/el4YXfFZpM</a></p>\n"}], "owner": {"reputation": 2514, "user_id": 1091856, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/a5035693d3dc0b20b4cc6a0f4db7444f?s=128&d=identicon&r=PG", "display_name": "user1091856", "link": "https://stackoverflow.com/users/1091856/user1091856"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1421797690, "creation_date": 1421780258, "question_id": 28053105, "link": "https://stackoverflow.com/questions/28053105/converting-a-slice-of-slices-in-go", "title": "Converting a slice of slices in Go?", "body": "<p>How do I convert this slice of byte slices</p>\n\n<pre><code>[[105 100] [49]]\n</code></pre>\n\n<p>to slice of strings?</p>\n\n<p>I tried </p>\n\n<pre><code>sliceOfStrings := []string(sliceOfByteSlices.([][]byte))\n</code></pre>\n\n<p>and got a</p>\n\n<pre><code>invalid type assertion: values.([][]byte) (non-interface type []interface {} on left)\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 0, "creation_date": 1421788491, "post_id": 28053182, "comment_id": 44492282, "body": "Are you sure that 2 and 3 don&#39;t allocate? This shows otherwise (checking RES on top): <a href=\"http://play.golang.org/p/105KU6MsD3\" rel=\"nofollow noreferrer\">play.golang.org/p/105KU6MsD3</a>  it uses 244 MB but if you comment out the for loop, it is 15 MB. EDIT: nevermind. runtime.MemStats shows the allocation at make([][]int) but no more allocations in the loop, I suppose it is not accessed so it is not actually allocated but simply reserved."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 0, "creation_date": 1421788612, "post_id": 28053182, "comment_id": 44492341, "body": "make calls <a href=\"https://github.com/golang/go/blob/d5e4c4061b019a36ed3ac954c98f6535b7e78189/src/runtime/malloc.go#L45\" rel=\"nofollow noreferrer\">mallocgc</a> to allocate the backing array for the slice. Mallocgc returns a pointer to a fixed block if size == 0."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 9, "last_activity_date": 1610002011, "last_edit_date": 1610002011, "creation_date": 1421780468, "answer_id": 28053182, "question_id": 28052933, "link": "https://stackoverflow.com/questions/28052933/how-should-i-define-an-empty-slice-in-go/28053182#28053182", "title": "How should I define an empty slice in Go?", "body": "<p>The difference is:</p>\n<ol>\n<li>is a nil slice (<code>foo == nil</code>).</li>\n<li>and 3. are non-nil slices  (<code>foo != nil</code>).</li>\n</ol>\n<p>The following points are true for all three statements:</p>\n<ul>\n<li>The statement does not allocate memory.</li>\n<li>The slice length is zero: <code>len(foo) == 0</code>.</li>\n<li>The slice capacity is zero: <code>cap(foo) == 0</code>.</li>\n</ul>\n<p><a href=\"http://play.golang.org/p/B2vmfMAHn3\" rel=\"nofollow noreferrer\">Playground example</a></p>\n<p>Because <a href=\"https://pkg.go.dev/builtin#len\" rel=\"nofollow noreferrer\">len</a>, <a href=\"https://pkg.go.dev/builtin#cap\" rel=\"nofollow noreferrer\">cap</a> and <a href=\"https://pkg.go.dev/builtin#append\" rel=\"nofollow noreferrer\">append</a> work with nil slices, (1) can often be used interchangeably with (2) and (3).</p>\n<p>All of the options are used commonly in Go code.</p>\n"}], "owner": {"reputation": 2980, "user_id": 454196, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0fd6a92775b8ccdcf488bc686869d618?s=128&d=identicon&r=PG", "display_name": "Andrew C", "link": "https://stackoverflow.com/users/454196/andrew-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 1, "accepted_answer_id": 28053182, "answer_count": 1, "score": 13, "last_activity_date": 1610002011, "creation_date": 1421779643, "question_id": 28052933, "link": "https://stackoverflow.com/questions/28052933/how-should-i-define-an-empty-slice-in-go", "title": "How should I define an empty slice in Go?", "body": "<p>Or more precisely, it seems like I could do any of these three things. Is there any difference between them? Which is the best and why?</p>\n\n<ol>\n<li><code>var foo []int</code></li>\n<li><code>foo := []int{}</code></li>\n<li><code>foo := make([]int, 0)</code></li>\n</ol>\n"}, {"tags": ["xml", "go", "xsd"], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 4726557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3169fe5dabfde682d2644ca7acac52d1?s=128&d=identicon&r=PG", "display_name": "kooshi_govno", "link": "https://stackoverflow.com/users/4726557/kooshi-govno"}, "is_accepted": false, "score": 5, "last_activity_date": 1427638776, "creation_date": 1427638776, "answer_id": 29330237, "question_id": 28052863, "link": "https://stackoverflow.com/questions/28052863/create-a-golang-struct-from-an-xsd/29330237#29330237", "title": "Create a Golang struct from an XSD", "body": "<p>xsd-makepkg expects to download the xsd files from a network server of some sort.</p>\n\n<p>I was confused by this at first as well, since the documentation mentioned building from local files, but that only works if the files specified are already downloaded.</p>\n\n<p><code>-basepath=\"\"</code>  determines where these files will be downloaded to, and where the generated .go files will be put</p>\n\n<p>what you're looking for is the <code>-uri=\"\"</code> argument. <code>-uri=\"\"</code> determines <em>which</em> files are to be downloaded and processed. The argument takes a whitespace separated list of uris, and <code>http://</code> is optional.</p>\n\n<p>A quick and dirty way to make it work with a local file is to serve the file from a local Apache instance, then point the program to localhost. That is of course assuming that you happen to have a web server running.</p>\n\n<p>for example:</p>\n\n<pre><code>mv *.xsd /var/www/html\ncd /var/www/html\nfor xsd in *; do xsd-makepkg -uri=\"127.0.0.1/$xsd\"; done\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 3660107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YyBr3.jpg?s=128&g=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/3660107/patrick"}, "is_accepted": false, "score": 4, "last_activity_date": 1467031748, "last_edit_date": 1467031748, "creation_date": 1466077155, "answer_id": 37858104, "question_id": 28052863, "link": "https://stackoverflow.com/questions/28052863/create-a-golang-struct-from-an-xsd/37858104#37858104", "title": "Create a Golang struct from an XSD", "body": "<p>I found this command line option:  </p>\n\n<p><strong>-local=true</strong>  :Local copy -- only downloads if file does not exist locally</p>\n\n<p>The below statement worked with mydomain.xsd in the xsd-schema folder.</p>\n\n<p>xsd-makepkg -local=true -uri=\"mydomain.xsd\" -basepath=\"github.com/my_name/xsd-schema\"</p>\n\n<p>reference: <a href=\"https://github.com/metaleap/go-xsd#command-line-flags-for-go-xsdxsd-makepkg-tool\" rel=\"nofollow\">https://github.com/metaleap/go-xsd#command-line-flags-for-go-xsdxsd-makepkg-tool</a></p>\n"}], "owner": {"reputation": 1153, "user_id": 1371064, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NnrmE.jpg?s=128&g=1", "display_name": "Carlos Andr&#233;s Garc&#237;a", "link": "https://stackoverflow.com/users/1371064/carlos-andr%c3%a9s-garc%c3%ada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7271, "favorite_count": 0, "answer_count": 2, "score": 9, "last_activity_date": 1467031748, "creation_date": 1421779430, "last_edit_date": 1495539851, "question_id": 28052863, "link": "https://stackoverflow.com/questions/28052863/create-a-golang-struct-from-an-xsd", "title": "Create a Golang struct from an XSD", "body": "<p>I want to create a Golang struct from an XSD (Structure XSD).</p>\n\n<p>I've read the post <a href=\"https://stackoverflow.com/questions/20734450/generate-go-structs-from-xsd\">generate Go structs from XSD</a> which recommend using go-xsd,  but I have downloaded go-xsd and installed xsd-makepkg and I cannot generate my struct.</p>\n\n<p>What I am doing?</p>\n\n<p>xsd-makepkg -basepath=\"/Users/XSD_Access/\" -goinst=false</p>\n\n<p>-xsd-makepkg: it is the binary create from apart <a href=\"http://github.com/metaleap/go-xsd-pkg\" rel=\"noreferrer\">go-xsd-pkg</a><br>\n -basepath: Contains the route where I have Structure XSD that I want to transform to struct.\n -goinst : I have not installed go-buildrun and I think it is not neccesary , for that reason is ser false</p>\n\n<p>What is the result of the command?</p>\n\n<p>A folder($GOPATH/usr/Users/XSD_Access/) that contains other folders with all followers XML wrappers </p>\n\n<ul>\n<li>docbook.org</li>\n<li>docs.oasis-open.org</li>\n<li>kbcafe.com</li>\n<li>khronos.org</li>\n<li>schemas.opengis.net</li>\n<li>thearchitect.co.uk</li>\n<li>Users</li>\n<li>www.w3.org</li>\n</ul>\n\n<p>Structure XSD</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;xs:schema xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" elementFormDefault=\"qualified\"&gt;\n   &lt;xs:element name=\"Request\" type=\"Request\"/&gt;\n   &lt;xs:complexType name=\"Request\"&gt;\n      &lt;xs:annotation&gt;\n         &lt;xs:documentation xml:lang=\"sp\"&gt;&lt;![CDATA[\n        Comment xxxxx\n     ]]&gt;&lt;/xs:documentation&gt;\n  &lt;/xs:annotation&gt;\n  &lt;xs:sequence&gt;\n     &lt;xs:element name=\"idOne\" type=\"xs:string\" minOccurs=\"0\" maxOccurs=\"1\"&gt;\n      &lt;xs:annotation&gt;\n     &lt;xs:documentation xml:lang=\"sp\"&gt;&lt;![CDATA[Comment xxxxx\n     ]]&gt;&lt;/xs:documentation&gt;\n      &lt;/xs:annotation&gt;\n    &lt;/xs:element&gt;\n         &lt;xs:element name=\"idTwo\" type=\"xs:string\" minOccurs=\"0\" maxOccurs=\"1\"&gt;\n  &lt;xs:annotation&gt;\n     &lt;xs:documentation xml:lang=\"sp\"&gt;&lt;![CDATA[Comment xxxxxx\n     ]]&gt;&lt;/xs:documentation&gt;\n  &lt;/xs:annotation&gt;\n&lt;/xs:element&gt;\n  &lt;/xs:sequence&gt;\n   &lt;/xs:complexType&gt;\n&lt;/xs:schema&gt;\n</code></pre>\n\n<p>Can anyone tell me what I am doing wrong or what step I missed that it does not let me create a struct from my Structure XSD?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["go", "range"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1421763016, "post_id": 28047311, "comment_id": 44476983, "body": "You cannot. Some programming is needed."}, {"owner": {"reputation": 68230, "user_id": 1426056, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3ac815b6fca201737db888a28efd7248?s=128&d=identicon&r=PG", "display_name": "waitingkuo", "link": "https://stackoverflow.com/users/1426056/waitingkuo"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1421763083, "post_id": 28047311, "comment_id": 44477033, "body": "Appreciated if can explain why giving me a downvote"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 2, "creation_date": 1421763241, "post_id": 28047311, "comment_id": 44477143, "body": "Are your slices same length? If yes, you can use index returned by <code>range</code> for both of them."}, {"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1421763377, "post_id": 28047311, "comment_id": 44477229, "body": "@Ainar-G, you should probably make that an answer (IMO it&#39;s the best one)."}, {"owner": {"reputation": 68230, "user_id": 1426056, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3ac815b6fca201737db888a28efd7248?s=128&d=identicon&r=PG", "display_name": "waitingkuo", "link": "https://stackoverflow.com/users/1426056/waitingkuo"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1421763494, "post_id": 28047311, "comment_id": 44477306, "body": "@Ainar-G yes they&#39;re in same length"}, {"owner": {"reputation": 170, "user_id": 132284, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/53138b00e7345b141dafeb615e2a2278?s=128&d=identicon&r=PG", "display_name": "Omie", "link": "https://stackoverflow.com/users/132284/omie"}, "edited": false, "score": 2, "creation_date": 1421823960, "post_id": 28047311, "comment_id": 44503866, "body": "If range is not &#39;must have&#39; requirement then you could do this with classic for loop, even when lengths are different <a href=\"http://play.golang.org/p/enNe0o0Jif\" rel=\"nofollow noreferrer\">play.golang.org/p/enNe0o0Jif</a>"}, {"owner": {"reputation": 68230, "user_id": 1426056, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3ac815b6fca201737db888a28efd7248?s=128&d=identicon&r=PG", "display_name": "waitingkuo", "link": "https://stackoverflow.com/users/1426056/waitingkuo"}, "reply_to_user": {"reputation": 170, "user_id": 132284, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/53138b00e7345b141dafeb615e2a2278?s=128&d=identicon&r=PG", "display_name": "Omie", "link": "https://stackoverflow.com/users/132284/omie"}, "edited": false, "score": 0, "creation_date": 1421864203, "post_id": 28047311, "comment_id": 44527414, "body": "@Omie that&#39;s helpful, thanks"}, {"owner": {"reputation": 915, "user_id": 2480661, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dc6352e16f4aebc05a11abe3e6a5e3fb?s=128&d=identicon&r=PG", "display_name": "Max Murphy", "link": "https://stackoverflow.com/users/2480661/max-murphy"}, "edited": false, "score": 0, "creation_date": 1468509049, "post_id": 28047311, "comment_id": 64165837, "body": "A reason for wanting to do this is to avoid bounds checking, thereby making the code faster.  Bounds checking is quite bad at slowing things down."}], "answers": [{"comments": [{"owner": {"reputation": 761, "user_id": 936670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d95e404da14224f8f6ca760fb0baa849?s=128&d=identicon&r=PG", "display_name": "Aleksei Egorov", "link": "https://stackoverflow.com/users/936670/aleksei-egorov"}, "edited": false, "score": 4, "creation_date": 1533590920, "post_id": 28047625, "comment_id": 90393084, "body": "Don&#39;t need to specify <code>_</code>. Use just: <code>for i := range r1 { ... }</code>"}, {"owner": {"reputation": 2617, "user_id": 3697870, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/krATc.jpg?s=128&g=1", "display_name": "Heath Raftery", "link": "https://stackoverflow.com/users/3697870/heath-raftery"}, "edited": false, "score": 0, "creation_date": 1579808429, "post_id": 28047625, "comment_id": 105900680, "body": "Does not work with strings, which makes things hard."}], "tags": [], "owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "is_accepted": true, "score": 37, "last_activity_date": 1583418128, "last_edit_date": 1583418128, "creation_date": 1421763625, "answer_id": 28047625, "question_id": 28047311, "link": "https://stackoverflow.com/questions/28047311/in-go-golang-how-to-iterate-two-arrays-slices-or-maps-using-one-range/28047625#28047625", "title": "In Go (golang), how to iterate two arrays, slices, or maps using one `range`", "body": "<p>You cannot, but if they are the same length you can use the index from <code>range</code>.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    r1 := []int{1, 2, 3}\n    r2 := []int{11, 21, 31}\n\n    if len(r1) == len(r2) {\n        for i := range r1 {\n            fmt.Println(r1[i])\n            fmt.Println(r2[i])\n        }\n    }\n}\n</code></pre>\n\n<p>It returns</p>\n\n<pre><code>1\n11\n2\n21\n3\n31\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 11, "last_activity_date": 1421763860, "creation_date": 1421763860, "answer_id": 28047701, "question_id": 28047311, "link": "https://stackoverflow.com/questions/28047311/in-go-golang-how-to-iterate-two-arrays-slices-or-maps-using-one-range/28047701#28047701", "title": "In Go (golang), how to iterate two arrays, slices, or maps using one `range`", "body": "<p>If your slices are the same length, use <code>range</code> like this:</p>\n\n<pre><code>for i := range x {\n    fmt.Println(x[i], y[i])\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 6562347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f85ec8677c8094aed4df2b11468b82b2?s=128&d=identicon&r=PG&f=1", "display_name": "jjm", "link": "https://stackoverflow.com/users/6562347/jjm"}, "is_accepted": false, "score": 3, "last_activity_date": 1467919130, "creation_date": 1467919130, "answer_id": 38253645, "question_id": 28047311, "link": "https://stackoverflow.com/questions/28047311/in-go-golang-how-to-iterate-two-arrays-slices-or-maps-using-one-range/38253645#38253645", "title": "In Go (golang), how to iterate two arrays, slices, or maps using one `range`", "body": "<p>You can do this, at the cost of creating a new array (which may or may not be a deal breaker for you)</p>\n\n<pre><code>for _, i := range append([]int{1, 2, 3}, []int{4, 5, 6, 7}...) {\n    fmt.Printf(\"%v\\n\", i)\n}\n</code></pre>\n\n<p>Note it works with different length arrays.  See <a href=\"https://play.golang.org/p/DRCI_CwSjA\" rel=\"nofollow\">https://play.golang.org/p/DRCI_CwSjA</a> for a playground example.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7233485, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/ed59d5150c850389f622e2181acd1484?s=128&d=identicon&r=PG", "display_name": "simon place", "link": "https://stackoverflow.com/users/7233485/simon-place"}, "is_accepted": false, "score": -6, "last_activity_date": 1508112308, "creation_date": 1508112308, "answer_id": 46761270, "question_id": 28047311, "link": "https://stackoverflow.com/questions/28047311/in-go-golang-how-to-iterate-two-arrays-slices-or-maps-using-one-range/46761270#46761270", "title": "In Go (golang), how to iterate two arrays, slices, or maps using one `range`", "body": "<p>its going to need an asynchronous solution, could use a channel;</p>\n\n<p><a href=\"https://play.golang.org/p/goAsZ6spKR\" rel=\"nofollow noreferrer\">https://play.golang.org/p/goAsZ6spKR</a></p>\n"}], "owner": {"reputation": 68230, "user_id": 1426056, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3ac815b6fca201737db888a28efd7248?s=128&d=identicon&r=PG", "display_name": "waitingkuo", "link": "https://stackoverflow.com/users/1426056/waitingkuo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17769, "favorite_count": 1, "accepted_answer_id": 28047625, "answer_count": 4, "score": 28, "last_activity_date": 1583418128, "creation_date": 1421762700, "last_edit_date": 1583417967, "question_id": 28047311, "link": "https://stackoverflow.com/questions/28047311/in-go-golang-how-to-iterate-two-arrays-slices-or-maps-using-one-range", "title": "In Go (golang), how to iterate two arrays, slices, or maps using one `range`", "body": "<p>To iterate over an array, slice, string, map, or channel, we can use</p>\n\n<pre><code>for _, x := range []int{1, 2, 3} {\n  // do something\n}\n</code></pre>\n\n<p>How can I iterate over two slices or maps simultaneously? Is there something like following in python?</p>\n\n<pre><code>for x, y in range([1, 2, 3], [4, 5, 6]):\n    print x, y\n</code></pre>\n"}, {"tags": ["arrays", "go", "type-conversion"], "answers": [{"comments": [{"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 2, "creation_date": 1421942988, "post_id": 28047019, "comment_id": 44563040, "body": "Note that slices behave a bit like variable-sized arrays in that, if you keep using <code>append</code> on a slice, it will grow by reallocation when necessary."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 16, "last_activity_date": 1421761915, "creation_date": 1421761915, "answer_id": 28047019, "question_id": 28046949, "link": "https://stackoverflow.com/questions/28046949/convert-fixed-size-array-to-variable-sized-array-in-go/28047019#28047019", "title": "Convert fixed size array to variable sized array in Go", "body": "<p>There are no variable-sized arrays in Go, only slices. If you want to get a slice of the whole array, do this:</p>\n\n<pre><code>b := a[:] // Same as b := a[0:len(a)]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3201, "user_id": 2616179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb90669caa64288bdb5767f736152bbe?s=128&d=identicon&r=PG", "display_name": "Makpoc", "link": "https://stackoverflow.com/users/2616179/makpoc"}, "is_accepted": true, "score": 28, "last_activity_date": 1421761916, "creation_date": 1421761916, "answer_id": 28047021, "question_id": 28046949, "link": "https://stackoverflow.com/questions/28046949/convert-fixed-size-array-to-variable-sized-array-in-go/28047021#28047021", "title": "Convert fixed size array to variable sized array in Go", "body": "<p>Use <code>b := a[:]</code> to get the slice over the array you have. Also see <a href=\"http://blog.golang.org/slices\">this</a> blog post for more information about arrays and slices.</p>\n"}], "owner": {"reputation": 2419, "user_id": 2094707, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/69d58eb588b8c86d9d7f3df2da72d2a0?s=128&d=identicon&r=PG", "display_name": "Stein", "link": "https://stackoverflow.com/users/2094707/stein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6564, "favorite_count": 3, "accepted_answer_id": 28047021, "answer_count": 2, "score": 18, "last_activity_date": 1470217922, "creation_date": 1421761714, "last_edit_date": 1470217922, "question_id": 28046949, "link": "https://stackoverflow.com/questions/28046949/convert-fixed-size-array-to-variable-sized-array-in-go", "title": "Convert fixed size array to variable sized array in Go", "body": "<p>I'm trying to convert a fixed size array <code>[32]byte</code> to variable sized array (slice) <code>[]byte</code>:</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n)\n\nfunc main() {\n        var a [32]byte\n        b := []byte(a)\n        fmt.Println(\" %x\", b)\n}\n</code></pre>\n\n<p>but the compiler throws the error:</p>\n\n<pre><code>./test.go:9: cannot convert a (type [32]byte) to type []byte\n</code></pre>\n\n<p>How should I convert it?</p>\n"}, {"tags": ["http", "web", "go"], "comments": [{"owner": {"reputation": 12822, "user_id": 87750, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c9eb0c80f3b41463ed45f45584b065a9?s=128&d=identicon&r=PG", "display_name": "fredrik", "link": "https://stackoverflow.com/users/87750/fredrik"}, "edited": false, "score": 0, "creation_date": 1421800214, "post_id": 28046100, "comment_id": 44497041, "body": "What OS are you running on?"}, {"owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 0, "creation_date": 1421802081, "post_id": 28046100, "comment_id": 44497547, "body": "You may want to modify your concurrency such that you have a fixed set of goroutines that cooperate to finish an amount of work.  At the moment, you&#39;re fanning out a number of goroutines equal to the total amount of work, which might be a bit overkill.  See Worker Pools: <a href=\"https://gobyexample.com/worker-pools\" rel=\"nofollow noreferrer\">gobyexample.com/worker-pools</a>"}, {"owner": {"reputation": 65, "user_id": 2825429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Od02.jpg?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/2825429/nemo"}, "edited": false, "score": 0, "creation_date": 1421803165, "post_id": 28046100, "comment_id": 44497815, "body": "i will test the Stability of my server . so i want to Analysis of  data when the server running  under high pressure.  the os is centos~~"}, {"owner": {"reputation": 65, "user_id": 2825429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Od02.jpg?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/2825429/nemo"}, "edited": false, "score": 0, "creation_date": 1421804336, "post_id": 28046100, "comment_id": 44498159, "body": "i&#39;m use the Web Framework is beego.  it&#39;s have problem~?"}, {"owner": {"reputation": 65, "user_id": 2825429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Od02.jpg?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/2825429/nemo"}, "edited": false, "score": 0, "creation_date": 1421806355, "post_id": 28046100, "comment_id": 44498551, "body": "the error code is &quot; Post <a href=\"http://xvz.myserver.com:9000/path/create\" rel=\"nofollow noreferrer\">xvz.myserver.com:9000/path/create</a>: EOF &quot;"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 2825429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Od02.jpg?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/2825429/nemo"}, "edited": false, "score": 1, "creation_date": 1421766852, "post_id": 28048416, "comment_id": 44479663, "body": "thanks for your help, you&#39;re right, &quot;Client can be reusable even concurrently&quot;"}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 1, "last_activity_date": 1421765733, "creation_date": 1421765733, "answer_id": 28048416, "question_id": 28046100, "link": "https://stackoverflow.com/questions/28046100/golang-http-concurrent-requests-post-eof/28048416#28048416", "title": "Golang HTTP Concurrent Requests POST EOF", "body": "<ul>\n<li>First, what for you instantiate new client each time <code>client := &amp;http.Client{...</code> inside <code>DoCreate()</code> inside a loop? Client can be\nreusable even concurrently, so you can construct it more globally,\nsay in <code>main()</code> seems to me. </li>\n<li>Then for me such error looks like\nproduced by RoundTrip, so by connection, so possibly from server site. Can you\ntest with mocking server? </li>\n<li>Finally if all that would not help, then\nyes, some systems have restriction on number of opened\nFileDescriptors which every <code>net.Conn</code> wants to have own. This\nrestriction can be eliminated only on OS level.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 1, "last_activity_date": 1421770015, "creation_date": 1421770015, "answer_id": 28049936, "question_id": 28046100, "link": "https://stackoverflow.com/questions/28046100/golang-http-concurrent-requests-post-eof/28049936#28049936", "title": "Golang HTTP Concurrent Requests POST EOF", "body": "<p>The EOF is usually from a server not returning a complete header (including both <code>CRLF</code>s), or the connection is closed before the header is complete. It's more likely that your overloading your server with concurrent requests, though you should still make sure you have adequate resources locally for the number of concurrent requests you're making. If <code>num</code> is large enough, you're going to run out of something.</p>\n\n<p>Though the error isn't really descriptive, it's not anything to worry about more so than any other request error. It's an error condition, and handle it like you would any others. If you want to know for certain, you'll likely have to have a packet capture of the connection that cause the <code>EOF</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2641, "user_id": 1852838, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/0NrW1.jpg?s=128&g=1", "display_name": "jeteon", "link": "https://stackoverflow.com/users/1852838/jeteon"}, "is_accepted": true, "score": 12, "last_activity_date": 1451158350, "last_edit_date": 1495535300, "creation_date": 1451158350, "answer_id": 34474535, "question_id": 28046100, "link": "https://stackoverflow.com/questions/28046100/golang-http-concurrent-requests-post-eof/34474535#34474535", "title": "Golang HTTP Concurrent Requests POST EOF", "body": "<p>It looks to me that you might be having the issue described in <a href=\"https://stackoverflow.com/a/23963271/1852838\">this answer</a>. Basically, the Go http client will try to reuse connections unless you've specifically indicated that it shouldn't either in the <code>Transport</code> you've set your <code>Client</code> instance to use or on the request itself with:</p>\n\n<pre><code>request.Close = true\n</code></pre>\n\n<p>This becomes a problem when the server on the other end closes the connection without indicating so with a <code>Connection: close</code> header in a response. The <code>net.http</code> code assumes that the connection is still open and so the next request that tries to use the connection next, encounters the <code>EOF</code> from the connection being closed the other time.</p>\n\n<p>You would need to check what is happening on the connection around the 1000th request. Is the receiving server set to limit the number of connections per client? Is your code running into a connection timeout? In either case, if it so happens the connection is closed by the server in a way that the Go <code>Client</code> code can't predict, then you'll run into the <code>EOF</code>.</p>\n"}], "owner": {"reputation": 65, "user_id": 2825429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Od02.jpg?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/2825429/nemo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14631, "favorite_count": 4, "accepted_answer_id": 34474535, "answer_count": 3, "score": 5, "last_activity_date": 1451162010, "creation_date": 1421759149, "last_edit_date": 1451162010, "question_id": 28046100, "link": "https://stackoverflow.com/questions/28046100/golang-http-concurrent-requests-post-eof", "title": "Golang HTTP Concurrent Requests POST EOF", "body": "<p>I'm running a small client in Go. We're getting a number of false alarms at the moment, which seem to come down to <code>client.Do()</code> returning an EOF error when <code>num&gt;=1000</code>.</p>\n\n<p>This is the essence of my code:</p>\n\n<pre><code>func DoCreate(js string, cli *http.Client) {\n\n    url2 := \"http://xvz.myserver.com:9000/path/create\"\n\n    postBytesReader := bytes.NewReader([]byte(js))\n    request, _ := http.NewRequest(\"POST\", url2, postBytesReader)\n\n    resp, err := cli.Do(request)\n    if err != nil {\n        fmt.Println(err) // Post http://xvz.myserver.com:9000/path/create: EOF \n        return\n    }\n    body, _ := ioutil.ReadAll(resp.Body)\n    fmt.Println(string(body))\n\n    defer resp.Body.Close()\n}\n\nfunc main() {\n    client := &amp;http.Client{\n        CheckRedirect: nil,\n    }\n\n    for i := 0; i &lt; num; i++ {\n        var pq CreateReqInfo\n        pq.Uid = strconv.Itoa(bid + i)\n        petstr, _ := json.Marshal(pq)\n        go DoCreate(string(petstr), client)\n    }\n}\n</code></pre>\n\n<p>The problem about number of file handles or max connections?</p>\n"}, {"tags": ["go", "benchmarking"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1421758051, "post_id": 28045711, "comment_id": 44473850, "body": "Just redirect stdout to a file in your shell."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1577634789, "post_id": 28045711, "comment_id": 105212732, "body": "Note benchmarks need to look over <code>b.N</code> to be useful. See <a href=\"https://golang.org/pkg/testing/#hdr-Benchmarks\" rel=\"nofollow noreferrer\">golang.org/pkg/testing/#hdr-Benchmarks</a>"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1577635766, "post_id": 28045711, "comment_id": 105213009, "body": "Also, as recommended in the documentation, you can use just <code>go test -bench=.</code> to run all benchmarks. This avoids the need to escape/quote <code>*</code> from the shell."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1577636483, "post_id": 28045711, "comment_id": 105213189, "body": "There is also the <code>-json</code> flag to <code>go test</code> (added in <a href=\"https://golang.org/doc/go1.10#test\" rel=\"nofollow noreferrer\">Go 1.10</a>) which outputs results in a machine parse-able JSON format."}], "answers": [{"tags": [], "owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "is_accepted": true, "score": 4, "last_activity_date": 1577635669, "last_edit_date": 1577635669, "creation_date": 1421817118, "answer_id": 28060063, "question_id": 28045711, "link": "https://stackoverflow.com/questions/28045711/accessing-a-benchmarks-result/28060063#28060063", "title": "Accessing a benchmark&#39;s result", "body": "<p>For example:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"testing\"\n    \"time\"\n)\n\nfunc Add(a, b int) int {\n    time.Sleep(10 * time.Microsecond) // Just to make the test take some time\n    return a + b\n}\n\nfunc BenchAdd(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        _ = Add(1, 2)\n    }\n}\n\nfunc main() {\n    res := testing.Benchmark(BenchAdd)\n    fmt.Printf(\"%s\\n%#[1]v\\n\", res)\n}\n</code></pre>\n\n<p>Produces:</p>\n\n<pre><code>  120000         10000 ns/op\ntesting.BenchmarkResult{N:120000, T:1200000000, Bytes:0, MemAllocs:0x0, MemBytes:0x0, Extra:map[string]float64{}}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/J08d1EtHcfC\" rel=\"nofollow noreferrer\">Playground</a>.</p>\n\n<p>You can easily write these results out to a file using <a href=\"http://golang.org/pkg/io/ioutil/#WriteFile\" rel=\"nofollow noreferrer\"><code>ioutil.WriteFile</code></a>.\n<a href=\"https://play.golang.org/p/K1Djic0Ju0o\" rel=\"nofollow noreferrer\">Playground w/ WriteFile</a>.</p>\n"}], "owner": {"reputation": 7273, "user_id": 2641547, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/660520007/picture?type=large", "display_name": "Spearfisher", "link": "https://stackoverflow.com/users/2641547/spearfisher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1312, "favorite_count": 0, "accepted_answer_id": 28060063, "answer_count": 1, "score": 2, "last_activity_date": 1577635669, "creation_date": 1421757861, "last_edit_date": 1577634670, "question_id": 28045711, "link": "https://stackoverflow.com/questions/28045711/accessing-a-benchmarks-result", "title": "Accessing a benchmark&#39;s result", "body": "<p>I've seen there is a struct <a href=\"https://golang.org/pkg/testing#BenchmarkResult\" rel=\"nofollow noreferrer\"><code>testing.BenchmarkResult</code></a> in Go to accesss the result of a benchmark but I found very little documentation or examples to help me use it.</p>\n\n\n\n<p>So far I have only been benchmarking my functions like this:</p>\n\n<pre><code>func BenchmarkMyFunction(b *testing.B) {\n   // call to myFunction\n}\n</code></pre>\n\n<p>And then running:</p>\n\n<pre><code>go test -bench=\".*\"\n</code></pre>\n\n<p>Here the results are printed to the console but I'd like to store them in a separate file. How can I use the <code>BenchmarkResult</code> type to do this?</p>\n"}, {"tags": ["xml", "go", "struct", "interface"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1421758037, "last_edit_date": 1421758037, "creation_date": 1421757700, "answer_id": 28045661, "question_id": 28045510, "link": "https://stackoverflow.com/questions/28045510/go-xml-unmarshal-nested-structs-into-interface/28045661#28045661", "title": "Go: XML Unmarshal Nested Structs into interface{}", "body": "<p>The type of the <code>Header</code> field inside the <code>Envelope</code> struct is <code>interface{}</code> which is <strong>not</strong> a <code>struct</code> so you cannot refer to any of its fields.</p>\n\n<p>In order to refer to a field named <code>Quota</code>, you have to declare <code>Header</code> with a static type which contains a <code>Quota</code> field, something like this:</p>\n\n<pre><code>type HeaderStruct struct {\n    Quota string\n}\n\ntype Envelope struct {\n    // other fields omitted\n    Header HeaderStruct\n}\n</code></pre>\n\n<p>If you don't know what type it will be or you can't commit to a single type, you can leave it as <code>interface{}</code>, but then you have to use either <a href=\"http://golang.org/ref/spec#Switch_statements\" rel=\"nofollow\">Type switches</a> or <a href=\"http://golang.org/ref/spec#Type_assertions\" rel=\"nofollow\">Type assertion</a> to convert it to a static type at runtime, the latter would look something like this:</p>\n\n<pre><code>headerStruct, ok := responseEnvelope.Header.(HeaderStruct)\n// if ok is true, headerStruct is of type HeaderStruct\n// else responseEnvelope.Header is not of type HeaderStruct\n</code></pre>\n\n<p>Another option would be to use reflection to access named fields of the <code>Envelope.Header</code> value, but try to solve it in other ways if possible. If you're interested in learning more about reflection in Go, I recommend reading <a href=\"http://blog.golang.org/laws-of-reflection\" rel=\"nofollow\">The Laws of Reflection</a> blog post first.</p>\n"}], "owner": {"reputation": 928, "user_id": 1199394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8211a77a32d995ece9c31c136cd6e876?s=128&d=identicon&r=PG", "display_name": "krak3n", "link": "https://stackoverflow.com/users/1199394/krak3n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 476, "favorite_count": 1, "accepted_answer_id": 28045661, "answer_count": 1, "score": 2, "last_activity_date": 1475605356, "creation_date": 1421757205, "last_edit_date": 1475605356, "question_id": 28045510, "link": "https://stackoverflow.com/questions/28045510/go-xml-unmarshal-nested-structs-into-interface", "title": "Go: XML Unmarshal Nested Structs into interface{}", "body": "<p>I come from a Python background and this is my first proper foray into Go so I don't think things are clicking quite yet.</p>\n\n<p>I'm currently implementing the Affiliate Window XML API in Go. The API follows a standard structure for Requests and Responses so to that end I'm trying to keep things dry. Envelopes always have the same structure, something like this:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;Envelope&gt;\n    &lt;Header&gt;&lt;/Header&gt;\n    &lt;Body&gt;&lt;/Body&gt;\n&lt;/Envelope&gt;\n</code></pre>\n\n<p>The contents <code>Header</code> and <code>Body</code> will be different depending on what I'm requesting and the response so I created a base <code>Envelope</code> <code>struct</code></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Envelope struct {\n    XMLName xml.Name    `xml:\"http://schemas.xmlsoap.org/soap/envelope/ Envelope\"`\n    NS1     string      `xml:\"xmlns:ns1,attr\"`\n    XSD     string      `xml:\"xmlns:xsd,attr\"`\n    Header  interface{} `xml:\"http://schemas.xmlsoap.org/soap/envelope/ Header\"`\n    Body    interface{} `xml:\"Body\"`\n}\n</code></pre>\n\n<p>This works well for marshaling the XML for a request but I'm having problems with unmarshaling:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func NewResponseEnvelope(body interface{}) *Envelope {\n    envelope := NewEnvelope()\n    envelope.Header = &amp;ResponseHeader{}\n    envelope.Body = body\n    return envelope\n}\n\nfunc main() {\n    responseBody := &amp;GetMerchantListResponseBody{}\n    responseEnvelope := NewResponseEnvelope(responseBody)\n\n    b := bytes.NewBufferString(response)\n    xml.NewDecoder(b).Decode(responseEnvelope)\n    fmt.Println(responseEnvelope.Header.Quota) // Why can't I access this?\n}\n</code></pre>\n\n<p>This <a href=\"http://play.golang.org/p/v-MkfEyFPM\" rel=\"nofollow\">http://play.golang.org/p/v-MkfEyFPM</a> probably describes the problem better in code than I can in words :p</p>\n\n<p>Thanks,</p>\n\n<p>Chris</p>\n"}, {"tags": ["http", "go"], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 6339, "user_id": 304778, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/CD3Vg.jpg?s=128&g=1", "display_name": "secmask", "link": "https://stackoverflow.com/users/304778/secmask"}, "edited": false, "score": 0, "creation_date": 1421750497, "post_id": 28043229, "comment_id": 44469440, "body": "@secmask Then maybe you haven&#39;t reloaded the HTML page in your browser or you haven&#39;t restarted your application. This works for me."}, {"owner": {"reputation": 6339, "user_id": 304778, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/CD3Vg.jpg?s=128&g=1", "display_name": "secmask", "link": "https://stackoverflow.com/users/304778/secmask"}, "edited": false, "score": 0, "creation_date": 1421750742, "post_id": 28043229, "comment_id": 44469573, "body": "I have tried do that both :( , I test, go 1.3.3 and 1.4.1"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 6339, "user_id": 304778, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/CD3Vg.jpg?s=128&g=1", "display_name": "secmask", "link": "https://stackoverflow.com/users/304778/secmask"}, "edited": false, "score": 0, "creation_date": 1421750904, "post_id": 28043229, "comment_id": 44469677, "body": "@secmask And also change <code>r.PostFormValue()</code> to <code>r.FormValue()</code>."}, {"owner": {"reputation": 6339, "user_id": 304778, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/CD3Vg.jpg?s=128&g=1", "display_name": "secmask", "link": "https://stackoverflow.com/users/304778/secmask"}, "edited": false, "score": 0, "creation_date": 1421751032, "post_id": 28043229, "comment_id": 44469744, "body": "<code>FormValue</code> is ok, but why not <code>PostFormValue</code> ? , from their document, I think the only different is <code>PostFormValue</code> does not use value in query url"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 6339, "user_id": 304778, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/CD3Vg.jpg?s=128&g=1", "display_name": "secmask", "link": "https://stackoverflow.com/users/304778/secmask"}, "edited": false, "score": 0, "creation_date": 1421755531, "post_id": 28043229, "comment_id": 44472416, "body": "@secmask Edited my answer to explain what you experience based on the implementation (source code) of the <code>http</code> package."}, {"owner": {"reputation": 6339, "user_id": 304778, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/CD3Vg.jpg?s=128&g=1", "display_name": "secmask", "link": "https://stackoverflow.com/users/304778/secmask"}, "edited": false, "score": 0, "creation_date": 1421757463, "post_id": 28043229, "comment_id": 44473536, "body": "That&#39;s right, I think it&#39;s seem unclear in implementation/document of <code>PostFormValue</code>  here."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1421755462, "last_edit_date": 1421755462, "creation_date": 1421750362, "answer_id": 28043229, "question_id": 28042789, "link": "https://stackoverflow.com/questions/28042789/go-http-server-handle-post-data-difference/28043229#28043229", "title": "Go http server handle POST data difference?", "body": "<p>If you use <code>\"multiplart/form-data\"</code> form-data encoding type you have to read form values with the <a href=\"http://golang.org/pkg/net/http/#Request.FormValue\" rel=\"nofollow\"><code>Request.FormValue()</code></a> function (note that not <code>PostFormValue</code>!).</p>\n\n<p>Change your <code>defaultHandler()</code> function to:</p>\n\n<pre><code>func defaultHandler(w http.ResponseWriter, r *http.Request) {\n    log.Println(r.FormValue(\"filepath\"))\n}\n</code></pre>\n\n<p>And it will work. The reason for this is because both <code>Request.FormValue()</code> and <code>Request.PostFormValue()</code> first call <code>Request.ParseMultipartForm()</code> if needed (if form encodying type is <code>multipart</code> and it has not yet been parsed) and <code>Request.ParseMultipartForm()</code> only stores the parsed form name-value pairs in the <code>Request.Form</code> and not in <code>Request.PostForm</code>: <a href=\"http://golang.org/src/net/http/request.go?s=24522:24581#L810\" rel=\"nofollow\"><code>Request.ParseMultipartForm() source code</code></a></p>\n\n<p>This may well be a bug, but even if this is the intended working, it should be mentioned in the documentation.</p>\n"}, {"comments": [{"owner": {"reputation": 6339, "user_id": 304778, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/CD3Vg.jpg?s=128&g=1", "display_name": "secmask", "link": "https://stackoverflow.com/users/304778/secmask"}, "edited": false, "score": 0, "creation_date": 1421751936, "post_id": 28043543, "comment_id": 44470253, "body": "My form does not have file, just some form param, but I prefer multipart to url encoding form. It&quot;s just weird go did not do it uniform here(and document)"}], "tags": [], "owner": {"reputation": 421, "user_id": 1283228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KrO6d.png?s=128&g=1", "display_name": "Andr&#233;s Piz&#225; B&#252;ckmann", "link": "https://stackoverflow.com/users/1283228/andr%c3%a9s-piz%c3%a1-b%c3%bcckmann"}, "is_accepted": false, "score": 0, "last_activity_date": 1421751642, "last_edit_date": 1421751642, "creation_date": 1421751303, "answer_id": 28043543, "question_id": 28042789, "link": "https://stackoverflow.com/questions/28042789/go-http-server-handle-post-data-difference/28043543#28043543", "title": "Go http server handle POST data difference?", "body": "<p>If you are trying to upload files you need to use the <code>multipart/form-data</code>enctype, the input field must be <code>type=file</code> and use the <code>FormFile</code> instead of <code>PostFormValue</code> (that returns just a String) method.</p>\n\n<pre><code>&lt;html&gt;\n&lt;title&gt;Go upload&lt;/title&gt;\n&lt;body&gt;\n    &lt;form action=\"http://localhost:8899/up\" method=\"post\" enctype=\"multipart/form-data\"&gt;\n        &lt;label for=\"filepath\"&gt;File Path:&lt;/label&gt;\n        &lt;input type=\"file\" name=\"filepath\" id=\"filepath\"&gt;\n        &lt;p&gt;\n        &lt;label for=\"jscontent\"&gt;Content:&lt;/label&gt;\n        &lt;textarea name=\"jscontent\" id=\"jscontent\" style=\"width:500px;height:100px\" rows=\"10\" cols=\"80\"&gt;&lt;/textarea&gt;\n        &lt;p&gt;\n        &lt;input type=\"submit\" name=\"submit\" value=\"Submit\"&gt;\n    &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n)\n\nfunc defaultHandler(w http.ResponseWriter, r *http.Request) {\n    file, header, err := r.FormFile(\"filepath\")\n\n    defer file.Close()\n\n    if err != nil {\n        log.Println(err.Error())\n    }\n\n    log.Println(header.Filename)\n\n    // Copy file to a folder or something\n}\nfunc main() {\n    http.HandleFunc(\"/up\", defaultHandler)\n    http.ListenAndServe(\":8899\", nil)\n}\n</code></pre>\n"}], "owner": {"reputation": 6339, "user_id": 304778, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/CD3Vg.jpg?s=128&g=1", "display_name": "secmask", "link": "https://stackoverflow.com/users/304778/secmask"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1420, "favorite_count": 2, "answer_count": 2, "score": 1, "last_activity_date": 1421755462, "creation_date": 1421749023, "last_edit_date": 1421751014, "question_id": 28042789, "link": "https://stackoverflow.com/questions/28042789/go-http-server-handle-post-data-difference", "title": "Go http server handle POST data difference?", "body": "<p>I have a simple upload form as</p>\n\n<pre><code>&lt;html&gt;\n&lt;title&gt;Go upload&lt;/title&gt;\n&lt;body&gt;\n&lt;form action=\"http://localhost:8899/up\" method=\"post\" enctype=\"multipart/form-data\"&gt;\n&lt;label for=\"file\"&gt;File Path:&lt;/label&gt;\n&lt;input type=\"text\" name=\"filepath\" id=\"filepath\"&gt;\n&lt;p&gt;\n&lt;label for=\"file\"&gt;Content:&lt;/label&gt;\n&lt;textarea name=\"jscontent\" id=\"jscontent\" style=\"width:500px;height:100px\" rows=\"10\" cols=\"80\"&gt;&lt;/textarea&gt;\n&lt;p&gt;\n&lt;input type=\"submit\" name=\"submit\" value=\"Submit\"&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>And server side</p>\n\n<pre><code>package main \nimport (\n    \"net/http\"\n    \"log\"\n)\nfunc defaultHandler(w http.ResponseWriter, r *http.Request) {\n    log.Println(r.PostFormValue(\"filepath\"))\n}\nfunc main() {\n    http.HandleFunc(\"/up\", defaultHandler)\n    http.ListenAndServe(\":8899\", nil)\n}\n</code></pre>\n\n<p>The problem is when I use <code>enctype=\"multipart/form-data\"</code>, I cannot get the value from client with <code>r.PostFormValue</code>, but it's ok if I set to <code>enctype=\"application/x-www-form-urlencoded\"</code>, go document say </p>\n\n<blockquote>\n  <p>PostFormValue returns the first value for the named component of the POST\n  or PUT request body. URL query parameters are ignored.\n  PostFormValue calls ParseMultipartForm and ParseForm if necessary and ignores\n  any errors returned by these functions.</p>\n</blockquote>\n\n<p>So why they did not say anything about <code>enctype</code> here ?</p>\n"}, {"tags": ["go", "benchmarking"], "comments": [{"owner": {"reputation": 1855, "user_id": 1558705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1563795271fe55bf0beab2d12cd69b0?s=128&d=identicon&r=PG", "display_name": "Dean Elbaz", "link": "https://stackoverflow.com/users/1558705/dean-elbaz"}, "edited": false, "score": 0, "creation_date": 1421749031, "post_id": 28042548, "comment_id": 44468522, "body": "I&#39;ve encountered the same issue in the past, as far as I know there isn&#39;t an easy way to do it. I ended up creating separate benchmark cases for representative values of n"}, {"owner": {"reputation": 7273, "user_id": 2641547, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/660520007/picture?type=large", "display_name": "Spearfisher", "link": "https://stackoverflow.com/users/2641547/spearfisher"}, "reply_to_user": {"reputation": 1855, "user_id": 1558705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1563795271fe55bf0beab2d12cd69b0?s=128&d=identicon&r=PG", "display_name": "Dean Elbaz", "link": "https://stackoverflow.com/users/1558705/dean-elbaz"}, "edited": false, "score": 0, "creation_date": 1421749168, "post_id": 28042548, "comment_id": 44468614, "body": "thanks, I would have expected something like this to be built in... It is weird to provide a benchmarking utility without this"}, {"owner": {"reputation": 851, "user_id": 3763312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9449996a2db226bbc5dd2dc65cd4134c?s=128&d=identicon&r=PG&f=1", "display_name": "Nikhil", "link": "https://stackoverflow.com/users/3763312/nikhil"}, "edited": false, "score": 0, "creation_date": 1589707294, "post_id": 28042548, "comment_id": 109394806, "body": "There is library that does it for you. Try out <a href=\"https://github.com/codingberg/benchgraph\" rel=\"nofollow noreferrer\">github.com/codingberg/benchgraph</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 1, "last_activity_date": 1421754250, "creation_date": 1421754250, "answer_id": 28044517, "question_id": 28042548, "link": "https://stackoverflow.com/questions/28042548/plot-benchmarks-result-in-go/28044517#28044517", "title": "Plot benchmark&#39;s result in Go", "body": "<blockquote>\n  <p>I would have expected something like this to be built in... It is weird to provide a benchmarking utility without this</p>\n</blockquote>\n\n<p>It doesn't seem obvious to include a cross-platform plot library within the language packages, that will have to be maintained.</p>\n\n<p>As it is now, you need to rely on third-party projects for a plot feature for benchmarks.</p>\n\n<p>For example, the project <strong><a href=\"https://github.com/aybabtme/benchkit\" rel=\"nofollow noreferrer\"><code>aybabtme/benchkit</code></a></strong> generates svg plot pictures from benchmarks.</p>\n\n<blockquote>\n  <p>lightweight, feather touch, benchmarking kit. In comparison to the standard pprof utilities, this package is meant to help generating graphs and other artifacts.</p>\n</blockquote>\n\n<p><img src=\"https://i.stack.imgur.com/RyU4F.png\" alt=\"https://github.com/aybabtme/benchkit/blob/master/benchplot/tar_memplot.png\"></p>\n"}], "owner": {"reputation": 7273, "user_id": 2641547, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/660520007/picture?type=large", "display_name": "Spearfisher", "link": "https://stackoverflow.com/users/2641547/spearfisher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 750, "favorite_count": 1, "accepted_answer_id": 28044517, "answer_count": 1, "score": 4, "last_activity_date": 1421754250, "creation_date": 1421748337, "question_id": 28042548, "link": "https://stackoverflow.com/questions/28042548/plot-benchmarks-result-in-go", "title": "Plot benchmark&#39;s result in Go", "body": "<p>Let's say I have written different functions to compute Fibonacci's nth number:</p>\n\n<pre><code>func fiboIterative(n int) {\n   ...\n}\n\nfunc fiboRecursive(n int) {\n   ...\n}\n</code></pre>\n\n<p>And I'd like to get a chart showing the performances of each function depending on the value of n.</p>\n\n<p>So far, I have been benchmarking using the built-in <code>testing</code> package which prints the time per operations to the console. Is there a simple way/package to run the benchmark for multiple values of n, stores the result in a csv or something similar and then plot them?</p>\n"}, {"tags": ["debugging", "go"], "answers": [{"tags": [], "owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "is_accepted": false, "score": 2, "last_activity_date": 1421743752, "creation_date": 1421743752, "answer_id": 28041005, "question_id": 28040901, "link": "https://stackoverflow.com/questions/28040901/hijacking-panic-output/28041005#28041005", "title": "Hijacking panic output", "body": "<p>You can get a formatted stack trace using the <a href=\"http://golang.org/pkg/runtime/#Stack\" rel=\"nofollow\"><code>runtime.Stack</code></a> function.  By passing <code>true</code> as the second argument, you can see stack traces of all gouroutines.</p>\n"}, {"tags": [], "owner": {"reputation": 881, "user_id": 1624112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cc1cL.jpg?s=128&g=1", "display_name": "Specode", "link": "https://stackoverflow.com/users/1624112/specode"}, "is_accepted": false, "score": 0, "last_activity_date": 1421746754, "creation_date": 1421746754, "answer_id": 28041971, "question_id": 28040901, "link": "https://stackoverflow.com/questions/28040901/hijacking-panic-output/28041971#28041971", "title": "Hijacking panic output", "body": "<pre><code>    1 package main\n    2 \n    3 import (\n    4 \u203a   \"fmt\"\n    5 )\n    6 \n    7 func main() {\n    8 \u203a   defer func() {\n    9 \u203a   \u203a   if r := recover(); r != nil {\n   10 \u203a   \u203a   \u203a   fmt.Println(\"panic:\", r)                                                                                                                                                                                                 \n   11 \u203a   \u203a   }\n   12 \u203a   }()\n   13 \n   14 \u203a   test := []int{1, 2, 3}\n   15 \u203a   fmt.Println(test[5])\n   16 \n   17 }\n</code></pre>\n\n<p>using defer and recover.</p>\n\n<p><a href=\"http://blog.golang.org/defer-panic-and-recover\" rel=\"nofollow\">http://blog.golang.org/defer-panic-and-recover</a></p>\n"}], "owner": {"reputation": 10277, "user_id": 190446, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c544188078900e5d5976689949177f11?s=128&d=identicon&r=PG", "display_name": "S\u0142awosz", "link": "https://stackoverflow.com/users/190446/s%c5%82awosz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1452434229, "creation_date": 1421743341, "question_id": 28040901, "link": "https://stackoverflow.com/questions/28040901/hijacking-panic-output", "title": "Hijacking panic output", "body": "<p>When my golang app is panicking, it is printing go routines stack trace and quiting. I wonder if there is nice way to get panic output for further processing. Redirecting stderr is not enough, because one would like to put some error logs there. I would like to get only panic output.</p>\n"}, {"tags": ["arrays", "string", "go", "type-conversion", "slice"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 27, "last_activity_date": 1421767297, "last_edit_date": 1421767297, "creation_date": 1421744868, "answer_id": 28041357, "question_id": 28040896, "link": "https://stackoverflow.com/questions/28040896/why-can-not-convert-sizebyte-to-string-in-go/28041357#28041357", "title": "Why can not convert [Size]byte to string in Go?", "body": "<p>Short answer is because the Go Language Specification does not permit it.</p>\n\n<p>Quoting from the <a href=\"http://golang.org/ref/spec#Conversions\" rel=\"noreferrer\">Go Language Specification: Conversions</a>:</p>\n\n<blockquote>\n  <p>A non-constant value <code>x</code> can be converted to type <code>T</code> in any of these cases:</p>\n  \n  <ul>\n  <li><code>x</code> is assignable to <code>T</code>.</li>\n  <li><code>x</code>'s type and <code>T</code> have identical underlying types.</li>\n  <li><code>x</code>'s type and <code>T</code> are unnamed pointer types and their pointer base types have identical underlying types.</li>\n  <li>x's type and <code>T</code> are both integer or floating point types.</li>\n  <li>x's type and <code>T</code> are both complex types.</li>\n  <li><strong><code>x</code> is an integer or a slice of bytes or runes and <code>T</code> is a string type.</strong></li>\n  <li><code>x</code> is a string and <code>T</code> is a slice of bytes or runes.</li>\n  </ul>\n</blockquote>\n\n<p>The specification only allows converting a slice of bytes or runes to <code>string</code>, but not an array of bytes.</p>\n\n<p><strong>Long answer</strong></p>\n\n<p>In Go arrays and slices are distinct types. The size of an array is part of the type.</p>\n\n<p>Slices are much more general than arrays, and converting an array to a slice which represents the same series of values is very easy: <code>arr[:]</code> (and is also cheap, the result slice will share the array as its backing array, no reallocation or copying will be done).</p>\n\n<p>Because of this, all functions and support are provided for slices and not for arrays.</p>\n\n<p>Just image you want to create a simple function which takes a slice (with any length) of <code>int</code> numbers and returns the sum of the numbers. Something like this:</p>\n\n<pre><code>func sum(s []int) (sum int) {\n    for _, v := range s {\n        sum += v\n    }\n    return\n}\n</code></pre>\n\n<p>If you would decide to use an array as the input, since the length is part of the type, you would limit the usability of your function, it could only take arrays of the same length:</p>\n\n<pre><code>func sum2(s [2]int) (sum int) {\n    for _, v := range s {\n        sum += v\n    }\n    return\n}\n</code></pre>\n\n<p>You can call <code>sum2()</code> only with values of type <code>[2]int</code> but if you have an array of type <code>[3]int</code>, you <em>can't</em> because those 2 types are distinct! You also cannot call <code>sum2()</code> if you only have a slice of <code>int</code>'s (you can't access the backing array of a slice). Meanwhile you can call your <code>sum()</code> function with all <code>[]int</code> slices, and if you have an array, you can still use it by passing <code>arr[:]</code> to your <code>sum()</code> function.</p>\n\n<p><strong>Note:</strong></p>\n\n<p>Also note that converting a \"random\" slice of bytes to a <code>string</code> is most likely not what you want because a \"random\" slice of bytes may not be a valid UTF-8 byte sequence.</p>\n\n<p>Instead use the <a href=\"http://golang.org/pkg/encoding/hex/\" rel=\"noreferrer\"><code>encoding/hex</code></a> package to convert the result to a hex string like this:</p>\n\n<pre><code>fmt.Println(hex.EncodeToString(b[:]))\n</code></pre>\n"}], "owner": {"reputation": 2099, "user_id": 1917479, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/daEaw.jpg?s=128&g=1", "display_name": "soapbar", "link": "https://stackoverflow.com/users/1917479/soapbar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8473, "favorite_count": 5, "accepted_answer_id": 28041357, "answer_count": 1, "score": 15, "last_activity_date": 1460366822, "creation_date": 1421743328, "last_edit_date": 1495542346, "question_id": 28040896, "link": "https://stackoverflow.com/questions/28040896/why-can-not-convert-sizebyte-to-string-in-go", "title": "Why can not convert [Size]byte to string in Go?", "body": "<p>I have a sized byte array that I got after doing <code>md5.Sum()</code>.</p>\n\n<pre><code>data := []byte(\"testing\")\nvar pass string \nvar b [16]byte\nb = md5.Sum(data)\npass = string(b)\n</code></pre>\n\n<p>The error:</p>\n\n<pre><code>cannot convert b (type [16]byte) to type string\n</code></pre>\n\n<p>I find the solution at this <a href=\"https://stackoverflow.com/questions/26072921/how-do-i-convert-sizebyte-to-string-in-go/28039572?noredirect=1#comment44464957_28039572\">problem</a></p>\n\n<p>Change to:</p>\n\n<pre><code>pass = string(b[:])\n</code></pre>\n\n<p>But why can not use it like this?</p>\n\n<pre><code>pass = string(b)\n</code></pre>\n"}, {"tags": ["algorithm", "go", "biginteger"], "comments": [{"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 0, "creation_date": 1421742772, "post_id": 28040532, "comment_id": 44465162, "body": "For the second question, just check the sources: <a href=\"http://golang.org/src/math/big/int.go?s=3342:3375#L142\" rel=\"nofollow noreferrer\">golang.org/src/math/big/int.go?s=3342:3375#L142</a> and <a href=\"http://golang.org/src/math/big/nat.go\" rel=\"nofollow noreferrer\">golang.org/src/math/big/nat.go</a> They also use Karatsuba algorithm. Yet, they use it for really big numbers (see karatsubaThreshold), in other cases, simpler algorithm is used."}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1421750202, "post_id": 28040532, "comment_id": 44469264, "body": "look here <a href=\"http://stackoverflow.com/q/18465326/2521214\">stackoverflow.com/q/18465326/2521214</a> for ideas"}, {"owner": {"reputation": 7273, "user_id": 2641547, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/660520007/picture?type=large", "display_name": "Spearfisher", "link": "https://stackoverflow.com/users/2641547/spearfisher"}, "edited": false, "score": 1, "creation_date": 1421751324, "post_id": 28040532, "comment_id": 44469906, "body": "thanks, this is amazingly helpful"}, {"owner": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "edited": false, "score": 0, "creation_date": 1421779489, "post_id": 28040532, "comment_id": 44487586, "body": "<code>_split()</code> looks a candidate for measurement."}], "owner": {"reputation": 7273, "user_id": 2641547, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/660520007/picture?type=large", "display_name": "Spearfisher", "link": "https://stackoverflow.com/users/2641547/spearfisher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 447, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1421741950, "creation_date": 1421741950, "question_id": 28040532, "link": "https://stackoverflow.com/questions/28040532/karatsuba-multiplication-optimization-un-golang", "title": "Karatsuba multiplication optimization un Golang", "body": "<p>I have been playing with Go for a few weeks now and I am implemented a version of Karatsuba's multiplication (<a href=\"http://en.wikipedia.org/wiki/Karatsuba_algorithm#Pseudo_Code_Implementation\" rel=\"nofollow\">http://en.wikipedia.org/wiki/Karatsuba_algorithm#Pseudo_Code_Implementation</a>):</p>\n\n<pre><code>package karatsuba\n\nimport (\n    \"math\"\n    \"math/big\"\n)\n\nfunc k_multiply(a, b *big.Int) *big.Int {\n    if a.Cmp(big.NewInt(10)) &lt; 1 || b.Cmp(big.NewInt(10)) &lt; 1 {\n        return mul(a, b)\n    }\n\n    m := _pivot(a, b)\n\n    leftA, rightA := _split(a, uint(m))\n    leftB, rightB := _split(b, uint(m))\n\n    z0 := k_multiply(leftA, leftB)\n    z1 := k_multiply(rightA, rightB)\n    z2 := k_multiply(add(leftA, rightA), add(leftB, rightB))\n    z2 = sub(z2, add(z0, z1))\n\n    temp0 := mul(z0, big.NewInt(int64(math.Pow(10.0, 2.0*float64(m)))))\n    temp1 := mul(z2, big.NewInt(int64(math.Pow(10.0, float64(m)))))\n    temp2 := add(temp0, temp1)\n\n    return add(temp2, z1)\n}\n\nfunc _split(a *big.Int, m uint) (left, right *big.Int) {\n    denominator := big.NewInt(int64(math.Pow(10.0, float64(m))))\n\n    left = big.NewInt(0).Div(a, denominator)\n    right = sub(a, big.NewInt(0).Mul(left, denominator))\n\n    return\n}\n\nfunc _pivot(a, b *big.Int) int {\n    len_a := len(a.String())\n    len_b := len(b.String())\n\n    if len_a &gt; len_b {\n        return len_a/2 + len_a%2\n    } else {\n        return len_b/2 + len_b%2\n    }\n}\n\nfunc add(a, b *big.Int) *big.Int {\n    return big.NewInt(0).Add(a, b)\n}\n\nfunc mul(a, b *big.Int) *big.Int {\n    return big.NewInt(0).Mul(a, b)\n}\n\nfunc sub(a, b *big.Int) *big.Int {\n    return big.NewInt(0).Sub(a, b)\n}\n</code></pre>\n\n<p>The algorithm works fine however I have several questions:\n- when I am computing temp0 and temp1, I am cheating as I am using <code>mul</code> to multiply my bigInt with powers of ten. Is there a better way to do this without doing extra recursive calls?\n- I have benchmark <code>k_multiply</code> against the <code>big.Mul</code> and the result were quite puzzling:</p>\n\n<pre><code>BenchmarkMultiply    5000000           490 ns/op\nBenchmarkKaratsubaMultiply      5000        485348 ns/op\n</code></pre>\n\n<p>This raises 2 questions: is my implementation really bad and what can I do to make it better? and what algorithm does <code>big.Mul</code> uses?</p>\n\n<p>Many thanks for your help, it is greatly appreciated</p>\n"}, {"tags": ["xml", "struct", "go", "xlsx"], "answers": [{"tags": [], "owner": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "is_accepted": true, "score": 4, "last_activity_date": 1421746843, "creation_date": 1421746843, "answer_id": 28041994, "question_id": 28040448, "link": "https://stackoverflow.com/questions/28040448/cant-modify-the-xml-node-value-by-golang/28041994#28041994", "title": "Can&#39;t modify the xml node value by golang?", "body": "<p>Here's a working example (using identation for XML): <a href=\"http://play.golang.org/p/DDuyPjngvV\" rel=\"nofollow\">Playground</a></p>\n\n<p><strong>Explanation:</strong> </p>\n\n<p>You're copying your structs in your for-loop.\nWhen writing</p>\n\n<pre><code>for _, r := range v.Row {\n</code></pre>\n\n<p><code>r</code> is a <strong>copy</strong> of the value(s) in <code>v.Row</code>. \nIf you then try to change the value, you will just change the copy, but the original value won't change.</p>\n\n<p>You should write your loop like</p>\n\n<pre><code>for i := range v.Row {\n</code></pre>\n\n<p>and access the struct with <code>v.Row[i]</code> instead.</p>\n\n<p>The same applies to your inner loop, which should be written like this:</p>\n\n<pre><code>for j := range v.Row[i].C {\n</code></pre>\n\n<p>Then you can change the column like</p>\n\n<pre><code>v.Row[i].C[j].V = \"25\"\n</code></pre>\n\n<p>Optionally you could get a reference to the column by writing <code>c := &amp;v.Row[i].C[j]</code> and then change values as <code>c.V = \"25\"</code></p>\n"}], "owner": {"reputation": 285, "user_id": 3373877, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/532526780ffab7d05fae3a14045c3f8d?s=128&d=identicon&r=PG&f=1", "display_name": "user3373877", "link": "https://stackoverflow.com/users/3373877/user3373877"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 953, "favorite_count": 1, "accepted_answer_id": 28041994, "answer_count": 1, "score": 0, "last_activity_date": 1421746843, "creation_date": 1421741665, "question_id": 28040448, "link": "https://stackoverflow.com/questions/28040448/cant-modify-the-xml-node-value-by-golang", "title": "Can&#39;t modify the xml node value by golang?", "body": "<p>I can't modify the c node's value in golang. i want get the some nodes value (is ok),and reset some nodes value (such as between \"\") as the following, but there are some thing wrong with it. how to do it?  youe are welcome to give some help:</p>\n\n<pre><code>    package main\n\n    import (\n            \"fmt\"\n            \"regexp\"\n    )\n    type C struct {\n        XMLName xml.Name `xml:\"c\"`\n        V       string   `xml:\"v,omitempty\"`\n        R       string   `xml:\"r,attr\"`\n        T       string   `xml:\"t,attr,omitempty\"`\n        S       string   `xml:\"s,attr\"`\n    }\n    type Row struct {\n        XMLName xml.Name `xml:\"row\"`\n        R       string   `xml:\"r,attr\"`\n        C       []C      `xml:\"c\"`\n        Spans   string   `xml:\"spans,attr\"`\n    }\n    type Result struct {\n        XMLName xml.Name `xml:\"sheetData\"`\n        Row     []Row    `xml:\"row\"`\n    }\n    func main() {\n            input := `\n            &lt;sheetData&gt;\n            &lt;row r=\"2\" spans=\"1:15\"&gt;\n            &lt;c r=\"A2\" s=\"5\" &gt;&lt;v&gt;{{range .txt}}&lt;/v&gt;&lt;/c&gt;\n            &lt;c r=\"B2\" s=\"5\" t=\"s\"&gt;&lt;v&gt;1&lt;/v&gt;&lt;/c&gt;\n            &lt;c r=\"C2\" s=\"5\" t=\"s\"&gt;&lt;v&gt;2&lt;/v&gt;&lt;/c&gt;\n            &lt;c r=\"D2\" s=\"5\" t=\"s\"&gt;&lt;v&gt;3&lt;/v&gt;&lt;/c&gt;\n            &lt;c r=\"E2\" s=\"5\" /&gt;\n            &lt;c r=\"K2\" s=\"6\" t=\"s\"&gt;&lt;v&gt;21&lt;/v&gt;&lt;/c&gt;\n        &lt;/row&gt; \n        &lt;row r=\"3\" spans=\"1:15\"&gt;\n            &lt;c r=\"A3\" s=\"5\" t=\"s\"&gt;&lt;v&gt;0&lt;/v&gt;&lt;/c&gt;\n            &lt;c r=\"B3\" s=\"5\" t=\"s\"&gt;&lt;v&gt;1&lt;/v&gt;&lt;/c&gt;\n            &lt;c r=\"C3\" s=\"5\" t=\"s\"&gt;&lt;v&gt;2&lt;/v&gt;&lt;/c&gt;\n            &lt;c r=\"D3\" s=\"5\" t=\"s\"&gt;&lt;v&gt;3&lt;/v&gt;&lt;/c&gt;\n            &lt;c r=\"E3\" s=\"5\" /&gt;\n            &lt;c r=\"K3\" s=\"6\" t=\"s\"&gt;&lt;v&gt;21&lt;/v&gt;&lt;/c&gt;\n        &lt;/row&gt; \n        &lt;/sheetData&gt;`\n        v := Result{}\n    err := xml.Unmarshal([]byte(input), &amp;v)\n    if err != nil {\n        fmt.Printf(\"error: %v\", err)\n        return\n    }\n\n    for _, r := range v.Row {\n        for _, c := range r.C {       \n             c.V=\"25\"          //i want the set some c node value.\n              fmt.Printf(\"%v %v %v\\n\", c.V, c.R,c.T)\n        }\n    }\n\n\n        output, err := xml.MarshalIndent(&amp;v, \"\", \"\")\n         if  err != nil {\n            fmt.Printf(\"error: %v\\n\", err)\n        } \n             fmt.Println(string(output))   //but the c node value is still original\n}          \n        }  \n</code></pre>\n\n<p>What wrong with the above?  how to set some node valule in golang?</p>\n"}, {"tags": ["go", "path", "relative-path", "cgo", "ldflags"], "answers": [{"comments": [{"owner": {"reputation": 717, "user_id": 4445806, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c5d013c30989c84e693d5f06458d4bde?s=128&d=identicon&r=PG&f=1", "display_name": "catric mia", "link": "https://stackoverflow.com/users/4445806/catric-mia"}, "edited": false, "score": 0, "creation_date": 1421808617, "post_id": 28049658, "comment_id": 44499148, "body": "Got it!, Thank you for your explanation !"}, {"owner": {"reputation": 4311, "user_id": 98528, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/835b9fab8784c5dca07b2165ac8b3df4?s=128&d=identicon&r=PG", "display_name": "akavel", "link": "https://stackoverflow.com/users/98528/akavel"}, "edited": false, "score": 0, "creation_date": 1481202607, "post_id": 28049658, "comment_id": 69287832, "body": "As of go1.5.4, <code>#cgo LDFLAGS: -L${SRCDIR}&#47;testserver -ltest</code> works all right."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 8, "last_activity_date": 1421809859, "last_edit_date": 1421809859, "creation_date": 1421769242, "answer_id": 28049658, "question_id": 28037827, "link": "https://stackoverflow.com/questions/28037827/how-to-use-a-relative-path-for-ldflags-in-golang/28049658#28049658", "title": "How to use a relative path for LDFLAGS in golang", "body": "<p>You currently can't. The directory changes between the time the command is built, and linking. For now you either need to link to an absolute path, or use the <code>CGO_LDFLAGS</code> environment variable.</p>\n\n<p>There was a commit just after go1.4 which added a <code>${SRCDIR}</code> variable which is replaced by the absolute path to the directory containing the source file at build  time. <a href=\"https://github.com/golang/go/issues/7891\" rel=\"noreferrer\">https://github.com/golang/go/issues/7891</a>. This will be in go1.5, and you can easily use it now by building Go from source. </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8373419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T3bkg.jpg?s=128&g=1", "display_name": "eyotang", "link": "https://stackoverflow.com/users/8373419/eyotang"}, "is_accepted": false, "score": 0, "last_activity_date": 1501144112, "last_edit_date": 1501144112, "creation_date": 1501126657, "answer_id": 45340949, "question_id": 28037827, "link": "https://stackoverflow.com/questions/28037827/how-to-use-a-relative-path-for-ldflags-in-golang/45340949#45340949", "title": "How to use a relative path for LDFLAGS in golang", "body": "<p>It's really very great to use <strong>${SRCDIR}</strong> to solve the problem of <strong><em>relative path</em></strong>.</p>\n\n<p>In addition, the <strong>${SRCDIR}</strong> indicates the <strong><em>absolute path of current go file</em></strong>.\nUse command <code>go build -x .</code> to check the output.</p>\n\n<pre><code>$ go build -x .\n...\ncd /root/sourcecode/src/tcp/aes\nCGO_LDFLAGS=\"-g\" \"-O2\" \"-L/root/sourcecode/src/tcp/aes/aes\" \"-laes\" /usr/local/go/pkg/tool/linux_amd64/cgo -objdir $WORK/tcp/aes/_obj/ -importpath tcp/aes -- -I $WORK/tcp/aes/_obj/ aes.go\ncd $WORK\n...\n$ tcp/aes\n/usr/bin/ld: cannot find -laes\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>It's incrrect, because the lib <code>libaes.a</code> locates the same as the go file.\nThen I changed it, and passed.</p>\n"}], "owner": {"reputation": 717, "user_id": 4445806, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c5d013c30989c84e693d5f06458d4bde?s=128&d=identicon&r=PG&f=1", "display_name": "catric mia", "link": "https://stackoverflow.com/users/4445806/catric-mia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11414, "favorite_count": 3, "accepted_answer_id": 28049658, "answer_count": 2, "score": 9, "last_activity_date": 1567862184, "creation_date": 1421728582, "last_edit_date": 1567862184, "question_id": 28037827, "link": "https://stackoverflow.com/questions/28037827/how-to-use-a-relative-path-for-ldflags-in-golang", "title": "How to use a relative path for LDFLAGS in golang", "body": "<p>I am trying to build a golang program which uses a static lib (.a file)</p>\n\n<p>the directory struct for my project as below</p>\n\n<pre><code>\u2514\u2500testserver\n    \u251c\u2500bin\n    \u251c\u2500pkg\n    \u2514\u2500src\n        \u251c\u2500logging\n        \u2514\u2500testserver\n            \u251c\u2500libtest.a\n            \u2514\u2500test.go\n</code></pre>\n\n<p>the flags for cgo in test.go as below</p>\n\n<pre><code>// #cgo LDFLAGS: -L /home/test/testserver/src/testserver -ltest\n// #include \"test.h\"\nimport \"C\"\n</code></pre>\n\n<p>when I am using absolute path for LDFLAGS -L, it works fines, but when I change the path to a relative path, eg </p>\n\n<pre><code>// #cgo LDFLAGS: -L ./testserver -ltest\n</code></pre>\n\n<p>and then run the command </p>\n\n<pre><code>go install testserver\n</code></pre>\n\n<p>it returns an error to me, and says \"cannot find -ltest\"</p>\n\n<p>my question is how can I use a relative path in LDFLAGS ? , so that I can build the project in any path. </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 3291, "user_id": 1388603, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c0203853665322695e2bf5bc6eca2a62?s=128&d=identicon&r=PG", "display_name": "fvrghl", "link": "https://stackoverflow.com/users/1388603/fvrghl"}, "edited": false, "score": 0, "creation_date": 1421722240, "post_id": 28036673, "comment_id": 44458476, "body": "Ok, so why does 2 produce 1, and 1 produce -1?"}], "tags": [], "owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "is_accepted": false, "score": 0, "last_activity_date": 1421726754, "last_edit_date": 1421726754, "creation_date": 1421719784, "answer_id": 28036673, "question_id": 28036560, "link": "https://stackoverflow.com/questions/28036560/go-varint-returns-half-of-expected-value/28036673#28036673", "title": "Go Varint Returns Half of Expected Value", "body": "<p>Yes. Check this modified version: <a href=\"http://play.golang.org/p/AyP2a4gue8\" rel=\"nofollow\">http://play.golang.org/p/AyP2a4gue8</a></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/binary\"\n    \"fmt\"\n)\n\nfunc main() {\n    for i := 0; i &lt; 100; i++ {\n        var myByte byte = byte(i)\n        array := []byte{myByte}\n        val, n := binary.Varint(array)\n        fmt.Printf(\"int %d value: %d, num bytes: %d\\n\", i, val, n)\n\n    }    \n}\n</code></pre>\n\n<p>which produces the following output:</p>\n\n<pre><code>int 0 value: 0, num bytes: 1\nint 1 value: -1, num bytes: 1\nint 2 value: 1, num bytes: 1\nint 3 value: -2, num bytes: 1\nint 4 value: 2, num bytes: 1\nint 5 value: -3, num bytes: 1\nint 6 value: 3, num bytes: 1\nint 7 value: -4, num bytes: 1\nint 8 value: 4, num bytes: 1\nint 9 value: -5, num bytes: 1\nint 10 value: 5, num bytes: 1\nint 11 value: -6, num bytes: 1\nint 12 value: 6, num bytes: 1\nint 13 value: -7, num bytes: 1\nint 14 value: 7, num bytes: 1\nint 15 value: -8, num bytes: 1\nint 16 value: 8, num bytes: 1\nint 17 value: -9, num bytes: 1\nint 18 value: 9, num bytes: 1\n</code></pre>\n\n<p>You can see \"zig-zagging\" between the negatives and positives.  This is because, according to the <a href=\"https://developers.google.com/protocol-buffers/docs/encoding?csw=1#types\" rel=\"nofollow\">documented binary format</a>, varints use \"zig-zag\" encoding so that values of small absolute value are encoded with small values.</p>\n"}, {"comments": [{"owner": {"reputation": 3291, "user_id": 1388603, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c0203853665322695e2bf5bc6eca2a62?s=128&d=identicon&r=PG", "display_name": "fvrghl", "link": "https://stackoverflow.com/users/1388603/fvrghl"}, "edited": false, "score": 0, "creation_date": 1421722373, "post_id": 28036680, "comment_id": 44458498, "body": "Ok, but why does my input of 18 produce 9?  18 = 00010010"}], "tags": [], "owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "is_accepted": false, "score": 1, "last_activity_date": 1421723797, "last_edit_date": 1421723797, "creation_date": 1421719848, "answer_id": 28036680, "question_id": 28036560, "link": "https://stackoverflow.com/questions/28036560/go-varint-returns-half-of-expected-value/28036680#28036680", "title": "Go Varint Returns Half of Expected Value", "body": "<p><strong>TLDR:</strong> Use the <code>Uvarint</code> method to properly decode an <em>unsigned</em> byte .. which is what a <code>byte</code> is by default.</p>\n\n<p>The byte is stored unsigned (as a byte is unsigned by default - it is an alias for <code>uint8</code> .. in most languages).</p>\n\n<p>When you're decoding the number, you're calling <code>binary.Varint</code> .. which decodes a signed number. This results in the number being incorrect because of the sign bit.</p>\n\n<p>Using <code>binary.Uvarint</code> .. that is, decode an unsigned number, you get the correct result:</p>\n\n<pre><code>val, n := binary.Uvarint(array) // val = 18, n = 1\n</code></pre>\n\n<h3>Expanded example:</h3>\n\n<p>Lets take a look at your number - 18. In binary, it is this:</p>\n\n<pre><code>00010010\n</code></pre>\n\n<p>The <code>binary.Varint</code> function is below:</p>\n\n<pre><code>func Varint(buf []byte) (int64, int) {\n    ux, n := Uvarint(buf) // ok to continue in presence of error\n    x := int64(ux &gt;&gt; 1)\n    if ux&amp;1 != 0 {\n        x = ^x\n    }\n    return x, n\n}\n</code></pre>\n\n<p>Basically, it will first go and get the unsigned value of what you've provided: <code>18</code>.</p>\n\n<p>It will then shift all of the bytes across by 1. This results in:</p>\n\n<pre><code>00001001\n</code></pre>\n\n<p>That is the binary representation of <code>9</code>. Notice the sign bit is still 0 - which means a positive number. It then checks whether to invert the result by bitwise AND'ing the original value (<code>18</code>) with <code>1</code>. It does this because, it is operating with a \"I know this number is signed\" context - that's why the function exists:</p>\n\n<pre><code>00010010\n00000001\n--------\n00000000\n     = 0\n</code></pre>\n\n<p>At that point, zero does equal zero - so the method returns <code>x</code> - which is 9.</p>\n\n<h3>Lets try with 1</h3>\n\n<p>Using 1 as the input:</p>\n\n<pre><code>00000001\n</code></pre>\n\n<p>Shift it right:</p>\n\n<pre><code>00000000\n</code></pre>\n\n<p>AND <em>the original number (1)</em> with 1:</p>\n\n<pre><code>00000001\n00000001\n--------\n     = 1\n</code></pre>\n\n<p>At this point, the result doesn't equal zero.. so the result is inverted:</p>\n\n<pre><code>11111111\n</code></pre>\n\n<p>This is the signed representation of <code>-1</code> (notice the sign bit is now 1 .. indicating a negative number).</p>\n"}], "owner": {"reputation": 3291, "user_id": 1388603, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c0203853665322695e2bf5bc6eca2a62?s=128&d=identicon&r=PG", "display_name": "fvrghl", "link": "https://stackoverflow.com/users/1388603/fvrghl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1421726754, "creation_date": 1421718917, "question_id": 28036560, "link": "https://stackoverflow.com/questions/28036560/go-varint-returns-half-of-expected-value", "title": "Go Varint Returns Half of Expected Value", "body": "<p>Why is the output of this code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/binary\"\n)\n\nfunc main() {\n    var myByte byte = 18\n    array := []byte{myByte}\n    val, n := binary.Varint(array)\n    fmt.Printf(\"value: %d, num bytes: %d\\n\", val, n)\n}\n</code></pre>\n\n<p><code>value: 9, num bytes: 1</code> instead of <code>value: 18, num bytes: 1</code></p>\n\n<p>It probably has something to do with two's complement, but I'm not seeing how.</p>\n"}, {"tags": ["sql", "templates", "go"], "answers": [{"tags": [], "owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "is_accepted": true, "score": 2, "last_activity_date": 1421715994, "creation_date": 1421715994, "answer_id": 28036185, "question_id": 28036078, "link": "https://stackoverflow.com/questions/28036078/go-template-to-concatenate-queries-from-the-slice/28036185#28036185", "title": "Go template to concatenate queries from the slice", "body": "<p>I don't think template is the right tool for the job. Just create the query string and join it here is how:</p>\n\n<pre><code>http://play.golang.org/p/mM0mMfBZFK\n\npackage main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\nvar slice1 = []string{\"2014-01-01\", \"2014-01-02\", \"2014-01-03\"}\nvar slice2 = []string{\"20140101\", \"20140102\", \"20140103\"}\n\nfunc main() {\n    var parts []string\n    for i := 0; i &lt; len(slice1); i++ {\n        parts = append(parts, fmt.Sprintf(\"select %q as date, itemid, price from orderhistory_t%s\", slice1[i], slice2[i]))\n    }\n    fmt.Println(strings.Join(parts, \" union all \"))\n}\n</code></pre>\n\n<p>output:</p>\n\n<blockquote>\n  <p>select \"2014-01-01\" as date, itemid, price from orderhistory_t20140101\n  union all select \"2014-01-02\" as date, itemid, price from\n  orderhistory_t20140102 union all select \"2014-01-03\" as date, itemid,\n  price from orderhistory_t20140103</p>\n</blockquote>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4211028"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 998, "favorite_count": 0, "accepted_answer_id": 28036185, "answer_count": 1, "score": 2, "last_activity_date": 1421715994, "creation_date": 1421715072, "question_id": 28036078, "link": "https://stackoverflow.com/questions/28036078/go-template-to-concatenate-queries-from-the-slice", "title": "Go template to concatenate queries from the slice", "body": "<p>I want to concatenate my SQL query with <code>UNION ALL</code> and golang <a href=\"http://golang.org/pkg/text/template/\" rel=\"nofollow\">http://golang.org/pkg/text/template/</a></p>\n\n<p>For example, I have:</p>\n\n<pre><code>var slice1 = []string{\"2014-01-01\", \"2014-01-02\", \"2014-01-03\"}\nvar slice2 = []string{\"20140101\", \"20140102\", \"20140103\"}\n</code></pre>\n\n<p>And query:</p>\n\n<pre><code>select {{.date}} as date, itemid, price\nfrom orderhistory_t{{datetag}}\n</code></pre>\n\n<p>And using the template I want to create the query like the following:</p>\n\n<pre><code>select '2014-01-01' as date, itemid, price\nfrom orderhistory_t20140101\n\nunion all \n\nselect '2014-01-02' as date, itemid, price\nfrom orderhistory_t20140102\n\nunion all \n\nselect '2014-01-03' as date, itemid, price\nfrom orderhistory_t20140103\n</code></pre>\n\n<p>How do I loop through the slice of Golang and put them in the sql template?</p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["json", "go", "marshalling", "unmarshalling"], "answers": [{"comments": [{"owner": {"reputation": 1290, "user_id": 1034994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c1a2f73dcd63970c6acdba13c4ac72b?s=128&d=identicon&r=PG", "display_name": "KayoticSully", "link": "https://stackoverflow.com/users/1034994/kayoticsully"}, "edited": false, "score": 0, "creation_date": 1421717193, "post_id": 28035946, "comment_id": 44457313, "body": "I didn&#39;t want to have to maintain multiple structs but mostly because it would have been an inline struct in the function.  This is a touch more elegant and workable for clean code.  I like it!  Thanks so much!"}], "tags": [], "owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "is_accepted": true, "score": 9, "last_activity_date": 1421714111, "creation_date": 1421714111, "answer_id": 28035946, "question_id": 28035784, "link": "https://stackoverflow.com/questions/28035784/golang-marshal-unmarshal-json-with-both-exported-and-un-exported-fields/28035946#28035946", "title": "Golang Marshal/Unmarshal JSON with both exported and un-exported fields", "body": "<p>You can create a specific structure to handle the JSON serialization message: <a href=\"http://play.golang.org/p/d057T7qfVB\" rel=\"noreferrer\">http://play.golang.org/p/d057T7qfVB</a></p>\n\n<pre><code>type Test struct {\n    fieldA string\n    FieldB int\n    FieldC string\n}\n\ntype TestJSON struct {\n    FieldA string `json:\"fieldA\"`\n    FieldB int    `json:\"fieldB\"`\n    FieldC string `json:\"fieldC\"`\n}\n\nfunc (t *Test) MarshalJSON() ([]byte, error) {\n    return json.Marshal(TestJSON{\n        t.fieldA,\n        t.FieldB,\n        t.FieldC,\n    })\n}\n\nfunc (t *Test) UnmarshalJSON(b []byte) error {\n    temp := &amp;TestJSON{}\n\n    if err := json.Unmarshal(b, &amp;temp); err != nil {\n        return err\n    }\n\n    t.fieldA = temp.FieldA\n    t.FieldB = temp.FieldB\n    t.FieldC = temp.FieldC\n\n    return nil\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1782, "user_id": 300664, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1dba650bd7e0538186382d8b9b737017?s=128&d=identicon&r=PG", "display_name": "bjrnt", "link": "https://stackoverflow.com/users/300664/bjrnt"}, "edited": false, "score": 0, "creation_date": 1574403287, "post_id": 49372417, "comment_id": 104228585, "body": "Does this approach also work when embedding a <code>Cranberry</code> in a different type, or use a type alias like <code>type OtherBerry CranBerry</code> and then marshal that?"}], "tags": [], "owner": {"reputation": 3468, "user_id": 71978, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Ex4dt.jpg?s=128&g=1", "display_name": "TomOnTime", "link": "https://stackoverflow.com/users/71978/tomontime"}, "is_accepted": false, "score": 3, "last_activity_date": 1521493869, "creation_date": 1521493869, "answer_id": 49372417, "question_id": 28035784, "link": "https://stackoverflow.com/questions/28035784/golang-marshal-unmarshal-json-with-both-exported-and-un-exported-fields/49372417#49372417", "title": "Golang Marshal/Unmarshal JSON with both exported and un-exported fields", "body": "<p>The other solution is completely functional but it requires updates\nin many places any time a field changes. This solution is easier\nto maintain.</p>\n\n<p>By using a type alias and\nstruct embedding, we can create a solution that is more DRY.  New\nfields automatically work as expected, unless they are unexported\nor require custom formatting. In that case, a minimal amount of work\nis required: simply list the special field in the <code>*JSON</code> struct and\ninclude conversion expressions in <code>MarshalJSON</code> and <code>UnmarshalJSON</code>.</p>\n\n<pre><code>package main\n\n/*\n\nThe Go JSON module can't not access unexported fields in a struct. So\nhow do you work with them?\n\nThis demonstrates the solution in http://choly.ca/post/go-json-marshalling/\nwhere we have a 2nd struct that embeds the primary struct but adds\nfields that will be used to expose the unexported fields.  We then write\nMarshalJSON() and UnmarshalJSON() functions that do the right thing.\n\nThis also helps in situations where we have fields that require a custom\nformat only in JSON.\n*/\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"time\"\n)\n\n// Cranberry stores data.\n//  Visible: This field is exported and JSON displays it as usual.\n//  invisible: This field is unexported but we want it to be included in JSON.\n//  Custom: This field has a custom output format.  We store it as time.Time\n//    but when it appears in JSON, it should be in Unix Epoch format.\ntype Cranberry struct {\n    Visible   int       `json:\"visible\"`\n    invisible int       // No tag here\n    Custom    time.Time `json:\"-\"` // Don't output this field (we'll handle it in CranberryJSON).\n}\n\n// CranberryAlias is an alias of Cranberry. We use an alias because aliases\n// are stripped of any functions and we need a struct without\n// MarshalJSON/UnmarshalJSON defined, otherwise we'd get a recursive defintion.\ntype CranberryAlias Cranberry\n\n// CranberryJSON represents out we represent Cranberry to the JSON package.\ntype CranberryJSON struct {\n    *CranberryAlias       // All the exported fields.\n    Invisible       int   `json:\"invisible\"`\n    CustomUnixEpoch int64 `json:\"epoch\"`\n    // FYI: The json tags \"invisble\" and \"epoch\" can be any valid JSON tag.\n    // It is all a matter of how we want the JSON to be presented externally.\n}\n\n// MarshalJSON marshals a Cranberry. (struct to JSON)\nfunc (u *Cranberry) MarshalJSON() ([]byte, error) {\n    return json.Marshal(&amp;CranberryJSON{\n        CranberryAlias: (*CranberryAlias)(u),\n        // Unexported or custom-formatted fields are listed here:\n        Invisible:       u.invisible,\n        CustomUnixEpoch: u.Custom.Unix(),\n    })\n}\n\n// UnmarshalJSON unmarshals a Cranberry. (JSON to struct)\nfunc (u *Cranberry) UnmarshalJSON(data []byte) error {\n    temp := &amp;CranberryJSON{\n        CranberryAlias: (*CranberryAlias)(u),\n    }\n    if err := json.Unmarshal(data, &amp;temp); err != nil {\n        return err\n    }\n\n    // Copy the exported fields:\n    *u = (Cranberry)(*(temp).CranberryAlias)\n    // Each unexported field must be copied and/or converted individually:\n    u.invisible = temp.Invisible\n    u.Custom = time.Unix(temp.CustomUnixEpoch, 0) // Convert while copying.\n\n    return nil\n}\n\nfunc main() {\n    var out []byte\n    var err error\n\n    // Demonstration of marshalling: Marshal s (struct) to out ([]byte)\n    fmt.Printf(\"Struct to JSON:\\n\")\n    s := &amp;Cranberry{Visible: 1, invisible: 2, Custom: time.Unix(1521492409, 0)}\n    out, err = json.Marshal(s)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Printf(\"      got=%v\\n\", string(out))\n    fmt.Println(` expected={\"visible\":1,\"invisible\":2,\"epoch\":1521492409}`)\n\n    // Demonstration of how to unmarshal: Unmarshal out ([]byte) to n (struct)\n    fmt.Printf(\"JSON to struct:\\n\")\n    var n = &amp;Cranberry{}\n    err = json.Unmarshal(out, n)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Printf(\"      got=%+v\\n\", n)\n    fmt.Println(` expected=&amp;{Visible:1 invisible:2 Custom:2018-03-19 xx:46:49 xxxxx xxx}`)\n}\n</code></pre>\n\n<p>The output looks like this:</p>\n\n<pre><code>$ go run minimal.go \nStruct to JSON:\n      got={\"visible\":1,\"invisible\":2,\"epoch\":1521492409}\n expected={\"visible\":1,\"invisible\":2,\"epoch\":1521492409}\nJSON to struct:\n      got=&amp;{Visible:1 invisible:2 Custom:2018-03-19 16:46:49 -0400 EDT}\n expected=&amp;{Visible:1 invisible:2 Custom:2018-03-19 xx:46:49 xxxxx xxx}\n</code></pre>\n\n<p>I got this idea from <a href=\"http://choly.ca/post/go-json-marshalling/\" rel=\"nofollow noreferrer\">http://choly.ca/post/go-json-marshalling/</a> who deserves all the credit.  Credit also goes to @anderson-nascente who lead me to discover the blog post.</p>\n"}], "owner": {"reputation": 1290, "user_id": 1034994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c1a2f73dcd63970c6acdba13c4ac72b?s=128&d=identicon&r=PG", "display_name": "KayoticSully", "link": "https://stackoverflow.com/users/1034994/kayoticsully"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6557, "favorite_count": 0, "accepted_answer_id": 28035946, "answer_count": 2, "score": 1, "last_activity_date": 1521493869, "creation_date": 1421712920, "last_edit_date": 1421713745, "question_id": 28035784, "link": "https://stackoverflow.com/questions/28035784/golang-marshal-unmarshal-json-with-both-exported-and-un-exported-fields", "title": "Golang Marshal/Unmarshal JSON with both exported and un-exported fields", "body": "<p>I have seen plenty of ways to marshal/unmarshal structs that only have unexported fields.  But how can I do this with mixed fields?</p>\n\n<p>Given a struct:</p>\n\n<pre><code>type Test struct {\n    fieldA string `json:\"fieldA\"`\n    FieldB int    `json:\"fieldB\"`\n    FieldC string `json:\"fieldC\"`\n}\n</code></pre>\n\n<p>How can I write MarshalJSON/UnmarshalJSON functions so that fieldA is transported along with FieldB and FieldC?</p>\n\n<p>The following compiles, but then overflows the call stack when I run it.  My guess is I am recursively marshalling the object, but I am not sure of how else to preserve both exported and unexported fields when encoding.</p>\n\n<pre><code>func (t *Test) MarshalJSON() ([]byte, error) {\n    return json.Marshal(struct {\n         *Test\n         FieldA string `json:\"fieldA\"`\n    }{\n         t,\n         t.fieldA,\n    })\n}\n\nfunc (t *Test) UnmarshalJSON(b []byte) error {\n    return json.Unmarshal(b, &amp;t)\n}\n</code></pre>\n\n<p>Is there a way to do this?  Or should I re-think my data structures and maybe just export the field anyway?</p>\n\n<p><strong>Note:</strong> I'm aware I can do each field manually, but I'd like to avoid that if possible to make updating the code more manageable. </p>\n"}, {"tags": ["arrays", "go"], "comments": [{"owner": {"reputation": 1582, "user_id": 3486065, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/EozB4.png?s=128&g=1", "display_name": "Taco de Wolff", "link": "https://stackoverflow.com/users/3486065/taco-de-wolff"}, "edited": false, "score": 0, "creation_date": 1421707211, "post_id": 28034652, "comment_id": 44454385, "body": "Which library is this? Because <a href=\"http://golang.org/pkg/database/sql/#DB.Query\" rel=\"nofollow noreferrer\">golang.org/pkg/database/sql/#DB.Query</a> returns two variables. You could check if rows.Next() returns false on the first check I suppose?"}], "answers": [{"comments": [{"owner": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "edited": false, "score": 0, "creation_date": 1421782368, "post_id": 28034870, "comment_id": 44489193, "body": "Thanks. It works now. I changed from github.com/ziutek/mymysql package to github.com/go-sql-driver/mysql. I much happier with it."}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 6, "last_activity_date": 1517508672, "last_edit_date": 1517508672, "creation_date": 1421707870, "answer_id": 28034870, "question_id": 28034652, "link": "https://stackoverflow.com/questions/28034652/how-to-check-for-empty-array-array-of-struct/28034870#28034870", "title": "How to check for empty array (array of struct)", "body": "<p>It looks like you could use <code>QueryRow</code>, since that query is expected to return only one row.  </p>\n\n<blockquote>\n  <p>QueryRow executes a query that is expected to return at most one row. QueryRow always return a non-nil value. Errors are deferred until Row's Scan method is called.</p>\n</blockquote>\n\n<p>In this case, if there is no row, the <code>ErrNoRows</code> occurs, but is deferred until a <code>.Scan</code> occurs.</p>\n\n<blockquote>\n  <p>ErrNoRows is returned by Scan when QueryRow doesn't return a row. In such a case, QueryRow returns a placeholder *Row value that defers this error until a Scan.</p>\n</blockquote>\n\n<p>So what you want to do is something like:</p>\n\n<pre><code>var id int\nvar secret string\nvar shortname string\nerr := db.QueryRow(\"SELECT ...\").Scan(&amp;id, &amp;secret, &amp;shortname)\nswitch {\n    case err == sql.ErrNoRows:\n        log.Printf(\"Not found.\")\n    case err != nil:\n        log.Fatal(err)\n    default:\n        //do stuff\n}\n</code></pre>\n\n<p>Otherwise, since you need to be looping over <code>rows.Next</code> anyways, you can easily set a flag:</p>\n\n<pre><code>defer rows.Close()\nhas_results := false\nfor rows.Next() {\n    has_results = true\n    //do stuff\n}\nif (!has_results) {\n    //error handling\n}\n</code></pre>\n"}], "owner": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6397, "favorite_count": 1, "accepted_answer_id": 28034870, "answer_count": 1, "score": 2, "last_activity_date": 1568880754, "creation_date": 1421706736, "last_edit_date": 1568880754, "question_id": 28034652, "link": "https://stackoverflow.com/questions/28034652/how-to-check-for-empty-array-array-of-struct", "title": "How to check for empty array (array of struct)", "body": "<p>A mySQL Query function returns an array of rows witch is defined as</p>\n\n<pre><code>type Row []interface{}\n</code></pre>\n\n<p>I would like to check if the returned array is empty, but I get a runtime panic:</p>\n\n<pre><code>s := fmt.Sprintf(\"select id, secret, shortname from beehives where shortname = '%s'\", beehive)\n\nrows, res, err := database.Query(s)\nif err == nil {\n    if len(rows) != 1 {\n</code></pre>\n\n<p>The expression len(rows) seems to cause the runtime panic if rows is empty.</p>\n\n<p>How can I check for an empty array? I tried also rows == nil, which also panics.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1421704644, "post_id": 28033957, "comment_id": 44453257, "body": "What is the name of a process?"}, {"owner": {"reputation": 1139, "user_id": 675283, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/447f06617d5f30dbbcdd6d1b47d402fe?s=128&d=identicon&r=PG", "display_name": "Justin", "link": "https://stackoverflow.com/users/675283/justin"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1421706171, "post_id": 28033957, "comment_id": 44453967, "body": "I have bin using Get-Process in powershell to get the list of running processes. ProcessName and there ID are given there in a table. In this case I&#39;m trying to close out of iTunes and the process name is iTunes. The problem is the process ID keeps changing so i can&#39;t seem to rely on it."}], "answers": [{"tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": true, "score": 4, "last_activity_date": 1421708142, "creation_date": 1421708142, "answer_id": 28034936, "question_id": 28033957, "link": "https://stackoverflow.com/questions/28033957/is-there-a-way-to-find-a-process-id-on-windows-in-go/28034936#28034936", "title": "Is there a way to find a process id on windows in Go?", "body": "<p>It's not pretty, but you can use the w32 binding: (github.com/AllenDang/w32)</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/AllenDang/w32\"\n    \"unsafe\"\n)\n\nfunc GetProcessName(id uint32) string {\n    snapshot := w32.CreateToolhelp32Snapshot(w32.TH32CS_SNAPMODULE, id)\n    if snapshot == w32.ERROR_INVALID_HANDLE {\n        return \"&lt;UNKNOWN&gt;\"\n    }\n    defer w32.CloseHandle(snapshot)\n\n    var me w32.MODULEENTRY32\n    me.Size = uint32(unsafe.Sizeof(me))\n    if w32.Module32First(snapshot, &amp;me) {\n        return w32.UTF16PtrToString(&amp;me.SzModule[0])\n    }\n\n    return \"&lt;UNKNOWN&gt;\"\n}\n\nfunc ListProcesses() []uint32 {\n    sz := uint32(1000)\n    procs := make([]uint32, sz)\n    var bytesReturned uint32\n    if w32.EnumProcesses(procs, sz, &amp;bytesReturned) {\n        return procs[:int(bytesReturned)/4]\n    }\n    return []uint32{}\n}\n\nfunc FindProcessByName(name string) (uint32, error) {\n    for _, pid := range ListProcesses() {\n        if GetProcessName(pid) == name {\n            return pid, nil\n        }\n    }\n    return 0, fmt.Errorf(\"unknown process\")\n}\n\nfunc main() {\n    fmt.Println(FindProcessByName(\"chrome.exe\"))\n}\n</code></pre>\n"}], "owner": {"reputation": 1139, "user_id": 675283, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/447f06617d5f30dbbcdd6d1b47d402fe?s=128&d=identicon&r=PG", "display_name": "Justin", "link": "https://stackoverflow.com/users/675283/justin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1627, "favorite_count": 0, "accepted_answer_id": 28034936, "answer_count": 1, "score": 1, "last_activity_date": 1421708142, "creation_date": 1421703719, "question_id": 28033957, "link": "https://stackoverflow.com/questions/28033957/is-there-a-way-to-find-a-process-id-on-windows-in-go", "title": "Is there a way to find a process id on windows in Go?", "body": "<p>In OS package there is a FindProcess() that you can pass in the ID of the process to get a process. You can then call kill on the process but is there a way to find a process based off of the name? (In windows) </p>\n\n<p>For example i would like to be able to do something like this. </p>\n\n<pre><code>p, perr := os.FindProcessByName(\"Itunes\")\nif perr != nil {\n    fmt.Println(perr)\n}\np.Kill()\n</code></pre>\n\n<p>I only need this to work on Windows.</p>\n"}, {"tags": ["go", "cassandra", "cql", "cassandra-2.0", "gocql"], "answers": [{"tags": [], "owner": {"reputation": 10892, "user_id": 4406006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dcbc151fab6abfc394bb9f47f1f5aa4?s=128&d=identicon&r=PG", "display_name": "Andy Tolbert", "link": "https://stackoverflow.com/users/4406006/andy-tolbert"}, "is_accepted": false, "score": 2, "last_activity_date": 1421715935, "last_edit_date": 1421715935, "creation_date": 1421711200, "answer_id": 28035521, "question_id": 28033756, "link": "https://stackoverflow.com/questions/28033756/gocql-select-doesnt-return-all-columns/28035521#28035521", "title": "gocql SELECT * doesn&#39;t return all columns", "body": "<p>I'm not familiar with the gocql library, but it sounds like you may be running into a combination of not repreparing your statements and <a href=\"https://issues.apache.org/jira/browse/CASSANDRA-7910\" rel=\"nofollow\">CASSANDRA-7910</a>.</p>\n\n<p>Whenever a request is Prepared (like what is being done in Select * from ___ where date in ?), it sends a request to cassandra, which responds with the column metadata for that table, so when you get a response to a query back from cassandra, you know what columns are available to look for.  It looks like gocql has a feature called <code>Automatic query preparation</code> which may be treating your request as a prepared statement.</p>\n\n<p>When you alter a table, the prepared statement does not get updated on your client side, so really the only way to fix this is to reprepare your statement (not sure if you have that level of control from gocql).   However this still doesn't work since there is a bug in cassandra (<a href=\"https://issues.apache.org/jira/browse/CASSANDRA-7910\" rel=\"nofollow\">CASSANDRA-7910</a>) where it does not return the new columns since it is itself caching the prepared statement on it's side and not invalidating it when the schema changes.  This issue is fixed in 2.1.3 (coming soon), it may be worth trying this against the cassandra-2.1 branch in git to see if that resolves your issue.</p>\n\n<p>It's not an abnormal pattern to alter your schema when your application is running, so this is a scenario that should work, but unfortunately doesn't.  I'd look into seeing if there is a way to reprepare statements in gocql.  </p>\n\n<p>I see there is a <code>stmtsLRU</code> var in cluster.go.  If you could somehow get to that you could invalidate prepared statements.  If there isn't a way to do this, would be good to open up an issue against gocql as you can reprepare statements again in other drivers.  I know that the java driver allows you to do this, but gives you a warning.  I suppose this could be a big difference between gocql and the other drivers in that in the other drivers you explicitly use a prepared statement object, where in gocql it gets handled for you automatically in the library.</p>\n\n<p>With the cassandra bug outstanding, I think you should stick to not using prepared statements and instead make queries like: <code>SELECT * FROM api_counters WHERE date = 'total';</code></p>\n"}, {"comments": [{"owner": {"reputation": 10892, "user_id": 4406006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dcbc151fab6abfc394bb9f47f1f5aa4?s=128&d=identicon&r=PG", "display_name": "Andy Tolbert", "link": "https://stackoverflow.com/users/4406006/andy-tolbert"}, "edited": false, "score": 0, "creation_date": 1422511273, "post_id": 28074624, "comment_id": 44780771, "body": "That looks like a great approach and a better way to model the data :)"}], "tags": [], "owner": {"reputation": 177, "user_id": 1050056, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1d384304ebfcbb7b1cca748bda4a1024?s=128&d=identicon&r=PG", "display_name": "Dalpapa", "link": "https://stackoverflow.com/users/1050056/dalpapa"}, "is_accepted": true, "score": 2, "last_activity_date": 1421866283, "creation_date": 1421866283, "answer_id": 28074624, "question_id": 28033756, "link": "https://stackoverflow.com/questions/28033756/gocql-select-doesnt-return-all-columns/28074624#28074624", "title": "gocql SELECT * doesn&#39;t return all columns", "body": "<p>Thanks Andy for your help.</p>\n\n<p>At first, I thought that considering what you told me, I would rather do a <code>SELCT column_name</code> on the <code>system.schema_columns</code> sometimes and refresh it when I alter my table. I would just then <code>strings.join()</code> the columns in my <code>SELECT FROM api_counters</code>. It worked but if I had 2 different instances, and one would update the schema and the other would receive a GET request, this one would not know the new column still.</p>\n\n<p>And then I rearranged my ideas and found out that there was obviously an other way of doing that and I simply change for this schema :\n<code>\nCREATE TABLE stats_dev.api_counters (\n    date text,\n    description text,\n    all counter,\n    PRIMARY KEY (date, description)\n);\n</code>\nand I am updating the field based on the description I am expecting. So far so good.</p>\n\n<p>I knew it was definitely Option 3 : my pattern was not the best one.</p>\n"}], "owner": {"reputation": 177, "user_id": 1050056, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1d384304ebfcbb7b1cca748bda4a1024?s=128&d=identicon&r=PG", "display_name": "Dalpapa", "link": "https://stackoverflow.com/users/1050056/dalpapa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1443, "favorite_count": 0, "accepted_answer_id": 28074624, "answer_count": 2, "score": 2, "last_activity_date": 1421866283, "creation_date": 1421702817, "question_id": 28033756, "link": "https://stackoverflow.com/questions/28033756/gocql-select-doesnt-return-all-columns", "title": "gocql SELECT * doesn&#39;t return all columns", "body": "<p>I came across this weird behaviour while trying to implement some counters for my application.\nBasically, I did a counter table like so :</p>\n\n<pre><code>CREATE TABLE stats_dev.log_counters (\n  date text PRIMARY KEY,\n  all counter\n);\n</code></pre>\n\n<p>Then I have some specific types of message I want to count as well, so in my Go app, I ALTER the table to add the column I didn't have before. </p>\n\n<p>My app is growing, and I start to have more than 30 columns (shouldn't be more than 50) and when I want to retrieve all those counters, some columns are missing in the result.</p>\n\n<pre><code>query := s.Query(`SELECT * FROM `+_apiCountersTable+` WHERE date IN ?`, dates)\nres, err := query.Iter().SliceMap()\n</code></pre>\n\n<p>This returns me something like 30 over 34 columns. Although, when I do the request on CQLSH :</p>\n\n<pre><code>cqlsh:stats_dev&gt; SELECT * FROM api_counters WHERE date = 'total';\n</code></pre>\n\n<p>I get the proper full result. So :</p>\n\n<ol>\n<li>Does that come from my request which should be different ?</li>\n<li>Could that come from <a href=\"https://github.com/gocql/gocql\" rel=\"nofollow\">gocql</a> driver ?</li>\n<li>Is that pattern completely stupid ?</li>\n</ol>\n\n<p>My temporary solution is to SELECT the column names from the <code>system.schema_columns</code> table and to strings.Join() all of that to my SELECT query ...</p>\n\n<p>Thank you very much for your help.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "is_accepted": true, "score": 28, "last_activity_date": 1421702777, "creation_date": 1421702777, "answer_id": 28033745, "question_id": 28033734, "link": "https://stackoverflow.com/questions/28033734/does-fmt-print-write-to-stdout-in-golang/28033745#28033745", "title": "Does fmt.Print() write to stdout in GoLang?", "body": "<p>From <a href=\"https://golang.org/pkg/fmt/#Print\" rel=\"noreferrer\">the documentation</a>:</p>\n\n<blockquote>\n  <p>Print formats using the default formats for its operands and writes to standard output.</p>\n</blockquote>\n\n<p>So yep, it writes to stdout.</p>\n"}, {"comments": [{"owner": {"reputation": 179, "user_id": 4818860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20373e0b1118eb0f251857f2b6bf2f0e?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey", "link": "https://stackoverflow.com/users/4818860/sergey"}, "edited": false, "score": 1, "creation_date": 1551782571, "post_id": 28033757, "comment_id": 96757171, "body": "There is must be a bug in documentation or code. Now docs says it standard output, but test  prog outputs to stderr. My go version is 1.11.5. More fresh versions seems to fmt.Print to stdout"}], "tags": [], "owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "is_accepted": false, "score": 4, "last_activity_date": 1421702823, "creation_date": 1421702823, "answer_id": 28033757, "question_id": 28033734, "link": "https://stackoverflow.com/questions/28033734/does-fmt-print-write-to-stdout-in-golang/28033757#28033757", "title": "Does fmt.Print() write to stdout in GoLang?", "body": "<p>From the <a href=\"http://golang.org/pkg/fmt/#Print\" rel=\"nofollow\">Print documentation</a>: <em>Print formats using the default formats for its operands and writes to standard output.</em></p>\n"}, {"tags": [], "owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "is_accepted": false, "score": 13, "last_activity_date": 1421702954, "creation_date": 1421702954, "answer_id": 28033784, "question_id": 28033734, "link": "https://stackoverflow.com/questions/28033734/does-fmt-print-write-to-stdout-in-golang/28033784#28033784", "title": "Does fmt.Print() write to stdout in GoLang?", "body": "<p>Yes, it does. <a href=\"https://github.com/golang/go/blob/go1.4.1/src/fmt/print.go#L228-L233\" rel=\"noreferrer\">From the source code</a>:</p>\n\n<pre><code>// Print formats using the default formats for its operands and writes to standard output.\n// Spaces are added between operands when neither is a string.\n// It returns the number of bytes written and any write error encountered.\nfunc Print(a ...interface{}) (n int, err error) {\n    return Fprint(os.Stdout, a...)\n}\n</code></pre>\n\n<p><code>os.Stdout</code> indeed represents the standard output stream.</p>\n"}], "owner": {"reputation": 2291, "user_id": 2840324, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/YzSB6.jpg?s=128&g=1", "display_name": "biw", "link": "https://stackoverflow.com/users/2840324/biw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27675, "favorite_count": 1, "accepted_answer_id": 28033745, "answer_count": 3, "score": 27, "last_activity_date": 1421702954, "creation_date": 1421702715, "question_id": 28033734, "link": "https://stackoverflow.com/questions/28033734/does-fmt-print-write-to-stdout-in-golang", "title": "Does fmt.Print() write to stdout in GoLang?", "body": "<p>I may be overthinking this too much, but in GoLang, does <code>fmt.Print()</code> write to stdout or do I have to use <code>os.Stdout.Write</code>?</p>\n"}, {"tags": ["http", "asynchronous", "go"], "comments": [{"owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "edited": false, "score": 1, "creation_date": 1421702372, "post_id": 28033565, "comment_id": 44452218, "body": "if you can&#39;t related the ack to your request, then the acks are completely useless. no ? Handle the ack on the same channel of the request. Use a token to identify the request (generate a uuid and pass that along)."}, {"owner": {"reputation": 1447, "user_id": 3570747, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/RKIuH.png?s=128&g=1", "display_name": "vastlysuperiorman", "link": "https://stackoverflow.com/users/3570747/vastlysuperiorman"}, "reply_to_user": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "edited": false, "score": 0, "creation_date": 1421703706, "post_id": 28033565, "comment_id": 44452821, "body": "The ack will have a uuid that matches up with a request (or in this example, a name string). In the &quot;Note&quot; I have used &quot;bob&quot; as the name string that matches a request with an ack. The problem is that the ack may come after the request times out, or never at all. The question is how do I handle late/absent acks?"}], "answers": [{"comments": [{"owner": {"reputation": 1447, "user_id": 3570747, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/RKIuH.png?s=128&g=1", "display_name": "vastlysuperiorman", "link": "https://stackoverflow.com/users/3570747/vastlysuperiorman"}, "edited": false, "score": 0, "creation_date": 1421710518, "post_id": 28034310, "comment_id": 44455611, "body": "This answer addresses the underlying problem in my thinking: I was looking for a way to keep track of which acks are valid and invalid. The more effective way is to keep track of which requests are valid and invalidate all unrelated acks."}], "tags": [], "owner": {"reputation": 5661, "user_id": 3179857, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/74a01200b8e1bc8b9b57ddd5633288bc?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/3179857/evan"}, "is_accepted": true, "score": 1, "last_activity_date": 1421705143, "creation_date": 1421705143, "answer_id": 28034310, "question_id": 28033565, "link": "https://stackoverflow.com/questions/28033565/golang-clean-items-out-of-channel-that-will-not-be-read/28034310#28034310", "title": "Golang clean items out of channel that will not be read", "body": "<p>Keep a <code>map</code> of \"uuids in process\"; when you receive a <code>/start/</code> add it to the map, and when you receive an <code>ack</code> (or when the request times out) remove it. If you receive an ack that isn't in the map, discard it immediately.</p>\n\n<p>Be careful, as maps are not thread-safe by default.</p>\n"}, {"comments": [{"owner": {"reputation": 1447, "user_id": 3570747, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/RKIuH.png?s=128&g=1", "display_name": "vastlysuperiorman", "link": "https://stackoverflow.com/users/3570747/vastlysuperiorman"}, "edited": false, "score": 0, "creation_date": 1421771225, "post_id": 28043203, "comment_id": 44482759, "body": "I appreciate this response. It would appear that the wording of my question was poor. There are three interacting services in this scenario: the client who sends requests, the controller for which the code is given, and an external set of servers that send acks to the controller when work is finished. From the perspective of the controller, random requests and acks are arriving all the time, and these are not necessarily in a particular order. Because of this, there isn&#39;t a &quot;sequential&quot; way to handle the requests and acks. I hope that clarifies the situation."}], "tags": [], "owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "is_accepted": false, "score": 0, "last_activity_date": 1421750301, "creation_date": 1421750301, "answer_id": 28043203, "question_id": 28033565, "link": "https://stackoverflow.com/questions/28033565/golang-clean-items-out-of-channel-that-will-not-be-read/28043203#28043203", "title": "Golang clean items out of channel that will not be read", "body": "<p>It seems like you might be trying to write Go in the asynchronous style of Akka. This is a hard choice; idiomatic Go should be easier. The flaw is here: \"<em>I cannot assume that a given ack is related the the request I am blocking on</em>\".</p>\n\n<p>Instead, you need to handle each request with simple sequential steps and send the ack directly back to its client. For this, each request would need its own service goroutine.</p>\n"}], "owner": {"reputation": 1447, "user_id": 3570747, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/RKIuH.png?s=128&g=1", "display_name": "vastlysuperiorman", "link": "https://stackoverflow.com/users/3570747/vastlysuperiorman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 605, "favorite_count": 0, "accepted_answer_id": 28034310, "answer_count": 2, "score": 2, "last_activity_date": 1421771623, "creation_date": 1421701999, "last_edit_date": 1421771623, "question_id": 28033565, "link": "https://stackoverflow.com/questions/28033565/golang-clean-items-out-of-channel-that-will-not-be-read", "title": "Golang clean items out of channel that will not be read", "body": "<p>I am working on an http endpoint that will receive a request from a client and block until it receives an \"ack\" for that request from another server or until it passes a timeout. The communication between my code and the server is not included in this sample, but you can assume that for each request, an ack may be received eventually.</p>\n\n<p>Since many requests will pass through my module in short periods of time, I cannot assume that a given ack is related the the request I am blocking on. <strong>EDIT:</strong> Clarification here since it has caused some confusion. Both requests and acks are received by the controller from external sources. This is why I am handling them asychronously. <strong>/EDIT</strong> For this reason, my code places acks back on the channel if they are not relevant. It is also important to note that http.ListenAndServe calls my functions asynchronously.</p>\n\n<p>If the request is acked within the timeout, there are no problems. However, it the ack comes after the timeout has passed, it will be added to a channel and never removed. This will cause the channel to fill up. I am afraid to use a \"cancel\" channel because it is also possible that no ack will be received for a given request, causing the cancel channel to fill as well. </p>\n\n<p><strong>The Question</strong>: How can I keep late acks from filling my channel?/How can I identify and remove late acks?</p>\n\n<p>Code below. No play.golang.org link because http.ListenAndServe :/</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"time\"\n)\n\nconst timeout = 10\n\nfunc startEndpoint(w http.ResponseWriter, r *http.Request) {\n    var ack string\n    timer := time.NewTimer(time.Second * timeout)\n    defer timer.Stop()\n\n    m := r.RequestURI[len(\"/start/\"):]\n    fmt.Print(m)\nAckRecycle:\n    for {\n        select {\n        case ack = &lt;-acks:\n            if ack == m {\n                //What we found was our own ack\n                fmt.Print(\"+\")\n                w.Write([]byte(\"Ack received for \" + ack))\n                break AckRecycle\n            } else {\n                //What we found on the channel wasn't for us\n                fmt.Print(\".\")\n                time.Sleep(time.Millisecond * 100)\n                acks &lt;- ack\n            }\n        case &lt;-timer.C:\n            //We ran out of time waiting for our ack\n            w.Write([]byte(\"Timeout waiting for \" + m))\n            break AckRecycle\n        default:\n            //Channel was empty\n            fmt.Print(\"-\")\n            time.Sleep(time.Millisecond * 100)\n        }\n    }\n    return\n}\n\nfunc ackEndpoint(w http.ResponseWriter, r *http.Request) {\n    ack := r.RequestURI[len(\"/ack/\"):]\n    acks &lt;- ack\n    fmt.Print(\"Ack for \" + ack)\n    w.Write([]byte(\"Thanks!\"))\n    return\n}\n\nvar acks = make(chan string, 10)\n\nfunc main() {\n    http.HandleFunc(\"/ack/\", ackEndpoint)\n    http.HandleFunc(\"/start/\", startEndpoint)\n\n    http.ListenAndServe(\"127.0.0.1:8888\", nil)\n}\n</code></pre>\n\n<p><strong>NOTE</strong>: To test this, run it on your local machine. Curl/Wget <code>127.0.0.1:8888/start/bob</code> and then Curl/Wget <code>127.0.0.1:8888/ack/bob</code>. You can replace bob with any string to see the behavior.</p>\n\n<p>I'm new to Go. Feel free to provide other feedback in the comments. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1428701282, "post_id": 28033358, "comment_id": 47291271, "body": "BTW, if you&#39;re just going to panic on <code>!ok</code> just leave it out and do <code>docs := foo.([]interface {})</code>. The one variable version of a type assert panics on its own if the type doesn&#39;t match."}], "answers": [{"comments": [{"owner": {"reputation": 3829, "user_id": 1146334, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cL3do.png?s=128&g=1", "display_name": "FuriousGeorge", "link": "https://stackoverflow.com/users/1146334/furiousgeorge"}, "edited": false, "score": 0, "creation_date": 1421702252, "post_id": 28033406, "comment_id": 44452159, "body": "But how does it know the &#39;true&#39; type?  In my case, foo is the <code>.Value</code> of a bson.D <a href=\"http://bazaar.launchpad.net/+branch/mgo/v2/view/head:/bson/bson.go#L121\" rel=\"nofollow noreferrer\">bazaar.launchpad.net/+branch/mgo/v2/view/head:/bson/&hellip;</a> , which is interface{}.  So how does the loop magically know what the values are if I&#39;ve created a variable that is a []interface{}"}, {"owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "reply_to_user": {"reputation": 3829, "user_id": 1146334, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cL3do.png?s=128&g=1", "display_name": "FuriousGeorge", "link": "https://stackoverflow.com/users/1146334/furiousgeorge"}, "edited": false, "score": 0, "creation_date": 1421702628, "post_id": 28033406, "comment_id": 44452315, "body": "No, the loop doesn&#39;t know the type of what&#39;s inside <code>docs</code>. <code>doc</code> is <code>interface{}</code>. However, when you use <code>reflect.TypeOf()</code>, TypeOf knows it is a interface{} (using reflection) but doesn&#39;t print that, but the type of the value inside the interface."}, {"owner": {"reputation": 1582, "user_id": 3486065, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/EozB4.png?s=128&g=1", "display_name": "Taco de Wolff", "link": "https://stackoverflow.com/users/3486065/taco-de-wolff"}, "edited": false, "score": 1, "creation_date": 1421706782, "post_id": 28033406, "comment_id": 44454223, "body": "Go stores both a pointer to the data and a pointer to the meta data when you store an interface{}. It is this meta data that conveys the actual type of the data that interface{} is pointing to. Reflect uses this meta data to return the actual type, also see <a href=\"http://research.swtch.com/interfaces\" rel=\"nofollow noreferrer\">research.swtch.com/interfaces</a> for more information"}, {"owner": {"reputation": 3829, "user_id": 1146334, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cL3do.png?s=128&g=1", "display_name": "FuriousGeorge", "link": "https://stackoverflow.com/users/1146334/furiousgeorge"}, "edited": false, "score": 0, "creation_date": 1421710489, "post_id": 28033406, "comment_id": 44455596, "body": "But how does it know that it is a bson.D?  The data that could be in Value is coming across the wire and being stored in Value, which is an <code>interface{}</code>.  It could be a string, []unit8, bson.D, who knows.  Nobody knows until runtime. This particularly vexing because I want to type assert it to a bson.M, which should be functionally equivalent, but it&#39;s telling me that it&#39;s a bson.D and panics."}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "reply_to_user": {"reputation": 3829, "user_id": 1146334, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cL3do.png?s=128&g=1", "display_name": "FuriousGeorge", "link": "https://stackoverflow.com/users/1146334/furiousgeorge"}, "edited": false, "score": 1, "creation_date": 1421730819, "post_id": 28033406, "comment_id": 44460526, "body": "@FuriousGeorge what is unmarshalling your data?"}, {"owner": {"reputation": 1582, "user_id": 3486065, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/EozB4.png?s=128&g=1", "display_name": "Taco de Wolff", "link": "https://stackoverflow.com/users/3486065/taco-de-wolff"}, "reply_to_user": {"reputation": 3829, "user_id": 1146334, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cL3do.png?s=128&g=1", "display_name": "FuriousGeorge", "link": "https://stackoverflow.com/users/1146334/furiousgeorge"}, "edited": false, "score": 0, "creation_date": 1421748856, "post_id": 28033406, "comment_id": 44468402, "body": "@FuriousGeorge The type is only known at runtime indeed. When the function returns an <code>interface{}</code> it was already set to <code>bson.D</code>, <code>string</code>, ... inside that function. It could be anything at compile time, but it&#39;s only ever one type at runtime, and you can retrieve the type from the interface meta data. What exactly panics? <code>doc</code> inside your loop is <code>interface{}</code> at compile time, so you can just type assert it to <code>bson.M</code>: <code>if docM, ok := doc.(bson.M); ok { ... }</code>"}, {"owner": {"reputation": 3829, "user_id": 1146334, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cL3do.png?s=128&g=1", "display_name": "FuriousGeorge", "link": "https://stackoverflow.com/users/1146334/furiousgeorge"}, "reply_to_user": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 0, "creation_date": 1421762882, "post_id": 28033406, "comment_id": 44476878, "body": "I think @jmaloney hit it on the head.  I just dug through the lib source, and it was using an Unmarshaller which uses a decoder which creates the elements based on the type that you are unmarshalling into <a href=\"http://bazaar.launchpad.net/+branch/mgo/v2/view/head:/bson/decode.go#L125\" rel=\"nofollow noreferrer\">bazaar.launchpad.net/+branch/mgo/v2/view/head:/bson/&hellip;</a>.   Makes much more sense now."}], "tags": [], "owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "is_accepted": false, "score": 3, "last_activity_date": 1421701274, "creation_date": 1421701274, "answer_id": 28033406, "question_id": 28033358, "link": "https://stackoverflow.com/questions/28033358/golang-range-type-conversion/28033406#28033406", "title": "Golang range type conversion", "body": "<p><a href=\"http://golang.org/pkg/reflect/#TypeOf\" rel=\"nofollow\">TypeOf documentation</a> says: <em>TypeOf returns the reflection Type of the value in the interface{}. TypeOf(nil) returns nil.</em></p>\n\n<p>So <code>doc</code> is of type interface{} but <code>TypeOf</code> returns its \"true\" type.</p>\n"}], "owner": {"reputation": 3829, "user_id": 1146334, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cL3do.png?s=128&g=1", "display_name": "FuriousGeorge", "link": "https://stackoverflow.com/users/1146334/furiousgeorge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 684, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1421701274, "creation_date": 1421701097, "question_id": 28033358, "link": "https://stackoverflow.com/questions/28033358/golang-range-type-conversion", "title": "Golang range type conversion", "body": "<p>I'm very confused by this code that I have:</p>\n\n<pre><code>docs, ok := foo.([]interface {})\nif !ok{ panic(\"assertion failed\") }\n\nfmt.Println(\"The type of docs: \", reflect.TypeOf(docs))\nfor _, doc := range docs {\n    fmt.Println(\"Doc Type: \", reflect.TypeOf(doc))\n}\n</code></pre>\n\n<p>The output when I run this is:</p>\n\n<pre><code>The type of docs: []interface {}\nDoc type: bson.D\n</code></pre>\n\n<p>I don't get it.  I type assert foo to  <code>[]interface{}</code> and store it in docs.  That works as expected, but then in the loop, the first thing I print out is the type of <code>doc</code> and it says it's <code>bson.D</code>.  How is it not <code>interface {}</code>?? I even changed the name of <code>doc</code> to <code>bar</code> thinking maybe it was a scoping issue or something, but I get the same results. </p>\n"}, {"tags": ["json", "go", "unmarshalling"], "answers": [{"comments": [{"owner": {"reputation": 1290, "user_id": 1034994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c1a2f73dcd63970c6acdba13c4ac72b?s=128&d=identicon&r=PG", "display_name": "KayoticSully", "link": "https://stackoverflow.com/users/1034994/kayoticsully"}, "edited": false, "score": 0, "creation_date": 1421712985, "post_id": 28033476, "comment_id": 44456308, "body": "Thank you, that works wonderfully.  I did not think to use RawMessage!"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 21, "last_activity_date": 1597403875, "last_edit_date": 1597403875, "creation_date": 1421701600, "answer_id": 28033476, "question_id": 28033277, "link": "https://stackoverflow.com/questions/28033277/decoding-generic-json-objects-to-one-of-many-formats/28033476#28033476", "title": "Decoding generic JSON objects to one of many formats", "body": "<p>One way to handle this is to define a struct for the fixed part of the message with a <a href=\"http://godoc.org/encoding/json#RawMessage\" rel=\"nofollow noreferrer\">json.RawMessage</a> field to capture the variant part of the message. Decode the json.RawMessage to a type specific to the variant:</p>\n<pre><code>type Message struct {\n  Type      string `json:&quot;type&quot;`\n  Timestamp string `json:&quot;timestamp&quot;`\n  Data      json.RawMessage\n}  \n\ntype Event struct {\n   Type    string `json:&quot;type&quot;`\n   Creator string `json:&quot;creator&quot;`\n}\n\n\nvar m Message\nif err := json.Unmarshal(data, &amp;m); err != nil {\n    log.Fatal(err)\n}\nswitch m.Type {\ncase &quot;event&quot;:\n    var e Event\n    if err := json.Unmarshal([]byte(m.Data), &amp;e); err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(m.Type, e.Type, e.Creator)\ndefault:\n    log.Fatal(&quot;bad message type&quot;)\n}\n</code></pre>\n<p><a href=\"https://play.golang.org/p/HIsJAOyauvp\" rel=\"nofollow noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 1290, "user_id": 1034994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c1a2f73dcd63970c6acdba13c4ac72b?s=128&d=identicon&r=PG", "display_name": "KayoticSully", "link": "https://stackoverflow.com/users/1034994/kayoticsully"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5604, "favorite_count": 6, "accepted_answer_id": 28033476, "answer_count": 1, "score": 5, "last_activity_date": 1597403875, "creation_date": 1421700776, "last_edit_date": 1569304287, "question_id": 28033277, "link": "https://stackoverflow.com/questions/28033277/decoding-generic-json-objects-to-one-of-many-formats", "title": "Decoding generic JSON objects to one of many formats", "body": "<p>I am working on a general JSON based message passing protocol in Go. What I would like to do is have a <code>BaseMessage</code> that has general information like <code>Type</code>, <code>timestamp</code>, etc.  But at the same time I want to be able to define more specific message structures for certain types of data.</p>\n\n<p>For example:</p>\n\n<pre><code>type Message struct {\n    Type      string `json:type`\n    Timestamp string `json:timestamp`\n\n}\n\ntype EventMessage struct {\n    Message\n    EventType string\n    EventCreator string\n    EventData interface{}\n}\n</code></pre>\n\n<p>I have a set of handlers and to determine which handler should process the message I decode the JSON to the general <code>Message</code> type first to check the <code>Type</code> field.  For this example I would get the handler associated with an \"Event\" message type.  </p>\n\n<p><strong>I run into problems when I then want to assert the <code>EventMessage</code> type onto the structure.</strong></p>\n\n<p>The following code is very rough, but hopefully it displays my general idea of how I am trying to handle the messages.</p>\n\n<pre><code>type Handler func(msg Message) Message\nhandlers := make(map[string]Handler)\n\nvar msg Message\ndecoder.Decode(&amp;msg)\nhandler := handlers[msg.Type]\nhandler(msg)\n</code></pre>\n\n<p>I have tried to use an <code>interface{}</code> but then the JSON decoder just creates a map which I then cant assert either type on.  I have figured out workarounds that make it possible, but its very ugly, probably not efficient, and most likely error prone. I would like to keep things simple and straightforward so this code can be easily maintained.</p>\n\n<p><strong>Is there a method of handling generic JSON objects in Go so that the decoded JSON could be one of many struct formats?</strong></p>\n\n<p>I have also played with the idea of having more specific info in a <code>Data interface{}</code> in the main <code>Message</code> struct, but then I run into the same problem of not being able to assert any types onto the interface.  There has to be a better way to handle JSON formats that I am just missing.</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1484574581, "post_id": 28033114, "comment_id": 70552854, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/26794225/google-go-appengine-imports-and-conflicts-when-serving-testing\">Google Go AppEngine imports and conflicts when serving / testing</a>"}], "answers": [{"comments": [{"owner": {"reputation": 584, "user_id": 2528719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ef4da676524b97d525de1c3a5ad3e87?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2528719/aaron"}, "edited": false, "score": 0, "creation_date": 1460725156, "post_id": 28033189, "comment_id": 60889035, "body": "Here&#39;s an updated link for <a href=\"https://cloud.google.com/appengine/docs/go/runtime#Go_Organizing_Go_apps\" rel=\"nofollow noreferrer\">Organizing Go Apps</a>"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1460728226, "last_edit_date": 1460728226, "creation_date": 1421700346, "answer_id": 28033189, "question_id": 28033114, "link": "https://stackoverflow.com/questions/28033114/go-package-conflict/28033189#28033189", "title": "Go Package Conflict", "body": "<p>Rename the package to a non-conflicting name as in #1.  Import the package using the path \"apptemplates\".  </p>\n\n<p>Packages inside of the application directory (the directory containing app.yaml) are imported with a path relative to the application directory. See <a href=\"https://cloud.google.com/appengine/docs/go/runtime#Go_Organizing_Go_apps\" rel=\"nofollow\">Organizing Go Apps</a> for the complete details.</p>\n"}], "owner": {"reputation": 1954, "user_id": 110844, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4afd458cb202c0a2e566e569f753765?s=128&d=identicon&r=PG", "display_name": "Ecognium", "link": "https://stackoverflow.com/users/110844/ecognium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1420, "favorite_count": 2, "accepted_answer_id": 28033189, "answer_count": 1, "score": 3, "last_activity_date": 1460728226, "creation_date": 1421699997, "question_id": 28033114, "link": "https://stackoverflow.com/questions/28033114/go-package-conflict", "title": "Go Package Conflict", "body": "<p>I am new to Go and AppEngine. I am trying to figure out how to create packages but I keep running into conflicts. My directory structure is below:</p>\n\n<pre><code>GOPATH\n third-party-libs \n app \n  app.yaml\n  controllers\n     default.go -- package controllers\n   models\n     models.go -- package models\n   templates\n     templates.go  -- package templates\n</code></pre>\n\n<p>I am importing the templates package as follows <code>import (\"app/templates\")</code> inside <code>default.go</code></p>\n\n<p>When I do <code>goapp serve</code> I get this error:</p>\n\n<pre><code>Failed parsing input: app file templates.go conflicts with \nsame file imported from GOPATH\n</code></pre>\n\n<p>I have tried a bunch of things and nothing has worked so far. These are things I have tried:</p>\n\n<ol>\n<li><p>Changed the <code>templates</code> directory to <code>apptemplates</code> and the corresponding file to <code>apptemplates.go</code>, changed package name to <code>apptemplates</code>. I imported it as <code>app/apptemplates</code></p></li>\n<li><p>I tried different combinations by changing the file name but not the package name, vice versa, etc. Either it does not find the file or has a conflict. </p></li>\n<li><p>I am importing <code>html/template</code> in my <code>templates.go</code> file. So I commented out the entire file just keeping the package declaration but did not make the conflict go away</p></li>\n</ol>\n\n<p>I thought may be another file is named templates.go but when I do this (at the <code>GOPATH</code> level) <code>find . -name \"*.go\" | grep \"templates.go\"</code> I only see the one file I have created.</p>\n\n<p>I am confused as to how packages are created. I have changed the name to something generic so it does not look like a naming issue. Can someone please tell me how I can debug this error?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["sql", "go"], "answers": [{"comments": [{"owner": {"reputation": 1826, "user_id": 3765772, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3b49d13ba84f10dbe67af56729f9951?s=128&d=identicon&r=PG&f=1", "display_name": "R.J. Robinson", "link": "https://stackoverflow.com/users/3765772/r-j-robinson"}, "edited": false, "score": 0, "creation_date": 1421698218, "post_id": 28032713, "comment_id": 44450180, "body": "Thank you. New to Golang. Thumbs Up!"}], "tags": [], "owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "is_accepted": true, "score": 2, "last_activity_date": 1421698101, "creation_date": 1421698101, "answer_id": 28032713, "question_id": 28032648, "link": "https://stackoverflow.com/questions/28032648/casting-conversion-of-int-to-int32/28032713#28032713", "title": "Casting conversion of int to int32", "body": "<p><code>len(array)</code> returns an <code>int</code> convert it to an int32 int32(len(array)) or convert perPage to an <code>int</code> </p>\n"}], "owner": {"reputation": 1826, "user_id": 3765772, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3b49d13ba84f10dbe67af56729f9951?s=128&d=identicon&r=PG&f=1", "display_name": "R.J. Robinson", "link": "https://stackoverflow.com/users/3765772/r-j-robinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 28032713, "answer_count": 1, "score": 0, "last_activity_date": 1421698101, "creation_date": 1421697847, "question_id": 28032648, "link": "https://stackoverflow.com/questions/28032648/casting-conversion-of-int-to-int32", "title": "Casting conversion of int to int32", "body": "<p>I am working on pulling in rows from the Db and storing the results in a Slice/Array</p>\n\n<p>I need to calculate the totalRecords &amp; totalPages. </p>\n\n<pre><code>pseudoCode :: \nperPage int32 := ( some number ) \ntotalRecords := len(array)\ntotalPages := perPage/totalRecords\n</code></pre>\n\n<p>I keep getting this error. </p>\n\n<pre><code>terminal::\n`invalid operation: perPage / totalRecords (mismatched types int32 and int)`\n</code></pre>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 64, "user_id": 1447789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ef6c4b2cccc9969ec837ce7163a60fdb?s=128&d=identicon&r=PG", "display_name": "Deliri", "link": "https://stackoverflow.com/users/1447789/deliri"}, "edited": false, "score": 0, "creation_date": 1421700040, "post_id": 28032603, "comment_id": 44451095, "body": "I also tried,     c := session.DB(&quot;mydb&quot;).C(&quot;customers&quot;) \tgt := 100000 \tfn := 1 \tsn := 1  \tvar results []Customer \terr = c.Find( \t\tbson.M{ \t\t\t&quot;acct_bal&quot;: bson.M{ \t\t\t\t&quot;$gt&quot;:       gt, \t\t\t\t&quot;firstName&quot;: fn, \t\t\t\t&quot;surname&quot;:   sn, \t\t\t}, \t\t}).All(&amp;results)  Now I&#39;m not getting errors but the result is &quot;nil&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1421714756, "last_edit_date": 1421714756, "creation_date": 1421714353, "answer_id": 28035980, "question_id": 28032603, "link": "https://stackoverflow.com/questions/28032603/specifying-a-query-in-mongodb-using-go/28035980#28035980", "title": "Specifying a query in MongoDB using Go", "body": "<p>The Javascript statement</p>\n\n<pre><code>db.customers.find({acct_balance:{$gt:100000}}, {firstName: 1, surname:1, acct_balance:1, _id:0})\n</code></pre>\n\n<p>translated to Go / mgo is:</p>\n\n<pre><code> c := db.C(\"customers\")\n var results []Customer\n err := c.Find(bson.M{\"acct_balance\": bson.M{\"$gt\":100000}}).\n       Select(bson.M{\"firstName\": 1, \"surname\":1, \"acct_balance\": 1}).\n       All(&amp;results)\n if err != nil {\n     // handle error\n }\n</code></pre>\n\n<p>The Javascript <a href=\"http://docs.mongodb.org/manual/reference/method/db.collection.find/\" rel=\"nofollow\">find</a> method has two arguments, the <a href=\"http://docs.mongodb.org/manual/reference/glossary/#term-query\" rel=\"nofollow\">query</a> and the <a href=\"http://docs.mongodb.org/manual/reference/glossary/#term-projection\" rel=\"nofollow\">projection</a>. In the mgo, the query is specified by the single argument to <a href=\"http://godoc.org/gopkg.in/mgo.v2#Collection.Find\" rel=\"nofollow\">Find</a> and the projection is specified by the single argument to <a href=\"http://godoc.org/gopkg.in/mgo.v2#Query.Select\" rel=\"nofollow\">Select</a>. </p>\n\n<p>The code in the question merges the query and projection into the argument for Find. This does not work.</p>\n"}], "owner": {"reputation": 64, "user_id": 1447789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ef6c4b2cccc9969ec837ce7163a60fdb?s=128&d=identicon&r=PG", "display_name": "Deliri", "link": "https://stackoverflow.com/users/1447789/deliri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 574, "favorite_count": 0, "accepted_answer_id": 28035980, "answer_count": 1, "score": 0, "last_activity_date": 1421727718, "creation_date": 1421697674, "last_edit_date": 1421727718, "question_id": 28032603, "link": "https://stackoverflow.com/questions/28032603/specifying-a-query-in-mongodb-using-go", "title": "Specifying a query in MongoDB using Go", "body": "<p>Confused about how to translate the Javascript JSON commands back into something go will understand. </p>\n\n<p>Ok so here's the query in the mongo shell:: </p>\n\n<pre><code>db.customers.find({acct_balance:{$gt:100000}}, {firstName: 1, surname:1, acct_balance:1, _id:0})\n</code></pre>\n\n<p>Results :: </p>\n\n<p>{ \"firstName\" : \"Susann\", \"surname\" : \"Ulisch\", \"acct_balance\" : 238897.45}\n{ \"firstName\" : \"Parker\", \"surname\" : \"Peet\", \"acct_balance\" : 443314.13 }</p>\n\n<p>Now I wanted to replicate that query in Go.</p>\n\n<pre><code>c := session.DB(\"mydb\").C(\"customers\")\nquery := []bson.M{}\nquery[\"firstName\"] = append(bson.M{\"firstName\": \"1\"})\nquery[\"surname\"] = append(bson.M{\"surname\": \"1\"})\nquery[\"$gte\"] = []bson.M{}\nquery[\"$gte\"] = append(query[\"$gte\"].([]bson.M), bson.M{\"acct_bal\": 100000})\n</code></pre>\n\n<p>Is there a way to easily translate JSON queries from the mongo shell back to something that you can use in Go? There is some confusion in my mind as to how you use the $gte, $lte key words back into something for go format. </p>\n"}, {"tags": ["google-app-engine", "go", "localhost", "cloud9-ide"], "comments": [{"owner": {"reputation": 9369, "user_id": 71079, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3e302415f77b6c398abc0b16efc653f3?s=128&d=identicon&r=PG", "display_name": "Ralph Caraveo", "link": "https://stackoverflow.com/users/71079/ralph-caraveo"}, "edited": false, "score": 0, "creation_date": 1421696692, "post_id": 28032055, "comment_id": 44449399, "body": "Trying binding using: <a href=\"http://0.0.0.0:8080\" rel=\"nofollow noreferrer\">0.0.0.0:8080</a>"}, {"owner": {"reputation": 191, "user_id": 3637821, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fca2c3f877a78274fb19b57af2672ba6?s=128&d=identicon&r=PG&f=1", "display_name": "vvincirey", "link": "https://stackoverflow.com/users/3637821/vvincirey"}, "reply_to_user": {"reputation": 9369, "user_id": 71079, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3e302415f77b6c398abc0b16efc653f3?s=128&d=identicon&r=PG", "display_name": "Ralph Caraveo", "link": "https://stackoverflow.com/users/71079/ralph-caraveo"}, "edited": false, "score": 0, "creation_date": 1421778341, "post_id": 28032055, "comment_id": 44487010, "body": "i have set $IP as 0.0.0.0 and $PORT as 8080, but still its not working"}], "answers": [{"tags": [], "owner": {"reputation": 191, "user_id": 3637821, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fca2c3f877a78274fb19b57af2672ba6?s=128&d=identicon&r=PG&f=1", "display_name": "vvincirey", "link": "https://stackoverflow.com/users/3637821/vvincirey"}, "is_accepted": true, "score": 1, "last_activity_date": 1430667191, "creation_date": 1430667191, "answer_id": 30015684, "question_id": 28032055, "link": "https://stackoverflow.com/questions/28032055/how-to-open-localhost8080-in-cloud9-ide/30015684#30015684", "title": "How to open localhost:8080 in Cloud9 IDE?", "body": "<p>I see some users are looking for the answer for this, So here is how to do it.</p>\n\n<p>instead of \"goapp serve\" use \"goapp serve -host 0.0.0.0\"</p>\n\n<p>credits to Cloud9 support team.</p>\n"}, {"tags": [], "owner": {"reputation": 5378, "user_id": 5934465, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/deTzi.jpg?s=128&g=1", "display_name": "xgqfrms", "link": "https://stackoverflow.com/users/5934465/xgqfrms"}, "is_accepted": false, "score": 2, "last_activity_date": 1481068252, "last_edit_date": 1495540446, "creation_date": 1481068252, "answer_id": 41007050, "question_id": 28032055, "link": "https://stackoverflow.com/questions/28032055/how-to-open-localhost8080-in-cloud9-ide/41007050#41007050", "title": "How to open localhost:8080 in Cloud9 IDE?", "body": "<h1>Available ports on a hosted Cloud9 workspace</h1>\n\n<blockquote>\n  <p>If you're developing a server application, please note that you need\n  to listen to 0.0.0.0 ($IP) and 8080 ($PORT). Listening to this port\n  will enable your app to be viewable at <a href=\"https://-.c9users.io\" rel=\"nofollow noreferrer\">https://-.c9users.io</a></p>\n  \n  <p>You can also bind to ports 8081, and 8082, which can be accessed by\n  <a href=\"https://-.c9users.io:8081\" rel=\"nofollow noreferrer\">https://-.c9users.io:8081</a> and <a href=\"https://-.c9users.io:8082\" rel=\"nofollow noreferrer\">https://-.c9users.io:8082</a> respectively.</p>\n  \n  <p>Please note that 8080, 8081, and 8082 are the only available ports on\n  a hosted Cloud9 workspace.</p>\n</blockquote>\n\n<p><a href=\"https://stackoverflow.com/questions/15990818/how-to-connect-to-the-process-running-on-localhost-that-is-inside-of-cloud9-se/41006916#41006916\">How to connect to the process running on &#39;localhost&#39; that is inside of cloud9 server</a></p>\n"}, {"tags": [], "owner": {"reputation": 947, "user_id": 5398328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HJFvi.jpg?s=128&g=1", "display_name": "nanselm2", "link": "https://stackoverflow.com/users/5398328/nanselm2"}, "is_accepted": false, "score": 1, "last_activity_date": 1521669083, "last_edit_date": 1521669083, "creation_date": 1519825899, "answer_id": 49031161, "question_id": 28032055, "link": "https://stackoverflow.com/questions/28032055/how-to-open-localhost8080-in-cloud9-ide/49031161#49031161", "title": "How to open localhost:8080 in Cloud9 IDE?", "body": "<p>For Google App Engine running Python, the command would be</p>\n\n<p><code>dev_appserver.py app.yaml  --host $IP --port $PORT --admin_host $IP --admin_port 8081</code></p>\n\n<p>You can also specify the admin host/port. Since Cloud 9 allows access to 8081 and 8082, you can use either of those as your admin ports. For me, the admin console did not open with the Cloud9 preview, but did open in a new tab within my browser.</p>\n\n<p>$IP and $PORT are both environment variables for Cloud 9, with the values of 0.0.0.0 and 8080 respectively. </p>\n\n<p><strong>Edit:</strong> \nWith the most recent gcloud update (March 2018), you don't have to change the IP or PORT, but you do need to figure out how to work around the host whitelisting issue. \nMy non-ideal workaround is to add a flag to not check for hosts <code>--enable_host_checking=false</code>.</p>\n\n<p><code>dev_appserver.py app.yaml --enable_host_checking=false</code></p>\n\n<p>There's an unanswered Cloud 9 post around this issue (<a href=\"https://community.c9.io/t/request-host-not-whitelisted-when-running-flask/22329%20--enable_host_checking\" rel=\"nofollow noreferrer\">link to c9 forum</a>). My guess is that you can add $C9_HOSTNAME as the host, but that doesn't quite work for me.</p>\n\n<p><strong>Interactive Console</strong></p>\n\n<p>If you want to use the interactive console you need to assign the admin port and also use the `--enable_console' flag.</p>\n\n<p><code>dev_appserver.py app.yaml --enable_host_checking=false --admin_port 8081  --enable_console=true</code></p>\n"}], "owner": {"reputation": 191, "user_id": 3637821, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fca2c3f877a78274fb19b57af2672ba6?s=128&d=identicon&r=PG&f=1", "display_name": "vvincirey", "link": "https://stackoverflow.com/users/3637821/vvincirey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3041, "favorite_count": 0, "accepted_answer_id": 30015684, "answer_count": 3, "score": 5, "last_activity_date": 1521669083, "creation_date": 1421695367, "question_id": 28032055, "link": "https://stackoverflow.com/questions/28032055/how-to-open-localhost8080-in-cloud9-ide", "title": "How to open localhost:8080 in Cloud9 IDE?", "body": "<p>I am developing an app engine project (golang) in Cloud9 IDE. For testing in desktop i would go to localhost:8080 in my desktop browser. </p>\n\n<p>In Cloud9, I tried <a href=\"https://workspace-username.c9.io\" rel=\"noreferrer\">https://workspace-username.c9.io</a> with $PORT set as 8080, but somehow its not working for appengine project. But it is working for normal go web project though.</p>\n\n<p>How do i test app engine application in Cloud9 IDE? or </p>\n\n<p>How do i open <a href=\"http://localhost:8080\" rel=\"noreferrer\">http://localhost:8080</a> in Cloud9 IDE?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 9, "creation_date": 1421695003, "post_id": 28031651, "comment_id": 44448488, "body": "So it&#39;s similar to the <code>**</code> wildcard implemented by some shells."}, {"owner": {"reputation": 10611, "user_id": 973810, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/fc35612d4cb8ba65f31a6d028bcf138e?s=128&d=identicon&r=PG", "display_name": "Darth Egregious", "link": "https://stackoverflow.com/users/973810/darth-egregious"}, "edited": false, "score": 8, "creation_date": 1432947537, "post_id": 28031651, "comment_id": 49155446, "body": "LOL you answered your own question. That&#39;s so Kevin."}, {"owner": {"reputation": 1504, "user_id": 758334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e4808c01c44ad58d0aebb85fc68ae7b?s=128&d=identicon&r=PG", "display_name": "Subfuzion", "link": "https://stackoverflow.com/users/758334/subfuzion"}, "edited": false, "score": 1, "creation_date": 1502002837, "post_id": 28031651, "comment_id": 78019233, "body": "Wait, you get credit for answering your own questions just 3 minutes after posting them...? Should you have taken an extra 3 minutes before posting your question? Hmm... well, the answer was helpful so I upvoted anyway. ;)"}, {"owner": {"reputation": 48731, "user_id": 329700, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/41910a452554b187d044c00c576866b1?s=128&d=identicon&r=PG", "display_name": "Kevin Burke", "link": "https://stackoverflow.com/users/329700/kevin-burke"}, "edited": false, "score": 17, "creation_date": 1502075478, "post_id": 28031651, "comment_id": 78037794, "body": "A lot of times I do that because I end up searching for the same question later and this is the easiest place to find it again."}, {"owner": {"reputation": 1463, "user_id": 6355435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1137693062918547/picture?type=large", "display_name": "David Chen", "link": "https://stackoverflow.com/users/6355435/david-chen"}, "edited": false, "score": 10, "creation_date": 1544086918, "post_id": 28031651, "comment_id": 94153990, "body": "I think it&#39;s perfectly OK to answer one&#39;s own questions as long as the information is <b>helpful</b>, and the <a href=\"https://stackoverflow.com/help/self-answer\">guideline</a> encourages this too."}, {"owner": {"reputation": 1961, "user_id": 884640, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aoq2w.png?s=128&g=1", "display_name": "driftcatcher", "link": "https://stackoverflow.com/users/884640/driftcatcher"}, "edited": false, "score": 1, "creation_date": 1583971329, "post_id": 28031651, "comment_id": 107295441, "body": "Conceptually similar to <code>**</code> for sure, the cool part is that it&#39;s only files relevant to <code>go</code>, and that it works the same across platforms and shells. I&#39;m pretty new to Go, and this pleases me ^__^"}], "tags": [], "owner": {"reputation": 48731, "user_id": 329700, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/41910a452554b187d044c00c576866b1?s=128&d=identicon&r=PG", "display_name": "Kevin Burke", "link": "https://stackoverflow.com/users/329700/kevin-burke"}, "is_accepted": true, "score": 148, "last_activity_date": 1421694864, "last_edit_date": 1421694864, "creation_date": 1421693720, "answer_id": 28031651, "question_id": 28031603, "link": "https://stackoverflow.com/questions/28031603/what-do-three-dots-mean-in-go-command-line-invocations/28031651#28031651", "title": "What do three dots &quot;./...&quot; mean in Go command line invocations?", "body": "<p>From the command <code>go help packages</code>:</p>\n\n<blockquote>\n  <p>An import path is a pattern if it includes one or more \"...\" wildcards,\n  each of which can match any string, including the empty string and\n  strings containing slashes.  Such a pattern expands to all package\n  directories found in the GOPATH trees with names matching the\n  patterns.  As a special case, x/... matches x as well as x's subdirectories.\n  For example, net/... expands to net and packages in its subdirectories.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 4384, "user_id": 3708462, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/UJWAn.jpg?s=128&g=1", "display_name": "Emdadul Sawon", "link": "https://stackoverflow.com/users/3708462/emdadul-sawon"}, "is_accepted": false, "score": 59, "last_activity_date": 1477037957, "last_edit_date": 1477037957, "creation_date": 1458282773, "answer_id": 36077640, "question_id": 28031603, "link": "https://stackoverflow.com/questions/28031603/what-do-three-dots-mean-in-go-command-line-invocations/36077640#36077640", "title": "What do three dots &quot;./...&quot; mean in Go command line invocations?", "body": "<pre><code>go [command] ./...\n</code></pre>\n\n<p>Here <code>./</code> tells to start from the current folder, <code>...</code> tells to go down recursively.</p>\n\n<p><strong>For Example:</strong></p>\n\n<pre><code>go list ...\n</code></pre>\n\n<p>In any folder lists all the packages, including packages of the standard library first followed by external libraries in your go workspace.</p>\n"}], "owner": {"reputation": 48731, "user_id": 329700, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/41910a452554b187d044c00c576866b1?s=128&d=identicon&r=PG", "display_name": "Kevin Burke", "link": "https://stackoverflow.com/users/329700/kevin-burke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30641, "favorite_count": 33, "accepted_answer_id": 28031651, "answer_count": 2, "score": 146, "last_activity_date": 1477037957, "creation_date": 1421693535, "question_id": 28031603, "link": "https://stackoverflow.com/questions/28031603/what-do-three-dots-mean-in-go-command-line-invocations", "title": "What do three dots &quot;./...&quot; mean in Go command line invocations?", "body": "<p>If you run Golang tests on Travis CI, it will <a href=\"http://docs.travis-ci.com/user/languages/go/\">download all of your dependencies with three dots</a>:</p>\n\n<pre><code>go get -d -v ./... &amp;&amp; go build -v ./...\n</code></pre>\n\n<p>What does <code>./...</code> indicate or expand to there? I've done some research but it doesn't seem to be a Unix convention.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1421695917, "post_id": 28031447, "comment_id": 44448962, "body": "<code>results := make([]string, 0)</code> should be <code>results := make([]string, len(Foos))</code>"}], "tags": [], "owner": {"reputation": 9369, "user_id": 71079, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3e302415f77b6c398abc0b16efc653f3?s=128&d=identicon&r=PG", "display_name": "Ralph Caraveo", "link": "https://stackoverflow.com/users/71079/ralph-caraveo"}, "is_accepted": true, "score": 2, "last_activity_date": 1421692823, "last_edit_date": 1495542224, "creation_date": 1421692823, "answer_id": 28031447, "question_id": 28030469, "link": "https://stackoverflow.com/questions/28030469/in-go-what-is-the-best-way-to-convert-an-array-of-string-types-to-an-array-of-st/28031447#28031447", "title": "In Go what is the best way to convert an array of string types to an array of string", "body": "<p>Pretty much the best and only way to do it is to loop over the slice of Foo objects as in (causing a copy):</p>\n\n<pre><code>func main() {\n    results := make([]string, 0)\n    for _, r := range Foos{\n       results = append(results, string(r))\n    }\n    fmt.Println(\"Foos: \" + strings.Join(results, \",\"))\n}\n</code></pre>\n\n<p>Unfortunately as of this time Go does not support the concept type coercion and requires a copy.  As an alternative you can type alias []Foo and add a Stringer method to it therefore encapsulating such details as in: <a href=\"http://play.golang.org/p/FuOoLNrCvD\" rel=\"nofollow noreferrer\">http://play.golang.org/p/FuOoLNrCvD</a></p>\n\n<p>See the following for a similar question: <a href=\"https://stackoverflow.com/questions/12990338/cannot-convert-string-to-interface\">Cannot convert []string to []interface {}</a> </p>\n"}], "owner": {"reputation": 333, "user_id": 2128978, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fbde0f429bfb01b04fda8bc8ad796b84?s=128&d=identicon&r=PG", "display_name": "AlphaGeek", "link": "https://stackoverflow.com/users/2128978/alphageek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 28031447, "answer_count": 1, "score": 1, "last_activity_date": 1421692823, "creation_date": 1421689012, "question_id": 28030469, "link": "https://stackoverflow.com/questions/28030469/in-go-what-is-the-best-way-to-convert-an-array-of-string-types-to-an-array-of-st", "title": "In Go what is the best way to convert an array of string types to an array of string", "body": "<p>The following code</p>\n\n<pre><code>package main\n\nimport \"strings\"\nimport \"fmt\"\n\ntype Foo string\n\nconst (\n    Bar    Foo = \"bar\"\n    Snafu      = \"snafu\"\n    Foobar     = \"foobar\"\n)\n\nvar Foos = []Foo{Bar, Snafu, Foobar}\n\nfunc main() {\n    fmt.Println(\"Foos: \" + strings.Join(Foos, \",\"))\n}\n</code></pre>\n\n<p>Produces this error:</p>\n\n<pre><code>./test.go:17: cannot use Foos (type []Foo) as type []string in argument to strings.Join\n</code></pre>\n\n<p>This makes sense since Foo is not string but it is derived from string.  Is there any way to coerce the \"[]Foo\" to \"[]string\" without copying?</p>\n"}, {"tags": ["go", "raspberry-pi", "dbus", "omxplayer"], "comments": [{"owner": {"reputation": 2688, "user_id": 4694916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab7f3cdba3e5a6a894de262429090c00?s=128&d=identicon&r=PG&f=1", "display_name": "lumos0815", "link": "https://stackoverflow.com/users/4694916/lumos0815"}, "edited": false, "score": 0, "creation_date": 1494064060, "post_id": 28030045, "comment_id": 74676509, "body": "you have to use the content of the files - the address looks something like unix:abstract=/tmp/dbus-mQJTjffxVL,guid=cb5b9d6eb7d17e381a9c&zwnj;&#8203;e1c2590d99aa but I&#39;m still not able to call any dbus function for omxplayer"}], "answers": [{"tags": [], "owner": {"reputation": 3761, "user_id": 142020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vKJEv.png?s=128&g=1", "display_name": "T0xicCode", "link": "https://stackoverflow.com/users/142020/t0xiccode"}, "is_accepted": false, "score": 0, "last_activity_date": 1585930168, "creation_date": 1585930168, "answer_id": 61015994, "question_id": 28030045, "link": "https://stackoverflow.com/questions/28030045/using-go-dbus-with-omxplayer-on-raspberry-pi/61015994#61015994", "title": "Using go.dbus with omxplayer on Raspberry Pi", "body": "<p>OMXplayer does not use the system or session bus, but instead uses its own bus, the path to this bus is the content of the file pointed to by the  <code>OMXPLAYER_DBUS_ADDR</code> environment variable.</p>\n\n<p>You can see that the dbuscontrol.sh script sets that up on <a href=\"https://github.com/popcornmix/omxplayer/blob/master/dbuscontrol.sh#L5\" rel=\"nofollow noreferrer\">lines 5-8</a> (specifically line 7).</p>\n\n<p>In your case, you'll need to open that file, read its contents, and use that in a call to <a href=\"https://pkg.go.dev/github.com/guelfey/go.dbus?tab=doc#Dial\" rel=\"nofollow noreferrer\"><code>dbus.Conn.Dial()</code></a>.</p>\n\n<p>Something similar to this may work:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>import (\n    \"log\"\n    \"io/ioutil\"\n    \"github.com/guelfey/go.dbus\"\n)\n\nfunc getOMXPlayerDBUSAddr() string {\n    content, err := ioutil.ReadFile(\"/tmp/omxplayerdbus.pi\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    return string(content)\n}\n\nfunc main() {\n    conn, err := dbus.Dial(getOMXPlayerDBUSAddr())\n    if err != nil {\n        panic(err)\n    }\n\n    // The rest of the code goes here\n    node, err := introspect...\n}\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 4470954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c88b9c0fb1d47ea233ba683b3bb18f91?s=128&d=identicon&r=PG&f=1", "display_name": "Majormjr", "link": "https://stackoverflow.com/users/4470954/majormjr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2355, "favorite_count": 5, "answer_count": 1, "score": 10, "last_activity_date": 1585930168, "creation_date": 1421687473, "last_edit_date": 1549988581, "question_id": 28030045, "link": "https://stackoverflow.com/questions/28030045/using-go-dbus-with-omxplayer-on-raspberry-pi", "title": "Using go.dbus with omxplayer on Raspberry Pi", "body": "<p>I am trying to using the D-Bus interface on omxplayer in order to control the running video.  I'm attempting this using the go.dbus library found here:  <a href=\"https://github.com/guelfey/go.dbus\" rel=\"nofollow noreferrer\">https://github.com/guelfey/go.dbus</a></p>\n\n<p>The omxplayer documentation provides a dbuscontrol.sh script that I can use successfully.  It sets some environments variable and then can use dbus-send in order to query omxplayer.</p>\n\n<p>I'm trying to reproduce this in Go but I keep getting the error \"The name org.mpris.MediaPlayer2 was not provided by any .service files\"</p>\n\n<p>Here is my code:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"github.com/guelfey/go.dbus\"\n    \"github.com/guelfey/go.dbus/introspect\"\n    \"os\"\n)\n\nfunc main() {\n    os.Setenv(\"OMXPLAYER_DBUS_ADDR\", \"/tmp/omxplayerdbus.pi\")\n    os.Setenv(\"OMXPLAYER_DBUS_PID\", \"/tmp/omxplayerdbus.pi.pid\")\n    conn, err := dbus.SessionBus()\n    if err != nil {\n        panic(err)\n    }\n    node, err := introspect.Call(conn.Object(\"org.mpris.MediaPlayer2.omxplayer\", \"/org/mpris/MediaPlayer2\"))\n    if err != nil {\n        fmt.Println(err)\n    }\n    data, _ := json.MarshalIndent(node, \"\", \"    \")\n\n    var s []string\n    err = conn.BusObject().Call(\"org.freedesktop.DBus.ListNames\", 0).Store(&amp;s)\n    if err != nil {\n        fmt.Fprintln(os.Stderr, \"Failed to get list of owned names:\", err)\n        os.Exit(1)\n    }\n\n    fmt.Println(\"Currently owned names on the session bus:\")\n    for _, v := range s {\n        fmt.Println(v)\n    }\n\n    os.Stdout.Write(data)\n}\n</code></pre>\n"}, {"tags": ["go", "integer", "int64", "int32"], "answers": [{"comments": [{"owner": {"reputation": 301, "user_id": 1036146, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/128563abf274e08c17d67f71af6ff50a?s=128&d=identicon&r=PG", "display_name": "Backslash", "link": "https://stackoverflow.com/users/1036146/backslash"}, "edited": false, "score": 0, "creation_date": 1421686345, "post_id": 28029597, "comment_id": 44444199, "body": "Yeah but what if the values are different, let&#39;s say 1223 and 5644 ?"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 6, "last_activity_date": 1421686968, "last_edit_date": 1421686968, "creation_date": 1421685968, "answer_id": 28029597, "question_id": 28029518, "link": "https://stackoverflow.com/questions/28029518/golang-combine-two-numbers/28029597#28029597", "title": "Golang: Combine two numbers", "body": "<pre><code>var a, b int32 = 33, 33\na = a*100 + b\nfmt.Println(a)\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/fChV2nWxJx\">Playground</a>.</p>\n\n<p><strong>Edit:</strong> Here is a version which computes the padding depending on the number:</p>\n\n<pre><code>func main() {\n    var a, b int32 = 1234, 456\n    a = a*padding(b) + b\n    fmt.Println(a)\n}\n\nfunc padding(n int32) int32 {\n    var p int32 = 1\n    for p &lt; n {\n        p *= 10\n    }\n    return p\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/JVJuTsxXR-\">Playground</a>.</p>\n\n<p>Note that you should also check that int32 won't overflow. If you don't want to worry about overflows, you can use a <a href=\"http://golang.org/pkg/math/big/#Int\">big.Int</a> instead.</p>\n"}, {"tags": [], "owner": {"reputation": 3201, "user_id": 2616179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb90669caa64288bdb5767f736152bbe?s=128&d=identicon&r=PG", "display_name": "Makpoc", "link": "https://stackoverflow.com/users/2616179/makpoc"}, "is_accepted": false, "score": 3, "last_activity_date": 1421688323, "creation_date": 1421688323, "answer_id": 28030296, "question_id": 28029518, "link": "https://stackoverflow.com/questions/28029518/golang-combine-two-numbers/28030296#28030296", "title": "Golang: Combine two numbers", "body": "<p>I have no idea about the performance, compared to Ainar-G's solution, but what about this:</p>\n\n<pre><code>var a, b int32 = 33, 33\nresult, err := strconv.Atoi(fmt.Sprintf(\"%d%d\", a, b))\nif err != nil {\n    panic(err)\n}        \nfmt.Println(int32(result))\n</code></pre>\n"}], "owner": {"reputation": 301, "user_id": 1036146, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/128563abf274e08c17d67f71af6ff50a?s=128&d=identicon&r=PG", "display_name": "Backslash", "link": "https://stackoverflow.com/users/1036146/backslash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3585, "favorite_count": 0, "accepted_answer_id": 28029597, "answer_count": 2, "score": 1, "last_activity_date": 1421689324, "creation_date": 1421685713, "question_id": 28029518, "link": "https://stackoverflow.com/questions/28029518/golang-combine-two-numbers", "title": "Golang: Combine two numbers", "body": "<p>I feel quite stupid asking this but how can I archive the following in GO?</p>\n\n<p>Let's say I have two int32 which both have the value 33.<br>\nHow can I combine them into one int32 with the value 3333 instead of 66?</p>\n"}, {"tags": ["ajax", "go"], "answers": [{"tags": [], "owner": {"reputation": 1871, "user_id": 2453153, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/cMVfU.jpg?s=128&g=1", "display_name": "sunshinekitty", "link": "https://stackoverflow.com/users/2453153/sunshinekitty"}, "is_accepted": true, "score": 2, "last_activity_date": 1421686139, "creation_date": 1421686139, "answer_id": 28029666, "question_id": 28028830, "link": "https://stackoverflow.com/questions/28028830/detect-if-is-an-ajax-requests/28029666#28029666", "title": "Detect if is an AJAX requests", "body": "<p>Unfortunately \"X-Requested-With\" is not always reliable.  If you are in control of making the Ajax call you may use the beforeSend function to ensure this is set:</p>\n\n<pre><code>$.ajax({\n    url: \"http://localhost/url\",\n    data: { signature: authHeader },\n    type: \"GET\",\n    beforeSend: function(xhr){xhr.setRequestHeader('X-Requested-With', 'xmlhttprequest');},\n    success: function() { alert('Success!' + authHeader); }\n});\n</code></pre>\n\n<p>You may then check if <code>req.Header.Get(\"X-Requested-With\") == 'xmlhttprequest'</code></p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 977, "favorite_count": 0, "accepted_answer_id": 28029666, "answer_count": 1, "score": 2, "last_activity_date": 1421686139, "creation_date": 1421683585, "last_edit_date": 1421685664, "question_id": 28028830, "link": "https://stackoverflow.com/questions/28028830/detect-if-is-an-ajax-requests", "title": "Detect if is an AJAX requests", "body": "<p>How can I detect, if a request is an AJAX or not?</p>\n\n<p>Would checking </p>\n\n<pre><code>req.Header.Get(\"X-Requested-With\")\n</code></pre>\n\n<p>work for all browser?</p>\n"}, {"tags": ["xml", "go", "marshalling", "unmarshalling"], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1421674463, "post_id": 28025830, "comment_id": 44436927, "body": "Omg, such a trivial mistake and I couldn&#39;t find it. Thanks."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 3, "last_activity_date": 1421674343, "creation_date": 1421674343, "answer_id": 28025830, "question_id": 28025769, "link": "https://stackoverflow.com/questions/28025769/unmarshalling-xml-from-result-of-xml-marshal/28025830#28025830", "title": "Unmarshalling XML from result of xml.Marshal()", "body": "<p>You are trying to unmarshal XML as if it's JSON. First you do</p>\n\n<pre><code>data, err := xml.Marshal(p)\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>err = json.Unmarshal(data, &amp;pXml)\n</code></pre>\n\n<p>Line 46 in your code should be</p>\n\n<pre><code>err = xml.Unmarshal(data, &amp;pXml)\n</code></pre>\n"}], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 28025830, "answer_count": 1, "score": -3, "last_activity_date": 1421674343, "creation_date": 1421674186, "question_id": 28025769, "link": "https://stackoverflow.com/questions/28025769/unmarshalling-xml-from-result-of-xml-marshal", "title": "Unmarshalling XML from result of xml.Marshal()", "body": "<p>I have a small <code>struct</code> which I want to marshal and unmarshal using the <a href=\"http://golang.org/pkg/encoding/xml/\" rel=\"nofollow\"><code>encoding/xml</code></a> package:</p>\n\n<pre><code>type Point struct {\n    X, Y  int\n    z     int // unexported\n    Names []string\n}\n</code></pre>\n\n<p>The encoding/decoding works fine when I use the <a href=\"http://golang.org/pkg/encoding/json/\" rel=\"nofollow\"><code>encoding/json</code></a> package.</p>\n\n<p>But when I use the <code>encoding/xml</code> package, only the <code>xml.Marshal()</code> works, the <code>xml.Unmarshal()</code> returns an error:</p>\n\n<pre><code>invalid character '&lt;' looking for beginning of value\n</code></pre>\n\n<p><strong>This is how I do it for XML:</strong></p>\n\n<pre><code>p := Point{1, 2, 3, []string{\"Bob\", \"Alice\"}}\ndata, err := xml.Marshal(p)\nif err != nil {\n    fmt.Println(\"Error:\", err)\n}\nfmt.Println(\"XML:\", string(data))\n\nvar pXml Point\nerr = json.Unmarshal(data, &amp;pXml)\nif err != nil {\n    fmt.Println(\"Error:\", err)\n}\nfmt.Println(\"Unmarshalled XML:\", pXml)\n</code></pre>\n\n<p>Why do I get this error and how can I unmarshal the XML output returned by <code>xml.Marshal()</code>?</p>\n\n<p>Here is the complete, runnable application on the <a href=\"http://play.golang.org/p/5dE4NCB1HO\" rel=\"nofollow\"><strong>Go Playground</strong></a> to try out.</p>\n\n<p><strong>Output of the application:</strong></p>\n\n<pre><code>Input: {1 2 3 [Bob Alice]}\nJSON: {\"X\":1,\"Y\":2,\"Names\":[\"Bob\",\"Alice\"]}\nUnmarshalled JSON: {1 2 0 [Bob Alice]}\n\nXML: &lt;Point&gt;&lt;X&gt;1&lt;/X&gt;&lt;Y&gt;2&lt;/Y&gt;&lt;Names&gt;Bob&lt;/Names&gt;&lt;Names&gt;Alice&lt;/Names&gt;&lt;/Point&gt;\nError: invalid character '&lt;' looking for beginning of value\nUnmarshalled XML: {0 0 0 []}\n</code></pre>\n"}, {"tags": ["casting", "go", "type-conversion", "type-assertion"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 3, "creation_date": 1421674198, "post_id": 28024884, "comment_id": 44436772, "body": "Do you have a particular performance you&#39;d like to achieve? Did you benchmark different solutions?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1421674821, "post_id": 28024884, "comment_id": 44437124, "body": "Go keeps an internal type info attached to each interface that&#39;s how you can do type conversion. so basically keeping the type as an internal value in your class does the same but probably less efficient."}, {"owner": {"reputation": 11530, "user_id": 207894, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1f10c2fce594fe4d5bc05b6e5f466e6a?s=128&d=identicon&r=PG", "display_name": "Ory Band", "link": "https://stackoverflow.com/users/207894/ory-band"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1421679602, "post_id": 28024884, "comment_id": 44440137, "body": "@Ainar-G nothing in particular. I just want to know if type assertion performance is as bad as casting in C/C++ or other similar languages."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1421695409, "post_id": 28027945, "comment_id": 44448697, "body": "I would remove &quot;casting&quot; from your answer. A type switch is different than a type cast, which go doesn&#39;t allow without the use of the <code>unsafe</code> package. You also forgot a bare type assertion, which is slightly faster than a type switch."}, {"owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1421696150, "post_id": 28027945, "comment_id": 44449086, "body": "I haven&#39;t included the type assertion, you are right, but if you chain several if else to do what a switch do, do you think it would be faster? Regarding type casting, I&#39;m not sure what you mean. Isn&#39;t <code>mynewint := any.(*myint)</code> type casting?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1421697053, "post_id": 28027945, "comment_id": 44449572, "body": "if+else&#39;s might be about the same as a switch, but a single type assertion is very common in Go code. That isn&#39;t a cast (in the C or Java sense). It&#39;s a <a href=\"http://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertion</a>, and is type-safe. A cast is more akin to <code>(*[8]byte)(unsafe.Pointer(&amp;myInt))</code>"}, {"owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1421697270, "post_id": 28027945, "comment_id": 44449695, "body": "Thanks JimB, I thought that type assertion was the optional second <code>ok</code> parameter and the first was the cast."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1421697401, "post_id": 28027945, "comment_id": 44449769, "body": "The comma-ok form gives you the bool to check; the non-ok form is when you want it to panic if the assertion is invalid. The underlying assertion is the same."}, {"owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1421698678, "post_id": 28027945, "comment_id": 44450393, "body": "I have included the type assertion, that as you said, it is a minor improvement with respect to type switch, and removed &quot;casting&quot;. Thanks!"}, {"owner": {"reputation": 33471, "user_id": 1420279, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c799e8b3d14c4f149ce71455109f17eb?s=128&d=identicon&r=PG", "display_name": "Antimony", "link": "https://stackoverflow.com/users/1420279/antimony"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1470484544, "post_id": 28027945, "comment_id": 64976757, "body": "@JimB A type assertion is a cast in the Java sense, for non primative types. Casting references in Java <i>is</i> a &quot;type assertion&quot;"}, {"owner": {"reputation": 1989, "user_id": 788273, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/927348f4c16e03d3b290bd9b558c1b0d?s=128&d=identicon&r=PG", "display_name": "Kr0e", "link": "https://stackoverflow.com/users/788273/kr0e"}, "edited": false, "score": 28, "creation_date": 1472455866, "post_id": 28027945, "comment_id": 65741178, "body": "Just tested this with go1.7 on a beefy MacBook Pro, results: BenchmarkIntmethod-8           \t2000000000     \t         1.97 ns/op BenchmarkInterface-8           \t1000000000     \t         2.27 ns/op BenchmarkTypeSwitch-8          \t2000000000     \t         1.90 ns/op BenchmarkTypeAssertion-8       \t2000000000     \t         1.89 ns/op PASS  ----------- Seems like, there is almost no overhead anymore :-)"}, {"owner": {"reputation": 376, "user_id": 1624033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a199e97727333ae2a70a230c173363e?s=128&d=identicon&r=PG", "display_name": "physphun", "link": "https://stackoverflow.com/users/1624033/physphun"}, "reply_to_user": {"reputation": 1989, "user_id": 788273, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/927348f4c16e03d3b290bd9b558c1b0d?s=128&d=identicon&r=PG", "display_name": "Kr0e", "link": "https://stackoverflow.com/users/788273/kr0e"}, "edited": false, "score": 1, "creation_date": 1480057504, "post_id": 28027945, "comment_id": 68820252, "body": "with the SSA added in Go 1.7, I would be shocked if this code does not get optimized out to bypass the type casting since there is only one case. I would guess that this is the reason for the similar performance seen by @kr0e"}, {"owner": {"reputation": 3328, "user_id": 1825593, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t3gK8.jpg?s=128&g=1", "display_name": "prl900", "link": "https://stackoverflow.com/users/1825593/prl900"}, "reply_to_user": {"reputation": 376, "user_id": 1624033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a199e97727333ae2a70a230c173363e?s=128&d=identicon&r=PG", "display_name": "physphun", "link": "https://stackoverflow.com/users/1624033/physphun"}, "edited": false, "score": 2, "creation_date": 1485486272, "post_id": 28027945, "comment_id": 70955171, "body": "@physphun: The number of cases in the type switch statement does not affect performance of this benchmark. This playground example contains two types implementing the Inccer interface <a href=\"https://play.golang.org/p/s4SEk6Ell6\" rel=\"nofollow noreferrer\">play.golang.org/p/s4SEk6Ell6</a> and performance is the same as when using only one type in the type switch. The new compiler must be doing smart things independently of the number of cases in the type assertion switch."}, {"owner": {"reputation": 909, "user_id": 982292, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b32f2c666484b123b12a6b8197f7369a?s=128&d=identicon&r=PG", "display_name": "luistm", "link": "https://stackoverflow.com/users/982292/luistm"}, "edited": false, "score": 0, "creation_date": 1514544250, "post_id": 28027945, "comment_id": 83011626, "body": "Which was the Go version used for this test?"}, {"owner": {"reputation": 539, "user_id": 2352611, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/0fY8c.jpg?s=128&g=1", "display_name": "Larytet", "link": "https://stackoverflow.com/users/2352611/larytet"}, "reply_to_user": {"reputation": 376, "user_id": 1624033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a199e97727333ae2a70a230c173363e?s=128&d=identicon&r=PG", "display_name": "physphun", "link": "https://stackoverflow.com/users/1624033/physphun"}, "edited": false, "score": 0, "creation_date": 1573203575, "post_id": 28027945, "comment_id": 103812895, "body": "@physphun you are right. This bench <a href=\"https://play.golang.org/p/3Nl6ilcsfIu\" rel=\"nofollow noreferrer\">play.golang.org/p/3Nl6ilcsfIu</a> demos inlining and optimization out. On my machine          BenchmarkTypeAssert-4                 \t  300000\t      4782 ns/op        BenchmarkTypeAssertFast-4             \t 5000000\t       356 ns/op"}], "tags": [], "owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "is_accepted": true, "score": 40, "last_activity_date": 1582417394, "last_edit_date": 1582417394, "creation_date": 1421680900, "answer_id": 28027945, "question_id": 28024884, "link": "https://stackoverflow.com/questions/28024884/does-a-type-assertion-type-switch-have-bad-performance-is-slow-in-go/28027945#28027945", "title": "Does a type assertion / type switch have bad performance / is slow in Go?", "body": "<p>It is very easy to write a Benchmark test to check it: <a href=\"http://play.golang.org/p/E9H_4K2J9-\" rel=\"noreferrer\">http://play.golang.org/p/E9H_4K2J9-</a></p>\n\n<pre><code>package main\n\nimport (\n    \"testing\"\n)\n\ntype myint int64\n\ntype Inccer interface {\n    inc()\n}\n\nfunc (i *myint) inc() {\n    *i = *i + 1\n}\n\nfunc BenchmarkIntmethod(b *testing.B) {\n    i := new(myint)\n    incnIntmethod(i, b.N)\n}\n\nfunc BenchmarkInterface(b *testing.B) {\n    i := new(myint)\n    incnInterface(i, b.N)\n}\n\nfunc BenchmarkTypeSwitch(b *testing.B) {\n    i := new(myint)\n    incnSwitch(i, b.N)\n}\n\nfunc BenchmarkTypeAssertion(b *testing.B) {\n    i := new(myint)\n    incnAssertion(i, b.N)\n}\n\nfunc incnIntmethod(i *myint, n int) {\n    for k := 0; k &lt; n; k++ {\n        i.inc()\n    }\n}\n\nfunc incnInterface(any Inccer, n int) {\n    for k := 0; k &lt; n; k++ {\n        any.inc()\n    }\n}\n\nfunc incnSwitch(any Inccer, n int) {\n    for k := 0; k &lt; n; k++ {\n        switch v := any.(type) {\n        case *myint:\n            v.inc()\n        }\n    }\n}\n\nfunc incnAssertion(any Inccer, n int) {\n    for k := 0; k &lt; n; k++ {\n        if newint, ok := any.(*myint); ok {\n            newint.inc()\n        }\n    }\n}\n</code></pre>\n\n<p><strong>EDIT Oct. 09, 2019</strong></p>\n\n<p>It appears that the methods demonstrated above are equal and have no advantage over one another. Here are the results from my machine (AMD R7 2700X, Golang v1.12.9):</p>\n\n<pre><code>BenchmarkIntmethod-16           2000000000           1.67 ns/op\nBenchmarkInterface-16           1000000000           2.03 ns/op\nBenchmarkTypeSwitch-16          2000000000           1.70 ns/op\nBenchmarkTypeAssertion-16       2000000000           1.67 ns/op\nPASS\n</code></pre>\n\n<p>AND AGAIN:</p>\n\n<pre><code>BenchmarkIntmethod-16           2000000000           1.68 ns/op\nBenchmarkInterface-16           1000000000           2.01 ns/op\nBenchmarkTypeSwitch-16          2000000000           1.66 ns/op\nBenchmarkTypeAssertion-16       2000000000           1.67 ns/op\n</code></pre>\n\n<p><strong>PREVIOUS RESULTS on Jan. 19, 2015</strong></p>\n\n<p>On my amd64 machine, I'm getting the following timing:</p>\n\n<pre><code>$ go test -bench=.\nBenchmarkIntmethod  1000000000           2.71 ns/op\nBenchmarkInterface  1000000000           2.98 ns/op\nBenchmarkTypeSwitch 100000000           16.7 ns/op\nBenchmarkTypeAssertion  100000000       13.8 ns/op\n</code></pre>\n\n<p>So it looks like accessing the method via type switch or type assertion is about 5-6 times slower than calling the method directly or via interface.</p>\n\n<p>I don't know if C++ is slower or if this slowdown is tolerable for your application.</p>\n"}, {"comments": [{"owner": {"reputation": 1091, "user_id": 3387602, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c5ef481e47f40861b734abc7d7973777?s=128&d=identicon&r=PG&f=1", "display_name": "zer09", "link": "https://stackoverflow.com/users/3387602/zer09"}, "edited": false, "score": 0, "creation_date": 1504441212, "post_id": 28031664, "comment_id": 79005993, "body": "can you post your benchmark score? Testing your suggestion on Go 1.9 make it worst. Thanks"}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 1, "last_activity_date": 1421693804, "creation_date": 1421693804, "answer_id": 28031664, "question_id": 28024884, "link": "https://stackoverflow.com/questions/28024884/does-a-type-assertion-type-switch-have-bad-performance-is-slow-in-go/28031664#28031664", "title": "Does a type assertion / type switch have bad performance / is slow in Go?", "body": "<p>In your</p>\n\n<pre><code>switch v := anything.(type) {\n    case SomeCustomType:\n        fmt.Println(v)\n...\n</code></pre>\n\n<p>if you need not <code>SomeCustomType.Fields</code> or methods like in <code>fmt.Println(v)</code>, doing</p>\n\n<pre><code>switch anything.(type) { //avoid 'v:= ' interface conversion, only assertion\n    case SomeCustomType:\n        fmt.Println(\"anything type is SomeCustomType\", anything)\n...\n</code></pre>\n\n<p>should be approximately two times faster</p>\n"}, {"comments": [{"owner": {"reputation": 11530, "user_id": 207894, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1f10c2fce594fe4d5bc05b6e5f466e6a?s=128&d=identicon&r=PG", "display_name": "Ory Band", "link": "https://stackoverflow.com/users/207894/ory-band"}, "edited": false, "score": 0, "creation_date": 1468144372, "post_id": 38245293, "comment_id": 63998837, "body": "Interesting. I wonder what happened. Maybe someone can provide some docs explaining this performance increase?"}, {"owner": {"reputation": 376, "user_id": 1624033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a199e97727333ae2a70a230c173363e?s=128&d=identicon&r=PG", "display_name": "physphun", "link": "https://stackoverflow.com/users/1624033/physphun"}, "edited": false, "score": 0, "creation_date": 1480057707, "post_id": 38245293, "comment_id": 68820332, "body": "@Ted are you sure you are using Go 1.6? the SSA added in 1.7 could be responsible for optimizing this."}, {"owner": {"reputation": 788, "user_id": 5181219, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2202d8101a87cb7221de3fc461b8ef3d?s=128&d=identicon&r=PG&f=1", "display_name": "Ted", "link": "https://stackoverflow.com/users/5181219/ted"}, "reply_to_user": {"reputation": 376, "user_id": 1624033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a199e97727333ae2a70a230c173363e?s=128&d=identicon&r=PG", "display_name": "physphun", "link": "https://stackoverflow.com/users/1624033/physphun"}, "edited": false, "score": 0, "creation_date": 1481383394, "post_id": 38245293, "comment_id": 69360462, "body": "@physphun Go 1.7 wasn&#39;t released when I posted this answer, so yes :-)"}, {"owner": {"reputation": 376, "user_id": 1624033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a199e97727333ae2a70a230c173363e?s=128&d=identicon&r=PG", "display_name": "physphun", "link": "https://stackoverflow.com/users/1624033/physphun"}, "edited": false, "score": 0, "creation_date": 1481746870, "post_id": 38245293, "comment_id": 69505131, "body": "Ah! just checking. This performance gain really feels too good to be true."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1518819622, "post_id": 38245293, "comment_id": 84676079, "body": "The performance issue is due to Go&#39;s inline complition. Go can&#39;t inline an interface function call, and couldn&#39;t inline for type switch (but can now, as Go1.9 can do this). adds a comment <code>&#47;&#47;go:noinline</code> (not sure if Go1.6 supports it or not) before the declaration of <code>inc</code> and test again, the result would be all almost the same."}, {"owner": {"reputation": 539, "user_id": 2352611, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/0fY8c.jpg?s=128&g=1", "display_name": "Larytet", "link": "https://stackoverflow.com/users/2352611/larytet"}, "edited": false, "score": 0, "creation_date": 1573204057, "post_id": 38245293, "comment_id": 103813110, "body": "See <a href=\"https://play.golang.org/p/nDXjsTcxZqX\" rel=\"nofollow noreferrer\">play.golang.org/p/nDXjsTcxZqX</a> compiler optimizes the code out"}], "tags": [], "owner": {"reputation": 788, "user_id": 5181219, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2202d8101a87cb7221de3fc461b8ef3d?s=128&d=identicon&r=PG&f=1", "display_name": "Ted", "link": "https://stackoverflow.com/users/5181219/ted"}, "is_accepted": false, "score": 15, "last_activity_date": 1467893915, "creation_date": 1467893915, "answer_id": 38245293, "question_id": 28024884, "link": "https://stackoverflow.com/questions/28024884/does-a-type-assertion-type-switch-have-bad-performance-is-slow-in-go/38245293#38245293", "title": "Does a type assertion / type switch have bad performance / is slow in Go?", "body": "<p>I wanted to verify siritinga's answer by myself, and check whether removing the check in TypeAssertion would make it faster. I added the following in their benchmark:</p>\n\n<pre><code>func incnAssertionNoCheck(any Inccer, n int) {\n    for k := 0; k &lt; n; k++ {\n        any.(*myint).inc()\n    }\n}\n\nfunc BenchmarkTypeAssertionNoCheck(b *testing.B) {\n    i := new(myint)\n    incnAssertionNoCheck(i, b.N)\n}\n</code></pre>\n\n<p>and re-ran the benchmarks on my machine.</p>\n\n<pre><code>BenchmarkIntmethod-12               2000000000           1.77 ns/op\nBenchmarkInterface-12               1000000000           2.30 ns/op\nBenchmarkTypeSwitch-12              500000000            3.76 ns/op\nBenchmarkTypeAssertion-12           2000000000           1.73 ns/op\nBenchmarkTypeAssertionNoCheck-12    2000000000           1.72 ns/op\n</code></pre>\n\n<p>So it seems that the cost of doing a type switch went down <em>significantly</em> from Go 1.4 (that I assume siritinga used) to Go 1.6 (that I'm using): from 5-6 times slower to less than 2 times slower for a type switch, and no slow-down for a type assertion (with or without check).</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 3173426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f17b25c948a3fdedd48981144e7ce39?s=128&d=identicon&r=PG", "display_name": "gwind", "link": "https://stackoverflow.com/users/3173426/gwind"}, "is_accepted": false, "score": 4, "last_activity_date": 1484814788, "creation_date": 1484814788, "answer_id": 41737159, "question_id": 28024884, "link": "https://stackoverflow.com/questions/28024884/does-a-type-assertion-type-switch-have-bad-performance-is-slow-in-go/41737159#41737159", "title": "Does a type assertion / type switch have bad performance / is slow in Go?", "body": "<p>I run bench example by @siritinga in my laptop (go1.7.3 linux/amd64), got this result:</p>\n\n<pre><code>$ go test -bench .\nBenchmarkIntmethod-4            2000000000               1.99 ns/op\nBenchmarkInterface-4            1000000000               2.30 ns/op\nBenchmarkTypeSwitch-4           2000000000               1.80 ns/op\nBenchmarkTypeAssertion-4        2000000000               1.67 ns/op\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5118, "user_id": 1185534, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/128f8ce5456a7c64f67626b2b756c7e6?s=128&d=identicon&r=PG", "display_name": "Seer", "link": "https://stackoverflow.com/users/1185534/seer"}, "edited": false, "score": 0, "creation_date": 1509526790, "post_id": 46014990, "comment_id": 81049411, "body": "People had commented / posted answers a couple of years ago about this..."}, {"owner": {"reputation": 1091, "user_id": 3387602, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c5ef481e47f40861b734abc7d7973777?s=128&d=identicon&r=PG&f=1", "display_name": "zer09", "link": "https://stackoverflow.com/users/3387602/zer09"}, "reply_to_user": {"reputation": 5118, "user_id": 1185534, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/128f8ce5456a7c64f67626b2b756c7e6?s=128&d=identicon&r=PG", "display_name": "Seer", "link": "https://stackoverflow.com/users/1185534/seer"}, "edited": false, "score": 0, "creation_date": 1509535253, "post_id": 46014990, "comment_id": 81054154, "body": "@Seer what is your implying about your comment? sorry I didn&#39;t get it."}], "tags": [], "owner": {"reputation": 1091, "user_id": 3387602, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c5ef481e47f40861b734abc7d7973777?s=128&d=identicon&r=PG&f=1", "display_name": "zer09", "link": "https://stackoverflow.com/users/3387602/zer09"}, "is_accepted": false, "score": 10, "last_activity_date": 1504363878, "creation_date": 1504363878, "answer_id": 46014990, "question_id": 28024884, "link": "https://stackoverflow.com/questions/28024884/does-a-type-assertion-type-switch-have-bad-performance-is-slow-in-go/46014990#46014990", "title": "Does a type assertion / type switch have bad performance / is slow in Go?", "body": "<p>My Results using Go 1.9</p>\n\n<pre><code>BenchmarkIntmethod-4                1000000000           2.42 ns/op\nBenchmarkInterface-4                1000000000           2.84 ns/op\nBenchmarkTypeSwitch-4               1000000000           2.29 ns/op\nBenchmarkTypeAssertion-4            1000000000           2.14 ns/op\nBenchmarkTypeAssertionNoCheck-4     1000000000           2.34 ns/op\n</code></pre>\n\n<p>Type Assertion is much faster now, but the most interesting removing the type check makes it slow.</p>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 8418712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec5e3b1d9473514c1720f216a63a467b?s=128&d=identicon&r=PG", "display_name": "Patrick", "link": "https://stackoverflow.com/users/8418712/patrick"}, "edited": false, "score": 0, "creation_date": 1513275836, "post_id": 47818764, "comment_id": 82601750, "body": "It turns out go actually compiles (at least in 1.9.2) a type switch into a series of else ifs instead of a jump table.  If you make the one type into all test9s instead of all test1s, the following results:      BenchmarkRandomInterface-4    \t20000000\t        77.2 ns/op     BenchmarkRandomTypeSwitch-4   \t20000000\t       114 ns/op     BenchmarkOneInterface-4       \t20000000\t        76.6 ns/op     BenchmarkOneTypeSwitch-4      \t10000000\t       133 ns/op  So this suggests even more firmly to stick with interfaces if you have more than a few possible types."}], "tags": [], "owner": {"reputation": 71, "user_id": 8418712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec5e3b1d9473514c1720f216a63a467b?s=128&d=identicon&r=PG", "display_name": "Patrick", "link": "https://stackoverflow.com/users/8418712/patrick"}, "is_accepted": false, "score": 5, "last_activity_date": 1513275260, "last_edit_date": 1513275260, "creation_date": 1513271450, "answer_id": 47818764, "question_id": 28024884, "link": "https://stackoverflow.com/questions/28024884/does-a-type-assertion-type-switch-have-bad-performance-is-slow-in-go/47818764#47818764", "title": "Does a type assertion / type switch have bad performance / is slow in Go?", "body": "<p>TL;DR: it really depends on type distribution, but interfaces are the safest choice unless you are sure that types will appear in regular chunks.  Also consider that if your code is executed infrequently, the branch predictor will also not be warmed up.</p>\n\n<p>Long explanation:</p>\n\n<p>On go1.9.2 on darwin/amd64</p>\n\n<pre><code>BenchmarkIntmethod-4                2000000000           1.67 ns/op\nBenchmarkInterface-4                2000000000           1.89 ns/op\nBenchmarkTypeSwitch-4               2000000000           1.26 ns/op\nBenchmarkTypeAssertion-4            2000000000           1.41 ns/op\nBenchmarkTypeAssertionNoCheck-4     2000000000           1.61 ns/op\n</code></pre>\n\n<p>An important thing to note here is that a type switch with only one branch is not a very fair comparison against using an interface.  The CPU branch predictor is going to get very hot, very fast and give very good results.  A better bench mark would use pseudo random types and an interface with pseudo random receivers.  Obviously, we need to remove the static method dispatch and stick to just interfaces versus typeswitch (type assertion also becomes less meaningful since it would require a lot of if statements, and no one would write that instead of using a type switch).  Here is the code:</p>\n\n<pre><code>package main\n\nimport (\n        \"testing\"\n)\n\ntype myint0 int64\ntype myint1 int64\ntype myint2 int64\ntype myint3 int64\ntype myint4 int64\ntype myint5 int64\ntype myint6 int64\ntype myint7 int64\ntype myint8 int64\ntype myint9 int64\n\ntype DoStuff interface {\n        doStuff()\n}\n\nfunc (i myint0) doStuff() {\n        i += 0\n}\n\nfunc (i myint1) doStuff() {\n        i += 1\n}\n\nfunc (i myint2) doStuff() {\n        i += 2\n}\n\nfunc (i myint3) doStuff() {\n        i += 3\n}\n\nfunc (i myint4) doStuff() {\n        i += 4\n}\n\nfunc (i myint5) doStuff() {\n        i += 5\n}\n\nfunc (i myint6) doStuff() {\n        i += 6\n}\n\nfunc (i myint7) doStuff() {\n        i += 7\n}\n\nfunc (i myint8) doStuff() {\n        i += 8\n}\n\nfunc (i myint9) doStuff() {\n        i += 9\n}\n\n// Randomly generated\nvar input []DoStuff = []DoStuff{myint0(0), myint1(0), myint1(0), myint5(0), myint6(0), myint7(0), myint6(0), myint9(0), myint7(0), myint7(0), myint6(0), myint2(0), myint9(0), myint0(0), myint2(0), myint3(0), myint5(0), myint1(0), myint4(0), myint0(0), myi\nnt4(0), myint3(0), myint9(0), myint3(0), myint9(0), myint5(0), myint0(0), myint0(0), myint8(0), myint1(0)}\n\nfunc BenchmarkInterface(b *testing.B) {\n        doStuffInterface(b.N)\n}\n\nfunc BenchmarkTypeSwitch(b *testing.B) {\n        doStuffSwitch(b.N)\n}\n\nfunc doStuffInterface(n int) {\n        for k := 0; k &lt; n; k++ {\n                for _, in := range input {\n                        in.doStuff()\n                }\n        }\n}\n\nfunc doStuffSwitch(n int) {\n        for k := 0; k &lt; n; k++ {\n                for _, in := range input {\n                        switch v := in.(type) {\n                        case *myint0:\n                                v.doStuff()\n                        case *myint1:\n                                v.doStuff()\n                        case *myint2:\n                                v.doStuff()\n                        case *myint3:\n                                v.doStuff()\n                        case *myint4:\n                                v.doStuff()\n                        case *myint5:\n                                v.doStuff()\n                        case *myint6:\n                                v.doStuff()\n                        case *myint7:\n                                v.doStuff()\n                        case *myint8:\n                                v.doStuff()\n                        case *myint9:\n                                v.doStuff()\n                        }\n                }\n        }\n}\n</code></pre>\n\n<p>And the results:</p>\n\n<pre><code>go test -bench .\ngoos: darwin\ngoarch: amd64\npkg: test\nBenchmarkInterface-4        20000000            74.0 ns/op\nBenchmarkTypeSwitch-4       20000000           119 ns/op\nPASS\nok      test    4.067s\n</code></pre>\n\n<p>The more types and the more random the distribution, the bigger win interfaces will be.</p>\n\n<p>To show this disparity I changed the code to benchmark random choice versus always picking the same type.  In this case, the typeswitch is again faster, while the interface is the same speed, here is the code:</p>\n\n<pre><code>package main\n\nimport (\n        \"testing\"\n)\n\ntype myint0 int64\ntype myint1 int64\ntype myint2 int64\ntype myint3 int64\ntype myint4 int64\ntype myint5 int64\ntype myint6 int64\ntype myint7 int64\ntype myint8 int64\ntype myint9 int64\n\ntype DoStuff interface {\n        doStuff()\n}\n\nfunc (i myint0) doStuff() {\n        i += 0\n}\n\nfunc (i myint1) doStuff() {\n        i += 1\n}\n\nfunc (i myint2) doStuff() {\n        i += 2\n}\n\nfunc (i myint3) doStuff() {\n        i += 3\n}\n\nfunc (i myint4) doStuff() {\n        i += 4\n}\n\nfunc (i myint5) doStuff() {\n        i += 5\n}\n\nfunc (i myint6) doStuff() {\n        i += 6\n}\n\nfunc (i myint7) doStuff() {\n        i += 7\n}\n\nfunc (i myint8) doStuff() {\n        i += 8\n}\n\nfunc (i myint9) doStuff() {\n        i += 9\n}\n\n// Randomly generated\nvar randInput []DoStuff = []DoStuff{myint0(0), myint1(0), myint1(0), myint5(0), myint6(0), myint7(0), myint6(0), myint9(0), myint7(0), myint7(0), myint6(0), myint2(0), myint9(0), myint0(0), myint2(0), myint3(0), myint5(0), myint1(0), myint4(0), myint0(0),\n myint4(0), myint3(0), myint9(0), myint3(0), myint9(0), myint5(0), myint0(0), myint0(0), myint8(0), myint1(0)}\n\nvar oneInput []DoStuff = []DoStuff{myint1(0), myint1(0), myint1(0), myint1(0), myint1(0), myint1(0), myint1(0), myint1(0), myint1(0), myint1(0), myint1(0), myint1(0), myint1(0), myint1(0), myint1(0), myint1(0), myint1(0), myint1(0), myint1(0), myint1(0), \nmyint1(0), myint1(0), myint1(0), myint1(0), myint1(0), myint1(0), myint1(0), myint1(0), myint1(0), myint1(0)}\n\nfunc BenchmarkRandomInterface(b *testing.B) {\n        doStuffInterface(randInput, b.N)\n}\n\nfunc BenchmarkRandomTypeSwitch(b *testing.B) {\n        doStuffSwitch(randInput, b.N)\n}\n\nfunc BenchmarkOneInterface(b *testing.B) {\n        doStuffInterface(oneInput, b.N)\n}\n\nfunc BenchmarkOneTypeSwitch(b *testing.B) {\n        doStuffSwitch(oneInput, b.N)\n}\n\nfunc doStuffInterface(input []DoStuff, n int) {\n        for k := 0; k &lt; n; k++ {\n                for _, in := range input {\n                        in.doStuff()\n                }\n        }\n}\n\nfunc doStuffSwitch(input []DoStuff, n int) {\n        for k := 0; k &lt; n; k++ {\n                for _, in := range input {\n                        switch v := in.(type) {\n                        case *myint0:\n                                v.doStuff()\n                        case *myint1:\n                                v.doStuff()\n                        case *myint2:\n                                v.doStuff()\n                        case *myint3:\n                                v.doStuff()\n                        case *myint4:\n                                v.doStuff()\n                        case *myint5:\n                                v.doStuff()\n                        case *myint6:\n                                v.doStuff()\n                        case *myint7:\n                                v.doStuff()\n                        case *myint8:\n                                v.doStuff()\n                        case *myint9:\n                                v.doStuff()\n                        }\n                }\n        }\n}\n</code></pre>\n\n<p>Here are the results:</p>\n\n<pre><code>BenchmarkRandomInterface-4      20000000            76.9 ns/op\nBenchmarkRandomTypeSwitch-4     20000000           115 ns/op\nBenchmarkOneInterface-4         20000000            76.6 ns/op\nBenchmarkOneTypeSwitch-4        20000000            68.1 ns/op\n</code></pre>\n"}], "owner": {"reputation": 11530, "user_id": 207894, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1f10c2fce594fe4d5bc05b6e5f466e6a?s=128&d=identicon&r=PG", "display_name": "Ory Band", "link": "https://stackoverflow.com/users/207894/ory-band"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21558, "favorite_count": 14, "accepted_answer_id": 28027945, "answer_count": 6, "score": 55, "last_activity_date": 1582417394, "creation_date": 1421671195, "last_edit_date": 1461605468, "question_id": 28024884, "link": "https://stackoverflow.com/questions/28024884/does-a-type-assertion-type-switch-have-bad-performance-is-slow-in-go", "title": "Does a type assertion / type switch have bad performance / is slow in Go?", "body": "<p>How slow is using type assertions / type switches in Go, as a method of run-time type discovery?</p>\n\n<p>I've heard that in C/C++ for example, discovering types at run time has bad performance. To bypass that, you usually add type members to classes, so you can compare against these instead of casting.</p>\n\n<p>I haven't found a clear answer for this throughout the www.</p>\n\n<p>Here's an example of what I'm asking about - Is this considered <em>fast</em> when compared to other type checking methodologies (like mentioned above, or others I'm not aware of)?</p>\n\n<pre><code>func question(anything interface{}) {\n    switch v := anything.(type) {\n        case string:\n            fmt.Println(v)\n        case int32, int64:\n            fmt.Println(v)\n        case SomeCustomType:\n            fmt.Println(v)\n        default:\n            fmt.Println(\"unknown\")\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1821, "user_id": 380213, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/11a4012fd234b6b3ea8819f5213dc1e9?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/380213/alan"}, "edited": false, "score": 1, "creation_date": 1535519695, "post_id": 28024908, "comment_id": 91089531, "body": "Make sure to use <code>filepath.EvalSymlinks</code>"}, {"owner": {"reputation": 14131, "user_id": 2224996, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/EDCvE.jpg?s=128&g=1", "display_name": "maja", "link": "https://stackoverflow.com/users/2224996/maja"}, "edited": false, "score": 0, "creation_date": 1592400805, "post_id": 28024908, "comment_id": 110411953, "body": "This only works if both paths are either absolute or relative. It doesn&#39;t if you mix it."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 14131, "user_id": 2224996, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/EDCvE.jpg?s=128&g=1", "display_name": "maja", "link": "https://stackoverflow.com/users/2224996/maja"}, "edited": false, "score": 0, "creation_date": 1592400896, "post_id": 28024908, "comment_id": 110412012, "body": "@maja Good point. I suppose you need to convert one of your parameter (the relative path) into an absolute path, then?"}, {"owner": {"reputation": 14131, "user_id": 2224996, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/EDCvE.jpg?s=128&g=1", "display_name": "maja", "link": "https://stackoverflow.com/users/2224996/maja"}, "edited": false, "score": 0, "creation_date": 1592403180, "post_id": 28024908, "comment_id": 110413364, "body": "It definitely improves it, but I&#39;m not sure it&#39;s correct in all cases, since <code>filepath.Abs</code> explicitly states that it doesn&#39;t return a unique representation."}, {"owner": {"reputation": 14131, "user_id": 2224996, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/EDCvE.jpg?s=128&g=1", "display_name": "maja", "link": "https://stackoverflow.com/users/2224996/maja"}, "edited": false, "score": 0, "creation_date": 1592403291, "post_id": 28024908, "comment_id": 110413424, "body": "Another issue with this answer: You not only need to check for the <code>..&#47;</code> prefix, but also if the result is <code>..</code>. This can happen for <code>Rel(&quot;rel&#47;path&quot;, &quot;rel&quot;)</code>."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 14131, "user_id": 2224996, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/EDCvE.jpg?s=128&g=1", "display_name": "maja", "link": "https://stackoverflow.com/users/2224996/maja"}, "edited": false, "score": 0, "creation_date": 1592404684, "post_id": 28024908, "comment_id": 110414266, "body": "@maja Good point. Could you edit this answer with a more robust code?"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 12, "last_activity_date": 1421671279, "creation_date": 1421671279, "answer_id": 28024908, "question_id": 28024731, "link": "https://stackoverflow.com/questions/28024731/check-if-given-path-is-a-subdirectory-of-another-in-golang/28024908#28024908", "title": "check if given path is a subdirectory of another in golang", "body": "<p>You could try and use <a href=\"http://golang.org/pkg/path/filepath/#Rel\">path.filepath.Rel()</a>:</p>\n\n<pre><code>func Rel(basepath, targpath string) (string, error)\n</code></pre>\n\n<blockquote>\n  <p><code>Rel</code> returns a relative path that is lexically equivalent to <code>targpath</code> when joined to <code>basepath</code> with an intervening separator.<br>\n  That is, <code>Join(basepath, Rel(basepath, targpath))</code> is equivalent to <code>targpath</code> itself</p>\n</blockquote>\n\n<p>That means <code>Rel(\"c:\\foo\\bar\", \"c:\\foo\\bar\\baz\")</code> should be <code>baz</code>, meaning a subpath completely included in <code>c:\\foo\\bar\\baz</code>, and without any '<code>../</code>'.<br>\nThe same would apply for unix paths.</p>\n\n<p>That would make <code>c:\\foo\\bar\\baz</code> a subdirectory of <code>c:\\foo\\bar</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 914, "user_id": 373993, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/xhmf5.png?s=128&g=1", "display_name": "Oleg Burov", "link": "https://stackoverflow.com/users/373993/oleg-burov"}, "is_accepted": false, "score": 3, "last_activity_date": 1561422321, "creation_date": 1561422321, "answer_id": 56745385, "question_id": 28024731, "link": "https://stackoverflow.com/questions/28024731/check-if-given-path-is-a-subdirectory-of-another-in-golang/56745385#56745385", "title": "check if given path is a subdirectory of another in golang", "body": "<p>You can use the function <a href=\"https://golang.org/pkg/path/filepath/#Match\" rel=\"nofollow noreferrer\">path.filepath.Match()</a></p>\n\n<blockquote>\n  <p>Match reports whether name matches the shell file name pattern.</p>\n</blockquote>\n\n<p>For example:</p>\n\n<pre><code>pattern := \"C:\\foo\\bar\" + string(filepath.Separator) + \"*\"\nmatched, err := filepath.Match(pattern, \"C:\\foo\\bar\\baz\")\n</code></pre>\n\n<p>Where <code>matched</code> should be <code>true</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 14131, "user_id": 2224996, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/EDCvE.jpg?s=128&g=1", "display_name": "maja", "link": "https://stackoverflow.com/users/2224996/maja"}, "is_accepted": false, "score": 2, "last_activity_date": 1592895718, "creation_date": 1592895718, "answer_id": 62529061, "question_id": 28024731, "link": "https://stackoverflow.com/questions/28024731/check-if-given-path-is-a-subdirectory-of-another-in-golang/62529061#62529061", "title": "check if given path is a subdirectory of another in golang", "body": "<p>I haven't found a reliable solution for all types of paths, but the best you can get is by using <code>filepath.Rel</code> as VonC suggested.</p>\n<p>It works if both filepaths are either absolute or relative (mixing is not allowed) and works on both Windows and Linux:</p>\n<pre><code>func SubElem(parent, sub string) (bool, error) {\n    up := &quot;..&quot; + string(os.PathSeparator)\n\n    // path-comparisons using filepath.Abs don't work reliably according to docs (no unique representation).\n    rel, err := filepath.Rel(parent, sub)\n    if err != nil {\n        return false, err\n    }\n    if !strings.HasPrefix(rel, up) &amp;&amp; rel != &quot;..&quot; {\n        return true, nil\n    }\n    return false, nil\n}\n</code></pre>\n<p>Absolute windows paths that start with a drive letter will require an additional check though.</p>\n"}, {"tags": [], "owner": {"reputation": 167, "user_id": 2671828, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/fyPu3.jpg?s=128&g=1", "display_name": "dpaks", "link": "https://stackoverflow.com/users/2671828/dpaks"}, "is_accepted": false, "score": 0, "last_activity_date": 1617979354, "creation_date": 1617979354, "answer_id": 67023206, "question_id": 28024731, "link": "https://stackoverflow.com/questions/28024731/check-if-given-path-is-a-subdirectory-of-another-in-golang/67023206#67023206", "title": "check if given path is a subdirectory of another in golang", "body": "<p>Try this code. This checks if either is a sub-directory of the other. Try changing values of both base and path and the results should be valid.</p>\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;path/filepath&quot;\n    &quot;strings&quot;\n)\n\nfunc main() {\n    base := &quot;/b/c/&quot;\n    path := &quot;/a/b/c/d&quot;\n\n    if len(base) &gt; len(path) {\n        base, path = path, base\n    }\n\n    rel, err := filepath.Rel(base, path)\n    fmt.Printf(&quot;Base %q: Path %q: Rel %q Err %v\\n&quot;, base, path, rel, err)\n    if err != nil {\n        fmt.Println(&quot;PROCEED&quot;)\n        return\n    }\n\n    if strings.Contains(rel, &quot;..&quot;) {\n        fmt.Println(&quot;PROCEED&quot;)\n        return\n    }\n\n    fmt.Println(&quot;DENY&quot;)\n}\n</code></pre>\n"}], "owner": {"reputation": 8597, "user_id": 326543, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f882e1ef33bcbefabf8c2f9463fb1f7f?s=128&d=identicon&r=PG", "display_name": "Srikanth Venugopalan", "link": "https://stackoverflow.com/users/326543/srikanth-venugopalan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3556, "favorite_count": 2, "accepted_answer_id": 28024908, "answer_count": 4, "score": 8, "last_activity_date": 1617979354, "creation_date": 1421670663, "question_id": 28024731, "link": "https://stackoverflow.com/questions/28024731/check-if-given-path-is-a-subdirectory-of-another-in-golang", "title": "check if given path is a subdirectory of another in golang", "body": "<p>Say we have two paths:</p>\n\n<p><code>c:\\foo\\bar\\baz</code> and <code>c:\\foo\\bar</code></p>\n\n<p>Is there any package/method that will help me determine if one is a subdirectory of another? I am looking at a cross-platform option.</p>\n"}, {"tags": ["string", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1421668612, "post_id": 28023566, "comment_id": 44433653, "body": "Actually if the built-in <code>string</code> would have methods, you would still be able to access those methods on your custom types by simply casting your custom type to <code>string</code>. See <a href=\"http://play.golang.org/p/xaij_KWU4l\" rel=\"nofollow noreferrer\"><b>this example</b></a> on Go Playground."}], "answers": [{"comments": [{"owner": {"reputation": 781, "user_id": 2375505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/322780ece5ae3e7a2604592c45368c08?s=128&d=identicon&r=PG", "display_name": "rpkamp", "link": "https://stackoverflow.com/users/2375505/rpkamp"}, "edited": false, "score": 0, "creation_date": 1421668110, "post_id": 28023772, "comment_id": 44433356, "body": "I wasn&#39;t talking about me adding it, but about it being in the language itself. However as @Justin Nu&#223; points out this is not possible because strings are not defined in Go itself, so it would complicate the compiler to make it work."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 781, "user_id": 2375505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/322780ece5ae3e7a2604592c45368c08?s=128&d=identicon&r=PG", "display_name": "rpkamp", "link": "https://stackoverflow.com/users/2375505/rpkamp"}, "edited": false, "score": 0, "creation_date": 1421668289, "post_id": 28023772, "comment_id": 44433450, "body": "@ScallioXTX I wasn&#39;t talking about adding it either. I have edited athe answer."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1421669074, "last_edit_date": 1421669074, "creation_date": 1421667390, "answer_id": 28023772, "question_id": 28023566, "link": "https://stackoverflow.com/questions/28023566/why-are-string-functions-not-defined-on-the-string-type/28023772#28023772", "title": "Why are string functions not defined on the string type?", "body": "<p><code>string</code> is one of the <a href=\"http://golang.org/ref/spec#Predeclared_identifiers\" rel=\"nofollow\">predeclared type</a> in the <a href=\"http://golang.org/pkg/builtin/\" rel=\"nofollow\">builtin package</a>.</p>\n\n<p>Those functions in <code>strings</code> couldn't have been defined as method using a predeclared type as a receiver: that would have required to <a href=\"http://golang.org/ref/spec#Type_declarations\" rel=\"nofollow\">define a type alias</a> (to the underlying type <code>string</code>, in order to attach methods to it).  </p>\n\n<p>A <a href=\"http://golang.org/ref/spec#Method_declarations\" rel=\"nofollow\">method declaration</a> uses a receiver which has a <a href=\"http://golang.org/ref/spec#Type\" rel=\"nofollow\">Type</a>, which in turn does <em>not</em> include any of the predeclared types (bool byte complex64 complex128 error float32 float64 int int8 int16 int32 int64 rune string uint uint8 uint16 uint32 uint64 uintptr).</p>\n\n<p>Or (which is done here), one uses functions in a dedicated package '<a href=\"http://golang.org/pkg/strings/\" rel=\"nofollow\"><code>strings</code></a>'.<br>\nThat seems coherent with the fact that the type string itself has no fields: its content doesn't have to \"receive\" the method, it can simply be used by a function.</p>\n"}, {"comments": [{"owner": {"reputation": 781, "user_id": 2375505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/322780ece5ae3e7a2604592c45368c08?s=128&d=identicon&r=PG", "display_name": "rpkamp", "link": "https://stackoverflow.com/users/2375505/rpkamp"}, "edited": false, "score": 1, "creation_date": 1421668168, "post_id": 28023872, "comment_id": 44433394, "body": "Thanks for that. That answer is really in line with the spirit of Go as I got it so far :)"}, {"owner": {"reputation": 386, "user_id": 7272253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca369b631d0b215c62ddb251aa671101?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas Garnier", "link": "https://stackoverflow.com/users/7272253/nicolas-garnier"}, "reply_to_user": {"reputation": 781, "user_id": 2375505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/322780ece5ae3e7a2604592c45368c08?s=128&d=identicon&r=PG", "display_name": "rpkamp", "link": "https://stackoverflow.com/users/2375505/rpkamp"}, "edited": false, "score": 0, "creation_date": 1552052108, "post_id": 28023872, "comment_id": 96876545, "body": "@rpkamp Yes you&#39;re right. I am quite uncomfortable with some choices that have been made with Go, but whenever I lwant to know more I find a clear, detailed and fully sensible explanation from the Go team about why things have been done this way. That makes me feel very comfident about the bright future of Go."}], "tags": [], "owner": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "is_accepted": true, "score": 10, "last_activity_date": 1421667746, "creation_date": 1421667746, "answer_id": 28023872, "question_id": 28023566, "link": "https://stackoverflow.com/questions/28023566/why-are-string-functions-not-defined-on-the-string-type/28023872#28023872", "title": "Why are string functions not defined on the string type?", "body": "<p>The short answer is: \"To keep the language simple.\"</p>\n\n<p>Go as a language only allows methods to be defined on types that are in the same package, but because <code>string</code> (like other builtin types) is implemented in the language itself, there is no way to add methods to it, without complicating the language / compiler.</p>\n\n<p>It's also partly, because of how Go was designed.</p>\n\n<p>See <a href=\"https://groups.google.com/d/msg/golang-nuts/bhpaR1Pwff4/kdxVBqiyMesJ\">this mail</a> from Rob Pike (one of the creators of Go) for more information:</p>\n\n<blockquote>\n  <p>Go does not have methods on basic types because the designers of the \n  language did not want methods defined for basic types, in part because \n  of the knock-on effect they might have on interfaces. I believe we are \n  all still comfortable with that decision. Others may feel differently. </p>\n  \n  <p>-rob </p>\n</blockquote>\n\n<p>And <a href=\"https://groups.google.com/d/msg/golang-nuts/bhpaR1Pwff4/HKxvRoOh_ZEJ\">this one</a> too:</p>\n\n<blockquote>\n  <p>We simply didn't understand what the implications would be; there's \n  nothing to explain. Go was designed with caution. </p>\n  \n  <p>In that vein, look at the size of the strings library. Making all that \n  functionality methods on the basic type would, as Andrew said, \n  complicate the language. Why complicate the language with such trivial \n  things when it can be achieved by a library, which is more \n  maintainable, easier to extend, and more flexible? The language is \n  much simpler the way things are. </p>\n  \n  <p>-rob </p>\n</blockquote>\n"}], "owner": {"reputation": 781, "user_id": 2375505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/322780ece5ae3e7a2604592c45368c08?s=128&d=identicon&r=PG", "display_name": "rpkamp", "link": "https://stackoverflow.com/users/2375505/rpkamp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 1, "accepted_answer_id": 28023872, "answer_count": 2, "score": 5, "last_activity_date": 1421669074, "creation_date": 1421666781, "question_id": 28023566, "link": "https://stackoverflow.com/questions/28023566/why-are-string-functions-not-defined-on-the-string-type", "title": "Why are string functions not defined on the string type?", "body": "<p>I was just wondering why the string functions in Google Go are defined in a <code>strings</code> package as opposed to on the <code>string</code> data type itself. They could have easily done</p>\n\n<pre><code>func (s string) ToUpper() string {\n}\n</code></pre>\n\n<p>instead of the current</p>\n\n<pre><code>func ToUpper(s string) string {\n}\n</code></pre>\n\n<p>in the <code>strings</code> package.</p>\n\n<p>My guess is that if you want to implement a custom version of <code>ToUpper</code> on a custom type that extends <code>string</code> (i.e., <code>type MyString string</code>), you have no way to access the builtin <code>ToUpper</code> anymore on that type, but I can't find any support on this.</p>\n"}, {"tags": ["ruby", "go", "rust"], "comments": [{"owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "edited": false, "score": 0, "creation_date": 1421684101, "post_id": 28021991, "comment_id": 44442844, "body": "You could choose to use a calculator to verify the results <i>before</i> assuming that there is a math error in/with Rust. (Hint: don&#39;t use 999999999 as a number but perhaps 3 or so)."}], "answers": [{"tags": [], "owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "is_accepted": true, "score": 5, "last_activity_date": 1421661998, "creation_date": 1421661998, "answer_id": 28022086, "question_id": 28021991, "link": "https://stackoverflow.com/questions/28021991/rust-math-error/28022086#28022086", "title": "Rust math error", "body": "<p>You are not summing the last element (99999999) in Go and Ruby: </p>\n\n<pre><code>func main() {\n    var sum = int64(0)\n    for i := int64(1); i &lt;= 99999999; i++ {\n        sum += i\n    }\n    fmt.Println(sum)\n}\n\n4999999950000000\n</code></pre>\n"}], "owner": {"reputation": 2835, "user_id": 143511, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/561f6b93e60563dabb66fb9802d06fa3?s=128&d=identicon&r=PG", "display_name": "Alexey Poimtsev", "link": "https://stackoverflow.com/users/143511/alexey-poimtsev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 28022086, "answer_count": 1, "score": -4, "last_activity_date": 1421683395, "creation_date": 1421661668, "last_edit_date": 1421683395, "question_id": 28021991, "link": "https://stackoverflow.com/questions/28021991/rust-math-error", "title": "Rust math error", "body": "<p>I have following code in Rust:</p>\n\n<pre><code>fn main() {\n\n    let mut sum = 0is;\n    for i in (0is..100000000is) {\n        sum = sum + i;\n    }\n    println! (\"{}\", sum);\n}\n</code></pre>\n\n<p>as a result, I have 4999999950000000</p>\n\n<p>But, when I try to check this code with Golang and Ruby - I see another result</p>\n\n<p>golang version:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n  var sum = 0\n  for i := 1; i &lt; 99999999; i++ {\n      sum += i\n  }\n\n  fmt.Println(sum)\n}\n</code></pre>\n\n<p>Ruby version:</p>\n\n<pre><code>@sum = 0\n(1...99999999).each do |i|\n  @sum += i\nend\n\nputs @sum\n</code></pre>\n\n<p>and the result for both Ruby and Golang is 4999999850000001</p>\n\n<p>PS: yep, I know about difference between 100000000 and 99999999 - it's because of inclusion right part in Rust in <strong>0is..100000000is</strong></p>\n"}, {"tags": ["go", "cmd"], "answers": [{"tags": [], "owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "is_accepted": true, "score": 2, "last_activity_date": 1421661638, "creation_date": 1421661638, "answer_id": 28021983, "question_id": 28021552, "link": "https://stackoverflow.com/questions/28021552/golang-monitor-cmd-output/28021983#28021983", "title": "golang monitor cmd output", "body": "<p>Output is buffered. Add <code>stdout.flush()</code> after <code>print</code></p>\n\n<pre><code>import time\nfrom sys import stdout\n\ni=0\nwhile 1:\n    print(\"%d\" % i) \n    stdout.flush()\n    time.sleep(1)\n    i += 1\n</code></pre>\n"}], "owner": {"reputation": 1667, "user_id": 1189265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c896b3733e183657009a426834a9dab?s=128&d=identicon&r=PG", "display_name": "daizuozhuo", "link": "https://stackoverflow.com/users/1189265/daizuozhuo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 1, "accepted_answer_id": 28021983, "answer_count": 1, "score": 1, "last_activity_date": 1421661638, "creation_date": 1421660193, "last_edit_date": 1421660783, "question_id": 28021552, "link": "https://stackoverflow.com/questions/28021552/golang-monitor-cmd-output", "title": "golang monitor cmd output", "body": "<p>I want to monitor a process status. The task is almost like this. t.py just outputs a number every second and I want to use test.go to store this number into a file. Unfortunately, the following code cannot do the job.</p>\n\n<p>t.py:</p>\n\n<pre><code>import time\nfrom sys import stdout\n\ni=0\nwhile 1:\n    print(\"%d\" % i) \n    time.sleep(1)\n    i += 1\n</code></pre>\n\n<p>test.go</p>\n\n<pre><code>import (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"os/exec\"\n)\n\nfunc main() {\n    cmd := exec.Command(\"python\", \"t.py\")\n    stdout, err := cmd.StdoutPipe()\n    if err != nil {\n        fmt.Println(err)\n    }\n    scanner := bufio.NewScanner(stdout)\n    err = cmd.Start()\n    if err != nil {\n        fmt.Println(err)\n    }\n    for scanner.Scan() {\n        line := scanner.Text()\n        f, _ := os.Create(\"./temp.txt\")\n        fmt.Fprintf(f, \"then %s\\n\", line)\n        f.Close()\n    }\n}\n</code></pre>\n"}, {"tags": ["vim", "go"], "comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1421660250, "post_id": 28021475, "comment_id": 44429190, "body": "It should be those keys, considering they are mentioned in <a href=\"http://stackoverflow.com/q/7722177/6309\">stackoverflow.com/q/7722177/6309</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3889, "user_id": 100405, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/924e4500ab6bdce291ab6346099ede26?s=128&d=identicon&r=PG", "display_name": "weima", "link": "https://stackoverflow.com/users/100405/weima"}, "edited": false, "score": 2, "creation_date": 1486543858, "post_id": 28021582, "comment_id": 71385834, "body": "when i use this key combination, in insert mode, the window appaears , and first entry gets selected automatically and inserted."}], "tags": [], "owner": {"reputation": 12666, "user_id": 49329, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/cd991227ac34793b8bae42972cbb03d6?s=128&d=identicon&r=PG", "display_name": "Don Reba", "link": "https://stackoverflow.com/users/49329/don-reba"}, "is_accepted": true, "score": 13, "last_activity_date": 1421660284, "creation_date": 1421660284, "answer_id": 28021582, "question_id": 28021475, "link": "https://stackoverflow.com/questions/28021475/how-do-you-type-c-xc-o-in-vim/28021582#28021582", "title": "How do you type &lt;C-x&gt;&lt;C-o&gt; in Vim?", "body": "<p>It's Ctrl+X, Ctrl+O. This combination is used in Vim for omnicompletion. Type <code>:h omnifunc</code> or <code>:h ft-go-omni</code> (I presume) for more information.</p>\n"}, {"tags": [], "owner": {"reputation": 6973, "user_id": 720391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lGHly.png?s=128&g=1", "display_name": "mattn", "link": "https://stackoverflow.com/users/720391/mattn"}, "is_accepted": false, "score": 1, "last_activity_date": 1421661425, "last_edit_date": 1592644375, "creation_date": 1421661425, "answer_id": 28021898, "question_id": 28021475, "link": "https://stackoverflow.com/questions/28021475/how-do-you-type-c-xc-o-in-vim/28021898#28021898", "title": "How do you type &lt;C-x&gt;&lt;C-o&gt; in Vim?", "body": "<ul>\n<li><p>go is executable?</p>\n<p>do you add path to golang into $PATH?</p>\n</li>\n<li><p>vim-go is loaded?</p>\n<p>if you are using vim-plug or pluggable interface for plugins, you should have vim-go in ~/.vim/bundle</p>\n</li>\n<li><p>are you editing go file?</p>\n<p>check <code>:set ft?</code> is <code>go</code></p>\n</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 881, "user_id": 1624112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cc1cL.jpg?s=128&g=1", "display_name": "Specode", "link": "https://stackoverflow.com/users/1624112/specode"}, "is_accepted": false, "score": 0, "last_activity_date": 1421661883, "creation_date": 1421661883, "answer_id": 28022056, "question_id": 28021475, "link": "https://stackoverflow.com/questions/28021475/how-do-you-type-c-xc-o-in-vim/28022056#28022056", "title": "How do you type &lt;C-x&gt;&lt;C-o&gt; in Vim?", "body": "<p>Do u execute \":GoInstallBinaries\" in the vim?</p>\n\n<p>And the bin path is add?</p>\n\n<p>ps:</p>\n\n<p>The default keybind is complex,</p>\n\n<p>I recommend using <a href=\"https://github.com/Shougo/neocomplete.vim\" rel=\"nofollow\">neocomplete.vim</a> by Shougo and add follows on the <a href=\"https://github.com/Shougo/neocomplete.vim#configuration-examples\" rel=\"nofollow\">base configuration</a>:</p>\n\n<pre><code>let g:neocomplete#sources#omni#input_patterns.go = '\\h\\w*\\.\\?'\ninoremap &lt;silent&gt; &lt;CR&gt; &lt;C-r&gt;=&lt;SID&gt;my_cr_function()&lt;CR&gt;\nfunction! s:my_cr_function()\n    return pumvisible() ? neocomplete#close_popup() : \"\\&lt;CR&gt;\"\nendfunction\ninoremap &lt;expr&gt;&lt;TAB&gt;  pumvisible() ? \"\\&lt;C-n&gt;\" : \"\\&lt;TAB&gt;\"\n</code></pre>\n"}], "owner": {"reputation": 5024, "user_id": 1419891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bb825cd3f1905f42c16408393480a65b?s=128&d=identicon&r=PG", "display_name": "425nesp", "link": "https://stackoverflow.com/users/1419891/425nesp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7101, "favorite_count": 1, "accepted_answer_id": 28021582, "answer_count": 3, "score": 12, "last_activity_date": 1421709470, "creation_date": 1421659963, "last_edit_date": 1421709470, "question_id": 28021475, "link": "https://stackoverflow.com/questions/28021475/how-do-you-type-c-xc-o-in-vim", "title": "How do you type &lt;C-x&gt;&lt;C-o&gt; in Vim?", "body": "<p>What keys do <code>&lt;C-x&gt;&lt;C-o&gt;</code> represent in Vim? My goal is to get autocompletions working for Golang.</p>\n\n<p>I've installed this plugin and have the syntax highlighting working.</p>\n\n<p><a href=\"https://github.com/fatih/vim-go\" rel=\"noreferrer\">https://github.com/fatih/vim-go</a></p>\n\n<p>The readme says that, \"Autocompletion is enabled by default via <code>&lt;C-x&gt;&lt;C-o&gt;</code>\", but I don't know which keys to press.</p>\n"}, {"tags": ["regex", "go", "xlsx"], "answers": [{"tags": [], "owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "is_accepted": true, "score": 3, "last_activity_date": 1421660261, "last_edit_date": 1421660261, "creation_date": 1421659396, "answer_id": 28021321, "question_id": 28020979, "link": "https://stackoverflow.com/questions/28020979/get-the-xlsx-cell-data-using-the-the-golang-regexp/28021321#28021321", "title": "get the xlsx cell data using the the golang regexp?", "body": "<p>I think <code>regexp</code> is the wrong tool for this job. Try xml:</p>\n\n<pre><code>import \"encoding/xml\"\n\n// Could probably pick better names for these.\ntype C struct {\n    XMLName xml.Name `xml:\"c\"`\n    V       string   `xml:\"v\"`\n    R       string   `xml:\"r,attr\"`\n}\ntype Row struct {\n    XMLName xml.Name `xml:\"row\"`\n    C       []C      `xml:\"c\"`\n}\ntype Result struct {\n    XMLName xml.Name `xml:\"sheetData\"`\n    Row     []Row    `xml:\"row\"`\n}\nv := Result{}\n\nerr := xml.Unmarshal([]byte(input), &amp;v)\nif err != nil {\n    fmt.Printf(\"error: %v\", err)\n    return\n}\nfor _, r := range v.Row {\n    for _, c := range r.C {\n        fmt.Printf(\"%v %v\\n\", c.V, c.R)\n    }\n}\n</code></pre>\n\n<p>This will print:</p>\n\n<pre><code>{{range .txt}} A2\n1 B2\n2 C2\n3 D2\n...\n</code></pre>\n"}], "owner": {"reputation": 285, "user_id": 3373877, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/532526780ffab7d05fae3a14045c3f8d?s=128&d=identicon&r=PG&f=1", "display_name": "user3373877", "link": "https://stackoverflow.com/users/3373877/user3373877"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 28021321, "answer_count": 1, "score": -1, "last_activity_date": 1421736542, "creation_date": 1421658071, "question_id": 28020979, "link": "https://stackoverflow.com/questions/28020979/get-the-xlsx-cell-data-using-the-the-golang-regexp", "title": "get the xlsx cell data using the the golang regexp?", "body": "<p>I  use the regexp expression to get the data from .xlsx file. but i am poor and a newer in regexp.  Anyone could help me?</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"regexp\"\n)\n\nfunc main() {\n        input := `\n        &lt;sheetData&gt;\n        &lt;row r=\"2\" spans=\"1:15\"&gt;\n        &lt;c r=\"A2\" s=\"5\" &gt;&lt;v&gt;{{range .txt}}&lt;/v&gt;&lt;/c&gt;\n        &lt;c r=\"B2\" s=\"5\" t=\"s\"&gt;&lt;v&gt;1&lt;/v&gt;&lt;/c&gt;\n        &lt;c r=\"C2\" s=\"5\" t=\"s\"&gt;&lt;v&gt;2&lt;/v&gt;&lt;/c&gt;\n        &lt;c r=\"D2\" s=\"5\" t=\"s\"&gt;&lt;v&gt;3&lt;/v&gt;&lt;/c&gt;\n        &lt;c r=\"E2\" s=\"5\" /&gt;\n        &lt;c r=\"K2\" s=\"6\" t=\"s\"&gt;&lt;v&gt;21&lt;/v&gt;&lt;/c&gt;\n    &lt;/row&gt; \n    &lt;row r=\"3\" spans=\"1:15\"&gt;\n        &lt;c r=\"A3\" s=\"5\" t=\"s\"&gt;&lt;v&gt;0&lt;/v&gt;&lt;/c&gt;\n        &lt;c r=\"B3\" s=\"5\" t=\"s\"&gt;&lt;v&gt;1&lt;/v&gt;&lt;/c&gt;\n        &lt;c r=\"C3\" s=\"5\" t=\"s\"&gt;&lt;v&gt;2&lt;/v&gt;&lt;/c&gt;\n        &lt;c r=\"D3\" s=\"5\" t=\"s\"&gt;&lt;v&gt;3&lt;/v&gt;&lt;/c&gt;\n        &lt;c r=\"E3\" s=\"5\" /&gt;\n        &lt;c r=\"K3\" s=\"6\" t=\"s\"&gt;&lt;v&gt;21&lt;/v&gt;&lt;/c&gt;\n    &lt;/row&gt; \n    &lt;/sheetData&gt;`\n        r := regexp.MustCompile(`&lt;row[^&gt;]*?r=\"(\\d+)\"[^&gt;].*?&gt;.*?[(&lt;v&gt;(.*?)&lt;\\/v&gt;.*?)]&lt;\\/row&gt;`)\n        r2 := regexp.MustCompile(`&lt;v&gt;(.*?)&lt;/v&gt;`)\n        row:=r.FindAllString(input,-1)\n        for _,v:=range row {\n        fmt.Println(r.ReplaceAllStringFunc(v, func(m string) string {\n               match:=r2.FindAllString(v,-1)\n            for kk,vv:=range match {\n            fmt.Println(kk,vv)\n             fmt.Println(r2.ReplaceAllString(v, \"\"))             \n        }  \n      }))\n        }\n    }   \n</code></pre>\n\n<p>Question:</p>\n\n<ol>\n<li><p>How to get the string {{range .txt}} ,and throw off the tag\"...\"</p></li>\n<li><p>How to get the \"3\" from <code>r=\"3\"</code> ,and get the \"A3,B3\uff0cC3...\" from the \"</li>\n</ol>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["serialization", "go", "deserialization"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 2, "creation_date": 1433821054, "post_id": 28020070, "comment_id": 49502446, "body": "For reference, the <a href=\"https://github.com/boj/redistore/blob/master/redistore.go\" rel=\"nofollow noreferrer\">boj/redistore</a> library serialises session data to Redis using either <code>encoding&#47;gob</code> or <code>encoding&#47;json</code> and just saves the raw []byte slice to Redis: <a href=\"https://github.com/boj/redistore/blob/master/redistore.go#L313\" rel=\"nofollow noreferrer\">github.com/boj/redistore/blob/master/redistore.go#L313</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1164, "user_id": 625745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38010a01153b0c926db4491c0937e068?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Franzl", "link": "https://stackoverflow.com/users/625745/michael-franzl"}, "edited": false, "score": 2, "creation_date": 1487582684, "post_id": 28020591, "comment_id": 71833389, "body": "The comment about &quot;public field only&quot; was important."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 14, "last_activity_date": 1559081092, "last_edit_date": 1559081092, "creation_date": 1421656420, "answer_id": 28020591, "question_id": 28020070, "link": "https://stackoverflow.com/questions/28020070/golang-serialize-and-deserialize-back/28020591#28020591", "title": "Golang serialize and deserialize back", "body": "<p>Serialization of a struct generally uses the <a href=\"http://golang.org/pkg/encoding/\" rel=\"noreferrer\"><code>encoding</code></a> package. However, that will work for public fields only. If you also need to serialize private fields, <a href=\"https://stackoverflow.com/a/12854659/6309\">see this answer</a> as an alternative.<br>\nYou have several encoding choices (binary, text, <a href=\"https://stackoverflow.com/a/8271160/6309\">json as in this example for a struct</a>, xml, etc.). For example, the project <a href=\"https://github.com/cupcake/rdb\" rel=\"noreferrer\"><code>cupcake/rdb</code></a> uses <a href=\"http://golang.org/pkg/encoding/binary/\" rel=\"noreferrer\"><code>encoding/binary</code></a> to implement parsing and encoding of the <a href=\"http://redis.io/\" rel=\"noreferrer\">Redis</a> <a href=\"https://github.com/sripathikrishnan/redis-rdb-tools/blob/master/docs/RDB_File_Format.textile\" rel=\"noreferrer\">RDB file format</a> (a binary representation of the in-memory store).\nAnother example is <a href=\"https://github.com/guregu/rediscache\" rel=\"noreferrer\"><code>guregu/rediscache</code></a>, a small library for caching data in Redis.</p>\n"}, {"comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 9, "creation_date": 1433828332, "post_id": 30721381, "comment_id": 49504739, "body": "You shouldn&#39;t even need to base64 encode the result from gob - you can just save the <code>[]byte</code> to Redis. Faster, too. JSON encoding also benches a little faster than <code>encoding&#47;gob</code> although it&#39;s unlikely to be a substantial/noticeable difference in most apps."}, {"owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1433835446, "post_id": 30721381, "comment_id": 49508338, "body": "I&#39;ve tried JSON encoding before, it&#39;s the reason I asked this question, but it failed to convert <code>map[int]..</code> or decode correctly, for example: <code>map[string]bool</code> when encoded and decoded back would become <code>map[string]interface{}</code>"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1433840109, "post_id": 30721381, "comment_id": 49511110, "body": "For <code>map[int]...</code> you&#39;ll need to satisfy the <code>json.Marshaller</code> and <code>json.Unmarshaller</code> interfaces as JSON keys are strings. Your <code>map[string]bool</code> should have worked fine though."}], "tags": [], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "is_accepted": true, "score": 34, "last_activity_date": 1433811317, "creation_date": 1433811317, "answer_id": 30721381, "question_id": 28020070, "link": "https://stackoverflow.com/questions/28020070/golang-serialize-and-deserialize-back/30721381#30721381", "title": "Golang serialize and deserialize back", "body": "<p>Using <a href=\"https://golang.org/pkg/encoding/gob/\">gob</a> and <a href=\"https://golang.org/pkg/encoding/base64/\">base64</a> could solve the problem, for example:</p>\n\n<pre><code>import (\n    \"encoding/base64\"\n    \"encoding/gob\"\n    \"bytes\"\n)\n\ntype SX map[string]interface{}\n\n// go binary encoder\nfunc ToGOB64(m SX) string {\n    b := bytes.Buffer{}\n    e := gob.NewEncoder(&amp;b)\n    err := e.Encode(m)\n    if err != nil { fmt.Println(`failed gob Encode`, err) }\n    return base64.StdEncoding.EncodeToString(b.Bytes())\n}\n\n// go binary decoder\nfunc FromGOB64(str string) SX {\n    m := SX{}\n    by, err := base64.StdEncoding.DecodeString(str)\n    if err != nil { fmt.Println(`failed base64 Decode`, err); }\n    b := bytes.Buffer{}\n    b.Write(by)\n    d := gob.NewDecoder(&amp;b)\n    err = d.Decode(&amp;m)\n    if err != nil { fmt.Println(`failed gob Decode`, err); }\n    return m\n}\n</code></pre>\n\n<p>and when you need to serialize custom struct or type (for example <code>Session</code> struct), just add these lines:</p>\n\n<pre><code>func init() {\n    gob.Register(SX{})\n    gob.Register(Session{}) \n}\n</code></pre>\n"}], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48355, "favorite_count": 15, "accepted_answer_id": 30721381, "answer_count": 2, "score": 29, "last_activity_date": 1559081092, "creation_date": 1421653905, "question_id": 28020070, "link": "https://stackoverflow.com/questions/28020070/golang-serialize-and-deserialize-back", "title": "Golang serialize and deserialize back", "body": "<p>What's the best way (completeness and performance) in Golang to serialize and deserialize a struct to string and vice versa?</p>\n\n<p>for example, if I have this struct:</p>\n\n<pre><code>struct Session {\n   Properties map[string]interface{}\n   Permissions []int64\n}\n</code></pre>\n\n<p>I want to store it on <a href=\"http://github.com/garyburd/redigo/redis\">Redis</a> and fetch it back. I have tried to save, int and string, it's fine, but how to store struct object?</p>\n\n<pre><code>conn := redisConnectors.Get()\n\n// set example\n\n_, err := conn.Do(`SETEX`, `uid_key`, EXPIRE_SEC, user_id)\n_, err = conn.Do(`SETEX`, `email_key`, EXPIRE_SEC, login_email)\n\n// get example\n\nuser_id, err := redis.Int64(conn.Do(`GET`, `uid_key`))\nlogin_email, err := redis.String(conn.Do(`GET`, `email_key`))\n</code></pre>\n"}, {"tags": ["string", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1421650263, "post_id": 28018731, "comment_id": 44425018, "body": "If your question is about your code, include it in the question, don&#39;t post it on another site. If the coDe is too long, only post the relevant part(s). Create a minimal, complete, verifiable example: <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>"}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 3032409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbc27aa6b0b03945ccc492e84618fca7?s=128&d=identicon&r=PG&f=1", "display_name": "sundyli", "link": "https://stackoverflow.com/users/3032409/sundyli"}, "is_accepted": false, "score": 0, "last_activity_date": 1421647822, "creation_date": 1421647822, "answer_id": 28018827, "question_id": 28018731, "link": "https://stackoverflow.com/questions/28018731/golang-put-string-in-map/28018827#28018827", "title": "GoLang put string in map", "body": "<p>while,the code below is your source code</p>\n\n<pre><code>func handleAddFunc(w http.ResponseWriter, r *http.Request) {\nbackend := r.FormValue(\"backend\")\nkey := r.FormValue(\"key\")\nif !isAuthorized(key) {\n    respond(w, r, 403, \"\")\n    return\n}\nw.Header().Set(\"Content-Type\", \"text/plain\")\nif !readConfig() {\n    return\n}\n\nactiveAddrs = make([]proxy.Address, len(config.Proxy.ServerAddrs))\nbackendAddr = make([]proxy.Address, len(backend))\ncopy(backendAddr, config.Proxy.ServerAddrs)\ncopy(backendAddr, backend)\nloadBalancer.SetAddrs(backendAddr)\nfmt.Fprintf(w, \"Input value of \", backend, \"and here is the byte\",      backendAddr)\n\n}\n</code></pre>\n\n<p>your code's error, is  <code>copy(backendAddr, backend)</code>, variable backend is a string value from the request from, you may change this into <code>[]proxy.Address</code>, such as (consider I donnot know the struct of proxy.Address ): </p>\n\n<pre><code>var backendAddr = []proxy.Address{}\nfor _,str := range strings.split(backend,\",\"){\n         backendAddr = append(backendAddr, &amp;proxy.Address(str))\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4468736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0f47e06e6afbc85dcfb9292781ba7f1?s=128&d=identicon&r=PG&f=1", "display_name": "Ralphie48", "link": "https://stackoverflow.com/users/4468736/ralphie48"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 237, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1421647822, "creation_date": 1421647200, "question_id": 28018731, "link": "https://stackoverflow.com/questions/28018731/golang-put-string-in-map", "title": "GoLang put string in map", "body": "<p>So, I'm trying to add a string to an existing map that is created from toml. </p>\n\n<p><a href=\"http://hastebin.com/vayolavose\" rel=\"nofollow\">http://hastebin.com/vayolavose</a></p>\n\n<p>When I try and build I get the error:</p>\n\n<p>./web.go:56: arguments to copy have different element types: []proxy.Address and string</p>\n\n<p>How would I go about converting it? I've been trying this for the past like 4 hours.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1421649975, "post_id": 28017899, "comment_id": 44424933, "body": "&quot;Go does not use the term &#39;classes,&#39;&quot; maybe? Your text is accurate--Go doesn&#39;t have the keyword and it isn&#39;t used in the spec. But I don&#39;t want to lead someone to think they can&#39;t do the things they&#39;re used to doing with classes in Go, since often they can with some combination of named types/embedding/interfaces."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 5, "last_activity_date": 1421641225, "creation_date": 1421641225, "answer_id": 28017899, "question_id": 28017722, "link": "https://stackoverflow.com/questions/28017722/does-go-have-partial-classes/28017899#28017899", "title": "Does Go have Partial Classes?", "body": "<p>The method declarations for a type do not need to be in the same source file as the type declaration or other method declarations for the type. The method declarations do need to be in the same package as the type declaration.</p>\n\n<p>A type declaration cannot be split across files.</p>\n\n<p>Go does not have classes.</p>\n"}, {"tags": [], "owner": {"reputation": 134, "user_id": 2079944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7e09e017a5028047260597cd85d5250?s=128&d=identicon&r=PG", "display_name": "Zanven", "link": "https://stackoverflow.com/users/2079944/zanven"}, "is_accepted": false, "score": 1, "last_activity_date": 1600016715, "last_edit_date": 1600016715, "creation_date": 1421645345, "answer_id": 28018450, "question_id": 28017722, "link": "https://stackoverflow.com/questions/28017722/does-go-have-partial-classes/28018450#28018450", "title": "Does Go have Partial Classes?", "body": "<p>In Go you can have a method associated with any type within the same package in any file. Take this small example of object <code>foo</code> with function <code>Bar</code>.</p>\n<pre><code>package main\nimport &quot;fmt&quot;\n\ntype foo struct {} // put variables associated with the type here\nfunc ( /*f*/ foo) Bar() { // put a value in front of foo if u need to access any elements in the object\n    // do something interesting\n    fmt.Println(&quot;Method called :D&quot;)\n}\n\nfunc main() {\n    example := foo{}\n    example.Bar()\n}\n</code></pre>\n<p>As long as <code>foo</code> and <code>bar</code> declarations occur in the same package they can be placed in any file.</p>\n<p>I hope this demonstrated the desired functionality you are trying to implement / wondering if Go can support.</p>\n"}], "owner": {"reputation": 8564, "user_id": 841090, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/CYTJH.jpg?s=128&g=1", "display_name": "Passionate Engineer", "link": "https://stackoverflow.com/users/841090/passionate-engineer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 462, "favorite_count": 0, "accepted_answer_id": 28017899, "answer_count": 2, "score": -1, "last_activity_date": 1600016715, "creation_date": 1421639468, "last_edit_date": 1421691683, "question_id": 28017722, "link": "https://stackoverflow.com/questions/28017722/does-go-have-partial-classes", "title": "Does Go have Partial Classes?", "body": "<p>Are there partial classes in Go?</p>\n\n<p>Like the one here in C#?\n<a href=\"http://msdn.microsoft.com/en-us/library/wa80x488.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/wa80x488.aspx</a></p>\n\n<p>I suppose there isn't any as you cannot partially declare structs.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1421817824, "post_id": 28016484, "comment_id": 44501665, "body": "See <a href=\"https://github.com/golang/go/issues/5147\" rel=\"nofollow noreferrer\">Go issue #5147</a>."}], "answers": [{"comments": [{"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 0, "creation_date": 1421635162, "post_id": 28016548, "comment_id": 44421573, "body": "Any reason for the down vote?  I can update the answer if you think there is something wrong."}], "tags": [], "owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "is_accepted": true, "score": 4, "last_activity_date": 1421628635, "creation_date": 1421628635, "answer_id": 28016548, "question_id": 28016484, "link": "https://stackoverflow.com/questions/28016484/maps-in-go-how-to-avoid-double-key-lookup/28016548#28016548", "title": "Maps in Go - how to avoid double key lookup?", "body": "<p>Go does not expose the map's internal (key,value) pair data structure like C++ does, so you can't replicate this exactly.</p>\n\n<p>One possible work around would be to make the values of your map pointers, so you can keep the same values in the map but update what they point to.  For example, if <code>m</code> is a <code>map[int]*int</code>, you could change a value with:</p>\n\n<pre><code>v := m[10]\n*v = 42\n</code></pre>\n\n<p>With that said, I wouldn't be surprised if the savings from reducing the number of hash lookups will be eaten by the additional memory management overhead.  So it would be worth benchmarking whatever solution you settle on.</p>\n"}, {"comments": [{"owner": {"reputation": 539, "user_id": 2352611, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/0fY8c.jpg?s=128&g=1", "display_name": "Larytet", "link": "https://stackoverflow.com/users/2352611/larytet"}, "edited": false, "score": 0, "creation_date": 1537008661, "post_id": 28017107, "comment_id": 91633861, "body": "In one of my benchmarks I get this  (map access dominates the CPU cycles) : <code>1.58s 28.11% 28.11%      1.66s 29.54%  runtime.mapaccess2_fast64  0.87s 15.48% 43.59%      0.92s 16.37%  runtime.mapaccess1_fast64</code>"}], "tags": [], "owner": {"reputation": 99684, "user_id": 149482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb6a2b464b7190c48e4f148a0e51d13a?s=128&d=identicon&r=PG", "display_name": "Matt Joiner", "link": "https://stackoverflow.com/users/149482/matt-joiner"}, "is_accepted": false, "score": 2, "last_activity_date": 1421634146, "creation_date": 1421634146, "answer_id": 28017107, "question_id": 28016484, "link": "https://stackoverflow.com/questions/28016484/maps-in-go-how-to-avoid-double-key-lookup/28017107#28017107", "title": "Maps in Go - how to avoid double key lookup?", "body": "<p>You cannot. The situation is actually the same with Python dicts. However it shouldn't matter. Both lookup and assignment to a Go map are amortized O(1). Combining the two operations has the same time complexity.</p>\n"}], "owner": {"reputation": 953, "user_id": 608958, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/920c3fee71480a12e35d5084f44d8638?s=128&d=identicon&r=PG", "display_name": "rincewind", "link": "https://stackoverflow.com/users/608958/rincewind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 28016548, "answer_count": 2, "score": 3, "last_activity_date": 1421634146, "creation_date": 1421627931, "question_id": 28016484, "link": "https://stackoverflow.com/questions/28016484/maps-in-go-how-to-avoid-double-key-lookup", "title": "Maps in Go - how to avoid double key lookup?", "body": "<p>Suppose I want to update some existing value in a map, or do something else if the key is not found. How do I do this, without performing 2 lookups? What's the golang equivalent of the following C++ code:</p>\n\n<pre><code>auto it = m.find(key);\nif (it != m.end()) {\n    // update the value, without performing a second lookup\n    it-&gt;second = calc_new_value(it-&gt;second);\n} else {\n    // do something else\n    m.insert(make_pair(key, 42));\n}\n</code></pre>\n"}, {"tags": ["arrays", "json", "go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1428791455, "post_id": 28015753, "comment_id": 47315753, "body": "<i>Why</i> don&#39;t you want a struct? Just for JSON? An array of interfaces is annoying to deal with everywhere else in your code so I&#39;d only use it if there was (almost) no other code accessing the data and if it was only for marshaling into JSON or something. You can easily write a custom marshaller that will write the struct you give it as a JSON array."}], "answers": [{"tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": true, "score": 10, "last_activity_date": 1421622876, "creation_date": 1421622876, "answer_id": 28015913, "question_id": 28015753, "link": "https://stackoverflow.com/questions/28015753/serialize-a-mixed-type-json-array-in-go/28015913#28015913", "title": "Serialize a mixed type JSON array in Go", "body": "<p>Use <code>[]interface{}</code></p>\n\n<pre><code>type Results struct {\n     Rows []interface{} `json:\"results\"`\n}\n</code></pre>\n\n<p>You will then have to use type assertion if you want to access the values stored in <code>[]interface{}</code></p>\n\n<pre><code>for _, row := range results.Rows {\n    switch r := row.(type) {\n    case string:\n        fmt.Println(\"string\", r)\n    case float64:\n        fmt.Println(\"float64\", r)\n    case int64:\n        fmt.Println(\"int64\", r)\n    default:\n        fmt.Println(\"not found\")\n    } \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1421624549, "creation_date": 1421624549, "answer_id": 28016115, "question_id": 28015753, "link": "https://stackoverflow.com/questions/28015753/serialize-a-mixed-type-json-array-in-go/28016115#28016115", "title": "Serialize a mixed type JSON array in Go", "body": "<p>Some clumsy, but you can</p>\n\n<pre><code>type result [][]interface{}\ntype results struct {\n    Results result\n}\n</code></pre>\n\n<p>Working example <a href=\"https://play.golang.org/p/IXAzZZ3Dg7\" rel=\"nofollow\">https://play.golang.org/p/IXAzZZ3Dg7</a></p>\n"}, {"tags": [], "owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "is_accepted": false, "score": 12, "last_activity_date": 1421628559, "last_edit_date": 1421628559, "creation_date": 1421628159, "answer_id": 28016508, "question_id": 28015753, "link": "https://stackoverflow.com/questions/28015753/serialize-a-mixed-type-json-array-in-go/28016508#28016508", "title": "Serialize a mixed type JSON array in Go", "body": "<p>We can customize how an object is serialized by implementing the <a href=\"http://golang.org/pkg/encoding/json/#Marshaler\" rel=\"noreferrer\">json.Marshaler</a> interface.  For our particular case, we seem to have a slice of <code>Row</code> elements that we want to encode as an array of heterogenous values.  We can do so by defining a <code>MarshalJSON</code> function on our <code>Row</code> type, using an intermediate slice of <code>interface{}</code> to encode the mixed values.</p>\n\n<p><a href=\"http://play.golang.org/p/iR3G_9EoZN\" rel=\"noreferrer\">This example</a> demonstrates:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Row struct {\n    Ooid  string\n    Score float64\n    Text  string\n}\n\nfunc (r *Row) MarshalJSON() ([]byte, error) {\n    arr := []interface{}{r.Ooid, r.Score, r.Text}\n    return json.Marshal(arr)\n}\n\nfunc main() {\n    rows := []Row{\n        {\"ooid1\", 2.0, \"S\u00f6me text\"},\n        {\"ooid2\", 1.3, \"\u00c5ther text\"},\n    }\n    marshalled, _ := json.Marshal(rows)\n    fmt.Println(string(marshalled))\n}\n</code></pre>\n\n<p>Of course, we also might want to go the other way around, from JSON bytes back to structs.  So there's a similar <a href=\"http://golang.org/pkg/encoding/json/#Unmarshaler\" rel=\"noreferrer\">json.Unmarshaler</a> interface that we can use.</p>\n\n<pre><code>func (r *Row) UnmarshalJSON(bs []byte) error {\n    arr := []interface{}{}\n    json.Unmarshal(bs, &amp;arr)\n    // TODO: add error handling here.\n    r.Ooid = arr[0].(string)\n    r.Score = arr[1].(float64)\n    r.Text = arr[2].(string)\n    return nil\n}\n</code></pre>\n\n<p>This uses a similar trick of first using an intermediate slice of <code>interface{}</code>, using the unmarshaler to place values into this generic container, and then plop the values back into our structure.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Row struct {\n    Ooid  string\n    Score float64\n    Text  string\n}\n\nfunc (r *Row) UnmarshalJSON(bs []byte) error {\n    arr := []interface{}{}\n    json.Unmarshal(bs, &amp;arr)\n    // TODO: add error handling here.\n    r.Ooid = arr[0].(string)\n    r.Score = arr[1].(float64)\n    r.Text = arr[2].(string)\n    return nil\n}\n\nfunc main() {\n    rows := []Row{}\n    text := `\n    [\n          [\"ooid4\", 3.1415, \"pi\"],\n          [\"ooid5\", 2.7182, \"euler\"]\n        ]\n    `\n    json.Unmarshal([]byte(text), &amp;rows)\n    fmt.Println(rows)\n}\n</code></pre>\n\n<p>You can read a full example <a href=\"http://play.golang.org/p/-JJ0oP0gq1\" rel=\"noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 6027, "user_id": 205832, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/23c6d359b6f7af3d3f91ca9e17b804b3?s=128&d=identicon&r=PG", "display_name": "Peter Bengtsson", "link": "https://stackoverflow.com/users/205832/peter-bengtsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4382, "favorite_count": 1, "accepted_answer_id": 28015913, "answer_count": 3, "score": 9, "last_activity_date": 1525451604, "creation_date": 1421621613, "last_edit_date": 1525451604, "question_id": 28015753, "link": "https://stackoverflow.com/questions/28015753/serialize-a-mixed-type-json-array-in-go", "title": "Serialize a mixed type JSON array in Go", "body": "<p>I want to return a structure that looks like this:</p>\n\n<pre><code>{\n    results: [\n        [\"ooid1\", 2.0, \"S\u00f6me text\"],\n        [\"ooid2\", 1.3, \"\u00c5ther text\"],\n    ]\n}\n</code></pre>\n\n<p>That's an array of arrags that is string, floating point number, unicode character.</p>\n\n<p>If it was Python I'd be able to:</p>\n\n<pre><code>import json\njson.dumps({'results': [[\"ooid1\", 2.0, u\"S\u00f6me text\"], ...])\n</code></pre>\n\n<p>But in Go you can't have an array (or slice) of mixed types. </p>\n\n<p>I thought of using a struct like this:</p>\n\n<pre><code>type Row struct {\n    Ooid string\n    Score float64\n    Text rune\n}\n</code></pre>\n\n<p>But I don't want each to become a dictionary, I want it to become an array of 3 elements each. </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2514, "user_id": 1091856, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/a5035693d3dc0b20b4cc6a0f4db7444f?s=128&d=identicon&r=PG", "display_name": "user1091856", "link": "https://stackoverflow.com/users/1091856/user1091856"}, "edited": false, "score": 0, "creation_date": 1421615974, "post_id": 28014640, "comment_id": 44417033, "body": "So struct types can inherit methods from another class just like in OOP, with the exception that it only inherits methods, not properties, correct?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 2514, "user_id": 1091856, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/a5035693d3dc0b20b4cc6a0f4db7444f?s=128&d=identicon&r=PG", "display_name": "user1091856", "link": "https://stackoverflow.com/users/1091856/user1091856"}, "edited": false, "score": 0, "creation_date": 1421616520, "post_id": 28014640, "comment_id": 44417227, "body": "@user1091856 inherit is not an ideal term for Go, which insists more on composition. But yes, it enable some kind of inheritance (<a href=\"https://geekwentfreak-raviteja.rhcloud.com/blog/2014/03/06/golang-inheritance-by-embedding/\" rel=\"nofollow noreferrer\">geekwentfreak-raviteja.rhcloud.com/blog/2014/03/06/&hellip;</a>, <a href=\"http://golangtutorials.blogspot.fr/2011/06/inheritance-and-subclassing-in-go-or.html\" rel=\"nofollow noreferrer\">golangtutorials.blogspot.fr/2011/06/&hellip;</a>, <a href=\"http://stackoverflow.com/a/1761393/6309\">stackoverflow.com/a/1761393/6309</a>, <a href=\"http://spf13.com/post/is-go-object-oriented/\" rel=\"nofollow noreferrer\">spf13.com/post/is-go-object-oriented</a>)"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 15, "last_activity_date": 1421613985, "last_edit_date": 1592644375, "creation_date": 1421613985, "answer_id": 28014640, "question_id": 28014591, "link": "https://stackoverflow.com/questions/28014591/nameless-fields-in-go-structs/28014640#28014640", "title": "Nameless fields in Go structs?", "body": "<p>See &quot;<a href=\"http://www.hydrogen18.com/blog/golang-embedding.html\" rel=\"noreferrer\">Embedding in Go </a>&quot;: you embed an <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"noreferrer\">anonymous field in a struct</a>: this is generally used with an embedded struct, not a basic type like <code>string</code>. That type has no &quot;promoted field&quot; to expose.</p>\n<blockquote>\n<p>A field or method <code>f</code> of an anonymous field in a struct <code>x</code> is called <strong>promoted</strong> if <code>x.f</code> is a legal selector that denotes that field or method <code>f</code>.</p>\n<p>Promoted fields act like ordinary fields of a struct except that they cannot be used as field names in composite literals of the struct.</p>\n</blockquote>\n<p>(here <code>string</code> has no field in itself)</p>\n<p>See an example of type embedding in &quot;<a href=\"https://stackoverflow.com/a/27733969/6309\">Embeddding when to use pointer</a>&quot;.</p>\n<blockquote>\n<p>Is it possible to access these fields like you can do with named fields?</p>\n</blockquote>\n<p>A <code>fmt.Println(obj.string)</code> would return <code>Hello World</code> instead of <code>{Hello World}</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 2, "creation_date": 1569528539, "post_id": 58119914, "comment_id": 102636678, "body": "No disrespect indeed, and upvoted. Nice and useful examples."}, {"owner": {"reputation": 555, "user_id": 7168030, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gpgjxsBVshQ/AAAAAAAAAAI/AAAAAAAAACg/IU7EpGdbVak/photo.jpg?sz=128", "display_name": "hashlash", "link": "https://stackoverflow.com/users/7168030/hashlash"}, "edited": false, "score": 0, "creation_date": 1603770938, "post_id": 58119914, "comment_id": 114134949, "body": "Wouldn&#39;t all embedded fields be promoted? I&#39;ve tried to run (<a href=\"https://play.golang.org/p/zB3Qgkhl84D\" rel=\"nofollow noreferrer\">play.golang.org/p/zB3Qgkhl84D</a>) an example from <a href=\"https://medium.com/golangspec/promoted-fields-and-methods-in-go-4e8d7aefb3e3\" rel=\"nofollow noreferrer\">medium.com/golangspec/&hellip;</a> and the second embedded field is also promoted"}, {"owner": {"reputation": 182, "user_id": 9057530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e3a56474c76a954f849caa0b46e55bd?s=128&d=identicon&r=PG", "display_name": "yyFred", "link": "https://stackoverflow.com/users/9057530/yyfred"}, "reply_to_user": {"reputation": 555, "user_id": 7168030, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gpgjxsBVshQ/AAAAAAAAAAI/AAAAAAAAACg/IU7EpGdbVak/photo.jpg?sz=128", "display_name": "hashlash", "link": "https://stackoverflow.com/users/7168030/hashlash"}, "edited": false, "score": 0, "creation_date": 1608866775, "post_id": 58119914, "comment_id": 115704170, "body": "@hashlash yes, they are"}], "tags": [], "owner": {"reputation": 21540, "user_id": 3029, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/f74253f4a099258870157426b4cdb2dc?s=128&d=identicon&r=PG", "display_name": "davetron5000", "link": "https://stackoverflow.com/users/3029/davetron5000"}, "is_accepted": false, "score": 51, "last_activity_date": 1569510945, "creation_date": 1569510945, "answer_id": 58119914, "question_id": 28014591, "link": "https://stackoverflow.com/questions/28014591/nameless-fields-in-go-structs/58119914#58119914", "title": "Nameless fields in Go structs?", "body": "<p>No disrespect to the chosen answer, but it did not clarify the concept for me.</p>\n\n<p>There are two things going on.  First is anonymous fields.  Second is the \"promoted\" field.</p>\n\n<p>For anonymous fields, the field name you can use is the name of the type.  The first anonymous field is \"promoted\", which means any field you access on the struct \"passes through\" to the promoted anonymous field.  This shows both concepts:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\ntype Widget struct {\n    name string\n}\n\ntype WrappedWidget struct {\n    Widget       // this is the promoted field\n    time.Time    // this is another anonymous field that has a runtime name of Time\n    price int64  // normal field\n}\n\nfunc main() {\n    widget := Widget{\"my widget\"}\n    wrappedWidget := WrappedWidget{widget, time.Now(), 1234}\n\n    fmt.Printf(\"Widget named %s, created at %s, has price %d\\n\",\n        wrappedWidget.name, // name is passed on to the wrapped Widget since it's\n                            // the promoted field\n        wrappedWidget.Time, // We access the anonymous time.Time as Time\n        wrappedWidget.price)\n\n    fmt.Printf(\"Widget named %s, created at %s, has price %d\\n\",\n        wrappedWidget.Widget.name, // We can also access the Widget directly\n                                   // via Widget\n        wrappedWidget.Time,\n        wrappedWidget.price)\n}\n</code></pre>\n\n<p>Output is:</p>\n\n<pre><code>Widget named my widget, created at 2009-11-10 23:00:00 +0000 UTC m=+0.000000001, has price 1234\nWidget named my widget, created at 2009-11-10 23:00:00 +0000 UTC m=+0.000000001, has price 1234```\n</code></pre>\n"}], "owner": {"reputation": 2514, "user_id": 1091856, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/a5035693d3dc0b20b4cc6a0f4db7444f?s=128&d=identicon&r=PG", "display_name": "user1091856", "link": "https://stackoverflow.com/users/1091856/user1091856"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10626, "favorite_count": 5, "accepted_answer_id": 28014640, "answer_count": 2, "score": 26, "last_activity_date": 1569510945, "creation_date": 1421613614, "question_id": 28014591, "link": "https://stackoverflow.com/questions/28014591/nameless-fields-in-go-structs", "title": "Nameless fields in Go structs?", "body": "<pre><code>package main\n\nimport \"fmt\"\n\ntype myType struct {\n    string\n}\n\nfunc main() {\n    obj := myType{\"Hello World\"}\n\n    fmt.Println(obj)\n}\n</code></pre>\n\n<p>What is the purpose of nameless fields in structs?</p>\n\n<p>Is it possible to access these fields like you can do with named fields?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 9, "last_activity_date": 1421612764, "last_edit_date": 1495535058, "creation_date": 1421611599, "answer_id": 28014264, "question_id": 28014168, "link": "https://stackoverflow.com/questions/28014168/in-go-what-does-channel-assgiment-mean/28014264#28014264", "title": "in Go, what does channel assgiment mean?", "body": "<p>A channel is a reference type. See \"<a href=\"https://stackoverflow.com/a/16590291/6309\">Are channels passed by reference implicitly</a>\".<br>\n(reference types: slices, maps, channels, pointers, functions)<br>\nAnd see \"<a href=\"https://stackoverflow.com/a/11898286/6309\">Go - Pointer to map</a>\".</p>\n\n<p><code>ch = ch1</code> simply copy the reference value of <code>ch1</code> to <code>ch</code>.</p>\n"}], "owner": {"reputation": 6557, "user_id": 2495795, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/13606de0b736d7191e2cf2bfea1d4fda?s=128&d=identicon&r=PG", "display_name": "BufBills", "link": "https://stackoverflow.com/users/2495795/bufbills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 832, "favorite_count": 1, "accepted_answer_id": 28014264, "answer_count": 1, "score": 3, "last_activity_date": 1421612764, "creation_date": 1421611070, "question_id": 28014168, "link": "https://stackoverflow.com/questions/28014168/in-go-what-does-channel-assgiment-mean", "title": "in Go, what does channel assgiment mean?", "body": "<p>i have this code,</p>\n\n<pre><code>// The prime sieve: Daisy-chain Filter processes.\nfunc main() {\n    ch := make(chan int) // Create a new channel.\n    go Generate(ch)      // Launch Generate goroutine.\n    for i := 0; i &lt; 10; i++ {\n        prime := &lt;-ch\n        print(prime, \"\\n\")\n        ch1 := make(chan int)\n        go Filter(ch, ch1, prime)\n        ch = ch1\n    }\n}\n</code></pre>\n\n<p>I am trying to understand what does channel assignment mean. For example ch=ch1,\nwhat does this do? Deep copy or shallow copy?\nwhat does go guarantee for this?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["mysql", "json", "go"], "comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1421610852, "post_id": 28014078, "comment_id": 44415419, "body": "You say that it seems very inefficient.  Is it, in fact, actally inefficient in a way that negatively impacts the application?"}, {"owner": {"reputation": 3900, "user_id": 522962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c77cd63cb8f567c1ffefca8e78f2c605?s=128&d=identicon&r=PG&f=1", "display_name": "user_78361084", "link": "https://stackoverflow.com/users/522962/user-78361084"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 1, "creation_date": 1421610981, "post_id": 28014078, "comment_id": 44415463, "body": "@RobertHarvey it negatively impacts my productivity."}, {"owner": {"reputation": 3900, "user_id": 522962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c77cd63cb8f567c1ffefca8e78f2c605?s=128&d=identicon&r=PG&f=1", "display_name": "user_78361084", "link": "https://stackoverflow.com/users/522962/user-78361084"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1421611043, "post_id": 28014078, "comment_id": 44415481, "body": "@RobertHarvey: reworded the question...it isn&#39;t an application thing is a programmer&#39;s productivity thing"}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1421611059, "post_id": 28014078, "comment_id": 44415489, "body": "There are almost certainly better ways to do this.   I would see if Go has ORM and data mapping libraries."}, {"owner": {"reputation": 3900, "user_id": 522962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c77cd63cb8f567c1ffefca8e78f2c605?s=128&d=identicon&r=PG&f=1", "display_name": "user_78361084", "link": "https://stackoverflow.com/users/522962/user-78361084"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1421612984, "post_id": 28014078, "comment_id": 44416105, "body": "Using Gorp. I map to byte slice to better handle the null values. The issue is then finding a better way to convert the byte slice values to json"}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 1, "creation_date": 1421616285, "post_id": 28014078, "comment_id": 44417140, "body": "Why aren&#39;t you using <code>NullString</code>? This is no different to nullable constructs in other languages."}, {"owner": {"reputation": 3900, "user_id": 522962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c77cd63cb8f567c1ffefca8e78f2c605?s=128&d=identicon&r=PG&f=1", "display_name": "user_78361084", "link": "https://stackoverflow.com/users/522962/user-78361084"}, "reply_to_user": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1421621856, "post_id": 28014078, "comment_id": 44418746, "body": "@SimonWhitehead: Because then you&#39;d have to do something far more uglier than what I have to marshall a NullString type to json: <a href=\"http://dennissuratna.com/marshalling-nullable-string-db-value-to-json-in-go/....unless\" rel=\"nofollow noreferrer\">dennissuratna.com/&hellip;</a> I am missing an easier way ;)"}], "answers": [{"comments": [{"owner": {"reputation": 12745, "user_id": 1663023, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fc43a735e2c498f450a9908a5bd9ebf4?s=128&d=identicon&r=PG", "display_name": "Qian Chen", "link": "https://stackoverflow.com/users/1663023/qian-chen"}, "edited": false, "score": 1, "creation_date": 1431155149, "post_id": 28035152, "comment_id": 48383486, "body": "I&#39;m the author of this library. Now I have made some update. <code>theCase</code> can be original, <code>lower</code>, <code>upper</code> and <code>camel</code>. The returned array now separated the headers and data to make the data processing easier. Thanks @Nery Jr for the recommendation. I wish <code>gosqljson</code> is helpful to your projects. Here is a link you might find helpful: <a href=\"http://srcode.org/2014/08/19/sql-to-json-in-golang/\" rel=\"nofollow noreferrer\">srcode.org/2014/08/19/sql-to-json-in-golang</a>"}], "tags": [], "owner": {"reputation": 3411, "user_id": 848937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77e5e010bf91a33530b2eaeaaf3db5fc?s=128&d=identicon&r=PG", "display_name": "Nery Jr", "link": "https://stackoverflow.com/users/848937/nery-jr"}, "is_accepted": true, "score": 5, "last_activity_date": 1421709238, "creation_date": 1421709238, "answer_id": 28035152, "question_id": 28014078, "link": "https://stackoverflow.com/questions/28014078/is-there-a-better-way-to-marshal-sql-rows/28035152#28035152", "title": "Is there a better way to marshal sql rows?", "body": "<p>Have you tried <a href=\"https://github.com/elgs/gosqljson\" rel=\"noreferrer\">gosqljson</a> in <a href=\"https://github.com/elgs/gosqljson\" rel=\"noreferrer\">https://github.com/elgs/gosqljson</a> ?</p>\n\n<p>See example:</p>\n\n<p>```golang</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"fmt\"\n    \"github.com/elgs/gosqljson\"\n    _ \"github.com/go-sql-driver/mysql\"\n)\n\nfunc main() {\n    ds := \"username:password@tcp(host:3306)/db\"\n    db, err := sql.Open(\"mysql\", ds)\n    defer db.Close()\n\n    if err != nil {\n        fmt.Println(\"sql.Open:\", err)\n    }\n\n    theCase := \"lower\" // \"lower\" default, \"upper\", camel\n\n    a, _ := gosqljson.QueryDbToArrayJson(db, theCase, \"SELECT ID,NAME FROM t LIMIT ?,?\", 0, 3)\n    fmt.Println(a)\n    // [[\"id\",\"name\"],[\"0\",\"Alicia\"],[\"1\",\"Brian\"],[\"2\",\"Chloe\"]]\n\n    m, _ := gosqljson.QueryDbToMapJson(db, theCase, \"SELECT ID,NAME FROM t LIMIT ?,?\", 0, 3)\n    fmt.Println(m)\n    // [{\"id\":\"0\",\"name\":\"Alicia\"},{\"id\":\"1\",\"name\":\"Brian\"},{\"id\":\"2\",\"name\":\"Chloe\"}]\n\n}\n</code></pre>\n\n<p>````</p>\n"}], "owner": {"reputation": 3900, "user_id": 522962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c77cd63cb8f567c1ffefca8e78f2c605?s=128&d=identicon&r=PG&f=1", "display_name": "user_78361084", "link": "https://stackoverflow.com/users/522962/user-78361084"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1496, "favorite_count": 1, "accepted_answer_id": 28035152, "answer_count": 1, "score": 1, "last_activity_date": 1440914120, "creation_date": 1421610597, "last_edit_date": 1421611018, "question_id": 28014078, "link": "https://stackoverflow.com/questions/28014078/is-there-a-better-way-to-marshal-sql-rows", "title": "Is there a better way to marshal sql rows?", "body": "<p>I have the following struct:</p>\n\n<pre><code>type MyTable struct{\n  DBColA []byte `db:\"cola\" json:\"-\"`\n  ColA string `json:\"cola\"`\n  DBColB []byte `db:\"colb\" json:\"-\"`\n  ColB string `json:\"colb\"`\n}\n</code></pre>\n\n<p>I map to []byte [to better handle null values in my sql][1]</p>\n\n<p>When I grab the rows I need to output it as json. In order to do that I convert []byte to string:</p>\n\n<pre><code>var rows []*MyTable\nif _, err := Session.Select(&amp;rows, sql, args...); err != nil {\n    log.Println(err)\n}\nfor _, row := range rows{\n   row.ColA = string(row.DBColA)\n   row.ColB = string(row.DBColB)\n}\nw.Header().Set(\"Content-Type\", \"application/json\")\nif err := json.NewEncoder(w).Encode(rows); err != nil {\n  http.Error(w, err.Error(), http.StatusInternalServerError)\n}\n</code></pre>\n\n<p>It seems very inefficient to have DBColA and ColA in my struct and then converting DBColA to a string....I have a lot of columns. Is there a better way?</p>\n\n<pre><code>  [1]: https://github.com/go-sql-driver/mysql/wiki/Examples\n</code></pre>\n"}, {"tags": ["debugging", "concurrency", "go", "gdb", "channel"], "answers": [{"comments": [{"owner": {"reputation": 2072, "user_id": 1195266, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/6c5Fj.jpg?s=128&g=1", "display_name": "Macilias", "link": "https://stackoverflow.com/users/1195266/macilias"}, "edited": false, "score": 1, "creation_date": 1548258551, "post_id": 28014222, "comment_id": 95479811, "body": "Some more Information would be useful here, I don&#180;t understand the solution nor can see how to integrate it in IDE debugger like GoLand which uses the debugger from OS X Development Tools."}], "tags": [], "owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "is_accepted": true, "score": 1, "last_activity_date": 1421611337, "creation_date": 1421611337, "answer_id": 28014222, "question_id": 28013949, "link": "https://stackoverflow.com/questions/28013949/how-to-use-gdb-debug-golang-code-to-see-whats-inside-channel/28014222#28014222", "title": "how to use gdb debug golang code to see what&#39;s inside channel?", "body": "<p>You just have to dereference ch. With a very small program:</p>\n\n<pre><code>package main\n\nfunc main() {\n    ch := make(chan int, 10)\n    ch &lt;- 1\n    ch &lt;- 2\n    ch &lt;- 4\n    &lt;-ch\n}\n</code></pre>\n\n<p>Debugging:</p>\n\n<pre><code>(gdb) p *ch\n$1 = struct hchan&lt;int&gt; = {1, 2, 4}\n</code></pre>\n"}], "owner": {"reputation": 6557, "user_id": 2495795, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/13606de0b736d7191e2cf2bfea1d4fda?s=128&d=identicon&r=PG", "display_name": "BufBills", "link": "https://stackoverflow.com/users/2495795/bufbills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 724, "favorite_count": 1, "accepted_answer_id": 28014222, "answer_count": 1, "score": 3, "last_activity_date": 1421611337, "creation_date": 1421609913, "question_id": 28013949, "link": "https://stackoverflow.com/questions/28013949/how-to-use-gdb-debug-golang-code-to-see-whats-inside-channel", "title": "how to use gdb debug golang code to see what&#39;s inside channel?", "body": "<p>i have this code for example</p>\n\n<p><a href=\"http://play.golang.org/p/9U22NfrXeq\" rel=\"nofollow\">http://play.golang.org/p/9U22NfrXeq</a></p>\n\n<pre><code>// A concurrent prime sieve\n\npackage main\n\n// Send the sequence 2, 3, 4, ... to channel 'ch'.\nfunc Generate(ch chan&lt;- int) {\n    for i := 2; ; i++ {\n        ch &lt;- i // Send 'i' to channel 'ch'.\n    }\n}\n\n// Copy the values from channel 'in' to channel 'out',\n// removing those divisible by 'prime'.\nfunc Filter(in &lt;-chan int, out chan&lt;- int, prime int) {\n    for {\n        i := &lt;-in // Receive value from 'in'.\n        if i%prime != 0 {\n            out &lt;- i // Send 'i' to 'out'.\n        }\n    }\n}\n\n// The prime sieve: Daisy-chain Filter processes.\nfunc main() {\n    ch := make(chan int) // Create a new channel.\n    go Generate(ch)      // Launch Generate goroutine.\n    for i := 0; i &lt; 10; i++ {\n        prime := &lt;-ch\n        print(prime, \"\\n\")\n        ch1 := make(chan int)\n        go Filter(ch, ch1, prime)\n        ch = ch1\n    }\n}\n</code></pre>\n\n<p>How to see what's inside channel?\nFor example I want to debug this line:      </p>\n\n<pre><code>prime := &lt;-ch\n</code></pre>\n\n<p>By typing 'p ch' in gdb only prints address of the channel. How can I get contents?</p>\n"}, {"tags": ["json", "parsing", "url", "go"], "comments": [{"owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 1, "creation_date": 1421626331, "post_id": 28012993, "comment_id": 44419918, "body": "Instead of trying to directly access the map from key to values diirectly, you probably mean to use <code>Request.FormValue</code> instead.  <a href=\"http://golang.org/pkg/net/http/#Request.FormValue\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/#Request.FormValue</a>"}], "answers": [{"comments": [{"owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 1, "creation_date": 1421626596, "post_id": 28013076, "comment_id": 44419972, "body": "The example &quot;string&quot; the question presents isn&#39;t even a string, technically.  By using <code>r.URL.Query()</code>, they have a value of type <code>map[string][]string</code> (<a href=\"http://golang.org/pkg/net/url/#Values\" rel=\"nofollow noreferrer\">golang.org/pkg/net/url/#Values</a>).  So what the question is presenting isn&#39;t technically accurate: they&#39;re should be getting back a list with a single string.  They probably did a simple <code>fmt.Println(filters)</code> on the value, rather than an output statement that presents more literal output, such as <code>fmt.Printf(&quot;%#v\\n&quot;, filters)</code>."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 3, "last_activity_date": 1421630478, "last_edit_date": 1421630478, "creation_date": 1421604695, "answer_id": 28013076, "question_id": 28012993, "link": "https://stackoverflow.com/questions/28012993/how-do-i-parse-a-json-string-in-golang/28013076#28013076", "title": "How do I parse a JSON string in Golang?", "body": "<p>Use the <a href=\"http://godoc.org/encoding/json\" rel=\"nofollow\">encoding/json</a> package to parse JSON. The query string in the example URL does not contain valid JSON.</p>\n\n<p>Here's an example show how to use the JSON parser on a slightly different URL.</p>\n\n<pre><code>s := `http://127.0.0.1:3001/find?field=hostname&amp;field=App&amp;filters={\"hostname\":\"example.com\",\"type\":\"vm\"}`\nu, err := url.Parse(s)\nif err != nil {\n    log.Fatal(err)\n}\nvar v map[string]string\nerr = json.Unmarshal([]byte(u.Query().Get(\"filters\")), &amp;v)\nif err != nil {\n    log.Fatal(err)\n}\nfmt.Println(v)\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/wJM1d1js6a\" rel=\"nofollow\">playground example</a></p>\n"}], "owner": {"reputation": 2011, "user_id": 2321866, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d489a0664421bdb84a1e0f559360d841?s=128&d=identicon&r=PG", "display_name": "Kasinath Kottukkal", "link": "https://stackoverflow.com/users/2321866/kasinath-kottukkal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1812, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1421630478, "creation_date": 1421604193, "question_id": 28012993, "link": "https://stackoverflow.com/questions/28012993/how-do-i-parse-a-json-string-in-golang", "title": "How do I parse a JSON string in Golang?", "body": "<p>Given a URL like the following.</p>\n\n<pre><code>http://127.0.0.1:3001/find?field=hostname&amp;field=App&amp;filters=[\"hostname\":\"example.com,\"type\":\"vm\"]\n</code></pre>\n\n<p>How do I extract JSON values corresponding to keys for eg: hostname 'example.com' and type 'vm'.</p>\n\n<p>I am trying </p>\n\n<pre><code>filters := r.URL.Query()[\"filters\"]\n</code></pre>\n\n<p>which gives following output:</p>\n\n<pre><code>[[\"hostname\":\"example.com,\"type\":\"vm\"]]\n</code></pre>\n"}, {"tags": ["struct", "go", "binaryfiles"], "comments": [{"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 0, "creation_date": 1421604118, "post_id": 28012952, "comment_id": 44413070, "body": "This needs dependent typing, which Go doesn&#39;t support. You should instead read the fields separately and construct the value of the struct type manually, rather than attempting to read into the struct directly."}, {"owner": {"reputation": 937, "user_id": 2213012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gnyr5.jpg?s=128&g=1", "display_name": "FloF", "link": "https://stackoverflow.com/users/2213012/flof"}, "reply_to_user": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 0, "creation_date": 1421692550, "post_id": 28012952, "comment_id": 44447353, "body": "Can someone please explain the downvote? Would be good to know what&#39;s wrong to avoid that in the future"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1428795031, "post_id": 28012952, "comment_id": 47316705, "body": "@FloF, perhaps it was &quot;This question does not show any research effort;&quot; I would hope that it is expected that questioners have <a href=\"http://stackoverflow.com/tags/go/info\">read the basic documentation/spec/resources</a>. If you had, you&#39;d know Go has slices and arrays and why <code>[rec_len]byte</code> makes no sense without having to ask others to interpret the spec for you."}], "answers": [{"comments": [{"owner": {"reputation": 937, "user_id": 2213012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gnyr5.jpg?s=128&g=1", "display_name": "FloF", "link": "https://stackoverflow.com/users/2213012/flof"}, "edited": false, "score": 3, "creation_date": 1421689973, "post_id": 28013777, "comment_id": 44446150, "body": "That&#39;s basically the way I&#39;ve solved it. I was just hoping for a more &quot;elegant&quot; way ;)"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1421608821, "creation_date": 1421608821, "answer_id": 28013777, "question_id": 28012952, "link": "https://stackoverflow.com/questions/28012952/golang-variable-length-array-in-struct-for-use-with-binary-read/28013777#28013777", "title": "GoLang: Variable length array in struct for use with binary read", "body": "<p>You can read the record as follows:</p>\n\n<pre><code>var rec Record\n\n// Slurp up the fixed sized header.\n\nvar buf [4]byte\n_, err := io.ReadFull(r, buf[:])\nif err != nil {\n    // handle error\n}\nrec.rec_len = binary.BigEndian.Uint16(buf[0:2])\nrec.rec_type = buf[2]\nrec.rec_sub = buf[3]\n\n// Create the variable part and read it.\n\nrec.data = make([]byte, rec.rec_len)\n_, err = io.ReadFull(r, rec.data)\nif err != nil {\n    // handle error\n}\n</code></pre>\n"}], "owner": {"reputation": 937, "user_id": 2213012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gnyr5.jpg?s=128&g=1", "display_name": "FloF", "link": "https://stackoverflow.com/users/2213012/flof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3076, "favorite_count": 2, "accepted_answer_id": 28013777, "answer_count": 1, "score": 3, "last_activity_date": 1421608821, "creation_date": 1421603988, "question_id": 28012952, "link": "https://stackoverflow.com/questions/28012952/golang-variable-length-array-in-struct-for-use-with-binary-read", "title": "GoLang: Variable length array in struct for use with binary read", "body": "<p><br>\nI'm trying to reimplement a program it did in C a few years ago in Go<br>\nThe program should read a \"record\"-like structured binary file and do something with the record (what is done with the records itself is not relevant for this question)<br><br>\nSuch a datafile consists of many records where each record has the following definition:<br></p>\n\n<pre><code>REC_LEN   U2 // length of record after header\nREC_TYPE  U1 //a type\nREC_SUB   U1 //a subtype\nREC_LEN x U1 //\"payload\" \n</code></pre>\n\n<p>My problem now is how to specify that variable length byte[] in a struct in Go?<br>\nMy plan was to use binary.Read to read the records<br>\nHere's what I've tried so far in Go:</p>\n\n<pre><code>type Record struct {\n    rec_len uint16\n    rec_type uint8\n    rec_sub uint8\n    data [rec_len]byte\n}\n</code></pre>\n\n<p>Unfortunatelly it seems I can't reference a field of a struct within the same struct as I get the following error:<br></p>\n\n<pre><code>xxxx.go:15: undefined: rec_len\nxxxx.go:15: invalid array bound rec_len\n</code></pre>\n\n<p>I'd appreciate any ideas pointing me in the right direction<br>\nThanks<br>\nKR</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1421602482, "post_id": 28012336, "comment_id": 44412565, "body": "Nice explanation, but I think T.Set is expression and t.Set is value. Typo I think?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1421602741, "post_id": 28012336, "comment_id": 44412642, "body": "@Uvelichitel yup, fixed now."}, {"owner": {"reputation": 1011, "user_id": 1881641, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d8c2466a4bf038dc5617545698a97d5f?s=128&d=identicon&r=PG", "display_name": "what is what", "link": "https://stackoverflow.com/users/1881641/what-is-what"}, "edited": false, "score": 0, "creation_date": 1421606429, "post_id": 28012336, "comment_id": 44413861, "body": "Really helpful ! Solve the  problem confused me all day long Thanks@3fo3"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1421602679, "last_edit_date": 1421602679, "creation_date": 1421600341, "answer_id": 28012336, "question_id": 28012287, "link": "https://stackoverflow.com/questions/28012287/go-type-method-not-equal-to-instance-method/28012336#28012336", "title": "Go type method not equal to instance method", "body": "<p>t.Set is a <a href=\"https://golang.org/ref/spec#Method_values\" rel=\"nofollow\">method value</a>. T.Set is a <a href=\"https://golang.org/ref/spec#Method_expressions\" rel=\"nofollow\">method expression</a>.</p>\n\n<p>The method value <code>t.Set</code> yields a function equivalent to:</p>\n\n<pre><code>func(a int) ( t.Set(a) }\n</code></pre>\n\n<p>The method expression <code>T.Set</code> yields a function that is equivalent to the method with the receiver as the first argument.</p>\n\n<pre><code>func(t T, a int) { t.Set(a) }\n</code></pre>\n\n<p>This <a href=\"http://play.golang.org/p/UE6GyVdCeI\" rel=\"nofollow\">playground example</a> illustrates the difference between the method value and method expression.</p>\n\n<p>Separate from this discussion about method expressions and method values, \nthe function Set should take a pointer receiver. Otherwise, the change to t is discarded. </p>\n\n<pre><code>func (t *T) Set(a int) {\n   t.Tp = a\n}\n</code></pre>\n\n<p>Here's the <a href=\"http://play.golang.org/p/c74S5b9vIz\" rel=\"nofollow\">example</a> with the pointer receiver.</p>\n"}], "owner": {"reputation": 1011, "user_id": 1881641, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d8c2466a4bf038dc5617545698a97d5f?s=128&d=identicon&r=PG", "display_name": "what is what", "link": "https://stackoverflow.com/users/1881641/what-is-what"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 28012336, "answer_count": 1, "score": 0, "last_activity_date": 1421602679, "creation_date": 1421600084, "last_edit_date": 1421602509, "question_id": 28012287, "link": "https://stackoverflow.com/questions/28012287/go-type-method-not-equal-to-instance-method", "title": "Go type method not equal to instance method", "body": "<pre><code>type T struct {\n    Tp int\n}\n\nfunc (t T) Set(a int) {\n\n    t.Tp = a\n}\nfunc main() {\n    t := T{}\n    fmt.Println(reflect.TypeOf(t.Set))\n    fmt.Println(reflect.TypeOf(T.Set))\n}\n\nresult :\nfunc(int)\nfunc(main.T, int)\n</code></pre>\n\n<p>why T.set is not equal to t.set?<br>\nwhat is principle or translation  bebind this?</p>\n\n<p><a href=\"http://play.golang.org/p/xYnWZ3PlyF\" rel=\"nofollow\">http://play.golang.org/p/xYnWZ3PlyF</a></p>\n"}, {"tags": ["json", "go", "websocket"], "answers": [{"comments": [{"owner": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "edited": false, "score": 0, "creation_date": 1421600768, "post_id": 28012223, "comment_id": 44411995, "body": "I took your suggestion. Thanks a lot!"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1421600079, "last_edit_date": 1421600079, "creation_date": 1421599675, "answer_id": 28012223, "question_id": 28012123, "link": "https://stackoverflow.com/questions/28012123/golang-json-unmarshal-returns-invalid-memory-address-or-nil-pointer-derefere/28012223#28012223", "title": "golang: json.Unmarshal() returns &quot;invalid memory address or nil pointer dereference&quot;", "body": "<p>This line will panic if there's no error decoding the JSON:</p>\n\n<pre><code>fmt.Printf(\"Received command: %v (Error: %s)\\n\", command, err.Error())\n</code></pre>\n\n<p>If err == nil, then err.Error() panics with nil pointer derference. Change the line to:</p>\n\n<pre><code>fmt.Printf(\"Received command: %v (Error: %v)\\n\", command, err)\n</code></pre>\n\n<p>If you are reading a socket, then there's no guarantee that s.Read() will read a complete JSON value. A better way to write this function is:</p>\n\n<pre><code>func translateMessages(s socket) {\n  d := json.NewDecoder(s)\n  for {\n      fmt.Printf(\"Waiting for a message ... \\n\")\n      var command map[string]interface{}\n      err := d.Decode(&amp;command)\n      fmt.Printf(\"Received command: %v (Error: %v)\\n\", command, err)\n      if err != nil {\n        return\n      }\n  }\n}\n</code></pre>\n\n<p>If you are working with websockets, then you should use the gorilla/webscoket package and <a href=\"http://godoc.org/github.com/gorilla/websocket#Conn.ReadJSON\" rel=\"nofollow\">ReadJSON</a> to decode JSON values. </p>\n"}], "owner": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2062, "favorite_count": 0, "accepted_answer_id": 28012223, "answer_count": 1, "score": 0, "last_activity_date": 1421600079, "creation_date": 1421598988, "question_id": 28012123, "link": "https://stackoverflow.com/questions/28012123/golang-json-unmarshal-returns-invalid-memory-address-or-nil-pointer-derefere", "title": "golang: json.Unmarshal() returns &quot;invalid memory address or nil pointer dereference&quot;", "body": "<p>I get a json message from a websocket an the json string is received ok. Then I call json.Unmarshal an get a runtime panic. I looked through the other examples, but this seems to be something else. Here is the code:</p>\n\n<pre><code>func translateMessages(s socket) {\n    message := make([]byte,4096)\n    for {\n        fmt.Printf(\"Waiting for a message ... \\n\")\n        if n, err := s.Read(message); err == nil {\n            command := map[string]interface{}{}\n            fmt.Printf(\"Received message: %v (%d Bytes)\\n\", string(message[:n]), n)\n            err := json.Unmarshal(message[:n],&amp;command)\n            fmt.Printf(\"Received command: %v (Error: %s)\\n\", command, err.Error())\n        }\n    }\n}\n</code></pre>\n\n<p>And this is the output:</p>\n\n<pre><code>Waiting for a message ... \nReceived message: {\"gruss\":\"Hello World!\"} (24 Bytes)\npanic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xb code=0x1 addr=0x20 pc=0x401938]\n\ngoroutine 25 [running]:\nruntime.panic(0x6f4860, 0x8ec333)\n</code></pre>\n\n<p>Any hint what that could be?</p>\n"}, {"tags": ["parsing", "go"], "answers": [{"comments": [{"owner": {"reputation": 2011, "user_id": 2321866, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d489a0664421bdb84a1e0f559360d841?s=128&d=identicon&r=PG", "display_name": "Kasinath Kottukkal", "link": "https://stackoverflow.com/users/2321866/kasinath-kottukkal"}, "edited": false, "score": 0, "creation_date": 1421600613, "post_id": 28012338, "comment_id": 44411959, "body": "Actually previous answer was exactly what I wanted. That solved my issue. I think you misread my question. I will take blame for not clearly expressing as well."}, {"owner": {"reputation": 14380, "user_id": 31818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3487ce6ed9ec277bac79a838537b46a8?s=128&d=identicon&r=PG", "display_name": "seh", "link": "https://stackoverflow.com/users/31818/seh"}, "reply_to_user": {"reputation": 2011, "user_id": 2321866, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d489a0664421bdb84a1e0f559360d841?s=128&d=identicon&r=PG", "display_name": "Kasinath Kottukkal", "link": "https://stackoverflow.com/users/2321866/kasinath-kottukkal"}, "edited": false, "score": 0, "creation_date": 1421600817, "post_id": 28012338, "comment_id": 44412009, "body": "I&#39;m happy you figured it out, but your original question was puzzling over how to separate the &quot;fields&quot; values. I assumed that the URL format was not open for discussion. If you can take @Uvelichitel&#39;s advice and change the URL format, so much the better. While we&#39;re here, be forewarned that you can still wind up with duplicate &quot;fields&quot; values, so you may wish to collect them into a set structure to help eliminate duplicates\u2014if that&#39;s what your application needs."}], "tags": [], "owner": {"reputation": 14380, "user_id": 31818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3487ce6ed9ec277bac79a838537b46a8?s=128&d=identicon&r=PG", "display_name": "seh", "link": "https://stackoverflow.com/users/31818/seh"}, "is_accepted": false, "score": 1, "last_activity_date": 1421600342, "creation_date": 1421600342, "answer_id": 28012338, "question_id": 28012042, "link": "https://stackoverflow.com/questions/28012042/how-do-i-parse-a-delimited-string-into-a-slice-of-substrings/28012338#28012338", "title": "How do I parse a delimited string into a slice of substrings?", "body": "<p>The question actually concerns how to split a string on a particular delimiter. For that, you can use <a href=\"http://golang.org/pkg/strings/#Split\" rel=\"nofollow\">the <code>strings.Split()</code> function</a>:</p>\n\n<pre><code>import \"strings\"\n// ...\nfilters := strings.Split(r.URL.Query().Get(\"fields\"), \",\")\n</code></pre>\n\n<p>Your <code>filters</code> variable will now be a slice, which may be empty if there was no \"fields\" query parameter available.</p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 1, "last_activity_date": 1421600529, "creation_date": 1421600529, "answer_id": 28012363, "question_id": 28012042, "link": "https://stackoverflow.com/questions/28012042/how-do-i-parse-a-delimited-string-into-a-slice-of-substrings/28012363#28012363", "title": "How do I parse a delimited string into a slice of substrings?", "body": "<p>I think your URL should be</p>\n\n<pre><code>http://127.0.0.1:3001/find?fields=hostname&amp;fields=App&amp;fields=Node_type&amp;fields=invalid\n</code></pre>\n\n<p>or if you don't like that, you can parse</p>\n\n<pre><code>filterSlice:=strings.Split(\"filters\", \",\")\n</code></pre>\n"}], "owner": {"reputation": 2011, "user_id": 2321866, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d489a0664421bdb84a1e0f559360d841?s=128&d=identicon&r=PG", "display_name": "Kasinath Kottukkal", "link": "https://stackoverflow.com/users/2321866/kasinath-kottukkal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 28012363, "answer_count": 2, "score": -2, "last_activity_date": 1421600529, "creation_date": 1421598574, "last_edit_date": 1421600455, "question_id": 28012042, "link": "https://stackoverflow.com/questions/28012042/how-do-i-parse-a-delimited-string-into-a-slice-of-substrings", "title": "How do I parse a delimited string into a slice of substrings?", "body": "<p>Given a URL like the following:</p>\n\n<pre><code>http://127.0.0.1:3001/find?fields=hostname,App,Node_type,invalid\n</code></pre>\n\n<p>I extract fields into a slice like this:</p>\n\n<pre><code>filters := r.URL.Query().Get(\"fields\")\nfmt.Println(filters)\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>hostname,App,Node_type,invalid\n</code></pre>\n\n<p>It is received as a string, but I'd prefer to separate the substrings into a sequence.</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1421595677, "post_id": 28011205, "comment_id": 44410353, "body": "If you use openid to login with a federated service, then the email may not be associated with a Google Account."}, {"owner": {"reputation": 1018, "user_id": 965354, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/764c96f636ebac5b2f1179159e2e85f6?s=128&d=identicon&r=PG", "display_name": "Simple99", "link": "https://stackoverflow.com/users/965354/simple99"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1421599186, "post_id": 28011205, "comment_id": 44411493, "body": "Thanks @3of3. So I assume that if I use the default GAE authentication option where you must have a google account the User would always have an ID. Do you agree?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1421599465, "post_id": 28011205, "comment_id": 44411605, "body": "That is my understanding. I use email instead of id in my app, so I am not 100% sure."}, {"owner": {"reputation": 1018, "user_id": 965354, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/764c96f636ebac5b2f1179159e2e85f6?s=128&d=identicon&r=PG", "display_name": "Simple99", "link": "https://stackoverflow.com/users/965354/simple99"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1421599716, "post_id": 28011205, "comment_id": 44411696, "body": "Cool.  Thanks for your help @3of3"}], "answers": [{"tags": [], "owner": {"reputation": 336, "user_id": 163668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/655035a55b549d3abfb34e962a59985d?s=128&d=identicon&r=PG", "display_name": "Alexei Andreev", "link": "https://stackoverflow.com/users/163668/alexei-andreev"}, "is_accepted": false, "score": 0, "last_activity_date": 1427591011, "last_edit_date": 1495542495, "creation_date": 1427591011, "answer_id": 29324499, "question_id": 28011205, "link": "https://stackoverflow.com/questions/28011205/in-gae-when-might-a-user-not-have-an-id/29324499#29324499", "title": "In GAE, when might a User not have an ID", "body": "<p>There are several key differences between email and id. E.g. \"The app can also access a user ID that identifies the user uniquely, even if the user changes the email address for her account.\" Also \"Every user has the same user ID for all App Engine applications.\"</p>\n\n<p>Like <a href=\"https://stackoverflow.com/users/4130971/thundercat\">ThunderCat</a> said, if you use a Federated Login (OpenID was the only one supported, but is no longer), then you will not get a user id.</p>\n\n<p>See <a href=\"https://cloud.google.com/appengine/docs/go/users/\" rel=\"nofollow noreferrer\">the docs</a> for more info.</p>\n"}], "owner": {"reputation": 1018, "user_id": 965354, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/764c96f636ebac5b2f1179159e2e85f6?s=128&d=identicon&r=PG", "display_name": "Simple99", "link": "https://stackoverflow.com/users/965354/simple99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1427591011, "creation_date": 1421593833, "question_id": 28011205, "link": "https://stackoverflow.com/questions/28011205/in-gae-when-might-a-user-not-have-an-id", "title": "In GAE, when might a User not have an ID", "body": "<p>I am building a web app with <code>go</code> and <code>GAE</code>. I would like to use Google Accounts for authentication. The <code>appengine/user</code> package contains a type, <code>User</code>. I was planning on using <code>ID</code> property of <code>User</code> as the ancestor to descendent entities in the <code>Datastore</code>. However I'm confused by the comments in this section of documentation:</p>\n\n<pre><code>type User struct {\n    Email      string\n    AuthDomain string\n    Admin      bool\n\n    // ID is the unique permanent ID of the user.\n    // It is populated if the Email is associated\n    // with a Google account, or empty otherwise.\n    ID string\n\n    FederatedIdentity string\n    FederatedProvider string\n}\n</code></pre>\n\n<p>Source: <a href=\"https://cloud.google.com/appengine/docs/go/users/reference#User\" rel=\"nofollow\">https://cloud.google.com/appengine/docs/go/users/reference#User</a></p>\n\n<p>Under what circumstances might an email not be associated with a google account and therefore <code>ID</code> be empty?</p>\n\n<p>I'm very new to <code>go</code> and <code>GAE</code> so please excuse my ignorance.  </p>\n"}, {"tags": ["templates", "go"], "answers": [{"comments": [{"owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "edited": false, "score": 0, "creation_date": 1421594683, "post_id": 28011068, "comment_id": 44410059, "body": "Very good. I&#39;ve tried the same - it didn&#39;t work - but for now it works like a charm!) Can I somehow make my statements shorter? For example: <code>{{if eq $val index .map &quot;key&quot;}}...</code>, instead <code>{{$mapVal := index .map &quot;key&quot;}}</code> and only then <code>{{if eq $val $mapVal}}...</code>. I think it&#39;s some sort of chaining."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "edited": false, "score": 1, "creation_date": 1421595346, "post_id": 28011068, "comment_id": 44410235, "body": "@TimurFayzrakhmanov use parenthesis  <code>{{if eq $val (index .map &quot;key&quot;)}}</code>"}, {"owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "edited": false, "score": 0, "creation_date": 1421596115, "post_id": 28011068, "comment_id": 44410487, "body": "What about long if statements? Eg: <code>if (1==1 &amp;&amp; 2==2) || 3==4</code>. How it will looks like in templates? This is the right one <code>if and (eq 1 1) (eq 2 2) or (eq 3 4)</code> ?"}, {"owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "edited": false, "score": 0, "creation_date": 1421596175, "post_id": 28011068, "comment_id": 44410506, "body": "If it requires separate question, I create it!)"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "edited": false, "score": 1, "creation_date": 1421599545, "post_id": 28011068, "comment_id": 44411637, "body": "{{if or (and (eq 1 1) (eq 2 2)) (eq 3 4)}}"}, {"owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "edited": false, "score": 0, "creation_date": 1421600073, "post_id": 28011068, "comment_id": 44411806, "body": "it looks like a pile))"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 14, "last_activity_date": 1421593004, "creation_date": 1421593004, "answer_id": 28011068, "question_id": 28010961, "link": "https://stackoverflow.com/questions/28010961/how-to-get-map-value-by-key-without-range-action-htm-text-templates-golang/28011068#28011068", "title": "How to get map value by key without range action (htm/text templates)? Golang", "body": "<p>Use index to get a value from a map:</p>\n\n<pre><code>{{index .mymap \"key\"}}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/XzH9gKUOMx\">playground example</a></p>\n"}], "owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6459, "favorite_count": 0, "accepted_answer_id": 28011068, "answer_count": 1, "score": 2, "last_activity_date": 1421593004, "creation_date": 1421592309, "question_id": 28010961, "link": "https://stackoverflow.com/questions/28010961/how-to-get-map-value-by-key-without-range-action-htm-text-templates-golang", "title": "How to get map value by key without range action (htm/text templates)? Golang", "body": "<p>I try just to get map value without iteration through the map.</p>\n\n<p>For example, at the moment to get the map value by key this weird way:</p>\n\n<pre><code>{{range $key, $value := .mymap}}\n    {{if $value = \"myvalue\"}}\n        {{template \"item\" .}}\n    {{end}}\n{{end}}\n</code></pre>\n\n<p>May be there is any better way just to get map value by key? For example:</p>\n\n<pre><code>{{print .mymap[\"key\"]}} \n</code></pre>\n"}, {"tags": ["loops", "for-loop", "go", "range"], "comments": [{"owner": {"reputation": 1188, "user_id": 1249657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd8f163e1cb08dc32c5c1687aae786d?s=128&d=identicon&r=PG", "display_name": "Darren Coxall", "link": "https://stackoverflow.com/users/1249657/darren-coxall"}, "edited": false, "score": 1, "creation_date": 1421585676, "post_id": 28009708, "comment_id": 44407479, "body": "There is no other way. You could of course write your own but given the lack of generics it would either need reflect or it would work for only specific types."}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 0, "creation_date": 1421586472, "post_id": 28009708, "comment_id": 44407694, "body": "Sorry, no real help for your question, but one thing you may want to remember when teaching the <code>range</code> statement to students is that it has slightly different syntax when ranging on a channel, as a channel has no concept of &quot;index&quot;. <code>for v := range chan</code> vs. <code>for k, v := range sliceOrStringOrMap</code>. <a href=\"https://golang.org/doc/effective_go.html#for\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html#for</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1421587835, "post_id": 28009708, "comment_id": 44408067, "body": "The last form is perfectly readable. Teaching students to worry about syntax minutiae seems unproductive. Show them idiomatic go."}, {"owner": {"reputation": 580, "user_id": 1211070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wYkCS.png?s=128&g=1", "display_name": "AndyS", "link": "https://stackoverflow.com/users/1211070/andys"}, "edited": false, "score": 0, "creation_date": 1421613859, "post_id": 28009708, "comment_id": 44416400, "body": "Thank you everyone - I did think I couldn&#39;t find a simpler method - and it seems I&#39;m (unfortunately) correct. It&#39;s not a big problem though - Go has some really nice features that we need. Thank you Intermernet - I am aware of the channels options - that is a bit later in the course. Thank you as well JimB - though my learning focus is on Concurrent and Parallel Systems. I&#39;m not just teaching Go, I&#39;m using Go as a example of CSP. They also know Java and C#/C++."}], "answers": [{"comments": [{"owner": {"reputation": 15090, "user_id": 310892, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Jy9kc.jpg?s=128&g=1", "display_name": "Lee Jarvis", "link": "https://stackoverflow.com/users/310892/lee-jarvis"}, "edited": false, "score": 0, "creation_date": 1421586233, "post_id": 28009967, "comment_id": 44407634, "body": "Hesitated to up-vote at first, but there really isn&#39;t a simpler answer. +1"}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 1, "creation_date": 1421586624, "post_id": 28009967, "comment_id": 44407741, "body": "Please add some more information. One word answers, although correct, aren&#39;t really worth much. An explanation of the range syntax, or the blank identifier would have probably helped the OP more than just &quot;No&quot;."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 8, "creation_date": 1421587018, "post_id": 28009967, "comment_id": 44407848, "body": "@Intermernet It seems like OP already knows how range syntax works; there is no point in explaining it again."}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1421587303, "post_id": 28009967, "comment_id": 44407921, "body": "@FUZxxl, The OP is obviously some form of teacher. I always think it&#39;s worth taking the time to properly educate the educators. If they had asked &quot;Should the <code>subtle.ConstantTimeCompare</code> function panic on comparing slices of different lengths?&quot; the answer would apparently be &quot;Yes&quot;. but they would have no knowledge of the &quot;why&quot; of the situation. I know this is a <i>much</i> simpler question, but I think it deserves more than &quot;No&quot;. The OP has probably has garnered more info from the first comment (not mine) than the answer."}, {"owner": {"reputation": 96306, "user_id": 3250829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2e07c34e170453eeea9e937a98f19b?s=128&d=identicon&r=PG", "display_name": "rayryeng", "link": "https://stackoverflow.com/users/3250829/rayryeng"}, "edited": false, "score": 0, "creation_date": 1422592009, "post_id": 28009967, "comment_id": 44821319, "body": "How did you manage to bypass the minimum word count for your answer? lol. +1 just for the hell of it."}, {"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "reply_to_user": {"reputation": 96306, "user_id": 3250829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2e07c34e170453eeea9e937a98f19b?s=128&d=identicon&r=PG", "display_name": "rayryeng", "link": "https://stackoverflow.com/users/3250829/rayryeng"}, "edited": false, "score": 0, "creation_date": 1422605715, "post_id": 28009967, "comment_id": 44825622, "body": "@rayryeng there&#39;s no minimum word count, only a minimum character count, and invisible separators count towards that quota."}], "tags": [], "owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "is_accepted": true, "score": 21, "last_activity_date": 1421586195, "creation_date": 1421586195, "answer_id": 28009967, "question_id": 28009708, "link": "https://stackoverflow.com/questions/28009708/is-there-a-shorter-form-for-go-for-range-loops/28009967#28009967", "title": "Is there a shorter form for Go for range loops", "body": "<p>No.\u200b\u200b\u200b\u200b\u200b\u200b\u200b\u200b\u200b\u200b\u200b\u200b\u200b\u200b\u200b\u200b\u200b\u200b\u200b\u200b\u200b\u200b\u200b\u200b\u200b\u200b\u200b\u200b\u200b\u200b\u200b\u200b</p>\n"}, {"tags": [], "owner": {"reputation": 171, "user_id": 4493198, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kAjSGsEiJG4/AAAAAAAAAAI/AAAAAAABW2o/rzwHgxgYxY4/photo.jpg?sz=128", "display_name": "iccananea", "link": "https://stackoverflow.com/users/4493198/iccananea"}, "is_accepted": false, "score": 1, "last_activity_date": 1422270855, "creation_date": 1422270855, "answer_id": 28149034, "question_id": 28009708, "link": "https://stackoverflow.com/questions/28009708/is-there-a-shorter-form-for-go-for-range-loops/28149034#28149034", "title": "Is there a shorter form for Go for range loops", "body": "<p>Short answer, no. Using range on a slice will always either yield the index or index,value.</p>\n"}], "owner": {"reputation": 580, "user_id": 1211070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wYkCS.png?s=128&g=1", "display_name": "AndyS", "link": "https://stackoverflow.com/users/1211070/andys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 28009967, "answer_count": 2, "score": 4, "last_activity_date": 1422270855, "creation_date": 1421584461, "question_id": 28009708, "link": "https://stackoverflow.com/questions/28009708/is-there-a-shorter-form-for-go-for-range-loops", "title": "Is there a shorter form for Go for range loops", "body": "<p>I have checked the language spec - is there a simpler way to say this:</p>\n\n<pre><code>for _, month := range []int{4,6,9,11} {\n    fmt.Print(month, \" \")\n}\n</code></pre>\n\n<p>I'm (ideally) looking for something like (I know this isn't Go)</p>\n\n<pre><code>for month in [4,6,9,11] {\n    fmt.Print(month, \" \")\n}\n</code></pre>\n\n<p>I know I can do:</p>\n\n<pre><code>days30 := []int{4,6,9,11} \nfor i := range days30 {\n    fmt.Print(days30[i], \" \")\n}\n</code></pre>\n\n<p>But this is less readible...</p>\n\n<p>Note: This is for teaching purposes - so I'm looking for a simple, self contained solution for students - nothing too advanced please.</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1421595788, "post_id": 28008688, "comment_id": 44410385, "body": "Is your goal to make the client of your application redirect to example.com?"}, {"owner": {"reputation": 191, "user_id": 3637821, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fca2c3f877a78274fb19b57af2672ba6?s=128&d=identicon&r=PG&f=1", "display_name": "vvincirey", "link": "https://stackoverflow.com/users/3637821/vvincirey"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1421605319, "post_id": 28008688, "comment_id": 44413479, "body": "@3of3 yeah, take it to the page where example.com takes"}], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 3637821, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fca2c3f877a78274fb19b57af2672ba6?s=128&d=identicon&r=PG&f=1", "display_name": "vvincirey", "link": "https://stackoverflow.com/users/3637821/vvincirey"}, "edited": false, "score": 0, "creation_date": 1421605651, "post_id": 28008738, "comment_id": 44413601, "body": "so suppose i am taking values from client and in my program i am sending a post request to my payment gateway. now the client should be on payment gateway page after the post request. How should i handle that?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 191, "user_id": 3637821, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fca2c3f877a78274fb19b57af2672ba6?s=128&d=identicon&r=PG&f=1", "display_name": "vvincirey", "link": "https://stackoverflow.com/users/3637821/vvincirey"}, "edited": false, "score": 0, "creation_date": 1421605739, "post_id": 28008738, "comment_id": 44413630, "body": "@vvincirey that would be to the server to handle: if it sends back a redirect directive, then the client will end up on the redirected page. If not, it will stay on the payment gateway page."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 2, "last_activity_date": 1421577439, "creation_date": 1421577439, "answer_id": 28008738, "question_id": 28008688, "link": "https://stackoverflow.com/questions/28008688/why-is-postform-not-redirecting-in-golang-gae/28008738#28008738", "title": "why is PostForm not redirecting in golang gae?", "body": "<p>A <a href=\"http://golang.org/pkg/net/http/#Client.PostForm\" rel=\"nofollow\">net.http.Client.PostForm()</a>  issues a POST to the specified URL, with data's keys and values urlencoded as the request body. </p>\n\n<p>But that doesn't mean it instruct the target website to redirect anything.<br>\nAs <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/9LccRMzXK74\" rel=\"nofollow\">shown in this thread</a>, the client would follow a redirect only if the website returned a <a href=\"http://en.wikipedia.org/wiki/HTTP_302\" rel=\"nofollow\">302 code</a>, respecting the <a href=\"http://en.wikipedia.org/wiki/Post/Redirect/Get\" rel=\"nofollow\">Post/Redirect/Get</a> web development design pattern that prevents some duplicate form submissions.<br>\n(<a href=\"https://github.com/golang/go/issues/4145\" rel=\"nofollow\">Issue 4145</a>, fixed with <a href=\"https://github.com/golang/go/commit/08ce7f1d5c309cf4187fbb1e442ee4388c29212b\" rel=\"nofollow\">commit 08ce7f1</a> for go 1.1, May 2013)</p>\n"}], "owner": {"reputation": 191, "user_id": 3637821, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fca2c3f877a78274fb19b57af2672ba6?s=128&d=identicon&r=PG&f=1", "display_name": "vvincirey", "link": "https://stackoverflow.com/users/3637821/vvincirey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 2, "accepted_answer_id": 28008738, "answer_count": 1, "score": 0, "last_activity_date": 1421608168, "creation_date": 1421576998, "question_id": 28008688, "link": "https://stackoverflow.com/questions/28008688/why-is-postform-not-redirecting-in-golang-gae", "title": "why is PostForm not redirecting in golang gae?", "body": "<p>I am trying to post a form using golang. My code is below</p>\n\n<pre><code>client := urlfetch.Client(c)\n\nresp, err := client.PostForm(\"example.com\", url.Values{})\nif err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>I am getting 200 OK response but it is not redirecting to example.com</p>\n\n<p>Am i doing something wrong?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": false, "score": 2, "last_activity_date": 1421581607, "creation_date": 1421581607, "answer_id": 28009318, "question_id": 28008566, "link": "https://stackoverflow.com/questions/28008566/how-to-compute-the-offset-from-column-and-line-number-go/28009318#28009318", "title": "How to compute the offset from column and line number ? - Go", "body": "<p>Since line width isn't fixed, there's no quick way of knowing that. you need to traverse the file's content character by character and count the offset. something like:</p>\n\n<pre><code>func findOffset(fileText string, line, column int) int {\n   // we count our current line and column position\n   currentCol := 1\n   currentLine := 1\n\n\n   for offset,ch := range fileText {\n      // see if we found where we wanted to go to\n      if currentLine == line &amp;&amp; currentCol == column {\n         return offset\n      }\n\n      // line break - increment the line counter and reset the column\n      if ch == '\\n' {\n         currentLine++\n         currentCol = 1\n      } else {\n          currentCol++\n      }\n\n    } \n    return -1; //not found\n} \n\n// this here is our source code for example\nvar sampleText = `package main\n\nvar foo = \"hello\"\n\nvar bar =\"world\"\n`\n\n\nfunc main() {\n\n      fmt.Println(findOffset(sampleText, 1, 1)) //prints 0\n\n      fmt.Println(findOffset(sampleText, 3, 5)) //prints 18\n\n}\n</code></pre>\n\n<p>Playground link: <a href=\"http://play.golang.org/p/fWb9N9r9pi\" rel=\"nofollow\">http://play.golang.org/p/fWb9N9r9pi</a></p>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 467, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1421581607, "creation_date": 1421575359, "last_edit_date": 1421578513, "question_id": 28008566, "link": "https://stackoverflow.com/questions/28008566/how-to-compute-the-offset-from-column-and-line-number-go", "title": "How to compute the offset from column and line number ? - Go", "body": "<p>I need to compute the offset in a source code file using a column and line number as reference (e.g. <code>source.go:23:42</code>). How can I compute the offset ?  I'm using it to analyse the source code with some go tools(<a href=\"https://godoc.org/golang.org/x/tools/oracle\" rel=\"nofollow\">oracle</a>, <a href=\"http://golang.org/pkg/go/ast\" rel=\"nofollow\">ast</a> and <a href=\"http://golang.org/pkg/go/token\" rel=\"nofollow\">token</a>).</p>\n"}, {"tags": ["go", "static-analysis"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1421568078, "post_id": 28008164, "comment_id": 44404369, "body": "<a href=\"https://github.com/golang/tools/blob/master/oracle/pos.go#L28\" rel=\"nofollow noreferrer\">github.com/golang/tools/blob/master/oracle/pos.go#L28</a> says the #550 is a byte offset, so it looks like you need to walk through the file, count bytes in the first 39 lines (including the newlines separating them), and add 31 (assuming file.go:1:1 is byte 0)."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1421568726, "post_id": 28008164, "comment_id": 44404496, "body": "Ah, and there&#39;s a <code>token.Position.Offset</code> so you don&#39;t have to do all that!"}], "answers": [{"comments": [{"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1421569507, "post_id": 28008290, "comment_id": 44404649, "body": "if Pos is byte offeset I&#39;m wondering why we have a Pos type and don&#39;t just use Offset. Now I&#39;ve found File.Pos <a href=\"https://godoc.org/go/token#File.Pos\" rel=\"nofollow noreferrer\">godoc.org/go/token#File.Pos</a>"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1421570031, "post_id": 28008290, "comment_id": 44404731, "body": "<a href=\"https://godoc.org/go/token#Position\" rel=\"nofollow noreferrer\"><code>token.Position</code></a> and <a href=\"https://github.com/golang/tools/blob/4f8578d2c095328e9192e9d0b0ea335c6ea3e9a5/oracle/oracle.go#L138\" rel=\"nofollow noreferrer\"><code>oracle.QueryPos</code></a> each carry extra information that&#39;s useful in their respective contexts, which seems like enough justification to me."}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1421570959, "post_id": 28008290, "comment_id": 44404904, "body": "Sounds fair enough to me. Any idea how to get the offset out of file:line:column ? <code>oracle.Query.Describe</code>[0] provides just that so I no longer have access to <code>token.Position.Offset</code>.  [0] <a href=\"https://godoc.org/golang.org/x/tools/oracle/serial#Describe.Pos\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/tools/oracle/serial#Describe.Pos</a>"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1421645385, "post_id": 28008290, "comment_id": 44423666, "body": "By hand: open the file, split on new lines, count total bytes in preceding lines (i.e., first 42 if string specifies line 43; add 1 byte per line assuming split stripped out newlines), add the column number, subtract 1 because :1:1 is byte 0 not 1. If speed were an issue (not likely) you could keep file contents around for faster counting after first use. There must be some better way, maybe worth digging around for an API that will give you an offset, but if you have to do that it&#39;s not too hard or too much code."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1421645489, "post_id": 28008290, "comment_id": 44423683, "body": "If you posted a <i>separate</i> question about the <i>overall task</i> you&#39;re trying to do, someone more familiar with these packages might be able to help. Other people here likely know more than me about these particular packages--I&#39;m just telling you what I can figure out &quot;blind&quot;."}], "tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": false, "score": 1, "last_activity_date": 1421568943, "creation_date": 1421568943, "answer_id": 28008290, "question_id": 28008164, "link": "https://stackoverflow.com/questions/28008164/what-kind-of-encoding-does-posflag-requires/28008290#28008290", "title": "What kind of encoding does posFlag requires?", "body": "<p><a href=\"https://github.com/golang/tools/blob/4f8578d2c095328e9192e9d0b0ea335c6ea3e9a5/oracle/pos.go#L28-L30\" rel=\"nofollow\">The source to <code>tools/pos.go</code></a> called by ParseQueryPos says</p>\n\n<pre><code>// parsePosFlag parses a string of the form \"file:pos\" or\n// file:start,end\" where pos, start, end match #%d and represent byte\n// offsets, and returns its components.\n</code></pre>\n\n<p>If you really had to convert from <code>line:column</code> strings, you'd look at the file contents and count up bytes (including newlines) leading to that line:column. But since you're working with a <code>token.Position</code>, it looks like you can get what you need from <a href=\"https://godoc.org/go/token#Position\" rel=\"nofollow\"><code>token.Position.Offset</code></a>.</p>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1421568943, "creation_date": 1421567486, "question_id": 28008164, "link": "https://stackoverflow.com/questions/28008164/what-kind-of-encoding-does-posflag-requires", "title": "What kind of encoding does posFlag requires?", "body": "<p>How can I encode the position of the form <code>/pathto/file.go:40:32</code> which is returned by <a href=\"https://godoc.org/go/token#Position.String\" rel=\"nofollow\"><code>token.Position.String()</code></a> to a <code>posFlag</code> param required by <a href=\"https://godoc.org/golang.org/x/tools/oracle#ParseQueryPos\" rel=\"nofollow\"><code>ParseQueryPos</code></a> which looks like <code>/pathto/file.go:#550</code>.</p>\n\n<p>Why?</p>\n\n<p>I'm using the <a href=\"https://godoc.org/golang.org/x/tools/oracle\" rel=\"nofollow\"><code>Oracle</code></a> tool to do some static analysis. I need to run <a href=\"https://godoc.org/golang.org/x/tools/oracle#Oracle.Query\" rel=\"nofollow\"><code>Oracle.Query</code></a> which requires a param of type <a href=\"https://godoc.org/golang.org/x/tools/oracle#QueryPos\" rel=\"nofollow\"><code>*QueryPos</code></a>. The only way to get <a href=\"https://godoc.org/golang.org/x/tools/oracle#QueryPos\" rel=\"nofollow\"><code>*QueryPos</code></a> is using <a href=\"https://godoc.org/golang.org/x/tools/oracle#ParseQueryPos\" rel=\"nofollow\"><code>ParseQueryPos</code></a>. </p>\n"}, {"tags": ["mongodb", "go"], "comments": [{"owner": {"reputation": 129250, "user_id": 2313887, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/259593de18972d36e25f230c2be19d9f?s=128&d=identicon&r=PG", "display_name": "Neil Lunn", "link": "https://stackoverflow.com/users/2313887/neil-lunn"}, "edited": false, "score": 0, "creation_date": 1421563165, "post_id": 28007756, "comment_id": 44403639, "body": "The &quot;id&quot; field is a string and not an integer as you have defined in your struct"}], "answers": [{"comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 64, "user_id": 1447789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ef6c4b2cccc9969ec837ce7163a60fdb?s=128&d=identicon&r=PG", "display_name": "Deliri", "link": "https://stackoverflow.com/users/1447789/deliri"}, "edited": false, "score": 0, "creation_date": 1421563702, "post_id": 28007782, "comment_id": 44403710, "body": "@user3513407 Do you need to store both &quot;id&quot; and &quot;_id&quot; in the database? If the integer &quot;id&quot; is unique, you can use it as &quot;_id&quot;."}, {"owner": {"reputation": 64, "user_id": 1447789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ef6c4b2cccc9969ec837ce7163a60fdb?s=128&d=identicon&r=PG", "display_name": "Deliri", "link": "https://stackoverflow.com/users/1447789/deliri"}, "edited": false, "score": 0, "creation_date": 1421563747, "post_id": 28007782, "comment_id": 44403718, "body": "Any suggestions for how to solve the &quot;insert&quot; problem?  Ideally I&#39;d like a solution where you can separate things. data := (stuff to insert) err = c.Insert(data)  The &quot;data&quot; line is where all my mistakes are showing up.   Thanks in advance for your help."}, {"owner": {"reputation": 64, "user_id": 1447789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ef6c4b2cccc9969ec837ce7163a60fdb?s=128&d=identicon&r=PG", "display_name": "Deliri", "link": "https://stackoverflow.com/users/1447789/deliri"}, "edited": false, "score": 0, "creation_date": 1421563828, "post_id": 28007782, "comment_id": 44403730, "body": "I&#39;m just trying to match the data structure provided by the course&#39;s instructor."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 64, "user_id": 1447789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ef6c4b2cccc9969ec837ce7163a60fdb?s=128&d=identicon&r=PG", "display_name": "Deliri", "link": "https://stackoverflow.com/users/1447789/deliri"}, "edited": false, "score": 0, "creation_date": 1421563858, "post_id": 28007782, "comment_id": 44403732, "body": "Does <code>data := &amp;Customer{ID: 10,  FirstName: &quot;John&quot;}; err := c.Insert(data)</code> solve this problem?  You can replace the &quot;;&quot; with a newline."}, {"owner": {"reputation": 64, "user_id": 1447789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ef6c4b2cccc9969ec837ce7163a60fdb?s=128&d=identicon&r=PG", "display_name": "Deliri", "link": "https://stackoverflow.com/users/1447789/deliri"}, "edited": false, "score": 0, "creation_date": 1421565627, "post_id": 28007782, "comment_id": 44403984, "body": "<code>c := session.DB(&quot;mydb&quot;).C(&quot;customers&quot;)   data := &amp;Customer{ID: 10, FirstName: &quot;John&quot;, SurName: &quot;McDonald&quot;, Gender: &quot;M&quot;, Address1: &quot;1 Moon Landing&quot;, Address2: &quot;Rock bottom&quot;, city: &quot;NY&quot;, State_region: &quot;New York&quot;} err = c.Insert(data) if err != nil { log.Fatal(err) } &#47;&#47; query one result := Customer{} err =   c.Find(bson.M{&quot;FirstName&quot;: &quot;John&quot;}).One(&amp;result) if err != nil { log.Fatal(&quot;Couldn&#39;t find him.&quot;, err) } fmt.Println(&quot;One Result: &quot;, result) </code> Results :: unknown Customer field &#39;SurName&#39; in struct literal"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 64, "user_id": 1447789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ef6c4b2cccc9969ec837ce7163a60fdb?s=128&d=identicon&r=PG", "display_name": "Deliri", "link": "https://stackoverflow.com/users/1447789/deliri"}, "edited": false, "score": 0, "creation_date": 1421566328, "post_id": 28007782, "comment_id": 44404082, "body": "The struct field in my example above is <code>Surname</code>, not <code>SurName</code>. Change the field name in the type definition or the composite literal to match the other."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 0, "last_activity_date": 1421563548, "last_edit_date": 1421563548, "creation_date": 1421563157, "answer_id": 28007782, "question_id": 28007756, "link": "https://stackoverflow.com/questions/28007756/inserting-querying-mongodb-data-with-go/28007782#28007782", "title": "Inserting &amp; Querying MongoDB data with Go", "body": "<p><a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow\">Export</a> the field names.</p>\n\n<pre><code>type Customer struct {\n    Id              bson.ObjectId `bson:\"_id,omitempty\"`\n    ID              int           `bson:\"id\"`\n    FirstName       string        `bson:\"firstName\"`\n    Surname         string        `bson:\"surname\"`\n    Gender          string        `bson:\"gender\"`\n    Address1        string        `bson:\"address1\"`\n    Address2        string        `bson:\"address2\"`\n    City            string        `bson:\"city\"`\n    State_region    string        `bson:\"state_region\"`\n    County_province string        `bson:\"county_province\"`\n    PostalCode      string        `bson:\"postalCode\"`\n    Country         string        `bson:\"country\"`\n    Acct_bal        float64       `bson:\"acct_bal\"`\n    Status          string        `bson:\"status\"`\n}\n</code></pre>\n\n<p>The BSON encoder <a href=\"http://godoc.org/gopkg.in/mgo.v2/bson#Marshal\" rel=\"nofollow\">serializes exported fields only</a>. Other serializers such as encoding/json and encoding/gob also work with exported fields only.</p>\n"}], "owner": {"reputation": 64, "user_id": 1447789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ef6c4b2cccc9969ec837ce7163a60fdb?s=128&d=identicon&r=PG", "display_name": "Deliri", "link": "https://stackoverflow.com/users/1447789/deliri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 786, "favorite_count": 0, "accepted_answer_id": 28007782, "answer_count": 1, "score": 1, "last_activity_date": 1421564338, "creation_date": 1421562903, "last_edit_date": 1421564338, "question_id": 28007756, "link": "https://stackoverflow.com/questions/28007756/inserting-querying-mongodb-data-with-go", "title": "Inserting &amp; Querying MongoDB data with Go", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n\n    \"gopkg.in/mgo.v2\"\n    \"gopkg.in/mgo.v2/bson\"\n)\n\ntype Customer struct {\n    Id              bson.ObjectId `bson:\"_id,omitempty\"`\n    id              int           `bson:\"id,\"`\n    firstName       string        `bson:\"firstName\"`\n    surname         string        `bson:\"surname\"`\n    gender          string        `bson:\"gender\"`\n    address1        string        `bson:\"address1\"`\n    address2        string        `bson:\"address2\"`\n    city            string        `bson:\"city\"`\n    state_region    string        `bson:\"state_region\"`\n    county_province string        `bson:\"county_province\"`\n    postalCode      string        `bson:\"postalCode\"`\n    country         string        `bson:\"country\"`\n    acct_bal        float64       `bson:\"acct_bal\"`\n    status          string        `bson:\"status\"`\n}\n\nfunc main() {\n    uri := \"localhost:27017\"\n\n    // connect to mongodb\n    session, err := mgo.Dial(uri)\n    if err != nil {\n        log.Fatal(\"Couldn't connect to db.\", err)\n\n    }\n    defer session.Close()\n\n    // collection\n    c := session.DB(\"mydb\").C(\"customers\")\n\n    // query one\n    result := Customer{}\n    err = c.Find(bson.M{\"status\": \"B\"}).One(&amp;result)\n    if err != nil {\n        log.Fatal(\"Couldn't find him.\", err)\n\n    }\n    fmt.Println(\"One Result: \", result)\n}\n</code></pre>\n\n<p>So that's the code, \nIf I run the MongoShell I get the correct results ::</p>\n\n<pre><code>{\n\"_id\" : ObjectId(\"528cb19def5c88795f00000a\"),\n\"id\" : \"00000011\",\n\"firstName\" : \"Gerardo\",\n\"surname\" : \"Guilfoos\",\n\"gender\" : \"M\",\n\"address1\" : \"854 Cheerful Breeze Way\",\n\"address2\" : \"\",\n\"city\" : \"Tavaux\",\n\"state_region\" : \"Franche-Comt\u00e9\",\n\"county_province\" : \"Jura\",\n\"postalCode\" : \"39501 CEDEX\",\n\"country\" : \"FR\",\n\"acct_balance\" : 172.87,\n\"status\" : \"B\"\n</code></pre>\n\n<p>}</p>\n\n<p>But the Go file when run gives me this:: </p>\n\n<pre><code>One Result:  {ObjectIdHex(\"528cb19def5c88795f00000a\") 0           0 }\n</code></pre>\n\n<p>I'm following along a course from Udemy and they provide the data structures. Unfortunately for me, the examples they provide are all in PHP so I kind of have to figure out a way to convert all of the code to Go which has been weird. </p>\n\n<p>Also on a second note:: \nHow does one insert a data that matches that struct into a mongoDB collection? \nI tried this but it has been a failure. </p>\n\n<pre><code>err = c.Insert(&amp;Customer{\"id\": 1, \"firstName\": \"Joe\", \"surname\": \"Hat\", \"gender\": \"M\", \"address1\": \"46 Pine Road\", \"address2\": \"Apartment 1613\", \"city\": \"Scarborough\", \"state_region\": \"G.T.A\", \"county_provine\": \"Ontario\", \"postalCode\": \"M1L 1N1\", \"country\": \"Canada\", \"acct_bal\": 8.90, \"status\": \"AAA\",})\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 0, "creation_date": 1421544764, "post_id": 28006265, "comment_id": 44400918, "body": "You need to put these commands into your <code>.bash_profile</code> on OSX ."}, {"owner": {"reputation": 2484, "user_id": 3794472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZTwGs.jpg?s=128&g=1", "display_name": "Jeremiah Winsley", "link": "https://stackoverflow.com/users/3794472/jeremiah-winsley"}, "edited": false, "score": 0, "creation_date": 1421545420, "post_id": 28006265, "comment_id": 44401063, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/21499337/cannot-set-gopath-on-mac-osx\">Cannot set $GOPATH on Mac OSX</a>"}, {"owner": {"reputation": 287, "user_id": 4418309, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/NqKTU.jpg?s=128&g=1", "display_name": "Dipen", "link": "https://stackoverflow.com/users/4418309/dipen"}, "reply_to_user": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 0, "creation_date": 1421546751, "post_id": 28006265, "comment_id": 44401263, "body": "@Intermernet Thanks it worked, I added those exact files and restarted the terminal."}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 0, "creation_date": 1421546827, "post_id": 28006265, "comment_id": 44401271, "body": "@Dipen good to hear. Happy coding :-)"}], "answers": [{"comments": [{"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1421578987, "post_id": 28006478, "comment_id": 44405809, "body": "Ok. I do same way oh my macbook. Also I have VPS running Ubuntu 14 which I access via SSH only for sure. Due to interactive non interactive shell distinction ~/.bashrc not always sourced.  Which profile or rc guaranteed to be sourced on Ubuntu in all case?"}, {"owner": {"reputation": 10664, "user_id": 475229, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0952c4a2c08421aecb397d3a81545f6e?s=128&d=identicon&r=PG", "display_name": "jgritty", "link": "https://stackoverflow.com/users/475229/jgritty"}, "reply_to_user": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1421579729, "post_id": 28006478, "comment_id": 44405984, "body": "That&#39;s probably worthy of a separate question, and might already have an answer here."}], "tags": [], "owner": {"reputation": 10664, "user_id": 475229, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0952c4a2c08421aecb397d3a81545f6e?s=128&d=identicon&r=PG", "display_name": "jgritty", "link": "https://stackoverflow.com/users/475229/jgritty"}, "is_accepted": false, "score": 2, "last_activity_date": 1421546947, "creation_date": 1421546947, "answer_id": 28006478, "question_id": 28006265, "link": "https://stackoverflow.com/questions/28006265/gopath-value-keeps-reseting-to-empty-during-new-sessions-of-the-terminal/28006478#28006478", "title": "$GOPATH value keeps reseting to empty during new sessions of the terminal", "body": "<p>Add these lines to your ~/.bashrc or ~/.bash_profile:</p>\n\n<pre><code>export GOPATH=$HOME/go\nexport PATH=$PATH:$GOPATH/bin\n</code></pre>\n"}], "owner": {"reputation": 287, "user_id": 4418309, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/NqKTU.jpg?s=128&g=1", "display_name": "Dipen", "link": "https://stackoverflow.com/users/4418309/dipen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1265, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1421859707, "creation_date": 1421544626, "last_edit_date": 1421859707, "question_id": 28006265, "link": "https://stackoverflow.com/questions/28006265/gopath-value-keeps-reseting-to-empty-during-new-sessions-of-the-terminal", "title": "$GOPATH value keeps reseting to empty during new sessions of the terminal", "body": "<p>I have installed GO on my Mac Book using the 10.8+ installer from golang.org, and I have set up a workspace. After running both these commands: <code>export GOPATH=$HOME/go</code> and <code>export PATH=$PATH:$GOPATH/bin</code>, echoing the GOPATH does return a value of <code>/Users/dipen/go</code>; however, after restarting the terminal, the echoing the GOPATH returns nothing. How can I fix this?</p>\n"}, {"tags": ["go", "temporary-files"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1421540875, "post_id": 28005865, "comment_id": 44400146, "body": "Why is it important that you need a suffix?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1421559335, "post_id": 28005865, "comment_id": 44403134, "body": "I would copy/paste the code and move on. To keep it simple, I&#39;d use a function in math/rand instead of copying the random number generator in io/ioutil."}], "answers": [{"comments": [{"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 4, "creation_date": 1421544493, "post_id": 28005931, "comment_id": 44400866, "body": "You definitely need more than just that function.  That function can return file names that already exist, for instance.  Such an API should be creating the file by opening it with <code>O_CREAT | O_EXCL</code> to ensure that no one else creates the file between deciding on the name and creating the file."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 7, "last_activity_date": 1586136327, "last_edit_date": 1586136327, "creation_date": 1421541106, "answer_id": 28005931, "question_id": 28005865, "link": "https://stackoverflow.com/questions/28005865/golang-generate-unique-filename-with-extension/28005931#28005931", "title": "Golang Generate Unique Filename With Extension", "body": "<p>Update (2020: the original answer is from 2015)</p>\n\n<p>As noted in <a href=\"https://stackoverflow.com/users/3997690/lax\">Lax</a>'s <a href=\"https://stackoverflow.com/a/61050527/6309\">answer</a>, Go 1.11 (Apr. 2018) has changed  <code>TempFile</code> prefix to a pattern.</p>\n\n<p>See <a href=\"https://github.com/golang/go/commit/191efbc419d7e5dec842c20841f6f716da4b561d\" rel=\"nofollow noreferrer\">commit 191efbc</a> from <a href=\"https://go-review.googlesource.com/c/go/+/105675/\" rel=\"nofollow noreferrer\">CL 105675</a> after <a href=\"https://github.com/golang/go/issues/4896\" rel=\"nofollow noreferrer\">issue 4896</a></p>\n\n<blockquote>\n  <p>Users of <code>TempFile</code> need to be able to supply the suffix, especially\n  when using operating systems that give semantic meaning to the\n  filename extension such as Windows.<br>\n  Renaming the file to include an extension after the fact is insufficient as it could lead to race conditions.</p>\n  \n  <p>If the string given to <code>TempFile</code> includes a \"<code>*</code>\", the random string\n  replaces the \"<code>*</code>\". </p>\n  \n  <p>For example \"<code>myname.*.bat</code>\" will result in a random\n  filename such as \"<code>myname.123456.bat</code>\".  </p>\n  \n  <p>If no \"<code>*</code>' is included the\n  old behavior is retained, and the random digits are appended to the\n  end.</p>\n  \n  <p>If multiple \"<code>*</code>\" are included, the final one is replaced, thus\n  permitting a pathological programmer to create filenames such as\n  \"<code>foo*.123456.bat</code>\" but not \"<code>foo.123456.*.bat</code>\"</p>\n</blockquote>\n\n<hr>\n\n<p>Original Answer (2015)</p>\n\n<blockquote>\n  <p>Should I just copy/paste the TempFile code and add in a suffix parameter?</p>\n</blockquote>\n\n<p>That would be one way.<br>\nOther way is to make a quick -- crude -- implementation, as in <a href=\"https://github.com/joncrlsn/fileutil/blob/5aac37a6ac963fd712b618b024d2eb14aa190958/fileutil.go#L98-L103\" rel=\"nofollow noreferrer\">this project</a>:</p>\n\n<pre><code>// TempFileName generates a temporary filename for use in testing or whatever\nfunc TempFileName(prefix, suffix string) string {\n    randBytes := make([]byte, 16)\n    rand.Read(randBytes)\n    return filepath.Join(os.TempDir(), prefix+hex.EncodeToString(randBytes)+suffix)\n}\n</code></pre>\n\n<p>As <a href=\"https://stackoverflow.com/users/721283/c\">James Henstridge</a> <a href=\"https://stackoverflow.com/questions/28005865/golang-generate-unique-filename-with-extension#comment44400866_28005931\">comments</a> below, this is a <em>crude</em> function:</p>\n\n<blockquote>\n  <p>That function can return file names that already exist, for instance. Such an API should be creating the file by opening it with <code>O_CREAT | O_EXCL</code> to ensure that no one else creates the file between deciding on the name and creating the file.</p>\n</blockquote>\n\n<p>That crude function above illustrates only the use of <a href=\"http://golang.org/pkg/crypto/rand/#Read\" rel=\"nofollow noreferrer\"><code>rand.Read()</code></a> to generate a filename.  </p>\n\n<p>But the other checks are all in <a href=\"https://github.com/golang/go/blob/master/src/io/ioutil/tempfile.go\" rel=\"nofollow noreferrer\"><code>io/ioutil/tempfile.go</code></a>.<br>\n<a href=\"https://stackoverflow.com/users/4130971/3of3\">3of3</a> <a href=\"https://stackoverflow.com/questions/28005865/golang-generate-unique-filename-with-extension#comment44403134_28005865\">suggests</a> to use a function in <a href=\"http://golang.org/pkg/math/rand/\" rel=\"nofollow noreferrer\"><code>math.rand</code></a>  instead of copying the <a href=\"https://github.com/golang/go/blob/c2c0bf77efef5fd0e1cdecb330a9d30de1509ff8/src/io/ioutil/tempfile.go#L22-L36\" rel=\"nofollow noreferrer\">random number generator in <code>io/ioutil/tempfile.go</code></a>.</p>\n"}, {"comments": [{"owner": {"reputation": 456, "user_id": 1952953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DT9yd.jpg?s=128&g=1", "display_name": "Moataz Elmasry", "link": "https://stackoverflow.com/users/1952953/moataz-elmasry"}, "edited": false, "score": 0, "creation_date": 1521546041, "post_id": 48987189, "comment_id": 85767144, "body": "Is it really worth it adding a new dependency to the code for a function that can be copied locally?"}, {"owner": {"reputation": 11281, "user_id": 260805, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/34e031251528689dd8f8039fef24a65f?s=128&d=identicon&r=PG", "display_name": "Ztyx", "link": "https://stackoverflow.com/users/260805/ztyx"}, "reply_to_user": {"reputation": 456, "user_id": 1952953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DT9yd.jpg?s=128&g=1", "display_name": "Moataz Elmasry", "link": "https://stackoverflow.com/users/1952953/moataz-elmasry"}, "edited": false, "score": 1, "creation_date": 1521564830, "post_id": 48987189, "comment_id": 85781405, "body": "Moataz: Nothing is stopping you from copying it. I think that&#39;s a decision up to you."}, {"owner": {"reputation": 11281, "user_id": 260805, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/34e031251528689dd8f8039fef24a65f?s=128&d=identicon&r=PG", "display_name": "Ztyx", "link": "https://stackoverflow.com/users/260805/ztyx"}, "reply_to_user": {"reputation": 456, "user_id": 1952953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DT9yd.jpg?s=128&g=1", "display_name": "Moataz Elmasry", "link": "https://stackoverflow.com/users/1952953/moataz-elmasry"}, "edited": false, "score": 1, "creation_date": 1521564905, "post_id": 48987189, "comment_id": 85781451, "body": "...however, remember that the repo will have a suite of tests which we are willing to maintain."}], "tags": [], "owner": {"reputation": 11281, "user_id": 260805, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/34e031251528689dd8f8039fef24a65f?s=128&d=identicon&r=PG", "display_name": "Ztyx", "link": "https://stackoverflow.com/users/260805/ztyx"}, "is_accepted": false, "score": 3, "last_activity_date": 1519643636, "creation_date": 1519643636, "answer_id": 48987189, "question_id": 28005865, "link": "https://stackoverflow.com/questions/28005865/golang-generate-unique-filename-with-extension/48987189#48987189", "title": "Golang Generate Unique Filename With Extension", "body": "<p>Have a look at <a href=\"https://github.com/tink-ab/tempfile\" rel=\"nofollow noreferrer\">https://github.com/tink-ab/tempfile</a>. It's basically what the standard library supplies, but with support for both prefix and suffix.</p>\n"}, {"tags": [], "owner": {"reputation": 435, "user_id": 3997690, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Ru3Xg.png?s=128&g=1", "display_name": "LaX", "link": "https://stackoverflow.com/users/3997690/lax"}, "is_accepted": false, "score": 2, "last_activity_date": 1586126724, "creation_date": 1586126724, "answer_id": 61050527, "question_id": 28005865, "link": "https://stackoverflow.com/questions/28005865/golang-generate-unique-filename-with-extension/61050527#61050527", "title": "Golang Generate Unique Filename With Extension", "body": "<p>To anyone who would read this thread more recently, as of now (April 2020), <code>ioutil.TempFile</code> handles both prefix and suffix.</p>\n\n<p>From its documentation:</p>\n\n<blockquote>\n  <p>TempFile creates a new temporary file in the directory dir,\n  opens the file for reading and writing, and returns the resulting <code>*os.File</code>.\n  The filename is generated by taking pattern and adding a random\n  string to the end. If pattern includes a \"<code>*</code>\", the random string\n  replaces the last \"<code>*</code>\".</p>\n</blockquote>\n\n<p>As such, passing \"<code>prefix-*-suffix</code>\" as the <code>pattern</code> argument would yield the expected behaviour.</p>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 0, "last_activity_date": 1619133578, "creation_date": 1619133578, "answer_id": 67221986, "question_id": 28005865, "link": "https://stackoverflow.com/questions/28005865/golang-generate-unique-filename-with-extension/67221986#67221986", "title": "Golang Generate Unique Filename With Extension", "body": "<p>Starting with Go 1.16, you can use <code>os.CreateTemp</code>:</p>\n<pre><code>package main\nimport &quot;os&quot;\n\nfunc main() {\n   f, e := os.CreateTemp(&quot;&quot;, &quot;*.txt&quot;)\n   if e != nil {\n      panic(e)\n   }\n   defer f.Close()\n   println(f.Name())\n}\n</code></pre>\n<p><a href=\"https://golang.org/pkg/os#CreateTemp\" rel=\"nofollow noreferrer\">https://golang.org/pkg/os#CreateTemp</a></p>\n"}], "owner": {"reputation": 1560, "user_id": 830610, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/6ad4beaa5454a99a1d3a581302f7d6af?s=128&d=identicon&r=PG", "display_name": "John Montague", "link": "https://stackoverflow.com/users/830610/john-montague"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11683, "favorite_count": 2, "answer_count": 4, "score": 7, "last_activity_date": 1619133578, "creation_date": 1421540640, "question_id": 28005865, "link": "https://stackoverflow.com/questions/28005865/golang-generate-unique-filename-with-extension", "title": "Golang Generate Unique Filename With Extension", "body": "<p>I want to generate unique filenames in Golang with extensions.  Very much akin to ioutil.TempFile, which only takes prefixes.</p>\n\n<p>This has been brought up many times in the forums <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/PHgye3Hm2_0\" rel=\"noreferrer\">https://groups.google.com/forum/#!topic/golang-nuts/PHgye3Hm2_0</a> and the Go goes seem pretty intent on not adding that functionality to TempFile.</p>\n\n<p>So what's the suggested way to handle this?  Should I just copy/paste the TempFile code and add in a suffix parameter?</p>\n"}, {"tags": ["go", "redis"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1421591663, "post_id": 28004103, "comment_id": 44409209, "body": "Show the code you use to store the values. Without the code, it&#39;s difficult to comment on what the problem might be."}, {"owner": {"reputation": 1492, "user_id": 1091396, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/YtJY5.gif?s=128&g=1", "display_name": "ymg", "link": "https://stackoverflow.com/users/1091396/ymg"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1421592255, "post_id": 28004103, "comment_id": 44409381, "body": "@3of3 the code is pretty much what you see in <code>hasher_test.go</code> but I will create a gist anyway."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1421593885, "post_id": 28004103, "comment_id": 44409834, "body": "Not that this is cause of the problem, but the code is not following the Mozilla recommendation of storing the extra salt outside of the database. By storing the salt in the database, the system is no more secure than using just bcrypt alone."}, {"owner": {"reputation": 1492, "user_id": 1091396, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/YtJY5.gif?s=128&g=1", "display_name": "ymg", "link": "https://stackoverflow.com/users/1091396/ymg"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1421594265, "post_id": 28004103, "comment_id": 44409943, "body": "@3of3 I do know I&#39;m not following the exact guide like you said I am still not saving the salt on a different db, this will change but for now I am failing to come up with correct behavior as you can see"}], "answers": [{"tags": [], "owner": {"reputation": 4254, "user_id": 1351597, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6e2b94150c4f96fe11dae1494a054f7b?s=128&d=identicon&r=PG", "display_name": "Dekker1", "link": "https://stackoverflow.com/users/1351597/dekker1"}, "is_accepted": false, "score": 1, "last_activity_date": 1421530936, "creation_date": 1421530936, "answer_id": 28004650, "question_id": 28004103, "link": "https://stackoverflow.com/questions/28004103/storing-crypto-rand-generated-string-issues/28004650#28004650", "title": "Storing crypto/rand generated string issues", "body": "<p>It seems you forgot that the generated hashes are hex encoded, thus when casting the []byte variable to a string you'll get something weird. Using the hex package you can create the actual string you want:</p>\n\n<pre><code>hex.EncodeToString(hash)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1421595022, "creation_date": 1421595022, "answer_id": 28011412, "question_id": 28004103, "link": "https://stackoverflow.com/questions/28004103/storing-crypto-rand-generated-string-issues/28011412#28011412", "title": "Storing crypto/rand generated string issues", "body": "<p>The salt does not roundtrip through the JSON encode / decode because the salt is not valid UTF8.</p>\n\n<p>There are a few ways to fix the problem:</p>\n\n<ul>\n<li>Hex or base64 encode / decode the salt in hasher.</li>\n<li>Use the []byte type for salt throughout the code. The JSON encoder encodes []byte values using base64. </li>\n<li>Use the gob encoder instead of the JSON encoder.</li>\n</ul>\n\n<p>Mozilla recommends storing the extra salt separate from the bcrypted password. By storing the extra salt with the bcrypted password, the system is no more secure than using bcrypt alone.</p>\n\n<p>To hex encode the salt, change </p>\n\n<pre><code>return string(p), string(salt), nil\n</code></pre>\n\n<p>to</p>\n\n<pre><code>return string(p), hex.EncodeToString(salt), nil\n</code></pre>\n\n<p>and change </p>\n\n<pre><code>    s := []byte(salt)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>    s, err := hex.DecodeString(salt)\n    if err != nil {\n       return err\n    }\n</code></pre>\n"}], "owner": {"reputation": 1492, "user_id": 1091396, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/YtJY5.gif?s=128&g=1", "display_name": "ymg", "link": "https://stackoverflow.com/users/1091396/ymg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 28011412, "answer_count": 2, "score": -1, "last_activity_date": 1421595022, "creation_date": 1421527332, "last_edit_date": 1421592947, "question_id": 28004103, "link": "https://stackoverflow.com/questions/28004103/storing-crypto-rand-generated-string-issues", "title": "Storing crypto/rand generated string issues", "body": "<p>So I have the following <a href=\"https://gist.github.com/ymg/0c6e5680aabca60871db\" rel=\"nofollow noreferrer\"><strong>go file(s)</strong></a> as part of my project to be used for hashing passwords, I also wrote some tests that to my knowledge have yet to fail.</p>\n\n<p>Currently the issue is that I am trying to store the password and salt in some database as strings, and every time I retrieve them to be compared against a another string I keep getting the message in the picture from golang's bcrypt package. The tests I wrote are running fine and produce the appropriate effect. I would have supplied a go playground link but bcrypt package is part of the standard library.</p>\n\n<p>I know the gibberish from <code>crypto/rand</code> is pretty much the same from the initial look but I am not sure if there is anything being changed on the database. I am using redis fyi.</p>\n\n<p><strong>Edit</strong>: based on the request of @3of3, I am including the <a href=\"https://gist.github.com/ymg/bf360ef0ed88fde5e2d6\" rel=\"nofollow noreferrer\"><strong>DAO</strong></a> code from my project. Also the bcrypt only solution worked with this code but as I stated in the comments, I am aiming to stick to Mozilla's guide.</p>\n\n<p><img src=\"https://i.stack.imgur.com/K6rwy.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 9139, "user_id": 773228, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/baaecdda322cf4462a0dd018d7959b1e?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Wood", "link": "https://stackoverflow.com/users/773228/justin-wood"}, "edited": false, "score": 0, "creation_date": 1421525418, "post_id": 28003727, "comment_id": 44396214, "body": "With this project layout, it would make a mess out of your <code>$GOPATH</code> variable. While it is still possible, it is generally not advised. Though, if you do end up using this type of layout, you may want to look into git submodules."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1421525549, "post_id": 28003727, "comment_id": 44396253, "body": "I&#39;m not sure it&#39;s possible to give an answer that covers all situations, but the <a href=\"https://github.com/youtube/vitess/\" rel=\"nofollow noreferrer\">Vitess MySQL proxy</a> at Google has subdirectories for the parts in Go, Java, etc. They don&#39;t seem to really define &#39;subprojects&#39; like that even though their app is multiple binaries (maybe they the binaries some packages)."}, {"owner": {"reputation": 4811, "user_id": 2874789, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/VKbXD.jpg?s=128&g=1", "display_name": "Christopher Shroba", "link": "https://stackoverflow.com/users/2874789/christopher-shroba"}, "edited": false, "score": 0, "creation_date": 1421525653, "post_id": 28003727, "comment_id": 44396277, "body": "I think I could solve the <code>$GOPATH</code> problem with a one-line shell script in each subproject&#39;s root directory that exports the correct path for that?"}, {"owner": {"reputation": 4811, "user_id": 2874789, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/VKbXD.jpg?s=128&g=1", "display_name": "Christopher Shroba", "link": "https://stackoverflow.com/users/2874789/christopher-shroba"}, "edited": false, "score": 0, "creation_date": 1421525827, "post_id": 28003727, "comment_id": 44396334, "body": "Would it be more correct to just make multiple repos and namespace them (i.e. call them <code>projectname-api</code>, <code>projectname-queuer</code>, etc?"}, {"owner": {"reputation": 8119, "user_id": 1698887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fe33350fa65be5a2630271b0782b0096?s=128&d=identicon&r=PG", "display_name": "Daniel Williams", "link": "https://stackoverflow.com/users/1698887/daniel-williams"}, "edited": false, "score": 0, "creation_date": 1421528626, "post_id": 28003727, "comment_id": 44397097, "body": "The Vitess project is very interesting. As you can see from their Makefile they handle the multiple languages well. <a href=\"https://github.com/youtube/vitess/blob/master/Makefile\" rel=\"nofollow noreferrer\">github.com/youtube/vitess/blob/master/Makefile</a>"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1421569227, "post_id": 28003727, "comment_id": 44404604, "body": "Would advise against multiple <code>GOPATH</code>s -- better for pieces of your app to live under one workspace, be <code>go get</code>able, be able to share code with each other transparently, and for you to have just one environment to manage. For what it&#39;s worth, here&#39;s someone on that exact topic: <a href=\"http://mwholt.blogspot.com/2014/02/why-i-use-just-one-gopath.html\" rel=\"nofollow noreferrer\">mwholt.blogspot.com/2014/02/why-i-use-just-one-gopath.html</a>"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1421569657, "post_id": 28003727, "comment_id": 44404674, "body": "Under that <code>GOPATH</code> you might put the <code>package main</code>s for your binaries under <code>domain.com&#47;user&#47;proj&#47;cmd&#47;api</code>, <code>domain.com&#47;user&#47;proj&#47;cmd&#47;queue</code>, etc., with most of their guts living as package under <code>domain.com&#47;user&#47;proj&#47;topic</code> (or just <code>domain.com&#47;user&#47;topic</code> if it&#39;s a library you want to treat as an independent product). (<code>domain.com&#47;user</code> is a standin for <code>github.com&#47;username</code>, but maybe you don&#39;t need <code>&#47;user</code> where you host your repository) Those are long names names but systematic at least."}], "owner": {"reputation": 4811, "user_id": 2874789, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/VKbXD.jpg?s=128&g=1", "display_name": "Christopher Shroba", "link": "https://stackoverflow.com/users/2874789/christopher-shroba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1421525242, "creation_date": 1421524931, "last_edit_date": 1421525242, "question_id": 28003727, "link": "https://stackoverflow.com/questions/28003727/organizing-a-go-project-that-includes-codes-in-other-languages", "title": "Organizing a go project that includes codes in other languages", "body": "<p>I am currently working on a project that has several parts.  Some of these parts are written entirely in Go, and some are written in other languages including python.  What is the recommended way to organize my project's structure?  I would like all parts to be in one Git repository.  I am familiar with the guidelines outlined in <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow\">How to Write Go Code</a>, but it doesn't seem right to have python code in the same place as Go code.</p>\n\n<p>Would something like this make sense?</p>\n\n<pre><code>myproject\n\u251c\u2500\u2500 go-subproject1/\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 bin/\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 pkg/\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 src/\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 bar.go\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 foo.go\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 main.go\n\u251c\u2500\u2500 go-subproject2/\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 bin/\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 pkg/\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 src/\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 bar.go\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 foo.go\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 main.go\n\u2514\u2500\u2500 python-subproject/\n    \u2514\u2500\u2500 src/\n        \u2514\u2500\u2500 com/\n            \u251c\u2500\u2500 __init__.py\n            \u2514\u2500\u2500 myusername/\n                \u251c\u2500\u2500 __init__.py\n                \u2514\u2500\u2500 api/\n                    \u251c\u2500\u2500 __init__.py\n                    \u251c\u2500\u2500 bar.py\n                    \u2514\u2500\u2500 main.py\n</code></pre>\n"}, {"tags": ["go", "extensibility", "eventemitter", "plugin-architecture"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4122236"}, "edited": false, "score": 1, "creation_date": 1421514501, "post_id": 28001872, "comment_id": 44392979, "body": "See the database/sql and database/sql/driver packages for an example of a plugin architecture. In this architecture, plugins <a href=\"http://godoc.org/database/sql#Register\" rel=\"nofollow noreferrer\">register</a> from init() functions and implement interfaces as defined by the driver package."}], "answers": [{"tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 34, "last_activity_date": 1442181367, "last_edit_date": 1442181367, "creation_date": 1421521336, "answer_id": 28003144, "question_id": 28001872, "link": "https://stackoverflow.com/questions/28001872/golang-events-eventemitter-dispatcher-for-plugin-architecture/28003144#28003144", "title": "Golang events: EventEmitter / dispatcher for plugin architecture", "body": "<p>In general, in Go, if you need events you probably need to use channels, but if you need plugins, the way to go is \ninterfaces. Here's a bit lengthy example of a simple plugin architecture that minimizes the code that needs to be \nwritten in the app's main file to add plugins (this can be automated but not dnyamic, see below). </p>\n\n<p>I hope it's in the direction you're looking for.</p>\n\n<hr>\n\n<p><strong>1. The Plugin Interfaces</strong></p>\n\n<p>So okay, let's say we have two plugins, Fooer and Doer. We first define their interfaces:</p>\n\n<pre><code>// All DoerPlugins can do something when you call that method\ntype DoerPlugin interface {\n    DoSomething() \n}\n\n// All FooerPlugins can Foo() when you want them too\ntype FooerPlugin interface {\n    Foo()\n}\n</code></pre>\n\n<hr>\n\n<p><strong>2. The Plugin Registry</strong></p>\n\n<p>Now, our core app has a plugin registry. I'm doing something quicky and dirty here, just to get the idea across:</p>\n\n<pre><code>package plugin_registry\n\n// These are are registered fooers\nvar Fooers = []FooerPlugin{}\n\n// Thes are our registered doers\nvar Doers = []DoerPlugin{}\n</code></pre>\n\n<p>Now we expose methods to add plugins to the registry. The simple way is to add one per type, but you could\ngo with more complex reflection stuff and have one function. But usually in Go, try to keep things simple :)</p>\n\n<pre><code>package plugin_registry\n\n// Register a FooerPlugin\nfunc  RegisterFooer(f FooerPlugin) {\n    Fooers = append(Fooers, f)\n}\n\n// Register a DoerPlugin\nfunc RegisterDoer(d DoerPlugin) {\n    Doers = append(Doers, d)\n}\n</code></pre>\n\n<hr>\n\n<p><strong>3. Implementing and registering a plugin</strong></p>\n\n<p>Now, suppose this is your plugin module. We create a plugin that is a doer, and in our package's \n<code>init()</code> method we register it. init() happens once on program started for every imported package.</p>\n\n<pre><code>package myplugin \n\nimport (\n    \"github.com/myframework/plugin_registry\"\n)\ntype MyPlugin struct {\n    //whatever\n}\n\nfunc (m *MyPlugin)DoSomething() {\n    fmt.Println(\"Doing something!\")\n}\n</code></pre>\n\n<p>Again, here is the \"init magic\" that registers the package automatically</p>\n\n<pre><code>func init() {\n    my := &amp;MyPlugin{}\n    plugin_registry.RegisterDoer(my)\n}\n</code></pre>\n\n<hr>\n\n<p><strong>4. Importing the plugins registers them automatically</strong></p>\n\n<p>And now, the only thing we'll need to change is what we import into our main package. Since \nGo doesn't have dynamic imports or linking, this is the only thing you'll need to write. \nIt's pretty trivial to create a <code>go generate</code> script that will generate a main file\nby looking into the file tree or a config file and finding all the plugins you need to import. \nIt's not dynamic but it can be automated. Because main imports the plugin for the side effect of the registration, the import <a href=\"https://golang.org/doc/effective_go.html#blank_import\">uses the blank identifier to avoid unused import error</a>.</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/myframework/plugin_registry\"\n\n    _ \"github.com/d00dzzzzz/myplugin\" //importing this will automaticall register the plugin\n)\n</code></pre>\n\n<hr>\n\n<p><strong>5. In the app's core</strong></p>\n\n<p>And now our core app doesn't need any code to change to be able to interact with plugins:</p>\n\n<pre><code>func main() {\n\n\n    for _, d := range plugin_registry.Doers {\n        d.DoSomething()\n    }\n\n    for _, f := range plugin_registry.Fooers {\n        f.Foo()\n    }\n\n}\n</code></pre>\n\n<p>And that's about it. Keep in mind that the plugin registry should be a separate package\nthat both the app's core and the plugins can import, so you won't have circular imports. </p>\n\n<p>Of course you can add event handlers to this mix, but as I've demonstrated, it's not needed.</p>\n"}], "owner": {"reputation": 1751, "user_id": 3973406, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b2d94768947ebd5fd0f38ee5b3f472c5?s=128&d=identicon&r=PG&f=1", "display_name": "Dac0d3r", "link": "https://stackoverflow.com/users/3973406/dac0d3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9174, "favorite_count": 7, "accepted_answer_id": 28003144, "answer_count": 1, "score": 12, "last_activity_date": 1454173362, "creation_date": 1421513708, "last_edit_date": 1442181622, "question_id": 28001872, "link": "https://stackoverflow.com/questions/28001872/golang-events-eventemitter-dispatcher-for-plugin-architecture", "title": "Golang events: EventEmitter / dispatcher for plugin architecture", "body": "<p>In Node.js I was able to make a WordPress clone rather easily using the EventEmitter to replicate and build a hooks-system into the CMS core, which plugins could then attach to.</p>\n\n<p>I now need this same level of extensibility and core isolation for my CMS written in and ported to Go. Basically I have the core finished now, but in order to make it truly flexible I have to be able to insert events (hooks) and to have plugins attach to these hooks with additional functionality.</p>\n\n<p>I don't care about recompiling (dynamic / static linking), as long as you don't have to modify the core to load plugins - the CMS core should never be modified. (like WP, Drupal etc.)</p>\n\n<p>I noticed there's a few rather unknown projects, trying to implement events in Go looking somewhat similar to EventEmitter in Node.js:</p>\n\n<p><a href=\"https://github.com/CHH/eventemitter\">https://github.com/CHH/eventemitter</a></p>\n\n<p><a href=\"https://github.com/chuckpreslar/emission\">https://github.com/chuckpreslar/emission</a></p>\n\n<p>Since those 2 projects above haven't gained much popularity and attention somehow I feel this way of thinking about events might now be how we should do it in Go? Does this mean Go is maybe not geared to this task? To make truly extendable applications through plugins?</p>\n\n<p>Doesn't seem like Go has events built into its core, and RPC doesn't seem like a valid solution for integrating plugins into your core application as were they built in natively, and as if they were part of the main application itself.</p>\n\n<p>What's the best way for seamless plugin integration into your core app, for unlimited extension points (in core) without manipulating core every time you need to hook up a new plugin?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 11326, "user_id": 2328763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/849491de0be9b3cdf39c96b4c6b32e2b?s=128&d=identicon&r=PG", "display_name": "Alper", "link": "https://stackoverflow.com/users/2328763/alper"}, "is_accepted": true, "score": 6, "last_activity_date": 1421511339, "last_edit_date": 1421511339, "creation_date": 1421510856, "answer_id": 28001391, "question_id": 28001040, "link": "https://stackoverflow.com/questions/28001040/filling-struct-array-in-golang/28001391#28001391", "title": "Filling struct array in golang", "body": "<p>Something like below</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    type NeoCoverage struct {\n        Name   string\n        Number string\n    }\n\n    type Coverage struct {\n        neoCoverage []NeoCoverage\n    }\n\n    coverage := Coverage {\n        neoCoverage: []NeoCoverage {\n            NeoCoverage{ Name: \"xyz\", Number: \"xyz123\" },\n            NeoCoverage{ Name: \"abc\", Number: \"abc123\" },\n        },\n    }\n\n    fmt.Println(coverage)\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>{[{xyz xyz123} {abc abc123}]}\n</code></pre>\n\n<p>Here is the brief explanation; <code>neoCoverage: []NeoCoverage{}</code> stands for the slice of <code>NeoCoverage</code> and that slice should be populated with <code>NeoCoverage{}</code> elements as in <code>NeoCoverage{ Name: \"xyz\", Number: \"xyz123\" }, ...</code></p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 5054699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1842f9bf6849a45b7c9d86f00e49934b?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Donahue", "link": "https://stackoverflow.com/users/5054699/doug-donahue"}, "is_accepted": false, "score": 5, "last_activity_date": 1494285480, "last_edit_date": 1494285480, "creation_date": 1494285025, "answer_id": 43858593, "question_id": 28001040, "link": "https://stackoverflow.com/questions/28001040/filling-struct-array-in-golang/43858593#43858593", "title": "Filling struct array in golang", "body": "<p>You can also omit the redundant Type declarations in the array. Using Alper's code base as example.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    type NeoCoverage struct {\n         Name   string\n         Number string\n    }\n\n    type Coverage struct {\n        neoCoverage []NeoCoverage\n    }\n\n    coverage := Coverage {\n        neoCoverage: []NeoCoverage {\n            { Name: \"xyz\", Number: \"xyz123\" },\n            { Name: \"abc\", Number: \"abc123\" },\n        },\n    }\n\n    fmt.Println(coverage)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>{[{xyz xyz123} {abc abc123}]}\n</code></pre>\n"}], "owner": {"reputation": 825, "user_id": 2278893, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/Et28N.jpg?s=128&g=1", "display_name": "Akash Shinde", "link": "https://stackoverflow.com/users/2278893/akash-shinde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9579, "favorite_count": 1, "accepted_answer_id": 28001391, "answer_count": 2, "score": 4, "last_activity_date": 1494285480, "creation_date": 1421508783, "question_id": 28001040, "link": "https://stackoverflow.com/questions/28001040/filling-struct-array-in-golang", "title": "Filling struct array in golang", "body": "<p>I have struct like </p>\n\n<pre><code>type Coverage struct {\n  neoCoverage        []NeoCoverage\n  ApocCoverage       []ApocCoverage\n  ApocConfigCoverage []ApocConfigCoverage\n}\n</code></pre>\n\n<p><strong>And</strong></p>\n\n<pre><code>type NeoCoverage struct {\n  Name   string\n  Number string\n}\n</code></pre>\n\n<p>So how should i fill coverage struct?</p>\n\n<p>Here how I am Trying.</p>\n\n<pre><code>coverage = Coverage{\n []neoCoverage: NeoCoverage{\n     Name:   \"xyz\",\n     Number: \"xyz123\",\n   },\n }\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1079, "user_id": 112335, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a53edef395e43b93f8b0f7d662b72ca3?s=128&d=identicon&r=PG", "display_name": "Saulo Silva", "link": "https://stackoverflow.com/users/112335/saulo-silva"}, "edited": false, "score": 0, "creation_date": 1421558761, "post_id": 28005189, "comment_id": 44403049, "body": "Yep, that&#39;s the workaround I had in mind as well. Using the capture group would have been a more elegant solution, though. Too bad we can&#39;t do that with <code>ReplaceAllFunc()</code>..."}], "tags": [], "owner": {"reputation": 1903, "user_id": 1549474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2766dac2718e51b8c5f4f021c8e740c4?s=128&d=identicon&r=PG", "display_name": "tumdum", "link": "https://stackoverflow.com/users/1549474/tumdum"}, "is_accepted": false, "score": 6, "last_activity_date": 1421536081, "last_edit_date": 1421536081, "creation_date": 1421534873, "answer_id": 28005189, "question_id": 28000832, "link": "https://stackoverflow.com/questions/28000832/how-to-access-a-capturing-group-from-regexp-replaceallfunc/28005189#28005189", "title": "How to access a capturing group from regexp.ReplaceAllFunc?", "body": "<p>I agree that having access to capture group while inside of your function would be ideal, I don't think it's possible with <code>regexp.ReplaceAllFunc</code>.\nOnly thing that comes to my mind right now regard how to do this with that function is this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n)\n\nfunc main() {\n    body := []byte(\"Visit this page: [PageName] [OtherPageName]\")\n    search := regexp.MustCompile(\"\\\\[[a-zA-Z]+\\\\]\")\n    body = search.ReplaceAllFunc(body, func(s []byte) []byte {\n        m := string(s[1 : len(s)-1])\n        return []byte(\"&lt;a href=\\\"/view/\" + m + \"\\\"&gt;\" + m + \"&lt;/a&gt;\")\n    })\n    fmt.Println(string(body))\n}\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>There is one other way I know how to do what you want. First thing you need to know is that you can specify non capturing group using syntax <code>(?:re)</code> where <code>re</code> is your regular expression. This is not essential, but will reduce number of not interesting matches.</p>\n\n<p>Next thing to know is <a href=\"http://golang.org/pkg/regexp/#Regexp.FindAllSubmatchIndex\" rel=\"noreferrer\">regexp.FindAllSubmatcheIndex</a>. It will return slice of slices, where each internal slice represents ranges of <strong>all</strong> submatches for given matching of regexp.</p>\n\n<p>Having this two things, you can construct somewhat generic solution:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n)\n\nfunc ReplaceAllSubmatchFunc(re *regexp.Regexp, b []byte, f func(s []byte) []byte) []byte {\n    idxs := re.FindAllSubmatchIndex(b, -1)\n    if len(idxs) == 0 {\n        return b\n    }\n    l := len(idxs)\n    ret := append([]byte{}, b[:idxs[0][0]]...)\n    for i, pair := range idxs {\n        // replace internal submatch with result of user supplied function\n        ret = append(ret, f(b[pair[2]:pair[3]])...)\n        if i+1 &lt; l {\n            ret = append(ret, b[pair[1]:idxs[i+1][0]]...)\n        }\n    }\n    ret = append(ret, b[idxs[len(idxs)-1][1]:]...)\n    return ret\n}\n\nfunc main() {\n    body := []byte(\"Visit this page: [PageName] [OtherPageName][XYZ]     [XY]\")\n    search := regexp.MustCompile(\"(?:\\\\[)([a-zA-Z]+)(?:\\\\])\")\n\n    body = ReplaceAllSubmatchFunc(search, body, func(s []byte) []byte {\n        m := string(s)\n        return []byte(\"&lt;a href=\\\"/view/\" + m + \"\\\"&gt;\" + m + \"&lt;/a&gt;\")\n    })\n\n    fmt.Println(string(body))\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1808, "user_id": 526592, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/CIOPH.png?s=128&g=1", "display_name": "Pepster", "link": "https://stackoverflow.com/users/526592/pepster"}, "is_accepted": false, "score": 0, "last_activity_date": 1511343485, "creation_date": 1511343485, "answer_id": 47431174, "question_id": 28000832, "link": "https://stackoverflow.com/questions/28000832/how-to-access-a-capturing-group-from-regexp-replaceallfunc/47431174#47431174", "title": "How to access a capturing group from regexp.ReplaceAllFunc?", "body": "<p>You have to call <code>ReplaceAllFunc</code> first and within the function call <code>FindStringSubmatch</code> on the same regex again. Like:</p>\n\n<pre><code>func (p parser) substituteEnvVars(data []byte) ([]byte, error) {\n    var err error\n    substituted := p.envVarPattern.ReplaceAllFunc(data, func(matched []byte) []byte {\n        varName := p.envVarPattern.FindStringSubmatch(string(matched))[1]\n        value := os.Getenv(varName)\n        if len(value) == 0 {\n            log.Printf(\"Fatal error substituting environment variable %s\\n\", varName)\n        }\n\n        return []byte(value)\n    });\n    return substituted, err\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1079, "user_id": 112335, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a53edef395e43b93f8b0f7d662b72ca3?s=128&d=identicon&r=PG", "display_name": "Saulo Silva", "link": "https://stackoverflow.com/users/112335/saulo-silva"}, "edited": false, "score": 0, "creation_date": 1578405448, "post_id": 59596996, "comment_id": 105421557, "body": "I&#39;ll pick this as the new accepted answer as it is closer to what I was looking for."}], "tags": [], "owner": {"reputation": 56, "user_id": 9757644, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "iamdavidzeng", "link": "https://stackoverflow.com/users/9757644/iamdavidzeng"}, "is_accepted": true, "score": 2, "last_activity_date": 1578410451, "last_edit_date": 1578410451, "creation_date": 1578197919, "answer_id": 59596996, "question_id": 28000832, "link": "https://stackoverflow.com/questions/28000832/how-to-access-a-capturing-group-from-regexp-replaceallfunc/59596996#59596996", "title": "How to access a capturing group from regexp.ReplaceAllFunc?", "body": "<p>If you want to get group in <code>ReplaceAllFunc</code>, you can use <code>ReplaceAllString</code> to get the subgroup.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n)\n\nfunc main() {\n    body := []byte(\"Visit this page: [PageName]\")\n    search := regexp.MustCompile(\"\\\\[([a-zA-Z]+)\\\\]\")\n\n    body = search.ReplaceAllFunc(body, func(s []byte) []byte {\n        // How can I access the capture group here?\n        group := search.ReplaceAllString(string(s), `$1`)\n\n        fmt.Println(group)\n\n        // handle group as you wish\n        newGroup := \"&lt;a href='/view/\" + group + \"'&gt;\" + group + \"&lt;/a&gt;\"\n        return []byte(newGroup)\n    })\n\n    fmt.Println(string(body))\n}\n</code></pre>\n\n<p>And when there are many groups, you are able to get each group by this way, then handle each group and return desirable value.</p>\n"}], "owner": {"reputation": 1079, "user_id": 112335, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a53edef395e43b93f8b0f7d662b72ca3?s=128&d=identicon&r=PG", "display_name": "Saulo Silva", "link": "https://stackoverflow.com/users/112335/saulo-silva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1714, "favorite_count": 1, "accepted_answer_id": 59596996, "answer_count": 3, "score": 8, "last_activity_date": 1578410451, "creation_date": 1421507530, "last_edit_date": 1421512899, "question_id": 28000832, "link": "https://stackoverflow.com/questions/28000832/how-to-access-a-capturing-group-from-regexp-replaceallfunc", "title": "How to access a capturing group from regexp.ReplaceAllFunc?", "body": "<p>How can I access a capture group from inside ReplaceAllFunc()?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n)\n\nfunc main() {\n    body := []byte(\"Visit this page: [PageName]\")\n    search := regexp.MustCompile(\"\\\\[([a-zA-Z]+)\\\\]\")\n\n    body = search.ReplaceAllFunc(body, func(s []byte) []byte {\n        // How can I access the capture group here?\n    })\n\n    fmt.Println(string(body))\n}\n</code></pre>\n\n<p>The goal is to replace <code>[PageName]</code> with <code>&lt;a href=\"/view/PageName\"&gt;PageName&lt;/a&gt;</code>.</p>\n\n<p>This is the last task under the \"Other tasks\" section at the bottom of the <a href=\"https://golang.org/doc/articles/wiki/\" rel=\"noreferrer\">Writing Web Applications</a> Go tutorial.</p>\n"}, {"tags": ["http", "go", "dns", "server"], "comments": [{"owner": {"reputation": 4663, "user_id": 3967089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77d00715119003023d62918dcc603ca7?s=128&d=identicon&r=PG&f=1", "display_name": "Calle Dybedahl", "link": "https://stackoverflow.com/users/3967089/calle-dybedahl"}, "edited": false, "score": 1, "creation_date": 1421514400, "post_id": 27999870, "comment_id": 44392954, "body": "Don&#39;t be discouraged by the earlier replies. Go read RFC 1035 and start coding. Yes, there&#39;s an enormous amount of complexity that&#39;s been added after that, but if all you want to do is to respond to a few basic queries you don&#39;t need any of it."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 2, "last_activity_date": 1421502003, "last_edit_date": 1421502003, "creation_date": 1421501594, "answer_id": 27999977, "question_id": 27999870, "link": "https://stackoverflow.com/questions/27999870/what-does-a-dns-query-look-like/27999977#27999977", "title": "What does a DNS query look like?", "body": "<p>You could check out the <a href=\"https://github.com/miekg/dns\" rel=\"nofollow\"><code>miekg/dns</code></a> project.<br>\nIt builds <a href=\"https://github.com/miekg/dns/blob/877e47b4c3dbf1d632c9abe2a0960123f65bf222/msg.go#L77\" rel=\"nofollow\">Msg</a> compose of a <a href=\"https://github.com/miekg/dns/blob/877e47b4c3dbf1d632c9abe2a0960123f65bf222/msg.go#L59-L73\" rel=\"nofollow\"><code>MsgHdr</code></a> which includes the <a href=\"http://OpcodeToString\" rel=\"nofollow\">QUERY code</a> (amongst <a href=\"http://OpcodeToString\" rel=\"nofollow\">other OpCodes</a>).  </p>\n\n<p>That follows the Message Header you can see in \"<a href=\"http://www.zytrax.com/books/dns/ch15/\" rel=\"nofollow\">Chapter 15 DNS Messages</a>\".</p>\n"}], "owner": {"reputation": 829, "user_id": 3810411, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/49b1176f69fe5b10313cd0f45b68495b?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/3810411/francis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 752, "favorite_count": 1, "accepted_answer_id": 27999977, "answer_count": 1, "score": 0, "last_activity_date": 1421502003, "creation_date": 1421500915, "question_id": 27999870, "link": "https://stackoverflow.com/questions/27999870/what-does-a-dns-query-look-like", "title": "What does a DNS query look like?", "body": "<p>I'd like to make a simple DNS server using Go. I know how DNS works but I'm not 100% sure as to how a DNS query actually looks.</p>\n\n<p>For example, a HTTP GET request looks like this:</p>\n\n<pre><code>GET /index.html HTTP/1.1\n</code></pre>\n\n<p>So my question is, does a DNS query look something like this:</p>\n\n<pre><code>QUERY google.com A\n</code></pre>\n\n<p>Or do DNS servers interpret the binary representation the domain name being queried?</p>\n"}, {"tags": ["select", "go", "channel"], "answers": [{"comments": [{"owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 0, "creation_date": 1421501101, "post_id": 27999879, "comment_id": 44389070, "body": "In addition, take into account that if both requestChan and doneChan have data, select may pick doneChan first, and the for loop will exit before all data is read from requestChan."}, {"owner": {"reputation": 5222, "user_id": 818420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6a3ae1214b4d2450f85a2039c38af7f1?s=128&d=identicon&r=PG", "display_name": "Toni C&#225;rdenas", "link": "https://stackoverflow.com/users/818420/toni-c%c3%a1rdenas"}, "reply_to_user": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 1, "creation_date": 1421501107, "post_id": 27999879, "comment_id": 44389072, "body": "By the way, providing a valid example of your problem in the Go Playground helps focusing the discussion and is appreciated by answerers. :)"}], "tags": [], "owner": {"reputation": 5222, "user_id": 818420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6a3ae1214b4d2450f85a2039c38af7f1?s=128&d=identicon&r=PG", "display_name": "Toni C&#225;rdenas", "link": "https://stackoverflow.com/users/818420/toni-c%c3%a1rdenas"}, "is_accepted": true, "score": 2, "last_activity_date": 1421500962, "creation_date": 1421500962, "answer_id": 27999879, "question_id": 27999795, "link": "https://stackoverflow.com/questions/27999795/golang-channel-in-select-statement-is-only-receiving-sometimes/27999879#27999879", "title": "golang: channel in select statement is only receiving sometimes (???)", "body": "<p>Most likely, your <code>main</code> is exiting before the other goroutine finalised. Note that they're concurrent, and once <code>main</code> finishes, all other goroutines are killed.</p>\n\n<p>You need to explicitly synchronize the end of your goroutines with <code>main</code>. <a href=\"http://play.golang.org/p/q7MWWx_9fp\" rel=\"nofollow\">You can use sync.WaitGroup for that</a>, or another channel.</p>\n"}], "owner": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "accepted_answer_id": 27999879, "answer_count": 1, "score": 0, "last_activity_date": 1421500962, "creation_date": 1421500338, "question_id": 27999795, "link": "https://stackoverflow.com/questions/27999795/golang-channel-in-select-statement-is-only-receiving-sometimes", "title": "golang: channel in select statement is only receiving sometimes (???)", "body": "<p>I have a select statement in a go routine that receives from two channels.</p>\n\n<pre><code>for {\n    fmt.Printf(\"Waiting for select statement ...\\n\")\n    select {\n    case req := &lt;-requestChan:\n        fmt.Printf(\"I got a request: %v\\n\", req)\n    case &lt;-doneChan:\n        fmt.Printf(\"serveDatabase: Got closing signal. Stop serving.\\n\")\n        return\n    }\n}\n</code></pre>\n\n<p>If the calling function sends to first channel twice and then to second channel everything works fine:</p>\n\n<pre><code>requestChan &lt;- Db_request{ request: \"Login\", beehive: \"yaylaswiese\" }\nrequestChan &lt;- Db_request{ request: \"Signup\", beehive: \"aziz nezir\" }\n\nfmt.Printf(\"Sending true to the doneChannel\\n\")\ndoneChan &lt;- true\n</code></pre>\n\n<p>The console output (correctly) is:</p>\n\n<pre><code>&gt;     Waiting for select statement ...\n&gt;     I got a request: {Login yaylaswiese}\n&gt;     Waiting for select statement ...\n&gt;     Sending true to the doneChannel\n&gt;     I got a request: {Signup aziz nezir}\n&gt;     Waiting for select statement ...\n&gt;     serveDatabase: Got closing signal. Stop serving.\n</code></pre>\n\n<p>However, if I comment the second request like</p>\n\n<pre><code>requestChan &lt;- Db_request{ request: \"Login\", beehive: \"yaylaswiese\" }\n// requestChan &lt;- Db_request{ request: \"Signup\", beehive: \"aziz nezir\" }\n\nfmt.Printf(\"Sending true to the doneChannel\\n\")\ndoneChan &lt;- true\n</code></pre>\n\n<p>Then the output is</p>\n\n<pre><code>&gt;     Waiting for select statement ...\n&gt;     I got a request: {Login yaylaswiese}\n&gt;     Waiting for select statement ...\n&gt;     Sending true to the doneChannel\n</code></pre>\n\n<p>So the doneChan is never received. I tried also to go into a endless loop after sending doneChan, but it has the same result. </p>\n\n<p>What could that be?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12652725, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCI236pwSNYe9O76IDRz4B2mBhmT54pPybjCLhwyg=k-s128", "display_name": "Kuldeep Avsar", "link": "https://stackoverflow.com/users/12652725/kuldeep-avsar"}, "edited": false, "score": 0, "creation_date": 1586364802, "post_id": 27998834, "comment_id": 108103856, "body": "There is any way to do this without using any goquery package"}], "tags": [], "owner": {"reputation": 5222, "user_id": 818420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6a3ae1214b4d2450f85a2039c38af7f1?s=128&d=identicon&r=PG", "display_name": "Toni C&#225;rdenas", "link": "https://stackoverflow.com/users/818420/toni-c%c3%a1rdenas"}, "is_accepted": true, "score": 12, "last_activity_date": 1421493020, "creation_date": 1421493020, "answer_id": 27998834, "question_id": 27998747, "link": "https://stackoverflow.com/questions/27998747/parse-html-page-and-get-value-using-css-selector-in-golang/27998834#27998834", "title": "Parse html page and get value using css selector in golang", "body": "<p>You can use <a href=\"http://godoc.org/github.com/PuerkitoBio/goquery\" rel=\"noreferrer\">the github.com/PuerkitoBio/goquery package</a>. If you're familar with jQuery selectors, it won't be a problem for you.</p>\n\n<pre><code>doc, err := goquery.NewDocument(contents)\n// handle err\ndoc.Find(\".funcname\")\n</code></pre>\n"}], "owner": {"reputation": 825, "user_id": 2278893, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/Et28N.jpg?s=128&g=1", "display_name": "Akash Shinde", "link": "https://stackoverflow.com/users/2278893/akash-shinde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4638, "favorite_count": 2, "accepted_answer_id": 27998834, "answer_count": 1, "score": 4, "last_activity_date": 1421493020, "creation_date": 1421492443, "question_id": 27998747, "link": "https://stackoverflow.com/questions/27998747/parse-html-page-and-get-value-using-css-selector-in-golang", "title": "Parse html page and get value using css selector in golang", "body": "<p>I want to parse value of particular div of HTML.Eg.I have class like <strong>\"funcname\"</strong> so can i parse value at this div in golang?</p>\n"}, {"tags": ["linux", "go", "cross-compiling", "archlinux"], "answers": [{"comments": [{"owner": {"reputation": 7665, "user_id": 1298153, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b5cb7d1ef995d0a6ba53980b5419b5d0?s=128&d=identicon&r=PG", "display_name": "m01", "link": "https://stackoverflow.com/users/1298153/m01"}, "edited": false, "score": 0, "creation_date": 1434839471, "post_id": 27998590, "comment_id": 49951678, "body": "So is it not possible to setup cross-compilation on Arch Linux with Go 1.4? Or is there some workaround?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 7665, "user_id": 1298153, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b5cb7d1ef995d0a6ba53980b5419b5d0?s=128&d=identicon&r=PG", "display_name": "m01", "link": "https://stackoverflow.com/users/1298153/m01"}, "edited": false, "score": 2, "creation_date": 1434862761, "post_id": 27998590, "comment_id": 49955085, "body": "@m01 not that I know of. Go 1.5 will make cross-compilation dead-simple though: <a href=\"http://stackoverflow.com/a/28829037/6309\">stackoverflow.com/a/28829037/6309</a>, and <a href=\"https://github.com/golang/go/wiki/GoTalks#go-in-go\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/GoTalks#go-in-go</a>, like <a href=\"https://talks.golang.org/2015/gogo.slide#18\" rel=\"nofollow noreferrer\">talks.golang.org/2015/gogo.slide#18</a>, using goos and goarch presented in <a href=\"http://stackoverflow.com/a/30068222/6309\">stackoverflow.com/a/30068222/6309</a>."}, {"owner": {"reputation": 7665, "user_id": 1298153, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b5cb7d1ef995d0a6ba53980b5419b5d0?s=128&d=identicon&r=PG", "display_name": "m01", "link": "https://stackoverflow.com/users/1298153/m01"}, "edited": false, "score": 0, "creation_date": 1434966448, "post_id": 27998590, "comment_id": 49984204, "body": "Ok - sounds like my options are: go back to Go 1.3, go forward to the dev version of Go 1.5, or wait for Go 1.5 to be released. Thanks!"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 7665, "user_id": 1298153, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b5cb7d1ef995d0a6ba53980b5419b5d0?s=128&d=identicon&r=PG", "display_name": "m01", "link": "https://stackoverflow.com/users/1298153/m01"}, "edited": false, "score": 1, "creation_date": 1434970195, "post_id": 27998590, "comment_id": 49986363, "body": "@m01 I agree. Go 1.5 will be released in August, so in 2 months or so."}, {"owner": {"reputation": 1512, "user_id": 972241, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/244e67f2e3f35c3d7b325c7a389b9bbe?s=128&d=identicon&r=PG", "display_name": "xthexder", "link": "https://stackoverflow.com/users/972241/xthexder"}, "edited": false, "score": 0, "creation_date": 1438621053, "post_id": 27998590, "comment_id": 51513616, "body": "Since I&#39;ve run in to this many times, I thought I&#39;d add my workaround for using 1.4: Move <code>$GOROOT&#47;src&#47;cmd&#47;cmd&#47;pprof</code> to <code>$GOPATH&#47;src&#47;cmd&#47;cmd&#47;pprof</code> and everything should compile fine."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 2, "last_activity_date": 1421491092, "last_edit_date": 1592644375, "creation_date": 1421491092, "answer_id": 27998590, "question_id": 27997708, "link": "https://stackoverflow.com/questions/27997708/errors-setting-up-go-for-cross-compiling/27998590#27998590", "title": "Errors setting up Go for cross-compiling", "body": "<p>This error comes from <a href=\"https://github.com/golang/go/blob/9af454c588ee0bef7fc6ae588e2b2e866edcb915/src/cmd/go/pkg.go#L352\" rel=\"nofollow noreferrer\"><code>cmd/go/pkg.go#L358</code></a>, and a look at the blame view show this has been introduced by <a href=\"https://github.com/golang/go/commit/1338f327b2deb81ba81107b5033d1b10e97e3abe\" rel=\"nofollow noreferrer\">commit 1338f32</a> for go 1.4</p>\n<p>So the guide might work only with go 1.3-, not go 1.4, because of the <a href=\"https://docs.google.com/document/d/1e8kOo3r51b2BWtTs_1uADIA5djfXhPT36s6eHVRIvaU/edit\" rel=\"nofollow noreferrer\">Go 1.4 &quot;Internal&quot; Package proposition</a>.</p>\n<blockquote>\n<p>For Go 1.4, we will implement the rule first for <code>$GOROOT</code>, but not <code>$GOPATH</code>. We will use the compiler conversion and some minor uses in the standard library to gain experience with the rule.</p>\n<p>Due to an irregularity in the main repo, as a special case, the \u201c<code>/pkg/</code>\u201d element in <code>$GOROOT/src/pkg/\u2026</code> paths is considered not to exist.<br />\nThis means that <code>$GOROOT/src/pkg/internal</code> can be imported by <code>$GOROOT/src/cmd/\u2026</code> in addition to <code>$GOROOT/src/pkg/\u2026</code>.<br />\nThis special case will be removed when we move the standard library up to <code>$GOROOT/src/</code>.</p>\n</blockquote>\n"}], "owner": {"reputation": 2903, "user_id": 4257217, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/i1EYW.png?s=128&g=1", "display_name": "GreenRaccoon23", "link": "https://stackoverflow.com/users/4257217/greenraccoon23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 677, "favorite_count": 1, "accepted_answer_id": 27998590, "answer_count": 1, "score": 2, "last_activity_date": 1421491092, "creation_date": 1421483905, "question_id": 27997708, "link": "https://stackoverflow.com/questions/27997708/errors-setting-up-go-for-cross-compiling", "title": "Errors setting up Go for cross-compiling", "body": "<p>I'm using Linux 64-bit and I'm trying to set up Go for cross-compiling (for Windows, specifically). There's an awesome guide for this <a href=\"https://stackoverflow.com/questions/12168873/cross-compile-go-on-osx\">here</a>. But when I try to run the second command below:  </p>\n\n<pre><code>cd /usr/lib/go/src\nsudo GOOS=windows GOARCH=386 CGO_ENABLED=0 ./make.bash --no-clean\n</code></pre>\n\n<p>I get errors when it tries to build the <code>cmd</code> package. It says <code>use of internal package not allowed</code>. Is this a bug in Go's main source code? I'll paste the full list of errors.  </p>\n\n<pre><code># Building packages and commands for host, linux/amd64.\npackage cmd/cmd/pprof\n    imports cmd/pprof/internal/driver: use of internal package not allowed\npackage cmd/cmd/pprof\n    imports cmd/pprof/internal/fetch: use of internal package not allowed\npackage cmd/cmd/pprof\n    imports cmd/pprof/internal/symbolizer: use of internal package not allowed\npackage cmd/cmd/pprof\n    imports cmd/pprof/internal/symbolz: use of internal package not allowed\npackage cmd/cmd/pprof/internal/commands\n    imports cmd/pprof/internal/report: use of internal package not allowed\npackage cmd/cmd/pprof/internal/commands\n    imports cmd/pprof/internal/svg: use of internal package not allowed\npackage cmd/cmd/pprof/internal/commands\n    imports cmd/pprof/internal/tempfile: use of internal package not allowed\npackage cmd/cmd/pprof/internal/driver\n    imports cmd/pprof/internal/commands: use of internal package not allowed\npackage cmd/cmd/pprof/internal/driver\n    imports cmd/pprof/internal/report: use of internal package not allowed\npackage cmd/cmd/pprof/internal/driver\n    imports cmd/pprof/internal/tempfile: use of internal package not allowed\npackage cmd/cmd/pprof/internal/fetch\n    imports cmd/pprof/internal/plugin: use of internal package not allowed\npackage cmd/cmd/pprof/internal/fetch\n    imports cmd/pprof/internal/profile: use of internal package not allowed\npackage cmd/cmd/pprof/internal/plugin\n    imports cmd/pprof/internal/profile: use of internal package not allowed\npackage cmd/cmd/pprof/internal/report\n    imports cmd/pprof/internal/plugin: use of internal package not allowed\npackage cmd/cmd/pprof/internal/report\n    imports cmd/pprof/internal/profile: use of internal package not allowed\npackage cmd/cmd/pprof/internal/symbolizer\n    imports cmd/pprof/internal/plugin: use of internal package not allowed\npackage cmd/cmd/pprof/internal/symbolizer\n    imports cmd/pprof/internal/profile: use of internal package not allowed\npackage cmd/cmd/pprof/internal/symbolz\n    imports cmd/pprof/internal/profile: use of internal package not allowed\n</code></pre>\n\n<p>I can't find anything like this on Google, so that probably means I'm doing something wrong. I'm using Arch Linux, by the way, and I installed <code>Go</code> with <code>pacman</code>, not from source.</p>\n"}, {"tags": ["list", "loops", "go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1421463660, "last_edit_date": 1421463660, "creation_date": 1421463227, "answer_id": 27995703, "question_id": 27995531, "link": "https://stackoverflow.com/questions/27995531/how-to-construct-a-loop-in-a-list-in-golang/27995703#27995703", "title": "How to construct a loop in a list in golang", "body": "<p>It is not possible to construct a loop using the container/list <a href=\"http://godoc.org/container/list#List\" rel=\"nofollow\">List</a> type. The List type methods ensure that there's no loop. Because the list <a href=\"http://godoc.org/container/list#Element\" rel=\"nofollow\">Element</a>'s next and previous pointers are not exported, the application cannot create a loop by modifying the elements directly.</p>\n\n<p>You can define your own type to create a list with a loop:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype node struct {\n    v    int\n    next *node\n}\n\nfunc main() {\n    // Create list with 1, 2, 3 and print.\n\n    l := &amp;node{1, &amp;node{2, &amp;node{3, nil}}}\n    for n := l; n != nil; n = n.next {\n        fmt.Println(n.v)\n    }\n\n    // Create list with loop and print at most 100 steps down the list.\n\n    n3 := &amp;node{3, nil}\n    l = &amp;node{1, &amp;node{2, n3}}\n    n3.next = l\n\n    for i, n := 0, l; n != nil &amp;&amp; i &lt; 100; n, i = n.next, i+1 {\n        fmt.Println(n.v)\n    }\n\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/OM22hbIKL_\" rel=\"nofollow\">playground example</a></p>\n"}], "owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 600, "favorite_count": 0, "accepted_answer_id": 27995703, "answer_count": 1, "score": 0, "last_activity_date": 1421463660, "creation_date": 1421461229, "question_id": 27995531, "link": "https://stackoverflow.com/questions/27995531/how-to-construct-a-loop-in-a-list-in-golang", "title": "How to construct a loop in a list in golang", "body": "<p>I wrote a function to find the loop in a list using golang. But I am not able to construct a loop in a list as input.</p>\n\n<p>Please find below the code,   </p>\n\n<pre><code>package main\n    import (\n        \"container/list\"\n        \"fmt\"\n    )\n    func main() {\n        l := list.New()\n        l.PushBack(0)\n        l.PushBack(1)\n        l.PushBack(2)\n        l.PushBack(3)\n        l.PushBack(4)\n        l.PushBack(5)\n\n        e6 := l.PushBack(6)\n        l.PushBack(7)\n        e8 :=l.PushBack(8)\n        e9 := l.InsertAfter(9,e8)\n        l.InsertBefore(e9, e6)\n\n        for e:=l.Front() ; e !=nil ; e=e.Next() {\n            fmt.Println(e.Value)\n        }\n    }\n</code></pre>\n\n<p>could anyone help me on this?</p>\n"}, {"tags": ["bash", "shell", "go", "interactive"], "answers": [{"comments": [{"owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 0, "creation_date": 1421493796, "post_id": 27994447, "comment_id": 44387383, "body": "I wonder if there is a bug in Stack Overflow question/answers dates or if you actually answered yourself in less than one second. Both are at 23:32:47Z."}, {"owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "edited": false, "score": 0, "creation_date": 1421499511, "post_id": 27994447, "comment_id": 44388647, "body": "A code review for you: This gives a nil pointer exception if you ^D out of the shell.  The use of <code>interface {}</code> is strange, just use an <code>io.Reader</code> and <code>io.Writer</code>.  Errors from <code>StdinPipe*</code> should be checked as should errors from <code>Wait</code>. runPipe` is overcomplicated - you can replace it all with <code>io.Copy</code>."}, {"owner": {"reputation": 1069, "user_id": 1287536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bdf040ab9024de588b911d0e6365612?s=128&d=identicon&r=PG", "display_name": "lee8oi", "link": "https://stackoverflow.com/users/1287536/lee8oi"}, "edited": false, "score": 0, "creation_date": 1421508307, "post_id": 27994447, "comment_id": 44390972, "body": "Thank you Nick. Good stuff.  To be honest its just meant to be some hacking code for playing with shells in Go. I did have checks for the Std{out,err,in}Pipe() functions, they just simply never triggered. But I can put them back for completeness. I&#39;ll go over the code again with your suggestions in mind. Thanks again. You said something more useful than the entire G+ Go community so far."}, {"owner": {"reputation": 1069, "user_id": 1287536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bdf040ab9024de588b911d0e6365612?s=128&d=identicon&r=PG", "display_name": "lee8oi", "link": "https://stackoverflow.com/users/1287536/lee8oi"}, "edited": false, "score": 0, "creation_date": 1421517811, "post_id": 27994447, "comment_id": 44393934, "body": "Ok I updated the code. Ctrl+D won&#39;t cause a crash anymore, the extra error checking has been added, and swapped out bufio with the io.Copy. If you have any other suggestions please do continue to feel free to hit me with em :)"}, {"owner": {"reputation": 1069, "user_id": 1287536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bdf040ab9024de588b911d0e6365612?s=128&d=identicon&r=PG", "display_name": "lee8oi", "link": "https://stackoverflow.com/users/1287536/lee8oi"}, "edited": false, "score": 0, "creation_date": 1421537553, "post_id": 27994447, "comment_id": 44399409, "body": "Ok, the io.Copy method was randomly giving me some bad file descriptor errors. Turns out the way I was doing it is more reliable."}], "tags": [], "owner": {"reputation": 1069, "user_id": 1287536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bdf040ab9024de588b911d0e6365612?s=128&d=identicon&r=PG", "display_name": "lee8oi", "link": "https://stackoverflow.com/users/1287536/lee8oi"}, "is_accepted": false, "score": 0, "last_activity_date": 1421537687, "last_edit_date": 1421537687, "creation_date": 1421451167, "answer_id": 27994447, "question_id": 27994446, "link": "https://stackoverflow.com/questions/27994446/how-do-i-use-my-systems-command-shell-in-go/27994447#27994447", "title": "How do I use my system&#39;s command shell in Go?", "body": "<p>I have such a solution! I actually have it posted in a Gist at <a href=\"https://gist.github.com/lee8oi/a8a90f559fe48355f800\" rel=\"nofollow\">gist.github.com/lee8oi/a8a90f559fe48355f800</a></p>\n\n<p>Its a nice little demonstration that uses Go's os/exec package to directly pipe input/output/error to the command instance. When \"bash\" runs you'll be sitting at a very simple prompt. You can interact with it much like you would with bash (but still pretty simplified). When you run a regular command the output will be displayed then the command will exit (like with \"ping\"). I think this would make a great starting point for tinkering with ways to interact with the system shell in Go.</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"io\"\n    \"log\"\n    \"os\"\n    \"os/exec\"\n    \"sync\"\n)\n\nfunc getPipes(c *exec.Cmd) (inp io.Writer, outp, errp io.Reader) {\n    var err error\n    if inp, err = c.StdinPipe(); err != nil {\n        log.Fatal(err)\n    }\n    if outp, err = c.StdoutPipe(); err != nil {\n        log.Fatal(err)\n    }\n    if errp, err = c.StderrPipe(); err != nil {\n        log.Fatal(err)\n    }\n    return\n}\n\nfunc pipe(wg *sync.WaitGroup, inp io.Reader, outp io.Writer) {\n    if wg != nil {\n        defer wg.Done()\n    }\n    r := bufio.NewReader(inp)\n    for {\n        c, err := r.ReadByte()\n        if err != nil {\n            return\n        }\n        fmt.Fprintf(outp, \"%s\", string(c))\n    }\n}\n\nfunc Command(args ...string) {\n    var cmd *exec.Cmd\n    var wg sync.WaitGroup\n    if len(args) &gt; 1 {\n        cmd = exec.Command(args[0], args[1:]...)\n    } else {\n        cmd = exec.Command(args[0])\n    }\n    inp, outp, errp := getPipes(cmd)\n    wg.Add(1)\n    go pipe(&amp;wg, errp, os.Stderr)\n    wg.Add(1)\n    go pipe(&amp;wg, outp, os.Stdout)\n    go pipe(nil, os.Stdin, inp)\n    if err := cmd.Start(); err != nil {\n        log.Fatal(\"start \", err)\n    }\n    wg.Wait()\n}\n\nfunc main() {\n    Command(\"bash\")\n    Command(\"date\")\n    Command(\"echo\", \"some text\")\n    Command(\"ping\", \"-c 3\", \"www.google.com\")\n}\n</code></pre>\n"}], "owner": {"reputation": 1069, "user_id": 1287536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bdf040ab9024de588b911d0e6365612?s=128&d=identicon&r=PG", "display_name": "lee8oi", "link": "https://stackoverflow.com/users/1287536/lee8oi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 386, "favorite_count": 0, "closed_date": 1554292265, "answer_count": 1, "score": -1, "last_activity_date": 1421585296, "creation_date": 1421451167, "question_id": 27994446, "link": "https://stackoverflow.com/questions/27994446/how-do-i-use-my-systems-command-shell-in-go", "closed_reason": "Duplicate", "title": "How do I use my system&#39;s command shell in Go?", "body": "<p>So I would like to create a command shell in Go. My goal is to use its capabilities in portable system tools I'm thinking about writing. I think a great starting point would be something that can demonstrate the basics of running system commands and allowing the user to interact with the system shell.</p>\n"}, {"tags": ["go", "pipe"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1421466088, "post_id": 27994368, "comment_id": 44382206, "body": "I cannot answer this question because I don&#39;t know what a node pipe is. I can tell you that io.Pipe is rarely used in Go programs. I recommend that you skip over io.Pipe for now and come back to it when you have more experience.  Go programs typically use <a href=\"http://godoc.org/io#Copy\" rel=\"nofollow noreferrer\">io.Copy</a> to copy the contents of one file to another."}], "answers": [{"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 4, "last_activity_date": 1575233992, "last_edit_date": 1575233992, "creation_date": 1421510797, "answer_id": 28001382, "question_id": 27994368, "link": "https://stackoverflow.com/questions/27994368/golang-io-pipe-vs-node-js-pipe/28001382#28001382", "title": "Golang io.Pipe vs node.js Pipe", "body": "<p>No, they are not precisely similar. <code>io.Copy(dat io.Writer, src io.Reader)</code> is quite enough to read and write files, like this:</p>\n\n<pre><code>input := bufio.NewReader(os.Stdin)\noutput := bufio.NewWriter(os.Stdout) // buffer output like C stdlib\nio.Copy(output, input)               // copy entire file\noutput.Flush()\n</code></pre>\n\n<p><code>io.Pipe() (*PipeReader, *PipeWriter)</code> will produce piped <code>Reader</code> and <code>Writer</code> for you when you have <strong>not them</strong> but code <strong>expect them</strong>, like this:</p>\n\n<pre><code>type id struct{\n  name string\n  age int\n}\n\npayload := id{\"John\", 25}     \nrequestBody, jsonPayload := io.Pipe()\nrequest := http.NewRequest(\"POST\". \"http://www.example.com\", requestBody) // NewRequest expect io.Reader\nencoder := json.NewEncoder(jsonPayload) // NewEncoder expect io.Writer\nerr := encoder.Encode(payload)\nresponse, err := client.Do(request)\n</code></pre>\n"}], "owner": {"reputation": 1575, "user_id": 549529, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/c6d37b088a99ad744492e4e16b857c86?s=128&d=identicon&r=PG", "display_name": "ginad", "link": "https://stackoverflow.com/users/549529/ginad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1090, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1575234327, "creation_date": 1421450614, "last_edit_date": 1575234327, "question_id": 27994368, "link": "https://stackoverflow.com/questions/27994368/golang-io-pipe-vs-node-js-pipe", "title": "Golang io.Pipe vs node.js Pipe", "body": "<p>I'm new to golang and I'm having problem understanding go's <code>io.Pipe</code>. Is this similar to node.js' <code>.pipe</code>? And how should I use it? Is it possible to use it with 1 read file and a write file?</p>\n\n<p>Thank in advance guys.</p>\n"}, {"tags": ["json", "go", "unmarshalling"], "comments": [{"owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 0, "creation_date": 1421452497, "post_id": 27994327, "comment_id": 44379689, "body": "How do you read in <code>respBytes</code>?"}, {"owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 4, "creation_date": 1421452689, "post_id": 27994327, "comment_id": 44379737, "body": "Also, note that lowercase indicates private visibility.  You want the field name in your <code>ResultStruct</code> to be capitalized: otherwise the <code>json</code> decoder isn&#39;t allowed to touch the field.  See: <a href=\"http://play.golang.org/p/bATT5uMPRT\" rel=\"nofollow noreferrer\">play.golang.org/p/bATT5uMPRT</a> for an example that appears to work.  So we need more information to see what your error is: the question as stated doesn&#39;t have enough to tell."}, {"owner": {"reputation": 4001, "user_id": 1245380, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IuBwG.png?s=128&g=1", "display_name": "Stratus3D", "link": "https://stackoverflow.com/users/1245380/stratus3d"}, "reply_to_user": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "edited": false, "score": 0, "creation_date": 1421692338, "post_id": 27994327, "comment_id": 44447248, "body": "@dyoo <code>respBytes</code> is just an array of bytes (I take the response, do some processing and extract the body). I also capitalized the result field in the <code>ResultStruct</code>. Your Go playground example takes the JSON I receive and handles it correctly, so there must be something else wrong with my code... Thanks for your help!"}], "answers": [{"comments": [{"owner": {"reputation": 2878, "user_id": 3087441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/zIs67.jpg?s=128&g=1", "display_name": "kopiczko", "link": "https://stackoverflow.com/users/3087441/kopiczko"}, "edited": false, "score": 0, "creation_date": 1421489909, "post_id": 27995141, "comment_id": 44386439, "body": "I suspect that besides of what @3of3 said, you try to parse your JSON without last &#39;}&#39; character."}, {"owner": {"reputation": 4001, "user_id": 1245380, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IuBwG.png?s=128&g=1", "display_name": "Stratus3D", "link": "https://stackoverflow.com/users/1245380/stratus3d"}, "edited": false, "score": 0, "creation_date": 1421693476, "post_id": 27995141, "comment_id": 44447775, "body": "This makes sense, however I printed out the JSON and ran it through an online validator as well as through @dyoo&#39;s Go playground example and it succeeded. I must conclude that this error is due to an issue with another portion of my code. Thanks!"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 10, "last_activity_date": 1459035065, "last_edit_date": 1459035065, "creation_date": 1421457288, "answer_id": 27995141, "question_id": 27994327, "link": "https://stackoverflow.com/questions/27994327/golang-json-unmarshal-unexpected-end-of-json-input/27995141#27995141", "title": "Golang json Unmarshal &quot;unexpected end of JSON input&quot;", "body": "<p>The <code>unexpected end of JSON input</code> is the result of <a href=\"https://github.com/golang/go/blob/9af454c588ee0bef7fc6ae588e2b2e866edcb915/src/encoding/json/scanner.go#L160\" rel=\"noreferrer\">a syntax error</a> in the JSON input (likely a missing <code>\"</code>, <code>}</code>, or <code>]</code>). The error does not depend on the type of the value that you are decoding to.</p>\n\n<p>I ran the code with the example JSON input <a href=\"http://play.golang.org/p/bhtjDbwKJi\" rel=\"noreferrer\">on the playground</a>. It runs without error.</p>\n\n<p>The code does not decode anything because the <code>result</code> field is not exported. If you export the result field:</p>\n\n<pre><code>type ResultStruct struct {\n   Result []map[string]string\n}\n</code></pre>\n\n<p>then the input is decoded as shown in this <a href=\"http://play.golang.org/p/KLYR9MTKnm\" rel=\"noreferrer\">playground example</a>.</p>\n\n<p>I suspect that you are not reading the entire response body in your application. I suggest decoding the JSON input using:</p>\n\n<pre><code>err := json.NewDecoder(resp.Body).Decode(&amp;jsonData)\n</code></pre>\n\n<p>The decoder reads directly from the response body.</p>\n"}, {"comments": [{"owner": {"reputation": 4254, "user_id": 376445, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3a9a11160be7bdca365c163a732e6188?s=128&d=identicon&r=PG", "display_name": "Sam Stoelinga", "link": "https://stackoverflow.com/users/376445/sam-stoelinga"}, "edited": false, "score": 0, "creation_date": 1607231183, "post_id": 36359711, "comment_id": 115205195, "body": "you just saved my day. I wouldn&#39;t have thought that it would be this issue. Thank you!"}], "tags": [], "owner": {"reputation": 103, "user_id": 357054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd0e3e2a79bbfef507a5a9dffbcd57c0?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/357054/robert"}, "is_accepted": false, "score": 5, "last_activity_date": 1459523059, "creation_date": 1459523059, "answer_id": 36359711, "question_id": 27994327, "link": "https://stackoverflow.com/questions/27994327/golang-json-unmarshal-unexpected-end-of-json-input/36359711#36359711", "title": "Golang json Unmarshal &quot;unexpected end of JSON input&quot;", "body": "<p>You can also get this error if you're using json.RawMessage in an unexported field. For example, the following code produces the same error:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype MyJson struct {\n    Foo bool `json:\"foo\"`\n    bar json.RawMessage `json:\"bar\"`\n}\n\ntype Bar struct {\n    X int `json:\"x\"`\n}\n\nvar respBytes = []byte(`\n{\n  \"foo\": true,\n  \"bar\": { \"x\": 10 }\n}`)\n\nfunc main() {\n    var myJson MyJson\n    err := json.Unmarshal(respBytes, &amp;myJson)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    myBar := new(Bar)\n    err = json.Unmarshal(myJson.bar, myBar)\n    fmt.Println(err)\n}\n</code></pre>\n\n<p>If you export \"MyJson.bar\" field (e.g. -> \"MyJson.Bar\", then the code works.</p>\n"}, {"tags": [], "owner": {"reputation": 1022, "user_id": 2946499, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d58b41de73057812e31a8047fc39b7b2?s=128&d=identicon&r=PG&f=1", "display_name": "keepTrackOfYourStack", "link": "https://stackoverflow.com/users/2946499/keeptrackofyourstack"}, "is_accepted": false, "score": 0, "last_activity_date": 1608662100, "creation_date": 1608662100, "answer_id": 65414065, "question_id": 27994327, "link": "https://stackoverflow.com/questions/27994327/golang-json-unmarshal-unexpected-end-of-json-input/65414065#65414065", "title": "Golang json Unmarshal &quot;unexpected end of JSON input&quot;", "body": "<p>it is not the case here; but if you are getting this error loading json from a file the Will occur if the byte slice for the buffer is not initialized the the byte size of the file. [when you're new like me that happens! ]  Since this is the first search result I got it still took some digging to figure out.  In this use case the error is a bit misleading.</p>\n<pre><code>type GenesisResultStruct []GenesisField\n\nfileinfo, _ := genesis.Stat()\nbs := make([]byte, fileinfo.Size())\n//bs := []byte {} // wrong!!\n_, error := genesis.Read(bs)\n\nif error != nil {\n    fmt.Println(&quot;genesis read error: &quot;, error)\n    os.Exit(1)\n}\n\nvar jsonData GenesisResultStruct\neGen = json.Unmarshal(bs, &amp;jsonData)\n\nif eGen != nil {\n    fmt.Println(&quot;genesis unmarshal error: &quot;, eGen)\n    os.Exit(1)\n}\n</code></pre>\n"}], "owner": {"reputation": 4001, "user_id": 1245380, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IuBwG.png?s=128&g=1", "display_name": "Stratus3D", "link": "https://stackoverflow.com/users/1245380/stratus3d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57232, "favorite_count": 1, "accepted_answer_id": 27995141, "answer_count": 3, "score": 17, "last_activity_date": 1608662100, "creation_date": 1421450253, "question_id": 27994327, "link": "https://stackoverflow.com/questions/27994327/golang-json-unmarshal-unexpected-end-of-json-input", "title": "Golang json Unmarshal &quot;unexpected end of JSON input&quot;", "body": "<p>I am working on some code to parse the JSON data from an HTTP response. The code I have looks something like this:</p>\n\n<pre><code>type ResultStruct struct {\n    result []map[string]string\n}\n\nvar jsonData ResultStruct\nerr = json.Unmarshal(respBytes, &amp;jsonData)\n</code></pre>\n\n<p>The json in the <code>respBytes</code> variable looks like this:</p>\n\n<pre><code>{\n \"result\": [\n  {\n   \"id\": \"ID 1\"\n  },\n  {\n   \"id\": \"ID 2\"\n  }\n ]\n}\n</code></pre>\n\n<p>However, <code>err</code> is not nil. When I print it out it says <code>unexpected end of JSON input</code>. What is causing this? The JSON seems to valid. Does this error have something to do with my custom struct?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["mongodb", "go", "bson", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 3626812, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/WxsCY.png?s=128&g=1", "display_name": "dmonay", "link": "https://stackoverflow.com/users/3626812/dmonay"}, "edited": false, "score": 0, "creation_date": 1421455441, "post_id": 27994374, "comment_id": 44380348, "body": "Ah ok. So the second one almost works. But, as per the Mongo specifications, I can apparently only run this command on the admin database. My app creates a separate database with a number of collections, any of which I might need to rename. Does this mean that as long as my app uses a database not called admin, I won&#39;t be able to run this command?"}, {"owner": {"reputation": 8119, "user_id": 1698887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fe33350fa65be5a2630271b0782b0096?s=128&d=identicon&r=PG", "display_name": "Daniel Williams", "link": "https://stackoverflow.com/users/1698887/daniel-williams"}, "reply_to_user": {"reputation": 167, "user_id": 3626812, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/WxsCY.png?s=128&g=1", "display_name": "dmonay", "link": "https://stackoverflow.com/users/3626812/dmonay"}, "edited": false, "score": 1, "creation_date": 1421455639, "post_id": 27994374, "comment_id": 44380400, "body": "The admin database is a special database inside of mongo. It is where mongo will store administrative settings like users and what they have access to. It isn&#39;t created by default (afaik), it&#39;s just required that you can access it to run admin commands. Examples: <a href=\"http://docs.mongodb.org/manual/tutorial/add-user-administrator/\" rel=\"nofollow noreferrer\">docs.mongodb.org/manual/tutorial/add-user-administrator</a>"}], "tags": [], "owner": {"reputation": 8119, "user_id": 1698887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fe33350fa65be5a2630271b0782b0096?s=128&d=identicon&r=PG", "display_name": "Daniel Williams", "link": "https://stackoverflow.com/users/1698887/daniel-williams"}, "is_accepted": true, "score": 6, "last_activity_date": 1421452964, "last_edit_date": 1421452964, "creation_date": 1421450649, "answer_id": 27994374, "question_id": 27994221, "link": "https://stackoverflow.com/questions/27994221/rename-mongo-collection-in-go-using-mgo-or-bson/27994374#27994374", "title": "Rename mongo collection in Go using mgo or bson?", "body": "<p>I haven't used mgo but this looks like exactly what you want to run a raw query.</p>\n\n<p><a href=\"http://godoc.org/labix.org/v2/mgo#Session.Run\" rel=\"noreferrer\">http://godoc.org/labix.org/v2/mgo#Session.Run</a></p>\n\n<p>In directly to mongo:</p>\n\n<pre><code>db.adminCommand({renameCollection:'yourdb.yourcollection', to:'yourdb.yournewcollection'})\n</code></pre>\n\n<p>Using mgo:</p>\n\n<pre><code>session.Run(bson.D{{\"renameCollection\", \"yourdb.yourcollection\"}, {\"to\", \"yourdb.yournewcollection\"}})\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 3626812, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/WxsCY.png?s=128&g=1", "display_name": "dmonay", "link": "https://stackoverflow.com/users/3626812/dmonay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1124, "favorite_count": 0, "accepted_answer_id": 27994374, "answer_count": 1, "score": 3, "last_activity_date": 1421452964, "creation_date": 1421449619, "question_id": 27994221, "link": "https://stackoverflow.com/questions/27994221/rename-mongo-collection-in-go-using-mgo-or-bson", "title": "Rename mongo collection in Go using mgo or bson?", "body": "<p>I'd like to rename a mongo collection in my Go app. I'm using the mgo driver and it doesn't have a defined method to do this. Does anyone know what the query would be using bson? This is the command I'd like to implement in Go: <a href=\"http://docs.mongodb.org/manual/reference/command/renameCollection/\" rel=\"nofollow\">http://docs.mongodb.org/manual/reference/command/renameCollection/</a></p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "is_accepted": true, "score": 2, "last_activity_date": 1421449777, "last_edit_date": 1421449777, "creation_date": 1421449449, "answer_id": 27994186, "question_id": 27994050, "link": "https://stackoverflow.com/questions/27994050/anonymous-fields-in-type-declaration/27994186#27994186", "title": "anonymous fields in type declaration?", "body": "<p>You want to look at the part of the grammar that has to do with structures, not just types.  See: <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow\">Struct types</a> and the use of <code>AnonymousField</code>.  Looking just at the production for <code>TypeSpec</code> is focusing attention on the wrong place.  Instead, look at <code>FieldDecl</code>; the grammar shows that we have two possibilities: named fields (<code>IdentifierList Type</code>), or anonymous fields (<code>AnonymousField</code>).</p>\n\n<p>Anonymous fields are typically used for <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow\">embedding</a>.  In your example, a <code>Server</code> will act like a <code>Handler</code> because it has embedded that field.</p>\n"}], "owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 27994186, "answer_count": 1, "score": 1, "last_activity_date": 1421449777, "creation_date": 1421448716, "question_id": 27994050, "link": "https://stackoverflow.com/questions/27994050/anonymous-fields-in-type-declaration", "title": "anonymous fields in type declaration?", "body": "<p>I came across this type declaration:</p>\n\n<pre><code>type Handler func(*Conn)\n\ntype Server struct {\n  Handshake func(*Config, *http.Request) error\n  Handler\n}\n</code></pre>\n\n<p>(this is a simplified version of <a href=\"https://github.com/golang/net/blob/38c17adf51120973d1735785a7c02f8ce8297c5e/websocket/server.go#L55-L66\" rel=\"nofollow\">https://github.com/golang/net/blob/38c17adf51120973d1735785a7c02f8ce8297c5e/websocket/server.go#L55-L66</a></p>\n\n<p>The second field in the <code>Server</code> structure is anonymous. There is just type and no name.</p>\n\n<p>Here is the grammar for type declarations (<a href=\"https://golang.org/ref/spec#Type_declarations\" rel=\"nofollow\">https://golang.org/ref/spec#Type_declarations</a>):</p>\n\n<pre><code>TypeDecl     = \"type\" ( TypeSpec | \"(\" { TypeSpec \";\" } \")\" ) .\nTypeSpec     = identifier Type .\n</code></pre>\n\n<p>and it clearly requires an identifier name. But yet the section that I referenced that contains the grammar, also mentions anonymous fields.</p>\n\n<p>I do not understand why this syntax is correct and how anonymous fields are used.</p>\n"}, {"tags": ["pointers", "reflection", "go"], "answers": [{"comments": [{"owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "edited": false, "score": 1, "creation_date": 1421443948, "post_id": 27992915, "comment_id": 44376933, "body": "Big thank you. My brain is overloaded, I try to check it tomorrow! I think I need a time and practice to really understand what&#39;s going on here. Especially here! <code>v.Addr().Interface().(*int)</code>. Could you share where can I grasp this kind of knowledge?)"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "edited": false, "score": 2, "creation_date": 1421444904, "post_id": 27992915, "comment_id": 44377309, "body": "@TimurFayzrakhmanov I updated the answer with a breakdown of the expression <code>v.Addr().Interface().(*int)</code>."}, {"owner": {"reputation": 1685, "user_id": 1291512, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/QFnuz.jpg?s=128&g=1", "display_name": "WhiteAngel", "link": "https://stackoverflow.com/users/1291512/whiteangel"}, "edited": false, "score": 1, "creation_date": 1444499960, "post_id": 27992915, "comment_id": 53934357, "body": "v.Addr().Interface() works great for DB actions. Thank you very much for this!"}, {"owner": {"reputation": 4742, "user_id": 5691066, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e5ab5db401198485d4569199f9994a7d?s=128&d=identicon&r=PG", "display_name": "wvxvw", "link": "https://stackoverflow.com/users/5691066/wvxvw"}, "edited": false, "score": 0, "creation_date": 1488791130, "post_id": 27992915, "comment_id": 72371226, "body": "Doesn&#39;t work if the field has a type of some interface."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 4742, "user_id": 5691066, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e5ab5db401198485d4569199f9994a7d?s=128&d=identicon&r=PG", "display_name": "wvxvw", "link": "https://stackoverflow.com/users/5691066/wvxvw"}, "edited": false, "score": 0, "creation_date": 1488816106, "post_id": 27992915, "comment_id": 72388153, "body": "@wvxvw Here&#39;s the example with the <code>int</code> field replaced with an interface type: <a href=\"https://play.golang.org/p/AMhp4KFv9C\" rel=\"nofollow noreferrer\">play.golang.org/p/AMhp4KFv9C</a>. It works."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 21, "last_activity_date": 1488815919, "last_edit_date": 1488815919, "creation_date": 1421443162, "answer_id": 27992915, "question_id": 27992821, "link": "https://stackoverflow.com/questions/27992821/how-get-pointer-of-structs-member-from-interface/27992915#27992915", "title": "How get pointer of struct&#39;s member from interface{}", "body": "<p>Here's a working version of function f:</p>\n\n<pre><code>func f(i interface{}) {\n  v := reflect.ValueOf(i).Elem().FieldByName(\"Id\")\n  ptr := v.Addr().Interface().(*int)\n  *ptr = 100\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/E-y3rI8dU-\" rel=\"noreferrer\">playground example</a></p>\n\n<p>The conversion to integer pointer goes as follows:</p>\n\n<ul>\n<li><code>v</code> is a <code>reflect.Value</code> representing the <code>int</code> field.</li>\n<li><code>v.Addr()</code> is a <code>relfect.Value</code> representing a pointer to the <code>int</code> field.</li>\n<li><code>v.Addr().Interface()</code> is an <code>interface{}</code> containing the <code>int</code> pointer.</li>\n<li><code>v.Addr().Interface().(*int)</code> <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"noreferrer\">type asserts</a> the <code>interface{}</code> to a <code>*int</code>  </li>\n</ul>\n\n<p>You can set the field directly without getting a pointer:</p>\n\n<pre><code>func f(i interface{}) {\n  v := reflect.ValueOf(i).Elem().FieldByName(\"Id\")\n  v.SetInt(100)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/7d7GRdtqEB\" rel=\"noreferrer\">playground example</a></p>\n\n<p>If you are passing the value along to something expecting interface{} (like the db/sql <a href=\"http://godoc.org/database/sql#Row.Scan\" rel=\"noreferrer\">Scan</a> methods), then you can remove the type assertion:</p>\n\n<pre><code>func f(i interface{}) {\n  v := reflect.ValueOf(i).Elem().FieldByName(\"Id\")\n  scan(v.Addr().Interface())\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/_tJyXK6jcV\" rel=\"noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9628, "favorite_count": 4, "accepted_answer_id": 27992915, "answer_count": 1, "score": 6, "last_activity_date": 1549202243, "creation_date": 1421442749, "last_edit_date": 1549202243, "question_id": 27992821, "link": "https://stackoverflow.com/questions/27992821/how-get-pointer-of-structs-member-from-interface", "title": "How get pointer of struct&#39;s member from interface{}", "body": "<p>I want to pass struct's pointer to function that expect interface{}. Then get (through reflection) the pointer to the struct's member and then modify it using this pointer. I've read a much of Q&amp;A and tried much of variations, but still I can get it work.</p>\n\n<p>Let's consider example below:</p>\n\n<pre><code>type Robot struct {\n    Id int\n}\nf := func(i interface {}) {\n    v :=  reflect.ValueOf(i).Elem().FieldByName(\"Id\")\n    ptr := v.Addr().Pointer()\n    *ptr = 100\n    //^ it needs to me for functions expecting the pointer: Scan(&amp;pointerToValue)\n}\n\nrobot := &amp;Robot{}\nf(robot)\nprintln(robot.Id) //I want to get here 100\n</code></pre>\n\n<p>I think the problem in poor understanding what actually do <strong>Addr()</strong> and <strong>Pointer()</strong> methods of reflect package..</p>\n"}, {"tags": ["ssl", "data-structures", "go", "unmarshalling", "asn.1"], "comments": [{"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1421443464, "post_id": 27992496, "comment_id": 44376743, "body": "Have you tested       type SignedPublicKeyAndChallenge struct{     PublicKeyAndChallenge //embedding     SignitureAlgorithm  asn1.BitString     Signiture asn1.BitString }  //to avoid namespace collision"}, {"owner": {"reputation": 148, "user_id": 4372649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9727069850eea06e9b7914a26e56eef8?s=128&d=identicon&r=PG&f=1", "display_name": "pcwizz", "link": "https://stackoverflow.com/users/4372649/pcwizz"}, "reply_to_user": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1421447340, "post_id": 27992496, "comment_id": 44378234, "body": "I have tested doing the structs embedded makes no difference"}], "answers": [{"tags": [], "owner": {"reputation": 148, "user_id": 4372649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9727069850eea06e9b7914a26e56eef8?s=128&d=identicon&r=PG&f=1", "display_name": "pcwizz", "link": "https://stackoverflow.com/users/4372649/pcwizz"}, "is_accepted": true, "score": 0, "last_activity_date": 1421508720, "creation_date": 1421508720, "answer_id": 28001024, "question_id": 27992496, "link": "https://stackoverflow.com/questions/27992496/asn1-go-client-side-cert-auth/28001024#28001024", "title": "asn1 go (client side cert auth)", "body": "<p>I did some duck duck going and found the rfc320 that provides the definitions of the asn.1 classes and have got it to work!</p>\n\n<p>The structure is now:</p>\n\n<pre><code>type SubjectPublicKeyInfo struct {\n    Algorithm pkix.AlgorithmIdentifier\n    SubjectPublicKey asn1.BitString\n}\n\ntype PublicKeyAndChallenge struct {\n    Spki SubjectPublicKeyInfo\n    Challenge string\n}\n\ntype SignedPublicKeyAndChallenge struct{\n    PublicKeyAndChallenge PublicKeyAndChallenge\n    SignitureAlgorithm pkix.AlgorithmIdentifier\n    Signiture asn1.BitString\n}\n</code></pre>\n"}], "owner": {"reputation": 148, "user_id": 4372649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9727069850eea06e9b7914a26e56eef8?s=128&d=identicon&r=PG&f=1", "display_name": "pcwizz", "link": "https://stackoverflow.com/users/4372649/pcwizz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 28001024, "answer_count": 1, "score": 0, "last_activity_date": 1421508720, "creation_date": 1421441203, "question_id": 27992496, "link": "https://stackoverflow.com/questions/27992496/asn1-go-client-side-cert-auth", "title": "asn1 go (client side cert auth)", "body": "<p>I am trying to get client side cert auth working and after reading <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/keygen\" rel=\"nofollow\">https://developer.mozilla.org/en-US/docs/Web/HTML/Element/keygen</a> I realised I needed to parse some asn1.</p>\n\n<p>The structure I'm trying to use is this:</p>\n\n<pre><code>type PublicKeyAndChallenge struct {\n    Spki asn1.BitString\n    Challenge asn1.BitString\n}\n\ntype SignedPublicKeyAndChallenge struct{\n    PublicKeyAndChallenge PublicKeyAndChallenge\n    SignitureAlgorithm  asn1.BitString\n    Signiture asn1.BitString\n}\n</code></pre>\n\n<p>I decode the base64 encoded asn1 into a []byte, then I try to unmarshal the asn1 into the structure.</p>\n\n<pre><code>signeeKeySigned := make([]byte, 2048)\n    _ , err = base64.StdEncoding.Decode(signeeKeySigned, signeePubKeySigned)\n    if ( err != nil ){\n        log.Fatal(err)\n    }   \n    //Parse should be asn.1 encoded\n    var signee SignedPublicKeyAndChallenge\n    _, err = asn1.Unmarshal(signeeKeySigned, &amp;signee)\n    if err != nil {\n        log.Fatal(err)\n    }  \n</code></pre>\n\n<p>I am getting a structure error so I believe my structure in go must not be correct, but I am not able to figure it out.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 2, "creation_date": 1498090327, "post_id": 27991671, "comment_id": 76360156, "body": "While there are some cases where using a fixed offset is appropriate, generally it&#39;s better to use the <code>Continent&#47;City</code>. Time zones and daylight savings rules are political and change. Using <code>Continent&#47;City</code> will allow your application to adjust to those changes as the underlying IANA Time Zone database is updated. It will also take care of daylight savings for you."}], "answers": [{"comments": [{"owner": {"reputation": 587, "user_id": 2239242, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l0IPl.jpg?s=128&g=1", "display_name": "Kartik Sura", "link": "https://stackoverflow.com/users/2239242/kartik-sura"}, "edited": false, "score": 4, "creation_date": 1421558408, "post_id": 27991829, "comment_id": 44402983, "body": "Thanks Fabrizio! I also want to support daylight savings. Any pointers on that?"}, {"owner": {"reputation": 360, "user_id": 5872318, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IB6RdimFijs/AAAAAAAAAAI/AAAAAAAAAFU/Xk-uMkbay2g/photo.jpg?sz=128", "display_name": "MffnMn", "link": "https://stackoverflow.com/users/5872318/mffnmn"}, "edited": false, "score": 3, "creation_date": 1476366036, "post_id": 27991829, "comment_id": 67322238, "body": "I don&#39;t know about defining custom daylight saving settings, but the Time Zones from the database already support daylight saving."}], "tags": [], "owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "is_accepted": false, "score": 17, "last_activity_date": 1421438231, "creation_date": 1421438231, "answer_id": 27991829, "question_id": 27991671, "link": "https://stackoverflow.com/questions/27991671/how-to-get-the-current-timestamp-in-other-timezones-in-golang/27991829#27991829", "title": "How to get the current timestamp in other timezones in Golang?", "body": "<p>No, that is the best way. You can create your custom <code>Location</code> using <a href=\"http://golang.org/pkg/time/#FixedZone\">FixedZone</a> and use that custom  location.</p>\n\n<blockquote>\n  <p>FixedZone returns a Location that always uses the given zone name and\n  offset (seconds east of UTC).</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 457, "user_id": 609295, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/lPOCA.png?s=128&g=1", "display_name": "Dave Appleton", "link": "https://stackoverflow.com/users/609295/dave-appleton"}, "edited": false, "score": 3, "creation_date": 1495318018, "post_id": 42136791, "comment_id": 75204085, "body": "I assume you mean      now := time.Now().In(loc)"}, {"owner": {"reputation": 8109, "user_id": 237351, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a2fb09f37c93194e9515f32de43bd258?s=128&d=identicon&r=PG", "display_name": "DMin", "link": "https://stackoverflow.com/users/237351/dmin"}, "edited": false, "score": 1, "creation_date": 1559534467, "post_id": 42136791, "comment_id": 99437071, "body": "The location timezone information is picked up from the system and there is a chance that it will not find the location string. If the location is not found your binary will crash, so make sure you handle this error."}], "tags": [], "owner": {"reputation": 906, "user_id": 5164289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2da3a3ff22e91198c5d07f04017ae8b?s=128&d=identicon&r=PG&f=1", "display_name": "\u9648\u654f\u534e", "link": "https://stackoverflow.com/users/5164289/%e9%99%88%e6%95%8f%e5%8d%8e"}, "is_accepted": false, "score": 74, "last_activity_date": 1498089428, "last_edit_date": 1498089428, "creation_date": 1486643433, "answer_id": 42136791, "question_id": 27991671, "link": "https://stackoverflow.com/questions/27991671/how-to-get-the-current-timestamp-in-other-timezones-in-golang/42136791#42136791", "title": "How to get the current timestamp in other timezones in Golang?", "body": "<pre><code>//init the loc\nloc, _ := time.LoadLocation(\"Asia/Shanghai\")\n\n//set timezone,  \nnow := time.Now().In(loc)\n</code></pre>\n"}], "owner": {"reputation": 587, "user_id": 2239242, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l0IPl.jpg?s=128&g=1", "display_name": "Kartik Sura", "link": "https://stackoverflow.com/users/2239242/kartik-sura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59598, "favorite_count": 5, "answer_count": 2, "score": 56, "last_activity_date": 1498089428, "creation_date": 1421437673, "last_edit_date": 1470548152, "question_id": 27991671, "link": "https://stackoverflow.com/questions/27991671/how-to-get-the-current-timestamp-in-other-timezones-in-golang", "title": "How to get the current timestamp in other timezones in Golang?", "body": "<p>I need to get the current time in different time-zones. </p>\n\n<p>Currently I know that we can do the following:</p>\n\n<pre><code>t := time.Now()\nfmt.Println(\"Location:\", t.Location(), \":Time:\", t)\nutc, err := time.LoadLocation(\"America/New_York\")\nif err != nil {\n    fmt.Println(\"err: \", err.Error())\n}\nfmt.Println(\"Location:\", utc, \":Time:\", t.In(utc))\n</code></pre>\n\n<p>The LoadLocation name is taken to be a location name corresponding to a file in the IANA Time Zone database, such as \"America/New_York\". </p>\n\n<p>Is there a simpler way to get the current time, if the country name, or the GMT offset is given e.g +530 for India?</p>\n\n<p>Edit: I would also want to support Day light savings.</p>\n"}, {"tags": ["database", "reflection", "interface", "go"], "answers": [{"comments": [{"owner": {"reputation": 3258, "user_id": 1085848, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/86a0ff3564f750b3ed49cfc8b57f1275?s=128&d=identicon&r=PG", "display_name": "TomSawyer", "link": "https://stackoverflow.com/users/1085848/tomsawyer"}, "edited": false, "score": 0, "creation_date": 1518001358, "post_id": 27991505, "comment_id": 84321612, "body": "Why <code>Robot</code> has to be reference not a variable?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 3258, "user_id": 1085848, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/86a0ff3564f750b3ed49cfc8b57f1275?s=128&d=identicon&r=PG", "display_name": "TomSawyer", "link": "https://stackoverflow.com/users/1085848/tomsawyer"}, "edited": false, "score": 0, "creation_date": 1518025335, "post_id": 27991505, "comment_id": 84337987, "body": "@TomSawyer Go doesn&#39;t have &quot;references&quot;, <code>Robot</code> is a pointer, and you can&#39;t change the <code>robot</code> value if you&#39;re only mutating a copy of that value."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1421437512, "last_edit_date": 1421437512, "creation_date": 1421437010, "answer_id": 27991505, "question_id": 27990522, "link": "https://stackoverflow.com/questions/27990522/how-to-set-new-value-to-struct-member-of-explicit-type-from-interface-value-r/27991505#27991505", "title": "How to set new value to struct member of explicit type from interface{} value (reflection)? Golang", "body": "<p>You can only set exported fields via reflection, so capitalize those first. Otherwise, if you're counting on positional values, make sure they are properly aligned.</p>\n\n<p>Something like this for example: <a href=\"http://play.golang.org/p/ItnjwwJnxe\" rel=\"nofollow\">http://play.golang.org/p/ItnjwwJnxe</a></p>\n\n<pre><code>type Robot struct {\n    ID    int\n    Model string\n}\n\nfunc change(i interface{}, fields ...string) {\n    returns := []interface{}{100, \"Something\"}\n\n    v := reflect.ValueOf(i).Elem()\n    for i, name := range fields {\n        val := reflect.ValueOf(returns[i])\n        v.FieldByName(name).Set(val)\n    }\n}\n\nfunc main() {\n    robot := &amp;Robot{ID: 1, Model: \"T310\"}\n    fmt.Println(robot)\n    change(robot, \"ID\", \"Model\")\n    fmt.Println(robot)\n}\n</code></pre>\n"}], "owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 830, "favorite_count": 0, "accepted_answer_id": 27991505, "answer_count": 1, "score": 0, "last_activity_date": 1421437512, "creation_date": 1421433195, "last_edit_date": 1421433551, "question_id": 27990522, "link": "https://stackoverflow.com/questions/27990522/how-to-set-new-value-to-struct-member-of-explicit-type-from-interface-value-r", "title": "How to set new value to struct member of explicit type from interface{} value (reflection)? Golang", "body": "<p>I want to understand some subtle moments of using reflect package. Please, see example below, it describes better what I want to know:</p>\n\n<pre><code>type Robot struct {\n    id    int\n    model string\n}\n\nfunc change(i interface{}, fields ...string) {\n        v := reflect.ValueOf(i).Elem()\n        // here I emulate function by slice that could return any value,\n        // so here I need to check if I can store incoming values to existing struct\n        returns := []interface{}{100, \"Something\"}\n        for i, name := range fields {\n            x := reflect.ValueOf(&amp;returns[i]).Elem()\n            //check if value representing x is the same of struct member\n            v.FieldByName(name).Set(x)\n            // ^ here I want to store 100 to Robot.id when i = 0,\n            // and \"Something\" to Robot.model when i = 1\n        }\n\n\n}\n\nfunc main() {\n    robot := &amp;Robot{id: 1, model: \"T310\"}\n    change(robot, \"model\", \"id\")\n    // now robot become as follows: &amp;Robot{100, \"Something\"}\n}\n</code></pre>\n\n<p>Why does it need for?</p>\n\n<pre><code>    // It is need for retrieving values from sql DB into struct members \n    // (only for training purposes :))\n    // Example:\n    f := func(q string, structs interface{}, fields ...string) {\n        rows, _ := db.Query(q)\n        for i := 0; rows.Next(); i++ {\n            rows.Scan(&amp;structs[i])\n            // very dirty here! it's hard to understand how to implement it\n        }\n    }\n    var robots = []*Robot\n    f(\"select id, model from robots\", robots, \"id\", \"model\")\n    // now each member of robots var should contain values from DB\n</code></pre>\n\n<p>I tried to be descriptive and explain as short as possible. I hope you understand me..</p>\n"}]