[{"tags": ["go", "types", "control-characters"], "answers": [{"comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1548294990, "post_id": 54338269, "comment_id": 95493423, "body": "The <a href=\"https://godoc.org/github.com/cyphar/govis\" rel=\"nofollow noreferrer\">govis</a> package may be helpful in decoding vis.  I found the package by searching for &quot;vis golang&quot;. I make no claims about the suitability of the package."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 1, "last_activity_date": 1548295435, "last_edit_date": 1548295435, "creation_date": 1548294449, "answer_id": 54338269, "question_id": 54337482, "link": "https://stackoverflow.com/questions/54337482/is-there-a-term-for-characters-that-appear-from-ios-logs-like-m-c-m-6-or-13/54338269#54338269", "title": "Is there a term for characters that appear from ios logs like `\\M-C\\M-6` or `\\134`", "body": "<p>It is the <a href=\"https://www.freebsd.org/cgi/man.cgi?query=vis&amp;sektion=3\" rel=\"nofollow noreferrer\">vis</a> encoding of UTF-8 encoded text.  </p>\n\n<p>Here's an example: </p>\n\n<p>The UTF-8 encoding of the rune <code>\u00f6</code> in bytes is <code>[0303, 0266]</code>. </p>\n\n<p>vis encodes the byte <code>0303</code> as the bytes <code>\\M-C</code> and the byte <code>0266</code> as the bytes <code>\\M-6</code>.</p>\n\n<p>Putting the two levels of encoding together, the rune <code>\u00f6</code> is encoded as the bytes <code>\\M-C\\M-6</code>.</p>\n\n<p>You can either write an decoder using the documentation on the <a href=\"https://www.freebsd.org/cgi/man.cgi?query=vis&amp;sektion=3\" rel=\"nofollow noreferrer\">man page</a> or search for a decoding package.  The Go standard library does not include such a decoder.</p>\n"}], "owner": {"reputation": 69, "user_id": 7183492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8557fb6dc0d0c0d3c7eaf183f58cb09?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/7183492/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548295435, "creation_date": 1548287950, "last_edit_date": 1548288406, "question_id": 54337482, "link": "https://stackoverflow.com/questions/54337482/is-there-a-term-for-characters-that-appear-from-ios-logs-like-m-c-m-6-or-13", "title": "Is there a term for characters that appear from ios logs like `\\M-C\\M-6` or `\\134`", "body": "<p>I'm trying to figure out the term for these types of characters:</p>\n\n<blockquote>\n  <p>\\M-C\\M-6 (corresponds to german \"\u00f6\")</p>\n  \n  <p>\\M-C\\M-$ (corresponds to german \"\u00e4\")</p>\n  \n  <p>\\M-C\\M^_ (corresponds to german \"\u00df\")</p>\n</blockquote>\n\n<p>I want to know the term for these outputs so that I can easily convert them into the utf-8 character they actually are in golang instead of creating a mapping of each I come across.</p>\n\n<p>What is the term for these? unicode? What would be the best way to convert these \"characters\" to their actual human readable character in golang?</p>\n"}, {"tags": ["arrays", "go", "character", "letter"], "comments": [{"owner": {"reputation": 153, "user_id": 3051040, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/50791649b689432db71eb363eaecc9db?s=128&d=identicon&r=PG&f=1", "display_name": "user3051040", "link": "https://stackoverflow.com/users/3051040/user3051040"}, "edited": false, "score": 0, "creation_date": 1548283476, "post_id": 54336790, "comment_id": 95490861, "body": "I&#39;m not trying to work with multi-character strings, I&#39;m going after single character (letters) only. Slices use arrays under the hood anyways, so wouldn&#39;t this be necessary?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1548283573, "post_id": 54336790, "comment_id": 95490896, "body": "As for documentation, it&#39;s all laid out in the <a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">spec</a>, You can see some array examples under <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"nofollow noreferrer\">Composite Literals</a> and  <a href=\"https://golang.org/ref/spec#Array_types\" rel=\"nofollow noreferrer\">Array Types</a>, which also both define the grammar."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 2, "creation_date": 1548298001, "post_id": 54336790, "comment_id": 95494076, "body": "It is far less readable because <code>[10]byte{&#39;a&#39;, &#39;e&#39;, &#39;i&#39;, &#39;o&#39;, &#39;u&#39;, &#39;y&#39;}</code> is valid too. When you write <code>[6]byte{&#39;a&#39;,&#39;e&#39;,&#39;i&#39;,&#39;o&#39;,&#39;u&#39;,&#39;y&#39;}</code> I have to carefully count the vowels to make sure there are exactly six of them. Writing <code>[...]byte{&#39;a&#39;, &#39;e&#39;, &#39;i&#39;, &#39;o&#39;, &#39;u&#39;, &#39;y&#39;}</code> lets the compiler and computer do the counting. They are much more reliable and untiring than you or I."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1548340494, "post_id": 54336790, "comment_id": 95513397, "body": "An equivalent alternative would be <code>[]byte(&quot;aeiouy&quot;)</code>. It&#39;s more concise but slightly less explicit. Also, answers should be in answers, not edited into questions."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 4, "last_activity_date": 1548283403, "creation_date": 1548283403, "answer_id": 54336829, "question_id": 54336790, "link": "https://stackoverflow.com/questions/54336790/golang-define-array-of-bytes-holding-single-letters/54336829#54336829", "title": "Golang define array of bytes holding single letters", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var vowels = [...]byte{'a', 'e', 'i', 'o', 'u', 'y'}\n    fmt.Printf(\"%d %c\\n\", len(vowels), vowels)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/Giok8PkpItR\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Giok8PkpItR</a></p>\n\n<p>Output:</p>\n\n<pre><code>6 [a e i o u y]\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 3051040, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/50791649b689432db71eb363eaecc9db?s=128&d=identicon&r=PG&f=1", "display_name": "user3051040", "link": "https://stackoverflow.com/users/3051040/user3051040"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1548284218, "creation_date": 1548283210, "last_edit_date": 1548284073, "question_id": 54336790, "link": "https://stackoverflow.com/questions/54336790/golang-define-array-of-bytes-holding-single-letters", "title": "Golang define array of bytes holding single letters", "body": "<p>I am trying to define an array of explicit fixed length (duh), and pre-populate it with values in a single line. I have come up with the following (which fails), but cannot find any documentation regarding how to do this in a single line.</p>\n\n<p><code>var vowels [6]byte = {\"a\",\"e\",\"i\",\"o\",\"u\",\"y\"}</code></p>\n\n<p>I also do <strong>NOT</strong> want to use the <code>:=</code> operator.</p>\n\n<p><strong>ANSWER</strong> - derivative of answer by <em>@peterSO</em> for code readability.</p>\n\n<pre><code>var vowels = [6]byte{'a','e','i','o','u','y'}\n</code></pre>\n"}, {"tags": ["go", "apache-kafka", "confluent-platform"], "comments": [{"owner": {"reputation": 124932, "user_id": 2308683, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/eac16c9fc481cb6825f8b3a35f916b5c?s=128&d=identicon&r=PG", "display_name": "OneCricketeer", "link": "https://stackoverflow.com/users/2308683/onecricketeer"}, "edited": false, "score": 0, "creation_date": 1548284978, "post_id": 54336650, "comment_id": 95491339, "body": "librdkafka (which the Confluent Golang client is based on) doesn&#39;t yet have exactly once semantics.   You can follow <a href=\"https://github.com/confluentinc/confluent-kafka-go/issues/104\" rel=\"nofollow noreferrer\">github.com/confluentinc/confluent-kafka-go/issues/104</a> (and the linked issue) for more information."}, {"owner": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "reply_to_user": {"reputation": 124932, "user_id": 2308683, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/eac16c9fc481cb6825f8b3a35f916b5c?s=128&d=identicon&r=PG", "display_name": "OneCricketeer", "link": "https://stackoverflow.com/users/2308683/onecricketeer"}, "edited": false, "score": 0, "creation_date": 1548285839, "post_id": 54336650, "comment_id": 95491608, "body": "It looks like Consumer Transactions is what I&#39;m after. As long as a consumer moves to a different topic rather than get the next message after messages locked by transaction."}, {"owner": {"reputation": 1193, "user_id": 2790312, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/D2mv6.jpg?s=128&g=1", "display_name": "Raunak Jhawar", "link": "https://stackoverflow.com/users/2790312/raunak-jhawar"}, "edited": false, "score": 0, "creation_date": 1548305434, "post_id": 54336650, "comment_id": 95495515, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/42165726/kafka-only-once-consumption-guarantee\" title=\"kafka only once consumption guarantee\">stackoverflow.com/questions/42165726/&hellip;</a>"}, {"owner": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "reply_to_user": {"reputation": 1193, "user_id": 2790312, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/D2mv6.jpg?s=128&g=1", "display_name": "Raunak Jhawar", "link": "https://stackoverflow.com/users/2790312/raunak-jhawar"}, "edited": false, "score": 0, "creation_date": 1548347757, "post_id": 54336650, "comment_id": 95518113, "body": "@RaunakJhawar Sort of. While I do want to process messages only once, my biggest concern right now is the ability to prevent out of order processing. If one consumer takes offset=1 but hasn&#39;t commited it yet, I don&#39;t want a different consumer to receive offset=2. I&#39;d rather the second consumer find a different topic that doesn&#39;t have a &quot;sent but uncommitted&quot; message at the front of the queue. If all topics have a message being processed by a different consumer, I&#39;d rather wait than risk doing things out of order."}, {"owner": {"reputation": 1193, "user_id": 2790312, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/D2mv6.jpg?s=128&g=1", "display_name": "Raunak Jhawar", "link": "https://stackoverflow.com/users/2790312/raunak-jhawar"}, "edited": false, "score": 0, "creation_date": 1548358836, "post_id": 54336650, "comment_id": 95523452, "body": "Generally speaking, you cannot. Even if you had a single consumer that consumed all the partitions for the topic, the partitions would be consumed in a non-deterministic order and your total ordering across all partitions would not be guaranteed."}, {"owner": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "reply_to_user": {"reputation": 1193, "user_id": 2790312, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/D2mv6.jpg?s=128&g=1", "display_name": "Raunak Jhawar", "link": "https://stackoverflow.com/users/2790312/raunak-jhawar"}, "edited": false, "score": 0, "creation_date": 1548360716, "post_id": 54336650, "comment_id": 95524298, "body": "@RaunakJhawar Are there any big problems with just having one partition per topic? That should enforce order from what I&#39;ve read. I&#39;m not expecting any topic to get very large."}, {"owner": {"reputation": 1193, "user_id": 2790312, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/D2mv6.jpg?s=128&g=1", "display_name": "Raunak Jhawar", "link": "https://stackoverflow.com/users/2790312/raunak-jhawar"}, "edited": false, "score": 0, "creation_date": 1548360888, "post_id": 54336650, "comment_id": 95524383, "body": "More partitions lead to higher throughput, hence a higher degree of parallelism and hence better use of cluster resources."}, {"owner": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "reply_to_user": {"reputation": 1193, "user_id": 2790312, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/D2mv6.jpg?s=128&g=1", "display_name": "Raunak Jhawar", "link": "https://stackoverflow.com/users/2790312/raunak-jhawar"}, "edited": false, "score": 0, "creation_date": 1548360965, "post_id": 54336650, "comment_id": 95524409, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/187285/discussion-between-corey-ogburn-and-raunak-jhawar\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1193, "user_id": 2790312, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/D2mv6.jpg?s=128&g=1", "display_name": "Raunak Jhawar", "link": "https://stackoverflow.com/users/2790312/raunak-jhawar"}, "is_accepted": false, "score": 0, "last_activity_date": 1548362022, "creation_date": 1548362022, "answer_id": 54354901, "question_id": 54336650, "link": "https://stackoverflow.com/questions/54336650/how-can-i-ensure-my-consumers-process-messages-in-kafka-topics-in-order-only-on/54354901#54354901", "title": "How can I ensure my consumers process messages in kafka topics in order, only once?", "body": "<p>Generally speaking, you cannot. Even if you had a single consumer that consumed all the partitions for the topic, the partitions would be consumed in a non-deterministic order and your total ordering across all partitions would not be guaranteed. </p>\n\n<p>Try Keyed Messages, think you may find this of good use for your use case.</p>\n"}], "owner": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 674, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1548362022, "creation_date": 1548282368, "last_edit_date": 1548284702, "question_id": 54336650, "link": "https://stackoverflow.com/questions/54336650/how-can-i-ensure-my-consumers-process-messages-in-kafka-topics-in-order-only-on", "title": "How can I ensure my consumers process messages in kafka topics in order, only once?", "body": "<p>I've never used kafka before. I have two test Go programs accessing a local kafka instance: a reader and a writer. I'm trying to tweak my producer, consumer, and kafka server settings to get a particular behavior.</p>\n\n<p>My writer:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"strconv\"\n    \"time\"\n\n    \"github.com/confluentinc/confluent-kafka-go/kafka\"\n)\n\nfunc main() {\n    rand.Seed(time.Now().UnixNano())\n\n    topics := []string{\n        \"policymanager-100\",\n        \"policymanager-200\",\n        \"policymanager-300\",\n    }\n    progress := make(map[string]int)\n    for _, t := range topics {\n        progress[t] = 0\n    }\n\n    producer, err := kafka.NewProducer(&amp;kafka.ConfigMap{\n        \"bootstrap.servers\": \"localhost\",\n        \"group.id\":          \"0\",\n    })\n    if err != nil {\n        panic(err)\n    }\n    defer producer.Close()\n\n    fmt.Println(\"producing messages...\")\n    for i := 0; i &lt; 30; i++ {\n        index := rand.Intn(len(topics))\n        topic := topics[index]\n        num := progress[topic]\n        num++\n        fmt.Printf(\"%s =&gt; %d\\n\", topic, num)\n        msg := &amp;kafka.Message{\n            Value: []byte(strconv.Itoa(num)),\n            TopicPartition: kafka.TopicPartition{\n                Topic: &amp;topic,\n            },\n        }\n        err = producer.Produce(msg, nil)\n        if err != nil {\n            panic(err)\n        }\n        progress[topic] = num\n        time.Sleep(time.Millisecond * 100)\n    }\n    fmt.Println(\"DONE\")\n}\n</code></pre>\n\n<p>There are three topics that exist on my local kafka: policymanager-100, policymanager-200, policymanager-300. They each only have 1 partition to ensure all messages are sorted by the time kafka receives them. My writer will randomly pick one of those topics and issue a message consisting of a number that increments solely for that topic. When it's done running, I expect the queues to look something like this (topic names shortened for legibility):</p>\n\n<pre><code>100: 1 2 3 4 5 6 7 8 9 10 11\n200: 1 2 3 4 5 6 7\n300: 1 2 3 4 5 6 7 8 9 10 11 12\n</code></pre>\n\n<p>So far so good. I'm trying to configure things so that any number of consumers can be spun up and consume these messages in order. By \"in-order\" I mean that no consumer should get message 2 for topic 100 until message 1 is COMPLETED (not just started). If message 1 for topic 100 is being worked on, consumers are free to consume from other topics that currently don't have a message being processed. If a message of a topic has been sent to a consumer, that entire topic should become \"locked\" until either a timeout assumes that the consumer failed or the consumer commits the message, then the topic is \"unlocked\" to have it's next message made available to be consumed.</p>\n\n<p>My reader:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n\n    \"github.com/confluentinc/confluent-kafka-go/kafka\"\n)\n\nfunc main() {\n    count := 2\n    for i := 0; i &lt; count; i++ {\n        go consumer(i + 1)\n    }\n    fmt.Println(\"cosuming...\")\n    // hold this thread open indefinitely\n    select {}\n}\n\nfunc consumer(id int) {\n    c, err := kafka.NewConsumer(&amp;kafka.ConfigMap{\n        \"bootstrap.servers\":  \"localhost\",\n        \"group.id\":           \"0\", // strconv.Itoa(id),\n        \"enable.auto.commit\": \"false\",\n    })\n    if err != nil {\n        panic(err)\n    }\n\n    c.SubscribeTopics([]string{`^policymanager-.+$`}, nil)\n    for {\n        msg, err := c.ReadMessage(-1)\n        if err != nil {\n            panic(err)\n        }\n\n        fmt.Printf(\"%d) Message on %s: %s\\n\", id, msg.TopicPartition, string(msg.Value))\n        time.Sleep(time.Second)\n        _, err = c.CommitMessage(msg)\n        if err != nil {\n            fmt.Printf(\"ERROR commiting: %+v\\n\", err)\n        }\n    }\n}\n</code></pre>\n\n<p>From my current understanding, the way I'm likely to achieve this is by setting up my consumer properly. I've tried many different variations of this program. I've tried having all my goroutines share the same consumer. I've tried using a different <code>group.id</code> for each goroutine. None of these was the right configuration to get the behavior I'm after.</p>\n\n<p>What the posted code does is empty out one topic at a time. Despite having multiple goroutines, the process will read all of 100 then move to 200 then 300 and only one goroutine will actually do all the reading. When I let each goroutine have a different <code>group.id</code> then messages get read by multiple goroutines which I would like to prevent.</p>\n\n<p>My example consumer is simply breaking things up with goroutines but when I begin working this project into my use case at work, I'll need this to work across multiple kubernetes instances that won't be talking to each other so using anything that interacts between goroutines won't work as soon as there are 2 instances on 2 kubes. That's why I'm hoping to make kafka do the gatekeeping I want.</p>\n"}, {"tags": ["go", "concurrency"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1548278899, "post_id": 54335907, "comment_id": 95489126, "body": "The context method is simpler, composable, allows for cancel or timeout, and standard. Why would you <i>not</i> use it?"}], "answers": [{"comments": [{"owner": {"reputation": 461, "user_id": 7359470, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3d7fb653bc3eb067f9dd9b2019e653bd?s=128&d=identicon&r=PG&f=1", "display_name": "mofury", "link": "https://stackoverflow.com/users/7359470/mofury"}, "edited": false, "score": 1, "creation_date": 1548359925, "post_id": 54336263, "comment_id": 95523946, "body": "Awesome, I wasn&#39;t sure what is the latest canonical approach to goroutine cancellation because I think I saw a misleading article and thought some people are arguing for the case that context isn&#39;t for cancellation. With your answer, I think it further confirms that context should be the default go-to method for cancellation."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 1, "last_activity_date": 1548280324, "creation_date": 1548280324, "answer_id": 54336263, "question_id": 54335907, "link": "https://stackoverflow.com/questions/54335907/context-package-vs-done-channel-to-avoid-goroutine-leak/54336263#54336263", "title": "Context package vs done channel to avoid goroutine leak", "body": "<blockquote>\n  <p><a href=\"https://golang.org/doc/go1.7\" rel=\"nofollow noreferrer\">Go 1.7 Release Notes</a></p>\n  \n  <p><a href=\"https://golang.org/doc/go1.7#context\" rel=\"nofollow noreferrer\">Context</a></p>\n  \n  <p>Go 1.7 moves the golang.org/x/net/context package into the standard\n  library as context. This allows the use of contexts for cancelation,\n  timeouts, and passing request-scoped data in other standard library\n  packages, including net, net/http, and os/exec, as noted below.</p>\n  \n  <p>For more information about contexts, see the <a href=\"https://golang.org/pkg/context/\" rel=\"nofollow noreferrer\">package\n  documentation</a> and the Go blog post \u201c<a href=\"https://blog.golang.org/context\" rel=\"nofollow noreferrer\">Go Concurrent Patterns:\n  Context</a>.\u201d</p>\n</blockquote>\n\n<hr>\n\n<p>There were problems. The context package was introduced to solve them. </p>\n\n<p>Now that you have read all of the relevant documentation, What is your question?</p>\n"}], "owner": {"reputation": 461, "user_id": 7359470, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3d7fb653bc3eb067f9dd9b2019e653bd?s=128&d=identicon&r=PG&f=1", "display_name": "mofury", "link": "https://stackoverflow.com/users/7359470/mofury"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1235, "favorite_count": 2, "accepted_answer_id": 54336263, "answer_count": 1, "score": 4, "last_activity_date": 1548285731, "creation_date": 1548278804, "last_edit_date": 1548285731, "question_id": 54335907, "link": "https://stackoverflow.com/questions/54335907/context-package-vs-done-channel-to-avoid-goroutine-leak", "title": "Context package vs done channel to avoid goroutine leak", "body": "<p>There are two different approaches to clean up a goroutine.</p>\n\n<ol>\n<li><p>Use a kill channel to signal cancellation and a done channel to indicate that goroutine has been terminated.</p>\n\n<pre><code>type Worker struct {\n  Done chan struct{}\n  Kill chan struct{}\n  Jobs chan Job\n}\n\nfunc (w *Worker) Run() {\n  defer func() {\n    w.Done &lt;- struct{}{}\n  }\n  for {\n    select {\n    case &lt;-w.Kill:\n      return\n    case j := &lt;-w.Jobs:\n      // Do some work\n  }\n}\n\ngo w.Run()\nw.Kill &lt;- struct{}{}\n</code></pre></li>\n<li><p>Use <code>context</code> to cancel</p>\n\n<pre><code>type Worker struct {\n  Ctx context.Context\n  Cancel context.CancelFunc\n  Jobs chan Job\n}\n\nfunc (w *Worker) Run() {\n  for {\n    select {\n    case &lt;-w.Ctx.Done():\n      return\n    case j := &lt;-w.Jobs:\n      // Do some work\n  }\n}\n\ngo w.Run()\nw.Cancel()\n</code></pre></li>\n</ol>\n\n<p>What are the pros/cons of each approach? Which one should I default to? </p>\n\n<p>I understand that if I want to kill a tree of interconnected goroutines, I should go with context approach but let's just say I have a simple worker that doesn't start other goroutines internally. </p>\n"}, {"tags": ["go", "delve"], "comments": [{"owner": {"reputation": 7872, "user_id": 7841, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/3KsHr.png?s=128&g=1", "display_name": "Leonardo Herrera", "link": "https://stackoverflow.com/users/7841/leonardo-herrera"}, "edited": false, "score": 0, "creation_date": 1548269511, "post_id": 54333761, "comment_id": 95485273, "body": "Did you read <a href=\"https://stackoverflow.com/questions/52230503/decoding-dwarf-section-info-at-offset-0x0-too-short\">this answer</a>?"}, {"owner": {"reputation": 15305, "user_id": 147530, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb9f657e0b37fa483135635211e7d167?s=128&d=identicon&r=PG", "display_name": "morpheus", "link": "https://stackoverflow.com/users/147530/morpheus"}, "reply_to_user": {"reputation": 7872, "user_id": 7841, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/3KsHr.png?s=128&g=1", "display_name": "Leonardo Herrera", "link": "https://stackoverflow.com/users/7841/leonardo-herrera"}, "edited": false, "score": 0, "creation_date": 1548349212, "post_id": 54333761, "comment_id": 95518976, "body": "Yes we have. Is there anything in that answer that we have not tried?"}], "answers": [{"tags": [], "owner": {"reputation": 141, "user_id": 318750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9afa1f3c5d62df3115e29f064a9fde8?s=128&d=identicon&r=PG", "display_name": "user318750", "link": "https://stackoverflow.com/users/318750/user318750"}, "is_accepted": false, "score": 3, "last_activity_date": 1552898344, "creation_date": 1552898344, "answer_id": 55217399, "question_id": 54333761, "link": "https://stackoverflow.com/questions/54333761/unable-to-debug-go-code-could-not-launch-process-decoding-dwarf-section-info-a/55217399#55217399", "title": "Unable to debug Go code: could not launch process: decoding dwarf section info at offset 0x0: too short", "body": "<p>I had the same issue after updateing Go.\nUpdating Delve package from console helped:</p>\n\n<pre><code>go get -u github.com/go-delve/delve/cmd/dlv\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15305, "user_id": 147530, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb9f657e0b37fa483135635211e7d167?s=128&d=identicon&r=PG", "display_name": "morpheus", "link": "https://stackoverflow.com/users/147530/morpheus"}, "is_accepted": true, "score": 1, "last_activity_date": 1572046541, "creation_date": 1572046541, "answer_id": 58566855, "question_id": 54333761, "link": "https://stackoverflow.com/questions/54333761/unable-to-debug-go-code-could-not-launch-process-decoding-dwarf-section-info-a/58566855#58566855", "title": "Unable to debug Go code: could not launch process: decoding dwarf section info at offset 0x0: too short", "body": "<p>The solution that worked for us was to upgrade Go version</p>\n\n<pre><code>$ go version\ngo version go1.13.3 darwin/amd64\n</code></pre>\n\n<p>So Go 1.11 is the culprit.</p>\n"}, {"tags": [], "owner": {"reputation": 779, "user_id": 6484371, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9739ce20bf000c611ddf35e50443aadd?s=128&d=identicon&r=PG&f=1", "display_name": "ByteMe", "link": "https://stackoverflow.com/users/6484371/byteme"}, "is_accepted": false, "score": 1, "last_activity_date": 1586990113, "creation_date": 1586990113, "answer_id": 61239769, "question_id": 54333761, "link": "https://stackoverflow.com/questions/54333761/unable-to-debug-go-code-could-not-launch-process-decoding-dwarf-section-info-a/61239769#61239769", "title": "Unable to debug Go code: could not launch process: decoding dwarf section info at offset 0x0: too short", "body": "<p>make sure you aren't using flags that remove the debug info from your build ie -ldflags=\"-s -w\" .  </p>\n\n<p><a href=\"https://lukeeckley.com/post/useful-go-build-flags/\" rel=\"nofollow noreferrer\">https://lukeeckley.com/post/useful-go-build-flags/</a></p>\n"}], "owner": {"reputation": 15305, "user_id": 147530, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb9f657e0b37fa483135635211e7d167?s=128&d=identicon&r=PG", "display_name": "morpheus", "link": "https://stackoverflow.com/users/147530/morpheus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3010, "favorite_count": 0, "accepted_answer_id": 58566855, "answer_count": 3, "score": 2, "last_activity_date": 1586990113, "creation_date": 1548269119, "question_id": 54333761, "link": "https://stackoverflow.com/questions/54333761/unable-to-debug-go-code-could-not-launch-process-decoding-dwarf-section-info-a", "title": "Unable to debug Go code: could not launch process: decoding dwarf section info at offset 0x0: too short", "body": "<p>we are trying to debug Go code and getting this error:</p>\n\n<pre><code>could not launch process: decoding dwarf section info at offset 0x0: too short\n</code></pre>\n\n<p>our settings:</p>\n\n<pre><code>WITSC02X6385JGH:orderer sjain68$ uname -a\nDarwin WITSC02X6385JGH 17.7.0 Darwin Kernel Version 17.7.0: Fri Jul  6 19:54:51 PDT 2018; root:xnu-4570.71.3~2/RELEASE_X86_64 x86_64\nWITSC02X6385JGH:orderer sjain68$ go version\ngo version go1.11 darwin/amd64\nWITSC02X6385JGH:orderer sjain68$ dlv version\nDelve Debugger\nVersion: 1.1.0\nBuild: $Id: 1990ba12450cab9425a2ae62e6ab988725023d5c\n</code></pre>\n\n<p>Things we have tried:</p>\n\n<ul>\n<li>Update dlv using VS Code -> Go: Install/Update Tools</li>\n</ul>\n\n<p>Try running from command line:</p>\n\n<pre><code>WITSC02X6385JGH:orderer sjain68$ /Users/sjain68/go/bin/dlv debug github.com/hyperledger/fabric/orderer --headless=true --listen=127.0.0.1:41305 --api-version=2 --log=true --\nAPI server listening at: 127.0.0.1:41305\nINFO[0002] launching process with args: [/Users/sjain68/go/src/github.com/hyperledger/fabric/orderer/debug]  layer=debugger\ndebugserver-@(#)PROGRAM:debugserver  PROJECT:debugserver-902.0.79.7\n for x86_64.\nGot a connection, launched process /Users/sjain68/go/src/github.com/hyperledger/fabric/orderer/debug (pid = 9278).\nExiting.\ncould not launch process: decoding dwarf section info at offset 0x0: too short\n</code></pre>\n\n<p>Note that the binary that we are trying to debug does gets executed. Its just that the debugger does not launch.</p>\n\n<p>Another thing we tried from <a href=\"https://github.com/go-delve/delve/issues/1138\" rel=\"nofollow noreferrer\">this</a> link:</p>\n\n<pre><code>WITSC02X6385JGH:orderer sjain68$ export GOFLAGS=\"-ldflags=-compressdwarf=false\"; dlv debug\ncould not launch process: decoding dwarf section info at offset 0x0: too short\n</code></pre>\n\n<p>Someone said to run GOCACHE=off go build ... and output of that is pasted <a href=\"https://gist.github.com/siddjain/50013fc545ed22d3f5766677f20839db\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>How can we fix this?</p>\n"}, {"tags": ["go", "tcp", "httpserver", "keep-alive", "aws-alb"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1548255832, "post_id": 54330107, "comment_id": 95478241, "body": "Behind an ALB they may not be in an idle keep-alive state for 180s, they may be active for e.g. health checks. Try running it with a load generator pointed directly at the service without a load balancer and see what it does."}, {"owner": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1549005231, "post_id": 54330107, "comment_id": 95756472, "body": "I tried without ALB connections get closed after <code>time_wait</code> state, where as with ALB it is not exhibiting the same behaviour"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1549032706, "post_id": 54330107, "comment_id": 95770712, "body": "That sounds right, for the reason stated in my original comment. Nothing is wrong, it&#39;s just how load balancers work."}, {"owner": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1550231320, "post_id": 54330107, "comment_id": 96202833, "body": "@Adrian But there should be only few connetions which are there for heath checks  not like in thousands of connetions, right? As I have mentioned in the graph connections are taking too long to come to normal"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1550241625, "post_id": 54330107, "comment_id": 96208606, "body": "Not just for health checks, for actual traffic. The load balancer will maintain keep-alive connections to the backing server in order to route traffic, and the number of connections it holds open will be based on volume."}, {"owner": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1550300419, "post_id": 54330107, "comment_id": 96226183, "body": "@Adrian Actually I removed the instances from load balancer to check whether connections are coming down or not. But still all the connections are in keep-alive state and after 180secs they again go to keep-alive state."}], "answers": [{"tags": [], "owner": {"reputation": 6059, "user_id": 62735, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/51d4559d326e8515c726c64ce04acc06?s=128&d=identicon&r=PG", "display_name": "Ask Bj&#248;rn Hansen", "link": "https://stackoverflow.com/users/62735/ask-bj%c3%b8rn-hansen"}, "is_accepted": false, "score": 0, "last_activity_date": 1557535530, "creation_date": 1557535530, "answer_id": 56086332, "question_id": 54330107, "link": "https://stackoverflow.com/questions/54330107/keep-alive-ttl-in-go-transport-never-closes-connections/56086332#56086332", "title": "keep-alive TTL in Go Transport never closes connections", "body": "<p>When you setup your server you should add timeouts appropriate for your application, for example</p>\n\n<pre><code>srv := &amp;http.Server{\n    ReadTimeout:  5 * time.Second,\n    WriteTimeout: 20 * time.Second,\n    IdleTimeout:  180 * time.Second,\n    Handler:      myMux,\n}\n</code></pre>\n\n<p>With this the idle connections should get turned off. If it's an upstream load balancer sending health checks on that many connections the solution would be different.</p>\n"}], "owner": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 219, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1557535530, "creation_date": 1548255723, "last_edit_date": 1549025979, "question_id": 54330107, "link": "https://stackoverflow.com/questions/54330107/keep-alive-ttl-in-go-transport-never-closes-connections", "title": "keep-alive TTL in Go Transport never closes connections", "body": "<p>I have an application hosted on AWS which is running on Production creates an http server as mentioned in the below sample code. There is default timeout of 180 seconds in the go library. So, ideally connections not used should be closed after 180 seconds. </p>\n\n<pre><code>myMux := http.NewServeMux()\nmyMux.Handle(\"/SOME_PATH\", appHandler{myHandler})\nerr = http.ListenAndServe(viper.GetString(\"handler.port\"), myMux)\n</code></pre>\n\n<p>The problem is when traffic increases on the application, number of connections increases. But when traffic comes down number of connections remains same. </p>\n\n<p>I am using <code>go version go1.10 linux/amd64</code> and this application is behind Amazon ALB. </p>\n\n<p><strong>Edited question:</strong></p>\n\n<p>As you can see the rate at which connections are decreasing is very slow when application is behind ALB. So, what could be the problem\n<a href=\"https://i.stack.imgur.com/aeQAI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aeQAI.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["go", "rabbitmq", "microservices", "go-micro"], "owner": {"reputation": 2008, "user_id": 710618, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/779233af08fd9f187990a44146f1778c?s=128&d=identicon&r=PG", "display_name": "Alexandre Thenorio", "link": "https://stackoverflow.com/users/710618/alexandre-thenorio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 313, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1548255231, "creation_date": 1548255079, "last_edit_date": 1548255231, "question_id": 54329900, "link": "https://stackoverflow.com/questions/54329900/how-to-set-broker-subscriberoptions-in-go-micro", "title": "How to set broker.SubscriberOptions in go-micro", "body": "<p>I am trying to configure a RabbitMQ broker using the <code>go-micro</code> framework. I have noticed that the broker interface in go-micro has a <code>broker.SubscriberOptions</code> <a href=\"https://github.com/micro/go-micro/blob/master/broker/options.go\" rel=\"nofollow noreferrer\">struct</a> which allows configuring the parameters I am looking for (AutoAck, Queue name and so on) however I am unable to figure out how to pass this when starting a broker.</p>\n\n<p>This is how a simple rabbit go-micro setup would look like</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n\n    \"github.com/micro/go-micro/server\"\n    \"github.com/micro/go-plugins/broker/rabbitmq\"\n\n    micro \"github.com/micro/go-micro\"\n)\n\n\nfunc main() {\n    // Create a new service. Optionally include some options here.\n    service := micro.NewService(\n        micro.Name(\"go-micro-rabbit\"),\n        micro.Broker(rabbitmq.NewBroker()),\n    )\n\n    // Init will parse the command line flags.\n    service.Init()\n\n    // Register handler\n    proto.RegisterGreeterHandler(service.Server(), new(Greeter))\n\n    micro.RegisterSubscriber(\"micro-exchange\", service.Server(), myFunc, server.SubscriberQueue(\"my-queue\"))\n\n    // Run the server\n    if err := service.Run(); err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>The <code>micro.RegisterSubscriber</code> method takes in a list of <code>server.SubscriberOption</code> but does not allow me to set the <code>broker.SubscriberOptions</code> and the <code>rabbitmq.NewBroker</code> allows setting <code>broker.Options</code> but once again, not <code>broker.SubscriberOptions</code></p>\n\n<p>I have dug in the code of go-micro but have been unable to figure out how the <code>broker.Subscribe</code> method (Which exposes the correct struct) is called or by who.</p>\n\n<p>Is this possible at all? Is it maybe something not yet fully fleshed out in the API?</p>\n"}, {"tags": ["string", "go"], "comments": [{"owner": {"reputation": 19, "user_id": 10057683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddfa1005664df121acaf346951061c15?s=128&d=identicon&r=PG&f=1", "display_name": "nagleria", "link": "https://stackoverflow.com/users/10057683/nagleria"}, "edited": false, "score": 0, "creation_date": 1548251927, "post_id": 54328876, "comment_id": 95475753, "body": "<a href=\"https://stackoverflow.com/questions/44448384/how-remove-n-from-lines-from-golang\">possible duplicate question here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1548253795, "post_id": 54328979, "comment_id": 95476868, "body": "Just a small note, using <code>%q</code> it actually ends with <code>\\r\\n&quot;</code> because it also wraps the input string in quote characters."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1548255620, "last_edit_date": 1548255620, "creation_date": 1548252066, "answer_id": 54328979, "question_id": 54328876, "link": "https://stackoverflow.com/questions/54328876/how-to-remove-trailing-r-n-from-string/54328979#54328979", "title": "how to remove trailing &quot;\\r\\n&quot; from string", "body": "<p><a href=\"https://golang.org/pkg/strings/#TrimRight\" rel=\"nofollow noreferrer\"><code>strings.TrimRight()</code></a> works just fine. The \"problem\" in your case is that the <code>string</code> value stored in the <code>a</code> variable <strong>does not end</strong> with <code>\"\\r\\n\"</code>.</p>\n\n<p>The reason for that is because you \"quote\" it using <a href=\"https://golang.org/pkg/fmt/#Sprintf\" rel=\"nofollow noreferrer\"><code>fmt.Sprintf()</code></a>, and the string will end with <code>\"\\\\r\\\\n\"</code>, and additionally even a double quotation mark will be added to it (that is, it ends with a backslash, the letter <code>r</code>, another backslash, the letter <code>n</code> and a double quote character).</p>\n\n<p>If you don't quote your string, then:</p>\n\n<pre><code>var s = \"\\b\\x02\\b\\x02\\r\\n\"\nfmt.Printf(\"s: %q\\n\", s)\nb := strings.TrimRight(s, \"\\r\\n\")\nfmt.Printf(\"b: %q\\n\", b)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/mflUfqVJs8R\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>s: \"\\b\\x02\\b\\x02\\r\\n\"\nb: \"\\b\\x02\\b\\x02\"\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 6821422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PHi21.png?s=128&g=1", "display_name": "Jeet", "link": "https://stackoverflow.com/users/6821422/jeet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 316, "favorite_count": 0, "accepted_answer_id": 54328979, "answer_count": 1, "score": -4, "last_activity_date": 1548255620, "creation_date": 1548251700, "last_edit_date": 1548251982, "question_id": 54328876, "link": "https://stackoverflow.com/questions/54328876/how-to-remove-trailing-r-n-from-string", "title": "how to remove trailing &quot;\\r\\n&quot; from string", "body": "<p>I tried with the following code but getting the same string in result:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    var s = \"\\b\\x02\\b\\x02\\r\\n\"\n    a := fmt.Sprintf(\"%q\", s)\n    fmt.Println(\"a:\", a)\n    b := strings.TrimRight(a, \"\\r\\n\")\n    fmt.Println(\"b:\", b)\n}\n</code></pre>\n"}, {"tags": ["docker", "debugging", "go", "docker-compose", "goland"], "owner": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 312, "favorite_count": 3, "answer_count": 0, "score": 1, "last_activity_date": 1595452110, "creation_date": 1548250720, "last_edit_date": 1548618592, "question_id": 54328580, "link": "https://stackoverflow.com/questions/54328580/how-to-debug-a-dockerized-golang-app-with-goland-ide-and-docker-compose", "title": "How to debug a dockerized Golang app with Goland IDE and Docker compose", "body": "<p>I am coding an dockerized Golang app with IDE Goland and Docker Compose because my code depends on several services.</p>\n\n<p>I have found on internet <a href=\"https://blog.jetbrains.com/go/2018/04/30/debugging-containerized-go-applications/\" rel=\"nofollow noreferrer\">posts like this</a> that describe how to debug a Dockerized Golang app but I don't know how to do it when I launch my containers with docker-compose</p>\n\n<p>Any idea how to do it ?</p>\n"}, {"tags": ["xml", "function", "go", "struct", "slice"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1548250464, "post_id": 54328437, "comment_id": 95474876, "body": "Writing generic code in Go is hard. Best advice is: Write three non-generic, special implementations and try to combine them afterwards. For your question: I have no idea what your code tries to do."}, {"owner": {"reputation": 181, "user_id": 5556365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4660fb9830aab225da5fa7d39147aae9?s=128&d=identicon&r=PG&f=1", "display_name": "Amid", "link": "https://stackoverflow.com/users/5556365/amid"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1548251901, "post_id": 54328437, "comment_id": 95475738, "body": "@Volker I am trying to read an xml file and append it to a slice. I just want to wirte a function for it."}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 5556365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4660fb9830aab225da5fa7d39147aae9?s=128&d=identicon&r=PG&f=1", "display_name": "Amid", "link": "https://stackoverflow.com/users/5556365/amid"}, "edited": false, "score": 0, "creation_date": 1612383036, "post_id": 54329077, "comment_id": 116753143, "body": "It seems that the draft design of Type Parameters is accepted. It is fully described here. <a href=\"https://go.googlesource.com/proposal/+/refs/heads/master/design/go2draft-type-parameters.md\" rel=\"nofollow noreferrer\">go.googlesource.com/proposal/+/refs/heads/master/design/&hellip;</a>"}], "tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": true, "score": 1, "last_activity_date": 1548298174, "last_edit_date": 1548298174, "creation_date": 1548252439, "answer_id": 54329077, "question_id": 54328437, "link": "https://stackoverflow.com/questions/54328437/pass-a-struct-to-a-function-as-a-parameter-and-return-a-slice-of-the-correspondi/54329077#54329077", "title": "Pass a struct to a function as a parameter and return a slice of the corresponding struct", "body": "<p>If you want a function that takes any struct type and returns a slice of it, like:</p>\n\n<pre><code>func MakeSlice(s ANY_STRUCT_TYPE) []ANY_STRUCT_TYPE\n</code></pre>\n\n<p>You're looking for generics, which Go doesn't currently support. See <a href=\"https://golang.org/doc/faq#generics\" rel=\"nofollow noreferrer\">this FAQ entry</a>.</p>\n\n<p>The Go team is working to <a href=\"https://go.googlesource.com/proposal/+/master/design/go2draft-generics-overview.md\" rel=\"nofollow noreferrer\">add generics to the language</a> - it's a work in progress, and everyone is free to participate in the discussion. Once generics exist, they will provide the solution you seek here.</p>\n\n<hr>\n\n<p>In the meantime, you could use <a href=\"https://blog.golang.org/generate\" rel=\"nofollow noreferrer\">code generation</a> or think of a slightly different design for your problem. Some code duplication is OK too, Go doesn't frown upon it as badly as some other languages.</p>\n"}], "owner": {"reputation": 181, "user_id": 5556365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4660fb9830aab225da5fa7d39147aae9?s=128&d=identicon&r=PG&f=1", "display_name": "Amid", "link": "https://stackoverflow.com/users/5556365/amid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 54329077, "answer_count": 1, "score": -2, "last_activity_date": 1548298174, "creation_date": 1548250241, "last_edit_date": 1548251632, "question_id": 54328437, "link": "https://stackoverflow.com/questions/54328437/pass-a-struct-to-a-function-as-a-parameter-and-return-a-slice-of-the-correspondi", "title": "Pass a struct to a function as a parameter and return a slice of the corresponding struct", "body": "<p>I am trying to write a function which can be used by different structs.\nThe return of the function has to be a slice of the corresponding struct.\nThus I need a function which accept a struct as a parameter and return a slice.\nMy code somehow looks like this but I have no idea how can I wrap it as a function?</p>\n\n<pre><code>type name struct{\n   FirstName string `xml:\"firstName\"`\n   LastName string `xml:\"lastName\"`\n  }\n\nfileList := TreeTraversal(\".\")\n    var a name\n    var b []name \n\n\nfor i := 0; i &lt; len(fileList); i++{\n    fileByte, _ := ioutil.ReadFile(fileList[i])\n\n    xml.Unmarshal(fileByte, &amp;a)\n    b = append(b, a)\n}\n</code></pre>\n\n<p>As far as I know I can pass a struct to a function as an interface, but I have no idea about the return type? </p>\n"}, {"tags": ["sorting", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1548249563, "post_id": 54328151, "comment_id": 95474322, "body": "If <code>sort.Slice</code> does not work for you then the answer is no."}, {"owner": {"reputation": 1041, "user_id": 365557, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/be74c8f8958cafb02ea319768e98daa4?s=128&d=identicon&r=PG", "display_name": "abonec", "link": "https://stackoverflow.com/users/365557/abonec"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1548250362, "post_id": 54328151, "comment_id": 95474821, "body": "I need to change sort direction if need. For this I use a <code>sort.Reverse</code> which takes a <code>sort.Interface</code>. How to change sort direction with <code>sort.Slice</code> without writing different less functions for sort different directions?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1548253461, "post_id": 54328151, "comment_id": 95476654, "body": "Just implement <code>sort.Interface</code> and use <code>sort.Sort</code>/<code>sort.Reverse</code> as needed."}, {"owner": {"reputation": 1041, "user_id": 365557, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/be74c8f8958cafb02ea319768e98daa4?s=128&d=identicon&r=PG", "display_name": "abonec", "link": "https://stackoverflow.com/users/365557/abonec"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1548255872, "post_id": 54328151, "comment_id": 95478262, "body": "@Adrian it is exactly what my current code is doing."}], "answers": [{"comments": [{"owner": {"reputation": 1041, "user_id": 365557, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/be74c8f8958cafb02ea319768e98daa4?s=128&d=identicon&r=PG", "display_name": "abonec", "link": "https://stackoverflow.com/users/365557/abonec"}, "edited": false, "score": 0, "creation_date": 1548255960, "post_id": 54329191, "comment_id": 95478316, "body": "I know about generics in go, and no, i don&#39;t looking for generics. I looking for less repetitive approach for sorting different collections."}], "tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": false, "score": 2, "last_activity_date": 1548298123, "last_edit_date": 1548298123, "creation_date": 1548252831, "answer_id": 54329191, "question_id": 54328151, "link": "https://stackoverflow.com/questions/54328151/one-sorter-function-for-sort-generic-collections/54329191#54329191", "title": "One sorter function for sort generic collections", "body": "<p>You're looking for generics, which Go doesn't currently support. See <a href=\"https://golang.org/doc/faq#generics\" rel=\"nofollow noreferrer\">this FAQ entry</a>.</p>\n\n<p>The Go team is working to <a href=\"https://go.googlesource.com/proposal/+/master/design/go2draft-generics-overview.md\" rel=\"nofollow noreferrer\">add generics to the language</a> - it's a work in progress, and everyone is free to participate in the discussion. Once generics exist, they will provide the solution you seek here.</p>\n\n<hr>\n\n<p>In the meantime, you could use <a href=\"https://blog.golang.org/generate\" rel=\"nofollow noreferrer\">code generation</a> or think of a slightly different design for your problem. Some code duplication is OK too, Go doesn't frown upon it as badly as some other languages.</p>\n"}], "owner": {"reputation": 1041, "user_id": 365557, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/be74c8f8958cafb02ea319768e98daa4?s=128&d=identicon&r=PG", "display_name": "abonec", "link": "https://stackoverflow.com/users/365557/abonec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1548298123, "creation_date": 1548249398, "question_id": 54328151, "link": "https://stackoverflow.com/questions/54328151/one-sorter-function-for-sort-generic-collections", "title": "One sorter function for sort generic collections", "body": "<p>In my project I have many collection (slices) of different data types. Any particular collection should define fields it can sort by. I want to write one sort function and call it with user input (sort field and order) whenever collection should be sorted. I came up with the following boilerplate code (described only one type of collection, but for others it will be the same): <a href=\"https://gist.github.com/abonec/f1ee23a38e78ea48d470c39885de47ba\" rel=\"nofollow noreferrer\">https://gist.github.com/abonec/f1ee23a38e78ea48d470c39885de47ba</a></p>\n\n<p>I have an interface <code>Sortable</code> for collections. Sortable should be passed to the <code>sortStats</code> with user input of sort field. If concrete implementation supports this type of sort it should return <code>sort.Interface</code> with corresponding interface.</p>\n\n<p>Problem with many repeated implementations of <code>sort.Interface</code> where <code>Len()</code> and <code>Swap()</code> method is identical. Different is only <code>Less()</code>.</p>\n\n<p>Is there any approach to get a rid of <code>Len()</code> and <code>Swap()</code> methods in this case or may be other approach to write generic sort function with dynamic sort field?</p>\n"}, {"tags": ["go", "kubernetes", "autoscaling"], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 1144052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eac180e34c4dd5d38839f2d9afe049a2?s=128&d=identicon&r=PG", "display_name": "James Munnelly", "link": "https://stackoverflow.com/users/1144052/james-munnelly"}, "is_accepted": true, "score": 4, "last_activity_date": 1548247857, "creation_date": 1548247857, "answer_id": 54327702, "question_id": 54327618, "link": "https://stackoverflow.com/questions/54327618/unit-tests-for-kubernetes-controller/54327702#54327702", "title": "Unit tests for kubernetes controller", "body": "<p>I think this is because you are missing an import of <code>_ \"k8s.io/kubernetes/pkg/apis/apps/install\"</code>.</p>\n\n<p>Without importing this path, there are no API groups or versions registered with the <code>schema</code> you are using to obtain the REST mapping.</p>\n\n<p>By importing the path, the API group will be registered, allowing the call to <code>schema.FromAPIVersionAndKind(\"apps/v1\", \"Deployment\").GroupKind()</code> to return a valid GroupKind.</p>\n"}], "owner": {"reputation": 1504, "user_id": 245052, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a78f18787f72e8ebc0449e04cde14470?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/245052/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "accepted_answer_id": 54327702, "answer_count": 1, "score": 1, "last_activity_date": 1548247857, "creation_date": 1548247573, "question_id": 54327618, "link": "https://stackoverflow.com/questions/54327618/unit-tests-for-kubernetes-controller", "title": "Unit tests for kubernetes controller", "body": "<p>I'm trying to write a controller and I'm having a few issues writing tests. </p>\n\n<p>I've used some code from the k8s HPA in my controller and I'm seeing something weird when using the <code>testrestmapper</code>.</p>\n\n<p>basically when running this <a href=\"https://github.com/kubernetes/kubernetes/blob/c6ebd126a77e75e6f80e1cd59da6b887e783c7c4/pkg/controller/podautoscaler/horizontal_test.go#L852\" rel=\"nofollow noreferrer\">test</a> with a breakpoint <a href=\"https://github.com/kubernetes/kubernetes/blob/7498c14218403c9a713f9e0747f2c6794a0da9c7/pkg/controller/podautoscaler/horizontal.go#L512\" rel=\"nofollow noreferrer\">here</a> I see the mappings are returned. </p>\n\n<p>When I do the same the mappings are not returned. </p>\n\n<p>What magic is happening here?</p>\n\n<p>The following test fails</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"github.com/stretchr/testify/assert\"\n    \"k8s.io/apimachinery/pkg/api/meta/testrestmapper\"\n    \"k8s.io/apimachinery/pkg/runtime/schema\"\n    \"k8s.io/kubernetes/pkg/api/legacyscheme\"\n    \"testing\"\n)\n\nfunc TestT(t *testing.T) {\n    mapper := testrestmapper.TestOnlyStaticRESTMapper(legacyscheme.Scheme)\n\n    gk := schema.FromAPIVersionAndKind(\"apps/v1\", \"Deployment\").GroupKind()\n    mapping, err := mapper.RESTMapping(gk)\n\n    assert.NoError(t, err)\n    assert.NotNil(t, mapping)\n}\n\n</code></pre>\n"}, {"tags": ["azure", "go", "azure-servicebus-queues"], "comments": [{"owner": {"reputation": 15558, "user_id": 9191057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lLVDw.png?s=128&g=1", "display_name": "Jerry Liu", "link": "https://stackoverflow.com/users/9191057/jerry-liu"}, "edited": false, "score": 0, "creation_date": 1548398553, "post_id": 54326241, "comment_id": 95534639, "body": "Not related to the error but there seems some mistake in your code, HandlerFunc is supposed to return <code>error</code> instead of <code>servicebus.DispositionAction</code>."}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 7255164, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh4.googleusercontent.com/-cE2wBWM4mOQ/AAAAAAAAAAI/AAAAAAAAAD0/zi0sUFSB6ug/photo.jpg?sz=128", "display_name": "farsana p b", "link": "https://stackoverflow.com/users/7255164/farsana-p-b"}, "edited": false, "score": 0, "creation_date": 1548654754, "post_id": 54363227, "comment_id": 95603521, "body": "@Jerry Liu ,@Peter Pan...I tried the example you provide.But I got another error again.   &gt;cannot convert func literal (type func(context.Context, *servicebus.Message) error) to type servicebus.HandlerFunc"}], "tags": [], "owner": {"reputation": 20467, "user_id": 4989676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jP8H6.jpg?s=128&g=1", "display_name": "Peter Pan", "link": "https://stackoverflow.com/users/4989676/peter-pan"}, "is_accepted": false, "score": 1, "last_activity_date": 1548411557, "creation_date": 1548411557, "answer_id": 54363227, "question_id": 54326241, "link": "https://stackoverflow.com/questions/54326241/error-when-retrieving-message-from-service-bus-queue/54363227#54363227", "title": "Error when retrieving message from Service Bus queue", "body": "<p>I searched for the error information in the Github repo, and I found the code <a href=\"https://github.com/Azure/azure-service-bus-go/blob/98fec12aac8b52e81ead4bdec8738987b8c33fa1/message.go#L100\" rel=\"nofollow noreferrer\"><code>ErrorNotFound              MessageErrorCondition = \"amqp:not-found\"</code></a>, but there is not any explaination for the error.</p>\n\n<p>I compared it with <a href=\"https://docs.microsoft.com/en-us/azure/service-bus-messaging/service-bus-messaging-exceptions#exception-types\" rel=\"nofollow noreferrer\"><code>Exception types</code></a> in C# from the offical document <code>Service Bus messaging exceptions</code> and my testing, I think it's the same as below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/0K2f0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0K2f0.png\" alt=\"enter image description here\"></a></p>\n\n<p>In my environment <code>go version go1.11.3 windows/amd64</code>, I run the similar code without an existing queue <code>MyQueueName</code>, I got the similar error below.</p>\n\n<blockquote>\n  <p>FATAL:  unhandled error link xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxxx: status code 404 and description: The messaging entity 'sb://.servicebus.windows.net/<strong>MyQueueName</strong>' <strong>could not be found</strong>. TrackingId:f9fc309d-xxxx-xxxx-xxxx-8fccd694f266_G42, SystemTracker:.servicebus.windows.MyQueueName, Timestamp:2019-01-25T09:45:28</p>\n</blockquote>\n\n<p>So I think the error means your Queue <code>MyQueueName</code> in your code is not existing in your Azure Service Bus, you should create it first before to use. </p>\n\n<p>Meanwhile, as @JerryLiu said, your code below has some mistakes.</p>\n\n<blockquote>\n<pre><code>err = q.ReceiveOne(ctx, servicebus.HandlerFunc(func(ctx context.Context, message *servicebus.Message) servicebus.DispositionAction {\n         fmt.Println(string(message.Data))\n         return message.Complete()\n     }))\n</code></pre>\n</blockquote>\n\n<p>According to the godoc for <a href=\"https://godoc.org/github.com/Azure/azure-service-bus-go\" rel=\"nofollow noreferrer\"><code>azure-service-bus-go</code></a>, the parameter type of <code>servicebus.HanderFunc</code> method must be <code>HandlerFunc</code> which is a function return <code>error</code>, not <code>servicebus.DispositionAction</code> in your code.</p>\n\n<p><a href=\"https://i.stack.imgur.com/XxQPN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XxQPN.png\" alt=\"enter image description here\"></a></p>\n\n<p>And the method <code>message.Complete</code> should be passed a parameter <code>ctx</code> (a <code>context</code> object) and return <code>error</code> that not match <code>servicebus.DispositionAction</code>. The <code>message.CompleteAction</code> method return <code>servicebus.DispositionAction</code> , but not suitable in the reciving message code.\n<a href=\"https://i.stack.imgur.com/zSSrl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zSSrl.png\" alt=\"enter image description here\"></a></p>\n\n<p>Please refer to the example of godoc <a href=\"https://godoc.org/github.com/Azure/azure-service-bus-go#example-package--QueueSendAndReceive\" rel=\"nofollow noreferrer\"><code>Example (QueueSendAndReceive)</code></a> to modify your code.</p>\n"}], "owner": {"reputation": 145, "user_id": 7255164, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh4.googleusercontent.com/-cE2wBWM4mOQ/AAAAAAAAAAI/AAAAAAAAAD0/zi0sUFSB6ug/photo.jpg?sz=128", "display_name": "farsana p b", "link": "https://stackoverflow.com/users/7255164/farsana-p-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 760, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548411557, "creation_date": 1548242963, "last_edit_date": 1548397304, "question_id": 54326241, "link": "https://stackoverflow.com/questions/54326241/error-when-retrieving-message-from-service-bus-queue", "title": "Error when retrieving message from Service Bus queue", "body": "<p>I trying to pull messages from azure service bus queue using Go, but I got an error when running the code. Here is my code.</p>\n\n<pre><code>func Example_queue_receive() {\n   ctx, cancel :=context.WithTimeout(context.Background(),10*time.Second)\n   defer cancel() \n   connectionString :=\"Endpoint=sb://{my_service_name}.servicebus.windows.net/;SharedAccessKeyName = RootManageSharedAccessKey;SharedAccessKey={my_shared_access_key_value}\" \n\n    // Create a client to communicate with a Service Bus Namespace.\n    ns, err := servicebus.NewNamespace(servicebus.NamespaceWithConnectionString(connectionString))\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    // Create a client to communicate with the queue.\n    q, err := ns.NewQueue(\"MyQueueName\")\n    if err != nil {\n       fmt.Println(\"FATAL: \", err)\n    }\n\n    err = q.ReceiveOne(ctx, servicebus.HandlerFunc(func(ctx context.Context, message *servicebus.Message) servicebus.DispositionAction {\n         fmt.Println(string(message.Data))\n         return message.Complete()\n     }))\n    if err != nil {\n        fmt.Println(\"FATAL: \", err)\n    }\n\n}\n</code></pre>\n\n<p>This is the error:</p>\n\n<blockquote>\n  <p>link detached, reason: *Error{Condition: amqp:not-found}</p>\n</blockquote>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 5, "creation_date": 1548229436, "post_id": 54321676, "comment_id": 95463185, "body": "Honest advice: If you are &quot;new in programming&quot; you should basically <i>never</i> think about &quot;optimization difference&quot; of such trivia. Really. Never. Focus on correctness, sensible data structures and algorithms (which have <i>way</i> <i>larger</i> effect on runtime than <i>any</i> microoptimisation) and readability of your code."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1548253959, "post_id": 54321676, "comment_id": 95477000, "body": "<a href=\"https://golang.org/ref/spec#Declarations_and_scope\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Declarations_and_scope</a>"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 10, "last_activity_date": 1548227883, "creation_date": 1548227883, "answer_id": 54321879, "question_id": 54321676, "link": "https://stackoverflow.com/questions/54321676/go-declare-variable-outside-vs-declare-variable-inside-loop/54321879#54321879", "title": "Go Declare Variable outside vs Declare Variable Inside Loop", "body": "<p>The variables have different <a href=\"https://golang.org/ref/spec#Declarations_and_scope\" rel=\"noreferrer\">scopes</a>. It is usually best practice to use the smallest scope possible as in the second example.  </p>\n\n<p>There should be no optimization difference.</p>\n"}], "owner": {"reputation": 731, "user_id": 5865411, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/z2dJz.png?s=128&g=1", "display_name": "dev-x", "link": "https://stackoverflow.com/users/5865411/dev-x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1384, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548227883, "creation_date": 1548227053, "question_id": 54321676, "link": "https://stackoverflow.com/questions/54321676/go-declare-variable-outside-vs-declare-variable-inside-loop", "title": "Go Declare Variable outside vs Declare Variable Inside Loop", "body": "<p>I am a new in programming. I have two examples code in Go and its about loop using range. This is the first example:</p>\n\n<pre><code>Program A\n\ntype Test struct {\n    Text string\n}\n\nfunc main() {\n    tests := []Test{\n        Test{\"Test1\"},\n        Test{\"Test2\"},\n    }\n\n    var a Test\n    for _, test := range tests {\n        a = test\n        fmt.Println(a)\n    }\n}\n</code></pre>\n\n<p>This is the second example:</p>\n\n<pre><code>Program B\n\ntype Test struct {\n    Text string\n}\n\nfunc main() {\n    tests := []Test{\n        Test{\"Test1\"},\n        Test{\"Test2\"},\n    }\n\n    for _, test := range tests {\n        a := test\n        fmt.Println(a)\n    }\n}\n</code></pre>\n\n<p>In the first example 'a' is declared outside the loop, but in the second example 'a' is declared inside the loop. Like in the other programming language, what is the difference between two example program? Is there any optimization difference? Thank you.</p>\n"}, {"tags": ["go", "beego"], "comments": [{"owner": {"reputation": 2201, "user_id": 3359432, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5d48edbf794415b7f16c19c50d8cc524?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhin David", "link": "https://stackoverflow.com/users/3359432/nidhin-david"}, "edited": false, "score": 0, "creation_date": 1548226505, "post_id": 54321476, "comment_id": 95461965, "body": "golang maps does not guarantee ordered iteration <a href=\"https://stackoverflow.com/questions/18342784/how-to-iterate-through-a-map-in-golang-in-order\" title=\"how to iterate through a map in golang in order\">stackoverflow.com/questions/18342784/&hellip;</a>"}, {"owner": {"reputation": 113, "user_id": 5408831, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10205070334419398/picture?type=large", "display_name": "Nasihun Amin Suhardiyan", "link": "https://stackoverflow.com/users/5408831/nasihun-amin-suhardiyan"}, "reply_to_user": {"reputation": 2201, "user_id": 3359432, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5d48edbf794415b7f16c19c50d8cc524?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhin David", "link": "https://stackoverflow.com/users/3359432/nidhin-david"}, "edited": false, "score": 0, "creation_date": 1548226569, "post_id": 54321476, "comment_id": 95461985, "body": "I think is not duplicate, thats is the key number, but i have keys is predetermined @NidhinDavid , do I have to make integer in keys of array?"}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 5408831, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10205070334419398/picture?type=large", "display_name": "Nasihun Amin Suhardiyan", "link": "https://stackoverflow.com/users/5408831/nasihun-amin-suhardiyan"}, "edited": false, "score": 0, "creation_date": 1548227030, "post_id": 54321568, "comment_id": 95462162, "body": "Ah okay i got it, so I have to work twice, first classify the arrays, and the second is order the array keys , not as simple as I thought"}, {"owner": {"reputation": 113, "user_id": 5408831, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10205070334419398/picture?type=large", "display_name": "Nasihun Amin Suhardiyan", "link": "https://stackoverflow.com/users/5408831/nasihun-amin-suhardiyan"}, "edited": false, "score": 0, "creation_date": 1548228419, "post_id": 54321568, "comment_id": 95462717, "body": "Your alternative number two is much simpler, thanks ,im new in golang, and thank you for your knowledge"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1548227220, "last_edit_date": 1548227220, "creation_date": 1548226621, "answer_id": 54321568, "question_id": 54321476, "link": "https://stackoverflow.com/questions/54321476/how-to-range-array-in-golang-to-not-randomize-predetermined-key/54321568#54321568", "title": "How to range array in golang to not randomize predetermined key?", "body": "<p>The <a href=\"https://golang.org/ref/spec#For_range\" rel=\"nofollow noreferrer\">language specification says</a></p>\n\n<blockquote>\n  <p>The iteration order over maps is not specified and is not guaranteed to be the same from one iteration to the next. </p>\n</blockquote>\n\n<p>To iterate over a fixed set of keys in a known order, store those keys in a slice and iterate through the slice elements.</p>\n\n<pre><code>var orderdKeys = []string{\n   \"ShouldBeFirst\", \n   \"ShouldBeSecond\",\n   \"ShouldBeThird\",\n   \"ShouldBeFourth\",\n}\n\nfor _, k := range orderdKeys {\n    fmt.Println(k+\" = \"+CustomSql[k])\n}\n</code></pre>\n\n<p>Another option is to use a slice of values:</p>\n\n<pre><code> type nameSQL struct {\n   name string\n   sql string\n}\n\nCustomSql := []nameSQL{\n   {\"ShouldBeFirst\", \"Text Should Be First\"},\n   {\"ShouldBeSecond\", \"Text Should Be Second\"},\n   {\"ShouldBeThird\", \"Text Should Be Third\"},\n   {\"ShouldBeFourth\", \"Text Should Be Fourth\"},\n}\n\nfor _, ns := range CustomSql {\n    fmt.Println(ns.name+\" = \"+ns.sql)\n}\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 5408831, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10205070334419398/picture?type=large", "display_name": "Nasihun Amin Suhardiyan", "link": "https://stackoverflow.com/users/5408831/nasihun-amin-suhardiyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 1, "closed_date": 1548230389, "accepted_answer_id": 54321568, "answer_count": 1, "score": -2, "last_activity_date": 1548227220, "creation_date": 1548226222, "question_id": 54321476, "link": "https://stackoverflow.com/questions/54321476/how-to-range-array-in-golang-to-not-randomize-predetermined-key", "closed_reason": "Duplicate", "title": "How to range array in golang to not randomize predetermined key?", "body": "<p>I have a trouble with my current golang's project.</p>\n\n<p>I have another package in go that result an array with pretedermined key, example :</p>\n\n<pre><code>package updaters\n\nvar CustomSql map[string]string\n\nfunc InitSqlUpdater() {\n    CustomSql = map[string]string{\n        \"ShouldBeFirst\": \"Text Should Be First\",\n        \"ShouldBeSecond\": \"Text Should Be Second\",\n        \"ShouldBeThird\": \"Text Should Be Third\",\n        \"ShouldBeFourth\": \"Text Should Be Fourth\"\n   }\n}\n</code></pre>\n\n<p>And send it to main.go, to iterate each index and value, but the results is random (In my situation, I need that in sequence).</p>\n\n<p>Real Case : <a href=\"https://play.golang.org/p/ONXEiAj-Q4v\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ONXEiAj-Q4v</a></p>\n\n<p>I google why the golangs iterate in random way, and the example is using sort, but my array keys is predetermined, and sort is only for asc desc alphabet and number.</p>\n\n<p>So, How can I achieve the way that arrays is not being randomize in iterate?</p>\n\n<pre><code>ShouldBeFirst = Text Should Be First\nShouldBeSecond = Text Should Be Second\nShouldBeThird = Text Should Be Third\nShouldBeFourth = Text Should Be Fourth\n</code></pre>\n\n<p>Anyhelp will appreciate, thanks.</p>\n"}, {"tags": ["linux", "go", "networking", "tui"], "comments": [{"owner": {"reputation": 1027, "user_id": 814422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad082805d1ce2e3766886195c720fca6?s=128&d=identicon&r=PG", "display_name": "kbolino", "link": "https://stackoverflow.com/users/814422/kbolino"}, "edited": false, "score": 0, "creation_date": 1548364225, "post_id": 54320810, "comment_id": 95525822, "body": "You should check for errors coming out of those <code>io.Copy</code> calls in <code>startProg</code> as that may provide some indication of what&#39;s not working."}, {"owner": {"reputation": 21, "user_id": 10942694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a953477d869eb9ac198d91c83a8e4cbe?s=128&d=identicon&r=PG&f=1", "display_name": "pinecat", "link": "https://stackoverflow.com/users/10942694/pinecat"}, "reply_to_user": {"reputation": 1027, "user_id": 814422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad082805d1ce2e3766886195c720fca6?s=128&d=identicon&r=PG", "display_name": "kbolino", "link": "https://stackoverflow.com/users/814422/kbolino"}, "edited": false, "score": 0, "creation_date": 1548381366, "post_id": 54320810, "comment_id": 95530665, "body": "That&#39;s a good call.  Unfortunately there is no way to get return values when running a goroutine on a function (channels of course, but I can&#39;t edit io.Copy).  However, just playing around with it, doing one operation at a time, while not running any goroutines and getting the return values, err always comes back as &lt;nil&gt;."}, {"owner": {"reputation": 2731, "user_id": 74361, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/adca63afb01fa2d56850114c337476fb?s=128&d=identicon&r=PG", "display_name": "Bart Silverstrim", "link": "https://stackoverflow.com/users/74361/bart-silverstrim"}, "edited": false, "score": 0, "creation_date": 1595947519, "post_id": 54320810, "comment_id": 111646668, "body": "@pinecat Did you ever solve the problem of getting input and sending output when interacting with a connected client?"}], "owner": {"reputation": 21, "user_id": 10942694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a953477d869eb9ac198d91c83a8e4cbe?s=128&d=identicon&r=PG&f=1", "display_name": "pinecat", "link": "https://stackoverflow.com/users/10942694/pinecat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1548222988, "creation_date": 1548222988, "question_id": 54320810, "link": "https://stackoverflow.com/questions/54320810/sending-receiving-tui-data-over-socket-connection", "title": "Sending/Receiving TUI Data Over Socket Connection", "body": "<p>I have a TUI (text user interface) program that I would like to serve over a network connection.  A sample from the login page (which doesn't do much right now), is posted below.  I am using <a href=\"https://github.com/marcusolsson/tui-go\" rel=\"nofollow noreferrer\">tui-go</a> for my TUI library.</p>\n\n<blockquote>\n  <p>program.go</p>\n</blockquote>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"github.com/marcusolsson/tui-go\"\n)\n\nvar logo string = \"My Logo\"\n\nfunc main() {\n    Login()\n}\n\nfunc Login() {\n    inUser := tui.NewEntry()\n    inUser.SetFocused(true)\n\n    inPass := tui.NewEntry()\n    inPass.SetEchoMode(tui.EchoModePassword)\n\n    form := tui.NewGrid(0, 0)\n    form.AppendRow(tui.NewLabel(\"Username\"), tui.NewLabel(\"Password\"))\n    form.AppendRow(inUser, inPass)\n\n    // TODO: create OnActivated function\n    btnLogin := tui.NewButton(\"[Login]\")\n\n    // TODO: create OnActivated function\n    btnRegister := tui.NewButton(\"[Register]\")\n\n    buttons := tui.NewHBox(\n        tui.NewSpacer(),\n        tui.NewPadder(1, 0, btnLogin),\n        tui.NewPadder(1, 0, btnRegister),\n    )\n\n    window := tui.NewVBox(\n        tui.NewPadder(1, 1, form),\n        buttons,\n    )\n    window.SetBorder(true)\n\n    root := tui.NewVBox(\n        tui.NewSpacer(),\n        window,\n        tui.NewSpacer(),\n    )\n\n    tui.DefaultFocusChain.Set(inUser, inPass, btnLogin, btnRegister)\n\n    ui, err := tui.New(root)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    ui.SetKeybinding(\"Esc\", func() { ui.Quit() })\n\n    if err := ui.Run(); err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>I then have another program to execute the binary of program.go in a pty, and send it over a socket.  Ideally, I would like the user to connect using a plethora of methods, such as telnet, ssh, or netcat.  The problem is, when I send the pty over the socket, it does not behave the same way as it would when I'm simply running the binary of program.go from my shell.  Below is a copy of my server program.  I am using <a href=\"https://github.com/kr/pty\" rel=\"nofollow noreferrer\">pty</a> library to create the *os.File that gets sent over the socket.</p>\n\n<blockquote>\n  <p>server.go</p>\n</blockquote>\n\n<pre><code>package main\n\nimport (\n    \"net\"\n    \"log\"\n    \"io\"\n    \"os/exec\"\n    \"github.com/kr/pty\"\n)\n\nfunc main() {\n    ln, err := net.Listen(\"tcp\", \":2323\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer ln.Close()\n    for {\n        conn, err := ln.Accept()\n        if err != nil {\n            log.Fatal(err)\n        }\n        go startProg(conn)\n    }\n}\n\nfunc startProg(conn net.Conn) {\n    defer conn.Close()\n\n    term, err := pty.StartWithSize(\n        exec.Command(\"./program\"),\n        &amp;pty.Winsize{Cols: 100, Rows: 30},\n    )\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer term.Close()\n\n    go io.Copy(term, conn)\n    io.Copy(conn, term)\n}\n</code></pre>\n\n<p>Is there anyway to have the TUI work as though it would normally work running from a shell?  Also, how would I read in data that the user inputs into the TUI?  Because when trying to read from both the connection, and the *os.File returned by pty, I can't seem to get any data at all.</p>\n\n<p>Any help is much appreciated!</p>\n"}, {"tags": ["go", "types", "error-handling"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1548218474, "last_edit_date": 1548218474, "creation_date": 1548217546, "answer_id": 54320011, "question_id": 54319780, "link": "https://stackoverflow.com/questions/54319780/why-golang-custom-error-variable-has-multiple-types/54320011#54320011", "title": "Why golang custom error variable has multiple types", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Errors\" rel=\"nofollow noreferrer\">Errors</a></p>\n  \n  <p>The predeclared type error is defined as</p>\n\n<pre><code>type error interface {\n    Error() string\n}\n</code></pre>\n  \n  <p>It is the conventional interface for representing an error condition,\n  with the nil value representing no error.</p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Interface_types\" rel=\"nofollow noreferrer\">Interface types</a></p>\n  \n  <p>An interface type specifies a method set called its interface. A\n  variable of interface type can store a value of any type with a method\n  set that is any superset of the interface. Such a type is said to\n  implement the interface.</p>\n</blockquote>\n\n<hr>\n\n<p><code>e</code> implements the predeclared interface type <code>error</code>.</p>\n\n<pre><code>    // first type assertion\n    _, ok := e.(error)\n    if ok {\n        fmt.Println(\"type assertion error\") // type = error\n    }\n</code></pre>\n\n<p><code>e</code>'s concrete type is a pointer to type <code>myError</code>.</p>\n\n<pre><code>    // second type assertion\n    _, ok = e.(*myError)\n    if ok {\n        fmt.Println(\"type assertion *myError\") // type = pointer\n    }\n</code></pre>\n\n<p>Both type assertions are true (<code>ok</code> is <code>true</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 9978635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22029af3a0ee255f518d6578f568ad26?s=128&d=identicon&r=PG&f=1", "display_name": "zakaster", "link": "https://stackoverflow.com/users/9978635/zakaster"}, "edited": false, "score": 0, "creation_date": 1548229405, "post_id": 54321306, "comment_id": 95463172, "body": "why e&#39;s statistic type is <code>error</code> not a <code>pointer</code> considering <code>errorGen</code> is returning an address"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 31, "user_id": 9978635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22029af3a0ee255f518d6578f568ad26?s=128&d=identicon&r=PG&f=1", "display_name": "zakaster", "link": "https://stackoverflow.com/users/9978635/zakaster"}, "edited": false, "score": 0, "creation_date": 1548230348, "post_id": 54321306, "comment_id": 95463555, "body": "Take a look at errorGen <code>func errorGen() error</code> it returns an <code>error</code>. The type returned is the type in the function signature. The function body stores a *myError inside a error and that error is returned. The return type of a function is determined <i>only</i> by the function signature. Whatever you write after <code>return</code> is of no importance for the static return type (as long as it compiles)."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 3, "last_activity_date": 1548225417, "creation_date": 1548225417, "answer_id": 54321306, "question_id": 54319780, "link": "https://stackoverflow.com/questions/54319780/why-golang-custom-error-variable-has-multiple-types/54321306#54321306", "title": "Why golang custom error variable has multiple types", "body": "<p>You have to differentiate between the \"static type\" and the \"dynamic type\" of a variable.</p>\n\n<p>Each and every variable in Go has exactly <em>one</em> static type. Some example:</p>\n\n<ul>\n<li>After declaring <code>a := 5</code> the static type of <code>a</code> is <code>int</code> and that is all to know about <code>a</code>.</li>\n<li>The static type of <code>e</code> in your code is <code>error</code>(because that is what <code>errorGen</code> returns).</li>\n<li>You can be explicit about the static type like this: <code>var b uint16 = 9</code>.</li>\n</ul>\n\n<p>Now there are interface types in Go. <code>error</code> is such an interface type, see Peter's answer. Some variables will have <code>error</code> as their static type; your <code>e</code> is an example. Now, the whole purpose of a variable of interface type is to store values of <em>various</em> types which implement this interface. So a interface variable which is not nil somehow \"contains\" an other variable (actually a value). The type of this contained value can be any one which implements the interface. The type of the contained value is the \"dynamic type\".\nType assertion let you extract values of this dynamic type.</p>\n"}], "owner": {"reputation": 31, "user_id": 9978635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22029af3a0ee255f518d6578f568ad26?s=128&d=identicon&r=PG&f=1", "display_name": "zakaster", "link": "https://stackoverflow.com/users/9978635/zakaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1066, "favorite_count": 1, "accepted_answer_id": 54321306, "answer_count": 2, "score": 0, "last_activity_date": 1548225417, "creation_date": 1548215521, "question_id": 54319780, "link": "https://stackoverflow.com/questions/54319780/why-golang-custom-error-variable-has-multiple-types", "title": "Why golang custom error variable has multiple types", "body": "<p>i'm a new gopher and got really confused by variable types, if i'm defining a custom error</p>\n\n<pre><code>    import (\n        \"fmt\"\n        \"reflect\"\n    )\n\n    // custom errors\n    type myError struct {\n        msg string\n    }\n\n    func (m *myError) Error() string {\n        return m.msg\n    }\n\n    func errorGen() error {\n        return &amp;myError{\"custom error\"}\n    }\n</code></pre>\n\n<p>generate a new error and check the type of it</p>\n\n<pre><code>    func main() {\n        e := errorGen()\n        fmt.Println(reflect.TypeOf(e).Kind()) // type = pointer\n\n        // first type assertion\n        _, ok := e.(error)\n        if ok {\n            fmt.Println(\"type assertion error\") // type = error\n        }\n\n        // second type assertion\n        _, ok = e.(*myError)\n        if ok {\n            fmt.Println(\"type assertion *myError\") // type = pointer\n        }\n    }\n</code></pre>\n\n<p>so in above code variable 'e' shows 2 types at the same time.\nWhat exactly is e's type? and why \"error\" is an interface and also can be used as return type?</p>\n\n<p>thank you very much</p>\n"}, {"tags": ["pointers", "go"], "answers": [{"tags": [], "owner": {"reputation": 830, "user_id": 4606185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P60xS.png?s=128&g=1", "display_name": "Axifive", "link": "https://stackoverflow.com/users/4606185/axifive"}, "is_accepted": true, "score": 3, "last_activity_date": 1548418751, "last_edit_date": 1548418751, "creation_date": 1548214577, "answer_id": 54319680, "question_id": 54319367, "link": "https://stackoverflow.com/questions/54319367/golang-pointer-value-comparison/54319680#54319680", "title": "Golang pointer value comparison", "body": "<p>Because Golang has automatically dereferenced pointers. </p>\n\n<p><code>item.name</code> is converted to <code>(*item).name</code></p>\n\n<blockquote>\n  <p><strong>As with selectors</strong>, a reference to a non-interface method with a value receiver using a pointer will <strong>automatically dereference that pointer</strong>: pt.Mv is equivalent to (*pt).Mv.</p>\n</blockquote>\n\n<p>You can read all the rules in <a href=\"https://golang.org/ref/spec#Selectors\" rel=\"nofollow noreferrer\">Selectors</a> specification</p>\n"}], "owner": {"reputation": 225, "user_id": 5859194, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/a539c08ebb2d8bd85d5ac84f29a820ef?s=128&d=identicon&r=PG&f=1", "display_name": "ryanpback", "link": "https://stackoverflow.com/users/5859194/ryanpback"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 0, "accepted_answer_id": 54319680, "answer_count": 1, "score": 2, "last_activity_date": 1548418751, "creation_date": 1548211807, "question_id": 54319367, "link": "https://stackoverflow.com/questions/54319367/golang-pointer-value-comparison", "title": "Golang pointer value comparison", "body": "<p>I\u2019m trying to figure out why this works.</p>\n\n<p>I have an Item struct</p>\n\n<pre><code>type item struct {\n    name string\n    someOtherValue int \n}\n</code></pre>\n\n<p>and another struct</p>\n\n<pre><code>type someStruct struct {\n    items []item\n}\n</code></pre>\n\n<p>I have a function where I want to loop through and update the values.</p>\n\n<pre><code>func (s someStruct) update() {\n    for i := range s.items {\n         item := &amp;s.items[i]\n\n        if item.name == \u201cSomething\u201d {\n            doSomething(item)\n        }\n    }\n}\n</code></pre>\n\n<p>When I pass item to the doSomething function, it will update the item at that address (works as planned).</p>\n\n<p>My question is, why does item.name work if item supposed to be an address?</p>\n"}, {"tags": ["go", "gob"], "comments": [{"owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "edited": false, "score": 0, "creation_date": 1548252999, "post_id": 54319087, "comment_id": 95476380, "body": "Please provide a minimal verifiable example that others can run to help debug the issue. Right now your question doesn&#39;t have enough information to get you help. See <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 2535, "user_id": 1760720, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2725d511128304107f17561e03888cdb?s=128&d=identicon&r=PG", "display_name": "Brian Yeh", "link": "https://stackoverflow.com/users/1760720/brian-yeh"}, "reply_to_user": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "edited": false, "score": 0, "creation_date": 1548299864, "post_id": 54319087, "comment_id": 95494470, "body": "This is a bad question. However I already solved the issue using another work around that avoided using gobs. I am voting to close."}], "owner": {"reputation": 2535, "user_id": 1760720, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2725d511128304107f17561e03888cdb?s=128&d=identicon&r=PG", "display_name": "Brian Yeh", "link": "https://stackoverflow.com/users/1760720/brian-yeh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548225998, "creation_date": 1548209269, "last_edit_date": 1548225998, "question_id": 54319087, "link": "https://stackoverflow.com/questions/54319087/how-to-transfer-gobs-between-programs", "title": "How to transfer gobs between programs", "body": "<p>I use the below code to create a gob file which go successfully executes</p>\n\n<pre><code>var METADATA = []interface{}{\n     map[string]interface{}{...},\n     map[string]interface{}{...},\n     ...\n} \n\ngob.Register(map[string]interface{}{})\ngob.Register([]interface{}{})\nfile, err := os.Create(\"./thrift_metadata.gob\")\nif err != nil {\n    return err\n}\nencoder := gob.NewEncoder(file)\nerr = decoder.Decode(object)\n</code></pre>\n\n<p>Below is the decoder compiled from a completely different codebase and debug binary, which fails.</p>\n\n<pre><code>    gobPath := path.Join(currentWorkingDirectory, \"./thrift_metadata.gob\")\n    file, err := os.Open(gobPath)\n    if err != nil {\n        panic(err)\n    }\n    gob.Register(map[string]interface{}{})\n    gob.Register([]interface{}{})\n    decoder := gob.NewDecoder(file)\n    err = decoder.Decode(object)\n</code></pre>\n\n<p>The decoding code fails with the following error:</p>\n\n<pre><code>gob: decoding into local type *[]map[string]interface {}, received remote type \n</code></pre>\n\n<p>Anyone know how to resolve this issue?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 39296, "user_id": 560299, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c38fe465734e8428048585e0acf6174f?s=128&d=identicon&r=PG", "display_name": "Ibu", "link": "https://stackoverflow.com/users/560299/ibu"}, "edited": false, "score": 0, "creation_date": 1548205529, "post_id": 54318572, "comment_id": 95457056, "body": "How are you planing to use the constants?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1548206290, "post_id": 54318572, "comment_id": 95457190, "body": "Is your goal to get <code>[]string{&quot;Dog&quot;, &quot;Fish&quot;}</code> given the value <code>5</code>?"}, {"owner": {"reputation": 457, "user_id": 4489733, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/10714df646d369c5a41225156d051cac?s=128&d=identicon&r=PG&f=1", "display_name": "mbudge", "link": "https://stackoverflow.com/users/4489733/mbudge"}, "edited": false, "score": 0, "creation_date": 1548206488, "post_id": 54318572, "comment_id": 95457234, "body": "Yeah but I&#39;ve changed the strings for this post. 5 is 0101 in binary (4 0 1), so 5 would be the first and third constant."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1548207446, "last_edit_date": 1548207446, "creation_date": 1548206944, "answer_id": 54318797, "question_id": 54318572, "link": "https://stackoverflow.com/questions/54318572/working-with-bitmasks-in-go-go-enumeration-with-iota/54318797#54318797", "title": "Working with bitmasks in Go (Go enumeration with iota)", "body": "<p>Declare a slice of strings where the strings correspond to the constant names:</p>\n\n<pre><code>var animalNames = []string{\n    \"Dog\",\n    \"Cat\",\n    \"Fish\",\n    \"Horse\",\n    \"Snake\",\n    \"Rabbit\",\n    \"Lion\",\n    \"Rino\",\n    \"Hedgehog\",\n}\n</code></pre>\n\n<p>To get the names for the bits, loop through the names. If the corresponding bit is set, add the name to the result:</p>\n\n<pre><code>func Names(k Key) []string {\n    var result []string\n    for i := 0; i &lt; len(animalNames); i++ {\n        if k&amp;(1&lt;&lt;uint(i)) != 0 {\n            result = append(result, animalNames[i])\n        }\n    }\n    return result\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/ufEZJlWR7SC\" rel=\"nofollow noreferrer\">Run it on the playground</a>.</p>\n\n<p>If you change the the constants to be bit indexes instead of bit values, then you can use the <a href=\"https://godoc.org/golang.org/x/tools/cmd/stringer\" rel=\"nofollow noreferrer\">stringer</a> utility to create a <code>func (k Key) String() string</code>.  Here's the code for this change:</p>\n\n<pre><code>type Key uint\n\nconst (\n    Dog Key = iota\n    Cat\n    Fish\n    Horse\n    Snake\n    Rabbit\n    Lion\n    Rino\n    Hedgehog\n)\n\n//go:generate stringer -type=Key\n\nfunc Names(k Key) []string {\n    var result []string\n    for animal := Dog; animal &lt;= Hedgehog; animal++ {\n        if k&amp;(1&lt;&lt;animal) != 0 {\n            result = append(result, animal.String())\n        }\n    }\n    return result\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 12327061, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBJxS-BQAqvkGbXPrkO9v36r4dPqyHBm62Wlq7R=k-s128", "display_name": "Alperen KILI&#199;", "link": "https://stackoverflow.com/users/12327061/alperen-kili%c3%87"}, "is_accepted": false, "score": 0, "last_activity_date": 1617235579, "creation_date": 1617235579, "answer_id": 66896816, "question_id": 54318572, "link": "https://stackoverflow.com/questions/54318572/working-with-bitmasks-in-go-go-enumeration-with-iota/66896816#66896816", "title": "Working with bitmasks in Go (Go enumeration with iota)", "body": "<p>Creating bitmask values with iota\nIota can be very useful when creating a bitmask. For instance, to represent the state of a network connection which may be secure, authenticated, and/or ready, we might create a bitmask like the following:</p>\n<pre><code>package main\n\nimport &quot;fmt&quot;\n\nconst (\n    Secure = 1 &lt;&lt; iota // 0b001\n    Authn              // 0b010\n    Ready              // 0b100\n)\n\n// 0b011: Connection is secure and authenticated, but not yet Ready\n\nfunc main() {\n    ConnState := Secure | Authn\n    fmt.Printf(`    Secure:    0x%x (0b%03b)\n    Authn:     0x%x (0b%03b)\n    ConnState: 0x%x (0b%03b)\n    `, Secure, Secure, Authn, Authn, ConnState, ConnState)\n}\n</code></pre>\n"}], "owner": {"reputation": 457, "user_id": 4489733, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/10714df646d369c5a41225156d051cac?s=128&d=identicon&r=PG&f=1", "display_name": "mbudge", "link": "https://stackoverflow.com/users/4489733/mbudge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1078, "favorite_count": 1, "accepted_answer_id": 54318797, "answer_count": 2, "score": 2, "last_activity_date": 1617235579, "creation_date": 1548205024, "question_id": 54318572, "link": "https://stackoverflow.com/questions/54318572/working-with-bitmasks-in-go-go-enumeration-with-iota", "title": "Working with bitmasks in Go (Go enumeration with iota)", "body": "<p>Bit stuck.</p>\n\n<p>I'm trying to work out how to get the bitmask values from a const with go enumeration. For example, if key is 5, which is 0101 bits, it would be dog and fish. What is the easiest way to get the bit values (1,2,4,8,16, 32, 64 etc) so I can select the string values and return the set of animals?</p>\n\n<pre><code>type Key int\n\nconst (\n    Dog Key = 1 &lt;&lt; iota\n    Cat\n    Fish\n    Horse\n    Snake\n    Rabbit\n    Lion\n    Rino\n    Hedgehog\n)\n</code></pre>\n\n<p>Been reading but I can't work this out. </p>\n"}, {"tags": ["go", "casting"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548198443, "post_id": 54317741, "comment_id": 95455307, "body": "You don&#39;t. You&#39;re unmarshaling <i>into</i> your <code>keys</code>. The data you&#39;re unmarshaling should be a <code>[]byte</code>."}, {"owner": {"reputation": 33, "user_id": 10852354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TfYe8.jpg?s=128&g=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/10852354/ash"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548199270, "post_id": 54317741, "comment_id": 95455544, "body": "Thanks @JimB I am not unmarshaling into keys. I have to call something like <code>json.Unmarshal(keys, &amp;user)</code>. Which requires keys to be of type <code>[]byte</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548199377, "post_id": 54317741, "comment_id": 95455582, "body": "If you have a <code>[][]string</code>, that&#39;s not something you unmarshal, Please create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 33, "user_id": 10852354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TfYe8.jpg?s=128&g=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/10852354/ash"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548200748, "post_id": 54317741, "comment_id": 95455937, "body": "@JimB I have updated the question and indicated where I am stuck."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548201004, "post_id": 54317741, "comment_id": 95455999, "body": "<code>keys</code> simply cannot be json, because it&#39;s a <code>[][]string</code>. Why is in <code>keys</code> that you think needs to be decoded? <code>Users.EmailList</code> is also a <code>[][]string</code>, what is the difference between that and <code>keys</code>? You need to include example data in your code to demonstrate the issue."}, {"owner": {"reputation": 33, "user_id": 10852354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TfYe8.jpg?s=128&g=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/10852354/ash"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548201244, "post_id": 54317741, "comment_id": 95456073, "body": "@JimB Updated question with sample request"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548202450, "post_id": 54317741, "comment_id": 95456410, "body": "I don&#39;t understand what you&#39;re doing. You&#39;ve already decoded that json into <code>User</code>, and <code>user.EmailList</code> is already  a <code>[][]string</code> with the data you seem to want. There&#39;s nothing left here to decode. For example: <a href=\"https://play.golang.org/p/2TsmJTm5HhX\" rel=\"nofollow noreferrer\">play.golang.org/p/2TsmJTm5HhX</a>"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 10852354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TfYe8.jpg?s=128&g=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/10852354/ash"}, "edited": false, "score": 0, "creation_date": 1548249482, "post_id": 54318322, "comment_id": 95474282, "body": "Thanks Peter. The expected output was: <code>[         [             &quot;akki@gmail.com&quot;,             &quot;bakki@gmail.com&quot;         ],         [             &quot;lakki@gmail.com&quot;,             &quot;jakki@gmail.com&quot;         ]     ]</code>. Your answer helped me getting the desired result."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 0, "last_activity_date": 1548217017, "last_edit_date": 1548217017, "creation_date": 1548202782, "answer_id": 54318322, "question_id": 54317741, "link": "https://stackoverflow.com/questions/54317741/how-can-i-typecast-my-2d-slice-of-string-to-byte/54318322#54318322", "title": "How can I typecast my 2d slice of string to []byte?", "body": "<p><code>Unmarshal</code> JSON as <code>[]byte</code> to <code>user</code>. <code>Marshal</code> <code>user.EmailList</code> to JSON as <code>[]byte</code>. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"os\"\n)\n\ntype User struct {\n    EmailList [][]string `json:\"emailList\"`\n}\n\nfunc main() {\n    // rBody, err := ioutil.ReadAll(r.Body)\n    rBody := []byte(`\n{\n    \"emailList\": [\n        [\n            \"akki@gmail.com\",\n            \"bakki@gmail.com\"\n        ],\n        [\n            \"lakki@gmail.com\",\n            \"jakki@gmail.com\"\n        ]\n    ]\n}\n    `)\n    fmt.Println(string(rBody))\n\n    var user User\n    err := json.Unmarshal(rBody, &amp;user)\n    if err != nil {\n        fmt.Fprintln(os.Stderr, err)\n        return\n    }\n    fmt.Println(user.EmailList)\n\n    wData, err := json.Marshal(user.EmailList) // wData is []byte\n    if err != nil {\n        fmt.Fprintln(os.Stderr, err)\n        return\n    }\n    fmt.Println(wData) // wData is []byte\n    fmt.Println(string(wData))\n    // _, err = w.Write(wData)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/S3HWiTqz--B\" rel=\"nofollow noreferrer\">https://play.golang.org/p/S3HWiTqz--B</a></p>\n\n<p>Output:</p>\n\n<pre><code>{\n    \"emailList\": [\n        [\n            \"akki@gmail.com\",\n            \"bakki@gmail.com\"\n        ],\n        [\n            \"lakki@gmail.com\",\n            \"jakki@gmail.com\"\n        ]\n    ]\n}\n\n[[akki@gmail.com bakki@gmail.com] [lakki@gmail.com jakki@gmail.com]]\n[91 91 34 97 107 107 105 64 103 109 97 105 108 46 99 111 109 34 44 34 98 97 107 107 105 64 103 109 97 105 108 46 99 111 109 34 93 44 91 34 108 97 107 107 105 64 103 109 97 105 108 46 99 111 109 34 44 34 106 97 107 107 105 64 103 109 97 105 108 46 99 111 109 34 93 93]\n[[\"akki@gmail.com\",\"bakki@gmail.com\"],[\"lakki@gmail.com\",\"jakki@gmail.com\"]]\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 10852354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TfYe8.jpg?s=128&g=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/10852354/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 1, "accepted_answer_id": 54318322, "answer_count": 1, "score": 0, "last_activity_date": 1548217017, "creation_date": 1548198362, "last_edit_date": 1548201383, "question_id": 54317741, "link": "https://stackoverflow.com/questions/54317741/how-can-i-typecast-my-2d-slice-of-string-to-byte", "title": "How can I typecast my 2d slice of string to []byte?", "body": "<p>I have created a 2d slices and populated it from backend database but as json.Unmarshal accepts only []byte as first parameter <strong>how can I typecast my 2d slice to []byte.</strong></p>\n\n<p>Here is the sample code for reference as I can't share internal code:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n)\n\n//User sjd\ntype User struct {\n    EmailList [][]string `json:\"emailList\"`\n}\n\nfunc listHandler(w http.ResponseWriter, r *http.Request) {\n    reqBody, _ := ioutil.ReadAll(r.Body)\n    var user User\n    json.Unmarshal(reqBody, &amp;user)\n    el := user.EmailList \n    keys := make([][]string, 0)\n    json.Unmarshal([]byte(el), &amp;keys) //this line not working because []byte(el) not possible\n    fmt.Println(keys)\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    w.WriteHeader(http.StatusOK)\n    w.Write([]byte(el))//this line not working because []byte(el) not possible\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", listHandler)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>Sample request:</p>\n\n<pre><code>{\n    \"emailList\": [\n        [\n            \"akki@gmail.com\",\n            \"bakki@gmail.com\"\n        ],\n        [\n            \"lakki@gmail.com\",\n            \"jakki@gmail.com\"\n        ]\n    ]\n}\n</code></pre>\n"}, {"tags": ["go", "exec"], "comments": [{"owner": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "edited": false, "score": 0, "creation_date": 1548196602, "post_id": 54317432, "comment_id": 95454727, "body": "Could you clarify your question @Yaros? Its not clear what you&#39;re trying to accomplish? Also, including your code is always a good idea."}], "answers": [{"comments": [{"owner": {"reputation": 784, "user_id": 10737552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee6d7fb0cd2e5fb9e1daa3282b25f876?s=128&d=identicon&r=PG&f=1", "display_name": "Billy Yuan", "link": "https://stackoverflow.com/users/10737552/billy-yuan"}, "edited": false, "score": 0, "creation_date": 1548219402, "post_id": 54320224, "comment_id": 95459755, "body": "<code>yo</code> is a npm tool, asks for your choice, and then generates project for you. Just like you described: <code>choose code, then print code</code>."}], "tags": [], "owner": {"reputation": 784, "user_id": 10737552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee6d7fb0cd2e5fb9e1daa3282b25f876?s=128&d=identicon&r=PG&f=1", "display_name": "Billy Yuan", "link": "https://stackoverflow.com/users/10737552/billy-yuan"}, "is_accepted": true, "score": 4, "last_activity_date": 1548219147, "creation_date": 1548219147, "answer_id": 54320224, "question_id": 54317432, "link": "https://stackoverflow.com/questions/54317432/golang-exec-command-dialog/54320224#54320224", "title": "Golang exec.Command - Dialog", "body": "<p>You need to redirect os.Stdin to cmd.Stdin, os.Stdout to cmd.Stdout</p>\n\n<p>See in godoc: <a href=\"https://golang.org/pkg/os/exec/#Cmd\" rel=\"nofollow noreferrer\">https://golang.org/pkg/os/exec/#Cmd</a></p>\n\n<blockquote>\n<pre><code>   // Stdin specifies the process's standard input.\n   //\n   // If Stdin is nil, the process reads from the null device (os.DevNull).\n   //\n   // If Stdin is an *os.File, the process's standard input is connected\n   // directly to that file.\n   //\n   // Otherwise, during the execution of the command a separate\n   // goroutine reads from Stdin and delivers that data to the command\n   // over a pipe. In this case, Wait does not complete until the goroutine\n   // stops copying, either because it has reached the end of Stdin\n   // (EOF or a read error) or because writing to the pipe returned an error.\n   Stdin io.Reader\n</code></pre>\n</blockquote>\n\n<p>This sample was tested on windows.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"os/exec\"\n)\n\nfunc main() {\n    cmd := exec.Command(\"yo\")\n    cmd.Stderr = os.Stderr\n    cmd.Stdout = os.Stdout\n    cmd.Stdin = os.Stdin\n    if err := cmd.Run(); err != nil {\n        fmt.Println(err.Error())\n        os.Exit(1)\n    }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10952657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66d254532b992f4a2d84cc1497aee546?s=128&d=identicon&r=PG&f=1", "display_name": "Nick M", "link": "https://stackoverflow.com/users/10952657/nick-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 921, "favorite_count": 0, "accepted_answer_id": 54320224, "answer_count": 1, "score": 0, "last_activity_date": 1548219147, "creation_date": 1548196413, "last_edit_date": 1548197466, "question_id": 54317432, "link": "https://stackoverflow.com/questions/54317432/golang-exec-command-dialog", "title": "Golang exec.Command - Dialog", "body": "<p>Go program run external soft.exe with arguments:</p>\n\n<pre><code>cmd := exec.Command(\"soft.exe\", \"-text\")\nout, _ := cmd.CombinedOutput()\n\nfmt.Printf(\"%s\", out)\n</code></pre>\n\n<p>soft.exe file has some output and wait for input value, for example:</p>\n\n<blockquote>\n  <p>Please choose code:\n  1, 2, 3, 4</p>\n</blockquote>\n\n<p>In usual way in shell window I just type \"1\" and press Enter, and soft.exe give me result.</p>\n\n<blockquote>\n  <p>Thank you, your code is [some number]</p>\n</blockquote>\n\n<p>How can I fill \"1\" after run and get output with GoLang? In my example after run soft.exe it immediately finish working with \"Please choose code: 1, 2, 3, 4\".</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1548191140, "post_id": 54316400, "comment_id": 95452740, "body": "You can always save the JSON to a text column in the database."}, {"owner": {"reputation": 33, "user_id": 10852354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TfYe8.jpg?s=128&g=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/10852354/ash"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1548191300, "post_id": 54316400, "comment_id": 95452816, "body": "Thanks @Adrian I don&#39;t want to save the whole json but only the values corresponding to key in json. So here the value is a 2d slice."}, {"owner": {"reputation": 611, "user_id": 4281077, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3oOg40JdTy4/AAAAAAAAAAI/AAAAAAAAHNQ/jB3IczOZSFE/photo.jpg?sz=128", "display_name": "Karthik Nayak", "link": "https://stackoverflow.com/users/4281077/karthik-nayak"}, "edited": false, "score": 0, "creation_date": 1548194375, "post_id": 54316400, "comment_id": 95454041, "body": "@Ash Are you asking about what db schema architecture would it be ideal to use or are you asking for Go code for a particular schema. Could you give a little more context as per what these emails are to be stored against?"}, {"owner": {"reputation": 33, "user_id": 10852354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TfYe8.jpg?s=128&g=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/10852354/ash"}, "reply_to_user": {"reputation": 611, "user_id": 4281077, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3oOg40JdTy4/AAAAAAAAAAI/AAAAAAAAHNQ/jB3IczOZSFE/photo.jpg?sz=128", "display_name": "Karthik Nayak", "link": "https://stackoverflow.com/users/4281077/karthik-nayak"}, "edited": false, "score": 0, "creation_date": 1548197126, "post_id": 54316400, "comment_id": 95454906, "body": "@KarthikNayak I basically have a column called <code>EmailList</code> as varchar in the table and I want to save my 2D slice shown in the question into that field using go code. And also want to be able to parse this field back into 2dslice."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1548197781, "post_id": 54316400, "comment_id": 95455122, "body": "How would the exact value look like after you inserted it?"}, {"owner": {"reputation": 33, "user_id": 10852354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TfYe8.jpg?s=128&g=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/10852354/ash"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1548199395, "post_id": 54316400, "comment_id": 95455588, "body": "@zerkms it will look like this:  <code>[         [             &quot;akki@gmail.com&quot;,             &quot;bakki@gmail.com&quot;         ],         [             &quot;lakki@gmail.com&quot;,             &quot;jakki@gmail.com&quot;         ]     ]</code>"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1548201101, "post_id": 54316400, "comment_id": 95456034, "body": "So serialise <code>user.EmailList</code> then?"}, {"owner": {"reputation": 611, "user_id": 4281077, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3oOg40JdTy4/AAAAAAAAAAI/AAAAAAAAHNQ/jB3IczOZSFE/photo.jpg?sz=128", "display_name": "Karthik Nayak", "link": "https://stackoverflow.com/users/4281077/karthik-nayak"}, "edited": false, "score": 0, "creation_date": 1548210370, "post_id": 54316400, "comment_id": 95458014, "body": "@Ash Wouldn&#39;t it make more sense to instead have another table which is Emails, where you&#39;d have a Foreign key which would point to this table. This way each of the emails in your list is an entry in the Emails table pointing to this table via Foreign Key."}], "owner": {"reputation": 33, "user_id": 10852354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TfYe8.jpg?s=128&g=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/10852354/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1548199681, "creation_date": 1548191030, "last_edit_date": 1548199681, "question_id": 54316400, "link": "https://stackoverflow.com/questions/54316400/is-there-a-way-to-insert-2d-slice-into-sqlite-database", "title": "Is there a way to insert 2D slice into sqlite database?", "body": "<p>I have requirement where the request json can be parsed using 2d slice and I can get each field of the 2d slices by iterating over them. But how can I push that slice to sqlite database and get it back as a 2d slice.\nHere is my sample JSON:</p>\n\n<pre><code>{\n    \"emailList\": [\n        [\n            \"akki@gmail.com\",\n            \"bakki@gmail.com\"\n        ],\n        [\n            \"lakki@gmail.com\",\n            \"jakki@gmail.com\"\n        ]\n    ]\n}\n</code></pre>\n\n<p>and here is my sample struct:</p>\n\n<pre><code>type User struct {\n    EmailList [][]string `json:\"emailList\"`\n}\n</code></pre>\n\n<p>Now I have write a go code which reads the sample json parses it using the given struct and insert it into sqlite db. Also read the record from DB and construct the JSON from the record.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4103, "user_id": 162358, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/I2kN6.jpg?s=128&g=1", "display_name": "Keith John Hutchison", "link": "https://stackoverflow.com/users/162358/keith-john-hutchison"}, "edited": false, "score": 3, "creation_date": 1548190254, "post_id": 54316192, "comment_id": 95452369, "body": "Does <a href=\"https://stackoverflow.com/a/42612995/162358\">stackoverflow.com/a/42612995/162358</a> help?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1548190518, "post_id": 54316192, "comment_id": 95452480, "body": "Also: <a href=\"https://stackoverflow.com/questions/44307219/go-decode-json-as-it-is-still-streaming-in-via-net-http/44308109#44308109\">Go - Decode JSON as it is still streaming in via net/http</a>"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 7, "last_activity_date": 1548190554, "last_edit_date": 1548190554, "creation_date": 1548190234, "answer_id": 54316249, "question_id": 54316192, "link": "https://stackoverflow.com/questions/54316192/decode-very-big-json-to-array-of-structs/54316249#54316249", "title": "Decode very big json to array of structs", "body": "<p>First, read the documentation.</p>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/pkg/encoding/json/\" rel=\"noreferrer\">Package json</a></p>\n  \n  <p>import \"encoding/json\"</p>\n  \n  <p><a href=\"https://golang.org/pkg/encoding/json/#Decoder.Decode\" rel=\"noreferrer\">func (*Decoder) Decode</a></p>\n\n<pre><code>func (dec *Decoder) Decode(v interface{}) error\n</code></pre>\n  \n  <p>Decode reads the next JSON-encoded value from its input and stores it\n  in the value pointed to by v.</p>\n  \n  <p><a href=\"https://golang.org/pkg/encoding/json/#example_Decoder_Decode_stream\" rel=\"noreferrer\">Example (Stream): This example uses a Decoder to decode a streaming array of JSON\n  objects.</a> </p>\n  \n  <p>Playground: <a href=\"https://play.golang.org/p/o6hD-UV85SZ\" rel=\"noreferrer\">https://play.golang.org/p/o6hD-UV85SZ</a></p>\n</blockquote>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"strings\"\n)\n\nfunc main() {\n    const jsonStream = `\n    [\n        {\"Name\": \"Ed\", \"Text\": \"Knock knock.\"},\n        {\"Name\": \"Sam\", \"Text\": \"Who's there?\"},\n        {\"Name\": \"Ed\", \"Text\": \"Go fmt.\"},\n        {\"Name\": \"Sam\", \"Text\": \"Go fmt who?\"},\n        {\"Name\": \"Ed\", \"Text\": \"Go fmt yourself!\"}\n    ]\n`\n    type Message struct {\n        Name, Text string\n    }\n    dec := json.NewDecoder(strings.NewReader(jsonStream))\n\n    // read open bracket\n    t, err := dec.Token()\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(\"%T: %v\\n\", t, t)\n\n    // while the array contains values\n    for dec.More() {\n        var m Message\n        // decode an array value (Message)\n        err := dec.Decode(&amp;m)\n        if err != nil {\n            log.Fatal(err)\n        }\n\n        fmt.Printf(\"%v: %v\\n\", m.Name, m.Text)\n    }\n\n    // read closing bracket\n    t, err = dec.Token()\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(\"%T: %v\\n\", t, t)\n\n}\n</code></pre>\n"}], "owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 491, "favorite_count": 2, "accepted_answer_id": 54316249, "answer_count": 1, "score": 4, "last_activity_date": 1548219360, "creation_date": 1548189975, "question_id": 54316192, "link": "https://stackoverflow.com/questions/54316192/decode-very-big-json-to-array-of-structs", "title": "Decode very big json to array of structs", "body": "<p>I have a web application which have a REST API, get JSON as input and perform transformations of this JSON.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>func (a *API) getAssignments(w http.ResponseWriter, r *http.Request) {\n\n   var document DataPacket\n   err := json.NewDecoder(r.Body).Decode(&amp;document)\n   if err != nil {\n       a.handleJSONParseError(err, w)\n      return\n   }\n\n   // transformations\n</code></pre>\n\n<p>JSON which I get is a <strong>collection</strong> of structs. External application use my application and send me very big json files (300-400MB). Decode this json at the one moment of time takes a very big time and amount of memory.</p>\n\n<p>Is there any way to work with this json as stream and decode structs from this collection one by one ?</p>\n"}, {"tags": ["email", "go", "https", "smtp", "google-workspace"], "comments": [{"owner": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "edited": false, "score": 1, "creation_date": 1548187052, "post_id": 54315514, "comment_id": 95451011, "body": "Could you please add code that deals with sending the reset password e-mail?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1548188515, "post_id": 54315514, "comment_id": 95451656, "body": "I don&#39;t think suspicious link has anything to do with the email, it&#39;s that the domain is considered potentially harmful/malicious."}, {"owner": {"reputation": 555, "user_id": 8337498, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8b22e7b8121ee9ea74b80f0783247a02?s=128&d=identicon&r=PG&f=1", "display_name": "taraf", "link": "https://stackoverflow.com/users/8337498/taraf"}, "reply_to_user": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "edited": false, "score": 0, "creation_date": 1548188549, "post_id": 54315514, "comment_id": 95451672, "body": "Yes, added to my question @daplho"}, {"owner": {"reputation": 555, "user_id": 8337498, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8b22e7b8121ee9ea74b80f0783247a02?s=128&d=identicon&r=PG&f=1", "display_name": "taraf", "link": "https://stackoverflow.com/users/8337498/taraf"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1548188600, "post_id": 54315514, "comment_id": 95451698, "body": "The domain is https and the link i&#39;m using in html is https too @Adrian"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1548188742, "post_id": 54315514, "comment_id": 95451750, "body": "HTTPS alone doesn&#39;t mean it&#39;s safe. You could be on a malicious sites list or it could have detected suspicious content or something."}, {"owner": {"reputation": 555, "user_id": 8337498, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8b22e7b8121ee9ea74b80f0783247a02?s=128&d=identicon&r=PG&f=1", "display_name": "taraf", "link": "https://stackoverflow.com/users/8337498/taraf"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1548190658, "post_id": 54315514, "comment_id": 95452542, "body": "Actually, I don&#39;t know what is suspicious about it. Can I send the Html? @Adrian"}, {"owner": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "edited": false, "score": 0, "creation_date": 1548192758, "post_id": 54315514, "comment_id": 95453421, "body": "I have seen this myself with my own emails. However, after a while the problem stopped without action on my part. Google could be using some type of analysis to guess potential problem sites (new domain name, not seen this email before) - I am just guessing. The fact that your email has the word &quot;password&quot; will hit the trigger with most security systems."}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1548196984, "post_id": 54315514, "comment_id": 95454868, "body": "This looks like a security feature of gmail. See <a href=\"https://www.jotform.com/help/392-How-to-Use-Your-Gmail-Account-as-Your-Email-Sender-via-SMTP\" rel=\"nofollow noreferrer\">enable less secure apps</a>"}], "answers": [{"tags": [], "owner": {"reputation": 555, "user_id": 8337498, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8b22e7b8121ee9ea74b80f0783247a02?s=128&d=identicon&r=PG&f=1", "display_name": "taraf", "link": "https://stackoverflow.com/users/8337498/taraf"}, "is_accepted": false, "score": 1, "last_activity_date": 1548876090, "creation_date": 1548876090, "answer_id": 54448046, "question_id": 54315514, "link": "https://stackoverflow.com/questions/54315514/how-to-solve-suspicious-link-error-in-email-which-is-sent-from-website/54448046#54448046", "title": "How to solve Suspicious Link error in email which is sent from website", "body": "<p>Alright, I solved this problem. At first, I thought that might be G Suite problem, So I called them and I realized it's not because I could see our email in the inbox and not in the spam folder. So I tried <a href=\"https://support.google.com/chrome/answer/99020\" rel=\"nofollow noreferrer\">this link</a> and I request a review for our domain. After about 30 hours the problem was gone!</p>\n"}], "owner": {"reputation": 555, "user_id": 8337498, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8b22e7b8121ee9ea74b80f0783247a02?s=128&d=identicon&r=PG&f=1", "display_name": "taraf", "link": "https://stackoverflow.com/users/8337498/taraf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1799, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1552507715, "creation_date": 1548186807, "last_edit_date": 1552507715, "question_id": 54315514, "link": "https://stackoverflow.com/questions/54315514/how-to-solve-suspicious-link-error-in-email-which-is-sent-from-website", "title": "How to solve Suspicious Link error in email which is sent from website", "body": "<p>I'm sending a reset password email from my Go RESTFUL web service to our users and I'm using Go SMTP and google Gsuite domain which info@mycompanyname.ca! I've tested it before and it works but when I send it to one of our users he gets Suspicious Link error. He's using the Gmail website. I checked the https and both my website and links are https and When he forwards the email to me I don't see this error anymore! Can anybody help me with this?</p>\n\n<p>This is my code : </p>\n\n<pre><code>        mime string = \"MIME-version: 1.0;\\nContent-Type: text/html; \n        charset=\\\"UTF-8\\\";\\n\\n\"\n        hostname string = \"smtp.gmail.com\"\n\n        auth := smtp.PlainAuth(\"\", username, password, hostname)\n\n        data := map[string]string{\"Token\": token}\n        buffer := new(bytes.Buffer)\n\n        t, err := template.ParseFiles(htmlFilename)\n        if err != nil {\n                return err \n        }   \n\n        err = t.Execute(buffer, data)\n        if err != nil {\n                return err \n        }   \n\n        msg := []byte(subject + mime + buffer.String())\n        reciever = append(reciever, clientMail)\n\n        return smtp.SendMail(hostname+\":587\", auth, \"\", reciever, msg)\n}\n\n</code></pre>\n\n<p>And this is HTML: </p>\n\n<pre><code>  &lt;!DOCTYPE html&gt;\n    &lt;html lang=\"en\"&gt;\n    &lt;head&gt;\n    &lt;!-- Required meta tags --&gt;\n    &lt;meta charset=\"utf-8\"&gt;\n    &lt;meta content=\"width=device-width, initial-scale=1, maximum-scale=1.0, shrink-to-fit=no\" name=\"viewport\"&gt;\n    &lt;meta name=\"author\" content=\"some name\"&gt;\n    &lt;meta name=\"description\" content=\"Entry HTML page for the dashboard\"&gt;\n    &lt;/head&gt;\n    &lt;body style=\"max-width: 50rem; margin: auto; margin-top: 1rem;\"&gt;\n    &lt;img src=\"https://address in google drive\" style=\"margin:auto;\n    display: block; width: 17rem; height: 4.6rem; position: relative; left: 50%; transform: translateX(-50%);\"\n    alt=\"logo\" title=\"company logo\" /&gt;\n    &lt;div style=\"margin-top: 0.5rem; padding-left: 0.5rem; padding-right: 0.5rem; border-top: 1px solid lightgray;\n    border-bottom: 1px solid lightgray; background-color: #f9f9f9\"&gt;\n    &lt;h3&gt;Hello!&lt;/h3&gt;\n    &lt;p&gt;You receive this email because this is your first time logging in. To enter your account,\n    you will need to set a password. Click the button below to set it.&lt;/p&gt;\n    &lt;div style=\"text-align: center\"&gt;\n    &lt;a href=\"https://websiteAddress/#/changepasswordapi?token={{ .Token }}\" target=\"_blank\"&gt;\n    &lt;button style=\"cursor: pointer; border: none; width: 50%; background-color: #ED5E28;\n    color: white; font-size: 1rem; height: 2.5rem;\n    border-radius: 0.35rem\"&gt;&lt;strong&gt;Set Password&lt;/strong&gt;&lt;/button&gt;\n    &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;If you didn't request this, please ignore this email. The password setup is only valid for the next 24 hours.&lt;/p&gt;\n    &lt;p&gt;Thanks,&lt;/p&gt;\n    &lt;p&gt;compaynName Team&lt;/p&gt;\n    &lt;/div&gt;\n    &lt;div style=\"text-align: center; font-size: 0.8rem; color: gray\"&gt;\n    &lt;p&gt;&amp;copy; 2019 companyName. All rights reserved.&lt;/p&gt;\n    &lt;p&gt;company addr&lt;/p&gt;\n    &lt;P&gt;company city&lt;/P&gt;\n    &lt;/div&gt;\n    &lt;/body&gt;\n    &lt;/html&gt;\n</code></pre>\n"}, {"tags": ["dictionary", "go", "types"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1548177215, "creation_date": 1548177215, "answer_id": 54313308, "question_id": 54313243, "link": "https://stackoverflow.com/questions/54313243/how-do-you-extract-a-value-out-of-a-golang-mapstring-string-thats-typed-with-i/54313308#54313308", "title": "How do you extract a value out of a golang map[string] string thats typed with interface{}", "body": "<p>Use a <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertion</a>:</p>\n\n<pre><code>x1 := someFunctionWithAnInterfaceReturnValue()\nx2, ok := x1.(map[string]string)\nif !ok {\n   // handle unexpected type\n}\nvar value string = x2[\"hello\"]\n</code></pre>\n"}], "owner": {"reputation": 2535, "user_id": 1760720, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2725d511128304107f17561e03888cdb?s=128&d=identicon&r=PG", "display_name": "Brian Yeh", "link": "https://stackoverflow.com/users/1760720/brian-yeh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 432, "favorite_count": 0, "closed_date": 1548177522, "accepted_answer_id": 54313308, "answer_count": 1, "score": -4, "last_activity_date": 1548181059, "creation_date": 1548176994, "question_id": 54313243, "link": "https://stackoverflow.com/questions/54313243/how-do-you-extract-a-value-out-of-a-golang-mapstring-string-thats-typed-with-i", "closed_reason": "Duplicate", "title": "How do you extract a value out of a golang map[string] string thats typed with interface{}", "body": "<p>I have something like this:</p>\n\n<pre><code>x1 := someFunctionWithAnInterfaceReturnValue()\n</code></pre>\n\n<p>and the underlying type is something like this: </p>\n\n<pre><code>x2 := map[string] string{\"hello\": \"world\"}\n</code></pre>\n\n<p>How would I access value in x1?</p>\n\n<p>Essentially I want the equivalent of this for x1:</p>\n\n<pre><code> var value string = x2[\"hello\"]\n</code></pre>\n"}, {"tags": ["image", "go", "transparency", "rgba"], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 9215075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WbQUu.jpg?s=128&g=1", "display_name": "Onelio", "link": "https://stackoverflow.com/users/9215075/onelio"}, "edited": false, "score": 0, "creation_date": 1548163551, "post_id": 54309181, "comment_id": 95438103, "body": "Thanks, I made the mistake of taking it for granted. It works."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 3, "last_activity_date": 1548163032, "creation_date": 1548163032, "answer_id": 54309181, "question_id": 54309041, "link": "https://stackoverflow.com/questions/54309041/golang-making-rgba-images-display-weird-colors/54309181#54309181", "title": "Golang making RGBA images display weird colors", "body": "<p>That one is simple:</p>\n\n<pre><code>go doc color.RGBA\n</code></pre>\n\n<blockquote>\n  <p>package color // import \"image/color\"</p>\n\n<pre><code>type RGBA struct {\n    R, G, B, A uint8\n}\n</code></pre>\n  \n  <p>RGBA represents a traditional 32-bit alpha-premultiplied color, having 8\n     bits for each of red, green, blue and alpha.</p>\n  \n  <p>An alpha-premultiplied color component C has been scaled by alpha (A), so\n     has valid values 0 &lt;= C &lt;= A.</p>\n</blockquote>\n\n<p>You might be looking for <code>color.NRGBA</code>.</p>\n\n<p>(Always, really always, consult the documentation of the involved types and functions. Always.)</p>\n"}], "owner": {"reputation": 103, "user_id": 9215075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WbQUu.jpg?s=128&g=1", "display_name": "Onelio", "link": "https://stackoverflow.com/users/9215075/onelio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 684, "favorite_count": 0, "accepted_answer_id": 54309181, "answer_count": 1, "score": 0, "last_activity_date": 1548163032, "creation_date": 1548162580, "question_id": 54309041, "link": "https://stackoverflow.com/questions/54309041/golang-making-rgba-images-display-weird-colors", "title": "Golang making RGBA images display weird colors", "body": "<p>So I'm making some rgba images pixel by pixel following a certain pattern and saving them as png later on and noticed that when alpha channel es changed with certain colors it changes the whole pixel color when stored as png. </p>\n\n<p>I made a test to show what is currently happening:</p>\n\n<pre><code>    img := image.NewRGBA(image.Rect(0, 0, 250, 250))\n    for y := 0; y &lt; height; y++ {\n        for x := 0; x &lt; width; x++ {\n            f.Read(b)\n            img.SetRGBA(x, y, color.RGBA{\n                249,\n                214,\n                133,\n                255,\n            })\n        }\n    }\n    var buff bytes.Buffer\n    err := png.Encode(&amp;buff, img)\n    if err != nil {\n        log.Println(err)\n        return\n    }\n</code></pre>\n\n<p>This will print an image of color <em>#F9D685</em>. But if I change alpha into 200 it will print another one with <em>#6844BC</em> and transparency instead of printing the original color with it's transparency. </p>\n\n<p>Is there a way to solve this? I believe that it's because I'm missing something but can't really figure it out and didn't find anything similar to what's happening to me on google/here.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 486, "user_id": 815693, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1dedcc35dd7a72e74428f9a82a6ec386?s=128&d=identicon&r=PG", "display_name": "user815693", "link": "https://stackoverflow.com/users/815693/user815693"}, "edited": false, "score": 0, "creation_date": 1548158035, "post_id": 54307751, "comment_id": 95435055, "body": "<a href=\"https://play.golang.org/p/VOK9D-rC98D\" rel=\"nofollow noreferrer\">play.golang.org/p/VOK9D-rC98D</a>"}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 2, "creation_date": 1548158130, "post_id": 54307751, "comment_id": 95435109, "body": "<a href=\"https://tour.golang.org/methods/17\" rel=\"nofollow noreferrer\">tour.golang.org/methods/17</a>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 4, "creation_date": 1548159379, "post_id": 54307751, "comment_id": 95435792, "body": "It&#39;s documented <a href=\"https://golang.org/pkg/fmt/#hdr-Printing\" rel=\"nofollow noreferrer\">here</a>... it&#39;s a bit buried under all the other printing rules but you can use your favourite browser to search the page for <code>String()</code> to find the relevant text."}, {"owner": {"reputation": 159, "user_id": 3573024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d560ff0aeb4ce52219a166547fdb09?s=128&d=identicon&r=PG&f=1", "display_name": "mgagnon", "link": "https://stackoverflow.com/users/3573024/mgagnon"}, "edited": false, "score": 0, "creation_date": 1548161657, "post_id": 54307751, "comment_id": 95437005, "body": "@user815693 For the first case, it is actually calling the String() method since it prints the &lt;&lt; &gt;&gt;. Why you say it doesn\u2019t? For the second case, there\u2019s just no standard &quot;Int32()&quot; interface handled by fmt functions."}, {"owner": {"reputation": 486, "user_id": 815693, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1dedcc35dd7a72e74428f9a82a6ec386?s=128&d=identicon&r=PG", "display_name": "user815693", "link": "https://stackoverflow.com/users/815693/user815693"}, "reply_to_user": {"reputation": 159, "user_id": 3573024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d560ff0aeb4ce52219a166547fdb09?s=128&d=identicon&r=PG&f=1", "display_name": "mgagnon", "link": "https://stackoverflow.com/users/3573024/mgagnon"}, "edited": false, "score": 0, "creation_date": 1548163198, "post_id": 54307751, "comment_id": 95437901, "body": "@mgagnon because in the first case I do not understand how <code>String()</code> is called by <code>fmt.Println(msgstr)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": true, "score": 3, "last_activity_date": 1548164669, "last_edit_date": 1548164669, "creation_date": 1548163865, "answer_id": 54309418, "question_id": 54307751, "link": "https://stackoverflow.com/questions/54307751/why-this-string-method-is-called-without-calling-it-by-name/54309418#54309418", "title": "Why this String() method is called without calling it by name", "body": "<p>When you call <code>fmt.Println</code>, it expects an object that implements the <code>Stringer</code> interface. It's <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\">documented</a> as follows:</p>\n\n<blockquote>\n  <p>If an operand implements method String() string, that method will be\n  invoked to convert the object to a string, which will then be\n  formatted as required by the verb (if any)</p>\n</blockquote>\n\n<p>The <code>fmt</code> package also declares the <code>Stringer</code> interface:</p>\n\n<pre><code>type Stringer interface {\n    String() string\n}\n</code></pre>\n\n<p>Such objects must have a <code>String()</code> method that takes no arguments and returns a <code>string</code>. <code>fmt.Println</code> then invokes the <code>String</code> method. This lets us define for custom types how they're going to be printed out. For example:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Person struct {\n    name string\n    age  int\n}\n\nfunc (p Person) String() string {\n    return fmt.Sprintf(\"%s&lt;%d&gt;\", p.name, p.age)\n}\n\nfunc main() {\n    p := Person{name: \"Joe\", age: 39}\n    fmt.Println(p)\n}\n</code></pre>\n\n<p>Will print out:</p>\n\n<pre><code>Joe&lt;39&gt;\n</code></pre>\n\n<p>Because we've customized the way <code>Person</code> objects are turned into strings. More details:</p>\n\n<ul>\n<li><a href=\"https://tour.golang.org/methods/9\" rel=\"nofollow noreferrer\">Interfaces in the Go tour</a></li>\n<li><a href=\"https://tour.golang.org/methods/17\" rel=\"nofollow noreferrer\">Stringer in the Go tour</a></li>\n</ul>\n\n<hr>\n\n<p>If you're interested in the mechanics of how this actually happens in the <code>fmt</code> package, take a look at the <code>handleMethods</code> method in <code>src/fmt/print.go</code>.</p>\n"}], "owner": {"reputation": 486, "user_id": 815693, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1dedcc35dd7a72e74428f9a82a6ec386?s=128&d=identicon&r=PG", "display_name": "user815693", "link": "https://stackoverflow.com/users/815693/user815693"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 54309418, "answer_count": 1, "score": -1, "last_activity_date": 1548164669, "creation_date": 1548157990, "question_id": 54307751, "link": "https://stackoverflow.com/questions/54307751/why-this-string-method-is-called-without-calling-it-by-name", "title": "Why this String() method is called without calling it by name", "body": "<p>Consider the following code. The first function is a receiver method for type MessageStr. Why <code>fmt.Println(msgstr)</code> executes the first method without calling the method as <code>fmt.Println(msgstr.String())</code>. Also why <code>fmt.Println(msgint32)</code> doesn't execute the second method. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype MessageStr string\ntype MessageInt32 int32\n\nfunc (msgs MessageStr) String() string {\n    return string(\"&lt;&lt;\" + msgs + \"&gt;&gt;\")\n}\n\nfunc (msgi MessageInt32) Int32() int32 {\n    return int32(msgi * 2)\n}\n\nfunc main() {\n\n    msgstr := MessageStr(\"Mastering Go\")\n    // why this outputs &lt;&lt;Mastering Go&gt;&gt;\n    // without calling the String() method\n    fmt.Println(msgstr)\n\n\n    msgint32 := MessageInt32(11)\n    // why this doesn't output 11*2 = 22\n    fmt.Println(msgint32)\n\n    fmt.Println(msgint32.Int32())\n\n}\n</code></pre>\n"}, {"tags": ["mysql", "sql", "go", "arguments"], "comments": [{"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 1, "creation_date": 1548174834, "post_id": 54307649, "comment_id": 95445321, "body": "Is this all of your code? The error seems to say that you are trying to run a query and pass an argument that is not expected."}, {"owner": {"reputation": 87, "user_id": 4133880, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/4b2d07f4945d68a929f1317d5cd95f97?s=128&d=identicon&r=PG&f=1", "display_name": "Mital Awachat", "link": "https://stackoverflow.com/users/4133880/mital-awachat"}, "edited": false, "score": 0, "creation_date": 1548179220, "post_id": 54307649, "comment_id": 95447550, "body": "Doesn&#39;t look like issue in above snippet. To check if database connection is established you can do <code>err = db.Ping()</code>."}, {"owner": {"reputation": 1118, "user_id": 5385625, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CKfR0.jpg?s=128&g=1", "display_name": "Sam Orozco", "link": "https://stackoverflow.com/users/5385625/sam-orozco"}, "edited": false, "score": 0, "creation_date": 1548181233, "post_id": 54307649, "comment_id": 95448434, "body": "Can you show all your code?"}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1548197256, "post_id": 54307649, "comment_id": 95454942, "body": "As the prior comments suggest, the program you&#39;re running may differ from the source code you posted. Try <code>go run &lt;filename&gt;</code> eg <code>go run main.go</code>"}], "answers": [{"tags": [], "owner": {"reputation": 39, "user_id": 3335844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d49aa12f2cdda68ec1b054be223e6ec?s=128&d=identicon&r=PG&f=1", "display_name": "Shweta", "link": "https://stackoverflow.com/users/3335844/shweta"}, "is_accepted": false, "score": 1, "last_activity_date": 1548249960, "creation_date": 1548249960, "answer_id": 54328344, "question_id": 54307649, "link": "https://stackoverflow.com/questions/54307649/golang-sql-open-expects-0-arguments-got-1/54328344#54328344", "title": "golang sql.open() expects 0 arguments got 1", "body": "<p>Please try dbconn function to connect with mysql in go</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"fmt\"\n    _ \"github.com/go-sql-driver/mysql\"\n)\n    func dbConn(setDatbaseInstance string) (db *sql.DB) {\n        dbDriver := \"mysql\"\n        dbUser := \"*****\"\n        dbPass := \"*****\"\n        dbName := \"*****\"\n        db, err := sql.Open(dbDriver, dbUser+\":\"+dbPass+\"@tcp(\"+setDatbaseInstance+\":3306)/\"+dbName)\n        if err != nil {\n            fmt.Printf(\"%#v\\n DB_ERROR_CONNECTION\\n\", err.Error());\n            // return err.Error()\n        }else{\n             fmt.Println(\"Connection Established\")\n        }\n        erro:=db.Ping()\n        if erro!=nil {\n         //do something here\n            fmt.Printf(\"%#v\\n DB_PING_ERROR_CONNECTION\\n\", erro.Error());\n        }\n\n\n        return db\n    }\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6561513, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154278638469544/picture?type=large", "display_name": "Sebastian Andersen", "link": "https://stackoverflow.com/users/6561513/sebastian-andersen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 519, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1548249960, "creation_date": 1548157702, "last_edit_date": 1548160645, "question_id": 54307649, "link": "https://stackoverflow.com/questions/54307649/golang-sql-open-expects-0-arguments-got-1", "title": "golang sql.open() expects 0 arguments got 1", "body": "<p>I am trying to connect to a mysql database I have locally, using golang, it builds just fine but running it gives me the following error:</p>\n\n<blockquote>\n  <p>panic: sql: expected 0 arguments, got 1</p>\n</blockquote>\n\n<p>My connection looks like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"fmt\"\n    _ \"github.com/go-sql-driver/mysql\"\n)\n\nfunc DBConn() {\n    team := \"software\"\n    db, err := sql.Open(\"mysql\", \"root:12345678@tcp(localhost:3306)/flexlocal\")\n    if err != nil {\n        fmt.Println(\"this is where it all went wrong\")\n        fmt.Printf(err.Error())\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>According to my research this is how it works however it just isn't working for me.</p>\n"}, {"tags": ["go", "varnish", "varnish-vcl"], "comments": [{"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1548158071, "post_id": 54306875, "comment_id": 95435072, "body": "you probably need to look at <a href=\"https://github.com/phenomenes/vago\" rel=\"nofollow noreferrer\">github.com/phenomenes/vago</a>"}, {"owner": {"reputation": 455, "user_id": 8779111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a41cec418b896f4691bfd51d1bdff464?s=128&d=identicon&r=PG&f=1", "display_name": "slifer2015", "link": "https://stackoverflow.com/users/8779111/slifer2015"}, "reply_to_user": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1548158338, "post_id": 54306875, "comment_id": 95435217, "body": "not satisfy my needs I&#39;ve seen it before i want to some how call my go lang function from varnish subroutine to normalize lat Lon based on quad tree algorithm"}], "answers": [{"comments": [{"owner": {"reputation": 455, "user_id": 8779111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a41cec418b896f4691bfd51d1bdff464?s=128&d=identicon&r=PG&f=1", "display_name": "slifer2015", "link": "https://stackoverflow.com/users/8779111/slifer2015"}, "edited": false, "score": 0, "creation_date": 1548222929, "post_id": 54309991, "comment_id": 95460677, "body": "What if I make my go code an http service can I make http request in varnish subroutine?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 455, "user_id": 8779111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a41cec418b896f4691bfd51d1bdff464?s=128&d=identicon&r=PG&f=1", "display_name": "slifer2015", "link": "https://stackoverflow.com/users/8779111/slifer2015"}, "edited": false, "score": 1, "creation_date": 1548260226, "post_id": 54309991, "comment_id": 95480799, "body": "That is certainly doable but this will obviously incur certain latency to processing each request (round-trip to your service in addition to processing time done there), so the answer is &quot;it depends on the requirements&quot;."}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 2, "last_activity_date": 1548165807, "creation_date": 1548165807, "answer_id": 54309991, "question_id": 54306875, "link": "https://stackoverflow.com/questions/54306875/how-to-call-go-program-from-varnish-subroutine/54309991#54309991", "title": "How to call Go program from varnish subroutine", "body": "<p>From what I gather form the Varnish docs, an official way to have <a href=\"https://en.wikipedia.org/wiki/Foreign_function_interface\" rel=\"nofollow noreferrer\">FFI</a> in Varnish is using <a href=\"https://book.varnish-software.com/4.0/chapters/Appendix_D__VMOD_Development.html\" rel=\"nofollow noreferrer\">VMODs</a> \u2014 <strong>V</strong>arnish <strong>Mod</strong>ules.</p>\n\n<p>It appears to be presupposed one uses C to write VMODs (maybe with the little help of <code>vmodtool.py</code> which is able to translate VCC to plain C).</p>\n\n<p>Still, you could explore two approaches to hook Go into that mix:</p>\n\n<ul>\n<li><p>Compile your Go code using the <a href=\"https://golang.org/cmd/go/#hdr-Build_modes\" rel=\"nofollow noreferrer\"><code>-buildmode=c-shared</code></a> mode to produce a <code>.so</code> file with the C-compatible interface.</p>\n\n<p>This approach will create a \"free-standing\" Varnish module,\nwhich does not rely on <code>libc</code>, just exports a C-compatible API from the library.</p>\n\n<p>But while this is doable, you'd need to \"mirror\" certain data structures provided by Varnish and maybe you'll need to call <em>into</em> Varnish API back from your module.\nSo the next approach seems to be more feasible.</p></li>\n<li><p>Use <a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow noreferrer\"><code>cgo</code></a> to wire up your Go code with C API exported by Varnish. You will supposedly still need to use <code>-buildmode=c-shared</code>.</p></li>\n</ul>\n\n<p>All-in-all, you'd better first play with the native VMODs as documented in the Varnish book I linked to.</p>\n\n<hr>\n\n<p>I'd also make the following minor points:</p>\n\n<ul>\n<li><p>I have no personal experience with VMODs.\nIt's quite possible they're supposed to be linked-in statically when building Varnish from the source.</p>\n\n<p>If so, you'd need to use <code>-buildmode=c-archive</code>.</p></li>\n<li><p>It appears that doing what you're after would be an uphill\nbattle for you, so I'd seriously consider porting whatever algorithm you have implemented in Go to that Varnish-specific VCC.</p></li>\n</ul>\n"}], "owner": {"reputation": 455, "user_id": 8779111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a41cec418b896f4691bfd51d1bdff464?s=128&d=identicon&r=PG&f=1", "display_name": "slifer2015", "link": "https://stackoverflow.com/users/8779111/slifer2015"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1548165807, "creation_date": 1548155029, "last_edit_date": 1548157316, "question_id": 54306875, "link": "https://stackoverflow.com/questions/54306875/how-to-call-go-program-from-varnish-subroutine", "title": "How to call Go program from varnish subroutine", "body": "<p>Say \"I'm running varnish and I want to call Go code from varnish subroutines\". that will run for every <code>vcl_recv</code> subroutine?</p>\n"}, {"tags": ["android", "go", "encryption", "rsa"], "comments": [{"owner": {"reputation": 611, "user_id": 4281077, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3oOg40JdTy4/AAAAAAAAAAI/AAAAAAAAHNQ/jB3IczOZSFE/photo.jpg?sz=128", "display_name": "Karthik Nayak", "link": "https://stackoverflow.com/users/4281077/karthik-nayak"}, "edited": false, "score": 1, "creation_date": 1548196292, "post_id": 54306500, "comment_id": 95454629, "body": "Could you give a little more explanation as to what you mean by &quot;but it can&#39;t.&quot;, Its hard to help when we don&#39;t know what exactly the problem. Also could you show us the code where the Private, Public key is initialized?"}, {"owner": {"reputation": 129, "user_id": 8567152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d8ea8638371a6b451331959a33abe03?s=128&d=identicon&r=PG&f=1", "display_name": "melina", "link": "https://stackoverflow.com/users/8567152/melina"}, "reply_to_user": {"reputation": 611, "user_id": 4281077, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3oOg40JdTy4/AAAAAAAAAAI/AAAAAAAAHNQ/jB3IczOZSFE/photo.jpg?sz=128", "display_name": "Karthik Nayak", "link": "https://stackoverflow.com/users/4281077/karthik-nayak"}, "edited": false, "score": 1, "creation_date": 1548227743, "post_id": 54306500, "comment_id": 95462439, "body": "dear @PKarthik public and private key are generated correctly . but I know my code have problem in these line  <b>&quot;RSA/NONE/PKCS1Padding&quot;; //RSA/ECB/PKCS1Padding</b>   Or  <b>return byte2hex(enc4golang(text, serveruk));</b>"}, {"owner": {"reputation": 129, "user_id": 8567152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d8ea8638371a6b451331959a33abe03?s=128&d=identicon&r=PG&f=1", "display_name": "melina", "link": "https://stackoverflow.com/users/8567152/melina"}, "reply_to_user": {"reputation": 611, "user_id": 4281077, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3oOg40JdTy4/AAAAAAAAAAI/AAAAAAAAHNQ/jB3IczOZSFE/photo.jpg?sz=128", "display_name": "Karthik Nayak", "link": "https://stackoverflow.com/users/4281077/karthik-nayak"}, "edited": false, "score": 1, "creation_date": 1548227946, "post_id": 54306500, "comment_id": 95462539, "body": "@Karthik  i added more details now"}], "answers": [{"comments": [{"owner": {"reputation": 293, "user_id": 4443895, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/snFAh.png?s=128&g=1", "display_name": "m-tech", "link": "https://stackoverflow.com/users/4443895/m-tech"}, "edited": false, "score": 0, "creation_date": 1565614539, "post_id": 54393912, "comment_id": 101396539, "body": "Your code is right but this public and private is wrong test it with another priPEM and pubPEM"}], "tags": [], "owner": {"reputation": 210, "user_id": 10001149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/967c571c838b261fcef871fe46d79c9d?s=128&d=identicon&r=PG&f=1", "display_name": "Moh_beh", "link": "https://stackoverflow.com/users/10001149/moh-beh"}, "is_accepted": true, "score": 3, "last_activity_date": 1548631994, "last_edit_date": 1592644375, "creation_date": 1548631994, "answer_id": 54393912, "question_id": 54306500, "link": "https://stackoverflow.com/questions/54306500/how-to-use-rsa-between-go-and-android/54393912#54393912", "title": "How to use RSA between Go and Android", "body": "<p>I have tested it and it worked.</p>\n<p>in Go i use this fnction:</p>\n<pre><code>func rusdec(encryptedString string , privateKey string) (string, error) {\n     base64DecodeBytes, err := base64.StdEncoding.DecodeString(encryptedString)\n     if err != nil {\n         return &quot;&quot;, err\n     }\n     privateKeyBlock, _ := pem.Decode([]byte(privateKey))\n     var pri *rsa.PrivateKey\n     pri, parseErr := x509.ParsePKCS1PrivateKey(privateKeyBlock.Bytes)\n     if parseErr != nil {\n         return &quot;&quot;, parseErr\n     }\n     decryptedData, decryptErr := rsa.DecryptOAEP(sha1.New(), rand.Reader, pri, base64DecodeBytes, nil)\n     if decryptErr != nil {\n         return &quot;&quot;, decryptErr\n     }\n     return string(decryptedData), nil\n}\n</code></pre>\n<p>and in Android studio :</p>\n<blockquote>\n<p>public final static String chi=&quot;RSA/ECB/OAEPPadding&quot;;</p>\n<p>public final static String RSA = &quot;RSA&quot;;</p>\n<p>private final static int CRYPTO_BITS = 512;</p>\n</blockquote>\n<pre><code>public static PublicKey stringToPublicKeytoserver(String publicKeyString)\n    {\n        try {\n            if (publicKeyString.contains(&quot;-----BEGIN PUBLIC KEY-----&quot;) || publicKeyString.contains(&quot;-----END PUBLIC KEY-----&quot;))\n                publicKeyString = publicKeyString.replace(&quot;-----BEGIN PUBLIC KEY-----&quot;, &quot;&quot;).replace(&quot;-----END PUBLIC KEY-----&quot;, &quot;&quot;);\n            publicKeyString = publicKeyString.replace(&quot;-----BEGIN PUBLIC KEY-----&quot;, &quot;&quot;);\n            publicKeyString = publicKeyString.replace(&quot;-----END PUBLIC KEY-----&quot;, &quot;&quot;);\n            byte[] keyBytes = Base64.decode(publicKeyString, Base64.DEFAULT);\n            X509EncodedKeySpec spec = new X509EncodedKeySpec(keyBytes);\n            KeyFactory keyFactory = KeyFactory.getInstance(RSA);\n            serveruk=keyFactory.generatePublic(spec);\n            return serveruk;\n        } catch (NoSuchAlgorithmException | InvalidKeySpecException e) {\n            e.printStackTrace();\n            return null;\n        }\n    }\n\n    \n     private static byte[] enc4golang(String text, PublicKey pubRSA) throws Exception{\n        Cipher cipher = Cipher.getInstance(chi);\n        cipher.init(Cipher.ENCRYPT_MODE, pubRSA);\n        return cipher.doFinal(text.getBytes(&quot;UTF-8&quot;)); //i also advice you to use: .getBytes(&quot;UTF-8&quot;); instead of data.getBytes();\n    }\n    \n    \n    public final static String enc4golang(String text){\n        try {\n            return Base64.encodeToString(enc4golang(text, serveruk) ,Base64.DEFAULT);  //send this string to golang\n        }\n        catch(Exception e)\n        {\n            e.printStackTrace();\n        }\n        return null;\n    }\n</code></pre>\n<p>public and private Key for Go:</p>\n<pre><code> const priPEM = `-----BEGIN RSA PRIVATE KEY-----\n    MIIBOQIBAAJBALEZ+CmY7YN7KWib5Oh0AuWqfHiq3aURV1WGaaBm+X43kF3RRGJd\n    HbVdOEb2+YoNyni+LD5CQ4R3T7/f0sePzv0CAwEAAQJAc0MAlSoXotPcjl2vrG4c\n    mJbNrcceu9i+a0Ywppl+VVsEPOnapMQsVM04BpJzFmi00S+Sxl0pO1oAX0pwX7Oq\n    4QIhAOcncV+SQYlOWoH/phOGkA3y5j0eO2uUfqrXJX0q6/+FAiEAxCMvlkSePzkn\n    EROwzJu8tpZrIB6CNZ5KKfhPW7Dj3xkCIEvW1w2iMLpZ6LwKInT5iz3oWb3ns1si\n    h0SJ/hTJBlD5AiAKEtyQ1TljeeX9xIsiFyWcIyGhZq+9XUHl4fEBfpZVkQIgMfrj\n    qLoCdQH1D5F69WUMYd0n36Xpmqf7L9yV0Ofkz1Y=\n    -----END RSA PRIVATE KEY-----`\n\n  const pubPEM = `-----BEGIN PUBLIC KEY-----\nMFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBALEZ+CmY7YN7KWib5Oh0AuWqfHiq3aUR\nV1WGaaBm+X43kF3RRGJdHbVdOEb2+YoNyni+LD5CQ4R3T7/f0sePzv0CAwEAAQ==\n-----END PUBLIC KEY-----`\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 8567152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d8ea8638371a6b451331959a33abe03?s=128&d=identicon&r=PG&f=1", "display_name": "melina", "link": "https://stackoverflow.com/users/8567152/melina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 446, "favorite_count": 3, "accepted_answer_id": 54393912, "answer_count": 1, "score": 2, "last_activity_date": 1548631994, "creation_date": 1548153877, "last_edit_date": 1548227892, "question_id": 54306500, "link": "https://stackoverflow.com/questions/54306500/how-to-use-rsa-between-go-and-android", "title": "How to use RSA between Go and Android", "body": "<p><img src=\"https://i.stack.imgur.com/x7pnW.png\" alt=\"enter image description here\"></p>\n\n<p>I (1) create Public key in Go and send it for Android\n(2) android use below code to Encrypt it's data to send to Go with string type\n(3) Go get string data and try to Decrypt it, but it can't.</p>\n\n<p>My Go code:</p>\n\n<pre><code>// DecryptWithPrivateKey decrypts data with private key\nfunc DecryptWithPrivateKey(ciphertext []byte, priv *rsa.PrivateKey) []byte {\n    plaintext, err := rsa.DecryptPKCS1v15(rand.Reader, priv , ciphertext)\n    if err != nil {\n        log.Println(err)\n    }\n    return plaintext\n}\n.\n.\n.\nso.On(\"serverpublic\", func(msg string) {\nmes := []byte(msg)\ndecbyte :=DecryptWithPrivateKey(data,pr)\nstr := fmt.Sprintf(\"%s\", decbyte)\nlog.Println(\"encript data from Android   ----&gt;\"   , str)\n})\n</code></pre>\n\n<p>Android studio code:</p>\n\n<pre><code>public final static String chi=\"RSA/NONE/PKCS1Padding\"; //RSA/ECB/PKCS1Padding\n\n    private static byte[] dec4golang(byte[] src) throws Exception {\n        Cipher cipher = Cipher.getInstance(chi);\n        cipher.init(Cipher.DECRYPT_MODE, serverrk);\n        return cipher.doFinal(src);\n    }\n\n    private static byte[] enc4golang(String text, PublicKey pubRSA) throws Exception{\n        Cipher cipher = Cipher.getInstance(chi);\n        cipher.init(Cipher.ENCRYPT_MODE, pubRSA);\n        return cipher.doFinal(text.getBytes(\"UTF-8\")); //i also advice you to use: .getBytes(\"UTF-8\"); instead of data.getBytes();\n    }\n\n        public final static String enc4golang(String text){\n        try {\n            return byte2hex(enc4golang(text, serveruk)); \n//            return enc4golang(text, serveruk).toString();\n//            return new String(enc4golang(text, serveruk), \"UTF-8\");\n//            return new String(enc4golang(text, serveruk), Charset.forName(\"utf-8\"));\n//            return    Base64.encodeToString(enc4golang(text, serveruk), Base64.DEFAULT);///nodejs\n//            return  Base64Utils.encodeToString(enc4golang(text, serveruk));\n        }\n        catch(Exception e)\n        {\n            e.printStackTrace();\n        }\n        return null;\n    }\n\n     public static String byte2hex(byte[] b)\n    {\n        String hs = \"\";\n        String stmp = \"\";\n        for (int n = 0; n &lt; b.length; n ++)\n        {\n            stmp = Integer.toHexString(b[n] &amp; 0xFF);\n            if (stmp.length() == 1)\n                hs += (\"0\" + stmp);\n            else\n                hs += stmp;\n        }\n        return hs.toUpperCase();\n    }\n</code></pre>\n\n<p>I think my problem is in these lines:</p>\n\n<blockquote>\n  <p>chi=\"RSA/NONE/PKCS1Padding\"; //RSA/ECB/PKCS1Padding</p>\n</blockquote>\n\n<p>OR</p>\n\n<blockquote>\n  <p>return byte2hex(enc4golang(text, serveruk));</p>\n</blockquote>\n"}, {"tags": ["go", "memory-address", "func", "reflect"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1548152792, "post_id": 54304608, "comment_id": 95432122, "body": "You are printing with fmt.Println which does a lot of magic. Magic you must understand (e.g. it calls String methods)."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1548221333, "last_edit_date": 1548221333, "creation_date": 1548175784, "answer_id": 54312910, "question_id": 54304608, "link": "https://stackoverflow.com/questions/54304608/explain-the-printed-values-of-method-expressions/54312910#54312910", "title": "Explain the printed values of method expressions", "body": "<p>The <code>fmt</code> package calls <a href=\"https://godoc.org/reflect#Value.Pointer\" rel=\"nofollow noreferrer\">Value.Pointer</a> to get function addresses.</p>\n\n<p>Let's look at an example of what <code>Value.Pointer</code> returns for the functions:</p>\n\n<pre><code>s0 := &amp;Str{}\nv0 := reflect.ValueOf(s0)\nfmt.Printf(\"s0.Callme: %0x %0x\\n\", reflect.ValueOf(s0.Callme).Pointer(), s0.Callme)\nfmt.Printf(\"v0.Method(0) %0x %0x\\n\", v0.Method(0).Pointer(), v0.Method(0))\n\ns1 := &amp;Str{}\nv1 := reflect.ValueOf(s1)\nfmt.Printf(\"s1.Callme %x %x\\n\", reflect.ValueOf(s1.Callme).Pointer(), s1.Callme)\nfmt.Printf(\"v1.Method(0) %x %x\\n\", v1.Method(0).Pointer(), v1.Method(0))\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>s0.Callme: 105240 105240\nv0.Method(0) eee60 eee60\ns1.Callme 105240 105240\nv1.Method(0) eee60 eee60\n</code></pre>\n\n<p>This matches the pattern shown in the question. </p>\n\n<p>The <a href=\"https://github.com/golang/go/blob/8d2e65d22408e9e1c6329485baf432be9300f410/src/reflect/value.go#L1375-L1392\" rel=\"nofollow noreferrer\">function related code for Value.Pointer</a> is:</p>\n\n<pre><code>    if v.flag&amp;flagMethod != 0 {\n        // As the doc comment says, the returned pointer is an\n        // underlying code pointer but not necessarily enough to\n        // identify a single function uniquely. All method expressions\n        // created via reflect have the same underlying code pointer,\n        // so their Pointers are equal. The function used here must\n        // match the one used in makeMethodValue.\n        f := methodValueCall\n        return **(**uintptr)(unsafe.Pointer(&amp;f))\n    }\n    p := v.pointer()\n    // Non-nil func value points at data block.\n    // First word of data block is actual code.\n    if p != nil {\n        p = *(*unsafe.Pointer)(p)\n    }\n    return uintptr(p)\n</code></pre>\n\n<p>A <code>reflect.Value</code> created through a <a href=\"https://golang.org/ref/spec#Method_expressions\" rel=\"nofollow noreferrer\">method expression</a> in the reflect API has the <code>flagMethod</code> method bit set.  As the comment states and the code shows, the Pointer method returns the same value for all method expressions created this way.</p>\n\n<p>The <code>reflect.Value</code> created by <code>relect.ValueOf(s1.Callme)</code> does not have the <code>flagMethod</code> method bit set. In this case, the function returns the pointer to the actual code.</p>\n\n<p>The output of <a href=\"https://play.golang.org/p/XfV4zQ2ykih\" rel=\"nofollow noreferrer\">this program</a> shows all of the combinations:</p>\n\n<pre><code>type StrA struct {\n    I int\n    S string\n}\n\nfunc (s *StrA) Callme() {\n    fmt.Println(\"it is me\")\n}\n\ntype StrB struct {\n    I int\n    S string\n}\n\nfunc (s *StrB) Callme() {\n    fmt.Println(\"it is me\")\n}\n\ns0A := &amp;StrA{}\nv0A := reflect.ValueOf(s0A)\ns1A := &amp;StrA{}\nv1A := reflect.ValueOf(s0A)\n\nfmt.Println(\"s0A.Callme \", reflect.ValueOf(s0A.Callme).Pointer())\nfmt.Println(\"v0A.Method(0) \", v0A.Method(0).Pointer())\nfmt.Println(\"s1A.Callme \", reflect.ValueOf(s1A.Callme).Pointer())\nfmt.Println(\"v1A.Method(0) \", v1A.Method(0).Pointer())\n\ns0B := &amp;StrB{}\nv0B := reflect.ValueOf(s0B)\ns1B := &amp;StrB{}\nv1B := reflect.ValueOf(s0B)\n\nfmt.Println(\"s0B.Callme \", reflect.ValueOf(s0B.Callme).Pointer())\nfmt.Println(\"v0B.Method(0) \", v0B.Method(0).Pointer())\nfmt.Println(\"s1B.Callme \", reflect.ValueOf(s1B.Callme).Pointer())\nfmt.Println(\"v1B.Method(0) \", v1B.Method(0).Pointer())\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>s0A.Callme  1061824\nv0A.Method(0)  978528\ns1A.Callme  1061824\nv1A.Method(0)  978528\ns0B.Callme  1061952\nv0B.Method(0)  978528\ns1B.Callme  1061952\nv1B.Method(0)  978528\n</code></pre>\n\n<p>We can observe that Value.Pointer returns the same value for all <a href=\"https://golang.org/ref/spec#Method_expressions\" rel=\"nofollow noreferrer\">method expressions</a> created through the reflect API.  This includes methods on different types.</p>\n\n<p>We can also observe that <code>Value.Pointer</code> returns the same value for all <a href=\"https://golang.org/ref/spec#Method_expressions\" rel=\"nofollow noreferrer\">method expressions</a> on a given type and method. This is true for method expressions bound to different values.</p>\n\n<p>The <a href=\"https://godoc.org/reflect#Value.Pointer\" rel=\"nofollow noreferrer\">Value.Pointer documentation</a> says:</p>\n\n<blockquote>\n  <p>If v's Kind is Func, the returned pointer is an underlying code pointer, but not necessarily enough to identify a single function uniquely. The only guarantee is that the result is zero if and only if v is a nil func Value.</p>\n</blockquote>\n\n<p>Given this, an application cannot reliably use Value.Pointer or printed values through the <code>fmt</code> package to compare functions and methods.</p>\n"}], "owner": {"reputation": 646, "user_id": 1011932, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/60d5c176edc9aae48133f89107c4c3d5?s=128&d=identicon&r=PG", "display_name": "river", "link": "https://stackoverflow.com/users/1011932/river"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 54312910, "answer_count": 1, "score": -1, "last_activity_date": 1548221333, "creation_date": 1548147727, "last_edit_date": 1548213258, "question_id": 54304608, "link": "https://stackoverflow.com/questions/54304608/explain-the-printed-values-of-method-expressions", "title": "Explain the printed values of method expressions", "body": "<p>The following code tries to show the address of a method associated to struct. </p>\n\n<pre><code>package  main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype II interface {\n    Callme()\n}\n\ntype Str struct {\n    I int\n    S string\n}\n\nfunc (s *Str) Callme () {\n    fmt.Println(\"it is me\")\n}\n\nfunc main() {\n    s0 := &amp;Str{}\n    t := reflect.TypeOf(s0)\n    v := reflect.ValueOf(s0)\n    fmt.Println(\"Callme \", s0.Callme)   //real address ?\n    fmt.Println(t.Method(0).Name, v.Method(0))    //real address ?\n\n    s1 := &amp;Str{}\n    t1 := reflect.TypeOf(s1)\n    v1 := reflect.ValueOf(s1)\n    fmt.Println(\"Callme \", s1.Callme)   //real address ?\n    fmt.Println(t1.Method(0).Name, v1.Method(0))    //real address ?\n}\n</code></pre>\n\n<p>The output is :</p>\n\n<pre><code>Callme  0x4bc2d0\nCallme 0x4ab2c0\nCallme  0x4bc2d0\nCallme 0x4ab2c0\n</code></pre>\n\n<p>So I have two questions:</p>\n\n<ul>\n<li><p>First, why these statements do not show identical values ?</p>\n\n<pre><code>fmt.Println(\"Callme \", s0.Callme)\nfmt.Println(t.Method(0).Name, v.Method(0))\n</code></pre></li>\n<li><p>Second, why these statements show identical values ?</p>\n\n<pre><code>fmt.Println(t.Method(0).Name, v.Method(0))    \nfmt.Println(t1.Method(0).Name, v1.Method(0)) \n</code></pre></li>\n</ul>\n"}, {"tags": ["go", "underline"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1548147637, "post_id": 54304502, "comment_id": 95428915, "body": "It forces the read of m.state."}, {"owner": {"reputation": 431, "user_id": 2766818, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CRGvb.jpg?s=128&g=1", "display_name": "oohcode", "link": "https://stackoverflow.com/users/2766818/oohcode"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1548147783, "post_id": 54304502, "comment_id": 95428989, "body": "Why read m.state but not use it?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 12, "creation_date": 1548150760, "post_id": 54304502, "comment_id": 95430774, "body": "To make the race detector work."}], "answers": [{"tags": [], "owner": {"reputation": 527, "user_id": 335472, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3eec49d54e643c464a5d9e42c8dd5c59?s=128&d=identicon&r=PG", "display_name": "Joao Henrique", "link": "https://stackoverflow.com/users/335472/joao-henrique"}, "is_accepted": false, "score": 0, "last_activity_date": 1552564809, "creation_date": 1552564809, "answer_id": 55162022, "question_id": 54304502, "link": "https://stackoverflow.com/questions/54304502/what-is-variable-mean-in-sync-mutex-go/55162022#55162022", "title": "What is \u201c_ = variable\u201d mean in sync/mutex.go", "body": "<p>To force the read of m.state and tick the race detector. </p>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 11426604, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-c4lcpg0WTC8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc1SWR3x0x07yUbb4Nwicd1rjSPFQ/mo/photo.jpg?sz=128", "display_name": "jack", "link": "https://stackoverflow.com/users/11426604/jack"}, "is_accepted": false, "score": 1, "last_activity_date": 1556607166, "creation_date": 1556607166, "answer_id": 55915404, "question_id": 54304502, "link": "https://stackoverflow.com/questions/54304502/what-is-variable-mean-in-sync-mutex-go/55915404#55915404", "title": "What is \u201c_ = variable\u201d mean in sync/mutex.go", "body": "<p>From the commit log, the reason is  that \"_ = m.state\" make sure m is not nil.</p>\n\n<pre><code>commit 5bb3a66a973ea87494b9197091e8c1f122080627\nAuthor: R\u00e9my Oudompheng &lt;oudomphe@phare.normalesup.org&gt;\nDate:   Mon Apr 8 23:46:54 2013 +0200\n\n    sync, sync/atomic: do not corrupt race detector after a nil dereference.\n\n    The race detector uses a global lock to analyze atomic\n    operations. A panic in the middle of the code leaves the\n    lock acquired.\n\n    Similarly, the sync package may leave the race detectro\n    inconsistent when methods are called on nil pointers.\n\n    R=golang-dev, r, minux.ma, dvyukov, rsc, adg\n    CC=golang-dev\n    https://golang.org/cl/7981043\n</code></pre>\n"}], "owner": {"reputation": 431, "user_id": 2766818, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CRGvb.jpg?s=128&g=1", "display_name": "oohcode", "link": "https://stackoverflow.com/users/2766818/oohcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "answer_count": 2, "score": 9, "last_activity_date": 1556607166, "creation_date": 1548147344, "last_edit_date": 1548148124, "question_id": 54304502, "link": "https://stackoverflow.com/questions/54304502/what-is-variable-mean-in-sync-mutex-go", "title": "What is \u201c_ = variable\u201d mean in sync/mutex.go", "body": "<p>sync/mutex.go:</p>\n\n<pre><code>func (m *Mutex) Unlock() {\n    if race.Enabled {\n         _ = m.state\n         race.Release(unsafe.Pointer(m))\n     }\n...\n</code></pre>\n\n<h2>what's the mean of <code>_ = m.state</code>?</h2>\n\n<p>I know the <code>var _ interface = Object</code> mean check if <code>Object</code> implemented interface.</p>\n"}, {"tags": ["arrays", "go", "slice", "reflect"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1548179850, "post_id": 54303635, "comment_id": 95447848, "body": "This is a very unusual, and probably pointless, implementation - can you describe what you&#39;re actually trying to accomplish? There&#39;s probably a better way, most likely just using slices normally."}, {"owner": {"reputation": 23, "user_id": 10831385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69cc7c24cc0d3ea48426326107326e83?s=128&d=identicon&r=PG&f=1", "display_name": "Felix Septem", "link": "https://stackoverflow.com/users/10831385/felix-septem"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1548226772, "post_id": 54303635, "comment_id": 95462052, "body": "actually,I want to use a indeterminate slice as the key of map, becase of not capamrable(<a href=\"https://golang.org/ref/spec#Comparison_operators\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Comparison_operators</a>) of slice,I want to use an array which holds all elements in the slice as the key with size as small as possible"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1548252933, "post_id": 54303635, "comment_id": 95476344, "body": "If you need your map keys to be arrays of inconsistent length, you probably want to reconsider the design that led you to that situation."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 0, "last_activity_date": 1548184393, "creation_date": 1548184393, "answer_id": 54314959, "question_id": 54303635, "link": "https://stackoverflow.com/questions/54303635/how-to-convert-slice-to-array/54314959#54314959", "title": "How to convert slice to array?", "body": "<p>Use <a href=\"https://godoc.org/reflect#ArrayOf\" rel=\"nofollow noreferrer\">reflect.ArrayOf</a> to create the array type given the slice element type.  Use <a href=\"https://godoc.org/reflect#New\" rel=\"nofollow noreferrer\">reflect.New</a> to create a value of that type. Use <a href=\"https://godoc.org/reflect#Copy\" rel=\"nofollow noreferrer\">reflect.Copy</a> to copy from the slice to the array.</p>\n\n<pre><code>func SliceToArray(in interface{}) interface{} {\n    s := reflect.ValueOf(in)\n    if s.Kind() != reflect.Slice {\n        panic(\"not a slice\")\n    }\n    t := reflect.ArrayOf(s.Len(), s.Type().Elem())\n    a := reflect.New(t).Elem()\n    reflect.Copy(a, s)\n    return a.Interface()\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/pHujV-0qMiQ\" rel=\"nofollow noreferrer\">Run it on the Playground</a></p>\n\n<p>This function is useful for creating a map key from a slice and other scenarios where a comparable value is required.  Otherwise, it's usually best to use a slice when the length can be arbitrary.</p>\n"}], "owner": {"reputation": 23, "user_id": 10831385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69cc7c24cc0d3ea48426326107326e83?s=128&d=identicon&r=PG&f=1", "display_name": "Felix Septem", "link": "https://stackoverflow.com/users/10831385/felix-septem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "accepted_answer_id": 54314959, "answer_count": 1, "score": -5, "last_activity_date": 1548184393, "creation_date": 1548143969, "last_edit_date": 1548145309, "question_id": 54303635, "link": "https://stackoverflow.com/questions/54303635/how-to-convert-slice-to-array", "title": "How to convert slice to array?", "body": "<p>I want to implement a method to convert a <code>interface{}</code> slice to a <code>interface{}</code> array which has equal length to the given slice. It's similar to below:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func SliceToArray(in []interface{}) (out interface{}) {\n ...\n}\n// out's type is [...]interface{} and len(out)==len(in)\n</code></pre>\n\n<p>How can I implement this method?</p>\n\n<p>EDIT:\nAny possible to use <code>reflect.ArrayOf</code> to implement this? </p>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1548138257, "post_id": 54302129, "comment_id": 95424577, "body": "No, there&#39;s no way without iteration. In fact, there&#39;s no way to print the values without iteration, too--it&#39;s just that <code>fmt</code> handles that iteration for you. But there are some libraries that will do such iteration for you. <a href=\"https://godoc.org/github.com/davecgh/go-spew/spew\" rel=\"nofollow noreferrer\">spew</a> might be one to consider."}, {"owner": {"reputation": 656, "user_id": 6793457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHWs1.jpg?s=128&g=1", "display_name": "Siddhanta Rath", "link": "https://stackoverflow.com/users/6793457/siddhanta-rath"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1548139531, "post_id": 54302129, "comment_id": 95425094, "body": "oh yeah!. <code>fmt</code> takes care of the iteration. But, instead of depending on some other package, don&#39;t you think implementing <code>fmt.Stringer</code> would be a wiser choice ? @Flimzy"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1548144102, "post_id": 54302129, "comment_id": 95427067, "body": "Sure, implementing <code>fmt.Stringer</code> would work. Which is a better choice depends on your goals."}], "answers": [{"comments": [{"owner": {"reputation": 341, "user_id": 714426, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9T2Hi.jpg?s=128&g=1", "display_name": "William Yeh", "link": "https://stackoverflow.com/users/714426/william-yeh"}, "edited": false, "score": 0, "creation_date": 1599019399, "post_id": 54302487, "comment_id": 112639976, "body": "I&#39;d suggest another fork that is updated more frequently: <a href=\"https://github.com/use-go/spew\" rel=\"nofollow noreferrer\">github.com/use-go/spew</a>"}], "tags": [], "owner": {"reputation": 2571, "user_id": 2422530, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/zlebS.jpg?s=128&g=1", "display_name": "Obi Wan - PallavJha", "link": "https://stackoverflow.com/users/2422530/obi-wan-pallavjha"}, "is_accepted": false, "score": 3, "last_activity_date": 1548138725, "creation_date": 1548138725, "answer_id": 54302487, "question_id": 54302129, "link": "https://stackoverflow.com/questions/54302129/how-to-print-the-slice-of-pointers-to-get-the-values-instead-of-their-address-wi/54302487#54302487", "title": "How to print the slice of pointers to get the values instead of their address without iteration at go?", "body": "<p>You can use <code>spew</code></p>\n\n<p><code>go get -u github.com/davecgh/go-spew/spew</code></p>\n\n<pre><code>func spewDump(users []*user) {\n    _, err := spew.Printf(\"%v\", users)\n    if err != nil {\n        fmt.Println(\"error while spew print\", err)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[&lt;*&gt;{1 cooluser1 cool.user1@gmail.com} &lt;*&gt;{2 cooluser2 cool.user2@gmail.com}]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 656, "user_id": 6793457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHWs1.jpg?s=128&g=1", "display_name": "Siddhanta Rath", "link": "https://stackoverflow.com/users/6793457/siddhanta-rath"}, "edited": false, "score": 1, "creation_date": 1548140594, "post_id": 54302801, "comment_id": 95425495, "body": "this is what, i was looking ,for by implementing the <code>fmt.Stringer</code> interface, but for string concatenation, <code>strings.Builder</code> will be better instead of <code>+</code>"}, {"owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 1, "creation_date": 1548142082, "post_id": 54302801, "comment_id": 95426154, "body": "Wouldn&#39;t it be easier to just define (*User).String() instead of users.String()?"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 3, "last_activity_date": 1548144293, "last_edit_date": 1548144293, "creation_date": 1548140300, "answer_id": 54302801, "question_id": 54302129, "link": "https://stackoverflow.com/questions/54302129/how-to-print-the-slice-of-pointers-to-get-the-values-instead-of-their-address-wi/54302801#54302801", "title": "How to print the slice of pointers to get the values instead of their address without iteration at go?", "body": "<blockquote>\n  <p>This kind output required for debugging purpose.</p>\n  \n  <p>Is there any way, we can read the values inside the slice of pointers\n  using <code>fmt.Printf</code> and get value directly like below ?</p>\n\n<pre><code>users []*user\nfmt.Printf(\"users at slice %v \\n\", users)\n\nusers at slice [&amp;{1 cooluser1 cool.user1@gmail.com}, &amp;{2 cooluser2 cool.user2@gmail.com}]\n</code></pre>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\">Package fmt</a></p>\n  \n  <p><code>import \"fmt\"</code></p>\n  \n  <p><a href=\"https://golang.org/pkg/fmt/#Stringer\" rel=\"nofollow noreferrer\">type Stringer</a></p>\n  \n  <p>Stringer is implemented by any value that has a String method, which\n  defines the \u201cnative\u201d format for that value. The String method is used\n  to print values passed as an operand to any format that accepts a\n  string or to an unformatted printer such as Print.</p>\n\n<pre><code>type Stringer interface {\n        String() string\n}\n</code></pre>\n</blockquote>\n\n<hr>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype user struct {\n    userID int\n    name   string\n    email  string\n}\n\ntype users []*user\n\nfunc (users users) String() string {\n    s := \"[\"\n    for i, user := range users {\n        if i &gt; 0 {\n            s += \", \"\n        }\n        s += fmt.Sprintf(\"%v\", user)\n    }\n    return s + \"]\"\n}\n\nfunc addUsers(users users) {\n    users = append(users, &amp;user{userID: 1, name: \"cooluser1\", email: \"cool.user1@gmail.com\"})\n    users = append(users, &amp;user{userID: 2, name: \"cooluser2\", email: \"cool.user2@gmail.com\"})\n\n    fmt.Printf(\"users at slice %v \\n\", users)\n}\n\nfunc main() {\n    var users users\n    addUsers(users)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/vDmdiKQOpqD\" rel=\"nofollow noreferrer\">https://play.golang.org/p/vDmdiKQOpqD</a></p>\n\n<p>Output:</p>\n\n<pre><code>users at slice [&amp;{1 cooluser1 cool.user1@gmail.com}, &amp;{2 cooluser2 cool.user2@gmail.com}] \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1948, "user_id": 8690313, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-hQ93tpA6Lmk/AAAAAAAAAAI/AAAAAAAAB2I/7F3CoNnnhts/photo.jpg?sz=128", "display_name": "Prajval M", "link": "https://stackoverflow.com/users/8690313/prajval-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1548142705, "last_edit_date": 1548142705, "creation_date": 1548140883, "answer_id": 54302935, "question_id": 54302129, "link": "https://stackoverflow.com/questions/54302129/how-to-print-the-slice-of-pointers-to-get-the-values-instead-of-their-address-wi/54302935#54302935", "title": "How to print the slice of pointers to get the values instead of their address without iteration at go?", "body": "<p>Code : <a href=\"https://play.golang.org/p/rBzVZlovmEc\" rel=\"nofollow noreferrer\">https://play.golang.org/p/rBzVZlovmEc</a></p>\n\n<p>Output : </p>\n\n<blockquote>\n  <p>users at slice [{1 cooluser1 cool.user1@gmail.com} {2 cooluser2\n  cool.user2@gmail.com}]</p>\n</blockquote>\n\n<p>Using stringers you can achive it.</p>\n\n<p>Refer: <a href=\"https://golang.org/pkg/fmt/#Stringer\" rel=\"nofollow noreferrer\">https://golang.org/pkg/fmt/#Stringer</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype user struct {\n    userID int\n    name   string\n    email  string\n}\n\nfunc (t user) String() string {\n    return fmt.Sprintf(\"{%v %v %v}\", t.userID, t.name, t.email)\n}\n\nfunc main() {\n    var users []*user\n    addUsers(users)\n}\n\nfunc addUsers(users []*user) {\n    users = append(users, &amp;user{userID: 1, name: \"cooluser1\", email: \"cool.user1@gmail.com\"})\n    users = append(users, &amp;user{userID: 2, name: \"cooluser2\", email: \"cool.user2@gmail.com\"})\n    printUsers(users)\n}\n\nfunc printUsers(users []*user) {\n    fmt.Printf(\"users at slice %v \\n\", users)\n}\n</code></pre>\n\n<p><strong>You need not apply stringer to users i.e []*users instead if you do it just for a single user it'll work fine. Also it reduces down the string operations you need to do manually making your code elegant.</strong></p>\n"}], "owner": {"reputation": 656, "user_id": 6793457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHWs1.jpg?s=128&g=1", "display_name": "Siddhanta Rath", "link": "https://stackoverflow.com/users/6793457/siddhanta-rath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2543, "favorite_count": 1, "accepted_answer_id": 54302801, "answer_count": 3, "score": 11, "last_activity_date": 1548144293, "creation_date": 1548136947, "question_id": 54302129, "link": "https://stackoverflow.com/questions/54302129/how-to-print-the-slice-of-pointers-to-get-the-values-instead-of-their-address-wi", "title": "How to print the slice of pointers to get the values instead of their address without iteration at go?", "body": "<p>This kind output required for debugging purpose.\nTo get actual value of slice of pointers, every time a iteration is getting required.</p>\n\n<p>Is there any way, we can directly have the value instead of the address of each item present at slice using simple fmt.printf()?</p>\n\n<p>Here is a code snippet :\n<a href=\"https://play.golang.org/p/bQ5vWTlKZmV\" rel=\"noreferrer\">https://play.golang.org/p/bQ5vWTlKZmV</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype user struct {\n    userID int\n    name   string\n    email  string\n}\n\nfunc main() {\n    var users []*user\n    addUsers(users)\n}\n\nfunc addUsers(users []*user) {\n    users = append(users, &amp;user{userID: 1, name: \"cooluser1\", email: \"cool.user1@gmail.com\"})\n    users = append(users, &amp;user{userID: 2, name: \"cooluser2\", email: \"cool.user2@gmail.com\"})\n    printUsers(users)\n    printEachUser(users)\n\n}\n\nfunc printUsers(users []*user) {\n    fmt.Printf(\"users at slice %v \\n\", users)\n}\n\nfunc printEachUser(users []*user) {\n    for index, u := range users {\n        fmt.Printf(\"user at user[%d] is : %v \\n\", index, *u)\n    }\n}\n</code></pre>\n\n<p>At above code, if I am printing the slice directly by fmt.printf , I get only the address of the values instead of actual value itself.</p>\n\n<p>output : <code>users at slice [0x442260 0x442280]</code></p>\n\n<p>To read to the values always, i have to call <code>func</code> like <code>printEachUser</code> to iterate the slice and get the appropriate value .</p>\n\n<p>output:\n<code>user at user[0] is : {1 cooluser1 cool.user1@gmail.com}</code>\n<code>user at user[1] is : {2 cooluser2 cool.user2@gmail.com}</code></p>\n\n<p>Is there any way, we can read the values inside the slice of pointers using <code>fmt.printf</code> and get value directly like below ?</p>\n\n<p><code>users at slice [&amp;{1 cooluser1 cool.user1@gmail.com} , &amp;{2 cooluser2 cool.user2@gmail.com}]</code></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2280, "user_id": 1918890, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/018e4722f070586f7a475e3942b9aa32?s=128&d=identicon&r=PG", "display_name": "Praveen", "link": "https://stackoverflow.com/users/1918890/praveen"}, "edited": false, "score": 0, "creation_date": 1548137112, "post_id": 54301474, "comment_id": 95424186, "body": "You have misunderstood how type conversions work. Check <a href=\"https://stackoverflow.com/questions/19577423/how-to-cast-to-a-type-alias-in-go\" title=\"how to cast to a type alias in go\">stackoverflow.com/questions/19577423/&hellip;</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1548137991, "post_id": 54301474, "comment_id": 95424480, "body": "1. No need for pointer in <code>var m = &amp;MyFamily{}</code>, a simple <code>m := MyFamily{}</code> is good enough. 2. No need to <i>assign</i> a Family to a MyFamily, just construct your MyFamily: <code>m := MyFamily{Siblings: f.Siblings}</code>. Done"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1548138534, "post_id": 54301474, "comment_id": 95424671, "body": "You stated that &quot;Even though they are the same underlying type I get that error&quot; but this is <i>not</i> true, they do <i>not</i> share the same underlying type. It is true, that all the way down the memory layout of both type MyFamily and Family are the same, but their underlying types are different. The underlying type of MyFamily is <code>struct {Siblings map[string]string}</code> while the underlying type of Family is <code>struct {Siblings xmlMap}</code> . These are not the <b>same</b> type."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1548138703, "post_id": 54301474, "comment_id": 95424739, "body": "The underlying type of xmlMap is map[string]string so you can type convert between them. The concept of &quot;underlying type&quot; is not a recursive one: Underlying types is literally &quot;the direct types are equal&quot; (roughly; read the language spec for reference). See <a href=\"https://play.golang.org/p/Jxi4u_7R1Ex\" rel=\"nofollow noreferrer\">play.golang.org/p/Jxi4u_7R1Ex</a>"}, {"owner": {"reputation": 3900, "user_id": 522962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c77cd63cb8f567c1ffefca8e78f2c605?s=128&d=identicon&r=PG&f=1", "display_name": "user_78361084", "link": "https://stackoverflow.com/users/522962/user-78361084"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1548194344, "post_id": 54301474, "comment_id": 95454029, "body": "@Volker &quot;m := MyFamily{Siblings: f.Siblings}&quot; There are a lot more fields than this example. I&#39;d have to do that for every field, then? Seems there s/b a more efficient way."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1548218133, "post_id": 54301474, "comment_id": 95459503, "body": "No, there is not. Unless you make Family the underlying type of MyFamily and attach MarshalXML to Family itself. In this case the assignment from a family to a myFamily works (same underlying type) at the cost of a probably much more complicated MarshalXML method. You choose. (Note that copying a &quot;lot more&quot; fields is cheap, easy and simple to understand; I wouldn&#39;t bother.)"}], "owner": {"reputation": 3900, "user_id": 522962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c77cd63cb8f567c1ffefca8e78f2c605?s=128&d=identicon&r=PG&f=1", "display_name": "user_78361084", "link": "https://stackoverflow.com/users/522962/user-78361084"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1548194579, "creation_date": 1548132808, "last_edit_date": 1548194579, "question_id": 54301474, "link": "https://stackoverflow.com/questions/54301474/how-do-i-implement-custom-struct-tags-and-be-able-to-xml-encode-a-map", "title": "how do I implement custom struct tags AND be able to XML encode a map?", "body": "<p>I have the following:</p>\n\n<p><a href=\"https://play.golang.org/p/ADX6H-bh0CU\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ADX6H-bh0CU</a></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n)\n\ntype xmlMap map[string]string\n\ntype xmlMapEntry struct {\n    XMLName xml.Name\n    Value   string `xml:\",chardata\"`\n}\n\nfunc (m xmlMap) MarshalXML(e *xml.Encoder, start xml.StartElement) error {\n    if len(m) == 0 {\n        return nil\n    }\n\n    err := e.EncodeToken(start)\n    if err != nil {\n        return err\n    }\n\n    for k, v := range m {\n        e.Encode(xmlMapEntry{XMLName: xml.Name{Local: k}, Value: v})\n    }\n\n    return e.EncodeToken(start.End())\n}\n\nfunc main() {\n    type Family struct {\n        Siblings map[string]string\n    }\n\n    type MyFamily struct {\n        Siblings xmlMap `json:\"siblings\" xml:\"siblings\"`\n    } \n\n    // In reality, \"f\" comes from a function in an outside package...e.g. \"f := somepackage.Function()\"\n    f := &amp;Family{\n        Siblings: map[string]string{\"bob\": \"brother\", \"mary\": \"sister\"},\n    }\n\n    var m = &amp;MyFamily{}\n    *m = MyFamily(*f)\n\n    x, err := xml.Marshal(m)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(string(x))\n}\n</code></pre>\n\n<p>The Family struct comes from an outside package. I created MyFamily struct in order to add json and xml tags. If I try to xml encode MyFamily then I get an error: </p>\n\n<pre><code>xml: unsupported type: map[string]string\n</code></pre>\n\n<p>This is easily resolved by implementing the custom XML marshaller that I have done.</p>\n\n<p>This creates a separate problem. I have tried to simplify the example but \"f\" comes from a function in an outside package...e.g. \"f := somepackage.Function()\". When I try to Alias f to m I get the error:</p>\n\n<pre><code>cannot convert *f (type Family) to type MyFamily\n</code></pre>\n\n<p>This happens because Family has a map[string]string but MyFamily has xmlMap. Even though they are the same underlying type I get that error.</p>\n\n<p>The question is, how do I implement my custom struct tags AND be able to XML encode a map?</p>\n\n<p>EDIT:\nThis is a simple example and can just be resolved by </p>\n\n<pre><code>var m = &amp;MyFamily{Siblings: f.Siblings} \n</code></pre>\n\n<p>Since there are MANY fields in both Family and MyFamily this is just inefficient and just wanted to know if there's a better way.</p>\n"}, {"tags": ["go", "data-structures", "linked-list"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1548138984, "post_id": 54301390, "comment_id": 95424864, "body": "&quot;if there is a better or different way of doing this&quot;. Yes: Stop writing generic code. Either use an appropriate interface or use a non-generic container. &quot;what is the performance impact of the current checking of types&quot; Measure! Nobody can tell you if this is fast enough for your workload on your infrastructure."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1548143662, "post_id": 54301390, "comment_id": 95426877, "body": "This isn&#39;t typical Go code. It&#39;s not clear why the list implementation would care if the user mixes types or not. If you explain <i>why</i> you want to create such a list, we can maybe suggest alternatives, although it usually boils down to writing (or generating) multiple implementations."}, {"owner": {"reputation": 57, "user_id": 1491359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e61dd95d3f78304fcc1ceb4e44754bdf?s=128&d=identicon&r=PG", "display_name": "Rishi Agrawal", "link": "https://stackoverflow.com/users/1491359/rishi-agrawal"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1548148271, "post_id": 54301390, "comment_id": 95429294, "body": "@Peter - in cpp when we create a container - lets say a vector, we need to mention the type of objects that will be in the container. It can be seen as a feature or a limitation, but in my case - I do not want the users to be able to keep different types of objects in the container. Consider a case where I want the keys in the linked list to be stored in a sorted order. How will I compare the objects of different types in the linked list."}, {"owner": {"reputation": 57, "user_id": 1491359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e61dd95d3f78304fcc1ceb4e44754bdf?s=128&d=identicon&r=PG", "display_name": "Rishi Agrawal", "link": "https://stackoverflow.com/users/1491359/rishi-agrawal"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1548148433, "post_id": 54301390, "comment_id": 95429401, "body": "@Volker - performance impact - I think I worded it incorrectly - The question is &quot;What is the impact of using the reflect package in the code ? Can this be removed by using another method. I am editing the question to mention this."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1548150866, "post_id": 54301390, "comment_id": 95430852, "body": "Using reflection happens at runtime and is <i>always</i> slower than using direct code. The only way to get rid of the reflection overhead is to write non-generic code which you should do."}, {"owner": {"reputation": 6124, "user_id": 5627983, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/696f780ea286896dd41a92459152fbb3?s=128&d=identicon&r=PG&f=1", "display_name": "s952163", "link": "https://stackoverflow.com/users/5627983/s952163"}, "edited": false, "score": 0, "creation_date": 1548157738, "post_id": 54301390, "comment_id": 95434898, "body": "The usual way to solve this is with code generation in Go. At least until it gets generics... Take a look at p. 352 of `Learning Functional Programming in Go&#39;. Though, if you really really need to use FP data structures use something else than go (like F# or Scala), or simply use a different data structure."}], "answers": [{"tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": true, "score": 1, "last_activity_date": 1548165174, "creation_date": 1548165174, "answer_id": 54309822, "question_id": 54301390, "link": "https://stackoverflow.com/questions/54301390/implement-generic-linked-list-in-golang-which-disallows-different-types-in-the-s/54309822#54309822", "title": "Implement generic linked list in golang which disallows different types in the same linkedlist", "body": "<p>You can do it either by using interfaces and runtime checks (as you've discovered), or by using <a href=\"https://blog.golang.org/generate\" rel=\"nofollow noreferrer\">code generation</a>. These are the current options you have in Go for generic programming. The Go team is working to <a href=\"https://go.googlesource.com/proposal/+/master/design/go2draft-generics-overview.md\" rel=\"nofollow noreferrer\">add generics to the language</a> - it's a work in progress, and everyone is free to participate in the discussion. Once generics exist, they will provide the solution you seek here.</p>\n\n<p>As for interfaces vs. code generation, there are the performance implications you've mentioned. Code generation will generate tighter code that doesn't need to do runtime checks for most operations; on the other hand, it adds a bit of complexity to the build process of your project. These are the usual tradeoffs of having something resolved at run-time vs. precomputing things at compile-time.</p>\n"}], "owner": {"reputation": 57, "user_id": 1491359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e61dd95d3f78304fcc1ceb4e44754bdf?s=128&d=identicon&r=PG", "display_name": "Rishi Agrawal", "link": "https://stackoverflow.com/users/1491359/rishi-agrawal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 420, "favorite_count": 0, "accepted_answer_id": 54309822, "answer_count": 1, "score": 0, "last_activity_date": 1548165174, "creation_date": 1548132149, "last_edit_date": 1548148483, "question_id": 54301390, "link": "https://stackoverflow.com/questions/54301390/implement-generic-linked-list-in-golang-which-disallows-different-types-in-the-s", "title": "Implement generic linked list in golang which disallows different types in the same linkedlist", "body": "<p>I want to make a linked list which can hold the <strong>values of any type</strong> but the linked list must hold values of any <strong>one type only</strong>.</p>\n\n<p>In general when I am using interfaces for achieving this - any type which implements the interface for the node can be added to the linked list.</p>\n\n<p>I have written an implementation for this where whenever a new key is added to the linked list, the type of the key is checked against the type of the key at the head. I want to understand if this is the correct way of implementing it or is there a better way of doing it.  </p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n    \"reflect\"\n    \"strings\"\n)\n\ntype MyNode struct {\n    value int\n}\n\nfunc (node *MyNode) PrintValue() {\n    fmt.Printf(\" %d \", node.value)\n}\n\ntype llNode struct {\n    key        llNodeInterface\n    next       *llNode\n    llNodeType reflect.Type\n}\n\ntype llNodeInterface interface {\n    PrintValue()\n}\n\ntype ComplexNode struct {\n    realValue  int\n    imageValue int\n}\n\nfunc (node *ComplexNode) PrintValue() {\n    fmt.Printf(\" %d + i%d\", node.realValue, node.imageValue)\n}\n\n// Student type.\ntype Student struct {\n    name string\n    age  int\n}\n\n// Student implements the PrintValue function - thus llNodeInterface is implemented.\nfunc (node *Student) PrintValue() {\n    fmt.Printf(\"Name: %s | Age : %d \", node.name, node.age)\n}\n\n// Function which will check the of the new node before adding to the linked\n// list. It checks the type of the new key against the type of the key in the\n// head. If both are equal then it proceed else return error.\nfunc (head *llNode) AddBeforeHeadTypeCheck(passedKey llNodeInterface) error {\n\n    if head.key == nil {\n        head.key = passedKey\n        head.llNodeType = reflect.TypeOf(head.key)\n    } else {\n        typeOfPassedKey := reflect.TypeOf(passedKey)\n\n        if typeOfPassedKey != head.llNodeType {\n            fmt.Printf(\"\\nUnsupported type for the type %T\", passedKey)\n            return errors.New(\"Type mistmatch\")\n        }\n\n        temp := llNode{key: head.key, next: head.next}\n        head.key = passedKey\n        head.next = &amp;temp\n    }\n    return nil\n}\n\n// Function which will not check the types and will simply add the new node to\n// the linked list. Thus linked list will be able to have nodes of multiple\n// types.\nfunc (head *llNode) AddBeforeHead(passedKey llNodeInterface) {\n\n    if head.key == nil {\n        head.key = passedKey\n        head.llNodeType = reflect.TypeOf(head.key)\n    } else {\n        temp := llNode{key: head.key, next: head.next}\n        head.key = passedKey\n        head.next = &amp;temp\n    }\n}\n\nfunc (head *llNode) Init() {\n    head.key = nil\n    head.next = nil\n    head.llNodeType = nil\n\n}\n\n// Print the linked list.\nfunc (head *llNode) DisplayLL() {\n\n    temp := head\n    fmt.Printf(\"\\n%s\", strings.Repeat(\"#\", 80))\n    fmt.Printf(\"\\nPrinting the linked list\\n\")\n\n    for {\n        if temp.key == nil {\n            fmt.Println(\"Linked list is empty\")\n            break\n        } else {\n            fmt.Printf(\"\\n %T %v \", temp.key, temp.key)\n            key := temp.key\n            key.PrintValue()\n            if temp.next == nil {\n                break\n            } else {\n                temp = temp.next\n            }\n        }\n    }\n    fmt.Printf(\"\\n%s\", strings.Repeat(\"#\", 80))\n    fmt.Printf(\"\\n\\n\")\n}\n\nfunc testWithMixedType() {\n    head := llNode{}\n    head.Init()\n\n    for i := 1; i &lt; 10; i++ {\n        temp := &amp;ComplexNode{i, i * 10}\n        head.AddBeforeHeadTypeCheck(temp)\n    }\n\n    temps := &amp;Student{\"rishi\", 20}\n    head.AddBeforeHeadTypeCheck(temps) // Will give error.\n    head.DisplayLL()\n}\n\nfunc testWithComplexNumber() {\n\n    head := llNode{}\n    head.Init()\n\n    for i := 1; i &lt; 10; i++ {\n        temp := &amp;ComplexNode{i, i * 10}\n        head.AddBeforeHeadTypeCheck(temp)\n    }\n\n}\n\nfunc main() {\n    testWithComplexNumber()\n    testWithMixedType()\n\n}\n</code></pre>\n\n<p>The code is working fine - but I want to understand if there is a better or different way of doing this.</p>\n\n<p>Also - what is the performance impact of the current checking of types using the reflect package. Is there a different way of achieving the same thing.</p>\n\n<p>Unsupported type for the type *main.Student</p>\n\n<pre><code>Unsupported type for the type *main.Student\n################################################################################\nPrinting the linked list\n\n *main.ComplexNode &amp;{9 90}  9 + i90\n *main.ComplexNode &amp;{8 80}  8 + i80\n *main.ComplexNode &amp;{7 70}  7 + i70\n *main.ComplexNode &amp;{6 60}  6 + i60\n *main.ComplexNode &amp;{5 50}  5 + i50\n *main.ComplexNode &amp;{4 40}  4 + i40\n *main.ComplexNode &amp;{3 30}  3 + i30\n *main.ComplexNode &amp;{2 20}  2 + i20\n *main.ComplexNode &amp;{1 10}  1 + i10\n################################################################################\n</code></pre>\n"}, {"tags": ["go", "slice", "converters"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1548132046, "post_id": 54301251, "comment_id": 95422814, "body": "&quot;Could you tell me please can be there is more elegant decision?&quot; No, there is no really better solutions. Maybe you could reduce linecount with reflection but this opens up a different can of worms."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1548138791, "post_id": 54301251, "comment_id": 95424782, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12753805/type-converting-slices-of-interfaces-in-go\">Type converting slices of interfaces in go</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4457307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0a603de9eef99d8c2ff606c20a11956?s=128&d=identicon&r=PG&f=1", "display_name": "kradwhite", "link": "https://stackoverflow.com/users/4457307/kradwhite"}, "edited": false, "score": 0, "creation_date": 1548226767, "post_id": 54301473, "comment_id": 95462050, "body": "Thanks for your help, maybe this will do."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1548132805, "creation_date": 1548132805, "answer_id": 54301473, "question_id": 54301251, "link": "https://stackoverflow.com/questions/54301251/how-convert-multidimensional-slice-interface-to-slice-string/54301473#54301473", "title": "How convert multidimensional slice []interface{} to slice []string?", "body": "<p>Use the reflect package to handle all types of slices in a few lines of code:</p>\n\n<pre><code>func convert(dst []string, v reflect.Value) []string {\n    // Drill down to the concrete value\n    for v.Kind() == reflect.Interface {\n        v = v.Elem()\n    }\n\n    if v.Kind() == reflect.Slice {\n        // Convert each element of the slice.\n        for i := 0; i &lt; v.Len(); i++ {\n            dst = convert(dst, v.Index(i))\n        }\n    } else {\n        // Convert value to string and append to result.\n        dst = append(dst, fmt.Sprint(v.Interface()))\n    }\n    return dst\n}\n</code></pre>\n\n<p>Call it like this:</p>\n\n<pre><code>stringSlice := convert(nil, reflect.ValueOf(source))\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/HDjQeCcTaxo\" rel=\"nofollow noreferrer\">Run it on the Playground</a></p>\n"}], "owner": {"reputation": 11, "user_id": 4457307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0a603de9eef99d8c2ff606c20a11956?s=128&d=identicon&r=PG&f=1", "display_name": "kradwhite", "link": "https://stackoverflow.com/users/4457307/kradwhite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 427, "favorite_count": 1, "accepted_answer_id": 54301473, "answer_count": 1, "score": -1, "last_activity_date": 1548138783, "creation_date": 1548131010, "last_edit_date": 1548138783, "question_id": 54301251, "link": "https://stackoverflow.com/questions/54301251/how-convert-multidimensional-slice-interface-to-slice-string", "title": "How convert multidimensional slice []interface{} to slice []string?", "body": "<p>Example source:</p>\n\n<pre><code>// source multidimensional slice\nvar source = []interface{}{\n    \"value1\",\n    \"value2\",\n    1234,\n    1234.1234,\n    []int{222, 333},\n    []float32{444.444, 555.555},\n    []interface{}{555, \"value4\", []int{777, 888}}\n}\n</code></pre>\n\n<p>Target:</p>\n\n<pre><code>// target []string\nvar target = []string{\n    \"value1\",\n    \"value2\",\n    \"1234\",\n    \"1234.1234\",\n    \"222\",\n    \"333\",\n    \"444.444\",\n    \"555.555\",\n    \"555\",\n    \"value4\",\n    \"777\",\n    \"888\"\n}\n</code></pre>\n\n<p>I wrote the conversion function. But it seems to me cumbersome and it does not cover all possible options. Could you tell me please can be there is more elegant decision?</p>\n\n<pre><code>// convert multidimensional slice []interface{} to slice []string\nfunc convert(raw interface{}) (result []string) {\n    switch raw.(type) {\n    case []string:\n        result = append(result, raw.([]string) ...)\n    case []int:\n        for _, elem := range raw.([]int) {\n            result = append(result, convert(elem) ...)\n        }\n    case string, int, int8, int16, int32, int64, float32, float64, complex64, complex128:\n        result = append(result, fmt.Sprintf(\"%v\", raw))\n    case []float32:\n        for _, elem := range raw.([]float32) {\n            result = append(result, convert(elem) ...)\n        }\n    case []rune:\n        for _, elem := range raw.([]rune) {\n            result = append(result, convert(elem) ...)\n        }\n    case []int8:\n        for _, elem := range raw.([]int8) {\n            result = append(result, convert(elem) ...)\n        }\n    case []int16:\n        for _, elem := range raw.([]int16) {\n            result = append(result, convert(elem) ...)\n        }\n    case []int64:\n        for _, elem := range raw.([]int64) {\n            result = append(result, convert(elem) ...)\n        }\n    case []float64:\n        for _, elem := range raw.([]float64) {\n            result = append(result, convert(elem) ...)\n        }\n    case []complex64:\n        for _, elem := range raw.([]complex64) {\n            result = append(result, convert(elem) ...)\n        }\n    case []complex128:\n        for _, elem := range raw.([]complex128) {\n            result = append(result, convert(elem) ...)\n        }\n    case []interface{}:\n        for _, elem := range raw.([]interface{}) {\n            result = append(result, convert(elem) ...)\n        }\n    case [][]interface{}:\n        for _, elem := range raw.([][]interface{}) {\n            result = append(result, convert(elem) ...)\n        }\n    default:\n        fmt.Println(fmt.Sprintf(\"Unknown type %v\", raw))\n        os.Exit(1)\n    }\n    return result\n}\n</code></pre>\n"}, {"tags": ["go", "character-encoding"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 10874864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uywxa.jpg?s=128&g=1", "display_name": "Sunshine", "link": "https://stackoverflow.com/users/10874864/sunshine"}, "edited": false, "score": 0, "creation_date": 1548129634, "post_id": 54300916, "comment_id": 95422280, "body": "Thanks, but when I ran the code above, it display not normally."}, {"owner": {"reputation": 784, "user_id": 10737552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee6d7fb0cd2e5fb9e1daa3282b25f876?s=128&d=identicon&r=PG&f=1", "display_name": "Billy Yuan", "link": "https://stackoverflow.com/users/10737552/billy-yuan"}, "reply_to_user": {"reputation": 61, "user_id": 10874864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uywxa.jpg?s=128&g=1", "display_name": "Sunshine", "link": "https://stackoverflow.com/users/10874864/sunshine"}, "edited": false, "score": 0, "creation_date": 1548131024, "post_id": 54300916, "comment_id": 95422587, "body": "the font you are using can&#39;t display that character."}], "tags": [], "owner": {"reputation": 784, "user_id": 10737552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee6d7fb0cd2e5fb9e1daa3282b25f876?s=128&d=identicon&r=PG&f=1", "display_name": "Billy Yuan", "link": "https://stackoverflow.com/users/10737552/billy-yuan"}, "is_accepted": false, "score": 2, "last_activity_date": 1548138688, "last_edit_date": 1548138688, "creation_date": 1548128195, "answer_id": 54300916, "question_id": 54300773, "link": "https://stackoverflow.com/questions/54300773/how-to-convert-a-unicodeex-u2713-code-to-a-runeex-in-golang/54300916#54300916", "title": "How to convert a unicode(ex: \\u2713) code to a rune(ex: \u2713) in golang?", "body": "<p>As if you have a string like \"\\u2713\\u2715\". </p>\n\n<p>See in playground <a href=\"https://play.golang.org/p/AxpnCzNEOfr\" rel=\"nofollow noreferrer\">https://play.golang.org/p/AxpnCzNEOfr</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"unicode/utf8\"\n)\n\nfunc main() {\n    src := \"\\u2713\\u2715\"\n    r, _ := utf8.DecodeRuneInString(src)\n    fmt.Printf(\"the first rune of src is %v, code: %d\",string(r), r)\n}\n\n// Output\n// the first rune of src is \u2713, code: 10003\n</code></pre>\n\n<p>More sample about <code>utf8.DecodeRuneInString</code> can find from answer <a href=\"https://stackoverflow.com/a/54274978/10737552\">https://stackoverflow.com/a/54274978/10737552</a></p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 1, "last_activity_date": 1548130767, "last_edit_date": 1548130767, "creation_date": 1548130452, "answer_id": 54301183, "question_id": 54300773, "link": "https://stackoverflow.com/questions/54300773/how-to-convert-a-unicodeex-u2713-code-to-a-runeex-in-golang/54301183#54301183", "title": "How to convert a unicode(ex: \\u2713) code to a rune(ex: \u2713) in golang?", "body": "<p>The <a href=\"https://golang.org/ref/spec#String_literals\" rel=\"nofollow noreferrer\">string literal</a> <code>\"\\u2713\"</code> is a string containing the single rune <code>\u2713</code>.  No conversion is required.  </p>\n\n<p>Use the fmt package to print strings:  <code>fmt.Println(\"\\u2713\")</code></p>\n\n<p>To get the <code>\u2713</code> as a <a href=\"https://golang.org/ref/spec#Rune_literals\" rel=\"nofollow noreferrer\">rune</a>, use the rune literal <code>'\\u2713'</code></p>\n\n<p><a href=\"https://play.golang.org/p/2BcKW-T4JCI\" rel=\"nofollow noreferrer\">Run it on the  playground</a></p>\n"}], "owner": {"reputation": 61, "user_id": 10874864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uywxa.jpg?s=128&g=1", "display_name": "Sunshine", "link": "https://stackoverflow.com/users/10874864/sunshine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1548138688, "creation_date": 1548126985, "question_id": 54300773, "link": "https://stackoverflow.com/questions/54300773/how-to-convert-a-unicodeex-u2713-code-to-a-runeex-in-golang", "title": "How to convert a unicode(ex: \\u2713) code to a rune(ex: \u2713) in golang?", "body": "<p><strong>code:</strong></p>\n\n<pre><code>var checkMark = \"\\u2713\"  // stand for rune \"\u2713\"\n</code></pre>\n\n<p>and how to convert unicode \"\\u2713\" to the rune \"\u2713\" and print it ?\nIs anyone can help me, Thanks a lot very much.</p>\n"}, {"tags": ["go", "methods", "scope"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 3, "last_activity_date": 1548124833, "creation_date": 1548124833, "answer_id": 54300538, "question_id": 54300383, "link": "https://stackoverflow.com/questions/54300383/whats-the-scope-of-a-method-in-go/54300538#54300538", "title": "What&#39;s the scope of a method in Go?", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Method_declarations\" rel=\"nofollow noreferrer\">Method declarations</a></p>\n  \n  <p>A method is a function with a receiver. A method declaration binds an\n  identifier, the method name, to a method, and associates the method\n  with the receiver's base type. </p>\n  \n  <p>The receiver is specified via an extra parameter section preceding the\n  method name. That parameter section must declare a single non-variadic\n  parameter, the receiver. Its type must be of the form T or *T\n  (possibly using parentheses) where T is a type name. The type denoted\n  by T is called the receiver base type; it must not be a pointer or\n  interface type and it must be defined in the same package as the\n  method. The method is said to be bound to the base type and the method\n  name is visible only within selectors for type T or *T.</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p>The method is said to be bound to the base type and the method name is\n  visible only within selectors for type T or *T.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 5, "last_activity_date": 1548130249, "creation_date": 1548130249, "answer_id": 54301148, "question_id": 54300383, "link": "https://stackoverflow.com/questions/54300383/whats-the-scope-of-a-method-in-go/54301148#54301148", "title": "What&#39;s the scope of a method in Go?", "body": "<p>Method names do not have a scope. They must always be qualified by a value or type. </p>\n"}], "owner": {"reputation": 1070, "user_id": 4751585, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8133bc4362cccbabf6d28e25f1d4bf81?s=128&d=identicon&r=PG&f=1", "display_name": "ledonter", "link": "https://stackoverflow.com/users/4751585/ledonter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 521, "favorite_count": 1, "accepted_answer_id": 54301148, "answer_count": 2, "score": 2, "last_activity_date": 1548130249, "creation_date": 1548123746, "question_id": 54300383, "link": "https://stackoverflow.com/questions/54300383/whats-the-scope-of-a-method-in-go", "title": "What&#39;s the scope of a method in Go?", "body": "<p>From the spec ('Declarations and scope'):</p>\n\n<blockquote>\n  <p>The scope of an identifier denoting a constant, type, variable, or function (but not method) declared at top level (outside any function) is the package block.</p>\n</blockquote>\n\n<p>I guess it implies that the scope of an identifier denoting a method not a package block.</p>\n\n<p>Then what is it? I did not manage to find any info in the spec.</p>\n"}, {"tags": ["string", "go", "interface"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1548097814, "post_id": 54296286, "comment_id": 95413107, "body": "You almost never want a pointer to an interface. You most likely want an <code>interface{}</code> typed value with an underlying pointer type e.g. <code>*int</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10312705"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1548098059, "post_id": 54296286, "comment_id": 95413212, "body": "@ThunderCat the problem is: <code>convert a string to any type</code>."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10312705"}, "edited": false, "score": 0, "creation_date": 1548099054, "post_id": 54296480, "comment_id": 95413590, "body": "what about this case: <a href=\"https://play.golang.org/p/MHfeDrNembl\" rel=\"nofollow noreferrer\">play.golang.org/p/MHfeDrNembl</a> ? Let&#39;s say that test can return any valid primitive type."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10312705"}, "edited": false, "score": 0, "creation_date": 1548099217, "post_id": 54296480, "comment_id": 95413660, "body": "+ I only know it in run time, so I can&#39;t really use type assertion."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1548105249, "last_edit_date": 1548105249, "creation_date": 1548098228, "answer_id": 54296480, "question_id": 54296286, "link": "https://stackoverflow.com/questions/54296286/how-to-use-sscan-with-interface/54296480#54296480", "title": "How to use Sscan with interface", "body": "<p>Here's how to convert a string to a value of any type supported by the <code>fmt</code> package:</p>\n\n<pre><code>// convert converts s to the type of argument t and returns a value of that type.\nfunc convert(s string, t interface{}) (interface{}, error) {\n\n    // Create pointer to value of the target type\n    v := reflect.New(reflect.TypeOf(t))\n\n    // Scan to the value by passing the pointer SScan \n    _, err := fmt.Sscan(s, v.Interface())\n\n    // Dereference the pointer and return the value.\n    return v.Elem().Interface(), err\n}\n</code></pre>\n\n<p>Call it like this:</p>\n\n<pre><code>a := test()\na, err := convert(\"10\", a)\nfmt.Println(a, err)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/UXD-jEWKOC6\" rel=\"nofollow noreferrer\">Run it on the Playground</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10312705"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 54296480, "answer_count": 1, "score": 0, "last_activity_date": 1548105249, "creation_date": 1548097147, "last_edit_date": 1548098084, "question_id": 54296286, "link": "https://stackoverflow.com/questions/54296286/how-to-use-sscan-with-interface", "title": "How to use Sscan with interface", "body": "<p>I'm using to <code>fmt.Sscan</code> convert a string to any type, here is what I'm doing:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc test() interface{} {\n    return 0\n}\n\nfunc main() {\n    a := test() // this could be any type\n    v := \"10\" // this could be anything\n\n    fmt.Println(reflect.TypeOf(a), reflect.TypeOf(&amp;a))\n\n    _, err := fmt.Sscan(v, &amp;a)\n    fmt.Println(err)\n}\n</code></pre>\n\n<p>This code is failing because <code>Sscan</code> doesn't accept interfaces as the second value: <code>can't scan type: *interface {}</code>. <a href=\"https://play.golang.org/p/erWYMahIunf\" rel=\"nofollow noreferrer\">demo</a></p>\n\n<p>What I find most weird is that the first print prints: <code>int *interface {}</code>, is it a int or an interface?</p>\n\n<p>How can I assert <code>a</code> to the right type (it could be any primitive)? Is there a solution that doesn't include a giant switch statement?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["go", "go-modules"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1548096538, "post_id": 54296052, "comment_id": 95412610, "body": "Vendoring is generally for importing libraries which would be made up of Go code. Trying to vendor an HTML file is an extremely unusual use case and seems like an XY Problem. Can you describe your use case in more detail? There&#39;s probably a better way to accomplish your goals here."}, {"owner": {"reputation": 5796, "user_id": 689956, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fdc9740e5b7e8a10c83fcd06cfd99ac5?s=128&d=identicon&r=PG", "display_name": "Sathesh", "link": "https://stackoverflow.com/users/689956/sathesh"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1548096841, "post_id": 54296052, "comment_id": 95412744, "body": "I have a common project which is inherited by multiple projects. It has some common html templates which is applicable to all of its dependent projects."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1548097369, "post_id": 54296052, "comment_id": 95412935, "body": "Having the HTML file in /vendor is pretty useless, because there is no useful way to refer to that file. You should probably define a Go variable instead, that holds the HTML string. <code>var HTML = []byte(`&lt;html&gt;...&lt;&#47;html&gt;`)</code>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1548097871, "post_id": 54296052, "comment_id": 95413131, "body": "Or maybe use submodules or something like that. Go libraries are for importing Go code."}], "answers": [{"tags": [], "owner": {"reputation": 5796, "user_id": 689956, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fdc9740e5b7e8a10c83fcd06cfd99ac5?s=128&d=identicon&r=PG", "display_name": "Sathesh", "link": "https://stackoverflow.com/users/689956/sathesh"}, "is_accepted": false, "score": 0, "last_activity_date": 1548100831, "creation_date": 1548100831, "answer_id": 54297005, "question_id": 54296052, "link": "https://stackoverflow.com/questions/54296052/copy-html-files-to-vendor-folder/54297005#54297005", "title": "Copy html files to vendor folder", "body": "<p>A workaround for this issue is to have a dummy go file and go function in the html folder, and call the dummy function somewhere in the code. This makes the <code>go mod vendor</code> to copy the folder to the vendor folder. Not a cleaner way, until Go mod adds something like <code>non-go=true</code> option in deps.</p>\n"}], "owner": {"reputation": 5796, "user_id": 689956, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fdc9740e5b7e8a10c83fcd06cfd99ac5?s=128&d=identicon&r=PG", "display_name": "Sathesh", "link": "https://stackoverflow.com/users/689956/sathesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548100831, "creation_date": 1548096118, "question_id": 54296052, "link": "https://stackoverflow.com/questions/54296052/copy-html-files-to-vendor-folder", "title": "Copy html files to vendor folder", "body": "<p><strong>Use Case:</strong>\nI have Proj A and Proj B. Proj B depends on Proj A. I am using Go Modules for dependency management and <code>go mod vendor</code> for generating the vendor folder. Proj A is inside the vendor folder of Proj B.</p>\n\n<p><strong>Issue:</strong>\nIn Proj A, I have an HTML file. The HTML file is not copied to the vendor folder. </p>\n\n<p>How can I force to copy the HTML file to the vendor folder so that I can use in Proj B?</p>\n"}, {"tags": ["mysql", "go", "schema"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1548089377, "post_id": 54294277, "comment_id": 95409334, "body": "Have you considered using fmt to interpolate the schema into the query? e.g. <code>query := fmt.Sprintf(&quot;SELECT * FROM %s.table_name ...&quot;, targetSchema)</code> etc."}, {"owner": {"reputation": 11, "user_id": 10945621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4366cdc3b1338e22437ee2375596042e?s=128&d=identicon&r=PG&f=1", "display_name": "oldstaar99", "link": "https://stackoverflow.com/users/10945621/oldstaar99"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1548090096, "post_id": 54294277, "comment_id": 95409729, "body": "@mkopriva Yes, I have once considered doing that. I had no idea how should I implement that though, perhaps there is a parser good for that task?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1548090439, "post_id": 54294277, "comment_id": 95409911, "body": "There is nothing to implement, just update the queries you want to execute by adding the fmt verbs/placeholders where you want the schema name to be inserted and then before execution pass each query to Sprtinf passing in the schema as the second argument, pass the output of that to db.Query and you&#39;re done."}, {"owner": {"reputation": 11, "user_id": 10945621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4366cdc3b1338e22437ee2375596042e?s=128&d=identicon&r=PG&f=1", "display_name": "oldstaar99", "link": "https://stackoverflow.com/users/10945621/oldstaar99"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1548091035, "post_id": 54294277, "comment_id": 95410202, "body": "@mkopriva Thanks for the idea -- I&#39;ll try if that works later."}], "owner": {"reputation": 11, "user_id": 10945621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4366cdc3b1338e22437ee2375596042e?s=128&d=identicon&r=PG&f=1", "display_name": "oldstaar99", "link": "https://stackoverflow.com/users/10945621/oldstaar99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 348, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548088801, "creation_date": 1548088801, "question_id": 54294277, "link": "https://stackoverflow.com/questions/54294277/how-do-i-let-database-sql-query-multiple-schemas-in-parallel", "title": "How do I let database/sql query multiple schemas in parallel?", "body": "<p>I have mysql database with single host and a few hundred schemas, where each schemas have identical tables (and different amount of rows). What I want to do here is to query some (or all) schemas with same list of queries, and save these result for later use.<br>\nI'm using golang's <code>database/sql</code> for querying database, and I want to do that with single connection pool, and by querying each schemas in parallel (hoping it's faster that way).<br>\nI'm imagining something like this:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func QuerySchemas(queryList []string, schemaList []string) {\n  // Create a connection pool\n  db, err := sql.Open(\"mysql\", \"user:password@tcp(db_host)/\")\n  if err != nil {\n    log.Fatal(err)\n  }\n\n  for _, schema := range schemaList {\n    // Query each schema in parallel, probably with goroutine\n    go func(targetSchema string) {\n      // ...\n      // Let database/sql use targetSchema for this goroutine\n      // ...\n      for _, query := range queryList {\n        rows, err := db.Query(query)\n        // ...\n        // Save results and do other things\n        // ...\n      } \n    }(schema) \n  }\n}\n</code></pre>\n\n<p>But I can't find how to let <code>database/sql</code> query different schemas in parallel. So far I have thought of using MySQL's <code>USE</code> sentences, but that would not work as it changes schema for all goroutines.<br>\nIs there any possible solutions?</p>\n"}, {"tags": ["go", "google-cloud-platform", "google-cloud-functions"], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 1455019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d73ea428ce33b5a107d3a47addc20efd?s=128&d=identicon&r=PG", "display_name": "fgreinus", "link": "https://stackoverflow.com/users/1455019/fgreinus"}, "edited": false, "score": 0, "creation_date": 1548091317, "post_id": 54294295, "comment_id": 95410331, "body": "Mhm. I already tried that approach (as the first one), but it did not work. Strange. Will try again, thanks!"}, {"owner": {"reputation": 2611, "user_id": 872918, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b89d3f5413870b28a39767f0289c32b?s=128&d=identicon&r=PG", "display_name": "snap", "link": "https://stackoverflow.com/users/872918/snap"}, "edited": false, "score": 1, "creation_date": 1549390712, "post_id": 54294295, "comment_id": 95882558, "body": "Some additional information for the next person looking it up: Looks like GCF Go 1.11 runtime function binary path is <code>&#47;start</code> and assets/files are located in directory <code>&#47;srv&#47;files</code> which is also the current working directory (thus relative paths should work as pointed out in this answer). Using executable path to locate the assets is wrong because the executable is in file system root."}, {"owner": {"reputation": 2908, "user_id": 1432239, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/be90431046aeeaa0aeae3fd188731e34?s=128&d=identicon&r=PG", "display_name": "maclir", "link": "https://stackoverflow.com/users/1432239/maclir"}, "edited": false, "score": 3, "creation_date": 1590579439, "post_id": 54294295, "comment_id": 109731159, "body": "With go 1.13 I get &quot;no such file or directory&quot;."}, {"owner": {"reputation": 154, "user_id": 10316247, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--EoxDyFKf8Y/AAAAAAAAAAI/AAAAAAAAAuM/gd0UM-OmTx8/photo.jpg?sz=128", "display_name": "nicolasassi", "link": "https://stackoverflow.com/users/10316247/nicolasassi"}, "reply_to_user": {"reputation": 2908, "user_id": 1432239, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/be90431046aeeaa0aeae3fd188731e34?s=128&d=identicon&r=PG", "display_name": "maclir", "link": "https://stackoverflow.com/users/1432239/maclir"}, "edited": false, "score": 1, "creation_date": 1591837397, "post_id": 54294295, "comment_id": 110210923, "body": "@maclir with go 1.13 my only way was by going from root up like: ./src/my_function/assets/my_asset.html"}], "tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": true, "score": 3, "last_activity_date": 1548088850, "creation_date": 1548088850, "answer_id": 54294295, "question_id": 54293314, "link": "https://stackoverflow.com/questions/54293314/how-to-load-local-assets-within-a-gcp-cloud-function/54294295#54294295", "title": "How to load local assets within a GCP cloud function?", "body": "<p>I created http functions with the following structure:</p>\n\n<pre><code>api\n|--test.txt\n|--api.go\n</code></pre>\n\n<p>And wrote simple function to reply with file content:</p>\n\n<pre><code>package api\n\nimport (\n    \"io/ioutil\"\n    \"net/http\"\n)\n\n// FileTest func\nfunc FileTest(w http.ResponseWriter, r *http.Request) {\n    content, err := ioutil.ReadFile(\"./test.txt\")\n    if err != nil {\n        w.WriteHeader(http.StatusInternalServerError)\n        w.Write([]byte(err.Error()))\n        return\n    }\n\n    w.Write(content)\n}\n</code></pre>\n\n<p>It returns the file content without any problems. <a href=\"https://us-central1-clickshield24m.cloudfunctions.net/api\" rel=\"nofollow noreferrer\">https://us-central1-clickshield24m.cloudfunctions.net/api</a></p>\n\n<p>So in your case I would try change the path to <code>gg.LoadPNG(\"./english.png\")</code></p>\n"}, {"tags": [], "owner": {"reputation": 1194, "user_id": 867786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe6d059c1c0e24de78b23bcd44398f02?s=128&d=identicon&r=PG", "display_name": "Nuno Cruces", "link": "https://stackoverflow.com/users/867786/nuno-cruces"}, "is_accepted": false, "score": 5, "last_activity_date": 1614767581, "last_edit_date": 1614767581, "creation_date": 1594228403, "answer_id": 62800085, "question_id": 54293314, "link": "https://stackoverflow.com/questions/54293314/how-to-load-local-assets-within-a-gcp-cloud-function/62800085#62800085", "title": "How to load local assets within a GCP cloud function?", "body": "<p>For the Go 1.13 according to the <a href=\"https://cloud.google.com/functions/docs/concepts/exec#file_system\" rel=\"nofollow noreferrer\">documentation</a>, as of today (Jul 2020), source code is located in the <code>./serverless_function_source_code</code> directory.</p>\n<p>A good reference to follow is the <a href=\"https://github.com/GoogleCloudPlatform/buildpacks/blob/master/cmd/go/functions_framework/main.go\" rel=\"nofollow noreferrer\">buildpack</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 2544, "user_id": 1007151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b61eced2e6b06628580af0dace82283b?s=128&d=identicon&r=PG", "display_name": "darnmason", "link": "https://stackoverflow.com/users/1007151/darnmason"}, "is_accepted": false, "score": 0, "last_activity_date": 1600387953, "creation_date": 1600387953, "answer_id": 63947657, "question_id": 54293314, "link": "https://stackoverflow.com/questions/54293314/how-to-load-local-assets-within-a-gcp-cloud-function/63947657#63947657", "title": "How to load local assets within a GCP cloud function?", "body": "<p><code>./serverless_function_source_code</code> didn't work for me using go113 runtime with vendoring. I wanted to locate a file in the vendor directory.</p>\n<p>My file structure is:</p>\n<pre><code>myfn\n|- main.go\n|- go.mod\n|- .gcloudignore\n</code></pre>\n<p>My deployment steps are:</p>\n<pre><code>cd myfn\ngo mod vendor\ngcloud functions deploy MyFunction --runtime go113 --set-env-vars &quot;PATH_FILES=./src/myfn/vendor/static&quot;\n</code></pre>\n<p>I found this out by deploying a function that listed all files to a certain depth starting with <code>&quot;.&quot;</code> and didn't see a <code>serverless_function_source_code</code> directory. But there was <code>src/myfn</code>.</p>\n"}], "owner": {"reputation": 97, "user_id": 1455019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d73ea428ce33b5a107d3a47addc20efd?s=128&d=identicon&r=PG", "display_name": "fgreinus", "link": "https://stackoverflow.com/users/1455019/fgreinus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 968, "favorite_count": 1, "accepted_answer_id": 54294295, "answer_count": 3, "score": 3, "last_activity_date": 1614767581, "creation_date": 1548085380, "question_id": 54293314, "link": "https://stackoverflow.com/questions/54293314/how-to-load-local-assets-within-a-gcp-cloud-function", "title": "How to load local assets within a GCP cloud function?", "body": "<p>I'm building a tiny GCP cloud function in Golang that returns a generated PNG file when calling it via HTTP. I deployed my code via ZIP-Upload in the Google Cloud Console.\nCurrently it gets called properly and the code gets compiled etc. But in my code I have to load several local files - a font and a .png image.\nI bundled those in the ZIP I uploaded and the files are visible in the Source-View in GCP. All files (images, fonts and go-files) are within the same directory.</p>\n\n<p>When calling the cloud function the log states the following:</p>\n\n<pre><code>2019/01/21 14:59:31 open /english.png: no such file or directory\n</code></pre>\n\n<p>I tried to change the way i build the path to the file in go. I already used /german.png statically, used several attempts to build the path dynamically.</p>\n\n<p>I'm not 100 percent sure if this is the way to go, but it is my first experiment with \"serverless\" and i am willing to get it done the \"right\" way.</p>\n\n<pre><code>import \"github.com/fogleman/gg\"\n\n\nfunc main() {\n    ex, err := os.Executable()\n    if err != nil {\n        panic(err)\n    }\n    executableDir := filepath.Dir(ex)\n\n    img, err :=gg.LoadPNG(path.Join(executableDir, \"./english.png\"))\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>Currently the file can not be found in any attempt i made. Maybe the path the images get \"deployed\" into are different from the ones i tried - i have not found any note on that in the documentation.\nI'd obviously expect it to be loaded properly.</p>\n"}, {"tags": ["git", "go", "import", "git-workflow", "git-worktree"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548081587, "post_id": 54291876, "comment_id": 95404991, "body": "Why is it checked out in a different path? Just checkout the branch you\u2019re working on at the correct import path."}, {"owner": {"reputation": 2442, "user_id": 2992311, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4d9ba0fd9746a312062ce02e6561c3ac?s=128&d=identicon&r=PG&f=1", "display_name": "DenLilleMand", "link": "https://stackoverflow.com/users/2992311/denlillemand"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548081929, "post_id": 54291876, "comment_id": 95405197, "body": "That is the whole point, <code>git worktree</code> gives you the possibility to work on several branches at the same time, and cherry pick commits between them.   Aside from the boosted development speed, it also has some performance gains for your IDE to not rewrite your entire file system every time you want to switch between 2 branches.  There is probably some blog post somewhere for additional benefits of the <code>git worktree</code> command."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548084589, "post_id": 54291876, "comment_id": 95406685, "body": "I understand <code>worktree</code>, but you&#39;re saying &quot;It doesn&#39;t work well when I do it wrong, but I want to continue doing it wrong&quot;. With GOPATH either need to checkout the branch at the correct import path, or rewrite the import paths. With modules you can do a local replace, but once you commit modules you&#39;re still going to have to fix the <code>go.mod</code> each time you switch <code>worktree</code>."}, {"owner": {"reputation": 2442, "user_id": 2992311, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4d9ba0fd9746a312062ce02e6561c3ac?s=128&d=identicon&r=PG&f=1", "display_name": "DenLilleMand", "link": "https://stackoverflow.com/users/2992311/denlillemand"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548085234, "post_id": 54291876, "comment_id": 95407063, "body": "Why are you saying i want to continue doing it the wrong way?  i can&#39;t do it at all.  As i read your comment, you&#39;re just saying that it cant be done, that is fair enough input - but could be put in a more brief form."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548085700, "post_id": 54291876, "comment_id": 95407338, "body": "By &quot;wrong way&quot;, I just mean you&#39;re fighting against the go tools. Give go modules a try. If you&#39;re only working within the same module, you might not have any problems. If you&#39;re working between modules then it&#39;s still going to be inconvenient to have multiple trees."}, {"owner": {"reputation": 2442, "user_id": 2992311, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4d9ba0fd9746a312062ce02e6561c3ac?s=128&d=identicon&r=PG&f=1", "display_name": "DenLilleMand", "link": "https://stackoverflow.com/users/2992311/denlillemand"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1548086178, "post_id": 54291876, "comment_id": 95407641, "body": "Yeah i will give it a go :) thanks"}], "owner": {"reputation": 2442, "user_id": 2992311, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4d9ba0fd9746a312062ce02e6561c3ac?s=128&d=identicon&r=PG&f=1", "display_name": "DenLilleMand", "link": "https://stackoverflow.com/users/2992311/denlillemand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 395, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548081633, "creation_date": 1548080296, "last_edit_date": 1548081633, "question_id": 54291876, "link": "https://stackoverflow.com/questions/54291876/go-and-git-worktree-command", "title": "Go and `git worktree` command", "body": "<p>I guess this question also relates a little bit to how you work with forks in <code>Go</code>, which i don't think there exists a good solution for.</p>\n\n<p>I am maintaining a old version of a product, so i often fix a bug in e.g. branch <code>v0</code>, then i want to cherry pick the commit that fixes the bug into my master branch as well of course.</p>\n\n<p>This kind of workflow is much better when you have access to <code>git worktree</code> which allows me to have both <code>master</code> and <code>v0</code> checked out at the same time. My problem now is that my <code>master branch</code> worktree would be e.g. checked out at <code>~/go/src/github.com/&lt;company&gt;/wt1_server</code> while my <code>v0 branch</code> would be checked out at <code>~/go/src/github.com/company/server</code>.</p>\n\n<p>Now my problem is that the imports of the <code>master branch</code> is effectively importing code from the <code>v0 branch</code> because all of the imports is pointing to that repo, instead of being relative.</p>\n\n<p>Have anyone found a pretty fix to this?</p>\n\n<p>EDIT: A tool like <a href=\"https://github.com/rogpeppe/govers\" rel=\"nofollow noreferrer\">https://github.com/rogpeppe/govers</a> can for example update the paths automatically. But that is going to make it impossible make any commits before reverting it back again. A very poor fix :) </p>\n\n<p>EDIT 2: Looks like <code>Go</code> modules could be a solution because of it's relative path to the module - i don't think i can have two modules with the same name installed at the same time though. But it could be a okay solution to run a <code>go install .</code> when i have to work in some specific worktree</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1548078386, "post_id": 54291236, "comment_id": 95403184, "body": "&quot;I believe main() could exit without details of panic() ever being written to stdout/stderr&quot;. Your believe is wrong. With panic unrolling the stack main is no longer executing normally."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1548079874, "post_id": 54291236, "comment_id": 95403982, "body": "That belief is easily tested and proven wrong by just running the code: <a href=\"https://play.golang.org/p/yzfFfE0Y8iT\" rel=\"nofollow noreferrer\">play.golang.org/p/yzfFfE0Y8iT</a>"}, {"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1548084629, "post_id": 54291236, "comment_id": 95406703, "body": "<a href=\"https://golang.org/ref/spec#Defer_statements\" rel=\"nofollow noreferrer\">Defer statements</a> run even if their function or goroutine panics (see the end of the first paragraph)."}, {"owner": {"reputation": 1320, "user_id": 593146, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2404c3e4304714294c0458b3feb39ff0?s=128&d=identicon&r=PG", "display_name": "Zyl", "link": "https://stackoverflow.com/users/593146/zyl"}, "edited": false, "score": 0, "creation_date": 1548089589, "post_id": 54291236, "comment_id": 95409438, "body": "ITT: noone understanding the question. For anyone else with a similar problem: You can work around the uncertainty by writing a stack-trace yourself e.g. <code>logrus.Error(fmt.Sprintf(&quot;%v\\n\\n%s&quot;, &quot;Something unexpected happened.&quot;, string(debug.Stack())))</code> (not entirely the same as the output of <code>panic()</code>, but good enough) and only then calling <code>Done()</code> on the wait group, letting your go routine terminate normally. If it does, it&#39;s good to know that recovering from panic leads to a blank return of the function longest in the call stack which encountered the panic. If it doesn&#39;t, no problem."}], "answers": [{"tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": false, "score": 3, "last_activity_date": 1548078375, "creation_date": 1548078375, "answer_id": 54291348, "question_id": 54291236, "link": "https://stackoverflow.com/questions/54291236/how-to-wait-for-a-panicking-goroutine/54291348#54291348", "title": "How to wait for a panicking goroutine?", "body": "<p>The <code>panic</code> will kill the process regardless, because no one is recovering from it. If you want to recover from panics in a goroutine, you must have <code>recover</code> wrapping the call stack in the same goroutine.</p>\n\n<p><code>wg.Done</code> will be called in this case, by the <code>defer</code> statement. But the process may die before the main goroutine finishes the <code>wg.Wait</code> anyway.</p>\n"}, {"tags": [], "owner": {"reputation": 784, "user_id": 10737552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee6d7fb0cd2e5fb9e1daa3282b25f876?s=128&d=identicon&r=PG&f=1", "display_name": "Billy Yuan", "link": "https://stackoverflow.com/users/10737552/billy-yuan"}, "is_accepted": false, "score": 1, "last_activity_date": 1548122477, "creation_date": 1548122477, "answer_id": 54300226, "question_id": 54291236, "link": "https://stackoverflow.com/questions/54291236/how-to-wait-for-a-panicking-goroutine/54300226#54300226", "title": "How to wait for a panicking goroutine?", "body": "<p>@Eli Bendersky was right.</p>\n\n<p>Reference <a href=\"https://golang.org/src/builtin/builtin.go?h=panic#L227\" rel=\"nofollow noreferrer\">src/builtin/builtin.go</a></p>\n\n<blockquote>\n  <p>The panic built-in function stops normal execution of the current\n  goroutine. When a function F calls panic, normal execution of F stops\n  immediately. Any functions whose execution was deferred by F are run in\n  the usual way, and then F returns to its caller. To the caller G, the\n  invocation of F then behaves like a call to panic, terminating G's\n  execution and running any deferred functions. This continues until all\n  functions in the executing goroutine have stopped, in reverse order. At\n  that point, the program is terminated and the error condition is reported,\n  including the value of the argument to panic. This termination sequence\n  is called panicking and can be controlled by the built-in function\n  recover.</p>\n</blockquote>\n\n<p>after <code>panic</code>, <code>defer</code> func will be called. </p>\n\n<p>Check this in playground: <a href=\"https://play.golang.org/p/yrXkEbE1Af7\" rel=\"nofollow noreferrer\">https://play.golang.org/p/yrXkEbE1Af7</a></p>\n\n<pre><code>package main\n\nimport (\n    \"sync\"\n    \"fmt\"\n)\n\nfunc main() {\n    wg := &amp;sync.WaitGroup{}\n    wg.Add(1)\n    go func() {\n        defer func(){\n            fmt.Println(\"expected to be called after panic\")\n            wg.Done()\n        }()\n        // Long running task\n        panic(\"Something unexpected happened.\")\n    }()\n    wg.Wait()\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>expected to be called after panic\npanic: Something unexpected happened.\n\ngoroutine 5 [running]:\nmain.main.func1(0x416020, 0x0)\n    /tmp/sandbox946785562/main.go:17 +0x60\ncreated by main.main\n    /tmp/sandbox946785562/main.go:11 +0x80\n</code></pre>\n\n<p>Then your second question, \"how to prevent that?\"</p>\n\n<p>As metioned before, you can <code>recover</code> after <code>panic</code></p>\n\n<p>Playground: <a href=\"https://play.golang.org/p/76pPrCVYN8u\" rel=\"nofollow noreferrer\">https://play.golang.org/p/76pPrCVYN8u</a></p>\n\n<pre><code>package main\n\nimport (\n    \"sync\"\n    \"fmt\"\n)\n\nfunc main() {\n    wg := &amp;sync.WaitGroup{}\n    wg.Add(1)\n    go func() {\n        defer func(){\n            if x:=recover();x!=nil{\n                fmt.Printf(\"%+v\\n\",x)\n            }\n            wg.Done()\n        }()\n        // Long running task\n        panic(\"Something unexpected happened.\")\n    }()\n    wg.Wait()\n    for i:=0;i&lt;10;i++{\n        fmt.Println(i)\n    }\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>Something unexpected happened.\n0\n1\n2\n3\n4\n5\n6\n7\n8\n9\n</code></pre>\n"}], "owner": {"reputation": 1320, "user_id": 593146, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2404c3e4304714294c0458b3feb39ff0?s=128&d=identicon&r=PG", "display_name": "Zyl", "link": "https://stackoverflow.com/users/593146/zyl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 398, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1548122477, "creation_date": 1548077969, "question_id": 54291236, "link": "https://stackoverflow.com/questions/54291236/how-to-wait-for-a-panicking-goroutine", "title": "How to wait for a panicking goroutine?", "body": "<p>A common way to wait for a goroutine is to use a <code>*sync.WaitGroup</code>:</p>\n\n<pre><code>func main() {\n    wg := &amp;sync.WaitGroup{}\n    wg.Add(1)\n    go func() {\n        defer wg.Done()\n        // Long running task\n    }()\n    wg.Wait()\n}\n</code></pre>\n\n<p>No problems here. However, what about this:</p>\n\n<pre><code>func main() {\n    wg := &amp;sync.WaitGroup{}\n    wg.Add(1)\n    go func() {\n        defer wg.Done()\n        // Long running task\n        panic(\"Something unexpected happened.\")\n    }()\n    wg.Wait()\n}\n</code></pre>\n\n<p>In this case, when <code>wg.Done()</code> is called, I believe <code>main()</code> could exit without details of <code>panic()</code> ever being written to <code>stdout</code>/<code>stderr</code>. Is this true and if yes, how might I prevent it from happening?</p>\n"}, {"tags": ["json", "go", "range"], "comments": [{"owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "edited": false, "score": 0, "creation_date": 1548077510, "post_id": 54290985, "comment_id": 95402711, "body": "What is <code>i</code> in your code snippet?"}, {"owner": {"reputation": 1320, "user_id": 593146, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2404c3e4304714294c0458b3feb39ff0?s=128&d=identicon&r=PG", "display_name": "Zyl", "link": "https://stackoverflow.com/users/593146/zyl"}, "edited": false, "score": 2, "creation_date": 1548078369, "post_id": 54290985, "comment_id": 95403175, "body": "There are a couple confusing things about your question. You refer to a <code>map[string]bool</code> and key-value pairs as a JSON array, but maps, if at all, might only represent JSON <i>objects</i>. See <a href=\"https://www.json.org/\" rel=\"nofollow noreferrer\">json.org</a> There also isn&#39;t any actual JSON anywhere in your question, so I am not sure if I understand what is going on."}, {"owner": {"reputation": 93, "user_id": 10209822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91868bc4cac62cb5aba3a0b67520bc08?s=128&d=identicon&r=PG&f=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/10209822/priyanka"}, "edited": false, "score": 0, "creation_date": 1548078493, "post_id": 54290985, "comment_id": 95403244, "body": "i refers to index variable in for loop like for i,value := range Keystrings { }"}, {"owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "edited": false, "score": 1, "creation_date": 1548078591, "post_id": 54290985, "comment_id": 95403291, "body": "But there is no <code>i</code> in your loop range. Also, note that the contents of <code>Keystrings</code> don&#39;t map as keys of <code>flags</code> because they have extra year-month after the name. You should try to post a minimal code sample that actually runs, and try to separate the two steps (reading JSON from updating the <code>flags</code> map). Otherwise it&#39;s challenging to help you because we have to guess your intent"}, {"owner": {"reputation": 93, "user_id": 10209822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91868bc4cac62cb5aba3a0b67520bc08?s=128&d=identicon&r=PG&f=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/10209822/priyanka"}, "edited": false, "score": 0, "creation_date": 1548078765, "post_id": 54290985, "comment_id": 95403389, "body": "I am new to golang. if there is any errors in declaring a json array, kindly suggest me the changes. My requirement is ** I have to update the value of terminationFlag, transferredFlag, jrCancelledFlag, jrFilledFlag to &quot;true&quot; on iteration of for loop**. only 1 flag has to be updated during 1 iteration. then i have to return the complete json after updating all the flags. If any syntax errors please help me in doing the changes also."}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1548078838, "post_id": 54290985, "comment_id": 95403421, "body": "Add two example lines of input data from your json file to the question please.  This will make it much easier to understand"}, {"owner": {"reputation": 93, "user_id": 10209822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91868bc4cac62cb5aba3a0b67520bc08?s=128&d=identicon&r=PG&f=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/10209822/priyanka"}, "edited": false, "score": 0, "creation_date": 1548079102, "post_id": 54290985, "comment_id": 95403556, "body": "@ Eli Bendersky the flags is an dynamic array that i have created to store the values as true. If there is any other way to store true in the respective flag and return those values, please help me on this. because i have no idea how to update and pass. and this is my full code"}, {"owner": {"reputation": 93, "user_id": 10209822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91868bc4cac62cb5aba3a0b67520bc08?s=128&d=identicon&r=PG&f=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/10209822/priyanka"}, "reply_to_user": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1548079443, "post_id": 54290985, "comment_id": 95403725, "body": "@Vorsprung I dont have any specific input data.  the values in the Keystrings [ ] is the Keys that i have already stored in my db. so getstate(value) will give me the value for that particular Key. In my case, the value obtained from db is &quot;yes&quot;. If i get the result as &quot;yes&quot;, I have to update 1 flag as true. Like wise i have to check the value for other Keys that i have in Keystrings and check whether the result obtained is &quot;yes&quot;, If &quot;yes&quot;, again set another flag to true."}, {"owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "edited": false, "score": 0, "creation_date": 1548079588, "post_id": 54290985, "comment_id": 95403803, "body": "Priyanka, I really want to help but you&#39;re making it super hard, I hope you see why. You should read <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a> in detail, a few times, and try to map the advice to your question. I&#39;m posting an answer with some general building blocks that will be useful for your question, hopefully that will help you get to the right solution. SO is unlikely to solve every last issue in the code for you and ultimately you&#39;ll have to practice and learn to debug your code and adjust samples you find to your concrete needs. Good luck"}], "answers": [{"tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": false, "score": 0, "last_activity_date": 1548079454, "creation_date": 1548079454, "answer_id": 54291635, "question_id": 54290985, "link": "https://stackoverflow.com/questions/54290985/how-to-replace-update-a-key-value-inside-a-json-array-in-golang/54291635#54291635", "title": "How to replace/update a key value inside a json array in golang?", "body": "<p>Since it's very hard to understand from the question what is being asked, here's a simple attempt at working with similar data as the question, in the hope that you can take the right parts from this sample and adapt them to your issue. Follow the comments in the code to understand what's going on.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n)\n\nvar jsonBlob = []byte(`[\"jrCancelledFlag\", \"yes\"]`)\n\nvar flags = map[string]bool{\n    \"terminationFlag\": false,\n    \"transferFlag\":    false,\n    \"jrCancelledFlag\": false,\n    \"jrFilledFlag\":    false,\n}\n\nfunc main() {\n    // Parse jsonBlob into a slice of strings\n    var parsed []string\n    if err := json.Unmarshal(jsonBlob, &amp;parsed); err != nil {\n        log.Fatalf(\"JSON unmarshal: %s\", err)\n    }\n\n    // Expect the slice to be of length 2, first item flag name, second item\n    // yes/no.\n    if len(parsed) != 2 {\n        log.Fatalf(\"parsed len %d, expected 2\", len(parsed))\n    }\n\n    // Assume parsed[0] actually appears in flags... otherwise more error checking\n    // is needed.\n    if parsed[1] == \"yes\" {\n        flags[parsed[0]] = true\n    }\n\n    // Emit updated flags as json\n    json, err := json.Marshal(flags)\n    if err != nil {\n        log.Fatalf(\"JSON marshal: %s\", err)\n    }\n    fmt.Println(string(json))\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "is_accepted": false, "score": 0, "last_activity_date": 1548124299, "creation_date": 1548124299, "answer_id": 54300466, "question_id": 54290985, "link": "https://stackoverflow.com/questions/54290985/how-to-replace-update-a-key-value-inside-a-json-array-in-golang/54300466#54300466", "title": "How to replace/update a key value inside a json array in golang?", "body": "<p>This can be achieved cleaning by using the JSON interface to define your own unmarshaller </p>\n\n<p><a href=\"https://medium.com/@nate510/dynamic-json-umarshalling-in-go-88095561d6a0\" rel=\"nofollow noreferrer\">https://medium.com/@nate510/dynamic-json-umarshalling-in-go-88095561d6a0</a></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n)\n\nvar jsonBlob = []byte(`[\"jrCancelledFlag\", \"yes\"]`)\n\n// Flags ...\ntype Flags struct {\n    TerminationFlag bool `json:\"terminationFlag,omitempty\"`\n    TransferFlag    bool `json:\"transferFlag,omitempty\"`\n    JRCancelledFlag bool `json:\"jrCancelledFlag,omitempty\"`\n    JRFilledFlag    bool `json:\"jrFilledFlag,omitempty\"`\n}\n\n// UnmarshalJSON satisfies the JSON unmarshaller interface\nfunc (f *Flags) UnmarshalJSON(data []byte) error {\n    var parsed []string\n    if err := json.Unmarshal(jsonBlob, &amp;parsed); err != nil {\n        return err\n    }\n    if len(parsed)%2 != 0 {\n        return fmt.Errorf(\"expected string to be evenly paired\")\n    }\n\n    for i := 0; i &lt; len(parsed); i++ {\n        j := i + 1\n        if j &lt; len(parsed) {\n            switch parsed[i] {\n            case \"terminationFlag\":\n                f.TerminationFlag = toBool(parsed[j])\n            case \"transferFlag\":\n                f.TransferFlag = toBool(parsed[j])\n            case \"jrCancelledFlag\":\n                f.JRCancelledFlag = toBool(parsed[j])\n            case \"jrFilledFlag\":\n                f.JRFilledFlag = toBool(parsed[j])\n            }\n        }\n    }\n    return nil\n}\n\nfunc toBool(s string) bool {\n    if s == \"yes\" {\n        return true\n    }\n    return false\n}\n\nfunc main() {\n\n    var flags Flags\n    err := json.Unmarshal(jsonBlob, &amp;flags)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    b, _ := json.Marshal(flags)\n    fmt.Println(string(b))\n}\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 10209822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91868bc4cac62cb5aba3a0b67520bc08?s=128&d=identicon&r=PG&f=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/10209822/priyanka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1929, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1548124299, "creation_date": 1548076939, "last_edit_date": 1548084927, "question_id": 54290985, "link": "https://stackoverflow.com/questions/54290985/how-to-replace-update-a-key-value-inside-a-json-array-in-golang", "title": "How to replace/update a key value inside a json array in golang?", "body": "<p>I have a json array where it contains some flags as key and I have set the default values for those keys as false. this is my json array.</p>\n\n<pre><code>var flags = map[string]bool{\n    \"terminationFlag\":  false,\n    \"transferFlag\":   false,\n    \"jrCancelledFlag\": false,\n    \"jrFilledFlag\":  false,\n}\n</code></pre>\n\n<p>On performing an operation in a for loop, i have to update 1 field in the above json array as true. During the next iteration, it has to update the 2nd field in the json array as true. After all the fields in the json array is set to true, I have to return the json array.</p>\n\n<p>the code i tried:</p>\n\n<pre><code>  Keystrings := []string{\"terminationReport - 2019-1\",\"transferReport - 2019-1\",\"jrCancelledReport - 2019-1\",\"jrFilledReport - 2019-1\"}\n  fmt.Println(\"Keystrings \", Keystrings)\n\n  for i,value := range Keystrings {     \n    bytesread, err = stub.GetState(value)\n    var result []string\n    _ = json.Unmarshal(bytesread, &amp;result)\n    fmt.Println(\"result \", result)\n    if result[0] == \"yes\"{\n        fmt.Println(\"result in if \", result)\n       flags[i] = true\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "websocket", "gorilla"], "comments": [{"owner": {"reputation": 149, "user_id": 2828599, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a90ebbe32f3e64b22a66e07e7ec639cb?s=128&d=identicon&r=PG", "display_name": "Bhargav Panth", "link": "https://stackoverflow.com/users/2828599/bhargav-panth"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1548079119, "post_id": 54290124, "comment_id": 95403569, "body": "The problem is finding the <code>*Client</code>"}, {"owner": {"reputation": 149, "user_id": 2828599, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a90ebbe32f3e64b22a66e07e7ec639cb?s=128&d=identicon&r=PG", "display_name": "Bhargav Panth", "link": "https://stackoverflow.com/users/2828599/bhargav-panth"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1548079235, "post_id": 54290124, "comment_id": 95403624, "body": "Should I maintain a map of the clients in a DB? Doesn&#39;t the <code>Client</code> struct have the required things to identify a client uniquely?"}, {"owner": {"reputation": 149, "user_id": 2828599, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a90ebbe32f3e64b22a66e07e7ec639cb?s=128&d=identicon&r=PG", "display_name": "Bhargav Panth", "link": "https://stackoverflow.com/users/2828599/bhargav-panth"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1548083352, "post_id": 54290124, "comment_id": 95405999, "body": "@ThunderCat Thank you for the suggestion, hopefully this edit makes thing a little clearer"}, {"owner": {"reputation": 149, "user_id": 2828599, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a90ebbe32f3e64b22a66e07e7ec639cb?s=128&d=identicon&r=PG", "display_name": "Bhargav Panth", "link": "https://stackoverflow.com/users/2828599/bhargav-panth"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1548084510, "post_id": 54290124, "comment_id": 95406650, "body": "Ah, let me take a look at that example once. Will update on this thread shortly. Thank you @ThunderCat"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 13, "last_activity_date": 1567703307, "last_edit_date": 1567703307, "creation_date": 1548089344, "answer_id": 54294421, "question_id": 54290124, "link": "https://stackoverflow.com/questions/54290124/sending-a-websocket-message-to-a-specific-client-in-go-using-gorilla/54294421#54294421", "title": "Sending a Websocket message to a specific client in Go (using Gorilla)", "body": "<p>The chat example shows how to implement broadcast. The chat example is not a good starting point for an application if broadcast is not required.</p>\n\n<p>To send a message to a specific websocket connection, simply write to the connection using <a href=\"https://godoc.org/github.com/gorilla/websocket#Conn.NextWriter\" rel=\"noreferrer\">NextWriter</a> or <a href=\"https://godoc.org/github.com/gorilla/websocket#Conn.WriteMessage\" rel=\"noreferrer\">WriteMessage</a>. These methods do not support concurrent writers, so you may need to use a mutex or goroutine to ensure a single writer.</p>\n\n<p>The simple approach for finding a specific <code>*websocket.Connection</code> is to pass <code>*websocket.Connection</code> to the code that needs it. If the application needs to associate other state with a connection, then define a type to hold that state and pass a pointer to that around:</p>\n\n<pre><code>type Client struct {\n    conn *websocket.Conn\n    mu sync.Mutex\n    ...\n}\n</code></pre>\n\n<p>The <code>Hub</code> can be modified to send messages to specific connection, but it's a roundabout path if broadcast is not needed. Here's how to do it:</p>\n\n<p>Add ID field to client:</p>\n\n<pre><code> ID idType // replace idType with int, string, or whatever you want to use\n</code></pre>\n\n<p>Change the Gorilla hub field from <code>connections map[*connection]bool</code> to <code>connections map[idType]*connection</code>.</p>\n\n<p>Define a message type containing the message data and the ID of the target client:</p>\n\n<pre><code>type message struct {\n   ID idtype\n   data []byte\n}\n</code></pre>\n\n<p>Replace the hub broadcast field with:</p>\n\n<pre><code>   send chan message\n</code></pre>\n\n<p>Change the hub for loop to:</p>\n\n<pre><code>for {\n    select {\n    case client := &lt;-h.register:\n        h.clients[client.ID] = client\n    case client := &lt;-h.unregister:\n        if _, ok := h.clients[client.ID]; ok {\n            delete(h.clients, client.ID)\n            close(client.send)\n        }\n    case message := &lt;-h.send:\n        if client, ok := h.clients[message.ID]; ok {\n            select {\n            case client.send &lt;- message.data:\n            default:\n                close(client.send)\n                delete(h.connections, client)\n            }\n        }\n    }\n</code></pre>\n\n<p>Send messages to a specific client by creating a <code>message</code> with the appropriate ID:</p>\n\n<pre><code>   hub.send &lt;- message{ID: targetID, data: data}\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 2828599, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a90ebbe32f3e64b22a66e07e7ec639cb?s=128&d=identicon&r=PG", "display_name": "Bhargav Panth", "link": "https://stackoverflow.com/users/2828599/bhargav-panth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5110, "favorite_count": 3, "accepted_answer_id": 54294421, "answer_count": 1, "score": 8, "last_activity_date": 1567703307, "creation_date": 1548074107, "last_edit_date": 1548083182, "question_id": 54290124, "link": "https://stackoverflow.com/questions/54290124/sending-a-websocket-message-to-a-specific-client-in-go-using-gorilla", "title": "Sending a Websocket message to a specific client in Go (using Gorilla)", "body": "<p>I am very new to Go and have found myself working with sockets as my first project. This is a redundant question, but I have failed to understand how \nto send a websocket update to a specific client in Go (using Gorilla).</p>\n\n<p>The broad problem that I am trying to solve is - Building a typeahead using websockets and a search engine like ES/Lucene. I have maintained a bunch of indexes on my search engine and have a Go wrapper around it. When I started working on using websockets in Go, I have been finding almost all the examples showing broadcasting mechanism. When I tried to dig into this and tried to modify the example given in Gorilla's github <a href=\"https://github.com/gorilla/websocket/tree/master/examples/chat\" rel=\"noreferrer\">repo</a> based on the examples given in <a href=\"https://github.com/gorilla/websocket/issues/46\" rel=\"noreferrer\">this</a> thread and in this <a href=\"https://stackoverflow.com/questions/31598147/how-to-send-to-only-one-client-and-not-all-clients-using-go-and-gorilla-websocke\">answer</a>, I don't seem to understand <code>connections</code> and how does that fit in <code>client.go</code></p>\n\n<p>Ideally, the way I would like to see this working is -</p>\n\n<ul>\n<li>A socket connection between the client and server is established</li>\n<li>Upon the client sending inputs via the socket, the server fetches it and throws into into a channel (Go channel)</li>\n<li>The indexing wrapper checks for this channel, and once there is something to fetch, the index is retrieved and written back to the socket</li>\n</ul>\n\n<p>How can the server uniquely identify the <code>Client</code>?</p>\n\n<p>I have used the examples given on Gorilla's Github <a href=\"https://github.com/gorilla/websocket/tree/master/examples/chat\" rel=\"noreferrer\">repo</a></p>\n\n<p>From my codebase <code>hub.go</code> has the following </p>\n\n<pre><code>type Hub struct {\n    // Registered clients.\n    clients map[*Client]bool\n\n    // Inbound messages from the clients.\n    broadcast chan []byte\n\n    // Register requests from the clients.\n    register chan *Client\n\n    // Unregister requests from clients.\n    unregister chan *Client\n\n    connections map[string]*connection\n}\n\nfunc newHub() *Hub {\n    return &amp;Hub{\n        broadcast:  make(chan []byte),\n        register:   make(chan *Client),\n        unregister: make(chan *Client),\n        clients:    make(map[*Client]bool),\n        connection: make(map[*Client]bool), // is this alright?\n    }\n}\n\nfunc (h *Hub) run() {\n    for {\n        select {\n        case client := &lt;-h.register:\n            h.clients[client] = true\n        case client := &lt;-h.unregister:\n            if _, ok := h.clients[client]; ok {\n                delete(h.clients, client)\n                close(client.send)\n            }\n        case message := &lt;-h.broadcast:\n            for client := range h.connections {\n                select {\n                case client.send &lt;- message:\n                default:\n                    close(client.send)\n                    delete(h.connections, client)\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>and I am unsure with what I should be adding to <code>client.go</code></p>\n\n<pre><code>type Client struct {\n    // unique ID for each client\n    // id string\n\n    // Hub object\n    hub *Hub\n\n    // The websocket connection.\n    conn *websocket.Conn\n\n    // Buffered channel of outbound messages.\n    send chan []byte\n\n    // connection --&gt; (what should the connection property be?)\n    connection string\n}\n</code></pre>\n\n<p>Please note - I will be adding an <code>Id</code> field within the <code>Client</code> struct. How can I proceed from here?</p>\n"}, {"tags": ["go", "networking", "vpn", "http-proxy", "tun"], "answers": [{"tags": [], "owner": {"reputation": 508, "user_id": 769189, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/20f35ed0d0a9754007d680d997307500?s=128&d=identicon&r=PG", "display_name": "amd", "link": "https://stackoverflow.com/users/769189/amd"}, "is_accepted": false, "score": 0, "last_activity_date": 1548230048, "creation_date": 1548230048, "answer_id": 54322369, "question_id": 54290037, "link": "https://stackoverflow.com/questions/54290037/not-able-to-forward-traffic-from-tun-interface-to-lo/54322369#54322369", "title": "Not able to forward traffic from `tun` interface to `lo`", "body": "<p>Found the issue:</p>\n\n<ul>\n<li>Network config was alright.</li>\n<li><p>Serialization of packets was wrong through go code</p></li>\n<li><p>Wrong code</p></li>\n</ul>\n\n<pre class=\"lang-golang prettyprint-override\"><code>err = gopacket.SerializeLayers(buf, h.opts,\n                    ntPkt,\n                    tPkt)                \n</code></pre>\n\n<pre class=\"lang-golang prettyprint-override\"><code>err = gopacket.SerializePacket(buf, h.opts, pkt)                \n</code></pre>\n"}], "owner": {"reputation": 508, "user_id": 769189, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/20f35ed0d0a9754007d680d997307500?s=128&d=identicon&r=PG", "display_name": "amd", "link": "https://stackoverflow.com/users/769189/amd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 445, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1548230048, "creation_date": 1548073826, "question_id": 54290037, "link": "https://stackoverflow.com/questions/54290037/not-able-to-forward-traffic-from-tun-interface-to-lo", "title": "Not able to forward traffic from `tun` interface to `lo`", "body": "<blockquote>\n  <p>Originally asked here: <a href=\"https://networkengineering.stackexchange.com/questions/56278/not-able-to-forward-traffic-from-tun-interface-to-lo\">https://networkengineering.stackexchange.com/questions/56278/not-able-to-forward-traffic-from-tun-interface-to-lo</a></p>\n</blockquote>\n\n<p>I am writing a small VPN server, in which for a certain ip address, I am passing the traffic through an <code>http proxy</code>. </p>\n\n<h2>Current Setup</h2>\n\n<ul>\n<li>TUN interface is up and running at 10.0.2.0/24</li>\n</ul>\n\n<h3>iptables configuration</h3>\n\n<ul>\n<li><code>iptables -A FORWARD -i tun0 -o eth0 -j ACCEPT</code> </li>\n<li><code>iptables -t nat -A POSTROUTING -j MASQUERADE</code></li>\n</ul>\n\n<h2>VPN logic</h2>\n\n<ul>\n<li>When I receive an IP packet destined to an address, say <code>1.2.3.4</code>, I update it's destination to <code>127.0.0.1</code> and destination port to <code>12345</code>. </li>\n<li>I recalculate the checksum for both <code>TCP</code> and <code>IP</code> layer</li>\n</ul>\n\n<h3>Code</h3>\n\n<ul>\n<li>I parse IP layer and TCP layer using <a href=\"https://github.com/google/gopacket\" rel=\"nofollow noreferrer\">gopackets</a></li>\n<li>Update the destination port and ip address</li>\n<li>Create a NAT entry in the application layer, so that I can change back the <code>source_ip</code> and <code>source_port</code> in the response packets</li>\n</ul>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// Code to receive packet from tun interface\n\n    pkt := gopacket.NewPacket(packet, layers.LayerTypeIPv4, gopacket.DecodeOptions{\n            NoCopy: true,\n            Lazy:   false,\n        })\n        if ntPkt := pkt.NetworkLayer().(*layers.IPv4); ntPkt != nil {\n            var err error\n            if tPkt := pkt.TransportLayer().(*layers.TCP); tPkt != nil {\n                // Adding NAT entry\n                h.nLock.RLock()\n                hash := fmt.Sprintf(\"%s:%d\", waterutil.IPv4Source(packet).String(), waterutil.IPv4SourcePort(packet))\n                if _, ok := h.natTable[hash]; !ok {\n                    h.nLock.RUnlock()\n                    h.nLock.Lock()\n                    h.natTable[hash] = net.TCPAddr{IP: waterutil.IPv4Destination(packet), Port: int(waterutil.IPv4DestinationPort(packet))}\n                    h.nLock.Unlock()\n                } else {\n                    h.nLock.RUnlock()\n                }\n                buf := gopacket.NewSerializeBuffer()\n                ntPkt.DstIP = h.proxyIP\n                tPkt.DstPort = layers.TCPPort(h.proxyPort)\n                tPkt.SetNetworkLayerForChecksum(ntPkt)\n                err = gopacket.SerializeLayers(buf, h.opts,\n                    ntPkt,\n                    tPkt)\n                if err != nil {\n                    logger.E(\"Error while serializing, skipping the changes\", err)\n                    return nil\n                }\n                copy(packet, buf.Bytes())               \n            }\n        }\n\n// Code to write packet onto tun interface\n</code></pre>\n\n<h2>Expected Output</h2>\n\n<ul>\n<li>Traffic from <code>tun0</code> will be forwarded onto <code>eth0</code> (even if I don't add that iptable entry, default route will do the same thing)</li>\n<li><code>eth0</code> will be knowing the lo addresses, so will forward the packet to loopback address, and eventually to the proxy running on the localhost</li>\n</ul>\n\n<h2>Actual Output</h2>\n\n<ul>\n<li>Packets are lost in-between</li>\n<li><code>tshark -i tun0</code> shows the packets going out from <code>tun0</code> </li>\n</ul>\n\n<pre><code>2419 279.256438200     10.0.2.3 ? 127.0.0.1    TCP 60 [TCP Retransmission] 47129 ? 12345 [SYN] Seq=0 Win=65535 Len=0 MSS=1460 SACK_PERM=1 TSval=550203836 TSecr=0 WS=256\n</code></pre>\n\n<ul>\n<li>But neither <code>lo</code> or <code>eth0</code> shows the corresponding entry for --dport 12345.</li>\n</ul>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10782842, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tzksqwjx7mo/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gftxPaaRgKXTsiISxe4fPLy5u2kA/mo/photo.jpg?sz=128", "display_name": "nerd", "link": "https://stackoverflow.com/users/10782842/nerd"}, "edited": false, "score": 0, "creation_date": 1548084497, "post_id": 54289606, "comment_id": 95406638, "body": "My case is that I need to explicitly kill the process while it is running. That process has signal handlers to take care"}], "tags": [], "owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "is_accepted": false, "score": 4, "last_activity_date": 1548072268, "creation_date": 1548072268, "answer_id": 54289606, "question_id": 54289371, "link": "https://stackoverflow.com/questions/54289371/killing-process-started-through-a-golang-program/54289606#54289606", "title": "Killing process started through a golang program", "body": "<p>You need to <a href=\"https://godoc.org/os/exec#Cmd.Wait\" rel=\"nofollow noreferrer\"><code>cmd.Wait()</code></a> for it to finish.  (In Unix in general, you need to <strong>wait</strong>(2) to avoid leaking zombies.)</p>\n\n<p><code>\"os/exec\"</code> doesn't have a non-blocking variant of this (there's no equivalent to <strong>waitpid</strong>(2)) but you can wait in a goroutine:</p>\n\n<pre><code>// Start the subprocess\ncmd := exec.Command(\"sleep\", \"500\")\nerr := cmd.Start()\nif err != nil {\n        log.Fatal(err)\n}\n\n// Wait for it to finish\ndone := make(chan struct{})\ngo (func () {\n        cmd.Wait()\n        close(done)\n})()\n\n// Set a timeout\ntimeout := time.NewTimer(5 * time.Second)\n\nselect {\ncase &lt;-done:\n        fmt.Println(\"process completed\")\n        if !timeout.Stop() {\n                &lt;-timeout.C\n        }\ncase &lt;-timeout.C:\n        fmt.Println(\"deadline ran out, killing process\")\n        if err := cmd.Process.Kill(); err != nil {\n                log.Fatal(\"failed to kill process: \", err)\n        }\n        &lt;-done\n}\n</code></pre>\n\n<p>Only one branch of the <code>select</code> will fire, and each does the cleanup necessary for the other one.  In the timeout case, after the process is killed, <code>Wait()</code> should return immediately, which should signal the \"done\" channel.</p>\n"}], "owner": {"reputation": 1, "user_id": 10782842, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tzksqwjx7mo/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gftxPaaRgKXTsiISxe4fPLy5u2kA/mo/photo.jpg?sz=128", "display_name": "nerd", "link": "https://stackoverflow.com/users/10782842/nerd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 675, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1548075949, "creation_date": 1548071397, "last_edit_date": 1548075949, "question_id": 54289371, "link": "https://stackoverflow.com/questions/54289371/killing-process-started-through-a-golang-program", "title": "Killing process started through a golang program", "body": "<p>I have a daemon process running and that starts another process. To simulate it right now I have just put 'sleep'. If I kill the process, it remains as zombie. How to clean it properly. </p>\n\n<pre><code>cmd := exec.Command(\"sleep\", \"500\")\nerr := cmd.Start()\nif err != nil {\n    log.Fatal(err)\n}\nif err := cmd.Process.Kill(); err != nil {\n    log.Fatal(\"failed to kill process: \", err)\n}\ntime.Sleep(10000000 * time.Millisecond)\n</code></pre>\n\n<p><code>$ ps aux | grep sleep</code></p>\n\n<p>          37342   0.0  0.0  4276984   1040 s000  S+    5:09PM   0:00.00 grep sleep</p>\n\n<p>          37309   0.0  0.0        0      0   ??  Z     5:09PM   0:00.00 (sleep)</p>\n"}, {"tags": ["go", "ibm-cloud"], "answers": [{"tags": [], "owner": {"reputation": 2451, "user_id": 1432067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FRo8J.jpg?s=128&g=1", "display_name": "Vidyasagar Machupalli", "link": "https://stackoverflow.com/users/1432067/vidyasagar-machupalli"}, "is_accepted": true, "score": 3, "last_activity_date": 1548068970, "creation_date": 1548068970, "answer_id": 54288688, "question_id": 54287952, "link": "https://stackoverflow.com/questions/54287952/ibm-cloud-cloud-foundry-app-go-deploying-failed/54288688#54288688", "title": "IBM Cloud - Cloud Foundry App Go deploying failed", "body": "<p>Looks like the Go version you are using in your application is not a supported Cloud Foundry Go buildpack version on IBM Cloud. The same is mentioned in the build error as well. As per the documentation <a href=\"https://console.bluemix.net/docs/runtimes/go/index.html#go_runtime\" rel=\"nofollow noreferrer\">here</a>, </p>\n\n<blockquote>\n  <p>The following Go versions are available in the Go buildpack currently\n  installed in IBM Cloud:</p>\n  \n  <p>1.6.3\n  1.6.4\n  1.7.5\n  1.7.6\n  1.8.6\n  1.8.7\n  1.9.3\n  1.9.4\n  1.10 </p>\n</blockquote>\n\n<p>If your app requires a Go version that is not listed, you can use the external <a href=\"https://github.com/cloudfoundry/go-buildpack.git\" rel=\"nofollow noreferrer\">Go buildpack</a> to deploy the application.</p>\n\n<p>To check the latest supported buildpacks, you can always run this command</p>\n\n<pre><code>ibmcloud cf buildpacks\n</code></pre>\n"}], "owner": {"reputation": 563, "user_id": 9527900, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SgREz3mLa0U/AAAAAAAAAAI/AAAAAAAAA7w/L4ogGPc0rik/photo.jpg?sz=128", "display_name": "Adam Lagevik", "link": "https://stackoverflow.com/users/9527900/adam-lagevik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 572, "favorite_count": 1, "accepted_answer_id": 54288688, "answer_count": 1, "score": -1, "last_activity_date": 1548068970, "creation_date": 1548066525, "question_id": 54287952, "link": "https://stackoverflow.com/questions/54287952/ibm-cloud-cloud-foundry-app-go-deploying-failed", "title": "IBM Cloud - Cloud Foundry App Go deploying failed", "body": "<p>I am trying to start a Go Cloud Foundry App on IBM Cloud but the deploying is not working. The error states </p>\n\n<pre><code>  Unable to determine Go version to install: no match found for 1.8.3 in \n  1.6.3 1.6.4 1.7.5 1.7.6 1.8.6 1.8.7 1.9.3 1.9.4 1.10]\n</code></pre>\n\n<p>Is this something I can fix or is this something IBM Cloud needs to fix? I work at IBM so any IBM employee can contact me through our internal communication systems preferable slack.</p>\n\n<p>The full build error is </p>\n\n<pre><code>Getting app info...\nUpdating app with these attributes...\n  name:                go-logs\n  path:                /home/pipeline/452c2d32-763b-4da7-ba9a-c6447b37016c\n  disk quota:          1G\n  health check type:   port\n  instances:           1\n  memory:              128M\n  stack:               cflinuxfs2\n  routes:\n    go-logs.eu-de.mybluemix.net\n\nUpdating app [36;1mgo-logs[0m...\nMapping routes...\nComparing local files to remote cache...\nPackaging files to upload...\nUploading files...\n\n 0 B / 27.80 KiB    0.00%\n 27.80 KiB / 27.80 KiB  100.00%\n 27.80 KiB / 27.80 KiB  100.00%\n 27.80 KiB / 27.80 KiB  100.00%\n 27.80 KiB / 27.80 KiB  100.00%\n 27.80 KiB / 27.80 KiB  100.00%\n 27.80 KiB / 27.80 KiB  100.00% 1s\n\nWaiting for API to complete processing files...\n\nStaging app and tracing logs...\n   Downloading python_buildpack...\n   Downloading liberty-for-java_v3_26-20181023-1545...\n   Downloading sdk-for-nodejs_v3_25-20181219-1036...\n   Downloading swift_buildpack_v2_0_15-20180920-0051...\n   Downloading liberty-for-java...\n   Downloaded sdk-for-nodejs_v3_25-20181219-1036\n   Downloading sdk-for-nodejs...\n   Downloaded liberty-for-java_v3_26-20181023-1545\n   Downloading dotnet-core...\n   Downloaded swift_buildpack_v2_0_15-20180920-0051\n   Downloading swift_buildpack...\n   Downloaded python_buildpack\n   Downloading staticfile_buildpack...\n   Downloaded liberty-for-java\n   Downloading java_buildpack...\n   Downloaded swift_buildpack\n   Downloading ruby_buildpack...\n   Downloaded sdk-for-nodejs\n   Downloading nodejs_buildpack...\n   Downloaded dotnet-core\n   Downloading go_buildpack...\n   Downloaded staticfile_buildpack\n   Downloading liberty-for-java_v3_27-20181130-1702...\n   Downloaded java_buildpack\n   Downloading swift_buildpack_v2_0_16-20181214-0434...\n   Downloaded ruby_buildpack\n   Downloading php_buildpack...\n   Downloaded nodejs_buildpack\n   Downloading xpages_buildpack...\n   Downloaded go_buildpack\n   Downloading sdk-for-nodejs_v3_24-20181128-1339...\n   Downloaded liberty-for-java_v3_27-20181130-1702\n   Downloading binary_buildpack...\n   Downloaded swift_buildpack_v2_0_16-20181214-0434\n   Downloading dotnet-core_v2_0-20180918-1356...\n   Downloaded sdk-for-nodejs_v3_24-20181128-1339\n   Downloading dotnet-core_v2_1-20181205-1536...\n   Downloaded xpages_buildpack\n   Downloaded binary_buildpack\n   Downloaded php_buildpack\n   Downloaded dotnet-core_v2_0-20180918-1356\n   Downloaded dotnet-core_v2_1-20181205-1536\n   Cell 49d42072-0d96-446e-ae6f-b172ba8b41d3 creating container for instance f786b6b1-1abc-445b-a7fe-6bdc8c8adbcc\n   Cell 49d42072-0d96-446e-ae6f-b172ba8b41d3 successfully created container for instance f786b6b1-1abc-445b-a7fe-6bdc8c8adbcc\n   Downloading app package...\n   Downloaded app package (27.5K)\n   -----&gt; Go Buildpack version 1.8.20\n   -----&gt; Checking Godeps/Godeps.json file\n   -----&gt; Installing godep v80\n          Download [https://buildpacks.cloudfoundry.org/dependencies/godep/godep-v80-linux-x64-3b019ddc.tgz]\n   -----&gt; Installing glide v0.13.1\n          Download [https://buildpacks.cloudfoundry.org/dependencies/glide/glide-v0.13.1-linux-x64-4959fbf0.tgz]\n   -----&gt; Installing dep v0.4.1\n          Download [https://buildpacks.cloudfoundry.org/dependencies/dep/dep-v0.4.1-linux-x64-c678d9fc.tgz]\n          [31;1m**ERROR**[0m Unable to determine Go version to install: no match found for 1.8.3 in [1.6.3 1.6.4 1.7.5 1.7.6 1.8.6 1.8.7 1.9.3 1.9.4 1.10]\n   [31mFailed to compile droplet: Failed to run all supply scripts: exit status 16[0m\n   Exit status 223\nError staging application: App staging failed in the buildpack compile phase\n[31;1mFAILED[0m\n\nFinished: FAILED\n</code></pre>\n"}, {"tags": ["c++", "go", "swig", "cgo", "raknet"], "comments": [{"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1548064587, "post_id": 54287162, "comment_id": 95395510, "body": "Your declaration seems to be missing a parameter type that should have been inserted between the <code>RAK_DLL_EXPORT</code> macro and <code>*_swig_go_0</code>."}, {"owner": {"reputation": 175, "user_id": 7118025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01566c3b5d528f1eb2b76e953bdb54c1?s=128&d=identicon&r=PG&f=1", "display_name": "JonRB", "link": "https://stackoverflow.com/users/7118025/jonrb"}, "reply_to_user": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1548065020, "post_id": 54287162, "comment_id": 95395753, "body": "That line is generated by SWIG, the part of the codebase it comes from doesn&#39;t even have getters or setters.  I could manually insert a type, but I don&#39;t even know what type should go there.  I <i>think</i> that <code>RAK_DLL_EXPORT</code> is supposed to contain the type or something?"}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 1, "creation_date": 1548065110, "post_id": 54287162, "comment_id": 95395808, "body": "I\u2019m aware, but I\u2019m saying that it\u2019s not generated correctly, and to solve your problem you need to find out why that is. <code>RAK_DLL_EXPORT</code> isn\u2019t supposed to contain a type, it just contains a DLL export specification (which may be empty, as in your case)."}, {"owner": {"reputation": 175, "user_id": 7118025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01566c3b5d528f1eb2b76e953bdb54c1?s=128&d=identicon&r=PG&f=1", "display_name": "JonRB", "link": "https://stackoverflow.com/users/7118025/jonrb"}, "reply_to_user": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1548067728, "post_id": 54287162, "comment_id": 95397345, "body": "Oh, right - Do you have any idea how to figure that out?"}], "owner": {"reputation": 175, "user_id": 7118025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01566c3b5d528f1eb2b76e953bdb54c1?s=128&d=identicon&r=PG&f=1", "display_name": "JonRB", "link": "https://stackoverflow.com/users/7118025/jonrb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1548063881, "creation_date": 1548063881, "question_id": 54287162, "link": "https://stackoverflow.com/questions/54287162/c-to-golang-via-swig-getting-declared-void-error", "title": "C++ to Golang via Swig - Getting &#39;declared void&#39; error", "body": "<p>I'm trying to compile the RakNet game networking C/C++ library for use in Go.  I'm currently using <code>swig -c++ -go -cgo -intgosize 64 build.swigxx &amp;&amp; go build</code> to convert the project into a Go interface, but I'm running into the following error:</p>\n\n<pre><code>build_wrap.cxx:886:56: error: variable or field '_wrap_RakNetworkFactory_set_gorak_aae8103e4a7c6905' declared void\n void _wrap_RakNetworkFactory_set_gorak_aae8103e4a7c6905(RAK_DLL_EXPORT *_swig_go_0) {\n                                                        ^\nbuild_wrap.cxx:886:73: error: '_swig_go_0' was not declared in this scope\n void _wrap_RakNetworkFactory_set_gorak_aae8103e4a7c6905(RAK_DLL_EXPORT *_swig_go_0) {\n                                                                         ^\nbuild_wrap.cxx:2366:1: error: expected '}' at end of input\n</code></pre>\n\n<p>As far as I can tell it doesn't like the <code>RAK_DLL_EXPORT</code> being defined as empty (<code>#define RAK_DLL_EXPORT</code>), but I definitely don't know enough about what I'm doing to know if that's the case.</p>\n\n<p>This issue seems to be specifically happening to setters being created by swig, because if I remove the header file the above is happening, swig gives me more errors of a similar nature.</p>\n\n<p>The only thing vaguely approximating what I'm trying to do is <a href=\"https://github.com/rssllyn/go-raknet\" rel=\"nofollow noreferrer\">this</a>, but it looks like they're using a profoundly different version of RakNet.  A lot of the resources relating to swig, cgo, and compiling C++ into go seem to be pretty dated and I haven't found any of much use.</p>\n\n<p>Can anybody who understands these technologies better than I do help me figure this out?</p>\n"}, {"tags": ["go", "concurrency", "channel"], "comments": [{"owner": {"reputation": 572, "user_id": 2445413, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2fdeb3092b84e3480d179ed27c1be4b5?s=128&d=identicon&r=PG", "display_name": "sourabh1024", "link": "https://stackoverflow.com/users/2445413/sourabh1024"}, "edited": false, "score": 2, "creation_date": 1548063239, "post_id": 54286634, "comment_id": 95394744, "body": "you are using a unbuffered channel for path. So if you call WalkFakeDirectory it will get stuck after inserting the first file into the channel because till this point no one is listening. however, once you add run walkFakeDirectory in go routine ConvertToUpperCase listens on the channel, and keeps consuming data from channel.  hope this makes your doubt clear"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1548063243, "post_id": 54286634, "comment_id": 95394749, "body": "You need to <code>close(path)</code> once you are done with all files in WalkFakeDirectory. The whole <code>done</code> or the WaitGroup stuff is completely unnecessary."}, {"owner": {"reputation": 1832, "user_id": 336107, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6cdd807f5189949797a405d6be5708d5?s=128&d=identicon&r=PG", "display_name": "kepung", "link": "https://stackoverflow.com/users/336107/kepung"}, "reply_to_user": {"reputation": 572, "user_id": 2445413, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2fdeb3092b84e3480d179ed27c1be4b5?s=128&d=identicon&r=PG", "display_name": "sourabh1024", "link": "https://stackoverflow.com/users/2445413/sourabh1024"}, "edited": false, "score": 0, "creation_date": 1548084615, "post_id": 54286634, "comment_id": 95406695, "body": "@sourabh1024 i think you&#39;re right and provided the answers i am looking for. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": false, "score": 0, "last_activity_date": 1548080262, "creation_date": 1548080262, "answer_id": 54291866, "question_id": 54286634, "link": "https://stackoverflow.com/questions/54286634/trying-to-get-fifo-processing-pipeline-using-channel/54291866#54291866", "title": "Trying to get FIFO processing pipeline using channel", "body": "<p><a href=\"https://blog.golang.org/pipelines\" rel=\"nofollow noreferrer\">This Go blog post</a> about pipelines should have enough information to build your own. The gist of it is a code sample:</p>\n\n<pre><code>func gen(nums ...int) &lt;-chan int {\n    out := make(chan int)\n    go func() {\n        for _, n := range nums {\n            out &lt;- n\n        }\n        close(out)\n    }()\n    return out\n}\n\nfunc sq(in &lt;-chan int) &lt;-chan int {\n    out := make(chan int)\n    go func() {\n        for n := range in {\n            out &lt;- n * n\n        }\n        close(out)\n    }()\n    return out\n}\nfunc sample_pipeline() {\n    // Set up the pipeline.\n    c := gen(2, 3)\n    out := sq(c)\n    out2 := sq(out)\n\n    // Consume the output.\n    for o := range out2 {\n        fmt.Println(o)\n    }\n}\n\nfunc main() {\n    sample_pipeline()\n}\n</code></pre>\n\n<p><code>sq</code> is a pipeline stage - it takes a channel with inputs and returns a channel with outputs (squared values of inputs). <code>sample_pipeline</code> sets up a two-stage pipeline and connects a generator with two values to it.</p>\n\n<p>Note importantly how the finishing is done - each pipeline stage is a goroutine that does the pipeline stage work (wait for new data from input pipe, process it, send output). When the input pipe of each stage is done (range loop on channel stops) it closes its own channel. Closing a channel is the canonical way of signaling \"this channel is done\" in Go.</p>\n"}], "owner": {"reputation": 1832, "user_id": 336107, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6cdd807f5189949797a405d6be5708d5?s=128&d=identicon&r=PG", "display_name": "kepung", "link": "https://stackoverflow.com/users/336107/kepung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1548080262, "creation_date": 1548062133, "last_edit_date": 1548062689, "question_id": 54286634, "link": "https://stackoverflow.com/questions/54286634/trying-to-get-fifo-processing-pipeline-using-channel", "title": "Trying to get FIFO processing pipeline using channel", "body": "<p>I am trying write a sequential processing pipeline in Go using a simple fake example. It traverse a fake directory and run some conversion. So there is a string channel that is shared between them. After a function writes data,  the 2nd function reads it. </p>\n\n<p>Seems to me that it only works and works sequentially too, when i place a go keyword in front of WalkFakeDirectory function as shown in code example below (<a href=\"https://play.golang.org/p/zIvJ1Vkk7kU\" rel=\"nofollow noreferrer\">playground</a>). </p>\n\n<p>Would really appreciate if anyone can explain how this works?</p>\n\n<pre><code>package main \nimport (\n\"fmt\"\n\"strings\"\n\"sync\"\n\"time\"\n)\n\nfunc main() {\n\ndone := make(chan int)\npath := make(chan string)\n\ndefer close(done)\n\n//var wg sync.WaitGroup - Not working too\n//wg.Add(1)\n\nfmt.Println(\"walking file path\")\n\ngo WalkFakeDirectoy(done, path)\n\n//wg.Add(1)\n\nConvertToUpperCase(path, done)\n\n//wg.Wait()\n\nfmt.Println(\"done!\")\n//time.Sleep(2000) // Not working \n}\n\nfunc ConvertToUpperCase(files chan string, done chan int) {\n\n   for file := range files {\n      fmt.Println(\"converting data data\", strings.ToUpper(file))\n   }\n}\n\nfunc WalkFakeDirectoy(done chan int, path chan&lt;- string) {\n\n   func() {\n    list := []string{\"abc\", \"def\", \"fgh\", \"ijk\", \"mnn\"}\n\n    for _, file := range list {\n        fmt.Println(\"getting data\", file)\n        path &lt;- file\n        time.Sleep(3000)\n      }\n   }()\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 2, "last_activity_date": 1548060269, "creation_date": 1548060269, "answer_id": 54286136, "question_id": 54286085, "link": "https://stackoverflow.com/questions/54286085/how-to-use-go-tool-compile/54286136#54286136", "title": "How to use go tool compile?", "body": "<p>Drop the 6g (it's now known as <code>compile</code>)</p>\n\n<pre><code>go tool compile -S ./g9.go &gt; assembly.asm\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>\"\".TailRecursive STEXT size=107 args=0x18 locals=0x20\n    0x0000 00000 (g9.go:5)  TEXT    \"\".TailRecursive(SB), $32-24\n    0x0000 00000 (g9.go:5)  MOVQ    (TLS), CX\n    0x0009 00009 (g9.go:5)  CMPQ    SP, 16(CX)\n    0x000d 00013 (g9.go:5)  JLS 100\n    0x000f 00015 (g9.go:5)  SUBQ    $32, SP\n    0x0013 00019 (g9.go:5)  MOVQ    BP, 24(SP)\n    0x0018 00024 (g9.go:5)  LEAQ    24(SP), BP\n    0x001d 00029 (g9.go:5)  FUNCDATA    $0, gclocals\u00b733cdeccccebe80329f1fdbee7f5874cb(SB)\n    0x001d 00029 (g9.go:5)  FUNCDATA    $1, gclocals\u00b733cdeccccebe80329f1fdbee7f5874cb(SB)\n    0x001d 00029 (g9.go:5)  FUNCDATA    $3, gclocals\u00b733cdeccccebe80329f1fdbee7f5874cb(SB)\n    0x001d 00029 (g9.go:7)  PCDATA  $2, $0\n    0x001d 00029 (g9.go:7)  PCDATA  $0, $0\n    0x001d 00029 (g9.go:7)  MOVQ    \"\".number+40(SP), AX\n    0x0022 00034 (g9.go:7)  MOVQ    \"\".product+48(SP), CX\n    0x0027 00039 (g9.go:7)  ADDQ    AX, CX\n    0x002a 00042 (g9.go:9)  CMPQ    AX, $1\n    0x002e 00046 (g9.go:9)  JNE 63\n    0x0030 00048 (g9.go:11) MOVQ    CX, \"\".~r2+56(SP)\n    0x0035 00053 (g9.go:11) MOVQ    24(SP), BP\n    0x003a 00058 (g9.go:11) ADDQ    $32, SP\n    0x003e 00062 (g9.go:11) RET\n    ...\n</code></pre>\n"}], "owner": {"reputation": 5432, "user_id": 4723732, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77fa71fdc548472c228be40043c1bc1f?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Rublev", "link": "https://stackoverflow.com/users/4723732/richard-rublev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 54286136, "answer_count": 1, "score": 0, "last_activity_date": 1548060269, "creation_date": 1548060049, "question_id": 54286085, "link": "https://stackoverflow.com/questions/54286085/how-to-use-go-tool-compile", "title": "How to use go tool compile?", "body": "<p>Simple code <a href=\"https://www.ardanlabs.com/blog/2013/09/recursion-and-tail-calls-in-go_26.html\" rel=\"nofollow noreferrer\">recursion and tails</a></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc TailRecursive(number int, product int) int {\n\n    product = product + number\n\n    if number == 1 {\n\n        return product\n    }\n\n    return TailRecursive(number-1, product)\n}\n\nfunc main() {\n\n    answer := TailRecursive(5, 0)\n    fmt.Printf(\"Recursive: %d\\n\", answer)\n}\n</code></pre>\n\n<p>When I try tool compile</p>\n\n<pre><code>go tool compile 6g -S ./g9.go &gt; assembly.asm\n</code></pre>\n\n<p>I got this</p>\n\n<pre><code> cat assembly.asm \n6g:0:0: open 6g: no such file or directory\n</code></pre>\n\n<p>My kernel architecture</p>\n\n<pre><code>x86_64 x86_64 x86_64 GNU/Linux\n</code></pre>\n\n<p>How to use go tool compile to get the proper assembly output?</p>\n"}, {"tags": ["c", "go", "random"], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 1, "last_activity_date": 1548059570, "creation_date": 1548059570, "answer_id": 54285972, "question_id": 54285910, "link": "https://stackoverflow.com/questions/54285910/does-golang-rand-use-libc-rand/54285972#54285972", "title": "Does golang rand() use libc rand()", "body": "<blockquote>\n  <p>Does golang rand() use libc rand() </p>\n</blockquote>\n\n<p>No.</p>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 6616405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca74e4500b56072d0560a7d0db45a16e?s=128&d=identicon&r=PG&f=1", "display_name": "Zhao Shengwei", "link": "https://stackoverflow.com/users/6616405/zhao-shengwei"}, "edited": false, "score": 0, "creation_date": 1548060323, "post_id": 54286001, "comment_id": 95393335, "body": "thanks,It seems that i need to use cgo in my go code"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 55, "user_id": 6616405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca74e4500b56072d0560a7d0db45a16e?s=128&d=identicon&r=PG&f=1", "display_name": "Zhao Shengwei", "link": "https://stackoverflow.com/users/6616405/zhao-shengwei"}, "edited": false, "score": 0, "creation_date": 1548060372, "post_id": 54286001, "comment_id": 95393361, "body": "If it&#39;s important that you generate random numbers with libc, yes. But I can&#39;t imagine why that would be important. :)"}, {"owner": {"reputation": 55, "user_id": 6616405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca74e4500b56072d0560a7d0db45a16e?s=128&d=identicon&r=PG&f=1", "display_name": "Zhao Shengwei", "link": "https://stackoverflow.com/users/6616405/zhao-shengwei"}, "edited": false, "score": 0, "creation_date": 1548062825, "post_id": 54286001, "comment_id": 95394509, "body": "beacase I am using golang to rebuild some php code. php code uses srand() and rand() to do some math calculation,i need to ensure get same result in golang code."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 55, "user_id": 6616405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca74e4500b56072d0560a7d0db45a16e?s=128&d=identicon&r=PG&f=1", "display_name": "Zhao Shengwei", "link": "https://stackoverflow.com/users/6616405/zhao-shengwei"}, "edited": false, "score": 1, "creation_date": 1548063075, "post_id": 54286001, "comment_id": 95394647, "body": "Then you should write your own implementation that matches your expectation--no need to use CGO."}, {"owner": {"reputation": 55, "user_id": 6616405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca74e4500b56072d0560a7d0db45a16e?s=128&d=identicon&r=PG&f=1", "display_name": "Zhao Shengwei", "link": "https://stackoverflow.com/users/6616405/zhao-shengwei"}, "edited": false, "score": 0, "creation_date": 1548067677, "post_id": 54286001, "comment_id": 95397327, "body": "of course. now, I am trying to use golang to implement libc rand() ."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 4, "last_activity_date": 1548059720, "creation_date": 1548059720, "answer_id": 54286001, "question_id": 54285910, "link": "https://stackoverflow.com/questions/54285910/does-golang-rand-use-libc-rand/54286001#54286001", "title": "Does golang rand() use libc rand()", "body": "<p>No, the <a href=\"https://golang.org/pkg/math/rand/\" rel=\"nofollow noreferrer\">rand</a> package doesn't use the C standard library at all, which you can tell by looking at each source file to see that it doesn't use CGO.</p>\n\n<ul>\n<li><p><a href=\"https://golang.org/src/math/rand/exp.go\" rel=\"nofollow noreferrer\">exp.go</a>:</p>\n\n<pre><code>import (\n    \"math\"\n)\n</code></pre></li>\n<li><p><a href=\"https://golang.org/src/math/rand/normal.go\" rel=\"nofollow noreferrer\">normal.go</a></p>\n\n<pre><code>import (\n    \"math\"\n)\n</code></pre></li>\n<li><p><a href=\"https://golang.org/src/math/rand/rand.go\" rel=\"nofollow noreferrer\">rand.go</a></p>\n\n<pre><code>import \"sync\"\n</code></pre></li>\n<li><p><a href=\"https://golang.org/src/math/rand/rng.go\" rel=\"nofollow noreferrer\">rng.go</a></p>\n\n<p>No imports</p></li>\n<li><p><a href=\"https://golang.org/src/math/rand/zipf.go\" rel=\"nofollow noreferrer\">zipf.go</a>:</p>\n\n<pre><code>import \"math\"\n</code></pre></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 3, "last_activity_date": 1548060698, "creation_date": 1548060698, "answer_id": 54286248, "question_id": 54285910, "link": "https://stackoverflow.com/questions/54285910/does-golang-rand-use-libc-rand/54286248#54286248", "title": "Does golang rand() use libc rand()", "body": "<p>The C standard imposes limited requirements on the behaviour of <code>rand()</code> - what you typically get is a linear congruential generator with a reasonable periodicity (related to <code>RAND_MAX</code>) and <code>srand</code> allows you to <em>seed</em> that generator.</p>\n\n<p>So there's no reason why it would return the same series as another linear congruential generator or otherwise, even with the same starting seed.</p>\n\n<p>If you want your inter-language generators to match, then you might want to roll your own.</p>\n"}, {"comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1548157335, "post_id": 54303810, "comment_id": 95434681, "body": "One serious problem with this code is that its memory usage grows each time <code>myrand</code> is called. You should be using a circular buffer of size 32 for <code>r</code>. The go stdlib rand uses a similar (not identical) algorithm, which you could copy: <a href=\"https://golang.org/src/math/rand/rng.go\" rel=\"nofollow noreferrer\">golang.org/src/math/rand/rng.go</a>"}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1548157531, "post_id": 54303810, "comment_id": 95434775, "body": "Also, I think (but am not 100% sure) that it gives different results depending on whether <code>int</code> is 32 or 64 bits. You should probably use <code>int32</code> or <code>int64</code> for elements of <code>r</code>."}], "tags": [], "owner": {"reputation": 55, "user_id": 6616405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca74e4500b56072d0560a7d0db45a16e?s=128&d=identicon&r=PG&f=1", "display_name": "Zhao Shengwei", "link": "https://stackoverflow.com/users/6616405/zhao-shengwei"}, "is_accepted": false, "score": 1, "last_activity_date": 1548144636, "creation_date": 1548144636, "answer_id": 54303810, "question_id": 54285910, "link": "https://stackoverflow.com/questions/54285910/does-golang-rand-use-libc-rand/54303810#54303810", "title": "Does golang rand() use libc rand()", "body": "<p>I have implemented function rand and srand by golang.\nIt can get same result compared to PHP/C.</p>\n\n<pre><code>package fcrypt\n\nvar index int\nvar r []int\n\nfunc mysrand(seed int) {\n    r = append(r, seed)\n    for i := 1; i &lt; 31; i++ {\n        r = append(r, (16807*r[i-1])%2147483647)\n        if r[i] &lt; 0 {\n            r[i] = r[i] + 2147483647\n        }\n    }\n    for i := 31; i &lt; 34; i++ {\n        r = append(r, r[i-31])\n    }\n    for i := 34; i &lt; 344; i++ {\n        r = append(r, r[i-31]+r[i-3])\n    }\n}\nfunc myrand() uint32 {\n    i := 344 + index\n    r = append(r, r[i-31]+r[i-3])\n    index = index + 1\n    return uint32(r[i]) &gt;&gt; 1\n}\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 6616405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca74e4500b56072d0560a7d0db45a16e?s=128&d=identicon&r=PG&f=1", "display_name": "Zhao Shengwei", "link": "https://stackoverflow.com/users/6616405/zhao-shengwei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 54286001, "answer_count": 4, "score": -2, "last_activity_date": 1548144636, "creation_date": 1548059272, "question_id": 54285910, "link": "https://stackoverflow.com/questions/54285910/does-golang-rand-use-libc-rand", "title": "Does golang rand() use libc rand()", "body": "<p>I use same seed in golang and C,but get different rand number\nI know php use libc rand(),how about golang?</p>\n\n<pre><code>//golang:\nrand.Seed(12345); \nrand.Uint32();\n\n//C:\nsrand(12345); \nrand();\n</code></pre>\n"}, {"tags": ["go", "google-cloud-storage"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1548079102, "post_id": 54285680, "comment_id": 95403555, "body": "You will need to need to replace the credentials. Start reading <a href=\"https://godoc.org/cloud.google.com/go#hdr-Authentication_and_Authorization\" rel=\"nofollow noreferrer\">here</a> to find out how credentials are supplied to the Google Cloud APIs."}, {"owner": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "edited": false, "score": 0, "creation_date": 1548148351, "post_id": 54285680, "comment_id": 95429348, "body": "Your error message is an OAuth error message. How are you logging in to access Cloud Storage? Is this a Google Account (like you would use for Gmail) or a Service Account? If a Service Account, create new service account credentials in the Google Cloud Console (IAM -&gt; Service Accounts), assign rights to the storage bucket and then use the new service account credentials."}, {"owner": {"reputation": 29, "user_id": 9451782, "user_type": "registered", "profile_image": "https://graph.facebook.com/1963254207037202/picture?type=large", "display_name": "Michael Chandra Lrc", "link": "https://stackoverflow.com/users/9451782/michael-chandra-lrc"}, "reply_to_user": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "edited": false, "score": 0, "creation_date": 1548168477, "post_id": 54285680, "comment_id": 95441367, "body": "@JohnHanley My prediction it was a credentials that used from gmail account for my company and it has been deactived. Looks like i dont have any option to rebuild the program and uses new credentials using Service Account. Fyi: i dont have the code, it was just running a golang program from local to gcs and receive it from gcs using &#39;gsutil cp&#39;"}, {"owner": {"reputation": 534, "user_id": 6192935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-WzVJWA1aLts/AAAAAAAAAAI/AAAAAAAABfQ/FxZhI2PBCBA/photo.jpg?sz=128", "display_name": "Manish Champaneri", "link": "https://stackoverflow.com/users/6192935/manish-champaneri"}, "edited": false, "score": 0, "creation_date": 1548321530, "post_id": 54285680, "comment_id": 95501920, "body": "Oauth requires json file of cred to work. Find for GOOGLE_APPLICATION_CREDENTIALS in you enviroment variable. It will be pointing to the location of credentials file used by appliaction. Just replace file there with another credntial having same rights ( permissions ) for gcp"}], "owner": {"reputation": 29, "user_id": 9451782, "user_type": "registered", "profile_image": "https://graph.facebook.com/1963254207037202/picture?type=large", "display_name": "Michael Chandra Lrc", "link": "https://stackoverflow.com/users/9451782/michael-chandra-lrc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548058152, "creation_date": 1548058152, "question_id": 54285680, "link": "https://stackoverflow.com/questions/54285680/change-credentials-on-gcloud-api-storage-manually-due-to-account-used-is-deleted", "title": "Change credentials on GCloud API Storage manually due to account used is deleted", "body": "<p>i would like to ask.\nThere is a Golang instance running, which has features to upload/download to Google Cloud Storage API. Due to last developer is out and the credentials used is his, now his account is deleted.\nCan i change the credentials manually to my account?</p>\n\n<p>Sorry for bad explanation but i will try to give more details if u guys asked.</p>\n\n<p>This is the response which i get if i access Google Cloud Storage API.</p>\n\n<pre><code>message: \"Post https://www.googleapis.com/upload/storage/v1/b/psb/o?alt=json&amp;projection=full&amp;uploadType=multipart: oauth2: cannot fetch token: 400 Bad Request\u21b5Response: {\u21b5  \"error\": \"invalid_grant\",\u21b5  \"error_description\": \"Account has been deleted\"\u21b5}\"\n</code></pre>\n\n<p>status: \"500 Internal Server Error\"</p>\n"}, {"tags": ["string", "go", "replace", "removing-whitespace"], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 834, "user_id": 4596814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q7evG.jpg?s=128&g=1", "display_name": "Bhavana", "link": "https://stackoverflow.com/users/4596814/bhavana"}, "edited": false, "score": 0, "creation_date": 1548060359, "post_id": 54285884, "comment_id": 95393358, "body": "@Bhavana Added another solution using <code>strings.Map()</code>, see edited answer."}, {"owner": {"reputation": 2922, "user_id": 929981, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/66Mz4.png?s=128&g=1", "display_name": "jtepe", "link": "https://stackoverflow.com/users/929981/jtepe"}, "edited": false, "score": 0, "creation_date": 1548061811, "post_id": 54285884, "comment_id": 95394005, "body": "Why is strings.Map() more efficient than strings.Replacer? Is it, because it looks only at specific runes instead of whole substrings?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2922, "user_id": 929981, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/66Mz4.png?s=128&g=1", "display_name": "jtepe", "link": "https://stackoverflow.com/users/929981/jtepe"}, "edited": false, "score": 1, "creation_date": 1548061964, "post_id": 54285884, "comment_id": 95394081, "body": "@JonasTepe Yes, checking single <code>rune</code>s (which are just <code>int32</code> numbers) is always more efficient than checking <code>string</code>s, which is a header (length+data pointer) plus a series of bytes."}, {"owner": {"reputation": 2922, "user_id": 929981, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/66Mz4.png?s=128&g=1", "display_name": "jtepe", "link": "https://stackoverflow.com/users/929981/jtepe"}, "edited": false, "score": 0, "creation_date": 1548062478, "post_id": 54285884, "comment_id": 95394343, "body": "@icza Makes sense. Thanks for the explanation."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2922, "user_id": 929981, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/66Mz4.png?s=128&g=1", "display_name": "jtepe", "link": "https://stackoverflow.com/users/929981/jtepe"}, "edited": false, "score": 1, "creation_date": 1548064214, "post_id": 54285884, "comment_id": 95395304, "body": "@JonasTepe I added another section comparing performances, <code>strings.Replacer</code> is highly optimized and performs just as good as <code>strings.Map()</code> (due to it not having to decode and encode runes from the UTF-8 byte sequences)."}, {"owner": {"reputation": 2922, "user_id": 929981, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/66Mz4.png?s=128&g=1", "display_name": "jtepe", "link": "https://stackoverflow.com/users/929981/jtepe"}, "edited": false, "score": 0, "creation_date": 1548064918, "post_id": 54285884, "comment_id": 95395699, "body": "Seems like, both allocate, if there are matches to be replaced. For the new string to be returned."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2922, "user_id": 929981, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/66Mz4.png?s=128&g=1", "display_name": "jtepe", "link": "https://stackoverflow.com/users/929981/jtepe"}, "edited": false, "score": 1, "creation_date": 1548065022, "post_id": 54285884, "comment_id": 95395754, "body": "@JonasTepe Yes, they have to. The only case when they could avoid allocation is if the result would be a substring of the input, in which case the input could be sliced and returned. But this check is not built into them (and it&#39;s not worth the complexity)."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 13, "last_activity_date": 1548075175, "last_edit_date": 1548075175, "creation_date": 1548059158, "answer_id": 54285884, "question_id": 54285346, "link": "https://stackoverflow.com/questions/54285346/remove-null-character-from-string/54285884#54285884", "title": "remove null character from string", "body": "<p>You can remove <code>\\x00</code> runes from a string the same way you can remove any other runes:</p>\n\n<pre><code>valueStr = strings.Replace(valueStr, \"\\x00\", \"\", -1)\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>s := \"a\\x00b\"\nfmt.Printf(\"%q\\n\", s)\ns = strings.Replace(s, \"\\x00\", \"\", -1)\nfmt.Printf(\"%q\\n\", s)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/bBF5dWyQXKw\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>\"a\\x00b\"\n\"ab\"\n</code></pre>\n\n<h2>Using <code>strings.Replacer</code></h2>\n\n<p>Also note that you can substitute the multiple replaces with a single operation by using  <a href=\"https://golang.org/pkg/strings/#Replacer\" rel=\"noreferrer\"><code>strings.Replacer</code></a>, and it will also be more efficient as it only iterates over the input once (and there will be only one <code>string</code> allocated for the result, no matter how many substrings you want to replace).</p>\n\n<p>For example:</p>\n\n<pre><code>s := \" \\t\\n\\rabc\\x00\"\nfmt.Printf(\"%q\\n\", s)\n\nr := strings.NewReplacer(\" \", \"\", \"\\t\", \"\", \"\\n\", \"\", \"\\r\", \"\", \"\\x00\", \"\")\ns = r.Replace(s)\nfmt.Printf(\"%q\\n\", s)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/iX8X6Rf4qfN\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>\" \\t\\n\\rabc\\x00\"\n\"abc\"\n</code></pre>\n\n<p>Also note that it's enough to create a <code>string.Replacer</code> once, and you can store it in a (global) variable and reuse it, it is even safe to use it concurrently from multiple goroutines.</p>\n\n<h2>Using <code>strings.Map()</code></h2>\n\n<p>Also note that if you only want to replace (remove) single <code>rune</code>s and not multi-rune (or multi-byte) substrings, you can also use <a href=\"https://golang.org/pkg/strings/#Map\" rel=\"noreferrer\"><code>strings.Map()</code></a> which might be even more efficient than <code>strings.Replacer</code>.</p>\n\n<p>First define a function that tells which <code>rune</code>s to replace (or remove if you return a negative value):</p>\n\n<pre><code>func remove(r rune) rune {\n    switch r {\n    case ' ', '\\t', '\\n', '\\r', 0:\n        return -1\n    }\n    return r\n}\n</code></pre>\n\n<p>And then using it:</p>\n\n<pre><code>s := \" \\t\\n\\rabc\\x00\"\nfmt.Printf(\"%q\\n\", s)\n\ns = strings.Map(remove, s)\nfmt.Printf(\"%q\\n\", s)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/_BCdcnaszLR\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>\" \\t\\n\\rabc\\x00\"\n\"abc\"\n</code></pre>\n\n<h2>Benchmarks</h2>\n\n<p>We might think <code>strings.Map()</code> will be superior as it only have to deal with <code>rune</code>s which are just <code>int32</code> numbers, while <code>strings.Replacer</code> have to deal with <code>string</code> values which are headers (length+data pointer) plus a series of bytes.</p>\n\n<p>But we should know that <code>string</code> values are stored as UTF-8 byte sequences in memory, which means <code>strings.Map()</code> have to decode the <code>rune</code>s from the UTF-8 byte sequence (and encode the runes back to UTF-8 in the end), while <code>strings.Replacer</code> does not: it may simply look for byte sequence matches without decoding the <code>rune</code>s. And <code>strings.Replacer</code> is highly optimized to take advantage of such \"tricks\".</p>\n\n<p>So let's create a benchmark to compare them:</p>\n\n<p>We'll use these for the benchmarks:</p>\n\n<pre><code>var r = strings.NewReplacer(\" \", \"\", \"\\t\", \"\", \"\\n\", \"\", \"\\r\", \"\", \"\\x00\", \"\")\n\nfunc remove(r rune) rune {\n    switch r {\n    case ' ', '\\t', '\\n', '\\r', 0:\n        return -1\n    }\n    return r\n}\n</code></pre>\n\n<p>And we run benchmarks on different input strings:</p>\n\n<pre><code>func BenchmarkReplaces(b *testing.B) {\n    cases := []struct {\n        title string\n        input string\n    }{\n        {\n            title: \"None\",\n            input: \"abc\",\n        },\n        {\n            title: \"Normal\",\n            input: \" \\t\\n\\rabc\\x00\",\n        },\n        {\n            title: \"Long\",\n            input: \"adsfWR \\t\\rab\\nc\\x00 \\t\\n\\rabc\\x00asdfWER\\n\\r\",\n        },\n    }\n\n    for _, c := range cases {\n        b.Run(\"Replacer-\"+c.title, func(b *testing.B) {\n            for i := 0; i &lt; b.N; i++ {\n                r.Replace(c.input)\n            }\n        })\n        b.Run(\"Map-\"+c.title, func(b *testing.B) {\n            for i := 0; i &lt; b.N; i++ {\n                strings.Map(remove, c.input)\n            }\n        })\n    }\n\n}\n</code></pre>\n\n<p>And now let's see the benchmark results:</p>\n\n<pre><code>BenchmarkReplaces/Replacer-None-4    100000000   12.3 ns/op    0 B/op  0 allocs/op\nBenchmarkReplaces/Map-None-4         100000000   16.1 ns/op    0 B/op  0 allocs/op\nBenchmarkReplaces/Replacer-Normal-4  20000000    92.7 ns/op    6 B/op  2 allocs/op\nBenchmarkReplaces/Map-Normal-4       20000000    92.4 ns/op   16 B/op  2 allocs/op\nBenchmarkReplaces/Replacer-Long-4     5000000   234 ns/op     64 B/op  2 allocs/op\nBenchmarkReplaces/Map-Long-4          5000000   235 ns/op     80 B/op  2 allocs/op\n</code></pre>\n\n<p>Despite expectations, <code>string.Replacer</code> performs pretty good, just as good as <code>strings.Map()</code> due to it not having to decode and encode runes.</p>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 0, "last_activity_date": 1610466701, "creation_date": 1610466701, "answer_id": 65687338, "question_id": 54285346, "link": "https://stackoverflow.com/questions/54285346/remove-null-character-from-string/65687338#65687338", "title": "remove null character from string", "body": "<p>I dont know if this is your situation, but in my case, I was receiving <code>uint16</code>\nslices from Windows Syscalls. In that case, the data is also terminated by null\nelement. To deal with that, you can use the <code>windows</code> package:</p>\n<pre><code>package main\n\nimport (\n   &quot;fmt&quot;\n   &quot;golang.org/x/sys/windows&quot;\n)\n\nfunc main() {\n   a := []uint16{77, 97, 114, 99, 104, 0}\n   s := windows.UTF16ToString(a)\n   fmt.Printf(&quot;%q\\n&quot;, s) // &quot;March&quot;\n}\n</code></pre>\n<p><a href=\"https://pkg.go.dev/golang.org/x/sys/windows#UTF16ToString\" rel=\"nofollow noreferrer\">https://pkg.go.dev/golang.org/x/sys/windows#UTF16ToString</a></p>\n"}], "owner": {"reputation": 834, "user_id": 4596814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q7evG.jpg?s=128&g=1", "display_name": "Bhavana", "link": "https://stackoverflow.com/users/4596814/bhavana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5888, "favorite_count": 0, "accepted_answer_id": 54285884, "answer_count": 2, "score": 7, "last_activity_date": 1610466701, "creation_date": 1548056441, "last_edit_date": 1548059288, "question_id": 54285346, "link": "https://stackoverflow.com/questions/54285346/remove-null-character-from-string", "title": "remove null character from string", "body": "<p>I want to check if string is empty and parse the string in time. </p>\n\n<p>Please find the below code</p>\n\n<pre><code>valueStr = strings.Replace(string(valueStr), \" \", \"\", -1)\nvalueStr = strings.Replace(string(valueStr), \"\\t\", \"\", -1)\nvalueStr = strings.Replace(string(valueStr), \"\\n\", \"\", -1)\nvalueStr = strings.Replace(string(valueStr), \"\\r\", \"\", -1)\nvar re = regexp.MustCompile(`\\s`)\nvalueStr = re.ReplaceAllString(valueStr, \"\")\n\nif valueStr != \"\" {\n    fmt.Printf(\"-------- valueStr %c: \\n\", valueStr)         // o/p =&gt;  -------- valueStr %!c(string= ):\n    fmt.Printf(\"-------- valueStr %#v: \\n\", valueStr)        // o/p =&gt; -------- valueStr \"\\x00\":\n    fmt.Printf(\"-------- valueStr %x: \\n\", valueStr)         // o/p =&gt;  -------- valueStr 00:\n    fmt.Println(\"-------- valueStr length: \", len(valueStr)) // o/p =&gt; -------- valueStr length:  1\n\n    // considering valueStr is not empty, parse string to time\n\n    time, err := time.Parse(TIME_FORMAT, strings.TrimSpace(valueStr))\n    if err != nil {\n        fmt.Println(\"-------- Error converting time: \", err) // o/p =&gt; -------- Error converting time:  parsing time \" \" as \"15:04:05\": cannot parse \" \" as \"15\"\n        return\n    }\n} else {\n    // another code\n}\n</code></pre>\n\n<p>How to remove this empty character from string? Or check if string contains this empty character?</p>\n"}, {"tags": ["amazon-web-services", "go", "request", "mocking"], "answers": [{"comments": [{"owner": {"reputation": 7661, "user_id": 115201, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/db3538aab7917bc8a3c79957bb9b94e4?s=128&d=identicon&r=PG", "display_name": "cupakob", "link": "https://stackoverflow.com/users/115201/cupakob"}, "edited": false, "score": 0, "creation_date": 1548089015, "post_id": 54285640, "comment_id": 95409109, "body": "Thanks! That helped me enough ;)"}, {"owner": {"reputation": 351, "user_id": 3495404, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/3f6dce90b558784be81ffb3eab5ba9f0?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Hummel", "link": "https://stackoverflow.com/users/3495404/andrew-hummel"}, "reply_to_user": {"reputation": 7661, "user_id": 115201, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/db3538aab7917bc8a3c79957bb9b94e4?s=128&d=identicon&r=PG", "display_name": "cupakob", "link": "https://stackoverflow.com/users/115201/cupakob"}, "edited": false, "score": 0, "creation_date": 1596109258, "post_id": 54285640, "comment_id": 111709044, "body": "@cupakob Are you able to share how you mocked Presign from request.Request? I&#39;m having that same challenge. I mocked PutObjectRequest (which I call in my code) easily, but that then returns *request.Request and I&#39;m not sure how to mock Presign from that."}], "tags": [], "owner": {"reputation": 8470, "user_id": 538866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb67b45ca1dc2584f8e4d703d009177b?s=128&d=identicon&r=PG", "display_name": "Jonas G. Drange", "link": "https://stackoverflow.com/users/538866/jonas-g-drange"}, "is_accepted": true, "score": 4, "last_activity_date": 1548322488, "last_edit_date": 1548322488, "creation_date": 1548057965, "answer_id": 54285640, "question_id": 54285068, "link": "https://stackoverflow.com/questions/54285068/how-to-mock-request-request-in-golang/54285640#54285640", "title": "How to mock request.Request in golang", "body": "<p>This isn't directly answering your question, but it might remove the basis of the question altogether.</p>\n\n<p>A neat thing in Go, is that you are able to easily isolate your dependencies using interfaces. If your code, the part that you need to test, is using <code>Presign</code> indirectly, it is trivial to test.</p>\n\n<p>I.e. create an interface</p>\n\n<pre><code>type HigherLevelAws interface {\n    Upload(file string) error\n}\n</code></pre>\n\n<p>and use this interface in your code, along with <code>Upload</code>. Then you can easily mock this using e.g. <a href=\"https://godoc.org/github.com/stretchr/testify/mock\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/stretchr/testify/mock</a></p>\n\n<p>The actual implementation, would look something like this</p>\n\n<pre><code>type ActualAwsImpl struct {\n    aws *aws.Client\n}\n\nfunc (a *ActualAwsImpl) Upload(file string) error {\n    aws.Presign...\n}\n</code></pre>\n\n<p>This allows you to test the business part of your code, but of course, still leaves untested code in <code>ActualAwsImpl</code>. This untested code, however, may be guaranteed to work by virtue of unit and integration tests in the aws sdk itself. \nEither way, in my organization, we test this using fake aws services run in docker (e.g. <a href=\"https://github.com/gliffy/fake-s3\" rel=\"nofollow noreferrer\">https://github.com/gliffy/fake-s3</a>).</p>\n"}, {"tags": [], "owner": {"reputation": 3126, "user_id": 85010, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5a1b964e34cc2b1d3e233fa387b791b0?s=128&d=identicon&r=PG", "display_name": "fiskeben", "link": "https://stackoverflow.com/users/85010/fiskeben"}, "is_accepted": false, "score": 0, "last_activity_date": 1548663200, "creation_date": 1548663200, "answer_id": 54397836, "question_id": 54285068, "link": "https://stackoverflow.com/questions/54285068/how-to-mock-request-request-in-golang/54397836#54397836", "title": "How to mock request.Request in golang", "body": "<p>You can create an interface for the function directly, like this:</p>\n\n<pre><code>type presigner interface {\n    Presign(expire time.Duration) (string, error)\n}\n</code></pre>\n\n<p>If you implement your logic in a separate function that takes a <code>presigner</code> as a parameter like this (called <em>dependency injection</em>):</p>\n\n<pre><code>func Upload(p presigner, files string) error {\n    // ...\n    res, err := p.Presign(someduration)\n    if err != nil {\n        return err\n    }\n    // and so on\n}\n</code></pre>\n\n<p>Then it's easy to mock in your tests - just implement the <code>presigner</code> interface and have the <code>Presign</code> function return what you expect:</p>\n\n<pre><code>type presignerMock struct {}\n\nfunc (p *presignerMock) Presign(d time.Duration) (string, error) {\n    return \"yay\", nil\n}\n</code></pre>\n\n<p>To test different scenarios you can add fields to the <code>presignerMock</code> and return them in your implementation:</p>\n\n<pre><code>type presignerMock {\n    res string\n    err error\n}\n\nfunc (p *presignerMock) Presign(d time.Duration) (string, error) {\n    return p.res, p.err\n}\n</code></pre>\n"}], "owner": {"reputation": 7661, "user_id": 115201, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/db3538aab7917bc8a3c79957bb9b94e4?s=128&d=identicon&r=PG", "display_name": "cupakob", "link": "https://stackoverflow.com/users/115201/cupakob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1469, "favorite_count": 0, "accepted_answer_id": 54285640, "answer_count": 2, "score": 2, "last_activity_date": 1548663200, "creation_date": 1548055048, "last_edit_date": 1548059537, "question_id": 54285068, "link": "https://stackoverflow.com/questions/54285068/how-to-mock-request-request-in-golang", "title": "How to mock request.Request in golang", "body": "<p>I'm using <code>github.com/aws/aws-sdk-go/aws/request</code> to get presigned URLs, which I need to upload files to s3 bucket in AWS. I'm writing the test currently, for that I need to mock <code>func (r *Request) Presign(expire time.Duration)</code>. <code>request.Request</code> is a struct, not an interface, so i have no idea, how can I mock it.</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1548053097, "post_id": 54284613, "comment_id": 95390559, "body": "But if you prefer to do this own your own, don&#39;t use a regex. A simple split would be far more efficient and effective here."}], "answers": [{"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 1385, "user_id": 450781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15690d08b698329062aaeb9fe34f0540?s=128&d=identicon&r=PG", "display_name": "Predominant", "link": "https://stackoverflow.com/users/450781/predominant"}, "edited": false, "score": 0, "creation_date": 1548054344, "post_id": 54284841, "comment_id": 95391027, "body": "Why insist on doing it the hard, ineffective way? But if you truly need this done with regexp, please indicate as much in your question, so that those of us who are helping to solve your stated problem won&#39;t offer solutions you don&#39;t appreciate."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 0, "last_activity_date": 1548059105, "last_edit_date": 1548059105, "creation_date": 1548053896, "answer_id": 54284841, "question_id": 54284613, "link": "https://stackoverflow.com/questions/54284613/golang-regexp-multiple-matches-with-replaceallstring/54284841#54284841", "title": "Golang regexp multiple matches with `ReplaceAllString`", "body": "<p>Regexp is the wrong tool for this simple task, because it is slow, difficult to read, and as this question indicates, difficult to reason about. For these same reasons, regexp is the wrong tool for almost all tasks it is used for.</p>\n\n<p>In your case, all you need to do is just split on your separators: <code>-</code> and <code>+</code>:</p>\n\n<pre><code>func InspectVersionTag(tag string) {\n    var suffix string\n    for _, sep := range []string{\"-\",\"+\"} {\n        if strings.Contains(tag, sep) {\n            parts := strings.SplitN(tag, sep, 2)\n            tag, suffix = parts[0], sep+parts[1]\n            continue\n        }\n    }\n    fmt.Printf(\"Prefix: %s Suffix: %s\\n\", tag, suffix)\n}\n</code></pre>\n\n<p>See <a href=\"https://play.golang.org/p/xTFjz7diDJS\" rel=\"nofollow noreferrer\">playground link</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "is_accepted": false, "score": 2, "last_activity_date": 1548054859, "last_edit_date": 1548054859, "creation_date": 1548054272, "answer_id": 54284917, "question_id": 54284613, "link": "https://stackoverflow.com/questions/54284613/golang-regexp-multiple-matches-with-replaceallstring/54284917#54284917", "title": "Golang regexp multiple matches with `ReplaceAllString`", "body": "<p>Given your samples, it should be really easy. I wrote the following code from the top of my head. It might not even compile but you should get the idea:</p>\n\n<pre><code>func parseVersion(ver string) (prefix, suffix string) {\n    parts := strings.SplitAfter(ver, \"-\", 2)\n    if len(parts) == 1 {\n        parts = strings.SplitAfter(ver, \"+\", 2)\n    }\n    if len(parts) == 1 {\n        return ver, \"\"\n    }\n    return parts[0], parts [1]\n}\n</code></pre>\n\n<p>You should definitely list all your examples in an automatic test instead of a comment. And if the above code doesn't help, your examples aren't realistic enough.</p>\n\n<p>Here is how I have solved a similar problem. Have a look at <code>Test_MkParser_PkgbasePattern</code> and <code>Test_MkParser_Dependency</code> here:</p>\n\n<p><a href=\"https://github.com/rillig/pkglint/blob/master/mkparser_test.go\" rel=\"nofollow noreferrer\">https://github.com/rillig/pkglint/blob/master/mkparser_test.go</a></p>\n\n<p>It can easily get complicated. That's why you should write a test for each interesting case, right from the beginning.</p>\n"}], "owner": {"reputation": 1385, "user_id": 450781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15690d08b698329062aaeb9fe34f0540?s=128&d=identicon&r=PG", "display_name": "Predominant", "link": "https://stackoverflow.com/users/450781/predominant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 608, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1548059105, "creation_date": 1548052697, "last_edit_date": 1548054466, "question_id": 54284613, "link": "https://stackoverflow.com/questions/54284613/golang-regexp-multiple-matches-with-replaceallstring", "title": "Golang regexp multiple matches with `ReplaceAllString`", "body": "<p>I am trying to write some regular expressions that match and pull apart strings that look like software versions (but they aren't really, so semver parsing, for instance, won't work). I'm having some trouble matching what I am calling \"prefix\" and \"suffix\" parts of the input string.</p>\n\n<p>The output I am getting from the following is, strange..</p>\n\n<pre><code>// Sample inputs:\n// * '1.2.3-thing' (Prefix: '1.2.3', Suffix: '-thing')\n// * '1.2.3+1' (Prefix: '1.2.3', Suffix: '+1')\n// * '1.2.3' (Prefix: '1.2.3', Suffix: '')\n// * '1' (Prefix: '1', Suffix: '')\n// * '1-x' (Prefix: '1', Suffix: '-x')\n// * '1-x-x' (Prefix: '1', Suffix: '-x-x')\n// * '1.2.3-thing.1' (Prefix: '1.2.3', Suffix: '-thing.1')\n// * '1.2-thing-1' (Prefix: '1.2', Suffix: '-thing-1')\n// * 'k1.2.3-thing' (Prefix: 'k1.2.3', Suffix: '-thing')\n// * 'k-thing-x' (Prefix: 'k', Suffix: '-thing-x')\n//\nfunc InspectVersionTag(tag string) {\n    re := regexp.MustCompile(`^([^\\-]+)([\\-+].+)$`)\n    suffix := \"\"\n    if re.MatchString(tag) {\n        tag = re.ReplaceAllString(tag, `$1`)\n        suffix = re.ReplaceAllString(tag, `$2`)\n    }\n    fmt.Println(fmt.Sprintf(\"Prefix is: %s\", tag))\n    fmt.Println(fmt.Sprintf(\"Suffix is: %s\", suffix))\n}\n\n// Current sample output\n//\n// Input: 1.2.3+1\n// Prefix is: 1.2.3\n// Suffix is: 1.2.3\n</code></pre>\n"}, {"tags": ["docker", "go"], "answers": [{"tags": [], "owner": {"reputation": 3335, "user_id": 3824876, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rFDWl.png?s=128&g=1", "display_name": "vishnu narayanan", "link": "https://stackoverflow.com/users/3824876/vishnu-narayanan"}, "is_accepted": true, "score": 3, "last_activity_date": 1548048098, "creation_date": 1548048098, "answer_id": 54283876, "question_id": 54283201, "link": "https://stackoverflow.com/questions/54283201/docker-run-fails-when-importing-archive-tar-in-golang/54283876#54283876", "title": "docker run fails when importing archive/tar in golang", "body": "<p><strong><em>Why ?</em></strong></p>\n\n<p>This is because of the default <code>go build</code> behavior. The compiled binary is still looking for libraries in the system path due to dynamic linking.</p>\n\n<p>Since <code>scratch</code> is empty, the binary is not able to find the system libraries and throws an error. </p>\n\n<p><strong><em>How to solve this ?</em></strong></p>\n\n<p>Modify the build script to produce a static compiled build with all libraries built in.</p>\n\n<p><code>CGO_ENABLED=0 GOOS=linux go build -a -installsuffix cgo -o main .</code></p>\n\n<p>Use the output binary from above build for the docker container.</p>\n"}], "owner": {"reputation": 23, "user_id": 10942609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c880900cffd3b62132c1c8a209ae6a72?s=128&d=identicon&r=PG&f=1", "display_name": "Liam LeFey", "link": "https://stackoverflow.com/users/10942609/liam-lefey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 899, "favorite_count": 1, "accepted_answer_id": 54283876, "answer_count": 1, "score": 2, "last_activity_date": 1548060452, "creation_date": 1548041718, "last_edit_date": 1548060452, "question_id": 54283201, "link": "https://stackoverflow.com/questions/54283201/docker-run-fails-when-importing-archive-tar-in-golang", "title": "docker run fails when importing archive/tar in golang", "body": "<p>I'm trying to get a golang program that runs on the cmd line to run in a docker container, but importing archive/tar causes errors.</p>\n\n<p>This works:</p>\n\n<pre><code>\n    package main\n    import (\n            \"fmt\"\n    )\n    func main() {\n            fmt.Println(\"success!\")\n    }\n</code></pre>\n\n<p>producing the output:</p>\n\n<pre>\n    liam gotest $ docker run -it gotest\n    success!\n</pre>\n\n<p>This does not:</p>\n\n<pre><code>\n    package main\n    import (\n            \"archive/tar\"\n            \"fmt\"\n    )\n    var _ = tar.TypeReg\n    func main() {\n            fmt.Println(\"success!\")\n    }\n</code></pre>\n\n<p>producing the output:</p>\n\n<pre><code>\n    liam gotest $ docker run -it gotest\n    standard_init_linux.go:207: exec user process caused \"no such file or directory\"\n</code></pre>\n\n<p>This is my Dockerfile:</p>\n\n<pre><code>\n    FROM scratch\n    WORKDIR /app\n    COPY . /app\n    CMD [\"./test\"]\n</code></pre>\n\n<p>I'm running:</p>\n\n<pre>go version go1.11.4 linux/amd64\nDocker version 18.09.1, build 4c52b90\nubuntu 18.04LTS</pre>\n\n<p>I'd appreciate any suggestions.</p>\n\n<p>Solved by vishnu narayanan:</p>\n\n<p>I used</p>\n\n<pre><code>`CGO_ENABLED=0 GOOS=linux go build -a -installsuffix cgo test.go`\n</code></pre>\n\n<p>to build a static executable, and it worked.</p>\n"}, {"tags": ["macos", "debugging", "go", "stdin", "goland"], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 8704430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e348ef7b41694b6635199391d860889e?s=128&d=identicon&r=PG&f=1", "display_name": "user40176", "link": "https://stackoverflow.com/users/8704430/user40176"}, "edited": false, "score": 0, "creation_date": 1548129691, "post_id": 54284415, "comment_id": 95422296, "body": "Where can you add those flags within goland? Since I didn&#39;t see where to do that, I am just using the terminal to compile for the time being."}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "reply_to_user": {"reputation": 153, "user_id": 8704430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e348ef7b41694b6635199391d860889e?s=128&d=identicon&r=PG&f=1", "display_name": "user40176", "link": "https://stackoverflow.com/users/8704430/user40176"}, "edited": false, "score": 0, "creation_date": 1548144794, "post_id": 54284415, "comment_id": 95427381, "body": "The flags are added automatically when you compile a process for debugging purposes. However, if you use a <code>Run Configuration</code> only to compile the project but not run it, by disabling the ` Run after build ` part, then you can add the flags to the ` Go tool arguments ` section."}], "tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": true, "score": 4, "last_activity_date": 1548051614, "creation_date": 1548051614, "answer_id": 54284415, "question_id": 54282941, "link": "https://stackoverflow.com/questions/54282941/goland-doesnt-accept-stdin-while-debugging/54284415#54284415", "title": "Goland doesn&#39;t accept stdin while debugging", "body": "<p>This is a known issue, see the official <a href=\"https://youtrack.jetbrains.com/issue/GO-4264\" rel=\"nofollow noreferrer\">issue tracker report</a> for this.</p>\n\n<p>The workaround for it is to compile the application with the correct debugging flags, <code>-gcflags=\"all=-N -l\" for Go 1.10 or newer and</code> -gcflags=\"-N -l\" for Go 1.9 or older), launch the application in an OS terminal and then use the <code>Attach to process...</code> feature. You can also see the linked issue to see other possible workarounds.</p>\n"}], "owner": {"reputation": 153, "user_id": 8704430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e348ef7b41694b6635199391d860889e?s=128&d=identicon&r=PG&f=1", "display_name": "user40176", "link": "https://stackoverflow.com/users/8704430/user40176"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 565, "favorite_count": 0, "accepted_answer_id": 54284415, "answer_count": 1, "score": 0, "last_activity_date": 1548051614, "creation_date": 1548039154, "question_id": 54282941, "link": "https://stackoverflow.com/questions/54282941/goland-doesnt-accept-stdin-while-debugging", "title": "Goland doesn&#39;t accept stdin while debugging", "body": "<p>When debugging with Goland on macos, my program waits for input from stdin.</p>\n\n<p>I can type in the console and press enter, but the input is not passed to my program.</p>\n\n<p>It is just like typing in a text editor. I can type, press enter, delete everything I just did. My program gets none of this passed to it.</p>\n\n<p>I also get this behavior when debugging with dlv from the console, however, I have found discussion on how to address it in that circumstance:</p>\n\n<p><a href=\"https://github.com/go-delve/delve/issues/1274#issuecomment-406969034\" rel=\"nofollow noreferrer\">https://github.com/go-delve/delve/issues/1274#issuecomment-406969034</a></p>\n\n<p>I see a similar fix for vscode as well:</p>\n\n<p><a href=\"https://github.com/Microsoft/vscode-go/issues/219#issuecomment-192164367\" rel=\"nofollow noreferrer\">https://github.com/Microsoft/vscode-go/issues/219#issuecomment-192164367</a></p>\n\n<p>But I could not find a solution for goland.</p>\n"}, {"tags": ["go", "concurrency", "memory-model", "memory-visibility"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 4, "creation_date": 1548028158, "post_id": 54282017, "comment_id": 95385838, "body": "How about using the <a href=\"https://blog.golang.org/race-detector\" rel=\"nofollow noreferrer\">race detector</a>? It reports an error on the above program."}, {"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1548028545, "post_id": 54282017, "comment_id": 95385896, "body": "Code doesn&#39;t finish on playground <a href=\"https://play.golang.org/\" rel=\"nofollow noreferrer\">play.golang.org</a>"}, {"owner": {"reputation": 5153, "user_id": 804713, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/454ce0be068cbbf25ee685af20dc7cd6?s=128&d=identicon&r=PG", "display_name": "stephenbez", "link": "https://stackoverflow.com/users/804713/stephenbez"}, "reply_to_user": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 2, "creation_date": 1548029391, "post_id": 54282017, "comment_id": 95386024, "body": "@Uvelichitel That&#39;s because the Playground has <code>GOMAXPROCS=1</code>, so the for loop will never yield and the other goroutine won&#39;t run. This is a problem but is separate from memory visibility problems. If I set <code>GOMAXPROCS=2</code> it will return: <a href=\"https://play.golang.org/p/0uImutl7UPT\" rel=\"nofollow noreferrer\">play.golang.org/p/0uImutl7UPT</a>"}, {"owner": {"reputation": 5153, "user_id": 804713, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/454ce0be068cbbf25ee685af20dc7cd6?s=128&d=identicon&r=PG", "display_name": "stephenbez", "link": "https://stackoverflow.com/users/804713/stephenbez"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1548029781, "post_id": 54282017, "comment_id": 95386076, "body": "@ThunderCat yeah I&#39;ll be demonstrating the race detector. Some people seem to think that memory visibility issues are just a theoretical but not practical concern, and if I can demonstrate it actually happening it would be more convincing than saying it could happen.  See part on &quot;my programs have ben working for years&quot;, here: <a href=\"https://stackoverflow.com/questions/2787094/how-to-demonstrate-java-multithreading-visibility-problems\" title=\"how to demonstrate java multithreading visibility problems\">stackoverflow.com/questions/2787094/&hellip;</a>"}, {"owner": {"reputation": 74910, "user_id": 3553087, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q2cTS.gif?s=128&g=1", "display_name": "Brian Goetz", "link": "https://stackoverflow.com/users/3553087/brian-goetz"}, "edited": false, "score": 7, "creation_date": 1548033644, "post_id": 54282017, "comment_id": 95386711, "body": "One of the impediments to reliably reproducing observable reorderings is that Intel processors generally implement a stronger memory model than is required by the language.  (This is certainly true in Java.)   Which means if your systems are Linux, Windows, or Mac, you are probably already starting with one hand tied behind your back.  But your question belies a wrong way of thinking.  Yes, users want to be shown &quot;what breaks.&quot;  But such failures are generally rare probablistic events, not deterministic failures.  And said users are thinking deterministically.  Teach them to think otherwise."}, {"owner": {"reputation": 5153, "user_id": 804713, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/454ce0be068cbbf25ee685af20dc7cd6?s=128&d=identicon&r=PG", "display_name": "stephenbez", "link": "https://stackoverflow.com/users/804713/stephenbez"}, "reply_to_user": {"reputation": 74910, "user_id": 3553087, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q2cTS.gif?s=128&g=1", "display_name": "Brian Goetz", "link": "https://stackoverflow.com/users/3553087/brian-goetz"}, "edited": false, "score": 0, "creation_date": 1548035121, "post_id": 54282017, "comment_id": 95386956, "body": "@BrianGoetz Yeah I knew Intel processors would make it more difficult.  If only I could run my code on DEC Alpha.  You are right that I should focus on teaching people to think about things probabilistically instead of deterministically.  Otherwise they might think it works on my machine so it must be right.  I just wanted to say I love your &quot;Java Concurrency in Practice&quot; book and it has been a great help!"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1548049955, "post_id": 54282017, "comment_id": 95389645, "body": "&quot;Is there anything I can do to demonstrate the memory visibility issues?&quot; Not much. But ask yourself: If someone is interested in the memory model of a language then he/she is probably senior enough to know that race conditions are a 100% no go even if given a certain CPU and a certain workload the race might not manifest."}, {"owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "edited": false, "score": 0, "creation_date": 1548076803, "post_id": 54282017, "comment_id": 95402287, "body": "Recently I tried to illustrate memory issues through: diagrams, small tests to illustrate incorrect programs, race detector and <code>go vet</code> (mutex usage) detection - <a href=\"https://medium.com/dm03514-tech-blog/golang-candidates-and-contexts-a-heuristic-approach-to-race-condition-detection-e2b230e70d08\" rel=\"nofollow noreferrer\">medium.com/dm03514-tech-blog/&hellip;</a>"}], "owner": {"reputation": 5153, "user_id": 804713, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/454ce0be068cbbf25ee685af20dc7cd6?s=128&d=identicon&r=PG", "display_name": "stephenbez", "link": "https://stackoverflow.com/users/804713/stephenbez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1548077139, "creation_date": 1548027747, "question_id": 54282017, "link": "https://stackoverflow.com/questions/54282017/how-to-demonstrate-memory-visibility-problems-in-go", "title": "How to demonstrate memory visibility problems in Go?", "body": "<p>I'm giving a presentation about the <a href=\"https://golang.org/ref/mem\" rel=\"nofollow noreferrer\">Go Memory Model</a>.  The memory model says that without a happens-before relationship between a write in one goroutine, and a read in another goroutine, there is no guarantee that the reader will observe the change.</p>\n\n<p>To have a bigger impact on the audience, instead of just telling them that bad things can happen if you don't synchronize, I'd like to show them.</p>\n\n<p>When I run the below code on my machine (2017 MacBook Pro with 3.5GHz dual-core Intel Core i7), it exits successfully.</p>\n\n<p><strong>Is there anything I can do to demonstrate the memory visibility issues?</strong>  </p>\n\n<p>For example are there any specific changes to the following values I could make to demonstrate the issue:</p>\n\n<ul>\n<li>use different compiler settings</li>\n<li>use an older version of Go</li>\n<li>run on a different operating system</li>\n<li>run on different hardware (such as ARM or a machine with multiple NUMA nodes).</li>\n</ul>\n\n<p>For example in Java the flags <code>-server</code> and <code>-client</code> affect the optimizations the JVM takes and lead to visibility issues occurring.</p>\n\n<p>I'm aware that the answer may be no, and that the spec may have been written to give future maintainers more flexibility with optimization.  I'm aware I can make the code never exit by setting <code>GOMAXPROCS=1</code> but that doesn't demonstrate visibility issues.</p>\n\n<pre><code>package main\nvar a string\nvar done bool\n\nfunc setup() {\n    a = \"hello, world\"\n    done = true\n}\n\nfunc main() {\n    go setup()\n    for !done {\n    }\n    print(a)\n}\n</code></pre>\n"}, {"tags": ["javascript", "go", "webassembly"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1548080656, "post_id": 54281585, "comment_id": 95404443, "body": "You can&#39;t interact with the local filesystem within a browser for security reasons."}, {"owner": {"reputation": 1813, "user_id": 1514010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BLtSx.png?s=128&g=1", "display_name": "zakki", "link": "https://stackoverflow.com/users/1514010/zakki"}, "edited": false, "score": 0, "creation_date": 1548145289, "post_id": 54281585, "comment_id": 95427635, "body": "Maybe you need to call <code>FileReader</code> JavaScript API ( <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/File/Using_files_from_web_applications\" rel=\"nofollow noreferrer\">developer.mozilla.org/en-US/docs/Web/API/File/&hellip;</a> ) using <code>syscall&#47;js</code> <a href=\"https://blog.gopheracademy.com/advent-2018/go-in-the-browser/\" rel=\"nofollow noreferrer\">blog.gopheracademy.com/advent-2018/go-in-the-browser</a>"}, {"owner": {"reputation": 2428, "user_id": 345350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/50cb4981bbaa51b1713269a29f78d826?s=128&d=identicon&r=PG", "display_name": "donatJ", "link": "https://stackoverflow.com/users/345350/donatj"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1596848394, "post_id": 54281585, "comment_id": 111951657, "body": "@Adrian You sure can, you just have to ask the user to give you the file. There&#39;s APIs as well as just an upload input."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 2428, "user_id": 345350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/50cb4981bbaa51b1713269a29f78d826?s=128&d=identicon&r=PG", "display_name": "donatJ", "link": "https://stackoverflow.com/users/345350/donatj"}, "edited": false, "score": 0, "creation_date": 1597062916, "post_id": 54281585, "comment_id": 112002517, "body": "@donatJ that&#39;s not the same thing as interacting with the local filesystem. You can&#39;t open an arbitrary file path from JavaScript or examine a directory. The only way to access a file is if the user provides it to a file form field."}], "answers": [{"tags": [], "owner": {"reputation": 2041, "user_id": 1333724, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/acc5cea42dca926af89f94eb56fbbdbb?s=128&d=identicon&r=PG", "display_name": "maxm", "link": "https://stackoverflow.com/users/1333724/maxm"}, "is_accepted": false, "score": 2, "last_activity_date": 1548346681, "last_edit_date": 1548346681, "creation_date": 1548346369, "answer_id": 54350935, "question_id": 54281585, "link": "https://stackoverflow.com/questions/54281585/how-to-read-file-from-disk-and-pass-it-to-webassembly-using-go/54350935#54350935", "title": "How to read file from disk and pass it to WebAssembly using Go?", "body": "<p>You can't really access the filesystem in the browser. <code>wasm_exec.js</code> is used to execute Go webassembly in the browser, it mocks out some filesystem functionality, but I don't think it's very useful to you: <a href=\"https://github.com/golang/go/blob/9d23975d/misc/wasm/wasm_exec.js#L41-L73\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/9d23975d/misc/wasm/wasm_exec.js#L41-L73</a></p>\n\n<p>The file read method even returns an error by default.</p>\n\n<p>You mentioned <code>&lt;input type=\"file\"&gt;</code>. You can get bytes from an uploaded file: <a href=\"https://stackoverflow.com/questions/32556664/getting-byte-array-through-input-type-file/32556944\">Getting byte array through input type = file</a>. You could then pass those bytes to the Golang wasm runtime. </p>\n\n<p>Define a global syscall/js callback in your Go code and call it from the browser to pass the bytes down to the Go runtime.</p>\n\n<p>I would look for blogposts on how to define callbacks from within the Go runtime. Also look out for changes between go 1.11 and 1.12, the api has breaking changes. </p>\n"}], "owner": {"reputation": 382, "user_id": 1589989, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3a91af655247f0c5f6c85e6b2bc5e039?s=128&d=identicon&r=PG", "display_name": "stsdc", "link": "https://stackoverflow.com/users/1589989/stsdc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1387, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1548346681, "creation_date": 1548023383, "question_id": 54281585, "link": "https://stackoverflow.com/questions/54281585/how-to-read-file-from-disk-and-pass-it-to-webassembly-using-go", "title": "How to read file from disk and pass it to WebAssembly using Go?", "body": "<p>Specifically, how to connect <code>&lt;input type=\"file\"&gt;</code> with this function in Go?\nI know there is \"syscall/js\" package, but I didn't find any examples with file reading.</p>\n\n<pre><code>func parseCSVFile(filePath string) []LabelWithFeatures {\n    fileContent, _ := ioutil.ReadFile(filePath)\n    lines := bytes.Split(fileContent, newline)\n    numRows := len(lines)\n\n    labelsWithFeatures := make([]LabelWithFeatures, numRows-2)\n\n    for i, line := range lines {\n        // skip headers\n        if i == 0 || i == numRows-1 {\n            continue\n        }\n        labelsWithFeatures[i-1] = NewLabelWithFeatures(bytes.Split(line, comma))\n    }\n    return labelsWithFeatures\n}\n</code></pre>\n"}, {"tags": ["go", "google-cloud-platform", "google-compute-engine"], "comments": [{"owner": {"reputation": 2419, "user_id": 3667404, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m6t2T.jpg?s=128&g=1", "display_name": "Bira", "link": "https://stackoverflow.com/users/3667404/bira"}, "edited": false, "score": 0, "creation_date": 1548032411, "post_id": 54281564, "comment_id": 95386510, "body": "did u ran using an environment ?"}, {"owner": {"reputation": 31, "user_id": 10454455, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mqcGBDSQ2wI/AAAAAAAAAAI/AAAAAAAAAHQ/_Ij8Qb06G6g/photo.jpg?sz=128", "display_name": "Shihab Shahriar", "link": "https://stackoverflow.com/users/10454455/shihab-shahriar"}, "reply_to_user": {"reputation": 2419, "user_id": 3667404, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m6t2T.jpg?s=128&g=1", "display_name": "Bira", "link": "https://stackoverflow.com/users/3667404/bira"}, "edited": false, "score": 0, "creation_date": 1548041047, "post_id": 54281564, "comment_id": 95387881, "body": "You mean the VM-instance or the application?"}, {"owner": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "edited": false, "score": 0, "creation_date": 1548044320, "post_id": 54281564, "comment_id": 95388398, "body": "Were you using Google Cloud Shell?"}], "answers": [{"tags": [], "owner": {"reputation": 912, "user_id": 1912391, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/890f477cf12dd59c58e326be303f04b6?s=128&d=identicon&r=PG", "display_name": "ZAky", "link": "https://stackoverflow.com/users/1912391/zaky"}, "is_accepted": false, "score": 0, "last_activity_date": 1548041034, "creation_date": 1548041034, "answer_id": 54283134, "question_id": 54281564, "link": "https://stackoverflow.com/questions/54281564/how-to-save-a-compute-engine-vm-instance-setup-in-google-cloud-platform/54283134#54283134", "title": "How to save a compute engine VM-instance setup in Google Cloud Platform?", "body": "<p><a href=\"https://cloud.google.com/compute/docs/images/create-delete-deprecate-private-images#bundle_image\" rel=\"nofollow noreferrer\">Creating, Deleting, and Deprecating Custom Images</a></p>\n\n<blockquote>\n  <p>You can create custom images of boot disks and use these images to create new instances. This is ideal for situations where you have created and modified a persistent boot disk to a certain state and need to save that state to create new instances.</p>\n</blockquote>\n\n<p>I think you should also consider using Docker containers.</p>\n\n<p><a href=\"https://cloud.google.com/container-registry/docs/pushing-and-pulling\" rel=\"nofollow noreferrer\">Pushing and pulling images</a></p>\n\n<p><a href=\"https://cloud.google.com/compute/docs/containers/\" rel=\"nofollow noreferrer\">Container-optimized VM images</a></p>\n"}], "owner": {"reputation": 31, "user_id": 10454455, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mqcGBDSQ2wI/AAAAAAAAAAI/AAAAAAAAAHQ/_Ij8Qb06G6g/photo.jpg?sz=128", "display_name": "Shihab Shahriar", "link": "https://stackoverflow.com/users/10454455/shihab-shahriar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 294, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548041034, "creation_date": 1548023182, "question_id": 54281564, "link": "https://stackoverflow.com/questions/54281564/how-to-save-a-compute-engine-vm-instance-setup-in-google-cloud-platform", "title": "How to save a compute engine VM-instance setup in Google Cloud Platform?", "body": "<p>I have created a compute engine VM-instance in Google Cloud Platform. Then I have installed go using the standard procedure downloading it from <a href=\"https://dl.google.com/go/go1.11.4.linux-amd64.tar.gz\" rel=\"nofollow noreferrer\">https://dl.google.com/go/go1.11.4.linux-amd64.tar.gz</a>. Everything worked properly and I was able to run go application. However, after closing the instance when I reopened it, it says go is not installed. The message is following. </p>\n\n<p><code>-bash: go: command not found</code></p>\n\n<p>How can I save the instance setup?</p>\n"}, {"tags": ["go", "apache-kafka", "confluent-platform"], "answers": [{"comments": [{"owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "edited": false, "score": 0, "creation_date": 1548063760, "post_id": 54280658, "comment_id": 95395035, "body": "thanks. I know this option before. I just think it means if we post a message into non-exist topic, it will automatically create topic. I don&#39;t know that only check info of topic also creates automatically topic. I think this behavior is annoy. :D"}], "tags": [], "owner": {"reputation": 794, "user_id": 1500646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dc08a3decfb01425d436e4b3161b3ff?s=128&d=identicon&r=PG", "display_name": "klvmungai", "link": "https://stackoverflow.com/users/1500646/klvmungai"}, "is_accepted": true, "score": 5, "last_activity_date": 1548016002, "creation_date": 1548016002, "answer_id": 54280658, "question_id": 54280553, "link": "https://stackoverflow.com/questions/54280553/disable-auto-topic-creation-when-calling-getmetadata/54280658#54280658", "title": "Disable auto topic creation when calling GetMetadata", "body": "<p>To disable automatic creation of topics, you should update your broker configurations to have <code>auto.create.topics.enable</code> as <code>false</code>. Take a look at <a href=\"http://kafka.apache.org/documentation.html#brokerconfigs\" rel=\"noreferrer\">the docs</a> or this <a href=\"https://docs.hortonworks.com/HDPDocuments/HDP2/HDP-2.6.5/bk_kafka-component-guide/content/kafka-broker-settings.html\" rel=\"noreferrer\">page</a></p>\n"}], "owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 562, "favorite_count": 0, "accepted_answer_id": 54280658, "answer_count": 1, "score": 1, "last_activity_date": 1548581888, "creation_date": 1548015285, "last_edit_date": 1548581888, "question_id": 54280553, "link": "https://stackoverflow.com/questions/54280553/disable-auto-topic-creation-when-calling-getmetadata", "title": "Disable auto topic creation when calling GetMetadata", "body": "<p>I am using <a href=\"https://github.com/confluentinc/confluent-kafka-go\" rel=\"nofollow noreferrer\">confluent golang</a> for my Kafka client. I use <code>AdminClient</code> to create/delete/get topics in kafka cluster. Here is my code to initialize <code>AdminClient</code></p>\n\n<pre><code>adminClient, err := kafka.NewAdminClient(&amp;kafka.ConfigMap{\n    \"bootstrap.servers\": 127.0.0.1:9092,\n})\n</code></pre>\n\n<p>After that, I use this class to create and get all topics in kafka cluster. Here is the code for creating a topic:</p>\n\n<pre><code>ctx, cancel := context.WithCancel(context.Background())\ndefer cancel()\n\nresults, err := adminClient.CreateTopics(\n    ctx,\n    []kafka.TopicSpecification{{\n        Topic:             topic,\n        NumPartitions:     numPartitions,\n        ReplicationFactor: replicationFactor}},\n    kafka.SetAdminOperationTimeout(TimeOut),\n)\n</code></pre>\n\n<p>After that, I get again topic information:</p>\n\n<pre><code>result, err := adminClient.GetMetadata(&amp;topic, false, 1000)\n</code></pre>\n\n<p>The problem is: If I get a topic that not existed before, kafka will automatically create that topic. This is a behavior that I don't want. Please tell me how to fix this.</p>\n"}, {"tags": ["algorithm", "go", "tree", "hierarchical"], "comments": [{"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1548015233, "post_id": 54280473, "comment_id": 95382813, "body": "Welcome to SO! How large is your dataset? The naive approach is for each array, start at the root and traverse the structure, adding any missing children along the way. In the end, you&#39;ll have a full tree. But you&#39;ll be doing a lot of repeated indexing."}, {"owner": {"reputation": 11, "user_id": 10941737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82d0f61ec45a82c51b3ebe0f0d4a78ca?s=128&d=identicon&r=PG&f=1", "display_name": "sillytunes", "link": "https://stackoverflow.com/users/10941737/sillytunes"}, "reply_to_user": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1548015364, "post_id": 54280473, "comment_id": 95382857, "body": "Thanks! True. It is not too big \u2014 but I was thinking I could be smarter by exploiting the fact that the arrays are sorted."}, {"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1548015473, "post_id": 54280473, "comment_id": 95382896, "body": "You probably can, but the problem is that putting these arrays into some sort of structure like a prefix tree that can take advantage of this fact is potentially just as slow as naively building the tree directly."}], "answers": [{"tags": [], "owner": {"reputation": 851, "user_id": 4611068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e063819a4fca52b592062f7926001720?s=128&d=identicon&r=PG", "display_name": "jal", "link": "https://stackoverflow.com/users/4611068/jal"}, "is_accepted": false, "score": 1, "last_activity_date": 1548029676, "last_edit_date": 1548029676, "creation_date": 1548027756, "answer_id": 54282018, "question_id": 54280473, "link": "https://stackoverflow.com/questions/54280473/converting-an-array-of-string-arrays-to-hierarchical-structure/54282018#54282018", "title": "Converting an array of string arrays to hierarchical structure", "body": "<p>Here is a recursive solution that passes on your sample input. You didn't say much about the input and what edge cases there might be, so let me know if it fails on some input and provide the input.</p>\n\n<p>I also fixed your expected result in the test. You forgot the child of <code>F</code> node <code>G</code>. Hope this helps.</p>\n\n<pre><code>type Node struct {\n    Name     string\n    Children []Node\n}\n\nfunc Test_toNodes(t *testing.T) {\n    in := [][]string{\n        {\"A\", \"B\", \"C\"},\n        {\"A\", \"B\", \"D\"},\n        {\"A\", \"E\"},\n        {\"F\", \"G\"},\n    }\n\n    want := []Node{\n        {\n            Name: \"A\",\n            Children: []Node{\n                {\n                    Name: \"B\",\n                    Children: []Node{\n                        {\n                            Name: \"C\",\n                        },\n                        {\n                            Name: \"D\",\n                        },\n                    },\n                },\n                {\n                    Name: \"E\",\n                },\n            },\n        },\n        {\n            Name: \"F\",\n            Children: []Node{\n                {\n                    Name: \"G\",\n                },\n            },\n        },\n    }\n\n    got := toNodes(in, 0, 0, len(in))\n    if !reflect.DeepEqual(got, want) {\n        t.Fatalf(\"got %v, want %v\", got, want)\n    }\n}\n\nfunc toNodes(in [][]string, i, j, k int) []Node {\n    res := []Node{}\n\n    for m := j; m &lt; k; m++ {\n        curr := nodeAt(in, i, m)\n        next := nodeAt(in, i, m+1)\n        if next != curr {\n            children := toNodes(in, i+1, j, m+1)\n            if len(children) == 0 {\n                children = nil\n            }\n            res = append(res, Node{\n                Name:     curr,\n                Children: children,\n            })\n            j = m + 1\n        }\n    }\n\n    return res\n}\n\nfunc nodeAt(h [][]string, i, j int) string {\n    if j &gt;= len(h) || i &gt;= len(h[j]) {\n        return \"\"\n    }\n    return h[j][i]\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10941737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82d0f61ec45a82c51b3ebe0f0d4a78ca?s=128&d=identicon&r=PG&f=1", "display_name": "sillytunes", "link": "https://stackoverflow.com/users/10941737/sillytunes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1548029676, "creation_date": 1548014797, "last_edit_date": 1548015269, "question_id": 54280473, "link": "https://stackoverflow.com/questions/54280473/converting-an-array-of-string-arrays-to-hierarchical-structure", "title": "Converting an array of string arrays to hierarchical structure", "body": "<p>Imagine I have sorted arrays looking like so:</p>\n\n<pre><code>[\"A\", \"B\", \"C\"]\n[\"A\", \"B\", \"D\"]\n[\"A\", \"E\"]\n[\"F\", \"G\"]\n</code></pre>\n\n<p>Which I now want to have converted to </p>\n\n<pre><code>type Node struct {\n     NodeID string\n     Children []Node\n}\n</code></pre>\n\n<p>What I did try is to write a way to do this by recursion. </p>\n\n<p>This is my current attempt written in Go:</p>\n\n<pre><code>func Test_toNodes(t *testing.T) {\n    in := [][]string{\n        {\"A\", \"B\", \"C\"},\n        {\"A\", \"B\", \"D\"},\n        {\"A\", \"E\"},\n        {\"F\", \"G\"},\n    }\n\n    want := []Node{\n        {\n            Name: \"A\",\n            Children: []Node{\n                {\n                    Name: \"B\",\n                    Children: []Node{\n                        {\n                            Name: \"C\",\n                        },\n                        {\n                            Name: \"D\",\n                        },\n                    },\n                },\n                {\n                    Name: \"E\",\n                },\n            },\n        },\n        {\n            Name: \"F\",\n        },\n    }\n\n    got := toNodes(in)\n    if !reflect.DeepEqual(got, want) {\n        t.Fatalf(\"got %v, want %v\", got, want)\n    }\n}\n\nfunc toNodes(in [][]string) []Node {\n    var (\n        tmp [][]string\n        out []Node\n    )\n\n    for i, hierarchy := range in {\n        current := nodeAt(in, i)\n        next := nodeAt(in, i+1)\n\n        if current == next {\n            if len(hierarchy) &gt; 0 {\n                tmp = append(tmp, hierarchy[1:])\n            }\n        } else {\n            out = append(out, Node{\n                Name:     current,\n                Children: toNodes(tmp),\n            })\n        }\n    }\n\n    return out\n}\n\nfunc nodeAt(h [][]string, i int) string {\n    if i &gt; len(h)-1 {\n        return \"\"\n    }\n    v := h[i]\n    if len(v) == 0 {\n        return \"\"\n    }\n    return v[0]\n}\n</code></pre>\n\n<p>This clearly does not render the correct results, and does not handle all the edge cases \u2014 so is there a general \"algorithm\", that can be applied here?</p>\n"}, {"tags": ["go", "google-sheets-api", "google-oauth"], "comments": [{"owner": {"reputation": 717, "user_id": 10549958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99e4512e217a4ac6ce060785ece3e7a3?s=128&d=identicon&r=PG&f=1", "display_name": "Jacque", "link": "https://stackoverflow.com/users/10549958/jacque"}, "edited": false, "score": 0, "creation_date": 1548053580, "post_id": 54280274, "comment_id": 95390713, "body": "Is the account you&#39;re using to read the spreadsheet the same as the account that owns/created the spreadsheet?"}, {"owner": {"reputation": 3206, "user_id": 6093604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7f17S.jpg?s=128&g=1", "display_name": "Emixam23", "link": "https://stackoverflow.com/users/6093604/emixam23"}, "reply_to_user": {"reputation": 717, "user_id": 10549958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99e4512e217a4ac6ce060785ece3e7a3?s=128&d=identicon&r=PG&f=1", "display_name": "Jacque", "link": "https://stackoverflow.com/users/10549958/jacque"}, "edited": false, "score": 0, "creation_date": 1548053663, "post_id": 54280274, "comment_id": 95390752, "body": "Yes it\u2019s the same account, I downloaded the credentials from this account. At first, the folders were created by another account but I transferred all the ownerships to this new account and this new account created the given spreadsheet :)"}, {"owner": {"reputation": 428, "user_id": 1756591, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/AoXz4.jpg?s=128&g=1", "display_name": "Rengas", "link": "https://stackoverflow.com/users/1756591/rengas"}, "edited": false, "score": 0, "creation_date": 1589602695, "post_id": 54280274, "comment_id": 109365439, "body": "The spreadhseet need to be public if you are using API key"}], "owner": {"reputation": 3206, "user_id": 6093604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7f17S.jpg?s=128&g=1", "display_name": "Emixam23", "link": "https://stackoverflow.com/users/6093604/emixam23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 344, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1548013494, "creation_date": 1548013494, "question_id": 54280274, "link": "https://stackoverflow.com/questions/54280274/golang-google-spreadsheet-api-v4-unable-to-read-a-sheet", "title": "Golang &amp; Google Spreadsheet API V4 - Unable to read a sheet", "body": "<p>I've been following the <a href=\"https://developers.google.com/sheets/api/quickstart/go\" rel=\"nofollow noreferrer\">https://developers.google.com/sheets/api/quickstart/go</a> but I couldn't make it work. In fact, I am getting all the time this error:</p>\n\n<pre><code>2019/01/20 14:39:00 Unable to retrieve data from sheet: Get https://sheets.googleapis.com/v4/spreadsheets/[..............]?alt=json&amp;prettyPrint=false: oauth2: cannot fetch token: 401 Unauthorized\nResponse: {\n    \"error\": \"unauthorized_client\",\n    \"error_description\": \"Unauthorized\"\n}\n</code></pre>\n\n<p>I first changed the <em>spreadsheetId</em> and the <em>readRange</em> of the quickstart:</p>\n\n<pre><code>// Prints the names and majors of students in a sample spreadsheet:\n// https://docs.google.com/spreadsheets/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/edit\nspreadsheetId := \"1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms\"\nreadRange := \"Class Data!A2:E\"\nresp, err := srv.Spreadsheets.Values.Get(spreadsheetId, readRange).Do()\nif err != nil {\n    log.Fatalf(\"Unable to retrieve data from sheet: %v\", err)\n}\n\nif len(resp.Values) == 0 {\n    fmt.Println(\"No data found.\")\n} else {\n    fmt.Println(\"Name, Major:\")\n    for _, row := range resp.Values {\n    // Print columns A and E, which correspond to indices 0 and 4.\n        fmt.Printf(\"%s, %s\\n\", row[0], row[4])\n    }\n}\n</code></pre>\n\n<p>Because, since I have already implemented the Google Drive API V3, I put an id of a spreadsheet I have (and used the credentials.json of the account that created this spreadsheet)</p>\n\n<p>However, I am still getting this error, any idea why?</p>\n\n<p>Thanks for any help</p>\n"}, {"tags": ["go", "concurrency", "deadlock"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 3, "creation_date": 1548007102, "post_id": 54279262, "comment_id": 95380394, "body": "A read or write to a channel cannot race, your problem is creating the channel in another goroutine, far too late."}, {"owner": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1548008591, "post_id": 54279262, "comment_id": 95380898, "body": "Where would you suggest I create them? I put them in the New function, but then they&#39;re not close to where they&#39;re being used, and then I end up getting things like send on closed channel."}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 3, "creation_date": 1548008760, "post_id": 54279262, "comment_id": 95380953, "body": "Create them in <code>New</code>, thats where its supposed to happen. If you&#39;re getting another error then thats another problem in your code somewhere."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1548009458, "post_id": 54279262, "comment_id": 95381197, "body": "You shouldn&#39;t close ch1. You already have context cancellation as the abort condition in Read. Closing the channel is redundant and unsafe since it races against the context."}, {"owner": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1548010033, "post_id": 54279262, "comment_id": 95381329, "body": "@Peter Shouldn&#39;t you <i>always</i> close your channels?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 3, "creation_date": 1548010100, "post_id": 54279262, "comment_id": 95381348, "body": "No. You only have to close channels if something is looking for a close (such as a range loop). That&#39;s entirely your decision."}, {"owner": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "edited": false, "score": 0, "creation_date": 1548013326, "post_id": 54279262, "comment_id": 95382198, "body": "Ah. In this situation I do want to close my channels so the user can range over the channels. Trying to see how I can close the channels and stop writing to them at the same time."}, {"owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "edited": false, "score": 3, "creation_date": 1548019013, "post_id": 54279262, "comment_id": 95383889, "body": "You posted a fairly sizable code sample without much background on <i>what you are trying to accomplish</i>. What do you expect this code to do, and why?"}], "answers": [{"tags": [], "owner": {"reputation": 2422, "user_id": 2622394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d36f32e6280af5bb307cead90e3844f?s=128&d=identicon&r=PG", "display_name": "lmars", "link": "https://stackoverflow.com/users/2622394/lmars"}, "is_accepted": false, "score": 0, "last_activity_date": 1548022112, "creation_date": 1548022112, "answer_id": 54281448, "question_id": 54279262, "link": "https://stackoverflow.com/questions/54279262/avoiding-race-conditions-while-sending-to-channel/54281448#54281448", "title": "Avoiding race conditions while sending to channel?", "body": "<p>I suggest making the following changes:</p>\n\n<ul>\n<li>assign to <code>ch1</code> in <code>New</code> to avoid the race of reading and writing to <code>t.ch1</code> in multiple goroutines</li>\n<li>only close <code>ch1</code> once all the calls to <code>Write</code> have finished to avoid \"send on closed channel\" panics</li>\n<li>use a <code>sync.WaitGroup</code> to wait for all the processing goroutines to finish after writing all the values (so that the program doesn't exit before processing has finished)</li>\n</ul>\n\n<p>Bringing these changes together, here's how it would look:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"strconv\"\n    \"sync\"\n    \"time\"\n)\n\ntype T struct {\n    // ch1 receives the values to process\n    ch1 chan string\n\n    // wg is used to wait for the workers to stop\n    wg sync.WaitGroup\n}\n\nfunc New() *T {\n    t := &amp;T{\n        ch1: make(chan string),\n    }\n    go t.run(2)\n    return t\n}\n\nfunc (t *T) run(workers int) {\n    // add the workers to the WaitGroup\n    t.wg.Add(workers)\n\n    for i := 0; i &lt; workers; i++ {\n        go func() {\n            // process values from the channel until it closes\n            // and then signal to the WaitGroup that we're done\n            defer t.wg.Done()\n            for m := range t.ch1 {\n                t.process(m)\n            }\n        }()\n    }\n}\n\n// Stop is called after we're done calling Write and we want to stop the\n// processing once all values have been processed\nfunc (t *T) Stop() {\n    // close t.ch1 so that the workers know to stop processing\n    close(t.ch1)\n\n    // wait for the workers to all finish before returning\n    t.wg.Wait()\n}\n\nfunc (t *T) process(s string) {\n    log.Printf(\"processing %s\", s)\n    time.Sleep(time.Millisecond * 200)\n}\n\nfunc (t *T) Write(s string) {\n    t.ch1 &lt;- s\n}\n\nfunc main() {\n    // start the main loop\n    t := New()\n\n    // write 10 values\n    for i := 0; i &lt; 10; i++ {\n        t.Write(strconv.Itoa(i))\n    }\n\n    // stop the loop, which will wait for processing to finish before returning\n    t.Stop()\n}\n</code></pre>\n"}], "owner": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 210, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1548022112, "creation_date": 1548006821, "last_edit_date": 1548007700, "question_id": 54279262, "link": "https://stackoverflow.com/questions/54279262/avoiding-race-conditions-while-sending-to-channel", "title": "Avoiding race conditions while sending to channel?", "body": "<p>go version go1.11.2 darwin/amd64</p>\n\n<p>I have the following code sample, created for SO demo purposes:</p>\n\n<pre><code>package main\n\nimport (\n    ...\n)\n\ntype T struct {\n    ctx context.Context\n    ch1 chan string\n}\n\nfunc New(ctx context.Context) *T {\n    t := &amp;T{ctx: ctx}\n    go t.run(2)\n    return t\n\n}\n\nfunc (t *T) run(workers int) {\n    t.ch1 = make(chan string)\n    done := make(chan struct{})\n\n    go func() {\n        &lt;-t.ctx.Done()\n        close(done)\n        close(t.ch1)\n    }()\n\n    for i := 0; i &lt; workers; i++ {\n        go func() {\n            for {\n                select {\n                case &lt;-done:\n                    return\n                case m, ok := &lt;-t.ch1:\n                    if ok {\n                        t.process(done, m)\n                    }\n                }\n            }\n        }()\n    }\n}\n\nfunc (t *T) process(done &lt;-chan struct{}, s string) {\n    select {\n    case &lt;-done:\n        return\n    default:\n        log.Printf(\"processing %s\", s)\n        time.Sleep(time.Millisecond * 200)\n    }\n}\n\nfunc (t *T) Read() &lt;-chan string {\n    return t.ch1\n}\n\nfunc (t *T) Write(s string) error {\n    select {\n    case &lt;-t.ctx.Done():\n        return errors.New(\"consumer is closed today\")\n    case t.ch1 &lt;- s:\n        return nil\n    }\n}\n\nfunc main() {\n    ctx, cancel := context.WithCancel(context.Background())\n    t := New(ctx)\n\n    go func() {\n        for m := range t.Read() {\n            log.Printf(\"got %s\", m)\n        }\n        &lt;-ctx.Done()\n    }()\n\n    for i := 0; i &lt; 10; i++ {\n        t.Write(strconv.Itoa(i))\n    }\n    cancel()\n}\n</code></pre>\n\n<p>When I build and run this with the race detector, it throws the following data race:</p>\n\n<pre><code>go build -race ./test/ &amp;&amp; ./test\n==================\nWARNING: DATA RACE\nRead at 0x00c0000b6030 by goroutine 7:\n  main.main.func1()\n      /redacted/test/app.go:60 +0x42\n\nPrevious write at 0x00c0000b6030 by goroutine 6:\n  main.(*T).run()\n      /redacted/test/app.go:24 +0x6a\n\nGoroutine 7 (running) created at:\n  main.main()\n      /redacted/test/app.go:76 +0xbc\n\nGoroutine 6 (running) created at:\n  main.New()\n      /redacted/test/app.go:18 +0xcd\n  main.main()\n      /redacted/test/app.go:74 +0x86\n==================\n==================\nWARNING: DATA RACE\nRead at 0x00c0000b6030 by main goroutine:\n  main.(*T).Write()\n      /redacted/test/app.go:67 +0x8a\n  main.main()\n      /redacted/test/app.go:84 +0xdc\n\nPrevious write at 0x00c0000b6030 by goroutine 6:\n  main.(*T).run()\n      /redacted/test/app.go:24 +0x6a\n\nGoroutine 6 (running) created at:\n  main.New()\n      /redacted/test/app.go:18 +0xcd\n  main.main()\n      /redacted/test/app.go:74 +0x86\n==================\n2019/01/20 10:48:51 got 0\n2019/01/20 10:48:51 got 3\n2019/01/20 10:48:51 processing 1\n2019/01/20 10:48:51 processing 2\n2019/01/20 10:48:51 got 4\n2019/01/20 10:48:51 got 5\n2019/01/20 10:48:51 got 6\n2019/01/20 10:48:51 got 7\n2019/01/20 10:48:51 got 8\n2019/01/20 10:48:51 got 9\nFound 2 data race(s)\n</code></pre>\n\n<p>The problem I'm getting is that I can't seem to find a way to have a user input something in to a channel, without exposing any channel for writes, without a race. How would this be possible? Is there a better pattern for this that I am missing?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 6, "creation_date": 1547997360, "post_id": 54277755, "comment_id": 95377547, "body": "Go does not have inheritance. Trying to pretend it does is only going to make things difficult. Rework your solution to make use of the available methods of composition instead."}, {"owner": {"reputation": 383, "user_id": 636635, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/qFPpL.jpg?s=128&g=1", "display_name": "xsigndll", "link": "https://stackoverflow.com/users/636635/xsigndll"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1547998380, "post_id": 54277755, "comment_id": 95377865, "body": "@JimB Ok. I&#39;ll dig into it. From your perspective: Can composition solve this problem or do I need to re-think the structure completely?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1548003653, "post_id": 54277755, "comment_id": 95379448, "body": "You\u2019re trying to solve your problem with inheritance. I\u2019m sure there\u2019s alterntive ways to solve your problem (there are lots of non-OOP languages), but you\u2019re only describing your proposed solution, rather than an actual problem statement."}], "answers": [{"comments": [{"owner": {"reputation": 383, "user_id": 636635, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/qFPpL.jpg?s=128&g=1", "display_name": "xsigndll", "link": "https://stackoverflow.com/users/636635/xsigndll"}, "edited": false, "score": 1, "creation_date": 1548058610, "post_id": 54277911, "comment_id": 95392559, "body": "Ok - thank you. I think I want to go with the head through the wall when trying to use OOP in Go. But it still feels &quot;right&quot; to do it though :-)"}], "tags": [], "owner": {"reputation": 7005, "user_id": 954852, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/CkbtJ.png?s=128&g=1", "display_name": "Daniel Conde Marin", "link": "https://stackoverflow.com/users/954852/daniel-conde-marin"}, "is_accepted": false, "score": 4, "last_activity_date": 1547997683, "creation_date": 1547997683, "answer_id": 54277911, "question_id": 54277755, "link": "https://stackoverflow.com/questions/54277755/get-outer-parent-struct-name/54277911#54277911", "title": "Get outer/parent struct name", "body": "<p><code>GetStructName</code> is a method of the type <code>Parent</code> not <code>Child</code>, also Golang does not have inheritance, instead there is struct embedding (also there is interface embedding), which is sort of like inheritance, but with a key difference:</p>\n\n<blockquote>\n  <p>When we embed a type, the methods of that type become methods of the outer type, but when they are invoked the receiver of the method is the inner type, not the outer one.</p>\n</blockquote>\n\n<p>This basically means that when you call <code>GetStructName</code>, the receiver of the method is <code>Parent</code> (the inner or embedded type), and not <code>Child</code>.</p>\n\n<p>This is fundamentally different from the typical class inheritance, and it explains the behaviour you're seeing. </p>\n\n<p>It's well documented <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 383, "user_id": 636635, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/qFPpL.jpg?s=128&g=1", "display_name": "xsigndll", "link": "https://stackoverflow.com/users/636635/xsigndll"}, "edited": false, "score": 0, "creation_date": 1547998137, "post_id": 54277959, "comment_id": 95377796, "body": "That was one of my &quot;solutions&quot; as well, but this one implied writing the same method into every child over and over again. I may have to understand the concept of compostion better and see if I can rework the code towards the go-concept."}, {"owner": {"reputation": 3258, "user_id": 953125, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8f88b10fdab50cf9addcb710afe76b39?s=128&d=identicon&r=PG", "display_name": "balajeerc", "link": "https://stackoverflow.com/users/953125/balajeerc"}, "reply_to_user": {"reputation": 383, "user_id": 636635, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/qFPpL.jpg?s=128&g=1", "display_name": "xsigndll", "link": "https://stackoverflow.com/users/636635/xsigndll"}, "edited": false, "score": 0, "creation_date": 1547998452, "post_id": 54277959, "comment_id": 95377888, "body": "I added an interface to the above code to make it a bit generic so that you can now use the interface in functions that  must implement this name returning function. Nevertheless, like you said, composition would be the way to go."}], "tags": [], "owner": {"reputation": 3258, "user_id": 953125, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8f88b10fdab50cf9addcb710afe76b39?s=128&d=identicon&r=PG", "display_name": "balajeerc", "link": "https://stackoverflow.com/users/953125/balajeerc"}, "is_accepted": false, "score": -2, "last_activity_date": 1547998337, "last_edit_date": 1547998337, "creation_date": 1547998000, "answer_id": 54277959, "question_id": 54277755, "link": "https://stackoverflow.com/questions/54277755/get-outer-parent-struct-name/54277959#54277959", "title": "Get outer/parent struct name", "body": "<p>While Daniel's answer above answers the \"why\" of it, you can still \"sorta\" get the behaviour you are probably looking for via (a slightly ugly):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype NamedReturningType interface {\n    GetStructName() string\n}\n\ntype Parent struct {\n    Id uint32\n}\n\nfunc (p *Parent) GetStructName() string {\n    return reflect.TypeOf(p).Elem().Name()\n}\n\n\ntype Child struct {\n    Parent\n}\n\nfunc (c *Child) GetStructName() string {\n    return reflect.TypeOf(c).Elem().Name()\n}\n\nfunc main() {\n\n    myChild := Child{}\n    fmt.Println(myChild.GetStructName())\n\n    myParent := Parent{}\n    fmt.Println(myParent.GetStructName())\n}\n</code></pre>\n\n<p>(playground: <a href=\"https://play.golang.org/p/qEtoEulFSPy\" rel=\"nofollow noreferrer\">https://play.golang.org/p/qEtoEulFSPy</a> )</p>\n\n<p>EDIT: Added an interface that these types can implement so as to make the code more generic.</p>\n"}, {"tags": [], "owner": {"reputation": 383, "user_id": 636635, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/qFPpL.jpg?s=128&g=1", "display_name": "xsigndll", "link": "https://stackoverflow.com/users/636635/xsigndll"}, "is_accepted": false, "score": 1, "last_activity_date": 1548096209, "last_edit_date": 1548096209, "creation_date": 1548094736, "answer_id": 54295732, "question_id": 54277755, "link": "https://stackoverflow.com/questions/54277755/get-outer-parent-struct-name/54295732#54295732", "title": "Get outer/parent struct name", "body": "<p>For completeness I wanted to share my solution to it (Playground: <a href=\"https://play.golang.org/p/tUhlz_o8Z7V\" rel=\"nofollow noreferrer\">https://play.golang.org/p/tUhlz_o8Z7V</a>).</p>\n\n<p>As described in my initial question, the idea is from <a href=\"https://stackoverflow.com/questions/27918208/go-get-parent-struct\">Go - get parent struct</a> .</p>\n\n<p>It's also related to a Go2 request that I've seen here: <a href=\"https://github.com/golang/go/issues/28254\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/28254</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"reflect\"\n)\n\n// we need an interface so methods are being embedded automatically\ntype IParent interface {\n    Init(IParent)   IParent\n}\n\n// internal private fields, non-visible from the outside\ntype Parent struct {\n    _IsInitialized  bool\n    _Self           IParent\n}\n\n// init the struct, set \"_Self\" to it's caller\nfunc (p *Parent) Init(o IParent) IParent {\n    p._Self = o\n    p._IsInitialized = true\n    return o\n}\n\n// This method uses \"_Self\" to determine what it actually is\nfunc (p *Parent) GetStructName() string {\n    if !p._IsInitialized {\n        log.Fatal(\"Struct not initialized. You may call 'myVar.Init(&amp;myVar)' to initialize it.\")\n    }\n    return reflect.TypeOf(p._Self).Elem().Name()\n}\n\n// Below childs have \"Init()\" from Parent, so they implement IParent automatically\n// No need to duplicate any methods here anymore\ntype Child1 struct {\n    Parent\n}\n\ntype Child2 struct {\n    Parent\n}\n\ntype Child3 struct {\n    Parent\n}\n\ntype Child4 struct {\n    Parent\n}\n\nfunc main() {\n    myChild1 := Child1{}\n    myChild1.Init(&amp;myChild1) // Init object (set _Self on struct)\n    fmt.Println(myChild1.GetStructName()) // Gives \"Child1\"\n\n    myChild2 := Child2{}\n    myChild2.Init(&amp;myChild2) // Init object (set _Self on struct)\n    fmt.Println(myChild2.GetStructName()) // Gives \"Child2\"\n\n    myChild3 := Child3{}\n    myChild3.Init(&amp;myChild3) // Init object (set _Self on struct)\n    fmt.Println(myChild3.GetStructName()) // Gives \"Child3\"\n\n    myChild4 := Child4{}\n    fmt.Println(myChild4.GetStructName()) // Fatal error\n}\n\n// Footnotes:\n//---\n//\n//  This attempt tries to solve a go 'inheritance' problem although go is *NOT* meant to be an OOP language. It was a funny experiment still :-)\n//  License: open domain, no attribution\n//  https://www.xsigndll.com\n//\n//---\n</code></pre>\n"}], "owner": {"reputation": 383, "user_id": 636635, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/qFPpL.jpg?s=128&g=1", "display_name": "xsigndll", "link": "https://stackoverflow.com/users/636635/xsigndll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1294, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1548494682, "creation_date": 1547996775, "last_edit_date": 1548494682, "question_id": 54277755, "link": "https://stackoverflow.com/questions/54277755/get-outer-parent-struct-name", "title": "Get outer/parent struct name", "body": "<p>I'm facing a Golang begginers problem, and I don't know how to solve it correctly. Could you please help me?</p>\n\n<p><strong>Info:</strong> Even though this is against the concept of Go (not trying to be an OOP language) I'd like to discuss some solutions still.</p>\n\n<p>I'd like to know the outer/parent struct name within the receiver/child. Please have a look at the following code (playground: <a href=\"https://play.golang.org/p/h6dARJQwidS\" rel=\"nofollow noreferrer\">https://play.golang.org/p/h6dARJQwidS</a> )</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype Parent struct {\n    Id uint32\n}\n\nfunc (p *Parent) GetStructName() string {\n    return reflect.TypeOf(p).Elem().Name()\n}\n\n\ntype Child struct {\n    Parent\n}\n\n\nfunc main() {\n    myChild := Child{}\n    fmt.Println(myChild.GetStructName()) // Gives \"Parent\" instead of \"Child\". How to get \"Child\"?\n}\n</code></pre>\n\n<p>It displays \"Parent\", although the struct is a \"Child\". Can anyone tell me how to get the correct struct name? I've seen one 'solution' in another stackoverflow topic that works 'correctly' (<a href=\"https://stackoverflow.com/questions/27918208/go-get-parent-struct\">Go - get parent struct</a>), but I don't think this is a good solution.</p>\n"}, {"tags": ["ubuntu", "go", "amazon-ec2", "httpserver", "sysctl"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1547997839, "post_id": 54277565, "comment_id": 95377699, "body": "<code>unix.SOMAXCONN</code> Is a constant, it\u2019s not going to change"}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 4778488, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8303e9f203e79b97cb1b7ca4240819e9?s=128&d=identicon&r=PG&f=1", "display_name": "Joaco Terniro", "link": "https://stackoverflow.com/users/4778488/joaco-terniro"}, "edited": false, "score": 0, "creation_date": 1547999386, "post_id": 54277919, "comment_id": 95378145, "body": "When running your code, it prints the new value of somaxconn. What is interesting is that the http server performs worse than when somaxconn is on 128. Other thing is that now it throws Accept error: too many open files. Do you know if there is another variable that I have to modify in order to solve that problem? I believe that is something related with file descriptors, but not sure about it."}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "reply_to_user": {"reputation": 107, "user_id": 4778488, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8303e9f203e79b97cb1b7ca4240819e9?s=128&d=identicon&r=PG&f=1", "display_name": "Joaco Terniro", "link": "https://stackoverflow.com/users/4778488/joaco-terniro"}, "edited": false, "score": 0, "creation_date": 1547999600, "post_id": 54277919, "comment_id": 95378212, "body": "you probably need to up the number of file descriptors as well as somax.  Try seeing what fs.file-max is set to and increase that.  Read up on it too.  These parameters are set to low default for a reason, they use system resources"}, {"owner": {"reputation": 107, "user_id": 4778488, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8303e9f203e79b97cb1b7ca4240819e9?s=128&d=identicon&r=PG&f=1", "display_name": "Joaco Terniro", "link": "https://stackoverflow.com/users/4778488/joaco-terniro"}, "edited": false, "score": 0, "creation_date": 1548002775, "post_id": 54277919, "comment_id": 95379190, "body": "I already tested different values of file descriptors (first I tried with only 100.000 and then setted 1.000.000). What I noticed was that, while increasing the amount o file descriptors, the error about Accept error: too many open files disappeared, but the response time increased a lot (reaching 2 seconds on TTFB). The final throughput reduced to half of the initial throughput, CPU usage didn&#39;t increase and also happened the same with memory usage. Any other suggestion to increase go net/http go server performance? Thanks for your support."}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "reply_to_user": {"reputation": 107, "user_id": 4778488, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8303e9f203e79b97cb1b7ca4240819e9?s=128&d=identicon&r=PG&f=1", "display_name": "Joaco Terniro", "link": "https://stackoverflow.com/users/4778488/joaco-terniro"}, "edited": false, "score": 0, "creation_date": 1548015131, "post_id": 54277919, "comment_id": 95382781, "body": "increasing somaxconn probably will lead to increased response time see <a href=\"https://stackoverflow.com/questions/18073483/what-do-somaxconn-mean-in-c-socket-programming\" title=\"what do somaxconn mean in c socket programming\">stackoverflow.com/questions/18073483/&hellip;</a> for a description of what the setting actually means.  If the memory and cpu use on your server are constant and low then there is probably something you could do with the code to make it serve faster"}], "tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": true, "score": 1, "last_activity_date": 1547997739, "creation_date": 1547997739, "answer_id": 54277919, "question_id": 54277565, "link": "https://stackoverflow.com/questions/54277565/go-isnt-detecting-somaxconn-changes-from-aws-ubuntu-server/54277919#54277919", "title": "Go isn&#39;t detecting SOMAXCONN changes from aws ubuntu server", "body": "<p>I would guess that the way you are checking the SOMAX is set when go is compiled?</p>\n\n<p>Checking it in a different way by reading from /proc shows that net.core.somaxconn is altered</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"os\"\n)\n\nfunc main() {\n    filename := \"/proc/sys/net/core/somaxconn\"\n    f, err := os.Open(filename)\n    data := make([]byte, 100)\n    _, err2 := f.Read(data)\n    if err != nil || err2 != nil {\n        log.Println(err2)\n        log.Fatal(err)\n    }\n    fmt.Printf(\"SOMAXCONN: %v\", string(data))\n    log.Fatal(http.ListenAndServe(\":8888\", nil))\n}\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 4778488, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8303e9f203e79b97cb1b7ca4240819e9?s=128&d=identicon&r=PG&f=1", "display_name": "Joaco Terniro", "link": "https://stackoverflow.com/users/4778488/joaco-terniro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 0, "accepted_answer_id": 54277919, "answer_count": 1, "score": 0, "last_activity_date": 1547997739, "creation_date": 1547995337, "last_edit_date": 1547997016, "question_id": 54277565, "link": "https://stackoverflow.com/questions/54277565/go-isnt-detecting-somaxconn-changes-from-aws-ubuntu-server", "title": "Go isn&#39;t detecting SOMAXCONN changes from aws ubuntu server", "body": "<p>I'm trying to stress test my golang net/http server with <a href=\"https://k6.io\" rel=\"nofollow noreferrer\">k6</a>. When I'm using 2048 virtual users to hit my aws ubuntu server, k6 throws \"connection reset by peer\". Investigating on the internet, I found that probably the backlog queue is the problem.\nReading some stackoverflow questions, I tried to modify SOMAXCONN variable from sysctl.conf file. After modifying it from 128 to 1024, when I run my main go program:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"strings\"\n    \"golang.org/x/sys/unix\"\n)\n\nfunc main() {\n    http.HandleFunc(\"/some_path\", handler)\n\n    fmt.Println(\"SOMAXCONN:\", unix.SOMAXCONN)\n    log.Fatal(http.ListenAndServe(\":8888\", nil))\n}\n</code></pre>\n\n<p>I have the following terminal output:</p>\n\n<pre><code>SOMAXCONN: 128\n</code></pre>\n\n<p>When in fact it should print:</p>\n\n<pre><code>SOMAXCONN: 1024\n</code></pre>\n\n<p>I'd appreciate if anyone can explain me why is GOLANG detecting 128 and not 1024.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 6696, "user_id": 537980, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/DZUB4.png?s=128&g=1", "display_name": "ctrl-alt-delor", "link": "https://stackoverflow.com/users/537980/ctrl-alt-delor"}, "edited": false, "score": 0, "creation_date": 1547999983, "post_id": 54278209, "comment_id": 95378331, "body": "It looks like the mustache package is installed and working. However when I try to build the cli example, it needs another package, if I <code>go get</code> it then all is well, however I was expecting <code>go build</code> to install all needed packages. Am I wrong?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 6696, "user_id": 537980, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/DZUB4.png?s=128&g=1", "display_name": "ctrl-alt-delor", "link": "https://stackoverflow.com/users/537980/ctrl-alt-delor"}, "edited": false, "score": 0, "creation_date": 1548000128, "post_id": 54278209, "comment_id": 95378364, "body": "@ctrl-alt-delor I have edited my answer to address your question"}, {"owner": {"reputation": 6696, "user_id": 537980, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/DZUB4.png?s=128&g=1", "display_name": "ctrl-alt-delor", "link": "https://stackoverflow.com/users/537980/ctrl-alt-delor"}, "edited": false, "score": 0, "creation_date": 1548000416, "post_id": 54278209, "comment_id": 95378456, "body": "Thanks: is go modules what the mustache package will have used to install its dependencies?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 6696, "user_id": 537980, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/DZUB4.png?s=128&g=1", "display_name": "ctrl-alt-delor", "link": "https://stackoverflow.com/users/537980/ctrl-alt-delor"}, "edited": false, "score": 1, "creation_date": 1548000564, "post_id": 54278209, "comment_id": 95378505, "body": "@ctrl-alt-delor no, it is still using an older alternative (<a href=\"https://github.com/cbroglie/mustache/blob/master/cmd/mustache/Gopkg.lock\" rel=\"nofollow noreferrer\">github.com/cbroglie/mustache/blob/master/cmd/mustache/&hellip;</a>) with dep. (<a href=\"https://github.com/golang/dep\" rel=\"nofollow noreferrer\">github.com/golang/dep</a>)"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 1, "last_activity_date": 1617879493, "last_edit_date": 1617879493, "creation_date": 1547999728, "answer_id": 54278209, "question_id": 54277554, "link": "https://stackoverflow.com/questions/54277554/go-run-build-not-getting-dependencies/54278209#54278209", "title": "go run/build not getting dependencies", "body": "<p>Check first your <code>$GOPATH/bin</code> folder: a <code>go get -u github.com/cbroglie/mustache/...</code> should already have compiled and installed all relevant binaries in it.</p>\n<p>The <a href=\"https://github.com/cbroglie/mustache#installation\" rel=\"nofollow noreferrer\">README</a> mentions:</p>\n<blockquote>\n<p>To install <code>mustache.go</code>, simply run <code>go get github.com/cbroglie/mustache/...</code>.</p>\n</blockquote>\n<hr />\n<p>From the comments:</p>\n<blockquote>\n<p>It looks like the mustache package is installed and working.   However\nwhen I try to build the cli example, it needs another package, if I go\nget it then all is well, however I was expecting go build to install\nall needed packages.   Am I wrong?</p>\n</blockquote>\n<p><code>go build</code> itself won't install dependencies, so you need to go get it, or activate <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"nofollow noreferrer\">go 1.11 modules</a> and declare that dependencies in your new program modules.</p>\n"}], "owner": {"reputation": 6696, "user_id": 537980, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/DZUB4.png?s=128&g=1", "display_name": "ctrl-alt-delor", "link": "https://stackoverflow.com/users/537980/ctrl-alt-delor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4014, "favorite_count": 2, "accepted_answer_id": 54278209, "answer_count": 1, "score": 3, "last_activity_date": 1617879493, "creation_date": 1547995273, "last_edit_date": 1592644375, "question_id": 54277554, "link": "https://stackoverflow.com/questions/54277554/go-run-build-not-getting-dependencies", "title": "go run/build not getting dependencies", "body": "<p><code>go run</code> and <code>go build</code> are not <code>get</code>ing dependencies.</p>\n<p>What I did:</p>\n<ul>\n<li>I have done a go get of a package, it fetched it, and its dependencies, and build it. (all is good)</li>\n<li>I run its command-line example program. (all is good)</li>\n<li>I then created a new program based on this example, and <code>go run</code> it. (all is good)</li>\n<li>Then copied this example program, and <code>go run</code> it. ( get a dependency error ).</li>\n</ul>\n<h1>Transcript</h1>\n<pre><code>#\u21b3 go version\ngo version go1.11.4 linux/amd64\n\n#\u21b3 echo $GOPATH\n/home/????/+Files/workshops/programming/golang/gopath\n\n#\u21b3 go get -u github.com/cbroglie/mustache/...\n\n#\u21b3 cp -T $GOPATH/src/github.com/cbroglie/mustache/cmd/mustache/main.go my-mustache.go\n\n#\u21b3 go build -v my-mustache.go\nmy-mustache.go:8:2: cannot find package &quot;github.com/spf13/cobra&quot; in any of:\n    /usr/local/go/src/github.com/spf13/cobra (from $GOROOT)\n    /go/src/github.com/spf13/cobra (from $GOPATH)\n</code></pre>\n<p>I can see why it is not already installed: it was in a vendor sub-directory of the original source code. But why does it not install, when I build?</p>\n"}, {"tags": ["go", "kernel", "jupyter-notebook", "google-colaboratory"], "answers": [{"comments": [{"owner": {"reputation": 1564, "user_id": 3655841, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/b0qz3.jpg?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/3655841/ron"}, "edited": false, "score": 0, "creation_date": 1559481490, "post_id": 54277022, "comment_id": 99426801, "body": "Should I run the first section on a new notebook on my drive? Can you be more specific?"}, {"owner": {"reputation": 1564, "user_id": 3655841, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/b0qz3.jpg?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/3655841/ron"}, "edited": false, "score": 0, "creation_date": 1559481530, "post_id": 54277022, "comment_id": 99426812, "body": "And if I&#39;m sharing the notebook with others, do they need to run the first code section? or they can just run my notebook?  If they change/don&#39;t-change the code in the notebook?"}, {"owner": {"reputation": 23616, "user_id": 6729010, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TEHgb.jpg?s=128&g=1", "display_name": "korakot", "link": "https://stackoverflow.com/users/6729010/korakot"}, "reply_to_user": {"reputation": 1564, "user_id": 3655841, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/b0qz3.jpg?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/3655841/ron"}, "edited": false, "score": 1, "creation_date": 1559490702, "post_id": 54277022, "comment_id": 99428992, "body": "You can run on any python notebook, new or old. If you share it, your friend need to run the first code as well, before runing your golang notebook."}, {"owner": {"reputation": 1564, "user_id": 3655841, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/b0qz3.jpg?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/3655841/ron"}, "edited": false, "score": 0, "creation_date": 1560679616, "post_id": 54277022, "comment_id": 99809272, "body": "for some odd reason i get error on the golang syntex (even tho I marked the golang as the kernel)"}, {"owner": {"reputation": 702, "user_id": 1597592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e95be1e45ce44c35155324ac4548f5f?s=128&d=identicon&r=PG", "display_name": "Qinsi", "link": "https://stackoverflow.com/users/1597592/qinsi"}, "edited": false, "score": 1, "creation_date": 1565243096, "post_id": 54277022, "comment_id": 101292694, "body": "After run the above code. It still not work. 1. &quot;Unrecognized runtime &quot;gophernotes&quot;; defaulting to &quot;python3&quot; Notebook settings&quot; 2. &quot;AttributeError: &#39;function&#39; object has no attribute &#39;HTML&#39;&quot;"}, {"owner": {"reputation": 702, "user_id": 1597592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e95be1e45ce44c35155324ac4548f5f?s=128&d=identicon&r=PG", "display_name": "Qinsi", "link": "https://stackoverflow.com/users/1597592/qinsi"}, "edited": false, "score": 2, "creation_date": 1565244632, "post_id": 54277022, "comment_id": 101293233, "body": "10 minutes later, it works! Don&#39;t know why this delay."}], "tags": [], "owner": {"reputation": 23616, "user_id": 6729010, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TEHgb.jpg?s=128&g=1", "display_name": "korakot", "link": "https://stackoverflow.com/users/6729010/korakot"}, "is_accepted": true, "score": 5, "last_activity_date": 1590669939, "last_edit_date": 1590669939, "creation_date": 1547991611, "answer_id": 54277022, "question_id": 54277021, "link": "https://stackoverflow.com/questions/54277021/how-to-run-golang-in-google-colaboratory/54277022#54277022", "title": "How to run Golang in Google Colaboratory", "body": "<p>Use <a href=\"https://colab.research.google.com/github/vistec-AI/colab/blob/master/golang.ipynb\" rel=\"nofollow noreferrer\">this notebook</a>, which you can remember easily with the shortcut <code>bit.ly/colabgo</code>.</p>\n\n<p>Previous methods depend on having 2 notebooks, one for installation, the other for running. Now both tasks must be done in the same notebook above.</p>\n\n<p>The notebook specify <code>gophernotes</code> as the kernel. At first it cannot be found, so Colab will default to <code>python3</code>. Just run the first cell, which will install gophernotes for you.</p>\n\n<p>When the first cell finish, reload the browswer (Ctrl+R or use MENU). Colab will now find gophernotes. It can now run golang in any cell, except the first (which is python..ish).</p>\n\n<p>Here's the code of the first cell, for reference. You cannot use this in a new Python notebook, because there is no way to change kernel to <code>gophernotes</code>. You can only do that by text editor, or copying another notebook.</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>!apt install golang-go libzmq3-dev\n%env GOPATH=/root/go\n!go get -u github.com/gopherdata/gophernotes\n!cp ~/go/bin/gophernotes /usr/bin/\n!mkdir /usr/local/share/jupyter/kernels/gophernotes\n!cp ~/go/src/github.com/gopherdata/gophernotes/kernel/* \\\n       /usr/local/share/jupyter/kernels/gophernotes\n</code></pre>\n"}], "owner": {"reputation": 23616, "user_id": 6729010, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TEHgb.jpg?s=128&g=1", "display_name": "korakot", "link": "https://stackoverflow.com/users/6729010/korakot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2114, "favorite_count": 2, "accepted_answer_id": 54277022, "answer_count": 1, "score": 2, "last_activity_date": 1590669939, "creation_date": 1547991611, "question_id": 54277021, "link": "https://stackoverflow.com/questions/54277021/how-to-run-golang-in-google-colaboratory", "title": "How to run Golang in Google Colaboratory", "body": "<p>Now Google Colaboratory supports Python2 and Python3 kernels. Can I add a Golang kernel so that I can use Golang in Colab too?</p>\n\n<p>I found a few examples <a href=\"https://github.com/googlecolab/colabtools/issues/13\" rel=\"nofollow noreferrer\">here</a>, but it only has JavaScript and R, no Golang.</p>\n"}, {"tags": ["sorting", "go", "slice"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1548002391, "post_id": 54276285, "comment_id": 95379069, "body": "The less functions should compare for less, not less than or equal.  The fastest of the four tests uses sort.Slice."}, {"owner": {"reputation": 2672, "user_id": 1288818, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7CfkE.jpg?s=128&g=1", "display_name": "Oleg Butuzov", "link": "https://stackoverflow.com/users/1288818/oleg-butuzov"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1548003671, "post_id": 54276285, "comment_id": 95379450, "body": "Thank you for your answer. 1) OK (it&#39;s an accident). 2) Everything faster if you don&#39;t need to move big chunks of memory, pointer faster by default, Question was about <code>[]Structs</code>."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1547987626, "creation_date": 1547987626, "answer_id": 54276484, "question_id": 54276285, "link": "https://stackoverflow.com/questions/54276285/performance-sorting-slice-vs-sorting-type-of-slice-with-sort-implementation/54276484#54276484", "title": "Performance: Sorting Slice vs Sorting Type (of Slice) with Sort implementation", "body": "<p>The general <a href=\"https://golang.org/pkg/sort/#Slice\" rel=\"noreferrer\"><code>sort.Slice()</code></a> and <a href=\"https://golang.org/pkg/sort/#SliceStable\" rel=\"noreferrer\"><code>sort.SliceStable()</code></a> functions work on any slices. You have to pass your slice value as an <code>interface{}</code> value, and the implementation has to use reflection (the <a href=\"https://golang.org/pkg/reflect/\" rel=\"noreferrer\"><code>reflect</code></a> package) to access its elements and length, and to perform the swaps of elements.</p>\n\n<p>In contrast, when you implement the <a href=\"https://golang.org/pkg/sort/#Interface\" rel=\"noreferrer\"><code>sort.Interface</code></a> type yourself, in your implementation you have access to the static type of your slice, and you can provide the implementation of the <code>sort.Interface</code> without relfection, this is what will make it faster.</p>\n\n<p>So if performance is critical / important, always provide the <code>sort.Interface</code> implementation yourself. If the slices are small or performance is not important, you may use the more convenient <code>sort.Slice()</code> function.</p>\n"}], "owner": {"reputation": 2672, "user_id": 1288818, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7CfkE.jpg?s=128&g=1", "display_name": "Oleg Butuzov", "link": "https://stackoverflow.com/users/1288818/oleg-butuzov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1447, "favorite_count": 0, "accepted_answer_id": 54276484, "answer_count": 1, "score": 3, "last_activity_date": 1548003557, "creation_date": 1547986234, "last_edit_date": 1548003557, "question_id": 54276285, "link": "https://stackoverflow.com/questions/54276285/performance-sorting-slice-vs-sorting-type-of-slice-with-sort-implementation", "title": "Performance: Sorting Slice vs Sorting Type (of Slice) with Sort implementation", "body": "<p>I was playing with some code challenges and found that custom sort (implementation of sort interface) work much faster than just for raw structure of slices. Why is that? Does slice conversion to type do some megic (like converting to slice of pointers to structs)?</p>\n\n<p>I made some code to test my hipotesis</p>\n\n<pre><code>package sortingexample\n\nimport (\n    \"sort\"\n    \"testing\"\n)\n\n// Example of struct we going to sort.\n\ntype Point struct {\n    X, Y int\n}\n\n// --- Struct / Raw Data\nvar TestCases = []Point{\n    {10, 3},\n    {10, 4},\n    {10, 35},\n    {10, 5},\n    {10, 51},\n    {10, 25},\n    {10, 59},\n    {10, 15},\n    {10, 22},\n    {10, 91},\n}\n\n// Example One - Sorting Slice Directly\n// somehow - slowest way to sort it.\nfunc SortSlice(points []Point) {\n    sort.Slice(points, func(i, j int) bool {\n        return points[i].Y &lt; points[j].Y\n    })\n}\n\nfunc BenchmarkSlice(b *testing.B) {\n    tmp := make([]Point, len(TestCases))\n    for i := 0; i &lt; b.N; i++ {\n        copy(tmp, TestCases)\n        SortSlice(tmp)\n    }\n}\n\n// Example Two - Sorting Slice Directly\n// much faster performance\ntype Points []Point\n\n// Sort interface implementation\nfunc (p Points) Less(i, j int) bool { return p[i].Y &lt; p[j].Y }\nfunc (p Points) Len() int           { return len(p) }\nfunc (p Points) Swap(i, j int)      { p[i], p[j] = p[j], p[i] }\n\nfunc SortStruct(points []Point) {\n    sort.Sort(Points(points))\n}\n\nfunc BenchmarkStruct(b *testing.B) {\n    tmp := make([]Point, len(TestCases))\n    for i := 0; i &lt; b.N; i++ {\n        copy(tmp, TestCases)\n        SortStruct(tmp)\n    }\n}\n\n// --- Pointers\nvar TestCasesPoints = []*Point{\n    &amp;Point{10, 3},\n    &amp;Point{10, 4},\n    &amp;Point{10, 35},\n    &amp;Point{10, 5},\n    &amp;Point{10, 51},\n    &amp;Point{10, 25},\n    &amp;Point{10, 59},\n    &amp;Point{10, 15},\n    &amp;Point{10, 22},\n    &amp;Point{10, 91},\n}\n\n// Example Three - Sorting Slice of Pointers\n\nfunc SortSlicePointers(points []*Point) {\n    sort.Slice(points, func(i, j int) bool {\n        return points[i].Y &lt; points[j].Y\n    })\n}\n\nfunc BenchmarkSlicePointers(b *testing.B) {\n    tmp := make([]*Point, len(TestCasesPoints))\n    for i := 0; i &lt; b.N; i++ {\n        copy(tmp, TestCasesPoints)\n        SortSlicePointers(tmp)\n    }\n}\n\n// Example Four - Sorting Struct (with Slice of pointers beneath it)\ntype PointsPointer []*Point\n\nfunc (pp PointsPointer) Less(i, j int) bool { return pp[i].Y &lt; pp[j].Y }\nfunc (pp PointsPointer) Len() int           { return len(pp) }\nfunc (pp PointsPointer) Swap(i, j int)      { pp[i], pp[j] = pp[j], pp[i] }\n\nfunc SortStructOfSlicePointers(points []*Point) {\n    sort.Sort(PointsPointer(points))\n}\n\nfunc BenchmarkStructOfSlicePointers(b *testing.B) {\n    tmp := make([]*Point, len(TestCasesPoints))\n\n    for i := 0; i &lt; b.N; i++ {\n        copy(tmp, TestCasesPoints)\n        SortStructOfSlicePointers(tmp)\n    }\n}\n</code></pre>\n\n<p>And here are results...</p>\n\n<pre><code>&gt; go test -bench=.\ngoos: darwin\ngoarch: amd64\nBenchmarkSlice-4                     3000000           542 ns/op\nBenchmarkStruct-4                    5000000           318 ns/op\nBenchmarkSlicePointers-4             5000000           280 ns/op\nBenchmarkStructOfSlicePointers-4     5000000           321 ns/op\n</code></pre>\n\n<p>It's obvious that sorting a slice of pointers will work faster, but why does custom sort implementation faster? Are there any resources I can read about it?</p>\n"}, {"tags": ["file", "go", "io", "stdout"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3672215"}, "edited": false, "score": 0, "creation_date": 1547986512, "post_id": 54276243, "comment_id": 95374608, "body": "Oh yeah, I guess os.File would need to be a interface and not a struct for this to work"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 4, "last_activity_date": 1547986528, "last_edit_date": 1547986528, "creation_date": 1547985889, "answer_id": 54276243, "question_id": 54276178, "link": "https://stackoverflow.com/questions/54276178/golang-add-custom-os-file-to-os-stdout/54276243#54276243", "title": "Golang add custom os.File to os.Stdout", "body": "<blockquote>\n<pre><code>$ go doc os.stdout\nvar (\n  Stdin  = NewFile(uintptr(syscall.Stdin), \"/dev/stdin\")\n  Stdout = NewFile(uintptr(syscall.Stdout), \"/dev/stdout\")\n  Stderr = NewFile(uintptr(syscall.Stderr), \"/dev/stderr\")\n)\n    Stdin, Stdout, and Stderr are open Files pointing to the standard input,\n    standard output, and standard error file descriptors.\n\n    Note that the Go runtime writes to standard error for panics and crashes;\n    closing Stderr may cause those messages to go elsewhere, perhaps to a file\n    opened later.\n</code></pre>\n</blockquote>\n\n<hr>\n\n<blockquote>\n<pre><code>$ go doc os.newfile\nfunc NewFile(fd uintptr, name string) *File\n    NewFile returns a new File with the given file descriptor and name. The\n    returned value will be nil if fd is not a valid file descriptor. On Unix\n    systems, if the file descriptor is in non-blocking mode, NewFile will\n    attempt to return a pollable File (one for which the SetDeadline methods\n    work).\n</code></pre>\n</blockquote>\n\n<hr>\n\n<blockquote>\n<pre><code>$ go doc -u os.file\ntype File struct {\n  *file // os specific\n}\n    File represents an open file descriptor.\n\nfunc Create(name string) (*File, error)\nfunc NewFile(fd uintptr, name string) *File\nfunc Open(name string) (*File, error)\nfunc OpenFile(name string, flag int, perm FileMode) (*File, error)\nfunc newFile(fd uintptr, name string, kind newFileKind) *File\nfunc openFdAt(fd int, path string) (*File, error)\nfunc openFileNolog(name string, flag int, perm FileMode) (*File, error)\nfunc (f *File) Chdir() error\nfunc (f *File) Chmod(mode FileMode) error\nfunc (f *File) Chown(uid, gid int) error\nfunc (f *File) Close() error\nfunc (f *File) Fd() uintptr\nfunc (f *File) Name() string\nfunc (f *File) Read(b []byte) (n int, err error)\nfunc (f *File) ReadAt(b []byte, off int64) (n int, err error)\nfunc (f *File) Readdir(n int) ([]FileInfo, error)\nfunc (f *File) Readdirnames(n int) (names []string, err error)\nfunc (f *File) Seek(offset int64, whence int) (ret int64, err error)\nfunc (f *File) SetDeadline(t time.Time) error\nfunc (f *File) SetReadDeadline(t time.Time) error\nfunc (f *File) SetWriteDeadline(t time.Time) error\nfunc (f *File) Stat() (FileInfo, error)\nfunc (f *File) Sync() error\nfunc (f *File) SyscallConn() (syscall.RawConn, error)\nfunc (f *File) Truncate(size int64) error\nfunc (f *File) Write(b []byte) (n int, err error)\nfunc (f *File) WriteAt(b []byte, off int64) (n int, err error)\nfunc (f *File) WriteString(s string) (n int, err error)\nfunc (f *File) checkValid(op string) error\nfunc (f *File) chmod(mode FileMode) error\nfunc (file File) close() error\nfunc (f *File) pread(b []byte, off int64) (n int, err error)\nfunc (f *File) pwrite(b []byte, off int64) (n int, err error)\nfunc (f *File) read(b []byte) (n int, err error)\nfunc (f *File) readdir(n int) (fi []FileInfo, err error)\nfunc (f *File) readdirnames(n int) (names []string, err error)\nfunc (f *File) seek(offset int64, whence int) (ret int64, err error)\nfunc (f *File) setDeadline(t time.Time) error\nfunc (f *File) setReadDeadline(t time.Time) error\nfunc (f *File) setWriteDeadline(t time.Time) error\nfunc (f *File) wrapErr(op string, err error) error\nfunc (f *File) write(b []byte) (n int, err error)\ntype file struct {\n  pfd         poll.FD\n  name        string\n  dirinfo     *dirInfo // nil unless directory being read\n  nonblock    bool     // whether we set nonblocking mode\n  stdoutOrErr bool     // whether this is stdout or stderr\n}\n    file is the real representation of *File. The extra level of indirection\n    ensures that no clients of os can overwrite this data, which could cause the\n    finalizer to close the wrong file descriptor.\n\nfunc (file *file) close() error\n</code></pre>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p>I'm fairly certain this should be an allowed assignment.</p>\n\n<pre><code>new_stdout := &amp;ahhh{file, io.MultiWriter(file, os.Stdout)}\nos.Stdout = new_stdout\n</code></pre>\n</blockquote>\n\n<p>Is it an <code>*os.File</code>? No. Why should it be allowed?</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3672215"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3053, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1547996259, "creation_date": 1547985488, "last_edit_date": 1547991286, "question_id": 54276178, "link": "https://stackoverflow.com/questions/54276178/golang-add-custom-os-file-to-os-stdout", "title": "Golang add custom os.File to os.Stdout", "body": "<p>I'm trying to write output to a file whenever I print something to the console. There didn't seem to be any nice examples out there using a continuous stream, but rather reading a single value so I came up with the following code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io\"\n    \"os\"\n)\n\ntype ahhh struct {\n    *os.File\n    __writer io.Writer\n}\n\nfunc (me *ahhh) Write(b []byte) (n int, err error) {\n    return me.__writer.Write(b)\n}\n\nfunc write_print_to_file(file_name string) {\n    file, _ := os.OpenFile(file_name, os.O_RDWR|os.O_CREATE|os.O_APPEND, 0666)\n\n    new_stdout := &amp;ahhh{file, io.MultiWriter(file, os.Stdout)}\n\n    os.Stdout = new_stdout\n}\n\nfunc main() {\n    write_print_to_file(\"output.log\")\n    fmt.Println(\"Hello world!\")\n}\n</code></pre>\n\n<p>For some reason <code>os.Stdout = new_stdout</code> doesn't want to work. I'm fairly certain this should be an allowed assignment as I use something of similar structure in my FUSE file system, so I'm curious why <code>os.Stdout</code> doesn't want to accept my inherited <code>os.File</code>.</p>\n\n<p>Alternatively if this really isn't possible any good suggestions for making a continuous data stream to a file?</p>\n"}, {"tags": ["go", "mongo-go"], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 10682766, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-z8vKBtcG5XY/AAAAAAAAAAI/AAAAAAAAAAs/Eiqag7vmyLU/photo.jpg?sz=128", "display_name": "faraonc", "link": "https://stackoverflow.com/users/10682766/faraonc"}, "is_accepted": true, "score": 2, "last_activity_date": 1548284042, "creation_date": 1548284042, "answer_id": 54336933, "question_id": 54276007, "link": "https://stackoverflow.com/questions/54276007/how-to-use-the-elements-of-a-slice-in-bson-a-using-mongo-go-driver-0-2-0/54336933#54336933", "title": "How to use the elements of a slice in bson.A using mongo-go-driver 0.2.0", "body": "<p>So bson.A underlying type is <code>[]interface{}</code>,</p>\n\n<p>I could just use <code>append</code> to it like a slice</p>\n"}, {"tags": [], "owner": {"reputation": 298, "user_id": 2771419, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3359ecf8fb3a7695dd897d7a93ae3646?s=128&d=identicon&r=PG&f=1", "display_name": "Timmy", "link": "https://stackoverflow.com/users/2771419/timmy"}, "is_accepted": false, "score": 3, "last_activity_date": 1564173678, "creation_date": 1564173678, "answer_id": 57226753, "question_id": 54276007, "link": "https://stackoverflow.com/questions/54276007/how-to-use-the-elements-of-a-slice-in-bson-a-using-mongo-go-driver-0-2-0/57226753#57226753", "title": "How to use the elements of a slice in bson.A using mongo-go-driver 0.2.0", "body": "<p>Not sure if you ever found your answer, but I battled with this for an hour+ yesterday.</p>\n\n<p>I'm not positive this will solve what you're asking. I assume you're trying to build a filter from your input. Ultimately I did not use a bson.A when I was trying to pass an array.</p>\n\n<p>Situation: Trying to build a filter and one of the bson.D elements is an array.</p>\n\n<p>I <em>thought</em> I needed to use bson.A.</p>\n\n<p>My initial assumption: </p>\n\n<pre><code>return bson.D{\n  {\"uuid\", request.Uuid},\n  {\"action\", request.Action},\n  {\"resource\", bson.D{{\"$in\", bson.A{resourceStrings}}}},\n}\n</code></pre>\n\n<p>where <code>resourceStrings</code> is a slice of strings.</p>\n\n<p>However this will ultimately build a filter that looks like \n<code>FILTER :  [ {resource [{$in [[Orgs::Organizations::1 Orgs::Organizations::* Orgs::Organizations Orgs::*]]}]}]</code></p>\n\n<p>*Note that the $in method is looking for an array of arrays here.</p>\n\n<p>What we want is: \n<code>FILTER :  [{uuid 80} {action UpdateOrganization} {resource [{$in [Orgs::Organizations::1 Orgs::Organizations::* Orgs::Organizations Orgs::*]}]}]</code></p>\n\n<p>If we pass in a literal array of strings it will work... </p>\n\n<pre><code>return bson.D{\n  {\"uuid\", request.Uuid},\n  {\"action\", request.Action},\n  {\"resource\", bson.D{{\"$in\", bson.A{\"Orgs::Organizations::1\", \"Orgs::Organizations::*\", \"Orgs::Organizations\", \"Orgs::*\"}}}},\n}\n</code></pre>\n\n<p>After some trial and error I found that bson.D will directly accept the array.</p>\n\n<p>ultimately I solved the issue thus</p>\n\n<pre><code>return bson.D{\n  {\"uuid\", request.Uuid},\n  {\"action\", request.Action},\n  {\"resource\", bson.D{{\"$in\", resourceStrings}}},\n}\n</code></pre>\n\n<p>Taking your example literally - if you're simply trying to marshal an array to a bson.A try: </p>\n\n<p><code>bson.A{input}</code></p>\n"}, {"tags": [], "owner": {"reputation": 659, "user_id": 1155514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mjZMX.jpg?s=128&g=1", "display_name": "Muhammad Tariq", "link": "https://stackoverflow.com/users/1155514/muhammad-tariq"}, "is_accepted": false, "score": 0, "last_activity_date": 1613109802, "creation_date": 1613109802, "answer_id": 66167062, "question_id": 54276007, "link": "https://stackoverflow.com/questions/54276007/how-to-use-the-elements-of-a-slice-in-bson-a-using-mongo-go-driver-0-2-0/66167062#66167062", "title": "How to use the elements of a slice in bson.A using mongo-go-driver 0.2.0", "body": "<p>Here is my code to delete multiple documents based on ID which are present in another collection.<br />\nWe first collect all the IDs from one collection and add to a slice. Then we delete documents in another collection using <code>DeleteMany()</code></p>\n<p>I am showing the relevant code to keep the code clean.</p>\n<h2>Json</h2>\n<pre class=\"lang-json prettyprint-override\"><code>[\n    {\n        &quot;id&quot;: &quot;602607bcfdc0548bfebbd0c7&quot;,\n        &quot;subject&quot;: &quot;SUBJECT&quot;,\n        &quot;system&quot;: &quot;SYSTEM&quot;,\n        &quot;board&quot;: &quot;BOARD&quot;,\n        &quot;series&quot;: &quot;SERIES&quot;,\n        &quot;paper&quot;: &quot;PAPER&quot;,\n        &quot;year&quot;: &quot;2021&quot;,\n        &quot;month&quot;: &quot;February&quot;,\n        &quot;question_hex_ids&quot;: [\n            &quot;602607bcfdc0548bfebbd0c4&quot;,\n            &quot;602607bcfdc0548bfebbd0c5&quot;,\n            &quot;602607bcfdc0548bfebbd0c6&quot;\n        ]\n    }\n]\n</code></pre>\n<h2>Code</h2>\n<pre class=\"lang-golang prettyprint-override\"><code>\n    var hexIDCollection []primitive.ObjectID\n    database := db.Conn.Database(&quot;mydatabase&quot;)\n    question := database.Collection(&quot;questions&quot;)\n\n    //Iterating to collect IDs from paper\n    for k, _ := range mystruct.question_hex_ids {\n\n        // fetching all IDs and appending to slice\n        ids := mystruct.question_hex_ids[k]\n        hexID, err := primitive.ObjectIDFromHex(ids)\n        if err != nil {\n            fmt.Println(&quot;ObjectIDFromHex ERROR&quot;, err)\n        }\n\n        //Populating a slice of all the IDs\n        hexIDCollection = append(hexIDCollection, hexID)\n    }\n\n    filter := bson.D{\n        {&quot;_id&quot;, bson.D{{&quot;$in&quot;, hexIDCollection}}}, }\n\n    deleteResult, err1 := question.DeleteMany(ctx, filter)\n    if err != nil {\n        fmt.Println(&quot;Question Deletion Error&quot;, err1)\n    }\n\n    fmt.Println(&quot;All questions Deleted: &quot;, deleteResult)\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 10682766, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-z8vKBtcG5XY/AAAAAAAAAAI/AAAAAAAAAAs/Eiqag7vmyLU/photo.jpg?sz=128", "display_name": "faraonc", "link": "https://stackoverflow.com/users/10682766/faraonc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2882, "favorite_count": 0, "accepted_answer_id": 54336933, "answer_count": 3, "score": 2, "last_activity_date": 1613109802, "creation_date": 1547983979, "last_edit_date": 1548066612, "question_id": 54276007, "link": "https://stackoverflow.com/questions/54276007/how-to-use-the-elements-of-a-slice-in-bson-a-using-mongo-go-driver-0-2-0", "title": "How to use the elements of a slice in bson.A using mongo-go-driver 0.2.0", "body": "<p>How do I use a given slice to generate a bson.A? I need this to make dynamic queries.</p>\n\n<p>I am upgrading from mongo-go-driver alpha to beta 0.2.0, and this has become a major change in my project since the API is different now.</p>\n\n<p><a href=\"https://godoc.org/github.com/mongodb/mongo-go-driver/bson\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/mongodb/mongo-go-driver/bson</a></p>\n\n<pre><code>input := []string{\"bar\", \"world\"}\n//expected output\nbson.A{\"bar\", \"world\"}\n</code></pre>\n"}, {"tags": ["go", "cookies"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1547983508, "post_id": 54275704, "comment_id": 95373906, "body": "Did you try setting the domain of the cookie to an empty string? E.g. <code>cookieName=cookieValue;domain=;secure;</code>?"}, {"owner": {"reputation": 860, "user_id": 8162252, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-yd_PU1d6EQ4/AAAAAAAAAAI/AAAAAAAABb4/JZOdzUW7a-c/photo.jpg?sz=128", "display_name": "Ado Ren", "link": "https://stackoverflow.com/users/8162252/ado-ren"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1547984903, "post_id": 54275704, "comment_id": 95374239, "body": "Just tried. No success."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1547985622, "post_id": 54275704, "comment_id": 95374391, "body": "When you remove <code>;secure</code> and redirect to http instead of https, this works without even specifying the empty domain, at least on firefox it does work for me. However you&#39;re redirecting to https which by default isn&#39;t supported on localhost, so whatever you use to support this, e.g. a proxy, could be the cause of the loss of the cookie."}, {"owner": {"reputation": 860, "user_id": 8162252, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-yd_PU1d6EQ4/AAAAAAAAAAI/AAAAAAAABb4/JZOdzUW7a-c/photo.jpg?sz=128", "display_name": "Ado Ren", "link": "https://stackoverflow.com/users/8162252/ado-ren"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1547986552, "post_id": 54275704, "comment_id": 95374618, "body": "I tried something stupid with a random cookie and it works (even secured). See updated answer. Not sure where to look at now but probably my &quot;appointment&quot; cookie is flawed."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1547986709, "post_id": 54275704, "comment_id": 95374652, "body": "<a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Document/cookie\" rel=\"nofollow noreferrer\">Try</a>: <i>&quot;The cookie value string can use encodeURIComponent() to ensure that the string does not contain any commas, semicolons, or whitespace (which are disallowed in cookie values).&quot;</i>"}, {"owner": {"reputation": 860, "user_id": 8162252, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-yd_PU1d6EQ4/AAAAAAAAAAI/AAAAAAAABb4/JZOdzUW7a-c/photo.jpg?sz=128", "display_name": "Ado Ren", "link": "https://stackoverflow.com/users/8162252/ado-ren"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1547987343, "post_id": 54275704, "comment_id": 95374835, "body": "Seems it was it, I tried it previously but on the whole cookie. (I demand grace, newbie). I can pass something to my backend ! :)"}], "answers": [{"comments": [{"owner": {"reputation": 860, "user_id": 8162252, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-yd_PU1d6EQ4/AAAAAAAAAAI/AAAAAAAABb4/JZOdzUW7a-c/photo.jpg?sz=128", "display_name": "Ado Ren", "link": "https://stackoverflow.com/users/8162252/ado-ren"}, "edited": false, "score": 0, "creation_date": 1547987565, "post_id": 54276297, "comment_id": 95374894, "body": "Appreciate the time you&#39;ve put into your answer. Why do you say base64 is a better way ?"}, {"owner": {"reputation": 614, "user_id": 5802172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9msUA.jpg?s=128&g=1", "display_name": "Sebastian Waldbauer", "link": "https://stackoverflow.com/users/5802172/sebastian-waldbauer"}, "reply_to_user": {"reputation": 860, "user_id": 8162252, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-yd_PU1d6EQ4/AAAAAAAAAAI/AAAAAAAABb4/JZOdzUW7a-c/photo.jpg?sz=128", "display_name": "Ado Ren", "link": "https://stackoverflow.com/users/8162252/ado-ren"}, "edited": false, "score": 0, "creation_date": 1547987827, "post_id": 54276297, "comment_id": 95374955, "body": "As <a href=\"https://stackoverflow.com/users/965900/mkopriva\">mkopriva</a> already mentioned, there are some &quot;illegal&quot; characters in your cookie instead. You can use any serialisation method like base64 or <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent\" rel=\"nofollow noreferrer\">encode</a> to eliminate those characters."}, {"owner": {"reputation": 860, "user_id": 8162252, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-yd_PU1d6EQ4/AAAAAAAAAAI/AAAAAAAABb4/JZOdzUW7a-c/photo.jpg?sz=128", "display_name": "Ado Ren", "link": "https://stackoverflow.com/users/8162252/ado-ren"}, "edited": false, "score": 0, "creation_date": 1547988164, "post_id": 54276297, "comment_id": 95375034, "body": "I validate your answer. You nailed that my data contained illegal characters. The date as a matter of fact. Thanks"}], "tags": [], "owner": {"reputation": 614, "user_id": 5802172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9msUA.jpg?s=128&g=1", "display_name": "Sebastian Waldbauer", "link": "https://stackoverflow.com/users/5802172/sebastian-waldbauer"}, "is_accepted": true, "score": 7, "last_activity_date": 1547986371, "creation_date": 1547986371, "answer_id": 54276297, "question_id": 54275704, "link": "https://stackoverflow.com/questions/54275704/how-to-read-cookies/54276297#54276297", "title": "How to read cookies?", "body": "<p>A better way would be to encode your json into base64 for example. I made a working example...</p>\n\n<p>main.go</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/base64\"\n    \"encoding/json\"\n    \"fmt\"\n    \"io\"\n    \"io/ioutil\"\n    \"net/http\"\n)\n\n// Contains everything about an appointment\ntype Appointment struct {\n    Date    string `json:\"appointmentDate\"`    // Contains date as string\n    StartMn string `json:\"appointmentStartMn\"` // Our startMn ?\n    ID      int    `json:\"appointmentId\"`      // AppointmentId\n    UserID  int    `json:\"appointmentUserId\"`  // UserId\n}\n\nfunc main() {\n    handler := http.NewServeMux()\n\n    // Main request\n    handler.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n        fmt.Printf(\"Requested /\\r\\n\")\n\n        // set typical headers\n        w.Header().Set(\"Content-Type\", \"text/html\")\n        w.WriteHeader(http.StatusOK)\n\n        // Read file\n        b, _ := ioutil.ReadFile(\"index.html\")\n        io.WriteString(w, string(b))\n    })\n\n    // booking request\n    handler.HandleFunc(\"/booking/\", func(w http.ResponseWriter, r *http.Request) {\n        fmt.Printf(\"Requested /booking/\\r\\n\")\n\n        // set typical headers\n        w.Header().Set(\"Content-Type\", \"text/html\")\n        w.WriteHeader(http.StatusOK)\n\n        // Read cookie\n        cookie, err := r.Cookie(\"appointment\")\n        if err != nil {\n            fmt.Printf(\"Cant find cookie :/\\r\\n\")\n            return\n        }\n\n        fmt.Printf(\"%s=%s\\r\\n\", cookie.Name, cookie.Value)\n\n        // Cookie data\n        data, err := base64.StdEncoding.DecodeString(cookie.Value)\n        if err != nil {\n            fmt.Printf(\"Error:\", err)\n        }\n\n        var appointment Appointment\n        er := json.Unmarshal(data, &amp;appointment)\n        if err != nil {\n            fmt.Printf(\"Error: \", er)\n        }\n\n        fmt.Printf(\"%s, %s, %d, %d\\r\\n\", appointment.Date, appointment.StartMn, appointment.ID, appointment.UserID)\n\n        // Read file\n        b, _ := ioutil.ReadFile(\"booking.html\")\n        io.WriteString(w, string(b))\n    })\n\n    // Serve :)\n    http.ListenAndServe(\":8080\", handler)\n}\n\n</code></pre>\n\n<p>index.html</p>\n\n<pre><code>&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;Your page&lt;/title&gt;\n    &lt;/head&gt;\n&lt;body&gt;\n    Setting cookie via Javascript\n\n    &lt;script type=\"text/javascript\"&gt;\n    window.onload = () =&gt; {\n        function setCookie(name, value, days) {\n            var expires = \"\";\n            if (days) {\n                var date = new Date();\n                date.setTime(date.getTime() + (days*24*60*60*1000));\n                expires = \"; expires=\" + date.toUTCString();\n            }\n            document.cookie = name + \"=\" + btoa((value || \"\"))  + expires + \"; path=/\";\n        }\n\n        setCookie(\"appointment\", JSON.stringify({\n                    appointmentDate: \"20-01-2019 13:06\",\n                    appointmentStartMn: \"1-2\",\n                    appointmentId: 2,\n                    appointmentUserId: 3\n            })\n        );\n\n        document.location = \"/booking/\";\n    }\n    &lt;/script&gt;\n&lt;/body&gt;\n</code></pre>\n\n<p>booking.html</p>\n\n<pre><code>&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;Your page&lt;/title&gt;\n    &lt;/head&gt;\n&lt;body&gt;\n    Your booking is okay :)\n&lt;/body&gt;\n</code></pre>\n"}], "owner": {"reputation": 860, "user_id": 8162252, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-yd_PU1d6EQ4/AAAAAAAAAAI/AAAAAAAABb4/JZOdzUW7a-c/photo.jpg?sz=128", "display_name": "Ado Ren", "link": "https://stackoverflow.com/users/8162252/ado-ren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11288, "favorite_count": 2, "accepted_answer_id": 54276297, "answer_count": 1, "score": 5, "last_activity_date": 1594367809, "creation_date": 1547981486, "last_edit_date": 1594367809, "question_id": 54275704, "link": "https://stackoverflow.com/questions/54275704/how-to-read-cookies", "title": "How to read cookies?", "body": "<p>I set a cookie from javascript such as:</p>\n<pre><code>setCookie(&quot;appointment&quot;, JSON.stringify({\n                appointmentDate: selectedDay.date,\n                appointmentStartMn: appointment.mnRange[0],\n                appointmentId: appointment.id || 0,\n                appointmentUserId: appointment.user.id || 0\n          })\n);\n</code></pre>\n<p>After cookie is set I want to redirect the user to a booking page:</p>\n<pre><code>window.location.href = &quot;https://localhost:8080/booking/&quot;\n</code></pre>\n<p>The setCookie function:</p>\n<pre><code>function setCookie(cookieName, cookieValue) {\n    document.cookie = `${cookieName}=${cookieValue};secure;`;\n}\n</code></pre>\n<p>I'd like to retrieve that cookie from my go backend but I can't figure out how to do this. I've read about this question since I've never used cookies before but the answers seems to tell that I don't have to do much aside from setting document.cookie.</p>\n<p>In my browser storage I can see the cookie is indeed set as expected.</p>\n<p>In my Go back end I want to print the cookie:</p>\n<pre><code>r.HandleFunc(&quot;/booking/&quot;, handler.serveTemplate)\n\nfunc (handler *templateHandler) serveTemplate(w http.ResponseWriter, r *http.Request) {\n    c, err := r.Cookie(&quot;appointment&quot;)\n    if err != nil {\n        fmt.Println(err.Error())\n    } else {\n        fmt.Println(c.Value)\n    }\n}\n\n//output http: named cookie not present\n</code></pre>\n<p>What is the specific I am missing ? I think I'm confusing local/http cookie but how to achieve the reading of client set cookies?</p>\n<p><strong>UPDATE (see answer for more)</strong></p>\n<p>It has nothing to do with golang. My:</p>\n<pre><code>appointmentDate: selectedDay.date\n</code></pre>\n<p>What formatted as <code>2019-01-01</code> and <code>-</code> is not a valid character that can be send to the backend. It worked into my browser, but it needs to be URI encoded to be passed.</p>\n<p>So this did the trick:</p>\n<pre><code>`${cookieName}=${encodeURIComponent(cookieValue)};secure;` + &quot;path=/&quot;;`\n</code></pre>\n<p>And in go (didn't catch err here to save space):</p>\n<pre><code>cookie, _ := r.Cookie(&quot;appointment&quot;)\ndata, _ := url.QueryUnescape(cookie.Value)\n</code></pre>\n"}, {"tags": ["go", "receiver"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1547980583, "post_id": 54275543, "comment_id": 95373261, "body": "&quot;despite I put value variable as a parameter&quot; but receiver is not your ordinary parameter. It gets special treatment. I wish I was able to give a more detailed answer. Gotta go re-read the spec."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1547983993, "post_id": 54275543, "comment_id": 95374012, "body": "From the <a href=\"https://golang.org/ref/spec#Calls\" rel=\"nofollow noreferrer\">docs</a>: <i>&quot;A method call x.m() is valid if the method set of (the type of) x contains m and the argument list can be assigned to the parameter list of m. <b>If x is addressable and &amp;x&#39;s method set contains m, x.m() is shorthand for (&amp;x).m()</b>&quot;</i>"}, {"owner": {"reputation": 17, "user_id": 10314668, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DEfA2Q7GK0I/AAAAAAAAAAI/AAAAAAAAABY/KZn3wMdHB54/photo.jpg?sz=128", "display_name": "namyulbae", "link": "https://stackoverflow.com/users/10314668/namyulbae"}, "edited": false, "score": 0, "creation_date": 1548029056, "post_id": 54275543, "comment_id": 95385977, "body": "I&#39;m very thankful for your  comment. it&#39;s helpful for me to understand this conception."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 10314668, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DEfA2Q7GK0I/AAAAAAAAAAI/AAAAAAAAABY/KZn3wMdHB54/photo.jpg?sz=128", "display_name": "namyulbae", "link": "https://stackoverflow.com/users/10314668/namyulbae"}, "edited": false, "score": 0, "creation_date": 1548029242, "post_id": 54277376, "comment_id": 95386001, "body": "Thank you for your kindness. It&#39;s helpful for me to understand the pointer in golang. I&#39;ll try to learn perfectly more. Thank you. Eli Bendersky."}], "tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": false, "score": 1, "last_activity_date": 1547993984, "creation_date": 1547993984, "answer_id": 54277376, "question_id": 54275543, "link": "https://stackoverflow.com/questions/54275543/the-question-of-receiver-using-struct-in-go/54277376#54277376", "title": "The question of receiver using struct in go", "body": "<p>Simplifying your example code to focus on the question / issue at hand:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Person struct {\n    name string\n    age  int\n}\n\nfunc (p *Person) greeting1() {\n    fmt.Println(p)\n    fmt.Println(&amp;p)\n}\n\nfunc main() {\n    var p Person\n    p.name = \"joe\"\n    p.age = 41\n    p.greeting1()\n}\n</code></pre>\n\n<p>Prints:</p>\n\n<pre><code>&amp;{joe 41}\n0xc00000c028\n</code></pre>\n\n<p>In short, the call <code>p.greeting1()</code> works because Go sees that <code>Person</code> (the type of <code>p</code>) has a <code>greeting1</code> method defined on a pointer receiver. So it treats the call <code>p.greeting1()</code> as equivalent to <code>(&amp;p).greeting1()</code>. As mkopriva said in a comment, this is clearly laid out in the <a href=\"https://golang.org/ref/spec#Calls\" rel=\"nofollow noreferrer\">Go spec</a>:</p>\n\n<blockquote>\n  <p>A method call x.m() is valid if the method set of (the type of) x\n  contains m and the argument list can be assigned to the parameter list\n  of m. If x is addressable and &amp;x's method set contains m, x.m() is\n  shorthand for (&amp;x).m()</p>\n</blockquote>\n\n<p>This is done for convenience. Since pointer receivers are quite necessary and popular in Go - you need them whenever your method mutates the underlying object - it helps write cleaner code. You shouldn't be forced to write <code>(&amp;p).greeting1()</code> where <code>p.greeting1()</code> would do - this substituion is unambiguous as the compiler knows what methods are defined on <code>Person</code>, and with which receivers.</p>\n\n<p>Effective Go has a section on <a href=\"https://golang.org/doc/effective_go.html#pointers_vs_values\" rel=\"nofollow noreferrer\">pointer vs. value receivers</a> that you should read. Here's one relevant quote:</p>\n\n<blockquote>\n  <p>When the value is addressable, the language takes care of the common\n  case of invoking a pointer method on a value by inserting the address\n  operator automatically. In our example, the variable b is addressable,\n  so we can call its Write method with just b.Write. The compiler will\n  rewrite that to (&amp;b).Write for us.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 84, "user_id": 10011729, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pRN-9smfua0/AAAAAAAAAAI/AAAAAAAAACQ/0m2EjUAktHw/photo.jpg?sz=128", "display_name": "Pourya ", "link": "https://stackoverflow.com/users/10011729/pourya"}, "is_accepted": false, "score": 0, "last_activity_date": 1548187212, "creation_date": 1548187212, "answer_id": 54315606, "question_id": 54275543, "link": "https://stackoverflow.com/questions/54275543/the-question-of-receiver-using-struct-in-go/54315606#54315606", "title": "The question of receiver using struct in go", "body": "<p>Actually Go is an object oriented language in its own way. It uses struct instead of classes. If you want to have a class, you must make a struct and relate some funcs to it by a pointer of that struct, So later you can create many independent object from your struct. You can use the function new which will return a pointer of your struct. Like:</p>\n\n<pre><code>p:=new(person)\np.name = \"joe\"\np.age = 41\np.greeting1()\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 10314668, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DEfA2Q7GK0I/AAAAAAAAAAI/AAAAAAAAABY/KZn3wMdHB54/photo.jpg?sz=128", "display_name": "namyulbae", "link": "https://stackoverflow.com/users/10314668/namyulbae"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1548187212, "creation_date": 1547980265, "question_id": 54275543, "link": "https://stackoverflow.com/questions/54275543/the-question-of-receiver-using-struct-in-go", "title": "The question of receiver using struct in go", "body": "<p>receiver's usage</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Person struct {\n    name string\n    age  int\n}\n\nfunc (p *Person) greeting1() {\n\n    fmt.Println(p)  //&amp;{0}\n    fmt.Println(&amp;p) //0xc000086018\n    fmt.Println(\"Hello~\")\n}\n\nfunc (p Person) greeting2() {\n    fmt.Println(p)  //{0}\n    fmt.Println(&amp;p) //&amp;{0}\n    fmt.Println(\"Hello~\")\n}\n\ntype Student struct {\n    //p Persion -&gt; has a \n    Person // -&gt; is a \n    school string\n    grade  int\n}\n\nfunc test1(p Student) {\n    fmt.Println(p)\n}\n\nfunc test2(p *Student){\n    fmt.Println(p)\n}\n\nfunc main() {\n    var s Student\n    //s.p.greeting()\n    s.greeting1()\n    s.greeting2()\n\n    test1(s)\n    //test2(s) -&gt; error \n}\n\n</code></pre>\n\n<p>When I use function in golang, If I declare value variable, when I use function I made, I had to put only value variable on paramter. like,</p>\n\n<pre><code>a int= 10;\nfunc func1(param int){\n fmt.Println(fmt)\n}\n</code></pre>\n\n<p>despite I declared Person as a value struct in Student struct,\nas you see my code,\nreceiver functions(greeting1, greeting2) are getting two type parameters which are *Person, and Person.\nI cannot understand that why greeting1 function is functioning without error, despite I put value variable as a parameter.\nThank you for you guys help.</p>\n"}, {"tags": ["variables", "go"], "comments": [{"owner": {"reputation": 93, "user_id": 10209822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91868bc4cac62cb5aba3a0b67520bc08?s=128&d=identicon&r=PG&f=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/10209822/priyanka"}, "reply_to_user": {"reputation": 42804, "user_id": 2181397, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/616931b5c5ba8790a191fa6aea465c65?s=128&d=identicon&r=PG", "display_name": "brk", "link": "https://stackoverflow.com/users/2181397/brk"}, "edited": false, "score": 0, "creation_date": 1547979157, "post_id": 54275337, "comment_id": 95372914, "body": "no this is golang.if there is way for this in solution in javascript. i thought of trying the logic in golang"}, {"owner": {"reputation": 24888, "user_id": 1023618, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5dd1a5bb0139abc749b7d4cd8cf7aa1b?s=128&d=identicon&r=PG", "display_name": "Reinstate Monica Cellio", "link": "https://stackoverflow.com/users/1023618/reinstate-monica-cellio"}, "edited": false, "score": 0, "creation_date": 1547979167, "post_id": 54275337, "comment_id": 95372915, "body": "Dynamic variable name is not what you want.  Have a look at a key/value pair... <a href=\"https://gobyexample.com/maps\" rel=\"nofollow noreferrer\">gobyexample.com/maps</a>  (Also I removed the irrelevant tags)"}, {"owner": {"reputation": 93, "user_id": 10209822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91868bc4cac62cb5aba3a0b67520bc08?s=128&d=identicon&r=PG&f=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/10209822/priyanka"}, "reply_to_user": {"reputation": 24888, "user_id": 1023618, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5dd1a5bb0139abc749b7d4cd8cf7aa1b?s=128&d=identicon&r=PG", "display_name": "Reinstate Monica Cellio", "link": "https://stackoverflow.com/users/1023618/reinstate-monica-cellio"}, "edited": false, "score": 0, "creation_date": 1547979390, "post_id": 54275337, "comment_id": 95372970, "body": "is there a possibility that i can create a variable name by concatenating with current date and assign a value to the variable?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1547979530, "post_id": 54275337, "comment_id": 95373005, "body": "This is not possible in Go."}, {"owner": {"reputation": 93, "user_id": 10209822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91868bc4cac62cb5aba3a0b67520bc08?s=128&d=identicon&r=PG&f=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/10209822/priyanka"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1547979603, "post_id": 54275337, "comment_id": 95373021, "body": "ok thank you @Flimzy"}], "answers": [{"tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": false, "score": 1, "last_activity_date": 1547995050, "creation_date": 1547995050, "answer_id": 54277523, "question_id": 54275337, "link": "https://stackoverflow.com/questions/54275337/how-to-create-a-dynamic-variable-name-by-concatenating-two-strings/54277523#54277523", "title": "How to create a dynamic variable name by concatenating two strings", "body": "<p>This is not possible in Go, since it's a compiled and statically typed language. The compiler has to know, at compile-time, the names and types of variables (*). What you ask is a run-time variable naming, which cannot work. However, it's extremely unlikely that you actually need this in practice. Maps can provide a similar capability:</p>\n\n<pre><code>m := make(map[string]string)\nm[\"key\"] = \"value\"\n</code></pre>\n\n<p>And you can construct either of these at run-time. Slightly adapting your example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n    \"strings\"\n    \"time\"\n)\n\nfunc main() {\n    m := make(map[string]string)\n    currentMonth := time.Now().Month()\n    currentYear := time.Now().Year()\n    var month = int(currentMonth)\n    var currentDate = strings.Join([]string{strconv.Itoa(currentYear), \"-\", strconv.Itoa(month)}, \"\")\n\n    m[\"key\"+currentDate] = \"value\"\n    fmt.Println(m)\n}\n</code></pre>\n\n<p>Prints out:</p>\n\n<pre><code>map[key2019-1:value]\n</code></pre>\n\n<hr>\n\n<p>(*) With some exceptions that are not relevant for this particular discussion.</p>\n"}], "owner": {"reputation": 93, "user_id": 10209822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91868bc4cac62cb5aba3a0b67520bc08?s=128&d=identicon&r=PG&f=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/10209822/priyanka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 572, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1547995050, "creation_date": 1547978565, "last_edit_date": 1547979494, "question_id": 54275337, "link": "https://stackoverflow.com/questions/54275337/how-to-create-a-dynamic-variable-name-by-concatenating-two-strings", "title": "How to create a dynamic variable name by concatenating two strings", "body": "<p>I want to a create variable name by concatenating with current date and provide a value to the created variable name. My variable name should look something like this <strong>\"Key-2019-01\"</strong> so that I can store the value as <strong>var Key-2019-01 = \"yes\"</strong></p>\n\n<p>I have tried like the below.    </p>\n\n<pre><code>     package main\n\n     import (\n         \"fmt\"\n         \"time\"\n         \"strconv\"\n          \"strings\" \n     )\n\n    func main() {\n        currentMonth := time.Now().Month()\n        currentYear := time.Now().Year()\n        var month = int(currentMonth)\n        var currentDate = strings.Join([]string{strconv.Itoa(currentYear), \"-\", strconv.Itoa(month)}, \"\")\n\n        var \"Key\",currentDate string\n\n        value, err := json.Marshal(\"yes\")\n        stub.PutState((\"Key\", currentDate), value)\n    }      \n</code></pre>\n\n<p>It could be helpful if I get a working code of this.</p>\n"}, {"tags": ["node.js", "amazon-web-services", "go", "hyperledger-fabric", "blockchain"], "comments": [{"owner": {"reputation": 850, "user_id": 6344133, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/D1EUE.jpg?s=128&g=1", "display_name": "Sharad", "link": "https://stackoverflow.com/users/6344133/sharad"}, "edited": false, "score": 0, "creation_date": 1578911022, "post_id": 54274351, "comment_id": 105580054, "body": "Guys can any one help me that. Can we create rest server in windows OS?. I have successfully created ad installed chain code in aws. Just I want to query it in windows local using node sdk."}], "answers": [{"comments": [{"owner": {"reputation": 471, "user_id": 5944021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H0Cds.jpg?s=128&g=1", "display_name": "Moolshanker Kothari", "link": "https://stackoverflow.com/users/5944021/moolshanker-kothari"}, "edited": false, "score": 0, "creation_date": 1547970571, "post_id": 54274413, "comment_id": 95371391, "body": "I have added the contents of ngo-connection-profile.yaml in the main question."}, {"owner": {"reputation": 471, "user_id": 5944021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H0Cds.jpg?s=128&g=1", "display_name": "Moolshanker Kothari", "link": "https://stackoverflow.com/users/5944021/moolshanker-kothari"}, "edited": false, "score": 0, "creation_date": 1547972618, "post_id": 54274413, "comment_id": 95371724, "body": "Yes you were right, mspid was missing and after setting this value restarting node, now I am able to send both api requests. (Register/enroll a user), (POST a Donor) and (Get all donors). Thanks Bajwa"}, {"owner": {"reputation": 3643, "user_id": 6234823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa4059b96fed89c7dcac024b5b9b2140?s=128&d=identicon&r=PG&f=1", "display_name": "Malatesh Patil", "link": "https://stackoverflow.com/users/6234823/malatesh-patil"}, "reply_to_user": {"reputation": 471, "user_id": 5944021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H0Cds.jpg?s=128&g=1", "display_name": "Moolshanker Kothari", "link": "https://stackoverflow.com/users/5944021/moolshanker-kothari"}, "edited": false, "score": 0, "creation_date": 1578058813, "post_id": 54274413, "comment_id": 105325394, "body": "Hi @Moolshanker Kothari, Do you tried to run the same ngo-rest-api project locally in windows?"}, {"owner": {"reputation": 471, "user_id": 5944021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H0Cds.jpg?s=128&g=1", "display_name": "Moolshanker Kothari", "link": "https://stackoverflow.com/users/5944021/moolshanker-kothari"}, "edited": false, "score": 0, "creation_date": 1578913203, "post_id": 54274413, "comment_id": 105581327, "body": "Nop, I have deployed on Ubuntu 18.04"}], "tags": [], "owner": {"reputation": 1426, "user_id": 3141903, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3YI7Z.jpg?s=128&g=1", "display_name": "I Bajwa PHD", "link": "https://stackoverflow.com/users/3141903/i-bajwa-phd"}, "is_accepted": false, "score": 0, "last_activity_date": 1547972238, "last_edit_date": 1547972238, "creation_date": 1547969126, "answer_id": 54274413, "question_id": 54274351, "link": "https://stackoverflow.com/questions/54274351/deploy-and-expose-chaincode-as-rest-api-on-amazon-managed-blockchain-hyperledger/54274413#54274413", "title": "Deploy and expose chaincode as REST api on amazon managed blockchain hyperledger fabric 1.2", "body": "<p>I am also exploring Amazon Managed Blockchain although its in preview. Hopefully I will be able to assist you in your issue. mspid is not a parameter to be sent in the request. It looks that you are missing some-thing in the configuration file. Can you send me the contents of below configuration file?\n<pre><code>cat ~/non-profit-blockchain/tmp/connection-profile/ngo-connection-profile.yaml</pre></code></p>\n\n<p>While looking at the contents of the configuration file, it is obvious that mspid value is missing in the configuration file. Membership Service Providers (MSP) ID is a mandatory value to be set in the configuration. You can also confirm it with below command. \n<pre><code>cat ~/non-profit-blockchain/tmp/connection-profile/ngo-connection-profile.yaml | grep mspid:</pre></code>\nIf it is showing empty value then you need to set mspid in the configuration file.\nMake sure that the environment variables mentioned in <pre><code>~/non-profit-blockchain/ngo-fabric/fabric-exports.sh</pre></code> are properly set. If this file is missing then use <pre><code>~/non-profit-blockchain/ngo-fabric/templates/exports-template.sh</pre></code>\nYou need to set the value of environment variable ${MEMBERID} in mspid in ngo-connection-profile.yaml, also see if any other required field value is missing in the configuration file. You can also see the detail of values required t be replacs in the configuration file from below script.\n<pre><code>~/non-profit-blockchain/ngo-rest-api/connection-profile/gen-connection-profile.sh</pre></code>.\nLet me list down those as well.\n<pre><code>\nsed -i \"s|%PEERNODEID%|$PEERNODEID|g\" $REPODIR/tmp/connection-profile/ngo-connection-profile.yaml\nsed -i \"s|%MEMBERID%|$MEMBERID|g\" $REPODIR/tmp/connection-profile/ngo-connection-profile.yaml\nsed -i \"s|%CAFILE%|$LOCALCA|g\" $REPODIR/tmp/connection-profile/ngo-connection-profile.yaml\nsed -i \"s|%ORDERINGSERVICEENDPOINT%|$ORDERINGSERVICEENDPOINT|g\" $REPODIR/tmp/connection-profile/ngo-connection-profile.yaml\nsed -i \"s|%ORDERINGSERVICEENDPOINTNOPORT%|$ORDERINGSERVICEENDPOINTNOPORT|g\" $REPODIR/tmp/connection-profile/ngo-connection-profile.yaml\nsed -i \"s|%PEERSERVICEENDPOINT%|$PEERSERVICEENDPOINT|g\" $REPODIR/tmp/connection-profile/ngo-connection-profile.yaml\nsed -i \"s|%PEERSERVICEENDPOINTNOPORT%|$PEERSERVICEENDPOINTNOPORT|g\" $REPODIR/tmp/connection-profile/ngo-connection-profile.yaml\nsed -i \"s|%PEEREVENTENDPOINT%|$PEEREVENTENDPOINT|g\" $REPODIR/tmp/connection-profile/ngo-connection-profile.yaml\nsed -i \"s|%CASERVICEENDPOINT%|$CASERVICEENDPOINT|g\" $REPODIR/tmp/connection-profile/ngo-connection-profile.yaml\nsed -i \"s|%ADMINUSER%|$ADMINUSER|g\" $REPODIR/tmp/connection-profile/ngo-connection-profile.yaml\nsed -i \"s|%ADMINPWD%|$ADMINPWD|g\" $REPODIR/tmp/connection-profile/ngo-connection-profile.yaml\n</pre></code></p>\n\n<p>After setting the values and verifying, stop node or kill the process running on port 3000 and run node again.\ncd ~/non-profit-blockchain/ngo-rest-api\n<pre><code>nvm use lts/carbon\nnode app.js &amp;</pre></code></p>\n"}], "owner": {"reputation": 471, "user_id": 5944021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H0Cds.jpg?s=128&g=1", "display_name": "Moolshanker Kothari", "link": "https://stackoverflow.com/users/5944021/moolshanker-kothari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 639, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564466459, "creation_date": 1547968431, "last_edit_date": 1547971081, "question_id": 54274351, "link": "https://stackoverflow.com/questions/54274351/deploy-and-expose-chaincode-as-rest-api-on-amazon-managed-blockchain-hyperledger", "title": "Deploy and expose chaincode as REST api on amazon managed blockchain hyperledger fabric 1.2", "body": "<p>I have configured amazon managed blockchain setup with Hyperledger 1.2. The network is prepared with a single member and a single peer node.\nHyperledger Fabric Client setup is with Golang 1.10.3. I have installed, Instantiated, Queried and Invoked mycc chaincode example given in AWS tutorial. Which works perfectly. Complete exercise was done following <a href=\"https://docs.aws.amazon.com/managed-blockchain/latest/managementguide/managed-blockchain-get-started-tutorial.html\" rel=\"nofollow noreferrer\">this</a> link.</p>\n\n<p>I want to deploy and expose the chaincode as REST api.\nThere is a sample project <a href=\"https://github.com/aws-samples/non-profit-blockchain\" rel=\"nofollow noreferrer\">Amazon Managed Blockchain Workshop</a>.\nThey have used RESTful API, running as a Node.js Express application, using the Hyperledger Fabric Client SDK to query and invoke chaincode.\nI want to run non-profit chaincode example on Hyperledger Fabric Client prepared for AWS managed Blockchain Hyper Ledger 1.2</p>\n\n<p>I have performed below steps:</p>\n\n<ul>\n<li><p>Part 2: Deploy the <a href=\"https://github.com/aws-samples/non-profit-blockchain/blob/master/ngo-chaincode/README.md\" rel=\"nofollow noreferrer\">non-profit chaincode</a>)</p></li>\n<li><p>Part 3: RESTful API to expose the Chaincode</p></li>\n</ul>\n\n<p>Here are the steps how am I am running and testing the REST API.</p>\n\n<pre><code>cd ~/non-profit-blockchain/ngo-rest-api\nnvm use lts/carbon\nnode app.js &amp;\n</code></pre>\n\n<p>If I execute Register/enroll a user request</p>\n\n<pre><code>curl -s -X POST http://localhost:3000/users -H \"content-type: application/x-www-form-urlencoded\" -d 'username=john&amp;orgName=Org1'\n</code></pre>\n\n<p>Instead of showing: response:</p>\n\n<blockquote>\n  <p>{\"success\":true,\"secret\":\"\",\"message\":\"michael enrolled Successfully\"}</p>\n</blockquote>\n\n<p>It shows below error message. </p>\n\n<blockquote>\n  <p>{\"success\":false,\"message\":\"failed Error: Missing mspid parameter\"}</p>\n</blockquote>\n\n<p>I have also tried by adding mspid in the request but the error message is still same. What am I missing?</p>\n\n<p>Here are contents of ngo-connection-profile.yaml</p>\n\n<pre><code>channels:\n  mychannel:\n    orderers:\n      - orderer.com\n    peers:\n      peer1:\n        endorsingPeer: true\n        chaincodeQuery: true\n        ledgerQuery: true\n        eventSource: true\n&lt;pre&gt;&lt;code&gt;\norganizations:\n  Org1:\n    mspid:\n    peers:\n      - peer1\n    certificateAuthorities:\n      - ca-org1\norderers:\n  orderer.com:\n    url: grpcs://orderer.n-XDXDXDXDXDSXDSXDXSDXSDXDSXDSXDS.managedblockchain.us-east-1.amazonaws.com:30001\n    grpcOptions:\n      ssl-target-name-override: orderer.n-XDXDXDXDXDSXDSXDXSDXSDXDSXDSXDS.managedblockchain.us-east-1.amazonaws.com\n    tlsCACerts:\n      path: /opt/home/managedblockchain-tls-chain.pem\n&lt;/pre&gt;&lt;/code&gt;\npeers:\n  peer1:\n    url: grpcs://nd-NDNDNDNDNDNDNDNDNDNDND.m-AAAAAAAAAAAAAAAAAAAAAAAAA.n-XDXDXDXDXDSXDSXDXSDXSDXDSXDSXDS....\n    eventUrl: grpcs://nd-NDNDNDNDNDNDNDNDNDNDND.m-AAAAAAAAAAAAAAAAAAAAAAAAA.n-XDXDXDXDXDSXDSXDXSDXSDXDSXDSXDS.....\n    grpcOptions:\n      ssl-target-name-override: nd-NDNDNDNDNDNDNDNDNDNDND.m-AAAAAAAAAAAAAAAAAAAAAAAAA.n-XDXDXDXDXDSXDSXDXSDXSDXDSXDSXDS.xxx\n    tlsCACerts:\n      path: /opt/home/managedblockchain-tls-chain.pem\n\ncertificateAuthorities:\n  ca-org1:\n    url: https://ca.m-AAAAAAAAAAAAAAAAAAAAAAAAA.n-XDXDXDXDXDSXDSXDXSDXSDXDSXDSXDS....\n    httpOptions:\n      verify: false\n    tlsCACerts:\n      path: /opt/home/managedblockchain-tls-chain.pem\n    registrar:\n      - enrollId: aaaaaaaa\n        enrollSecret: XXXXXXXXXXX\n    caName: m-AAAAAAAAAAAAAAAAAAAAAAAAA\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 39296, "user_id": 560299, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c38fe465734e8428048585e0acf6174f?s=128&d=identicon&r=PG", "display_name": "Ibu", "link": "https://stackoverflow.com/users/560299/ibu"}, "is_accepted": false, "score": 3, "last_activity_date": 1548030152, "last_edit_date": 1548030152, "creation_date": 1547967393, "answer_id": 54274267, "question_id": 54274225, "link": "https://stackoverflow.com/questions/54274225/nested-struct-is-not-updated/54274267#54274267", "title": "Nested struct is not updated", "body": "<p>The problem is with your update function. You are supposed to add it to the pointer to A.</p>\n\n<pre><code>func (a *A) updateB(n int) {\n    a.b.c = n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2476, "user_id": 5788720, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tkE-8jM--HE/AAAAAAAAAAI/AAAAAAAAAEw/g51C7_m9JWU/photo.jpg?sz=128", "display_name": "Iain Duncan", "link": "https://stackoverflow.com/users/5788720/iain-duncan"}, "is_accepted": true, "score": 5, "last_activity_date": 1547967433, "creation_date": 1547967433, "answer_id": 54274271, "question_id": 54274225, "link": "https://stackoverflow.com/questions/54274225/nested-struct-is-not-updated/54274271#54274271", "title": "Nested struct is not updated", "body": "<p>It is because you are using a value receiver so the updateB method receives a copy of the value of <code>A</code> rather than a pointer to the memory that contains the <code>a</code> variable.  Using a pointer receiver fixes the problem:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype B struct {\n    c int\n}\n\ntype A struct {\n    b B\n}\n\nfunc (a *A) updateB(n int) {\n    a.b.c = n\n}\n\nfunc main() {\n    a := A{b: B{c: 5}}\n\n    fmt.Println(a)\n    a.updateB(42)\n    fmt.Println(a)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/XBrxd246qT3\" rel=\"noreferrer\">https://play.golang.org/p/XBrxd246qT3</a></p>\n\n<p>See also:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/27775376/value-receiver-vs-pointer-receiver-in-golang\">Value receiver vs. Pointer receiver in Golang?</a></p>\n"}, {"tags": [], "owner": {"reputation": 1025, "user_id": 7253829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qe9lZ.jpg?s=128&g=1", "display_name": "waymobetta", "link": "https://stackoverflow.com/users/7253829/waymobetta"}, "is_accepted": false, "score": 3, "last_activity_date": 1547968077, "last_edit_date": 1547968077, "creation_date": 1547967453, "answer_id": 54274272, "question_id": 54274225, "link": "https://stackoverflow.com/questions/54274225/nested-struct-is-not-updated/54274272#54274272", "title": "Nested struct is not updated", "body": "<p>It's not because the struct is nested, rather it's because you need a pointer receiver to modify the value to which the receiver points, in this case your <code>a</code> variable. </p>\n\n<p>Without the pointer your <code>UpdateB</code> method would only be updating a copy of the original A struct value.</p>\n\n<p>See the following:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype B struct {\n    c int\n}\n\ntype A struct {\n    b B\n}\n\nfunc (a *A) UpdateB(n int) {\n    a.b.c = n\n}\n\nfunc main() {\n    a := A{b: B{c: 5}}\n\n    fmt.Println(a)\n    a.UpdateB(50)\n    fmt.Println(a)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1948, "user_id": 8690313, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-hQ93tpA6Lmk/AAAAAAAAAAI/AAAAAAAAB2I/7F3CoNnnhts/photo.jpg?sz=128", "display_name": "Prajval M", "link": "https://stackoverflow.com/users/8690313/prajval-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1547967660, "creation_date": 1547967660, "answer_id": 54274288, "question_id": 54274225, "link": "https://stackoverflow.com/questions/54274225/nested-struct-is-not-updated/54274288#54274288", "title": "Nested struct is not updated", "body": "<p>For any interface for its objects to be updated by a function you need to pass the object by reference.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype B struct {\n    c int\n}\n\ntype A struct {\n    b B\n}\n\nfunc (a *A) updateB(n int) {\n    a.b.c = n\n}\n\nfunc main() {\n    a := A{b: B{c: 5}}\n\n    fmt.Println(a)\n    a.updateB(42)\n    fmt.Println(a)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/_o5sRApo6WP\" rel=\"nofollow noreferrer\">https://play.golang.org/p/_o5sRApo6WP</a></p>\n"}], "owner": {"reputation": 127, "user_id": 3647323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f06a55a047d1fecd72f7c445627a252e?s=128&d=identicon&r=PG&f=1", "display_name": "user3647323", "link": "https://stackoverflow.com/users/3647323/user3647323"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 817, "favorite_count": 0, "accepted_answer_id": 54274271, "answer_count": 4, "score": 3, "last_activity_date": 1548030152, "creation_date": 1547966787, "last_edit_date": 1547967094, "question_id": 54274225, "link": "https://stackoverflow.com/questions/54274225/nested-struct-is-not-updated", "title": "Nested struct is not updated", "body": "<p>I have a nested struct. I want to update it inside a method.\nFor some reason, the update doesn't take place. </p>\n\n<pre><code>    package main\n\n    import \"fmt\"\n\n    type B struct {\n        c int\n    }\n\n    type A struct {\n        b B\n    }\n\n    func (a A) updateB(n int) {\n        a.b.c = n\n    }\n\n    func main() {\n        a := A{b: B{c: 5}}\n\n        fmt.Println(a)\n        a.updateB(42)\n        fmt.Println(a)\n    }\n</code></pre>\n\n<p>The output I get is</p>\n\n<pre><code>{{5}}\n{{5}}\n</code></pre>\n\n<p>In most languages, I'd expect it to be updated. Is this some special Go behavior? How does one go about updating nested structs in Go?</p>\n"}, {"tags": ["ssl", "go", "nginx"], "answers": [{"comments": [{"owner": {"reputation": 160, "user_id": 10939550, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ES4poe3QDfw/AAAAAAAAAAI/AAAAAAAAAGM/N_FFVwf1DQ0/photo.jpg?sz=128", "display_name": "Aditya Diwakar", "link": "https://stackoverflow.com/users/10939550/aditya-diwakar"}, "edited": false, "score": 0, "creation_date": 1547999944, "post_id": 54274447, "comment_id": 95378321, "body": "This did not fix it, I am still experiencing an infinite redirects issue."}, {"owner": {"reputation": 784, "user_id": 10737552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee6d7fb0cd2e5fb9e1daa3282b25f876?s=128&d=identicon&r=PG&f=1", "display_name": "Billy Yuan", "link": "https://stackoverflow.com/users/10737552/billy-yuan"}, "reply_to_user": {"reputation": 160, "user_id": 10939550, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ES4poe3QDfw/AAAAAAAAAAI/AAAAAAAAAGM/N_FFVwf1DQ0/photo.jpg?sz=128", "display_name": "Aditya Diwakar", "link": "https://stackoverflow.com/users/10939550/aditya-diwakar"}, "edited": false, "score": 0, "creation_date": 1548035030, "post_id": 54274447, "comment_id": 95386943, "body": "It works for me. So how about check the difference between yours and mine? Or maybe there are other configs you did not show in the <code>nginx.conf.d</code> affect this issue."}, {"owner": {"reputation": 160, "user_id": 10939550, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ES4poe3QDfw/AAAAAAAAAAI/AAAAAAAAAGM/N_FFVwf1DQ0/photo.jpg?sz=128", "display_name": "Aditya Diwakar", "link": "https://stackoverflow.com/users/10939550/aditya-diwakar"}, "edited": false, "score": 0, "creation_date": 1548035202, "post_id": 54274447, "comment_id": 95386965, "body": "It appeared to be an issue with Cloudflare, I&#39;ve fixed those issues and everything seems to be resolved."}, {"owner": {"reputation": 160, "user_id": 10939550, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ES4poe3QDfw/AAAAAAAAAAI/AAAAAAAAAGM/N_FFVwf1DQ0/photo.jpg?sz=128", "display_name": "Aditya Diwakar", "link": "https://stackoverflow.com/users/10939550/aditya-diwakar"}, "edited": false, "score": 0, "creation_date": 1548035226, "post_id": 54274447, "comment_id": 95386970, "body": "Not to mention, your answer did also help so I&#39;ll mark it as the answer since there were two problems, you fixed the big one."}, {"owner": {"reputation": 784, "user_id": 10737552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee6d7fb0cd2e5fb9e1daa3282b25f876?s=128&d=identicon&r=PG&f=1", "display_name": "Billy Yuan", "link": "https://stackoverflow.com/users/10737552/billy-yuan"}, "reply_to_user": {"reputation": 160, "user_id": 10939550, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ES4poe3QDfw/AAAAAAAAAAI/AAAAAAAAAGM/N_FFVwf1DQ0/photo.jpg?sz=128", "display_name": "Aditya Diwakar", "link": "https://stackoverflow.com/users/10939550/aditya-diwakar"}, "edited": false, "score": 0, "creation_date": 1548036876, "post_id": 54274447, "comment_id": 95387193, "body": "Ah, It\u2019s ok. I got great pleasures when I saw my reputation growing up these days. Haaaa. That&#39;s my motivation to give help."}], "tags": [], "owner": {"reputation": 784, "user_id": 10737552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee6d7fb0cd2e5fb9e1daa3282b25f876?s=128&d=identicon&r=PG&f=1", "display_name": "Billy Yuan", "link": "https://stackoverflow.com/users/10737552/billy-yuan"}, "is_accepted": true, "score": 0, "last_activity_date": 1547969694, "creation_date": 1547969694, "answer_id": 54274447, "question_id": 54273638, "link": "https://stackoverflow.com/questions/54273638/running-go-server-behind-nginx-reverse-proxy-with-ssl/54274447#54274447", "title": "Running Go server behind Nginx Reverse Proxy with SSL", "body": "<p><code>server_name _;</code> matches server name that can not find matches.</p>\n\n<p>I have done that before.</p>\n\n<p>See my nginx config to proxy api backend:</p>\n\n<pre><code># ssl\nssl_certificate      /etc/nginx/cert/live/ybilly.com/fullchain.pem;\nssl_certificate_key  /etc/nginx/cert/live/ybilly.com/privkey.pem;\n\n# http to https\nserver {\n  listen 80 default_server;\n  listen [::]:80 default_server;\n  server_name ybilly.com www.ybilly.com *.ybilly.com;\n  return 301 https://$host$request_uri;\n}\n\n# api backend\nserver {\n  listen 443 ssl http2;\n  listen [::]:443 ssl http2;\n  server_name *.ybilly.com;\n\n  location / {\n    add_header Access-Control-Allow-Origin *;\n    add_header Access-Control-Allow-Methods 'GET, POST, OPTIONS';\n    add_header Access-Control-Allow-Headers 'DNT,X-Mx-ReqToken,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization';\n    proxy_set_header Host $host;\n    proxy_set_header X-Real-Ip $remote_addr;\n    proxy_set_header X-Forwarded-For $remote_addr;\n    proxy_pass_header Set-Cookie;\n    proxy_read_timeout                 900;\n    proxy_buffers 32 4k;\n    proxy_pass http://127.0.0.1:8080/;\n  }\n\n}\n\n</code></pre>\n"}], "owner": {"reputation": 160, "user_id": 10939550, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ES4poe3QDfw/AAAAAAAAAAI/AAAAAAAAAGM/N_FFVwf1DQ0/photo.jpg?sz=128", "display_name": "Aditya Diwakar", "link": "https://stackoverflow.com/users/10939550/aditya-diwakar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 607, "favorite_count": 0, "accepted_answer_id": 54274447, "answer_count": 1, "score": 0, "last_activity_date": 1547969694, "creation_date": 1547959401, "question_id": 54273638, "link": "https://stackoverflow.com/questions/54273638/running-go-server-behind-nginx-reverse-proxy-with-ssl", "title": "Running Go server behind Nginx Reverse Proxy with SSL", "body": "<p>I've done some digging through the interwebs and haven't been able to come across anything similar (at least near any solution that has worked out for me).</p>\n\n<p>Essentially, I am running a Golang server locally on <code>127.0.0.1:1337</code>, I want this to be accessible globally so I use Nginx to forward traffic from <code>https://api.example.com/</code> to my API to retrieve information.</p>\n\n<p>With that being said, I have simply setup my Golang server to listen and serve on port <strong><code>1337</code></strong> and my Nginx configuration is setup to redirect all HTTP traffic (for all domains) to HTTPS:</p>\n\n<pre><code>server {\n    listen 80 default_server;\n\n    server_name _; \n    return 301 https://$host$request_uri;\n}\n</code></pre>\n\n<p>and then I redirect traffic to port 1337 here:</p>\n\n<pre><code>server {\n    server_name api.example.com;\n    location / {\n        proxy_pass http://127.0.0.1:1337;\n    }\n\n    listen 443 ssl;\n    ssl_certificate_key /etc/nginx/ssl/private.key;\n    ssl_certificate /etc/nginx/ssl/cert.crt;   \n}\n</code></pre>\n\n<p>The issue with this is that I find myself to keep getting redirects from HTTPS to HTTP (as per <em>wget</em>) and I end up getting a <code>Too Many Redirects</code> error.</p>\n\n<p>If anyone can provide some guidance, I'd very much appreciate it!</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 589, "user_id": 1754404, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/rKTUu.jpg?s=128&g=1", "display_name": "Philipp", "link": "https://stackoverflow.com/users/1754404/philipp"}, "edited": false, "score": 0, "creation_date": 1616876630, "post_id": 54273818, "comment_id": 118142455, "body": "Just struggled with this problem myself for almost 2hrs... Really confusing, especially since you don&#39;t even see this option when creating a resource."}], "tags": [], "owner": {"reputation": 71, "user_id": 9535264, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Philip Knox", "link": "https://stackoverflow.com/users/9535264/philip-knox"}, "is_accepted": false, "score": 4, "last_activity_date": 1547961732, "creation_date": 1547961732, "answer_id": 54273818, "question_id": 54273355, "link": "https://stackoverflow.com/questions/54273355/having-issues-with-golang-and-aws-apigatewayproxyrequest-not-being-populated/54273818#54273818", "title": "Having issues with GoLang and AWS APIGatewayProxyRequest not being populated", "body": "<p>Found the reason/fix... In the API Gateway setup I had not turned on the 'Use Lambda Proxy integration' flag. Without this it seems AWS will not forward the request information down go figure. </p>\n"}], "owner": {"reputation": 71, "user_id": 9535264, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Philip Knox", "link": "https://stackoverflow.com/users/9535264/philip-knox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 572, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1547961732, "creation_date": 1547955054, "question_id": 54273355, "link": "https://stackoverflow.com/questions/54273355/having-issues-with-golang-and-aws-apigatewayproxyrequest-not-being-populated", "title": "Having issues with GoLang and AWS APIGatewayProxyRequest not being populated", "body": "<p>Been at this for a few hours now. No matter what i try the request.HTTPMethod is coming over as \"\". Code is posted below. I started off with examples off posts online then just went from complex to something simple and still not getting why the request is coming over as black all the time... Any help would be greatly appreciated. Thanks</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n\n    \"github.com/aws/aws-lambda-go/events\"\n    \"github.com/aws/aws-lambda-go/lambda\"\n)\n\nfunc Handler(ctx context.Context, request events.APIGatewayProxyRequest) (events.APIGatewayProxyResponse, error) {\n    if request.HTTPMethod == \"POST\" {\n        return events.APIGatewayProxyResponse{Body: \"yepp\", StatusCode: 200}, nil\n    }\n\n    return events.APIGatewayProxyResponse{Body: \"nope\", StatusCode: 200}, nil\n}\n\nfunc main() {\n    lambda.Start(Handler)\n}\n</code></pre>\n"}, {"tags": ["json", "go", "unmarshalling", "utf"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1547937328, "post_id": 54271767, "comment_id": 95366712, "body": "It looks like the text contains invalid JSON escape sequences.  That&#39;s different from containing non utf8 text.  It&#39;s unclear what you want to remove.  Is it sufficient to remove the backslash, the backslash and following character, or something else?  Give examples of the source string and the string you want to convert it to.   To avoid confusion, describe the format of the strings.  For example, are they printed with fmt.Sprintf(&quot;%s&quot;, s), fmt.Sprintf(&quot;%q&quot;, s) or something else?"}, {"owner": {"reputation": 69, "user_id": 7183492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8557fb6dc0d0c0d3c7eaf183f58cb09?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/7183492/steve"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1547937786, "post_id": 54271767, "comment_id": 95366787, "body": "I think they are these characters (from a list of c# escape characters) that are part of the string received from the output of idevicesyslog (<a href=\"https://github.com/libimobiledevice/libimobiledevice/blob/master/docs/idevicesyslog.1\" rel=\"nofollow noreferrer\">github.com/libimobiledevice/libimobiledevice/blob/master/do&zwnj;&#8203;cs/&hellip;</a>)  I do not control the printing of the string but rather filter out the logs i want from idevicesyslog / adb logcat. Examples i&#39;ve seen are \\047 single quote \\134 backslash \\140 grave accent"}, {"owner": {"reputation": 69, "user_id": 7183492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8557fb6dc0d0c0d3c7eaf183f58cb09?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/7183492/steve"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1547938161, "post_id": 54271767, "comment_id": 95366878, "body": "as libimobiledevice is written in &quot;c&quot; they use &quot;fprintf&quot; or &quot;fflush&quot; i believe"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1547938252, "post_id": 54271767, "comment_id": 95366894, "body": "In the case of &quot;\\047&quot;, does the string contain the bytes 92, 48, 52, 55?  Is your goal to replace these four bytes with the single byte 47 (single quote)?"}, {"owner": {"reputation": 69, "user_id": 7183492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8557fb6dc0d0c0d3c7eaf183f58cb09?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/7183492/steve"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1547938416, "post_id": 54271767, "comment_id": 95366928, "body": "My goal is to replace them with characters that do not cause unmarshalling errors.  So i guess replacing them all with empty string. However, I wasn&#39;t sure if there was a built in package to do this. Otherwise, I have to compile a list and do a search and replace on each log that contains &quot;these characters&quot;. If i compile the list myself that is prone to errors as I don&#39;t know all that exist."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1547938721, "post_id": 54271767, "comment_id": 95366983, "body": "The problem is invalid escape sequences, not invalid characters. It seems like your goal is to convert the escaping from whatever produced this text to valid JSON escape sequences.  There are no invalid characters in the test shown in the question."}, {"owner": {"reputation": 69, "user_id": 7183492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8557fb6dc0d0c0d3c7eaf183f58cb09?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/7183492/steve"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1547938843, "post_id": 54271767, "comment_id": 95367017, "body": "Yes, that seems right.  The error I get is &quot;panic: invalid character &#39;\\134&#39; in string escape code&quot; when unmarshaling to json. I convert the string to a []byte and unmarshal:      \t<code>err = json.Unmarshal([]byte(s), &amp;metadataMap)</code>"}, {"owner": {"reputation": 2422, "user_id": 2622394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d36f32e6280af5bb307cead90e3844f?s=128&d=identicon&r=PG", "display_name": "lmars", "link": "https://stackoverflow.com/users/2622394/lmars"}, "edited": false, "score": 1, "creation_date": 1547939393, "post_id": 54271767, "comment_id": 95367144, "body": "If the escapes were all like <code>\\nnn</code> (i.e. C-like octal escapes) then I&#39;d suggest using a regex replace of a backslash followed by three digits, but the presence of <code>\\M</code> means that won&#39;t work for all strings, and in fact that isn&#39;t a standard escape that I&#39;ve come across, so you may need to just maintain a list of escapes you need to replace."}, {"owner": {"reputation": 69, "user_id": 7183492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8557fb6dc0d0c0d3c7eaf183f58cb09?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/7183492/steve"}, "edited": false, "score": 0, "creation_date": 1547939609, "post_id": 54271767, "comment_id": 95367189, "body": "Yeah, this conversation with you both has been helpful and I&#39;m thinking that what I dreaded (e.g. keeping track and replacing each) is what I will need to do.  Either that or rewrite these open source device loggers in go.  Currently using something like this (when \\134 was the only one causing problems):  <code>func replaceSpChar(s string) string {  \tvar jsonStr = s  \tspecialChar := strings.Contains(jsonStr, </code>\\134<code>)  \tif specialChar { \t\tjsonStr = strings.Replace(jsonStr, </code>\\134<code>, &quot;&quot;, -1) \t}  \treturn jsonStr }</code>  would just need to create a list of all."}, {"owner": {"reputation": 69, "user_id": 7183492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8557fb6dc0d0c0d3c7eaf183f58cb09?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/7183492/steve"}, "edited": false, "score": 0, "creation_date": 1547940322, "post_id": 54271767, "comment_id": 95367342, "body": "I think maybe just replacing all &quot;\\&quot; with &quot;\\\\&quot; might be realistic as well:  <code>strings.Replace(str, &quot;\\\\&quot;, &quot;\\\\\\\\&quot;, -1)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 7183492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8557fb6dc0d0c0d3c7eaf183f58cb09?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/7183492/steve"}, "edited": false, "score": 0, "creation_date": 1547944688, "post_id": 54272508, "comment_id": 95368045, "body": "Nice. Thanks!  One thing I noticed is that the majority of these &quot;octal escapes&quot; occur with url data.   e.g.  &quot;https:\\134/\\134/foo.net\\134/i\\134/bar\\134/foo\\134/bar\\134/m&zwnj;&#8203;3u8\\134/300\\134/mast&zwnj;&#8203;er.m3u8&quot;"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 69, "user_id": 7183492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8557fb6dc0d0c0d3c7eaf183f58cb09?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/7183492/steve"}, "edited": false, "score": 0, "creation_date": 1547946317, "post_id": 54272508, "comment_id": 95368225, "body": "@Steve The source application is escaping forward slash for some reason. That&#39;s not needed.  Use regexp <code>`\\\\134&#47;`</code> and replace with <code>&quot;&#47;&quot;</code> to fix this."}, {"owner": {"reputation": 69, "user_id": 7183492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8557fb6dc0d0c0d3c7eaf183f58cb09?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/7183492/steve"}, "edited": false, "score": 0, "creation_date": 1548179929, "post_id": 54272508, "comment_id": 95447882, "body": "Was able to find issue here: <a href=\"https://github.com/flutter/flutter/issues/10218\" rel=\"nofollow noreferrer\">github.com/flutter/flutter/issues/10218</a>  Possible solutioning (although in dart): <a href=\"https://github.com/flutter/flutter/pull/14075/files\" rel=\"nofollow noreferrer\">github.com/flutter/flutter/pull/14075/files</a>"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 69, "user_id": 7183492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8557fb6dc0d0c0d3c7eaf183f58cb09?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/7183492/steve"}, "edited": false, "score": 0, "creation_date": 1548180606, "post_id": 54272508, "comment_id": 95448150, "body": "The Dart code has good documentation on the format you are dealing with and should be easy to translate to Go."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 1, "last_activity_date": 1547943364, "creation_date": 1547943364, "answer_id": 54272508, "question_id": 54271767, "link": "https://stackoverflow.com/questions/54271767/best-way-to-strip-invalid-json-characters-from-json-like-string-before-unmarshal/54272508#54272508", "title": "Best way to strip invalid json characters from json like string before unmarshal", "body": "<p>Use a regexp to replace the invalid octal escape sequences with a space:</p>\n\n<pre><code>var octalEscapePat = regexp.MustCompile(`\\\\[0-7]{3}`)\n\nfunc fix(src string) string {\n    return octalEscapePat.ReplaceAllString(src, \" \")\n}\n</code></pre>\n\n<p>You can also parse the octal value and convert to a valid JSON escape sequence:</p>\n\n<pre><code>func fix(src string) string {\n    return octalEscapePat.ReplaceAllStringFunc(src, func(s string) string {\n        // Parse octal value\n        n, _ := strconv.ParseInt(s[1:], 8, 0)\n        // Convert to string and marshal to JSON to handle any escaping\n        b, _ := json.Marshal(string(n))\n        // return string with surrounding quotes removed\n        return string(b[1 : len(b)-1])\n    })\n}\n</code></pre>\n\n<p>The \\M can be handled in a similar way.</p>\n\n<p><a href=\"https://play.golang.org/p/-gtxrvnBSrx\" rel=\"nofollow noreferrer\">https://play.golang.org/p/-gtxrvnBSrx</a></p>\n"}], "owner": {"reputation": 69, "user_id": 7183492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8557fb6dc0d0c0d3c7eaf183f58cb09?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/7183492/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 987, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1582491971, "creation_date": 1547935226, "last_edit_date": 1582491971, "question_id": 54271767, "link": "https://stackoverflow.com/questions/54271767/best-way-to-strip-invalid-json-characters-from-json-like-string-before-unmarshal", "title": "Best way to strip invalid json characters from json like string before unmarshal", "body": "<p>To give some background, I am reading device logs from android and ios devices using adb logcat and idevicesyslog.  The specific logs I am after are swift/c#/java/etc dictionaries converted to strings via adb logcat / idevicesyslog.  I hope to take these logs that contain JSON like strings and convert those to valid JSON.  This works for the most part no problem.</p>\n\n<p>However, sometimes these logs/string outputs contain characters like (\\134, \\M, \\t, etc etc) that cause issues when unmarshalling into JSON.  I unmarshal them to JSON to send them elsewhere.</p>\n\n<p>For example a raw device log may have something like the following:\n{\"foo\":\"bar\",\"foo\":\"bar\\134/\\134/bar\\134/bar\\134/bar\"}\n{\"foo\":\"bar\",\"foo\":\"bar\\M/\\134/bar\\134/bar\\M/bar\"}</p>\n\n<p>These result in errors like \"panic: invalid character 'M' in string escape code\" when attempting to unmarshal</p>\n\n<p>The majority of logs do not contain these characters and so it's not a problem. However, a few edge cases contain these and it creates problems.</p>\n\n<p>Is there a proper name for these types of characters? (c# escape characters?) Is there a golang package that can remove them from a string?  Currently, I am just deleting the specific ones i come across if they appear in a string but I feel like there's a better way to do it. Adding the ones I come across to a list of deletable characters is not a good practice.</p>\n\n<p>To summarize,</p>\n\n<p>idevicesyslog log gives me a string like so:\n{\"foo\":\"bar\",\"foo\":\"bar\\134/\\134/bar\\134/bar\\134/bar\"}</p>\n\n<p>This can not be unmarshalled.</p>\n\n<p>idevicesyslog log gives me a string like so:\n{\"foo\":\"bar\",\"foo\":\"bar bar bar bar\"}</p>\n\n<p>This can be unmarshalled.</p>\n\n<p>Current solution: add new ones I come across to a list and remove them before unmarshaling</p>\n\n<p>Hopeful solution: detect automatically and remove</p>\n"}, {"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1547933790, "post_id": 54271525, "comment_id": 95365982, "body": "The equivalent go code is nearly identical, but your example isn\u2019t in the context of a function call. To swap a pointer value you need a pointer to the pointer."}, {"owner": {"reputation": 153, "user_id": 10503992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/270bd9b3c5d2f936d2a9f6565d4b7151?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/10503992/michael"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1547934262, "post_id": 54271525, "comment_id": 95366108, "body": "Hi mate, thanks - I&#39;ve run the below: tempPtr := &amp;newConfig; config = tempPtr; which now does the correct swap within the function, but outside of the function it will still print the old version - am I doing this incorrectly? thanks"}, {"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1547934960, "post_id": 54271525, "comment_id": 95366257, "body": "<code>*config = newConfig</code> also should work"}, {"owner": {"reputation": 153, "user_id": 10503992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/270bd9b3c5d2f936d2a9f6565d4b7151?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/10503992/michael"}, "edited": false, "score": 0, "creation_date": 1547935316, "post_id": 54271525, "comment_id": 95366334, "body": "Makes sense. Reading your comment, yes, I&#39;ve think I&#39;ve over-complicated this and not thought just to call &#39;LoadFromFile&#39; again on my config, which works exactly as I intended. Thanks for your help."}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1547980441, "post_id": 54271525, "comment_id": 95373219, "body": "In short change <code>config = &amp;newConfig;</code> to <code>*config = newConfig;</code> and it works."}], "answers": [{"tags": [], "owner": {"reputation": 2422, "user_id": 2622394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d36f32e6280af5bb307cead90e3844f?s=128&d=identicon&r=PG", "display_name": "lmars", "link": "https://stackoverflow.com/users/2622394/lmars"}, "is_accepted": false, "score": 1, "last_activity_date": 1547935384, "creation_date": 1547935384, "answer_id": 54271782, "question_id": 54271525, "link": "https://stackoverflow.com/questions/54271525/go-pointer-swap-issue/54271782#54271782", "title": "Go pointer swap issue", "body": "<p>I suggest putting the actual config values in a field on the <code>Config</code> struct which is mutated under the lock, rather than mutating the <code>Config</code> pointer, because as you are encountering callers of the method will still have a reference to the old pointer.</p>\n\n<p>For example:</p>\n\n<pre><code>type Config struct {\n    values map[string]interface{} // or whatever is appropriate for your config\n    lock   sync.RWMutex\n}\n\nfunc (c *Config) Get(k string) (interface{}, bool) {\n    c.lock.RLock()\n    defer c.lock.RUnlock()\n    v, ok := c.values[k]\n    return v, ok\n}\n\nfunc (c *Config) Reload(path string) error {\n    newConfig, err := LoadFromFile(path)\n    if err != nil {\n        return err\n    }\n    c.lock.Lock()\n    defer c.lock.Unlock()\n    c.values = newConfig.values\n    return nil\n}\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 10503992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/270bd9b3c5d2f936d2a9f6565d4b7151?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/10503992/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547935384, "creation_date": 1547933143, "question_id": 54271525, "link": "https://stackoverflow.com/questions/54271525/go-pointer-swap-issue", "title": "Go pointer swap issue", "body": "<p>I'm trying to swap the pointer for a struct in Go, running in a function that is attached to it:</p>\n\n<pre><code>func ( config *Config ) ReLoadConfigFile( configPath string ) error {\nif ( len( configPath ) &gt; 0 ) {\n    newConfig := Config{};\n    err := newConfig.LoadFromFile( configPath );\n\n    //Swap the configs, ensuring to lock the config for the swap\n    if ( err == nil ) {\n        config.Lock.Lock( );\n        defer config.Lock.Unlock( );\n        config = &amp;newConfig;\n    } else {\n        errorString := \"Unable To Reload Config At Path: \" + configPath;\n        return fmt.Errorf( errorString );\n    }\n} else {\n    return fmt.Errorf( \"No Config Given To Reload\" );\n}\nreturn nil;\n</code></pre>\n\n<p>}</p>\n\n<p>I've added a couple of prints in, both inside this function for config and newConfig as well as the same pointer outside the function, however it does not appear that the pointer swap is working correctly, as config and the print outside the function still print the previous version, rather than newConfig that it is my understanding I am changing the pointer too.</p>\n\n<p>I'm pretty new to Go, just to check I'm not going mad I've recreated the same thing in Cpp and it works:</p>\n\n<pre><code>int *Temp1 = NULL;\nint Temp2 = 123456;\n\nTemp1 = &amp;Temp2;\n</code></pre>\n\n<p>Where it will make Temp1 the value 123456 (data of Temp2). Could someone please let me know where I'm going wrong in my Go code?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["http", "go", "curl", "cookies"], "comments": [{"owner": {"reputation": 2422, "user_id": 2622394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d36f32e6280af5bb307cead90e3844f?s=128&d=identicon&r=PG", "display_name": "lmars", "link": "https://stackoverflow.com/users/2622394/lmars"}, "edited": false, "score": 0, "creation_date": 1547932662, "post_id": 54271413, "comment_id": 95365749, "body": "I recommend checking that the first request actually succeeds and returns cookies. You should also consider using the net/http/cookiejar package:  <a href=\"https://golang.org/pkg/net/http/cookiejar/\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/cookiejar</a>"}, {"owner": {"reputation": 11, "user_id": 8911233, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oLVl1kMdPCo/AAAAAAAAAAI/AAAAAAAAAF4/OlwQW6TkJFE/photo.jpg?sz=128", "display_name": "Cain A", "link": "https://stackoverflow.com/users/8911233/cain-a"}, "reply_to_user": {"reputation": 2422, "user_id": 2622394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d36f32e6280af5bb307cead90e3844f?s=128&d=identicon&r=PG", "display_name": "lmars", "link": "https://stackoverflow.com/users/2622394/lmars"}, "edited": false, "score": 0, "creation_date": 1547933894, "post_id": 54271413, "comment_id": 95366018, "body": "@Imars I checked, it does that. But I removed it from the code so as not to overload the question."}, {"owner": {"reputation": 2422, "user_id": 2622394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d36f32e6280af5bb307cead90e3844f?s=128&d=identicon&r=PG", "display_name": "lmars", "link": "https://stackoverflow.com/users/2622394/lmars"}, "edited": false, "score": 1, "creation_date": 1547934351, "post_id": 54271413, "comment_id": 95366138, "body": "Ok, I suggest using net/http/cookiejar to reduce the chance that your code is doing the wrong thing. Here is an example: <a href=\"https://golang.org/pkg/net/http/cookiejar/#example_New\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/cookiejar/#example_New</a>"}, {"owner": {"reputation": 11, "user_id": 8911233, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oLVl1kMdPCo/AAAAAAAAAAI/AAAAAAAAAF4/OlwQW6TkJFE/photo.jpg?sz=128", "display_name": "Cain A", "link": "https://stackoverflow.com/users/8911233/cain-a"}, "reply_to_user": {"reputation": 2422, "user_id": 2622394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d36f32e6280af5bb307cead90e3844f?s=128&d=identicon&r=PG", "display_name": "lmars", "link": "https://stackoverflow.com/users/2622394/lmars"}, "edited": false, "score": 0, "creation_date": 1547936824, "post_id": 54271413, "comment_id": 95366645, "body": "@Imars cookiejar example works fine for me, thanks!"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1547995351, "post_id": 54271413, "comment_id": 95376995, "body": "Aside: you are not encoding the form values. Use <a href=\"https://golang.org/pkg/net/url/#Values\" rel=\"nofollow noreferrer\">url.Values</a> to build the request body correctly."}], "owner": {"reputation": 11, "user_id": 8911233, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oLVl1kMdPCo/AAAAAAAAAAI/AAAAAAAAAF4/OlwQW6TkJFE/photo.jpg?sz=128", "display_name": "Cain A", "link": "https://stackoverflow.com/users/8911233/cain-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 286, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1547932205, "creation_date": 1547932205, "question_id": 54271413, "link": "https://stackoverflow.com/questions/54271413/whats-difference-between-curl-and-my-go-requests", "title": "What&#39;s difference between cURL and my Go requests?", "body": "<p>I'm tryin to repeat a few http requests, that were performed using cURL, with Go.</p>\n\n<p>In first request I'm getting cookie named \"yandexuid\":</p>\n\n<pre><code>$ curl --cookie-jar jar --output /dev/null \\\nhttps://oauth.yandex.ru/...&amp;client_id=ID\n</code></pre>\n\n<p>Then I do POST with authentication data:</p>\n\n<pre><code>$ curl -v --cookie jar --cookie-jar jar \\\n    --data 'login=LOGIN' \\\n    --data 'passwd=PASS' \\\n    --data 'twoweeks=no' \\\n    --data 'retpath=https://oauth.yandex.ru/...type=token' \\\n    https://passport.yandex.ru/auth?...&amp;mode=qr\n</code></pre>\n\n<p>It returns many new cookies that will be used on the next step.</p>\n\n<p>When I trying to do it with Go, first part works fine: cookie \"yandexuid\" comes and I attach it to next request. But second request don't returns cookies. Server respond's me with redirect page where it says: \"<I>Request processing error. An error has occurred. To log in to Yandex correctly, you need to enable cookies in your browser settings.</I>\"</p>\n\n<p>My Go code:</p>\n\n<pre><code>type Client struct {\n    HTTPClient      *http.Client\n    CookieJar       []http.Cookie\n}\n\nfunc (c* Client) AddCookies(cookies []*http.Cookie) {\n    for _, f := range cookies {\n        c.CookieJar = append(c.CookieJar, *f)\n    }\n}\n\nfunc (c *Client) Request(method string, request string, body io.Reader) *http.Response {\n    req, err := http.NewRequest(method, request, body)\n\n    for _, f := range c.CookieJar {\n         req.AddCookie(&amp;f) //attach cookies saving in Client structure\n    }\n\n    req.Header.Set(\"X-Org-id\", CompanyID)\n    req.Header.Set(\"Cache-Control\", \"no-cache\")\n\n    resp, err := c.HTTPClient.Do(req)\n    return resp\n}\n\nfunc main() {\n    // first request\n    _url := fmt.Sprintf(https://oauth.yandex.ru/...&amp;client_id=%s, ClientID)\n    resp := c.Request(\"GET\", _url, nil)\n    c.AddCookies(resp.Cookies()) // getting cookies from respond and saving it in Client structure\n\n    // second request\n    PostData := strings.NewReader(\"login=\"+email+\"&amp;passwd=\"+pass+\"&amp;twoweeks=no&amp;retpath=https://oauth.yandex.ru/...type=token\")\nresp = c.Request(\"POST\", \"https://passport.yandex.ru/auth?...&amp;mode=qr\", PostData) \n}\n</code></pre>\n\n<p>What's difference between cURL and my Go requests? I know I do something wrong with cookies and as a result server think user's browser not saving cookies.</p>\n"}, {"tags": ["go", "curl", "graphql"], "answers": [{"comments": [{"owner": {"reputation": 2422, "user_id": 2622394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d36f32e6280af5bb307cead90e3844f?s=128&d=identicon&r=PG", "display_name": "lmars", "link": "https://stackoverflow.com/users/2622394/lmars"}, "reply_to_user": {"reputation": 67098, "user_id": 1235698, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90fd9ad4efef8eb93209f42183c48f3e?s=128&d=identicon&r=PG", "display_name": "Marcin Orlowski", "link": "https://stackoverflow.com/users/1235698/marcin-orlowski"}, "edited": false, "score": 1, "creation_date": 1547935498, "post_id": 54271547, "comment_id": 95366374, "body": "The payload is JSON, so why would you need to urlencode the double quotes?"}, {"owner": {"reputation": 525, "user_id": 1291530, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/syHq5.png?s=128&g=1", "display_name": "nusantara", "link": "https://stackoverflow.com/users/1291530/nusantara"}, "edited": false, "score": 0, "creation_date": 1547936030, "post_id": 54271547, "comment_id": 95366469, "body": "@Imars Following your suggestion, I passed this in: <code>&quot;mutation { createScreenshot(input: { id:\\&quot;12345\\&quot; username: \\&quot;Odour\\&quot; url:\\&quot;google.com\\&quot; description:\\&quot;a screenshot\\&quot; filename:\\&quot;testname\\&quot; }) }&quot;</code> But I got this: <code>{&quot;errors&quot;:[{&quot;message&quot;:&quot;Field \\&quot;createScreenshot\\&quot; of type \\&quot;Screenshot!\\&quot; must have a selection of subfields. Did you mean \\&quot;createScreenshot { ... }\\&quot;?&quot;,&quot;locations&quot;:[{&quot;line&quot;:1,&quot;column&quot;:12}]}],&quot;data&quot;:null}</code>. Also tried commas in between them, and then each field in its own braces. Still wrong. How do I pass in multiple fields?"}, {"owner": {"reputation": 2422, "user_id": 2622394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d36f32e6280af5bb307cead90e3844f?s=128&d=identicon&r=PG", "display_name": "lmars", "link": "https://stackoverflow.com/users/2622394/lmars"}, "edited": false, "score": 1, "creation_date": 1547937848, "post_id": 54271547, "comment_id": 95366801, "body": "The input values are fine the way you are specifying them, but as indicated by the error, you need to select some fields on the return value from <code>createScreenshot</code> which is what the <code>{ id }</code> part of my example query is doing to select the ID of the resulting Screenshot. So it should be something like: <code>mutation { createScreenshot(input: { ... }) { id } }</code>"}, {"owner": {"reputation": 525, "user_id": 1291530, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/syHq5.png?s=128&g=1", "display_name": "nusantara", "link": "https://stackoverflow.com/users/1291530/nusantara"}, "edited": false, "score": 0, "creation_date": 1547938003, "post_id": 54271547, "comment_id": 95366840, "body": "Oh, right! I thought that was optional. Thank you so much! @Imars"}, {"owner": {"reputation": 13024, "user_id": 5276797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fad4546242573f7961ec20dd6ee6875?s=128&d=identicon&r=PG&f=1", "display_name": "IanS", "link": "https://stackoverflow.com/users/5276797/ians"}, "edited": false, "score": 0, "creation_date": 1586891988, "post_id": 54271547, "comment_id": 108294726, "body": "Is there an easy way to send more complex queries than the example you showed? After a while it gets difficult to put the entire query string on one line..."}], "tags": [], "owner": {"reputation": 2422, "user_id": 2622394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d36f32e6280af5bb307cead90e3844f?s=128&d=identicon&r=PG", "display_name": "lmars", "link": "https://stackoverflow.com/users/2622394/lmars"}, "is_accepted": true, "score": 12, "last_activity_date": 1547933265, "creation_date": 1547933265, "answer_id": 54271547, "question_id": 54271405, "link": "https://stackoverflow.com/questions/54271405/what-is-the-correct-shape-of-a-curl-post-request-to-a-gqlgen-graphql-api/54271547#54271547", "title": "What is the correct shape of a curl POST request to a gqlgen GraphQL API?", "body": "<p>The value of <code>query</code> in the JSON payload needs to be a string containing the GraphQL query, not an object like you are using, for example:</p>\n\n<pre><code>$ curl \\\n  -H \"Content-Type: application/json\" \\\n  -d '{ \"query\": \"mutation { createScreenshot(input: { username: \\\"Odour\\\" }) { id } }\" }' \\\n  http://localhost:8080/query\n</code></pre>\n\n<p>Note that you need to escape the double quotes within the query string.</p>\n"}], "owner": {"reputation": 525, "user_id": 1291530, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/syHq5.png?s=128&g=1", "display_name": "nusantara", "link": "https://stackoverflow.com/users/1291530/nusantara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3137, "favorite_count": 1, "accepted_answer_id": 54271547, "answer_count": 1, "score": 3, "last_activity_date": 1547933265, "creation_date": 1547932114, "question_id": 54271405, "link": "https://stackoverflow.com/questions/54271405/what-is-the-correct-shape-of-a-curl-post-request-to-a-gqlgen-graphql-api", "title": "What is the correct shape of a curl POST request to a gqlgen GraphQL API?", "body": "<p>I built a simple GraphQL API extremely similar to gqlgen's \"<a href=\"https://gqlgen.com/getting-started/\" rel=\"nofollow noreferrer\">Getting Started</a>\" tutorial. I can query it successfully with curl. But I can't get the curl request for mutation right.</p>\n\n<p>schema.graphql:</p>\n\n<pre><code>type Screenshot {\n  id: ID!\n  url: String!\n  filename: String!\n  username: String!\n  description: String\n}\n\ninput NewScreenshot {\n  id: ID!\n  url: String!\n  filename: String!\n  username: String!\n  description: String\n}\n\ntype Mutation {\n  createScreenshot(input: NewScreenshot!): Screenshot!\n  deleteScreenshot(id: ID!): String!\n}\n\ntype Query {\n  screenShots(username: String!): [Screenshot!]!\n}\n</code></pre>\n\n<p>models_gen.go:</p>\n\n<pre><code>type NewScreenshot struct {\n    ID          string  `json:\"id\"`\n    URL         string  `json:\"url\"`\n    Filename    string  `json:\"filename\"`\n    Username    string  `json:\"username\"`\n    Description *string `json:\"description\"`\n}\n\ntype Screenshot struct {\n    ID          string  `json:\"id\"`\n    URL         string  `json:\"url\"`\n    Filename    string  `json:\"filename\"`\n    Username    string  `json:\"username\"`\n    Description *string `json:\"description\"`\n}\n</code></pre>\n\n<p>resolver.go:</p>\n\n<pre><code>func (r *mutationResolver) CreateScreenshot(ctx context.Context, input NewScreenshot) (Screenshot, error) {\n    id, err := uuid.NewV4()\n    shot := Screenshot{\n        ID:          id.String(),\n        Description: input.Description,\n        URL:         input.URL,\n        Filename:    input.Filename,\n        Username:    input.Username,\n    }\n\n    return shot, nil\n}\n</code></pre>\n\n<p>I've tried:</p>\n\n<ul>\n<li><p>Going through the gqlgen <a href=\"https://gqlgen.com/getting-started/\" rel=\"nofollow noreferrer\">documentation</a>, the <a href=\"https://graphql.org/learn/schema/\" rel=\"nofollow noreferrer\">GraphQL schema</a>, <a href=\"https://www.howtographql.com/\" rel=\"nofollow noreferrer\">How to GraphQL</a>, and several examples like <a href=\"https://hackernoon.com/graphql-with-golang-6e8da2054c25\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://blog.apollographql.com/4-simple-ways-to-call-a-graphql-api-a6807bcdb355\" rel=\"nofollow noreferrer\">this</a>. And 1.5 days' worth of googling.</p></li>\n<li><p>Permutating through a lot, a lot of different shapes in my curl request. This one seems the closest:</p>\n\n<pre><code>curl -v http://localhost:8080/query\n-H \"Content-Type: application/json\"\n-d '{ \"query\":\n    { \"createScreenshot\":\n        {\"username\": \"Odour\",\n         \"url\": \"google.com\",\n         \"description\": \"just another screenshot\",\n         \"filename\": \"testimage\"\n        }\n    }\n}'\n</code></pre>\n\n<p>But it fails with:</p>\n\n<pre><code>* timeout on name lookup is not supported\n*   Trying ::1...\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                             Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0* Connected to localhost (::1) port 8080 (#0)\n&gt; POST /query HTTP/1.1\n&gt; Host: localhost:8080\n&gt; User-Agent: curl/7.47.1\n&gt; Accept: */*\n&gt; Content-Type: application/json\n&gt; Content-Length: 146\n&gt;\n} [146 bytes data]\n* upload completely sent off: 146 out of 146 bytes\n&lt; HTTP/1.1 400 Bad Request\n&lt; Date: Sat, 19 Jan 2019 21:00:15 GMT\n&lt; Content-Length: 149\n&lt; Content-Type: text/plain; charset=utf-8\n&lt;\n{ [149 bytes data]\n100   295  100   149  100   146    149    146  0:00:01 --:--:--  0:00:01  145k{\"errors\":[{\"message\":\"json body could not be decoded: json: cannot unmarshal object into Go struct field params.query of type string\"}],\"data\":null}\n* Connection #0 to host localhost left intact\n</code></pre></li>\n</ul>\n\n<p>Help?</p>\n"}, {"tags": ["go", "uuid", "sha1"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1547919518, "post_id": 54269497, "comment_id": 95362262, "body": "A Version 4 UUID, which you are using, has 122 random bits. SHA1 produces a 160-bit hash. So, on the surface, SHA1 has a lower collision probability. But since hashing has a chance of introducing collisions, regardless of bit length, you are probably increasing the chance of collision, imperceptibly."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1547920030, "post_id": 54269497, "comment_id": 95362418, "body": "I&#39;m with @Flimzy. Since the token is long lived, you&#39;re basically storing a password. There&#39;s already <a href=\"https://www.owasp.org/index.php/Password_Storage_Cheat_Sheet\" rel=\"nofollow noreferrer\">best practices for that</a>, like <a href=\"https://godoc.org/golang.org/x/crypto/bcrypt\" rel=\"nofollow noreferrer\">bcrypt</a>, which don&#39;t require proper key management. Here&#39;s a discussion about using <a href=\"https://security.stackexchange.com/questions/3165/hmac-why-not-hmac-for-password-storage#3168\">HMAC to store passwords over on Security.SE</a>."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1547920143, "post_id": 54269497, "comment_id": 95362445, "body": "Yes, use bcrypt or similar. Don&#39;t re-invent the wheel when it comes to security. You&#39;ll almost always make a mistake (I say this from experience, having made many such mistakes over the last 20 years of my software development career)."}, {"owner": {"reputation": 835, "user_id": 4008473, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/bab2d01a5c2ce91bed8964aabf65527c?s=128&d=identicon&r=PG&f=1", "display_name": "user27111987", "link": "https://stackoverflow.com/users/4008473/user27111987"}, "edited": false, "score": 0, "creation_date": 1547924435, "post_id": 54269497, "comment_id": 95363695, "body": "Just want to make one point here. Usecase of accesstoken is different than that of password. Using bcrypt for access token will have big impact on performance because I have to also search based on access token in redis and sometimes in db. Search is not the case with passwords. That is why I was using sha1 as it gave me 160 bit output as compared to bcrypt which is giving a 260 bit output.  I am still exploring more solutions in which first I do not need to store a naked access token, second it should not have collisions and last performance has to be good due to redis and db queries."}, {"owner": {"reputation": 835, "user_id": 4008473, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/bab2d01a5c2ce91bed8964aabf65527c?s=128&d=identicon&r=PG&f=1", "display_name": "user27111987", "link": "https://stackoverflow.com/users/4008473/user27111987"}, "edited": false, "score": 0, "creation_date": 1547924539, "post_id": 54269497, "comment_id": 95363721, "body": "I agree Sha1 may not be good idea but so far it fits more better for my three requirements mentioned above. I am exploring more."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1547930403, "post_id": 54269497, "comment_id": 95365190, "body": "The primary factor in search time will be the number of entries in your database, not the length of entries. So 260 bits vs 160 bits will have a very negligible difference."}], "answers": [{"tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": false, "score": 1, "last_activity_date": 1547919533, "creation_date": 1547919533, "answer_id": 54269696, "question_id": 54269497, "link": "https://stackoverflow.com/questions/54269497/sha1-hex-of-uuid-use-as-access-token/54269696#54269696", "title": "Sha1 hex of UUID - Use as access Token", "body": "<p>For good encrypted messages or checksums, the probability of collision is almost impossible.</p>\n\n<p>Good cryptographic and checksum algorithms produce encrypted messages which are indistinguishable from randomness. Anything less means something of the original message survives. That means any given access token is equally likely to map to any possible encrypted message. Anything less would allow an attacker to guess the message.</p>\n\n<blockquote>\n  <p>The cryptographic strength of the HMAC depends upon the cryptographic strength of the underlying hash function, the size of its hash output, and the size and quality of the key.</p>\n</blockquote>\n\n<p>While it's not exactly broken, <a href=\"https://www.wikiwand.com/en/SHA-1#/Cryptanalysis_and_validation\" rel=\"nofollow noreferrer\">the security of SHA-1 has been significantly eroded</a>. You'd should use SHA-256 or better.</p>\n"}], "owner": {"reputation": 835, "user_id": 4008473, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/bab2d01a5c2ce91bed8964aabf65527c?s=128&d=identicon&r=PG&f=1", "display_name": "user27111987", "link": "https://stackoverflow.com/users/4008473/user27111987"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 585, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1547919533, "creation_date": 1547918215, "last_edit_date": 1547919335, "question_id": 54269497, "link": "https://stackoverflow.com/questions/54269497/sha1-hex-of-uuid-use-as-access-token", "title": "Sha1 hex of UUID - Use as access Token", "body": "<p>I am writing a Go OAuth application in which I am generating a UUID and using it as an accessToken, and returning it to the customer. I don't want to save naked accessToken in DB because it is valid for a long time.. So I am generating a hash using Sha1 and saving it like below</p>\n\n<pre><code>import \"github.com/pborman/uuid\"\naccessToken := uuid.NewRandom()\nmac := hmac.New(sha1.New, mysecretkey)\nmac.Write([]byte(accessToken)\nsigned := mac.Sum(nil)\naccessTokenDB hex.EncodeToString(signed)\n</code></pre>\n\n<p>By using uuid as accessToken gives me very low probability of collision.  I want to know if accessTokenDB will also give same very low probability of collision or not. I am saving accessTokenDB to a column which has unique index.</p>\n"}, {"tags": ["python", "go"], "comments": [{"owner": {"reputation": 2239, "user_id": 5400362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afc3721db0d3d78c446c6ae3f2b99737?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/5400362/dev"}, "edited": false, "score": 0, "creation_date": 1547917013, "post_id": 54269243, "comment_id": 95361494, "body": "Welcome to SO! Please read <a href=\"https://stackoverflow.com/help/mcve\">how to ask question?</a>, what have written please check once <code>I have 2 scripts</code>  and <code>I don&#39;t have any code to show</code>"}, {"owner": {"reputation": 61, "user_id": 9925358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd1ec7acb50a90263c1b706ac769813?s=128&d=identicon&r=PG&f=1", "display_name": "fatkat", "link": "https://stackoverflow.com/users/9925358/fatkat"}, "reply_to_user": {"reputation": 2239, "user_id": 5400362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afc3721db0d3d78c446c6ae3f2b99737?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/5400362/dev"}, "edited": false, "score": 0, "creation_date": 1547917456, "post_id": 54269243, "comment_id": 95361633, "body": "@Dev I mean, that&#39;s me just explaining the process I&#39;ve trying to achieve with a different language. I&#39;m not having issues with the 2 scripts I currently have, I just wanted to explain what I&#39;m trying to achieve"}, {"owner": {"reputation": 2239, "user_id": 5400362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afc3721db0d3d78c446c6ae3f2b99737?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/5400362/dev"}, "edited": false, "score": 0, "creation_date": 1547917801, "post_id": 54269243, "comment_id": 95361733, "body": "to answer your question it is necessary to understand that what kind of problem or code trials you are talking about that you didn&#39;t added, otherwise it falls in too broad context"}, {"owner": {"reputation": 61, "user_id": 9925358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd1ec7acb50a90263c1b706ac769813?s=128&d=identicon&r=PG&f=1", "display_name": "fatkat", "link": "https://stackoverflow.com/users/9925358/fatkat"}, "reply_to_user": {"reputation": 2239, "user_id": 5400362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afc3721db0d3d78c446c6ae3f2b99737?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/5400362/dev"}, "edited": false, "score": 0, "creation_date": 1547917867, "post_id": 54269243, "comment_id": 95361752, "body": "@Dev so I need to add some Python code, with a while loop and it creates a process? Okay."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 4, "creation_date": 1547917883, "post_id": 54269243, "comment_id": 95361764, "body": "Processes and &quot;subprocesses&quot; have nothing to do with the language you&#39;re using. These are fundamental OS concepts. Having said that, you almost certainly should not use a subprocess in Go--you should probably use a goroutine instead."}, {"owner": {"reputation": 61, "user_id": 9925358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd1ec7acb50a90263c1b706ac769813?s=128&d=identicon&r=PG&f=1", "display_name": "fatkat", "link": "https://stackoverflow.com/users/9925358/fatkat"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1547918385, "post_id": 54269243, "comment_id": 95361927, "body": "@Flimzy I added some code to show what I&#39;m doing in Python. I was thinking a Goroutine but I didn&#39;t know if creating a Goroutine that creates 100 other Goroutines was the correct way to go about it, but if that&#39;s the correct method then I guess i&#39;ll do that!"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1547974807, "post_id": 54269243, "comment_id": 95372094, "body": "You might want to read <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I ask a good question</a>, which enhances the probability for getting a useful answer <i>drastically</i>. You might find <a href=\"https://en.m.wikipedia.org/wiki/Eric_S._Raymond\" rel=\"nofollow noreferrer\">ESR</a>&#39;s excellent essay <a href=\"http://catb.org/~esr/faqs/smart-questions.html\" rel=\"nofollow noreferrer\">How To Ask Questions The Smart Way</a> helpful, too. Stackoverflow is NOT a code translation service - most of us make a living of that kind of work. Furthermore, can we assume that you have read <a href=\"https://tour.golang.org/concurrency/1\" rel=\"nofollow noreferrer\">tour.golang.org/concurrency/1</a> ?"}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1547975071, "post_id": 54269243, "comment_id": 95372129, "body": "What&#39;s the point of splitting this into separate processes and separate modules in Python, either?"}], "answers": [{"tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": false, "score": 5, "last_activity_date": 1547919476, "creation_date": 1547919476, "answer_id": 54269689, "question_id": 54269243, "link": "https://stackoverflow.com/questions/54269243/golang-equivalent-of-creating-a-subprocess-in-python/54269689#54269689", "title": "Golang equivalent of creating a subprocess in Python", "body": "<p>You can use the Go <code>os/exec</code> package for subprocess-like behavior. For example, here's a trivial program that runs the <code>date</code> program in a subprocess and reports its stdout:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"os/exec\"\n)\n\nfunc main() {\n    out, err := exec.Command(\"date\").Output()\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(\"The date is %s\\n\", out)\n}\n</code></pre>\n\n<p>A more interesting example <a href=\"https://gobyexample.com/spawning-processes\" rel=\"noreferrer\">from gobyexample</a> that shows how to interact with the stdio/stdout of launched processes:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"io/ioutil\"\nimport \"os/exec\"\n\nfunc main() {\n\n    // We'll start with a simple command that takes no\n    // arguments or input and just prints something to\n    // stdout. The `exec.Command` helper creates an object\n    // to represent this external process.\n    dateCmd := exec.Command(\"date\")\n\n    // `.Output` is another helper that handles the common\n    // case of running a command, waiting for it to finish,\n    // and collecting its output. If there were no errors,\n    // `dateOut` will hold bytes with the date info.\n    dateOut, err := dateCmd.Output()\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(\"&gt; date\")\n    fmt.Println(string(dateOut))\n\n    // Next we'll look at a slightly more involved case\n    // where we pipe data to the external process on its\n    // `stdin` and collect the results from its `stdout`.\n    grepCmd := exec.Command(\"grep\", \"hello\")\n\n    // Here we explicitly grab input/output pipes, start\n    // the process, write some input to it, read the\n    // resulting output, and finally wait for the process\n    // to exit.\n    grepIn, _ := grepCmd.StdinPipe()\n    grepOut, _ := grepCmd.StdoutPipe()\n    grepCmd.Start()\n    grepIn.Write([]byte(\"hello grep\\ngoodbye grep\"))\n    grepIn.Close()\n    grepBytes, _ := ioutil.ReadAll(grepOut)\n    grepCmd.Wait()\n\n    // We ommited error checks in the above example, but\n    // you could use the usual `if err != nil` pattern for\n    // all of them. We also only collect the `StdoutPipe`\n    // results, but you could collect the `StderrPipe` in\n    // exactly the same way.\n    fmt.Println(\"&gt; grep hello\")\n    fmt.Println(string(grepBytes))\n\n    // Note that when spawning commands we need to\n    // provide an explicitly delineated command and\n    // argument array, vs. being able to just pass in one\n    // command-line string. If you want to spawn a full\n    // command with a string, you can use `bash`'s `-c`\n    // option:\n    lsCmd := exec.Command(\"bash\", \"-c\", \"ls -a -l -h\")\n    lsOut, err := lsCmd.Output()\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(\"&gt; ls -a -l -h\")\n    fmt.Println(string(lsOut))\n}\n</code></pre>\n\n<hr>\n\n<p>Note that goroutines have little to do with subprocesses. Goroutines are a way to do multiple things concurrently <em>in a single Go process</em>. That said, when interacting with subprocesses, goroutines often come in handy because they help waiting for subprocesses to finish while also doing other things in the launching (main) program. But the details of this are very specific to your application.</p>\n"}], "owner": {"reputation": 61, "user_id": 9925358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd1ec7acb50a90263c1b706ac769813?s=128&d=identicon&r=PG&f=1", "display_name": "fatkat", "link": "https://stackoverflow.com/users/9925358/fatkat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4254, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1547919476, "creation_date": 1547916374, "last_edit_date": 1547918289, "question_id": 54269243, "link": "https://stackoverflow.com/questions/54269243/golang-equivalent-of-creating-a-subprocess-in-python", "title": "Golang equivalent of creating a subprocess in Python", "body": "<p>I am attempting to convert a Python script to Golang, just really to see performance differences and to help me learn Golang more.</p>\n\n<p>In Python, I have 2 scripts. One is a script that runs an infinite loop and sleeps for a minute before running again. The code checks an endpoint on my server and reads the output, then determines if it needs to do anything. If it does, it handles the output and starts a new subprocess. The subprocess is another Python script that does a lot of calculations and creates hundreds of threads. There can be multiple subprocesses running at any given time and they're all different tasks for different users.</p>\n\n<p>I've got my Golang code reading from the API, and it's ready to start a new subprocess. But I'm not really sure how I go about it. </p>\n\n<p>I know when I've created the new subprocess (or whatever it is that is the Go equivalent) I can create a bunch of Go routines, but really I'm just stuck on the \"subprocess\" bit.</p>\n\n<p>I have tried using Go routines as a substitute for the subprocess but I don't think this is the way to go? </p>\n\n<p>As requested for visualisation purposes, I have added an example of the code. </p>\n\n<p>api.py:</p>\n\n<pre><code>while True:\n    someparameter = 'randomIDfromdatabase'\n    subprocess.Popen([\"python3\", \"mycode.py\", someparameter])\n    time.sleep(60)\n</code></pre>\n\n<p>mycode.py</p>\n\n<pre><code>parameter = sys.argv[1]\nfor i in range(0, 100):\n    thread.append(MyClass(parameter))\n    thread.start()\n</code></pre>\n\n<p>I basically need the Golang equivalent of \"subprocess.Popen\".</p>\n"}, {"tags": ["go", "search", "graph", "gonum"], "answers": [{"tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": true, "score": 2, "last_activity_date": 1547920145, "creation_date": 1547920145, "answer_id": 54269784, "question_id": 54268441, "link": "https://stackoverflow.com/questions/54268441/using-gonum-for-graph-algorithms-in-go/54269784#54269784", "title": "Using Gonum for graph algorithms in Go", "body": "<p>If you're just starting with Go I would recommend sticking with the standard library for a bit and not adding more to your learning curve. Try to implement a simple graph data structure with some basic algorithms - it's very easy, and will let you practice with the language. Later on when you need more performance/features, you can look around for libraries (gonum or others). For example, a simple graph can be represented with:</p>\n\n<pre><code>// Node is a node in the graph; it has a (unique) ID and a sequence of\n// edges to other nodes.\ntype Node struct {\n    Id    int64\n    Edges []int64\n}\n\n// Graph contains a set of Nodes, uniquely identified by numeric IDs.\ntype Graph struct {\n    Nodes map[int64]Node\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4669834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d1db2b4f3ae2b4c6e1a313f706200b8?s=128&d=identicon&r=PG&f=1", "display_name": "RileyR", "link": "https://stackoverflow.com/users/4669834/rileyr"}, "is_accepted": false, "score": 0, "last_activity_date": 1608006772, "creation_date": 1608006772, "answer_id": 65300051, "question_id": 54268441, "link": "https://stackoverflow.com/questions/54268441/using-gonum-for-graph-algorithms-in-go/65300051#65300051", "title": "Using Gonum for graph algorithms in Go", "body": "<p>Stumbled on this question looking for hints to counting edges with gonum/graph as well. I haven't found a ton of resources other than digging through the API docs.</p>\n<p>Think I found the right way to count edges for single nodes.. Maybe!</p>\n<pre><code>for _, node := range graph.NodesOf(g.Nodes()) {\n    toNodes := g.From(node.ID()) // returns graph.Nodes\n    nodeArray := graph.NodesOf( toNodes ) // returns []graph.Node\n    edgeCount := len(nodeArray)\n    // - or -\n    edgeCount := len(graph.NodesOf( g.From(node.ID()) ))\n    // do work with edge count\n}\n</code></pre>\n<p>Given a known node and all the nodes you can get to from there, you can count (ex: <code>len(graph.NodesOf(g.From(node.ID())))</code> the number of edges!</p>\n<p>To count all of the edges:</p>\n<pre><code>totalEdges := len(graph.EdgesOf(g.Edges()))\n</code></pre>\n"}], "owner": {"reputation": 627, "user_id": 10081814, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6F_lJ08LDqA/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxQPLc9kHyffxxEQqVKmEurgRSAw/mo/photo.jpg?sz=128", "display_name": "Evan Kim", "link": "https://stackoverflow.com/users/10081814/evan-kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1110, "favorite_count": 0, "accepted_answer_id": 54269784, "answer_count": 2, "score": 1, "last_activity_date": 1608006772, "creation_date": 1547910558, "question_id": 54268441, "link": "https://stackoverflow.com/questions/54268441/using-gonum-for-graph-algorithms-in-go", "title": "Using Gonum for graph algorithms in Go", "body": "<p>I am a new Go programmer, just finished the \"A tour of Go\" tutorial a couple days ago. I want to create a graph of a 150 x 120 size and then get all the edge nodes for each node and implement some graph search algorithms such as BFS and Dijkstra. I found a great looking library called Gonum with a <a href=\"https://godoc.org/github.com/gonum/graph\" rel=\"nofollow noreferrer\">graph package</a>  that looks promising to use. </p>\n\n<p>My problem is that it is a lot of information and I don't know where to get started. I was hoping there would be a tutorial of some sorts to get me started in the right direction, but I haven't had any luck finding one. </p>\n\n<p>The way I set this up in Python was making a numpy arrays of zero's to represent the size of the graph and then iterate through it to get each edge for each node, but I am not sure that this is the best way to think about how graphs are set up in Go. </p>\n"}, {"tags": ["go", "go-gorm"], "comments": [{"owner": {"reputation": 5734, "user_id": 415628, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/84d8280499418f22f42778cc40c20a12?s=128&d=identicon&r=PG", "display_name": "Ezequiel Muns", "link": "https://stackoverflow.com/users/415628/ezequiel-muns"}, "edited": false, "score": 0, "creation_date": 1548725716, "post_id": 54267875, "comment_id": 95636029, "body": "What about calling <code>h.DB.Debug().Where ...</code> before you run the query to see what SQL is being executed?"}, {"owner": {"reputation": 5734, "user_id": 415628, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/84d8280499418f22f42778cc40c20a12?s=128&d=identicon&r=PG", "display_name": "Ezequiel Muns", "link": "https://stackoverflow.com/users/415628/ezequiel-muns"}, "edited": false, "score": 0, "creation_date": 1548730538, "post_id": 54267875, "comment_id": 95636954, "body": "Also, you may have done this and not shown it for brevity, but be sure to check the <code>.Error</code> field when you have run a query, to know you can trust the contents of what you have loaded. <code>err := h.DB.Where()....Find(&amp;dest).Error</code>"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 7430920, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aVW2XHMsu3c/AAAAAAAAAAI/AAAAAAAAAAo/G9peJiY4VKA/photo.jpg?sz=128", "display_name": "Grid Maniac", "link": "https://stackoverflow.com/users/7430920/grid-maniac"}, "is_accepted": false, "score": 2, "last_activity_date": 1593782091, "creation_date": 1593782091, "answer_id": 62716240, "question_id": 54267875, "link": "https://stackoverflow.com/questions/54267875/gorm-preload-by-condition-in-a-related-table/62716240#62716240", "title": "GORM Preload by condition in a related table", "body": "<p>From my experience the most appropriate way to do that with GORM is by utilizing SubQueries:</p>\n<pre><code>topicPosts := []model.TopicPost{}   \n\nDB.GetDB().\n    Where(&quot;topic_id = ? AND post_id IN (?)&quot;, id,\n        DB.GetDB().Table(&quot;posts&quot;).\n            Select(&quot;id&quot;).\n            Not(&quot;is_private = ? AND user_id != ?&quot;, &quot;true&quot;, currentUser.ID)).\n            SubQuery()).\n\n    Preload(&quot;Post&quot;).\n    Find(&amp;topicPosts)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 13772757, "user_type": "registered", "profile_image": "https://graph.facebook.com/2680259192187910/picture?type=large", "display_name": "S\u01a1n x&#234; k&#244;", "link": "https://stackoverflow.com/users/13772757/s%c6%a1n-x%c3%aa-k%c3%b4"}, "is_accepted": false, "score": 0, "last_activity_date": 1601010106, "creation_date": 1601010106, "answer_id": 64058081, "question_id": 54267875, "link": "https://stackoverflow.com/questions/54267875/gorm-preload-by-condition-in-a-related-table/64058081#64058081", "title": "GORM Preload by condition in a related table", "body": "<p>You can use this method</p>\n<pre><code>db.Preload(&quot;Post&quot;, &quot;is_private = ? AND user_id != ?&quot;, &quot;true&quot;, currentUser.ID).Find(&amp;topicPosts)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4338202"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1270, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1601010106, "creation_date": 1547906556, "last_edit_date": 1547907425, "question_id": 54267875, "link": "https://stackoverflow.com/questions/54267875/gorm-preload-by-condition-in-a-related-table", "title": "GORM Preload by condition in a related table", "body": "<p>I can't figure how to properly write a query that will select only those entries where condition is applied against relations table.\nMy many-to-many schema looks like this <code>Topics</code> - <code>TopicPosts</code> - <code>Posts</code>. I want to query all <code>TopicPosts</code> where <code>Post</code> is not private or is belongs to the current user. I'm doing it like this: </p>\n\n<pre><code>topicPosts := []model.TopicPost{}\nh.DB.\n    Where(\"topic_id = ?\", id).\n    Preload(\"Post\", func(db *gorm.DB) *gorm.DB {\n        return db.Not(\"is_private = ? AND user_id != ?\", \"true\", currentUser.ID)\n    }).\n    Preload(\"Post.Tags\").\n    Find(&amp;topicPosts)\n</code></pre>\n\n<p>As expected it returns all <code>TopicPosts</code> but does not eagerly load <code>Posts</code> with a given condition. I then manually filter them out:</p>\n\n<pre><code>publicTopicPosts := []model.TopicPost{}\nfor _, p := range topicPosts {\n    if p.Post.ID != 0 {\n        publicTopicPosts = append(publicTopicPosts, p)\n    }\n}\n</code></pre>\n\n<p>I realise this is a subpar solution, I'm not very good with SQL but I think it should be possible to achieve within a single query. I would appreciate any help. I'm using Postgres if it matters.</p>\n"}, {"tags": ["docker", "go"], "comments": [{"owner": {"reputation": 144207, "user_id": 596285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6975c494d3d9c404dd3d7af2edf3133?s=128&d=identicon&r=PG", "display_name": "BMitch", "link": "https://stackoverflow.com/users/596285/bmitch"}, "edited": false, "score": 0, "creation_date": 1547906869, "post_id": 54267807, "comment_id": 95358774, "body": "<a href=\"https://gobyexample.com/signals\" rel=\"nofollow noreferrer\">gobyexample.com/signals</a>"}], "answers": [{"comments": [{"owner": {"reputation": 354, "user_id": 7313092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tg3FX.jpg?s=128&g=1", "display_name": "Persi", "link": "https://stackoverflow.com/users/7313092/persi"}, "edited": false, "score": 0, "creation_date": 1547911723, "post_id": 54268385, "comment_id": 95360033, "body": "Thank you for the answer! Now I understand what is going on."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1548188910, "last_edit_date": 1548188910, "creation_date": 1547910105, "answer_id": 54268385, "question_id": 54267807, "link": "https://stackoverflow.com/questions/54267807/docker-not-responding-while-running-go-server/54268385#54268385", "title": "Docker not responding while running go server", "body": "<p>You're using go run, so you're sending the signal to the go tool, not your server process. You can interrupt the sever started by <code>go run</code> in a shell, because <code>ctrl+c</code> in a shell sends the signal to the entire process group.</p>\n\n<p>There's also no reason to compile the executable every time you start the container (which can incur much more overhead as your program expands). Building the executable when creating the image is more efficient, and lets you execute the server directly.</p>\n\n<p>An example docker file:</p>\n\n<pre><code>FROM golang:1.11.4-alpine3.8\nWORKDIR /go/src/server\nCOPY main.go main.go\nRUN go build\nCMD [\"./server\"]\n</code></pre>\n\n<p>See a similar question here, where the process is a shell rather than the <code>go</code> tool:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/33379567/sending-signals-to-golang-application-in-docker\">Sending signals to Golang application in Docker</a></p>\n"}, {"tags": [], "owner": {"reputation": 2422, "user_id": 2622394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d36f32e6280af5bb307cead90e3844f?s=128&d=identicon&r=PG", "display_name": "lmars", "link": "https://stackoverflow.com/users/2622394/lmars"}, "is_accepted": false, "score": 1, "last_activity_date": 1547911972, "creation_date": 1547911972, "answer_id": 54268642, "question_id": 54267807, "link": "https://stackoverflow.com/questions/54267807/docker-not-responding-while-running-go-server/54268642#54268642", "title": "Docker not responding while running go server", "body": "<p>In order for <code>docker run</code> to forward signals like SIGINT to the container, you need to pass both the <code>--interactive</code> and <code>--tty</code> flags to <code>docker run</code>, which are typically shortened to <code>-it</code>.</p>\n\n<p>Without those flags, the signal isn't forward as you mention:</p>\n\n<pre><code>$ docker run -p 1818:1818 goserver\n^C\n</code></pre>\n\n<p>With the flags set however, the signal is forwarded to the container and the program exits as it would do if run directly in a shell:</p>\n\n<pre><code>$ docker run -it -p 1818:1818 goserver\n^Csignal: interrupt\n$\n</code></pre>\n"}], "owner": {"reputation": 354, "user_id": 7313092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tg3FX.jpg?s=128&g=1", "display_name": "Persi", "link": "https://stackoverflow.com/users/7313092/persi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 593, "favorite_count": 0, "accepted_answer_id": 54268385, "answer_count": 2, "score": 2, "last_activity_date": 1548188910, "creation_date": 1547906102, "question_id": 54267807, "link": "https://stackoverflow.com/questions/54267807/docker-not-responding-while-running-go-server", "title": "Docker not responding while running go server", "body": "<p>I cannot stop docker golang web server in docker container by sending Interrupt Signal.\nI have following main.go:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n    http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {      \n        w.Write([]byte(\"hello\"))\n    })\n    log.Fatal(http.ListenAndServe(\":1818\", nil))\n}\n</code></pre>\n\n<p>And Dockerfile:</p>\n\n<pre><code>FROM golang:1.11.4-alpine3.8\nWORKDIR /go/src/server\nCOPY main.go main.go\nCMD [\"go\", \"run\", \"main.go\"]\n</code></pre>\n\n<p>I build:</p>\n\n<pre><code>docker build -t goserver .\n</code></pre>\n\n<p>and run image:</p>\n\n<pre><code>docker run -p 1818:1818 goserver\n</code></pre>\n\n<p>At this moment server is running. When I hit Ctrl+C in my console container (and server process) is still running and the only way to stop is by calling docker to do it.\nI would like to know how to handle such behaviour so that server and container stops when hitting Ctrl+C.</p>\n\n<p>Docker version 18.09.1</p>\n"}, {"tags": ["node.js", "go", "utf-8", "base64"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1547905973, "post_id": 54267136, "comment_id": 95358607, "body": "For most if not all things crypto, you should operate on single bytes, not multi-byte characters like they occur in utf-8, for instance. In Go this means sticking to byte slices all the way, only converting to strings for printing text. I&#39;m not too familiar with JavaScript, but I believe there is a &quot;binary&quot; encoding for buffers that doesn&#39;t cause data to be interpreted in any particular encoding."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1547906140, "post_id": 54267136, "comment_id": 95358637, "body": "And I just have to ask: you know that xor is very easy to break, yes?"}], "answers": [{"comments": [{"owner": {"reputation": 713, "user_id": 3184747, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/PvKlQ.png?s=128&g=1", "display_name": "Soorya Prakash", "link": "https://stackoverflow.com/users/3184747/soorya-prakash"}, "edited": false, "score": 0, "creation_date": 1547957234, "post_id": 54267576, "comment_id": 95369602, "body": "Can you give some example to try it out for my above usecase"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1547904349, "creation_date": 1547904349, "answer_id": 54267576, "question_id": 54267136, "link": "https://stackoverflow.com/questions/54267136/unable-to-decrypt-the-xor-base64-text/54267576#54267576", "title": "Unable to decrypt the xor-base64 text", "body": "<blockquote>\n  <p>The <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/charCodeAt\" rel=\"nofollow noreferrer\">charCodeAt()</a> method returns an integer between 0 and 65535\n  representing the UTF-16 code unit at the given index.</p>\n\n<pre><code>var c = input.charCodeAt(i);\n</code></pre>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/ref/spec#For_statements\" rel=\"nofollow noreferrer\">For statements with range clause</a></p>\n  \n  <p>For a string value, the \"range\" clause iterates over the Unicode code\n  points in the string starting at byte index 0. On successive\n  iterations, the index value will be the index of the first byte of\n  successive UTF-8-encoded code points in the string, and the second\n  value, of type rune, will be the value of the corresponding code\n  point. If the iteration encounters an invalid UTF-8 sequence, the\n  second value will be 0xFFFD, the Unicode replacement character, and\n  the next iteration will advance a single byte in the string.</p>\n</blockquote>\n\n<pre><code>for i := range input\n</code></pre>\n\n<hr>\n\n<p>UTF-16 versus UTF-8?</p>\n"}, {"tags": [], "owner": {"reputation": 784, "user_id": 10737552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee6d7fb0cd2e5fb9e1daa3282b25f876?s=128&d=identicon&r=PG&f=1", "display_name": "Billy Yuan", "link": "https://stackoverflow.com/users/10737552/billy-yuan"}, "is_accepted": true, "score": 1, "last_activity_date": 1547975116, "creation_date": 1547975116, "answer_id": 54274978, "question_id": 54267136, "link": "https://stackoverflow.com/questions/54267136/unable-to-decrypt-the-xor-base64-text/54274978#54274978", "title": "Unable to decrypt the xor-base64 text", "body": "<p>You should use <code>DecodeRuneInString</code> instead of just <code>slice</code> string to byte.</p>\n\n<p>Solution in playground: <a href=\"https://play.golang.org/p/qi_6S1J_dZU\" rel=\"nofollow noreferrer\">https://play.golang.org/p/qi_6S1J_dZU</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"unicode/utf8\"\n)\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n    k:=\"1234fd23434\"\n    input:=\"The \u6211characterode\u6211 113 is equal to q\"\n    fmt.Println(EncryptDecrypt(input,k))\n\n    // expect: \"eZV\u6277ZRFRWEWA[\u6223[@GRX@^B\"\n\n}\n\nfunc EncryptDecrypt(input, key string) (output string) {\n    keylen := len(key)\n    count := len(input)\n    i := 0\n    j := 0\n    for i &lt; count {\n        c, n := utf8.DecodeRuneInString(input[i:])\n        i += n\n        k, m := utf8.DecodeRuneInString(key[j:])\n        j += m\n        if j &gt;= keylen {\n            j = 0\n        }\n\n        output += string(c ^ k)\n    }\n\n    return output\n}\n</code></pre>\n\n<p>compared to your js result</p>\n\n<pre><code>function xorStrings(key,input){\n  var output='';\n  for(var i=0;i&lt;input.length;i++){\n    var c = input.charCodeAt(i);\n    var k = key.charCodeAt(i%key.length);\n    output += String.fromCharCode(c ^ k);\n  }\n  return output;\n}\n\nconsole.log(xorStrings('1234fd23434',\"The \u6211characterode\u6211 113 is equal to q\"))\n// expect: \"eZV\u6277ZRFRWEWA[\u6223[@GRX@^B\"\n</code></pre>\n\n<p>The test result is the same.</p>\n\n<p>Here is why.</p>\n\n<p>In go, when you range a string, you iterate bytes, but javascript <code>charCodeAt</code> is for character,not byte. In utf-8, the character is maybe 2 or 3 bytes long. So that is why you got different output.</p>\n\n<p>Test in playground <a href=\"https://play.golang.org/p/XawI9aR_HDh\" rel=\"nofollow noreferrer\">https://play.golang.org/p/XawI9aR_HDh</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"unicode/utf8\"\n)\n\nvar sentence = \"The \u6211quick brown fox jumps over the lazy dog.\"\n\nvar index = 4\n\nfunc main() {\n    fmt.Println(\"slice of string...\")\n    fmt.Printf(\"The byte at %d is |%s|, |%s| is 3 bytes long.\\n\",index,sentence[index:index+1],sentence[index:index+3])\n\n    fmt.Println(\"runes of string...\")\n    ru, _ := utf8.DecodeRuneInString(sentence[index:])\n    i := int(ru)\n    fmt.Printf(\"The character code at %d is|%s|%d|    \\n\",index, string(ru), i)\n}\n</code></pre>\n\n<p>The output is </p>\n\n<pre><code>slice of string...\nThe byte at 4 is |\ufffd|, |\u6211| is 3 bytes long.\nrunes of string...\nThe character code at 4 is|\u6211|25105| \n</code></pre>\n"}], "owner": {"reputation": 713, "user_id": 3184747, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/PvKlQ.png?s=128&g=1", "display_name": "Soorya Prakash", "link": "https://stackoverflow.com/users/3184747/soorya-prakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 886, "favorite_count": 1, "accepted_answer_id": 54274978, "answer_count": 2, "score": 0, "last_activity_date": 1547975116, "creation_date": 1547901228, "last_edit_date": 1547903348, "question_id": 54267136, "link": "https://stackoverflow.com/questions/54267136/unable-to-decrypt-the-xor-base64-text", "title": "Unable to decrypt the xor-base64 text", "body": "<p>I am using the below code to encrypt and decrypt the data. Now I want to encrypt the data from Node JS and want to decrypt the data from Go lang. But I am not able to achieve it using GO lang.</p>\n\n<pre><code>var B64XorCipher = {\n  encode: function(key, data) {\n    return new Buffer(xorStrings(key, data),'utf8').toString('base64');\n  },\n  decode: function(key, data) {\n    data = new Buffer(data,'base64').toString('utf8');\n    return xorStrings(key, data);\n  }\n};\n\nfunction xorStrings(key,input){\n  var output='';\n  for(var i=0;i&lt;input.length;i++){\n    var c = input.charCodeAt(i);\n    var k = key.charCodeAt(i%key.length);\n    output += String.fromCharCode(c ^ k);\n  }\n  return output;\n}\n</code></pre>\n\n<p>From go I am trying to decode like below I am not able to achieve it. </p>\n\n<pre><code>bytes, err := base64.StdEncoding.DecodeString(actualInput)\nencryptedText := string(bytes)\nfmt.Println(EncryptDecrypt(encryptedText, \"XXXXXX\"))\n\nfunc EncryptDecrypt(input, key string) (output string) {\n    for i := range input {\n        output += string(input[i] ^ key[i%len(key)])\n    }\n\n    return output\n}\n</code></pre>\n\n<p>Can someone help me to resolve it.</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1547974960, "post_id": 54266482, "comment_id": 95372118, "body": "The JSON &quot;stream&quot;, is it always delimited by <code>,\\n</code>? Does it come in as one or one JSON object at a time?"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10937142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2036ec5aa643ab4a38abd241badb0ef?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Doh", "link": "https://stackoverflow.com/users/10937142/jay-doh"}, "edited": false, "score": 0, "creation_date": 1547931811, "post_id": 54266619, "comment_id": 95365534, "body": "Thanks for the idea but I think doing an io.Copy would be too expensive with really huge files. I think I figured it out though and I added an answer for other people."}, {"owner": {"reputation": 8470, "user_id": 538866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb67b45ca1dc2584f8e4d703d009177b?s=128&d=identicon&r=PG", "display_name": "Jonas G. Drange", "link": "https://stackoverflow.com/users/538866/jonas-g-drange"}, "reply_to_user": {"reputation": 31, "user_id": 10937142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2036ec5aa643ab4a38abd241badb0ef?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Doh", "link": "https://stackoverflow.com/users/10937142/jay-doh"}, "edited": false, "score": 0, "creation_date": 1547935999, "post_id": 54266619, "comment_id": 95366464, "body": "io.Copy would not be expensive in neither memory or time dimensions."}], "tags": [], "owner": {"reputation": 8470, "user_id": 538866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb67b45ca1dc2584f8e4d703d009177b?s=128&d=identicon&r=PG", "display_name": "Jonas G. Drange", "link": "https://stackoverflow.com/users/538866/jonas-g-drange"}, "is_accepted": false, "score": 1, "last_activity_date": 1547897410, "creation_date": 1547897410, "answer_id": 54266619, "question_id": 54266482, "link": "https://stackoverflow.com/questions/54266482/decoding-json-stream-that-isnt-surrounded-by-array-brackets/54266619#54266619", "title": "Decoding JSON stream that isn&#39;t surrounded by array brackets?", "body": "<p>One suggestion is to use a pipe, and prepend and append the <code>[]</code>.</p>\n\n<pre><code>reader := strings.NewReader(jsonStream)\n\npr, pw := io.Pipe()\n\ngo func() {\n    pw.Write([]byte(`[`))\n    io.Copy(pw, reader)\n    pw.Write([]byte(`]`))\n}()\n\ndec := json.NewDecoder(pr)\n</code></pre>\n\n<p>You should add some error handling.</p>\n\n<p>See <a href=\"https://play.golang.org/p/Oogu_NdAUyR\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Oogu_NdAUyR</a> for the whole thing.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 10937142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2036ec5aa643ab4a38abd241badb0ef?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Doh", "link": "https://stackoverflow.com/users/10937142/jay-doh"}, "is_accepted": false, "score": 1, "last_activity_date": 1547931833, "creation_date": 1547931833, "answer_id": 54271373, "question_id": 54266482, "link": "https://stackoverflow.com/questions/54266482/decoding-json-stream-that-isnt-surrounded-by-array-brackets/54271373#54271373", "title": "Decoding JSON stream that isn&#39;t surrounded by array brackets?", "body": "<p>I ended up doing this:</p>\n\n<pre><code>f, err := os.Open(fname)\nif err != nil {\n    // handle error\n}\nd := json.NewDecoder(f)\nfor {\n    var v ValueTypeToUnmarshalTo\n    if err := d.Decode(&amp;v); err == io.EOF {\n        break // done decoding file\n    } else if err != nil {\n        // handle error\n    }\n    // do something with v\n}\n</code></pre>\n\n<p>The decoder appears to ignore newlines so there's not even a need to use the stream decoder. That's only if you actually have a JSON array.</p>\n\n<p>Taken from part of this answer: <a href=\"https://stackoverflow.com/a/34388102\">https://stackoverflow.com/a/34388102</a></p>\n\n<p>Thanks for the help!</p>\n"}], "owner": {"reputation": 31, "user_id": 10937142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2036ec5aa643ab4a38abd241badb0ef?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Doh", "link": "https://stackoverflow.com/users/10937142/jay-doh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 405, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1547931833, "creation_date": 1547896403, "question_id": 54266482, "link": "https://stackoverflow.com/questions/54266482/decoding-json-stream-that-isnt-surrounded-by-array-brackets", "title": "Decoding JSON stream that isn&#39;t surrounded by array brackets?", "body": "<p>I'm trying to decode a JSON stream from a file. The file is newline separated JSON objects. But it's not formatted with array brackets surrounding the objects, so I can't figure out how to use <code>encoding/json</code> stream decoder.</p>\n\n<p>I get the error <code>not at beginning of value</code> because there is no opening bracket.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"strings\"\n)\n\nfunc main() {\n\n    // My data is missing opening and closing brackets around the jsonStream string.\n    // [\n    const jsonStream = `\n        {\"Name\": \"Ed\", \"Text\": \"Knock knock.\"},\n        {\"Name\": \"Sam\", \"Text\": \"Who's there?\"},\n        {\"Name\": \"Ed\", \"Text\": \"Go fmt.\"},\n        {\"Name\": \"Sam\", \"Text\": \"Go fmt who?\"},\n        {\"Name\": \"Ed\", \"Text\": \"Go fmt yourself!\"}\n    `\n    // ]\n    type Message struct {\n        Name, Text string\n    }\n    dec := json.NewDecoder(strings.NewReader(jsonStream))\n\n    // read open bracket -- this fails (no bracket)\n    t, err := dec.Token()\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(\"%T: %v\\n\", t, t)\n\n    // while the array contains values\n    for dec.More() {\n        var m Message\n        // decode an array value (Message)\n        err := dec.Decode(&amp;m)\n        if err != nil {\n            log.Fatal(err)\n        }\n\n        fmt.Printf(\"%v: %v\\n\", m.Name, m.Text)\n    }\n\n    // read closing bracket -- this also would fail (no bracket)\n    t, err = dec.Token()\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(\"%T: %v\\n\", t, t)\n\n}\n</code></pre>\n\n<p>Removing the dec.Token() error checks doesn't work either. I guess the parser doesn't expect to see objects before it has seen an array open bracket?</p>\n\n<p>Is there some workaround?</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-platform", "google-cloud-datastore"], "answers": [{"tags": [], "owner": {"reputation": 7659, "user_id": 4926605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ed159f0e91d9ee0484cc64771993cb1?s=128&d=identicon&r=PG&f=1", "display_name": "LundinCast", "link": "https://stackoverflow.com/users/4926605/lundincast"}, "is_accepted": true, "score": 1, "last_activity_date": 1547898809, "creation_date": 1547898809, "answer_id": 54266791, "question_id": 54266113, "link": "https://stackoverflow.com/questions/54266113/cloud-datastore-client-library-vs-app-engine-sdk-on-app-engine-go-standard/54266791#54266791", "title": "Cloud Datastore Client Library vs App Engine SDK on App Engine Go Standard", "body": "<p>App Engine Standard for Go1.11 runs on the new, second generation (beta) runtime which doesn't have the limitations of the 1st generation and is capable of running any framework, library, or binary. On the other hand, App Engine no longer modifies the Go toolchain to include the <code>appengine</code> package and it is strongly recommended to use the Google Cloud client library or third party libraries instead of the App Engine-specific APIs.</p>\n\n<p>For more details about this, I recommend to have a look at the doc <a href=\"https://cloud.google.com/appengine/docs/standard/go111/go-differences\" rel=\"nofollow noreferrer\">here</a> about the differences between both generations and how to handle them.</p>\n"}], "owner": {"reputation": 656, "user_id": 675011, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f43de6e91f46f77e195ef050273ebefa?s=128&d=identicon&r=PG", "display_name": "Remko", "link": "https://stackoverflow.com/users/675011/remko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 54266791, "answer_count": 1, "score": 0, "last_activity_date": 1548008701, "creation_date": 1547893502, "last_edit_date": 1548008701, "question_id": 54266113, "link": "https://stackoverflow.com/questions/54266113/cloud-datastore-client-library-vs-app-engine-sdk-on-app-engine-go-standard", "title": "Cloud Datastore Client Library vs App Engine SDK on App Engine Go Standard", "body": "<p>When writing a Go App Engine Standard app, it used to be the case that you had to use the <a href=\"https://cloud.google.com/appengine/docs/standard/go/datastore/\" rel=\"nofollow noreferrer\">App Engine SDK</a> to access the data store. However, these days (since Go 1.11?), it seems to work if you just use the <a href=\"https://cloud.google.com/datastore/docs/reference/libraries\" rel=\"nofollow noreferrer\">Cloud Datastore Client Library</a>. </p>\n\n<p>Is there a downside of using the Cloud Datastore Client Library on App Engine Standard for accessing the datastore? (apart from a bit of extra configuration to make the dev appserver use the emulator). The advantage is that it enables code reuse for other environments.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1547894875, "post_id": 54266247, "comment_id": 95356048, "body": "Unless they are imported with the dot in front of the import spec, in which case, two identical exported identifiers from two different packages imported with <code>.</code> would collide, unexported identical identifiers, however, wouldn&#39;t I assume."}, {"owner": {"reputation": 27522, "user_id": 6394138, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/u64Lc.png?s=128&g=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/6394138/leon"}, "edited": false, "score": 0, "creation_date": 1547912636, "post_id": 54266247, "comment_id": 95360269, "body": "@peterSO I don&#39;t agree that my question is a result of misunderstanding. mkopriva&#39;s comment above complements your answer in an important way. Once you incorporate it in your answer, I will accept it."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 0, "last_activity_date": 1547895243, "last_edit_date": 1547895243, "creation_date": 1547894650, "answer_id": 54266247, "question_id": 54266093, "link": "https://stackoverflow.com/questions/54266093/uniqueness-of-exported-identifiers-from-different-packages/54266247#54266247", "title": "Uniqueness of exported identifiers from different packages", "body": "<blockquote>\n  <p>Do I misunderstand something?</p>\n</blockquote>\n\n<p>Yes.</p>\n\n<p>Identifiers are qualified by the package name.</p>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specificatio</a>n</p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Qualified_identifiers\" rel=\"nofollow noreferrer\">Qualified identifiers</a></p>\n  \n  <p>A qualified identifier is an identifier qualified with a package name\n  prefix. Both the package name and the identifier must not be blank.</p>\n\n<pre><code>QualifiedIdent = PackageName \".\" identifier .\n</code></pre>\n  \n  <p>A qualified identifier accesses an identifier in a different package,\n  which must be imported. The identifier must be exported and declared\n  in the package block of that package.</p>\n\n<pre><code>math.Sin  // denotes the Sin function in package math\n</code></pre>\n  \n  <p><a href=\"https://golang.org/ref/spec#Import_declarations\" rel=\"nofollow noreferrer\">Import declarations</a></p>\n  \n  <p>The PackageName is used in qualified\n  identifiers to access exported identifiers of the package within the\n  importing source file. It is declared in the file block. If the\n  PackageName is omitted, it defaults to the identifier specified in the\n  package clause of the imported package. If an explicit period (.)\n  appears instead of a name, all the package's exported identifiers\n  declared in that package's package block will be declared in the\n  importing source file's file block and must be accessed without a\n  qualifier.</p>\n</blockquote>\n"}], "owner": {"reputation": 27522, "user_id": 6394138, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/u64Lc.png?s=128&g=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/6394138/leon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1547895243, "creation_date": 1547893278, "question_id": 54266093, "link": "https://stackoverflow.com/questions/54266093/uniqueness-of-exported-identifiers-from-different-packages", "title": "Uniqueness of exported identifiers from different packages", "body": "<p>I am reading the go spec and ran against the <a href=\"https://golang.org/ref/spec#Uniqueness_of_identifiers\" rel=\"nofollow noreferrer\">following section</a>:</p>\n\n<blockquote>\n  <h2>Uniqueness of identifiers</h2>\n  \n  <p>Given a set of identifiers, an identifier is called unique if it is\n  different from every other in the set. Two identifiers are different\n  if they are spelled differently, or if they appear in different\n  <a href=\"https://golang.org/ref/spec#Packages\" rel=\"nofollow noreferrer\">packages</a> and are not <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow noreferrer\">exported</a>. Otherwise, they are the same.</p>\n</blockquote>\n\n<p>I don't yet know why introducing this definition is important, but it seems to me that it implies that <strong><em>identically named exported identifiers from different packages are the same</em></strong>. Do I misunderstand something?</p>\n"}, {"tags": ["go", "channel"], "answers": [{"comments": [{"owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "edited": false, "score": 0, "creation_date": 1547893124, "post_id": 54266053, "comment_id": 95355658, "body": "Understood. So that the reason why we will use close channel pattern right ?"}, {"owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "edited": false, "score": 0, "creation_date": 1547893630, "post_id": 54266053, "comment_id": 95355783, "body": "And one more question is: what is difference between 2 methods: one is using close channel pattern (create close channel, at outside of loop, when done, we push an message into this close channel). And  one is check directly inside select/case block (<code>case value, ok := &lt;-c1:</code>)"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "edited": false, "score": 0, "creation_date": 1547893711, "post_id": 54266053, "comment_id": 95355800, "body": "Use <code>close</code> channel when it is useful. See my revised answer."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "edited": false, "score": 0, "creation_date": 1547894448, "post_id": 54266053, "comment_id": 95355953, "body": "See <a href=\"https://stackoverflow.com/questions/8593645/is-it-ok-to-leave-a-channel-open/8593986#8593986\" title=\"is it ok to leave a channel open\">stackoverflow.com/questions/8593645/&hellip;</a>"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 4, "last_activity_date": 1547894017, "last_edit_date": 1547894017, "creation_date": 1547892940, "answer_id": 54266053, "question_id": 54265982, "link": "https://stackoverflow.com/questions/54265982/go-channel-consume-data-from-channel-although-not-push-anything-to-channel/54266053#54266053", "title": "Go channel: consume data from channel although not push anything to channel", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Close\" rel=\"nofollow noreferrer\">Close</a> </p>\n  \n  <p>After calling close, and after any previously sent values have been\n  received, receive operations will return the zero value for the\n  channel's type without blocking. The multi-valued receive operation \n  returns a received value along with an indication of whether the\n  channel is closed.</p>\n</blockquote>\n\n<hr>\n\n<p>You are counting zero values.</p>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n\n    c1 := make(chan interface{})\n    close(c1)\n    c2 := make(chan interface{})\n    close(c2)\n\n    var c1Count, c2Count int\n    var z1Count, z2Count int\n    for i := 1000; i &gt;= 0; i-- {\n        select {\n        case z1 := &lt;-c1:\n            c1Count++\n            if z1 == nil {\n                z1Count++\n            }\n\n        case z2 := &lt;-c2:\n            c2Count++\n            if z2 == nil {\n                z2Count++\n            }\n        }\n\n    }\n    fmt.Printf(\"c1Count: %d\\nc2Count: %d\\n\", c1Count, c2Count)\n    fmt.Printf(\"z1Count: %d\\nz2Count: %d\\n\", z1Count, z2Count)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/tPRkqXrAFno\" rel=\"nofollow noreferrer\">https://play.golang.org/p/tPRkqXrAFno</a></p>\n\n<p>Output:</p>\n\n<pre><code>c1Count: 511\nc2Count: 490\nz1Count: 511\nz2Count: 490\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n</blockquote>\n\n<p><a href=\"https://golang.org/ref/spec#For_statements\" rel=\"nofollow noreferrer\">For statements</a></p>\n\n<blockquote>\n  <p>For statements with range clause</p>\n  \n  <p>For channels, the iteration values produced are the successive values\n  sent on the channel until the channel is closed. If the channel is\n  nil, the range expression blocks forever.</p>\n</blockquote>\n\n<p>Close is useful with a for statement with a range clause.</p>\n"}], "owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 3, "accepted_answer_id": 54266053, "answer_count": 1, "score": 2, "last_activity_date": 1547894017, "creation_date": 1547892313, "question_id": 54265982, "link": "https://stackoverflow.com/questions/54265982/go-channel-consume-data-from-channel-although-not-push-anything-to-channel", "title": "Go channel: consume data from channel although not push anything to channel", "body": "<p>For example I have this code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n\n    c1 := make(chan interface{})\n    close(c1)\n    c2 := make(chan interface{})\n    close(c2)\n\n    var c1Count, c2Count int\n    for i := 1000; i &gt;= 0; i-- {\n        select {\n        case &lt;-c1:\n            c1Count++\n        case &lt;-c2:\n            c2Count++\n        }\n\n    }\n    fmt.Printf(\"c1Count: %d\\nc2Count: %d\\n  \", c1Count, c2Count)\n}\n</code></pre>\n\n<p>When running, the output will be:</p>\n\n<pre><code>c1Count: 513\nc2Count: 488\n</code></pre>\n\n<p>The thing I don't know is: we create c1 and c2 channel without doing anything. Why in select/case block, c1Count and c2Count can increase value ?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["xml", "email", "go", "attachment", "gzip"], "comments": [{"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1547884441, "post_id": 54265102, "comment_id": 95353984, "body": "use compress gzip to convert the a.Data to uncompressed bytes then use encoding/xml on that to extract the content"}, {"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 1, "creation_date": 1547887047, "post_id": 54265102, "comment_id": 95354434, "body": "It is not clear where your problems actually are. Do you have problems extracting the attachment, decompressing the <code>*.gz</code> or processing the <code>*.xml</code> (whatever the result of this processing should be)?"}, {"owner": {"reputation": 41, "user_id": 10891052, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a5aq0pl4wyw/AAAAAAAAAAI/AAAAAAAAACI/pZJvZIp457Y/photo.jpg?sz=128", "display_name": "Avinash Ghadshi", "link": "https://stackoverflow.com/users/10891052/avinash-ghadshi"}, "edited": false, "score": 0, "creation_date": 1547891148, "post_id": 54265102, "comment_id": 95355215, "body": "I am getting data in a.data. but it is something like &amp;{[31 139 8 0 89 139 65 92 0 3 237 157 205 114 226 56 16 128 207 187 79 193 206 61 50 146 255 1......]}  i want this should be XML data...  while writing to STDOUT it is showing me in xml format, but when i use fmt.Println it is coming as numbers...  I am not getting how can i parse this ?  please suggest, i am new to golang"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1547904564, "post_id": 54265102, "comment_id": 95358280, "body": "Simply pass the gzip.Reader to <a href=\"https://golang.org/pkg/encoding/xml/#NewDecoder\" rel=\"nofollow noreferrer\">encoding/xml.NewDecoder</a>, then call <a href=\"https://golang.org/pkg/encoding/xml/#Decoder.Decode\" rel=\"nofollow noreferrer\">Decode</a>."}], "owner": {"reputation": 41, "user_id": 10891052, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a5aq0pl4wyw/AAAAAAAAAAI/AAAAAAAAACI/pZJvZIp457Y/photo.jpg?sz=128", "display_name": "Avinash Ghadshi", "link": "https://stackoverflow.com/users/10891052/avinash-ghadshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 220, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1547891398, "creation_date": 1547884058, "last_edit_date": 1547891398, "question_id": 54265102, "link": "https://stackoverflow.com/questions/54265102/how-to-parse-xml-gz-in-golang", "title": "How to parse xml.gz in golang", "body": "<p>I am new to Golang.\nI want to parse email attachment which is in format of xml.gz.\nI am not getting how can i manipulate string which i am getting in a.data\nHow can i achieve this in golang?</p>\n\n<p>My CODE:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"io\"\n    _ \"compress/gzip\"\n    \"github.com/DusanKasan/parsemail\"\n)\n\nvar reader io.Reader\nvar err error\n\nfunc main() {\n    fmt.Println(\"HIII.. THIS IS TESTING\")\n    reader, err = os.Open(\"4.raw\")\n    if err != nil {\n        fmt.Println(err)\n        os.Exit(0)\n    }\n    email, err := parsemail.Parse(reader)\n    if err != nil {\n        fmt.Println(err)\n        os.Exit(0)\n    }\n    for _, a := range(email.Attachments) {\n        r, _ := gzip.NewReader(a.Data)\n        io.Copy(os.Stdout, r)\n        r.Close()\n    }\n}\n</code></pre>\n\n<p>Now I am getting XML formatted data on terminal.\nBut I want same data in variable</p>\n\n<p>when I print r, it shows me something like &amp;{[31 139 8 0 89 139 65 92 0 3 237 157 205 114 226 56 16 128 207 187 79 193 206 61 50 146 255 1 ...... ]}</p>\n"}, {"tags": ["go", "uuid"], "answers": [{"comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1547905368, "post_id": 54264580, "comment_id": 95358458, "body": "A UUID is just 16 (for most intends and purposes random) bytes. Using them as is isn&#39;t an option for HTTP headers, because they don&#39;t allow binary data. One has to choose some encoding that produces only ASCII text, base64 being one of them."}], "tags": [], "owner": {"reputation": 1105, "user_id": 1262319, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pIk9w.jpg?s=128&g=1", "display_name": "Mostafa Solati", "link": "https://stackoverflow.com/users/1262319/mostafa-solati"}, "is_accepted": false, "score": 0, "last_activity_date": 1547881043, "last_edit_date": 1547881043, "creation_date": 1547878588, "answer_id": 54264580, "question_id": 54264176, "link": "https://stackoverflow.com/questions/54264176/base-64-encoding-of-uuid-use-as-access-token/54264580#54264580", "title": "Base 64 encoding of UUID - Use as access Token", "body": "<p>Yes it's unique because your uuid is unique.\nWhy don't you use uuid as token ? There is no need to base64 it you can use that as is.</p>\n"}, {"tags": [], "owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "is_accepted": false, "score": 1, "last_activity_date": 1547888087, "creation_date": 1547888087, "answer_id": 54265500, "question_id": 54264176, "link": "https://stackoverflow.com/questions/54264176/base-64-encoding-of-uuid-use-as-access-token/54265500#54265500", "title": "Base 64 encoding of UUID - Use as access Token", "body": "<p>Base64 is just an encoding. It neither removes information nor adds information. It is also reversible. Based on this the uniqueness of the base64 encoded uuid is exactly the same as of the non-encoded uuid.</p>\n"}], "owner": {"reputation": 835, "user_id": 4008473, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/bab2d01a5c2ce91bed8964aabf65527c?s=128&d=identicon&r=PG&f=1", "display_name": "user27111987", "link": "https://stackoverflow.com/users/4008473/user27111987"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 478, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1547888087, "creation_date": 1547873517, "question_id": 54264176, "link": "https://stackoverflow.com/questions/54264176/base-64-encoding-of-uuid-use-as-access-token", "title": "Base 64 encoding of UUID - Use as access Token", "body": "<p>I am writing a GoLang Oauth application in which I am using below method to generate a UUID and then generate accessToken from the UUID.</p>\n\n<pre><code>import \"github.com/pborman/uuid\"\nuuid := uuid.NewRandom()\naccessToken = base64.RawURLEncoding.EncodeToString([]byte(uuid)) \n</code></pre>\n\n<p>Wanted to know the base64 encoding of a token is as unique as UUID or not because accessToken will have unique index in my MYSQL db and will fail if there is a collision.</p>\n"}, {"tags": ["go", "dependency-injection"], "comments": [{"owner": {"reputation": 530, "user_id": 10753492, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vpFmr9vacTw/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jiHeIG7f13oRVc9pqOOOdXPCY9Gg/mo/photo.jpg?sz=128", "display_name": "user10753492", "link": "https://stackoverflow.com/users/10753492/user10753492"}, "edited": false, "score": 0, "creation_date": 1547909115, "post_id": 54262128, "comment_id": 95359305, "body": "What was your code like before you tried to adopt DI from that post?"}, {"owner": {"reputation": 5090, "user_id": 491770, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/I2mn1.png?s=128&g=1", "display_name": "Justin Thomas", "link": "https://stackoverflow.com/users/491770/justin-thomas"}, "edited": false, "score": 0, "creation_date": 1573678949, "post_id": 54262128, "comment_id": 103964669, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/41900053/is-there-a-better-dependency-injection-pattern-in-golang\">Is there a better dependency injection pattern in golang?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 87, "user_id": 4133880, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/4b2d07f4945d68a929f1317d5cd95f97?s=128&d=identicon&r=PG&f=1", "display_name": "Mital Awachat", "link": "https://stackoverflow.com/users/4133880/mital-awachat"}, "is_accepted": false, "score": 1, "last_activity_date": 1548180829, "creation_date": 1548180829, "answer_id": 54314215, "question_id": 54262128, "link": "https://stackoverflow.com/questions/54262128/dependency-injection-in-golang/54314215#54314215", "title": "Dependency injection in golang", "body": "<p>I've been using <a href=\"https://github.com/facebookgo/inject\" rel=\"nofollow noreferrer\">https://github.com/facebookgo/inject</a> for DI and <a href=\"https://github.com/golang/mock\" rel=\"nofollow noreferrer\">https://github.com/golang/mock</a> for mocking.\nFor example:</p>\n\n<pre><code>// some_entity_dao.go\ntype SomeEntity interface {\n    Find(ctx context.Context, condition *model.SomeEntity) (*model.SomeEntity, error)\n    FindAll(ctx context.Context, condition *model.SomeEntity) ([]*model.SomeEntity, error)\n    Save(ctx context.Context, data *model.SomeEntity) error\n    Update(ctx context.Context, condition *model.SomeEntity, data *model.SomeEntity) error\n    Delete(ctx context.Context, condition *model.SomeEntity) error\n}\n</code></pre>\n\n<p>And generate mock implementation using:</p>\n\n<pre><code>//go:generate mockgen -source=./some_entity_dao.go -destination=./some_entity_dao_mock_impl.go -package dao\n</code></pre>\n\n<p>Then use this mock implementation in writing unit tests.</p>\n"}], "owner": {"reputation": 351, "user_id": 10816571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45aa02b808aa538cdaa37ed33a8557e9?s=128&d=identicon&r=PG&f=1", "display_name": "Rayn D", "link": "https://stackoverflow.com/users/10816571/rayn-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1666, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1548180829, "creation_date": 1547849794, "last_edit_date": 1547931959, "question_id": 54262128, "link": "https://stackoverflow.com/questions/54262128/dependency-injection-in-golang", "title": "Dependency injection in golang", "body": "<p>I have previous code which works like following:</p>\n\n<blockquote>\n  <ol>\n  <li>call to function <code>getData</code> which provide you data to execute the http request</li>\n  <li>use the <code>getData</code> function output to execute the http request.</li>\n  </ol>\n</blockquote>\n\n<p>This is works before, but now I want to make unit test for it, and I read some blogs how to make this work and it seems that the dependency injection is the key to do it. I tried to follow <a href=\"https://appliedgo.net/di/\" rel=\"nofollow noreferrer\">this post</a>.</p>\n\n<p>I try to adopt the code but not sure if I did it right.</p>\n\n<p>The idea is to use <code>getData</code> function in prod with some url to execute and in the <code>unit test</code> provide diffrent url like from <code>httptest.NewServer(testHandler)</code>\nHow should I make it right in Go? </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n)\n\ntype requester interface {\n    HTTPRequest(c string, i string, mtd string, url string) (p []byte, e error)\n}\nfunc (i impl) HTTPRequest(c string, ci string, mtd string, url string) (p []byte, e error) {\n    req, err := http.NewRequest(mtd, url, nil)\n    if err != nil {\n        return nil, err\n    }\n    req.SetBasicAuth(c, ci)\n    res, err := i.client.Do(req)\n    if err != nil {\n        return nil, err\n    }\n    token, err := ioutil.ReadAll(res.Body)\n    if err != nil {\n        return nil, err\n    }\n    defer res.Body.Close()\n    fmt.Println(\"success\")\n    return token, nil\n}\n\ntype iData interface {\n    getData() []string\n}\n\ntype reqData struct {\n    f1 string\n    f2 string\n}\n\nfunc (s reqData) getData() []string {\n    a := make([]string, 4)\n    a[2] = \"http://www.mocky.io/v2/5c20eccc2e00005c001e0c84\"\n    a[3] = \"/oauth/token?grant_type=client_credentials\"\n    return a\n}\n\ntype ServiceInfo struct {\n    req  requester\n    data iData\n}\n\ntype impl struct {\n    client *http.Client\n}\n\nfunc NewServiceInfo(http requester, data iData) *ServiceInfo {\n    return &amp;ServiceInfo{\n        req:  http,\n        data: data,\n    }\n}\n\n// ----This is the function which I need to mock\nfunc (s *ServiceInfo) caller() {\n    // Function 1 - get the values\n    reqdata := s.data.getData()\n    // Function 2 -call to http function\n    s.req.HTTPRequest(reqdata[0], reqdata[1], \"POST\", reqdata[2])\n}\n\n    func main() {\n// not sure how to run it \n        //httpClient := http.Client{}\n        //d := reqData{f1: \"user\", f2: \"password\"}\n\n        //s := NewServiceInfo(impl{client: &amp;httpClient}, d.getData())\n        //s.caller()\n    }\n</code></pre>\n\n<p>The test looks something like this but really not sure how to make it work</p>\n\n<pre><code>    It(\"Test\", func() {\n\n                    // Mock http call\n                    server := httptest.NewServer(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n                        u, p, ok := r.BasicAuth()\n                        \u03a9(ok).Should(Equal(true))\n                        \u03a9(u).Should(Equal(\"user\"))\n                        \u03a9(p).Should(Equal(\"password\"))\n                    }))\n\n                    var httpClient = http.Client{}\n                    si := NewServiceInfo(client{httpClient: &amp;httpClient, url: server.URL})\n                    t, err := si.r.httpReq(\"user\", \"password\", http.MethodPost)\n\n                    \u03a9(token).Should(Equal(string(t)))\n                    \u03a9(err).ShouldNot(HaveOccurred())\n\n                })\n\n</code></pre>\n\n<p>The code is just and example to my complete code so I try take it and put only the relevant parts </p>\n\n<p><strong>update</strong> \nto make it more clear :) </p>\n\n<p>What I need is how to mock (right way) the function <code>getData</code> ,\nto provide <code>url x</code> in prod code and <code>url y</code> in test, the nuance here that I need to make a unit test to the function <code>caller</code> </p>\n\n<p>To make it <strong>work this is not an issue</strong> but the issue here to make it <strong>testable code</strong></p>\n\n<p><a href=\"https://play.golang.org/p/UQqtZmNS5BK\" rel=\"nofollow noreferrer\">https://play.golang.org/p/UQqtZmNS5BK</a></p>\n"}, {"tags": ["go", "concurrency", "goroutine"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1547848275, "post_id": 54261875, "comment_id": 95347917, "body": "There are other background goroutines spawned by the runtime and by functionality you&#39;re using from the standard library. Is there actually a problem?"}, {"owner": {"reputation": 89, "user_id": 10548774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4a7a21d3f381f8dfbefd009871b4b26?s=128&d=identicon&r=PG&f=1", "display_name": "dircrys", "link": "https://stackoverflow.com/users/10548774/dircrys"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1547848423, "post_id": 54261875, "comment_id": 95347959, "body": "@Adrian The problem is really the random spikes, if it was consistently three times as high as I &#39;want&#39; then that would be fine (ish)"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1547848666, "post_id": 54261875, "comment_id": 95348009, "body": "But why do you want that? Unless you&#39;re hitting a memory or CPU constraint, it seems like you don&#39;t actually have a problem."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1547848769, "post_id": 54261875, "comment_id": 95348038, "body": "I assume <code>getIndividualScrape</code> is making some sort of http request? Which of course can start multiple goroutines of its own. The problem is not in this part of the code, but in your handling of the http client."}, {"owner": {"reputation": 89, "user_id": 10548774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4a7a21d3f381f8dfbefd009871b4b26?s=128&d=identicon&r=PG&f=1", "display_name": "dircrys", "link": "https://stackoverflow.com/users/10548774/dircrys"}, "edited": false, "score": 0, "creation_date": 1547848780, "post_id": 54261875, "comment_id": 95348044, "body": "The initial issue was that I was hitting a file descriptor limit because of the HTTP requests the goroutines trigger. But now I&#39;d also like to know why the number is so variable."}, {"owner": {"reputation": 89, "user_id": 10548774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4a7a21d3f381f8dfbefd009871b4b26?s=128&d=identicon&r=PG&f=1", "display_name": "dircrys", "link": "https://stackoverflow.com/users/10548774/dircrys"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1547848840, "post_id": 54261875, "comment_id": 95348069, "body": "@JimB yeah, exactly it makes an HTTP request. I get that it can trigger more goroutines, but do you know why the number of goroutines it triggers might not be constant?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1547848967, "post_id": 54261875, "comment_id": 95348114, "body": "@dircrys: I can&#39;t say without the code, but chances are idle connections have something to do with it."}, {"owner": {"reputation": 89, "user_id": 10548774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4a7a21d3f381f8dfbefd009871b4b26?s=128&d=identicon&r=PG&f=1", "display_name": "dircrys", "link": "https://stackoverflow.com/users/10548774/dircrys"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1547849137, "post_id": 54261875, "comment_id": 95348169, "body": "@JimB, I just updated my answer to include the method which sends the http request - I thought it would be okay since I closed the resp.body though?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1547849692, "post_id": 54261875, "comment_id": 95348335, "body": "To start, nothing is &quot;leaking&quot; goroutines, just because there&#39;s a spike. If it&#39;s possible to be connecting to the same host repeatedly and concurrently, your default transport is only going to store a max of 2 idle conns per host, which may be causing you to open and close connections too quickly. The DeafultTransport also will hold up to 100 idle conns (which is at least 200 goroutines) until they are closed by the server."}, {"owner": {"reputation": 89, "user_id": 10548774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4a7a21d3f381f8dfbefd009871b4b26?s=128&d=identicon&r=PG&f=1", "display_name": "dircrys", "link": "https://stackoverflow.com/users/10548774/dircrys"}, "edited": false, "score": 0, "creation_date": 1547850051, "post_id": 54261875, "comment_id": 95348441, "body": "Okay, that sounds okay then? Do you know if there&#39;s anything I can do to stop the variance in active goroutines or am I just going to have to accept it?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1547850686, "post_id": 54261875, "comment_id": 95348634, "body": "Set <code>MaxIdleConnsPerHost</code> to your expected max concurrency per-host? Set <code>MaxConnsPerHost</code> to limit concurrency to a host (80 connections to a single host isn&#39;t going to gain you anything). Lower <code>IdleConnTimeout</code> to close the connections sooner? Make sure your overall concurrency is sensible? (again 80 concurrent connections may not be useful). Lower timeouts to bypass unresponsive hosts more quickly? Only you can make these decisions, based on your systems, your data, etc."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1548125917, "post_id": 54261875, "comment_id": 95421483, "body": "nitpick, but don&#39;t use http.Get  <a href=\"https://medium.com/@nate510/don-t-use-go-s-default-http-client-4804cb19f779\" rel=\"nofollow noreferrer\">medium.com/@nate510/&hellip;</a> You can end up with your connections being seized by a bad host keeping go-routines out of play and locking up your resources."}], "owner": {"reputation": 89, "user_id": 10548774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4a7a21d3f381f8dfbefd009871b4b26?s=128&d=identicon&r=PG&f=1", "display_name": "dircrys", "link": "https://stackoverflow.com/users/10548774/dircrys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548125797, "creation_date": 1547848144, "last_edit_date": 1548125797, "question_id": 54261875, "link": "https://stackoverflow.com/questions/54261875/leaking-goroutines-typically-have-three-times-as-many-running-as-i-want", "title": "Leaking goroutines, typically have three times as many running as I want", "body": "<p>I'm trying to make a web scraper, which can run a decent number (many thousands) of http queries per minute. The actual querying is fine but to speed up the process. I'm trying to make it concurrent. Initially I spawned a goroutine for each request but I ran out of file descriptors so after some googling I decided to use a semaphore to limit the number of concurrent goroutines. </p>\n\n<p>Only I can't get this to work.</p>\n\n<p>I've tried moving bits of code around but I always have the same issue: I have roughly three times as many goroutines running as I want</p>\n\n<p>This is the only method I have that spawns goroutines. I limited the goroutines to 80. In my benchmarks I run this against a slice of 10000 URLs and it tends to hover at about 242 concurrent goroutines in flight, but then it suddenly goes up to almost double this and then back down to 242. </p>\n\n<p>I get the same behaviour if I change the concurrent value from 80 - it usually hovers at just over three times the number of goroutines and sometimes spikes to around double that and I have no idea why.</p>\n\n<pre><code>func (B BrandScraper) ScrapeUrls(URLs ...string) []scrapeResponse {\n    concurrent := 80\n    semaphoreChan := make(chan struct{}, concurrent)\n    scrapeResults := make([]scrapeResponse, len(URLs))\n    for _, URL := range URLs {\n        semaphoreChan &lt;- struct{}{}\n        go func(URL string) {\n            defer func() {\n                &lt;-semaphoreChan\n            }()\n            scrapeResults = append(scrapeResults,\n                B.getIndividualScrape(URL))\n            fmt.Printf(\"#goroutines: %d\\n\", runtime.NumGoroutine())\n        }(URL)\n    }\n    return scrapeResults\n}\n</code></pre>\n\n<p>I'm expecting it to be constantly at 80 goroutines - or at least constant. </p>\n\n<p>This happens when I run it from a benchmarking test or when i run it from the main function.</p>\n\n<p>Thanks very much for any tips!</p>\n\n<p>EDIT</p>\n\n<pre><code>getIndividualScrape\n</code></pre>\n\n<p>calls another function:</p>\n\n<pre><code>func (B BrandScraper) doGetRequest(URL string) io.Reader {\n    resp, err := http.Get(URL)\n    if err != nil {\n        log.Fatal(err)\n    }\n    body, _ := ioutil.ReadAll(resp.Body)\n    resp.Body.Close()\n    return bytes.NewReader(body)\n}\n</code></pre>\n\n<p>which obviously does an HTTP request. Could this be leaking goroutines? I thought since I'd closed the <code>resp.Body</code> I'd have covered that but maybe not?</p>\n"}]