[{"tags": ["go", "error-handling", "null"], "answers": [{"comments": [{"owner": {"reputation": 956, "user_id": 1207791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f097e2409f02bfcaf6f53cfca268401f?s=128&d=identicon&r=PG", "display_name": "cfstras", "link": "https://stackoverflow.com/users/1207791/cfstras"}, "edited": false, "score": 0, "creation_date": 1476955404, "post_id": 40142849, "comment_id": 67569848, "body": "While this does not crash, it still echoes &quot;got error&quot; -- even though the error value passed is actually nil?"}], "tags": [], "owner": {"reputation": 3311, "user_id": 61363, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30ed41f682f716613fe62a0831f522dd?s=128&d=identicon&r=PG", "display_name": "del-boy", "link": "https://stackoverflow.com/users/61363/del-boy"}, "is_accepted": false, "score": 0, "last_activity_date": 1476917995, "creation_date": 1476917995, "answer_id": 40142849, "question_id": 40142806, "link": "https://stackoverflow.com/questions/40142806/nil-test-on-interface-fails/40142849#40142849", "title": "nil test on interface fails", "body": "<p>You were on the right track. Thing is that you are returning pointer to struct and your <code>Error</code> method is implemented with non-pointer caller. </p>\n\n<p>Following should work (I only added <code>*</code> for receiver of <code>Error</code> method:</p>\n\n<pre><code>package main\n\nimport \"log\"\n\ntype E struct{}\n\nfunc (e *E) Error() string {\n    return \"\"\n}\n\nfunc DoStuff() *E {\n    return nil\n}\n\nfunc main() {\n    var err *E\n    err = DoStuff()\n    log.Println(err) // nil\n    testErr(err)\n}\n\nfunc testErr(err error) {\n    if err != nil {\n        log.Println(\"got error\", err.Error())\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 956, "user_id": 1207791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f097e2409f02bfcaf6f53cfca268401f?s=128&d=identicon&r=PG", "display_name": "cfstras", "link": "https://stackoverflow.com/users/1207791/cfstras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 1, "closed_date": 1476919370, "answer_count": 1, "score": -1, "last_activity_date": 1476917995, "creation_date": 1476917691, "question_id": 40142806, "link": "https://stackoverflow.com/questions/40142806/nil-test-on-interface-fails", "closed_reason": "Duplicate", "title": "nil test on interface fails", "body": "<p>Can someone explain this go code to me?<br>\nWhen this is invoked, the <code>err != nil</code> returns true, thus leading to a nil pointer reference.</p>\n\n<pre><code>type E struct{}\n\nfunc (e E) Error() string {\n    return \"\"\n}\n\nfunc DoStuff() *E {\n    return nil\n}\n\nfunc main() {\n    var err *E\n    err = DoStuff()\n    log.Println(err) // nil\n    testErr(err)\n}\n\nfunc testErr(err error) {\n    if err != nil {\n        log.Println(\"got error\", err.Error())\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/iys7U_UMhG\" rel=\"nofollow\">https://play.golang.org/p/iys7U_UMhG</a></p>\n\n<p>I have understood that this has something to do with the fact that I am dealing with a nil-struct-pointer casted to an interface...</p>\n\n<p>However I am confused how to design this interface <code>DoStuff</code>, if one wants to return a \"smart\" error object, not just plain <code>error</code>.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 3178, "user_id": 32032, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/65bde8d6633e09cab738956cfd2d6ee5?s=128&d=identicon&r=PG", "display_name": "coulix", "link": "https://stackoverflow.com/users/32032/coulix"}, "edited": false, "score": 0, "creation_date": 1476914642, "post_id": 40142237, "comment_id": 67554465, "body": "The struct is the same, you mean `\tBitmap *image.Image` -&gt; <code>Bitmap image.Image</code>. The program was working, was I just lucky?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 3178, "user_id": 32032, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/65bde8d6633e09cab738956cfd2d6ee5?s=128&d=identicon&r=PG", "display_name": "coulix", "link": "https://stackoverflow.com/users/32032/coulix"}, "edited": false, "score": 0, "creation_date": 1476914674, "post_id": 40142237, "comment_id": 67554479, "body": "@coulix, oops, yes"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 3178, "user_id": 32032, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/65bde8d6633e09cab738956cfd2d6ee5?s=128&d=identicon&r=PG", "display_name": "coulix", "link": "https://stackoverflow.com/users/32032/coulix"}, "edited": false, "score": 0, "creation_date": 1476914732, "post_id": 40142237, "comment_id": 67554499, "body": "@coulix, you weren&#39;t &quot;lucky&quot;, it will work this way, but there&#39;s no reason for it, and only makes life difficult."}, {"owner": {"reputation": 3178, "user_id": 32032, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/65bde8d6633e09cab738956cfd2d6ee5?s=128&d=identicon&r=PG", "display_name": "coulix", "link": "https://stackoverflow.com/users/32032/coulix"}, "edited": false, "score": 0, "creation_date": 1476914861, "post_id": 40142237, "comment_id": 67554546, "body": "<code>(*img.Bitmap).Bounds()</code> I am now getting an ./image.go:65: invalid indirect of img.Bitmap (type image.Image). At this point I dont need to dereference <code>img.Bitmap</code> right?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 3178, "user_id": 32032, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/65bde8d6633e09cab738956cfd2d6ee5?s=128&d=identicon&r=PG", "display_name": "coulix", "link": "https://stackoverflow.com/users/32032/coulix"}, "edited": false, "score": 0, "creation_date": 1476915099, "post_id": 40142237, "comment_id": 67554637, "body": "@coulix: yes. If you get rid of the unnecessary pointer, you don&#39;t have to dereference it."}, {"owner": {"reputation": 3025, "user_id": 4660602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iYRGR.jpg?s=128&g=1", "display_name": "Geoherna", "link": "https://stackoverflow.com/users/4660602/geoherna"}, "edited": false, "score": 0, "creation_date": 1476915726, "post_id": 40142237, "comment_id": 67554881, "body": "Good answer JimB, especially for pointing out pointer to interface not being ideal."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1476915124, "last_edit_date": 1476915124, "creation_date": 1476914469, "answer_id": 40142237, "question_id": 40142146, "link": "https://stackoverflow.com/questions/40142146/understanding-gometalinter-unconvert-unnecessary-conversion-warning/40142237#40142237", "title": "Understanding gometalinter unconvert unnecessary conversion warning", "body": "<p>First, the bitmap field is a <code>*image.Image</code>, so it's of the same type and you don't need to convert it when you could just dereference it.</p>\n\n<pre><code>(*img.Bitmap).Bounds()\n</code></pre>\n\n<p>However, <code>image.Image</code> is an interface. A pointer to an interface is almost always a programming error.</p>\n\n<p>Change your struct definition to</p>\n\n<pre><code>type Image struct {\n    Src    string\n    Title  string\n    Width  int\n    Height int\n    Index  int\n    Bitmap image.Image\n}\n</code></pre>\n\n<p>and you can then just call <code>img.Bitmap.Bounds()</code> directly</p>\n"}], "owner": {"reputation": 3178, "user_id": 32032, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/65bde8d6633e09cab738956cfd2d6ee5?s=128&d=identicon&r=PG", "display_name": "coulix", "link": "https://stackoverflow.com/users/32032/coulix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 448, "favorite_count": 0, "accepted_answer_id": 40142237, "answer_count": 1, "score": 0, "last_activity_date": 1476915124, "creation_date": 1476914111, "question_id": 40142146, "link": "https://stackoverflow.com/questions/40142146/understanding-gometalinter-unconvert-unnecessary-conversion-warning", "title": "Understanding gometalinter unconvert unnecessary conversion warning", "body": "<p><code>warning: unnecessary conversion (unconvert)</code></p>\n\n<p>This comes from the following line:</p>\n\n<p><code>offsetY += 60 + image.Image(*img.Bitmap).Bounds().Max.Y</code></p>\n\n<p>It took me a while to understand how to convert this interface pointer to an interface yet I do not think that this is the right solution since gometalinter raises a warning.</p>\n\n<p>I want to get the width of the <code>img</code>.\n<code>img</code> is of struct <code>Image</code> and has a Bitmap pointer to a real <code>image.Image</code> (image stdlib). If I want to call <code>Bounds</code> on the actual <code>image.Image</code> I need to transform the pointer to the interface into an interface.  </p>\n\n<p>How should that be done in a more go friendly way?</p>\n\n<p>I have the following go code:</p>\n\n<pre><code>import (\n    \"image\"\n    \"image/color\"\n    \"image/draw\"\n)\ntype Image struct {\n    Src    string\n    Title  string\n    Width  int\n    Height int\n    Index  int\n    Bitmap *image.Image\n}\n\ntype Images []Image\n\noffsetY = 10\nfunc ComposeImage(imgs Images) image.Image {\n    masterRGBAImg := image.NewRGBA(image.Rect(0, 0, 300, 300))\n    masterBounds := masterRGBAImg.Bounds()\n\n    for _, img := range imgs {\n        draw.Draw(masterRGBAImg, masterBounds,\n            *img.Bitmap, image.Point{X: -10, Y: -offsetY + 10}, draw.Src)\n\n\n        addLabel(masterRGBAImg, 10, offsetY-30, img.Title)\n\n        // HERE ======\n        offsetY += 60 + image.Image(*img.Bitmap).Bounds().Max.Y\n        // END ======\n\n    }\n    return masterRGBAImg\n}\n\n// Draw label on image.\nfunc addLabel(img *image.RGBA, x int, y int, label string) {\n    col := color.RGBA{50, 50, 50, 255}\n    point := fixed.Point26_6{X: fixed.Int26_6(x * 64), Y: fixed.Int26_6(y * 64)}\n\n    d := &amp;font.Drawer{\n        Dst:  img,\n        Src:  image.NewUniform(col),\n        Face: inconsolata.Bold8x16,\n        Dot:  point,\n    }\n    d.DrawString(label)\n}\n</code></pre>\n"}, {"tags": ["go", "error-handling"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1476913928, "post_id": 40142060, "comment_id": 67554210, "body": "You don&#39;t need to handle errors that can&#39;t happen, or couldn&#39;t be handled. The <code>digest.Write</code> methods only returns an error to conform to the <code>io.Writer</code> interface. You usually won&#39;t see anyone checking the errors from <code>fmt.Println</code> either."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 1, "creation_date": 1476915072, "post_id": 40142060, "comment_id": 67554621, "body": "this is a good reading for you <a href=\"http://dave.cheney.net/2016/04/27/dont-just-check-errors-handle-them-gracefully\" rel=\"nofollow noreferrer\">dave.cheney.net/2016/04/27/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3311, "user_id": 61363, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30ed41f682f716613fe62a0831f522dd?s=128&d=identicon&r=PG", "display_name": "del-boy", "link": "https://stackoverflow.com/users/61363/del-boy"}, "is_accepted": true, "score": 1, "last_activity_date": 1476918881, "creation_date": 1476918881, "answer_id": 40142992, "question_id": 40142060, "link": "https://stackoverflow.com/questions/40142060/is-it-idiomatic-in-go-to-handle-all-returned-errors/40142992#40142992", "title": "Is it idiomatic in go to handle all returned errors?", "body": "<p>In situation that you described, you will probably be fine with not checking error, same as not checking errors when using <code>fmt.Println</code>. </p>\n\n<p>However, when you use <code>fmt.Println</code> you know which concrete implementations are being used. When you are using <code>Writer</code> interface (which <code>os.Stdout</code> implements) - you can not assume if implementation will return any errors. In that case, IMHO, you should always check errors.</p>\n\n<p>Btw, writing to <code>os.Stdout</code>, which <code>fmt.Print</code> uses, can fail (one might be able to replace value of <code>os.Stdout</code> to something else).</p>\n"}], "owner": {"reputation": 13, "user_id": 4944254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6369a4e740e10420d814512a308713b?s=128&d=identicon&r=PG&f=1", "display_name": "jonas", "link": "https://stackoverflow.com/users/4944254/jonas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 40142992, "answer_count": 1, "score": 1, "last_activity_date": 1476918881, "creation_date": 1476913648, "last_edit_date": 1495541957, "question_id": 40142060, "link": "https://stackoverflow.com/questions/40142060/is-it-idiomatic-in-go-to-handle-all-returned-errors", "title": "Is it idiomatic in go to handle all returned errors?", "body": "<p>Many functions in go return errors to fit an interface, but these errors are always nil. Should these errors still be checked?</p>\n\n<p>An example for this is the <a href=\"https://golang.org/src/crypto/sha1/sha1.go?s=1064:1418\" rel=\"nofollow noreferrer\">crypto/sha1 Write() function</a>, which does not set the err value. So the code does not need to be:</p>\n\n<pre><code>_, err = sha1Hasher.Write(buffer)\nif err != nil {\n    log.Printf(\"sha1 could not be calculated (%s)\", err)\n}\n</code></pre>\n\n<p>but only:</p>\n\n<pre><code>sha1Hasher.Write(buffer)\n</code></pre>\n\n<p>The second option is shorter and cleaner and go is a lot about simple code but it is suggested to handle all errors:</p>\n\n<blockquote>\n  <p>But remember: Whatever you do, always check your errors!</p>\n</blockquote>\n\n<p><a href=\"https://blog.golang.org/errors-are-values\" rel=\"nofollow noreferrer\">https://blog.golang.org/errors-are-values</a></p>\n\n<blockquote>\n  <p>Clearly, we must handle any errors; we can't just ignore them.</p>\n</blockquote>\n\n<p><a href=\"https://stackoverflow.com/a/16126516/4944254\">https://stackoverflow.com/a/16126516/4944254</a></p>\n\n<p>Which is the best way to go?</p>\n"}, {"tags": ["c", "go", "compilation", "binary"], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1476910371, "post_id": 40141212, "comment_id": 67552575, "body": "And the docs aren&#39;t update for later than go1.7, which compiles that program to around 1.4M (and ~1M if you link with <code>-w</code> and <code>-s</code>)"}], "tags": [], "owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "is_accepted": true, "score": 6, "last_activity_date": 1476909917, "creation_date": 1476909917, "answer_id": 40141212, "question_id": 40141143, "link": "https://stackoverflow.com/questions/40141143/go-binary-size-in-comparison-with-c/40141212#40141212", "title": "Go binary size in comparison with c", "body": "<p>Go binaries are, by default, statically linked, and also contain more information such as information about types that allows for reflection, type assertions, and so on. To quote the <a href=\"https://golang.org/doc/faq#Why_is_my_trivial_program_such_a_large_binary\" rel=\"noreferrer\">Go FAQ</a>:</p>\n\n<blockquote>\n  <p>The linker in the gc tool chain creates statically-linked binaries by\n  default. All Go binaries therefore include the Go run-time, along with\n  the run-time type information necessary to support dynamic type\n  checks, reflection, and even panic-time stack traces.</p>\n  \n  <p>A simple C \"hello, world\" program compiled and linked statically using\n  gcc on Linux is around 750 kB, including an implementation of printf.\n  An equivalent Go program using fmt.Printf is around 2.3 MB, but that\n  includes more powerful run-time support and type information.</p>\n</blockquote>\n"}], "owner": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1178, "favorite_count": 0, "closed_date": 1476917099, "accepted_answer_id": 40141212, "answer_count": 1, "score": -1, "last_activity_date": 1476909927, "creation_date": 1476909693, "question_id": 40141143, "link": "https://stackoverflow.com/questions/40141143/go-binary-size-in-comparison-with-c", "closed_reason": "Duplicate", "title": "Go binary size in comparison with c", "body": "<p>Yesterday I just wanted to compare simple golang <code>HelloWorld</code> app with c, go binary was something like <code>2-3 MB</code> (just <code>fmt.Println</code>) the equivalent c code, however, was just about 20 kb (<code>printf</code>). Then I checked system calls both binaries were doing, using <code>strace</code>; there was not a huge difference between both so do you have any idea why golang binary is so massive in comparison with c equivalent?</p>\n"}, {"tags": ["json", "forms", "postgresql", "http", "go"], "comments": [{"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "edited": false, "score": 5, "creation_date": 1476908212, "post_id": 40140044, "comment_id": 67551481, "body": "You should probably read this: <a href=\"http://www.florinpatan.ro/2016/10/why-you-should-not-use-iris-for-your-go.html\" rel=\"nofollow noreferrer\">Why you should not use iris for your Go projects</a>. I&#39;m not saying you need to switch, but you should at least be aware of the concerns that many in the community have about Iris."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 3, "creation_date": 1476909303, "post_id": 40140044, "comment_id": 67552060, "body": "actually there&#39;s no reason to use a framework in Go at all, that&#39;s what I most like about Go"}, {"owner": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "edited": false, "score": 0, "creation_date": 1476912535, "post_id": 40140044, "comment_id": 67553610, "body": "At least I found out now rather than later."}, {"owner": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "edited": false, "score": 0, "creation_date": 1476912548, "post_id": 40140044, "comment_id": 67553616, "body": "Thank you for sharing the article and your advice"}], "answers": [{"comments": [{"owner": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "edited": false, "score": 1, "creation_date": 1476966472, "post_id": 40147149, "comment_id": 67577601, "body": "Thanks for the answer! and great validation article, I actually wanted to make sure that no dangerous input could be inserted into the database so essentially I need to clean(sanitize) the inserted parameters over and above the validation process especially seen as though I will be handling html insertion. Thanks again for the answer!"}], "tags": [], "owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "is_accepted": false, "score": 13, "last_activity_date": 1590100783, "last_edit_date": 1590100783, "creation_date": 1476945661, "answer_id": 40147149, "question_id": 40140044, "link": "https://stackoverflow.com/questions/40140044/how-to-sanitize-input-data-in-golang/40147149#40147149", "title": "How to sanitize input data in golang?", "body": "<p>For HTML Sanitizing you could try <a href=\"https://github.com/microcosm-cc/bluemonday\" rel=\"nofollow noreferrer\"><code>github.com/microcosm-cc/bluemonday</code></a>.</p>\n\n<p>For validating JSON input data as per rules you set.</p>\n\n<p>This <a href=\"http://brandonokert.com/articles/json-management-patterns-in-go/\" rel=\"nofollow noreferrer\">article</a> is a good read on the topic.</p>\n\n<p>An example from the article.</p>\n\n<pre><code>type User struct {\n     Name string    `json:\"name\"    validate:\"nonzero\"`\n     Age uint       `json:\"age\"     validate:\"min=1\"`\n     Address string `json:\"address\" validate:\"nonzero\"`\n}\n</code></pre>\n\n<p>The package used for validation is <a href=\"https://godoc.org/gopkg.in/validator.v2#hdr-Builtin_validator_functions\" rel=\"nofollow noreferrer\"><code>gopkg.in/validator.v2</code></a></p>\n\n<p>Usage : </p>\n\n<pre><code>user := &amp;models.User{}\nif err = c.ReadJSON(user); err != nil {\n    // Handle Error\n}\n\np := bluemonday.UGCPolicy()\nuser.Name, user.Address = p.Sanitize(user.Name),p.Sanitize(user.Address)\n\nif err = validator.Validate(user); err != nil {\n   // Handle Error\n}\n\nerr = db.Create(&amp;user)\nif err != nil {\n    // Handle Error\n}\n</code></pre>\n"}], "owner": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10464, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1590100783, "creation_date": 1476905548, "last_edit_date": 1476967354, "question_id": 40140044, "link": "https://stackoverflow.com/questions/40140044/how-to-sanitize-input-data-in-golang", "title": "How to sanitize input data in golang?", "body": "<p>I am trying to sanitize input shortly before marshaling the submitted data into a specified struct.</p>\n\n<p>Here is the model that I am using.</p>\n\n<pre><code>type Post struct {\n    Id               int       `json:\"Id\"`\n    CreatedAt        time.Time `json:\"CreatedAt\"`\n    UpdatedAt        time.Time `json:\"UpdatedAt\"`\n    CreatorId        int       `json:\"CreatorId\"`\n    Creator          *User\n    Editors          []int  `json:\"Editors\"`\n    Status           Status `json:\"Status\"`\n    Title            string `json:\"Title\"`\n    ShortDescription string `json:\"ShortDescription\"`\n    Description      string `json:\"Description\"`\n    Content          string `json:\"Content\"`\n    Url              string `json:\"Url\"`\n    Media            *Media\n    Categories       []Category `json:\"Categories\"`\n    Tags             []Tag      `json:\"Tags\"`\n    MediaId          int        `json:\"MediaId\"`\n    Keywords         string     `json:\"Keywords\"`\n    Data             []string   `json:\"Data\"`\n}\n</code></pre>\n\n<p>Here is an example of a possible submitted JSON data</p>\n\n<pre><code>{\"Id\":1,\"CreatedAt\":\"2016-10-11T21:29:46.134+02:00\",\"UpdatedAt\":\"0001-01-01T00:00:00Z\",\"CreatorId\":1,\"Editors\":null,\"Status\":1,\"Title\":\"This is the title of the first post, to be changed.&lt;script&gt;alert()&lt;/script&gt;\",\"ShortDescription\":\"this is the short description of this post\",\"Description\":\"\",\"Content\":\"Contrary to popular belief Lorem Ipsum is not simply random text. It has roots in a piece of classical Latin literature from 45 BC making it over 2000 years old. Richard McClintock\",\"Url\":\"lorem-ipsum-first\"}\n</code></pre>\n\n<p>How would I most effectively sanitize the above JSON form data during the <code>ReadJSON</code> request and before data insertion during this process, thus removing any malicious code as seen with <code>&lt;script&gt;alert()&lt;/script&gt;.</code>?\nIf there is any additional information that could be of use please ask and I will be glad to add it.\nThanks</p>\n"}, {"tags": ["go", "profiling"], "answers": [{"comments": [{"owner": {"reputation": 1069, "user_id": 3806343, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/tzFZo.png?s=128&g=1", "display_name": "cookieisaac", "link": "https://stackoverflow.com/users/3806343/cookieisaac"}, "edited": false, "score": 0, "creation_date": 1476906827, "post_id": 40140253, "comment_id": 67550673, "body": "Is it possible to get the CPU profile handler <code>f</code> that <code>go test</code> has set for me so that I only need to wrap a specific section with <code>StartCPUProfile(f)</code> and <code>StopCPUProfile()</code> in my test case while still using the same <code>go test</code> CLI?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1069, "user_id": 3806343, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/tzFZo.png?s=128&g=1", "display_name": "cookieisaac", "link": "https://stackoverflow.com/users/3806343/cookieisaac"}, "edited": false, "score": 0, "creation_date": 1476908805, "post_id": 40140253, "comment_id": 67551821, "body": "@cookieisaac: no, because <code>go test</code> will have already started a cpu profile, and there can only be one running. You could however just define your own flag, i.e. <code>-testprofile</code>"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 1, "last_activity_date": 1476906310, "creation_date": 1476906310, "answer_id": 40140253, "question_id": 40139983, "link": "https://stackoverflow.com/questions/40139983/how-to-time-and-profile-a-section-of-a-program-in-golang-with-go-test/40140253#40140253", "title": "How to time and profile a *section* of a program in golang with `go test`?", "body": "<p>If you don't want to profile the entire program, you can start and stop a CPUProfile yourself using the <a href=\"https://golang.org/pkg/runtime/pprof/\" rel=\"nofollow\"><code>runtime/pprof</code></a> package:</p>\n\n<pre><code>f, err := os.Create(profileFileName)\nif err != nil {\n    log.Fatal(\"could not create CPU profile: \", err)\n}\nif err := pprof.StartCPUProfile(f); err != nil {\n    log.Fatal(\"could not start CPU profile: \", err)\n}\ndefer pprof.StopCPUProfile()\n</code></pre>\n"}], "owner": {"reputation": 1069, "user_id": 3806343, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/tzFZo.png?s=128&g=1", "display_name": "cookieisaac", "link": "https://stackoverflow.com/users/3806343/cookieisaac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1476906310, "creation_date": 1476905288, "question_id": 40139983, "link": "https://stackoverflow.com/questions/40139983/how-to-time-and-profile-a-section-of-a-program-in-golang-with-go-test", "title": "How to time and profile a *section* of a program in golang with `go test`?", "body": "<p><strong>Question</strong>: How to time and profile a <em>section</em> of a program in golang with <code>go test</code>?</p>\n\n<p><strong>Use Case</strong>: I have a concurrent bulk operation processing algorithm for B+tree. I am using <code>go test</code> to do the profiling and compare to other baseline algorithms(serialized version, pessimistic locking etc). For the test case setup, I will create a B+tree with 1M entries and create a list of 1M operations, then I start the actual test to <code>BulkProcess</code> these operations.</p>\n\n<pre><code>func TestInputTreeM1e6N1e6(*testing.T) {\n    M := 1000000\n\n    //Test Preparation 1: Setup the tree\n    tree := NewTree(cmp)\n    file1name := \"InitalTree_10000000.txt\"\n\n    testF1, err := os.Open(file1name)\n    if err != nil {\n        panic(err)\n    }\n    defer testF1.Close()\n\n    nums, _ := ReadInts(testF1)\n    for i, num := range nums {\n        if i == M {\n            break\n        }\n        tree.Set(Int(num), Int(1))\n    }\n\n\n    fmt.Println(\"Tree initialized\")\n\n    //Test Prepration 2: Initialize operations\n    N := 1000000 \n    inputs := make([]SearchPair, N)\n\n    file2name := \"Operations_10000000.txt\"\n    testF2, err := os.Open(file2name)\n    if err != nil {\n        panic(err)\n    }\n    defer testF2.Close()\n\n    var opt string\n    var num int\n    var input SearchPair\n    for i:=0; i &lt; N; i++{\n\n        fmt.Fscanf(testF2, \"%s %d\", &amp;opt, &amp;num)\n\n        switch opt {\n        case \"DEL\":\n            input = SearchPair{\n                opt: DEL,   //Operation to be applied\n                k: Int(num),    //k to be operated upon\n                v: Int(0),\n            }\n        case \"PUT\":\n            input = SearchPair{\n                opt: PUT,   //Operation to be applied\n                k: Int(num),    //k to be operated upon\n                v: Int(-1),\n            }\n        case \"SET\":\n            input = SearchPair{\n                opt: SET,   //Operation to be applied\n                k: Int(num),    //k to be operated upon\n                v: Int(2),\n            }\n        }\n\n        inputs[i] = input\n    }\n\n    //Start actual testing\n    fmt.Println(\"Start processing...\")\n    tree.BulkProcess(inputs)\n    fmt.Println(\"Done\")\n\n}\n</code></pre>\n\n<p><strong>Problem</strong>: I'm using <code>go test -v -cpuprofile cpu.out -memprofile mem.out</code> to profile <code>BulkProcess</code> performance, then use <code>go tool pprof --pdf ConcurrentBPlusTree.test mem.out &gt; mgraph.pdf</code> and <code>go tool pprof --pdf ConcurrentBPlusTree.test cpu.out &gt; cgraph.pdf</code> to visualize the result. </p>\n\n<p>Right now, <code>go test</code> seems to be profiling the entire test case including the tree building and operations building. The file I/O during test setup has been dominating the performance to the extend where I could not even see what's going on in my actual testing. </p>\n\n<p>Also, go test have output lines like this </p>\n\n<pre><code>=== RUN   TestInputTreeM1e6N1e6\n--- PASS: TestInputTreeM1e6N1e6 (63.36s)\n</code></pre>\n\n<p>Is it possible to configure the timer so that it only shows the time spent on bulk processing instead of the entire case? I know <code>b *testing.B</code> has API such as <code>b.ResetTimer()</code> and <code>b.StopTimer()</code>. Is there similar API for <code>*testing.T</code> so I can modify the timing behavior?</p>\n\n<p><strong>Specific Question</strong></p>\n\n<ol>\n<li>How can I use <code>go test</code> to <em>profile</em> only the last three lines of my current test case?</li>\n<li>How can I use <code>go test</code> to <em>time</em> only the last three lines of my current test case?</li>\n</ol>\n"}, {"tags": ["go", "bson", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "edited": false, "score": 0, "creation_date": 1476905451, "post_id": 40139594, "comment_id": 67549858, "body": "If you wouldn&#39;t mind adding a note on the Setter interface as well, I&#39;d be happy to mark this as the accepted answer. Thanks!"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1476910239, "last_edit_date": 1476910239, "creation_date": 1476903980, "answer_id": 40139594, "question_id": 40138660, "link": "https://stackoverflow.com/questions/40138660/mongodb-is-not-marshaling-a-value-before-storing-it/40139594#40139594", "title": "MongoDB is not marshaling a value before storing it", "body": "<p>The bson encoder does not use the JSON marshaling interfaces. Implement the <a href=\"https://godoc.org/gopkg.in/mgo.v2/bson#Getter\" rel=\"nofollow\">Getter</a> interface:</p>\n\n<pre><code>func (intValue Const) GetBSON() (interface{}, error) {\n    return intValue.Code(), nil\n}\n</code></pre>\n\n<p>You will also want to implement the <a href=\"https://godoc.org/gopkg.in/mgo.v2/bson#Setter\" rel=\"nofollow\">Setter</a> interface. </p>\n\n<pre><code>func (intValue *Const) SetBSON(raw bson.Raw) error {\n    var data int\n    if err := raw.Unmarshal(&amp;data); err != nil {\n        return err\n    }\n    switch data {\n    case `\"apple\"`: \n        *intValue = Apple\n    case `\"banana\"`:\n        *intValue = Banana\n    case `\"cherry\"`:\n        *intValue = Cherry\n    default:\n        return fmt.Errorf(\"Invalid fruit %s\", data)\n    }\n    return nil\n}\n</code></pre>\n"}], "owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 40139594, "answer_count": 1, "score": 0, "last_activity_date": 1476910239, "creation_date": 1476900584, "last_edit_date": 1476903283, "question_id": 40138660, "link": "https://stackoverflow.com/questions/40138660/mongodb-is-not-marshaling-a-value-before-storing-it", "title": "MongoDB is not marshaling a value before storing it", "body": "<p>I'm using a custom JSON marshaller/unmarshaller for a mapping between integers and strings in Go. The problem is that values are being stored in the database as integers instead of strings. In the example below, I would expect this to be stored in the MongoDB database:</p>\n\n<pre><code>{ \"_id\" : \"id123\", \"desc\" : \"Red Delicious\", \"value\" : \"apple\" }\n</code></pre>\n\n<p>Instead I get:</p>\n\n<pre><code>{ \"_id\" : \"id123\", \"desc\" : \"Red Delicious\", \"value\" : 1 }\n</code></pre>\n\n<p>As the test shows, marshalling and unmarshalling are working fine. What's going on?</p>\n\n<p>Here's an example as a Go test (save to unmarshal_test.go and \"go test\"). </p>\n\n<pre><code>package testunmarshal\n\nimport (\n    \"fmt\"\n    \"testing\"\n    \"encoding/json\"\n    mgo \"gopkg.in/mgo.v2\"\n    \"gopkg.in/mgo.v2/bson\"\n)\n\ntype Const int\n\nconst (\n    Apple Const = 1\n    Banana = 2\n    Cherry = 4\n)\n\ntype Record struct {\n    Id string `bson:\"_id\" json:\"id\"`\n    Desc string `bson:\"desc\" json:\"desc\"`\n    Value Const `bson:\"value\" json:\"value`\n}\n\nfunc (intValue Const) Code() string {\n    switch intValue {\n    case Apple: return \"apple\"\n    case Banana: return \"banana\"\n    case Cherry: return \"cherry\"\n    }\n    return \"invalid\"\n}\n\nfunc (intValue *Const) UnmarshalJSON(data []byte) (err error) {\n    switch string(data) {\n    case `\"apple\"`: \n        *intValue = Apple\n    case `\"banana\"`:\n        *intValue = Banana\n    case `\"cherry\"`:\n        *intValue = Cherry\n    default:\n        return fmt.Errorf(\"Invalid fruit %s\", data)\n    }\n    return nil\n}\n\nfunc (intValue *Const) MarshalJSON() ([]byte, error) {\n    return []byte(fmt.Sprintf(`\"%s\"`, intValue.Code())), nil\n}\n\nfunc TestMarshalJSON(t *testing.T) {\n    var orig = Record {\n        Id: \"id456\",\n        Desc: \"Cavendish\",\n        Value: Banana,\n    }\n\n    var copy Record\n\n    bytes, err := json.Marshal(&amp;orig)\n\n    if err != nil {\n        t.Errorf(\"Marshal failed: %s\", err.Error())\n        return\n    }\n\n    err = json.Unmarshal(bytes, &amp;copy)\n\n    if err != nil {\n        t.Errorf(\"Unmarshal failed: %s\", err.Error())\n        return\n    }\n\n    if orig.Value != copy.Value {\n        t.Errorf(\"Expected %d=%s, got %d=%s\", orig.Value, orig.Value.Code(), copy.Value, copy.Value.Code())\n    }\n}\n\nfunc TestMarshalBSON(t *testing.T) {\n    var orig = Record {\n        Id: \"id456\",\n        Desc: \"Cavendish\",\n        Value: Banana,\n    }\n\n    var copy Record\n\n    bytes, err := bson.Marshal(&amp;orig)\n\n    if err != nil {\n        t.Errorf(\"Marshal failed: %s\", err.Error())\n        return\n    }\n\n    err = bson.Unmarshal(bytes, &amp;copy)\n\n    if err != nil {\n        t.Errorf(\"Unmarshal failed: %s\", err.Error())\n        return\n    }\n\n    if orig.Value != copy.Value {\n        t.Errorf(\"Expected %d=%s, got %d=%s\", orig.Value, orig.Value.Code(), copy.Value, copy.Value.Code())\n    }\n}\n\nfunc TestMongo(t *testing.T) {\n    var rec1 = Record {\n        Id: \"id123\",\n        Desc: \"Red Delicious\",\n        Value: Apple,\n    }\n    var rec2 Record\n\n    sess, err := mgo.Dial(\"localhost\")\n\n    if err != nil {\n        t.Errorf(err.Error())\n        return\n    }\n\n    db := sess.DB(\"test\")\n\n    if db == nil {\n        t.Fatal(\"Failed to connect to database\")\n        return\n    }\n\n    col := db.C(\"fruit\")\n\n    if col == nil {\n        t.Fatal(\"Failed to open collection\")\n        return\n    }\n\n    // defer col.DropCollection()\n\n    err = col.Insert(&amp;rec1)\n\n    if err != nil {\n        t.Fatal(\"Failed to insert: %s\", err.Error())\n        return\n    }\n\n    err = col.Find(bson.M{}).One(&amp;rec2)\n\n    if err != nil {\n        t.Fatal(\"Failed to retrieve stored object: %s\", err.Error())\n        return\n    }\n\n    if rec1.Value != rec2.Value {\n        t.Errorf(\"Expected %d=%s, got %d=%s\", rec1.Value, rec1.Value.Code(), rec1.Value, rec2.Value.Code())\n    }\n}\n</code></pre>\n\n<p><strong>Edit</strong>: Added more tests to demonstrate that marshalling and unmarshalling are working.</p>\n"}, {"tags": ["google-app-engine", "go", "url-redirection"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476898304, "post_id": 40137827, "comment_id": 67545582, "body": "<code>http.StatusTemporaryRedirect</code> isn&#39;t supposed to switch methods. Does it work with <code>http.StatusFound</code>?"}, {"owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476899000, "post_id": 40137827, "comment_id": 67545981, "body": "@JimB as said in my question it does NOT work with http.StatusFound either ."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476903699, "post_id": 40137827, "comment_id": 67548840, "body": "OK, not a <code>curl</code> bug, we didn&#39;t read the man page section for <code>-X</code>: <code>The method string you set with -X will be used for all requests, which if you for example use -L, --location may cause unintended side-effects when curl doesn&#39;t change request method according to the HTTP 30x response codes - and similar.</code>"}, {"owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1480368101, "post_id": 40137827, "comment_id": 68924075, "body": "looks like you&#39;re totally right, please write an answer so I can accept it as the answer to my issue. curl behavior however is definitely not very intuitive. for post requests, no need for the -X flag. a simple -d flag marks the request as post !?"}], "owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1476905485, "creation_date": 1476897745, "last_edit_date": 1476898962, "question_id": 40137827, "link": "https://stackoverflow.com/questions/40137827/redirection-does-not-switch-from-post-to-get-with-go-on-appengine-standard", "title": "Redirection does not switch from POST to GET with go on appengine standard", "body": "<p>Like the title says, a curl request to the following server written for appengine with GO doesn't switch from POST to GET despite the redirection : </p>\n\n<pre><code>func init() {\n    http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n        switch r.Method {\n        case \"GET\":\n            fmt.Fprintf(w, \"INDEX\")\n        case \"POST\":\n            fmt.Print(\"redirecting...\")\n            http.Redirect(w, r, \"/\", http.StatusTemporaryRedirect)\n        default:\n            http.NotFound(w, r)\n        }\n    })\n}\n</code></pre>\n\n<p>Instead, I get an infinite redirection loop, no matter what status code I try (302,303,...) </p>\n\n<p>My routing in app.yaml for the record :</p>\n\n<pre><code>- url: /.*\n  script: _go_app  \n</code></pre>\n\n<p>And the curl command used locally :</p>\n\n<pre><code>curl \"http://localhost:8080\" -X POST -L\n</code></pre>\n\n<p>How do I fix this ? thanks .</p>\n\n<p>EDIT:\nThe behavior remained unchanged with 302</p>\n\n<pre><code>http.Redirect(w, r, \"/\", http.StatusFound)\n</code></pre>\n\n<p>It is still stuck in a redirection loop</p>\n"}, {"tags": ["logging", "go", "stack-trace"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1476890350, "post_id": 40135419, "comment_id": 67540792, "body": "You should be redirecting stderr and stdout to a file on the server (or into some other logging mechanism). You set <code>os.Stderr</code> to another file in your app, but it&#39;s going to be more reliable to have that managed externally."}, {"owner": {"reputation": 1366, "user_id": 4931643, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/702807200eaef92e4d1c6896893d7888?s=128&d=identicon&r=PG&f=1", "display_name": "Mbded", "link": "https://stackoverflow.com/users/4931643/mbded"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476906688, "post_id": 40135419, "comment_id": 67550597, "body": "This is a key. A tried find some function to this in golang doc, but for now nothing. A tried for eg <code>os.Stderr = os.NewFile(uintptr(syscall.Stderr), &quot;&#47;my&#47;log&#47;file.log&quot;)</code>  but dosen&#39;t works. I will be trying still something other... unles someone will be faster, and find solution before me"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476907773, "post_id": 40135419, "comment_id": 67551192, "body": "<code>os.NewFile</code> just returns a new <code>*os.File</code> with that file descriptor, so it did nothing except change string returned by <code>os.Stderr.Name()</code>"}, {"owner": {"reputation": 1366, "user_id": 4931643, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/702807200eaef92e4d1c6896893d7888?s=128&d=identicon&r=PG&f=1", "display_name": "Mbded", "link": "https://stackoverflow.com/users/4931643/mbded"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1477082862, "post_id": 40135419, "comment_id": 67637966, "body": "I found solution <a href=\"http://stackoverflow.com/questions/34772012/capturing-panic-in-golang\" title=\"capturing panic in golang\">stackoverflow.com/questions/34772012/capturing-panic-in-gola&zwnj;&#8203;ng</a> this I looking for."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476891680, "post_id": 40135972, "comment_id": 67541666, "body": "You can&#39;t create a &quot;global panic handler&quot;, because you can only recover within the panicking goroutine."}], "tags": [], "owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "is_accepted": false, "score": 0, "last_activity_date": 1476891941, "last_edit_date": 1476891941, "creation_date": 1476891557, "answer_id": 40135972, "question_id": 40135419, "link": "https://stackoverflow.com/questions/40135419/write-result-stack-trace-default-to-file/40135972#40135972", "title": "Write result stack trace default to file", "body": "<p>Use syscall.Dup2 to link the opened file to the standard stream</p>\n\n<pre><code>func main() {\n   syscall.Dup2(int(logFile.Fd()), 2)\n}\n</code></pre>\n\n<p>or create panic handler</p>\n\n<pre><code>defer func() {\n        err := recover()\n        if err != nil {\n            //...\n        }\n    }()\n</code></pre>\n"}], "owner": {"reputation": 1366, "user_id": 4931643, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/702807200eaef92e4d1c6896893d7888?s=128&d=identicon&r=PG&f=1", "display_name": "Mbded", "link": "https://stackoverflow.com/users/4931643/mbded"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476891941, "creation_date": 1476890013, "question_id": 40135419, "link": "https://stackoverflow.com/questions/40135419/write-result-stack-trace-default-to-file", "title": "Write result stack trace default to file", "body": "<p>I use logger in my program defined from pattern as below</p>\n\n<pre><code>var (\n    logFile *os.File\n    Info    *log.Logger\n)\n\nfunc init() {\n    var err error\n    logFile, err = os.OpenFile(\"/my/file/with.log\", os.O_CREATE|os.O_APPEND|os.O_WRONLY, 0666)\n    if err != nil {\n        fmt.Printf(\"Cannot open log file error:%s. Program was terminated.\", err)\n        os.Exit(1)\n    }\n    Info = log.New(logFile,\n        \"INFO: \", log.Ldate|log.Ltime|log.Lshortfile)\n }\n</code></pre>\n\n<p>Now I would like write all information from stackTrace if these occured for example from <code>panic()</code>  to my log file. Now if some gone was wrong all this information are print to console in my IDE, but if porgram works on server, I lose information if occured some null pointer, wrong pass argument to function, that's why I want write this information to log file.\nIt is possible ? </p>\n"}, {"tags": ["php", "file", "networking", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476888631, "post_id": 40134614, "comment_id": 67539460, "body": "Database access is usually done through a connection pool, which will connect/reconnect as needed."}], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 3270867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c631c17a585f7ffb08f0ab20eb09fce?s=128&d=identicon&r=PG&f=1", "display_name": "Andy L.", "link": "https://stackoverflow.com/users/3270867/andy-l"}, "is_accepted": true, "score": 0, "last_activity_date": 1476916144, "creation_date": 1476916144, "answer_id": 40142553, "question_id": 40134614, "link": "https://stackoverflow.com/questions/40134614/long-running-golang-program-and-resources-file-handles-tcp-connections-etc/40142553#40142553", "title": "Long-running Golang program and resources (file handles, tcp connections, etc)", "body": "<p>In Go, there are built-in packages that will handle both log files and databases in a Go idiomatic way.</p>\n\n<p>They are:</p>\n\n<ul>\n<li>database/sql: <a href=\"https://golang.org/pkg/database/sql\" rel=\"nofollow\">https://golang.org/pkg/database/sql</a></li>\n<li>log: <a href=\"https://golang.org/pkg/log\" rel=\"nofollow\">https://golang.org/pkg/log</a></li>\n</ul>\n\n<p>In Go, as with any language where long running daemon's can be created, error checking and error handling will be important.</p>\n"}], "owner": {"reputation": 3, "user_id": 7042814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c9617aea19379f0f6e3940ce4ae6a7d?s=128&d=identicon&r=PG&f=1", "display_name": "Beloumi", "link": "https://stackoverflow.com/users/7042814/beloumi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 40142553, "answer_count": 1, "score": -3, "last_activity_date": 1476916144, "creation_date": 1476888069, "question_id": 40134614, "link": "https://stackoverflow.com/questions/40134614/long-running-golang-program-and-resources-file-handles-tcp-connections-etc", "title": "Long-running Golang program and resources (file handles, tcp connections, etc)", "body": "<p>I'm coming from a PHP background and I'm a bit confused about how to safely use resources with Golang. My main concern is, in a web context, with PHP, scripts are usually short-lived (HTTP request / response lifetime), but with Golang they're supposed to run forever (because the Golang program acts as a web server and a web application at the same time).</p>\n\n<p>So, when it comes to deal with database connections, log files, I often see that they should be opened once and not for each request, which makes sense. However how stable is it to do this?</p>\n\n<p>For example, if I open a database connection, how can I be sure it won't break at some point? (if the database decides to kill it for some reason, or if my machine looses internet access, would the connection become valid again when I gain internet access later on?) Same for log files, with PHP it's not a problem for a sysadmin to setup log rotation, however in Golang it would break the file handle I think (if the program doesn't know about this)?</p>\n\n<p>I'd really like to work the Golang way and not open/close those resources for each request but I'm not sure what is the \"safe\" way to do this, are there any recommendations for this? Or is there built-in features for those concerns?</p>\n"}, {"tags": ["go", "mutex"], "comments": [{"owner": {"reputation": 1351, "user_id": 879047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee933b5bf986de605ee48c1ae3e3f7ee?s=128&d=identicon&r=PG", "display_name": "Duru Can Celasun", "link": "https://stackoverflow.com/users/879047/duru-can-celasun"}, "edited": false, "score": 0, "creation_date": 1476886594, "post_id": 40133814, "comment_id": 67537762, "body": "Is this a homework question? Your code seems to be missing parts of it, including the definition of <code>Element</code>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1476886604, "post_id": 40133814, "comment_id": 67537772, "body": "Why? A mutex is the correct primitive to use in this case? (also, it&#39;s much cleaner and less error prone to use <code>defer</code> <a href=\"https://play.golang.org/p/G-Y9sGooaQ\" rel=\"nofollow noreferrer\">play.golang.org/p/G-Y9sGooaQ</a>)"}, {"owner": {"reputation": 492, "user_id": 794638, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4c662876323dd1f45e611504874e1363?s=128&d=identicon&r=PG", "display_name": "sinned", "link": "https://stackoverflow.com/users/794638/sinned"}, "edited": false, "score": 1, "creation_date": 1476886920, "post_id": 40133814, "comment_id": 67538044, "body": "The whole purpose of the channel paradigm is to get rid of mutexes. Using channels, you can synchronize without them. But to show you, we would need your actual code, not just the locking code. Usually to use channels effectively, one has to design the programs architecture around it. You cannot just change a few lines to use them effectively."}, {"owner": {"reputation": 4456, "user_id": 4127569, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b728c7d6c1dce81f5a82249b7617756?s=128&d=identicon&r=PG&f=1", "display_name": "jch", "link": "https://stackoverflow.com/users/4127569/jch"}, "edited": false, "score": 0, "creation_date": 1479258717, "post_id": 40133814, "comment_id": 68478954, "body": "There&#39;s a race condition in your code \u2014 when you release the mutex to test if your stack is empty, another goroutine could pop the last element."}], "answers": [{"tags": [], "owner": {"reputation": 2324, "user_id": 2272652, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vKcw7.jpg?s=128&g=1", "display_name": "Christian Grabowski", "link": "https://stackoverflow.com/users/2272652/christian-grabowski"}, "is_accepted": true, "score": 1, "last_activity_date": 1476910776, "creation_date": 1476910776, "answer_id": 40141442, "question_id": 40133814, "link": "https://stackoverflow.com/questions/40133814/how-to-use-channels-to-safely-synchronise-data-in-go/40141442#40141442", "title": "How to use channels to safely synchronise data in Go", "body": "<p>If you actually were to look at how Go implements channels, you'd essentially see a mutex around an array with some additional thread handling to block execution until the value is passed through.  A channel's job is to move data from one spot in memory to another with ease.  Therefore where you have locks and unlocks, you'd have things like this example:</p>\n\n<pre><code>func example() {\n    resChan := make(int chan)\n    go func(){\n        resChan &lt;- 1\n    }()\n    go func(){\n        res := &lt;-resChan\n    }\n}\n</code></pre>\n\n<p>So in the example, the first goroutine is blocked after sending the value until the second goroutine reads from the channel. </p>\n\n<p>To do this in Go with mutexes, one would use sync.WaitGroup which will add one to the group on setting the value, then release it from the group and the second goroutine will lock and then unlock the value.</p>\n\n<p>The oddities in your example are 1 no goroutines, so it's all happening in a single main goroutine and the locks are being used more traditionally (as in c thread like) so channels won't really accomplish anything.  The example you have would be considered an anti-pattern, like the golang proverb says \"Don't communicate by sharing memory, share memory by communicating.\"</p>\n"}], "owner": {"reputation": 57, "user_id": 6177181, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6ad2ea0d507d88cec5381e4937e8a947?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Bildus", "link": "https://stackoverflow.com/users/6177181/jan-bildus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "accepted_answer_id": 40141442, "answer_count": 1, "score": 0, "last_activity_date": 1615432141, "creation_date": 1476886229, "last_edit_date": 1615432141, "question_id": 40133814, "link": "https://stackoverflow.com/questions/40133814/how-to-use-channels-to-safely-synchronise-data-in-go", "title": "How to use channels to safely synchronise data in Go", "body": "<p>Below is an example of how to use mutex lock in order to safely access data. How would I go about doing the same with the use of CSP (<a href=\"https://en.wikipedia.org/wiki/Communicating_sequential_processes\" rel=\"nofollow noreferrer\">communication sequential processes</a>) instead of using mutex lock\u2019s and unlock\u2019s?</p>\n<pre><code>type Stack struct {\n  top    *Element\n  size   int\n  sync.Mutex\n}\n\nfunc (ss *Stack) Len() int {\n  ss.Lock()\n  size := ss.size\n  ss.Unlock()\n  return size\n\n}\n\nfunc (ss *Stack) Push(value interface{}) {\n  ss.Lock()\n  ss.top = &amp;Element{value, ss.top}\n  ss.size++\n  ss.Unlock()\n}\n\nfunc (ss *SafeStack) Pop() (value interface{}) {\n  ss.Lock()\n  size := ss.size\n  ss.Unlock()\n  if size &gt; 0 {\n    ss.Lock()\n    value, ss.top = ss.top.value, ss.top.next\n    ss.size--\n    ss.Unlock()\n    return\n  }\n\n  return nil\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "edited": false, "score": 2, "creation_date": 1476880442, "post_id": 40130949, "comment_id": 67532913, "body": "You can&#39;t pause handlers execution such way. Even if you redirect between your own pages, visitor simply will see empty screen for five seconds before he will be redirected. You can either display a page or redirect, but not both."}], "answers": [{"tags": [], "owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "is_accepted": false, "score": 1, "last_activity_date": 1476879078, "creation_date": 1476879078, "answer_id": 40131065, "question_id": 40130949, "link": "https://stackoverflow.com/questions/40130949/how-to-re-direct-to-another-page-once-the-page-is-loaded-completely/40131065#40131065", "title": "How to re-direct to another page once the page is loaded completely", "body": "<p>If you want to redirect once the page is loaded, you have to do that in javascript.</p>\n\n<p>The base of HTTP protocol is 1 query, 1 answer: \"Get me this page\" -> \"Here it is\".</p>\n\n<p>You can't answer once to a query, and one second later and say \"Oh, now you have to display this other page\" (that's how the protocol was defined).</p>\n\n<p>Therefore, if you want to redirect to another page after a short break, you have to insert a javascript call at the end of your file: Once the first redirection is done, then JS will execute itself, and you can put something like \"Wait 5 seconds then call for this second page\".</p>\n"}, {"comments": [{"owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "edited": false, "score": 0, "creation_date": 1476888137, "post_id": 40131232, "comment_id": 67539097, "body": "This is helpful but my situation is slightly different. I have a logout button which redirects me to a third-party url(not under my control) which has its own page which simply says <code>You have been logged out successfully</code> I want that as soon as I land up on this page I should be re-directed to my application&#39;s login page which is at <a href=\"https://localhost:8080/login\" rel=\"nofollow noreferrer\">localhost:8080/login</a>"}, {"owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "reply_to_user": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "edited": false, "score": 0, "creation_date": 1476889635, "post_id": 40131232, "comment_id": 67540287, "body": "I&#39;m afraid, that what you asking is not achievable. That 3-d party page has to redirect you back and if it is not under your control and you are not able to place code mentioned above then visitor will stuck with them at this point. As a workaround solution is to use iframe, but that&#39;s completely different story."}, {"owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "edited": false, "score": 0, "creation_date": 1476889791, "post_id": 40131232, "comment_id": 67540408, "body": "There is something called as iframe in HTML. Looks like its achievable using that. But not sure how.."}, {"owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "reply_to_user": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "edited": false, "score": 0, "creation_date": 1476890519, "post_id": 40131232, "comment_id": 67540899, "body": "I updated answer with rough html example of how you can do it, but that&#39;s hardly related to Go, you should rise a new question."}], "tags": [], "owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "is_accepted": true, "score": 1, "last_activity_date": 1476890434, "last_edit_date": 1476890434, "creation_date": 1476879540, "answer_id": 40131232, "question_id": 40130949, "link": "https://stackoverflow.com/questions/40130949/how-to-re-direct-to-another-page-once-the-page-is-loaded-completely/40131232#40131232", "title": "How to re-direct to another page once the page is loaded completely", "body": "<p>Simply put inside your page:</p>\n\n<pre><code>&lt;meta http-equiv=\"refresh\" content=\"5; url=http://example.com/\" /&gt;\n</code></pre>\n\n<p>Another solution with javascript:</p>\n\n<pre><code>&lt;script type=\"text/javascript\"&gt;\n      setTimeout(\"location.href = 'http://example.com/';\",5000);\n &lt;/script&gt;\n</code></pre>\n\n<p>your html logout page with 3-d party logout page inside</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta http-equiv=\"refresh\" content=\"5; url=https://localhost:8080/login\" /&gt;\n    &lt;title&gt;Test Layout&lt;/title&gt;\n    &lt;style type=\"text/css\"&gt;\n        body, html\n        {\n            margin: 0; padding: 0; height: 100%; overflow: hidden;\n        }\n\n        #content\n        {\n            position:absolute; left: 0; right: 0; bottom: 0; top: 0px;\n        }\n    &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;div id=\"content\"&gt;\n    &lt;iframe width=\"100%\" height=\"100%\" frameborder=\"0\" src=\"http://example.com/\" /&gt;\n&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"}], "owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 465, "favorite_count": 0, "accepted_answer_id": 40131232, "answer_count": 2, "score": 0, "last_activity_date": 1476890434, "creation_date": 1476878733, "question_id": 40130949, "link": "https://stackoverflow.com/questions/40130949/how-to-re-direct-to-another-page-once-the-page-is-loaded-completely", "title": "How to re-direct to another page once the page is loaded completely", "body": "<p>I am using go-gin and have a re-direct  </p>\n\n<pre><code>c.Redirect(http.StatusMovedPermanently, myurl1). \n</code></pre>\n\n<p>Can I add a timer and call another re-direct once the first one completes in the same handler?</p>\n\n<pre><code>  c.Redirect(http.StatusMovedPermanently, myurl1)\n  // sleep for 5 seconds\n  c.Redirect(http.StatusMovedPermanently, myurl2)?\n</code></pre>\n\n<p>Can I pause a handler's execution for a few seconds?</p>\n"}, {"tags": ["dictionary", "go", "concurrency"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 2417830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f150e0f851c74d1b9c001b901b29a287?s=128&d=identicon&r=PG", "display_name": "leesper", "link": "https://stackoverflow.com/users/2417830/leesper"}, "edited": false, "score": 0, "creation_date": 1477012012, "post_id": 40130972, "comment_id": 67602113, "body": "Thank you very much! It works for me :) Finally I chose option 2 clean up the IterKeys() and IterValues() functions, make the iteration over map synchronously and after a day and a night it seems that no such problems happened again, but I am still wondering why the go-routine leaks, I checked all the code, when I use IterKeys() and IterValues() I drained them. Maybe multi-threading programming is full of mystery, just like women : )"}], "tags": [], "owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "is_accepted": false, "score": 1, "last_activity_date": 1476878791, "creation_date": 1476878791, "answer_id": 40130972, "question_id": 40130567, "link": "https://stackoverflow.com/questions/40130567/whats-wrong-with-this-concurrent-map/40130972#40130972", "title": "What&#39;s wrong with this concurrent map?", "body": "<p><code>IterKeys</code> and <code>IterValues</code> can block all writers if not used properly. You're using non-buffered channels and lock the whole map until all the values are read. Remember that write lock can be aquired only after all read locks are released. Any caller that will not drain the channel will leak a goroutine with the read lock held.</p>\n\n<p>There're multiple solutions I can think of:</p>\n\n<ol>\n<li>Make sure, that any caller will drain the channel as fast as possible.</li>\n<li>Don't use goroutines at all. Iterate over the map synchronously, while the read lock is held.</li>\n<li>You could make locking more granular by using two channels. One will signal that you would like to read a value, second will lock the map, read the value, unlock the map and send the value. That way caller can take as much time as he wants without locking the entire map.</li>\n</ol>\n\n<p>I'm in favour of the second solution. It's much easier to implement properly, easier to understand and use. The first is too fragile, while the third is too complex and probably unnecessary. It will also be much slower.</p>\n"}], "owner": {"reputation": 21, "user_id": 2417830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f150e0f851c74d1b9c001b901b29a287?s=128&d=identicon&r=PG", "display_name": "leesper", "link": "https://stackoverflow.com/users/2417830/leesper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476878791, "creation_date": 1476877597, "question_id": 40130567, "link": "https://stackoverflow.com/questions/40130567/whats-wrong-with-this-concurrent-map", "title": "What&#39;s wrong with this concurrent map?", "body": "<p>Recently I have developed a golang TCP network programming framework name <a href=\"https://github.com/leesper/tao\" rel=\"nofollow\">Tao</a>, in file <a href=\"https://github.com/leesper/tao/blob/master/util.go\" rel=\"nofollow\">util.go</a> there's a concurrent map called <strong>ConnectionMap</strong> which I use to manage incoming TCP connections, it is a int64-to-Connection map read and writen by multiple go-routines. </p>\n\n<p>Then I developed a remote control system based on Tao, a mobile app can control devices via this system. However I find something is wrong with <strong>ConnectionMap</strong>: some already-closed connections are not removed from this map and remain existed. </p>\n\n<p>I'm not quite sure it is the reason that after a while the app can hardly connect to this sytem, but I am really confused that <strong>IS THIS THE RIGHT WAY TO WRITE A CONCURRENT MAP? IS SOMETHING WRONG WITH IT?</strong> <em>Thank you</em>.</p>\n\n<pre><code>type ConnectionMap struct{\n  sync.RWMutex\n  m map[int64]Connection\n}\n\nfunc NewConnectionMap() *ConnectionMap {\n  return &amp;ConnectionMap{\n    m: make(map[int64]Connection),\n  }\n}\n\nfunc (cm *ConnectionMap)Clear() {\n  cm.Lock()\n  cm.m = make(map[int64]Connection)\n  cm.Unlock()\n}\n\nfunc (cm *ConnectionMap)Get(k int64) (Connection, bool) {\n  cm.RLock()\n  conn, ok := cm.m[k]\n  cm.RUnlock()\n  return conn, ok\n}\n\nfunc (cm *ConnectionMap)IterKeys() &lt;-chan int64 {\n  kch := make(chan int64)\n  go func() {\n    cm.RLock()\n    for k, _ := range cm.m {\n      kch&lt;- k\n    }\n    cm.RUnlock()\n    close(kch)\n  }()\n  return kch\n}\n\nfunc (cm *ConnectionMap)IterValues() &lt;-chan Connection {\n  vch := make(chan Connection)\n  go func() {\n    cm.RLock()\n    for _, v := range cm.m {\n      vch&lt;- v\n    }\n    cm.RUnlock()\n    close(vch)\n  }()\n  return vch\n}\n\nfunc (cm *ConnectionMap)Put(k int64, v Connection) {\n  cm.Lock()\n  cm.m[k] = v\n  cm.Unlock()\n}\n\nfunc (cm *ConnectionMap)Remove(k int64) {\n  cm.Lock()\n  delete(cm.m, k)\n  cm.Unlock()\n}\n\nfunc (cm *ConnectionMap)Size() int {\n  cm.RLock()\n  size := len(cm.m)\n  cm.RUnlock()\n  return size\n}\n\nfunc (cm *ConnectionMap)IsEmpty() bool {\n  return cm.Size() &lt;= 0\n}\n</code></pre>\n"}, {"tags": ["file", "go", "compression", "gzip"], "answers": [{"comments": [{"owner": {"reputation": 6046, "user_id": 1501285, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b742182dd480420da7e0e9fe357b2c04?s=128&d=identicon&r=PG", "display_name": "Bob van Luijt", "link": "https://stackoverflow.com/users/1501285/bob-van-luijt"}, "edited": false, "score": 0, "creation_date": 1476883681, "post_id": 40132097, "comment_id": 67535364, "body": "Thank you again, this is really helpful, especially the explanation! Was able to get it working with your help here: <a href=\"https://github.com/bobvanluijt/gcloud-storage-transfer-tool/blob/master/gcloud-st.go\" rel=\"nofollow noreferrer\">github.com/bobvanluijt/gcloud-storage-transfer-tool/blob/mas&zwnj;&#8203;ter/&hellip;</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 6046, "user_id": 1501285, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b742182dd480420da7e0e9fe357b2c04?s=128&d=identicon&r=PG", "display_name": "Bob van Luijt", "link": "https://stackoverflow.com/users/1501285/bob-van-luijt"}, "edited": false, "score": 1, "creation_date": 1476886208, "post_id": 40132097, "comment_id": 67537439, "body": "@BobvanLuijt Made some improvements / simplification, you might wanna re-read it."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1476949753, "last_edit_date": 1476949753, "creation_date": 1476881940, "answer_id": 40132097, "question_id": 40130541, "link": "https://stackoverflow.com/questions/40130541/how-to-replace-file-variable-with-gzipped-version-in-go/40132097#40132097", "title": "How to replace file variable with gzipped version in Go?", "body": "<p>There are quite a few errors in your code.</p>\n\n<p><em>As a \"pre-first\", always check returned errors!</em></p>\n\n<p>First, <a href=\"https://golang.org/pkg/os/#Open\" rel=\"nofollow\"><code>os.Open()</code></a> opens the file in read-only mode. To be able to replace the file content on the disk,  you must open it in read-write mode instead:</p>\n\n<pre><code>file, err := os.OpenFile(fileName, os.O_RDWR, 0)\n</code></pre>\n\n<p>Next, when you open something that is an <a href=\"https://golang.org/pkg/io/#Closer\" rel=\"nofollow\"><code>io.Closer</code></a> (<a href=\"https://golang.org/pkg/os/#File\" rel=\"nofollow\"><code>*os.File</code></a> is an <code>io.Closer</code>), make sure you close it with the <code>Close()</code> method, best done as a deferred statement.</p>\n\n<p>Next, <code>*os.File</code> is an <a href=\"https://golang.org/pkg/io/#Reader\" rel=\"nofollow\"><code>io.Reader</code></a>, but that is not the same thing as a byte slice <code>[]byte</code>. An <code>io.Reader</code> may be used to read bytes into a byte slice. Use <a href=\"https://golang.org/pkg/io/#Copy\" rel=\"nofollow\"><code>io.Copy()</code></a> to copy the content from the file to the gzip stream (which will end up in the buffer).</p>\n\n<p>In certain situation (where you don't close the <code>gzip.Writer</code>), you must call <a href=\"https://golang.org/pkg/compress/gzip/#Writer.Flush\" rel=\"nofollow\"><code>gzip.Writer.Flush()</code></a> to ensure everything is flushed into its writer (which is the buffer in this case). Note that <code>gzip.Writer.Close()</code> also flushes, so this may seem like an unnecessary step, but must be done for example if the <code>Close()</code> of the <code>gzip.Writer</code> is also called as a deferred statemement, because then it may not be executed before we use the content of the buffer. Since in our examle we close the gzip writer after <code>io.Copy()</code>, that will take care of necessary flushes.</p>\n\n<p>Next, to replace the content of the original file, you must seek back to the beginning of the file to replace. For that, you may use <a href=\"https://golang.org/pkg/os/#File.Seek\" rel=\"nofollow\"><code>File.Seek()</code></a>.</p>\n\n<p>Next, you may again use <code>io.Copy()</code> to copy the contents of the buffer (the gzipped data) to the file.</p>\n\n<p>And last, since the gzipped content will most likely be shorter than the original file size, you must truncate the file at the size of the gzipped content (else uncompressed content of the original file may be left there).</p>\n\n<p>Here's the complete code:</p>\n\n<pre><code>file, err := os.OpenFile(fileName, os.O_RDWR, 0)\nif err != nil {\n    log.Fatalf(\"Error opening %q: %v\", fileName, err)\n}\ndefer file.Close()\n\n// Check if gzip should be applied\nif *metaGzip {\n    var b = &amp;bytes.Buffer{}\n    w := gzip.NewWriter(b)\n    if _, err := io.Copy(w, file); err != nil {\n        panic(err)\n    }\n    if err := w.Close(); err != nil { // This also flushes\n        panic(err)\n    }\n    if _, err := file.Seek(0, 0); err != nil {\n        panic(err)\n    }\n    if _, err := io.Copy(file, b); err != nil {\n        panic(err)\n    }\n    if err := file.Truncate(int64(b.Len())); err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p><strong>Note:</strong> The above code will replace the file content on your disk. If you don't want this and you just need the compressed data, you may do it like this. Note that I used a new <code>input</code> variable of type <code>io.Reader</code>, as a value of <code>bytes.Buffer</code> (or <code>*bytes.Buffer</code>) cannot be assigned to a variable of type <code>*os.File</code>, and we will most likely only need the result as a value of <code>io.Reader</code> (and this is implemented by both):</p>\n\n<pre><code>var input io.Reader\n\nfile, err := os.Open(fileName)\nif err != nil {\n    log.Fatalf(\"Error opening %q: %v\", fileName, err)\n}\ndefer file.Close()\n\n// Check if gzip should be applied\nif *metaGzip {\n    var b = &amp;bytes.Buffer{}\n    w := gzip.NewWriter(b)\n    if _, err := io.Copy(w, file); err != nil {\n        panic(err)\n    }\n    if err := w.Close(); err != nil { // This also flushes\n        panic(err)\n    }\n    input = b\n} else {\n    input = file\n}\n\n// Use input here\n</code></pre>\n\n<p><strong>Note #2:</strong> If you don't want to \"work\" with the compressed data but you just want to send it e.g. as the web response, you don't even need the <a href=\"https://golang.org/pkg/bytes/#Buffer\" rel=\"nofollow\"><code>bytes.Buffer</code></a>, you can just \"stream\" the compressed data to the <a href=\"https://golang.org/pkg/net/http/#ResponseWriter\" rel=\"nofollow\"><code>http.ResponseWriter</code></a>.</p>\n\n<p>It could look like this:</p>\n\n<pre><code>func myHandler(w http.ResponseWriter, r *http.Request) {\n    file, err := os.Open(fileName)\n    if err != nil {\n        http.NotFound(w, r)\n    }\n    defer file.Close()\n\n    gz := gzip.NewWriter(w)\n    defer gz.Close()\n\n    if _, err := io.Copy(gz, file); err != nil {\n        // handle error\n    }\n}\n</code></pre>\n\n<p>Proper content type will be detected and set automatically.</p>\n"}], "owner": {"reputation": 6046, "user_id": 1501285, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b742182dd480420da7e0e9fe357b2c04?s=128&d=identicon&r=PG", "display_name": "Bob van Luijt", "link": "https://stackoverflow.com/users/1501285/bob-van-luijt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 40132097, "answer_count": 1, "score": 1, "last_activity_date": 1476949753, "creation_date": 1476877535, "last_edit_date": 1495542805, "question_id": 40130541, "link": "https://stackoverflow.com/questions/40130541/how-to-replace-file-variable-with-gzipped-version-in-go", "title": "How to replace file variable with gzipped version in Go?", "body": "<p>I have the following Go code:</p>\n\n<pre><code>file, err := os.Open(fileName)\nif err != nil {\n    fatalf(service, \"Error opening %q: %v\", fileName, err)\n}\n\n// Check if gzip should be applied\nif *metaGzip == true {\n    var b bytes.Buffer\n    w := gzip.NewWriter(&amp;b)\n    w.Write(file)\n    w.Close()\n    file = w\n}\n</code></pre>\n\n<p>I want to replace the file content of <code>file</code> with a gzipped version if <code>metaGzip = true</code>.</p>\n\n<p>PS:<br>\nI followed this advice: <a href=\"https://stackoverflow.com/questions/23454940/getting-bytes-buffer-does-not-implement-io-writer-error-message\">Getting &quot;bytes.Buffer does not implement io.Writer&quot; error message</a> but I still get the error: <code>cannot use file (type *os.File) as type []byte in argument to w.Write</code></p>\n"}, {"tags": ["unit-testing", "go", "http-status-code-404", "beego"], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 3484375, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iMBsZ.jpg?s=128&g=1", "display_name": "guptachirag", "link": "https://stackoverflow.com/users/3484375/guptachirag"}, "is_accepted": true, "score": 2, "last_activity_date": 1476988406, "creation_date": 1476988406, "answer_id": 40161990, "question_id": 40130473, "link": "https://stackoverflow.com/questions/40130473/beego-test-case-returns-404-status-endpoint-not-match/40161990#40161990", "title": "Beego Test Case returns 404 status, endpoint not match", "body": "<p>You need to initialize the routers.You can add </p>\n\n<pre><code>import _ \"path/routers\"\n</code></pre>\n\n<p>if the routes are in init() function.</p>\n"}], "owner": {"reputation": 666, "user_id": 1819852, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/da91c0f9296f7029e059362ea5809af6?s=128&d=identicon&r=PG", "display_name": "souravlahoti", "link": "https://stackoverflow.com/users/1819852/souravlahoti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 669, "favorite_count": 0, "accepted_answer_id": 40161990, "answer_count": 1, "score": 1, "last_activity_date": 1476988406, "creation_date": 1476877345, "last_edit_date": 1476878972, "question_id": 40130473, "link": "https://stackoverflow.com/questions/40130473/beego-test-case-returns-404-status-endpoint-not-match", "title": "Beego Test Case returns 404 status, endpoint not match", "body": "<p>Below is my test case where I am checking one of my API endpoints.</p>\n\n<pre><code>package test\n\nimport (\n    \"net/http\"\n    \"net/http/httptest\"\n    \"path/filepath\"\n    \"runtime\"\n    \"testing\"\n\n    \"github.com/astaxie/beego\"\n    . \"github.com/smartystreets/goconvey/convey\"\n)\n\nfunc init() {\n    _, file, _, _ := runtime.Caller(1)\n    apppath, _ := filepath.Abs(filepath.Dir(filepath.Join(file, \"..\"+string(filepath.Separator))))\n    beego.TestBeegoInit(apppath)\n}\n\n// TestGet is a sample to run an endpoint test\nfunc TestGet(t *testing.T) {\n    r, _ := http.NewRequest(\"GET\", \"/v1/Bangalore/feed/24\", nil)\n    w := httptest.NewRecorder()\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    w.Header().Set(\"Token\", \"O0h3NFbxxxxxxxxxauBvFZA\")\n    w.Header().Set(\"Channel\", \"xxxx\")\n    beego.BeeApp.Handlers.ServeHTTP(w, r)\n\n    beego.Trace(\"testing\", \"TestGet\", \"Code[%d]\\n%s\", w.Code, w.Body.String())\n\n    Convey(\"Subject: Test Station Endpoint\\n\", t, func() {\n        Convey(\"Status Code Should Be 200\", func() {\n            So(w.Code, ShouldEqual, 200)\n        })\n        Convey(\"The Result Should Not Be Empty\", func() {\n            So(w.Body.Len(), ShouldBeGreaterThan, 0)\n        })\n    })\n}\n</code></pre>\n\n<p>When running the Beego server locally and requesting through Postman I receive the response and with status 200 OK but when I run the test case , it returns 404 status code.</p>\n\n<p>My app.conf file is in conf folder.</p>\n\n<pre><code>appname = jobfeed\nhttpport = 8080\nrunmode = dev\nautorender = false\ncopyrequestbody = true\nEnableDocs = true\nEnableAdmin = false\n\n[dev]\nmongourls = \"xxxxxx\"\nmongodb   = \"xxxxx\"\nURL = \"xxxx\"\nmsSqlURL = \"xxxxx\"\nmsSqlUsername = \"xx\"\nmsSqlPassword = \"xxx\"\nmsSqlPort = 1434\nmsSqlDBName = \"xxxxx\"\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1476877493, "post_id": 40130349, "comment_id": 67530769, "body": "You cannot send data after http.Error: See <a href=\"https://golang.org/pkg/net/http/#Error\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/#Error</a>. You should send <code>string(response)</code> instead of <code>http.StatusText(500)</code>. It <i>really</i> helps reading all the documentation of any function used."}, {"owner": {"reputation": 8720, "user_id": 6149787, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/edf1a61aa50a231d521d940d60928292?s=128&d=identicon&r=PG&f=1", "display_name": "Jagrati", "link": "https://stackoverflow.com/users/6149787/jagrati"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1476877686, "post_id": 40130349, "comment_id": 67530924, "body": "<code>if err != nil {     log.Fatal(err)     http.Error(w, http.StatusText(500), 500)     return }</code> I am not talking about this err. This error handling is for if <code>json.Marshal</code> fails.Please read the context properly before downvoting."}, {"owner": {"reputation": 8720, "user_id": 6149787, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/edf1a61aa50a231d521d940d60928292?s=128&d=identicon&r=PG&f=1", "display_name": "Jagrati", "link": "https://stackoverflow.com/users/6149787/jagrati"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1476877877, "post_id": 40130349, "comment_id": 67531034, "body": "@Volker I have edited my question if you are confused. Please check."}], "answers": [{"tags": [], "owner": {"reputation": 2547, "user_id": 6255980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/454bc16f39711097b06e71a597725238?s=128&d=identicon&r=PG&f=1", "display_name": "jussius", "link": "https://stackoverflow.com/users/6255980/jussius"}, "is_accepted": true, "score": 6, "last_activity_date": 1476881076, "last_edit_date": 1476881076, "creation_date": 1476880113, "answer_id": 40131429, "question_id": 40130349, "link": "https://stackoverflow.com/questions/40130349/error-handling-in-go-is-returning-empty-error-object-in-http-response/40131429#40131429", "title": "Error Handling in Go is returning empty error object in http response", "body": "<p>Error types can't marshal themselves to JSON. There's a few ways to work around this. If you don't want to change your <code>ErrorResponse</code> struct then pretty much the only way is to define a custom <code>MarshalJSON</code> method for your struct where you tell the marshaler to use the string returned by the Error's <code>.Error()</code> method.</p>\n\n<pre><code>func (resp ErrorResponse) MarshalJSON() ([]byte, error) {\n    return json.Marshal(&amp;struct {\n        Status string `json:\"status\"`\n        Error  string `json:\"error\"`\n    }{\n        Status: resp.Status,\n        Error:  resp.Error.Error(),\n    })\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/EgVj_4Cc3W\" rel=\"noreferrer\">https://play.golang.org/p/EgVj_4Cc3W</a></p>\n\n<p>If you want to marshal errors into JSON elsewhere also. Then you could use a custom error type and define marshaling for that, e.g:</p>\n\n<pre><code>type MyError struct {\n    Error error\n}\n\nfunc (err MyError) MarshalJSON() ([]byte, error) {\n    return json.Marshal(err.Error.Error())\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/sjOHj9X0tO\" rel=\"noreferrer\">https://play.golang.org/p/sjOHj9X0tO</a></p>\n\n<p>Simplest (and probably the best) way is to just use a string in your response struct. It makes sense because the actual value you send in the http response is obviously a string, not an error interface.</p>\n\n<pre><code>type ErrorResponse struct {\n        Status string `json:\"status\"`\n        Error  string  `json:\"error\"`\n    }\nerr := errors.New(\"Total Price cannot be a negative value\")\nerrRes := ErrorResponse{\"ERROR\", err.Error()}\nresponse, errr := json.Marshal(errRes)\nif errr != nil {\n    log.Fatal(err)\n    // you should write something to responseWriter w here before returning\n    http.Error(w, \"Internal server error\", http.StatusInternalServerError)\n    return\n}\nio.WriteString(w, string(response))\n</code></pre>\n\n<p>Note that in case the marshaling fails, you should still write some kind of response before returning.</p>\n"}], "owner": {"reputation": 8720, "user_id": 6149787, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/edf1a61aa50a231d521d940d60928292?s=128&d=identicon&r=PG&f=1", "display_name": "Jagrati", "link": "https://stackoverflow.com/users/6149787/jagrati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1990, "favorite_count": 0, "accepted_answer_id": 40131429, "answer_count": 1, "score": 0, "last_activity_date": 1476881076, "creation_date": 1476876998, "last_edit_date": 1476877818, "question_id": 40130349, "link": "https://stackoverflow.com/questions/40130349/error-handling-in-go-is-returning-empty-error-object-in-http-response", "title": "Error Handling in Go is returning empty error object in http response", "body": "<p>I am create <code>API</code> in <code>go</code>. Everything is working fine only that when there is an error I want to show it to the user. I am using go's <code>errors</code> package.</p>\n\n<p>Below is the <code>sample</code> code:</p>\n\n<pre><code>type ErrorResponse struct {\n        Status string `json:\"status\"`\n        Error  error  `json:\"error\"`\n    }\nerr := errors.New(\"Total Price cannot be a negative value\")\nerrRes := ErrorResponse{\"ERROR\", err}\nresponse, errr := json.Marshal(errRes)\nif errr != nil {\n    log.Fatal(err)\n    return\n}\nio.WriteString(w, string(response))\n</code></pre>\n\n<p>The response I am getting is:</p>\n\n<pre><code>{\n  \"status\": \"ERROR\",\n  \"error\": {} //why is this empty\n}\n</code></pre>\n\n<p>error key should have string <code>Total Price cannot be a negative value</code>. I don't understand the problem.</p>\n"}, {"tags": ["html", "go"], "comments": [{"owner": {"reputation": 11294, "user_id": 1239122, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/8cf239e31df87733c835e53851283548?s=128&d=identicon&r=PG", "display_name": "Gravy", "link": "https://stackoverflow.com/users/1239122/gravy"}, "edited": false, "score": 1, "creation_date": 1476867386, "post_id": 40126084, "comment_id": 67523205, "body": "Not sure this is a <code>go</code> problem. I would suggest you edit your <code>&#47;etc&#47;hosts</code> file if I understand your question correctly."}, {"owner": {"reputation": 3824, "user_id": 2728768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bb82b13cda86d3b821fa44100335ddf?s=128&d=identicon&r=PG", "display_name": "thoeni", "link": "https://stackoverflow.com/users/2728768/thoeni"}, "edited": false, "score": 0, "creation_date": 1476869044, "post_id": 40126084, "comment_id": 67524337, "body": "hosts itself will probably not work because you can&#39;t redirect ports. He could configure a local proxy to redirect example.com:80 to localhost:8080"}], "answers": [{"tags": [], "owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "is_accepted": true, "score": 1, "last_activity_date": 1476870403, "last_edit_date": 1490005092, "creation_date": 1476870403, "answer_id": 40127788, "question_id": 40126084, "link": "https://stackoverflow.com/questions/40126084/can-we-re-direct-to-our-application-if-an-external-url-is-hit/40127788#40127788", "title": "Can we re-direct to our application if an external url is hit", "body": "<p>External URLs (links to a site from outside your server) can not be redirected to localhost. </p>\n\n<ol>\n<li><p>You have to use your server IP instead of <code>https://localhost:8080</code> or map example.com to your localhost. <a href=\"https://superuser.com/questions/559623/i-have-a-domain-name-that-i-want-to-redirect-to-my-local-server-how-do-i-do-thi\">Mapping from your domain to your localhost</a> </p></li>\n<li><p>Update DNS records for example.com</p></li>\n<li><p>Inside your go-gin application set router to redirect to /login by <code>HTTP referer</code> or some other way. </p></li>\n</ol>\n"}], "owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 40127788, "answer_count": 1, "score": -2, "last_activity_date": 1476870403, "creation_date": 1476865935, "question_id": 40126084, "link": "https://stackoverflow.com/questions/40126084/can-we-re-direct-to-our-application-if-an-external-url-is-hit", "title": "Can we re-direct to our application if an external url is hit", "body": "<p>I am using go-gin and its html template rendering engine but this question is generic. My application has a login page at <a href=\"https://localhost:8080/login\" rel=\"nofollow\">https://localhost:8080/login</a>. I use a third-party url in my application which re-directs me to another url. (eg:<a href=\"https://example.com\" rel=\"nofollow\">https://example.com</a>). How can I force redirect to <code>https://localhost:8080/login</code> if <code>https://example.com</code> is hit?</p>\n"}, {"tags": ["go", "error-handling"], "answers": [{"comments": [{"owner": {"reputation": 315, "user_id": 6559250, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f4ed53de34f736f2196ac1a26c36dc8d?s=128&d=identicon&r=PG", "display_name": "ahmdrz", "link": "https://stackoverflow.com/users/6559250/ahmdrz"}, "edited": false, "score": 0, "creation_date": 1476867405, "post_id": 40126531, "comment_id": 67523215, "body": "Yeah , So what can I do to get better result from coveralls.io"}, {"owner": {"reputation": 3824, "user_id": 2728768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bb82b13cda86d3b821fa44100335ddf?s=128&d=identicon&r=PG", "display_name": "thoeni", "link": "https://stackoverflow.com/users/2728768/thoeni"}, "reply_to_user": {"reputation": 315, "user_id": 6559250, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f4ed53de34f736f2196ac1a26c36dc8d?s=128&d=identicon&r=PG", "display_name": "ahmdrz", "link": "https://stackoverflow.com/users/6559250/ahmdrz"}, "edited": false, "score": 0, "creation_date": 1476868888, "post_id": 40126531, "comment_id": 67524239, "body": "It&#39;s not about getting &quot;better result&quot;. Coveralls is just telling you that your tests are not covering some scenarios, giving you 81% of the coverage, that means that the 19% missing is represented by those red highlighted lines. An example of what you could do is writing a test that calls the <code>sendRequest</code> function with the <code>login</code> parameter as <code>false</code> and then you verify that you&#39;re getting back the expected <code>error</code>."}], "tags": [], "owner": {"reputation": 3824, "user_id": 2728768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bb82b13cda86d3b821fa44100335ddf?s=128&d=identicon&r=PG", "display_name": "thoeni", "link": "https://stackoverflow.com/users/2728768/thoeni"}, "is_accepted": false, "score": 1, "last_activity_date": 1476867176, "creation_date": 1476867176, "answer_id": 40126531, "question_id": 40125957, "link": "https://stackoverflow.com/questions/40125957/coveralls-io-and-error-handling-in-golang/40126531#40126531", "title": "coveralls.io and error handling in Golang", "body": "<p>I think it's trying to tell you that your tests are not covering that path. It means that the tests you wrote are probably testing only the \"happy path\" and not going into those error handling branches.</p>\n"}], "owner": {"reputation": 315, "user_id": 6559250, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f4ed53de34f736f2196ac1a26c36dc8d?s=128&d=identicon&r=PG", "display_name": "ahmdrz", "link": "https://stackoverflow.com/users/6559250/ahmdrz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1476867176, "creation_date": 1476865560, "question_id": 40125957, "link": "https://stackoverflow.com/questions/40125957/coveralls-io-and-error-handling-in-golang", "title": "coveralls.io and error handling in Golang", "body": "<p>I wrote a <a href=\"https://github.com/ahmdrz/goinsta\" rel=\"nofollow\">library for Instagram API</a> and tell coveralls.io to check my repository</p>\n\n<p>but coveralls.io tell me that all of the error handlers in my source code isn't Good. <a href=\"https://coveralls.io/builds/8405457/source?filename=request.go\" rel=\"nofollow\">see this</a></p>\n\n<p>How can I handle errors perfectly and coveralls.io say it's good :smile:</p>\n\n<blockquote>\n  <p>sorry for my English</p>\n</blockquote>\n"}, {"tags": ["hadoop", "go", "named-pipes", "fuse"], "answers": [{"tags": [], "owner": {"reputation": 2273, "user_id": 6020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f0a9f540105e654ef7d03edc36ad3a?s=128&d=identicon&r=PG", "display_name": "BJ Black", "link": "https://stackoverflow.com/users/6020403/bj-black"}, "is_accepted": true, "score": 1, "last_activity_date": 1476868995, "creation_date": 1476868995, "answer_id": 40127258, "question_id": 40125764, "link": "https://stackoverflow.com/questions/40125764/golang-virtual-file/40127258#40127258", "title": "Golang Virtual File", "body": "<p>I think you actually had the right idea with FUSE.  Without sources for your upstream application, it's hard to say what file semantics it's trying to use (though some time with strace might help to illuminate what's going on.  Maybe...).</p>\n\n<p>In any case, I'd have a look at <a href=\"https://github.com/hanwen/go-fuse\" rel=\"nofollow\">the Go-FUSE project</a>, specifically <a href=\"https://github.com/hanwen/go-fuse/tree/master/example/hello\" rel=\"nofollow\">the hello.go example</a>, which shows exactly how to handle the single file case very well.</p>\n"}, {"tags": [], "owner": {"reputation": 2611, "user_id": 872918, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b89d3f5413870b28a39767f0289c32b?s=128&d=identicon&r=PG", "display_name": "snap", "link": "https://stackoverflow.com/users/872918/snap"}, "is_accepted": false, "score": 1, "last_activity_date": 1477129434, "last_edit_date": 1477129434, "creation_date": 1477086181, "answer_id": 40185848, "question_id": 40125764, "link": "https://stackoverflow.com/questions/40125764/golang-virtual-file/40185848#40185848", "title": "Golang Virtual File", "body": "<p>I understand the problem is that the closed source program2 expects a file name and does not accept input directly from <em>stdin</em>?</p>\n\n<p>You can use a standard Unix-style pipeline when running the programs to connect the <em>stdin</em> and <em>stdout</em> of the processes together. Named pipes can be problematic and using FUSE for this is overly complicated.</p>\n\n<p>You could make your program1 to output to <em>stdout</em>. and supply the closed source program2 with the virtual file name <code>/dev/stdin</code> as follows:</p>\n\n<pre><code>program1 | program2 /dev/stdin\n</code></pre>\n\n<p>This is assuming you are working on Linux (you did not specify but I assume so because you are talking about FUSE).</p>\n\n<p>If program2 cares about the file name (expects a specific name extension for example), you might be able to work around that by creating a symbolic link with the desired name pointing to <code>/dev/stdin</code> and supplying the name of the symbolic link as the argument to program2:</p>\n\n<pre><code>ln -s /dev/stdin file.ext\nprogram1 | program2 file.ext\nrm -f file.ext\n</code></pre>\n\n<p>None of this will work if program2 expects a real file which it can <em>stat</em>   but in this case that should not be an issue (as it is known from the question that program2 accepts a named pipe).</p>\n\n<p>Also if program2 expects keyboard input from <em>stdin</em> this approach will not work.</p>\n"}], "owner": {"reputation": 9005, "user_id": 337504, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/f365e5b3587387ed67c9c747288874e2?s=128&d=identicon&r=PG", "display_name": "Mustafa", "link": "https://stackoverflow.com/users/337504/mustafa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 694, "favorite_count": 0, "accepted_answer_id": 40127258, "answer_count": 2, "score": 0, "last_activity_date": 1477129434, "creation_date": 1476864991, "question_id": 40125764, "link": "https://stackoverflow.com/questions/40125764/golang-virtual-file", "title": "Golang Virtual File", "body": "<p>I have a closed soruce application that takes a file as an input, calculates its hash and does some other stuff I have no control. Modifiying source or reverse engineering is not feasible. </p>\n\n<p>The program is designed to work with regular files, however I need to supply a very large file from HDFS. Copying the file will take too much time and space on disk. So I was thinking of using FUSE but I did not find a good solution. I tried using a named pipe as follows:</p>\n\n<pre><code>func readFile(namenode, path string, pipe *os.File) {\n    client, err := hdfs.New(namenode)\n    log.Println(err, client)\n\n    hdfsFile, err := client.Open(path)\n    if err != nil {\n        log.Fatal(err)\n    }\n    log.Println(hdfsFile)\n\n    // written, err := io.Copy(pipe, hdfsFile)\n    bytes := make([]byte, 4096)\n    for {\n        read, err := hdfsFile.Read(bytes)\n        log.Println(read, err)\n        if err != nil {\n            break\n        }\n        written, err := pipe.Write(bytes)\n        log.Println(written, err)\n    }\n    err = pipe.Close()\n    log.Println(err)\n}\n</code></pre>\n\n<p>I know the above code is not complete, the test file is 10MB, however after reading 8 times 4096 bytes named pipe buffer gets full and the other program takes it all and closes the pipe.</p>\n\n<p>But after a while the other program that is reading the pipe closes the pipe and I get broken pipe error. Is there any possibility of creating a virtual file other than fuse and pipe?</p>\n"}, {"tags": ["matrix", "multidimensional-array", "go"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 1147396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da5eeac7ad7206c2cf1bccdc34fc6d81?s=128&d=identicon&r=PG", "display_name": "uzed_creative", "link": "https://stackoverflow.com/users/1147396/uzed-creative"}, "edited": false, "score": 0, "creation_date": 1476862015, "post_id": 40124245, "comment_id": 67519679, "body": "Thank you very much @t-claverie for your answer.   Your code-example is exactly what i meant by &quot;multiple for-range-loops&quot;... but the thing is, that there may be even more arrays which should be iterated...   You said, the biggest problem is the &quot;two types in one array&quot;-problem... how about solving this part of my problem by replacing the array &quot;c&quot; with a function &quot;c&quot; which has the type-awareness like this: <code>func c(a int, b bool)</code>?"}, {"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "reply_to_user": {"reputation": 65, "user_id": 1147396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da5eeac7ad7206c2cf1bccdc34fc6d81?s=128&d=identicon&r=PG", "display_name": "uzed_creative", "link": "https://stackoverflow.com/users/1147396/uzed-creative"}, "edited": false, "score": 0, "creation_date": 1476874907, "post_id": 40124245, "comment_id": 67528783, "body": "@uzed_creative If you have the type and number of your arrays, it&#39;s possible. If you don&#39;t, you have to create custom functions with type <code>func f(args interface{}...)</code> which will do the same type assertions as above."}], "tags": [], "owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "is_accepted": false, "score": 2, "last_activity_date": 1476860153, "creation_date": 1476860153, "answer_id": 40124245, "question_id": 40123649, "link": "https://stackoverflow.com/questions/40123649/multiply-2-or-more-arrays-in-golang/40124245#40124245", "title": "Multiply 2 or more Arrays in Golang", "body": "<p>Short answer: go is not intended for this kind of problem. What you want is an equivalent of the <code>zip</code> function, which is present natively in some languages (e.g. Haskell, Python, ...)</p>\n\n<p>However, in Golang you'll have one big problem: you can't have dynamic types. That is: an array can contain only one type (int OR bool), not several. The workaround is to make an array of interface, but that means you'd have to make ugly type assertions to get the proper type back.</p>\n\n<p>Also, you do have a general way to do that, but the type you'll get at the end will be <code>[][]interface{}</code> and no way of knowing what's inside.</p>\n\n<p>For your example: here is the simplest way to do what you want (not general): </p>\n\n<pre><code>func main() {\n    a := [3]int{2, 3, 5}\n    b := [2]bool{true, false}\n    var c [6][2]interface{}\n    i := 0\n    for _, val1 := range a {\n        for _, val2 := range b {\n            c[i] = [2]interface{}{val1, val2}\n            i += 1\n        }\n    }\n\n    var a1 int = c[0][0].(int)\n    var b1 bool = c[0][1].(bool)\n    fmt.Printf(\"c[0] is %v, a1 is %d and b1 is %v\\n\", c[0], a1, b1)\n    fmt.Println(c)\n}\n</code></pre>\n\n<p>As you can see, that's ugly and useless in practice (and very error-prone)</p>\n\n<p>So, if you want to make this kind of transformations, you should use another language, Go was not (and won't) designed for this type of purposes.</p>\n"}, {"tags": [], "owner": {"reputation": 636, "user_id": 1695784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb781a195c97a5945823cb3fc0f408b8?s=128&d=identicon&r=PG", "display_name": "Brendan Tracey", "link": "https://stackoverflow.com/users/1695784/brendan-tracey"}, "is_accepted": false, "score": 0, "last_activity_date": 1484771112, "creation_date": 1484771112, "answer_id": 41728813, "question_id": 40123649, "link": "https://stackoverflow.com/questions/40123649/multiply-2-or-more-arrays-in-golang/41728813#41728813", "title": "Multiply 2 or more Arrays in Golang", "body": "<p>This isn't a matrix multiplication, as pointed out above. The two for loops work if there are only two things, but if there are multiple ones it can clearly get tedious.</p>\n\n<p>The way I would do it is to think of a multidimensional array. The total \"number\" of elements is the product of the sizes, and then use a function like SubFor <a href=\"https://godoc.org/github.com/btracey/meshgrid#SubFor\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/btracey/meshgrid#SubFor</a></p>\n\n<pre><code>dims := []int{3,2}\nsz := 1\nfor _,v := range dims {\n    sz *= v\n}\nsub := make([]int, len(dims))\nfor i := 0: i &lt; sz; i++{\n    meshgrid.SubFor(sub, i, dims)\n    fmt.Println(a[sub[0]], b[sub[1]])\n}\n</code></pre>\n\n<p>There are some things with types to figure out (appending to a slice, etc.), but that should give you the general gist.</p>\n"}], "owner": {"reputation": 65, "user_id": 1147396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da5eeac7ad7206c2cf1bccdc34fc6d81?s=128&d=identicon&r=PG", "display_name": "uzed_creative", "link": "https://stackoverflow.com/users/1147396/uzed-creative"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1812, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1484771112, "creation_date": 1476858050, "question_id": 40123649, "link": "https://stackoverflow.com/questions/40123649/multiply-2-or-more-arrays-in-golang", "title": "Multiply 2 or more Arrays in Golang", "body": "<p>maybe it's not just a Go-Problem but i have this problem:</p>\n\n<p>I want to multiply two (or more) arrays, so for example:</p>\n\n<pre><code>a := [3]int{2, 3, 5}\nb := [2]bool{true, false}\n// desired output of \"c\" =&gt; \n// [[2 true] [2 false] [3 true] [3 false] [5 true] [5 false]]\n</code></pre>\n\n<p>I already found this library here: <a href=\"https://godoc.org/github.com/gonum/matrix/mat64\" rel=\"nofollow\">https://godoc.org/github.com/gonum/matrix/mat64</a> but i'm not seeing how to use something else than float64</p>\n\n<p>The fallback-solution would be to use multiple for-range-loops but it'd be amazing if there is a \"smoother\" way to do this</p>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 4213943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67489033053ab153042125b271ea7181?s=128&d=identicon&r=PG&f=1", "display_name": "kker neo", "link": "https://stackoverflow.com/users/4213943/kker-neo"}, "edited": false, "score": 0, "creation_date": 1476874033, "post_id": 40126950, "comment_id": 67528067, "body": "I don&#39;t  understand your  approach. can you explain this more clearly?"}, {"owner": {"reputation": 315, "user_id": 6559250, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f4ed53de34f736f2196ac1a26c36dc8d?s=128&d=identicon&r=PG", "display_name": "ahmdrz", "link": "https://stackoverflow.com/users/6559250/ahmdrz"}, "reply_to_user": {"reputation": 123, "user_id": 4213943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67489033053ab153042125b271ea7181?s=128&d=identicon&r=PG&f=1", "display_name": "kker neo", "link": "https://stackoverflow.com/users/4213943/kker-neo"}, "edited": false, "score": 0, "creation_date": 1476885791, "post_id": 40126950, "comment_id": 67537100, "body": "You can&#39;t make recursive type... you will receive invalid recursive type User"}], "tags": [], "owner": {"reputation": 315, "user_id": 6559250, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f4ed53de34f736f2196ac1a26c36dc8d?s=128&d=identicon&r=PG", "display_name": "ahmdrz", "link": "https://stackoverflow.com/users/6559250/ahmdrz"}, "is_accepted": false, "score": 0, "last_activity_date": 1476885850, "last_edit_date": 1476885850, "creation_date": 1476868228, "answer_id": 40126950, "question_id": 40123231, "link": "https://stackoverflow.com/questions/40123231/gorm-how-to-foreign-self/40126950#40126950", "title": "gorm how to foreign self", "body": "<p>see <a href=\"http://jinzhu.me/gorm/associations.html\" rel=\"nofollow\">http://jinzhu.me/gorm/associations.html</a></p>\n\n<pre><code>type Profile struct {\n    gorm.Model\n    Name string\n}\n\ntype User struct {\n    gorm.Model\n    Profile      Profile `gorm:\"ForeignKey:ProfileRefer\"` // use ProfileRefer as foreign key\n    ProfileRefer int\n}\n</code></pre>\n\n<p>or use another way</p>\n\n<p>something like this ... did you try it ?</p>\n\n<pre><code>type User struct {\n    gorm.Model\n    UserId int\n    Username string\n    BestFriend int\n}\n\nfunc GetUser(id int) User {\n   //select * from users where UserId = id\n}\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 4213943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67489033053ab153042125b271ea7181?s=128&d=identicon&r=PG&f=1", "display_name": "kker neo", "link": "https://stackoverflow.com/users/4213943/kker-neo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 318, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1476885850, "creation_date": 1476856303, "last_edit_date": 1476870093, "question_id": 40123231, "link": "https://stackoverflow.com/questions/40123231/gorm-how-to-foreign-self", "title": "gorm how to foreign self", "body": "<p>for example:</p>\n\n<pre><code>type User struct {\n    gorm.Model\n    BestFriend User\n}\n</code></pre>\n\n<p>I want BestFriend field foreign the same User model,How to define this with golang gorm package.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["elasticsearch", "go"], "answers": [{"tags": [], "owner": {"reputation": 396, "user_id": 4641689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5d41b3f3cc75d119e8b0b5cbd79da65?s=128&d=identicon&r=PG&f=1", "display_name": "Tranvu Xuannhat", "link": "https://stackoverflow.com/users/4641689/tranvu-xuannhat"}, "is_accepted": true, "score": 0, "last_activity_date": 1476860784, "last_edit_date": 1476860784, "creation_date": 1476856269, "answer_id": 40123218, "question_id": 40123002, "link": "https://stackoverflow.com/questions/40123002/golang-using-elasticsearch-library-called-goes-how-can-i-write-executable-code/40123218#40123218", "title": "Golang: Using ElasticSearch library called Goes, how can I write executable code for bool should method?", "body": "<p>I haven't done ElasticSearch with Golang before, but I see some mismatch between your original query and Go query. It should be array of map, each map has a key \"match\". Not a map with duplicate \"match\" (as the error)\nI think in your Golang query, it should be:</p>\n\n<pre><code>   \"should\":[]map[string]interface{} {\n        {       \n                \"match\": map[string]interface{}{\n                    \"year\": \"2016\",\n               },\n        },\n        {\n                \"match\": map[string]interface{}{\n                    \"frequency\": \"7\",\n                },\n        },\n   },\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 6280249, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/856136224514573/picture?type=large", "display_name": "Yoshihito Takashiba", "link": "https://stackoverflow.com/users/6280249/yoshihito-takashiba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 40123218, "answer_count": 1, "score": 0, "last_activity_date": 1476868663, "creation_date": 1476855479, "last_edit_date": 1476868663, "question_id": 40123002, "link": "https://stackoverflow.com/questions/40123002/golang-using-elasticsearch-library-called-goes-how-can-i-write-executable-code", "title": "Golang: Using ElasticSearch library called Goes, how can I write executable code for bool should method?", "body": "<p>I'm using goes library (<a href=\"https://github.com/OwnLocal/goes\" rel=\"nofollow\">https://github.com/OwnLocal/goes</a>), which is the wrapper for ElasticSearch in Golang.</p>\n\n<p>In ElasticSearch queries, we can run like this:</p>\n\n<pre><code>{\n  \"query\": {\n    \"match\": {\n      \"user_id_1\": \"438018\"\n    }\n  }\n}\n</code></pre>\n\n<p>and it works.</p>\n\n<p>For golang using goes, you can run it like as:</p>\n\n<pre><code>var query = map[string]interface{}{\n        \"query\": map[string]interface{}{\n            \"match\": map[string]interface{}{\n                \"user_id_1\": \"438018\",\n            },\n        },\n    }\n</code></pre>\n\n<p>Here is my question, you can use this query in elasticsearch</p>\n\n<pre><code>{\n  \"query\": {\n    \"bool\": {\n      \"should\": [\n        {\n          \"match\": {\n            \"year\": \"2016\"\n          }\n        },\n        {\n          \"match\": {\n            \"frequency\": \"7\"\n          }\n        }\n      ]\n    }\n  }\n}\n</code></pre>\n\n<p>In the above code, it is the bool should clause written in documentation here (<a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/_executing_searches.html\" rel=\"nofollow\">https://www.elastic.co/guide/en/elasticsearch/reference/current/_executing_searches.html</a>)<br>\nSo, I made query2 to search same way as elastic one.</p>\n\n<pre><code>var query2 = map[string]interface{}{\n        \"query\": map[string]interface{}{\n            \"bool\": map[string]interface{}{\n                \"should\": map[string]interface{}{\n                    \"match\": map[string]interface{}{\n                        \"year\": \"2016\",\n                    },\n                    \"match\": map[string]interface{}{\n                        \"frequency\": \"7\",\n                    },\n                },\n            },\n        },\n    }\n</code></pre>\n\n<p><strong>Error: duplicate key \"match\" in map literal</strong></p>\n\n<p>I am not so familiar with interface on golang.<br>\nI hope some has a idea for that. Thanks.</p>\n\n<p>p.s.</p>\n\n<p>Thanks Tranvu Xuannhat :) it helped a lot !</p>\n\n<pre><code>var query2 = map[string]interface{}{\n        \"query\": map[string]interface{}{\n            \"bool\": map[string]interface{}{\n                \"should\": []map[string]interface{}{\n                    map[string]interface{}{\n                        \"match\": map[string]interface{}{\n                              \"year\": \"2016\",\n                          },\n                    },\n                    map[string]interface{}{\n                        \"match\": map[string]interface{}{\n                              \"frequency\": \"7\",\n                          },\n                    },\n                },\n            },\n        },\n    }\n</code></pre>\n\n<p>This is what I did finally.</p>\n"}, {"tags": ["bash", "go", "sed", "bsd"], "answers": [{"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 1, "last_activity_date": 1476858078, "last_edit_date": 1476858078, "creation_date": 1476857178, "answer_id": 40123443, "question_id": 40122581, "link": "https://stackoverflow.com/questions/40122581/sed-1-regex-invalid-command-code/40123443#40123443", "title": "sed: 1: &quot; &#39;/regex/ ...&quot;: invalid command code &#39;", "body": "<p>Shell strips the quote characters, <code>exec.Command</code> does not. So it could be that <code>sed</code> is being passed the <code>'</code>'s with the commands. Try forming the command without the single quotes:</p>\n\n<pre><code>switch command {\n// remove single quotes from strings\ncase \"=\", \"d\":\n    return fmt.Sprintf(\"/%s/ %s\", regex, command)\ncase \"c\", \"a\", \"i\":\n    return fmt.Sprintf(\"/%s/ %s\\\\\\n%s\", regex, command, phrase)\ncase \"s\", \"y\":\n    return fmt.Sprintf(\"%s/%s/%s/\", command, regex, phrase)\ndefault:\n    return \"\"\n}\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 2469321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/125812e97ccb778b4f6d232402465659?s=128&d=identicon&r=PG", "display_name": "user2469321", "link": "https://stackoverflow.com/users/2469321/user2469321"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 468, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476858078, "creation_date": 1476853658, "question_id": 40122581, "link": "https://stackoverflow.com/questions/40122581/sed-1-regex-invalid-command-code", "title": "sed: 1: &quot; &#39;/regex/ ...&quot;: invalid command code &#39;", "body": "<p>I'm trying to write a program to automatically assemble and run sed commands. I'm using the following code snippet to generate commands:</p>\n\n<pre><code>switch command {\ncase \"=\", \"d\":\n    return fmt.Sprintf(\"'/%s/ %s'\", regex, command)\ncase \"c\", \"a\", \"i\":\n    return fmt.Sprintf(\"'/%s/ %s\\\\\\n%s'\", regex, command, phrase)\ncase \"s\", \"y\":\n    return fmt.Sprintf(\"'%s/%s/%s/'\", command, regex, phrase)\ndefault:\n    return \"\"\n}\n</code></pre>\n\n<p>Then I use the following code snippet to run the full command:</p>\n\n<pre><code>fmt.Println(\"Running command: sed\", args)\nprogram := exec.Command(programName, args...)\noutput, err := program.CombinedOutput()\nfmt.Printf(\"%s\", output)\nif err != nil {\n    fmt.Println(err)\n}\n</code></pre>\n\n<p>Which results in the following output (Generating 100s of commands, this is just 1):</p>\n\n<pre><code>Running command: sed [-e '/([0a-z][a-z0-9]*,)+/ c\\\nabc said he\"\"llo!!!\\n    1  ' -e '/(a)(b)(c)(d)(e)(f)(g)(h)(i)(j)(k)(l)/ a\\\n0,0,0,156, aac' -e '/(s?)a.b,a\\nb/ d' -f number_lines.txt -f eliminate_punctuation.txt -f delete_leading_trailing_whitespace.txt -f delete_last_ten_lines.txt -f eliminate_blanks.txt -f number_non_blank_lines.txt -f reverse_lines.txt -f strip.txt input1.txt input2.txt input3.txt]\n\nsed: 1: \" '/([0a-z][a-z0-9]*,)+/ ...\": invalid command code '\nexit status 1\n</code></pre>\n\n<p>That's weird, but what's weirder is if I run the generated command by hand (Without the square brackets of course), it works just fine! What's going on here?</p>\n"}, {"tags": ["go", "reflection"], "comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1476853194, "post_id": 40122374, "comment_id": 67515409, "body": "just fyi, the correct terminology is exported / unexported. Not a huge deal, but it helps when searching."}, {"owner": {"reputation": 4515, "user_id": 1710704, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a3b646c4f3b358bc74cfe636ca9655f7?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Shire", "link": "https://stackoverflow.com/users/1710704/logan-shire"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1476853521, "post_id": 40122374, "comment_id": 67515546, "body": "@captncraig thanks, I&#39;m relatively new to go. I mostly write in swift which has open / public / internal (default) / fileprivate / private access control levels."}], "answers": [{"comments": [{"owner": {"reputation": 4515, "user_id": 1710704, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a3b646c4f3b358bc74cfe636ca9655f7?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Shire", "link": "https://stackoverflow.com/users/1710704/logan-shire"}, "edited": false, "score": 0, "creation_date": 1476852965, "post_id": 40122420, "comment_id": 67515325, "body": "Awesome! I can&#39;t accept your answer for 10 minutes but I will when I can."}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": true, "score": 2, "last_activity_date": 1476852896, "creation_date": 1476852896, "answer_id": 40122420, "question_id": 40122374, "link": "https://stackoverflow.com/questions/40122374/detect-if-golang-method-is-internal/40122420#40122420", "title": "Detect if golang method is internal?", "body": "<p>The reflect package will not give you unexported methods via <code>Type.Method</code>. Pretty much, if you can see it via reflect, it is already exported.</p>\n\n<p>See <a href=\"https://play.golang.org/p/61qQYO38P0\" rel=\"nofollow\">https://play.golang.org/p/61qQYO38P0</a></p>\n"}], "owner": {"reputation": 4515, "user_id": 1710704, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a3b646c4f3b358bc74cfe636ca9655f7?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Shire", "link": "https://stackoverflow.com/users/1710704/logan-shire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 40122420, "answer_count": 1, "score": 0, "last_activity_date": 1476852896, "creation_date": 1476852624, "question_id": 40122374, "link": "https://stackoverflow.com/questions/40122374/detect-if-golang-method-is-internal", "title": "Detect if golang method is internal?", "body": "<p>I'm writing a function that iterates over the methods on a given struct and binds the methods to handlers. I would like to skip over internal methods if possible. I'm not sure if this is possible to do so explicitly - I reviewed the documentation for the reflect package and I didn't see a means to detect if a given Value is an internal method. I know I can get the method's name, and then check if it starts with a lowercase character but I'm not sure if there's a kosher way to accomplish this. It's also possible that the internal / public boundary really only exists at compile time anyways, so there really isn't even a way of knowing this beyond the method's name. In either case I'd like to know for sure. Thanks!</p>\n"}, {"tags": ["python", "windows", "go", "command-line"], "comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1476853273, "post_id": 40121657, "comment_id": 67515448, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/12443203/writing-a-python-extension-in-go-golang\">Writing a Python extension in Go (Golang)</a>"}, {"owner": {"reputation": 2009, "user_id": 1087890, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0f8ec58f46e4af3a67f768675c20aac8?s=128&d=identicon&r=PG", "display_name": "Yang Luo", "link": "https://stackoverflow.com/users/1087890/yang-luo"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1476854093, "post_id": 40121657, "comment_id": 67515762, "body": "@captncraig I think that solution requires to compile the Golang into a library instead of the current executable. Is there a way not to change the Golang executable&#39;s source code?"}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1476856081, "post_id": 40121657, "comment_id": 67516511, "body": "Ah, perhaps the fact that your target app is in go is tangential to your problem. Seems there is some problem interacting with a child process from python."}], "answers": [{"tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": false, "score": 1, "last_activity_date": 1476856243, "creation_date": 1476856243, "answer_id": 40123207, "question_id": 40121657, "link": "https://stackoverflow.com/questions/40121657/how-to-run-interact-with-a-golang-executable-in-python/40123207#40123207", "title": "How to run/interact with a Golang executable in Python?", "body": "<p>Looking at the <a href=\"https://docs.python.org/2/library/subprocess.html#popen-objects\" rel=\"nofollow\">documentation</a> for the subprocess module you are using, it seems they have a warning about deadlocks using <code>stdout.read()</code> and friends:</p>\n\n<blockquote>\n  <p>Warning This will deadlock when using stdout=PIPE and/or stderr=PIPE\n  and the child process generates enough output to a pipe such that it\n  blocks waiting for the OS pipe buffer to accept more data. Use\n  communicate() to avoid that.</p>\n</blockquote>\n\n<p>So, maybe try using <a href=\"https://docs.python.org/2/library/subprocess.html#subprocess.Popen.communicate\" rel=\"nofollow\">communicate</a> instead?</p>\n"}], "owner": {"reputation": 2009, "user_id": 1087890, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0f8ec58f46e4af3a67f768675c20aac8?s=128&d=identicon&r=PG", "display_name": "Yang Luo", "link": "https://stackoverflow.com/users/1087890/yang-luo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 753, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1476856243, "creation_date": 1476847935, "last_edit_date": 1476854958, "question_id": 40121657, "link": "https://stackoverflow.com/questions/40121657/how-to-run-interact-with-a-golang-executable-in-python", "title": "How to run/interact with a Golang executable in Python?", "body": "<p>I have a command-line Golang executable on Windows named <code>cnki-downloader.exe</code> (open-sourced here: <a href=\"https://github.com/amyhaber/cnki-downloader\" rel=\"nofollow\">https://github.com/amyhaber/cnki-downloader</a>). I want to run this executable in Python, and interact with it (get its output, then input something, then get output, and so on)</p>\n\n<p>It's a command-line program, so I thought it's the same as a normal Windows command-line program built by MSVC. My code is like this:</p>\n\n<pre><code># coding=gbk\n\nfrom subprocess import Popen, PIPE\n\np = Popen([\"cnki-downloader.exe\"], stdin=PIPE, stdout=PIPE)\n#p = Popen([\"WlanHelper.exe\"], stdin=PIPE, stdout=PIPE )\n\np.stdin.write( 'XXXXXX\\n' )\nresult1 = p.stdout.read() # &lt;---- we never return here\nprint result1\n\np.stdin.write( '1\\n' )\nresult2 = p.stdout.read()\nprint result2\n</code></pre>\n\n<p>My Python code halts at the <code>Popen</code> call with <code>cnki-downloader.exe</code> parameter. Then I tried a C command-line program built by MSVC (named <code>WlanHelper.exe</code>), it runs well. My script can get the output from the exe.</p>\n\n<p>So I suspect that the command-line mechanism of the Golang executable is different from a native C/C++ program, and it's difficult for other languages (like Python) to call and interact with it.</p>\n\n<p>So I want to know <strong>how to interact with a Golang executable on Windows in other languages like Python?</strong>. If this is impossible, I can also consider modifying the Golang program's source code (because it's open source). But I hope I won't go that step. Thanks!</p>\n\n<hr>\n\n<p><strong>NOTE:</strong></p>\n\n<p>If possible, I want to call this Golang executable directly, instead of modifying it into a library and let Python import it. If I have to modify the Golang into a library, why not just remove the interactive manner and make everything into command-line parameters? There's no need to bother writing a Golang library. So please let's assume the Golang program is closed-sourced. I don't think there's no way for Python to call a command-line Golang program. If this is the case, then I think Golang <strong>REALLY</strong> needs to be improved in the interoperability with other languages.</p>\n"}, {"tags": ["go", "reader"], "answers": [{"tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": true, "score": 2, "last_activity_date": 1476843444, "creation_date": 1476843444, "answer_id": 40121001, "question_id": 40120850, "link": "https://stackoverflow.com/questions/40120850/where-is-the-memory-allocated-for-p/40121001#40121001", "title": "Where is the memory allocated for p", "body": "<p>io.Copy will call the method Read() of the io.Reader, take a look to the implementation <a href=\"https://golang.org/src/io/io.go?s=12490:12550#L349\" rel=\"nofollow\">https://golang.org/src/io/io.go?s=12490:12550#L349</a> and if you keep reading just a few lines below you'll find the method copyBuffer() and inside you will see these lines:</p>\n\n<pre><code>if buf == nil {\n    buf = make([]byte, 32*1024)\n}\n\nfor {\n    nr, er := src.Read(buf)\n\n// ...more stuff\n</code></pre>\n"}], "owner": {"reputation": 251, "user_id": 2218931, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/962ce6ae1a76fac9ab25b139666d7443?s=128&d=identicon&r=PG", "display_name": "ponypaver", "link": "https://stackoverflow.com/users/2218931/ponypaver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 40121001, "answer_count": 1, "score": 1, "last_activity_date": 1476843444, "creation_date": 1476842439, "last_edit_date": 1476842771, "question_id": 40120850, "link": "https://stackoverflow.com/questions/40120850/where-is-the-memory-allocated-for-p", "title": "Where is the memory allocated for p", "body": "<pre><code>package main\n\nimport (\n       \"io\"\n       \"os\"\n       \"strings\"\n)\n\ntype rot13Reader struct {\n        r io.Reader\n}\n\nfunc (rot *rot13Reader) Read(p []byte) (n int, err error) {\n        n, err = rot.r.Read(p)     //&lt;---- where allocated the mem for p?\n        for i := 0; i &lt; len(p); i++ {\n                if p[i] &gt;= 'A' &amp;&amp; p[i] &lt;= 'Z' {\n                        p[i] = 65 + (p[i] - 65 + 13) % 26\n                } else if p[i] &gt;= 'a' &amp;&amp; p[i] &lt;= 'z' {\n                        p[i] = 97 + (p[i] - 97 + 13) % 26\n                }\n        }\n        return\n}\n\nfunc main() {\n        s := strings.NewReader(\"Lbh penpxrq gur pbqr!\")\n        r := rot13Reader{s}\n        io.Copy(os.Stdout, &amp;r)\n}\n</code></pre>\n\n<p>This is an exercise from A tour of go. The code above can run properly, but I just don't understand where allocated the mem of p.</p>\n"}, {"tags": ["reactjs", "model-view-controller", "go", "web-config", "web-frameworks"], "answers": [{"comments": [{"owner": {"reputation": 725, "user_id": 156459, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e944b56331602c572d23b47243dca582?s=128&d=identicon&r=PG", "display_name": "thamurath", "link": "https://stackoverflow.com/users/156459/thamurath"}, "edited": false, "score": 0, "creation_date": 1481574222, "post_id": 40122591, "comment_id": 69422157, "body": "Sorry for the  late comment ... but How can I then consume the API rest using ReactJs?"}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": false, "score": 0, "last_activity_date": 1476853688, "creation_date": 1476853688, "answer_id": 40122591, "question_id": 40120778, "link": "https://stackoverflow.com/questions/40120778/web-mvc-framework-for-bridging-front-end-access-to-go-lang-back-end-rest-api/40122591#40122591", "title": "Web MVC framework for bridging front-end access to Go-lang back-end REST API", "body": "<p>You can use reactjs and go together, and many people have. You may want to check out something like this <a href=\"https://github.com/olebedev/go-starter-kit/blob/master/server/main.go\" rel=\"nofollow\">go react starter kit</a> although that seems pretty complicated.</p>\n\n<p>MVC is not really a thing you hear about terribly often in go apps. You really just need a rest api that exposes your data. You can build that with the standard library, or use a simple framework like <a href=\"https://github.com/gorilla/mux\" rel=\"nofollow\">gorilla</a>. </p>\n"}], "owner": {"reputation": 3, "user_id": 4845183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/795ae64a19b1e93ea90444d14c774822?s=128&d=identicon&r=PG", "display_name": "user4845183", "link": "https://stackoverflow.com/users/4845183/user4845183"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 375, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1476853688, "creation_date": 1476841868, "question_id": 40120778, "link": "https://stackoverflow.com/questions/40120778/web-mvc-framework-for-bridging-front-end-access-to-go-lang-back-end-rest-api", "title": "Web MVC framework for bridging front-end access to Go-lang back-end REST API", "body": "<p>I want to use ReactJS for the front-end and Go for back-end. But both of these technologies is not a web mvc framework.\nWhat mvc framework can i have to use to provide capabilities like routing an accessing the backend Go API?</p>\n"}, {"tags": ["go", "utf-8", "utf-16"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1597756040, "last_edit_date": 1597756040, "creation_date": 1476839222, "answer_id": 40120464, "question_id": 40120171, "link": "https://stackoverflow.com/questions/40120171/golang-convert-utf16-string-to-utf8/40120464#40120464", "title": "Golang convert UTF16 string to UTF8", "body": "<p><a href=\"https://godoc.org/strconv#ParseInt\" rel=\"nofollow noreferrer\">Parse</a> the hex string as an integer. Use a <a href=\"https://golang.org/ref/spec#Conversions_to_and_from_a_string_type\" rel=\"nofollow noreferrer\">string conversion</a> to convert the integer to UTF-8.</p>\n<pre><code>n, err := strconv.ParseInt(&quot;00A9&quot;, 16, 32)\nif err != nil {\n    log.Fatal(err)\n}\ns := string(rune(n))\n</code></pre>\n<p><a href=\"https://play.golang.org/p/9rZRnYwXPVH\" rel=\"nofollow noreferrer\">playground example</a></p>\n"}, {"tags": [], "owner": {"reputation": 23221, "user_id": 40214, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1a9434856852a991a585fbb993174c81?s=128&d=identicon&r=PG", "display_name": "Dennis C", "link": "https://stackoverflow.com/users/40214/dennis-c"}, "is_accepted": false, "score": -1, "last_activity_date": 1476841312, "creation_date": 1476841312, "answer_id": 40120716, "question_id": 40120171, "link": "https://stackoverflow.com/questions/40120171/golang-convert-utf16-string-to-utf8/40120716#40120716", "title": "Golang convert UTF16 string to UTF8", "body": "<p>There are unicode packages in Go</p>\n\n<ul>\n<li><a href=\"https://golang.org/pkg/unicode/utf16/\" rel=\"nofollow\">https://golang.org/pkg/unicode/utf16/</a></li>\n<li><a href=\"https://golang.org/pkg/unicode/utf8/\" rel=\"nofollow\">https://golang.org/pkg/unicode/utf8/</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 34, "user_id": 8908255, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_aABUtMLIBE/AAAAAAAAAAI/AAAAAAAABJA/Ew3fMA5NW0Y/photo.jpg?sz=128", "display_name": "Sergienko Vitaly", "link": "https://stackoverflow.com/users/8908255/sergienko-vitaly"}, "is_accepted": false, "score": 0, "last_activity_date": 1580318457, "creation_date": 1580318457, "answer_id": 59972414, "question_id": 40120171, "link": "https://stackoverflow.com/questions/40120171/golang-convert-utf16-string-to-utf8/59972414#59972414", "title": "Golang convert UTF16 string to UTF8", "body": "<p>you can try lib: <a href=\"https://github.com/softlandia/cpd\" rel=\"nofollow noreferrer\">codepage detect</a></p>\n\n<pre><code>s := \"...\"\ns = cpd.DecodeUTF16be(s)\ns = cpd.DecodeUTF16le(s)\n</code></pre>\n"}], "owner": {"reputation": 601, "user_id": 1347268, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/abd1a63352cf4aa1e8e18228eb2c88c3?s=128&d=identicon&r=PG", "display_name": "Mark Fletcher", "link": "https://stackoverflow.com/users/1347268/mark-fletcher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2080, "favorite_count": 0, "accepted_answer_id": 40120464, "answer_count": 3, "score": 1, "last_activity_date": 1597756040, "creation_date": 1476836993, "question_id": 40120171, "link": "https://stackoverflow.com/questions/40120171/golang-convert-utf16-string-to-utf8", "title": "Golang convert UTF16 string to UTF8", "body": "<p>I'm building a map of emoji unified unicode characters to their common names. I have strings representing each emoji, in UTF16 format. For example, the string \"00A9\" represents the copyright symbol. I need to convert that into a utf8 rune, so I can compare it to input I receive from the user, but I haven't found the right incantation of the hex/utf16/utf8 packages to do so.</p>\n"}, {"tags": ["go", "timezone"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1476840347, "post_id": 40120056, "comment_id": 67512203, "body": "<code>func (t Time) Format(layout string)</code> doesn&#39;t take a time zone (other than &quot;MST&quot; to indicate where you want the time zone to go in the output)."}, {"owner": {"reputation": 3446, "user_id": 2061590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSoY0.jpg?s=128&g=1", "display_name": "Dmitri Goldring", "link": "https://stackoverflow.com/users/2061590/dmitri-goldring"}, "edited": false, "score": 0, "creation_date": 1476846035, "post_id": 40120056, "comment_id": 67513471, "body": "The documentation for <a href=\"https://golang.org/pkg/time/#LoadLocation\" rel=\"nofollow noreferrer\">time.LoadLocation</a> describes where Go looks for time zone information."}, {"owner": {"reputation": 177852, "user_id": 576911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a2941970f141aad669d13375dc57c4f?s=128&d=identicon&r=PG", "display_name": "Howard Hinnant", "link": "https://stackoverflow.com/users/576911/howard-hinnant"}, "edited": false, "score": 0, "creation_date": 1476847038, "post_id": 40120056, "comment_id": 67513706, "body": "If you can call a C++ library I can show how to do this."}], "answers": [{"tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": false, "score": 6, "last_activity_date": 1476846748, "last_edit_date": 1476846748, "creation_date": 1476846366, "answer_id": 40121430, "question_id": 40120056, "link": "https://stackoverflow.com/questions/40120056/get-a-list-of-valid-time-zones-in-go/40121430#40121430", "title": "Get a list of valid time zones in Go", "body": "<p>Go's time pkg uses a <a href=\"https://en.wikipedia.org/wiki/List_of_tz_database_time_zones\" rel=\"noreferrer\">timezone</a> database.</p>\n\n<p>You can load a timezone location like this:</p>\n\n<pre><code>loc, err := time.LoadLocation(\"America/Chicago\")\nif err != nil {\n    // handle error\n}\n\nt := time.Now().In(loc)\n</code></pre>\n\n<p>The <code>Format</code> function is not related to setting the time zone, this function takes a fixed reference time that allows you to format the date how you would like. Take a look at the time pkg <a href=\"https://golang.org/pkg/time/\" rel=\"noreferrer\">docs</a>.</p>\n\n<p>For instance:</p>\n\n<pre><code>fmt.Println(t.Format(\"MST\")) // outputs CST\n</code></pre>\n\n<p>Here is a running <a href=\"https://play.golang.org/p/lZMCN7t34o\" rel=\"noreferrer\">example</a></p>\n"}, {"comments": [{"owner": {"reputation": 24641, "user_id": 285694, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6af708e77a9683635ee600ced1bdac00?s=128&d=identicon&r=PG", "display_name": "BadPirate", "link": "https://stackoverflow.com/users/285694/badpirate"}, "edited": false, "score": 0, "creation_date": 1476903226, "post_id": 40130882, "comment_id": 67548581, "body": "Fantastic!  Though, I think there is a typo in <code>ReadFile(&quot;&quot;)</code> -- Shouldn&#39;t it be <code>ReadFile(zoneDir)</code>?"}, {"owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "reply_to_user": {"reputation": 24641, "user_id": 285694, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6af708e77a9683635ee600ced1bdac00?s=128&d=identicon&r=PG", "display_name": "BadPirate", "link": "https://stackoverflow.com/users/285694/badpirate"}, "edited": false, "score": 1, "creation_date": 1476903553, "post_id": 40130882, "comment_id": 67548750, "body": "Nope, no typo) It is because of recursion. Also it is more like prototype, so you can refine and integrate somewhere, but you probably need to store results instead of just printing."}, {"owner": {"reputation": 696, "user_id": 7250580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2VtZT.jpg?s=128&g=1", "display_name": "jeremiah.trein", "link": "https://stackoverflow.com/users/7250580/jeremiah-trein"}, "edited": false, "score": 1, "creation_date": 1519318707, "post_id": 40130882, "comment_id": 84872947, "body": "Any idea how to include the default fallback data located inside of <code>$GOROOT&#47;lib&#47;time</code>?"}], "tags": [], "owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "is_accepted": true, "score": 21, "last_activity_date": 1476882897, "last_edit_date": 1476882897, "creation_date": 1476878519, "answer_id": 40130882, "question_id": 40120056, "link": "https://stackoverflow.com/questions/40120056/get-a-list-of-valid-time-zones-in-go/40130882#40130882", "title": "Get a list of valid time zones in Go", "body": "<p>To get a list of time zones, you can use something like:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"strings\"\n)\n\nvar zoneDirs = []string{\n    // Update path according to your OS\n    \"/usr/share/zoneinfo/\",\n    \"/usr/share/lib/zoneinfo/\",\n    \"/usr/lib/locale/TZ/\",\n}\n\nvar zoneDir string\n\nfunc main() {\n    for _, zoneDir = range zoneDirs {\n        ReadFile(\"\")\n    }\n}\n\nfunc ReadFile(path string) {\n    files, _ := ioutil.ReadDir(zoneDir + path)\n    for _, f := range files {\n        if f.Name() != strings.ToUpper(f.Name()[:1]) + f.Name()[1:] {\n            continue\n        }\n        if f.IsDir() {\n            ReadFile(path + \"/\" + f.Name())\n        } else {\n            fmt.Println((path + \"/\" + f.Name())[1:])\n        }\n    }\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>Africa/Abidjan\nAfrica/Accra\nAfrica/Addis_Ababa\nAfrica/Algiers\nAfrica/Asmara\nAfrica/Asmera\nAfrica/Bamako\nAfrica/Bangui\n...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13341954, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KRtsqXBQe28/AAAAAAAAAAI/AAAAAAAAAAA/AAKWJJNUDgNN_YH4pn8wuj-6117-fGGvHw/photo.jpg?sz=128", "display_name": "C Southwell", "link": "https://stackoverflow.com/users/13341954/c-southwell"}, "is_accepted": false, "score": 0, "last_activity_date": 1601848433, "last_edit_date": 1601848433, "creation_date": 1601689481, "answer_id": 64179984, "question_id": 40120056, "link": "https://stackoverflow.com/questions/40120056/get-a-list-of-valid-time-zones-in-go/64179984#64179984", "title": "Get a list of valid time zones in Go", "body": "<p>Here is an example: <a href=\"https://play.golang.org/p/KFGQiW5A1P-\" rel=\"nofollow noreferrer\">https://play.golang.org/p/KFGQiW5A1P-</a></p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;io/ioutil&quot;\n    &quot;strings&quot;\n    &quot;unicode&quot;\n)\n\nfunc main() {\n    fmt.Println(GetOsTimeZones())\n}\n\nfunc GetOsTimeZones() []string {\n    var zones []string\n    var zoneDirs = []string{\n        // Update path according to your OS\n        &quot;/usr/share/zoneinfo/&quot;,\n        &quot;/usr/share/lib/zoneinfo/&quot;,\n        &quot;/usr/lib/locale/TZ/&quot;,\n    }\n\n    for _, zd := range zoneDirs {\n        zones = walkTzDir(zd, zones)\n\n        for idx, zone := range zones {\n            zones[idx] = strings.ReplaceAll(zone, zd+&quot;/&quot;, &quot;&quot;)\n        }\n    }\n\n    return zones\n}\n\nfunc walkTzDir(path string, zones []string) []string {\n    fileInfos, err := ioutil.ReadDir(path)\n    if err != nil {\n        return zones\n    }\n\n    isAlpha := func(s string) bool {\n        for _, r := range s {\n            if !unicode.IsLetter(r) {\n                return false\n            }\n        }\n        return true\n    }\n\n    for _, info := range fileInfos {\n        if info.Name() != strings.ToUpper(info.Name()[:1])+info.Name()[1:] {\n            continue\n        }\n\n        if !isAlpha(info.Name()[:1]) {\n            continue\n        }\n\n        newPath := path + &quot;/&quot; + info.Name()\n\n        if info.IsDir() {\n            zones = walkTzDir(newPath, zones)\n        } else {\n            zones = append(zones, newPath)\n        }\n    }\n\n    return zones\n}\n</code></pre>\n"}], "owner": {"reputation": 24641, "user_id": 285694, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6af708e77a9683635ee600ced1bdac00?s=128&d=identicon&r=PG", "display_name": "BadPirate", "link": "https://stackoverflow.com/users/285694/badpirate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16129, "favorite_count": 4, "accepted_answer_id": 40130882, "answer_count": 3, "score": 12, "last_activity_date": 1601848433, "creation_date": 1476836124, "question_id": 40120056, "link": "https://stackoverflow.com/questions/40120056/get-a-list-of-valid-time-zones-in-go", "title": "Get a list of valid time zones in Go", "body": "<p>I'd like to write a method that will populate a Go Language array with the common timezones that are accepted by the <code>time.Format()</code> call, for use in an HTML template (Form select to allow them to read and choose their timezone).  Is there a common way to do this?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1476969667, "last_edit_date": 1476969667, "creation_date": 1476824221, "answer_id": 40117942, "question_id": 40117827, "link": "https://stackoverflow.com/questions/40117827/display-base-10-representation-of-huge-hexa-string/40117942#40117942", "title": "Display base 10 representation of huge hexa string?", "body": "<p>Your hex value is larger than <code>int64</code> can hold, so you have to use a <code>big.Int</code></p>\n\n<p><a href=\"https://play.golang.org/p/OPPL43u6nB\" rel=\"nofollow\">https://play.golang.org/p/OPPL43u6nB</a></p>\n\n<pre><code>i := new(big.Int)\ni.SetString(\"58068906d6194c6cbda7a6df\", 16)\nfmt.Println(i)\n</code></pre>\n\n<p>To get a hex string representation from a <code>big.Int</code>, you can use the <code>Text</code> method:</p>\n\n<pre><code>hex := i.Text(16)\n</code></pre>\n"}], "owner": {"reputation": 2349, "user_id": 316855, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e4268090367ad8c19af73ea30561aad?s=128&d=identicon&r=PG", "display_name": "Dominic St-Pierre", "link": "https://stackoverflow.com/users/316855/dominic-st-pierre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 40117942, "answer_count": 1, "score": 0, "last_activity_date": 1476969667, "creation_date": 1476823765, "question_id": 40117827, "link": "https://stackoverflow.com/questions/40117827/display-base-10-representation-of-huge-hexa-string", "title": "Display base 10 representation of huge hexa string?", "body": "<p>Trying to find how to have this hexa string \"58068906d6194c6cbda7a6df\" into it's base 10 representation.</p>\n\n<p>I tried with this:</p>\n\n<pre><code>i, err := strconv.Parse(\"58068906d6194c6cbda7a6df\", 16, 64)\n</code></pre>\n\n<p>Obviously I'm getting this error: <code>parsing \"58068906d6194c6cbda7a6df\"; value out of range</code></p>\n\n<p>I also need to take the base 10 string representation and get this hexa value back after some processing. i.e.:</p>\n\n<p><code>\nbase10 := \"58068906d6194c6cbda7a6df\" =&gt; to base 10 string\nsome processing\nhexa := base10 =&gt; to base 16 string\n</code></p>\n\n<p>Can I use the <code>fmt</code> package to dislpay the base 10? I know that displaying the hexa of a base 10 I could use %x, but what can I do with an existing string?</p>\n\n<p>Thanks for your help, for a reason I cannot understand, I'm unable to find any way to do this.</p>\n"}, {"tags": ["go", "neo4j"], "comments": [{"owner": {"reputation": 2040, "user_id": 1342137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e75e480f97bb17342ac38c1edda19805?s=128&d=identicon&r=PG", "display_name": "Ajay M", "link": "https://stackoverflow.com/users/1342137/ajay-m"}, "edited": false, "score": 0, "creation_date": 1513783787, "post_id": 40117546, "comment_id": 82786221, "body": "I have just started delving in Neo4j with golang bolt-driver. One of things indicated in docs is, the Connection object is NOT thread-safe. It seems each goroutine should create its own Connection. Don&#39;t know if this your issue. <a href=\"https://godoc.org/github.com/johnnadratowski/golang-neo4j-bolt-driver#Conn\" rel=\"nofollow noreferrer\">Reference</a>"}, {"owner": {"reputation": 1273, "user_id": 2436902, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/iGuzl.jpg?s=128&g=1", "display_name": "Matt Fiocca", "link": "https://stackoverflow.com/users/2436902/matt-fiocca"}, "reply_to_user": {"reputation": 2040, "user_id": 1342137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e75e480f97bb17342ac38c1edda19805?s=128&d=identicon&r=PG", "display_name": "Ajay M", "link": "https://stackoverflow.com/users/1342137/ajay-m"}, "edited": false, "score": 0, "creation_date": 1513790654, "post_id": 40117546, "comment_id": 82790237, "body": "Thanks for commenting. its been over a year since i&#39;ve touched this, so I&#39;m not sure if i&#39;ll get some time to test this out, but will let you know if I do. Do you want to submit your comment as an answer, in case I get around to it and it turns out correct?"}], "answers": [{"tags": [], "owner": {"reputation": 2040, "user_id": 1342137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e75e480f97bb17342ac38c1edda19805?s=128&d=identicon&r=PG", "display_name": "Ajay M", "link": "https://stackoverflow.com/users/1342137/ajay-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1513807316, "creation_date": 1513807316, "answer_id": 47914982, "question_id": 40117546, "link": "https://stackoverflow.com/questions/40117546/handling-concurrent-neo4j-connections-with-goroutines/47914982#47914982", "title": "Handling concurrent neo4j connections with goroutines", "body": "<p>It is possible you are using thread unsafe functionality in neo4j-bolt-driver.</p>\n\n<p>There are 2 versions of drivers provided by Neo4j-bolt-driver:</p>\n\n<ol>\n<li><a href=\"https://godoc.org/github.com/johnnadratowski/golang-neo4j-bolt-driver#Driver\" rel=\"nofollow noreferrer\"><code>Driver</code></a> Plain driver </li>\n<li><a href=\"https://godoc.org/github.com/johnnadratowski/golang-neo4j-bolt-driver#DriverPool\" rel=\"nofollow noreferrer\"><code>DriverPool</code></a> Driver which manages connection pool </li>\n</ol>\n\n<p>The driver objects themselves are thread-safe, but the <code>Conn</code> object which represent the underlying connection are not. You maybe using the <code>Conn</code> object in a way that its not meant to be.</p>\n\n<p>With goroutines, its best to create <code>Conn</code> objects using <code>DriverPool</code> methods. When <code>Close</code> is called on the connection, it doesn't necessarily close the underlying connection and reclaims the connection for reuse.</p>\n"}], "owner": {"reputation": 1273, "user_id": 2436902, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/iGuzl.jpg?s=128&g=1", "display_name": "Matt Fiocca", "link": "https://stackoverflow.com/users/2436902/matt-fiocca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 507, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1513807316, "creation_date": 1476822710, "question_id": 40117546, "link": "https://stackoverflow.com/questions/40117546/handling-concurrent-neo4j-connections-with-goroutines", "title": "Handling concurrent neo4j connections with goroutines", "body": "<p>We've been tasked with migrating quite a bit of xml data (1.27 million xml files, one node with properties per file) into a Neo graph, and we've been using go routines to chew through files, parse xml, prepare cypher queries for inserts etc. Due to the architecture of having to process the xml, we are using go routines concurrently with channels to process each file in threads, throttling the number of workers going on at one time. </p>\n\n<p>The issue i'm having is that I'm running into errors like \"tcp connection reset by peer\" and also \"panic: Couldn't read expected bytes for message length. Read: 0 Expected: 2.\" and I can only imagine this is due to running connections and statements concurrently in our workers. Our throttling has us at 100 concurrent workers, and I wouldn't think this would be a major problem for Neo, but I just can't figure out why its choking on us.</p>\n\n<p>Are there any architecture recommendations out there for handling a use case like this, where we have to run single cypher statements in large numbers of worker routines (in our case 100 at a time)?</p>\n\n<p>Currently, we're walking a file tree to build up a queue of files to process, then after the walk is done, we iterate that queue and fire off go routines to process each file, using a buffered throttle channel to block the firing off of new routines until previous routines have finished. Within each routine i'm spinning up a new connection, prepare statement, execute, close, etc..</p>\n\n<p>I see this package offers Pipelines, but i'm just not sure how to use that within the processing/queue/channel architecture that we've got going currently:</p>\n\n<p><a href=\"https://github.com/johnnadratowski/golang-neo4j-bolt-driver\" rel=\"nofollow\">https://github.com/johnnadratowski/golang-neo4j-bolt-driver</a></p>\n\n<p>I've also tried using:</p>\n\n<p><a href=\"https://github.com/go-cq/cq\" rel=\"nofollow\">https://github.com/go-cq/cq</a></p>\n\n<p>But keep getting <code>tcp connection reset by peer</code> errors when trying to connect to Neo concurrently. </p>\n"}, {"tags": ["json", "go", "server", "slice", "type-assertion"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476821024, "post_id": 40117053, "comment_id": 67505665, "body": "What does the panic say?"}, {"owner": {"reputation": 167, "user_id": 2585073, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3478605d2726eddbe05a158ebf4b41fc?s=128&d=identicon&r=PG", "display_name": "mudejar", "link": "https://stackoverflow.com/users/2585073/mudejar"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476821202, "post_id": 40117053, "comment_id": 67505778, "body": "When I send a get request I get a stack trace that traces back to the line of code mentioned above and I get a 500"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476821359, "post_id": 40117053, "comment_id": 67505860, "body": "The panic will contain an error message, what is that message?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1476822091, "post_id": 40117053, "comment_id": 67506276, "body": "Well if the type <i>assertion</i> panics the assertion was not fulfilled: You have something different in rInterface than what you expect. You might want to debug it. %T is useful in fmt.Printf here."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1476822229, "post_id": 40117053, "comment_id": 67506346, "body": "I&#39;d be willing to bet you&#39;ve got a slice of <code>Position</code> struct <i>values</i> in that interface (ie the interface holds a <code>[]Position</code>).  The type <code>Position</code> does not fulfill the <code>Resource</code> interface because all of the methods on <code>Position</code> have pointer receivers.  That&#39;s the one gotcha about putting types into interfaces, the methods either need to be value methods or you need to put a pointer to the type into the interface."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1476822663, "post_id": 40117053, "comment_id": 67506588, "body": "The easiest way to check if this is the case (and correct the problem if so) is to change the line from <code>r := s.Index(i)</code> to <code>r := s.Index(i).Addr()</code>.  That will store the address of <code>s[i]</code> into <code>rInterface</code>, which will cause it to fulfill the <code>Resource</code> type if the receivers are the problem."}, {"owner": {"reputation": 167, "user_id": 2585073, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3478605d2726eddbe05a158ebf4b41fc?s=128&d=identicon&r=PG", "display_name": "mudejar", "link": "https://stackoverflow.com/users/2585073/mudejar"}, "edited": false, "score": 0, "creation_date": 1476825529, "post_id": 40117053, "comment_id": 67508052, "body": "You&#39;re right this was it! I just did what you suggested and it&#39;s working now thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 167, "user_id": 2585073, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3478605d2726eddbe05a158ebf4b41fc?s=128&d=identicon&r=PG", "display_name": "mudejar", "link": "https://stackoverflow.com/users/2585073/mudejar"}, "is_accepted": true, "score": 0, "last_activity_date": 1476825803, "creation_date": 1476825803, "answer_id": 40118319, "question_id": 40117053, "link": "https://stackoverflow.com/questions/40117053/why-does-my-code-panic-when-i-type-assert-an-interface/40118319#40118319", "title": "Why does my code panic when I type assert an interface?", "body": "<p>Ok Kaedys suggested that I change\n    r := s.Index(i)\nInto:\n    r := s.Index(i).Addr()</p>\n\n<p>And this did the trick, apparently the problem occurs when you use an object that is supposed to fulfill an interface, but all the methods on that object have pointer receivers. I just needed to put a pointer to the type into the interface.</p>\n"}], "owner": {"reputation": 167, "user_id": 2585073, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3478605d2726eddbe05a158ebf4b41fc?s=128&d=identicon&r=PG", "display_name": "mudejar", "link": "https://stackoverflow.com/users/2585073/mudejar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 40118319, "answer_count": 1, "score": -2, "last_activity_date": 1476825803, "creation_date": 1476820885, "question_id": 40117053, "link": "https://stackoverflow.com/questions/40117053/why-does-my-code-panic-when-i-type-assert-an-interface", "title": "Why does my code panic when I type assert an interface?", "body": "<p>I have some server code that sends a request to an endpoint and receives a JSON response which is stored in an object that is of type empty interface. I have to parse out the information and store it in a slice of \"Resource\" objects, with Resource being an interface. The JSON data in my case represents a \"Position\" object, which satisfies the Resource interface. So basically the code for these look like this:</p>\n\n<pre><code>// Resource interface type\ntype Resource interface {\n    // Identifier returns the id for the object\n    Identifier() bson.ObjectId\n    // Description give a short description of the object\n    Description() string\n    // Initialize should configure a resource with defaults\n    Initialize()\n    // Collection name for resource\n    Collection() string\n    // Indexes for the resources\n    Indexes() []mgo.Index\n    // UserACL returns the user access control list\n    UserACL() *UserACL\n    // IsEqual should compare and return if resources are equal\n    IsEqual(other Resource) bool\n    // Refresh should update a resource from the database\n    Refresh()\n}\n</code></pre>\n\n<p>And the position model is:</p>\n\n<pre><code>// Position model\ntype Position struct {\n    ID        bson.ObjectId `json:\"id\" bson:\"_id,omitempty\" fake:\"bson_id\"`\n    Title     string        `json:\"title\" bson:\"title\" fake:\"job_title\"`\n    Summary   string        `json:\"summary\" bson:\"summary,omitempty\" fake:\"paragraph\"`\n    IsCurrent bool          `json:\"isCurrent\" bson:\"is_current,omitempty\" fake:\"bool\"`\n    CompanyID bson.ObjectId `json:\"company\" bson:\"company_id,omitempty\" fake:\"bson_id\"`\n    UACL      *UserACL      `bson:\"user_acl,omitempty\" fake:\"user_acl\"`\n}\n\n// Identifier returns the id for the object\nfunc (p *Position) Identifier() bson.ObjectId {\n    return p.ID\n}\n\n// Description give a short description of the object\nfunc (p *Position) Description() string {\n    return fmt.Sprintf(\"[%v:%v]\", p.Collection(), p.ID)\n}\n....(the other methods follow)\n</code></pre>\n\n<p>My endpoint is designed to retrieve a list of positions in my database, so this obviously means that the empty interface containing the JSON data contains a slice of Resources, and can't be type asserted into a slice (Go doesn't allow this) and instead done manually by iteration. So I followed through the code and isolated my problem to this:</p>\n\n<pre><code>func InterfaceSlice(slice interface{}) []Resource {\n    s := reflect.ValueOf(slice).Elem()\n    if s.Kind() != reflect.Slice {\n        panic(\"InterfaceSlice() given a non-slice type\")\n    }\n\n    ret := make([]Resource, s.Len())\n\n    for i := 0; i &lt; s.Len(); i++ {\n        r := s.Index(i)\n        rInterface := r.Interface()\n        ret[i] = rInterface.(Resource)\n    }\n\n    return ret\n}\n</code></pre>\n\n<p>Everything in the above code is working just fine until</p>\n\n<pre><code>ret[i] = rInterface.(Resource)\n</code></pre>\n\n<p>and then my server blows up and panics. I looked through the Go documentation and as far as I can tell I should be able to type assert into Resource even though rInterface is an empty interface with Position model data because the Position type satisfies the Resource interface anyway. Am I correct in understanding this? Or is there something I'm missing?</p>\n"}, {"tags": ["go", "garbage-collection"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1476810583, "post_id": 40113915, "comment_id": 67499765, "body": "Since this is implementation and version specific, if you want a specific answer the go mailing list is probably a more appropriate forum (you should also test this with the current master branch if you haven&#39;t done so)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476820919, "post_id": 40113915, "comment_id": 67505594, "body": "Took a minute to look at this, and I&#39;m only seeing a rough correlation here, and only with small inputs. The bulk of time in <code>mkMessage</code> is spent waiting for an allocation during GC, not in mutating the slice. If I increase the number of pointers an order of magnitude, the time spent in the concurrent phase increases accordingly,  but there&#39;s no significant increase in the time taken to allocate or mutate the slices."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1476823529, "post_id": 40113915, "comment_id": 67507060, "body": "This has a huge map, and there are bugs where they cause pauses. The incremental &quot;mutator assist&quot;--where your code&#39;s interrupted to do a small chunk of work, meant to be just microseconds--sometimes wound up scanning the whole map. See <a href=\"https://groups.google.com/forum/#!topic/golang-codereviews/kIqdlqEZ47M\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/golang-codereviews/kIqdlqEZ4&zwnj;&#8203;7M</a>, <a href=\"https://github.com/golang/go/issues/16432\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/16432</a>, <a href=\"https://github.com/golang/go/issues/14812\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/14812</a>, and <a href=\"https://github.com/golang/go/issues/9477\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/9477</a>. Go tip might work better, or 1.7 if you&#39;re on an older version."}, {"owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476868614, "post_id": 40113915, "comment_id": 67524038, "body": "@JimB I will ask in the go mailing list too, thanks for the suggestion. I don&#39;t think this is inappropriate for SO because I think it&#39;s likely this problem is a characteristic of concurrent STW collectors in general.  When I increase the number of messages an order of magnitude, I <i>do</i> see the time to allocate increase: concurrent GC time = 915ms and time to allocate = 824ms.  However the anomalous &quot;background GC time&quot; doesn&#39;t seem to correlate over more runs, so I&#39;ll remove this from the question."}, {"owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1476868743, "post_id": 40113915, "comment_id": 67524133, "body": "@twotwotwo I did originally investigate that, but I&#39;m not sure it&#39;s the problem here because the large STW pause appears to happen when allocating with <code>mkMessage</code>, not inserting or deleting from the <code>map</code>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476887577, "post_id": 40113915, "comment_id": 67538646, "body": "@WillSewell: No, it&#39;s not really related to STW collectors in general, because Go isn&#39;t using a full STW collector. Like I said, I don&#39;t see this behavior on master, so it&#39;s likely to be an issue with the go1.7 implementation, <a href=\"https://golang.org/issue/16293\" rel=\"nofollow noreferrer\">golang.org/issue/16293</a> for example"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1476900379, "post_id": 40113915, "comment_id": 67546842, "body": "@WillSewell That&#39;s what I&#39;d expect if it were the problem described in those bugs. Mutator GC assists happen on allocation. The existence of the big map is the root cause, but the pause happens at allocation time. Practically speaking the next step (aside from asking the lists) is to try go tip (the latest devel version) to see if the related fixes solve it for you. If they don&#39;t, using several smaller maps might be a workaround to reduce max latency."}], "answers": [{"comments": [{"owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "edited": false, "score": 0, "creation_date": 1476867608, "post_id": 40114161, "comment_id": 67523346, "body": "Let me see if I understand what you are saying. The GC has a certain amount of memory available for new allocations, call this <code>s</code>. In my example, as more objects are created, <code>s</code> will decrease. When <code>s</code> reaches a certain value, a GC will start. If <code>s</code> becomes 0, requests to create new objects will block. The requests will only continue once the GC runs again, or more memory is requested from the OS. That makes sense to me, but let me know if I&#39;m not following."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "edited": false, "score": 0, "creation_date": 1476886244, "post_id": 40114161, "comment_id": 67537473, "body": "@WillSewell: That&#39;s pretty much it, except that the requests have to wait not just until the GC &quot;runs&quot;, but until it completes a cycle.  To find out whether any particular piece of memory can be freed, the system would have to scan through every live object, but a single scan through all live objects would allow the system to identify all of the pieces of memory that can be freed."}], "tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 1, "last_activity_date": 1476810328, "creation_date": 1476810328, "answer_id": 40114161, "question_id": 40113915, "link": "https://stackoverflow.com/questions/40113915/why-does-a-concurrent-go-gc-phase-appear-to-be-stop-the-world/40114161#40114161", "title": "Why does a &quot;concurrent&quot; Go GC phase appear to be stop-the-world?", "body": "<p>A concurrent GC pass will typically start at a time when a certain amount of space is available for new allocations.  If that amount of space is adequate to handle all allocations that occur before the pass is complete, the amount of time the application has to wait on the GC will be minimal.  If, however, the quantity of allocations exceeds the space available, new allocation requests will have to wait for the GC to free up more space.</p>\n\n<p>Note that most concurrent GC systems have definite cycles even though programs can run while they are in progress.  The bulk of a GC cycle is spent identifying all of the objects to which references exist, and the only way to identify that no references exist to any individual object is to identify all the references that exist to <em>everything else</em>.  Consequently, everything that will get freed by a GC cycle will get freed at once, and nothing will get freed in the interim.</p>\n"}, {"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": false, "score": 0, "last_activity_date": 1477895730, "last_edit_date": 1477895730, "creation_date": 1477785899, "answer_id": 40324878, "question_id": 40113915, "link": "https://stackoverflow.com/questions/40113915/why-does-a-concurrent-go-gc-phase-appear-to-be-stop-the-world/40324878#40324878", "title": "Why does a &quot;concurrent&quot; Go GC phase appear to be stop-the-world?", "body": "<p>To give this more visibility (and detail) than in my comment--the behavior seems to match what's described in <a href=\"https://github.com/golang/go/issues/9477\" rel=\"nofollow\">Go bug #9477</a> and fixed by <a href=\"https://go-review.googlesource.com/#/c/23540/\" rel=\"nofollow\">Go changelist 23540</a>.</p>\n\n<p>What happens is, when a thread allocates memory, the garbage collector might give it a little memory-scanning work to do; this is called a \"mutator assist.\" But previously, the work might consist of scanning a map, which would cause a long pause with a big enough map. Consistent with what's reported in the question and comments, the pause would happen when some arbitrary allocation took place--not necessarily while using the map--and would not show up in GC pause stats since it wasn't part of the stop-the-world phase.</p>\n\n<p>The fix made to Go, not yet released as I'm writing, was to limit how much memory a single mutator assist would scan so that it would take no more than about 100 microseconds on typical modern server hardware. If you're encountering this problem I'd recommend trying the latest from the github.com/golang/go repository (or 1.8 once it's out) where the fix is applied. (There's also <a href=\"https://groups.google.com/forum/#!msg/golang-dev/Ab1sFeoZg_8/_DaL0E8fAwAJ\" rel=\"nofollow\">another big pause-reduction change</a> in there since 1.7.) If you still have problems and haven't been able to find any explanation, I'd go to golang-nuts.</p>\n"}], "owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 804, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1477895730, "creation_date": 1476809544, "last_edit_date": 1476872422, "question_id": 40113915, "link": "https://stackoverflow.com/questions/40113915/why-does-a-concurrent-go-gc-phase-appear-to-be-stop-the-world", "title": "Why does a &quot;concurrent&quot; Go GC phase appear to be stop-the-world?", "body": "<p>I am attempting to benchmark the maximum STW GC pause time for different numbers of heap objects. To do this I have written a simple benchmark that pushes and pops messages from a <code>map</code>:</p>\n\n<pre><code>package main\n\ntype message []byte\n\ntype channel map[int]message\n\nconst (\n    windowSize = 200000\n    msgCount   = 1000000\n)\n\nfunc mkMessage(n int) message {\n    m := make(message, 1024)\n    for i := range m {\n        m[i] = byte(n)\n    }\n    return m\n}\n\nfunc pushMsg(c *channel, highID int) {\n    lowID := highID - windowSize\n    m := mkMessage(highID)\n    (*c)[highID] = m\n    if lowID &gt;= 0 {\n        delete(*c, lowID)\n    }\n}\n\nfunc main() {\n    c := make(channel)\n    for i := 0; i &lt; msgCount; i++ {\n        pushMsg(&amp;c, i)\n    }\n}\n</code></pre>\n\n<p>I ran this with <a href=\"https://golang.org/pkg/runtime/\" rel=\"nofollow\"><code>GODEBUG=gctrace=1</code></a>, and on my machine the output is:</p>\n\n<pre><code>gc 1 @0.004s 2%: 0.007+0.44+0.032 ms clock, 0.029+0.22/0.20/0.28+0.12 ms cpu, 4-&gt;4-&gt;3 MB, 5 MB goal, 4 P\ngc 2 @0.009s 3%: 0.007+0.64+0.042 ms clock, 0.030+0/0.53/0.18+0.17 ms cpu, 7-&gt;7-&gt;7 MB, 8 MB goal, 4 P\ngc 3 @0.019s 1%: 0.007+0.99+0.037 ms clock, 0.031+0/0.13/1.0+0.14 ms cpu, 13-&gt;13-&gt;13 MB, 14 MB goal, 4 P\ngc 4 @0.044s 2%: 0.009+2.3+0.032 ms clock, 0.039+0/2.3/0.30+0.13 ms cpu, 25-&gt;25-&gt;25 MB, 26 MB goal, 4 P\ngc 5 @0.081s 1%: 0.009+9.2+0.082 ms clock, 0.039+0/0.32/9.7+0.32 ms cpu, 49-&gt;49-&gt;48 MB, 50 MB goal, 4 P\ngc 6 @0.162s 0%: 0.020+10+0.078 ms clock, 0.082+0/0.28/11+0.31 ms cpu, 93-&gt;93-&gt;91 MB, 96 MB goal, 4 P\ngc 7 @0.289s 0%: 0.020+27+0.092 ms clock, 0.080+0/0.95/28+0.37 ms cpu, 178-&gt;178-&gt;173 MB, 182 MB goal, 4 P\ngc 8 @0.557s 1%: 0.023+38+0.086 ms clock, 0.092+0/38/10+0.34 ms cpu, 337-&gt;339-&gt;209 MB, 346 MB goal, 4 P\ngc 9 @0.844s 1%: 0.008+40+0.077 ms clock, 0.032+0/5.6/46+0.30 ms cpu, 407-&gt;409-&gt;211 MB, 418 MB goal, 4 P\ngc 10 @1.100s 1%: 0.009+43+0.047 ms clock, 0.036+0/6.6/50+0.19 ms cpu, 411-&gt;414-&gt;212 MB, 422 MB goal, 4 P\ngc 11 @1.378s 1%: 0.008+45+0.093 ms clock, 0.033+0/6.5/52+0.37 ms cpu, 414-&gt;417-&gt;213 MB, 425 MB goal, 4 P\n</code></pre>\n\n<p>See the link above for documentation on this output.</p>\n\n<p>My version of Go is:</p>\n\n<pre><code>$ go version\ngo version go1.7.1 darwin/amd64\n</code></pre>\n\n<p>From the above results, the longest wall clock STW pause time is <code>0.093 ms</code>. Great!</p>\n\n<p>However as a sanity check I also manually timed how long it took to create a new <code>message</code> by wrapping <code>mkMessage</code> with</p>\n\n<pre><code>start := time.Now()\nm := mkMessage(highID)\nelapsed := time.Since(start)\n</code></pre>\n\n<p>and printed the slowest <code>elapsed</code> time. The time I get for this was <code>38.573036ms</code>!</p>\n\n<p>I was instantly suspicious because this correlated strongly with the wall clock times in the supposedly concurrent mark/scan phase, and in particular with \"idle GC time\".</p>\n\n<p><strong>My question is: why does this supposedly concurrent phase of the GC appear to block the mutator?</strong></p>\n\n<p>If I force the GC to run at regular intervals, my manually calculated pause times go way down to &lt;1ms, so it appears to be hitting some kind of limit of non-live heap objects. If so, I'm not sure what that limit is, and why it would cause a concurrent phase of the GC to appear to block the mutator.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1476805204, "post_id": 40112250, "comment_id": 67496507, "body": "You&#39;re looking for the rules on <a href=\"https://golang.org/ref/spec#Selectors\" rel=\"nofollow noreferrer\">selectors</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1476821912, "post_id": 40112250, "comment_id": 67506172, "body": "And take a look at the language spec in general, especially the method set sections. And of course: Take the Tour of Go once more."}], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 2, "creation_date": 1476811715, "post_id": 40112770, "comment_id": 67500351, "body": "Not completely accurate.  Go still does a <i>bit</i> of conversion for interfaces.  The rule is that if you pass a pointer to a type into an interface, both pointer and value methods on that type can fulfill the interface.  If you pass the type itself in, only value methods on that type can fulfill the interface.  Example: <a href=\"https://play.golang.org/p/rUIeMBnXTY\" rel=\"nofollow noreferrer\">play.golang.org/p/rUIeMBnXTY</a>"}, {"owner": {"reputation": 165, "user_id": 5742303, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FtDe4q8R6Jw/AAAAAAAAAAI/AAAAAAAAAA4/-0OmJAJB7tI/photo.jpg?sz=128", "display_name": "rong jialei", "link": "https://stackoverflow.com/users/5742303/rong-jialei"}, "edited": false, "score": 0, "creation_date": 1476842120, "post_id": 40112770, "comment_id": 67512600, "body": "Thanks for your answer! It really help me figure this out."}], "tags": [], "owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "is_accepted": true, "score": 0, "last_activity_date": 1610285512, "last_edit_date": 1610285512, "creation_date": 1476805870, "answer_id": 40112770, "question_id": 40112250, "link": "https://stackoverflow.com/questions/40112250/pointer-and-struct-member-function/40112770#40112770", "title": "Pointer and Struct member function", "body": "<p>Usually, Go does things for you under the hood and this is typically one of those cases.</p>\n<p>When you define a function with a struct as receiver and you pass it a pointer to the struct, then Go does the conversion for you: it passes a copy of the struct pointed to.</p>\n<p>When you define a function with a pointer as a receiver and you pass it a struct, Go creates a pointer to this struct.</p>\n<p>However, when defining an interface, you're working on types: The <code>Locker</code> interface defines a type which implements the function <code>Test()</code>.</p>\n<p>And with interfaces, Go won't help you: if your type doesn't implement a method, then it does not implement the interface. No hidden conversion here.</p>\n<p>Usually, it's better to be clear about what you want and how you want it and thus preventing Go from doing those weird conversions.</p>\n"}], "owner": {"reputation": 165, "user_id": 5742303, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FtDe4q8R6Jw/AAAAAAAAAAI/AAAAAAAAAA4/-0OmJAJB7tI/photo.jpg?sz=128", "display_name": "rong jialei", "link": "https://stackoverflow.com/users/5742303/rong-jialei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3276, "favorite_count": 0, "accepted_answer_id": 40112770, "answer_count": 1, "score": 0, "last_activity_date": 1610285512, "creation_date": 1476804473, "last_edit_date": 1610285494, "question_id": 40112250, "link": "https://stackoverflow.com/questions/40112250/pointer-and-struct-member-function", "title": "Pointer and Struct member function", "body": "<h2>Invoke function</h2>\n\n<p>When I define a struct <code>Lock</code> and a function <code>Test</code> with the struct <code>Lock</code> as the function receiver</p>\n\n<pre><code>type Lock struct {\n}\n\nfunc (self Lock) Test() {\n    fmt.Println(\"Test Func\")\n}\n</code></pre>\n\n<p>I found that I can call this function with a <code>Lock</code> struct pointer </p>\n\n<pre><code>lock := &amp;Lock{}\nlock.Test()\n</code></pre>\n\n<p>The same, if I define a struct <code>Lock</code> and a function <code>Test</code> as the <code>Lock</code>'s pointer as the receiver, I can call this function through <code>Lock</code> struct instance.</p>\n\n<p>So whatever the receiver is the struct itself or the struct pointer, I can call this function through the both? What's the reason. As my comprehension, the struct and the struct pointer are totally two different type!</p>\n\n<h2>Interface</h2>\n\n<p>If a define a interface <code>Locker</code> like this</p>\n\n<pre><code>type Locker interface {\n    Test()\n}\n</code></pre>\n\n<p>And define a struct <code>Lock</code> and a function <code>Test</code> with the struct <strong>instance</strong> as the receiver, I can't assign a struct pointer variable to a <code>Locker</code> interface var.</p>\n\n<p>On the contrary, If a define a struct <code>Lock</code> and a function <code>Test</code> with the struct <strong>pointer</strong> as the receiver, assign a struct instance variable to a <code>Locker</code> interface var can work!</p>\n\n<p>I'm so confused about the language design. Can anybody give me some advice?</p>\n"}, {"tags": ["go", "grpc"], "comments": [{"owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "edited": false, "score": 0, "creation_date": 1476803515, "post_id": 40111484, "comment_id": 67495273, "body": "&quot;put&quot; function not implemented for balancer yet, you&#39;ll have to write your own implementation"}, {"owner": {"reputation": 2676, "user_id": 1230594, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/a42bz.png?s=128&g=1", "display_name": "Isaac", "link": "https://stackoverflow.com/users/1230594/isaac"}, "reply_to_user": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "edited": false, "score": 0, "creation_date": 1476805304, "post_id": 40111484, "comment_id": 67496584, "body": "@MarcelNovy, that&#39;s right. but nothing is passed to it. How can I access the status of a grpc call from within the balancer?"}, {"owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "edited": false, "score": 0, "creation_date": 1476806302, "post_id": 40111484, "comment_id": 67497242, "body": "To the best of my knowledge, load balancing is still &quot;work in progress&quot; and it&#39;s rather experimental than practical usage"}], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 7039249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15848c56c9f06656c6240268438c2547?s=128&d=identicon&r=PG&f=1", "display_name": "Qi Zhao", "link": "https://stackoverflow.com/users/7039249/qi-zhao"}, "is_accepted": true, "score": 0, "last_activity_date": 1476832862, "creation_date": 1476832862, "answer_id": 40119596, "question_id": 40111484, "link": "https://stackoverflow.com/questions/40111484/how-to-get-the-gprc-call-status-from-the-balancer/40119596#40119596", "title": "How to get the gPRC call status from the balancer", "body": "<p>Currently, you cannot access the status/stats in put. There is WIP on collecting stats. Once it is done, you can access them via the context which is the input of Get. ETA is the end of this year.</p>\n"}], "owner": {"reputation": 2676, "user_id": 1230594, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/a42bz.png?s=128&g=1", "display_name": "Isaac", "link": "https://stackoverflow.com/users/1230594/isaac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 40119596, "answer_count": 1, "score": 0, "last_activity_date": 1476832862, "creation_date": 1476802237, "last_edit_date": 1592644375, "question_id": 40111484, "link": "https://stackoverflow.com/questions/40111484/how-to-get-the-gprc-call-status-from-the-balancer", "title": "How to get the gPRC call status from the balancer", "body": "<p>The balancer interface <code>Get</code> method has a <code>put</code> function, as one of its returns, that's supposed to be called after the grpc call:</p>\n<blockquote>\n<p>// The function returns put which is called once the rpc has completed or failed.</p>\n<p>// put can collect and report RPC stats to a remote load balancer.</p>\n</blockquote>\n<p><a href=\"https://github.com/grpc/grpc-go/blob/master/balancer.go#L74\" rel=\"nofollow noreferrer\">https://github.com/grpc/grpc-go/blob/master/balancer.go#L74</a></p>\n<p>How do I get the status of the gRPC call (success/failure), and stats?</p>\n<p>The use of interceptors is an alternative, but would like to use this method if it is possible to get the status/stats.</p>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 143, "user_id": 6538432, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/703af6cc3cf9434336c6b8168d73d145?s=128&d=identicon&r=PG&f=1", "display_name": "Eduardo Castillo", "link": "https://stackoverflow.com/users/6538432/eduardo-castillo"}, "is_accepted": false, "score": 3, "last_activity_date": 1476800513, "creation_date": 1476800513, "answer_id": 40110807, "question_id": 40110670, "link": "https://stackoverflow.com/questions/40110670/how-to-connect-to-microsoft-sql-server-using-gorm-in-golang/40110807#40110807", "title": "How to connect to Microsoft SQL server using GORM in golang?", "body": "<p>I found my error, I was importing the wrong MSSQL driver, gorm already has one\nimport _ \"github.com/jinzhu/gorm/dialects/mssql\"</p>\n"}, {"tags": [], "owner": {"reputation": 389, "user_id": 9954152, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nYE4_Exp204/AAAAAAAAAAI/AAAAAAAAAKA/rlwGmT6fh1U/photo.jpg?sz=128", "display_name": "Abodesegun Ezekiel", "link": "https://stackoverflow.com/users/9954152/abodesegun-ezekiel"}, "is_accepted": false, "score": 0, "last_activity_date": 1534329213, "last_edit_date": 1534329213, "creation_date": 1534328747, "answer_id": 51857011, "question_id": 40110670, "link": "https://stackoverflow.com/questions/40110670/how-to-connect-to-microsoft-sql-server-using-gorm-in-golang/51857011#51857011", "title": "How to connect to Microsoft SQL server using GORM in golang?", "body": "<p>I am going to post this answer just to expatiate @Eduardo Carstillo answer above.\nI had this same issue and i got the error\n<code>mssql is not officially supported, running under compatibility mode.</code>\nThe error occur because the Gorm library does not support mssql by default however a it has been implemented in a the <code>gorm dialects</code>.</p>\n\n<p>To resolve this issue. just add an import statement for the gorm dialects. see the full mssql connection bellow.</p>\n\n<pre><code>import (\n  \"github.com/jinzhu/gorm\"\n  _ \"github.com/jinzhu/gorm/dialects/mssql\"\n)\n\nfunc main() {\n  db, err := gorm.Open(\"mssql\", \"sqlserver://username:password@localhost:1433? \n  database=dbname\")\n  defer db.Close()\n}\n</code></pre>\n\n<p>refer to the gorm doc for more detail. \n<a href=\"http://gorm.io/docs/connecting_to_the_database.html\" rel=\"nofollow noreferrer\">http://gorm.io/docs/connecting_to_the_database.html</a>`</p>\n"}], "owner": {"reputation": 143, "user_id": 6538432, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/703af6cc3cf9434336c6b8168d73d145?s=128&d=identicon&r=PG&f=1", "display_name": "Eduardo Castillo", "link": "https://stackoverflow.com/users/6538432/eduardo-castillo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3439, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1534329213, "creation_date": 1476800170, "question_id": 40110670, "link": "https://stackoverflow.com/questions/40110670/how-to-connect-to-microsoft-sql-server-using-gorm-in-golang", "title": "How to connect to Microsoft SQL server using GORM in golang?", "body": "<p>I'm trying to connect to a microsoft SQL server using GORM: <a href=\"https://github.com/jinzhu/gorm\" rel=\"nofollow\">https://github.com/jinzhu/gorm</a></p>\n\n<p>But I cannot seem to find any tables when I try using db.HasTable() and I checked the credentials which are fine. I did receive a message that GORM doesn't officially support MSSQL and it runs in compatibility mode but I also included an SQL driver: github.com/denisenkom/go-mssqldb\nthat's used for MSSQL. Is there something I'm missing?</p>\n"}, {"tags": ["go", "struct", "equality"], "answers": [{"comments": [{"owner": {"reputation": 295, "user_id": 1176154, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bGOB6.jpg?s=128&g=1", "display_name": "RAFJR", "link": "https://stackoverflow.com/users/1176154/rafjr"}, "edited": false, "score": 1, "creation_date": 1476882137, "post_id": 40107993, "comment_id": 67534253, "body": "This does the trick. Clean and simple. Thanks for providing the actual code, the GOLANG Playground link and reference."}], "tags": [], "owner": {"reputation": 4366, "user_id": 176478, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a10b460f85d3d8b9702782bf6dd72307?s=128&d=identicon&r=PG", "display_name": "dmportella", "link": "https://stackoverflow.com/users/176478/dmportella"}, "is_accepted": true, "score": 4, "last_activity_date": 1476792866, "last_edit_date": 1495542183, "creation_date": 1476792866, "answer_id": 40107993, "question_id": 40107283, "link": "https://stackoverflow.com/questions/40107283/check-if-struct-is-empty-if-struct-contains-json-rawmessage/40107993#40107993", "title": "Check if struct is empty if struct contains json.RawMessage", "body": "<p>The reason is that <code>json.RawMessage</code> is a Alias for a <code>[]byte</code> and maps, slices etc can not be compared normally. </p>\n\n<p>You can compare slices with <code>reflect.DeepEqual</code> method.</p>\n\n<p>See example below.</p>\n\n<pre><code>package main\n\nimport \"encoding/json\"\nimport \"reflect\"\n\ntype myStruct struct \n{\n        a string `json:\"a\"`\n        b json.RawMessage `json:\"b\"`\n        c json.RawMessage `json:\"c\"`\n}   \n\nfunc (m myStruct ) IsEmpty() bool {\n    return reflect.DeepEqual(myStruct{}, m)\n}\n\n\nfunc main() {\n    var mystuff myStruct = myStruct{}\n\n    mystuff.IsEmpty()\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/gi2gEccdow\" rel=\"nofollow noreferrer\">GOLANG Playground</a></p>\n\n<p>Reference for comparing slices: <a href=\"https://stackoverflow.com/questions/24534072/how-to-compare-struct-slice-map-are-equal\">How to compare struct, slice, map are equal?</a></p>\n\n<p>See the <code>RawMessage</code> type.\njson.RawMessage type: <a href=\"https://golang.org/src/encoding/json/stream.go?s=6218:6240#L237\" rel=\"nofollow noreferrer\">https://golang.org/src/encoding/json/stream.go?s=6218:6240#L237</a></p>\n"}, {"comments": [{"owner": {"reputation": 295, "user_id": 1176154, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bGOB6.jpg?s=128&g=1", "display_name": "RAFJR", "link": "https://stackoverflow.com/users/1176154/rafjr"}, "edited": false, "score": 1, "creation_date": 1476856126, "post_id": 40118789, "comment_id": 67516537, "body": "this does the job but I prefer not specifying every single field/property of my struct. There has to be a better way since my struct actually have twenty fields/properties."}], "tags": [], "owner": {"reputation": 2284, "user_id": 2125099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bf0fb68f7d521aa94e45c76cb18a4b3?s=128&d=identicon&r=PG", "display_name": "fl0cke", "link": "https://stackoverflow.com/users/2125099/fl0cke"}, "is_accepted": false, "score": 1, "last_activity_date": 1476827901, "creation_date": 1476827901, "answer_id": 40118789, "question_id": 40107283, "link": "https://stackoverflow.com/questions/40107283/check-if-struct-is-empty-if-struct-contains-json-rawmessage/40118789#40118789", "title": "Check if struct is empty if struct contains json.RawMessage", "body": "<p>The zero value of <code>myStruct</code> is a struct where <code>a</code>, <code>b</code> and <code>c</code> are zero values of their type. The zero value of a string is <code>\"\"</code>, of <code>json.RawMessage</code> it is <code>nil</code> (because it's just an alias for <code>[]byte</code>). Combining this knowledge you get:</p>\n\n<pre><code>type myStruct struct {\n    a string\n    b json.RawMessage\n    c json.RawMessage\n}\n\nfunc (m *myStruct ) IsEmpty() bool {\n    return m.a == \"\" &amp;&amp; m.b == nil &amp;&amp; m.c == nil\n}\n</code></pre>\n\n<p>There is no need for <code>reflect.DeepEqual()</code></p>\n"}], "owner": {"reputation": 295, "user_id": 1176154, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bGOB6.jpg?s=128&g=1", "display_name": "RAFJR", "link": "https://stackoverflow.com/users/1176154/rafjr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6331, "favorite_count": 0, "accepted_answer_id": 40107993, "answer_count": 2, "score": 2, "last_activity_date": 1497955073, "creation_date": 1476790846, "last_edit_date": 1497955073, "question_id": 40107283, "link": "https://stackoverflow.com/questions/40107283/check-if-struct-is-empty-if-struct-contains-json-rawmessage", "title": "Check if struct is empty if struct contains json.RawMessage", "body": "<p>I'm trying to create a method extension to check if my struct was initialized but I'm getting this error: </p>\n\n<blockquote>\n  <p>invalid operation: myStruct literal == inStruct (struct containing json.RawMessage cannot be compared)</p>\n</blockquote>\n\n<p>Here's my code:</p>\n\n<pre><code>package datamodels\n\nimport \"encoding/json\"\n\ntype myStruct struct {\n        a string json:\"a\"\n        b json.RawMessage json:\"b\"\n        c json.RawMessage json:\"c\"\n    }\n\nfunc (m *myStruct ) IsEmpty() bool {\n    return (myStruct {}) == m \n}\n</code></pre>\n"}, {"tags": ["mongodb", "go", "mgo", "revel"], "comments": [{"owner": {"reputation": 286, "user_id": 5899150, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4380bc3fef16ee11788a3efea8e1cf0?s=128&d=identicon&r=PG&f=1", "display_name": "Majonsi", "link": "https://stackoverflow.com/users/5899150/majonsi"}, "edited": false, "score": 1, "creation_date": 1476786482, "post_id": 40105658, "comment_id": 67482965, "body": "Do you have all your import properly made? For example do you have &quot;log&quot; in your imports ?"}, {"owner": {"reputation": 915, "user_id": 1249118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c52f4892cd0eb9ca9e1c3c939df2e44?s=128&d=identicon&r=PG", "display_name": "Oscar Yuandinata", "link": "https://stackoverflow.com/users/1249118/oscar-yuandinata"}, "reply_to_user": {"reputation": 286, "user_id": 5899150, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4380bc3fef16ee11788a3efea8e1cf0?s=128&d=identicon&r=PG&f=1", "display_name": "Majonsi", "link": "https://stackoverflow.com/users/5899150/majonsi"}, "edited": false, "score": 0, "creation_date": 1476788232, "post_id": 40105658, "comment_id": 67484038, "body": "I&#39;m new to Go development. In which file do you mean? In controllers, models?"}, {"owner": {"reputation": 286, "user_id": 5899150, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4380bc3fef16ee11788a3efea8e1cf0?s=128&d=identicon&r=PG&f=1", "display_name": "Majonsi", "link": "https://stackoverflow.com/users/5899150/majonsi"}, "edited": false, "score": 0, "creation_date": 1476791939, "post_id": 40105658, "comment_id": 67486505, "body": "As I see your errors I think you should add in your file &quot;init.go&quot; this code <code>import ( &quot;log&quot; &quot;github.com&#47;revel&#47;revel&quot; \u201cmyapp&#47;app&#47;models&#47;mongodb\u201d ) </code> This just under the first line of your init.go whitch contain &quot;package&quot;"}, {"owner": {"reputation": 915, "user_id": 1249118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c52f4892cd0eb9ca9e1c3c939df2e44?s=128&d=identicon&r=PG", "display_name": "Oscar Yuandinata", "link": "https://stackoverflow.com/users/1249118/oscar-yuandinata"}, "reply_to_user": {"reputation": 286, "user_id": 5899150, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4380bc3fef16ee11788a3efea8e1cf0?s=128&d=identicon&r=PG&f=1", "display_name": "Majonsi", "link": "https://stackoverflow.com/users/5899150/majonsi"}, "edited": false, "score": 0, "creation_date": 1476849031, "post_id": 40105658, "comment_id": 67514152, "body": "I add your code. This time, all the errors disappear except <code>api-go&#47;app&#47;init.go:45: undefined: revel.LoadConfig</code>"}], "answers": [{"comments": [{"owner": {"reputation": 915, "user_id": 1249118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c52f4892cd0eb9ca9e1c3c939df2e44?s=128&d=identicon&r=PG", "display_name": "Oscar Yuandinata", "link": "https://stackoverflow.com/users/1249118/oscar-yuandinata"}, "edited": false, "score": 0, "creation_date": 1476866599, "post_id": 40125362, "comment_id": 67522715, "body": "now the error changes to <code>cannot refer to unexported name revel.config</code>"}, {"owner": {"reputation": 286, "user_id": 5899150, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4380bc3fef16ee11788a3efea8e1cf0?s=128&d=identicon&r=PG&f=1", "display_name": "Majonsi", "link": "https://stackoverflow.com/users/5899150/majonsi"}, "reply_to_user": {"reputation": 915, "user_id": 1249118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c52f4892cd0eb9ca9e1c3c939df2e44?s=128&d=identicon&r=PG", "display_name": "Oscar Yuandinata", "link": "https://stackoverflow.com/users/1249118/oscar-yuandinata"}, "edited": false, "score": 0, "creation_date": 1476887450, "post_id": 40125362, "comment_id": 67538531, "body": "and <code>revel.LoadConfig(&quot;app.conf&quot;)</code>  said what ?"}, {"owner": {"reputation": 286, "user_id": 5899150, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4380bc3fef16ee11788a3efea8e1cf0?s=128&d=identicon&r=PG&f=1", "display_name": "Majonsi", "link": "https://stackoverflow.com/users/5899150/majonsi"}, "reply_to_user": {"reputation": 915, "user_id": 1249118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c52f4892cd0eb9ca9e1c3c939df2e44?s=128&d=identicon&r=PG", "display_name": "Oscar Yuandinata", "link": "https://stackoverflow.com/users/1249118/oscar-yuandinata"}, "edited": false, "score": 0, "creation_date": 1476890978, "post_id": 40125362, "comment_id": 67541206, "body": "or try    <code>revel.Config.LoadContext(&quot;app.conf&quot;,ConfPaths)</code> The change is that &quot;Config&quot; begin with an uppercase, which mean you can access it from another packages when you import it"}], "tags": [], "owner": {"reputation": 286, "user_id": 5899150, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4380bc3fef16ee11788a3efea8e1cf0?s=128&d=identicon&r=PG&f=1", "display_name": "Majonsi", "link": "https://stackoverflow.com/users/5899150/majonsi"}, "is_accepted": false, "score": 0, "last_activity_date": 1476863749, "creation_date": 1476863749, "answer_id": 40125362, "question_id": 40105658, "link": "https://stackoverflow.com/questions/40105658/undefined-revel-loadconfig-on-revel-app-start/40125362#40125362", "title": "undefined: revel.LoadConfig on revel app start", "body": "<p>As I see your errors I think you should add in your file \"init.go\" this code </p>\n\n<pre><code>     import ( \n        \"log\"\n        \"github.com/revel/revel\" \n        \u201cmyapp/app/models/mongodb\u201d\n      ) \n</code></pre>\n\n<p>This just under the first line of your init.go whitch contain \"package\"</p>\n\n<p>Next in your code you have to replace:</p>\n\n<pre><code>   revel.LoadConfig(\"app.conf\")\n</code></pre>\n\n<p>by</p>\n\n<pre><code>   revel.config.LoadContext(\"app.conf\",ConfPaths)\n</code></pre>\n\n<p>where confPaths is the string path to your conf file. In your case it can be:</p>\n\n<pre><code>    ConfPaths := \"conf/\"\n</code></pre>\n\n<p>or </p>\n\n<pre><code>    ConfPaths := \"\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 135, "user_id": 1610538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Lk9n8.jpg?s=128&g=1", "display_name": "Eugene Kryukov", "link": "https://stackoverflow.com/users/1610538/eugene-kryukov"}, "is_accepted": false, "score": 1, "last_activity_date": 1486326795, "creation_date": 1486326795, "answer_id": 42056984, "question_id": 40105658, "link": "https://stackoverflow.com/questions/40105658/undefined-revel-loadconfig-on-revel-app-start/42056984#42056984", "title": "undefined: revel.LoadConfig on revel app start", "body": "<p>Comment this lines:</p>\n\n<pre><code>//Config, err := revel.LoadConfig(\"app.conf\")\n//if err != nil || Config == nil {\n//        log.Fatalf(\"%+v\",err)\n//}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 8078566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4fa68a977777e3e3394476b896a3f0e?s=128&d=identicon&r=PG&f=1", "display_name": "user8078566", "link": "https://stackoverflow.com/users/8078566/user8078566"}, "is_accepted": false, "score": 0, "last_activity_date": 1536530836, "creation_date": 1536530836, "answer_id": 52248995, "question_id": 40105658, "link": "https://stackoverflow.com/questions/40105658/undefined-revel-loadconfig-on-revel-app-start/52248995#52248995", "title": "undefined: revel.LoadConfig on revel app start", "body": "<p>That works for me. Imports:</p>\n\n<pre><code>import (\n    \"github.com/melkor217/myapp/app/models/mongodb\"\n    \"github.com/revel/config\"\n    \"github.com/revel/revel\"\n    \"log\"\n)\n</code></pre>\n\n<p>Load config:</p>\n\n<pre><code>Config, err := config.LoadContext(\"app.conf\", revel.ConfPaths)\n</code></pre>\n"}], "owner": {"reputation": 915, "user_id": 1249118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c52f4892cd0eb9ca9e1c3c939df2e44?s=128&d=identicon&r=PG", "display_name": "Oscar Yuandinata", "link": "https://stackoverflow.com/users/1249118/oscar-yuandinata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 522, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1536530836, "creation_date": 1476786137, "question_id": 40105658, "link": "https://stackoverflow.com/questions/40105658/undefined-revel-loadconfig-on-revel-app-start", "title": "undefined: revel.LoadConfig on revel app start", "body": "<p>I was following <a href=\"https://medium.com/@kyawmyintthein/revel-mgo-restful-generator-for-revel-web-framework-mongodb-86209de3977e#.jwddppv6h\" rel=\"nofollow\" title=\"go+revel+mongodb\">this tutorial</a> on using Go + Revel + MongoDB. But as I starting the application, I got this error:</p>\n\n<pre><code>The Go code api-go/app/init.go does not compile: undefined: revel.LoadConfig\n</code></pre>\n\n<p>along with other errors as I look in the terminal.<br/> </p>\n\n<pre><code>ERROR 2016/10/18 17:15:06 build.go:108: # api-go/app\napi-go/app/init.go:41: undefined: revel.LoadConfig\napi-go/app/init.go:43: undefined: log in log.Fatalf\napi-go/app/init.go:45: undefined: mongodb in mongodb.MaxPool\napi-go/app/init.go:45: cannot assign to mongodb.MaxPool\napi-go/app/init.go:46: undefined: mongodb in mongodb.PATH\napi-go/app/init.go:46: cannot assign to mongodb.PATH\napi-go/app/init.go:47: undefined: mongodb in mongodb.DBNAME\napi-go/app/init.go:47: cannot assign to mongodb.DBNAME\napi-go/app/init.go:48: undefined: mongodb in mongodb.CheckAndInitServiceConnection\n</code></pre>\n\n<p>I used Mac Sierra. What's wrong with my application?</p>\n\n<p><a href=\"https://i.stack.imgur.com/wrLlO.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/wrLlO.png\" alt=\"error on browser\"></a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1146, "user_id": 1248449, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9d8cdc612a969f3cc7bb32757dce1d4f?s=128&d=identicon&r=PG", "display_name": "Diti", "link": "https://stackoverflow.com/users/1248449/diti"}, "edited": false, "score": 1, "creation_date": 1476784117, "post_id": 40104727, "comment_id": 67481370, "body": "I am afraid you will need to change your write methods; I believe the performance issue is because of the syscalls (see <i><a href=\"http://stackoverflow.com/a/34629965/1248449\">Write Operation Cost</a></i>)."}, {"owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 1, "creation_date": 1476785580, "post_id": 40104727, "comment_id": 67482402, "body": "You could try: <a href=\"https://play.golang.org/p/Xnkanapx1-\" rel=\"nofollow noreferrer\">play.golang.org/p/Xnkanapx1-</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1476787902, "post_id": 40104727, "comment_id": 67483840, "body": "You need to replace <code>fmt.Println</code>. That way you can buffer the writes and replace all the reflection calls. Writing to a terminal can also be very slow if stdout is connected to a tty."}, {"owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "edited": false, "score": 0, "creation_date": 1476794409, "post_id": 40104727, "comment_id": 67488241, "body": "How about storing lines in slice or whatever and then fmt.Println it out in one shot instead of invoking for every line."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1476827788, "post_id": 40104727, "comment_id": 67508967, "body": "The buffer implementation in Go is in the pkg &quot;bufio&quot;, so my answer is the same of Martin Gallagher  <a href=\"https://play.golang.org/p/Xnkanapx1-\" rel=\"nofollow noreferrer\">play.golang.org/p/Xnkanapx1-</a>"}], "answers": [{"tags": [], "owner": {"reputation": 539, "user_id": 2352611, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/0fY8c.jpg?s=128&g=1", "display_name": "Larytet", "link": "https://stackoverflow.com/users/2352611/larytet"}, "is_accepted": false, "score": 0, "last_activity_date": 1542603382, "creation_date": 1542603382, "answer_id": 53368541, "question_id": 40104727, "link": "https://stackoverflow.com/questions/40104727/improve-the-speed-of-fmt-println/53368541#53368541", "title": "Improve the speed of fmt.Println", "body": "<p>The idea is to \"compile\" the format strings which supposedly never change. For example, see  <a href=\"https://github.com/larytet/binlog\" rel=\"nofollow noreferrer\">https://github.com/larytet/binlog</a> </p>\n"}], "owner": {"reputation": 2570, "user_id": 4685247, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/73c981959972f610c97df93e561ec907?s=128&d=identicon&r=PG", "display_name": "tofiffe", "link": "https://stackoverflow.com/users/4685247/tofiffe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 900, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1542603382, "creation_date": 1476783539, "question_id": 40104727, "link": "https://stackoverflow.com/questions/40104727/improve-the-speed-of-fmt-println", "title": "Improve the speed of fmt.Println", "body": "<p>I have a prgram that on certain occasions needs to print 8^20 lines, which takes upward of 30 seconds, I was wondering if it was possible to somehow \"buffer\" the output to os.Stdout and flush the output at the end of the algorithm. I've tried using os.Pipe as os.Stdout, but that did not increase the speed of the prints. </p>\n\n<p>Is there a way to accomplish that without replacing fmt.Println()?</p>\n"}, {"tags": ["ruby", "go", "rubygems", "key-value", "boltdb"], "answers": [{"comments": [{"owner": {"reputation": 1799, "user_id": 1786393, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/656a424090d82cf108c754be9e07d5b0?s=128&d=identicon&r=PG", "display_name": "Giorgio Robino", "link": "https://stackoverflow.com/users/1786393/giorgio-robino"}, "edited": false, "score": 0, "creation_date": 1476873159, "post_id": 40118881, "comment_id": 67527371, "body": "thx Yandry, but I see performances decay, putting boltdb behind an http server (maybe a socket/cpserver...) but I still think possible to wrap blotdb (or any other Go &quot;library&quot;) with a Ruby gem using FFI ... isn&#39;it?"}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "reply_to_user": {"reputation": 1799, "user_id": 1786393, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/656a424090d82cf108c754be9e07d5b0?s=128&d=identicon&r=PG", "display_name": "Giorgio Robino", "link": "https://stackoverflow.com/users/1786393/giorgio-robino"}, "edited": false, "score": 1, "creation_date": 1476901108, "post_id": 40118881, "comment_id": 67547257, "body": "Well, you may rewrite the whole algorithm (Btree) with Ruby and use the same format for the file, but it should be like duplicate the library. Also I guess in theory we can use Cgo and export the library through a .so or .a shared library and use it  with Ruby or C. In fact if you use boltdb in your server you&#39;ll lose the stateless condition, that&#39;s why I&#39;ve been thinking in a good network layer."}], "tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": false, "score": 0, "last_activity_date": 1476828315, "creation_date": 1476828315, "answer_id": 40118881, "question_id": 40104463, "link": "https://stackoverflow.com/questions/40104463/does-exist-any-boltdb-ruby-gem-binding/40118881#40118881", "title": "Does exist any BoltDB Ruby gem binding?", "body": "<p>It shouldn't be a driver for any language rather than Go because as you say it's embedded e.i. it works like a Go library that just do data manipulation over a file.</p>\n\n<p>What I know for sure there's HTTP or other network protocols wrappers on top of BoltDB, for example: <a href=\"https://github.com/skyec/boltdb-server\" rel=\"nofollow\">https://github.com/skyec/boltdb-server</a> and even with Raft: <a href=\"https://github.com/hashicorp/raft-boltdb\" rel=\"nofollow\">https://github.com/hashicorp/raft-boltdb</a>. As you may see it's pretty easy create your own network layer, I've been thinking in do my own.</p>\n\n<p><em>Maybe this's not your answer, but it's too big for a comment</em> :)</p>\n"}], "owner": {"reputation": 1799, "user_id": 1786393, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/656a424090d82cf108c754be9e07d5b0?s=128&d=identicon&r=PG", "display_name": "Giorgio Robino", "link": "https://stackoverflow.com/users/1786393/giorgio-robino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 217, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476828315, "creation_date": 1476782898, "question_id": 40104463, "link": "https://stackoverflow.com/questions/40104463/does-exist-any-boltdb-ruby-gem-binding", "title": "Does exist any BoltDB Ruby gem binding?", "body": "<p>Bolt is an amazing embedded key/value database for Go:</p>\n\n<ul>\n<li><a href=\"https://www.progville.com/go/bolt-embedded-db-golang/\" rel=\"nofollow\">https://www.progville.com/go/bolt-embedded-db-golang/</a></li>\n<li><a href=\"https://github.com/boltdb/bolt\" rel=\"nofollow\">https://github.com/boltdb/bolt</a></li>\n</ul>\n\n<p>There is any binding (gem) for Ruby language ?</p>\n"}, {"tags": ["go", "docker"], "answers": [{"comments": [{"owner": {"reputation": 4515, "user_id": 1710704, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a3b646c4f3b358bc74cfe636ca9655f7?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Shire", "link": "https://stackoverflow.com/users/1710704/logan-shire"}, "edited": false, "score": 0, "creation_date": 1476850290, "post_id": 40103829, "comment_id": 67514467, "body": "Awesome! Thanks"}, {"owner": {"reputation": 8871, "user_id": 2295964, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c00fadf5a477a8f770e91fdd7b356e76?s=128&d=identicon&r=PG", "display_name": "Yan Foto", "link": "https://stackoverflow.com/users/2295964/yan-foto"}, "reply_to_user": {"reputation": 4515, "user_id": 1710704, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a3b646c4f3b358bc74cfe636ca9655f7?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Shire", "link": "https://stackoverflow.com/users/1710704/logan-shire"}, "edited": false, "score": 0, "creation_date": 1476863330, "post_id": 40103829, "comment_id": 67520542, "body": "@LoganShire glad I could help :)"}, {"owner": {"reputation": 4515, "user_id": 1710704, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a3b646c4f3b358bc74cfe636ca9655f7?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Shire", "link": "https://stackoverflow.com/users/1710704/logan-shire"}, "edited": false, "score": 0, "creation_date": 1476864942, "post_id": 40103829, "comment_id": 67521566, "body": "I&#39;m trying to figure out how you set the nginx upstream server to goapp without setting a port of the goapp. Could you post an example api.conf? (Or, preferably, nginx.conf)"}, {"owner": {"reputation": 8871, "user_id": 2295964, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c00fadf5a477a8f770e91fdd7b356e76?s=128&d=identicon&r=PG", "display_name": "Yan Foto", "link": "https://stackoverflow.com/users/2295964/yan-foto"}, "reply_to_user": {"reputation": 4515, "user_id": 1710704, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a3b646c4f3b358bc74cfe636ca9655f7?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Shire", "link": "https://stackoverflow.com/users/1710704/logan-shire"}, "edited": false, "score": 0, "creation_date": 1476870042, "post_id": 40103829, "comment_id": 67525100, "body": "@LoganShire sorry I am not really good when it comes to nginx. I would&#39;ve have posted something if I had any working example!"}], "tags": [], "owner": {"reputation": 8871, "user_id": 2295964, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c00fadf5a477a8f770e91fdd7b356e76?s=128&d=identicon&r=PG", "display_name": "Yan Foto", "link": "https://stackoverflow.com/users/2295964/yan-foto"}, "is_accepted": true, "score": 2, "last_activity_date": 1476781107, "creation_date": 1476781107, "answer_id": 40103829, "question_id": 40102521, "link": "https://stackoverflow.com/questions/40102521/communication-between-linked-docker-containers-over-http-for-api-gateway/40103829#40103829", "title": "Communication between linked docker containers over http for api gateway", "body": "<p>Simplest way to do this is <a href=\"https://docs.docker.com/compose/\" rel=\"nofollow\">Docker Compose</a>. You can simply define which services you want and Docker Compose automatically link them in a dedicated network. Suppose you have your <code>goapp</code>, <code>redis</code>, and <code>mysql</code> instance and want to use <code>nginx</code> as your reverse proxy. Your <code>docker-compose.yml</code> file looks as follows:</p>\n\n<pre class=\"lang-yml prettyprint-override\"><code>services:\n  redis:\n    image: redis\n  mysql:\n    image: mysql\n  goapp:\n    image: myrepo/goapp\n  nginx:\n    image: nginx\n    volumes:\n      - /PATH/TO/MY/CONF/api.conf:/etc/nginx/conf.d/api.conf\n    ports:\n      - \"443:443\"\n      - \"80:80\"\n</code></pre>\n\n<p>The advantage is that you can reference any service from other services by its name. So from your <code>goapp</code> you can reach your MySQL server under hostname <code>mysql</code> and so on. The only exposed ports (i.e. reachable from the host machine) are <code>443</code> and <code>80</code> of <code>nginx</code> container.</p>\n\n<p>You can start the whole system with <code>docker-compose up</code>!</p>\n"}], "owner": {"reputation": 4515, "user_id": 1710704, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a3b646c4f3b358bc74cfe636ca9655f7?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Shire", "link": "https://stackoverflow.com/users/1710704/logan-shire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 512, "favorite_count": 0, "accepted_answer_id": 40103829, "answer_count": 1, "score": 0, "last_activity_date": 1476781107, "creation_date": 1476777016, "question_id": 40102521, "link": "https://stackoverflow.com/questions/40102521/communication-between-linked-docker-containers-over-http-for-api-gateway", "title": "Communication between linked docker containers over http for api gateway", "body": "<p>I'm currently working on a golang web app which is currently one application consisting of numerous packages and is deployed in an individual docker container. I have a redis instance and a mysql instance deployed and linked as separate containers. In order to get their addresses, I pull them from the environment variables set by docker. I would like to implement an api gateway pattern wherein I have one service which exposes the HTTP port (either 80 for http or 443 for https) called 'api' which proxies requests to other services. The other services ideally do not expose any ports publicly but rather are linked directly with the services they depend on. </p>\n\n<p>So, api will be linked with all the services except for mysql and redis. Any service that need to validate a user's session information will be linked with the user service, etc. My question is, how can I make my http servers listen to http requests on the ports that docker links between my containers.</p>\n"}, {"tags": ["go", "variadic-functions"], "answers": [{"tags": [], "owner": {"reputation": 5455, "user_id": 555493, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/7f71360d1b97bf28012fffa173ec0eb0?s=128&d=identicon&r=PG", "display_name": "U Avalos", "link": "https://stackoverflow.com/users/555493/u-avalos"}, "is_accepted": false, "score": 2, "last_activity_date": 1476774427, "creation_date": 1476774427, "answer_id": 40101709, "question_id": 40101486, "link": "https://stackoverflow.com/questions/40101486/store-and-pass-variadic-arguments-in-golang/40101709#40101709", "title": "Store and pass variadic arguments in golang?", "body": "<p>You have to apply the spread operator on the add function as well. \nThe error code seems a bit strange but the correct code should look like this:</p>\n\n<pre><code>var args = make([]interface{}, 0, 5)\n\nfunc add(params ...interface{}) {\n   args = append(args, params...)\n}\n\nSelect(&amp;dest, query, args...)\n</code></pre>\n"}], "owner": {"reputation": 5455, "user_id": 555493, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/7f71360d1b97bf28012fffa173ec0eb0?s=128&d=identicon&r=PG", "display_name": "U Avalos", "link": "https://stackoverflow.com/users/555493/u-avalos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1341, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1476774427, "creation_date": 1476773662, "last_edit_date": 1476774311, "question_id": 40101486, "link": "https://stackoverflow.com/questions/40101486/store-and-pass-variadic-arguments-in-golang", "title": "Store and pass variadic arguments in golang?", "body": "<p>Here's the use case: I'm trying to dynamically build variadic arguments (which means I need to store them), then I need to pass them to a variadic function. The function has the signature below. And the failing code is below. What is the proper way to do this?</p>\n\n<pre><code>// variadic function\nfunc Select(dest interface{}, query string, args ...interface{}) error\n\n//failing code\nvar args = make([]interface{}, 0, 5)\n\nfunc add(params ...interface{}) {\n   args = append(args, params)\n}\n\nSelect(&amp;dest, query, args...)\n\n//error is sql: converting Exec argument #0's type: unsupported type []interface {}, a slice\n</code></pre>\n"}, {"tags": ["go", "go-templates", "caddy"], "answers": [{"tags": [], "owner": {"reputation": 12511, "user_id": 138541, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/08a32b9ae44851b8984b17620d01b8d7?s=128&d=identicon&r=PG", "display_name": "Mint", "link": "https://stackoverflow.com/users/138541/mint"}, "is_accepted": false, "score": 2, "last_activity_date": 1476756030, "creation_date": 1476756030, "answer_id": 40098363, "question_id": 40098138, "link": "https://stackoverflow.com/questions/40098138/get-host-inside-a-range-loop-caddy-server-browse-template/40098363#40098363", "title": "Get {{.Host}} inside a range loop - Caddy server browse template", "body": "<p>ooooh, nevermind guys, I knew it was a simple fix.</p>\n\n<pre><code> {{$.Host}}\n</code></pre>\n\n<p>Just add the <code>$</code>, then you'll be using the global context again, instead of the context inside of the range loop.</p>\n\n<p><a href=\"https://gohugo.io/templates/go-templates/\" rel=\"nofollow\">Source</a>, thanks HUGO for the clear documentation.</p>\n"}, {"tags": [], "owner": {"reputation": 136, "user_id": 2632893, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PHgQM.png?s=128&g=1", "display_name": "Johnson", "link": "https://stackoverflow.com/users/2632893/johnson"}, "is_accepted": true, "score": 1, "last_activity_date": 1476759724, "creation_date": 1476759724, "answer_id": 40098828, "question_id": 40098138, "link": "https://stackoverflow.com/questions/40098138/get-host-inside-a-range-loop-caddy-server-browse-template/40098828#40098828", "title": "Get {{.Host}} inside a range loop - Caddy server browse template", "body": "<p>{{range}} changes the pipeline (the dot, .) to the current Items. You can use {{$.Host}} which will refer to the \"top-level\" Host. </p>\n\n<pre><code>{{$.Host}}\n</code></pre>\n\n<p>golang <a href=\"https://golang.org/pkg/text/template/\" rel=\"nofollow\">template</a>.</p>\n"}], "owner": {"reputation": 12511, "user_id": 138541, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/08a32b9ae44851b8984b17620d01b8d7?s=128&d=identicon&r=PG", "display_name": "Mint", "link": "https://stackoverflow.com/users/138541/mint"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 40098828, "answer_count": 2, "score": 1, "last_activity_date": 1476759724, "creation_date": 1476754232, "question_id": 40098138, "link": "https://stackoverflow.com/questions/40098138/get-host-inside-a-range-loop-caddy-server-browse-template", "title": "Get {{.Host}} inside a range loop - Caddy server browse template", "body": "<p>So I can use <code>{{.Host}}</code> just fine in the template file, but once inside a <code>{{range .Items}}</code> loop it doesn't work since it's trying to get the <code>.Host</code> from the <code>.Items</code> (array?)thing..</p>\n\n<p>I get this as an error</p>\n\n<pre><code>template: listing:41:46: executing \"listing\" at &lt;.Host&gt;: can't evaluate field Host in type browse.FileInfo\n</code></pre>\n\n<p>I've never used Go before, I've tried reading the <a href=\"https://golang.org/pkg/text/template/\" rel=\"nofollow\">text template documentation</a> page but it's all rather confusing.</p>\n"}, {"tags": ["oop", "object", "go", "struct", "notation"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1476749362, "post_id": 40097220, "comment_id": 67467655, "body": "Here are some examples how to access fields of struct values based on their names using <code>reflect</code>: <a href=\"http://stackoverflow.com/a/30889373/1705598\">one</a>; <a href=\"http://stackoverflow.com/a/39968350/1705598\">two</a>; <a href=\"http://stackoverflow.com/questions/30913483/golang-sort-struct-fields-in-alphabetical-order/30915092#30915092\">three</a>; <a href=\"http://stackoverflow.com/a/33142636/1705598\">four</a>."}, {"owner": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1476777278, "post_id": 40097220, "comment_id": 67476966, "body": "what are the reasons for people to give minus points without a note? How silly question right ? the ones who voted minus are familiar with any kinda technology i guess"}, {"owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "edited": false, "score": 1, "creation_date": 1476778159, "post_id": 40097220, "comment_id": 67477561, "body": "@nikoss I think it is because this reads very much like a &quot;how can I write JavaScript in Go&quot; question. You can&#39;t, they have different capabilities. All in all, I think a <code>map[string]map[string]string</code> is the right solution in Go and it should not require much more typing than using structs, dynamically find packages, or whatever else you were considering using reflection for."}, {"owner": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "reply_to_user": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "edited": false, "score": 0, "creation_date": 1476778598, "post_id": 40097220, "comment_id": 67477806, "body": "@Vatine that was the question; how to use reflection. This has nothing to do with js it was just an example of how it&#39;s done in js"}], "answers": [{"comments": [{"owner": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "edited": false, "score": 0, "creation_date": 1476778261, "post_id": 40102793, "comment_id": 67477626, "body": "Thats what i thought too. In the question i mentioned that but this is not the only case i need dynamic calls for thats why i upvoted but this is not exactly the answer i am looking for anyway this is the go way to do this stuff i think just it gets messy when you have a lot of stuff to call dynamically"}], "tags": [], "owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "is_accepted": false, "score": 1, "last_activity_date": 1476777865, "creation_date": 1476777865, "answer_id": 40102793, "question_id": 40097220, "link": "https://stackoverflow.com/questions/40097220/dynamic-struct-member-names-like-in-javascript-in-golang/40102793#40102793", "title": "Dynamic struct member names like in javascript in golang", "body": "<p>One possible route would be to use a <code>map[string]map[string]string</code>.</p>\n\n<p>You could then have a base package in which you declare your base translation variable and in your translation modules, you can use an <code>init</code> function to populate the relevant sub-map. It's essentially optional if you want to do this as separate packages or just separate files (doing it as packages means you have better compile-time control of what languages to include, doing it as files is probably less confusing).</p>\n\n<p>If you go the packages root, I suggest the following structure:</p>\n\n<pre><code>translation/base          This is where you export from\ntranslation/&lt;language&gt;    These are \"import only\" packages\n</code></pre>\n\n<p>Then, in translation/base:</p>\n\n<pre><code>package \"base\"\nvar Lang map[string]map[string]string\n</code></pre>\n\n<p>And in each language-specific package:</p>\n\n<pre><code>package \"&lt;language code&gt;\"\n\nimport \"language/base\"\n\nvar code = \"&lt;langcode&gt;\"\n\nfunc init() {\n  d := map[string]string{}\n  d[&lt;phrase1&gt;] = \"your translation here\"\n  d[&lt;phrase2&gt;] = \"another translation here\"\n  // Do this for all the translations\n  base.Lang[code] = d\n}\n</code></pre>\n\n<p>Then you can use this from your main program:</p>\n\n<pre><code>package \"...\"\n\nimport (\n   \"language/base\"\n   _ \"language/lang1\" // We are only interested in side-effects\n   _ \"language/lang2\" // Same here...\n)\n</code></pre>\n\n<p>Not using separate packages is (almost) the same. You simply ensure that all the files are in the same package and you can skip the package prefix for the <code>Lang</code> variable.</p>\n\n<p>A toy example <a href=\"https://play.golang.org/p/4ctb4BoBr0\" rel=\"nofollow\">on the Go Playground</a>, with all the \"fiddly\" bits inlined.</p>\n"}], "owner": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 396, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476777865, "creation_date": 1476746923, "question_id": 40097220, "link": "https://stackoverflow.com/questions/40097220/dynamic-struct-member-names-like-in-javascript-in-golang", "title": "Dynamic struct member names like in javascript in golang", "body": "<p>I am writing a multi-lang website.\nI read the language info from users cookies, and I have several translation modules such as <code>en.go</code> <code>gr.go</code> etc.\nThe modules are of type <code>map[string]string</code>.The problem here is in javascript I can do something like <code>lang[cookies.lang][\"whatever message\"].'But go does not support accessing struct members in this way. \nI could make switch case or</code>map[string]map[string]string` and map all possible languages, but this is much extra work.\nSo is there any way golang provides some way to access members like js brackets notation?\nNot: There was a similar question on the stack, and somebody wrote to use \"reflect\" package, but I could not quite understand how it works and failed to reproduce by myself works and failed to reproduce by myself.</p>\n"}, {"tags": ["xml", "go", "utf-8"], "comments": [{"owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "edited": false, "score": 1, "creation_date": 1476746503, "post_id": 40096958, "comment_id": 67466932, "body": "you can try <a href=\"https://github.com/kisielk/gorge/blob/master/util/util.go\" rel=\"nofollow noreferrer\">filter of invalid UTF-8 characters</a>"}, {"owner": {"reputation": 841, "user_id": 1858610, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Xxnjx.jpg?s=128&g=1", "display_name": "Devin Young", "link": "https://stackoverflow.com/users/1858610/devin-young"}, "reply_to_user": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "edited": false, "score": 0, "creation_date": 1476755057, "post_id": 40096958, "comment_id": 67468992, "body": "Oh my gosh that fixed it. That&#39;s some magic right there. Can you post as an answer so I can accept?"}, {"owner": {"reputation": 2028, "user_id": 711336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b48c9965a4ceb5193259840d3abdf38b?s=128&d=identicon&r=PG", "display_name": "s7anley", "link": "https://stackoverflow.com/users/711336/s7anley"}, "edited": false, "score": 0, "creation_date": 1476779491, "post_id": 40096958, "comment_id": 67478380, "body": "You had couple of typos in there and structs which where not needed, but in OS it&#39;s compiled and working without any problem. Strange, I thought it&#39;s everywhere the same. - <a href=\"https://play.golang.org/p/l5tijHxoZV\" rel=\"nofollow noreferrer\">play.golang.org/p/l5tijHxoZV</a> <code>go version go1.6 darwin&#47;amd64</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "is_accepted": true, "score": 5, "last_activity_date": 1476780558, "creation_date": 1476780558, "answer_id": 40103655, "question_id": 40096958, "link": "https://stackoverflow.com/questions/40096958/golang-xml-ending-parsing-with-invalid-utf-8-error/40103655#40103655", "title": "golang XML ending parsing with &#39;invalid UTF-8&#39; error", "body": "<p>Reader that filters out invalid UTF-8 characters</p>\n\n<pre><code>package main\n\n    import (\n    \"bufio\"\n    \"io\"\n    \"unicode\"\n    \"unicode/utf8\"\n    )\n\n    // ValidUTF8Reader implements a Reader which reads only bytes that constitute valid UTF-8\n    type ValidUTF8Reader struct {\n        buffer *bufio.Reader\n    }\n\n    // Function Read reads bytes in the byte array b. n is the number of bytes read.\n    func (rd ValidUTF8Reader) Read(b []byte) (n int, err error) {\n        for {\n            var r rune\n            var size int\n            r, size, err = rd.buffer.ReadRune()\n            if err != nil {\n                return\n            }\n            if r == unicode.ReplacementChar &amp;&amp; size == 1 {\n                continue\n            } else if n+size &lt; len(b) {\n                utf8.EncodeRune(b[n:], r)\n                n += size\n            } else {\n                rd.buffer.UnreadRune()\n                break\n            }\n        }\n        return\n    }\n\n    // NewValidUTF8Reader constructs a new ValidUTF8Reader that wraps an existing io.Reader\n    func NewValidUTF8Reader(rd io.Reader) ValidUTF8Reader {\n        return ValidUTF8Reader{bufio.NewReader(rd)}\n    }\n</code></pre>\n\n<p>taken from <a href=\"https://github.com/kisielk/gorge/blob/master/util/util.go\" rel=\"noreferrer\">here</a></p>\n"}, {"tags": [], "owner": {"reputation": 147, "user_id": 4797577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5d63b3f2ac2be5e0fc87da8170fdb6e?s=128&d=identicon&r=PG&f=1", "display_name": "Musab G&#252;ltekin", "link": "https://stackoverflow.com/users/4797577/musab-g%c3%bcltekin"}, "is_accepted": false, "score": 1, "last_activity_date": 1552825799, "creation_date": 1552825799, "answer_id": 55207051, "question_id": 40096958, "link": "https://stackoverflow.com/questions/40096958/golang-xml-ending-parsing-with-invalid-utf-8-error/55207051#55207051", "title": "golang XML ending parsing with &#39;invalid UTF-8&#39; error", "body": "<p>You can check if a <code>[]byte</code> is a valid UTF-8 encoded using: <a href=\"https://golang.org/pkg/unicode/utf8/#Valid\" rel=\"nofollow noreferrer\">utf8.Valid</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"unicode/utf8\"\n)\n\nfunc main() {\n    valid := []byte(\"Hello, \u4e16\u754c\")\n    invalid := []byte{0xff, 0xfe, 0xfd}\n\n    fmt.Println(utf8.Valid(valid))\n    fmt.Println(utf8.Valid(invalid))\n}\n</code></pre>\n\n<p>Or if you want to just remove non-UTF8:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"strings\"\n    \"unicode/utf8\"\n)\n\nvar removeNonUTF = func(r rune) rune {\n    if r == utf8.RuneError {\n        return -1\n    }\n    return r\n}\n\n// RemoveNonUTF8Strings removes strings that isn't UTF-8 encoded \nfunc RemoveNonUTF8Strings(string string) string {\n    return strings.Map(removeNonUTF, string)\n}\n\n// RemoveNonUTF8Bytes removes bytes that isn't UTF-8 encoded\nfunc RemoveNonUTF8Bytes(data []byte) []byte {\n    return bytes.Map(removeNonUTF, data)\n}\n</code></pre>\n"}], "owner": {"reputation": 841, "user_id": 1858610, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Xxnjx.jpg?s=128&g=1", "display_name": "Devin Young", "link": "https://stackoverflow.com/users/1858610/devin-young"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2584, "favorite_count": 0, "accepted_answer_id": 40103655, "answer_count": 2, "score": 4, "last_activity_date": 1552825799, "creation_date": 1476745196, "question_id": 40096958, "link": "https://stackoverflow.com/questions/40096958/golang-xml-ending-parsing-with-invalid-utf-8-error", "title": "golang XML ending parsing with &#39;invalid UTF-8&#39; error", "body": "<p>I am having an issue unmarshaling XML with unicode characters.</p>\n\n<p>When attempting to parse XML with standard English characters, it parses the entire file and unmarshals correctly without any issues. However, if the the XML file contains a character such as \u00f1, \u00e1, or \u2013 (em-dash), it stops parsing the XML and only returns the items in the array that are <em>before</em> the item with that character.</p>\n\n<p>For example, here is XML:</p>\n\n<pre><code>&lt;items&gt;\n  &lt;item&gt;\n    &lt;ID value=\"1\" name=\"Item 1\" GCName=\"Item 1\" /&gt;\n  &lt;/item&gt;\n  &lt;item&gt;\n    &lt;ID value=\"2\" name=\"Item 2\" GCName=\"Item 2\" /&gt;\n  &lt;/item&gt;\n  &lt;item&gt;\n    &lt;ID value=\"3\" name=\"Item 3\" GCName=\"Item 3 With \u00f1\" /&gt;\n  &lt;/item&gt;\n  &lt;item&gt;\n    &lt;ID value=\"4\" name=\"Item 4\" GCName=\"Item 4\" /&gt;\n  &lt;/item&gt;\n&lt;/items&gt;\n</code></pre>\n\n<p>This is my Go code (rough without any imports):</p>\n\n<pre><code># main.go\n\ntype Response struct {\n    Items []Items `xml:\"items\"`\n}\n\ntype Items struct {\n    Item []Item `xml:\"item\"`\n}\n\ntype Item struct {\n    ID    ItemID `xml:\"ID\"`\n}\n\ntype ItemID struct {\n    Value  string `xml:\"value,attr\"`\n    Name   string `xml:\"name,attr\"`\n    GCName string `xml:\"GCName,attr\"`\n}\n\nfunc main() {\n    xmlFile, err := os.Open(\"C:\\path\\to\\xml\\file.xml\")\n    if err != nil {\n        fmt.Println(\"Error opening file!\")\n        fmt.Println(err.Error())\n    }\n    defer xmlFile.Close()\n\n    xmlData, err := io.ReadAll(xmlFile)\n    if err != nil {\n        fmt.Println(\"Error reading file!\")\n        fmt.Println(err.Error())\n    }\n\n    var response Response\n    err := xml.Unmarshal(xmlData, &amp;response)\n    if err != nil {\n        fmt.Println(\"Error unmarshaling XML\")\n        fmt.Println(err.Error())\n    }\n    fmt.Println(response)\n}\n</code></pre>\n\n<p>This code will print out <em>only</em> the first two items, as if they were the only two. It will also output:</p>\n\n<pre><code>Error unmarshaling XML\nXML syntax error on line 9; Invalid UTF-8\n</code></pre>\n\n<p>I have also tried using xml.Decoder with a CharsetReader using a different encoding, but this did not yield any different results. FWIW, <strong>I am using Windows</strong>. </p>\n\n<p>Is there a way I can get around this error? Swap out the \"bad\" characters for something else? It was my understanding that those characters <em>are</em> valid UTF-8...so what gives??</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 716, "user_id": 1552415, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/00ff23663409a8ee6a3092728795a982?s=128&d=identicon&r=PG", "display_name": "kailash yogeshwar", "link": "https://stackoverflow.com/users/1552415/kailash-yogeshwar"}, "edited": false, "score": 1, "creation_date": 1595242188, "post_id": 40096757, "comment_id": 111396585, "body": "How can you access the header written in enclosing middleware.  res.Header().Get(&#39;StatusCode&#39;) gives nil."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 198, "last_activity_date": 1548171534, "last_edit_date": 1548171534, "creation_date": 1476743946, "answer_id": 40096757, "question_id": 40096750, "link": "https://stackoverflow.com/questions/40096750/how-to-set-http-status-code-on-http-responsewriter/40096757#40096757", "title": "How to set HTTP status code on http.ResponseWriter", "body": "<p>Use <a href=\"https://golang.org/pkg/net/http#ResponseWriter\" rel=\"noreferrer\"><code>http.ResponseWriter.WriteHeader</code></a>. From the documentation:</p>\n\n<blockquote>\n  <p>WriteHeader sends an HTTP response header with status code. If WriteHeader is not called explicitly, the first call to Write will trigger an implicit WriteHeader(http.StatusOK). Thus explicit calls to WriteHeader are mainly used to send error codes.</p>\n</blockquote>\n\n<p>Example:</p>\n\n<pre><code>func ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    w.WriteHeader(http.StatusInternalServerError)\n    w.Write([]byte(\"500 - Something bad happened!\"))\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 10070, "user_id": 155293, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/013dbf7988a8bfd5415680c1bd504eb9?s=128&d=identicon&r=PG", "display_name": "panchicore", "link": "https://stackoverflow.com/users/155293/panchicore"}, "edited": false, "score": 2, "creation_date": 1582150360, "post_id": 40096876, "comment_id": 106683065, "body": "it logs <code>http: superfluous response.WriteHeader call</code>"}, {"owner": {"reputation": 590, "user_id": 29017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2b9a9b117854bdc41b03dbd9125be3f2?s=128&d=identicon&r=PG", "display_name": "Adam Jack", "link": "https://stackoverflow.com/users/29017/adam-jack"}, "reply_to_user": {"reputation": 10070, "user_id": 155293, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/013dbf7988a8bfd5415680c1bd504eb9?s=128&d=identicon&r=PG", "display_name": "panchicore", "link": "https://stackoverflow.com/users/155293/panchicore"}, "edited": false, "score": 4, "creation_date": 1594336056, "post_id": 40096876, "comment_id": 111098672, "body": "Hey @panchicore in case it wasn&#39;t obvious in hindsight - and for completion - you can only send one such header, the second was just a different example. The &quot;superfluous&quot; in that warning merely states that only the first should be sent."}], "tags": [], "owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "is_accepted": false, "score": 36, "last_activity_date": 1476744658, "creation_date": 1476744658, "answer_id": 40096876, "question_id": 40096750, "link": "https://stackoverflow.com/questions/40096750/how-to-set-http-status-code-on-http-responsewriter/40096876#40096876", "title": "How to set HTTP status code on http.ResponseWriter", "body": "<pre><code>w.WriteHeader(http.StatusInternalServerError)\nw.WriteHeader(http.StatusForbidden)\n</code></pre>\n\n<p>full list <a href=\"https://golang.org/pkg/net/http/#pkg-constants\" rel=\"noreferrer\">here</a></p>\n"}, {"comments": [{"owner": {"reputation": 905, "user_id": 3002244, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003895341884/picture?type=large", "display_name": "Wishmaster", "link": "https://stackoverflow.com/users/3002244/wishmaster"}, "edited": false, "score": 0, "creation_date": 1554441841, "post_id": 40096885, "comment_id": 97760947, "body": "I don&#39;t know why, but only this answer works for me, not &quot;WriteHeader(int)&quot;, so thanx a lot!"}], "tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": false, "score": 107, "last_activity_date": 1488743495, "last_edit_date": 1488743495, "creation_date": 1476744721, "answer_id": 40096885, "question_id": 40096750, "link": "https://stackoverflow.com/questions/40096750/how-to-set-http-status-code-on-http-responsewriter/40096885#40096885", "title": "How to set HTTP status code on http.ResponseWriter", "body": "<p>Apart from <code>WriteHeader(int)</code> you can use the helper method <a href=\"https://golang.org/pkg/net/http/#Error\" rel=\"noreferrer\">http.Error</a>, for example:</p>\n\n<pre><code>func yourFuncHandler(w http.ResponseWriter, r *http.Request) {\n\n    http.Error(w, \"my own error message\", http.StatusForbidden)\n\n    // or using the default message error\n\n    http.Error(w, http.StatusText(http.StatusNotFound), http.StatusNotFound)\n}\n</code></pre>\n\n<p>http.Error() and <a href=\"https://golang.org/pkg/net/http/#StatusText\" rel=\"noreferrer\">http.StatusText()</a> methods are your friends</p>\n"}], "owner": {"reputation": 1625, "user_id": 4678144, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/335610303dd254d2a8938006e4114fc2?s=128&d=identicon&r=PG&f=1", "display_name": "Nick H", "link": "https://stackoverflow.com/users/4678144/nick-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102366, "favorite_count": 13, "accepted_answer_id": 40096757, "answer_count": 3, "score": 117, "last_activity_date": 1576258919, "creation_date": 1476743855, "last_edit_date": 1548171482, "question_id": 40096750, "link": "https://stackoverflow.com/questions/40096750/how-to-set-http-status-code-on-http-responsewriter", "title": "How to set HTTP status code on http.ResponseWriter", "body": "<p>How do I set the HTTP status code on an <code>http.ResponseWriter</code> (e.g. to 500 or 403)?</p>\n\n<p>I can see that requests normally have a status code of 200 attached to them.</p>\n"}, {"tags": ["go", "google-bigquery"], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1476743482, "creation_date": 1476742864, "last_edit_date": 1495540111, "question_id": 40096594, "link": "https://stackoverflow.com/questions/40096594/does-bigquery-have-a-reflect-api", "title": "Does bigquery have a reflect API?", "body": "<p>I'm tryig to insert data and then query it back but I cannot figure out how to do that without to <a href=\"https://stackoverflow.com/a/30397686/3257971\">manually</a> map field names to struct values. Is there any reflect based API working like encoding/json or google datastore?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1476740279, "post_id": 40096051, "comment_id": 67464916, "body": "When you want &quot;mutual exclusion&quot; around a single resource, you usually want a <a href=\"https://golang.org/pkg/sync/#Mutex\" rel=\"nofollow noreferrer\">&quot;mutex&quot;</a>"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1476740452, "post_id": 40096051, "comment_id": 67464986, "body": "No nonobvious way--if it&#39;s updated frequently you want a Mutex or RWLock (if allowing multiple simultaneous readers is important). If it&#39;s read far, far more often than it&#39;s updated (like config that&#39;s used every request + rarely updated) you could have a pointer in an atomic.Value and replace it with a new instance when you refresh."}, {"owner": {"reputation": 1170, "user_id": 466448, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/365f17506de3b2175978b2de481fdcff?s=128&d=identicon&r=PG", "display_name": "fandingo", "link": "https://stackoverflow.com/users/466448/fandingo"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1476740865, "post_id": 40096051, "comment_id": 67465156, "body": "@twotwotwo: Thanks. That&#39;s what I figured. Let&#39;s say I make a MY_DATA global variable for my struct. Can I put the RWLock in the struct safely, or does the mutex need to be a separate global variable?"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1476743725, "post_id": 40096051, "comment_id": 67466187, "body": "Marcel&#39;s got it--yes, mutexes and such can and often do live in the structs."}], "answers": [{"comments": [{"owner": {"reputation": 1170, "user_id": 466448, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/365f17506de3b2175978b2de481fdcff?s=128&d=identicon&r=PG", "display_name": "fandingo", "link": "https://stackoverflow.com/users/466448/fandingo"}, "edited": false, "score": 0, "creation_date": 1476741613, "post_id": 40096220, "comment_id": 67465457, "body": "Thanks! Quick newbie question: What&#39;s the significance of the <code>(m *MutexedMyData)</code> in the func declaration?"}, {"owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "reply_to_user": {"reputation": 1170, "user_id": 466448, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/365f17506de3b2175978b2de481fdcff?s=128&d=identicon&r=PG", "display_name": "fandingo", "link": "https://stackoverflow.com/users/466448/fandingo"}, "edited": false, "score": 1, "creation_date": 1476741865, "post_id": 40096220, "comment_id": 67465552, "body": "<a href=\"http://golangtutorials.blogspot.ru/2011/06/methods-on-structs.html\" rel=\"nofollow noreferrer\">methods on struct</a>,  you can use them as m.Update or m.Read"}], "tags": [], "owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "is_accepted": true, "score": 3, "last_activity_date": 1476740904, "creation_date": 1476740904, "answer_id": 40096220, "question_id": 40096051, "link": "https://stackoverflow.com/questions/40096051/go-how-to-synchronize-and-share-data/40096220#40096220", "title": "Go: How to Synchronize and Share Data", "body": "<p>Mutex based solution</p>\n\n<pre><code>type MyData struct {\n    Expiration time.Time\n    A  string\n    B  string\n    C string\n}\n\ntype MutexedMyData struct {\n    sync.RWMutex\n    MyData MyData\n}\n\nvar m = &amp;MutexedMyData{}\n\n\nfunc (m *MutexedMyData) Update(my_data MyData)  {\n    m.Lock()\n    m.MyData = my_data\n    m.Unlock()\n}\n\nfunc (m *MutexedMyData) Read() MyData {\n    u.RLock()\n    value := m.MyData\n    u.RUnlock()\n\n    return value\n}\n</code></pre>\n"}], "owner": {"reputation": 1170, "user_id": 466448, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/365f17506de3b2175978b2de481fdcff?s=128&d=identicon&r=PG", "display_name": "fandingo", "link": "https://stackoverflow.com/users/466448/fandingo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 40096220, "answer_count": 1, "score": 2, "last_activity_date": 1476740904, "creation_date": 1476740101, "question_id": 40096051, "link": "https://stackoverflow.com/questions/40096051/go-how-to-synchronize-and-share-data", "title": "Go: How to Synchronize and Share Data", "body": "<p>I'm writing a net/http server. My request handlers need access to some shared data that is updated by another go-routine. This go-routine keeps a single struct updated, and all of the net/http handlers need access to the same struct. </p>\n\n<pre><code>type MyData struct {\n  Expiration time.Time\n  A  string\n  B  string\n  C string\n}\n\nfunc update(data MyData) {\n  go func() {\n    for {\n      if data.Expiration &gt;= time.Now() {\n        // set A, B, C\n      }\n      // sleep\n    }\n  }()\n}\n</code></pre>\n\n<p>What's the best way to make a single, common MyData available to other go-routines? I was thinking a channel, but every reader of the channel should get the same MyData. The problem is that reading from a channel pops the item off the channel. I guess I'm looking for how to Peek() on the reader side, and Drain() on the writer side when it's time to update. </p>\n"}, {"tags": ["go", "xml-parsing"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1476737933, "post_id": 40095427, "comment_id": 67463880, "body": "<code>decoder</code> is the error returned by <code>xml.Unmarshal</code>, and you&#39;re passing a <code>**Rets</code> to <code>Unmarshal</code>, rather than a <code>*Rets</code>."}, {"owner": {"reputation": 2124, "user_id": 3006170, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wFSLc.jpg?s=128&g=1", "display_name": "Svitlana", "link": "https://stackoverflow.com/users/3006170/svitlana"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476737938, "post_id": 40095427, "comment_id": 67463884, "body": "sorry, of course fmt.Println(data), but I got an empty object"}, {"owner": {"reputation": 2124, "user_id": 3006170, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wFSLc.jpg?s=128&g=1", "display_name": "Svitlana", "link": "https://stackoverflow.com/users/3006170/svitlana"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476738028, "post_id": 40095427, "comment_id": 67463912, "body": "However, number of elements are correct, but they are empty."}, {"owner": {"reputation": 2124, "user_id": 3006170, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wFSLc.jpg?s=128&g=1", "display_name": "Svitlana", "link": "https://stackoverflow.com/users/3006170/svitlana"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476738200, "post_id": 40095427, "comment_id": 67463997, "body": "rdata := new(Rets)  \terr = xml.Unmarshal(body, &amp;rdata) \tfmt.Println(rdata)  &amp;{[{} {} {} {} {}] However number of array elements are correct - maybe it is because of spaces in DATA elements?"}], "answers": [{"comments": [{"owner": {"reputation": 2124, "user_id": 3006170, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wFSLc.jpg?s=128&g=1", "display_name": "Svitlana", "link": "https://stackoverflow.com/users/3006170/svitlana"}, "edited": false, "score": 0, "creation_date": 1476738454, "post_id": 40095626, "comment_id": 67464123, "body": "Wow, Jim. THANK YOU SOOO MUCH! I thought my attempt to switch to go  failed on step 1 :-)!"}, {"owner": {"reputation": 2124, "user_id": 3006170, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wFSLc.jpg?s=128&g=1", "display_name": "Svitlana", "link": "https://stackoverflow.com/users/3006170/svitlana"}, "edited": false, "score": 0, "creation_date": 1476738824, "post_id": 40095626, "comment_id": 67464294, "body": "Great, both works. I do not understand fully where chardata came from but I will read docs more :-). Have a great day!"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 3, "last_activity_date": 1476738267, "creation_date": 1476738267, "answer_id": 40095626, "question_id": 40095427, "link": "https://stackoverflow.com/questions/40095427/golang-parsing-xml-to-struct/40095626#40095626", "title": "Golang, parsing xml to struct?", "body": "<p>From the <a href=\"https://golang.org/pkg/encoding/xml/#Unmarshal\" rel=\"nofollow\"><code>xml.Unmarshal</code> docs</a></p>\n\n<blockquote>\n  <ul>\n  <li>If the XML element contains character data, that data is\n  accumulated in the first struct field that has tag \",chardata\".\n  The struct field may have type []byte or string.\n  If there is no such field, the character data is discarded.</li>\n  </ul>\n</blockquote>\n\n<p>Use</p>\n\n<pre><code>type DATA struct {\n    DATA string `xml:\",chardata\"`\n}\n\ntype Rets struct {\n    DATA []DATA `xml:\"DATA\"`\n}\n</code></pre>\n\n<p>Or in this simple case, you can just use </p>\n\n<pre><code>type Rets struct {\n    DATA []string `xml:\"DATA\"`\n}\n</code></pre>\n\n<p>Which collects the charadata from a list of elements by default</p>\n"}, {"tags": [], "owner": {"reputation": 160456, "user_id": 89391, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/bb5230985aa2c9ea7d022d1a16890f16?s=128&d=identicon&r=PG", "display_name": "miku", "link": "https://stackoverflow.com/users/89391/miku"}, "is_accepted": false, "score": 4, "last_activity_date": 1575839882, "last_edit_date": 1575839882, "creation_date": 1532431545, "answer_id": 51497393, "question_id": 40095427, "link": "https://stackoverflow.com/questions/40095427/golang-parsing-xml-to-struct/51497393#51497393", "title": "Golang, parsing xml to struct?", "body": "<p>There are a couple of tools for turning XML into Go structs. One that is suitable for reading is <a href=\"https://github.com/miku/zek/\" rel=\"nofollow noreferrer\">zek</a> (try it <a href=\"https://www.onlinetool.io/xmltogo/\" rel=\"nofollow noreferrer\">online</a>), and although it is experimental, it can deal with a couple of common XML constructs already.</p>\n\n<p>You can go from a <a href=\"https://gist.github.com/miku/3df6ddbba9f7baf078662d682e8f32e0#file-rets-xml\" rel=\"nofollow noreferrer\">XML file</a> (<a href=\"https://git.io/fN4Pq\" rel=\"nofollow noreferrer\">raw</a>) to a struct with a simple command:</p>\n\n<pre><code>$ curl -sL https://git.io/fN4Pq | zek -e -p -c\n</code></pre>\n\n<p>This will create a struct plus an <a href=\"https://gist.github.com/miku/3df6ddbba9f7baf078662d682e8f32e0#file-main-go\" rel=\"nofollow noreferrer\">example program</a> for testing out the marshalling (the example does very little, it read XML from stdin and turns it into <a href=\"https://gist.github.com/miku/3df6ddbba9f7baf078662d682e8f32e0#file-readme-md\" rel=\"nofollow noreferrer\">JSON</a>).</p>\n\n<p>Here is an example struct (for some XML take from <a href=\"https://github.com/estately/rets/blob/master/test/fixtures.rb\" rel=\"nofollow noreferrer\">this repo</a>):</p>\n\n<pre><code>// RETS was generated 2018-09-07 12:11:10 by tir on apollo.local.\ntype RETS struct {\n    XMLName       xml.Name `xml:\"RETS\"`\n    Text          string   `xml:\",chardata\"`\n    ReplyCode     string   `xml:\"ReplyCode,attr\"`\n    ReplyText     string   `xml:\"ReplyText,attr\"`\n    METADATATABLE struct {\n        Text     string   `xml:\",chardata\"`\n        Resource string   `xml:\"Resource,attr\"`\n        Class    string   `xml:\"Class,attr\"`\n        Version  string   `xml:\"Version,attr\"`\n        Date     string   `xml:\"Date,attr\"`\n        COLUMNS  string   `xml:\"COLUMNS\"` // MetadataEntryID    SystemNam...\n        DATA     []string `xml:\"DATA\"`    // 7  City        City    Ci ...\n    } `xml:\"METADATA-TABLE\"`\n}\n</code></pre>\n\n<p>Disclaimer: I wrote zek.</p>\n"}], "owner": {"reputation": 2124, "user_id": 3006170, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wFSLc.jpg?s=128&g=1", "display_name": "Svitlana", "link": "https://stackoverflow.com/users/3006170/svitlana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8059, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1575839882, "creation_date": 1476737432, "question_id": 40095427, "link": "https://stackoverflow.com/questions/40095427/golang-parsing-xml-to-struct", "title": "Golang, parsing xml to struct?", "body": "<p>I have such xml document and I need to get an array of DATA. I cannot solve this simple task for 4 hours.... want back to node.js :-)</p>\n\n<pre><code>&lt;?xml version=\"1.0\" standalone=\"no\"?&gt;\n&lt;RETS ReplyCode=\"0\" ReplyText=\"Operation Successful\" &gt;\n&lt;COUNT Records=\"58951\" /&gt;\n&lt;DELIMITER value=\"09\"/&gt;\n&lt;COLUMNS&gt;   LN  &lt;/COLUMNS&gt;\n&lt;DATA&gt;  09361303    &lt;/DATA&gt;\n&lt;DATA&gt;  09333085    &lt;/DATA&gt;\n&lt;MAXROWS/&gt;\n</code></pre>\n\n<h2>    </h2>\n\n<pre><code>type DATA struct {\n    DATA string `xml:\"DATA\"`\n}\n\ntype Rets struct {\n    DATA []DATA `xml:\"RETS&gt;DATA\"`\n}\n\n\ndata := &amp;Rets{}\ndecoder := xml.Unmarshal(body,&amp;data)\n\nfmt.Println(decoder)\n</code></pre>\n"}, {"tags": ["go", "webserver", "shutdown"], "comments": [{"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1476773317, "post_id": 40095371, "comment_id": 67474621, "body": "You can take a look at this <a href=\"http://stackoverflow.com/a/40041517/2285935\">answer</a> to get a basic idea of how it&#39;s done."}], "answers": [{"tags": [], "owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "is_accepted": false, "score": 1, "last_activity_date": 1476739738, "creation_date": 1476739738, "answer_id": 40095960, "question_id": 40095371, "link": "https://stackoverflow.com/questions/40095371/how-to-properly-stop-the-web-server-that-comes-with-go-sdk/40095960#40095960", "title": "How to properly stop the web-server that comes with Go sdk?", "body": "<p>That's exactly what <a href=\"https://github.com/braintree/manners\" rel=\"nofollow\">github.com/braintree/manners</a> does. You look through the source but the gist of it is that they have a <code>sync.WaitGroup</code> that is incremented for every incoming connection and decremented upon completion. When you ask manners to stop the server it waits until everyone's out of the door.</p>\n\n<p>If you need to strictly stick to the std lib then you can draw some inspiration from how manners does it but it's a really nice package and I would recommend just using it.</p>\n"}], "owner": {"reputation": 5392, "user_id": 361836, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/f426a26f03d7d4d61d354a3b2fc5337d?s=128&d=identicon&r=PG", "display_name": "lucidquiet", "link": "https://stackoverflow.com/users/361836/lucidquiet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476739738, "creation_date": 1476737118, "question_id": 40095371, "link": "https://stackoverflow.com/questions/40095371/how-to-properly-stop-the-web-server-that-comes-with-go-sdk", "title": "How to properly stop the web-server that comes with Go sdk?", "body": "<p>What is the right way to shutdown the web-server that comes with the Go SDK?  </p>\n\n<p>Here's an example web service:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"Hi there, I love %s!\", r.URL.Path[1:])\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>That was pulled form here: <a href=\"https://golang.org/doc/articles/wiki/#tmp_3\" rel=\"nofollow\">https://golang.org/doc/articles/wiki/#tmp_3</a></p>\n\n<p>However, I'd like to tear down this server and have it drain off any currently running requests.  How is this done?</p>\n"}, {"tags": ["go", "binding", "dart", "bidirectional"], "comments": [{"owner": {"reputation": 483706, "user_id": 217408, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/IlnZm.jpg?s=128&g=1", "display_name": "G&#252;nter Z&#246;chbauer", "link": "https://stackoverflow.com/users/217408/g%c3%bcnter-z%c3%b6chbauer"}, "edited": false, "score": 0, "creation_date": 1476729120, "post_id": 40093265, "comment_id": 67459357, "body": "I guess the closest is <a href=\"https://www.dartlang.org/articles/dart-vm/native-extensions\" rel=\"nofollow noreferrer\">dartlang.org/articles/dart-vm/native-extensions</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1476730473, "post_id": 40093265, "comment_id": 67460029, "body": "You can use any sort of RPC mechanism, rather than trying to glue these together through some intermediary C bindings."}, {"owner": {"reputation": 2154, "user_id": 286807, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/0209e8ffa4575c0108d3eebac7e59762?s=128&d=identicon&r=PG", "display_name": "Timothy C. Quinn", "link": "https://stackoverflow.com/users/286807/timothy-c-quinn"}, "edited": false, "score": 0, "creation_date": 1476731085, "post_id": 40093265, "comment_id": 67460351, "body": "Thanks guy&#39;s. Definitely want a native binding rather than RPC to avoid marshalling cost and api limitations of an rpc. I will probably use dart native-extensions with a cgo library with appropriate shims in go to make the development iteration time, and specifically go compilation time, more manageable."}], "owner": {"reputation": 2154, "user_id": 286807, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/0209e8ffa4575c0108d3eebac7e59762?s=128&d=identicon&r=PG", "display_name": "Timothy C. Quinn", "link": "https://stackoverflow.com/users/286807/timothy-c-quinn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 174, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1476728976, "creation_date": 1476728976, "question_id": 40093265, "link": "https://stackoverflow.com/questions/40093265/bidirectional-bindings-between-go-and-dart", "title": "Bidirectional bindings between Go and Dart", "body": "<p>I am interested in writing server side application that utilizes both <a href=\"https://golang.org/\" rel=\"nofollow\">Go</a> and <a href=\"https://www.dartlang.org/\" rel=\"nofollow\">Dart</a>. Is there any way to bind these two languages directly? </p>\n\n<p>I could not find any docs pertaining to this usecase.</p>\n"}, {"tags": ["email", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476728593, "post_id": 40092662, "comment_id": 67459071, "body": "Email priority isn&#39;t part of SMTP, or even a standard. Your email client probably uses an <code>X-Priority</code> header to communicate importance."}, {"owner": {"reputation": 21, "user_id": 6950114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601c5f2a75e38fd0a1b6ecb3f644957f?s=128&d=identicon&r=PG&f=1", "display_name": "Sailaja", "link": "https://stackoverflow.com/users/6950114/sailaja"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476739267, "post_id": 40092662, "comment_id": 67464490, "body": "so you are telling that there is no way to make the mail as hi-rpi"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476740016, "post_id": 40092662, "comment_id": 67464805, "body": "No, I&#39;m saying set whatever header your email client uses, to the value it interprets as &quot;high priority&quot;."}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1476849629, "post_id": 40092662, "comment_id": 67514308, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/4169605/php-mail-how-to-set-priority\">PHP mail() - How to set Priority?</a> -- while the question is nominally for PHP, the answer is basically language-independent."}, {"owner": {"reputation": 21, "user_id": 6950114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601c5f2a75e38fd0a1b6ecb3f644957f?s=128&d=identicon&r=PG&f=1", "display_name": "Sailaja", "link": "https://stackoverflow.com/users/6950114/sailaja"}, "edited": false, "score": 0, "creation_date": 1477029001, "post_id": 40092662, "comment_id": 67606480, "body": "I fixed it as suggested by JimB and it works fine"}], "answers": [{"tags": [], "owner": {"reputation": 366, "user_id": 5473004, "user_type": "registered", "profile_image": "https://graph.facebook.com/923112464409335/picture?type=large", "display_name": "Philippe Thomassigny", "link": "https://stackoverflow.com/users/5473004/philippe-thomassigny"}, "is_accepted": false, "score": 0, "last_activity_date": 1550774481, "creation_date": 1550774481, "answer_id": 54814094, "question_id": 40092662, "link": "https://stackoverflow.com/questions/40092662/golang-smtp-making-the-mail-as-hipri-or-important/54814094#54814094", "title": "golang smtp making the mail as hipri or important", "body": "<p>Add to your code:</p>\n\n<pre><code>headers[\"X-Priority\"] = \"1 (Highest)\"\nheaders[\"X-MSMail-Priority\"] = \"High\"\nheaders[\"Importance\"] = \"High\"\n</code></pre>\n\n<p>That should work. \nHowever as said in comments, priority will be interpreted by your client, not your server. Will 100% depends on what your mail client decides to show.</p>\n"}], "owner": {"reputation": 21, "user_id": 6950114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601c5f2a75e38fd0a1b6ecb3f644957f?s=128&d=identicon&r=PG&f=1", "display_name": "Sailaja", "link": "https://stackoverflow.com/users/6950114/sailaja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 238, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1550774481, "creation_date": 1476726578, "question_id": 40092662, "link": "https://stackoverflow.com/questions/40092662/golang-smtp-making-the-mail-as-hipri-or-important", "title": "golang smtp making the mail as hipri or important", "body": "<p>I tried to send a email using golang smtp <a href=\"https://github.com/golang/go/wiki/SendingMail\" rel=\"nofollow\">https://github.com/golang/go/wiki/SendingMail</a> and able to send email properly. Below is the code snippet</p>\n\n<pre><code>func sendEmail(server string) {\n// Connect to the server, set the sender and recipient,\n// and send the email all in one step.\nheaders := make(map[string]string)\n\nheaders[\"Subject\"] = \"Hi-Pri# Server \" + server + \" down\"\nheaders[\"From\"] = \"YYYY@net\"\nheaders[\"To\"] = \"XXXX@net\"\n\nbody := \"Hello, Test\"\n\n// Setup message\nmessage := \"\"\nfor k, v := range headers {\n    message += fmt.Sprintf(\"%s: %s\\r\\n\", k, v)\n}\nmessage += \"\\r\\n\" + body\nerr := smtp.SendMail(\n    \"test.com:25\",\n    nil,\n    \"YYYY@net\",\n    []string{\"XXXX@net\"},\n    []byte(message),\n)\nif err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p>Im trying to send a hipri mail but couldn't fine the option to make a mail as hirpri or important one. Can someone help me</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1476726729, "post_id": 40092155, "comment_id": 67458084, "body": "A NULL coming from sql is not the same that a Go nil. Take a look to <a href=\"https://golang.org/pkg/database/sql/#NullString\" rel=\"nofollow noreferrer\">NullString</a>"}], "answers": [{"comments": [{"owner": {"reputation": 102, "user_id": 2939048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99261f248d8e2079c3fe9b6b2ea3f95f?s=128&d=identicon&r=PG", "display_name": "Juan Ricardo", "link": "https://stackoverflow.com/users/2939048/juan-ricardo"}, "edited": false, "score": 0, "creation_date": 1566352520, "post_id": 40092777, "comment_id": 101625744, "body": "That&#39;s pretty smart and clean"}, {"owner": {"reputation": 5512, "user_id": 324446, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/veSHY.png?s=128&g=1", "display_name": "Akh", "link": "https://stackoverflow.com/users/324446/akh"}, "edited": false, "score": 0, "creation_date": 1577393381, "post_id": 40092777, "comment_id": 105160748, "body": "Is thr any advantage using <code>sql.NullString</code> over using <code>*string</code>?"}, {"owner": {"reputation": 4379, "user_id": 184176, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/811251725188ac87f9125177073c28d0?s=128&d=identicon&r=PG", "display_name": "sepehr", "link": "https://stackoverflow.com/users/184176/sepehr"}, "edited": false, "score": 4, "creation_date": 1603234722, "post_id": 40092777, "comment_id": 113971726, "body": "<a href=\"https://groups.google.com/g/golang-nuts/c/vOTFu2SMNeA/m/GB5v3JPSsicJ\" rel=\"nofollow noreferrer\">From Russ Cox</a>:   <code>There&#39;s no effective difference. We thought people might want to use NullString because it is so common and perhaps expresses the intent more clearly than *string. But either will work.</code>"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "reply_to_user": {"reputation": 4379, "user_id": 184176, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/811251725188ac87f9125177073c28d0?s=128&d=identicon&r=PG", "display_name": "sepehr", "link": "https://stackoverflow.com/users/184176/sepehr"}, "edited": false, "score": 0, "creation_date": 1609581567, "post_id": 40092777, "comment_id": 115869781, "body": "thanks @sepehr that quotes makes sense. The answer is misleading. Strictly speaking a null is not a nil, but at a higher level they both represent the very same concept."}], "tags": [], "owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "is_accepted": true, "score": 17, "last_activity_date": 1476727068, "creation_date": 1476727068, "answer_id": 40092777, "question_id": 40092155, "link": "https://stackoverflow.com/questions/40092155/difference-between-string-and-sql-nullstring/40092777#40092777", "title": "Difference between *string and sql.NullString", "body": "<p>SQL has different null values than Golang.</p>\n\n<p>If you look at the definition of <code>sql.NullString</code> then this is what you get:</p>\n\n<pre><code>type NullString struct {\n    String string\n    Valid  bool // Valid is true if String is not NULL\n}\n</code></pre>\n\n<p>As you can see, <code>sql.NullString</code> is a way to represent null string coming from SQL (which correspond to \"NULL\").\nOn the other hand, a nil <code>*string</code> is a pointer to a string which is nil, so the two are different.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2094540"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15883, "favorite_count": 1, "accepted_answer_id": 40092777, "answer_count": 1, "score": 17, "last_activity_date": 1523563148, "creation_date": 1476724611, "last_edit_date": 1523563148, "question_id": 40092155, "link": "https://stackoverflow.com/questions/40092155/difference-between-string-and-sql-nullstring", "title": "Difference between *string and sql.NullString", "body": "<p>I've been strugguling with SQL NULL values in Golang recently. After trying to unsuccessfully unmarshal JSON objects using <code>Decode()</code> and <code>sql.NullString</code>, I came to this answer on StackOverflow : </p>\n\n<p><a href=\"https://stackoverflow.com/questions/31048557/assigning-null-to-json-fields-instead-of-empty-strings-in-golang#answer-31048860\">Assigning null to JSON fields instead of empty strings in Golang</a></p>\n\n<p>The solution using a string pointer seems to work perfectly with Decode() and nil values. So what is the difference between <code>sql.NullString</code> and <code>*string</code> ?\nIs it just about nil checking ?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 106, "user_id": 4900487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6a84e616d3340cf7a0900a7d5dc949e?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/4900487/richard"}, "edited": false, "score": 0, "creation_date": 1484561186, "post_id": 41655734, "comment_id": 70545032, "body": "Nice thorough answer"}, {"owner": {"reputation": 106, "user_id": 4900487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6a84e616d3340cf7a0900a7d5dc949e?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/4900487/richard"}, "edited": false, "score": 1, "creation_date": 1484561308, "post_id": 41655734, "comment_id": 70545100, "body": "For interest; we ended up documenting it as added &#39;Behaviours&#39;"}], "tags": [], "owner": {"reputation": 1412, "user_id": 3809561, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RTS59.jpg?s=128&g=1", "display_name": "yyny", "link": "https://stackoverflow.com/users/3809561/yyny"}, "is_accepted": true, "score": 2, "last_activity_date": 1484433190, "creation_date": 1484433190, "answer_id": 41655734, "question_id": 40091142, "link": "https://stackoverflow.com/questions/40091142/is-there-an-established-pattern-name-for-golang-code-which-seems-similar-to-a-mi/41655734#41655734", "title": "Is there an established pattern name for golang code which seems similar to a mixin", "body": "<h2>What is a mixin?</h2>\n\n<p>A mixin is basically a piece of code to be included ('mixed in') to another:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>// WARNING: Messy, untested C code ahead\n// Illustrates mixins in a non-OO language.\n// mixin_hasname.h\n    char *name;\n// mixin_hasname_impl.h\nstruct hasname_vtable { // Vtable for storing mixin functions. Saves a lot of memory in the long run, as only one vtable has to be defined per type.\n    char *(*getname)(void *self);\n};\n\n#define CAT(X,Y) X##Y\n#define CATX(X,Y) CAT(X,Y)\n#define GEN_HASNAME_VTABLE(TYPENAME,PRENAME)\\\nstatic struct hasname_vtable {\\\n    .getname = CATX(PRENAME,getname)\\\n} CATX(PRENAME,vtable);\\\nstatic char *CATX(PRENAME,getname)(void *self) {\\\n    return ((TYPENAME *)self)-&gt;name;\\\n}\n// main.c\nstruct my_c_struct {\n// include our mixin fields\n#include &lt;mixin_hasname.h&gt;\n    int x, y, z;\n};\n\n// include our mixin implementation\n#include &lt;mixin_hasname_impl.h&gt;\n\n// generate an implementation for our struct\nGEN_HASNAME_VTABLE(struct my_c_struct, mycstruct_)\n\nint indirect(struct my_c_struct *x, struct hasname_vtable *hasname_vt) {\n    printf(\"%s\\n\", hasname_vt.getname(x));\n}\n\nint main(void) {\n    struct my_c_struct x;\n\n    x.name = \"Name\";\n    x.x = 0, x.y = 0, x.z = 0;\n\n    printf(\"%s\\n\", mycstruct_getname(&amp;x)); // Notice we never had to define mycstruct_getname ourselves; we avoided code duplication\n    indirect(&amp;x, mycstruct_vtable); // Generally, vtables are passed. Some languages pass typeid's or function pointers, however. (Few put their vtable in their data type (in this case `x`) because of the inefficient memory usage. In the case of C, though, it saves you from having to pass your vtable everytime you call an indirect function).\n\n    return 0;\n}\n</code></pre>\n\n<p>This also holds true for a mixin in OOP, but OOP adds a lot of restrictions on mixins. For example, mixins might not have access to private variables, child class members, class methods, etc. Golang is not really OO.</p>\n\n<h2>Can this code pattern be called a mixin?</h2>\n\n<p>So, with that out of the way, is this an example of a mixin? No, I wouldn't say so. The biggest problem I'm having with answering that question isn't that your pattern doesn't follow the definition defined for OO (Because Golang is not OO anyway), but that it doesn't really 'mix in' the code, it's just storing it in it's own field.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>struct struct_with_name_field {\n    char *name;\n}\n// main.c\nstruct my_c_struct {\n    struct struct_with_name_field namefield;\n    int x, y, z;\n}\n\nint main(void) {\n    struct my_c_struct x;\n\n    x.namefield.name = \"Name\";\n    x.x = 0, x.y = 0, x.z = 0;\n\n    return 0;\n}\n</code></pre>\n\n<p>However, I do think it's perfectly reasonable to call this pattern a mixin within your team or your documentation, especially because, as far as I know, real mixins aren't possible in Golang anyway, and this pattern is as close as you will get.</p>\n\n<h2>Summary</h2>\n\n<p>Golang doesn't allow you to define mixins (only interfaces), so your pattern isn't a mixin. However, given the definition of mixin (Especially outside OOP), and the fact that your pattern is probably the closest you will get to mixins in Golang, it is very reasonable to call this a mixin anyway.</p>\n"}, {"comments": [{"owner": {"reputation": 106, "user_id": 4900487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6a84e616d3340cf7a0900a7d5dc949e?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/4900487/richard"}, "edited": false, "score": 0, "creation_date": 1498469411, "post_id": 44707721, "comment_id": 76494046, "body": "That is quite interesting; I have always considered and referred to your example as a vanilla use of interfaces or composition respectively.  Your answer is useful to keep it clear what is being talked about."}, {"owner": {"reputation": 106, "user_id": 4900487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6a84e616d3340cf7a0900a7d5dc949e?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/4900487/richard"}, "edited": false, "score": 0, "creation_date": 1498469484, "post_id": 44707721, "comment_id": 76494080, "body": "Note that the question can be summarised as &#39;what pattern is this code&#39; rather than how to write a mixin / advisable method of writing code."}, {"owner": {"reputation": 1303, "user_id": 4109326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b090762b6dedc08b967a9b6774831f7e?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Guyer", "link": "https://stackoverflow.com/users/4109326/alexander-guyer"}, "edited": false, "score": 0, "creation_date": 1608156902, "post_id": 44707721, "comment_id": 115500493, "body": "This is a wonderful answer. Mixins are just orthogonal pieces of implementation that can be mixed and matched. By that logic, everything which is composed is, in essence, a mixin; composition allows borrowing implementation from the composed object, just like a mixin. However, the boilerplate code necessary to support function forwarding through composed objects is troublesome, so we typically distinguish traditional composition from the term &quot;mixin&quot;, even though they&#39;re essentially the same concept. Embedded structs just remove that boilerplate code, thus they are perfect examples of mixins."}], "tags": [], "owner": {"reputation": 903, "user_id": 228753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d05a76c3a395e4969e72236b7d1d929f?s=128&d=identicon&r=PG", "display_name": "GodsBoss", "link": "https://stackoverflow.com/users/228753/godsboss"}, "is_accepted": false, "score": 11, "last_activity_date": 1498159252, "creation_date": 1498159252, "answer_id": 44707721, "question_id": 40091142, "link": "https://stackoverflow.com/questions/40091142/is-there-an-established-pattern-name-for-golang-code-which-seems-similar-to-a-mi/44707721#44707721", "title": "Is there an established pattern name for golang code which seems similar to a mixin", "body": "<h1>TLDR</h1>\n\n<ul>\n<li>These are not mixins.</li>\n<li>Yes, Go has mixins.</li>\n</ul>\n\n<h1>Longer</h1>\n\n<p>Your example is just <strong>composition</strong> with exposed struct fields. While this is similar to mixins, it is not the same. You even gave examples for real mixins (in Go).</p>\n\n<p>I'll give one myself and tell why that can be useful.</p>\n\n<p>Let's say you want to yell at people. Then you need a <code>Yeller</code> interface. Also, in this case, we want a <code>Yell</code> function which takes a <code>Yeller</code> and uses it to yell. Here is the code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Yeller interface {\n    Yell(message string)\n}\n\nfunc Yell(m Yeller, message string) {\n    m.Yell(message)\n}\n</code></pre>\n\n<p>Who can yell? Well, people yell, so we will create one. We could of course implement the <code>Yeller</code> interface on the person directly:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Person struct {}\n\nfunc (p *Person) Yell(message string) { /* yell */ }\n\n// Let a person yell.\nperson := &amp;Person{}\nYell(person, \"No\")\n</code></pre>\n\n<p>Now <code>Person</code> is stuck to an implementation and maybe we don't want that. So, you already gave a solution:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Person struct {\n    Yeller Yeller\n}\n\nperson := &amp;Person{ /* Add some yeller to the mix here */ }\n</code></pre>\n\n<p>But now, if we want to let <code>person</code> yell, we cannot use our function directly, because <code>Person</code> does not implement <code>Yeller</code>.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// Won't work\nYell(person, \"Loud\")\n</code></pre>\n\n<p>Instead, we have to explicitly tell <code>Yell</code> to use the <code>Person</code>'s <code>Yeller</code>.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// Will work\nYell(person.Yeller, \"No\")\n</code></pre>\n\n<p>There is another possibility. We could let <code>Person</code> implement <code>Yeller</code> by passing the call to the <code>Person</code>'s <code>Yeller</code>.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func (p *Person) Yell(message string) {\n    p.Yeller.Yell(message)\n}\n\n// Will work again!\nYell(person, \"Yes\")\n</code></pre>\n\n<p>But this forces us to write a lot of boilerplate code, the method count of our mixin times the number of \"implementations\".</p>\n\n<p>We can do better by using Go's <strong>mixin</strong> facilities.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Person struct {\n    Yeller\n}\n\np := &amp;Person { /* Add some Yeller to the mix here */ }\nYell(p, \"Hooray\")\n</code></pre>\n\n<p>Now <code>Person</code> is a <code>Yeller</code>, passing the <code>Yell</code> call to the wrapped <code>Yeller</code>. No boilerplate needed.</p>\n\n<p>Why is that useful? Imagine you also want to <code>Whisper</code>, creating a <code>Whisperer</code> interface, and you want a <code>RoboticVoice</code> which also can <code>Whisper</code> and <code>Yell</code>.</p>\n\n<p>You would write analogous code and both <code>Person</code> and <code>RoboticVoice</code> could both be composed taking different implementations of <code>Yeller</code>s and <code>Whisperer</code>s.</p>\n\n<p>Last but not least, you are still able to <em>overwrite</em> behaviour by letting the structs implementing the methods themselves.</p>\n\n<p>Here is the full example code and a link to the Golang playground:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    Yell(&amp;Person{ Yeller: yeller(\"%s!!!\\n\") }, \"Nooooo\")\n    Yell(&amp;RoboticVoice{Yeller: twiceYeller(\"*** %s ***\")}, \"Oh no\")\n    Whisper(&amp;Person{ Whisperer: whisperer(\"Sssssh! %s!\\n\")}, \"...\")\n    Whisper(&amp;RoboticVoice{ Whisperer: whisperer(\"Sssssh! %s!\\n\")}, \"...\")\n}\n\ntype Yeller interface {\n    Yell(message string)\n}\n\nfunc Yell(y Yeller, message string) {\n    y.Yell(message)\n}\n\ntype Whisperer interface {\n    Whisper(message string)\n}\n\nfunc Whisper(w Whisperer, message string) {\n    w.Whisper(message)\n}\n\ntype Person struct {\n    Yeller\n    Whisperer\n}\n\ntype RoboticVoice struct {\n    Yeller\n    Whisperer\n}\n\nfunc (voice *RoboticVoice) Yell(message string) {\n    fmt.Printf(\"BEEP! \")\n    voice.Yeller.Yell(message)\n    fmt.Printf(\" BOP!\\n\")\n}\n\nfunc (voice *RoboticVoice) Whisper(message string) {\n    fmt.Printf(\"Error! Cannot whisper! %s\\n\", message)\n}\n\ntype yeller string\n\nfunc (y yeller) Yell(message string) {\n    fmt.Printf(string(y), message)\n}\n\ntype twiceYeller string\n\nfunc (twice twiceYeller) Yell(message string) {\n    fmt.Printf(string(twice+twice), message, message)\n}\n\ntype whisperer string\n\nfunc (w whisperer) Whisper(message string) {\n    fmt.Printf(string(w), message)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/MOaFBM0MzL\" rel=\"noreferrer\">Playground</a></p>\n"}], "owner": {"reputation": 106, "user_id": 4900487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6a84e616d3340cf7a0900a7d5dc949e?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/4900487/richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2776, "favorite_count": 1, "accepted_answer_id": 41655734, "answer_count": 2, "score": 2, "last_activity_date": 1514295055, "creation_date": 1476720905, "last_edit_date": 1514295055, "question_id": 40091142, "link": "https://stackoverflow.com/questions/40091142/is-there-an-established-pattern-name-for-golang-code-which-seems-similar-to-a-mi", "title": "Is there an established pattern name for golang code which seems similar to a mixin", "body": "<p>The gist <a href=\"https://gist.github.com/anonymous/68c3b072538ec48c2667f7db276e781b\" rel=\"nofollow noreferrer\">https://gist.github.com/anonymous/68c3b072538ec48c2667f7db276e781b</a> is a minimal simplified example of a repeated golang code pattern that I have encountered in an existing code base which I am trying to document.  From its usage it appears to be similar to a mixin, but neither myself or any of my colleagues have actually seen this pattern before in golang. Can anyone tell me an appropriate established name for this pattern?</p>\n\n<p>The gist attempts to illustrate:</p>\n\n<ul>\n<li>Unmodified behaviour implementation code (M's funcs) used by multiple types (A and B).</li>\n<li>Included by composition into a host type (A and B).</li>\n<li>Behaviour methods exported and accessible via a host.behaviour.method(...) call e.g. a.Formatter.FormatText(...).</li>\n<li>Host methods are acted upon by the behaviour.</li>\n<li>The behaviour holds state (private or exported) which modifies the execution of the behaviour.</li>\n<li>The type that has add a specific behaviour added can be used by a function needing that behaviour by passing the behaviour field e.g. b := NewB().Formatter.</li>\n<li>Many different behaviours can be composed into a given type (not actually shown for brevity, but you could imagine an M1, M2, M3, etc being included into A or B).</li>\n</ul>\n\n<p>It does not seem to strictly satisfy much of the definitions for a mixin as it manipulates the host object in ways that were beyond M's knowledge when it was written (potentially modifying host state) and doesn't directly add methods to the host type:</p>\n\n<ul>\n<li><a href=\"https://en.wikipedia.org/wiki/Mixin\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Mixin</a>   </li>\n<li><a href=\"https://stackoverflow.com/questions/533631/what-is-a-mixin-and-why-are-they-useful\">What is a mixin, and why are they useful?</a>    </li>\n<li><a href=\"https://stackoverflow.com/questions/925609/mixins-vs-traits/4802854#4802854\">Mixins vs. Traits</a></li>\n</ul>\n\n<p>And it doesn't seem to follow the same pattern as some self proclaimed 'golang mixins' I have found:</p>\n\n<ul>\n<li><a href=\"https://gist.github.com/haazime/270657beb140a307a559\" rel=\"nofollow noreferrer\">https://gist.github.com/haazime/270657beb140a307a559</a></li>\n<li><a href=\"https://gist.github.com/hasanozgan/2598e6abe80803e4573b\" rel=\"nofollow noreferrer\">https://gist.github.com/hasanozgan/2598e6abe80803e4573b</a></li>\n<li>Limited mixin-like behaviour by embedding (e.g. embedding sync.Mutex) <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/lFWYE8UzBCg\" rel=\"nofollow noreferrer\">https://groups.google.com/forum/#!topic/golang-nuts/lFWYE8UzBCg</a></li>\n</ul>\n"}, {"tags": ["go", "echo"], "answers": [{"comments": [{"owner": {"reputation": 286, "user_id": 5899150, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4380bc3fef16ee11788a3efea8e1cf0?s=128&d=identicon&r=PG&f=1", "display_name": "Majonsi", "link": "https://stackoverflow.com/users/5899150/majonsi"}, "edited": false, "score": 0, "creation_date": 1476720257, "post_id": 40090423, "comment_id": 67454525, "body": "Okay! but why I can&#39;t do it on one line like I tried at the beginning ?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 286, "user_id": 5899150, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4380bc3fef16ee11788a3efea8e1cf0?s=128&d=identicon&r=PG&f=1", "display_name": "Majonsi", "link": "https://stackoverflow.com/users/5899150/majonsi"}, "edited": false, "score": 2, "creation_date": 1476720801, "post_id": 40090423, "comment_id": 67454808, "body": "@Majonsi, sort of yes -- you just have to know that those <code>&gt;</code>, <code>&lt;</code>, <code>|</code> etc are interpreted by your <i>shell,</i> and the OS kernel into which <code>exec.Cmd.Run</code> shovels the process specification knows nothing about them. So one way to have that &quot;in one line&quot; is to exec <code>&#47;bin&#47;sh -c &quot;echo blah blah &gt;file.txt&quot;</code>, so that not <code>&#47;bin&#47;echo</code> is spawned but a shell which is then told to execute a specific script. The shell parses out that redirection from the script and arrange for them to happen."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 286, "user_id": 5899150, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4380bc3fef16ee11788a3efea8e1cf0?s=128&d=identicon&r=PG&f=1", "display_name": "Majonsi", "link": "https://stackoverflow.com/users/5899150/majonsi"}, "edited": false, "score": 2, "creation_date": 1476720990, "post_id": 40090423, "comment_id": 67454922, "body": "@Majonsi, please note that while that would work, you have to think <i>thrice</i> (or more) before treading that route: as soon as you need to encode some data which might contain single or double quotes or redirection symbols or whatnot you enter the quoting hell. Much worse is the situation when you need to pass to the command you&#39;re executing some data acquired from the user: you will <i>have to</i> protect it properly from being interpreted by the shell, and that means wandering through that quoting hell being chest-deep in it. Better don&#39;t, really."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 286, "user_id": 5899150, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4380bc3fef16ee11788a3efea8e1cf0?s=128&d=identicon&r=PG&f=1", "display_name": "Majonsi", "link": "https://stackoverflow.com/users/5899150/majonsi"}, "edited": false, "score": 0, "creation_date": 1476721140, "post_id": 40090423, "comment_id": 67455013, "body": "@Majonsi, In your particular case, the code by Tyler could have been wrapped into a single function. If you want this stuff be more flexibe, better use a special battle-tested library for this: <a href=\"https://labix.org/pipe\" rel=\"nofollow noreferrer\">labix.org/pipe</a>"}, {"owner": {"reputation": 286, "user_id": 5899150, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4380bc3fef16ee11788a3efea8e1cf0?s=128&d=identicon&r=PG&f=1", "display_name": "Majonsi", "link": "https://stackoverflow.com/users/5899150/majonsi"}, "edited": false, "score": 0, "creation_date": 1476721230, "post_id": 40090423, "comment_id": 67455058, "body": "Okay! Thanks for the great explanation and solution. Can you post your answer in order to accept it as a solution?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 286, "user_id": 5899150, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4380bc3fef16ee11788a3efea8e1cf0?s=128&d=identicon&r=PG&f=1", "display_name": "Majonsi", "link": "https://stackoverflow.com/users/5899150/majonsi"}, "edited": false, "score": 0, "creation_date": 1476721333, "post_id": 40090423, "comment_id": 67455125, "body": "@Majonsi, thanks. I think this answer is <i>the</i> one to be accepted. If its author wishes, they could incorporate my commends into an edit. But I think it&#39;s fine as it&#39;s stands: comments meant to expand the answer, and so they do here :-)"}, {"owner": {"reputation": 2273, "user_id": 6020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f0a9f540105e654ef7d03edc36ad3a?s=128&d=identicon&r=PG", "display_name": "BJ Black", "link": "https://stackoverflow.com/users/6020403/bj-black"}, "edited": false, "score": 0, "creation_date": 1476752727, "post_id": 40090423, "comment_id": 67468428, "body": "Let me more emphatically reiterate @kostik &#39;s note about quoting.  Always ALWAYS use list form/exec() form call outs to external commands and avoid the shell if there&#39;s a variable within 50 lines.  It&#39;s super hard to get right and it&#39;s a wellspring of shell injection attacks (very bad ones) if you get it wrong."}], "tags": [], "owner": {"reputation": 15349, "user_id": 2282538, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0a4fff09f1f0e3360daeabb30c2c06bb?s=128&d=identicon&r=PG", "display_name": "Tyler", "link": "https://stackoverflow.com/users/2282538/tyler"}, "is_accepted": true, "score": 6, "last_activity_date": 1476718525, "creation_date": 1476718525, "answer_id": 40090423, "question_id": 40090351, "link": "https://stackoverflow.com/questions/40090351/echo-command-in-golang/40090423#40090423", "title": "Echo command in Golang", "body": "<p>You can redirect the stdout like this:</p>\n\n<pre><code>// Remove the redirect from command\ncmd := exec.Command(\"echo\", \"\\\"foo 0x50\\\"\")\n\n// Make test file\ntestFile, err := os.Create(\"test.txt\")\nif err != nil {\n    panic(err)\n}\ndefer outfile.Close()\n\n// Redirect the output here (this is the key part)\ncmd.Stdout = testFile\n\nerr = cmd.Start(); if err != nil {\n    panic(err)\n}\ncmd.Wait()\n</code></pre>\n"}], "owner": {"reputation": 286, "user_id": 5899150, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4380bc3fef16ee11788a3efea8e1cf0?s=128&d=identicon&r=PG&f=1", "display_name": "Majonsi", "link": "https://stackoverflow.com/users/5899150/majonsi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3050, "favorite_count": 0, "accepted_answer_id": 40090423, "answer_count": 1, "score": 4, "last_activity_date": 1521026732, "creation_date": 1476718289, "last_edit_date": 1521026732, "question_id": 40090351, "link": "https://stackoverflow.com/questions/40090351/echo-command-in-golang", "title": "Echo command in Golang", "body": "<p>I'm currently trying to execute a simple echo command in Golang on Linux. My code is the following:</p>\n\n<pre><code>cmd = exec.Command(\"echo\", \"\\\"foo 0x50\\\"\", \"&gt;\", \"test.txt\")\n\n_, err = cmd.Output()\n\nif err != nil {\n    fmt.Println(err)\n}\n</code></pre>\n\n<p>But  test.txt doesn't appear in my folder (even after compile and run the code). That not the first that that I use this method to execute commands and I never thought that I will be block on an echo command.</p>\n\n<p>So how can I fix this code in order to have \"foo 0x50\" (with the quotes) in the test.txt?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1476716391, "post_id": 40089613, "comment_id": 67451933, "body": "Stop using <code>ab</code>. It&#39;s still <code>http&#47;1.0</code>, and not fast enough to give meaningful results with a server setup like this (not that a &quot;hello world&quot; http server is meaningful to test anyway)."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476716595, "post_id": 40089613, "comment_id": 67452097, "body": "can you recommend any suitable alternative ? thanks"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476717092, "post_id": 40089613, "comment_id": 67452430, "body": "<code>wrk</code> is usually adequate, but it still doesn&#39;t do constant rate requests which is needed to prevent the &quot;coordinated commission problem&quot;. I&#39;ve seen some new ones with constant rate features, <a href=\"https://github.com/tsenart/vegeta\" rel=\"nofollow noreferrer\">vegeta</a> and <a href=\"https://github.com/rakyll/hey\" rel=\"nofollow noreferrer\">hey  (nee boom)</a>, but can&#39;t comment on their usefulness yet."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476719317, "post_id": 40089613, "comment_id": 67453947, "body": "@mh-cbon: Sorry, I didn&#39;t scroll enough to see the <code>MaxIdleConnsPerHost</code>. You can profile the code, but this might just be from the fact that a full http reverse proxy has a lot more to do than a server just writing out a small static response."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476719610, "post_id": 40089613, "comment_id": 67454134, "body": "@JimB, no problem, i m grateful you helped. Its just the drop seems much stronger than i would expect. I think i m misdoing something, but i m not clear what."}], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1476716624, "creation_date": 1476716058, "question_id": 40089613, "link": "https://stackoverflow.com/questions/40089613/newsinglehostreverseproxy-is-10-times-slower", "title": "NewSingleHostReverseProxy is 10 times slower", "body": "<p>I have this very simple RP demo <a href=\"https://play.golang.org/p/Dq-HQj84ol\" rel=\"nofollow\">here</a> which looks like to be slower than it should be.</p>\n\n<p>Here is an <code>ab</code> result made on the RP,</p>\n\n<pre><code>ab -q -k -n 20000 -c 100 http://localhost:8080/home\nThis is ApacheBench, Version 2.3 &lt;$Revision: 1748469 $&gt;\nCopyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/\nLicensed to The Apache Software Foundation, http://www.apache.org/\n\nBenchmarking localhost (be patient).....done\n\n\nServer Software:        \nServer Hostname:        localhost\nServer Port:            8080\n\nDocument Path:          /home\nDocument Length:        0 bytes\n\nConcurrency Level:      100\nTime taken for tests:   4.842 seconds\nComplete requests:      20000\nFailed requests:        0\nKeep-Alive requests:    0\nTotal transferred:      4360000 bytes\nHTML transferred:       0 bytes\nRequests per second:    4130.48 [#/sec] (mean)\nTime per request:       24.210 [ms] (mean)\nTime per request:       0.242 [ms] (mean, across all concurrent requests)\nTransfer rate:          879.34 [Kbytes/sec] received\n\nConnection Times (ms)\n              min  mean[+/-sd] median   max\nConnect:        0    1   0.9      0      10\nProcessing:     1   24   9.5     22      90\nWaiting:        1   23   9.4     22      90\nTotal:          1   24   9.5     23      90\nWARNING: The median and mean for the initial connection time are not within a normal deviation\n        These results are probably not that reliable.\n\nPercentage of the requests served within a certain time (ms)\n  50%     23\n  66%     26\n  75%     29\n  80%     31\n  90%     36\n  95%     42\n  98%     49\n  99%     54\n 100%     90 (longest request)\n</code></pre>\n\n<p>When i performance test the backend it can do 40k qps.</p>\n\n<p>I feel like the RP could be way faster, but i m not sure how nor why it is showing the current results.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["html", "go"], "comments": [{"owner": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "edited": false, "score": 0, "creation_date": 1476715440, "post_id": 40088935, "comment_id": 67451221, "body": "Which framework do you use?"}, {"owner": {"reputation": 191, "user_id": 7031503, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c5cd31a357740a46fcdf1a46912fa212?s=128&d=identicon&r=PG&f=1", "display_name": "Denis", "link": "https://stackoverflow.com/users/7031503/denis"}, "reply_to_user": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "edited": false, "score": 0, "creation_date": 1476715645, "post_id": 40088935, "comment_id": 67451393, "body": "None. I am using josephspurrier&#39;s project (<a href=\"https://github.com/josephspurrier/gowebapp/blob/master/README.md\" rel=\"nofollow noreferrer\">github.com/josephspurrier/gowebapp/blob/master/README.md</a>)"}], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 7031503, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c5cd31a357740a46fcdf1a46912fa212?s=128&d=identicon&r=PG&f=1", "display_name": "Denis", "link": "https://stackoverflow.com/users/7031503/denis"}, "edited": false, "score": 0, "creation_date": 1476719909, "post_id": 40090531, "comment_id": 67454308, "body": "Thank you, I&#39;m going to do that"}, {"owner": {"reputation": 191, "user_id": 7031503, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c5cd31a357740a46fcdf1a46912fa212?s=128&d=identicon&r=PG&f=1", "display_name": "Denis", "link": "https://stackoverflow.com/users/7031503/denis"}, "edited": false, "score": 0, "creation_date": 1476722620, "post_id": 40090531, "comment_id": 67455831, "body": "Thank you very much"}, {"owner": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "reply_to_user": {"reputation": 191, "user_id": 7031503, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c5cd31a357740a46fcdf1a46912fa212?s=128&d=identicon&r=PG&f=1", "display_name": "Denis", "link": "https://stackoverflow.com/users/7031503/denis"}, "edited": false, "score": 0, "creation_date": 1476731824, "post_id": 40090531, "comment_id": 67460720, "body": "If it&#39;s a correct answer, please mark it, so others could use it."}, {"owner": {"reputation": 191, "user_id": 7031503, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c5cd31a357740a46fcdf1a46912fa212?s=128&d=identicon&r=PG&f=1", "display_name": "Denis", "link": "https://stackoverflow.com/users/7031503/denis"}, "edited": false, "score": 0, "creation_date": 1476775576, "post_id": 40090531, "comment_id": 67475915, "body": "It seems that I don&#39;t have enough reputation to upvote your answer.. I would really like to mark your answer as a correct answser but it seems I can&#39;t.."}, {"owner": {"reputation": 191, "user_id": 7031503, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c5cd31a357740a46fcdf1a46912fa212?s=128&d=identicon&r=PG&f=1", "display_name": "Denis", "link": "https://stackoverflow.com/users/7031503/denis"}, "edited": false, "score": 0, "creation_date": 1476777171, "post_id": 40090531, "comment_id": 67476873, "body": "I have marked your answer as a correct answser, thank you again"}], "tags": [], "owner": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "is_accepted": true, "score": 0, "last_activity_date": 1476718847, "creation_date": 1476718847, "answer_id": 40090531, "question_id": 40088935, "link": "https://stackoverflow.com/questions/40088935/display-data-which-comes-from-a-golang-controller/40090531#40090531", "title": "Display data which comes from a Golang controller", "body": "<p>There's an example:</p>\n\n<p>Controller:\n<a href=\"https://github.com/josephspurrier/gowebapp/blob/master/vendor/app/controller/notepad.go\" rel=\"nofollow\">https://github.com/josephspurrier/gowebapp/blob/master/vendor/app/controller/notepad.go</a></p>\n\n<p>View: \n<a href=\"https://github.com/josephspurrier/gowebapp/blob/master/template/notepad/read.tmpl\" rel=\"nofollow\">https://github.com/josephspurrier/gowebapp/blob/master/template/notepad/read.tmpl</a></p>\n\n<pre><code>// This adds your collection to the template\nv.Vars[\"infos\"] = infos\n</code></pre>\n\n<p>In your template you iterate over your infos using range:</p>\n\n<pre><code>{{range $info := .infos}}\n</code></pre>\n\n<p>Inside range you access specific properties using {{.PropertyName}}</p>\n"}], "owner": {"reputation": 191, "user_id": 7031503, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c5cd31a357740a46fcdf1a46912fa212?s=128&d=identicon&r=PG&f=1", "display_name": "Denis", "link": "https://stackoverflow.com/users/7031503/denis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "accepted_answer_id": 40090531, "answer_count": 1, "score": 0, "last_activity_date": 1476718847, "creation_date": 1476714174, "last_edit_date": 1476717031, "question_id": 40088935, "link": "https://stackoverflow.com/questions/40088935/display-data-which-comes-from-a-golang-controller", "title": "Display data which comes from a Golang controller", "body": "<p>I am new to Go language. I work on a Basic MVC Web Application in Go (josephspurrier's project on <a href=\"https://github.com/josephspurrier/gowebapp/blob/master/README.md\" rel=\"nofollow\">https://github.com/josephspurrier/gowebapp/blob/master/README.md</a>). I have a controller which consumes a REST web service:</p>\n\n<pre><code>func InfoGET(w http.ResponseWriter, r *http.Request) {\n     var infos []model.Info\n     //call web service and get data\n     infos, err := ws.GetAllInfos(\"tho\")\n     if(err != nil) {\n      log.Println(err)\n     }\n     v := view.New(r)\n     v.Name = \"infos/info\"\n     v.Render(w)\n}\n</code></pre>\n\n<p>I want to display the data I have gotten thanks to the webservice (displaying them in a datatable would be great I think). What do I have to write in my .tmpl file in order to achieve this?</p>\n"}, {"tags": ["go", "go-templates"], "answers": [{"tags": [], "owner": {"reputation": 48731, "user_id": 329700, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/41910a452554b187d044c00c576866b1?s=128&d=identicon&r=PG", "display_name": "Kevin Burke", "link": "https://stackoverflow.com/users/329700/kevin-burke"}, "is_accepted": false, "score": 0, "last_activity_date": 1480620534, "last_edit_date": 1480620534, "creation_date": 1476724417, "answer_id": 40092104, "question_id": 40088913, "link": "https://stackoverflow.com/questions/40088913/catch-error-in-niladic-function-in-go-text-template-and-continue-execution/40092104#40092104", "title": "&quot;Catch&quot; error in niladic function in Go text/template and continue execution", "body": "<p>Here's my very hacky answer, which Calls a method on the internal struct, and then returns \"redacted\" if you get back a specific error.</p>\n\n<pre><code>// Call calls the given method name on a Message. If the result is\n// a PermissionDenied error, return the string \"[redacted]\" and no error.\n//\n// This should be used by templates to redact methods. It would be nicer to\n// just call the Message directly, but returning an error from a niladic method\n// immediately halts template execution, so we need this wrapper around the\n// function behavior.\nfunc (r *RedactedMessage) Call(mname string) (interface{}, error) {\n    if mname == \"\" {\n        return nil, errors.New(\"Call() with empty string\")\n    }\n    for _, char := range mname {\n        if !unicode.IsUpper(char) {\n            return nil, errors.New(\"Cannot call private method\")\n        }\n        // only check first character\n        break\n    }\n    t := reflect.ValueOf(r.mv)\n    m := t.MethodByName(mname)\n    if !m.IsValid() {\n        return nil, fmt.Errorf(\"Invalid method: %s\", mname)\n    }\n    vals := m.Call([]reflect.Value{})\n    if len(vals) != 2 {\n        return nil, fmt.Errorf(\"Expected to get two values back, got %d\", len(vals))\n    }\n    if vals[1].IsNil() {\n        return vals[0].Interface(), nil\n    }\n    if reflect.DeepEqual(vals[1].Interface(), config.PermissionDenied) {\n        return \"redacted\", nil\n    }\n    return nil, vals[1].Interface().(error)\n}\n</code></pre>\n"}], "owner": {"reputation": 48731, "user_id": 329700, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/41910a452554b187d044c00c576866b1?s=128&d=identicon&r=PG", "display_name": "Kevin Burke", "link": "https://stackoverflow.com/users/329700/kevin-burke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 704, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1480620534, "creation_date": 1476714103, "last_edit_date": 1476732451, "question_id": 40088913, "link": "https://stackoverflow.com/questions/40088913/catch-error-in-niladic-function-in-go-text-template-and-continue-execution", "title": "&quot;Catch&quot; error in niladic function in Go text/template and continue execution", "body": "<p>If I have a struct with a function like this:</p>\n\n<pre><code>type data struct{}\n\nfunc (d *data) Foo() (string, error) {\n    return \"\", errors.New(\"bad\")\n}\n</code></pre>\n\n<p>And I call <code>.Foo</code> in a template, like this:</p>\n\n<pre><code>{{ .Foo }}\n</code></pre>\n\n<p>I get an error:</p>\n\n<pre><code>error calling Foo: bad\n</code></pre>\n\n<p>This is in line with the documentation for <code>text/template</code>:</p>\n\n<blockquote>\n  <ul>\n  <li>The name of a niladic method of the data, preceded by a period,   such as\n  .Method   The result is the value of invoking the method with dot as the   receiver, dot.Method(). Such a method must have one return\n  value (of   any type) or two return values, the second of which is an\n  error.   If it has two and the returned error is non-nil, execution\n  terminates   and an error is returned to the caller as the value of\n  Execute.</li>\n  </ul>\n</blockquote>\n\n<p>Can I define a function to \"catch\" that error and return some default message, instead of halting execution? For example:</p>\n\n<pre><code>func Catch(val string, err error) string {\n    if err != nil {\n        return \"[render error]\"\n    } else {\n        return val\n    }\n}\n</code></pre>\n\n<p>Then:</p>\n\n<pre><code>map := template.FuncMap{\"catch\": Catch}\ntpl := template.Must(template.New(\"t\").Funcs(map).Parse(`\n    {{ .Foo | catch }}\n`))\nb := new(bytes.Buffer)\nerr := tpl.Execute(b, &amp;data{})\n</code></pre>\n\n<p>That currently renders an error - is there a way to get it to work?</p>\n"}, {"tags": ["go", "types", "alias"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1476708804, "post_id": 40086749, "comment_id": 67446211, "body": "Don&#39;t try to write Go like OO languages with inheritance. There is <i>no</i> inheritance, so you&#39;re only going to create more confusion. If you want to automatically delegate methods and fields, you can use embedding like in your second example, which is just fine, but keep in mind that&#39;s only a form of composition."}, {"owner": {"reputation": 442, "user_id": 5935455, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/LKtm8.jpg?s=128&g=1", "display_name": "Adrien Luxey", "link": "https://stackoverflow.com/users/5935455/adrien-luxey"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476709073, "post_id": 40086749, "comment_id": 67446394, "body": "So, your advice is using the original set.Set type as is? Since using set&#39;s functions is so cumbersome with the embedded type? It&#39;s not so bad, I just dived straight into inheritance before thinking of what I was doing."}, {"owner": {"reputation": 3824, "user_id": 2728768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bb82b13cda86d3b821fa44100335ddf?s=128&d=identicon&r=PG", "display_name": "thoeni", "link": "https://stackoverflow.com/users/2728768/thoeni"}, "edited": false, "score": 2, "creation_date": 1476709118, "post_id": 40086749, "comment_id": 67446428, "body": "If you&#39;re interested, there&#39;s a good article here on the topic by William Kennedy: <a href=\"https://www.goinggo.net/2016/10/reducing-type-hierarchies.html\" rel=\"nofollow noreferrer\">goinggo.net/2016/10/reducing-type-hierarchies.html</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476709250, "post_id": 40086749, "comment_id": 67446530, "body": "@AdrienLuxey: yes, just use the set type directly if that&#39;s what you want. You would have to show an example of the problems you had with embedding, since it&#39;s not changing any behavior of <code>set.Set</code> at all."}, {"owner": {"reputation": 442, "user_id": 5935455, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/LKtm8.jpg?s=128&g=1", "display_name": "Adrien Luxey", "link": "https://stackoverflow.com/users/5935455/adrien-luxey"}, "reply_to_user": {"reputation": 3824, "user_id": 2728768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bb82b13cda86d3b821fa44100335ddf?s=128&d=identicon&r=PG", "display_name": "thoeni", "link": "https://stackoverflow.com/users/2728768/thoeni"}, "edited": false, "score": 0, "creation_date": 1476712941, "post_id": 40086749, "comment_id": 67449386, "body": "@thoeni Thanks for the tutorial, I&#39;m on it :) And thanks JimB for the precisions, I&#39;ll do as told! Go is quite braintwisting, for the neophyte... I&#39;ll make it!"}], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 2279313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b28b7fd3a1e5e32cd810299d454a7365?s=128&d=identicon&r=PG", "display_name": "smulube", "link": "https://stackoverflow.com/users/2279313/smulube"}, "is_accepted": false, "score": 3, "last_activity_date": 1499295312, "creation_date": 1499295312, "answer_id": 44937249, "question_id": 40086749, "link": "https://stackoverflow.com/questions/40086749/can-i-create-an-alias-of-a-type-in-golang/44937249#44937249", "title": "Can I create an alias of a type in Golang?", "body": "<p>Note, I think the simple aliasing you proposed initially is syntactically valid though having had a quick look at the set library, rather than aliasing <code>set.Set</code> it might make more sense to alias <code>set.Interface</code>, e.g.:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n\n  set \"gopkg.in/fatih/set.v0\"\n)\n\n// View is a type alias for the set.Interface interface\ntype View set.Interface\n\n// Display takes one of our View types in order to print it.\nfunc Display(view View) {\n  fmt.Println(view.List())\n}\n\nfunc main() {\n  // create our first set.Interface or View\n  v1 := set.New()\n  v1.Add(\"foo\")\n\n  // create our second set.Interface or View\n  v2 := set.New(\"bar\")\n\n  // call a set function\n  v3 := set.Union(v1, v2)\n\n  // call our function that takes a View\n  Display(v3)\n}\n</code></pre>\n\n<p>You may have noticed I'm cheating somehow because I make no real mention of the aliased type in the above code other than in defining the parameter to the <code>Display</code> function above which you'll note takes in a <code>View</code> instance rather than a <code>set.Interface</code>. If you have lots of functions working on these things, then that might read more expressively for your domain.</p>\n\n<p>Note that because our <code>View</code> type is an alias to an interface type, it precludes adding your own functions to that type as Go doesn't allow us to have an interface receiver type for a function (I might be expressing that incorrectly). By this I mean that you can't do anything like:</p>\n\n<pre><code>func (v View) Display() string {\n  return v.String()\n}\n</code></pre>\n\n<p>In summary I think aliasing things is fine, it can make internal APIs more readable, and you can lean on the compiler to help eliminate certain classes of errors; however this doesn't allow you to add functionality to the custom type. If this is required an alternate approach would be necessary, either embedding or simple composition (i.e. a <code>View</code> has a <code>Set</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 2620, "user_id": 6489829, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a56125658a5592143ade081194b89d6f?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Gore", "link": "https://stackoverflow.com/users/6489829/jack-gore"}, "is_accepted": true, "score": 37, "last_activity_date": 1507939925, "creation_date": 1507939925, "answer_id": 46739525, "question_id": 40086749, "link": "https://stackoverflow.com/questions/40086749/can-i-create-an-alias-of-a-type-in-golang/46739525#46739525", "title": "Can I create an alias of a type in Golang?", "body": "<p>If anyone else is coming back to this question, as of <a href=\"https://blog.golang.org/go1.9\" rel=\"noreferrer\">Go 1.9</a> type aliases are now supported.</p>\n\n<p>A type alias has the form: <code>type T1 = T2</code></p>\n\n<p>So in your example you can just do <code>type View = set.Set</code> and everything will work as you want.</p>\n"}], "owner": {"reputation": 442, "user_id": 5935455, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/LKtm8.jpg?s=128&g=1", "display_name": "Adrien Luxey", "link": "https://stackoverflow.com/users/5935455/adrien-luxey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12089, "favorite_count": 2, "accepted_answer_id": 46739525, "answer_count": 2, "score": 19, "last_activity_date": 1507939925, "creation_date": 1476708333, "question_id": 40086749, "link": "https://stackoverflow.com/questions/40086749/can-i-create-an-alias-of-a-type-in-golang", "title": "Can I create an alias of a type in Golang?", "body": "<p>I'm struggling with my learning of Go.</p>\n\n<p>I found this neat implementation of a Set in go: <a href=\"https://github.com/fatih/set\" rel=\"noreferrer\">gopkg.in/fatih/set.v0</a>, but I'd prefer naming my sets with a more explicit name that <code>set.Set</code>, doing something like:</p>\n\n<pre><code>type View set.Set\n</code></pre>\n\n<p>In essence, I want my <code>View</code> type to inherit <code>set.Set</code>'s methods. Because, well, <code>View</code> <strong>is a</strong> <code>set.Set</code> of descriptors. But I know Go is pretty peaky on inheritance, and typing in general.</p>\n\n<p>For now I've been trying the following <em>kinda</em> inheritance, but it's causing loads of errors when trying to use some functions like <code>func Union(set1, set2 Interface, sets ...Interface) Interface</code> or <code>func (s *Set) Merge(t Interface)</code>:</p>\n\n<pre><code>type View struct {\n    set.Set\n}\n</code></pre>\n\n<p>I'd like to know if there's a way to achieve what I want in a Go-like way, or if I'm just trying to apply my good-ol' OO practices to a language that discards them, please.</p>\n"}, {"tags": ["go", "x509"], "comments": [{"owner": {"reputation": 4231, "user_id": 1343321, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/20d625be6a7f95fd700dd975e4167848?s=128&d=identicon&r=PG", "display_name": "Depado", "link": "https://stackoverflow.com/users/1343321/depado"}, "edited": false, "score": 0, "creation_date": 1476700170, "post_id": 40083829, "comment_id": 67440520, "body": "Maybe have a look at this package : <a href=\"https://golang.org/pkg/crypto/x509/\" rel=\"nofollow noreferrer\">golang.org/pkg/crypto/x509</a> Hope that helps."}, {"owner": {"reputation": 263, "user_id": 3017532, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1193917893/picture?type=large", "display_name": "MrReboot", "link": "https://stackoverflow.com/users/3017532/mrreboot"}, "reply_to_user": {"reputation": 4231, "user_id": 1343321, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/20d625be6a7f95fd700dd975e4167848?s=128&d=identicon&r=PG", "display_name": "Depado", "link": "https://stackoverflow.com/users/1343321/depado"}, "edited": false, "score": 0, "creation_date": 1476701143, "post_id": 40083829, "comment_id": 67441178, "body": "Yes, I have already seen that class but i&#39;m getting a format error when I use ParseCertificates. Maybe the problem is that I&#39;m not able to generate the byte slice from the string correctly"}, {"owner": {"reputation": 4231, "user_id": 1343321, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/20d625be6a7f95fd700dd975e4167848?s=128&d=identicon&r=PG", "display_name": "Depado", "link": "https://stackoverflow.com/users/1343321/depado"}, "edited": false, "score": 0, "creation_date": 1476707309, "post_id": 40083829, "comment_id": 67445165, "body": "Could you provide more details ? How are you converting your string byte slice ? Could you provide more code and show what you tried/failed to use ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476708020, "post_id": 40083829, "comment_id": 67445644, "body": "@MrReboot, You can directly convert a string to a bytes slice, there&#39;s not really an &quot;incorrect&quot; way to do it. Please show an example of the problem you&#39;re having, with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 3824, "user_id": 2728768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bb82b13cda86d3b821fa44100335ddf?s=128&d=identicon&r=PG", "display_name": "thoeni", "link": "https://stackoverflow.com/users/2728768/thoeni"}, "edited": false, "score": 0, "creation_date": 1476709851, "post_id": 40083829, "comment_id": 67446955, "body": "Does any of these examples help you? <a href=\"https://golang.org/src/crypto/x509/example_test.go\" rel=\"nofollow noreferrer\">golang.org/src/crypto/x509/example_test.go</a>"}, {"owner": {"reputation": 263, "user_id": 3017532, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1193917893/picture?type=large", "display_name": "MrReboot", "link": "https://stackoverflow.com/users/3017532/mrreboot"}, "edited": false, "score": 0, "creation_date": 1476719169, "post_id": 40083829, "comment_id": 67453856, "body": "I think my problem is parsing the hex string into the byte slice. This is what i need in go:  <a href=\"http://stackoverflow.com/questions/140131/convert-a-string-representation-of-a-hex-dump-to-a-byte-array-using-java?rq=1\" title=\"convert a string representation of a hex dump to a byte array using java\">stackoverflow.com/questions/140131/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 263, "user_id": 3017532, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1193917893/picture?type=large", "display_name": "MrReboot", "link": "https://stackoverflow.com/users/3017532/mrreboot"}, "is_accepted": true, "score": 3, "last_activity_date": 1476773033, "creation_date": 1476773033, "answer_id": 40101270, "question_id": 40083829, "link": "https://stackoverflow.com/questions/40083829/parsing-a-certificate-string-in-go/40101270#40101270", "title": "Parsing a certificate string in go", "body": "<p>I found the error. The problem was in the source.\nAs I was explaining, my cert string was \"30 82 06 09...\". This source must be decoded with:</p>\n\n<pre><code>hex.DecodeString(certStr)\n</code></pre>\n\n<p>The problem is that hex decoding doesn't work with this format. The error I obtained was:</p>\n\n<pre><code>encoding/hex: invalid byte: U+0020 ' '\n</code></pre>\n\n<p>So, removing whitespaces and carriage returns in the original string is the solution to make it work.</p>\n\n<p>After decoding in a byte slice the X509 certificate can be created with no problem.</p>\n"}], "owner": {"reputation": 263, "user_id": 3017532, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1193917893/picture?type=large", "display_name": "MrReboot", "link": "https://stackoverflow.com/users/3017532/mrreboot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3565, "favorite_count": 0, "accepted_answer_id": 40101270, "answer_count": 1, "score": 3, "last_activity_date": 1476773033, "creation_date": 1476699611, "last_edit_date": 1476710051, "question_id": 40083829, "link": "https://stackoverflow.com/questions/40083829/parsing-a-certificate-string-in-go", "title": "Parsing a certificate string in go", "body": "<p>I'm using ssldump to extract the certificate in a communication. When i parse the result I obtain a string in go defined as:</p>\n\n<pre><code>var string certStr\ncertStr = \"30 82 06 9f....\"\n</code></pre>\n\n<p>How can I parse it to a X509 certificate?</p>\n\n<p><strong>UPDATED</strong></p>\n\n<p>I have tried to parse it directly:</p>\n\n<pre><code>certSlc := []byte(certStr)\ncert,err := x509.ParseCertificates(certSlc)\n</code></pre>\n\n<p>But the result was:</p>\n\n<pre><code>Error:asn1: structure error: tags don't match (16 vs {class:0 tag:19 length:48 isCompound:true}) {optional:false explicit:false application:false defaultValue:&lt;nil&gt; tag:&lt;nil&gt; stringType:0 timeType:0 set:false omitEmpty:false}\n</code></pre>\n\n<p>Should I do another kind of conversion? maybe is the string incomplete or has got wrong type of cert?</p>\n"}, {"tags": ["go", "utf-8"], "comments": [{"owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "edited": false, "score": 0, "creation_date": 1476696843, "post_id": 40082833, "comment_id": 67438419, "body": "<a href=\"https://blog.golang.org/strings\" rel=\"nofollow noreferrer\">blog.golang.org/strings</a>"}], "answers": [{"comments": [{"owner": {"reputation": 399, "user_id": 6926514, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c42d56e0e17ee20ffaa03a0c89c0d17?s=128&d=identicon&r=PG&f=1", "display_name": "shagul", "link": "https://stackoverflow.com/users/6926514/shagul"}, "edited": false, "score": 0, "creation_date": 1476698806, "post_id": 40083228, "comment_id": 67439690, "body": "i&#39;m sorry ,i meant it in wrongly ,actually i want to encode json data in UTF-8 format"}, {"owner": {"reputation": 1, "user_id": 7027522, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ZbB8.png?s=128&g=1", "display_name": "Jakubowsky", "link": "https://stackoverflow.com/users/7027522/jakubowsky"}, "reply_to_user": {"reputation": 399, "user_id": 6926514, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c42d56e0e17ee20ffaa03a0c89c0d17?s=128&d=identicon&r=PG&f=1", "display_name": "shagul", "link": "https://stackoverflow.com/users/6926514/shagul"}, "edited": false, "score": 0, "creation_date": 1476699110, "post_id": 40083228, "comment_id": 67439886, "body": "Then better post another question"}, {"owner": {"reputation": 1, "user_id": 7027522, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ZbB8.png?s=128&g=1", "display_name": "Jakubowsky", "link": "https://stackoverflow.com/users/7027522/jakubowsky"}, "reply_to_user": {"reputation": 399, "user_id": 6926514, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c42d56e0e17ee20ffaa03a0c89c0d17?s=128&d=identicon&r=PG&f=1", "display_name": "shagul", "link": "https://stackoverflow.com/users/6926514/shagul"}, "edited": false, "score": 0, "creation_date": 1476699960, "post_id": 40083228, "comment_id": 67440396, "body": "@shagul use the <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal/\" rel=\"nofollow noreferrer\">Unmarshal</a> function, store the content in a struct, and all the strings will be encoded to utf8, except the invalid characters will be replaced by <code>U+FFFD</code>, and change all other datatypes to <code>String</code> with the <a href=\"https://golang.org/pkg/strconv/\" rel=\"nofollow noreferrer\">strconv</a> package."}], "tags": [], "owner": {"reputation": 1, "user_id": 7027522, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ZbB8.png?s=128&g=1", "display_name": "Jakubowsky", "link": "https://stackoverflow.com/users/7027522/jakubowsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1476697801, "creation_date": 1476697801, "answer_id": 40083228, "question_id": 40082833, "link": "https://stackoverflow.com/questions/40082833/encode-string-with-utf-8-format-in-go/40083228#40083228", "title": "Encode string with UTF-8 format in go", "body": "<p>The string literals in go are encoded in UTF-8 by default.\nFrom the <a href=\"https://blog.golang.org/strings\" rel=\"nofollow\">official golang blog</a></p>\n\n<blockquote>\n  <p>Go source code is UTF-8, so the source code for the string literal is\n  UTF-8 text</p>\n</blockquote>\n\n<p>However this doesn't apply to the escape characters, such as <code>\\n</code>:</p>\n\n<blockquote>\n  <p>If that string literal contains no escape sequences, which a raw string cannot, the constructed string will hold exactly the source text between the quotes.</p>\n</blockquote>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 399, "user_id": 6926514, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c42d56e0e17ee20ffaa03a0c89c0d17?s=128&d=identicon&r=PG&f=1", "display_name": "shagul", "link": "https://stackoverflow.com/users/6926514/shagul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2374, "favorite_count": 1, "closed_date": 1476698335, "answer_count": 1, "score": 1, "last_activity_date": 1476697801, "creation_date": 1476696603, "last_edit_date": 1476697016, "question_id": 40082833, "link": "https://stackoverflow.com/questions/40082833/encode-string-with-utf-8-format-in-go", "closed_reason": "Duplicate", "title": "Encode string with UTF-8 format in go", "body": "<p>How to convert string text to utf8 in golang (go language)? </p>\n"}, {"tags": ["go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 8720, "user_id": 6149787, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/edf1a61aa50a231d521d940d60928292?s=128&d=identicon&r=PG&f=1", "display_name": "Jagrati", "link": "https://stackoverflow.com/users/6149787/jagrati"}, "edited": false, "score": 0, "creation_date": 1476696559, "post_id": 40082761, "comment_id": 67438233, "body": "I am using type <code>Data</code>  in the package offer in so many other places also where the code is not related to parser. Is there a way I can use <code>Data</code> from  offer package in Parser Package?"}, {"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "reply_to_user": {"reputation": 8720, "user_id": 6149787, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/edf1a61aa50a231d521d940d60928292?s=128&d=identicon&r=PG&f=1", "display_name": "Jagrati", "link": "https://stackoverflow.com/users/6149787/jagrati"}, "edited": false, "score": 0, "creation_date": 1476696731, "post_id": 40082761, "comment_id": 67438351, "body": "Not without causing circular import error. You can&#39;t import <code>offer</code> into <code>Parser</code> as <code>offer</code> is already importing <code>Parser</code>. One solution is to move the type out into a third package and import that into both <code>offer</code> and <code>Parser</code>."}, {"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "reply_to_user": {"reputation": 8720, "user_id": 6149787, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/edf1a61aa50a231d521d940d60928292?s=128&d=identicon&r=PG&f=1", "display_name": "Jagrati", "link": "https://stackoverflow.com/users/6149787/jagrati"}, "edited": false, "score": 0, "creation_date": 1476696893, "post_id": 40082761, "comment_id": 67438456, "body": "Also, you can still use <code>Data</code> in <code>offer</code>. Just use <code>Parser.Data</code> everywhere in <code>offer</code> and remove <code>Data</code> from <code>offer</code>. They are still the same structures so unless you have methods defined on the type, it shouldn&#39;t matter."}, {"owner": {"reputation": 8720, "user_id": 6149787, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/edf1a61aa50a231d521d940d60928292?s=128&d=identicon&r=PG&f=1", "display_name": "Jagrati", "link": "https://stackoverflow.com/users/6149787/jagrati"}, "edited": false, "score": 0, "creation_date": 1476696957, "post_id": 40082761, "comment_id": 67438488, "body": "yes I know that.  I actually tried importing offer to parser. I thought if there might be any other solution. Anyway thanks."}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": true, "score": 1, "last_activity_date": 1476696380, "creation_date": 1476696380, "answer_id": 40082761, "question_id": 40082647, "link": "https://stackoverflow.com/questions/40082647/unable-to-pass-struct-type-argument-to-a-function-in-another-package/40082761#40082761", "title": "Unable to pass struct type argument to a function in another package", "body": "<p>Why do you have <code>Data</code> defined in two packages? If you need the exact same structure, just have it in one package. If you leave it in <code>parser</code>, you can do something like:</p>\n\n<pre><code>package offer\n\nimport \"go_tests/Parser\"\n\ncart := make(map[int]Parser.Data)\n//cart has some data in it\n//passing it to parser\nParser.BXATP(offer_id, rule.Description, cart, warehouseId)\n</code></pre>\n\n<p>Types defined in separate packages are different even if they share name and underlying structure. So <code>Parser.Data</code> is not compatible with <code>offer.Data</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "is_accepted": false, "score": 1, "last_activity_date": 1476699000, "creation_date": 1476699000, "answer_id": 40083618, "question_id": 40082647, "link": "https://stackoverflow.com/questions/40082647/unable-to-pass-struct-type-argument-to-a-function-in-another-package/40083618#40083618", "title": "Unable to pass struct type argument to a function in another package", "body": "<p>You need to assign every single struct field to another struct field, see example:</p>\n\n<pre><code>package parser\n\nimport \"./offer\"\n\ntype Data struct {\n    Id       int\n    Quantity int\n    Mrp      float64\n    Discount float64\n}\n func main(){\n\n     offer_data := &amp;offer.Data{} \n\n     parser_data :=  &amp;Data{\n         Id: offer_data.Id,\n         Quantity: offer_data.Quantity,\n         Mrp: offer_data.Mrp,\n         Discount: offer_data.Discount,\n     }\n }\n</code></pre>\n"}], "owner": {"reputation": 8720, "user_id": 6149787, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/edf1a61aa50a231d521d940d60928292?s=128&d=identicon&r=PG&f=1", "display_name": "Jagrati", "link": "https://stackoverflow.com/users/6149787/jagrati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 962, "favorite_count": 1, "accepted_answer_id": 40082761, "answer_count": 2, "score": 0, "last_activity_date": 1476699000, "creation_date": 1476696075, "last_edit_date": 1495541204, "question_id": 40082647, "link": "https://stackoverflow.com/questions/40082647/unable-to-pass-struct-type-argument-to-a-function-in-another-package", "title": "Unable to pass struct type argument to a function in another package", "body": "<p>I have two packages: offer.go and parser.go. I have a variable <code>cart</code> of type struct <code>Data</code>. I want to pass it as an argument to a function which is in another package <code>parser</code>. However I am not able to do that. Please look into the following: </p>\n\n<p>offer.go</p>\n\n<pre><code>package offer\n\nimport \"go_tests/Parser\"\n\ntype Data struct {\n    Id       int\n    Quantity int\n    Mrp      float64\n    Discount float64\n}\ncart := make(map[int]Data)\n//cart has some data in it\n//passing it to parser\nParser.BXATP(offer_id, rule.Description, cart, warehouseId)\n</code></pre>\n\n<p>parser.go</p>\n\n<pre><code>package Parser\n\ntype Data struct {\n    Id       int\n    Quantity int\n    Mrp      float64\n    Discount float64\n}\n\nfunc BXATP(offer_id int, rule string, cart map[int]Data, warehouseId int){\n //my code is here\n}\n</code></pre>\n\n<p>However running this, gives me following error:</p>\n\n<pre><code> cannot use cart (type map[int]Data) as type map[int]Parser.Data in argument to Parser.BXATP\n</code></pre>\n\n<p>I found this link but the solution doesn't seem to work in my case:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/29657109/why-passing-struct-to-function-with-literal-struct-parameter-from-current-packag\">Why passing struct to function with literal struct parameter from current package differs from the same for function from another package?</a></p>\n\n<p>I change the parser to :</p>\n\n<pre><code>func BXATP(offer_id int, rule string, cart map[int]struct {\n    Id       int\n    Quantity int\n    Mrp      float64\n    Discount float64\n}, warehouseId int)\n</code></pre>\n\n<p>But now error is :</p>\n\n<pre><code> cannot use cart (type map[int]Data) as type map[int]struct { Id int; Quantity int; Mrp float64; Discount float64 } in argument to Parser.BXATP\n</code></pre>\n\n<p>I don't understand how to achieve this. Any help will be appreciated.</p>\n"}, {"tags": ["javascript", "go", "iife"], "answers": [{"comments": [{"owner": {"reputation": 1094, "user_id": 3813210, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/be8dba99b54c433c5b8cf8f628817609?s=128&d=identicon&r=PG&f=1", "display_name": "user162097", "link": "https://stackoverflow.com/users/3813210/user162097"}, "edited": false, "score": 1, "creation_date": 1476694156, "post_id": 40082016, "comment_id": 67436779, "body": "Oh, of course, that&#39;s obvious now, I can&#39;t believe I missed that! Thanks for the help anyway, upvoted and accepted."}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": true, "score": 7, "last_activity_date": 1476694100, "creation_date": 1476694100, "answer_id": 40082016, "question_id": 40081996, "link": "https://stackoverflow.com/questions/40081996/passing-argument-to-go-iife-following-javascript-example/40082016#40082016", "title": "Passing argument to Go IIFE (following javascript example)", "body": "<p>Function arguments in Go need types. So do the following:</p>\n\n<pre><code>func(twoSeconds time.Duration) {\n    // use twoSeconds\n}(time.Second * 2)\n</code></pre>\n"}], "owner": {"reputation": 1094, "user_id": 3813210, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/be8dba99b54c433c5b8cf8f628817609?s=128&d=identicon&r=PG&f=1", "display_name": "user162097", "link": "https://stackoverflow.com/users/3813210/user162097"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 519, "favorite_count": 0, "accepted_answer_id": 40082016, "answer_count": 1, "score": 2, "last_activity_date": 1476714434, "creation_date": 1476694022, "last_edit_date": 1476714434, "question_id": 40081996, "link": "https://stackoverflow.com/questions/40081996/passing-argument-to-go-iife-following-javascript-example", "title": "Passing argument to Go IIFE (following javascript example)", "body": "<p>I'm used to programming in javascript where I can do the following to pass an argument into an immediately-invoked function expression:</p>\n\n<pre><code>(function(twoSeconds) {\n    // do something with \"twoSeconds\" here\n})(2 * 1000);\n</code></pre>\n\n<p>So I expected to be able to do something similar in Go, as below. However, it doesn't seem to work.</p>\n\n<pre><code>func (twoSeconds) {\n    // build error: \"twoSeconds\" undefined\n}(time.Second * 2)\n</code></pre>\n\n<p>So I have to do this instead:</p>\n\n<pre><code>func () {\n    twoSeconds := time.Second * 2\n}()\n</code></pre>\n\n<p>Therefore, my question is how can I pass an argument into a Go IIFE? And if it's not possible, why not?</p>\n"}, {"tags": ["go", "swagger", "go-swagger"], "answers": [{"comments": [{"owner": {"reputation": 2308, "user_id": 1163428, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Dr7gs.jpg?s=128&g=1", "display_name": "Mr_Hmp", "link": "https://stackoverflow.com/users/1163428/mr-hmp"}, "edited": false, "score": 0, "creation_date": 1599815541, "post_id": 45231375, "comment_id": 112897299, "body": "-b is not a valid flag"}], "tags": [], "owner": {"reputation": 820, "user_id": 272787, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/HadKK.jpg?s=128&g=1", "display_name": "Anton Sergeyev", "link": "https://stackoverflow.com/users/272787/anton-sergeyev"}, "is_accepted": false, "score": 3, "last_activity_date": 1500621429, "creation_date": 1500621429, "answer_id": 45231375, "question_id": 40078868, "link": "https://stackoverflow.com/questions/40078868/how-to-setup-go-swagger-to-generate-spec-from-annotation/45231375#45231375", "title": "How to setup go-swagger to generate spec from annotation", "body": "<p>This might be a late answer, but anyway. I faced the same problem and was struggling with go-swagger docs as well; that's what I finally came up with:</p>\n\n<p><code>swagger generate</code> can take input file argument (<code>-b main.go</code>, an entry point to your application, from where it automagically finds all the other annotations), and output file (<code>-o swagger.json</code>)</p>\n\n<p>So in a whole your command should be like this:</p>\n\n<p><code>swagger generate spec -b ./main.go -o swagger.json</code></p>\n\n<p>Within my main go file, at the top of it, I have a bit different annotation than you have. It defines the basic project properties like title:</p>\n\n<pre><code>// Project title (the dot in the end matters).\n//\n// Project description.\n//\n//     Schemes: http\n//     Version: 0.1\n//\n//     Consumes:\n//     - application/json\n//\n//     Produces:\n//     - application/json\n//\n//\n// swagger:meta\n</code></pre>\n"}], "owner": {"reputation": 1197, "user_id": 2572703, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/ea9bb5d1f7a8a598ebc867c3b88e7aaa?s=128&d=identicon&r=PG", "display_name": "Sakib", "link": "https://stackoverflow.com/users/2572703/sakib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3245, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1500621429, "creation_date": 1476681019, "question_id": 40078868, "link": "https://stackoverflow.com/questions/40078868/how-to-setup-go-swagger-to-generate-spec-from-annotation", "title": "How to setup go-swagger to generate spec from annotation", "body": "<p>I am following the instructions for generating swagger spec here <a href=\"https://goswagger.io/generate/spec.html\" rel=\"nofollow\">https://goswagger.io/generate/spec.html</a>.</p>\n\n<p>I have an existing project that needs a UI for the API. I want to use go swagger but I am completely confused <a href=\"https://github.com/go-swagger/go-swagger/tree/master/examples/todo-list\" rel=\"nofollow\">https://github.com/go-swagger/go-swagger/tree/master/examples/todo-list</a>\nI want to set it up so I add annotations in the code and then run the command swagger generate spec and it would generate the spec\nHowever whenever I run it, it prints <code>{\"swagger\":\"2.0\",\"paths\":{},\"definitions\":{}}</code></p>\n\n<p>This is my command to run it</p>\n\n<pre><code>...com/projectFolder]$ swagger generate spec                                                \n{\"swagger\":\"2.0\",\"paths\":{},\"definitions\":{}}\n</code></pre>\n\n<p>My project structure is as follows</p>\n\n<pre><code>project/ \n  main.go\n  api/\n    router.go\n</code></pre>\n\n<p>In main.go I have this annotation</p>\n\n<pre><code>//go:generate swagger generate spec\npackage main\n</code></pre>\n\n<p>In router above one of my handlers I have this annotation</p>\n\n<pre><code>// swagger:route GET /profile\n//\n// Gets profile of user\n//\n//     Produces:\n//     - application/json\n//     - application/x-protobuf\n//\n//     Schemes: http, https, ws, wss\n//\n//     Security:\n//       api_key:\n//       oauth: read, write\n//\n//     Responses:\n//       default: genericError\n//       200: someResponse\n//       422: validationError\nr.GET(\"/profile\", profileHandler\n</code></pre>\n\n<p>I've been stuck trying to set up an api generator for a while. Any help is much appreciated. If you have experience setting it up, please let me know how you did it </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1476680403, "post_id": 40078599, "comment_id": 67430279, "body": "Can you update with how you&#39;re using the for loo ? Also using a []Entry within the loop is better that appending to res."}, {"owner": {"reputation": 91, "user_id": 6088331, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/418143185761e2dc9dfc4b2901fe3c28?s=128&d=identicon&r=PG&f=1", "display_name": "fittaoee", "link": "https://stackoverflow.com/users/6088331/fittaoee"}, "reply_to_user": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1476680657, "post_id": 40078599, "comment_id": 67430358, "body": "@JohnSPerayil Updated."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 6088331, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/418143185761e2dc9dfc4b2901fe3c28?s=128&d=identicon&r=PG&f=1", "display_name": "fittaoee", "link": "https://stackoverflow.com/users/6088331/fittaoee"}, "edited": false, "score": 1, "creation_date": 1476682451, "post_id": 40078831, "comment_id": 67430968, "body": "Thank you very much sir!"}], "tags": [], "owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "is_accepted": true, "score": 3, "last_activity_date": 1476681258, "last_edit_date": 1476681258, "creation_date": 1476680843, "answer_id": 40078831, "question_id": 40078599, "link": "https://stackoverflow.com/questions/40078599/golang-json-formatted-byte-slice/40078831#40078831", "title": "Golang: JSON formatted byte slice", "body": "<p>json.Marshal requires the struct fields to be exported.</p>\n\n<p>You can use json tags to have json with small letter keys.</p>\n\n<pre><code>type Entry struct {\n  W string `json:\"w\"`\n  C int `json:\"c\"`\n}\n</code></pre>\n\n<p>Also it would be easier to use a []Entry to generate the output json.\n<a href=\"https://play.golang.org/p/iGuG-bNx5O\" rel=\"nofollow\">Sample code</a>.</p>\n"}], "owner": {"reputation": 91, "user_id": 6088331, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/418143185761e2dc9dfc4b2901fe3c28?s=128&d=identicon&r=PG&f=1", "display_name": "fittaoee", "link": "https://stackoverflow.com/users/6088331/fittaoee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 984, "favorite_count": 0, "accepted_answer_id": 40078831, "answer_count": 1, "score": 0, "last_activity_date": 1476681258, "creation_date": 1476679216, "last_edit_date": 1476680620, "question_id": 40078599, "link": "https://stackoverflow.com/questions/40078599/golang-json-formatted-byte-slice", "title": "Golang: JSON formatted byte slice", "body": "<p>I'm new to Go. Currently I have two arrays that look like:</p>\n\n<pre><code>words: [\"apple\", \"banana\", \"peach\"]\nfreq: [2, 3, 1]\n</code></pre>\n\n<p>where \"freq\" stores the count of each word in \"words\". I hope to combine the two arrays into a Json formatted byte slice that looks like</p>\n\n<pre><code>[{\"w\":\"apple\",\"c\":2},{\"w\":\"banana\",\"c\":3},{\"w\":\"peach\",\"c\":1}]\n</code></pre>\n\n<p>How can I achieve this goal?</p>\n\n<p>Currently I've declared a struct</p>\n\n<pre><code>type Entry struct {\n  w string\n  c int\n}\n</code></pre>\n\n<p>and when I loop through the two arrays, I did</p>\n\n<pre><code>  res := make([]byte, len(words))\n  for i:=0;i&lt;len(words);i++ {\n     obj := Entry{\n       w: words[i], \n       c: freq[i],\n     }\n     b, err := json.Marshal(obj)\n     if err==nil {\n        res = append(res, b...)\n     }\n  }\n\n  return res // {}{}{}\n</code></pre>\n\n<p>which doesn't gives me the desired result. Any help is appreciated. Thanks in advance.</p>\n"}, {"tags": ["go", "go-swagger"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1476678966, "post_id": 40077813, "comment_id": 67429889, "body": "You really should show actual code, not just some largish string."}], "answers": [{"tags": [], "owner": {"reputation": 707, "user_id": 2071056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7147138fc22fbd2b9d71611506c93701?s=128&d=identicon&r=PG", "display_name": "davidcv5", "link": "https://stackoverflow.com/users/2071056/davidcv5"}, "is_accepted": false, "score": 0, "last_activity_date": 1476679031, "creation_date": 1476679031, "answer_id": 40078575, "question_id": 40077813, "link": "https://stackoverflow.com/questions/40077813/golang-swagger-returns-404-not-found/40078575#40078575", "title": "Golang swagger returns 404 not found", "body": "<p>Go to the directory where you have <code>docs.go</code> and <code>web.go</code>, and assuming you downloaded the <code>swagger</code> package using <code>go get github.com/yvasiyarov/swagger</code>, the following should work for you:</p>\n\n<pre><code>$ go run web.go docs.go --staticPath=$GOPATH/src/github.com/yvasiyarov/swagger/swagger-ui --host=127.0.0.1 --port=3000\n</code></pre>\n\n<p>So basically, there are a couple of things happening here. If you look into web.go-example: <a href=\"https://github.com/yvasiyarov/swagger/blob/master/web.go-example#L14-L17\" rel=\"nofollow\">https://github.com/yvasiyarov/swagger/blob/master/web.go-example#L14-L17</a>, you can see it's using some defaults, which just won't work on your local environment, so you can do one of 2 things:</p>\n\n<p>1 - Run the command showed above every time, so you specify the <code>swagger-ui</code> path, and the <code>host</code> and <code>port</code> where you want to serve it. </p>\n\n<p>2 - Modify web.go so it takes your default configuration and you can just run <code>go run web.go docs.go</code>. Based on the command above, the changes will be like this:</p>\n\n<pre><code>var port = flag.String(\"port\", \"3000\", \"Port\")\nvar staticContent = flag.String(\"staticPath\", \"$GOPATH/src/github.com/yvasiyarov/swagger/swagger-ui\", \"Path to folder with Swagger UI\")\n</code></pre>\n\n<p>Then go to <a href=\"http://127.0.0.1:3000/swagger-ui/\" rel=\"nofollow\">http://127.0.0.1:3000/swagger-ui/</a> and have fun!</p>\n\n<p><strong>Note:</strong> if you have your <code>swagger</code> source somewhere else (not in your <code>$GOPATH</code>, just make sure you use that route. i.e.</p>\n\n<p>1 - In your command:</p>\n\n<pre><code>$ go run ... -staticPath=/some/path/.../swagger/swagger-ui\n</code></pre>\n\n<p>2 - Or in your <code>web.go</code></p>\n\n<pre><code>var staticContent = flag.String(\"staticPath\", \"/some/path/.../swagger/swagger-ui\", \"Path to folder with Swagger UI\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1197, "user_id": 2572703, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/ea9bb5d1f7a8a598ebc867c3b88e7aaa?s=128&d=identicon&r=PG", "display_name": "Sakib", "link": "https://stackoverflow.com/users/2572703/sakib"}, "edited": false, "score": 0, "creation_date": 1476682909, "post_id": 40079068, "comment_id": 67431126, "body": "I actually started looking into that too after this. It seems to be better but getting swagger for go setup is just difficult and obscure. I tried to generate the spec but it basically prints <code>{&quot;swagger&quot;:&quot;2.0&quot;,&quot;paths&quot;:{},&quot;definitions&quot;:{}}</code>. I am doing it in the same directory as the main.go and have the annotation for <code>go:generate</code> on top of my main.go file too. Do you know any good tutorials or wikis that go over this in a more detailed way?"}], "tags": [], "owner": {"reputation": 1159, "user_id": 23418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39a948a58f4569c53d971c2e120920?s=128&d=identicon&r=PG", "display_name": "Casual Jim", "link": "https://stackoverflow.com/users/23418/casual-jim"}, "is_accepted": false, "score": 0, "last_activity_date": 1476682195, "creation_date": 1476682195, "answer_id": 40079068, "question_id": 40077813, "link": "https://stackoverflow.com/questions/40077813/golang-swagger-returns-404-not-found/40079068#40079068", "title": "Golang swagger returns 404 not found", "body": "<p>For what its worth go-swagger also supports the inverse of code generation.\nYou can find the documentation for it here: <a href=\"https://goswagger.io/generate/spec.html\" rel=\"nofollow\">https://goswagger.io/generate/spec.html</a></p>\n"}], "owner": {"reputation": 1197, "user_id": 2572703, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/ea9bb5d1f7a8a598ebc867c3b88e7aaa?s=128&d=identicon&r=PG", "display_name": "Sakib", "link": "https://stackoverflow.com/users/2572703/sakib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1568, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1476682195, "creation_date": 1476672745, "last_edit_date": 1476673010, "question_id": 40077813, "link": "https://stackoverflow.com/questions/40077813/golang-swagger-returns-404-not-found", "title": "Golang swagger returns 404 not found", "body": "<p>I followed the instructions on this github page <a href=\"https://github.com/yvasiyarov/swagger\" rel=\"nofollow\">https://github.com/yvasiyarov/swagger</a> using the example project and the api documentation generated fine. But when I run the last command to run and display the API page I always get 404 not found when I go there</p>\n\n<p>The web.go file is essentially <a href=\"https://github.com/yvasiyarov/swagger/blob/master/web.go-example\" rel=\"nofollow\">https://github.com/yvasiyarov/swagger/blob/master/web.go-example</a>. Its basically the copy of the web.go-example in the repo... I dont understand why it would return 404. </p>\n\n<p>Also do you have any suggestions for similar api documentation generators that are better? I dont want code generators like <a href=\"https://github.com/go-swagger/go-swagger\" rel=\"nofollow\">https://github.com/go-swagger/go-swagger</a>. I want to generate api's based on my existing code</p>\n\n<p>Here is the generated docs.go</p>\n\n<pre><code>package main\n//This file is generated automatically. Do not try to edit it manually.\n\nvar resourceListingJson = `{\n    \"apiVersion\": \"1.0.0\",\n    \"swaggerVersion\": \"1.2\",\n    \"basePath\": \"http://127.0.0.1:3000/\",\n    \"apis\": [\n        {\n            \"path\": \"/testapi\",\n            \"description\": \"Test API\"\n        }\n    ],\n    \"info\": {\n        \"title\": \"Swagger Example API\",\n        \"description\": \"Swagger Example API\",\n        \"contact\": \"varyous@gmail.com\",\n        \"termsOfServiceUrl\": \"http://yvasiyarov.com/\",\n        \"license\": \"BSD\",\n        \"licenseUrl\": \"http://yvasiyarov.com/\"\n    }\n}`\nvar apiDescriptionsJson = map[string]string{\"testapi\":`{\n    \"apiVersion\": \"1.0.0\",\n    \"swaggerVersion\": \"1.2\",\n    \"basePath\": \"http://127.0.0.1:3000/\",\n    \"resourcePath\": \"/testapi\",\n    \"produces\": [\n        \"application/json\"\n    ],\n    \"apis\": [\n        {\n            \"path\": \"/testapi/get-string-by-int/{some_id}\",\n            \"description\": \"get string by ID\",\n            \"operations\": [\n                {\n                    \"httpMethod\": \"GET\",\n                    \"nickname\": \"GetStringByInt\",\n                    \"type\": \"string\",\n                    \"items\": {},\n                    \"summary\": \"get string by ID\",\n                    \"parameters\": [\n                        {\n                            \"paramType\": \"path\",\n                            \"name\": \"some_id\",\n                            \"description\": \"Some ID\",\n                            \"dataType\": \"int\",\n                            \"type\": \"int\",\n                            \"format\": \"\",\n                            \"allowMultiple\": false,\n                            \"required\": true,\n                            \"minimum\": 0,\n                            \"maximum\": 0\n                        }\n                    ],\n                    \"responseMessages\": [\n                        {\n                            \"code\": 200,\n                            \"message\": \"\",\n                            \"responseType\": \"object\",\n                            \"responseModel\": \"string\"\n                        },\n                        {\n                            \"code\": 400,\n                            \"message\": \"We need ID!!\",\n                            \"responseType\": \"object\",\n                            \"responseModel\": \"git.corp.adobe.com.personal.test1.APIError\"\n                        },\n                        {\n                            \"code\": 404,\n                            \"message\": \"Can not find ID\",\n                            \"responseType\": \"object\",\n                            \"responseModel\": \"git.corp.adobe.com.personal.test1.APIError\"\n                        }\n                    ],\n                    \"produces\": [\n                        \"application/json\"\n                    ]\n                }\n            ]\n        },\n        {\n            \"path\": \"/testapi/get-struct-by-int/{some_id}\",\n            \"description\": \"get struct by ID\",\n            \"operations\": [\n                {\n                    \"httpMethod\": \"GET\",\n                    \"nickname\": \"GetStructByInt\",\n                    \"type\": \"git.corp.adobe.com.personal.test1.StructureWithEmbededStructure\",\n                    \"items\": {},\n                    \"summary\": \"get struct by ID\",\n                    \"parameters\": [\n                        {\n                            \"paramType\": \"path\",\n                            \"name\": \"some_id\",\n                            \"description\": \"Some ID\",\n                            \"dataType\": \"int\",\n                            \"type\": \"int\",\n                            \"format\": \"\",\n                            \"allowMultiple\": false,\n                            \"required\": true,\n                            \"minimum\": 0,\n                            \"maximum\": 0\n                        },\n                        {\n                            \"paramType\": \"query\",\n                            \"name\": \"offset\",\n                            \"description\": \"Offset\",\n                            \"dataType\": \"int\",\n                            \"type\": \"int\",\n                            \"format\": \"\",\n                            \"allowMultiple\": false,\n                            \"required\": true,\n                            \"minimum\": 0,\n                            \"maximum\": 0\n                        },\n                        {\n                            \"paramType\": \"query\",\n                            \"name\": \"limit\",\n                            \"description\": \"Offset\",\n                            \"dataType\": \"int\",\n                            \"type\": \"int\",\n                            \"format\": \"\",\n                            \"allowMultiple\": false,\n                            \"required\": true,\n                            \"minimum\": 0,\n                            \"maximum\": 0\n                        }\n                    ],\n                    \"responseMessages\": [\n                        {\n                            \"code\": 200,\n                            \"message\": \"\",\n                            \"responseType\": \"object\",\n                            \"responseModel\": \"git.corp.adobe.com.personal.test1.StructureWithEmbededStructure\"\n                        },\n                        {\n                            \"code\": 400,\n                            \"message\": \"We need ID!!\",\n                            \"responseType\": \"object\",\n                            \"responseModel\": \"git.corp.adobe.com.personal.test1.APIError\"\n                        },\n                        {\n                            \"code\": 404,\n                            \"message\": \"Can not find ID\",\n                            \"responseType\": \"object\",\n                            \"responseModel\": \"git.corp.adobe.com.personal.test1.APIError\"\n                        }\n                    ],\n                    \"produces\": [\n                        \"application/json\"\n                    ]\n                }\n            ]\n        },\n        {\n            \"path\": \"/testapi/get-struct2-by-int/{some_id}\",\n            \"description\": \"get struct2 by ID\",\n            \"operations\": [\n                {\n                    \"httpMethod\": \"GET\",\n                    \"nickname\": \"GetStruct2ByInt\",\n                    \"type\": \"git.corp.adobe.com.personal.test1.StructureWithEmbededPointer\",\n                    \"items\": {},\n                    \"summary\": \"get struct2 by ID\",\n                    \"parameters\": [\n                        {\n                            \"paramType\": \"path\",\n                            \"name\": \"some_id\",\n                            \"description\": \"Some ID\",\n                            \"dataType\": \"int\",\n                            \"type\": \"int\",\n                            \"format\": \"\",\n                            \"allowMultiple\": false,\n                            \"required\": true,\n                            \"minimum\": 0,\n                            \"maximum\": 0\n                        },\n                        {\n                            \"paramType\": \"query\",\n                            \"name\": \"offset\",\n                            \"description\": \"Offset\",\n                            \"dataType\": \"int\",\n                            \"type\": \"int\",\n                            \"format\": \"\",\n                            \"allowMultiple\": false,\n                            \"required\": true,\n                            \"minimum\": 0,\n                            \"maximum\": 0\n                        },\n                        {\n                            \"paramType\": \"query\",\n                            \"name\": \"limit\",\n                            \"description\": \"Offset\",\n                            \"dataType\": \"int\",\n                            \"type\": \"int\",\n                            \"format\": \"\",\n                            \"allowMultiple\": false,\n                            \"required\": true,\n                            \"minimum\": 0,\n                            \"maximum\": 0\n                        }\n                    ],\n                    \"responseMessages\": [\n                        {\n                            \"code\": 200,\n                            \"message\": \"\",\n                            \"responseType\": \"object\",\n                            \"responseModel\": \"git.corp.adobe.com.personal.test1.StructureWithEmbededPointer\"\n                        },\n                        {\n                            \"code\": 400,\n                            \"message\": \"We need ID!!\",\n                            \"responseType\": \"object\",\n                            \"responseModel\": \"git.corp.adobe.com.personal.test1.APIError\"\n                        },\n                        {\n                            \"code\": 404,\n                            \"message\": \"Can not find ID\",\n                            \"responseType\": \"object\",\n                            \"responseModel\": \"git.corp.adobe.com.personal.test1.APIError\"\n                        }\n                    ],\n                    \"produces\": [\n                        \"application/json\"\n                    ]\n                }\n            ]\n        },\n        {\n            \"path\": \"/testapi/get-simple-array-by-string/{some_id}\",\n            \"description\": \"get simple array by ID\",\n            \"operations\": [\n                {\n                    \"httpMethod\": \"GET\",\n                    \"nickname\": \"GetSimpleArrayByString\",\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\": \"string\"\n                    },\n                    \"summary\": \"get simple array by ID\",\n                    \"parameters\": [\n                        {\n                            \"paramType\": \"path\",\n                            \"name\": \"some_id\",\n                            \"description\": \"Some ID\",\n                            \"dataType\": \"string\",\n                            \"type\": \"string\",\n                            \"format\": \"\",\n                            \"allowMultiple\": false,\n                            \"required\": true,\n                            \"minimum\": 0,\n                            \"maximum\": 0\n                        },\n                        {\n                            \"paramType\": \"query\",\n                            \"name\": \"offset\",\n                            \"description\": \"Offset\",\n                            \"dataType\": \"int\",\n                            \"type\": \"int\",\n                            \"format\": \"\",\n                            \"allowMultiple\": false,\n                            \"required\": true,\n                            \"minimum\": 0,\n                            \"maximum\": 0\n                        },\n                        {\n                            \"paramType\": \"query\",\n                            \"name\": \"limit\",\n                            \"description\": \"Offset\",\n                            \"dataType\": \"int\",\n                            \"type\": \"int\",\n                            \"format\": \"\",\n                            \"allowMultiple\": false,\n                            \"required\": true,\n                            \"minimum\": 0,\n                            \"maximum\": 0\n                        }\n                    ],\n                    \"responseMessages\": [\n                        {\n                            \"code\": 200,\n                            \"message\": \"\",\n                            \"responseType\": \"array\",\n                            \"responseModel\": \"string\"\n                        },\n                        {\n                            \"code\": 400,\n                            \"message\": \"We need ID!!\",\n                            \"responseType\": \"object\",\n                            \"responseModel\": \"git.corp.adobe.com.personal.test1.APIError\"\n                        },\n                        {\n                            \"code\": 404,\n                            \"message\": \"Can not find ID\",\n                            \"responseType\": \"object\",\n                            \"responseModel\": \"git.corp.adobe.com.personal.test1.APIError\"\n                        }\n                    ],\n                    \"produces\": [\n                        \"application/json\"\n                    ]\n                }\n            ]\n        },\n        {\n            \"path\": \"/testapi/get-struct-array-by-string/{some_id}\",\n            \"description\": \"get struct array by ID\",\n            \"operations\": [\n                {\n                    \"httpMethod\": \"GET\",\n                    \"nickname\": \"GetStructArrayByString\",\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"git.corp.adobe.com.personal.test1.SimpleStructureWithAnnotations\"\n                    },\n                    \"summary\": \"get struct array by ID\",\n                    \"parameters\": [\n                        {\n                            \"paramType\": \"path\",\n                            \"name\": \"some_id\",\n                            \"description\": \"Some ID\",\n                            \"dataType\": \"string\",\n                            \"type\": \"string\",\n                            \"format\": \"\",\n                            \"allowMultiple\": false,\n                            \"required\": true,\n                            \"minimum\": 0,\n                            \"maximum\": 0\n                        },\n                        {\n                            \"paramType\": \"query\",\n                            \"name\": \"offset\",\n                            \"description\": \"Offset\",\n                            \"dataType\": \"int\",\n                            \"type\": \"int\",\n                            \"format\": \"\",\n                            \"allowMultiple\": false,\n                            \"required\": true,\n                            \"minimum\": 0,\n                            \"maximum\": 0\n                        },\n                        {\n                            \"paramType\": \"query\",\n                            \"name\": \"limit\",\n                            \"description\": \"Offset\",\n                            \"dataType\": \"int\",\n                            \"type\": \"int\",\n                            \"format\": \"\",\n                            \"allowMultiple\": false,\n                            \"required\": true,\n                            \"minimum\": 0,\n                            \"maximum\": 0\n                        }\n                    ],\n                    \"responseMessages\": [\n                        {\n                            \"code\": 200,\n                            \"message\": \"\",\n                            \"responseType\": \"array\",\n                            \"responseModel\": \"git.corp.adobe.com.personal.test1.SimpleStructureWithAnnotations\"\n                        },\n                        {\n                            \"code\": 400,\n                            \"message\": \"We need ID!!\",\n                            \"responseType\": \"object\",\n                            \"responseModel\": \"git.corp.adobe.com.personal.test1.APIError\"\n                        },\n                        {\n                            \"code\": 404,\n                            \"message\": \"Can not find ID\",\n                            \"responseType\": \"object\",\n                            \"responseModel\": \"git.corp.adobe.com.personal.test1.APIError\"\n                        }\n                    ],\n                    \"produces\": [\n                        \"application/json\"\n                    ]\n                }\n            ]\n        },\n        {\n            \"path\": \"/testapi/get-interface\",\n            \"description\": \"get interface\",\n            \"operations\": [\n                {\n                    \"httpMethod\": \"GET\",\n                    \"nickname\": \"GetInterface\",\n                    \"type\": \"git.corp.adobe.com.personal.test1.InterfaceType\",\n                    \"items\": {},\n                    \"summary\": \"get interface\",\n                    \"responseMessages\": [\n                        {\n                            \"code\": 200,\n                            \"message\": \"\",\n                            \"responseType\": \"object\",\n                            \"responseModel\": \"git.corp.adobe.com.personal.test1.InterfaceType\"\n                        },\n                        {\n                            \"code\": 400,\n                            \"message\": \"We need ID!!\",\n                            \"responseType\": \"object\",\n                            \"responseModel\": \"git.corp.adobe.com.personal.test1.APIError\"\n                        },\n                        {\n                            \"code\": 404,\n                            \"message\": \"Can not find ID\",\n                            \"responseType\": \"object\",\n                            \"responseModel\": \"git.corp.adobe.com.personal.test1.APIError\"\n                        }\n                    ],\n                    \"produces\": [\n                        \"application/json\"\n                    ]\n                }\n            ]\n        },\n        {\n            \"path\": \"/testapi/get-simple-aliased\",\n            \"description\": \"get simple aliases\",\n            \"operations\": [\n                {\n                    \"httpMethod\": \"GET\",\n                    \"nickname\": \"GetSimpleAliased\",\n                    \"type\": \"string\",\n                    \"items\": {},\n                    \"summary\": \"get simple aliases\",\n                    \"responseMessages\": [\n                        {\n                            \"code\": 200,\n                            \"message\": \"\",\n                            \"responseType\": \"object\",\n                            \"responseModel\": \"string\"\n                        },\n                        {\n                            \"code\": 400,\n                            \"message\": \"We need ID!!\",\n                            \"responseType\": \"object\",\n                            \"responseModel\": \"git.corp.adobe.com.personal.test1.APIError\"\n                        },\n                        {\n                            \"code\": 404,\n                            \"message\": \"Can not find ID\",\n                            \"responseType\": \"object\",\n                            \"responseModel\": \"git.corp.adobe.com.personal.test1.APIError\"\n                        }\n                    ],\n                    \"produces\": [\n                        \"application/json\"\n                    ]\n                }\n            ]\n        },\n        {\n            \"path\": \"/testapi/get-array-of-interfaces\",\n            \"description\": \"get array of interfaces\",\n            \"operations\": [\n                {\n                    \"httpMethod\": \"GET\",\n                    \"nickname\": \"GetArrayOfInterfaces\",\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"git.corp.adobe.com.personal.test1.InterfaceType\"\n                    },\n                    \"summary\": \"get array of interfaces\",\n                    \"responseMessages\": [\n                        {\n                            \"code\": 200,\n                            \"message\": \"\",\n                            \"responseType\": \"array\",\n                            \"responseModel\": \"git.corp.adobe.com.personal.test1.InterfaceType\"\n                        },\n                        {\n                            \"code\": 400,\n                            \"message\": \"We need ID!!\",\n                            \"responseType\": \"object\",\n                            \"responseModel\": \"git.corp.adobe.com.personal.test1.APIError\"\n                        },\n                        {\n                            \"code\": 404,\n                            \"message\": \"Can not find ID\",\n                            \"responseType\": \"object\",\n                            \"responseModel\": \"git.corp.adobe.com.personal.test1.APIError\"\n                        }\n                    ],\n                    \"produces\": [\n                        \"application/json\"\n                    ]\n                }\n            ]\n        },\n        {\n            \"path\": \"/testapi/get-struct3\",\n            \"description\": \"get struct3\",\n            \"operations\": [\n                {\n                    \"httpMethod\": \"GET\",\n                    \"nickname\": \"GetStruct3\",\n                    \"type\": \"git.corp.adobe.com.personal.test1.StructureWithSlice\",\n                    \"items\": {},\n                    \"summary\": \"get struct3\",\n                    \"responseMessages\": [\n                        {\n                            \"code\": 200,\n                            \"message\": \"\",\n                            \"responseType\": \"object\",\n                            \"responseModel\": \"git.corp.adobe.com.personal.test1.StructureWithSlice\"\n                        },\n                        {\n                            \"code\": 400,\n                            \"message\": \"We need ID!!\",\n                            \"responseType\": \"object\",\n                            \"responseModel\": \"git.corp.adobe.com.personal.test1.APIError\"\n                        },\n                        {\n                            \"code\": 404,\n                            \"message\": \"Can not find ID\",\n                            \"responseType\": \"object\",\n                            \"responseModel\": \"git.corp.adobe.com.personal.test1.APIError\"\n                        }\n                    ],\n                    \"produces\": [\n                        \"application/json\"\n                    ]\n                }\n            ]\n        }\n    ],\n    \"models\": {\n        \"git.corp.adobe.com.personal.test1.APIError\": {\n            \"id\": \"git.corp.adobe.com.personal.test1.APIError\",\n            \"properties\": {\n                \"ErrorCode\": {\n                    \"type\": \"int\",\n                    \"description\": \"\",\n                    \"items\": {},\n                    \"format\": \"\"\n                },\n                \"ErrorMessage\": {\n                    \"type\": \"string\",\n                    \"description\": \"\",\n                    \"items\": {},\n                    \"format\": \"\"\n                }\n            }\n        },\n        \"git.corp.adobe.com.personal.test1.InterfaceType\": {\n            \"id\": \"git.corp.adobe.com.personal.test1.InterfaceType\",\n            \"properties\": null\n        },\n        \"git.corp.adobe.com.personal.test1.SimpleStructureWithAnnotations\": {\n            \"id\": \"git.corp.adobe.com.personal.test1.SimpleStructureWithAnnotations\",\n            \"required\": [\n                \"Name\"\n            ],\n            \"properties\": {\n                \"Name\": {\n                    \"type\": \"string\",\n                    \"description\": \"\",\n                    \"items\": {},\n                    \"format\": \"\"\n                },\n                \"id\": {\n                    \"type\": \"int\",\n                    \"description\": \"\",\n                    \"items\": {},\n                    \"format\": \"\"\n                }\n            }\n        },\n        \"git.corp.adobe.com.personal.test1.StructureWithEmbededPointer\": {\n            \"id\": \"git.corp.adobe.com.personal.test1.StructureWithEmbededPointer\",\n            \"properties\": {\n                \"Id\": {\n                    \"type\": \"int\",\n                    \"description\": \"\",\n                    \"items\": {},\n                    \"format\": \"\"\n                },\n                \"Name\": {\n                    \"type\": \"array\",\n                    \"description\": \"\",\n                    \"items\": {\n                        \"type\": \"byte\"\n                    },\n                    \"format\": \"\"\n                }\n            }\n        },\n        \"git.corp.adobe.com.personal.test1.StructureWithEmbededStructure\": {\n            \"id\": \"git.corp.adobe.com.personal.test1.StructureWithEmbededStructure\",\n            \"properties\": {\n                \"Id\": {\n                    \"type\": \"int\",\n                    \"description\": \"\",\n                    \"items\": {},\n                    \"format\": \"\"\n                },\n                \"Name\": {\n                    \"type\": \"array\",\n                    \"description\": \"\",\n                    \"items\": {\n                        \"type\": \"byte\"\n                    },\n                    \"format\": \"\"\n                }\n            }\n        },\n        \"git.corp.adobe.com.personal.test1.StructureWithSlice\": {\n            \"id\": \"git.corp.adobe.com.personal.test1.StructureWithSlice\",\n            \"properties\": {\n                \"Id\": {\n                    \"type\": \"int\",\n                    \"description\": \"\",\n                    \"items\": {},\n                    \"format\": \"\"\n                },\n                \"Name\": {\n                    \"type\": \"array\",\n                    \"description\": \"\",\n                    \"items\": {\n                        \"type\": \"byte\"\n                    },\n                    \"format\": \"\"\n                }\n            }\n        }\n    }\n}`,}\n</code></pre>\n"}, {"tags": ["postgresql", "go", "prepared-statement", "create-table"], "answers": [{"tags": [], "owner": {"reputation": 3761, "user_id": 142020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vKJEv.png?s=128&g=1", "display_name": "T0xicCode", "link": "https://stackoverflow.com/users/142020/t0xiccode"}, "is_accepted": false, "score": 1, "last_activity_date": 1476668397, "last_edit_date": 1476668397, "creation_date": 1476668013, "answer_id": 40077332, "question_id": 40077299, "link": "https://stackoverflow.com/questions/40077299/golang-prepared-statements-for-create-table/40077332#40077332", "title": "Golang prepared statements for &quot;CREATE TABLE&quot;", "body": "<p>You can't use parameters for table or column names in SQL. You will have to escape the variable part manually and build the table name in code and inject it in the SQL string before sending it to the database.</p>\n\n<p>As well, the PostgreSQL <a href=\"https://www.postgresql.org/message-id/1158168051.9657.1272.camel%40archimedes\" rel=\"nofollow\">engine is built</a> in such a way that it does not allow variables at any place in a <code>CREATE</code> statement. This means that the engine does will not accept any parameters when running such a query.</p>\n"}, {"tags": [], "owner": {"reputation": 257364, "user_id": 398670, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/85f50c23bb5e9dfb061af5032bfe8e65?s=128&d=identicon&r=PG", "display_name": "Craig Ringer", "link": "https://stackoverflow.com/users/398670/craig-ringer"}, "is_accepted": true, "score": 6, "last_activity_date": 1476671119, "creation_date": 1476671119, "answer_id": 40077649, "question_id": 40077299, "link": "https://stackoverflow.com/questions/40077299/golang-prepared-statements-for-create-table/40077649#40077649", "title": "Golang prepared statements for &quot;CREATE TABLE&quot;", "body": "<p>It's not possible in PostgreSQL because:</p>\n\n<ol>\n<li><p>PostgreSQL's bind parameters may only be used for literals, not identifiers. That's because the parser has to know what the identifiers are in order to parse the query correctly, but bind parameters are only sent after parsing. So you can't use parameters for table names etc.</p></li>\n<li><p>PostgreSQL doesn't support bind parameters in utility statements (anything other than insert/update/delete/select) anyway.</p></li>\n</ol>\n\n<p>Some drivers support <em>client-side</em> parameter substitution and escaping for identifiers via a different placement parameter syntax, but as far as I can tell Go's does not. So you'll have to use string interpolation, carefully. Remember to <em>always</em> enclose the identifier in <code>\"double quotes\"</code> and double any embedded quotes, so a table name <code>my \"table\"!</code> becomes <code>\"my \"\"table!\"</code> in SQL.</p>\n"}], "owner": {"reputation": 4924, "user_id": 3049865, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98dc179f82c2efee71cc49006397cfc5?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Kleinhans", "link": "https://stackoverflow.com/users/3049865/alexander-kleinhans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1834, "favorite_count": 0, "accepted_answer_id": 40077649, "answer_count": 2, "score": 1, "last_activity_date": 1476671119, "creation_date": 1476667732, "question_id": 40077299, "link": "https://stackoverflow.com/questions/40077299/golang-prepared-statements-for-create-table", "title": "Golang prepared statements for &quot;CREATE TABLE&quot;", "body": "<p>I'm finding that <code>create table</code> statements are not recognizing wildcard characters I want to insert. How would I do something like with a prepared statement in golang?</p>\n\n<pre><code>                    stmt, err := tx.Prepare(`\n                    CREATE TABLE table_number_$1 (\n                            guid character varying(64) NOT NULL,\n                            number integer,\n                            name character varying(64),\n                            PRIMARY KEY (guid),\n                            CONSTRAINT some_onstraint\n                            CHECK ((number = $2))\n                    )`)\n                    if err != nil {\n                            return err \n                    }   \n                    defer stmt.Close()\n                    if _, err := stmt.Exec(\n                            string(table_number),\n                            table_number; err != nil {\n                            tx.Rollback()\n                            return err \n                    }  \n</code></pre>\n\n<p>The error I get when I print it out is:\n<code>sql: expected 0 arguments, got 2</code></p>\n\n<p>EDIT:\nobviously I know I could build the string like normal, but was wondering if there's a built in way.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": true, "score": 1, "last_activity_date": 1476665930, "creation_date": 1476665930, "answer_id": 40077155, "question_id": 40077043, "link": "https://stackoverflow.com/questions/40077043/how-to-cast-between-two-custom-types/40077155#40077155", "title": "how to cast between two custom types", "body": "<p>You can use the way <code>s0 := StringB(s)</code> in other languages is a constructor but here is just other way to create compatible types, like <code>[]byte(\"abc\")</code></p>\n\n<p>Your code may looks like:</p>\n\n<pre><code>type StringA string\n\ntype StringB string\n\nfunc (s StringB) Greetings(){\n    fmt.Println(s)\n\n}\n\nfunc main() {\n    var s StringA\n    s = \"hello\"\n    s0 := StringB(s)\n    s0.Greetings()\n}\n</code></pre>\n\n<p>full example: <a href=\"https://play.golang.org/p/rMzW5FfjSE\" rel=\"nofollow\">https://play.golang.org/p/rMzW5FfjSE</a></p>\n"}], "owner": {"reputation": 1835, "user_id": 963319, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1b950873c444db9f4ae35d86563b430b?s=128&d=identicon&r=PG", "display_name": "Jenia Ivanov", "link": "https://stackoverflow.com/users/963319/jenia-ivanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 40077155, "answer_count": 1, "score": 1, "last_activity_date": 1476665930, "creation_date": 1476664816, "question_id": 40077043, "link": "https://stackoverflow.com/questions/40077043/how-to-cast-between-two-custom-types", "title": "how to cast between two custom types", "body": "<p>Suppose I have two files. </p>\n\n<h1>hello.go</h1>\n\n<pre><code>package main\n\n\ntype StringA string\n\n\nfunc main() {\n\n    var s StringA\n    s = \"hello\"\n    s0 := s.(StringB) &lt;---- somehow cast my StringA to StringB. After all, they are both strings\n    s0.Greetings()\n\n}\n</code></pre>\n\n<h1>bye.go</h1>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype StringB string\n\n\n\nfunc (s StringB) Greetings(){\n\n    fmt.Println(s)\n\n}\n</code></pre>\n\n<p>And compile this like this:</p>\n\n<pre><code>go build hello.go bye.go\n</code></pre>\n\n<p>How do I cast <code>StringA</code> to the type <code>StringB</code>?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["mysql", "go", "utf-8", "sqlx"], "comments": [{"owner": {"reputation": 4728, "user_id": 859485, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d3cd133adfeccd7bec7863c294a879ae?s=128&d=identicon&r=PG", "display_name": "Andre M", "link": "https://stackoverflow.com/users/859485/andre-m"}, "edited": false, "score": 1, "creation_date": 1476662306, "post_id": 40076725, "comment_id": 67426641, "body": "What encoding is your page, form and server side expecting. Often these default to ISO8859-1, unless you specify explicitly."}, {"owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "reply_to_user": {"reputation": 4728, "user_id": 859485, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d3cd133adfeccd7bec7863c294a879ae?s=128&d=identicon&r=PG", "display_name": "Andre M", "link": "https://stackoverflow.com/users/859485/andre-m"}, "edited": false, "score": 0, "creation_date": 1476662556, "post_id": 40076725, "comment_id": 67426688, "body": "I have <code>&lt;meta charset=&quot;utf-8&quot;&gt;</code> in the template."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1476665393, "post_id": 40076725, "comment_id": 67427210, "body": "what tool are you using to see the content of your db ? are you getting some error in your Go code ?"}, {"owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "reply_to_user": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1476665893, "post_id": 40076725, "comment_id": 67427303, "body": "@YandryPozo I use phpmyadmin to see the database. I also see the saved characters as rendered in go templates. Both cases show the same <code>???</code>. I see no error in terminal."}, {"owner": {"reputation": 4728, "user_id": 859485, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d3cd133adfeccd7bec7863c294a879ae?s=128&d=identicon&r=PG", "display_name": "Andre M", "link": "https://stackoverflow.com/users/859485/andre-m"}, "edited": false, "score": 0, "creation_date": 1478372508, "post_id": 40076725, "comment_id": 68130788, "body": "As an FYI, the charset meta is only for controlling the rendition of the page. When sending form values there a number of other steps where the character encoding can fall to some default value, before getting to the database."}], "answers": [{"comments": [{"owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "edited": false, "score": 1, "creation_date": 1476737387, "post_id": 40077488, "comment_id": 67463588, "body": "Read about question marks here:  <a href=\"http://stackoverflow.com/questions/38363566/trouble-with-utf8-characters-what-i-see-is-not-what-i-stored\" title=\"trouble with utf8 characters what i see is not what i stored\">stackoverflow.com/questions/38363566/&hellip;</a>"}], "tags": [], "owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "is_accepted": true, "score": 0, "last_activity_date": 1476669494, "creation_date": 1476669494, "answer_id": 40077488, "question_id": 40076725, "link": "https://stackoverflow.com/questions/40076725/go-non-ascii-form-values-saved-as-question-marks/40077488#40077488", "title": "Go non-ascii form values saved as question marks", "body": "<p>I don't know why but these solved the issue:</p>\n\n<pre><code>ALTER DATABASE mydb CHARACTER SET utf8 COLLATE utf8_unicode_ci;\nALTER TABLE quote CONVERT TO CHARACTER SET utf8 COLLATE utf8_unicode_ci;\n</code></pre>\n"}], "owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 0, "accepted_answer_id": 40077488, "answer_count": 1, "score": 0, "last_activity_date": 1476669494, "creation_date": 1476661586, "last_edit_date": 1476662670, "question_id": 40076725, "link": "https://stackoverflow.com/questions/40076725/go-non-ascii-form-values-saved-as-question-marks", "title": "Go non-ascii form values saved as question marks", "body": "<p>I'm using Go <a href=\"http://jmoiron.github.io/sqlx/\" rel=\"nofollow\">sqlx package</a> to make queries on MariaDB database and I'd like to be able to save non-ascii form submitted values into the database. </p>\n\n<p>Here is the function:</p>\n\n<pre><code>func QuoteCreate(content string, author string) error {\n    var err error\n    fmt.Println(\"content, author\", content, author)\n\n        _, err = database.SQL.Exec(\"INSERT INTO quote (content, author) VALUES (?,?)\", content, author)\n\n        if err != nil {\n        fmt.Println(err)\n    }\n    return standardizeError(err)\n}\n</code></pre>\n\n<p>The <code>quote</code> tables has <code>utf8_general_cli</code> colation and <code>InnoDB</code> engine. However the <code>content</code> and <code>author</code> values submitted by form are saved as <code>???</code> when the values are not ascii characters (I tried Persian and simplified chinese). </p>\n\n<p>I have also tried <code>utf8_unicode_cli</code> for the table colation, but got the same problem. Interestingly, non-ascii characters are shown correctly when printed on terminal befor being saved. </p>\n\n<p>So I'm left clueless what's wrong here and how can I fix it?</p>\n"}, {"tags": ["postgresql", "go", "transactions", "acid"], "answers": [{"comments": [{"owner": {"reputation": 925, "user_id": 1573292, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Wjlja.jpg?s=128&g=1", "display_name": "BARJ", "link": "https://stackoverflow.com/users/1573292/barj"}, "edited": false, "score": 2, "creation_date": 1493185490, "post_id": 40076912, "comment_id": 74300508, "body": "Really helpful post, thanks. But what I do not understand though, <code>A transaction must end with a call to Commit or Rollback.</code>, when you return an error caused by <code>tx.Prepare(some sql..)</code> you do not perform a Commit or a Rollback. Why is that? Is the transaction in question properly closed in that scenario? Even though no changes have been made to the underlying Database, don&#39;t we still need to properly close the transaction?"}, {"owner": {"reputation": 293, "user_id": 1319493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de4e791aaae72b7c1c5107ba203828a4?s=128&d=identicon&r=PG", "display_name": "Khaled Jouda", "link": "https://stackoverflow.com/users/1319493/khaled-jouda"}, "edited": false, "score": 0, "creation_date": 1493466560, "post_id": 40076912, "comment_id": 74435572, "body": "This code is not correct for Go1.4 or earlier version, tx.Commit() will release the connection associated with it back to the pool, which will happen before stmt.Close(), this could lead to concurrent access to the underlying connection, rendering the connection state inconsistent. as stated here: <a href=\"http://go-database-sql.org/prepared.html\" rel=\"nofollow noreferrer\">go-database-sql.org/prepared.html</a>"}, {"owner": {"reputation": 166522, "user_id": 9990, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2ef86667e42fe07c2bab670357a57fc5?s=128&d=identicon&r=PG", "display_name": "Marcelo Cantos", "link": "https://stackoverflow.com/users/9990/marcelo-cantos"}, "edited": false, "score": 1, "creation_date": 1516656981, "post_id": 40076912, "comment_id": 83769212, "body": "@YandryPozo That doesn&#39;t sound right to me. As pointed out above, according to <a href=\"https://golang.org/pkg/database/sql/#Tx\" rel=\"nofollow noreferrer\">golang.org/pkg/database/sql/#Tx</a>, a transaction must end in Rollback or Commit. Per the same doc, Tx is a transaction, so as soon as you have a Tx, you have a transaction."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "reply_to_user": {"reputation": 166522, "user_id": 9990, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2ef86667e42fe07c2bab670357a57fc5?s=128&d=identicon&r=PG", "display_name": "Marcelo Cantos", "link": "https://stackoverflow.com/users/9990/marcelo-cantos"}, "edited": false, "score": 0, "creation_date": 1530395340, "post_id": 40076912, "comment_id": 89223524, "body": "@MarceloCantos you&#39;re right if we have a created transaction we have to finish it anyways. I just edited my answer, thanks for your catch!"}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "reply_to_user": {"reputation": 925, "user_id": 1573292, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Wjlja.jpg?s=128&g=1", "display_name": "BARJ", "link": "https://stackoverflow.com/users/1573292/barj"}, "edited": false, "score": 0, "creation_date": 1530395508, "post_id": 40076912, "comment_id": 89223552, "body": "@BARJ you right, I edited my answer, thanks for your comment!"}, {"owner": {"reputation": 731, "user_id": 5865411, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/z2dJz.png?s=128&g=1", "display_name": "dev-x", "link": "https://stackoverflow.com/users/5865411/dev-x"}, "edited": false, "score": 0, "creation_date": 1543549999, "post_id": 40076912, "comment_id": 93967964, "body": "Why use use braces to divide two actions?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user12849275"}, "edited": false, "score": 0, "creation_date": 1582446536, "post_id": 40076912, "comment_id": 106775266, "body": "what are (thing_1, whatever) ??"}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1583021842, "post_id": 40076912, "comment_id": 106977427, "body": "@OlegzandrDenman the parameters passed in the original question."}], "tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": true, "score": 18, "last_activity_date": 1530395577, "last_edit_date": 1592644375, "creation_date": 1476663486, "answer_id": 40076912, "question_id": 40076596, "link": "https://stackoverflow.com/questions/40076596/raw-sql-transactions-with-golang-prepared-statements/40076912#40076912", "title": "Raw sql transactions with golang prepared statements", "body": "<p>Yes Go has a great implementation of sql <a href=\"https://golang.org/pkg/database/sql/#Tx\" rel=\"noreferrer\">transactions</a>. We start the transaction with <a href=\"https://golang.org/pkg/database/sql/#DB.Begin\" rel=\"noreferrer\">db.Begin</a> and we can end it with <a href=\"https://golang.org/pkg/database/sql/#Tx.Commit\" rel=\"noreferrer\">tx.Commit</a> if everything goes good or with <a href=\"https://golang.org/pkg/database/sql/#Tx.Rollback\" rel=\"noreferrer\">tx.Rollback</a> in case of error.</p>\n<blockquote>\n<p>type Tx struct { }</p>\n<p>Tx is an in-progress database transaction.</p>\n<p>A transaction must end with a call to Commit or Rollback.</p>\n<p>After a call to Commit or Rollback, all operations on the transaction fail with ErrTxDone.</p>\n<p>The statements prepared for a transaction by calling the transaction's Prepare or Stmt methods are closed by the call to Commit or Rollback.</p>\n</blockquote>\n<p>Also note that we prepare queries with the transaction variable tx.Prepare(...)</p>\n<p>Your function may looks like this:</p>\n<pre><code>func doubleInsert(db *sql.DB) error {\n\n    tx, err := db.Begin()\n    if err != nil {\n        return err\n    }\n\n    {\n        stmt, err := tx.Prepare(`INSERT INTO table_1 (thing_1, whatever)\n                     VALUES($1,$2);`)\n        if err != nil {\n            tx.Rollback()\n            return err\n        }\n        defer stmt.Close()\n\n        if _, err := stmt.Exec(thing_1, whatever); err != nil {\n            tx.Rollback() // return an error too, we may want to wrap them\n            return err\n        }\n    }\n\n    {\n        stmt, err := tx.Prepare(`INSERT INTO table_2 (thing_2, whatever)\n                     VALUES($1, $2);`)\n        if err != nil {\n            tx.Rollback()\n            return err\n        }\n        defer stmt.Close()\n\n        if _, err := stmt.Exec(thing_2, whatever); err != nil {\n            tx.Rollback() // return an error too, we may want to wrap them\n            return err\n        }\n    }\n\n    return tx.Commit()\n}\n</code></pre>\n<p><em>I have a full example <a href=\"https://github.com/yanpozka/sqlite_trans/blob/master/main.go\" rel=\"noreferrer\">here</a></em></p>\n"}, {"tags": [], "owner": {"reputation": 925, "user_id": 1573292, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Wjlja.jpg?s=128&g=1", "display_name": "BARJ", "link": "https://stackoverflow.com/users/1573292/barj"}, "is_accepted": false, "score": 0, "last_activity_date": 1493202661, "creation_date": 1493202661, "answer_id": 43631644, "question_id": 40076596, "link": "https://stackoverflow.com/questions/40076596/raw-sql-transactions-with-golang-prepared-statements/43631644#43631644", "title": "Raw sql transactions with golang prepared statements", "body": "<p>I came up with a possible solution to rollback on any failure without any significant drawbacks. I am pretty new to Golang though, I could be wrong.</p>\n\n<pre><code>func CloseTransaction(tx *sql.Tx, commit *bool) {\n  if *commit {\n    log.Println(\"Commit sql transaction\")\n    if err := tx.Commit(); err != nil {\n      log.Panic(err)\n    }\n  } else {\n    log.Println(\"Rollback sql transcation\")\n    if err := tx.Rollback(); err != nil {\n      log.Panic(err)\n    }\n  }\n}\n\nfunc MultipleSqlQuriesWithTx(db *sql.DB, .. /* some parameter(s) */)  (.. .. /* some named return parameter(s) */, err error) {\n  tx, err := db.Begin()\n  if err != nil {\n    return\n  }\n  commitTx := false\n  defer CloseTransaction(tx, &amp;commitTx)\n\n  // First sql query\n  stmt, err := tx.Prepare(..) // some raw sql\n  if err != nil {\n    return\n  }\n  defer stmt.Close()\n\n  res, err := stmt.Exec(..) // some var args\n  if err != nil {\n    return\n  }\n\n  // Second sql query\n  stmt, err := tx.Prepare(..) // some raw sql\n  if err != nil {\n    return\n  }\n  defer stmt.Close()\n\n  res, err := stmt.Exec(..) // some var args\n  if err != nil {\n    return\n  }\n\n  /*\n    more tx sql statements and queries here\n  */\n\n  // success, commit and return result\n  commitTx = true\n  return\n}\n</code></pre>\n"}], "owner": {"reputation": 4924, "user_id": 3049865, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98dc179f82c2efee71cc49006397cfc5?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Kleinhans", "link": "https://stackoverflow.com/users/3049865/alexander-kleinhans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19174, "favorite_count": 7, "accepted_answer_id": 40076912, "answer_count": 2, "score": 11, "last_activity_date": 1530395577, "creation_date": 1476660275, "question_id": 40076596, "link": "https://stackoverflow.com/questions/40076596/raw-sql-transactions-with-golang-prepared-statements", "title": "Raw sql transactions with golang prepared statements", "body": "<p>I'm having trouble finding some examples that do three of the following things:</p>\n\n<p>1) Allow raw sql transactions in golang.</p>\n\n<p>2) Use prepared statements.</p>\n\n<p>3) Rollback on query failures.</p>\n\n<p>I would like to do something like this, but with prepared statements.</p>\n\n<pre><code>    stmt, stmt_err := db.Prepare(`\n            BEGIN TRANSACTION;\n\n            -- Insert record into first table.\n\n            INSERT INTO table_1 (\n                    thing_1,\n                    whatever)\n            VALUES($1,$2);\n\n            -- Inert record into second table.\n\n            INSERT INTO table_2 (\n                    thing_2,\n                    whatever)\n            VALUES($3,$4);\n\n            END TRANSACTION;\n            `)\n    if stmt_err != nil {\n            return stmt_err\n    }   \n    res, res_err := stmt.Exec(\n            thing_1,\n            whatever,\n            thing_2,\n            whatever)\n</code></pre>\n\n<p>When I run this, I get this error:\n<code>pq: cannot insert multiple commands into a prepared statement</code></p>\n\n<p>What gives? Are ACID compliant transactions even possible in golang? I cannot find an example.</p>\n\n<p>EDIT\nno examples <a href=\"http://go-database-sql.org/modifying.html\" rel=\"noreferrer\">here</a>.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 442675, "user_id": 148870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/559f9b4a76982a9c3e496e2e7686d4b1?s=128&d=identicon&r=PG", "display_name": "Amber", "link": "https://stackoverflow.com/users/148870/amber"}, "is_accepted": false, "score": 2, "last_activity_date": 1476652669, "creation_date": 1476652669, "answer_id": 40075589, "question_id": 40075548, "link": "https://stackoverflow.com/questions/40075548/is-there-a-pattern-for-implementing-a-static-variable-in-go/40075589#40075589", "title": "Is there a pattern for implementing a static variable in Go?", "body": "<p>A package-level variable that is initialized via <code>init()</code> should work for your use case.</p>\n"}], "owner": {"reputation": 1747, "user_id": 99025, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fdbf5302b10a42b009b2e47e244fe8c0?s=128&d=identicon&r=PG", "display_name": "Gary", "link": "https://stackoverflow.com/users/99025/gary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476702358, "creation_date": 1476652401, "question_id": 40075548, "link": "https://stackoverflow.com/questions/40075548/is-there-a-pattern-for-implementing-a-static-variable-in-go", "title": "Is there a pattern for implementing a static variable in Go?", "body": "<p>I am having a brain freeze</p>\n\n<p>I am trying to write a logging package to work with our enterprise logging system.</p>\n\n<p>I want to create the logger and it associated data at the beginning and reuse it throughout the service lifetime.</p>\n\n<p>something like this (pseudo code) at the entry point of the service</p>\n\n<pre><code>log := LogManager.CreateLogger(\"mylog\", \"DEBUG\")\n</code></pre>\n\n<p>use the following code in the rest of the service and imported packages </p>\n\n<pre><code>log := LogManager.GetLogger() \n</code></pre>\n\n<p>log would be the same instance - the one instantiated at the beginning.</p>\n\n<p>Thanks</p>\n\n<p>G</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 747, "user_id": 5539547, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/z3y7F.jpg?s=128&g=1", "display_name": "Tahseen", "link": "https://stackoverflow.com/users/5539547/tahseen"}, "edited": false, "score": 1, "creation_date": 1476651644, "post_id": 40075093, "comment_id": 67424000, "body": "Thanks. You answered my question :-)"}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "reply_to_user": {"reputation": 747, "user_id": 5539547, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/z3y7F.jpg?s=128&g=1", "display_name": "Tahseen", "link": "https://stackoverflow.com/users/5539547/tahseen"}, "edited": false, "score": 0, "creation_date": 1476664893, "post_id": 40075093, "comment_id": 67427123, "body": "you&#39;re welcome, may you mark my answer with the green mark, thanks in advance :)"}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "reply_to_user": {"reputation": 747, "user_id": 5539547, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/z3y7F.jpg?s=128&g=1", "display_name": "Tahseen", "link": "https://stackoverflow.com/users/5539547/tahseen"}, "edited": false, "score": 0, "creation_date": 1476682678, "post_id": 40075093, "comment_id": 67431062, "body": "well I have never asked nothing here, not sure how to do it, hahaha. What I say is a green mark like the first answer of this question <a href=\"http://stackoverflow.com/questions/38962121/scala-type-alias-confusion\" title=\"scala type alias confusion\">stackoverflow.com/questions/38962121/scala-type-alias-confus&zwnj;&#8203;ion</a>  (for example)"}], "tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": true, "score": 2, "last_activity_date": 1476653345, "last_edit_date": 1476653345, "creation_date": 1476649575, "answer_id": 40075093, "question_id": 40074698, "link": "https://stackoverflow.com/questions/40074698/using-rune-instead-of-string-in-scanln-in-golang/40075093#40075093", "title": "using rune instead of string in Scanln in Golang", "body": "<p>What you have is a slice not an array, they're different in <a href=\"https://blog.golang.org/slices\" rel=\"nofollow\">Go</a></p>\n\n<p>When you read each character from a string you will get a rune, for example:</p>\n\n<pre><code>for _, rune := range input { ... }\n// or\ninput[0] // it returns a rune\n</code></pre>\n\n<p>Now if you want to use index or more unicode manipulation you should keep in mind that each rune has a length and that lenght affects the length of the string too, see this example to better understanding, for example you see 3 characters in the string, but the lenght is 5:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"unicode/utf8\"\n)\n\nfunc main() {\n\n    input := \"a\u754cc\"\n\n    fmt.Println(len(input))\n\n    for index, rune := range input {\n        fmt.Println(index, utf8.RuneLen(rune), string(rune))    \n    }\n\n    fmt.Println(input[1:4]) // we know that the unicode character '\u754c'\n                            // starts in index 1 and ends in index 3\n}\n</code></pre>\n\n<p>run it here: <a href=\"https://play.golang.org/p/xvmH1laevS\" rel=\"nofollow\">https://play.golang.org/p/xvmH1laevS</a></p>\n"}], "owner": {"reputation": 747, "user_id": 5539547, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/z3y7F.jpg?s=128&g=1", "display_name": "Tahseen", "link": "https://stackoverflow.com/users/5539547/tahseen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 634, "favorite_count": 0, "accepted_answer_id": 40075093, "answer_count": 1, "score": 2, "last_activity_date": 1476653345, "creation_date": 1476647146, "question_id": 40074698, "link": "https://stackoverflow.com/questions/40074698/using-rune-instead-of-string-in-scanln-in-golang", "title": "using rune instead of string in Scanln in Golang", "body": "<p>Below is the code for reading the input from console</p>\n\n<pre><code>var message string\nfmt.Scanln(&amp;message)\n</code></pre>\n\n<p>But I wanted to try same with rune, which is unicode of byte</p>\n\n<pre><code>var input []rune\nfmt.Scanln(input)\n</code></pre>\n\n<p>As per my C/C++ knowledge, where an array's reference can be passed through its name , I thought it would work in case of rune</p>\n\n<p>But surprisingly the program passes Scanln in case of rune without even taking console input</p>\n\n<p>What is that am doing wrong? Or it cannot be done ? Or it requires type casting to string ?  </p>\n"}, {"tags": ["go", "dependency-management", "vendor"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1476646606, "post_id": 40073811, "comment_id": 67422396, "body": "<code>Glide creates a vendor directory at $GOPATH&#47;vendor</code>, that should not be. glide creates a vendor directory within your project folder (not to confuse with GOPATH). the project folder is more like the cwd where you created the <code>main.go</code> file. glide pulls dependencies into this vendor project, this has tbd before any attempt to build. I can t find the ref anymore, keep in mind that when go resolves a package path, it takes the longest one (vendor path within your project is, thus, always the longest)."}], "answers": [{"tags": [], "owner": {"reputation": 35, "user_id": 1055984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d10a38afddd5d5af4c63796366417476?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/1055984/mike"}, "is_accepted": false, "score": 0, "last_activity_date": 1476843106, "creation_date": 1476843106, "answer_id": 40120951, "question_id": 40073811, "link": "https://stackoverflow.com/questions/40073811/how-do-glide-managed-dependencies-work-with-a-build/40120951#40120951", "title": "How do Glide managed dependencies work with a build?", "body": "<p>Adding the answer for the next poor soul that comes along.</p>\n\n<p>If you're coming from the Java world, and you are used to the src directory being at the root of your project... Go says you are wrong.  As the commenter indicated, your project path is $GOPATH/src/[github.com]/username/projectname and that is where you should do your \"glide init\".</p>\n\n<p>That will create the glide.yaml file in the correct spot so \"glide install\" will create the vendor directory at $GOPATH/src/githost/username/projectname/vendor and then your go builds will work as expected.</p>\n\n<p>Hopefully this will clear it up for other folks who might have similar questions.</p>\n"}], "owner": {"reputation": 35, "user_id": 1055984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d10a38afddd5d5af4c63796366417476?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/1055984/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 530, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476843106, "creation_date": 1476642084, "question_id": 40073811, "link": "https://stackoverflow.com/questions/40073811/how-do-glide-managed-dependencies-work-with-a-build", "title": "How do Glide managed dependencies work with a build?", "body": "<p>I am using Go 1.7 and trying out Glide.  The part I'm not getting is, Glide creates a vendor directory at $GOPATH/vendor.  But when go builds it is looking for a vendor directory at $GOPATH/src/github.com/vendor/.../...</p>\n\n<p>So I'm missing the part that happens between installing/updating dependencies and making them available to my program during a build.</p>\n"}, {"tags": ["go", "variable-assignment", "slice", "scanline"], "answers": [{"comments": [{"owner": {"reputation": 5182, "user_id": 1116874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/225745f709ee9d202b396a9de7efeda4?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/1116874/jonathan"}, "edited": false, "score": 0, "creation_date": 1476642581, "post_id": 40073884, "comment_id": 67421025, "body": "Awe right. Totally makes sense. <code>(picture[i], pixels) = (pixels[:XSize], pixels[XSize:])</code>. Just wasn&#39;t seeing it that way."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1476644581, "last_edit_date": 1476644581, "creation_date": 1476642459, "answer_id": 40073884, "question_id": 40073773, "link": "https://stackoverflow.com/questions/40073773/how-does-this-common-idiom-actually-work/40073884#40073884", "title": "How does this &quot;common idiom&quot; actually work?", "body": "<p>This:</p>\n\n<pre><code>picture[i], pixels = pixels[:XSize], pixels[XSize:]\n</code></pre>\n\n<p>Is a tuple <a href=\"https://golang.org/ref/spec#Assignments\" rel=\"nofollow\">assignment</a>. It assigns a value to <code>picture[i]</code> and a value to <code>pixels</code>. The values assigned in order are <code>pixels[:XSize]</code> and <code>pixels[XSize:]</code>.</p>\n\n<blockquote>\n  <p>The assignment proceeds in two phases. First, the operands of <a href=\"https://golang.org/ref/spec#Index_expressions\" rel=\"nofollow\">index expressions</a> and <a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"nofollow\">pointer indirections</a> (including implicit pointer indirections in <a href=\"https://golang.org/ref/spec#Selectors\" rel=\"nofollow\">selectors</a>) on the left and the expressions on the right are all <a href=\"https://golang.org/ref/spec#Order_of_evaluation\" rel=\"nofollow\">evaluated in the usual order</a>. Second, the assignments are carried out in left-to-right order.</p>\n</blockquote>\n\n<p>What happens here is that when the loop starts (<code>i = 0</code>), the first element of <code>picture</code> (the first row) is assigned with a slice value being the first <code>XSize</code> elements in <code>pixels</code>, and the <code>pixels</code> slice is resliced so its first element will be the <code>XSize</code><sup>th</sup> element +1.</p>\n\n<p>So in the next iteration <code>picture[i]</code> will be the 2nd element in the <code>picture</code> (the 2nd row), and again, the first <code>XSize</code> elements from <code>pixels</code> will be set to it as a slice. But since in the previous iteration we resliced <code>pixels</code>, in each iteration its first <code>XSize</code> elements will be the subsequent rows.</p>\n"}, {"tags": [], "owner": {"reputation": 2098, "user_id": 425540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5fc21da5cd6a986180da38f33e41ff8?s=128&d=identicon&r=PG", "display_name": "levif", "link": "https://stackoverflow.com/users/425540/levif"}, "is_accepted": false, "score": 2, "last_activity_date": 1476643544, "creation_date": 1476643544, "answer_id": 40074092, "question_id": 40073773, "link": "https://stackoverflow.com/questions/40073773/how-does-this-common-idiom-actually-work/40074092#40074092", "title": "How does this &quot;common idiom&quot; actually work?", "body": "<p>This tuple assignment example can be rewritten like:</p>\n\n<pre><code>for i := range picture {\n    picture[i]= pixels[:XSize]\n    pixels = pixels[XSize:]\n}\n</code></pre>\n\n<p>It's now easier to see that <em>picture</em> is this first <em>XSize</em> items of <em>pixels</em>.</p>\n\n<p>And that  <em>pixels</em> <strong>is modified</strong> at each loop and drops its first <em>XSize</em> items.</p>\n"}], "owner": {"reputation": 5182, "user_id": 1116874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/225745f709ee9d202b396a9de7efeda4?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/1116874/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 40073884, "answer_count": 2, "score": 1, "last_activity_date": 1476644760, "creation_date": 1476641907, "last_edit_date": 1476644760, "question_id": 40073773, "link": "https://stackoverflow.com/questions/40073773/how-does-this-common-idiom-actually-work", "title": "How does this &quot;common idiom&quot; actually work?", "body": "<p>Looking at documentation for <a href=\"https://golang.org/doc/effective_go.html#two_dimensional_slices\" rel=\"nofollow\">golang's 2D slices</a> and cannot understand the syntax used in the last example:</p>\n\n<pre><code>func main() {\n    XSize := 5\n    YSize := 5\n\n    // Allocate the top-level slice, the same as before.\n    picture := make([][]uint8, YSize) // One row per unit of y.\n\n    // Allocate one large slice to hold all the pixels.\n    pixels := make([]uint8, XSize*YSize) // Has type []uint8 even though picture is [][]uint8.\n\n    // Loop over the rows, slicing each row from the front of the remaining pixe ls slice.\n    for i := range picture {\n        picture[i], pixels = pixels[:XSize], pixels[XSize:]\n    }\n}\n</code></pre>\n\n<p>I found the <a href=\"https://codereview.appspot.com/7423051/diff/6001/doc/effective_go.html\" rel=\"nofollow\">change request</a> where this was added to the docs and the change author had this normal / easy to understand code:</p>\n\n<pre><code>// Loop over the rows, slicing each row.\nfor i := range picture {\n     picture[i] = pixels[i*XSize:(i+1)*XSize]\n</code></pre>\n\n<p>However, there is the following comment:</p>\n\n<blockquote>\n  <p>fine. another common idiom is to avoid the math:</p>\n  \n  <p><code>picture[i], pixels = pixels[:XSize], pixels[XSize:]</code></p>\n</blockquote>\n\n<p>My question is how does the above achieve the same as the !\"avoid the math\" method? Some docs on what is going on would be great.</p>\n"}, {"tags": ["post", "go", "https"], "comments": [{"owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "edited": false, "score": 0, "creation_date": 1476640033, "post_id": 40072965, "comment_id": 67420079, "body": "You need to add CA of your certificate to your transport <a href=\"http://stackoverflow.com/a/38825553/2604529\">like</a>"}, {"owner": {"reputation": 1584, "user_id": 4396927, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6MEbT.jpg?s=128&g=1", "display_name": "vesche", "link": "https://stackoverflow.com/users/4396927/vesche"}, "reply_to_user": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "edited": false, "score": 0, "creation_date": 1476640429, "post_id": 40072965, "comment_id": 67420216, "body": "@MarcelNovy I&#39;m using a self-signed certificate... That doesn&#39;t have anything to do with my question."}, {"owner": {"reputation": 17595, "user_id": 41455, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4788a6e08db703f60f249356c95d5775?s=128&d=identicon&r=PG", "display_name": "superfell", "link": "https://stackoverflow.com/users/41455/superfell"}, "edited": false, "score": 0, "creation_date": 1476641875, "post_id": 40072965, "comment_id": 67420778, "body": "It would be useful if you mentioned how your current attempt at POST doesn&#39;t work."}], "answers": [{"tags": [], "owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "is_accepted": true, "score": 2, "last_activity_date": 1476643400, "last_edit_date": 1476643400, "creation_date": 1476642221, "answer_id": 40073831, "question_id": 40072965, "link": "https://stackoverflow.com/questions/40072965/golang-https-tls-post-client-server/40073831#40073831", "title": "Golang HTTPS/TLS POST client/server", "body": "<p>You didn't share the error message, but I assume the <code>client.Post</code> call wasn't allowing a string as its third parameter, because it requires an <code>io.Reader</code>. Try this instead:</p>\n\n<pre><code>out := s + \" world\"     \nresp, err := client.Post(link, \"text/plain\", bytes.NewBufferString(out))\n</code></pre>\n\n<p>On the server side, you already have the right code set up to handle the POST request. Just check the method:</p>\n\n<pre><code>http.HandleFunc(\"/static/\", func (w http.ResponseWriter, r *http.Request) {\n    if r.Method == \"POST\" {\n        // handle POST requests\n    } else {\n        // handle all other requests\n    }\n})\n</code></pre>\n\n<p>I noticed one other issue. Using <code>index.html</code> probably won't work here. <code>http.ServeFile</code> will redirect that path. See <a href=\"https://golang.org/pkg/net/http/#ServeFile\" rel=\"nofollow\">https://golang.org/pkg/net/http/#ServeFile</a>:</p>\n\n<blockquote>\n  <p>As a special case, ServeFile redirects any request where r.URL.Path\n  ends in \"/index.html\" to the same path, without the final\n  \"index.html\". To avoid such redirects either modify the path or use\n  ServeContent.</p>\n</blockquote>\n\n<p>I'd suggest just using a different file name to avoid that issue.</p>\n"}], "owner": {"reputation": 1584, "user_id": 4396927, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6MEbT.jpg?s=128&g=1", "display_name": "vesche", "link": "https://stackoverflow.com/users/4396927/vesche"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12826, "favorite_count": 0, "accepted_answer_id": 40073831, "answer_count": 1, "score": 5, "last_activity_date": 1476643400, "creation_date": 1476637475, "last_edit_date": 1476640515, "question_id": 40072965, "link": "https://stackoverflow.com/questions/40072965/golang-https-tls-post-client-server", "title": "Golang HTTPS/TLS POST client/server", "body": "<p>I have written a simple client/server in Go that will do an HTTP GET over TLS, but I'm trying to also make it capable of doing an HTTP POST over TLS.</p>\n\n<p>In the example below <code>index.html</code> just contains the text <code>hello</code>, and the HTTP GET is working fine. I want the client to get the HTTP GET and write back, <code>hello world</code> to the server.</p>\n\n<p>client</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/tls\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"strings\"\n)\n\nfunc main() {\n    link := \"https://10.0.0.1/static/index.html\"\n\n    tr := &amp;http.Transport{\n        TLSClientConfig: &amp;tls.Config{InsecureSkipVerify: true},\n    }\n    client := &amp;http.Client{Transport: tr}\n    response, err := client.Get(link)\n    if err != nil {\n        fmt.Println(err)\n    }\n    defer response.Body.Close()\n\n    content, _ := ioutil.ReadAll(response.Body)\n    s := strings.TrimSpace(string(content))\n\n    fmt.Println(s)\n\n    // out := s + \" world\"      \n    // Not working POST...\n    // resp, err := client.Post(link, \"text/plain\", &amp;out)\n\n}\n</code></pre>\n\n<p>server</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n    http.HandleFunc(\"/static/\", func (w http.ResponseWriter, r *http.Request) {\n        fmt.Println(\"Got connection!\")\n        http.ServeFile(w, r, r.URL.Path[1:])\n    })\n    log.Fatal(http.ListenAndServeTLS(\":443\", \"server.crt\", \"server.key\", nil))\n}\n</code></pre>\n\n<p>I also currently have nothing to handle the POST on the server side, but I just want it to print it out to the screen so when I run the client I will see the server print <code>hello world</code>.</p>\n\n<p>How should I fix my client code to do a proper POST? And what should the corresponding server code look like to accept the POST? Any help would be appreciated, I'm having trouble finding HTTPS/TLS POST examples.</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4651282"}, "edited": false, "score": 0, "creation_date": 1476625495, "post_id": 40070786, "comment_id": 67415171, "body": "your question not clear for me. What you want get as result?"}, {"owner": {"reputation": 1017, "user_id": 2691759, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/iAkAI.png?s=128&g=1", "display_name": "pigeonhands", "link": "https://stackoverflow.com/users/2691759/pigeonhands"}, "edited": false, "score": 0, "creation_date": 1476625679, "post_id": 40070786, "comment_id": 67415247, "body": "I want every (\\d+),(\\d+) regex match to replaced with a unique random number that ranges between the first digit and the second digit. So &quot;1,2 3,4 5,6&quot; would re replaced with (for example) &quot;2 4 5&quot;, because the first number is between 1-2, then the next is 3-4 then the next is between 5-6."}], "answers": [{"tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": false, "score": 1, "last_activity_date": 1476633399, "creation_date": 1476633399, "answer_id": 40072245, "question_id": 40070786, "link": "https://stackoverflow.com/questions/40070786/getting-the-group-values-in-the-replaceallstringfunc-callback/40072245#40072245", "title": "Getting the group values in the ReplaceAllStringFunc callback", "body": "<p>You will get each match individually as an argument to the function (<code>replaceFunc</code> will be called once per match, but not once per group).</p>\n\n<p>You could use <code>strings.Split</code> to split up the numbers, and then convert them to ints:</p>\n\n<p><a href=\"https://play.golang.org/p/ks0tkMQ2TY\" rel=\"nofollow\">https://play.golang.org/p/ks0tkMQ2TY</a></p>\n\n<pre><code>func replaceFunc(s string) string {\n    pieces:= strings.Split(s, \",\")\n    a,_ := strconv.Atoi(pieces[0])\n    b,_ := strconv.Atoi(pieces[1])\n    return strconv.Itoa(rand.Intn( b - a) + a)\n}\n\nfunc main() {\n    rand.Seed(time.Now().Unix())\n    repl := \"1,10 1,50 1,12 1,2 1,3\"\n    repl = regexp.MustCompile(\"(\\\\d+),(\\\\d+)\").ReplaceAllStringFunc(repl, replaceFunc)\n    fmt.Println(repl)\n}\n</code></pre>\n"}], "owner": {"reputation": 1017, "user_id": 2691759, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/iAkAI.png?s=128&g=1", "display_name": "pigeonhands", "link": "https://stackoverflow.com/users/2691759/pigeonhands"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476633399, "creation_date": 1476624407, "last_edit_date": 1476625566, "question_id": 40070786, "link": "https://stackoverflow.com/questions/40070786/getting-the-group-values-in-the-replaceallstringfunc-callback", "title": "Getting the group values in the ReplaceAllStringFunc callback", "body": "<p>Im trying to replace a string with random numbers with the number range determined in the string</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"regexp\"\n    \"strconv\"\n)\n\nfunc replaceFunc(s string) string {\n    groups := //?? How do i get the current mach groups\n    return rand.Intn( groups[2] - groups[1]) + groups[1]\n}\n\nfunc main() {\n    rand.Seed(time.Now().Unix())\n    repl := \"1,10 1,50 1,12 1,2 1,3\"\n    repl = regexp.MustCompile(\"(\\\\d+),(\\\\d+)\").ReplaceAllStringFunc(repl, replaceFunc)\n    fmt.Println(repl)\n}\n</code></pre>\n\n<p>How would I get the regex groups when replacing?</p>\n"}, {"tags": ["go", "router", "httpserver"], "answers": [{"tags": [], "owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "is_accepted": false, "score": 0, "last_activity_date": 1476628081, "last_edit_date": 1476628081, "creation_date": 1476627532, "answer_id": 40071320, "question_id": 40070168, "link": "https://stackoverflow.com/questions/40070168/how-to-build-own-simple-router-in-golang/40071320#40071320", "title": "how to build own simple router in golang?", "body": "<p>You have global variable <code>var r Router</code> but inside your <code>func main()</code> you create another, local one and path happens to be added only to it:</p>\n\n<pre><code> func main() {\n        r := newRouter()\n        r.Add(\"/hello\", hello)\n        Run(\":8080\")\n    }\n</code></pre>\n\n<p>simply adjust</p>\n\n<pre><code>var r =&amp;Router{}\n\nfunc Run(port string) {\n    Session = &amp;http.Server{\n        Addr:           port,\n        Handler:        r,\n        ReadTimeout:    10 * time.Second,\n        WriteTimeout:   10 * time.Second,\n        MaxHeaderBytes: 1 &lt;&lt; 20,\n    }\n    log.Fatal(Session.ListenAndServe())\n}\nfunc main() {\n    r = newRouter()\n    r.Add(\"/hello\", hello)\n    Run(\":8080\")\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3824, "user_id": 2728768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bb82b13cda86d3b821fa44100335ddf?s=128&d=identicon&r=PG", "display_name": "thoeni", "link": "https://stackoverflow.com/users/2728768/thoeni"}, "is_accepted": true, "score": 6, "last_activity_date": 1476629259, "last_edit_date": 1476629259, "creation_date": 1476627820, "answer_id": 40071366, "question_id": 40070168, "link": "https://stackoverflow.com/questions/40070168/how-to-build-own-simple-router-in-golang/40071366#40071366", "title": "how to build own simple router in golang?", "body": "<p>Your main function, by using the <code>:=</code> notation, is declaring and initialising a new local variable called r, whose scope is different from the global variable you have on the top of your listing.</p>\n\n<p>This means that the <code>r</code> variable that you're adding the handler to, is not the global one that you're trying to assign to the <code>Http.Server</code> struct, therefore your <code>ServeHTTP</code> will not find any mapping at all into its own receiver <code>r</code>.</p>\n\n<p>A solution is to declare the <code>r Router</code> as a pointer to a <code>Router</code>, like this:</p>\n\n<pre><code>var r *Router\n</code></pre>\n\n<p>and in your handler, you can pass directly the pointer without any dereference:</p>\n\n<pre><code>Session = &amp;http.Server{\n        Addr:           port,\n        Handler:        r,\n        ReadTimeout:    10 * time.Second,\n        WriteTimeout:   10 * time.Second,\n        MaxHeaderBytes: 1 &lt;&lt; 20,\n    }\n</code></pre>\n\n<p>Of course, remember to initialise the variable by assigning the pointer value and not declaring a new local one:</p>\n\n<pre><code>func main() {\n    r = newRouter()\n    r.Add(\"/hello\", hello)\n    Run(\":8080\")\n}\n</code></pre>\n"}], "owner": {"reputation": 680, "user_id": 5775751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4d69900ef436335a78df1ed16ee54f5?s=128&d=identicon&r=PG", "display_name": "onerciller", "link": "https://stackoverflow.com/users/5775751/onerciller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3389, "favorite_count": 1, "accepted_answer_id": 40071366, "answer_count": 2, "score": 3, "last_activity_date": 1483780846, "creation_date": 1476620370, "last_edit_date": 1483780846, "question_id": 40070168, "link": "https://stackoverflow.com/questions/40070168/how-to-build-own-simple-router-in-golang", "title": "how to build own simple router in golang?", "body": "<p>I am building own router in golang to understand logic , however I am getting 404 error not found normally, i able to running to server but I wrote function in <strong>hello</strong> name, it is not running. what could reason for this ? </p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"strings\"\n    \"time\"\n)\n\nvar Session *http.Server\nvar r Router\n\nfunc Run(port string) {\n    Session = &amp;http.Server{\n        Addr:           port,\n        Handler:        &amp;r,\n        ReadTimeout:    10 * time.Second,\n        WriteTimeout:   10 * time.Second,\n        MaxHeaderBytes: 1 &lt;&lt; 20,\n    }\n    log.Fatal(Session.ListenAndServe())\n}\n\ntype Handle func(http.ResponseWriter, *http.Request)\n\ntype Router struct {\n    mux map[string]Handle\n}\n\nfunc newRouter() *Router {\n    return &amp;Router{\n        mux: make(map[string]Handle),\n    }\n}\n\nfunc (r *Router) Add(path string, handle Handle) {\n    r.mux[path] = handle\n}\n\nfunc GetHeader(url string) string {\n    sl := strings.Split(url, \"/\")\n    return fmt.Sprintf(\"/%s\", sl[1])\n}\n\nfunc (rt *Router) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    head := GetHeader(r.URL.Path)\n    h, ok := rt.mux[head]\n    if ok {\n        h(w, r)\n        return\n    }\n    http.NotFound(w, r)\n}\n\nfunc hello(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"%s\", \"hello world\")\n}\n\nfunc main() {\n    r := newRouter()\n    r.Add(\"/hello\", hello)\n    Run(\":8080\")\n}\n</code></pre>\n"}, {"tags": ["go", "colors"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1476621170, "post_id": 40069550, "comment_id": 67413916, "body": "Please show an example of what you tried, what the output was, and what you expected to see."}], "answers": [{"comments": [{"owner": {"reputation": 665, "user_id": 1226008, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33f0e33470776483ac21fbad04d0c0ab?s=128&d=identicon&r=PG", "display_name": "Dany", "link": "https://stackoverflow.com/users/1226008/dany"}, "edited": false, "score": 0, "creation_date": 1476696336, "post_id": 40077438, "comment_id": 67438060, "body": "Thank you. It might be complex, because i am only used to python, ruby and php. The question also might seem to easy for some. Thank you for the help."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 665, "user_id": 1226008, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33f0e33470776483ac21fbad04d0c0ab?s=128&d=identicon&r=PG", "display_name": "Dany", "link": "https://stackoverflow.com/users/1226008/dany"}, "edited": false, "score": 0, "creation_date": 1476708365, "post_id": 40077438, "comment_id": 67445910, "body": "@Dany: is this is working there&#39;s probably something else incorrect going on, because you&#39;re taking alpha-premultiplied values, and putting them directly into a non-alpha-premultiplied color (this is going to re-multiply your alpha channel against the RGB values)"}, {"owner": {"reputation": 665, "user_id": 1226008, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33f0e33470776483ac21fbad04d0c0ab?s=128&d=identicon&r=PG", "display_name": "Dany", "link": "https://stackoverflow.com/users/1226008/dany"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476894747, "post_id": 40077438, "comment_id": 67543615, "body": "@JimB It seems to be working, but i cannot tell for sure now. I am still working on learning to code go with this project. Is there another way to convert RGBA to NRGBA and get the pixels that have changed?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 665, "user_id": 1226008, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33f0e33470776483ac21fbad04d0c0ab?s=128&d=identicon&r=PG", "display_name": "Dany", "link": "https://stackoverflow.com/users/1226008/dany"}, "edited": false, "score": 0, "creation_date": 1476898209, "post_id": 40077438, "comment_id": 67545525, "body": "@Dany: is the alpha channel always 255? You can see that if there an alpha, the RGBA output has to be different: <a href=\"https://play.golang.org/p/I0Gm--mlGk\" rel=\"nofollow noreferrer\">play.golang.org/p/I0Gm--mlGk</a>. Why do you need to &quot;convert&quot; to MRGBA? (assuming the values weren&#39;t supposed to be NRGBA to begin with)"}], "tags": [], "owner": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "is_accepted": true, "score": -1, "last_activity_date": 1476669023, "creation_date": 1476669023, "answer_id": 40077438, "question_id": 40069550, "link": "https://stackoverflow.com/questions/40069550/convert-rgba-to-nrgba/40077438#40077438", "title": "Convert RGBA to NRGBA", "body": "<p>Do you mean this? I did other refactors, your code seemed needlessly complex. </p>\n\n<p>I haven't tested this, didn't test images. </p>\n\n<pre><code>// Pixels are pixels.\ntype Pixel struct {\n    x, y  int\n    color color.NRGBA\n}\n\nfunc diffImages(imgOne image.RGBA, imgTwo image.RGBA) []Pixel {\n    var pixels []Pixel\n\n    bounds := imgOne.Bounds()\n\n    for y := bounds.Min.Y; y &lt; bounds.Max.Y; y++ {\n        for x := bounds.Min.X; x &lt; bounds.Max.X; x++ {\n\n            if !reflect.DeepEqual(imgOne.Pix, imgTwo.Pix) {\n\n                rt, gt, bt, at := imgTwo.At(x, y).RGBA()\n                pixel := new(Pixel)\n                pixel.x = x\n                pixel.y = y\n                pixel.color.R = uint8(rt)\n                pixel.color.G = uint8(gt)\n                pixel.color.B = uint8(bt)\n                pixel.color.A = uint8(at)\n                pixels = append(pixels, *pixel)\n            }\n        }\n    }\n    return pixels\n}\n</code></pre>\n"}], "owner": {"reputation": 665, "user_id": 1226008, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33f0e33470776483ac21fbad04d0c0ab?s=128&d=identicon&r=PG", "display_name": "Dany", "link": "https://stackoverflow.com/users/1226008/dany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1576, "favorite_count": 0, "accepted_answer_id": 40077438, "answer_count": 1, "score": 0, "last_activity_date": 1476669023, "creation_date": 1476615952, "last_edit_date": 1476616620, "question_id": 40069550, "link": "https://stackoverflow.com/questions/40069550/convert-rgba-to-nrgba", "title": "Convert RGBA to NRGBA", "body": "<p>I am trying to return the pixels that have changed and their color. The following func works fine, but it does not give me the 255,255,255 value i require. Is it possible to convert it to the format required?</p>\n\n<p>I already looked at the documentation here -> <a href=\"https://golang.org/pkg/image/color/\" rel=\"nofollow\">https://golang.org/pkg/image/color/</a></p>\n\n<p>I also tried different conversions manually, but i cannot get it to work. Does someone know how to convert this in golang?</p>\n\n<pre><code>type Pixel struct {\n    x, y  int\n    r, g, b, a uint32\n}\n\nfunc  diffImages(imgOne *image.RGBA, imgTwo *image.RGBA) []Pixel  {\nvar pixels []Pixel\n\nbounds := imgOne.Bounds()\ndiff := false\n\nfor y := bounds.Min.Y; y &lt; bounds.Max.Y; y++ {\n        for x := bounds.Min.X; x &lt; bounds.Max.X; x++ {\n\n            r, g, b, a := imgOne.At(x, y).RGBA()\n            rt, gt, bt, at := imgTwo.At(x, y).RGBA()\n\n            if r != rt || g != gt || b != bt || a != at {\n                diff=true\n            }\n\n            if diff == true {\n                pixel := new(Pixel)\n                pixel.x = x\n                pixel.y = y\n                pixel.r = rt\n                pixel.g = gt\n                pixel.b = bt\n                pixel.a = at\n                pixels = append(pixels, *pixel)\n            }\n\n            diff = false\n        }\n    }\nreturn pixels\n}\n</code></pre>\n\n<p>If there is another better or faster way to get the required output than i am willing to accept.</p>\n\n<p>Note: I am new to go.</p>\n"}, {"tags": ["go", "environment-variables"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 1, "creation_date": 1476604418, "post_id": 40067997, "comment_id": 67409661, "body": "take a look at <a href=\"https://golang.org/doc/install\" rel=\"nofollow noreferrer\">golang.org/doc/install</a>"}, {"owner": {"reputation": 7537, "user_id": 4263818, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AzSa2.jpg?s=128&g=1", "display_name": "R Menke", "link": "https://stackoverflow.com/users/4263818/r-menke"}, "edited": false, "score": 1, "creation_date": 1476628236, "post_id": 40067997, "comment_id": 67416161, "body": "@AhmedOzmaan that is just a bad tutorial. Follow the official guide : <a href=\"https://golang.org/doc/install\" rel=\"nofollow noreferrer\">golang install</a>. You don&#39;t set <code>GOPATH</code> or <code>GOBIN</code> for each project. You set it once to a general &quot;go&quot; folder. As longs as the contents of this folder follow go conventions, everything will work. <code>GOPATH</code> contains <code>src</code>, <code>bin</code>, <code>pkg</code>. <code>src</code> contains source files and should be structured in this way : <code>version-control&#47;account-name&#47;repository</code>. For example <code>github.com&#47;ahmed&#47;my-project</code>."}], "answers": [{"comments": [{"owner": {"reputation": 148, "user_id": 5528501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w5RdA.jpg?s=128&g=1", "display_name": "Ahmed Ozmaan", "link": "https://stackoverflow.com/users/5528501/ahmed-ozmaan"}, "edited": false, "score": 0, "creation_date": 1476612481, "post_id": 40068350, "comment_id": 67411588, "body": "i&#39;m new to  go working on this tutorial   <a href=\"https://youtu.be/SPEv_70RnKo\" rel=\"nofollow noreferrer\">link</a>, creating new project i have to  set  GOPATH and GOBIN with my new project that is in the documentation  isn&#39;t it?, then working an other  project i need to do like that again, again and again. so searching simple way to do that, do you understood me know"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 148, "user_id": 5528501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w5RdA.jpg?s=128&g=1", "display_name": "Ahmed Ozmaan", "link": "https://stackoverflow.com/users/5528501/ahmed-ozmaan"}, "edited": false, "score": 1, "creation_date": 1476646081, "post_id": 40068350, "comment_id": 67422221, "body": "@AhmedOzmaan Yes, I understand. If you have set <code>GOPATH</code>, don&#39;t set <code>GOBIN</code>: its default value will be <code>GOPATH&#47;bin</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1329187"}, "edited": false, "score": 0, "creation_date": 1502706637, "post_id": 40068350, "comment_id": 78302245, "body": "What if my <code>GOPATH</code> has multiple directories? Which <code>GOBIN</code> do I get?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1502708077, "post_id": 40068350, "comment_id": 78303073, "body": "@Alexandr The first one. Like packages in <a href=\"https://golang.org/cmd/go/#hdr-GOPATH_environment_variable\" rel=\"nofollow noreferrer\">golang.org/cmd/go/#hdr-GOPATH_environment_variable</a>: &quot;Go searches each directory listed in GOPATH to find source code, but new packages are always downloaded into the first directory in the list. &quot;"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 5, "last_activity_date": 1476606207, "last_edit_date": 1592644375, "creation_date": 1476606207, "answer_id": 40068350, "question_id": 40067997, "link": "https://stackoverflow.com/questions/40067997/how-to-set-gobin-automatically/40068350#40068350", "title": "How to set GOBIN automatically", "body": "<p><code>GOBIN</code> should by default be <code>GOPATH/bin</code>, so you don't have to do anything</p>\n<p>See &quot;<a href=\"https://golang.org/cmd/go/\" rel=\"noreferrer\"><code>GOPATH</code> environment variable</a>&quot;</p>\n<blockquote>\n<p><code>DIR</code> is a directory listed in the <code>GOPATH</code></p>\n<p>If the <code>GOBIN</code> environment variable is set, commands are installed to the directory it names instead of DIR/bin</p>\n</blockquote>\n"}], "owner": {"reputation": 148, "user_id": 5528501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w5RdA.jpg?s=128&g=1", "display_name": "Ahmed Ozmaan", "link": "https://stackoverflow.com/users/5528501/ahmed-ozmaan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7739, "favorite_count": 2, "accepted_answer_id": 40068350, "answer_count": 1, "score": 3, "last_activity_date": 1572809672, "creation_date": 1476603246, "last_edit_date": 1572809672, "question_id": 40067997, "link": "https://stackoverflow.com/questions/40067997/how-to-set-gobin-automatically", "title": "How to set GOBIN automatically", "body": "<p>working my go project i need to<br>\n<code>set GOPATH=D:\\projects\\go\\my project</code><br>\nand then<br>\n<code>set GOBIN=D:\\projects\\go\\my project\\bin</code><br>\nthat is okey </p>\n\n<p>then working on an other project same process a gain<br>\nso is there is away of setting only GOPATH<br>\nand automatically GOBIN becomes GOPATH\\bin</p>\n"}, {"tags": ["c", "linux", "macos", "go", "tty"], "comments": [{"owner": {"reputation": 32098, "user_id": 124319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVhrR.jpg?s=128&g=1", "display_name": "coredump", "link": "https://stackoverflow.com/users/124319/coredump"}, "edited": false, "score": 0, "creation_date": 1476602785, "post_id": 40067878, "comment_id": 67409347, "body": "There are interesting approaches over there: <a href=\"http://unix.stackexchange.com/a/249764/65275\">unix.stackexchange.com/a/249764/65275</a>"}, {"owner": {"reputation": 17710, "user_id": 265072, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/bffb04386858bb26825e8791c41dd8f3?s=128&d=identicon&r=PG", "display_name": "Ethan", "link": "https://stackoverflow.com/users/265072/ethan"}, "reply_to_user": {"reputation": 32098, "user_id": 124319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVhrR.jpg?s=128&g=1", "display_name": "coredump", "link": "https://stackoverflow.com/users/124319/coredump"}, "edited": false, "score": 0, "creation_date": 1476602987, "post_id": 40067878, "comment_id": 67409382, "body": "Thanks but all those solutions depend on certain external programs. I need to write a standalone program that works without requiring the client system to have certain things installed."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1476603322, "post_id": 40067878, "comment_id": 67409450, "body": "<a href=\"http://unix.stackexchange.com/q/21147/12106\">This Unix &amp; Linux Stack Exchange question</a> might be more relevant. The term you really want to search for is <i>pseudo tty</i> (or <i>pty</i>)."}, {"owner": {"reputation": 17710, "user_id": 265072, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/bffb04386858bb26825e8791c41dd8f3?s=128&d=identicon&r=PG", "display_name": "Ethan", "link": "https://stackoverflow.com/users/265072/ethan"}, "edited": false, "score": 2, "creation_date": 1476603441, "post_id": 40067878, "comment_id": 67409470, "body": "I know but correct me if I&#39;m wrong. Unix Stacke Exchange is for unix <i>tools</i>, not for programming questions."}, {"owner": {"reputation": 32098, "user_id": 124319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVhrR.jpg?s=128&g=1", "display_name": "coredump", "link": "https://stackoverflow.com/users/124319/coredump"}, "edited": false, "score": 0, "creation_date": 1476603869, "post_id": 40067878, "comment_id": 67409559, "body": "<a href=\"https://stackoverflow.com/questions/8374000/how-to-use-pseudo-terminals-in-linux-with-c\" title=\"how to use pseudo terminals in linux with c\">stackoverflow.com/questions/8374000/&hellip;</a> and <a href=\"https://stackoverflow.com/questions/476354/how-do-nix-pseudo-terminals-work-whats-the-master-slave-channel\" title=\"how do nix pseudo terminals work whats the master slave channel\">stackoverflow.com/questions/476354/&hellip;</a> with some code examples. Could you provide a little more information about what you want to achieve?"}, {"owner": {"reputation": 17710, "user_id": 265072, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/bffb04386858bb26825e8791c41dd8f3?s=128&d=identicon&r=PG", "display_name": "Ethan", "link": "https://stackoverflow.com/users/265072/ethan"}, "edited": false, "score": 2, "creation_date": 1476604063, "post_id": 40067878, "comment_id": 67409587, "body": "The purpose is to preserve color codes read from any program."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1476605526, "post_id": 40067878, "comment_id": 67409883, "body": "True about the U&amp;L SE, but the first point in the accepted answer will give you hints enough to help you get going (<a href=\"http://man7.org/linux/man-pages/man7/pty.7.html\" rel=\"nofollow noreferrer\">reading the <code>pty</code> manual page</a>)."}, {"owner": {"reputation": 229, "user_id": 1937358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd174b6446235bc6831243f9fc7493c?s=128&d=identicon&r=PG", "display_name": "user1937358", "link": "https://stackoverflow.com/users/1937358/user1937358"}, "edited": false, "score": 0, "creation_date": 1476627059, "post_id": 40067878, "comment_id": 67415719, "body": "If I recall correctly, <code>less -R</code> does preserve the color codes. Using <code>strace</code> to analyze the syscalls it employs might gives you some hints."}, {"owner": {"reputation": 32098, "user_id": 124319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVhrR.jpg?s=128&g=1", "display_name": "coredump", "link": "https://stackoverflow.com/users/124319/coredump"}, "edited": false, "score": 2, "creation_date": 1476627321, "post_id": 40067878, "comment_id": 67415814, "body": "Maybe this: <a href=\"https://github.com/kr/pty\" rel=\"nofollow noreferrer\">github.com/kr/pty</a>?"}, {"owner": {"reputation": 17710, "user_id": 265072, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/bffb04386858bb26825e8791c41dd8f3?s=128&d=identicon&r=PG", "display_name": "Ethan", "link": "https://stackoverflow.com/users/265072/ethan"}, "edited": false, "score": 0, "creation_date": 1476663180, "post_id": 40067878, "comment_id": 67426794, "body": "I found <a href=\"http://man7.org/tlpi/code/online/dist/pty/unbuffer.c.html\" rel=\"nofollow noreferrer\">example code</a> for a program that&#39;s similar to <a href=\"http://linuxcommand.org/man_pages/unbuffer1.html\" rel=\"nofollow noreferrer\">UNBUFFER(1)</a>. Works very well!"}], "answers": [{"tags": [], "owner": {"reputation": 17710, "user_id": 265072, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/bffb04386858bb26825e8791c41dd8f3?s=128&d=identicon&r=PG", "display_name": "Ethan", "link": "https://stackoverflow.com/users/265072/ethan"}, "is_accepted": false, "score": 3, "last_activity_date": 1478810414, "last_edit_date": 1478810414, "creation_date": 1476845847, "answer_id": 40121343, "question_id": 40067878, "link": "https://stackoverflow.com/questions/40067878/write-program-that-pretends-to-be-a-tty/40121343#40121343", "title": "Write program that pretends to be a TTY", "body": "<p>The following is fully working code for running a command in a pty and capturing its output. (Not as many lines as you may have thought.)</p>\n\n<pre><code>#include &lt;signal.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sysexits.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;util.h&gt;\n\npid_t child = 0;\n\nvoid sighandler(int signum) {\n  if (child &gt; 0) {\n    killpg(child, signum);\n    exit(signum);\n  }\n}\n\n// Run a command in a pty.\n// Usage: /path/to/this/binary command to run\nint main(int argc, char *argv[]) {\n  if (argc &lt; 2) {\n    return EX_USAGE;\n  }\n\n  int master;\n  child = forkpty(&amp;master, NULL, NULL, NULL);\n\n  if (child == -1) {\n    perror(\"failed to fork pty\");\n    return EX_OSERR;\n  }\n\n  if (child == 0) {\n    // we're in the child process, so replace it with the command\n    execvp(argv[1], argv + 1);\n    perror(\"failed to execute command\");\n    return EX_OSERR;\n  }\n\n  // trap kill signals and forward them to child process\n  signal(SIGHUP, sighandler);\n  signal(SIGINT, sighandler);\n  signal(SIGTERM, sighandler);\n\n  const int buf_size = 1024;\n  char buf[buf_size];\n  fd_set fds;\n  ssize_t bytes_read;\n\n  // forward the output continuously\n  while (1) {\n    FD_ZERO(&amp;fds);\n    FD_SET(master, &amp;fds);\n\n    if (select(master + 1, &amp;fds, NULL, NULL, NULL) &gt; 0 &amp;&amp; FD_ISSET(master, &amp;fds)) {\n      bytes_read = read(master, buf, buf_size);\n      if (bytes_read &lt;= 0) {\n        return EXIT_SUCCESS;\n      }\n\n      if (write(STDOUT_FILENO, buf, bytes_read) != bytes_read) {\n        perror(\"failed to write to stdout\");\n        return EX_OSERR;\n      }\n    }\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 17710, "user_id": 265072, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/bffb04386858bb26825e8791c41dd8f3?s=128&d=identicon&r=PG", "display_name": "Ethan", "link": "https://stackoverflow.com/users/265072/ethan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1700, "favorite_count": 0, "answer_count": 1, "score": 13, "last_activity_date": 1478810414, "creation_date": 1476602305, "last_edit_date": 1478810204, "question_id": 40067878, "link": "https://stackoverflow.com/questions/40067878/write-program-that-pretends-to-be-a-tty", "title": "Write program that pretends to be a TTY", "body": "<p>I'm writing a program that reads input from stdin, manipulates the input, and writes output to stdout. However, many programs check whether stdin is a terminal or a pipe (by calling a function like <a href=\"http://man7.org/linux/man-pages/man3/isatty.3.html\" rel=\"nofollow noreferrer\"><code>isatty</code></a>), and generate output differently. How do I have my program pretend to be a TTY?</p>\n\n<p>The solution should work on both Linux and macOS. Any programming language that generates a standalone binary is acceptable, but Go is preferred.</p>\n\n<p>Note that I'm asking a programming question, not asking for a tool. So, things like <code>script</code> or <code>unbuffer</code> is not something I'm looking for.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1506, "user_id": 2831700, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5e40a909ecdd6e94a32e120c0044ac9d?s=128&d=identicon&r=PG", "display_name": "IvRRimUm", "link": "https://stackoverflow.com/users/2831700/ivrrimum"}, "edited": false, "score": 0, "creation_date": 1476570644, "post_id": 40064848, "comment_id": 67403792, "body": "I don&#39;t get the logic behind this? Do you calculate <code>a</code> value from the count of <code>b</code> indexes?"}, {"owner": {"reputation": 93, "user_id": 2047411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d4345cc6ca982c66c63177c507421d3?s=128&d=identicon&r=PG", "display_name": "inalgnu", "link": "https://stackoverflow.com/users/2047411/inalgnu"}, "reply_to_user": {"reputation": 1506, "user_id": 2831700, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5e40a909ecdd6e94a32e120c0044ac9d?s=128&d=identicon&r=PG", "display_name": "IvRRimUm", "link": "https://stackoverflow.com/users/2831700/ivrrimum"}, "edited": false, "score": 0, "creation_date": 1476570963, "post_id": 40064848, "comment_id": 67403853, "body": "nope, i trying to merge all &quot;b&quot; values of the same &quot;a&quot; value. so for a : 1 =&gt; [1,2] + [3,4] + [5,6] (b values from all the other arrays with the same &quot;a&quot; value)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1476594821, "post_id": 40064848, "comment_id": 67407817, "body": "See this related question: <a href=\"http://stackoverflow.com/questions/39987023/golang-group-and-sum-slice-of-structs/39989962#39989962\">Group and sum slice of structs</a>."}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 2047411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d4345cc6ca982c66c63177c507421d3?s=128&d=identicon&r=PG", "display_name": "inalgnu", "link": "https://stackoverflow.com/users/2047411/inalgnu"}, "edited": false, "score": 0, "creation_date": 1479243695, "post_id": 40068072, "comment_id": 68473444, "body": "thank you @darshan-rivka-whittle for your response. Sorry my question was not clear enough, i was thinking about a json array input and a json array output."}, {"owner": {"reputation": 2760, "user_id": 2639188, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c1a58be9b3e79cc22a37cad79a992438?s=128&d=identicon&r=PG", "display_name": "DoIt", "link": "https://stackoverflow.com/users/2639188/doit"}, "edited": false, "score": 0, "creation_date": 1586189108, "post_id": 40068072, "comment_id": 108030642, "body": "What if a is actually an object of int and string , not just an int?"}], "tags": [], "owner": {"reputation": 29582, "user_id": 1427098, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Bvdm0.jpg?s=128&g=1", "display_name": "Darshan Rivka Whittle", "link": "https://stackoverflow.com/users/1427098/darshan-rivka-whittle"}, "is_accepted": true, "score": 15, "last_activity_date": 1476603783, "creation_date": 1476603783, "answer_id": 40068072, "question_id": 40064848, "link": "https://stackoverflow.com/questions/40064848/group-by-key-merge-array-values/40068072#40068072", "title": "Group by key + merge array values", "body": "<p>Your code isn't Go code (it would pass as Ruby), which, along with no clear attempt on your part to actually solve the problem, is probably why you got some downvotes and no answers yet.</p>\n\n<p>One approach would be to interpret your code as Ruby would, with <code>input</code> a slice of slices of maps of (string, maybe, although Ruby would treat them as Symbols) keys to either ints (in the case of <code>a</code>) or slices of ints (in the case of <code>b</code>).  You could do that with the map values using the empty interface (<code>interface{}</code>), but it would be more straightforward to use a struct like this:</p>\n\n<pre><code>type ab struct {\n    a int\n    b []int\n}\n</code></pre>\n\n<p>and have <code>input</code> be a <code>[][]ab</code>.  But as long as we're restructuring your data to fit the language better, it's even more straightforward to do away with <code>a</code> and <code>b</code> altogether, replacing that structure with a map where the <code>a</code> values are the keys and the <code>b</code> values are the values.  Things are then a simple matter of iterating over <code>input</code> and appending slices into <code>output</code>:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    input := []map[int][]int{\n        {\n            1: []int{1, 2},\n            2: []int{1, 2},\n            3: []int{1, 2},\n        },\n        {\n            1: []int{3, 4},\n            2: []int{3, 4},\n            3: []int{3, 4},\n            4: []int{3, 4},\n        },\n        {\n            1: []int{5, 6},\n            2: []int{5, 6},\n            3: []int{5, 6},\n            4: []int{5, 6},\n            5: []int{5, 6},\n        },\n    }\n\n    output := make(map[int][]int)\n\n    for _, m := range input {\n        for k, v := range m {\n            output[k] = append(output[k], v...)\n        }\n    }\n\n    fmt.Println(output)\n}\n</code></pre>\n\n<p>This produces the output:</p>\n\n<pre><code>map[1:[1 2 3 4 5 6] 2:[1 2 3 4 5 6] 3:[1 2 3 4 5 6] 4:[3 4 5 6] 5:[5 6]]\n</code></pre>\n\n<p><code>output</code> thus has the data organized as you wanted, given the modified way of representing that data organization.</p>\n"}], "owner": {"reputation": 93, "user_id": 2047411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d4345cc6ca982c66c63177c507421d3?s=128&d=identicon&r=PG", "display_name": "inalgnu", "link": "https://stackoverflow.com/users/2047411/inalgnu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11150, "favorite_count": 2, "accepted_answer_id": 40068072, "answer_count": 1, "score": 6, "last_activity_date": 1554256120, "creation_date": 1476570189, "last_edit_date": 1554256120, "question_id": 40064848, "link": "https://stackoverflow.com/questions/40064848/group-by-key-merge-array-values", "title": "Group by key + merge array values", "body": "<p>I'm trying to merge the array values of multiple arrays with same keys (sort of group by + merge).  Is there any native way in Go to transform this input:  </p>\n\n<pre><code>input = [\n    [\n        { a: 1, b: [1,2]},\n        { a: 2, b: [1,2]},\n        {\u00a0a: 3, b: [1,2]}\n    ],\n    [\n        { a: 1, b: [3,4]},\n        { a: 2, b: [3,4]},\n        { a: 3, b: [3,4]},\n        { a: 4, b: [3,4]}\n    ],\n    [\n        { a:1, b: [5,6]},\n        { a:2, b: [5,6]},\n        { a:3, b: [5,6]},\n        { a:4, b: [5,6]},\n        { a:5, b: [5,6]}\n    ]\n ]\n</code></pre>\n\n<p>into:</p>\n\n<pre><code>output = [\n    { a: 1, b: [1,2,3,4,5,6]},\n    { a: 2, b: [1,2,3,4,5,6]},\n    { a: 3, b: [1,2,3,4,5,6]},\n    { a: 4, b: [3,4, 5,6]},\n    { a: 5, b: [5,6]},\n]\n</code></pre>\n"}, {"tags": ["go", "unique", "tiedot", "nosql"], "answers": [{"comments": [{"owner": {"reputation": 458695, "user_id": 20860, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/iavmP.jpg?s=128&g=1", "display_name": "Bill Karwin", "link": "https://stackoverflow.com/users/20860/bill-karwin"}, "edited": false, "score": 0, "creation_date": 1476633189, "post_id": 40072156, "comment_id": 67417773, "body": "So you literally read the whole database table into memory as a map? What happens when your table is too large to fit in application memory?"}, {"owner": {"reputation": 458695, "user_id": 20860, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/iavmP.jpg?s=128&g=1", "display_name": "Bill Karwin", "link": "https://stackoverflow.com/users/20860/bill-karwin"}, "edited": false, "score": 0, "creation_date": 1476633469, "post_id": 40072156, "comment_id": 67417860, "body": "Also if this is a web app, you could have this code running hundreds or thousands of requests concurrently. But if you mutex access to the map, you&#39;ve just caused your website to run requests serially."}, {"owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "reply_to_user": {"reputation": 458695, "user_id": 20860, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/iavmP.jpg?s=128&g=1", "display_name": "Bill Karwin", "link": "https://stackoverflow.com/users/20860/bill-karwin"}, "edited": false, "score": 0, "creation_date": 1476634127, "post_id": 40072156, "comment_id": 67418081, "body": "Not necessarily to keep all database, could be logins only. Also I&#39;m using  u.RLock() to minimize awaiting time for reading requests. And yes, I do have thousands requests concurrently."}, {"owner": {"reputation": 458695, "user_id": 20860, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/iavmP.jpg?s=128&g=1", "display_name": "Bill Karwin", "link": "https://stackoverflow.com/users/20860/bill-karwin"}, "edited": false, "score": 0, "creation_date": 1476634721, "post_id": 40072156, "comment_id": 67418265, "body": "Right, enforcing uniqueness on a login name is one thing. The table is likely to be small, and new logins created can tolerate some serialization. But this is not a general solution for uniqueness in any column of any table."}, {"owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "reply_to_user": {"reputation": 458695, "user_id": 20860, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/iavmP.jpg?s=128&g=1", "display_name": "Bill Karwin", "link": "https://stackoverflow.com/users/20860/bill-karwin"}, "edited": false, "score": 0, "creation_date": 1476635453, "post_id": 40072156, "comment_id": 67418493, "body": "Sure, it is in context of current task only. I&#39;m using this approach mostly alongside with microservice architecture, when every service requires its own database."}, {"owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "reply_to_user": {"reputation": 18922, "user_id": 3633742, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/thyJX.jpg?s=128&g=1", "display_name": "n00dl3", "link": "https://stackoverflow.com/users/3633742/n00dl3"}, "edited": false, "score": 0, "creation_date": 1476646748, "post_id": 40072156, "comment_id": 67422441, "body": "@n00dl3 I believe I answered your question. It is -&quot;<b>How to ensure uniqueness of a property in a NoSQL record ( Golang + tiedot )</b>&quot; and not like -&quot;Should I use SQL or switch to something else&quot;. Please clarify."}, {"owner": {"reputation": 18922, "user_id": 3633742, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/thyJX.jpg?s=128&g=1", "display_name": "n00dl3", "link": "https://stackoverflow.com/users/3633742/n00dl3"}, "edited": false, "score": 0, "creation_date": 1476647933, "post_id": 40072156, "comment_id": 67422782, "body": "I&#39;m sorry if i made you waste your time, but keeping the whole user collection in memory would have been too expensive for what I wanted to do. Note that the end of my question is &quot;or should i switch to a database engine that supports transactions ?&quot;. I voted-up your answer, but as your solution has a non-negligible cost and as I was already thinking about switching to another DB engine, I don&#39;t think i can consider it as &quot;best answer&quot;."}, {"owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "edited": false, "score": 0, "creation_date": 1476650666, "post_id": 40072156, "comment_id": 67423690, "body": "I simply want other people to find a correct solution. By the way the memory consumption for 100K user logins is less than 5Mb and the performance is a way far better than any not in memory DBs. Thanks for vote-up"}, {"owner": {"reputation": 458695, "user_id": 20860, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/iavmP.jpg?s=128&g=1", "display_name": "Bill Karwin", "link": "https://stackoverflow.com/users/20860/bill-karwin"}, "edited": false, "score": 0, "creation_date": 1476659447, "post_id": 40072156, "comment_id": 67426059, "body": "I also upvoted your answer, since it provides a working solution, although one that I believe does not scale up to real-world scenarios. But kudos anyway for going to the trouble of writing the code."}], "tags": [], "owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "is_accepted": false, "score": 2, "last_activity_date": 1476632789, "creation_date": 1476632789, "answer_id": 40072156, "question_id": 40064806, "link": "https://stackoverflow.com/questions/40064806/how-to-ensure-uniqueness-of-a-property-in-a-nosql-record-golang-tiedot/40072156#40072156", "title": "How to ensure uniqueness of a property in a NoSQL record ( Golang + tiedot )", "body": "<p>Below is my solution. It is not Tiedot specific, but It uses <a href=\"http://martinfowler.com/bliki/CQRS.html\" rel=\"nofollow\">CQRS</a> and can be applied to various DBs.</p>\n\n<p>You can also have other benefits using it, such as caching and bulk write (in case DB supports it) to prevent asking DB on every request.</p>\n\n<pre><code>package main\n\nimport (\n    \"sync\"\n    \"log\"\n    \"errors\"\n)\n\ntype User struct {\n    Login        string\n    PasswordHash string\n    Salt         string\n}\n\ntype MutexedUser struct {\n    sync.RWMutex\n    Map map[string]User\n}\n\nvar u = &amp;MutexedUser{}\n\nfunc main() {\n    var user User\n\n    u.Sync()\n    // Get new user here\n    //...\n    if err := u.Insert(user); err != nil {\n        // Ask to provide new login\n        //...\n        log.Println(err)\n    }\n}\n\nfunc (u *MutexedUser) Insert(user User) (err error) {\n    u.Lock()\n    if _, ok := u.Map[user.Login]; !ok {\n        u.Map[user.Login] = user\n        // Add user to DB\n        //...\n        u.Unlock()\n        return err\n    }\n    u.Unlock()\n    return errors.New(\"duplicated login\")\n}\n\nfunc (u *MutexedUser) Read(login string) User {\n    u.RLock()\n    value := u.Map[login]\n    u.RUnlock()\n\n    return value\n}\n\nfunc (u *MutexedUser) Sync() (err error) {\n    var users []User\n\n    u.Lock()\n    defer u.Unlock()\n    // Read users from DB\n    //...\n    u.Map = make(map[string]User)\n    for _, user := range users {\n        u.Map[user.Login] = user\n    }\n    return err\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 18922, "user_id": 3633742, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/thyJX.jpg?s=128&g=1", "display_name": "n00dl3", "link": "https://stackoverflow.com/users/3633742/n00dl3"}, "edited": false, "score": 0, "creation_date": 1476638777, "post_id": 40072465, "comment_id": 67419652, "body": "Yeah, you&#39;re right. I&#39;ve already switched to &#224; SQLite back-end as I didn&#39;t want to waste more time trying another solution. I felt too confident regarding the 1000+ stars on github, my bad... Thank you for taking time to answer."}], "tags": [], "owner": {"reputation": 458695, "user_id": 20860, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/iavmP.jpg?s=128&g=1", "display_name": "Bill Karwin", "link": "https://stackoverflow.com/users/20860/bill-karwin"}, "is_accepted": true, "score": 1, "last_activity_date": 1476634638, "creation_date": 1476634638, "answer_id": 40072465, "question_id": 40064806, "link": "https://stackoverflow.com/questions/40064806/how-to-ensure-uniqueness-of-a-property-in-a-nosql-record-golang-tiedot/40072465#40072465", "title": "How to ensure uniqueness of a property in a NoSQL record ( Golang + tiedot )", "body": "<blockquote>\n  <p>I first thought that I could just search for user by login before inserting, but as the database will be used concurently, it is not reliable.</p>\n</blockquote>\n\n<p>Right, it creates a race condition. The only way to resolve this is:</p>\n\n<ol>\n<li>Lock the table</li>\n<li>Search for the login</li>\n<li>Insert if the login is not found</li>\n<li>Unlock the table</li>\n</ol>\n\n<p>Table-locks are not a scalable solution, because it creates an expensive bottleneck in your application. It's why non-transactional storage engines like MySQL's MyISAM are being phased out. It's why MongoDB has to use clusters to scale up.</p>\n\n<p>It can work if you have a small dataset size and a light amount of concurrency, so perhaps it's adequate for login creation on a lightly-used website. New logins probably aren't created so frequently that they need to scale up so much. </p>\n\n<p>But users logging in, or password changes, or other changes to account attributes, do happen more frequently.</p>\n\n<p>The solution for this is to make this operation atomic, to avoid race conditions. For example, attempt the insert and have the database engine verify uniqueness and reject the insert if it violates that constraint.</p>\n\n<p>Unfortunately, I don't see any documentation in tiedot that shows that it supports a unique constraint or a uniqueness enforcement on indexes.</p>\n\n<p>Tiedot is 98% written by a single developer, in a period of about 2 years (May 2013 - April 2015). Very little activity since then (see <a href=\"https://www.openhub.net/p/tiedot\" rel=\"nofollow\">https://www.openhub.net/p/tiedot</a>). I would consider tiedot to be an experimental project, unlikely to expand in feature set.</p>\n"}], "owner": {"reputation": 18922, "user_id": 3633742, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/thyJX.jpg?s=128&g=1", "display_name": "n00dl3", "link": "https://stackoverflow.com/users/3633742/n00dl3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "accepted_answer_id": 40072465, "answer_count": 2, "score": 3, "last_activity_date": 1503712412, "creation_date": 1476569752, "last_edit_date": 1506103282, "question_id": 40064806, "link": "https://stackoverflow.com/questions/40064806/how-to-ensure-uniqueness-of-a-property-in-a-nosql-record-golang-tiedot", "title": "How to ensure uniqueness of a property in a NoSQL record ( Golang + tiedot )", "body": "<p>I'm working on a simple application written in golang, using <a href=\"https://github.com/HouzuoGuo/tiedot\" rel=\"nofollow\">tiedot</a> as NoSQL database engine.\nI need to store some users in the database.</p>\n\n<pre><code>type User struct {\n    Login        string\n    PasswordHash string\n    Salt         string\n}\n</code></pre>\n\n<p>Of course two users cannot have the same login, and - as this engine does not provide any transaction mechanism - I'm wondering how to ensure that there's no duplicated login in the database when writing.</p>\n\n<p>I first thought that I could just search for user by login before inserting, but as the database will be \nused concurently, it is not reliable.</p>\n\n<p>Maybe I could wait for a random time and if there is another user with the same login in the collection, delete it, but that does not sound reliable either.</p>\n\n<p>Is this even possible, or should I switch to a database engine that support transactions ?</p>\n"}, {"tags": ["python", "go", "time", "sqrl"], "answers": [{"comments": [{"owner": {"reputation": 726, "user_id": 1661689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40b6a6597d39393e6ed2114c257e6c11?s=128&d=identicon&r=PG", "display_name": "Terrel Shumway", "link": "https://stackoverflow.com/users/1661689/terrel-shumway"}, "edited": false, "score": 0, "creation_date": 1476596551, "post_id": 40066992, "comment_id": 67408175, "body": "Locking to one thread is useful, but I still need to be able to get the CPU time for the thread instead of wall-clock time.  If the system is otherwise idle, it wouldn&#39;t matter, but if an attacker were somehow able to increase the system load at the same time, the final iteration count would be lower and the protection weaker. (OTOH, if the attacker has that much control over your system when you are exporting a key, you are already pwned.)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 726, "user_id": 1661689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40b6a6597d39393e6ed2114c257e6c11?s=128&d=identicon&r=PG", "display_name": "Terrel Shumway", "link": "https://stackoverflow.com/users/1661689/terrel-shumway"}, "edited": false, "score": 0, "creation_date": 1476599169, "post_id": 40066992, "comment_id": 67408635, "body": "@TerrelShumway Yes, this is true. It might help a little knowing that the Go runtime limits the system threads that can simultaneously execute goroutines, see edit."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1476599042, "last_edit_date": 1495535552, "creation_date": 1476593682, "answer_id": 40066992, "question_id": 40063269, "link": "https://stackoverflow.com/questions/40063269/how-can-i-ensure-that-a-function-takes-a-certain-amount-of-time-in-go/40066992#40066992", "title": "How can I ensure that a function takes a certain amount of time in Go?", "body": "<p>You may use <a href=\"https://golang.org/pkg/runtime/#LockOSThread\" rel=\"nofollow noreferrer\"><code>runtime.LockOSThread()</code></a> to wire the calling goroutine to its current OS thread. This will ensure that no other goroutines will be scheduled to this thread, so your goroutine will run and not get interrupted or put on hold. No other goroutines will interfere when thread is locked.</p>\n\n<p>After this, you just need a loop until the given seconds have passed. You must call <a href=\"https://golang.org/pkg/runtime/#UnlockOSThread\" rel=\"nofollow noreferrer\"><code>runtime.UnlockOSThread()</code></a> to \"release\" the thread and make it available for other goroutines for execution, best done as a <code>defer</code> statement.</p>\n\n<p>See this example:</p>\n\n<pre><code>func runUntil(end time.Time) {\n    runtime.LockOSThread()\n    defer runtime.UnlockOSThread()\n    for time.Now().Before(end) {\n    }\n}\n</code></pre>\n\n<p>To make it wait for 2 seconds, it could look like this:</p>\n\n<pre><code>start := time.Now()\nend := start.Add(time.Second * 2)\nrunUntil(end)\n\nfmt.Println(\"Verify:\", time.Now().Sub(start))\n</code></pre>\n\n<p>This prints for example:</p>\n\n<pre><code>Verify: 2.0004556s\n</code></pre>\n\n<p>Of course you can specify less than a second too, e.g. to wait for 100 ms:</p>\n\n<pre><code>start := time.Now()\nrunUntil(start.Add(time.Millisecond * 100))\nfmt.Println(\"Verify:\", time.Now().Sub(start))\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Verify: 100.1278ms\n</code></pre>\n\n<p>You may use a different version of this function if that suits you better, one that takes the amount of time to \"wait\" as a value of <a href=\"https://golang.org/pkg/time/#Duration\" rel=\"nofollow noreferrer\"><code>time.Duration</code></a>:</p>\n\n<pre><code>func wait(d time.Duration) {\n    runtime.LockOSThread()\n    defer runtime.UnlockOSThread()\n\n    for end := time.Now().Add(d); time.Now().Before(end); {\n    }\n}\n</code></pre>\n\n<p>Using this:</p>\n\n<pre><code>start = time.Now()\nwait(time.Millisecond * 200)\nfmt.Println(\"Verify:\", time.Now().Sub(start))\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Verify: 200.1546ms\n</code></pre>\n\n<p><strong>Note:</strong> Note that the loops in the above functions will use CPU relentlessly as there is no sleep or blocking IO in them, they will just query the current system time and compare it to the deadline.</p>\n\n<p><strong>What if the attacker increases system load by multiple concurrent attempts?</strong></p>\n\n<p>The Go runtime limits the system threads that can simultaneously execute goroutines. This is controlled by <a href=\"https://golang.org/pkg/runtime/#GOMAXPROCS\" rel=\"nofollow noreferrer\"><code>runtime.GOMAXPROCS()</code></a>, so this is already a limitation. It defaults to the number of available CPU cores, and you can change it anytime. This also poses a bottleneck though, as by using <code>runtime.LockOSThread()</code>, if the number of locked threads equals to <code>GOMAXPROCS</code> at any given time, that would block execution of other goroutines until a thread is unlocked.</p>\n\n<p>See related questions:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/39245660/number-of-threads-used-by-go-runtime\">Number of threads used by Go runtime</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/28186361/why-does-it-not-create-many-threads-when-many-goroutines-are-blocked-in-writing/28186656#28186656\">Why does it not create many threads when many goroutines are blocked in writing file in golang?</a></p>\n"}], "owner": {"reputation": 726, "user_id": 1661689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40b6a6597d39393e6ed2114c257e6c11?s=128&d=identicon&r=PG", "display_name": "Terrel Shumway", "link": "https://stackoverflow.com/users/1661689/terrel-shumway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1476599042, "creation_date": 1476559267, "last_edit_date": 1476594594, "question_id": 40063269, "link": "https://stackoverflow.com/questions/40063269/how-can-i-ensure-that-a-function-takes-a-certain-amount-of-time-in-go", "title": "How can I ensure that a function takes a certain amount of time in Go?", "body": "<p>I am implementing EnScrypt for an SQRL client in Go. The function needs to run until it has used a minimum amount of CPU time. My Python code looks like this:</p>\n\n<pre><code>def enscrypt_time(salt, password, seconds, n=9, r=256):\n    N = 1 &lt;&lt; n\n    start = time.process_time()\n    end = start + seconds\n    data = acc = scrypt.hash(password, salt, N, r, 1, 32)\n    i = 1\n    while time.process_time() &lt; end:\n        data = scrypt.hash(password, data, N, r, 1, 32)\n        acc = xor_bytes(acc, data)\n        i += 1\n    return i, time.process_time() - start, acc\n</code></pre>\n\n<p>Converting this to Go is pretty simple except for the <code>process_time</code> function.\nI can't use <code>time.Time</code> / <code>Timer</code> because those measure wall-clock time (which is affected by everything else that may be running on the system). I need the CPU time actually used, ideally by the function, or at least by the thread or process it is running in.</p>\n\n<p>What is the Go equivalent of <code>process_time</code>?</p>\n\n<p><a href=\"https://docs.python.org/3/library/time.html#time.process_time\" rel=\"nofollow\">https://docs.python.org/3/library/time.html#time.process_time</a></p>\n"}, {"tags": ["http", "go", "server"], "answers": [{"comments": [{"owner": {"reputation": 367, "user_id": 1611963, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45f631e17b8e84a0c244b2d9ef966f33?s=128&d=identicon&r=PG", "display_name": "Saurbaum", "link": "https://stackoverflow.com/users/1611963/saurbaum"}, "edited": false, "score": 0, "creation_date": 1476559593, "post_id": 40063258, "comment_id": 67400496, "body": "I&#39;m testing locally still so I wasn&#39;t expecting any firewall issues.  Interestingly it does actually work when I move off port 80 to something in the higher range."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 367, "user_id": 1611963, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45f631e17b8e84a0c244b2d9ef966f33?s=128&d=identicon&r=PG", "display_name": "Saurbaum", "link": "https://stackoverflow.com/users/1611963/saurbaum"}, "edited": false, "score": 0, "creation_date": 1476559644, "post_id": 40063258, "comment_id": 67400512, "body": "@Saurbaum If you just use <code>&quot;:80&quot;</code>, that attempts to listen on all available interfaces, so that is not limited to localhost."}, {"owner": {"reputation": 367, "user_id": 1611963, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45f631e17b8e84a0c244b2d9ef966f33?s=128&d=identicon&r=PG", "display_name": "Saurbaum", "link": "https://stackoverflow.com/users/1611963/saurbaum"}, "edited": false, "score": 0, "creation_date": 1476560011, "post_id": 40063258, "comment_id": 67400639, "body": "for whatever reason port 80 just isn&#39;t working in the manner the documentation describes.  Even on the same computer."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 367, "user_id": 1611963, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45f631e17b8e84a0c244b2d9ef966f33?s=128&d=identicon&r=PG", "display_name": "Saurbaum", "link": "https://stackoverflow.com/users/1611963/saurbaum"}, "edited": false, "score": 0, "creation_date": 1476560098, "post_id": 40063258, "comment_id": 67400661, "body": "@Saurbaum Have you tried another, &quot;high&quot; port? For example 8080?"}, {"owner": {"reputation": 367, "user_id": 1611963, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45f631e17b8e84a0c244b2d9ef966f33?s=128&d=identicon&r=PG", "display_name": "Saurbaum", "link": "https://stackoverflow.com/users/1611963/saurbaum"}, "edited": false, "score": 0, "creation_date": 1476560226, "post_id": 40063258, "comment_id": 67400700, "body": "see my first comment.  Otherwise we will be going in circles.  Yes it works with a port like 8080.  The question now is why does it not work locally with port 80?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 367, "user_id": 1611963, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45f631e17b8e84a0c244b2d9ef966f33?s=128&d=identicon&r=PG", "display_name": "Saurbaum", "link": "https://stackoverflow.com/users/1611963/saurbaum"}, "edited": false, "score": 1, "creation_date": 1476586497, "post_id": 40063258, "comment_id": 67406526, "body": "@Saurbaum As said, because port 80 is special. You don&#39;t need to change anything in the code, but in your OS or firewall configuration. This is OS specific, but you haven&#39;t said anything about your OS and environment."}, {"owner": {"reputation": 367, "user_id": 1611963, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45f631e17b8e84a0c244b2d9ef966f33?s=128&d=identicon&r=PG", "display_name": "Saurbaum", "link": "https://stackoverflow.com/users/1611963/saurbaum"}, "edited": false, "score": 0, "creation_date": 1476598971, "post_id": 40063258, "comment_id": 67408589, "body": "Apologies.  I&#39;m using windows for this.  I have elevated the permissions of the application to test as well and then using port 80 only works with localhost even when defined as &quot;:80&quot; for ListenAndServe"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 367, "user_id": 1611963, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45f631e17b8e84a0c244b2d9ef966f33?s=128&d=identicon&r=PG", "display_name": "Saurbaum", "link": "https://stackoverflow.com/users/1611963/saurbaum"}, "edited": false, "score": 0, "creation_date": 1476599293, "post_id": 40063258, "comment_id": 67408655, "body": "@Saurbaum I&#39;ve tested it with <code>&quot;:80&quot;</code>, and I was able to view the started webserver both as <code>http:&#47;&#47;localhost</code> and as <code>http:&#47;&#47;&lt;mylocalip&gt;</code>. Know that to access it via your <i>external ip</i>, that most certainly needs opening or forwarding a port on your router!"}, {"owner": {"reputation": 367, "user_id": 1611963, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45f631e17b8e84a0c244b2d9ef966f33?s=128&d=identicon&r=PG", "display_name": "Saurbaum", "link": "https://stackoverflow.com/users/1611963/saurbaum"}, "edited": false, "score": 0, "creation_date": 1476621889, "post_id": 40063258, "comment_id": 67414129, "body": "I&#39;ll raise it as a windows specific bug then on the github page.  I&#39;m well aware that when it goes external it will need the ports forwarding."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 9, "last_activity_date": 1476559760, "last_edit_date": 1476559760, "creation_date": 1476559207, "answer_id": 40063258, "question_id": 40063120, "link": "https://stackoverflow.com/questions/40063120/http-listenandserve-only-works-for-localhost/40063258#40063258", "title": "http.ListenAndServe only works for localhost?", "body": "<p><code>http.ListenAndServe(\":80\", mux)</code> is the correct address. <a href=\"https://golang.org/pkg/net/http/\" rel=\"noreferrer\"><code>net/http</code></a> uses the <a href=\"https://golang.org/pkg/net/\" rel=\"noreferrer\"><code>net</code></a> package. Quoting from <a href=\"https://golang.org/pkg/net/#Listen\" rel=\"noreferrer\"><code>net.Listen()</code></a>:</p>\n\n<blockquote>\n  <p>If host is omitted, as in \":8080\", <strong>Listen listens on all available interfaces</strong> instead of just the interface with the given host address. See Dial for more details about address syntax.</p>\n</blockquote>\n\n<p>Know that port 80 is restricted or might be blocked by firewalls on many systems. On unix systems ports under 1024 usually require special permissions. Test the 8080 port for example, because that is not special in this way. </p>\n"}, {"comments": [{"owner": {"reputation": 367, "user_id": 1611963, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45f631e17b8e84a0c244b2d9ef966f33?s=128&d=identicon&r=PG", "display_name": "Saurbaum", "link": "https://stackoverflow.com/users/1611963/saurbaum"}, "edited": false, "score": 0, "creation_date": 1476598857, "post_id": 40064054, "comment_id": 67408568, "body": "That would only be relevant for external connections surely?  In this case I am testing on the same local box with admin permissions.  Also I&#39;m using Windows not Linux."}, {"owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "reply_to_user": {"reputation": 367, "user_id": 1611963, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45f631e17b8e84a0c244b2d9ef966f33?s=128&d=identicon&r=PG", "display_name": "Saurbaum", "link": "https://stackoverflow.com/users/1611963/saurbaum"}, "edited": false, "score": 0, "creation_date": 1476619420, "post_id": 40064054, "comment_id": 67413421, "body": "<a href=\"http://stackoverflow.com/q/11525703/2604529\">Port forwarding in windows</a>. As mebtioned by @icza, it has nothing to do with your application and  http.ListenAndServe in particular."}, {"owner": {"reputation": 367, "user_id": 1611963, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45f631e17b8e84a0c244b2d9ef966f33?s=128&d=identicon&r=PG", "display_name": "Saurbaum", "link": "https://stackoverflow.com/users/1611963/saurbaum"}, "edited": false, "score": 0, "creation_date": 1476623277, "post_id": 40064054, "comment_id": 67414488, "body": "That would be if there are multiple ip addresses in the machine.  I&#39;m not trying to forward any ports I&#39;m not behind a firewall or a router for these tests."}], "tags": [], "owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "is_accepted": false, "score": -1, "last_activity_date": 1476564415, "creation_date": 1476564415, "answer_id": 40064054, "question_id": 40063120, "link": "https://stackoverflow.com/questions/40063120/http-listenandserve-only-works-for-localhost/40064054#40064054", "title": "http.ListenAndServe only works for localhost?", "body": "<p>No, http.ListenAndServe works for any host or port, however ports below 1024 require root privileges.\nYou can redirect connections on port 80 as a normal user by using:</p>\n\n<pre><code>sudo apt-get install iptables-persistent\nsudo iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-port 8080\nsudo netfilter-persistent save\nsudo netfilter-persistent reload\n</code></pre>\n"}], "owner": {"reputation": 367, "user_id": 1611963, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45f631e17b8e84a0c244b2d9ef966f33?s=128&d=identicon&r=PG", "display_name": "Saurbaum", "link": "https://stackoverflow.com/users/1611963/saurbaum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9630, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1476599056, "creation_date": 1476558442, "last_edit_date": 1476599056, "question_id": 40063120, "link": "https://stackoverflow.com/questions/40063120/http-listenandserve-only-works-for-localhost", "title": "http.ListenAndServe only works for localhost?", "body": "<p>I've been successfully making use of </p>\n\n<pre><code>http.ListenAndServe(\":80\", mux)\n</code></pre>\n\n<p>to host my web service in Go. It only appears to work with localhost however.</p>\n\n<pre><code>http.ListenAndServe(\"192.168.1.83:80\", mux)\n</code></pre>\n\n<p>This works for specific connections on this address but is there a way to make it work for any ip address on the server?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>I've checked it with a different port (8080 in this case) and then using \":8080\" works as documented.  There appears to be something special about port 80 even when testing on the same machine that means it only actually listens on localhost.</p>\n\n<p>For the avoidance of doubt I'm using Windows and all testing is done on the same physical machine.  I've also checked running with admin privileges and it makes no difference.</p>\n"}, {"tags": ["google-app-engine", "go", "appstats"], "comments": [{"owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1476548353, "post_id": 40061061, "comment_id": 67396655, "body": "Not sure about appstats, but you could use <a href=\"https://golang.org/pkg/net/http/pprof/\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/pprof</a> - more info: <a href=\"https://blog.golang.org/profiling-go-programs\" rel=\"nofollow noreferrer\">blog.golang.org/profiling-go-programs</a>"}, {"owner": {"reputation": 147, "user_id": 5728873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/R37ba.jpg?s=128&g=1", "display_name": "Dheeraj Sarwaiya", "link": "https://stackoverflow.com/users/5728873/dheeraj-sarwaiya"}, "reply_to_user": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1476549224, "post_id": 40061061, "comment_id": 67396931, "body": "How to use that with Google App engine. It is talking about if you are running your http server?"}, {"owner": {"reputation": 3730, "user_id": 464064, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5b106b3ab0dfec1dcc591dd7b8d309fb?s=128&d=identicon&r=PG", "display_name": "John F.", "link": "https://stackoverflow.com/users/464064/john-f"}, "edited": false, "score": 0, "creation_date": 1476710124, "post_id": 40061061, "comment_id": 67447173, "body": "You&#39;ll find that <b>many</b> (if not most) app engine related functions will require a <code>Context</code>."}], "owner": {"reputation": 147, "user_id": 5728873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/R37ba.jpg?s=128&g=1", "display_name": "Dheeraj Sarwaiya", "link": "https://stackoverflow.com/users/5728873/dheeraj-sarwaiya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1476546332, "creation_date": 1476546332, "question_id": 40061061, "link": "https://stackoverflow.com/questions/40061061/measuring-performance-golang", "title": "measuring performance golang", "body": "<p>I am learning how to make a website on App Engine using Golang. I want a way to do performance profiling. I am trying to use <a href=\"https://godoc.org/github.com/mjibson/appstats\" rel=\"nofollow\">appstats</a>. However there are two issues</p>\n\n<ul>\n<li>Is there a work around to avoid using strict function structure</li>\n</ul>\n\n<blockquote>\n  <p>func(appengine.Context, http.ResponseWriter, *http.Request)</p>\n</blockquote>\n\n<ul>\n<li><p>Second, I am using httprouter for mapping multiple pages. How to use appstats with httprouter? Is there better alternative than appstats?</p>\n\n<pre><code>r := httprouter.New()\nhttp.Handle(\"/\", r)\n\nr.GET(\"/\", HomePage)\n//Signup routes\nr.GET(\"/form/signup\", GoToSignupPage)\n</code></pre></li>\n</ul>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 9, "last_activity_date": 1476553703, "creation_date": 1476553703, "answer_id": 40062311, "question_id": 40060131, "link": "https://stackoverflow.com/questions/40060131/reflect-assign-a-pointer-struct-value/40062311#40062311", "title": "reflect, assign a pointer struct value", "body": "<p>You can't assign the value of a pointer directly to <code>y</code>, because you're passing the value of <code>y</code> into <code>Get</code>, not its address. You could pass in the address of <code>y</code> (type <code>**Concrete</code>), so that you could assign a pointer (<code>*Concrete</code>) to <code>y</code>. If it's safe to assign the value directly, you assign the indirection of the registered pointer to <code>y</code>, but <code>y</code> must be initialized with a valid value so that there's an address to write to. </p>\n\n<pre><code>n := 42\np := &amp;n\n\nx := new(int)\n// set the value to *x, but x must be initialized\nreflect.ValueOf(x).Elem().Set(reflect.ValueOf(p).Elem())\nfmt.Println(\"*x:\", *x)\n\nvar y *int\n// to set the value of y directly, requires y be addressable\nreflect.ValueOf(&amp;y).Elem().Set(reflect.ValueOf(p))\nfmt.Println(\"*y:\", *y)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/6tFitP4_jt\" rel=\"noreferrer\">https://play.golang.org/p/6tFitP4_jt</a></p>\n"}], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4811, "favorite_count": 1, "accepted_answer_id": 40062311, "answer_count": 1, "score": 6, "last_activity_date": 1476554612, "creation_date": 1476541075, "last_edit_date": 1476554612, "question_id": 40060131, "link": "https://stackoverflow.com/questions/40060131/reflect-assign-a-pointer-struct-value", "title": "reflect, assign a pointer struct value", "body": "<p>I m trying to assign a pointer to a struct to the value of an already initialized struct pointer of the same type.</p>\n\n<p>To do a simple service locator</p>\n\n<p>Code is like this</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"reflect\"\n)\n\ntype Concrete struct {}\nfunc (c *Concrete) Do(){}\n\ntype Doer interface {\n    Do()\n}\n\nfunc main() {\n    l := ServiceLocator{}\n    l.Register(&amp;Concrete{})\n\n    var x Doer\n    if l.Get(&amp;x); x!= nil {\n        fmt.Println(\"by interface pointer ok\")\n    }\n\n    // This is not possible in my understanding\n    //var z Doer\n    //if l.Get(z); z!= nil {\n    //  fmt.Println(\"by interface ok\")\n    //}\n\n    var y *Concrete\n    if l.Get(y); y!= nil {\n        fmt.Println(\"by struct pointer ok\")\n    }\n}\n\ntype ServiceLocator struct {\n  services []interface{}\n  types []reflect.Type\n  values []reflect.Value\n}\n\nfunc (s *ServiceLocator) Register(some interface{}) {\n  s.services = append(s.services, some)\n  s.types = append(s.types, reflect.TypeOf(some))\n  s.values = append(s.values, reflect.ValueOf(some))\n}\n\nfunc (s *ServiceLocator) Get(some interface{}) interface{} {\n  k := reflect.TypeOf(some).Elem()\n  kind := reflect.TypeOf(some).Elem().Kind()\n  for i, t := range s.types {\n    if kind==reflect.Interface &amp;&amp; t.Implements(k) {\n      reflect.Indirect(\n        reflect.ValueOf(some),\n      ).Set(s.values[i])\n    } else if kind==reflect.Struct &amp;&amp; k.AssignableTo(t.Elem()) {\n      fmt.Println(reflect.ValueOf(some).Elem().CanAddr())\n      fmt.Println(reflect.ValueOf(some).Elem().CanSet())\n      fmt.Println(reflect.Indirect(reflect.ValueOf(some)))\n      reflect.ValueOf(some).Set(s.values[i])\n    }\n  }\n  return nil\n}\n</code></pre>\n\n<p>Despite my attempts i keep getting runtime errors such</p>\n\n<pre><code>panic: reflect: reflect.Value.Set using unaddressable value\n</code></pre>\n\n<p>try the play <a href=\"https://play.golang.org/p/-0g8F3uok1\" rel=\"noreferrer\">here</a></p>\n\n<p>need help, thanks a lot!</p>\n\n<hr>\n\n<p>With JimB helps and information here is the fixed play <a href=\"https://play.golang.org/p/_g2AbX0yHV\" rel=\"noreferrer\">https://play.golang.org/p/_g2AbX0yHV</a></p>\n"}, {"tags": ["go", "mqtt", "paho"], "answers": [{"tags": [], "owner": {"reputation": 48, "user_id": 7035267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ced2184380b348e245f77051d5c85ee1?s=128&d=identicon&r=PG&f=1", "display_name": "Al S-M", "link": "https://stackoverflow.com/users/7035267/al-s-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1476778494, "creation_date": 1476778494, "answer_id": 40102985, "question_id": 40056759, "link": "https://stackoverflow.com/questions/40056759/mqtt-existing-client/40102985#40102985", "title": "MQTT existing client", "body": "<p>There is, unfortunately, no way to query an MQTT server to find out what subscriptions it has active for your client id. When you connect with the same client ID as a previous session the server assumes you have the same state as last time you were connected, but there is no way to pre connect a MessageHandler with a topic in the Go client, the only way to add and remove them is with Subscribe/Unsubscribe.</p>\n\n<p>Assuming the server is working correctly, if you connect as above reusing a client id the server will continue to send you messages according to your previous subscriptions but the Go client doesn't know what to do with them so will invoke the default message handler. The best way to currently resolve this would be to call Subscribe() in the OnConnectHandler, assuming the topics you want to subscribe to are predetermined rather than dynamic.</p>\n"}], "owner": {"reputation": 2927, "user_id": 368957, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/661cf3ed7f2311020cd7054cad120419?s=128&d=identicon&r=PG", "display_name": "Rakesh Goyal", "link": "https://stackoverflow.com/users/368957/rakesh-goyal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 362, "favorite_count": 0, "accepted_answer_id": 40102985, "answer_count": 1, "score": 1, "last_activity_date": 1476778494, "creation_date": 1476519597, "question_id": 40056759, "link": "https://stackoverflow.com/questions/40056759/mqtt-existing-client", "title": "MQTT existing client", "body": "<p>I am using eclipse paho golang library to create new MQTT client for a particular client id:</p>\n\n<pre><code>func CreateMQTTClient(clientID string) (client MQTT.Client) {\n    username := viper.GetString(\"messaging.rabbitmq.username\")\n    password := viper.GetString(\"messaging.rabbitmq.password\")\n    host := viper.GetString(\"messaging.rabbitmq.host\")\n    mqqtPort := viper.GetString(\"messaging.rabbitmq.mqqtPort\")\n    rabbitMqMQQTURL := \"tcp://\" + host + \":\" + mqqtPort\n    opts := MQTT.NewClientOptions().AddBroker(rabbitMqMQQTURL)\n    opts.SetClientID(clientID)\n    opts.Username = username\n    opts.Password = password\n    opts.SetCleanSession(false)\n    cli := MQTT.NewClient(opts)\n\n    if (!cli.IsConnected()) {\n        log.Println(\"I came here for cli:\", clientID)\n        if token := cli.Connect(); token.Wait() &amp;&amp; token.Error() != nil {\n            log.Print(token.Error())\n        }\n    }\n\n    return cli\n\n}\n</code></pre>\n\n<p>I am not sure how do I get this client back using clientId. If I call CreateMQTTClient again, all existing subscriptions are lost.</p>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "edited": false, "score": 0, "creation_date": 1476526459, "post_id": 40056341, "comment_id": 67390190, "body": "What exactly is your problem? You can have multiple DB connections with multiple sql.Open calls. GoLang provides basic connection pool, and you can control it like so: <a href=\"http://go-database-sql.org/connection-pool.html\" rel=\"nofollow noreferrer\">go-database-sql.org/connection-pool.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 646, "user_id": 4335622, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-OeTdPDQRltk/AAAAAAAAAAI/AAAAAAAAAE4/KXT0pHbxg9s/photo.jpg?sz=128", "display_name": "i.van", "link": "https://stackoverflow.com/users/4335622/i-van"}, "is_accepted": true, "score": 4, "last_activity_date": 1476533691, "creation_date": 1476533691, "answer_id": 40058889, "question_id": 40056341, "link": "https://stackoverflow.com/questions/40056341/golang-how-do-you-connect-to-multiple-mysql-databases-in-go/40058889#40058889", "title": "golang: How do you connect to multiple MySQL databases in Go?", "body": "<p>Just create different variables (db connections) using the Open function of sql library</p>\n\n<pre><code>import \"database/sql\"\nimport _ \"github.com/go-sql-driver/mysql\"\n\nfunc Connect() (*DB, *DB, *DB) {\n    db1, err := sql.Open(\"mysql\", \"user1:password1@/dbname1\")\n    //check err\n    db2, err := sql.Open(\"mysql\", \"user2:password2@/dbname2\")\n    //check err\n    db3, err := sql.Open(\"mysql\", \"user3:password3@/dbname3\")\n    //check err\n    return db1, db2, db3\n}\n</code></pre>\n\n<p>And you can use them further absolutely separately. </p>\n"}], "owner": {"reputation": 441, "user_id": 7022570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc0519d31ed01850ea8f6940aee08fa?s=128&d=identicon&r=PG&f=1", "display_name": "Zander Wong", "link": "https://stackoverflow.com/users/7022570/zander-wong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3482, "favorite_count": 0, "closed_date": 1477528019, "accepted_answer_id": 40058889, "answer_count": 1, "score": -3, "last_activity_date": 1476533691, "creation_date": 1476516542, "question_id": 40056341, "link": "https://stackoverflow.com/questions/40056341/golang-how-do-you-connect-to-multiple-mysql-databases-in-go", "closed_reason": "Needs details or clarity", "title": "golang: How do you connect to multiple MySQL databases in Go?", "body": "<p>operating 3 or more database at the same time,\nRead/Write Splitting,\nhave connection pool.</p>\n"}, {"tags": ["security", "go", "jwt", "jwt-go"], "answers": [{"comments": [{"owner": {"reputation": 86, "user_id": 2159808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553f72dde51a5c6c6be177c4e8dcde9?s=128&d=identicon&r=PG", "display_name": "vvwccgz4lh", "link": "https://stackoverflow.com/users/2159808/vvwccgz4lh"}, "edited": false, "score": 0, "creation_date": 1476601310, "post_id": 40061629, "comment_id": 67409075, "body": "It is quite nice, but it still needs some wrapping to isolate jwt-go framework from the generated controller. It looks like it should do the job"}], "tags": [], "owner": {"reputation": 26, "user_id": 2908685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89f8752548782bf77dea45c7b66ee30a?s=128&d=identicon&r=PG", "display_name": "raphael", "link": "https://stackoverflow.com/users/2908685/raphael"}, "is_accepted": true, "score": 1, "last_activity_date": 1476549670, "creation_date": 1476549670, "answer_id": 40061629, "question_id": 40056106, "link": "https://stackoverflow.com/questions/40056106/user-aware-action-in-goa/40061629#40061629", "title": "User aware action in goa", "body": "<p>The <a href=\"https://github.com/goadesign/goa/tree/master/middleware/security/jwt\" rel=\"nofollow\">jwt</a> package exposes a <a href=\"https://godoc.org/github.com/goadesign/goa/middleware/security/jwt#ContextJWT\" rel=\"nofollow\">ContextJWT</a> function which extracts the JWT token content from the request context. This makes it possible to retrieve the claims stored in the token:</p>\n\n<pre><code>token := jwt.ContextJWT(ctx)\nclaims := token.Claims.(jwtgo.MapClaims)\nsubject := claims[\"sub\"] // \"sub\" claim contains security principal\n// ... use subject to authenticate\n</code></pre>\n\n<p>Where <code>jwtgo</code> is the dgrijalva/jwt-go package.</p>\n"}], "owner": {"reputation": 86, "user_id": 2159808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5553f72dde51a5c6c6be177c4e8dcde9?s=128&d=identicon&r=PG", "display_name": "vvwccgz4lh", "link": "https://stackoverflow.com/users/2159808/vvwccgz4lh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "accepted_answer_id": 40061629, "answer_count": 1, "score": 2, "last_activity_date": 1588507423, "creation_date": 1476515106, "last_edit_date": 1588507423, "question_id": 40056106, "link": "https://stackoverflow.com/questions/40056106/user-aware-action-in-goa", "title": "User aware action in goa", "body": "<p>I am making a web server with <a href=\"https://github.com/goadesign/goa\" rel=\"nofollow\">goa</a> (Cannot create a stack overflow tag for it, not enough reputation).</p>\n\n<p>I cannot find a way to get user context inside a controller method.\nI use JWT auth that is supported by basic auth.\nI have a JWT secure action that is secured via JWT middleware and it checks passwords and so on.</p>\n\n<p>What I want is to get the username from JWT token to the secure method. Is there any way?</p>\n\n<p>goa design file fragment:</p>\n\n<pre><code>var JWT = JWTSecurity(\"jwt\", func() {\n    Header(\"Authorization\")\n    Scope(\"api:access\", \"API access\") // Define \"api:access\" scope\n})\n\nSecurity(JWT, func() {\n    // Use JWT to auth requests to this endpoint\n    Scope(\"api:access\") // Enforce presence of \"api\" scope in JWT claims.\n})\n\nAction(\"secure\", func() {\n    Description(\"This action is secured with the jwt scheme\")\n    Routing(GET(\"/jwt\"))\n    Response(OK)\n})\n</code></pre>\n\n<p>and this DSL gets generated into this method:</p>\n\n<pre><code>func (c *JWTSessionsController) Secure(ctx *app.SecureJWTContext) error {\n    return ctx.OK(&amp;app.Success{false})\n}\n</code></pre>\n\n<p>The generated action is secured and works well (Middleware is mounted and all validation passes). But I want to get username inside in the action. Is is somehow possible?</p>\n\n<p>I would like to get it in this way:</p>\n\n<pre><code>ctx.User.Username\n</code></pre>\n\n<p>For now I will have to parse the jwt twice. :(</p>\n\n<p>I made a helper that parses base64 token claims.</p>\n"}, {"tags": ["http", "go", "tcpserver"], "comments": [{"owner": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "edited": false, "score": 2, "creation_date": 1476526243, "post_id": 40055890, "comment_id": 67390135, "body": "What does you face_recognize_async look like? My guess is that it&#39;s async only in name, and actually blocks."}, {"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "reply_to_user": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "edited": false, "score": 1, "creation_date": 1476619082, "post_id": 40055890, "comment_id": 67413318, "body": "The entire http FORM POSt must be posted before its values can be parsed and operated on. You&#39;ll have to wait for all files to upload first.  Then, as @Alexey said, that async func may not actually be async.  Is it threadsafe? If so, fire off two Goroutines after the uploads are complete."}, {"owner": {"reputation": 465, "user_id": 2568593, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MEky8.jpg?s=128&g=1", "display_name": "Anthony Cooper", "link": "https://stackoverflow.com/users/2568593/anthony-cooper"}, "reply_to_user": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "edited": false, "score": 0, "creation_date": 1477104460, "post_id": 40055890, "comment_id": 67643012, "body": "@AlexeySoshin face_recognize_async is actually async, I would send pictures to other GPU server."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1476554331, "creation_date": 1476554331, "answer_id": 40062412, "question_id": 40055890, "link": "https://stackoverflow.com/questions/40055890/golang-server-how-to-retrieve-multiple-files-continuously/40062412#40062412", "title": "golang server: how to retrieve multiple files continuously", "body": "<p>Since <code>FormFile</code> indexes the files from the posted form, it requires that the entire form already be parsed. From the <code>FormFile</code> docs:</p>\n\n<blockquote>\n  <p>FormFile calls ParseMultipartForm and ParseForm if necessary.</p>\n</blockquote>\n\n<p>If you want to stream the the multipart form one part at a time, use <a href=\"https://golang.org/pkg/net/http/#Request.MultipartReader\" rel=\"nofollow\"><code>Request.MultipartReader</code></a></p>\n"}], "owner": {"reputation": 465, "user_id": 2568593, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MEky8.jpg?s=128&g=1", "display_name": "Anthony Cooper", "link": "https://stackoverflow.com/users/2568593/anthony-cooper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 670, "favorite_count": 0, "accepted_answer_id": 40062412, "answer_count": 1, "score": 0, "last_activity_date": 1476554331, "creation_date": 1476513768, "last_edit_date": 1476514072, "question_id": 40055890, "link": "https://stackoverflow.com/questions/40055890/golang-server-how-to-retrieve-multiple-files-continuously", "title": "golang server: how to retrieve multiple files continuously", "body": "<p>I have implemented a http server based on <code>gin</code> (golang web framework).</p>\n\n<p>I post 2 pictures to server with <code>curl multipart/form-data</code>:</p>\n\n<p><code>curl -X POST -F upload0=@jpg -F upload1=@jpg -H \"Content-Type: multipart/form-data\" \"http://server:port/path\"</code></p>\n\n<p>Server code looks like this:</p>\n\n<pre><code>func extractImgs(c *gin.Context) {\n    prefix := \"prefix\"\n    for ix := 0; ix &lt; 2; ix++ {\n        file, _, err := c.Request.FormFile(prefix + strconv.Itoa(ix))\n        if err != nil {\n            // do sth.\n            return\n        }\n        face_recognize_async(file)\n    }\n}\n</code></pre>\n\n<p>You know, face recognition is time-consuming, I hope the work-flow is:</p>\n\n<pre><code>get_1st_img -&gt; recognize_face -&gt; get_2nd_img -&gt; recognize_face -&gt; ...\n</code></pre>\n\n<p>I print <code>c.Request.FormFile()</code> execution time, it returns after retrieved <strong>all 2 files</strong>.</p>\n\n<p>My questions:</p>\n\n<p>1) how to retrieve these files continuously, just like traverse linked list;</p>\n\n<p>2) Is http multipart a good choice, should I implement it with TCP/STCP?</p>\n"}, {"tags": ["google-maps", "go", "google-roads-api"], "comments": [{"owner": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "edited": false, "score": 0, "creation_date": 1476526037, "post_id": 40055394, "comment_id": 67390076, "body": "Check your err first."}, {"owner": {"reputation": 1570, "user_id": 5850449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7bVFD.jpg?s=128&g=1", "display_name": "Arjun Ajith", "link": "https://stackoverflow.com/users/5850449/arjun-ajith"}, "reply_to_user": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "edited": false, "score": 1, "creation_date": 1476527204, "post_id": 40055394, "comment_id": 67390376, "body": "@AlexeySoshin Thanks for the reply bro. But there are no errors.. I checked."}], "answers": [{"tags": [], "owner": {"reputation": 1529, "user_id": 2604529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6SJdc.jpg?s=128&g=1", "display_name": "Marcel Novy", "link": "https://stackoverflow.com/users/2604529/marcel-novy"}, "is_accepted": true, "score": 2, "last_activity_date": 1476531109, "creation_date": 1476531109, "answer_id": 40058485, "question_id": 40055394, "link": "https://stackoverflow.com/questions/40055394/google-road-api-snaptoroad-golang/40058485#40058485", "title": "Google Road Api SnapToRoad golang", "body": "<p>Your code is fine, but It seems that your API Key is not activated. \nPlease visit <a href=\"https://console.developers.google.com/apis/dashboard\" rel=\"nofollow\">googleAPI dashboard</a> \nto enable it.</p>\n\n<p>You can always check it working:\n<a href=\"https://roads.googleapis.com/v1/snapToRoads?path=60.170880,24.942795|60.170879,24.942796|60.170877,24.942796&amp;key=YOUR_API_KEY\" rel=\"nofollow\">https://roads.googleapis.com/v1/snapToRoads?path=60.170880,24.942795|60.170879,24.942796|60.170877,24.942796&amp;key=YOUR_API_KEY</a></p>\n\n<p>the output would be:</p>\n\n<pre><code>{\n  \"snappedPoints\": [\n    {\n      \"location\": {\n        \"latitude\": 60.170877918672588,\n        \"longitude\": 24.942699821922421\n      },\n      \"originalIndex\": 0,\n      \"placeId\": \"ChIJNX9BrM0LkkYRIM-cQg265e8\"\n    },\n    {\n      \"location\": {\n        \"latitude\": 60.170876898776406,\n        \"longitude\": 24.942699912064775\n      },\n      \"originalIndex\": 1,\n      \"placeId\": \"ChIJNX9BrM0LkkYRIM-cQg265e8\"\n    },\n    {\n      \"location\": {\n        \"latitude\": 60.170874902634374,\n        \"longitude\": 24.942700088491474\n      },\n      \"originalIndex\": 2,\n      \"placeId\": \"ChIJNX9BrM0LkkYRIM-cQg265e8\"\n    }\n  ]\n}\n</code></pre>\n"}], "owner": {"reputation": 1570, "user_id": 5850449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7bVFD.jpg?s=128&g=1", "display_name": "Arjun Ajith", "link": "https://stackoverflow.com/users/5850449/arjun-ajith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 0, "accepted_answer_id": 40058485, "answer_count": 1, "score": 0, "last_activity_date": 1476531109, "creation_date": 1476509813, "last_edit_date": 1476524534, "question_id": 40055394, "link": "https://stackoverflow.com/questions/40055394/google-road-api-snaptoroad-golang", "title": "Google Road Api SnapToRoad golang", "body": "<p>I was trying to implement google's <strong>snaptoroad</strong>  api. But I am not getting any output. I am using golang for the implementation. My Code is as follows:  </p>\n\n<pre><code>mapClient, err := maps.NewClient(maps.WithAPIKey(GoogleApiServerKey))\nif err != nil{\n    log.Println(err)\n}\n\n//Input\nlatlng := maps.LatLng{}\npath := []maps.LatLng{}\nlatlng.Lat = 9.7162348\nlatlng.Lng = 76.6702793\npath = append(path, latlng)\nlatlng.Lat = 9.7162400\nlatlng.Lng = 76.715195\npath = append(path, latlng)\nlatlng.Lat = 9.7162410\nlatlng.Lng = 76.7759261\npath = append(path, latlng)\n\ninputRequest := &amp;maps.SnapToRoadRequest{\n    Path: path,\n}\n\noutputResponse, err := mapClient.SnapToRoad(context.Background(), inputRequest)\n\nfmt.Println(outputResponse)\npretty.Println(outputResponse)\n</code></pre>\n\n<p>The Output this code produces are</p>\n\n<pre><code>&amp;{[]}\n&amp;maps.SnapToRoadResponse{}\n</code></pre>\n\n<p>Blank output is returned. Anyone please point out the mistake I made here? Thanks in advance.</p>\n"}, {"tags": ["c", "post", "go"], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476527827, "post_id": 40055360, "comment_id": 67390510, "body": "The full problem isn&#39;t because of that particular line in the current go query handling code, the problem is that there is a limited character set that are safe for URLs, and a number of reserved characters within that set"}, {"owner": {"reputation": 707, "user_id": 2071056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7147138fc22fbd2b9d71611506c93701?s=128&d=identicon&r=PG", "display_name": "davidcv5", "link": "https://stackoverflow.com/users/2071056/davidcv5"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476530525, "post_id": 40055360, "comment_id": 67391269, "body": "Yes, that&#39;s exactly right, it&#39;s what I said in the first line of my answer, I just showed where and why passing that unsafe parameter causes the issue. Maybe it wasn&#39;t that clear, I&#39;ll highlight the unsafe word. Thanks for the comment @JimB"}], "tags": [], "owner": {"reputation": 707, "user_id": 2071056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7147138fc22fbd2b9d71611506c93701?s=128&d=identicon&r=PG", "display_name": "davidcv5", "link": "https://stackoverflow.com/users/2071056/davidcv5"}, "is_accepted": true, "score": 0, "last_activity_date": 1476530692, "last_edit_date": 1476530692, "creation_date": 1476509550, "answer_id": 40055360, "question_id": 40054760, "link": "https://stackoverflow.com/questions/40054760/parse-post-data-with-punctuation-incorrectly-in-golang/40055360#40055360", "title": "Parse post data with punctuation incorrectly in golang", "body": "<p>You're passing the raw code, which could be <strong>unsafe</strong>, your problem is because of this:</p>\n\n<p><a href=\"https://golang.org/src/net/url/url.go?s=21047:21092#L761\" rel=\"nofollow\">https://golang.org/src/net/url/url.go?s=21047:21092#L761</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/bi8vF.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/bi8vF.png\" alt=\"enter image description here\"></a></p>\n\n<p>I would suggest that you base64encode your log code and then decode it in your handler.</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>import \"encoding/base64\"\n\n...\n\ncode, err := base64.RawURLEncoding.DecodeString(r.PostFormValue(\"code\"))\n    if err != nil {\n        // handle error\n    }\n</code></pre>\n\n<p>Then your request should look like this:</p>\n\n<pre><code>curl --data \"pid=1&amp;code=I2luY2x1ZGUgPHN0ZGlvLmg-XHgwQWludCBtYWluKClceDBBe1x4MEFceDA5cHJpbnRmKFx4MjIzXHg1Q25ceDIyKTtceDBBXHgwOXJldHVybiAwO1x4MEF9&amp;lang=c&amp;author=11\" http://localhost:8080\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 6029027, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ac9c83841db833d09ea9bfaf8d72d42?s=128&d=identicon&r=PG&f=1", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/6029027/wyatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 40055360, "answer_count": 1, "score": -1, "last_activity_date": 1476530692, "creation_date": 1476503507, "last_edit_date": 1476514544, "question_id": 40054760, "link": "https://stackoverflow.com/questions/40054760/parse-post-data-with-punctuation-incorrectly-in-golang", "title": "Parse post data with punctuation incorrectly in golang", "body": "<p>I know how to parse post data in golang</p>\n\n<pre><code>r.ParseForm()\npid := r.PostFormValue(\"pid\")\ncode := r.PostFormValue(\"code\")\nlang := r.PostFormValue(\"lang\")\nauthor := r.PostFormValue(\"author\")\n</code></pre>\n\n<p>But the post data is <code>pid=1&amp;code=#include &lt;stdio.h&gt;\\x0Aint main()\\x0A{\\x0A\\x09printf(\\x223\\x5Cn\\x22);\\x0A\\x09return 0;\\x0A}&amp;lang=c&amp;author=11</code>(this is obtained from nginx log)</p>\n\n<p>So when I parse the data, it could be wrong. The parsed data of <code>code</code> is </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    printf(\"3\\n\")\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    printf(\"3\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>So how can I fix this problem?</p>\n"}, {"tags": ["arrays", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1476490568, "post_id": 40053675, "comment_id": 67383165, "body": "Because that&#39;s how the language is specified. Arrays are values with a static length, and variadic arguments use slices."}, {"owner": {"reputation": 999, "user_id": 1509414, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/410ac3df4157f9e37d90585d04018768?s=128&d=identicon&r=PG", "display_name": "Gavello", "link": "https://stackoverflow.com/users/1509414/gavello"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476491187, "post_id": 40053675, "comment_id": 67383293, "body": "so when initializing  arr0 := []int{1, 2, 3} actually I&#39;m initialising a slice not an array"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476491257, "post_id": 40053675, "comment_id": 67383301, "body": "yes, <code>[]int{}</code> is the syntax for a slice literal."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1476491340, "post_id": 40053675, "comment_id": 67383321, "body": "slice is a different type of slice"}], "answers": [{"tags": [], "owner": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "is_accepted": false, "score": 0, "last_activity_date": 1476496896, "creation_date": 1476496896, "answer_id": 40054209, "question_id": 40053675, "link": "https://stackoverflow.com/questions/40053675/go-array-expansion/40054209#40054209", "title": "GO array expansion", "body": "<p>when use the operator <code>...</code> as a tail, such as <code>T...</code>. <code>T</code> should always be slice.</p>\n"}, {"tags": [], "owner": {"reputation": 707, "user_id": 2071056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7147138fc22fbd2b9d71611506c93701?s=128&d=identicon&r=PG", "display_name": "davidcv5", "link": "https://stackoverflow.com/users/2071056/davidcv5"}, "is_accepted": true, "score": 1, "last_activity_date": 1476499575, "creation_date": 1476499575, "answer_id": 40054418, "question_id": 40053675, "link": "https://stackoverflow.com/questions/40053675/go-array-expansion/40054418#40054418", "title": "GO array expansion", "body": "<p>As other said:</p>\n\n<p><code>[n]type</code> - Array (fixed size)</p>\n\n<p><code>[]type</code>  - Slice</p>\n\n<p>A quick solution for your case would be a simple conversion from <code>array</code> to <code>slice</code>.</p>\n\n\n\n<pre><code>add(arr2[:]...)\n</code></pre>\n\n<p>That will just make it a slice pointing to the storage of <code>arr2</code> (not a copy)</p>\n"}], "owner": {"reputation": 999, "user_id": 1509414, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/410ac3df4157f9e37d90585d04018768?s=128&d=identicon&r=PG", "display_name": "Gavello", "link": "https://stackoverflow.com/users/1509414/gavello"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 40054418, "answer_count": 2, "score": -2, "last_activity_date": 1476499575, "creation_date": 1476490324, "question_id": 40053675, "link": "https://stackoverflow.com/questions/40053675/go-array-expansion", "title": "GO array expansion", "body": "<p>I was testing some go array initialization and general usage but I can not figure out why can not expand an array initialized with a defined length?</p>\n\n<pre><code>package main\n\nfunc main() {\n    arr0 := []int{1, 2, 3}  // \n    add(arr0...)            // OK\n\n    arr1 := [3]int{1, 2, 3} // \n    slice := arr1[:]        //\n    add(slice...)           // OK\n\n    arr2 := [3]int{}        // \n    arr2[0] = 1             //\n    arr2[1] = 2             //\n    arr2[3] = 3             //\n    add(arr2...)            // cannot use arr2 (type [3]int) as type \n                            // []int in argument to add\n }\n\nfunc add(terms ...int) (sum int) {\n    for _, term := range terms {\n       sum += term\n    }\n    return\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 1, "creation_date": 1476539360, "post_id": 40053806, "comment_id": 67393794, "body": "That&#39;s not particularly terse. I think I&#39;ll just use a normal named struct. Thanks!"}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "reply_to_user": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 1, "creation_date": 1476597453, "post_id": 40053806, "comment_id": 67408350, "body": "you&#39;re welcome, yes it looks kinda verbose, but well at least you can use keys in the way that you want to on initialization time: <a href=\"https://play.golang.org/p/5KxO_SBJ97\" rel=\"nofollow noreferrer\">play.golang.org/p/5KxO_SBJ97</a>"}], "tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": true, "score": 2, "last_activity_date": 1476491731, "creation_date": 1476491731, "answer_id": 40053806, "question_id": 40053615, "link": "https://stackoverflow.com/questions/40053615/map-lookup-via-anonymous-struct-key/40053806#40053806", "title": "Map lookup via anonymous struct key", "body": "<p>You can create anonymous keys as well, something like this:</p>\n\n<pre><code>func main() {\n\n    data := map[struct{ pID, bID int }]string{}\n\n    key := struct{pID, bID int}{1, 2}\n    data[key] = \"abc\"\n\n    data[struct{pID, bID int}{3, 4}] = \"cha cha cha\"\n\n\n    fmt.Printf(\"%+v\\n\\n\", data)\n\n    fmt.Printf(\"'%s' '%s'\\n\", data[key], data[struct{pID, bID int}{3, 4}])\n}\n</code></pre>\n\n<p>Full file: <a href=\"https://play.golang.org/p/2q11qiwxuI\" rel=\"nofollow\">https://play.golang.org/p/2q11qiwxuI</a></p>\n"}], "owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 40053806, "answer_count": 1, "score": 1, "last_activity_date": 1476491731, "creation_date": 1476489798, "last_edit_date": 1495541793, "question_id": 40053615, "link": "https://stackoverflow.com/questions/40053615/map-lookup-via-anonymous-struct-key", "title": "Map lookup via anonymous struct key", "body": "<p>I have the following <code>map</code> whose key type is an anonymous <code>struct</code>:</p>\n\n<pre><code>var data map[struct{ pID, bID int }]string\n</code></pre>\n\n<p>Question: <strong>How  would I go about constructing a key to actually get/set a value in <code>data</code></strong>?</p>\n\n<p>I've tried these, which all result in compiler errors:</p>\n\n<pre><code>data[{1,2}] = \"ok\"\ndata[{pID: 1, bID 2}] = \"ok\"\n</code></pre>\n\n<p>It seems I cannot form a compound literal without having the type name, but there is no type name.</p>\n\n<hr>\n\n<p>This related question uses an anymous <code>struct</code> as the <em>value</em> of a <code>map</code>, but not the <em>key</em>:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/25002711/anonymous-struct-as-value-to-a-map\">Anonymous struct as value to a map</a></li>\n</ul>\n"}, {"tags": ["json", "go"], "answers": [{"tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": true, "score": 4, "last_activity_date": 1476483913, "creation_date": 1476483913, "answer_id": 40052834, "question_id": 40052543, "link": "https://stackoverflow.com/questions/40052543/adjusting-the-structure-when-unmarshalling-json-in-go/40052834#40052834", "title": "Adjusting the structure when unmarshalling json in go", "body": "<p>All you have to do is implement the <a href=\"https://golang.org/pkg/encoding/json/#Unmarshaler\" rel=\"nofollow\">Unmarshaler</a> interface just adding the method <code>UnmarshalJSON(data []byte) error</code> and including the logic that you need after Unmarshal; and if you want to do the inverse operation(marshal) just implement the <a href=\"https://golang.org/pkg/encoding/json/#Marshaler\" rel=\"nofollow\">Marshaler</a> interface.</p>\n\n<pre><code>type State struct {\n    Name string `json:\"name\"`\n}\n\ntype Device struct {\n    States []State\n}\n\nfunc (dev *Device) UnmarshalJSON(data []byte) error {\n\n    // anonymous struct with the real backbone of the json\n    tmp := struct {\n        States struct {\n            State []State `json:\"state\"`\n        } `json:\"states\"`\n    }{}\n\n    if err := json.Unmarshal(data, &amp;tmp); err != nil {\n        return err\n    }\n\n    dev.States = tmp.States.State\n\n    return nil\n}\n</code></pre>\n\n<p>Full example: <a href=\"https://play.golang.org/p/gNpS13ED_i\" rel=\"nofollow\">https://play.golang.org/p/gNpS13ED_i</a></p>\n"}], "owner": {"reputation": 387, "user_id": 677360, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fb00c82e046fe26e7cd47d3d62ddf1a3?s=128&d=identicon&r=PG", "display_name": "caiman", "link": "https://stackoverflow.com/users/677360/caiman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 40052834, "answer_count": 1, "score": 4, "last_activity_date": 1476483913, "creation_date": 1476481969, "question_id": 40052543, "link": "https://stackoverflow.com/questions/40052543/adjusting-the-structure-when-unmarshalling-json-in-go", "title": "Adjusting the structure when unmarshalling json in go", "body": "<p>Unmarshalling JSON (that I do not control) like this:</p>\n\n<pre><code>{\n    \"states\": {\n        \"state\": [\n            { ...}\n        ]\n    }\n}\n</code></pre>\n\n<p>into a struct like:</p>\n\n<pre><code>type Device struct {\n    States    struct{ State []State }\n}\nvar dev Device\n</code></pre>\n\n<p>I get an ugly syntax to access a state:</p>\n\n<pre><code>dev.States.State[0]\n</code></pre>\n\n<p>I would like to be able to transform the object so I can do</p>\n\n<pre><code>dev.States[0]\n</code></pre>\n\n<p>Can this be done with tags (omitted in the above example because not needed), or with another method, or do I have to first unmarshal to a struct like the above then manually remap to a struct as I want it?</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 707, "user_id": 2071056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7147138fc22fbd2b9d71611506c93701?s=128&d=identicon&r=PG", "display_name": "davidcv5", "link": "https://stackoverflow.com/users/2071056/davidcv5"}, "edited": false, "score": 0, "creation_date": 1476499695, "post_id": 40051434, "comment_id": 67384600, "body": "Can you include the command your running to deploy?"}, {"owner": {"reputation": 21, "user_id": 6423978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aadf8f259d8070bb736e60455003ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Scheper", "link": "https://stackoverflow.com/users/6423978/jack-scheper"}, "reply_to_user": {"reputation": 707, "user_id": 2071056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7147138fc22fbd2b9d71611506c93701?s=128&d=identicon&r=PG", "display_name": "davidcv5", "link": "https://stackoverflow.com/users/2071056/davidcv5"}, "edited": false, "score": 0, "creation_date": 1476566011, "post_id": 40051434, "comment_id": 67402534, "body": "goapp deploy  A Cloud support tech did reply that there is an &quot;ongoing issue&quot; being investigated.  He ask me to run this command:  gcloud app deploy --verbosity=debug --log-http  ...it doesn&#39;t run: ERROR: (gcloud) Invalid choice: &#39;app&#39;. Did you mean &#39;auth&#39;? But that doesn&#39;t run either..."}, {"owner": {"reputation": 21, "user_id": 6423978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aadf8f259d8070bb736e60455003ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Scheper", "link": "https://stackoverflow.com/users/6423978/jack-scheper"}, "reply_to_user": {"reputation": 707, "user_id": 2071056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7147138fc22fbd2b9d71611506c93701?s=128&d=identicon&r=PG", "display_name": "davidcv5", "link": "https://stackoverflow.com/users/2071056/davidcv5"}, "edited": false, "score": 0, "creation_date": 1476729458, "post_id": 40051434, "comment_id": 67459519, "body": "I guess the issue is still ongoing.  Support guy said to update GCloud SDK.   I think that it is updated when the GAE Go SDK is updated - isn&#39;t it?  Regardless, I don&#39;t want to use GCloud because I&#39;d like to keep the same version number &amp; can&#39;t figure out how to do that  with GCloud update (because it breaks the advert proxy server that sites in front of my site).  I&#39;m going to have to pay the $125/month for Silver Support - to find out if there is still an ongoing issue &amp; how to work around it.  Let this be a lesson to me."}, {"owner": {"reputation": 21, "user_id": 6423978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aadf8f259d8070bb736e60455003ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Scheper", "link": "https://stackoverflow.com/users/6423978/jack-scheper"}, "reply_to_user": {"reputation": 707, "user_id": 2071056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7147138fc22fbd2b9d71611506c93701?s=128&d=identicon&r=PG", "display_name": "davidcv5", "link": "https://stackoverflow.com/users/2071056/davidcv5"}, "edited": false, "score": 0, "creation_date": 1476732039, "post_id": 40051434, "comment_id": 67460819, "body": "uh oh,  it&#39;s $150 now and it&#39;s kinda messed up too.  It takes you to a support page form that doesn&#39;t have a category for GCloud/GAE support.   I sent request to G Suite team and asked them to forward to GCloud..."}, {"owner": {"reputation": 21, "user_id": 6423978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aadf8f259d8070bb736e60455003ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Scheper", "link": "https://stackoverflow.com/users/6423978/jack-scheper"}, "reply_to_user": {"reputation": 707, "user_id": 2071056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7147138fc22fbd2b9d71611506c93701?s=128&d=identicon&r=PG", "display_name": "davidcv5", "link": "https://stackoverflow.com/users/2071056/davidcv5"}, "edited": false, "score": 0, "creation_date": 1476733749, "post_id": 40051434, "comment_id": 67461713, "body": "yikes!  I submitted a ticket, got response from GSuite who forwarded  it GCloud Support.  Gave me a link and said to post a response to the ticket - but now it has vanished!   Hope I hear from GCloud support anyway."}, {"owner": {"reputation": 21, "user_id": 6423978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aadf8f259d8070bb736e60455003ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Scheper", "link": "https://stackoverflow.com/users/6423978/jack-scheper"}, "reply_to_user": {"reputation": 707, "user_id": 2071056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7147138fc22fbd2b9d71611506c93701?s=128&d=identicon&r=PG", "display_name": "davidcv5", "link": "https://stackoverflow.com/users/2071056/davidcv5"}, "edited": false, "score": 0, "creation_date": 1478276188, "post_id": 40051434, "comment_id": 68103107, "body": "Support is unable to tell me when this sdk version will be released.  I am still unable to update my site.   It&#39;s been down 3 weeks now."}], "answers": [{"tags": [], "owner": {"reputation": 1603, "user_id": 3365995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f8546ab7878c21bbcc9feedcb3aeae7?s=128&d=identicon&r=PG&f=1", "display_name": "Peter G", "link": "https://stackoverflow.com/users/3365995/peter-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1476911475, "creation_date": 1476911475, "answer_id": 40141603, "question_id": 40051434, "link": "https://stackoverflow.com/questions/40051434/cant-deploy-go-app-error-422-to-appengine/40141603#40141603", "title": "Can&#39;t Deploy Go app Error 422 to AppEngine", "body": "<p>Do you have any non-imported subdirectories in your app directory that may contain package main? I've jumped to the conclusion that go-app-builder is applying the equivalent of go tool vet ./... (instead of go tool vet .) and is using an old version. I recently started encountering this error while deploying:</p>\n\n<pre><code>01:05 PM Error 422: --- begin server output ---\nCompile failed:\n2016/10/19 10:05:23 go-app-builder: Failed parsing input (2 errors)\n2016/10/19 10:05:23 appleasn1.go:16:25: composite struct literal encoding/asn1.ObjectIdentifier with unkeyed fields\n2016/10/19 10:05:23 appleasn1.go:17:25: composite struct literal encoding/asn1.ObjectIdentifier with unkeyed fields\n--- end server output ---\n01:05 PM Rolling back the update.\n</code></pre>\n\n<p>asn1.ObjectIdentifier is an alias for []int, so this is not a composite struct literal. This <a href=\"https://github.com/golang/go/issues/9171\" rel=\"nofollow\">bug in vet was fixed six months ago</a>. I shared my findings with GCloud Support, and they've assured me they're on it. As a workaround, I've made my code pass the overly strict go vet process. If you have a subdirectory in your app that contains package main, you can exclude it in your app.yaml with a skip_files directive:</p>\n\n<pre><code>skip_files:\n- bench/.*\n- testdata/.*\n</code></pre>\n\n<p>The fix for the composite error involved changing from this:</p>\n\n<pre><code>oidData = asn1.ObjectIdentifier{1, 2, 840, 113549, 1, 7, 1}\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>oidData = asn1.ObjectIdentifier([]int{1, 2, 840, 113549, 1, 7, 1})\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 6423978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aadf8f259d8070bb736e60455003ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Scheper", "link": "https://stackoverflow.com/users/6423978/jack-scheper"}, "edited": false, "score": 0, "creation_date": 1477152337, "post_id": 40165624, "comment_id": 67654283, "body": "the current version number of the sdk is 1.9.40 - it&#39;s complaining that &quot;top level main package is forbidden&quot;  as I try to update my code."}, {"owner": {"reputation": 21, "user_id": 6423978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aadf8f259d8070bb736e60455003ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Scheper", "link": "https://stackoverflow.com/users/6423978/jack-scheper"}, "edited": false, "score": 0, "creation_date": 1477152605, "post_id": 40165624, "comment_id": 67654364, "body": "I noticed in the source code the line &quot;// Main is not yet supported on App Engine Standard.&quot;     What&#39;s with the spazzy release?  Why no backward compatibility?   Why do this in such a way that I haven&#39;t been able to update my site in over a week?"}, {"owner": {"reputation": 613, "user_id": 4743732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/glP0W.jpg?s=128&g=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/4743732/jordan"}, "reply_to_user": {"reputation": 21, "user_id": 6423978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aadf8f259d8070bb736e60455003ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Scheper", "link": "https://stackoverflow.com/users/6423978/jack-scheper"}, "edited": false, "score": 0, "creation_date": 1477316831, "post_id": 40165624, "comment_id": 67703409, "body": "@JackScheper The comment about <i>&quot;Main is not yet supported on App Engine Standard&quot;</i> in the source is exactly what this <a href=\"https://groups.google.com/forum/#!topic/google-appengine-go/zL4uLQfVS7c\" rel=\"nofollow noreferrer\">new change</a> is correcting.   Have you followed the list of provided solutions from our Groups post linked above?  Ensuring that all of your imports are from the GOPATH, and that you have added the recommended <code>nobuild_files: commands&#47;.*</code> to your &#39;app.yaml&#39; will ensure that you have the fix in place.  Our upcoming 1.9.46 SDK release will have these fixes implemented for you."}, {"owner": {"reputation": 21, "user_id": 6423978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aadf8f259d8070bb736e60455003ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Scheper", "link": "https://stackoverflow.com/users/6423978/jack-scheper"}, "edited": false, "score": 0, "creation_date": 1478276510, "post_id": 40165624, "comment_id": 68103297, "body": "I understand that this change will correct this difference but that&#39;s no reason to suddenly break a process.  It&#39;s been 3 weeks!"}, {"owner": {"reputation": 613, "user_id": 4743732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/glP0W.jpg?s=128&g=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/4743732/jordan"}, "reply_to_user": {"reputation": 21, "user_id": 6423978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aadf8f259d8070bb736e60455003ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Scheper", "link": "https://stackoverflow.com/users/6423978/jack-scheper"}, "edited": false, "score": 1, "creation_date": 1478280239, "post_id": 40165624, "comment_id": 68105505, "body": "@JackScheper Our engineering team has provided an updated ETA. The fix should land in 1.9.47 <a href=\"https://cloud.google.com/appengine/docs/go/release-notes\" rel=\"nofollow noreferrer\">SDK</a>, which should release within the next two weeks. I have updated the above answer to be more complete."}], "tags": [], "owner": {"reputation": 613, "user_id": 4743732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/glP0W.jpg?s=128&g=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/4743732/jordan"}, "is_accepted": false, "score": 0, "last_activity_date": 1478279976, "last_edit_date": 1478279976, "creation_date": 1477003032, "answer_id": 40165624, "question_id": 40051434, "link": "https://stackoverflow.com/questions/40051434/cant-deploy-go-app-error-422-to-appengine/40165624#40165624", "title": "Can&#39;t Deploy Go app Error 422 to AppEngine", "body": "<p><strong>EDITED:</strong></p>\n\n<p>This issue stems from App Engine Standard's new ability for apps to provide their own main package with a main function, as explained in our public <a href=\"https://groups.google.com/forum/#!topic/google-appengine-go/zL4uLQfVS7c\" rel=\"nofollow noreferrer\">Google Groups post</a>. The workaround is to add <code>nobuild_files: commands/.*</code> to your 'app.yaml'.  The official fix for this will be release in the next SDK 1.9.47. </p>\n\n<p>In the meantime, if you have a 'main.go' file, ensure that it is in the same directory level from where you are deploying (aka the top-level package). Also ensure that you are providing the required <code>appengine.Main()</code> within your main function as explained in the <a href=\"https://github.com/golang/appengine/blob/8d4b9e99ddd83f9654e3347a58ba925d3f8a4d10/appengine.go#L35\" rel=\"nofollow noreferrer\">source code</a>. </p>\n\n<p>I also recommend adding in <code>// +build !appengine</code> at the top of your 'main.go' as shown in the <a href=\"https://github.com/golang/appengine/blob/78199dcb0669fc381c22e919e1e97eba879e8f60/demos/helloworld/helloworld.go#L6\" rel=\"nofollow noreferrer\">helloworld</a> example. This will tell App Engine to skip trying to upload or compile any unused code, which may also be the cause of the deployment failure. </p>\n"}], "owner": {"reputation": 21, "user_id": 6423978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aadf8f259d8070bb736e60455003ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Scheper", "link": "https://stackoverflow.com/users/6423978/jack-scheper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 987, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1478279976, "creation_date": 1476476598, "question_id": 40051434, "link": "https://stackoverflow.com/questions/40051434/cant-deploy-go-app-error-422-to-appengine", "title": "Can&#39;t Deploy Go app Error 422 to AppEngine", "body": "<p>Suddenly can't deploy Go app to GAE.  Haven't changed any of the code and Works fine on local.  </p>\n\n<p>03:39 PM Error 422: --- begin server output ---\nCompile failed:\n2016/10/14 12:39:46 go-app-builder: Failed parsing input: package main must be the top-level package\n--- end server output ---</p>\n\n<p>Since it's a cloud app I don't have a Main package - everything was fine a few days ago. I'm on Windows 10 and got and update a few days ago...<br>\nI did update to the latest Go Cloud SDK but get the same error.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "edited": false, "score": 0, "creation_date": 1476476386, "post_id": 40051213, "comment_id": 67378894, "body": "This is a system configuration thing; Go has nothing to do with it. It&#39;s the same for all programming languages, and depends on how your system is configured."}, {"owner": {"reputation": 11281, "user_id": 260805, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/34e031251528689dd8f8039fef24a65f?s=128&d=identicon&r=PG", "display_name": "Ztyx", "link": "https://stackoverflow.com/users/260805/ztyx"}, "reply_to_user": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "edited": false, "score": 2, "creation_date": 1476476469, "post_id": 40051213, "comment_id": 67378917, "body": "Okay, how does it figure out how my system is configured?"}, {"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "edited": false, "score": 0, "creation_date": 1476476507, "post_id": 40051213, "comment_id": 67378934, "body": "Well, on Darwin, the relevant file is in the <code>x509</code> package: <a href=\"https://golang.org/src/crypto/x509/root_cgo_darwin.go\" rel=\"nofollow noreferrer\"><code>root_cgo_darwin.go</code></a>"}, {"owner": {"reputation": 11281, "user_id": 260805, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/34e031251528689dd8f8039fef24a65f?s=128&d=identicon&r=PG", "display_name": "Ztyx", "link": "https://stackoverflow.com/users/260805/ztyx"}, "reply_to_user": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "edited": false, "score": 2, "creation_date": 1476476626, "post_id": 40051213, "comment_id": 67378990, "body": "Found the answer. Wrote an answer to my question."}], "answers": [{"tags": [], "owner": {"reputation": 11281, "user_id": 260805, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/34e031251528689dd8f8039fef24a65f?s=128&d=identicon&r=PG", "display_name": "Ztyx", "link": "https://stackoverflow.com/users/260805/ztyx"}, "is_accepted": true, "score": 25, "last_activity_date": 1592955024, "last_edit_date": 1592955024, "creation_date": 1476476593, "answer_id": 40051432, "question_id": 40051213, "link": "https://stackoverflow.com/questions/40051213/where-is-golang-picking-up-root-cas-from/40051432#40051432", "title": "Where is Golang picking up root CAs from?", "body": "<p>It searches through the following locations: <a href=\"https://golang.org/src/crypto/x509/root_linux.go\" rel=\"noreferrer\">https://golang.org/src/crypto/x509/root_linux.go</a></p>\n<p><em>excerpt</em></p>\n<pre><code>// Copyright 2015 The Go Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style\n// license that can be found in the LICENSE file.\n\npackage x509\n\n// Possible certificate files; stop after finding one.\nvar certFiles = []string{\n    &quot;/etc/ssl/certs/ca-certificates.crt&quot;,                // Debian/Ubuntu/Gentoo etc.\n    &quot;/etc/pki/tls/certs/ca-bundle.crt&quot;,                  // Fedora/RHEL 6\n    &quot;/etc/ssl/ca-bundle.pem&quot;,                            // OpenSUSE\n    &quot;/etc/pki/tls/cacert.pem&quot;,                           // OpenELEC\n    &quot;/etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem&quot;, // CentOS/RHEL 7\n    &quot;/etc/ssl/cert.pem&quot;,                                 // Alpine Linux\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1506, "user_id": 8689709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd57855e7bff23fbca35abc8ddc0073?s=128&d=identicon&r=PG", "display_name": "Bill Zelenko", "link": "https://stackoverflow.com/users/8689709/bill-zelenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1582597486, "creation_date": 1582597486, "answer_id": 60386677, "question_id": 40051213, "link": "https://stackoverflow.com/questions/40051213/where-is-golang-picking-up-root-cas-from/60386677#60386677", "title": "Where is Golang picking up root CAs from?", "body": "<p>These are the locations; stop after finding one:</p>\n\n<pre><code>\"/etc/ssl/certs/ca-certificates.crt\",                // Debian/Ubuntu/Gentoo etc.\n\"/etc/pki/tls/certs/ca-bundle.crt\",                  // Fedora/RHEL 6\n\"/etc/ssl/ca-bundle.pem\",                            // OpenSUSE\n\"/etc/pki/tls/cacert.pem\",                           // OpenELEC\n\"/etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\", // CentOS/RHEL 7\n\"/etc/ssl/cert.pem\",                                 // Alpine Linux\n</code></pre>\n"}], "owner": {"reputation": 11281, "user_id": 260805, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/34e031251528689dd8f8039fef24a65f?s=128&d=identicon&r=PG", "display_name": "Ztyx", "link": "https://stackoverflow.com/users/260805/ztyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10450, "favorite_count": 5, "accepted_answer_id": 40051432, "answer_count": 2, "score": 13, "last_activity_date": 1592955024, "creation_date": 1476475633, "question_id": 40051213, "link": "https://stackoverflow.com/questions/40051213/where-is-golang-picking-up-root-cas-from", "title": "Where is Golang picking up root CAs from?", "body": "<p><code>crypto/tls.Config.RootCAs</code> <a href=\"https://golang.org/pkg/crypto/tls/#Config\" rel=\"noreferrer\">states</a></p>\n\n<pre><code>// RootCAs defines the set of root certificate authorities\n// that clients use when verifying server certificates.\n// If RootCAs is nil, TLS uses the host's root CA set.\n</code></pre>\n\n<p><strong>On Linux, where are \"the host's root CA set\" picked up from?</strong> I need to know this to be able to globally add another root CA to trust.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1476470337, "post_id": 40049884, "comment_id": 67375897, "body": "Where are you adding and removing things from the WaitGroup?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1476470983, "post_id": 40049884, "comment_id": 67376246, "body": "If you&#39;re adding to the waitGroup in the goroutine itself, this is probably what will happen."}, {"owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "edited": false, "score": 0, "creation_date": 1476471010, "post_id": 40049884, "comment_id": 67376262, "body": "I am adding &#39;wg.Add(len(hosts))&#39; just before for loop in main(). Never remove anything, there is &#39;wg.Wait()&#39; just after for loop"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 2, "creation_date": 1476471099, "post_id": 40049884, "comment_id": 67376308, "body": "so if you are not doing <code>wg.Done()</code> anywhere, why will this ever end?"}, {"owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "edited": false, "score": 0, "creation_date": 1476471186, "post_id": 40049884, "comment_id": 67376359, "body": "oh..there is wg.Done() as last instruction in the func ping, I will update it asap. Not sure how it get removed ..added link to github"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1476471640, "post_id": 40049884, "comment_id": 67376590, "body": "If some of the commands aren&#39;t returning, you need to debug why. Maybe connect them directly to stdout/stderr and see if there&#39;s any clues in the output. If they are returning, get a stack trace and see where you&#39;re blocking."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 2, "creation_date": 1476471646, "post_id": 40049884, "comment_id": 67376593, "body": "in general it looks okay, but there might be a file descriptor limit issue or something like that."}, {"owner": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "edited": false, "score": 3, "creation_date": 1476471693, "post_id": 40049884, "comment_id": 67376607, "body": "You&#39;re not printing errors, maybe they just fail?"}, {"owner": {"reputation": 735, "user_id": 6697038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eqwd8.jpg?s=128&g=1", "display_name": "nosequeldeebee", "link": "https://stackoverflow.com/users/6697038/nosequeldeebee"}, "edited": false, "score": 2, "creation_date": 1476471809, "post_id": 40049884, "comment_id": 67376685, "body": "Please post what errors you&#39;re getting after adding error handling"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476473022, "post_id": 40049884, "comment_id": 67377328, "body": "I&#39;m with @JimB on this: I&#39;d modify the <code>ping</code> function to prepare an <code>os&#47;exec.Cmd</code> instance which <code>stderr</code> and <code>stdout</code> are connected to those of the process, and see whether some of the executables being run actually fail."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1476474138, "post_id": 40049884, "comment_id": 67377854, "body": "would be better if you copy the error"}, {"owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "edited": false, "score": 0, "creation_date": 1476474698, "post_id": 40049884, "comment_id": 67378123, "body": "I updated question with result, never did debug before, will learn asap;)"}, {"owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "edited": false, "score": 0, "creation_date": 1476476241, "post_id": 40049884, "comment_id": 67378822, "body": "I think I found the problem...Windows ping is in &#39;ms&#39;, But Linux in &#39;s&#39;. So default 1000ms is in fact 1000s in Linux and program start to wait after it encounter first non-pingable IP ;("}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1476521863, "post_id": 40049884, "comment_id": 67388886, "body": "ping on Linux does not return, it continues - in contrast to Windows which return only 4 lines by default."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476478151, "post_id": 40051153, "comment_id": 67379691, "body": "While a panic would skip the non-defered <code>wg.Done</code>, the original wasn&#39;t recovering so a panic would be evident, and nothing in that function should panic anyway."}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476479857, "post_id": 40051153, "comment_id": 67380362, "body": "yep, you are right, for some reason i thinking it was dropped silently"}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 1, "last_activity_date": 1476475370, "creation_date": 1476475370, "answer_id": 40051153, "question_id": 40049884, "link": "https://stackoverflow.com/questions/40049884/golang-sync-waitgroup-doesnt-complete-on-linux/40051153#40051153", "title": "golang sync.WaitGroup doesn&#39;t complete on Linux", "body": "<p>You may be ignoring panics here, change your ping function to:</p>\n\n<pre><code>func ping(ip string, wg *sync.WaitGroup, os string ) {\n    defer wg.Done()\n    defer func(){\n       if err := recover(); err != nil {\n           fmt.Println(\"Error with:\",ip,\"err:\",err)\n       }\n    }()\n    result , err := exec.Command(\"ping\", os, *PINGCOUNT, \"-w\", PINGTIMEOUT, ip).Output()\n    fmt.Printf(\"%s\\n\", result)\n    if err == nil {\n        count++\n        fmt.Printf(\"%d %s \\n\", count, ip)\n    } else {\n        //fmt.Printf(\"%s is dead\\n\", ip)\n    }\n}\n</code></pre>\n\n<p>this should print the panic, if it happens, as well as guarantee to call wg.Done()</p>\n\n<p>// note: didnt run this, but it's directionally correct</p>\n"}], "owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476475370, "creation_date": 1476469853, "last_edit_date": 1476474638, "question_id": 40049884, "link": "https://stackoverflow.com/questions/40049884/golang-sync-waitgroup-doesnt-complete-on-linux", "title": "golang sync.WaitGroup doesn&#39;t complete on Linux", "body": "<p>I have ping function which works fine on Windows, but not on Linux. On Linux it pings few hosts and stops (doesn't exit). </p>\n\n<pre><code>    func main() {\n    ...\nwg.Add(len(hosts))\n    for _, ip := range hosts {\n            go ping(ip, &amp;wg, os)        \n        }\n        wg.Wait()\n    ...\n    }\n</code></pre>\n\n<p>I can ping hundreds of hosts on Windows but not on Linux. Look at <a href=\"https://github.com/irom77/go-public/blob/master/gping/main.go\" rel=\"nofollow\">https://github.com/irom77/go-public/blob/master/gping/main.go</a> for the whole thing</p>\n\n<pre><code>    func ping(ip string, wg *sync.WaitGroup, os string ) {  \n        _ , err := exec.Command(\"ping\", os, *PINGCOUNT, \"-w\", *PINGTIMEOUT, ip).Output()    \n        if err == nil {\n            count++\n            fmt.Printf(\"%d %s \\n\", count, ip)\n        } \nwg.Done()\n    }\n</code></pre>\n\n<p>When printing result (adding 'result' inside func ping)</p>\n\n<pre><code>result , err := exec.Command(\"ping\", os, *PINGCOUNT, \"-w\", *PINGTIMEOUT, ip).Output()\nfmt.Printf(\"%s\\n\", result)\n</code></pre>\n\n<p>I just got correct output , but it doesnt continue to ping next IPs</p>\n\n<pre><code>....\n--- 10.192.167.1 ping statistics ---\n1 packets transmitted, 1 received, 0% packet loss, time 0ms\nrtt min/avg/max/mdev = 476.564/476.564/476.564/0.000 ms\n\n49 10.192.167.1\n</code></pre>\n\n<p>expecting more IPs here (fine in Windows)</p>\n"}, {"tags": ["go", "shared-libraries"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1476457343, "post_id": 40046145, "comment_id": 67368525, "body": "What do you mean by &quot;Golang script&quot;? Are you compiling a Go program that uses <code>cgo</code> to use the C shared library?"}, {"owner": {"reputation": 328, "user_id": 4844822, "user_type": "registered", "profile_image": "https://graph.facebook.com/459123704243311/picture?type=large", "display_name": "Zsigmond L\u0151rinczy", "link": "https://stackoverflow.com/users/4844822/zsigmond-l%c5%91rinczy"}, "edited": false, "score": 0, "creation_date": 1476466515, "post_id": 40046145, "comment_id": 67373948, "body": "@OP Exactly what command did you try? Please quote it."}, {"owner": {"reputation": 41, "user_id": 3218590, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ed421600c9a989bef750d7b457ce880d?s=128&d=identicon&r=PG&f=1", "display_name": "user3218590", "link": "https://stackoverflow.com/users/3218590/user3218590"}, "edited": false, "score": 0, "creation_date": 1476537920, "post_id": 40046145, "comment_id": 67393367, "body": "Added the commands I have tried in the post"}, {"owner": {"reputation": 328, "user_id": 4844822, "user_type": "registered", "profile_image": "https://graph.facebook.com/459123704243311/picture?type=large", "display_name": "Zsigmond L\u0151rinczy", "link": "https://stackoverflow.com/users/4844822/zsigmond-l%c5%91rinczy"}, "edited": false, "score": 1, "creation_date": 1476548706, "post_id": 40046145, "comment_id": 67396766, "body": "You could try to change line 5 in gotest.go: <code>#cgo LDFLAGS: -L. -ltest -ldl</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476554652, "post_id": 40046145, "comment_id": 67398811, "body": "Why are you using <code>gccgo</code>? (and you should never use, or need to use sudo to compile). as ZsigmondL\u0151rinczy suggested, add <code>-ldl</code> to your <code>LDFLAGS</code>."}, {"owner": {"reputation": 41, "user_id": 3218590, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ed421600c9a989bef750d7b457ce880d?s=128&d=identicon&r=PG&f=1", "display_name": "user3218590", "link": "https://stackoverflow.com/users/3218590/user3218590"}, "edited": false, "score": 0, "creation_date": 1476630662, "post_id": 40046145, "comment_id": 67416941, "body": "Thanks, it&#39;s working after adding -ldl in the gotest.go as suggested by Zsigmond Lorinczy"}, {"owner": {"reputation": 41, "user_id": 3218590, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ed421600c9a989bef750d7b457ce880d?s=128&d=identicon&r=PG&f=1", "display_name": "user3218590", "link": "https://stackoverflow.com/users/3218590/user3218590"}, "edited": false, "score": 0, "creation_date": 1476696674, "post_id": 40046145, "comment_id": 67438319, "body": "Now the dlopen error is resolved but the C function exposed by libtest.so is not visible by gotest.go while running the command go run gotest.go. It sayas &quot; error: undefined reference to &#39;getStudents&#39; &quot;  Am I supposed to run any other command?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476725779, "post_id": 40046145, "comment_id": 67457544, "body": "@user3218590: I don&#39;t understand. You said it&#39;s working now, which means you built the binary, so why are you calling <code>go run</code> instead of executing that binary you just built? (and stop using gccgo for now. It&#39;s only adding to the confusing)"}, {"owner": {"reputation": 41, "user_id": 3218590, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ed421600c9a989bef750d7b457ce880d?s=128&d=identicon&r=PG&f=1", "display_name": "user3218590", "link": "https://stackoverflow.com/users/3218590/user3218590"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476729240, "post_id": 40046145, "comment_id": 67459417, "body": "@JimB Last time I just used the command go run gotest.go and it resolved the dlopen error. But now it says undefined reference to getStudent. What command should I use to build?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476730264, "post_id": 40046145, "comment_id": 67459932, "body": "You can use <code>go build</code> or <code>go install</code> (<code>go run</code> uses <code>go build</code> in a temp dir), but if you build the binary, you at least look at the shared object dependencies. You&#39;re either not finding the library, or it&#39;s linking the incorrect one. Relative paths don&#39;t work in cgo directives, try <code>-L${SRCDIR}</code>, though that ties the executable to the path of the package source when dynamically linking."}], "owner": {"reputation": 41, "user_id": 3218590, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ed421600c9a989bef750d7b457ce880d?s=128&d=identicon&r=PG&f=1", "display_name": "user3218590", "link": "https://stackoverflow.com/users/3218590/user3218590"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 854, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1476700691, "creation_date": 1476456771, "last_edit_date": 1592644375, "question_id": 40046145, "link": "https://stackoverflow.com/questions/40046145/go-run-throes-error-undefined-reference-to-dlopen", "title": "go run throes error &quot; undefined reference to `dlopen&#39;&quot;", "body": "<p>I am trying to integrate Golang script with existing C shared library.\nThe C shared library in turn loads other shared libraries at run time.</p>\n<p>While I am trying to run\ngo run gotest.go</p>\n<p>it throws error</p>\n<pre><code>./libtest.so: undefined reference to `dlopen'\n./libtest.so: undefined reference to `dlclose'\n./libtest.so: undefined reference to `dlerror'\n./libtest.so: undefined reference to `dlsym'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n<p>I have created separate C executable to load this libtest.so at run time and that is working properly.</p>\n<p>Any idea what should be done to fix the issue?</p>\n<p>I have tried following commands</p>\n<blockquote>\n<p>sudo go build -compiler=gccgo -gccgoflags=&quot;-ltest&quot; gotest.go</p>\n<p>also tried the command</p>\n<p>sudo go build -compiler=gccgo -gccgoflags=&quot;-ltest -ldl&quot; gotest.go</p>\n<p>Also tried the command</p>\n<p>go run gotest.go</p>\n<p>===============================================</p>\n</blockquote>\n<p>Here is the code I am using</p>\n<pre><code>testapi.h\ntypedef Students{\n        char name[40];\n        int  id;\n} Student;\n\nStudent* getStudent();\n\ntest.c\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &quot;mylib.h&quot;\n#include &quot;testapi.h&quot;\n\nint rc = 0;\nStudent *s = 0;\nStudent* getStudent(){\n   \n   rc = loadmylib(); //This function loads another shared library\n   if (!rc)\n   {\n       rc = initlib(); //This calls dlsym to get the necessary function from opened shared library\n       if (!rc)\n       {\n           s= (student *)malloc(sizeof(Student));\n    \n           //use the function pointer received from dlsym to populate the Student struct 's'\n       }\n    }\n    return s;\n}\n</code></pre>\n<p>I have following entries in my gotest.go file</p>\n<pre><code>package main\n\n/*\n#cgo CFLAGS: -I.\n#cgo LDFLAGS: -L. -ltest -ldl\n#include &quot;testapi.h&quot;\n*/\nimport &quot;C&quot;\nimport (\n    &quot;fmt&quot;\n)\n\ntype Student struct{\n     name string\n     id int\n}\n\nfunc main() {\n    st := C.getStudent()\n    fmt.Println(&quot;Name: &quot;, string(st.name))\n}\n</code></pre>\n<p>I have copied testapi.h, gotest.go, mylib.h, libmylib.so, libtest.so in the same directory.\nThen run the command</p>\n<blockquote>\n<p>go run gotest.go</p>\n</blockquote>\n<p>It has thrown the error &quot; error: undefined reference to 'getStudent' &quot;</p>\n<p>What am I doing wrong here?\nAm I supposed to run command</p>\n<blockquote>\n<p>sudo go build -compiler=gccgo -gccgoflags=&quot;-ltest&quot; gotest.go</p>\n</blockquote>\n"}, {"tags": ["memory", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476456255, "post_id": 40045816, "comment_id": 67367830, "body": "What&#39;s are the <code>runtime.MemStats</code> at this point? (also shown in <code>&#47;debug&#47;pprof&#47;heap</code> if you&#39;re using the http/pprof hook)"}], "answers": [{"tags": [], "owner": {"reputation": 7023, "user_id": 790075, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fdb8ce54c398b1aa794833a601507361?s=128&d=identicon&r=PG", "display_name": "turtlemonvh", "link": "https://stackoverflow.com/users/790075/turtlemonvh"}, "is_accepted": false, "score": 0, "last_activity_date": 1476466334, "creation_date": 1476466334, "answer_id": 40048921, "question_id": 40045816, "link": "https://stackoverflow.com/questions/40045816/go-memory-profiling/40048921#40048921", "title": "Go Memory Profiling", "body": "<p>It's likely that extra memory usage is from the file system, esp. since you are probably scanning over a lot of disk.</p>\n\n<p>See: <a href=\"http://www.linuxatemyram.com/\" rel=\"nofollow\">http://www.linuxatemyram.com/</a></p>\n"}], "owner": {"reputation": 11, "user_id": 7019710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e291210ad975ece390dc8e55fafb42b8?s=128&d=identicon&r=PG&f=1", "display_name": "Quentin JEROME", "link": "https://stackoverflow.com/users/7019710/quentin-jerome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1476466334, "creation_date": 1476455819, "question_id": 40045816, "link": "https://stackoverflow.com/questions/40045816/go-memory-profiling", "title": "Go Memory Profiling", "body": "<p>It is already the second time that I notice one of my Go program taking alot of memory (much more that I would expect) and that I do not understand why, so here I am.\nI decided to profile the memory with pprof and the result of the top5 pprof memory profiling is as such:</p>\n\n<pre><code>1140.28MB of 1169.97MB total (97.46%)\nDropped 61 nodes (cum &lt;= 5.85MB)\nShowing top 5 nodes out of 15 (cum &gt;= 33.89MB)\n</code></pre>\n\n<p>My problem is the following. In the profile we see that the program consumed roughly 1.2GB of memory (which is affordable for what I am doing, parsing and indexing logs). However, when I do a \"top command\" and look at the resident memory used by my program, it is rather around 10GB to 11GB of memory taken by the program which is quite a huge difference with the memory profiling. </p>\n\n<p>So where are those Gigs of memory that I don't see in the profile ?\nAnd why ?\nHow to troubleshout ?</p>\n\n<p>Thanks by advance,</p>\n"}]