[{"tags": ["go"], "comments": [{"owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "edited": false, "score": 0, "creation_date": 1522281671, "post_id": 49545786, "comment_id": 86099464, "body": "Sorry if I missed something. But why not just go to <a href=\"https://godoc.org/time\" rel=\"nofollow noreferrer\">godoc.org/time</a>? It has Constants section."}, {"owner": {"reputation": 48302, "user_id": 388916, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6f9d967832644f9faa431e4e50b69bb0?s=128&d=identicon&r=PG", "display_name": "Hubro", "link": "https://stackoverflow.com/users/388916/hubro"}, "reply_to_user": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "edited": false, "score": 0, "creation_date": 1522281848, "post_id": 49545786, "comment_id": 86099506, "body": "@Seva That&#39;s nice for that specific package, but <a href=\"https://godoc.org/http\" rel=\"nofollow noreferrer\">godoc.org/http</a> doesn&#39;t exist. It&#39;s also not an option for third-party packages on Github. It seems to me like <code>go doc &lt;pkg&gt;</code> should list all constants, or at least provide a flag for it."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1522282001, "post_id": 49545786, "comment_id": 86099551, "body": "All public packages are documented on godoc.org. See for instance <a href=\"https://godoc.org/github.com/gorilla/mux\" rel=\"nofollow noreferrer\">godoc.org/github.com/gorilla/mux</a>. The standard library is at <a href=\"https://golang.org/pkg\" rel=\"nofollow noreferrer\">golang.org/pkg</a>."}, {"owner": {"reputation": 48302, "user_id": 388916, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6f9d967832644f9faa431e4e50b69bb0?s=128&d=identicon&r=PG", "display_name": "Hubro", "link": "https://stackoverflow.com/users/388916/hubro"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1522282255, "post_id": 49545786, "comment_id": 86099606, "body": "@Peter Nice, I didn&#39;t know that. It&#39;s a shame <code>go doc</code> doesn&#39;t display all the same information though. It&#39;s so much faster to type <code>go doc mux | less</code> than opening the godoc.org page in the browser."}, {"owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "edited": false, "score": 2, "creation_date": 1522282761, "post_id": 49545786, "comment_id": 86099728, "body": "For http package, see <a href=\"https://godoc.org/net/http\" rel=\"nofollow noreferrer\">godoc.org/net/http</a>. But I think the main issue here it that <code>go doc</code> only can find what has been documented by the author. That is it looks at documenting comments, not at the code. But if you look at time package source code you&#39;ll see that they didn&#39;t bother to add a documenting comment to every single constant as meaning of each is pretty obvious. I&#39;d say this would be the case with other packages as well. So, if you really need it in command line, I think you need some sort of code analysis tool, not <code>go doc</code>."}, {"owner": {"reputation": 48302, "user_id": 388916, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6f9d967832644f9faa431e4e50b69bb0?s=128&d=identicon&r=PG", "display_name": "Hubro", "link": "https://stackoverflow.com/users/388916/hubro"}, "reply_to_user": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "edited": false, "score": 1, "creation_date": 1522282879, "post_id": 49545786, "comment_id": 86099761, "body": "@Seva Well, if you run <code>go doc time.Second</code> it displays all the <code>Duration</code> constants, so it definitely already analyzes the code."}], "answers": [{"comments": [{"owner": {"reputation": 48302, "user_id": 388916, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6f9d967832644f9faa431e4e50b69bb0?s=128&d=identicon&r=PG", "display_name": "Hubro", "link": "https://stackoverflow.com/users/388916/hubro"}, "edited": false, "score": 0, "creation_date": 1522280907, "post_id": 49545914, "comment_id": 86099274, "body": "I did actually <code>go doc time.Duration</code>, but the constants aren&#39;t mentioned there either, so I&#39;m not sure what you&#39;re saying :P Did you mean <code>go doc time.Nanosecond</code>? That produces a list of all <code>Duration</code> constants, but it&#39;s very unintuitive."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 48302, "user_id": 388916, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6f9d967832644f9faa431e4e50b69bb0?s=128&d=identicon&r=PG", "display_name": "Hubro", "link": "https://stackoverflow.com/users/388916/hubro"}, "edited": false, "score": 0, "creation_date": 1522283108, "post_id": 49545914, "comment_id": 86099812, "body": "@Hubro: See my revised answer."}, {"owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "edited": false, "score": 2, "creation_date": 1522285056, "post_id": 49545914, "comment_id": 86100280, "body": "You might also want to have a look at  <code>go tool api time</code>."}, {"owner": {"reputation": 48302, "user_id": 388916, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6f9d967832644f9faa431e4e50b69bb0?s=128&d=identicon&r=PG", "display_name": "Hubro", "link": "https://stackoverflow.com/users/388916/hubro"}, "reply_to_user": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "edited": false, "score": 0, "creation_date": 1522329052, "post_id": 49545914, "comment_id": 86121398, "body": "@Seva That sounds really useful, but for some reason, I don&#39;t have that tool: <code>go tool: no such tool &quot;api&quot;</code>. This probably merits its own question, but do you have any idea why? Google is giving me nothing on this one."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1522282886, "last_edit_date": 1522282886, "creation_date": 1522280783, "answer_id": 49545914, "question_id": 49545786, "link": "https://stackoverflow.com/questions/49545786/how-do-i-find-all-the-constants-in-a-package-using-go-doc/49545914#49545914", "title": "How do I find all the constants in a package using go doc?", "body": "<p>Start with <code>go doc time | grep 'const '</code>:</p>\n\n<pre><code>$ go doc time | grep 'const '\nconst ANSIC = \"Mon Jan _2 15:04:05 2006\" ...\nconst Nanosecond Duration = 1 ...\n    const January Month = 1 + iota ...\n    const Sunday Weekday = iota ...\n$\n</code></pre>\n\n<p>Then <code>go doc time.Nanosecond</code>:</p>\n\n<pre><code>$ go doc time.Nanosecond\nconst (\n    Nanosecond  Duration = 1\n    Microsecond          = 1000 * Nanosecond\n    Millisecond          = 1000 * Microsecond\n    Second               = 1000 * Millisecond\n    Minute               = 60 * Second\n    Hour                 = 60 * Minute\n)\n    Common durations. There is no definition for units of Day or larger to avoid\n    confusion across daylight savings time zone transitions.\n\n    To count the number of units in a Duration, divide:\n\n    second := time.Second\n    fmt.Print(int64(second/time.Millisecond)) // prints 1000\n\n    To convert an integer number of units to a Duration, multiply:\n\n    seconds := 10\n    fmt.Print(time.Duration(seconds)*time.Second) // prints 10s\n\n$ \n</code></pre>\n\n<hr>\n\n<p>Start with <code>go doc http | grep 'const '</code>:</p>\n\n<pre><code>$ go doc http | grep 'const '\nconst MethodGet = \"GET\" ...\nconst StatusContinue = 100 ...\nconst DefaultMaxHeaderBytes = 1 &lt;&lt; 20\nconst DefaultMaxIdleConnsPerHost = 2\nconst TimeFormat = \"Mon, 02 Jan 2006 15:04:05 GMT\"\nconst TrailerPrefix = \"Trailer:\"\n    const StateNew ConnState = iota ...\n$\n</code></pre>\n\n<p>Then <code>go doc http.StatusContinue</code>:</p>\n\n<pre><code>$ go doc http.StatusContinue\n\npackage http // import \"net/http\"\n\nconst (\n    StatusContinue           = 100 // RFC 7231, 6.2.1\n    StatusSwitchingProtocols = 101 // RFC 7231, 6.2.2\n    StatusProcessing         = 102 // RFC 2518, 10.1\n\n    StatusOK                   = 200 // RFC 7231, 6.3.1\n    StatusCreated              = 201 // RFC 7231, 6.3.2\n    StatusAccepted             = 202 // RFC 7231, 6.3.3\n    StatusNonAuthoritativeInfo = 203 // RFC 7231, 6.3.4\n    StatusNoContent            = 204 // RFC 7231, 6.3.5\n    StatusResetContent         = 205 // RFC 7231, 6.3.6\n    StatusPartialContent       = 206 // RFC 7233, 4.1\n    StatusMultiStatus          = 207 // RFC 4918, 11.1\n    StatusAlreadyReported      = 208 // RFC 5842, 7.1\n    StatusIMUsed               = 226 // RFC 3229, 10.4.1\n\n    StatusMultipleChoices  = 300 // RFC 7231, 6.4.1\n    StatusMovedPermanently = 301 // RFC 7231, 6.4.2\n    StatusFound            = 302 // RFC 7231, 6.4.3\n    StatusSeeOther         = 303 // RFC 7231, 6.4.4\n    StatusNotModified      = 304 // RFC 7232, 4.1\n    StatusUseProxy         = 305 // RFC 7231, 6.4.5\n\n    StatusTemporaryRedirect = 307 // RFC 7231, 6.4.7\n    StatusPermanentRedirect = 308 // RFC 7538, 3\n\n    StatusBadRequest                   = 400 // RFC 7231, 6.5.1\n    StatusUnauthorized                 = 401 // RFC 7235, 3.1\n    StatusPaymentRequired              = 402 // RFC 7231, 6.5.2\n    StatusForbidden                    = 403 // RFC 7231, 6.5.3\n    StatusNotFound                     = 404 // RFC 7231, 6.5.4\n    StatusMethodNotAllowed             = 405 // RFC 7231, 6.5.5\n    StatusNotAcceptable                = 406 // RFC 7231, 6.5.6\n    StatusProxyAuthRequired            = 407 // RFC 7235, 3.2\n    StatusRequestTimeout               = 408 // RFC 7231, 6.5.7\n    StatusConflict                     = 409 // RFC 7231, 6.5.8\n    StatusGone                         = 410 // RFC 7231, 6.5.9\n    StatusLengthRequired               = 411 // RFC 7231, 6.5.10\n    StatusPreconditionFailed           = 412 // RFC 7232, 4.2\n    StatusRequestEntityTooLarge        = 413 // RFC 7231, 6.5.11\n    StatusRequestURITooLong            = 414 // RFC 7231, 6.5.12\n    StatusUnsupportedMediaType         = 415 // RFC 7231, 6.5.13\n    StatusRequestedRangeNotSatisfiable = 416 // RFC 7233, 4.4\n    StatusExpectationFailed            = 417 // RFC 7231, 6.5.14\n    StatusTeapot                       = 418 // RFC 7168, 2.3.3\n    StatusMisdirectedRequest           = 421 // RFC 7540, 9.1.2\n    StatusUnprocessableEntity          = 422 // RFC 4918, 11.2\n    StatusLocked                       = 423 // RFC 4918, 11.3\n    StatusFailedDependency             = 424 // RFC 4918, 11.4\n    StatusUpgradeRequired              = 426 // RFC 7231, 6.5.15\n    StatusPreconditionRequired         = 428 // RFC 6585, 3\n    StatusTooManyRequests              = 429 // RFC 6585, 4\n    StatusRequestHeaderFieldsTooLarge  = 431 // RFC 6585, 5\n    StatusUnavailableForLegalReasons   = 451 // RFC 7725, 3\n\n    StatusInternalServerError           = 500 // RFC 7231, 6.6.1\n    StatusNotImplemented                = 501 // RFC 7231, 6.6.2\n    StatusBadGateway                    = 502 // RFC 7231, 6.6.3\n    StatusServiceUnavailable            = 503 // RFC 7231, 6.6.4\n    StatusGatewayTimeout                = 504 // RFC 7231, 6.6.5\n    StatusHTTPVersionNotSupported       = 505 // RFC 7231, 6.6.6\n    StatusVariantAlsoNegotiates         = 506 // RFC 2295, 8.1\n    StatusInsufficientStorage           = 507 // RFC 4918, 11.5\n    StatusLoopDetected                  = 508 // RFC 5842, 7.2\n    StatusNotExtended                   = 510 // RFC 2774, 7\n    StatusNetworkAuthenticationRequired = 511 // RFC 6585, 6\n)\n    HTTP status codes as registered with IANA. See:\n    https://www.iana.org/assignments/http-status-codes/http-status-codes.xhtml\n$ \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 48302, "user_id": 388916, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6f9d967832644f9faa431e4e50b69bb0?s=128&d=identicon&r=PG", "display_name": "Hubro", "link": "https://stackoverflow.com/users/388916/hubro"}, "edited": false, "score": 0, "creation_date": 1522399767, "post_id": 49565184, "comment_id": 86150118, "body": "Neat, all the info from godoc.org, but with a quick console command"}], "tags": [], "owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "is_accepted": false, "score": 1, "last_activity_date": 1522358301, "creation_date": 1522358301, "answer_id": 49565184, "question_id": 49545786, "link": "https://stackoverflow.com/questions/49545786/how-do-i-find-all-the-constants-in-a-package-using-go-doc/49565184#49565184", "title": "How do I find all the constants in a package using go doc?", "body": "<p>Sorry, took me some time to realize it. Actually, we're looking at a wrong command line tool. Use <code>godoc time</code> instead.</p>\n\n<p>If you don't have it, you can install it as follows:</p>\n\n<pre><code>$ go get golang.org/x/tools/cmd/godoc\n$ go build golang.org/x/tools/cmd/godoc\n</code></pre>\n\n<p>Then copy it to your path (or run from where it is).</p>\n"}], "owner": {"reputation": 48302, "user_id": 388916, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6f9d967832644f9faa431e4e50b69bb0?s=128&d=identicon&r=PG", "display_name": "Hubro", "link": "https://stackoverflow.com/users/388916/hubro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 384, "favorite_count": 2, "answer_count": 2, "score": 3, "last_activity_date": 1522358301, "creation_date": 1522279759, "question_id": 49545786, "link": "https://stackoverflow.com/questions/49545786/how-do-i-find-all-the-constants-in-a-package-using-go-doc", "title": "How do I find all the constants in a package using go doc?", "body": "<p>I've wasted way too much time the past couple of days searching for constants like <code>time.Second</code> and <code>http.StatusOK</code> because they aren't mentioned in <code>go doc time</code> or <code>go doc http</code> respectively.</p>\n\n<p>I specifically searched for a constant representing the duration 1 second by doing:</p>\n\n<pre><code>go doc time | grep Second\n</code></pre>\n\n<p>With no results, before reading through the entire doc page before concluding that the constant didn't exist. It was only after Googling around for about 15 minutes I happened to see <code>time.Second</code> mentioned somewhere, and when I looked it up directly (<code>go doc time.Second</code>) I found all the duration constants.</p>\n\n<p>How are people supposed to find out about these constants when they're not even mentioned in the official documentation of the package? Am I missing something obvious?</p>\n"}, {"tags": ["sql", "database", "postgresql", "go"], "answers": [{"comments": [{"owner": {"reputation": 1386, "user_id": 1661186, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/A1yBT.png?s=128&g=1", "display_name": "Darlan D.", "link": "https://stackoverflow.com/users/1661186/darlan-d"}, "edited": false, "score": 0, "creation_date": 1540325532, "post_id": 49550419, "comment_id": 92821776, "body": "I can execute various &#39;create table&#39; with Exec?"}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 9, "last_activity_date": 1522308868, "creation_date": 1522308868, "answer_id": 49550419, "question_id": 49545146, "link": "https://stackoverflow.com/questions/49545146/how-to-exec-sql-file-with-commands-in-golang/49550419#49550419", "title": "How to exec sql file with commands in golang", "body": "<p>You can read the file's contents into a string and pass that to <code>Exec</code>.</p>\n\n<pre><code>query, err := ioutil.ReadFile(\"path/to/database.sql\")\nif err != nil {\n    panic(err)\n}\nif _, err := db.Exec(query); err != nil {\n    panic(err)\n}\n</code></pre>\n\n<hr>\n\n<p>If your <code>database.sql</code> is formated in such a way, or it contains queries that break <code>db.Exec</code>, then you could use <code>os/exec</code> together with <code>psql</code> (if it's installed on the machine on which the code is being run).</p>\n\n<pre><code>cmd := exec.Command(\"psql\", \"-d\", \"database_name\", \"-f\", \"path/to/database.sql\")\nstderr, err := cmd.StderrPipe()\nif err != nil {\n    panic(err)\n}\n\nif err := cmd.Start(); err != nil {\n    panic(err)\n}\n\nerrout, _ := ioutil.ReadAll(stderr)\nif err := cmd.Wait(); err != nil {\n    fmt.Println(errout)\n    panic(err)\n}\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 7243585, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-avYzZ1rfMv4/AAAAAAAAAAI/AAAAAAAAD7Q/Al13vWy4rCo/photo.jpg?sz=128", "display_name": "Arthur Brave", "link": "https://stackoverflow.com/users/7243585/arthur-brave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3039, "favorite_count": 0, "accepted_answer_id": 49550419, "answer_count": 1, "score": 3, "last_activity_date": 1522308868, "creation_date": 1522275888, "question_id": 49545146, "link": "https://stackoverflow.com/questions/49545146/how-to-exec-sql-file-with-commands-in-golang", "title": "How to exec sql file with commands in golang", "body": "<p>everyone, I have some troubles with postgresql in golang.\nI have an sql file (database.sql), and before starting my server I want to exec some command, it look's like that </p>\n\n<pre><code>CREATE TABLE forums (\n  id BIGSERIAL primary key,\n  slug TEXT NOT NULL UNIQUE,\n  title TEXT,\n  author TEXT references users(login),\n  threads BIGINT DEFAULT 0,\n  posts BIGINT DEFAULT 0\n);\n</code></pre>\n\n<p>I know, that I should use db.Exec(request), but i have many requests (\"CREATE TABLE user\" and others...)</p>\n\n<p>I have no idea, how to do that</p>\n\n<p>Help, and thanks a lot!</p>\n"}, {"tags": ["http", "go", "http-live-streaming"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1522271092, "post_id": 49544114, "comment_id": 86096005, "body": "Modification time checking in HTTP only has resolution to the second."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1522271130, "post_id": 49544114, "comment_id": 86096032, "body": "Out of curiousity, if this is being written and served by the same process, why serve the file at all? Why not just write a handler to serve the current data directly from memory?"}, {"owner": {"reputation": 531, "user_id": 3918996, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5ced6373dbacd78f120f945256908c00?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/3918996/rob"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1522271810, "post_id": 49544114, "comment_id": 86096326, "body": "Ah, I wasn&#39;t aware of that. I could indeed serve the data from memory, just easier to use ServeFile() and be able to cat the file when I need to but you&#39;re quite right, I will modify my code to serve the file from memory. I guess I could probably even read it from disk first..."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1522271929, "post_id": 49544114, "comment_id": 86096384, "body": "You can still write it to disk when it&#39;s updated if you want a copy on disk, but the file seems like an unnecessarily roundabout way to serve that data."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1522275378, "post_id": 49544114, "comment_id": 86097764, "body": "To answer the original question, http.ServeFile does not send Cache-Control: max-age=0, which would prevent caching. In absence of Cache-Control, browsers apply heuristics based on Last-Modified to compute cache validity. Also, Sync helps against data loss after a power outage or system crash. It is not required to read up-to-date data. In fact, it hurts performance."}], "answers": [{"tags": [], "owner": {"reputation": 531, "user_id": 3918996, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5ced6373dbacd78f120f945256908c00?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/3918996/rob"}, "is_accepted": false, "score": 0, "last_activity_date": 1522286990, "creation_date": 1522286990, "answer_id": 49546659, "question_id": 49544114, "link": "https://stackoverflow.com/questions/49544114/golang-http-and-file-caching/49546659#49546659", "title": "Golang HTTP and file caching", "body": "<p>As state in the comments, it turns out that the modification time checking in HTTP has a minimum resolution of 1 second and so, where a file needs to be change and server more frequently than that, it's best to serve it oneself from RAM.  For instance, store it in a slice called <code>content</code> and serve that slice with something like:</p>\n\n<p><code>http.ServeContent(w, r, filepath.Base(r.URL.Path), time.Time{}, bytes.NewReader(content))</code></p>\n"}, {"tags": [], "owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "is_accepted": false, "score": 0, "last_activity_date": 1522312029, "creation_date": 1522312029, "answer_id": 49551297, "question_id": 49544114, "link": "https://stackoverflow.com/questions/49544114/golang-http-and-file-caching/49551297#49551297", "title": "Golang HTTP and file caching", "body": "<p>Modification time checking in HTTP only has resolution to the second. However, the alternative is to use entity-tags ('etags'), which can be updated as often as the server needs to change the content.</p>\n\n<p>Therefore your use-case would work better via etags instead of modification times. An etag contains an opaque string that either does or doesn't match.</p>\n\n<p>From <a href=\"https://tools.ietf.org/html/rfc7232#section-2.3\" rel=\"nofollow noreferrer\">https://tools.ietf.org/html/rfc7232#section-2.3</a>,</p>\n\n<blockquote>\n  <p>An entity-tag is an opaque validator for\n     differentiating between multiple representations of the same\n     resource, regardless of whether those multiple representations are\n     due to resource state changes over time, content negotiation\n     resulting in multiple representations being valid at the same time,\n     or both.</p>\n</blockquote>\n\n<p>Detection of change by the client is usually done using the if-none-match header (<a href=\"https://tools.ietf.org/html/rfc7232#section-3.2\" rel=\"nofollow noreferrer\">https://tools.ietf.org/html/rfc7232#section-3.2</a>)</p>\n\n<blockquote>\n  <p>If-None-Match is primarily used in conditional GET requests to enable\n     efficient updates of cached information with a minimum amount of\n     transaction overhead.</p>\n</blockquote>\n"}], "owner": {"reputation": 531, "user_id": 3918996, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5ced6373dbacd78f120f945256908c00?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/3918996/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1237, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1522312029, "creation_date": 1522270885, "question_id": 49544114, "link": "https://stackoverflow.com/questions/49544114/golang-http-and-file-caching", "title": "Golang HTTP and file caching", "body": "<p>I have an application, written in Go, which runs an HTTP server and uses  <code>http.ServeFile()</code> to serve a file which is being updated 3 times per second; this is an audio streaming index file for a HTTP Live Stream which I need to operate in near zero latency, hence the frequent updates.  I can see from the logging in my Go server application that this file really is being updated 3 times per second and I call <code>Sync()</code> on the file each time it is updated to make sure that it is written to disk.</p>\n\n<p>My problem is that, on the browser side (Chrome), while this file is being requested several times per second, it is only actually being served once a second; on all the other occasions the server is returning 304, indicating that the file is unchanged:</p>\n\n<p><a href=\"https://i.stack.imgur.com/mCndr.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mCndr.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>What might be causing this behaviour and how could I make the file be served on each request?</p>\n"}, {"tags": ["sql", "postgresql", "go", "syntax"], "comments": [{"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1522267379, "post_id": 49543176, "comment_id": 86093951, "body": "have you tried <code>username</code> instead of <code>&#39;username&#39;</code>? The <code>qp</code> package will escape the value by itself."}, {"owner": {"reputation": 6890, "user_id": 1761307, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QQQps.jpg?s=128&g=1", "display_name": "Eray Balkanli", "link": "https://stackoverflow.com/users/1761307/eray-balkanli"}, "edited": false, "score": 0, "creation_date": 1522267429, "post_id": 49543176, "comment_id": 86093980, "body": "What is happening if you use double quotes for username like: , err = db.Query(     <code>INSERT INTO user_account (username, password_hash) VALUES (?, &#39;passwordhash&#39;);</code>,     <code>&quot;username&quot;</code>)"}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1522267534, "post_id": 49543176, "comment_id": 86094052, "body": "On the website I see in the examples no <code>?</code> but <code>$1</code>, <code>$2</code>, etc. Maybe try that."}, {"owner": {"reputation": 57, "user_id": 8507446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71081484d736a8bb9d2d76e8e0648892?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Petroske", "link": "https://stackoverflow.com/users/8507446/joseph-petroske"}, "edited": false, "score": 0, "creation_date": 1522267746, "post_id": 49543176, "comment_id": 86094168, "body": "Thanks for the help. I fixed this by using the $1 syntax (thanks TehSphinx)."}, {"owner": {"reputation": 57, "user_id": 8507446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71081484d736a8bb9d2d76e8e0648892?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Petroske", "link": "https://stackoverflow.com/users/8507446/joseph-petroske"}, "edited": false, "score": 0, "creation_date": 1522267831, "post_id": 49543176, "comment_id": 86094223, "body": "Once this was fixed, I had a double quote issue as well. The string &quot;&#39;username&#39;&quot; was being added isntead of the string &quot;username&quot;."}, {"owner": {"reputation": 57, "user_id": 8507446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71081484d736a8bb9d2d76e8e0648892?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Petroske", "link": "https://stackoverflow.com/users/8507446/joseph-petroske"}, "edited": false, "score": 0, "creation_date": 1522267938, "post_id": 49543176, "comment_id": 86094296, "body": "Sorry, I should close this but I don&#39;t have enough rep to post an answer."}], "owner": {"reputation": 57, "user_id": 8507446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71081484d736a8bb9d2d76e8e0648892?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Petroske", "link": "https://stackoverflow.com/users/8507446/joseph-petroske"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "closed_date": 1522271018, "answer_count": 0, "score": 1, "last_activity_date": 1522267223, "creation_date": 1522267223, "question_id": 49543176, "link": "https://stackoverflow.com/questions/49543176/fixing-syntax-for-using-sql-insert-in-go", "closed_reason": "Duplicate", "title": "Fixing Syntax For using SQL insert in go", "body": "<p>I am getting an error when I try to use ? arguments when using the go sql library.</p>\n\n<p>Whe I do something like:</p>\n\n<pre><code>_, err = db.Query(\n    `INSERT INTO user_account (username, password_hash) VALUES (\"username\", 'passwordhash');`,\n</code></pre>\n\n<p>everything works fine.</p>\n\n<p>But when I do the following:</p>\n\n<pre><code>_, err = db.Query(\n    `INSERT INTO user_account (username, password_hash) VALUES (?, 'passwordhash');`,\n    `'username'`)\n</code></pre>\n\n<p>I get the error:</p>\n\n<pre><code>pq: syntax error at or near \",\"\n</code></pre>\n\n<p>How can I fix this error? I suspect it has something to do with the single quotes around the variables.</p>\n\n<p>If it matters, I'm using postgreq with the pq driver.</p>\n"}, {"tags": ["google-app-engine", "go", "app-engine-flexible", "gopath"], "answers": [{"tags": [], "owner": {"reputation": 2430, "user_id": 4092401, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/L2gLB.jpg?s=128&g=1", "display_name": "Ying Li", "link": "https://stackoverflow.com/users/4092401/ying-li"}, "is_accepted": false, "score": 0, "last_activity_date": 1522270978, "creation_date": 1522270978, "answer_id": 49544133, "question_id": 49542641, "link": "https://stackoverflow.com/questions/49542641/cannot-find-package-when-deploy-to-app-engine/49544133#49544133", "title": "Cannot find package when deploy to App Engine", "body": "<p>Judging from the error message, you should set one of the paths to the \"src\" folder.</p>\n\n<p>They should be able to find \"FBackend/router\" in \"/usr/local/go/src/\" since it's there.</p>\n\n<p>I can understand how it can't find \"FBackend/router\" in \"/usr/local/go/src/FBackend/router\" cause you probably don't have \"/usr/local/go/src/FBackend/router/FBackend/router\" setup.</p>\n"}], "owner": {"reputation": 146, "user_id": 7450505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac0676e332a5560416585e41b78cf62c?s=128&d=identicon&r=PG&f=1", "display_name": "Hasdfa", "link": "https://stackoverflow.com/users/7450505/hasdfa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 387, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1522270978, "creation_date": 1522265173, "question_id": 49542641, "link": "https://stackoverflow.com/questions/49542641/cannot-find-package-when-deploy-to-app-engine", "title": "Cannot find package when deploy to App Engine", "body": "<p>I can not deploy my golang application (with <a href=\"https://github.com/labstack/echo\" rel=\"nofollow noreferrer\">echo</a> framework) on App Engine.</p>\n\n<p>I have some kind of error like:</p>\n\n<pre><code>...\nStep #0: main.go:4:2: cannot find package \"FBackend/router\" in any of:\nStep #0: /usr/local/go/src/FBackend/router (from $GOROOT) \nStep #0: /workspace/_gopath/src/FBackend/router (from $GOPATH) \nFinished \nStep #0 ERROR \nERROR: build step 0 \"...\" failed: exit status 1\n</code></pre>\n\n<p>In project I have file three like this:</p>\n\n<pre><code>FBackend\n    ...\n    |___router\n    |   |____router.go\n    ...\n    |\n    |___main.go\n</code></pre>\n\n<p>On localhost all works fine</p>\n"}, {"tags": ["go", "sdl"], "comments": [{"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1522293446, "post_id": 49542093, "comment_id": 86102282, "body": "Add an event loop and redraw either unconditionally or when asked to by window manager (<code>SDL_WINDOWEVENT</code>). You can&#39;t just draw once and expect things to stay on screen, or even ever be visible (e.g. your draw happened before window manager was ready to show your window), especially with compositing window managers."}, {"owner": {"reputation": 29052, "user_id": 96233, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/85735330505ef1c84896fcb86491bd0b?s=128&d=identicon&r=PG", "display_name": "Ralph", "link": "https://stackoverflow.com/users/96233/ralph"}, "reply_to_user": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1522316581, "post_id": 49542093, "comment_id": 86112717, "body": "Thanks. I&#39;ll try that once i get to the lesson that shows me how. I&#39;m still only on lesson 4."}, {"owner": {"reputation": 29052, "user_id": 96233, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/85735330505ef1c84896fcb86491bd0b?s=128&d=identicon&r=PG", "display_name": "Ralph", "link": "https://stackoverflow.com/users/96233/ralph"}, "reply_to_user": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1522325349, "post_id": 49542093, "comment_id": 86118630, "body": "@keltar: That worked. If you change your comment into an answer, I&#39;ll accept it."}], "answers": [{"comments": [{"owner": {"reputation": 29052, "user_id": 96233, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/85735330505ef1c84896fcb86491bd0b?s=128&d=identicon&r=PG", "display_name": "Ralph", "link": "https://stackoverflow.com/users/96233/ralph"}, "edited": false, "score": 0, "creation_date": 1522332028, "post_id": 49558052, "comment_id": 86123788, "body": "I was worried that I would not be able to continue to use KDE for development. :-)"}, {"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "reply_to_user": {"reputation": 29052, "user_id": 96233, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/85735330505ef1c84896fcb86491bd0b?s=128&d=identicon&r=PG", "display_name": "Ralph", "link": "https://stackoverflow.com/users/96233/ralph"}, "edited": false, "score": 0, "creation_date": 1522340117, "post_id": 49558052, "comment_id": 86129403, "body": "@Ralph FWIW KDE&#39;s default window manager, kwin, can toggle compositing mode on the fly via hotkey combination - I think it is alt-shift-f12 by default. But then again, even without compositing, the method in question is not really valid; this question gets asked quite often."}], "tags": [], "owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "is_accepted": true, "score": 1, "last_activity_date": 1522331942, "creation_date": 1522331942, "answer_id": 49558052, "question_id": 49542093, "link": "https://stackoverflow.com/questions/49542093/go-sdl2-not-clearing-window-surface-after-first-run/49558052#49558052", "title": "go-sdl2 not clearing window surface after first run", "body": "<p>Add an event loop and redraw either unconditionally or when asked to by window manager (<code>SDL_WINDOWEVENT</code>). You can't just draw once and expect things to stay on screen, or even ever be visible (e.g. your draw happened before window manager was ready to show your window), especially with compositing window managers.</p>\n"}], "owner": {"reputation": 29052, "user_id": 96233, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/85735330505ef1c84896fcb86491bd0b?s=128&d=identicon&r=PG", "display_name": "Ralph", "link": "https://stackoverflow.com/users/96233/ralph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 49558052, "answer_count": 1, "score": 0, "last_activity_date": 1522331942, "creation_date": 1522263093, "last_edit_date": 1522268250, "question_id": 49542093, "link": "https://stackoverflow.com/questions/49542093/go-sdl2-not-clearing-window-surface-after-first-run", "title": "go-sdl2 not clearing window surface after first run", "body": "<p>I just started going through the SDL tutorial lessons at <a href=\"http://lazyfoo.net/tutorials/SDL/index.php\" rel=\"nofollow noreferrer\">http://lazyfoo.net/tutorials/SDL/index.php</a> and am working on the first lesson (Lesson 01). I am hand-translating the C/C++ code to Go using the <code>github.com/veandco/go-sdl2</code> library.</p>\n\n<p>This is my code:</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/veandco/go-sdl2/sdl\"\n)\n\nconst screenWidth, screenHeight = 800, 600\n\nfunc main() {\n    defer sdl.Quit()\n    if err := sdl.Init(sdl.INIT_VIDEO); err != nil {\n        panic(err)\n    }\n\n    window, err := sdl.CreateWindow(\"SDL Tutorial\",\n        int32(sdl.WINDOWPOS_UNDEFINED), int32(sdl.WINDOWPOS_UNDEFINED),\n        screenWidth, screenHeight, uint32(sdl.WINDOW_SHOWN))\n    if err != nil {\n        panic(err)\n    }\n    defer window.Destroy()\n\n    screenSurface, err := window.GetSurface()\n    if err != nil {\n        panic(err)\n    }\n\n    if err = screenSurface.FillRect(nil,\n        sdl.MapRGB(screenSurface.Format, 0xff, 0xff, 0xff)); err != nil {\n        panic(err)\n    }\n\n    if err = window.UpdateSurface(); err != nil {\n        panic(err)\n    }\n\n    sdl.Delay(2000)\n}\n</code></pre>\n\n<p>The first time it ran, it drew a blank (white background) window, but every time after that, it has drawn a transparent window, showing the desktop windows that are running behind it.</p>\n\n<p>I'm not sure what I am doing wrong.</p>\n\n<p>I am running Go 1.10 on the KDE window manager on Ubuntu 17.10, if it makes any difference.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>The problem is <strong>not</strong> occurring when I run XFCE instead of KDE.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1522265341, "post_id": 49540585, "comment_id": 86092827, "body": "Do not use buf past index r. string(buf) is garbage, string(buf[:r]) is not."}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1522257945, "post_id": 49540673, "comment_id": 86088602, "body": "Checking the returned error instead of discarding it would also avoid this issue."}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 1, "creation_date": 1522258372, "post_id": 49540673, "comment_id": 86088876, "body": "Your point is right, but depending on what stdin is connected to, it&#39;s actually possible that it <i>does</i> have more data after EOF. A terminal can send EOF but then have more input, and a file can be appended to, if you wait. Generally the thing you want to do is to read any given stream until EOF and then terminate, but not <i>absolutely</i> always :)"}, {"owner": {"reputation": 761, "user_id": 679310, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f3a5fd7af147a1e37d028b58a971db75?s=128&d=identicon&r=PG", "display_name": "richp10", "link": "https://stackoverflow.com/users/679310/richp10"}, "edited": false, "score": 0, "creation_date": 1522261003, "post_id": 49540673, "comment_id": 86090370, "body": "It is by design / needed that this is an infinite loop - because further &#39;signals&#39; will arrive via stdin later.  My problem is that his is soaking too many resources.   If I put a sleep in that &#39;if r==0 &#39; block, will it always pickup stdin data next time round the loop - ie. it will not &#39;lose&#39; data just because it is having a few ms rest?"}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 1, "creation_date": 1522263402, "post_id": 49540673, "comment_id": 86091790, "body": "No, no data loss. The data is being buffered until your next read from it."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "reply_to_user": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 0, "creation_date": 1522265311, "post_id": 49540673, "comment_id": 86092807, "body": "@hobbs, as far as I know io.EOF means the reader has closed gracefully; no future read will succeed. There is no byte that means EOF."}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1522268170, "post_id": 49540673, "comment_id": 86094404, "body": "@Peter EOF is a flag, not a byte, but it&#39;s a flag that can be cleared. As an example, run <code>perl -</code> at a Unix terminal, then enter <code>print while &lt;&gt;;</code>, Enter, ^D, Enter, <code>Hello</code>, Enter, ^D. It will print <code>Hello</code> to the screen. perl reads stdin to EOF to get its code, and then the code reads stdin to EOF <i>again</i>."}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1522268460, "post_id": 49540673, "comment_id": 86094564, "body": "@Peter another classic example would be <code>tail -f</code>."}], "tags": [], "owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "is_accepted": false, "score": 2, "last_activity_date": 1522257950, "last_edit_date": 1522257950, "creation_date": 1522257887, "answer_id": 49540673, "question_id": 49540585, "link": "https://stackoverflow.com/questions/49540585/excessive-cpu-usage-on-golang-stdin-loop/49540673#49540673", "title": "Excessive CPU usage on Golang stdin loop", "body": "<p>In this part of your code:</p>\n\n<pre><code> r, _ := bioIn.Read(buf)\n if r == 0 {\n      continue\n  }\n</code></pre>\n\n<p>You check for a return value of 0, which means EOF. i.e. the input stream has ended/terminated. Once <code>stdin</code> is terminated, it's not going to come back. So you have an endless loop here. it'll just spin around on this test having <code>bioIn.Read()</code> return 0 every time. </p>\n\n<p>You can't really do much more than quit/exit at that point, stdin doesn't have any more data for you, ever.</p>\n\n<p>Note that your code also discard the error returned from <code>bioIn.Read()</code> - don't do that, deal with errors - and you would have discovered the cause for yourself in this case.</p>\n"}, {"comments": [{"owner": {"reputation": 761, "user_id": 679310, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f3a5fd7af147a1e37d028b58a971db75?s=128&d=identicon&r=PG", "display_name": "richp10", "link": "https://stackoverflow.com/users/679310/richp10"}, "edited": false, "score": 0, "creation_date": 1522260713, "post_id": 49541065, "comment_id": 86090192, "body": "Thanks Zarenor - if I have a short sleep will it &#39;always&#39; get the stdin data when it next goes around the loop.. that is, I won&#39;t lose data if it is asleep when something comes in - will it??"}, {"owner": {"reputation": 1101, "user_id": 8715470, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dlyj0.jpg?s=128&g=1", "display_name": "Zarenor", "link": "https://stackoverflow.com/users/8715470/zarenor"}, "reply_to_user": {"reputation": 761, "user_id": 679310, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f3a5fd7af147a1e37d028b58a971db75?s=128&d=identicon&r=PG", "display_name": "richp10", "link": "https://stackoverflow.com/users/679310/richp10"}, "edited": false, "score": 0, "creation_date": 1522264849, "post_id": 49541065, "comment_id": 86092543, "body": "Unless you have something else consuming from stdin, I don&#39;t see how it would. It should be left in stdin until you consume it."}, {"owner": {"reputation": 761, "user_id": 679310, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f3a5fd7af147a1e37d028b58a971db75?s=128&d=identicon&r=PG", "display_name": "richp10", "link": "https://stackoverflow.com/users/679310/richp10"}, "edited": false, "score": 0, "creation_date": 1522307362, "post_id": 49541065, "comment_id": 86107101, "body": "I have added a sleep and this has completely solved the cpu load.. didn&#39;t need to be long - see edit."}], "tags": [], "owner": {"reputation": 1101, "user_id": 8715470, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dlyj0.jpg?s=128&g=1", "display_name": "Zarenor", "link": "https://stackoverflow.com/users/8715470/zarenor"}, "is_accepted": true, "score": 1, "last_activity_date": 1522259333, "creation_date": 1522259333, "answer_id": 49541065, "question_id": 49540585, "link": "https://stackoverflow.com/questions/49540585/excessive-cpu-usage-on-golang-stdin-loop/49541065#49541065", "title": "Excessive CPU usage on Golang stdin loop", "body": "<p>You have a tight infinite loop, which will always take as much CPU as the OS will allow. You are always checking to see if there's any input and (in your sample code) you never wait for new input - you just continuously poll stdin to see if there is any. You should probably use <code>time.Sleep()</code> to wait some time between each check.</p>\n"}], "owner": {"reputation": 761, "user_id": 679310, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f3a5fd7af147a1e37d028b58a971db75?s=128&d=identicon&r=PG", "display_name": "richp10", "link": "https://stackoverflow.com/users/679310/richp10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 501, "favorite_count": 1, "accepted_answer_id": 49541065, "answer_count": 2, "score": 1, "last_activity_date": 1522307484, "creation_date": 1522257531, "last_edit_date": 1522307484, "question_id": 49540585, "link": "https://stackoverflow.com/questions/49540585/excessive-cpu-usage-on-golang-stdin-loop", "title": "Excessive CPU usage on Golang stdin loop", "body": "<p>I have a golang app which needs to listen for input on stdin - not as a command line utility but to keep running and listening.  The following code, slightly edited down, works but has very high CPU load when 'idle' - and I am not sure why - nor clear how this could be done better.  So I need the same functionality without the CPU load! (this is part of an authentication handler for ejabberd)</p>\n\n<pre><code>bioIn := bufio.NewReader(os.Stdin)\nbioOut := bufio.NewWriter(os.Stdout)\n\nvar err error\nvar success bool\nvar length uint16\nvar result uint16\n\nfor {\n    binary.Read(bioIn, binary.BigEndian, &amp;length)\n\n    buf := make([]byte, length)\n\n    r, _ := bioIn.Read(buf)\n    if r == 0 {\n        continue\n    }\n\n    if err == nil {\n        data := strings.Split(string(buf), \":\")\n        // I have code to handle the incoming data here...\n    } else {\n        success = false\n    }\n\n    length = 2\n    binary.Write(bioOut, binary.BigEndian, &amp;length)\n\n    if success != true {\n        result = 0\n    } else {\n        result = 1\n    }\n\n    binary.Write(bioOut, binary.BigEndian, &amp;result)\n    bioOut.Flush()\n}\n</code></pre>\n\n<p><strong>ANSWER:</strong> </p>\n\n<p>I added a short sleep as suggested and this has worked a charm; didn't need to be long and no noticeable impact on the authentication the service is providing. With the reassurance incoming data is buffered this is perfect fix. Thanks all.</p>\n\n<pre><code>r, _ := bioIn.Read(buf)\n    if r == 0 {\n        time.Sleep(25 * time.Millisecond)\n        continue\n}\n</code></pre>\n"}, {"tags": ["pointers", "go", "interface"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1522256847, "post_id": 49540367, "comment_id": 86088001, "body": "You will have to use <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\">reflection</a>, same as all of the unmarshallers that use the same technique of passing an <code>interface{}</code> output parameter."}, {"owner": {"reputation": 10244, "user_id": 797194, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3728c41e604024f375043551a59b41df?s=128&d=identicon&r=PG", "display_name": "m90", "link": "https://stackoverflow.com/users/797194/m90"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1522257020, "post_id": 49540367, "comment_id": 86088102, "body": "Do you know a place in the stdlib where this is done and I could look it up? Or any other example?"}, {"owner": {"reputation": 1445, "user_id": 5972487, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/024fcbdd0ee00e2dccefce0ef67bc434?s=128&d=identicon&r=PG", "display_name": "elmiomar", "link": "https://stackoverflow.com/users/5972487/elmiomar"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1522258000, "post_id": 49540367, "comment_id": 86088639, "body": "As @Adrian mentioned, take a look at the unmarshallers, <a href=\"https://golang.org/src/encoding/json/decode.go\" rel=\"nofollow noreferrer\">example</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1518, "user_id": 3150057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32880beea401dfe8fdccd7bced822d5d?s=128&d=identicon&r=PG", "display_name": "Henry Blyth", "link": "https://stackoverflow.com/users/3150057/henry-blyth"}, "edited": false, "score": 0, "creation_date": 1562329219, "post_id": 49553245, "comment_id": 100350570, "body": "This answer helped me so much, thank you! For me, the value I was setting was also a pointer, so I had to do <code>va := reflect.ValueOf(a).Elem()</code>"}], "tags": [], "owner": {"reputation": 1477, "user_id": 8279560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af2d53514074e4972b6049a3b35729ec?s=128&d=identicon&r=PG", "display_name": "Pavlo Strokov", "link": "https://stackoverflow.com/users/8279560/pavlo-strokov"}, "is_accepted": true, "score": 9, "last_activity_date": 1522322443, "last_edit_date": 1522322443, "creation_date": 1522317830, "answer_id": 49553245, "question_id": 49540367, "link": "https://stackoverflow.com/questions/49540367/how-do-i-dereference-a-pointer-value-passed-as-the-empty-interface/49553245#49553245", "title": "How do i dereference a pointer value passed as the empty interface?", "body": "<p>You can use 'reflect' package to do it. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype mockClient struct {}\n\nfunc (m *mockClient) Query(query string, target interface{}) error {\n    a := \"changed\"\n    va := reflect.ValueOf(a)\n    reflect.ValueOf(target).Elem().Set(va)\n    return nil\n}\n\nfunc main() {\n    var mc mockClient\n    target := \"initial\"\n    mc.Query(\"qwe\", &amp;target)\n    fmt.Println(target)\n}\n</code></pre>\n\n<p>The simple example to reference you can find <a href=\"https://play.golang.org/p/S7XllJpxLw1\" rel=\"noreferrer\">here</a></p>\n"}], "owner": {"reputation": 10244, "user_id": 797194, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3728c41e604024f375043551a59b41df?s=128&d=identicon&r=PG", "display_name": "m90", "link": "https://stackoverflow.com/users/797194/m90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2962, "favorite_count": 2, "accepted_answer_id": 49553245, "answer_count": 1, "score": 4, "last_activity_date": 1522322443, "creation_date": 1522256737, "question_id": 49540367, "link": "https://stackoverflow.com/questions/49540367/how-do-i-dereference-a-pointer-value-passed-as-the-empty-interface", "title": "How do i dereference a pointer value passed as the empty interface?", "body": "<p>I've got a method taking a <code>target interface{}</code> on a type that I use for database access like:</p>\n\n<pre><code>func (c *client) Query(query someType, target interface{}) error {\n    return c.db.Query(query).Decode(target)\n}\n</code></pre>\n\n<p>This is then called like</p>\n\n<pre><code>result := resultType{}\nif err := c.Query(myQuery, &amp;result); err == nil {\n    // do sth with result\n}\n</code></pre>\n\n<p>Which does what I want it do as I am passing the pointer address of <code>result</code></p>\n\n<p>The trouble I am now running into is that I do not know how I can mock this kind of behavior (mutating the passed reference) in a test.</p>\n\n<p>In case I wouldn't need to pass <code>interface{}</code> I could imagine it being done like this:</p>\n\n<pre><code>type mockClient struct {\n    targetValue resultType\n}\n\nfunc (m *mockClient) Query(query someType, target *resultType) error {\n    *target = m.targetValue\n    return nil\n}\n</code></pre>\n\n<p>If I try to do the same using my actual signature, I am not able to dereference the value contained in <code>target</code> like this:</p>\n\n<pre><code>type mockClient struct {\n    targetValue interface{}\n}\n\nfunc (m *mockClient) Query(query someType, target interface{}) error {\n    target = m.targetValue // this does not mutate the passed target\n    return nil\n} \n</code></pre>\n\n<p>Can I dereference a pointer value when it is passed in as the empty interface? In case it is not possible, what would be another approach of testing the side effects my method has without having to resort to concrete types as arguments?</p>\n"}, {"tags": ["go", "time"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1522253310, "post_id": 49539236, "comment_id": 86085825, "body": "I don&#39;t think Go&#39;s <code>time</code> package has a concept of an unknown offset; it&#39;s of no particular use. If the offset is genuinely unknown, the time itself is somewhat useless, as any interpretation could be inaccurate by +/- 12 hours - enough that the even date is likely to be off by +/- 1 day."}, {"owner": {"reputation": 11161, "user_id": 1908967, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vPwiV.jpg?s=128&g=1", "display_name": "Grokify", "link": "https://stackoverflow.com/users/1908967/grokify"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1522258608, "post_id": 49539236, "comment_id": 86088990, "body": "When using <code>-00:00</code> the time is accurate because the RFC says &quot;the time in UTC is known&quot;. It&#39;s just that the offset is unknown, so for example, if we have a time <code>2018-01-01T12:00:00-00:00</code> we know the exact time, but not the offset, e.g. whether the time is <code>2018-01-01T11:00:00-01:00</code> or <code>2018-01-01T13:00:00+01:00</code>."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1522259048, "post_id": 49539236, "comment_id": 86089231, "body": "In which case, its locale is UTC. It is not the duty of a time to offer any information outside of identifying an instance in time. A time that says &quot;at noon UTC but I don&#39;t know in what locale it actually happened&quot; is referencing an &quot;it&quot; which is irrelevant to <code>time.Time</code>."}], "answers": [{"comments": [{"owner": {"reputation": 11161, "user_id": 1908967, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vPwiV.jpg?s=128&g=1", "display_name": "Grokify", "link": "https://stackoverflow.com/users/1908967/grokify"}, "edited": false, "score": 0, "creation_date": 1522258705, "post_id": 49540615, "comment_id": 86089035, "body": "Regarding &quot;they do not accept all the time formats permitted by the RFCs&quot;, the <code>-00:00</code> offset is accepted because it parses without an error. However, it seems the conversion may be lossy."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 11161, "user_id": 1908967, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vPwiV.jpg?s=128&g=1", "display_name": "Grokify", "link": "https://stackoverflow.com/users/1908967/grokify"}, "edited": false, "score": 0, "creation_date": 1522259392, "post_id": 49540615, "comment_id": 86089436, "body": "@Grokify: <code>time.Parse</code> does not accept a distinction between plus zero and minus zero offset formats."}, {"owner": {"reputation": 100, "user_id": 6253282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c486960e114cda03318c5feb580e791?s=128&d=identicon&r=PG", "display_name": "MingiuX", "link": "https://stackoverflow.com/users/6253282/mingiux"}, "reply_to_user": {"reputation": 11161, "user_id": 1908967, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vPwiV.jpg?s=128&g=1", "display_name": "Grokify", "link": "https://stackoverflow.com/users/1908967/grokify"}, "edited": false, "score": 1, "creation_date": 1522261933, "post_id": 49540615, "comment_id": 86090912, "body": "@Grokify: I suggest you to take a look at the actual <a href=\"https://golang.org/src/time/format.go\" rel=\"nofollow noreferrer\">code</a>. When parsing a negative offset, the only thing done is invert the positive offset calculated. So as stated here, an integer -0 is equal to +0 and simply inverting it, the information about it gets lost."}, {"owner": {"reputation": 11161, "user_id": 1908967, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vPwiV.jpg?s=128&g=1", "display_name": "Grokify", "link": "https://stackoverflow.com/users/1908967/grokify"}, "edited": false, "score": 0, "creation_date": 1522271175, "post_id": 49540615, "comment_id": 86096051, "body": "I agree. &quot;the information about it gets lost&quot; is why I said the conversion is lossy."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 4, "last_activity_date": 1522258072, "last_edit_date": 1522258072, "creation_date": 1522257664, "answer_id": 49540615, "question_id": 49539236, "link": "https://stackoverflow.com/questions/49539236/how-to-represent-the-rfc-3339-0000-offset-in-go/49540615#49540615", "title": "How to represent the RFC-3339 `-00:00` offset in Go?", "body": "<blockquote>\n  <p><a href=\"https://golang.org/pkg/time/\" rel=\"nofollow noreferrer\">Package time</a></p>\n\n<pre><code>import \"time\"\n</code></pre>\n  \n  <p>RFC3339, RFC822, RFC822Z, RFC1123, and RFC1123Z are useful for\n  formatting; when used with time.Parse they do not accept all the time\n  formats permitted by the RFCs.</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p>Go does not accept all the time formats permitted by the RFCs.</p>\n</blockquote>\n\n<p>The Go <code>time.Time</code> type uses integers which, unlike floating-point, have no concept of plus and minus zero. The results for parsing offsets of <code>-00:00</code> and <code>+00:00</code> are identical.</p>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    var err error\n    var minus, plus time.Time\n    t := \"2018-01-01T00:00:00-00:00\"\n    minus, err = time.Parse(time.RFC3339, t)\n    if err != nil {\n        fmt.Println(err)\n    }\n    t = \"2018-01-01T00:00:00+00:00\"\n    plus, err = time.Parse(time.RFC3339, t)\n    if err != nil {\n        fmt.Println(err)\n    }\n    fmt.Println(minus, plus, minus.Equal(plus), minus == plus)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/Urf8VlKYoMH\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Urf8VlKYoMH</a></p>\n\n<p>Output:</p>\n\n<pre><code>2018-01-01 00:00:00 +0000 UTC 2018-01-01 00:00:00 +0000 UTC true true\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": false, "score": 2, "last_activity_date": 1522262617, "creation_date": 1522262617, "answer_id": 49541947, "question_id": 49539236, "link": "https://stackoverflow.com/questions/49539236/how-to-represent-the-rfc-3339-0000-offset-in-go/49541947#49541947", "title": "How to represent the RFC-3339 `-00:00` offset in Go?", "body": "<p>PeterSO's answer is perfect IMHO. If you need to act differently based on the information that the offset is unknown, then this might help you.</p>\n\n<p>You can build your own time data type:</p>\n\n<pre><code>type MyTime struct {\n    // based on time.Time so we can do all normal time.Time stuff\n    time.Time\n\n    offsetUnknown bool\n}\n\nfunc ParseRFC3339(s string) (MyTime, error) {\n    time, err := time.Parse(time.RFC3339, s)\n    if err != nil {\n        return MyTime{}, err\n    }\n\n    return MyTime{\n        Time: time,\n        // maybe this condition needs improvement in case of false positives\n        offsetUnknown: strings.Contains(s, \"-00:00\"),\n    }, nil\n}\n</code></pre>\n\n<p>Any functions you need to behave differently based on <code>offsetUnknown</code> you can then override on the <code>MyTime</code> struct. Here one example:</p>\n\n<pre><code>func (s MyTime) Format(layout string) string {\n    out := s.Time.Format(layout)\n    // again this is probably not the best solution\n    if layout == time.RFC3339 &amp;&amp; s.offsetUnknown {\n        out = strings.Replace(out, \"+00:00\", \"-00:00\", -1)\n    }\n    return out\n}\n</code></pre>\n"}], "owner": {"reputation": 11161, "user_id": 1908967, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vPwiV.jpg?s=128&g=1", "display_name": "Grokify", "link": "https://stackoverflow.com/users/1908967/grokify"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1589, "favorite_count": 2, "answer_count": 2, "score": 3, "last_activity_date": 1522262617, "creation_date": 1522252913, "question_id": 49539236, "link": "https://stackoverflow.com/questions/49539236/how-to-represent-the-rfc-3339-0000-offset-in-go", "title": "How to represent the RFC-3339 `-00:00` offset in Go?", "body": "<p>RFC-3339 Section 4.3 (<a href=\"https://tools.ietf.org/html/rfc3339#section-4.3\" rel=\"nofollow noreferrer\">https://tools.ietf.org/html/rfc3339#section-4.3</a>) defines the <code>-00:00</code> offset as the following, which is different than <code>Z</code> or <code>+00:00</code>.</p>\n\n<pre><code>4.3. Unknown Local Offset Convention\n\n   If the time in UTC is known, but the offset to local time is unknown,\n   this can be represented with an offset of \"-00:00\".  This differs\n   semantically from an offset of \"Z\" or \"+00:00\", which imply that UTC\n   is the preferred reference point for the specified time.  RFC2822\n   [IMAIL-UPDATE] describes a similar convention for email.\n</code></pre>\n\n<p>However, I'm not sure how to represent this in Go. When I parse a time with <code>-00:00</code> and format it, I get a <code>Z</code> offset. For example:</p>\n\n<ul>\n<li>Input: <code>2018-01-01T00:00:00-00:00</code></li>\n<li>Output: <code>2018-01-01T00:00:00Z</code></li>\n</ul>\n\n<p>Here's some example code (<a href=\"https://play.golang.org/p/CVmNnhaSiiT\" rel=\"nofollow noreferrer\">https://play.golang.org/p/CVmNnhaSiiT</a>):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    t := \"2018-01-01T00:00:00-00:00\"\n    fmt.Println(\"Input  \" + t)\n    p, err := time.Parse(time.RFC3339, t)\n    if err != nil {\n        fmt.Println(err)\n    } else {\n        t2 := p.Format(time.RFC3339)\n\n        fmt.Println(\"Output \" + t2)\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1522247865, "post_id": 49537161, "comment_id": 86081607, "body": "Your project should not be in the top level of <code>GOPATH&#47;src</code>. Did you <i>add</i> <code>GOROOT&#47;bin</code> to your PATH, or did you replace everything else in your path? You probably want <code>GOPATH&#47;bin</code> in your <code>PATH</code> too. What is <code>go_there.bat</code>?"}, {"owner": {"reputation": 15339, "user_id": 1949099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EfWob.jpg?s=128&g=1", "display_name": "Kris Hollenbeck", "link": "https://stackoverflow.com/users/1949099/kris-hollenbeck"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1522248213, "post_id": 49537161, "comment_id": 86081896, "body": "I am not sure what <code>go_there.bat</code> is. I think go creates that on the fly. When I search for it in temp it is not there. I did not add GOROOT/bin to my path. But the installer added it like this <code>C:\\Go\\bin</code>. Should it be like this? <code>%GOROOT%\\bin</code> ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1522248535, "post_id": 49537161, "comment_id": 86082137, "body": "No, since <code>GOROOT</code> doesn&#39;t need to be set <code>C:\\Go\\bin</code> is fine, I was asking if that&#39;s the <i>only</i> thing in your path. Run <code>go build -x</code> to see what exactly is being executed and failing (and move your project into a subdir of <code>src</code>)"}, {"owner": {"reputation": 15339, "user_id": 1949099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EfWob.jpg?s=128&g=1", "display_name": "Kris Hollenbeck", "link": "https://stackoverflow.com/users/1949099/kris-hollenbeck"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1522250258, "post_id": 49537161, "comment_id": 86083572, "body": "I removed GOROOT now. I only have <code>PATH=C:\\Go\\bin</code> and <code>GOPATH=E:\\goProjects\\goWebApp</code> I followed these instructions. <a href=\"https://github.com/golang/go/wiki/SettingGOPATH\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/SettingGOPATH</a> If I run the <code>go</code> command from command prompt <code>C:\\windows\\system32&gt;go</code> I get that same error."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1522250504, "post_id": 49537161, "comment_id": 86083755, "body": "Why are you running go from <code>C:\\windows\\system32&gt;</code>? At least start in your project directory, then provide the full command you&#39;re running, and output you&#39;re getting."}, {"owner": {"reputation": 15339, "user_id": 1949099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EfWob.jpg?s=128&g=1", "display_name": "Kris Hollenbeck", "link": "https://stackoverflow.com/users/1949099/kris-hollenbeck"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1522250653, "post_id": 49537161, "comment_id": 86083860, "body": "I assumed it was similar to a Java install or Node. Where it would be globally available after installing. Am I fundamentally misunderstanding something? Should I not be able to run <code>go version</code> from anywhere?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1522250962, "post_id": 49537161, "comment_id": 86084088, "body": "yes, you should be able to run <code>go version</code> from anywhere, but that has nothing to do with the <code>go build</code> error. Have you restarted your cmd shell to make sure you have the new PATH configured?"}, {"owner": {"reputation": 15339, "user_id": 1949099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EfWob.jpg?s=128&g=1", "display_name": "Kris Hollenbeck", "link": "https://stackoverflow.com/users/1949099/kris-hollenbeck"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1522251232, "post_id": 49537161, "comment_id": 86084255, "body": "Yes I have restarted it several times. I attached a screenshot (just now). This isn&#39;t a build error. I get the same error when running <code>go version</code> It is a configuration issue. This is the first time I have ever attempted to use go. I am just trying to setup a working environment at the moment."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1522251861, "post_id": 49537161, "comment_id": 86084729, "body": "Sorry, I don&#39;t know windows very well, but this doesn&#39;t look like anything to do with the Go toolchain itself, and there&#39;s something else in your path being executed by that command."}, {"owner": {"reputation": 15339, "user_id": 1949099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EfWob.jpg?s=128&g=1", "display_name": "Kris Hollenbeck", "link": "https://stackoverflow.com/users/1949099/kris-hollenbeck"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1522252946, "post_id": 49537161, "comment_id": 86085537, "body": "@JimB, I figured out what was going on. Thanks for your help though. I appreciate it."}], "answers": [{"tags": [], "owner": {"reputation": 15339, "user_id": 1949099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EfWob.jpg?s=128&g=1", "display_name": "Kris Hollenbeck", "link": "https://stackoverflow.com/users/1949099/kris-hollenbeck"}, "is_accepted": true, "score": 0, "last_activity_date": 1522253150, "last_edit_date": 1522253150, "creation_date": 1522252654, "answer_id": 49539145, "question_id": 49537161, "link": "https://stackoverflow.com/questions/49537161/windows-10-golang-setup-error-not-in-an-environment/49539145#49539145", "title": "Windows 10 golang setup. Error, Not in an environment", "body": "<p>Turns out I had two <em>go</em> locations in my <em>PATH</em> (<em>sort of</em>). When I ran the command <code>where go</code> from command prompt two paths were returned.</p>\n\n<p>Something like this..</p>\n\n<pre><code>C:\\tools\\devTools\\bin\nC:\\Go\\bin\\go.exe\n</code></pre>\n\n<p>There apparently was a bat file in <code>devTools\\bin</code> called <strong><em>go.bat</em></strong>. This was unrelated to golang itself, just coincidental naming unfortunately.This was executing instead of the go binary, which in return was throwing the random error with the <code>Not in an environment</code> message.</p>\n\n<p><em>To fix the issue I just removed the devTools path from my PATH variable for now.</em></p>\n"}], "owner": {"reputation": 15339, "user_id": 1949099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EfWob.jpg?s=128&g=1", "display_name": "Kris Hollenbeck", "link": "https://stackoverflow.com/users/1949099/kris-hollenbeck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 933, "favorite_count": 0, "accepted_answer_id": 49539145, "answer_count": 1, "score": 0, "last_activity_date": 1522287880, "creation_date": 1522247171, "last_edit_date": 1522287880, "question_id": 49537161, "link": "https://stackoverflow.com/questions/49537161/windows-10-golang-setup-error-not-in-an-environment", "title": "Windows 10 golang setup. Error, Not in an environment", "body": "<p>I am running into issues setting up go for the first time on a Windows 10 machine.</p>\n\n<p>I followed the instructions from the install. <a href=\"https://golang.org/doc/install?download=go1.10.windows-386.msi\" rel=\"nofollow noreferrer\">https://golang.org/doc/install?download=go1.10.windows-386.msi</a></p>\n\n<p>When I CD to my project <code>E:\\goProjects\\goWebApp\\src</code> and run <code>go build</code>, I receive the following error.</p>\n\n<pre><code>C:\\windows\\system32&gt;go version\nNot in an environment\nC:\\Users\\MyUser~1\\AppData\\Local\\Temp\\go_there.bat' is not recognized as an internal or external command,\n    operable program or batch file.\n</code></pre>\n\n<p>My system variables are as follows:</p>\n\n<ul>\n<li><code>GOPATH=E:\\goProjects\\goWebApp</code></li>\n<li><code>GOROOT=C:\\Go</code></li>\n<li><code>PATH=C:\\Go\\bin</code></li>\n</ul>\n\n<p>If I run go version from <code>C:\\Go\\bin</code> everything works fine. Running go command from anywhere outside of this directory does not work. I have also tried restarting my cmd prompt and restarting my computer. Still no luck. Has anyone else ran into this issue? Or know what I might have done wrong?</p>\n\n<p><a href=\"https://i.stack.imgur.com/HM0re.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HM0re.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1522244152, "post_id": 49535869, "comment_id": 86078504, "body": "&quot;compiler says no&quot; is not a suitable problem description. Please show complete, compile and runnable example code and actual compiler error."}, {"owner": {"reputation": 2258, "user_id": 466750, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/1tgEA.jpg?s=128&g=1", "display_name": "Madu Alikor", "link": "https://stackoverflow.com/users/466750/madu-alikor"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1522244314, "post_id": 49535869, "comment_id": 86078621, "body": "lack of a sense of humor? I get a compile time error"}, {"owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "edited": false, "score": 0, "creation_date": 1522245188, "post_id": 49535869, "comment_id": 86079372, "body": "A variable declared has to be used. If you are not using it, replace it with  _ ."}, {"owner": {"reputation": 2258, "user_id": 466750, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/1tgEA.jpg?s=128&g=1", "display_name": "Madu Alikor", "link": "https://stackoverflow.com/users/466750/madu-alikor"}, "edited": false, "score": 0, "creation_date": 1522245241, "post_id": 49535869, "comment_id": 86079420, "body": "it would be used on the next iteration of the loop"}, {"owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "edited": false, "score": 2, "creation_date": 1522245300, "post_id": 49535869, "comment_id": 86079481, "body": "No it isn&#39;t used , learn Go variable scoping rules. A variable declared in for loop statement is scoped to that statement . := is variable declaration and affectation. Here you have 2 different out variables."}, {"owner": {"reputation": 2258, "user_id": 466750, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/1tgEA.jpg?s=128&g=1", "display_name": "Madu Alikor", "link": "https://stackoverflow.com/users/466750/madu-alikor"}, "edited": false, "score": 0, "creation_date": 1522245378, "post_id": 49535869, "comment_id": 86079559, "body": "ok i understand syntax is really important but look at what I&#39;m attempting to achieve is it possible how could i achieve this?"}, {"owner": {"reputation": 2258, "user_id": 466750, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/1tgEA.jpg?s=128&g=1", "display_name": "Madu Alikor", "link": "https://stackoverflow.com/users/466750/madu-alikor"}, "edited": false, "score": 0, "creation_date": 1522245514, "post_id": 49535869, "comment_id": 86079680, "body": "I&#39;m trying to chain a few goroutines together using input and output channels so the first input channel is used by the first PiplineStep which outputs a channel which will be used for the next PiplineStep step as input"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1522246414, "post_id": 49535869, "comment_id": 86080383, "body": "<i>What</i> compiler error do you get? This is the missing piece to your question."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1522246627, "post_id": 49535869, "comment_id": 86080558, "body": "You need a more complete example. You haven&#39;t shown where you&#39;re making a single channel here, and you&#39;re saying that &quot;all steps are receiving the same chan&quot; -- are are you making more than one channel? What is the point of the separate error values and error channel, if the error values just get put into the error channel? Maybe this blog post will provide some inspiration: <a href=\"https://blog.golang.org/pipelines\" rel=\"nofollow noreferrer\">blog.golang.org/pipelines</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2258, "user_id": 466750, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/1tgEA.jpg?s=128&g=1", "display_name": "Madu Alikor", "link": "https://stackoverflow.com/users/466750/madu-alikor"}, "edited": false, "score": 0, "creation_date": 1522248207, "post_id": 49537463, "comment_id": 86081891, "body": "Is it possible to implement this using Directional channels? so that i can enforce that the Step that created the channel is the only one able to close the channel"}, {"owner": {"reputation": 2258, "user_id": 466750, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/1tgEA.jpg?s=128&g=1", "display_name": "Madu Alikor", "link": "https://stackoverflow.com/users/466750/madu-alikor"}, "edited": false, "score": 0, "creation_date": 1522250519, "post_id": 49537463, "comment_id": 86083766, "body": "Or push into the channel"}], "tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 1, "last_activity_date": 1522247951, "creation_date": 1522247951, "answer_id": 49537463, "question_id": 49535869, "link": "https://stackoverflow.com/questions/49535869/daisy-chain-input-output-channels-together-in-golang/49537463#49537463", "title": "Daisy chain input,output channels together in golang", "body": "<p>You have to declare your channel variable outside the loop if you want to re-use it in each iteration (errors and context omitted for brevity):</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var pipeline Pipeline\n\n    pipeline.Steps = append(pipeline.Steps,\n            AddBang{},\n            AddBang{},\n            AddBang{},\n    )\n\n    src := make(chan Message)\n    pipe := src\n\n    for _, s := range pipeline.Steps {\n            pipe = s.Do(pipe)\n    }\n\n    go func() {\n            src &lt;- \"msg 1\"\n            src &lt;- \"msg 2\"\n            src &lt;- \"msg 3\"\n    }()\n\n    fmt.Println(&lt;-pipe)\n    fmt.Println(&lt;-pipe)\n    fmt.Println(&lt;-pipe)\n}\n\ntype Message string\n\ntype Pipeline struct {\n    Steps []PipelineStep\n}\n\ntype PipelineStep interface {\n    Do(in chan Message) chan Message\n}\n\ntype AddBang struct{}\n\nfunc (AddBang) Do(in chan Message) chan Message {\n    out := make(chan Message)\n    go func() {\n            defer close(out)\n            for m := range in {\n                    out &lt;- m + \"!\"\n            }\n    }()\n    return out\n}\n</code></pre>\n\n<p>Try it on the playground: <a href=\"https://play.golang.org/p/ItVLUBRpNA1\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ItVLUBRpNA1</a></p>\n"}], "owner": {"reputation": 2258, "user_id": 466750, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/1tgEA.jpg?s=128&g=1", "display_name": "Madu Alikor", "link": "https://stackoverflow.com/users/466750/madu-alikor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 513, "favorite_count": 2, "accepted_answer_id": 49537463, "answer_count": 1, "score": -5, "last_activity_date": 1522247951, "creation_date": 1522243652, "last_edit_date": 1522245107, "question_id": 49535869, "link": "https://stackoverflow.com/questions/49535869/daisy-chain-input-output-channels-together-in-golang", "title": "Daisy chain input,output channels together in golang", "body": "<p>I have the following interface and struct</p>\n\n<pre><code>type PiplineStep interface {\n    Do(ctx context.Context, in &lt;-chan Message) (&lt;-chan Message, &lt;-chan error, error)\n}\n\ntype Pipline struct {\n    Steps []core.PiplineStep\n}\n</code></pre>\n\n<p>Now I am trying to daisy the interfaces to create a pipeline like the following</p>\n\n<pre><code>    for _, step := range p.Steps {\n        out, errc, err := step.Do(ctx, out)\n        errcList = append(errcList, errc)\n\n        if err != nil {\n            errc &lt;- err\n            return\n        }\n\n        select {\n        case outer &lt;- msg:\n        case &lt;-ctx.Done():\n            return\n        }\n    }\n</code></pre>\n\n<p>But the compiler says no is this possible?</p>\n\n<p>I get the following Error 'out declared and not used' i have attempted following but it appears that all steps are receiving the same chan</p>\n\n<pre><code>    for _, step := range p.Steps {\n        var tmpOut &lt;-chan core.Message\n        tmpOut = out\n        tmpOut, errcTmp, err := step.Do(ctx, tmpOut)\n        errcList = append(errcList, errcTmp)\n\n        if err != nil {\n            errc &lt;- err\n            return\n        }\n        select {\n        case out &lt;- msg:\n        case &lt;-ctx.Done():\n            return\n        }\n    }\n</code></pre>\n"}, {"tags": ["mysql", "database", "postgresql", "go", "relational-database"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1522236797, "post_id": 49533285, "comment_id": 86072966, "body": "Please use <code>gofmt</code>.  Your code is nearly unreadable at the moment."}, {"owner": {"reputation": 59, "user_id": 9503747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/117e7dfc4c78542591bf46f210152b47?s=128&d=identicon&r=PG&f=1", "display_name": "Medone", "link": "https://stackoverflow.com/users/9503747/medone"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1522237258, "post_id": 49533285, "comment_id": 86073272, "body": "@ Flimzy thank you , i edited the code"}, {"owner": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 0, "creation_date": 1522245680, "post_id": 49533285, "comment_id": 86079809, "body": "this popped out on the first duckduckgo <a href=\"https://coussej.github.io/2015/09/15/Listening-to-generic-JSON-notifications-from-PostgreSQL-in-Go/\" rel=\"nofollow noreferrer\">coussej.github.io/2015/09/15/&hellip;</a>. This should point you in the right direction."}], "owner": {"reputation": 59, "user_id": 9503747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/117e7dfc4c78542591bf46f210152b47?s=128&d=identicon&r=PG&f=1", "display_name": "Medone", "link": "https://stackoverflow.com/users/9503747/medone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 222, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1522239295, "creation_date": 1522236419, "last_edit_date": 1522239295, "question_id": 49533285, "link": "https://stackoverflow.com/questions/49533285/automatic-update-while-data-changed-postgresql", "title": "Automatic update while data changed PostgreSQL", "body": "<p>I have the remote database which is in PostgreSQL and I have inserted all the tables with their data in my local database, but I can't figure out how to detect any changes from the remote database to be updated in my local database.</p>\n\n<p>the table from the remote database postgres is users \nthe table from the local database mysql  is users</p>\n\n<pre><code>func Searching() {\n    postgresqlusers, _ := GetUsersPostgres()\n    mysqlusers, _ := GetUsersMysql()\n    for _, valuepostgres := range postgresqlusers {\n        if len(mysqlusers) == 0 {\n            _, err := db.Exec(\"insert into user values(?,?,?)\", valuepostgres.User_Id, valuepostgres.Uid, valuepostgres.Phone)\n            if err != nil {\n                fmt.Println(len(mysqlusers))\n            }\n        }\n        for _, valuemysql := range mysqlusers {\n            if valuepostgres.User_Id != valuemysql.User_Id {\n                _, err := db.Exec(\"insert into user values(?,?,?)\", valuepostgres.User_Id, valuepostgres.Uid, valuepostgres.Phone)\n                if err != nil {\n                    fmt.Println(\"data inserted successufly\")\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>so both have the same structure, I made a script for the insertion with Go but I am stuck at updating changes automatically</p>\n"}, {"tags": ["go", "yaml", "unmarshalling", "custom-type"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1522228325, "post_id": 49530395, "comment_id": 86066733, "body": "<code>make</code> EpnSeq before writing to it? E.g. <code>*e = make(EpnSeq, len(yamlEpnSequence))</code>. Needs a pointer receiver anyway."}, {"owner": {"reputation": 926, "user_id": 5341805, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/5ZPCu.png?s=128&g=1", "display_name": "skaldesh", "link": "https://stackoverflow.com/users/5341805/skaldesh"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1522228533, "post_id": 49530395, "comment_id": 86066897, "body": "wow, I was just being silly. I tried this, but I failed to dereference the pointer first, before assigning with make(). That way, the pointer was only changed locally... my bad, sorry"}, {"owner": {"reputation": 926, "user_id": 5341805, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/5ZPCu.png?s=128&g=1", "display_name": "skaldesh", "link": "https://stackoverflow.com/users/5341805/skaldesh"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1522228580, "post_id": 49530395, "comment_id": 86066935, "body": "@Volker: Write an answer and get yourself some internet points, woohoo ;)"}], "answers": [{"tags": [], "owner": {"reputation": 926, "user_id": 5341805, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/5ZPCu.png?s=128&g=1", "display_name": "skaldesh", "link": "https://stackoverflow.com/users/5341805/skaldesh"}, "is_accepted": true, "score": 9, "last_activity_date": 1525686243, "creation_date": 1525686243, "answer_id": 50211222, "question_id": 49530395, "link": "https://stackoverflow.com/questions/49530395/custom-unmarshalyaml-how-to-implement-unmarshaler-interface-on-custom-type/50211222#50211222", "title": "Custom UnmarshalYAML, how to implement Unmarshaler interface on custom type", "body": "<p>Since @Volker did not post his comment as answer, I will do for the sake of completeness.<br>\nSo I was already on the right path, but simply failed to dereference the pointer receiver of my struct, when initializing it:  </p>\n\n<pre><code>// Implements the Unmarshaler interface of the yaml pkg.\nfunc (e *EpnSeq) UnmarshalYAML(unmarshal func(interface{}) error) error {\n    yamlEpnSequence := make([]uint16, 0)\n    err := unmarshal(&amp;yamlEpnSequence)\n    if err != nil {\n        return err\n    }\n\n    // make sure to dereference before assignment, \n    // otherwise only the local variable will be overwritten\n    // and not the value the pointer actually points to\n    *e = make(EpnSeq, len(yamlEpnSequence))\n    for priority, epn := range yamlEpnSequence {\n        e[epn] = uint16(priority) // no crash anymore\n    }\n\n    return nil\n}\n</code></pre>\n"}], "owner": {"reputation": 926, "user_id": 5341805, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/5ZPCu.png?s=128&g=1", "display_name": "skaldesh", "link": "https://stackoverflow.com/users/5341805/skaldesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7038, "favorite_count": 1, "accepted_answer_id": 50211222, "answer_count": 1, "score": 11, "last_activity_date": 1525686243, "creation_date": 1522228092, "question_id": 49530395, "link": "https://stackoverflow.com/questions/49530395/custom-unmarshalyaml-how-to-implement-unmarshaler-interface-on-custom-type", "title": "Custom UnmarshalYAML, how to implement Unmarshaler interface on custom type", "body": "<p>I parse a .yaml file and need to unmarshal one of its properties in a custom manner.  I am using the <code>\"gopkg.in/yaml.v2\"</code> package.  </p>\n\n<p>The property in question is stored like this in my .yaml file:</p>\n\n<pre><code>endPointNumberSequences:\n  AD1: [ 0, 10, 14, 1, 11, 2, 100, 101, 12 ]\n</code></pre>\n\n<p>So it is basically a <code>map[string][]uint16</code> kind of type.<br>\nBut I need <code>map[string]EpnSeq</code> where <code>EpnSeq</code> is defined as:<br>\n<code>type EpnSeq map[uint16]uint16</code></p>\n\n<p>My struct:</p>\n\n<pre><code>type CitConfig struct {\n    // lots of other properties\n    // ...\n\n    EndPointNumberSequences  map[string]EpnSeq `yaml:\"endPointNumberSequences\"`\n}\n</code></pre>\n\n<p>I tried to implement the Unmarshaler interface on it like this:</p>\n\n<pre><code>// Implements the Unmarshaler interface of the yaml pkg.\nfunc (e EpnSeq) UnmarshalYAML(unmarshal func(interface{}) error) error {\n    yamlEpnSequence := make([]uint16, 0)\n    err := unmarshal(&amp;yamlEpnSequence)\n    if err != nil {\n        return err\n    }\n\n    for priority, epn := range yamlEpnSequence {\n        e[epn] = uint16(priority) // crashes with nil pointer\n    }\n\n    return nil\n}\n</code></pre>\n\n<p>My problem is that inside the <code>UnmarshalYAML</code> function the <code>EpnSeq</code> type is not defined, causing a nil pointer exception at runtime.<br>\nHow do I correctly implement the Unmarshaler interface here?</p>\n"}, {"tags": ["dictionary", "go", "concurrency"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1522222152, "post_id": 49528232, "comment_id": 86062616, "body": "&quot;I mean why do we need a map when we have a value already? Pretty sure I miss something.&quot; makes no sense to me. Could you elaborate? You store (key,value)-pairs in a map. The map and the values stored are different concepts and both are unrelated to &quot;concurrent&quot;."}, {"owner": {"reputation": 3202, "user_id": 2247309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9249f58b72f4d2002b24f114a323a608?s=128&d=identicon&r=PG", "display_name": "hussachai", "link": "https://stackoverflow.com/users/2247309/hussachai"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1522223499, "post_id": 49528232, "comment_id": 86063479, "body": "@Volker Thank you for your suggestion. I updated the question to elaborate why it is related to &quot;concurrent&quot;."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1522224446, "post_id": 49528232, "comment_id": 86064055, "body": "The first question of Why? is not a technical question but based on opinion only. The second question of How? is dead simple. Compute the value before calling LoadOrStore. If that is too costly: Redesign, lock manually, use a plain map, whatever."}, {"owner": {"reputation": 3202, "user_id": 2247309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9249f58b72f4d2002b24f114a323a608?s=128&d=identicon&r=PG", "display_name": "hussachai", "link": "https://stackoverflow.com/users/2247309/hussachai"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1522225024, "post_id": 49528232, "comment_id": 86064417, "body": "I don&#39;t know <code>Why</code> question ends up as an opinion. It&#39;s a question to get a better understanding on why it is. Yes it is dead simple, but I don&#39;t need to use LoadOrStore in that case."}], "answers": [{"comments": [{"owner": {"reputation": 3202, "user_id": 2247309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9249f58b72f4d2002b24f114a323a608?s=128&d=identicon&r=PG", "display_name": "hussachai", "link": "https://stackoverflow.com/users/2247309/hussachai"}, "edited": false, "score": 0, "creation_date": 1522224487, "post_id": 49528479, "comment_id": 86064083, "body": "Thank you. Yes I know that it is for concurrent use. <code>The purpose of sync.Map is not to provide a way to defer the value calculation</code>  It clearly is, but why is that? My question is for the use case of <code>LoadOrStore</code> not <code>sync.Map</code> in general. It could be an opinion based question, but that is true when the person who asks this kind of question know the language a little bit well (not me). Many people come from other languages might have the same question as mine and they want to learn the right way to do thing. The question does not say what it should be, but to understand why it be."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 3202, "user_id": 2247309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9249f58b72f4d2002b24f114a323a608?s=128&d=identicon&r=PG", "display_name": "hussachai", "link": "https://stackoverflow.com/users/2247309/hussachai"}, "edited": false, "score": 1, "creation_date": 1522224712, "post_id": 49528479, "comment_id": 86064232, "body": "@hussachai <code>LoadOrStore()</code> is there so you can lookup a value associated wtih a key, and if it&#39;s not yet in the map, store some value associated with the key; atomically, in a single step. Wtithout this method, it requires 2 steps which cannot be guaranteed to be carried out atomically without additional synchronization."}, {"owner": {"reputation": 3202, "user_id": 2247309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9249f58b72f4d2002b24f114a323a608?s=128&d=identicon&r=PG", "display_name": "hussachai", "link": "https://stackoverflow.com/users/2247309/hussachai"}, "edited": false, "score": 0, "creation_date": 1522225877, "post_id": 49528479, "comment_id": 86064940, "body": "Thanks @icza That use case is pretty niche. I thought it should have some way to achieve the same thing as Java ConcurrentMap&#39;s  computeIfAbsent, but no luck so far. I think my use case is pretty common in JVM world (Java, Scala, ..). Don&#39;t want to build my own just yet because it will not end up well with my current Go skill. I expect people to say that I use it wrong. The common use case in one platform is not common in another."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 3202, "user_id": 2247309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9249f58b72f4d2002b24f114a323a608?s=128&d=identicon&r=PG", "display_name": "hussachai", "link": "https://stackoverflow.com/users/2247309/hussachai"}, "edited": false, "score": 0, "creation_date": 1522226771, "post_id": 49528479, "comment_id": 86065592, "body": "@hussachai Note that the <code>LoadOrComputeAndStore()</code> operation can easily be implemented by &quot;extending&quot; the <code>sync.Map</code> type. I added an example how to do that, see edited answer."}, {"owner": {"reputation": 3202, "user_id": 2247309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9249f58b72f4d2002b24f114a323a608?s=128&d=identicon&r=PG", "display_name": "hussachai", "link": "https://stackoverflow.com/users/2247309/hussachai"}, "edited": false, "score": 0, "creation_date": 1522228943, "post_id": 49528479, "comment_id": 86067202, "body": "Thanks a lot @icza. As you stated, it&#39;s not atomic unless I introduce locks. I tried to play with the standard lib source code a bit, and found that it&#39;s very easy to modify the code to suit my need. Still not sure it&#39;s correct though since some parts of it are a bit advance. Check my updated question if you&#39;re interested or have any suggestions."}, {"owner": {"reputation": 479, "user_id": 2276207, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c237f6900fac6b1d98dbd3b410e38c3d?s=128&d=identicon&r=PG", "display_name": "Jim Yang", "link": "https://stackoverflow.com/users/2276207/jim-yang"}, "edited": false, "score": 1, "creation_date": 1572791018, "post_id": 49528479, "comment_id": 103661814, "body": "You said &#39;easily&#39; but you didn&#39;t consider such thing that the compute function should be executed exactly once."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 641, "user_id": 1608646, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ONvNt.png?s=128&g=1", "display_name": "Terran", "link": "https://stackoverflow.com/users/1608646/terran"}, "edited": false, "score": 0, "creation_date": 1596112475, "post_id": 49528479, "comment_id": 111710780, "body": "@Terran My answer doesn&#39;t state otherwise, I wrote the same thing."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 0, "last_activity_date": 1522228846, "last_edit_date": 1592644375, "creation_date": 1522221923, "answer_id": 49528479, "question_id": 49528232, "link": "https://stackoverflow.com/questions/49528232/is-there-a-function-similar-to-javas-concurrentmap-computeifabsent-in-go/49528479#49528479", "title": "Is there a function similar to Java&#39;s ConcurrentMap.computeIfAbsent in Go?", "body": "<p>The purpose of <a href=\"https://golang.org/pkg/sync/#Map\" rel=\"nofollow noreferrer\"><code>sync.Map</code></a> is <em>not</em> to provide a way to defer the value calculation, but to provide a general <code>map[interface{}]interface{}</code> <strong>safe for concurrent use</strong> by multiple goroutines. The <code>map</code> type in go is not safe for concurrent use without additional / explicit synchronization.</p>\n<p>This is clearly stated in the doc of <code>sync.Map</code>:</p>\n<blockquote>\n<p>Map is like a Go map[interface{}]interface{} but is <strong>safe for concurrent use</strong> by multiple goroutines without additional locking or coordination. Loads, stores, and deletes run in amortized constant time.</p>\n<p>The Map type is <strong>specialized</strong>. Most code should use a plain Go map instead, with separate locking or coordination, for better type safety and to make it easier to maintain other invariants along with the map content.</p>\n<p>The Map type is <strong>optimized for two common use cases:</strong> (1) when the entry for a given key is only ever written once but read many times, as in caches that only grow, or (2) when multiple goroutines read, write, and overwrite entries for disjoint sets of keys. In these two cases, use of a Map may significantly reduce lock contention compared to a Go map paired with a separate Mutex or RWMutex.</p>\n</blockquote>\n<p>As to why <code>sync.Map</code> has a</p>\n<pre><code>LoadOrStore(key, value interface{}) (actual interface{}, loaded bool)\n</code></pre>\n<p>method instead of:</p>\n<pre><code>LoadOrComputeAndStore(key interface{}, f func() interface{}) (actual interface{}, loaded bool)\n</code></pre>\n<p>That question is opinion based and therefore off-topic for Stackoverflow. But for one reason: the former is easier to use (you don't have to use a function literal when you already have the value) and the latter is not always needed (even though in some cases would be really useful).</p>\n<p>Note that we can easily create our custom sync map that has this &quot;feature&quot;:</p>\n<pre><code>type MyMap struct {\n    sync.Map\n}\n\nfunc (m *MyMap) LoadOrComputeAndStore(key interface{}, f func() interface{}) (actual interface{}, loaded bool) {\n    actual, loaded = m.Load(key)\n    if loaded {\n        return\n    }\n    return m.LoadOrStore(key, f())\n}\n</code></pre>\n<p>Example using it:</p>\n<pre><code>m := &amp;MyMap{Map: sync.Map{}}\n\nf := func() interface{} {\n    fmt.Println(&quot;calculating...&quot;)\n    return &quot;myvalue&quot;\n}\nkey := &quot;mykey&quot;\n\nfmt.Println(m.LoadOrComputeAndStore(key, f))\nfmt.Println(m.LoadOrComputeAndStore(key, f))\n</code></pre>\n<p>Output (try it on the <a href=\"https://play.golang.org/p/xoOrr-9bKMq\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n<pre><code>calculating...\nmyvalue false\nmyvalue true\n</code></pre>\n<p>As seen in the output, <code>f()</code> is only called once. First call to <code>m.LoadOrComputeAndStore()</code> calls <code>f()</code>, and reports <code>loaded=false</code> (as <code>key</code> was not yet in the map). Second call to <code>m.LoadOrComputeAndStore()</code> does not call <code>f()</code>, and reports <code>loaded=true</code>.</p>\n<p>Note that this is an &quot;easy and sufficient&quot; way to achieve what you want. But it is not &quot;bullet proof&quot;, meaning that the implementation of <code>LoadOrComputeAndStore()</code> does not guarantee that <code>f()</code> may only be called once. This is because it first loads the value using <code>Map.Load()</code>. If it finds that it's not in the map, then it calls <code>f()</code>, during which a concurrent goroutine may do the same. So <code>f()</code> may be called multiple times if <code>f()</code> takes long to return and the map is used by multiple goroutines. If guarantee is needed to avoid multiple <code>f()</code> calls, then you should use an explicit <a href=\"https://golang.org/pkg/sync/#RWMutex\" rel=\"nofollow noreferrer\"><code>sync.RWMutex</code></a> in the map.</p>\n<p>So to sum it up: the above example implementation should be sufficient in most cases, namely when <code>f()</code> does not have a side effect, and you only need <code>LoadOrComputeAndStore()</code> to avoid having to call <code>f()</code> due to its long execution time. If <code>f()</code> does have a side effect which must not be repeated, then this implementation is insufficient and manual locking <em>is</em> required.</p>\n"}], "owner": {"reputation": 3202, "user_id": 2247309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9249f58b72f4d2002b24f114a323a608?s=128&d=identicon&r=PG", "display_name": "hussachai", "link": "https://stackoverflow.com/users/2247309/hussachai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 435, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1522230139, "creation_date": 1522221109, "last_edit_date": 1522230139, "question_id": 49528232, "link": "https://stackoverflow.com/questions/49528232/is-there-a-function-similar-to-javas-concurrentmap-computeifabsent-in-go", "title": "Is there a function similar to Java&#39;s ConcurrentMap.computeIfAbsent in Go?", "body": "<p>I tried to find this function in Go's standard library and many other cache libraries that resemble to Java's ConcurrentMap.computeIfAbsent. \nI found sync.Map in the standard library which looks like what I'm looking for. I\u2019d like to use sync.Map as a concurrent map. The problem is that the following function does not provide a defer computation as Java's ConcurrentMap does.</p>\n\n<p><code>func (m *Map) LoadOrStore(key, value interface{}) (actual interface{}, loaded bool)</code></p>\n\n<blockquote>\n  <p>LoadOrStore returns the existing value for the key if present. \n  Otherwise, it stores and returns the given value. The loaded result is\n  true if the value was loaded, false if stored.</p>\n</blockquote>\n\n<p>It\u2019s atomic, but the function doesn\u2019t make sense to me. I don\u2019t understand its purpose since I'm new to the language. I don\u2019t know why the second param is a value not a function. Since the param will be evaluated eagerly, I have no idea how is this function useful when the value is recomputed every time anyway.</p>\n\n<p>It would be much more useful IMO if the function signature is like</p>\n\n<p><code>func (m *Map) LoadOrStore(key interface{}, f func() interface{}) (actual interface{}, loaded bool)</code></p>\n\n<p><s>I mean why do we need a map when we have a value already?\nPretty sure I miss something.</s></p>\n\n<p>Let me elaborate that a bit. I don't get the reason why the function takes a value as parameter instead of a function and I'm pretty sure that I miss something. I want to get a value out of a map in a concurrent manner. When a key doesn't exist, I want to compute the value and put it into the map atomically. I know I shouldn't compare it with the ConcurrentMap in Java since the language and paradigm are different, but it could be useful to say where I'm from and it could benefit anyone who is learning Go to get a little bit of better understanding on this difference.</p>\n\n<p>Here is the similar function in Java ConcurrentMap.</p>\n\n<p><code>computeIfAbsent(K key, Function&lt;? super K,? extends V&gt; mappingFunction)</code></p>\n\n<blockquote>\n  <p>If the specified key is not already associated with a value (or is \n  mapped to null), attempts to compute its value using the given mapping\n  function and enters it into this map unless null.</p>\n</blockquote>\n\n<p>The question is why <code>LoadOrStore</code> function takes a value instead of a function? Any insight on why the API is designed this way would be appreciated. Also Is there a way to accomplish the same thing as I do in Java <code>computeIfAbsent</code> without using an explicit lock around the map?</p>\n\n<p><strong>Updated</strong>\nI found that it's very easy to modify the sync.Map.LoadOrStore to take a function instead of a value.</p>\n\n<p><a href=\"https://play.golang.org/p/VBIaS8ZV38o\" rel=\"nofollow noreferrer\">https://play.golang.org/p/VBIaS8ZV38o</a></p>\n\n<p>Not sure that it will work as expected though. </p>\n"}, {"tags": ["go", "macros"], "comments": [{"owner": {"reputation": 4242, "user_id": 367180, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e356e3a921bedb73efd7594ff7f37b73?s=128&d=identicon&r=PG", "display_name": "matthias krull", "link": "https://stackoverflow.com/users/367180/matthias-krull"}, "edited": false, "score": 4, "creation_date": 1522218959, "post_id": 49527584, "comment_id": 86060772, "body": "Go does not have native C-style macros."}, {"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 2, "creation_date": 1522220306, "post_id": 49527584, "comment_id": 86061487, "body": "If you use constants there isn&#39;t really a performance difference compared to macros. The compiler can do the same sort of optimizations."}], "answers": [{"comments": [{"owner": {"reputation": 1358, "user_id": 5275376, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a8bbb1e2df58ceebc9bbb5596bf823f3?s=128&d=identicon&r=PG&f=1", "display_name": "Shiva Kishore", "link": "https://stackoverflow.com/users/5275376/shiva-kishore"}, "reply_to_user": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 1, "creation_date": 1522220288, "post_id": 49527717, "comment_id": 86061477, "body": "he also wishes to change the value when needed so using const would create problems."}, {"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 7, "creation_date": 1522220346, "post_id": 49527717, "comment_id": 86061519, "body": "He wants to change them at compile-time, not run-time. Just like macros in C/C++. <code>var</code> just adds unnecessary overhead."}], "tags": [], "owner": {"reputation": 1358, "user_id": 5275376, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a8bbb1e2df58ceebc9bbb5596bf823f3?s=128&d=identicon&r=PG&f=1", "display_name": "Shiva Kishore", "link": "https://stackoverflow.com/users/5275376/shiva-kishore"}, "is_accepted": false, "score": 11, "last_activity_date": 1538631636, "last_edit_date": 1538631636, "creation_date": 1522219199, "answer_id": 49527717, "question_id": 49527584, "link": "https://stackoverflow.com/questions/49527584/how-to-implement-macros-in-go/49527717#49527717", "title": "how to implement macros in Go?", "body": "<p>Go doesn't support <code>Macros</code>.<br>\nbut you can use a constants inside a package and refer it where ever you need.</p>\n\n<pre><code>package constant\n// constants.go file\n\nconst (\n    ProjectName = \"My Project\"\n    Title       = \"Awesome Title\"\n)\n</code></pre>\n\n<p>and in your program </p>\n\n<pre><code>package main\nimport \"&lt;path to project&gt;/constant\" // replace the path to project with your path from GOPATH\n\nfunc main() {\n     fmt.Println(constant.ProjectName)\n}\n</code></pre>\n\n<p>The project structure would be</p>\n\n<pre><code>project\n   |- constant\n   |      |- constants.go\n   |-main.go\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 445, "user_id": 8142128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2517015d187f2e364fe99aaf8e588ab6?s=128&d=identicon&r=PG&f=1", "display_name": "Jenil Mewada", "link": "https://stackoverflow.com/users/8142128/jenil-mewada"}, "edited": false, "score": 1, "creation_date": 1551462335, "post_id": 49530118, "comment_id": 96662417, "body": "Can you explain why &quot;luckily&quot; Go does not support macros :/"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 445, "user_id": 8142128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2517015d187f2e364fe99aaf8e588ab6?s=128&d=identicon&r=PG&f=1", "display_name": "Jenil Mewada", "link": "https://stackoverflow.com/users/8142128/jenil-mewada"}, "edited": false, "score": 2, "creation_date": 1551866285, "post_id": 49530118, "comment_id": 96793914, "body": "@JenilMewada, simply because once you have macros you no longer see the real code of your program\u2014you see something else from what the compiler will actually be compiling. Note that when I say &quot;macros&quot; I imply what people tend to colloquially understand by that name\u2014that C&#39;s <code>#ifdef</code>-fery; &quot;real&quot; macros\u2014in certain programming languages such as LISP\u2014is a more interesting/complicated topic. Everyone who dealt with C, for sure more than once had to run the compiler in its special mode &quot;dump what you get after expanding all the macros&quot; to try to understand what the heck is going on."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 445, "user_id": 8142128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2517015d187f2e364fe99aaf8e588ab6?s=128&d=identicon&r=PG&f=1", "display_name": "Jenil Mewada", "link": "https://stackoverflow.com/users/8142128/jenil-mewada"}, "edited": false, "score": 0, "creation_date": 1551866486, "post_id": 49530118, "comment_id": 96794038, "body": "@JenilMewada, note that Go does provide an easy to use and\u2014which is more important\u2014to understand, facility for &quot;conditional compilation&quot;: <a href=\"https://golang.org/pkg/go/build/#hdr-Build_Constraints\" rel=\"nofollow noreferrer\">build constraints</a>."}, {"owner": {"reputation": 581, "user_id": 3550735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c846e896692faeefb33db83af736fc6e?s=128&d=identicon&r=PG&f=1", "display_name": "Nima", "link": "https://stackoverflow.com/users/3550735/nima"}, "edited": false, "score": 0, "creation_date": 1588893689, "post_id": 49530118, "comment_id": 109084352, "body": "For a simple and common usage of macro, like check odd number, it will lead you to chose between something like <code>func odd(n int) bool{return n &amp; 1 == 1}</code> with call stack and copy value costs or ugly code version: <code>if n &amp; 1 == 1{...} &amp;&amp; ... || ...</code>"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 581, "user_id": 3550735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c846e896692faeefb33db83af736fc6e?s=128&d=identicon&r=PG&f=1", "display_name": "Nima", "link": "https://stackoverflow.com/users/3550735/nima"}, "edited": false, "score": 0, "creation_date": 1588931310, "post_id": 49530118, "comment_id": 109095593, "body": "@\u03fb\u03b1\u03fb\u027e\u03a3\u0240\u041e-MaMrEzO, the function you mentioned in the &quot;something like \u2026&quot; bit will be <a href=\"https://play.golang.org/p/GJj9RLCbRpZ\" rel=\"nofollow noreferrer\">happily inlined</a>."}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 23, "last_activity_date": 1610967844, "last_edit_date": 1610967844, "creation_date": 1522227315, "answer_id": 49530118, "question_id": 49527584, "link": "https://stackoverflow.com/questions/49527584/how-to-implement-macros-in-go/49530118#49530118", "title": "how to implement macros in Go?", "body": "<p>Luckily, Go does not support macros.</p>\n<p>There are two venues in Go to implement what is done using macros\nin other programming languages:</p>\n<ul>\n<li>&quot;Meta-programming&quot; is done using <a href=\"https://blog.golang.org/generate\" rel=\"nofollow noreferrer\">code generation</a>.</li>\n<li>&quot;Magic variables/constants&quot; are implemented using &quot;symbol substitutions&quot;\nat link time.</li>\n</ul>\n<p>It appears, the latter is what you're after.</p>\n<p>Unfortunately, the help on this feature is nearly undiscoverable\non itself, but it explained in the output of</p>\n<pre><code>$ go tool link -help\n</code></pre>\n<p>To cite the relevant bit from it:</p>\n<blockquote>\n<p><code>-X definition</code></p>\n<p>add string value <code>definition</code> of the form <code>importpath.name=value</code></p>\n</blockquote>\n<p>So you roll like this:</p>\n<ol>\n<li><p>In any package, where it is convenient,\nyou define a string constant the value of which you'd like to change at build time.</p>\n<p>Let's say, you define constant <code>Bar</code> in package <code>foo</code>.</p>\n</li>\n<li><p>You pass a special flag to the <code>go build</code> or <code>go install</code> invocation for the linking phase at compile time:</p>\n<pre><code> $ go install -ldflags='-X foo.Bar=&quot;my super cool string&quot;'\n</code></pre>\n</li>\n</ol>\n<p>As the result, the produced binary will have the constant <code>foo.Bar</code>\nset to the value &quot;my super cool string&quot; in its &quot;read-only data&quot; segment,\nand that value will be used by the program's code.</p>\n<p>See also the <code>go help build</code> output about the <code>-ldflags</code> option.</p>\n"}], "owner": {"reputation": 315, "user_id": 7958985, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9c6a3a1e2ef5bac790f1328b45944cc8?s=128&d=identicon&r=PG&f=1", "display_name": "Pavani siva dath", "link": "https://stackoverflow.com/users/7958985/pavani-siva-dath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11921, "favorite_count": 1, "answer_count": 2, "score": 10, "last_activity_date": 1610967844, "creation_date": 1522218635, "last_edit_date": 1522226758, "question_id": 49527584, "link": "https://stackoverflow.com/questions/49527584/how-to-implement-macros-in-go", "title": "how to implement macros in Go?", "body": "<p>I've project done in C++ where I used <code>#define</code> macros to give a name of the project, which I used in several places, I don't change this name often but sometimes I may need to change this, then I change this macro and rebuild my code. Now I'm converting this code to Go. Can someone suggest me how to implement this in Go? I'm not interested in using global variables for this purpose because I've many such macros and I doubt this cause my project to occupy more cpu and effect the performance.</p>\n"}, {"tags": ["windows", "unix", "go"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 3, "creation_date": 1522226599, "post_id": 49527215, "comment_id": 86065472, "body": "<a href=\"https://golang.org/pkg/os/#Process.Kill\" rel=\"nofollow noreferrer\"><code>os.Process.Kill</code></a> is cross-platform."}, {"owner": {"reputation": 179, "user_id": 12653791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f883b02216de0fcfb73a48c652ea38d9?s=128&d=identicon&r=PG&f=1", "display_name": "chwala", "link": "https://stackoverflow.com/users/12653791/chwala"}, "edited": false, "score": 0, "creation_date": 1599572886, "post_id": 49527215, "comment_id": 112810825, "body": "os.Process.Kill causes the process to exit immediately. So you won&#39;t be able to kill its child processes."}], "answers": [{"tags": [], "owner": {"reputation": 4242, "user_id": 367180, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e356e3a921bedb73efd7594ff7f37b73?s=128&d=identicon&r=PG", "display_name": "matthias krull", "link": "https://stackoverflow.com/users/367180/matthias-krull"}, "is_accepted": true, "score": 3, "last_activity_date": 1522218118, "creation_date": 1522218118, "answer_id": 49527449, "question_id": 49527215, "link": "https://stackoverflow.com/questions/49527215/cross-platform-way-to-terminate-process-in-go/49527449#49527449", "title": "Cross platform way to terminate process in Go", "body": "<p>You can determine your operating system at runtime using <a href=\"https://golang.org/pkg/runtime/#GOOS\" rel=\"nofollow noreferrer\">runtime.GOOS</a>.</p>\n\n<p>As you have to compile the code for the respective platform at some point, you could write OS specific code pretty easily.</p>\n\n<p>All the relevant documentation is available in <a href=\"https://golang.org/pkg/go/build/\" rel=\"nofollow noreferrer\">Go build</a>.</p>\n\n<blockquote>\n  <p>If a file's name, after stripping the extension and a possible _test\n  suffix, matches *_GOOS, *_GOARCH, or *_GOOS_GOARCH for\n  any known operating system and architecture values, then the file\n  is considered to have an implicit build constraint requiring those\n  terms.</p>\n</blockquote>\n\n<p>That basically means e.g. a file named <code>mypackage_windows.go</code> will only be included when compiling for windows.</p>\n"}], "owner": {"reputation": 1011, "user_id": 2969402, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a971b3c4d070d8af92b98952b702c9bb?s=128&d=identicon&r=PG&f=1", "display_name": "user2969402", "link": "https://stackoverflow.com/users/2969402/user2969402"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 49527449, "answer_count": 1, "score": 0, "last_activity_date": 1522223624, "creation_date": 1522217074, "last_edit_date": 1522223624, "question_id": 49527215, "link": "https://stackoverflow.com/questions/49527215/cross-platform-way-to-terminate-process-in-go", "title": "Cross platform way to terminate process in Go", "body": "<p>So to terminate a process on an Ubuntu machine, I can send a <code>syscall.SIGTERM</code> signal to my process, but that won't work on Windows.\nTo fix it, I've switched to using <code>syscall.TerminateProcess</code> but of course that is not supported on Ubuntu. \nIs there a way to terminate a process that would work on both platform or will I need to have separate code for unix and for windows?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1276, "user_id": 6237232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/557d1078fe8ace9c1e6f88d275f5f32a?s=128&d=identicon&r=PG&f=1", "display_name": "RidgeA", "link": "https://stackoverflow.com/users/6237232/ridgea"}, "edited": false, "score": 0, "creation_date": 1522217152, "post_id": 49527203, "comment_id": 86059901, "body": "Could you be more specific? It is not clear what do you want to achieve. And please provide your code."}, {"owner": {"reputation": 34, "user_id": 5819726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2c84b013fff9d86b14c93b38e70e29c?s=128&d=identicon&r=PG&f=1", "display_name": "F.T. Wicaksono", "link": "https://stackoverflow.com/users/5819726/f-t-wicaksono"}, "reply_to_user": {"reputation": 1276, "user_id": 6237232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/557d1078fe8ace9c1e6f88d275f5f32a?s=128&d=identicon&r=PG&f=1", "display_name": "RidgeA", "link": "https://stackoverflow.com/users/6237232/ridgea"}, "edited": false, "score": 0, "creation_date": 1522218020, "post_id": 49527203, "comment_id": 86060326, "body": "I&#39;ve edited it, please help"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1522219399, "post_id": 49527203, "comment_id": 86061003, "body": "Best advice: Take the Tour of Go, maybe once more if you completed it already. Note that SO is not a code writing/debugging service; you might better of asking such stuff elsewhere, maybe reddit or golang-nuts."}, {"owner": {"reputation": 1358, "user_id": 5275376, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a8bbb1e2df58ceebc9bbb5596bf823f3?s=128&d=identicon&r=PG&f=1", "display_name": "Shiva Kishore", "link": "https://stackoverflow.com/users/5275376/shiva-kishore"}, "edited": false, "score": 0, "creation_date": 1522219915, "post_id": 49527203, "comment_id": 86061260, "body": "Do review your question. its almost impossible to understand what you are saying."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1522223681, "post_id": 49527203, "comment_id": 86063589, "body": "Pick a language. Do you want an answer for Go, or one for Python?"}, {"owner": {"reputation": 34, "user_id": 5819726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2c84b013fff9d86b14c93b38e70e29c?s=128&d=identicon&r=PG&f=1", "display_name": "F.T. Wicaksono", "link": "https://stackoverflow.com/users/5819726/f-t-wicaksono"}, "edited": false, "score": 0, "creation_date": 1522314164, "post_id": 49527203, "comment_id": 86110957, "body": "for Go language"}, {"owner": {"reputation": 1509, "user_id": 4815767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc24bfa1708763d1853a48c6290fbcaa?s=128&d=identicon&r=PG", "display_name": "Popmedic", "link": "https://stackoverflow.com/users/4815767/popmedic"}, "edited": false, "score": 0, "creation_date": 1522718363, "post_id": 49527203, "comment_id": 86248660, "body": "Hey, I just realized, you know that &quot;throw away&quot; value (_) in your range, that is an index value for the array so you don&#39;t need the <code>i++</code>.  I added it to my answer below for you..."}], "answers": [{"tags": [], "owner": {"reputation": 1509, "user_id": 4815767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc24bfa1708763d1853a48c6290fbcaa?s=128&d=identicon&r=PG", "display_name": "Popmedic", "link": "https://stackoverflow.com/users/4815767/popmedic"}, "is_accepted": true, "score": 1, "last_activity_date": 1522718485, "last_edit_date": 1522718485, "creation_date": 1522242208, "answer_id": 49535374, "question_id": 49527203, "link": "https://stackoverflow.com/questions/49527203/how-to-check-same-value-from-result-of-query-and-catch-first-value-in-golang/49535374#49535374", "title": "How to check same value from result of query and catch first value, in golang", "body": "<p>I think you might be looking for reflection in go... I say \"think\" because the way you worded the question is confusing. Something like this?</p>\n\n<pre><code>res := []interface{}{\n    1,\n    \"row2\",\n    struct { str string } { str: \"what the heck???\" },\n}\n// one way of reflecting\nfor i, v := range res {\n    if r, ok := v.(int); ok {\n        fmt.Printf(\"%d: You have an int: %d\\n\", i, r)\n    } else if r, ok := v.(string); ok {\n        fmt.Printf(\"%d: You have a string: %q\\n\", i, r)\n    } else {\n        fmt.Printf(\"%d: Have no idea what this type is: %T\\n\", i, v)\n    }\n}\n// a cleaner way of reflecting (in my opinion)\nfor i, v := range res {\n    switch r := v.(type) {\n    case int:\n        fmt.Printf(\"%d: You have an int: %d\\n\", i, r)\n    case string:\n        fmt.Printf(\"%d: You have a string: %q\\n\", i, r)\n    default:\n        fmt.Printf(\"%d: Have no idea what this type is: %T\\n\", i, v)\n    }\n} \n</code></pre>\n\n<p>Check it in the playground: <a href=\"https://play.golang.org/p/ca7umhCBXt3\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ca7umhCBXt3</a></p>\n\n<p>or here in the \"Tour of Go\": <a href=\"https://tour.golang.org/methods/16\" rel=\"nofollow noreferrer\">https://tour.golang.org/methods/16</a></p>\n"}], "owner": {"reputation": 34, "user_id": 5819726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2c84b013fff9d86b14c93b38e70e29c?s=128&d=identicon&r=PG&f=1", "display_name": "F.T. Wicaksono", "link": "https://stackoverflow.com/users/5819726/f-t-wicaksono"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 1, "accepted_answer_id": 49535374, "answer_count": 1, "score": -2, "last_activity_date": 1522718485, "creation_date": 1522217051, "last_edit_date": 1522314175, "question_id": 49527203, "link": "https://stackoverflow.com/questions/49527203/how-to-check-same-value-from-result-of-query-and-catch-first-value-in-golang", "title": "How to check same value from result of query and catch first value, in golang", "body": "<p>Please help me, how to check same value from query \nand just catch first value in golang or python</p>\n\n<p>{\n    \"data\":[\n    \"1234567001\",\n    \"1234567001\",\n    \"1234567001\",\n    \"1234567001\",\n    \"4567898001\",\n    \"4567898001\",\n    \"4567898001\"\n    ]\n  }</p>\n\n<p>how to get 2 different values from the data, using go lang</p>\n\n<pre><code>vals := []interface{}{}\nfor _, row := range result {\n    nobil := row.Nobilling\n    vals = append(vals, nobil)\n\n    if nobil == row.billing {\n        continue\n    }\n\n    i++\n}\n</code></pre>\n\n<p>I just want to store different values \u200b\u200bfrom the array</p>\n"}, {"tags": ["postgresql", "go", "jsonb", "pq"], "comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1522211242, "post_id": 49526068, "comment_id": 86057890, "body": "why you are implementing <code>MarshalJSON</code> rahter than <code>Marshal</code>."}, {"owner": {"reputation": 16323, "user_id": 355499, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/78892b9338a302a4ba3cc1aa77edd99f?s=128&d=identicon&r=PG", "display_name": "Emil H", "link": "https://stackoverflow.com/users/355499/emil-h"}, "edited": false, "score": 0, "creation_date": 1522214232, "post_id": 49526068, "comment_id": 86058730, "body": "Could you show the code that makes the insert statement and the code that you use to read out the value?"}, {"owner": {"reputation": 663, "user_id": 273797, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/978281c699050200f917d81a2ff6ca87?s=128&d=identicon&r=PG", "display_name": "Walker", "link": "https://stackoverflow.com/users/273797/walker"}, "edited": false, "score": 0, "creation_date": 1522214900, "post_id": 49526068, "comment_id": 86058949, "body": "Also used json.Marshal, but MarshalJSON returns the JSON encoding, which I thought might solve. _, err = db.Exec(sqlStatement, u1, u2, u3). sqlStatement is the insert statement posted above."}, {"owner": {"reputation": 663, "user_id": 273797, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/978281c699050200f917d81a2ff6ca87?s=128&d=identicon&r=PG", "display_name": "Walker", "link": "https://stackoverflow.com/users/273797/walker"}, "edited": false, "score": 0, "creation_date": 1522215076, "post_id": 49526068, "comment_id": 86058993, "body": "I am viewing the result in DB using psql."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1522220453, "post_id": 49526068, "comment_id": 86061579, "body": "@Walker <i>&quot;The data is written as ...&quot;</i> Not really, that&#39;s how the data is displayed by psql not how it&#39;s written. Escaped double quotes of keys and string values constitute invalid json and you would not be able to insert such values into a column of type jsonb or jsonb[]."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1522220701, "post_id": 49526068, "comment_id": 86061708, "body": "@Walker try selecting the element from the array, you&#39;ll see that outside of the array the json is not escaped (e.g. <code>SELECT data[1] FROM user_list ...</code>). And then try inserting, through psql, a json value with it&#39;s double quotes escaped, see if that goes through (e.g. <code>INSERT INTO user_list (data) VALUES (array[&#39;{\\&quot;foo\\&quot;:\\&quot;bar\\&quot;}&#39;::jsonb])</code>)."}], "owner": {"reputation": 663, "user_id": 273797, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/978281c699050200f917d81a2ff6ca87?s=128&d=identicon&r=PG", "display_name": "Walker", "link": "https://stackoverflow.com/users/273797/walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 477, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522210950, "creation_date": 1522210950, "question_id": 49526068, "link": "https://stackoverflow.com/questions/49526068/insert-in-postgres-jsonb-array-causes-the-json-escaping-key-and-value-golang-p", "title": "Insert in postgres jsonb array causes the json escaping key and value - golang pq", "body": "<p>I am marshalling the data as </p>\n\n<pre><code>b, err := json.MarshalJSON(&amp;u3)\n    if err != nil {\n        log.Println(\"error:\", err)\n    }\n</code></pre>\n\n<p>and then insert </p>\n\n<pre><code>INSERT INTO user_list (userid, listtype, data) VALUES ($1, $2, (array[$3::json]))\n</code></pre>\n\n<p>The data is written as </p>\n\n<blockquote>\n  <p>{\"{\\\"from\\\": \\\"2010-11-12\\\", \\\"till\\\": \\\"2018-3-10\\\", \\\"oieId\\\":\n  \\\"1212458454\\\", \\\"iType\\\": \\\"ird\\\"}\"}</p>\n</blockquote>\n\n<p>Nothing is helping me prevent those escaping from being written even though the data type is json.RawMessage.</p>\n\n<p>Is there a way to just write as JSON and not cast the $3 to be cast to JSON or just prevent those escapes from being written to jsonb[] type row ?</p>\n\n<p>Any help is appreciated.\nThanks</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1522208800, "post_id": 49524849, "comment_id": 86057267, "body": "Questions about &quot;Why?&quot; on artificial code snippets don&#39;t have an answer. Maybe there is a technical reason or it is for educational purpose or to demonstrate something. Or it is a question of taste."}, {"owner": {"reputation": 1509, "user_id": 4815767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc24bfa1708763d1853a48c6290fbcaa?s=128&d=identicon&r=PG", "display_name": "Popmedic", "link": "https://stackoverflow.com/users/4815767/popmedic"}, "edited": false, "score": 0, "creation_date": 1522243277, "post_id": 49524849, "comment_id": 86077848, "body": "A stab in the dark, but because ABitOfEverythingServer is an interface, and more flexible if you want to swap it out, easy to &quot;mock&quot; or &quot;stub&quot; in tests.  I suggest reading about interfaces."}], "answers": [{"comments": [{"owner": {"reputation": 1323, "user_id": 1800508, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/f50c0dc2a98227d029183f22cfd73570?s=128&d=identicon&r=PG&f=1", "display_name": "Quesofat", "link": "https://stackoverflow.com/users/1800508/quesofat"}, "edited": false, "score": 1, "creation_date": 1612217478, "post_id": 49525644, "comment_id": 116693292, "body": "This answer is condescending."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1522207857, "creation_date": 1522207857, "answer_id": 49525644, "question_id": 49524849, "link": "https://stackoverflow.com/questions/49524849/golang-new-a-struct-but-return-an-interface/49525644#49525644", "title": "golang new a struct but return an interface", "body": "<p>First, you need to learn the basics of Go. Take <a href=\"https://tour.golang.org\" rel=\"nofollow noreferrer\">A Tour of Go</a>.</p>\n\n<p>Simplifying a complicated example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype S struct{ F int }\n\ntype I interface{}\n\nfunc newI() I {\n    return &amp;S{F: 42}\n}\n\nfunc main() {\n    i := newI()\n    s := i.(*S)\n    f := s.F\n    fmt.Println(f)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/tHbTZHEQZ-L\" rel=\"nofollow noreferrer\">https://play.golang.org/p/tHbTZHEQZ-L</a></p>\n\n<p>Output:</p>\n\n<pre><code>42\n</code></pre>\n\n<p>The <code>newI</code> function returns a value of interface type <code>I</code>, which contains a value of concrete type <code>*S</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 375, "user_id": 6935236, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hC8l2tY8XIY/AAAAAAAAAAI/AAAAAAAAABg/TZuFezYPtoc/photo.jpg?sz=128", "display_name": "Shivaprasad Bhat", "link": "https://stackoverflow.com/users/6935236/shivaprasad-bhat"}, "is_accepted": false, "score": 4, "last_activity_date": 1544376699, "last_edit_date": 1544376699, "creation_date": 1544376389, "answer_id": 53694812, "question_id": 49524849, "link": "https://stackoverflow.com/questions/49524849/golang-new-a-struct-but-return-an-interface/53694812#53694812", "title": "golang new a struct but return an interface", "body": "<p>I do not know if there was any particular reason for returning interface in the above snippet. </p>\n\n<p>But generally, returning structs is the <a href=\"https://github.com/golang/go/wiki/CodeReviewComments#interfaces\" rel=\"nofollow noreferrer\">recommended</a> way. Remember <code>Accept interfaces, return structs</code> anyone?</p>\n\n<p>Returning interfaces <strong>does not simplify</strong> mocking in anyway since client can define interface when mocking is required (which is the most beautiful thing about golang interfaces). </p>\n\n<pre><code>func newABitOfEverythingServer() *_ABitOfEverythingServer { // &lt;- returning struct ptr\n    return &amp;_ABitOfEverythingServer{\n        v: make(map[string]*examples.ABitOfEverything),\n    }\n}\n</code></pre>\n\n<p>For the above refactored version (which returns structs), client can simply define an interface describing <strong>what it needs</strong> and mock only that:</p>\n\n<pre><code>type onlyStreamPart interface {\n     examples.StreamServiceServer\n}\n\n// streamer does not care if the streamServer also\n// implements examples.ABitOfEverythingServiceServer\n// or not. (Think interface segregation from SOLID)\nfunc streamer(stremServer onlyStreamPart) {\n}\n\n// which can be called easily as:\nstreamer(newABitOfEverythingServer())\n</code></pre>\n\n<p>This simplifies mocking a lot while testing <code>streamer</code> since the mock implementation\ndoes not have to implement <code>examples.ABitOfEverythingServiceServer</code> interface.</p>\n\n<p>This is a <strong>commonly misunderstood</strong> by developers from Java, C# etc. backgrounds (where type systems are name based, not structural as in Go). Since in those languages client cannot modify the interface it is accepting because that would require adding <code>implements newInterfaceDefinedByClient</code> clause to all the classes that need to be passed to the client.</p>\n"}], "owner": {"reputation": 37, "user_id": 9561371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PTucN.jpg?s=128&g=1", "display_name": "williambest", "link": "https://stackoverflow.com/users/9561371/williambest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3247, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1544376699, "creation_date": 1522201773, "question_id": 49524849, "link": "https://stackoverflow.com/questions/49524849/golang-new-a-struct-but-return-an-interface", "title": "golang new a struct but return an interface", "body": "<p>Here are golang code, the func newXXX return an interface, but why it does not return a struct</p>\n\n<pre><code>type _ABitOfEverythingServer struct {\n    v map[string]*examples.ABitOfEverything\n    m sync.Mutex\n}\n\ntype ABitOfEverythingServer interface {\n    examples.ABitOfEverythingServiceServer  // interface\n    examples.StreamServiceServer            // interface\n}\n\nfunc newABitOfEverythingServer() ABitOfEverythingServer { \n//&lt;-why not return _ABitOfEverythingServer, is it a good way?\n    return &amp;_ABitOfEverythingServer{\n        v: make(map[string]*examples.ABitOfEverything),\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "amazon-s3", "aws-sdk"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1522191455, "post_id": 49523504, "comment_id": 86053217, "body": "Is the bucket public? <code>http.Get</code>, no SDK required. Just making sure you&#39;re seeing the forest."}, {"owner": {"reputation": 6511, "user_id": 99089, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/ge49Z.jpg?s=128&g=1", "display_name": "Paul J. Lucas", "link": "https://stackoverflow.com/users/99089/paul-j-lucas"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1522199306, "post_id": 49523504, "comment_id": 86055012, "body": "No, the bucket is not public. (I&#39;ve updated the question to state this explicitly.)"}], "answers": [{"comments": [{"owner": {"reputation": 6511, "user_id": 99089, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/ge49Z.jpg?s=128&g=1", "display_name": "Paul J. Lucas", "link": "https://stackoverflow.com/users/99089/paul-j-lucas"}, "edited": false, "score": 1, "creation_date": 1522199436, "post_id": 49523813, "comment_id": 86055044, "body": "No, the object can not be publicly readable. (I&#39;ve updated my question.) The object must only be accessible by the owner, so I don&#39;t believe any of your proposals will work."}], "tags": [], "owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "is_accepted": false, "score": 0, "last_activity_date": 1522192512, "creation_date": 1522192512, "answer_id": 49523813, "question_id": 49523504, "link": "https://stackoverflow.com/questions/49523504/download-a-file-from-s3-using-full-uri-using-aws-sdk-for-go/49523813#49523813", "title": "Download a file from S3 using full URI using AWS SDK for Go", "body": "<p>Here you first need to enable public access on the object that you are trying to download from S3. You could achieve this by either of following approach.</p>\n\n<ul>\n<li>Make object publicly readable. But remember, whoever got access on\nthe resource url can download your object from S3.</li>\n<li>Grant an anonymous access to your S3 bucket through bucket policies. <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/dev/example-bucket-policies.html\" rel=\"nofollow noreferrer\">Refer \nhere</a> to read about this approach with policy samples. Remember to verify \nwhat you expose when you go in this route.</li>\n<li>Use a <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/dev/ShareObjectPreSignedURL.html\" rel=\"nofollow noreferrer\">PreSignedUrl</a> that permit to download the object in time-limited \nmanner. This is what I would prefer from aforementioned approaches.</li>\n</ul>\n\n<p>Now last step would be to use go's <a href=\"https://golang.org/pkg/net/http/\" rel=\"nofollow noreferrer\">http client</a> to make the call to your pre-signed url and download the required object.</p>\n"}, {"comments": [{"owner": {"reputation": 6511, "user_id": 99089, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/ge49Z.jpg?s=128&g=1", "display_name": "Paul J. Lucas", "link": "https://stackoverflow.com/users/99089/paul-j-lucas"}, "edited": false, "score": 1, "creation_date": 1522199198, "post_id": 49523833, "comment_id": 86054991, "body": "Yes, I know I can parse it. I asked specifically if there is a way to use the SDK directly."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1522223513, "post_id": 49523833, "comment_id": 86063491, "body": "Use the path package to work with paths. It will deal with double slashes correctly, for instance."}, {"owner": {"reputation": 6511, "user_id": 99089, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/ge49Z.jpg?s=128&g=1", "display_name": "Paul J. Lucas", "link": "https://stackoverflow.com/users/99089/paul-j-lucas"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1522240875, "post_id": 49523833, "comment_id": 86075971, "body": "@Peter What does the path package have to do with the AWS SDK for Go?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "reply_to_user": {"reputation": 6511, "user_id": 99089, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/ge49Z.jpg?s=128&g=1", "display_name": "Paul J. Lucas", "link": "https://stackoverflow.com/users/99089/paul-j-lucas"}, "edited": false, "score": 0, "creation_date": 1522246610, "post_id": 49523833, "comment_id": 86080535, "body": "@PaulJ.Lucas, nothing. It has to do with URL parsing. The strings.Split* functions are unsuitable unless the URL is normalized (contains no double slashes, for instance)."}], "tags": [], "owner": {"reputation": 26448, "user_id": 10322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa46a3814b72439b1d2efa8f7c9162c2?s=128&d=identicon&r=PG", "display_name": "ctcherry", "link": "https://stackoverflow.com/users/10322/ctcherry"}, "is_accepted": false, "score": 2, "last_activity_date": 1522192649, "creation_date": 1522192649, "answer_id": 49523833, "question_id": 49523504, "link": "https://stackoverflow.com/questions/49523504/download-a-file-from-s3-using-full-uri-using-aws-sdk-for-go/49523833#49523833", "title": "Download a file from S3 using full URI using AWS SDK for Go", "body": "<p>You could parse the URL to get the bucket and key:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/url\"\n    \"strings\"\n)\n\nfunc main() {\n    u, err := url.Parse(\"https://s3.us-west-2.amazonaws.com/myBucket/myKey/morekey\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    path := strings.SplitN(u.Path, \"/\", 3)\n    bucket := path[1]\n    key := path[2]\n    fmt.Println(bucket)\n    fmt.Println(key)\n}\n</code></pre>\n\n<p>Runnable: <a href=\"https://play.golang.org/p/G3Mxmm4f4qM\" rel=\"nofollow noreferrer\">https://play.golang.org/p/G3Mxmm4f4qM</a></p>\n"}, {"comments": [{"owner": {"reputation": 1826, "user_id": 3628317, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e09d9646795e000b8861f8f3ef81bb68?s=128&d=identicon&r=PG&f=1", "display_name": "levo4ka", "link": "https://stackoverflow.com/users/3628317/levo4ka"}, "edited": false, "score": 0, "creation_date": 1547797863, "post_id": 49524986, "comment_id": 95323467, "body": "max lifetime for presigned url is 7 days, so not the best idea to just store and retrieve them later"}], "tags": [], "owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "is_accepted": true, "score": 5, "last_activity_date": 1522202851, "creation_date": 1522202851, "answer_id": 49524986, "question_id": 49523504, "link": "https://stackoverflow.com/questions/49523504/download-a-file-from-s3-using-full-uri-using-aws-sdk-for-go/49524986#49524986", "title": "Download a file from S3 using full URI using AWS SDK for Go", "body": "<p>There is no way to do what you want. The only ways to get a private object are:</p>\n\n<ol>\n<li>Use the bucket and key to download the file</li>\n<li>Generate a presigned URL an do an <code>hhtp.Get</code> on that URL (to generate the presigned URL you need the bucket and key)</li>\n</ol>\n\n<p>If you really want to use the URL I recommend you create a wrapper around <code>s3.GetObjectInput</code> that accepts the URL as an argument, parses it and then create the <code>s3.GetObjectInput</code> object.</p>\n\n<p>Also, I don't know if you could do this it depends on your use case, but if you are storing the URLs somewhere and that's why you want to use them, you can consider storing instead the presigned url with a long expiration time, and then when you want to fetch the object you can just use that URL.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 1868068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69b5a7f495035db81e4864c0b4655fc7?s=128&d=identicon&r=PG", "display_name": "pilathraj", "link": "https://stackoverflow.com/users/1868068/pilathraj"}, "is_accepted": false, "score": 2, "last_activity_date": 1566973720, "creation_date": 1566973720, "answer_id": 57686232, "question_id": 49523504, "link": "https://stackoverflow.com/questions/49523504/download-a-file-from-s3-using-full-uri-using-aws-sdk-for-go/57686232#57686232", "title": "Download a file from S3 using full URI using AWS SDK for Go", "body": "<p>Created new S3URLtoURI parser for this.</p>\n\n<pre><code>func S3URLtoURI(s3Url string) (map[string]string, error) {\n    m := make(map[string]string)\n    u, err := url.Parse(s3Url)\n    if err != nil {\n        return m, err\n    }\n\n    if u.Scheme == \"s3\" {\n        //s3: //bucket/key\n        m[\"bucket\"] = u.Host\n        m[\"key\"] = strings.TrimLeft(u.Path, \"/\")\n    } else if u.Scheme == \"https\" {\n        host := strings.SplitN(u.Host, \".\", 2)\n        if host[0] == \"s3\" {\n            // No bucket name in the host;\n            path := strings.SplitN(u.Path, \"/\", 3)\n            m[\"bucket\"] = path[1]\n            m[\"key\"] = path[2]\n        } else { //bucket name in host\n            m[\"bucket\"] = host[0]\n            m[\"key\"] = strings.TrimLeft(u.Path, \"/\")\n        }\n\n    }\n    return m, err\n}\n</code></pre>\n\n<p>Runnable: <a href=\"https://play.golang.org/p/vkPJ7E4Fyno\" rel=\"nofollow noreferrer\">https://play.golang.org/p/vkPJ7E4Fyno</a></p>\n"}], "owner": {"reputation": 6511, "user_id": 99089, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/ge49Z.jpg?s=128&g=1", "display_name": "Paul J. Lucas", "link": "https://stackoverflow.com/users/99089/paul-j-lucas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2984, "favorite_count": 0, "accepted_answer_id": 49524986, "answer_count": 4, "score": 1, "last_activity_date": 1566973720, "creation_date": 1522190240, "last_edit_date": 1522199279, "question_id": 49523504, "link": "https://stackoverflow.com/questions/49523504/download-a-file-from-s3-using-full-uri-using-aws-sdk-for-go", "title": "Download a file from S3 using full URI using AWS SDK for Go", "body": "<p>The examples I've seen for downloading a file from S3 using the AWS SDK for Go are of the form:</p>\n\n<pre><code>downloader := s3manager.NewDownloader(session, /* other args */)\n\ns3object := &amp;s3.GetObjectInput{\n    Bucket: aws.String(myBucket),\n    Key: aws.String(myKey),\n}\n\nbytesDownloaded, err := downloader.Download(myFile, s3object)\n</code></pre>\n\n<p>That is, one uses the bucket and key to specify the file. But what if I already have the full URI of the file on S3?  E.g.:</p>\n\n<p><code>https://s3.us-west-2.amazonaws.com/myBucket/myKey</code></p>\n\n<p>Is there a way using the SDK to specify the file to download using the URL directly?</p>\n\n<p>No, the bucket is <em>not</em> public.  In the SDK, I'm also setting the access and secret keys (elided from the example code).</p>\n\n<p>Lastly, if it's simply not possible to do what I'm asking via the SDK, that's an acceptable (though not desired) answer.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1812, "user_id": 205936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q8CeA.png?s=128&g=1", "display_name": "S.R.I", "link": "https://stackoverflow.com/users/205936/s-r-i"}, "edited": false, "score": 0, "creation_date": 1522188036, "post_id": 49523077, "comment_id": 86052082, "body": "try this? <a href=\"https://stackoverflow.com/questions/24534072/how-to-compare-struct-slice-map-are-equal\" title=\"how to compare struct slice map are equal\">stackoverflow.com/questions/24534072/&hellip;</a> Please do some searching around this site. Chances are, your questions may have already been answered before. Otherwise, welcome to SO!"}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 2, "creation_date": 1522188738, "post_id": 49523077, "comment_id": 86052352, "body": "If you only want <code>Path</code> to be used to differentiate between keys in a map, shouldn&#39;t <code>Path</code> be the key instead of the struct?"}], "answers": [{"tags": [], "owner": {"reputation": 261, "user_id": 1358581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aWiQu.jpg?s=128&g=1", "display_name": "trierra", "link": "https://stackoverflow.com/users/1358581/trierra"}, "is_accepted": false, "score": 1, "last_activity_date": 1522190090, "creation_date": 1522190090, "answer_id": 49523473, "question_id": 49523077, "link": "https://stackoverflow.com/questions/49523077/golang-equivalent-of-hashcode-and-equals-method/49523473#49523473", "title": "Golang equivalent of hashcode() and equals() method", "body": "<blockquote>\n  <p>map keys may be of any type that is comparable. The language spec defines this precisely, but in short, comparable types are boolean, numeric, string, pointer, channel, and interface types, and structs or arrays that contain only those types. Notably absent from the list are slices, maps, and functions; these types cannot be compared using ==, and may not be used as map keys.\n  <a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"nofollow noreferrer\">https://blog.golang.org/go-maps-in-action</a></p>\n</blockquote>\n\n<p>But you can implement hashCode(), that takes struct as argument and returns string. Then use this string as key in map. </p>\n\n<p>for instance:</p>\n\n<pre><code>type Key struct {\n  Path, City, Country string\n}\n\nfunc (k Key) hashCode() string {\n   return fmt.Sprintf(\"%s/%s\", k.Path, k.City) //omit Country in your hash code here\n}\n\n\nfunc main(){\n  myMap := make(map[string]interface{})\n\n  n := Key{Path: \"somePath\", City:\"someCity\", Country:\"someCountry\"}\n  myMap[n.hashCode()] = \"someValue\"\n}\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 3254985, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/47f19401a1770ced52e84560ea81c4d6?s=128&d=identicon&r=PG&f=1", "display_name": "Sudatta", "link": "https://stackoverflow.com/users/3254985/sudatta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4033, "favorite_count": 1, "closed_date": 1522208856, "answer_count": 1, "score": 0, "last_activity_date": 1522190090, "creation_date": 1522187857, "question_id": 49523077, "link": "https://stackoverflow.com/questions/49523077/golang-equivalent-of-hashcode-and-equals-method", "closed_reason": "Duplicate", "title": "Golang equivalent of hashcode() and equals() method", "body": "<p>I have started to use Golang and know that custom structs can be used as keys in maps. But I wanted to know if it is possible to explicitly specify how my map can differenciate between the keys (similar to Java where we use hashcode() and equals()). Lets say we have:</p>\n\n<pre><code>type Key struct {\n   Path, Country string\n}\n</code></pre>\n\n<p>If I want to specify that only the Path attribute of struct Key be used to differentiate between keys in a map, how do I do that?</p>\n"}, {"tags": ["git", "go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1522191011, "post_id": 49521428, "comment_id": 86053110, "body": "And what&#39;s the problem?"}, {"owner": {"reputation": 5728, "user_id": 7907591, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/0vpof.jpg?s=128&g=1", "display_name": "Morse", "link": "https://stackoverflow.com/users/7907591/morse"}, "edited": false, "score": 0, "creation_date": 1522196965, "post_id": 49521428, "comment_id": 86054516, "body": "<a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> go through this and edit your question."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1522198684, "post_id": 49521428, "comment_id": 86054878, "body": "I don&#39;t know git2go but as far as git is concerned you can only directly amend the <i>latest</i> commit. Changing a commit in the middle of a history changes all subsequent commits as well: It is a rebase and must be performed as one. See <a href=\"https://stackoverflow.com/questions/1186535/how-to-modify-a-specified-commit-in-git\" title=\"how to modify a specified commit in git\">stackoverflow.com/questions/1186535/&hellip;</a>."}, {"owner": {"reputation": 1, "user_id": 9426119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e095f4c6799f7ffb29d8c4cf0bf73764?s=128&d=identicon&r=PG&f=1", "display_name": "user9426119", "link": "https://stackoverflow.com/users/9426119/user9426119"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1522271758, "post_id": 49521428, "comment_id": 86096298, "body": "@Peter :Edited my post, sorry missed the question part of the post!"}, {"owner": {"reputation": 1, "user_id": 9426119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e095f4c6799f7ffb29d8c4cf0bf73764?s=128&d=identicon&r=PG&f=1", "display_name": "user9426119", "link": "https://stackoverflow.com/users/9426119/user9426119"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1522272937, "post_id": 49521428, "comment_id": 86096818, "body": "@PeterA.Schneider :I understand git amend amends the latest commit. However, this git2go Amend() API takes tree as one of the parameters which I think is used to identify a specific commit."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1522301715, "post_id": 49521428, "comment_id": 86104587, "body": "As I said, if <code>Amend</code> tries to do what it sounds like it should do (namely amend a commit), it will not be possible without rewriting the history of all commits for which this commit is an ancestor, which amounts to a rebase. I notice that you never check <code>err</code> which should be nil when no error orccured (and otherwise presumably should contain a diagnostic message). (As an aside, the utter lack of documentation of git2go is an obvious hurdle to effectively using it, isn&#39;t it? Why don&#39;t you document for the project what you find out?)"}], "owner": {"reputation": 1, "user_id": 9426119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e095f4c6799f7ffb29d8c4cf0bf73764?s=128&d=identicon&r=PG&f=1", "display_name": "user9426119", "link": "https://stackoverflow.com/users/9426119/user9426119"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522272022, "creation_date": 1522180586, "last_edit_date": 1522272022, "question_id": 49521428, "link": "https://stackoverflow.com/questions/49521428/how-to-amend-a-specific-commit-message-of-a-specific-commit-in-git2go", "title": "How to amend a specific commit message of a specific commit in git2go?", "body": "<p>Here is what I have tried:\nIterate through git log to find the specific commit I want to modify. Next I modify the commit message. Now I want to amend this message to that specific commit. Code snippet as below: </p>\n\n<p>So my problem is this code does not amend the commit message. Not sure where I am going wrong. Since Amend() takes tree as one of the parameter I am assuming the specific commit message should have been pushed to git.</p>\n\n<pre><code>err = odb.ForEach(func(oid *git.Oid) error {\n    obj, err := repo.Lookup(oid)\n    if err != nil {\n        return err\n    }\n\n    if obj.Type() != git.ObjectCommit {\n        return nil\n    }\n\n    commit, err := obj.AsCommit()\n    if err != nil {\n        return err\n    }\n    tree, err := commit.Tree()\n    if err != nil {\n        return err\n    } \n    message := strings.Replace(commit.Message(), \"\\n\", \" \", -1)\n    if strings.Contains(message, key) {\n        message := strings.Replace(commit.Message(), key, new_key, -1)\n        repo, err := commit.Amend(\"\", signature, signature, message, tree)\n        remote, err = repo.Remotes.Create(\"origin\", repo.Path())\n        head, err := repo.Head()\n        branchName := head.Name()\n        if err := remote.Push([]string{branchName}, &amp;git.PushOptions{}); err != nil {\n            return err\n        }\n</code></pre>\n"}, {"tags": ["go", "io"], "comments": [{"owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "edited": false, "score": 0, "creation_date": 1522166495, "post_id": 49517408, "comment_id": 86040444, "body": "there are no exceptions in go, just panics, and it will be helpful for you to post what the panic stack trace actually is instead of making people guess."}, {"owner": {"reputation": 440, "user_id": 5533359, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e8239f1949802e12c6c4a712a7e70613?s=128&d=identicon&r=PG&f=1", "display_name": "HMD", "link": "https://stackoverflow.com/users/5533359/hmd"}, "reply_to_user": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "edited": false, "score": 0, "creation_date": 1522168453, "post_id": 49517408, "comment_id": 86041765, "body": "@mpm I posted the panic message"}], "answers": [{"tags": [], "owner": {"reputation": 8775, "user_id": 821110, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa6fca5f613944238a91d2daeba67b9d?s=128&d=identicon&r=PG", "display_name": "W.K.S", "link": "https://stackoverflow.com/users/821110/w-k-s"}, "is_accepted": false, "score": 2, "last_activity_date": 1522167105, "last_edit_date": 1522167105, "creation_date": 1522166733, "answer_id": 49517652, "question_id": 49517408, "link": "https://stackoverflow.com/questions/49517408/is-it-possible-to-use-fmt-fscan-or-fmt-scan-for-standard-i-o/49517652#49517652", "title": "Is it possible to use `fmt.Fscan` or `fmt.Scan` for standard I/O?", "body": "<p>A pointer to a <code>string</code> is unnecessary, you simply need to provide a reference to an initialised string.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n\n    fmt.Print(\"pls enter name: \")\n\n    var str string\n\n    size,err := fmt.Fscan(os.Stdin, &amp;str)\n\n    if err != nil{\n        fmt.Println(\"Error reading name\",err)\n    }\n\n    fmt.Printf(\"Number of fields: %d. Text: %s\",size,str)\n\n}\n</code></pre>\n\n<p>You'll notice that multiple fields can be parsed:</p>\n\n<pre><code>func main() {\n\n    fmt.Print(\"Please enter your first and last name seperated by a space\")\n\n    var firstName string\n    var lastName string\n\n    size,err := fmt.Fscan(os.Stdin, &amp;firstName, &amp;lastName)\n\n    //...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 650, "user_id": 7669570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f4c9c277ec9fea0992c74b3f989be39?s=128&d=identicon&r=PG&f=1", "display_name": "flevinkelming", "link": "https://stackoverflow.com/users/7669570/flevinkelming"}, "is_accepted": true, "score": 4, "last_activity_date": 1522168171, "last_edit_date": 1522168171, "creation_date": 1522166800, "answer_id": 49517670, "question_id": 49517408, "link": "https://stackoverflow.com/questions/49517408/is-it-possible-to-use-fmt-fscan-or-fmt-scan-for-standard-i-o/49517670#49517670", "title": "Is it possible to use `fmt.Fscan` or `fmt.Scan` for standard I/O?", "body": "<p>The first thing I notice with your code is that you're passing a <code>nil</code> pointer to <code>fmt.Fscan</code>, i.e. you declare the variable <code>st</code> as <code>*string</code> but the address does not yet exist. It should be written:</p>\n\n<pre><code>var st string\n_, err := fmt.Fscan(os.Stdin, &amp;st)\nif err != nil {\n    fmt.Println(err)\n} \n</code></pre>\n\n<p>In my revised example, <code>st</code> now has a memory address (a <code>string</code>'s zero value is <code>\"\"</code>), so it's address can be obtained using <code>&amp;</code> and then passed to <code>fmt.Fscan</code>. Second, you should note how I handle <code>err</code> returned from <code>fmt.Fscan</code> - you simply print <code>err</code>, but what if an <code>error</code> is not returned? Then <code>err</code> is <code>nil</code> and your <code>fmt.Println(err)</code> is executed for no reason - it is idiomatic to handle returned <code>error</code>s conditionally, as is done in the above example.</p>\n\n<p>However it is more common to use <a href=\"https://golang.org/pkg/fmt/#Scanf\" rel=\"nofollow noreferrer\">fmt.Scanf</a> like so:</p>\n\n<pre><code>var st string\nfmt.Scanf(\"%s\", &amp;st)\n</code></pre>\n\n<p>Read the docs for more information. <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\">The \"fmt\" package</a>.</p>\n"}], "owner": {"reputation": 440, "user_id": 5533359, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e8239f1949802e12c6c4a712a7e70613?s=128&d=identicon&r=PG&f=1", "display_name": "HMD", "link": "https://stackoverflow.com/users/5533359/hmd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1200, "favorite_count": 1, "accepted_answer_id": 49517670, "answer_count": 2, "score": 0, "last_activity_date": 1522168647, "creation_date": 1522166031, "last_edit_date": 1522168647, "question_id": 49517408, "link": "https://stackoverflow.com/questions/49517408/is-it-possible-to-use-fmt-fscan-or-fmt-scan-for-standard-i-o", "title": "Is it possible to use `fmt.Fscan` or `fmt.Scan` for standard I/O?", "body": "<p>About the standard I\\O in Golang, all tutorial on the net, Without exception, discuss and use <code>bufio</code> which I tested and worked fine.</p>\n\n<p>But my question is about using <code>fmt</code> package for reading standard input which either gives me errors or trapped in a loop.\nAccording to the <code>fmt.Scan</code> documentation:</p>\n\n<blockquote>\n  <p>Scan scans text read from standard input, storing successive\n  space-separated values into successive arguments. Newlines count as\n  space. It returns the number of items successfully scanned. If that is\n  less than the number of arguments, err will report why.</p>\n</blockquote>\n\n<p>In the first sentence it is said that <code>Scan</code> reads from standard input, but it doesn't work at all!\nalso for <code>fmt.Fscan</code> which have this signature:</p>\n\n<p><code>func Fscan(r io.Reader, a ...interface{}) (n int, err error)</code></p>\n\n<p>when I enter a word, it throws exceptions and I can't even understand them!</p>\n\n<p>So, is it possible to use these 2 methods to read standard input?</p>\n\n<hr>\n\n<p>for more information this is my code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n\n    fmt.Print(\"pls enter name: \")\n\n    var st *string\n\n    n, err := fmt.Fscan(os.Stdin, st)\n\n    fmt.Println(st)\n\n    fmt.Println(n)\n    fmt.Println(err)\n</code></pre>\n\n<h2>    }</h2>\n\n<p>EDIT: the error I get when entering a word in above code:</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference [recover\ned]\n        panic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xc0000005 code=0x1 addr=0x8 pc=0x4977aa]\n\ngoroutine 1 [running]:\nfmt.errorHandler(0xc04206be40)\n        C:/development/Programming Languages/GO/src/fmt/scan.go:1031 +0x14f\npanic(0x4b15a0, 0x544720)\n        C:/development/Programming Languages/GO/src/runtime/panic.go:505 +0x237\nfmt.(*ss).scanOne(0xc042044060, 0x76, 0x4a6460, 0x0)\n        C:/development/Programming Languages/GO/src/fmt/scan.go:979 +0xc7a\nfmt.(*ss).doScan(0xc042044060, 0xc04206bf48, 0x1, 0x1, 0x0, 0x0, 0x0)\n        C:/development/Programming Languages/GO/src/fmt/scan.go:1040 +0x9d\nfmt.Fscan(0x4de080, 0xc042004010, 0xc04206bf48, 0x1, 0x1, 0x0, 0x10, 0x4b36c0)\n        C:/development/Programming Languages/GO/src/fmt/scan.go:123 +0xd2\nmain.main()\n        C:/Users/Hamed/Documents/Go Projects/src/golang/learning/helloworld/firs\ntApp.go:22 +0xe3\n</code></pre>\n"}, {"tags": ["file", "parsing", "go", "directory"], "answers": [{"tags": [], "owner": {"reputation": 1509, "user_id": 4815767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc24bfa1708763d1853a48c6290fbcaa?s=128&d=identicon&r=PG", "display_name": "Popmedic", "link": "https://stackoverflow.com/users/4815767/popmedic"}, "is_accepted": false, "score": 2, "last_activity_date": 1522245844, "last_edit_date": 1522245844, "creation_date": 1522244397, "answer_id": 49536106, "question_id": 49517158, "link": "https://stackoverflow.com/questions/49517158/golang-parsing-all-templates-which-are-in-different-directories/49536106#49536106", "title": "Golang: Parsing all templates which are in different directories?", "body": "<p><code>var tmpl = template.Must(template.ParseGlob(\"*/*\"))</code></p>\n\n<p>quick example:</p>\n\n<p>directory structure:</p>\n\n<pre><code>-rw-r--r--  1 User  staff  194 Mar 28 07:39 main.go\ndrwxr-xr-x  3 User  staff  102 Mar 28 07:38 test1\ndrwxr-xr-x  3 User  staff  102 Mar 28 07:38 test2\n</code></pre>\n\n<p>contents of test1</p>\n\n<pre><code>-rw-r--r--  1 User  staff  0 Mar 28 07:38 template1.html\n</code></pre>\n\n<p>contents of test2</p>\n\n<pre><code>-rw-r--r--  1 User  staff  0 Mar 28 07:38 template2.html\n</code></pre>\n\n<p>main.go</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"html/template\"\n)\n\nfunc main() {\n    var tmpl = template.Must(template.ParseGlob(\"*/*\"))\n    fmt.Println(tmpl.DefinedTemplates())\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>; defined templates are: \"template2.html\", \"template1.html\"\n</code></pre>\n\n<p>template.ParseGlob uses filepath.Glob to do the globbing.</p>\n\n<pre><code>// parseGlob is the implementation of the function and method ParseGlob. (Lines 461-474 of template.go)\nfunc parseGlob(t *Template, pattern string) (*Template, error) {\n    if err := t.checkCanParse(); err != nil {\n        return nil, err\n    }\n    filenames, err := filepath.Glob(pattern) // &lt;- right here\n    if err != nil {\n        return nil, err\n    }\n    if len(filenames) == 0 {\n        return nil, fmt.Errorf(\"html/template: pattern matches no files: %#q\", pattern)\n    }\n    return parseFiles(t, filenames...)\n}\n</code></pre>\n\n<p>So it follows those same rules:</p>\n\n<pre><code>// Glob returns the names of all files matching pattern or nil\n// if there is no matching file. The syntax of patterns is the same\n// as in Match. The pattern may describe hierarchical names such as\n// /usr/*/bin/ed (assuming the Separator is '/').\n//\n// Glob ignores file system errors such as I/O errors reading directories.\n// The only possible returned error is ErrBadPattern, when pattern\n// is malformed. (Lines 226-233 path/filepath/match.go)\n</code></pre>\n\n<p>The discription of Match is:</p>\n\n<pre><code>// Match reports whether name matches the shell file name pattern.\n// The pattern syntax is:\n//\n//  pattern:\n//      { term }\n//  term:\n//      '*'         matches any sequence of non-Separator characters\n//      '?'         matches any single non-Separator character\n//      '[' [ '^' ] { character-range } ']'\n//                  character class (must be non-empty)\n//      c           matches character c (c != '*', '?', '\\\\', '[')\n//      '\\\\' c      matches character c\n//\n//  character-range:\n//      c           matches character c (c != '\\\\', '-', ']')\n//      '\\\\' c      matches character c\n//      lo '-' hi   matches character c for lo &lt;= c &lt;= hi\n//\n// Match requires pattern to match all of name, not just a substring.\n// The only possible returned error is ErrBadPattern, when pattern\n// is malformed.\n//\n// On Windows, escaping is disabled. Instead, '\\\\' is treated as\n// path separator.\n//\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9551520, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "talsa", "link": "https://stackoverflow.com/users/9551520/talsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 628, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1539494309, "creation_date": 1522165251, "last_edit_date": 1539494309, "question_id": 49517158, "link": "https://stackoverflow.com/questions/49517158/golang-parsing-all-templates-which-are-in-different-directories", "title": "Golang: Parsing all templates which are in different directories?", "body": "<p>This is my directory structure:</p>\n\n<pre><code>[root@abc]# ll\ndrwxr-xr-x. 2 root root  133 Mar 26 16:13 credit\ndrwxr-xr-x. 2 root root  132 Mar 26 16:17 form\n-rw-r--r--. 1 root root 6003 Mar 27 19:30 main.go\n</code></pre>\n\n<p><code>var tmpl = template.Must(template.ParseGlob(\"form/*\"))</code> parses all files inside <strong>form</strong> directory. How to parse <strong>credit</strong> directory files also ?</p>\n\n<pre><code>var tmpl = template.Must(template.ParseGlob(\"form/*\",\"credit/*\"))\n</code></pre>\n\n<p>doesn't work.</p>\n"}, {"tags": ["html", "reactjs", "go", "video"], "comments": [{"owner": {"reputation": 5420, "user_id": 1407939, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/be9333ffe4ada8a5de0b658f764439da?s=128&d=identicon&r=PG", "display_name": "Dario", "link": "https://stackoverflow.com/users/1407939/dario"}, "edited": false, "score": 0, "creation_date": 1522165667, "post_id": 49517109, "comment_id": 86039897, "body": "It looks like you are passing a HTML page to <code>url</code> parameter and not a video URL. Shouldn&#39;t you pass <code>url=&#39;&#47;video&#47;87.mp4&#39;</code> ?"}, {"owner": {"reputation": 1, "user_id": 9559249, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Iordanis Paschalidis", "link": "https://stackoverflow.com/users/9559249/iordanis-paschalidis"}, "reply_to_user": {"reputation": 5420, "user_id": 1407939, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/be9333ffe4ada8a5de0b658f764439da?s=128&d=identicon&r=PG", "display_name": "Dario", "link": "https://stackoverflow.com/users/1407939/dario"}, "edited": false, "score": 0, "creation_date": 1522166986, "post_id": 49517109, "comment_id": 86040766, "body": "thanks for that so what I did and now its working fine is the following:  changed             &lt;ReactPlayer url=&#39;<a href=\"http://localhost:8080/ex\" rel=\"nofollow noreferrer\">localhost:8080/ex</a>&#39; playing controls height=&#39;400&#39;/&gt;   to               &lt;ReactPlayer url=&#39;<a href=\"http://localhost:8080/video/87.mp4\" rel=\"nofollow noreferrer\">localhost:8080/video/87.mp4</a>&#39; playing controls height=&#39;400&#39;/&gt;"}], "owner": {"reputation": 1, "user_id": 9559249, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Iordanis Paschalidis", "link": "https://stackoverflow.com/users/9559249/iordanis-paschalidis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1377, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522165113, "creation_date": 1522165113, "question_id": 49517109, "link": "https://stackoverflow.com/questions/49517109/react-player-not-playing-video-tag-from-html", "title": "react-player not playing &lt;video&gt; tag from html", "body": "<p>I have create a static web page with golang</p>\n\n<pre><code>package main\n\nimport (\n  \"log\"\n  \"net/http\"\n  \"html/template\"\n)\n\nfunc ex(w http.ResponseWriter, r *http.Request) {\n    t, _ := template.ParseFiles(\"static/example.html\")\n    t.Execute(w, nil)\n}\n\nfunc main() {\n  fs := http.FileServer(http.Dir(\"static\"))\n  http.Handle(\"/\", fs)\n  imagesHandler := http.FileServer(http.Dir(\"./video/\"))\n  http.Handle(\"/video/\", http.StripPrefix(\"/video/\", imagesHandler))\n    http.HandleFunc(\"/ex\", ex)\n\n  log.Println(\"Listening...\")\n  http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>example.html:</p>\n\n<pre><code>&lt;!doctype html&gt;\n&lt;video width=\"320\" height=\"240\" controls&gt;\n  &lt;source src=\"/video/87.mp4\" type=\"video/mp4\"&gt;\n&lt;/video&gt;\n</code></pre>\n\n<p>So if I go to localhost:8080/ex on my browser I can see the video playing and everything</p>\n\n<p>in my react app I am doing the following (I am using import ReactPlayer from 'react-player')</p>\n\n<pre><code>render() {\n        return (\n            &lt;ReactPlayer url='http://localhost:8080/ex' playing controls height='400'/&gt;\n        )\n    }\n</code></pre>\n\n<p>The video is not working - if I change the url with a youtube video it is working fine. Could you assist me on that</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "yaml"], "comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1522164405, "post_id": 49516571, "comment_id": 86039017, "body": "Please share what you have tried..."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "edited": false, "score": 0, "creation_date": 1522170284, "post_id": 49517715, "comment_id": 86042829, "body": "Thanks 1+, my yaml is valid, maybe the copy to the question change it, but I was able to parse it, otherwise I guess ill get and error if the Unmarshal will failed...any idea what it could be ?"}], "tags": [], "owner": {"reputation": 1445, "user_id": 5972487, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/024fcbdd0ee00e2dccefce0ef67bc434?s=128&d=identicon&r=PG", "display_name": "elmiomar", "link": "https://stackoverflow.com/users/5972487/elmiomar"}, "is_accepted": false, "score": 0, "last_activity_date": 1522166922, "creation_date": 1522166922, "answer_id": 49517715, "question_id": 49516571, "link": "https://stackoverflow.com/questions/49516571/parse-yaml-return-empty-object/49517715#49517715", "title": "Parse yaml return empty object", "body": "<p>Make sure your yaml file is formatted correctly. Check with this <a href=\"http://www.yamllint.com/\" rel=\"nofollow noreferrer\">tool</a>.</p>\n\n<p>The following piece of code worked fine.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"gopkg.in/yaml.v2\"\n    \"log\"\n)\n\ntype Runs struct {\n    Name   string\n    Type   string\n    Path   string   `yaml:\"path,omitempty\"`\n    Builds []Builds `yaml:\u201dbuilds,omitempty\"`\n}\n\ntype Builds struct {\n    Name       string     `yaml:\"name,omitempty\"`\n    Properties Properties `yaml:\"properties,omitempty\"`\n}\n\ntype Properties map[string]string\n\nfunc main() {\n    data := `builds: \n  - \n    name: db\n    properties: \n      JBR_CONFIG_RESOURCE_CONFIG: \"[META-INF/context.xml: {\\\"service_name\\\" : \\\"~{h-container}\\\"}]\"\n      TEST2: aaaa\nname: srv\npath: srv\ntype: java\n`\n\n    runs := Runs{}\n\n    err := yaml.Unmarshal([]byte(data), &amp;runs)\n    if err != nil {\n        log.Fatalf(\"error: %v\", err)\n    }\n    fmt.Printf(\"--- t:\\n%v\\n\\n\", runs)\n    d, err := yaml.Marshal(&amp;runs)\n    if err != nil {\n        log.Fatalf(\"error: %v\", err)\n    }\n    fmt.Printf(\"--- t dump:\\n%s\\n\\n\", string(d))\n}\n</code></pre>\n\n<p>I hope this helps!</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "edited": false, "score": 0, "creation_date": 1522170316, "post_id": 49518065, "comment_id": 86042847, "body": "Thanks 1+, my yaml is valid, maybe the copy to the question change it, but I was able to parse it, otherwise I guess ill get and error if the Unmarshal will failed...any idea what it could be ?  do you change someting in the struct ?"}, {"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1522170976, "post_id": 49518065, "comment_id": 86043185, "body": "If you not explicity check if <code>yaml.Unmarshal</code> return err your code will go with empty <code>Runs</code>. I added this if check to my code"}, {"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1522171208, "post_id": 49518065, "comment_id": 86043310, "body": "Sure you can send me it"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "edited": false, "score": 0, "creation_date": 1522171259, "post_id": 49518065, "comment_id": 86043337, "body": "can I sent it via chat or something else ?"}, {"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1522171477, "post_id": 49518065, "comment_id": 86043454, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/167667/discussion-between-ttomalak-and-rayn-d\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "is_accepted": true, "score": 1, "last_activity_date": 1522171171, "last_edit_date": 1522171171, "creation_date": 1522168118, "answer_id": 49518065, "question_id": 49516571, "link": "https://stackoverflow.com/questions/49516571/parse-yaml-return-empty-object/49518065#49518065", "title": "Parse yaml return empty object", "body": "<p>Properly formated yaml is the first thing that you should consider.\nIf u wanna have one <code>Runs</code> you should have your yaml formated something like that</p>\n\n<pre><code>name: srv\nbuilds:\n  -\n    name: db\n    properties:\n      JBR_CONFIG_RESOURCE_CONFIG: \"[META-INF/context.xml:\n      {\\\"service_name\\\" : \\\"~{h-container}\\\"}]\"\n      TEST2: aaaa\npath: srv\ntype: java\n</code></pre>\n\n<p>But then i u wanna have more of this object you need to group them in one parameter. It can look like this</p>\n\n<pre><code>runs:\n  -\n    name: srv\n    builds:\n      -\n        name: db\n        properties:\n          JBR_CONFIG_RESOURCE_CONFIG: \"[META-INF/context.xml:\n          {\\\"service_name\\\" : \\\"~{h-container}\\\"}]\"\n          TEST2: aaaa\n    path: srv\n    type: java\n  -\n    name: srv2\n    builds:\n      -\n        name: db2\n        properties:\n          JBR_CONFIG_RESOURCE_CONFIG: \"[META-INF/context.xml:\n          {\\\"service_name\\\" : \\\"~{h-container}\\\"}]\"\n          TEST2: aaaa2\n    path: srv2\n    type: java2\n</code></pre>\n\n<p>And then in your code could look like this</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"gopkg.in/yaml.v2\"\n    \"io/ioutil\"\n    \"log\"\n    \"os\"\n)\n\ntype Document struct {\n    Runs []Runs `yaml:\"runs,omitempty\"`\n}\ntype Runs struct {\n    Name   string   `yaml:\"name,omitempty\"`\n    Type   string   `yaml:\"type,omitempty\"`\n    Path   string   `yaml:\"path,omitempty\"`\n    Builds []Builds `yaml:\"builds,omitempty\"`\n}\n\ntype Builds struct {\n    Name       string            `yaml:\"name,omitempty\"`\n    Properties map[string]string `yaml:\"properties,omitempty\"`\n}\n\nfunc main() {\n\n    var document Document\n    reader, err := os.Open(\"demo.yml\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    buf, _ := ioutil.ReadAll(reader)\n    yaml.Unmarshal(buf, &amp;document)\n    if err := yaml.Unmarshal(buf, &amp;document); err != nil {\n        fmt.Print(err)\n        os.Exit(1)\n    }\n    fmt.Println(document)\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2287, "favorite_count": 0, "accepted_answer_id": 49518065, "answer_count": 2, "score": 1, "last_activity_date": 1522171171, "creation_date": 1522163488, "last_edit_date": 1522168971, "question_id": 49516571, "link": "https://stackoverflow.com/questions/49516571/parse-yaml-return-empty-object", "title": "Parse yaml return empty object", "body": "<p>I have the following yaml which I need to parse to struct.\nIn the builds property I got empty value while debug, what am I missing here? </p>\n\n<p>I use \"gopkg.in/yaml.v2\"</p>\n\n<pre><code>- name: srv\n    type: java\n    path: srv\n    builds:\n     - name: db\n        properties:\n           JBR_CONFIG_RESOURCE_CONFIG: '[META-INF/context.xml:\n              {\"service_name\" : \"~{h-container}\"}]'\n           TEST2: aaaa\n</code></pre>\n\n<p>The struct is </p>\n\n<pre><code>type Runs struct {\n    Name       string\n    Type       string\n    Path       string     `yaml:\"path,omitempty\"`\n    Builds   []Builds `yaml:\u201dbuilds,omitempty\"`\n}\n\ntype Builds struct {\n    Name       string     `yaml:\"name,omitempty\"`\n    Properties Properties `yaml:\"properties,omitempty\"`\n}\n\ntype Properties map[string]string\n</code></pre>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3", "aws-lambda", "aws-sdk-go"], "comments": [{"owner": {"reputation": 2659, "user_id": 958616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9e6338a12bed941f746f7449baf3b10?s=128&d=identicon&r=PG", "display_name": "raevilman", "link": "https://stackoverflow.com/users/958616/raevilman"}, "edited": false, "score": 0, "creation_date": 1522163795, "post_id": 49516525, "comment_id": 86038560, "body": "Why not separate lambdas for separate event type?"}, {"owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "reply_to_user": {"reputation": 2659, "user_id": 958616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9e6338a12bed941f746f7449baf3b10?s=128&d=identicon&r=PG", "display_name": "raevilman", "link": "https://stackoverflow.com/users/958616/raevilman"}, "edited": false, "score": 0, "creation_date": 1522164572, "post_id": 49516525, "comment_id": 86039118, "body": "Creating different lambda function would require maintaining that many functions. All of which will do the same job. Currently, I do not have CI setup for deployment so changing code or configuration would require manual setup for all as well."}, {"owner": {"reputation": 422, "user_id": 6037139, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155968228550094/picture?type=large", "display_name": "Harris Lummis", "link": "https://stackoverflow.com/users/6037139/harris-lummis"}, "edited": false, "score": 0, "creation_date": 1555116008, "post_id": 49516525, "comment_id": 98010058, "body": "Another reason might be for a lambda function that&#39;s part of a VPC. To avoid incurring a VPC cold start delay it may be nice to have a scheduled ping event to keep the function warm alongside whatever type of event that we actually want the function to handle."}], "answers": [{"comments": [{"owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "edited": false, "score": 0, "creation_date": 1522180301, "post_id": 49517709, "comment_id": 86048480, "body": "I was actually looking for some way where SDK provides the functionality to add multiple triggers. In my current use case, there is a possibility to add more trigger. So, I cannot hardcode one type of event as it is done in the example given in the link provided by you. However, link given by you helped me understand what can be put as input event and thanks for that."}, {"owner": {"reputation": 2659, "user_id": 958616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9e6338a12bed941f746f7449baf3b10?s=128&d=identicon&r=PG", "display_name": "raevilman", "link": "https://stackoverflow.com/users/958616/raevilman"}, "reply_to_user": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "edited": false, "score": 1, "creation_date": 1522219815, "post_id": 49517709, "comment_id": 86061215, "body": "Lambda SDK tries to map event(json from source) directly to specified type in lambda handler. So not possible from SDK. You can write your own utility library(wrapper) to do this and improve that as more requirement comes in future. E.g in one of my project there was a need to maintain state for tracing purpose. So I wrote one super lambda with required functionality and now all my other lambdas are extending from that. you can think of having one facing lambda, only taking String as the event and then you do all checks suggested in the answer and forward it to right handler. Hope it helps."}], "tags": [], "owner": {"reputation": 2659, "user_id": 958616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9e6338a12bed941f746f7449baf3b10?s=128&d=identicon&r=PG", "display_name": "raevilman", "link": "https://stackoverflow.com/users/958616/raevilman"}, "is_accepted": false, "score": 0, "last_activity_date": 1522166904, "creation_date": 1522166904, "answer_id": 49517709, "question_id": 49516525, "link": "https://stackoverflow.com/questions/49516525/how-to-support-more-than-one-trigger-in-aws-lambda-in-golang/49517709#49517709", "title": "How to support more than one trigger in AWS Lambda in Golang?", "body": "<p>I'm not a GoLang guy. Just guessing on normal programming thinking.  </p>\n\n<p>In approach one, you are directly calling ProcessIncomingS3Events in first statement, so every time this is called.  </p>\n\n<p>Read <a href=\"https://docs.aws.amazon.com/lambda/latest/dg/go-programming-model-handler-types.html\" rel=\"nofollow noreferrer\">this</a> - Lambda Function Handler (Go)  </p>\n\n<p>In above link, the author is parsing event's name field. Similarly, you can check for any field which is always present in S3 event e.g. \"eventSource\":\"aws:s3\" (S3 event structure see <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/dev/notification-content-structure.html\" rel=\"nofollow noreferrer\">here</a>)  </p>\n\n<p>If present then S3 event else other. Or you can also check for SQS event's field.  </p>\n\n<p>HIH</p>\n"}, {"tags": [], "owner": {"reputation": 391, "user_id": 4375384, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_RqBl08cXag/AAAAAAAAAAI/AAAAAAAAAH4/YeJ8_X9cdiw/photo.jpg?sz=128", "display_name": "Noah Zoschke", "link": "https://stackoverflow.com/users/4375384/noah-zoschke"}, "is_accepted": false, "score": 1, "last_activity_date": 1522420966, "creation_date": 1522420966, "answer_id": 49576456, "question_id": 49516525, "link": "https://stackoverflow.com/questions/49516525/how-to-support-more-than-one-trigger-in-aws-lambda-in-golang/49576456#49576456", "title": "How to support more than one trigger in AWS Lambda in Golang?", "body": "<p>You can configure multiple event sources to trigger one or more Lambda functions.</p>\n\n<p>However, in Go the <code>lambda.Start</code> call is blocking so it's not very easy to write a single function that handles multiple event types. You are strongly encouraged to make a separate Lambda function for every event source.</p>\n\n<p>The idiomatic Go solution is to have your function logic defined once in the main package, and write multiple programs that take the source event and call your function. So the project layout would be:</p>\n\n<ul>\n<li>s3copy/main.go</li>\n<li>s3copy/handlers/s3/main.go</li>\n<li>s3copy/handlers/sqs/main.go</li>\n</ul>\n\n<p>See my <a href=\"https://github.com/nzoschke/gofaas\" rel=\"nofollow noreferrer\">boilerplate Lambda and Go app</a> for an example project layout and Makefile.</p>\n"}, {"tags": [], "owner": {"reputation": 1022, "user_id": 4648184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/530bad0fba2d3c48393c99f66e04b7dd?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo Flores", "link": "https://stackoverflow.com/users/4648184/pablo-flores"}, "is_accepted": false, "score": 3, "last_activity_date": 1538258918, "creation_date": 1538258918, "answer_id": 52572943, "question_id": 49516525, "link": "https://stackoverflow.com/questions/49516525/how-to-support-more-than-one-trigger-in-aws-lambda-in-golang/52572943#52572943", "title": "How to support more than one trigger in AWS Lambda in Golang?", "body": "<p>I achieved to listen to multiple events by implementing the aws Handler interface, it defines one method </p>\n\n<pre><code>Invoke(ctx context.Context, payload []byte) ([]byte, error)\n</code></pre>\n\n<p>I implemented a multievent Handler as follows</p>\n\n<pre><code>type Handler struct {\n//add global variables or context information that your handler may need\n}\n\nfunc (h Handler) Invoke(ctx context.Context, data []byte) ([]byte, error) {\n  //for demonstration purposes, not the best way to handle\n  apiGatewayEvent := new(events.APIGatewayProxyRequest)\n  if err := json.Unmarshal(data, apiGatewayEvent); err != nil {\n    log.Println(\"Not a api gateway event\")\n  }\n  snsEvent := new(events.SNSEvent)\n  if err := json.Unmarshal(data, snsEvent); err != nil {\n    log.Println(\"Not a sns event\")\n  }\n  return nil, nil\n}\n\nfunc main() {\n  lambda.StartHandler(Handler{})\n}\n</code></pre>\n\n<p>As you can see, you could get the raw bytes of any event and handle them as you need giving you the possibility to listen to any aws event with the same lambda. However, think carefully before using this aproach, because, as noted above, lambdas are best used handling just one type of event</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5793, "favorite_count": 5, "answer_count": 3, "score": 8, "last_activity_date": 1538258918, "creation_date": 1522163350, "last_edit_date": 1522483400, "question_id": 49516525, "link": "https://stackoverflow.com/questions/49516525/how-to-support-more-than-one-trigger-in-aws-lambda-in-golang", "title": "How to support more than one trigger in AWS Lambda in Golang?", "body": "<p>I am building an AWS Lambda function in Golang that copy the content from n to m S3 buckets. There is a requirement to support for S3 trigger as well as fetching the data from an SQS where all source S3 bucket change is stored. The code can be found here: <a href=\"https://github.com/maknahar/s3copy\" rel=\"noreferrer\">https://github.com/maknahar/s3copy</a></p>\n\n<p>I tried following:</p>\n\n<pre><code>func main() {\n    lambda.Start(ProcessIncomingS3Events)\n    lambda.Start(ProcessIncomingEvents)\n}\n\nfunc ProcessIncomingS3Events(event events.S3Event) error {\n    ...\n    log.Println(\"Got S3 Event\")\n    return processS3Trigger(config, event)\n}\n\nfunc ProcessIncomingEvents() error {\n    ...\n    log.Println(\"Defaulting to SQS\")\n    return processSQSMessage(config)\n}\n</code></pre>\n\n<p>In this case, the first event <code>ProcessIncomingS3Events</code> is triggered every time.</p>\n\n<p>I tried following as well</p>\n\n<pre><code>func main() {\n    lambda.Start(ProcessIncomingEvents)\n}\n\nfunc ProcessIncomingEvents(event interface{}) error {\n    ...\n    switch request := event.(type) {\n    case events.S3Event:\n        log.Println(\"Got S3 Event\")\n        return processS3Trigger(config, request)\n\n    case types.Nil:\n        log.Println(\"Defaulting to SQS\")\n        return processSQSMessage(config)\n\n    default:\n        log.Println(\"Could not find the event type\")\n\n    }\n\n    return nil\n}\n</code></pre>\n\n<p>In this case, Lambda could not detect the type and <code>Could not find the event type</code> is logged in every trigger.</p>\n\n<p>Is there a way to support multiple triggers via AWS SDK at all for the function?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1522160963, "post_id": 49514533, "comment_id": 86036151, "body": "Don&#39;t enforce singletons, for the same reasons that you should avoid global; it makes testing needlessly complicated. You can use <a href=\"https://golang.org/pkg/sync/#Once\" rel=\"nofollow noreferrer\">sync.Once</a> to turn anything into a singleton at the call site. Loading a config only once is even described in the docs for sync.Once."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1522165317, "post_id": 49514533, "comment_id": 86039669, "body": "@RelaxZeroC you could also do something like this: <a href=\"https://play.golang.org/p/PSdC9p-JX-l\" rel=\"nofollow noreferrer\">play.golang.org/p/PSdC9p-JX-l</a>"}, {"owner": {"reputation": 547, "user_id": 7454513, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/1c40d207c95a5dc082f33e83c2a4af74?s=128&d=identicon&r=PG&f=1", "display_name": "Relax ZeroC", "link": "https://stackoverflow.com/users/7454513/relax-zeroc"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1522196574, "post_id": 49514533, "comment_id": 86054418, "body": "Thansk @Peter , mkopriva ! This is very helpful to me"}], "answers": [{"comments": [{"owner": {"reputation": 547, "user_id": 7454513, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/1c40d207c95a5dc082f33e83c2a4af74?s=128&d=identicon&r=PG&f=1", "display_name": "Relax ZeroC", "link": "https://stackoverflow.com/users/7454513/relax-zeroc"}, "edited": false, "score": 0, "creation_date": 1522158908, "post_id": 49514668, "comment_id": 86034443, "body": "thanks your comment  , then , how can I just load each config once ? if I return Config1/2 object , I don&#39;t want to create a new object every time"}], "tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": false, "score": 1, "last_activity_date": 1522160693, "last_edit_date": 1522160693, "creation_date": 1522158433, "answer_id": 49514668, "question_id": 49514533, "link": "https://stackoverflow.com/questions/49514533/how-to-handle-multiple-config/49514668#49514668", "title": "How to handle multiple config", "body": "<p>Above code will not work. It will throw an error saying</p>\n\n<blockquote>\n  <p>LoadConfig redeclared in this block</p>\n</blockquote>\n\n<p>Because</p>\n\n<blockquote>\n  <p>Go does not allow to create function with same name. We can create\n  method with same name having different receivers.</p>\n</blockquote>\n\n<p>Create receiver for config1 and config2 with same method name.</p>\n\n<pre><code>type Config1 struct {\n    //some config items\n}\ntype Config2 struct {\n    //some config items\n}\n\nfunc (config1 *Config1) LoadConfig() {\n    configor.Load(config1, \"MY/CONFIG1/PATH\")\n}\n\nfunc (config2 *Config2) LoadConfig() {\n    configor.Load(config2, \"MY/CONFIG2/PATH\")\n}\n</code></pre>\n\n<p>For creating an object each time you can create a function to check if instance already exists like that.</p>\n\n<pre><code>type Config1 struct {\n}\n\nvar instance *Config1\n\nfunc GetInstance() *Config1 {\n    if instance == nil {\n        instance = &amp;Config1{}   // &lt;--- NOT THREAD SAFE\n    }\n    return instance\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "is_accepted": true, "score": 2, "last_activity_date": 1522192625, "last_edit_date": 1522192625, "creation_date": 1522160843, "answer_id": 49515555, "question_id": 49514533, "link": "https://stackoverflow.com/questions/49514533/how-to-handle-multiple-config/49515555#49515555", "title": "How to handle multiple config", "body": "<p>Use the <code>sync</code> package to make sure config is only loaded once.</p>\n\n<p>Example:</p>\n\n<pre><code>import \"sync\"\n\nvar (\n    c Config1\n    once sync.Once\n    loadFunc = func() {\n        configor.Load(&amp;c, \"MY/CONFIG1/PATH\")\n    }\n)\n\nfunc LoadConfig() Config1 {\n    once.Do(loadFunc)\n    return c\n}\n</code></pre>\n\n<p>Any subsequent calls to <code>LoadConfig</code> will be ignored. For example:</p>\n\n<pre><code>func main() {\n    c1 := LoadConfig() // Loaded, returns the value\n    c2 := LoadConfig() // Not loaded, returns the first loaded value\n    c3 := LoadConfig() // Not loaded, returns the first loaded value\n}\n</code></pre>\n"}], "owner": {"reputation": 547, "user_id": 7454513, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/1c40d207c95a5dc082f33e83c2a4af74?s=128&d=identicon&r=PG&f=1", "display_name": "Relax ZeroC", "link": "https://stackoverflow.com/users/7454513/relax-zeroc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 49515555, "answer_count": 2, "score": 0, "last_activity_date": 1522192625, "creation_date": 1522158119, "last_edit_date": 1522160382, "question_id": 49514533, "link": "https://stackoverflow.com/questions/49514533/how-to-handle-multiple-config", "title": "How to handle multiple config", "body": "<p>Is there a good way to reuse the code to read different configurations?</p>\n\n<p>btw: I used config lib is <code>configor</code></p>\n\n<p>the code maybe like, </p>\n\n<pre><code>type Config1 struct {\n    //some config items\n}\ntype Config2 struct {\n    //some config items\n}\n\nfunc LoadConfig1() Config1 {\n    var c Config1\n    configor.Load(&amp;c, \"MY/CONFIG1/PATH\")\n    return c\n}\n\nfunc LoadConfig1() Config2 {\n    var c Config2\n    configor.Load(&amp;c, \"MY/CONFIG2/PATH\")\n    return c\n}\n</code></pre>\n\n<ol>\n<li>Can I reuse LoadConfig with Config1/Config2? </li>\n<li>Can I design an object like <code>singleton</code> to create Config1/Config2 just once.</li>\n</ol>\n"}, {"tags": ["http", "go", "cookies", "client"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 6, "last_activity_date": 1522145957, "last_edit_date": 1522145957, "creation_date": 1522144896, "answer_id": 49509905, "question_id": 49509640, "link": "https://stackoverflow.com/questions/49509640/how-to-set-cookiejar-globally-so-that-the-cookies-are-present-in-every-http-clie/49509905#49509905", "title": "How to set cookiejar globally so that the cookies are present in every http.Client request", "body": "<p><a href=\"https://golang.org/pkg/net/http/#Client\" rel=\"nofollow noreferrer\"><code>http.Client</code></a> is designed to be reused:</p>\n\n<blockquote>\n  <p>The Client's Transport typically has internal state (cached TCP connections), so <strong>Clients should be reused instead of created as needed. Clients are safe for concurrent use by multiple goroutines.</strong></p>\n</blockquote>\n\n<p>So simply just create / configure an <code>http.Client</code>, and reuse it everywhere where you want your cookiejar to work.</p>\n\n<p>If one configured <code>http.Client</code> doesn't fit all your use cases, then create as many clients that do. To ensure the same cookiejar is used, you may create a client \"factory\" function which ensures the returned <code>http.Client</code> will have the Jar set.</p>\n"}, {"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 1, "last_activity_date": 1522145094, "creation_date": 1522145094, "answer_id": 49509984, "question_id": 49509640, "link": "https://stackoverflow.com/questions/49509640/how-to-set-cookiejar-globally-so-that-the-cookies-are-present-in-every-http-clie/49509984#49509984", "title": "How to set cookiejar globally so that the cookies are present in every http.Client request", "body": "<p>Undoable (at least you cannot <em>force</em> the use of your client).</p>\n\n<p>Nearest is injecting your client into net/http.DefaultClient.</p>\n\n<p>Most sensible is to use icza's solution.</p>\n"}], "owner": {"reputation": 15, "user_id": 9520935, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Hntxyjh6Tig/AAAAAAAAAAI/AAAAAAAAAC8/Nd4Dyo9Onac/photo.jpg?sz=128", "display_name": "sac dh22", "link": "https://stackoverflow.com/users/9520935/sac-dh22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1312, "favorite_count": 0, "accepted_answer_id": 49509905, "answer_count": 2, "score": 1, "last_activity_date": 1522147599, "creation_date": 1522144173, "last_edit_date": 1522147599, "question_id": 49509640, "link": "https://stackoverflow.com/questions/49509640/how-to-set-cookiejar-globally-so-that-the-cookies-are-present-in-every-http-clie", "title": "How to set cookiejar globally so that the cookies are present in every http.Client request", "body": "<p>I am new here and a bit confused with setting cookie jar  gloabally. I am using cookiejar from the http package and this is my implementation from other docs available in setting the cookies as jar in http.Client.</p>\n\n<pre><code>    jar, _ := cookiejar.New(nil)\n    client := &amp;http.Client{\n      Jar: jar,\n    }\n    req, _ := http.NewRequest(\"GET\", request_url, nil)\n    q := req.URL.Query()\n    q.Add(\"authtoken\", token)\n    req.Header.Add(\"Content-Type\", \"application/x-www-form-urlencoded\")\n    req.URL.RawQuery = q.Encode()\n    res, _ := client.Do(req)\n    defer res.Body.Close() \n    fmt.Println(res.Cookies()) // can see the cookies here\n</code></pre>\n\n<p>What I am trying to achieve here is to have this declared gloabally so that once the jar is set the subsequent client request will have the cookies.\nIf I place it in any other function it gets sets to nil again.</p>\n\n<pre><code>    jar, _ := cookiejar.New(nil)\n    client := &amp;http.Client{\n      Jar: jar,\n    }\n</code></pre>\n\n<p>Any best practise available in how to do this? \nThank you.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1522144844, "post_id": 49509638, "comment_id": 86023789, "body": "first check environment variables using <code>go env</code> to check the <code>gopath</code> and <code>goroot</code>"}, {"owner": {"reputation": 996, "user_id": 4909445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ded7e867ff7001048e511974d4c19137?s=128&d=identicon&r=PG&f=1", "display_name": "Shettyh", "link": "https://stackoverflow.com/users/4909445/shettyh"}, "edited": false, "score": 0, "creation_date": 1522144913, "post_id": 49509638, "comment_id": 86023853, "body": "More details on the errors you are getting may help answering this question"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1522145212, "post_id": 49509638, "comment_id": 86024086, "body": "Best advice is: Ask the person who is teaching you."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1522145678, "post_id": 49509638, "comment_id": 86024446, "body": "Regarding &quot;too large&quot;, that <a href=\"https://stackoverflow.com/q/49492026/720999\">was already asked</a>. Regarding errors, we need to see <i>what exact errors.</i>"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1522147351, "post_id": 49509638, "comment_id": 86025611, "body": "Add the output from the <code>go version</code> and <code>go env</code> commands` to your question."}, {"owner": {"reputation": 4408, "user_id": 4916627, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Ainvx.jpg?s=128&g=1", "display_name": "Andr&#233; Kool", "link": "https://stackoverflow.com/users/4916627/andr%c3%a9-kool"}, "edited": false, "score": 3, "creation_date": 1535448273, "post_id": 49509638, "comment_id": 91058979, "body": "Please do not vandalize your posts. If you believe your question is not useful or is no longer useful, it should be deleted instead of editing out all of the data that actually makes it a question. By posting on the Stack Exchange network, you&#39;ve granted a non-revocable right for SE to distribute that content (under the CC BY-SA 3.0 license). By SE policy, any vandalism will be reverted."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1535448859, "post_id": 49509638, "comment_id": 91059333, "body": "Mor important than the compiler version should be the OS. Looks like an XY problem and a communication problem. You should talk to your tutor, if you can&#39;t get a different tutor."}, {"owner": {"reputation": 17301, "user_id": 239247, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9d7e611f31c52f4d62bbe279d4f334de?s=128&d=identicon&r=PG", "display_name": "anatoly techtonik", "link": "https://stackoverflow.com/users/239247/anatoly-techtonik"}, "edited": false, "score": 0, "creation_date": 1590049480, "post_id": 49509638, "comment_id": 109534686, "body": "Because this question appears in search results, I need to redirect it to  <a href=\"https://stackoverflow.com/questions/18990242/find-out-the-version-of-go-a-binary-was-built-with\" title=\"find out the version of go a binary was built with\">stackoverflow.com/questions/18990242/&hellip;</a>"}, {"owner": {"reputation": 5539, "user_id": 871134, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/BKxlV.jpg?s=128&g=1", "display_name": "Deleplace", "link": "https://stackoverflow.com/users/871134/deleplace"}, "edited": false, "score": 0, "creation_date": 1614181535, "post_id": 49509638, "comment_id": 117308486, "body": "go version ./myprogram  (for programs compiled with a recente version of go)"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9547620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/984b0eadd2245200f253fa5224c72014?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewWilliams", "link": "https://stackoverflow.com/users/9547620/andrewwilliams"}, "edited": false, "score": 0, "creation_date": 1522204134, "post_id": 49509954, "comment_id": 86056068, "body": "you&#39;re a genius. Thank you so much for taking the time to reply. This was what i was looking for. &lt;3"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1522317855, "post_id": 49509954, "comment_id": 86113599, "body": "Actually the Go version used to compile the binary is recorded in the binary."}, {"owner": {"reputation": 1358, "user_id": 5275376, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a8bbb1e2df58ceebc9bbb5596bf823f3?s=128&d=identicon&r=PG&f=1", "display_name": "Shiva Kishore", "link": "https://stackoverflow.com/users/5275376/shiva-kishore"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1522392063, "post_id": 49509954, "comment_id": 86147083, "body": "Any idea on how to get that info @icza ?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1522410540, "post_id": 49509954, "comment_id": 86155027, "body": "@ShivaKishore <a href=\"https://dave.cheney.net/2017/06/20/how-to-find-out-which-go-version-built-your-binary\" rel=\"nofollow noreferrer\">Dave Cheney: How to find out which Go version built your binary</a>"}], "tags": [], "owner": {"reputation": 1358, "user_id": 5275376, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a8bbb1e2df58ceebc9bbb5596bf823f3?s=128&d=identicon&r=PG&f=1", "display_name": "Shiva Kishore", "link": "https://stackoverflow.com/users/5275376/shiva-kishore"}, "is_accepted": true, "score": 2, "last_activity_date": 1522433425, "last_edit_date": 1522433425, "creation_date": 1522145017, "answer_id": 49509954, "question_id": 49509638, "link": "https://stackoverflow.com/questions/49509638/how-to-determine-which-go-version-was-used-to-compile-a-binary/49509954#49509954", "title": "How to determine which Go version was used to compile a binary", "body": "<p>By doing <code>go build</code> you are creating a binary for the go program in that current folder.</p>\n\n<h2>Update</h2>\n\n<p><s>Once a binary file is created you <strong>cannot determine</strong> what version      of <code>Go</code> was used to create the binary.</s></p>\n\n<p>To Find the version of <code>GO</code> used for compiling use a debugger like <code>gdb</code> or others. Here is an awesome <a href=\"https://dave.cheney.net/2017/06/20/how-to-find-out-which-go-version-built-your-binary\" rel=\"nofollow noreferrer\">blog</a> about the same.</p>\n\n<p>And you can inspect the file with</p>\n\n<pre><code>file mybinary\n</code></pre>\n\n<p>to get info like the type of binary and like which OS it is supposed to run on.</p>\n\n<p>eg : <code>ELF</code> files run on <code>Linux</code><br>\n     <code>Mach-O</code> files run on <code>Mac</code> etc...</p>\n\n<p>However you can <code>cross compile</code> your Go code with</p>\n\n<pre><code>GOOS=linux go build\n</code></pre>\n\n<p>so this creates a binary for <code>linux (ELF file)</code> even though i run Go on <code>Mac</code> / <code>Windows</code></p>\n"}], "owner": {"reputation": 21, "user_id": 9547620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/984b0eadd2245200f253fa5224c72014?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewWilliams", "link": "https://stackoverflow.com/users/9547620/andrewwilliams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1267, "favorite_count": 0, "closed_date": 1535452047, "accepted_answer_id": 49509954, "answer_count": 1, "score": -4, "last_activity_date": 1590049384, "creation_date": 1522144158, "last_edit_date": 1590049384, "question_id": 49509638, "link": "https://stackoverflow.com/questions/49509638/how-to-determine-which-go-version-was-used-to-compile-a-binary", "closed_reason": "Needs details or clarity", "title": "How to determine which Go version was used to compile a binary", "body": "<p>When I run the command </p>\n\n<pre><code>go build\n</code></pre>\n\n<p>I end up with an application that's larger than needed, doesn't run and with lots of errors. I'm using the same source as everybody else and I understand the different OS make a difference, but should it affect the actual program and how it works? </p>\n\n<p>How do I find out what version of Go was used and which compiler was used on a already-compiled application? It's just a app file. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1358, "user_id": 5275376, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a8bbb1e2df58ceebc9bbb5596bf823f3?s=128&d=identicon&r=PG&f=1", "display_name": "Shiva Kishore", "link": "https://stackoverflow.com/users/5275376/shiva-kishore"}, "edited": false, "score": 2, "creation_date": 1522144331, "post_id": 49509550, "comment_id": 86023396, "body": "Please provide more information."}], "answers": [{"tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": false, "score": 0, "last_activity_date": 1522267186, "creation_date": 1522267186, "answer_id": 49543164, "question_id": 49509550, "link": "https://stackoverflow.com/questions/49509550/how-to-add-the-new-module-in-the-qor-admin-in-golang/49543164#49543164", "title": "How to add the new module in the qor/admin in golang?", "body": "<p>You use <code>go get github.com/qor/admin</code> to get the package.</p>\n\n<p>Then you import it with</p>\n\n<pre><code>import github.com/qor/admin\n</code></pre>\n\n<p>To see a sample check the github page of <a href=\"https://github.com/qor/admin\" rel=\"nofollow noreferrer\">qor/admin</a></p>\n"}], "owner": {"reputation": 5, "user_id": 2148133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdfa6ca8d70c987b7caa6171174b3f30?s=128&d=identicon&r=PG", "display_name": "rajendra", "link": "https://stackoverflow.com/users/2148133/rajendra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 376, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1531309207, "creation_date": 1522143934, "question_id": 49509550, "link": "https://stackoverflow.com/questions/49509550/how-to-add-the-new-module-in-the-qor-admin-in-golang", "title": "How to add the new module in the qor/admin in golang?", "body": "<p>I wanted to add the module to the qor/admin.I installed the qor/admin by using go get command.</p>\n"}, {"tags": ["go", "concurrency", "channels"], "answers": [{"comments": [{"owner": {"reputation": 3784, "user_id": 6182569, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/595afc3cb368ac51e5643e7e71dfdb4d?s=128&d=identicon&r=PG", "display_name": "Mihailo", "link": "https://stackoverflow.com/users/6182569/mihailo"}, "edited": false, "score": 0, "creation_date": 1522145505, "post_id": 49509906, "comment_id": 86024309, "body": "Great answer/summary. I have a question as well. Why would I want to use <code>sync&#47;atomic</code> package?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 3784, "user_id": 6182569, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/595afc3cb368ac51e5643e7e71dfdb4d?s=128&d=identicon&r=PG", "display_name": "Mihailo", "link": "https://stackoverflow.com/users/6182569/mihailo"}, "edited": false, "score": 2, "creation_date": 1522147042, "post_id": 49509906, "comment_id": 86025380, "body": "@Mihailo You do not want to use sync/atomic as it is ugly, complicated and error prone. As the documentation states sync/atomic provides primitives on which you can build usable things. Sometimes the overhead of channels, selects, etc. is too high and falling back to much faster primitives is needed or sensible. Package atomic is very fast but unusable."}, {"owner": {"reputation": 3784, "user_id": 6182569, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/595afc3cb368ac51e5643e7e71dfdb4d?s=128&d=identicon&r=PG", "display_name": "Mihailo", "link": "https://stackoverflow.com/users/6182569/mihailo"}, "edited": false, "score": 0, "creation_date": 1522147112, "post_id": 49509906, "comment_id": 86025440, "body": "Wow, I didn&#39;t know that. Thanks a bunch for the information, and the warning! Have a nice day."}, {"owner": {"reputation": 2067, "user_id": 5050577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6fad29dabd7e9a97a22e9ea535307165?s=128&d=identicon&r=PG&f=1", "display_name": "DanT29", "link": "https://stackoverflow.com/users/5050577/dant29"}, "edited": false, "score": 0, "creation_date": 1522147820, "post_id": 49509906, "comment_id": 86025940, "body": "That makes sense! I thought you had to have something like &quot;return out&quot; at the end of the publisher function. I&#39;ve seen functions that have goroutines within them return a channel. Is it necessary to this then, since the goroutine is going to be sending values to the channel anyways."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "reply_to_user": {"reputation": 2067, "user_id": 5050577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6fad29dabd7e9a97a22e9ea535307165?s=128&d=identicon&r=PG&f=1", "display_name": "DanT29", "link": "https://stackoverflow.com/users/5050577/dant29"}, "edited": false, "score": 0, "creation_date": 1522153639, "post_id": 49509906, "comment_id": 86030227, "body": "@DanT29, returning a channel is common when there is a single producer that produces an unbounded amount of data. <a href=\"https://play.golang.org/p/nTvZrq92q0X\" rel=\"nofollow noreferrer\">play.golang.org/p/nTvZrq92q0X</a>"}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 3, "last_activity_date": 1522144899, "creation_date": 1522144899, "answer_id": 49509906, "question_id": 49509446, "link": "https://stackoverflow.com/questions/49509446/confused-about-channel-argument-for-goroutines/49509906#49509906", "title": "Confused about channel argument for Goroutines", "body": "<p>You have <em>one</em> channel, it is made with <code>make</code> in main.</p>\n\n<p>This one single channel is named <code>in</code> in workerProcess and <code>out</code> in publisher. out is a function argument to publisher which answers question 1.</p>\n\n<p>Question 2: That's the <em>whole</em> purpose of a channel. What you stuff into a channel on its input side comes out at its output side. If a function has reference to (one end of) such a channel it may communicate with someone else having reference to the same channel (its other end). What producer <em>send</em> to the channel is <em>received</em> by workerProcess. This <em>send</em> and <em>receive</em> is done through the special operator <code>&lt;-</code> on Go. A fact you got slightly wrong in your explanation.</p>\n\n<p><code>out &lt;- data</code> takes data and sends it through the channel named out until <code>&lt;- in</code> reads it from the channel (remember in and out name the same channel from main). That's how workerProcess and publisher communicate.</p>\n\n<p>Question 3 is a duplicate. Your whole program terminates once main is done (in your case after 1 millisecond. Nothing happens after termination of the program. Give the program more time to execute. (The non-printing is unrelated to the channel).</p>\n"}], "owner": {"reputation": 2067, "user_id": 5050577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6fad29dabd7e9a97a22e9ea535307165?s=128&d=identicon&r=PG&f=1", "display_name": "DanT29", "link": "https://stackoverflow.com/users/5050577/dant29"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 49509906, "answer_count": 1, "score": 0, "last_activity_date": 1522144899, "creation_date": 1522143659, "last_edit_date": 1522144184, "question_id": 49509446, "link": "https://stackoverflow.com/questions/49509446/confused-about-channel-argument-for-goroutines", "title": "Confused about channel argument for Goroutines", "body": "<p>I am learning about channels and concurrency in Go and I am confused on how the code below works. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n    \"sync/atomic\"\n)\n\nvar workerID int64\nvar publisherID int64\n\nfunc main() {\n    input := make(chan string)\n    go workerProcess(input)\n    go workerProcess(input)\n    go workerProcess(input)\n    go publisher(input)\n    go publisher(input)\n    go publisher(input)\n    go publisher(input)\n    time.Sleep(1 * time.Millisecond)\n}\n\n// publisher pushes data into a channel\nfunc publisher(out chan string) {\n    atomic.AddInt64(&amp;publisherID, 1)\n    thisID := atomic.LoadInt64(&amp;publisherID)\n    dataID := 0\n    for {\n        dataID++\n        fmt.Printf(\"publisher %d is pushing data\\n\", thisID)\n        data := fmt.Sprintf(\"Data from publisher %d. Data %d\", thisID, dataID)\n        out &lt;- data\n    }\n}\n\nfunc workerProcess(in &lt;-chan string) {\n    atomic.AddInt64(&amp;workerID, 1)\n    thisID := atomic.LoadInt64(&amp;workerID)\n    for {\n        fmt.Printf(\"%d: waiting for input...\\n\", thisID)\n        input := &lt;-in\n        fmt.Printf(\"%d: input is: %s\\n\", thisID, input)\n    }\n}\n</code></pre>\n\n<p>This is what I understand please correct me if I'm wrong:</p>\n\n<p><strong><em>workerProcess Goroutine:</em></strong></p>\n\n<ol>\n<li><em>Input</em> channel taken as the argument which is assigned as the <em>in</em> channel.</li>\n<li>In the for loop, the first printf is executed. </li>\n<li>The value off the <em>in</em> channel is assigned to the variable <em>input</em>. </li>\n<li>The last printf is executed to show the value of thisID and input.(This doesn't really execute till after other Goroutines run). </li>\n</ol>\n\n<p><strong><em>publisher Goroutine:</em></strong></p>\n\n<ol>\n<li><em>Input</em> channel taken as the argument which is assigned as the <em>out</em> channel.</li>\n<li><p>In the for loop, dataID is incremented then first printf is executed.</p></li>\n<li><p>The string is assigned to data.</p></li>\n<li><p>The value of data is passed to out.</p></li>\n</ol>\n\n<p><strong>Questions:</strong></p>\n\n<ol>\n<li><p>Where is the value from <em>out</em> getting passed to in the publisher Goroutine? It seems to be only in the scope of the for loop, wouldn't this cause deadlock. Since this is an unbuffered channel. </p></li>\n<li><p>I don't get how the workerProcess gets the data from publisher if\nall the Goroutines in main have the arguments as the channel <em>input</em>. </p>\n\n<p>I'm used to having code written like this if the output of one function \nis used in another:</p>\n\n<p><code>foo = fcn1(input)\n fcn2(foo)</code></p></li>\n</ol>\n\n<p>I suspect it has something with how Goroutines run in the background but I'm not to sure I would appreciate an explanation. </p>\n\n<ol start=\"3\">\n<li>Why isn't the last printf statement in workerProcess not executed? My guess is the channel is empty, so it's waiting for a value. </li>\n</ol>\n\n<p>Part of the output:</p>\n\n<pre><code>1: waiting for input...\npublisher 1 is pushing data\npublisher 1 is pushing data\n1: input is: Data from publisher 1. Data 1\n1: waiting for input...\n1: input is: Data from publisher 1. Data 2\n1: waiting for input...\npublisher 1 is pushing data\npublisher 1 is pushing data\npublisher 2 is pushing data\n2: waiting for input..\n</code></pre>\n"}, {"tags": ["sockets", "go"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1522143350, "post_id": 49509208, "comment_id": 86022628, "body": "You can&#39;t. You can only use something rather less than 65535 local ports every two minutes, because of the TIME_WAIT state. If you need more, you&#39;re doing something wrong. Look into connection pooling."}, {"owner": {"reputation": 1011, "user_id": 1881641, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d8c2466a4bf038dc5617545698a97d5f?s=128&d=identicon&r=PG", "display_name": "what is what", "link": "https://stackoverflow.com/users/1881641/what-is-what"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1522143533, "post_id": 49509208, "comment_id": 86022752, "body": "@EJP I have set the tcp_tw_reuse option ,why can&#39;t I use these port"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1522143775, "post_id": 49509208, "comment_id": 86022951, "body": "Because of what I have already stated. I&#39;m not going to just repeat myself here. And, incidentally, because of what is already stated in your link, although it is about servers, not clients."}, {"owner": {"reputation": 1011, "user_id": 1881641, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d8c2466a4bf038dc5617545698a97d5f?s=128&d=identicon&r=PG", "display_name": "what is what", "link": "https://stackoverflow.com/users/1881641/what-is-what"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1522144673, "post_id": 49509208, "comment_id": 86023641, "body": "@kostix this range is limited,not very effective\uff0cjust want to know why so many port in timewait can not reuse with  tcp_tw_reuse set"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1522145006, "post_id": 49509208, "comment_id": 86023910, "body": "@whatiswhat, I&#39;ve misread your question, sorry. I&#39;d try looking at <code>SO_REUSEPORT</code> and/or <code>SO_LINGER</code> on your sockets. Start <a href=\"https://stackoverflow.com/a/14388707/720999\">here</a>. The basic idea is to either use <code>SO_LINGER</code> to individually make each ephemeral port die faster or pick a pool of, say, 2k ports, and bind each one on the client side with <code>SO_REUSEPORT</code> before connecting \u2014 effectively zapping any half-dead connection with the same port, if any."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1522148620, "post_id": 49509208, "comment_id": 86026512, "body": "Why are you setting <code>tcp_tw_recycle</code>? I\u2019ve never seen advice to try and use this, because it doesn\u2019t work as expected. It has actually been removed from the latest kernels since it\u2019s basically broken."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1522199151, "post_id": 49509208, "comment_id": 86054984, "body": "I would <i>not</i> look at SO_LINGER. It causes a &#39;connection reset&#39; at the peer, and all data in transit to be lost. @kostix"}], "answers": [{"tags": [], "owner": {"reputation": 3180, "user_id": 6716781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpIoT.jpg?s=128&g=1", "display_name": "Jonah Benton", "link": "https://stackoverflow.com/users/6716781/jonah-benton"}, "is_accepted": false, "score": 1, "last_activity_date": 1522206311, "creation_date": 1522206311, "answer_id": 49525404, "question_id": 49509208, "link": "https://stackoverflow.com/questions/49509208/how-can-i-make-large-number-of-connections-without-error-at-client-side/49525404#49525404", "title": "how can I make large number of connections without error at client side", "body": "<p>This is a good answer from 2012:</p>\n\n<p><a href=\"https://serverfault.com/questions/342741/what-are-the-ramifications-of-setting-tcp-tw-recycle-reuse-to-1#434669\">https://serverfault.com/questions/342741/what-are-the-ramifications-of-setting-tcp-tw-recycle-reuse-to-1#434669</a></p>\n\n<p>As of 2018, tcp_tw_recycle exists only in the sysctl binary, is otherwise gone from the kernel:</p>\n\n<p><a href=\"https://github.com/torvalds/linux/search?utf8=%E2%9C%93&amp;q=tcp_tw_recycle&amp;type=\" rel=\"nofollow noreferrer\">https://github.com/torvalds/linux/search?utf8=%E2%9C%93&amp;q=tcp_tw_recycle&amp;type=</a></p>\n\n<p>tcp_tw_reuse is still in use as described in the above answer:</p>\n\n<p><a href=\"https://github.com/torvalds/linux/blob/master/net/ipv4/tcp_ipv4.c#L128\" rel=\"nofollow noreferrer\">https://github.com/torvalds/linux/blob/master/net/ipv4/tcp_ipv4.c#L128</a></p>\n\n<p>However, while a TCP_TIMEWAIT_LEN is in use:</p>\n\n<p><a href=\"https://github.com/torvalds/linux/search?utf8=%E2%9C%93&amp;q=TCP_TIMEWAIT_LEN&amp;type=\" rel=\"nofollow noreferrer\">https://github.com/torvalds/linux/search?utf8=%E2%9C%93&amp;q=TCP_TIMEWAIT_LEN&amp;type=</a></p>\n\n<p>the value is hardcoded:</p>\n\n<p><a href=\"https://github.com/torvalds/linux/blob/master/include/net/tcp.h#L120\" rel=\"nofollow noreferrer\">https://github.com/torvalds/linux/blob/master/include/net/tcp.h#L120</a></p>\n\n<p>and tcp_fin_timeout refers to a different state:</p>\n\n<p><a href=\"https://github.com/torvalds/linux/blob/master/Documentation/networking/ip-sysctl.txt#L294\" rel=\"nofollow noreferrer\">https://github.com/torvalds/linux/blob/master/Documentation/networking/ip-sysctl.txt#L294</a></p>\n\n<p>One can relatively safely change the local port range to 1025-65535.</p>\n\n<p>For kicks, if there were a situation where this client was talking to servers and network under my control, I would build a new kernel with a not-to-spec TCP_TIMEWAIT_LEN, and perhaps also fiddle with tcp_max_tw_buckets:</p>\n\n<p><a href=\"https://github.com/torvalds/linux/blob/master/Documentation/networking/ip-sysctl.txt#L379\" rel=\"nofollow noreferrer\">https://github.com/torvalds/linux/blob/master/Documentation/networking/ip-sysctl.txt#L379</a></p>\n\n<p>But doing so in other circumstances- if this client is behind a NAT and talking to common public servers- will likely be disruptive.</p>\n"}], "owner": {"reputation": 1011, "user_id": 1881641, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d8c2466a4bf038dc5617545698a97d5f?s=128&d=identicon&r=PG", "display_name": "what is what", "link": "https://stackoverflow.com/users/1881641/what-is-what"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 645, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522206311, "creation_date": 1522143088, "last_edit_date": 1522143221, "question_id": 49509208, "link": "https://stackoverflow.com/questions/49509208/how-can-i-make-large-number-of-connections-without-error-at-client-side", "title": "how can I make large number of connections without error at client side", "body": "<p>I have written a program in golang to make request about 2000qps to different remote ip with local port randomly selected by linux, and close request immediately after connection established, but still encounter <code>bind: address already in use</code> error periodically</p>\n\n<p>what I have done:</p>\n\n<ol>\n<li>net.ipv4.ip_local_port_range  is 15000-65535 </li>\n<li>net.ipv4.tcp_tw_recycle=1 net.ipv4.tcp_tw_reuse=1 net.ipv4.tcp_fin_timeout=30</li>\n</ol>\n\n<p>above is sockstat:</p>\n\n<pre><code>sockets: used 1200 TCP: inuse 2302 orphan 1603 tw 40940 alloc 2325 mem 201\n</code></pre>\n\n<p>I don't figure it out why this error still there with kernel selecting available local port,will kernel return a port in use ?</p>\n"}, {"tags": ["xml", "go"], "answers": [{"tags": [], "owner": {"reputation": 9874, "user_id": 1636314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/656293120862f84aa3319979ca1bdb8c?s=128&d=identicon&r=PG", "display_name": "publysher", "link": "https://stackoverflow.com/users/1636314/publysher"}, "is_accepted": true, "score": 4, "last_activity_date": 1522143349, "creation_date": 1522143349, "answer_id": 49509314, "question_id": 49508812, "link": "https://stackoverflow.com/questions/49508812/parsing-xml-with-cdata-using-go/49509314#49509314", "title": "Parsing XML with CDATA using Go", "body": "<p>The first thing you should do is <em>not</em> ignore any errors that <code>xml.Unmarshal</code> can give you:</p>\n\n<pre><code>if err := xml.Unmarshal(bodyXML, result); err != nil {\n    fmt.Println(err)\n}\n</code></pre>\n\n<p>This will (eventually) give you a number of errors:</p>\n\n<p>Error number 1: By default, the XML decoder wants the XML to be encoded in UTF-8. You are providing ISO-8859-1. This can either be trivially fixed by changing your XML encoding to UTF-8; or by manually creating a <code>xml.Decoder</code> and settings the <code>CharsetReader</code> member. </p>\n\n<p>Error number 2: When unmarshalling, the XML decoder expects a <em>pointer</em>, because it needs to <em>modify</em> the passed in struct:</p>\n\n<pre><code>if err := xml.Unmarshal(bodyXML, &amp;result); err != nil {\n    ....\n}\n</code></pre>\n\n<p>Note the <code>&amp;</code> in front of result. </p>\n\n<p>When you fix these errors, the XML unmarshals fine. </p>\n\n<p>I have created a fully working example on the <a href=\"https://play.golang.org/p/xLFSJ6SVcmM\" rel=\"nofollow noreferrer\">Go Playground</a></p>\n"}], "owner": {"reputation": 298, "user_id": 9456506, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "elham anari", "link": "https://stackoverflow.com/users/9456506/elham-anari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1036, "favorite_count": 0, "accepted_answer_id": 49509314, "answer_count": 1, "score": 1, "last_activity_date": 1522143349, "creation_date": 1522141977, "last_edit_date": 1522142173, "question_id": 49508812, "link": "https://stackoverflow.com/questions/49508812/parsing-xml-with-cdata-using-go", "title": "Parsing XML with CDATA using Go", "body": "<p>I am new in Golang and I've been trying to parse an xml in Go by defining structs and using xml.Unmarshal.There's no error thrown but the struct is empty.\nthis is my xml:</p>\n\n<pre><code>var bodyXML = []byte('&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;\n&lt;smsBatchResponse&gt;\n &lt;ok&gt;\n  &lt;![CDATA[CHECK_OK]]&gt;\n &lt;/ok&gt;\n&lt;/smsBatchResponse&gt;')\n</code></pre>\n\n<p>and this is my code:</p>\n\n<pre><code>type SmsBatchResponse struct {\n    Ok string `xml:\"ok\"`\n}\n\nvar result SmsBatchResponse\n\nxml.Unmarshal(bodyXML,result)\nfmt.Println(result)\n</code></pre>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 1, "creation_date": 1522141033, "post_id": 49508338, "comment_id": 86021071, "body": "Maybe this can help you? <a href=\"https://docs.mongodb.com/manual/core/index-unique/\" rel=\"nofollow noreferrer\">docs.mongodb.com/manual/core/index-unique</a>"}, {"owner": {"reputation": 1077, "user_id": 6213954, "user_type": "registered", "profile_image": "https://graph.facebook.com/1021896287864076/picture?type=large", "display_name": "Oleksandr Buchek", "link": "https://stackoverflow.com/users/6213954/oleksandr-buchek"}, "reply_to_user": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1522144669, "post_id": 49508338, "comment_id": 86023637, "body": "Will try, @icza suggested it as well in his answer below"}], "answers": [{"comments": [{"owner": {"reputation": 1077, "user_id": 6213954, "user_type": "registered", "profile_image": "https://graph.facebook.com/1021896287864076/picture?type=large", "display_name": "Oleksandr Buchek", "link": "https://stackoverflow.com/users/6213954/oleksandr-buchek"}, "edited": false, "score": 0, "creation_date": 1522144467, "post_id": 49508557, "comment_id": 86023499, "body": "Thanks for your answer! Of course, front will disable a button, but I kind of worry about the possibility of duplicated documents even in other places of my project. Will try using unique indexes, and sorted _id. Will write an update of what the result would be. Although, I&#39;ll try to upsert from terminal as maybe it is mgo`s package fault."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1077, "user_id": 6213954, "user_type": "registered", "profile_image": "https://graph.facebook.com/1021896287864076/picture?type=large", "display_name": "Oleksandr Buchek", "link": "https://stackoverflow.com/users/6213954/oleksandr-buchek"}, "edited": false, "score": 0, "creation_date": 1522144522, "post_id": 49508557, "comment_id": 86023536, "body": "@OleksandrBuchek Updated the answer: Note that using <code>Query.UpsertId()</code> will always succeed, inserting the document if not exists, and updating it if it does. <code>Query.Insert()</code> insert the document if it does not exists, and returns an error if it already does. Using none of <code>UpsertId()</code> and <code>Insert()</code> will result in multiple documents with the same ID."}, {"owner": {"reputation": 1077, "user_id": 6213954, "user_type": "registered", "profile_image": "https://graph.facebook.com/1021896287864076/picture?type=large", "display_name": "Oleksandr Buchek", "link": "https://stackoverflow.com/users/6213954/oleksandr-buchek"}, "edited": false, "score": 0, "creation_date": 1522148831, "post_id": 49508557, "comment_id": 86026656, "body": "1) I worked around MongoDB Unique Indexes, but for my case it is not an option, because if user cancel the offer and later he wants to put it again with the same assetId, he would not be able to do it, because of the unique index. 2) I cannot use Insert() with save mode, as it, first slows our operations, second, we are highly bounded by _id identifier of out offer. What we ended up with is to make some improvement of our flow of putting offer on sale, and make sure the validation will work. Thank you for your response anyway, it would absolutely helpful."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 4, "last_activity_date": 1522146690, "last_edit_date": 1522146690, "creation_date": 1522141278, "answer_id": 49508557, "question_id": 49508338, "link": "https://stackoverflow.com/questions/49508338/mongo-writes-query-upsertid-multiple-documents-before-i-can-validate-with-query/49508557#49508557", "title": "Mongo writes query.UpsertId multiple documents before I can validate with query.Count()", "body": "<p>First thing would be to disable the \"Send\" button at client side while the call is in progress, so if the user double or triple clicks, that will have no effect, as the second and subsequent calls will target a disabled button, hence nothing will happen.</p>\n\n<p>If the same order may come from multiple places which you want to save multiple times, this is already enough and the correct way to do it.</p>\n\n<p>If the ID also comes from the client,  and if only a single order may exist with the given ID, then the next thing you should do is simply use the Order ID as the document ID in MongoDB: assign and use this value as the MongoDB <code>_id</code> field. This will give you the guarantee that multiple items with the same order ID will not exists, the 2nd attempt to insert the order would return an error. Note that using <code>Query.UpsertId()</code> will always succeed, inserting the document if not exists, and updating it if it does. <code>Query.Insert()</code> insert the document if it does not exists, and returns an error if it already does. Using none of <code>UpsertId()</code> and <code>Insert()</code> will result in multiple documents with the same ID.</p>\n\n<p>If for some reason you can't or don't want to use the order ID as the document ID, then define a unique index for the property which stores the order ID, for details see <a href=\"https://docs.mongodb.com/manual/core/index-unique/\" rel=\"nofollow noreferrer\">MongoDB Unique Indexes</a>.</p>\n\n<p>Note that using the MongoDB <code>_id</code> field or another one with unique index in itself ensures you can't insert multiple documents with the same Order ID (ensured by MongoDB). Also note that this will work even if you have a cluster with multiple MongoDB instances, as writes (including inserts) always happen at the Master node. So nothing else is required for this to work in a multi-server cluster environment.</p>\n"}, {"tags": [], "owner": {"reputation": 1077, "user_id": 6213954, "user_type": "registered", "profile_image": "https://graph.facebook.com/1021896287864076/picture?type=large", "display_name": "Oleksandr Buchek", "link": "https://stackoverflow.com/users/6213954/oleksandr-buchek"}, "is_accepted": true, "score": 0, "last_activity_date": 1522335585, "last_edit_date": 1522335585, "creation_date": 1522333735, "answer_id": 49558713, "question_id": 49508338, "link": "https://stackoverflow.com/questions/49508338/mongo-writes-query-upsertid-multiple-documents-before-i-can-validate-with-query/49558713#49558713", "title": "Mongo writes query.UpsertId multiple documents before I can validate with query.Count()", "body": "<p>Eventually, after close investigation the bug, we found out that the reason was when user sent request it was handled in goroutine. Means a lot requests = a lot of concurrent goroutines. So, it out validator (check if the offer is in the collection), couldn't find it as it was not in the mongo yet. So, in the end, we decided to use redis as our validator. </p>\n\n<p>Here is short implementation:</p>\n\n<pre><code>incr, err := redisClient.Incr(offer.AssetId).Result()\n    if err != nil {\n        return err\n    }\n\n    if incr &gt; 1 {\n        return errors.New(\"ASSET_ALREADY_ON_SALE\")\n    }\n\n    redisClient.Expire(offer.AssetId, time.Second*10)\n</code></pre>\n\n<p>Hope it will help someone facing same issue.</p>\n\n<p><a href=\"https://redis.io/commands/incr\" rel=\"nofollow noreferrer\">Link on implementation description:</a></p>\n"}], "owner": {"reputation": 1077, "user_id": 6213954, "user_type": "registered", "profile_image": "https://graph.facebook.com/1021896287864076/picture?type=large", "display_name": "Oleksandr Buchek", "link": "https://stackoverflow.com/users/6213954/oleksandr-buchek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 49558713, "answer_count": 2, "score": 2, "last_activity_date": 1522335585, "creation_date": 1522140611, "last_edit_date": 1522150613, "question_id": 49508338, "link": "https://stackoverflow.com/questions/49508338/mongo-writes-query-upsertid-multiple-documents-before-i-can-validate-with-query", "title": "Mongo writes query.UpsertId multiple documents before I can validate with query.Count()", "body": "<p><strong>Description:</strong> I`m using mongoDB on my project. This is short logic for handler when user tries to put his item for sale. Before putting offer to mongo I validate the offer, so there would be no active offers with save assetId</p>\n\n<p>Using:</p>\n\n<ul>\n<li><p>mgo.v2</p></li>\n<li><p>mongo 3.6</p></li>\n<li><p>golang 1.10</p></li>\n</ul>\n\n<p><strong>Problem:</strong> If user clicks really fast sends several requests to my handler (lets say if he double click the mouse fast), validation doesn`t work as it seems like the first offer is not in the collection yet, so as a result I get 2-3 offers with same assetId. </p>\n\n<p><strong>I tried</strong> </p>\n\n<ul>\n<li>Set mongoUrl?replicaSet=rs0, so our master and slaves would now about each other</li>\n<li>Set time.Sleep(200 * time.Millisecond) after validation</li>\n</ul>\n\n<p><strong>Question:</strong> </p>\n\n<p>Is there any way I can handle this with mongo instruments, or someone would suggest some other workaround?</p>\n\n<p>Thank you in advance!</p>\n\n<pre><code>       count, _ := r.DB.C(sellOfferCollectionName).Find(\n         bson.M{\n            \"state\":     someState,\n            \"asset_id\":  assetId,\n            \"seller_id\": seller,\n         },\n       ).Count()\n\n       if count &gt; 0 {\n           return \n       }       \n\n       id := uuid.New().String()\n            OfferModel := Offer{\n                Id:           id,\n                AssetId:      assetId,\n                State:        someState,\n                SellerId:     sellerId,\n                CreatingDate: time.Now(),\n            }\n        if _, err := r.DB.C(sellOfferCollectionName).UpsertId(offer.Id, offer); err != nil {\n            return err\n        }\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I tried to recreate the problem even more. So I wrote this little test code, so in result managed to write 60 documents before validation (count > 0) worked. This example fully recreates my problem. </p>\n\n<pre><code>type User struct {\n  Id        string `bson:\"_id\"`\n  FirstName string `bson:\"first_name\"`\n  LastName  string `bson:\"last_name\"`\n  State     bool   `bson:\"state\"`\n}\n\nfunc main() {\n  mongoSession, mgErr := mgo.Dial(\"127.0.0.1:27018\")\n\n  if mgErr != nil {\n    panic(mgErr)\n  }\n\n  var mongoDbSession = mongoSession.DB(\"test_db\")\n\n  for i := 0; i &lt; 1000; i++ {\n    go func() {\n      count, _ := mongoDbSession.C(\"users\").Find(\n        bson.M{\n          \"state\":      true,\n          \"first_name\": \"testUser\",\n        },\n      ).Count()\n\n      if count &gt; 0 {\n        return\n      }\n\n      user := User{\n        Id:        uuid.New().String(),\n        FirstName: \"testUser\",\n        LastName:  \"testLastName\",\n        State:     true,\n      }\n\n      if _, err := mongoDbSession.C(\"users\").UpsertId(user.Id, user); err != nil {\n        panic(mgErr)\n      }\n    }()\n  }\n\n  count, _ := mongoDbSession.C(\"users\").Find(\n    bson.M{\n      \"state\":      true,\n      \"first_name\": \"testUser\",\n    },\n  ).Count()\n\n  fmt.Println(count)\n  fmt.Scanln()\n}\n</code></pre>\n"}, {"tags": ["linux", "ubuntu", "go", "root"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9455968"}, "edited": false, "score": 2, "creation_date": 1522133875, "post_id": 49506159, "comment_id": 86016462, "body": "What do you mean by &#39;from the archive&#39;? How exactly did you install Go?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1522136935, "post_id": 49506159, "comment_id": 86018386, "body": "Just a wild guess: there was <a href=\"https://github.com/npm/npm/issues/19883\" rel=\"nofollow noreferrer\">this bug</a> in npm that may have caused this. If it did, there are likely to be more system directories that are no longer owner by root; you should fix that asap as it is a serious security risk."}], "answers": [{"comments": [{"owner": {"reputation": 1598, "user_id": 1848562, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/XQIUk.jpg?s=128&g=1", "display_name": "Jacob Horbulyk", "link": "https://stackoverflow.com/users/1848562/jacob-horbulyk"}, "edited": false, "score": 6, "creation_date": 1548685983, "post_id": 49506331, "comment_id": 95618804, "body": "You may also have to run <code>sudo chown root:root &#47;</code> if the owner group of <code>&#47;</code> is messed up."}, {"owner": {"reputation": 1922, "user_id": 4934984, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8c959e6ff4a1b49733025dfa53bafcb6?s=128&d=identicon&r=PG", "display_name": "Tushortz", "link": "https://stackoverflow.com/users/4934984/tushortz"}, "edited": false, "score": 0, "creation_date": 1597380686, "post_id": 49506331, "comment_id": 112119282, "body": "i also had to run <code>sudo chgrp root &#47;var&#47;</code> as i messed t up before lol"}], "tags": [], "owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "is_accepted": false, "score": 10, "last_activity_date": 1522134911, "last_edit_date": 1522134911, "creation_date": 1522134240, "answer_id": 49506331, "question_id": 49506159, "link": "https://stackoverflow.com/questions/49506159/how-to-fix-go-not-root-owned/49506331#49506331", "title": "how to fix &quot;go not root owned&quot;", "body": "<p>It seems to complain that the system root directory <code>/</code> has the wrong owner. This is a security problem because you don't want to have regular users changing system files at will. It looks like you changed this on purpose at some point in the past; change it back, or reinstall your system if you have wrecked more permissions than just this one.</p>\n\n<pre><code>sudo chown root /\n</code></pre>\n\n<p>For the record, the proper way to give yourself <em>limited</em> system access is to use <code>sudo</code>.  Add yourself to <code>sudoers</code> (usually this is already set up by the OS installer on any reasonably consumer-oriented Linux distro) and when you need privileges for something, run that command with <code>sudo</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 169, "user_id": 9274327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30be5ead044a60fc016135fb262f618f?s=128&d=identicon&r=PG&f=1", "display_name": "eth crypt", "link": "https://stackoverflow.com/users/9274327/eth-crypt"}, "is_accepted": false, "score": 0, "last_activity_date": 1522137504, "creation_date": 1522137504, "answer_id": 49507356, "question_id": 49506159, "link": "https://stackoverflow.com/questions/49506159/how-to-fix-go-not-root-owned/49507356#49507356", "title": "how to fix &quot;go not root owned&quot;", "body": "<p>In addition to the root permission issue I had, I also found that I installed go using snap to: <code>snap install --classic go</code>, which wasn't a good idea. I was also unable to remove the go folder in <code>/snap</code>, even as root. I now reinstall my system and hopefully the issue will be solved. </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9055127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYBYl.jpg?s=128&g=1", "display_name": "M3hdi Rostami", "link": "https://stackoverflow.com/users/9055127/m3hdi-rostami"}, "is_accepted": false, "score": -2, "last_activity_date": 1586589342, "creation_date": 1586589342, "answer_id": 61153292, "question_id": 49506159, "link": "https://stackoverflow.com/questions/49506159/how-to-fix-go-not-root-owned/61153292#61153292", "title": "how to fix &quot;go not root owned&quot;", "body": "<pre><code>sudo chown root /var\n</code></pre>\n\n<p>This will solve your problem</p>\n"}, {"tags": [], "owner": {"reputation": 149, "user_id": 8768524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713d4f2b94edf99ccb18dfbb41023100?s=128&d=identicon&r=PG", "display_name": "Messou", "link": "https://stackoverflow.com/users/8768524/messou"}, "is_accepted": false, "score": 0, "last_activity_date": 1597423605, "creation_date": 1597423605, "answer_id": 63416903, "question_id": 49506159, "link": "https://stackoverflow.com/questions/49506159/how-to-fix-go-not-root-owned/63416903#63416903", "title": "how to fix &quot;go not root owned&quot;", "body": "<p>simple in command line:</p>\n<pre><code>  sudo chown root:root /\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 15415911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MJBJA.jpg?s=128&g=1", "display_name": "Sapatoshin Komukamu", "link": "https://stackoverflow.com/users/15415911/sapatoshin-komukamu"}, "is_accepted": false, "score": -1, "last_activity_date": 1615992504, "creation_date": 1615992504, "answer_id": 66675459, "question_id": 49506159, "link": "https://stackoverflow.com/questions/49506159/how-to-fix-go-not-root-owned/66675459#66675459", "title": "how to fix &quot;go not root owned&quot;", "body": "<p>sudo chown -R root:root /</p>\n<p>This solved the same error for me on Ubuntu 20.04</p>\n"}], "owner": {"reputation": 169, "user_id": 9274327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30be5ead044a60fc016135fb262f618f?s=128&d=identicon&r=PG&f=1", "display_name": "eth crypt", "link": "https://stackoverflow.com/users/9274327/eth-crypt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5619, "favorite_count": 0, "answer_count": 5, "score": 5, "last_activity_date": 1615992504, "creation_date": 1522133615, "question_id": 49506159, "link": "https://stackoverflow.com/questions/49506159/how-to-fix-go-not-root-owned", "title": "how to fix &quot;go not root owned&quot;", "body": "<p>I installed go on ubuntu 16.04 from the archive and tried to test my installation by issuing the command <code>go</code> on my terminal. It keeps prompting me <code>/ not root-owned 1000:0</code>. </p>\n\n<p>I installed go on <code>/usr/local</code> folder and also included it into my path as instructed on the official golang installation. I removed go and tried to install it again, but found the same result. It sounds more of a linux root permission issue, but I have no clue how to fix it. I tried other commands that I installed from archive and they work perfectly fine. Any kind of help would be appreciated.</p>\n"}, {"tags": ["go", "websocket", "gorilla"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1522126122, "post_id": 49504016, "comment_id": 86013155, "body": "Show the actual code. The code shown so far looks OK. What client is used to send messages to the server?"}, {"owner": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1522143191, "post_id": 49504016, "comment_id": 86022514, "body": "you could try, err := conn.WriteMessage(1, []byte(&quot;test message&quot;)) and then check for errors while sending to the client"}, {"owner": {"reputation": 36497, "user_id": 5302, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/36266269d477a10e9e34d6c32756d255?s=128&d=identicon&r=PG", "display_name": "johnc", "link": "https://stackoverflow.com/users/5302/johnc"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1522184707, "post_id": 49504016, "comment_id": 86050674, "body": "@CeriseLim&#243;n I have added all the code from, both server side (golang) and client side (.NET)"}, {"owner": {"reputation": 36497, "user_id": 5302, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/36266269d477a10e9e34d6c32756d255?s=128&d=identicon&r=PG", "display_name": "johnc", "link": "https://stackoverflow.com/users/5302/johnc"}, "reply_to_user": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1522184821, "post_id": 49504016, "comment_id": 86050726, "body": "@Pizzalord I was checking that in the original code (check edit above) but originally had it edited out for the sake of brevity. I&#39;m now being much more verbose."}], "answers": [{"comments": [{"owner": {"reputation": 36497, "user_id": 5302, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/36266269d477a10e9e34d6c32756d255?s=128&d=identicon&r=PG", "display_name": "johnc", "link": "https://stackoverflow.com/users/5302/johnc"}, "edited": false, "score": 0, "creation_date": 1522203419, "post_id": 49523942, "comment_id": 86055905, "body": "Thanks so much for that, I was pulling my hair out. I&#39;ll give it a test then mark you as the answer. That all makes sense, but still new to golang and it&#39;s still not that intuitive to me"}, {"owner": {"reputation": 36497, "user_id": 5302, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/36266269d477a10e9e34d6c32756d255?s=128&d=identicon&r=PG", "display_name": "johnc", "link": "https://stackoverflow.com/users/5302/johnc"}, "edited": false, "score": 0, "creation_date": 1522204020, "post_id": 49523942, "comment_id": 86056037, "body": "To answer the point of the first goroutine, it was to close the connection if the client side requested it / dropped out, but I can easily handle that by checking the err on the read JSON."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1522196713, "last_edit_date": 1522196713, "creation_date": 1522193649, "answer_id": 49523942, "question_id": 49504016, "link": "https://stackoverflow.com/questions/49504016/gorilla-websocket-not-receiving-message/49523942#49523942", "title": "Gorilla Websocket not receiving message", "body": "<p>The application runs two goroutines that read messages in a loop. The first does nothing with the received message. The second parses and logs the message. You do not see any output because the first goroutine is receiving the messages. </p>\n\n<p>The first goroutine does not seem to serve any purpose. \nDelete the first goroutine to fix the problem.</p>\n\n<p>Deleting the first goroutine also fixes a data race.  <a href=\"https://godoc.org/github.com/gorilla/websocket#hdr-Concurrency\" rel=\"nofollow noreferrer\">Concurrent reads on a websocket connection are not supported</a>. The <a href=\"https://golang.org/doc/articles/race_detector.html\" rel=\"nofollow noreferrer\">race detector</a> will report this issue.</p>\n\n<p>Here's the updated code with other fixes and improvements. The net/http server \ncalls handlers a per-connection goroutine. Use tha goroutine instead of starting yet another goroutine. Use the websocket package's JSON helper method.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"github.com/gorilla/websocket\"\n    \"encoding/json\"\n    \"log\"\n)\n\nvar upgrader = websocket.Upgrader{ ReadBufferSize:  1024, WriteBufferSize: 1024,\n    CheckOrigin: func(r *http.Request) bool {\n        return true\n    },\n}\n\ntype AdminRequest struct {\n        Data      string `json:\"Data\"`\n        Requestor string `json:\"Requestor\"`\n        Type      string `json:\"Type\"`\n        Ukey      string `json:\"Ukey\"`\n    } \n\nfunc wsHandler(w http.ResponseWriter, r *http.Request) {\n    conn, err := upgrader.Upgrade(w, r, nil)\n    if err != nil {\n        log.Println(err)\n        return\n    }\n    defer conn.Close()\n    for {\n        var r AdminRequest\n        if err := conn.ReadJSON(&amp;r); err != nil {\n            log.Println(err)\n            break\n        }\n        fmt.Printf(\"%#v\\n\", r)\n        log.Println(r.Data);\n    }           \n}\n\nfunc main() {\n    http.HandleFunc(\"/a\", wsHandler)\n    http.ListenAndServe(\":3000\", nil)\n}\n</code></pre>\n"}], "owner": {"reputation": 36497, "user_id": 5302, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/36266269d477a10e9e34d6c32756d255?s=128&d=identicon&r=PG", "display_name": "johnc", "link": "https://stackoverflow.com/users/5302/johnc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3164, "favorite_count": 0, "accepted_answer_id": 49523942, "answer_count": 1, "score": 3, "last_activity_date": 1522196713, "creation_date": 1522122287, "last_edit_date": 1522184739, "question_id": 49504016, "link": "https://stackoverflow.com/questions/49504016/gorilla-websocket-not-receiving-message", "title": "Gorilla Websocket not receiving message", "body": "<p>I am building a gateway in Golang that communicates with Gorilla websockets.</p>\n\n<p>I am running it on Ubuntu 16.04, and testing it currently with a .NET console app.</p>\n\n<p>Using Wireshark on Windows and sniffit on Ubuntu have determined that <em>messages are being sent correctly from the Windows client and received by the Ubuntu box</em>.</p>\n\n<p>In my code, however, sometimes after a few successful messages, and sometimes after none, my gateway is failing to read the message (still sitting at <code>_, msg, errCon := conn.ReadMessage()</code>)</p>\n\n<p>An example of the output will be:</p>\n\n<blockquote>\n  <p>2018/03/27 02:38:06 Awaiting Message ... \n  2018/03/27 02:38:07 Message received: main.AdminRequest{Data:\"{\\\"SomeDataHeader\\\":\\\"SomeData\\\"}\",\n  Requestor:\"user\", Type:\"JustDoSomethingRequest\", Ukey:\"talca\"} 2018/03/27 02:38:07\n  {\"SomeDataHeader\":\"SomeData\"} \n  2018/03/27 02:38:07 Awaiting Message ...</p>\n</blockquote>\n\n<p>As I have previously said, it may receive a few messages like this, but, despite network traffic on both ends continuing, no more messages will be received</p>\n\n<p>I am fairly new with Golang, and working under the assumption that I am missing something.</p>\n\n<p><strike>I have trimmed out error handling and the like for the sake of brevity in the code below, but this is an example of the failing code.</strike></p>\n\n<p><strong>EDIT</strong> As requested I have added Golang full code, and C# client code below (although, as I stated, Wireshark and sniffit have determined that data is going over the wire)</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"github.com/gorilla/websocket\"\n    \"encoding/json\"\n    \"log\"\n)\n\nvar upgrader = websocket.Upgrader{ ReadBufferSize:  1024, WriteBufferSize: 1024,\n    CheckOrigin: func(r *http.Request) bool {\n        return true\n    },\n}\n\ntype AdminRequest struct {\n        Data      string `json:\"Data\"`\n        Requestor string `json:\"Requestor\"`\n        Type      string `json:\"Type\"`\n        Ukey      string `json:\"Ukey\"`\n    } \n\nfunc main() {\n\n    http.HandleFunc(\"/a\", func(w http.ResponseWriter, r *http.Request) {\n        var conn, _ = upgrader.Upgrade(w, r, nil)\n\n        go func(conn *websocket.Conn) {\n            for {\n                _, _, err := conn.ReadMessage()\n                if err != nil {         \n                    log.Println(\"Close: \"+ err.Error())\n                    conn.Close()\n                    return\n                }\n            }\n        }(conn)\n\n\n        go func(conn *websocket.Conn) {\n            for {\n\n                log.Println(\"Awaiting Message ...\")\n                _, msg, errCon := conn.ReadMessage()\n\n                if errCon != nil {\n                    log.Println(\"Read Error:\", errCon)\n                    break\n                }\n\n                log.Println(\"Message received: \")\n\n                var r AdminRequest\n\n                if err := json.Unmarshal(msg, &amp;r); err != nil {\n\n                    log.Println(\"Error: \" + err.Error());\n                    return;\n                }\n\n                fmt.Printf(\"%#v\\n\", r)\n                log.Println(r.Data);\n            }           \n        }(conn)\n\n    })\n\n    http.ListenAndServe(\":3000\", nil)\n}\n</code></pre>\n\n<p>C# Code:</p>\n\n<pre><code>public class Client : IDisposable\n    {\n        private ClientWebSocket _socket;\n\n\n        string _address;\n        int _port;\n        public Client(string address)\n        {\n            _address = address;\n\n            _socket = new ClientWebSocket();\n        }\n\n        public async void SetupForReceivingStuffs()\n        {\n            while (_socket.State == WebSocketState.Open)\n            {\n                ArraySegment&lt;byte&gt; receivedBytes = new ArraySegment&lt;byte&gt;(new byte[1024]);\n                WebSocketReceiveResult result = await _socket.ReceiveAsync(receivedBytes, CancellationToken.None);\n\n                Console.WriteLine(Encoding.UTF8.GetString(receivedBytes.Array, 0, result.Count));\n            }\n        }\n\n        public async void SetupForSendingStuffs(ConcurrentQueue&lt;AdminRequest&gt; queue)\n        {\n            while (_socket.State == WebSocketState.Open)\n            {\n                AdminRequest next;\n\n                while (queue.Count &gt; 0)\n                {\n                    if (queue.TryDequeue(out next))\n                    {\n                        await Send(next);\n                    }\n                }\n\n                await Task.Yield();\n            }\n        }\n\n        public async Task Connect()\n        {\n            while (_socket.State != WebSocketState.Open)\n            {\n                try\n                {\n                    _socket = new ClientWebSocket();\n                    await _socket.ConnectAsync(new Uri(_address), CancellationToken.None);\n\n                    Console.WriteLine(\"Socket state: \" + _socket.State);\n                }\n                catch (Exception ex)\n                {\n                    //Not getting hit\n                    Console.WriteLine(ex.Message);\n                    Console.WriteLine(ex.StackTrace);\n                }\n            }\n        }\n\n\n\n        public Task Send&lt;TData&gt;(TData data)\n        {\n            string text = JsonConvert.SerializeObject(data);\n\n            var encoded = Encoding.UTF8.GetBytes(text);\n            var buffer = new ArraySegment&lt;Byte&gt;(encoded, 0, encoded.Length);\n\n            return _socket.SendAsync(buffer, WebSocketMessageType.Text, true, CancellationToken.None);\n        }\n\n\n        public void Dispose()\n        {\n            _socket.Dispose();\n        }\n    }\n</code></pre>\n\n<p>Called by:</p>\n\n<pre><code>class Program\n{\n    static ConcurrentQueue&lt;AdminRequest&gt; _toSend;\n\n    static void Main(string[] args)\n    {\n        _toSend = new ConcurrentQueue&lt;AdminRequest&gt;();\n\n        Client client = new Client(\"ws:/(myip):(myport)/a\");\n        client.Connect().Wait();\n\n        //client.SetupForReceivingStuffs();\n        client.SetupForSendingStuffs(_toSend);\n\n        WriteInstructions();\n\n        LoopAuto();\n\n        Console.WriteLine(\"Bye\");\n    }\n\n    private static void LoopAuto()\n    {\n        DateTime nextMessage = DateTime.Now;\n\n        while (true)\n        {\n\n            if (DateTime.Now &lt; nextMessage) continue;\n            Console.WriteLine(\"Next\");\n            nextMessage = DateTime.Now.AddSeconds(2);\n\n            _toSend.Enqueue(new AdminRequest\n            {\n                Data = \"{\\\"SomeDataHeader\\\":\\\"SomeData\\\"}\",\n                Requestor = \"user\",\n                Type = \"JustDoSomethingRequest\",\n                Ukey = \"talca\"\n            });\n        }\n    }\n\n    private static ConsoleKeyInfo LoopManual()\n    {\n        ConsoleKeyInfo info;\n        do\n        {\n            info = Console.ReadKey(true);\n\n            if (info.KeyChar == '1')\n            {\n                _toSend.Enqueue(new AdminRequest\n                {\n                    Data = \"{\\\"SomeDataHeader\\\":\\\"SomeData\\\"}\",\n                    Requestor = \"user\",\n                    Type = \"JustDoSomethingRequest\",\n                    Ukey = \"talca\"\n                });\n            }\n            else if (info.KeyChar == 'i')\n            {\n                WriteInstructions();\n            }\n\n        } while (info.KeyChar != 'x');\n\n        return info;\n    }\n\n    private static void WriteInstructions()\n    {\n        Console.WriteLine(\"1. Send New Message\");\n        Console.WriteLine(\"i. Instructions (these lines)\");\n        Console.WriteLine(\"x: Exit\");\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "ibm-cloud-infrastructure", "gateway"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9638637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/173fec04992e1d143b13cb2cbdd289fe?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff.F", "link": "https://stackoverflow.com/users/9638637/jeff-f"}, "is_accepted": false, "score": 0, "last_activity_date": 1523571555, "creation_date": 1523571555, "answer_id": 49806692, "question_id": 49503461, "link": "https://stackoverflow.com/questions/49503461/how-to-order-a-softlayer-network-gateway-with-ssh-configured-for-gateway-and-its/49806692#49806692", "title": "How to order a softlayer network gateway with ssh configured for Gateway and its member", "body": "<p>SoftLayer Network Gateway is an object which consists of either one member (standalone) or 2 members (High Availability). When you accessing a gateway via ssh, it actually establishes ssh session with one of gateway member.  So you can only configure ssh key for gateway members, not gateway itself.</p>\n"}], "owner": {"reputation": 1, "user_id": 9555701, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "praveen gostu", "link": "https://stackoverflow.com/users/9555701/praveen-gostu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523571555, "creation_date": 1522117600, "last_edit_date": 1522157712, "question_id": 49503461, "link": "https://stackoverflow.com/questions/49503461/how-to-order-a-softlayer-network-gateway-with-ssh-configured-for-gateway-and-its", "title": "How to order a softlayer network gateway with ssh configured for Gateway and its member", "body": "<p>How to order a softlayer network gateway with ssh configured for Gateway and its member</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/softlayer/softlayer-go/datatypes\"\n    \"github.com/softlayer/softlayer-go/services\"\n    \"github.com/softlayer/softlayer-go/session\"\n    \"github.com/softlayer/softlayer-go/sl\"\n    \"encoding/json\"\n)\n\nfunc main() {\n    // SoftLayer API username and key\n    username := \"set me\"\n    apikey   := \"set me\"\n\n\n\n    // Build a Container_Product_Order_Virtual_Disk_Image object containing the order\n    // you wish to place\n    order := datatypes.Container_Product_Order{\n        ContainerIdentifier: sl.String(d.Get(\"hostname\").(string)),\n        Quantity:            sl.Int(1),\n        Hardware: []datatypes.Hardware{\n            {\n                Hostname: sl.String(d.Get(\"hostname\").(string)),\n                Domain:   sl.String(d.Get(\"domain\").(string)),\n            },\n        },\n        Location:  sl.String(strconv.Itoa(*dc.Id)),\n        PackageId: pkg.Id,\n        Prices: []datatypes.Product_Item_Price{\n            server,\n            os,\n            ram,\n            portSpeed,\n            priIpAddress,\n            remoteManagement,\n            vpnManagement,\n            monitoring,\n            notification,\n            response,\n            vulnerabilityScanner,\n        },\n    }\n\n    // Set SSH Key on main order\n    ssh_key_ids := members[0].Get(\"ssh_key_ids\").([]interface{})\n    sshKeyP := make([]int, len(ssh_key_ids))\n    for i, ssh_key_id := range ssh_key_ids {\n        sshKeyP[i] = ssh_key_id.(int)\n    }\n    order.SshKeys = make([]datatypes.Container_Product_Order_SshKeys, len(members))\n    order.SshKeys[0] = datatypes.Container_Product_Order_SshKeys{\n        SshKeyIds: sshKeyP,\n    }\n\n    // Create a session\n    sess := session.New(username, apikey)\n\n    // Get SoftLayer_Product_Order service\n    service := services.GetProductOrderService(sess)\n\n    // Use verifyOrder() method to check for errors. Replace this with placeOrder() when\n    // you are ready to order.\n    receipt, err := service.VerifyOrder(&amp;templateObject)\n    if err != nil {\n        fmt.Printf(\"\\n Unable to place order:\\n - %s\\n\", err)\n        return\n    }\n\n    // Following helps to print the result in json format.\n    jsonFormat, jsonErr := json.MarshalIndent(receipt, \"\",\"     \")\n    if jsonErr != nil {\n            fmt.Println(jsonErr)\n            return\n    }\n    fmt.Println(string(jsonFormat))\n}\n</code></pre>\n\n<p>This is the script I am using to order, but it configures the ssh keys only for the gateway member but not the gateway. could you please help me on how to configure the ssh key for gateway and its member. It would be great if you could update the same script and share it.</p>\n"}, {"tags": ["ruby", "go"], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1522142405, "post_id": 49502719, "comment_id": 86021973, "body": "@KVS7, <a href=\"https://golang.org/pkg/regexp/syntax\" rel=\"nofollow noreferrer\">here</a> is the documentation describing the syntax of REs supported by Go."}], "tags": [], "owner": {"reputation": 26448, "user_id": 10322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa46a3814b72439b1d2efa8f7c9162c2?s=128&d=identicon&r=PG", "display_name": "ctcherry", "link": "https://stackoverflow.com/users/10322/ctcherry"}, "is_accepted": true, "score": 6, "last_activity_date": 1522111200, "creation_date": 1522111200, "answer_id": 49502719, "question_id": 49502260, "link": "https://stackoverflow.com/questions/49502260/porting-from-ruby-to-go-find-and-replace-in-a-file/49502719#49502719", "title": "Porting from ruby to go: find and replace in a file", "body": "<p>Turn on multiline mode, and your original pattern will work:</p>\n\n<pre><code>r := regexp.MustCompile(`(?m)^\\s*$`)\n</code></pre>\n\n<p>Demo using strings: <a href=\"https://play.golang.org/p/6TsfgB83WgX\" rel=\"noreferrer\">https://play.golang.org/p/6TsfgB83WgX</a></p>\n"}], "owner": {"reputation": 33, "user_id": 8038257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0388b283e5bb1e6ccd96ae14ed4ceee0?s=128&d=identicon&r=PG&f=1", "display_name": "KVS7", "link": "https://stackoverflow.com/users/8038257/kvs7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 49502719, "answer_count": 1, "score": 3, "last_activity_date": 1522111200, "creation_date": 1522107491, "question_id": 49502260, "link": "https://stackoverflow.com/questions/49502260/porting-from-ruby-to-go-find-and-replace-in-a-file", "title": "Porting from ruby to go: find and replace in a file", "body": "<p>I am porting some ruby code to golang.  I'm having difficulty finding a good equivalent for the below line and wondered if someone knew of a better solution than what I have below.  The basic premise is find a line in a file that has a lot of spaces and remove the line.</p>\n\n<p>I also thought of just using exec to call sed -i but when I tried that it didn't work, and the below did finally work.</p>\n\n<p>Ruby:</p>\n\n<pre><code>File.write(filename, File.read(filename).gsub(/^\\s*$/,\"\"))\n</code></pre>\n\n<p>Golang:</p>\n\n<pre><code>b, err := ioutil.ReadFile(filename)\nif err != nil {\n    return\n}\n\n// I happen to know that there will be at least 30 spaces,\n// but I would really prefer to not use a hardcoded value here.\n// I was just never able to make using '^\\s*$' work in the regex.\n\nr := regexp.MustCompile(`[ ]{30,}`)  // there's a space in the []\nnewb := r.ReplaceAll(b, []byte(\"\"))\nerr = ioutil.WriteFile(filename, newb, 0666)\nif err != nil {\n    fmt.Printf(\"Unable to write to file (%+v)\\n\", err)\n    return\n}\n</code></pre>\n"}, {"tags": ["go", "strftime"], "comments": [{"owner": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "edited": false, "score": 1, "creation_date": 1522107667, "post_id": 49502238, "comment_id": 86008601, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/49084316/why-doesnt-gos-time-parse-parse-the-timezone-identifier\">Why doesn&#39;t Go&#39;s time.Parse() parse the timezone identifier?</a>"}, {"owner": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "edited": false, "score": 0, "creation_date": 1522107699, "post_id": 49502238, "comment_id": 86008608, "body": "And the discussion here <a href=\"https://stackoverflow.com/questions/49084928/parse-time-zone-into-a-location-struct-in-go\" title=\"parse time zone into a location struct in go\">stackoverflow.com/questions/49084928/&hellip;</a>"}, {"owner": {"reputation": 4844, "user_id": 666818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/uixCu.jpg?s=128&g=1", "display_name": "Laurent", "link": "https://stackoverflow.com/users/666818/laurent"}, "reply_to_user": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "edited": false, "score": 0, "creation_date": 1522107876, "post_id": 49502238, "comment_id": 86008651, "body": "I think you are right about the dup for timezone but how about the month? Notice the month sticks to the formatted month string."}, {"owner": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "edited": false, "score": 1, "creation_date": 1522108121, "post_id": 49502238, "comment_id": 86008735, "body": "As answered below, use Jan instead of Feb, but timezone is still an issue"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 6, "last_activity_date": 1522109221, "last_edit_date": 1522109221, "creation_date": 1522107704, "answer_id": 49502293, "question_id": 49502238, "link": "https://stackoverflow.com/questions/49502238/time-format-converted-to-strftime-default-format/49502293#49502293", "title": "time format converted to strftime default format", "body": "<p>For the <code>Format</code> layout, <code>Jan</code> not <code>Feb</code>. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    t, err := time.Parse(time.UnixDate, \"Tue Oct 10 13:55:36 PDT 2000\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    fmt.Println(time.Time(t).Format(\"01/Jan/2006:15:04:05 -0700\"))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>10/Oct/2000:13:55:36 +0000\n</code></pre>\n\n<hr>\n\n<p>Also, for the time zone, use <code>ParseInLocation</code>,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    loc, err := time.LoadLocation(\"America/Los_Angeles\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    t, err := time.ParseInLocation(time.UnixDate, \"Tue Oct 10 13:55:36 PDT 2000\", loc)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    fmt.Println(t)\n    fmt.Println(time.Time(t).Format(\"01/Jan/2006:15:04:05 -0700\"))\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/tBLw5oJSE5t\" rel=\"noreferrer\">https://play.golang.org/p/tBLw5oJSE5t</a></p>\n\n<p>Output:</p>\n\n<pre><code>2000-10-10 13:55:36 -0700 PDT\n10/Oct/2000:13:55:36 -0700\n</code></pre>\n"}], "owner": {"reputation": 4844, "user_id": 666818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/uixCu.jpg?s=128&g=1", "display_name": "Laurent", "link": "https://stackoverflow.com/users/666818/laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 647, "favorite_count": 1, "accepted_answer_id": 49502293, "answer_count": 1, "score": 1, "last_activity_date": 1522109221, "creation_date": 1522107319, "question_id": 49502238, "link": "https://stackoverflow.com/questions/49502238/time-format-converted-to-strftime-default-format", "title": "time format converted to strftime default format", "body": "<p>In the wikipedia entry for <a href=\"https://en.wikipedia.org/wiki/Common_Log_Format\" rel=\"nofollow noreferrer\">Common Log Format</a>, the strftime format is given as:</p>\n\n<blockquote>\n  <p>[10/Oct/2000:13:55:36 -0700] is the date, time, and time zone that the\n  request was received, by default in strftime format %d/%b/%Y:%H:%M:%S\n  %z.</p>\n</blockquote>\n\n<p>When I try using the time.Format function:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    t, _ := time.Parse(time.UnixDate, \"Tue Oct 10 13:55:36 PDT 2000\")\n    fmt.Println(time.Time(t).Format(\"01/Feb/2006:15:04:05 -0700\"))\n}\n</code></pre>\n\n<p>I get the output <code>[10/Feb/2000:13:55:36 +0000]</code>, while I was expecting <code>[10/Oct/2000:13:55:36 -0700]</code> (per Wikipedia). What is wrong with my formatting?</p>\n\n<p>I checked that day was a Tuesday and the time zone was -7h (PDT) for that date.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1522090309, "post_id": 49498323, "comment_id": 86001152, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/41503758/conversion-of-time-duration-type-microseconds-value-to-milliseconds/41503910#41503910\">Conversion of time.Duration type microseconds value to milliseconds</a>."}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 18, "last_activity_date": 1522089714, "last_edit_date": 1522089714, "creation_date": 1522089370, "answer_id": 49498375, "question_id": 49498323, "link": "https://stackoverflow.com/questions/49498323/when-does-int-time-second-work-and-when-does-it-not-in-golang/49498375#49498375", "title": "When does `int * time.Second` work and when does it not in golang?", "body": "<p>In Go, a <a href=\"https://golang.org/ref/spec#Constants\" rel=\"noreferrer\">numeric literal (e.g. <code>60</code>) is an <em>untyped constant</em></a>. That means it will be silently coerced to whatever type is appropriate for the operation where it's being used. So when you say:</p>\n\n<pre><code>var x := 5 * time.Second\n</code></pre>\n\n<p>Then the type is inferred from <code>time.Second</code> to be a <code>time.Duration</code>, and thus the literal <code>5</code> is also treated as a <code>time.Duration</code>. If there's nothing to infer a type from, it will assume a type (\"bool, rune, int, float64, complex128 or string\") and use that. So:</p>\n\n<pre><code>x := 180\n</code></pre>\n\n<p>Yields <code>x</code> with a type of <code>int</code>.</p>\n\n<p>However, when you do some operation involving something with a type - like, say a variable <code>x</code> that is an <code>int</code> - then you have two types and one must be converted for the operation to be legal.</p>\n\n<p>So, to the original question \"When does <code>int * time.Second</code> work and when does it not in golang?\", <code>int * time.Second</code> actually <em>never</em> works in Go. But <code>5 * time.Second</code> isn't the same as <code>int * time.Second</code>.</p>\n\n<p>This is touched on in <a href=\"https://tour.golang.org/basics/16\" rel=\"noreferrer\">the Go tour</a>:</p>\n\n<blockquote>\n  <p>An untyped constant takes the type needed by its context.</p>\n</blockquote>\n"}], "owner": {"reputation": 3455, "user_id": 580530, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/JcFdA.jpg?s=128&g=1", "display_name": "Jeff Erickson", "link": "https://stackoverflow.com/users/580530/jeff-erickson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2939, "favorite_count": 2, "accepted_answer_id": 49498375, "answer_count": 1, "score": 5, "last_activity_date": 1522089714, "creation_date": 1522089183, "question_id": 49498323, "link": "https://stackoverflow.com/questions/49498323/when-does-int-time-second-work-and-when-does-it-not-in-golang", "title": "When does `int * time.Second` work and when does it not in golang?", "body": "<p>Why does <code>time.Sleep(5 * time.Second)</code> work fine, but:</p>\n\n<pre><code>x := 180\ntime.Sleep(15 / x * 60 * time.Second)\n</code></pre>\n\n<p>does not? I get a type mismatch error (types <code>int64</code> and <code>time.Duration</code>). Given the error, I understand more of why the latter fails than why the former succeeds.</p>\n"}, {"tags": ["unit-testing", "go", "error-handling"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1522088915, "post_id": 49498183, "comment_id": 86000398, "body": "<a href=\"https://dev.to/danlebrero/the-tragedy-of-100-code-coverage\" rel=\"nofollow noreferrer\">Some people skip them.</a>. If you <i>must</i> have 100% test coverage for some reason, you should probably be mocking/stubbing out all of your stdlib calls."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 2, "creation_date": 1522089717, "post_id": 49498183, "comment_id": 86000814, "body": "Do the Go standard library packages have 100% test coverage? Do all other external packages have 100% test coverage? Do the OS calls have 100% test coverage. Does the hardware have 100% test coverage. Has all posible integer and floating-point arithmetic been tested? How long would this take? Bugs happen: <a href=\"https://en.wikipedia.org/wiki/Pentium_FDIV_bug\" rel=\"nofollow noreferrer\">Intel Pentium FDIV bug</a>. And so on. 100% coverage testing is not possible."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1522091160, "post_id": 49498183, "comment_id": 86001631, "body": "For any non-trivial code (i.e. any code that uses I/O), 100% test coverage is a <i>literal impossibility</i>, as there are literally <i>an infinite number of code execution paths</i> (even assuming identical hardware, etc). So aiming for 100% coverage is a fool&#39;s errand. Although it is often possible to get test coverage tools, like that provided by Go, to report 100%. But that&#39;s not very meaningful, so it&#39;s not a worthy goal."}, {"owner": {"reputation": 21605, "user_id": 1142167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f9MAS.jpg?s=128&g=1", "display_name": "Joel Cornett", "link": "https://stackoverflow.com/users/1142167/joel-cornett"}, "edited": false, "score": 0, "creation_date": 1522126145, "post_id": 49498183, "comment_id": 86013166, "body": "Why do you need 100% coverage?"}, {"owner": {"reputation": 2731, "user_id": 74361, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/adca63afb01fa2d56850114c337476fb?s=128&d=identicon&r=PG", "display_name": "Bart Silverstrim", "link": "https://stackoverflow.com/users/74361/bart-silverstrim"}, "reply_to_user": {"reputation": 21605, "user_id": 1142167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f9MAS.jpg?s=128&g=1", "display_name": "Joel Cornett", "link": "https://stackoverflow.com/users/1142167/joel-cornett"}, "edited": false, "score": 0, "creation_date": 1522163236, "post_id": 49498183, "comment_id": 86038125, "body": "@JoelCornett - Didn&#39;t mean to sound like it&#39;s necessary, I was asking if there&#39;s a common way to test that kind of scenario in an idiotmatic way for Go and how people usually handle that situation."}], "answers": [{"comments": [{"owner": {"reputation": 2061, "user_id": 1520291, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9d8e7bdd418d0b727f76b47e655bc465?s=128&d=identicon&r=PG", "display_name": "Dmytro Titov", "link": "https://stackoverflow.com/users/1520291/dmytro-titov"}, "edited": false, "score": 0, "creation_date": 1581944729, "post_id": 49498938, "comment_id": 106595118, "body": "I kinda agree, but isn&#39;t it a downside of a coverage calculation solution then? I mean, if I covered 100% of my logic, then shouldn&#39;t the coverage reporting tool understand it, instead of just corny calculating the lines of code?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 2061, "user_id": 1520291, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9d8e7bdd418d0b727f76b47e655bc465?s=128&d=identicon&r=PG", "display_name": "Dmytro Titov", "link": "https://stackoverflow.com/users/1520291/dmytro-titov"}, "edited": false, "score": 0, "creation_date": 1581950775, "post_id": 49498938, "comment_id": 106598551, "body": "The downside is in pretending that any coverage tool&#39;s number means more than it means. It&#39;s a literal impossibility to cover &quot;100% of logic&quot; in any modern program, on a modern computer."}, {"owner": {"reputation": 2061, "user_id": 1520291, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9d8e7bdd418d0b727f76b47e655bc465?s=128&d=identicon&r=PG", "display_name": "Dmytro Titov", "link": "https://stackoverflow.com/users/1520291/dmytro-titov"}, "edited": false, "score": 0, "creation_date": 1581950886, "post_id": 49498938, "comment_id": 106598612, "body": "Programmers may understand it, but it&#39;s hard to explain it to project management or even customers (if they care about those metrics)."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 2061, "user_id": 1520291, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9d8e7bdd418d0b727f76b47e655bc465?s=128&d=identicon&r=PG", "display_name": "Dmytro Titov", "link": "https://stackoverflow.com/users/1520291/dmytro-titov"}, "edited": false, "score": 0, "creation_date": 1581950904, "post_id": 49498938, "comment_id": 106598620, "body": "The fact that reality is hard to explain to project managers isn&#39;t something tools can fix."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 4, "last_activity_date": 1533751975, "last_edit_date": 1533751975, "creation_date": 1522091526, "answer_id": 49498938, "question_id": 49498183, "link": "https://stackoverflow.com/questions/49498183/coverage-test-for-standard-library-errors/49498938#49498938", "title": "Coverage test for standard library errors", "body": "<p>There are many non-hardware failure scenarios where most standard library functoins might fail. Whether you care to test those is another question.  For <code>os.Getwd()</code>, for instance, I might expect that call to fail if the working directory doesn't exist, (and you could go to the effort of testing this scenario).</p>\n\n<p>What's probably more useful (and a better testing approach in general), would be to mock those calls, so that you can trigger errors during testing, just so that you can test your error-case code.</p>\n\n<p>But please, for the love of code, don't aim for 100% test coverage.  Aim for <em>useful test coverage</em>.  It is possible to make a tool report 100% coverage without covering useful cases, and it is possible to cover useful cases without making the tool report 100%.</p>\n\n<p>But <em>true</em> 100% coverage is a literal impossibility in most programs (even the simple \"Hello World!\"). So don't aim for it.</p>\n"}, {"comments": [{"owner": {"reputation": 2731, "user_id": 74361, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/adca63afb01fa2d56850114c337476fb?s=128&d=identicon&r=PG", "display_name": "Bart Silverstrim", "link": "https://stackoverflow.com/users/74361/bart-silverstrim"}, "edited": false, "score": 1, "creation_date": 1522246915, "post_id": 49503971, "comment_id": 86080817, "body": "Looks like this was what I was looking for! I understand 100% test coverage isn&#39;t bulletproof and appreciate the pointers behind the philosophy of that viewpoint, but at the same time I feel like I&#39;ve learned something about how the language works (I&#39;ve not run into a situation where I can assign a variable to a function in this way before...)"}], "tags": [], "owner": {"reputation": 996, "user_id": 4909445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ded7e867ff7001048e511974d4c19137?s=128&d=identicon&r=PG&f=1", "display_name": "Shettyh", "link": "https://stackoverflow.com/users/4909445/shettyh"}, "is_accepted": true, "score": 4, "last_activity_date": 1611588236, "last_edit_date": 1611588236, "creation_date": 1522121913, "answer_id": 49503971, "question_id": 49498183, "link": "https://stackoverflow.com/questions/49498183/coverage-test-for-standard-library-errors/49503971#49503971", "title": "Coverage test for standard library errors", "body": "<p>As @flimzy explained in his answer, it is not good to aim for 100% coverage instead aim for useful test coverage.</p>\n<p>Though you can test the system calls with slight modification to the code like this</p>\n<pre><code>package foo\n\n// Get Working directory function\nvar osGetWd = os.Getwd\n\nfunc GetWorkingDirectory() (string,error){\n    strTemp, err := osGetWd() // Using the function defined above\n    if err != nil {\n       return &quot;&quot;, errors.New(&quot;Could not get current working directory&quot;)\n    return strTemp,nil\n}\n</code></pre>\n<p>And while testing</p>\n<pre><code>package foo\n\nfunc TestGetWdError() {\n    // Mocked function for os.Getwd\n    myGetWd := func() (string,error) {\n      myErr := errors.New(&quot;Simulated error&quot;)\n      return &quot;&quot;,myErr\n    }\n\n    // Update the var to this mocked function\n    osGetWd = myGetWd\n\n   // This will return error\n   val,err := GetWorkingDirectory()\n}\n</code></pre>\n<p>This will help you to achieve 100% coverage</p>\n"}], "owner": {"reputation": 2731, "user_id": 74361, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/adca63afb01fa2d56850114c337476fb?s=128&d=identicon&r=PG", "display_name": "Bart Silverstrim", "link": "https://stackoverflow.com/users/74361/bart-silverstrim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1091, "favorite_count": 1, "accepted_answer_id": 49503971, "answer_count": 2, "score": 1, "last_activity_date": 1611588236, "creation_date": 1522088624, "last_edit_date": 1611588221, "question_id": 49498183, "link": "https://stackoverflow.com/questions/49498183/coverage-test-for-standard-library-errors", "title": "Coverage test for standard library errors", "body": "<p>I've been trying to learn about Go's built-in testing framework and getting proper test coverage.</p>\n\n<p>In one of the files I'm testing I'm only getting ~87% coverage:</p>\n\n<p><code>coverage: 87.5% of statements</code></p>\n\n<p>Here's a section of the code covered in the test:</p>\n\n<pre><code>// Check that the working directory is set\nif *strctFlags.PtrWorkDir == \"\" {\n\n// if the working directory is empty, set it to the current directory\nstrTemp, err := os.Getwd()\nif err != nil {\n    return \"\", errors.New(\"Could not get current working directory\")\n}\n\n*strctFlags.PtrWorkDir = strTemp\n\n} else if stat, err := os.Stat(*strctFlags.PtrWorkDir); err != nil ||\n!stat.IsDir() {\n\n    // Existence check of the work dir\n    return \"\", errors.New(\"Specified directory \\\"\" + *strctFlags.PtrWorkDir + \"\\\" could not be found or was not a directory\")\n}\n\n*strctFlags.PtrWorkDir, err = filepath.Abs(*strctFlags.PtrWorkDir)\nif err != nil {\n    return \"\", errors.New(\"Could not determine absolute filepath: \" + err.Error())\n}\n</code></pre>\n\n<p>The parts not covered in the test according to the .out file are the \"if err != nil {}\" blocks, which would be errors returned from standard library calls.</p>\n\n<p>While I think the likelihood of the standard library passing errors would be slim unless there would be hardware failure, I think it would be good to know that the error is handled in the application properly. Also, checking returned errors is, to my understanding, idiomatic Go so I would think it would be good to be able to test error handling properly.</p>\n\n<p>How do people handle testing errors like the situations above? Is it possible to get 100% coverage, or am I doing or structuring something incorrectly? Or do people skip testing those conditions?</p>\n"}, {"tags": ["pointers", "go", "structure"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1522087457, "post_id": 49497832, "comment_id": 85999615, "body": "the shorthand is writing a function if you need it."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1522087548, "post_id": 49497832, "comment_id": 85999666, "body": "The linked code is an extremely contrived example. Maybe with a real use-case it might be easier to offer advice about your particular situation."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1522088186, "creation_date": 1522088186, "answer_id": 49498072, "question_id": 49497832, "link": "https://stackoverflow.com/questions/49497832/whats-the-short-hand-for-assigning-a-value-to-a-field-that-is-a-pointer-type/49498072#49498072", "title": "Whats the short hand for assigning a value to a field that is a pointer type", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype T struct {\n    A *int\n    B string\n}\n\nfunc newT(a int, b string) *T {\n    return &amp;T{A: &amp;a, B: b}\n}\n\nfunc main() {\n    t := newT(1, \"Hello\")\n    fmt.Printf(\"%s, %v\", t.B, *t.A)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Hello, 1\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 9301799, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/eb051a881076864cefa0edcb05fd5b14?s=128&d=identicon&r=PG", "display_name": "heretolearn", "link": "https://stackoverflow.com/users/9301799/heretolearn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 1, "closed_date": 1522090615, "answer_count": 1, "score": 0, "last_activity_date": 1522090717, "creation_date": 1522087418, "last_edit_date": 1522090717, "question_id": 49497832, "link": "https://stackoverflow.com/questions/49497832/whats-the-short-hand-for-assigning-a-value-to-a-field-that-is-a-pointer-type", "closed_reason": "Duplicate", "title": "Whats the short hand for assigning a value to a field that is a pointer type", "body": "<p>I pulled this off: </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype test struct {\n    A *int\n    B string\n}\n\nfunc main() {\n    x := 1\n    var A test\n    A.B = \"hello\"\n    A.A = &amp;x\n    fmt.Printf(\"%s, %v\", A.B, *A.A)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/iMsFBTWkRJU\" rel=\"nofollow noreferrer\">https://play.golang.org/p/iMsFBTWkRJU</a></p>\n\n<p>I know using <code>x:=1</code> and <code>A.A = &amp;x</code> is over doing it. How can I modify and make it simpler?</p>\n\n<p>Thanks for your time </p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1522081530, "post_id": 49496003, "comment_id": 85996262, "body": "You have to pass a pointer to <code>Pipe.All()</code> like: <code>pipeline.All(&amp;result)</code>. Also, what is <code>stages</code>?"}, {"owner": {"reputation": 1148, "user_id": 92049, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/88811849e4e502b6f1a5ffcd791d635c?s=128&d=identicon&r=PG", "display_name": "sebastian", "link": "https://stackoverflow.com/users/92049/sebastian"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1522082230, "post_id": 49496003, "comment_id": 85996715, "body": "I&#39;m on my mobile, sorry. I am actually passing a pointer, updating the question. Stages is a <code>[]bson.M</code>, which gets constructed from json files. It contains the <code>$out</code> operator. Aggregation is running OK, according to mongo shell, but still <code>All</code> fails after the output collection has been populated."}], "answers": [{"tags": [], "owner": {"reputation": 1148, "user_id": 92049, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/88811849e4e502b6f1a5ffcd791d635c?s=128&d=identicon&r=PG", "display_name": "sebastian", "link": "https://stackoverflow.com/users/92049/sebastian"}, "is_accepted": false, "score": 0, "last_activity_date": 1522087783, "creation_date": 1522087783, "answer_id": 49497942, "question_id": 49496003, "link": "https://stackoverflow.com/questions/49496003/execute-mgo-pipe-without-results-including-out/49497942#49497942", "title": "Execute mgo.Pipe without results, including $out", "body": "<p>Solved. Instead of calling <code>All(&amp;result)</code>, call <code>Iter()</code>.</p>\n\n<p><code>All</code> would call <code>Next</code> on an iterator that is empty from the beginning, obviously leading to the timeout.</p>\n\n<p><code>Iter</code> returns an iterator, that will just get discarded. No calls to <code>Next</code>, no timeouts. </p>\n"}], "owner": {"reputation": 1148, "user_id": 92049, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/88811849e4e502b6f1a5ffcd791d635c?s=128&d=identicon&r=PG", "display_name": "sebastian", "link": "https://stackoverflow.com/users/92049/sebastian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522087783, "creation_date": 1522080758, "last_edit_date": 1522082245, "question_id": 49496003, "link": "https://stackoverflow.com/questions/49496003/execute-mgo-pipe-without-results-including-out", "title": "Execute mgo.Pipe without results, including $out", "body": "<p>Im trying to run a Pipe that doesn't return any results, because the last pipeline operator is <code>$out</code>.</p>\n\n<pre><code>// { $out: \"y\" } \npipeline := DB. C(\"x\"). Pipe(stages). AllowDiskUse() \nresult := []bson.M{}\nerr := pipeline.All(&amp;result) \n</code></pre>\n\n<p>When running the pipe with I'm getting a timeout. I assume mgo is waiting for results to be read - forever. </p>\n"}, {"tags": ["xml", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 3, "creation_date": 1522074562, "post_id": 49493308, "comment_id": 85991387, "body": "Have you looked at <code>encoding&#47;xml</code>? You could define a type that models the structure of the xml document, unmarshal the xml into a value of that type with <code>encoding&#47;xml</code>, manipulate the contents of the value, and then marshal the value back into xml."}, {"owner": {"reputation": 31023, "user_id": 306719, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8b5f2224482b0bc3648353d36a0c8814?s=128&d=identicon&r=PG", "display_name": "hguser", "link": "https://stackoverflow.com/users/306719/hguser"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1522110033, "post_id": 49493308, "comment_id": 86009224, "body": "The structure of the xml is not fixed."}], "answers": [{"comments": [{"owner": {"reputation": 31023, "user_id": 306719, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8b5f2224482b0bc3648353d36a0c8814?s=128&d=identicon&r=PG", "display_name": "hguser", "link": "https://stackoverflow.com/users/306719/hguser"}, "edited": false, "score": 1, "creation_date": 1522110441, "post_id": 49498921, "comment_id": 86009302, "body": "We have a log of xml to be processed, and some of them are <code>html</code>s, is there an alternative for html parsing?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 31023, "user_id": 306719, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8b5f2224482b0bc3648353d36a0c8814?s=128&d=identicon&r=PG", "display_name": "hguser", "link": "https://stackoverflow.com/users/306719/hguser"}, "edited": false, "score": 0, "creation_date": 1522168873, "post_id": 49498921, "comment_id": 86042039, "body": "<a href=\"https://godoc.org/golang.org/x/net/html\" rel=\"nofollow noreferrer\">Yes</a>. Also see <a href=\"https://godoc.org/github.com/PuerkitoBio/goquery\" rel=\"nofollow noreferrer\">this</a>."}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 2, "last_activity_date": 1522091472, "creation_date": 1522091472, "answer_id": 49498921, "question_id": 49493308, "link": "https://stackoverflow.com/questions/49493308/replace-text-content-from-xml-and-push-back-in-golng/49498921#49498921", "title": "Replace text content from xml and push back in golng", "body": "<p>Basically there are three approaches I can think of:</p>\n\n<ul>\n<li><p>Define a set of Go types matching the elements of your XML document.\nThen unmarshal the document into a hierarchy of these variables.\nThen apply to these variables whatever updates are needed and\nmarshal them back to an XML document.</p>\n\n<p>The upside of this approach is that it's \"standard\" (requires\njust the <code>encoding/xml</code> standard package) and is \"data-driven\".</p>\n\n<p>The downsides are many:</p>\n\n<ul>\n<li>It may tedious to code up a set of types.</li>\n<li>It may be hard to make work for the cases\nwhen your documents have dynamic structure, or the cases\nwhen you really just want to consider <em>all</em> elements and their text nodes.</li>\n</ul></li>\n<li><p>Do <a href=\"https://en.wikipedia.org/wiki/Simple_API_for_XML\" rel=\"nofollow noreferrer\">\"SAX-style\" processing</a>:\n<code>encoding/xml</code> allows you to \"step-through\"\neach XML node \u2014 as the parser decodes them.</p>\n\n<p>So it's possible to create a <code>Decoder</code> reading the source document\nand an <code>Encoder</code> \u2014 producing the resulting one.\nEach token decoded by the decoder gets encoded by the encoder\neither right away or after certain processing on your side\n(which may result in adding more tokens).</p>\n\n<p>Unfortunately, if you need to maintain some context between\nvisiting different tokens (so, say, only modify text nodes of the\nelements which are on certain paths in the document),\n<a href=\"https://github.com/golang/go/issues/22290#issuecomment-363235274\" rel=\"nofollow noreferrer\">this is not doable easily</a>\n(though still possible, of course).</p></li>\n<li><p>Use a full-blown <a href=\"https://en.wikipedia.org/wiki/XSLT\" rel=\"nofollow noreferrer\">XSLT processing</a>.</p>\n\n<p>You may look at <a href=\"https://godoc.org/github.com/jbowtie/ratago/xslt\" rel=\"nofollow noreferrer\">this</a>.</p></li>\n</ul>\n"}], "owner": {"reputation": 31023, "user_id": 306719, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8b5f2224482b0bc3648353d36a0c8814?s=128&d=identicon&r=PG", "display_name": "hguser", "link": "https://stackoverflow.com/users/306719/hguser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 49498921, "answer_count": 1, "score": 0, "last_activity_date": 1522110079, "creation_date": 1522072806, "last_edit_date": 1522110079, "question_id": 49493308, "link": "https://stackoverflow.com/questions/49493308/replace-text-content-from-xml-and-push-back-in-golng", "title": "Replace text content from xml and push back in golng", "body": "<p>For a given XML document, I want to extract all the text content exclude some certain tags and do some transformation with the content and push the modified content back to the position where they are exacted.</p>\n\n<p>I tried to generate a tree(saying a nested <code>map</code>) for the document, and after the transformation, build the document by the tree again.</p>\n\n<p>However I have not find any library I can used in golang.</p>\n\n<p>Is this possible?</p>\n\n<hr>\n\n<p>update:</p>\n\n<p>The structure of the xml document are not fixed.</p>\n"}, {"tags": ["c++", "macos", "go", "cross-compiling", "cgo"], "answers": [{"comments": [{"owner": {"reputation": 605, "user_id": 983835, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/DGXZW.png?s=128&g=1", "display_name": "The Architect", "link": "https://stackoverflow.com/users/983835/the-architect"}, "edited": false, "score": 0, "creation_date": 1522238859, "post_id": 49517814, "comment_id": 86074433, "body": "Thank you for suggestion, but I am looking for the way to build one solid binary."}], "tags": [], "owner": {"reputation": 4072, "user_id": 2068077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5610681612bdc756a85d009e399f33?s=128&d=identicon&r=PG", "display_name": "ivoszz", "link": "https://stackoverflow.com/users/2068077/ivoszz"}, "is_accepted": false, "score": 1, "last_activity_date": 1522224531, "last_edit_date": 1522224531, "creation_date": 1522167278, "answer_id": 49517814, "question_id": 49492589, "link": "https://stackoverflow.com/questions/49492589/cross-compiling-golang-with-cgo-for-windows-target-on-macos-host/49517814#49517814", "title": "Cross compiling golang with cgo for Windows target on macOS host", "body": "<p>It is probably not what you want to hear but the easiest way to cross compile to windows on Mac is to build a DLL library from your <code>c/c++</code> code and handle this DLL library from your <code>go</code> code. In this situation you even don't need <code>CGO_ENABLED=1</code>.</p>\n\n<p>The <code>go</code> code can look like this (not tested):</p>\n\n<pre><code>// +build windows\n\npackage qrcode\n\nimport (\n    \"errors\"\n    \"fmt\"\n    \"syscalls\"\n    \"unsafe\"\n)\n\nvar modYourPkg = syscall.NewLazyDLL(\"yourpkg.dll\")\n\nvar procFindAndDecodeQR = modYourPkg.NewProc(\"FindAndDecodeQR\")\n\nfunc SimpleQRDecode(rasterData []byte, width, height int) (string, bool, error) {\n    res, _, _ := procFindAndDecodeQR.Call(\n        uintptr(unsafe.Pointer(&amp;rasterData[0])),\n        uintptr(len(data)),\n        uintptr(width),\n        uintptr(height),\n    )\n    ...\n}\n</code></pre>\n\n<p>See more in documentation to the syscall package.</p>\n"}], "owner": {"reputation": 605, "user_id": 983835, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/DGXZW.png?s=128&g=1", "display_name": "The Architect", "link": "https://stackoverflow.com/users/983835/the-architect"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1093, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1522224531, "creation_date": 1522070714, "question_id": 49492589, "link": "https://stackoverflow.com/questions/49492589/cross-compiling-golang-with-cgo-for-windows-target-on-macos-host", "title": "Cross compiling golang with cgo for Windows target on macOS host", "body": "<p>I am on macOS and trying to cross compile golang (CGO 1.10) executable for Windows using mingw-w64 installed from homebrew.</p>\n\n<p>I have golang package with only one function (SimpleQRDecode) that calls other function from my c++ source (FindAndDecodeQR, uses zxing c++ port).</p>\n\n<ol>\n<li>Compiling ZXing sources is fine (x86_64-w64-mingw32-g++)</li>\n<li>Compiling qrcode.cpp is fine (x86_64-w64-mingw32-g++)</li>\n<li>Successfully merged all objects (zxing + my) into static library (x86_64-w64-mingw32-ar)</li>\n<li>Successfully called ranlib on static library (x86_64-w64-mingw32-ranlib)</li>\n<li><strong>FAILED</strong> to call <code>CGO_ENABLED=1 CXX=\"x86_64-w64-mingw32-g++\" CXX_FOR_TARGET=\"x86_64-w64-mingw32-g++\" CC=\"x86_64-w64-mingw32-gcc\" CC_FOR_TARGET=\"x86_64-w64-mingw32-gcc\" GOOS=windows GOARCH=amd64 go build -x</code></li>\n</ol>\n\n<p><code>go build</code> output consists of tons of unresolved symbol messages like</p>\n\n<pre><code>libmyqr.a(qrcode.o):qrcode.cpp:(.text+0x79): undefined reference to `operator new(unsigned long long)'\nlibmyqr.a(qrcode.o):qrcode.cpp:(.text+0x2cb): undefined reference to `std::string::length() const'\nlibmyqr.a(qrcode.o):qrcode.cpp:(.text+0x4a7): undefined reference to `__cxa_begin_catch'\nlibmyqr.a(BinaryBitmap.cpp.obj):BinaryBitmap.cpp:(.text+0x5c2): undefined reference to `std::ios_base::Init::~Init()'\nlibmyqr.a(BinaryBitmap.cpp.obj):BinaryBitmap.cpp:(.xdata+0xc): undefined reference to `__gxx_personality_seh0'\n</code></pre>\n\n<p>qrcode.go:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package qrcode\n\n/*\n#cgo CFLAGS: -I../../native/prefix/include -I../../libmyqr -fPIC\n#cgo CXXFLAGS: -I../../native/prefix/include -I../../libmyqr -fPIC\n#cgo LDFLAGS: -L../../libmyqr -lmyqr -lstdc++\n#include &lt;stdlib.h&gt;\n#include &lt;qrcode.h&gt;\n*/\nimport \"C\"\n\nimport (\n    \"errors\"\n    \"fmt\"\n    \"unsafe\"\n)\n\nfunc SimpleQRDecode(rasterData []byte, width, height int) (string, bool, error) {\n    res := C.FindAndDecodeQR((*C.char)(unsafe.Pointer(&amp;data[0])), C.int(len(data)), C.int(width), C.int(height))\n</code></pre>\n\n<p>qrcode.h:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#ifdef __cplusplus\nextern \"C\" {\n#endif\n\nconst char* FindAndDecodeQR(char *raster, int size, int width, int height);\n\n\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n\n<p>qrcode.cpp:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include \"qrcode.h\"\n\n#include &lt;sstream&gt;\n\n#include &lt;zxing/ZXing.h&gt;\n#include &lt;zxing/Binarizer.h&gt;\n#include &lt;zxing/BinaryBitmap.h&gt;\n#include &lt;zxing/Result.h&gt;\n#include &lt;zxing/qrcode/QRCodeReader.h&gt;\n#include &lt;zxing/common/GreyscaleRotatedLuminanceSource.h&gt;\n#include &lt;zxing/common/GlobalHistogramBinarizer.h&gt;\n\nconst char* FindAndDecodeQR(char *raster, int size, int width, int height) {\n    // GreyscaleLuminanceSource\n\n    std::ostringstream resStream;\n\n    try {\n        zxing::ArrayRef&lt;char&gt; image(raster, size);\n        zxing::Ref&lt;zxing::GreyscaleRotatedLuminanceSource&gt; source(new zxing::GreyscaleRotatedLuminanceSource(image, width, height, 0, 0, width, height));\n</code></pre>\n\n<p>libmyqr.a - static library made of all zxing compiled objects + qrcode.cpp.o</p>\n"}, {"tags": ["go", "visual-studio-code"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 8, "creation_date": 1522071466, "post_id": 49492546, "comment_id": 85989091, "body": "One folder == exactly one package. Do <b>not</b> put different packages into one folder. Never. Read How to Write Go Code and stick to it."}, {"owner": {"reputation": 1445, "user_id": 5972487, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/024fcbdd0ee00e2dccefce0ef67bc434?s=128&d=identicon&r=PG", "display_name": "elmiomar", "link": "https://stackoverflow.com/users/5972487/elmiomar"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1522110125, "post_id": 49492546, "comment_id": 86009238, "body": "@Volker is right. Read <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a>."}], "owner": {"reputation": 17, "user_id": 2602675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd0b1f69dc08d0b3c295346d8d199b4?s=128&d=identicon&r=PG", "display_name": "Scott Taylor", "link": "https://stackoverflow.com/users/2602675/scott-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522070581, "creation_date": 1522070581, "question_id": 49492546, "link": "https://stackoverflow.com/questions/49492546/package-error-that-moves-when-saving-source-files", "title": "Package error that moves when saving source files", "body": "<p>I've started building a small web app with Go in VS Code and I keep getting this error on the package line:</p>\n\n<pre><code>can't load package: package fantasy_stats: found packages jsontest (jsontest.go) and main (main.go) in /home/scott/programming/golang/src/fantasy_stats\n</code></pre>\n\n<p>What's strange is whenever I save one of my 3 source files, the error disappears from the other files and appears in the most recently saved file.</p>\n\n<p>My <code>$GOPATH</code> is set to <code>$HOME/programming/golang</code> and the 3 files are in the directory shown in the error: <code>$HOME/programming/golang/src/fantasy_stats</code>.  Two of the files (<code>main.go</code> and <code>results_handler.go</code>) are <code>package main</code> and the one other (<code>jsontest.go</code>) is <code>package jsontest</code> (this is just a tiny side program to generate test data and isn't used in the other files).  <code>func main()</code> is also only in <code>main.go</code> for the <code>package main</code> files.  Renaming <code>main.go</code> to <code>fantasy_stats.go</code> has no effect on the error.</p>\n\n<p>How can I fix this error?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1522069878, "post_id": 49492291, "comment_id": 85987984, "body": "<code>exec.Command</code> isn&#39;t a shell, see the documentation, and examples: <a href=\"https://golang.org/pkg/os/exec/#example_Cmd_CombinedOutput\" rel=\"nofollow noreferrer\">golang.org/pkg/os/exec/#example_Cmd_CombinedOutput</a>"}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 3, "creation_date": 1522069934, "post_id": 49492291, "comment_id": 85988017, "body": "Why don&#39;t you just run <code>docker version</code> rather than trying to execute a script, which isn&#39;t going to work? Or, better yet, use the docker client library for Go."}], "answers": [{"tags": [], "owner": {"reputation": 1445, "user_id": 5972487, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/024fcbdd0ee00e2dccefce0ef67bc434?s=128&d=identicon&r=PG", "display_name": "elmiomar", "link": "https://stackoverflow.com/users/5972487/elmiomar"}, "is_accepted": false, "score": 1, "last_activity_date": 1522080775, "last_edit_date": 1592644375, "creation_date": 1522080775, "answer_id": 49496006, "question_id": 49492291, "link": "https://stackoverflow.com/questions/49492291/how-to-run-variable-as-shell-script-file/49496006#49496006", "title": "How to run variable as shell script file", "body": "<p>From official <a href=\"https://golang.org/pkg/os/exec/#Command\" rel=\"nofollow noreferrer\">doc</a>:</p>\n<blockquote>\n<p>func Command(name string, arg ...string) *Cmd</p>\n<p>Command returns the Cmd struct to execute the named program with the given arguments.</p>\n</blockquote>\n<p>Try this:</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;os/exec&quot;\n)\n\nfunc main() {\n    out, err := exec.Command(&quot;docker&quot;, &quot;version&quot;).Output()\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(&quot;Docker version is: %s\\n&quot;, out)\n}\n</code></pre>\n<p>Useful links for further details:</p>\n<ul>\n<li><a href=\"https://golang.org/pkg/os/exec/\" rel=\"nofollow noreferrer\">exec</a></li>\n<li><a href=\"https://golang.org/src/os/exec/example_test.go\" rel=\"nofollow noreferrer\">examples</a></li>\n</ul>\n<p><strong>Note</strong>: make sure docker is installed on your machine.</p>\n"}], "owner": {"reputation": 593, "user_id": 4273375, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/394947ca0e4bf377dacf12d32a424671?s=128&d=identicon&r=PG&f=1", "display_name": "Test admin", "link": "https://stackoverflow.com/users/4273375/test-admin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1522080775, "creation_date": 1522069790, "question_id": 49492291, "link": "https://stackoverflow.com/questions/49492291/how-to-run-variable-as-shell-script-file", "title": "How to run variable as shell script file", "body": "<p>I need to run a variable as shell script file in golang. I tried like below code</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os/exec\"\n)\n\nfunc main() {\n   var namespaceYaml string = `#!/bin/bash\ndocker verson`\n\n   out, err := exec.Command(namespaceYaml).Output()\n   fmt.Println(err, string(out))\n}\n</code></pre>\n\n<p>But I cannot get any result. I cannot find where is the mistake. </p>\n\n<p>Please anyone to fix this issue. Thanks in advance.</p>\n"}, {"tags": ["go", "apache-kafka", "sarama"], "answers": [{"tags": [], "owner": {"reputation": 18208, "user_id": 1765189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/673318e1268e43679dc9ab6835a39604?s=128&d=identicon&r=PG", "display_name": "Mickael Maison", "link": "https://stackoverflow.com/users/1765189/mickael-maison"}, "is_accepted": false, "score": 1, "last_activity_date": 1522071477, "creation_date": 1522071477, "answer_id": 49492862, "question_id": 49490835, "link": "https://stackoverflow.com/questions/49490835/kafka-server-offsets-topic-has-not-yet-been-created/49492862#49492862", "title": "kafka server: Offset&#39;s topic has not yet been created", "body": "<p>The <code>__consumer_offsets</code> topic is created automatically when a consumer using a group connects to the cluster.</p>\n\n<p>By default, Sarama does not support groups (<a href=\"https://github.com/Shopify/sarama/wiki/Frequently-Asked-Questions#how-can-i-use-sarama-to-monitor-or-join-a-consumer-group\" rel=\"nofollow noreferrer\">https://github.com/Shopify/sarama/wiki/Frequently-Asked-Questions#how-can-i-use-sarama-to-monitor-or-join-a-consumer-group</a>), so unless you are using the cluster extension (<a href=\"https://github.com/bsm/sarama-cluster\" rel=\"nofollow noreferrer\">https://github.com/bsm/sarama-cluster</a>) this is expected.</p>\n\n<p>You can use the <code>kafka-console-consumer.sh</code> tool that comes with Kafka to create it if you want.</p>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 8205634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1e2f1d1b65e38dc694588a8273854de?s=128&d=identicon&r=PG&f=1", "display_name": "Victor  EStalin", "link": "https://stackoverflow.com/users/8205634/victor-estalin"}, "is_accepted": true, "score": 1, "last_activity_date": 1523903608, "last_edit_date": 1523903608, "creation_date": 1522072212, "answer_id": 49493121, "question_id": 49490835, "link": "https://stackoverflow.com/questions/49490835/kafka-server-offsets-topic-has-not-yet-been-created/49493121#49493121", "title": "kafka server: Offset&#39;s topic has not yet been created", "body": "<p>The reason was successfully found in logs : <code>Number of alive brokers '1' does not meet the required replication factor '3' for the offsets topic</code> \nyou need to post into your <code>server.properties</code> file following option : <code>offsets.topic.replication.factor=1</code>. This option will not let you do anything till the count reaches 3 but since you have it set as a playbox - you usually have 1 only.</p>\n"}], "owner": {"reputation": 73, "user_id": 8205634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1e2f1d1b65e38dc694588a8273854de?s=128&d=identicon&r=PG&f=1", "display_name": "Victor  EStalin", "link": "https://stackoverflow.com/users/8205634/victor-estalin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3596, "favorite_count": 0, "accepted_answer_id": 49493121, "answer_count": 2, "score": 2, "last_activity_date": 1523903608, "creation_date": 1522065180, "last_edit_date": 1522936829, "question_id": 49490835, "link": "https://stackoverflow.com/questions/49490835/kafka-server-offsets-topic-has-not-yet-been-created", "title": "kafka server: Offset&#39;s topic has not yet been created", "body": "<p>I'm using Kafka server 0.9 + zookeper. I'm new with Kafka. It's running in virtualbox , I can connect to it using public IP so it's working ... more or less: can get topics and messages.\nSo for now I have 2 issues:</p>\n\n<ol>\n<li><p>I can't find anything at __consumer_offsets (empty) and that's why I've got issue with the go simple consumer script throwing error: <code>kafka server: Offset's topic has not yet been created</code>; when i check at zookeeper-shell.sh console by command <code>ls /brokers/topics/__consumer_offsets</code> it errors me : <code>Node does not exist: /brokers/topics/__consumer_offsets</code></p></li>\n<li><p>(maybe they are connected) I've got minor warning when autocreating topic: <code>WARN  NetworkClient - Error while fetching metadata with correlation id 4157 : {topicName=LEADER_NOT_AVAILABLE}</code></p></li>\n</ol>\n\n<p>Any help it highly appreciated. Thanks!</p>\n"}, {"tags": ["go", "type-definition"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1522065201, "post_id": 49490742, "comment_id": 85984622, "body": "These are broad questions: Yes, this is not unreasonable. If EntityId and Attribute Number might acquire methods it is very reasonable. Stop when it doesn&#39;t make sense. Strings are strings and ints are ints. Do not fall into the &quot;but what if I want to change it someday?&quot;-trap. First you won&#39;t make most changes and second: Changing in Go is simple."}], "answers": [{"comments": [{"owner": {"reputation": 926, "user_id": 5341805, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/5ZPCu.png?s=128&g=1", "display_name": "skaldesh", "link": "https://stackoverflow.com/users/5341805/skaldesh"}, "edited": false, "score": 0, "creation_date": 1522066097, "post_id": 49490863, "comment_id": 85985219, "body": "Especially your second point (as documentation) was what I had in mind, because I have a lot of types that have the same type (for example uint64) but mean totally different things. Sometimes, these properties are used as keys in maps, which makes it even more confusing, when you use them at different locations in the code"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1522066225, "post_id": 49490863, "comment_id": 85985312, "body": "Also, to avoid confusion and mistakes, like if you have a function that would otherwise take 3 uint64 arguments, all of which are IDs."}, {"owner": {"reputation": 926, "user_id": 5341805, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/5ZPCu.png?s=128&g=1", "display_name": "skaldesh", "link": "https://stackoverflow.com/users/5341805/skaldesh"}, "edited": false, "score": 0, "creation_date": 1522066379, "post_id": 49490863, "comment_id": 85985443, "body": "yes exactly. Until now, my documentation was to give the parameters very descriptive names, like entityId uint64, databaseId uint64, etc... With type definitions, this becomes way clearer"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1522077270, "post_id": 49490863, "comment_id": 85993538, "body": "It also provides additional type safety. You can&#39;t have <code>a MyIDType</code> and <code>b uint64</code> and then <code>c := a + b</code> without a type conversion. This can sometimes help prevent simple mistakes at compile time (though it doesn&#39;t prevent mistakes with untyped constant literals)."}, {"owner": {"reputation": 926, "user_id": 5341805, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/5ZPCu.png?s=128&g=1", "display_name": "skaldesh", "link": "https://stackoverflow.com/users/5341805/skaldesh"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1522139873, "post_id": 49490863, "comment_id": 86020260, "body": "@Adrian: This is reaaaally a good point. It makes my decision on which types should get an own defined custom type way easier and clearer. Everytime I have properties that have the same type and are used frequently in the same locations and can easily be switched (e.g. a method requires params id1 uint64 and id2 uint64, but you accidentally call the method with (id2, id1)) a custom type is the solution here"}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 2, "last_activity_date": 1522087871, "last_edit_date": 1522087871, "creation_date": 1522065288, "answer_id": 49490863, "question_id": 49490742, "link": "https://stackoverflow.com/questions/49490742/when-to-use-type-definition-for-basic-types/49490863#49490863", "title": "When to use type definition for basic types", "body": "<p>There's no hard and fast rule about when to use a custom type.  My personal rule would be:</p>\n\n<h2>Use a custom type when there's a reason.</h2>\n\n<p>Your reason, of wanting to change the underlying type in a single location seems like a good reason.</p>\n\n<p>Other good reasons would be:</p>\n\n<ul>\n<li>To assign a custom JSON (un)marshaler, or other interface method</li>\n<li>As documentation</li>\n<li>In conjunction with constants, to act as an enum</li>\n<li>Improved type safety (avoid accidentally assigning a <code>FooID</code> to a <code>BarID</code>)</li>\n</ul>\n"}], "owner": {"reputation": 926, "user_id": 5341805, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/5ZPCu.png?s=128&g=1", "display_name": "skaldesh", "link": "https://stackoverflow.com/users/5341805/skaldesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 1, "accepted_answer_id": 49490863, "answer_count": 1, "score": 0, "last_activity_date": 1522087871, "creation_date": 1522064892, "last_edit_date": 1522064961, "question_id": 49490742, "link": "https://stackoverflow.com/questions/49490742/when-to-use-type-definition-for-basic-types", "title": "When to use type definition for basic types", "body": "<p>My question is about the type definition in Go and when to use it for basic types.<br>\nConsider the following example.<br>\nI have this struct which represents a row from my Database:  </p>\n\n<pre><code>type DBEntityAttribute struct {\n    Id              uint64\n    EntityId        uint64\n    EndPointNumber  uint8\n    AttributeNumber uint8\n    ParentId        uint64\n    Value           string\n    Tag             int\n    ContentType     sql.NullString\n    Maturity        int\n    Author          int\n    AttributeType   string\n    IsNegated       bool\n}\n</code></pre>\n\n<p>The EntityId and AttributeNumber are properties I use in A LOT of other structs everywhere in the code.<br>\nNow I wanted to refactor it to something like this:  </p>\n\n<pre><code>type EntityId uint64\n\ntype AttributeNumber uint8\n\ntype DBEntityAttribute struct {\n        Id              uint64\n        EntityId        EntityId\n        EndPointNumber  uint8\n        AttributeNumber AttributeNumber\n        ParentId        uint64\n        Value           string\n        Tag             int\n        ContentType     sql.NullString\n        Maturity        int\n        Author          int\n        AttributeType   string\n        IsNegated       bool\n    }\n</code></pre>\n\n<p>This would allow me to change the type of the EntityId and AttributeNumber at one single place. Also, when I pass for example an entityId as a function parameter, I can now give it the specific EntityId type, instead of the anonymous uint64.  </p>\n\n<p>My question is now:  </p>\n\n<ul>\n<li>is this considered good Go code? </li>\n<li>where should I stop, meaning should I declare a distinct type for every property that is used elsewhere in the code? Or only for the important ones?</li>\n</ul>\n\n<p>I know this is probably subjective, but often the Go community agrees on certain patterns and I want to comply with their guidelines.</p>\n"}, {"tags": ["go", "time"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1522065382, "post_id": 49490318, "comment_id": 85984746, "body": "Then you redesign until measuring is again possible. If you do not have 5000 accurate clocks you cannot measure 5000 time spans concurrently. This is a physical truth, unrelated to Go. You have to find a different solution, e.g. sampling, averaging or other statistical tricks or sacrifying accuracy."}], "answers": [{"comments": [{"owner": {"reputation": 325, "user_id": 2414380, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Jnq1q.png?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/2414380/prune"}, "edited": false, "score": 0, "creation_date": 1522160685, "post_id": 49492347, "comment_id": 86035917, "body": "Thanks for this test script.  <code>go test time_test.go -bench=. -benchtime=1s</code> <code>goos: linux</code> <code>goarch: amd64</code> <code>BenchmarkNow-8     \t20000000\t        82.0 ns&#47;op</code> <code>BenchmarkSince-8   \t10000000\t       169 ns&#47;op</code> <code>PASS</code> <code>ok  \tcommand-line-arguments\t3.628s</code>  <code>go version</code> <code>go version go1.10 linux&#47;amd64</code>  This is running in a K8s cluster on GKE."}, {"owner": {"reputation": 325, "user_id": 2414380, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Jnq1q.png?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/2414380/prune"}, "edited": false, "score": 0, "creation_date": 1522160740, "post_id": 49492347, "comment_id": 86035959, "body": "My real concern is, if I instrument my micro-services with Prometheus Histograms, which record <code>time.Duration</code>, to gather values for each requests, I will make a <code>time.Now()</code> then a <code>time.Duration().Seconds()</code> as many times per second as I have a request.   I just wanted to evaluate the cost of each of these calls to ensure my metrology will not get the bottleneck of my microservices :)"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1522071439, "last_edit_date": 1522071439, "creation_date": 1522069954, "answer_id": 49492347, "question_id": 49490318, "link": "https://stackoverflow.com/questions/49490318/measuring-time-in-go-routines/49492347#49492347", "title": "Measuring time in Go Routines", "body": "<p>Time measurement depends on the programming language and its implementation, the operating system and its implementation, the hardware architecture, implementation, and speed, and so on. </p>\n\n<p>You need to focus on facts, not speculation. In Go, start with some benchmarks. For example,</p>\n\n<p><code>since_test.go</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"testing\"\n    \"time\"\n)\n\nvar now time.Time\n\nfunc BenchmarkNow(b *testing.B) {\n    for N := 0; N &lt; b.N; N++ {\n        now = time.Now()\n    }\n}\n\nvar since time.Duration\nvar start time.Time\n\nfunc BenchmarkSince(b *testing.B) {\n    for N := 0; N &lt; b.N; N++ {\n        start = time.Now()\n        since = time.Since(start)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ go test since_test.go -bench=. -benchtime=1s\ngoos: linux\ngoarch: amd64\nBenchmarkNow-4      30000000            47.5 ns/op\nBenchmarkSince-4    20000000            98.1 ns/op\nPASS\nok      command-line-arguments  3.536s\n$ go version\ngo version devel +48c4eeeed7 Sun Mar 25 08:33:21 2018 +0000 linux/amd64\n$ uname -srvio\nLinux 4.13.0-37-generic #42-Ubuntu SMP Wed Mar 7 14:13:23 UTC 2018 x86_64 GNU/Linux\n$ cat /proc/cpuinfo | grep 'model name' | uniq\nmodel name  : Intel(R) Core(TM) i7-7500U CPU @ 2.70GHz\n$ \n</code></pre>\n\n<p>Now, ask yourself if 5,000 times per second is necessary, practical, and reasonable. </p>\n\n<p>What are your benchmark results?</p>\n"}], "owner": {"reputation": 325, "user_id": 2414380, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Jnq1q.png?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/2414380/prune"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 486, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1522071439, "creation_date": 1522063532, "last_edit_date": 1522071391, "question_id": 49490318, "link": "https://stackoverflow.com/questions/49490318/measuring-time-in-go-routines", "title": "Measuring time in Go Routines", "body": "<p>Measuring time around a function is easy in Go.\nBut what if you need to measure it 5000 times per second in parallel? </p>\n\n<p>I'm referring to <a href=\"https://stackoverflow.com/questions/45791241/correctly-measure-time-duration-in-go/45791349\">Correctly measure time duration in Go</a> which contains great answers about how to measure time in Go.</p>\n\n<p>What is the cost of using time.Now() 5000 times per second or more? \nWhile it may depend on the underlying OS, let's consider on linux.</p>\n"}, {"tags": ["html", "mongodb", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1522061748, "post_id": 49489736, "comment_id": 85982216, "body": "Either fetch the data using AJAX call and display using JavaScript, or use Go&#39;s standard <a href=\"https://golang.org/pkg/html/template/\" rel=\"nofollow noreferrer\">template engine</a> and render the HTML at server side. You just have a &quot;static&quot; HTML document, it&#39;s not a Go HTML template. Also check the documentation of <a href=\"https://golang.org/pkg/text/template/\" rel=\"nofollow noreferrer\"><code>text&#47;template</code></a>, its API is indentical to <code>html&#47;template</code> and is more verbose."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9092006"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1522065584, "post_id": 49489736, "comment_id": 85984872, "body": "@icza will you edit my code where. I do mistake?"}, {"owner": {"reputation": 470, "user_id": 9219620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7bddbf0c416e48b5224e84c43caf022?s=128&d=identicon&r=PG&f=1", "display_name": "Puneet", "link": "https://stackoverflow.com/users/9219620/puneet"}, "edited": false, "score": 1, "creation_date": 1522231018, "post_id": 49489736, "comment_id": 86068822, "body": "check the documentation of <a href=\"https://golang.org/pkg/text/template/\" rel=\"nofollow noreferrer\"><code>text&#47;template</code></a>"}], "owner": {"user_type": "does_not_exist", "display_name": "user9092006"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1522062198, "creation_date": 1522061607, "last_edit_date": 1522062198, "question_id": 49489736, "link": "https://stackoverflow.com/questions/49489736/how-to-assign-the-values-produce-by-go-to-the-text-fields-of-html", "title": "How to assign the values produce by GO to the text fields of HTML?", "body": "<p>I am new on GO. The following code will save and retrieve the data from database (mongodb) document name <code>profile</code>. </p>\n\n<p><strong>GO code</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"gopkg.in/mgo.v2\"\n    \"gopkg.in/mgo.v2/bson\"\n    \"html/template\"\n    \"log\"\n    \"net/http\"\n)\n\ntype USER struct {\n   FirstName string `json:\"FirstName\"`\n   LastName  string `json:\"LastName\"`\n   Email     string `json:\"Email\"`\n   Mobile    string `json:\"Mobile\"`\n}\n\nfunc login(w http.ResponseWriter, r *http.Request) {\n    fmt.Println(\"method:\", r.Method)\n    if r.Method == \"GET\" {\n        t, _ := template.ParseFiles(\"index.html\")\n        t.Execute(w, nil)\n    } else {\n        r.ParseForm()\n        //fmt.Println(r.Form)\n        if r.Form[\"button\"][0] == \"Submit\" {\n            fmt.Println(r.Form)\n            session, err := mgo.Dial(\"mongodb://127.0.0.1:27017/user\")\n            if err != nil {\n                panic(err)\n            }\n            defer session.Close()\n            session.SetMode(mgo.Monotonic, true)\n            c := session.DB(\"user\").C(\"profile\")\n            doc := USER{\n                FirstName: r.Form[\"first\"][0],\n                LastName:  r.Form[\"last\"][0],\n                Email:     r.Form[\"email\"][0],\n                Mobile:    r.Form[\"mobile\"][0],\n            }\n            err = c.Insert(doc)\n            if err != nil {\n                panic(err)\n            }\n        } else {\n            session, err := mgo.Dial(\"mongodb://127.0.0.1:27017/user\")\n            if err != nil {\n                panic(err)\n            }\n            defer session.Close()\n            session.SetMode(mgo.Monotonic, true)\n            c := session.DB(\"user\").C(\"profile\")\n            if c!=nil{\n            result := USER{}\n            err = c.Find(bson.M{\"email\": r.Form[\"email\"][0] }).Select(bson.M{\"firstname\":\"firstname\", \"lastname\":\"lastname\", \"email\":\"email\", \"mobile\":\"mobile\"}).One(&amp;result)\n            if err != nil {\n                panic(err)\n            }\n            fmt.Println(\"FirstName\", result)\n            fmt.Println(\"FirstName\", result.FirstName)\n            fmt.Println(\"LastName\", result.LastName)\n            fmt.Println(\"Email\", result.Email)\n            fmt.Println(\"Mobile\", result.Mobile)\n        }\n    }\n}\n\nfunc main() {\n    http.HandleFunc(\"/login\", login)\n    err := http.ListenAndServe(\":9090\", nil)\n    if err != nil {\n        log.Fatal(\"ListenAndServe: \", err)\n    }\n}\n</code></pre>\n\n<p><strong>HTML</strong></p>\n\n<pre><code>&lt;script src=\"https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;form id=\"form1\" method=\"post\"&gt;\n        &lt;input id= \"firstname\" type=\"text\" name=\"FirstName\"  placeholder=\"Enter your firstname\"&gt;&lt;br&gt;&lt;br&gt;\n        &lt;input id= \"lastname\" type=\"text\" name=\"LastName\" placeholder=\"Enter your lastname\"&gt;&lt;br&gt;&lt;br&gt;\n        &lt;input id= \"email\" type=\"text\" name=\"Email\" placeholder=\"Enter your email\"&gt;&lt;br&gt;&lt;br&gt;\n        &lt;input id= \"mobile\" type=\"text\" name=\"Mobile\" placeholder=\"Enter your mobile\"&gt;&lt;br&gt;&lt;br&gt;\n        &lt;button id= \"button1\" class=\"button\" name=\"button\" type=\"button\" value=\"Submit\"&gt;Submit&lt;/button&gt;\n        &lt;button id= \"button2\" class=\"button\" name=\"button\" type=\"submit\" value=\"Search\"&gt;Search&lt;/button&gt;\n    &lt;/form&gt;\n    &lt;script&gt;\n        $(document).ready(function(){\n            $('.button').click(function(){\n                var id = $(this).attr('value');\n                alert(id);\n            });\n            $('.button').on('click', function(e){\n                button=this.value;\n                console.log(button);\n                e.preventDefault();\n                var FirstName =$(\"#firstname\").val(),\n                LastName =$(\"#lastname\").val(),\n                Email =$(\"#email\").val(),\n                Mobile =$(\"#mobile\").val();\n                console.log(FirstName);\n                $.ajax({\n                    url:\"/login\",\n                    type:\"POST\",\n                    data: {'button':button, \"first\":FirstName, \"last\":LastName, \"email\":Email, \"mobile\":Mobile},\n                    success: function(results) {\n                        console.log(results);\n                        $('#response').html(results);\n                    }\n                });\n            });\n        });\n    &lt;/script&gt;\n</code></pre>\n\n<p>This is the code from which data can save through ajax request in the database document <code>profile</code>. when, I want to retrieve the data from the database then it retrieve the data but in <strong><em>terminal only</em></strong> I searched it for google <strong>how to assign the value of go to html tags</strong> but not got success. So tell me how to solve this problem.</p>\n"}, {"tags": ["mysql", "sql", "postgresql", "go"], "comments": [{"owner": {"reputation": 8922, "user_id": 2275388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47b224367317978c24098291153cb1c6?s=128&d=identicon&r=PG", "display_name": "Jim Jones", "link": "https://stackoverflow.com/users/2275388/jim-jones"}, "edited": false, "score": 0, "creation_date": 1522061891, "post_id": 49489538, "comment_id": 85982322, "body": "<code>Upsert</code> is what you&#39;re looking for: <a href=\"https://chartio.com/resources/tutorials/how-to-insert-if-row-does-not-exist-upsert-in-mysql/#using-insert-ignore\" rel=\"nofollow noreferrer\">chartio.com/resources/tutorials/&hellip;</a>"}, {"owner": {"reputation": 59, "user_id": 9503747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/117e7dfc4c78542591bf46f210152b47?s=128&d=identicon&r=PG&f=1", "display_name": "Medone", "link": "https://stackoverflow.com/users/9503747/medone"}, "reply_to_user": {"reputation": 8922, "user_id": 2275388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47b224367317978c24098291153cb1c6?s=128&d=identicon&r=PG", "display_name": "Jim Jones", "link": "https://stackoverflow.com/users/2275388/jim-jones"}, "edited": false, "score": 0, "creation_date": 1522063413, "post_id": 49489538, "comment_id": 85983419, "body": "Thanks @JimJones but the problem is to work with both mysql and postgresql in one query  as you may notice for the code up  that i have two different database server"}, {"owner": {"reputation": 59, "user_id": 9503747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/117e7dfc4c78542591bf46f210152b47?s=128&d=identicon&r=PG&f=1", "display_name": "Medone", "link": "https://stackoverflow.com/users/9503747/medone"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1522065788, "post_id": 49489538, "comment_id": 85985008, "body": "@Flimzy yes i tried you may check up i edited the post"}], "owner": {"reputation": 59, "user_id": 9503747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/117e7dfc4c78542591bf46f210152b47?s=128&d=identicon&r=PG&f=1", "display_name": "Medone", "link": "https://stackoverflow.com/users/9503747/medone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 415, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522065701, "creation_date": 1522060983, "last_edit_date": 1522065701, "question_id": 49489538, "link": "https://stackoverflow.com/questions/49489538/select-from-postgresql-and-insert-if-not-exist-in-mysql-golang", "title": "select from postgresql and insert if not exist in mysql golang", "body": "<p>I have two different database servers, one is a mysql database server and the other is postgresql database server , both have a table called users  so I have to insert from the users postgresql table to the users mysql table and check if there is already something inserted (if not exist), how can I do one Database query with postgresql and mysql in the same time </p>\n\n<p>//MYSQL CONNECTION</p>\n\n<pre><code>var err1 error\ndb, err1 = sql.Open(\"mysql\", \"root:root@tcp(127.0.0.1:3306)/dbusers?parseTime=true\")\nif err1 != nil {\n    log.Fatal(err1)\n}\n</code></pre>\n\n<p>//POSTGRESQL CONNECTION</p>\n\n<pre><code>psqlInfo := fmt.Sprintf(\"host=%s port=%d user=%s \"+\"password=%s dbname=%s sslmode=disable\", HOST, PORT, USER, PASSWORD, DBNAME)\n    db1, err2 = sql.Open(\"postgres\", psqlInfo)\n    if err2 != nil {\n        log.Fatal(err2)\n    }\n</code></pre>\n\n<p>//Here is what i have tried</p>\n\n<pre><code>func GetUsersApiPostgres(c *gin.Context) {\nvar p Users\nUsers, err := p.GetUsers() //GetUsers will return all fields in users table\nif err != nil {\n    log.Fatalln(err)\n}\n\nc.JSON(http.StatusOK, gin.H{\n    \"Users\": Users,\n})\n\n}\nfunc AddUsersApiMysql(c *gin.Context) {\nfirstName := c.Request.FormValue(\"firstname\")\nlastName := c.Request.FormValue(\"lastname\")\n\np := Users{FirstName: firstName, LastName: lastName}\n\nra, err := p.AddUsers()//AddUsers will insert fields  defined in users table\nif err != nil {\n    log.Fatalln(err)\n}\nmsg := fmt.Sprintf(\"insert successful %d\", ra)\nc.JSON(http.StatusOK, gin.H{\n    \"msg\": msg,\n})\n}\nfunc (u *Users) GetMysqlUsersFromPostgresql{\n\n}\n</code></pre>\n\n<p>I don't know how to use both function (Add &amp; Get) in the last function</p>\n"}, {"tags": ["unit-testing", "go"], "comments": [{"owner": {"reputation": 996, "user_id": 4909445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ded7e867ff7001048e511974d4c19137?s=128&d=identicon&r=PG&f=1", "display_name": "Shettyh", "link": "https://stackoverflow.com/users/4909445/shettyh"}, "edited": false, "score": 1, "creation_date": 1522068723, "post_id": 49489355, "comment_id": 85987124, "body": "Check <a href=\"https://stackoverflow.com/questions/34535704/how-to-detect-code-coverage-of-separated-folders-in-go\">this</a> might help. Basically in go it is not considered a good practice to have <code>tests</code> and <code>src</code> in separate packages"}, {"owner": {"reputation": 6335, "user_id": 816449, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1dad5941fe69ec5107e2a214316447a9?s=128&d=identicon&r=PG", "display_name": "Bunyk", "link": "https://stackoverflow.com/users/816449/bunyk"}, "reply_to_user": {"reputation": 996, "user_id": 4909445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ded7e867ff7001048e511974d4c19137?s=128&d=identicon&r=PG&f=1", "display_name": "Shettyh", "link": "https://stackoverflow.com/users/4909445/shettyh"}, "edited": false, "score": 0, "creation_date": 1522143953, "post_id": 49489355, "comment_id": 86023080, "body": "@Shettyh So, short answer is &quot;not yet possible for this project structure&quot;?"}, {"owner": {"reputation": 996, "user_id": 4909445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ded7e867ff7001048e511974d4c19137?s=128&d=identicon&r=PG&f=1", "display_name": "Shettyh", "link": "https://stackoverflow.com/users/4909445/shettyh"}, "edited": false, "score": 1, "creation_date": 1522144532, "post_id": 49489355, "comment_id": 86023549, "body": "AFAIK it is not possible as of now"}], "answers": [{"comments": [{"owner": {"reputation": 1723, "user_id": 9361998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4903f0d1b79d5499e942a376d853475?s=128&d=identicon&r=PG&f=1", "display_name": "alessiosavi", "link": "https://stackoverflow.com/users/9361998/alessiosavi"}, "edited": false, "score": 0, "creation_date": 1572211114, "post_id": 56026998, "comment_id": 103481229, "body": "It can be done, look at my reply <a href=\"https://stackoverflow.com/a/58508728/9361998\">stackoverflow.com/a/58508728/9361998</a>"}], "tags": [], "owner": {"reputation": 573, "user_id": 4069872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/89MvE.png?s=128&g=1", "display_name": "krain143", "link": "https://stackoverflow.com/users/4069872/krain143"}, "is_accepted": false, "score": 0, "last_activity_date": 1557246999, "creation_date": 1557246999, "answer_id": 56026998, "question_id": 49489355, "link": "https://stackoverflow.com/questions/49489355/how-to-generate-coverage-for-multiple-packages-using-go-test-in-custom-folders/56026998#56026998", "title": "How to generate coverage for multiple packages using go test in custom folders?", "body": "<p>You can't with the current state of <code>go test</code> but you can always use third party scripts.</p>\n\n<p><a href=\"https://github.com/grosser/go-testcov\" rel=\"nofollow noreferrer\">https://github.com/grosser/go-testcov</a></p>\n"}, {"tags": [], "owner": {"reputation": 1723, "user_id": 9361998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4903f0d1b79d5499e942a376d853475?s=128&d=identicon&r=PG&f=1", "display_name": "alessiosavi", "link": "https://stackoverflow.com/users/9361998/alessiosavi"}, "is_accepted": false, "score": 1, "last_activity_date": 1572210986, "last_edit_date": 1572210986, "creation_date": 1571762067, "answer_id": 58508728, "question_id": 49489355, "link": "https://stackoverflow.com/questions/49489355/how-to-generate-coverage-for-multiple-packages-using-go-test-in-custom-folders/58508728#58508728", "title": "How to generate coverage for multiple packages using go test in custom folders?", "body": "<p>Short answer:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>go test -race -coverprofile=coverage.txt -covermode=atomic ./...  # Run all the tests with the race detector enabled\ngo test -bench=. -benchmem ./... # Run all the benchmark for 3s and print memory information\n</code></pre>\n\n<p>In order to create a test for a Go code, you have to create a file (in the same folder of the root code) that have the same name of the code, and append \"_test\" to the name. The package have to be the same too.</p>\n\n<p>So, if I have a GO Code called <code>strings.go</code>, the relative test suite have to be named: <code>strings_test.go</code>.</p>\n\n<p>After that, you have to create a method that have in input the <code>t *testing.T</code> \nstruct, and the name of the method have to start with <code>Test</code> or <code>Benchmark</code> word.</p>\n\n<p>So, if the <code>strings.go</code> contains a method called \"IsUpper\", the related test-case is a method called <code>TestIsUpper(t *testing.T)</code>.<br>\nIf you need the Benchmark, than you need to substitute the <code>Test</code> word with <code>Benchmark</code>, so the name of the method will be <code>BenchmarkIsUpper</code>, and the struct that the method take in input is <code>b *testing.B</code>.</p>\n\n<p>You can have a look at the following link in order to see the tree-structure necessary for execute the test in GO: <a href=\"https://github.com/alessiosavi/GoGPUtils\" rel=\"nofollow noreferrer\">https://github.com/alessiosavi/GoGPUtils</a>.</p>\n\n<p>There you can find Benchmark and TestCase.</p>\n\n<p>Here an example of tree-struct</p>\n\n<pre><code>\u251c\u2500\u2500 string\n\u2502   \u251c\u2500\u2500 stringutils.go\n\u2502   \u2514\u2500\u2500 stringutils_test.go\n</code></pre>\n"}], "owner": {"reputation": 6335, "user_id": 816449, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1dad5941fe69ec5107e2a214316447a9?s=128&d=identicon&r=PG", "display_name": "Bunyk", "link": "https://stackoverflow.com/users/816449/bunyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1908, "favorite_count": 1, "answer_count": 2, "score": 6, "last_activity_date": 1572244694, "creation_date": 1522060393, "last_edit_date": 1572244694, "question_id": 49489355, "link": "https://stackoverflow.com/questions/49489355/how-to-generate-coverage-for-multiple-packages-using-go-test-in-custom-folders", "title": "How to generate coverage for multiple packages using go test in custom folders?", "body": "<p>We have following project structure:</p>\n\n<pre><code>\u251c\u2500\u2500 Makefile\n\u251c\u2500\u2500 ...\n\u251c\u2500\u2500 src\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 app\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 main.go\n\u2502   \u2502   \u251c\u2500\u2500 models\n\u2502   \u2502       \u251c\u2500\u2500 ...\n\u2502   \u2502       \u2514\u2500\u2500 dao.go\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 ...\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 controllers\n\u2502   \u2502       \u251c\u2500\u2500 ...\n\u2502   \u2502       \u2514\u2500\u2500 pingController.go\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 test\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 all_test.go\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 ...\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 controllers_test.go\n\u2514\u2500\u2500 vendor\n    \u2514\u2500\u2500 src\n        \u251c\u2500\u2500 github.com\n        \u251c\u2500\u2500 golang.org\n        \u2514\u2500\u2500 gopkg.in\n</code></pre>\n\n<p>I want to measure coverage of packages in src/app by tests in src/test. And currently generating coverage profile by running custom script that runs coverage for each package in app and then merges all coverage profiles into one file. Recently I heard that in go1.10 we are able to generate coverage for multiple packages.</p>\n\n<p>So I tried to replace that script with oneliner, and tried running</p>\n\n<pre><code>GOPATH=${PROJECT_DIR}:${PROJECT_DIR}/vendor go test -covermode count -coverprofile cover.out -coverpkg all ./src/test/...\n</code></pre>\n\n<p>It gives me \"ok     test    0.475s  coverage: 0.0% of statements in all\"</p>\n\n<p>When I do </p>\n\n<pre><code>cd src/test/\nGOPATH=${PROJECT_DIR}:${PROJECT_DIR}/vendor go test -covermode count -coverprofile cover.out -coverpkg all\n</code></pre>\n\n<p>Logs show that specs are runned and tests are successfull, but still I have \"coverage: 0.0% of statements in all\" and empty cover.out.</p>\n\n<p>What am I missing to properly compute coverage of packages in app by tests in test? </p>\n"}, {"tags": ["go", "concurrency"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1522056965, "post_id": 49487998, "comment_id": 85979136, "body": "Pure chance. It does <b>not</b> depend on odd/even."}, {"owner": {"reputation": 9874, "user_id": 1636314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/656293120862f84aa3319979ca1bdb8c?s=128&d=identicon&r=PG", "display_name": "publysher", "link": "https://stackoverflow.com/users/1636314/publysher"}, "edited": false, "score": 0, "creation_date": 1522057151, "post_id": 49487998, "comment_id": 85979247, "body": "Can you also add a playground link to <i>your</i> solution? That will help us tell you what went wrong."}, {"owner": {"reputation": 307, "user_id": 4193448, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/849871a025344d191ad9fa458380bf49?s=128&d=identicon&r=PG", "display_name": "mtricht", "link": "https://stackoverflow.com/users/4193448/mtricht"}, "edited": false, "score": 1, "creation_date": 1522062272, "post_id": 49487998, "comment_id": 85982590, "body": "The code you provided outputs 1 to 11, with no numbers missing. I&#39;m not sure what the problem is."}, {"owner": {"reputation": 4242, "user_id": 367180, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e356e3a921bedb73efd7594ff7f37b73?s=128&d=identicon&r=PG", "display_name": "matthias krull", "link": "https://stackoverflow.com/users/367180/matthias-krull"}, "edited": false, "score": 0, "creation_date": 1522155060, "post_id": 49487998, "comment_id": 86031282, "body": "It should output 12 as well. Read: <code>while i smaller or equal to 12</code>"}], "answers": [{"tags": [], "owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "is_accepted": false, "score": 0, "last_activity_date": 1522076780, "creation_date": 1522076780, "answer_id": 49494714, "question_id": 49487998, "link": "https://stackoverflow.com/questions/49487998/why-is-this-go-program-only-working-with-odd-number-of-ints-sent-to-channel/49494714#49494714", "title": "Why is this Go program only working with odd number of ints sent to channel?", "body": "<p>import \u201ctime\u201d and add a time.Sleep(50000) after the close.   You have an implicit race, where main is tearing down the program, and your goroutine hasn\u2019t finished.</p>\n"}, {"comments": [{"owner": {"reputation": 1445, "user_id": 5972487, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/024fcbdd0ee00e2dccefce0ef67bc434?s=128&d=identicon&r=PG", "display_name": "elmiomar", "link": "https://stackoverflow.com/users/5972487/elmiomar"}, "edited": false, "score": 0, "creation_date": 1522082762, "post_id": 49495362, "comment_id": 85997028, "body": "this will create a deadlock!"}, {"owner": {"reputation": 4242, "user_id": 367180, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e356e3a921bedb73efd7594ff7f37b73?s=128&d=identicon&r=PG", "display_name": "matthias krull", "link": "https://stackoverflow.com/users/367180/matthias-krull"}, "reply_to_user": {"reputation": 1445, "user_id": 5972487, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/024fcbdd0ee00e2dccefce0ef67bc434?s=128&d=identicon&r=PG", "display_name": "elmiomar", "link": "https://stackoverflow.com/users/5972487/elmiomar"}, "edited": false, "score": 0, "creation_date": 1522140818, "post_id": 49495362, "comment_id": 86020917, "body": "Indeed! Do you spot the mistake?"}, {"owner": {"reputation": 1445, "user_id": 5972487, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/024fcbdd0ee00e2dccefce0ef67bc434?s=128&d=identicon&r=PG", "display_name": "elmiomar", "link": "https://stackoverflow.com/users/5972487/elmiomar"}, "edited": false, "score": 0, "creation_date": 1522154390, "post_id": 49495362, "comment_id": 86030798, "body": "wrap <code>close(ch)</code> and <code>wg.Wait()</code> in a goroutine <code>go func() { \t\tclose(ch) \t\twg.Wait() \t}() </code>"}, {"owner": {"reputation": 4242, "user_id": 367180, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e356e3a921bedb73efd7594ff7f37b73?s=128&d=identicon&r=PG", "display_name": "matthias krull", "link": "https://stackoverflow.com/users/367180/matthias-krull"}, "reply_to_user": {"reputation": 1445, "user_id": 5972487, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/024fcbdd0ee00e2dccefce0ef67bc434?s=128&d=identicon&r=PG", "display_name": "elmiomar", "link": "https://stackoverflow.com/users/5972487/elmiomar"}, "edited": false, "score": 0, "creation_date": 1522154678, "post_id": 49495362, "comment_id": 86031022, "body": "This will fix the deadlock but only print until eleven. There is still a race condition between closing the channel and printing. Once the channel is closed, the <code>for</code> loop in <code>Print</code> will terminate."}, {"owner": {"reputation": 1445, "user_id": 5972487, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/024fcbdd0ee00e2dccefce0ef67bc434?s=128&d=identicon&r=PG", "display_name": "elmiomar", "link": "https://stackoverflow.com/users/5972487/elmiomar"}, "edited": false, "score": 0, "creation_date": 1522155104, "post_id": 49495362, "comment_id": 86031312, "body": "Oh that&#39;s because we&#39;re closing the channel first, we should call wg.Wait() first and then close the channel."}, {"owner": {"reputation": 4242, "user_id": 367180, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e356e3a921bedb73efd7594ff7f37b73?s=128&d=identicon&r=PG", "display_name": "matthias krull", "link": "https://stackoverflow.com/users/367180/matthias-krull"}, "reply_to_user": {"reputation": 1445, "user_id": 5972487, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/024fcbdd0ee00e2dccefce0ef67bc434?s=128&d=identicon&r=PG", "display_name": "elmiomar", "link": "https://stackoverflow.com/users/5972487/elmiomar"}, "edited": false, "score": 0, "creation_date": 1522155165, "post_id": 49495362, "comment_id": 86031371, "body": "But then the for loop in the Print function will never terminate ;)"}], "tags": [], "owner": {"reputation": 4242, "user_id": 367180, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e356e3a921bedb73efd7594ff7f37b73?s=128&d=identicon&r=PG", "display_name": "matthias krull", "link": "https://stackoverflow.com/users/367180/matthias-krull"}, "is_accepted": false, "score": 1, "last_activity_date": 1522154873, "last_edit_date": 1522154873, "creation_date": 1522078644, "answer_id": 49495362, "question_id": 49487998, "link": "https://stackoverflow.com/questions/49487998/why-is-this-go-program-only-working-with-odd-number-of-ints-sent-to-channel/49495362#49495362", "title": "Why is this Go program only working with odd number of ints sent to channel?", "body": "<p>You have to properly synchronize your program:</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n)\n\nfunc main() {\n        done := make(chan bool)\n        ch := make(chan int)\n\n        go Print(ch, done)\n        for i := 1; i &lt;= 12; i++ {\n                ch &lt;- i\n        }\n        done&lt;-true\n        &lt;-done\n}\n\nfunc Print(ch chan int, done chan bool) {\n        defer func(done chan bool){done&lt;-true}(done)\n        for{\n                select {\n                case &lt;-done:\n                        return\n                case n := &lt;-ch:\n                        fmt.Println(n)\n                }\n        }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/e_fr2UBeyKA\" rel=\"nofollow noreferrer\">https://play.golang.org/p/e_fr2UBeyKA</a></p>\n"}, {"tags": [], "owner": {"reputation": 1445, "user_id": 5972487, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/024fcbdd0ee00e2dccefce0ef67bc434?s=128&d=identicon&r=PG", "display_name": "elmiomar", "link": "https://stackoverflow.com/users/5972487/elmiomar"}, "is_accepted": false, "score": 1, "last_activity_date": 1522158323, "creation_date": 1522158323, "answer_id": 49514621, "question_id": 49487998, "link": "https://stackoverflow.com/questions/49487998/why-is-this-go-program-only-working-with-odd-number-of-ints-sent-to-channel/49514621#49514621", "title": "Why is this Go program only working with odd number of ints sent to channel?", "body": "<p>This is a consumer-producer concurrency pattern, and one way of implementing it in Go is as follows:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\n// function that produces i.e. sends to channel\nfunc generate(ch chan int, done chan bool) {\n    for i := 1; i &lt;= 12; i++ {\n        ch &lt;- i\n    }\n    done &lt;- true\n}\n\n// function that consumes i.e. receives from channel\nfunc print(ch chan int) {\n    for i:= range ch {\n        fmt.Println(i)\n    }\n}\n\nfunc main() {\n    done := make(chan bool)\n    // defer close(done)\n    ch := make(chan int)\n    // defer close(ch)\n    go generate(ch, done)\n    go print(ch)\n    &lt;-done\n}\n</code></pre>\n\n<p>I hope this helps!</p>\n"}], "owner": {"reputation": 59, "user_id": 2468350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c812cf61a76fd3feff3236500138d5bd?s=128&d=identicon&r=PG", "display_name": "user2468350", "link": "https://stackoverflow.com/users/2468350/user2468350"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 300, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1522158323, "creation_date": 1522056222, "last_edit_date": 1522056754, "question_id": 49487998, "link": "https://stackoverflow.com/questions/49487998/why-is-this-go-program-only-working-with-odd-number-of-ints-sent-to-channel", "title": "Why is this Go program only working with odd number of ints sent to channel?", "body": "<p>We had an assignment in school to fix a go program that had a bug that it didn't print all values sent to the channel. I'm not asking for the solution to that, but I found something weird that I can not explain with my knowledge of Go.</p>\n\n<p>This is the code:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    ch := make(chan int)\n\n    go Print(ch)\n    for i := 1; i &lt;= 12; i++ {\n        ch &lt;- i\n    }\n    close(ch)\n}\n\nfunc Print(ch &lt;-chan int) {\n    for n := range ch{ \n        fmt.Println(n)\n    }\n}\n</code></pre>\n\n<p>The problem is that the Print routine won't print all integers that are sent on the channel, which I have managed to fix in my solution using a waitgroup. But the weird thing is that the program will print all ints sent to the channel perfectly if the number of ints are even. So I tried to run this program in the Go Playground and it seemed like the program in Go Playground instead would print all ints if the number of ints were odd. Why is this? I am a bit confused about this. </p>\n\n<p>Link to go playground program: <a href=\"https://play.golang.org/p/-BLHvC8RomC\" rel=\"nofollow noreferrer\">https://play.golang.org/p/-BLHvC8RomC</a></p>\n"}, {"tags": ["http", "go", "gzip"], "comments": [{"owner": {"reputation": 911, "user_id": 3563197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/563e4185281840ef1792eda5d6391440?s=128&d=identicon&r=PG", "display_name": "vedhavyas", "link": "https://stackoverflow.com/users/3563197/vedhavyas"}, "edited": false, "score": 1, "creation_date": 1522053763, "post_id": 49487227, "comment_id": 85977074, "body": "Have you tried <code>http.Transport.DisableCompression</code> to <code>true</code> ?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1522054730, "post_id": 49487227, "comment_id": 85977692, "body": "You are sure the response isn&#39;t double compressed?"}, {"owner": {"reputation": 2776, "user_id": 1094529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/glcan.png?s=128&g=1", "display_name": "Milo Christiansen", "link": "https://stackoverflow.com/users/1094529/milo-christiansen"}, "reply_to_user": {"reputation": 911, "user_id": 3563197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/563e4185281840ef1792eda5d6391440?s=128&d=identicon&r=PG", "display_name": "vedhavyas", "link": "https://stackoverflow.com/users/3563197/vedhavyas"}, "edited": false, "score": 1, "creation_date": 1522054924, "post_id": 49487227, "comment_id": 85977822, "body": "@vedhavyas Somehow, despite digging around in the docs for far too long, I missed that field. I&#39;ll give it a shot."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1522055360, "post_id": 49487227, "comment_id": 85978125, "body": "Cannot reproduce, the reponse is not decompressed: <a href=\"https://play.golang.org/p/bxSQUlOMj5E\" rel=\"nofollow noreferrer\">play.golang.org/p/bxSQUlOMj5E</a>"}], "answers": [{"tags": [], "owner": {"reputation": 563, "user_id": 4539721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d6650d3a6a89e08bd747a07fd06989a?s=128&d=identicon&r=PG", "display_name": "Soham Kamani", "link": "https://stackoverflow.com/users/4539721/soham-kamani"}, "is_accepted": true, "score": 3, "last_activity_date": 1522054955, "creation_date": 1522054955, "answer_id": 49487632, "question_id": 49487227, "link": "https://stackoverflow.com/questions/49487227/disable-decompression-of-http-body-received-from-a-server-with-incorrect-headers/49487632#49487632", "title": "Disable decompression of HTTP body received from a server with incorrect headers", "body": "<p>Yes, you can do this with a custom HTTP transport:</p>\n\n<pre><code>tr := &amp;http.Transport{\n    DisableCompression: true,\n}\nclient := &amp;http.Client{Transport: tr}\n</code></pre>\n\n<p>This <code>client</code> will not decompress <em>any</em> of the responses, so you're free to handle that yourself</p>\n"}], "owner": {"reputation": 2776, "user_id": 1094529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/glcan.png?s=128&g=1", "display_name": "Milo Christiansen", "link": "https://stackoverflow.com/users/1094529/milo-christiansen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 558, "favorite_count": 0, "accepted_answer_id": 49487632, "answer_count": 1, "score": 1, "last_activity_date": 1522054955, "creation_date": 1522053543, "question_id": 49487227, "link": "https://stackoverflow.com/questions/49487227/disable-decompression-of-http-body-received-from-a-server-with-incorrect-headers", "title": "Disable decompression of HTTP body received from a server with incorrect headers", "body": "<p>I have a simple, but infuriating issue: I'm trying to automatically download <code>.tar.gz</code> files from a web server, perform an MD5 checksum on them, and decompress them into a directory.</p>\n\n<p>This is fairly easy to do, except for one problem: Some of the files have a <code>Content-Encoding: x-gzip</code> header set. This causes the <code>\"net/http\"</code> client to automatically decompress these files, making it impossible to verify their contents, and worse, making it difficult to unpack them (since you never quite know if you need to decompress them or not).</p>\n\n<p>The server isn't mine, so I can't just fix the headers.</p>\n\n<p>Is there any way to <em>completely disable</em> automatic decompression of response bodies with <code>\"net/http\"</code>? Failing that, is there anything else I can do to work around this issue?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1522051529, "post_id": 49486607, "comment_id": 85975859, "body": "To be clear, <code>[]MethodCall</code> is fine, the slices I&#39;m referring to are those within methodCalls, e.g. <code>[&quot;method2&quot;, {&quot;arg1&quot;: &quot;arg1data&quot;}, &quot;#2&quot;]</code>. Define an UnmarshalJSON method on MethodCall as explained in the duplicate."}], "answers": [{"tags": [], "owner": {"reputation": 98, "user_id": 8862808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41b7e30f64c8992897bd2668a35ede46?s=128&d=identicon&r=PG&f=1", "display_name": "lucas alcantara", "link": "https://stackoverflow.com/users/8862808/lucas-alcantara"}, "is_accepted": false, "score": 0, "last_activity_date": 1522055702, "last_edit_date": 1522055702, "creation_date": 1522055206, "answer_id": 49487695, "question_id": 49486607, "link": "https://stackoverflow.com/questions/49486607/how-to-deserialize-list-with-mixed-types/49487695#49487695", "title": "How to deserialize list with mixed types?", "body": "<p>It looks like the methodCalls that you are trying to deserialize it is an array of strings instead of a struct for MethodCall.\nSo, Take a look at this <a href=\"https://play.golang.org/p/KykYEUau4Uo\" rel=\"nofollow noreferrer\">link</a> that I am deserializing as an array.</p>\n\n<p>If you want to use the MethodCall struct you have to change the json a little bit. Take a look at this <a href=\"https://play.golang.org/p/jzbWUJu6j9C\" rel=\"nofollow noreferrer\">link</a></p>\n"}], "owner": {"reputation": 9, "user_id": 9551291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/def38b36213730d97d2c9b4b778b0926?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Meyer", "link": "https://stackoverflow.com/users/9551291/peter-meyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "closed_date": 1522055797, "answer_count": 1, "score": 0, "last_activity_date": 1522055702, "creation_date": 1522051238, "question_id": 49486607, "link": "https://stackoverflow.com/questions/49486607/how-to-deserialize-list-with-mixed-types", "closed_reason": "Duplicate", "title": "How to deserialize list with mixed types?", "body": "<p>How would I deserialize this JSON in Go?</p>\n\n<pre><code>{\n  \"using\": [ \"jmap-core\", \"jmap-mail\" ],\n  \"methodCalls\": [\n    [\"method1\", {\"arg1\": \"arg1data\", \"arg2\": \"arg2data\"}, \"#1\"],\n    [\"method2\", {\"arg1\": \"arg1data\"}, \"#2\"],\n    [\"method3\", {}, \"#3\"]\n  ]\n}\n</code></pre>\n\n<p>I haven't figured out how to properly get the json module to parse the methodCalls into a type. My first idea was</p>\n\n<pre><code>type MethodCall struct {\n    Name string\n    Params map[string]string\n    ClientId string\n}\n</code></pre>\n\n<p>and then to use it as a list type:</p>\n\n<pre><code>type Request struct {\n    Using []string\n    MethodCalls []MethodCall\n}\n</code></pre>\n\n<p>But this does not work. :using\" is correctly parsed, but the \"methocCalls\" are not. Is there a way to get Go to parse this JSON into my types?</p>\n"}, {"tags": ["go", "file-watcher", "goland"], "comments": [{"owner": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1522049823, "post_id": 49485807, "comment_id": 85974928, "body": "the default shorcut for formatting is ctrl+alt+l in all jetbrains idea&#39;s"}, {"owner": {"reputation": 58775, "user_id": 474189, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/jzXIJ.jpg?s=128&g=1", "display_name": "Duncan Jones", "link": "https://stackoverflow.com/users/474189/duncan-jones"}, "reply_to_user": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 0, "creation_date": 1522050327, "post_id": 49485807, "comment_id": 85975192, "body": "@Pizzalord Thanks for the comment; I think my original question was too formatting focused. I&#39;ve clarified that now."}], "answers": [{"tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": false, "score": 2, "last_activity_date": 1522051226, "creation_date": 1522051226, "answer_id": 49486602, "question_id": 49485807, "link": "https://stackoverflow.com/questions/49485807/default-file-watchers-in-goland/49486602#49486602", "title": "Default file watchers in Goland", "body": "<p>At the moment this is not possible. Follow <a href=\"https://youtrack.jetbrains.com/issue/WEB-12478\" rel=\"nofollow noreferrer\">https://youtrack.jetbrains.com/issue/WEB-12478</a> for updates.</p>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 9392066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gPnVM.jpg?s=128&g=1", "display_name": "Linesmerrill", "link": "https://stackoverflow.com/users/9392066/linesmerrill"}, "is_accepted": true, "score": 2, "last_activity_date": 1542400384, "creation_date": 1542400384, "answer_id": 53344998, "question_id": 49485807, "link": "https://stackoverflow.com/questions/49485807/default-file-watchers-in-goland/53344998#53344998", "title": "Default file watchers in Goland", "body": "<p>Yes there is now! They allow you to change the level of the file watcher. Simply  navigate to Preferences -> Tools -> File Watchers and on \"level\" select \"Global\".</p>\n\n<p>This will, by default, add these File Watchers for other projects but it will not be enabled. To enable, simply check the \"Enabled\" box and you are good to go!</p>\n\n<p><a href=\"https://i.stack.imgur.com/b0reL.png\" rel=\"nofollow noreferrer\">File Watchers Global Setting</a></p>\n"}], "owner": {"reputation": 58775, "user_id": 474189, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/jzXIJ.jpg?s=128&g=1", "display_name": "Duncan Jones", "link": "https://stackoverflow.com/users/474189/duncan-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1039, "favorite_count": 0, "accepted_answer_id": 53344998, "answer_count": 2, "score": 3, "last_activity_date": 1542400384, "creation_date": 1522048347, "last_edit_date": 1522050264, "question_id": 49485807, "link": "https://stackoverflow.com/questions/49485807/default-file-watchers-in-goland", "title": "Default file watchers in Goland", "body": "<p>Is there a way to enable certain file watchers by default in all projects? It bugs me that I have to do this manually, but I've not found an option.</p>\n\n<p>For example, I like to enable the <code>goimports</code> file watcher for every project in Goland.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1522045300, "post_id": 49485046, "comment_id": 85972881, "body": "Find the concurrent write and get rid of the data race."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1522050054, "post_id": 49485046, "comment_id": 85975050, "body": "The error message is incomplete. It also contains a trace to the map write. You need to synchronize both functions."}], "answers": [{"tags": [], "owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "is_accepted": false, "score": 0, "last_activity_date": 1522045677, "creation_date": 1522045677, "answer_id": 49485214, "question_id": 49485046, "link": "https://stackoverflow.com/questions/49485046/fatal-error-concurrent-map-read-and-map-write/49485214#49485214", "title": "fatal error: concurrent map read and map write", "body": "<p>You are probably using a global variable for the map. Global variables are accessible by every request. With bad luck two requests try to access the same map at the same time, hence your error.</p>\n\n<p>The easiest fix would be to use a <code>Map</code> from the package <code>sync</code>. But this could be more of a workaround according to your use case. But this slows down your program. </p>\n\n<p>An alternative would be to define the map inside the handler if you only need it there.</p>\n\n<p>If you could post more of your file, it would be easier to give a better answer.</p>\n"}], "owner": {"reputation": 229, "user_id": 2647838, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/1bff2683efbdb7025ebfe75cfb15b32a?s=128&d=identicon&r=PG", "display_name": "ter", "link": "https://stackoverflow.com/users/2647838/ter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1627, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1522049957, "creation_date": 1522044822, "last_edit_date": 1522049957, "question_id": 49485046, "link": "https://stackoverflow.com/questions/49485046/fatal-error-concurrent-map-read-and-map-write", "title": "fatal error: concurrent map read and map write", "body": "<pre><code>fatal error: concurrent map read and map write\n\ngoroutine 5065809 [running]:\nruntime.throw(0x6b4281, 0x21)\n        /usr/local/go/src/runtime/panic.go:566 +0x95 fp=0xc420c05670 \nsp=0xc420c05650\nruntime.mapaccess1_faststr(0x65ea20, 0xc420015020, 0xc42178ea8e, 0x16, \n0x0)\n        /usr/local/go/src/runtime/hashmap_fast.go:201 +0x4f3 \nfp=0xc420c056d0 sp=0xc420c05670\ncollider.(*Collider).httpHandler(0xc420013120, 0x7c4dc0, 0xc4209dcdd0, \n0xc420a954a0)\n        /home/ec2-user/goWorkspace/src/collider/collider.go:176 +0x7dd \nfp=0xc420c05c48 sp=0xc420c056d0\n</code></pre>\n\n<p>and the code is</p>\n\n<pre><code>    query := r.URL.Query()\n    if(query[\"q\"] == nil){\n        c.httpError(\"must have a question\",w)\n        return\n    }\n    m := query[\"q\"][0]       //this is line 176\n</code></pre>\n\n<p>It happens about once per day and after it happens the whole http server is down. I don't know if the http get do some concurrent writes in map.\nHow to solve this?</p>\n"}, {"tags": ["go", "go-interface"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1522033805, "post_id": 49483263, "comment_id": 85969697, "body": "&quot;a smooth solution&quot;: Remodel. You cannot have smooth traditional OOP in Go. Try modeling it as interface types and compose them."}, {"owner": {"reputation": 1043, "user_id": 1847559, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/19IAr.png?s=128&g=1", "display_name": "tworabbits", "link": "https://stackoverflow.com/users/1847559/tworabbits"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1522033992, "post_id": 49483263, "comment_id": 85969745, "body": "Ok, don&#39;t really get the down vote but hey. Would you have any examples or resources that might point me in the right direction?"}, {"owner": {"reputation": 1043, "user_id": 1847559, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/19IAr.png?s=128&g=1", "display_name": "tworabbits", "link": "https://stackoverflow.com/users/1847559/tworabbits"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1522034228, "post_id": 49483263, "comment_id": 85969784, "body": "I probably have to rephrase this: I am not looking for a solution to make the code above work. I am actually trying to understand how to address this general problem in a &quot;go way&quot;"}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1522036629, "post_id": 49483263, "comment_id": 85970276, "body": "Go doesn&#39;t have generics. <a href=\"https://appliedgo.net/generics/\" rel=\"nofollow noreferrer\">Do this instead.</a>"}, {"owner": {"reputation": 1043, "user_id": 1847559, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/19IAr.png?s=128&g=1", "display_name": "tworabbits", "link": "https://stackoverflow.com/users/1847559/tworabbits"}, "reply_to_user": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1522039971, "post_id": 49483263, "comment_id": 85971092, "body": "@MichaelHampton Thanks for your comment, very interesting article. I found a solution using interfaces and interface composition."}], "answers": [{"tags": [], "owner": {"reputation": 1043, "user_id": 1847559, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/19IAr.png?s=128&g=1", "display_name": "tworabbits", "link": "https://stackoverflow.com/users/1847559/tworabbits"}, "is_accepted": false, "score": 0, "last_activity_date": 1522044246, "creation_date": 1522044246, "answer_id": 49484906, "question_id": 49483263, "link": "https://stackoverflow.com/questions/49483263/golang-type-assertion-cast-to-intermediate-struct/49484906#49484906", "title": "Golang type assertion / cast to intermediate struct", "body": "<p>Although I got down votes here, I believe this could be of interest to others. So I decided to post the solution to what I have figured out to work: See the <a href=\"https://play.golang.org/p/EbSRPX41c2p\" rel=\"nofollow noreferrer\">playground</a></p>\n\n<p>If this is bad practice or not \"the go way\" of doing things I would be really happy to get some feedback. Thanks!</p>\n"}], "owner": {"reputation": 1043, "user_id": 1847559, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/19IAr.png?s=128&g=1", "display_name": "tworabbits", "link": "https://stackoverflow.com/users/1847559/tworabbits"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 648, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1522044246, "creation_date": 1522032649, "question_id": 49483263, "link": "https://stackoverflow.com/questions/49483263/golang-type-assertion-cast-to-intermediate-struct", "title": "Golang type assertion / cast to intermediate struct", "body": "<p>Given the following types:</p>\n\n<pre><code>type Event interface{}\n\ntype ActionResultEvent struct {\n    Result string\n}\n\ntype ActionSuccessEvent ActionResultEvent\ntype ActionFailureEvent ActionResultEvent\n\ntype eventHandleFunc func(e Event)\n</code></pre>\n\n<p>My goal is to have event handlers (of type <code>eventHandleFunc</code>) for the concrete types <code>ActionSuccessEvent</code>, <code>ActionFailureEvent</code>, as well as for the more abstract <code>ActionResultEvent</code>. The latter I would like to use for both <code>ActionSuccessEvent</code>s and <code>ActionFailureEvent</code>s.</p>\n\n<p>Now my idea was to just type cast the <code>Event</code> interface to the structure I would like to work on and that works nicely for the concrete types.</p>\n\n<pre><code>// Working perfectly fine\nfunc(e Event) {\n  event := e.(ActionFailureEvent)\n  fmt.Println(event.Result)\n} (ActionFailureEvent{ Result: \"failure\" })\n\nfunc(e Event) {\n  event := e.(ActionSuccessEvent)\n  fmt.Println(event.Result)\n} (ActionSuccessEvent{ Result: \"success\" }) \n</code></pre>\n\n<p>Now what about handlers accepting <code>ActionResultEvent</code>s? My absolute favourite would look like this one:</p>\n\n<pre><code>func(e Event) {\n  event := e.(ActionResultEvent)\n  fmt.Println(event.Result)\n} (ActionSuccessEvent{ Result: \"success\" })    \n</code></pre>\n\n<p>This obviously panics as <code>e</code> was of type <code>ActionSuccessEvent</code>. </p>\n\n<p>Then we can of course cast to the initial type and back to intermediate:</p>\n\n<pre><code>// Works but would that would need to change whenever new types \"extending\" \n// ActionResultEvent are added\nfunc(e Event) {\n  var resultEvent ActionResultEvent\n\n  switch e.(type) {\n  case ActionSuccessEvent:\n    resultEvent = ActionResultEvent(e.(ActionSuccessEvent))\n\n  case ActionFailureEvent:\n    resultEvent = ActionResultEvent(e.(ActionFailureEvent))\n  }\n  fmt.Println(resultEvent.Result)\n} (ActionSuccessEvent{ Result: \"success\" })\n</code></pre>\n\n<p>Another really nice approach from my point would be:</p>\n\n<pre><code>// Error: use of e.(type) outside type switch\nfunc(e Event) {\n  resultEvent := ActionResultEvent(e.(type))\n} (ActionSuccessEvent{ Result: \"success\" })\n</code></pre>\n\n<p>Can anybody think of a smooth solution? One side note: I am happy if the handler panics during runtime whenever a typecast fails, as the wrapper will recover from that.</p>\n\n<p>This is the example code above on the <a href=\"https://play.golang.org/p/yfXyYQWBCGU\" rel=\"nofollow noreferrer\">playground</a>. Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 10667, "user_id": 4259761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDRx2.png?s=128&g=1", "display_name": "openwonk", "link": "https://stackoverflow.com/users/4259761/openwonk"}, "edited": false, "score": 0, "creation_date": 1522033870, "post_id": 49483184, "comment_id": 85969714, "body": "<a href=\"http://go-database-sql.org/prepared.html\" rel=\"nofollow noreferrer\">go-database-sql.org/prepared.html</a>"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1522048780, "post_id": 49483184, "comment_id": 85974395, "body": "This <i>is</i> what the Prepare method does (except you don&#39;t get to specify the name)."}, {"owner": {"reputation": 1445, "user_id": 5972487, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/024fcbdd0ee00e2dccefce0ef67bc434?s=128&d=identicon&r=PG", "display_name": "elmiomar", "link": "https://stackoverflow.com/users/5972487/elmiomar"}, "edited": false, "score": 1, "creation_date": 1522081488, "post_id": 49483184, "comment_id": 85996237, "body": "Your problem is not clear. The <code>Prepare</code> method from the <code>&quot;database&#47;sql&quot;</code> package does exactly that."}, {"owner": {"reputation": 45, "user_id": 4819795, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9bdba0937fbc0c96d0ff0741921aa78b?s=128&d=identicon&r=PG&f=1", "display_name": "Kai", "link": "https://stackoverflow.com/users/4819795/kai"}, "reply_to_user": {"reputation": 1445, "user_id": 5972487, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/024fcbdd0ee00e2dccefce0ef67bc434?s=128&d=identicon&r=PG", "display_name": "elmiomar", "link": "https://stackoverflow.com/users/5972487/elmiomar"}, "edited": false, "score": 0, "creation_date": 1522139007, "post_id": 49483184, "comment_id": 86019700, "body": "@elmiomar I am trying to call a prepared method that already exists in the sql. I would prefer to not duplicate sql code."}], "owner": {"reputation": 45, "user_id": 4819795, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9bdba0937fbc0c96d0ff0741921aa78b?s=128&d=identicon&r=PG&f=1", "display_name": "Kai", "link": "https://stackoverflow.com/users/4819795/kai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522138953, "creation_date": 1522032000, "last_edit_date": 1522138953, "question_id": 49483184, "link": "https://stackoverflow.com/questions/49483184/golang-execute-sql-prepare-statement", "title": "Golang execute sql prepare statement", "body": "<p>Go's sql package already includes the <code>Prepare</code> method but what if the SQL schema I have already includes prepared statements?</p>\n\n<p>How would I call the following in go without using the <code>Prepare</code> method?</p>\n\n<pre><code>PREPARE select_user (TEXT, VARCHAR) AS\n    SELECT id, email, is_admin FROM users\n    WHERE email = $1\n    AND password = crypt($2, password);\n</code></pre>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"comments": [{"owner": {"reputation": 987, "user_id": 4107796, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/04f749980bc28bc2f23547d739b38d85?s=128&d=identicon&r=PG&f=1", "display_name": "jack sexton", "link": "https://stackoverflow.com/users/4107796/jack-sexton"}, "edited": false, "score": 0, "creation_date": 1522100816, "post_id": 49489386, "comment_id": 86006350, "body": "sorry, I forgot to include that when I wrote this question but I do have it included in my code."}], "tags": [], "owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "is_accepted": false, "score": 0, "last_activity_date": 1522135650, "last_edit_date": 1522135650, "creation_date": 1522060495, "answer_id": 49489386, "question_id": 49483172, "link": "https://stackoverflow.com/questions/49483172/golangs-gorm-not-adding-associations-to-has-many-relationship/49489386#49489386", "title": "Golang&#39;s GORM not adding associations to &quot;has many&quot; relationship", "body": "<p>First of all you should create your <code>previous</code> table. You can make that by making migrations. You probably should make that migrations after db connection initialization. e.g.</p>\n\n<pre><code>db.AutoMigrate(&amp;Previous{})\n</code></pre>\n\n<hr>\n\n<p>So when u using <code>db.Model(&amp;Previous{})</code> you not saving any entity and if u wanna make asscociation with <code>Holdings</code> entity you need as first step to <code>Save</code> or <code>Find</code> existing <code>Previous</code> record by doing e.g.</p>\n\n<pre><code>previous := &amp;Previous{}\ndb.Save(previous)\n</code></pre>\n\n<p>After that you can append your holding record to <code>Model</code> like you do in your code but changing referenced <code>Previous</code>. So it will look like this</p>\n\n<pre><code>h := Holding{\n    Symbol:       \"abc\",\n    PurchaseDate: t1,\n}\ndb.Model(previous).Association(\"Holdings\").Append(h)\n</code></pre>\n\n<hr>\n\n<p>I don't know if its for testing but when you modeling entities you can make referenced id whithout specifing foreign key also you are using your <code>Holding</code> ID as ForeignKey so ID of <code>Previous</code> will be your ID of <code>Holding</code>.</p>\n\n<p>For me your model declaration should look like this (<code>PreviousID</code> will be automaticaly signed as foreign key for Previous)</p>\n\n<pre><code>type Previous struct {\n    orm.Model\n\n    Holdings []Holding\n}\n\ntype Holding struct {\n    ID           uint `gorm:\"primary_key\"`\n    PreviousID   uint\n    Symbol       string\n    PurchaseDate time.Time\n    SellDate     time.Time\n}\n</code></pre>\n"}], "owner": {"reputation": 987, "user_id": 4107796, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/04f749980bc28bc2f23547d739b38d85?s=128&d=identicon&r=PG&f=1", "display_name": "jack sexton", "link": "https://stackoverflow.com/users/4107796/jack-sexton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4438, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1527756571, "creation_date": 1522031880, "last_edit_date": 1527756571, "question_id": 49483172, "link": "https://stackoverflow.com/questions/49483172/golangs-gorm-not-adding-associations-to-has-many-relationship", "title": "Golang&#39;s GORM not adding associations to &quot;has many&quot; relationship", "body": "<p>I just started using <a href=\"http://gorm.io\" rel=\"nofollow noreferrer\">GORM</a> and tried to build a \"has many relationship\". I'm trying to add an association to Previous.Holdings (I think I followed the <a href=\"http://gorm.io/docs/associations.html\" rel=\"nofollow noreferrer\">docs</a> correctly) but when I try to do a <code>select * from previous</code> I don't see anything showing up in the database. Any idea on what I'm missing.</p>\n\n<pre><code>import (\n    orm \"github.com/jinzhu/gorm\"\n    _ \"github.com/jinzhu/gorm/dialects/sqlite\"\n)    \n\ntype Previous struct {\n    orm.Model\n\n    Holdings []Holding `gorm:\"foreignkey:ID\"`\n}\n\ntype Holding struct {\n    ID uint `gorm:\"primary_key\"`\n\n    Symbol string\n    PurchaseDate time.Time\n    SellDate time.Time\n}\n\nfunc main() {\n    t1, _ := time.Parse(\"2006-01-02\", \"2017-06-16\")\n    h := Holding{\n        Symbol: \"abc\",\n        PurchaseDate: t1,\n    }\n    db.Model(&amp;Previous{}).Association(\"Holdings\").Append(h)\n}\n</code></pre>\n"}, {"tags": ["http", "go", "error-handling", "net-http"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1522033909, "post_id": 49483111, "comment_id": 85969727, "body": "You <b>must</b> <b>not</b> call WriteHeader until you know what status code to return. There is <i>absolutely</i> <i>no</i> <i>way</i> to change that status after a call to WriteHeader."}, {"owner": {"reputation": 307, "user_id": 1410890, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6f4482b869f9b543ca44e1e637a4ea78?s=128&d=identicon&r=PG", "display_name": "Jagadeesh Venkata", "link": "https://stackoverflow.com/users/1410890/jagadeesh-venkata"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1522034204, "post_id": 49483111, "comment_id": 85969779, "body": "but the <code>json.NewEncoder(w).Encode(e)</code> which does a Write internally sets the status to StatusOK if WriteHeader is not called explicitly, which is not what I needed, I wanted to set it to StatusCreated"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1522042234, "post_id": 49483111, "comment_id": 85971732, "body": "Read the documentation. The internaly Write will sett 200 only if you did not WriteHeader yourself which you should do once you <i>know</i> which status code you want to send. It really is simple."}, {"owner": {"reputation": 307, "user_id": 1410890, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6f4482b869f9b543ca44e1e637a4ea78?s=128&d=identicon&r=PG", "display_name": "Jagadeesh Venkata", "link": "https://stackoverflow.com/users/1410890/jagadeesh-venkata"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1522073978, "post_id": 49483111, "comment_id": 85990931, "body": "Read the comment, what you described is exactly what I wrote in my previous comment, <code>json.NewEncoder(w).Encode(e) which does a Write internally sets the status to StatusOK if WriteHeader is not called explicitly</code>, lets say there is a failure in <code>json.NewEncoder(w).Encode(e)</code> and I want to set status code 201 for success and 5xx for encode failure, how would you do that?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1522081423, "post_id": 49483111, "comment_id": 85996196, "body": "Don&#39;t use json.Encoder. Use json.Marshal. It really is simple. Or write to an intermediate buffer."}], "answers": [{"comments": [{"owner": {"reputation": 307, "user_id": 1410890, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6f4482b869f9b543ca44e1e637a4ea78?s=128&d=identicon&r=PG", "display_name": "Jagadeesh Venkata", "link": "https://stackoverflow.com/users/1410890/jagadeesh-venkata"}, "edited": false, "score": 1, "creation_date": 1522034632, "post_id": 49483331, "comment_id": 85969869, "body": "thanks for the answer, this is the option I am following currently, the interesting question is <code>w.Write(Write([]byte) (int, error))</code> returns an error, how to handle that?"}, {"owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "reply_to_user": {"reputation": 307, "user_id": 1410890, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6f4482b869f9b543ca44e1e637a4ea78?s=128&d=identicon&r=PG", "display_name": "Jagadeesh Venkata", "link": "https://stackoverflow.com/users/1410890/jagadeesh-venkata"}, "edited": false, "score": 2, "creation_date": 1522035495, "post_id": 49483331, "comment_id": 85970011, "body": "@JagadeeshVenkata: right, well, if you receive an error there I don&#39;t think you can notify the user using the http response (since writing your custom error response would also likely fail). You&#39;d need to resort to server side logging and monitor those logs.. updated my answer to add that last part."}], "tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": false, "score": 4, "last_activity_date": 1522035425, "last_edit_date": 1522035425, "creation_date": 1522033310, "answer_id": 49483331, "question_id": 49483111, "link": "https://stackoverflow.com/questions/49483111/http-override-http-header-code-in-golang-while-there-is-an-error-in-json-encodin/49483331#49483331", "title": "http override http header code in golang while there is an error in json encoding", "body": "<p>First of all, it does not seem very likely that you get an error when encoding.</p>\n\n<p>See this question for reasons for <code>Marshal</code> to fail:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/33903552/what-input-will-cause-golangs-json-marshal-to-return-an-error\">What input will cause golang&#39;s json.Marshal to return an error?</a></p>\n\n<p>The other potential cause of error would be some problem with actually writing the data to the response stream, but in that case you'd not be able to write your custom error either.</p>\n\n<p>Going back to your question, if you are concerned that encoding your object might fail, you can first Marshal your data (checking for error), then only write the 201 status code (and the encoded data) if marshalling succeeded.</p>\n\n<p>Modifying your example a bit:</p>\n\n<pre><code>s := success{Data: data}\njsonData, err := json.Marshal(s)\nif err != nil {\n    // write your error to w, then return\n}\nw.WriteHeader(code)\nw.Header().Set(\"Content-Type\", \"application/json\")\nw.Write(jsonData)\n</code></pre>\n\n<p>Now, that last <code>write</code> can also throw an error.</p>\n\n<p>But if that happens, it will also fail when writing your custom error, so in that case you'd better log that in the server side (or send that error to a tracker such as New Relic, etc).</p>\n"}], "owner": {"reputation": 307, "user_id": 1410890, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6f4482b869f9b543ca44e1e637a4ea78?s=128&d=identicon&r=PG", "display_name": "Jagadeesh Venkata", "link": "https://stackoverflow.com/users/1410890/jagadeesh-venkata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1629, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1522035425, "creation_date": 1522031297, "question_id": 49483111, "link": "https://stackoverflow.com/questions/49483111/http-override-http-header-code-in-golang-while-there-is-an-error-in-json-encodin", "title": "http override http header code in golang while there is an error in json encoding", "body": "<p>consider this scenario!</p>\n\n<p>after successful execution of a http request, what if there is an error while performing json encoding, how to override the header code</p>\n\n<pre><code>func writeResp(w http.ResponseWriter, code int, data interface{}) {\n    w.Header().Set(\"Content-Type\", \"application/json\")\n\n    //Here I set the status to 201 StatusCreated\n    w.WriteHeader(code) \n    s := success{Data: data}\n\n    //what if there is an error here and want to override the status to 5xx error\n    //how to handle error here, panic?, http.Error() is not an option because as we already wrote header to 201, it just prints `http: multiple response.WriteHeader calls`\n    if err := json.NewEncoder(w).Encode(s); err != nil {\n        w.Header().Set(\"Content-Type\", \"application/json\")\n\n        //it throws http: multiple response.WriteHeader calls here as we already wrote header above to 201\n        w.WriteHeader(code)\n        e := errorResponse{\n            Code:        code,\n            Error:       error,\n            Description: msg,\n        }\n        if err := json.NewEncoder(w).Encode(e); err != nil {\n         //same how to handle here\n        }\n    }\n}\n</code></pre>\n\n<p>I have multiple options here, if we do just fatal logging the user won't know exactly what happened, even if I write string using <code>w.Write([]byte(msg))</code> still the status says <code>201</code> created, how to respond with error code 5xx</p>\n\n<p>any help is greatly appreciated</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-platform"], "answers": [{"tags": [], "owner": {"reputation": 7659, "user_id": 4926605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ed159f0e91d9ee0484cc64771993cb1?s=128&d=identicon&r=PG&f=1", "display_name": "LundinCast", "link": "https://stackoverflow.com/users/4926605/lundincast"}, "is_accepted": false, "score": 1, "last_activity_date": 1522055520, "creation_date": 1522055520, "answer_id": 49487794, "question_id": 49482314, "link": "https://stackoverflow.com/questions/49482314/finding-logs-on-gcp-app-engine-using-go/49487794#49487794", "title": "Finding Logs on GCP App Engine using Go", "body": "<p>As long as you use the App Engine Go SDK on <a href=\"https://cloud.google.com/appengine/docs/standard/go/logs/\" rel=\"nofollow noreferrer\">App Engine Standard</a> or write to the stdout or stderr on <a href=\"https://cloud.google.com/appengine/docs/flexible/go/writing-application-logs#writing_application_logs_1\" rel=\"nofollow noreferrer\">Flexible</a>, you should be able to see the logs for your application in your Developer Console > Logging <a href=\"https://cloud.google.com/logging/docs/view/overview\" rel=\"nofollow noreferrer\">section</a>. </p>\n"}, {"tags": [], "owner": {"reputation": 2430, "user_id": 4092401, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/L2gLB.jpg?s=128&g=1", "display_name": "Ying Li", "link": "https://stackoverflow.com/users/4092401/ying-li"}, "is_accepted": false, "score": 0, "last_activity_date": 1522108628, "creation_date": 1522108628, "answer_id": 49502400, "question_id": 49482314, "link": "https://stackoverflow.com/questions/49482314/finding-logs-on-gcp-app-engine-using-go/49502400#49502400", "title": "Finding Logs on GCP App Engine using Go", "body": "<p>We have various ways of obtain logs either with default logs that automatically show up in your Google Cloud Console, or via the Google Cloud Client Library to write additional logs. You can see the <a href=\"https://cloud.google.com/appengine/articles/logging\" rel=\"nofollow noreferrer\">details here</a>.</p>\n\n<p>If you think the information you need is already logged, then simply make sure you are using the log viewer properly. You can see instructions for GO <a href=\"https://cloud.google.com/appengine/docs/standard/go/logs/#request_logs_vs_application_logs\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 1221, "user_id": 293895, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/5a1a8df9589642533346195587da52c3?s=128&d=identicon&r=PG", "display_name": "user293895", "link": "https://stackoverflow.com/users/293895/user293895"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1522108628, "creation_date": 1522023157, "question_id": 49482314, "link": "https://stackoverflow.com/questions/49482314/finding-logs-on-gcp-app-engine-using-go", "title": "Finding Logs on GCP App Engine using Go", "body": "<p>I have a very basic go application on GCP that I am attempted to get connected to a CloudSQL Postgres. I have the following code that is failing:</p>\n\n<pre><code>db, err := sql.Open(\"postgres\",CONNECTION_STRING)\nif err != nil {\n    log.Fatal(\"Error: The data source arguments are not valid: \" + err.Error())\n    return\n}\nlog.Print(\"Attempting to connect to database\")\nerr = db.Ping()\nif err != nil {\n    log.Fatal(\"Error: Could not establish a connection with the database: \" + err.Error())\n    return\n}\n</code></pre>\n\n<p>The code is failing at the second log.Fatal call, however I cannot find how to read the entire log in GCP so I can see what the error was. Does anyone know where to find the full log?</p>\n"}, {"tags": ["go", "websocket", "http2", "gorilla", "app-engine-flexible"], "comments": [{"owner": {"reputation": 1655, "user_id": 8682074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1739167192766622/picture?type=large", "display_name": "John Balvin Arias", "link": "https://stackoverflow.com/users/8682074/john-balvin-arias"}, "reply_to_user": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "edited": false, "score": 0, "creation_date": 1522066229, "post_id": 49481903, "comment_id": 85985315, "body": "Because it&#180;s pretty easy to deploy an app in app engine, I don&#180;t feel ready to manage a virtual machine, may be in one year, but not right now, I just wanna focus on my code and later on I can be learning how to manage a VM"}, {"owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "edited": false, "score": 0, "creation_date": 1522072993, "post_id": 49481903, "comment_id": 85990196, "body": "Learn docker. That way you won&#39;t have to be limited by PAAS."}, {"owner": {"reputation": 1935, "user_id": 2650325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1SJPZ.jpg?s=128&g=1", "display_name": "Victor M Herasme Perez", "link": "https://stackoverflow.com/users/2650325/victor-m-herasme-perez"}, "edited": false, "score": 0, "creation_date": 1531812977, "post_id": 49481903, "comment_id": 89722841, "body": "Have you found the answer useful?"}, {"owner": {"reputation": 1655, "user_id": 8682074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1739167192766622/picture?type=large", "display_name": "John Balvin Arias", "link": "https://stackoverflow.com/users/8682074/john-balvin-arias"}, "reply_to_user": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "edited": false, "score": 0, "creation_date": 1531845533, "post_id": 49481903, "comment_id": 89744735, "body": "no, I have not, I&#39;m moving on to kubernetes engine, it does not have that limitation, it&#39;s kinda what @mpm and VictorHerasmePerez said, they were right"}], "answers": [{"tags": [], "owner": {"reputation": 1935, "user_id": 2650325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1SJPZ.jpg?s=128&g=1", "display_name": "Victor M Herasme Perez", "link": "https://stackoverflow.com/users/2650325/victor-m-herasme-perez"}, "is_accepted": true, "score": 0, "last_activity_date": 1550248626, "last_edit_date": 1550248626, "creation_date": 1522855196, "answer_id": 49654743, "question_id": 49481903, "link": "https://stackoverflow.com/questions/49481903/why-does-app-engine-flexible-enviroment-not-allow-websockets-and-http-2-traffic/49654743#49654743", "title": "Why does App Engine Flexible Enviroment not allow WebSockets and HTTP/2 traffic?", "body": "<p>There are other options:</p>\n\n<blockquote>\n  <p>Like the standard environment, the flexible environment does not\n  support websockets. If you need to use websockets you can use <a href=\"https://cloud.google.com/compute/docs\" rel=\"nofollow noreferrer\">Compute\n  Engine</a> or <a href=\"https://cloud.google.com/kubernetes-engine/docs\" rel=\"nofollow noreferrer\">Kubernetes Engine</a>.</p>\n</blockquote>\n\n<p>as stated <a href=\"https://cloud.google.com/appengine/docs/flexible/python/migrating#websockets\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>You can follow the <a href=\"https://issuetracker.google.com/issues/35886348\" rel=\"nofollow noreferrer\">feature request</a> too.</p>\n\n<hr>\n\n<p>Update:</p>\n\n<p>Currently websocket support is available for following languages </p>\n\n<ul>\n<li>Python</li>\n<li>Java</li>\n<li>Node.js</li>\n</ul>\n\n<p>But it's in <strong>beta</strong></p>\n\n<p>Docs: <a href=\"https://cloud.google.com/appengine/docs/flexible/python/using-websockets-and-session-affinity\" rel=\"nofollow noreferrer\">https://cloud.google.com/appengine/docs/flexible/python/using-websockets-and-session-affinity</a></p>\n"}], "owner": {"reputation": 1655, "user_id": 8682074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1739167192766622/picture?type=large", "display_name": "John Balvin Arias", "link": "https://stackoverflow.com/users/8682074/john-balvin-arias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 857, "favorite_count": 1, "accepted_answer_id": 49654743, "answer_count": 1, "score": 0, "last_activity_date": 1550248626, "creation_date": 1522019147, "last_edit_date": 1523277189, "question_id": 49481903, "link": "https://stackoverflow.com/questions/49481903/why-does-app-engine-flexible-enviroment-not-allow-websockets-and-http-2-traffic", "title": "Why does App Engine Flexible Enviroment not allow WebSockets and HTTP/2 traffic?", "body": "<p>I'm more interested in WebSocket, but after reading documentation  <a href=\"https://cloud.google.com/appengine/docs/flexible/go/how-requests-are-handled\" rel=\"nofollow noreferrer\">here</a>,\nI was surprised when I read that:</p>\n\n<blockquote>\n  <p>The following features are not supported by App Engine flexible environment:\n  HTTP/2 traffic to the backend service, Websockets , HTTP requests that directly access instances</p>\n</blockquote>\n\n<p>I was planning to build an app with gorilla-websocket, but now that I've read this, I don't know how I could accomplish it.\nI understand WebSocket is not get supported in App Engine Standard Environment, but why not in the Flexible Environment?</p>\n"}, {"tags": ["go", "kubernetes", "kubernetes-ingress"], "comments": [{"owner": {"reputation": 432, "user_id": 3452880, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/SuCii.jpg?s=128&g=1", "display_name": "edwinj", "link": "https://stackoverflow.com/users/3452880/edwinj"}, "edited": false, "score": 0, "creation_date": 1522091918, "post_id": 49481834, "comment_id": 86002061, "body": "on your ingress, try changing the path form &quot;/api/auth&quot; to &quot;/api/auth/*&quot;  and also like @stacksonsracks mentioned in his answer kubernetes sends the entire path to the server so also try changing routes form &quot;http.HandleFunc(&quot;/&quot;, requestHandler)&quot; to &quot;http.HandleFunc(&quot;/api/auth/&quot;, requestHandler)&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 3221, "user_id": 830230, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/YMFTp.jpg?s=128&g=1", "display_name": "Naguib Ihab", "link": "https://stackoverflow.com/users/830230/naguib-ihab"}, "edited": false, "score": 0, "creation_date": 1522018947, "post_id": 49481866, "comment_id": 85966564, "body": "Sorry I&#39;m actually calling /auth not /auth-service, I edited the question"}, {"owner": {"reputation": 3221, "user_id": 830230, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/YMFTp.jpg?s=128&g=1", "display_name": "Naguib Ihab", "link": "https://stackoverflow.com/users/830230/naguib-ihab"}, "edited": false, "score": 0, "creation_date": 1522107248, "post_id": 49481866, "comment_id": 86008503, "body": "I added <code>ingress.kubernetes.io&#47;rewrite-target: &#47;</code> to my annotations but that didn&#39;t work, I&#39;m still experiencing the same issue. What you&#39;re saying makes sense though"}], "tags": [], "owner": {"reputation": 5800, "user_id": 6163736, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/TKHBG.jpg?s=128&g=1", "display_name": "stacksonstacks", "link": "https://stackoverflow.com/users/6163736/stacksonstacks"}, "is_accepted": true, "score": 2, "last_activity_date": 1522021331, "last_edit_date": 1522021331, "creation_date": 1522018785, "answer_id": 49481866, "question_id": 49481834, "link": "https://stackoverflow.com/questions/49481834/http-handlefunc-not-working/49481866#49481866", "title": "http.HandleFunc not working", "body": "<p><strike>based on your ingress rules the path for requests should be:\n<code>/api/auth/healthz</code>\n  not  <code>/api/auth-service/healthz</code></strike></p>\n\n<p>The ingress path <code>/api/auth/</code> is kept in the request uri passed to the application server.  </p>\n\n<p>Adding <code>rewrite-target</code> to the ingress annotations will ensure the path is passed to your underlying server as you'd expect e.g. as <code>/&lt;path&gt;</code> rather than <code>/api/auth/&lt;path&gt;</code>. Inspecting the application server logs should show this is the case.</p>\n\n<p><code>ingress.kubernetes.io/rewrite-target: /</code> </p>\n"}], "owner": {"reputation": 3221, "user_id": 830230, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/YMFTp.jpg?s=128&g=1", "display_name": "Naguib Ihab", "link": "https://stackoverflow.com/users/830230/naguib-ihab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 617, "favorite_count": 0, "accepted_answer_id": 49481866, "answer_count": 1, "score": 1, "last_activity_date": 1522021331, "creation_date": 1522018476, "last_edit_date": 1522018928, "question_id": 49481834, "link": "https://stackoverflow.com/questions/49481834/http-handlefunc-not-working", "title": "http.HandleFunc not working", "body": "<p>I am working on an application that is hosted on Kubernetes on google cloud, it uses Ingress to manage the routing to each service, then inside each service there's some extra routing using golang.</p>\n\n<p><strong>My problem is:</strong> when I try sending an API request to <code>/api/auth/healthz</code> I am expecting to reach the <code>statusHandler()</code> function, instead I always hit the <code>requestHandler()</code> function, even though I have an http.HandleFunc in there: <code>http.HandleFunc(\"/healthz\", statusHandler)</code></p>\n\n<p>Here's my code in go</p>\n\n<pre><code>func main() {\n    flag.Parse()\n\n    // initialize the \"database\"\n    err := store.Initialise()\n    if err != nil {\n        glog.Error(err)\n        glog.Error(\"Store failed to initialise\")\n    }\n\n    defer store.Uninitialise()\n\n    // Initialize the default TTL for JWT access tokens to 1 day\n    tokenTTL = 24 * time.Hour\n    glog.Infof(\"JWT access tokens time-to-live set to: %s\", tokenTTL.String())\n\n    http.HandleFunc(\"/healthz\", statusHandler)\n    http.HandleFunc(\"/\", requestHandler)\n\n    glog.Infof(\"Authentication service started on port 8080...\\n\")\n    http.ListenAndServe(\":8080\", nil)\n}\n\nfunc statusHandler(w http.ResponseWriter, r *http.Request) {\n    glog.Infof(\"Reached the status handler\")\n    statusObj := serviceStatus{\n        GitSHA:         os.Getenv(\"GIT_SHA\"),\n        BuildTimestamp: os.Getenv(\"BUILD_TIMESTAMP\"),\n        DeployEnv:      os.Getenv(\"DEPLOY_ENV\"),\n    }\n    statusJSON, _ := json.Marshal(statusObj)\n\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    fmt.Fprintf(w, \"%s\", statusJSON)\n}\n\nfunc requestHandler(w http.ResponseWriter, r *http.Request) {\n    glog.Infof(\"Reached the request handler\")\n    ...\n}\n</code></pre>\n\n<p>And here's my Ingress code:</p>\n\n<pre><code>apiVersion: extensions/v1beta1\nkind: Ingress\nmetadata:\n  # https://github.com/kubernetes/ingress-nginx/blob/master/docs/user-guide/annotations.md\n  annotations:\n    kubernetes.io/ingress.class: nginx\n    certmanager.k8s.io/cluster-issuer: letsencrypt-staging\n    nginx.ingress.kubernetes.io/enable-cors: \"false\"\n    nginx.ingress.kubernetes.io/cors-enable-origin: \"*\"\n    nginx.ingress.kubernetes.io/auth-type: \"basic\"\n    nginx.ingress.kubernetes.io/auth-secret: \"ci-ingress-auth\"\n    nginx.ingress.kubernetes.io/proxy-body-size: \"4g\"\n  name: ci-api-ingress\n  namespace: ci\nspec:\n  rules:\n  - host: ci.omitted.io\n    http:\n      paths:\n      - backend:\n          serviceName: auth-service &lt;&lt; This is the service I am working on\n          servicePort: 8080\n        path: /api/auth\n      - backend:\n          serviceName: data-import-service\n          servicePort: 8080\n        path: /api/data-import\n      - backend:\n          serviceName: log-service\n          servicePort: 8080\n        path: /api/log\n      - backend:\n          serviceName: project-service\n          servicePort: 8080\n        path: /api/project\n      - backend:\n          serviceName: orchestration-service\n          servicePort: 8080\n        path: /api/orchestration\n      - backend:\n          serviceName: public\n          servicePort: 80\n        path: /\n</code></pre>\n\n<hr>\n\n<p>Based on <a href=\"https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/\" rel=\"nofollow noreferrer\">Kubernetes' documentation</a> that should work as what they have in there is something similar to my implementation:</p>\n\n<pre><code>http.HandleFunc(\"/healthz\", func(w http.ResponseWriter, r *http.Request) {\n    duration := time.Now().Sub(started)\n    if duration.Seconds() &gt; 10 {\n        w.WriteHeader(500)\n        w.Write([]byte(fmt.Sprintf(\"error: %v\", duration.Seconds())))\n    } else {\n        w.WriteHeader(200)\n        w.Write([]byte(\"ok\"))\n    }\n})\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 3, "creation_date": 1522004048, "post_id": 49479464, "comment_id": 85962067, "body": "You should define the anonymous structs as separate types outside of <code>ReportDefinition</code>."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1522006212, "post_id": 49479464, "comment_id": 85962923, "body": "As Andy Schweig said, you should define your types like this: <a href=\"https://play.golang.org/p/RKOnM6QcaS5\" rel=\"nofollow noreferrer\">play.golang.org/p/RKOnM6QcaS5</a>. In your version you cannot reference the &quot;Column&quot; struct because it&#39;s anonymous, you have there a Column field whose type is an anonymous struct, there is not Column type in your code."}], "answers": [{"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 5, "last_activity_date": 1522051138, "creation_date": 1522051138, "answer_id": 49486583, "question_id": 49479464, "link": "https://stackoverflow.com/questions/49479464/nested-structs-of-arrays-in-go/49486583#49486583", "title": "Nested structs of arrays in Go", "body": "<p>Since the sliced type in the Filters field doesn't have a name, you have to repeat the definition when you want to initialize it:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype ReportDefinition struct {\n    Filters []struct {\n            Column struct {\n                    ColumnName string `json:\"columnName\"`\n                    Value      string `json:\"value\"`\n            } `json:\"column\"`\n            Operator string `json:\"operator\"`\n    } `json:\"filters\"`\n}\n\nfunc main() {\n    var rd ReportDefinition\n    rd.Filters = append(rd.Filters, struct {\n            Column struct {\n                    ColumnName string `json:\"columnName\"`\n                    Value      string `json:\"value\"`\n            } `json:\"column\"`\n            Operator string `json:\"operator\"`\n    }{\n            Column: struct {\n                    ColumnName string `json:\"columnName\"`\n                    Value      string `json:\"value\"`\n            }{\n                    ColumnName: \"foo\",\n                    Value:      \"bar\",\n            },\n            Operator: \"==\",\n    })\n\n    fmt.Printf(\"+%v\\n\", rd)\n}\n</code></pre>\n\n<p>It should be clear that this is very unconvenient, so you should just give your types names (at least those that you want to initialize):</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype ReportDefinition struct {\n    Filters []Filter `json:\"filters\"`\n}\n\ntype Filter struct {\n    Column   Column `json:\"column\"`\n    Operator string `json:\"operator\"`\n}\n\nfunc NewFilter(col, op, val string) Filter {\n    return Filter{\n            Column: Column{\n                    ColumnName: col,\n                    Value:      val,\n            },\n            Operator: op,\n    }\n}\n\ntype Column struct {\n    ColumnName string `json:\"columnName\"`\n    Value      string `json:\"value\"`\n}\n\nfunc main() {\n    var rd ReportDefinition\n    rd.Filters = append(rd.Filters, NewFilter(\"foo\", \"==\", \"bar\"))\n\n    fmt.Printf(\"+%v\\n\", rd)\n}\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 7637631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/435434c89de4b599f8bc3ccd86ea135b?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Godding", "link": "https://stackoverflow.com/users/7637631/benjamin-godding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4629, "favorite_count": 3, "accepted_answer_id": 49486583, "answer_count": 1, "score": 3, "last_activity_date": 1522051138, "creation_date": 1522003068, "last_edit_date": 1522004423, "question_id": 49479464, "link": "https://stackoverflow.com/questions/49479464/nested-structs-of-arrays-in-go", "title": "Nested structs of arrays in Go", "body": "<p>I have started using <a href=\"https://mholt.github.io/json-to-go/\" rel=\"nofollow noreferrer\">https://mholt.github.io/json-to-go/</a> to turn API JSON into go structs and I really like it, however I am stuck on how to initialize the Filters array struct in the Report Definition struct shown below.</p>\n\n<pre><code>type ReportDefinition struct {\n    ReportName string `json:\"reportName\"`\n    ReportType string `json:\"reportType\"`\n    Product    string `json:\"product\"`\n    Email      string `json:\"email\"`\n    CreatedBy  string `json:\"createdBy\"`\n    Duration   struct {\n        Duration  string      `json:\"duration\"`\n        StartDate interface{} `json:\"startDate\"`\n        EndDate   interface{} `json:\"endDate\"`\n    } `json:\"duration\"`\n    Filters []struct {\n        Column struct {\n            ColumnName string `json:\"columnName\"`\n            Value      string `json:\"value\"`\n        } `json:\"column\"`\n        Operator string `json:\"operator\"`\n    } `json:\"filters\"`\n    SortBy            interface{}   `json:\"sortBy\"`\n    ReportGroup       interface{}   `json:\"reportGroup\"`\n    ReportOnHierarchy bool          `json:\"reportOnHierarchy\"`\n    IsReportPreview   string        `json:\"isReportPreview\"`\n    OutputRecordCount interface{}   `json:\"outputRecordCount\"`\n    Schedule          interface{}   `json:\"schedule\"`\n    Columns           []interface{} `json:\"columns\"`\n}\n</code></pre>\n\n<p>I cannot seem to reference the items declared within the Filters struct or even the Filters struct in order to create a new Filter item and append it to Filters.</p>\n\n<p>Is it possible to reference the Column struct with the ReportDefinition written as is? Or am I am doing something silly and I should just declare Filters outside of the ReportDefinition structure?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1522003182, "post_id": 49479363, "comment_id": 85961721, "body": "go generate is line based; you can&#39;t break them."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 3, "last_activity_date": 1522010689, "last_edit_date": 1522010689, "creation_date": 1522003905, "answer_id": 49479638, "question_id": 49479363, "link": "https://stackoverflow.com/questions/49479363/wrap-long-gogenerate-lines-with-markers/49479638#49479638", "title": "Wrap long &#39;go:generate&#39; lines with markers?", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec#Comments\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Comments\" rel=\"nofollow noreferrer\">Comments</a></p>\n  \n  <p>Comments serve as program documentation. There are two forms:</p>\n  \n  <p>1 Line comments start with the character sequence // and stop at the end of the line.</p>\n  \n  <p>2 General comments start with the character sequence /* and stop with the first subsequent character sequence */.</p>\n  \n  <p>A comment cannot start inside a rune or string literal, or inside a\n  comment. A general comment containing no newlines acts like a space.\n  Any other comment acts like a newline.</p>\n</blockquote>\n\n<hr>\n\n<p>No. The <code>//go:generate</code> pragma is a special form of a line comment: \"Line comments start with the character sequence // and stop at the end of the line.\"</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9087310, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Vnkn_iDZTDs/AAAAAAAAAAI/AAAAAAAAiRY/kcvFsI5MJHw/photo.jpg?sz=128", "display_name": "yougg", "link": "https://stackoverflow.com/users/9087310/yougg"}, "is_accepted": false, "score": 0, "last_activity_date": 1606709363, "creation_date": 1606709363, "answer_id": 65068003, "question_id": 49479363, "link": "https://stackoverflow.com/questions/49479363/wrap-long-gogenerate-lines-with-markers/65068003#65068003", "title": "Wrap long &#39;go:generate&#39; lines with markers?", "body": "<p>you may try this way:</p>\n<p>encode the generate command with base64</p>\n<pre class=\"lang-sh prettyprint-override\"><code>base64 &lt;&lt;&lt; 'mockgen -destination=mock/interface.go -package=mock -source=interface.go -mock_names=ConnPool=ConnPool,Row=Row,Rows=Rows,CommandTag=CommandTag,Conn=Conn'\n</code></pre>\n<p>insert the encode content to first line of your go file with comment prefix</p>\n<pre class=\"lang-golang prettyprint-override\"><code>//bW9ja2dlbiAtZGVzdGluYXRpb249bW9jay9pbnRlcmZhY2UuZ28gLXBhY2thZ2U9bW9jayAtc291\n//cmNlPWludGVyZmFjZS5nbyAtbW9ja19uYW1lcz1Db25uUG9vbD1Db25uUG9vbCxSb3c9Um93LFJv\n//d3M9Um93cyxDb21tYW5kVGFnPUNvbW1hbmRUYWcsQ29ubj1Db25uCg==\n</code></pre>\n<p>then add decode and run generate command follow the base64 content</p>\n<pre class=\"lang-golang prettyprint-override\"><code>//go:generate sh -c &quot;eval $(head -3 $GOFILE | tr -d '^[ ]*//[ ]*' | base64 -d)&quot;\n</code></pre>\n<p>at last run <code>go generate yourfile.go</code></p>\n"}], "owner": {"reputation": 4888, "user_id": 1374563, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/puhlO.gif?s=128&g=1", "display_name": "ole", "link": "https://stackoverflow.com/users/1374563/ole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 1, "accepted_answer_id": 49479638, "answer_count": 2, "score": 2, "last_activity_date": 1606709363, "creation_date": 1522002500, "last_edit_date": 1522009420, "question_id": 49479363, "link": "https://stackoverflow.com/questions/49479363/wrap-long-gogenerate-lines-with-markers", "title": "Wrap long &#39;go:generate&#39; lines with markers?", "body": "<p>Is it possible to wrap long lines with markers in Golang?</p>\n\n<p>Here's an example:</p>\n\n<pre><code>//go:generate mockgen -destination=mock/interface.go -package=mock -source=interface.go -mock_names=ConnPool=ConnPool,Row=Row,Rows=Rows,CommandTag=CommandTag,Conn=Conn\ntype ConnPool interface {\n    ...    \n}\n</code></pre>\n"}, {"tags": ["macos", "go", "zsh", "macos-sierra", "oh-my-zsh"], "comments": [{"owner": {"reputation": 1791, "user_id": 3955287, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/159dc4f2207617ca680e16ec03f02981?s=128&d=identicon&r=PG&f=1", "display_name": "Albert Tobac", "link": "https://stackoverflow.com/users/3955287/albert-tobac"}, "edited": false, "score": 0, "creation_date": 1521998235, "post_id": 49478620, "comment_id": 85959927, "body": "I also found that my $PATH=/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/loca&zwnj;&#8203;l/go/bin. How did go/bin appeared there?"}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1521998489, "post_id": 49478620, "comment_id": 85960032, "body": ".dmg is on a Mac? is that right?  Please add version of go you installed and version of Mac operating system.  Then someone can try and replicate"}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1521999425, "post_id": 49478620, "comment_id": 85960372, "body": "edit the body of the question and add this info"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1522075106, "post_id": 49478620, "comment_id": 85991836, "body": "<code>.bash_profile</code> is not used by <code>zsh</code>, and the value of <code>PS1</code> shown is a perfectly valid zsh prompt. What exactly is broken?"}], "owner": {"reputation": 1791, "user_id": 3955287, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/159dc4f2207617ca680e16ec03f02981?s=128&d=identicon&r=PG&f=1", "display_name": "Albert Tobac", "link": "https://stackoverflow.com/users/3955287/albert-tobac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521999591, "creation_date": 1521998185, "last_edit_date": 1521999591, "question_id": 49478620, "link": "https://stackoverflow.com/questions/49478620/golang-installation-broke-my-zsh-prompt-macos", "title": "Golang installation broke my zsh prompt macos", "body": "<p>I installed <code>golang</code> from <code>.dmg</code> and it broke my zsh prompt (if I try bash it works ok).\nI have the following line in <code>.bash_profile</code> </p>\n\n<pre><code>export PS1='[\\u@\\h \\w$(__git_ps1)]\\n\\$ '\n</code></pre>\n\n<p>But when I echo my <code>$PS1</code> it equals <code>%m%#</code>, as well as <code>$PROMPT</code>.\nI am sure it happened after install of go.\nMy $THEME is empty.\nMacos: Sierra 10.12.6\nGo: go1.10 darwin/amd64</p>\n\n<p>How does this work?</p>\n"}, {"tags": ["go", "build", "bazel"], "answers": [{"tags": [], "owner": {"reputation": 26173, "user_id": 1891, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c40d475927f7a86639ec54aa32517572?s=128&d=identicon&r=PG", "display_name": "Jay Conrod", "link": "https://stackoverflow.com/users/1891/jay-conrod"}, "is_accepted": true, "score": 1, "last_activity_date": 1522078275, "creation_date": 1522078275, "answer_id": 49495236, "question_id": 49477297, "link": "https://stackoverflow.com/questions/49477297/bazel-golang-build-fails-when-project-has-internal-dependency/49495236#49495236", "title": "bazel golang build fails when project has internal dependency", "body": "<p>I think the problem is that the import prefix you passed to Gazelle on the command line (<code>github.com/BazelBuildForGo</code>) is different from the imports in the .go files (<code>github.com/wix-private/BazelBuildForGo</code>). When Gazelle sees imports that are outside the current prefix, it will generate external dependencies for those imports, and those dependencies will be missing:</p>\n\n<pre><code>go_library(\n    name = \"go_default_library\",\n    srcs = [\"p1lib.go\"],\n    importpath = \"github.com/BazelBuildForGo/project1/p1lib\",\n    visibility = [\"//visibility:public\"],\n    deps = [\"@com_github_wix_private_bazelbuildforgo//project1/dep1:go_default_library\"],\n)\n</code></pre>\n\n<p>The fix for this is pretty easy though. Just run Gazelle with the prefix <code>github.com/wix-private/BazelBuildForGo</code>. You actually already have this in <code>//:gazelle</code>, so just run that, then rebuild.</p>\n\n<pre><code>$ bazel run //:gazelle\n$ bazel build //...\n</code></pre>\n\n<p>That will change the <code>go_library</code> rule above to this:</p>\n\n<pre><code>go_library(\n    name = \"go_default_library\",\n    srcs = [\"p1lib.go\"],\n    importpath = \"github.com/wix-private/BazelBuildForGo/project1/p1lib\",\n    visibility = [\"//visibility:public\"],\n    deps = [\"//project1/dep1:go_default_library\"],\n)\n</code></pre>\n"}], "owner": {"reputation": 817, "user_id": 293406, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/72d77d157a7ad6f6d24cae43f30f7aee?s=128&d=identicon&r=PG", "display_name": "AlexS", "link": "https://stackoverflow.com/users/293406/alexs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 670, "favorite_count": 1, "accepted_answer_id": 49495236, "answer_count": 1, "score": 4, "last_activity_date": 1522078275, "creation_date": 1521990386, "last_edit_date": 1521991948, "question_id": 49477297, "link": "https://stackoverflow.com/questions/49477297/bazel-golang-build-fails-when-project-has-internal-dependency", "title": "bazel golang build fails when project has internal dependency", "body": "<p>I'm on MacOS 10.13.2.\nGo 1.10.\nbazel 0.11.1</p>\n\n<p>I need to compile a repo that has 2 projects (project1 and project2).\nproject1 has 2 subpacakges. p1lib and dep1\np1lib uses dep1.</p>\n\n<p>I generate BUILD files with gazelle, files look ok. </p>\n\n<pre><code>gazelle -go_prefix=github.com/BazelBuildForGo\n</code></pre>\n\n<p>But when I run build I get an error that says that I'm missing direct dependency.</p>\n\n<pre><code>bazel build //project1\nINFO: Analysed target //project1:project1 (3 packages loaded).\nINFO: Found 1 target...\nERROR: /private/var/tmp/_bazel_user1/df78026a5ee0c7ed3d23dd05c3a3b1f7/external/com_github_wix_private_bazelbuildforgo/project1/p1lib/BUILD.bazel:3:1: GoCompile external/com_github_wix_private_bazelbuildforgo/project1/p1lib/darwin_amd64_stripped/go_default_library~/github.com/BazelBuildForGo/project1/p1lib.a failed (Exit 1)\n2018/03/25 18:02:55 missing strict dependencies:\n    external/com_github_wix_private_bazelbuildforgo/project1/p1lib/p1lib.go: import of github.com/wix-private/BazelBuildForGo/project1/dep1, which is not a direct dependency\nTarget //project1:project1 failed to build\nUse --verbose_failures to see the command lines of failed build steps.\nINFO: Elapsed time: 0.358s, Critical Path: 0.12s\nFAILED: Build did NOT complete successfully\n</code></pre>\n\n<p>My project can be found here \n<a href=\"https://github.com/wix-playground/BazelBuildForGo\" rel=\"nofollow noreferrer\">https://github.com/wix-playground/BazelBuildForGo</a></p>\n"}, {"tags": ["dictionary", "go", "struct"], "comments": [{"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1521990154, "post_id": 49477213, "comment_id": 85956999, "body": "voting to close as the code that doesn&#39;t work isn&#39;t shown.  Which is a shame for me coz I was hoping to answer a nice easy question :)"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1521990400, "post_id": 49477213, "comment_id": 85957079, "body": "Of course this works. But you check for nil before dereferencing the value. Why are you storing pointers to maps and slices anyway. That&#39;s almost never necessary. <a href=\"https://play.golang.org/p/t_vI3GtzTEv\" rel=\"nofollow noreferrer\">play.golang.org/p/t_vI3GtzTEv</a>"}, {"owner": {"reputation": 25, "user_id": 9548374, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RYnhzk-d20M/AAAAAAAAAAI/AAAAAAAACZQ/hFqcoKwn1cU/photo.jpg?sz=128", "display_name": "WhiteDruid", "link": "https://stackoverflow.com/users/9548374/whitedruid"}, "edited": false, "score": 0, "creation_date": 1521990753, "post_id": 49477213, "comment_id": 85957202, "body": "Sorry for my trash-code! I&#39;m newbie in Go and have no enough practice for understanding of all niceties."}, {"owner": {"reputation": 25, "user_id": 9548374, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RYnhzk-d20M/AAAAAAAAAAI/AAAAAAAACZQ/hFqcoKwn1cU/photo.jpg?sz=128", "display_name": "WhiteDruid", "link": "https://stackoverflow.com/users/9548374/whitedruid"}, "edited": false, "score": 0, "creation_date": 1521991538, "post_id": 49477213, "comment_id": 85957449, "body": "Can I ask for the more detailed description? In my sorry I can&#39;t apply an example to my sources :("}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1521992042, "post_id": 49477213, "comment_id": 85957600, "body": "@WhiteDruid <code>v := (*cnf.LcInfoLog)[&quot;index&quot;]</code> &lt;- first dereference the map pointer, then index the map."}, {"owner": {"reputation": 25, "user_id": 9548374, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RYnhzk-d20M/AAAAAAAAAAI/AAAAAAAACZQ/hFqcoKwn1cU/photo.jpg?sz=128", "display_name": "WhiteDruid", "link": "https://stackoverflow.com/users/9548374/whitedruid"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1521994290, "post_id": 49477213, "comment_id": 85958355, "body": "@mkopriva, thank you so much!!! :)"}], "owner": {"reputation": 25, "user_id": 9548374, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RYnhzk-d20M/AAAAAAAAAAI/AAAAAAAACZQ/hFqcoKwn1cU/photo.jpg?sz=128", "display_name": "WhiteDruid", "link": "https://stackoverflow.com/users/9548374/whitedruid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1521989899, "creation_date": 1521989899, "question_id": 49477213, "link": "https://stackoverflow.com/questions/49477213/get-a-value-from-map-stored-in-struct", "title": "Get a value from map stored in struct", "body": "<p>I have a trouble for gonna get a value from map stored in struct. Please, look at the next part of code (some strings skipped):</p>\n\n<pre><code>type Settings struct {\n     ...\n     LcInfoData     *[]LcInfodb   \n     LcInfoLog      *MapLcInfoLL\n}\ntype MapLcInfoLL map[string]LcInfoLL\ntype LcInfoLL struct {\n     EnableLog   string\n     FileLogPtr  *os.File\n}\n... \nfunc updLogInfo(cnf *Settings)(err) {\n   for _, t := range *cnf.LcInfoData { \n       fpPtr, err := logInit(t.FilepLog);\n       if err != nil {\n           exitMsg(1, err.Error());\n       }\n       lcMapVal := LcInfoLL{EnableLog: t.EnableLog, FileLogPtr: fpPtr}\n       lcMap[t.LocationID] = lcMapVal \n   } \n   cnf.uLcInfoLog(&amp;lcMap)      // at the end\n   ...\n}\n</code></pre>\n\n<p>At the end I got filled structure for using in another function (it's global settings). But. I can't get an access to elements inside a map (which stored in structure). I mean something like that:</p>\n\n<pre><code>v := *cnf.LcInfoLog[\"index\"]\nlog.Println(\"ABOUT LOCATION: \", v.FileLogPtr)\n</code></pre>\n\n<p>Can you help me?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["go", "buffer", "seek"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1521990038, "post_id": 49477155, "comment_id": 85956967, "body": "bytes.Buffer.Bytes does not copy bytes. bytes.Reader implements io.Reader and io.Seeker. Are you sure you need all interfaces in one type? I can only think of os.File from the top of my head."}, {"owner": {"reputation": 33, "user_id": 9548414, "user_type": "registered", "profile_image": "https://graph.facebook.com/1034301556701531/picture?type=large", "display_name": "Stefan Liu", "link": "https://stackoverflow.com/users/9548414/stefan-liu"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1521990551, "post_id": 49477155, "comment_id": 85957139, "body": "Seems when using Reader(buff.Bytes()) it&#39;s occupying too much memory, probably caused by the byte slice is going to stack. Yes, i guess i have to use such a type for I can&#39;t afford memory for converting between  Writer and ReadSeeker."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1521992247, "post_id": 49477155, "comment_id": 85957667, "body": "A ReadSeeker necessarily needs a copy of all data. Otherwise seeking to the beginning and/or end is impossible."}, {"owner": {"reputation": 33, "user_id": 9548414, "user_type": "registered", "profile_image": "https://graph.facebook.com/1034301556701531/picture?type=large", "display_name": "Stefan Liu", "link": "https://stackoverflow.com/users/9548414/stefan-liu"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1521992611, "post_id": 49477155, "comment_id": 85957778, "body": "Hi Peter, my case is no more writing after the data is buffered, so it&#39;s a full copy before reading."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1521992864, "post_id": 49477155, "comment_id": 85957881, "body": "Now I understand even less why you need everything in a single type. It&#39;s probably best if you include the code you&#39;re having trouble with. And, again, bytes.NewReader(buff.Bytes()) does not copy any bytes."}, {"owner": {"reputation": 33, "user_id": 9548414, "user_type": "registered", "profile_image": "https://graph.facebook.com/1034301556701531/picture?type=large", "display_name": "Stefan Liu", "link": "https://stackoverflow.com/users/9548414/stefan-liu"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1521993696, "post_id": 49477155, "comment_id": 85958171, "body": "Hi @Peter, i simplified my codes as above, hope it can explain. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9548414, "user_type": "registered", "profile_image": "https://graph.facebook.com/1034301556701531/picture?type=large", "display_name": "Stefan Liu", "link": "https://stackoverflow.com/users/9548414/stefan-liu"}, "edited": false, "score": 0, "creation_date": 1522004627, "post_id": 49478938, "comment_id": 85962307, "body": "Hi Peter, thanks for your perfect answer, i just notice slices are reference types than array, so it&#39;s cheap to be passed. In addition, good point setting zBuf to nil for safety."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 0, "last_activity_date": 1522005647, "last_edit_date": 1522005647, "creation_date": 1521999972, "answer_id": 49478938, "question_id": 49477155, "link": "https://stackoverflow.com/questions/49477155/implementation-of-io-readwriteseeker-in-golang/49478938#49478938", "title": "Implementation of io.ReadWriteSeeker in golang", "body": "<p>For example, using the same underlying array for (<code>uBuf</code> and <code>zBuf</code>) buffers, </p>\n\n<pre><code>package main\n\nimport (\n    \"archive/zip\"\n    \"bytes\"\n    \"io\"\n)\n\nfunc upload(io.ReadSeeker) {}\n\nfunc process() {\n    zBuf := new(bytes.Buffer)\n    zipWriter := zip.NewWriter(zBuf)\n    // add data into zipWriter in sequence\n    zipWriter.Close()\n    uBuf, zBuf := zBuf.Bytes(), nil\n    // upload(io.ReadSeeker)\n    upload(bytes.NewReader(uBuf))\n}\n\nfunc main() {}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/8TKmnL_vRY9\" rel=\"nofollow noreferrer\">https://play.golang.org/p/8TKmnL_vRY9</a></p>\n\n<hr>\n\n<blockquote>\n  <p>Package bytes</p>\n\n<pre><code>import \"bytes\" \n</code></pre>\n  \n  <p><a href=\"https://golang.org/pkg/bytes/#Buffer.Bytes\" rel=\"nofollow noreferrer\">func (*Buffer) Bytes</a></p>\n\n<pre><code>func (b *Buffer) Bytes() []byte\n</code></pre>\n  \n  <p>Bytes returns a slice of length b.Len() holding the unread portion of\n  the buffer. The slice is valid for use only until the next buffer\n  modification (that is, only until the next call to a method like Read,\n  Write, Reset, or Truncate). The slice aliases the buffer content at\n  least until the next buffer modification, so immediate changes to the\n  slice will affect the result of future reads.</p>\n</blockquote>\n\n<p>The tuple assignment statement</p>\n\n<pre><code>    uBuf, zBuf := zBuf.Bytes(), nil\n</code></pre>\n\n<p>gets the slice descriptor for the zipped bytes (<code>zBuf.Bytes()</code>) and assigns it to the slice descriptor <code>uBuf</code>. A slice descriptor is a <code>struct</code> with a pointer to the underlying array, the slice length, and the slice capacity. For example,</p>\n\n<pre><code>type slice struct {\n    array unsafe.Pointer\n    len   int\n    cap   int\n}\n</code></pre>\n\n<p>Then, for safety, we assign <code>nil</code> to <code>zBuf</code> to ensure that no further changes can be made to its underlying array, which is now used by <code>uBuf</code>.</p>\n"}], "owner": {"reputation": 33, "user_id": 9548414, "user_type": "registered", "profile_image": "https://graph.facebook.com/1034301556701531/picture?type=large", "display_name": "Stefan Liu", "link": "https://stackoverflow.com/users/9548414/stefan-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1804, "favorite_count": 1, "accepted_answer_id": 49478938, "answer_count": 1, "score": 3, "last_activity_date": 1522005647, "creation_date": 1521989495, "last_edit_date": 1521993647, "question_id": 49477155, "link": "https://stackoverflow.com/questions/49477155/implementation-of-io-readwriteseeker-in-golang", "title": "Implementation of io.ReadWriteSeeker in golang", "body": "<p>Is there an implementation of <code>io.ReadWriteSeeker</code> to use in Golang? </p>\n\n<p>Since, <code>bytes.Buffer</code> does not implement <code>Seek</code> method, I need to find such an implementation to use as a buffer written by <code>zipwriter</code> and to be read with seeking. </p>\n\n<p>In addition I wont go with <code>Reader(buff.Bytes())</code> to covert with memory copy, because I can not afford double memory size for buffered data.</p>\n\n<p>In addition, when using <code>os.File</code> as the option, if I wont call <code>f.Sync</code>, it will never touch file system, right? Thanks.</p>\n\n<p>My simplified codes:</p>\n\n<pre><code>func process() {\n  buff := new(bytes.Buffer)\n  zipWriter := zip.NewWriter(buff)\n  // here to add data into zipWriter in sequence\n  zipWriter.Close()\n  upload(buff) // upload(io.ReadSeeker)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 1, "creation_date": 1521979597, "post_id": 49475600, "comment_id": 85953717, "body": "<code>[57, 55]</code> is equal to <code>&quot;97&quot;</code>."}, {"owner": {"reputation": 33, "user_id": 5968225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dca0e0070cef2005e5a2e5cd6b9a4666?s=128&d=identicon&r=PG&f=1", "display_name": "haoliang gao", "link": "https://stackoverflow.com/users/5968225/haoliang-gao"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1521979864, "post_id": 49475600, "comment_id": 85953798, "body": "@tkausl so, how? I just cant understand, thanks for help!"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1521980123, "post_id": 49475600, "comment_id": 85953883, "body": "57 decimal == &#39;9&#39;, 55 decimal == &#39;7&#39;. <a href=\"http://man7.org/linux/man-pages/man7/ascii.7.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man7/ascii.7.html</a>"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1521980366, "post_id": 49475600, "comment_id": 85953954, "body": "If you meant to write the byte &#39;a&#39;, don&#39;t convert it to a string with fmt.Fprint. Call w.Write directly, for instance."}, {"owner": {"reputation": 33, "user_id": 5968225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dca0e0070cef2005e5a2e5cd6b9a4666?s=128&d=identicon&r=PG&f=1", "display_name": "haoliang gao", "link": "https://stackoverflow.com/users/5968225/haoliang-gao"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1521982159, "post_id": 49475600, "comment_id": 85954494, "body": "@Peter oh, It&#39;s &quot;9&quot; + &quot;7&quot;, and fmt.Fprint did the conversion. thanks, so clear!"}], "answers": [{"tags": [], "owner": {"reputation": 29582, "user_id": 1427098, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Bvdm0.jpg?s=128&g=1", "display_name": "Darshan Rivka Whittle", "link": "https://stackoverflow.com/users/1427098/darshan-rivka-whittle"}, "is_accepted": true, "score": 1, "last_activity_date": 1521981659, "last_edit_date": 1521981659, "creation_date": 1521980106, "answer_id": 49475708, "question_id": 49475600, "link": "https://stackoverflow.com/questions/49475600/read-from-io-pipereader-does-not-match-write-to-io-pipewriter/49475708#49475708", "title": "Read from io.PipeReader does not match write to io.PipeWriter", "body": "<p>Indeed, the two bytes <code>57</code> and <code>55</code> are the same as the two characters in the string <code>\"97\"</code>.  If you change your last line to use <code>String()</code> rather than <code>Bytes()</code>, you'll get the string:</p>\n\n<pre><code>fmt.Print(\"read: \", buf.String())\n</code></pre>\n\n<p>When you use <code>Bytes()</code>, you're getting the byte value of <code>\"9\"</code>, which is <code>57</code>, followed by that of <code>\"7\"</code>, which is <code>55</code>.</p>\n\n<p>As pointed out by Peter in the comments, you might not be understanding what <code>fmt.Fprint</code> is doing&mdash;it's converting the rune <code>'a'</code> to the string <code>\"97\"</code> (this is the same as how <code>fmt.Println</code> is giving you \"writing:  97\").  If you don't want to do that conversion when you write to the pipe, then don't use <code>fmt.Printf</code>.  As Peter suggests, <code>w.Write</code> is a good option.  For example, <code>w.Write([]byte{byte(in)})</code> does what you seem to want, and allows the final line to work the way you want unchanged.  Another option would be <code>fmt.Fprintf(w, \"%c\", in)</code>.</p>\n"}], "owner": {"reputation": 33, "user_id": 5968225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dca0e0070cef2005e5a2e5cd6b9a4666?s=128&d=identicon&r=PG&f=1", "display_name": "haoliang gao", "link": "https://stackoverflow.com/users/5968225/haoliang-gao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 49475708, "answer_count": 1, "score": 1, "last_activity_date": 1521981659, "creation_date": 1521979335, "last_edit_date": 1521980334, "question_id": 49475600, "link": "https://stackoverflow.com/questions/49475600/read-from-io-pipereader-does-not-match-write-to-io-pipewriter", "title": "Read from io.PipeReader does not match write to io.PipeWriter", "body": "<p>Running this program:</p>\n\n<p><a href=\"https://play.golang.org/p/dkbHTSeyn4_L\" rel=\"nofollow noreferrer\">on play.golang.org</a></p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"io\"\n)\n\nfunc main() {\n    r, w := io.Pipe()\n\n    go func() {\n        defer w.Close()\n        in := 'a' // single quote\n        fmt.Println(\"writing: \", in)\n        fmt.Fprint(w, in)\n    }()\n\n    defer r.Close()\n\n    buf := new(bytes.Buffer)\n    buf.ReadFrom(r)\n\n    fmt.Print(\"read: \", buf.Bytes())\n\n}\n</code></pre>\n\n<p>This outputs:</p>\n\n<pre><code>writing:  97\nread: [57 55]\n</code></pre>\n\n<p>When I do <code>in := \"a\"</code> or <code>fmt.Fprint(w, string(r))</code>, it works as expected (<code>read: [97]</code>).</p>\n\n<p>Is 97 equal to [57, 55] somehow?</p>\n"}, {"tags": ["go", "dependency-management"], "answers": [{"tags": [], "owner": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "is_accepted": true, "score": 2, "last_activity_date": 1533673828, "last_edit_date": 1533673828, "creation_date": 1521979169, "answer_id": 49475581, "question_id": 49475290, "link": "https://stackoverflow.com/questions/49475290/go-dep-and-forks-of-libraries/49475581#49475581", "title": "Go dep and forks of libraries", "body": "<p>If you look at the <code>help</code> you will see this:</p>\n\n<pre><code>&lt;import path&gt;[:alt source URL][@&lt;constraint&gt;]\n</code></pre>\n\n<p>So to add <code>github.com/foo/bar</code> from location <code>github.com/fork/bar</code> you have to add it like this:</p>\n\n<pre><code>dep ensure -add github.com/foo/bar:github.com/fork/bar\n</code></pre>\n\n<p>The source location will be added as <code>source</code> attribute in the <code>Gopkg.toml</code>.</p>\n\n<p>Gopkg docs for <a href=\"https://github.com/golang/dep/blob/master/docs/Gopkg.toml.md#dependency-rules-constraint-and-override\" rel=\"nofollow noreferrer\">dependency rules constraint and override</a> </p>\n"}], "owner": {"reputation": 1885, "user_id": 1536133, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8b7d4d7ca49c05b83a6a296c27df27b0?s=128&d=identicon&r=PG", "display_name": "Gabriel Furstenheim", "link": "https://stackoverflow.com/users/1536133/gabriel-furstenheim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1039, "favorite_count": 0, "accepted_answer_id": 49475581, "answer_count": 1, "score": 0, "last_activity_date": 1533673828, "creation_date": 1521977222, "question_id": 49475290, "link": "https://stackoverflow.com/questions/49475290/go-dep-and-forks-of-libraries", "title": "Go dep and forks of libraries", "body": "<p>I'm trying to understand how to work with Golang and forks. The situation is the following, I'm writing a library <code>project</code> which depends on library <code>github.com/other/some_dependency</code>, which isn't mine.</p>\n\n<p>Because <code>some_dependency</code> is missing some methods  that I need, I fork it to <code>github.com/me/some_dependency</code>. However, I can't just do <code>go get github.com/me/some_dependency</code>, the library references itself so it breaks.</p>\n\n<p>In this <a href=\"http://blog.campoy.cat/2014/03/github-and-go-forking-pull-requests-and.html\" rel=\"nofollow noreferrer\">article</a> they give a possible solution:</p>\n\n<pre><code> go get github.com/other/some_dependency\n cd $GOPATH/src/github.com/other/some_dependency\n git remote add fork git@github.com:me/some_dependency\n git rebase fork/master\n</code></pre>\n\n<p>Now, this is hacky at best. There is no way from the code of the library to know that the dependency is coming from a different repo. Anyone doing <code>go get</code> of my library wouldn't manage to make it work.</p>\n\n<p>As <a href=\"https://github.com/golang/dep\" rel=\"nofollow noreferrer\">dep</a> is expected to be the official dependency manager. I've found how to fix the version:</p>\n\n<pre><code>dep ensure -add github.com/foo/bar@v1.0.0\n</code></pre>\n\n<p>But I cannot find how to set a different remote. Is is possible to do it?\nAs an example, in Node.js with npm it is <a href=\"https://stackoverflow.com/questions/17509669/how-to-install-an-npm-package-from-github-directly\">dead simple</a>:</p>\n\n<pre><code>npm install git+https://git@github.com/visionmedia/express.git\n</code></pre>\n"}, {"tags": ["go", "cryptography", "certificate", "bitcoin"], "comments": [{"owner": {"reputation": 1029, "user_id": 1332738, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/9c03bce3bfdc90e4a7c21914bc306d30?s=128&d=identicon&r=PG", "display_name": "Victor Oliveira", "link": "https://stackoverflow.com/users/1332738/victor-oliveira"}, "edited": false, "score": 0, "creation_date": 1521986446, "post_id": 49475216, "comment_id": 85955869, "body": "How are you generating the keys?"}, {"owner": {"reputation": 267, "user_id": 6920619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ffc37fdf54698bb48840ae5b489baa7?s=128&d=identicon&r=PG&f=1", "display_name": "CipherX", "link": "https://stackoverflow.com/users/6920619/cipherx"}, "reply_to_user": {"reputation": 1029, "user_id": 1332738, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/9c03bce3bfdc90e4a7c21914bc306d30?s=128&d=identicon&r=PG", "display_name": "Victor Oliveira", "link": "https://stackoverflow.com/users/1332738/victor-oliveira"}, "edited": false, "score": 0, "creation_date": 1521988062, "post_id": 49475216, "comment_id": 85956368, "body": "@VictorOliveira I&#39;m working with the library: github.com/btcsuite/btcutil/hdkeychain. I&#39;m generating the key as: privKey, err := hdkeychain.NewMaster(seed, &amp;chaincfg.MainNetParams)  //EC Private Key sKey, err := privKey.ECPrivKey()  and finally as the question&#39;s code: keyDer, err := x509.MarshalECPrivateKey(privKey.ToECDSA())"}, {"owner": {"reputation": 156, "user_id": 2445118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/804a084725dc744d8cd5e7cc867dab27?s=128&d=identicon&r=PG", "display_name": "rny", "link": "https://stackoverflow.com/users/2445118/rny"}, "edited": false, "score": 0, "creation_date": 1523329350, "post_id": 49475216, "comment_id": 86503861, "body": "why not just use the secp256k1 C library instead. You can still compile with cgo."}, {"owner": {"reputation": 906, "user_id": 497300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c8cc3daf6dde73ad11a7e27cf3bc20?s=128&d=identicon&r=PG", "display_name": "trung", "link": "https://stackoverflow.com/users/497300/trung"}, "edited": false, "score": 0, "creation_date": 1562004115, "post_id": 49475216, "comment_id": 100232935, "body": "I used this <a href=\"https://github.com/sour-is/koblitz\" rel=\"nofollow noreferrer\">github.com/sour-is/koblitz</a>, then clone the Golang x509 package by starting from <code>x509.ParseCertificate()</code> and resolving all dependencies.  Noted: i&#39;m not affiliated in anyway with the lib"}, {"owner": {"reputation": 718, "user_id": 2241364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5fe9fd140b01eeaaaf78607686fdcf1?s=128&d=identicon&r=PG", "display_name": "Ga&#235;tan Lehmann", "link": "https://stackoverflow.com/users/2241364/ga%c3%abtan-lehmann"}, "reply_to_user": {"reputation": 906, "user_id": 497300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c8cc3daf6dde73ad11a7e27cf3bc20?s=128&d=identicon&r=PG", "display_name": "trung", "link": "https://stackoverflow.com/users/497300/trung"}, "edited": false, "score": 0, "creation_date": 1591876654, "post_id": 49475216, "comment_id": 110225294, "body": "@trung is there a public repository where your modified x509 package can be found?"}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 7483447, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HajTDzjMK2A/AAAAAAAAAAI/AAAAAAAAAGo/GraYsqWYn-I/photo.jpg?sz=128", "display_name": "imaheshwaran s", "link": "https://stackoverflow.com/users/7483447/imaheshwaran-s"}, "is_accepted": false, "score": 2, "last_activity_date": 1597983421, "last_edit_date": 1597983421, "creation_date": 1597906479, "answer_id": 63499781, "question_id": 49475216, "link": "https://stackoverflow.com/questions/49475216/use-secp256k1-in-go/63499781#63499781", "title": "Use secp256k1 in Go", "body": "<p><a href=\"https://golang.org/pkg/crypto/elliptic/#Curve\" rel=\"nofollow noreferrer\">There is no secp256k1 curve type in go.</a></p>\n<p>How did you created key-pairs?</p>\n<p>I faced this problem. In my case, I used the <a href=\"https://godoc.org/github.com/ethereum/go-ethereum/crypto/secp256k1\" rel=\"nofollow noreferrer\">go-ethereum</a> package to create this curve type. So, I used the same package's <a href=\"https://godoc.org/github.com/ethereum/go-ethereum/crypto#FromECDSA\" rel=\"nofollow noreferrer\">function</a> to parse the key.</p>\n<p>So you have to use same package's specified function to parse the key-pair.</p>\n<p>This x509.MarshalECPrivateKey(privKey) will only helps to Marshal go's standard curve type.</p>\n"}], "owner": {"reputation": 267, "user_id": 6920619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ffc37fdf54698bb48840ae5b489baa7?s=128&d=identicon&r=PG&f=1", "display_name": "CipherX", "link": "https://stackoverflow.com/users/6920619/cipherx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1954, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1597983421, "creation_date": 1521976750, "question_id": 49475216, "link": "https://stackoverflow.com/questions/49475216/use-secp256k1-in-go", "title": "Use secp256k1 in Go", "body": "<p>I'm trying to use the elliptic curve <em>secp256k1</em> in Go with the library \"crypto/x509\". After the key pair generation, I obtain respectively the public key <em>pubKey</em> and the private key <em>privKey</em>. After that, I want to generate a certificate that include the public key, but before I want to store the private key in a <em>.pem</em> file:</p>\n\n<pre><code>keyDer, err := x509.MarshalECPrivateKey(privKey)\n    if err != nil {\n        log.Fatalf(\"Failed to serialize ECDSA key: %s\\n\", err)\n    }\n</code></pre>\n\n<p>but when I try to marshal an EC private key into ASN.1, DER format and to compile the code, I receive an error that said: </p>\n\n<blockquote>\n  <p>Failed to serialize ECDSA key: x509: unknown elliptic curve</p>\n</blockquote>\n\n<p>In this case it's necessary for me to work with that particular curve, so I cannot change to <em>prime256v1</em> or ''similar curve''. Is there a solution that permits to add the support for <em>secp256k1</em> in <em>crypto/x509</em> library, or another way/suggestion?</p>\n"}, {"tags": ["go", "glide-golang", "go-graceful"], "comments": [{"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 2, "creation_date": 1521973595, "post_id": 49474742, "comment_id": 85952026, "body": "Maybe this is the same issue <a href=\"https://github.com/facebookgo/grace/issues/15\" rel=\"nofollow noreferrer\">github.com/facebookgo/grace/issues/15</a>?"}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1522008685, "post_id": 49474742, "comment_id": 85963762, "body": "I don&#39;t think github.com/facebookgo/grace supports Windows. Issue 15 seems to cover it, and contains a workaround. Of course <a href=\"https://gist.github.com/peterhellberg/38117e546c217960747aacf689af3dc2\" rel=\"nofollow noreferrer\">now that Go has this functionality</a> in the standard library, you can just use that."}, {"owner": {"reputation": 21, "user_id": 9547620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/984b0eadd2245200f253fa5224c72014?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewWilliams", "link": "https://stackoverflow.com/users/9547620/andrewwilliams"}, "reply_to_user": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1522019601, "post_id": 49474742, "comment_id": 85966709, "body": "@MichaelHampton i thought about that and saw it, but does compiling a webapp really require a specific OS for certain repos? If so i&#39;ll resort back to my linux machine. Thanks."}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1522024638, "post_id": 49474742, "comment_id": 85967722, "body": "I have no reason to believe Facebook would have ever needed or wanted to make their code run on Windows. Their scale is just too enormous for it, at least internally. And no, not all Go code is portable. The OS-specific stuff in the standard library is carefully isolated enough that you don&#39;t generally notice, but with third party code, who knows."}, {"owner": {"reputation": 21, "user_id": 9547620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/984b0eadd2245200f253fa5224c72014?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewWilliams", "link": "https://stackoverflow.com/users/9547620/andrewwilliams"}, "reply_to_user": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1522047062, "post_id": 49474742, "comment_id": 85973589, "body": "@MichaelHampton i&#39;m having the same issue on my linux computer. Any ideas? http.go fixed, but sqlx-runner same issue."}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1522080747, "post_id": 49474742, "comment_id": 85995843, "body": "Sorry, I did not realize you had two separate questions. The format of <a href=\"https://stackoverflow.com\">Stack Overflow</a> works best when there is only one question per post."}, {"owner": {"reputation": 29876, "user_id": 476716, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4e325890903afc8269eb2c1aa57587b3?s=128&d=identicon&r=PG", "display_name": "OrangeDog", "link": "https://stackoverflow.com/users/476716/orangedog"}, "edited": false, "score": 1, "creation_date": 1535448372, "post_id": 49474742, "comment_id": 91059043, "body": "@AndrewWilliams please don&#39;t vandalise your answered question. It may still be useful to others."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 9547620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/984b0eadd2245200f253fa5224c72014?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewWilliams", "link": "https://stackoverflow.com/users/9547620/andrewwilliams"}, "is_accepted": true, "score": 0, "last_activity_date": 1522068627, "creation_date": 1522068627, "answer_id": 49491910, "question_id": 49474742, "link": "https://stackoverflow.com/questions/49474742/golang-undefined/49491910#49491910", "title": "Golang Undefined", "body": "<p><strong><em>Solution to the first problem:</em></strong><br/> \nGracehttp simply does not support windows. switching to my other OS fixed the compiling problem. </p>\n\n<p><strong><em>Solution to the second problem:</em></strong><br/>\nsqlx runner is outdated. switched to a more updated alternative. </p>\n"}], "owner": {"reputation": 21, "user_id": 9547620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/984b0eadd2245200f253fa5224c72014?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewWilliams", "link": "https://stackoverflow.com/users/9547620/andrewwilliams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1636, "favorite_count": 0, "accepted_answer_id": 49491910, "answer_count": 1, "score": -2, "last_activity_date": 1535448328, "creation_date": 1521973231, "last_edit_date": 1535448328, "question_id": 49474742, "link": "https://stackoverflow.com/questions/49474742/golang-undefined", "title": "Golang Undefined", "body": "<p>I'm trying to compile my application in Go and I'm getting the following errors:</p>\n\n<pre><code>C:\\Users\\Root\\go\\src\\github.com\\ussssseeeeeeerrr\\test&gt; go build\n# github.com/facebookgo/grace/gracehttp\n..\\..\\facebookgo\\grace\\gracehttp\\http.go:104:53: undefined: syscall.SIGUSR2\n..\\..\\facebookgo\\grace\\gracehttp\\http.go:114:8: undefined: syscall.SIGUSR2\n..\\..\\facebookgo\\grace\\gracehttp\\http.go:154:13: undefined: syscall.Kill\n# github.com/ussssseeeeeeerrr/test/models\nC:\\Go\\src\\github.com\\ussssseeeeeeerrr\\test\\models\\setup.go:24:2: undefined: runner.MustPing\n</code></pre>\n\n<p>I'm unsure What I'm doing wrong.</p>\n\n<p><strong><em>http.go {line 104}:</em></strong><br/></p>\n\n<pre><code>    signal.Notify(ch, syscall.SIGINT, syscall.SIGTERM, syscall.SIGUSR2)\n</code></pre>\n\n<p><br/>\n<strong><em>http.go {line 114}:</em></strong><br/></p>\n\n<pre><code>        case syscall.SIGUSR2:\n</code></pre>\n\n<p><br/>\n<strong><em>http.go {line 154}:</em></strong><br/></p>\n\n<pre><code>        if err := syscall.Kill(ppid, syscall.SIGTERM); err != nil {\n</code></pre>\n\n<p><br/>\n<strong><em>Import() section:</em></strong></p>\n\n<pre><code>    \"bytes\"\n    \"crypto/tls\"\n    \"fmt\"\n    \"log\"\n    \"net\"\n    \"net/http\"\n    \"os\"\n    \"os/signal\"\n    \"sync\"\n    \"syscall\"\n\n    \"github.com/facebookgo/grace/gracenet\"\n    \"github.com/facebookgo/httpdown\"\n</code></pre>\n\n<p><strong><em>setup.go {line 24}:</em></strong><br/></p>\n\n<pre><code>    runner.MustPing(db)\n</code></pre>\n\n<p><strong><em>Import() section:</em></strong> </p>\n\n<pre><code>    runner \"gopkg.in/mgutz/dat.v1/sqlx-runner\"\n</code></pre>\n"}, {"tags": ["loops", "go", "struct", "slice", "go-templates"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1521982732, "post_id": 49473199, "comment_id": 85954695, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/18276173/calling-a-template-with-several-pipeline-parameters\" title=\"calling a template with several pipeline parameters\">stackoverflow.com/questions/18276173/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9314969"}, "edited": false, "score": 0, "creation_date": 1521962616, "post_id": 49473280, "comment_id": 85949259, "body": "City is the struct as show above. I wonder How do I access these <code>$city</code> and <code>$region</code> variables in <code>data</code> template"}], "tags": [], "owner": {"reputation": 159, "user_id": 1183632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qs8EG.jpg?s=128&g=1", "display_name": "Danilo", "link": "https://stackoverflow.com/users/1183632/danilo"}, "is_accepted": false, "score": 0, "last_activity_date": 1521960835, "creation_date": 1521960835, "answer_id": 49473280, "question_id": 49473199, "link": "https://stackoverflow.com/questions/49473199/how-to-pass-multiple-values-from-template-to-template/49473280#49473280", "title": "How to pass multiple values from template to template?", "body": "<p>I guess <code>CityWithSomeData</code> is a slice, if so have a try like that:</p>\n\n<pre><code>type viewModel struct {\n    List   []City\n}\n</code></pre>\n\n<p>then, in your template:</p>\n\n<pre><code>{{range .List}}\n        {{$city:=.Name}}\n            {{range .Regions}}\n                      {{$region:=.Name}}\n                      {{template \"data\" .Shops $city $region}}\n            {{end}}\n{{end}}\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9314969"}, "edited": false, "score": 1, "creation_date": 1522051020, "post_id": 49475057, "comment_id": 85975602, "body": "That is the one which I expected. Thanks"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1521976358, "last_edit_date": 1521976358, "creation_date": 1521975583, "answer_id": 49475057, "question_id": 49473199, "link": "https://stackoverflow.com/questions/49473199/how-to-pass-multiple-values-from-template-to-template/49475057#49475057", "title": "How to pass multiple values from template to template?", "body": "<p>Quoting from the doc of <a href=\"https://golang.org/pkg/text/template/\" rel=\"noreferrer\"><code>text/template</code></a>, the syntax of the <code>{{template}}</code> action:</p>\n\n<pre><code>{{template \"name\"}}\n    The template with the specified name is executed with nil data.\n\n{{template \"name\" pipeline}}\n    The template with the specified name is executed with dot set\n    to the value of the pipeline.\n</code></pre>\n\n<p>This means you may pass one optional data to the template execution, not more. If you want to pass multiple values, you have to wrap them into some single value you pass. For details, see <a href=\"https://stackoverflow.com/questions/35224066/how-to-pass-multiple-data-to-go-template/35224244#35224244\">How to pass multiple data to Go template?</a></p>\n\n<p>So we should wrap those data into a struct or a map. But we can't write Go code in a template. What we may do is register a function to which we pass these data, and the function may do the \"packing\" and return a single value which now we can pass to the <code>{{template}}</code> action.</p>\n\n<p>Here's an example wrapper which simply packs these into a map:</p>\n\n<pre><code>func Wrap(shops []Destination, cityName, regionName string) map[string]interface{} {\n    return map[string]interface{}{\n        \"Shops\":      shops,\n        \"CityName\":   cityName,\n        \"RegionName\": regionName,\n    }\n}\n</code></pre>\n\n<p>Custom functions can be registered using the <a href=\"https://golang.org/pkg/text/template/#Template.Funcs\" rel=\"noreferrer\"><code>Template.Funcs()</code></a> method, and don't forget you have to do this before you parse the template text.</p>\n\n<p>Here's a modified template which calls this <code>Wrap()</code> function to produce a single value:</p>\n\n<pre><code>const src = `\n{{define \"data\"}}\n    City: {{.CityName}}, Region: {{.RegionName}}, Shops: {{.Shops}}\n{{end}}\n{{- range . -}}\n        {{$city:=.Name}}\n        {{- range .Regions -}}\n              {{$region:=.Name}}\n              {{- template \"data\" (Wrap .Shops $city $region) -}}\n        {{end}}\n{{- end}}`\n</code></pre>\n\n<p>And here's a runnable example showing these in action:</p>\n\n<pre><code>t := template.Must(template.New(\"cities.gohtml\").Funcs(template.FuncMap{\n    \"Wrap\": Wrap,\n}).Parse(src))\nCityWithSomeData := []City{\n    {\n        Name: \"CityA\",\n        Regions: []Region{\n            {Name: \"CA-RA\", Shops: []Destination{{\"CA-RA-SA\"}, {\"CA-RA-SB\"}}},\n            {Name: \"CA-RB\", Shops: []Destination{{\"CA-RB-SA\"}, {\"CA-RB-SB\"}}},\n        },\n    },\n    {\n        Name: \"CityB\",\n        Regions: []Region{\n            {Name: \"CB-RA\", Shops: []Destination{{\"CB-RA-SA\"}, {\"CB-RA-SB\"}}},\n            {Name: \"CB-RB\", Shops: []Destination{{\"CB-RB-SA\"}, {\"CB-RB-SB\"}}},\n        },\n    },\n}\nif err := t.ExecuteTemplate(os.Stdout, \"cities.gohtml\", CityWithSomeData); err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/mDZrYkyyvCC\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>City: CityA, Region: CA-RA, Shops: [{CA-RA-SA} {CA-RA-SB}]\n\nCity: CityA, Region: CA-RB, Shops: [{CA-RB-SA} {CA-RB-SB}]\n\nCity: CityB, Region: CB-RA, Shops: [{CB-RA-SA} {CB-RA-SB}]\n\nCity: CityB, Region: CB-RB, Shops: [{CB-RB-SA} {CB-RB-SB}]\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9314969"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3686, "favorite_count": 0, "accepted_answer_id": 49475057, "answer_count": 2, "score": 5, "last_activity_date": 1572797652, "creation_date": 1521960066, "last_edit_date": 1572797652, "question_id": 49473199, "link": "https://stackoverflow.com/questions/49473199/how-to-pass-multiple-values-from-template-to-template", "title": "How to pass multiple values from template to template?", "body": "<p>My <code>City</code> struct is like this:</p>\n\n<pre><code>type City struct {\n    ID      int\n    Name    string\n    Regions []Region\n}  \n</code></pre>\n\n<p>And <code>Region</code> struct is:</p>\n\n<pre><code>type Region struct {\n    ID               int\n    Name             string\n    Shops            []Destination\n    Masters          []Master\n    EducationCenters []Destination\n}\n</code></pre>\n\n<p>In main I try to do this:</p>\n\n<pre><code>tpl.ExecuteTemplate(resWriter,\"cities.gohtml\",CityWithSomeData)\n</code></pre>\n\n<p>Is it possible to do something like this inside template? </p>\n\n<pre><code>{{range .}}\n        {{$city:=.Name}}\n            {{range .Regions}}\n                      {{$region:=.Name}}\n                      {{template \"data\" .Shops $city $region}}\n            {{end}}\n{{end}}\n</code></pre>\n"}, {"tags": ["sql", "go"], "answers": [{"comments": [{"owner": {"reputation": 1378, "user_id": 3496776, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0b93e9de0f94f4c49617f50d5fd7e63f?s=128&d=identicon&r=PG&f=1", "display_name": "sibert", "link": "https://stackoverflow.com/users/3496776/sibert"}, "edited": false, "score": 0, "creation_date": 1521959967, "post_id": 49473160, "comment_id": 85948792, "body": "Thanks for the tip. Much simpler to do it in Postgresql:  &quot;to_char(&quot;USER_DATE&quot;,&#39;YYYY-MM-DD&#39;)&quot;. Golang seems to be complicated."}], "tags": [], "owner": {"reputation": 159, "user_id": 1183632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qs8EG.jpg?s=128&g=1", "display_name": "Danilo", "link": "https://stackoverflow.com/users/1183632/danilo"}, "is_accepted": true, "score": 2, "last_activity_date": 1521959537, "creation_date": 1521959537, "answer_id": 49473160, "question_id": 49472881, "link": "https://stackoverflow.com/questions/49472881/iso-date-format-in-golang/49473160#49473160", "title": "ISO date format in golang", "body": "<p>You'ha at least two solution:</p>\n\n<p>1-Check if you can use a database built-in function directly in your SQL statement(have a look here for <a href=\"https://www.sqlite.org/lang_datefunc.html\" rel=\"nofollow noreferrer\">SQLite</a>).</p>\n\n<p>2-Once you have done the <code>... rows.Scan(&amp;hr.USER_DATE ...</code>:</p>\n\n<pre><code>layout := \"2006-01-02T15:04:05Z\"\nt, err := time.Parse(layout, hr.USER_DATE)\n\nif err != nil {\n    fmt.Println(err)\n}\n\nhr.USER_DATE = t.Format(\"2006-01-02\")\n</code></pre>\n\n<p>And read <a href=\"https://gobyexample.com/time-formatting-parsing\" rel=\"nofollow noreferrer\">this article too</a>.</p>\n"}], "owner": {"reputation": 1378, "user_id": 3496776, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0b93e9de0f94f4c49617f50d5fd7e63f?s=128&d=identicon&r=PG&f=1", "display_name": "sibert", "link": "https://stackoverflow.com/users/3496776/sibert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2650, "favorite_count": 0, "accepted_answer_id": 49473160, "answer_count": 1, "score": 3, "last_activity_date": 1521959537, "creation_date": 1521956397, "question_id": 49472881, "link": "https://stackoverflow.com/questions/49472881/iso-date-format-in-golang", "title": "ISO date format in golang", "body": "<p>ISO date format is YYYY-MM-DD. <a href=\"https://github.com/golang/go/issues/2141\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/2141</a></p>\n\n<pre><code>type hr struct {\n    USER_DATE  string\n    USER_ID  string\n}\n\nrows, err := db.Query(`SELECT \"USER_DATE\",\"USER_ID\" FROM user`)\n    if err != nil {\n        http.Error(w, http.StatusText(500), 500)\n    return\n    }\n\ndefer rows.Close()\n\nfor rows.Next() {\n    hr := hr{}\n    err := rows.Scan(&amp;hr.USER_DATE, &amp;hr.USER_ID)\n</code></pre>\n\n<p>The result will be this:</p>\n\n<blockquote>\n  <p>2018-03-21T00:00:00Z, TB</p>\n</blockquote>\n\n<p>I thought this should work, but it did not:</p>\n\n<pre><code>type hr struct {\n    USER_DATE  time.Format(\"2006-01-02\") //&lt;-- gives an error\n    USER_ID  string\n}\n</code></pre>\n\n<p>The desired result should be:</p>\n\n<blockquote>\n  <p>2018-03-21, TB</p>\n</blockquote>\n\n<p>How do I fetch a date from sql and show the date in ISO format?</p>\n"}, {"tags": ["go", "dep"], "answers": [{"tags": [], "owner": {"reputation": 141, "user_id": 6044659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcR8I.png?s=128&g=1", "display_name": "Josiah Niedrauer", "link": "https://stackoverflow.com/users/6044659/josiah-niedrauer"}, "is_accepted": false, "score": 1, "last_activity_date": 1521955365, "creation_date": 1521955365, "answer_id": 49472787, "question_id": 49470283, "link": "https://stackoverflow.com/questions/49470283/dep-ensure-fails-with-solving-failure-failed-to-clean-up-git-repository/49472787#49472787", "title": "dep ensure fails with Solving failure: failed to clean up git repository .", "body": "<p>It's because this repo has a massive number of submodules, and some of them are private repos, and some of them no longer exists. Try running <code>dep ensure -v</code> and you'll see the errors. It seems that dep tries to check out every submodule.</p>\n\n<p>If I was you, I would identify the submodule I need and import that directly.</p>\n"}], "owner": {"reputation": 831, "user_id": 1241876, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6d69cb33ea9c23e47e3e897e53991e08?s=128&d=identicon&r=PG", "display_name": "Rajesh Jain", "link": "https://stackoverflow.com/users/1241876/rajesh-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 955, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521955365, "creation_date": 1521928030, "question_id": 49470283, "link": "https://stackoverflow.com/questions/49470283/dep-ensure-fails-with-solving-failure-failed-to-clean-up-git-repository", "title": "dep ensure fails with Solving failure: failed to clean up git repository .", "body": "<p>I am trying to import the go repo \n<code>https://github.com/cloudfoundry/cli</code></p>\n\n<p>My <code>dep init</code> or <code>dep ensure</code> commands fail when I add the import statement in my go program. </p>\n\n<p>I am not sure what is the reason I am not able to get the repo. I can do a <code>git clone</code> in the go/src and it complains that the local version might be inconsistent. </p>\n\n<p>Not sure what is happening with this particular repo. </p>\n\n<pre><code>bash-3.2$ dep ensure\nSolving failure: failed to clean up git repository at /Users/rjain/go/pkg/dep/sources/https---github.com-cloudfoundry-cli - dirty? corrupted? status output: \n D VERSION\n</code></pre>\n"}, {"tags": ["go", "systemd", "systemctl"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9455968"}, "edited": false, "score": 1, "creation_date": 1521923309, "post_id": 49469541, "comment_id": 85941609, "body": "Try <code>sudo journalctl -f</code> and watch for error messages related to your binary."}, {"owner": {"reputation": 962, "user_id": 5208088, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0b9ad0a35608d37b10dd4d08352ad70c?s=128&d=identicon&r=PG&f=1", "display_name": "Mnemosyne", "link": "https://stackoverflow.com/users/5208088/mnemosyne"}, "edited": false, "score": 0, "creation_date": 1521924417, "post_id": 49469541, "comment_id": 85941936, "body": "No error messages."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1521926195, "post_id": 49469541, "comment_id": 85942469, "body": "Watch out for proper &quot;exec type&quot; in the unit config: the default is not what you want. You need to set it to &quot;simple&quot; or &quot;nofork&quot; or something like this (can&#39;t check ATM)."}, {"owner": {"reputation": 962, "user_id": 5208088, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0b9ad0a35608d37b10dd4d08352ad70c?s=128&d=identicon&r=PG&f=1", "display_name": "Mnemosyne", "link": "https://stackoverflow.com/users/5208088/mnemosyne"}, "edited": false, "score": 0, "creation_date": 1521927084, "post_id": 49469541, "comment_id": 85942734, "body": "Per documentation, the default should be simple."}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 1, "creation_date": 1521928055, "post_id": 49469541, "comment_id": 85943015, "body": "Doesn&#39;t your program log anything?"}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1521928073, "post_id": 49469541, "comment_id": 85943022, "body": "@kostix <code>Type=simple</code> is the default, so it&#39;s fine to omit this for a service which remains in foreground."}, {"owner": {"reputation": 892, "user_id": 4422527, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-vYXXPXAUbX8/AAAAAAAAAAI/AAAAAAAAACI/sCfRq5GIm78/photo.jpg?sz=128", "display_name": "M Gholami", "link": "https://stackoverflow.com/users/4422527/m-gholami"}, "edited": false, "score": 0, "creation_date": 1521989090, "post_id": 49469541, "comment_id": 85956684, "body": "Try <code>ExecStart=&#47;path&#47;to&#47;directory&#47;binary --config &#47;full&#47;path&#47;to&#47;config&#47;service.conf</code>"}, {"owner": {"reputation": 962, "user_id": 5208088, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0b9ad0a35608d37b10dd4d08352ad70c?s=128&d=identicon&r=PG&f=1", "display_name": "Mnemosyne", "link": "https://stackoverflow.com/users/5208088/mnemosyne"}, "edited": false, "score": 0, "creation_date": 1522007929, "post_id": 49469541, "comment_id": 85963525, "body": "Yes, that is actually how my systemd calls for the config file (whole path) but it still does not work."}], "owner": {"reputation": 962, "user_id": 5208088, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0b9ad0a35608d37b10dd4d08352ad70c?s=128&d=identicon&r=PG&f=1", "display_name": "Mnemosyne", "link": "https://stackoverflow.com/users/5208088/mnemosyne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 815, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1521923016, "creation_date": 1521923016, "question_id": 49469541, "link": "https://stackoverflow.com/questions/49469541/running-a-binary-as-systemd-service-does-not-work", "title": "Running a binary as systemd service does not work", "body": "<p>I have a go project and when I compile it I get your typical binary. If I call the binary directly from the command line with the adequate inputs, it runs perfectly well. I want to make this program part of the systemd ecosystem and the following is my my <code>gobinary.service</code></p>\n\n<pre><code>[Unit]\nDescription=Run Go Service\n\n[Service]\nWorkingDirectory=/path/to/directory/\nExecStart=/path/to/directory/binary --config config/service.conf\nRestart=always\n\n[Install]\nWantedBy=multi-user.target\n</code></pre>\n\n<p>I can start and stop the service using the usual <code>sudo service gobinary start</code> without error messages but the problem is that the program is actually not running because it does not respond to the inputs, namely it has a rabbitmq input queue, despite me sending content to the queue it doesn't react. If however I run the program using the binary directly <code>$ ./binary --config/service.conf</code> everything runs smoothly. How do I troubleshoot this?</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1521919473, "post_id": 49468822, "comment_id": 85940295, "body": "use mgo package to get Object ID"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1521919494, "post_id": 49468822, "comment_id": 85940300, "body": "_id is not an exported field, meaning mgo cannot assign values to it."}, {"owner": {"reputation": 3773, "user_id": 5232122, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/87ae151f27d7e84ac4f08d35f12a9d67?s=128&d=identicon&r=PG&f=1", "display_name": "Velidan", "link": "https://stackoverflow.com/users/5232122/velidan"}, "edited": false, "score": 0, "creation_date": 1521921067, "post_id": 49468822, "comment_id": 85940834, "body": "Thanks guys for help. Himanshu  - I just want to know how to do it =) Peter - yes, but it must be possible)"}], "answers": [{"comments": [{"owner": {"reputation": 3773, "user_id": 5232122, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/87ae151f27d7e84ac4f08d35f12a9d67?s=128&d=identicon&r=PG&f=1", "display_name": "Velidan", "link": "https://stackoverflow.com/users/5232122/velidan"}, "edited": false, "score": 0, "creation_date": 1521920777, "post_id": 49468939, "comment_id": 85940718, "body": "Thank you. Now I&#39;m getting this result    <code>ObjectIdHex(&quot;50778ce69331a280cf4bcfdd&quot;)</code>  but I have still a few question    1) To transform this ID into normal value should I use <code>**func ObjectIdHex** ?</code>  2) Could you explait a lil bit this stuff   - <code>Id bson.ObjectId</code> ? This is not a golang type. Is it directly type of MGO.BSON? What if I don&#39;t export the BSON package, is it be still available?    3) ` <code>bson:&quot;_id,omitempty&quot;</code> `  What is this?    the same for  Value int <code>json:&quot;value&quot;</code>   ? What is this -&gt; <code>json:&quot;value&quot;</code>  Thanks!"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 3773, "user_id": 5232122, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/87ae151f27d7e84ac4f08d35f12a9d67?s=128&d=identicon&r=PG&f=1", "display_name": "Velidan", "link": "https://stackoverflow.com/users/5232122/velidan"}, "edited": false, "score": 0, "creation_date": 1521921151, "post_id": 49468939, "comment_id": 85940864, "body": "<code>json:&quot;value&quot;</code> is tag used when marshaling to json. Have a look at <a href=\"https://godoc.org/labix.org/v2/mgo/bson#ObjectId.String\" rel=\"nofollow noreferrer\">String</a> of bson package to convert ObjectId to hex representation of string"}, {"owner": {"reputation": 3773, "user_id": 5232122, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/87ae151f27d7e84ac4f08d35f12a9d67?s=128&d=identicon&r=PG&f=1", "display_name": "Velidan", "link": "https://stackoverflow.com/users/5232122/velidan"}, "edited": false, "score": 0, "creation_date": 1521921416, "post_id": 49468939, "comment_id": 85940941, "body": "Himanshu - Thank you so much friend! You are helped me a lot. Will check it."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 3773, "user_id": 5232122, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/87ae151f27d7e84ac4f08d35f12a9d67?s=128&d=identicon&r=PG&f=1", "display_name": "Velidan", "link": "https://stackoverflow.com/users/5232122/velidan"}, "edited": false, "score": 0, "creation_date": 1521921505, "post_id": 49468939, "comment_id": 85940974, "body": "Also we can use <a href=\"https://godoc.org/labix.org/v2/mgo/bson#ObjectId.Hex\" rel=\"nofollow noreferrer\">Hex</a> function to get the hex representation of Object ID"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 3773, "user_id": 5232122, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/87ae151f27d7e84ac4f08d35f12a9d67?s=128&d=identicon&r=PG&f=1", "display_name": "Velidan", "link": "https://stackoverflow.com/users/5232122/velidan"}, "edited": false, "score": 0, "creation_date": 1523086232, "post_id": 49468939, "comment_id": 86423275, "body": "@Velidan The Object id is created by mongo itself when inserting document until you create it. If you have created a unique id that is an integer. Mongo will use that as a unique id for document."}, {"owner": {"reputation": 3773, "user_id": 5232122, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/87ae151f27d7e84ac4f08d35f12a9d67?s=128&d=identicon&r=PG&f=1", "display_name": "Velidan", "link": "https://stackoverflow.com/users/5232122/velidan"}, "edited": false, "score": 0, "creation_date": 1523088269, "post_id": 49468939, "comment_id": 86423752, "body": "Thank you! I had deleted my question before you answered cause I didn&#39;t know if it not be annoying for you. Thanks. And I have figured out how to fetch an Int _id. Here ``` Id     type Student struct { \tName   string \tScores []ScoreItem \tId     int <code>bson:&quot;_id,omitempty&quot;</code> } ```. So we should degine which type we expect."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 3773, "user_id": 5232122, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/87ae151f27d7e84ac4f08d35f12a9d67?s=128&d=identicon&r=PG&f=1", "display_name": "Velidan", "link": "https://stackoverflow.com/users/5232122/velidan"}, "edited": false, "score": 0, "creation_date": 1523089597, "post_id": 49468939, "comment_id": 86424086, "body": "@Velidan It is not annoying. It feels good to help. Also bson tags are added to struct when working with mongo."}], "tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": true, "score": 4, "last_activity_date": 1521921708, "last_edit_date": 1521921708, "creation_date": 1521919557, "answer_id": 49468939, "question_id": 49468822, "link": "https://stackoverflow.com/questions/49468822/how-to-get-objectid-id-of-my-document-in-mgo-mongo-db-driver-for-golang/49468939#49468939", "title": "How to get ObjectId (_id) of my document in MGO mongo db driver for golang", "body": "<ol>\n<li>Change <code>_id</code> variable to uppercase(ID) to make it exportable.</li>\n<li>Use <code>bson.ObjectID</code> as its type.</li>\n<li>Add tag for struct <code>FunnyNumber</code> Id variable.\nfield</li>\n</ol>\n\n<p>Above three things should be done to get object Id value.</p>\n\n<pre><code>import \"labix.org/v2/mgo/bson\"\n\ntype FunnyNumber struct {\n    Value int `json:\"value\"`\n    Id bson.ObjectId `bson:\"_id,omitempty\"`` // only uppercase variables can be exported\n}\n</code></pre>\n\n<p>Take a look at package <a href=\"https://godoc.org/labix.org/v2/mgo/bson\" rel=\"nofollow noreferrer\">BSON</a> for more understanding on using bson tags when working with mongodb</p>\n"}], "owner": {"reputation": 3773, "user_id": 5232122, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/87ae151f27d7e84ac4f08d35f12a9d67?s=128&d=identicon&r=PG&f=1", "display_name": "Velidan", "link": "https://stackoverflow.com/users/5232122/velidan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6273, "favorite_count": 0, "accepted_answer_id": 49468939, "answer_count": 1, "score": 2, "last_activity_date": 1521921708, "creation_date": 1521918910, "last_edit_date": 1521920825, "question_id": 49468822, "link": "https://stackoverflow.com/questions/49468822/how-to-get-objectid-id-of-my-document-in-mgo-mongo-db-driver-for-golang", "title": "How to get ObjectId (_id) of my document in MGO mongo db driver for golang", "body": "<p>I'm working with MGO (cause I didn't found anything better that it). \nI'have played with it and have got some result but I don't understand how to get the _id (internal Mongo  ObjectId) of document received?</p>\n\n<p>For ex:</p>\n\n<pre><code>type FunnyNumber struct {\n    Value int\n    _id string\n}\n\nsession, err := mgo.Dial(\"127.0.0.1:27017\")\nif err != nil {\n    panic(err)\n}\ndefer session.Close()\n\n// Optional. Switch the session to a monotonic behavior.\nsession.SetMode(mgo.Monotonic, true)\n\nc := session.DB(\"m101\").C(\"funnynumbers\")\n\nfunnynumber := FunnyNumber{}\nerr = c.Find(bson.M{}).One(&amp;funnynumber)\nif err != nil {\n    log.Fatal(err)\n}\n\nfmt.Println(\"Id one:\", funnynumber._id)  // Nothing here? WHy? How to get it.\nfmt.Println(\"Value one:\", funnynumber.Value)  // 62. It's OK!\n</code></pre>\n\n<p>Could someone help me, please? Ot where might I read some info about it? I haven't found anything in the MGO doc</p>\n\n<p>Schema of my document is:</p>\n\n<pre><code>{ \"_id\" : ObjectId(\"50778ce69331a280cf4bcf90\"), \"value\" : 62 }\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["sockets", "go", "network-programming"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1521917035, "post_id": 49468401, "comment_id": 85939453, "body": "Your first read  of (up to) 128 bytes reads both id and message. Also, you are writing the client id first but the server expects the message first."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1521917348, "post_id": 49468401, "comment_id": 85939577, "body": "In other words, it does not matter if you call write once or twice with such short strings. Your kernel will almost certainly combine them into a single write to the &quot;network&quot;. You have to delimit your messages in order to take them apart on the server."}, {"owner": {"reputation": 155, "user_id": 8287030, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d60020766c26e9acb8c0f898921333f9?s=128&d=identicon&r=PG&f=1", "display_name": "cpuNram", "link": "https://stackoverflow.com/users/8287030/cpunram"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1521918507, "post_id": 49468401, "comment_id": 85939988, "body": "@Peter: Thanks for the quick look. It worked after fixing the order of hand shake and payload lengths. Eventually, I am going to serialize and deserialize (using JSON or some other means)."}], "owner": {"reputation": 155, "user_id": 8287030, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d60020766c26e9acb8c0f898921333f9?s=128&d=identicon&r=PG&f=1", "display_name": "cpuNram", "link": "https://stackoverflow.com/users/8287030/cpunram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 246, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521917183, "creation_date": 1521916447, "last_edit_date": 1521917183, "question_id": 49468401, "link": "https://stackoverflow.com/questions/49468401/multi-writes-and-reads-hanging-golang-net-pkg", "title": "Multi writes and reads hanging - golang/net pkg", "body": "<p>I am trying to learn Golang (and net pkg). I have written a simple client\nand server. Client sends two messages in sequence and reads server msg.\nServer reads two messages from a client and sends one message - this hand\nshake is hanging. Could you suggest what I am missing? Thanks.</p>\n\n<p>When client combine two messages into one and sends it (so the server reads\nonly once), this does not hang.</p>\n\n<pre><code>/* ======= Server start ==============================================*/\npackage main\n\nimport (\n    \"fmt\"\n    \"net\"\n    \"os\"\n)\n\nfunc processClients(cfd net.Conn) {\n    clientMsg := make([]byte, 128)\n    _, err := cfd.Read(clientMsg) // read client msg\n    if err != nil {\n        return\n    }\n    clientID := make([]byte, 10)\n    _, err = cfd.Read(clientID) // read client id\n    if err != nil {\n        return\n    }\n\n    clientMsg = append(clientMsg, clientID...) // TBD: handle len boundaries\n    fmt.Println(\"Server received msg:\", string(clientMsg))\n\n    _, err = cfd.Write(clientMsg[0:len(clientMsg)]) // ack client msg\n    if err != nil {\n        return\n    }\n}\n\nfunc initServer() {\n    lfd, err := net.Listen(\"unix\", \"/tmp/unix.socket\")\n    if err != nil {\n        fmt.Println(\"net.Listen error\", err)\n        return\n    }\n\n    defer os.Remove(\"/tmp/unix.socket\")\n\n    fmt.Println(\"Listening on /tmp/unix.socket\")\n    for {\n        fd, err := lfd.Accept()\n        if err != nil {\n            fmt.Println(\"Accept() error\", fd)\n            break\n        }\n\n        go processClients(fd)\n    }\n}\n\nfunc main() {\n    initServer()\n}\n/* ======= Server end ===============================================*/ \n\n\n\n/* ======= Client Start ===============================================*/\n\npackage main\n\nimport (\n    \"fmt\"\n    \"net\"\n    \"sync\"\n)\n\nvar wg sync.WaitGroup\nvar clientID int\n\nfunc sendReq() {\n    fd, err := net.Dial(\"unix\", \"/tmp/unix.socket\")\n    if err != nil {\n        return\n    }\n    defer fd.Close()\n\n    clientID++\n    id := fmt.Sprintf(\"%v\", clientID)\n    _, err = fd.Write([]byte(id)) //send client id\n    if err != nil {\n        return\n    }\n\n    _, err = fd.Write([]byte(\"Hello there, I am client\")) // send client msg\n    if err != nil {\n        return\n    }\n\n    serverMsg := make([]byte, 128)\n    _, err = fd.Read(serverMsg) // Read server msg\n    if err != nil {\n        return\n    }\n    fmt.Println(string(serverMsg))\n    wg.Done()\n}\n\nfunc main() {\n    wg.Add(5)\n    go sendReq()\n    go sendReq()\n    go sendReq()\n    go sendReq()\n    go sendReq()\n    wg.Wait()\n}\n/* ======= Client end ===============================================*/\n</code></pre>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9545545, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "faruq", "link": "https://stackoverflow.com/users/9545545/faruq"}, "edited": false, "score": 0, "creation_date": 1521920230, "post_id": 49468585, "comment_id": 85940524, "body": "can you  pls send me the whole code cause i am new in go and i am finding it difficult to place this block properly. @Emile"}, {"owner": {"reputation": 2960, "user_id": 3521243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EJDD8.jpg?s=128&g=1", "display_name": "Emile Pels", "link": "https://stackoverflow.com/users/3521243/emile-pels"}, "reply_to_user": {"reputation": 3, "user_id": 9545545, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "faruq", "link": "https://stackoverflow.com/users/9545545/faruq"}, "edited": false, "score": 0, "creation_date": 1521920360, "post_id": 49468585, "comment_id": 85940570, "body": "@LokeshSingh I&#39;ve added a Playground with everything included."}, {"owner": {"reputation": 3, "user_id": 9545545, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "faruq", "link": "https://stackoverflow.com/users/9545545/faruq"}, "edited": false, "score": 0, "creation_date": 1521921869, "post_id": 49468585, "comment_id": 85941093, "body": "Can you say me how to display it on browser?"}], "tags": [], "owner": {"reputation": 2960, "user_id": 3521243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EJDD8.jpg?s=128&g=1", "display_name": "Emile Pels", "link": "https://stackoverflow.com/users/3521243/emile-pels"}, "is_accepted": true, "score": 0, "last_activity_date": 1521920316, "last_edit_date": 1521920316, "creation_date": 1521917551, "answer_id": 49468585, "question_id": 49468309, "link": "https://stackoverflow.com/questions/49468309/how-to-extract-json-api-through-go-to-extract-stargazers-count-of-a-repo/49468585#49468585", "title": "How to extract json api through go to extract stargazers_count of a repo?", "body": "<p>Here is an <a href=\"https://play.golang.org/p/nb1WwQS_bV2\" rel=\"nofollow noreferrer\">example</a> (completely neglecting error handling):</p>\n\n<pre><code>request, _ := http.Get(\"https://api.github.com/repos/openebs/openebs\")\ndefer request.Body.Close()\nbytes, _ := ioutil.ReadAll(request.Body)\n\nvar apiResponse struct {\n    StargazersCount int `json:\"stargazers_count\"`\n}\njson.Unmarshal(bytes, &amp;apiResponse)\n\nfmt.Println(apiResponse.StargazersCount)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/nb1WwQS_bV2\" rel=\"nofollow noreferrer\">Playground</a></p>\n"}], "owner": {"reputation": 3, "user_id": 9545545, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "faruq", "link": "https://stackoverflow.com/users/9545545/faruq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 1, "accepted_answer_id": 49468585, "answer_count": 1, "score": -5, "last_activity_date": 1527604216, "creation_date": 1521915933, "last_edit_date": 1527604216, "question_id": 49468309, "link": "https://stackoverflow.com/questions/49468309/how-to-extract-json-api-through-go-to-extract-stargazers-count-of-a-repo", "title": "How to extract json api through go to extract stargazers_count of a repo?", "body": "<p>stargazers_count of <a href=\"https://api.github.com/repos/openebs/openebs\" rel=\"nofollow noreferrer\">https://api.github.com/repos/openebs/openebs</a> using go language by extracting it through json</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 5, "creation_date": 1521915946, "post_id": 49468242, "comment_id": 85939072, "body": "Nope, this is it. If you the use same condition a lot, you can define a function that takes a closure as an argument, which is called for each value satisfying the condition."}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 1, "creation_date": 1521920538, "post_id": 49468242, "comment_id": 85940629, "body": "I don&#39;t know if this makes sense in your application, but could you maintain a separate list of things for which <code>value.Enabled</code> is true and range over that?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 1, "creation_date": 1540248991, "post_id": 49469339, "comment_id": 92786615, "body": "wonder why call it &quot;apply&quot; instead of &quot;map&quot;, map is a better name? dunno"}, {"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 0, "creation_date": 1540262587, "post_id": 49469339, "comment_id": 92789606, "body": "oh I see, yeah that makes sense I guess"}, {"owner": {"reputation": 84, "user_id": 171287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34e84f15cc083aaf9931b8af419b6ed3?s=128&d=identicon&r=PG", "display_name": "Rainer Schuster", "link": "https://stackoverflow.com/users/171287/rainer-schuster"}, "edited": false, "score": 0, "creation_date": 1589233746, "post_id": 49469339, "comment_id": 109207934, "body": "for loops are a strange thing, where I come from. No matter what programming language I use"}, {"owner": {"reputation": 1105, "user_id": 840635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62d893cacc4318e7a96f830f1bc7cb99?s=128&d=identicon&r=PG", "display_name": "Carlos", "link": "https://stackoverflow.com/users/840635/carlos"}, "edited": false, "score": 2, "creation_date": 1599479118, "post_id": 49469339, "comment_id": 112778513, "body": "it would have been great if Rob had elaborated his advice with &quot;because...&quot;"}, {"owner": {"reputation": 363, "user_id": 9862732, "user_type": "registered", "profile_image": "https://graph.facebook.com/1598343040292219/picture?type=large", "display_name": "Sergey  Molchanovsky", "link": "https://stackoverflow.com/users/9862732/sergey-molchanovsky"}, "edited": false, "score": 1, "creation_date": 1608469008, "post_id": 49469339, "comment_id": 115587996, "body": "I disagree, for-loops is kind of beginner level, and using collection methods is an advanced level. It&#39;s a shame that Go still doesn&#39;t have map/filter/reduce/any/take/skip etc. methods out of the box."}, {"owner": {"reputation": 1588, "user_id": 2693851, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/100001410896824/picture?type=large", "display_name": "Leonid Bor", "link": "https://stackoverflow.com/users/2693851/leonid-bor"}, "edited": false, "score": 1, "creation_date": 1613959744, "post_id": 49469339, "comment_id": 117228679, "body": "Why is marked as an answer? This is a highly opinionated statement. Clearly, functional approach has its obvious advantages, otherwise it wouldn&#39;t be as popular as it is today, and the fact that Golang is missing features that are considered being basic for most languages nowadays doesn&#39;t mean that you &quot;shouldn&#39;t use&quot; those."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 21, "last_activity_date": 1521921900, "creation_date": 1521921900, "answer_id": 49469339, "question_id": 49468242, "link": "https://stackoverflow.com/questions/49468242/idiomatic-replacement-for-map-reduce-filter-etc/49469339#49469339", "title": "Idiomatic Replacement for map/reduce/filter/etc", "body": "<blockquote>\n  <p><a href=\"https://github.com/robpike/filter\" rel=\"noreferrer\">Simple apply/filter/reduce package.</a> </p>\n  \n  <p>I wanted to see how hard it was to implement this sort of thing in Go,\n  with as nice an API as I could manage. It wasn't hard.</p>\n  \n  <p>Having written it a couple of years ago, I haven't had occasion to use\n  it once. Instead, I just use \"for\" loops.</p>\n  \n  <p>You shouldn't use it either.</p>\n  \n  <p>Rob Pike</p>\n</blockquote>\n\n<hr>\n\n<p>Follow Rob's advice. Use for loops.</p>\n"}, {"comments": [{"owner": {"reputation": 9230, "user_id": 426877, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/5a287a2bae7fdcf36c8ea27174d959d2?s=128&d=identicon&r=PG", "display_name": "Magnus", "link": "https://stackoverflow.com/users/426877/magnus"}, "edited": false, "score": 1, "creation_date": 1567003053, "post_id": 54225633, "comment_id": 101833884, "body": "Not sure if &quot;regularly updated&quot; is a vote for or against using it?  I&#39;d generally prefer no updates to my core utilities."}, {"owner": {"reputation": 2971, "user_id": 5561773, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/ssUz7.jpg?s=128&g=1", "display_name": "Clement", "link": "https://stackoverflow.com/users/5561773/clement"}, "reply_to_user": {"reputation": 9230, "user_id": 426877, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/5a287a2bae7fdcf36c8ea27174d959d2?s=128&d=identicon&r=PG", "display_name": "Magnus", "link": "https://stackoverflow.com/users/426877/magnus"}, "edited": false, "score": 1, "creation_date": 1567045908, "post_id": 54225633, "comment_id": 101847975, "body": "good point @Magnus but version should be locked in your setup to make sure that doesn&#39;t happen."}, {"owner": {"reputation": 242, "user_id": 669378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/321895588335717d7855b0e70c64b646?s=128&d=identicon&r=PG", "display_name": "csgeek", "link": "https://stackoverflow.com/users/669378/csgeek"}, "edited": false, "score": 0, "creation_date": 1590511517, "post_id": 54225633, "comment_id": 109704721, "body": "Well they do have tags.  Based on what i&#39;m seeing this is great.  I&#39;m planning to incorporate it in future projects.  Just the ability to do a slice.Contains() is worth it to me."}], "tags": [], "owner": {"reputation": 2971, "user_id": 5561773, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/ssUz7.jpg?s=128&g=1", "display_name": "Clement", "link": "https://stackoverflow.com/users/5561773/clement"}, "is_accepted": false, "score": 9, "last_activity_date": 1555385198, "last_edit_date": 1555385198, "creation_date": 1547673981, "answer_id": 54225633, "question_id": 49468242, "link": "https://stackoverflow.com/questions/49468242/idiomatic-replacement-for-map-reduce-filter-etc/54225633#54225633", "title": "Idiomatic Replacement for map/reduce/filter/etc", "body": "<p>If you're still interested, the <code>go-funk</code> package will enable you to do map/reduce/filter etc.</p>\n\n<p>This library is at the time of answering regularly updated. The previous library mentioned hasn't been updated in 4 years.</p>\n\n<p><a href=\"https://github.com/thoas/go-funk\" rel=\"noreferrer\">Github - Go Funk</a></p>\n"}, {"comments": [{"owner": {"reputation": 176, "user_id": 1352635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b189c9e2390494b781d3cef984396a1?s=128&d=identicon&r=PG", "display_name": "Milen Georgiev", "link": "https://stackoverflow.com/users/1352635/milen-georgiev"}, "edited": false, "score": 0, "creation_date": 1611381079, "post_id": 58404381, "comment_id": 116438502, "body": "What is that &quot;deeper&quot; reason that you&#39;re talking about?"}], "tags": [], "owner": {"reputation": 522, "user_id": 1611102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b464a54d2edba7c4979e018d0b81cd1a?s=128&d=identicon&r=PG", "display_name": "cpchung", "link": "https://stackoverflow.com/users/1611102/cpchung"}, "is_accepted": false, "score": 5, "last_activity_date": 1571187772, "creation_date": 1571187772, "answer_id": 58404381, "question_id": 49468242, "link": "https://stackoverflow.com/questions/49468242/idiomatic-replacement-for-map-reduce-filter-etc/58404381#58404381", "title": "Idiomatic Replacement for map/reduce/filter/etc", "body": "<p>I disagree with peterSO's quote. If you want to use golang to implement a query engine like presto/Athena/hive/impala/sparkSQL, you need to create a map/reduce/filter layer of abstraction. Without that, it is not that straight forward to do term rewriting from select/where that kind of SQL queries.</p>\n\n<p>Of course, there is a deeper reason why we dont see query engine is implemented in Golang :) </p>\n"}], "owner": {"reputation": 156951, "user_id": 4668, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e5abe1d27b286199c319b0cbe75596c3?s=128&d=identicon&r=PG", "display_name": "Alan Storm", "link": "https://stackoverflow.com/users/4668/alan-storm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11543, "favorite_count": 4, "accepted_answer_id": 49469339, "answer_count": 3, "score": 17, "last_activity_date": 1607074958, "creation_date": 1521915553, "last_edit_date": 1521981157, "question_id": 49468242, "link": "https://stackoverflow.com/questions/49468242/idiomatic-replacement-for-map-reduce-filter-etc", "title": "Idiomatic Replacement for map/reduce/filter/etc", "body": "<p>I have a list of things in a go program.  I want to loop over them, and perform some operation on/with a subset of those things.  Is there more elegant/idiomatic code for doing this than the following?</p>\n\n<pre><code>for key, value := range listOfThings {\n    if(!value.Enabled) {\n        continue;\n    }\n\n    doTheThing(key, value)\n}\n</code></pre>\n\n<p>The large context -- I'm coming from languages where map/reduce/filter/etc are popular patterns for this sort of thing, but <a href=\"https://www.reddit.com/r/golang/comments/1m25a1/map_reduce_and_filter_in_go/\" rel=\"noreferrer\">word on the internet</a> is that those sorts of higher level abstractions aren't really a go-ish thing to do.   </p>\n\n<p>Is there something more elegant than guard/<code>continue</code> clauses in my range blocks for this sort of code?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2620, "user_id": 6489829, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a56125658a5592143ade081194b89d6f?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Gore", "link": "https://stackoverflow.com/users/6489829/jack-gore"}, "edited": false, "score": 0, "creation_date": 1521915597, "post_id": 49468231, "comment_id": 85938950, "body": "It is just assigning two values in a single line."}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 3, "creation_date": 1521915649, "post_id": 49468231, "comment_id": 85938970, "body": "Paste the code here, don&#39;t just link to an external site. Also, when linking to GitHub, press Y to get a permalink.  Otherwise, when the code changes, your link no longer points to the right line."}], "answers": [{"comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 2, "creation_date": 1521917158, "post_id": 49468262, "comment_id": 85939510, "body": "ALERT: <code>np.Point, np.Valid = Point{}, false</code> is NOT a <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow noreferrer\">short variable declaration</a>. It is a <a href=\"https://golang.org/ref/spec#Assignments\" rel=\"nofollow noreferrer\">tuple assignment</a>."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1521917547, "post_id": 49468262, "comment_id": 85939636, "body": "The downvote rule is &quot;This answer is not useful&quot; Wrong answers are not useful."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1521917690, "post_id": 49468262, "comment_id": 85939693, "body": "I agree there is more to add but my answer is that OP get the idea."}], "tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": true, "score": 4, "last_activity_date": 1521981107, "last_edit_date": 1521981107, "creation_date": 1521915651, "answer_id": 49468262, "question_id": 49468231, "link": "https://stackoverflow.com/questions/49468231/what-is-three-commas-syntax-in-go/49468262#49468262", "title": "What is three commas syntax in Go?", "body": "<p>This is not a three comma syntax. It is actually initializing two variables together in a line</p>\n\n<pre><code>np.Point, np.Valid = Point{}, false\n</code></pre>\n\n<p>is similar to</p>\n\n<pre><code>np.Point = Point{}\nnp.Valid = false\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1521917017, "creation_date": 1521917017, "answer_id": 49468495, "question_id": 49468231, "link": "https://stackoverflow.com/questions/49468231/what-is-three-commas-syntax-in-go/49468495#49468495", "title": "What is three commas syntax in Go?", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Assignments\" rel=\"nofollow noreferrer\">Assignments</a></p>\n  \n  <p>A tuple assignment assigns the individual elements of a multi-valued\n  operation to a list of variables. There are two forms. In the first,\n  the right hand operand is a single multi-valued expression such as a\n  function call, a channel or map operation, or a type assertion. The\n  number of operands on the left hand side must match the number of\n  values. For instance, if f is a function returning two values,</p>\n  \n  <p><code>x, y = f()</code></p>\n  \n  <p>assigns the first value to x and the second to y. In the second form,\n  the number of operands on the left must equal the number of\n  expressions on the right, each of which must be single-valued, and the\n  nth expression on the right is assigned to the nth operand on the\n  left:</p>\n  \n  <p><code>one, two, three = '\u4e00', '\u4e8c', '\u4e09'</code></p>\n</blockquote>\n\n<hr>\n\n<p>A tuple assignment assigns the individual elements of a multi-valued\noperation to a list of variables. In the second form, the number of operands on the left must equal the number of > expressions on the right, each of which must be single-valued, and the nth expression on the right is assigned to the nth operand on the left.</p>\n\n<p>In your example,</p>\n\n<pre><code>np.Point, np.Valid = Point{}, false\n</code></pre>\n\n<p>Or, equivalently,</p>\n\n<pre><code>t1 := Point{}\nt2 := false\nnp.Point = t1\nnp.Valid = t2\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 3255803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5bD5A.png?s=128&g=1", "display_name": "Arthur A. Bergamaschi", "link": "https://stackoverflow.com/users/3255803/arthur-a-bergamaschi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 1, "accepted_answer_id": 49468262, "answer_count": 2, "score": 1, "last_activity_date": 1521981107, "creation_date": 1521915509, "last_edit_date": 1521919697, "question_id": 49468231, "link": "https://stackoverflow.com/questions/49468231/what-is-three-commas-syntax-in-go", "title": "What is three commas syntax in Go?", "body": "<p>Can anyone explain to me what is this line doing? I've never seen this before, I guess.</p>\n\n<pre><code>np.Point, np.Valid = Point{}, false\n</code></pre>\n\n<p>As stated in this github <a href=\"https://github.com/dewski/spatial/blob/master/point.go#L65\" rel=\"nofollow noreferrer\">code</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1521906222, "post_id": 49466522, "comment_id": 85935857, "body": "Your second code example contains a bunch of invalid Go code, it&#39;s hard to tell whether you have difficulties writing valid Go or whether you have difficulties solving your actual problem. Listen to the compiler errors and fix your code. To answer your actual question, you can use the <code>reflect</code> package, with that you can loop over an arbitrary struct type&#39;s fields and check their values individually."}, {"owner": {"reputation": 789, "user_id": 9077800, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/StzLv.jpg?s=128&g=1", "display_name": "aquiseb", "link": "https://stackoverflow.com/users/9077800/aquiseb"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1521918614, "post_id": 49466522, "comment_id": 85940019, "body": "@mkopriva I have edited the second code block, hopefully my question is more clear now"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1521919033, "post_id": 49466522, "comment_id": 85940158, "body": "Are you able to instantiate the <code>reviewInput</code> type yourself or is that an unexported type from a 3rd party package that does not provide a simple way to construct it? Because if you are, then it doesn&#39;t matter the least bit that the value you want to check is a field in the args type, just do what you&#39;re doing in the first code example."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1521919147, "post_id": 49466522, "comment_id": 85940190, "body": "...anyways the way you&#39;re approaching it, with <code>DeepEqual</code>, feels very weird to me (personal opinion), if you care take a look at this example: <a href=\"https://play.golang.org/p/nnf-VPIQwkk\" rel=\"nofollow noreferrer\">play.golang.org/p/nnf-VPIQwkk</a>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1521919461, "post_id": 49466522, "comment_id": 85940291, "body": "Also I&#39;m assuming that you have a lot more than just two fields to check and you&#39;re looking for a way to avoid writing <code>ifs</code> for each field individually. If that&#39;s not the case, if you have only two fields or even a bit more, please don&#39;t use reflect, use <code>if v.f == nil &amp;&amp; v.g == nil {</code> instead, it&#39;s much more clearer what&#39;s happening and it&#39;s also the more Go-ish approach."}, {"owner": {"reputation": 789, "user_id": 9077800, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/StzLv.jpg?s=128&g=1", "display_name": "aquiseb", "link": "https://stackoverflow.com/users/9077800/aquiseb"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1521920136, "post_id": 49466522, "comment_id": 85940497, "body": "Thank you very much. <code>reviewInput</code> is indeed instantiated through github.com/neelance/graphql-go as a mutation, I was trying to get as close as possible to illustrate my issue. You&#39;re absolutely right, checking <code>newReview</code> from the first code block does give me the information, however that&#39;s what I&#39;m worried about: is it not better practice to check <code>args.Review</code> instead of first injecting its fields into <code>newReview</code> first? Thank you for your tip about <code>DeepEqual</code> and advising to not use reflect. Please feel free to write an answer that wraps it all so I can upvote and mark as accepted answer"}, {"owner": {"reputation": 789, "user_id": 9077800, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/StzLv.jpg?s=128&g=1", "display_name": "aquiseb", "link": "https://stackoverflow.com/users/9077800/aquiseb"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1521921036, "post_id": 49466522, "comment_id": 85940821, "body": "Just a little clarification regarding the go play snippet you&#39;ve sent and in case you are wrapping all comments in a complete answer; I&#39;m trying to know if all fields are nil, not trying to know if each field is nil (one by one), but the line between both is very thin I know ;)"}], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 3, "last_activity_date": 1521922328, "creation_date": 1521922328, "answer_id": 49469420, "question_id": 49466522, "link": "https://stackoverflow.com/questions/49466522/how-to-check-if-all-fields-of-a-struct-are-nil/49469420#49469420", "title": "How to check if all fields of a *struct are nil?", "body": "<p>If you're dealing with a small number of fields you should use simple <code>if</code> statements to determine whether they are <code>nil</code> or not.</p>\n\n<pre><code>if args.Stars == nil &amp;&amp; args.Commentary == nil {\n    // ...\n}\n</code></pre>\n\n<p>If you're dealing with more fields than you would like to manually spell out in <code>if</code> statements you could use a simple helper function that takes a variadic number of <code>interface{}</code> arguments.</p>\n\n<pre><code>func AllNil(vv ...interface{}) bool {\n    for _, v := range vv {\n        if v != nil {\n            return false\n        }\n    }\n    return true\n}\n\nif AllNil(args.Stars, args.Commentary, args.Foo, args.Bar, args.Baz) {\n    // ...\n}\n</code></pre>\n\n<p>Or you can use the <code>reflect</code> package to do your bidding.</p>\n\n<pre><code>func NilFields(x interface{}) bool {\n    rv := reflect.ValueOf(args)\n    rv = rv.Elem()\n\n    for i := 0; i &lt; rv.NumField(); i++ {\n        if !rv.Field(i).IsNil() {\n            return false\n        }\n    }\n    return true\n}\n\nif NilFields(args) {\n   // ...\n}\n</code></pre>\n\n<hr>\n\n<p>But keep in mind that there is this: <a href=\"https://stackoverflow.com/questions/13476349/check-for-nil-and-nil-interface-in-go\">Check for nil and nil interface in Go</a></p>\n"}], "owner": {"reputation": 789, "user_id": 9077800, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/StzLv.jpg?s=128&g=1", "display_name": "aquiseb", "link": "https://stackoverflow.com/users/9077800/aquiseb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3754, "favorite_count": 0, "accepted_answer_id": 49469420, "answer_count": 1, "score": 1, "last_activity_date": 1521922328, "creation_date": 1521905546, "last_edit_date": 1521918180, "question_id": 49466522, "link": "https://stackoverflow.com/questions/49466522/how-to-check-if-all-fields-of-a-struct-are-nil", "title": "How to check if all fields of a *struct are nil?", "body": "<p>I'm not quite sure how to address this question, please feel free to edit.</p>\n\n<p>With the first code block below, I am able to check if a all fields of a struct are nil.</p>\n\n<p>In reality however, the values injected in the struct, are received as <strong>args.Review</strong> (see second code block below).</p>\n\n<p><strong>In the second code block, how can I check if all fields from args.Review are nil?</strong></p>\n\n<p><a href=\"https://play.golang.org/p/vxtxIcoy3t7\" rel=\"nofollow noreferrer\">Try it on Golang Playground</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype review struct {\n    Stars      *int32  `json:\"stars\" bson:\"stars,omitempty\" `\n    Commentary *string `json:\"commentary\" bson:\"commentary,omitempty\"`\n}\n\nfunc main() {\n\n    newReview := &amp;review{\n        Stars: nil,\n        // Stars:   func(i int32) *int32 { return &amp;i }(5),\n\n        Commentary: nil,\n        // Commentary: func(i string) *string { return &amp;i }(\"Great\"),\n    }\n\n    if reflect.DeepEqual(review{}, *newReview) {\n        fmt.Println(\"Nothing\")\n    } else {\n        fmt.Println(\"Hello\")\n    }\n\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/70exK_UYd8E\" rel=\"nofollow noreferrer\">Try the second code on Golang Playground</a>\nThis code below gets two errors:</p>\n\n<blockquote>\n  <p>prog.go:32:14: type args is not an expression</p>\n  \n  <p>prog.go:44:27: args.Review is not a type</p>\n</blockquote>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype review struct {\n    Stars      *int32  `json:\"stars\" bson:\"stars,omitempty\" `\n    Commentary *string `json:\"commentary\" bson:\"commentary,omitempty\"`\n}\n\ntype reviewInput struct {\n    Stars      *int32\n    Commentary *string\n}\n\ntype args struct {\n    PostSlug string\n    Review   *reviewInput\n}\n\nfunc main() {\n    f := &amp;args {\n        PostSlug: \"second-post\",\n        Review: &amp;reviewInput{\n            Stars:  func(i int32) *int32 { return &amp;i }(5),\n            Commentary: func(i string) *string { return &amp;i }(\"Great\"),\n        },\n\n    }\n    createReview(args)\n}\n\nfunc createReview(args *struct {\n    PostSlug string\n    Review   *reviewInput\n}) {\n    g := &amp;review{\n        Stars: args.Review.Stars,\n        Commentary: args.Review.Commentary,\n    }\n\n    if reflect.DeepEqual(args.Review{}, nil) {\n        fmt.Println(\"Nothing\")\n    } else {\n        fmt.Println(\"Something\")\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "intellij-idea", "packages", "goland"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1521914281, "post_id": 49465182, "comment_id": 85938467, "body": "Have you set GOPATH? Does it work if you don&#39;t use relative imports (e.g. github.com/user/structs instead of ./structs)?"}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 1, "creation_date": 1521922744, "post_id": 49465182, "comment_id": 85941415, "body": "You need to provide more details as the question is incomplete. Is this IDEA or GoLand? Which version? How is the project structured? Is there a way to reproduce this? Can you open a ticket on the official tracker, <a href=\"https://youtrack.jetbrains.com/issues/Go\" rel=\"nofollow noreferrer\">youtrack.jetbrains.com/issues/Go</a> , with more details?"}, {"owner": {"reputation": 1223, "user_id": 912604, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f33f1893b99937cce85350420d921cd4?s=128&d=identicon&r=PG&f=1", "display_name": "Sviatoslav", "link": "https://stackoverflow.com/users/912604/sviatoslav"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1521968006, "post_id": 49465182, "comment_id": 85950521, "body": "@Peter, GOPATH was global. When I created /src folder, put all code in /src and changed GOPATH on packagetester folder, then idea found all usages."}, {"owner": {"reputation": 1223, "user_id": 912604, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f33f1893b99937cce85350420d921cd4?s=128&d=identicon&r=PG&f=1", "display_name": "Sviatoslav", "link": "https://stackoverflow.com/users/912604/sviatoslav"}, "reply_to_user": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1521968473, "post_id": 49465182, "comment_id": 85950625, "body": "@dlsniper, it works now when I&#39;m using not global GOPATH, but GOPATH for project (or module) and with /src folder. I don&#39;t like this solution (I want to use global GOPATH). Thats why I&#39;ll ask question on youtrack.jetbrains. Thanks for the link!"}], "answers": [{"comments": [{"owner": {"reputation": 1223, "user_id": 912604, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f33f1893b99937cce85350420d921cd4?s=128&d=identicon&r=PG&f=1", "display_name": "Sviatoslav", "link": "https://stackoverflow.com/users/912604/sviatoslav"}, "edited": false, "score": 0, "creation_date": 1521963513, "post_id": 49465513, "comment_id": 85949456, "body": "Thanks a lot! I added in my structure src/ folder and changed GOPATH (on packagetester folder) and it works now."}, {"owner": {"reputation": 1223, "user_id": 912604, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f33f1893b99937cce85350420d921cd4?s=128&d=identicon&r=PG&f=1", "display_name": "Sviatoslav", "link": "https://stackoverflow.com/users/912604/sviatoslav"}, "edited": false, "score": 0, "creation_date": 1521985679, "post_id": 49465513, "comment_id": 85955635, "body": "I updated Goland to the last 2018.1 EAP and it works now with global GOPATH and without src folder."}], "tags": [], "owner": {"reputation": 26, "user_id": 9431756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41c7b406fcfe97b19820f8f69a32cb28?s=128&d=identicon&r=PG&f=1", "display_name": "pyscgo", "link": "https://stackoverflow.com/users/9431756/pyscgo"}, "is_accepted": true, "score": 1, "last_activity_date": 1546437872, "last_edit_date": 1546437872, "creation_date": 1521899881, "answer_id": 49465513, "question_id": 49465182, "link": "https://stackoverflow.com/questions/49465182/no-usages-found-in-module-in-goland/49465513#49465513", "title": "No usages found in module in Goland", "body": "<p>go project directory like this.</p>\n\n<pre><code>projectname:\n  bin/\n  src/\n     structs/\n        custom_types.go\n     main.go\n  pkg/\n</code></pre>\n\n<p>Use go build command will auto create bin/pkg directory.\nsrc directory contains all go source files.</p>\n"}], "owner": {"reputation": 1223, "user_id": 912604, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f33f1893b99937cce85350420d921cd4?s=128&d=identicon&r=PG&f=1", "display_name": "Sviatoslav", "link": "https://stackoverflow.com/users/912604/sviatoslav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 493, "favorite_count": 0, "accepted_answer_id": 49465513, "answer_count": 1, "score": 0, "last_activity_date": 1546437872, "creation_date": 1521897763, "question_id": 49465182, "link": "https://stackoverflow.com/questions/49465182/no-usages-found-in-module-in-goland", "title": "No usages found in module in Goland", "body": "<p>I'm using struct from subpackage and it works. But on find usage of this structure IDEA doesn't see usages. The same situation on rename for the structure - IDEA renames the original structure and doesn't rename it in all places of usage.\nHow can I fix it, because I don't want to put all go files only in one package.</p>\n\n<p><a href=\"https://i.stack.imgur.com/R1xht.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/R1xht.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["go", "data-structures", "linked-list"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 4, "creation_date": 1521895413, "post_id": 49464590, "comment_id": 85932505, "body": "The convention in Go is to name constructor functions <code>New&lt;TypeName&gt;</code>, or sometimes simply <code>New</code>."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1521897332, "post_id": 49464590, "comment_id": 85933060, "body": "You can use <a href=\"https://golang.org/pkg/builtin/#new\" rel=\"nofollow noreferrer\"><code>new(List)</code></a> for simple allocations. For more complex ones you need to define your own &quot;constructor&quot; functions as already pointed out by Tim Cooper. It&#39;s not possible to call methods in your desired fashion, i.e. <code>T.M()</code>, you would have to pass an instance of <code>T</code> to <code>M</code> because <code>M</code> is really just a function with <code>T</code> as its first argument, e.g. <a href=\"https://play.golang.org/p/8o83IC_V717\" rel=\"nofollow noreferrer\">play.golang.org/p/8o83IC_V717</a>."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1521897758, "post_id": 49464590, "comment_id": 85933177, "body": "We can use reflection <code>Set</code> to set the value of struct to zero. Else just like @mkopriva said you can use a pointer receiver to empty the value of struct. Like <a href=\"https://play.golang.org/p/Np9UsthKlOZ\" rel=\"nofollow noreferrer\">play.golang.org/p/Np9UsthKlOZ</a>"}], "answers": [{"comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1521915408, "post_id": 49467802, "comment_id": 85938870, "body": "@JimB, didn&#39;t know that works. The arguments are different in this one though, so I&#39;ll leave it out of the answer."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1521915519, "post_id": 49467802, "comment_id": 85938921, "body": "It\u2019s called a <a href=\"https://golang.org/ref/spec#Method_expressions\" rel=\"nofollow noreferrer\">method expression</a>"}], "tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 2, "last_activity_date": 1521915581, "last_edit_date": 1521915581, "creation_date": 1521913065, "answer_id": 49467802, "question_id": 49464590, "link": "https://stackoverflow.com/questions/49464590/method-that-returns-adress-of-its-struct-in-go-language/49467802#49467802", "title": "Method that returns adress of its struct in Go language", "body": "<p>Yes, of course you can define a method that returns a List value, but since you need a List value to call a method this is kind of awkward:</p>\n\n<pre><code>package main\n\ntype List struct{}\n\nfunc (List) New1() *List {\n    return &amp;List{}\n}\n\nfunc (*List) New2() *List {\n    return &amp;List{}\n}\n\nfunc main() {\n    _ = List{}.New1()\n    _ = (&amp;List{}).New2()\n    _ = (*List)(nil).New2()\n}\n</code></pre>\n\n<p>I honestly don't see how this is better than a NewList function, which is idiomatic in Go:</p>\n\n<pre><code>func NewList() *List {\n    return &amp;List{}\n}\n</code></pre>\n\n<p>If your package is called list, name the function New instead, so it is called as <code>list.New()</code>.</p>\n\n<p>The arguments and bodies would be the same in all cases. They only differ in how they are called, and the package function is easiest to use. (See the link in JimB's comment for one more variant that is slightly different.)</p>\n\n<p>It seems you have not yet read <a href=\"https://golang.org/doc/effective_go.html#package-names\" rel=\"nofollow noreferrer\">Effective Go</a>, which suggests most of the above.</p>\n\n<blockquote>\n  <p>The function to make new instances of ring.Ring\u2014which is the definition of a constructor in Go\u2014would normally be called NewRing, but since Ring is the only type exported by the package, and since the package is called ring, it's called just New, which clients of the package see as ring.New.</p>\n</blockquote>\n"}], "owner": {"reputation": 111, "user_id": 4916437, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10152997362828978/picture?type=large", "display_name": "bullbo", "link": "https://stackoverflow.com/users/4916437/bullbo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 1, "accepted_answer_id": 49467802, "answer_count": 1, "score": -1, "last_activity_date": 1521915581, "creation_date": 1521893855, "last_edit_date": 1521913238, "question_id": 49464590, "link": "https://stackoverflow.com/questions/49464590/method-that-returns-adress-of-its-struct-in-go-language", "title": "Method that returns adress of its struct in Go language", "body": "<p>In my attempt to create a linked list data structure I've declared two structs. </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype listElement struct {\n    data int         \n    next *listElement \n}\n\ntype List struct {\n    first *listElement \n    last  *listElement \n    len   int          \n}\n</code></pre>\n\n<p>I want to create a method that returns an empty list. So far I've only been able to create the function </p>\n\n<pre><code>func new() *List {\n    return &amp;List{}\n}\n</code></pre>\n\n<p>This is the same result I've seen in multiple data structure repositories. Is it possible to create a method <code>List.new()</code> that returns a new empty list? </p>\n"}, {"tags": ["mongodb", "go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1521886298, "post_id": 49463308, "comment_id": 85929760, "body": "Please don&#39;t store passwords in plaintext. Use bcrypt, for instance, to hash them."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9092006"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1521886360, "post_id": 49463308, "comment_id": 85929779, "body": "@peter can you please tell me in which part i do mistake in code"}], "answers": [{"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 1, "last_activity_date": 1521886671, "creation_date": 1521886671, "answer_id": 49463541, "question_id": 49463308, "link": "https://stackoverflow.com/questions/49463308/how-to-insert-the-user-info-in-mongodb-using-golang/49463541#49463541", "title": "How to insert the user info in mongodb using golang?", "body": "<p><a href=\"https://golang.org/pkg/net/http/#Request\" rel=\"nofollow noreferrer\">The docs</a> clearly state (emphasis mine):</p>\n\n<blockquote>\n  <p>This field [r.Form] is only available <em>after</em> ParseForm is called.</p>\n</blockquote>\n\n<p>You are accessing it before calling ParseForm.</p>\n\n<p>Also, r.Form is of type url.Values, so use r.Form.Get() to read the first value of a field.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9092006"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 849, "favorite_count": 0, "accepted_answer_id": 49463541, "answer_count": 1, "score": 0, "last_activity_date": 1521886671, "creation_date": 1521884935, "question_id": 49463308, "link": "https://stackoverflow.com/questions/49463308/how-to-insert-the-user-info-in-mongodb-using-golang", "title": "How to insert the user info in mongodb using golang?", "body": "<p>I am new on GOlang. So, I am inserting the data from an html page to <strong>mongodb</strong> database. But there is an error in the code. The code is below:-</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"gopkg.in/mgo.v2\"\n  \"gopkg.in/mgo.v2/bson\"\n  \"html/template\"\n  \"log\"\n  \"net/http\"\n  \"strings\"\n)\ntype USER struct {\n    Username string      `bson:\"Username\" json:\"Username,omitempty\"`\n    Password string      `bson:\"Password\" json:\"Password,omitempty\"`\n}\nfunc sayhelloName(w http.ResponseWriter, r *http.Request) {\n   r.ParseForm()\n   fmt.Println(r.Form)\n   fmt.Println(r.Form[\"url_long\"])\n   for k, v := range r.Form {\n      fmt.Println(\"key:\", k)\n      fmt.Println(\"val:\", strings.Join(v, \"\"))\n    }\n    fmt.Fprintf(w, \"Hello astaxie!\")\n}\nfunc login(w http.ResponseWriter, r *http.Request) {\n   fmt.Println(\"method:\", r.Method)\n   if r.Method == \"GET\" {\n       t, _ := template.ParseFiles(\"index.html\")\n       t.Execute(w, nil)\n   } else {\n         //connection with mongodb\n        session, err := mgo.Dial(\"mongodb://127.0.0.1:27017/so\")\n        if err != nil {\n        panic(err)\n    }\n    defer session.Close()\n    session.SetMode(mgo.Monotonic, true)\n    c := session.DB(\"so\").C(\"insrt\")\n    doc := USER{\n        Username: r.Form[\"username\"][0],\n        Password: r.Form[\"password\"][0],\n    }\n    err = c.Insert(doc)\n    if err != nil {\n        panic(err)\n    }\n    r.ParseForm()\n    fmt.Printf(\"%T\\n\", r.Form[\"username\"])\n    fmt.Println(\"---------------------------------------------\")\n    fmt.Println(\"username:\", r.Form[\"username\"][0])//output:- username: user_name\n    fmt.Println(\"password:\", r.Form[\"password\"][0])//password:- password: user_password\n   }\n}\nfunc main() {\n   http.HandleFunc(\"/\", sayhelloName)\n   http.HandleFunc(\"/login\", login)\n   err := http.ListenAndServe(\":9090\", nil)\n   if err != nil {\n      log.Fatal(\"ListenAndServe: \", err)\n   }\n}\n</code></pre>\n\n<p>index.html</p>\n\n<pre><code> &lt;html&gt;\n &lt;head&gt;\n &lt;title&gt;&lt;/title&gt;\n &lt;/head&gt;\n &lt;body&gt;\n    &lt;form action=\"/login\" method=\"post\"&gt;\n        Username:&lt;input type=\"text\" name=\"username\"&gt;\n        Password:&lt;input type=\"password\" name=\"password\"&gt;\n        &lt;input type=\"submit\" value=\"Login\"&gt;\n    &lt;/form&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>From the above code the user will entered the data in the html form by accessing url <code>localhost:9090/login</code> when user click on submit button then  the data will shown in the terminal I comment the mongodb code but when i want to save that data then it gives me error.</p>\n\n<blockquote>\n  <p><strong>error</strong>:-2018/03/24 14:48:28 http: panic serving [::1]:44410: \n      runtime \n      error: index out of range\n      goroutine 5 [running]:\n      net/http.(*conn).serve.func1(0xc420094c80)\n      /usr/local/go/src/net/http/server.go:1726 +0xd0\n      panic(0x78aa20, 0xa03de0)\n      /usr/local/go/src/runtime/panic.go:505 +0x229\n      main.login(0x846c80, 0xc42015c0e0, 0xc42018a000)\n      /home/iron/go/src/go-training/pagesweb/main.go:48 +0x767\n      net/http.HandlerFunc.ServeHTTP(0x8147d0, 0x846c80, 0xc42015c0e0, \n      0xc42018a000)\n      /usr/local/go/src/net/http/server.go:1947 +0x44\n      net/http.(*ServeMux).ServeHTTP(0xa132c0, 0x846c80, 0xc42015c0e0, \n      0xc42018a000)\n      /usr/local/go/src/net/http/server.go:2337 +0x130\n      net/http.serverHandler.ServeHTTP(0xc42008b2b0, 0x846c80, 0xc42015c0e0, \n      0xc42018a000)\n      /usr/local/go/src/net/http/server.go:2694 +0xbc\n      net/http.(*conn).serve(0xc420094c80, 0x847080, 0xc420146040)\n      /usr/local/go/src/net/http/server.go:1830 +0x651\n      created by net/http.(*Server).Serve\n      /usr/local/go/src/net/http/server.go:2795 +0x27b</p>\n</blockquote>\n\n<p>Anybody can help me to solve my problem. I just want to save the data. in document of <code>mongodb</code>.</p>\n"}, {"tags": ["go", "dependency-injection", "inversion-of-control"], "comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1521882536, "post_id": 49462900, "comment_id": 85928900, "body": "Create a receiver of StructDependingOnInterface  type on  Foo implementing interface"}, {"owner": {"reputation": 614, "user_id": 5407910, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2kff4.png?s=128&g=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/5407910/greg"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1521883977, "post_id": 49462900, "comment_id": 85929233, "body": "I don&#39;t really know what you mean."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1521884343, "post_id": 49462900, "comment_id": 85929315, "body": "Its like you are using <code>implementation</code> struct for <code>Foo()</code>. Also you cannot call Foo on nil Pointer as in you did for <code>s.bar.Foo()</code> where is s.bar is nil cannot be deference to call <code>Foo()</code>. As the error <a href=\"https://play.golang.org/p/Pt1lXWB7cqt\" rel=\"nofollow noreferrer\">shows</a>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1521884897, "post_id": 49462900, "comment_id": 85929450, "body": "@Greg You need to export <code>bar</code> I believe, i.e. changing it to <code>Bar</code>... see here: <a href=\"https://github.com/facebookgo/inject/blob/643b7206b487b04fbea325cf6e8d06a66f8db772/inject.go#L239-L240\" rel=\"nofollow noreferrer\">github.com/facebookgo/inject/blob/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 614, "user_id": 5407910, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2kff4.png?s=128&g=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/5407910/greg"}, "edited": false, "score": 0, "creation_date": 1521890545, "post_id": 49463362, "comment_id": 85930994, "body": "Thanks it works ! Can we make it work if <code>Implementation</code> also has a injectable dependency ?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 614, "user_id": 5407910, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2kff4.png?s=128&g=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/5407910/greg"}, "edited": false, "score": 0, "creation_date": 1521890985, "post_id": 49463362, "comment_id": 85931143, "body": "I believe so, as long as you export the field and pass an instance of the dependency to <code>Provide</code>."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 614, "user_id": 5407910, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2kff4.png?s=128&g=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/5407910/greg"}, "edited": false, "score": 0, "creation_date": 1521891379, "post_id": 49463362, "comment_id": 85931251, "body": "@Greg also note that if the dependency is a concrete type, as opposed to an interface type, you don&#39;t have to pass an instance of it to <code>Provide</code> since the library knows what type to instantiate, which is not the case if it&#39;s an interface. If you look at the example in their documentation, they don&#39;t pass <code>NameAPI</code> and <code>PlanetAPI</code> to <code>Provide</code> as they can infer the types from the fields of <code>HomePlanetRenderApp</code>."}, {"owner": {"reputation": 614, "user_id": 5407910, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2kff4.png?s=128&g=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/5407910/greg"}, "edited": false, "score": 0, "creation_date": 1521897279, "post_id": 49463362, "comment_id": 85933038, "body": "Why is it that inconvenient ? In a clean architecture with 3 layers, controllers, business logic and data access, I have to instantiate the struct of the 2 first layers. I come from a .NET world where I just need to do AddTransient&lt;Interface, Implementation&gt;() and an instance of Implementation will be injected everywhere I use Interface in a constructor. Doesn&#39;t Golang allow something like that ?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 614, "user_id": 5407910, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2kff4.png?s=128&g=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/5407910/greg"}, "edited": false, "score": 1, "creation_date": 1521899447, "post_id": 49463362, "comment_id": 85933623, "body": "@Greg I don&#39;t know .NET or any other language/environment/framework that might have a DI comparable to what you have in mind and so I cannot say whether it would, or would not, be possible to implement such a DI in Go so as to alleviate the perceived inconvenience. But, if you&#39;re interested, take a look at <code>go generate</code>, with that you should be able generate the code that&#39;s causing you the inconvenience."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 3, "last_activity_date": 1521885783, "last_edit_date": 1521885783, "creation_date": 1521885295, "answer_id": 49463362, "question_id": 49462900, "link": "https://stackoverflow.com/questions/49462900/dependency-injection-with-interface-in-go/49463362#49463362", "title": "Dependency injection with interface in go", "body": "<p><a href=\"https://godoc.org/github.com/facebookgo/inject\" rel=\"nofollow noreferrer\">facebookgo/inject</a> should be able to handle interfaces, look at the example in the link and how they use <a href=\"https://golang.org/pkg/net/http/#RoundTripper\" rel=\"nofollow noreferrer\"><code>http.RoundTripper</code></a> and <code>http.DefaultTransport</code>.</p>\n\n<p>First you need to export <code>bar</code>, i.e. changing it to <code>Bar</code>. Then you also need to pass <code>s</code> to <code>Provide</code> for <code>g.Populate</code> to then be able to set <code>Bar</code>.</p>\n\n<pre><code>type StructDependingOnInterface struct {\n    Bar MyInterface `inject:\"\"`\n}\n\nfunc main() {\n    var g inject.Graph\n\n    s := &amp;StructDependingOnInterface{}\n    err := g.Provide(\n        &amp;inject.Object{Value: s},\n        &amp;inject.Object{Value: &amp;Implementation{}},\n    )\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    if err := g.Populate(); err != nil {\n         log.Fatal(err)\n    }\n\n    s.bar.Foo()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 10472883, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-grRc3vJ9PiI/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV6-nExlrOn-PuZEkVwLLNiIJOXgw/mo/photo.jpg?sz=128", "display_name": "John Deng", "link": "https://stackoverflow.com/users/10472883/john-deng"}, "is_accepted": false, "score": 0, "last_activity_date": 1539492163, "last_edit_date": 1539492163, "creation_date": 1539000109, "answer_id": 52701831, "question_id": 49462900, "link": "https://stackoverflow.com/questions/49462900/dependency-injection-with-interface-in-go/52701831#52701831", "title": "Dependency injection with interface in go", "body": "<h3><a href=\"https://github.com/hidevopsio/hiboot\" rel=\"nofollow noreferrer\">hiboot</a> is an cli/web framework that support dependency injection written in Go.</h3>\n\n<p><code>Code:</code> <a href=\"https://github.com/hidevopsio/hiboot\" rel=\"nofollow noreferrer\">https://github.com/hidevopsio/hiboot</a></p>\n\nHiboot Overview\n\n<ul>\n<li>Web MVC (Model-View-Controller).</li>\n<li>Auto Configuration, pre-create instance with properties configs for dependency injection.</li>\n<li>Dependency injection with struct tag name <code>inject:\"\"</code> or Constructor func.</li>\n</ul>\n\nSample Code:\n\n<pre><code>package main\n\nimport (\n    \"github.com/hidevopsio/hiboot/pkg/app/web\"\n    \"github.com/hidevopsio/hiboot/pkg/model\"\n    \"github.com/hidevopsio/hiboot/pkg/starter/jwt\"\n    \"time\"\n)\n\n// This example shows that token is injected through constructor,\n// once you imported \"github.com/hidevopsio/hiboot/pkg/starter/jwt\",\n// token jwt.Token will be injectable.\nfunc main() {\n    // create new web application and run it\n    web.NewApplication().Run()\n}\n\n// PATH: /login\ntype loginController struct {\n    web.Controller\n\n    token jwt.Token\n}\n\ntype userRequest struct {\n    // embedded field model.RequestBody mark that userRequest is request body\n    model.RequestBody\n    Username string `json:\"username\" validate:\"required\"`\n    Password string `json:\"password\" validate:\"required\"`\n}\n\nfunc init() {\n    // Register Rest Controller through constructor newLoginController\n    web.RestController(newLoginController)\n}\n\n// inject token through the argument token jwt.Token on constructor newLoginController, you may wonder why is token come from\n// well, it provided by hiboot starter jwt, see above hiboot link for more details\nfunc newLoginController(token jwt.Token) *loginController {\n    return &amp;loginController{\n        token: token,\n    }\n}\n\n// Post /\n// The first word of method is the http method POST, the rest is the context mapping\nfunc (c *loginController) Post(request *userRequest) (response model.Response, err error) {\n    jwtToken, _ := c.token.Generate(jwt.Map{\n        \"username\": request.Username,\n        \"password\": request.Password,\n    }, 30, time.Minute)\n\n    response = new(model.BaseResponse)\n    response.SetData(jwtToken)\n\n    return\n}\n</code></pre>\n"}], "owner": {"reputation": 614, "user_id": 5407910, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2kff4.png?s=128&g=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/5407910/greg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1985, "favorite_count": 2, "accepted_answer_id": 49463362, "answer_count": 2, "score": 1, "last_activity_date": 1539492163, "creation_date": 1521881470, "question_id": 49462900, "link": "https://stackoverflow.com/questions/49462900/dependency-injection-with-interface-in-go", "title": "Dependency injection with interface in go", "body": "<p>I have a struct <code>StructDependingOnInterface</code> which depends on <code>MyInterface</code> interface. I'd like the struct <code>Implementation</code> to be injected into <code>bar</code> when <code>StructDependingOnInterface</code> is instantiated.</p>\n\n<p>I have tried doing this with facebookgo/inject library, but it seems like it doesn't work with interfaces. <code>s.bar</code> is always nil.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n\n    \"github.com/facebookgo/inject\"\n)\n\ntype MyInterface interface {\n    Foo()\n}\n\ntype Implementation struct{}\n\nfunc (imp *Implementation) Foo() {\n    fmt.Println(\"Hello\")\n}\n\ntype StructDependingOnInterface struct {\n    bar MyInterface `inject:\"\"`\n}\n\nfunc main() {\n    var g inject.Graph\n\n    err := g.Provide(\n        &amp;inject.Object{Value: &amp;Implementation{}},\n    )\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    g.Populate()\n\n    s := &amp;StructDependingOnInterface{}\n    s.bar.Foo()\n}\n</code></pre>\n\n<p>Does the language go allows what I'm trying to do ?</p>\n\n<p>Is there an alternative of facebookgo/inject that would fits my need ?</p>\n"}, {"tags": ["go", "warnings"], "answers": [{"comments": [{"owner": {"reputation": 1011, "user_id": 2969402, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a971b3c4d070d8af92b98952b702c9bb?s=128&d=identicon&r=PG&f=1", "display_name": "user2969402", "link": "https://stackoverflow.com/users/2969402/user2969402"}, "edited": false, "score": 0, "creation_date": 1521868280, "post_id": 49461373, "comment_id": 85925799, "body": "Thanks, that fixed it!"}, {"owner": {"reputation": 5381, "user_id": 3958148, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1d13082f7803e52dd98b2808509976c2?s=128&d=identicon&r=PG", "display_name": "Sung Cho", "link": "https://stackoverflow.com/users/3958148/sung-cho"}, "edited": false, "score": 0, "creation_date": 1576554938, "post_id": 49461373, "comment_id": 104928343, "body": "Thanks for that. Could you also point me towards official doc that states it?"}], "tags": [], "owner": {"reputation": 319196, "user_id": 34211, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/gfFlI.jpg?s=128&g=1", "display_name": "Andrew Hare", "link": "https://stackoverflow.com/users/34211/andrew-hare"}, "is_accepted": true, "score": 20, "last_activity_date": 1521867279, "creation_date": 1521867279, "answer_id": 49461373, "question_id": 49461354, "link": "https://stackoverflow.com/questions/49461354/go-vet-composite-literal-uses-unkeyed-fields-with-embedded-types/49461373#49461373", "title": "Go vet: &quot;composite literal uses unkeyed fields&quot; with embedded types", "body": "<p>Try this:</p>\n\n<pre><code>writer = MyWriter{Writer: io.Stdout}\n</code></pre>\n\n<p>Embedded structs have an implicit key of the type name itself without the package prefix (e.g. in this case, <code>Writer</code>).</p>\n"}], "owner": {"reputation": 1011, "user_id": 2969402, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a971b3c4d070d8af92b98952b702c9bb?s=128&d=identicon&r=PG&f=1", "display_name": "user2969402", "link": "https://stackoverflow.com/users/2969402/user2969402"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4132, "favorite_count": 3, "accepted_answer_id": 49461373, "answer_count": 1, "score": 6, "last_activity_date": 1521867279, "creation_date": 1521867103, "question_id": 49461354, "link": "https://stackoverflow.com/questions/49461354/go-vet-composite-literal-uses-unkeyed-fields-with-embedded-types", "title": "Go vet: &quot;composite literal uses unkeyed fields&quot; with embedded types", "body": "<p>I have a simple structure:</p>\n\n<pre><code>type MyWriter struct {\n    io.Writer\n}\n</code></pre>\n\n<p>Which I then use in the following way:</p>\n\n<pre><code>writer = MyWriter{io.Stdout}\n</code></pre>\n\n<p>When running <code>go vet</code> this gives me a <code>composite literal uses unkeyed fields</code>.</p>\n\n<p>In order to fix this would I have to turn io.Reader into a field in the <code>MyWriter</code> structure by adding a key?</p>\n\n<pre><code>type MyWriter struct {\n    w io.Writer\n}\n</code></pre>\n\n<p>Is there any other way around this? \nThe only other answer I found on <a href=\"https://stackoverflow.com/questions/36273920/disable-go-vet-checks-for-composite-literal-uses-unkeyed-fields\">here</a> suggests to disable the check altogether but I would rather not do that and find a proper solution.</p>\n"}, {"tags": ["macos", "go", "webcam"], "comments": [{"owner": {"reputation": 3335, "user_id": 3824876, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rFDWl.png?s=128&g=1", "display_name": "vishnu narayanan", "link": "https://stackoverflow.com/users/3824876/vishnu-narayanan"}, "edited": false, "score": 0, "creation_date": 1521871039, "post_id": 49461222, "comment_id": 85926277, "body": "Have a look at this question <a href=\"https://apple.stackexchange.com/questions/16908/mac-webcam-get-the-device\" title=\"mac webcam get the device\">apple.stackexchange.com/questions/16908/&hellip;</a>"}, {"owner": {"reputation": 193, "user_id": 6270020, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/587c9d23bbd5817ce9ea9453fc1d7063?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/6270020/sam"}, "reply_to_user": {"reputation": 3335, "user_id": 3824876, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rFDWl.png?s=128&g=1", "display_name": "vishnu narayanan", "link": "https://stackoverflow.com/users/3824876/vishnu-narayanan"}, "edited": false, "score": 0, "creation_date": 1521872580, "post_id": 49461222, "comment_id": 85926569, "body": "I saw that question, so there is no equivalent to /dev/video0, so is there any other way to access MacOS webcam ?"}], "answers": [{"tags": [], "owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "is_accepted": true, "score": 2, "last_activity_date": 1521873004, "creation_date": 1521873004, "answer_id": 49461952, "question_id": 49461222, "link": "https://stackoverflow.com/questions/49461222/what-is-a-correct-path-for-macbook-webcam/49461952#49461952", "title": "what is a correct path for macbook webcam", "body": "<p>You can use OpenCV bindings and get frame from camera.</p>\n\n<p>Have a look at <a href=\"https://godoc.org/github.com/go-opencv/go-opencv/opencv#NewCameraCapture\" rel=\"nofollow noreferrer\">godoc for go-opencv</a></p>\n\n<p>A short example:</p>\n\n<pre><code>index := 0 // example\ncamera := opencv.NewCameraCapture(index)\n\nif camera.GrabFrame() {\n    frame := camera.RetrieveFrame(1)\n    img := frame.ToImage()\n}\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 6270020, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/587c9d23bbd5817ce9ea9453fc1d7063?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/6270020/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1257, "favorite_count": 0, "accepted_answer_id": 49461952, "answer_count": 1, "score": 0, "last_activity_date": 1521873004, "creation_date": 1521865696, "last_edit_date": 1521868319, "question_id": 49461222, "link": "https://stackoverflow.com/questions/49461222/what-is-a-correct-path-for-macbook-webcam", "title": "what is a correct path for macbook webcam", "body": "<p>I am trying to get a stream from MacBook High Sierra webcam, mac does not have <strong>/dev/video0</strong><br>\nis there any way to access MacOS webcam ?<br>\nI am programming in golang and I am using <strong>golang.org/x/sys/unix</strong></p>\n"}, {"tags": ["android", "go", "service", "gomobile"], "answers": [{"tags": [], "owner": {"reputation": 86, "user_id": 10816819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf8b8a3b4531931509c22f6ca5d756ca?s=128&d=identicon&r=PG", "display_name": "atomirex", "link": "https://stackoverflow.com/users/10816819/atomirex"}, "is_accepted": false, "score": 1, "last_activity_date": 1545410880, "creation_date": 1545410880, "answer_id": 53888265, "question_id": 49461141, "link": "https://stackoverflow.com/questions/49461141/how-to-run-a-simple-go-script-as-an-android-service/53888265#53888265", "title": "How to run a simple Go script as an Android service?", "body": "<p>Firstly, there's the common observation that you really shouldn't be doing what you ask. The correct way is to use AlarmManager to send a broadcast that wakes up the service for a single request. This way the system can better optimize power consumption. For doing this have your go code just process a single request and call it from the Java side whenever a broadcast is made.</p>\n\n<p>However, to actually run the service persistently you will need to be starting a \"foreground service\" as described <a href=\"https://developer.android.com/guide/components/services\" rel=\"nofollow noreferrer\">https://developer.android.com/guide/components/services</a>. This in turn requires a Notification that is displayed whenever your service is running. In this case you may find the device powering itself off too, in which case you will need to look into acquiring a <a href=\"https://developer.android.com/reference/android/os/PowerManager.WakeLock\" rel=\"nofollow noreferrer\">https://developer.android.com/reference/android/os/PowerManager.WakeLock</a> . Doing this kind of thing can massively reduce battery life unless you are very careful.</p>\n\n<p>I have found launching the go code in this way is sufficient for things like long running web servers on Android itself, including using websockets.</p>\n"}], "owner": {"reputation": 39, "user_id": 9542986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7c1efd3ba3ae73257e84d39bbab1ba9?s=128&d=identicon&r=PG&f=1", "display_name": "tarmek", "link": "https://stackoverflow.com/users/9542986/tarmek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1293, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545410880, "creation_date": 1521864793, "last_edit_date": 1521982578, "question_id": 49461141, "link": "https://stackoverflow.com/questions/49461141/how-to-run-a-simple-go-script-as-an-android-service", "title": "How to run a simple Go script as an Android service?", "body": "<p>I have the following Go script (<strong>testapp.go</strong>) that I would like to keep running as a background service:</p>\n\n<pre><code>package main\n\nimport(\n    \"net/http\"\n    \"time\"\n    \"log\"\n    \"golang.org/x/mobile/app\"\n)\n\nfunc main() {\n    app.Main(func(a app.App) {\n        for {\n            req, err := http.NewRequest( \"GET\", \"http://0.0.0.0:88/fetch_news\", strings.NewReader(\"topic.title\") )\n            if err != nil {\n                log.Print(err)\n            }\n            cli := &amp;http.Client{}\n            res, err := cli.Do(req)\n            if err != nil {\n                log.Print(err)\n            } else {\n                defer res.Body.Close()\n                body, _ := ioutil.ReadAll(res.Body)\n                returnStr := string(body)\n                // Do something with returnStr\n            }\n            time.Sleep(8 * time.Second)\n        }\n    })\n}\n</code></pre>\n\n<p>My <strong>GoNativeActivity.java</strong> looks like this:</p>\n\n<pre><code>package org.golang.app;\nimport android.app.Activity;\nimport android.app.NativeActivity;\nimport android.content.Context;\nimport android.content.pm.ActivityInfo;\nimport android.content.pm.PackageManager;\nimport android.content.Intent;\nimport android.os.Bundle;\nimport android.util.Log;\nimport android.view.KeyCharacterMap;\n\npublic class GoNativeActivity extends NativeActivity {\n    private static GoNativeActivity goNativeActivity;\n    public GoNativeActivity() {\n        super();\n        goNativeActivity = this;\n    }\n    String getTmpdir() {\n        return getCacheDir().getAbsolutePath();\n    }\n    int getRune(int deviceId, int keyCode, int metaState) {\n        try {\n            int rune = KeyCharacterMap.load(deviceId).get(keyCode, metaState);\n            if (rune == 0) {\n                return -1;\n            }\n            return rune;\n        } catch (KeyCharacterMap.UnavailableException e) {\n            return -1;\n        } catch (Exception e) {\n            Log.e(\"Go\", \"exception reading KeyCharacterMap\", e);\n            return -1;\n        }\n    }\n    private void load() {\n        // Interestingly, NativeActivity uses a different method\n        // to find native code to execute, avoiding\n        // System.loadLibrary. The result is Java methods\n        // implemented in C with JNIEXPORT (and JNI_OnLoad) are not\n        // available unless an explicit call to System.loadLibrary\n        // is done. So we do it here, borrowing the name of the\n        // library from the same AndroidManifest.xml metadata used\n        // by NativeActivity.\n        try {\n            ActivityInfo ai = getPackageManager().getActivityInfo(\n                    getIntent().getComponent(), PackageManager.GET_META_DATA);\n            if (ai.metaData == null) {\n                Log.e(\"Go\", \"loadLibrary: no manifest metadata found\");\n                return;\n            }\n            String libName = ai.metaData.getString(\"android.app.lib_name\");\n            System.loadLibrary(libName);\n        } catch (Exception e) {\n            Log.e(\"Go\", \"loadLibrary failed\", e);\n        }\n    }\n    @Override\n    public void onCreate(Bundle savedInstanceState) {\n        load();\n        super.onCreate(savedInstanceState);\n        Intent intent = new Intent(this, org.golang.app.GoNativeService.class);\n        startService(intent);\n    }\n}\n</code></pre>\n\n<p>My <strong>GoNativeService.java</strong> looks like this:</p>\n\n<pre><code>package org.golang.app;\nimport android.app.PendingIntent;\nimport android.app.Service;\nimport android.content.Context;\nimport android.content.Intent;\nimport android.widget.Toast;\n\npublic class GoNativeService extends IntentService {\n    @Override\n    public void onStart(Intent intent, int startId) {\n        Toast.makeText(this,\"Service started. onStart()\", Toast.LENGTH_SHORT).show();\n        handleCommand(intent);\n    }\n    @Override\n    public int onStartCommand(Intent intent, int flags, int startId) {\n        Toast.makeText(this,\"Service started. onStartCommand()\", Toast.LENGTH_SHORT).show();\n        handleCommand(intent);\n        // We want this service to continue running until it is explicitly\n        // stopped, so return sticky.\n        return START_STICKY;\n    }\n}\n</code></pre>\n\n<p>My <strong>AndroidManifest.xml</strong> file looks like this:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;manifest\n    xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    package=\"org.golang.todo.testapp\"\n    android:versionCode=\"1\"\n    android:versionName=\"1.0\"&gt;\n\n    &lt;uses-permission android:name=\"android.permission.INTERNET\" /&gt;\n\n    &lt;application android:label=\"Testapp\" android:debuggable=\"true\"&gt;\n        &lt;activity android:name=\"org.golang.app.GoNativeActivity\"\n            android:label=\"Testactivity\"\n            android:configChanges=\"orientation|keyboardHidden\"&gt;\n            &lt;meta-data android:name=\"android.app.lib_name\" android:value=\"testapp\" /&gt;\n            &lt;intent-filter&gt;\n                &lt;action android:name=\"android.intent.action.MAIN\" /&gt;\n                &lt;category android:name=\"android.intent.category.LAUNCHER\" /&gt;\n            &lt;/intent-filter&gt;\n        &lt;/activity&gt;\n\n        &lt;service \n            android:name=\"org.golang.app.GoNativeService\" \n            android:enabled=\"true\"\n            android:exported=\"true\" /&gt;\n    &lt;/application&gt;\n\n&lt;/manifest&gt;\n</code></pre>\n\n<p>This is my work environment:</p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"/root/go/bin\"\nGOCACHE=\"/root/.cache/go-build\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/root/go\"\nGOROOT=\"/usr/lib/go-1.10\"\nGOTMPDIR=\"\"\nGOTOOLDIR=\"/usr/lib/go-1.10/pkg/tool/linux_amd64\"\n</code></pre>\n\n<p>This is what my <strong>$GOPATH/src/testapp</strong> directory looks like:</p>\n\n<pre><code>testapp/\n    assets/\n        icon.png\n    AndroidManifest.xml\n    testapp.go\n</code></pre>\n\n<p>This is what my <strong>$GOPATH/src/golang.org/x/mobile/app</strong> directory looks like:</p>\n\n<pre><code>app/\n    android.c\n    app_test.go\n    darwin_armx.go\n    GoNativeActivity.java\n    GoNativeService.java\n    internal/\n    x11.go\n    android.go\n    darwin_amd64.go\n    darwin_armx.m\n    shiny.go\n    app.go\n    darwin_amd64.m\n    doc.go\n    x11.c\n</code></pre>\n\n<p>How can I run my Go script as a background service on Android, so that when the app is exited (MainActivity closes), the background service will continue to fetch news messages?</p>\n\n<p>Note: I am monitoring the requests at my webserver on port 88. I can run the script fine while <code>GoNativeActivity</code> is active, but I would like to know how to build a native app that starts a background service.</p>\n\n<p>Any answers or attempts to point me in the right direction would be appreciated!</p>\n"}, {"tags": ["go", "reflection"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 1, "creation_date": 1521856962, "post_id": 49460380, "comment_id": 85923943, "body": "Did you mean <code>v.Type().Field(i)</code>?"}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1521857538, "post_id": 49460380, "comment_id": 85924064, "body": "Ahhh darn, good catch. The panic is no more :)"}], "answers": [{"tags": [], "owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "is_accepted": true, "score": 3, "last_activity_date": 1521943059, "last_edit_date": 1521943059, "creation_date": 1521942285, "answer_id": 49471736, "question_id": 49460380, "link": "https://stackoverflow.com/questions/49460380/recursive-struct-reflection-error-panic-reflect-field-of-non-struct-type/49471736#49471736", "title": "Recursive struct reflection error: panic: reflect: Field of non-struct type", "body": "<p>After working all day on this, this was the solution I finally came up with to walk a struct recursively and modify the value of all string values that have a specific tag.</p>\n\n<p>The <code>Sanitize</code> function only allows pointer to structs, but the nested structs can be either pointers or values; it doesn't matter. </p>\n\n<p>The example in my question will work with the function below, and it passes all my tests.</p>\n\n<pre><code>func Sanitize(s interface{}) error {\n    if s == nil {\n        return nil\n    }\n\n    val := reflect.ValueOf(s)\n\n    // If it's an interface or a pointer, unwrap it.\n    if val.Kind() == reflect.Ptr &amp;&amp; val.Elem().Kind() == reflect.Struct {\n        val = val.Elem()\n    } else {\n        return &amp;InvalidStructError{message: \"s must be a struct\"}\n    }\n\n    valNumFields := val.NumField()\n\n    for i := 0; i &lt; valNumFields; i++ {\n        field := val.Field(i)\n        fieldKind := field.Kind()\n\n        // Check if it's a pointer to a struct.\n        if fieldKind == reflect.Ptr &amp;&amp; field.Elem().Kind() == reflect.Struct {\n            if field.CanInterface() {\n                // Recurse using an interface of the field.\n                err := Sanitize(field.Interface())\n                if err != nil {\n                    return err\n                }\n            }\n\n            // Move onto the next field.\n            continue\n        }\n\n        // Check if it's a struct value.\n        if fieldKind == reflect.Struct {\n            if field.CanAddr() &amp;&amp; field.Addr().CanInterface() {\n                // Recurse using an interface of the pointer value of the field.\n                err := Sanitize(field.Addr().Interface())\n                if err != nil {\n                    return err\n                }\n            }\n\n            // Move onto the next field.\n            continue\n        }\n\n        // Check if it's a string or a pointer to a string.\n        if fieldKind == reflect.String || (fieldKind == reflect.Ptr &amp;&amp; field.Elem().Kind() == reflect.String) {\n            typeField := val.Type().Field(i)\n\n            // Get the field tag value.\n            tag := typeField.Tag.Get(\"sanitize\")\n\n            // Skip if tag is not defined or ignored.\n            if tag == \"\" || tag == \"-\" {\n                continue\n            }\n\n            // Check if the tag is allowed.\n            if tag != \"true\" &amp;&amp; tag != \"false\" {\n                return &amp;InvalidTagError{message: \"tag must be either 'true' or 'false'.\"}\n            }\n\n            // Parse it to a bool.\n            shouldSanitize, err := strconv.ParseBool(tag)\n            if err != nil {\n                return err\n            } else if !shouldSanitize {\n                continue\n            }\n\n            // Set the string value to the sanitized string if it's allowed.\n            // It should always be allowed at this point.\n            if field.CanSet() {\n                field.SetString(policy.Sanitize(field.String()))\n            }\n\n            continue\n        }\n    }\n\n    return nil\n}\n</code></pre>\n"}], "owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1234, "favorite_count": 1, "accepted_answer_id": 49471736, "answer_count": 1, "score": 1, "last_activity_date": 1521943059, "creation_date": 1521855690, "question_id": 49460380, "link": "https://stackoverflow.com/questions/49460380/recursive-struct-reflection-error-panic-reflect-field-of-non-struct-type", "title": "Recursive struct reflection error: panic: reflect: Field of non-struct type", "body": "<p>Trying to make a function that walks a struct recursively, and modifies any fields that are strings, based on on a certain tag.</p>\n\n<p>Reflection is very tedious to work with. First time using it and having some troubles.</p>\n\n<p>I'm getting a panic from one of my lines of code:</p>\n\n<blockquote>\n  <p>panic: reflect: Field of non-struct type</p>\n</blockquote>\n\n<p>The panic comes from this line:</p>\n\n<pre><code>tf := vf.Type().Field(i)\n</code></pre>\n\n<p>I'm trying to get the type field so I can get a tag from it.</p>\n\n<p>Here is the full function:</p>\n\n<pre><code>func Sanitize(s interface{}) error {\n    v := reflect.ValueOf(s)\n\n    // It's a pointer struct, convert to the value that it points to.\n    if v.Kind() == reflect.Ptr &amp;&amp; !v.IsNil() {\n        v = v.Elem()\n    }\n\n    // Not a struct, return an error.\n    if v.Kind() != reflect.Struct {\n        return &amp;InvalidSanitizerError{Type: reflect.TypeOf(s)}\n    }\n\n    for i := 0; i &lt; v.NumField(); i++ {\n        vf := v.Field(i)\n\n        if vf.Kind() == reflect.Struct {\n            // Recurse.\n            err := Sanitize(v.Field(i).Interface())\n            if err != nil {\n                return err\n            }\n\n            // Move onto the next field.\n            continue\n        }\n\n\n        if vf.Kind() == reflect.String {\n            tf := vf.Type().Field(i) // &lt;-- TROUBLE MAKER\n\n            // Get the field tag value\n            tag := tf.Tag.Get(\"sanitize\")\n\n            // Skip if tag is not defined or ignored\n            if tag == \"\" || tag == \"-\" {\n                continue\n            }\n            shouldSanitize, err := strconv.ParseBool(tag)\n            if err != nil {\n                return err\n            }\n\n            if shouldSanitize &amp;&amp; vf.CanSet() {\n                vf.SetString(policy.Sanitize(vf.String()))\n            }\n        }\n    }\n\n    return nil\n}\n</code></pre>\n\n<p>This is an example of how the function should be used:</p>\n\n<pre><code>type User struct {\n    Name string `sanitize:\"true\"`\n    Bio *Bio\n}\n\ntype Bio struct {\n    Text string `sanitize:\"true\"`\n}\n\nfunc main() {\n    user := &amp;User{\n        Name: \"Lansana&lt;script&gt;alert('rekt');&lt;/script&gt;\",\n        Bio: &amp;Bio{\n            Text: \"Hello world&lt;/script&gt;alert('rekt');&lt;/script&gt;\",\n        },\n    }\n    if err := Sanitize(user); err != nil {\n        panic(err)\n    }\n\n    fmt.Println(user.Name) // Lansana\n    fmt.Println(user.Bio.Text) // Hello world\n}\n</code></pre>\n\n<p>Any insight on the panic would be greatly appreciated.</p>\n"}, {"tags": ["opengl", "go"], "comments": [{"owner": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 0, "creation_date": 1521915587, "post_id": 49459626, "comment_id": 85938945, "body": "Can you please help with minimum executable code."}, {"owner": {"reputation": 149, "user_id": 5256038, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/166545333677873/picture?type=large", "display_name": "TotallyGamerJet", "link": "https://stackoverflow.com/users/5256038/totallygamerjet"}, "reply_to_user": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 0, "creation_date": 1521954695, "post_id": 49459626, "comment_id": 85947967, "body": "@biosckon I&#39;m not sure what you want. Are you asking for a download to this program in executable form?"}, {"owner": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 1, "creation_date": 1522009339, "post_id": 49459626, "comment_id": 85963947, "body": "I mean <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> please."}, {"owner": {"reputation": 149, "user_id": 5256038, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/166545333677873/picture?type=large", "display_name": "TotallyGamerJet", "link": "https://stackoverflow.com/users/5256038/totallygamerjet"}, "reply_to_user": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 0, "creation_date": 1522084057, "post_id": 49459626, "comment_id": 85997746, "body": "@biosckon I&#39;ve added a Minimal, Complete, and Verifiable example. Hopefully it&#39;s clear enough for you"}, {"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1522089173, "post_id": 49459626, "comment_id": 86000522, "body": "Where is the code you use for rotation?"}, {"owner": {"reputation": 149, "user_id": 5256038, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/166545333677873/picture?type=large", "display_name": "TotallyGamerJet", "link": "https://stackoverflow.com/users/5256038/totallygamerjet"}, "reply_to_user": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1522089456, "post_id": 49459626, "comment_id": 86000671, "body": "@Ripi2 rotation occurs in the for loop with this code:  model = model.Mul4(...)"}, {"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1522089916, "post_id": 49459626, "comment_id": 86000926, "body": "What I see is a great perspective effect. Try placing the camera farther from the cube (with <code>mgl32.Translate3D</code>)"}, {"owner": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 0, "creation_date": 1522090707, "post_id": 49459626, "comment_id": 86001371, "body": "Rotation axis for <code>mgl32.HomogRotate3D()</code> is set to <code>mgl32.Vec3{0.5, 1.0, 0.0}</code> try <code>mgl32.Vec3{0.0, 1.0, 0.0}</code>"}, {"owner": {"reputation": 149, "user_id": 5256038, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/166545333677873/picture?type=large", "display_name": "TotallyGamerJet", "link": "https://stackoverflow.com/users/5256038/totallygamerjet"}, "reply_to_user": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1522091090, "post_id": 49459626, "comment_id": 86001585, "body": "@Ripi2 moving the camera farther back does not change it&#39;s affect."}, {"owner": {"reputation": 149, "user_id": 5256038, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/166545333677873/picture?type=large", "display_name": "TotallyGamerJet", "link": "https://stackoverflow.com/users/5256038/totallygamerjet"}, "reply_to_user": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 0, "creation_date": 1522091092, "post_id": 49459626, "comment_id": 86001586, "body": "@biosckon yes, changing it to 0, 1, 0 stops it from stretching but makes it only rotate around the y axis. I want it to rotate around x and y. The look it is suppose to produce can be seen here: <a href=\"https://learnopengl.com/Getting-started/Coordinate-Systems\" rel=\"nofollow noreferrer\">learnopengl.com/Getting-started/Coordinate-Systems</a> Under z-buffer"}, {"owner": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 1, "creation_date": 1522097119, "post_id": 49459626, "comment_id": 86004663, "body": "OK I think I got it. <code>HomogRotate3D()</code> expects normalized! vector. So do this <code>mgl32.Vec3{1, 1, 0}.Normalize()</code>."}], "answers": [{"tags": [], "owner": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "is_accepted": true, "score": 1, "last_activity_date": 1522098236, "last_edit_date": 1522098236, "creation_date": 1522097502, "answer_id": 49500402, "question_id": 49459626, "link": "https://stackoverflow.com/questions/49459626/opengl-model-matrix-stretches-vertices/49500402#49500402", "title": "Opengl Model Matrix stretches vertices", "body": "<blockquote>\n  <p><a href=\"https://github.com/go-gl/mathgl/blob/5ab0e04e1f55a10f3a71b1fccc60ca2ee9a0bc02/mgl32/transform.go#L150\" rel=\"nofollow noreferrer\">HomogRotate3D</a> creates a 3D rotation Matrix that rotates by (radian) angle about some arbitrary axis given by a <strong><em>Normalized</em></strong> Vector.</p>\n</blockquote>\n\n\n\n<pre class=\"lang-golang prettyprint-override\"><code>mgl32.Vec3{1, 1, 0}.Normalize()\n</code></pre>\n\n<p>Is apparently all you needed is normalize the axis of rotation vector and it stops the distortion. So your model rotation line: </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>model = model.Mul4(mgl32.HomogRotate3D(float32(glfw.GetTime()) * \n    mgl32.DegToRad(50.0), mgl32.Vec3{1.0, 1.0, 0.0}.Normalize()))\n</code></pre>\n\n<p>Have fun!</p>\n"}], "owner": {"reputation": 149, "user_id": 5256038, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/166545333677873/picture?type=large", "display_name": "TotallyGamerJet", "link": "https://stackoverflow.com/users/5256038/totallygamerjet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 49500402, "answer_count": 1, "score": 0, "last_activity_date": 1522098236, "creation_date": 1521848047, "last_edit_date": 1522089011, "question_id": 49459626, "link": "https://stackoverflow.com/questions/49459626/opengl-model-matrix-stretches-vertices", "title": "Opengl Model Matrix stretches vertices", "body": "<p>I am working on a simple opengl game to learn more about it. But for some reason when I try to rotate my cube over time it becomes stretched. You can see it in the photo:</p>\n\n<p><a href=\"https://i.stack.imgur.com/CaY1p.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CaY1p.png\" alt=\"enter image description here\"></a>\n<br></p>\n\n<p>I think it has to do with my model matrix but I'm not sure. Here is a portion of my code:</p>\n\n<pre><code>    model := mgl32.Ident4()                                                               \n    model = model.Mul4(mgl32.HomogRotate3D(float32(glfw.GetTime()) * \n    mgl32.DegToRad(50.0), mgl32.Vec3{0.5, 1.0, 0.0}))\n\n    view := mgl32.Ident4()\n    view = view.Mul4(mgl32.Translate3D(0.0, 0.0, -3.0))\n\n    projection := mgl32.Ident4()\n    projection = mgl32.Perspective(mgl32.DegToRad(45.0), 800/ float32(600), 0.1, 100)\n\n    shader.setMat4(\"model\", model)\n    shader.setMat4(\"view\", view)\n    shader.setMat4(\"projection\", projection)\n</code></pre>\n\n<p>Here is my Minimal, Complete, and Verifiable example. I've removed the texture as it's not necessary to see the problem. I am also using wireframe so that you can see the stretching more clearly.</p>\n\n<pre><code>package main\n\nimport(\n     \"github.com/go-gl/glfw/v3.2/glfw\"\n     \"github.com/go-gl/gl/v4.5-core/gl\"\n     \"log\"\n     \"strings\"\n     \"fmt\"\n     \"github.com/go-gl/mathgl/mgl32\"\n )\n\n const(\n     vertexShaderSource = `\n         #version 450 core\n         layout (location = 0) in vec3 aPos;\n\n        uniform mat4 model;\n        uniform mat4 view;\n        uniform mat4 projection;\n\n        void main()\n        {\n            gl_Position = projection * view * model * vec4(aPos, 1.0);\n        }` + \"\\x00\"\n\n    fragmentShaderSource =  `\n        #version 450 core\n        out vec4 FragColor;\n\n        void main()\n        {\n            FragColor = vec4(1.0f, 0.5f, 0.2f, 1.0f);\n        }` + \"\\x00\"\n)\n\nvar(\n    vertices = []float32 {\n        -0.5,0.5,-0.5,\n        -0.5,-0.5,-0.5,\n        0.5,-0.5,-0.5,\n        0.5,0.5,-0.5,\n\n        -0.5,0.5,0.5,\n        -0.5,-0.5,0.5,\n        0.5,-0.5,0.5,\n        0.5,0.5,0.5,\n\n        0.5,0.5,-0.5,\n        0.5,-0.5,-0.5,\n        -0.5,-0.5,0.5,\n        -0.5,0.5,0.5,\n\n        -0.5,0.5,-0.5,\n        -0.5,-0.5,0.5,\n        0.5,-0.5,0.5,\n    }\n    indices = []int {\n        0,1,3, // -z\n        3,1,2,\n        5,4,7, // +z\n        7,6,5,\n        9,8,7, // +x\n        7,6,9,\n        0,1,11, // -x\n        11,1,10,\n        12,4,7, // +y\n        7,3,12,\n        13,1,14,  // -y\n        14,1,2,\n    }\n)\n\n\nfunc main() {\n    if err := glfw.Init(); err != nil {\n        log.Fatalln(\"failed to initialize glfw:\", err)\n    }\n    defer glfw.Terminate()\n\n    glfw.WindowHint(glfw.ContextVersionMajor, 4)\n    glfw.WindowHint(glfw.ContextVersionMinor, 5)\n    glfw.WindowHint(glfw.OpenGLProfile, glfw.OpenGLCoreProfile)\n    glfw.WindowHint(glfw.OpenGLForwardCompatible, glfw.True)\n\n    window, err := glfw.CreateWindow(800, 600, \"LearnOpenGL\", nil, nil)\n    if err != nil {\n        panic(err)\n    }\n    defer window.Destroy()\n\n    window.MakeContextCurrent()\n\n    // Initialize Glow\n    if err := gl.Init(); err != nil {\n        panic(err)\n    }\n\n    gl.Viewport(0, 0, 800, 600)\n\n    //SHADERS\n    vertexID, err := loadShader(vertexShaderSource, gl.VERTEX_SHADER)\n    if err != nil {\n        panic(err)\n    }\n    fragmentID, err := loadShader(fragmentShaderSource, gl.FRAGMENT_SHADER)\n    if err != nil {\n        panic(err)\n    }\n\n    programID := gl.CreateProgram()\n    gl.AttachShader(programID, vertexID)\n    gl.AttachShader(programID, fragmentID)\n\n    gl.DeleteShader(vertexID)\n    gl.DeleteShader(fragmentID)\n\n    gl.LinkProgram(programID)\n\n    // VBO / VAO / EBO data\n    var vbo, vao, ebo uint32\n    gl.GenVertexArrays(1, &amp;vao)\n    gl.GenBuffers(1, &amp;vbo)\n    gl.GenBuffers(1, &amp;ebo)\n    gl.BindVertexArray(vao)\n\n    gl.BindBuffer(gl.ARRAY_BUFFER, vbo)\n    gl.BufferData(gl.ARRAY_BUFFER, len(vertices)*4, gl.Ptr(vertices), gl.STATIC_DRAW)\n\n    gl.BindBuffer(gl.ELEMENT_ARRAY_BUFFER, ebo)\n    gl.BufferData(gl.ELEMENT_ARRAY_BUFFER, len(indices) * 4, gl.Ptr(indices), gl.STATIC_DRAW)\n\n    gl.VertexAttribPointer(0, 3, gl.FLOAT, false, 0, gl.PtrOffset(0))\n    gl.EnableVertexAttribArray(0)\n\n    gl.BindBuffer(gl.ARRAY_BUFFER, 0)\n    gl.BindVertexArray(0)\n\n    gl.Enable(gl.DEPTH_TEST)\n    gl.PolygonMode(gl.FRONT_AND_BACK, gl.LINE)\n\n    for !window.ShouldClose() {\n        gl.ClearColor(0.2, 0.3, 0.3, 1.0)\n        gl.Clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT)\n\n        gl.UseProgram(programID)\n\n        model := mgl32.Ident4()\n        view := mgl32.Ident4()\n        projection := mgl32.Ident4()\n        model = model.Mul4(mgl32.HomogRotate3D(float32(glfw.GetTime()) * mgl32.DegToRad(50), mgl32.Vec3{0.5, 1, 0}))\n        view = view.Mul4(mgl32.Translate3D(0, 0, -3))\n        projection = projection.Mul4(mgl32.Perspective(mgl32.DegToRad(45), 800/float32(600), 0.1, 100))\n\n        gl.UniformMatrix4fv(gl.GetUniformLocation(programID, gl.Str(\"model\\x00\")), 1, false, &amp;model[0])\n        gl.UniformMatrix4fv(gl.GetUniformLocation(programID, gl.Str(\"view\\x00\")), 1, false, &amp;view[0])\n        gl.UniformMatrix4fv(gl.GetUniformLocation(programID, gl.Str(\"projection\\x00\")), 1, false, &amp;projection[0])\n\n        gl.BindVertexArray(vao)\n        gl.DrawElements(gl.TRIANGLES, 36, gl.UNSIGNED_INT, gl.PtrOffset(0))\n\n        window.SwapBuffers()\n        glfw.PollEvents()\n        }\n    }\n\nfunc loadShader(file string, shaderType uint32) (uint32, error) {\n    shader := gl.CreateShader(shaderType)\n\n    csources, free := gl.Strs(string(file))\n    gl.ShaderSource(shader, 1, csources, nil)\n    free()\n    gl.CompileShader(shader)\n\n    var status int32\n    gl.GetShaderiv(shader, gl.COMPILE_STATUS, &amp;status)\n    if status == gl.FALSE {\n        var logLength int32\n        gl.GetShaderiv(shader, gl.INFO_LOG_LENGTH, &amp;logLength)\n\n        log := strings.Repeat(\"\\x00\", int(logLength+1))\n        gl.GetShaderInfoLog(shader, logLength, nil, gl.Str(log))\n\n        return 0,fmt.Errorf(\"failed to compile %v: %v\", file, log)\n    }\n    return shader, nil\n}\n</code></pre>\n"}, {"tags": ["go", "http-headers", "response-headers"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 7, "creation_date": 1521840571, "post_id": 49458406, "comment_id": 85919994, "body": "Not with the stdlib http client, since as you said, they are stored in a map. Though, since the spec states that the order of different http headers does not matter, what problem are you trying to solve? There is not even a guarantee that the order you receive the headers in is the same as what the server sent out."}, {"owner": {"reputation": 7502, "user_id": 6368697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yq4cG.jpg?s=128&g=1", "display_name": "Patrick Mevzek", "link": "https://stackoverflow.com/users/6368697/patrick-mevzek"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1521841281, "post_id": 49458406, "comment_id": 85920211, "body": "Adding to @JimB, any proxy along the path may also change things. So trying to go after some kind of order is clealy the wrong answer to whatever problem. I believe than in HTTP/2 things would be even more complicated."}, {"owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "edited": false, "score": 0, "creation_date": 1521873155, "post_id": 49458406, "comment_id": 85926702, "body": "By the way, <code>map</code> in go doesn&#39;t preserve order by it&#39;s nature."}, {"owner": {"reputation": 113, "user_id": 9362398, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "brun", "link": "https://stackoverflow.com/users/9362398/brun"}, "edited": false, "score": 0, "creation_date": 1526499560, "post_id": 49458406, "comment_id": 87773695, "body": "I understand map does not preserve order but that doesn&#39;t mean someone has worked up a reflect type way to access the original raw headers read in.  Furthermore, I stated in my completely unedited original question that a map does not preserve order.  My profile says I have a -2 from this question, if you&#39;re going to downvote please post a reason so the community can learn, thank you."}, {"owner": {"reputation": 113, "user_id": 9362398, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "brun", "link": "https://stackoverflow.com/users/9362398/brun"}, "reply_to_user": {"reputation": 7502, "user_id": 6368697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yq4cG.jpg?s=128&g=1", "display_name": "Patrick Mevzek", "link": "https://stackoverflow.com/users/6368697/patrick-mevzek"}, "edited": false, "score": 0, "creation_date": 1526499857, "post_id": 49458406, "comment_id": 87773823, "body": "Also JimB and @Patrick Mevzek I understand that the header order may not matter to everyone but JimB brings up one of the points i&#39;m looking for.  If you know how a server or client normally acts via their headers, then seeing a change like this will show that they may have moved behind a proxy.   I do not understand how the &quot;why&quot; matters as much as the &quot;how&quot;.  If you want to understand why someone would want to preserve order of received headers, then maybe that should be opened as it&#39;s own question on stack overflow."}, {"owner": {"reputation": 7502, "user_id": 6368697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yq4cG.jpg?s=128&g=1", "display_name": "Patrick Mevzek", "link": "https://stackoverflow.com/users/6368697/patrick-mevzek"}, "edited": false, "score": 0, "creation_date": 1526500189, "post_id": 49458406, "comment_id": 87773959, "body": "@brun I am sorry to disagree. Since nothing in the spec says some order must exist, a server could change at any time for any reason and this fact alone does not give you any factual data about it being moved besides a proxy. The opposite holds too: it could be moved besides a proxy, while nothing changes in the headers, so you would not have any clue that happened by doing searches on the order. Sorry, I still believe you are trying to solve the wrong problem here. Anyway find a library &quot;lower&quot; than <code>net&#47;http</code> or just hack that one to go after your ordering wild chase..."}, {"owner": {"reputation": 113, "user_id": 9362398, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "brun", "link": "https://stackoverflow.com/users/9362398/brun"}, "reply_to_user": {"reputation": 7502, "user_id": 6368697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yq4cG.jpg?s=128&g=1", "display_name": "Patrick Mevzek", "link": "https://stackoverflow.com/users/6368697/patrick-mevzek"}, "edited": false, "score": 0, "creation_date": 1526566671, "post_id": 49458406, "comment_id": 87803204, "body": "@PatrickMevzek You can disagree, but it&#39;s not a debate or an argument.  I asked a question to see if anyone has an answer for.  I want to do research, and that is the reason I desire the order of the headers.  I don&#39;t understand why that has become the focus?"}], "owner": {"reputation": 113, "user_id": 9362398, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "brun", "link": "https://stackoverflow.com/users/9362398/brun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 813, "favorite_count": 2, "answer_count": 0, "score": 5, "last_activity_date": 1521839887, "creation_date": 1521839887, "question_id": 49458406, "link": "https://stackoverflow.com/questions/49458406/preserve-order-of-http-response-headers-golang", "title": "preserve order of http response headers golang", "body": "<p>Anyone know of a way to preserve the order of response headers received using the net/http package?</p>\n\n<p>As it is, the headers are accessible only as a <code>map[string]string</code> and iterating over them does not preserve order.</p>\n\n<p>Any input would be much appreciated, thanks all!</p>\n"}, {"tags": ["go", "mgo"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1521833512, "post_id": 49456974, "comment_id": 85917158, "body": "<a href=\"https://stackoverflow.com/a/19279952/965900\">stackoverflow.com/a/19279952/965900</a>"}, {"owner": {"reputation": 15832, "user_id": 1156707, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/99055b620fb3a9d30a8f6ac480c25227?s=128&d=identicon&r=PG", "display_name": "Louis Thibault", "link": "https://stackoverflow.com/users/1156707/louis-thibault"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1521836464, "post_id": 49456974, "comment_id": 85918361, "body": "@mkopriva brilliant, thank you!  Feel free to add an answer if you like -- I will gladly upvote and accept."}], "owner": {"reputation": 15832, "user_id": 1156707, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/99055b620fb3a9d30a8f6ac480c25227?s=128&d=identicon&r=PG", "display_name": "Louis Thibault", "link": "https://stackoverflow.com/users/1156707/louis-thibault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "closed_date": 1521841849, "answer_count": 0, "score": 1, "last_activity_date": 1521832765, "creation_date": 1521832765, "question_id": 49456974, "link": "https://stackoverflow.com/questions/49456974/why-isnt-mongo-populating-embedded-structs", "closed_reason": "Duplicate", "title": "Why isn&#39;t mongo populating embedded structs?", "body": "<p>I have the following schema for mongodb:</p>\n\n<pre><code>package api\n\nimport (\n    \"time\"\n\n    \"gopkg.in/mgo.v2/bson\"\n)\n\n// Content of a press-release\ntype Content struct {\n    Timestamp   time.Time `json:\"timestamp\" bson:\"timestamp\"`\n    PubDate     time.Time `json:\"pub_date\" bson:\"pub_date\"`\n    Title       string    `json:\"title\" bson:\"title\"`\n    Description string    `json:\"description\" bson:\"description\"`\n    Sector      string    `json:\"sector\" bson:\"sector\"`\n}\n\n// ContactInfo for a a press-release\ntype ContactInfo struct {\n    Persons     []*Person `json:\"persons\" bson:\"persons\"`  // definition of Persons omitted for conciseness \n    ContactData string    `json:\"contact_data\" bson:\"contact_data\"`\n}\n\n// PressRelease is a document in MongoDB\ntype PressRelease struct {\n    ID bson.ObjectId `json:\"_id\" bson:\"_id\"`\n    *ContactInfo\n    *Content\n}\n</code></pre>\n\n<p>I would like to retrieve a <code>PressRelease</code>, so in a different package, I have:</p>\n\n<pre><code>type mongoClient struct {\n    *mgo.Collection\n    // other irrelevant stuff...\n}\n\nfunc (mc mongoClient) ListRecentUnhandled(c context.Context) (*api.PressRelease, error) {\n    var pr api.PressRelease\n    err := mc.Find(nil).Sort(\"-timestamp\").One(&amp;pr)\n    return &amp;pr, err\n}\n</code></pre>\n\n<h2>Problem Statement</h2>\n\n<p>The above <code>ListRecentUnhandled</code> only populates <code>api.PressRelease.ID</code>.  The values of the nested structures <code>api.Content</code> and <code>api.ContactInfo</code> remain <code>nil</code>. </p>\n\n<h2>Previous Attempts/Work</h2>\n\n<h3>Executable test-case</h3>\n\n<p>I first tried to construct an executable test case.  However, I am unable to reproduce this behavior in the Go playground:  <a href=\"https://play.golang.org/p/p0pyuJEwGRJ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/p0pyuJEwGRJ</a></p>\n\n<p><strong>Result:</strong>  failure to reproduce</p>\n\n<h3>Inspect the contents of the data returned by mgo</h3>\n\n<p>I then tried to inspect the data being returned by the <code>mgo</code> driver by deserializing it to a <code>map[struct]interface{}</code>.  Results were as expected.  The keys I found were:</p>\n\n<ul>\n<li>timestamp</li>\n<li>pub_date</li>\n<li>persons</li>\n<li>title</li>\n<li>description</li>\n<li>contact_data</li>\n<li>sector</li>\n<li>_id</li>\n</ul>\n\n<p><strong>Result:</strong> all key-values are present and accounted for, and no superfluous data is contained in the result</p>\n\n<h3>Verify key and value types using <code>spew.Dump</code>.</h3>\n\n<p>I wanted to cross-validate results from <code>map[string]interface{}</code> to make sure I wasn't overlooking anything, so I installed <a href=\"https://github.com/davecgh/go-spew/spew\" rel=\"nofollow noreferrer\">https://github.com/davecgh/go-spew/spew</a> and <code>spew.Dump</code>ed the returned data.  Here are abbridged results:</p>\n\n<pre><code>(map[string]interface {}) (len=8) {\n (string) (len=11) \"description\": (string) (len=4402) \"[\u2026]\",\n (string) (len=12) \"contact_data\": (string) (len=107) \"[\u2026]\",\n (string) (len=6) \"sector\": (string) (len=8) \"sciences\",\n (string) (len=3) \"_id\": (bson.ObjectId) (len=12) ObjectIdHex(\"5ab52ec79af937109ee5ad3c\"),\n (string) (len=9) \"timestamp\": (time.Time) 2018-03-23 16:43:51.56 +0000 UTC,\n (string) (len=8) \"pub_date\": (time.Time) 2016-06-06 17:54:51 +0000 UTC,\n (string) (len=7) \"persons\": ([]interface {}) {},\n (string) (len=5) \"title\": (string) (len=138) \"[\u2026]\"\n}\n</code></pre>\n\n<h3>Try to load the nested structs individually</h3>\n\n<p>I tried replacing <code>var pr api.PressRelease</code>?  with <code>api.Content</code> and <code>api.ContactInfo</code>.  Both structs are individually populated without issue.</p>\n\n<p><strong>Result:</strong> The data is valid and can be individually de-serialized into the constituent structs</p>\n\n<h3>Try to instantiate the embedded structs manually</h3>\n\n<pre><code>func (mc mongoClient) ListRecentUnhandled(c context.Context) (*api.PressRelease, error) {\n    var pr api.PressRelease\n    pr.Content = new(api.Content)\n    pr.ContactInfo = new(api.ContactInfo)\n    err := mc.Find(nil).Sort(\"-timestamp\").One(&amp;pr)\n    return &amp;pr, err\n}\n</code></pre>\n\n<p><strong>Result:</strong> same as before (only ID field is populated)</p>\n\n<h2>Questions</h2>\n\n<p>What is going on here?</p>\n\n<p>How can I de-serialize a <code>mgo</code> query into embedded structs?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1521832804, "post_id": 49456943, "comment_id": 85916822, "body": "For the &quot;real&quot; answer, you&#39;d have to contact the Go maintainers, not StackOverflow. However, <code>defer</code>&#39;s behavior is in relation to <code>return</code> statements (implicit or explicit) and <code>panic</code>s, and therefor only makes sense in the context of a function, not arbitrary blocks."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 2, "creation_date": 1521833422, "post_id": 49456943, "comment_id": 85917124, "body": "A &quot;lexical closure&quot; usually refers to a <i>function</i>, not a <i>block</i>, and bare braces don&#39;t create a function in Go. If you actually defined a function -- as <code>func() { defer fmt.Println(1); }()</code> -- the defer would be scoped to it. (Maybe the confusion is because blocks conventionally define &quot;lexical scopes,&quot; even though they aren&#39;t &quot;lexical closures.&quot;)"}, {"owner": {"reputation": 9230, "user_id": 426877, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/5a287a2bae7fdcf36c8ea27174d959d2?s=128&d=identicon&r=PG", "display_name": "Magnus", "link": "https://stackoverflow.com/users/426877/magnus"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1521833801, "post_id": 49456943, "comment_id": 85917275, "body": "@twotwotwo Thanks for the terminology correction, will update the question"}, {"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 1, "creation_date": 1522015915, "post_id": 49456943, "comment_id": 85965816, "body": "A deferred call is put on the call stack. Functions have call stacks, blocks don&#39;t and for this reason, they can only by function scoped."}], "answers": [{"comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1521833665, "post_id": 49457047, "comment_id": 85917222, "body": "Simiar to my comment on the other answer, I think the anonymous function is probably what the asker wants, but they seem to be confusing &quot;lexical closure&quot; (which conventionally means an anonymous function) with a brace-enclosed block, maybe because those are associated with lexical scopes."}, {"owner": {"reputation": 9230, "user_id": 426877, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/5a287a2bae7fdcf36c8ea27174d959d2?s=128&d=identicon&r=PG", "display_name": "Magnus", "link": "https://stackoverflow.com/users/426877/magnus"}, "edited": false, "score": 0, "creation_date": 1521834006, "post_id": 49457047, "comment_id": 85917360, "body": "Thanks, the anonymous function approach seems perfect.  As you can prob tell, I&#39;m new to go and tend to look for analogies to my old Java idioms."}], "tags": [], "owner": {"reputation": 3201, "user_id": 1875092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1182c2dfe8c91c9623e09d6c8fdf87b0?s=128&d=identicon&r=PG", "display_name": "jsageryd", "link": "https://stackoverflow.com/users/1875092/jsageryd"}, "is_accepted": true, "score": 5, "last_activity_date": 1563837384, "last_edit_date": 1563837384, "creation_date": 1521833094, "answer_id": 49457047, "question_id": 49456943, "link": "https://stackoverflow.com/questions/49456943/why-is-golang-defer-scoped-to-function-not-lexical-enclosure/49457047#49457047", "title": "why is golang &quot;defer&quot; scoped to function, not lexical enclosure", "body": "<blockquote>\n  <ol>\n  <li>Is my understanding correct?</li>\n  </ol>\n</blockquote>\n\n<p>Yes.</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>Is there a way to scope it to the block [...]?</li>\n  </ol>\n</blockquote>\n\n<p>There is no way to change how <code>defer</code> works. Depending on the problem you are trying to solve, perhaps splitting your function (<a href=\"https://play.golang.org/p/OV1ACcTPJU2\" rel=\"nofollow noreferrer\">example</a>) or defining anonymous functions (<a href=\"https://play.golang.org/p/2cA9MoPte7u\" rel=\"nofollow noreferrer\">example</a>) would help. The latter just for reference and probably best avoided because of how it makes the code less readable.</p>\n\n<p>More info on <code>defer</code> at <a href=\"https://golang.org/ref/spec#Defer_statements\" rel=\"nofollow noreferrer\">Go Spec</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1521833580, "post_id": 49457105, "comment_id": 85917185, "body": "I thought this was the answer, but realized that the question said &quot;lexical closure&quot; but the example just showed a block. (Maybe the confusion is because &quot;lexical scoping&quot; is usually block scoping, even though blocks aren&#39;t lexical closures.) So the answer to &quot;is my understanding correct?&quot; may be &quot;not quite&quot; if the root cause is that asker confused those things."}], "tags": [], "owner": {"reputation": 32098, "user_id": 124319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVhrR.jpg?s=128&g=1", "display_name": "coredump", "link": "https://stackoverflow.com/users/124319/coredump"}, "is_accepted": false, "score": 3, "last_activity_date": 1521833363, "creation_date": 1521833363, "answer_id": 49457105, "question_id": 49456943, "link": "https://stackoverflow.com/questions/49456943/why-is-golang-defer-scoped-to-function-not-lexical-enclosure/49457105#49457105", "title": "why is golang &quot;defer&quot; scoped to function, not lexical enclosure", "body": "<h2>Correct?</h2>\n\n<p>Yes.</p>\n\n<h2>Why?</h2>\n\n<p>If you can only have one behavior, function vs. block, which one is easier to define the other?</p>\n\n<ul>\n<li><p>Suppose <code>defer</code> works on block. If you want to defer to a wider scope, you can't. Sometimes, Go requires you to enter a new block, like in <code>if</code> statements, which makes it hard to control easily when defer is applied.</p></li>\n<li><p>Now, if <code>defer</code> is scoped by functions, then you can easily add a new function to shrink the scope. You can even have an anonymous function that you call directly.</p>\n\n<pre><code>func() {\n    defer ...\n}()\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 9230, "user_id": 426877, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/5a287a2bae7fdcf36c8ea27174d959d2?s=128&d=identicon&r=PG", "display_name": "Magnus", "link": "https://stackoverflow.com/users/426877/magnus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3896, "favorite_count": 1, "closed_date": 1521838360, "accepted_answer_id": 49457047, "answer_count": 2, "score": 2, "last_activity_date": 1563837384, "creation_date": 1521832645, "last_edit_date": 1521834165, "question_id": 49456943, "link": "https://stackoverflow.com/questions/49456943/why-is-golang-defer-scoped-to-function-not-lexical-enclosure", "closed_reason": "Opinion-based", "title": "why is golang &quot;defer&quot; scoped to function, not lexical enclosure", "body": "<p>I was surprised to find that these two programs produce the same output:</p>\n\n<p><strong>Program A</strong></p>\n\n<pre><code>package main\nimport \"fmt\"\n\nfunc main() {  \n    defer fmt.Println(1)\n    defer fmt.Println(2)\n}\n</code></pre>\n\n<p><strong>Program B</strong></p>\n\n<pre><code>package main\nimport \"fmt\"\n\nfunc main() {  \n    {\n        defer fmt.Println(1)\n    }\n    defer fmt.Println(2)\n}\n</code></pre>\n\n<p>In other words, the \"defer\" statement appears to disregard lexical closures [edit: Thanks to @twotwotwo for correcting my terminology, I meant to say \"block\" not \"lexical closure\"] and is strictly scoped to the function.  I wondered:</p>\n\n<ol>\n<li>is my understanding correct?</li>\n<li>is there a way to scope it to the block so that it triggers upon exiting the closure, not the function?  </li>\n</ol>\n\n<p>I can imagine doing several units of work in sequence, each requiring its own resource to be closed before proceeding... would be nice not to have to break them into separate functions solely for that purpose.</p>\n"}, {"tags": ["testing", "go", "channel"], "answers": [{"comments": [{"owner": {"reputation": 6375, "user_id": 84750, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jbFti.jpg?s=128&g=1", "display_name": "silverfighter", "link": "https://stackoverflow.com/users/84750/silverfighter"}, "edited": false, "score": 0, "creation_date": 1521833512, "post_id": 49456817, "comment_id": 85917159, "body": "Thanks for your reply. I changed the expected values to see if it even hits that point. I am sorry I should have turned that back or at least mention it. Will edit it. My guess is that the code in your playground example just falls through because your not working with the channel. This is basically what I am asking: How to wait for the channel and expect the values EmittRecord return <code>&lt;- chan *Result</code> or do I get something wrong?"}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 6375, "user_id": 84750, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jbFti.jpg?s=128&g=1", "display_name": "silverfighter", "link": "https://stackoverflow.com/users/84750/silverfighter"}, "edited": false, "score": 0, "creation_date": 1521835894, "post_id": 49456817, "comment_id": 85918131, "body": "The <code>for item := range EmittRecord()</code> in my code does just that. Every time a record is emitted, it will call the logic inside the block. If that takes 5 minutes, then it will take 5 minutes. You can test this by adding a <code>fmt.Println()</code> inside the for loop, you will see it will print something for however many times your <code>EmittRecord()</code> channel emits something."}, {"owner": {"reputation": 6375, "user_id": 84750, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jbFti.jpg?s=128&g=1", "display_name": "silverfighter", "link": "https://stackoverflow.com/users/84750/silverfighter"}, "edited": false, "score": 0, "creation_date": 1522170246, "post_id": 49456817, "comment_id": 86042804, "body": "Thank you Sir, worked like a charmed def. learned something and found another bug in my code as well!"}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 6375, "user_id": 84750, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jbFti.jpg?s=128&g=1", "display_name": "silverfighter", "link": "https://stackoverflow.com/users/84750/silverfighter"}, "edited": false, "score": 0, "creation_date": 1522171948, "post_id": 49456817, "comment_id": 86043683, "body": "Happy to help! :)"}], "tags": [], "owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "is_accepted": true, "score": 0, "last_activity_date": 1521836940, "last_edit_date": 1521836940, "creation_date": 1521832113, "answer_id": 49456817, "question_id": 49456417, "link": "https://stackoverflow.com/questions/49456417/testing-emitter-func-with-channel-return-value-in-go/49456817#49456817", "title": "Testing Emitter func with channel return value in go", "body": "<p>Are you sure you have your expected results in the tests set to the proper value?</p>\n\n<p>In the first slice in the test, you expect a <code>fmt.Errorf(\"RRRR\")</code>, yet the mock returns a <code>fmt.Errorf(\"YIKES\")</code>.</p>\n\n<p>And then later in the actual test conditionals, you do this:</p>\n\n<pre><code>if found.Error.Error() != \"Hello\" {\n    t.Errorf(\"FAIL: %s, expected: %s; but got %s\", tc.name, tc.expectedResult.Error.Error(), found.Error.Error())\n}\n</code></pre>\n\n<p>You are checking <code>\"Hello\"</code>. Shouldn't you be checking if it's an error with the message <code>\"YIKES\"</code>?</p>\n\n<p>I think your logic is good, but your test is just not properly written. Check my <a href=\"https://play.golang.org/p/jd-piQA23E-\" rel=\"nofollow noreferrer\">Go Playground example</a> here and run the code. You will see there is no output or panics when you run it. This is because the code passes my test conditions in <code>main</code>.</p>\n\n<p>You are adding more complexity to your test by more channels, and if those extra channels are invalid then you may have some false positives that make you think your business logic is bad. In this case, it actually seems to be working as it should.</p>\n\n<p>Here is the highlight of the code from my playground example . (the part that tests your logic):</p>\n\n<pre><code>func main() {\n    svc1 := &amp;MockService{\n        NextMock: func() (*Record, error) {\n            return nil, errors.New(\"foo\")\n        },\n    }\n    for item := range EmittRecord(svc1, 5) {\n        if item.Payload != nil {\n            panic(\"item.Payload should be nil\")\n        }\n        if item.Error == nil {\n            panic(\"item.Error should be an error\")\n        }\n    }\n\n    svc2 := &amp;MockService{\n        NextMock: func() (*Record, error) {\n            return &amp;Record{Field1: \"Hello \", Field2: \"World\"}, nil\n        },\n    }\n    for item := range EmittRecord(svc2, 5) {\n        if item.Payload == nil {\n            panic(\"item.Payload should have a value\")\n        }\n        if item.Payload.Field1 + item.Payload.Field2 != \"Hello World\" {\n            panic(\"item.Payload.Field1 and item.Payload.Field2 are invalid!\")\n        }\n        if item.Error != nil {\n            panic(\"item.Error should be nil\")\n        }\n    }\n}\n</code></pre>\n\n<p>The output from the above code is nothing. No panics. Thus, it succeeded.</p>\n\n<p>Try simplifying your test to a working state, and then add more complexity from there. :)</p>\n"}], "owner": {"reputation": 6375, "user_id": 84750, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jbFti.jpg?s=128&g=1", "display_name": "silverfighter", "link": "https://stackoverflow.com/users/84750/silverfighter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 49456817, "answer_count": 1, "score": 0, "last_activity_date": 1521836940, "creation_date": 1521830397, "last_edit_date": 1521833655, "question_id": 49456417, "link": "https://stackoverflow.com/questions/49456417/testing-emitter-func-with-channel-return-value-in-go", "title": "Testing Emitter func with channel return value in go", "body": "<p>I am having a hard time getting my test for my emitter function which passes results through a channel for a data pipeline. This function will be triggered periodically and will pull records from the database. I compiled an stripped done version for this question the real code would more complex but would follow the same pattern. For testing I mocked the access to the database because I want to test the behavoir of the Emitter function. </p>\n\n<p>I guess code is more than words:</p>\n\n<p>This is the method I want to test:</p>\n\n<pre><code>//EmittRecord pull record from database\nfunc EmittRecord(svc Service, count int) &lt;-chan *Result {\n    out := make(chan *Result)\n\n    go func() {\n        defer close(out)\n        for i := 0; i &lt; count; i++ {\n            r, err := svc.Next()\n            if err != nil {\n                out &lt;- &amp;Result{Error: err}\n                continue\n            }\n            out &lt;- &amp;Result{Payload: &amp;Payload{\n                Field1: r.Field1,\n                Field2: r.Field2,\n            }, Error: nil}\n        }\n\n    }()\n\n    return out\n}\n</code></pre>\n\n<p>I have a couple of types with an interface:</p>\n\n<pre><code>//Record is a Record from db\ntype Record struct {\n    Field1 string\n    Field2 string\n}\n\n//Payload is a record for the data pipeline\ntype Payload struct {\n    Field1 string\n    Field2 string\n}\n\n//Result is a type for the data pipeline\ntype Result struct {\n    Payload *Payload\n    Error   error\n}\n\n//Service is an abstraction to access the database\ntype Service interface {\n    Next() (*Record, error)\n}\n</code></pre>\n\n<p>This is my service Mock for testing:</p>\n\n<pre><code>//MockService is a struct to support testing for mocking the database\ntype MockService struct {\n    NextMock func() (*Record, error)\n}\n\n//Next is an Implementation of the Service interface for the mock\nfunc (m *MockService) Next() (*Record, error) {\n    if m.NextMock != nil {\n        return m.NextMock()\n    }\n    panic(\"Please set NextMock!\")\n}\n</code></pre>\n\n<p>And finally this is my test method which does not work. It does not hit the done case and das not hit the <code>1*time.Second</code> timeout case either ... the test just times out. I guess I am missing something here.</p>\n\n<pre><code> func TestEmitter(t *testing.T) {\n\n    tt := []struct {\n        name           string\n        svc            runner.Service\n        expectedResult runner.Result\n    }{\n\n        {name: \"Database returns error\",\n            svc: &amp;runner.MockService{\n                NextMock: func() (*runner.Record, error) {\n                    return nil, fmt.Errorf(\"YIKES\")\n                },\n            },\n            expectedResult: runner.Result{Payload: nil, Error: fmt.Errorf(\"RRRR\")},\n        },\n        {name: \"Database returns record\",\n            svc: &amp;runner.MockService{\n                NextMock: func() (*runner.Record, error) {\n                    return &amp;runner.Record{\n                        Field1: \"hello\",\n                        Field2: \"world\",\n                    }, nil\n                },\n            },\n        },\n    }\n\n    for _, tc := range tt {\n\n        t.Run(tc.name, func(t *testing.T) {\n            done := make(chan bool)\n            defer close(done)\n\n            var output &lt;-chan *runner.Result\n            go func() {\n                output = runner.EmittRecord(tc.svc, 1)\n                done &lt;- true\n            }()\n            found := &lt;-output\n            &lt;-done\n            select {\n            case &lt;-done:\n            case &lt;-time.After(1 * time.Second):\n                panic(\"timeout\")\n            }\n\n            if found.Error.Error() != tc.expectedResult.Error.Error() {\n                t.Errorf(\"FAIL: %s, expected: %s; but got %s\", tc.name, tc.expectedResult.Error.Error(), found.Error.Error())\n\n            } else if reflect.DeepEqual(found.Payload, tc.expectedResult.Payload) {\n                t.Errorf(\"FAIL: %s, expected: %+v; got %+v\", tc.name, tc.expectedResult.Payload, found.Payload)\n            }\n\n        })\n    }\n\n}\n</code></pre>\n\n<p>It would be great, if someone could give me an advice what I missing here and maybe some input how to verify the count of the <code>EmittRecord</code> function right now it is only set to <code>1</code>\nThanks in advance</p>\n\n<p>//Edited: the expectedResult as per Comment by @Lansana</p>\n"}, {"tags": ["go", "dependency-management", "yocto", "recipe"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1521825402, "post_id": 49455065, "comment_id": 85913140, "body": "related: <a href=\"https://stackoverflow.com/questions/48318030/yocto-recipe-to-manage-go-dependencies-with-dep-tool\" title=\"yocto recipe to manage go dependencies with dep tool\">stackoverflow.com/questions/48318030/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 4659443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/157c25c288a34c81a536417057d114df?s=128&d=identicon&r=PG&f=1", "display_name": "krutzio", "link": "https://stackoverflow.com/users/4659443/krutzio"}, "edited": false, "score": 0, "creation_date": 1530523840, "post_id": 49526887, "comment_id": 89250420, "body": "Thanks for the reply, but I don&#39;t think the go dependencies can be handled there."}], "tags": [], "owner": {"reputation": 4401, "user_id": 6484851, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bd11c011c9a94229018130c04526c5ab?s=128&d=identicon&r=PG&f=1", "display_name": "yoctotutor.com", "link": "https://stackoverflow.com/users/6484851/yoctotutor-com"}, "is_accepted": false, "score": 0, "last_activity_date": 1522215617, "creation_date": 1522215617, "answer_id": 49526887, "question_id": 49455065, "link": "https://stackoverflow.com/questions/49455065/how-to-manage-external-dependencies-of-a-golang-project-in-a-yocto-recipe/49526887#49526887", "title": "how to manage external dependencies of a golang project in a yocto recipe", "body": "<p>I believe there is only two types of dependencies<br>\n1. host dependencies (dependencies when the app compiling time in yocto)<br>\n    in yocto recipe(.bb file) keep <code>DEPENDS = \"some lib\"</code></p>\n\n<ol start=\"2\">\n<li>target dependencies (dependencies when the app running time on board)<br>\n your yocto recipe   <code>RDEPENDS = \"some lib\"</code>  </li>\n</ol>\n\n<p>hello.bb    </p>\n\n<pre><code>DESCRIPTION =  \nLIC =  \nSRC_URI =  \nDEPENDS =\"sqlite3\"   \ninherit autools\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 4659443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/157c25c288a34c81a536417057d114df?s=128&d=identicon&r=PG&f=1", "display_name": "krutzio", "link": "https://stackoverflow.com/users/4659443/krutzio"}, "is_accepted": false, "score": 1, "last_activity_date": 1530524341, "creation_date": 1530524341, "answer_id": 51133140, "question_id": 49455065, "link": "https://stackoverflow.com/questions/49455065/how-to-manage-external-dependencies-of-a-golang-project-in-a-yocto-recipe/51133140#51133140", "title": "how to manage external dependencies of a golang project in a yocto recipe", "body": "<p>I used go dep for the deps, here's an example. Most trouble was about the proxy which is also solved in the recipe:</p>\n\n<pre><code>inherit go\n\nLICENSE = \"CLOSED\"\nLIC_FILES_CHKSUM = \"\"\nDESCRIPTION = \"Hello world test with golang.\"\n\nCOMPATIBLE_MACHINE = \"(&lt;machine&gt;)\"\nDEPENDS += \"go-dep-native\"\nGO_LINKSHARED = \"\"\n\nGO_IMPORT = \"&lt;git_url&gt;/hello-world.git\"\nSRC_URI = \"&lt;git_url&gt;/${GO_IMPORT}.git;branch=${SRCBRANCH};tag=${PV}\" \nSRCBRANCH = \"master\"\n\ndo_compile() {\n    export SSH_AUTH_SOCK=\"${SSH_AUTH_SOCK}\"\n    export HTTP_PROXY=\"${HTTP_PROXY}\"\n    ( cd ${WORKDIR}/build/src/${GO_IMPORT} &amp;&amp; dep ensure -v )\n}\n\ndo_compile[vardepsexclude] += \"SSH_AUTH_SOCK HTTP_PROXY\"\n\ndo_install() {\n    install -d \"${D}/${bindir}\"\n    install -m 0755 \"${WORKDIR}/bin/&lt;arch&gt;/hello-world\" \"${D}/${bindir}/hello-world\"\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 133, "user_id": 4863755, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/08c46acf529aee31dd9853cfa0f99d8e?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4863755/chris"}, "is_accepted": false, "score": 0, "last_activity_date": 1611653077, "creation_date": 1611653077, "answer_id": 65898735, "question_id": 49455065, "link": "https://stackoverflow.com/questions/49455065/how-to-manage-external-dependencies-of-a-golang-project-in-a-yocto-recipe/65898735#65898735", "title": "how to manage external dependencies of a golang project in a yocto recipe", "body": "<p>you can add external go dependencies with <code>SRC_URI</code>:</p>\n<pre><code>SRC_URI = &quot;\\\n           &lt;git_url&gt;/${GO_IMPORT}.git;branch=${SRCBRANCH};tag=${PV} \\\n           git://github.com/golang/protobuf/ptypes;protocol=https;name=ptype;destsuffix=${PN}-${PV}/src/github.com/golang/protobuf/ptypes \\\n&quot;\n\nSRCREV_ptype = &quot;v0.1.0&quot; &lt;-- whatever revision you need (branch, tag, sha)\n\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 4659443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/157c25c288a34c81a536417057d114df?s=128&d=identicon&r=PG&f=1", "display_name": "krutzio", "link": "https://stackoverflow.com/users/4659443/krutzio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1161, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1611653077, "creation_date": 1521824933, "last_edit_date": 1521828322, "question_id": 49455065, "link": "https://stackoverflow.com/questions/49455065/how-to-manage-external-dependencies-of-a-golang-project-in-a-yocto-recipe", "title": "how to manage external dependencies of a golang project in a yocto recipe", "body": "<p>I want to write a yocto recipe for a cross-compiled golang application with Yocto 2.4.1 but I cannot get external dependencies to work.\nCan anyone help me?</p>\n\n<pre><code>current RECIPE_FILE: hello-world_%.bb\nLICENSE = \"CLOSED\"\nLIC_FILES_CHKSUM = \"\"\nDESCRIPTION = \"Hello world test with golang.\"\n\ninherit go\n\nCOMPATIBLE_MACHINE = \"(&lt;machine&gt;)\"\nDEPENDS = \"go-cross-${TARGET_ARCH}\"\nGO_IMPORT = \"hello-world\"\nSRC_URI = \"&lt;git_url&gt;/${GO_IMPORT}.git;branch=${SRCBRANCH};tag=${PV}\" \nSRCBRANCH = \"master\"\nPV = \"0.01\"\nS = \"${WORKDIR}/git\"\n\ndo_compile() {\n  export GOPATH=\"${WORKDIR}/build\"\n  export GOARCH=\"&lt;machine_arch&gt;\"\n  export GOOS=\"linux\"\n  export CGO_ENABLED=\"0\"\n  go build src/${GO_IMPORT}/hello-world.go\n}\n\n do_install() {\n   install -d \"${D}/${bindir}\"\n   install -m 0755 \"${WORKDIR}/build/hello-world\" \"${D}/${bindir}/hello-world\"\n }\n\nRDEPENDS_${PN}-dev += \"bash\"\n</code></pre>\n\n<p>This recipe works fine for internal dependencies only. But how do I integrate external dependencies like \"github.com/golang/protobuf/ptypes\"?</p>\n\n<p>PROJECT_FILE: hello-world.go</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/golang/protobuf/ptypes\"\n)\n\nfunc main() {\n    timestamp := ptypes.TimestampNow()\n    fmt.Println(timestamp)\n}\n</code></pre>\n\n<p>Does anyone knows a solution for this use case?</p>\n\n<p>Or does anyone know how \"go-dep\" could handle this?</p>\n\n<p>Best regards</p>\n"}]